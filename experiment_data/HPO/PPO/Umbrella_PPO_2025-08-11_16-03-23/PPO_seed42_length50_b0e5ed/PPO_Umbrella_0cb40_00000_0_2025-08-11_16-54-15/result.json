{"timers": {"training_iteration": 4.26779550099991, "restore_env_runners": 1.4199999895936344e-05, "training_step": 4.267532301000301, "env_runner_sampling_timer": 3.817847000999791, "learner_update_timer": 0.446033400000033, "synch_weights": 0.0015146000000640925}, "env_runners": {"env_to_module_connector": {"timers": {"connectors": {"numpy_to_tensor": 3.1285716654876484e-05, "add_time_dim_to_batch_and_zero_pad": 6.590252195491416e-06, "batch_individual_items": 1.891875992928913e-05, "add_states_from_episodes_to_batch": 3.39191211886839e-06, "add_observations_from_episodes_to_batch": 6.5801885697262525e-06}}, "connector_pipeline_timer": 0.00012163485452905005}, "weights_seq_no": 0.0, "module_episode_returns_mean": {"default_policy": 0.5}, "num_module_steps_sampled_lifetime": {"default_policy": 252500.0}, "num_episodes_lifetime": 5050.0, "env_reset_timer": 0.00020871530442857837, "module_to_env_connector": {"timers": {"connectors": {"remove_single_ts_time_rank_from_batch": 1.4638384440407662e-06, "normalize_and_clip_actions": 2.8398592783023448e-05, "get_actions": 0.00016492859312562493, "tensor_to_numpy": 4.7930240002807846e-05, "listify_data_for_vector_env": 3.1280681551312774e-05, "un_batch_to_individual_items": 1.4723988574760187e-05}}, "connector_pipeline_timer": 0.00036593303164612575}, "sample": 0.03871463333888824, "episode_len_min": 50, "num_episodes": 100.0, "num_env_steps_sampled": 5000.0, "episode_duration_sec_mean": 0.03565140900998359, "time_between_sampling": 0.0012264652638669566, "num_agent_steps_sampled": {"default_agent": 5000.0}, "num_module_steps_sampled": {"default_policy": 5000.0}, "episode_len_mean": 50.0, "rlmodule_inference_timer": 0.00010284622070901885, "agent_episode_returns_mean": {"default_agent": 0.5}, "episode_return_mean": 0.5, "env_step_timer": 4.355355113142655e-05, "env_to_module_sum_episodes_length_out": 26.762340024562445, "env_to_module_sum_episodes_length_in": 26.762340024562445, "episode_return_min": -5.5, "episode_len_max": 50, "episode_return_max": 14.5, "num_env_steps_sampled_lifetime": 252500.0, "num_agent_steps_sampled_lifetime": {"default_agent": 252500.0}, "num_env_steps_sampled_lifetime_throughput": 1273.2055931996322}, "learners": {"default_policy": {"vf_loss_unclipped": 44.5709114074707, "diff_num_grad_updates_vs_sampler_policy": 1.0, "vf_explained_var": -0.34001171588897705, "mean_kl_loss": 0.005832618102431297, "module_train_batch_size_mean": 1000.0, "num_trainable_parameters": 12919, "entropy": 0.6853613257408142, "default_optimizer_learning_rate": 0.051764006447, "policy_loss": 0.03959658369421959, "curr_kl_coeff": 0.15232576429843903, "total_loss": 0.09047196060419083, "weights_seq_no": 1.0, "gradients_default_optimizer_global_norm": 0.3857164680957794, "curr_entropy_coeff": 0.0173008632398, "vf_loss": 0.10639367252588272, "num_module_steps_trained": 11000, "num_module_steps_trained_lifetime": 11000, "num_module_steps_trained_lifetime_throughput": 200566.79981419106}, "__all_modules__": {"learner_connector": {"timers": {"connectors": {"batch_individual_items": 0.20732829999997193, "add_states_from_episodes_to_batch": 6.300000222836388e-06, "numpy_to_tensor": 0.0001613000003999332, "add_columns_from_episodes_to_train_batch": 0.06761770000002798, "add_observations_from_episodes_to_batch": 0.0007620999999744527, "general_advantage_estimation": 0.015522799999871495, "add_time_dim_to_batch_and_zero_pad": 2.5400000140507473e-05, "add_one_ts_to_episodes_and_truncate": 0.00842160000001968}}, "connector_pipeline_timer": 0.3001750000003085}, "num_module_steps_trained": 11000, "learner_connector_sum_episodes_length_out": 5100, "num_module_steps_trained_lifetime": 11000, "num_non_trainable_parameters": 0, "learner_connector_sum_episodes_length_in": 5000, "num_env_steps_trained": 56100, "num_trainable_parameters": 12919, "num_env_steps_trained_lifetime": 56100, "num_env_steps_trained_lifetime_throughput": 1015994.3927046083, "num_module_steps_trained_throughput": 200035.82999807075, "num_module_steps_trained_lifetime_throughput": 199858.4918943776}}, "num_training_step_calls_per_iteration": 1, "num_env_steps_sampled_lifetime": 252500.0, "evaluation": {"env_runners": {"sample": 0.7611821999998938, "module_to_env_connector": {"timers": {"connectors": {"normalize_and_clip_actions": 2.3294654214041228e-05, "tensor_to_numpy": 4.9307402576388106e-05, "un_batch_to_individual_items": 1.6327490623045908e-05, "remove_single_ts_time_rank_from_batch": 1.5674273918055058e-06, "listify_data_for_vector_env": 3.3606099633589874e-05, "get_actions": 0.00016906756671955536}}, "connector_pipeline_timer": 0.00037645264222667434}, "num_episodes": 20, "num_module_steps_sampled_lifetime": {"default_policy": 1000}, "rlmodule_inference_timer": 0.00010602053435682011, "num_agent_steps_sampled": {"default_agent": 1000}, "env_to_module_sum_episodes_length_out": 27.167134025045954, "num_agent_steps_sampled_lifetime": {"default_agent": 1000}, "module_episode_returns_mean": {"default_policy": 2.1}, "num_env_steps_sampled": 1000, "env_to_module_connector": {"timers": {"connectors": {"add_time_dim_to_batch_and_zero_pad": 5.856243070058452e-06, "add_observations_from_episodes_to_batch": 6.665672283044015e-06, "add_states_from_episodes_to_batch": 3.8165574085783106e-06, "numpy_to_tensor": 3.2034227382759355e-05, "batch_individual_items": 2.0582216543704504e-05}}, "connector_pipeline_timer": 0.00012731939493378127}, "episode_return_mean": 2.1, "episode_return_min": -16.5, "episode_len_max": 50, "env_reset_timer": 0.00021229999993011006, "episode_len_min": 50, "episode_len_mean": 50.0, "weights_seq_no": 1.0, "episode_duration_sec_mean": 0.03650296999999227, "agent_episode_returns_mean": {"default_agent": 2.1}, "num_module_steps_sampled": {"default_policy": 1000}, "env_step_timer": 4.5325124387499796e-05, "env_to_module_sum_episodes_length_in": 27.167134025045954, "episode_return_max": 17.5, "num_env_steps_sampled_lifetime": 6000, "num_episodes_lifetime": 20}, "num_healthy_workers": 1, "actor_manager_num_outstanding_async_reqs": 0, "num_remote_worker_restarts": 0}, "fault_tolerance": {"num_healthy_workers": 0, "num_remote_worker_restarts": 0}, "env_runner_group": {"actor_manager_num_outstanding_async_reqs": 0}, "done": false, "training_iteration": 1, "trial_id": "0cb40_00000", "date": "2025-08-11_16-57-44", "timestamp": 1754924264, "time_this_iter_s": 5.04605507850647, "time_total_s": 5.04605507850647, "pid": 51873, "hostname": "DESKTOP-3SK5A41", "node_ip": "192.168.40.242", "config": {"exploration_config": {}, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 6, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "env": "Umbrella", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": false, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 0, "create_local_env_runner": true, "num_envs_per_env_runner": 1, "gym_env_vectorize_mode": "SYNC", "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "episodes_to_numpy": true, "max_requests_in_flight_per_env_runner": 1, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "merge_env_runner_states": "training_only", "broadcast_env_runner_states": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "complete_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "sampler_perf_stats_ema_coef": null, "_is_online": true, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": "auto", "num_aggregator_actors_per_learner": 0, "max_requests_in_flight_per_aggregator_actor": 3, "local_gpu_idx": 0, "max_requests_in_flight_per_learner": 3, "gamma": 1, "lr": 0.051764006447, "grad_clip": 0.5, "grad_clip_by": "global_norm", "_train_batch_size_per_learner": 5000, "train_batch_size": 4000, "num_epochs": 2, "minibatch_size": 1000, "shuffle_batch_per_epoch": true, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "log_std_clip_param": 20.0, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "_disable_preprocessor_api": false, "_disable_action_flattening": false}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "_learner_class": null, "callbacks_on_algorithm_init": null, "callbacks_on_env_runners_recreated": null, "callbacks_on_offline_eval_runners_recreated": null, "callbacks_on_checkpoint_loaded": null, "callbacks_on_environment_created": null, "callbacks_on_episode_created": null, "callbacks_on_episode_start": null, "callbacks_on_episode_step": null, "callbacks_on_episode_end": null, "callbacks_on_evaluate_start": null, "callbacks_on_evaluate_end": null, "callbacks_on_evaluate_offline_start": null, "callbacks_on_evaluate_offline_end": null, "callbacks_on_sample_end": null, "callbacks_on_train_result": null, "explore": true, "enable_rl_module_and_learner": true, "enable_env_runner_and_connector_v2": true, "_prior_exploration_config": {"type": "StochasticSampling"}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7384768d6ac0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "offline_data_class": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_read_batch_size": null, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "materialize_data": false, "materialize_mapped_data": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "ignore_final_observation": false, "prelearner_class": null, "prelearner_buffer_class": null, "prelearner_buffer_kwargs": {}, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_remaining_data": false, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": 1, "evaluation_duration": 20, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_auto_duration_min_env_steps_per_sample": 100, "evaluation_auto_duration_max_env_steps_per_sample": 2000, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 1, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "offline_evaluation_interval": null, "num_offline_eval_runners": 0, "offline_loss_for_module_fn": null, "offline_evaluation_duration": 1, "offline_evaluation_parallel_to_training": false, "offline_evaluation_timeout_s": 120.0, "num_cpus_per_offline_eval_runner": 1, "num_gpus_per_offline_eval_runner": 0, "custom_resources_per_offline_eval_runner": {}, "restart_failed_offline_eval_runners": true, "ignore_offline_eval_runner_failures": false, "max_num_offline_eval_runner_restarts": 1000, "offline_eval_runner_restore_timeout_s": 1800.0, "max_requests_in_flight_per_offline_eval_runner": 1, "validate_offline_eval_runners_after_construction": true, "offline_eval_runner_health_probe_timeout_s": 30.0, "offline_eval_rl_module_inference_only": false, "broadcast_offline_eval_runner_states": false, "offline_eval_batch_size_per_runner": 256, "dataset_num_iters_per_eval_runner": 1, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "log_gradients": true, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 42, "restart_failed_env_runners": true, "ignore_env_runner_failures": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30.0, "env_runner_restore_timeout_s": 1800.0, "_model_config": {}, "_rl_module_spec": "RLModuleSpec(module_class=None, observation_space=None, action_space=None, inference_only=False, learner_only=False, model_config=DefaultModelConfig(fcnet_hiddens=[102, 118], fcnet_activation='tanh', fcnet_kernel_initializer=None, fcnet_kernel_initializer_kwargs=None, fcnet_bias_initializer=None, fcnet_bias_initializer_kwargs=None, conv_filters=None, conv_activation='relu', conv_kernel_initializer=None, conv_kernel_initializer_kwargs=None, conv_bias_initializer=None, conv_bias_initializer_kwargs=None, head_fcnet_hiddens=[], head_fcnet_activation='relu', head_fcnet_kernel_initializer=None, head_fcnet_kernel_initializer_kwargs=None, head_fcnet_bias_initializer=None, head_fcnet_bias_initializer_kwargs=None, free_log_std=False, log_std_clip_param=20.0, vf_share_layers=True, use_lstm=False, max_seq_len=20, lstm_cell_size=256, lstm_use_prev_action=False, lstm_use_prev_reward=False, lstm_kernel_initializer=None, lstm_kernel_initializer_kwargs=None, lstm_bias_initializer=None, lstm_bias_initializer_kwargs=None), catalog_class=None, load_state_path=None, model_config_dict=None)", "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "_validate_config": true, "_use_msgpack_checkpoints": false, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "env_task_fn": -1, "enable_connectors": -1, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.3046515247992, "kl_target": 0.0133923296452, "vf_loss_coeff": 0.5729268330452, "entropy_coeff": 0.0173008632398, "clip_param": 0.1266464223803, "vf_clip_param": 0.1074181588462, "entropy_coeff_schedule": null, "lr_schedule": null, "sgd_minibatch_size": -1, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9419323156108, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.callbacks.callbacks.RLlibCallback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 5.04605507850647, "iterations_since_restore": 1, "perf": {"cpu_util_percent": 11.962499999999999, "ram_util_percent": 89.0125}}
{"timers": {"training_iteration": 4.266767885039912, "restore_env_runners": 1.4199999895936344e-05, "training_step": 4.266503575040302, "env_runner_sampling_timer": 3.819167403029792, "learner_update_timer": 0.443684911010032, "synch_weights": 0.001514282000066487, "restore_eval_env_runners": 1.720000000204891e-05, "evaluation_iteration": 0.7745036999999684, "synch_eval_env_connectors": 0.0004183000000921311, "synch_env_connectors": 8.499999694322469e-06}, "env_runners": {"env_to_module_connector": {"timers": {"connectors": {"numpy_to_tensor": 3.1510324165248065e-05, "add_time_dim_to_batch_and_zero_pad": 6.52441469251823e-06, "batch_individual_items": 1.9083558825937964e-05, "add_states_from_episodes_to_batch": 3.4259183477372747e-06, "add_observations_from_episodes_to_batch": 6.716922163669725e-06}}, "connector_pipeline_timer": 0.0001207399714637924}, "weights_seq_no": 1.0, "module_episode_returns_mean": {"default_policy": -5.299999999999998}, "num_module_steps_sampled_lifetime": {"default_policy": 10000.0}, "num_episodes_lifetime": 200.0, "env_reset_timer": 0.00013979582185141774, "module_to_env_connector": {"timers": {"connectors": {"remove_single_ts_time_rank_from_batch": 1.483688522949057e-06, "normalize_and_clip_actions": 2.2693968410753932e-05, "get_actions": 0.0001656538931079892, "tensor_to_numpy": 4.983419010602201e-05, "listify_data_for_vector_env": 3.158213375383787e-05, "un_batch_to_individual_items": 1.4896815140491218e-05}}, "connector_pipeline_timer": 0.00036462249740262125}, "sample": 0.03795599994036548, "episode_len_min": 50, "num_episodes": 100.0, "num_env_steps_sampled": 5000.0, "episode_duration_sec_mean": 0.0368971670399833, "time_between_sampling": 0.009405059144712902, "num_agent_steps_sampled": {"default_agent": 5000.0}, "num_module_steps_sampled": {"default_policy": 5000.0}, "episode_len_mean": 50.0, "rlmodule_inference_timer": 0.00010098168490865532, "agent_episode_returns_mean": {"default_agent": -5.299999999999998}, "episode_return_mean": -5.299999999999998, "env_step_timer": 4.347195651075429e-05, "env_to_module_sum_episodes_length_out": 27.16809333212661, "env_to_module_sum_episodes_length_in": 27.16809333212661, "episode_return_min": -5.5, "episode_len_max": 50, "episode_return_max": 14.5, "num_env_steps_sampled_lifetime": 10000.0, "num_agent_steps_sampled_lifetime": {"default_agent": 10000.0}, "num_env_steps_sampled_lifetime_throughput": 1275.3436677031334}, "learners": {"default_policy": {"vf_loss_unclipped": 149.60980224609375, "diff_num_grad_updates_vs_sampler_policy": 1.0, "vf_explained_var": -0.07407271862030029, "mean_kl_loss": 0.005067297723144293, "module_train_batch_size_mean": 1000.0, "num_trainable_parameters": 12919, "entropy": 0.1404120773077011, "default_optimizer_learning_rate": 0.051764006447, "policy_loss": 0.10924717038869858, "curr_kl_coeff": 0.07616288214921951, "total_loss": 0.1691325306892395, "weights_seq_no": 2.0, "gradients_default_optimizer_global_norm": 0.129503533244133, "curr_entropy_coeff": 0.0173008632398, "vf_loss": 0.10741817951202393, "num_module_steps_trained": 11000, "num_module_steps_trained_lifetime": 22000, "num_module_steps_trained_lifetime_throughput": 199934.80378051812}, "__all_modules__": {"learner_connector": {"timers": {"connectors": {"batch_individual_items": 0.20584566499997434, "add_states_from_episodes_to_batch": 6.304000221462047e-06, "numpy_to_tensor": 0.00016131900039454195, "add_columns_from_episodes_to_train_batch": 0.06762144101002832, "add_observations_from_episodes_to_batch": 0.0007616009999765084, "general_advantage_estimation": 0.015477106999874195, "add_time_dim_to_batch_and_zero_pad": 2.537600013965857e-05, "add_one_ts_to_episodes_and_truncate": 0.00841815100001895}}, "connector_pipeline_timer": 0.2986463960103038}, "num_module_steps_trained": 11000, "learner_connector_sum_episodes_length_out": 5100.0, "num_module_steps_trained_lifetime": 22000, "num_non_trainable_parameters": 0, "learner_connector_sum_episodes_length_in": 5000.0, "num_env_steps_trained": 56100, "num_trainable_parameters": 12919, "num_env_steps_trained_lifetime": 112200, "num_env_steps_trained_lifetime_throughput": 1012915.2597801194, "num_module_steps_trained_throughput": 199416.6152204587, "num_module_steps_trained_lifetime_throughput": 199240.22196349746}}, "num_training_step_calls_per_iteration": 1, "evaluation": {"env_runners": {"sample": 0.7609971549998954, "module_to_env_connector": {"timers": {"connectors": {"normalize_and_clip_actions": 2.164845519321233e-05, "tensor_to_numpy": 4.473533211797608e-05, "un_batch_to_individual_items": 1.543135249508931e-05, "remove_single_ts_time_rank_from_batch": 1.4272708364209309e-06, "listify_data_for_vector_env": 3.0053702416047014e-05, "get_actions": 0.0001541102708944948}}, "connector_pipeline_timer": 0.00034668469670228494}, "num_episodes": 20, "num_module_steps_sampled_lifetime": {"default_policy": 2000}, "rlmodule_inference_timer": 9.580218278072625e-05, "num_agent_steps_sampled": {"default_agent": 1000}, "env_to_module_sum_episodes_length_out": 27.168093298253442, "num_agent_steps_sampled_lifetime": {"default_agent": 2000}, "module_episode_returns_mean": {"default_policy": 2.1}, "num_env_steps_sampled": 1000, "env_to_module_connector": {"timers": {"connectors": {"add_time_dim_to_batch_and_zero_pad": 5.284255356192631e-06, "add_observations_from_episodes_to_batch": 6.218483572165439e-06, "add_states_from_episodes_to_batch": 3.358226643651544e-06, "numpy_to_tensor": 2.9845839369476024e-05, "batch_individual_items": 1.8090586291735658e-05}}, "connector_pipeline_timer": 0.00011882611107257746}, "episode_return_mean": 2.1, "episode_return_min": -16.5, "episode_len_max": 50, "env_reset_timer": 0.0002114609999307504, "episode_len_min": 50, "episode_len_mean": 50.0, "weights_seq_no": 2.0, "episode_duration_sec_mean": 0.036093222499982855, "agent_episode_returns_mean": {"default_agent": 2.1}, "num_module_steps_sampled": {"default_policy": 1000}, "env_step_timer": 4.1076210352931835e-05, "env_to_module_sum_episodes_length_in": 27.168093298253442, "episode_return_max": 17.5, "num_env_steps_sampled_lifetime": 11000, "num_episodes_lifetime": 40, "time_between_sampling": 4.223607305000314}, "num_healthy_workers": 1, "actor_manager_num_outstanding_async_reqs": 0, "num_remote_worker_restarts": 0}, "num_env_steps_sampled_lifetime": 10000.0, "fault_tolerance": {"num_healthy_workers": 0, "num_remote_worker_restarts": 0}, "env_runner_group": {"actor_manager_num_outstanding_async_reqs": 0}, "done": false, "training_iteration": 2, "trial_id": "0cb40_00000", "date": "2025-08-11_16-57-49", "timestamp": 1754924269, "time_this_iter_s": 4.92220401763916, "time_total_s": 9.96825909614563, "pid": 51873, "hostname": "DESKTOP-3SK5A41", "node_ip": "192.168.40.242", "config": {"exploration_config": {}, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 6, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "env": "Umbrella", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": false, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 0, "create_local_env_runner": true, "num_envs_per_env_runner": 1, "gym_env_vectorize_mode": "SYNC", "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "episodes_to_numpy": true, "max_requests_in_flight_per_env_runner": 1, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "merge_env_runner_states": "training_only", "broadcast_env_runner_states": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "complete_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "sampler_perf_stats_ema_coef": null, "_is_online": true, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": "auto", "num_aggregator_actors_per_learner": 0, "max_requests_in_flight_per_aggregator_actor": 3, "local_gpu_idx": 0, "max_requests_in_flight_per_learner": 3, "gamma": 1, "lr": 0.051764006447, "grad_clip": 0.5, "grad_clip_by": "global_norm", "_train_batch_size_per_learner": 5000, "train_batch_size": 4000, "num_epochs": 2, "minibatch_size": 1000, "shuffle_batch_per_epoch": true, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "log_std_clip_param": 20.0, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "_disable_preprocessor_api": false, "_disable_action_flattening": false}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "_learner_class": null, "callbacks_on_algorithm_init": null, "callbacks_on_env_runners_recreated": null, "callbacks_on_offline_eval_runners_recreated": null, "callbacks_on_checkpoint_loaded": null, "callbacks_on_environment_created": null, "callbacks_on_episode_created": null, "callbacks_on_episode_start": null, "callbacks_on_episode_step": null, "callbacks_on_episode_end": null, "callbacks_on_evaluate_start": null, "callbacks_on_evaluate_end": null, "callbacks_on_evaluate_offline_start": null, "callbacks_on_evaluate_offline_end": null, "callbacks_on_sample_end": null, "callbacks_on_train_result": null, "explore": true, "enable_rl_module_and_learner": true, "enable_env_runner_and_connector_v2": true, "_prior_exploration_config": {"type": "StochasticSampling"}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7384768d6ac0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "offline_data_class": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_read_batch_size": null, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "materialize_data": false, "materialize_mapped_data": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "ignore_final_observation": false, "prelearner_class": null, "prelearner_buffer_class": null, "prelearner_buffer_kwargs": {}, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_remaining_data": false, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": 1, "evaluation_duration": 20, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_auto_duration_min_env_steps_per_sample": 100, "evaluation_auto_duration_max_env_steps_per_sample": 2000, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 1, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "offline_evaluation_interval": null, "num_offline_eval_runners": 0, "offline_loss_for_module_fn": null, "offline_evaluation_duration": 1, "offline_evaluation_parallel_to_training": false, "offline_evaluation_timeout_s": 120.0, "num_cpus_per_offline_eval_runner": 1, "num_gpus_per_offline_eval_runner": 0, "custom_resources_per_offline_eval_runner": {}, "restart_failed_offline_eval_runners": true, "ignore_offline_eval_runner_failures": false, "max_num_offline_eval_runner_restarts": 1000, "offline_eval_runner_restore_timeout_s": 1800.0, "max_requests_in_flight_per_offline_eval_runner": 1, "validate_offline_eval_runners_after_construction": true, "offline_eval_runner_health_probe_timeout_s": 30.0, "offline_eval_rl_module_inference_only": false, "broadcast_offline_eval_runner_states": false, "offline_eval_batch_size_per_runner": 256, "dataset_num_iters_per_eval_runner": 1, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "log_gradients": true, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 42, "restart_failed_env_runners": true, "ignore_env_runner_failures": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30.0, "env_runner_restore_timeout_s": 1800.0, "_model_config": {}, "_rl_module_spec": "RLModuleSpec(module_class=None, observation_space=None, action_space=None, inference_only=False, learner_only=False, model_config=DefaultModelConfig(fcnet_hiddens=[102, 118], fcnet_activation='tanh', fcnet_kernel_initializer=None, fcnet_kernel_initializer_kwargs=None, fcnet_bias_initializer=None, fcnet_bias_initializer_kwargs=None, conv_filters=None, conv_activation='relu', conv_kernel_initializer=None, conv_kernel_initializer_kwargs=None, conv_bias_initializer=None, conv_bias_initializer_kwargs=None, head_fcnet_hiddens=[], head_fcnet_activation='relu', head_fcnet_kernel_initializer=None, head_fcnet_kernel_initializer_kwargs=None, head_fcnet_bias_initializer=None, head_fcnet_bias_initializer_kwargs=None, free_log_std=False, log_std_clip_param=20.0, vf_share_layers=True, use_lstm=False, max_seq_len=20, lstm_cell_size=256, lstm_use_prev_action=False, lstm_use_prev_reward=False, lstm_kernel_initializer=None, lstm_kernel_initializer_kwargs=None, lstm_bias_initializer=None, lstm_bias_initializer_kwargs=None), catalog_class=None, load_state_path=None, model_config_dict=None)", "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "_validate_config": true, "_use_msgpack_checkpoints": false, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "env_task_fn": -1, "enable_connectors": -1, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.3046515247992, "kl_target": 0.0133923296452, "vf_loss_coeff": 0.5729268330452, "entropy_coeff": 0.0173008632398, "clip_param": 0.1266464223803, "vf_clip_param": 0.1074181588462, "entropy_coeff_schedule": null, "lr_schedule": null, "sgd_minibatch_size": -1, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9419323156108, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.callbacks.callbacks.RLlibCallback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 9.96825909614563, "iterations_since_restore": 2, "perf": {"cpu_util_percent": 13.1, "ram_util_percent": 89.1857142857143}}
{"timers": {"training_iteration": 4.266633739229514, "restore_env_runners": 1.4192999897204572e-05, "training_step": 4.2663681583299, "env_runner_sampling_timer": 3.821139613039492, "learner_update_timer": 0.4415709558999307, "synch_weights": 0.001519677180064673, "restore_eval_env_runners": 1.7275999998673796e-05, "evaluation_iteration": 0.7742817999999669, "synch_eval_env_connectors": 0.00041916200008927266, "synch_env_connectors": 8.489999695484584e-06}, "env_runners": {"env_to_module_connector": {"timers": {"connectors": {"numpy_to_tensor": 3.104782662903669e-05, "add_time_dim_to_batch_and_zero_pad": 6.38371100260293e-06, "batch_individual_items": 1.8645935098527377e-05, "add_states_from_episodes_to_batch": 3.363974776206541e-06, "add_observations_from_episodes_to_batch": 6.475933254397168e-06}}, "connector_pipeline_timer": 0.00011850129833245643}, "weights_seq_no": 2.0, "module_episode_returns_mean": {"default_policy": -4.5}, "num_module_steps_sampled_lifetime": {"default_policy": -232500.0}, "num_episodes_lifetime": -4650.0, "env_reset_timer": 0.00011378953155542766, "module_to_env_connector": {"timers": {"connectors": {"remove_single_ts_time_rank_from_batch": 1.451135997152275e-06, "normalize_and_clip_actions": 2.218663587706115e-05, "get_actions": 0.0001622363967985507, "tensor_to_numpy": 4.882546068785575e-05, "listify_data_for_vector_env": 3.094839927946586e-05, "un_batch_to_individual_items": 1.4542783624882503e-05}}, "connector_pipeline_timer": 0.00035687315488304477}, "sample": 0.03809726191722509, "episode_len_min": 50, "num_episodes": 100.0, "num_env_steps_sampled": 5000.0, "episode_duration_sec_mean": 0.03759419802996035, "time_between_sampling": 0.010798522656618117, "num_agent_steps_sampled": {"default_agent": 5000.0}, "num_module_steps_sampled": {"default_policy": 5000.0}, "episode_len_mean": 50.0, "rlmodule_inference_timer": 0.00013353401377240494, "agent_episode_returns_mean": {"default_agent": -4.5}, "episode_return_mean": -4.5, "env_step_timer": 4.2791136081505857e-05, "env_to_module_sum_episodes_length_out": 27.16809333212661, "env_to_module_sum_episodes_length_in": 27.16809333212661, "episode_return_min": -5.5, "episode_len_max": 50, "episode_return_max": 14.5, "num_env_steps_sampled_lifetime": -232500.0, "num_agent_steps_sampled_lifetime": {"default_agent": -232500.0}, "num_env_steps_sampled_lifetime_throughput": 1277.1776287690634}, "learners": {"default_policy": {"vf_loss_unclipped": 30.962148666381836, "diff_num_grad_updates_vs_sampler_policy": 1.0, "vf_explained_var": 0.072593092918396, "mean_kl_loss": 0.023791391402482986, "module_train_batch_size_mean": 1000.0, "num_trainable_parameters": 12919, "entropy": 0.19293846189975739, "default_optimizer_learning_rate": 0.051764006447, "policy_loss": -0.011618520133197308, "curr_kl_coeff": 0.07616288214921951, "total_loss": 0.04808009788393974, "weights_seq_no": 3.0, "gradients_default_optimizer_global_norm": 0.21565313637256622, "curr_entropy_coeff": 0.0173008632398, "vf_loss": 0.10686288774013519, "num_module_steps_trained": 11000, "num_module_steps_trained_lifetime": 33000, "num_module_steps_trained_lifetime_throughput": 198790.4214817754}, "__all_modules__": {"learner_connector": {"timers": {"connectors": {"batch_individual_items": 0.2043739413499747, "add_states_from_episodes_to_batch": 6.2989602197831116e-06, "numpy_to_tensor": 0.00016135281038973519, "add_columns_from_episodes_to_train_batch": 0.06761790959993054, "add_observations_from_episodes_to_batch": 0.0007608809899766129, "general_advantage_estimation": 0.015445951929876217, "add_time_dim_to_batch_and_zero_pad": 2.5357240140510838e-05, "add_one_ts_to_episodes_and_truncate": 0.008591067490016075}}, "connector_pipeline_timer": 0.2973119700501982}, "num_module_steps_trained": 11000, "learner_connector_sum_episodes_length_out": 5100.0, "num_module_steps_trained_lifetime": 33000, "num_non_trainable_parameters": 0, "learner_connector_sum_episodes_length_in": 5000.0, "num_env_steps_trained": 56100, "num_trainable_parameters": 12919, "num_env_steps_trained_lifetime": 168300, "num_env_steps_trained_lifetime_throughput": 1007311.7763504976, "num_module_steps_trained_throughput": 198290.41405489764, "num_module_steps_trained_lifetime_throughput": 198117.22241063803}}, "num_training_step_calls_per_iteration": 1, "evaluation": {"env_runners": {"sample": 0.7611226934498987, "module_to_env_connector": {"timers": {"connectors": {"normalize_and_clip_actions": 2.2383096609884832e-05, "tensor_to_numpy": 4.6218246073400816e-05, "un_batch_to_individual_items": 1.5788044450690265e-05, "remove_single_ts_time_rank_from_batch": 1.4483711186607315e-06, "listify_data_for_vector_env": 3.134717646486683e-05, "get_actions": 0.00015919951208123444}}, "connector_pipeline_timer": 0.0003573861789939351}, "num_episodes": 20, "num_module_steps_sampled_lifetime": {"default_policy": 3000}, "rlmodule_inference_timer": 9.967555906681782e-05, "num_agent_steps_sampled": {"default_agent": 1000}, "env_to_module_sum_episodes_length_out": 27.168093332125434, "num_agent_steps_sampled_lifetime": {"default_agent": 3000}, "module_episode_returns_mean": {"default_policy": 2.1}, "num_env_steps_sampled": 1000, "env_to_module_connector": {"timers": {"connectors": {"add_time_dim_to_batch_and_zero_pad": 5.449871959088193e-06, "add_observations_from_episodes_to_batch": 6.436581497756433e-06, "add_states_from_episodes_to_batch": 3.408160292434542e-06, "numpy_to_tensor": 2.9985180391005514e-05, "batch_individual_items": 1.865893337361325e-05}}, "connector_pipeline_timer": 0.000120539310406181}, "episode_return_mean": 2.1, "episode_return_min": -16.5, "episode_len_max": 50, "env_reset_timer": 0.00021064638993498194, "episode_len_min": 50, "episode_len_mean": 50.0, "weights_seq_no": 3.0, "episode_duration_sec_mean": 0.036446511666645164, "agent_episode_returns_mean": {"default_agent": 2.1}, "num_module_steps_sampled": {"default_policy": 1000}, "env_step_timer": 4.284303931704284e-05, "env_to_module_sum_episodes_length_in": 27.168093332125434, "episode_return_max": 17.5, "num_env_steps_sampled_lifetime": 16000, "num_episodes_lifetime": 60, "time_between_sampling": 4.224445050000313}, "num_healthy_workers": 1, "actor_manager_num_outstanding_async_reqs": 0, "num_remote_worker_restarts": 0}, "num_env_steps_sampled_lifetime": -232500.0, "fault_tolerance": {"num_healthy_workers": 0, "num_remote_worker_restarts": 0}, "env_runner_group": {"actor_manager_num_outstanding_async_reqs": 0}, "done": false, "training_iteration": 3, "trial_id": "0cb40_00000", "date": "2025-08-11_16-57-54", "timestamp": 1754924274, "time_this_iter_s": 5.040667772293091, "time_total_s": 15.00892686843872, "pid": 51873, "hostname": "DESKTOP-3SK5A41", "node_ip": "192.168.40.242", "config": {"exploration_config": {}, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 6, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "env": "Umbrella", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": false, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 0, "create_local_env_runner": true, "num_envs_per_env_runner": 1, "gym_env_vectorize_mode": "SYNC", "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "episodes_to_numpy": true, "max_requests_in_flight_per_env_runner": 1, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "merge_env_runner_states": "training_only", "broadcast_env_runner_states": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "complete_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "sampler_perf_stats_ema_coef": null, "_is_online": true, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": "auto", "num_aggregator_actors_per_learner": 0, "max_requests_in_flight_per_aggregator_actor": 3, "local_gpu_idx": 0, "max_requests_in_flight_per_learner": 3, "gamma": 1, "lr": 0.051764006447, "grad_clip": 0.5, "grad_clip_by": "global_norm", "_train_batch_size_per_learner": 5000, "train_batch_size": 4000, "num_epochs": 2, "minibatch_size": 1000, "shuffle_batch_per_epoch": true, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "log_std_clip_param": 20.0, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "_disable_preprocessor_api": false, "_disable_action_flattening": false}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "_learner_class": null, "callbacks_on_algorithm_init": null, "callbacks_on_env_runners_recreated": null, "callbacks_on_offline_eval_runners_recreated": null, "callbacks_on_checkpoint_loaded": null, "callbacks_on_environment_created": null, "callbacks_on_episode_created": null, "callbacks_on_episode_start": null, "callbacks_on_episode_step": null, "callbacks_on_episode_end": null, "callbacks_on_evaluate_start": null, "callbacks_on_evaluate_end": null, "callbacks_on_evaluate_offline_start": null, "callbacks_on_evaluate_offline_end": null, "callbacks_on_sample_end": null, "callbacks_on_train_result": null, "explore": true, "enable_rl_module_and_learner": true, "enable_env_runner_and_connector_v2": true, "_prior_exploration_config": {"type": "StochasticSampling"}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7384768d6ac0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "offline_data_class": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_read_batch_size": null, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "materialize_data": false, "materialize_mapped_data": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "ignore_final_observation": false, "prelearner_class": null, "prelearner_buffer_class": null, "prelearner_buffer_kwargs": {}, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_remaining_data": false, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": 1, "evaluation_duration": 20, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_auto_duration_min_env_steps_per_sample": 100, "evaluation_auto_duration_max_env_steps_per_sample": 2000, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 1, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "offline_evaluation_interval": null, "num_offline_eval_runners": 0, "offline_loss_for_module_fn": null, "offline_evaluation_duration": 1, "offline_evaluation_parallel_to_training": false, "offline_evaluation_timeout_s": 120.0, "num_cpus_per_offline_eval_runner": 1, "num_gpus_per_offline_eval_runner": 0, "custom_resources_per_offline_eval_runner": {}, "restart_failed_offline_eval_runners": true, "ignore_offline_eval_runner_failures": false, "max_num_offline_eval_runner_restarts": 1000, "offline_eval_runner_restore_timeout_s": 1800.0, "max_requests_in_flight_per_offline_eval_runner": 1, "validate_offline_eval_runners_after_construction": true, "offline_eval_runner_health_probe_timeout_s": 30.0, "offline_eval_rl_module_inference_only": false, "broadcast_offline_eval_runner_states": false, "offline_eval_batch_size_per_runner": 256, "dataset_num_iters_per_eval_runner": 1, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "log_gradients": true, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 42, "restart_failed_env_runners": true, "ignore_env_runner_failures": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30.0, "env_runner_restore_timeout_s": 1800.0, "_model_config": {}, "_rl_module_spec": "RLModuleSpec(module_class=None, observation_space=None, action_space=None, inference_only=False, learner_only=False, model_config=DefaultModelConfig(fcnet_hiddens=[102, 118], fcnet_activation='tanh', fcnet_kernel_initializer=None, fcnet_kernel_initializer_kwargs=None, fcnet_bias_initializer=None, fcnet_bias_initializer_kwargs=None, conv_filters=None, conv_activation='relu', conv_kernel_initializer=None, conv_kernel_initializer_kwargs=None, conv_bias_initializer=None, conv_bias_initializer_kwargs=None, head_fcnet_hiddens=[], head_fcnet_activation='relu', head_fcnet_kernel_initializer=None, head_fcnet_kernel_initializer_kwargs=None, head_fcnet_bias_initializer=None, head_fcnet_bias_initializer_kwargs=None, free_log_std=False, log_std_clip_param=20.0, vf_share_layers=True, use_lstm=False, max_seq_len=20, lstm_cell_size=256, lstm_use_prev_action=False, lstm_use_prev_reward=False, lstm_kernel_initializer=None, lstm_kernel_initializer_kwargs=None, lstm_bias_initializer=None, lstm_bias_initializer_kwargs=None), catalog_class=None, load_state_path=None, model_config_dict=None)", "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "_validate_config": true, "_use_msgpack_checkpoints": false, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "env_task_fn": -1, "enable_connectors": -1, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.3046515247992, "kl_target": 0.0133923296452, "vf_loss_coeff": 0.5729268330452, "entropy_coeff": 0.0173008632398, "clip_param": 0.1266464223803, "vf_clip_param": 0.1074181588462, "entropy_coeff_schedule": null, "lr_schedule": null, "sgd_minibatch_size": -1, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9419323156108, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.callbacks.callbacks.RLlibCallback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 15.00892686843872, "iterations_since_restore": 3, "perf": {"cpu_util_percent": 13.214285714285717, "ram_util_percent": 89.20000000000002}}
{"timers": {"training_iteration": 4.268032695887215, "restore_env_runners": 1.4196069901845476e-05, "training_step": 4.267765739796603, "env_runner_sampling_timer": 3.8230680849490932, "learner_update_timer": 0.44103536535093163, "synch_weights": 0.0015221714082622206, "restore_eval_env_runners": 1.7274240000187998e-05, "evaluation_iteration": 0.7743719899999696, "synch_eval_env_connectors": 0.0004196173800890393, "synch_env_connectors": 8.483099701288666e-06}, "env_runners": {"env_to_module_connector": {"timers": {"connectors": {"numpy_to_tensor": 3.21117644195326e-05, "add_time_dim_to_batch_and_zero_pad": 6.652021534094564e-06, "batch_individual_items": 1.9282879433186236e-05, "add_states_from_episodes_to_batch": 3.535806492352441e-06, "add_observations_from_episodes_to_batch": 6.698785481973197e-06}}, "connector_pipeline_timer": 0.00012299705341733383}, "weights_seq_no": 3.0, "module_episode_returns_mean": {"default_policy": -4.7}, "num_module_steps_sampled_lifetime": {"default_policy": -475000.0}, "num_episodes_lifetime": -9500.0, "env_reset_timer": 0.0001033041012500707, "module_to_env_connector": {"timers": {"connectors": {"remove_single_ts_time_rank_from_batch": 1.5139639114225327e-06, "normalize_and_clip_actions": 2.283393505657629e-05, "get_actions": 0.00016849590672055623, "tensor_to_numpy": 5.015405575774575e-05, "listify_data_for_vector_env": 3.212821582742405e-05, "un_batch_to_individual_items": 1.4930178937253918e-05}}, "connector_pipeline_timer": 0.0003694292588182054}, "sample": 0.03823376244879355, "episode_len_min": 50, "num_episodes": 100.0, "num_env_steps_sampled": 5000.0, "episode_duration_sec_mean": 0.03751589302996308, "time_between_sampling": 0.01163759976590299, "num_agent_steps_sampled": {"default_agent": 5000.0}, "num_module_steps_sampled": {"default_policy": 5000.0}, "episode_len_mean": 50.0, "rlmodule_inference_timer": 0.00010331351405895935, "agent_episode_returns_mean": {"default_agent": -4.7}, "episode_return_mean": -4.7, "env_step_timer": 4.4098138703979106e-05, "env_to_module_sum_episodes_length_out": 27.16809333212661, "env_to_module_sum_episodes_length_in": 27.16809333212661, "episode_return_min": -5.5, "episode_len_max": 50, "episode_return_max": 14.5, "num_env_steps_sampled_lifetime": -475000.0, "num_agent_steps_sampled_lifetime": {"default_agent": -475000.0}, "num_env_steps_sampled_lifetime_throughput": 1273.1128653296382}, "learners": {"default_policy": {"vf_loss_unclipped": 208.283447265625, "diff_num_grad_updates_vs_sampler_policy": 1.0, "vf_explained_var": -0.349246621131897, "mean_kl_loss": 0.01988973841071129, "module_train_batch_size_mean": 1000.0, "num_trainable_parameters": 12919, "entropy": 0.2822611629962921, "default_optimizer_learning_rate": 0.051764006447, "policy_loss": 0.08596125990152359, "curr_kl_coeff": 0.07616288214921951, "total_loss": 0.1441354900598526, "weights_seq_no": 4.0, "gradients_default_optimizer_global_norm": 0.11717960983514786, "curr_entropy_coeff": 0.0173008632398, "vf_loss": 0.10741817951202393, "num_module_steps_trained": 11000, "num_module_steps_trained_lifetime": 44000, "num_module_steps_trained_lifetime_throughput": 196736.82715710206}, "__all_modules__": {"learner_connector": {"timers": {"connectors": {"batch_individual_items": 0.20450935094647352, "add_states_from_episodes_to_batch": 6.3009706168527365e-06, "numpy_to_tensor": 0.00016183128228555824, "add_columns_from_episodes_to_train_batch": 0.06761722850393174, "add_observations_from_episodes_to_batch": 0.0007602071800780958, "general_advantage_estimation": 0.015411329410574914, "add_time_dim_to_batch_and_zero_pad": 2.5323667740824017e-05, "add_one_ts_to_episodes_and_truncate": 0.008587222815115855}}, "connector_pipeline_timer": 0.29740793435969953}, "num_module_steps_trained": 11000, "learner_connector_sum_episodes_length_out": 5100.0, "num_module_steps_trained_lifetime": 44000, "num_non_trainable_parameters": 0, "learner_connector_sum_episodes_length_in": 5000.0, "num_env_steps_trained": 56100, "num_trainable_parameters": 12919, "num_env_steps_trained_lifetime": 224400, "num_env_steps_trained_lifetime_throughput": 997111.464995847, "num_module_steps_trained_throughput": 196259.99334908536, "num_module_steps_trained_lifetime_throughput": 196091.80345910322}}, "num_training_step_calls_per_iteration": 1, "evaluation": {"env_runners": {"sample": 0.7616417415153983, "module_to_env_connector": {"timers": {"connectors": {"normalize_and_clip_actions": 2.3468217863264792e-05, "tensor_to_numpy": 4.869544582787246e-05, "un_batch_to_individual_items": 1.6098577348021544e-05, "remove_single_ts_time_rank_from_batch": 1.5516313080697838e-06, "listify_data_for_vector_env": 3.162681571795654e-05, "get_actions": 0.00016525654559697354}}, "connector_pipeline_timer": 0.00037122319964771785}, "num_episodes": 20, "num_module_steps_sampled_lifetime": {"default_policy": 4000}, "rlmodule_inference_timer": 0.00010461080472794647, "num_agent_steps_sampled": {"default_agent": 1000}, "env_to_module_sum_episodes_length_out": 27.168093332126602, "num_agent_steps_sampled_lifetime": {"default_agent": 4000}, "module_episode_returns_mean": {"default_policy": 2.1}, "num_env_steps_sampled": 1000, "env_to_module_connector": {"timers": {"connectors": {"add_time_dim_to_batch_and_zero_pad": 5.758494627888886e-06, "add_observations_from_episodes_to_batch": 6.909387252799302e-06, "add_states_from_episodes_to_batch": 3.525899517556958e-06, "numpy_to_tensor": 3.1472261596150516e-05, "batch_individual_items": 1.9537139123375217e-05}}, "connector_pipeline_timer": 0.00012661824421353253}, "episode_return_mean": 2.1, "episode_return_min": -16.5, "episode_len_max": 50, "env_reset_timer": 0.00021035192603605947, "episode_len_min": 50, "episode_len_mean": 50.0, "weights_seq_no": 4.0, "episode_duration_sec_mean": 0.037085149999984426, "agent_episode_returns_mean": {"default_agent": 2.1}, "num_module_steps_sampled": {"default_policy": 1000}, "env_step_timer": 4.504664385320762e-05, "env_to_module_sum_episodes_length_in": 27.168093332126602, "episode_return_max": 17.5, "num_env_steps_sampled_lifetime": 21000, "num_episodes_lifetime": 80, "time_between_sampling": 4.22681165755031}, "num_healthy_workers": 1, "actor_manager_num_outstanding_async_reqs": 0, "num_remote_worker_restarts": 0}, "num_env_steps_sampled_lifetime": -475000.0, "fault_tolerance": {"num_healthy_workers": 0, "num_remote_worker_restarts": 0}, "env_runner_group": {"actor_manager_num_outstanding_async_reqs": 0}, "done": false, "training_iteration": 4, "trial_id": "0cb40_00000", "date": "2025-08-11_16-57-59", "timestamp": 1754924279, "time_this_iter_s": 5.23773717880249, "time_total_s": 20.24666404724121, "pid": 51873, "hostname": "DESKTOP-3SK5A41", "node_ip": "192.168.40.242", "config": {"exploration_config": {}, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 6, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "env": "Umbrella", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": false, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 0, "create_local_env_runner": true, "num_envs_per_env_runner": 1, "gym_env_vectorize_mode": "SYNC", "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "episodes_to_numpy": true, "max_requests_in_flight_per_env_runner": 1, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "merge_env_runner_states": "training_only", "broadcast_env_runner_states": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "complete_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "sampler_perf_stats_ema_coef": null, "_is_online": true, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": "auto", "num_aggregator_actors_per_learner": 0, "max_requests_in_flight_per_aggregator_actor": 3, "local_gpu_idx": 0, "max_requests_in_flight_per_learner": 3, "gamma": 1, "lr": 0.051764006447, "grad_clip": 0.5, "grad_clip_by": "global_norm", "_train_batch_size_per_learner": 5000, "train_batch_size": 4000, "num_epochs": 2, "minibatch_size": 1000, "shuffle_batch_per_epoch": true, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "log_std_clip_param": 20.0, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "_disable_preprocessor_api": false, "_disable_action_flattening": false}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "_learner_class": null, "callbacks_on_algorithm_init": null, "callbacks_on_env_runners_recreated": null, "callbacks_on_offline_eval_runners_recreated": null, "callbacks_on_checkpoint_loaded": null, "callbacks_on_environment_created": null, "callbacks_on_episode_created": null, "callbacks_on_episode_start": null, "callbacks_on_episode_step": null, "callbacks_on_episode_end": null, "callbacks_on_evaluate_start": null, "callbacks_on_evaluate_end": null, "callbacks_on_evaluate_offline_start": null, "callbacks_on_evaluate_offline_end": null, "callbacks_on_sample_end": null, "callbacks_on_train_result": null, "explore": true, "enable_rl_module_and_learner": true, "enable_env_runner_and_connector_v2": true, "_prior_exploration_config": {"type": "StochasticSampling"}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7384768d6ac0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "offline_data_class": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_read_batch_size": null, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "materialize_data": false, "materialize_mapped_data": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "ignore_final_observation": false, "prelearner_class": null, "prelearner_buffer_class": null, "prelearner_buffer_kwargs": {}, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_remaining_data": false, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": 1, "evaluation_duration": 20, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_auto_duration_min_env_steps_per_sample": 100, "evaluation_auto_duration_max_env_steps_per_sample": 2000, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 1, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "offline_evaluation_interval": null, "num_offline_eval_runners": 0, "offline_loss_for_module_fn": null, "offline_evaluation_duration": 1, "offline_evaluation_parallel_to_training": false, "offline_evaluation_timeout_s": 120.0, "num_cpus_per_offline_eval_runner": 1, "num_gpus_per_offline_eval_runner": 0, "custom_resources_per_offline_eval_runner": {}, "restart_failed_offline_eval_runners": true, "ignore_offline_eval_runner_failures": false, "max_num_offline_eval_runner_restarts": 1000, "offline_eval_runner_restore_timeout_s": 1800.0, "max_requests_in_flight_per_offline_eval_runner": 1, "validate_offline_eval_runners_after_construction": true, "offline_eval_runner_health_probe_timeout_s": 30.0, "offline_eval_rl_module_inference_only": false, "broadcast_offline_eval_runner_states": false, "offline_eval_batch_size_per_runner": 256, "dataset_num_iters_per_eval_runner": 1, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "log_gradients": true, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 42, "restart_failed_env_runners": true, "ignore_env_runner_failures": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30.0, "env_runner_restore_timeout_s": 1800.0, "_model_config": {}, "_rl_module_spec": "RLModuleSpec(module_class=None, observation_space=None, action_space=None, inference_only=False, learner_only=False, model_config=DefaultModelConfig(fcnet_hiddens=[102, 118], fcnet_activation='tanh', fcnet_kernel_initializer=None, fcnet_kernel_initializer_kwargs=None, fcnet_bias_initializer=None, fcnet_bias_initializer_kwargs=None, conv_filters=None, conv_activation='relu', conv_kernel_initializer=None, conv_kernel_initializer_kwargs=None, conv_bias_initializer=None, conv_bias_initializer_kwargs=None, head_fcnet_hiddens=[], head_fcnet_activation='relu', head_fcnet_kernel_initializer=None, head_fcnet_kernel_initializer_kwargs=None, head_fcnet_bias_initializer=None, head_fcnet_bias_initializer_kwargs=None, free_log_std=False, log_std_clip_param=20.0, vf_share_layers=True, use_lstm=False, max_seq_len=20, lstm_cell_size=256, lstm_use_prev_action=False, lstm_use_prev_reward=False, lstm_kernel_initializer=None, lstm_kernel_initializer_kwargs=None, lstm_bias_initializer=None, lstm_bias_initializer_kwargs=None), catalog_class=None, load_state_path=None, model_config_dict=None)", "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "_validate_config": true, "_use_msgpack_checkpoints": false, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "env_task_fn": -1, "enable_connectors": -1, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.3046515247992, "kl_target": 0.0133923296452, "vf_loss_coeff": 0.5729268330452, "entropy_coeff": 0.0173008632398, "clip_param": 0.1266464223803, "vf_clip_param": 0.1074181588462, "entropy_coeff_schedule": null, "lr_schedule": null, "sgd_minibatch_size": -1, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9419323156108, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.callbacks.callbacks.RLlibCallback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 20.24666404724121, "iterations_since_restore": 4, "perf": {"cpu_util_percent": 18.185714285714287, "ram_util_percent": 89.11428571428571}}
{"timers": {"training_iteration": 4.268194162998343, "restore_env_runners": 1.417410920252405e-05, "training_step": 4.267926276468637, "env_runner_sampling_timer": 3.8253491691696024, "learner_update_timer": 0.4389158986974215, "synch_weights": 0.0015206796941801765, "restore_eval_env_runners": 1.7322497600423954e-05, "evaluation_iteration": 0.7748853180999703, "synch_eval_env_connectors": 0.0004211932062876732, "synch_env_connectors": 8.47026870682248e-06}, "env_runners": {"env_to_module_connector": {"timers": {"connectors": {"numpy_to_tensor": 3.288045251377938e-05, "add_time_dim_to_batch_and_zero_pad": 6.746081829625219e-06, "batch_individual_items": 1.935989227358442e-05, "add_states_from_episodes_to_batch": 3.5442583736374878e-06, "add_observations_from_episodes_to_batch": 6.862166237928464e-06}}, "connector_pipeline_timer": 0.0001241405325930503}, "weights_seq_no": 4.0, "module_episode_returns_mean": {"default_policy": -5.299999999999998}, "num_module_steps_sampled_lifetime": {"default_policy": -717500.0}, "num_episodes_lifetime": -14350.0, "env_reset_timer": 0.0001041158858526784, "module_to_env_connector": {"timers": {"connectors": {"remove_single_ts_time_rank_from_batch": 1.5177934778861496e-06, "normalize_and_clip_actions": 2.3347752912632846e-05, "get_actions": 0.00017138201098652067, "tensor_to_numpy": 5.0827141690605524e-05, "listify_data_for_vector_env": 3.223030053009405e-05, "un_batch_to_individual_items": 1.5118177614345128e-05}}, "connector_pipeline_timer": 0.0003744395354259019}, "sample": 0.039211535402001195, "episode_len_min": 50, "num_episodes": 100.0, "num_env_steps_sampled": 5000.0, "episode_duration_sec_mean": 0.037846814069976045, "time_between_sampling": 0.013266729782748876, "num_agent_steps_sampled": {"default_agent": 5000.0}, "num_module_steps_sampled": {"default_policy": 5000.0}, "episode_len_mean": 50.0, "rlmodule_inference_timer": 0.00010343163416283965, "agent_episode_returns_mean": {"default_agent": -5.299999999999998}, "episode_return_mean": -5.299999999999998, "env_step_timer": 4.5064727025572836e-05, "env_to_module_sum_episodes_length_out": 27.16809333212661, "env_to_module_sum_episodes_length_in": 27.16809333212661, "episode_return_min": -5.5, "episode_len_max": 50, "episode_return_max": 14.5, "num_env_steps_sampled_lifetime": -717500.0, "num_agent_steps_sampled_lifetime": {"default_agent": -717500.0}, "num_env_steps_sampled_lifetime_throughput": 1225.2101305866727}, "learners": {"default_policy": {"vf_loss_unclipped": 141.1626739501953, "diff_num_grad_updates_vs_sampler_policy": 1.0, "vf_explained_var": 0.276181697845459, "mean_kl_loss": 0.04232460632920265, "module_train_batch_size_mean": 1000.0, "num_trainable_parameters": 12919, "entropy": 0.36133527755737305, "default_optimizer_learning_rate": 0.051764006447, "policy_loss": 0.08002155274152756, "curr_kl_coeff": 0.11424432694911957, "total_loss": 0.13844411075115204, "weights_seq_no": 5.0, "gradients_default_optimizer_global_norm": 0.5752671957015991, "curr_entropy_coeff": 0.0173008632398, "vf_loss": 0.10725700855255127, "num_module_steps_trained": 11000, "num_module_steps_trained_lifetime": 55000, "num_module_steps_trained_lifetime_throughput": 194479.87506292827}, "__all_modules__": {"learner_connector": {"timers": {"connectors": {"batch_individual_items": 0.2030543884370078, "add_states_from_episodes_to_batch": 6.295960911219894e-06, "numpy_to_tensor": 0.0001619499694604772, "add_columns_from_episodes_to_train_batch": 0.06759329121889017, "add_observations_from_episodes_to_batch": 0.00075908910827777, "general_advantage_estimation": 0.015442852116470233, "add_time_dim_to_batch_and_zero_pad": 2.5285431063441387e-05, "add_one_ts_to_episodes_and_truncate": 0.008579922586966866}}, "connector_pipeline_timer": 0.2959522760161032}, "num_module_steps_trained": 11000, "learner_connector_sum_episodes_length_out": 5100.0, "num_module_steps_trained_lifetime": 55000, "num_non_trainable_parameters": 0, "learner_connector_sum_episodes_length_in": 5000.0, "num_env_steps_trained": 56100, "num_trainable_parameters": 12919, "num_env_steps_trained_lifetime": 280500, "num_env_steps_trained_lifetime_throughput": 985896.8518658022, "num_module_steps_trained_throughput": 194027.83581634468, "num_module_steps_trained_lifetime_throughput": 193865.6232369282}}, "num_training_step_calls_per_iteration": 1, "evaluation": {"env_runners": {"sample": 0.7615526091202406, "module_to_env_connector": {"timers": {"connectors": {"normalize_and_clip_actions": 2.275556687840922e-05, "tensor_to_numpy": 4.667539196683436e-05, "un_batch_to_individual_items": 1.56431746525167e-05, "remove_single_ts_time_rank_from_batch": 1.5988957877073883e-06, "listify_data_for_vector_env": 3.111358724134185e-05, "get_actions": 0.00015919106792537164}}, "connector_pipeline_timer": 0.00035966020361725997}, "num_episodes": 20, "num_module_steps_sampled_lifetime": {"default_policy": 5000}, "rlmodule_inference_timer": 0.00010007011528135244, "num_agent_steps_sampled": {"default_agent": 1000}, "env_to_module_sum_episodes_length_out": 27.168093332126602, "num_agent_steps_sampled_lifetime": {"default_agent": 5000}, "module_episode_returns_mean": {"default_policy": 2.1}, "num_env_steps_sampled": 1000, "env_to_module_connector": {"timers": {"connectors": {"add_time_dim_to_batch_and_zero_pad": 5.497091214102243e-06, "add_observations_from_episodes_to_batch": 6.341647899583026e-06, "add_states_from_episodes_to_batch": 3.418573091751496e-06, "numpy_to_tensor": 3.0239547801128863e-05, "batch_individual_items": 1.8895375926074915e-05}}, "connector_pipeline_timer": 0.00012199680873150172}, "episode_return_mean": 2.1, "episode_return_min": -16.5, "episode_len_max": 50, "env_reset_timer": 0.000209550406776277, "episode_len_min": 50, "episode_len_mean": 50.0, "weights_seq_no": 5.0, "episode_duration_sec_mean": 0.03689263101999586, "agent_episode_returns_mean": {"default_agent": 2.1}, "num_module_steps_sampled": {"default_policy": 1000}, "env_step_timer": 4.288899897209461e-05, "env_to_module_sum_episodes_length_in": 27.168093332126602, "episode_return_max": 17.5, "num_env_steps_sampled_lifetime": 26000, "num_episodes_lifetime": 100, "time_between_sampling": 4.227977799044804}, "num_healthy_workers": 1, "actor_manager_num_outstanding_async_reqs": 0, "num_remote_worker_restarts": 0}, "num_env_steps_sampled_lifetime": -717500.0, "fault_tolerance": {"num_healthy_workers": 0, "num_remote_worker_restarts": 0}, "env_runner_group": {"actor_manager_num_outstanding_async_reqs": 0}, "done": false, "training_iteration": 5, "trial_id": "0cb40_00000", "date": "2025-08-11_16-58-04", "timestamp": 1754924284, "time_this_iter_s": 5.051377058029175, "time_total_s": 25.298041105270386, "pid": 51873, "hostname": "DESKTOP-3SK5A41", "node_ip": "192.168.40.242", "config": {"exploration_config": {}, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 6, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "env": "Umbrella", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": false, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 0, "create_local_env_runner": true, "num_envs_per_env_runner": 1, "gym_env_vectorize_mode": "SYNC", "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "episodes_to_numpy": true, "max_requests_in_flight_per_env_runner": 1, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "merge_env_runner_states": "training_only", "broadcast_env_runner_states": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "complete_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "sampler_perf_stats_ema_coef": null, "_is_online": true, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": "auto", "num_aggregator_actors_per_learner": 0, "max_requests_in_flight_per_aggregator_actor": 3, "local_gpu_idx": 0, "max_requests_in_flight_per_learner": 3, "gamma": 1, "lr": 0.051764006447, "grad_clip": 0.5, "grad_clip_by": "global_norm", "_train_batch_size_per_learner": 5000, "train_batch_size": 4000, "num_epochs": 2, "minibatch_size": 1000, "shuffle_batch_per_epoch": true, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "log_std_clip_param": 20.0, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "_disable_preprocessor_api": false, "_disable_action_flattening": false}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "_learner_class": null, "callbacks_on_algorithm_init": null, "callbacks_on_env_runners_recreated": null, "callbacks_on_offline_eval_runners_recreated": null, "callbacks_on_checkpoint_loaded": null, "callbacks_on_environment_created": null, "callbacks_on_episode_created": null, "callbacks_on_episode_start": null, "callbacks_on_episode_step": null, "callbacks_on_episode_end": null, "callbacks_on_evaluate_start": null, "callbacks_on_evaluate_end": null, "callbacks_on_evaluate_offline_start": null, "callbacks_on_evaluate_offline_end": null, "callbacks_on_sample_end": null, "callbacks_on_train_result": null, "explore": true, "enable_rl_module_and_learner": true, "enable_env_runner_and_connector_v2": true, "_prior_exploration_config": {"type": "StochasticSampling"}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7384768d6ac0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "offline_data_class": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_read_batch_size": null, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "materialize_data": false, "materialize_mapped_data": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "ignore_final_observation": false, "prelearner_class": null, "prelearner_buffer_class": null, "prelearner_buffer_kwargs": {}, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_remaining_data": false, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": 1, "evaluation_duration": 20, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_auto_duration_min_env_steps_per_sample": 100, "evaluation_auto_duration_max_env_steps_per_sample": 2000, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 1, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "offline_evaluation_interval": null, "num_offline_eval_runners": 0, "offline_loss_for_module_fn": null, "offline_evaluation_duration": 1, "offline_evaluation_parallel_to_training": false, "offline_evaluation_timeout_s": 120.0, "num_cpus_per_offline_eval_runner": 1, "num_gpus_per_offline_eval_runner": 0, "custom_resources_per_offline_eval_runner": {}, "restart_failed_offline_eval_runners": true, "ignore_offline_eval_runner_failures": false, "max_num_offline_eval_runner_restarts": 1000, "offline_eval_runner_restore_timeout_s": 1800.0, "max_requests_in_flight_per_offline_eval_runner": 1, "validate_offline_eval_runners_after_construction": true, "offline_eval_runner_health_probe_timeout_s": 30.0, "offline_eval_rl_module_inference_only": false, "broadcast_offline_eval_runner_states": false, "offline_eval_batch_size_per_runner": 256, "dataset_num_iters_per_eval_runner": 1, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "log_gradients": true, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 42, "restart_failed_env_runners": true, "ignore_env_runner_failures": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30.0, "env_runner_restore_timeout_s": 1800.0, "_model_config": {}, "_rl_module_spec": "RLModuleSpec(module_class=None, observation_space=None, action_space=None, inference_only=False, learner_only=False, model_config=DefaultModelConfig(fcnet_hiddens=[102, 118], fcnet_activation='tanh', fcnet_kernel_initializer=None, fcnet_kernel_initializer_kwargs=None, fcnet_bias_initializer=None, fcnet_bias_initializer_kwargs=None, conv_filters=None, conv_activation='relu', conv_kernel_initializer=None, conv_kernel_initializer_kwargs=None, conv_bias_initializer=None, conv_bias_initializer_kwargs=None, head_fcnet_hiddens=[], head_fcnet_activation='relu', head_fcnet_kernel_initializer=None, head_fcnet_kernel_initializer_kwargs=None, head_fcnet_bias_initializer=None, head_fcnet_bias_initializer_kwargs=None, free_log_std=False, log_std_clip_param=20.0, vf_share_layers=True, use_lstm=False, max_seq_len=20, lstm_cell_size=256, lstm_use_prev_action=False, lstm_use_prev_reward=False, lstm_kernel_initializer=None, lstm_kernel_initializer_kwargs=None, lstm_bias_initializer=None, lstm_bias_initializer_kwargs=None), catalog_class=None, load_state_path=None, model_config_dict=None)", "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "_validate_config": true, "_use_msgpack_checkpoints": false, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "env_task_fn": -1, "enable_connectors": -1, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.3046515247992, "kl_target": 0.0133923296452, "vf_loss_coeff": 0.5729268330452, "entropy_coeff": 0.0173008632398, "clip_param": 0.1266464223803, "vf_clip_param": 0.1074181588462, "entropy_coeff_schedule": null, "lr_schedule": null, "sgd_minibatch_size": -1, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9419323156108, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.callbacks.callbacks.RLlibCallback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 25.298041105270386, "iterations_since_restore": 5, "perf": {"cpu_util_percent": 19.8375, "ram_util_percent": 89.25}}
{"timers": {"training_iteration": 4.268566331418362, "restore_env_runners": 1.4152368110195838e-05, "training_step": 4.268297395753952, "env_runner_sampling_timer": 3.826456291527908, "learner_update_timer": 0.4381801817104471, "synch_weights": 0.001521038897240229, "restore_eval_env_runners": 1.7269272624116743e-05, "evaluation_iteration": 0.7747684929389685, "synch_eval_env_connectors": 0.0004212512742242475, "synch_env_connectors": 8.449566020502165e-06}, "env_runners": {"env_to_module_connector": {"timers": {"connectors": {"numpy_to_tensor": 3.156392456022838e-05, "add_time_dim_to_batch_and_zero_pad": 6.455858287974425e-06, "batch_individual_items": 1.886319156007189e-05, "add_states_from_episodes_to_batch": 3.396443435145013e-06, "add_observations_from_episodes_to_batch": 6.587537062097874e-06}}, "connector_pipeline_timer": 0.00012000882661428633}, "weights_seq_no": 5.0, "module_episode_returns_mean": {"default_policy": -3.899999999999998}, "num_module_steps_sampled_lifetime": {"default_policy": -960000.0}, "num_episodes_lifetime": -19200.0, "env_reset_timer": 0.0001018929517087613, "module_to_env_connector": {"timers": {"connectors": {"remove_single_ts_time_rank_from_batch": 1.4981777077373405e-06, "normalize_and_clip_actions": 2.269499899305581e-05, "get_actions": 0.00016517863793921579, "tensor_to_numpy": 4.926882782224234e-05, "listify_data_for_vector_env": 3.159141742193079e-05, "un_batch_to_individual_items": 1.4741115844316548e-05}}, "connector_pipeline_timer": 0.00036301206506168603}, "sample": 0.03855628687080714, "episode_len_min": 50, "num_episodes": 100.0, "num_env_steps_sampled": 5000.0, "episode_duration_sec_mean": 0.03678093605004051, "time_between_sampling": 0.012410372341519073, "num_agent_steps_sampled": {"default_agent": 5000.0}, "num_module_steps_sampled": {"default_policy": 5000.0}, "episode_len_mean": 50.0, "rlmodule_inference_timer": 0.00010086347616853216, "agent_episode_returns_mean": {"default_agent": -3.899999999999998}, "episode_return_mean": -3.899999999999998, "env_step_timer": 4.3313982838799634e-05, "env_to_module_sum_episodes_length_out": 27.16809333212661, "env_to_module_sum_episodes_length_in": 27.16809333212661, "episode_return_min": -5.5, "episode_len_max": 50, "episode_return_max": 14.5, "num_env_steps_sampled_lifetime": -960000.0, "num_agent_steps_sampled_lifetime": {"default_agent": -960000.0}, "num_env_steps_sampled_lifetime_throughput": 1269.5891878628647}, "learners": {"default_policy": {"vf_loss_unclipped": 128.1417236328125, "diff_num_grad_updates_vs_sampler_policy": 1.0, "vf_explained_var": 0.47873562574386597, "mean_kl_loss": 0.13358668982982635, "module_train_batch_size_mean": 1000.0, "num_trainable_parameters": 12919, "entropy": 0.003067830577492714, "default_optimizer_learning_rate": 0.051764006447, "policy_loss": 0.0319557711482048, "curr_kl_coeff": 0.17136648297309875, "total_loss": 0.10870695859193802, "weights_seq_no": 6.0, "gradients_default_optimizer_global_norm": 0.05884888023138046, "curr_entropy_coeff": 0.0173008632398, "vf_loss": 0.10741815716028214, "num_module_steps_trained": 11000, "num_module_steps_trained_lifetime": 66000, "num_module_steps_trained_lifetime_throughput": 192272.21457778715}, "__all_modules__": {"learner_connector": {"timers": {"connectors": {"batch_individual_items": 0.20303935155263414, "add_states_from_episodes_to_batch": 6.285001302431155e-06, "numpy_to_tensor": 0.00016217746976905358, "add_columns_from_episodes_to_train_batch": 0.06758450530670047, "add_observations_from_episodes_to_batch": 0.0007581582171940936, "general_advantage_estimation": 0.015417977595305627, "add_time_dim_to_batch_and_zero_pad": 2.5239576751033793e-05, "add_one_ts_to_episodes_and_truncate": 0.008575744361096555}}, "connector_pipeline_timer": 0.29589858025594173}, "num_module_steps_trained": 11000, "learner_connector_sum_episodes_length_out": 5100.0, "num_module_steps_trained_lifetime": 66000, "num_non_trainable_parameters": 0, "learner_connector_sum_episodes_length_in": 5000.0, "num_env_steps_trained": 56100, "num_trainable_parameters": 12919, "num_env_steps_trained_lifetime": 336600, "num_env_steps_trained_lifetime_throughput": 974923.1791578876, "num_module_steps_trained_throughput": 191844.89153027954, "num_module_steps_trained_lifetime_throughput": 191688.4973275048}}, "num_training_step_calls_per_iteration": 1, "evaluation": {"env_runners": {"sample": 0.7614933970290367, "module_to_env_connector": {"timers": {"connectors": {"normalize_and_clip_actions": 2.248180012398061e-05, "tensor_to_numpy": 4.6941535963833255e-05, "un_batch_to_individual_items": 1.596901498511239e-05, "remove_single_ts_time_rank_from_batch": 1.447384134720792e-06, "listify_data_for_vector_env": 3.1581531836188195e-05, "get_actions": 0.0001572826166453979}}, "connector_pipeline_timer": 0.0003574786560368314}, "num_episodes": 20, "num_module_steps_sampled_lifetime": {"default_policy": 6000}, "rlmodule_inference_timer": 9.793444575513079e-05, "num_agent_steps_sampled": {"default_agent": 1000}, "env_to_module_sum_episodes_length_out": 27.168093332126602, "num_agent_steps_sampled_lifetime": {"default_agent": 6000}, "module_episode_returns_mean": {"default_policy": 2.1}, "num_env_steps_sampled": 1000, "env_to_module_connector": {"timers": {"connectors": {"add_time_dim_to_batch_and_zero_pad": 5.561140128225567e-06, "add_observations_from_episodes_to_batch": 6.803960008574868e-06, "add_states_from_episodes_to_batch": 3.415153636593574e-06, "numpy_to_tensor": 3.0481508278586278e-05, "batch_individual_items": 1.9048747107340384e-05}}, "connector_pipeline_timer": 0.0001223434473225084}, "episode_return_mean": 2.1, "episode_return_min": -16.5, "episode_len_max": 50, "env_reset_timer": 0.00020872490270644464, "episode_len_min": 50, "episode_len_mean": 50.0, "weights_seq_no": 6.0, "episode_duration_sec_mean": 0.036846755019992086, "agent_episode_returns_mean": {"default_agent": 2.1}, "num_module_steps_sampled": {"default_policy": 1000}, "env_step_timer": 4.232484250151696e-05, "env_to_module_sum_episodes_length_in": 27.168093332126602, "episode_return_max": 17.5, "num_env_steps_sampled_lifetime": 31000, "num_episodes_lifetime": 120, "time_between_sampling": 4.22932365210436}, "num_healthy_workers": 1, "actor_manager_num_outstanding_async_reqs": 0, "num_remote_worker_restarts": 0}, "num_env_steps_sampled_lifetime": -960000.0, "fault_tolerance": {"num_healthy_workers": 0, "num_remote_worker_restarts": 0}, "env_runner_group": {"actor_manager_num_outstanding_async_reqs": 0}, "done": false, "training_iteration": 6, "trial_id": "0cb40_00000", "date": "2025-08-11_16-58-09", "timestamp": 1754924289, "time_this_iter_s": 5.07619571685791, "time_total_s": 30.374236822128296, "pid": 51873, "hostname": "DESKTOP-3SK5A41", "node_ip": "192.168.40.242", "config": {"exploration_config": {}, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 6, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "env": "Umbrella", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": false, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 0, "create_local_env_runner": true, "num_envs_per_env_runner": 1, "gym_env_vectorize_mode": "SYNC", "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "episodes_to_numpy": true, "max_requests_in_flight_per_env_runner": 1, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "merge_env_runner_states": "training_only", "broadcast_env_runner_states": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "complete_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "sampler_perf_stats_ema_coef": null, "_is_online": true, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": "auto", "num_aggregator_actors_per_learner": 0, "max_requests_in_flight_per_aggregator_actor": 3, "local_gpu_idx": 0, "max_requests_in_flight_per_learner": 3, "gamma": 1, "lr": 0.051764006447, "grad_clip": 0.5, "grad_clip_by": "global_norm", "_train_batch_size_per_learner": 5000, "train_batch_size": 4000, "num_epochs": 2, "minibatch_size": 1000, "shuffle_batch_per_epoch": true, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "log_std_clip_param": 20.0, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "_disable_preprocessor_api": false, "_disable_action_flattening": false}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "_learner_class": null, "callbacks_on_algorithm_init": null, "callbacks_on_env_runners_recreated": null, "callbacks_on_offline_eval_runners_recreated": null, "callbacks_on_checkpoint_loaded": null, "callbacks_on_environment_created": null, "callbacks_on_episode_created": null, "callbacks_on_episode_start": null, "callbacks_on_episode_step": null, "callbacks_on_episode_end": null, "callbacks_on_evaluate_start": null, "callbacks_on_evaluate_end": null, "callbacks_on_evaluate_offline_start": null, "callbacks_on_evaluate_offline_end": null, "callbacks_on_sample_end": null, "callbacks_on_train_result": null, "explore": true, "enable_rl_module_and_learner": true, "enable_env_runner_and_connector_v2": true, "_prior_exploration_config": {"type": "StochasticSampling"}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7384768d6ac0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "offline_data_class": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_read_batch_size": null, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "materialize_data": false, "materialize_mapped_data": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "ignore_final_observation": false, "prelearner_class": null, "prelearner_buffer_class": null, "prelearner_buffer_kwargs": {}, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_remaining_data": false, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": 1, "evaluation_duration": 20, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_auto_duration_min_env_steps_per_sample": 100, "evaluation_auto_duration_max_env_steps_per_sample": 2000, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 1, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "offline_evaluation_interval": null, "num_offline_eval_runners": 0, "offline_loss_for_module_fn": null, "offline_evaluation_duration": 1, "offline_evaluation_parallel_to_training": false, "offline_evaluation_timeout_s": 120.0, "num_cpus_per_offline_eval_runner": 1, "num_gpus_per_offline_eval_runner": 0, "custom_resources_per_offline_eval_runner": {}, "restart_failed_offline_eval_runners": true, "ignore_offline_eval_runner_failures": false, "max_num_offline_eval_runner_restarts": 1000, "offline_eval_runner_restore_timeout_s": 1800.0, "max_requests_in_flight_per_offline_eval_runner": 1, "validate_offline_eval_runners_after_construction": true, "offline_eval_runner_health_probe_timeout_s": 30.0, "offline_eval_rl_module_inference_only": false, "broadcast_offline_eval_runner_states": false, "offline_eval_batch_size_per_runner": 256, "dataset_num_iters_per_eval_runner": 1, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "log_gradients": true, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 42, "restart_failed_env_runners": true, "ignore_env_runner_failures": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30.0, "env_runner_restore_timeout_s": 1800.0, "_model_config": {}, "_rl_module_spec": "RLModuleSpec(module_class=None, observation_space=None, action_space=None, inference_only=False, learner_only=False, model_config=DefaultModelConfig(fcnet_hiddens=[102, 118], fcnet_activation='tanh', fcnet_kernel_initializer=None, fcnet_kernel_initializer_kwargs=None, fcnet_bias_initializer=None, fcnet_bias_initializer_kwargs=None, conv_filters=None, conv_activation='relu', conv_kernel_initializer=None, conv_kernel_initializer_kwargs=None, conv_bias_initializer=None, conv_bias_initializer_kwargs=None, head_fcnet_hiddens=[], head_fcnet_activation='relu', head_fcnet_kernel_initializer=None, head_fcnet_kernel_initializer_kwargs=None, head_fcnet_bias_initializer=None, head_fcnet_bias_initializer_kwargs=None, free_log_std=False, log_std_clip_param=20.0, vf_share_layers=True, use_lstm=False, max_seq_len=20, lstm_cell_size=256, lstm_use_prev_action=False, lstm_use_prev_reward=False, lstm_kernel_initializer=None, lstm_kernel_initializer_kwargs=None, lstm_bias_initializer=None, lstm_bias_initializer_kwargs=None), catalog_class=None, load_state_path=None, model_config_dict=None)", "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "_validate_config": true, "_use_msgpack_checkpoints": false, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "env_task_fn": -1, "enable_connectors": -1, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.3046515247992, "kl_target": 0.0133923296452, "vf_loss_coeff": 0.5729268330452, "entropy_coeff": 0.0173008632398, "clip_param": 0.1266464223803, "vf_clip_param": 0.1074181588462, "entropy_coeff_schedule": null, "lr_schedule": null, "sgd_minibatch_size": -1, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9419323156108, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.callbacks.callbacks.RLlibCallback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 30.374236822128296, "iterations_since_restore": 6, "perf": {"cpu_util_percent": 15.2, "ram_util_percent": 89.02857142857144}}
{"timers": {"training_iteration": 4.267206041104178, "restore_env_runners": 1.4127844428684795e-05, "training_step": 4.266935426796412, "env_runner_sampling_timer": 3.827156876612631, "learner_update_timer": 0.43610861189334243, "synch_weights": 0.0015227375082686775, "restore_eval_env_runners": 1.720257989556159e-05, "evaluation_iteration": 0.7746772720095758, "synch_eval_env_connectors": 0.00042152876147862696, "synch_env_connectors": 8.601070361065542e-06}, "env_runners": {"env_to_module_connector": {"timers": {"connectors": {"numpy_to_tensor": 3.1171250285716885e-05, "add_time_dim_to_batch_and_zero_pad": 6.3341358860218424e-06, "batch_individual_items": 1.8760619381015904e-05, "add_states_from_episodes_to_batch": 3.346047812933074e-06, "add_observations_from_episodes_to_batch": 6.552134887057604e-06}}, "connector_pipeline_timer": 0.00011901101354156211}, "weights_seq_no": 6.0, "module_episode_returns_mean": {"default_policy": -5.5}, "num_module_steps_sampled_lifetime": {"default_policy": -1202500.0}, "num_episodes_lifetime": -24050.0, "env_reset_timer": 9.861956255367713e-05, "module_to_env_connector": {"timers": {"connectors": {"remove_single_ts_time_rank_from_batch": 1.472801921060259e-06, "normalize_and_clip_actions": 2.228755164902882e-05, "get_actions": 0.00016281350361604051, "tensor_to_numpy": 4.876774625619056e-05, "listify_data_for_vector_env": 3.115997507110915e-05, "un_batch_to_individual_items": 1.4599674069510245e-05}}, "connector_pipeline_timer": 0.0003581792712455011}, "sample": 0.03775481810672351, "episode_len_min": 50, "num_episodes": 100.0, "num_env_steps_sampled": 5000.0, "episode_duration_sec_mean": 0.03638887999998587, "time_between_sampling": 0.012958273526081825, "num_agent_steps_sampled": {"default_agent": 5000.0}, "num_module_steps_sampled": {"default_policy": 5000.0}, "episode_len_mean": 50.0, "rlmodule_inference_timer": 9.976825333500954e-05, "agent_episode_returns_mean": {"default_agent": -5.5}, "episode_return_mean": -5.5, "env_step_timer": 4.292534534590858e-05, "env_to_module_sum_episodes_length_out": 27.16809333212661, "env_to_module_sum_episodes_length_in": 27.16809333212661, "episode_return_min": -5.5, "episode_len_max": 50, "episode_return_max": -5.5, "num_env_steps_sampled_lifetime": -1202500.0, "num_agent_steps_sampled_lifetime": {"default_agent": -1202500.0}, "num_env_steps_sampled_lifetime_throughput": 1290.901776122937}, "learners": {"default_policy": {"vf_loss_unclipped": 124.98329162597656, "diff_num_grad_updates_vs_sampler_policy": 1.0, "vf_explained_var": 0.030944764614105225, "mean_kl_loss": 0.00023591941862832755, "module_train_batch_size_mean": 1000.0, "num_trainable_parameters": 12919, "entropy": 0.006727756466716528, "default_optimizer_learning_rate": 0.051764006447, "policy_loss": 0.04319210350513458, "curr_kl_coeff": 0.08568324148654938, "total_loss": 0.10465888679027557, "weights_seq_no": 7.0, "gradients_default_optimizer_global_norm": 0.002141617238521576, "curr_entropy_coeff": 0.0173008632398, "vf_loss": 0.10741815716028214, "num_module_steps_trained": 11000, "num_module_steps_trained_lifetime": 77000, "num_module_steps_trained_lifetime_throughput": 189758.21666425286}, "__all_modules__": {"learner_connector": {"timers": {"connectors": {"batch_individual_items": 0.20159911303710767, "add_states_from_episodes_to_batch": 6.2771512852889424e-06, "numpy_to_tensor": 0.00016232869507041094, "add_columns_from_episodes_to_train_batch": 0.06757870725363217, "add_observations_from_episodes_to_batch": 0.0007587016350215342, "general_advantage_estimation": 0.015408948819349557, "add_time_dim_to_batch_and_zero_pad": 2.518818098153805e-05, "add_one_ts_to_episodes_and_truncate": 0.008572759917484768}}, "connector_pipeline_timer": 0.2944412794533852}, "num_module_steps_trained": 11000, "learner_connector_sum_episodes_length_out": 5100.0, "num_module_steps_trained_lifetime": 77000, "num_non_trainable_parameters": 0, "learner_connector_sum_episodes_length_in": 5000.0, "num_env_steps_trained": 56100, "num_trainable_parameters": 12919, "num_env_steps_trained_lifetime": 392700, "num_env_steps_trained_lifetime_throughput": 962361.6219574788, "num_module_steps_trained_throughput": 189355.61061632205, "num_module_steps_trained_lifetime_throughput": 189204.88093973382}}, "num_training_step_calls_per_iteration": 1, "evaluation": {"env_runners": {"sample": 0.7615086660587452, "module_to_env_connector": {"timers": {"connectors": {"normalize_and_clip_actions": 2.266918843420929e-05, "tensor_to_numpy": 4.8379306213488626e-05, "un_batch_to_individual_items": 1.5938041883324048e-05, "remove_single_ts_time_rank_from_batch": 1.5423312388178887e-06, "listify_data_for_vector_env": 3.2009313201613155e-05, "get_actions": 0.00016187594733522377}}, "connector_pipeline_timer": 0.0003667222613238565}, "num_episodes": 20, "num_module_steps_sampled_lifetime": {"default_policy": 7000}, "rlmodule_inference_timer": 0.00010358038176217541, "num_agent_steps_sampled": {"default_agent": 1000}, "env_to_module_sum_episodes_length_out": 27.168093332126602, "num_agent_steps_sampled_lifetime": {"default_agent": 7000}, "module_episode_returns_mean": {"default_policy": 2.1}, "num_env_steps_sampled": 1000, "env_to_module_connector": {"timers": {"connectors": {"add_time_dim_to_batch_and_zero_pad": 5.531675882611333e-06, "add_observations_from_episodes_to_batch": 6.6787081488885185e-06, "add_states_from_episodes_to_batch": 3.5231078999726472e-06, "numpy_to_tensor": 3.114519330677141e-05, "batch_individual_items": 1.9416026332408068e-05}}, "connector_pipeline_timer": 0.00012416951790878659}, "episode_return_mean": 2.1, "episode_return_min": -16.5, "episode_len_max": 50, "env_reset_timer": 0.00020867265368163196, "episode_len_min": 50, "episode_len_mean": 50.0, "weights_seq_no": 7.0, "episode_duration_sec_mean": 0.037042333019994655, "agent_episode_returns_mean": {"default_agent": 2.1}, "num_module_steps_sampled": {"default_policy": 1000}, "env_step_timer": 4.355392858127966e-05, "env_to_module_sum_episodes_length_in": 27.168093332126602, "episode_return_max": 17.5, "num_env_steps_sampled_lifetime": 36000, "num_episodes_lifetime": 140, "time_between_sampling": 4.228912312583315}, "num_healthy_workers": 1, "actor_manager_num_outstanding_async_reqs": 0, "num_remote_worker_restarts": 0}, "num_env_steps_sampled_lifetime": -1202500.0, "fault_tolerance": {"num_healthy_workers": 0, "num_remote_worker_restarts": 0}, "env_runner_group": {"actor_manager_num_outstanding_async_reqs": 0}, "done": true, "training_iteration": 7, "trial_id": "0cb40_00000", "date": "2025-08-11_16-58-14", "timestamp": 1754924294, "time_this_iter_s": 4.911374568939209, "time_total_s": 35.285611391067505, "pid": 51873, "hostname": "DESKTOP-3SK5A41", "node_ip": "192.168.40.242", "config": {"exploration_config": {}, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 6, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "env": "Umbrella", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": false, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 0, "create_local_env_runner": true, "num_envs_per_env_runner": 1, "gym_env_vectorize_mode": "SYNC", "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "episodes_to_numpy": true, "max_requests_in_flight_per_env_runner": 1, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "merge_env_runner_states": "training_only", "broadcast_env_runner_states": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "complete_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "sampler_perf_stats_ema_coef": null, "_is_online": true, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": "auto", "num_aggregator_actors_per_learner": 0, "max_requests_in_flight_per_aggregator_actor": 3, "local_gpu_idx": 0, "max_requests_in_flight_per_learner": 3, "gamma": 1, "lr": 0.051764006447, "grad_clip": 0.5, "grad_clip_by": "global_norm", "_train_batch_size_per_learner": 5000, "train_batch_size": 4000, "num_epochs": 2, "minibatch_size": 1000, "shuffle_batch_per_epoch": true, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "log_std_clip_param": 20.0, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "_disable_preprocessor_api": false, "_disable_action_flattening": false}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "_learner_class": null, "callbacks_on_algorithm_init": null, "callbacks_on_env_runners_recreated": null, "callbacks_on_offline_eval_runners_recreated": null, "callbacks_on_checkpoint_loaded": null, "callbacks_on_environment_created": null, "callbacks_on_episode_created": null, "callbacks_on_episode_start": null, "callbacks_on_episode_step": null, "callbacks_on_episode_end": null, "callbacks_on_evaluate_start": null, "callbacks_on_evaluate_end": null, "callbacks_on_evaluate_offline_start": null, "callbacks_on_evaluate_offline_end": null, "callbacks_on_sample_end": null, "callbacks_on_train_result": null, "explore": true, "enable_rl_module_and_learner": true, "enable_env_runner_and_connector_v2": true, "_prior_exploration_config": {"type": "StochasticSampling"}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7384768d6ac0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "offline_data_class": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_read_batch_size": null, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "materialize_data": false, "materialize_mapped_data": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "ignore_final_observation": false, "prelearner_class": null, "prelearner_buffer_class": null, "prelearner_buffer_kwargs": {}, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_remaining_data": false, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": 1, "evaluation_duration": 20, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_auto_duration_min_env_steps_per_sample": 100, "evaluation_auto_duration_max_env_steps_per_sample": 2000, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 1, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "offline_evaluation_interval": null, "num_offline_eval_runners": 0, "offline_loss_for_module_fn": null, "offline_evaluation_duration": 1, "offline_evaluation_parallel_to_training": false, "offline_evaluation_timeout_s": 120.0, "num_cpus_per_offline_eval_runner": 1, "num_gpus_per_offline_eval_runner": 0, "custom_resources_per_offline_eval_runner": {}, "restart_failed_offline_eval_runners": true, "ignore_offline_eval_runner_failures": false, "max_num_offline_eval_runner_restarts": 1000, "offline_eval_runner_restore_timeout_s": 1800.0, "max_requests_in_flight_per_offline_eval_runner": 1, "validate_offline_eval_runners_after_construction": true, "offline_eval_runner_health_probe_timeout_s": 30.0, "offline_eval_rl_module_inference_only": false, "broadcast_offline_eval_runner_states": false, "offline_eval_batch_size_per_runner": 256, "dataset_num_iters_per_eval_runner": 1, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "log_gradients": true, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 42, "restart_failed_env_runners": true, "ignore_env_runner_failures": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30.0, "env_runner_restore_timeout_s": 1800.0, "_model_config": {}, "_rl_module_spec": "RLModuleSpec(module_class=None, observation_space=None, action_space=None, inference_only=False, learner_only=False, model_config=DefaultModelConfig(fcnet_hiddens=[102, 118], fcnet_activation='tanh', fcnet_kernel_initializer=None, fcnet_kernel_initializer_kwargs=None, fcnet_bias_initializer=None, fcnet_bias_initializer_kwargs=None, conv_filters=None, conv_activation='relu', conv_kernel_initializer=None, conv_kernel_initializer_kwargs=None, conv_bias_initializer=None, conv_bias_initializer_kwargs=None, head_fcnet_hiddens=[], head_fcnet_activation='relu', head_fcnet_kernel_initializer=None, head_fcnet_kernel_initializer_kwargs=None, head_fcnet_bias_initializer=None, head_fcnet_bias_initializer_kwargs=None, free_log_std=False, log_std_clip_param=20.0, vf_share_layers=True, use_lstm=False, max_seq_len=20, lstm_cell_size=256, lstm_use_prev_action=False, lstm_use_prev_reward=False, lstm_kernel_initializer=None, lstm_kernel_initializer_kwargs=None, lstm_bias_initializer=None, lstm_bias_initializer_kwargs=None), catalog_class=None, load_state_path=None, model_config_dict=None)", "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "_validate_config": true, "_use_msgpack_checkpoints": false, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "env_task_fn": -1, "enable_connectors": -1, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.3046515247992, "kl_target": 0.0133923296452, "vf_loss_coeff": 0.5729268330452, "entropy_coeff": 0.0173008632398, "clip_param": 0.1266464223803, "vf_clip_param": 0.1074181588462, "entropy_coeff_schedule": null, "lr_schedule": null, "sgd_minibatch_size": -1, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9419323156108, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.callbacks.callbacks.RLlibCallback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 35.285611391067505, "iterations_since_restore": 7, "perf": {"cpu_util_percent": 13.942857142857145, "ram_util_percent": 89.02857142857144}}
