{"timers": {"training_iteration": 4.262150323000014, "restore_env_runners": 5.199999986871262e-05, "training_step": 4.2618669230000705, "env_runner_sampling_timer": 3.83949001100018, "learner_update_timer": 0.41896471200016094, "synch_weights": 0.0014478000000508473}, "env_runners": {"num_episodes_lifetime": 5050.0, "weights_seq_no": 0.0, "env_to_module_sum_episodes_length_in": 26.762340024562445, "env_to_module_connector": {"timers": {"connectors": {"add_observations_from_episodes_to_batch": 6.50138460461061e-06, "numpy_to_tensor": 3.129168793717458e-05, "add_states_from_episodes_to_batch": 3.506774605913952e-06, "add_time_dim_to_batch_and_zero_pad": 6.381553156171803e-06, "batch_individual_items": 1.892014566355639e-05}}, "connector_pipeline_timer": 0.00012252341861114207}, "env_step_timer": 4.4119572154801194e-05, "rlmodule_inference_timer": 0.00010060120178866069, "episode_len_mean": 50.0, "agent_episode_returns_mean": {"default_agent": 5.899999999999999}, "num_episodes": 100.0, "module_to_env_connector": {"timers": {"connectors": {"un_batch_to_individual_items": 1.5118564637651706e-05, "tensor_to_numpy": 4.823359636993329e-05, "listify_data_for_vector_env": 3.1575488324595063e-05, "get_actions": 0.00016736232810684194, "remove_single_ts_time_rank_from_batch": 1.4326317804679386e-06, "normalize_and_clip_actions": 2.8772423886886903e-05}}, "connector_pipeline_timer": 0.0003694193521082687}, "env_reset_timer": 0.0001984779639655967, "episode_duration_sec_mean": 0.03587107500999309, "episode_return_min": -5.5, "module_episode_returns_mean": {"default_policy": 5.899999999999999}, "episode_return_max": 14.5, "num_env_steps_sampled": 5000.0, "num_env_steps_sampled_lifetime": 252500.0, "sample": 0.03924521007514703, "time_between_sampling": 0.0012333379346948236, "episode_return_mean": 5.899999999999999, "num_agent_steps_sampled": {"default_agent": 5000.0}, "num_agent_steps_sampled_lifetime": {"default_agent": 252500.0}, "num_module_steps_sampled": {"default_policy": 5000.0}, "episode_len_min": 50, "episode_len_max": 50, "num_module_steps_sampled_lifetime": {"default_policy": 252500.0}, "env_to_module_sum_episodes_length_out": 26.762340024562445, "num_env_steps_sampled_lifetime_throughput": 1262.6720308677063}, "learners": {"default_policy": {"vf_explained_var": -0.036456942558288574, "mean_kl_loss": 0.01944909431040287, "default_optimizer_learning_rate": 0.0172526494441, "curr_entropy_coeff": 0.0337584304442, "diff_num_grad_updates_vs_sampler_policy": 1.0, "vf_loss": 0.39602863788604736, "module_train_batch_size_mean": 1000.0, "total_loss": 0.5109702348709106, "num_module_steps_trained": 6000, "policy_loss": 0.16025444865226746, "weights_seq_no": 1.0, "num_trainable_parameters": 3243, "curr_kl_coeff": 0.4489886462688446, "gradients_default_optimizer_global_norm": 0.09374451637268066, "entropy": 0.6621792912483215, "num_module_steps_trained_lifetime": 6000, "vf_loss_unclipped": 20.82182502746582, "num_module_steps_trained_lifetime_throughput": 194762.2996714878}, "__all_modules__": {"learner_connector": {"timers": {"connectors": {"add_one_ts_to_episodes_and_truncate": 0.00840480000010757, "add_time_dim_to_batch_and_zero_pad": 2.5800000003073364e-05, "add_columns_from_episodes_to_train_batch": 0.07034270199983439, "add_observations_from_episodes_to_batch": 0.0007744999998067215, "add_states_from_episodes_to_batch": 6.199999916134402e-06, "batch_individual_items": 0.20230620600000293, "numpy_to_tensor": 0.0001695000000836444, "general_advantage_estimation": 0.011460400000032678}}, "connector_pipeline_timer": 0.2938573080000424}, "num_module_steps_trained": 6000, "num_trainable_parameters": 3243, "num_module_steps_trained_lifetime": 6000, "learner_connector_sum_episodes_length_in": 5000, "learner_connector_sum_episodes_length_out": 5100, "num_non_trainable_parameters": 0, "num_env_steps_trained": 30600, "num_env_steps_trained_lifetime": 30600, "num_env_steps_trained_lifetime_throughput": 990454.8672450206, "num_module_steps_trained_throughput": 194208.00893660611, "num_module_steps_trained_lifetime_throughput": 194683.02996478925}}, "num_training_step_calls_per_iteration": 1, "num_env_steps_sampled_lifetime": 252500.0, "evaluation": {"env_runners": {"module_to_env_connector": {"connector_pipeline_timer": 0.0003375667788723376, "timers": {"connectors": {"tensor_to_numpy": 4.515461314749307e-05, "remove_single_ts_time_rank_from_batch": 1.3761089692680485e-06, "un_batch_to_individual_items": 1.5900592590785555e-05, "listify_data_for_vector_env": 2.9728464097199006e-05, "get_actions": 0.00015136505646800173, "normalize_and_clip_actions": 2.2513250410313202e-05}}}, "num_module_steps_sampled": {"default_policy": 1000}, "num_episodes_lifetime": 20, "env_to_module_connector": {"timers": {"connectors": {"add_states_from_episodes_to_batch": 3.139127272048428e-06, "add_observations_from_episodes_to_batch": 6.125313102588563e-06, "numpy_to_tensor": 2.8948120351443978e-05, "batch_individual_items": 1.879220237108902e-05, "add_time_dim_to_batch_and_zero_pad": 5.702557186399977e-06}}, "connector_pipeline_timer": 0.00011184631531220701}, "num_agent_steps_sampled": {"default_agent": 1000}, "episode_len_max": 50, "weights_seq_no": 1.0, "num_episodes": 20, "agent_episode_returns_mean": {"default_agent": -3.9}, "sample": 0.7194947210000464, "episode_return_mean": -3.9, "num_agent_steps_sampled_lifetime": {"default_agent": 1000}, "env_to_module_sum_episodes_length_out": 27.167134025045954, "env_step_timer": 4.0873783925482335e-05, "episode_len_mean": 50.0, "env_reset_timer": 0.00021020000008320494, "episode_duration_sec_mean": 0.03454408105001221, "module_episode_returns_mean": {"default_policy": -3.9}, "episode_return_max": 17.5, "num_env_steps_sampled": 1000, "num_env_steps_sampled_lifetime": 6000, "episode_len_min": 50, "env_to_module_sum_episodes_length_in": 27.167134025045954, "num_module_steps_sampled_lifetime": {"default_policy": 1000}, "rlmodule_inference_timer": 9.136542342508962e-05, "episode_return_min": -14.5}, "num_healthy_workers": 1, "actor_manager_num_outstanding_async_reqs": 0, "num_remote_worker_restarts": 0}, "fault_tolerance": {"num_healthy_workers": 0, "num_remote_worker_restarts": 0}, "env_runner_group": {"actor_manager_num_outstanding_async_reqs": 0}, "done": false, "training_iteration": 1, "trial_id": "47270_00000", "date": "2025-08-11_16-31-46", "timestamp": 1754922706, "time_this_iter_s": 4.997000455856323, "time_total_s": 4.997000455856323, "pid": 30391, "hostname": "DESKTOP-3SK5A41", "node_ip": "192.168.40.242", "config": {"exploration_config": {}, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 6, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "env": "Umbrella", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": false, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 0, "create_local_env_runner": true, "num_envs_per_env_runner": 1, "gym_env_vectorize_mode": "SYNC", "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "episodes_to_numpy": true, "max_requests_in_flight_per_env_runner": 1, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "merge_env_runner_states": "training_only", "broadcast_env_runner_states": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "complete_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "sampler_perf_stats_ema_coef": null, "_is_online": true, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": "auto", "num_aggregator_actors_per_learner": 0, "max_requests_in_flight_per_aggregator_actor": 3, "local_gpu_idx": 0, "max_requests_in_flight_per_learner": 3, "gamma": 1, "lr": 0.0172526494441, "grad_clip": 0.5, "grad_clip_by": "global_norm", "_train_batch_size_per_learner": 5000, "train_batch_size": 4000, "num_epochs": 1, "minibatch_size": 1000, "shuffle_batch_per_epoch": true, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "log_std_clip_param": 20.0, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "_disable_preprocessor_api": false, "_disable_action_flattening": false}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "_learner_class": null, "callbacks_on_algorithm_init": null, "callbacks_on_env_runners_recreated": null, "callbacks_on_offline_eval_runners_recreated": null, "callbacks_on_checkpoint_loaded": null, "callbacks_on_environment_created": null, "callbacks_on_episode_created": null, "callbacks_on_episode_start": null, "callbacks_on_episode_step": null, "callbacks_on_episode_end": null, "callbacks_on_evaluate_start": null, "callbacks_on_evaluate_end": null, "callbacks_on_evaluate_offline_start": null, "callbacks_on_evaluate_offline_end": null, "callbacks_on_sample_end": null, "callbacks_on_train_result": null, "explore": true, "enable_rl_module_and_learner": true, "enable_env_runner_and_connector_v2": true, "_prior_exploration_config": {"type": "StochasticSampling"}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7e025dcd2ac0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "offline_data_class": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_read_batch_size": null, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "materialize_data": false, "materialize_mapped_data": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "ignore_final_observation": false, "prelearner_class": null, "prelearner_buffer_class": null, "prelearner_buffer_kwargs": {}, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_remaining_data": false, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": 1, "evaluation_duration": 20, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_auto_duration_min_env_steps_per_sample": 100, "evaluation_auto_duration_max_env_steps_per_sample": 2000, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 1, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "offline_evaluation_interval": null, "num_offline_eval_runners": 0, "offline_loss_for_module_fn": null, "offline_evaluation_duration": 1, "offline_evaluation_parallel_to_training": false, "offline_evaluation_timeout_s": 120.0, "num_cpus_per_offline_eval_runner": 1, "num_gpus_per_offline_eval_runner": 0, "custom_resources_per_offline_eval_runner": {}, "restart_failed_offline_eval_runners": true, "ignore_offline_eval_runner_failures": false, "max_num_offline_eval_runner_restarts": 1000, "offline_eval_runner_restore_timeout_s": 1800.0, "max_requests_in_flight_per_offline_eval_runner": 1, "validate_offline_eval_runners_after_construction": true, "offline_eval_runner_health_probe_timeout_s": 30.0, "offline_eval_rl_module_inference_only": false, "broadcast_offline_eval_runner_states": false, "offline_eval_batch_size_per_runner": 256, "dataset_num_iters_per_eval_runner": 1, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "log_gradients": true, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 42, "restart_failed_env_runners": true, "ignore_env_runner_failures": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30.0, "env_runner_restore_timeout_s": 1800.0, "_model_config": {}, "_rl_module_spec": "RLModuleSpec(module_class=None, observation_space=None, action_space=None, inference_only=False, learner_only=False, model_config=DefaultModelConfig(fcnet_hiddens=[40, 70], fcnet_activation='tanh', fcnet_kernel_initializer=None, fcnet_kernel_initializer_kwargs=None, fcnet_bias_initializer=None, fcnet_bias_initializer_kwargs=None, conv_filters=None, conv_activation='relu', conv_kernel_initializer=None, conv_kernel_initializer_kwargs=None, conv_bias_initializer=None, conv_bias_initializer_kwargs=None, head_fcnet_hiddens=[], head_fcnet_activation='relu', head_fcnet_kernel_initializer=None, head_fcnet_kernel_initializer_kwargs=None, head_fcnet_bias_initializer=None, head_fcnet_bias_initializer_kwargs=None, free_log_std=False, log_std_clip_param=20.0, vf_share_layers=True, use_lstm=False, max_seq_len=20, lstm_cell_size=256, lstm_use_prev_action=False, lstm_use_prev_reward=False, lstm_kernel_initializer=None, lstm_kernel_initializer_kwargs=None, lstm_bias_initializer=None, lstm_bias_initializer_kwargs=None), catalog_class=None, load_state_path=None, model_config_dict=None)", "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "_validate_config": true, "_use_msgpack_checkpoints": false, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "env_task_fn": -1, "enable_connectors": -1, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.44898865101, "kl_target": 0.0266033419126, "vf_loss_coeff": 0.9199777793643, "entropy_coeff": 0.0337584304442, "clip_param": 0.2910474513012, "vf_clip_param": 0.4300448978078, "entropy_coeff_schedule": null, "lr_schedule": null, "sgd_minibatch_size": -1, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9481376372503, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.callbacks.callbacks.RLlibCallback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 4.997000455856323, "iterations_since_restore": 1, "perf": {"cpu_util_percent": 10.7, "ram_util_percent": 89.5125}}
{"timers": {"training_iteration": 4.260654758830012, "restore_env_runners": 5.163299987088976e-05, "training_step": 4.260368825830069, "env_runner_sampling_timer": 3.840403575930179, "learner_update_timer": 0.41655016490015895, "synch_weights": 0.0014478220000501095, "restore_eval_env_runners": 1.2599999990925426e-05, "evaluation_iteration": 0.7311314219998621, "synch_eval_env_connectors": 0.00041020000003300083, "synch_env_connectors": 7.500000037907739e-06}, "env_runners": {"num_episodes_lifetime": 200.0, "weights_seq_no": 1.0, "env_to_module_sum_episodes_length_in": 27.16809333212661, "env_to_module_connector": {"timers": {"connectors": {"add_observations_from_episodes_to_batch": 6.393079292735951e-06, "numpy_to_tensor": 3.132356443433612e-05, "add_states_from_episodes_to_batch": 3.4619853099062346e-06, "add_time_dim_to_batch_and_zero_pad": 6.2559080490189155e-06, "batch_individual_items": 1.8855507329288397e-05}}, "connector_pipeline_timer": 0.00011927499241359184}, "env_step_timer": 4.3486871268445286e-05, "rlmodule_inference_timer": 9.870156644382831e-05, "episode_len_mean": 50.0, "agent_episode_returns_mean": {"default_agent": 7.1}, "num_episodes": 100.0, "module_to_env_connector": {"timers": {"connectors": {"un_batch_to_individual_items": 1.5231574295129952e-05, "tensor_to_numpy": 5.015069679889801e-05, "listify_data_for_vector_env": 3.1642677448355937e-05, "get_actions": 0.00016608842676012428, "remove_single_ts_time_rank_from_batch": 1.438338878677834e-06, "normalize_and_clip_actions": 2.2827626889095617e-05}}, "connector_pipeline_timer": 0.00036472596593108836}, "env_reset_timer": 0.000133650810253508, "episode_duration_sec_mean": 0.03674161798999876, "episode_return_min": -5.5, "module_episode_returns_mean": {"default_policy": 7.1}, "episode_return_max": 14.5, "num_env_steps_sampled": 5000.0, "num_env_steps_sampled_lifetime": 10000.0, "sample": 0.03808108371100811, "time_between_sampling": 0.00895602781160148, "episode_return_mean": 7.1, "num_agent_steps_sampled": {"default_agent": 5000.0}, "num_agent_steps_sampled_lifetime": {"default_agent": 10000.0}, "num_module_steps_sampled": {"default_policy": 5000.0}, "episode_len_min": 50, "episode_len_max": 50, "num_module_steps_sampled_lifetime": {"default_policy": 10000.0}, "env_to_module_sum_episodes_length_out": 27.16809333212661, "num_env_steps_sampled_lifetime_throughput": 1278.5897320554836}, "learners": {"default_policy": {"vf_explained_var": -0.21655356884002686, "mean_kl_loss": 0.013736218214035034, "default_optimizer_learning_rate": 0.0172526494441, "curr_entropy_coeff": 0.0337584304442, "diff_num_grad_updates_vs_sampler_policy": 1.0, "vf_loss": 0.4173579514026642, "module_train_batch_size_mean": 1000.0, "total_loss": 0.08296110481023788, "num_module_steps_trained": 6000, "policy_loss": -0.28503894805908203, "weights_seq_no": 2.0, "num_trainable_parameters": 3243, "curr_kl_coeff": 0.4489886462688446, "gradients_default_optimizer_global_norm": 0.12400628626346588, "entropy": 0.655461311340332, "num_module_steps_trained_lifetime": 12000, "vf_loss_unclipped": 24.335411071777344, "num_module_steps_trained_lifetime_throughput": 194290.40955873334}, "__all_modules__": {"learner_connector": {"timers": {"connectors": {"add_one_ts_to_episodes_and_truncate": 0.008402217000107157, "add_time_dim_to_batch_and_zero_pad": 2.5779000002330576e-05, "add_columns_from_episodes_to_train_batch": 0.07030522398983749, "add_observations_from_episodes_to_batch": 0.0007737379998070537, "add_states_from_episodes_to_batch": 6.197999916821573e-06, "batch_individual_items": 0.20085657695000236, "numpy_to_tensor": 0.0001694650000808906, "general_advantage_estimation": 0.011438073000031182}}, "connector_pipeline_timer": 0.29234396894004244}, "num_module_steps_trained": 6000, "num_trainable_parameters": 3243, "num_module_steps_trained_lifetime": 12000, "learner_connector_sum_episodes_length_in": 5000.0, "learner_connector_sum_episodes_length_out": 5100.0, "num_non_trainable_parameters": 0, "num_env_steps_trained": 30600, "num_env_steps_trained_lifetime": 61200, "num_env_steps_trained_lifetime_throughput": 988091.0192254755, "num_module_steps_trained_throughput": 193745.98355882158, "num_module_steps_trained_lifetime_throughput": 194213.7805983563}}, "num_training_step_calls_per_iteration": 1, "evaluation": {"env_runners": {"module_to_env_connector": {"connector_pipeline_timer": 0.000338215768438983, "timers": {"connectors": {"tensor_to_numpy": 4.568670351517103e-05, "remove_single_ts_time_rank_from_batch": 1.3873157095804958e-06, "un_batch_to_individual_items": 1.573164737020129e-05, "listify_data_for_vector_env": 3.0301900796068515e-05, "get_actions": 0.00015099984150270955, "normalize_and_clip_actions": 2.193604815075148e-05}}}, "num_module_steps_sampled": {"default_policy": 1000}, "num_episodes_lifetime": 40, "env_to_module_connector": {"timers": {"connectors": {"add_states_from_episodes_to_batch": 3.1178407930746457e-06, "add_observations_from_episodes_to_batch": 6.107727461314725e-06, "numpy_to_tensor": 2.896667566552355e-05, "batch_individual_items": 1.8246490404064787e-05, "add_time_dim_to_batch_and_zero_pad": 5.622962910527824e-06}}, "connector_pipeline_timer": 0.00011026461681381423}, "num_agent_steps_sampled": {"default_agent": 1000}, "episode_len_max": 50, "weights_seq_no": 2.0, "num_episodes": 20, "agent_episode_returns_mean": {"default_agent": -3.4}, "sample": 0.7195050468800446, "episode_return_mean": -3.4, "num_agent_steps_sampled_lifetime": {"default_agent": 2000}, "env_to_module_sum_episodes_length_out": 27.168093298253442, "env_step_timer": 4.1143331604369623e-05, "episode_len_mean": 50.0, "env_reset_timer": 0.00020965200008276952, "episode_duration_sec_mean": 0.034569278225012566, "module_episode_returns_mean": {"default_policy": -3.4}, "episode_return_max": 17.5, "num_env_steps_sampled": 1000, "num_env_steps_sampled_lifetime": 11000, "episode_len_min": 50, "env_to_module_sum_episodes_length_in": 27.168093298253442, "num_module_steps_sampled_lifetime": {"default_policy": 2000}, "rlmodule_inference_timer": 9.168497657986232e-05, "episode_return_min": -16.5, "time_between_sampling": 4.169139207999933}, "num_healthy_workers": 1, "actor_manager_num_outstanding_async_reqs": 0, "num_remote_worker_restarts": 0}, "num_env_steps_sampled_lifetime": 10000.0, "fault_tolerance": {"num_healthy_workers": 0, "num_remote_worker_restarts": 0}, "env_runner_group": {"actor_manager_num_outstanding_async_reqs": 0}, "done": false, "training_iteration": 2, "trial_id": "47270_00000", "date": "2025-08-11_16-31-51", "timestamp": 1754922711, "time_this_iter_s": 4.847764015197754, "time_total_s": 9.844764471054077, "pid": 30391, "hostname": "DESKTOP-3SK5A41", "node_ip": "192.168.40.242", "config": {"exploration_config": {}, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 6, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "env": "Umbrella", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": false, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 0, "create_local_env_runner": true, "num_envs_per_env_runner": 1, "gym_env_vectorize_mode": "SYNC", "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "episodes_to_numpy": true, "max_requests_in_flight_per_env_runner": 1, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "merge_env_runner_states": "training_only", "broadcast_env_runner_states": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "complete_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "sampler_perf_stats_ema_coef": null, "_is_online": true, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": "auto", "num_aggregator_actors_per_learner": 0, "max_requests_in_flight_per_aggregator_actor": 3, "local_gpu_idx": 0, "max_requests_in_flight_per_learner": 3, "gamma": 1, "lr": 0.0172526494441, "grad_clip": 0.5, "grad_clip_by": "global_norm", "_train_batch_size_per_learner": 5000, "train_batch_size": 4000, "num_epochs": 1, "minibatch_size": 1000, "shuffle_batch_per_epoch": true, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "log_std_clip_param": 20.0, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "_disable_preprocessor_api": false, "_disable_action_flattening": false}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "_learner_class": null, "callbacks_on_algorithm_init": null, "callbacks_on_env_runners_recreated": null, "callbacks_on_offline_eval_runners_recreated": null, "callbacks_on_checkpoint_loaded": null, "callbacks_on_environment_created": null, "callbacks_on_episode_created": null, "callbacks_on_episode_start": null, "callbacks_on_episode_step": null, "callbacks_on_episode_end": null, "callbacks_on_evaluate_start": null, "callbacks_on_evaluate_end": null, "callbacks_on_evaluate_offline_start": null, "callbacks_on_evaluate_offline_end": null, "callbacks_on_sample_end": null, "callbacks_on_train_result": null, "explore": true, "enable_rl_module_and_learner": true, "enable_env_runner_and_connector_v2": true, "_prior_exploration_config": {"type": "StochasticSampling"}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7e025dcd2ac0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "offline_data_class": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_read_batch_size": null, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "materialize_data": false, "materialize_mapped_data": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "ignore_final_observation": false, "prelearner_class": null, "prelearner_buffer_class": null, "prelearner_buffer_kwargs": {}, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_remaining_data": false, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": 1, "evaluation_duration": 20, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_auto_duration_min_env_steps_per_sample": 100, "evaluation_auto_duration_max_env_steps_per_sample": 2000, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 1, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "offline_evaluation_interval": null, "num_offline_eval_runners": 0, "offline_loss_for_module_fn": null, "offline_evaluation_duration": 1, "offline_evaluation_parallel_to_training": false, "offline_evaluation_timeout_s": 120.0, "num_cpus_per_offline_eval_runner": 1, "num_gpus_per_offline_eval_runner": 0, "custom_resources_per_offline_eval_runner": {}, "restart_failed_offline_eval_runners": true, "ignore_offline_eval_runner_failures": false, "max_num_offline_eval_runner_restarts": 1000, "offline_eval_runner_restore_timeout_s": 1800.0, "max_requests_in_flight_per_offline_eval_runner": 1, "validate_offline_eval_runners_after_construction": true, "offline_eval_runner_health_probe_timeout_s": 30.0, "offline_eval_rl_module_inference_only": false, "broadcast_offline_eval_runner_states": false, "offline_eval_batch_size_per_runner": 256, "dataset_num_iters_per_eval_runner": 1, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "log_gradients": true, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 42, "restart_failed_env_runners": true, "ignore_env_runner_failures": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30.0, "env_runner_restore_timeout_s": 1800.0, "_model_config": {}, "_rl_module_spec": "RLModuleSpec(module_class=None, observation_space=None, action_space=None, inference_only=False, learner_only=False, model_config=DefaultModelConfig(fcnet_hiddens=[40, 70], fcnet_activation='tanh', fcnet_kernel_initializer=None, fcnet_kernel_initializer_kwargs=None, fcnet_bias_initializer=None, fcnet_bias_initializer_kwargs=None, conv_filters=None, conv_activation='relu', conv_kernel_initializer=None, conv_kernel_initializer_kwargs=None, conv_bias_initializer=None, conv_bias_initializer_kwargs=None, head_fcnet_hiddens=[], head_fcnet_activation='relu', head_fcnet_kernel_initializer=None, head_fcnet_kernel_initializer_kwargs=None, head_fcnet_bias_initializer=None, head_fcnet_bias_initializer_kwargs=None, free_log_std=False, log_std_clip_param=20.0, vf_share_layers=True, use_lstm=False, max_seq_len=20, lstm_cell_size=256, lstm_use_prev_action=False, lstm_use_prev_reward=False, lstm_kernel_initializer=None, lstm_kernel_initializer_kwargs=None, lstm_bias_initializer=None, lstm_bias_initializer_kwargs=None), catalog_class=None, load_state_path=None, model_config_dict=None)", "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "_validate_config": true, "_use_msgpack_checkpoints": false, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "env_task_fn": -1, "enable_connectors": -1, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.44898865101, "kl_target": 0.0266033419126, "vf_loss_coeff": 0.9199777793643, "entropy_coeff": 0.0337584304442, "clip_param": 0.2910474513012, "vf_clip_param": 0.4300448978078, "entropy_coeff_schedule": null, "lr_schedule": null, "sgd_minibatch_size": -1, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9481376372503, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.callbacks.callbacks.RLlibCallback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 9.844764471054077, "iterations_since_restore": 2, "perf": {"cpu_util_percent": 13.014285714285714, "ram_util_percent": 89.70000000000002}}
{"timers": {"training_iteration": 4.260775908791711, "restore_env_runners": 5.124766987150906e-05, "training_step": 4.260488750121767, "env_runner_sampling_timer": 3.842812412690878, "learner_update_timer": 0.41425880128115533, "synch_weights": 0.0014480927800513653, "restore_eval_env_runners": 1.259599999002603e-05, "evaluation_iteration": 0.7311229208698637, "synch_eval_env_connectors": 0.00041000900003382415, "synch_env_connectors": 7.498000038594909e-06}, "env_runners": {"num_episodes_lifetime": -4650.0, "weights_seq_no": 2.0, "env_to_module_sum_episodes_length_in": 27.16809333212661, "env_to_module_connector": {"timers": {"connectors": {"add_observations_from_episodes_to_batch": 6.464100038973277e-06, "numpy_to_tensor": 3.142768573963124e-05, "add_states_from_episodes_to_batch": 3.510879291124723e-06, "add_time_dim_to_batch_and_zero_pad": 6.283767431910534e-06, "batch_individual_items": 1.875307957721659e-05}}, "connector_pipeline_timer": 0.00011921756649217398}, "env_step_timer": 4.343338365559483e-05, "rlmodule_inference_timer": 0.00013340136633600914, "episode_len_mean": 50.0, "agent_episode_returns_mean": {"default_agent": 6.5}, "num_episodes": 100.0, "module_to_env_connector": {"timers": {"connectors": {"un_batch_to_individual_items": 1.5124908146427331e-05, "tensor_to_numpy": 5.010289327732977e-05, "listify_data_for_vector_env": 3.146609692330213e-05, "get_actions": 0.0001667720972668241, "remove_single_ts_time_rank_from_batch": 1.4210742547620233e-06, "normalize_and_clip_actions": 2.262086022523942e-05}}, "connector_pipeline_timer": 0.00036446279992953577}, "env_reset_timer": 0.00010990249562696309, "episode_duration_sec_mean": 0.038163223470010055, "episode_return_min": -5.5, "module_episode_returns_mean": {"default_policy": 6.5}, "episode_return_max": 14.5, "num_env_steps_sampled": 5000.0, "num_env_steps_sampled_lifetime": -232500.0, "sample": 0.03827580105664887, "time_between_sampling": 0.010293521657741014, "episode_return_mean": 6.5, "num_agent_steps_sampled": {"default_agent": 5000.0}, "num_agent_steps_sampled_lifetime": {"default_agent": -232500.0}, "num_module_steps_sampled": {"default_policy": 5000.0}, "episode_len_min": 50, "episode_len_max": 50, "num_module_steps_sampled_lifetime": {"default_policy": -232500.0}, "env_to_module_sum_episodes_length_out": 27.16809333212661, "num_env_steps_sampled_lifetime_throughput": 1266.6493438144755}, "learners": {"default_policy": {"vf_explained_var": -0.3109853267669678, "mean_kl_loss": 0.0014474795898422599, "default_optimizer_learning_rate": 0.0172526494441, "curr_entropy_coeff": 0.0337584304442, "diff_num_grad_updates_vs_sampler_policy": 1.0, "vf_loss": 0.41264596581459045, "module_train_batch_size_mean": 1000.0, "total_loss": 0.31769052147865295, "num_module_steps_trained": 6000, "policy_loss": -0.040525034070014954, "weights_seq_no": 3.0, "num_trainable_parameters": 3243, "curr_kl_coeff": 0.2244943231344223, "gradients_default_optimizer_global_norm": 0.12587003409862518, "entropy": 0.6534489989280701, "num_module_steps_trained_lifetime": 18000, "vf_loss_unclipped": 22.70220184326172, "num_module_steps_trained_lifetime_throughput": 193496.1252264229}, "__all_modules__": {"learner_connector": {"timers": {"connectors": {"add_one_ts_to_episodes_and_truncate": 0.008403895830106513, "add_time_dim_to_batch_and_zero_pad": 2.5771210000539213e-05, "add_columns_from_episodes_to_train_batch": 0.07033299875993887, "add_observations_from_episodes_to_batch": 0.0007735626198073988, "add_states_from_episodes_to_batch": 6.195019918982325e-06, "batch_individual_items": 0.1994268551905037, "numpy_to_tensor": 0.00017027435008149042, "general_advantage_estimation": 0.011430814270030305}}, "connector_pipeline_timer": 0.290936844270643}, "num_module_steps_trained": 6000, "num_trainable_parameters": 3243, "num_module_steps_trained_lifetime": 18000, "learner_connector_sum_episodes_length_in": 5000.0, "learner_connector_sum_episodes_length_out": 5100.0, "num_non_trainable_parameters": 0, "num_env_steps_trained": 30600, "num_env_steps_trained_lifetime": 91800, "num_env_steps_trained_lifetime_throughput": 984107.34423195, "num_module_steps_trained_throughput": 192969.8926520286, "num_module_steps_trained_lifetime_throughput": 193424.14072317886}}, "num_training_step_calls_per_iteration": 1, "evaluation": {"env_runners": {"module_to_env_connector": {"connector_pipeline_timer": 0.0003521670420212933, "timers": {"connectors": {"tensor_to_numpy": 4.6765306628112594e-05, "remove_single_ts_time_rank_from_batch": 1.482694910309131e-06, "un_batch_to_individual_items": 1.6723375706093148e-05, "listify_data_for_vector_env": 3.149725919081798e-05, "get_actions": 0.000158403002454723, "normalize_and_clip_actions": 2.3401191395181152e-05}}}, "num_module_steps_sampled": {"default_policy": 1000}, "num_episodes_lifetime": 60, "env_to_module_connector": {"timers": {"connectors": {"add_states_from_episodes_to_batch": 3.3075255678467176e-06, "add_observations_from_episodes_to_batch": 6.3733346619179236e-06, "numpy_to_tensor": 2.9660443044414704e-05, "batch_individual_items": 1.8643390108585573e-05, "add_time_dim_to_batch_and_zero_pad": 5.8736238018476574e-06}}, "connector_pipeline_timer": 0.00011440801938705962}, "num_agent_steps_sampled": {"default_agent": 1000}, "episode_len_max": 50, "weights_seq_no": 3.0, "num_episodes": 20, "agent_episode_returns_mean": {"default_agent": -0.9}, "sample": 0.7197699535012442, "episode_return_mean": -0.9, "num_agent_steps_sampled_lifetime": {"default_agent": 3000}, "env_to_module_sum_episodes_length_out": 27.168093332125434, "env_step_timer": 4.322714552610829e-05, "episode_len_mean": 50.0, "env_reset_timer": 0.0002088274800814588, "episode_duration_sec_mean": 0.03499101395000252, "module_episode_returns_mean": {"default_policy": -0.9}, "episode_return_max": 17.5, "num_env_steps_sampled": 1000, "num_env_steps_sampled_lifetime": 16000, "episode_len_min": 50, "env_to_module_sum_episodes_length_in": 27.168093332125434, "num_module_steps_sampled_lifetime": {"default_policy": 3000}, "rlmodule_inference_timer": 9.552211421955874e-05, "episode_return_min": -16.5, "time_between_sampling": 4.170724590469933}, "num_healthy_workers": 1, "actor_manager_num_outstanding_async_reqs": 0, "num_remote_worker_restarts": 0}, "num_env_steps_sampled_lifetime": -232500.0, "fault_tolerance": {"num_healthy_workers": 0, "num_remote_worker_restarts": 0}, "env_runner_group": {"actor_manager_num_outstanding_async_reqs": 0}, "done": false, "training_iteration": 3, "trial_id": "47270_00000", "date": "2025-08-11_16-31-56", "timestamp": 1754922716, "time_this_iter_s": 5.033497095108032, "time_total_s": 14.87826156616211, "pid": 30391, "hostname": "DESKTOP-3SK5A41", "node_ip": "192.168.40.242", "config": {"exploration_config": {}, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 6, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "env": "Umbrella", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": false, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 0, "create_local_env_runner": true, "num_envs_per_env_runner": 1, "gym_env_vectorize_mode": "SYNC", "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "episodes_to_numpy": true, "max_requests_in_flight_per_env_runner": 1, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "merge_env_runner_states": "training_only", "broadcast_env_runner_states": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "complete_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "sampler_perf_stats_ema_coef": null, "_is_online": true, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": "auto", "num_aggregator_actors_per_learner": 0, "max_requests_in_flight_per_aggregator_actor": 3, "local_gpu_idx": 0, "max_requests_in_flight_per_learner": 3, "gamma": 1, "lr": 0.0172526494441, "grad_clip": 0.5, "grad_clip_by": "global_norm", "_train_batch_size_per_learner": 5000, "train_batch_size": 4000, "num_epochs": 1, "minibatch_size": 1000, "shuffle_batch_per_epoch": true, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "log_std_clip_param": 20.0, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "_disable_preprocessor_api": false, "_disable_action_flattening": false}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "_learner_class": null, "callbacks_on_algorithm_init": null, "callbacks_on_env_runners_recreated": null, "callbacks_on_offline_eval_runners_recreated": null, "callbacks_on_checkpoint_loaded": null, "callbacks_on_environment_created": null, "callbacks_on_episode_created": null, "callbacks_on_episode_start": null, "callbacks_on_episode_step": null, "callbacks_on_episode_end": null, "callbacks_on_evaluate_start": null, "callbacks_on_evaluate_end": null, "callbacks_on_evaluate_offline_start": null, "callbacks_on_evaluate_offline_end": null, "callbacks_on_sample_end": null, "callbacks_on_train_result": null, "explore": true, "enable_rl_module_and_learner": true, "enable_env_runner_and_connector_v2": true, "_prior_exploration_config": {"type": "StochasticSampling"}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7e025dcd2ac0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "offline_data_class": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_read_batch_size": null, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "materialize_data": false, "materialize_mapped_data": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "ignore_final_observation": false, "prelearner_class": null, "prelearner_buffer_class": null, "prelearner_buffer_kwargs": {}, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_remaining_data": false, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": 1, "evaluation_duration": 20, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_auto_duration_min_env_steps_per_sample": 100, "evaluation_auto_duration_max_env_steps_per_sample": 2000, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 1, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "offline_evaluation_interval": null, "num_offline_eval_runners": 0, "offline_loss_for_module_fn": null, "offline_evaluation_duration": 1, "offline_evaluation_parallel_to_training": false, "offline_evaluation_timeout_s": 120.0, "num_cpus_per_offline_eval_runner": 1, "num_gpus_per_offline_eval_runner": 0, "custom_resources_per_offline_eval_runner": {}, "restart_failed_offline_eval_runners": true, "ignore_offline_eval_runner_failures": false, "max_num_offline_eval_runner_restarts": 1000, "offline_eval_runner_restore_timeout_s": 1800.0, "max_requests_in_flight_per_offline_eval_runner": 1, "validate_offline_eval_runners_after_construction": true, "offline_eval_runner_health_probe_timeout_s": 30.0, "offline_eval_rl_module_inference_only": false, "broadcast_offline_eval_runner_states": false, "offline_eval_batch_size_per_runner": 256, "dataset_num_iters_per_eval_runner": 1, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "log_gradients": true, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 42, "restart_failed_env_runners": true, "ignore_env_runner_failures": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30.0, "env_runner_restore_timeout_s": 1800.0, "_model_config": {}, "_rl_module_spec": "RLModuleSpec(module_class=None, observation_space=None, action_space=None, inference_only=False, learner_only=False, model_config=DefaultModelConfig(fcnet_hiddens=[40, 70], fcnet_activation='tanh', fcnet_kernel_initializer=None, fcnet_kernel_initializer_kwargs=None, fcnet_bias_initializer=None, fcnet_bias_initializer_kwargs=None, conv_filters=None, conv_activation='relu', conv_kernel_initializer=None, conv_kernel_initializer_kwargs=None, conv_bias_initializer=None, conv_bias_initializer_kwargs=None, head_fcnet_hiddens=[], head_fcnet_activation='relu', head_fcnet_kernel_initializer=None, head_fcnet_kernel_initializer_kwargs=None, head_fcnet_bias_initializer=None, head_fcnet_bias_initializer_kwargs=None, free_log_std=False, log_std_clip_param=20.0, vf_share_layers=True, use_lstm=False, max_seq_len=20, lstm_cell_size=256, lstm_use_prev_action=False, lstm_use_prev_reward=False, lstm_kernel_initializer=None, lstm_kernel_initializer_kwargs=None, lstm_bias_initializer=None, lstm_bias_initializer_kwargs=None), catalog_class=None, load_state_path=None, model_config_dict=None)", "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "_validate_config": true, "_use_msgpack_checkpoints": false, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "env_task_fn": -1, "enable_connectors": -1, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.44898865101, "kl_target": 0.0266033419126, "vf_loss_coeff": 0.9199777793643, "entropy_coeff": 0.0337584304442, "clip_param": 0.2910474513012, "vf_clip_param": 0.4300448978078, "entropy_coeff_schedule": null, "lr_schedule": null, "sgd_minibatch_size": -1, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9481376372503, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.callbacks.callbacks.RLlibCallback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 14.87826156616211, "iterations_since_restore": 3, "perf": {"cpu_util_percent": 12.228571428571428, "ram_util_percent": 89.67142857142858}}
{"timers": {"training_iteration": 4.260948016593794, "restore_env_runners": 5.092619317424441e-05, "training_step": 4.260659492510549, "env_runner_sampling_timer": 3.8438803689139687, "learner_update_timer": 0.41336002681834394, "synch_weights": 0.0014478858522509656, "restore_eval_env_runners": 1.2611039990565587e-05, "evaluation_iteration": 0.7313703737511654, "synch_eval_env_connectors": 0.00041077491003507023, "synch_env_connectors": 7.500020040174603e-06}, "env_runners": {"num_episodes_lifetime": -9500.0, "weights_seq_no": 3.0, "env_to_module_sum_episodes_length_in": 27.16809333212661, "env_to_module_connector": {"timers": {"connectors": {"add_observations_from_episodes_to_batch": 6.482895965585979e-06, "numpy_to_tensor": 3.163412497196768e-05, "add_states_from_episodes_to_batch": 3.5515236657056682e-06, "add_time_dim_to_batch_and_zero_pad": 6.3838102332349245e-06, "batch_individual_items": 1.8843957239275332e-05}}, "connector_pipeline_timer": 0.00012025384572351673}, "env_step_timer": 4.356024851436481e-05, "rlmodule_inference_timer": 9.932742356932053e-05, "episode_len_mean": 50.0, "agent_episode_returns_mean": {"default_agent": 7.1}, "num_episodes": 100.0, "module_to_env_connector": {"timers": {"connectors": {"un_batch_to_individual_items": 1.52014066715255e-05, "tensor_to_numpy": 5.020447399678018e-05, "listify_data_for_vector_env": 3.158701021545021e-05, "get_actions": 0.00016794210305960927, "remove_single_ts_time_rank_from_batch": 1.4224802946586156e-06, "normalize_and_clip_actions": 2.2825799988811888e-05}}, "connector_pipeline_timer": 0.00036675761891261793}, "env_reset_timer": 0.00010189862009593871, "episode_duration_sec_mean": 0.03689704960999961, "episode_return_min": -5.5, "module_episode_returns_mean": {"default_policy": 7.1}, "episode_return_max": 14.5, "num_env_steps_sampled": 5000.0, "num_env_steps_sampled_lifetime": -475000.0, "sample": 0.038553148094422125, "time_between_sampling": 0.011056542565279914, "episode_return_mean": 7.1, "num_agent_steps_sampled": {"default_agent": 5000.0}, "num_agent_steps_sampled_lifetime": {"default_agent": -475000.0}, "num_module_steps_sampled": {"default_policy": 5000.0}, "episode_len_min": 50, "episode_len_max": 50, "num_module_steps_sampled_lifetime": {"default_policy": -475000.0}, "env_to_module_sum_episodes_length_out": 27.16809333212661, "num_env_steps_sampled_lifetime_throughput": 1265.200476314147}, "learners": {"default_policy": {"vf_explained_var": -0.03411388397216797, "mean_kl_loss": 0.005946613848209381, "default_optimizer_learning_rate": 0.0172526494441, "curr_entropy_coeff": 0.0337584304442, "diff_num_grad_updates_vs_sampler_policy": 1.0, "vf_loss": 0.3391615152359009, "module_train_batch_size_mean": 1000.0, "total_loss": 0.18589459359645844, "num_module_steps_trained": 6000, "policy_loss": -0.10466372966766357, "weights_seq_no": 4.0, "num_trainable_parameters": 3243, "curr_kl_coeff": 0.11224716156721115, "gradients_default_optimizer_global_norm": 0.190397709608078, "entropy": 0.6753183007240295, "num_module_steps_trained_lifetime": 24000, "vf_loss_unclipped": 16.3392333984375, "num_module_steps_trained_lifetime_throughput": 192464.98721115358}, "__all_modules__": {"learner_connector": {"timers": {"connectors": {"add_one_ts_to_episodes_and_truncate": 0.008400432861805845, "add_time_dim_to_batch_and_zero_pad": 2.5749497901302223e-05, "add_columns_from_episodes_to_train_batch": 0.0703010586823404, "add_observations_from_episodes_to_batch": 0.0007725389936087494, "add_states_from_episodes_to_batch": 6.200069720646525e-06, "batch_individual_items": 0.19945744534860002, "numpy_to_tensor": 0.00017021260657960194, "general_advantage_estimation": 0.011412986117329809}}, "connector_pipeline_timer": 0.29091256942793686}, "num_module_steps_trained": 6000, "num_trainable_parameters": 3243, "num_module_steps_trained_lifetime": 24000, "learner_connector_sum_episodes_length_in": 5000.0, "learner_connector_sum_episodes_length_out": 5100.0, "num_non_trainable_parameters": 0, "num_env_steps_trained": 30600, "num_env_steps_trained_lifetime": 122400, "num_env_steps_trained_lifetime_throughput": 978926.8481306732, "num_module_steps_trained_throughput": 191963.186460761, "num_module_steps_trained_lifetime_throughput": 192398.9467515314}}, "num_training_step_calls_per_iteration": 1, "evaluation": {"env_runners": {"module_to_env_connector": {"connector_pipeline_timer": 0.00034221400674519075, "timers": {"connectors": {"tensor_to_numpy": 4.588773465896919e-05, "remove_single_ts_time_rank_from_batch": 1.4216657103895723e-06, "un_batch_to_individual_items": 1.5967787095626165e-05, "listify_data_for_vector_env": 3.1233083835624014e-05, "get_actions": 0.0001538191185134893, "normalize_and_clip_actions": 2.1925848373688782e-05}}}, "num_module_steps_sampled": {"default_policy": 1000}, "num_episodes_lifetime": 80, "env_to_module_connector": {"timers": {"connectors": {"add_states_from_episodes_to_batch": 3.1578879279187544e-06, "add_observations_from_episodes_to_batch": 6.048925676113022e-06, "numpy_to_tensor": 2.8678415579451937e-05, "batch_individual_items": 1.856776154402699e-05, "add_time_dim_to_batch_and_zero_pad": 5.720021094916119e-06}}, "connector_pipeline_timer": 0.00011137481865484986}, "num_agent_steps_sampled": {"default_agent": 1000}, "episode_len_max": 50, "weights_seq_no": 4.0, "num_episodes": 20, "agent_episode_returns_mean": {"default_agent": -1.15}, "sample": 0.7198136599562324, "episode_return_mean": -1.15, "num_agent_steps_sampled_lifetime": {"default_agent": 4000}, "env_to_module_sum_episodes_length_out": 27.168093332126602, "env_step_timer": 4.242938345959433e-05, "episode_len_mean": 50.0, "env_reset_timer": 0.00020815120527980773, "episode_duration_sec_mean": 0.03493192798750613, "module_episode_returns_mean": {"default_policy": -1.15}, "episode_return_max": 17.5, "num_env_steps_sampled": 1000, "num_env_steps_sampled_lifetime": 21000, "episode_len_min": 50, "env_to_module_sum_episodes_length_in": 27.168093332126602, "num_module_steps_sampled_lifetime": {"default_policy": 4000}, "rlmodule_inference_timer": 9.357431898167612e-05, "episode_return_min": -16.5, "time_between_sampling": 4.172355602455235}, "num_healthy_workers": 1, "actor_manager_num_outstanding_async_reqs": 0, "num_remote_worker_restarts": 0}, "num_env_steps_sampled_lifetime": -475000.0, "fault_tolerance": {"num_healthy_workers": 0, "num_remote_worker_restarts": 0}, "env_runner_group": {"actor_manager_num_outstanding_async_reqs": 0}, "done": false, "training_iteration": 4, "trial_id": "47270_00000", "date": "2025-08-11_16-32-01", "timestamp": 1754922721, "time_this_iter_s": 5.017446041107178, "time_total_s": 19.895707607269287, "pid": 30391, "hostname": "DESKTOP-3SK5A41", "node_ip": "192.168.40.242", "config": {"exploration_config": {}, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 6, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "env": "Umbrella", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": false, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 0, "create_local_env_runner": true, "num_envs_per_env_runner": 1, "gym_env_vectorize_mode": "SYNC", "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "episodes_to_numpy": true, "max_requests_in_flight_per_env_runner": 1, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "merge_env_runner_states": "training_only", "broadcast_env_runner_states": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "complete_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "sampler_perf_stats_ema_coef": null, "_is_online": true, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": "auto", "num_aggregator_actors_per_learner": 0, "max_requests_in_flight_per_aggregator_actor": 3, "local_gpu_idx": 0, "max_requests_in_flight_per_learner": 3, "gamma": 1, "lr": 0.0172526494441, "grad_clip": 0.5, "grad_clip_by": "global_norm", "_train_batch_size_per_learner": 5000, "train_batch_size": 4000, "num_epochs": 1, "minibatch_size": 1000, "shuffle_batch_per_epoch": true, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "log_std_clip_param": 20.0, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "_disable_preprocessor_api": false, "_disable_action_flattening": false}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "_learner_class": null, "callbacks_on_algorithm_init": null, "callbacks_on_env_runners_recreated": null, "callbacks_on_offline_eval_runners_recreated": null, "callbacks_on_checkpoint_loaded": null, "callbacks_on_environment_created": null, "callbacks_on_episode_created": null, "callbacks_on_episode_start": null, "callbacks_on_episode_step": null, "callbacks_on_episode_end": null, "callbacks_on_evaluate_start": null, "callbacks_on_evaluate_end": null, "callbacks_on_evaluate_offline_start": null, "callbacks_on_evaluate_offline_end": null, "callbacks_on_sample_end": null, "callbacks_on_train_result": null, "explore": true, "enable_rl_module_and_learner": true, "enable_env_runner_and_connector_v2": true, "_prior_exploration_config": {"type": "StochasticSampling"}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7e025dcd2ac0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "offline_data_class": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_read_batch_size": null, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "materialize_data": false, "materialize_mapped_data": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "ignore_final_observation": false, "prelearner_class": null, "prelearner_buffer_class": null, "prelearner_buffer_kwargs": {}, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_remaining_data": false, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": 1, "evaluation_duration": 20, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_auto_duration_min_env_steps_per_sample": 100, "evaluation_auto_duration_max_env_steps_per_sample": 2000, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 1, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "offline_evaluation_interval": null, "num_offline_eval_runners": 0, "offline_loss_for_module_fn": null, "offline_evaluation_duration": 1, "offline_evaluation_parallel_to_training": false, "offline_evaluation_timeout_s": 120.0, "num_cpus_per_offline_eval_runner": 1, "num_gpus_per_offline_eval_runner": 0, "custom_resources_per_offline_eval_runner": {}, "restart_failed_offline_eval_runners": true, "ignore_offline_eval_runner_failures": false, "max_num_offline_eval_runner_restarts": 1000, "offline_eval_runner_restore_timeout_s": 1800.0, "max_requests_in_flight_per_offline_eval_runner": 1, "validate_offline_eval_runners_after_construction": true, "offline_eval_runner_health_probe_timeout_s": 30.0, "offline_eval_rl_module_inference_only": false, "broadcast_offline_eval_runner_states": false, "offline_eval_batch_size_per_runner": 256, "dataset_num_iters_per_eval_runner": 1, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "log_gradients": true, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 42, "restart_failed_env_runners": true, "ignore_env_runner_failures": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30.0, "env_runner_restore_timeout_s": 1800.0, "_model_config": {}, "_rl_module_spec": "RLModuleSpec(module_class=None, observation_space=None, action_space=None, inference_only=False, learner_only=False, model_config=DefaultModelConfig(fcnet_hiddens=[40, 70], fcnet_activation='tanh', fcnet_kernel_initializer=None, fcnet_kernel_initializer_kwargs=None, fcnet_bias_initializer=None, fcnet_bias_initializer_kwargs=None, conv_filters=None, conv_activation='relu', conv_kernel_initializer=None, conv_kernel_initializer_kwargs=None, conv_bias_initializer=None, conv_bias_initializer_kwargs=None, head_fcnet_hiddens=[], head_fcnet_activation='relu', head_fcnet_kernel_initializer=None, head_fcnet_kernel_initializer_kwargs=None, head_fcnet_bias_initializer=None, head_fcnet_bias_initializer_kwargs=None, free_log_std=False, log_std_clip_param=20.0, vf_share_layers=True, use_lstm=False, max_seq_len=20, lstm_cell_size=256, lstm_use_prev_action=False, lstm_use_prev_reward=False, lstm_kernel_initializer=None, lstm_kernel_initializer_kwargs=None, lstm_bias_initializer=None, lstm_bias_initializer_kwargs=None), catalog_class=None, load_state_path=None, model_config_dict=None)", "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "_validate_config": true, "_use_msgpack_checkpoints": false, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "env_task_fn": -1, "enable_connectors": -1, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.44898865101, "kl_target": 0.0266033419126, "vf_loss_coeff": 0.9199777793643, "entropy_coeff": 0.0337584304442, "clip_param": 0.2910474513012, "vf_clip_param": 0.4300448978078, "entropy_coeff_schedule": null, "lr_schedule": null, "sgd_minibatch_size": -1, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9481376372503, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.callbacks.callbacks.RLlibCallback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 19.895707607269287, "iterations_since_restore": 4, "perf": {"cpu_util_percent": 12.12857142857143, "ram_util_percent": 89.70000000000002}}
{"timers": {"training_iteration": 4.259892696777856, "restore_env_runners": 5.0655931243376475e-05, "training_step": 4.259603352935444, "env_runner_sampling_timer": 3.8451434245448293, "learner_update_timer": 0.41103968358016135, "synch_weights": 0.0014470669937303477, "restore_eval_env_runners": 1.2644929590255969e-05, "evaluation_iteration": 0.7314011029836548, "synch_eval_env_connectors": 0.0004113621609348029, "synch_env_connectors": 7.495019838459256e-06}, "env_runners": {"num_episodes_lifetime": -14350.0, "weights_seq_no": 4.0, "env_to_module_sum_episodes_length_in": 27.16809333212661, "env_to_module_connector": {"timers": {"connectors": {"add_observations_from_episodes_to_batch": 6.509396183815589e-06, "numpy_to_tensor": 3.168718596161904e-05, "add_states_from_episodes_to_batch": 3.546536507555353e-06, "add_time_dim_to_batch_and_zero_pad": 6.430850179950033e-06, "batch_individual_items": 1.8945466801729052e-05}}, "connector_pipeline_timer": 0.00012055368819696412}, "env_step_timer": 4.379630644191053e-05, "rlmodule_inference_timer": 9.903243817961366e-05, "episode_len_mean": 50.0, "agent_episode_returns_mean": {"default_agent": 7.1}, "num_episodes": 100.0, "module_to_env_connector": {"timers": {"connectors": {"un_batch_to_individual_items": 1.5267751436103697e-05, "tensor_to_numpy": 5.0487939411875925e-05, "listify_data_for_vector_env": 3.185640149190373e-05, "get_actions": 0.0001681107400849754, "remove_single_ts_time_rank_from_batch": 1.4688212792654085e-06, "normalize_and_clip_actions": 2.297775295426123e-05}}, "connector_pipeline_timer": 0.0003677862841568145}, "env_reset_timer": 9.984874099376553e-05, "episode_duration_sec_mean": 0.037032248440007146, "episode_return_min": -5.5, "module_episode_returns_mean": {"default_policy": 7.1}, "episode_return_max": 14.5, "num_env_steps_sampled": 5000.0, "num_env_steps_sampled_lifetime": -717500.0, "sample": 0.03823328631324739, "time_between_sampling": 0.012034308721530948, "episode_return_mean": 7.1, "num_agent_steps_sampled": {"default_agent": 5000.0}, "num_agent_steps_sampled_lifetime": {"default_agent": -717500.0}, "num_module_steps_sampled": {"default_policy": 5000.0}, "episode_len_min": 50, "episode_len_max": 50, "num_module_steps_sampled_lifetime": {"default_policy": -717500.0}, "env_to_module_sum_episodes_length_out": 27.16809333212661, "num_env_steps_sampled_lifetime_throughput": 1262.5078274731268}, "learners": {"default_policy": {"vf_explained_var": 0.42194151878356934, "mean_kl_loss": 0.01044636219739914, "default_optimizer_learning_rate": 0.0172526494441, "curr_entropy_coeff": 0.0337584304442, "diff_num_grad_updates_vs_sampler_policy": 1.0, "vf_loss": 0.35395193099975586, "module_train_batch_size_mean": 1000.0, "total_loss": 0.1841593235731125, "num_module_steps_trained": 6000, "policy_loss": -0.12008086591959, "weights_seq_no": 5.0, "num_trainable_parameters": 3243, "curr_kl_coeff": 0.056123580783605576, "gradients_default_optimizer_global_norm": 0.15382696688175201, "entropy": 0.6682856678962708, "num_module_steps_trained_lifetime": 30000, "vf_loss_unclipped": 11.487922668457031, "num_module_steps_trained_lifetime_throughput": 191311.5087057782}, "__all_modules__": {"learner_connector": {"timers": {"connectors": {"add_one_ts_to_episodes_and_truncate": 0.008401606533187146, "add_time_dim_to_batch_and_zero_pad": 2.5717002921152694e-05, "add_columns_from_episodes_to_train_batch": 0.07027565310551767, "add_observations_from_episodes_to_batch": 0.0007718316036738152, "add_states_from_episodes_to_batch": 6.191069024556802e-06, "batch_individual_items": 0.19804410290511346, "numpy_to_tensor": 0.0001702204805151729, "general_advantage_estimation": 0.01139991725615681}}, "connector_pipeline_timer": 0.2894611277536568}, "num_module_steps_trained": 6000, "num_trainable_parameters": 3243, "num_module_steps_trained_lifetime": 30000, "learner_connector_sum_episodes_length_in": 5000.0, "learner_connector_sum_episodes_length_out": 5100.0, "num_non_trainable_parameters": 0, "num_env_steps_trained": 30600, "num_env_steps_trained_lifetime": 153000, "num_env_steps_trained_lifetime_throughput": 973126.7942968385, "num_module_steps_trained_throughput": 190835.9437583189, "num_module_steps_trained_lifetime_throughput": 191249.3255803894}}, "num_training_step_calls_per_iteration": 1, "evaluation": {"env_runners": {"module_to_env_connector": {"connector_pipeline_timer": 0.00034431549825054443, "timers": {"connectors": {"tensor_to_numpy": 4.5388107786485886e-05, "remove_single_ts_time_rank_from_batch": 1.4815913652792628e-06, "un_batch_to_individual_items": 1.6636224558193988e-05, "listify_data_for_vector_env": 3.080930010239251e-05, "get_actions": 0.00015387806828148196, "normalize_and_clip_actions": 2.2291118732179616e-05}}}, "num_module_steps_sampled": {"default_policy": 1000}, "num_episodes_lifetime": 100, "env_to_module_connector": {"timers": {"connectors": {"add_states_from_episodes_to_batch": 3.403044801449399e-06, "add_observations_from_episodes_to_batch": 6.328208654901883e-06, "numpy_to_tensor": 2.9164680381910016e-05, "batch_individual_items": 1.8946062587324766e-05, "add_time_dim_to_batch_and_zero_pad": 5.703999335712697e-06}}, "connector_pipeline_timer": 0.00011334910611621296}, "num_agent_steps_sampled": {"default_agent": 1000}, "episode_len_max": 50, "weights_seq_no": 5.0, "num_episodes": 20, "agent_episode_returns_mean": {"default_agent": -1.1}, "sample": 0.7198703744966709, "episode_return_mean": -1.1, "num_agent_steps_sampled_lifetime": {"default_agent": 5000}, "env_to_module_sum_episodes_length_out": 27.168093332126602, "env_step_timer": 4.18424546175433e-05, "episode_len_mean": 50.0, "env_reset_timer": 0.0002073806932279061, "episode_duration_sec_mean": 0.034912656530011646, "module_episode_returns_mean": {"default_policy": -1.1}, "episode_return_max": 17.5, "num_env_steps_sampled": 1000, "num_env_steps_sampled_lifetime": 26000, "episode_len_min": 50, "env_to_module_sum_episodes_length_in": 27.168093332126602, "num_module_steps_sampled_lifetime": {"default_policy": 5000}, "rlmodule_inference_timer": 9.497603084720956e-05, "episode_return_min": -16.5, "time_between_sampling": 4.172738117710682}, "num_healthy_workers": 1, "actor_manager_num_outstanding_async_reqs": 0, "num_remote_worker_restarts": 0}, "num_env_steps_sampled_lifetime": -717500.0, "fault_tolerance": {"num_healthy_workers": 0, "num_remote_worker_restarts": 0}, "env_runner_group": {"actor_manager_num_outstanding_async_reqs": 0}, "done": false, "training_iteration": 5, "trial_id": "47270_00000", "date": "2025-08-11_16-32-06", "timestamp": 1754922726, "time_this_iter_s": 4.896594762802124, "time_total_s": 24.79230237007141, "pid": 30391, "hostname": "DESKTOP-3SK5A41", "node_ip": "192.168.40.242", "config": {"exploration_config": {}, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 6, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "env": "Umbrella", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": false, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 0, "create_local_env_runner": true, "num_envs_per_env_runner": 1, "gym_env_vectorize_mode": "SYNC", "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "episodes_to_numpy": true, "max_requests_in_flight_per_env_runner": 1, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "merge_env_runner_states": "training_only", "broadcast_env_runner_states": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "complete_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "sampler_perf_stats_ema_coef": null, "_is_online": true, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": "auto", "num_aggregator_actors_per_learner": 0, "max_requests_in_flight_per_aggregator_actor": 3, "local_gpu_idx": 0, "max_requests_in_flight_per_learner": 3, "gamma": 1, "lr": 0.0172526494441, "grad_clip": 0.5, "grad_clip_by": "global_norm", "_train_batch_size_per_learner": 5000, "train_batch_size": 4000, "num_epochs": 1, "minibatch_size": 1000, "shuffle_batch_per_epoch": true, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "log_std_clip_param": 20.0, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "_disable_preprocessor_api": false, "_disable_action_flattening": false}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "_learner_class": null, "callbacks_on_algorithm_init": null, "callbacks_on_env_runners_recreated": null, "callbacks_on_offline_eval_runners_recreated": null, "callbacks_on_checkpoint_loaded": null, "callbacks_on_environment_created": null, "callbacks_on_episode_created": null, "callbacks_on_episode_start": null, "callbacks_on_episode_step": null, "callbacks_on_episode_end": null, "callbacks_on_evaluate_start": null, "callbacks_on_evaluate_end": null, "callbacks_on_evaluate_offline_start": null, "callbacks_on_evaluate_offline_end": null, "callbacks_on_sample_end": null, "callbacks_on_train_result": null, "explore": true, "enable_rl_module_and_learner": true, "enable_env_runner_and_connector_v2": true, "_prior_exploration_config": {"type": "StochasticSampling"}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7e025dcd2ac0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "offline_data_class": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_read_batch_size": null, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "materialize_data": false, "materialize_mapped_data": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "ignore_final_observation": false, "prelearner_class": null, "prelearner_buffer_class": null, "prelearner_buffer_kwargs": {}, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_remaining_data": false, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": 1, "evaluation_duration": 20, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_auto_duration_min_env_steps_per_sample": 100, "evaluation_auto_duration_max_env_steps_per_sample": 2000, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 1, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "offline_evaluation_interval": null, "num_offline_eval_runners": 0, "offline_loss_for_module_fn": null, "offline_evaluation_duration": 1, "offline_evaluation_parallel_to_training": false, "offline_evaluation_timeout_s": 120.0, "num_cpus_per_offline_eval_runner": 1, "num_gpus_per_offline_eval_runner": 0, "custom_resources_per_offline_eval_runner": {}, "restart_failed_offline_eval_runners": true, "ignore_offline_eval_runner_failures": false, "max_num_offline_eval_runner_restarts": 1000, "offline_eval_runner_restore_timeout_s": 1800.0, "max_requests_in_flight_per_offline_eval_runner": 1, "validate_offline_eval_runners_after_construction": true, "offline_eval_runner_health_probe_timeout_s": 30.0, "offline_eval_rl_module_inference_only": false, "broadcast_offline_eval_runner_states": false, "offline_eval_batch_size_per_runner": 256, "dataset_num_iters_per_eval_runner": 1, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "log_gradients": true, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 42, "restart_failed_env_runners": true, "ignore_env_runner_failures": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30.0, "env_runner_restore_timeout_s": 1800.0, "_model_config": {}, "_rl_module_spec": "RLModuleSpec(module_class=None, observation_space=None, action_space=None, inference_only=False, learner_only=False, model_config=DefaultModelConfig(fcnet_hiddens=[40, 70], fcnet_activation='tanh', fcnet_kernel_initializer=None, fcnet_kernel_initializer_kwargs=None, fcnet_bias_initializer=None, fcnet_bias_initializer_kwargs=None, conv_filters=None, conv_activation='relu', conv_kernel_initializer=None, conv_kernel_initializer_kwargs=None, conv_bias_initializer=None, conv_bias_initializer_kwargs=None, head_fcnet_hiddens=[], head_fcnet_activation='relu', head_fcnet_kernel_initializer=None, head_fcnet_kernel_initializer_kwargs=None, head_fcnet_bias_initializer=None, head_fcnet_bias_initializer_kwargs=None, free_log_std=False, log_std_clip_param=20.0, vf_share_layers=True, use_lstm=False, max_seq_len=20, lstm_cell_size=256, lstm_use_prev_action=False, lstm_use_prev_reward=False, lstm_kernel_initializer=None, lstm_kernel_initializer_kwargs=None, lstm_bias_initializer=None, lstm_bias_initializer_kwargs=None), catalog_class=None, load_state_path=None, model_config_dict=None)", "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "_validate_config": true, "_use_msgpack_checkpoints": false, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "env_task_fn": -1, "enable_connectors": -1, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.44898865101, "kl_target": 0.0266033419126, "vf_loss_coeff": 0.9199777793643, "entropy_coeff": 0.0337584304442, "clip_param": 0.2910474513012, "vf_clip_param": 0.4300448978078, "entropy_coeff_schedule": null, "lr_schedule": null, "sgd_minibatch_size": -1, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9481376372503, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.callbacks.callbacks.RLlibCallback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 24.79230237007141, "iterations_since_restore": 5, "perf": {"cpu_util_percent": 12.014285714285714, "ram_util_percent": 89.70000000000002}}
{"timers": {"training_iteration": 4.260154224610076, "restore_env_runners": 5.027937193175136e-05, "training_step": 4.259862803206091, "env_runner_sampling_timer": 3.8463094380393827, "learner_update_timer": 0.4101326878043598, "synch_weights": 0.0014459993237934247, "restore_eval_env_runners": 1.2630480294525384e-05, "evaluation_iteration": 0.7314478880938194, "synch_eval_env_connectors": 0.0004126625393252009, "synch_env_connectors": 7.487069640928686e-06}, "env_runners": {"num_episodes_lifetime": -19200.0, "weights_seq_no": 5.0, "env_to_module_sum_episodes_length_in": 27.16809333212661, "env_to_module_connector": {"timers": {"connectors": {"add_observations_from_episodes_to_batch": 6.461466973030592e-06, "numpy_to_tensor": 3.186175286208464e-05, "add_states_from_episodes_to_batch": 3.5476249239556497e-06, "add_time_dim_to_batch_and_zero_pad": 6.362058709422275e-06, "batch_individual_items": 1.886235946487898e-05}}, "connector_pipeline_timer": 0.00012034689519766452}, "env_step_timer": 4.376708526774058e-05, "rlmodule_inference_timer": 9.883346403550687e-05, "episode_len_mean": 50.0, "agent_episode_returns_mean": {"default_agent": 8.9}, "num_episodes": 100.0, "module_to_env_connector": {"timers": {"connectors": {"un_batch_to_individual_items": 1.5229462245676363e-05, "tensor_to_numpy": 5.056224543699321e-05, "listify_data_for_vector_env": 3.174406088029367e-05, "get_actions": 0.00016817634935589238, "remove_single_ts_time_rank_from_batch": 1.4440014772998497e-06, "normalize_and_clip_actions": 2.282821599521137e-05}}, "connector_pipeline_timer": 0.0003674261654213704}, "env_reset_timer": 0.00010046000206269898, "episode_duration_sec_mean": 0.03698329067000032, "episode_return_min": -5.5, "module_episode_returns_mean": {"default_policy": 8.9}, "episode_return_max": 14.5, "num_env_steps_sampled": 5000.0, "num_env_steps_sampled_lifetime": -960000.0, "sample": 0.038198807416624965, "time_between_sampling": 0.011513151368279618, "episode_return_mean": 8.9, "num_agent_steps_sampled": {"default_agent": 5000.0}, "num_agent_steps_sampled_lifetime": {"default_agent": -960000.0}, "num_module_steps_sampled": {"default_policy": 5000.0}, "episode_len_min": 50, "episode_len_max": 50, "num_module_steps_sampled_lifetime": {"default_policy": -960000.0}, "env_to_module_sum_episodes_length_out": 27.16809333212661, "num_env_steps_sampled_lifetime_throughput": 1262.6672813631164}, "learners": {"default_policy": {"vf_explained_var": 0.5762156248092651, "mean_kl_loss": 0.006593775935471058, "default_optimizer_learning_rate": 0.0172526494441, "curr_entropy_coeff": 0.0337584304442, "diff_num_grad_updates_vs_sampler_policy": 1.0, "vf_loss": 0.3118254840373993, "module_train_batch_size_mean": 1000.0, "total_loss": 0.10450107604265213, "num_module_steps_trained": 6000, "policy_loss": -0.16097284853458405, "weights_seq_no": 6.0, "num_trainable_parameters": 3243, "curr_kl_coeff": 0.028061790391802788, "gradients_default_optimizer_global_norm": 0.3839026391506195, "entropy": 0.6448346376419067, "num_module_steps_trained_lifetime": 36000, "vf_loss_unclipped": 8.656558990478516, "num_module_steps_trained_lifetime_throughput": 190329.58464674582}, "__all_modules__": {"learner_connector": {"timers": {"connectors": {"add_one_ts_to_episodes_and_truncate": 0.008399233467853897, "add_time_dim_to_batch_and_zero_pad": 2.5683832892285117e-05, "add_columns_from_episodes_to_train_batch": 0.0702474845844618, "add_observations_from_episodes_to_batch": 0.0007728182876372679, "add_states_from_episodes_to_batch": 6.184158334740806e-06, "batch_individual_items": 0.19808531791606132, "numpy_to_tensor": 0.0001705272757098375, "general_advantage_estimation": 0.011370279083594505}}, "connector_pipeline_timer": 0.2894428945261205}, "num_module_steps_trained": 6000, "num_trainable_parameters": 3243, "num_module_steps_trained_lifetime": 36000, "learner_connector_sum_episodes_length_in": 5000.0, "learner_connector_sum_episodes_length_out": 5100.0, "num_non_trainable_parameters": 0, "num_env_steps_trained": 30600, "num_env_steps_trained_lifetime": 183600, "num_env_steps_trained_lifetime_throughput": 968204.6435980566, "num_module_steps_trained_throughput": 189883.7325933048, "num_module_steps_trained_lifetime_throughput": 190271.9226337845}}, "num_training_step_calls_per_iteration": 1, "evaluation": {"env_runners": {"module_to_env_connector": {"connector_pipeline_timer": 0.00034227092513914594, "timers": {"connectors": {"tensor_to_numpy": 4.6041313337071996e-05, "remove_single_ts_time_rank_from_batch": 1.3881320732650918e-06, "un_batch_to_individual_items": 1.5680422028654542e-05, "listify_data_for_vector_env": 3.1781835403024074e-05, "get_actions": 0.00015260124036913352, "normalize_and_clip_actions": 2.2458222595715874e-05}}}, "num_module_steps_sampled": {"default_policy": 1000}, "num_episodes_lifetime": 120, "env_to_module_connector": {"timers": {"connectors": {"add_states_from_episodes_to_batch": 3.192661718579013e-06, "add_observations_from_episodes_to_batch": 6.0611623845324445e-06, "numpy_to_tensor": 2.8808235824082676e-05, "batch_individual_items": 1.8357415995883036e-05, "add_time_dim_to_batch_and_zero_pad": 5.5302792930741615e-06}}, "connector_pipeline_timer": 0.0001112877024144528}, "num_agent_steps_sampled": {"default_agent": 1000}, "episode_len_max": 50, "weights_seq_no": 6.0, "num_episodes": 20, "agent_episode_returns_mean": {"default_agent": -0.1}, "sample": 0.7198847938817042, "episode_return_mean": -0.1, "num_agent_steps_sampled_lifetime": {"default_agent": 6000}, "env_to_module_sum_episodes_length_out": 27.168093332126602, "env_step_timer": 4.144521330438014e-05, "episode_len_mean": 50.0, "env_reset_timer": 0.00020655188629646276, "episode_duration_sec_mean": 0.034931890450009176, "module_episode_returns_mean": {"default_policy": -0.1}, "episode_return_max": 17.5, "num_env_steps_sampled": 1000, "num_env_steps_sampled_lifetime": 31000, "episode_len_min": 50, "env_to_module_sum_episodes_length_in": 27.168093332126602, "num_module_steps_sampled_lifetime": {"default_policy": 6000}, "rlmodule_inference_timer": 9.177651497145393e-05, "episode_return_min": -16.5, "time_between_sampling": 4.174431643343575}, "num_healthy_workers": 1, "actor_manager_num_outstanding_async_reqs": 0, "num_remote_worker_restarts": 0}, "num_env_steps_sampled_lifetime": -960000.0, "fault_tolerance": {"num_healthy_workers": 0, "num_remote_worker_restarts": 0}, "env_runner_group": {"actor_manager_num_outstanding_async_reqs": 0}, "done": false, "training_iteration": 6, "trial_id": "47270_00000", "date": "2025-08-11_16-32-11", "timestamp": 1754922731, "time_this_iter_s": 5.021969318389893, "time_total_s": 29.814271688461304, "pid": 30391, "hostname": "DESKTOP-3SK5A41", "node_ip": "192.168.40.242", "config": {"exploration_config": {}, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 6, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "env": "Umbrella", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": false, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 0, "create_local_env_runner": true, "num_envs_per_env_runner": 1, "gym_env_vectorize_mode": "SYNC", "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "episodes_to_numpy": true, "max_requests_in_flight_per_env_runner": 1, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "merge_env_runner_states": "training_only", "broadcast_env_runner_states": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "complete_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "sampler_perf_stats_ema_coef": null, "_is_online": true, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": "auto", "num_aggregator_actors_per_learner": 0, "max_requests_in_flight_per_aggregator_actor": 3, "local_gpu_idx": 0, "max_requests_in_flight_per_learner": 3, "gamma": 1, "lr": 0.0172526494441, "grad_clip": 0.5, "grad_clip_by": "global_norm", "_train_batch_size_per_learner": 5000, "train_batch_size": 4000, "num_epochs": 1, "minibatch_size": 1000, "shuffle_batch_per_epoch": true, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "log_std_clip_param": 20.0, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "_disable_preprocessor_api": false, "_disable_action_flattening": false}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "_learner_class": null, "callbacks_on_algorithm_init": null, "callbacks_on_env_runners_recreated": null, "callbacks_on_offline_eval_runners_recreated": null, "callbacks_on_checkpoint_loaded": null, "callbacks_on_environment_created": null, "callbacks_on_episode_created": null, "callbacks_on_episode_start": null, "callbacks_on_episode_step": null, "callbacks_on_episode_end": null, "callbacks_on_evaluate_start": null, "callbacks_on_evaluate_end": null, "callbacks_on_evaluate_offline_start": null, "callbacks_on_evaluate_offline_end": null, "callbacks_on_sample_end": null, "callbacks_on_train_result": null, "explore": true, "enable_rl_module_and_learner": true, "enable_env_runner_and_connector_v2": true, "_prior_exploration_config": {"type": "StochasticSampling"}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7e025dcd2ac0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "offline_data_class": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_read_batch_size": null, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "materialize_data": false, "materialize_mapped_data": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "ignore_final_observation": false, "prelearner_class": null, "prelearner_buffer_class": null, "prelearner_buffer_kwargs": {}, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_remaining_data": false, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": 1, "evaluation_duration": 20, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_auto_duration_min_env_steps_per_sample": 100, "evaluation_auto_duration_max_env_steps_per_sample": 2000, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 1, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "offline_evaluation_interval": null, "num_offline_eval_runners": 0, "offline_loss_for_module_fn": null, "offline_evaluation_duration": 1, "offline_evaluation_parallel_to_training": false, "offline_evaluation_timeout_s": 120.0, "num_cpus_per_offline_eval_runner": 1, "num_gpus_per_offline_eval_runner": 0, "custom_resources_per_offline_eval_runner": {}, "restart_failed_offline_eval_runners": true, "ignore_offline_eval_runner_failures": false, "max_num_offline_eval_runner_restarts": 1000, "offline_eval_runner_restore_timeout_s": 1800.0, "max_requests_in_flight_per_offline_eval_runner": 1, "validate_offline_eval_runners_after_construction": true, "offline_eval_runner_health_probe_timeout_s": 30.0, "offline_eval_rl_module_inference_only": false, "broadcast_offline_eval_runner_states": false, "offline_eval_batch_size_per_runner": 256, "dataset_num_iters_per_eval_runner": 1, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "log_gradients": true, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 42, "restart_failed_env_runners": true, "ignore_env_runner_failures": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30.0, "env_runner_restore_timeout_s": 1800.0, "_model_config": {}, "_rl_module_spec": "RLModuleSpec(module_class=None, observation_space=None, action_space=None, inference_only=False, learner_only=False, model_config=DefaultModelConfig(fcnet_hiddens=[40, 70], fcnet_activation='tanh', fcnet_kernel_initializer=None, fcnet_kernel_initializer_kwargs=None, fcnet_bias_initializer=None, fcnet_bias_initializer_kwargs=None, conv_filters=None, conv_activation='relu', conv_kernel_initializer=None, conv_kernel_initializer_kwargs=None, conv_bias_initializer=None, conv_bias_initializer_kwargs=None, head_fcnet_hiddens=[], head_fcnet_activation='relu', head_fcnet_kernel_initializer=None, head_fcnet_kernel_initializer_kwargs=None, head_fcnet_bias_initializer=None, head_fcnet_bias_initializer_kwargs=None, free_log_std=False, log_std_clip_param=20.0, vf_share_layers=True, use_lstm=False, max_seq_len=20, lstm_cell_size=256, lstm_use_prev_action=False, lstm_use_prev_reward=False, lstm_kernel_initializer=None, lstm_kernel_initializer_kwargs=None, lstm_bias_initializer=None, lstm_bias_initializer_kwargs=None), catalog_class=None, load_state_path=None, model_config_dict=None)", "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "_validate_config": true, "_use_msgpack_checkpoints": false, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "env_task_fn": -1, "enable_connectors": -1, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.44898865101, "kl_target": 0.0266033419126, "vf_loss_coeff": 0.9199777793643, "entropy_coeff": 0.0337584304442, "clip_param": 0.2910474513012, "vf_clip_param": 0.4300448978078, "entropy_coeff_schedule": null, "lr_schedule": null, "sgd_minibatch_size": -1, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9481376372503, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.callbacks.callbacks.RLlibCallback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 29.814271688461304, "iterations_since_restore": 6, "perf": {"cpu_util_percent": 12.799999999999999, "ram_util_percent": 89.70000000000002}}
{"timers": {"training_iteration": 4.2590957050839755, "restore_env_runners": 4.989557821133759e-05, "training_step": 4.258802901894031, "env_runner_sampling_timer": 3.84762266643899, "learner_update_timer": 0.4077574548663151, "synch_weights": 0.0014447663305572247, "restore_eval_env_runners": 1.2609175490746598e-05, "evaluation_iteration": 0.7314424113428817, "synch_eval_env_connectors": 0.0004137109139330941, "synch_env_connectors": 7.475198944474026e-06}, "env_runners": {"num_episodes_lifetime": -24050.0, "weights_seq_no": 6.0, "env_to_module_sum_episodes_length_in": 27.16809333212661, "env_to_module_connector": {"timers": {"connectors": {"add_observations_from_episodes_to_batch": 6.498647165794484e-06, "numpy_to_tensor": 3.174998407336274e-05, "add_states_from_episodes_to_batch": 3.6159607161593773e-06, "add_time_dim_to_batch_and_zero_pad": 6.363798791647584e-06, "batch_individual_items": 1.904792885548218e-05}}, "connector_pipeline_timer": 0.00012099539647626632}, "env_step_timer": 4.367614657217973e-05, "rlmodule_inference_timer": 9.955547429096759e-05, "episode_len_mean": 50.0, "agent_episode_returns_mean": {"default_agent": 11.5}, "num_episodes": 100.0, "module_to_env_connector": {"timers": {"connectors": {"un_batch_to_individual_items": 1.5349617898799186e-05, "tensor_to_numpy": 5.072947360628595e-05, "listify_data_for_vector_env": 3.1893007592381653e-05, "get_actions": 0.00016906143479487336, "remove_single_ts_time_rank_from_batch": 1.44296634097843e-06, "normalize_and_clip_actions": 2.2921939163736078e-05}}, "connector_pipeline_timer": 0.0003693419069504393}, "env_reset_timer": 9.944122542378303e-05, "episode_duration_sec_mean": 0.03714881881999417, "episode_return_min": -5.5, "module_episode_returns_mean": {"default_policy": 11.5}, "episode_return_max": 14.5, "num_env_steps_sampled": 5000.0, "num_env_steps_sampled_lifetime": -1202500.0, "sample": 0.03826907205958811, "time_between_sampling": 0.012146668920172137, "episode_return_mean": 11.5, "num_agent_steps_sampled": {"default_agent": 5000.0}, "num_agent_steps_sampled_lifetime": {"default_agent": -1202500.0}, "num_module_steps_sampled": {"default_policy": 5000.0}, "episode_len_min": 50, "episode_len_max": 50, "num_module_steps_sampled_lifetime": {"default_policy": -1202500.0}, "env_to_module_sum_episodes_length_out": 27.16809333212661, "num_env_steps_sampled_lifetime_throughput": 1261.3500631985403}, "learners": {"default_policy": {"vf_explained_var": 0.5177631378173828, "mean_kl_loss": 0.00889261532574892, "default_optimizer_learning_rate": 0.0172526494441, "curr_entropy_coeff": 0.0337584304442, "diff_num_grad_updates_vs_sampler_policy": 1.0, "vf_loss": 0.3554559350013733, "module_train_batch_size_mean": 1000.0, "total_loss": 0.44563931226730347, "num_module_steps_trained": 6000, "policy_loss": 0.13873712718486786, "weights_seq_no": 7.0, "num_trainable_parameters": 3243, "curr_kl_coeff": 0.014030895195901394, "gradients_default_optimizer_global_norm": 0.6593826413154602, "entropy": 0.6030751466751099, "num_module_steps_trained_lifetime": 42000, "vf_loss_unclipped": 15.52647590637207, "num_module_steps_trained_lifetime_throughput": 189693.04699926038}, "__all_modules__": {"learner_connector": {"timers": {"connectors": {"add_one_ts_to_episodes_and_truncate": 0.008400838133175137, "add_time_dim_to_batch_and_zero_pad": 2.5627994563650597e-05, "add_columns_from_episodes_to_train_batch": 0.07021080771861737, "add_observations_from_episodes_to_batch": 0.0007719581047612904, "add_states_from_episodes_to_batch": 6.171316749337009e-06, "batch_individual_items": 0.1966785477169, "numpy_to_tensor": 0.0001704600029515594, "general_advantage_estimation": 0.011347417282757483}}, "connector_pipeline_timer": 0.28797652553086045}, "num_module_steps_trained": 6000, "num_trainable_parameters": 3243, "num_module_steps_trained_lifetime": 42000, "learner_connector_sum_episodes_length_in": 5000.0, "learner_connector_sum_episodes_length_out": 5100.0, "num_non_trainable_parameters": 0, "num_env_steps_trained": 30600, "num_env_steps_trained_lifetime": 214200, "num_env_steps_trained_lifetime_throughput": 965071.6250428455, "num_module_steps_trained_throughput": 189280.11087162766, "num_module_steps_trained_lifetime_throughput": 189644.33238650052}}, "num_training_step_calls_per_iteration": 1, "evaluation": {"env_runners": {"module_to_env_connector": {"connector_pipeline_timer": 0.00033764266220790475, "timers": {"connectors": {"tensor_to_numpy": 4.48506101118766e-05, "remove_single_ts_time_rank_from_batch": 1.4552153982013861e-06, "un_batch_to_individual_items": 1.6309470820879716e-05, "listify_data_for_vector_env": 3.058947255195815e-05, "get_actions": 0.0001507568443535258, "normalize_and_clip_actions": 2.1998245488056354e-05}}}, "num_module_steps_sampled": {"default_policy": 1000}, "num_episodes_lifetime": 140, "env_to_module_connector": {"timers": {"connectors": {"add_states_from_episodes_to_batch": 3.1612861876025315e-06, "add_observations_from_episodes_to_batch": 5.996521954418246e-06, "numpy_to_tensor": 2.842277242419814e-05, "batch_individual_items": 1.8083881709420054e-05, "add_time_dim_to_batch_and_zero_pad": 5.59380819643404e-06}}, "connector_pipeline_timer": 0.00010948975497574309}, "num_agent_steps_sampled": {"default_agent": 1000}, "episode_len_max": 50, "weights_seq_no": 7.0, "num_episodes": 20, "agent_episode_returns_mean": {"default_agent": 0.1}, "sample": 0.7198421086828872, "episode_return_mean": 0.1, "num_agent_steps_sampled_lifetime": {"default_agent": 7000}, "env_to_module_sum_episodes_length_out": 27.168093332126602, "env_step_timer": 4.1974117000627775e-05, "episode_len_mean": 50.0, "env_reset_timer": 0.00020574936743497052, "episode_duration_sec_mean": 0.03488703012000997, "module_episode_returns_mean": {"default_policy": 0.1}, "episode_return_max": 17.5, "num_env_steps_sampled": 1000, "num_env_steps_sampled_lifetime": 36000, "episode_len_min": 50, "env_to_module_sum_episodes_length_in": 27.168093332126602, "num_module_steps_sampled_lifetime": {"default_policy": 7000}, "rlmodule_inference_timer": 9.071017107480461e-05, "episode_return_min": -16.5, "time_between_sampling": 4.17476172164014}, "num_healthy_workers": 1, "actor_manager_num_outstanding_async_reqs": 0, "num_remote_worker_restarts": 0}, "num_env_steps_sampled_lifetime": -1202500.0, "fault_tolerance": {"num_healthy_workers": 0, "num_remote_worker_restarts": 0}, "env_runner_group": {"actor_manager_num_outstanding_async_reqs": 0}, "done": true, "training_iteration": 7, "trial_id": "47270_00000", "date": "2025-08-11_16-32-16", "timestamp": 1754922736, "time_this_iter_s": 4.884901523590088, "time_total_s": 34.69917321205139, "pid": 30391, "hostname": "DESKTOP-3SK5A41", "node_ip": "192.168.40.242", "config": {"exploration_config": {}, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 6, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "env": "Umbrella", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": false, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 0, "create_local_env_runner": true, "num_envs_per_env_runner": 1, "gym_env_vectorize_mode": "SYNC", "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "episodes_to_numpy": true, "max_requests_in_flight_per_env_runner": 1, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "merge_env_runner_states": "training_only", "broadcast_env_runner_states": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "complete_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "sampler_perf_stats_ema_coef": null, "_is_online": true, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": "auto", "num_aggregator_actors_per_learner": 0, "max_requests_in_flight_per_aggregator_actor": 3, "local_gpu_idx": 0, "max_requests_in_flight_per_learner": 3, "gamma": 1, "lr": 0.0172526494441, "grad_clip": 0.5, "grad_clip_by": "global_norm", "_train_batch_size_per_learner": 5000, "train_batch_size": 4000, "num_epochs": 1, "minibatch_size": 1000, "shuffle_batch_per_epoch": true, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "log_std_clip_param": 20.0, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "_disable_preprocessor_api": false, "_disable_action_flattening": false}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "_learner_class": null, "callbacks_on_algorithm_init": null, "callbacks_on_env_runners_recreated": null, "callbacks_on_offline_eval_runners_recreated": null, "callbacks_on_checkpoint_loaded": null, "callbacks_on_environment_created": null, "callbacks_on_episode_created": null, "callbacks_on_episode_start": null, "callbacks_on_episode_step": null, "callbacks_on_episode_end": null, "callbacks_on_evaluate_start": null, "callbacks_on_evaluate_end": null, "callbacks_on_evaluate_offline_start": null, "callbacks_on_evaluate_offline_end": null, "callbacks_on_sample_end": null, "callbacks_on_train_result": null, "explore": true, "enable_rl_module_and_learner": true, "enable_env_runner_and_connector_v2": true, "_prior_exploration_config": {"type": "StochasticSampling"}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7e025dcd2ac0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "offline_data_class": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_read_batch_size": null, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "materialize_data": false, "materialize_mapped_data": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "ignore_final_observation": false, "prelearner_class": null, "prelearner_buffer_class": null, "prelearner_buffer_kwargs": {}, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_remaining_data": false, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": 1, "evaluation_duration": 20, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_auto_duration_min_env_steps_per_sample": 100, "evaluation_auto_duration_max_env_steps_per_sample": 2000, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 1, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "offline_evaluation_interval": null, "num_offline_eval_runners": 0, "offline_loss_for_module_fn": null, "offline_evaluation_duration": 1, "offline_evaluation_parallel_to_training": false, "offline_evaluation_timeout_s": 120.0, "num_cpus_per_offline_eval_runner": 1, "num_gpus_per_offline_eval_runner": 0, "custom_resources_per_offline_eval_runner": {}, "restart_failed_offline_eval_runners": true, "ignore_offline_eval_runner_failures": false, "max_num_offline_eval_runner_restarts": 1000, "offline_eval_runner_restore_timeout_s": 1800.0, "max_requests_in_flight_per_offline_eval_runner": 1, "validate_offline_eval_runners_after_construction": true, "offline_eval_runner_health_probe_timeout_s": 30.0, "offline_eval_rl_module_inference_only": false, "broadcast_offline_eval_runner_states": false, "offline_eval_batch_size_per_runner": 256, "dataset_num_iters_per_eval_runner": 1, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "log_gradients": true, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 42, "restart_failed_env_runners": true, "ignore_env_runner_failures": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30.0, "env_runner_restore_timeout_s": 1800.0, "_model_config": {}, "_rl_module_spec": "RLModuleSpec(module_class=None, observation_space=None, action_space=None, inference_only=False, learner_only=False, model_config=DefaultModelConfig(fcnet_hiddens=[40, 70], fcnet_activation='tanh', fcnet_kernel_initializer=None, fcnet_kernel_initializer_kwargs=None, fcnet_bias_initializer=None, fcnet_bias_initializer_kwargs=None, conv_filters=None, conv_activation='relu', conv_kernel_initializer=None, conv_kernel_initializer_kwargs=None, conv_bias_initializer=None, conv_bias_initializer_kwargs=None, head_fcnet_hiddens=[], head_fcnet_activation='relu', head_fcnet_kernel_initializer=None, head_fcnet_kernel_initializer_kwargs=None, head_fcnet_bias_initializer=None, head_fcnet_bias_initializer_kwargs=None, free_log_std=False, log_std_clip_param=20.0, vf_share_layers=True, use_lstm=False, max_seq_len=20, lstm_cell_size=256, lstm_use_prev_action=False, lstm_use_prev_reward=False, lstm_kernel_initializer=None, lstm_kernel_initializer_kwargs=None, lstm_bias_initializer=None, lstm_bias_initializer_kwargs=None), catalog_class=None, load_state_path=None, model_config_dict=None)", "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "_validate_config": true, "_use_msgpack_checkpoints": false, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "env_task_fn": -1, "enable_connectors": -1, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.44898865101, "kl_target": 0.0266033419126, "vf_loss_coeff": 0.9199777793643, "entropy_coeff": 0.0337584304442, "clip_param": 0.2910474513012, "vf_clip_param": 0.4300448978078, "entropy_coeff_schedule": null, "lr_schedule": null, "sgd_minibatch_size": -1, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9481376372503, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.callbacks.callbacks.RLlibCallback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 34.69917321205139, "iterations_since_restore": 7, "perf": {"cpu_util_percent": 12.200000000000001, "ram_util_percent": 89.70000000000002}}
