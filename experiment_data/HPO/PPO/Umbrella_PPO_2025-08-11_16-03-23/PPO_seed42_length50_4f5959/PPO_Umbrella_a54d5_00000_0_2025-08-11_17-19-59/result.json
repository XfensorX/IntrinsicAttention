{"timers": {"training_iteration": 4.21714130700002, "restore_env_runners": 1.4600000213249587e-05, "training_step": 4.216842107000048, "env_runner_sampling_timer": 3.8010382070006017, "learner_update_timer": 0.41231749999951717, "synch_weights": 0.0014333999997688807}, "env_runners": {"num_episodes": 100.0, "sample": 0.039395698942892146, "module_to_env_connector": {"timers": {"connectors": {"un_batch_to_individual_items": 1.452072181511584e-05, "listify_data_for_vector_env": 3.0690205100984664e-05, "get_actions": 0.00016586309173619328, "normalize_and_clip_actions": 2.835978206620368e-05, "tensor_to_numpy": 4.6202014358816086e-05, "remove_single_ts_time_rank_from_batch": 1.4430929293677583e-06}}, "connector_pipeline_timer": 0.0003639380532559477}, "agent_episode_returns_mean": {"default_agent": 4.100000000000001}, "num_module_steps_sampled_lifetime": {"default_policy": 252500.0}, "env_to_module_connector": {"timers": {"connectors": {"batch_individual_items": 1.8690955121401893e-05, "add_observations_from_episodes_to_batch": 6.584782766929604e-06, "add_states_from_episodes_to_batch": 3.481505129243671e-06, "numpy_to_tensor": 3.10282362453054e-05, "add_time_dim_to_batch_and_zero_pad": 6.596157419619769e-06}}, "connector_pipeline_timer": 0.00012169809795554954}, "num_episodes_lifetime": 5050.0, "time_between_sampling": 0.0013865237455941942, "module_episode_returns_mean": {"default_policy": 4.100000000000001}, "env_to_module_sum_episodes_length_in": 26.762340024562445, "episode_return_min": -5.5, "episode_return_max": 14.5, "num_env_steps_sampled_lifetime": 252500.0, "rlmodule_inference_timer": 0.00010247929934234583, "episode_duration_sec_mean": 0.03554354605998924, "num_agent_steps_sampled": {"default_agent": 5000.0}, "num_agent_steps_sampled_lifetime": {"default_agent": 252500.0}, "env_reset_timer": 0.0002040979694469681, "episode_return_mean": 4.100000000000001, "weights_seq_no": 0.0, "num_module_steps_sampled": {"default_policy": 5000.0}, "episode_len_min": 50, "env_step_timer": 4.449707002597874e-05, "episode_len_max": 50, "num_env_steps_sampled": 5000.0, "env_to_module_sum_episodes_length_out": 26.762340024562445, "episode_len_mean": 50.0, "num_env_steps_sampled_lifetime_throughput": 1270.9837521981567}, "learners": {"__all_modules__": {"learner_connector": {"timers": {"connectors": {"general_advantage_estimation": 0.013312899999618821, "add_columns_from_episodes_to_train_batch": 0.06906180000078166, "batch_individual_items": 0.20110609999937878, "add_observations_from_episodes_to_batch": 0.0008031999996092054, "numpy_to_tensor": 0.0001627000001462875, "add_states_from_episodes_to_batch": 6.199999916134402e-06, "add_time_dim_to_batch_and_zero_pad": 2.3699999474047218e-05, "add_one_ts_to_episodes_and_truncate": 0.00813930000003893}}, "connector_pipeline_timer": 0.29299360000004526}, "num_env_steps_trained_lifetime": 30600, "num_non_trainable_parameters": 0, "learner_connector_sum_episodes_length_in": 5000, "num_module_steps_trained": 6000, "num_trainable_parameters": 5909, "num_module_steps_trained_lifetime": 6000, "num_env_steps_trained": 30600, "learner_connector_sum_episodes_length_out": 5100, "num_env_steps_trained_lifetime_throughput": 858759.1677293916, "num_module_steps_trained_throughput": 168980.37426581775, "num_module_steps_trained_lifetime_throughput": 168871.34738447517}, "default_policy": {"total_loss": 0.013075591996312141, "diff_num_grad_updates_vs_sampler_policy": 1.0, "vf_loss": 0.24840550124645233, "mean_kl_loss": 0.003561850171536207, "curr_entropy_coeff": 0.0016790048723, "gradients_default_optimizer_global_norm": 0.3052092492580414, "num_module_steps_trained": 6000, "weights_seq_no": 1.0, "entropy": 0.6879297494888306, "num_trainable_parameters": 5909, "module_train_batch_size_mean": 1000.0, "vf_loss_unclipped": 54.78036880493164, "num_module_steps_trained_lifetime": 6000, "vf_explained_var": 0.014566659927368164, "curr_kl_coeff": 0.13089926540851593, "policy_loss": -0.1260915994644165, "default_optimizer_learning_rate": 0.0008209260984, "num_module_steps_trained_lifetime_throughput": 169338.6895949555}}, "num_training_step_calls_per_iteration": 1, "num_env_steps_sampled_lifetime": 252500.0, "evaluation": {"env_runners": {"module_episode_returns_mean": {"default_policy": -2.9}, "module_to_env_connector": {"timers": {"connectors": {"remove_single_ts_time_rank_from_batch": 1.365872482424659e-06, "listify_data_for_vector_env": 3.0091198045106394e-05, "get_actions": 0.0001522693317318991, "un_batch_to_individual_items": 1.4786200805951281e-05, "normalize_and_clip_actions": 2.105932323171642e-05, "tensor_to_numpy": 4.4500679476179326e-05}}, "connector_pipeline_timer": 0.00033851723162906205}, "agent_episode_returns_mean": {"default_agent": -2.9}, "num_env_steps_sampled": 1000, "num_module_steps_sampled": {"default_policy": 1000}, "num_episodes": 20, "env_to_module_connector": {"timers": {"connectors": {"add_observations_from_episodes_to_batch": 5.941254089838694e-06, "add_states_from_episodes_to_batch": 3.2713631615041657e-06, "numpy_to_tensor": 2.8931261006876863e-05, "add_time_dim_to_batch_and_zero_pad": 6.15054366564863e-06, "batch_individual_items": 1.8051961251461933e-05}}, "connector_pipeline_timer": 0.00011549555984176227}, "num_module_steps_sampled_lifetime": {"default_policy": 1000}, "num_agent_steps_sampled_lifetime": {"default_agent": 1000}, "num_agent_steps_sampled": {"default_agent": 1000}, "rlmodule_inference_timer": 9.404970373677302e-05, "num_env_steps_sampled_lifetime": 6000, "env_reset_timer": 0.0002122999994753627, "episode_return_mean": -2.9, "weights_seq_no": 1.0, "env_step_timer": 4.1342080913521026e-05, "episode_len_max": 50, "episode_len_mean": 50.0, "sample": 0.731099200999779, "num_episodes_lifetime": 20, "episode_return_min": -14.5, "episode_return_max": 17.5, "episode_duration_sec_mean": 0.035106365050023666, "episode_len_min": 50, "env_to_module_sum_episodes_length_out": 27.167134025045954, "env_to_module_sum_episodes_length_in": 27.167134025045954}, "num_healthy_workers": 1, "actor_manager_num_outstanding_async_reqs": 0, "num_remote_worker_restarts": 0}, "fault_tolerance": {"num_healthy_workers": 0, "num_remote_worker_restarts": 0}, "env_runner_group": {"actor_manager_num_outstanding_async_reqs": 0}, "done": false, "training_iteration": 1, "trial_id": "a54d5_00000", "date": "2025-08-11_17-22-43", "timestamp": 1754925763, "time_this_iter_s": 4.963442325592041, "time_total_s": 4.963442325592041, "pid": 73571, "hostname": "DESKTOP-3SK5A41", "node_ip": "192.168.40.242", "config": {"exploration_config": {}, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 6, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "env": "Umbrella", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": false, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 0, "create_local_env_runner": true, "num_envs_per_env_runner": 1, "gym_env_vectorize_mode": "SYNC", "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "episodes_to_numpy": true, "max_requests_in_flight_per_env_runner": 1, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "merge_env_runner_states": "training_only", "broadcast_env_runner_states": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "complete_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "sampler_perf_stats_ema_coef": null, "_is_online": true, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": "auto", "num_aggregator_actors_per_learner": 0, "max_requests_in_flight_per_aggregator_actor": 3, "local_gpu_idx": 0, "max_requests_in_flight_per_learner": 3, "gamma": 1, "lr": 0.0008209260984, "grad_clip": 0.5, "grad_clip_by": "global_norm", "_train_batch_size_per_learner": 5000, "train_batch_size": 4000, "num_epochs": 1, "minibatch_size": 1000, "shuffle_batch_per_epoch": true, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "log_std_clip_param": 20.0, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "_disable_preprocessor_api": false, "_disable_action_flattening": false}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "_learner_class": null, "callbacks_on_algorithm_init": null, "callbacks_on_env_runners_recreated": null, "callbacks_on_offline_eval_runners_recreated": null, "callbacks_on_checkpoint_loaded": null, "callbacks_on_environment_created": null, "callbacks_on_episode_created": null, "callbacks_on_episode_start": null, "callbacks_on_episode_step": null, "callbacks_on_episode_end": null, "callbacks_on_evaluate_start": null, "callbacks_on_evaluate_end": null, "callbacks_on_evaluate_offline_start": null, "callbacks_on_evaluate_offline_end": null, "callbacks_on_sample_end": null, "callbacks_on_train_result": null, "explore": true, "enable_rl_module_and_learner": true, "enable_env_runner_and_connector_v2": true, "_prior_exploration_config": {"type": "StochasticSampling"}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x70470debeac0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "offline_data_class": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_read_batch_size": null, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "materialize_data": false, "materialize_mapped_data": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "ignore_final_observation": false, "prelearner_class": null, "prelearner_buffer_class": null, "prelearner_buffer_kwargs": {}, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_remaining_data": false, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": 1, "evaluation_duration": 20, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_auto_duration_min_env_steps_per_sample": 100, "evaluation_auto_duration_max_env_steps_per_sample": 2000, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 1, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "offline_evaluation_interval": null, "num_offline_eval_runners": 0, "offline_loss_for_module_fn": null, "offline_evaluation_duration": 1, "offline_evaluation_parallel_to_training": false, "offline_evaluation_timeout_s": 120.0, "num_cpus_per_offline_eval_runner": 1, "num_gpus_per_offline_eval_runner": 0, "custom_resources_per_offline_eval_runner": {}, "restart_failed_offline_eval_runners": true, "ignore_offline_eval_runner_failures": false, "max_num_offline_eval_runner_restarts": 1000, "offline_eval_runner_restore_timeout_s": 1800.0, "max_requests_in_flight_per_offline_eval_runner": 1, "validate_offline_eval_runners_after_construction": true, "offline_eval_runner_health_probe_timeout_s": 30.0, "offline_eval_rl_module_inference_only": false, "broadcast_offline_eval_runner_states": false, "offline_eval_batch_size_per_runner": 256, "dataset_num_iters_per_eval_runner": 1, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "log_gradients": true, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 42, "restart_failed_env_runners": true, "ignore_env_runner_failures": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30.0, "env_runner_restore_timeout_s": 1800.0, "_model_config": {}, "_rl_module_spec": "RLModuleSpec(module_class=None, observation_space=None, action_space=None, inference_only=False, learner_only=False, model_config=DefaultModelConfig(fcnet_hiddens=[43, 122], fcnet_activation='tanh', fcnet_kernel_initializer=None, fcnet_kernel_initializer_kwargs=None, fcnet_bias_initializer=None, fcnet_bias_initializer_kwargs=None, conv_filters=None, conv_activation='relu', conv_kernel_initializer=None, conv_kernel_initializer_kwargs=None, conv_bias_initializer=None, conv_bias_initializer_kwargs=None, head_fcnet_hiddens=[], head_fcnet_activation='relu', head_fcnet_kernel_initializer=None, head_fcnet_kernel_initializer_kwargs=None, head_fcnet_bias_initializer=None, head_fcnet_bias_initializer_kwargs=None, free_log_std=False, log_std_clip_param=20.0, vf_share_layers=True, use_lstm=False, max_seq_len=20, lstm_cell_size=256, lstm_use_prev_action=False, lstm_use_prev_reward=False, lstm_kernel_initializer=None, lstm_kernel_initializer_kwargs=None, lstm_bias_initializer=None, lstm_bias_initializer_kwargs=None), catalog_class=None, load_state_path=None, model_config_dict=None)", "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "_validate_config": true, "_use_msgpack_checkpoints": false, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "env_task_fn": -1, "enable_connectors": -1, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2617985289524, "kl_target": 0.0294268671804, "vf_loss_coeff": 0.5611379931, "entropy_coeff": 0.0016790048723, "clip_param": 0.1271344785601, "vf_clip_param": 0.2507399863488, "entropy_coeff_schedule": null, "lr_schedule": null, "sgd_minibatch_size": -1, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9822919715622, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.callbacks.callbacks.RLlibCallback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 4.963442325592041, "iterations_since_restore": 1, "perf": {"cpu_util_percent": 11.412500000000001, "ram_util_percent": 87.75}}
{"timers": {"training_iteration": 4.215989923970028, "restore_env_runners": 1.4577000210920233e-05, "training_step": 4.215689779970053, "env_runner_sampling_timer": 3.8021853679705964, "learner_update_timer": 0.41001805499951843, "synch_weights": 0.0014327399997728207, "restore_eval_env_runners": 1.6699999832781032e-05, "evaluation_iteration": 0.7431836010000552, "synch_eval_env_connectors": 0.0004060000001118169, "synch_env_connectors": 7.79999936639797e-06}, "env_runners": {"num_episodes": 100.0, "sample": 0.03804410550161168, "module_to_env_connector": {"timers": {"connectors": {"un_batch_to_individual_items": 1.4736607092566032e-05, "listify_data_for_vector_env": 3.11451012622538e-05, "get_actions": 0.00016574880810729984, "normalize_and_clip_actions": 2.2484124851538935e-05, "tensor_to_numpy": 4.8505305925817506e-05, "remove_single_ts_time_rank_from_batch": 1.4379165549931046e-06}}, "connector_pipeline_timer": 0.00036121639922217906}, "agent_episode_returns_mean": {"default_agent": 3.899999999999998}, "num_module_steps_sampled_lifetime": {"default_policy": 10000.0}, "env_to_module_connector": {"timers": {"connectors": {"batch_individual_items": 1.850247318313102e-05, "add_observations_from_episodes_to_batch": 6.679223802039961e-06, "add_states_from_episodes_to_batch": 3.494675468191984e-06, "numpy_to_tensor": 3.121549869868882e-05, "add_time_dim_to_batch_and_zero_pad": 6.554637641767966e-06}}, "connector_pipeline_timer": 0.00011928938049067392}, "num_episodes_lifetime": 200.0, "time_between_sampling": 0.009021379065974517, "module_episode_returns_mean": {"default_policy": 3.899999999999998}, "env_to_module_sum_episodes_length_in": 27.16809333212661, "episode_return_min": -5.5, "episode_return_max": 14.5, "num_env_steps_sampled_lifetime": 10000.0, "rlmodule_inference_timer": 0.0001002916697373994, "episode_duration_sec_mean": 0.0366132650399868, "num_agent_steps_sampled": {"default_agent": 5000.0}, "num_agent_steps_sampled_lifetime": {"default_agent": 10000.0}, "env_reset_timer": 0.00013464567981231486, "episode_return_mean": 3.899999999999998, "weights_seq_no": 1.0, "num_module_steps_sampled": {"default_policy": 5000.0}, "episode_len_min": 50, "env_step_timer": 4.3902457485161964e-05, "episode_len_max": 50, "num_env_steps_sampled": 5000.0, "env_to_module_sum_episodes_length_out": 27.16809333212661, "episode_len_mean": 50.0, "num_env_steps_sampled_lifetime_throughput": 1282.6905700727857}, "learners": {"__all_modules__": {"learner_connector": {"timers": {"connectors": {"general_advantage_estimation": 0.013281575999626512, "add_columns_from_episodes_to_train_batch": 0.06906012200077384, "batch_individual_items": 0.1996661669993773, "add_observations_from_episodes_to_batch": 0.0008030589996087656, "numpy_to_tensor": 0.00016268000014861174, "add_states_from_episodes_to_batch": 6.199999916134402e-06, "add_time_dim_to_batch_and_zero_pad": 2.370099948166171e-05, "add_one_ts_to_episodes_and_truncate": 0.008138588000037998}}, "connector_pipeline_timer": 0.2915188630000466}, "num_env_steps_trained_lifetime": 61200, "num_non_trainable_parameters": 0, "learner_connector_sum_episodes_length_in": 5000.0, "num_module_steps_trained": 6000, "num_trainable_parameters": 5909, "num_module_steps_trained_lifetime": 12000, "num_env_steps_trained": 30600, "learner_connector_sum_episodes_length_out": 5100.0, "num_env_steps_trained_lifetime_throughput": 857708.0274630557, "num_module_steps_trained_throughput": 168769.62392489883, "num_module_steps_trained_lifetime_throughput": 168658.91688537697}, "default_policy": {"total_loss": 0.34578782320022583, "diff_num_grad_updates_vs_sampler_policy": 1.0, "vf_loss": 0.24435290694236755, "mean_kl_loss": 0.0010721749858930707, "curr_entropy_coeff": 0.0016790048723, "gradients_default_optimizer_global_norm": 0.09521248191595078, "num_module_steps_trained": 6000, "weights_seq_no": 2.0, "entropy": 0.6895268559455872, "num_trainable_parameters": 5909, "module_train_batch_size_mean": 1000.0, "vf_loss_unclipped": 44.118385314941406, "num_module_steps_trained_lifetime": 12000, "vf_explained_var": 0.02581942081451416, "curr_kl_coeff": 0.06544963270425797, "policy_loss": 0.20968952775001526, "default_optimizer_learning_rate": 0.0008209260984, "num_module_steps_trained_lifetime_throughput": 169120.21720031006}}, "num_training_step_calls_per_iteration": 1, "evaluation": {"env_runners": {"module_episode_returns_mean": {"default_policy": -1.9}, "module_to_env_connector": {"timers": {"connectors": {"remove_single_ts_time_rank_from_batch": 1.3522895814485045e-06, "listify_data_for_vector_env": 2.9136794552882964e-05, "get_actions": 0.00015003741442060707, "un_batch_to_individual_items": 1.4937371277358678e-05, "normalize_and_clip_actions": 2.1047425060858297e-05, "tensor_to_numpy": 4.38556666633227e-05}}, "connector_pipeline_timer": 0.0003377326490261813}, "agent_episode_returns_mean": {"default_agent": -1.9}, "num_env_steps_sampled": 1000, "num_module_steps_sampled": {"default_policy": 1000}, "num_episodes": 20, "env_to_module_connector": {"timers": {"connectors": {"add_observations_from_episodes_to_batch": 5.97960332804511e-06, "add_states_from_episodes_to_batch": 3.5213837473341226e-06, "numpy_to_tensor": 2.9224588600571383e-05, "add_time_dim_to_batch_and_zero_pad": 5.882540186625469e-06, "batch_individual_items": 1.745621962825553e-05}}, "connector_pipeline_timer": 0.00011639329875379871}, "num_module_steps_sampled_lifetime": {"default_policy": 2000}, "num_agent_steps_sampled_lifetime": {"default_agent": 2000}, "num_agent_steps_sampled": {"default_agent": 1000}, "rlmodule_inference_timer": 9.317702733883221e-05, "num_env_steps_sampled_lifetime": 11000, "env_reset_timer": 0.00021192099948166287, "episode_return_mean": -1.9, "weights_seq_no": 2.0, "env_step_timer": 4.137767827953305e-05, "episode_len_max": 50, "episode_len_mean": 50.0, "sample": 0.731075570999783, "num_episodes_lifetime": 40, "episode_return_min": -16.5, "episode_return_max": 17.5, "episode_duration_sec_mean": 0.035054335050153894, "episode_len_min": 50, "env_to_module_sum_episodes_length_out": 27.168093298253442, "env_to_module_sum_episodes_length_in": 27.168093298253442, "time_between_sampling": 4.15946150399941}, "num_healthy_workers": 1, "actor_manager_num_outstanding_async_reqs": 0, "num_remote_worker_restarts": 0}, "num_env_steps_sampled_lifetime": 10000.0, "fault_tolerance": {"num_healthy_workers": 0, "num_remote_worker_restarts": 0}, "env_runner_group": {"actor_manager_num_outstanding_async_reqs": 0}, "done": false, "training_iteration": 2, "trial_id": "a54d5_00000", "date": "2025-08-11_17-22-48", "timestamp": 1754925768, "time_this_iter_s": 4.8469014167785645, "time_total_s": 9.810343742370605, "pid": 73571, "hostname": "DESKTOP-3SK5A41", "node_ip": "192.168.40.242", "config": {"exploration_config": {}, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 6, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "env": "Umbrella", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": false, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 0, "create_local_env_runner": true, "num_envs_per_env_runner": 1, "gym_env_vectorize_mode": "SYNC", "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "episodes_to_numpy": true, "max_requests_in_flight_per_env_runner": 1, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "merge_env_runner_states": "training_only", "broadcast_env_runner_states": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "complete_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "sampler_perf_stats_ema_coef": null, "_is_online": true, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": "auto", "num_aggregator_actors_per_learner": 0, "max_requests_in_flight_per_aggregator_actor": 3, "local_gpu_idx": 0, "max_requests_in_flight_per_learner": 3, "gamma": 1, "lr": 0.0008209260984, "grad_clip": 0.5, "grad_clip_by": "global_norm", "_train_batch_size_per_learner": 5000, "train_batch_size": 4000, "num_epochs": 1, "minibatch_size": 1000, "shuffle_batch_per_epoch": true, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "log_std_clip_param": 20.0, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "_disable_preprocessor_api": false, "_disable_action_flattening": false}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "_learner_class": null, "callbacks_on_algorithm_init": null, "callbacks_on_env_runners_recreated": null, "callbacks_on_offline_eval_runners_recreated": null, "callbacks_on_checkpoint_loaded": null, "callbacks_on_environment_created": null, "callbacks_on_episode_created": null, "callbacks_on_episode_start": null, "callbacks_on_episode_step": null, "callbacks_on_episode_end": null, "callbacks_on_evaluate_start": null, "callbacks_on_evaluate_end": null, "callbacks_on_evaluate_offline_start": null, "callbacks_on_evaluate_offline_end": null, "callbacks_on_sample_end": null, "callbacks_on_train_result": null, "explore": true, "enable_rl_module_and_learner": true, "enable_env_runner_and_connector_v2": true, "_prior_exploration_config": {"type": "StochasticSampling"}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x70470debeac0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "offline_data_class": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_read_batch_size": null, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "materialize_data": false, "materialize_mapped_data": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "ignore_final_observation": false, "prelearner_class": null, "prelearner_buffer_class": null, "prelearner_buffer_kwargs": {}, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_remaining_data": false, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": 1, "evaluation_duration": 20, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_auto_duration_min_env_steps_per_sample": 100, "evaluation_auto_duration_max_env_steps_per_sample": 2000, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 1, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "offline_evaluation_interval": null, "num_offline_eval_runners": 0, "offline_loss_for_module_fn": null, "offline_evaluation_duration": 1, "offline_evaluation_parallel_to_training": false, "offline_evaluation_timeout_s": 120.0, "num_cpus_per_offline_eval_runner": 1, "num_gpus_per_offline_eval_runner": 0, "custom_resources_per_offline_eval_runner": {}, "restart_failed_offline_eval_runners": true, "ignore_offline_eval_runner_failures": false, "max_num_offline_eval_runner_restarts": 1000, "offline_eval_runner_restore_timeout_s": 1800.0, "max_requests_in_flight_per_offline_eval_runner": 1, "validate_offline_eval_runners_after_construction": true, "offline_eval_runner_health_probe_timeout_s": 30.0, "offline_eval_rl_module_inference_only": false, "broadcast_offline_eval_runner_states": false, "offline_eval_batch_size_per_runner": 256, "dataset_num_iters_per_eval_runner": 1, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "log_gradients": true, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 42, "restart_failed_env_runners": true, "ignore_env_runner_failures": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30.0, "env_runner_restore_timeout_s": 1800.0, "_model_config": {}, "_rl_module_spec": "RLModuleSpec(module_class=None, observation_space=None, action_space=None, inference_only=False, learner_only=False, model_config=DefaultModelConfig(fcnet_hiddens=[43, 122], fcnet_activation='tanh', fcnet_kernel_initializer=None, fcnet_kernel_initializer_kwargs=None, fcnet_bias_initializer=None, fcnet_bias_initializer_kwargs=None, conv_filters=None, conv_activation='relu', conv_kernel_initializer=None, conv_kernel_initializer_kwargs=None, conv_bias_initializer=None, conv_bias_initializer_kwargs=None, head_fcnet_hiddens=[], head_fcnet_activation='relu', head_fcnet_kernel_initializer=None, head_fcnet_kernel_initializer_kwargs=None, head_fcnet_bias_initializer=None, head_fcnet_bias_initializer_kwargs=None, free_log_std=False, log_std_clip_param=20.0, vf_share_layers=True, use_lstm=False, max_seq_len=20, lstm_cell_size=256, lstm_use_prev_action=False, lstm_use_prev_reward=False, lstm_kernel_initializer=None, lstm_kernel_initializer_kwargs=None, lstm_bias_initializer=None, lstm_bias_initializer_kwargs=None), catalog_class=None, load_state_path=None, model_config_dict=None)", "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "_validate_config": true, "_use_msgpack_checkpoints": false, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "env_task_fn": -1, "enable_connectors": -1, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2617985289524, "kl_target": 0.0294268671804, "vf_loss_coeff": 0.5611379931, "entropy_coeff": 0.0016790048723, "clip_param": 0.1271344785601, "vf_clip_param": 0.2507399863488, "entropy_coeff_schedule": null, "lr_schedule": null, "sgd_minibatch_size": -1, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9822919715622, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.callbacks.callbacks.RLlibCallback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 9.810343742370605, "iterations_since_restore": 2, "perf": {"cpu_util_percent": 13.485714285714286, "ram_util_percent": 87.89999999999999}}
{"timers": {"training_iteration": 4.2159399604803225, "restore_env_runners": 1.4575230213904433e-05, "training_step": 4.2156387519203555, "env_runner_sampling_timer": 3.804346941980889, "learner_update_timer": 0.40780321650951856, "synch_weights": 0.0014325885997793191, "restore_eval_env_runners": 1.665599983425636e-05, "evaluation_iteration": 0.7431407500000569, "synch_eval_env_connectors": 0.00040596700011519716, "synch_env_connectors": 7.798999367878423e-06}, "env_runners": {"num_episodes": 100.0, "sample": 0.03802876722352591, "module_to_env_connector": {"timers": {"connectors": {"un_batch_to_individual_items": 1.4580566917859089e-05, "listify_data_for_vector_env": 3.09582837830608e-05, "get_actions": 0.00016449483542107054, "normalize_and_clip_actions": 2.212212672108575e-05, "tensor_to_numpy": 4.7888611036782756e-05, "remove_single_ts_time_rank_from_batch": 1.4214703843102523e-06}}, "connector_pipeline_timer": 0.0003577860206525068}, "agent_episode_returns_mean": {"default_agent": 3.7}, "num_module_steps_sampled_lifetime": {"default_policy": -232500.0}, "env_to_module_connector": {"timers": {"connectors": {"batch_individual_items": 1.824465175390362e-05, "add_observations_from_episodes_to_batch": 6.4943420422093176e-06, "add_states_from_episodes_to_batch": 3.4626270775750904e-06, "numpy_to_tensor": 3.105341792905998e-05, "add_time_dim_to_batch_and_zero_pad": 6.491343181015758e-06}}, "connector_pipeline_timer": 0.00011804831027055539}, "num_episodes_lifetime": -4650.0, "time_between_sampling": 0.010378450476983693, "module_episode_returns_mean": {"default_policy": 3.7}, "env_to_module_sum_episodes_length_in": 27.16809333212661, "episode_return_min": -5.5, "episode_return_max": 14.5, "num_env_steps_sampled_lifetime": -232500.0, "rlmodule_inference_timer": 0.000133809693908136, "episode_duration_sec_mean": 0.03766204764001485, "num_agent_steps_sampled": {"default_agent": 5000.0}, "num_agent_steps_sampled_lifetime": {"default_agent": -232500.0}, "env_reset_timer": 0.00010994054403817007, "episode_return_mean": 3.7, "weights_seq_no": 2.0, "num_module_steps_sampled": {"default_policy": 5000.0}, "episode_len_min": 50, "env_step_timer": 4.3572706167224084e-05, "episode_len_max": 50, "num_env_steps_sampled": 5000.0, "env_to_module_sum_episodes_length_out": 27.16809333212661, "episode_len_mean": 50.0, "num_env_steps_sampled_lifetime_throughput": 1279.7448072835025}, "learners": {"__all_modules__": {"learner_connector": {"timers": {"connectors": {"general_advantage_estimation": 0.013255989239634983, "add_columns_from_episodes_to_train_batch": 0.06904947880076652, "batch_individual_items": 0.1982472983393902, "add_observations_from_episodes_to_batch": 0.0008020904096078084, "numpy_to_tensor": 0.00016275620014521338, "add_states_from_episodes_to_batch": 6.19599991296127e-06, "add_time_dim_to_batch_and_zero_pad": 2.3701989489200058e-05, "add_one_ts_to_episodes_and_truncate": 0.008140833130039755}}, "connector_pipeline_timer": 0.2900647334100396}, "num_env_steps_trained_lifetime": 91800, "num_non_trainable_parameters": 0, "learner_connector_sum_episodes_length_in": 5000.0, "num_module_steps_trained": 6000, "num_trainable_parameters": 5909, "num_module_steps_trained_lifetime": 18000, "num_env_steps_trained": 30600, "learner_connector_sum_episodes_length_out": 5100.0, "num_env_steps_trained_lifetime_throughput": 854738.3665300813, "num_module_steps_trained_throughput": 168179.24554519786, "num_module_steps_trained_lifetime_throughput": 168067.133303035}, "default_policy": {"total_loss": -0.02876691147685051, "diff_num_grad_updates_vs_sampler_policy": 1.0, "vf_loss": 0.24117685854434967, "mean_kl_loss": 0.0010041989153251052, "curr_entropy_coeff": 0.0016790048723, "gradients_default_optimizer_global_norm": 0.12466274201869965, "num_module_steps_trained": 6000, "weights_seq_no": 3.0, "entropy": 0.6897563934326172, "num_trainable_parameters": 5909, "module_train_batch_size_mean": 1000.0, "vf_loss_unclipped": 55.72294235229492, "num_module_steps_trained_lifetime": 18000, "vf_explained_var": 0.044881582260131836, "curr_kl_coeff": 0.03272481635212898, "policy_loss": -0.16300798952579498, "default_optimizer_learning_rate": 0.0008209260984, "num_module_steps_trained_lifetime_throughput": 168515.78097487154}}, "num_training_step_calls_per_iteration": 1, "evaluation": {"env_runners": {"module_episode_returns_mean": {"default_policy": -1.5666666666666667}, "module_to_env_connector": {"timers": {"connectors": {"remove_single_ts_time_rank_from_batch": 1.389274503032768e-06, "listify_data_for_vector_env": 3.060777350261439e-05, "get_actions": 0.00015275244152326153, "un_batch_to_individual_items": 1.4963657215021453e-05, "normalize_and_clip_actions": 2.1449623265219113e-05, "tensor_to_numpy": 4.539870958703011e-05}}, "connector_pipeline_timer": 0.0003429620384457311}, "agent_episode_returns_mean": {"default_agent": -1.5666666666666667}, "num_env_steps_sampled": 1000, "num_module_steps_sampled": {"default_policy": 1000}, "num_episodes": 20, "env_to_module_connector": {"timers": {"connectors": {"add_observations_from_episodes_to_batch": 6.24229442788057e-06, "add_states_from_episodes_to_batch": 3.3668077410457264e-06, "numpy_to_tensor": 2.9111069738939873e-05, "add_time_dim_to_batch_and_zero_pad": 6.04698183873617e-06, "batch_individual_items": 1.8202516868226604e-05}}, "connector_pipeline_timer": 0.00011777867339981271}, "num_module_steps_sampled_lifetime": {"default_policy": 3000}, "num_agent_steps_sampled_lifetime": {"default_agent": 3000}, "num_agent_steps_sampled": {"default_agent": 1000}, "rlmodule_inference_timer": 9.459695646564772e-05, "num_env_steps_sampled_lifetime": 16000, "env_reset_timer": 0.00021107578948340234, "episode_return_mean": -1.5666666666666667, "weights_seq_no": 3.0, "env_step_timer": 4.068167416792461e-05, "episode_len_max": 50, "episode_len_mean": 50.0, "sample": 0.731083303489793, "num_episodes_lifetime": 60, "episode_return_min": -16.5, "episode_return_max": 17.5, "episode_duration_sec_mean": 0.035091708700125915, "episode_len_min": 50, "env_to_module_sum_episodes_length_out": 27.168093332125434, "env_to_module_sum_episodes_length_in": 27.168093332125434, "time_between_sampling": 4.160520761709413}, "num_healthy_workers": 1, "actor_manager_num_outstanding_async_reqs": 0, "num_remote_worker_restarts": 0}, "num_env_steps_sampled_lifetime": -232500.0, "fault_tolerance": {"num_healthy_workers": 0, "num_remote_worker_restarts": 0}, "env_runner_group": {"actor_manager_num_outstanding_async_reqs": 0}, "done": false, "training_iteration": 3, "trial_id": "a54d5_00000", "date": "2025-08-11_17-22-53", "timestamp": 1754925773, "time_this_iter_s": 4.95757532119751, "time_total_s": 14.767919063568115, "pid": 73571, "hostname": "DESKTOP-3SK5A41", "node_ip": "192.168.40.242", "config": {"exploration_config": {}, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 6, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "env": "Umbrella", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": false, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 0, "create_local_env_runner": true, "num_envs_per_env_runner": 1, "gym_env_vectorize_mode": "SYNC", "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "episodes_to_numpy": true, "max_requests_in_flight_per_env_runner": 1, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "merge_env_runner_states": "training_only", "broadcast_env_runner_states": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "complete_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "sampler_perf_stats_ema_coef": null, "_is_online": true, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": "auto", "num_aggregator_actors_per_learner": 0, "max_requests_in_flight_per_aggregator_actor": 3, "local_gpu_idx": 0, "max_requests_in_flight_per_learner": 3, "gamma": 1, "lr": 0.0008209260984, "grad_clip": 0.5, "grad_clip_by": "global_norm", "_train_batch_size_per_learner": 5000, "train_batch_size": 4000, "num_epochs": 1, "minibatch_size": 1000, "shuffle_batch_per_epoch": true, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "log_std_clip_param": 20.0, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "_disable_preprocessor_api": false, "_disable_action_flattening": false}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "_learner_class": null, "callbacks_on_algorithm_init": null, "callbacks_on_env_runners_recreated": null, "callbacks_on_offline_eval_runners_recreated": null, "callbacks_on_checkpoint_loaded": null, "callbacks_on_environment_created": null, "callbacks_on_episode_created": null, "callbacks_on_episode_start": null, "callbacks_on_episode_step": null, "callbacks_on_episode_end": null, "callbacks_on_evaluate_start": null, "callbacks_on_evaluate_end": null, "callbacks_on_evaluate_offline_start": null, "callbacks_on_evaluate_offline_end": null, "callbacks_on_sample_end": null, "callbacks_on_train_result": null, "explore": true, "enable_rl_module_and_learner": true, "enable_env_runner_and_connector_v2": true, "_prior_exploration_config": {"type": "StochasticSampling"}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x70470debeac0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "offline_data_class": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_read_batch_size": null, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "materialize_data": false, "materialize_mapped_data": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "ignore_final_observation": false, "prelearner_class": null, "prelearner_buffer_class": null, "prelearner_buffer_kwargs": {}, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_remaining_data": false, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": 1, "evaluation_duration": 20, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_auto_duration_min_env_steps_per_sample": 100, "evaluation_auto_duration_max_env_steps_per_sample": 2000, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 1, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "offline_evaluation_interval": null, "num_offline_eval_runners": 0, "offline_loss_for_module_fn": null, "offline_evaluation_duration": 1, "offline_evaluation_parallel_to_training": false, "offline_evaluation_timeout_s": 120.0, "num_cpus_per_offline_eval_runner": 1, "num_gpus_per_offline_eval_runner": 0, "custom_resources_per_offline_eval_runner": {}, "restart_failed_offline_eval_runners": true, "ignore_offline_eval_runner_failures": false, "max_num_offline_eval_runner_restarts": 1000, "offline_eval_runner_restore_timeout_s": 1800.0, "max_requests_in_flight_per_offline_eval_runner": 1, "validate_offline_eval_runners_after_construction": true, "offline_eval_runner_health_probe_timeout_s": 30.0, "offline_eval_rl_module_inference_only": false, "broadcast_offline_eval_runner_states": false, "offline_eval_batch_size_per_runner": 256, "dataset_num_iters_per_eval_runner": 1, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "log_gradients": true, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 42, "restart_failed_env_runners": true, "ignore_env_runner_failures": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30.0, "env_runner_restore_timeout_s": 1800.0, "_model_config": {}, "_rl_module_spec": "RLModuleSpec(module_class=None, observation_space=None, action_space=None, inference_only=False, learner_only=False, model_config=DefaultModelConfig(fcnet_hiddens=[43, 122], fcnet_activation='tanh', fcnet_kernel_initializer=None, fcnet_kernel_initializer_kwargs=None, fcnet_bias_initializer=None, fcnet_bias_initializer_kwargs=None, conv_filters=None, conv_activation='relu', conv_kernel_initializer=None, conv_kernel_initializer_kwargs=None, conv_bias_initializer=None, conv_bias_initializer_kwargs=None, head_fcnet_hiddens=[], head_fcnet_activation='relu', head_fcnet_kernel_initializer=None, head_fcnet_kernel_initializer_kwargs=None, head_fcnet_bias_initializer=None, head_fcnet_bias_initializer_kwargs=None, free_log_std=False, log_std_clip_param=20.0, vf_share_layers=True, use_lstm=False, max_seq_len=20, lstm_cell_size=256, lstm_use_prev_action=False, lstm_use_prev_reward=False, lstm_kernel_initializer=None, lstm_kernel_initializer_kwargs=None, lstm_bias_initializer=None, lstm_bias_initializer_kwargs=None), catalog_class=None, load_state_path=None, model_config_dict=None)", "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "_validate_config": true, "_use_msgpack_checkpoints": false, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "env_task_fn": -1, "enable_connectors": -1, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2617985289524, "kl_target": 0.0294268671804, "vf_loss_coeff": 0.5611379931, "entropy_coeff": 0.0016790048723, "clip_param": 0.1271344785601, "vf_clip_param": 0.2507399863488, "entropy_coeff_schedule": null, "lr_schedule": null, "sgd_minibatch_size": -1, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9822919715622, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.callbacks.callbacks.RLlibCallback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 14.767919063568115, "iterations_since_restore": 3, "perf": {"cpu_util_percent": 12.814285714285715, "ram_util_percent": 87.91428571428571}}
{"timers": {"training_iteration": 4.215893881005521, "restore_env_runners": 1.4556477905646717e-05, "training_step": 4.215591958531149, "env_runner_sampling_timer": 3.805122266601079, "learner_update_timer": 0.40698023143442025, "synch_weights": 0.0014326747137819735, "restore_eval_env_runners": 1.663643983656584e-05, "evaluation_iteration": 0.7431264397000519, "synch_eval_env_connectors": 0.000406766330114624, "synch_env_connectors": 7.79600937230498e-06}, "env_runners": {"num_episodes": 100.0, "sample": 0.03809104816832134, "module_to_env_connector": {"timers": {"connectors": {"un_batch_to_individual_items": 1.4606669380438847e-05, "listify_data_for_vector_env": 3.093520471340502e-05, "get_actions": 0.00016467490684592918, "normalize_and_clip_actions": 2.214520853944558e-05, "tensor_to_numpy": 4.81135425213142e-05, "remove_single_ts_time_rank_from_batch": 1.4300053155156743e-06}}, "connector_pipeline_timer": 0.000358341410881649}, "agent_episode_returns_mean": {"default_agent": 6.299999999999996}, "num_module_steps_sampled_lifetime": {"default_policy": -475000.0}, "env_to_module_connector": {"timers": {"connectors": {"batch_individual_items": 1.836560071365659e-05, "add_observations_from_episodes_to_batch": 6.5072019721275616e-06, "add_states_from_episodes_to_batch": 3.4246305502055e-06, "numpy_to_tensor": 3.097144706339117e-05, "add_time_dim_to_batch_and_zero_pad": 6.516070055014213e-06}}, "connector_pipeline_timer": 0.00011810508707666368}, "num_episodes_lifetime": -9500.0, "time_between_sampling": 0.010919855071456515, "module_episode_returns_mean": {"default_policy": 6.299999999999996}, "env_to_module_sum_episodes_length_in": 27.16809333212661, "episode_return_min": -5.5, "episode_return_max": 14.5, "num_env_steps_sampled_lifetime": -475000.0, "rlmodule_inference_timer": 9.968746294541102e-05, "episode_duration_sec_mean": 0.0363030819699634, "num_agent_steps_sampled": {"default_agent": 5000.0}, "num_agent_steps_sampled_lifetime": {"default_agent": -475000.0}, "env_reset_timer": 9.925242855207759e-05, "episode_return_mean": 6.299999999999996, "weights_seq_no": 3.0, "num_module_steps_sampled": {"default_policy": 5000.0}, "episode_len_min": 50, "env_step_timer": 4.3811949700374736e-05, "episode_len_max": 50, "num_env_steps_sampled": 5000.0, "env_to_module_sum_episodes_length_out": 27.16809333212661, "episode_len_mean": 50.0, "num_env_steps_sampled_lifetime_throughput": 1286.7033307794354}, "learners": {"__all_modules__": {"learner_connector": {"timers": {"connectors": {"general_advantage_estimation": 0.013233242357233102, "add_columns_from_episodes_to_train_batch": 0.06903969503275408, "batch_individual_items": 0.1982599814059939, "add_observations_from_episodes_to_batch": 0.0008007745055078758, "numpy_to_tensor": 0.0001627556381452241, "add_states_from_episodes_to_batch": 6.20103991468568e-06, "add_time_dim_to_batch_and_zero_pad": 2.3705969592221664e-05, "add_one_ts_to_episodes_and_truncate": 0.008141978798739884}}, "connector_pipeline_timer": 0.2900438921559392}, "num_env_steps_trained_lifetime": 122400, "num_non_trainable_parameters": 0, "learner_connector_sum_episodes_length_in": 5000.0, "num_module_steps_trained": 6000, "num_trainable_parameters": 5909, "num_module_steps_trained_lifetime": 24000, "num_env_steps_trained": 30600, "learner_connector_sum_episodes_length_out": 5100.0, "num_env_steps_trained_lifetime_throughput": 851468.7347341939, "num_module_steps_trained_throughput": 167528.23871368883, "num_module_steps_trained_lifetime_throughput": 167415.5952867121}, "default_policy": {"total_loss": 0.01780148595571518, "diff_num_grad_updates_vs_sampler_policy": 1.0, "vf_loss": 0.2414018213748932, "mean_kl_loss": 0.005289246793836355, "curr_entropy_coeff": 0.0016790048723, "gradients_default_optimizer_global_norm": 0.06926289945840836, "num_module_steps_trained": 6000, "weights_seq_no": 4.0, "entropy": 0.6829471588134766, "num_trainable_parameters": 5909, "module_train_batch_size_mean": 1000.0, "vf_loss_unclipped": 63.602272033691406, "num_module_steps_trained_lifetime": 24000, "vf_explained_var": 0.06390750408172607, "curr_kl_coeff": 0.01636240817606449, "policy_loss": -0.11668465286493301, "default_optimizer_learning_rate": 0.0008209260984, "num_module_steps_trained_lifetime_throughput": 167847.45985367737}}, "num_training_step_calls_per_iteration": 1, "evaluation": {"env_runners": {"module_episode_returns_mean": {"default_policy": -1.15}, "module_to_env_connector": {"timers": {"connectors": {"remove_single_ts_time_rank_from_batch": 1.3796898571566224e-06, "listify_data_for_vector_env": 3.0420481296447443e-05, "get_actions": 0.00015055938686910368, "un_batch_to_individual_items": 1.5001539005057837e-05, "normalize_and_clip_actions": 2.1338181634275205e-05, "tensor_to_numpy": 4.4299246289011386e-05}}, "connector_pipeline_timer": 0.00033858111775363883}, "agent_episode_returns_mean": {"default_agent": -1.15}, "num_env_steps_sampled": 1000, "num_module_steps_sampled": {"default_policy": 1000}, "num_episodes": 20, "env_to_module_connector": {"timers": {"connectors": {"add_observations_from_episodes_to_batch": 6.090354111470835e-06, "add_states_from_episodes_to_batch": 3.226484175928835e-06, "numpy_to_tensor": 2.8814353987040105e-05, "add_time_dim_to_batch_and_zero_pad": 5.977805607347345e-06, "batch_individual_items": 1.7546561971245486e-05}}, "connector_pipeline_timer": 0.00011474843474078298}, "num_module_steps_sampled_lifetime": {"default_policy": 4000}, "num_agent_steps_sampled_lifetime": {"default_agent": 4000}, "num_agent_steps_sampled": {"default_agent": 1000}, "rlmodule_inference_timer": 9.272124949464728e-05, "num_env_steps_sampled_lifetime": 21000, "env_reset_timer": 0.0002102310315878731, "episode_return_mean": -1.15, "weights_seq_no": 4.0, "env_step_timer": 4.1299059491358026e-05, "episode_len_max": 50, "episode_len_mean": 50.0, "sample": 0.7310105945849031, "num_episodes_lifetime": 80, "episode_return_min": -16.5, "episode_return_max": 17.5, "episode_duration_sec_mean": 0.03501904668758016, "episode_len_min": 50, "env_to_module_sum_episodes_length_out": 27.168093332126602, "env_to_module_sum_episodes_length_in": 27.168093332126602, "time_between_sampling": 4.161554052232323}, "num_healthy_workers": 1, "actor_manager_num_outstanding_async_reqs": 0, "num_remote_worker_restarts": 0}, "num_env_steps_sampled_lifetime": -475000.0, "fault_tolerance": {"num_healthy_workers": 0, "num_remote_worker_restarts": 0}, "env_runner_group": {"actor_manager_num_outstanding_async_reqs": 0}, "done": false, "training_iteration": 4, "trial_id": "a54d5_00000", "date": "2025-08-11_17-22-58", "timestamp": 1754925778, "time_this_iter_s": 4.948940753936768, "time_total_s": 19.716859817504883, "pid": 73571, "hostname": "DESKTOP-3SK5A41", "node_ip": "192.168.40.242", "config": {"exploration_config": {}, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 6, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "env": "Umbrella", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": false, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 0, "create_local_env_runner": true, "num_envs_per_env_runner": 1, "gym_env_vectorize_mode": "SYNC", "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "episodes_to_numpy": true, "max_requests_in_flight_per_env_runner": 1, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "merge_env_runner_states": "training_only", "broadcast_env_runner_states": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "complete_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "sampler_perf_stats_ema_coef": null, "_is_online": true, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": "auto", "num_aggregator_actors_per_learner": 0, "max_requests_in_flight_per_aggregator_actor": 3, "local_gpu_idx": 0, "max_requests_in_flight_per_learner": 3, "gamma": 1, "lr": 0.0008209260984, "grad_clip": 0.5, "grad_clip_by": "global_norm", "_train_batch_size_per_learner": 5000, "train_batch_size": 4000, "num_epochs": 1, "minibatch_size": 1000, "shuffle_batch_per_epoch": true, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "log_std_clip_param": 20.0, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "_disable_preprocessor_api": false, "_disable_action_flattening": false}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "_learner_class": null, "callbacks_on_algorithm_init": null, "callbacks_on_env_runners_recreated": null, "callbacks_on_offline_eval_runners_recreated": null, "callbacks_on_checkpoint_loaded": null, "callbacks_on_environment_created": null, "callbacks_on_episode_created": null, "callbacks_on_episode_start": null, "callbacks_on_episode_step": null, "callbacks_on_episode_end": null, "callbacks_on_evaluate_start": null, "callbacks_on_evaluate_end": null, "callbacks_on_evaluate_offline_start": null, "callbacks_on_evaluate_offline_end": null, "callbacks_on_sample_end": null, "callbacks_on_train_result": null, "explore": true, "enable_rl_module_and_learner": true, "enable_env_runner_and_connector_v2": true, "_prior_exploration_config": {"type": "StochasticSampling"}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x70470debeac0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "offline_data_class": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_read_batch_size": null, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "materialize_data": false, "materialize_mapped_data": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "ignore_final_observation": false, "prelearner_class": null, "prelearner_buffer_class": null, "prelearner_buffer_kwargs": {}, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_remaining_data": false, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": 1, "evaluation_duration": 20, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_auto_duration_min_env_steps_per_sample": 100, "evaluation_auto_duration_max_env_steps_per_sample": 2000, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 1, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "offline_evaluation_interval": null, "num_offline_eval_runners": 0, "offline_loss_for_module_fn": null, "offline_evaluation_duration": 1, "offline_evaluation_parallel_to_training": false, "offline_evaluation_timeout_s": 120.0, "num_cpus_per_offline_eval_runner": 1, "num_gpus_per_offline_eval_runner": 0, "custom_resources_per_offline_eval_runner": {}, "restart_failed_offline_eval_runners": true, "ignore_offline_eval_runner_failures": false, "max_num_offline_eval_runner_restarts": 1000, "offline_eval_runner_restore_timeout_s": 1800.0, "max_requests_in_flight_per_offline_eval_runner": 1, "validate_offline_eval_runners_after_construction": true, "offline_eval_runner_health_probe_timeout_s": 30.0, "offline_eval_rl_module_inference_only": false, "broadcast_offline_eval_runner_states": false, "offline_eval_batch_size_per_runner": 256, "dataset_num_iters_per_eval_runner": 1, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "log_gradients": true, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 42, "restart_failed_env_runners": true, "ignore_env_runner_failures": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30.0, "env_runner_restore_timeout_s": 1800.0, "_model_config": {}, "_rl_module_spec": "RLModuleSpec(module_class=None, observation_space=None, action_space=None, inference_only=False, learner_only=False, model_config=DefaultModelConfig(fcnet_hiddens=[43, 122], fcnet_activation='tanh', fcnet_kernel_initializer=None, fcnet_kernel_initializer_kwargs=None, fcnet_bias_initializer=None, fcnet_bias_initializer_kwargs=None, conv_filters=None, conv_activation='relu', conv_kernel_initializer=None, conv_kernel_initializer_kwargs=None, conv_bias_initializer=None, conv_bias_initializer_kwargs=None, head_fcnet_hiddens=[], head_fcnet_activation='relu', head_fcnet_kernel_initializer=None, head_fcnet_kernel_initializer_kwargs=None, head_fcnet_bias_initializer=None, head_fcnet_bias_initializer_kwargs=None, free_log_std=False, log_std_clip_param=20.0, vf_share_layers=True, use_lstm=False, max_seq_len=20, lstm_cell_size=256, lstm_use_prev_action=False, lstm_use_prev_reward=False, lstm_kernel_initializer=None, lstm_kernel_initializer_kwargs=None, lstm_bias_initializer=None, lstm_bias_initializer_kwargs=None), catalog_class=None, load_state_path=None, model_config_dict=None)", "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "_validate_config": true, "_use_msgpack_checkpoints": false, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "env_task_fn": -1, "enable_connectors": -1, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2617985289524, "kl_target": 0.0294268671804, "vf_loss_coeff": 0.5611379931, "entropy_coeff": 0.0016790048723, "clip_param": 0.1271344785601, "vf_clip_param": 0.2507399863488, "entropy_coeff_schedule": null, "lr_schedule": null, "sgd_minibatch_size": -1, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9822919715622, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.callbacks.callbacks.RLlibCallback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 19.716859817504883, "iterations_since_restore": 4, "perf": {"cpu_util_percent": 12.842857142857143, "ram_util_percent": 87.94285714285715}}
{"timers": {"training_iteration": 4.2146088367454615, "restore_env_runners": 1.4523913132102981e-05, "training_step": 4.214306129495836, "env_runner_sampling_timer": 3.806067374465067, "learner_update_timer": 0.4047488671400801, "synch_weights": 0.0014336569666444968, "restore_eval_env_runners": 1.6617075438852228e-05, "evaluation_iteration": 0.7430289734430586, "synch_eval_env_connectors": 0.0004069566668125044, "synch_env_connectors": 7.780049277743275e-06}, "env_runners": {"num_episodes": 100.0, "sample": 0.0376991162127294, "module_to_env_connector": {"timers": {"connectors": {"un_batch_to_individual_items": 1.4749130222483317e-05, "listify_data_for_vector_env": 3.1089069052315474e-05, "get_actions": 0.00016533968150490356, "normalize_and_clip_actions": 2.2481980657241786e-05, "tensor_to_numpy": 4.8233318781890354e-05, "remove_single_ts_time_rank_from_batch": 1.4559317769892174e-06}}, "connector_pipeline_timer": 0.00036028576187886724}, "agent_episode_returns_mean": {"default_agent": 6.9}, "num_module_steps_sampled_lifetime": {"default_policy": -717500.0}, "env_to_module_connector": {"timers": {"connectors": {"batch_individual_items": 1.8313685279471487e-05, "add_observations_from_episodes_to_batch": 6.587029258729126e-06, "add_states_from_episodes_to_batch": 3.4175277004964363e-06, "numpy_to_tensor": 3.1143010025808075e-05, "add_time_dim_to_batch_and_zero_pad": 6.5844272097895075e-06}}, "connector_pipeline_timer": 0.00011842253860255627}, "num_episodes_lifetime": -14350.0, "time_between_sampling": 0.011939948433935041, "module_episode_returns_mean": {"default_policy": 6.9}, "env_to_module_sum_episodes_length_in": 27.16809333212661, "episode_return_min": -5.5, "episode_return_max": 14.5, "num_env_steps_sampled_lifetime": -717500.0, "rlmodule_inference_timer": 9.962755740340537e-05, "episode_duration_sec_mean": 0.03641521650002687, "num_agent_steps_sampled": {"default_agent": 5000.0}, "num_agent_steps_sampled_lifetime": {"default_agent": -717500.0}, "env_reset_timer": 9.70228537677621e-05, "episode_return_mean": 6.9, "weights_seq_no": 4.0, "num_module_steps_sampled": {"default_policy": 5000.0}, "episode_len_min": 50, "env_step_timer": 4.3776804077299856e-05, "episode_len_max": 50, "num_env_steps_sampled": 5000.0, "env_to_module_sum_episodes_length_out": 27.16809333212661, "episode_len_mean": 50.0, "num_env_steps_sampled_lifetime_throughput": 1282.6013009124545}, "learners": {"__all_modules__": {"learner_connector": {"timers": {"connectors": {"general_advantage_estimation": 0.013201169943664465, "add_columns_from_episodes_to_train_batch": 0.06903955609242607, "batch_individual_items": 0.19684795559193702, "add_observations_from_episodes_to_batch": 0.0007997807604462296, "numpy_to_tensor": 0.00016283808176968632, "add_states_from_episodes_to_batch": 6.192029509834357e-06, "add_time_dim_to_batch_and_zero_pad": 2.3696909895269052e-05, "add_one_ts_to_episodes_and_truncate": 0.008144190010759276}}, "connector_pipeline_timer": 0.28860014225437647}, "num_env_steps_trained_lifetime": 153000, "num_non_trainable_parameters": 0, "learner_connector_sum_episodes_length_in": 5000.0, "num_module_steps_trained": 6000, "num_trainable_parameters": 5909, "num_module_steps_trained_lifetime": 30000, "num_env_steps_trained": 30600, "learner_connector_sum_episodes_length_out": 5100.0, "num_env_steps_trained_lifetime_throughput": 847825.3348656325, "num_module_steps_trained_throughput": 166801.45218277085, "num_module_steps_trained_lifetime_throughput": 166687.954721714}, "default_policy": {"total_loss": 0.27561154961586, "diff_num_grad_updates_vs_sampler_policy": 1.0, "vf_loss": 0.2352440059185028, "mean_kl_loss": 0.005455780308693647, "curr_entropy_coeff": 0.0016790048723, "gradients_default_optimizer_global_norm": 0.37479349970817566, "num_module_steps_trained": 6000, "weights_seq_no": 5.0, "entropy": 0.6574840545654297, "num_trainable_parameters": 5909, "module_train_batch_size_mean": 1000.0, "vf_loss_unclipped": 57.4987678527832, "num_module_steps_trained_lifetime": 30000, "vf_explained_var": 0.08049958944320679, "curr_kl_coeff": 0.008181204088032246, "policy_loss": 0.14462189376354218, "default_optimizer_learning_rate": 0.0008209260984, "num_module_steps_trained_lifetime_throughput": 167101.8660269205}}, "num_training_step_calls_per_iteration": 1, "evaluation": {"env_runners": {"module_episode_returns_mean": {"default_policy": -1.1}, "module_to_env_connector": {"timers": {"connectors": {"remove_single_ts_time_rank_from_batch": 1.4159211248974027e-06, "listify_data_for_vector_env": 3.007855604734276e-05, "get_actions": 0.00015323368925731535, "un_batch_to_individual_items": 1.518629085747021e-05, "normalize_and_clip_actions": 2.124812029848728e-05, "tensor_to_numpy": 4.414626791492855e-05}}, "connector_pipeline_timer": 0.00034325311412802443}, "agent_episode_returns_mean": {"default_agent": -1.1}, "num_env_steps_sampled": 1000, "num_module_steps_sampled": {"default_policy": 1000}, "num_episodes": 20, "env_to_module_connector": {"timers": {"connectors": {"add_observations_from_episodes_to_batch": 6.129117807040352e-06, "add_states_from_episodes_to_batch": 3.5057939991156805e-06, "numpy_to_tensor": 2.9400826739643162e-05, "add_time_dim_to_batch_and_zero_pad": 5.964759245455747e-06, "batch_individual_items": 1.8075197918810385e-05}}, "connector_pipeline_timer": 0.0001175039331377572}, "num_module_steps_sampled_lifetime": {"default_policy": 5000}, "num_agent_steps_sampled_lifetime": {"default_agent": 5000}, "num_agent_steps_sampled": {"default_agent": 1000}, "rlmodule_inference_timer": 9.16477163941998e-05, "num_env_steps_sampled_lifetime": 26000, "env_reset_timer": 0.00020939172127574048, "episode_return_mean": -1.1, "weights_seq_no": 5.0, "env_step_timer": 4.169395638187484e-05, "episode_len_max": 50, "episode_len_mean": 50.0, "sample": 0.731001425739053, "num_episodes_lifetime": 100, "episode_return_min": -16.5, "episode_return_max": 17.5, "episode_duration_sec_mean": 0.03503535145005117, "episode_len_min": 50, "env_to_module_sum_episodes_length_out": 27.168093332126602, "env_to_module_sum_episodes_length_in": 27.168093332126602, "time_between_sampling": 4.161343606270004}, "num_healthy_workers": 1, "actor_manager_num_outstanding_async_reqs": 0, "num_remote_worker_restarts": 0}, "num_env_steps_sampled_lifetime": -717500.0, "fault_tolerance": {"num_healthy_workers": 0, "num_remote_worker_restarts": 0}, "env_runner_group": {"actor_manager_num_outstanding_async_reqs": 0}, "done": false, "training_iteration": 5, "trial_id": "a54d5_00000", "date": "2025-08-11_17-23-02", "timestamp": 1754925782, "time_this_iter_s": 4.831146478652954, "time_total_s": 24.548006296157837, "pid": 73571, "hostname": "DESKTOP-3SK5A41", "node_ip": "192.168.40.242", "config": {"exploration_config": {}, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 6, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "env": "Umbrella", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": false, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 0, "create_local_env_runner": true, "num_envs_per_env_runner": 1, "gym_env_vectorize_mode": "SYNC", "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "episodes_to_numpy": true, "max_requests_in_flight_per_env_runner": 1, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "merge_env_runner_states": "training_only", "broadcast_env_runner_states": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "complete_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "sampler_perf_stats_ema_coef": null, "_is_online": true, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": "auto", "num_aggregator_actors_per_learner": 0, "max_requests_in_flight_per_aggregator_actor": 3, "local_gpu_idx": 0, "max_requests_in_flight_per_learner": 3, "gamma": 1, "lr": 0.0008209260984, "grad_clip": 0.5, "grad_clip_by": "global_norm", "_train_batch_size_per_learner": 5000, "train_batch_size": 4000, "num_epochs": 1, "minibatch_size": 1000, "shuffle_batch_per_epoch": true, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "log_std_clip_param": 20.0, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "_disable_preprocessor_api": false, "_disable_action_flattening": false}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "_learner_class": null, "callbacks_on_algorithm_init": null, "callbacks_on_env_runners_recreated": null, "callbacks_on_offline_eval_runners_recreated": null, "callbacks_on_checkpoint_loaded": null, "callbacks_on_environment_created": null, "callbacks_on_episode_created": null, "callbacks_on_episode_start": null, "callbacks_on_episode_step": null, "callbacks_on_episode_end": null, "callbacks_on_evaluate_start": null, "callbacks_on_evaluate_end": null, "callbacks_on_evaluate_offline_start": null, "callbacks_on_evaluate_offline_end": null, "callbacks_on_sample_end": null, "callbacks_on_train_result": null, "explore": true, "enable_rl_module_and_learner": true, "enable_env_runner_and_connector_v2": true, "_prior_exploration_config": {"type": "StochasticSampling"}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x70470debeac0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "offline_data_class": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_read_batch_size": null, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "materialize_data": false, "materialize_mapped_data": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "ignore_final_observation": false, "prelearner_class": null, "prelearner_buffer_class": null, "prelearner_buffer_kwargs": {}, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_remaining_data": false, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": 1, "evaluation_duration": 20, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_auto_duration_min_env_steps_per_sample": 100, "evaluation_auto_duration_max_env_steps_per_sample": 2000, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 1, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "offline_evaluation_interval": null, "num_offline_eval_runners": 0, "offline_loss_for_module_fn": null, "offline_evaluation_duration": 1, "offline_evaluation_parallel_to_training": false, "offline_evaluation_timeout_s": 120.0, "num_cpus_per_offline_eval_runner": 1, "num_gpus_per_offline_eval_runner": 0, "custom_resources_per_offline_eval_runner": {}, "restart_failed_offline_eval_runners": true, "ignore_offline_eval_runner_failures": false, "max_num_offline_eval_runner_restarts": 1000, "offline_eval_runner_restore_timeout_s": 1800.0, "max_requests_in_flight_per_offline_eval_runner": 1, "validate_offline_eval_runners_after_construction": true, "offline_eval_runner_health_probe_timeout_s": 30.0, "offline_eval_rl_module_inference_only": false, "broadcast_offline_eval_runner_states": false, "offline_eval_batch_size_per_runner": 256, "dataset_num_iters_per_eval_runner": 1, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "log_gradients": true, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 42, "restart_failed_env_runners": true, "ignore_env_runner_failures": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30.0, "env_runner_restore_timeout_s": 1800.0, "_model_config": {}, "_rl_module_spec": "RLModuleSpec(module_class=None, observation_space=None, action_space=None, inference_only=False, learner_only=False, model_config=DefaultModelConfig(fcnet_hiddens=[43, 122], fcnet_activation='tanh', fcnet_kernel_initializer=None, fcnet_kernel_initializer_kwargs=None, fcnet_bias_initializer=None, fcnet_bias_initializer_kwargs=None, conv_filters=None, conv_activation='relu', conv_kernel_initializer=None, conv_kernel_initializer_kwargs=None, conv_bias_initializer=None, conv_bias_initializer_kwargs=None, head_fcnet_hiddens=[], head_fcnet_activation='relu', head_fcnet_kernel_initializer=None, head_fcnet_kernel_initializer_kwargs=None, head_fcnet_bias_initializer=None, head_fcnet_bias_initializer_kwargs=None, free_log_std=False, log_std_clip_param=20.0, vf_share_layers=True, use_lstm=False, max_seq_len=20, lstm_cell_size=256, lstm_use_prev_action=False, lstm_use_prev_reward=False, lstm_kernel_initializer=None, lstm_kernel_initializer_kwargs=None, lstm_bias_initializer=None, lstm_bias_initializer_kwargs=None), catalog_class=None, load_state_path=None, model_config_dict=None)", "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "_validate_config": true, "_use_msgpack_checkpoints": false, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "env_task_fn": -1, "enable_connectors": -1, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2617985289524, "kl_target": 0.0294268671804, "vf_loss_coeff": 0.5611379931, "entropy_coeff": 0.0016790048723, "clip_param": 0.1271344785601, "vf_clip_param": 0.2507399863488, "entropy_coeff_schedule": null, "lr_schedule": null, "sgd_minibatch_size": -1, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9822919715622, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.callbacks.callbacks.RLlibCallback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 24.548006296157837, "iterations_since_restore": 5, "perf": {"cpu_util_percent": 12.828571428571431, "ram_util_percent": 87.89999999999999}}
{"timers": {"training_iteration": 4.2147367056180025, "restore_env_runners": 1.4499674003546e-05, "training_step": 4.214433458440869, "env_runner_sampling_timer": 3.8070374805704166, "learner_update_timer": 0.40390671384867766, "synch_weights": 0.0014336173969759477, "restore_eval_env_runners": 1.654390468320572e-05, "evaluation_iteration": 0.7429942918086332, "synch_eval_env_connectors": 0.0004070561001478371, "synch_env_connectors": 7.771248782858959e-06}, "env_runners": {"num_episodes": 100.0, "sample": 0.0375325004614634, "module_to_env_connector": {"timers": {"connectors": {"un_batch_to_individual_items": 1.4663096785420632e-05, "listify_data_for_vector_env": 3.110037355667937e-05, "get_actions": 0.0001655621842925265, "normalize_and_clip_actions": 2.2378192165373435e-05, "tensor_to_numpy": 4.829720568532555e-05, "remove_single_ts_time_rank_from_batch": 1.453882430987017e-06}}, "connector_pipeline_timer": 0.0003601013097899056}, "agent_episode_returns_mean": {"default_agent": 6.700000000000004}, "num_module_steps_sampled_lifetime": {"default_policy": -960000.0}, "env_to_module_connector": {"timers": {"connectors": {"batch_individual_items": 1.8338430435010666e-05, "add_observations_from_episodes_to_batch": 6.536339901646338e-06, "add_states_from_episodes_to_batch": 3.419789885107089e-06, "numpy_to_tensor": 3.12060985302994e-05, "add_time_dim_to_batch_and_zero_pad": 6.548353461400786e-06}}, "connector_pipeline_timer": 0.00011867382706582798}, "num_episodes_lifetime": -19200.0, "time_between_sampling": 0.011490641927177785, "module_episode_returns_mean": {"default_policy": 6.700000000000004}, "env_to_module_sum_episodes_length_in": 27.16809333212661, "episode_return_min": -5.5, "episode_return_max": 14.5, "num_env_steps_sampled_lifetime": -960000.0, "rlmodule_inference_timer": 0.00010039390596130278, "episode_duration_sec_mean": 0.03648689069998909, "num_agent_steps_sampled": {"default_agent": 5000.0}, "num_agent_steps_sampled_lifetime": {"default_agent": -960000.0}, "env_reset_timer": 9.592798799839689e-05, "episode_return_mean": 6.700000000000004, "weights_seq_no": 5.0, "num_module_steps_sampled": {"default_policy": 5000.0}, "episode_len_min": 50, "env_step_timer": 4.3830791901336144e-05, "episode_len_max": 50, "num_env_steps_sampled": 5000.0, "env_to_module_sum_episodes_length_out": 27.16809333212661, "episode_len_mean": 50.0, "num_env_steps_sampled_lifetime_throughput": 1284.161535837283}, "learners": {"__all_modules__": {"learner_connector": {"timers": {"connectors": {"general_advantage_estimation": 0.013156901254235945, "add_columns_from_episodes_to_train_batch": 0.0690362916115052, "batch_individual_items": 0.1968917752760133, "add_observations_from_episodes_to_batch": 0.0007987919528426022, "numpy_to_tensor": 0.00016284770095535724, "add_states_from_episodes_to_batch": 6.184109216646039e-06, "add_time_dim_to_batch_and_zero_pad": 2.3674940796341975e-05, "add_one_ts_to_episodes_and_truncate": 0.008146254120656978}}, "connector_pipeline_timer": 0.28859698717183135}, "num_env_steps_trained_lifetime": 183600, "num_non_trainable_parameters": 0, "learner_connector_sum_episodes_length_in": 5000.0, "num_module_steps_trained": 6000, "num_trainable_parameters": 5909, "num_module_steps_trained_lifetime": 36000, "num_env_steps_trained": 30600, "learner_connector_sum_episodes_length_out": 5100.0, "num_env_steps_trained_lifetime_throughput": 846052.9123020717, "num_module_steps_trained_throughput": 166437.79175561375, "num_module_steps_trained_lifetime_throughput": 166324.43851907758}, "default_policy": {"total_loss": -0.041196875274181366, "diff_num_grad_updates_vs_sampler_policy": 1.0, "vf_loss": 0.24145260453224182, "mean_kl_loss": 0.0015615851152688265, "curr_entropy_coeff": 0.0016790048723, "gradients_default_optimizer_global_norm": 0.06570140272378922, "num_module_steps_trained": 6000, "weights_seq_no": 6.0, "entropy": 0.6490983366966248, "num_trainable_parameters": 5909, "module_train_batch_size_mean": 1000.0, "vf_loss_unclipped": 70.28053283691406, "num_module_steps_trained_lifetime": 36000, "vf_explained_var": 0.0943610668182373, "curr_kl_coeff": 0.004090602044016123, "policy_loss": -0.17560802400112152, "default_optimizer_learning_rate": 0.0008209260984, "num_module_steps_trained_lifetime_throughput": 166716.89565641005}}, "num_training_step_calls_per_iteration": 1, "evaluation": {"env_runners": {"module_episode_returns_mean": {"default_policy": -1.1}, "module_to_env_connector": {"timers": {"connectors": {"remove_single_ts_time_rank_from_batch": 1.4409571166368366e-06, "listify_data_for_vector_env": 3.0179387577272285e-05, "get_actions": 0.00015255892508446355, "un_batch_to_individual_items": 1.5022863185890505e-05, "normalize_and_clip_actions": 2.126861160377926e-05, "tensor_to_numpy": 4.461852315734882e-05}}, "connector_pipeline_timer": 0.0003424515448518936}, "agent_episode_returns_mean": {"default_agent": -1.1}, "num_env_steps_sampled": 1000, "num_module_steps_sampled": {"default_policy": 1000}, "num_episodes": 20, "env_to_module_connector": {"timers": {"connectors": {"add_observations_from_episodes_to_batch": 6.187621809883165e-06, "add_states_from_episodes_to_batch": 3.3903287250533917e-06, "numpy_to_tensor": 2.9055263245446206e-05, "add_time_dim_to_batch_and_zero_pad": 5.949351857946032e-06, "batch_individual_items": 1.793955821222544e-05}}, "connector_pipeline_timer": 0.00011705114195726565}, "num_module_steps_sampled_lifetime": {"default_policy": 6000}, "num_agent_steps_sampled_lifetime": {"default_agent": 6000}, "num_agent_steps_sampled": {"default_agent": 1000}, "rlmodule_inference_timer": 9.320827044162353e-05, "num_env_steps_sampled_lifetime": 31000, "env_reset_timer": 0.00020851180406651187, "episode_return_mean": -1.1, "weights_seq_no": 6.0, "env_step_timer": 4.08673808969648e-05, "episode_len_max": 50, "episode_len_mean": 50.0, "sample": 0.7309302573416642, "num_episodes_lifetime": 120, "episode_return_min": -16.5, "episode_return_max": 17.5, "episode_duration_sec_mean": 0.03496720424004707, "episode_len_min": 50, "env_to_module_sum_episodes_length_out": 27.168093332126602, "env_to_module_sum_episodes_length_in": 27.168093332126602, "time_between_sampling": 4.162573949467306}, "num_healthy_workers": 1, "actor_manager_num_outstanding_async_reqs": 0, "num_remote_worker_restarts": 0}, "num_env_steps_sampled_lifetime": -960000.0, "fault_tolerance": {"num_healthy_workers": 0, "num_remote_worker_restarts": 0}, "env_runner_group": {"actor_manager_num_outstanding_async_reqs": 0}, "done": false, "training_iteration": 6, "trial_id": "a54d5_00000", "date": "2025-08-11_17-23-07", "timestamp": 1754925787, "time_this_iter_s": 4.965261697769165, "time_total_s": 29.513267993927002, "pid": 73571, "hostname": "DESKTOP-3SK5A41", "node_ip": "192.168.40.242", "config": {"exploration_config": {}, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 6, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "env": "Umbrella", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": false, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 0, "create_local_env_runner": true, "num_envs_per_env_runner": 1, "gym_env_vectorize_mode": "SYNC", "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "episodes_to_numpy": true, "max_requests_in_flight_per_env_runner": 1, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "merge_env_runner_states": "training_only", "broadcast_env_runner_states": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "complete_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "sampler_perf_stats_ema_coef": null, "_is_online": true, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": "auto", "num_aggregator_actors_per_learner": 0, "max_requests_in_flight_per_aggregator_actor": 3, "local_gpu_idx": 0, "max_requests_in_flight_per_learner": 3, "gamma": 1, "lr": 0.0008209260984, "grad_clip": 0.5, "grad_clip_by": "global_norm", "_train_batch_size_per_learner": 5000, "train_batch_size": 4000, "num_epochs": 1, "minibatch_size": 1000, "shuffle_batch_per_epoch": true, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "log_std_clip_param": 20.0, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "_disable_preprocessor_api": false, "_disable_action_flattening": false}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "_learner_class": null, "callbacks_on_algorithm_init": null, "callbacks_on_env_runners_recreated": null, "callbacks_on_offline_eval_runners_recreated": null, "callbacks_on_checkpoint_loaded": null, "callbacks_on_environment_created": null, "callbacks_on_episode_created": null, "callbacks_on_episode_start": null, "callbacks_on_episode_step": null, "callbacks_on_episode_end": null, "callbacks_on_evaluate_start": null, "callbacks_on_evaluate_end": null, "callbacks_on_evaluate_offline_start": null, "callbacks_on_evaluate_offline_end": null, "callbacks_on_sample_end": null, "callbacks_on_train_result": null, "explore": true, "enable_rl_module_and_learner": true, "enable_env_runner_and_connector_v2": true, "_prior_exploration_config": {"type": "StochasticSampling"}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x70470debeac0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "offline_data_class": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_read_batch_size": null, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "materialize_data": false, "materialize_mapped_data": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "ignore_final_observation": false, "prelearner_class": null, "prelearner_buffer_class": null, "prelearner_buffer_kwargs": {}, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_remaining_data": false, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": 1, "evaluation_duration": 20, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_auto_duration_min_env_steps_per_sample": 100, "evaluation_auto_duration_max_env_steps_per_sample": 2000, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 1, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "offline_evaluation_interval": null, "num_offline_eval_runners": 0, "offline_loss_for_module_fn": null, "offline_evaluation_duration": 1, "offline_evaluation_parallel_to_training": false, "offline_evaluation_timeout_s": 120.0, "num_cpus_per_offline_eval_runner": 1, "num_gpus_per_offline_eval_runner": 0, "custom_resources_per_offline_eval_runner": {}, "restart_failed_offline_eval_runners": true, "ignore_offline_eval_runner_failures": false, "max_num_offline_eval_runner_restarts": 1000, "offline_eval_runner_restore_timeout_s": 1800.0, "max_requests_in_flight_per_offline_eval_runner": 1, "validate_offline_eval_runners_after_construction": true, "offline_eval_runner_health_probe_timeout_s": 30.0, "offline_eval_rl_module_inference_only": false, "broadcast_offline_eval_runner_states": false, "offline_eval_batch_size_per_runner": 256, "dataset_num_iters_per_eval_runner": 1, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "log_gradients": true, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 42, "restart_failed_env_runners": true, "ignore_env_runner_failures": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30.0, "env_runner_restore_timeout_s": 1800.0, "_model_config": {}, "_rl_module_spec": "RLModuleSpec(module_class=None, observation_space=None, action_space=None, inference_only=False, learner_only=False, model_config=DefaultModelConfig(fcnet_hiddens=[43, 122], fcnet_activation='tanh', fcnet_kernel_initializer=None, fcnet_kernel_initializer_kwargs=None, fcnet_bias_initializer=None, fcnet_bias_initializer_kwargs=None, conv_filters=None, conv_activation='relu', conv_kernel_initializer=None, conv_kernel_initializer_kwargs=None, conv_bias_initializer=None, conv_bias_initializer_kwargs=None, head_fcnet_hiddens=[], head_fcnet_activation='relu', head_fcnet_kernel_initializer=None, head_fcnet_kernel_initializer_kwargs=None, head_fcnet_bias_initializer=None, head_fcnet_bias_initializer_kwargs=None, free_log_std=False, log_std_clip_param=20.0, vf_share_layers=True, use_lstm=False, max_seq_len=20, lstm_cell_size=256, lstm_use_prev_action=False, lstm_use_prev_reward=False, lstm_kernel_initializer=None, lstm_kernel_initializer_kwargs=None, lstm_bias_initializer=None, lstm_bias_initializer_kwargs=None), catalog_class=None, load_state_path=None, model_config_dict=None)", "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "_validate_config": true, "_use_msgpack_checkpoints": false, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "env_task_fn": -1, "enable_connectors": -1, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2617985289524, "kl_target": 0.0294268671804, "vf_loss_coeff": 0.5611379931, "entropy_coeff": 0.0016790048723, "clip_param": 0.1271344785601, "vf_clip_param": 0.2507399863488, "entropy_coeff_schedule": null, "lr_schedule": null, "sgd_minibatch_size": -1, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9822919715622, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.callbacks.callbacks.RLlibCallback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 29.513267993927002, "iterations_since_restore": 6, "perf": {"cpu_util_percent": 12.428571428571429, "ram_util_percent": 87.91428571428571}}
{"timers": {"training_iteration": 4.213317375391828, "restore_env_runners": 1.4467677259928324e-05, "training_step": 4.21301280268646, "env_runner_sampling_timer": 3.8078145275947177, "learner_update_timer": 0.4017078797101935, "synch_weights": 0.0014329522230031636, "restore_eval_env_runners": 1.6474465639769264e-05, "evaluation_iteration": 0.7429023327705443, "synch_eval_env_connectors": 0.0004066525391472186, "synch_env_connectors": 7.760536295884392e-06}, "env_runners": {"num_episodes": 100.0, "sample": 0.037493261451692905, "module_to_env_connector": {"timers": {"connectors": {"un_batch_to_individual_items": 1.459943209050708e-05, "listify_data_for_vector_env": 3.098487565167617e-05, "get_actions": 0.00016436073639531095, "normalize_and_clip_actions": 2.2151222899909463e-05, "tensor_to_numpy": 4.8200853036253037e-05, "remove_single_ts_time_rank_from_batch": 1.417381926743073e-06}}, "connector_pipeline_timer": 0.00035789432929806005}, "agent_episode_returns_mean": {"default_agent": 8.299999999999997}, "num_module_steps_sampled_lifetime": {"default_policy": -1202500.0}, "env_to_module_connector": {"timers": {"connectors": {"batch_individual_items": 1.841267087048595e-05, "add_observations_from_episodes_to_batch": 6.481303796533924e-06, "add_states_from_episodes_to_batch": 3.474934974891768e-06, "numpy_to_tensor": 3.1110636837000274e-05, "add_time_dim_to_batch_and_zero_pad": 6.551482978744462e-06}}, "connector_pipeline_timer": 0.00011862031541038027}, "num_episodes_lifetime": -24050.0, "time_between_sampling": 0.012156653723389704, "module_episode_returns_mean": {"default_policy": 8.299999999999997}, "env_to_module_sum_episodes_length_in": 27.16809333212661, "episode_return_min": -5.5, "episode_return_max": 14.5, "num_env_steps_sampled_lifetime": -1202500.0, "rlmodule_inference_timer": 9.962755120884655e-05, "episode_duration_sec_mean": 0.0363024915700771, "num_agent_steps_sampled": {"default_agent": 5000.0}, "num_agent_steps_sampled_lifetime": {"default_agent": -1202500.0}, "env_reset_timer": 9.454360375664168e-05, "episode_return_mean": 8.299999999999997, "weights_seq_no": 6.0, "num_module_steps_sampled": {"default_policy": 5000.0}, "episode_len_min": 50, "env_step_timer": 4.37338477312558e-05, "episode_len_max": 50, "num_env_steps_sampled": 5000.0, "env_to_module_sum_episodes_length_out": 27.16809333212661, "episode_len_mean": 50.0, "num_env_steps_sampled_lifetime_throughput": 1285.2953854287066}, "learners": {"__all_modules__": {"learner_connector": {"timers": {"connectors": {"general_advantage_estimation": 0.013134104241696814, "add_columns_from_episodes_to_train_batch": 0.0690333336953889, "batch_individual_items": 0.1954939505232518, "add_observations_from_episodes_to_batch": 0.0007976910333137275, "numpy_to_tensor": 0.00016278122395254656, "add_states_from_episodes_to_batch": 6.172268123216473e-06, "add_time_dim_to_batch_and_zero_pad": 2.366719139496266e-05, "add_one_ts_to_episodes_and_truncate": 0.008146723579444093}}, "connector_pipeline_timer": 0.2871718953001111}, "num_env_steps_trained_lifetime": 214200, "num_non_trainable_parameters": 0, "learner_connector_sum_episodes_length_in": 5000.0, "num_module_steps_trained": 6000, "num_trainable_parameters": 5909, "num_module_steps_trained_lifetime": 42000, "num_env_steps_trained": 30600, "learner_connector_sum_episodes_length_out": 5100.0, "num_env_steps_trained_lifetime_throughput": 843637.600382704, "num_module_steps_trained_throughput": 165947.0973585013, "num_module_steps_trained_lifetime_throughput": 165834.2143522388}, "default_policy": {"total_loss": 0.11459330469369888, "diff_num_grad_updates_vs_sampler_policy": 1.0, "vf_loss": 0.24029326438903809, "mean_kl_loss": 0.0013858574675396085, "curr_entropy_coeff": 0.0016790048723, "gradients_default_optimizer_global_norm": 0.02020006999373436, "num_module_steps_trained": 6000, "weights_seq_no": 7.0, "entropy": 0.6296501755714417, "num_trainable_parameters": 5909, "module_train_batch_size_mean": 1000.0, "vf_loss_unclipped": 69.84104919433594, "num_module_steps_trained_lifetime": 42000, "vf_explained_var": 0.09564262628555298, "curr_kl_coeff": 0.0020453010220080614, "policy_loss": -0.019192850217223167, "default_optimizer_learning_rate": 0.0008209260984, "num_module_steps_trained_lifetime_throughput": 166204.94554099435}}, "num_training_step_calls_per_iteration": 1, "evaluation": {"env_runners": {"module_episode_returns_mean": {"default_policy": -0.9}, "module_to_env_connector": {"timers": {"connectors": {"remove_single_ts_time_rank_from_batch": 1.4043147552406682e-06, "listify_data_for_vector_env": 2.9527463795898714e-05, "get_actions": 0.00015125657915502556, "un_batch_to_individual_items": 1.531081484648985e-05, "normalize_and_clip_actions": 2.1974457706635075e-05, "tensor_to_numpy": 4.384385099548327e-05}}, "connector_pipeline_timer": 0.0003405303152238453}, "agent_episode_returns_mean": {"default_agent": -0.9}, "num_env_steps_sampled": 1000, "num_module_steps_sampled": {"default_policy": 1000}, "num_episodes": 20, "env_to_module_connector": {"timers": {"connectors": {"add_observations_from_episodes_to_batch": 6.047843142255236e-06, "add_states_from_episodes_to_batch": 3.4154870939244863e-06, "numpy_to_tensor": 2.8264165064184342e-05, "add_time_dim_to_batch_and_zero_pad": 5.818759202947223e-06, "batch_individual_items": 1.7919327777230453e-05}}, "connector_pipeline_timer": 0.0001152541170184686}, "num_module_steps_sampled_lifetime": {"default_policy": 7000}, "num_agent_steps_sampled_lifetime": {"default_agent": 7000}, "num_agent_steps_sampled": {"default_agent": 1000}, "rlmodule_inference_timer": 9.279446096015552e-05, "num_env_steps_sampled_lifetime": 36000, "env_reset_timer": 0.00020765168603128044, "episode_return_mean": -0.9, "weights_seq_no": 7.0, "env_step_timer": 4.055684772887867e-05, "episode_len_max": 50, "episode_len_mean": 50.0, "sample": 0.7308840167782447, "num_episodes_lifetime": 140, "episode_return_min": -16.5, "episode_return_max": 17.5, "episode_duration_sec_mean": 0.03494960223996713, "episode_len_min": 50, "env_to_module_sum_episodes_length_out": 27.168093332126602, "env_to_module_sum_episodes_length_in": 27.168093332126602, "time_between_sampling": 4.162271468862639}, "num_healthy_workers": 1, "actor_manager_num_outstanding_async_reqs": 0, "num_remote_worker_restarts": 0}, "num_env_steps_sampled_lifetime": -1202500.0, "fault_tolerance": {"num_healthy_workers": 0, "num_remote_worker_restarts": 0}, "env_runner_group": {"actor_manager_num_outstanding_async_reqs": 0}, "done": false, "training_iteration": 7, "trial_id": "a54d5_00000", "date": "2025-08-11_17-23-12", "timestamp": 1754925792, "time_this_iter_s": 4.813784599304199, "time_total_s": 34.3270525932312, "pid": 73571, "hostname": "DESKTOP-3SK5A41", "node_ip": "192.168.40.242", "config": {"exploration_config": {}, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 6, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "env": "Umbrella", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": false, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 0, "create_local_env_runner": true, "num_envs_per_env_runner": 1, "gym_env_vectorize_mode": "SYNC", "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "episodes_to_numpy": true, "max_requests_in_flight_per_env_runner": 1, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "merge_env_runner_states": "training_only", "broadcast_env_runner_states": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "complete_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "sampler_perf_stats_ema_coef": null, "_is_online": true, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": "auto", "num_aggregator_actors_per_learner": 0, "max_requests_in_flight_per_aggregator_actor": 3, "local_gpu_idx": 0, "max_requests_in_flight_per_learner": 3, "gamma": 1, "lr": 0.0008209260984, "grad_clip": 0.5, "grad_clip_by": "global_norm", "_train_batch_size_per_learner": 5000, "train_batch_size": 4000, "num_epochs": 1, "minibatch_size": 1000, "shuffle_batch_per_epoch": true, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "log_std_clip_param": 20.0, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "_disable_preprocessor_api": false, "_disable_action_flattening": false}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "_learner_class": null, "callbacks_on_algorithm_init": null, "callbacks_on_env_runners_recreated": null, "callbacks_on_offline_eval_runners_recreated": null, "callbacks_on_checkpoint_loaded": null, "callbacks_on_environment_created": null, "callbacks_on_episode_created": null, "callbacks_on_episode_start": null, "callbacks_on_episode_step": null, "callbacks_on_episode_end": null, "callbacks_on_evaluate_start": null, "callbacks_on_evaluate_end": null, "callbacks_on_evaluate_offline_start": null, "callbacks_on_evaluate_offline_end": null, "callbacks_on_sample_end": null, "callbacks_on_train_result": null, "explore": true, "enable_rl_module_and_learner": true, "enable_env_runner_and_connector_v2": true, "_prior_exploration_config": {"type": "StochasticSampling"}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x70470debeac0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "offline_data_class": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_read_batch_size": null, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "materialize_data": false, "materialize_mapped_data": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "ignore_final_observation": false, "prelearner_class": null, "prelearner_buffer_class": null, "prelearner_buffer_kwargs": {}, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_remaining_data": false, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": 1, "evaluation_duration": 20, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_auto_duration_min_env_steps_per_sample": 100, "evaluation_auto_duration_max_env_steps_per_sample": 2000, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 1, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "offline_evaluation_interval": null, "num_offline_eval_runners": 0, "offline_loss_for_module_fn": null, "offline_evaluation_duration": 1, "offline_evaluation_parallel_to_training": false, "offline_evaluation_timeout_s": 120.0, "num_cpus_per_offline_eval_runner": 1, "num_gpus_per_offline_eval_runner": 0, "custom_resources_per_offline_eval_runner": {}, "restart_failed_offline_eval_runners": true, "ignore_offline_eval_runner_failures": false, "max_num_offline_eval_runner_restarts": 1000, "offline_eval_runner_restore_timeout_s": 1800.0, "max_requests_in_flight_per_offline_eval_runner": 1, "validate_offline_eval_runners_after_construction": true, "offline_eval_runner_health_probe_timeout_s": 30.0, "offline_eval_rl_module_inference_only": false, "broadcast_offline_eval_runner_states": false, "offline_eval_batch_size_per_runner": 256, "dataset_num_iters_per_eval_runner": 1, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "log_gradients": true, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 42, "restart_failed_env_runners": true, "ignore_env_runner_failures": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30.0, "env_runner_restore_timeout_s": 1800.0, "_model_config": {}, "_rl_module_spec": "RLModuleSpec(module_class=None, observation_space=None, action_space=None, inference_only=False, learner_only=False, model_config=DefaultModelConfig(fcnet_hiddens=[43, 122], fcnet_activation='tanh', fcnet_kernel_initializer=None, fcnet_kernel_initializer_kwargs=None, fcnet_bias_initializer=None, fcnet_bias_initializer_kwargs=None, conv_filters=None, conv_activation='relu', conv_kernel_initializer=None, conv_kernel_initializer_kwargs=None, conv_bias_initializer=None, conv_bias_initializer_kwargs=None, head_fcnet_hiddens=[], head_fcnet_activation='relu', head_fcnet_kernel_initializer=None, head_fcnet_kernel_initializer_kwargs=None, head_fcnet_bias_initializer=None, head_fcnet_bias_initializer_kwargs=None, free_log_std=False, log_std_clip_param=20.0, vf_share_layers=True, use_lstm=False, max_seq_len=20, lstm_cell_size=256, lstm_use_prev_action=False, lstm_use_prev_reward=False, lstm_kernel_initializer=None, lstm_kernel_initializer_kwargs=None, lstm_bias_initializer=None, lstm_bias_initializer_kwargs=None), catalog_class=None, load_state_path=None, model_config_dict=None)", "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "_validate_config": true, "_use_msgpack_checkpoints": false, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "env_task_fn": -1, "enable_connectors": -1, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2617985289524, "kl_target": 0.0294268671804, "vf_loss_coeff": 0.5611379931, "entropy_coeff": 0.0016790048723, "clip_param": 0.1271344785601, "vf_clip_param": 0.2507399863488, "entropy_coeff_schedule": null, "lr_schedule": null, "sgd_minibatch_size": -1, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9822919715622, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.callbacks.callbacks.RLlibCallback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 34.3270525932312, "iterations_since_restore": 7, "perf": {"cpu_util_percent": 12.957142857142857, "ram_util_percent": 87.91428571428571}}
{"timers": {"training_iteration": 4.21372807579791, "restore_env_runners": 1.4430000492629547e-05, "training_step": 4.213422997819596, "env_runner_sampling_timer": 3.8089532744687684, "learner_update_timer": 0.40097820792309397, "synch_weights": 0.0014326567007693046, "restore_eval_env_runners": 1.64117209869794e-05, "evaluation_iteration": 0.7428341384528335, "synch_eval_env_connectors": 0.00040657501376193235, "synch_env_connectors": 7.752930938433158e-06}, "env_runners": {"num_episodes": 100.0, "sample": 0.03754349978224551, "module_to_env_connector": {"timers": {"connectors": {"un_batch_to_individual_items": 1.4755380970252155e-05, "listify_data_for_vector_env": 3.1332476196646064e-05, "get_actions": 0.00016603940824584082, "normalize_and_clip_actions": 2.2362424668795907e-05, "tensor_to_numpy": 4.85945669375864e-05, "remove_single_ts_time_rank_from_batch": 1.435347589471684e-06}}, "connector_pipeline_timer": 0.00036150204390597937}, "agent_episode_returns_mean": {"default_agent": 9.299999999999997}, "num_module_steps_sampled_lifetime": {"default_policy": -1445000.0}, "env_to_module_connector": {"timers": {"connectors": {"batch_individual_items": 1.8475469712586346e-05, "add_observations_from_episodes_to_batch": 6.567990273986988e-06, "add_states_from_episodes_to_batch": 3.4898085709858544e-06, "numpy_to_tensor": 3.131493990864024e-05, "add_time_dim_to_batch_and_zero_pad": 6.596719714171392e-06}}, "connector_pipeline_timer": 0.00011914967196127003}, "num_episodes_lifetime": -28900.0, "time_between_sampling": 0.011526145940739821, "module_episode_returns_mean": {"default_policy": 9.299999999999997}, "env_to_module_sum_episodes_length_in": 27.16809333212661, "episode_return_min": -5.5, "episode_return_max": 14.5, "num_env_steps_sampled_lifetime": -1445000.0, "rlmodule_inference_timer": 0.00010109202143346596, "episode_duration_sec_mean": 0.036667899150015726, "num_agent_steps_sampled": {"default_agent": 5000.0}, "num_agent_steps_sampled_lifetime": {"default_agent": -1445000.0}, "env_reset_timer": 9.473821356991884e-05, "episode_return_mean": 9.299999999999997, "weights_seq_no": 7.0, "num_module_steps_sampled": {"default_policy": 5000.0}, "episode_len_min": 50, "env_step_timer": 4.4258061128830874e-05, "episode_len_max": 50, "num_env_steps_sampled": 5000.0, "env_to_module_sum_episodes_length_out": 27.16809333212661, "episode_len_mean": 50.0, "num_env_steps_sampled_lifetime_throughput": 1278.649342007528}, "learners": {"__all_modules__": {"learner_connector": {"timers": {"connectors": {"general_advantage_estimation": 0.013100680199282627, "add_columns_from_episodes_to_train_batch": 0.06902927035844063, "batch_individual_items": 0.1955739930280193, "add_observations_from_episodes_to_batch": 0.0007967091229839617, "numpy_to_tensor": 0.00016276941171257904, "add_states_from_episodes_to_batch": 6.161545448335694e-06, "add_time_dim_to_batch_and_zero_pad": 2.3647519478077737e-05, "add_one_ts_to_episodes_and_truncate": 0.008146560343645377}}, "connector_pipeline_timer": 0.28721241535711195}, "num_env_steps_trained_lifetime": 244800, "num_non_trainable_parameters": 0, "learner_connector_sum_episodes_length_in": 5000.0, "num_module_steps_trained": 6000, "num_trainable_parameters": 5909, "num_module_steps_trained_lifetime": 48000, "num_env_steps_trained": 30600, "learner_connector_sum_episodes_length_out": 5100.0, "num_env_steps_trained_lifetime_throughput": 840965.4938136728, "num_module_steps_trained_throughput": 165407.63452851592, "num_module_steps_trained_lifetime_throughput": 165295.62386554363}, "default_policy": {"total_loss": 0.17086774110794067, "diff_num_grad_updates_vs_sampler_policy": 1.0, "vf_loss": 0.24021324515342712, "mean_kl_loss": 0.002501847455278039, "curr_entropy_coeff": 0.0016790048723, "gradients_default_optimizer_global_norm": 0.33326977491378784, "num_module_steps_trained": 6000, "weights_seq_no": 8.0, "entropy": 0.6002963185310364, "num_trainable_parameters": 5909, "module_train_batch_size_mean": 1000.0, "vf_loss_unclipped": 71.1212387084961, "num_module_steps_trained_lifetime": 48000, "vf_explained_var": 0.09773802757263184, "curr_kl_coeff": 0.0010226505110040307, "policy_loss": 0.03707776963710785, "default_optimizer_learning_rate": 0.0008209260984, "num_module_steps_trained_lifetime_throughput": 165644.15089414254}}, "num_training_step_calls_per_iteration": 1, "evaluation": {"env_runners": {"module_episode_returns_mean": {"default_policy": -1.5}, "module_to_env_connector": {"timers": {"connectors": {"remove_single_ts_time_rank_from_batch": 1.3736975295167105e-06, "listify_data_for_vector_env": 2.988973728675939e-05, "get_actions": 0.0001511231863711021, "un_batch_to_individual_items": 1.4969848373513195e-05, "normalize_and_clip_actions": 2.095256659022262e-05, "tensor_to_numpy": 4.41157128918139e-05}}, "connector_pipeline_timer": 0.0003383353961727637}, "agent_episode_returns_mean": {"default_agent": -1.5}, "num_env_steps_sampled": 1000, "num_module_steps_sampled": {"default_policy": 1000}, "num_episodes": 20, "env_to_module_connector": {"timers": {"connectors": {"add_observations_from_episodes_to_batch": 6.147992073224517e-06, "add_states_from_episodes_to_batch": 3.2926085836710516e-06, "numpy_to_tensor": 2.858031290914713e-05, "add_time_dim_to_batch_and_zero_pad": 6.115260513979007e-06, "batch_individual_items": 1.7714911640912777e-05}}, "connector_pipeline_timer": 0.00011487456414819723}, "num_module_steps_sampled_lifetime": {"default_policy": 8000}, "num_agent_steps_sampled_lifetime": {"default_agent": 8000}, "num_agent_steps_sampled": {"default_agent": 1000}, "rlmodule_inference_timer": 9.235691525718494e-05, "num_env_steps_sampled_lifetime": 41000, "env_reset_timer": 0.00020681316917534534, "episode_return_mean": -1.5, "weights_seq_no": 8.0, "env_step_timer": 4.0587370214458735e-05, "episode_len_max": 50, "episode_len_mean": 50.0, "sample": 0.7307989606404645, "num_episodes_lifetime": 160, "episode_return_min": -16.5, "episode_return_max": 17.5, "episode_duration_sec_mean": 0.03486025206993872, "episode_len_min": 50, "env_to_module_sum_episodes_length_out": 27.168093332126602, "env_to_module_sum_episodes_length_in": 27.168093332126602, "time_between_sampling": 4.1637434073340085}, "num_healthy_workers": 1, "actor_manager_num_outstanding_async_reqs": 0, "num_remote_worker_restarts": 0}, "num_env_steps_sampled_lifetime": -1445000.0, "fault_tolerance": {"num_healthy_workers": 0, "num_remote_worker_restarts": 0}, "env_runner_group": {"actor_manager_num_outstanding_async_reqs": 0}, "done": false, "training_iteration": 8, "trial_id": "a54d5_00000", "date": "2025-08-11_17-23-17", "timestamp": 1754925797, "time_this_iter_s": 4.991543292999268, "time_total_s": 39.31859588623047, "pid": 73571, "hostname": "DESKTOP-3SK5A41", "node_ip": "192.168.40.242", "config": {"exploration_config": {}, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 6, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "env": "Umbrella", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": false, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 0, "create_local_env_runner": true, "num_envs_per_env_runner": 1, "gym_env_vectorize_mode": "SYNC", "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "episodes_to_numpy": true, "max_requests_in_flight_per_env_runner": 1, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "merge_env_runner_states": "training_only", "broadcast_env_runner_states": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "complete_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "sampler_perf_stats_ema_coef": null, "_is_online": true, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": "auto", "num_aggregator_actors_per_learner": 0, "max_requests_in_flight_per_aggregator_actor": 3, "local_gpu_idx": 0, "max_requests_in_flight_per_learner": 3, "gamma": 1, "lr": 0.0008209260984, "grad_clip": 0.5, "grad_clip_by": "global_norm", "_train_batch_size_per_learner": 5000, "train_batch_size": 4000, "num_epochs": 1, "minibatch_size": 1000, "shuffle_batch_per_epoch": true, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "log_std_clip_param": 20.0, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "_disable_preprocessor_api": false, "_disable_action_flattening": false}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "_learner_class": null, "callbacks_on_algorithm_init": null, "callbacks_on_env_runners_recreated": null, "callbacks_on_offline_eval_runners_recreated": null, "callbacks_on_checkpoint_loaded": null, "callbacks_on_environment_created": null, "callbacks_on_episode_created": null, "callbacks_on_episode_start": null, "callbacks_on_episode_step": null, "callbacks_on_episode_end": null, "callbacks_on_evaluate_start": null, "callbacks_on_evaluate_end": null, "callbacks_on_evaluate_offline_start": null, "callbacks_on_evaluate_offline_end": null, "callbacks_on_sample_end": null, "callbacks_on_train_result": null, "explore": true, "enable_rl_module_and_learner": true, "enable_env_runner_and_connector_v2": true, "_prior_exploration_config": {"type": "StochasticSampling"}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x70470debeac0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "offline_data_class": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_read_batch_size": null, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "materialize_data": false, "materialize_mapped_data": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "ignore_final_observation": false, "prelearner_class": null, "prelearner_buffer_class": null, "prelearner_buffer_kwargs": {}, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_remaining_data": false, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": 1, "evaluation_duration": 20, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_auto_duration_min_env_steps_per_sample": 100, "evaluation_auto_duration_max_env_steps_per_sample": 2000, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 1, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "offline_evaluation_interval": null, "num_offline_eval_runners": 0, "offline_loss_for_module_fn": null, "offline_evaluation_duration": 1, "offline_evaluation_parallel_to_training": false, "offline_evaluation_timeout_s": 120.0, "num_cpus_per_offline_eval_runner": 1, "num_gpus_per_offline_eval_runner": 0, "custom_resources_per_offline_eval_runner": {}, "restart_failed_offline_eval_runners": true, "ignore_offline_eval_runner_failures": false, "max_num_offline_eval_runner_restarts": 1000, "offline_eval_runner_restore_timeout_s": 1800.0, "max_requests_in_flight_per_offline_eval_runner": 1, "validate_offline_eval_runners_after_construction": true, "offline_eval_runner_health_probe_timeout_s": 30.0, "offline_eval_rl_module_inference_only": false, "broadcast_offline_eval_runner_states": false, "offline_eval_batch_size_per_runner": 256, "dataset_num_iters_per_eval_runner": 1, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "log_gradients": true, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 42, "restart_failed_env_runners": true, "ignore_env_runner_failures": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30.0, "env_runner_restore_timeout_s": 1800.0, "_model_config": {}, "_rl_module_spec": "RLModuleSpec(module_class=None, observation_space=None, action_space=None, inference_only=False, learner_only=False, model_config=DefaultModelConfig(fcnet_hiddens=[43, 122], fcnet_activation='tanh', fcnet_kernel_initializer=None, fcnet_kernel_initializer_kwargs=None, fcnet_bias_initializer=None, fcnet_bias_initializer_kwargs=None, conv_filters=None, conv_activation='relu', conv_kernel_initializer=None, conv_kernel_initializer_kwargs=None, conv_bias_initializer=None, conv_bias_initializer_kwargs=None, head_fcnet_hiddens=[], head_fcnet_activation='relu', head_fcnet_kernel_initializer=None, head_fcnet_kernel_initializer_kwargs=None, head_fcnet_bias_initializer=None, head_fcnet_bias_initializer_kwargs=None, free_log_std=False, log_std_clip_param=20.0, vf_share_layers=True, use_lstm=False, max_seq_len=20, lstm_cell_size=256, lstm_use_prev_action=False, lstm_use_prev_reward=False, lstm_kernel_initializer=None, lstm_kernel_initializer_kwargs=None, lstm_bias_initializer=None, lstm_bias_initializer_kwargs=None), catalog_class=None, load_state_path=None, model_config_dict=None)", "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "_validate_config": true, "_use_msgpack_checkpoints": false, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "env_task_fn": -1, "enable_connectors": -1, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2617985289524, "kl_target": 0.0294268671804, "vf_loss_coeff": 0.5611379931, "entropy_coeff": 0.0016790048723, "clip_param": 0.1271344785601, "vf_clip_param": 0.2507399863488, "entropy_coeff_schedule": null, "lr_schedule": null, "sgd_minibatch_size": -1, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9822919715622, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.callbacks.callbacks.RLlibCallback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 39.31859588623047, "iterations_since_restore": 8, "perf": {"cpu_util_percent": 12.685714285714287, "ram_util_percent": 88.0}}
{"timers": {"training_iteration": 4.212237384219927, "restore_env_runners": 1.4393700491523303e-05, "training_step": 4.2119313550214, "env_runner_sampling_timer": 3.809638473894076, "learner_update_timer": 0.39880075685386346, "synch_weights": 0.0014313441337671805, "restore_eval_env_runners": 1.6358603776488297e-05, "evaluation_iteration": 0.742727438098299, "synch_eval_env_connectors": 0.00040614026362389955, "synch_env_connectors": 7.740401632863756e-06}, "env_runners": {"num_episodes": 100.0, "sample": 0.03749396210229958, "module_to_env_connector": {"timers": {"connectors": {"un_batch_to_individual_items": 1.4565372152628737e-05, "listify_data_for_vector_env": 3.098152306930087e-05, "get_actions": 0.00016475282357979813, "normalize_and_clip_actions": 2.2184113752576894e-05, "tensor_to_numpy": 4.788758227473661e-05, "remove_single_ts_time_rank_from_batch": 1.4317570237951232e-06}}, "connector_pipeline_timer": 0.00035792619063039174}, "agent_episode_returns_mean": {"default_agent": 10.900000000000007}, "num_module_steps_sampled_lifetime": {"default_policy": -1687500.0}, "env_to_module_connector": {"timers": {"connectors": {"batch_individual_items": 1.8309873385407623e-05, "add_observations_from_episodes_to_batch": 6.532665133646789e-06, "add_states_from_episodes_to_batch": 3.4090002286599067e-06, "numpy_to_tensor": 3.10579932452046e-05, "add_time_dim_to_batch_and_zero_pad": 6.5258453758567105e-06}}, "connector_pipeline_timer": 0.00011817525298558116}, "num_episodes_lifetime": -33750.0, "time_between_sampling": 0.012175391927820807, "module_episode_returns_mean": {"default_policy": 10.900000000000007}, "env_to_module_sum_episodes_length_in": 27.16809333212661, "episode_return_min": -5.5, "episode_return_max": 14.5, "num_env_steps_sampled_lifetime": -1687500.0, "rlmodule_inference_timer": 9.890517172213314e-05, "episode_duration_sec_mean": 0.03622039016001509, "num_agent_steps_sampled": {"default_agent": 5000.0}, "num_agent_steps_sampled_lifetime": {"default_agent": -1687500.0}, "env_reset_timer": 9.460836935416024e-05, "episode_return_mean": 10.900000000000007, "weights_seq_no": 8.0, "num_module_steps_sampled": {"default_policy": 5000.0}, "episode_len_min": 50, "env_step_timer": 4.372833771971859e-05, "episode_len_max": 50, "num_env_steps_sampled": 5000.0, "env_to_module_sum_episodes_length_out": 27.16809333212661, "episode_len_mean": 50.0, "num_env_steps_sampled_lifetime_throughput": 1287.2800137697761}, "learners": {"__all_modules__": {"learner_connector": {"timers": {"connectors": {"general_advantage_estimation": 0.013071981397294798, "add_columns_from_episodes_to_train_batch": 0.06902683966485589, "batch_individual_items": 0.19418942009773735, "add_observations_from_episodes_to_batch": 0.0007956260317581147, "numpy_to_tensor": 0.00016293771759228303, "add_states_from_episodes_to_batch": 6.148929994069685e-06, "add_time_dim_to_batch_and_zero_pad": 2.3610044279724987e-05, "add_one_ts_to_episodes_and_truncate": 0.00814707574021192}}, "connector_pipeline_timer": 0.2857946832135413}, "num_env_steps_trained_lifetime": 275400, "num_non_trainable_parameters": 0, "learner_connector_sum_episodes_length_in": 5000.0, "num_module_steps_trained": 6000, "num_trainable_parameters": 5909, "num_module_steps_trained_lifetime": 54000, "num_env_steps_trained": 30600, "learner_connector_sum_episodes_length_out": 5100.0, "num_env_steps_trained_lifetime_throughput": 838024.818371619, "num_module_steps_trained_throughput": 164816.44812538667, "num_module_steps_trained_lifetime_throughput": 164704.70568602622}, "default_policy": {"total_loss": 0.12008357048034668, "diff_num_grad_updates_vs_sampler_policy": 1.0, "vf_loss": 0.24372819066047668, "mean_kl_loss": 0.00014500260294880718, "curr_entropy_coeff": 0.0016790048723, "gradients_default_optimizer_global_norm": 0.022700540721416473, "num_module_steps_trained": 6000, "weights_seq_no": 9.0, "entropy": 0.6041983366012573, "num_trainable_parameters": 5909, "module_train_batch_size_mean": 1000.0, "vf_loss_unclipped": 78.91405487060547, "num_module_steps_trained_lifetime": 54000, "vf_explained_var": 0.09923964738845825, "curr_kl_coeff": 0.0005113252555020154, "policy_loss": -0.015667254105210304, "default_optimizer_learning_rate": 0.0008209260984, "num_module_steps_trained_lifetime_throughput": 165031.01574929705}}, "num_training_step_calls_per_iteration": 1, "evaluation": {"env_runners": {"module_episode_returns_mean": {"default_policy": -1.1}, "module_to_env_connector": {"timers": {"connectors": {"remove_single_ts_time_rank_from_batch": 1.3711722103236707e-06, "listify_data_for_vector_env": 2.9488157854308075e-05, "get_actions": 0.0001520464988300436, "un_batch_to_individual_items": 1.5073033001416823e-05, "normalize_and_clip_actions": 2.125994690064879e-05, "tensor_to_numpy": 4.3816256303876115e-05}}, "connector_pipeline_timer": 0.0003382133027948377}, "agent_episode_returns_mean": {"default_agent": -1.1}, "num_env_steps_sampled": 1000, "num_module_steps_sampled": {"default_policy": 1000}, "num_episodes": 20, "env_to_module_connector": {"timers": {"connectors": {"add_observations_from_episodes_to_batch": 5.922158356901615e-06, "add_states_from_episodes_to_batch": 3.2865482123042447e-06, "numpy_to_tensor": 2.8340946596968985e-05, "add_time_dim_to_batch_and_zero_pad": 6.013715712795561e-06, "batch_individual_items": 1.758730511045487e-05}}, "connector_pipeline_timer": 0.00011483156533443127}, "num_module_steps_sampled_lifetime": {"default_policy": 9000}, "num_agent_steps_sampled_lifetime": {"default_agent": 9000}, "num_agent_steps_sampled": {"default_agent": 1000}, "rlmodule_inference_timer": 9.133384579779446e-05, "num_env_steps_sampled_lifetime": 46000, "env_reset_timer": 0.00020596503748733288, "episode_return_mean": -1.1, "weights_seq_no": 9.0, "env_step_timer": 4.033502995865228e-05, "episode_len_max": 50, "episode_len_mean": 50.0, "sample": 0.7307076430740543, "num_episodes_lifetime": 180, "episode_return_min": -16.5, "episode_return_max": 17.5, "episode_duration_sec_mean": 0.034833636979965374, "episode_len_min": 50, "env_to_module_sum_episodes_length_out": 27.168093332126602, "env_to_module_sum_episodes_length_in": 27.168093332126602, "time_between_sampling": 4.16328824644067}, "num_healthy_workers": 1, "actor_manager_num_outstanding_async_reqs": 0, "num_remote_worker_restarts": 0}, "num_env_steps_sampled_lifetime": -1687500.0, "fault_tolerance": {"num_healthy_workers": 0, "num_remote_worker_restarts": 0}, "env_runner_group": {"actor_manager_num_outstanding_async_reqs": 0}, "done": false, "training_iteration": 9, "trial_id": "a54d5_00000", "date": "2025-08-11_17-23-22", "timestamp": 1754925802, "time_this_iter_s": 4.800790071487427, "time_total_s": 44.119385957717896, "pid": 73571, "hostname": "DESKTOP-3SK5A41", "node_ip": "192.168.40.242", "config": {"exploration_config": {}, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 6, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "env": "Umbrella", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": false, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 0, "create_local_env_runner": true, "num_envs_per_env_runner": 1, "gym_env_vectorize_mode": "SYNC", "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "episodes_to_numpy": true, "max_requests_in_flight_per_env_runner": 1, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "merge_env_runner_states": "training_only", "broadcast_env_runner_states": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "complete_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "sampler_perf_stats_ema_coef": null, "_is_online": true, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": "auto", "num_aggregator_actors_per_learner": 0, "max_requests_in_flight_per_aggregator_actor": 3, "local_gpu_idx": 0, "max_requests_in_flight_per_learner": 3, "gamma": 1, "lr": 0.0008209260984, "grad_clip": 0.5, "grad_clip_by": "global_norm", "_train_batch_size_per_learner": 5000, "train_batch_size": 4000, "num_epochs": 1, "minibatch_size": 1000, "shuffle_batch_per_epoch": true, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "log_std_clip_param": 20.0, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "_disable_preprocessor_api": false, "_disable_action_flattening": false}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "_learner_class": null, "callbacks_on_algorithm_init": null, "callbacks_on_env_runners_recreated": null, "callbacks_on_offline_eval_runners_recreated": null, "callbacks_on_checkpoint_loaded": null, "callbacks_on_environment_created": null, "callbacks_on_episode_created": null, "callbacks_on_episode_start": null, "callbacks_on_episode_step": null, "callbacks_on_episode_end": null, "callbacks_on_evaluate_start": null, "callbacks_on_evaluate_end": null, "callbacks_on_evaluate_offline_start": null, "callbacks_on_evaluate_offline_end": null, "callbacks_on_sample_end": null, "callbacks_on_train_result": null, "explore": true, "enable_rl_module_and_learner": true, "enable_env_runner_and_connector_v2": true, "_prior_exploration_config": {"type": "StochasticSampling"}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x70470debeac0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "offline_data_class": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_read_batch_size": null, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "materialize_data": false, "materialize_mapped_data": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "ignore_final_observation": false, "prelearner_class": null, "prelearner_buffer_class": null, "prelearner_buffer_kwargs": {}, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_remaining_data": false, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": 1, "evaluation_duration": 20, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_auto_duration_min_env_steps_per_sample": 100, "evaluation_auto_duration_max_env_steps_per_sample": 2000, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 1, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "offline_evaluation_interval": null, "num_offline_eval_runners": 0, "offline_loss_for_module_fn": null, "offline_evaluation_duration": 1, "offline_evaluation_parallel_to_training": false, "offline_evaluation_timeout_s": 120.0, "num_cpus_per_offline_eval_runner": 1, "num_gpus_per_offline_eval_runner": 0, "custom_resources_per_offline_eval_runner": {}, "restart_failed_offline_eval_runners": true, "ignore_offline_eval_runner_failures": false, "max_num_offline_eval_runner_restarts": 1000, "offline_eval_runner_restore_timeout_s": 1800.0, "max_requests_in_flight_per_offline_eval_runner": 1, "validate_offline_eval_runners_after_construction": true, "offline_eval_runner_health_probe_timeout_s": 30.0, "offline_eval_rl_module_inference_only": false, "broadcast_offline_eval_runner_states": false, "offline_eval_batch_size_per_runner": 256, "dataset_num_iters_per_eval_runner": 1, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "log_gradients": true, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 42, "restart_failed_env_runners": true, "ignore_env_runner_failures": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30.0, "env_runner_restore_timeout_s": 1800.0, "_model_config": {}, "_rl_module_spec": "RLModuleSpec(module_class=None, observation_space=None, action_space=None, inference_only=False, learner_only=False, model_config=DefaultModelConfig(fcnet_hiddens=[43, 122], fcnet_activation='tanh', fcnet_kernel_initializer=None, fcnet_kernel_initializer_kwargs=None, fcnet_bias_initializer=None, fcnet_bias_initializer_kwargs=None, conv_filters=None, conv_activation='relu', conv_kernel_initializer=None, conv_kernel_initializer_kwargs=None, conv_bias_initializer=None, conv_bias_initializer_kwargs=None, head_fcnet_hiddens=[], head_fcnet_activation='relu', head_fcnet_kernel_initializer=None, head_fcnet_kernel_initializer_kwargs=None, head_fcnet_bias_initializer=None, head_fcnet_bias_initializer_kwargs=None, free_log_std=False, log_std_clip_param=20.0, vf_share_layers=True, use_lstm=False, max_seq_len=20, lstm_cell_size=256, lstm_use_prev_action=False, lstm_use_prev_reward=False, lstm_kernel_initializer=None, lstm_kernel_initializer_kwargs=None, lstm_bias_initializer=None, lstm_bias_initializer_kwargs=None), catalog_class=None, load_state_path=None, model_config_dict=None)", "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "_validate_config": true, "_use_msgpack_checkpoints": false, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "env_task_fn": -1, "enable_connectors": -1, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2617985289524, "kl_target": 0.0294268671804, "vf_loss_coeff": 0.5611379931, "entropy_coeff": 0.0016790048723, "clip_param": 0.1271344785601, "vf_clip_param": 0.2507399863488, "entropy_coeff_schedule": null, "lr_schedule": null, "sgd_minibatch_size": -1, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9822919715622, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.callbacks.callbacks.RLlibCallback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 44.119385957717896, "iterations_since_restore": 9, "perf": {"cpu_util_percent": 12.728571428571428, "ram_util_percent": 88.0}}
{"timers": {"training_iteration": 4.21245499761773, "restore_env_runners": 1.4354763485774536e-05, "training_step": 4.212148290711183, "env_runner_sampling_timer": 3.8106671133751377, "learner_update_timer": 0.3979803073053293, "synch_weights": 0.0014324166924340911, "restore_eval_env_runners": 1.6298017740850786e-05, "evaluation_iteration": 0.7426111427573191, "synch_eval_env_connectors": 0.00040582686098683795, "synch_env_connectors": 7.731997614428233e-06}, "env_runners": {"num_episodes": 100.0, "sample": 0.03744711183211824, "module_to_env_connector": {"timers": {"connectors": {"un_batch_to_individual_items": 1.4717314916160545e-05, "listify_data_for_vector_env": 3.1235243858260694e-05, "get_actions": 0.00016596063887821654, "normalize_and_clip_actions": 2.2373105112862435e-05, "tensor_to_numpy": 4.8544538725135094e-05, "remove_single_ts_time_rank_from_batch": 1.428912546738182e-06}}, "connector_pipeline_timer": 0.0003612869562974889}, "agent_episode_returns_mean": {"default_agent": 11.099999999999993}, "num_module_steps_sampled_lifetime": {"default_policy": -1930000.0}, "env_to_module_connector": {"timers": {"connectors": {"batch_individual_items": 1.839788769969867e-05, "add_observations_from_episodes_to_batch": 6.55333372827263e-06, "add_states_from_episodes_to_batch": 3.4340812472787405e-06, "numpy_to_tensor": 3.1223455314518045e-05, "add_time_dim_to_batch_and_zero_pad": 6.559876680280175e-06}}, "connector_pipeline_timer": 0.00011889579408444595}, "num_episodes_lifetime": -38600.0, "time_between_sampling": 0.011496849945046413, "module_episode_returns_mean": {"default_policy": 11.099999999999993}, "env_to_module_sum_episodes_length_in": 27.16809333212661, "episode_return_min": -5.5, "episode_return_max": 14.5, "num_env_steps_sampled_lifetime": -1930000.0, "rlmodule_inference_timer": 0.00010089980034726928, "episode_duration_sec_mean": 0.03658237622000342, "num_agent_steps_sampled": {"default_agent": 5000.0}, "num_agent_steps_sampled_lifetime": {"default_agent": -1930000.0}, "env_reset_timer": 9.524306501920144e-05, "episode_return_mean": 11.099999999999993, "weights_seq_no": 9.0, "num_module_steps_sampled": {"default_policy": 5000.0}, "episode_len_min": 50, "env_step_timer": 4.401293290746929e-05, "episode_len_max": 50, "num_env_steps_sampled": 5000.0, "env_to_module_sum_episodes_length_out": 27.16809333212661, "episode_len_mean": 50.0, "num_env_steps_sampled_lifetime_throughput": 1281.839008098738}, "learners": {"__all_modules__": {"learner_connector": {"timers": {"connectors": {"general_advantage_estimation": 0.013025240583322759, "add_columns_from_episodes_to_train_batch": 0.0690168652782061, "batch_individual_items": 0.1942443269067601, "add_observations_from_episodes_to_batch": 0.0007949067714403381, "numpy_to_tensor": 0.0001629803404148673, "add_states_from_episodes_to_batch": 6.14744069625124e-06, "add_time_dim_to_batch_and_zero_pad": 2.3588943836953348e-05, "add_one_ts_to_episodes_and_truncate": 0.008146249982807986}}, "connector_pipeline_timer": 0.28579007640140713}, "num_env_steps_trained_lifetime": 306000, "num_non_trainable_parameters": 0, "learner_connector_sum_episodes_length_in": 5000.0, "num_module_steps_trained": 6000, "num_trainable_parameters": 5909, "num_module_steps_trained_lifetime": 60000, "num_env_steps_trained": 30600, "learner_connector_sum_episodes_length_out": 5100.0, "num_env_steps_trained_lifetime_throughput": 836943.2529794776, "num_module_steps_trained_throughput": 164595.3692657606, "num_module_steps_trained_lifetime_throughput": 164483.71848790467}, "default_policy": {"total_loss": -0.0537126287817955, "diff_num_grad_updates_vs_sampler_policy": 1.0, "vf_loss": 0.24722817540168762, "mean_kl_loss": 0.0014304801588878036, "curr_entropy_coeff": 0.0016790048723, "gradients_default_optimizer_global_norm": 0.06732805073261261, "num_module_steps_trained": 6000, "weights_seq_no": 10.0, "entropy": 0.5869349837303162, "num_trainable_parameters": 5909, "module_train_batch_size_mean": 1000.0, "vf_loss_unclipped": 85.46781921386719, "num_module_steps_trained_lifetime": 60000, "vf_explained_var": 0.09664088487625122, "curr_kl_coeff": 0.0002556626277510077, "policy_loss": -0.19145700335502625, "default_optimizer_learning_rate": 0.0008209260984, "num_module_steps_trained_lifetime_throughput": 164788.4748016183}}, "num_training_step_calls_per_iteration": 1, "evaluation": {"env_runners": {"module_episode_returns_mean": {"default_policy": -1.3}, "module_to_env_connector": {"timers": {"connectors": {"remove_single_ts_time_rank_from_batch": 1.4014539039063113e-06, "listify_data_for_vector_env": 2.9721091500259855e-05, "get_actions": 0.0001504527561631858, "un_batch_to_individual_items": 1.4880794722205095e-05, "normalize_and_clip_actions": 2.1199676310855888e-05, "tensor_to_numpy": 4.459430632932933e-05}}, "connector_pipeline_timer": 0.0003387941343174827}, "agent_episode_returns_mean": {"default_agent": -1.3}, "num_env_steps_sampled": 1000, "num_module_steps_sampled": {"default_policy": 1000}, "num_episodes": 20, "env_to_module_connector": {"timers": {"connectors": {"add_observations_from_episodes_to_batch": 6.024747822830988e-06, "add_states_from_episodes_to_batch": 3.3387789310313496e-06, "numpy_to_tensor": 2.8810183531229064e-05, "add_time_dim_to_batch_and_zero_pad": 6.123074681459016e-06, "batch_individual_items": 1.7716763027197698e-05}}, "connector_pipeline_timer": 0.0001155605482624173}, "num_module_steps_sampled_lifetime": {"default_policy": 10000}, "num_agent_steps_sampled_lifetime": {"default_agent": 10000}, "num_agent_steps_sampled": {"default_agent": 1000}, "rlmodule_inference_timer": 9.250095563086628e-05, "num_env_steps_sampled_lifetime": 51000, "env_reset_timer": 0.0002050863871102736, "episode_return_mean": -1.3, "weights_seq_no": 10.0, "env_step_timer": 4.040351515867499e-05, "episode_len_max": 50, "episode_len_mean": 50.0, "sample": 0.7306316906933177, "num_episodes_lifetime": 200, "episode_return_min": -16.5, "episode_return_max": 17.5, "episode_duration_sec_mean": 0.03476418091999221, "episode_len_min": 50, "env_to_module_sum_episodes_length_out": 27.168093332126602, "env_to_module_sum_episodes_length_in": 27.168093332126602, "time_between_sampling": 4.164542481226266}, "num_healthy_workers": 1, "actor_manager_num_outstanding_async_reqs": 0, "num_remote_worker_restarts": 0}, "num_env_steps_sampled_lifetime": -1930000.0, "fault_tolerance": {"num_healthy_workers": 0, "num_remote_worker_restarts": 0}, "env_runner_group": {"actor_manager_num_outstanding_async_reqs": 0}, "done": false, "training_iteration": 10, "trial_id": "a54d5_00000", "date": "2025-08-11_17-23-27", "timestamp": 1754925807, "time_this_iter_s": 4.9717631340026855, "time_total_s": 49.09114909172058, "pid": 73571, "hostname": "DESKTOP-3SK5A41", "node_ip": "192.168.40.242", "config": {"exploration_config": {}, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 6, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "env": "Umbrella", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": false, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 0, "create_local_env_runner": true, "num_envs_per_env_runner": 1, "gym_env_vectorize_mode": "SYNC", "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "episodes_to_numpy": true, "max_requests_in_flight_per_env_runner": 1, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "merge_env_runner_states": "training_only", "broadcast_env_runner_states": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "complete_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "sampler_perf_stats_ema_coef": null, "_is_online": true, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": "auto", "num_aggregator_actors_per_learner": 0, "max_requests_in_flight_per_aggregator_actor": 3, "local_gpu_idx": 0, "max_requests_in_flight_per_learner": 3, "gamma": 1, "lr": 0.0008209260984, "grad_clip": 0.5, "grad_clip_by": "global_norm", "_train_batch_size_per_learner": 5000, "train_batch_size": 4000, "num_epochs": 1, "minibatch_size": 1000, "shuffle_batch_per_epoch": true, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "log_std_clip_param": 20.0, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "_disable_preprocessor_api": false, "_disable_action_flattening": false}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "_learner_class": null, "callbacks_on_algorithm_init": null, "callbacks_on_env_runners_recreated": null, "callbacks_on_offline_eval_runners_recreated": null, "callbacks_on_checkpoint_loaded": null, "callbacks_on_environment_created": null, "callbacks_on_episode_created": null, "callbacks_on_episode_start": null, "callbacks_on_episode_step": null, "callbacks_on_episode_end": null, "callbacks_on_evaluate_start": null, "callbacks_on_evaluate_end": null, "callbacks_on_evaluate_offline_start": null, "callbacks_on_evaluate_offline_end": null, "callbacks_on_sample_end": null, "callbacks_on_train_result": null, "explore": true, "enable_rl_module_and_learner": true, "enable_env_runner_and_connector_v2": true, "_prior_exploration_config": {"type": "StochasticSampling"}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x70470debeac0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "offline_data_class": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_read_batch_size": null, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "materialize_data": false, "materialize_mapped_data": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "ignore_final_observation": false, "prelearner_class": null, "prelearner_buffer_class": null, "prelearner_buffer_kwargs": {}, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_remaining_data": false, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": 1, "evaluation_duration": 20, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_auto_duration_min_env_steps_per_sample": 100, "evaluation_auto_duration_max_env_steps_per_sample": 2000, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 1, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "offline_evaluation_interval": null, "num_offline_eval_runners": 0, "offline_loss_for_module_fn": null, "offline_evaluation_duration": 1, "offline_evaluation_parallel_to_training": false, "offline_evaluation_timeout_s": 120.0, "num_cpus_per_offline_eval_runner": 1, "num_gpus_per_offline_eval_runner": 0, "custom_resources_per_offline_eval_runner": {}, "restart_failed_offline_eval_runners": true, "ignore_offline_eval_runner_failures": false, "max_num_offline_eval_runner_restarts": 1000, "offline_eval_runner_restore_timeout_s": 1800.0, "max_requests_in_flight_per_offline_eval_runner": 1, "validate_offline_eval_runners_after_construction": true, "offline_eval_runner_health_probe_timeout_s": 30.0, "offline_eval_rl_module_inference_only": false, "broadcast_offline_eval_runner_states": false, "offline_eval_batch_size_per_runner": 256, "dataset_num_iters_per_eval_runner": 1, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "log_gradients": true, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 42, "restart_failed_env_runners": true, "ignore_env_runner_failures": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30.0, "env_runner_restore_timeout_s": 1800.0, "_model_config": {}, "_rl_module_spec": "RLModuleSpec(module_class=None, observation_space=None, action_space=None, inference_only=False, learner_only=False, model_config=DefaultModelConfig(fcnet_hiddens=[43, 122], fcnet_activation='tanh', fcnet_kernel_initializer=None, fcnet_kernel_initializer_kwargs=None, fcnet_bias_initializer=None, fcnet_bias_initializer_kwargs=None, conv_filters=None, conv_activation='relu', conv_kernel_initializer=None, conv_kernel_initializer_kwargs=None, conv_bias_initializer=None, conv_bias_initializer_kwargs=None, head_fcnet_hiddens=[], head_fcnet_activation='relu', head_fcnet_kernel_initializer=None, head_fcnet_kernel_initializer_kwargs=None, head_fcnet_bias_initializer=None, head_fcnet_bias_initializer_kwargs=None, free_log_std=False, log_std_clip_param=20.0, vf_share_layers=True, use_lstm=False, max_seq_len=20, lstm_cell_size=256, lstm_use_prev_action=False, lstm_use_prev_reward=False, lstm_kernel_initializer=None, lstm_kernel_initializer_kwargs=None, lstm_bias_initializer=None, lstm_bias_initializer_kwargs=None), catalog_class=None, load_state_path=None, model_config_dict=None)", "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "_validate_config": true, "_use_msgpack_checkpoints": false, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "env_task_fn": -1, "enable_connectors": -1, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2617985289524, "kl_target": 0.0294268671804, "vf_loss_coeff": 0.5611379931, "entropy_coeff": 0.0016790048723, "clip_param": 0.1271344785601, "vf_clip_param": 0.2507399863488, "entropy_coeff_schedule": null, "lr_schedule": null, "sgd_minibatch_size": -1, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9822919715622, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.callbacks.callbacks.RLlibCallback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 49.09114909172058, "iterations_since_restore": 10, "perf": {"cpu_util_percent": 12.599999999999998, "ram_util_percent": 88.0}}
{"timers": {"training_iteration": 4.211322266871555, "restore_env_runners": 1.4319215854736843e-05, "training_step": 4.211014745034074, "env_runner_sampling_timer": 3.8117226624613916, "learner_update_timer": 0.39578863624227284, "synch_weights": 0.0014341045255152533, "restore_eval_env_runners": 1.6242037568742786e-05, "evaluation_iteration": 0.7425142253797443, "synch_eval_env_connectors": 0.0004054465923797343, "synch_env_connectors": 7.716677637445296e-06}, "env_runners": {"num_episodes": 100.0, "sample": 0.03760919909282654, "module_to_env_connector": {"timers": {"connectors": {"un_batch_to_individual_items": 1.465752981832606e-05, "listify_data_for_vector_env": 3.1179158974709706e-05, "get_actions": 0.0001657536216831266, "normalize_and_clip_actions": 2.237055246547528e-05, "tensor_to_numpy": 4.863329406574293e-05, "remove_single_ts_time_rank_from_batch": 1.4421393417331695e-06}}, "connector_pipeline_timer": 0.0003608233010002005}, "agent_episode_returns_mean": {"default_agent": 12.5}, "num_module_steps_sampled_lifetime": {"default_policy": -2172500.0}, "env_to_module_connector": {"timers": {"connectors": {"batch_individual_items": 1.8520572068338374e-05, "add_observations_from_episodes_to_batch": 6.58403484554246e-06, "add_states_from_episodes_to_batch": 3.477460448132204e-06, "numpy_to_tensor": 3.132692770192705e-05, "add_time_dim_to_batch_and_zero_pad": 6.552695295990907e-06}}, "connector_pipeline_timer": 0.00011941564166470624}, "num_episodes_lifetime": -43450.0, "time_between_sampling": 0.012125352701586014, "module_episode_returns_mean": {"default_policy": 12.5}, "env_to_module_sum_episodes_length_in": 27.16809333212661, "episode_return_min": -5.5, "episode_return_max": 14.5, "num_env_steps_sampled_lifetime": -2172500.0, "rlmodule_inference_timer": 9.99924861583342e-05, "episode_duration_sec_mean": 0.03657355922002352, "num_agent_steps_sampled": {"default_agent": 5000.0}, "num_agent_steps_sampled_lifetime": {"default_agent": -2172500.0}, "env_reset_timer": 9.600896734488832e-05, "episode_return_mean": 12.5, "weights_seq_no": 10.0, "num_module_steps_sampled": {"default_policy": 5000.0}, "episode_len_min": 50, "env_step_timer": 4.3958168271546696e-05, "episode_len_max": 50, "num_env_steps_sampled": 5000.0, "env_to_module_sum_episodes_length_out": 27.16809333212661, "episode_len_mean": 50.0, "num_env_steps_sampled_lifetime_throughput": 1277.0412676326455}, "learners": {"__all_modules__": {"learner_connector": {"timers": {"connectors": {"general_advantage_estimation": 0.012982023177486363, "add_columns_from_episodes_to_train_batch": 0.06902244263542062, "batch_individual_items": 0.19288524863769474, "add_observations_from_episodes_to_batch": 0.0007942477037200348, "numpy_to_tensor": 0.00016293453701217637, "add_states_from_episodes_to_batch": 6.135966288025622e-06, "add_time_dim_to_batch_and_zero_pad": 2.3560054401358108e-05, "add_one_ts_to_episodes_and_truncate": 0.008148184482978419}}, "connector_pipeline_timer": 0.2843930576473987}, "num_env_steps_trained_lifetime": 336600, "num_non_trainable_parameters": 0, "learner_connector_sum_episodes_length_in": 5000.0, "num_module_steps_trained": 6000, "num_trainable_parameters": 5909, "num_module_steps_trained_lifetime": 66000, "num_env_steps_trained": 30600, "learner_connector_sum_episodes_length_out": 5100.0, "num_env_steps_trained_lifetime_throughput": 836846.9764245582, "num_module_steps_trained_throughput": 164565.77417740083, "num_module_steps_trained_lifetime_throughput": 164454.45016558602}, "default_policy": {"total_loss": -0.04081876203417778, "diff_num_grad_updates_vs_sampler_policy": 1.0, "vf_loss": 0.24898460507392883, "mean_kl_loss": 0.001014808425679803, "curr_entropy_coeff": 0.0016790048723, "gradients_default_optimizer_global_norm": 0.0327925831079483, "num_module_steps_trained": 6000, "weights_seq_no": 11.0, "entropy": 0.5696885585784912, "num_trainable_parameters": 5909, "module_train_batch_size_mean": 1000.0, "vf_loss_unclipped": 89.54302978515625, "num_module_steps_trained_lifetime": 66000, "vf_explained_var": 0.09968632459640503, "curr_kl_coeff": 0.00012783131387550384, "policy_loss": -0.17957720160484314, "default_optimizer_learning_rate": 0.0008209260984, "num_module_steps_trained_lifetime_throughput": 164737.3587343619}}, "num_training_step_calls_per_iteration": 1, "evaluation": {"env_runners": {"module_episode_returns_mean": {"default_policy": -0.9}, "module_to_env_connector": {"timers": {"connectors": {"remove_single_ts_time_rank_from_batch": 1.4000170373487178e-06, "listify_data_for_vector_env": 3.0346754454570903e-05, "get_actions": 0.0001536930359649893, "un_batch_to_individual_items": 1.5184094454565245e-05, "normalize_and_clip_actions": 2.183253279898252e-05, "tensor_to_numpy": 4.452170798520134e-05}}, "connector_pipeline_timer": 0.00034401108931779244}, "agent_episode_returns_mean": {"default_agent": -0.9}, "num_env_steps_sampled": 1000, "num_module_steps_sampled": {"default_policy": 1000}, "num_episodes": 20, "env_to_module_connector": {"timers": {"connectors": {"add_observations_from_episodes_to_batch": 6.111445546344936e-06, "add_states_from_episodes_to_batch": 3.502228098579347e-06, "numpy_to_tensor": 2.86230864210117e-05, "add_time_dim_to_batch_and_zero_pad": 5.967309608236619e-06, "batch_individual_items": 1.8291710149297316e-05}}, "connector_pipeline_timer": 0.00011737122480712573}, "num_module_steps_sampled_lifetime": {"default_policy": 11000}, "num_agent_steps_sampled_lifetime": {"default_agent": 11000}, "num_agent_steps_sampled": {"default_agent": 1000}, "rlmodule_inference_timer": 9.418173798111022e-05, "num_env_steps_sampled_lifetime": 56000, "env_reset_timer": 0.00020434152323382717, "episode_return_mean": -0.9, "weights_seq_no": 11.0, "env_step_timer": 4.218073262569105e-05, "episode_len_max": 50, "episode_len_mean": 50.0, "sample": 0.7305852558263826, "num_episodes_lifetime": 220, "episode_return_min": -16.5, "episode_return_max": 17.5, "episode_duration_sec_mean": 0.034790567159998315, "episode_len_min": 50, "env_to_module_sum_episodes_length_out": 27.168093332126602, "env_to_module_sum_episodes_length_in": 27.168093332126602, "time_between_sampling": 4.164448663643998}, "num_healthy_workers": 1, "actor_manager_num_outstanding_async_reqs": 0, "num_remote_worker_restarts": 0}, "num_env_steps_sampled_lifetime": -2172500.0, "fault_tolerance": {"num_healthy_workers": 0, "num_remote_worker_restarts": 0}, "env_runner_group": {"actor_manager_num_outstanding_async_reqs": 0}, "done": false, "training_iteration": 11, "trial_id": "a54d5_00000", "date": "2025-08-11_17-23-32", "timestamp": 1754925812, "time_this_iter_s": 4.839145183563232, "time_total_s": 53.93029427528381, "pid": 73571, "hostname": "DESKTOP-3SK5A41", "node_ip": "192.168.40.242", "config": {"exploration_config": {}, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 6, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "env": "Umbrella", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": false, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 0, "create_local_env_runner": true, "num_envs_per_env_runner": 1, "gym_env_vectorize_mode": "SYNC", "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "episodes_to_numpy": true, "max_requests_in_flight_per_env_runner": 1, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "merge_env_runner_states": "training_only", "broadcast_env_runner_states": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "complete_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "sampler_perf_stats_ema_coef": null, "_is_online": true, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": "auto", "num_aggregator_actors_per_learner": 0, "max_requests_in_flight_per_aggregator_actor": 3, "local_gpu_idx": 0, "max_requests_in_flight_per_learner": 3, "gamma": 1, "lr": 0.0008209260984, "grad_clip": 0.5, "grad_clip_by": "global_norm", "_train_batch_size_per_learner": 5000, "train_batch_size": 4000, "num_epochs": 1, "minibatch_size": 1000, "shuffle_batch_per_epoch": true, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "log_std_clip_param": 20.0, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "_disable_preprocessor_api": false, "_disable_action_flattening": false}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "_learner_class": null, "callbacks_on_algorithm_init": null, "callbacks_on_env_runners_recreated": null, "callbacks_on_offline_eval_runners_recreated": null, "callbacks_on_checkpoint_loaded": null, "callbacks_on_environment_created": null, "callbacks_on_episode_created": null, "callbacks_on_episode_start": null, "callbacks_on_episode_step": null, "callbacks_on_episode_end": null, "callbacks_on_evaluate_start": null, "callbacks_on_evaluate_end": null, "callbacks_on_evaluate_offline_start": null, "callbacks_on_evaluate_offline_end": null, "callbacks_on_sample_end": null, "callbacks_on_train_result": null, "explore": true, "enable_rl_module_and_learner": true, "enable_env_runner_and_connector_v2": true, "_prior_exploration_config": {"type": "StochasticSampling"}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x70470debeac0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "offline_data_class": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_read_batch_size": null, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "materialize_data": false, "materialize_mapped_data": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "ignore_final_observation": false, "prelearner_class": null, "prelearner_buffer_class": null, "prelearner_buffer_kwargs": {}, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_remaining_data": false, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": 1, "evaluation_duration": 20, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_auto_duration_min_env_steps_per_sample": 100, "evaluation_auto_duration_max_env_steps_per_sample": 2000, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 1, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "offline_evaluation_interval": null, "num_offline_eval_runners": 0, "offline_loss_for_module_fn": null, "offline_evaluation_duration": 1, "offline_evaluation_parallel_to_training": false, "offline_evaluation_timeout_s": 120.0, "num_cpus_per_offline_eval_runner": 1, "num_gpus_per_offline_eval_runner": 0, "custom_resources_per_offline_eval_runner": {}, "restart_failed_offline_eval_runners": true, "ignore_offline_eval_runner_failures": false, "max_num_offline_eval_runner_restarts": 1000, "offline_eval_runner_restore_timeout_s": 1800.0, "max_requests_in_flight_per_offline_eval_runner": 1, "validate_offline_eval_runners_after_construction": true, "offline_eval_runner_health_probe_timeout_s": 30.0, "offline_eval_rl_module_inference_only": false, "broadcast_offline_eval_runner_states": false, "offline_eval_batch_size_per_runner": 256, "dataset_num_iters_per_eval_runner": 1, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "log_gradients": true, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 42, "restart_failed_env_runners": true, "ignore_env_runner_failures": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30.0, "env_runner_restore_timeout_s": 1800.0, "_model_config": {}, "_rl_module_spec": "RLModuleSpec(module_class=None, observation_space=None, action_space=None, inference_only=False, learner_only=False, model_config=DefaultModelConfig(fcnet_hiddens=[43, 122], fcnet_activation='tanh', fcnet_kernel_initializer=None, fcnet_kernel_initializer_kwargs=None, fcnet_bias_initializer=None, fcnet_bias_initializer_kwargs=None, conv_filters=None, conv_activation='relu', conv_kernel_initializer=None, conv_kernel_initializer_kwargs=None, conv_bias_initializer=None, conv_bias_initializer_kwargs=None, head_fcnet_hiddens=[], head_fcnet_activation='relu', head_fcnet_kernel_initializer=None, head_fcnet_kernel_initializer_kwargs=None, head_fcnet_bias_initializer=None, head_fcnet_bias_initializer_kwargs=None, free_log_std=False, log_std_clip_param=20.0, vf_share_layers=True, use_lstm=False, max_seq_len=20, lstm_cell_size=256, lstm_use_prev_action=False, lstm_use_prev_reward=False, lstm_kernel_initializer=None, lstm_kernel_initializer_kwargs=None, lstm_bias_initializer=None, lstm_bias_initializer_kwargs=None), catalog_class=None, load_state_path=None, model_config_dict=None)", "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "_validate_config": true, "_use_msgpack_checkpoints": false, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "env_task_fn": -1, "enable_connectors": -1, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2617985289524, "kl_target": 0.0294268671804, "vf_loss_coeff": 0.5611379931, "entropy_coeff": 0.0016790048723, "clip_param": 0.1271344785601, "vf_clip_param": 0.2507399863488, "entropy_coeff_schedule": null, "lr_schedule": null, "sgd_minibatch_size": -1, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9822919715622, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.callbacks.callbacks.RLlibCallback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 53.93029427528381, "iterations_since_restore": 11, "perf": {"cpu_util_percent": 12.571428571428571, "ram_util_percent": 87.95714285714287}}
{"timers": {"training_iteration": 4.211503763432843, "restore_env_runners": 1.4278023690702355e-05, "training_step": 4.211195890813734, "env_runner_sampling_timer": 3.812641178046776, "learner_update_timer": 0.3950517768998495, "synch_weights": 0.0014331654802551405, "restore_eval_env_runners": 1.6186617198355863e-05, "evaluation_iteration": 0.7424439071659501, "synch_eval_env_connectors": 0.0004064071264529387, "synch_env_connectors": 7.708510858963958e-06}, "env_runners": {"num_episodes": 100.0, "sample": 0.03764290110335372, "module_to_env_connector": {"timers": {"connectors": {"un_batch_to_individual_items": 1.4706546383701344e-05, "listify_data_for_vector_env": 3.1121233225138965e-05, "get_actions": 0.00016582199265530333, "normalize_and_clip_actions": 2.223325194060587e-05, "tensor_to_numpy": 4.836410627645065e-05, "remove_single_ts_time_rank_from_batch": 1.4216653630122594e-06}}, "connector_pipeline_timer": 0.0003601005657521112}, "agent_episode_returns_mean": {"default_agent": 13.099999999999993}, "num_module_steps_sampled_lifetime": {"default_policy": -2415000.0}, "env_to_module_connector": {"timers": {"connectors": {"batch_individual_items": 1.8405120960787892e-05, "add_observations_from_episodes_to_batch": 6.54271323179193e-06, "add_states_from_episodes_to_batch": 3.45115245981992e-06, "numpy_to_tensor": 3.1322594413442535e-05, "add_time_dim_to_batch_and_zero_pad": 6.584328823580999e-06}}, "connector_pipeline_timer": 0.00011883057548450414}, "num_episodes_lifetime": -48300.0, "time_between_sampling": 0.011485670444412469, "module_episode_returns_mean": {"default_policy": 13.099999999999993}, "env_to_module_sum_episodes_length_in": 27.16809333212661, "episode_return_min": -5.5, "episode_return_max": 14.5, "num_env_steps_sampled_lifetime": -2415000.0, "rlmodule_inference_timer": 0.00010079514310209064, "episode_duration_sec_mean": 0.03649792619997244, "num_agent_steps_sampled": {"default_agent": 5000.0}, "num_agent_steps_sampled_lifetime": {"default_agent": -2415000.0}, "env_reset_timer": 9.58999098986841e-05, "episode_return_mean": 13.099999999999993, "weights_seq_no": 11.0, "num_module_steps_sampled": {"default_policy": 5000.0}, "episode_len_min": 50, "env_step_timer": 4.402378094785579e-05, "episode_len_max": 50, "num_env_steps_sampled": 5000.0, "env_to_module_sum_episodes_length_out": 27.16809333212661, "episode_len_mean": 50.0, "num_env_steps_sampled_lifetime_throughput": 1278.4749736378492}, "learners": {"__all_modules__": {"learner_connector": {"timers": {"connectors": {"general_advantage_estimation": 0.012937080945709343, "add_columns_from_episodes_to_train_batch": 0.06901307321906229, "batch_individual_items": 0.19294937016131747, "add_observations_from_episodes_to_batch": 0.0007936762266843471, "numpy_to_tensor": 0.00016290819164266855, "add_states_from_episodes_to_batch": 6.127606628535845e-06, "add_time_dim_to_batch_and_zero_pad": 2.354245385292878e-05, "add_one_ts_to_episodes_and_truncate": 0.008148112638142047}}, "connector_pipeline_timer": 0.2844009140909241}, "num_env_steps_trained_lifetime": 367200, "num_non_trainable_parameters": 0, "learner_connector_sum_episodes_length_in": 5000.0, "num_module_steps_trained": 6000, "num_trainable_parameters": 5909, "num_module_steps_trained_lifetime": 72000, "num_env_steps_trained": 30600, "learner_connector_sum_episodes_length_out": 5100.0, "num_env_steps_trained_lifetime_throughput": 835706.5159516053, "num_module_steps_trained_throughput": 164330.4442370535, "num_module_steps_trained_lifetime_throughput": 164219.03198146253}, "default_policy": {"total_loss": 0.03905324637889862, "diff_num_grad_updates_vs_sampler_policy": 1.0, "vf_loss": 0.2489868402481079, "mean_kl_loss": 0.0012286393903195858, "curr_entropy_coeff": 0.0016790048723, "gradients_default_optimizer_global_norm": 0.07499222457408905, "num_module_steps_trained": 6000, "weights_seq_no": 12.0, "entropy": 0.5417258739471436, "num_trainable_parameters": 5909, "module_train_batch_size_mean": 1000.0, "vf_loss_unclipped": 89.69673919677734, "num_module_steps_trained_lifetime": 72000, "vf_explained_var": 0.10005664825439453, "curr_kl_coeff": 6.391565693775192e-05, "policy_loss": -0.09975329786539078, "default_optimizer_learning_rate": 0.0008209260984, "num_module_steps_trained_lifetime_throughput": 164482.3238149858}}, "num_training_step_calls_per_iteration": 1, "evaluation": {"env_runners": {"module_episode_returns_mean": {"default_policy": -1.3}, "module_to_env_connector": {"timers": {"connectors": {"remove_single_ts_time_rank_from_batch": 1.3421726487820392e-06, "listify_data_for_vector_env": 3.0511900784212645e-05, "get_actions": 0.00015135011540485838, "un_batch_to_individual_items": 1.4570716710382167e-05, "normalize_and_clip_actions": 2.1096966993618533e-05, "tensor_to_numpy": 4.421272128151271e-05}}, "connector_pipeline_timer": 0.0003393072164282851}, "agent_episode_returns_mean": {"default_agent": -1.3}, "num_env_steps_sampled": 1000, "num_module_steps_sampled": {"default_policy": 1000}, "num_episodes": 20, "env_to_module_connector": {"timers": {"connectors": {"add_observations_from_episodes_to_batch": 5.942707452037427e-06, "add_states_from_episodes_to_batch": 3.384499083822263e-06, "numpy_to_tensor": 2.8602965365786873e-05, "add_time_dim_to_batch_and_zero_pad": 5.995413864949183e-06, "batch_individual_items": 1.7605604191331452e-05}}, "connector_pipeline_timer": 0.00011444109333321782}, "num_module_steps_sampled_lifetime": {"default_policy": 12000}, "num_agent_steps_sampled_lifetime": {"default_agent": 12000}, "num_agent_steps_sampled": {"default_agent": 1000}, "rlmodule_inference_timer": 9.267748975004292e-05, "num_env_steps_sampled_lifetime": 61000, "env_reset_timer": 0.0002035601079976205, "episode_return_mean": -1.3, "weights_seq_no": 12.0, "env_step_timer": 4.1395763156154074e-05, "episode_len_max": 50, "episode_len_mean": 50.0, "sample": 0.7305305423081182, "num_episodes_lifetime": 240, "episode_return_min": -16.5, "episode_return_max": 17.5, "episode_duration_sec_mean": 0.034777205190011956, "episode_len_min": 50, "env_to_module_sum_episodes_length_out": 27.168093332126602, "env_to_module_sum_episodes_length_in": 27.168093332126602, "time_between_sampling": 4.16565126724756}, "num_healthy_workers": 1, "actor_manager_num_outstanding_async_reqs": 0, "num_remote_worker_restarts": 0}, "num_env_steps_sampled_lifetime": -2415000.0, "fault_tolerance": {"num_healthy_workers": 0, "num_remote_worker_restarts": 0}, "env_runner_group": {"actor_manager_num_outstanding_async_reqs": 0}, "done": false, "training_iteration": 12, "trial_id": "a54d5_00000", "date": "2025-08-11_17-23-37", "timestamp": 1754925817, "time_this_iter_s": 4.96939492225647, "time_total_s": 58.89968919754028, "pid": 73571, "hostname": "DESKTOP-3SK5A41", "node_ip": "192.168.40.242", "config": {"exploration_config": {}, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 6, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "env": "Umbrella", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": false, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 0, "create_local_env_runner": true, "num_envs_per_env_runner": 1, "gym_env_vectorize_mode": "SYNC", "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "episodes_to_numpy": true, "max_requests_in_flight_per_env_runner": 1, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "merge_env_runner_states": "training_only", "broadcast_env_runner_states": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "complete_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "sampler_perf_stats_ema_coef": null, "_is_online": true, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": "auto", "num_aggregator_actors_per_learner": 0, "max_requests_in_flight_per_aggregator_actor": 3, "local_gpu_idx": 0, "max_requests_in_flight_per_learner": 3, "gamma": 1, "lr": 0.0008209260984, "grad_clip": 0.5, "grad_clip_by": "global_norm", "_train_batch_size_per_learner": 5000, "train_batch_size": 4000, "num_epochs": 1, "minibatch_size": 1000, "shuffle_batch_per_epoch": true, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "log_std_clip_param": 20.0, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "_disable_preprocessor_api": false, "_disable_action_flattening": false}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "_learner_class": null, "callbacks_on_algorithm_init": null, "callbacks_on_env_runners_recreated": null, "callbacks_on_offline_eval_runners_recreated": null, "callbacks_on_checkpoint_loaded": null, "callbacks_on_environment_created": null, "callbacks_on_episode_created": null, "callbacks_on_episode_start": null, "callbacks_on_episode_step": null, "callbacks_on_episode_end": null, "callbacks_on_evaluate_start": null, "callbacks_on_evaluate_end": null, "callbacks_on_evaluate_offline_start": null, "callbacks_on_evaluate_offline_end": null, "callbacks_on_sample_end": null, "callbacks_on_train_result": null, "explore": true, "enable_rl_module_and_learner": true, "enable_env_runner_and_connector_v2": true, "_prior_exploration_config": {"type": "StochasticSampling"}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x70470debeac0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "offline_data_class": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_read_batch_size": null, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "materialize_data": false, "materialize_mapped_data": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "ignore_final_observation": false, "prelearner_class": null, "prelearner_buffer_class": null, "prelearner_buffer_kwargs": {}, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_remaining_data": false, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": 1, "evaluation_duration": 20, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_auto_duration_min_env_steps_per_sample": 100, "evaluation_auto_duration_max_env_steps_per_sample": 2000, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 1, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "offline_evaluation_interval": null, "num_offline_eval_runners": 0, "offline_loss_for_module_fn": null, "offline_evaluation_duration": 1, "offline_evaluation_parallel_to_training": false, "offline_evaluation_timeout_s": 120.0, "num_cpus_per_offline_eval_runner": 1, "num_gpus_per_offline_eval_runner": 0, "custom_resources_per_offline_eval_runner": {}, "restart_failed_offline_eval_runners": true, "ignore_offline_eval_runner_failures": false, "max_num_offline_eval_runner_restarts": 1000, "offline_eval_runner_restore_timeout_s": 1800.0, "max_requests_in_flight_per_offline_eval_runner": 1, "validate_offline_eval_runners_after_construction": true, "offline_eval_runner_health_probe_timeout_s": 30.0, "offline_eval_rl_module_inference_only": false, "broadcast_offline_eval_runner_states": false, "offline_eval_batch_size_per_runner": 256, "dataset_num_iters_per_eval_runner": 1, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "log_gradients": true, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 42, "restart_failed_env_runners": true, "ignore_env_runner_failures": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30.0, "env_runner_restore_timeout_s": 1800.0, "_model_config": {}, "_rl_module_spec": "RLModuleSpec(module_class=None, observation_space=None, action_space=None, inference_only=False, learner_only=False, model_config=DefaultModelConfig(fcnet_hiddens=[43, 122], fcnet_activation='tanh', fcnet_kernel_initializer=None, fcnet_kernel_initializer_kwargs=None, fcnet_bias_initializer=None, fcnet_bias_initializer_kwargs=None, conv_filters=None, conv_activation='relu', conv_kernel_initializer=None, conv_kernel_initializer_kwargs=None, conv_bias_initializer=None, conv_bias_initializer_kwargs=None, head_fcnet_hiddens=[], head_fcnet_activation='relu', head_fcnet_kernel_initializer=None, head_fcnet_kernel_initializer_kwargs=None, head_fcnet_bias_initializer=None, head_fcnet_bias_initializer_kwargs=None, free_log_std=False, log_std_clip_param=20.0, vf_share_layers=True, use_lstm=False, max_seq_len=20, lstm_cell_size=256, lstm_use_prev_action=False, lstm_use_prev_reward=False, lstm_kernel_initializer=None, lstm_kernel_initializer_kwargs=None, lstm_bias_initializer=None, lstm_bias_initializer_kwargs=None), catalog_class=None, load_state_path=None, model_config_dict=None)", "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "_validate_config": true, "_use_msgpack_checkpoints": false, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "env_task_fn": -1, "enable_connectors": -1, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2617985289524, "kl_target": 0.0294268671804, "vf_loss_coeff": 0.5611379931, "entropy_coeff": 0.0016790048723, "clip_param": 0.1271344785601, "vf_clip_param": 0.2507399863488, "entropy_coeff_schedule": null, "lr_schedule": null, "sgd_minibatch_size": -1, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9822919715622, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.callbacks.callbacks.RLlibCallback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 58.89968919754028, "iterations_since_restore": 12, "perf": {"cpu_util_percent": 12.900000000000002, "ram_util_percent": 88.0}}
{"timers": {"training_iteration": 4.210184128568514, "restore_env_runners": 1.4245243454654475e-05, "training_step": 4.209875421675596, "env_runner_sampling_timer": 3.8134818630863054, "learner_update_timer": 0.3928884080808576, "synch_weights": 0.0014321818254548137, "restore_eval_env_runners": 1.6123751025326545e-05, "evaluation_iteration": 0.7423676861342876, "synch_eval_env_connectors": 0.0004066800551887144, "synch_env_connectors": 7.690425744882077e-06}, "env_runners": {"num_episodes": 100.0, "sample": 0.03750820430577938, "module_to_env_connector": {"timers": {"connectors": {"un_batch_to_individual_items": 1.4672402760749759e-05, "listify_data_for_vector_env": 3.0968425395589826e-05, "get_actions": 0.00016505430250964115, "normalize_and_clip_actions": 2.2261895821658982e-05, "tensor_to_numpy": 4.817601030092635e-05, "remove_single_ts_time_rank_from_batch": 1.4341229888752513e-06}}, "connector_pipeline_timer": 0.00035906862111661423}, "agent_episode_returns_mean": {"default_agent": 12.299999999999997}, "num_module_steps_sampled_lifetime": {"default_policy": -2657500.0}, "env_to_module_connector": {"timers": {"connectors": {"batch_individual_items": 1.843891175936061e-05, "add_observations_from_episodes_to_batch": 6.551418917777327e-06, "add_states_from_episodes_to_batch": 3.460291198378672e-06, "numpy_to_tensor": 3.113829175779307e-05, "add_time_dim_to_batch_and_zero_pad": 6.563104203671005e-06}}, "connector_pipeline_timer": 0.00011863869735123745}, "num_episodes_lifetime": -53150.0, "time_between_sampling": 0.012144861033427979, "module_episode_returns_mean": {"default_policy": 12.299999999999997}, "env_to_module_sum_episodes_length_in": 27.16809333212661, "episode_return_min": -5.5, "episode_return_max": 14.5, "num_env_steps_sampled_lifetime": -2657500.0, "rlmodule_inference_timer": 0.00010011290992333832, "episode_duration_sec_mean": 0.036401221869991784, "num_agent_steps_sampled": {"default_agent": 5000.0}, "num_agent_steps_sampled_lifetime": {"default_agent": -2657500.0}, "env_reset_timer": 9.494091595803298e-05, "episode_return_mean": 12.299999999999997, "weights_seq_no": 12.0, "num_module_steps_sampled": {"default_policy": 5000.0}, "episode_len_min": 50, "env_step_timer": 4.3841494555709234e-05, "episode_len_max": 50, "num_env_steps_sampled": 5000.0, "env_to_module_sum_episodes_length_out": 27.16809333212661, "episode_len_mean": 50.0, "num_env_steps_sampled_lifetime_throughput": 1285.0861815313658}, "learners": {"__all_modules__": {"learner_connector": {"timers": {"connectors": {"general_advantage_estimation": 0.012892969136249927, "add_columns_from_episodes_to_train_batch": 0.06901501646687055, "batch_individual_items": 0.19159580743970753, "add_observations_from_episodes_to_batch": 0.0007927304644177018, "numpy_to_tensor": 0.00016290110972601207, "add_states_from_episodes_to_batch": 6.117330559506927e-06, "add_time_dim_to_batch_and_zero_pad": 2.3522029314425103e-05, "add_one_ts_to_episodes_and_truncate": 0.008150163511759368}}, "connector_pipeline_timer": 0.2830050189100196}, "num_env_steps_trained_lifetime": 397800, "num_non_trainable_parameters": 0, "learner_connector_sum_episodes_length_in": 5000.0, "num_module_steps_trained": 6000, "num_trainable_parameters": 5909, "num_module_steps_trained_lifetime": 78000, "num_env_steps_trained": 30600, "learner_connector_sum_episodes_length_out": 5100.0, "num_env_steps_trained_lifetime_throughput": 834980.3822041004, "num_module_steps_trained_throughput": 164174.9520547168, "num_module_steps_trained_lifetime_throughput": 164064.2466713059}, "default_policy": {"total_loss": -0.06239480897784233, "diff_num_grad_updates_vs_sampler_policy": 1.0, "vf_loss": 0.24898909032344818, "mean_kl_loss": 0.0018517576390877366, "curr_entropy_coeff": 0.0016790048723, "gradients_default_optimizer_global_norm": 0.0940641537308693, "num_module_steps_trained": 6000, "weights_seq_no": 13.0, "entropy": 0.5057891607284546, "num_trainable_parameters": 5909, "module_train_batch_size_mean": 1000.0, "vf_loss_unclipped": 89.8966293334961, "num_module_steps_trained_lifetime": 78000, "vf_explained_var": 0.10008645057678223, "curr_kl_coeff": 3.195782846887596e-05, "policy_loss": -0.2012629359960556, "default_optimizer_learning_rate": 0.0008209260984, "num_module_steps_trained_lifetime_throughput": 164308.14306945074}}, "num_training_step_calls_per_iteration": 1, "evaluation": {"env_runners": {"module_episode_returns_mean": {"default_policy": -0.7}, "module_to_env_connector": {"timers": {"connectors": {"remove_single_ts_time_rank_from_batch": 1.390426675755796e-06, "listify_data_for_vector_env": 3.013847830467677e-05, "get_actions": 0.00015291925724797274, "un_batch_to_individual_items": 1.5760199394014075e-05, "normalize_and_clip_actions": 2.1828285174169765e-05, "tensor_to_numpy": 4.554170795924434e-05}}, "connector_pipeline_timer": 0.0003433432538409313}, "agent_episode_returns_mean": {"default_agent": -0.7}, "num_env_steps_sampled": 1000, "num_module_steps_sampled": {"default_policy": 1000}, "num_episodes": 20, "env_to_module_connector": {"timers": {"connectors": {"add_observations_from_episodes_to_batch": 5.976747057848236e-06, "add_states_from_episodes_to_batch": 3.3492581217705097e-06, "numpy_to_tensor": 2.922310784934374e-05, "add_time_dim_to_batch_and_zero_pad": 5.854214651733668e-06, "batch_individual_items": 1.759535521383121e-05}}, "connector_pipeline_timer": 0.000115805044487187}, "num_module_steps_sampled_lifetime": {"default_policy": 13000}, "num_agent_steps_sampled_lifetime": {"default_agent": 13000}, "num_agent_steps_sampled": {"default_agent": 1000}, "rlmodule_inference_timer": 9.344979581874687e-05, "num_env_steps_sampled_lifetime": 66000, "env_reset_timer": 0.0002027115069156706, "episode_return_mean": -0.7, "weights_seq_no": 13.0, "env_step_timer": 4.152908653958876e-05, "episode_len_max": 50, "episode_len_mean": 50.0, "sample": 0.7305077916550365, "num_episodes_lifetime": 260, "episode_return_min": -16.5, "episode_return_max": 17.5, "episode_duration_sec_mean": 0.0348324749400399, "episode_len_min": 50, "env_to_module_sum_episodes_length_out": 27.168093332126602, "env_to_module_sum_episodes_length_in": 27.168093332126602, "time_between_sampling": 4.165340790355081}, "num_healthy_workers": 1, "actor_manager_num_outstanding_async_reqs": 0, "num_remote_worker_restarts": 0}, "num_env_steps_sampled_lifetime": -2657500.0, "fault_tolerance": {"num_healthy_workers": 0, "num_remote_worker_restarts": 0}, "env_runner_group": {"actor_manager_num_outstanding_async_reqs": 0}, "done": false, "training_iteration": 13, "trial_id": "a54d5_00000", "date": "2025-08-11_17-23-42", "timestamp": 1754925822, "time_this_iter_s": 4.822027206420898, "time_total_s": 63.72171640396118, "pid": 73571, "hostname": "DESKTOP-3SK5A41", "node_ip": "192.168.40.242", "config": {"exploration_config": {}, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 6, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "env": "Umbrella", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": false, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 0, "create_local_env_runner": true, "num_envs_per_env_runner": 1, "gym_env_vectorize_mode": "SYNC", "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "episodes_to_numpy": true, "max_requests_in_flight_per_env_runner": 1, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "merge_env_runner_states": "training_only", "broadcast_env_runner_states": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "complete_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "sampler_perf_stats_ema_coef": null, "_is_online": true, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": "auto", "num_aggregator_actors_per_learner": 0, "max_requests_in_flight_per_aggregator_actor": 3, "local_gpu_idx": 0, "max_requests_in_flight_per_learner": 3, "gamma": 1, "lr": 0.0008209260984, "grad_clip": 0.5, "grad_clip_by": "global_norm", "_train_batch_size_per_learner": 5000, "train_batch_size": 4000, "num_epochs": 1, "minibatch_size": 1000, "shuffle_batch_per_epoch": true, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "log_std_clip_param": 20.0, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "_disable_preprocessor_api": false, "_disable_action_flattening": false}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "_learner_class": null, "callbacks_on_algorithm_init": null, "callbacks_on_env_runners_recreated": null, "callbacks_on_offline_eval_runners_recreated": null, "callbacks_on_checkpoint_loaded": null, "callbacks_on_environment_created": null, "callbacks_on_episode_created": null, "callbacks_on_episode_start": null, "callbacks_on_episode_step": null, "callbacks_on_episode_end": null, "callbacks_on_evaluate_start": null, "callbacks_on_evaluate_end": null, "callbacks_on_evaluate_offline_start": null, "callbacks_on_evaluate_offline_end": null, "callbacks_on_sample_end": null, "callbacks_on_train_result": null, "explore": true, "enable_rl_module_and_learner": true, "enable_env_runner_and_connector_v2": true, "_prior_exploration_config": {"type": "StochasticSampling"}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x70470debeac0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "offline_data_class": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_read_batch_size": null, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "materialize_data": false, "materialize_mapped_data": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "ignore_final_observation": false, "prelearner_class": null, "prelearner_buffer_class": null, "prelearner_buffer_kwargs": {}, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_remaining_data": false, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": 1, "evaluation_duration": 20, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_auto_duration_min_env_steps_per_sample": 100, "evaluation_auto_duration_max_env_steps_per_sample": 2000, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 1, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "offline_evaluation_interval": null, "num_offline_eval_runners": 0, "offline_loss_for_module_fn": null, "offline_evaluation_duration": 1, "offline_evaluation_parallel_to_training": false, "offline_evaluation_timeout_s": 120.0, "num_cpus_per_offline_eval_runner": 1, "num_gpus_per_offline_eval_runner": 0, "custom_resources_per_offline_eval_runner": {}, "restart_failed_offline_eval_runners": true, "ignore_offline_eval_runner_failures": false, "max_num_offline_eval_runner_restarts": 1000, "offline_eval_runner_restore_timeout_s": 1800.0, "max_requests_in_flight_per_offline_eval_runner": 1, "validate_offline_eval_runners_after_construction": true, "offline_eval_runner_health_probe_timeout_s": 30.0, "offline_eval_rl_module_inference_only": false, "broadcast_offline_eval_runner_states": false, "offline_eval_batch_size_per_runner": 256, "dataset_num_iters_per_eval_runner": 1, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "log_gradients": true, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 42, "restart_failed_env_runners": true, "ignore_env_runner_failures": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30.0, "env_runner_restore_timeout_s": 1800.0, "_model_config": {}, "_rl_module_spec": "RLModuleSpec(module_class=None, observation_space=None, action_space=None, inference_only=False, learner_only=False, model_config=DefaultModelConfig(fcnet_hiddens=[43, 122], fcnet_activation='tanh', fcnet_kernel_initializer=None, fcnet_kernel_initializer_kwargs=None, fcnet_bias_initializer=None, fcnet_bias_initializer_kwargs=None, conv_filters=None, conv_activation='relu', conv_kernel_initializer=None, conv_kernel_initializer_kwargs=None, conv_bias_initializer=None, conv_bias_initializer_kwargs=None, head_fcnet_hiddens=[], head_fcnet_activation='relu', head_fcnet_kernel_initializer=None, head_fcnet_kernel_initializer_kwargs=None, head_fcnet_bias_initializer=None, head_fcnet_bias_initializer_kwargs=None, free_log_std=False, log_std_clip_param=20.0, vf_share_layers=True, use_lstm=False, max_seq_len=20, lstm_cell_size=256, lstm_use_prev_action=False, lstm_use_prev_reward=False, lstm_kernel_initializer=None, lstm_kernel_initializer_kwargs=None, lstm_bias_initializer=None, lstm_bias_initializer_kwargs=None), catalog_class=None, load_state_path=None, model_config_dict=None)", "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "_validate_config": true, "_use_msgpack_checkpoints": false, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "env_task_fn": -1, "enable_connectors": -1, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2617985289524, "kl_target": 0.0294268671804, "vf_loss_coeff": 0.5611379931, "entropy_coeff": 0.0016790048723, "clip_param": 0.1271344785601, "vf_clip_param": 0.2507399863488, "entropy_coeff_schedule": null, "lr_schedule": null, "sgd_minibatch_size": -1, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9822919715622, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.callbacks.callbacks.RLlibCallback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 63.72171640396118, "iterations_since_restore": 13, "perf": {"cpu_util_percent": 12.628571428571428, "ram_util_percent": 88.0}}
{"timers": {"training_iteration": 4.210090390002821, "restore_env_runners": 1.420979101631349e-05, "training_step": 4.209781035178841, "env_runner_sampling_timer": 3.814064139275437, "learner_update_timer": 0.39220856390005066, "synch_weights": 0.0014311210072039603, "restore_eval_env_runners": 1.60665135157202e-05, "evaluation_iteration": 0.7423200350429443, "synch_eval_env_connectors": 0.00040658625463941563, "synch_env_connectors": 7.673521489555507e-06}, "env_runners": {"num_episodes": 100.0, "sample": 0.03741384214573695, "module_to_env_connector": {"timers": {"connectors": {"un_batch_to_individual_items": 1.4566794960425605e-05, "listify_data_for_vector_env": 3.075514502270168e-05, "get_actions": 0.000164161600271754, "normalize_and_clip_actions": 2.2050971518039418e-05, "tensor_to_numpy": 4.8021256956162063e-05, "remove_single_ts_time_rank_from_batch": 1.4167631973692758e-06}}, "connector_pipeline_timer": 0.00035704125608219077}, "agent_episode_returns_mean": {"default_agent": 12.099999999999993}, "num_module_steps_sampled_lifetime": {"default_policy": -2900000.0}, "env_to_module_connector": {"timers": {"connectors": {"batch_individual_items": 1.8208856028624588e-05, "add_observations_from_episodes_to_batch": 6.474437639203138e-06, "add_states_from_episodes_to_batch": 3.386606185483523e-06, "numpy_to_tensor": 3.10209027666698e-05, "add_time_dim_to_batch_and_zero_pad": 6.484953935447119e-06}}, "connector_pipeline_timer": 0.00011785270637119058}, "num_episodes_lifetime": -58000.0, "time_between_sampling": 0.011489137596998194, "module_episode_returns_mean": {"default_policy": 12.099999999999993}, "env_to_module_sum_episodes_length_in": 27.16809333212661, "episode_return_min": -5.5, "episode_return_max": 14.5, "num_env_steps_sampled_lifetime": -2900000.0, "rlmodule_inference_timer": 9.948213080757914e-05, "episode_duration_sec_mean": 0.03619294288001583, "num_agent_steps_sampled": {"default_agent": 5000.0}, "num_agent_steps_sampled_lifetime": {"default_agent": -2900000.0}, "env_reset_timer": 9.42915015784429e-05, "episode_return_mean": 12.099999999999993, "weights_seq_no": 13.0, "num_module_steps_sampled": {"default_policy": 5000.0}, "episode_len_min": 50, "env_step_timer": 4.3656423995095405e-05, "episode_len_max": 50, "num_env_steps_sampled": 5000.0, "env_to_module_sum_episodes_length_out": 27.16809333212661, "episode_len_mean": 50.0, "num_env_steps_sampled_lifetime_throughput": 1289.8801440386903}, "learners": {"__all_modules__": {"learner_connector": {"timers": {"connectors": {"general_advantage_estimation": 0.012862834444890947, "add_columns_from_episodes_to_train_batch": 0.06900701628219533, "batch_individual_items": 0.19168463029531174, "add_observations_from_episodes_to_batch": 0.0007918751597720407, "numpy_to_tensor": 0.00016287109862619278, "add_states_from_episodes_to_batch": 6.1091572573023376e-06, "add_time_dim_to_batch_and_zero_pad": 2.349780901813333e-05, "add_one_ts_to_episodes_and_truncate": 0.008150594876643075}}, "connector_pipeline_timer": 0.28305370763092286}, "num_env_steps_trained_lifetime": 428400, "num_non_trainable_parameters": 0, "learner_connector_sum_episodes_length_in": 5000.0, "num_module_steps_trained": 6000, "num_trainable_parameters": 5909, "num_module_steps_trained_lifetime": 84000, "num_env_steps_trained": 30600, "learner_connector_sum_episodes_length_out": 5100.0, "num_env_steps_trained_lifetime_throughput": 833671.2903909088, "num_module_steps_trained_throughput": 163903.78251411882, "num_module_steps_trained_lifetime_throughput": 163793.86853526862}, "default_policy": {"total_loss": -0.08265160024166107, "diff_num_grad_updates_vs_sampler_policy": 1.0, "vf_loss": 0.24898654222488403, "mean_kl_loss": 0.0011685078497976065, "curr_entropy_coeff": 0.0016790048723, "gradients_default_optimizer_global_norm": 0.11437170207500458, "num_module_steps_trained": 6000, "weights_seq_no": 14.0, "entropy": 0.4736805856227875, "num_trainable_parameters": 5909, "module_train_batch_size_mean": 1000.0, "vf_loss_unclipped": 89.9157943725586, "num_module_steps_trained_lifetime": 84000, "vf_explained_var": 0.0994560718536377, "curr_kl_coeff": 1.597891423443798e-05, "policy_loss": -0.22157210111618042, "default_optimizer_learning_rate": 0.0008209260984, "num_module_steps_trained_lifetime_throughput": 164020.6493218674}}, "num_training_step_calls_per_iteration": 1, "evaluation": {"env_runners": {"module_episode_returns_mean": {"default_policy": -1.7}, "module_to_env_connector": {"timers": {"connectors": {"remove_single_ts_time_rank_from_batch": 1.3762705861262897e-06, "listify_data_for_vector_env": 2.9970273175430623e-05, "get_actions": 0.0001508739525006722, "un_batch_to_individual_items": 1.5036063985229312e-05, "normalize_and_clip_actions": 2.1421244564498312e-05, "tensor_to_numpy": 4.424421912459342e-05}}, "connector_pipeline_timer": 0.00033841165980426753}, "agent_episode_returns_mean": {"default_agent": -1.7}, "num_env_steps_sampled": 1000, "num_module_steps_sampled": {"default_policy": 1000}, "num_episodes": 20, "env_to_module_connector": {"timers": {"connectors": {"add_observations_from_episodes_to_batch": 5.861569054919676e-06, "add_states_from_episodes_to_batch": 3.3399585944910247e-06, "numpy_to_tensor": 2.8136716507151367e-05, "add_time_dim_to_batch_and_zero_pad": 5.791750082842389e-06, "batch_individual_items": 1.7682290359400007e-05}}, "connector_pipeline_timer": 0.0001140587901108732}, "num_module_steps_sampled_lifetime": {"default_policy": 14000}, "num_agent_steps_sampled_lifetime": {"default_agent": 14000}, "num_agent_steps_sampled": {"default_agent": 1000}, "rlmodule_inference_timer": 9.296200481693367e-05, "num_env_steps_sampled_lifetime": 71000, "env_reset_timer": 0.0002018643918458084, "episode_return_mean": -1.7, "weights_seq_no": 14.0, "env_step_timer": 4.104652287961814e-05, "episode_len_max": 50, "episode_len_mean": 50.0, "sample": 0.7304422065184949, "num_episodes_lifetime": 280, "episode_return_min": -16.5, "episode_return_max": 17.5, "episode_duration_sec_mean": 0.03485589069002344, "episode_len_min": 50, "env_to_module_sum_episodes_length_out": 27.168093332126602, "env_to_module_sum_episodes_length_in": 27.168093332126602, "time_between_sampling": 4.16622736216153}, "num_healthy_workers": 1, "actor_manager_num_outstanding_async_reqs": 0, "num_remote_worker_restarts": 0}, "num_env_steps_sampled_lifetime": -2900000.0, "fault_tolerance": {"num_healthy_workers": 0, "num_remote_worker_restarts": 0}, "env_runner_group": {"actor_manager_num_outstanding_async_reqs": 0}, "done": false, "training_iteration": 14, "trial_id": "a54d5_00000", "date": "2025-08-11_17-23-47", "timestamp": 1754925827, "time_this_iter_s": 4.938651084899902, "time_total_s": 68.66036748886108, "pid": 73571, "hostname": "DESKTOP-3SK5A41", "node_ip": "192.168.40.242", "config": {"exploration_config": {}, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 6, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "env": "Umbrella", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": false, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 0, "create_local_env_runner": true, "num_envs_per_env_runner": 1, "gym_env_vectorize_mode": "SYNC", "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "episodes_to_numpy": true, "max_requests_in_flight_per_env_runner": 1, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "merge_env_runner_states": "training_only", "broadcast_env_runner_states": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "complete_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "sampler_perf_stats_ema_coef": null, "_is_online": true, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": "auto", "num_aggregator_actors_per_learner": 0, "max_requests_in_flight_per_aggregator_actor": 3, "local_gpu_idx": 0, "max_requests_in_flight_per_learner": 3, "gamma": 1, "lr": 0.0008209260984, "grad_clip": 0.5, "grad_clip_by": "global_norm", "_train_batch_size_per_learner": 5000, "train_batch_size": 4000, "num_epochs": 1, "minibatch_size": 1000, "shuffle_batch_per_epoch": true, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "log_std_clip_param": 20.0, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "_disable_preprocessor_api": false, "_disable_action_flattening": false}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "_learner_class": null, "callbacks_on_algorithm_init": null, "callbacks_on_env_runners_recreated": null, "callbacks_on_offline_eval_runners_recreated": null, "callbacks_on_checkpoint_loaded": null, "callbacks_on_environment_created": null, "callbacks_on_episode_created": null, "callbacks_on_episode_start": null, "callbacks_on_episode_step": null, "callbacks_on_episode_end": null, "callbacks_on_evaluate_start": null, "callbacks_on_evaluate_end": null, "callbacks_on_evaluate_offline_start": null, "callbacks_on_evaluate_offline_end": null, "callbacks_on_sample_end": null, "callbacks_on_train_result": null, "explore": true, "enable_rl_module_and_learner": true, "enable_env_runner_and_connector_v2": true, "_prior_exploration_config": {"type": "StochasticSampling"}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x70470debeac0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "offline_data_class": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_read_batch_size": null, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "materialize_data": false, "materialize_mapped_data": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "ignore_final_observation": false, "prelearner_class": null, "prelearner_buffer_class": null, "prelearner_buffer_kwargs": {}, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_remaining_data": false, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": 1, "evaluation_duration": 20, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_auto_duration_min_env_steps_per_sample": 100, "evaluation_auto_duration_max_env_steps_per_sample": 2000, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 1, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "offline_evaluation_interval": null, "num_offline_eval_runners": 0, "offline_loss_for_module_fn": null, "offline_evaluation_duration": 1, "offline_evaluation_parallel_to_training": false, "offline_evaluation_timeout_s": 120.0, "num_cpus_per_offline_eval_runner": 1, "num_gpus_per_offline_eval_runner": 0, "custom_resources_per_offline_eval_runner": {}, "restart_failed_offline_eval_runners": true, "ignore_offline_eval_runner_failures": false, "max_num_offline_eval_runner_restarts": 1000, "offline_eval_runner_restore_timeout_s": 1800.0, "max_requests_in_flight_per_offline_eval_runner": 1, "validate_offline_eval_runners_after_construction": true, "offline_eval_runner_health_probe_timeout_s": 30.0, "offline_eval_rl_module_inference_only": false, "broadcast_offline_eval_runner_states": false, "offline_eval_batch_size_per_runner": 256, "dataset_num_iters_per_eval_runner": 1, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "log_gradients": true, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 42, "restart_failed_env_runners": true, "ignore_env_runner_failures": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30.0, "env_runner_restore_timeout_s": 1800.0, "_model_config": {}, "_rl_module_spec": "RLModuleSpec(module_class=None, observation_space=None, action_space=None, inference_only=False, learner_only=False, model_config=DefaultModelConfig(fcnet_hiddens=[43, 122], fcnet_activation='tanh', fcnet_kernel_initializer=None, fcnet_kernel_initializer_kwargs=None, fcnet_bias_initializer=None, fcnet_bias_initializer_kwargs=None, conv_filters=None, conv_activation='relu', conv_kernel_initializer=None, conv_kernel_initializer_kwargs=None, conv_bias_initializer=None, conv_bias_initializer_kwargs=None, head_fcnet_hiddens=[], head_fcnet_activation='relu', head_fcnet_kernel_initializer=None, head_fcnet_kernel_initializer_kwargs=None, head_fcnet_bias_initializer=None, head_fcnet_bias_initializer_kwargs=None, free_log_std=False, log_std_clip_param=20.0, vf_share_layers=True, use_lstm=False, max_seq_len=20, lstm_cell_size=256, lstm_use_prev_action=False, lstm_use_prev_reward=False, lstm_kernel_initializer=None, lstm_kernel_initializer_kwargs=None, lstm_bias_initializer=None, lstm_bias_initializer_kwargs=None), catalog_class=None, load_state_path=None, model_config_dict=None)", "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "_validate_config": true, "_use_msgpack_checkpoints": false, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "env_task_fn": -1, "enable_connectors": -1, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2617985289524, "kl_target": 0.0294268671804, "vf_loss_coeff": 0.5611379931, "entropy_coeff": 0.0016790048723, "clip_param": 0.1271344785601, "vf_clip_param": 0.2507399863488, "entropy_coeff_schedule": null, "lr_schedule": null, "sgd_minibatch_size": -1, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9822919715622, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.callbacks.callbacks.RLlibCallback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 68.66036748886108, "iterations_since_restore": 14, "perf": {"cpu_util_percent": 12.357142857142858, "ram_util_percent": 88.0}}
{"timers": {"training_iteration": 4.208876231862792, "restore_env_runners": 1.4170693108277728e-05, "training_step": 4.208566207587056, "env_runner_sampling_timer": 3.8148871647026827, "learner_update_timer": 0.3901701232010489, "synch_weights": 0.0014309757971236673, "restore_eval_env_runners": 1.6004848379517236e-05, "evaluation_iteration": 0.7422319834625223, "synch_eval_env_connectors": 0.00040695939209693443, "synch_env_connectors": 7.658786273821297e-06}, "env_runners": {"num_episodes": 100.0, "sample": 0.037434315995388816, "module_to_env_connector": {"timers": {"connectors": {"un_batch_to_individual_items": 1.4694562117066863e-05, "listify_data_for_vector_env": 3.091539813352881e-05, "get_actions": 0.0001651392931272207, "normalize_and_clip_actions": 2.231678722941117e-05, "tensor_to_numpy": 4.828972978134412e-05, "remove_single_ts_time_rank_from_batch": 1.448384573437011e-06}}, "connector_pipeline_timer": 0.0003592023626307319}, "agent_episode_returns_mean": {"default_agent": 13.099999999999993}, "num_module_steps_sampled_lifetime": {"default_policy": -3142500.0}, "env_to_module_connector": {"timers": {"connectors": {"batch_individual_items": 1.828879795700167e-05, "add_observations_from_episodes_to_batch": 6.5726476534065796e-06, "add_states_from_episodes_to_batch": 3.4339873096897945e-06, "numpy_to_tensor": 3.099899947208496e-05, "add_time_dim_to_batch_and_zero_pad": 6.540647899096842e-06}}, "connector_pipeline_timer": 0.00011830566401520762}, "num_episodes_lifetime": -62850.0, "time_between_sampling": 0.012149085903325916, "module_episode_returns_mean": {"default_policy": 13.099999999999993}, "env_to_module_sum_episodes_length_in": 27.16809333212661, "episode_return_min": -5.5, "episode_return_max": 14.5, "num_env_steps_sampled_lifetime": -3142500.0, "rlmodule_inference_timer": 0.00010010560951924312, "episode_duration_sec_mean": 0.036393488909989176, "num_agent_steps_sampled": {"default_agent": 5000.0}, "num_agent_steps_sampled_lifetime": {"default_agent": -3142500.0}, "env_reset_timer": 9.399893254305695e-05, "episode_return_mean": 13.099999999999993, "weights_seq_no": 14.0, "num_module_steps_sampled": {"default_policy": 5000.0}, "episode_len_min": 50, "env_step_timer": 4.3877224563912496e-05, "episode_len_max": 50, "num_env_steps_sampled": 5000.0, "env_to_module_sum_episodes_length_out": 27.16809333212661, "episode_len_mean": 50.0, "num_env_steps_sampled_lifetime_throughput": 1283.2238674786545}, "learners": {"__all_modules__": {"learner_connector": {"timers": {"connectors": {"general_advantage_estimation": 0.012844889100444647, "add_columns_from_episodes_to_train_batch": 0.06901417509937119, "batch_individual_items": 0.19035567097236034, "add_observations_from_episodes_to_batch": 0.0007913564081783744, "numpy_to_tensor": 0.00016285438764541063, "add_states_from_episodes_to_batch": 6.1040656836784334e-06, "add_time_dim_to_batch_and_zero_pad": 2.3477830927977607e-05, "add_one_ts_to_episodes_and_truncate": 0.008153558917882898}}, "connector_pipeline_timer": 0.28171544950462235}, "num_env_steps_trained_lifetime": 459000, "num_non_trainable_parameters": 0, "learner_connector_sum_episodes_length_in": 5000.0, "num_module_steps_trained": 6000, "num_trainable_parameters": 5909, "num_module_steps_trained_lifetime": 90000, "num_env_steps_trained": 30600, "learner_connector_sum_episodes_length_out": 5100.0, "num_env_steps_trained_lifetime_throughput": 831483.8547315774, "num_module_steps_trained_throughput": 163459.9006578336, "num_module_steps_trained_lifetime_throughput": 163350.91511482428}, "default_policy": {"total_loss": 0.2129254788160324, "diff_num_grad_updates_vs_sampler_policy": 1.0, "vf_loss": 0.24747894704341888, "mean_kl_loss": 0.002622140571475029, "curr_entropy_coeff": 0.0016790048723, "gradients_default_optimizer_global_norm": 0.16513410210609436, "num_module_steps_trained": 6000, "weights_seq_no": 15.0, "entropy": 0.4202456772327423, "num_trainable_parameters": 5909, "module_train_batch_size_mean": 1000.0, "vf_loss_unclipped": 86.28974151611328, "num_module_steps_trained_lifetime": 90000, "vf_explained_var": 0.09526628255844116, "curr_kl_coeff": 7.98945711721899e-06, "policy_loss": 0.07476121932268143, "default_optimizer_learning_rate": 0.0008209260984, "num_module_steps_trained_lifetime_throughput": 163561.71918477598}}, "num_training_step_calls_per_iteration": 1, "evaluation": {"env_runners": {"module_episode_returns_mean": {"default_policy": -1.9}, "module_to_env_connector": {"timers": {"connectors": {"remove_single_ts_time_rank_from_batch": 1.400992741884639e-06, "listify_data_for_vector_env": 3.0154225674854366e-05, "get_actions": 0.00014995183315132812, "un_batch_to_individual_items": 1.5555170678021706e-05, "normalize_and_clip_actions": 2.1255088440706973e-05, "tensor_to_numpy": 4.461634332858039e-05}}, "connector_pipeline_timer": 0.0003383468829577513}, "agent_episode_returns_mean": {"default_agent": -1.9}, "num_env_steps_sampled": 1000, "num_module_steps_sampled": {"default_policy": 1000}, "num_episodes": 20, "env_to_module_connector": {"timers": {"connectors": {"add_observations_from_episodes_to_batch": 6.060259324725838e-06, "add_states_from_episodes_to_batch": 3.361037021273506e-06, "numpy_to_tensor": 2.8868412877253425e-05, "add_time_dim_to_batch_and_zero_pad": 5.945611249750141e-06, "batch_individual_items": 1.7700690739027228e-05}}, "connector_pipeline_timer": 0.0001149631116033448}, "num_module_steps_sampled_lifetime": {"default_policy": 15000}, "num_agent_steps_sampled_lifetime": {"default_agent": 15000}, "num_agent_steps_sampled": {"default_agent": 1000}, "rlmodule_inference_timer": 9.2432740514599e-05, "num_env_steps_sampled_lifetime": 76000, "env_reset_timer": 0.0002014977479190867, "episode_return_mean": -1.9, "weights_seq_no": 15.0, "env_step_timer": 4.024165650304241e-05, "episode_len_max": 50, "episode_len_mean": 50.0, "sample": 0.7303681862333078, "num_episodes_lifetime": 300, "episode_return_min": -16.5, "episode_return_max": 17.5, "episode_duration_sec_mean": 0.03485447344000022, "episode_len_min": 50, "env_to_module_sum_episodes_length_out": 27.168093332126602, "env_to_module_sum_episodes_length_in": 27.168093332126602, "time_between_sampling": 4.165998361269915}, "num_healthy_workers": 1, "actor_manager_num_outstanding_async_reqs": 0, "num_remote_worker_restarts": 0}, "num_env_steps_sampled_lifetime": -3142500.0, "fault_tolerance": {"num_healthy_workers": 0, "num_remote_worker_restarts": 0}, "env_runner_group": {"actor_manager_num_outstanding_async_reqs": 0}, "done": false, "training_iteration": 15, "trial_id": "a54d5_00000", "date": "2025-08-11_17-23-52", "timestamp": 1754925832, "time_this_iter_s": 4.826975107192993, "time_total_s": 73.48734259605408, "pid": 73571, "hostname": "DESKTOP-3SK5A41", "node_ip": "192.168.40.242", "config": {"exploration_config": {}, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 6, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "env": "Umbrella", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": false, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 0, "create_local_env_runner": true, "num_envs_per_env_runner": 1, "gym_env_vectorize_mode": "SYNC", "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "episodes_to_numpy": true, "max_requests_in_flight_per_env_runner": 1, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "merge_env_runner_states": "training_only", "broadcast_env_runner_states": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "complete_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "sampler_perf_stats_ema_coef": null, "_is_online": true, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": "auto", "num_aggregator_actors_per_learner": 0, "max_requests_in_flight_per_aggregator_actor": 3, "local_gpu_idx": 0, "max_requests_in_flight_per_learner": 3, "gamma": 1, "lr": 0.0008209260984, "grad_clip": 0.5, "grad_clip_by": "global_norm", "_train_batch_size_per_learner": 5000, "train_batch_size": 4000, "num_epochs": 1, "minibatch_size": 1000, "shuffle_batch_per_epoch": true, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "log_std_clip_param": 20.0, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "_disable_preprocessor_api": false, "_disable_action_flattening": false}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "_learner_class": null, "callbacks_on_algorithm_init": null, "callbacks_on_env_runners_recreated": null, "callbacks_on_offline_eval_runners_recreated": null, "callbacks_on_checkpoint_loaded": null, "callbacks_on_environment_created": null, "callbacks_on_episode_created": null, "callbacks_on_episode_start": null, "callbacks_on_episode_step": null, "callbacks_on_episode_end": null, "callbacks_on_evaluate_start": null, "callbacks_on_evaluate_end": null, "callbacks_on_evaluate_offline_start": null, "callbacks_on_evaluate_offline_end": null, "callbacks_on_sample_end": null, "callbacks_on_train_result": null, "explore": true, "enable_rl_module_and_learner": true, "enable_env_runner_and_connector_v2": true, "_prior_exploration_config": {"type": "StochasticSampling"}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x70470debeac0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "offline_data_class": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_read_batch_size": null, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "materialize_data": false, "materialize_mapped_data": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "ignore_final_observation": false, "prelearner_class": null, "prelearner_buffer_class": null, "prelearner_buffer_kwargs": {}, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_remaining_data": false, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": 1, "evaluation_duration": 20, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_auto_duration_min_env_steps_per_sample": 100, "evaluation_auto_duration_max_env_steps_per_sample": 2000, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 1, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "offline_evaluation_interval": null, "num_offline_eval_runners": 0, "offline_loss_for_module_fn": null, "offline_evaluation_duration": 1, "offline_evaluation_parallel_to_training": false, "offline_evaluation_timeout_s": 120.0, "num_cpus_per_offline_eval_runner": 1, "num_gpus_per_offline_eval_runner": 0, "custom_resources_per_offline_eval_runner": {}, "restart_failed_offline_eval_runners": true, "ignore_offline_eval_runner_failures": false, "max_num_offline_eval_runner_restarts": 1000, "offline_eval_runner_restore_timeout_s": 1800.0, "max_requests_in_flight_per_offline_eval_runner": 1, "validate_offline_eval_runners_after_construction": true, "offline_eval_runner_health_probe_timeout_s": 30.0, "offline_eval_rl_module_inference_only": false, "broadcast_offline_eval_runner_states": false, "offline_eval_batch_size_per_runner": 256, "dataset_num_iters_per_eval_runner": 1, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "log_gradients": true, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 42, "restart_failed_env_runners": true, "ignore_env_runner_failures": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30.0, "env_runner_restore_timeout_s": 1800.0, "_model_config": {}, "_rl_module_spec": "RLModuleSpec(module_class=None, observation_space=None, action_space=None, inference_only=False, learner_only=False, model_config=DefaultModelConfig(fcnet_hiddens=[43, 122], fcnet_activation='tanh', fcnet_kernel_initializer=None, fcnet_kernel_initializer_kwargs=None, fcnet_bias_initializer=None, fcnet_bias_initializer_kwargs=None, conv_filters=None, conv_activation='relu', conv_kernel_initializer=None, conv_kernel_initializer_kwargs=None, conv_bias_initializer=None, conv_bias_initializer_kwargs=None, head_fcnet_hiddens=[], head_fcnet_activation='relu', head_fcnet_kernel_initializer=None, head_fcnet_kernel_initializer_kwargs=None, head_fcnet_bias_initializer=None, head_fcnet_bias_initializer_kwargs=None, free_log_std=False, log_std_clip_param=20.0, vf_share_layers=True, use_lstm=False, max_seq_len=20, lstm_cell_size=256, lstm_use_prev_action=False, lstm_use_prev_reward=False, lstm_kernel_initializer=None, lstm_kernel_initializer_kwargs=None, lstm_bias_initializer=None, lstm_bias_initializer_kwargs=None), catalog_class=None, load_state_path=None, model_config_dict=None)", "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "_validate_config": true, "_use_msgpack_checkpoints": false, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "env_task_fn": -1, "enable_connectors": -1, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2617985289524, "kl_target": 0.0294268671804, "vf_loss_coeff": 0.5611379931, "entropy_coeff": 0.0016790048723, "clip_param": 0.1271344785601, "vf_clip_param": 0.2507399863488, "entropy_coeff_schedule": null, "lr_schedule": null, "sgd_minibatch_size": -1, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9822919715622, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.callbacks.callbacks.RLlibCallback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 73.48734259605408, "iterations_since_restore": 15, "perf": {"cpu_util_percent": 12.214285714285714, "ram_util_percent": 87.98571428571428}}
{"timers": {"training_iteration": 4.208822583784171, "restore_env_runners": 1.4139986176573642e-05, "training_step": 4.208511983751187, "env_runner_sampling_timer": 3.815437144335652, "learner_update_timer": 0.3895641629290405, "synch_weights": 0.0014312250391535304, "restore_eval_env_runners": 1.5943799894676303e-05, "evaluation_iteration": 0.7421406593978955, "synch_eval_env_connectors": 0.00040829379817005197, "synch_env_connectors": 7.647198414898013e-06}, "env_runners": {"num_episodes": 100.0, "sample": 0.03732987717388722, "module_to_env_connector": {"timers": {"connectors": {"un_batch_to_individual_items": 1.4497893095275343e-05, "listify_data_for_vector_env": 3.084451052967018e-05, "get_actions": 0.00016419618942998117, "normalize_and_clip_actions": 2.214002088282659e-05, "tensor_to_numpy": 4.8010535507014806e-05, "remove_single_ts_time_rank_from_batch": 1.4263111967240893e-06}}, "connector_pipeline_timer": 0.0003571133528852665}, "agent_episode_returns_mean": {"default_agent": 13.900000000000007}, "num_module_steps_sampled_lifetime": {"default_policy": -3385000.0}, "env_to_module_connector": {"timers": {"connectors": {"batch_individual_items": 1.822742800346394e-05, "add_observations_from_episodes_to_batch": 6.47898148780536e-06, "add_states_from_episodes_to_batch": 3.401518898023176e-06, "numpy_to_tensor": 3.100699296003239e-05, "add_time_dim_to_batch_and_zero_pad": 6.455288633857478e-06}}, "connector_pipeline_timer": 0.00011766861203611444}, "num_episodes_lifetime": -67700.0, "time_between_sampling": 0.011530621496595344, "module_episode_returns_mean": {"default_policy": 13.900000000000007}, "env_to_module_sum_episodes_length_in": 27.16809333212661, "episode_return_min": -5.5, "episode_return_max": 14.5, "num_env_steps_sampled_lifetime": -3385000.0, "rlmodule_inference_timer": 9.960728192191997e-05, "episode_duration_sec_mean": 0.03618790933997844, "num_agent_steps_sampled": {"default_agent": 5000.0}, "num_agent_steps_sampled_lifetime": {"default_agent": -3385000.0}, "env_reset_timer": 9.422513621545986e-05, "episode_return_mean": 13.900000000000007, "weights_seq_no": 15.0, "num_module_steps_sampled": {"default_policy": 5000.0}, "episode_len_min": 50, "env_step_timer": 4.366625586017624e-05, "episode_len_max": 50, "num_env_steps_sampled": 5000.0, "env_to_module_sum_episodes_length_out": 27.16809333212661, "episode_len_mean": 50.0, "num_env_steps_sampled_lifetime_throughput": 1291.9472654776464}, "learners": {"__all_modules__": {"learner_connector": {"timers": {"connectors": {"general_advantage_estimation": 0.012822510199446491, "add_columns_from_episodes_to_train_batch": 0.06901485233837432, "batch_individual_items": 0.19046212024263737, "add_observations_from_episodes_to_batch": 0.0007902698440940196, "numpy_to_tensor": 0.0001628328437727436, "add_states_from_episodes_to_batch": 6.0930250255785425e-06, "add_time_dim_to_batch_and_zero_pad": 2.3449052613857632e-05, "add_one_ts_to_episodes_and_truncate": 0.008154006328704106}}, "connector_pipeline_timer": 0.2817986669695803}, "num_env_steps_trained_lifetime": 489600, "num_non_trainable_parameters": 0, "learner_connector_sum_episodes_length_in": 5000.0, "num_module_steps_trained": 6000, "num_trainable_parameters": 5909, "num_module_steps_trained_lifetime": 96000, "num_env_steps_trained": 30600, "learner_connector_sum_episodes_length_out": 5100.0, "num_env_steps_trained_lifetime_throughput": 828450.3132293383, "num_module_steps_trained_throughput": 162853.04796565665, "num_module_steps_trained_lifetime_throughput": 162744.9534754451}, "default_policy": {"total_loss": -0.048190388828516006, "diff_num_grad_updates_vs_sampler_policy": 1.0, "vf_loss": 0.25074005126953125, "mean_kl_loss": 0.00010274335363646969, "curr_entropy_coeff": 0.0016790048723, "gradients_default_optimizer_global_norm": 0.028622400015592575, "num_module_steps_trained": 6000, "weights_seq_no": 16.0, "entropy": 0.4255148470401764, "num_trainable_parameters": 5909, "module_train_batch_size_mean": 1000.0, "vf_loss_unclipped": 93.9091567993164, "num_module_steps_trained_lifetime": 96000, "vf_explained_var": 0.11821883916854858, "curr_kl_coeff": 3.994728558609495e-06, "policy_loss": -0.18817567825317383, "default_optimizer_learning_rate": 0.0008209260984, "num_module_steps_trained_lifetime_throughput": 162939.93103202982}}, "num_training_step_calls_per_iteration": 1, "evaluation": {"env_runners": {"module_episode_returns_mean": {"default_policy": -2.3}, "module_to_env_connector": {"timers": {"connectors": {"remove_single_ts_time_rank_from_batch": 1.4377640436631168e-06, "listify_data_for_vector_env": 2.9905127089711936e-05, "get_actions": 0.00015235535392187468, "un_batch_to_individual_items": 1.5032138428931312e-05, "normalize_and_clip_actions": 2.118871614174589e-05, "tensor_to_numpy": 4.437710531372466e-05}}, "connector_pipeline_timer": 0.0003404252610928114}, "agent_episode_returns_mean": {"default_agent": -2.3}, "num_env_steps_sampled": 1000, "num_module_steps_sampled": {"default_policy": 1000}, "num_episodes": 20, "env_to_module_connector": {"timers": {"connectors": {"add_observations_from_episodes_to_batch": 6.014421390831421e-06, "add_states_from_episodes_to_batch": 3.545200596452436e-06, "numpy_to_tensor": 2.8657216525524585e-05, "add_time_dim_to_batch_and_zero_pad": 5.8198288546978175e-06, "batch_individual_items": 1.795923598818819e-05}}, "connector_pipeline_timer": 0.00011596300837242778}, "num_module_steps_sampled_lifetime": {"default_policy": 16000}, "num_agent_steps_sampled_lifetime": {"default_agent": 16000}, "num_agent_steps_sampled": {"default_agent": 1000}, "rlmodule_inference_timer": 9.178588300838225e-05, "num_env_steps_sampled_lifetime": 81000, "env_reset_timer": 0.00020096077044366755, "episode_return_mean": -2.3, "weights_seq_no": 16.0, "env_step_timer": 4.115137045354243e-05, "episode_len_max": 50, "episode_len_mean": 50.0, "sample": 0.7304027352809744, "num_episodes_lifetime": 320, "episode_return_min": -16.5, "episode_return_max": 17.5, "episode_duration_sec_mean": 0.03492888030997165, "episode_len_min": 50, "env_to_module_sum_episodes_length_out": 27.168093332126602, "env_to_module_sum_episodes_length_in": 27.168093332126602, "time_between_sampling": 4.166928255887218}, "num_healthy_workers": 1, "actor_manager_num_outstanding_async_reqs": 0, "num_remote_worker_restarts": 0}, "num_env_steps_sampled_lifetime": -3385000.0, "fault_tolerance": {"num_healthy_workers": 0, "num_remote_worker_restarts": 0}, "env_runner_group": {"actor_manager_num_outstanding_async_reqs": 0}, "done": false, "training_iteration": 16, "trial_id": "a54d5_00000", "date": "2025-08-11_17-23-57", "timestamp": 1754925837, "time_this_iter_s": 4.952418565750122, "time_total_s": 78.4397611618042, "pid": 73571, "hostname": "DESKTOP-3SK5A41", "node_ip": "192.168.40.242", "config": {"exploration_config": {}, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 6, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "env": "Umbrella", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": false, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 0, "create_local_env_runner": true, "num_envs_per_env_runner": 1, "gym_env_vectorize_mode": "SYNC", "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "episodes_to_numpy": true, "max_requests_in_flight_per_env_runner": 1, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "merge_env_runner_states": "training_only", "broadcast_env_runner_states": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "complete_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "sampler_perf_stats_ema_coef": null, "_is_online": true, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": "auto", "num_aggregator_actors_per_learner": 0, "max_requests_in_flight_per_aggregator_actor": 3, "local_gpu_idx": 0, "max_requests_in_flight_per_learner": 3, "gamma": 1, "lr": 0.0008209260984, "grad_clip": 0.5, "grad_clip_by": "global_norm", "_train_batch_size_per_learner": 5000, "train_batch_size": 4000, "num_epochs": 1, "minibatch_size": 1000, "shuffle_batch_per_epoch": true, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "log_std_clip_param": 20.0, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "_disable_preprocessor_api": false, "_disable_action_flattening": false}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "_learner_class": null, "callbacks_on_algorithm_init": null, "callbacks_on_env_runners_recreated": null, "callbacks_on_offline_eval_runners_recreated": null, "callbacks_on_checkpoint_loaded": null, "callbacks_on_environment_created": null, "callbacks_on_episode_created": null, "callbacks_on_episode_start": null, "callbacks_on_episode_step": null, "callbacks_on_episode_end": null, "callbacks_on_evaluate_start": null, "callbacks_on_evaluate_end": null, "callbacks_on_evaluate_offline_start": null, "callbacks_on_evaluate_offline_end": null, "callbacks_on_sample_end": null, "callbacks_on_train_result": null, "explore": true, "enable_rl_module_and_learner": true, "enable_env_runner_and_connector_v2": true, "_prior_exploration_config": {"type": "StochasticSampling"}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x70470debeac0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "offline_data_class": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_read_batch_size": null, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "materialize_data": false, "materialize_mapped_data": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "ignore_final_observation": false, "prelearner_class": null, "prelearner_buffer_class": null, "prelearner_buffer_kwargs": {}, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_remaining_data": false, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": 1, "evaluation_duration": 20, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_auto_duration_min_env_steps_per_sample": 100, "evaluation_auto_duration_max_env_steps_per_sample": 2000, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 1, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "offline_evaluation_interval": null, "num_offline_eval_runners": 0, "offline_loss_for_module_fn": null, "offline_evaluation_duration": 1, "offline_evaluation_parallel_to_training": false, "offline_evaluation_timeout_s": 120.0, "num_cpus_per_offline_eval_runner": 1, "num_gpus_per_offline_eval_runner": 0, "custom_resources_per_offline_eval_runner": {}, "restart_failed_offline_eval_runners": true, "ignore_offline_eval_runner_failures": false, "max_num_offline_eval_runner_restarts": 1000, "offline_eval_runner_restore_timeout_s": 1800.0, "max_requests_in_flight_per_offline_eval_runner": 1, "validate_offline_eval_runners_after_construction": true, "offline_eval_runner_health_probe_timeout_s": 30.0, "offline_eval_rl_module_inference_only": false, "broadcast_offline_eval_runner_states": false, "offline_eval_batch_size_per_runner": 256, "dataset_num_iters_per_eval_runner": 1, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "log_gradients": true, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 42, "restart_failed_env_runners": true, "ignore_env_runner_failures": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30.0, "env_runner_restore_timeout_s": 1800.0, "_model_config": {}, "_rl_module_spec": "RLModuleSpec(module_class=None, observation_space=None, action_space=None, inference_only=False, learner_only=False, model_config=DefaultModelConfig(fcnet_hiddens=[43, 122], fcnet_activation='tanh', fcnet_kernel_initializer=None, fcnet_kernel_initializer_kwargs=None, fcnet_bias_initializer=None, fcnet_bias_initializer_kwargs=None, conv_filters=None, conv_activation='relu', conv_kernel_initializer=None, conv_kernel_initializer_kwargs=None, conv_bias_initializer=None, conv_bias_initializer_kwargs=None, head_fcnet_hiddens=[], head_fcnet_activation='relu', head_fcnet_kernel_initializer=None, head_fcnet_kernel_initializer_kwargs=None, head_fcnet_bias_initializer=None, head_fcnet_bias_initializer_kwargs=None, free_log_std=False, log_std_clip_param=20.0, vf_share_layers=True, use_lstm=False, max_seq_len=20, lstm_cell_size=256, lstm_use_prev_action=False, lstm_use_prev_reward=False, lstm_kernel_initializer=None, lstm_kernel_initializer_kwargs=None, lstm_bias_initializer=None, lstm_bias_initializer_kwargs=None), catalog_class=None, load_state_path=None, model_config_dict=None)", "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "_validate_config": true, "_use_msgpack_checkpoints": false, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "env_task_fn": -1, "enable_connectors": -1, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2617985289524, "kl_target": 0.0294268671804, "vf_loss_coeff": 0.5611379931, "entropy_coeff": 0.0016790048723, "clip_param": 0.1271344785601, "vf_clip_param": 0.2507399863488, "entropy_coeff_schedule": null, "lr_schedule": null, "sgd_minibatch_size": -1, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9822919715622, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.callbacks.callbacks.RLlibCallback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 78.4397611618042, "iterations_since_restore": 16, "perf": {"cpu_util_percent": 12.02857142857143, "ram_util_percent": 88.0}}
{"timers": {"training_iteration": 4.2073212374563305, "restore_env_runners": 1.4106586318627958e-05, "training_step": 4.2070101804236675, "env_runner_sampling_timer": 3.8159793494222964, "learner_update_timer": 0.387519941279753, "synch_weights": 0.0014299557887610108, "restore_eval_env_runners": 1.5901361895320456e-05, "evaluation_iteration": 0.7421567367139148, "synch_eval_env_connectors": 0.00040940586019171994, "synch_env_connectors": 7.633726428429923e-06}, "env_runners": {"num_episodes": 100.0, "sample": 0.03725183929457063, "module_to_env_connector": {"timers": {"connectors": {"un_batch_to_individual_items": 1.4573689736797737e-05, "listify_data_for_vector_env": 3.0838909129555456e-05, "get_actions": 0.00016386319262081742, "normalize_and_clip_actions": 2.215671897572101e-05, "tensor_to_numpy": 4.805818804564284e-05, "remove_single_ts_time_rank_from_batch": 1.4254346937625388e-06}}, "connector_pipeline_timer": 0.0003570253289843231}, "agent_episode_returns_mean": {"default_agent": 13.7}, "num_module_steps_sampled_lifetime": {"default_policy": -3627500.0}, "env_to_module_connector": {"timers": {"connectors": {"batch_individual_items": 1.827645158192499e-05, "add_observations_from_episodes_to_batch": 6.544900054235104e-06, "add_states_from_episodes_to_batch": 3.403138557294357e-06, "numpy_to_tensor": 3.095403858743969e-05, "add_time_dim_to_batch_and_zero_pad": 6.457203429970716e-06}}, "connector_pipeline_timer": 0.00011784258829815387}, "num_episodes_lifetime": -72550.0, "time_between_sampling": 0.012260942798518313, "module_episode_returns_mean": {"default_policy": 13.7}, "env_to_module_sum_episodes_length_in": 27.16809333212661, "episode_return_min": -5.5, "episode_return_max": 14.5, "num_env_steps_sampled_lifetime": -3627500.0, "rlmodule_inference_timer": 9.875486006622367e-05, "episode_duration_sec_mean": 0.03614241058007792, "num_agent_steps_sampled": {"default_agent": 5000.0}, "num_agent_steps_sampled_lifetime": {"default_agent": -3627500.0}, "env_reset_timer": 9.37991457135334e-05, "episode_return_mean": 13.7, "weights_seq_no": 16.0, "num_module_steps_sampled": {"default_policy": 5000.0}, "episode_len_min": 50, "env_step_timer": 4.3561346631769686e-05, "episode_len_max": 50, "num_env_steps_sampled": 5000.0, "env_to_module_sum_episodes_length_out": 27.16809333212661, "episode_len_mean": 50.0, "num_env_steps_sampled_lifetime_throughput": 1292.6019476218157}, "learners": {"__all_modules__": {"learner_connector": {"timers": {"connectors": {"general_advantage_estimation": 0.012794636097452981, "add_columns_from_episodes_to_train_batch": 0.06900668680499017, "batch_individual_items": 0.18913466803021398, "add_observations_from_episodes_to_batch": 0.000789251145657072, "numpy_to_tensor": 0.0001629605153364944, "add_states_from_episodes_to_batch": 6.083094781674144e-06, "add_time_dim_to_batch_and_zero_pad": 2.3446562089861796e-05, "add_one_ts_to_episodes_and_truncate": 0.008153459265418465}}, "connector_pipeline_timer": 0.2804329752798838}, "num_env_steps_trained_lifetime": 520200, "num_non_trainable_parameters": 0, "learner_connector_sum_episodes_length_in": 5000.0, "num_module_steps_trained": 6000, "num_trainable_parameters": 5909, "num_module_steps_trained_lifetime": 102000, "num_env_steps_trained": 30600, "learner_connector_sum_episodes_length_out": 5100.0, "num_env_steps_trained_lifetime_throughput": 824769.1022237553, "num_module_steps_trained_throughput": 162120.80316974997, "num_module_steps_trained_lifetime_throughput": 162013.9337523831}, "default_policy": {"total_loss": -0.07404356449842453, "diff_num_grad_updates_vs_sampler_policy": 1.0, "vf_loss": 0.25074005126953125, "mean_kl_loss": 0.0003624328237492591, "curr_entropy_coeff": 0.0016790048723, "gradients_default_optimizer_global_norm": 0.041268669068813324, "num_module_steps_trained": 6000, "weights_seq_no": 17.0, "entropy": 0.4063515067100525, "num_trainable_parameters": 5909, "module_train_batch_size_mean": 1000.0, "vf_loss_unclipped": 94.10529327392578, "num_module_steps_trained_lifetime": 102000, "vf_explained_var": 0.11844176054000854, "curr_kl_coeff": 1.9973642793047475e-06, "policy_loss": -0.21406102180480957, "default_optimizer_learning_rate": 0.0008209260984, "num_module_steps_trained_lifetime_throughput": 162193.09331733276}}, "num_training_step_calls_per_iteration": 1, "evaluation": {"env_runners": {"module_episode_returns_mean": {"default_policy": -1.9}, "module_to_env_connector": {"timers": {"connectors": {"remove_single_ts_time_rank_from_batch": 1.4195914189703566e-06, "listify_data_for_vector_env": 3.0189577210957625e-05, "get_actions": 0.00015135999309573477, "un_batch_to_individual_items": 1.5199921810240913e-05, "normalize_and_clip_actions": 2.1831886648826088e-05, "tensor_to_numpy": 4.444099006087313e-05}}, "connector_pipeline_timer": 0.00034145209369164424}, "agent_episode_returns_mean": {"default_agent": -1.9}, "num_env_steps_sampled": 1000, "num_module_steps_sampled": {"default_policy": 1000}, "num_episodes": 20, "env_to_module_connector": {"timers": {"connectors": {"add_observations_from_episodes_to_batch": 6.040703663343037e-06, "add_states_from_episodes_to_batch": 3.3626661483094402e-06, "numpy_to_tensor": 2.892977864579654e-05, "add_time_dim_to_batch_and_zero_pad": 5.890505064922452e-06, "batch_individual_items": 1.7787820541970803e-05}}, "connector_pipeline_timer": 0.00011604809242549613}, "num_module_steps_sampled_lifetime": {"default_policy": 17000}, "num_agent_steps_sampled_lifetime": {"default_agent": 17000}, "num_agent_steps_sampled": {"default_agent": 1000}, "rlmodule_inference_timer": 9.424171301356923e-05, "num_env_steps_sampled_lifetime": 86000, "env_reset_timer": 0.0002001981627393794, "episode_return_mean": -1.9, "weights_seq_no": 17.0, "env_step_timer": 4.072048763842843e-05, "episode_len_max": 50, "episode_len_mean": 50.0, "sample": 0.7303842028881615, "num_episodes_lifetime": 340, "episode_return_min": -16.5, "episode_return_max": 17.5, "episode_duration_sec_mean": 0.034960208230004355, "episode_len_min": 50, "env_to_module_sum_episodes_length_out": 27.168093332126602, "env_to_module_sum_episodes_length_in": 27.168093332126602, "time_between_sampling": 4.1663915128283495}, "num_healthy_workers": 1, "actor_manager_num_outstanding_async_reqs": 0, "num_remote_worker_restarts": 0}, "num_env_steps_sampled_lifetime": -3627500.0, "fault_tolerance": {"num_healthy_workers": 0, "num_remote_worker_restarts": 0}, "env_runner_group": {"actor_manager_num_outstanding_async_reqs": 0}, "done": false, "training_iteration": 17, "trial_id": "a54d5_00000", "date": "2025-08-11_17-24-02", "timestamp": 1754925842, "time_this_iter_s": 4.801887273788452, "time_total_s": 83.24164843559265, "pid": 73571, "hostname": "DESKTOP-3SK5A41", "node_ip": "192.168.40.242", "config": {"exploration_config": {}, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 6, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "env": "Umbrella", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": false, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 0, "create_local_env_runner": true, "num_envs_per_env_runner": 1, "gym_env_vectorize_mode": "SYNC", "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "episodes_to_numpy": true, "max_requests_in_flight_per_env_runner": 1, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "merge_env_runner_states": "training_only", "broadcast_env_runner_states": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "complete_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "sampler_perf_stats_ema_coef": null, "_is_online": true, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": "auto", "num_aggregator_actors_per_learner": 0, "max_requests_in_flight_per_aggregator_actor": 3, "local_gpu_idx": 0, "max_requests_in_flight_per_learner": 3, "gamma": 1, "lr": 0.0008209260984, "grad_clip": 0.5, "grad_clip_by": "global_norm", "_train_batch_size_per_learner": 5000, "train_batch_size": 4000, "num_epochs": 1, "minibatch_size": 1000, "shuffle_batch_per_epoch": true, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "log_std_clip_param": 20.0, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "_disable_preprocessor_api": false, "_disable_action_flattening": false}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "_learner_class": null, "callbacks_on_algorithm_init": null, "callbacks_on_env_runners_recreated": null, "callbacks_on_offline_eval_runners_recreated": null, "callbacks_on_checkpoint_loaded": null, "callbacks_on_environment_created": null, "callbacks_on_episode_created": null, "callbacks_on_episode_start": null, "callbacks_on_episode_step": null, "callbacks_on_episode_end": null, "callbacks_on_evaluate_start": null, "callbacks_on_evaluate_end": null, "callbacks_on_evaluate_offline_start": null, "callbacks_on_evaluate_offline_end": null, "callbacks_on_sample_end": null, "callbacks_on_train_result": null, "explore": true, "enable_rl_module_and_learner": true, "enable_env_runner_and_connector_v2": true, "_prior_exploration_config": {"type": "StochasticSampling"}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x70470debeac0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "offline_data_class": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_read_batch_size": null, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "materialize_data": false, "materialize_mapped_data": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "ignore_final_observation": false, "prelearner_class": null, "prelearner_buffer_class": null, "prelearner_buffer_kwargs": {}, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_remaining_data": false, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": 1, "evaluation_duration": 20, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_auto_duration_min_env_steps_per_sample": 100, "evaluation_auto_duration_max_env_steps_per_sample": 2000, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 1, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "offline_evaluation_interval": null, "num_offline_eval_runners": 0, "offline_loss_for_module_fn": null, "offline_evaluation_duration": 1, "offline_evaluation_parallel_to_training": false, "offline_evaluation_timeout_s": 120.0, "num_cpus_per_offline_eval_runner": 1, "num_gpus_per_offline_eval_runner": 0, "custom_resources_per_offline_eval_runner": {}, "restart_failed_offline_eval_runners": true, "ignore_offline_eval_runner_failures": false, "max_num_offline_eval_runner_restarts": 1000, "offline_eval_runner_restore_timeout_s": 1800.0, "max_requests_in_flight_per_offline_eval_runner": 1, "validate_offline_eval_runners_after_construction": true, "offline_eval_runner_health_probe_timeout_s": 30.0, "offline_eval_rl_module_inference_only": false, "broadcast_offline_eval_runner_states": false, "offline_eval_batch_size_per_runner": 256, "dataset_num_iters_per_eval_runner": 1, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "log_gradients": true, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 42, "restart_failed_env_runners": true, "ignore_env_runner_failures": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30.0, "env_runner_restore_timeout_s": 1800.0, "_model_config": {}, "_rl_module_spec": "RLModuleSpec(module_class=None, observation_space=None, action_space=None, inference_only=False, learner_only=False, model_config=DefaultModelConfig(fcnet_hiddens=[43, 122], fcnet_activation='tanh', fcnet_kernel_initializer=None, fcnet_kernel_initializer_kwargs=None, fcnet_bias_initializer=None, fcnet_bias_initializer_kwargs=None, conv_filters=None, conv_activation='relu', conv_kernel_initializer=None, conv_kernel_initializer_kwargs=None, conv_bias_initializer=None, conv_bias_initializer_kwargs=None, head_fcnet_hiddens=[], head_fcnet_activation='relu', head_fcnet_kernel_initializer=None, head_fcnet_kernel_initializer_kwargs=None, head_fcnet_bias_initializer=None, head_fcnet_bias_initializer_kwargs=None, free_log_std=False, log_std_clip_param=20.0, vf_share_layers=True, use_lstm=False, max_seq_len=20, lstm_cell_size=256, lstm_use_prev_action=False, lstm_use_prev_reward=False, lstm_kernel_initializer=None, lstm_kernel_initializer_kwargs=None, lstm_bias_initializer=None, lstm_bias_initializer_kwargs=None), catalog_class=None, load_state_path=None, model_config_dict=None)", "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "_validate_config": true, "_use_msgpack_checkpoints": false, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "env_task_fn": -1, "enable_connectors": -1, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2617985289524, "kl_target": 0.0294268671804, "vf_loss_coeff": 0.5611379931, "entropy_coeff": 0.0016790048723, "clip_param": 0.1271344785601, "vf_clip_param": 0.2507399863488, "entropy_coeff_schedule": null, "lr_schedule": null, "sgd_minibatch_size": -1, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9822919715622, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.callbacks.callbacks.RLlibCallback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 83.24164843559265, "iterations_since_restore": 17, "perf": {"cpu_util_percent": 12.542857142857144, "ram_util_percent": 88.0}}
{"timers": {"training_iteration": 4.207100693131772, "restore_env_runners": 1.407852046095441e-05, "training_step": 4.206789209669425, "env_runner_sampling_timer": 3.8164429629680776, "learner_update_timer": 0.3868334368769497, "synch_weights": 0.0014317772308721484, "restore_eval_env_runners": 1.586134827299726e-05, "evaluation_iteration": 0.7421162093067762, "synch_eval_env_connectors": 0.00040881280158175934, "synch_env_connectors": 7.616389158653381e-06}, "env_runners": {"num_episodes": 100.0, "sample": 0.03718842113595491, "module_to_env_connector": {"timers": {"connectors": {"un_batch_to_individual_items": 1.4547363601167332e-05, "listify_data_for_vector_env": 3.060425033148961e-05, "get_actions": 0.0001640819503303092, "normalize_and_clip_actions": 2.1962675069725235e-05, "tensor_to_numpy": 4.7796453560740914e-05, "remove_single_ts_time_rank_from_batch": 1.4202566075704322e-06}}, "connector_pipeline_timer": 0.00035658176421984254}, "agent_episode_returns_mean": {"default_agent": 13.5}, "num_module_steps_sampled_lifetime": {"default_policy": -3870000.0}, "env_to_module_connector": {"timers": {"connectors": {"batch_individual_items": 1.8214138303063404e-05, "add_observations_from_episodes_to_batch": 6.517285862042596e-06, "add_states_from_episodes_to_batch": 3.398723644873437e-06, "numpy_to_tensor": 3.098339543962643e-05, "add_time_dim_to_batch_and_zero_pad": 6.465600073614398e-06}}, "connector_pipeline_timer": 0.00011772239909256453}, "num_episodes_lifetime": -77400.0, "time_between_sampling": 0.011585854205865338, "module_episode_returns_mean": {"default_policy": 13.5}, "env_to_module_sum_episodes_length_in": 27.16809333212661, "episode_return_min": -5.5, "episode_return_max": 14.5, "num_env_steps_sampled_lifetime": -3870000.0, "rlmodule_inference_timer": 9.911394567095724e-05, "episode_duration_sec_mean": 0.036109535040040996, "num_agent_steps_sampled": {"default_agent": 5000.0}, "num_agent_steps_sampled_lifetime": {"default_agent": -3870000.0}, "env_reset_timer": 9.268708179314794e-05, "episode_return_mean": 13.5, "weights_seq_no": 17.0, "num_module_steps_sampled": {"default_policy": 5000.0}, "episode_len_min": 50, "env_step_timer": 4.353735904934177e-05, "episode_len_max": 50, "num_env_steps_sampled": 5000.0, "env_to_module_sum_episodes_length_out": 27.16809333212661, "episode_len_mean": 50.0, "num_env_steps_sampled_lifetime_throughput": 1294.8455254607015}, "learners": {"__all_modules__": {"learner_connector": {"timers": {"connectors": {"general_advantage_estimation": 0.012751926736481414, "add_columns_from_episodes_to_train_batch": 0.06900586693694052, "batch_individual_items": 0.18924545835991577, "add_observations_from_episodes_to_batch": 0.0007882546342049186, "numpy_to_tensor": 0.00016303391019031215, "add_states_from_episodes_to_batch": 6.076263826672482e-06, "add_time_dim_to_batch_and_zero_pad": 2.342009647025702e-05, "add_one_ts_to_episodes_and_truncate": 0.008155764672761788}}, "connector_pipeline_timer": 0.280500903537087}, "num_env_steps_trained_lifetime": 550800, "num_non_trainable_parameters": 0, "learner_connector_sum_episodes_length_in": 5000.0, "num_module_steps_trained": 6000, "num_trainable_parameters": 5909, "num_module_steps_trained_lifetime": 108000, "num_env_steps_trained": 30600, "learner_connector_sum_episodes_length_out": 5100.0, "num_env_steps_trained_lifetime_throughput": 823292.9829017641, "num_module_steps_trained_throughput": 161820.27856383196, "num_module_steps_trained_lifetime_throughput": 161714.0553363192}, "default_policy": {"total_loss": 0.013754610903561115, "diff_num_grad_updates_vs_sampler_policy": 1.0, "vf_loss": 0.24898704886436462, "mean_kl_loss": 0.001331925275735557, "curr_entropy_coeff": 0.0016790048723, "gradients_default_optimizer_global_norm": 0.026778612285852432, "num_module_steps_trained": 6000, "weights_seq_no": 18.0, "entropy": 0.3645665645599365, "num_trainable_parameters": 5909, "module_train_batch_size_mean": 1000.0, "vf_loss_unclipped": 92.20857238769531, "num_module_steps_trained_lifetime": 108000, "vf_explained_var": 0.1153523325920105, "curr_kl_coeff": 9.986821396523737e-07, "policy_loss": -0.12534934282302856, "default_optimizer_learning_rate": 0.0008209260984, "num_module_steps_trained_lifetime_throughput": 161876.04243147178}}, "num_training_step_calls_per_iteration": 1, "evaluation": {"env_runners": {"module_episode_returns_mean": {"default_policy": -1.9}, "module_to_env_connector": {"timers": {"connectors": {"remove_single_ts_time_rank_from_batch": 1.3917112476441986e-06, "listify_data_for_vector_env": 3.073654421427684e-05, "get_actions": 0.00015340337515013926, "un_batch_to_individual_items": 1.5196236339551745e-05, "normalize_and_clip_actions": 2.162336981347501e-05, "tensor_to_numpy": 4.488749113580827e-05}}, "connector_pipeline_timer": 0.0003452203748341499}, "agent_episode_returns_mean": {"default_agent": -1.9}, "num_env_steps_sampled": 1000, "num_module_steps_sampled": {"default_policy": 1000}, "num_episodes": 20, "env_to_module_connector": {"timers": {"connectors": {"add_observations_from_episodes_to_batch": 6.121292039742479e-06, "add_states_from_episodes_to_batch": 3.3633254239300532e-06, "numpy_to_tensor": 2.9452874367314353e-05, "add_time_dim_to_batch_and_zero_pad": 5.997305361276156e-06, "batch_individual_items": 1.7563122144952516e-05}}, "connector_pipeline_timer": 0.00011619347763370016}, "num_module_steps_sampled_lifetime": {"default_policy": 18000}, "num_agent_steps_sampled_lifetime": {"default_agent": 18000}, "num_agent_steps_sampled": {"default_agent": 1000}, "rlmodule_inference_timer": 9.501249146441439e-05, "num_env_steps_sampled_lifetime": 91000, "env_reset_timer": 0.00019940318110768767, "episode_return_mean": -1.9, "weights_seq_no": 18.0, "env_step_timer": 4.164414746476368e-05, "episode_len_max": 50, "episode_len_mean": 50.0, "sample": 0.730404239859285, "num_episodes_lifetime": 360, "episode_return_min": -16.5, "episode_return_max": 17.5, "episode_duration_sec_mean": 0.034997308450019776, "episode_len_min": 50, "env_to_module_sum_episodes_length_out": 27.168093332126602, "env_to_module_sum_episodes_length_in": 27.168093332126602, "time_between_sampling": 4.167128794750069}, "num_healthy_workers": 1, "actor_manager_num_outstanding_async_reqs": 0, "num_remote_worker_restarts": 0}, "num_env_steps_sampled_lifetime": -3870000.0, "fault_tolerance": {"num_healthy_workers": 0, "num_remote_worker_restarts": 0}, "env_runner_group": {"actor_manager_num_outstanding_async_reqs": 0}, "done": false, "training_iteration": 18, "trial_id": "a54d5_00000", "date": "2025-08-11_17-24-07", "timestamp": 1754925847, "time_this_iter_s": 4.931638240814209, "time_total_s": 88.17328667640686, "pid": 73571, "hostname": "DESKTOP-3SK5A41", "node_ip": "192.168.40.242", "config": {"exploration_config": {}, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 6, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "env": "Umbrella", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": false, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 0, "create_local_env_runner": true, "num_envs_per_env_runner": 1, "gym_env_vectorize_mode": "SYNC", "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "episodes_to_numpy": true, "max_requests_in_flight_per_env_runner": 1, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "merge_env_runner_states": "training_only", "broadcast_env_runner_states": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "complete_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "sampler_perf_stats_ema_coef": null, "_is_online": true, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": "auto", "num_aggregator_actors_per_learner": 0, "max_requests_in_flight_per_aggregator_actor": 3, "local_gpu_idx": 0, "max_requests_in_flight_per_learner": 3, "gamma": 1, "lr": 0.0008209260984, "grad_clip": 0.5, "grad_clip_by": "global_norm", "_train_batch_size_per_learner": 5000, "train_batch_size": 4000, "num_epochs": 1, "minibatch_size": 1000, "shuffle_batch_per_epoch": true, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "log_std_clip_param": 20.0, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "_disable_preprocessor_api": false, "_disable_action_flattening": false}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "_learner_class": null, "callbacks_on_algorithm_init": null, "callbacks_on_env_runners_recreated": null, "callbacks_on_offline_eval_runners_recreated": null, "callbacks_on_checkpoint_loaded": null, "callbacks_on_environment_created": null, "callbacks_on_episode_created": null, "callbacks_on_episode_start": null, "callbacks_on_episode_step": null, "callbacks_on_episode_end": null, "callbacks_on_evaluate_start": null, "callbacks_on_evaluate_end": null, "callbacks_on_evaluate_offline_start": null, "callbacks_on_evaluate_offline_end": null, "callbacks_on_sample_end": null, "callbacks_on_train_result": null, "explore": true, "enable_rl_module_and_learner": true, "enable_env_runner_and_connector_v2": true, "_prior_exploration_config": {"type": "StochasticSampling"}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x70470debeac0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "offline_data_class": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_read_batch_size": null, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "materialize_data": false, "materialize_mapped_data": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "ignore_final_observation": false, "prelearner_class": null, "prelearner_buffer_class": null, "prelearner_buffer_kwargs": {}, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_remaining_data": false, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": 1, "evaluation_duration": 20, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_auto_duration_min_env_steps_per_sample": 100, "evaluation_auto_duration_max_env_steps_per_sample": 2000, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 1, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "offline_evaluation_interval": null, "num_offline_eval_runners": 0, "offline_loss_for_module_fn": null, "offline_evaluation_duration": 1, "offline_evaluation_parallel_to_training": false, "offline_evaluation_timeout_s": 120.0, "num_cpus_per_offline_eval_runner": 1, "num_gpus_per_offline_eval_runner": 0, "custom_resources_per_offline_eval_runner": {}, "restart_failed_offline_eval_runners": true, "ignore_offline_eval_runner_failures": false, "max_num_offline_eval_runner_restarts": 1000, "offline_eval_runner_restore_timeout_s": 1800.0, "max_requests_in_flight_per_offline_eval_runner": 1, "validate_offline_eval_runners_after_construction": true, "offline_eval_runner_health_probe_timeout_s": 30.0, "offline_eval_rl_module_inference_only": false, "broadcast_offline_eval_runner_states": false, "offline_eval_batch_size_per_runner": 256, "dataset_num_iters_per_eval_runner": 1, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "log_gradients": true, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 42, "restart_failed_env_runners": true, "ignore_env_runner_failures": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30.0, "env_runner_restore_timeout_s": 1800.0, "_model_config": {}, "_rl_module_spec": "RLModuleSpec(module_class=None, observation_space=None, action_space=None, inference_only=False, learner_only=False, model_config=DefaultModelConfig(fcnet_hiddens=[43, 122], fcnet_activation='tanh', fcnet_kernel_initializer=None, fcnet_kernel_initializer_kwargs=None, fcnet_bias_initializer=None, fcnet_bias_initializer_kwargs=None, conv_filters=None, conv_activation='relu', conv_kernel_initializer=None, conv_kernel_initializer_kwargs=None, conv_bias_initializer=None, conv_bias_initializer_kwargs=None, head_fcnet_hiddens=[], head_fcnet_activation='relu', head_fcnet_kernel_initializer=None, head_fcnet_kernel_initializer_kwargs=None, head_fcnet_bias_initializer=None, head_fcnet_bias_initializer_kwargs=None, free_log_std=False, log_std_clip_param=20.0, vf_share_layers=True, use_lstm=False, max_seq_len=20, lstm_cell_size=256, lstm_use_prev_action=False, lstm_use_prev_reward=False, lstm_kernel_initializer=None, lstm_kernel_initializer_kwargs=None, lstm_bias_initializer=None, lstm_bias_initializer_kwargs=None), catalog_class=None, load_state_path=None, model_config_dict=None)", "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "_validate_config": true, "_use_msgpack_checkpoints": false, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "env_task_fn": -1, "enable_connectors": -1, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2617985289524, "kl_target": 0.0294268671804, "vf_loss_coeff": 0.5611379931, "entropy_coeff": 0.0016790048723, "clip_param": 0.1271344785601, "vf_clip_param": 0.2507399863488, "entropy_coeff_schedule": null, "lr_schedule": null, "sgd_minibatch_size": -1, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9822919715622, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.callbacks.callbacks.RLlibCallback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 88.17328667640686, "iterations_since_restore": 18, "perf": {"cpu_util_percent": 12.614285714285714, "ram_util_percent": 88.0}}
{"timers": {"training_iteration": 4.205703375330454, "restore_env_runners": 1.4045735260164919e-05, "training_step": 4.205391555702726, "env_runner_sampling_timer": 3.817087855458402, "learner_update_timer": 0.38479001351817893, "synch_weights": 0.00143092945855784, "restore_eval_env_runners": 1.581573479578002e-05, "evaluation_iteration": 0.7421167892137053, "synch_eval_env_connectors": 0.00040874467356261346, "synch_env_connectors": 7.604225272362231e-06}, "env_runners": {"num_episodes": 100.0, "sample": 0.03722635490675803, "module_to_env_connector": {"timers": {"connectors": {"un_batch_to_individual_items": 1.459958563060762e-05, "listify_data_for_vector_env": 3.0882900050785035e-05, "get_actions": 0.0001643236335328769, "normalize_and_clip_actions": 2.2312964968085048e-05, "tensor_to_numpy": 4.816745760790611e-05, "remove_single_ts_time_rank_from_batch": 1.4196632369394065e-06}}, "connector_pipeline_timer": 0.00035810017070277746}, "agent_episode_returns_mean": {"default_agent": 13.7}, "num_module_steps_sampled_lifetime": {"default_policy": -4112500.0}, "env_to_module_connector": {"timers": {"connectors": {"batch_individual_items": 1.8329928161924797e-05, "add_observations_from_episodes_to_batch": 6.522280732360591e-06, "add_states_from_episodes_to_batch": 3.392543563604849e-06, "numpy_to_tensor": 3.104583672740547e-05, "add_time_dim_to_batch_and_zero_pad": 6.500840311568716e-06}}, "connector_pipeline_timer": 0.00011816505009110594}, "num_episodes_lifetime": -82250.0, "time_between_sampling": 0.012209804446529984, "module_episode_returns_mean": {"default_policy": 13.7}, "env_to_module_sum_episodes_length_in": 27.16809333212661, "episode_return_min": -5.5, "episode_return_max": 14.5, "num_env_steps_sampled_lifetime": -4112500.0, "rlmodule_inference_timer": 9.936518568196326e-05, "episode_duration_sec_mean": 0.03625873311998475, "num_agent_steps_sampled": {"default_agent": 5000.0}, "num_agent_steps_sampled_lifetime": {"default_agent": -4112500.0}, "env_reset_timer": 9.313079780169568e-05, "episode_return_mean": 13.7, "weights_seq_no": 18.0, "num_module_steps_sampled": {"default_policy": 5000.0}, "episode_len_min": 50, "env_step_timer": 4.364950067738325e-05, "episode_len_max": 50, "num_env_steps_sampled": 5000.0, "env_to_module_sum_episodes_length_out": 27.16809333212661, "episode_len_mean": 50.0, "num_env_steps_sampled_lifetime_throughput": 1290.0323458779535}, "learners": {"__all_modules__": {"learner_connector": {"timers": {"connectors": {"general_advantage_estimation": 0.012718081469116337, "add_columns_from_episodes_to_train_batch": 0.06900076926757742, "batch_individual_items": 0.18793121778631844, "add_observations_from_episodes_to_batch": 0.0007872590878624208, "numpy_to_tensor": 0.00016302357109114013, "add_states_from_episodes_to_batch": 6.069501190315783e-06, "add_time_dim_to_batch_and_zero_pad": 2.3421895510870324e-05, "add_one_ts_to_episodes_and_truncate": 0.008156678026039341}}, "connector_pipeline_timer": 0.2791470045117187}, "num_env_steps_trained_lifetime": 581400, "num_non_trainable_parameters": 0, "learner_connector_sum_episodes_length_in": 5000.0, "num_module_steps_trained": 6000, "num_trainable_parameters": 5909, "num_module_steps_trained_lifetime": 114000, "num_env_steps_trained": 30600, "learner_connector_sum_episodes_length_out": 5100.0, "num_env_steps_trained_lifetime_throughput": 821250.8443071868, "num_module_steps_trained_throughput": 161410.72956048363, "num_module_steps_trained_lifetime_throughput": 161305.37946735974}, "default_policy": {"total_loss": -0.07294704765081406, "diff_num_grad_updates_vs_sampler_policy": 1.0, "vf_loss": 0.25074005126953125, "mean_kl_loss": 0.00031862041214480996, "curr_entropy_coeff": 0.0016790048723, "gradients_default_optimizer_global_norm": 0.021885689347982407, "num_module_steps_trained": 6000, "weights_seq_no": 19.0, "entropy": 0.34613943099975586, "num_trainable_parameters": 5909, "module_train_batch_size_mean": 1000.0, "vf_loss_unclipped": 94.62884521484375, "num_module_steps_trained_lifetime": 114000, "vf_explained_var": 0.11954152584075928, "curr_kl_coeff": 4.993410698261869e-07, "policy_loss": -0.21306559443473816, "default_optimizer_learning_rate": 0.0008209260984, "num_module_steps_trained_lifetime_throughput": 161451.30128159307}}, "num_training_step_calls_per_iteration": 1, "evaluation": {"env_runners": {"module_episode_returns_mean": {"default_policy": -1.3}, "module_to_env_connector": {"timers": {"connectors": {"remove_single_ts_time_rank_from_batch": 1.3719803224029098e-06, "listify_data_for_vector_env": 3.0392782256831742e-05, "get_actions": 0.00015406145887152833, "un_batch_to_individual_items": 1.5220894565595116e-05, "normalize_and_clip_actions": 2.1167415261044202e-05, "tensor_to_numpy": 4.515978065181723e-05}}, "connector_pipeline_timer": 0.0003447842885930788}, "agent_episode_returns_mean": {"default_agent": -1.3}, "num_env_steps_sampled": 1000, "num_module_steps_sampled": {"default_policy": 1000}, "num_episodes": 20, "env_to_module_connector": {"timers": {"connectors": {"add_observations_from_episodes_to_batch": 6.056584325102097e-06, "add_states_from_episodes_to_batch": 3.3139604823324125e-06, "numpy_to_tensor": 2.8941607709686003e-05, "add_time_dim_to_batch_and_zero_pad": 6.022276477972048e-06, "batch_individual_items": 1.7851392443453747e-05}}, "connector_pipeline_timer": 0.00011681722598350696}, "num_module_steps_sampled_lifetime": {"default_policy": 19000}, "num_agent_steps_sampled_lifetime": {"default_agent": 19000}, "num_agent_steps_sampled": {"default_agent": 1000}, "rlmodule_inference_timer": 9.510071852957822e-05, "num_env_steps_sampled_lifetime": 96000, "env_reset_timer": 0.0001986411492916813, "episode_return_mean": -1.3, "weights_seq_no": 19.0, "env_step_timer": 4.146403816347191e-05, "episode_len_max": 50, "episode_len_mean": 50.0, "sample": 0.7304068535106969, "num_episodes_lifetime": 380, "episode_return_min": -16.5, "episode_return_max": 17.5, "episode_duration_sec_mean": 0.03506335571001728, "episode_len_min": 50, "env_to_module_sum_episodes_length_out": 27.168093332126602, "env_to_module_sum_episodes_length_in": 27.168093332126602, "time_between_sampling": 4.166700499932568}, "num_healthy_workers": 1, "actor_manager_num_outstanding_async_reqs": 0, "num_remote_worker_restarts": 0}, "num_env_steps_sampled_lifetime": -4112500.0, "fault_tolerance": {"num_healthy_workers": 0, "num_remote_worker_restarts": 0}, "env_runner_group": {"actor_manager_num_outstanding_async_reqs": 0}, "done": false, "training_iteration": 19, "trial_id": "a54d5_00000", "date": "2025-08-11_17-24-12", "timestamp": 1754925852, "time_this_iter_s": 4.812806129455566, "time_total_s": 92.98609280586243, "pid": 73571, "hostname": "DESKTOP-3SK5A41", "node_ip": "192.168.40.242", "config": {"exploration_config": {}, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 6, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "env": "Umbrella", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": false, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 0, "create_local_env_runner": true, "num_envs_per_env_runner": 1, "gym_env_vectorize_mode": "SYNC", "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "episodes_to_numpy": true, "max_requests_in_flight_per_env_runner": 1, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "merge_env_runner_states": "training_only", "broadcast_env_runner_states": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "complete_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "sampler_perf_stats_ema_coef": null, "_is_online": true, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": "auto", "num_aggregator_actors_per_learner": 0, "max_requests_in_flight_per_aggregator_actor": 3, "local_gpu_idx": 0, "max_requests_in_flight_per_learner": 3, "gamma": 1, "lr": 0.0008209260984, "grad_clip": 0.5, "grad_clip_by": "global_norm", "_train_batch_size_per_learner": 5000, "train_batch_size": 4000, "num_epochs": 1, "minibatch_size": 1000, "shuffle_batch_per_epoch": true, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "log_std_clip_param": 20.0, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "_disable_preprocessor_api": false, "_disable_action_flattening": false}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "_learner_class": null, "callbacks_on_algorithm_init": null, "callbacks_on_env_runners_recreated": null, "callbacks_on_offline_eval_runners_recreated": null, "callbacks_on_checkpoint_loaded": null, "callbacks_on_environment_created": null, "callbacks_on_episode_created": null, "callbacks_on_episode_start": null, "callbacks_on_episode_step": null, "callbacks_on_episode_end": null, "callbacks_on_evaluate_start": null, "callbacks_on_evaluate_end": null, "callbacks_on_evaluate_offline_start": null, "callbacks_on_evaluate_offline_end": null, "callbacks_on_sample_end": null, "callbacks_on_train_result": null, "explore": true, "enable_rl_module_and_learner": true, "enable_env_runner_and_connector_v2": true, "_prior_exploration_config": {"type": "StochasticSampling"}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x70470debeac0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "offline_data_class": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_read_batch_size": null, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "materialize_data": false, "materialize_mapped_data": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "ignore_final_observation": false, "prelearner_class": null, "prelearner_buffer_class": null, "prelearner_buffer_kwargs": {}, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_remaining_data": false, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": 1, "evaluation_duration": 20, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_auto_duration_min_env_steps_per_sample": 100, "evaluation_auto_duration_max_env_steps_per_sample": 2000, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 1, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "offline_evaluation_interval": null, "num_offline_eval_runners": 0, "offline_loss_for_module_fn": null, "offline_evaluation_duration": 1, "offline_evaluation_parallel_to_training": false, "offline_evaluation_timeout_s": 120.0, "num_cpus_per_offline_eval_runner": 1, "num_gpus_per_offline_eval_runner": 0, "custom_resources_per_offline_eval_runner": {}, "restart_failed_offline_eval_runners": true, "ignore_offline_eval_runner_failures": false, "max_num_offline_eval_runner_restarts": 1000, "offline_eval_runner_restore_timeout_s": 1800.0, "max_requests_in_flight_per_offline_eval_runner": 1, "validate_offline_eval_runners_after_construction": true, "offline_eval_runner_health_probe_timeout_s": 30.0, "offline_eval_rl_module_inference_only": false, "broadcast_offline_eval_runner_states": false, "offline_eval_batch_size_per_runner": 256, "dataset_num_iters_per_eval_runner": 1, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "log_gradients": true, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 42, "restart_failed_env_runners": true, "ignore_env_runner_failures": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30.0, "env_runner_restore_timeout_s": 1800.0, "_model_config": {}, "_rl_module_spec": "RLModuleSpec(module_class=None, observation_space=None, action_space=None, inference_only=False, learner_only=False, model_config=DefaultModelConfig(fcnet_hiddens=[43, 122], fcnet_activation='tanh', fcnet_kernel_initializer=None, fcnet_kernel_initializer_kwargs=None, fcnet_bias_initializer=None, fcnet_bias_initializer_kwargs=None, conv_filters=None, conv_activation='relu', conv_kernel_initializer=None, conv_kernel_initializer_kwargs=None, conv_bias_initializer=None, conv_bias_initializer_kwargs=None, head_fcnet_hiddens=[], head_fcnet_activation='relu', head_fcnet_kernel_initializer=None, head_fcnet_kernel_initializer_kwargs=None, head_fcnet_bias_initializer=None, head_fcnet_bias_initializer_kwargs=None, free_log_std=False, log_std_clip_param=20.0, vf_share_layers=True, use_lstm=False, max_seq_len=20, lstm_cell_size=256, lstm_use_prev_action=False, lstm_use_prev_reward=False, lstm_kernel_initializer=None, lstm_kernel_initializer_kwargs=None, lstm_bias_initializer=None, lstm_bias_initializer_kwargs=None), catalog_class=None, load_state_path=None, model_config_dict=None)", "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "_validate_config": true, "_use_msgpack_checkpoints": false, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "env_task_fn": -1, "enable_connectors": -1, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2617985289524, "kl_target": 0.0294268671804, "vf_loss_coeff": 0.5611379931, "entropy_coeff": 0.0016790048723, "clip_param": 0.1271344785601, "vf_clip_param": 0.2507399863488, "entropy_coeff_schedule": null, "lr_schedule": null, "sgd_minibatch_size": -1, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9822919715622, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.callbacks.callbacks.RLlibCallback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 92.98609280586243, "iterations_since_restore": 19, "perf": {"cpu_util_percent": 12.37142857142857, "ram_util_percent": 88.0}}
{"timers": {"training_iteration": 4.205971480867145, "restore_env_runners": 1.4010277906729736e-05, "training_step": 4.205659200435701, "env_runner_sampling_timer": 3.8179248301738222, "learner_update_timer": 0.38422115840299625, "synch_weights": 0.0014297311639706507, "restore_eval_env_runners": 1.5765577442547323e-05, "evaluation_iteration": 0.7420984983715672, "synch_eval_env_connectors": 0.00040865222682429054, "synch_env_connectors": 7.594183021973085e-06}, "env_runners": {"num_episodes": 100.0, "sample": 0.03742822689300138, "module_to_env_connector": {"timers": {"connectors": {"un_batch_to_individual_items": 1.4593166072866128e-05, "listify_data_for_vector_env": 3.081820978106254e-05, "get_actions": 0.0001657380236452186, "normalize_and_clip_actions": 2.2257321389966287e-05, "tensor_to_numpy": 4.820716221374702e-05, "remove_single_ts_time_rank_from_batch": 1.433381281315241e-06}}, "connector_pipeline_timer": 0.00035981220404774104}, "agent_episode_returns_mean": {"default_agent": 13.3}, "num_module_steps_sampled_lifetime": {"default_policy": -4355000.0}, "env_to_module_connector": {"timers": {"connectors": {"batch_individual_items": 1.8327655347325427e-05, "add_observations_from_episodes_to_batch": 6.526612628761427e-06, "add_states_from_episodes_to_batch": 3.4646447970813427e-06, "numpy_to_tensor": 3.1313312622230786e-05, "add_time_dim_to_batch_and_zero_pad": 6.521771671655108e-06}}, "connector_pipeline_timer": 0.00011894093660186018}, "num_episodes_lifetime": -87100.0, "time_between_sampling": 0.01155610607822316, "module_episode_returns_mean": {"default_policy": 13.3}, "env_to_module_sum_episodes_length_in": 27.16809333212661, "episode_return_min": -5.5, "episode_return_max": 14.5, "num_env_steps_sampled_lifetime": -4355000.0, "rlmodule_inference_timer": 0.00010016085525280128, "episode_duration_sec_mean": 0.0364717322699562, "num_agent_steps_sampled": {"default_agent": 5000.0}, "num_agent_steps_sampled_lifetime": {"default_agent": -4355000.0}, "env_reset_timer": 9.449130811124285e-05, "episode_return_mean": 13.3, "weights_seq_no": 19.0, "num_module_steps_sampled": {"default_policy": 5000.0}, "episode_len_min": 50, "env_step_timer": 4.392942301816375e-05, "episode_len_max": 50, "num_env_steps_sampled": 5000.0, "env_to_module_sum_episodes_length_out": 27.16809333212661, "episode_len_mean": 50.0, "num_env_steps_sampled_lifetime_throughput": 1281.7046367252021}, "learners": {"__all_modules__": {"learner_connector": {"timers": {"connectors": {"general_advantage_estimation": 0.012697801654424372, "add_columns_from_episodes_to_train_batch": 0.06899197257490264, "batch_individual_items": 0.18807604162845504, "add_observations_from_episodes_to_batch": 0.0007861494969759302, "numpy_to_tensor": 0.00016304533538106006, "add_states_from_episodes_to_batch": 6.063806178842197e-06, "add_time_dim_to_batch_and_zero_pad": 2.3406676549865416e-05, "add_one_ts_to_episodes_and_truncate": 0.008155868245775032}}, "connector_pipeline_timer": 0.2792602844865992}, "num_env_steps_trained_lifetime": 612000, "num_non_trainable_parameters": 0, "learner_connector_sum_episodes_length_in": 5000.0, "num_module_steps_trained": 6000, "num_trainable_parameters": 5909, "num_module_steps_trained_lifetime": 120000, "num_env_steps_trained": 30600, "learner_connector_sum_episodes_length_out": 5100.0, "num_env_steps_trained_lifetime_throughput": 819195.283465794, "num_module_steps_trained_throughput": 160998.16893129548, "num_module_steps_trained_lifetime_throughput": 160893.75935210774}, "default_policy": {"total_loss": 0.43922263383865356, "diff_num_grad_updates_vs_sampler_policy": 1.0, "vf_loss": 0.24548736214637756, "mean_kl_loss": 0.0005711292033083737, "curr_entropy_coeff": 0.0016790048723, "gradients_default_optimizer_global_norm": 0.13110509514808655, "num_module_steps_trained": 6000, "weights_seq_no": 20.0, "entropy": 0.3035207986831665, "num_trainable_parameters": 5909, "module_train_batch_size_mean": 1000.0, "vf_loss_unclipped": 82.52417755126953, "num_module_steps_trained_lifetime": 120000, "vf_explained_var": 0.08866572380065918, "curr_kl_coeff": 2.4967053491309343e-07, "policy_loss": 0.30198001861572266, "default_optimizer_learning_rate": 0.0008209260984, "num_module_steps_trained_lifetime_throughput": 161024.86075976316}}, "num_training_step_calls_per_iteration": 1, "evaluation": {"env_runners": {"module_episode_returns_mean": {"default_policy": -0.9}, "module_to_env_connector": {"timers": {"connectors": {"remove_single_ts_time_rank_from_batch": 1.464054699698419e-06, "listify_data_for_vector_env": 2.9684450612616847e-05, "get_actions": 0.000152832786761636, "un_batch_to_individual_items": 1.5374021526188576e-05, "normalize_and_clip_actions": 2.1778804784524518e-05, "tensor_to_numpy": 4.4591365681684586e-05}}, "connector_pipeline_timer": 0.00034234634161678433}, "agent_episode_returns_mean": {"default_agent": -0.9}, "num_env_steps_sampled": 1000, "num_module_steps_sampled": {"default_policy": 1000}, "num_episodes": 20, "env_to_module_connector": {"timers": {"connectors": {"add_observations_from_episodes_to_batch": 5.880868477815661e-06, "add_states_from_episodes_to_batch": 3.674658622322615e-06, "numpy_to_tensor": 2.9370392318775277e-05, "add_time_dim_to_batch_and_zero_pad": 5.8091060507434964e-06, "batch_individual_items": 1.7792241039429978e-05}}, "connector_pipeline_timer": 0.00011616445471268985}, "num_module_steps_sampled_lifetime": {"default_policy": 20000}, "num_agent_steps_sampled_lifetime": {"default_agent": 20000}, "num_agent_steps_sampled": {"default_agent": 1000}, "rlmodule_inference_timer": 9.276640935150025e-05, "num_env_steps_sampled_lifetime": 101000, "env_reset_timer": 0.0001978717377978519, "episode_return_mean": -0.9, "weights_seq_no": 20.0, "env_step_timer": 4.0891472533539484e-05, "episode_len_max": 50, "episode_len_mean": 50.0, "sample": 0.730342429025595, "num_episodes_lifetime": 400, "episode_return_min": -14.5, "episode_return_max": 17.5, "episode_duration_sec_mean": 0.03507289797003068, "episode_len_min": 50, "env_to_module_sum_episodes_length_out": 27.168093332126602, "env_to_module_sum_episodes_length_in": 27.168093332126602, "time_between_sampling": 4.16790079022324}, "num_healthy_workers": 1, "actor_manager_num_outstanding_async_reqs": 0, "num_remote_worker_restarts": 0}, "num_env_steps_sampled_lifetime": -4355000.0, "fault_tolerance": {"num_healthy_workers": 0, "num_remote_worker_restarts": 0}, "env_runner_group": {"actor_manager_num_outstanding_async_reqs": 0}, "done": true, "training_iteration": 20, "trial_id": "a54d5_00000", "date": "2025-08-11_17-24-17", "timestamp": 1754925857, "time_this_iter_s": 4.971873044967651, "time_total_s": 97.95796585083008, "pid": 73571, "hostname": "DESKTOP-3SK5A41", "node_ip": "192.168.40.242", "config": {"exploration_config": {}, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 6, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "env": "Umbrella", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": false, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 0, "create_local_env_runner": true, "num_envs_per_env_runner": 1, "gym_env_vectorize_mode": "SYNC", "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "episodes_to_numpy": true, "max_requests_in_flight_per_env_runner": 1, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "merge_env_runner_states": "training_only", "broadcast_env_runner_states": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "complete_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "sampler_perf_stats_ema_coef": null, "_is_online": true, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": "auto", "num_aggregator_actors_per_learner": 0, "max_requests_in_flight_per_aggregator_actor": 3, "local_gpu_idx": 0, "max_requests_in_flight_per_learner": 3, "gamma": 1, "lr": 0.0008209260984, "grad_clip": 0.5, "grad_clip_by": "global_norm", "_train_batch_size_per_learner": 5000, "train_batch_size": 4000, "num_epochs": 1, "minibatch_size": 1000, "shuffle_batch_per_epoch": true, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "log_std_clip_param": 20.0, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "_disable_preprocessor_api": false, "_disable_action_flattening": false}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "_learner_class": null, "callbacks_on_algorithm_init": null, "callbacks_on_env_runners_recreated": null, "callbacks_on_offline_eval_runners_recreated": null, "callbacks_on_checkpoint_loaded": null, "callbacks_on_environment_created": null, "callbacks_on_episode_created": null, "callbacks_on_episode_start": null, "callbacks_on_episode_step": null, "callbacks_on_episode_end": null, "callbacks_on_evaluate_start": null, "callbacks_on_evaluate_end": null, "callbacks_on_evaluate_offline_start": null, "callbacks_on_evaluate_offline_end": null, "callbacks_on_sample_end": null, "callbacks_on_train_result": null, "explore": true, "enable_rl_module_and_learner": true, "enable_env_runner_and_connector_v2": true, "_prior_exploration_config": {"type": "StochasticSampling"}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x70470debeac0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "offline_data_class": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_read_batch_size": null, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "materialize_data": false, "materialize_mapped_data": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "ignore_final_observation": false, "prelearner_class": null, "prelearner_buffer_class": null, "prelearner_buffer_kwargs": {}, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_remaining_data": false, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": 1, "evaluation_duration": 20, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_auto_duration_min_env_steps_per_sample": 100, "evaluation_auto_duration_max_env_steps_per_sample": 2000, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 1, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "offline_evaluation_interval": null, "num_offline_eval_runners": 0, "offline_loss_for_module_fn": null, "offline_evaluation_duration": 1, "offline_evaluation_parallel_to_training": false, "offline_evaluation_timeout_s": 120.0, "num_cpus_per_offline_eval_runner": 1, "num_gpus_per_offline_eval_runner": 0, "custom_resources_per_offline_eval_runner": {}, "restart_failed_offline_eval_runners": true, "ignore_offline_eval_runner_failures": false, "max_num_offline_eval_runner_restarts": 1000, "offline_eval_runner_restore_timeout_s": 1800.0, "max_requests_in_flight_per_offline_eval_runner": 1, "validate_offline_eval_runners_after_construction": true, "offline_eval_runner_health_probe_timeout_s": 30.0, "offline_eval_rl_module_inference_only": false, "broadcast_offline_eval_runner_states": false, "offline_eval_batch_size_per_runner": 256, "dataset_num_iters_per_eval_runner": 1, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "log_gradients": true, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 42, "restart_failed_env_runners": true, "ignore_env_runner_failures": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30.0, "env_runner_restore_timeout_s": 1800.0, "_model_config": {}, "_rl_module_spec": "RLModuleSpec(module_class=None, observation_space=None, action_space=None, inference_only=False, learner_only=False, model_config=DefaultModelConfig(fcnet_hiddens=[43, 122], fcnet_activation='tanh', fcnet_kernel_initializer=None, fcnet_kernel_initializer_kwargs=None, fcnet_bias_initializer=None, fcnet_bias_initializer_kwargs=None, conv_filters=None, conv_activation='relu', conv_kernel_initializer=None, conv_kernel_initializer_kwargs=None, conv_bias_initializer=None, conv_bias_initializer_kwargs=None, head_fcnet_hiddens=[], head_fcnet_activation='relu', head_fcnet_kernel_initializer=None, head_fcnet_kernel_initializer_kwargs=None, head_fcnet_bias_initializer=None, head_fcnet_bias_initializer_kwargs=None, free_log_std=False, log_std_clip_param=20.0, vf_share_layers=True, use_lstm=False, max_seq_len=20, lstm_cell_size=256, lstm_use_prev_action=False, lstm_use_prev_reward=False, lstm_kernel_initializer=None, lstm_kernel_initializer_kwargs=None, lstm_bias_initializer=None, lstm_bias_initializer_kwargs=None), catalog_class=None, load_state_path=None, model_config_dict=None)", "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "_validate_config": true, "_use_msgpack_checkpoints": false, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "env_task_fn": -1, "enable_connectors": -1, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2617985289524, "kl_target": 0.0294268671804, "vf_loss_coeff": 0.5611379931, "entropy_coeff": 0.0016790048723, "clip_param": 0.1271344785601, "vf_clip_param": 0.2507399863488, "entropy_coeff_schedule": null, "lr_schedule": null, "sgd_minibatch_size": -1, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9822919715622, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.callbacks.callbacks.RLlibCallback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 97.95796585083008, "iterations_since_restore": 20, "perf": {"cpu_util_percent": 12.000000000000002, "ram_util_percent": 88.0}}
