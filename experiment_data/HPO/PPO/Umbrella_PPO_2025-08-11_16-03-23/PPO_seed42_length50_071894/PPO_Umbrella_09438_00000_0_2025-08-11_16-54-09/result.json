{"timers": {"training_iteration": 4.3375297990000945, "restore_env_runners": 1.4099999589234358e-05, "training_step": 4.337251899000421, "env_runner_sampling_timer": 3.917560099000184, "learner_update_timer": 0.4159607000001415, "synch_weights": 0.0017494999997325067}, "env_runners": {"env_to_module_connector": {"timers": {"connectors": {"batch_individual_items": 1.9123423438796345e-05, "numpy_to_tensor": 3.210555548043326e-05, "add_time_dim_to_batch_and_zero_pad": 6.681375772738359e-06, "add_observations_from_episodes_to_batch": 6.927328278408702e-06, "add_states_from_episodes_to_batch": 3.617197781652375e-06}}, "connector_pipeline_timer": 0.00012518221480504676}, "num_module_steps_sampled_lifetime": {"default_policy": 252500.0}, "num_episodes": 100.0, "module_to_env_connector": {"timers": {"connectors": {"get_actions": 0.00017116132917645917, "remove_single_ts_time_rank_from_batch": 1.4154742589189819e-06, "tensor_to_numpy": 4.836247740649246e-05, "un_batch_to_individual_items": 1.522170952313195e-05, "normalize_and_clip_actions": 2.915761322515178e-05, "listify_data_for_vector_env": 3.2195457974046645e-05}}, "connector_pipeline_timer": 0.00037629803179794054}, "weights_seq_no": 0.0, "env_to_module_sum_episodes_length_out": 26.762340024562445, "env_step_timer": 4.6214041322331274e-05, "num_agent_steps_sampled_lifetime": {"default_agent": 252500.0}, "module_episode_returns_mean": {"default_policy": 3.3}, "rlmodule_inference_timer": 0.0001054373698355708, "episode_len_max": 50, "time_between_sampling": 0.0013379075871269668, "episode_duration_sec_mean": 0.0366522869900291, "num_episodes_lifetime": 5050.0, "env_reset_timer": 0.00020701730392504744, "episode_return_min": -5.5, "num_agent_steps_sampled": {"default_agent": 5000.0}, "episode_return_max": 14.5, "episode_len_mean": 50.0, "num_env_steps_sampled_lifetime": 252500.0, "env_to_module_sum_episodes_length_in": 26.762340024562445, "num_module_steps_sampled": {"default_policy": 5000.0}, "episode_return_mean": 3.3, "episode_len_min": 50, "sample": 0.04169251728911921, "num_env_steps_sampled": 5000.0, "agent_episode_returns_mean": {"default_agent": 3.3}, "num_env_steps_sampled_lifetime_throughput": 1224.8026511491992}, "learners": {"__all_modules__": {"learner_connector": {"timers": {"connectors": {"numpy_to_tensor": 0.0002144999998563435, "add_time_dim_to_batch_and_zero_pad": 2.369999992879457e-05, "general_advantage_estimation": 0.013195400000313384, "batch_individual_items": 0.2054588999999396, "add_columns_from_episodes_to_train_batch": 0.0697706000000835, "add_observations_from_episodes_to_batch": 0.0007931999998618267, "add_one_ts_to_episodes_and_truncate": 0.008709400000043388, "add_states_from_episodes_to_batch": 6.100000064179767e-06}}, "connector_pipeline_timer": 0.2985183999999208}, "learner_connector_sum_episodes_length_in": 5000, "num_env_steps_trained": 30600, "num_module_steps_trained": 6000, "num_env_steps_trained_lifetime": 30600, "learner_connector_sum_episodes_length_out": 5100, "num_trainable_parameters": 3221, "num_non_trainable_parameters": 0, "num_module_steps_trained_lifetime": 6000, "num_env_steps_trained_lifetime_throughput": 953100.6447002963, "num_module_steps_trained_throughput": 187707.7948961882, "num_module_steps_trained_lifetime_throughput": 187544.60879964934}, "default_policy": {"weights_seq_no": 1.0, "num_module_steps_trained_lifetime": 6000, "module_train_batch_size_mean": 1000.0, "vf_loss_unclipped": 40.778533935546875, "mean_kl_loss": 7.1743643275112845e-06, "diff_num_grad_updates_vs_sampler_policy": 1.0, "curr_kl_coeff": 0.44017142057418823, "total_loss": 0.28902745246887207, "default_optimizer_learning_rate": 2.15757277e-05, "vf_loss": 0.1510569006204605, "policy_loss": 0.15061818063259125, "num_module_steps_trained": 6000, "gradients_default_optimizer_global_norm": 0.05269475653767586, "entropy": 0.6894848942756653, "vf_explained_var": 0.004464924335479736, "curr_entropy_coeff": 0.0143822734464, "num_trainable_parameters": 3221, "num_module_steps_trained_lifetime_throughput": 188134.7128064096}}, "num_training_step_calls_per_iteration": 1, "num_env_steps_sampled_lifetime": 252500.0, "evaluation": {"env_runners": {"module_to_env_connector": {"timers": {"connectors": {"remove_single_ts_time_rank_from_batch": 1.505120799455043e-06, "tensor_to_numpy": 4.7851789200146016e-05, "un_batch_to_individual_items": 1.622283681813469e-05, "normalize_and_clip_actions": 2.3914753234893134e-05, "listify_data_for_vector_env": 3.360144787875404e-05, "get_actions": 0.00017094256324299}}, "connector_pipeline_timer": 0.0003769127751290655}, "episode_len_mean": 50.0, "env_to_module_sum_episodes_length_in": 27.167134025045954, "num_module_steps_sampled": {"default_policy": 1000}, "num_episodes": 20, "env_to_module_sum_episodes_length_out": 27.167134025045954, "episode_duration_sec_mean": 0.038745049999943146, "episode_return_min": -14.5, "env_to_module_connector": {"timers": {"connectors": {"add_time_dim_to_batch_and_zero_pad": 7.291533892265501e-06, "batch_individual_items": 1.9823083811187306e-05, "add_observations_from_episodes_to_batch": 7.184722495811701e-06, "add_states_from_episodes_to_batch": 3.6965172741902735e-06, "numpy_to_tensor": 3.31549790973457e-05}}, "connector_pipeline_timer": 0.00012820595868305804}, "env_step_timer": 4.674196422067931e-05, "episode_len_max": 50, "agent_episode_returns_mean": {"default_agent": -5.9}, "env_reset_timer": 0.00020910000012008823, "module_episode_returns_mean": {"default_policy": -5.9}, "num_agent_steps_sampled_lifetime": {"default_agent": 1000}, "episode_return_max": 17.5, "num_env_steps_sampled": 1000, "weights_seq_no": 1.0, "num_episodes_lifetime": 20, "num_env_steps_sampled_lifetime": 6000, "episode_return_mean": -5.9, "episode_len_min": 50, "sample": 0.8076874000003045, "num_agent_steps_sampled": {"default_agent": 1000}, "rlmodule_inference_timer": 0.00010378444603192673, "num_module_steps_sampled_lifetime": {"default_policy": 1000}}, "num_healthy_workers": 1, "actor_manager_num_outstanding_async_reqs": 0, "num_remote_worker_restarts": 0}, "fault_tolerance": {"num_healthy_workers": 0, "num_remote_worker_restarts": 0}, "env_runner_group": {"actor_manager_num_outstanding_async_reqs": 0}, "done": false, "training_iteration": 1, "trial_id": "09438_00000", "date": "2025-08-11_17-04-40", "timestamp": 1754924680, "time_this_iter_s": 5.16136908531189, "time_total_s": 5.16136908531189, "pid": 57918, "hostname": "DESKTOP-3SK5A41", "node_ip": "192.168.40.242", "config": {"exploration_config": {}, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 6, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "env": "Umbrella", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": false, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 0, "create_local_env_runner": true, "num_envs_per_env_runner": 1, "gym_env_vectorize_mode": "SYNC", "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "episodes_to_numpy": true, "max_requests_in_flight_per_env_runner": 1, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "merge_env_runner_states": "training_only", "broadcast_env_runner_states": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "complete_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "sampler_perf_stats_ema_coef": null, "_is_online": true, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": "auto", "num_aggregator_actors_per_learner": 0, "max_requests_in_flight_per_aggregator_actor": 3, "local_gpu_idx": 0, "max_requests_in_flight_per_learner": 3, "gamma": 1, "lr": 2.15757277e-05, "grad_clip": 0.5, "grad_clip_by": "global_norm", "_train_batch_size_per_learner": 5000, "train_batch_size": 4000, "num_epochs": 1, "minibatch_size": 1000, "shuffle_batch_per_epoch": true, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "log_std_clip_param": 20.0, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "_disable_preprocessor_api": false, "_disable_action_flattening": false}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "_learner_class": null, "callbacks_on_algorithm_init": null, "callbacks_on_env_runners_recreated": null, "callbacks_on_offline_eval_runners_recreated": null, "callbacks_on_checkpoint_loaded": null, "callbacks_on_environment_created": null, "callbacks_on_episode_created": null, "callbacks_on_episode_start": null, "callbacks_on_episode_step": null, "callbacks_on_episode_end": null, "callbacks_on_evaluate_start": null, "callbacks_on_evaluate_end": null, "callbacks_on_evaluate_offline_start": null, "callbacks_on_evaluate_offline_end": null, "callbacks_on_sample_end": null, "callbacks_on_train_result": null, "explore": true, "enable_rl_module_and_learner": true, "enable_env_runner_and_connector_v2": true, "_prior_exploration_config": {"type": "StochasticSampling"}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x789255972ac0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "offline_data_class": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_read_batch_size": null, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "materialize_data": false, "materialize_mapped_data": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "ignore_final_observation": false, "prelearner_class": null, "prelearner_buffer_class": null, "prelearner_buffer_kwargs": {}, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_remaining_data": false, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": 1, "evaluation_duration": 20, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_auto_duration_min_env_steps_per_sample": 100, "evaluation_auto_duration_max_env_steps_per_sample": 2000, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 1, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "offline_evaluation_interval": null, "num_offline_eval_runners": 0, "offline_loss_for_module_fn": null, "offline_evaluation_duration": 1, "offline_evaluation_parallel_to_training": false, "offline_evaluation_timeout_s": 120.0, "num_cpus_per_offline_eval_runner": 1, "num_gpus_per_offline_eval_runner": 0, "custom_resources_per_offline_eval_runner": {}, "restart_failed_offline_eval_runners": true, "ignore_offline_eval_runner_failures": false, "max_num_offline_eval_runner_restarts": 1000, "offline_eval_runner_restore_timeout_s": 1800.0, "max_requests_in_flight_per_offline_eval_runner": 1, "validate_offline_eval_runners_after_construction": true, "offline_eval_runner_health_probe_timeout_s": 30.0, "offline_eval_rl_module_inference_only": false, "broadcast_offline_eval_runner_states": false, "offline_eval_batch_size_per_runner": 256, "dataset_num_iters_per_eval_runner": 1, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "log_gradients": true, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 42, "restart_failed_env_runners": true, "ignore_env_runner_failures": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30.0, "env_runner_restore_timeout_s": 1800.0, "_model_config": {}, "_rl_module_spec": "RLModuleSpec(module_class=None, observation_space=None, action_space=None, inference_only=False, learner_only=False, model_config=DefaultModelConfig(fcnet_hiddens=[62, 45], fcnet_activation='tanh', fcnet_kernel_initializer=None, fcnet_kernel_initializer_kwargs=None, fcnet_bias_initializer=None, fcnet_bias_initializer_kwargs=None, conv_filters=None, conv_activation='relu', conv_kernel_initializer=None, conv_kernel_initializer_kwargs=None, conv_bias_initializer=None, conv_bias_initializer_kwargs=None, head_fcnet_hiddens=[], head_fcnet_activation='relu', head_fcnet_kernel_initializer=None, head_fcnet_kernel_initializer_kwargs=None, head_fcnet_bias_initializer=None, head_fcnet_bias_initializer_kwargs=None, free_log_std=False, log_std_clip_param=20.0, vf_share_layers=True, use_lstm=False, max_seq_len=20, lstm_cell_size=256, lstm_use_prev_action=False, lstm_use_prev_reward=False, lstm_kernel_initializer=None, lstm_kernel_initializer_kwargs=None, lstm_bias_initializer=None, lstm_bias_initializer_kwargs=None), catalog_class=None, load_state_path=None, model_config_dict=None)", "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "_validate_config": true, "_use_msgpack_checkpoints": false, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "env_task_fn": -1, "enable_connectors": -1, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.8803428236734, "kl_target": 0.0081878044364, "vf_loss_coeff": 0.981876947508, "entropy_coeff": 0.0143822734464, "clip_param": 0.1609292883306, "vf_clip_param": 0.1530762162174, "entropy_coeff_schedule": null, "lr_schedule": null, "sgd_minibatch_size": -1, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9795292165235, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.callbacks.callbacks.RLlibCallback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 5.16136908531189, "iterations_since_restore": 1, "perf": {"cpu_util_percent": 11.025, "ram_util_percent": 73.92500000000001}}
{"timers": {"training_iteration": 4.335606409100092, "restore_env_runners": 1.411699959589896e-05, "training_step": 4.335327229100416, "env_runner_sampling_timer": 3.917981152100183, "learner_update_timer": 0.4136170060001405, "synch_weights": 0.0017460159997381198, "restore_eval_env_runners": 1.6199999663513154e-05, "evaluation_iteration": 0.8209584000001087, "synch_eval_env_connectors": 0.0004861000002165383, "synch_env_connectors": 9.100000170292333e-06}, "env_runners": {"env_to_module_connector": {"timers": {"connectors": {"batch_individual_items": 1.878386002264719e-05, "numpy_to_tensor": 3.1879870733388337e-05, "add_time_dim_to_batch_and_zero_pad": 6.4392904977668935e-06, "add_observations_from_episodes_to_batch": 6.8450704540326435e-06, "add_states_from_episodes_to_batch": 3.5499581724186628e-06}}, "connector_pipeline_timer": 0.00012137892203309155}, "num_module_steps_sampled_lifetime": {"default_policy": 10000.0}, "num_episodes": 100.0, "module_to_env_connector": {"timers": {"connectors": {"get_actions": 0.0001664393155235256, "remove_single_ts_time_rank_from_batch": 1.4393661914766142e-06, "tensor_to_numpy": 4.9786755858056836e-05, "un_batch_to_individual_items": 1.534950226853121e-05, "normalize_and_clip_actions": 2.3059243905007177e-05, "listify_data_for_vector_env": 3.179169349955878e-05}}, "connector_pipeline_timer": 0.00036575232335638274}, "weights_seq_no": 1.0, "env_to_module_sum_episodes_length_out": 27.16809333212661, "env_step_timer": 4.376785499082231e-05, "num_agent_steps_sampled_lifetime": {"default_agent": 10000.0}, "module_episode_returns_mean": {"default_policy": 5.299999999999998}, "rlmodule_inference_timer": 0.00010006965609811779, "episode_len_max": 50, "time_between_sampling": 0.009560641986377958, "episode_duration_sec_mean": 0.037016217079985834, "num_episodes_lifetime": 200.0, "env_reset_timer": 0.00013777972309759283, "episode_return_min": -5.5, "num_agent_steps_sampled": {"default_agent": 5000.0}, "episode_return_max": 14.5, "episode_len_mean": 50.0, "num_env_steps_sampled_lifetime": 10000.0, "env_to_module_sum_episodes_length_in": 27.16809333212661, "num_module_steps_sampled": {"default_policy": 5000.0}, "episode_return_mean": 5.299999999999998, "episode_len_min": 50, "sample": 0.039290728596085206, "num_env_steps_sampled": 5000.0, "agent_episode_returns_mean": {"default_agent": 5.299999999999998}, "num_env_steps_sampled_lifetime_throughput": 1266.436120801444}, "learners": {"__all_modules__": {"learner_connector": {"timers": {"connectors": {"numpy_to_tensor": 0.00021409699985724728, "add_time_dim_to_batch_and_zero_pad": 2.3739999928693578e-05, "general_advantage_estimation": 0.013154942000310256, "batch_individual_items": 0.20401412699994126, "add_columns_from_episodes_to_train_batch": 0.0697595840000804, "add_observations_from_episodes_to_batch": 0.0007922789998610824, "add_one_ts_to_episodes_and_truncate": 0.008705889000043498, "add_states_from_episodes_to_batch": 6.108000061431085e-06}}, "connector_pipeline_timer": 0.297017629999923}, "learner_connector_sum_episodes_length_in": 5000.0, "num_env_steps_trained": 30600, "num_module_steps_trained": 6000, "num_env_steps_trained_lifetime": 61200, "learner_connector_sum_episodes_length_out": 5100.0, "num_trainable_parameters": 3221, "num_non_trainable_parameters": 0, "num_module_steps_trained_lifetime": 12000, "num_env_steps_trained_lifetime_throughput": 951852.0507289753, "num_module_steps_trained_throughput": 187457.28383715329, "num_module_steps_trained_lifetime_throughput": 187293.517405893}, "default_policy": {"weights_seq_no": 2.0, "num_module_steps_trained_lifetime": 12000, "module_train_batch_size_mean": 1000.0, "vf_loss_unclipped": 53.42873001098633, "mean_kl_loss": 5.5500913731520995e-06, "diff_num_grad_updates_vs_sampler_policy": 1.0, "curr_kl_coeff": 0.22008571028709412, "total_loss": -0.06492219865322113, "default_optimizer_learning_rate": 2.15757277e-05, "vf_loss": 0.1519884616136551, "policy_loss": -0.20427966117858887, "num_module_steps_trained": 6000, "gradients_default_optimizer_global_norm": 0.09454850107431412, "entropy": 0.6868829131126404, "vf_explained_var": 0.0050452351570129395, "curr_entropy_coeff": 0.0143822734464, "num_trainable_parameters": 3221, "num_module_steps_trained_lifetime_throughput": 187875.84504951572}}, "num_training_step_calls_per_iteration": 1, "evaluation": {"env_runners": {"module_to_env_connector": {"timers": {"connectors": {"remove_single_ts_time_rank_from_batch": 1.5060091926491656e-06, "tensor_to_numpy": 4.615950519241219e-05, "un_batch_to_individual_items": 1.586329431483692e-05, "normalize_and_clip_actions": 2.208799986239716e-05, "listify_data_for_vector_env": 3.16210802159206e-05, "get_actions": 0.00015856186365112099}}, "connector_pipeline_timer": 0.00035428043769299703}, "episode_len_mean": 50.0, "env_to_module_sum_episodes_length_in": 27.168093298253442, "num_module_steps_sampled": {"default_policy": 1000}, "num_episodes": 20, "env_to_module_sum_episodes_length_out": 27.168093298253442, "episode_duration_sec_mean": 0.037295352524972715, "episode_return_min": -14.5, "env_to_module_connector": {"timers": {"connectors": {"add_time_dim_to_batch_and_zero_pad": 6.4460170831321075e-06, "batch_individual_items": 1.9085745834776955e-05, "add_observations_from_episodes_to_batch": 6.5551729858118795e-06, "add_states_from_episodes_to_batch": 3.7734924750402344e-06, "numpy_to_tensor": 3.0605860550484756e-05}}, "connector_pipeline_timer": 0.00012053503429542022}, "env_step_timer": 4.405488742130614e-05, "episode_len_max": 50, "agent_episode_returns_mean": {"default_agent": -1.9}, "env_reset_timer": 0.0002082830001199909, "module_episode_returns_mean": {"default_policy": -1.9}, "num_agent_steps_sampled_lifetime": {"default_agent": 2000}, "episode_return_max": 17.5, "num_env_steps_sampled": 1000, "weights_seq_no": 2.0, "num_episodes_lifetime": 40, "num_env_steps_sampled_lifetime": 11000, "episode_return_mean": -1.9, "episode_len_min": 50, "sample": 0.8070685850102973, "num_agent_steps_sampled": {"default_agent": 1000}, "rlmodule_inference_timer": 9.44941129838126e-05, "num_module_steps_sampled_lifetime": {"default_policy": 2000}, "time_between_sampling": 4.20717010899989}, "num_healthy_workers": 1, "actor_manager_num_outstanding_async_reqs": 0, "num_remote_worker_restarts": 0}, "num_env_steps_sampled_lifetime": 10000.0, "fault_tolerance": {"num_healthy_workers": 0, "num_remote_worker_restarts": 0}, "env_runner_group": {"actor_manager_num_outstanding_async_reqs": 0}, "done": false, "training_iteration": 2, "trial_id": "09438_00000", "date": "2025-08-11_17-04-45", "timestamp": 1754924685, "time_this_iter_s": 4.906147241592407, "time_total_s": 10.067516326904297, "pid": 57918, "hostname": "DESKTOP-3SK5A41", "node_ip": "192.168.40.242", "config": {"exploration_config": {}, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 6, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "env": "Umbrella", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": false, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 0, "create_local_env_runner": true, "num_envs_per_env_runner": 1, "gym_env_vectorize_mode": "SYNC", "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "episodes_to_numpy": true, "max_requests_in_flight_per_env_runner": 1, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "merge_env_runner_states": "training_only", "broadcast_env_runner_states": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "complete_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "sampler_perf_stats_ema_coef": null, "_is_online": true, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": "auto", "num_aggregator_actors_per_learner": 0, "max_requests_in_flight_per_aggregator_actor": 3, "local_gpu_idx": 0, "max_requests_in_flight_per_learner": 3, "gamma": 1, "lr": 2.15757277e-05, "grad_clip": 0.5, "grad_clip_by": "global_norm", "_train_batch_size_per_learner": 5000, "train_batch_size": 4000, "num_epochs": 1, "minibatch_size": 1000, "shuffle_batch_per_epoch": true, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "log_std_clip_param": 20.0, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "_disable_preprocessor_api": false, "_disable_action_flattening": false}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "_learner_class": null, "callbacks_on_algorithm_init": null, "callbacks_on_env_runners_recreated": null, "callbacks_on_offline_eval_runners_recreated": null, "callbacks_on_checkpoint_loaded": null, "callbacks_on_environment_created": null, "callbacks_on_episode_created": null, "callbacks_on_episode_start": null, "callbacks_on_episode_step": null, "callbacks_on_episode_end": null, "callbacks_on_evaluate_start": null, "callbacks_on_evaluate_end": null, "callbacks_on_evaluate_offline_start": null, "callbacks_on_evaluate_offline_end": null, "callbacks_on_sample_end": null, "callbacks_on_train_result": null, "explore": true, "enable_rl_module_and_learner": true, "enable_env_runner_and_connector_v2": true, "_prior_exploration_config": {"type": "StochasticSampling"}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x789255972ac0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "offline_data_class": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_read_batch_size": null, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "materialize_data": false, "materialize_mapped_data": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "ignore_final_observation": false, "prelearner_class": null, "prelearner_buffer_class": null, "prelearner_buffer_kwargs": {}, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_remaining_data": false, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": 1, "evaluation_duration": 20, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_auto_duration_min_env_steps_per_sample": 100, "evaluation_auto_duration_max_env_steps_per_sample": 2000, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 1, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "offline_evaluation_interval": null, "num_offline_eval_runners": 0, "offline_loss_for_module_fn": null, "offline_evaluation_duration": 1, "offline_evaluation_parallel_to_training": false, "offline_evaluation_timeout_s": 120.0, "num_cpus_per_offline_eval_runner": 1, "num_gpus_per_offline_eval_runner": 0, "custom_resources_per_offline_eval_runner": {}, "restart_failed_offline_eval_runners": true, "ignore_offline_eval_runner_failures": false, "max_num_offline_eval_runner_restarts": 1000, "offline_eval_runner_restore_timeout_s": 1800.0, "max_requests_in_flight_per_offline_eval_runner": 1, "validate_offline_eval_runners_after_construction": true, "offline_eval_runner_health_probe_timeout_s": 30.0, "offline_eval_rl_module_inference_only": false, "broadcast_offline_eval_runner_states": false, "offline_eval_batch_size_per_runner": 256, "dataset_num_iters_per_eval_runner": 1, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "log_gradients": true, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 42, "restart_failed_env_runners": true, "ignore_env_runner_failures": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30.0, "env_runner_restore_timeout_s": 1800.0, "_model_config": {}, "_rl_module_spec": "RLModuleSpec(module_class=None, observation_space=None, action_space=None, inference_only=False, learner_only=False, model_config=DefaultModelConfig(fcnet_hiddens=[62, 45], fcnet_activation='tanh', fcnet_kernel_initializer=None, fcnet_kernel_initializer_kwargs=None, fcnet_bias_initializer=None, fcnet_bias_initializer_kwargs=None, conv_filters=None, conv_activation='relu', conv_kernel_initializer=None, conv_kernel_initializer_kwargs=None, conv_bias_initializer=None, conv_bias_initializer_kwargs=None, head_fcnet_hiddens=[], head_fcnet_activation='relu', head_fcnet_kernel_initializer=None, head_fcnet_kernel_initializer_kwargs=None, head_fcnet_bias_initializer=None, head_fcnet_bias_initializer_kwargs=None, free_log_std=False, log_std_clip_param=20.0, vf_share_layers=True, use_lstm=False, max_seq_len=20, lstm_cell_size=256, lstm_use_prev_action=False, lstm_use_prev_reward=False, lstm_kernel_initializer=None, lstm_kernel_initializer_kwargs=None, lstm_bias_initializer=None, lstm_bias_initializer_kwargs=None), catalog_class=None, load_state_path=None, model_config_dict=None)", "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "_validate_config": true, "_use_msgpack_checkpoints": false, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "env_task_fn": -1, "enable_connectors": -1, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.8803428236734, "kl_target": 0.0081878044364, "vf_loss_coeff": 0.981876947508, "entropy_coeff": 0.0143822734464, "clip_param": 0.1609292883306, "vf_clip_param": 0.1530762162174, "entropy_coeff_schedule": null, "lr_schedule": null, "sgd_minibatch_size": -1, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9795292165235, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.callbacks.callbacks.RLlibCallback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 10.067516326904297, "iterations_since_restore": 2, "perf": {"cpu_util_percent": 12.771428571428574, "ram_util_percent": 69.61428571428571}}
{"timers": {"training_iteration": 4.335886756089092, "restore_env_runners": 1.4115829597312768e-05, "training_step": 4.335604723889415, "env_runner_sampling_timer": 3.9204427696491813, "learner_update_timer": 0.41141726195014106, "synch_weights": 0.0017498388397416875, "restore_eval_env_runners": 1.6171999664038595e-05, "evaluation_iteration": 0.8203089760201101, "synch_eval_env_connectors": 0.0004862550002144417, "synch_env_connectors": 9.104000168917992e-06}, "env_runners": {"env_to_module_connector": {"timers": {"connectors": {"batch_individual_items": 1.8895338092860004e-05, "numpy_to_tensor": 3.2258074858288495e-05, "add_time_dim_to_batch_and_zero_pad": 6.646935645742944e-06, "add_observations_from_episodes_to_batch": 6.848142328884271e-06, "add_states_from_episodes_to_batch": 3.5584558017653163e-06}}, "connector_pipeline_timer": 0.00012312462026088758}, "num_module_steps_sampled_lifetime": {"default_policy": -232500.0}, "num_episodes": 100.0, "module_to_env_connector": {"timers": {"connectors": {"get_actions": 0.0001694503875601149, "remove_single_ts_time_rank_from_batch": 1.580969055852123e-06, "tensor_to_numpy": 5.08773286686232e-05, "un_batch_to_individual_items": 1.564188799495537e-05, "normalize_and_clip_actions": 2.3266295738217746e-05, "listify_data_for_vector_env": 3.22390192401318e-05}}, "connector_pipeline_timer": 0.00037271679081860834}, "weights_seq_no": 2.0, "env_to_module_sum_episodes_length_out": 27.16809333212661, "env_step_timer": 4.4901566019430974e-05, "num_agent_steps_sampled_lifetime": {"default_agent": -232500.0}, "module_episode_returns_mean": {"default_policy": 5.299999999999998}, "rlmodule_inference_timer": 0.0001354358310473561, "episode_len_max": 50, "time_between_sampling": 0.010707286786719871, "episode_duration_sec_mean": 0.03905373007000435, "num_episodes_lifetime": -4650.0, "env_reset_timer": 0.00011331075819733777, "episode_return_min": -5.5, "num_agent_steps_sampled": {"default_agent": 5000.0}, "episode_return_max": 14.5, "episode_len_mean": 50.0, "num_env_steps_sampled_lifetime": -232500.0, "env_to_module_sum_episodes_length_in": 27.16809333212661, "num_module_steps_sampled": {"default_policy": 5000.0}, "episode_return_mean": 5.299999999999998, "episode_len_min": 50, "sample": 0.03902909847150167, "num_env_steps_sampled": 5000.0, "agent_episode_returns_mean": {"default_agent": 5.299999999999998}, "num_env_steps_sampled_lifetime_throughput": 1245.9937681342549}, "learners": {"__all_modules__": {"learner_connector": {"timers": {"connectors": {"numpy_to_tensor": 0.0002141980298591534, "add_time_dim_to_batch_and_zero_pad": 2.3785599928805822e-05, "general_advantage_estimation": 0.01312976958030449, "batch_individual_items": 0.20258230972994165, "add_columns_from_episodes_to_train_batch": 0.06976527916007941, "add_observations_from_episodes_to_batch": 0.000791696209859856, "add_one_ts_to_episodes_and_truncate": 0.008715232110042279, "add_states_from_episodes_to_batch": 6.108920064525591e-06}}, "connector_pipeline_timer": 0.2955753047099244}, "learner_connector_sum_episodes_length_in": 5000.0, "num_env_steps_trained": 30600, "num_module_steps_trained": 6000, "num_env_steps_trained_lifetime": 91800, "learner_connector_sum_episodes_length_out": 5100.0, "num_trainable_parameters": 3221, "num_non_trainable_parameters": 0, "num_module_steps_trained_lifetime": 18000, "num_env_steps_trained_lifetime_throughput": 948312.6597110698, "num_module_steps_trained_throughput": 186751.4123448405, "num_module_steps_trained_lifetime_throughput": 186588.10730926352}, "default_policy": {"weights_seq_no": 3.0, "num_module_steps_trained_lifetime": 18000, "module_train_batch_size_mean": 1000.0, "vf_loss_unclipped": 49.688743591308594, "mean_kl_loss": 7.63685875426745e-06, "diff_num_grad_updates_vs_sampler_policy": 1.0, "curr_kl_coeff": 0.11004285514354706, "total_loss": 0.08843867480754852, "default_optimizer_learning_rate": 2.15757277e-05, "vf_loss": 0.1516771763563156, "policy_loss": -0.0505964457988739, "num_module_steps_trained": 6000, "gradients_default_optimizer_global_norm": 0.052307307720184326, "entropy": 0.6879927515983582, "vf_explained_var": 0.005225241184234619, "curr_entropy_coeff": 0.0143822734464, "num_trainable_parameters": 3221, "num_module_steps_trained_lifetime_throughput": 187151.9071894107}}, "num_training_step_calls_per_iteration": 1, "evaluation": {"env_runners": {"module_to_env_connector": {"timers": {"connectors": {"remove_single_ts_time_rank_from_batch": 1.5991079249482504e-06, "tensor_to_numpy": 4.703966968297503e-05, "un_batch_to_individual_items": 1.5663299928137074e-05, "normalize_and_clip_actions": 2.2578377234934303e-05, "listify_data_for_vector_env": 3.2032176434356946e-05, "get_actions": 0.00016182557499655928}}, "connector_pipeline_timer": 0.00035983115913034054}, "episode_len_mean": 50.0, "env_to_module_sum_episodes_length_in": 27.168093332125434, "num_module_steps_sampled": {"default_policy": 1000}, "num_episodes": 20, "env_to_module_sum_episodes_length_out": 27.168093332125434, "episode_duration_sec_mean": 0.037736141699974725, "episode_return_min": -16.5, "env_to_module_connector": {"timers": {"connectors": {"add_time_dim_to_batch_and_zero_pad": 5.8940178313197895e-06, "batch_individual_items": 1.916617433774171e-05, "add_observations_from_episodes_to_batch": 6.546795529738312e-06, "add_states_from_episodes_to_batch": 3.5292175574222884e-06, "numpy_to_tensor": 3.130458837177088e-05}}, "connector_pipeline_timer": 0.00011970746856072689}, "env_step_timer": 4.411103222973986e-05, "episode_len_max": 50, "agent_episode_returns_mean": {"default_agent": -0.9}, "env_reset_timer": 0.00020846917012022457, "module_episode_returns_mean": {"default_policy": -0.9}, "num_agent_steps_sampled_lifetime": {"default_agent": 3000}, "episode_return_max": 17.5, "num_env_steps_sampled": 1000, "weights_seq_no": 3.0, "num_episodes_lifetime": 60, "num_env_steps_sampled_lifetime": 16000, "episode_return_mean": -0.9, "episode_len_min": 50, "sample": 0.8070299481701928, "num_agent_steps_sampled": {"default_agent": 1000}, "rlmodule_inference_timer": 9.791281972707965e-05, "num_module_steps_sampled_lifetime": {"default_policy": 3000}, "time_between_sampling": 4.209325013999892}, "num_healthy_workers": 1, "actor_manager_num_outstanding_async_reqs": 0, "num_remote_worker_restarts": 0}, "num_env_steps_sampled_lifetime": -232500.0, "fault_tolerance": {"num_healthy_workers": 0, "num_remote_worker_restarts": 0}, "env_runner_group": {"actor_manager_num_outstanding_async_reqs": 0}, "done": false, "training_iteration": 3, "trial_id": "09438_00000", "date": "2025-08-11_17-04-50", "timestamp": 1754924690, "time_this_iter_s": 5.182667970657349, "time_total_s": 15.250184297561646, "pid": 57918, "hostname": "DESKTOP-3SK5A41", "node_ip": "192.168.40.242", "config": {"exploration_config": {}, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 6, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "env": "Umbrella", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": false, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 0, "create_local_env_runner": true, "num_envs_per_env_runner": 1, "gym_env_vectorize_mode": "SYNC", "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "episodes_to_numpy": true, "max_requests_in_flight_per_env_runner": 1, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "merge_env_runner_states": "training_only", "broadcast_env_runner_states": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "complete_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "sampler_perf_stats_ema_coef": null, "_is_online": true, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": "auto", "num_aggregator_actors_per_learner": 0, "max_requests_in_flight_per_aggregator_actor": 3, "local_gpu_idx": 0, "max_requests_in_flight_per_learner": 3, "gamma": 1, "lr": 2.15757277e-05, "grad_clip": 0.5, "grad_clip_by": "global_norm", "_train_batch_size_per_learner": 5000, "train_batch_size": 4000, "num_epochs": 1, "minibatch_size": 1000, "shuffle_batch_per_epoch": true, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "log_std_clip_param": 20.0, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "_disable_preprocessor_api": false, "_disable_action_flattening": false}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "_learner_class": null, "callbacks_on_algorithm_init": null, "callbacks_on_env_runners_recreated": null, "callbacks_on_offline_eval_runners_recreated": null, "callbacks_on_checkpoint_loaded": null, "callbacks_on_environment_created": null, "callbacks_on_episode_created": null, "callbacks_on_episode_start": null, "callbacks_on_episode_step": null, "callbacks_on_episode_end": null, "callbacks_on_evaluate_start": null, "callbacks_on_evaluate_end": null, "callbacks_on_evaluate_offline_start": null, "callbacks_on_evaluate_offline_end": null, "callbacks_on_sample_end": null, "callbacks_on_train_result": null, "explore": true, "enable_rl_module_and_learner": true, "enable_env_runner_and_connector_v2": true, "_prior_exploration_config": {"type": "StochasticSampling"}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x789255972ac0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "offline_data_class": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_read_batch_size": null, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "materialize_data": false, "materialize_mapped_data": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "ignore_final_observation": false, "prelearner_class": null, "prelearner_buffer_class": null, "prelearner_buffer_kwargs": {}, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_remaining_data": false, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": 1, "evaluation_duration": 20, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_auto_duration_min_env_steps_per_sample": 100, "evaluation_auto_duration_max_env_steps_per_sample": 2000, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 1, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "offline_evaluation_interval": null, "num_offline_eval_runners": 0, "offline_loss_for_module_fn": null, "offline_evaluation_duration": 1, "offline_evaluation_parallel_to_training": false, "offline_evaluation_timeout_s": 120.0, "num_cpus_per_offline_eval_runner": 1, "num_gpus_per_offline_eval_runner": 0, "custom_resources_per_offline_eval_runner": {}, "restart_failed_offline_eval_runners": true, "ignore_offline_eval_runner_failures": false, "max_num_offline_eval_runner_restarts": 1000, "offline_eval_runner_restore_timeout_s": 1800.0, "max_requests_in_flight_per_offline_eval_runner": 1, "validate_offline_eval_runners_after_construction": true, "offline_eval_runner_health_probe_timeout_s": 30.0, "offline_eval_rl_module_inference_only": false, "broadcast_offline_eval_runner_states": false, "offline_eval_batch_size_per_runner": 256, "dataset_num_iters_per_eval_runner": 1, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "log_gradients": true, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 42, "restart_failed_env_runners": true, "ignore_env_runner_failures": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30.0, "env_runner_restore_timeout_s": 1800.0, "_model_config": {}, "_rl_module_spec": "RLModuleSpec(module_class=None, observation_space=None, action_space=None, inference_only=False, learner_only=False, model_config=DefaultModelConfig(fcnet_hiddens=[62, 45], fcnet_activation='tanh', fcnet_kernel_initializer=None, fcnet_kernel_initializer_kwargs=None, fcnet_bias_initializer=None, fcnet_bias_initializer_kwargs=None, conv_filters=None, conv_activation='relu', conv_kernel_initializer=None, conv_kernel_initializer_kwargs=None, conv_bias_initializer=None, conv_bias_initializer_kwargs=None, head_fcnet_hiddens=[], head_fcnet_activation='relu', head_fcnet_kernel_initializer=None, head_fcnet_kernel_initializer_kwargs=None, head_fcnet_bias_initializer=None, head_fcnet_bias_initializer_kwargs=None, free_log_std=False, log_std_clip_param=20.0, vf_share_layers=True, use_lstm=False, max_seq_len=20, lstm_cell_size=256, lstm_use_prev_action=False, lstm_use_prev_reward=False, lstm_kernel_initializer=None, lstm_kernel_initializer_kwargs=None, lstm_bias_initializer=None, lstm_bias_initializer_kwargs=None), catalog_class=None, load_state_path=None, model_config_dict=None)", "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "_validate_config": true, "_use_msgpack_checkpoints": false, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "env_task_fn": -1, "enable_connectors": -1, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.8803428236734, "kl_target": 0.0081878044364, "vf_loss_coeff": 0.981876947508, "entropy_coeff": 0.0143822734464, "clip_param": 0.1609292883306, "vf_clip_param": 0.1530762162174, "entropy_coeff_schedule": null, "lr_schedule": null, "sgd_minibatch_size": -1, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9795292165235, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.callbacks.callbacks.RLlibCallback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 15.250184297561646, "iterations_since_restore": 3, "perf": {"cpu_util_percent": 12.2, "ram_util_percent": 69.68571428571428}}
{"timers": {"training_iteration": 4.335673403578202, "restore_env_runners": 1.4188671298298232e-05, "training_step": 4.33539033470052, "env_runner_sampling_timer": 3.9209764330026884, "learner_update_timer": 0.41067143133064304, "synch_weights": 0.0017457044513409978, "restore_eval_env_runners": 1.6203279668161487e-05, "evaluation_iteration": 0.820246718269908, "synch_eval_env_connectors": 0.0004875384502129236, "synch_env_connectors": 9.08596016829506e-06}, "env_runners": {"env_to_module_connector": {"timers": {"connectors": {"batch_individual_items": 1.88371730952847e-05, "numpy_to_tensor": 3.1939263654783194e-05, "add_time_dim_to_batch_and_zero_pad": 6.510427578718213e-06, "add_observations_from_episodes_to_batch": 6.762417425334127e-06, "add_states_from_episodes_to_batch": 3.4931209856975e-06}}, "connector_pipeline_timer": 0.00012190285200297499}, "num_module_steps_sampled_lifetime": {"default_policy": -475000.0}, "num_episodes": 100.0, "module_to_env_connector": {"timers": {"connectors": {"get_actions": 0.0001674991262251156, "remove_single_ts_time_rank_from_batch": 1.4165747201733359e-06, "tensor_to_numpy": 5.011639704399296e-05, "un_batch_to_individual_items": 1.5396121355126275e-05, "normalize_and_clip_actions": 2.32020906489214e-05, "listify_data_for_vector_env": 3.176859817922751e-05}}, "connector_pipeline_timer": 0.0003678386928633476}, "weights_seq_no": 3.0, "env_to_module_sum_episodes_length_out": 27.16809333212661, "env_step_timer": 4.375593430607476e-05, "num_agent_steps_sampled_lifetime": {"default_agent": -475000.0}, "module_episode_returns_mean": {"default_policy": 3.100000000000002}, "rlmodule_inference_timer": 0.00010046279474685478, "episode_len_max": 50, "time_between_sampling": 0.011577141248280153, "episode_duration_sec_mean": 0.03714447305001158, "num_episodes_lifetime": -9500.0, "env_reset_timer": 0.00010394097450443458, "episode_return_min": -5.5, "num_agent_steps_sampled": {"default_agent": 5000.0}, "episode_return_max": 14.5, "episode_len_mean": 50.0, "num_env_steps_sampled_lifetime": -475000.0, "env_to_module_sum_episodes_length_in": 27.16809333212661, "num_module_steps_sampled": {"default_policy": 5000.0}, "episode_return_mean": 3.100000000000002, "episode_len_min": 50, "sample": 0.039248301398565284, "num_env_steps_sampled": 5000.0, "agent_episode_returns_mean": {"default_agent": 3.100000000000002}, "num_env_steps_sampled_lifetime_throughput": 1252.0463610784132}, "learners": {"__all_modules__": {"learner_connector": {"timers": {"connectors": {"numpy_to_tensor": 0.00021382704956257067, "add_time_dim_to_batch_and_zero_pad": 2.377774393007394e-05, "general_advantage_estimation": 0.013102735884502868, "batch_individual_items": 0.2026516006326456, "add_columns_from_episodes_to_train_batch": 0.06975019236847903, "add_observations_from_episodes_to_batch": 0.0007905622477647093, "add_one_ts_to_episodes_and_truncate": 0.00871346678894103, "add_states_from_episodes_to_batch": 6.113830861667337e-06}}, "connector_pipeline_timer": 0.29559901566282515}, "learner_connector_sum_episodes_length_in": 5000.0, "num_env_steps_trained": 30600, "num_module_steps_trained": 6000, "num_env_steps_trained_lifetime": 122400, "learner_connector_sum_episodes_length_out": 5100.0, "num_trainable_parameters": 3221, "num_non_trainable_parameters": 0, "num_module_steps_trained_lifetime": 24000, "num_env_steps_trained_lifetime_throughput": 943116.6838718221, "num_module_steps_trained_throughput": 185715.26517606268, "num_module_steps_trained_lifetime_throughput": 185554.12753754074}, "default_policy": {"weights_seq_no": 4.0, "num_module_steps_trained_lifetime": 24000, "module_train_batch_size_mean": 1000.0, "vf_loss_unclipped": 40.69322967529297, "mean_kl_loss": 4.28409339292557e-06, "diff_num_grad_updates_vs_sampler_policy": 1.0, "curr_kl_coeff": 0.05502142757177353, "total_loss": 0.2727067768573761, "default_optimizer_learning_rate": 2.15757277e-05, "vf_loss": 0.15105463564395905, "policy_loss": 0.13431134819984436, "num_module_steps_trained": 6000, "gradients_default_optimizer_global_norm": 0.05973426252603531, "entropy": 0.6898887753486633, "vf_explained_var": 0.004837334156036377, "curr_entropy_coeff": 0.0143822734464, "num_trainable_parameters": 3221, "num_module_steps_trained_lifetime_throughput": 186094.89350128252}}, "num_training_step_calls_per_iteration": 1, "evaluation": {"env_runners": {"module_to_env_connector": {"timers": {"connectors": {"remove_single_ts_time_rank_from_batch": 1.5227152417274668e-06, "tensor_to_numpy": 4.716898652627251e-05, "un_batch_to_individual_items": 1.5681149623794563e-05, "normalize_and_clip_actions": 2.3145920603249634e-05, "listify_data_for_vector_env": 3.2965009754807395e-05, "get_actions": 0.0001640030814681786}}, "connector_pipeline_timer": 0.00036586105027856813}, "episode_len_mean": 50.0, "env_to_module_sum_episodes_length_in": 27.168093332126602, "num_module_steps_sampled": {"default_policy": 1000}, "num_episodes": 20, "env_to_module_sum_episodes_length_out": 27.168093332126602, "episode_duration_sec_mean": 0.03722939628747781, "episode_return_min": -16.5, "env_to_module_connector": {"timers": {"connectors": {"add_time_dim_to_batch_and_zero_pad": 6.5019833915886415e-06, "batch_individual_items": 2.1022730488632924e-05, "add_observations_from_episodes_to_batch": 6.5785023569957985e-06, "add_states_from_episodes_to_batch": 3.7914434150860834e-06, "numpy_to_tensor": 3.1532911482272494e-05}}, "connector_pipeline_timer": 0.00012449776124949142}, "env_step_timer": 4.5573339348655444e-05, "episode_len_max": 50, "agent_episode_returns_mean": {"default_agent": -0.9}, "env_reset_timer": 0.0002076984784200249, "module_episode_returns_mean": {"default_policy": -0.9}, "num_agent_steps_sampled_lifetime": {"default_agent": 4000}, "episode_return_max": 17.5, "num_env_steps_sampled": 1000, "weights_seq_no": 4.0, "num_episodes_lifetime": 80, "num_env_steps_sampled_lifetime": 21000, "episode_return_mean": -0.9, "episode_len_min": 50, "sample": 0.8063939366984948, "num_agent_steps_sampled": {"default_agent": 1000}, "rlmodule_inference_timer": 0.00010168978603895365, "num_module_steps_sampled_lifetime": {"default_policy": 4000}, "time_between_sampling": 4.210931145909892}, "num_healthy_workers": 1, "actor_manager_num_outstanding_async_reqs": 0, "num_remote_worker_restarts": 0}, "num_env_steps_sampled_lifetime": -475000.0, "fault_tolerance": {"num_healthy_workers": 0, "num_remote_worker_restarts": 0}, "env_runner_group": {"actor_manager_num_outstanding_async_reqs": 0}, "done": false, "training_iteration": 4, "trial_id": "09438_00000", "date": "2025-08-11_17-04-55", "timestamp": 1754924695, "time_this_iter_s": 5.073182821273804, "time_total_s": 20.32336711883545, "pid": 57918, "hostname": "DESKTOP-3SK5A41", "node_ip": "192.168.40.242", "config": {"exploration_config": {}, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 6, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "env": "Umbrella", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": false, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 0, "create_local_env_runner": true, "num_envs_per_env_runner": 1, "gym_env_vectorize_mode": "SYNC", "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "episodes_to_numpy": true, "max_requests_in_flight_per_env_runner": 1, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "merge_env_runner_states": "training_only", "broadcast_env_runner_states": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "complete_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "sampler_perf_stats_ema_coef": null, "_is_online": true, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": "auto", "num_aggregator_actors_per_learner": 0, "max_requests_in_flight_per_aggregator_actor": 3, "local_gpu_idx": 0, "max_requests_in_flight_per_learner": 3, "gamma": 1, "lr": 2.15757277e-05, "grad_clip": 0.5, "grad_clip_by": "global_norm", "_train_batch_size_per_learner": 5000, "train_batch_size": 4000, "num_epochs": 1, "minibatch_size": 1000, "shuffle_batch_per_epoch": true, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "log_std_clip_param": 20.0, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "_disable_preprocessor_api": false, "_disable_action_flattening": false}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "_learner_class": null, "callbacks_on_algorithm_init": null, "callbacks_on_env_runners_recreated": null, "callbacks_on_offline_eval_runners_recreated": null, "callbacks_on_checkpoint_loaded": null, "callbacks_on_environment_created": null, "callbacks_on_episode_created": null, "callbacks_on_episode_start": null, "callbacks_on_episode_step": null, "callbacks_on_episode_end": null, "callbacks_on_evaluate_start": null, "callbacks_on_evaluate_end": null, "callbacks_on_evaluate_offline_start": null, "callbacks_on_evaluate_offline_end": null, "callbacks_on_sample_end": null, "callbacks_on_train_result": null, "explore": true, "enable_rl_module_and_learner": true, "enable_env_runner_and_connector_v2": true, "_prior_exploration_config": {"type": "StochasticSampling"}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x789255972ac0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "offline_data_class": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_read_batch_size": null, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "materialize_data": false, "materialize_mapped_data": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "ignore_final_observation": false, "prelearner_class": null, "prelearner_buffer_class": null, "prelearner_buffer_kwargs": {}, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_remaining_data": false, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": 1, "evaluation_duration": 20, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_auto_duration_min_env_steps_per_sample": 100, "evaluation_auto_duration_max_env_steps_per_sample": 2000, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 1, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "offline_evaluation_interval": null, "num_offline_eval_runners": 0, "offline_loss_for_module_fn": null, "offline_evaluation_duration": 1, "offline_evaluation_parallel_to_training": false, "offline_evaluation_timeout_s": 120.0, "num_cpus_per_offline_eval_runner": 1, "num_gpus_per_offline_eval_runner": 0, "custom_resources_per_offline_eval_runner": {}, "restart_failed_offline_eval_runners": true, "ignore_offline_eval_runner_failures": false, "max_num_offline_eval_runner_restarts": 1000, "offline_eval_runner_restore_timeout_s": 1800.0, "max_requests_in_flight_per_offline_eval_runner": 1, "validate_offline_eval_runners_after_construction": true, "offline_eval_runner_health_probe_timeout_s": 30.0, "offline_eval_rl_module_inference_only": false, "broadcast_offline_eval_runner_states": false, "offline_eval_batch_size_per_runner": 256, "dataset_num_iters_per_eval_runner": 1, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "log_gradients": true, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 42, "restart_failed_env_runners": true, "ignore_env_runner_failures": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30.0, "env_runner_restore_timeout_s": 1800.0, "_model_config": {}, "_rl_module_spec": "RLModuleSpec(module_class=None, observation_space=None, action_space=None, inference_only=False, learner_only=False, model_config=DefaultModelConfig(fcnet_hiddens=[62, 45], fcnet_activation='tanh', fcnet_kernel_initializer=None, fcnet_kernel_initializer_kwargs=None, fcnet_bias_initializer=None, fcnet_bias_initializer_kwargs=None, conv_filters=None, conv_activation='relu', conv_kernel_initializer=None, conv_kernel_initializer_kwargs=None, conv_bias_initializer=None, conv_bias_initializer_kwargs=None, head_fcnet_hiddens=[], head_fcnet_activation='relu', head_fcnet_kernel_initializer=None, head_fcnet_kernel_initializer_kwargs=None, head_fcnet_bias_initializer=None, head_fcnet_bias_initializer_kwargs=None, free_log_std=False, log_std_clip_param=20.0, vf_share_layers=True, use_lstm=False, max_seq_len=20, lstm_cell_size=256, lstm_use_prev_action=False, lstm_use_prev_reward=False, lstm_kernel_initializer=None, lstm_kernel_initializer_kwargs=None, lstm_bias_initializer=None, lstm_bias_initializer_kwargs=None), catalog_class=None, load_state_path=None, model_config_dict=None)", "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "_validate_config": true, "_use_msgpack_checkpoints": false, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "env_task_fn": -1, "enable_connectors": -1, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.8803428236734, "kl_target": 0.0081878044364, "vf_loss_coeff": 0.981876947508, "entropy_coeff": 0.0143822734464, "clip_param": 0.1609292883306, "vf_clip_param": 0.1530762162174, "entropy_coeff_schedule": null, "lr_schedule": null, "sgd_minibatch_size": -1, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9795292165235, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.callbacks.callbacks.RLlibCallback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 20.32336711883545, "iterations_since_restore": 4, "perf": {"cpu_util_percent": 11.275, "ram_util_percent": 69.7}}
{"timers": {"training_iteration": 4.333603211702421, "restore_env_runners": 1.4174784582263595e-05, "training_step": 4.333318811513516, "env_runner_sampling_timer": 3.9212263468226585, "learner_update_timer": 0.4083515820273356, "synch_weights": 0.0017418674068273067, "restore_eval_env_runners": 1.6298246872991056e-05, "evaluation_iteration": 0.8195808750972082, "synch_eval_env_connectors": 0.0004871290657065674, "synch_env_connectors": 9.06710056915881e-06}, "env_runners": {"env_to_module_connector": {"timers": {"connectors": {"batch_individual_items": 1.876415167825396e-05, "numpy_to_tensor": 3.1642565490994986e-05, "add_time_dim_to_batch_and_zero_pad": 6.464799280061731e-06, "add_observations_from_episodes_to_batch": 6.735929124595739e-06, "add_states_from_episodes_to_batch": 3.4820831764264756e-06}}, "connector_pipeline_timer": 0.00012108932630022786}, "num_module_steps_sampled_lifetime": {"default_policy": -717500.0}, "num_episodes": 100.0, "module_to_env_connector": {"timers": {"connectors": {"get_actions": 0.0001662040512942231, "remove_single_ts_time_rank_from_batch": 1.3846747782013434e-06, "tensor_to_numpy": 4.973741726087574e-05, "un_batch_to_individual_items": 1.531304147416869e-05, "normalize_and_clip_actions": 2.285638070248095e-05, "listify_data_for_vector_env": 3.156171040855379e-05}}, "connector_pipeline_timer": 0.00036490466246663113}, "weights_seq_no": 4.0, "env_to_module_sum_episodes_length_out": 27.16809333212661, "env_step_timer": 4.348804243799886e-05, "num_agent_steps_sampled_lifetime": {"default_agent": -717500.0}, "module_episode_returns_mean": {"default_policy": 4.100000000000001}, "rlmodule_inference_timer": 9.907318584278363e-05, "episode_len_max": 50, "time_between_sampling": 0.012420894110516507, "episode_duration_sec_mean": 0.03685738513999695, "num_episodes_lifetime": -14350.0, "env_reset_timer": 9.990789448346079e-05, "episode_return_min": -5.5, "num_agent_steps_sampled": {"default_agent": 5000.0}, "episode_return_max": 14.5, "episode_len_mean": 50.0, "num_env_steps_sampled_lifetime": -717500.0, "env_to_module_sum_episodes_length_in": 27.16809333212661, "num_module_steps_sampled": {"default_policy": 5000.0}, "episode_return_mean": 4.100000000000001, "episode_len_min": 50, "sample": 0.038529853579960714, "num_env_steps_sampled": 5000.0, "agent_episode_returns_mean": {"default_agent": 4.100000000000001}, "num_env_steps_sampled_lifetime_throughput": 1265.496394080723}, "learners": {"__all_modules__": {"learner_connector": {"timers": {"connectors": {"numpy_to_tensor": 0.00021342577906926697, "add_time_dim_to_batch_and_zero_pad": 2.3744966491960928e-05, "general_advantage_estimation": 0.01305727652565735, "batch_individual_items": 0.20122099562631948, "add_columns_from_episodes_to_train_batch": 0.06973545344479404, "add_observations_from_episodes_to_batch": 0.0007895116252885134, "add_one_ts_to_episodes_and_truncate": 0.008709144121052179, "add_states_from_episodes_to_batch": 6.10669255496069e-06}}, "connector_pipeline_timer": 0.294101975506198}, "learner_connector_sum_episodes_length_in": 5000.0, "num_env_steps_trained": 30600, "num_module_steps_trained": 6000, "num_env_steps_trained_lifetime": 153000, "learner_connector_sum_episodes_length_out": 5100.0, "num_trainable_parameters": 3221, "num_non_trainable_parameters": 0, "num_module_steps_trained_lifetime": 30000, "num_env_steps_trained_lifetime_throughput": 939394.7370512788, "num_module_steps_trained_throughput": 184963.69919606188, "num_module_steps_trained_lifetime_throughput": 184806.17485738898}, "default_policy": {"weights_seq_no": 5.0, "num_module_steps_trained_lifetime": 30000, "module_train_batch_size_mean": 1000.0, "vf_loss_unclipped": 51.944557189941406, "mean_kl_loss": 3.735441396202077e-06, "diff_num_grad_updates_vs_sampler_policy": 1.0, "curr_kl_coeff": 0.027510713785886765, "total_loss": -0.12179990857839584, "default_optimizer_learning_rate": 2.15757277e-05, "vf_loss": 0.151831716299057, "policy_loss": -0.260983943939209, "num_module_steps_trained": 6000, "gradients_default_optimizer_global_norm": 0.05242041498422623, "entropy": 0.6880881786346436, "vf_explained_var": 0.005549788475036621, "curr_entropy_coeff": 0.0143822734464, "num_trainable_parameters": 3221, "num_module_steps_trained_lifetime_throughput": 185320.60905230555}}, "num_training_step_calls_per_iteration": 1, "evaluation": {"env_runners": {"module_to_env_connector": {"timers": {"connectors": {"remove_single_ts_time_rank_from_batch": 1.4333141287315912e-06, "tensor_to_numpy": 4.549137465293529e-05, "un_batch_to_individual_items": 1.540786375134858e-05, "normalize_and_clip_actions": 2.172363409720533e-05, "listify_data_for_vector_env": 3.0535458929356125e-05, "get_actions": 0.0001550898882541806}}, "connector_pipeline_timer": 0.0003446234014944767}, "episode_len_mean": 50.0, "env_to_module_sum_episodes_length_in": 27.168093332126602, "num_module_steps_sampled": {"default_policy": 1000}, "num_episodes": 20, "env_to_module_sum_episodes_length_out": 27.168093332126602, "episode_duration_sec_mean": 0.036868192059987454, "episode_return_min": -16.5, "env_to_module_connector": {"timers": {"connectors": {"add_time_dim_to_batch_and_zero_pad": 5.7942509694179016e-06, "batch_individual_items": 1.8681726257681333e-05, "add_observations_from_episodes_to_batch": 6.245442647292379e-06, "add_states_from_episodes_to_batch": 3.3851927169730995e-06, "numpy_to_tensor": 2.987335682786081e-05}}, "connector_pipeline_timer": 0.00011591794218350933}, "env_step_timer": 4.279934445312421e-05, "episode_len_max": 50, "agent_episode_returns_mean": {"default_agent": -0.1}, "env_reset_timer": 0.000206929493636615, "module_episode_returns_mean": {"default_policy": -0.1}, "num_agent_steps_sampled_lifetime": {"default_agent": 5000}, "episode_return_max": 17.5, "num_env_steps_sampled": 1000, "weights_seq_no": 5.0, "num_episodes_lifetime": 100, "num_env_steps_sampled_lifetime": 26000, "episode_return_mean": -0.1, "episode_len_min": 50, "sample": 0.8056973733615116, "num_agent_steps_sampled": {"default_agent": 1000}, "rlmodule_inference_timer": 9.232642119799557e-05, "num_module_steps_sampled_lifetime": {"default_policy": 5000}, "time_between_sampling": 4.210672831610792}, "num_healthy_workers": 1, "actor_manager_num_outstanding_async_reqs": 0, "num_remote_worker_restarts": 0}, "num_env_steps_sampled_lifetime": -717500.0, "fault_tolerance": {"num_healthy_workers": 0, "num_remote_worker_restarts": 0}, "env_runner_group": {"actor_manager_num_outstanding_async_reqs": 0}, "done": false, "training_iteration": 5, "trial_id": "09438_00000", "date": "2025-08-11_17-05-00", "timestamp": 1754924700, "time_this_iter_s": 4.8797712326049805, "time_total_s": 25.20313835144043, "pid": 57918, "hostname": "DESKTOP-3SK5A41", "node_ip": "192.168.40.242", "config": {"exploration_config": {}, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 6, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "env": "Umbrella", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": false, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 0, "create_local_env_runner": true, "num_envs_per_env_runner": 1, "gym_env_vectorize_mode": "SYNC", "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "episodes_to_numpy": true, "max_requests_in_flight_per_env_runner": 1, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "merge_env_runner_states": "training_only", "broadcast_env_runner_states": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "complete_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "sampler_perf_stats_ema_coef": null, "_is_online": true, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": "auto", "num_aggregator_actors_per_learner": 0, "max_requests_in_flight_per_aggregator_actor": 3, "local_gpu_idx": 0, "max_requests_in_flight_per_learner": 3, "gamma": 1, "lr": 2.15757277e-05, "grad_clip": 0.5, "grad_clip_by": "global_norm", "_train_batch_size_per_learner": 5000, "train_batch_size": 4000, "num_epochs": 1, "minibatch_size": 1000, "shuffle_batch_per_epoch": true, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "log_std_clip_param": 20.0, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "_disable_preprocessor_api": false, "_disable_action_flattening": false}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "_learner_class": null, "callbacks_on_algorithm_init": null, "callbacks_on_env_runners_recreated": null, "callbacks_on_offline_eval_runners_recreated": null, "callbacks_on_checkpoint_loaded": null, "callbacks_on_environment_created": null, "callbacks_on_episode_created": null, "callbacks_on_episode_start": null, "callbacks_on_episode_step": null, "callbacks_on_episode_end": null, "callbacks_on_evaluate_start": null, "callbacks_on_evaluate_end": null, "callbacks_on_evaluate_offline_start": null, "callbacks_on_evaluate_offline_end": null, "callbacks_on_sample_end": null, "callbacks_on_train_result": null, "explore": true, "enable_rl_module_and_learner": true, "enable_env_runner_and_connector_v2": true, "_prior_exploration_config": {"type": "StochasticSampling"}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x789255972ac0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "offline_data_class": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_read_batch_size": null, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "materialize_data": false, "materialize_mapped_data": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "ignore_final_observation": false, "prelearner_class": null, "prelearner_buffer_class": null, "prelearner_buffer_kwargs": {}, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_remaining_data": false, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": 1, "evaluation_duration": 20, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_auto_duration_min_env_steps_per_sample": 100, "evaluation_auto_duration_max_env_steps_per_sample": 2000, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 1, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "offline_evaluation_interval": null, "num_offline_eval_runners": 0, "offline_loss_for_module_fn": null, "offline_evaluation_duration": 1, "offline_evaluation_parallel_to_training": false, "offline_evaluation_timeout_s": 120.0, "num_cpus_per_offline_eval_runner": 1, "num_gpus_per_offline_eval_runner": 0, "custom_resources_per_offline_eval_runner": {}, "restart_failed_offline_eval_runners": true, "ignore_offline_eval_runner_failures": false, "max_num_offline_eval_runner_restarts": 1000, "offline_eval_runner_restore_timeout_s": 1800.0, "max_requests_in_flight_per_offline_eval_runner": 1, "validate_offline_eval_runners_after_construction": true, "offline_eval_runner_health_probe_timeout_s": 30.0, "offline_eval_rl_module_inference_only": false, "broadcast_offline_eval_runner_states": false, "offline_eval_batch_size_per_runner": 256, "dataset_num_iters_per_eval_runner": 1, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "log_gradients": true, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 42, "restart_failed_env_runners": true, "ignore_env_runner_failures": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30.0, "env_runner_restore_timeout_s": 1800.0, "_model_config": {}, "_rl_module_spec": "RLModuleSpec(module_class=None, observation_space=None, action_space=None, inference_only=False, learner_only=False, model_config=DefaultModelConfig(fcnet_hiddens=[62, 45], fcnet_activation='tanh', fcnet_kernel_initializer=None, fcnet_kernel_initializer_kwargs=None, fcnet_bias_initializer=None, fcnet_bias_initializer_kwargs=None, conv_filters=None, conv_activation='relu', conv_kernel_initializer=None, conv_kernel_initializer_kwargs=None, conv_bias_initializer=None, conv_bias_initializer_kwargs=None, head_fcnet_hiddens=[], head_fcnet_activation='relu', head_fcnet_kernel_initializer=None, head_fcnet_kernel_initializer_kwargs=None, head_fcnet_bias_initializer=None, head_fcnet_bias_initializer_kwargs=None, free_log_std=False, log_std_clip_param=20.0, vf_share_layers=True, use_lstm=False, max_seq_len=20, lstm_cell_size=256, lstm_use_prev_action=False, lstm_use_prev_reward=False, lstm_kernel_initializer=None, lstm_kernel_initializer_kwargs=None, lstm_bias_initializer=None, lstm_bias_initializer_kwargs=None), catalog_class=None, load_state_path=None, model_config_dict=None)", "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "_validate_config": true, "_use_msgpack_checkpoints": false, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "env_task_fn": -1, "enable_connectors": -1, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.8803428236734, "kl_target": 0.0081878044364, "vf_loss_coeff": 0.981876947508, "entropy_coeff": 0.0143822734464, "clip_param": 0.1609292883306, "vf_clip_param": 0.1530762162174, "entropy_coeff_schedule": null, "lr_schedule": null, "sgd_minibatch_size": -1, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9795292165235, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.callbacks.callbacks.RLlibCallback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 25.20313835144043, "iterations_since_restore": 5, "perf": {"cpu_util_percent": 11.928571428571429, "ram_util_percent": 69.7}}
{"timers": {"training_iteration": 4.332754010745396, "restore_env_runners": 1.4148036738992783e-05, "training_step": 4.332469049558382, "env_runner_sampling_timer": 3.9211477275044286, "learner_update_timer": 0.4075815212170598, "synch_weights": 0.0017388687327567326, "restore_eval_env_runners": 1.6243264403533722e-05, "evaluation_iteration": 0.8188505943762382, "synch_eval_env_connectors": 0.0004863517750503067, "synch_env_connectors": 9.04442956284079e-06}, "env_runners": {"env_to_module_connector": {"timers": {"connectors": {"batch_individual_items": 1.865698908436117e-05, "numpy_to_tensor": 3.134749951543728e-05, "add_time_dim_to_batch_and_zero_pad": 6.4533709350943875e-06, "add_observations_from_episodes_to_batch": 6.719565252468012e-06, "add_states_from_episodes_to_batch": 3.4248545664061326e-06}}, "connector_pipeline_timer": 0.00012021414848209783}, "num_module_steps_sampled_lifetime": {"default_policy": -960000.0}, "num_episodes": 100.0, "module_to_env_connector": {"timers": {"connectors": {"get_actions": 0.00016468031022000791, "remove_single_ts_time_rank_from_batch": 1.3676408527647634e-06, "tensor_to_numpy": 4.924575707664182e-05, "un_batch_to_individual_items": 1.520295980999595e-05, "normalize_and_clip_actions": 2.282587251490661e-05, "listify_data_for_vector_env": 3.152293363855961e-05}}, "connector_pipeline_timer": 0.0003619375100371662}, "weights_seq_no": 5.0, "env_to_module_sum_episodes_length_out": 27.16809333212661, "env_step_timer": 4.320006609147536e-05, "num_agent_steps_sampled_lifetime": {"default_agent": -960000.0}, "module_episode_returns_mean": {"default_policy": 4.899999999999999}, "rlmodule_inference_timer": 9.914473984538294e-05, "episode_len_max": 50, "time_between_sampling": 0.011666034382836863, "episode_duration_sec_mean": 0.03659311213002184, "num_episodes_lifetime": -19200.0, "env_reset_timer": 9.673918408599136e-05, "episode_return_min": -5.5, "num_agent_steps_sampled": {"default_agent": 5000.0}, "episode_return_max": 14.5, "episode_len_mean": 50.0, "num_env_steps_sampled_lifetime": -960000.0, "env_to_module_sum_episodes_length_in": 27.16809333212661, "num_module_steps_sampled": {"default_policy": 5000.0}, "episode_return_mean": 4.899999999999999, "episode_len_min": 50, "sample": 0.038017601798579166, "num_env_steps_sampled": 5000.0, "agent_episode_returns_mean": {"default_agent": 4.899999999999999}, "num_env_steps_sampled_lifetime_throughput": 1276.5406087635067}, "learners": {"__all_modules__": {"learner_connector": {"timers": {"connectors": {"numpy_to_tensor": 0.00021366752127621345, "add_time_dim_to_batch_and_zero_pad": 2.3739516824636585e-05, "general_advantage_estimation": 0.013027555760401262, "batch_individual_items": 0.20128090068005247, "add_columns_from_episodes_to_train_batch": 0.06973477391034533, "add_observations_from_episodes_to_batch": 0.0007889705090350237, "add_one_ts_to_episodes_and_truncate": 0.008705281679843323, "add_states_from_episodes_to_batch": 6.098625632801563e-06}}, "connector_pipeline_timer": 0.2941273237611335}, "learner_connector_sum_episodes_length_in": 5000.0, "num_env_steps_trained": 30600, "num_module_steps_trained": 6000, "num_env_steps_trained_lifetime": 183600, "learner_connector_sum_episodes_length_out": 5100.0, "num_trainable_parameters": 3221, "num_non_trainable_parameters": 0, "num_module_steps_trained_lifetime": 36000, "num_env_steps_trained_lifetime_throughput": 935359.9497825159, "num_module_steps_trained_throughput": 184146.24884200632, "num_module_steps_trained_lifetime_throughput": 183993.10630331852}, "default_policy": {"weights_seq_no": 6.0, "num_module_steps_trained_lifetime": 36000, "module_train_batch_size_mean": 1000.0, "vf_loss_unclipped": 46.6142692565918, "mean_kl_loss": 1.6762377299528453e-06, "diff_num_grad_updates_vs_sampler_policy": 1.0, "curr_kl_coeff": 0.013755356892943382, "total_loss": 0.19359509646892548, "default_optimizer_learning_rate": 2.15757277e-05, "vf_loss": 0.15152013301849365, "policy_loss": 0.0547315888106823, "num_module_steps_trained": 6000, "gradients_default_optimizer_global_norm": 0.04573618248105049, "entropy": 0.6890905499458313, "vf_explained_var": 0.005295395851135254, "curr_entropy_coeff": 0.0143822734464, "num_trainable_parameters": 3221, "num_module_steps_trained_lifetime_throughput": 184477.84181975227}}, "num_training_step_calls_per_iteration": 1, "evaluation": {"env_runners": {"module_to_env_connector": {"timers": {"connectors": {"remove_single_ts_time_rank_from_batch": 1.461103979765745e-06, "tensor_to_numpy": 4.506389860541315e-05, "un_batch_to_individual_items": 1.552788110336827e-05, "normalize_and_clip_actions": 2.2566216508342186e-05, "listify_data_for_vector_env": 3.123526115769896e-05, "get_actions": 0.0001543825892513575}}, "connector_pipeline_timer": 0.0003461158146135804}, "episode_len_mean": 50.0, "env_to_module_sum_episodes_length_in": 27.168093332126602, "num_module_steps_sampled": {"default_policy": 1000}, "num_episodes": 20, "env_to_module_sum_episodes_length_out": 27.168093332126602, "episode_duration_sec_mean": 0.03624188807000337, "episode_return_min": -16.5, "env_to_module_connector": {"timers": {"connectors": {"add_time_dim_to_batch_and_zero_pad": 5.875756696688408e-06, "batch_individual_items": 1.86837384688504e-05, "add_observations_from_episodes_to_batch": 6.334872127246727e-06, "add_states_from_episodes_to_batch": 3.5669352944835876e-06, "numpy_to_tensor": 2.9456667846061456e-05}}, "connector_pipeline_timer": 0.00011560118970722686}, "env_step_timer": 4.200535545440549e-05, "episode_len_max": 50, "agent_episode_returns_mean": {"default_agent": 1.3}, "env_reset_timer": 0.00020611419869912917, "module_episode_returns_mean": {"default_policy": 1.3}, "num_agent_steps_sampled_lifetime": {"default_agent": 6000}, "episode_return_max": 17.5, "num_env_steps_sampled": 1000, "weights_seq_no": 6.0, "num_episodes_lifetime": 120, "num_env_steps_sampled_lifetime": 31000, "episode_return_mean": 1.3, "episode_len_min": 50, "sample": 0.805045764637896, "num_agent_steps_sampled": {"default_agent": 1000}, "rlmodule_inference_timer": 9.368969824293475e-05, "num_module_steps_sampled_lifetime": {"default_policy": 6000}, "time_between_sampling": 4.211613687454683}, "num_healthy_workers": 1, "actor_manager_num_outstanding_async_reqs": 0, "num_remote_worker_restarts": 0}, "num_env_steps_sampled_lifetime": -960000.0, "fault_tolerance": {"num_healthy_workers": 0, "num_remote_worker_restarts": 0}, "env_runner_group": {"actor_manager_num_outstanding_async_reqs": 0}, "done": false, "training_iteration": 6, "trial_id": "09438_00000", "date": "2025-08-11_17-05-05", "timestamp": 1754924705, "time_this_iter_s": 5.003680467605591, "time_total_s": 30.20681881904602, "pid": 57918, "hostname": "DESKTOP-3SK5A41", "node_ip": "192.168.40.242", "config": {"exploration_config": {}, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 6, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "env": "Umbrella", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": false, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 0, "create_local_env_runner": true, "num_envs_per_env_runner": 1, "gym_env_vectorize_mode": "SYNC", "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "episodes_to_numpy": true, "max_requests_in_flight_per_env_runner": 1, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "merge_env_runner_states": "training_only", "broadcast_env_runner_states": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "complete_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "sampler_perf_stats_ema_coef": null, "_is_online": true, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": "auto", "num_aggregator_actors_per_learner": 0, "max_requests_in_flight_per_aggregator_actor": 3, "local_gpu_idx": 0, "max_requests_in_flight_per_learner": 3, "gamma": 1, "lr": 2.15757277e-05, "grad_clip": 0.5, "grad_clip_by": "global_norm", "_train_batch_size_per_learner": 5000, "train_batch_size": 4000, "num_epochs": 1, "minibatch_size": 1000, "shuffle_batch_per_epoch": true, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "log_std_clip_param": 20.0, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "_disable_preprocessor_api": false, "_disable_action_flattening": false}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "_learner_class": null, "callbacks_on_algorithm_init": null, "callbacks_on_env_runners_recreated": null, "callbacks_on_offline_eval_runners_recreated": null, "callbacks_on_checkpoint_loaded": null, "callbacks_on_environment_created": null, "callbacks_on_episode_created": null, "callbacks_on_episode_start": null, "callbacks_on_episode_step": null, "callbacks_on_episode_end": null, "callbacks_on_evaluate_start": null, "callbacks_on_evaluate_end": null, "callbacks_on_evaluate_offline_start": null, "callbacks_on_evaluate_offline_end": null, "callbacks_on_sample_end": null, "callbacks_on_train_result": null, "explore": true, "enable_rl_module_and_learner": true, "enable_env_runner_and_connector_v2": true, "_prior_exploration_config": {"type": "StochasticSampling"}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x789255972ac0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "offline_data_class": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_read_batch_size": null, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "materialize_data": false, "materialize_mapped_data": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "ignore_final_observation": false, "prelearner_class": null, "prelearner_buffer_class": null, "prelearner_buffer_kwargs": {}, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_remaining_data": false, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": 1, "evaluation_duration": 20, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_auto_duration_min_env_steps_per_sample": 100, "evaluation_auto_duration_max_env_steps_per_sample": 2000, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 1, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "offline_evaluation_interval": null, "num_offline_eval_runners": 0, "offline_loss_for_module_fn": null, "offline_evaluation_duration": 1, "offline_evaluation_parallel_to_training": false, "offline_evaluation_timeout_s": 120.0, "num_cpus_per_offline_eval_runner": 1, "num_gpus_per_offline_eval_runner": 0, "custom_resources_per_offline_eval_runner": {}, "restart_failed_offline_eval_runners": true, "ignore_offline_eval_runner_failures": false, "max_num_offline_eval_runner_restarts": 1000, "offline_eval_runner_restore_timeout_s": 1800.0, "max_requests_in_flight_per_offline_eval_runner": 1, "validate_offline_eval_runners_after_construction": true, "offline_eval_runner_health_probe_timeout_s": 30.0, "offline_eval_rl_module_inference_only": false, "broadcast_offline_eval_runner_states": false, "offline_eval_batch_size_per_runner": 256, "dataset_num_iters_per_eval_runner": 1, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "log_gradients": true, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 42, "restart_failed_env_runners": true, "ignore_env_runner_failures": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30.0, "env_runner_restore_timeout_s": 1800.0, "_model_config": {}, "_rl_module_spec": "RLModuleSpec(module_class=None, observation_space=None, action_space=None, inference_only=False, learner_only=False, model_config=DefaultModelConfig(fcnet_hiddens=[62, 45], fcnet_activation='tanh', fcnet_kernel_initializer=None, fcnet_kernel_initializer_kwargs=None, fcnet_bias_initializer=None, fcnet_bias_initializer_kwargs=None, conv_filters=None, conv_activation='relu', conv_kernel_initializer=None, conv_kernel_initializer_kwargs=None, conv_bias_initializer=None, conv_bias_initializer_kwargs=None, head_fcnet_hiddens=[], head_fcnet_activation='relu', head_fcnet_kernel_initializer=None, head_fcnet_kernel_initializer_kwargs=None, head_fcnet_bias_initializer=None, head_fcnet_bias_initializer_kwargs=None, free_log_std=False, log_std_clip_param=20.0, vf_share_layers=True, use_lstm=False, max_seq_len=20, lstm_cell_size=256, lstm_use_prev_action=False, lstm_use_prev_reward=False, lstm_kernel_initializer=None, lstm_kernel_initializer_kwargs=None, lstm_bias_initializer=None, lstm_bias_initializer_kwargs=None), catalog_class=None, load_state_path=None, model_config_dict=None)", "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "_validate_config": true, "_use_msgpack_checkpoints": false, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "env_task_fn": -1, "enable_connectors": -1, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.8803428236734, "kl_target": 0.0081878044364, "vf_loss_coeff": 0.981876947508, "entropy_coeff": 0.0143822734464, "clip_param": 0.1609292883306, "vf_clip_param": 0.1530762162174, "entropy_coeff_schedule": null, "lr_schedule": null, "sgd_minibatch_size": -1, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9795292165235, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.callbacks.callbacks.RLlibCallback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 30.20681881904602, "iterations_since_restore": 6, "perf": {"cpu_util_percent": 11.814285714285715, "ram_util_percent": 69.7}}
{"timers": {"training_iteration": 4.330614983717942, "restore_env_runners": 1.4117556370981545e-05, "training_step": 4.330329015142798, "env_runner_sampling_timer": 3.9213150623093833, "learner_update_timer": 0.4052751010048904, "synch_weights": 0.0017355300454289352, "restore_eval_env_runners": 1.6183831757078286e-05, "evaluation_iteration": 0.8181660324424758, "synch_eval_env_connectors": 0.0004861722573002558, "synch_env_connectors": 9.022985265105499e-06}, "env_runners": {"env_to_module_connector": {"timers": {"connectors": {"batch_individual_items": 1.8683294392805432e-05, "numpy_to_tensor": 3.15654382680265e-05, "add_time_dim_to_batch_and_zero_pad": 6.4808818611722766e-06, "add_observations_from_episodes_to_batch": 6.786728307976089e-06, "add_states_from_episodes_to_batch": 3.4592450520491286e-06}}, "connector_pipeline_timer": 0.00012070179157218854}, "num_module_steps_sampled_lifetime": {"default_policy": -1202500.0}, "num_episodes": 100.0, "module_to_env_connector": {"timers": {"connectors": {"get_actions": 0.00016605415990352546, "remove_single_ts_time_rank_from_batch": 1.4074078419188186e-06, "tensor_to_numpy": 4.936773144460845e-05, "un_batch_to_individual_items": 1.537319849543171e-05, "normalize_and_clip_actions": 2.2908089224668057e-05, "listify_data_for_vector_env": 3.166216011585129e-05}}, "connector_pipeline_timer": 0.00036435544550478304}, "weights_seq_no": 6.0, "env_to_module_sum_episodes_length_out": 27.16809333212661, "env_step_timer": 4.3499530843616756e-05, "num_agent_steps_sampled_lifetime": {"default_agent": -1202500.0}, "module_episode_returns_mean": {"default_policy": 6.5}, "rlmodule_inference_timer": 9.906896721729578e-05, "episode_len_max": 50, "time_between_sampling": 0.012372216223500966, "episode_duration_sec_mean": 0.03681557507001344, "num_episodes_lifetime": -24050.0, "env_reset_timer": 9.600335183215207e-05, "episode_return_min": -5.5, "num_agent_steps_sampled": {"default_agent": 5000.0}, "episode_return_max": 14.5, "episode_len_mean": 50.0, "num_env_steps_sampled_lifetime": -1202500.0, "env_to_module_sum_episodes_length_in": 27.16809333212661, "num_module_steps_sampled": {"default_policy": 5000.0}, "episode_return_mean": 6.5, "episode_len_min": 50, "sample": 0.0378575959272941, "num_env_steps_sampled": 5000.0, "agent_episode_returns_mean": {"default_agent": 6.5}, "num_env_steps_sampled_lifetime_throughput": 1271.1269104782234}, "learners": {"__all_modules__": {"learner_connector": {"timers": {"connectors": {"numpy_to_tensor": 0.00021338684606695083, "add_time_dim_to_batch_and_zero_pad": 2.3725121653667148e-05, "general_advantage_estimation": 0.012985158202801161, "batch_individual_items": 0.1998688406732521, "add_columns_from_episodes_to_train_batch": 0.06973261617124314, "add_observations_from_episodes_to_batch": 0.000788130803943927, "add_one_ts_to_episodes_and_truncate": 0.008700817863043624, "add_states_from_episodes_to_batch": 6.086639376690894e-06}}, "connector_pipeline_timer": 0.2926647675235221}, "learner_connector_sum_episodes_length_in": 5000.0, "num_env_steps_trained": 30600, "num_module_steps_trained": 6000, "num_env_steps_trained_lifetime": 214200, "learner_connector_sum_episodes_length_out": 5100.0, "num_trainable_parameters": 3221, "num_non_trainable_parameters": 0, "num_module_steps_trained_lifetime": 42000, "num_env_steps_trained_lifetime_throughput": 933455.8318583898, "num_module_steps_trained_throughput": 183746.50289353734, "num_module_steps_trained_lifetime_throughput": 183597.1494361672}, "default_policy": {"weights_seq_no": 7.0, "num_module_steps_trained_lifetime": 42000, "module_train_batch_size_mean": 1000.0, "vf_loss_unclipped": 51.11988830566406, "mean_kl_loss": 2.9953389457659796e-07, "diff_num_grad_updates_vs_sampler_policy": 1.0, "curr_kl_coeff": 0.006877678446471691, "total_loss": 0.14893636107444763, "default_optimizer_learning_rate": 2.15757277e-05, "vf_loss": 0.15183104574680328, "policy_loss": 0.009758052416145802, "num_module_steps_trained": 6000, "gradients_default_optimizer_global_norm": 0.02211243472993374, "entropy": 0.6884257793426514, "vf_explained_var": 0.005591928958892822, "curr_entropy_coeff": 0.0143822734464, "num_trainable_parameters": 3221, "num_module_steps_trained_lifetime_throughput": 184052.0229627441}}, "num_training_step_calls_per_iteration": 1, "evaluation": {"env_runners": {"module_to_env_connector": {"timers": {"connectors": {"remove_single_ts_time_rank_from_batch": 1.4401007483520552e-06, "tensor_to_numpy": 4.472229631349941e-05, "un_batch_to_individual_items": 1.5299856570149178e-05, "normalize_and_clip_actions": 2.1579766504124493e-05, "listify_data_for_vector_env": 3.065539949994942e-05, "get_actions": 0.00015437094110636566}}, "connector_pipeline_timer": 0.0003429265150772105}, "episode_len_mean": 50.0, "env_to_module_sum_episodes_length_in": 27.168093332126602, "num_module_steps_sampled": {"default_policy": 1000}, "num_episodes": 20, "env_to_module_sum_episodes_length_out": 27.168093332126602, "episode_duration_sec_mean": 0.036118599080009514, "episode_return_min": -16.5, "env_to_module_connector": {"timers": {"connectors": {"add_time_dim_to_batch_and_zero_pad": 5.646889759783944e-06, "batch_individual_items": 1.8697061042036356e-05, "add_observations_from_episodes_to_batch": 6.331405609700732e-06, "add_states_from_episodes_to_batch": 3.4317698697579176e-06, "numpy_to_tensor": 2.968642909183888e-05}}, "connector_pipeline_timer": 0.00011470678631065718}, "env_step_timer": 4.3044409751221834e-05, "episode_len_max": 50, "agent_episode_returns_mean": {"default_agent": 0.9}, "env_reset_timer": 0.00020534605671239766, "module_episode_returns_mean": {"default_policy": 0.9}, "num_agent_steps_sampled_lifetime": {"default_agent": 7000}, "episode_return_max": 17.5, "num_env_steps_sampled": 1000, "weights_seq_no": 7.0, "num_episodes_lifetime": 140, "num_env_steps_sampled_lifetime": 36000, "episode_return_mean": 0.9, "episode_len_min": 50, "sample": 0.8043261410115162, "num_agent_steps_sampled": {"default_agent": 1000}, "rlmodule_inference_timer": 9.258958553950105e-05, "num_module_steps_sampled_lifetime": {"default_policy": 7000}, "time_between_sampling": 4.211248597660133}, "num_healthy_workers": 1, "actor_manager_num_outstanding_async_reqs": 0, "num_remote_worker_restarts": 0}, "num_env_steps_sampled_lifetime": -1202500.0, "fault_tolerance": {"num_healthy_workers": 0, "num_remote_worker_restarts": 0}, "env_runner_group": {"actor_manager_num_outstanding_async_reqs": 0}, "done": true, "training_iteration": 7, "trial_id": "09438_00000", "date": "2025-08-11_17-05-10", "timestamp": 1754924710, "time_this_iter_s": 4.867830276489258, "time_total_s": 35.07464909553528, "pid": 57918, "hostname": "DESKTOP-3SK5A41", "node_ip": "192.168.40.242", "config": {"exploration_config": {}, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 6, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "env": "Umbrella", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": false, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 0, "create_local_env_runner": true, "num_envs_per_env_runner": 1, "gym_env_vectorize_mode": "SYNC", "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "episodes_to_numpy": true, "max_requests_in_flight_per_env_runner": 1, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "merge_env_runner_states": "training_only", "broadcast_env_runner_states": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "complete_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "sampler_perf_stats_ema_coef": null, "_is_online": true, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": "auto", "num_aggregator_actors_per_learner": 0, "max_requests_in_flight_per_aggregator_actor": 3, "local_gpu_idx": 0, "max_requests_in_flight_per_learner": 3, "gamma": 1, "lr": 2.15757277e-05, "grad_clip": 0.5, "grad_clip_by": "global_norm", "_train_batch_size_per_learner": 5000, "train_batch_size": 4000, "num_epochs": 1, "minibatch_size": 1000, "shuffle_batch_per_epoch": true, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "log_std_clip_param": 20.0, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "_disable_preprocessor_api": false, "_disable_action_flattening": false}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "_learner_class": null, "callbacks_on_algorithm_init": null, "callbacks_on_env_runners_recreated": null, "callbacks_on_offline_eval_runners_recreated": null, "callbacks_on_checkpoint_loaded": null, "callbacks_on_environment_created": null, "callbacks_on_episode_created": null, "callbacks_on_episode_start": null, "callbacks_on_episode_step": null, "callbacks_on_episode_end": null, "callbacks_on_evaluate_start": null, "callbacks_on_evaluate_end": null, "callbacks_on_evaluate_offline_start": null, "callbacks_on_evaluate_offline_end": null, "callbacks_on_sample_end": null, "callbacks_on_train_result": null, "explore": true, "enable_rl_module_and_learner": true, "enable_env_runner_and_connector_v2": true, "_prior_exploration_config": {"type": "StochasticSampling"}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x789255972ac0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "offline_data_class": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_read_batch_size": null, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "materialize_data": false, "materialize_mapped_data": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "ignore_final_observation": false, "prelearner_class": null, "prelearner_buffer_class": null, "prelearner_buffer_kwargs": {}, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_remaining_data": false, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": 1, "evaluation_duration": 20, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_auto_duration_min_env_steps_per_sample": 100, "evaluation_auto_duration_max_env_steps_per_sample": 2000, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 1, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "offline_evaluation_interval": null, "num_offline_eval_runners": 0, "offline_loss_for_module_fn": null, "offline_evaluation_duration": 1, "offline_evaluation_parallel_to_training": false, "offline_evaluation_timeout_s": 120.0, "num_cpus_per_offline_eval_runner": 1, "num_gpus_per_offline_eval_runner": 0, "custom_resources_per_offline_eval_runner": {}, "restart_failed_offline_eval_runners": true, "ignore_offline_eval_runner_failures": false, "max_num_offline_eval_runner_restarts": 1000, "offline_eval_runner_restore_timeout_s": 1800.0, "max_requests_in_flight_per_offline_eval_runner": 1, "validate_offline_eval_runners_after_construction": true, "offline_eval_runner_health_probe_timeout_s": 30.0, "offline_eval_rl_module_inference_only": false, "broadcast_offline_eval_runner_states": false, "offline_eval_batch_size_per_runner": 256, "dataset_num_iters_per_eval_runner": 1, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "log_gradients": true, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 42, "restart_failed_env_runners": true, "ignore_env_runner_failures": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30.0, "env_runner_restore_timeout_s": 1800.0, "_model_config": {}, "_rl_module_spec": "RLModuleSpec(module_class=None, observation_space=None, action_space=None, inference_only=False, learner_only=False, model_config=DefaultModelConfig(fcnet_hiddens=[62, 45], fcnet_activation='tanh', fcnet_kernel_initializer=None, fcnet_kernel_initializer_kwargs=None, fcnet_bias_initializer=None, fcnet_bias_initializer_kwargs=None, conv_filters=None, conv_activation='relu', conv_kernel_initializer=None, conv_kernel_initializer_kwargs=None, conv_bias_initializer=None, conv_bias_initializer_kwargs=None, head_fcnet_hiddens=[], head_fcnet_activation='relu', head_fcnet_kernel_initializer=None, head_fcnet_kernel_initializer_kwargs=None, head_fcnet_bias_initializer=None, head_fcnet_bias_initializer_kwargs=None, free_log_std=False, log_std_clip_param=20.0, vf_share_layers=True, use_lstm=False, max_seq_len=20, lstm_cell_size=256, lstm_use_prev_action=False, lstm_use_prev_reward=False, lstm_kernel_initializer=None, lstm_kernel_initializer_kwargs=None, lstm_bias_initializer=None, lstm_bias_initializer_kwargs=None), catalog_class=None, load_state_path=None, model_config_dict=None)", "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "_validate_config": true, "_use_msgpack_checkpoints": false, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "env_task_fn": -1, "enable_connectors": -1, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.8803428236734, "kl_target": 0.0081878044364, "vf_loss_coeff": 0.981876947508, "entropy_coeff": 0.0143822734464, "clip_param": 0.1609292883306, "vf_clip_param": 0.1530762162174, "entropy_coeff_schedule": null, "lr_schedule": null, "sgd_minibatch_size": -1, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9795292165235, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.callbacks.callbacks.RLlibCallback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 35.07464909553528, "iterations_since_restore": 7, "perf": {"cpu_util_percent": 11.485714285714284, "ram_util_percent": 69.72857142857143}}
