{"timers": {"training_iteration": 4.403060399000424, "restore_env_runners": 1.4000000192027073e-05, "training_step": 4.402856299000632, "env_runner_sampling_timer": 3.9279060989993013, "learner_update_timer": 0.47124429999985296, "synch_weights": 0.0017371000003549852}, "env_runners": {"weights_seq_no": 0.0, "module_to_env_connector": {"timers": {"connectors": {"get_actions": 0.00017179191810182435, "tensor_to_numpy": 4.9260766419128065e-05, "listify_data_for_vector_env": 3.20927044540481e-05, "un_batch_to_individual_items": 1.5328373427412205e-05, "normalize_and_clip_actions": 2.846160714045667e-05, "remove_single_ts_time_rank_from_batch": 1.6398477394544933e-06}}, "connector_pipeline_timer": 0.0003767537775533129}, "env_reset_timer": 0.00018383812521750577, "rlmodule_inference_timer": 0.0001064206574162028, "env_step_timer": 4.462342300527443e-05, "env_to_module_connector": {"timers": {"connectors": {"batch_individual_items": 1.9356494446596567e-05, "add_observations_from_episodes_to_batch": 6.833015583349691e-06, "numpy_to_tensor": 3.240389413196789e-05, "add_states_from_episodes_to_batch": 3.5042097348189582e-06, "add_time_dim_to_batch_and_zero_pad": 6.430034273832834e-06}}, "connector_pipeline_timer": 0.00012556547646096986}, "num_episodes": 100.0, "episode_len_min": 50, "episode_duration_sec_mean": 0.03676712298999519, "num_module_steps_sampled": {"default_policy": 5000.0}, "num_episodes_lifetime": 5050.0, "episode_return_max": 14.5, "episode_return_min": -5.5, "num_env_steps_sampled": 5000.0, "episode_return_mean": 7.1, "num_env_steps_sampled_lifetime": 252500.0, "time_between_sampling": 0.0011992156519385034, "num_agent_steps_sampled": {"default_agent": 5000.0}, "episode_len_max": 50, "num_agent_steps_sampled_lifetime": {"default_agent": 252500.0}, "env_to_module_sum_episodes_length_in": 26.762340024562445, "module_episode_returns_mean": {"default_policy": 7.1}, "sample": 0.03961249720223772, "num_module_steps_sampled_lifetime": {"default_policy": 252500.0}, "agent_episode_returns_mean": {"default_agent": 7.1}, "env_to_module_sum_episodes_length_out": 26.762340024562445, "episode_len_mean": 50.0, "num_env_steps_sampled_lifetime_throughput": 1243.4239620111616}, "learners": {"default_policy": {"vf_loss_unclipped": 12.76751708984375, "mean_kl_loss": 0.0002901199914049357, "num_module_steps_trained": 16000, "diff_num_grad_updates_vs_sampler_policy": 1.0, "vf_explained_var": 0.0007150173187255859, "entropy": 0.6873037815093994, "num_trainable_parameters": 5707, "vf_loss": 0.09487538784742355, "default_optimizer_learning_rate": 0.0003313639719, "curr_kl_coeff": 0.388599157333374, "num_module_steps_trained_lifetime": 16000, "total_loss": 0.09183687716722488, "gradients_default_optimizer_global_norm": 0.035480473190546036, "module_train_batch_size_mean": 1000.0, "weights_seq_no": 1.0, "curr_entropy_coeff": 0.0090570820258, "policy_loss": 0.03438297286629677, "num_module_steps_trained_lifetime_throughput": 203566.8766914502}, "__all_modules__": {"num_module_steps_trained_lifetime": 16000, "learner_connector": {"timers": {"connectors": {"general_advantage_estimation": 0.012485299999752897, "add_time_dim_to_batch_and_zero_pad": 2.3999999939405825e-05, "batch_individual_items": 0.21299180000005435, "numpy_to_tensor": 0.0002451999998811516, "add_states_from_episodes_to_batch": 6.299999768089037e-06, "add_one_ts_to_episodes_and_truncate": 0.008996300000035262, "add_columns_from_episodes_to_train_batch": 0.07291960000020481, "add_observations_from_episodes_to_batch": 0.0008488000003126217}}, "connector_pipeline_timer": 0.3089709000005314}, "num_trainable_parameters": 5707, "learner_connector_sum_episodes_length_out": 5100, "num_env_steps_trained_lifetime": 81600, "num_env_steps_trained": 81600, "learner_connector_sum_episodes_length_in": 5000, "num_non_trainable_parameters": 0, "num_module_steps_trained": 16000, "num_env_steps_trained_lifetime_throughput": 1036191.5460513114, "num_module_steps_trained_throughput": 203792.85929509514, "num_module_steps_trained_lifetime_throughput": 203755.57327376792}}, "num_training_step_calls_per_iteration": 1, "num_env_steps_sampled_lifetime": 252500.0, "evaluation": {"env_runners": {"module_to_env_connector": {"timers": {"connectors": {"tensor_to_numpy": 4.5415603026811975e-05, "get_actions": 0.00015687450272300254, "listify_data_for_vector_env": 3.03855166060969e-05, "normalize_and_clip_actions": 2.1652497064848163e-05, "un_batch_to_individual_items": 1.5393266468527036e-05, "remove_single_ts_time_rank_from_batch": 1.5256849230716769e-06}}, "connector_pipeline_timer": 0.0003437442179308116}, "env_to_module_sum_episodes_length_in": 27.167134025045954, "sample": 0.7374014000006355, "env_step_timer": 4.267630223006952e-05, "episode_len_min": 50, "env_to_module_connector": {"timers": {"connectors": {"add_time_dim_to_batch_and_zero_pad": 5.7449328344559165e-06, "batch_individual_items": 1.888053440286643e-05, "numpy_to_tensor": 2.9674461668403252e-05, "add_states_from_episodes_to_batch": 3.6737803424915874e-06, "add_observations_from_episodes_to_batch": 6.043215505216136e-06}}, "connector_pipeline_timer": 0.00011342259466124115}, "agent_episode_returns_mean": {"default_agent": 2.1}, "episode_return_min": -14.5, "num_agent_steps_sampled_lifetime": {"default_agent": 1000}, "env_to_module_sum_episodes_length_out": 27.167134025045954, "num_module_steps_sampled": {"default_policy": 1000}, "episode_len_mean": 50.0, "weights_seq_no": 1.0, "num_agent_steps_sampled": {"default_agent": 1000}, "num_episodes_lifetime": 20, "episode_return_max": 17.5, "module_episode_returns_mean": {"default_policy": 2.1}, "episode_return_mean": 2.1, "num_module_steps_sampled_lifetime": {"default_policy": 1000}, "env_reset_timer": 0.0002494999998816638, "rlmodule_inference_timer": 9.504274275212862e-05, "num_episodes": 20, "episode_duration_sec_mean": 0.03542525500006377, "num_env_steps_sampled_lifetime": 6000, "num_env_steps_sampled": 1000, "episode_len_max": 50}, "num_healthy_workers": 1, "actor_manager_num_outstanding_async_reqs": 0, "num_remote_worker_restarts": 0}, "fault_tolerance": {"num_healthy_workers": 0, "num_remote_worker_restarts": 0}, "env_runner_group": {"actor_manager_num_outstanding_async_reqs": 0}, "done": false, "training_iteration": 1, "trial_id": "aef7a_00000", "date": "2025-08-11_17-13-53", "timestamp": 1754925233, "time_this_iter_s": 5.154739856719971, "time_total_s": 5.154739856719971, "pid": 66454, "hostname": "DESKTOP-3SK5A41", "node_ip": "192.168.40.242", "config": {"exploration_config": {}, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 6, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "env": "Umbrella", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": false, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 0, "create_local_env_runner": true, "num_envs_per_env_runner": 1, "gym_env_vectorize_mode": "SYNC", "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "episodes_to_numpy": true, "max_requests_in_flight_per_env_runner": 1, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "merge_env_runner_states": "training_only", "broadcast_env_runner_states": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "complete_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "sampler_perf_stats_ema_coef": null, "_is_online": true, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": "auto", "num_aggregator_actors_per_learner": 0, "max_requests_in_flight_per_aggregator_actor": 3, "local_gpu_idx": 0, "max_requests_in_flight_per_learner": 3, "gamma": 1, "lr": 0.0003313639719, "grad_clip": 0.5, "grad_clip_by": "global_norm", "_train_batch_size_per_learner": 5000, "train_batch_size": 4000, "num_epochs": 3, "minibatch_size": 1000, "shuffle_batch_per_epoch": true, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "log_std_clip_param": 20.0, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "_disable_preprocessor_api": false, "_disable_action_flattening": false}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "_learner_class": null, "callbacks_on_algorithm_init": null, "callbacks_on_env_runners_recreated": null, "callbacks_on_offline_eval_runners_recreated": null, "callbacks_on_checkpoint_loaded": null, "callbacks_on_environment_created": null, "callbacks_on_episode_created": null, "callbacks_on_episode_start": null, "callbacks_on_episode_step": null, "callbacks_on_episode_end": null, "callbacks_on_evaluate_start": null, "callbacks_on_evaluate_end": null, "callbacks_on_evaluate_offline_start": null, "callbacks_on_evaluate_offline_end": null, "callbacks_on_sample_end": null, "callbacks_on_train_result": null, "explore": true, "enable_rl_module_and_learner": true, "enable_env_runner_and_connector_v2": true, "_prior_exploration_config": {"type": "StochasticSampling"}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x73ae51472ac0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "offline_data_class": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_read_batch_size": null, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "materialize_data": false, "materialize_mapped_data": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "ignore_final_observation": false, "prelearner_class": null, "prelearner_buffer_class": null, "prelearner_buffer_kwargs": {}, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_remaining_data": false, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": 1, "evaluation_duration": 20, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_auto_duration_min_env_steps_per_sample": 100, "evaluation_auto_duration_max_env_steps_per_sample": 2000, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 1, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "offline_evaluation_interval": null, "num_offline_eval_runners": 0, "offline_loss_for_module_fn": null, "offline_evaluation_duration": 1, "offline_evaluation_parallel_to_training": false, "offline_evaluation_timeout_s": 120.0, "num_cpus_per_offline_eval_runner": 1, "num_gpus_per_offline_eval_runner": 0, "custom_resources_per_offline_eval_runner": {}, "restart_failed_offline_eval_runners": true, "ignore_offline_eval_runner_failures": false, "max_num_offline_eval_runner_restarts": 1000, "offline_eval_runner_restore_timeout_s": 1800.0, "max_requests_in_flight_per_offline_eval_runner": 1, "validate_offline_eval_runners_after_construction": true, "offline_eval_runner_health_probe_timeout_s": 30.0, "offline_eval_rl_module_inference_only": false, "broadcast_offline_eval_runner_states": false, "offline_eval_batch_size_per_runner": 256, "dataset_num_iters_per_eval_runner": 1, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "log_gradients": true, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 42, "restart_failed_env_runners": true, "ignore_env_runner_failures": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30.0, "env_runner_restore_timeout_s": 1800.0, "_model_config": {}, "_rl_module_spec": "RLModuleSpec(module_class=None, observation_space=None, action_space=None, inference_only=False, learner_only=False, model_config=DefaultModelConfig(fcnet_hiddens=[61, 84], fcnet_activation='tanh', fcnet_kernel_initializer=None, fcnet_kernel_initializer_kwargs=None, fcnet_bias_initializer=None, fcnet_bias_initializer_kwargs=None, conv_filters=None, conv_activation='relu', conv_kernel_initializer=None, conv_kernel_initializer_kwargs=None, conv_bias_initializer=None, conv_bias_initializer_kwargs=None, head_fcnet_hiddens=[], head_fcnet_activation='relu', head_fcnet_kernel_initializer=None, head_fcnet_kernel_initializer_kwargs=None, head_fcnet_bias_initializer=None, head_fcnet_bias_initializer_kwargs=None, free_log_std=False, log_std_clip_param=20.0, vf_share_layers=True, use_lstm=False, max_seq_len=20, lstm_cell_size=256, lstm_use_prev_action=False, lstm_use_prev_reward=False, lstm_kernel_initializer=None, lstm_kernel_initializer_kwargs=None, lstm_bias_initializer=None, lstm_bias_initializer_kwargs=None), catalog_class=None, load_state_path=None, model_config_dict=None)", "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "_validate_config": true, "_use_msgpack_checkpoints": false, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "env_task_fn": -1, "enable_connectors": -1, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.7771983355204, "kl_target": 0.026982802658, "vf_loss_coeff": 0.6688075857018, "entropy_coeff": 0.0090570820258, "clip_param": 0.1202945497339, "vf_clip_param": 0.1020987445302, "entropy_coeff_schedule": null, "lr_schedule": null, "sgd_minibatch_size": -1, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9064845981162, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.callbacks.callbacks.RLlibCallback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 5.154739856719971, "iterations_since_restore": 1, "perf": {"cpu_util_percent": 11.375, "ram_util_percent": 78.4375}}
{"timers": {"training_iteration": 4.400899653970419, "restore_env_runners": 1.3986000185468583e-05, "training_step": 4.40069334697062, "env_runner_sampling_timer": 3.928223859969312, "learner_update_timer": 0.4687607779998507, "synch_weights": 0.0017364080003517302, "restore_eval_env_runners": 1.2900000001536682e-05, "evaluation_iteration": 0.7488963000005242, "synch_eval_env_connectors": 0.00042529999973339727, "synch_env_connectors": 7.999999979801942e-06}, "env_runners": {"weights_seq_no": 1.0, "module_to_env_connector": {"timers": {"connectors": {"get_actions": 0.00016786221690457117, "tensor_to_numpy": 5.081214825990746e-05, "listify_data_for_vector_env": 3.153425461623445e-05, "un_batch_to_individual_items": 1.518280434325802e-05, "normalize_and_clip_actions": 2.2503692270412294e-05, "remove_single_ts_time_rank_from_batch": 1.6004328065865072e-06}}, "connector_pipeline_timer": 0.00036725198380361217}, "env_reset_timer": 0.00012779830283746757, "rlmodule_inference_timer": 0.00010230218794810956, "env_step_timer": 4.3335968522110545e-05, "env_to_module_connector": {"timers": {"connectors": {"batch_individual_items": 1.8923981964198995e-05, "add_observations_from_episodes_to_batch": 6.493467691362357e-06, "numpy_to_tensor": 3.190909466632393e-05, "add_states_from_episodes_to_batch": 3.4813552509410798e-06, "add_time_dim_to_batch_and_zero_pad": 6.238389594448374e-06}}, "connector_pipeline_timer": 0.0001208012880734789}, "num_episodes": 100.0, "episode_len_min": 50, "episode_duration_sec_mean": 0.03703874895999433, "num_module_steps_sampled": {"default_policy": 5000.0}, "num_episodes_lifetime": 200.0, "episode_return_max": 14.5, "episode_return_min": -5.5, "num_env_steps_sampled": 5000.0, "episode_return_mean": 5.5, "num_env_steps_sampled_lifetime": 10000.0, "time_between_sampling": 0.00935187464171003, "num_agent_steps_sampled": {"default_agent": 5000.0}, "episode_len_max": 50, "num_agent_steps_sampled_lifetime": {"default_agent": 10000.0}, "env_to_module_sum_episodes_length_in": 27.16809333212661, "module_episode_returns_mean": {"default_policy": 5.5}, "sample": 0.038594027999717284, "num_module_steps_sampled_lifetime": {"default_policy": 10000.0}, "agent_episode_returns_mean": {"default_agent": 5.5}, "env_to_module_sum_episodes_length_out": 27.16809333212661, "episode_len_mean": 50.0, "num_env_steps_sampled_lifetime_throughput": 1268.0853487012394}, "learners": {"default_policy": {"vf_loss_unclipped": 12.721724510192871, "mean_kl_loss": 0.000589923991356045, "num_module_steps_trained": 16000, "diff_num_grad_updates_vs_sampler_policy": 1.0, "vf_explained_var": 0.023406028747558594, "entropy": 0.6896063089370728, "num_trainable_parameters": 5707, "vf_loss": 0.09277274459600449, "default_optimizer_learning_rate": 0.0003313639719, "curr_kl_coeff": 0.194299578666687, "num_module_steps_trained_lifetime": 32000, "total_loss": 0.08091999590396881, "gradients_default_optimizer_global_norm": 0.03998134285211563, "module_train_batch_size_mean": 1000.0, "weights_seq_no": 2.0, "curr_entropy_coeff": 0.0090570820258, "policy_loss": 0.024889450520277023, "num_module_steps_trained_lifetime_throughput": 203915.20638585693}, "__all_modules__": {"num_module_steps_trained_lifetime": 32000, "learner_connector": {"timers": {"connectors": {"general_advantage_estimation": 0.012450656999753847, "add_time_dim_to_batch_and_zero_pad": 2.397499994003738e-05, "batch_individual_items": 0.21145772400005627, "numpy_to_tensor": 0.00024457199987409694, "add_states_from_episodes_to_batch": 6.295999774010852e-06, "add_one_ts_to_episodes_and_truncate": 0.008992232000036893, "add_columns_from_episodes_to_train_batch": 0.0728870430002098, "add_observations_from_episodes_to_batch": 0.0008474890003071778}}, "connector_pipeline_timer": 0.30736195000052247}, "num_trainable_parameters": 5707, "learner_connector_sum_episodes_length_out": 5100.0, "num_env_steps_trained_lifetime": 163200, "num_env_steps_trained": 81600, "learner_connector_sum_episodes_length_in": 5000.0, "num_non_trainable_parameters": 0, "num_module_steps_trained": 16000, "num_env_steps_trained_lifetime_throughput": 1038029.1439863782, "num_module_steps_trained_throughput": 204136.80221547894, "num_module_steps_trained_lifetime_throughput": 204099.95717709017}}, "num_training_step_calls_per_iteration": 1, "evaluation": {"env_runners": {"module_to_env_connector": {"timers": {"connectors": {"tensor_to_numpy": 4.514400469374447e-05, "get_actions": 0.00015958776181867264, "listify_data_for_vector_env": 3.0848226447053884e-05, "normalize_and_clip_actions": 2.1888964742281126e-05, "un_batch_to_individual_items": 1.6440258375695014e-05, "remove_single_ts_time_rank_from_batch": 1.4779435876861447e-06}}, "connector_pipeline_timer": 0.00035043094491685764}, "env_to_module_sum_episodes_length_in": 27.168093298253442, "sample": 0.7373572169906311, "env_step_timer": 4.343170996353259e-05, "episode_len_min": 50, "env_to_module_connector": {"timers": {"connectors": {"add_time_dim_to_batch_and_zero_pad": 5.7753073800561105e-06, "batch_individual_items": 1.8769219941371864e-05, "numpy_to_tensor": 3.012616132293688e-05, "add_states_from_episodes_to_batch": 3.381792375076325e-06, "add_observations_from_episodes_to_batch": 6.179374989720449e-06}}, "connector_pipeline_timer": 0.00011486999737185442}, "agent_episode_returns_mean": {"default_agent": 0.1}, "episode_return_min": -14.5, "num_agent_steps_sampled_lifetime": {"default_agent": 2000}, "env_to_module_sum_episodes_length_out": 27.168093298253442, "num_module_steps_sampled": {"default_policy": 1000}, "episode_len_mean": 50.0, "weights_seq_no": 2.0, "num_agent_steps_sampled": {"default_agent": 1000}, "num_episodes_lifetime": 40, "episode_return_max": 17.5, "module_episode_returns_mean": {"default_policy": 0.1}, "episode_return_mean": 0.1, "num_module_steps_sampled_lifetime": {"default_policy": 2000}, "env_reset_timer": 0.0002483049998863862, "rlmodule_inference_timer": 9.828575772073999e-05, "num_episodes": 20, "episode_duration_sec_mean": 0.035327862475105574, "num_env_steps_sampled_lifetime": 11000, "num_env_steps_sampled": 1000, "episode_len_max": 50, "time_between_sampling": 4.241913996000221}, "num_healthy_workers": 1, "actor_manager_num_outstanding_async_reqs": 0, "num_remote_worker_restarts": 0}, "num_env_steps_sampled_lifetime": 10000.0, "fault_tolerance": {"num_healthy_workers": 0, "num_remote_worker_restarts": 0}, "env_runner_group": {"actor_manager_num_outstanding_async_reqs": 0}, "done": false, "training_iteration": 2, "trial_id": "aef7a_00000", "date": "2025-08-11_17-13-58", "timestamp": 1754925238, "time_this_iter_s": 4.934225797653198, "time_total_s": 10.088965654373169, "pid": 66454, "hostname": "DESKTOP-3SK5A41", "node_ip": "192.168.40.242", "config": {"exploration_config": {}, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 6, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "env": "Umbrella", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": false, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 0, "create_local_env_runner": true, "num_envs_per_env_runner": 1, "gym_env_vectorize_mode": "SYNC", "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "episodes_to_numpy": true, "max_requests_in_flight_per_env_runner": 1, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "merge_env_runner_states": "training_only", "broadcast_env_runner_states": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "complete_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "sampler_perf_stats_ema_coef": null, "_is_online": true, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": "auto", "num_aggregator_actors_per_learner": 0, "max_requests_in_flight_per_aggregator_actor": 3, "local_gpu_idx": 0, "max_requests_in_flight_per_learner": 3, "gamma": 1, "lr": 0.0003313639719, "grad_clip": 0.5, "grad_clip_by": "global_norm", "_train_batch_size_per_learner": 5000, "train_batch_size": 4000, "num_epochs": 3, "minibatch_size": 1000, "shuffle_batch_per_epoch": true, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "log_std_clip_param": 20.0, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "_disable_preprocessor_api": false, "_disable_action_flattening": false}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "_learner_class": null, "callbacks_on_algorithm_init": null, "callbacks_on_env_runners_recreated": null, "callbacks_on_offline_eval_runners_recreated": null, "callbacks_on_checkpoint_loaded": null, "callbacks_on_environment_created": null, "callbacks_on_episode_created": null, "callbacks_on_episode_start": null, "callbacks_on_episode_step": null, "callbacks_on_episode_end": null, "callbacks_on_evaluate_start": null, "callbacks_on_evaluate_end": null, "callbacks_on_evaluate_offline_start": null, "callbacks_on_evaluate_offline_end": null, "callbacks_on_sample_end": null, "callbacks_on_train_result": null, "explore": true, "enable_rl_module_and_learner": true, "enable_env_runner_and_connector_v2": true, "_prior_exploration_config": {"type": "StochasticSampling"}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x73ae51472ac0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "offline_data_class": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_read_batch_size": null, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "materialize_data": false, "materialize_mapped_data": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "ignore_final_observation": false, "prelearner_class": null, "prelearner_buffer_class": null, "prelearner_buffer_kwargs": {}, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_remaining_data": false, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": 1, "evaluation_duration": 20, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_auto_duration_min_env_steps_per_sample": 100, "evaluation_auto_duration_max_env_steps_per_sample": 2000, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 1, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "offline_evaluation_interval": null, "num_offline_eval_runners": 0, "offline_loss_for_module_fn": null, "offline_evaluation_duration": 1, "offline_evaluation_parallel_to_training": false, "offline_evaluation_timeout_s": 120.0, "num_cpus_per_offline_eval_runner": 1, "num_gpus_per_offline_eval_runner": 0, "custom_resources_per_offline_eval_runner": {}, "restart_failed_offline_eval_runners": true, "ignore_offline_eval_runner_failures": false, "max_num_offline_eval_runner_restarts": 1000, "offline_eval_runner_restore_timeout_s": 1800.0, "max_requests_in_flight_per_offline_eval_runner": 1, "validate_offline_eval_runners_after_construction": true, "offline_eval_runner_health_probe_timeout_s": 30.0, "offline_eval_rl_module_inference_only": false, "broadcast_offline_eval_runner_states": false, "offline_eval_batch_size_per_runner": 256, "dataset_num_iters_per_eval_runner": 1, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "log_gradients": true, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 42, "restart_failed_env_runners": true, "ignore_env_runner_failures": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30.0, "env_runner_restore_timeout_s": 1800.0, "_model_config": {}, "_rl_module_spec": "RLModuleSpec(module_class=None, observation_space=None, action_space=None, inference_only=False, learner_only=False, model_config=DefaultModelConfig(fcnet_hiddens=[61, 84], fcnet_activation='tanh', fcnet_kernel_initializer=None, fcnet_kernel_initializer_kwargs=None, fcnet_bias_initializer=None, fcnet_bias_initializer_kwargs=None, conv_filters=None, conv_activation='relu', conv_kernel_initializer=None, conv_kernel_initializer_kwargs=None, conv_bias_initializer=None, conv_bias_initializer_kwargs=None, head_fcnet_hiddens=[], head_fcnet_activation='relu', head_fcnet_kernel_initializer=None, head_fcnet_kernel_initializer_kwargs=None, head_fcnet_bias_initializer=None, head_fcnet_bias_initializer_kwargs=None, free_log_std=False, log_std_clip_param=20.0, vf_share_layers=True, use_lstm=False, max_seq_len=20, lstm_cell_size=256, lstm_use_prev_action=False, lstm_use_prev_reward=False, lstm_kernel_initializer=None, lstm_kernel_initializer_kwargs=None, lstm_bias_initializer=None, lstm_bias_initializer_kwargs=None), catalog_class=None, load_state_path=None, model_config_dict=None)", "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "_validate_config": true, "_use_msgpack_checkpoints": false, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "env_task_fn": -1, "enable_connectors": -1, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.7771983355204, "kl_target": 0.026982802658, "vf_loss_coeff": 0.6688075857018, "entropy_coeff": 0.0090570820258, "clip_param": 0.1202945497339, "vf_clip_param": 0.1020987445302, "entropy_coeff_schedule": null, "lr_schedule": null, "sgd_minibatch_size": -1, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9064845981162, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.callbacks.callbacks.RLlibCallback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 10.088965654373169, "iterations_since_restore": 2, "perf": {"cpu_util_percent": 12.685714285714287, "ram_util_percent": 78.60000000000001}}
{"timers": {"training_iteration": 4.400024815400713, "restore_env_runners": 1.3977140180668356e-05, "training_step": 4.399816831470909, "env_runner_sampling_timer": 3.9297070143396162, "learner_update_timer": 0.46640099321984824, "synch_weights": 0.0017336079203510053, "restore_eval_env_runners": 1.2904000004709815e-05, "evaluation_iteration": 0.7488314009905207, "synch_eval_env_connectors": 0.00042467899973416937, "synch_env_connectors": 7.996999975148356e-06}, "env_runners": {"weights_seq_no": 2.0, "module_to_env_connector": {"timers": {"connectors": {"get_actions": 0.00016763821195276183, "tensor_to_numpy": 5.05210847706531e-05, "listify_data_for_vector_env": 3.140118994443209e-05, "un_batch_to_individual_items": 1.4990744660769105e-05, "normalize_and_clip_actions": 2.2456660366350564e-05, "remove_single_ts_time_rank_from_batch": 1.582359246782054e-06}}, "connector_pipeline_timer": 0.0003656107625562505}, "env_reset_timer": 0.00010743663051669107, "rlmodule_inference_timer": 0.00013580991294518953, "env_step_timer": 4.315460878598531e-05, "env_to_module_connector": {"timers": {"connectors": {"batch_individual_items": 1.8747727500611665e-05, "add_observations_from_episodes_to_batch": 6.462482129019374e-06, "numpy_to_tensor": 3.184083525544437e-05, "add_states_from_episodes_to_batch": 3.424719504656774e-06, "add_time_dim_to_batch_and_zero_pad": 6.1998514416404036e-06}}, "connector_pipeline_timer": 0.0001198721989759777}, "num_episodes": 100.0, "episode_len_min": 50, "episode_duration_sec_mean": 0.03822521096994933, "num_module_steps_sampled": {"default_policy": 5000.0}, "num_episodes_lifetime": -4650.0, "episode_return_max": 14.5, "episode_return_min": -5.5, "num_env_steps_sampled": 5000.0, "episode_return_mean": 5.899999999999999, "num_env_steps_sampled_lifetime": -232500.0, "time_between_sampling": 0.010777412190196926, "num_agent_steps_sampled": {"default_agent": 5000.0}, "episode_len_max": 50, "num_agent_steps_sampled_lifetime": {"default_agent": -232500.0}, "env_to_module_sum_episodes_length_in": 27.16809333212661, "module_episode_returns_mean": {"default_policy": 5.899999999999999}, "sample": 0.038662966489192145, "num_module_steps_sampled_lifetime": {"default_policy": -232500.0}, "agent_episode_returns_mean": {"default_agent": 5.899999999999999}, "env_to_module_sum_episodes_length_out": 27.16809333212661, "episode_len_mean": 50.0, "num_env_steps_sampled_lifetime_throughput": 1257.354676860737}, "learners": {"default_policy": {"vf_loss_unclipped": 12.246036529541016, "mean_kl_loss": 0.0030246912501752377, "num_module_steps_trained": 16000, "diff_num_grad_updates_vs_sampler_policy": 1.0, "vf_explained_var": 0.049343645572662354, "entropy": 0.6827442646026611, "num_trainable_parameters": 5707, "vf_loss": 0.09343834966421127, "default_optimizer_learning_rate": 0.0003313639719, "curr_kl_coeff": 0.0971497893333435, "num_module_steps_trained_lifetime": 48000, "total_loss": 0.07779333740472794, "gradients_default_optimizer_global_norm": 0.044130370020866394, "module_train_batch_size_mean": 1000.0, "weights_seq_no": 3.0, "curr_entropy_coeff": 0.0090570820258, "policy_loss": 0.02089703269302845, "num_module_steps_trained_lifetime_throughput": 203389.342419222}, "__all_modules__": {"num_module_steps_trained_lifetime": 48000, "learner_connector": {"timers": {"connectors": {"general_advantage_estimation": 0.01240953842975905, "add_time_dim_to_batch_and_zero_pad": 2.4058249944482672e-05, "batch_individual_items": 0.209927657760053, "numpy_to_tensor": 0.00024388127986921972, "add_states_from_episodes_to_batch": 6.3210397733200805e-06, "add_one_ts_to_episodes_and_truncate": 0.008989153680034178, "add_columns_from_episodes_to_train_batch": 0.07284654757020743, "add_observations_from_episodes_to_batch": 0.0008461411103030514}}, "connector_pipeline_timer": 0.30574373950051736}, "num_trainable_parameters": 5707, "learner_connector_sum_episodes_length_out": 5100.0, "num_env_steps_trained_lifetime": 244800, "num_env_steps_trained": 81600, "learner_connector_sum_episodes_length_in": 5000.0, "num_non_trainable_parameters": 0, "num_module_steps_trained": 16000, "num_env_steps_trained_lifetime_throughput": 1035422.2967499329, "num_module_steps_trained_throughput": 203604.6766113468, "num_module_steps_trained_lifetime_throughput": 203567.87776304272}}, "num_training_step_calls_per_iteration": 1, "evaluation": {"env_runners": {"module_to_env_connector": {"timers": {"connectors": {"tensor_to_numpy": 4.527335592627092e-05, "get_actions": 0.00015750050236437553, "listify_data_for_vector_env": 3.089163721224029e-05, "normalize_and_clip_actions": 2.162167736448052e-05, "un_batch_to_individual_items": 1.6006079783200627e-05, "remove_single_ts_time_rank_from_batch": 1.4284902977704254e-06}}, "connector_pipeline_timer": 0.00034670729865797164}, "env_to_module_sum_episodes_length_in": 27.168093332125434, "sample": 0.7373886098207209, "env_step_timer": 4.222728942009847e-05, "episode_len_min": 50, "env_to_module_connector": {"timers": {"connectors": {"add_time_dim_to_batch_and_zero_pad": 6.0048700143170205e-06, "batch_individual_items": 1.8769573331624912e-05, "numpy_to_tensor": 2.9507580057547626e-05, "add_states_from_episodes_to_batch": 3.266899437249164e-06, "add_observations_from_episodes_to_batch": 6.252303163646982e-06}}, "connector_pipeline_timer": 0.00011456542630169376}, "agent_episode_returns_mean": {"default_agent": 1.7666666666666666}, "episode_return_min": -14.5, "num_agent_steps_sampled_lifetime": {"default_agent": 3000}, "env_to_module_sum_episodes_length_out": 27.168093332125434, "num_module_steps_sampled": {"default_policy": 1000}, "episode_len_mean": 50.0, "weights_seq_no": 3.0, "num_agent_steps_sampled": {"default_agent": 1000}, "num_episodes_lifetime": 60, "episode_return_max": 17.5, "module_episode_returns_mean": {"default_policy": 1.7666666666666666}, "episode_return_mean": 1.7666666666666666, "num_module_steps_sampled_lifetime": {"default_policy": 3000}, "env_reset_timer": 0.0002471219498819664, "rlmodule_inference_timer": 9.864867959684871e-05, "num_episodes": 20, "episode_duration_sec_mean": 0.03541722665007304, "num_env_steps_sampled_lifetime": 16000, "num_env_steps_sampled": 1000, "episode_len_max": 50, "time_between_sampling": 4.24317400101022}, "num_healthy_workers": 1, "actor_manager_num_outstanding_async_reqs": 0, "num_remote_worker_restarts": 0}, "num_env_steps_sampled_lifetime": -232500.0, "fault_tolerance": {"num_healthy_workers": 0, "num_remote_worker_restarts": 0}, "env_runner_group": {"actor_manager_num_outstanding_async_reqs": 0}, "done": false, "training_iteration": 3, "trial_id": "aef7a_00000", "date": "2025-08-11_17-14-03", "timestamp": 1754925243, "time_this_iter_s": 5.068433523178101, "time_total_s": 15.15739917755127, "pid": 66454, "hostname": "DESKTOP-3SK5A41", "node_ip": "192.168.40.242", "config": {"exploration_config": {}, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 6, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "env": "Umbrella", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": false, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 0, "create_local_env_runner": true, "num_envs_per_env_runner": 1, "gym_env_vectorize_mode": "SYNC", "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "episodes_to_numpy": true, "max_requests_in_flight_per_env_runner": 1, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "merge_env_runner_states": "training_only", "broadcast_env_runner_states": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "complete_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "sampler_perf_stats_ema_coef": null, "_is_online": true, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": "auto", "num_aggregator_actors_per_learner": 0, "max_requests_in_flight_per_aggregator_actor": 3, "local_gpu_idx": 0, "max_requests_in_flight_per_learner": 3, "gamma": 1, "lr": 0.0003313639719, "grad_clip": 0.5, "grad_clip_by": "global_norm", "_train_batch_size_per_learner": 5000, "train_batch_size": 4000, "num_epochs": 3, "minibatch_size": 1000, "shuffle_batch_per_epoch": true, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "log_std_clip_param": 20.0, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "_disable_preprocessor_api": false, "_disable_action_flattening": false}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "_learner_class": null, "callbacks_on_algorithm_init": null, "callbacks_on_env_runners_recreated": null, "callbacks_on_offline_eval_runners_recreated": null, "callbacks_on_checkpoint_loaded": null, "callbacks_on_environment_created": null, "callbacks_on_episode_created": null, "callbacks_on_episode_start": null, "callbacks_on_episode_step": null, "callbacks_on_episode_end": null, "callbacks_on_evaluate_start": null, "callbacks_on_evaluate_end": null, "callbacks_on_evaluate_offline_start": null, "callbacks_on_evaluate_offline_end": null, "callbacks_on_sample_end": null, "callbacks_on_train_result": null, "explore": true, "enable_rl_module_and_learner": true, "enable_env_runner_and_connector_v2": true, "_prior_exploration_config": {"type": "StochasticSampling"}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x73ae51472ac0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "offline_data_class": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_read_batch_size": null, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "materialize_data": false, "materialize_mapped_data": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "ignore_final_observation": false, "prelearner_class": null, "prelearner_buffer_class": null, "prelearner_buffer_kwargs": {}, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_remaining_data": false, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": 1, "evaluation_duration": 20, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_auto_duration_min_env_steps_per_sample": 100, "evaluation_auto_duration_max_env_steps_per_sample": 2000, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 1, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "offline_evaluation_interval": null, "num_offline_eval_runners": 0, "offline_loss_for_module_fn": null, "offline_evaluation_duration": 1, "offline_evaluation_parallel_to_training": false, "offline_evaluation_timeout_s": 120.0, "num_cpus_per_offline_eval_runner": 1, "num_gpus_per_offline_eval_runner": 0, "custom_resources_per_offline_eval_runner": {}, "restart_failed_offline_eval_runners": true, "ignore_offline_eval_runner_failures": false, "max_num_offline_eval_runner_restarts": 1000, "offline_eval_runner_restore_timeout_s": 1800.0, "max_requests_in_flight_per_offline_eval_runner": 1, "validate_offline_eval_runners_after_construction": true, "offline_eval_runner_health_probe_timeout_s": 30.0, "offline_eval_rl_module_inference_only": false, "broadcast_offline_eval_runner_states": false, "offline_eval_batch_size_per_runner": 256, "dataset_num_iters_per_eval_runner": 1, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "log_gradients": true, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 42, "restart_failed_env_runners": true, "ignore_env_runner_failures": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30.0, "env_runner_restore_timeout_s": 1800.0, "_model_config": {}, "_rl_module_spec": "RLModuleSpec(module_class=None, observation_space=None, action_space=None, inference_only=False, learner_only=False, model_config=DefaultModelConfig(fcnet_hiddens=[61, 84], fcnet_activation='tanh', fcnet_kernel_initializer=None, fcnet_kernel_initializer_kwargs=None, fcnet_bias_initializer=None, fcnet_bias_initializer_kwargs=None, conv_filters=None, conv_activation='relu', conv_kernel_initializer=None, conv_kernel_initializer_kwargs=None, conv_bias_initializer=None, conv_bias_initializer_kwargs=None, head_fcnet_hiddens=[], head_fcnet_activation='relu', head_fcnet_kernel_initializer=None, head_fcnet_kernel_initializer_kwargs=None, head_fcnet_bias_initializer=None, head_fcnet_bias_initializer_kwargs=None, free_log_std=False, log_std_clip_param=20.0, vf_share_layers=True, use_lstm=False, max_seq_len=20, lstm_cell_size=256, lstm_use_prev_action=False, lstm_use_prev_reward=False, lstm_kernel_initializer=None, lstm_kernel_initializer_kwargs=None, lstm_bias_initializer=None, lstm_bias_initializer_kwargs=None), catalog_class=None, load_state_path=None, model_config_dict=None)", "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "_validate_config": true, "_use_msgpack_checkpoints": false, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "env_task_fn": -1, "enable_connectors": -1, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.7771983355204, "kl_target": 0.026982802658, "vf_loss_coeff": 0.6688075857018, "entropy_coeff": 0.0090570820258, "clip_param": 0.1202945497339, "vf_clip_param": 0.1020987445302, "entropy_coeff_schedule": null, "lr_schedule": null, "sgd_minibatch_size": -1, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9064845981162, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.callbacks.callbacks.RLlibCallback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 15.15739917755127, "iterations_since_restore": 3, "perf": {"cpu_util_percent": 13.042857142857143, "ram_util_percent": 78.60000000000001}}
{"timers": {"training_iteration": 4.3989758122367055, "restore_env_runners": 1.3957368783106175e-05, "training_step": 4.398766299146204, "env_runner_sampling_timer": 3.9295064141862195, "learner_update_timer": 0.46555224328765094, "synch_weights": 0.0017300198411487099, "restore_eval_env_runners": 1.2913959998968494e-05, "evaluation_iteration": 0.7488451089806142, "synch_eval_env_connectors": 0.000425941209739176, "synch_env_connectors": 7.988029979424027e-06}, "env_runners": {"weights_seq_no": 3.0, "module_to_env_connector": {"timers": {"connectors": {"get_actions": 0.0001661898408767321, "tensor_to_numpy": 5.018423312796621e-05, "listify_data_for_vector_env": 3.140402557306995e-05, "un_batch_to_individual_items": 1.4952566343635861e-05, "normalize_and_clip_actions": 2.2238524478097108e-05, "remove_single_ts_time_rank_from_batch": 1.536027389203599e-06}}, "connector_pipeline_timer": 0.00036324093146695194}, "env_reset_timer": 9.918274659674776e-05, "rlmodule_inference_timer": 0.0001009188995708117, "env_step_timer": 4.2735271185455205e-05, "env_to_module_connector": {"timers": {"connectors": {"batch_individual_items": 1.866823054151347e-05, "add_observations_from_episodes_to_batch": 6.4383535057212725e-06, "numpy_to_tensor": 3.1550099110257024e-05, "add_states_from_episodes_to_batch": 3.4021986945681185e-06, "add_time_dim_to_batch_and_zero_pad": 6.188618103309112e-06}}, "connector_pipeline_timer": 0.00011911619011124785}, "num_episodes": 100.0, "episode_len_min": 50, "episode_duration_sec_mean": 0.03658670698998322, "num_module_steps_sampled": {"default_policy": 5000.0}, "num_episodes_lifetime": -9500.0, "episode_return_max": 14.5, "episode_return_min": -5.5, "num_env_steps_sampled": 5000.0, "episode_return_mean": 6.5, "num_env_steps_sampled_lifetime": -475000.0, "time_between_sampling": 0.011405307009030537, "num_agent_steps_sampled": {"default_agent": 5000.0}, "episode_len_max": 50, "num_agent_steps_sampled_lifetime": {"default_agent": -475000.0}, "env_to_module_sum_episodes_length_in": 27.16809333212661, "module_episode_returns_mean": {"default_policy": 6.5}, "sample": 0.038557612738825624, "num_module_steps_sampled_lifetime": {"default_policy": -475000.0}, "agent_episode_returns_mean": {"default_agent": 6.5}, "env_to_module_sum_episodes_length_out": 27.16809333212661, "episode_len_mean": 50.0, "num_env_steps_sampled_lifetime_throughput": 1276.6089764101557}, "learners": {"default_policy": {"vf_loss_unclipped": 11.722832679748535, "mean_kl_loss": 0.001783072017133236, "num_module_steps_trained": 16000, "diff_num_grad_updates_vs_sampler_policy": 1.0, "vf_explained_var": 0.07640969753265381, "entropy": 0.6729868650436401, "num_trainable_parameters": 5707, "vf_loss": 0.09294308722019196, "default_optimizer_learning_rate": 0.0003313639719, "curr_kl_coeff": 0.04857489466667175, "num_module_steps_trained_lifetime": 64000, "total_loss": 0.0710294172167778, "gradients_default_optimizer_global_norm": 0.02237280085682869, "module_train_batch_size_mean": 1000.0, "weights_seq_no": 4.0, "curr_entropy_coeff": 0.0090570820258, "policy_loss": 0.014790442772209644, "num_module_steps_trained_lifetime_throughput": 202210.0697824522}, "__all_modules__": {"num_module_steps_trained_lifetime": 64000, "learner_connector": {"timers": {"connectors": {"general_advantage_estimation": 0.012368831045464202, "add_time_dim_to_batch_and_zero_pad": 2.4028667441890325e-05, "batch_individual_items": 0.20983718818245445, "numpy_to_tensor": 0.00024311746707368818, "add_states_from_episodes_to_batch": 6.321829371787316e-06, "add_one_ts_to_episodes_and_truncate": 0.008983320143236023, "add_columns_from_episodes_to_train_batch": 0.07280639609450444, "add_observations_from_episodes_to_batch": 0.0008445616991978796}}, "connector_pipeline_timer": 0.3055626361055145}, "num_trainable_parameters": 5707, "learner_connector_sum_episodes_length_out": 5100.0, "num_env_steps_trained_lifetime": 326400, "num_env_steps_trained": 81600, "learner_connector_sum_episodes_length_in": 5000.0, "num_non_trainable_parameters": 0, "num_module_steps_trained": 16000, "num_env_steps_trained_lifetime_throughput": 1029494.5088005776, "num_module_steps_trained_throughput": 202419.16972420664, "num_module_steps_trained_lifetime_throughput": 202382.79739844153}}, "num_training_step_calls_per_iteration": 1, "evaluation": {"env_runners": {"module_to_env_connector": {"timers": {"connectors": {"tensor_to_numpy": 4.541234804734913e-05, "get_actions": 0.00015430764553127314, "listify_data_for_vector_env": 3.100560606436577e-05, "normalize_and_clip_actions": 2.179041483146433e-05, "un_batch_to_individual_items": 1.5714789469106732e-05, "remove_single_ts_time_rank_from_batch": 1.4294053337891833e-06}}, "connector_pipeline_timer": 0.00034181435345642663}, "env_to_module_sum_episodes_length_in": 27.168093332126602, "sample": 0.7373109017225105, "env_step_timer": 4.210623607145803e-05, "episode_len_min": 50, "env_to_module_connector": {"timers": {"connectors": {"add_time_dim_to_batch_and_zero_pad": 5.833432366157144e-06, "batch_individual_items": 1.8407544983583206e-05, "numpy_to_tensor": 2.9551102155483436e-05, "add_states_from_episodes_to_batch": 3.4113613827314197e-06, "add_observations_from_episodes_to_batch": 6.034274831982766e-06}}, "connector_pipeline_timer": 0.00011222548476789528}, "agent_episode_returns_mean": {"default_agent": 1.6}, "episode_return_min": -14.5, "num_agent_steps_sampled_lifetime": {"default_agent": 4000}, "env_to_module_sum_episodes_length_out": 27.168093332126602, "num_module_steps_sampled": {"default_policy": 1000}, "episode_len_mean": 50.0, "weights_seq_no": 4.0, "num_agent_steps_sampled": {"default_agent": 1000}, "num_episodes_lifetime": 80, "episode_return_max": 17.5, "module_episode_returns_mean": {"default_policy": 1.6}, "episode_return_mean": 1.6, "num_module_steps_sampled_lifetime": {"default_policy": 4000}, "env_reset_timer": 0.00024593173038752955, "rlmodule_inference_timer": 9.474704066314105e-05, "num_episodes": 20, "episode_duration_sec_mean": 0.03533060123755831, "num_env_steps_sampled_lifetime": 21000, "num_env_steps_sampled": 1000, "episode_len_max": 50, "time_between_sampling": 4.24424659599012}, "num_healthy_workers": 1, "actor_manager_num_outstanding_async_reqs": 0, "num_remote_worker_restarts": 0}, "num_env_steps_sampled_lifetime": -475000.0, "fault_tolerance": {"num_healthy_workers": 0, "num_remote_worker_restarts": 0}, "env_runner_group": {"actor_manager_num_outstanding_async_reqs": 0}, "done": false, "training_iteration": 4, "trial_id": "aef7a_00000", "date": "2025-08-11_17-14-08", "timestamp": 1754925248, "time_this_iter_s": 5.039427757263184, "time_total_s": 20.196826934814453, "pid": 66454, "hostname": "DESKTOP-3SK5A41", "node_ip": "192.168.40.242", "config": {"exploration_config": {}, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 6, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "env": "Umbrella", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": false, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 0, "create_local_env_runner": true, "num_envs_per_env_runner": 1, "gym_env_vectorize_mode": "SYNC", "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "episodes_to_numpy": true, "max_requests_in_flight_per_env_runner": 1, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "merge_env_runner_states": "training_only", "broadcast_env_runner_states": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "complete_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "sampler_perf_stats_ema_coef": null, "_is_online": true, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": "auto", "num_aggregator_actors_per_learner": 0, "max_requests_in_flight_per_aggregator_actor": 3, "local_gpu_idx": 0, "max_requests_in_flight_per_learner": 3, "gamma": 1, "lr": 0.0003313639719, "grad_clip": 0.5, "grad_clip_by": "global_norm", "_train_batch_size_per_learner": 5000, "train_batch_size": 4000, "num_epochs": 3, "minibatch_size": 1000, "shuffle_batch_per_epoch": true, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "log_std_clip_param": 20.0, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "_disable_preprocessor_api": false, "_disable_action_flattening": false}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "_learner_class": null, "callbacks_on_algorithm_init": null, "callbacks_on_env_runners_recreated": null, "callbacks_on_offline_eval_runners_recreated": null, "callbacks_on_checkpoint_loaded": null, "callbacks_on_environment_created": null, "callbacks_on_episode_created": null, "callbacks_on_episode_start": null, "callbacks_on_episode_step": null, "callbacks_on_episode_end": null, "callbacks_on_evaluate_start": null, "callbacks_on_evaluate_end": null, "callbacks_on_evaluate_offline_start": null, "callbacks_on_evaluate_offline_end": null, "callbacks_on_sample_end": null, "callbacks_on_train_result": null, "explore": true, "enable_rl_module_and_learner": true, "enable_env_runner_and_connector_v2": true, "_prior_exploration_config": {"type": "StochasticSampling"}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x73ae51472ac0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "offline_data_class": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_read_batch_size": null, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "materialize_data": false, "materialize_mapped_data": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "ignore_final_observation": false, "prelearner_class": null, "prelearner_buffer_class": null, "prelearner_buffer_kwargs": {}, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_remaining_data": false, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": 1, "evaluation_duration": 20, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_auto_duration_min_env_steps_per_sample": 100, "evaluation_auto_duration_max_env_steps_per_sample": 2000, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 1, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "offline_evaluation_interval": null, "num_offline_eval_runners": 0, "offline_loss_for_module_fn": null, "offline_evaluation_duration": 1, "offline_evaluation_parallel_to_training": false, "offline_evaluation_timeout_s": 120.0, "num_cpus_per_offline_eval_runner": 1, "num_gpus_per_offline_eval_runner": 0, "custom_resources_per_offline_eval_runner": {}, "restart_failed_offline_eval_runners": true, "ignore_offline_eval_runner_failures": false, "max_num_offline_eval_runner_restarts": 1000, "offline_eval_runner_restore_timeout_s": 1800.0, "max_requests_in_flight_per_offline_eval_runner": 1, "validate_offline_eval_runners_after_construction": true, "offline_eval_runner_health_probe_timeout_s": 30.0, "offline_eval_rl_module_inference_only": false, "broadcast_offline_eval_runner_states": false, "offline_eval_batch_size_per_runner": 256, "dataset_num_iters_per_eval_runner": 1, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "log_gradients": true, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 42, "restart_failed_env_runners": true, "ignore_env_runner_failures": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30.0, "env_runner_restore_timeout_s": 1800.0, "_model_config": {}, "_rl_module_spec": "RLModuleSpec(module_class=None, observation_space=None, action_space=None, inference_only=False, learner_only=False, model_config=DefaultModelConfig(fcnet_hiddens=[61, 84], fcnet_activation='tanh', fcnet_kernel_initializer=None, fcnet_kernel_initializer_kwargs=None, fcnet_bias_initializer=None, fcnet_bias_initializer_kwargs=None, conv_filters=None, conv_activation='relu', conv_kernel_initializer=None, conv_kernel_initializer_kwargs=None, conv_bias_initializer=None, conv_bias_initializer_kwargs=None, head_fcnet_hiddens=[], head_fcnet_activation='relu', head_fcnet_kernel_initializer=None, head_fcnet_kernel_initializer_kwargs=None, head_fcnet_bias_initializer=None, head_fcnet_bias_initializer_kwargs=None, free_log_std=False, log_std_clip_param=20.0, vf_share_layers=True, use_lstm=False, max_seq_len=20, lstm_cell_size=256, lstm_use_prev_action=False, lstm_use_prev_reward=False, lstm_kernel_initializer=None, lstm_kernel_initializer_kwargs=None, lstm_bias_initializer=None, lstm_bias_initializer_kwargs=None), catalog_class=None, load_state_path=None, model_config_dict=None)", "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "_validate_config": true, "_use_msgpack_checkpoints": false, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "env_task_fn": -1, "enable_connectors": -1, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.7771983355204, "kl_target": 0.026982802658, "vf_loss_coeff": 0.6688075857018, "entropy_coeff": 0.0090570820258, "clip_param": 0.1202945497339, "vf_clip_param": 0.1020987445302, "entropy_coeff_schedule": null, "lr_schedule": null, "sgd_minibatch_size": -1, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9064845981162, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.callbacks.callbacks.RLlibCallback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 20.196826934814453, "iterations_since_restore": 4, "perf": {"cpu_util_percent": 12.014285714285714, "ram_util_percent": 78.60000000000001}}
{"timers": {"training_iteration": 4.396609434114339, "restore_env_runners": 1.393679510100007e-05, "training_step": 4.396397399154739, "env_runner_sampling_timer": 3.9294038960443523, "learner_update_timer": 0.4632866298547685, "synch_weights": 0.0017271366427393632, "restore_eval_env_runners": 1.2947820394133488e-05, "evaluation_iteration": 0.7487499768908015, "synch_eval_env_connectors": 0.00042674379764196424, "synch_env_connectors": 7.968149672657091e-06}, "env_runners": {"weights_seq_no": 4.0, "module_to_env_connector": {"timers": {"connectors": {"get_actions": 0.0001670399233127564, "tensor_to_numpy": 5.0093604021707715e-05, "listify_data_for_vector_env": 3.1346673518541714e-05, "un_batch_to_individual_items": 1.5105420050367038e-05, "normalize_and_clip_actions": 2.227395188615659e-05, "remove_single_ts_time_rank_from_batch": 1.5766407271746306e-06}}, "connector_pipeline_timer": 0.00036415858843818756}, "env_reset_timer": 9.562304329458825e-05, "rlmodule_inference_timer": 0.00010075766775473116, "env_step_timer": 4.295431162746475e-05, "env_to_module_connector": {"timers": {"connectors": {"batch_individual_items": 1.8744186239036636e-05, "add_observations_from_episodes_to_batch": 6.451079616605141e-06, "numpy_to_tensor": 3.179183407869318e-05, "add_states_from_episodes_to_batch": 3.429269192812295e-06, "add_time_dim_to_batch_and_zero_pad": 6.173491754351432e-06}}, "connector_pipeline_timer": 0.00011967758863872614}, "num_episodes": 100.0, "episode_len_min": 50, "episode_duration_sec_mean": 0.03665740000006734, "num_module_steps_sampled": {"default_policy": 5000.0}, "num_episodes_lifetime": -14350.0, "episode_return_max": 14.5, "episode_return_min": -5.5, "num_env_steps_sampled": 5000.0, "episode_return_mean": 6.700000000000004, "num_env_steps_sampled_lifetime": -717500.0, "time_between_sampling": 0.012504676473264784, "num_agent_steps_sampled": {"default_agent": 5000.0}, "episode_len_max": 50, "num_agent_steps_sampled_lifetime": {"default_agent": -717500.0}, "env_to_module_sum_episodes_length_in": 27.16809333212661, "module_episode_returns_mean": {"default_policy": 6.700000000000004}, "sample": 0.038020831385046173, "num_module_steps_sampled_lifetime": {"default_policy": -717500.0}, "agent_episode_returns_mean": {"default_agent": 6.700000000000004}, "env_to_module_sum_episodes_length_out": 27.16809333212661, "episode_len_mean": 50.0, "num_env_steps_sampled_lifetime_throughput": 1274.8391077764024}, "learners": {"default_policy": {"vf_loss_unclipped": 11.228727340698242, "mean_kl_loss": 0.00066489411983639, "num_module_steps_trained": 16000, "diff_num_grad_updates_vs_sampler_policy": 1.0, "vf_explained_var": 0.10564297437667847, "entropy": 0.6771509647369385, "num_trainable_parameters": 5707, "vf_loss": 0.09150140732526779, "default_optimizer_learning_rate": 0.0003313639719, "curr_kl_coeff": 0.024287447333335876, "num_module_steps_trained_lifetime": 80000, "total_loss": 0.03967895731329918, "gradients_default_optimizer_global_norm": 0.08521901816129684, "module_train_batch_size_mean": 1000.0, "weights_seq_no": 5.0, "curr_entropy_coeff": 0.0090570820258, "policy_loss": -0.015417175367474556, "num_module_steps_trained_lifetime_throughput": 200862.26907298338}, "__all_modules__": {"num_module_steps_trained_lifetime": 80000, "learner_connector": {"timers": {"connectors": {"general_advantage_estimation": 0.01232891573501531, "add_time_dim_to_batch_and_zero_pad": 2.3970380770877267e-05, "batch_individual_items": 0.2083250583006293, "numpy_to_tensor": 0.00024243429239808326, "add_states_from_episodes_to_batch": 6.314611077018563e-06, "add_one_ts_to_episodes_and_truncate": 0.008976494941805092, "add_columns_from_episodes_to_train_batch": 0.07278042213355462, "add_observations_from_episodes_to_batch": 0.000843901082203867}}, "connector_pipeline_timer": 0.3039749927444616}, "num_trainable_parameters": 5707, "learner_connector_sum_episodes_length_out": 5100.0, "num_env_steps_trained_lifetime": 408000, "num_env_steps_trained": 81600, "learner_connector_sum_episodes_length_in": 5000.0, "num_non_trainable_parameters": 0, "num_module_steps_trained": 16000, "num_env_steps_trained_lifetime_throughput": 1022711.9045392536, "num_module_steps_trained_throughput": 201066.10054509083, "num_module_steps_trained_lifetime_throughput": 201030.01672989657}}, "num_training_step_calls_per_iteration": 1, "evaluation": {"env_runners": {"module_to_env_connector": {"timers": {"connectors": {"tensor_to_numpy": 4.578648784575276e-05, "get_actions": 0.00015648998145279352, "listify_data_for_vector_env": 3.072432475750187e-05, "normalize_and_clip_actions": 2.1444255494507922e-05, "un_batch_to_individual_items": 1.5552685059935194e-05, "remove_single_ts_time_rank_from_batch": 1.354328902360428e-06}}, "connector_pipeline_timer": 0.0003431265224738012}, "env_to_module_sum_episodes_length_in": 27.168093332126602, "sample": 0.7372128077052901, "env_step_timer": 4.2509390826860074e-05, "episode_len_min": 50, "env_to_module_connector": {"timers": {"connectors": {"add_time_dim_to_batch_and_zero_pad": 5.789106205370125e-06, "batch_individual_items": 1.8609856944046066e-05, "numpy_to_tensor": 2.950368595630206e-05, "add_states_from_episodes_to_batch": 3.394196859185636e-06, "add_observations_from_episodes_to_batch": 6.074550697583667e-06}}, "connector_pipeline_timer": 0.00011198189897050861}, "agent_episode_returns_mean": {"default_agent": 1.9}, "episode_return_min": -14.5, "num_agent_steps_sampled_lifetime": {"default_agent": 5000}, "env_to_module_sum_episodes_length_out": 27.168093332126602, "num_module_steps_sampled": {"default_policy": 1000}, "episode_len_mean": 50.0, "weights_seq_no": 5.0, "num_agent_steps_sampled": {"default_agent": 1000}, "num_episodes_lifetime": 100, "episode_return_max": 17.5, "module_episode_returns_mean": {"default_policy": 1.9}, "episode_return_mean": 1.9, "num_module_steps_sampled_lifetime": {"default_policy": 5000}, "env_reset_timer": 0.00024475441308655663, "rlmodule_inference_timer": 9.416263470935861e-05, "num_episodes": 20, "episode_duration_sec_mean": 0.03525896299004671, "num_env_steps_sampled_lifetime": 26000, "num_env_steps_sampled": 1000, "episode_len_max": 50, "time_between_sampling": 4.243976902030222}, "num_healthy_workers": 1, "actor_manager_num_outstanding_async_reqs": 0, "num_remote_worker_restarts": 0}, "num_env_steps_sampled_lifetime": -717500.0, "fault_tolerance": {"num_healthy_workers": 0, "num_remote_worker_restarts": 0}, "env_runner_group": {"actor_manager_num_outstanding_async_reqs": 0}, "done": false, "training_iteration": 5, "trial_id": "aef7a_00000", "date": "2025-08-11_17-14-13", "timestamp": 1754925253, "time_this_iter_s": 4.904567003250122, "time_total_s": 25.101393938064575, "pid": 66454, "hostname": "DESKTOP-3SK5A41", "node_ip": "192.168.40.242", "config": {"exploration_config": {}, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 6, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "env": "Umbrella", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": false, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 0, "create_local_env_runner": true, "num_envs_per_env_runner": 1, "gym_env_vectorize_mode": "SYNC", "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "episodes_to_numpy": true, "max_requests_in_flight_per_env_runner": 1, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "merge_env_runner_states": "training_only", "broadcast_env_runner_states": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "complete_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "sampler_perf_stats_ema_coef": null, "_is_online": true, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": "auto", "num_aggregator_actors_per_learner": 0, "max_requests_in_flight_per_aggregator_actor": 3, "local_gpu_idx": 0, "max_requests_in_flight_per_learner": 3, "gamma": 1, "lr": 0.0003313639719, "grad_clip": 0.5, "grad_clip_by": "global_norm", "_train_batch_size_per_learner": 5000, "train_batch_size": 4000, "num_epochs": 3, "minibatch_size": 1000, "shuffle_batch_per_epoch": true, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "log_std_clip_param": 20.0, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "_disable_preprocessor_api": false, "_disable_action_flattening": false}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "_learner_class": null, "callbacks_on_algorithm_init": null, "callbacks_on_env_runners_recreated": null, "callbacks_on_offline_eval_runners_recreated": null, "callbacks_on_checkpoint_loaded": null, "callbacks_on_environment_created": null, "callbacks_on_episode_created": null, "callbacks_on_episode_start": null, "callbacks_on_episode_step": null, "callbacks_on_episode_end": null, "callbacks_on_evaluate_start": null, "callbacks_on_evaluate_end": null, "callbacks_on_evaluate_offline_start": null, "callbacks_on_evaluate_offline_end": null, "callbacks_on_sample_end": null, "callbacks_on_train_result": null, "explore": true, "enable_rl_module_and_learner": true, "enable_env_runner_and_connector_v2": true, "_prior_exploration_config": {"type": "StochasticSampling"}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x73ae51472ac0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "offline_data_class": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_read_batch_size": null, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "materialize_data": false, "materialize_mapped_data": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "ignore_final_observation": false, "prelearner_class": null, "prelearner_buffer_class": null, "prelearner_buffer_kwargs": {}, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_remaining_data": false, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": 1, "evaluation_duration": 20, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_auto_duration_min_env_steps_per_sample": 100, "evaluation_auto_duration_max_env_steps_per_sample": 2000, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 1, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "offline_evaluation_interval": null, "num_offline_eval_runners": 0, "offline_loss_for_module_fn": null, "offline_evaluation_duration": 1, "offline_evaluation_parallel_to_training": false, "offline_evaluation_timeout_s": 120.0, "num_cpus_per_offline_eval_runner": 1, "num_gpus_per_offline_eval_runner": 0, "custom_resources_per_offline_eval_runner": {}, "restart_failed_offline_eval_runners": true, "ignore_offline_eval_runner_failures": false, "max_num_offline_eval_runner_restarts": 1000, "offline_eval_runner_restore_timeout_s": 1800.0, "max_requests_in_flight_per_offline_eval_runner": 1, "validate_offline_eval_runners_after_construction": true, "offline_eval_runner_health_probe_timeout_s": 30.0, "offline_eval_rl_module_inference_only": false, "broadcast_offline_eval_runner_states": false, "offline_eval_batch_size_per_runner": 256, "dataset_num_iters_per_eval_runner": 1, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "log_gradients": true, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 42, "restart_failed_env_runners": true, "ignore_env_runner_failures": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30.0, "env_runner_restore_timeout_s": 1800.0, "_model_config": {}, "_rl_module_spec": "RLModuleSpec(module_class=None, observation_space=None, action_space=None, inference_only=False, learner_only=False, model_config=DefaultModelConfig(fcnet_hiddens=[61, 84], fcnet_activation='tanh', fcnet_kernel_initializer=None, fcnet_kernel_initializer_kwargs=None, fcnet_bias_initializer=None, fcnet_bias_initializer_kwargs=None, conv_filters=None, conv_activation='relu', conv_kernel_initializer=None, conv_kernel_initializer_kwargs=None, conv_bias_initializer=None, conv_bias_initializer_kwargs=None, head_fcnet_hiddens=[], head_fcnet_activation='relu', head_fcnet_kernel_initializer=None, head_fcnet_kernel_initializer_kwargs=None, head_fcnet_bias_initializer=None, head_fcnet_bias_initializer_kwargs=None, free_log_std=False, log_std_clip_param=20.0, vf_share_layers=True, use_lstm=False, max_seq_len=20, lstm_cell_size=256, lstm_use_prev_action=False, lstm_use_prev_reward=False, lstm_kernel_initializer=None, lstm_kernel_initializer_kwargs=None, lstm_bias_initializer=None, lstm_bias_initializer_kwargs=None), catalog_class=None, load_state_path=None, model_config_dict=None)", "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "_validate_config": true, "_use_msgpack_checkpoints": false, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "env_task_fn": -1, "enable_connectors": -1, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.7771983355204, "kl_target": 0.026982802658, "vf_loss_coeff": 0.6688075857018, "entropy_coeff": 0.0090570820258, "clip_param": 0.1202945497339, "vf_clip_param": 0.1020987445302, "entropy_coeff_schedule": null, "lr_schedule": null, "sgd_minibatch_size": -1, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9064845981162, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.callbacks.callbacks.RLlibCallback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 25.101393938064575, "iterations_since_restore": 5, "perf": {"cpu_util_percent": 12.4875, "ram_util_percent": 78.67500000000001}}
{"timers": {"training_iteration": 4.395899320783193, "restore_env_runners": 1.3908427149368759e-05, "training_step": 4.395685920173193, "env_runner_sampling_timer": 3.929526681093913, "learner_update_timer": 0.4624520135562206, "synch_weights": 0.0017255122763121416, "restore_eval_env_runners": 1.2912342187453716e-05, "evaluation_iteration": 0.7486363051218932, "synch_eval_env_connectors": 0.0004267073596681637, "synch_env_connectors": 7.95346817974545e-06}, "env_runners": {"weights_seq_no": 5.0, "module_to_env_connector": {"timers": {"connectors": {"get_actions": 0.0001679815223948638, "tensor_to_numpy": 5.037231343879848e-05, "listify_data_for_vector_env": 3.1520178971388426e-05, "un_batch_to_individual_items": 1.5124441352766914e-05, "normalize_and_clip_actions": 2.2506690544679934e-05, "remove_single_ts_time_rank_from_batch": 1.60702547753687e-06}}, "connector_pipeline_timer": 0.0003663668118671526}, "env_reset_timer": 9.494426975844469e-05, "rlmodule_inference_timer": 0.00010164317693496717, "env_step_timer": 4.292788286316066e-05, "env_to_module_connector": {"timers": {"connectors": {"batch_individual_items": 1.8897961548316242e-05, "add_observations_from_episodes_to_batch": 6.528610347638328e-06, "numpy_to_tensor": 3.179998047506959e-05, "add_states_from_episodes_to_batch": 3.4182512310891665e-06, "add_time_dim_to_batch_and_zero_pad": 6.23466717256389e-06}}, "connector_pipeline_timer": 0.00012033321183088558}, "num_episodes": 100.0, "episode_len_min": 50, "episode_duration_sec_mean": 0.03689386000002741, "num_module_steps_sampled": {"default_policy": 5000.0}, "num_episodes_lifetime": -19200.0, "episode_return_max": 14.5, "episode_return_min": -5.5, "num_env_steps_sampled": 5000.0, "episode_return_mean": 7.299999999999996, "num_env_steps_sampled_lifetime": -960000.0, "time_between_sampling": 0.011984366624547762, "num_agent_steps_sampled": {"default_agent": 5000.0}, "episode_len_max": 50, "num_agent_steps_sampled_lifetime": {"default_agent": -960000.0}, "env_to_module_sum_episodes_length_in": 27.16809333212661, "module_episode_returns_mean": {"default_policy": 7.299999999999996}, "sample": 0.03792997356621261, "num_module_steps_sampled_lifetime": {"default_policy": -960000.0}, "agent_episode_returns_mean": {"default_agent": 7.299999999999996}, "env_to_module_sum_episodes_length_out": 27.16809333212661, "episode_len_mean": 50.0, "num_env_steps_sampled_lifetime_throughput": 1270.5576059889597}, "learners": {"default_policy": {"vf_loss_unclipped": 9.697930335998535, "mean_kl_loss": 0.0014997246908023953, "num_module_steps_trained": 16000, "diff_num_grad_updates_vs_sampler_policy": 1.0, "vf_explained_var": 0.16130715608596802, "entropy": 0.6664925813674927, "num_trainable_parameters": 5707, "vf_loss": 0.0897224172949791, "default_optimizer_learning_rate": 0.0003313639719, "curr_kl_coeff": 0.012143723666667938, "num_module_steps_trained_lifetime": 96000, "total_loss": 0.09739070385694504, "gradients_default_optimizer_global_norm": 0.0375978909432888, "module_train_batch_size_mean": 1000.0, "weights_seq_no": 6.0, "curr_entropy_coeff": 0.0090570820258, "policy_loss": 0.04338371381163597, "num_module_steps_trained_lifetime_throughput": 199623.71973067377}, "__all_modules__": {"num_module_steps_trained_lifetime": 96000, "learner_connector": {"timers": {"connectors": {"general_advantage_estimation": 0.012296020577664081, "add_time_dim_to_batch_and_zero_pad": 2.3907676955786715e-05, "batch_individual_items": 0.20824822271761922, "numpy_to_tensor": 0.00024177494947135155, "add_states_from_episodes_to_batch": 6.302464963504817e-06, "add_one_ts_to_episodes_and_truncate": 0.008971889992385764, "add_columns_from_episodes_to_train_batch": 0.0727489829122225, "add_observations_from_episodes_to_batch": 0.0008423500713798992}}, "connector_pipeline_timer": 0.3038255038170102}, "num_trainable_parameters": 5707, "learner_connector_sum_episodes_length_out": 5100.0, "num_env_steps_trained_lifetime": 489600, "num_env_steps_trained": 81600, "learner_connector_sum_episodes_length_in": 5000.0, "num_non_trainable_parameters": 0, "num_module_steps_trained": 16000, "num_env_steps_trained_lifetime_throughput": 1016480.8451915791, "num_module_steps_trained_throughput": 199820.22460865197, "num_module_steps_trained_lifetime_throughput": 199785.7180780267}}, "num_training_step_calls_per_iteration": 1, "evaluation": {"env_runners": {"module_to_env_connector": {"timers": {"connectors": {"tensor_to_numpy": 4.5450612009878716e-05, "get_actions": 0.00015595109994353482, "listify_data_for_vector_env": 3.0838090443034096e-05, "normalize_and_clip_actions": 2.167857171631446e-05, "un_batch_to_individual_items": 1.5689286645051433e-05, "remove_single_ts_time_rank_from_batch": 1.3952376930677387e-06}}, "connector_pipeline_timer": 0.000344016319769928}, "env_to_module_sum_episodes_length_in": 27.168093332126602, "sample": 0.7371859336482386, "env_step_timer": 4.2585087947947075e-05, "episode_len_min": 50, "env_to_module_connector": {"timers": {"connectors": {"add_time_dim_to_batch_and_zero_pad": 5.9773818465553e-06, "batch_individual_items": 1.882506279093113e-05, "numpy_to_tensor": 2.9622184443608314e-05, "add_states_from_episodes_to_batch": 3.273299191498381e-06, "add_observations_from_episodes_to_batch": 6.22028411933344e-06}}, "connector_pipeline_timer": 0.00011413093247071339}, "agent_episode_returns_mean": {"default_agent": 1.3}, "episode_return_min": -14.5, "num_agent_steps_sampled_lifetime": {"default_agent": 6000}, "env_to_module_sum_episodes_length_out": 27.168093332126602, "num_module_steps_sampled": {"default_policy": 1000}, "episode_len_mean": 50.0, "weights_seq_no": 6.0, "num_agent_steps_sampled": {"default_agent": 1000}, "num_episodes_lifetime": 120, "episode_return_max": 17.5, "module_episode_returns_mean": {"default_policy": 1.3}, "episode_return_mean": 1.3, "num_module_steps_sampled_lifetime": {"default_policy": 6000}, "env_reset_timer": 0.0002438668689562999, "rlmodule_inference_timer": 9.490561514123354e-05, "num_episodes": 20, "episode_duration_sec_mean": 0.035233411010021885, "num_env_steps_sampled_lifetime": 31000, "num_env_steps_sampled": 1000, "episode_len_max": 50, "time_between_sampling": 4.245329519019919}, "num_healthy_workers": 1, "actor_manager_num_outstanding_async_reqs": 0, "num_remote_worker_restarts": 0}, "num_env_steps_sampled_lifetime": -960000.0, "fault_tolerance": {"num_healthy_workers": 0, "num_remote_worker_restarts": 0}, "env_runner_group": {"actor_manager_num_outstanding_async_reqs": 0}, "done": false, "training_iteration": 6, "trial_id": "aef7a_00000", "date": "2025-08-11_17-14-18", "timestamp": 1754925258, "time_this_iter_s": 5.0747151374816895, "time_total_s": 30.176109075546265, "pid": 66454, "hostname": "DESKTOP-3SK5A41", "node_ip": "192.168.40.242", "config": {"exploration_config": {}, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 6, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "env": "Umbrella", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": false, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 0, "create_local_env_runner": true, "num_envs_per_env_runner": 1, "gym_env_vectorize_mode": "SYNC", "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "episodes_to_numpy": true, "max_requests_in_flight_per_env_runner": 1, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "merge_env_runner_states": "training_only", "broadcast_env_runner_states": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "complete_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "sampler_perf_stats_ema_coef": null, "_is_online": true, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": "auto", "num_aggregator_actors_per_learner": 0, "max_requests_in_flight_per_aggregator_actor": 3, "local_gpu_idx": 0, "max_requests_in_flight_per_learner": 3, "gamma": 1, "lr": 0.0003313639719, "grad_clip": 0.5, "grad_clip_by": "global_norm", "_train_batch_size_per_learner": 5000, "train_batch_size": 4000, "num_epochs": 3, "minibatch_size": 1000, "shuffle_batch_per_epoch": true, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "log_std_clip_param": 20.0, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "_disable_preprocessor_api": false, "_disable_action_flattening": false}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "_learner_class": null, "callbacks_on_algorithm_init": null, "callbacks_on_env_runners_recreated": null, "callbacks_on_offline_eval_runners_recreated": null, "callbacks_on_checkpoint_loaded": null, "callbacks_on_environment_created": null, "callbacks_on_episode_created": null, "callbacks_on_episode_start": null, "callbacks_on_episode_step": null, "callbacks_on_episode_end": null, "callbacks_on_evaluate_start": null, "callbacks_on_evaluate_end": null, "callbacks_on_evaluate_offline_start": null, "callbacks_on_evaluate_offline_end": null, "callbacks_on_sample_end": null, "callbacks_on_train_result": null, "explore": true, "enable_rl_module_and_learner": true, "enable_env_runner_and_connector_v2": true, "_prior_exploration_config": {"type": "StochasticSampling"}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x73ae51472ac0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "offline_data_class": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_read_batch_size": null, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "materialize_data": false, "materialize_mapped_data": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "ignore_final_observation": false, "prelearner_class": null, "prelearner_buffer_class": null, "prelearner_buffer_kwargs": {}, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_remaining_data": false, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": 1, "evaluation_duration": 20, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_auto_duration_min_env_steps_per_sample": 100, "evaluation_auto_duration_max_env_steps_per_sample": 2000, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 1, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "offline_evaluation_interval": null, "num_offline_eval_runners": 0, "offline_loss_for_module_fn": null, "offline_evaluation_duration": 1, "offline_evaluation_parallel_to_training": false, "offline_evaluation_timeout_s": 120.0, "num_cpus_per_offline_eval_runner": 1, "num_gpus_per_offline_eval_runner": 0, "custom_resources_per_offline_eval_runner": {}, "restart_failed_offline_eval_runners": true, "ignore_offline_eval_runner_failures": false, "max_num_offline_eval_runner_restarts": 1000, "offline_eval_runner_restore_timeout_s": 1800.0, "max_requests_in_flight_per_offline_eval_runner": 1, "validate_offline_eval_runners_after_construction": true, "offline_eval_runner_health_probe_timeout_s": 30.0, "offline_eval_rl_module_inference_only": false, "broadcast_offline_eval_runner_states": false, "offline_eval_batch_size_per_runner": 256, "dataset_num_iters_per_eval_runner": 1, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "log_gradients": true, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 42, "restart_failed_env_runners": true, "ignore_env_runner_failures": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30.0, "env_runner_restore_timeout_s": 1800.0, "_model_config": {}, "_rl_module_spec": "RLModuleSpec(module_class=None, observation_space=None, action_space=None, inference_only=False, learner_only=False, model_config=DefaultModelConfig(fcnet_hiddens=[61, 84], fcnet_activation='tanh', fcnet_kernel_initializer=None, fcnet_kernel_initializer_kwargs=None, fcnet_bias_initializer=None, fcnet_bias_initializer_kwargs=None, conv_filters=None, conv_activation='relu', conv_kernel_initializer=None, conv_kernel_initializer_kwargs=None, conv_bias_initializer=None, conv_bias_initializer_kwargs=None, head_fcnet_hiddens=[], head_fcnet_activation='relu', head_fcnet_kernel_initializer=None, head_fcnet_kernel_initializer_kwargs=None, head_fcnet_bias_initializer=None, head_fcnet_bias_initializer_kwargs=None, free_log_std=False, log_std_clip_param=20.0, vf_share_layers=True, use_lstm=False, max_seq_len=20, lstm_cell_size=256, lstm_use_prev_action=False, lstm_use_prev_reward=False, lstm_kernel_initializer=None, lstm_kernel_initializer_kwargs=None, lstm_bias_initializer=None, lstm_bias_initializer_kwargs=None), catalog_class=None, load_state_path=None, model_config_dict=None)", "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "_validate_config": true, "_use_msgpack_checkpoints": false, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "env_task_fn": -1, "enable_connectors": -1, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.7771983355204, "kl_target": 0.026982802658, "vf_loss_coeff": 0.6688075857018, "entropy_coeff": 0.0090570820258, "clip_param": 0.1202945497339, "vf_clip_param": 0.1020987445302, "entropy_coeff_schedule": null, "lr_schedule": null, "sgd_minibatch_size": -1, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9064845981162, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.callbacks.callbacks.RLlibCallback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 30.176109075546265, "iterations_since_restore": 6, "perf": {"cpu_util_percent": 12.785714285714286, "ram_util_percent": 78.65714285714286}}
{"timers": {"training_iteration": 4.393966012665363, "restore_env_runners": 1.388834287450508e-05, "training_step": 4.393751106061459, "env_runner_sampling_timer": 3.9297690333629753, "learner_update_timer": 0.4602753254306609, "synch_weights": 0.0017223091535458295, "restore_eval_env_runners": 1.2893218766438323e-05, "evaluation_iteration": 0.7485922100906692, "synch_eval_env_connectors": 0.00042644328607513156, "synch_env_connectors": 7.93793350324338e-06}, "env_runners": {"weights_seq_no": 6.0, "module_to_env_connector": {"timers": {"connectors": {"get_actions": 0.0001680685735577028, "tensor_to_numpy": 5.072959229479383e-05, "listify_data_for_vector_env": 3.180932775749699e-05, "un_batch_to_individual_items": 1.5142987815104005e-05, "normalize_and_clip_actions": 2.255359399497241e-05, "remove_single_ts_time_rank_from_batch": 1.578460451173e-06}}, "connector_pipeline_timer": 0.00036722469080472953}, "env_reset_timer": 9.422010066834114e-05, "rlmodule_inference_timer": 0.00010154674677832807, "env_step_timer": 4.326614965540644e-05, "env_to_module_connector": {"timers": {"connectors": {"batch_individual_items": 1.885715868823652e-05, "add_observations_from_episodes_to_batch": 6.476519702081308e-06, "numpy_to_tensor": 3.196476266742181e-05, "add_states_from_episodes_to_batch": 3.428432136372782e-06, "add_time_dim_to_batch_and_zero_pad": 6.202942774959179e-06}}, "connector_pipeline_timer": 0.00012039695466426645}, "num_episodes": 100.0, "episode_len_min": 50, "episode_duration_sec_mean": 0.036961945080001904, "num_module_steps_sampled": {"default_policy": 5000.0}, "num_episodes_lifetime": -24050.0, "episode_return_max": 14.5, "episode_return_min": -5.5, "num_env_steps_sampled": 5000.0, "episode_return_mean": 8.9, "num_env_steps_sampled_lifetime": -1202500.0, "time_between_sampling": 0.012752747615163797, "num_agent_steps_sampled": {"default_agent": 5000.0}, "episode_len_max": 50, "num_agent_steps_sampled_lifetime": {"default_agent": -1202500.0}, "env_to_module_sum_episodes_length_in": 27.16809333212661, "module_episode_returns_mean": {"default_policy": 8.9}, "sample": 0.03799225977712767, "num_module_steps_sampled_lifetime": {"default_policy": -1202500.0}, "agent_episode_returns_mean": {"default_agent": 8.9}, "env_to_module_sum_episodes_length_out": 27.16809333212661, "episode_len_mean": 50.0, "num_env_steps_sampled_lifetime_throughput": 1264.461105814858}, "learners": {"default_policy": {"vf_loss_unclipped": 9.795219421386719, "mean_kl_loss": 0.0013410403626039624, "num_module_steps_trained": 16000, "diff_num_grad_updates_vs_sampler_policy": 1.0, "vf_explained_var": 0.1682213544845581, "entropy": 0.6659031510353088, "num_trainable_parameters": 5707, "vf_loss": 0.09074033796787262, "default_optimizer_learning_rate": 0.0003313639719, "curr_kl_coeff": 0.006071861833333969, "num_module_steps_trained_lifetime": 112000, "total_loss": 0.056485366076231, "gradients_default_optimizer_global_norm": 0.06327186524868011, "module_train_batch_size_mean": 1000.0, "weights_seq_no": 7.0, "curr_entropy_coeff": 0.0090570820258, "policy_loss": 0.0018123877234756947, "num_module_steps_trained_lifetime_throughput": 198210.0853567841}, "__all_modules__": {"num_module_steps_trained_lifetime": 112000, "learner_connector": {"timers": {"connectors": {"general_advantage_estimation": 0.012280004371886644, "add_time_dim_to_batch_and_zero_pad": 2.385960018540556e-05, "batch_individual_items": 0.20675504050043983, "numpy_to_tensor": 0.0002411881999762216, "add_states_from_episodes_to_batch": 6.288440314087116e-06, "add_one_ts_to_episodes_and_truncate": 0.008967077092463771, "add_columns_from_episodes_to_train_batch": 0.07272329408309589, "add_observations_from_episodes_to_batch": 0.0008414305706617064}}, "connector_pipeline_timer": 0.3022834597888387}, "num_trainable_parameters": 5707, "learner_connector_sum_episodes_length_out": 5100.0, "num_env_steps_trained_lifetime": 571200, "num_env_steps_trained": 81600, "learner_connector_sum_episodes_length_in": 5000.0, "num_non_trainable_parameters": 0, "num_module_steps_trained": 16000, "num_env_steps_trained_lifetime_throughput": 1009355.0455542103, "num_module_steps_trained_throughput": 198400.04781940108, "num_module_steps_trained_lifetime_throughput": 198367.2944283552}}, "num_training_step_calls_per_iteration": 1, "evaluation": {"env_runners": {"module_to_env_connector": {"timers": {"connectors": {"tensor_to_numpy": 4.518242723470241e-05, "get_actions": 0.00015460290552528412, "listify_data_for_vector_env": 3.0458712006785205e-05, "normalize_and_clip_actions": 2.127610640331626e-05, "un_batch_to_individual_items": 1.541187237446466e-05, "remove_single_ts_time_rank_from_batch": 1.4230524390670714e-06}}, "connector_pipeline_timer": 0.00034086266552605456}, "env_to_module_sum_episodes_length_in": 27.168093332126602, "sample": 0.7370752263217616, "env_step_timer": 4.19746081176703e-05, "episode_len_min": 50, "env_to_module_connector": {"timers": {"connectors": {"add_time_dim_to_batch_and_zero_pad": 5.679919643137841e-06, "batch_individual_items": 1.8323699175607046e-05, "numpy_to_tensor": 2.9073847111923266e-05, "add_states_from_episodes_to_batch": 3.284711080419374e-06, "add_observations_from_episodes_to_batch": 6.029690507671619e-06}}, "connector_pipeline_timer": 0.00011161371524580394}, "agent_episode_returns_mean": {"default_agent": 2.3}, "episode_return_min": -14.5, "num_agent_steps_sampled_lifetime": {"default_agent": 7000}, "env_to_module_sum_episodes_length_out": 27.168093332126602, "num_module_steps_sampled": {"default_policy": 1000}, "episode_len_mean": 50.0, "weights_seq_no": 7.0, "num_agent_steps_sampled": {"default_agent": 1000}, "num_episodes_lifetime": 140, "episode_return_max": 17.5, "module_episode_returns_mean": {"default_policy": 2.3}, "episode_return_mean": 2.3, "num_module_steps_sampled_lifetime": {"default_policy": 7000}, "env_reset_timer": 0.00024271020026963924, "rlmodule_inference_timer": 9.391482298418501e-05, "num_episodes": 20, "episode_duration_sec_mean": 0.03517053602999112, "num_env_steps_sampled_lifetime": 36000, "num_env_steps_sampled": 1000, "episode_len_max": 50, "time_between_sampling": 4.245457626919728}, "num_healthy_workers": 1, "actor_manager_num_outstanding_async_reqs": 0, "num_remote_worker_restarts": 0}, "num_env_steps_sampled_lifetime": -1202500.0, "fault_tolerance": {"num_healthy_workers": 0, "num_remote_worker_restarts": 0}, "env_runner_group": {"actor_manager_num_outstanding_async_reqs": 0}, "done": false, "training_iteration": 7, "trial_id": "aef7a_00000", "date": "2025-08-11_17-14-23", "timestamp": 1754925263, "time_this_iter_s": 4.943190574645996, "time_total_s": 35.11929965019226, "pid": 66454, "hostname": "DESKTOP-3SK5A41", "node_ip": "192.168.40.242", "config": {"exploration_config": {}, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 6, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "env": "Umbrella", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": false, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 0, "create_local_env_runner": true, "num_envs_per_env_runner": 1, "gym_env_vectorize_mode": "SYNC", "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "episodes_to_numpy": true, "max_requests_in_flight_per_env_runner": 1, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "merge_env_runner_states": "training_only", "broadcast_env_runner_states": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "complete_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "sampler_perf_stats_ema_coef": null, "_is_online": true, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": "auto", "num_aggregator_actors_per_learner": 0, "max_requests_in_flight_per_aggregator_actor": 3, "local_gpu_idx": 0, "max_requests_in_flight_per_learner": 3, "gamma": 1, "lr": 0.0003313639719, "grad_clip": 0.5, "grad_clip_by": "global_norm", "_train_batch_size_per_learner": 5000, "train_batch_size": 4000, "num_epochs": 3, "minibatch_size": 1000, "shuffle_batch_per_epoch": true, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "log_std_clip_param": 20.0, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "_disable_preprocessor_api": false, "_disable_action_flattening": false}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "_learner_class": null, "callbacks_on_algorithm_init": null, "callbacks_on_env_runners_recreated": null, "callbacks_on_offline_eval_runners_recreated": null, "callbacks_on_checkpoint_loaded": null, "callbacks_on_environment_created": null, "callbacks_on_episode_created": null, "callbacks_on_episode_start": null, "callbacks_on_episode_step": null, "callbacks_on_episode_end": null, "callbacks_on_evaluate_start": null, "callbacks_on_evaluate_end": null, "callbacks_on_evaluate_offline_start": null, "callbacks_on_evaluate_offline_end": null, "callbacks_on_sample_end": null, "callbacks_on_train_result": null, "explore": true, "enable_rl_module_and_learner": true, "enable_env_runner_and_connector_v2": true, "_prior_exploration_config": {"type": "StochasticSampling"}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x73ae51472ac0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "offline_data_class": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_read_batch_size": null, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "materialize_data": false, "materialize_mapped_data": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "ignore_final_observation": false, "prelearner_class": null, "prelearner_buffer_class": null, "prelearner_buffer_kwargs": {}, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_remaining_data": false, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": 1, "evaluation_duration": 20, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_auto_duration_min_env_steps_per_sample": 100, "evaluation_auto_duration_max_env_steps_per_sample": 2000, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 1, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "offline_evaluation_interval": null, "num_offline_eval_runners": 0, "offline_loss_for_module_fn": null, "offline_evaluation_duration": 1, "offline_evaluation_parallel_to_training": false, "offline_evaluation_timeout_s": 120.0, "num_cpus_per_offline_eval_runner": 1, "num_gpus_per_offline_eval_runner": 0, "custom_resources_per_offline_eval_runner": {}, "restart_failed_offline_eval_runners": true, "ignore_offline_eval_runner_failures": false, "max_num_offline_eval_runner_restarts": 1000, "offline_eval_runner_restore_timeout_s": 1800.0, "max_requests_in_flight_per_offline_eval_runner": 1, "validate_offline_eval_runners_after_construction": true, "offline_eval_runner_health_probe_timeout_s": 30.0, "offline_eval_rl_module_inference_only": false, "broadcast_offline_eval_runner_states": false, "offline_eval_batch_size_per_runner": 256, "dataset_num_iters_per_eval_runner": 1, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "log_gradients": true, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 42, "restart_failed_env_runners": true, "ignore_env_runner_failures": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30.0, "env_runner_restore_timeout_s": 1800.0, "_model_config": {}, "_rl_module_spec": "RLModuleSpec(module_class=None, observation_space=None, action_space=None, inference_only=False, learner_only=False, model_config=DefaultModelConfig(fcnet_hiddens=[61, 84], fcnet_activation='tanh', fcnet_kernel_initializer=None, fcnet_kernel_initializer_kwargs=None, fcnet_bias_initializer=None, fcnet_bias_initializer_kwargs=None, conv_filters=None, conv_activation='relu', conv_kernel_initializer=None, conv_kernel_initializer_kwargs=None, conv_bias_initializer=None, conv_bias_initializer_kwargs=None, head_fcnet_hiddens=[], head_fcnet_activation='relu', head_fcnet_kernel_initializer=None, head_fcnet_kernel_initializer_kwargs=None, head_fcnet_bias_initializer=None, head_fcnet_bias_initializer_kwargs=None, free_log_std=False, log_std_clip_param=20.0, vf_share_layers=True, use_lstm=False, max_seq_len=20, lstm_cell_size=256, lstm_use_prev_action=False, lstm_use_prev_reward=False, lstm_kernel_initializer=None, lstm_kernel_initializer_kwargs=None, lstm_bias_initializer=None, lstm_bias_initializer_kwargs=None), catalog_class=None, load_state_path=None, model_config_dict=None)", "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "_validate_config": true, "_use_msgpack_checkpoints": false, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "env_task_fn": -1, "enable_connectors": -1, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.7771983355204, "kl_target": 0.026982802658, "vf_loss_coeff": 0.6688075857018, "entropy_coeff": 0.0090570820258, "clip_param": 0.1202945497339, "vf_clip_param": 0.1020987445302, "entropy_coeff_schedule": null, "lr_schedule": null, "sgd_minibatch_size": -1, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9064845981162, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.callbacks.callbacks.RLlibCallback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 35.11929965019226, "iterations_since_restore": 7, "perf": {"cpu_util_percent": 12.542857142857144, "ram_util_percent": 78.7}}
{"timers": {"training_iteration": 4.39301977961871, "restore_env_runners": 1.3863459449792308e-05, "training_step": 4.392803459080844, "env_runner_sampling_timer": 3.9296276340993486, "learner_update_timer": 0.4594705511863596, "synch_weights": 0.0017185580620109186, "restore_eval_env_runners": 1.286328657772818e-05, "evaluation_iteration": 0.7484647319997592, "synch_eval_env_connectors": 0.0004256938532219903, "synch_env_connectors": 7.921554174986783e-06}, "env_runners": {"weights_seq_no": 7.0, "module_to_env_connector": {"timers": {"connectors": {"get_actions": 0.00016654868080151093, "tensor_to_numpy": 5.02209336162474e-05, "listify_data_for_vector_env": 3.148994568471398e-05, "un_batch_to_individual_items": 1.4879359081476536e-05, "normalize_and_clip_actions": 2.2261171429556276e-05, "remove_single_ts_time_rank_from_batch": 1.5704055233640167e-06}}, "connector_pipeline_timer": 0.0003637473129762177}, "env_reset_timer": 9.477097027753605e-05, "rlmodule_inference_timer": 0.00010099675800700167, "env_step_timer": 4.2900671615673685e-05, "env_to_module_connector": {"timers": {"connectors": {"batch_individual_items": 1.8673730835915405e-05, "add_observations_from_episodes_to_batch": 6.462656694827048e-06, "numpy_to_tensor": 3.167208485716849e-05, "add_states_from_episodes_to_batch": 3.407032406788954e-06, "add_time_dim_to_batch_and_zero_pad": 6.201725255254333e-06}}, "connector_pipeline_timer": 0.00011942998814048355}, "num_episodes": 100.0, "episode_len_min": 50, "episode_duration_sec_mean": 0.0366388170600294, "num_module_steps_sampled": {"default_policy": 5000.0}, "num_episodes_lifetime": -28900.0, "episode_return_max": 14.5, "episode_return_min": -5.5, "num_env_steps_sampled": 5000.0, "episode_return_mean": 9.5, "num_env_steps_sampled_lifetime": -1445000.0, "time_between_sampling": 0.012120975142426884, "num_agent_steps_sampled": {"default_agent": 5000.0}, "episode_len_max": 50, "num_agent_steps_sampled_lifetime": {"default_agent": -1445000.0}, "env_to_module_sum_episodes_length_in": 27.16809333212661, "module_episode_returns_mean": {"default_policy": 9.5}, "sample": 0.03788359123338773, "num_module_steps_sampled_lifetime": {"default_policy": -1445000.0}, "agent_episode_returns_mean": {"default_agent": 9.5}, "env_to_module_sum_episodes_length_out": 27.16809333212661, "episode_len_mean": 50.0, "num_env_steps_sampled_lifetime_throughput": 1275.1702524790983}, "learners": {"default_policy": {"vf_loss_unclipped": 10.178937911987305, "mean_kl_loss": 0.0006209693965502083, "num_module_steps_trained": 16000, "diff_num_grad_updates_vs_sampler_policy": 1.0, "vf_explained_var": 0.19481617212295532, "entropy": 0.6638211607933044, "num_trainable_parameters": 5707, "vf_loss": 0.09315875172615051, "default_optimizer_learning_rate": 0.0003313639719, "curr_kl_coeff": 0.0030359309166669846, "num_module_steps_trained_lifetime": 128000, "total_loss": 0.046511370688676834, "gradients_default_optimizer_global_norm": 0.1541147232055664, "module_train_batch_size_mean": 1000.0, "weights_seq_no": 8.0, "curr_entropy_coeff": 0.0090570820258, "policy_loss": -0.009785410016775131, "num_module_steps_trained_lifetime_throughput": 196882.93449783963}, "__all_modules__": {"num_module_steps_trained_lifetime": 128000, "learner_connector": {"timers": {"connectors": {"general_advantage_estimation": 0.012236603328164333, "add_time_dim_to_batch_and_zero_pad": 2.3811004184208667e-05, "batch_individual_items": 0.20669681509543453, "numpy_to_tensor": 0.00024058831797688673, "add_states_from_episodes_to_batch": 6.2755559096831386e-06, "add_one_ts_to_episodes_and_truncate": 0.008961699321539021, "add_columns_from_episodes_to_train_batch": 0.07268711414226539, "add_observations_from_episodes_to_batch": 0.0008407302649581234}}, "connector_pipeline_timer": 0.30213745519095503}, "num_trainable_parameters": 5707, "learner_connector_sum_episodes_length_out": 5100.0, "num_env_steps_trained_lifetime": 652800, "num_env_steps_trained": 81600, "learner_connector_sum_episodes_length_in": 5000.0, "num_non_trainable_parameters": 0, "num_module_steps_trained": 16000, "num_env_steps_trained_lifetime_throughput": 1002673.8497163851, "num_module_steps_trained_throughput": 197067.37215777743, "num_module_steps_trained_lifetime_throughput": 197035.70577317147}}, "num_training_step_calls_per_iteration": 1, "evaluation": {"env_runners": {"module_to_env_connector": {"timers": {"connectors": {"tensor_to_numpy": 4.5261191489816156e-05, "get_actions": 0.00015420858648219172, "listify_data_for_vector_env": 3.052928974160692e-05, "normalize_and_clip_actions": 2.1609473609581697e-05, "un_batch_to_individual_items": 1.520919141468536e-05, "remove_single_ts_time_rank_from_batch": 1.3492901141448825e-06}}, "connector_pipeline_timer": 0.00034088989680590914}, "env_to_module_sum_episodes_length_in": 27.168093332126602, "sample": 0.7369985490685482, "env_step_timer": 4.1892222073320865e-05, "episode_len_min": 50, "env_to_module_connector": {"timers": {"connectors": {"add_time_dim_to_batch_and_zero_pad": 5.694893893148927e-06, "batch_individual_items": 1.8628742970312177e-05, "numpy_to_tensor": 2.9641334158059377e-05, "add_states_from_episodes_to_batch": 3.5199050947207188e-06, "add_observations_from_episodes_to_batch": 6.106012990728965e-06}}, "connector_pipeline_timer": 0.00011255766423641206}, "agent_episode_returns_mean": {"default_agent": 1.3}, "episode_return_min": -14.5, "num_agent_steps_sampled_lifetime": {"default_agent": 8000}, "env_to_module_sum_episodes_length_out": 27.168093332126602, "num_module_steps_sampled": {"default_policy": 1000}, "episode_len_mean": 50.0, "weights_seq_no": 8.0, "num_agent_steps_sampled": {"default_agent": 1000}, "num_episodes_lifetime": 160, "episode_return_max": 17.5, "module_episode_returns_mean": {"default_policy": 1.3}, "episode_return_mean": 1.3, "num_module_steps_sampled_lifetime": {"default_policy": 8000}, "env_reset_timer": 0.0002417300982711339, "rlmodule_inference_timer": 9.444112710653955e-05, "num_episodes": 20, "episode_duration_sec_mean": 0.035062743039989075, "num_env_steps_sampled_lifetime": 41000, "num_env_steps_sampled": 1000, "episode_len_max": 50, "time_between_sampling": 4.2465484107305285}, "num_healthy_workers": 1, "actor_manager_num_outstanding_async_reqs": 0, "num_remote_worker_restarts": 0}, "num_env_steps_sampled_lifetime": -1445000.0, "fault_tolerance": {"num_healthy_workers": 0, "num_remote_worker_restarts": 0}, "env_runner_group": {"actor_manager_num_outstanding_async_reqs": 0}, "done": false, "training_iteration": 8, "trial_id": "aef7a_00000", "date": "2025-08-11_17-14-28", "timestamp": 1754925268, "time_this_iter_s": 5.043507814407349, "time_total_s": 40.16280746459961, "pid": 66454, "hostname": "DESKTOP-3SK5A41", "node_ip": "192.168.40.242", "config": {"exploration_config": {}, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 6, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "env": "Umbrella", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": false, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 0, "create_local_env_runner": true, "num_envs_per_env_runner": 1, "gym_env_vectorize_mode": "SYNC", "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "episodes_to_numpy": true, "max_requests_in_flight_per_env_runner": 1, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "merge_env_runner_states": "training_only", "broadcast_env_runner_states": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "complete_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "sampler_perf_stats_ema_coef": null, "_is_online": true, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": "auto", "num_aggregator_actors_per_learner": 0, "max_requests_in_flight_per_aggregator_actor": 3, "local_gpu_idx": 0, "max_requests_in_flight_per_learner": 3, "gamma": 1, "lr": 0.0003313639719, "grad_clip": 0.5, "grad_clip_by": "global_norm", "_train_batch_size_per_learner": 5000, "train_batch_size": 4000, "num_epochs": 3, "minibatch_size": 1000, "shuffle_batch_per_epoch": true, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "log_std_clip_param": 20.0, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "_disable_preprocessor_api": false, "_disable_action_flattening": false}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "_learner_class": null, "callbacks_on_algorithm_init": null, "callbacks_on_env_runners_recreated": null, "callbacks_on_offline_eval_runners_recreated": null, "callbacks_on_checkpoint_loaded": null, "callbacks_on_environment_created": null, "callbacks_on_episode_created": null, "callbacks_on_episode_start": null, "callbacks_on_episode_step": null, "callbacks_on_episode_end": null, "callbacks_on_evaluate_start": null, "callbacks_on_evaluate_end": null, "callbacks_on_evaluate_offline_start": null, "callbacks_on_evaluate_offline_end": null, "callbacks_on_sample_end": null, "callbacks_on_train_result": null, "explore": true, "enable_rl_module_and_learner": true, "enable_env_runner_and_connector_v2": true, "_prior_exploration_config": {"type": "StochasticSampling"}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x73ae51472ac0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "offline_data_class": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_read_batch_size": null, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "materialize_data": false, "materialize_mapped_data": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "ignore_final_observation": false, "prelearner_class": null, "prelearner_buffer_class": null, "prelearner_buffer_kwargs": {}, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_remaining_data": false, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": 1, "evaluation_duration": 20, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_auto_duration_min_env_steps_per_sample": 100, "evaluation_auto_duration_max_env_steps_per_sample": 2000, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 1, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "offline_evaluation_interval": null, "num_offline_eval_runners": 0, "offline_loss_for_module_fn": null, "offline_evaluation_duration": 1, "offline_evaluation_parallel_to_training": false, "offline_evaluation_timeout_s": 120.0, "num_cpus_per_offline_eval_runner": 1, "num_gpus_per_offline_eval_runner": 0, "custom_resources_per_offline_eval_runner": {}, "restart_failed_offline_eval_runners": true, "ignore_offline_eval_runner_failures": false, "max_num_offline_eval_runner_restarts": 1000, "offline_eval_runner_restore_timeout_s": 1800.0, "max_requests_in_flight_per_offline_eval_runner": 1, "validate_offline_eval_runners_after_construction": true, "offline_eval_runner_health_probe_timeout_s": 30.0, "offline_eval_rl_module_inference_only": false, "broadcast_offline_eval_runner_states": false, "offline_eval_batch_size_per_runner": 256, "dataset_num_iters_per_eval_runner": 1, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "log_gradients": true, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 42, "restart_failed_env_runners": true, "ignore_env_runner_failures": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30.0, "env_runner_restore_timeout_s": 1800.0, "_model_config": {}, "_rl_module_spec": "RLModuleSpec(module_class=None, observation_space=None, action_space=None, inference_only=False, learner_only=False, model_config=DefaultModelConfig(fcnet_hiddens=[61, 84], fcnet_activation='tanh', fcnet_kernel_initializer=None, fcnet_kernel_initializer_kwargs=None, fcnet_bias_initializer=None, fcnet_bias_initializer_kwargs=None, conv_filters=None, conv_activation='relu', conv_kernel_initializer=None, conv_kernel_initializer_kwargs=None, conv_bias_initializer=None, conv_bias_initializer_kwargs=None, head_fcnet_hiddens=[], head_fcnet_activation='relu', head_fcnet_kernel_initializer=None, head_fcnet_kernel_initializer_kwargs=None, head_fcnet_bias_initializer=None, head_fcnet_bias_initializer_kwargs=None, free_log_std=False, log_std_clip_param=20.0, vf_share_layers=True, use_lstm=False, max_seq_len=20, lstm_cell_size=256, lstm_use_prev_action=False, lstm_use_prev_reward=False, lstm_kernel_initializer=None, lstm_kernel_initializer_kwargs=None, lstm_bias_initializer=None, lstm_bias_initializer_kwargs=None), catalog_class=None, load_state_path=None, model_config_dict=None)", "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "_validate_config": true, "_use_msgpack_checkpoints": false, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "env_task_fn": -1, "enable_connectors": -1, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.7771983355204, "kl_target": 0.026982802658, "vf_loss_coeff": 0.6688075857018, "entropy_coeff": 0.0090570820258, "clip_param": 0.1202945497339, "vf_clip_param": 0.1020987445302, "entropy_coeff_schedule": null, "lr_schedule": null, "sgd_minibatch_size": -1, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9064845981162, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.callbacks.callbacks.RLlibCallback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 40.16280746459961, "iterations_since_restore": 8, "perf": {"cpu_util_percent": 12.657142857142857, "ram_util_percent": 78.7}}
{"timers": {"training_iteration": 4.390926301882524, "restore_env_runners": 1.3835824854673076e-05, "training_step": 4.39070832055004, "env_runner_sampling_timer": 3.929694553808354, "learner_update_timer": 0.4573047256844981, "synch_weights": 0.0017170164813863277, "restore_eval_env_runners": 1.283665370646378e-05, "evaluation_iteration": 0.7483722916897595, "synch_eval_env_connectors": 0.0004259189146936885, "synch_env_connectors": 7.90133863683962e-06}, "env_runners": {"weights_seq_no": 8.0, "module_to_env_connector": {"timers": {"connectors": {"get_actions": 0.00016740193437900667, "tensor_to_numpy": 5.03560612218941e-05, "listify_data_for_vector_env": 3.1520384675319684e-05, "un_batch_to_individual_items": 1.5054161249985014e-05, "normalize_and_clip_actions": 2.235841786306698e-05, "remove_single_ts_time_rank_from_batch": 1.587334148565641e-06}}, "connector_pipeline_timer": 0.00036562946619004037}, "env_reset_timer": 9.393134935209694e-05, "rlmodule_inference_timer": 0.00010135928194056874, "env_step_timer": 4.316575164549894e-05, "env_to_module_connector": {"timers": {"connectors": {"batch_individual_items": 1.8787781775870424e-05, "add_observations_from_episodes_to_batch": 6.467385371012727e-06, "numpy_to_tensor": 3.179523588684748e-05, "add_states_from_episodes_to_batch": 3.3965371482701994e-06, "add_time_dim_to_batch_and_zero_pad": 6.186993963097547e-06}}, "connector_pipeline_timer": 0.0001198917791436297}, "num_episodes": 100.0, "episode_len_min": 50, "episode_duration_sec_mean": 0.036821053040021076, "num_module_steps_sampled": {"default_policy": 5000.0}, "num_episodes_lifetime": -33750.0, "episode_return_max": 14.5, "episode_return_min": -5.5, "num_env_steps_sampled": 5000.0, "episode_return_mean": 8.9, "num_env_steps_sampled_lifetime": -1687500.0, "time_between_sampling": 0.012756907636191757, "num_agent_steps_sampled": {"default_agent": 5000.0}, "episode_len_max": 50, "num_agent_steps_sampled_lifetime": {"default_agent": -1687500.0}, "env_to_module_sum_episodes_length_in": 27.16809333212661, "module_episode_returns_mean": {"default_policy": 8.9}, "sample": 0.037839207924536745, "num_module_steps_sampled_lifetime": {"default_policy": -1687500.0}, "agent_episode_returns_mean": {"default_agent": 8.9}, "env_to_module_sum_episodes_length_out": 27.16809333212661, "episode_len_mean": 50.0, "num_env_steps_sampled_lifetime_throughput": 1271.2800824259323}, "learners": {"default_policy": {"vf_loss_unclipped": 11.229818344116211, "mean_kl_loss": 0.0009120996110141277, "num_module_steps_trained": 16000, "diff_num_grad_updates_vs_sampler_policy": 1.0, "vf_explained_var": 0.22400188446044922, "entropy": 0.6704297065734863, "num_trainable_parameters": 5707, "vf_loss": 0.09120646119117737, "default_optimizer_learning_rate": 0.0003313639719, "curr_kl_coeff": 0.0015179654583334923, "num_module_steps_trained_lifetime": 144000, "total_loss": -0.052956320345401764, "gradients_default_optimizer_global_norm": 0.09482474625110626, "module_train_batch_size_mean": 1000.0, "weights_seq_no": 9.0, "curr_entropy_coeff": 0.0090570820258, "policy_loss": -0.10788653045892715, "num_module_steps_trained_lifetime_throughput": 195523.37142165366}, "__all_modules__": {"num_module_steps_trained_lifetime": 144000, "learner_connector": {"timers": {"connectors": {"general_advantage_estimation": 0.012218057294886597, "add_time_dim_to_batch_and_zero_pad": 2.375989413837016e-05, "batch_individual_items": 0.20521794494448764, "numpy_to_tensor": 0.00023983443479794919, "add_states_from_episodes_to_batch": 6.2628003493232005e-06, "add_one_ts_to_episodes_and_truncate": 0.008955980328326221, "add_columns_from_episodes_to_train_batch": 0.0726563560108417, "add_observations_from_episodes_to_batch": 0.0008393369623110697}}, "connector_pipeline_timer": 0.3005998826490433}, "num_trainable_parameters": 5707, "learner_connector_sum_episodes_length_out": 5100.0, "num_env_steps_trained_lifetime": 734400, "num_env_steps_trained": 81600, "learner_connector_sum_episodes_length_in": 5000.0, "num_non_trainable_parameters": 0, "num_module_steps_trained": 16000, "num_env_steps_trained_lifetime_throughput": 995823.8071236118, "num_module_steps_trained_throughput": 195703.79389877882, "num_module_steps_trained_lifetime_throughput": 195673.14812480824}}, "num_training_step_calls_per_iteration": 1, "evaluation": {"env_runners": {"module_to_env_connector": {"timers": {"connectors": {"tensor_to_numpy": 4.5083777737747185e-05, "get_actions": 0.00015691358881235405, "listify_data_for_vector_env": 3.096463606096277e-05, "normalize_and_clip_actions": 2.2386035942753882e-05, "un_batch_to_individual_items": 1.565297807843009e-05, "remove_single_ts_time_rank_from_batch": 1.4474139540822477e-06}}, "connector_pipeline_timer": 0.00034535971333555284}, "env_to_module_sum_episodes_length_in": 27.168093332126602, "sample": 0.7369069125778611, "env_step_timer": 4.2901649431613956e-05, "episode_len_min": 50, "env_to_module_connector": {"timers": {"connectors": {"add_time_dim_to_batch_and_zero_pad": 5.684302808252828e-06, "batch_individual_items": 1.9355451577623145e-05, "numpy_to_tensor": 2.9474244033379437e-05, "add_states_from_episodes_to_batch": 3.1716889083447094e-06, "add_observations_from_episodes_to_batch": 6.192497609522627e-06}}, "connector_pipeline_timer": 0.00011272119112663068}, "agent_episode_returns_mean": {"default_agent": 1.1}, "episode_return_min": -16.5, "num_agent_steps_sampled_lifetime": {"default_agent": 9000}, "env_to_module_sum_episodes_length_out": 27.168093332126602, "num_module_steps_sampled": {"default_policy": 1000}, "episode_len_mean": 50.0, "weights_seq_no": 9.0, "num_agent_steps_sampled": {"default_agent": 1000}, "num_episodes_lifetime": 180, "episode_return_max": 17.5, "module_episode_returns_mean": {"default_policy": 1.1}, "episode_return_mean": 1.1, "num_module_steps_sampled_lifetime": {"default_policy": 9000}, "env_reset_timer": 0.00024054479728349308, "rlmodule_inference_timer": 9.579010522982593e-05, "num_episodes": 20, "episode_duration_sec_mean": 0.03504565103998175, "num_env_steps_sampled_lifetime": 46000, "num_env_steps_sampled": 1000, "episode_len_max": 50, "time_between_sampling": 4.246470527683223}, "num_healthy_workers": 1, "actor_manager_num_outstanding_async_reqs": 0, "num_remote_worker_restarts": 0}, "num_env_steps_sampled_lifetime": -1687500.0, "fault_tolerance": {"num_healthy_workers": 0, "num_remote_worker_restarts": 0}, "env_runner_group": {"actor_manager_num_outstanding_async_reqs": 0}, "done": false, "training_iteration": 9, "trial_id": "aef7a_00000", "date": "2025-08-11_17-14-33", "timestamp": 1754925273, "time_this_iter_s": 4.926163673400879, "time_total_s": 45.08897113800049, "pid": 66454, "hostname": "DESKTOP-3SK5A41", "node_ip": "192.168.40.242", "config": {"exploration_config": {}, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 6, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "env": "Umbrella", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": false, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 0, "create_local_env_runner": true, "num_envs_per_env_runner": 1, "gym_env_vectorize_mode": "SYNC", "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "episodes_to_numpy": true, "max_requests_in_flight_per_env_runner": 1, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "merge_env_runner_states": "training_only", "broadcast_env_runner_states": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "complete_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "sampler_perf_stats_ema_coef": null, "_is_online": true, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": "auto", "num_aggregator_actors_per_learner": 0, "max_requests_in_flight_per_aggregator_actor": 3, "local_gpu_idx": 0, "max_requests_in_flight_per_learner": 3, "gamma": 1, "lr": 0.0003313639719, "grad_clip": 0.5, "grad_clip_by": "global_norm", "_train_batch_size_per_learner": 5000, "train_batch_size": 4000, "num_epochs": 3, "minibatch_size": 1000, "shuffle_batch_per_epoch": true, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "log_std_clip_param": 20.0, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "_disable_preprocessor_api": false, "_disable_action_flattening": false}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "_learner_class": null, "callbacks_on_algorithm_init": null, "callbacks_on_env_runners_recreated": null, "callbacks_on_offline_eval_runners_recreated": null, "callbacks_on_checkpoint_loaded": null, "callbacks_on_environment_created": null, "callbacks_on_episode_created": null, "callbacks_on_episode_start": null, "callbacks_on_episode_step": null, "callbacks_on_episode_end": null, "callbacks_on_evaluate_start": null, "callbacks_on_evaluate_end": null, "callbacks_on_evaluate_offline_start": null, "callbacks_on_evaluate_offline_end": null, "callbacks_on_sample_end": null, "callbacks_on_train_result": null, "explore": true, "enable_rl_module_and_learner": true, "enable_env_runner_and_connector_v2": true, "_prior_exploration_config": {"type": "StochasticSampling"}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x73ae51472ac0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "offline_data_class": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_read_batch_size": null, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "materialize_data": false, "materialize_mapped_data": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "ignore_final_observation": false, "prelearner_class": null, "prelearner_buffer_class": null, "prelearner_buffer_kwargs": {}, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_remaining_data": false, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": 1, "evaluation_duration": 20, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_auto_duration_min_env_steps_per_sample": 100, "evaluation_auto_duration_max_env_steps_per_sample": 2000, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 1, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "offline_evaluation_interval": null, "num_offline_eval_runners": 0, "offline_loss_for_module_fn": null, "offline_evaluation_duration": 1, "offline_evaluation_parallel_to_training": false, "offline_evaluation_timeout_s": 120.0, "num_cpus_per_offline_eval_runner": 1, "num_gpus_per_offline_eval_runner": 0, "custom_resources_per_offline_eval_runner": {}, "restart_failed_offline_eval_runners": true, "ignore_offline_eval_runner_failures": false, "max_num_offline_eval_runner_restarts": 1000, "offline_eval_runner_restore_timeout_s": 1800.0, "max_requests_in_flight_per_offline_eval_runner": 1, "validate_offline_eval_runners_after_construction": true, "offline_eval_runner_health_probe_timeout_s": 30.0, "offline_eval_rl_module_inference_only": false, "broadcast_offline_eval_runner_states": false, "offline_eval_batch_size_per_runner": 256, "dataset_num_iters_per_eval_runner": 1, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "log_gradients": true, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 42, "restart_failed_env_runners": true, "ignore_env_runner_failures": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30.0, "env_runner_restore_timeout_s": 1800.0, "_model_config": {}, "_rl_module_spec": "RLModuleSpec(module_class=None, observation_space=None, action_space=None, inference_only=False, learner_only=False, model_config=DefaultModelConfig(fcnet_hiddens=[61, 84], fcnet_activation='tanh', fcnet_kernel_initializer=None, fcnet_kernel_initializer_kwargs=None, fcnet_bias_initializer=None, fcnet_bias_initializer_kwargs=None, conv_filters=None, conv_activation='relu', conv_kernel_initializer=None, conv_kernel_initializer_kwargs=None, conv_bias_initializer=None, conv_bias_initializer_kwargs=None, head_fcnet_hiddens=[], head_fcnet_activation='relu', head_fcnet_kernel_initializer=None, head_fcnet_kernel_initializer_kwargs=None, head_fcnet_bias_initializer=None, head_fcnet_bias_initializer_kwargs=None, free_log_std=False, log_std_clip_param=20.0, vf_share_layers=True, use_lstm=False, max_seq_len=20, lstm_cell_size=256, lstm_use_prev_action=False, lstm_use_prev_reward=False, lstm_kernel_initializer=None, lstm_kernel_initializer_kwargs=None, lstm_bias_initializer=None, lstm_bias_initializer_kwargs=None), catalog_class=None, load_state_path=None, model_config_dict=None)", "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "_validate_config": true, "_use_msgpack_checkpoints": false, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "env_task_fn": -1, "enable_connectors": -1, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.7771983355204, "kl_target": 0.026982802658, "vf_loss_coeff": 0.6688075857018, "entropy_coeff": 0.0090570820258, "clip_param": 0.1202945497339, "vf_clip_param": 0.1020987445302, "entropy_coeff_schedule": null, "lr_schedule": null, "sgd_minibatch_size": -1, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9064845981162, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.callbacks.callbacks.RLlibCallback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 45.08897113800049, "iterations_since_restore": 9, "perf": {"cpu_util_percent": 13.185714285714283, "ram_util_percent": 78.68571428571428}}
{"timers": {"training_iteration": 4.390120678853693, "restore_env_runners": 1.4077466607440673e-05, "training_step": 4.389900927334543, "env_runner_sampling_timer": 3.9296336852602707, "learner_update_timer": 0.4565602264276544, "synch_weights": 0.001713073316571925, "restore_eval_env_runners": 1.2813287168565609e-05, "evaluation_iteration": 0.7482643297728557, "synch_eval_env_connectors": 0.00042507672554483204, "synch_env_connectors": 7.885325248152114e-06}, "env_runners": {"weights_seq_no": 9.0, "module_to_env_connector": {"timers": {"connectors": {"get_actions": 0.00016720766194788686, "tensor_to_numpy": 5.03716039102434e-05, "listify_data_for_vector_env": 3.1250369639004586e-05, "un_batch_to_individual_items": 1.506784246788798e-05, "normalize_and_clip_actions": 2.2378089631898933e-05, "remove_single_ts_time_rank_from_batch": 1.593865167336919e-06}}, "connector_pipeline_timer": 0.0003647471507780231}, "env_reset_timer": 9.449154258730094e-05, "rlmodule_inference_timer": 0.00010102111493072177, "env_step_timer": 4.3033081448374384e-05, "env_to_module_connector": {"timers": {"connectors": {"batch_individual_items": 1.872563997712553e-05, "add_observations_from_episodes_to_batch": 6.468497329517067e-06, "numpy_to_tensor": 3.1710328413891005e-05, "add_states_from_episodes_to_batch": 3.3930349263099935e-06, "add_time_dim_to_batch_and_zero_pad": 6.15067060063062e-06}}, "connector_pipeline_timer": 0.00011958877284520768}, "num_episodes": 100.0, "episode_len_min": 50, "episode_duration_sec_mean": 0.03671679598998706, "num_module_steps_sampled": {"default_policy": 5000.0}, "num_episodes_lifetime": -38600.0, "episode_return_max": 14.5, "episode_return_min": -5.5, "num_env_steps_sampled": 5000.0, "episode_return_mean": 8.1, "num_env_steps_sampled_lifetime": -1930000.0, "time_between_sampling": 0.01210254048669112, "num_agent_steps_sampled": {"default_agent": 5000.0}, "episode_len_max": 50, "num_agent_steps_sampled_lifetime": {"default_agent": -1930000.0}, "env_to_module_sum_episodes_length_in": 27.16809333212661, "module_episode_returns_mean": {"default_policy": 8.1}, "sample": 0.0378670938498935, "num_module_steps_sampled_lifetime": {"default_policy": -1930000.0}, "agent_episode_returns_mean": {"default_agent": 8.1}, "env_to_module_sum_episodes_length_out": 27.16809333212661, "episode_len_mean": 50.0, "num_env_steps_sampled_lifetime_throughput": 1272.1380554439086}, "learners": {"default_policy": {"vf_loss_unclipped": 9.316327095031738, "mean_kl_loss": 0.0021832939237356186, "num_module_steps_trained": 16000, "diff_num_grad_updates_vs_sampler_policy": 1.0, "vf_explained_var": 0.33173632621765137, "entropy": 0.6510763764381409, "num_trainable_parameters": 5707, "vf_loss": 0.08907850086688995, "default_optimizer_learning_rate": 0.0003313639719, "curr_kl_coeff": 0.0007589827291667461, "num_module_steps_trained_lifetime": 160000, "total_loss": 0.06450487673282623, "gradients_default_optimizer_global_norm": 0.11711916327476501, "module_train_batch_size_mean": 1000.0, "weights_seq_no": 10.0, "curr_entropy_coeff": 0.0090570820258, "policy_loss": 0.010822032578289509, "num_module_steps_trained_lifetime_throughput": 194257.67407778665}, "__all_modules__": {"num_module_steps_trained_lifetime": 160000, "learner_connector": {"timers": {"connectors": {"general_advantage_estimation": 0.012188512721937132, "add_time_dim_to_batch_and_zero_pad": 2.3732295195319393e-05, "batch_individual_items": 0.2051752064950429, "numpy_to_tensor": 0.00023969309044643137, "add_states_from_episodes_to_batch": 6.252172341605954e-06, "add_one_ts_to_episodes_and_truncate": 0.008950716525038406, "add_columns_from_episodes_to_train_batch": 0.07262797145073417, "add_observations_from_episodes_to_batch": 0.0008379525926796989}}, "connector_pipeline_timer": 0.30049110482255575}, "num_trainable_parameters": 5707, "learner_connector_sum_episodes_length_out": 5100.0, "num_env_steps_trained_lifetime": 816000, "num_env_steps_trained": 81600, "learner_connector_sum_episodes_length_in": 5000.0, "num_non_trainable_parameters": 0, "num_module_steps_trained": 16000, "num_env_steps_trained_lifetime_throughput": 989438.9256234815, "num_module_steps_trained_throughput": 194432.2610709425, "num_module_steps_trained_lifetime_throughput": 194401.2497403969}}, "num_training_step_calls_per_iteration": 1, "evaluation": {"env_runners": {"module_to_env_connector": {"timers": {"connectors": {"tensor_to_numpy": 4.668573630925618e-05, "get_actions": 0.00015669541174728174, "listify_data_for_vector_env": 3.095095436092759e-05, "normalize_and_clip_actions": 2.15708983341769e-05, "un_batch_to_individual_items": 1.615190192645158e-05, "remove_single_ts_time_rank_from_batch": 1.4171478465422526e-06}}, "connector_pipeline_timer": 0.0003467473500886203}, "env_to_module_sum_episodes_length_in": 27.168093332126602, "sample": 0.7369240584520793, "env_step_timer": 4.228491977427191e-05, "episode_len_min": 50, "env_to_module_connector": {"timers": {"connectors": {"add_time_dim_to_batch_and_zero_pad": 5.7976870017747295e-06, "batch_individual_items": 1.8486096692199785e-05, "numpy_to_tensor": 2.9391989502394756e-05, "add_states_from_episodes_to_batch": 3.4455111012478874e-06, "add_observations_from_episodes_to_batch": 6.011832257910836e-06}}, "connector_pipeline_timer": 0.00011371787707179652}, "agent_episode_returns_mean": {"default_agent": 0.5}, "episode_return_min": -16.5, "num_agent_steps_sampled_lifetime": {"default_agent": 10000}, "env_to_module_sum_episodes_length_out": 27.168093332126602, "num_module_steps_sampled": {"default_policy": 1000}, "episode_len_mean": 50.0, "weights_seq_no": 10.0, "num_agent_steps_sampled": {"default_agent": 1000}, "num_episodes_lifetime": 200, "episode_return_max": 17.5, "module_episode_returns_mean": {"default_policy": 0.5}, "episode_return_mean": 0.5, "num_module_steps_sampled_lifetime": {"default_policy": 10000}, "env_reset_timer": 0.00023936734931165047, "rlmodule_inference_timer": 9.525836117261122e-05, "num_episodes": 20, "episode_duration_sec_mean": 0.03515304903997276, "num_env_steps_sampled_lifetime": 51000, "num_env_steps_sampled": 1000, "episode_len_max": 50, "time_between_sampling": 4.247643989396385}, "num_healthy_workers": 1, "actor_manager_num_outstanding_async_reqs": 0, "num_remote_worker_restarts": 0}, "num_env_steps_sampled_lifetime": -1930000.0, "fault_tolerance": {"num_healthy_workers": 0, "num_remote_worker_restarts": 0}, "env_runner_group": {"actor_manager_num_outstanding_async_reqs": 0}, "done": false, "training_iteration": 10, "trial_id": "aef7a_00000", "date": "2025-08-11_17-14-38", "timestamp": 1754925278, "time_this_iter_s": 5.06386661529541, "time_total_s": 50.1528377532959, "pid": 66454, "hostname": "DESKTOP-3SK5A41", "node_ip": "192.168.40.242", "config": {"exploration_config": {}, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 6, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "env": "Umbrella", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": false, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 0, "create_local_env_runner": true, "num_envs_per_env_runner": 1, "gym_env_vectorize_mode": "SYNC", "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "episodes_to_numpy": true, "max_requests_in_flight_per_env_runner": 1, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "merge_env_runner_states": "training_only", "broadcast_env_runner_states": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "complete_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "sampler_perf_stats_ema_coef": null, "_is_online": true, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": "auto", "num_aggregator_actors_per_learner": 0, "max_requests_in_flight_per_aggregator_actor": 3, "local_gpu_idx": 0, "max_requests_in_flight_per_learner": 3, "gamma": 1, "lr": 0.0003313639719, "grad_clip": 0.5, "grad_clip_by": "global_norm", "_train_batch_size_per_learner": 5000, "train_batch_size": 4000, "num_epochs": 3, "minibatch_size": 1000, "shuffle_batch_per_epoch": true, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "log_std_clip_param": 20.0, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "_disable_preprocessor_api": false, "_disable_action_flattening": false}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "_learner_class": null, "callbacks_on_algorithm_init": null, "callbacks_on_env_runners_recreated": null, "callbacks_on_offline_eval_runners_recreated": null, "callbacks_on_checkpoint_loaded": null, "callbacks_on_environment_created": null, "callbacks_on_episode_created": null, "callbacks_on_episode_start": null, "callbacks_on_episode_step": null, "callbacks_on_episode_end": null, "callbacks_on_evaluate_start": null, "callbacks_on_evaluate_end": null, "callbacks_on_evaluate_offline_start": null, "callbacks_on_evaluate_offline_end": null, "callbacks_on_sample_end": null, "callbacks_on_train_result": null, "explore": true, "enable_rl_module_and_learner": true, "enable_env_runner_and_connector_v2": true, "_prior_exploration_config": {"type": "StochasticSampling"}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x73ae51472ac0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "offline_data_class": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_read_batch_size": null, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "materialize_data": false, "materialize_mapped_data": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "ignore_final_observation": false, "prelearner_class": null, "prelearner_buffer_class": null, "prelearner_buffer_kwargs": {}, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_remaining_data": false, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": 1, "evaluation_duration": 20, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_auto_duration_min_env_steps_per_sample": 100, "evaluation_auto_duration_max_env_steps_per_sample": 2000, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 1, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "offline_evaluation_interval": null, "num_offline_eval_runners": 0, "offline_loss_for_module_fn": null, "offline_evaluation_duration": 1, "offline_evaluation_parallel_to_training": false, "offline_evaluation_timeout_s": 120.0, "num_cpus_per_offline_eval_runner": 1, "num_gpus_per_offline_eval_runner": 0, "custom_resources_per_offline_eval_runner": {}, "restart_failed_offline_eval_runners": true, "ignore_offline_eval_runner_failures": false, "max_num_offline_eval_runner_restarts": 1000, "offline_eval_runner_restore_timeout_s": 1800.0, "max_requests_in_flight_per_offline_eval_runner": 1, "validate_offline_eval_runners_after_construction": true, "offline_eval_runner_health_probe_timeout_s": 30.0, "offline_eval_rl_module_inference_only": false, "broadcast_offline_eval_runner_states": false, "offline_eval_batch_size_per_runner": 256, "dataset_num_iters_per_eval_runner": 1, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "log_gradients": true, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 42, "restart_failed_env_runners": true, "ignore_env_runner_failures": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30.0, "env_runner_restore_timeout_s": 1800.0, "_model_config": {}, "_rl_module_spec": "RLModuleSpec(module_class=None, observation_space=None, action_space=None, inference_only=False, learner_only=False, model_config=DefaultModelConfig(fcnet_hiddens=[61, 84], fcnet_activation='tanh', fcnet_kernel_initializer=None, fcnet_kernel_initializer_kwargs=None, fcnet_bias_initializer=None, fcnet_bias_initializer_kwargs=None, conv_filters=None, conv_activation='relu', conv_kernel_initializer=None, conv_kernel_initializer_kwargs=None, conv_bias_initializer=None, conv_bias_initializer_kwargs=None, head_fcnet_hiddens=[], head_fcnet_activation='relu', head_fcnet_kernel_initializer=None, head_fcnet_kernel_initializer_kwargs=None, head_fcnet_bias_initializer=None, head_fcnet_bias_initializer_kwargs=None, free_log_std=False, log_std_clip_param=20.0, vf_share_layers=True, use_lstm=False, max_seq_len=20, lstm_cell_size=256, lstm_use_prev_action=False, lstm_use_prev_reward=False, lstm_kernel_initializer=None, lstm_kernel_initializer_kwargs=None, lstm_bias_initializer=None, lstm_bias_initializer_kwargs=None), catalog_class=None, load_state_path=None, model_config_dict=None)", "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "_validate_config": true, "_use_msgpack_checkpoints": false, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "env_task_fn": -1, "enable_connectors": -1, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.7771983355204, "kl_target": 0.026982802658, "vf_loss_coeff": 0.6688075857018, "entropy_coeff": 0.0090570820258, "clip_param": 0.1202945497339, "vf_clip_param": 0.1020987445302, "entropy_coeff_schedule": null, "lr_schedule": null, "sgd_minibatch_size": -1, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9064845981162, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.callbacks.callbacks.RLlibCallback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 50.1528377532959, "iterations_since_restore": 10, "perf": {"cpu_util_percent": 12.642857142857142, "ram_util_percent": 78.7}}
{"timers": {"training_iteration": 4.387920115065159, "restore_env_runners": 1.4035691940320508e-05, "training_step": 4.3876989880611985, "env_runner_sampling_timer": 3.929598087407669, "learner_update_timer": 0.45439502316337615, "synch_weights": 0.0017094145833976581, "restore_eval_env_runners": 1.2781154291180608e-05, "evaluation_iteration": 0.7482671594751242, "synch_eval_env_connectors": 0.0004242859582874693, "synch_env_connectors": 7.863471993139259e-06}, "env_runners": {"weights_seq_no": 10.0, "module_to_env_connector": {"timers": {"connectors": {"get_actions": 0.0001668575892061348, "tensor_to_numpy": 5.027184187860813e-05, "listify_data_for_vector_env": 3.15476888903223e-05, "un_batch_to_individual_items": 1.5036936289073324e-05, "normalize_and_clip_actions": 2.231258769832199e-05, "remove_single_ts_time_rank_from_batch": 1.5900213268276885e-06}}, "connector_pipeline_timer": 0.0003646133995281906}, "env_reset_timer": 9.417898091497523e-05, "rlmodule_inference_timer": 0.0001010615209383275, "env_step_timer": 4.30735471003043e-05, "env_to_module_connector": {"timers": {"connectors": {"batch_individual_items": 1.8795643046647718e-05, "add_observations_from_episodes_to_batch": 6.423437984279733e-06, "numpy_to_tensor": 3.184637900629424e-05, "add_states_from_episodes_to_batch": 3.391007463897803e-06, "add_time_dim_to_batch_and_zero_pad": 6.133523376079846e-06}}, "connector_pipeline_timer": 0.00011968621934013067}, "num_episodes": 100.0, "episode_len_min": 50, "episode_duration_sec_mean": 0.036725448000033786, "num_module_steps_sampled": {"default_policy": 5000.0}, "num_episodes_lifetime": -43450.0, "episode_return_max": 14.5, "episode_return_min": -5.5, "num_env_steps_sampled": 5000.0, "episode_return_mean": 9.5, "num_env_steps_sampled_lifetime": -2172500.0, "time_between_sampling": 0.012815837038339066, "num_agent_steps_sampled": {"default_agent": 5000.0}, "episode_len_max": 50, "num_agent_steps_sampled_lifetime": {"default_agent": -2172500.0}, "env_to_module_sum_episodes_length_in": 27.16809333212661, "module_episode_returns_mean": {"default_policy": 9.5}, "sample": 0.03779962968331735, "num_module_steps_sampled_lifetime": {"default_policy": -2172500.0}, "agent_episode_returns_mean": {"default_agent": 9.5}, "env_to_module_sum_episodes_length_out": 27.16809333212661, "episode_len_mean": 50.0, "num_env_steps_sampled_lifetime_throughput": 1273.8372472849078}, "learners": {"default_policy": {"vf_loss_unclipped": 9.075645446777344, "mean_kl_loss": 0.003703711088746786, "num_module_steps_trained": 16000, "diff_num_grad_updates_vs_sampler_policy": 1.0, "vf_explained_var": 0.3584120273590088, "entropy": 0.6367182731628418, "num_trainable_parameters": 5707, "vf_loss": 0.09293242543935776, "default_optimizer_learning_rate": 0.0003313639719, "curr_kl_coeff": 0.00037949136458337307, "num_module_steps_trained_lifetime": 176000, "total_loss": 0.05536627024412155, "gradients_default_optimizer_global_norm": 0.03265655040740967, "module_train_batch_size_mean": 1000.0, "weights_seq_no": 11.0, "curr_entropy_coeff": 0.0090570820258, "policy_loss": -0.0010236455127596855, "num_module_steps_trained_lifetime_throughput": 193123.01493816552}, "__all_modules__": {"num_module_steps_trained_lifetime": 176000, "learner_connector": {"timers": {"connectors": {"general_advantage_estimation": 0.012153521594714152, "add_time_dim_to_batch_and_zero_pad": 2.3712972248045398e-05, "batch_individual_items": 0.20372677843009582, "numpy_to_tensor": 0.0002389881595381499, "add_states_from_episodes_to_batch": 6.24365062009992e-06, "add_one_ts_to_episodes_and_truncate": 0.008945780359794712, "add_columns_from_episodes_to_train_batch": 0.07260101673623189, "add_observations_from_episodes_to_batch": 0.0008368200667469969}}, "connector_pipeline_timer": 0.2989725567743338}, "num_trainable_parameters": 5707, "learner_connector_sum_episodes_length_out": 5100.0, "num_env_steps_trained_lifetime": 897600, "num_env_steps_trained": 81600, "learner_connector_sum_episodes_length_in": 5000.0, "num_non_trainable_parameters": 0, "num_module_steps_trained": 16000, "num_env_steps_trained_lifetime_throughput": 983716.9411166052, "num_module_steps_trained_throughput": 193291.98484221063, "num_module_steps_trained_lifetime_throughput": 193261.03348610073}}, "num_training_step_calls_per_iteration": 1, "evaluation": {"env_runners": {"module_to_env_connector": {"timers": {"connectors": {"tensor_to_numpy": 4.464932063776294e-05, "get_actions": 0.0001556324108269317, "listify_data_for_vector_env": 3.1280550709798184e-05, "normalize_and_clip_actions": 2.1227003446132016e-05, "un_batch_to_individual_items": 1.5332664740274576e-05, "remove_single_ts_time_rank_from_batch": 1.4094591120151527e-06}}, "connector_pipeline_timer": 0.00034144864965532357}, "env_to_module_sum_episodes_length_in": 27.168093332126602, "sample": 0.7368175538675609, "env_step_timer": 4.2254086571225604e-05, "episode_len_min": 50, "env_to_module_connector": {"timers": {"connectors": {"add_time_dim_to_batch_and_zero_pad": 5.947824846999188e-06, "batch_individual_items": 1.871137361575371e-05, "numpy_to_tensor": 2.9972400407911028e-05, "add_states_from_episodes_to_batch": 3.2457940347357964e-06, "add_observations_from_episodes_to_batch": 6.061555984557334e-06}}, "connector_pipeline_timer": 0.00011326358717756681}, "agent_episode_returns_mean": {"default_agent": 0.9}, "episode_return_min": -16.5, "num_agent_steps_sampled_lifetime": {"default_agent": 11000}, "env_to_module_sum_episodes_length_out": 27.168093332126602, "num_module_steps_sampled": {"default_policy": 1000}, "episode_len_mean": 50.0, "weights_seq_no": 11.0, "num_agent_steps_sampled": {"default_agent": 1000}, "num_episodes_lifetime": 220, "episode_return_max": 17.5, "module_episode_returns_mean": {"default_policy": 0.9}, "episode_return_mean": 0.9, "num_module_steps_sampled_lifetime": {"default_policy": 11000}, "env_reset_timer": 0.00023820267581804583, "rlmodule_inference_timer": 9.482618450715851e-05, "num_episodes": 20, "episode_duration_sec_mean": 0.03507407301997773, "num_env_steps_sampled_lifetime": 56000, "num_env_steps_sampled": 1000, "episode_len_max": 50, "time_between_sampling": 4.247391398502423}, "num_healthy_workers": 1, "actor_manager_num_outstanding_async_reqs": 0, "num_remote_worker_restarts": 0}, "num_env_steps_sampled_lifetime": -2172500.0, "fault_tolerance": {"num_healthy_workers": 0, "num_remote_worker_restarts": 0}, "env_runner_group": {"actor_manager_num_outstanding_async_reqs": 0}, "done": false, "training_iteration": 11, "trial_id": "aef7a_00000", "date": "2025-08-11_17-14-43", "timestamp": 1754925283, "time_this_iter_s": 4.910030841827393, "time_total_s": 55.06286859512329, "pid": 66454, "hostname": "DESKTOP-3SK5A41", "node_ip": "192.168.40.242", "config": {"exploration_config": {}, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 6, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "env": "Umbrella", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": false, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 0, "create_local_env_runner": true, "num_envs_per_env_runner": 1, "gym_env_vectorize_mode": "SYNC", "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "episodes_to_numpy": true, "max_requests_in_flight_per_env_runner": 1, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "merge_env_runner_states": "training_only", "broadcast_env_runner_states": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "complete_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "sampler_perf_stats_ema_coef": null, "_is_online": true, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": "auto", "num_aggregator_actors_per_learner": 0, "max_requests_in_flight_per_aggregator_actor": 3, "local_gpu_idx": 0, "max_requests_in_flight_per_learner": 3, "gamma": 1, "lr": 0.0003313639719, "grad_clip": 0.5, "grad_clip_by": "global_norm", "_train_batch_size_per_learner": 5000, "train_batch_size": 4000, "num_epochs": 3, "minibatch_size": 1000, "shuffle_batch_per_epoch": true, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "log_std_clip_param": 20.0, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "_disable_preprocessor_api": false, "_disable_action_flattening": false}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "_learner_class": null, "callbacks_on_algorithm_init": null, "callbacks_on_env_runners_recreated": null, "callbacks_on_offline_eval_runners_recreated": null, "callbacks_on_checkpoint_loaded": null, "callbacks_on_environment_created": null, "callbacks_on_episode_created": null, "callbacks_on_episode_start": null, "callbacks_on_episode_step": null, "callbacks_on_episode_end": null, "callbacks_on_evaluate_start": null, "callbacks_on_evaluate_end": null, "callbacks_on_evaluate_offline_start": null, "callbacks_on_evaluate_offline_end": null, "callbacks_on_sample_end": null, "callbacks_on_train_result": null, "explore": true, "enable_rl_module_and_learner": true, "enable_env_runner_and_connector_v2": true, "_prior_exploration_config": {"type": "StochasticSampling"}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x73ae51472ac0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "offline_data_class": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_read_batch_size": null, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "materialize_data": false, "materialize_mapped_data": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "ignore_final_observation": false, "prelearner_class": null, "prelearner_buffer_class": null, "prelearner_buffer_kwargs": {}, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_remaining_data": false, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": 1, "evaluation_duration": 20, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_auto_duration_min_env_steps_per_sample": 100, "evaluation_auto_duration_max_env_steps_per_sample": 2000, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 1, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "offline_evaluation_interval": null, "num_offline_eval_runners": 0, "offline_loss_for_module_fn": null, "offline_evaluation_duration": 1, "offline_evaluation_parallel_to_training": false, "offline_evaluation_timeout_s": 120.0, "num_cpus_per_offline_eval_runner": 1, "num_gpus_per_offline_eval_runner": 0, "custom_resources_per_offline_eval_runner": {}, "restart_failed_offline_eval_runners": true, "ignore_offline_eval_runner_failures": false, "max_num_offline_eval_runner_restarts": 1000, "offline_eval_runner_restore_timeout_s": 1800.0, "max_requests_in_flight_per_offline_eval_runner": 1, "validate_offline_eval_runners_after_construction": true, "offline_eval_runner_health_probe_timeout_s": 30.0, "offline_eval_rl_module_inference_only": false, "broadcast_offline_eval_runner_states": false, "offline_eval_batch_size_per_runner": 256, "dataset_num_iters_per_eval_runner": 1, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "log_gradients": true, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 42, "restart_failed_env_runners": true, "ignore_env_runner_failures": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30.0, "env_runner_restore_timeout_s": 1800.0, "_model_config": {}, "_rl_module_spec": "RLModuleSpec(module_class=None, observation_space=None, action_space=None, inference_only=False, learner_only=False, model_config=DefaultModelConfig(fcnet_hiddens=[61, 84], fcnet_activation='tanh', fcnet_kernel_initializer=None, fcnet_kernel_initializer_kwargs=None, fcnet_bias_initializer=None, fcnet_bias_initializer_kwargs=None, conv_filters=None, conv_activation='relu', conv_kernel_initializer=None, conv_kernel_initializer_kwargs=None, conv_bias_initializer=None, conv_bias_initializer_kwargs=None, head_fcnet_hiddens=[], head_fcnet_activation='relu', head_fcnet_kernel_initializer=None, head_fcnet_kernel_initializer_kwargs=None, head_fcnet_bias_initializer=None, head_fcnet_bias_initializer_kwargs=None, free_log_std=False, log_std_clip_param=20.0, vf_share_layers=True, use_lstm=False, max_seq_len=20, lstm_cell_size=256, lstm_use_prev_action=False, lstm_use_prev_reward=False, lstm_kernel_initializer=None, lstm_kernel_initializer_kwargs=None, lstm_bias_initializer=None, lstm_bias_initializer_kwargs=None), catalog_class=None, load_state_path=None, model_config_dict=None)", "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "_validate_config": true, "_use_msgpack_checkpoints": false, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "env_task_fn": -1, "enable_connectors": -1, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.7771983355204, "kl_target": 0.026982802658, "vf_loss_coeff": 0.6688075857018, "entropy_coeff": 0.0090570820258, "clip_param": 0.1202945497339, "vf_clip_param": 0.1020987445302, "entropy_coeff_schedule": null, "lr_schedule": null, "sgd_minibatch_size": -1, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9064845981162, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.callbacks.callbacks.RLlibCallback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 55.06286859512329, "iterations_since_restore": 11, "perf": {"cpu_util_percent": 13.100000000000003, "ram_util_percent": 78.7}}
{"timers": {"training_iteration": 4.387356734914514, "restore_env_runners": 1.4260335026248542e-05, "training_step": 4.387133730180588, "env_runner_sampling_timer": 3.9297906505335978, "learner_update_timer": 0.4536350709317413, "synch_weights": 0.0017077294375614984, "restore_eval_env_runners": 1.276734275230108e-05, "evaluation_iteration": 0.7481425318803753, "synch_eval_env_connectors": 0.00042377209870461576, "synch_env_connectors": 7.849837277022796e-06}, "env_runners": {"weights_seq_no": 11.0, "module_to_env_connector": {"timers": {"connectors": {"get_actions": 0.00016795707246178927, "tensor_to_numpy": 5.0695837289492935e-05, "listify_data_for_vector_env": 3.137027050982232e-05, "un_batch_to_individual_items": 1.5145526107546166e-05, "normalize_and_clip_actions": 2.2574223267539535e-05, "remove_single_ts_time_rank_from_batch": 1.602120123130177e-06}}, "connector_pipeline_timer": 0.0003669835306206192}, "env_reset_timer": 9.385850624547955e-05, "rlmodule_inference_timer": 0.00010155438448786044, "env_step_timer": 4.3127958907263064e-05, "env_to_module_connector": {"timers": {"connectors": {"batch_individual_items": 1.8837489223664142e-05, "add_observations_from_episodes_to_batch": 6.490891439505621e-06, "numpy_to_tensor": 3.1801735782836855e-05, "add_states_from_episodes_to_batch": 3.4528422638713465e-06, "add_time_dim_to_batch_and_zero_pad": 6.179234514537997e-06}}, "connector_pipeline_timer": 0.00012011322042809163}, "num_episodes": 100.0, "episode_len_min": 50, "episode_duration_sec_mean": 0.036948455000019746, "num_module_steps_sampled": {"default_policy": 5000.0}, "num_episodes_lifetime": -48300.0, "episode_return_max": 14.5, "episode_return_min": -5.5, "num_env_steps_sampled": 5000.0, "episode_return_mean": 9.700000000000003, "num_env_steps_sampled_lifetime": -2415000.0, "time_between_sampling": 0.012098600573626017, "num_agent_steps_sampled": {"default_agent": 5000.0}, "episode_len_max": 50, "num_agent_steps_sampled_lifetime": {"default_agent": -2415000.0}, "env_to_module_sum_episodes_length_in": 27.16809333212661, "module_episode_returns_mean": {"default_policy": 9.700000000000003}, "sample": 0.03789853403260353, "num_module_steps_sampled_lifetime": {"default_policy": -2415000.0}, "agent_episode_returns_mean": {"default_agent": 9.700000000000003}, "env_to_module_sum_episodes_length_out": 27.16809333212661, "episode_len_mean": 50.0, "num_env_steps_sampled_lifetime_throughput": 1267.1685930189285}, "learners": {"default_policy": {"vf_loss_unclipped": 9.755895614624023, "mean_kl_loss": 0.0019403282785788178, "num_module_steps_trained": 16000, "diff_num_grad_updates_vs_sampler_policy": 1.0, "vf_explained_var": 0.36213499307632446, "entropy": 0.6177619099617004, "num_trainable_parameters": 5707, "vf_loss": 0.09146483987569809, "default_optimizer_learning_rate": 0.0003313639719, "curr_kl_coeff": 0.00018974568229168653, "num_module_steps_trained_lifetime": 192000, "total_loss": 0.014812914654612541, "gradients_default_optimizer_global_norm": 0.11147093027830124, "module_train_batch_size_mean": 1000.0, "weights_seq_no": 12.0, "curr_entropy_coeff": 0.0090570820258, "policy_loss": -0.04076509550213814, "num_module_steps_trained_lifetime_throughput": 192533.37130167312}, "__all_modules__": {"num_module_steps_trained_lifetime": 192000, "learner_connector": {"timers": {"connectors": {"general_advantage_estimation": 0.012125941378769108, "add_time_dim_to_batch_and_zero_pad": 2.3669842529395243e-05, "batch_individual_items": 0.20371494064579818, "numpy_to_tensor": 0.00023829027794804622, "add_states_from_episodes_to_batch": 6.233214118769855e-06, "add_one_ts_to_episodes_and_truncate": 0.008940664556196869, "add_columns_from_episodes_to_train_batch": 0.07256668056886927, "add_observations_from_episodes_to_batch": 0.0008354778660733841}}, "connector_pipeline_timer": 0.2988901832065834}, "num_trainable_parameters": 5707, "learner_connector_sum_episodes_length_out": 5100.0, "num_env_steps_trained_lifetime": 979200, "num_env_steps_trained": 81600, "learner_connector_sum_episodes_length_in": 5000.0, "num_non_trainable_parameters": 0, "num_module_steps_trained": 16000, "num_env_steps_trained_lifetime_throughput": 980787.5877341069, "num_module_steps_trained_throughput": 192697.70392743312, "num_module_steps_trained_lifetime_throughput": 192668.24680667245}}, "num_training_step_calls_per_iteration": 1, "evaluation": {"env_runners": {"module_to_env_connector": {"timers": {"connectors": {"tensor_to_numpy": 4.5152937255593846e-05, "get_actions": 0.0001544725640715495, "listify_data_for_vector_env": 3.0699596367969655e-05, "normalize_and_clip_actions": 2.2028287792236012e-05, "un_batch_to_individual_items": 1.5267657843336738e-05, "remove_single_ts_time_rank_from_batch": 1.3553955488221633e-06}}, "connector_pipeline_timer": 0.00034100950092923}, "env_to_module_sum_episodes_length_in": 27.168093332126602, "sample": 0.7367474313288802, "env_step_timer": 4.204911073482211e-05, "episode_len_min": 50, "env_to_module_connector": {"timers": {"connectors": {"add_time_dim_to_batch_and_zero_pad": 5.9581865494117345e-06, "batch_individual_items": 1.8154641682147104e-05, "numpy_to_tensor": 2.9336419023404545e-05, "add_states_from_episodes_to_batch": 3.269983449768229e-06, "add_observations_from_episodes_to_batch": 6.268851592232008e-06}}, "connector_pipeline_timer": 0.00011162963735597633}, "agent_episode_returns_mean": {"default_agent": -0.1}, "episode_return_min": -16.5, "num_agent_steps_sampled_lifetime": {"default_agent": 12000}, "env_to_module_sum_episodes_length_out": 27.168093332126602, "num_module_steps_sampled": {"default_policy": 1000}, "episode_len_mean": 50.0, "weights_seq_no": 12.0, "num_agent_steps_sampled": {"default_agent": 1000}, "num_episodes_lifetime": 240, "episode_return_max": 17.5, "module_episode_returns_mean": {"default_policy": -0.1}, "episode_return_mean": -0.1, "num_module_steps_sampled_lifetime": {"default_policy": 12000}, "env_reset_timer": 0.00023702564905852833, "rlmodule_inference_timer": 9.540618278000505e-05, "num_episodes": 20, "episode_duration_sec_mean": 0.0351086440099698, "num_env_steps_sampled_lifetime": 61000, "num_env_steps_sampled": 1000, "episode_len_max": 50, "time_between_sampling": 4.248779352517404}, "num_healthy_workers": 1, "actor_manager_num_outstanding_async_reqs": 0, "num_remote_worker_restarts": 0}, "num_env_steps_sampled_lifetime": -2415000.0, "fault_tolerance": {"num_healthy_workers": 0, "num_remote_worker_restarts": 0}, "env_runner_group": {"actor_manager_num_outstanding_async_reqs": 0}, "done": false, "training_iteration": 12, "trial_id": "aef7a_00000", "date": "2025-08-11_17-14-48", "timestamp": 1754925288, "time_this_iter_s": 5.076319217681885, "time_total_s": 60.139187812805176, "pid": 66454, "hostname": "DESKTOP-3SK5A41", "node_ip": "192.168.40.242", "config": {"exploration_config": {}, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 6, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "env": "Umbrella", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": false, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 0, "create_local_env_runner": true, "num_envs_per_env_runner": 1, "gym_env_vectorize_mode": "SYNC", "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "episodes_to_numpy": true, "max_requests_in_flight_per_env_runner": 1, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "merge_env_runner_states": "training_only", "broadcast_env_runner_states": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "complete_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "sampler_perf_stats_ema_coef": null, "_is_online": true, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": "auto", "num_aggregator_actors_per_learner": 0, "max_requests_in_flight_per_aggregator_actor": 3, "local_gpu_idx": 0, "max_requests_in_flight_per_learner": 3, "gamma": 1, "lr": 0.0003313639719, "grad_clip": 0.5, "grad_clip_by": "global_norm", "_train_batch_size_per_learner": 5000, "train_batch_size": 4000, "num_epochs": 3, "minibatch_size": 1000, "shuffle_batch_per_epoch": true, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "log_std_clip_param": 20.0, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "_disable_preprocessor_api": false, "_disable_action_flattening": false}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "_learner_class": null, "callbacks_on_algorithm_init": null, "callbacks_on_env_runners_recreated": null, "callbacks_on_offline_eval_runners_recreated": null, "callbacks_on_checkpoint_loaded": null, "callbacks_on_environment_created": null, "callbacks_on_episode_created": null, "callbacks_on_episode_start": null, "callbacks_on_episode_step": null, "callbacks_on_episode_end": null, "callbacks_on_evaluate_start": null, "callbacks_on_evaluate_end": null, "callbacks_on_evaluate_offline_start": null, "callbacks_on_evaluate_offline_end": null, "callbacks_on_sample_end": null, "callbacks_on_train_result": null, "explore": true, "enable_rl_module_and_learner": true, "enable_env_runner_and_connector_v2": true, "_prior_exploration_config": {"type": "StochasticSampling"}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x73ae51472ac0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "offline_data_class": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_read_batch_size": null, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "materialize_data": false, "materialize_mapped_data": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "ignore_final_observation": false, "prelearner_class": null, "prelearner_buffer_class": null, "prelearner_buffer_kwargs": {}, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_remaining_data": false, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": 1, "evaluation_duration": 20, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_auto_duration_min_env_steps_per_sample": 100, "evaluation_auto_duration_max_env_steps_per_sample": 2000, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 1, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "offline_evaluation_interval": null, "num_offline_eval_runners": 0, "offline_loss_for_module_fn": null, "offline_evaluation_duration": 1, "offline_evaluation_parallel_to_training": false, "offline_evaluation_timeout_s": 120.0, "num_cpus_per_offline_eval_runner": 1, "num_gpus_per_offline_eval_runner": 0, "custom_resources_per_offline_eval_runner": {}, "restart_failed_offline_eval_runners": true, "ignore_offline_eval_runner_failures": false, "max_num_offline_eval_runner_restarts": 1000, "offline_eval_runner_restore_timeout_s": 1800.0, "max_requests_in_flight_per_offline_eval_runner": 1, "validate_offline_eval_runners_after_construction": true, "offline_eval_runner_health_probe_timeout_s": 30.0, "offline_eval_rl_module_inference_only": false, "broadcast_offline_eval_runner_states": false, "offline_eval_batch_size_per_runner": 256, "dataset_num_iters_per_eval_runner": 1, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "log_gradients": true, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 42, "restart_failed_env_runners": true, "ignore_env_runner_failures": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30.0, "env_runner_restore_timeout_s": 1800.0, "_model_config": {}, "_rl_module_spec": "RLModuleSpec(module_class=None, observation_space=None, action_space=None, inference_only=False, learner_only=False, model_config=DefaultModelConfig(fcnet_hiddens=[61, 84], fcnet_activation='tanh', fcnet_kernel_initializer=None, fcnet_kernel_initializer_kwargs=None, fcnet_bias_initializer=None, fcnet_bias_initializer_kwargs=None, conv_filters=None, conv_activation='relu', conv_kernel_initializer=None, conv_kernel_initializer_kwargs=None, conv_bias_initializer=None, conv_bias_initializer_kwargs=None, head_fcnet_hiddens=[], head_fcnet_activation='relu', head_fcnet_kernel_initializer=None, head_fcnet_kernel_initializer_kwargs=None, head_fcnet_bias_initializer=None, head_fcnet_bias_initializer_kwargs=None, free_log_std=False, log_std_clip_param=20.0, vf_share_layers=True, use_lstm=False, max_seq_len=20, lstm_cell_size=256, lstm_use_prev_action=False, lstm_use_prev_reward=False, lstm_kernel_initializer=None, lstm_kernel_initializer_kwargs=None, lstm_bias_initializer=None, lstm_bias_initializer_kwargs=None), catalog_class=None, load_state_path=None, model_config_dict=None)", "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "_validate_config": true, "_use_msgpack_checkpoints": false, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "env_task_fn": -1, "enable_connectors": -1, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.7771983355204, "kl_target": 0.026982802658, "vf_loss_coeff": 0.6688075857018, "entropy_coeff": 0.0090570820258, "clip_param": 0.1202945497339, "vf_clip_param": 0.1020987445302, "entropy_coeff_schedule": null, "lr_schedule": null, "sgd_minibatch_size": -1, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9064845981162, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.callbacks.callbacks.RLlibCallback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 60.139187812805176, "iterations_since_restore": 12, "perf": {"cpu_util_percent": 12.6125, "ram_util_percent": 78.6875}}
{"timers": {"training_iteration": 4.385453392585373, "restore_env_runners": 1.4200731671342716e-05, "training_step": 4.385229030898786, "env_runner_sampling_timer": 3.9300102780482673, "learner_update_timer": 0.45151268122242594, "synch_weights": 0.001704119143184738, "restore_eval_env_runners": 1.2745669331559029e-05, "evaluation_iteration": 0.7480562675615755, "synch_eval_env_connectors": 0.0004232593777144177, "synch_env_connectors": 7.832338904894366e-06}, "env_runners": {"weights_seq_no": 12.0, "module_to_env_connector": {"timers": {"connectors": {"get_actions": 0.00016810813136983562, "tensor_to_numpy": 5.065188210063207e-05, "listify_data_for_vector_env": 3.159697332157053e-05, "un_batch_to_individual_items": 1.517839938938654e-05, "normalize_and_clip_actions": 2.256507586663387e-05, "remove_single_ts_time_rank_from_batch": 1.6066463019621434e-06}}, "connector_pipeline_timer": 0.0003669644350865469}, "env_reset_timer": 9.481662745993015e-05, "rlmodule_inference_timer": 0.00010194414789666829, "env_step_timer": 4.3036233030881076e-05, "env_to_module_connector": {"timers": {"connectors": {"batch_individual_items": 1.8849622491047778e-05, "add_observations_from_episodes_to_batch": 6.534486941810085e-06, "numpy_to_tensor": 3.1940760320760354e-05, "add_states_from_episodes_to_batch": 3.4051702385789723e-06, "add_time_dim_to_batch_and_zero_pad": 6.216076095067659e-06}}, "connector_pipeline_timer": 0.00012027501436440907}, "num_episodes": 100.0, "episode_len_min": 50, "episode_duration_sec_mean": 0.03695207302007475, "num_module_steps_sampled": {"default_policy": 5000.0}, "num_episodes_lifetime": -53150.0, "episode_return_max": 14.5, "episode_return_min": -5.5, "num_env_steps_sampled": 5000.0, "episode_return_mean": 10.1, "num_env_steps_sampled_lifetime": -2657500.0, "time_between_sampling": 0.012738234623078491, "num_agent_steps_sampled": {"default_agent": 5000.0}, "episode_len_max": 50, "num_agent_steps_sampled_lifetime": {"default_agent": -2657500.0}, "env_to_module_sum_episodes_length_in": 27.16809333212661, "module_episode_returns_mean": {"default_policy": 10.1}, "sample": 0.03795870429576841, "num_module_steps_sampled_lifetime": {"default_policy": -2657500.0}, "agent_episode_returns_mean": {"default_agent": 10.1}, "env_to_module_sum_episodes_length_out": 27.16809333212661, "episode_len_mean": 50.0, "num_env_steps_sampled_lifetime_throughput": 1265.2438779189993}, "learners": {"default_policy": {"vf_loss_unclipped": 9.039670944213867, "mean_kl_loss": 0.0011938080424442887, "num_module_steps_trained": 16000, "diff_num_grad_updates_vs_sampler_policy": 1.0, "vf_explained_var": 0.4246644973754883, "entropy": 0.6266493201255798, "num_trainable_parameters": 5707, "vf_loss": 0.09157971292734146, "default_optimizer_learning_rate": 0.0003313639719, "curr_kl_coeff": 9.487284114584327e-05, "num_module_steps_trained_lifetime": 208000, "total_loss": 0.1035725474357605, "gradients_default_optimizer_global_norm": 0.07288066297769547, "module_train_batch_size_mean": 1000.0, "weights_seq_no": 13.0, "curr_entropy_coeff": 0.0090570820258, "policy_loss": 0.047998737543821335, "num_module_steps_trained_lifetime_throughput": 191666.6612390115}, "__all_modules__": {"num_module_steps_trained_lifetime": 208000, "learner_connector": {"timers": {"connectors": {"general_advantage_estimation": 0.012103159964981302, "add_time_dim_to_batch_and_zero_pad": 2.3612144102853548e-05, "batch_individual_items": 0.20226630223933648, "numpy_to_tensor": 0.00023755537516622393, "add_states_from_episodes_to_batch": 6.22288198245309e-06, "add_one_ts_to_episodes_and_truncate": 0.00893600391063717, "add_columns_from_episodes_to_train_batch": 0.07253746176317935, "add_observations_from_episodes_to_batch": 0.0008345890874099438}}, "connector_pipeline_timer": 0.29738169237451983}, "num_trainable_parameters": 5707, "learner_connector_sum_episodes_length_out": 5100.0, "num_env_steps_trained_lifetime": 1060800, "num_env_steps_trained": 81600, "learner_connector_sum_episodes_length_in": 5000.0, "num_non_trainable_parameters": 0, "num_module_steps_trained": 16000, "num_env_steps_trained_lifetime_throughput": 976440.3280294647, "num_module_steps_trained_throughput": 191827.02125658587, "num_module_steps_trained_lifetime_throughput": 191798.60456279982}}, "num_training_step_calls_per_iteration": 1, "evaluation": {"env_runners": {"module_to_env_connector": {"timers": {"connectors": {"tensor_to_numpy": 4.487606909763444e-05, "get_actions": 0.0001560971289334913, "listify_data_for_vector_env": 3.121891831379928e-05, "normalize_and_clip_actions": 2.2143331621477818e-05, "un_batch_to_individual_items": 1.5575072015087333e-05, "remove_single_ts_time_rank_from_batch": 1.3759325973578515e-06}}, "connector_pipeline_timer": 0.0003434715283654385}, "env_to_module_sum_episodes_length_in": 27.168093332126602, "sample": 0.7366692480255841, "env_step_timer": 4.2174244118073276e-05, "episode_len_min": 50, "env_to_module_connector": {"timers": {"connectors": {"add_time_dim_to_batch_and_zero_pad": 5.660992283654173e-06, "batch_individual_items": 1.8605498947589125e-05, "numpy_to_tensor": 2.931009914431335e-05, "add_states_from_episodes_to_batch": 3.296244404639301e-06, "add_observations_from_episodes_to_batch": 6.0410556821862876e-06}}, "connector_pipeline_timer": 0.00011134739653966245}, "agent_episode_returns_mean": {"default_agent": -0.1}, "episode_return_min": -16.5, "num_agent_steps_sampled_lifetime": {"default_agent": 13000}, "env_to_module_sum_episodes_length_out": 27.168093332126602, "num_module_steps_sampled": {"default_policy": 1000}, "episode_len_mean": 50.0, "weights_seq_no": 13.0, "num_agent_steps_sampled": {"default_agent": 1000}, "num_episodes_lifetime": 260, "episode_return_max": 17.5, "module_episode_returns_mean": {"default_policy": -0.1}, "episode_return_mean": -0.1, "num_module_steps_sampled_lifetime": {"default_policy": 13000}, "env_reset_timer": 0.0002358443925721034, "rlmodule_inference_timer": 9.621545892198333e-05, "num_episodes": 20, "episode_duration_sec_mean": 0.03510445100996549, "num_env_steps_sampled_lifetime": 66000, "num_env_steps_sampled": 1000, "episode_len_max": 50, "time_between_sampling": 4.248789474012233}, "num_healthy_workers": 1, "actor_manager_num_outstanding_async_reqs": 0, "num_remote_worker_restarts": 0}, "num_env_steps_sampled_lifetime": -2657500.0, "fault_tolerance": {"num_healthy_workers": 0, "num_remote_worker_restarts": 0}, "env_runner_group": {"actor_manager_num_outstanding_async_reqs": 0}, "done": false, "training_iteration": 13, "trial_id": "aef7a_00000", "date": "2025-08-11_17-14-53", "timestamp": 1754925293, "time_this_iter_s": 4.940848350524902, "time_total_s": 65.08003616333008, "pid": 66454, "hostname": "DESKTOP-3SK5A41", "node_ip": "192.168.40.242", "config": {"exploration_config": {}, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 6, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "env": "Umbrella", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": false, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 0, "create_local_env_runner": true, "num_envs_per_env_runner": 1, "gym_env_vectorize_mode": "SYNC", "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "episodes_to_numpy": true, "max_requests_in_flight_per_env_runner": 1, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "merge_env_runner_states": "training_only", "broadcast_env_runner_states": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "complete_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "sampler_perf_stats_ema_coef": null, "_is_online": true, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": "auto", "num_aggregator_actors_per_learner": 0, "max_requests_in_flight_per_aggregator_actor": 3, "local_gpu_idx": 0, "max_requests_in_flight_per_learner": 3, "gamma": 1, "lr": 0.0003313639719, "grad_clip": 0.5, "grad_clip_by": "global_norm", "_train_batch_size_per_learner": 5000, "train_batch_size": 4000, "num_epochs": 3, "minibatch_size": 1000, "shuffle_batch_per_epoch": true, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "log_std_clip_param": 20.0, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "_disable_preprocessor_api": false, "_disable_action_flattening": false}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "_learner_class": null, "callbacks_on_algorithm_init": null, "callbacks_on_env_runners_recreated": null, "callbacks_on_offline_eval_runners_recreated": null, "callbacks_on_checkpoint_loaded": null, "callbacks_on_environment_created": null, "callbacks_on_episode_created": null, "callbacks_on_episode_start": null, "callbacks_on_episode_step": null, "callbacks_on_episode_end": null, "callbacks_on_evaluate_start": null, "callbacks_on_evaluate_end": null, "callbacks_on_evaluate_offline_start": null, "callbacks_on_evaluate_offline_end": null, "callbacks_on_sample_end": null, "callbacks_on_train_result": null, "explore": true, "enable_rl_module_and_learner": true, "enable_env_runner_and_connector_v2": true, "_prior_exploration_config": {"type": "StochasticSampling"}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x73ae51472ac0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "offline_data_class": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_read_batch_size": null, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "materialize_data": false, "materialize_mapped_data": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "ignore_final_observation": false, "prelearner_class": null, "prelearner_buffer_class": null, "prelearner_buffer_kwargs": {}, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_remaining_data": false, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": 1, "evaluation_duration": 20, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_auto_duration_min_env_steps_per_sample": 100, "evaluation_auto_duration_max_env_steps_per_sample": 2000, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 1, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "offline_evaluation_interval": null, "num_offline_eval_runners": 0, "offline_loss_for_module_fn": null, "offline_evaluation_duration": 1, "offline_evaluation_parallel_to_training": false, "offline_evaluation_timeout_s": 120.0, "num_cpus_per_offline_eval_runner": 1, "num_gpus_per_offline_eval_runner": 0, "custom_resources_per_offline_eval_runner": {}, "restart_failed_offline_eval_runners": true, "ignore_offline_eval_runner_failures": false, "max_num_offline_eval_runner_restarts": 1000, "offline_eval_runner_restore_timeout_s": 1800.0, "max_requests_in_flight_per_offline_eval_runner": 1, "validate_offline_eval_runners_after_construction": true, "offline_eval_runner_health_probe_timeout_s": 30.0, "offline_eval_rl_module_inference_only": false, "broadcast_offline_eval_runner_states": false, "offline_eval_batch_size_per_runner": 256, "dataset_num_iters_per_eval_runner": 1, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "log_gradients": true, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 42, "restart_failed_env_runners": true, "ignore_env_runner_failures": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30.0, "env_runner_restore_timeout_s": 1800.0, "_model_config": {}, "_rl_module_spec": "RLModuleSpec(module_class=None, observation_space=None, action_space=None, inference_only=False, learner_only=False, model_config=DefaultModelConfig(fcnet_hiddens=[61, 84], fcnet_activation='tanh', fcnet_kernel_initializer=None, fcnet_kernel_initializer_kwargs=None, fcnet_bias_initializer=None, fcnet_bias_initializer_kwargs=None, conv_filters=None, conv_activation='relu', conv_kernel_initializer=None, conv_kernel_initializer_kwargs=None, conv_bias_initializer=None, conv_bias_initializer_kwargs=None, head_fcnet_hiddens=[], head_fcnet_activation='relu', head_fcnet_kernel_initializer=None, head_fcnet_kernel_initializer_kwargs=None, head_fcnet_bias_initializer=None, head_fcnet_bias_initializer_kwargs=None, free_log_std=False, log_std_clip_param=20.0, vf_share_layers=True, use_lstm=False, max_seq_len=20, lstm_cell_size=256, lstm_use_prev_action=False, lstm_use_prev_reward=False, lstm_kernel_initializer=None, lstm_kernel_initializer_kwargs=None, lstm_bias_initializer=None, lstm_bias_initializer_kwargs=None), catalog_class=None, load_state_path=None, model_config_dict=None)", "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "_validate_config": true, "_use_msgpack_checkpoints": false, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "env_task_fn": -1, "enable_connectors": -1, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.7771983355204, "kl_target": 0.026982802658, "vf_loss_coeff": 0.6688075857018, "entropy_coeff": 0.0090570820258, "clip_param": 0.1202945497339, "vf_clip_param": 0.1020987445302, "entropy_coeff_schedule": null, "lr_schedule": null, "sgd_minibatch_size": -1, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9064845981162, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.callbacks.callbacks.RLlibCallback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 65.08003616333008, "iterations_since_restore": 13, "perf": {"cpu_util_percent": 13.071428571428571, "ram_util_percent": 78.60000000000001}}
{"timers": {"training_iteration": 4.384583275679526, "restore_env_runners": 1.4161724347661715e-05, "training_step": 4.384357229609799, "env_runner_sampling_timer": 3.931257552287787, "learner_update_timer": 0.4493944374102029, "synch_weights": 0.001700551951750477, "restore_eval_env_runners": 1.2716212638678134e-05, "evaluation_iteration": 0.7479636698959622, "synch_eval_env_connectors": 0.00042334478392932746, "synch_env_connectors": 7.814015508872727e-06}, "env_runners": {"weights_seq_no": 13.0, "module_to_env_connector": {"timers": {"connectors": {"get_actions": 0.00016680942064603512, "tensor_to_numpy": 5.006320905317087e-05, "listify_data_for_vector_env": 3.13719035054946e-05, "un_batch_to_individual_items": 1.4939399213569385e-05, "normalize_and_clip_actions": 2.2279840663994154e-05, "remove_single_ts_time_rank_from_batch": 1.561579196244862e-06}}, "connector_pipeline_timer": 0.00036382318233440944}, "env_reset_timer": 9.521687869800291e-05, "rlmodule_inference_timer": 0.00010892163639645158, "env_step_timer": 4.267443179083293e-05, "env_to_module_connector": {"timers": {"connectors": {"batch_individual_items": 1.8713588087321637e-05, "add_observations_from_episodes_to_batch": 6.469307224887538e-06, "numpy_to_tensor": 3.1506763726920985e-05, "add_states_from_episodes_to_batch": 3.38590994428916e-06, "add_time_dim_to_batch_and_zero_pad": 6.154889255594524e-06}}, "connector_pipeline_timer": 0.00011925197955245746}, "num_episodes": 100.0, "episode_len_min": 50, "episode_duration_sec_mean": 0.038011891020023544, "num_module_steps_sampled": {"default_policy": 5000.0}, "num_episodes_lifetime": -58000.0, "episode_return_max": 14.5, "episode_return_min": -5.5, "num_env_steps_sampled": 5000.0, "episode_return_mean": 9.5, "num_env_steps_sampled_lifetime": -2900000.0, "time_between_sampling": 0.01210645825875471, "num_agent_steps_sampled": {"default_agent": 5000.0}, "episode_len_max": 50, "num_agent_steps_sampled_lifetime": {"default_agent": -2900000.0}, "env_to_module_sum_episodes_length_in": 27.16809333212661, "module_episode_returns_mean": {"default_policy": 9.5}, "sample": 0.037894406236408364, "num_module_steps_sampled_lifetime": {"default_policy": -2900000.0}, "agent_episode_returns_mean": {"default_agent": 9.5}, "env_to_module_sum_episodes_length_out": 27.16809333212661, "episode_len_mean": 50.0, "num_env_steps_sampled_lifetime_throughput": 1274.6408135045458}, "learners": {"default_policy": {"vf_loss_unclipped": 10.897886276245117, "mean_kl_loss": 0.0044837454333901405, "num_module_steps_trained": 16000, "diff_num_grad_updates_vs_sampler_policy": 1.0, "vf_explained_var": 0.4164241552352905, "entropy": 0.5997564196586609, "num_trainable_parameters": 5707, "vf_loss": 0.0914408266544342, "default_optimizer_learning_rate": 0.0003313639719, "curr_kl_coeff": 4.7436420572921634e-05, "num_module_steps_trained_lifetime": 224000, "total_loss": -0.008559627458453178, "gradients_default_optimizer_global_norm": 0.19947195053100586, "module_train_batch_size_mean": 1000.0, "weights_seq_no": 14.0, "curr_entropy_coeff": 0.0090570820258, "policy_loss": -0.06428434699773788, "num_module_steps_trained_lifetime_throughput": 190713.98430386643}, "__all_modules__": {"num_module_steps_trained_lifetime": 224000, "learner_connector": {"timers": {"connectors": {"general_advantage_estimation": 0.012069888365337289, "add_time_dim_to_batch_and_zero_pad": 2.355702265761637e-05, "batch_individual_items": 0.20083648021694098, "numpy_to_tensor": 0.00023699782141520126, "add_states_from_episodes_to_batch": 6.216653161577678e-06, "add_one_ts_to_episodes_and_truncate": 0.00893109287152711, "add_columns_from_episodes_to_train_batch": 0.07249792714554401, "add_observations_from_episodes_to_batch": 0.0008332801965316065}}, "connector_pipeline_timer": 0.29587072945077586}, "num_trainable_parameters": 5707, "learner_connector_sum_episodes_length_out": 5100.0, "num_env_steps_trained_lifetime": 1142400, "num_env_steps_trained": 81600, "learner_connector_sum_episodes_length_in": 5000.0, "num_non_trainable_parameters": 0, "num_module_steps_trained": 16000, "num_env_steps_trained_lifetime_throughput": 971644.4223165733, "num_module_steps_trained_throughput": 190871.09926139086, "num_module_steps_trained_lifetime_throughput": 190843.45937725934}}, "num_training_step_calls_per_iteration": 1, "evaluation": {"env_runners": {"module_to_env_connector": {"timers": {"connectors": {"tensor_to_numpy": 4.485506811329266e-05, "get_actions": 0.00015479435701934509, "listify_data_for_vector_env": 3.091534342799088e-05, "normalize_and_clip_actions": 2.1972418668520228e-05, "un_batch_to_individual_items": 1.589635621361381e-05, "remove_single_ts_time_rank_from_batch": 1.3712482744036219e-06}}, "connector_pipeline_timer": 0.0003431200824329415}, "env_to_module_sum_episodes_length_in": 27.168093332126602, "sample": 0.7366576055453247, "env_step_timer": 4.208435346396611e-05, "episode_len_min": 50, "env_to_module_connector": {"timers": {"connectors": {"add_time_dim_to_batch_and_zero_pad": 5.705034515371634e-06, "batch_individual_items": 1.8382727036697618e-05, "numpy_to_tensor": 3.0359382018048595e-05, "add_states_from_episodes_to_batch": 3.4726824933641222e-06, "add_observations_from_episodes_to_batch": 6.059722518860798e-06}}, "connector_pipeline_timer": 0.00011260952349530016}, "agent_episode_returns_mean": {"default_agent": -0.5}, "episode_return_min": -16.5, "num_agent_steps_sampled_lifetime": {"default_agent": 14000}, "env_to_module_sum_episodes_length_out": 27.168093332126602, "num_module_steps_sampled": {"default_policy": 1000}, "episode_len_mean": 50.0, "weights_seq_no": 14.0, "num_agent_steps_sampled": {"default_agent": 1000}, "num_episodes_lifetime": 280, "episode_return_max": 17.5, "module_episode_returns_mean": {"default_policy": -0.5}, "episode_return_mean": -0.5, "num_module_steps_sampled_lifetime": {"default_policy": 14000}, "env_reset_timer": 0.00023475794864589935, "rlmodule_inference_timer": 9.553833036724004e-05, "num_episodes": 20, "episode_duration_sec_mean": 0.03517736800999046, "num_env_steps_sampled_lifetime": 71000, "num_env_steps_sampled": 1000, "episode_len_max": 50, "time_between_sampling": 4.249823091292108}, "num_healthy_workers": 1, "actor_manager_num_outstanding_async_reqs": 0, "num_remote_worker_restarts": 0}, "num_env_steps_sampled_lifetime": -2900000.0, "fault_tolerance": {"num_healthy_workers": 0, "num_remote_worker_restarts": 0}, "env_runner_group": {"actor_manager_num_outstanding_async_reqs": 0}, "done": false, "training_iteration": 14, "trial_id": "aef7a_00000", "date": "2025-08-11_17-14-58", "timestamp": 1754925298, "time_this_iter_s": 5.048707723617554, "time_total_s": 70.12874388694763, "pid": 66454, "hostname": "DESKTOP-3SK5A41", "node_ip": "192.168.40.242", "config": {"exploration_config": {}, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 6, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "env": "Umbrella", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": false, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 0, "create_local_env_runner": true, "num_envs_per_env_runner": 1, "gym_env_vectorize_mode": "SYNC", "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "episodes_to_numpy": true, "max_requests_in_flight_per_env_runner": 1, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "merge_env_runner_states": "training_only", "broadcast_env_runner_states": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "complete_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "sampler_perf_stats_ema_coef": null, "_is_online": true, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": "auto", "num_aggregator_actors_per_learner": 0, "max_requests_in_flight_per_aggregator_actor": 3, "local_gpu_idx": 0, "max_requests_in_flight_per_learner": 3, "gamma": 1, "lr": 0.0003313639719, "grad_clip": 0.5, "grad_clip_by": "global_norm", "_train_batch_size_per_learner": 5000, "train_batch_size": 4000, "num_epochs": 3, "minibatch_size": 1000, "shuffle_batch_per_epoch": true, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "log_std_clip_param": 20.0, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "_disable_preprocessor_api": false, "_disable_action_flattening": false}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "_learner_class": null, "callbacks_on_algorithm_init": null, "callbacks_on_env_runners_recreated": null, "callbacks_on_offline_eval_runners_recreated": null, "callbacks_on_checkpoint_loaded": null, "callbacks_on_environment_created": null, "callbacks_on_episode_created": null, "callbacks_on_episode_start": null, "callbacks_on_episode_step": null, "callbacks_on_episode_end": null, "callbacks_on_evaluate_start": null, "callbacks_on_evaluate_end": null, "callbacks_on_evaluate_offline_start": null, "callbacks_on_evaluate_offline_end": null, "callbacks_on_sample_end": null, "callbacks_on_train_result": null, "explore": true, "enable_rl_module_and_learner": true, "enable_env_runner_and_connector_v2": true, "_prior_exploration_config": {"type": "StochasticSampling"}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x73ae51472ac0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "offline_data_class": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_read_batch_size": null, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "materialize_data": false, "materialize_mapped_data": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "ignore_final_observation": false, "prelearner_class": null, "prelearner_buffer_class": null, "prelearner_buffer_kwargs": {}, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_remaining_data": false, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": 1, "evaluation_duration": 20, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_auto_duration_min_env_steps_per_sample": 100, "evaluation_auto_duration_max_env_steps_per_sample": 2000, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 1, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "offline_evaluation_interval": null, "num_offline_eval_runners": 0, "offline_loss_for_module_fn": null, "offline_evaluation_duration": 1, "offline_evaluation_parallel_to_training": false, "offline_evaluation_timeout_s": 120.0, "num_cpus_per_offline_eval_runner": 1, "num_gpus_per_offline_eval_runner": 0, "custom_resources_per_offline_eval_runner": {}, "restart_failed_offline_eval_runners": true, "ignore_offline_eval_runner_failures": false, "max_num_offline_eval_runner_restarts": 1000, "offline_eval_runner_restore_timeout_s": 1800.0, "max_requests_in_flight_per_offline_eval_runner": 1, "validate_offline_eval_runners_after_construction": true, "offline_eval_runner_health_probe_timeout_s": 30.0, "offline_eval_rl_module_inference_only": false, "broadcast_offline_eval_runner_states": false, "offline_eval_batch_size_per_runner": 256, "dataset_num_iters_per_eval_runner": 1, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "log_gradients": true, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 42, "restart_failed_env_runners": true, "ignore_env_runner_failures": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30.0, "env_runner_restore_timeout_s": 1800.0, "_model_config": {}, "_rl_module_spec": "RLModuleSpec(module_class=None, observation_space=None, action_space=None, inference_only=False, learner_only=False, model_config=DefaultModelConfig(fcnet_hiddens=[61, 84], fcnet_activation='tanh', fcnet_kernel_initializer=None, fcnet_kernel_initializer_kwargs=None, fcnet_bias_initializer=None, fcnet_bias_initializer_kwargs=None, conv_filters=None, conv_activation='relu', conv_kernel_initializer=None, conv_kernel_initializer_kwargs=None, conv_bias_initializer=None, conv_bias_initializer_kwargs=None, head_fcnet_hiddens=[], head_fcnet_activation='relu', head_fcnet_kernel_initializer=None, head_fcnet_kernel_initializer_kwargs=None, head_fcnet_bias_initializer=None, head_fcnet_bias_initializer_kwargs=None, free_log_std=False, log_std_clip_param=20.0, vf_share_layers=True, use_lstm=False, max_seq_len=20, lstm_cell_size=256, lstm_use_prev_action=False, lstm_use_prev_reward=False, lstm_kernel_initializer=None, lstm_kernel_initializer_kwargs=None, lstm_bias_initializer=None, lstm_bias_initializer_kwargs=None), catalog_class=None, load_state_path=None, model_config_dict=None)", "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "_validate_config": true, "_use_msgpack_checkpoints": false, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "env_task_fn": -1, "enable_connectors": -1, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.7771983355204, "kl_target": 0.026982802658, "vf_loss_coeff": 0.6688075857018, "entropy_coeff": 0.0090570820258, "clip_param": 0.1202945497339, "vf_clip_param": 0.1020987445302, "entropy_coeff_schedule": null, "lr_schedule": null, "sgd_minibatch_size": -1, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9064845981162, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.callbacks.callbacks.RLlibCallback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 70.12874388694763, "iterations_since_restore": 14, "perf": {"cpu_util_percent": 12.62857142857143, "ram_util_percent": 78.67142857142858}}
{"timers": {"training_iteration": 4.382930700922738, "restore_env_runners": 1.4129107097429749e-05, "training_step": 4.382703093313709, "env_runner_sampling_timer": 3.931706655764912, "learner_update_timer": 0.447291574036097, "synch_weights": 0.0016980564322338547, "restore_eval_env_runners": 1.2694050520552767e-05, "evaluation_iteration": 0.7479360431970089, "synch_eval_env_connectors": 0.00042260833608791264, "synch_env_connectors": 7.796875354425798e-06}, "env_runners": {"weights_seq_no": 14.0, "module_to_env_connector": {"timers": {"connectors": {"get_actions": 0.00016876202120331822, "tensor_to_numpy": 5.085735618793429e-05, "listify_data_for_vector_env": 3.163769732462606e-05, "un_batch_to_individual_items": 1.5217104387792886e-05, "normalize_and_clip_actions": 2.2520573013616436e-05, "remove_single_ts_time_rank_from_batch": 1.5925058295489022e-06}}, "connector_pipeline_timer": 0.0003682610133395015}, "env_reset_timer": 9.404864469577291e-05, "rlmodule_inference_timer": 0.00011558228870028405, "env_step_timer": 4.331419465016399e-05, "env_to_module_connector": {"timers": {"connectors": {"batch_individual_items": 1.9039450650802206e-05, "add_observations_from_episodes_to_batch": 6.598388676499558e-06, "numpy_to_tensor": 3.210228303114629e-05, "add_states_from_episodes_to_batch": 3.445192924673388e-06, "add_time_dim_to_batch_and_zero_pad": 6.240220757108769e-06}}, "connector_pipeline_timer": 0.00012111414977637467}, "num_episodes": 100.0, "episode_len_min": 50, "episode_duration_sec_mean": 0.037152760999961176, "num_module_steps_sampled": {"default_policy": 5000.0}, "num_episodes_lifetime": -62850.0, "episode_return_max": 14.5, "episode_return_min": -5.5, "num_env_steps_sampled": 5000.0, "episode_return_mean": 9.1, "num_env_steps_sampled_lifetime": -3142500.0, "time_between_sampling": 0.011888976308161752, "num_agent_steps_sampled": {"default_agent": 5000.0}, "episode_len_max": 50, "num_agent_steps_sampled_lifetime": {"default_agent": -3142500.0}, "env_to_module_sum_episodes_length_in": 27.16809333212661, "module_episode_returns_mean": {"default_policy": 9.1}, "sample": 0.038711149174896535, "num_module_steps_sampled_lifetime": {"default_policy": -3142500.0}, "agent_episode_returns_mean": {"default_agent": 9.1}, "env_to_module_sum_episodes_length_out": 27.16809333212661, "episode_len_mean": 50.0, "num_env_steps_sampled_lifetime_throughput": 1259.6848803790963}, "learners": {"default_policy": {"vf_loss_unclipped": 9.180058479309082, "mean_kl_loss": 0.0018925897311419249, "num_module_steps_trained": 16000, "diff_num_grad_updates_vs_sampler_policy": 1.0, "vf_explained_var": 0.47930407524108887, "entropy": 0.5783621668815613, "num_trainable_parameters": 5707, "vf_loss": 0.09102866053581238, "default_optimizer_learning_rate": 0.0003313639719, "curr_kl_coeff": 2.3718210286460817e-05, "num_module_steps_trained_lifetime": 240000, "total_loss": -0.0004434983420651406, "gradients_default_optimizer_global_norm": 0.06676135212182999, "module_train_batch_size_mean": 1000.0, "weights_seq_no": 15.0, "curr_entropy_coeff": 0.0090570820258, "policy_loss": -0.056085966527462006, "num_module_steps_trained_lifetime_throughput": 190343.45557355002}, "__all_modules__": {"num_module_steps_trained_lifetime": 240000, "learner_connector": {"timers": {"connectors": {"general_advantage_estimation": 0.012036264481676098, "add_time_dim_to_batch_and_zero_pad": 2.3646452431924963e-05, "batch_individual_items": 0.19945465341476837, "numpy_to_tensor": 0.0002363808431978739, "add_states_from_episodes_to_batch": 6.262486624687007e-06, "add_one_ts_to_episodes_and_truncate": 0.008932165942807376, "add_columns_from_episodes_to_train_batch": 0.07249942587409453, "add_observations_from_episodes_to_batch": 0.0008329853945716896}}, "connector_pipeline_timer": 0.2944568101562692}, "num_trainable_parameters": 5707, "learner_connector_sum_episodes_length_out": 5100.0, "num_env_steps_trained_lifetime": 1224000, "num_env_steps_trained": 81600, "learner_connector_sum_episodes_length_in": 5000.0, "num_non_trainable_parameters": 0, "num_module_steps_trained": 16000, "num_env_steps_trained_lifetime_throughput": 969807.7126460304, "num_module_steps_trained_throughput": 190497.6364054459, "num_module_steps_trained_lifetime_throughput": 190470.1433211254}}, "num_training_step_calls_per_iteration": 1, "evaluation": {"env_runners": {"module_to_env_connector": {"timers": {"connectors": {"tensor_to_numpy": 4.531266025934847e-05, "get_actions": 0.0001550771219784281, "listify_data_for_vector_env": 3.083257880714136e-05, "normalize_and_clip_actions": 2.1823403619031166e-05, "un_batch_to_individual_items": 1.5773120761185885e-05, "remove_single_ts_time_rank_from_batch": 1.3825888961604542e-06}}, "connector_pipeline_timer": 0.00034201395095976857}, "env_to_module_sum_episodes_length_in": 27.168093332126602, "sample": 0.7365619444898706, "env_step_timer": 4.185825793146568e-05, "episode_len_min": 50, "env_to_module_connector": {"timers": {"connectors": {"add_time_dim_to_batch_and_zero_pad": 5.60663357154065e-06, "batch_individual_items": 1.7989333964518973e-05, "numpy_to_tensor": 2.972096966730993e-05, "add_states_from_episodes_to_batch": 3.2341092293779156e-06, "add_observations_from_episodes_to_batch": 6.115402213059221e-06}}, "connector_pipeline_timer": 0.00011158076568165779}, "agent_episode_returns_mean": {"default_agent": -0.7}, "episode_return_min": -16.5, "num_agent_steps_sampled_lifetime": {"default_agent": 15000}, "env_to_module_sum_episodes_length_out": 27.168093332126602, "num_module_steps_sampled": {"default_policy": 1000}, "episode_len_mean": 50.0, "weights_seq_no": 15.0, "num_agent_steps_sampled": {"default_agent": 1000}, "num_episodes_lifetime": 300, "episode_return_max": 17.5, "module_episode_returns_mean": {"default_policy": -0.7}, "episode_return_mean": -0.7, "num_module_steps_sampled_lifetime": {"default_policy": 15000}, "env_reset_timer": 0.00023364136915599132, "rlmodule_inference_timer": 9.61147239714916e-05, "num_episodes": 20, "episode_duration_sec_mean": 0.03506654101001004, "num_env_steps_sampled_lifetime": 76000, "num_env_steps_sampled": 1000, "episode_len_max": 50, "time_between_sampling": 4.25003456237918}, "num_healthy_workers": 1, "actor_manager_num_outstanding_async_reqs": 0, "num_remote_worker_restarts": 0}, "num_env_steps_sampled_lifetime": -3142500.0, "fault_tolerance": {"num_healthy_workers": 0, "num_remote_worker_restarts": 0}, "env_runner_group": {"actor_manager_num_outstanding_async_reqs": 0}, "done": false, "training_iteration": 15, "trial_id": "aef7a_00000", "date": "2025-08-11_17-15-03", "timestamp": 1754925303, "time_this_iter_s": 4.961021661758423, "time_total_s": 75.08976554870605, "pid": 66454, "hostname": "DESKTOP-3SK5A41", "node_ip": "192.168.40.242", "config": {"exploration_config": {}, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 6, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "env": "Umbrella", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": false, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 0, "create_local_env_runner": true, "num_envs_per_env_runner": 1, "gym_env_vectorize_mode": "SYNC", "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "episodes_to_numpy": true, "max_requests_in_flight_per_env_runner": 1, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "merge_env_runner_states": "training_only", "broadcast_env_runner_states": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "complete_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "sampler_perf_stats_ema_coef": null, "_is_online": true, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": "auto", "num_aggregator_actors_per_learner": 0, "max_requests_in_flight_per_aggregator_actor": 3, "local_gpu_idx": 0, "max_requests_in_flight_per_learner": 3, "gamma": 1, "lr": 0.0003313639719, "grad_clip": 0.5, "grad_clip_by": "global_norm", "_train_batch_size_per_learner": 5000, "train_batch_size": 4000, "num_epochs": 3, "minibatch_size": 1000, "shuffle_batch_per_epoch": true, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "log_std_clip_param": 20.0, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "_disable_preprocessor_api": false, "_disable_action_flattening": false}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "_learner_class": null, "callbacks_on_algorithm_init": null, "callbacks_on_env_runners_recreated": null, "callbacks_on_offline_eval_runners_recreated": null, "callbacks_on_checkpoint_loaded": null, "callbacks_on_environment_created": null, "callbacks_on_episode_created": null, "callbacks_on_episode_start": null, "callbacks_on_episode_step": null, "callbacks_on_episode_end": null, "callbacks_on_evaluate_start": null, "callbacks_on_evaluate_end": null, "callbacks_on_evaluate_offline_start": null, "callbacks_on_evaluate_offline_end": null, "callbacks_on_sample_end": null, "callbacks_on_train_result": null, "explore": true, "enable_rl_module_and_learner": true, "enable_env_runner_and_connector_v2": true, "_prior_exploration_config": {"type": "StochasticSampling"}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x73ae51472ac0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "offline_data_class": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_read_batch_size": null, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "materialize_data": false, "materialize_mapped_data": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "ignore_final_observation": false, "prelearner_class": null, "prelearner_buffer_class": null, "prelearner_buffer_kwargs": {}, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_remaining_data": false, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": 1, "evaluation_duration": 20, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_auto_duration_min_env_steps_per_sample": 100, "evaluation_auto_duration_max_env_steps_per_sample": 2000, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 1, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "offline_evaluation_interval": null, "num_offline_eval_runners": 0, "offline_loss_for_module_fn": null, "offline_evaluation_duration": 1, "offline_evaluation_parallel_to_training": false, "offline_evaluation_timeout_s": 120.0, "num_cpus_per_offline_eval_runner": 1, "num_gpus_per_offline_eval_runner": 0, "custom_resources_per_offline_eval_runner": {}, "restart_failed_offline_eval_runners": true, "ignore_offline_eval_runner_failures": false, "max_num_offline_eval_runner_restarts": 1000, "offline_eval_runner_restore_timeout_s": 1800.0, "max_requests_in_flight_per_offline_eval_runner": 1, "validate_offline_eval_runners_after_construction": true, "offline_eval_runner_health_probe_timeout_s": 30.0, "offline_eval_rl_module_inference_only": false, "broadcast_offline_eval_runner_states": false, "offline_eval_batch_size_per_runner": 256, "dataset_num_iters_per_eval_runner": 1, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "log_gradients": true, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 42, "restart_failed_env_runners": true, "ignore_env_runner_failures": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30.0, "env_runner_restore_timeout_s": 1800.0, "_model_config": {}, "_rl_module_spec": "RLModuleSpec(module_class=None, observation_space=None, action_space=None, inference_only=False, learner_only=False, model_config=DefaultModelConfig(fcnet_hiddens=[61, 84], fcnet_activation='tanh', fcnet_kernel_initializer=None, fcnet_kernel_initializer_kwargs=None, fcnet_bias_initializer=None, fcnet_bias_initializer_kwargs=None, conv_filters=None, conv_activation='relu', conv_kernel_initializer=None, conv_kernel_initializer_kwargs=None, conv_bias_initializer=None, conv_bias_initializer_kwargs=None, head_fcnet_hiddens=[], head_fcnet_activation='relu', head_fcnet_kernel_initializer=None, head_fcnet_kernel_initializer_kwargs=None, head_fcnet_bias_initializer=None, head_fcnet_bias_initializer_kwargs=None, free_log_std=False, log_std_clip_param=20.0, vf_share_layers=True, use_lstm=False, max_seq_len=20, lstm_cell_size=256, lstm_use_prev_action=False, lstm_use_prev_reward=False, lstm_kernel_initializer=None, lstm_kernel_initializer_kwargs=None, lstm_bias_initializer=None, lstm_bias_initializer_kwargs=None), catalog_class=None, load_state_path=None, model_config_dict=None)", "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "_validate_config": true, "_use_msgpack_checkpoints": false, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "env_task_fn": -1, "enable_connectors": -1, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.7771983355204, "kl_target": 0.026982802658, "vf_loss_coeff": 0.6688075857018, "entropy_coeff": 0.0090570820258, "clip_param": 0.1202945497339, "vf_clip_param": 0.1020987445302, "entropy_coeff_schedule": null, "lr_schedule": null, "sgd_minibatch_size": -1, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9064845981162, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.callbacks.callbacks.RLlibCallback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 75.08976554870605, "iterations_since_restore": 15, "perf": {"cpu_util_percent": 14.328571428571431, "ram_util_percent": 78.05714285714285}}
{"timers": {"training_iteration": 4.382285771933515, "restore_env_runners": 1.4092816025621919e-05, "training_step": 4.382057022400571, "env_runner_sampling_timer": 3.9331136402272597, "learner_update_timer": 0.4452404252957322, "synch_weights": 0.0016947668679061672, "restore_eval_env_runners": 1.2665110015781934e-05, "evaluation_iteration": 0.7478240407650402, "synch_eval_env_connectors": 0.0004221762527217747, "synch_env_connectors": 7.776906605964699e-06}, "env_runners": {"weights_seq_no": 15.0, "module_to_env_connector": {"timers": {"connectors": {"get_actions": 0.0001676828468235967, "tensor_to_numpy": 5.042851684646882e-05, "listify_data_for_vector_env": 3.14786469034792e-05, "un_batch_to_individual_items": 1.5146120849654743e-05, "normalize_and_clip_actions": 2.2477620702822296e-05, "remove_single_ts_time_rank_from_batch": 1.5881367548476627e-06}}, "connector_pipeline_timer": 0.0003660082685106133}, "env_reset_timer": 9.52343778076257e-05, "rlmodule_inference_timer": 0.00013494216456588092, "env_step_timer": 4.3114609632774296e-05, "env_to_module_connector": {"timers": {"connectors": {"batch_individual_items": 1.8682457971012386e-05, "add_observations_from_episodes_to_batch": 6.494389004419713e-06, "numpy_to_tensor": 3.172841389751725e-05, "add_states_from_episodes_to_batch": 3.458526153739937e-06, "add_time_dim_to_batch_and_zero_pad": 6.203414767174449e-06}}, "connector_pipeline_timer": 0.00011986571369603642}, "num_episodes": 100.0, "episode_len_min": 50, "episode_duration_sec_mean": 0.03817758501998469, "num_module_steps_sampled": {"default_policy": 5000.0}, "num_episodes_lifetime": -67700.0, "episode_return_max": 14.5, "episode_return_min": -5.5, "num_env_steps_sampled": 5000.0, "episode_return_mean": 10.700000000000003, "num_env_steps_sampled_lifetime": -3385000.0, "time_between_sampling": 0.011797235241040947, "num_agent_steps_sampled": {"default_agent": 5000.0}, "episode_len_max": 50, "num_agent_steps_sampled_lifetime": {"default_agent": -3385000.0}, "env_to_module_sum_episodes_length_in": 27.16809333212661, "module_episode_returns_mean": {"default_policy": 10.700000000000003}, "sample": 0.039243840867339626, "num_module_steps_sampled_lifetime": {"default_policy": -3385000.0}, "agent_episode_returns_mean": {"default_agent": 10.700000000000003}, "env_to_module_sum_episodes_length_out": 27.16809333212661, "episode_len_mean": 50.0, "num_env_steps_sampled_lifetime_throughput": 1251.2892481871468}, "learners": {"default_policy": {"vf_loss_unclipped": 9.278881072998047, "mean_kl_loss": 0.00261958921328187, "num_module_steps_trained": 16000, "diff_num_grad_updates_vs_sampler_policy": 1.0, "vf_explained_var": 0.44409650564193726, "entropy": 0.5547052025794983, "num_trainable_parameters": 5707, "vf_loss": 0.09024057537317276, "default_optimizer_learning_rate": 0.0003313639719, "curr_kl_coeff": 1.1859105143230408e-05, "num_module_steps_trained_lifetime": 256000, "total_loss": 0.02905096672475338, "gradients_default_optimizer_global_norm": 0.1402314007282257, "module_train_batch_size_mean": 1000.0, "weights_seq_no": 16.0, "curr_entropy_coeff": 0.0090570820258, "policy_loss": -0.026278676465153694, "num_module_steps_trained_lifetime_throughput": 189620.22532507012}, "__all_modules__": {"num_module_steps_trained_lifetime": 256000, "learner_connector": {"timers": {"connectors": {"general_advantage_estimation": 0.012020895836853231, "add_time_dim_to_batch_and_zero_pad": 2.3599987908262877e-05, "batch_individual_items": 0.19804994188062136, "numpy_to_tensor": 0.00023603503477057726, "add_states_from_episodes_to_batch": 6.2548617588697085e-06, "add_one_ts_to_episodes_and_truncate": 0.008926861283378523, "add_columns_from_episodes_to_train_batch": 0.07246842461534889, "add_observations_from_episodes_to_batch": 0.0008315105406274238}}, "connector_pipeline_timer": 0.29299719805471036}, "num_trainable_parameters": 5707, "learner_connector_sum_episodes_length_out": 5100.0, "num_env_steps_trained_lifetime": 1305600, "num_env_steps_trained": 81600, "learner_connector_sum_episodes_length_in": 5000.0, "num_non_trainable_parameters": 0, "num_module_steps_trained": 16000, "num_env_steps_trained_lifetime_throughput": 966161.2386016317, "num_module_steps_trained_throughput": 189770.6695074119, "num_module_steps_trained_lifetime_throughput": 189742.95475553197}}, "num_training_step_calls_per_iteration": 1, "evaluation": {"env_runners": {"module_to_env_connector": {"timers": {"connectors": {"tensor_to_numpy": 4.525440153761139e-05, "get_actions": 0.00015399688966113276, "listify_data_for_vector_env": 3.1031008815547686e-05, "normalize_and_clip_actions": 2.167258656866306e-05, "un_batch_to_individual_items": 1.5830031578318156e-05, "remove_single_ts_time_rank_from_batch": 1.4262616949069222e-06}}, "connector_pipeline_timer": 0.000342268437578579}, "env_to_module_sum_episodes_length_in": 27.168093332126602, "sample": 0.736466236044975, "env_step_timer": 4.24749238820189e-05, "episode_len_min": 50, "env_to_module_connector": {"timers": {"connectors": {"add_time_dim_to_batch_and_zero_pad": 5.7171689697284785e-06, "batch_individual_items": 1.8239853227843497e-05, "numpy_to_tensor": 2.9318074354579415e-05, "add_states_from_episodes_to_batch": 3.243463518671449e-06, "add_observations_from_episodes_to_batch": 6.093225014254397e-06}}, "connector_pipeline_timer": 0.00011178348014599612}, "agent_episode_returns_mean": {"default_agent": -1.1}, "episode_return_min": -16.5, "num_agent_steps_sampled_lifetime": {"default_agent": 16000}, "env_to_module_sum_episodes_length_out": 27.168093332126602, "num_module_steps_sampled": {"default_policy": 1000}, "episode_len_mean": 50.0, "weights_seq_no": 16.0, "num_agent_steps_sampled": {"default_agent": 1000}, "num_episodes_lifetime": 320, "episode_return_max": 17.5, "module_episode_returns_mean": {"default_policy": -1.1}, "episode_return_mean": -1.1, "num_module_steps_sampled_lifetime": {"default_policy": 16000}, "env_reset_timer": 0.00023252695546521152, "rlmodule_inference_timer": 9.57160995368483e-05, "num_episodes": 20, "episode_duration_sec_mean": 0.03507589900998937, "num_env_steps_sampled_lifetime": 81000, "num_env_steps_sampled": 1000, "episode_len_max": 50, "time_between_sampling": 4.251258206775386}, "num_healthy_workers": 1, "actor_manager_num_outstanding_async_reqs": 0, "num_remote_worker_restarts": 0}, "num_env_steps_sampled_lifetime": -3385000.0, "fault_tolerance": {"num_healthy_workers": 0, "num_remote_worker_restarts": 0}, "env_runner_group": {"actor_manager_num_outstanding_async_reqs": 0}, "done": false, "training_iteration": 16, "trial_id": "aef7a_00000", "date": "2025-08-11_17-15-08", "timestamp": 1754925308, "time_this_iter_s": 5.06015682220459, "time_total_s": 80.14992237091064, "pid": 66454, "hostname": "DESKTOP-3SK5A41", "node_ip": "192.168.40.242", "config": {"exploration_config": {}, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 6, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "env": "Umbrella", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": false, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 0, "create_local_env_runner": true, "num_envs_per_env_runner": 1, "gym_env_vectorize_mode": "SYNC", "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "episodes_to_numpy": true, "max_requests_in_flight_per_env_runner": 1, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "merge_env_runner_states": "training_only", "broadcast_env_runner_states": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "complete_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "sampler_perf_stats_ema_coef": null, "_is_online": true, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": "auto", "num_aggregator_actors_per_learner": 0, "max_requests_in_flight_per_aggregator_actor": 3, "local_gpu_idx": 0, "max_requests_in_flight_per_learner": 3, "gamma": 1, "lr": 0.0003313639719, "grad_clip": 0.5, "grad_clip_by": "global_norm", "_train_batch_size_per_learner": 5000, "train_batch_size": 4000, "num_epochs": 3, "minibatch_size": 1000, "shuffle_batch_per_epoch": true, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "log_std_clip_param": 20.0, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "_disable_preprocessor_api": false, "_disable_action_flattening": false}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "_learner_class": null, "callbacks_on_algorithm_init": null, "callbacks_on_env_runners_recreated": null, "callbacks_on_offline_eval_runners_recreated": null, "callbacks_on_checkpoint_loaded": null, "callbacks_on_environment_created": null, "callbacks_on_episode_created": null, "callbacks_on_episode_start": null, "callbacks_on_episode_step": null, "callbacks_on_episode_end": null, "callbacks_on_evaluate_start": null, "callbacks_on_evaluate_end": null, "callbacks_on_evaluate_offline_start": null, "callbacks_on_evaluate_offline_end": null, "callbacks_on_sample_end": null, "callbacks_on_train_result": null, "explore": true, "enable_rl_module_and_learner": true, "enable_env_runner_and_connector_v2": true, "_prior_exploration_config": {"type": "StochasticSampling"}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x73ae51472ac0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "offline_data_class": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_read_batch_size": null, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "materialize_data": false, "materialize_mapped_data": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "ignore_final_observation": false, "prelearner_class": null, "prelearner_buffer_class": null, "prelearner_buffer_kwargs": {}, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_remaining_data": false, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": 1, "evaluation_duration": 20, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_auto_duration_min_env_steps_per_sample": 100, "evaluation_auto_duration_max_env_steps_per_sample": 2000, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 1, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "offline_evaluation_interval": null, "num_offline_eval_runners": 0, "offline_loss_for_module_fn": null, "offline_evaluation_duration": 1, "offline_evaluation_parallel_to_training": false, "offline_evaluation_timeout_s": 120.0, "num_cpus_per_offline_eval_runner": 1, "num_gpus_per_offline_eval_runner": 0, "custom_resources_per_offline_eval_runner": {}, "restart_failed_offline_eval_runners": true, "ignore_offline_eval_runner_failures": false, "max_num_offline_eval_runner_restarts": 1000, "offline_eval_runner_restore_timeout_s": 1800.0, "max_requests_in_flight_per_offline_eval_runner": 1, "validate_offline_eval_runners_after_construction": true, "offline_eval_runner_health_probe_timeout_s": 30.0, "offline_eval_rl_module_inference_only": false, "broadcast_offline_eval_runner_states": false, "offline_eval_batch_size_per_runner": 256, "dataset_num_iters_per_eval_runner": 1, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "log_gradients": true, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 42, "restart_failed_env_runners": true, "ignore_env_runner_failures": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30.0, "env_runner_restore_timeout_s": 1800.0, "_model_config": {}, "_rl_module_spec": "RLModuleSpec(module_class=None, observation_space=None, action_space=None, inference_only=False, learner_only=False, model_config=DefaultModelConfig(fcnet_hiddens=[61, 84], fcnet_activation='tanh', fcnet_kernel_initializer=None, fcnet_kernel_initializer_kwargs=None, fcnet_bias_initializer=None, fcnet_bias_initializer_kwargs=None, conv_filters=None, conv_activation='relu', conv_kernel_initializer=None, conv_kernel_initializer_kwargs=None, conv_bias_initializer=None, conv_bias_initializer_kwargs=None, head_fcnet_hiddens=[], head_fcnet_activation='relu', head_fcnet_kernel_initializer=None, head_fcnet_kernel_initializer_kwargs=None, head_fcnet_bias_initializer=None, head_fcnet_bias_initializer_kwargs=None, free_log_std=False, log_std_clip_param=20.0, vf_share_layers=True, use_lstm=False, max_seq_len=20, lstm_cell_size=256, lstm_use_prev_action=False, lstm_use_prev_reward=False, lstm_kernel_initializer=None, lstm_kernel_initializer_kwargs=None, lstm_bias_initializer=None, lstm_bias_initializer_kwargs=None), catalog_class=None, load_state_path=None, model_config_dict=None)", "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "_validate_config": true, "_use_msgpack_checkpoints": false, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "env_task_fn": -1, "enable_connectors": -1, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.7771983355204, "kl_target": 0.026982802658, "vf_loss_coeff": 0.6688075857018, "entropy_coeff": 0.0090570820258, "clip_param": 0.1202945497339, "vf_clip_param": 0.1020987445302, "entropy_coeff_schedule": null, "lr_schedule": null, "sgd_minibatch_size": -1, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9064845981162, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.callbacks.callbacks.RLlibCallback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 80.14992237091064, "iterations_since_restore": 16, "perf": {"cpu_util_percent": 12.142857142857142, "ram_util_percent": 74.3}}
{"timers": {"training_iteration": 4.381463885254171, "restore_env_runners": 1.4048887867280848e-05, "training_step": 4.381233668216568, "env_runner_sampling_timer": 3.933052288854988, "learner_update_timer": 0.4444760740527755, "synch_weights": 0.0016918951992247635, "restore_eval_env_runners": 1.2632458912885676e-05, "evaluation_iteration": 0.7477120323573846, "synch_eval_env_connectors": 0.00042214449019421004, "synch_env_connectors": 7.761137539066396e-06}, "env_runners": {"weights_seq_no": 16.0, "module_to_env_connector": {"timers": {"connectors": {"get_actions": 0.0001667948280880684, "tensor_to_numpy": 5.0418625662608125e-05, "listify_data_for_vector_env": 3.131760032673689e-05, "un_batch_to_individual_items": 1.5060690471581657e-05, "normalize_and_clip_actions": 2.241544778831485e-05, "remove_single_ts_time_rank_from_batch": 1.5876445666381901e-06}}, "connector_pipeline_timer": 0.0003647826961590989}, "env_reset_timer": 9.403880063742972e-05, "rlmodule_inference_timer": 0.00010125556165885223, "env_step_timer": 4.283528686528721e-05, "env_to_module_connector": {"timers": {"connectors": {"batch_individual_items": 1.8885437966013075e-05, "add_observations_from_episodes_to_batch": 6.42187089196087e-06, "numpy_to_tensor": 3.188006170088127e-05, "add_states_from_episodes_to_batch": 3.4509329313841836e-06, "add_time_dim_to_batch_and_zero_pad": 6.154379671816103e-06}}, "connector_pipeline_timer": 0.00011985328877491309}, "num_episodes": 100.0, "episode_len_min": 50, "episode_duration_sec_mean": 0.03675679803002824, "num_module_steps_sampled": {"default_policy": 5000.0}, "num_episodes_lifetime": -72550.0, "episode_return_max": 14.5, "episode_return_min": -5.5, "num_env_steps_sampled": 5000.0, "episode_return_mean": 11.900000000000007, "num_env_steps_sampled_lifetime": -3627500.0, "time_between_sampling": 0.011754585345349091, "num_agent_steps_sampled": {"default_agent": 5000.0}, "episode_len_max": 50, "num_agent_steps_sampled_lifetime": {"default_agent": -3627500.0}, "env_to_module_sum_episodes_length_in": 27.16809333212661, "module_episode_returns_mean": {"default_policy": 11.900000000000007}, "sample": 0.038395028922041184, "num_module_steps_sampled_lifetime": {"default_policy": -3627500.0}, "agent_episode_returns_mean": {"default_agent": 11.900000000000007}, "env_to_module_sum_episodes_length_out": 27.16809333212661, "episode_len_mean": 50.0, "num_env_steps_sampled_lifetime_throughput": 1273.0771410340265}, "learners": {"default_policy": {"vf_loss_unclipped": 9.205641746520996, "mean_kl_loss": 0.0013169378507882357, "num_module_steps_trained": 16000, "diff_num_grad_updates_vs_sampler_policy": 1.0, "vf_explained_var": 0.4155600070953369, "entropy": 0.5798826813697815, "num_trainable_parameters": 5707, "vf_loss": 0.09076185524463654, "default_optimizer_learning_rate": 0.0003313639719, "curr_kl_coeff": 5.929552571615204e-06, "num_module_steps_trained_lifetime": 272000, "total_loss": 0.07685153931379318, "gradients_default_optimizer_global_norm": 0.07985764741897583, "module_train_batch_size_mean": 1000.0, "weights_seq_no": 17.0, "curr_entropy_coeff": 0.0090570820258, "policy_loss": 0.021401332691311836, "num_module_steps_trained_lifetime_throughput": 189850.21311562232}, "__all_modules__": {"num_module_steps_trained_lifetime": 272000, "learner_connector": {"timers": {"connectors": {"general_advantage_estimation": 0.012002745878485434, "add_time_dim_to_batch_and_zero_pad": 2.3557988033010545e-05, "batch_individual_items": 0.1980888804618127, "numpy_to_tensor": 0.00023536768442666882, "add_states_from_episodes_to_batch": 6.242313140017905e-06, "add_one_ts_to_episodes_and_truncate": 0.00892150867053887, "add_columns_from_episodes_to_train_batch": 0.07244104437919555, "add_observations_from_episodes_to_batch": 0.0008299994352253443}}, "connector_pipeline_timer": 0.2929820720841619}, "num_trainable_parameters": 5707, "learner_connector_sum_episodes_length_out": 5100.0, "num_env_steps_trained_lifetime": 1387200, "num_env_steps_trained": 81600, "learner_connector_sum_episodes_length_in": 5000.0, "num_non_trainable_parameters": 0, "num_module_steps_trained": 16000, "num_env_steps_trained_lifetime_throughput": 967386.5913534347, "num_module_steps_trained_throughput": 189997.79244813474, "num_module_steps_trained_lifetime_throughput": 189970.07715561986}}, "num_training_step_calls_per_iteration": 1, "evaluation": {"env_runners": {"module_to_env_connector": {"timers": {"connectors": {"tensor_to_numpy": 4.68540091186898e-05, "get_actions": 0.00016104713545859044, "listify_data_for_vector_env": 3.204641727116817e-05, "normalize_and_clip_actions": 2.2401003349783397e-05, "un_batch_to_individual_items": 1.597325242849933e-05, "remove_single_ts_time_rank_from_batch": 1.4002997469816986e-06}}, "connector_pipeline_timer": 0.0003548567480519316}, "env_to_module_sum_episodes_length_in": 27.168093332126602, "sample": 0.7366088756945242, "env_step_timer": 4.367455144175156e-05, "episode_len_min": 50, "env_to_module_connector": {"timers": {"connectors": {"add_time_dim_to_batch_and_zero_pad": 5.986627045356228e-06, "batch_individual_items": 1.9352316383564855e-05, "numpy_to_tensor": 3.0406878572352815e-05, "add_states_from_episodes_to_batch": 3.390216908629393e-06, "add_observations_from_episodes_to_batch": 6.438902551211195e-06}}, "connector_pipeline_timer": 0.0001154337796035837}, "agent_episode_returns_mean": {"default_agent": -0.5}, "episode_return_min": -16.5, "num_agent_steps_sampled_lifetime": {"default_agent": 17000}, "env_to_module_sum_episodes_length_out": 27.168093332126602, "num_module_steps_sampled": {"default_policy": 1000}, "episode_len_mean": 50.0, "weights_seq_no": 17.0, "num_agent_steps_sampled": {"default_agent": 1000}, "num_episodes_lifetime": 340, "episode_return_max": 17.5, "module_episode_returns_mean": {"default_policy": -0.5}, "episode_return_mean": -0.5, "num_module_steps_sampled_lifetime": {"default_policy": 17000}, "env_reset_timer": 0.00023177068591603408, "rlmodule_inference_timer": 9.811249163240453e-05, "num_episodes": 20, "episode_duration_sec_mean": 0.035275589019984184, "num_env_steps_sampled_lifetime": 86000, "num_env_steps_sampled": 1000, "episode_len_max": 50, "time_between_sampling": 4.2522986897476365}, "num_healthy_workers": 1, "actor_manager_num_outstanding_async_reqs": 0, "num_remote_worker_restarts": 0}, "num_env_steps_sampled_lifetime": -3627500.0, "fault_tolerance": {"num_healthy_workers": 0, "num_remote_worker_restarts": 0}, "env_runner_group": {"actor_manager_num_outstanding_async_reqs": 0}, "done": false, "training_iteration": 17, "trial_id": "aef7a_00000", "date": "2025-08-11_17-15-13", "timestamp": 1754925313, "time_this_iter_s": 5.065727472305298, "time_total_s": 85.21564984321594, "pid": 66454, "hostname": "DESKTOP-3SK5A41", "node_ip": "192.168.40.242", "config": {"exploration_config": {}, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 6, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "env": "Umbrella", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": false, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 0, "create_local_env_runner": true, "num_envs_per_env_runner": 1, "gym_env_vectorize_mode": "SYNC", "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "episodes_to_numpy": true, "max_requests_in_flight_per_env_runner": 1, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "merge_env_runner_states": "training_only", "broadcast_env_runner_states": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "complete_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "sampler_perf_stats_ema_coef": null, "_is_online": true, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": "auto", "num_aggregator_actors_per_learner": 0, "max_requests_in_flight_per_aggregator_actor": 3, "local_gpu_idx": 0, "max_requests_in_flight_per_learner": 3, "gamma": 1, "lr": 0.0003313639719, "grad_clip": 0.5, "grad_clip_by": "global_norm", "_train_batch_size_per_learner": 5000, "train_batch_size": 4000, "num_epochs": 3, "minibatch_size": 1000, "shuffle_batch_per_epoch": true, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "log_std_clip_param": 20.0, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "_disable_preprocessor_api": false, "_disable_action_flattening": false}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "_learner_class": null, "callbacks_on_algorithm_init": null, "callbacks_on_env_runners_recreated": null, "callbacks_on_offline_eval_runners_recreated": null, "callbacks_on_checkpoint_loaded": null, "callbacks_on_environment_created": null, "callbacks_on_episode_created": null, "callbacks_on_episode_start": null, "callbacks_on_episode_step": null, "callbacks_on_episode_end": null, "callbacks_on_evaluate_start": null, "callbacks_on_evaluate_end": null, "callbacks_on_evaluate_offline_start": null, "callbacks_on_evaluate_offline_end": null, "callbacks_on_sample_end": null, "callbacks_on_train_result": null, "explore": true, "enable_rl_module_and_learner": true, "enable_env_runner_and_connector_v2": true, "_prior_exploration_config": {"type": "StochasticSampling"}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x73ae51472ac0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "offline_data_class": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_read_batch_size": null, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "materialize_data": false, "materialize_mapped_data": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "ignore_final_observation": false, "prelearner_class": null, "prelearner_buffer_class": null, "prelearner_buffer_kwargs": {}, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_remaining_data": false, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": 1, "evaluation_duration": 20, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_auto_duration_min_env_steps_per_sample": 100, "evaluation_auto_duration_max_env_steps_per_sample": 2000, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 1, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "offline_evaluation_interval": null, "num_offline_eval_runners": 0, "offline_loss_for_module_fn": null, "offline_evaluation_duration": 1, "offline_evaluation_parallel_to_training": false, "offline_evaluation_timeout_s": 120.0, "num_cpus_per_offline_eval_runner": 1, "num_gpus_per_offline_eval_runner": 0, "custom_resources_per_offline_eval_runner": {}, "restart_failed_offline_eval_runners": true, "ignore_offline_eval_runner_failures": false, "max_num_offline_eval_runner_restarts": 1000, "offline_eval_runner_restore_timeout_s": 1800.0, "max_requests_in_flight_per_offline_eval_runner": 1, "validate_offline_eval_runners_after_construction": true, "offline_eval_runner_health_probe_timeout_s": 30.0, "offline_eval_rl_module_inference_only": false, "broadcast_offline_eval_runner_states": false, "offline_eval_batch_size_per_runner": 256, "dataset_num_iters_per_eval_runner": 1, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "log_gradients": true, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 42, "restart_failed_env_runners": true, "ignore_env_runner_failures": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30.0, "env_runner_restore_timeout_s": 1800.0, "_model_config": {}, "_rl_module_spec": "RLModuleSpec(module_class=None, observation_space=None, action_space=None, inference_only=False, learner_only=False, model_config=DefaultModelConfig(fcnet_hiddens=[61, 84], fcnet_activation='tanh', fcnet_kernel_initializer=None, fcnet_kernel_initializer_kwargs=None, fcnet_bias_initializer=None, fcnet_bias_initializer_kwargs=None, conv_filters=None, conv_activation='relu', conv_kernel_initializer=None, conv_kernel_initializer_kwargs=None, conv_bias_initializer=None, conv_bias_initializer_kwargs=None, head_fcnet_hiddens=[], head_fcnet_activation='relu', head_fcnet_kernel_initializer=None, head_fcnet_kernel_initializer_kwargs=None, head_fcnet_bias_initializer=None, head_fcnet_bias_initializer_kwargs=None, free_log_std=False, log_std_clip_param=20.0, vf_share_layers=True, use_lstm=False, max_seq_len=20, lstm_cell_size=256, lstm_use_prev_action=False, lstm_use_prev_reward=False, lstm_kernel_initializer=None, lstm_kernel_initializer_kwargs=None, lstm_bias_initializer=None, lstm_bias_initializer_kwargs=None), catalog_class=None, load_state_path=None, model_config_dict=None)", "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "_validate_config": true, "_use_msgpack_checkpoints": false, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "env_task_fn": -1, "enable_connectors": -1, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.7771983355204, "kl_target": 0.026982802658, "vf_loss_coeff": 0.6688075857018, "entropy_coeff": 0.0090570820258, "clip_param": 0.1202945497339, "vf_clip_param": 0.1020987445302, "entropy_coeff_schedule": null, "lr_schedule": null, "sgd_minibatch_size": -1, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9064845981162, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.callbacks.callbacks.RLlibCallback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 85.21564984321594, "iterations_since_restore": 17, "perf": {"cpu_util_percent": 12.462499999999999, "ram_util_percent": 74.3}}
{"timers": {"training_iteration": 4.379652190441625, "restore_env_runners": 1.402639899581345e-05, "training_step": 4.379419822574406, "env_runner_sampling_timer": 3.9332513860064404, "learner_update_timer": 0.442465723312244, "synch_weights": 0.0016879292472374429, "restore_eval_env_runners": 1.2616134324615964e-05, "evaluation_iteration": 0.747839289043813, "synch_eval_env_connectors": 0.00042185604529040984, "synch_env_connectors": 7.746526161356623e-06}, "env_runners": {"weights_seq_no": 17.0, "module_to_env_connector": {"timers": {"connectors": {"get_actions": 0.00016830883678125078, "tensor_to_numpy": 5.036876419049997e-05, "listify_data_for_vector_env": 3.170674663766012e-05, "un_batch_to_individual_items": 1.5119059314842153e-05, "normalize_and_clip_actions": 2.2681022541167407e-05, "remove_single_ts_time_rank_from_batch": 1.6889603076243073e-06}}, "connector_pipeline_timer": 0.0003671507825345275}, "env_reset_timer": 9.374786156167637e-05, "rlmodule_inference_timer": 0.00010170534649019873, "env_step_timer": 4.322019352856318e-05, "env_to_module_connector": {"timers": {"connectors": {"batch_individual_items": 1.9042551658625544e-05, "add_observations_from_episodes_to_batch": 6.5227316142865935e-06, "numpy_to_tensor": 3.197502877358538e-05, "add_states_from_episodes_to_batch": 3.3861958127453377e-06, "add_time_dim_to_batch_and_zero_pad": 6.186932803216764e-06}}, "connector_pipeline_timer": 0.00012055473213716591}, "num_episodes": 100.0, "episode_len_min": 50, "episode_duration_sec_mean": 0.03698310303999279, "num_module_steps_sampled": {"default_policy": 5000.0}, "num_episodes_lifetime": -77400.0, "episode_return_max": 14.5, "episode_return_min": -5.5, "num_env_steps_sampled": 5000.0, "episode_return_mean": 10.900000000000007, "num_env_steps_sampled_lifetime": -3870000.0, "time_between_sampling": 0.012689237137279295, "num_agent_steps_sampled": {"default_agent": 5000.0}, "episode_len_max": 50, "num_agent_steps_sampled_lifetime": {"default_agent": -3870000.0}, "env_to_module_sum_episodes_length_in": 27.16809333212661, "module_episode_returns_mean": {"default_policy": 10.900000000000007}, "sample": 0.03809178021777302, "num_module_steps_sampled_lifetime": {"default_policy": -3870000.0}, "agent_episode_returns_mean": {"default_agent": 10.900000000000007}, "env_to_module_sum_episodes_length_out": 27.16809333212661, "episode_len_mean": 50.0, "num_env_steps_sampled_lifetime_throughput": 1268.0842331759243}, "learners": {"default_policy": {"vf_loss_unclipped": 9.286853790283203, "mean_kl_loss": 0.00015712258755229414, "num_module_steps_trained": 16000, "diff_num_grad_updates_vs_sampler_policy": 1.0, "vf_explained_var": 0.4510849714279175, "entropy": 0.5772976875305176, "num_trainable_parameters": 5707, "vf_loss": 0.0900561735033989, "default_optimizer_learning_rate": 0.0003313639719, "curr_kl_coeff": 2.964776285807602e-06, "num_module_steps_trained_lifetime": 288000, "total_loss": 0.041016776114702225, "gradients_default_optimizer_global_norm": 0.1212543472647667, "module_train_batch_size_mean": 1000.0, "weights_seq_no": 18.0, "curr_entropy_coeff": 0.0090570820258, "policy_loss": -0.013984857127070427, "num_module_steps_trained_lifetime_throughput": 189303.7867725577}, "__all_modules__": {"num_module_steps_trained_lifetime": 288000, "learner_connector": {"timers": {"connectors": {"general_advantage_estimation": 0.011988400419703652, "add_time_dim_to_batch_and_zero_pad": 2.350340815756674e-05, "batch_individual_items": 0.1966980496572016, "numpy_to_tensor": 0.00023480700757457832, "add_states_from_episodes_to_batch": 6.22989000735462e-06, "add_one_ts_to_episodes_and_truncate": 0.008917237583833658, "add_columns_from_episodes_to_train_batch": 0.07241009593540286, "add_observations_from_episodes_to_batch": 0.0008288844408771193}}, "connector_pipeline_timer": 0.29153853936332574}, "num_trainable_parameters": 5707, "learner_connector_sum_episodes_length_out": 5100.0, "num_env_steps_trained_lifetime": 1468800, "num_env_steps_trained": 81600, "learner_connector_sum_episodes_length_in": 5000.0, "num_non_trainable_parameters": 0, "num_module_steps_trained": 16000, "num_env_steps_trained_lifetime_throughput": 964646.1995246526, "num_module_steps_trained_throughput": 189448.14521488396, "num_module_steps_trained_lifetime_throughput": 189421.04525792843}}, "num_training_step_calls_per_iteration": 1, "evaluation": {"env_runners": {"module_to_env_connector": {"timers": {"connectors": {"tensor_to_numpy": 4.495992589393453e-05, "get_actions": 0.00015436632868651805, "listify_data_for_vector_env": 3.071154601667035e-05, "normalize_and_clip_actions": 2.132157448574365e-05, "un_batch_to_individual_items": 1.532401543236679e-05, "remove_single_ts_time_rank_from_batch": 1.3790023879822867e-06}}, "connector_pipeline_timer": 0.0003407523923291282}, "env_to_module_sum_episodes_length_in": 27.168093332126602, "sample": 0.7365649989475734, "env_step_timer": 4.233047934566696e-05, "episode_len_min": 50, "env_to_module_connector": {"timers": {"connectors": {"add_time_dim_to_batch_and_zero_pad": 5.677996239677715e-06, "batch_individual_items": 1.8568092125625568e-05, "numpy_to_tensor": 2.9359158943728206e-05, "add_states_from_episodes_to_batch": 3.372113123238668e-06, "add_observations_from_episodes_to_batch": 5.989295542551323e-06}}, "connector_pipeline_timer": 0.00011186465583174381}, "agent_episode_returns_mean": {"default_agent": -1.1}, "episode_return_min": -16.5, "num_agent_steps_sampled_lifetime": {"default_agent": 18000}, "env_to_module_sum_episodes_length_out": 27.168093332126602, "num_module_steps_sampled": {"default_policy": 1000}, "episode_len_mean": 50.0, "weights_seq_no": 18.0, "num_agent_steps_sampled": {"default_agent": 1000}, "num_episodes_lifetime": 360, "episode_return_max": 17.5, "module_episode_returns_mean": {"default_policy": -1.1}, "episode_return_mean": -1.1, "num_module_steps_sampled_lifetime": {"default_policy": 18000}, "env_reset_timer": 0.00023066697905130759, "rlmodule_inference_timer": 9.442887212872866e-05, "num_episodes": 20, "episode_duration_sec_mean": 0.035308221019977284, "num_env_steps_sampled_lifetime": 91000, "num_env_steps_sampled": 1000, "episode_len_max": 50, "time_between_sampling": 4.252335901890159}, "num_healthy_workers": 1, "actor_manager_num_outstanding_async_reqs": 0, "num_remote_worker_restarts": 0}, "num_env_steps_sampled_lifetime": -3870000.0, "fault_tolerance": {"num_healthy_workers": 0, "num_remote_worker_restarts": 0}, "env_runner_group": {"actor_manager_num_outstanding_async_reqs": 0}, "done": false, "training_iteration": 18, "trial_id": "aef7a_00000", "date": "2025-08-11_17-15-18", "timestamp": 1754925318, "time_this_iter_s": 4.9470672607421875, "time_total_s": 90.16271710395813, "pid": 66454, "hostname": "DESKTOP-3SK5A41", "node_ip": "192.168.40.242", "config": {"exploration_config": {}, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 6, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "env": "Umbrella", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": false, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 0, "create_local_env_runner": true, "num_envs_per_env_runner": 1, "gym_env_vectorize_mode": "SYNC", "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "episodes_to_numpy": true, "max_requests_in_flight_per_env_runner": 1, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "merge_env_runner_states": "training_only", "broadcast_env_runner_states": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "complete_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "sampler_perf_stats_ema_coef": null, "_is_online": true, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": "auto", "num_aggregator_actors_per_learner": 0, "max_requests_in_flight_per_aggregator_actor": 3, "local_gpu_idx": 0, "max_requests_in_flight_per_learner": 3, "gamma": 1, "lr": 0.0003313639719, "grad_clip": 0.5, "grad_clip_by": "global_norm", "_train_batch_size_per_learner": 5000, "train_batch_size": 4000, "num_epochs": 3, "minibatch_size": 1000, "shuffle_batch_per_epoch": true, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "log_std_clip_param": 20.0, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "_disable_preprocessor_api": false, "_disable_action_flattening": false}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "_learner_class": null, "callbacks_on_algorithm_init": null, "callbacks_on_env_runners_recreated": null, "callbacks_on_offline_eval_runners_recreated": null, "callbacks_on_checkpoint_loaded": null, "callbacks_on_environment_created": null, "callbacks_on_episode_created": null, "callbacks_on_episode_start": null, "callbacks_on_episode_step": null, "callbacks_on_episode_end": null, "callbacks_on_evaluate_start": null, "callbacks_on_evaluate_end": null, "callbacks_on_evaluate_offline_start": null, "callbacks_on_evaluate_offline_end": null, "callbacks_on_sample_end": null, "callbacks_on_train_result": null, "explore": true, "enable_rl_module_and_learner": true, "enable_env_runner_and_connector_v2": true, "_prior_exploration_config": {"type": "StochasticSampling"}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x73ae51472ac0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "offline_data_class": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_read_batch_size": null, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "materialize_data": false, "materialize_mapped_data": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "ignore_final_observation": false, "prelearner_class": null, "prelearner_buffer_class": null, "prelearner_buffer_kwargs": {}, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_remaining_data": false, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": 1, "evaluation_duration": 20, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_auto_duration_min_env_steps_per_sample": 100, "evaluation_auto_duration_max_env_steps_per_sample": 2000, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 1, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "offline_evaluation_interval": null, "num_offline_eval_runners": 0, "offline_loss_for_module_fn": null, "offline_evaluation_duration": 1, "offline_evaluation_parallel_to_training": false, "offline_evaluation_timeout_s": 120.0, "num_cpus_per_offline_eval_runner": 1, "num_gpus_per_offline_eval_runner": 0, "custom_resources_per_offline_eval_runner": {}, "restart_failed_offline_eval_runners": true, "ignore_offline_eval_runner_failures": false, "max_num_offline_eval_runner_restarts": 1000, "offline_eval_runner_restore_timeout_s": 1800.0, "max_requests_in_flight_per_offline_eval_runner": 1, "validate_offline_eval_runners_after_construction": true, "offline_eval_runner_health_probe_timeout_s": 30.0, "offline_eval_rl_module_inference_only": false, "broadcast_offline_eval_runner_states": false, "offline_eval_batch_size_per_runner": 256, "dataset_num_iters_per_eval_runner": 1, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "log_gradients": true, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 42, "restart_failed_env_runners": true, "ignore_env_runner_failures": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30.0, "env_runner_restore_timeout_s": 1800.0, "_model_config": {}, "_rl_module_spec": "RLModuleSpec(module_class=None, observation_space=None, action_space=None, inference_only=False, learner_only=False, model_config=DefaultModelConfig(fcnet_hiddens=[61, 84], fcnet_activation='tanh', fcnet_kernel_initializer=None, fcnet_kernel_initializer_kwargs=None, fcnet_bias_initializer=None, fcnet_bias_initializer_kwargs=None, conv_filters=None, conv_activation='relu', conv_kernel_initializer=None, conv_kernel_initializer_kwargs=None, conv_bias_initializer=None, conv_bias_initializer_kwargs=None, head_fcnet_hiddens=[], head_fcnet_activation='relu', head_fcnet_kernel_initializer=None, head_fcnet_kernel_initializer_kwargs=None, head_fcnet_bias_initializer=None, head_fcnet_bias_initializer_kwargs=None, free_log_std=False, log_std_clip_param=20.0, vf_share_layers=True, use_lstm=False, max_seq_len=20, lstm_cell_size=256, lstm_use_prev_action=False, lstm_use_prev_reward=False, lstm_kernel_initializer=None, lstm_kernel_initializer_kwargs=None, lstm_bias_initializer=None, lstm_bias_initializer_kwargs=None), catalog_class=None, load_state_path=None, model_config_dict=None)", "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "_validate_config": true, "_use_msgpack_checkpoints": false, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "env_task_fn": -1, "enable_connectors": -1, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.7771983355204, "kl_target": 0.026982802658, "vf_loss_coeff": 0.6688075857018, "entropy_coeff": 0.0090570820258, "clip_param": 0.1202945497339, "vf_clip_param": 0.1020987445302, "entropy_coeff_schedule": null, "lr_schedule": null, "sgd_minibatch_size": -1, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9064845981162, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.callbacks.callbacks.RLlibCallback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 90.16271710395813, "iterations_since_restore": 18, "perf": {"cpu_util_percent": 13.028571428571428, "ram_util_percent": 74.3}}
{"timers": {"training_iteration": 4.379832133567209, "restore_env_runners": 1.3993135002060876e-05, "training_step": 4.3795982073786615, "env_runner_sampling_timer": 3.9340305911663815, "learner_update_timer": 0.4418649780891149, "synch_weights": 0.001685632954767017, "restore_eval_env_runners": 1.2589972978843591e-05, "evaluation_iteration": 0.7477761081633756, "synch_eval_env_connectors": 0.0004216494848369261, "synch_env_connectors": 7.738060897636173e-06}, "env_runners": {"weights_seq_no": 18.0, "module_to_env_connector": {"timers": {"connectors": {"get_actions": 0.00017089383243695962, "tensor_to_numpy": 5.1313578531340924e-05, "listify_data_for_vector_env": 3.203940834425246e-05, "un_batch_to_individual_items": 1.532336763859933e-05, "normalize_and_clip_actions": 2.2786234620322338e-05, "remove_single_ts_time_rank_from_batch": 1.6427419887135937e-06}}, "connector_pipeline_timer": 0.0003724892966656893}, "env_reset_timer": 9.617713594019382e-05, "rlmodule_inference_timer": 0.00010354664423885776, "env_step_timer": 4.412421062862997e-05, "env_to_module_connector": {"timers": {"connectors": {"batch_individual_items": 1.9062233334908024e-05, "add_observations_from_episodes_to_batch": 6.631228954274966e-06, "numpy_to_tensor": 3.2417700855391414e-05, "add_states_from_episodes_to_batch": 3.4353113273881055e-06, "add_time_dim_to_batch_and_zero_pad": 6.298550091737256e-06}}, "connector_pipeline_timer": 0.000121869728145845}, "num_episodes": 100.0, "episode_len_min": 50, "episode_duration_sec_mean": 0.037521490019998965, "num_module_steps_sampled": {"default_policy": 5000.0}, "num_episodes_lifetime": -82250.0, "episode_return_max": 14.5, "episode_return_min": -5.5, "num_env_steps_sampled": 5000.0, "episode_return_mean": 12.299999999999997, "num_env_steps_sampled_lifetime": -4112500.0, "time_between_sampling": 0.012135298494896403, "num_agent_steps_sampled": {"default_agent": 5000.0}, "episode_len_max": 50, "num_agent_steps_sampled_lifetime": {"default_agent": -4112500.0}, "env_to_module_sum_episodes_length_in": 27.16809333212661, "module_episode_returns_mean": {"default_policy": 12.299999999999997}, "sample": 0.03841771821516598, "num_module_steps_sampled_lifetime": {"default_policy": -4112500.0}, "agent_episode_returns_mean": {"default_agent": 12.299999999999997}, "env_to_module_sum_episodes_length_out": 27.16809333212661, "episode_len_mean": 50.0, "num_env_steps_sampled_lifetime_throughput": 1248.3807107088246}, "learners": {"default_policy": {"vf_loss_unclipped": 8.280854225158691, "mean_kl_loss": 0.00044427139800973237, "num_module_steps_trained": 16000, "diff_num_grad_updates_vs_sampler_policy": 1.0, "vf_explained_var": 0.4213588833808899, "entropy": 0.5730159878730774, "num_trainable_parameters": 5707, "vf_loss": 0.09157558530569077, "default_optimizer_learning_rate": 0.0003313639719, "curr_kl_coeff": 1.482388142903801e-06, "num_module_steps_trained_lifetime": 304000, "total_loss": 0.1002395749092102, "gradients_default_optimizer_global_norm": 0.0631125271320343, "module_train_batch_size_mean": 1000.0, "weights_seq_no": 19.0, "curr_entropy_coeff": 0.0090570820258, "policy_loss": 0.04418298602104187, "num_module_steps_trained_lifetime_throughput": 188556.40767455767}, "__all_modules__": {"num_module_steps_trained_lifetime": 304000, "learner_connector": {"timers": {"connectors": {"general_advantage_estimation": 0.011954800415505683, "add_time_dim_to_batch_and_zero_pad": 2.3461374081301825e-05, "batch_individual_items": 0.196749162170631, "numpy_to_tensor": 0.0002341349374914178, "add_states_from_episodes_to_batch": 6.21859111363246e-06, "add_one_ts_to_episodes_and_truncate": 0.008910515207995202, "add_columns_from_episodes_to_train_batch": 0.07237770597604831, "add_observations_from_episodes_to_batch": 0.0008279795964688047}}, "connector_pipeline_timer": 0.2915139089796954}, "num_trainable_parameters": 5707, "learner_connector_sum_episodes_length_out": 5100.0, "num_env_steps_trained_lifetime": 1550400, "num_env_steps_trained": 81600, "learner_connector_sum_episodes_length_in": 5000.0, "num_non_trainable_parameters": 0, "num_module_steps_trained": 16000, "num_env_steps_trained_lifetime_throughput": 960877.8358274527, "num_module_steps_trained_throughput": 188697.57425903523, "num_module_steps_trained_lifetime_throughput": 188670.17667463887}}, "num_training_step_calls_per_iteration": 1, "evaluation": {"env_runners": {"module_to_env_connector": {"timers": {"connectors": {"tensor_to_numpy": 4.6070114323461916e-05, "get_actions": 0.000155094660255129, "listify_data_for_vector_env": 3.0150716378930573e-05, "normalize_and_clip_actions": 2.1894359040879822e-05, "un_batch_to_individual_items": 1.6059721437716797e-05, "remove_single_ts_time_rank_from_batch": 1.3903585126133521e-06}}, "connector_pipeline_timer": 0.00034306429225646856}, "env_to_module_sum_episodes_length_in": 27.168093332126602, "sample": 0.7364658189581018, "env_step_timer": 4.288139593421527e-05, "episode_len_min": 50, "env_to_module_connector": {"timers": {"connectors": {"add_time_dim_to_batch_and_zero_pad": 5.662618766910356e-06, "batch_individual_items": 1.8363339680847777e-05, "numpy_to_tensor": 2.9569410956656852e-05, "add_states_from_episodes_to_batch": 3.2218405999838417e-06, "add_observations_from_episodes_to_batch": 6.326025548954796e-06}}, "connector_pipeline_timer": 0.00011128902730500145}, "agent_episode_returns_mean": {"default_agent": -1.5}, "episode_return_min": -16.5, "num_agent_steps_sampled_lifetime": {"default_agent": 19000}, "env_to_module_sum_episodes_length_out": 27.168093332126602, "num_module_steps_sampled": {"default_policy": 1000}, "episode_len_mean": 50.0, "weights_seq_no": 19.0, "num_agent_steps_sampled": {"default_agent": 1000}, "num_episodes_lifetime": 380, "episode_return_max": 17.5, "module_episode_returns_mean": {"default_policy": -1.5}, "episode_return_mean": -1.5, "num_module_steps_sampled_lifetime": {"default_policy": 19000}, "env_reset_timer": 0.00022992830925865467, "rlmodule_inference_timer": 9.436642371246878e-05, "num_episodes": 20, "episode_duration_sec_mean": 0.03522441801997957, "num_env_steps_sampled_lifetime": 96000, "num_env_steps_sampled": 1000, "episode_len_max": 50, "time_between_sampling": 4.254338145901254}, "num_healthy_workers": 1, "actor_manager_num_outstanding_async_reqs": 0, "num_remote_worker_restarts": 0}, "num_env_steps_sampled_lifetime": -4112500.0, "fault_tolerance": {"num_healthy_workers": 0, "num_remote_worker_restarts": 0}, "env_runner_group": {"actor_manager_num_outstanding_async_reqs": 0}, "done": false, "training_iteration": 19, "trial_id": "aef7a_00000", "date": "2025-08-11_17-15-24", "timestamp": 1754925324, "time_this_iter_s": 5.139109373092651, "time_total_s": 95.30182647705078, "pid": 66454, "hostname": "DESKTOP-3SK5A41", "node_ip": "192.168.40.242", "config": {"exploration_config": {}, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 6, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "env": "Umbrella", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": false, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 0, "create_local_env_runner": true, "num_envs_per_env_runner": 1, "gym_env_vectorize_mode": "SYNC", "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "episodes_to_numpy": true, "max_requests_in_flight_per_env_runner": 1, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "merge_env_runner_states": "training_only", "broadcast_env_runner_states": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "complete_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "sampler_perf_stats_ema_coef": null, "_is_online": true, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": "auto", "num_aggregator_actors_per_learner": 0, "max_requests_in_flight_per_aggregator_actor": 3, "local_gpu_idx": 0, "max_requests_in_flight_per_learner": 3, "gamma": 1, "lr": 0.0003313639719, "grad_clip": 0.5, "grad_clip_by": "global_norm", "_train_batch_size_per_learner": 5000, "train_batch_size": 4000, "num_epochs": 3, "minibatch_size": 1000, "shuffle_batch_per_epoch": true, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "log_std_clip_param": 20.0, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "_disable_preprocessor_api": false, "_disable_action_flattening": false}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "_learner_class": null, "callbacks_on_algorithm_init": null, "callbacks_on_env_runners_recreated": null, "callbacks_on_offline_eval_runners_recreated": null, "callbacks_on_checkpoint_loaded": null, "callbacks_on_environment_created": null, "callbacks_on_episode_created": null, "callbacks_on_episode_start": null, "callbacks_on_episode_step": null, "callbacks_on_episode_end": null, "callbacks_on_evaluate_start": null, "callbacks_on_evaluate_end": null, "callbacks_on_evaluate_offline_start": null, "callbacks_on_evaluate_offline_end": null, "callbacks_on_sample_end": null, "callbacks_on_train_result": null, "explore": true, "enable_rl_module_and_learner": true, "enable_env_runner_and_connector_v2": true, "_prior_exploration_config": {"type": "StochasticSampling"}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x73ae51472ac0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "offline_data_class": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_read_batch_size": null, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "materialize_data": false, "materialize_mapped_data": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "ignore_final_observation": false, "prelearner_class": null, "prelearner_buffer_class": null, "prelearner_buffer_kwargs": {}, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_remaining_data": false, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": 1, "evaluation_duration": 20, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_auto_duration_min_env_steps_per_sample": 100, "evaluation_auto_duration_max_env_steps_per_sample": 2000, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 1, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "offline_evaluation_interval": null, "num_offline_eval_runners": 0, "offline_loss_for_module_fn": null, "offline_evaluation_duration": 1, "offline_evaluation_parallel_to_training": false, "offline_evaluation_timeout_s": 120.0, "num_cpus_per_offline_eval_runner": 1, "num_gpus_per_offline_eval_runner": 0, "custom_resources_per_offline_eval_runner": {}, "restart_failed_offline_eval_runners": true, "ignore_offline_eval_runner_failures": false, "max_num_offline_eval_runner_restarts": 1000, "offline_eval_runner_restore_timeout_s": 1800.0, "max_requests_in_flight_per_offline_eval_runner": 1, "validate_offline_eval_runners_after_construction": true, "offline_eval_runner_health_probe_timeout_s": 30.0, "offline_eval_rl_module_inference_only": false, "broadcast_offline_eval_runner_states": false, "offline_eval_batch_size_per_runner": 256, "dataset_num_iters_per_eval_runner": 1, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "log_gradients": true, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 42, "restart_failed_env_runners": true, "ignore_env_runner_failures": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30.0, "env_runner_restore_timeout_s": 1800.0, "_model_config": {}, "_rl_module_spec": "RLModuleSpec(module_class=None, observation_space=None, action_space=None, inference_only=False, learner_only=False, model_config=DefaultModelConfig(fcnet_hiddens=[61, 84], fcnet_activation='tanh', fcnet_kernel_initializer=None, fcnet_kernel_initializer_kwargs=None, fcnet_bias_initializer=None, fcnet_bias_initializer_kwargs=None, conv_filters=None, conv_activation='relu', conv_kernel_initializer=None, conv_kernel_initializer_kwargs=None, conv_bias_initializer=None, conv_bias_initializer_kwargs=None, head_fcnet_hiddens=[], head_fcnet_activation='relu', head_fcnet_kernel_initializer=None, head_fcnet_kernel_initializer_kwargs=None, head_fcnet_bias_initializer=None, head_fcnet_bias_initializer_kwargs=None, free_log_std=False, log_std_clip_param=20.0, vf_share_layers=True, use_lstm=False, max_seq_len=20, lstm_cell_size=256, lstm_use_prev_action=False, lstm_use_prev_reward=False, lstm_kernel_initializer=None, lstm_kernel_initializer_kwargs=None, lstm_bias_initializer=None, lstm_bias_initializer_kwargs=None), catalog_class=None, load_state_path=None, model_config_dict=None)", "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "_validate_config": true, "_use_msgpack_checkpoints": false, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "env_task_fn": -1, "enable_connectors": -1, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.7771983355204, "kl_target": 0.026982802658, "vf_loss_coeff": 0.6688075857018, "entropy_coeff": 0.0090570820258, "clip_param": 0.1202945497339, "vf_clip_param": 0.1020987445302, "entropy_coeff_schedule": null, "lr_schedule": null, "sgd_minibatch_size": -1, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9064845981162, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.callbacks.callbacks.RLlibCallback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 95.30182647705078, "iterations_since_restore": 19, "perf": {"cpu_util_percent": 13.885714285714284, "ram_util_percent": 74.27142857142857}}
{"timers": {"training_iteration": 4.377780758241544, "restore_env_runners": 1.3957203652687188e-05, "training_step": 4.377544956314874, "env_runner_sampling_timer": 3.933988625264718, "learner_update_timer": 0.43984922630822404, "synch_weights": 0.0016848326252142797, "restore_eval_env_runners": 1.2564073246528943e-05, "evaluation_iteration": 0.7476597730817395, "synch_eval_env_connectors": 0.0004210119899923673, "synch_env_connectors": 7.721680289301609e-06}, "env_runners": {"weights_seq_no": 19.0, "module_to_env_connector": {"timers": {"connectors": {"get_actions": 0.00016722072549690313, "tensor_to_numpy": 5.0213630377852275e-05, "listify_data_for_vector_env": 3.148218378069793e-05, "un_batch_to_individual_items": 1.5050815474147708e-05, "normalize_and_clip_actions": 2.2391644357668804e-05, "remove_single_ts_time_rank_from_batch": 1.5991456003807668e-06}}, "connector_pipeline_timer": 0.0003651197929823027}, "env_reset_timer": 9.543837433831052e-05, "rlmodule_inference_timer": 0.00010093969616270764, "env_step_timer": 4.316470833398832e-05, "env_to_module_connector": {"timers": {"connectors": {"batch_individual_items": 1.8766039633015063e-05, "add_observations_from_episodes_to_batch": 6.4273092522854894e-06, "numpy_to_tensor": 3.18748267423476e-05, "add_states_from_episodes_to_batch": 3.4083921606743803e-06, "add_time_dim_to_batch_and_zero_pad": 6.166213559168434e-06}}, "connector_pipeline_timer": 0.00011978437623628428}, "num_episodes": 100.0, "episode_len_min": 50, "episode_duration_sec_mean": 0.03675489401001869, "num_module_steps_sampled": {"default_policy": 5000.0}, "num_episodes_lifetime": -87100.0, "episode_return_max": 14.5, "episode_return_min": -5.5, "num_env_steps_sampled": 5000.0, "episode_return_mean": 9.9, "num_env_steps_sampled_lifetime": -4355000.0, "time_between_sampling": 0.012772745494052303, "num_agent_steps_sampled": {"default_agent": 5000.0}, "episode_len_max": 50, "num_agent_steps_sampled_lifetime": {"default_agent": -4355000.0}, "env_to_module_sum_episodes_length_in": 27.16809333212661, "module_episode_returns_mean": {"default_policy": 9.9}, "sample": 0.03812532926918896, "num_module_steps_sampled_lifetime": {"default_policy": -4355000.0}, "agent_episode_returns_mean": {"default_agent": 9.9}, "env_to_module_sum_episodes_length_out": 27.16809333212661, "episode_len_mean": 50.0, "num_env_steps_sampled_lifetime_throughput": 1272.0770019929037}, "learners": {"default_policy": {"vf_loss_unclipped": 8.552865982055664, "mean_kl_loss": 0.0013874161522835493, "num_module_steps_trained": 16000, "diff_num_grad_updates_vs_sampler_policy": 1.0, "vf_explained_var": 0.5428565144538879, "entropy": 0.5323108434677124, "num_trainable_parameters": 5707, "vf_loss": 0.08996252715587616, "default_optimizer_learning_rate": 0.0003313639719, "curr_kl_coeff": 7.411940714519005e-07, "num_module_steps_trained_lifetime": 320000, "total_loss": 0.05402343347668648, "gradients_default_optimizer_global_norm": 0.07414776086807251, "module_train_batch_size_mean": 1000.0, "weights_seq_no": 20.0, "curr_entropy_coeff": 0.0090570820258, "policy_loss": -0.0013230140320956707, "num_module_steps_trained_lifetime_throughput": 187727.32090308165}, "__all_modules__": {"num_module_steps_trained_lifetime": 320000, "learner_connector": {"timers": {"connectors": {"general_advantage_estimation": 0.011920208411351229, "add_time_dim_to_batch_and_zero_pad": 2.3437760337341285e-05, "batch_individual_items": 0.19537051054891594, "numpy_to_tensor": 0.00023359758811058472, "add_states_from_episodes_to_batch": 6.217405203137934e-06, "add_one_ts_to_episodes_and_truncate": 0.008906174055909061, "add_columns_from_episodes_to_train_batch": 0.07235314491629054, "add_observations_from_episodes_to_batch": 0.0008272798005054426}}, "connector_pipeline_timer": 0.29006974288989434}, "num_trainable_parameters": 5707, "learner_connector_sum_episodes_length_out": 5100.0, "num_env_steps_trained_lifetime": 1632000, "num_env_steps_trained": 81600, "learner_connector_sum_episodes_length_in": 5000.0, "num_non_trainable_parameters": 0, "num_module_steps_trained": 16000, "num_env_steps_trained_lifetime_throughput": 956696.4122919767, "num_module_steps_trained_throughput": 187865.02375517896, "num_module_steps_trained_lifetime_throughput": 187838.33853483605}}, "num_training_step_calls_per_iteration": 1, "evaluation": {"env_runners": {"module_to_env_connector": {"timers": {"connectors": {"tensor_to_numpy": 4.538074113667338e-05, "get_actions": 0.00015453697783946837, "listify_data_for_vector_env": 3.0604717470805234e-05, "normalize_and_clip_actions": 2.1878111694013498e-05, "un_batch_to_individual_items": 1.5164684239086195e-05, "remove_single_ts_time_rank_from_batch": 1.3555660764033691e-06}}, "connector_pipeline_timer": 0.00034145961301098844}, "env_to_module_sum_episodes_length_in": 27.168093332126602, "sample": 0.7363845717685193, "env_step_timer": 4.179121663140857e-05, "episode_len_min": 50, "env_to_module_connector": {"timers": {"connectors": {"add_time_dim_to_batch_and_zero_pad": 5.6546450978044836e-06, "batch_individual_items": 1.8664420494049627e-05, "numpy_to_tensor": 2.982465716265599e-05, "add_states_from_episodes_to_batch": 3.2932828743205022e-06, "add_observations_from_episodes_to_batch": 6.106755096242763e-06}}, "connector_pipeline_timer": 0.00011225130064742592}, "agent_episode_returns_mean": {"default_agent": -2.1}, "episode_return_min": -16.5, "num_agent_steps_sampled_lifetime": {"default_agent": 20000}, "env_to_module_sum_episodes_length_out": 27.168093332126602, "num_module_steps_sampled": {"default_policy": 1000}, "episode_len_mean": 50.0, "weights_seq_no": 20.0, "num_agent_steps_sampled": {"default_agent": 1000}, "num_episodes_lifetime": 400, "episode_return_max": 17.5, "module_episode_returns_mean": {"default_policy": -2.1}, "episode_return_mean": -2.1, "num_module_steps_sampled_lifetime": {"default_policy": 20000}, "env_reset_timer": 0.00022887102616452398, "rlmodule_inference_timer": 9.385962751439846e-05, "num_episodes": 20, "episode_duration_sec_mean": 0.035238832019967956, "num_env_steps_sampled_lifetime": 101000, "num_env_steps_sampled": 1000, "episode_len_max": 50, "time_between_sampling": 4.2541009934522425}, "num_healthy_workers": 1, "actor_manager_num_outstanding_async_reqs": 0, "num_remote_worker_restarts": 0}, "num_env_steps_sampled_lifetime": -4355000.0, "fault_tolerance": {"num_healthy_workers": 0, "num_remote_worker_restarts": 0}, "env_runner_group": {"actor_manager_num_outstanding_async_reqs": 0}, "done": true, "training_iteration": 20, "trial_id": "aef7a_00000", "date": "2025-08-11_17-15-29", "timestamp": 1754925329, "time_this_iter_s": 4.91715931892395, "time_total_s": 100.21898579597473, "pid": 66454, "hostname": "DESKTOP-3SK5A41", "node_ip": "192.168.40.242", "config": {"exploration_config": {}, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 6, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "env": "Umbrella", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": false, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 0, "create_local_env_runner": true, "num_envs_per_env_runner": 1, "gym_env_vectorize_mode": "SYNC", "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "episodes_to_numpy": true, "max_requests_in_flight_per_env_runner": 1, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "merge_env_runner_states": "training_only", "broadcast_env_runner_states": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "complete_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "sampler_perf_stats_ema_coef": null, "_is_online": true, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": "auto", "num_aggregator_actors_per_learner": 0, "max_requests_in_flight_per_aggregator_actor": 3, "local_gpu_idx": 0, "max_requests_in_flight_per_learner": 3, "gamma": 1, "lr": 0.0003313639719, "grad_clip": 0.5, "grad_clip_by": "global_norm", "_train_batch_size_per_learner": 5000, "train_batch_size": 4000, "num_epochs": 3, "minibatch_size": 1000, "shuffle_batch_per_epoch": true, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "log_std_clip_param": 20.0, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "_disable_preprocessor_api": false, "_disable_action_flattening": false}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "_learner_class": null, "callbacks_on_algorithm_init": null, "callbacks_on_env_runners_recreated": null, "callbacks_on_offline_eval_runners_recreated": null, "callbacks_on_checkpoint_loaded": null, "callbacks_on_environment_created": null, "callbacks_on_episode_created": null, "callbacks_on_episode_start": null, "callbacks_on_episode_step": null, "callbacks_on_episode_end": null, "callbacks_on_evaluate_start": null, "callbacks_on_evaluate_end": null, "callbacks_on_evaluate_offline_start": null, "callbacks_on_evaluate_offline_end": null, "callbacks_on_sample_end": null, "callbacks_on_train_result": null, "explore": true, "enable_rl_module_and_learner": true, "enable_env_runner_and_connector_v2": true, "_prior_exploration_config": {"type": "StochasticSampling"}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x73ae51472ac0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "offline_data_class": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_read_batch_size": null, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "materialize_data": false, "materialize_mapped_data": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "ignore_final_observation": false, "prelearner_class": null, "prelearner_buffer_class": null, "prelearner_buffer_kwargs": {}, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_remaining_data": false, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": 1, "evaluation_duration": 20, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_auto_duration_min_env_steps_per_sample": 100, "evaluation_auto_duration_max_env_steps_per_sample": 2000, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 1, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "offline_evaluation_interval": null, "num_offline_eval_runners": 0, "offline_loss_for_module_fn": null, "offline_evaluation_duration": 1, "offline_evaluation_parallel_to_training": false, "offline_evaluation_timeout_s": 120.0, "num_cpus_per_offline_eval_runner": 1, "num_gpus_per_offline_eval_runner": 0, "custom_resources_per_offline_eval_runner": {}, "restart_failed_offline_eval_runners": true, "ignore_offline_eval_runner_failures": false, "max_num_offline_eval_runner_restarts": 1000, "offline_eval_runner_restore_timeout_s": 1800.0, "max_requests_in_flight_per_offline_eval_runner": 1, "validate_offline_eval_runners_after_construction": true, "offline_eval_runner_health_probe_timeout_s": 30.0, "offline_eval_rl_module_inference_only": false, "broadcast_offline_eval_runner_states": false, "offline_eval_batch_size_per_runner": 256, "dataset_num_iters_per_eval_runner": 1, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "log_gradients": true, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 42, "restart_failed_env_runners": true, "ignore_env_runner_failures": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30.0, "env_runner_restore_timeout_s": 1800.0, "_model_config": {}, "_rl_module_spec": "RLModuleSpec(module_class=None, observation_space=None, action_space=None, inference_only=False, learner_only=False, model_config=DefaultModelConfig(fcnet_hiddens=[61, 84], fcnet_activation='tanh', fcnet_kernel_initializer=None, fcnet_kernel_initializer_kwargs=None, fcnet_bias_initializer=None, fcnet_bias_initializer_kwargs=None, conv_filters=None, conv_activation='relu', conv_kernel_initializer=None, conv_kernel_initializer_kwargs=None, conv_bias_initializer=None, conv_bias_initializer_kwargs=None, head_fcnet_hiddens=[], head_fcnet_activation='relu', head_fcnet_kernel_initializer=None, head_fcnet_kernel_initializer_kwargs=None, head_fcnet_bias_initializer=None, head_fcnet_bias_initializer_kwargs=None, free_log_std=False, log_std_clip_param=20.0, vf_share_layers=True, use_lstm=False, max_seq_len=20, lstm_cell_size=256, lstm_use_prev_action=False, lstm_use_prev_reward=False, lstm_kernel_initializer=None, lstm_kernel_initializer_kwargs=None, lstm_bias_initializer=None, lstm_bias_initializer_kwargs=None), catalog_class=None, load_state_path=None, model_config_dict=None)", "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "_validate_config": true, "_use_msgpack_checkpoints": false, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "env_task_fn": -1, "enable_connectors": -1, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.7771983355204, "kl_target": 0.026982802658, "vf_loss_coeff": 0.6688075857018, "entropy_coeff": 0.0090570820258, "clip_param": 0.1202945497339, "vf_clip_param": 0.1020987445302, "entropy_coeff_schedule": null, "lr_schedule": null, "sgd_minibatch_size": -1, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9064845981162, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.callbacks.callbacks.RLlibCallback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 100.21898579597473, "iterations_since_restore": 20, "perf": {"cpu_util_percent": 12.271428571428572, "ram_util_percent": 74.3}}
