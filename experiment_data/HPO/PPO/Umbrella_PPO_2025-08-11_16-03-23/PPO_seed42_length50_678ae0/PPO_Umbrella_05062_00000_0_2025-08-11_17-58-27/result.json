{"timers": {"training_iteration": 4.325746126999547, "restore_env_runners": 1.5300000086426735e-05, "training_step": 4.3254754270001285, "env_runner_sampling_timer": 3.855433246000757, "learner_update_timer": 0.46643968100033817, "synch_weights": 0.0014075999997658073}, "env_runners": {"env_to_module_connector": {"timers": {"connectors": {"add_time_dim_to_batch_and_zero_pad": 6.9115341080237375e-06, "add_states_from_episodes_to_batch": 3.5475364927136915e-06, "batch_individual_items": 1.9884585257564723e-05, "add_observations_from_episodes_to_batch": 6.59658458463716e-06, "numpy_to_tensor": 3.081605621793603e-05}}, "connector_pipeline_timer": 0.0001243277491999855}, "sample": 0.039225223663964075, "module_to_env_connector": {"timers": {"connectors": {"tensor_to_numpy": 4.791988753298725e-05, "listify_data_for_vector_env": 3.1323083202324416e-05, "remove_single_ts_time_rank_from_batch": 1.4211684281722953e-06, "un_batch_to_individual_items": 1.4737143691603385e-05, "normalize_and_clip_actions": 2.7739243315220917e-05, "get_actions": 0.00016762619117858938}}, "connector_pipeline_timer": 0.0003693688705769841}, "episode_duration_sec_mean": 0.03606110851998892, "num_env_steps_sampled": 5000.0, "num_module_steps_sampled_lifetime": {"default_policy": 252500.0}, "num_episodes": 100.0, "episode_len_max": 50, "num_episodes_lifetime": 5050.0, "episode_len_mean": 50.0, "env_to_module_sum_episodes_length_out": 26.762340024562445, "episode_return_max": 14.5, "num_agent_steps_sampled_lifetime": {"default_agent": 252500.0}, "module_episode_returns_mean": {"default_policy": 3.899999999999998}, "env_reset_timer": 0.000189989574707063, "env_to_module_sum_episodes_length_in": 26.762340024562445, "agent_episode_returns_mean": {"default_agent": 3.899999999999998}, "episode_len_min": 50, "episode_return_mean": 3.899999999999998, "episode_return_min": -5.5, "num_agent_steps_sampled": {"default_agent": 5000.0}, "weights_seq_no": 0.0, "num_env_steps_sampled_lifetime": 252500.0, "env_step_timer": 4.337908600367336e-05, "time_between_sampling": 0.0011920445078225847, "rlmodule_inference_timer": 0.00010444523622341882, "num_module_steps_sampled": {"default_policy": 5000.0}, "num_env_steps_sampled_lifetime_throughput": 1260.444851626977}, "learners": {"__all_modules__": {"num_env_steps_trained_lifetime": 81600, "learner_connector": {"timers": {"connectors": {"numpy_to_tensor": 0.0001599000006535789, "add_observations_from_episodes_to_batch": 0.0007386000006590621, "add_columns_from_episodes_to_train_batch": 0.06810189699990588, "general_advantage_estimation": 0.01479159999962576, "add_time_dim_to_batch_and_zero_pad": 2.119999953720253e-05, "add_states_from_episodes_to_batch": 5.99999930273043e-06, "batch_individual_items": 0.20079789200008236, "add_one_ts_to_episodes_and_truncate": 0.008473998999761534}}, "connector_pipeline_timer": 0.2934244879998005}, "num_module_steps_trained_lifetime": 16000, "num_non_trainable_parameters": 0, "num_module_steps_trained": 16000, "num_trainable_parameters": 8697, "learner_connector_sum_episodes_length_in": 5000, "learner_connector_sum_episodes_length_out": 5100, "num_env_steps_trained": 81600, "num_env_steps_trained_lifetime_throughput": 940056.2458339636, "num_module_steps_trained_throughput": 184944.37368123187, "num_module_steps_trained_lifetime_throughput": 184824.3174461995}, "default_policy": {"curr_kl_coeff": 0.15361620485782623, "gradients_default_optimizer_global_norm": 0.8064001202583313, "module_train_batch_size_mean": 1000.0, "weights_seq_no": 1.0, "mean_kl_loss": 0.414628803730011, "diff_num_grad_updates_vs_sampler_policy": 1.0, "vf_loss": 0.38853660225868225, "vf_loss_unclipped": 12.974632263183594, "total_loss": 0.4333936870098114, "curr_entropy_coeff": 0.0347123860443, "policy_loss": 0.20136642456054688, "num_module_steps_trained_lifetime": 16000, "vf_explained_var": 0.3449993133544922, "default_optimizer_learning_rate": 0.0532857353826, "entropy": 0.4567550718784332, "num_module_steps_trained": 16000, "num_trainable_parameters": 8697, "num_module_steps_trained_lifetime_throughput": 185301.88487986056}}, "num_training_step_calls_per_iteration": 1, "num_env_steps_sampled_lifetime": 252500.0, "evaluation": {"env_runners": {"env_to_module_connector": {"timers": {"connectors": {"numpy_to_tensor": 2.9161966495904194e-05, "add_observations_from_episodes_to_batch": 6.135025519064889e-06, "add_time_dim_to_batch_and_zero_pad": 5.441285004030021e-06, "batch_individual_items": 1.7808975192971046e-05, "add_states_from_episodes_to_batch": 3.341161957861062e-06}}, "connector_pipeline_timer": 0.00011496412908673897}, "num_episodes_lifetime": 20, "episode_len_mean": 50.0, "env_to_module_sum_episodes_length_out": 27.167134025045954, "module_to_env_connector": {"timers": {"connectors": {"get_actions": 0.00015312511462942414, "listify_data_for_vector_env": 3.0136397929409158e-05, "un_batch_to_individual_items": 1.5068381242420797e-05, "remove_single_ts_time_rank_from_batch": 1.4007201600230794e-06, "normalize_and_clip_actions": 2.13822269682127e-05, "tensor_to_numpy": 4.4540921907887457e-05}}, "connector_pipeline_timer": 0.0003424227350315871}, "num_module_steps_sampled_lifetime": {"default_policy": 1000}, "weights_seq_no": 1.0, "num_env_steps_sampled_lifetime": 6000, "rlmodule_inference_timer": 9.278986947098192e-05, "num_env_steps_sampled": 1000, "num_agent_steps_sampled": {"default_agent": 1000}, "episode_len_min": 50, "episode_duration_sec_mean": 0.03507885360008913, "episode_len_max": 50, "episode_return_max": 17.5, "num_module_steps_sampled": {"default_policy": 1000}, "env_to_module_sum_episodes_length_in": 27.167134025045954, "episode_return_mean": 0.1, "num_agent_steps_sampled_lifetime": {"default_agent": 1000}, "agent_episode_returns_mean": {"default_agent": 0.1}, "num_episodes": 20, "env_reset_timer": 0.00022759999956178945, "module_episode_returns_mean": {"default_policy": 0.1}, "episode_return_min": -16.5, "env_step_timer": 4.1888651108308406e-05, "sample": 0.7309107710007083}, "num_healthy_workers": 1, "actor_manager_num_outstanding_async_reqs": 0, "num_remote_worker_restarts": 0}, "fault_tolerance": {"num_healthy_workers": 0, "num_remote_worker_restarts": 0}, "env_runner_group": {"actor_manager_num_outstanding_async_reqs": 0}, "done": false, "training_iteration": 1, "trial_id": "05062_00000", "date": "2025-08-11_18-08-58", "timestamp": 1754928538, "time_this_iter_s": 5.072358131408691, "time_total_s": 5.072358131408691, "pid": 113125, "hostname": "DESKTOP-3SK5A41", "node_ip": "192.168.40.242", "config": {"exploration_config": {}, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 6, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "env": "Umbrella", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": false, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 0, "create_local_env_runner": true, "num_envs_per_env_runner": 1, "gym_env_vectorize_mode": "SYNC", "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "episodes_to_numpy": true, "max_requests_in_flight_per_env_runner": 1, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "merge_env_runner_states": "training_only", "broadcast_env_runner_states": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "complete_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "sampler_perf_stats_ema_coef": null, "_is_online": true, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": "auto", "num_aggregator_actors_per_learner": 0, "max_requests_in_flight_per_aggregator_actor": 3, "local_gpu_idx": 0, "max_requests_in_flight_per_learner": 3, "gamma": 1, "lr": 0.0532857353826, "grad_clip": 0.5, "grad_clip_by": "global_norm", "_train_batch_size_per_learner": 5000, "train_batch_size": 4000, "num_epochs": 3, "minibatch_size": 1000, "shuffle_batch_per_epoch": true, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "log_std_clip_param": 20.0, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "_disable_preprocessor_api": false, "_disable_action_flattening": false}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "_learner_class": null, "callbacks_on_algorithm_init": null, "callbacks_on_env_runners_recreated": null, "callbacks_on_offline_eval_runners_recreated": null, "callbacks_on_checkpoint_loaded": null, "callbacks_on_environment_created": null, "callbacks_on_episode_created": null, "callbacks_on_episode_start": null, "callbacks_on_episode_step": null, "callbacks_on_episode_end": null, "callbacks_on_evaluate_start": null, "callbacks_on_evaluate_end": null, "callbacks_on_evaluate_offline_start": null, "callbacks_on_evaluate_offline_end": null, "callbacks_on_sample_end": null, "callbacks_on_train_result": null, "explore": true, "enable_rl_module_and_learner": true, "enable_env_runner_and_connector_v2": true, "_prior_exploration_config": {"type": "StochasticSampling"}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x723d4b64aac0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "offline_data_class": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_read_batch_size": null, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "materialize_data": false, "materialize_mapped_data": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "ignore_final_observation": false, "prelearner_class": null, "prelearner_buffer_class": null, "prelearner_buffer_kwargs": {}, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_remaining_data": false, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": 1, "evaluation_duration": 20, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_auto_duration_min_env_steps_per_sample": 100, "evaluation_auto_duration_max_env_steps_per_sample": 2000, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 1, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "offline_evaluation_interval": null, "num_offline_eval_runners": 0, "offline_loss_for_module_fn": null, "offline_evaluation_duration": 1, "offline_evaluation_parallel_to_training": false, "offline_evaluation_timeout_s": 120.0, "num_cpus_per_offline_eval_runner": 1, "num_gpus_per_offline_eval_runner": 0, "custom_resources_per_offline_eval_runner": {}, "restart_failed_offline_eval_runners": true, "ignore_offline_eval_runner_failures": false, "max_num_offline_eval_runner_restarts": 1000, "offline_eval_runner_restore_timeout_s": 1800.0, "max_requests_in_flight_per_offline_eval_runner": 1, "validate_offline_eval_runners_after_construction": true, "offline_eval_runner_health_probe_timeout_s": 30.0, "offline_eval_rl_module_inference_only": false, "broadcast_offline_eval_runner_states": false, "offline_eval_batch_size_per_runner": 256, "dataset_num_iters_per_eval_runner": 1, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "log_gradients": true, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 42, "restart_failed_env_runners": true, "ignore_env_runner_failures": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30.0, "env_runner_restore_timeout_s": 1800.0, "_model_config": {}, "_rl_module_spec": "RLModuleSpec(module_class=None, observation_space=None, action_space=None, inference_only=False, learner_only=False, model_config=DefaultModelConfig(fcnet_hiddens=[63, 126], fcnet_activation='tanh', fcnet_kernel_initializer=None, fcnet_kernel_initializer_kwargs=None, fcnet_bias_initializer=None, fcnet_bias_initializer_kwargs=None, conv_filters=None, conv_activation='relu', conv_kernel_initializer=None, conv_kernel_initializer_kwargs=None, conv_bias_initializer=None, conv_bias_initializer_kwargs=None, head_fcnet_hiddens=[], head_fcnet_activation='relu', head_fcnet_kernel_initializer=None, head_fcnet_kernel_initializer_kwargs=None, head_fcnet_bias_initializer=None, head_fcnet_bias_initializer_kwargs=None, free_log_std=False, log_std_clip_param=20.0, vf_share_layers=True, use_lstm=False, max_seq_len=20, lstm_cell_size=256, lstm_use_prev_action=False, lstm_use_prev_reward=False, lstm_kernel_initializer=None, lstm_kernel_initializer_kwargs=None, lstm_bias_initializer=None, lstm_bias_initializer_kwargs=None), catalog_class=None, load_state_path=None, model_config_dict=None)", "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "_validate_config": true, "_use_msgpack_checkpoints": false, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "env_task_fn": -1, "enable_connectors": -1, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.1024108006331, "kl_target": 0.0216481916482, "vf_loss_coeff": 0.5287015453939, "entropy_coeff": 0.0347123860443, "clip_param": 0.1072861819248, "vf_clip_param": 0.4447244315309, "entropy_coeff_schedule": null, "lr_schedule": null, "sgd_minibatch_size": -1, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9119716444993, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.callbacks.callbacks.RLlibCallback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 5.072358131408691, "iterations_since_restore": 1, "perf": {"cpu_util_percent": 11.275, "ram_util_percent": 74.2}}
{"timers": {"training_iteration": 4.324848920949553, "restore_env_runners": 1.5387000084956527e-05, "training_step": 4.324575572950125, "env_runner_sampling_timer": 3.8567025297607507, "learner_update_timer": 0.4642685291903399, "synch_weights": 0.001408151999767142, "restore_eval_env_runners": 1.5099999473022763e-05, "evaluation_iteration": 0.7427750700007891, "synch_eval_env_connectors": 0.00047209900003508665, "synch_env_connectors": 7.900000127847306e-06}, "env_runners": {"env_to_module_connector": {"timers": {"connectors": {"add_time_dim_to_batch_and_zero_pad": 6.88996679265187e-06, "add_states_from_episodes_to_batch": 3.555992745997853e-06, "batch_individual_items": 1.871282566410146e-05, "add_observations_from_episodes_to_batch": 6.513422338835117e-06, "numpy_to_tensor": 3.113501437755798e-05}}, "connector_pipeline_timer": 0.0001215779400290499}, "sample": 0.038383978395305975, "module_to_env_connector": {"timers": {"connectors": {"tensor_to_numpy": 5.029211414389374e-05, "listify_data_for_vector_env": 3.1384672509811256e-05, "remove_single_ts_time_rank_from_batch": 1.4494394240791755e-06, "un_batch_to_individual_items": 1.4690658696876696e-05, "normalize_and_clip_actions": 2.2569697029559207e-05, "get_actions": 0.00016799457829951955}}, "connector_pipeline_timer": 0.00036736209613807725}, "episode_duration_sec_mean": 0.037225855299930125, "num_env_steps_sampled": 5000.0, "num_module_steps_sampled_lifetime": {"default_policy": 10000.0}, "num_episodes": 100.0, "episode_len_max": 50, "num_episodes_lifetime": 200.0, "episode_len_mean": 50.0, "env_to_module_sum_episodes_length_out": 27.16809333212661, "episode_return_max": 14.5, "num_agent_steps_sampled_lifetime": {"default_agent": 10000.0}, "module_episode_returns_mean": {"default_policy": -3.3}, "env_reset_timer": 0.00012897150659920618, "env_to_module_sum_episodes_length_in": 27.16809333212661, "agent_episode_returns_mean": {"default_agent": -3.3}, "episode_len_min": 50, "episode_return_mean": -3.3, "episode_return_min": -5.5, "num_agent_steps_sampled": {"default_agent": 5000.0}, "weights_seq_no": 1.0, "num_env_steps_sampled_lifetime": 10000.0, "env_step_timer": 4.370415509846097e-05, "time_between_sampling": 0.00932089943011182, "rlmodule_inference_timer": 0.00010357599934463726, "num_module_steps_sampled": {"default_policy": 5000.0}, "num_env_steps_sampled_lifetime_throughput": 1263.7983238502711}, "learners": {"__all_modules__": {"num_env_steps_trained_lifetime": 163200, "learner_connector": {"timers": {"connectors": {"numpy_to_tensor": 0.000160789000647128, "add_observations_from_episodes_to_batch": 0.0007385380006508058, "add_columns_from_episodes_to_train_batch": 0.06809274002990605, "general_advantage_estimation": 0.014774329999627299, "add_time_dim_to_batch_and_zero_pad": 2.1213999543761018e-05, "add_states_from_episodes_to_batch": 6.006999301462201e-06, "batch_individual_items": 0.1993730230800793, "add_one_ts_to_episodes_and_truncate": 0.008476086009768551}}, "connector_pipeline_timer": 0.2919759011198039}, "num_module_steps_trained_lifetime": 32000, "num_non_trainable_parameters": 0, "num_module_steps_trained": 16000, "num_trainable_parameters": 8697, "learner_connector_sum_episodes_length_in": 5000.0, "learner_connector_sum_episodes_length_out": 5100.0, "num_env_steps_trained": 81600, "num_env_steps_trained_lifetime_throughput": 936138.933559909, "num_module_steps_trained_throughput": 184160.03976501303, "num_module_steps_trained_lifetime_throughput": 184043.3829779772}, "default_policy": {"curr_kl_coeff": 0.23042431473731995, "gradients_default_optimizer_global_norm": 1.6289957761764526, "module_train_batch_size_mean": 1000.0, "weights_seq_no": 2.0, "mean_kl_loss": 0.0595250278711319, "diff_num_grad_updates_vs_sampler_policy": 1.0, "vf_loss": 0.425763338804245, "vf_loss_unclipped": 9.507091522216797, "total_loss": 0.3108268082141876, "curr_entropy_coeff": 0.0347123860443, "policy_loss": 0.09831461310386658, "num_module_steps_trained_lifetime": 32000, "vf_explained_var": 0.17542046308517456, "default_optimizer_learning_rate": 0.0532857353826, "entropy": 0.626102089881897, "num_module_steps_trained": 16000, "num_trainable_parameters": 8697, "num_module_steps_trained_lifetime_throughput": 184505.79917840258}}, "num_training_step_calls_per_iteration": 1, "evaluation": {"env_runners": {"env_to_module_connector": {"timers": {"connectors": {"numpy_to_tensor": 2.9266417713464476e-05, "add_observations_from_episodes_to_batch": 6.269753964668942e-06, "add_time_dim_to_batch_and_zero_pad": 5.369430921916151e-06, "batch_individual_items": 1.7695810773603287e-05, "add_states_from_episodes_to_batch": 3.2403936028402827e-06}}, "connector_pipeline_timer": 0.00011461460393855273}, "num_episodes_lifetime": 40, "episode_len_mean": 50.0, "env_to_module_sum_episodes_length_out": 27.168093298253442, "module_to_env_connector": {"timers": {"connectors": {"get_actions": 0.0001525759429514793, "listify_data_for_vector_env": 3.1016798916016034e-05, "un_batch_to_individual_items": 1.4753975864814222e-05, "remove_single_ts_time_rank_from_batch": 1.3869255688496052e-06, "normalize_and_clip_actions": 2.185863616850854e-05, "tensor_to_numpy": 4.476832525886371e-05}}, "connector_pipeline_timer": 0.0003440814246499373}, "num_module_steps_sampled_lifetime": {"default_policy": 2000}, "weights_seq_no": 2.0, "num_env_steps_sampled_lifetime": 11000, "rlmodule_inference_timer": 9.388153330957535e-05, "num_env_steps_sampled": 1000, "num_agent_steps_sampled": {"default_agent": 1000}, "episode_len_min": 50, "episode_duration_sec_mean": 0.0356717618250741, "episode_len_max": 50, "episode_return_max": 17.5, "num_module_steps_sampled": {"default_policy": 1000}, "env_to_module_sum_episodes_length_in": 27.168093298253442, "episode_return_mean": 0.1, "num_agent_steps_sampled_lifetime": {"default_agent": 2000}, "agent_episode_returns_mean": {"default_agent": 0.1}, "num_episodes": 20, "env_reset_timer": 0.00022669099956146963, "module_episode_returns_mean": {"default_policy": 0.1}, "episode_return_min": -16.5, "env_step_timer": 4.155467812019343e-05, "sample": 0.7311531983007081, "time_between_sampling": 4.29407331999937}, "num_healthy_workers": 1, "actor_manager_num_outstanding_async_reqs": 0, "num_remote_worker_restarts": 0}, "num_env_steps_sampled_lifetime": 10000.0, "fault_tolerance": {"num_healthy_workers": 0, "num_remote_worker_restarts": 0}, "env_runner_group": {"actor_manager_num_outstanding_async_reqs": 0}, "done": false, "training_iteration": 2, "trial_id": "05062_00000", "date": "2025-08-11_18-09-03", "timestamp": 1754928543, "time_this_iter_s": 5.005870342254639, "time_total_s": 10.07822847366333, "pid": 113125, "hostname": "DESKTOP-3SK5A41", "node_ip": "192.168.40.242", "config": {"exploration_config": {}, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 6, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "env": "Umbrella", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": false, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 0, "create_local_env_runner": true, "num_envs_per_env_runner": 1, "gym_env_vectorize_mode": "SYNC", "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "episodes_to_numpy": true, "max_requests_in_flight_per_env_runner": 1, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "merge_env_runner_states": "training_only", "broadcast_env_runner_states": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "complete_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "sampler_perf_stats_ema_coef": null, "_is_online": true, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": "auto", "num_aggregator_actors_per_learner": 0, "max_requests_in_flight_per_aggregator_actor": 3, "local_gpu_idx": 0, "max_requests_in_flight_per_learner": 3, "gamma": 1, "lr": 0.0532857353826, "grad_clip": 0.5, "grad_clip_by": "global_norm", "_train_batch_size_per_learner": 5000, "train_batch_size": 4000, "num_epochs": 3, "minibatch_size": 1000, "shuffle_batch_per_epoch": true, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "log_std_clip_param": 20.0, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "_disable_preprocessor_api": false, "_disable_action_flattening": false}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "_learner_class": null, "callbacks_on_algorithm_init": null, "callbacks_on_env_runners_recreated": null, "callbacks_on_offline_eval_runners_recreated": null, "callbacks_on_checkpoint_loaded": null, "callbacks_on_environment_created": null, "callbacks_on_episode_created": null, "callbacks_on_episode_start": null, "callbacks_on_episode_step": null, "callbacks_on_episode_end": null, "callbacks_on_evaluate_start": null, "callbacks_on_evaluate_end": null, "callbacks_on_evaluate_offline_start": null, "callbacks_on_evaluate_offline_end": null, "callbacks_on_sample_end": null, "callbacks_on_train_result": null, "explore": true, "enable_rl_module_and_learner": true, "enable_env_runner_and_connector_v2": true, "_prior_exploration_config": {"type": "StochasticSampling"}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x723d4b64aac0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "offline_data_class": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_read_batch_size": null, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "materialize_data": false, "materialize_mapped_data": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "ignore_final_observation": false, "prelearner_class": null, "prelearner_buffer_class": null, "prelearner_buffer_kwargs": {}, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_remaining_data": false, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": 1, "evaluation_duration": 20, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_auto_duration_min_env_steps_per_sample": 100, "evaluation_auto_duration_max_env_steps_per_sample": 2000, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 1, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "offline_evaluation_interval": null, "num_offline_eval_runners": 0, "offline_loss_for_module_fn": null, "offline_evaluation_duration": 1, "offline_evaluation_parallel_to_training": false, "offline_evaluation_timeout_s": 120.0, "num_cpus_per_offline_eval_runner": 1, "num_gpus_per_offline_eval_runner": 0, "custom_resources_per_offline_eval_runner": {}, "restart_failed_offline_eval_runners": true, "ignore_offline_eval_runner_failures": false, "max_num_offline_eval_runner_restarts": 1000, "offline_eval_runner_restore_timeout_s": 1800.0, "max_requests_in_flight_per_offline_eval_runner": 1, "validate_offline_eval_runners_after_construction": true, "offline_eval_runner_health_probe_timeout_s": 30.0, "offline_eval_rl_module_inference_only": false, "broadcast_offline_eval_runner_states": false, "offline_eval_batch_size_per_runner": 256, "dataset_num_iters_per_eval_runner": 1, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "log_gradients": true, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 42, "restart_failed_env_runners": true, "ignore_env_runner_failures": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30.0, "env_runner_restore_timeout_s": 1800.0, "_model_config": {}, "_rl_module_spec": "RLModuleSpec(module_class=None, observation_space=None, action_space=None, inference_only=False, learner_only=False, model_config=DefaultModelConfig(fcnet_hiddens=[63, 126], fcnet_activation='tanh', fcnet_kernel_initializer=None, fcnet_kernel_initializer_kwargs=None, fcnet_bias_initializer=None, fcnet_bias_initializer_kwargs=None, conv_filters=None, conv_activation='relu', conv_kernel_initializer=None, conv_kernel_initializer_kwargs=None, conv_bias_initializer=None, conv_bias_initializer_kwargs=None, head_fcnet_hiddens=[], head_fcnet_activation='relu', head_fcnet_kernel_initializer=None, head_fcnet_kernel_initializer_kwargs=None, head_fcnet_bias_initializer=None, head_fcnet_bias_initializer_kwargs=None, free_log_std=False, log_std_clip_param=20.0, vf_share_layers=True, use_lstm=False, max_seq_len=20, lstm_cell_size=256, lstm_use_prev_action=False, lstm_use_prev_reward=False, lstm_kernel_initializer=None, lstm_kernel_initializer_kwargs=None, lstm_bias_initializer=None, lstm_bias_initializer_kwargs=None), catalog_class=None, load_state_path=None, model_config_dict=None)", "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "_validate_config": true, "_use_msgpack_checkpoints": false, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "env_task_fn": -1, "enable_connectors": -1, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.1024108006331, "kl_target": 0.0216481916482, "vf_loss_coeff": 0.5287015453939, "entropy_coeff": 0.0347123860443, "clip_param": 0.1072861819248, "vf_clip_param": 0.4447244315309, "entropy_coeff_schedule": null, "lr_schedule": null, "sgd_minibatch_size": -1, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9119716444993, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.callbacks.callbacks.RLlibCallback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 10.07822847366333, "iterations_since_restore": 2, "perf": {"cpu_util_percent": 13.457142857142856, "ram_util_percent": 74.39999999999999}}
{"timers": {"training_iteration": 4.3250983438100645, "restore_env_runners": 1.5373130086027233e-05, "training_step": 4.3248240322906195, "env_runner_sampling_timer": 3.859173759533141, "learner_update_timer": 0.46204511289843825, "synch_weights": 0.001407944479766047, "restore_eval_env_runners": 1.508599947555922e-05, "evaluation_iteration": 0.7429981653107824, "synch_eval_env_connectors": 0.0004718270100420341, "synch_env_connectors": 7.897000123193721e-06}, "env_runners": {"env_to_module_connector": {"timers": {"connectors": {"add_time_dim_to_batch_and_zero_pad": 6.936721615793018e-06, "add_states_from_episodes_to_batch": 3.5820846139542846e-06, "batch_individual_items": 1.8646568495427024e-05, "add_observations_from_episodes_to_batch": 6.550180716153414e-06, "numpy_to_tensor": 3.130857691950641e-05}}, "connector_pipeline_timer": 0.00012172367782178694}, "sample": 0.03869414131039686, "module_to_env_connector": {"timers": {"connectors": {"tensor_to_numpy": 5.019386305074684e-05, "listify_data_for_vector_env": 3.1142582720297045e-05, "remove_single_ts_time_rank_from_batch": 1.454207377552186e-06, "un_batch_to_individual_items": 1.455474788092788e-05, "normalize_and_clip_actions": 2.243141984005754e-05, "get_actions": 0.00016807078664086547}}, "connector_pipeline_timer": 0.0003664066406458145}, "episode_duration_sec_mean": 0.03847534207004172, "num_env_steps_sampled": 5000.0, "num_module_steps_sampled_lifetime": {"default_policy": -232500.0}, "num_episodes": 100.0, "episode_len_max": 50, "num_episodes_lifetime": -4650.0, "episode_len_mean": 50.0, "env_to_module_sum_episodes_length_out": 27.16809333212661, "episode_return_max": 14.5, "num_agent_steps_sampled_lifetime": {"default_agent": -232500.0}, "module_episode_returns_mean": {"default_policy": 1.9}, "env_reset_timer": 0.00010739283440483268, "env_to_module_sum_episodes_length_in": 27.16809333212661, "agent_episode_returns_mean": {"default_agent": 1.9}, "episode_len_min": 50, "episode_return_mean": 1.9, "episode_return_min": -5.5, "num_agent_steps_sampled": {"default_agent": 5000.0}, "weights_seq_no": 2.0, "num_env_steps_sampled_lifetime": -232500.0, "env_step_timer": 4.280762589097367e-05, "time_between_sampling": 0.011112907343834735, "rlmodule_inference_timer": 0.0001371783395946751, "num_module_steps_sampled": {"default_policy": 5000.0}, "num_env_steps_sampled_lifetime_throughput": 1254.9815427601143}, "learners": {"__all_modules__": {"num_env_steps_trained_lifetime": 244800, "learner_connector": {"timers": {"connectors": {"numpy_to_tensor": 0.00016078011063809755, "add_observations_from_episodes_to_batch": 0.0007381726206470375, "add_columns_from_episodes_to_train_batch": 0.06808198162961153, "general_advantage_estimation": 0.01473775469962502, "add_time_dim_to_batch_and_zero_pad": 2.1265859548566367e-05, "add_states_from_episodes_to_batch": 6.005929312050284e-06, "batch_individual_items": 0.19795616384928144, "add_one_ts_to_episodes_and_truncate": 0.008477917149668703}}, "connector_pipeline_timer": 0.29051308510860874}, "num_module_steps_trained_lifetime": 48000, "num_non_trainable_parameters": 0, "num_module_steps_trained": 16000, "num_trainable_parameters": 8697, "learner_connector_sum_episodes_length_in": 5000.0, "learner_connector_sum_episodes_length_out": 5100.0, "num_env_steps_trained": 81600, "num_env_steps_trained_lifetime_throughput": 932993.7579692965, "num_module_steps_trained_throughput": 183519.65120794816, "num_module_steps_trained_lifetime_throughput": 183406.43227132718}, "default_policy": {"curr_kl_coeff": 0.3456364870071411, "gradients_default_optimizer_global_norm": 1.0347273349761963, "module_train_batch_size_mean": 1000.0, "weights_seq_no": 3.0, "mean_kl_loss": 0.04780231788754463, "diff_num_grad_updates_vs_sampler_policy": 1.0, "vf_loss": 0.42533811926841736, "vf_loss_unclipped": 15.631722450256348, "total_loss": 0.28109487891197205, "curr_entropy_coeff": 0.0347123860443, "policy_loss": 0.06342668831348419, "num_module_steps_trained_lifetime": 48000, "vf_explained_var": 0.21717774868011475, "default_optimizer_learning_rate": 0.0532857353826, "entropy": 0.5249860882759094, "num_module_steps_trained": 16000, "num_trainable_parameters": 8697, "num_module_steps_trained_lifetime_throughput": 183848.8498854112}}, "num_training_step_calls_per_iteration": 1, "evaluation": {"env_runners": {"env_to_module_connector": {"timers": {"connectors": {"numpy_to_tensor": 2.8778079162929624e-05, "add_observations_from_episodes_to_batch": 6.2428758499999325e-06, "add_time_dim_to_batch_and_zero_pad": 5.447788504764899e-06, "batch_individual_items": 1.745472257356927e-05, "add_states_from_episodes_to_batch": 3.376082367681664e-06}}, "connector_pipeline_timer": 0.00011430768814834552}, "num_episodes_lifetime": 60, "episode_len_mean": 50.0, "env_to_module_sum_episodes_length_out": 27.168093332125434, "module_to_env_connector": {"timers": {"connectors": {"get_actions": 0.0001495229426058352, "listify_data_for_vector_env": 3.080061111942015e-05, "un_batch_to_individual_items": 1.4782448195853754e-05, "remove_single_ts_time_rank_from_batch": 1.3633144644640498e-06, "normalize_and_clip_actions": 2.15194494241844e-05, "tensor_to_numpy": 4.383524930617407e-05}}, "connector_pipeline_timer": 0.00033828570070314505}, "num_module_steps_sampled_lifetime": {"default_policy": 3000}, "weights_seq_no": 3.0, "num_env_steps_sampled_lifetime": 16000, "rlmodule_inference_timer": 9.257953295293613e-05, "num_env_steps_sampled": 1000, "num_agent_steps_sampled": {"default_agent": 1000}, "episode_len_min": 50, "episode_duration_sec_mean": 0.03533654456671987, "episode_len_max": 50, "episode_return_max": 17.5, "num_module_steps_sampled": {"default_policy": 1000}, "env_to_module_sum_episodes_length_in": 27.168093332125434, "episode_return_mean": 0.7666666666666667, "num_agent_steps_sampled_lifetime": {"default_agent": 3000}, "agent_episode_returns_mean": {"default_agent": 0.7666666666666667}, "num_episodes": 20, "env_reset_timer": 0.00022571608957214264, "module_episode_returns_mean": {"default_policy": 0.7666666666666667}, "episode_return_min": -16.5, "env_step_timer": 4.078123414844079e-05, "sample": 0.731052296327696, "time_between_sampling": 4.295199588869373}, "num_healthy_workers": 1, "actor_manager_num_outstanding_async_reqs": 0, "num_remote_worker_restarts": 0}, "num_env_steps_sampled_lifetime": -232500.0, "fault_tolerance": {"num_healthy_workers": 0, "num_remote_worker_restarts": 0}, "env_runner_group": {"actor_manager_num_outstanding_async_reqs": 0}, "done": false, "training_iteration": 3, "trial_id": "05062_00000", "date": "2025-08-11_18-09-09", "timestamp": 1754928549, "time_this_iter_s": 5.085310220718384, "time_total_s": 15.163538694381714, "pid": 113125, "hostname": "DESKTOP-3SK5A41", "node_ip": "192.168.40.242", "config": {"exploration_config": {}, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 6, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "env": "Umbrella", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": false, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 0, "create_local_env_runner": true, "num_envs_per_env_runner": 1, "gym_env_vectorize_mode": "SYNC", "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "episodes_to_numpy": true, "max_requests_in_flight_per_env_runner": 1, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "merge_env_runner_states": "training_only", "broadcast_env_runner_states": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "complete_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "sampler_perf_stats_ema_coef": null, "_is_online": true, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": "auto", "num_aggregator_actors_per_learner": 0, "max_requests_in_flight_per_aggregator_actor": 3, "local_gpu_idx": 0, "max_requests_in_flight_per_learner": 3, "gamma": 1, "lr": 0.0532857353826, "grad_clip": 0.5, "grad_clip_by": "global_norm", "_train_batch_size_per_learner": 5000, "train_batch_size": 4000, "num_epochs": 3, "minibatch_size": 1000, "shuffle_batch_per_epoch": true, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "log_std_clip_param": 20.0, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "_disable_preprocessor_api": false, "_disable_action_flattening": false}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "_learner_class": null, "callbacks_on_algorithm_init": null, "callbacks_on_env_runners_recreated": null, "callbacks_on_offline_eval_runners_recreated": null, "callbacks_on_checkpoint_loaded": null, "callbacks_on_environment_created": null, "callbacks_on_episode_created": null, "callbacks_on_episode_start": null, "callbacks_on_episode_step": null, "callbacks_on_episode_end": null, "callbacks_on_evaluate_start": null, "callbacks_on_evaluate_end": null, "callbacks_on_evaluate_offline_start": null, "callbacks_on_evaluate_offline_end": null, "callbacks_on_sample_end": null, "callbacks_on_train_result": null, "explore": true, "enable_rl_module_and_learner": true, "enable_env_runner_and_connector_v2": true, "_prior_exploration_config": {"type": "StochasticSampling"}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x723d4b64aac0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "offline_data_class": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_read_batch_size": null, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "materialize_data": false, "materialize_mapped_data": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "ignore_final_observation": false, "prelearner_class": null, "prelearner_buffer_class": null, "prelearner_buffer_kwargs": {}, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_remaining_data": false, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": 1, "evaluation_duration": 20, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_auto_duration_min_env_steps_per_sample": 100, "evaluation_auto_duration_max_env_steps_per_sample": 2000, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 1, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "offline_evaluation_interval": null, "num_offline_eval_runners": 0, "offline_loss_for_module_fn": null, "offline_evaluation_duration": 1, "offline_evaluation_parallel_to_training": false, "offline_evaluation_timeout_s": 120.0, "num_cpus_per_offline_eval_runner": 1, "num_gpus_per_offline_eval_runner": 0, "custom_resources_per_offline_eval_runner": {}, "restart_failed_offline_eval_runners": true, "ignore_offline_eval_runner_failures": false, "max_num_offline_eval_runner_restarts": 1000, "offline_eval_runner_restore_timeout_s": 1800.0, "max_requests_in_flight_per_offline_eval_runner": 1, "validate_offline_eval_runners_after_construction": true, "offline_eval_runner_health_probe_timeout_s": 30.0, "offline_eval_rl_module_inference_only": false, "broadcast_offline_eval_runner_states": false, "offline_eval_batch_size_per_runner": 256, "dataset_num_iters_per_eval_runner": 1, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "log_gradients": true, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 42, "restart_failed_env_runners": true, "ignore_env_runner_failures": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30.0, "env_runner_restore_timeout_s": 1800.0, "_model_config": {}, "_rl_module_spec": "RLModuleSpec(module_class=None, observation_space=None, action_space=None, inference_only=False, learner_only=False, model_config=DefaultModelConfig(fcnet_hiddens=[63, 126], fcnet_activation='tanh', fcnet_kernel_initializer=None, fcnet_kernel_initializer_kwargs=None, fcnet_bias_initializer=None, fcnet_bias_initializer_kwargs=None, conv_filters=None, conv_activation='relu', conv_kernel_initializer=None, conv_kernel_initializer_kwargs=None, conv_bias_initializer=None, conv_bias_initializer_kwargs=None, head_fcnet_hiddens=[], head_fcnet_activation='relu', head_fcnet_kernel_initializer=None, head_fcnet_kernel_initializer_kwargs=None, head_fcnet_bias_initializer=None, head_fcnet_bias_initializer_kwargs=None, free_log_std=False, log_std_clip_param=20.0, vf_share_layers=True, use_lstm=False, max_seq_len=20, lstm_cell_size=256, lstm_use_prev_action=False, lstm_use_prev_reward=False, lstm_kernel_initializer=None, lstm_kernel_initializer_kwargs=None, lstm_bias_initializer=None, lstm_bias_initializer_kwargs=None), catalog_class=None, load_state_path=None, model_config_dict=None)", "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "_validate_config": true, "_use_msgpack_checkpoints": false, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "env_task_fn": -1, "enable_connectors": -1, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.1024108006331, "kl_target": 0.0216481916482, "vf_loss_coeff": 0.5287015453939, "entropy_coeff": 0.0347123860443, "clip_param": 0.1072861819248, "vf_clip_param": 0.4447244315309, "entropy_coeff_schedule": null, "lr_schedule": null, "sgd_minibatch_size": -1, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9119716444993, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.callbacks.callbacks.RLlibCallback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 15.163538694381714, "iterations_since_restore": 3, "perf": {"cpu_util_percent": 14.385714285714284, "ram_util_percent": 70.60000000000001}}
{"timers": {"training_iteration": 4.324798594371966, "restore_env_runners": 1.5352398788355458e-05, "training_step": 4.324523114967711, "env_runner_sampling_timer": 3.8596218749378046, "learner_update_timer": 0.4612959657694577, "synch_weights": 0.0014076100349649475, "restore_eval_env_runners": 1.5061139485260356e-05, "evaluation_iteration": 0.7428723386676716, "synch_eval_env_connectors": 0.0004712837399452838, "synch_env_connectors": 7.888030118374447e-06}, "env_runners": {"env_to_module_connector": {"timers": {"connectors": {"add_time_dim_to_batch_and_zero_pad": 6.751898780998983e-06, "add_states_from_episodes_to_batch": 3.476363364084213e-06, "batch_individual_items": 1.8481437562153565e-05, "add_observations_from_episodes_to_batch": 6.357391435005509e-06, "numpy_to_tensor": 3.0505280477847934e-05}}, "connector_pipeline_timer": 0.00011966238509255792}, "sample": 0.038538462741542136, "module_to_env_connector": {"timers": {"connectors": {"tensor_to_numpy": 4.962617878974724e-05, "listify_data_for_vector_env": 3.0685492899951033e-05, "remove_single_ts_time_rank_from_batch": 1.4268682031144509e-06, "un_batch_to_individual_items": 1.4463962609603134e-05, "normalize_and_clip_actions": 2.204331243135675e-05, "get_actions": 0.00016489829830686992}}, "connector_pipeline_timer": 0.0003609565393445051}, "episode_duration_sec_mean": 0.036496612999962964, "num_env_steps_sampled": 5000.0, "num_module_steps_sampled_lifetime": {"default_policy": -475000.0}, "num_episodes": 100.0, "episode_len_max": 50, "num_episodes_lifetime": -9500.0, "episode_len_mean": 50.0, "env_to_module_sum_episodes_length_out": 27.16809333212661, "episode_return_max": 14.5, "num_agent_steps_sampled_lifetime": {"default_agent": -475000.0}, "module_episode_returns_mean": {"default_policy": 6.299999999999996}, "env_reset_timer": 9.632799550801055e-05, "env_to_module_sum_episodes_length_in": 27.16809333212661, "agent_episode_returns_mean": {"default_agent": 6.299999999999996}, "episode_len_min": 50, "episode_return_mean": 6.299999999999996, "episode_return_min": -5.5, "num_agent_steps_sampled": {"default_agent": 5000.0}, "weights_seq_no": 3.0, "num_env_steps_sampled_lifetime": -475000.0, "env_step_timer": 4.241503024863818e-05, "time_between_sampling": 0.011482703935977381, "rlmodule_inference_timer": 0.00010173523481777986, "num_module_steps_sampled": {"default_policy": 5000.0}, "num_env_steps_sampled_lifetime_throughput": 1277.5375807474272}, "learners": {"__all_modules__": {"num_env_steps_trained_lifetime": 326400, "learner_connector": {"timers": {"connectors": {"numpy_to_tensor": 0.0001610603095287688, "add_observations_from_episodes_to_batch": 0.0007380218944401595, "add_columns_from_episodes_to_train_batch": 0.06806411381331783, "general_advantage_estimation": 0.014708683152632709, "add_time_dim_to_batch_and_zero_pad": 2.1275200951838085e-05, "add_states_from_episodes_to_batch": 6.011870021264257e-06, "batch_individual_items": 0.19799875321078966, "add_one_ts_to_episodes_and_truncate": 0.008475205978173543}}, "connector_pipeline_timer": 0.29050574325752143}, "num_module_steps_trained_lifetime": 64000, "num_non_trainable_parameters": 0, "num_module_steps_trained": 16000, "num_trainable_parameters": 8697, "learner_connector_sum_episodes_length_in": 5000.0, "learner_connector_sum_episodes_length_out": 5100.0, "num_env_steps_trained": 81600, "num_env_steps_trained_lifetime_throughput": 928915.1726559858, "num_module_steps_trained_throughput": 182695.21005694487, "num_module_steps_trained_lifetime_throughput": 182586.6138903752}, "default_policy": {"curr_kl_coeff": 0.3456364870071411, "gradients_default_optimizer_global_norm": 0.8331597447395325, "module_train_batch_size_mean": 1000.0, "weights_seq_no": 4.0, "mean_kl_loss": 0.04286477342247963, "diff_num_grad_updates_vs_sampler_policy": 1.0, "vf_loss": 0.44472458958625793, "vf_loss_unclipped": 21.26962661743164, "total_loss": 0.27123963832855225, "curr_entropy_coeff": 0.0347123860443, "policy_loss": 0.03717781975865364, "num_module_steps_trained_lifetime": 64000, "vf_explained_var": 0.1416475772857666, "default_optimizer_learning_rate": 0.0532857353826, "entropy": 0.45748305320739746, "num_module_steps_trained": 16000, "num_trainable_parameters": 8697, "num_module_steps_trained_lifetime_throughput": 183006.34607038938}}, "num_training_step_calls_per_iteration": 1, "evaluation": {"env_runners": {"env_to_module_connector": {"timers": {"connectors": {"numpy_to_tensor": 2.8690507558139914e-05, "add_observations_from_episodes_to_batch": 6.321383023401589e-06, "add_time_dim_to_batch_and_zero_pad": 5.316987843738961e-06, "batch_individual_items": 1.740517287398254e-05, "add_states_from_episodes_to_batch": 3.2921809862969226e-06}}, "connector_pipeline_timer": 0.00011378970798375088}, "num_episodes_lifetime": 80, "episode_len_mean": 50.0, "env_to_module_sum_episodes_length_out": 27.168093332126602, "module_to_env_connector": {"timers": {"connectors": {"get_actions": 0.00015062767885597983, "listify_data_for_vector_env": 3.068112580575434e-05, "un_batch_to_individual_items": 1.4902566284793303e-05, "remove_single_ts_time_rank_from_batch": 1.3909424901881106e-06, "normalize_and_clip_actions": 2.1376349128890315e-05, "tensor_to_numpy": 4.390114242090731e-05}}, "connector_pipeline_timer": 0.00033949160554645026}, "num_module_steps_sampled_lifetime": {"default_policy": 4000}, "weights_seq_no": 4.0, "num_env_steps_sampled_lifetime": 21000, "rlmodule_inference_timer": 9.399237020386205e-05, "num_env_steps_sampled": 1000, "num_agent_steps_sampled": {"default_agent": 1000}, "episode_len_min": 50, "episode_duration_sec_mean": 0.0352059534250543, "episode_len_max": 50, "episode_return_max": 17.5, "num_module_steps_sampled": {"default_policy": 1000}, "env_to_module_sum_episodes_length_in": 27.168093332126602, "episode_return_mean": -0.15, "num_agent_steps_sampled_lifetime": {"default_agent": 4000}, "agent_episode_returns_mean": {"default_agent": -0.15}, "num_episodes": 20, "env_reset_timer": 0.00022476292868313337, "module_episode_returns_mean": {"default_policy": -0.15}, "episode_return_min": -16.5, "env_step_timer": 4.117538631848985e-05, "sample": 0.7309833493644158, "time_between_sampling": 4.295741569980677}, "num_healthy_workers": 1, "actor_manager_num_outstanding_async_reqs": 0, "num_remote_worker_restarts": 0}, "num_env_steps_sampled_lifetime": -475000.0, "fault_tolerance": {"num_healthy_workers": 0, "num_remote_worker_restarts": 0}, "env_runner_group": {"actor_manager_num_outstanding_async_reqs": 0}, "done": false, "training_iteration": 4, "trial_id": "05062_00000", "date": "2025-08-11_18-09-14", "timestamp": 1754928554, "time_this_iter_s": 5.034006357192993, "time_total_s": 20.197545051574707, "pid": 113125, "hostname": "DESKTOP-3SK5A41", "node_ip": "192.168.40.242", "config": {"exploration_config": {}, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 6, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "env": "Umbrella", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": false, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 0, "create_local_env_runner": true, "num_envs_per_env_runner": 1, "gym_env_vectorize_mode": "SYNC", "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "episodes_to_numpy": true, "max_requests_in_flight_per_env_runner": 1, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "merge_env_runner_states": "training_only", "broadcast_env_runner_states": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "complete_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "sampler_perf_stats_ema_coef": null, "_is_online": true, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": "auto", "num_aggregator_actors_per_learner": 0, "max_requests_in_flight_per_aggregator_actor": 3, "local_gpu_idx": 0, "max_requests_in_flight_per_learner": 3, "gamma": 1, "lr": 0.0532857353826, "grad_clip": 0.5, "grad_clip_by": "global_norm", "_train_batch_size_per_learner": 5000, "train_batch_size": 4000, "num_epochs": 3, "minibatch_size": 1000, "shuffle_batch_per_epoch": true, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "log_std_clip_param": 20.0, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "_disable_preprocessor_api": false, "_disable_action_flattening": false}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "_learner_class": null, "callbacks_on_algorithm_init": null, "callbacks_on_env_runners_recreated": null, "callbacks_on_offline_eval_runners_recreated": null, "callbacks_on_checkpoint_loaded": null, "callbacks_on_environment_created": null, "callbacks_on_episode_created": null, "callbacks_on_episode_start": null, "callbacks_on_episode_step": null, "callbacks_on_episode_end": null, "callbacks_on_evaluate_start": null, "callbacks_on_evaluate_end": null, "callbacks_on_evaluate_offline_start": null, "callbacks_on_evaluate_offline_end": null, "callbacks_on_sample_end": null, "callbacks_on_train_result": null, "explore": true, "enable_rl_module_and_learner": true, "enable_env_runner_and_connector_v2": true, "_prior_exploration_config": {"type": "StochasticSampling"}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x723d4b64aac0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "offline_data_class": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_read_batch_size": null, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "materialize_data": false, "materialize_mapped_data": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "ignore_final_observation": false, "prelearner_class": null, "prelearner_buffer_class": null, "prelearner_buffer_kwargs": {}, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_remaining_data": false, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": 1, "evaluation_duration": 20, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_auto_duration_min_env_steps_per_sample": 100, "evaluation_auto_duration_max_env_steps_per_sample": 2000, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 1, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "offline_evaluation_interval": null, "num_offline_eval_runners": 0, "offline_loss_for_module_fn": null, "offline_evaluation_duration": 1, "offline_evaluation_parallel_to_training": false, "offline_evaluation_timeout_s": 120.0, "num_cpus_per_offline_eval_runner": 1, "num_gpus_per_offline_eval_runner": 0, "custom_resources_per_offline_eval_runner": {}, "restart_failed_offline_eval_runners": true, "ignore_offline_eval_runner_failures": false, "max_num_offline_eval_runner_restarts": 1000, "offline_eval_runner_restore_timeout_s": 1800.0, "max_requests_in_flight_per_offline_eval_runner": 1, "validate_offline_eval_runners_after_construction": true, "offline_eval_runner_health_probe_timeout_s": 30.0, "offline_eval_rl_module_inference_only": false, "broadcast_offline_eval_runner_states": false, "offline_eval_batch_size_per_runner": 256, "dataset_num_iters_per_eval_runner": 1, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "log_gradients": true, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 42, "restart_failed_env_runners": true, "ignore_env_runner_failures": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30.0, "env_runner_restore_timeout_s": 1800.0, "_model_config": {}, "_rl_module_spec": "RLModuleSpec(module_class=None, observation_space=None, action_space=None, inference_only=False, learner_only=False, model_config=DefaultModelConfig(fcnet_hiddens=[63, 126], fcnet_activation='tanh', fcnet_kernel_initializer=None, fcnet_kernel_initializer_kwargs=None, fcnet_bias_initializer=None, fcnet_bias_initializer_kwargs=None, conv_filters=None, conv_activation='relu', conv_kernel_initializer=None, conv_kernel_initializer_kwargs=None, conv_bias_initializer=None, conv_bias_initializer_kwargs=None, head_fcnet_hiddens=[], head_fcnet_activation='relu', head_fcnet_kernel_initializer=None, head_fcnet_kernel_initializer_kwargs=None, head_fcnet_bias_initializer=None, head_fcnet_bias_initializer_kwargs=None, free_log_std=False, log_std_clip_param=20.0, vf_share_layers=True, use_lstm=False, max_seq_len=20, lstm_cell_size=256, lstm_use_prev_action=False, lstm_use_prev_reward=False, lstm_kernel_initializer=None, lstm_kernel_initializer_kwargs=None, lstm_bias_initializer=None, lstm_bias_initializer_kwargs=None), catalog_class=None, load_state_path=None, model_config_dict=None)", "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "_validate_config": true, "_use_msgpack_checkpoints": false, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "env_task_fn": -1, "enable_connectors": -1, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.1024108006331, "kl_target": 0.0216481916482, "vf_loss_coeff": 0.5287015453939, "entropy_coeff": 0.0347123860443, "clip_param": 0.1072861819248, "vf_clip_param": 0.4447244315309, "entropy_coeff_schedule": null, "lr_schedule": null, "sgd_minibatch_size": -1, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9119716444993, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.callbacks.callbacks.RLlibCallback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 20.197545051574707, "iterations_since_restore": 4, "perf": {"cpu_util_percent": 12.642857142857142, "ram_util_percent": 69.97142857142858}}
{"timers": {"training_iteration": 4.323306288458247, "restore_env_runners": 1.541287480197797e-05, "training_step": 4.323027565848038, "env_runner_sampling_timer": 3.860373632218421, "learner_update_timer": 0.45904476111176484, "synch_weights": 0.0014117089346200012, "restore_eval_env_runners": 1.5062528083657526e-05, "evaluation_iteration": 0.7427845192809972, "synch_eval_env_connectors": 0.00047059090254250265, "synch_env_connectors": 7.882149809162004e-06}, "env_runners": {"env_to_module_connector": {"timers": {"connectors": {"add_time_dim_to_batch_and_zero_pad": 6.8008403461605e-06, "add_states_from_episodes_to_batch": 3.5378409194210746e-06, "batch_individual_items": 1.8426462006432903e-05, "add_observations_from_episodes_to_batch": 6.483914081845447e-06, "numpy_to_tensor": 3.107005027797763e-05}}, "connector_pipeline_timer": 0.000120403542088056}, "sample": 0.03799625038680938, "module_to_env_connector": {"timers": {"connectors": {"tensor_to_numpy": 5.004701466114353e-05, "listify_data_for_vector_env": 3.089725159235915e-05, "remove_single_ts_time_rank_from_batch": 1.422017386226239e-06, "un_batch_to_individual_items": 1.4503809269490184e-05, "normalize_and_clip_actions": 2.2233793058273175e-05, "get_actions": 0.0001660425883479567}}, "connector_pipeline_timer": 0.0003635785406628415}, "episode_duration_sec_mean": 0.036793881029980186, "num_env_steps_sampled": 5000.0, "num_module_steps_sampled_lifetime": {"default_policy": -717500.0}, "num_episodes": 100.0, "episode_len_max": 50, "num_episodes_lifetime": -14350.0, "episode_len_mean": 50.0, "env_to_module_sum_episodes_length_out": 27.16809333212661, "episode_return_max": 14.5, "num_agent_steps_sampled_lifetime": {"default_agent": -717500.0}, "module_episode_returns_mean": {"default_policy": 5.899999999999999}, "env_reset_timer": 9.374687748337785e-05, "env_to_module_sum_episodes_length_in": 27.16809333212661, "agent_episode_returns_mean": {"default_agent": 5.899999999999999}, "episode_len_min": 50, "episode_return_mean": 5.899999999999999, "episode_return_min": -5.5, "num_agent_steps_sampled": {"default_agent": 5000.0}, "weights_seq_no": 4.0, "num_env_steps_sampled_lifetime": -717500.0, "env_step_timer": 4.2578132710932146e-05, "time_between_sampling": 0.012650228060106213, "rlmodule_inference_timer": 0.00010215509645574998, "num_module_steps_sampled": {"default_policy": 5000.0}, "num_env_steps_sampled_lifetime_throughput": 1274.72540068563}, "learners": {"__all_modules__": {"num_env_steps_trained_lifetime": 408000, "learner_connector": {"timers": {"connectors": {"numpy_to_tensor": 0.00016103270642732438, "add_observations_from_episodes_to_batch": 0.0007377456754923739, "add_columns_from_episodes_to_train_batch": 0.06805017267517713, "general_advantage_estimation": 0.014653979321107445, "add_time_dim_to_batch_and_zero_pad": 2.1281448945518448e-05, "add_states_from_episodes_to_batch": 6.002751327403001e-06, "batch_individual_items": 0.19659855567868337, "add_one_ts_to_episodes_and_truncate": 0.00847585591839606}}, "connector_pipeline_timer": 0.28903694482494807}, "num_module_steps_trained_lifetime": 80000, "num_non_trainable_parameters": 0, "num_module_steps_trained": 16000, "num_trainable_parameters": 8697, "learner_connector_sum_episodes_length_in": 5000.0, "learner_connector_sum_episodes_length_out": 5100.0, "num_env_steps_trained": 81600, "num_env_steps_trained_lifetime_throughput": 926324.8358075521, "num_module_steps_trained_throughput": 182160.89185015167, "num_module_steps_trained_lifetime_throughput": 182056.76959649767}, "default_policy": {"curr_kl_coeff": 0.3456364870071411, "gradients_default_optimizer_global_norm": 0.7065791487693787, "module_train_batch_size_mean": 1000.0, "weights_seq_no": 5.0, "mean_kl_loss": 0.028934508562088013, "diff_num_grad_updates_vs_sampler_policy": 1.0, "vf_loss": 0.342660516500473, "vf_loss_unclipped": 14.425762176513672, "total_loss": 0.17832356691360474, "curr_entropy_coeff": 0.0347123860443, "policy_loss": 0.002909914357587695, "num_module_steps_trained_lifetime": 80000, "vf_explained_var": 0.18417131900787354, "default_optimizer_learning_rate": 0.0532857353826, "entropy": 0.45379549264907837, "num_module_steps_trained": 16000, "num_trainable_parameters": 8697, "num_module_steps_trained_lifetime_throughput": 182454.23004305348}}, "num_training_step_calls_per_iteration": 1, "evaluation": {"env_runners": {"env_to_module_connector": {"timers": {"connectors": {"numpy_to_tensor": 2.955578512503507e-05, "add_observations_from_episodes_to_batch": 6.292655532623388e-06, "add_time_dim_to_batch_and_zero_pad": 5.413142147238214e-06, "batch_individual_items": 1.8058743498520873e-05, "add_states_from_episodes_to_batch": 3.296904906074697e-06}}, "connector_pipeline_timer": 0.00011566399430038761}, "num_episodes_lifetime": 100, "episode_len_mean": 50.0, "env_to_module_sum_episodes_length_out": 27.168093332126602, "module_to_env_connector": {"timers": {"connectors": {"get_actions": 0.00015278038153325755, "listify_data_for_vector_env": 3.12497151229261e-05, "un_batch_to_individual_items": 1.4784909031939706e-05, "remove_single_ts_time_rank_from_batch": 1.4043691866635079e-06, "normalize_and_clip_actions": 2.1749608370370816e-05, "tensor_to_numpy": 4.367808426192742e-05}}, "connector_pipeline_timer": 0.0003428054394859684}, "num_module_steps_sampled_lifetime": {"default_policy": 5000}, "weights_seq_no": 5.0, "num_env_steps_sampled_lifetime": 26000, "rlmodule_inference_timer": 9.235703055842689e-05, "num_env_steps_sampled": 1000, "num_agent_steps_sampled": {"default_agent": 1000}, "episode_len_min": 50, "episode_duration_sec_mean": 0.035139212760032026, "episode_len_max": 50, "episode_return_max": 17.5, "num_module_steps_sampled": {"default_policy": 1000}, "env_to_module_sum_episodes_length_in": 27.168093332126602, "episode_return_mean": 0.1, "num_agent_steps_sampled_lifetime": {"default_agent": 5000}, "agent_episode_returns_mean": {"default_agent": 0.1}, "num_episodes": 20, "env_reset_timer": 0.00022414929939649667, "module_episode_returns_mean": {"default_policy": 0.1}, "episode_return_min": -16.5, "env_step_timer": 4.176613284141678e-05, "sample": 0.7309254348907718, "time_between_sampling": 4.295214992310866}, "num_healthy_workers": 1, "actor_manager_num_outstanding_async_reqs": 0, "num_remote_worker_restarts": 0}, "num_env_steps_sampled_lifetime": -717500.0, "fault_tolerance": {"num_healthy_workers": 0, "num_remote_worker_restarts": 0}, "env_runner_group": {"actor_manager_num_outstanding_async_reqs": 0}, "done": false, "training_iteration": 5, "trial_id": "05062_00000", "date": "2025-08-11_18-09-19", "timestamp": 1754928559, "time_this_iter_s": 4.914639472961426, "time_total_s": 25.112184524536133, "pid": 113125, "hostname": "DESKTOP-3SK5A41", "node_ip": "192.168.40.242", "config": {"exploration_config": {}, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 6, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "env": "Umbrella", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": false, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 0, "create_local_env_runner": true, "num_envs_per_env_runner": 1, "gym_env_vectorize_mode": "SYNC", "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "episodes_to_numpy": true, "max_requests_in_flight_per_env_runner": 1, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "merge_env_runner_states": "training_only", "broadcast_env_runner_states": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "complete_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "sampler_perf_stats_ema_coef": null, "_is_online": true, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": "auto", "num_aggregator_actors_per_learner": 0, "max_requests_in_flight_per_aggregator_actor": 3, "local_gpu_idx": 0, "max_requests_in_flight_per_learner": 3, "gamma": 1, "lr": 0.0532857353826, "grad_clip": 0.5, "grad_clip_by": "global_norm", "_train_batch_size_per_learner": 5000, "train_batch_size": 4000, "num_epochs": 3, "minibatch_size": 1000, "shuffle_batch_per_epoch": true, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "log_std_clip_param": 20.0, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "_disable_preprocessor_api": false, "_disable_action_flattening": false}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "_learner_class": null, "callbacks_on_algorithm_init": null, "callbacks_on_env_runners_recreated": null, "callbacks_on_offline_eval_runners_recreated": null, "callbacks_on_checkpoint_loaded": null, "callbacks_on_environment_created": null, "callbacks_on_episode_created": null, "callbacks_on_episode_start": null, "callbacks_on_episode_step": null, "callbacks_on_episode_end": null, "callbacks_on_evaluate_start": null, "callbacks_on_evaluate_end": null, "callbacks_on_evaluate_offline_start": null, "callbacks_on_evaluate_offline_end": null, "callbacks_on_sample_end": null, "callbacks_on_train_result": null, "explore": true, "enable_rl_module_and_learner": true, "enable_env_runner_and_connector_v2": true, "_prior_exploration_config": {"type": "StochasticSampling"}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x723d4b64aac0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "offline_data_class": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_read_batch_size": null, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "materialize_data": false, "materialize_mapped_data": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "ignore_final_observation": false, "prelearner_class": null, "prelearner_buffer_class": null, "prelearner_buffer_kwargs": {}, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_remaining_data": false, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": 1, "evaluation_duration": 20, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_auto_duration_min_env_steps_per_sample": 100, "evaluation_auto_duration_max_env_steps_per_sample": 2000, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 1, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "offline_evaluation_interval": null, "num_offline_eval_runners": 0, "offline_loss_for_module_fn": null, "offline_evaluation_duration": 1, "offline_evaluation_parallel_to_training": false, "offline_evaluation_timeout_s": 120.0, "num_cpus_per_offline_eval_runner": 1, "num_gpus_per_offline_eval_runner": 0, "custom_resources_per_offline_eval_runner": {}, "restart_failed_offline_eval_runners": true, "ignore_offline_eval_runner_failures": false, "max_num_offline_eval_runner_restarts": 1000, "offline_eval_runner_restore_timeout_s": 1800.0, "max_requests_in_flight_per_offline_eval_runner": 1, "validate_offline_eval_runners_after_construction": true, "offline_eval_runner_health_probe_timeout_s": 30.0, "offline_eval_rl_module_inference_only": false, "broadcast_offline_eval_runner_states": false, "offline_eval_batch_size_per_runner": 256, "dataset_num_iters_per_eval_runner": 1, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "log_gradients": true, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 42, "restart_failed_env_runners": true, "ignore_env_runner_failures": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30.0, "env_runner_restore_timeout_s": 1800.0, "_model_config": {}, "_rl_module_spec": "RLModuleSpec(module_class=None, observation_space=None, action_space=None, inference_only=False, learner_only=False, model_config=DefaultModelConfig(fcnet_hiddens=[63, 126], fcnet_activation='tanh', fcnet_kernel_initializer=None, fcnet_kernel_initializer_kwargs=None, fcnet_bias_initializer=None, fcnet_bias_initializer_kwargs=None, conv_filters=None, conv_activation='relu', conv_kernel_initializer=None, conv_kernel_initializer_kwargs=None, conv_bias_initializer=None, conv_bias_initializer_kwargs=None, head_fcnet_hiddens=[], head_fcnet_activation='relu', head_fcnet_kernel_initializer=None, head_fcnet_kernel_initializer_kwargs=None, head_fcnet_bias_initializer=None, head_fcnet_bias_initializer_kwargs=None, free_log_std=False, log_std_clip_param=20.0, vf_share_layers=True, use_lstm=False, max_seq_len=20, lstm_cell_size=256, lstm_use_prev_action=False, lstm_use_prev_reward=False, lstm_kernel_initializer=None, lstm_kernel_initializer_kwargs=None, lstm_bias_initializer=None, lstm_bias_initializer_kwargs=None), catalog_class=None, load_state_path=None, model_config_dict=None)", "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "_validate_config": true, "_use_msgpack_checkpoints": false, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "env_task_fn": -1, "enable_connectors": -1, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.1024108006331, "kl_target": 0.0216481916482, "vf_loss_coeff": 0.5287015453939, "entropy_coeff": 0.0347123860443, "clip_param": 0.1072861819248, "vf_clip_param": 0.4447244315309, "entropy_coeff_schedule": null, "lr_schedule": null, "sgd_minibatch_size": -1, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9119716444993, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.callbacks.callbacks.RLlibCallback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 25.112184524536133, "iterations_since_restore": 5, "perf": {"cpu_util_percent": 12.5, "ram_util_percent": 70.0375}}
{"timers": {"training_iteration": 4.323725289663666, "restore_env_runners": 1.5401746051437097e-05, "training_step": 4.323444817279555, "env_runner_sampling_timer": 3.8615020739762302, "learner_update_timer": 0.45832927151064834, "synch_weights": 0.0014131318452686725, "restore_eval_env_runners": 1.5014902804948323e-05, "evaluation_iteration": 0.7427063391081886, "synch_eval_env_connectors": 0.0004697509935143655, "synch_env_connectors": 7.871328310443952e-06}, "env_runners": {"env_to_module_connector": {"timers": {"connectors": {"add_time_dim_to_batch_and_zero_pad": 6.827038497963983e-06, "add_states_from_episodes_to_batch": 3.5934319275800296e-06, "batch_individual_items": 1.8740085533186426e-05, "add_observations_from_episodes_to_batch": 6.54762297514461e-06, "numpy_to_tensor": 3.106808733613402e-05}}, "connector_pipeline_timer": 0.00012163507837926456}, "sample": 0.03816764114558902, "module_to_env_connector": {"timers": {"connectors": {"tensor_to_numpy": 5.0342293193374066e-05, "listify_data_for_vector_env": 3.1459205372736204e-05, "remove_single_ts_time_rank_from_batch": 1.464133537391774e-06, "un_batch_to_individual_items": 1.4740548183637414e-05, "normalize_and_clip_actions": 2.25417992407765e-05, "get_actions": 0.00016734845175927666}}, "connector_pipeline_timer": 0.0003671540422310778}, "episode_duration_sec_mean": 0.03715020907007782, "num_env_steps_sampled": 5000.0, "num_module_steps_sampled_lifetime": {"default_policy": -960000.0}, "num_episodes": 100.0, "episode_len_max": 50, "num_episodes_lifetime": -19200.0, "episode_len_mean": 50.0, "env_to_module_sum_episodes_length_out": 27.16809333212661, "episode_return_max": 14.5, "num_agent_steps_sampled_lifetime": {"default_agent": -960000.0}, "module_episode_returns_mean": {"default_policy": 0.09999999999999998}, "env_reset_timer": 9.393766815711132e-05, "env_to_module_sum_episodes_length_in": 27.16809333212661, "agent_episode_returns_mean": {"default_agent": 0.09999999999999998}, "episode_len_min": 50, "episode_return_mean": 0.09999999999999998, "episode_return_min": -5.5, "num_agent_steps_sampled": {"default_agent": 5000.0}, "weights_seq_no": 5.0, "num_env_steps_sampled_lifetime": -960000.0, "env_step_timer": 4.294084637833295e-05, "time_between_sampling": 0.01207046219842823, "rlmodule_inference_timer": 0.00010371750582054708, "num_module_steps_sampled": {"default_policy": 5000.0}, "num_env_steps_sampled_lifetime_throughput": 1263.6556181101184}, "learners": {"__all_modules__": {"num_env_steps_trained_lifetime": 489600, "learner_connector": {"timers": {"connectors": {"numpy_to_tensor": 0.0001612293793617858, "add_observations_from_episodes_to_batch": 0.0007373312187336264, "add_columns_from_episodes_to_train_batch": 0.06804775394842788, "general_advantage_estimation": 0.01459890452789225, "add_time_dim_to_batch_and_zero_pad": 2.1280634460530235e-05, "add_states_from_episodes_to_batch": 5.999723820692583e-06, "batch_individual_items": 0.19666656212189346, "add_one_ts_to_episodes_and_truncate": 0.008473544359207327}}, "connector_pipeline_timer": 0.2890444813766969}, "num_module_steps_trained_lifetime": 96000, "num_non_trainable_parameters": 0, "num_module_steps_trained": 16000, "num_trainable_parameters": 8697, "learner_connector_sum_episodes_length_in": 5000.0, "learner_connector_sum_episodes_length_out": 5100.0, "num_env_steps_trained": 81600, "num_env_steps_trained_lifetime_throughput": 922222.2893239364, "num_module_steps_trained_throughput": 181331.53040008768, "num_module_steps_trained_lifetime_throughput": 181231.38863590808}, "default_policy": {"curr_kl_coeff": 0.5184547305107117, "gradients_default_optimizer_global_norm": 1.7447611093521118, "module_train_batch_size_mean": 1000.0, "weights_seq_no": 6.0, "mean_kl_loss": 0.12173401564359665, "diff_num_grad_updates_vs_sampler_policy": 1.0, "vf_loss": 0.35532253980636597, "vf_loss_unclipped": 6.620060920715332, "total_loss": 0.23734447360038757, "curr_entropy_coeff": 0.0347123860443, "policy_loss": 0.02491181343793869, "num_module_steps_trained_lifetime": 96000, "vf_explained_var": 0.45222538709640503, "default_optimizer_learning_rate": 0.0532857353826, "entropy": 0.5042178630828857, "num_module_steps_trained": 16000, "num_trainable_parameters": 8697, "num_module_steps_trained_lifetime_throughput": 181608.20468616413}}, "num_training_step_calls_per_iteration": 1, "evaluation": {"env_runners": {"env_to_module_connector": {"timers": {"connectors": {"numpy_to_tensor": 3.02008202579365e-05, "add_observations_from_episodes_to_batch": 6.226640395863859e-06, "add_time_dim_to_batch_and_zero_pad": 5.2421982978593815e-06, "batch_individual_items": 1.7422404986879763e-05, "add_states_from_episodes_to_batch": 3.1736643493380127e-06}}, "connector_pipeline_timer": 0.00011478915559262207}, "num_episodes_lifetime": 120, "episode_len_mean": 50.0, "env_to_module_sum_episodes_length_out": 27.168093332126602, "module_to_env_connector": {"timers": {"connectors": {"get_actions": 0.00015081256406262696, "listify_data_for_vector_env": 3.0140194807934106e-05, "un_batch_to_individual_items": 1.5314063347415505e-05, "remove_single_ts_time_rank_from_batch": 1.3742467710704844e-06, "normalize_and_clip_actions": 2.2034003975665706e-05, "tensor_to_numpy": 4.377285153471376e-05}}, "connector_pipeline_timer": 0.00034113299276996266}, "num_module_steps_sampled_lifetime": {"default_policy": 6000}, "weights_seq_no": 6.0, "num_env_steps_sampled_lifetime": 31000, "rlmodule_inference_timer": 9.509268265982463e-05, "num_env_steps_sampled": 1000, "num_agent_steps_sampled": {"default_agent": 1000}, "episode_len_min": 50, "episode_duration_sec_mean": 0.035189912050018396, "episode_len_max": 50, "episode_return_max": 17.5, "num_module_steps_sampled": {"default_policy": 1000}, "env_to_module_sum_episodes_length_in": 27.168093332126602, "episode_return_mean": 0.7, "num_agent_steps_sampled_lifetime": {"default_agent": 6000}, "agent_episode_returns_mean": {"default_agent": 0.7}, "num_episodes": 20, "env_reset_timer": 0.00022318080640966318, "module_episode_returns_mean": {"default_policy": 0.7}, "episode_return_min": -16.5, "env_step_timer": 4.1327667648445114e-05, "sample": 0.7309679715518603, "time_between_sampling": 4.296491958477748}, "num_healthy_workers": 1, "actor_manager_num_outstanding_async_reqs": 0, "num_remote_worker_restarts": 0}, "num_env_steps_sampled_lifetime": -960000.0, "fault_tolerance": {"num_healthy_workers": 0, "num_remote_worker_restarts": 0}, "env_runner_group": {"actor_manager_num_outstanding_async_reqs": 0}, "done": false, "training_iteration": 6, "trial_id": "05062_00000", "date": "2025-08-11_18-09-24", "timestamp": 1754928564, "time_this_iter_s": 5.114662170410156, "time_total_s": 30.22684669494629, "pid": 113125, "hostname": "DESKTOP-3SK5A41", "node_ip": "192.168.40.242", "config": {"exploration_config": {}, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 6, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "env": "Umbrella", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": false, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 0, "create_local_env_runner": true, "num_envs_per_env_runner": 1, "gym_env_vectorize_mode": "SYNC", "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "episodes_to_numpy": true, "max_requests_in_flight_per_env_runner": 1, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "merge_env_runner_states": "training_only", "broadcast_env_runner_states": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "complete_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "sampler_perf_stats_ema_coef": null, "_is_online": true, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": "auto", "num_aggregator_actors_per_learner": 0, "max_requests_in_flight_per_aggregator_actor": 3, "local_gpu_idx": 0, "max_requests_in_flight_per_learner": 3, "gamma": 1, "lr": 0.0532857353826, "grad_clip": 0.5, "grad_clip_by": "global_norm", "_train_batch_size_per_learner": 5000, "train_batch_size": 4000, "num_epochs": 3, "minibatch_size": 1000, "shuffle_batch_per_epoch": true, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "log_std_clip_param": 20.0, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "_disable_preprocessor_api": false, "_disable_action_flattening": false}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "_learner_class": null, "callbacks_on_algorithm_init": null, "callbacks_on_env_runners_recreated": null, "callbacks_on_offline_eval_runners_recreated": null, "callbacks_on_checkpoint_loaded": null, "callbacks_on_environment_created": null, "callbacks_on_episode_created": null, "callbacks_on_episode_start": null, "callbacks_on_episode_step": null, "callbacks_on_episode_end": null, "callbacks_on_evaluate_start": null, "callbacks_on_evaluate_end": null, "callbacks_on_evaluate_offline_start": null, "callbacks_on_evaluate_offline_end": null, "callbacks_on_sample_end": null, "callbacks_on_train_result": null, "explore": true, "enable_rl_module_and_learner": true, "enable_env_runner_and_connector_v2": true, "_prior_exploration_config": {"type": "StochasticSampling"}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x723d4b64aac0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "offline_data_class": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_read_batch_size": null, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "materialize_data": false, "materialize_mapped_data": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "ignore_final_observation": false, "prelearner_class": null, "prelearner_buffer_class": null, "prelearner_buffer_kwargs": {}, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_remaining_data": false, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": 1, "evaluation_duration": 20, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_auto_duration_min_env_steps_per_sample": 100, "evaluation_auto_duration_max_env_steps_per_sample": 2000, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 1, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "offline_evaluation_interval": null, "num_offline_eval_runners": 0, "offline_loss_for_module_fn": null, "offline_evaluation_duration": 1, "offline_evaluation_parallel_to_training": false, "offline_evaluation_timeout_s": 120.0, "num_cpus_per_offline_eval_runner": 1, "num_gpus_per_offline_eval_runner": 0, "custom_resources_per_offline_eval_runner": {}, "restart_failed_offline_eval_runners": true, "ignore_offline_eval_runner_failures": false, "max_num_offline_eval_runner_restarts": 1000, "offline_eval_runner_restore_timeout_s": 1800.0, "max_requests_in_flight_per_offline_eval_runner": 1, "validate_offline_eval_runners_after_construction": true, "offline_eval_runner_health_probe_timeout_s": 30.0, "offline_eval_rl_module_inference_only": false, "broadcast_offline_eval_runner_states": false, "offline_eval_batch_size_per_runner": 256, "dataset_num_iters_per_eval_runner": 1, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "log_gradients": true, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 42, "restart_failed_env_runners": true, "ignore_env_runner_failures": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30.0, "env_runner_restore_timeout_s": 1800.0, "_model_config": {}, "_rl_module_spec": "RLModuleSpec(module_class=None, observation_space=None, action_space=None, inference_only=False, learner_only=False, model_config=DefaultModelConfig(fcnet_hiddens=[63, 126], fcnet_activation='tanh', fcnet_kernel_initializer=None, fcnet_kernel_initializer_kwargs=None, fcnet_bias_initializer=None, fcnet_bias_initializer_kwargs=None, conv_filters=None, conv_activation='relu', conv_kernel_initializer=None, conv_kernel_initializer_kwargs=None, conv_bias_initializer=None, conv_bias_initializer_kwargs=None, head_fcnet_hiddens=[], head_fcnet_activation='relu', head_fcnet_kernel_initializer=None, head_fcnet_kernel_initializer_kwargs=None, head_fcnet_bias_initializer=None, head_fcnet_bias_initializer_kwargs=None, free_log_std=False, log_std_clip_param=20.0, vf_share_layers=True, use_lstm=False, max_seq_len=20, lstm_cell_size=256, lstm_use_prev_action=False, lstm_use_prev_reward=False, lstm_kernel_initializer=None, lstm_kernel_initializer_kwargs=None, lstm_bias_initializer=None, lstm_bias_initializer_kwargs=None), catalog_class=None, load_state_path=None, model_config_dict=None)", "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "_validate_config": true, "_use_msgpack_checkpoints": false, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "env_task_fn": -1, "enable_connectors": -1, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.1024108006331, "kl_target": 0.0216481916482, "vf_loss_coeff": 0.5287015453939, "entropy_coeff": 0.0347123860443, "clip_param": 0.1072861819248, "vf_clip_param": 0.4447244315309, "entropy_coeff_schedule": null, "lr_schedule": null, "sgd_minibatch_size": -1, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9119716444993, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.callbacks.callbacks.RLlibCallback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 30.22684669494629, "iterations_since_restore": 6, "perf": {"cpu_util_percent": 13.12857142857143, "ram_util_percent": 70.0}}
{"timers": {"training_iteration": 4.322057568087031, "restore_env_runners": 1.5365728589033187e-05, "training_step": 4.321776040426764, "env_runner_sampling_timer": 3.8619408725364655, "learner_update_timer": 0.4562191138155418, "synch_weights": 0.0014122475268131221, "restore_eval_env_runners": 1.4989753773741073e-05, "evaluation_iteration": 0.7427322737271009, "synch_eval_env_connectors": 0.0004698374835816953, "synch_env_connectors": 7.853615018886363e-06}, "env_runners": {"env_to_module_connector": {"timers": {"connectors": {"add_time_dim_to_batch_and_zero_pad": 6.775244526837086e-06, "add_states_from_episodes_to_batch": 3.5244092714504457e-06, "batch_individual_items": 1.8405950914747654e-05, "add_observations_from_episodes_to_batch": 6.476102376572742e-06, "numpy_to_tensor": 3.058877509607031e-05}}, "connector_pipeline_timer": 0.00011989589713996295}, "sample": 0.037832175322361876, "module_to_env_connector": {"timers": {"connectors": {"tensor_to_numpy": 4.952025792765011e-05, "listify_data_for_vector_env": 3.082875630271529e-05, "remove_single_ts_time_rank_from_batch": 1.4336486590253612e-06, "un_batch_to_individual_items": 1.4430114804206476e-05, "normalize_and_clip_actions": 2.2059229411793e-05, "get_actions": 0.0001644249722597987}}, "connector_pipeline_timer": 0.0003608369475458424}, "episode_duration_sec_mean": 0.03649021228000492, "num_env_steps_sampled": 5000.0, "num_module_steps_sampled_lifetime": {"default_policy": -1202500.0}, "num_episodes": 100.0, "episode_len_max": 50, "num_episodes_lifetime": -24050.0, "episode_len_mean": 50.0, "env_to_module_sum_episodes_length_out": 27.16809333212661, "episode_return_max": 14.5, "num_agent_steps_sampled_lifetime": {"default_agent": -1202500.0}, "module_episode_returns_mean": {"default_policy": -4.899999999999999}, "env_reset_timer": 9.273590868578456e-05, "env_to_module_sum_episodes_length_in": 27.16809333212661, "agent_episode_returns_mean": {"default_agent": -4.899999999999999}, "episode_len_min": 50, "episode_return_mean": -4.899999999999999, "episode_return_min": -5.5, "num_agent_steps_sampled": {"default_agent": 5000.0}, "weights_seq_no": 6.0, "num_env_steps_sampled_lifetime": -1202500.0, "env_step_timer": 4.214399489241051e-05, "time_between_sampling": 0.012864963576638133, "rlmodule_inference_timer": 0.0001010489588429111, "num_module_steps_sampled": {"default_policy": 5000.0}, "num_env_steps_sampled_lifetime_throughput": 1280.7698958686497}, "learners": {"__all_modules__": {"num_env_steps_trained_lifetime": 571200, "learner_connector": {"timers": {"connectors": {"numpy_to_tensor": 0.00016129008557428954, "add_observations_from_episodes_to_batch": 0.0007372609065393342, "add_columns_from_episodes_to_train_batch": 0.06803967740894523, "general_advantage_estimation": 0.014552977482614672, "add_time_dim_to_batch_and_zero_pad": 2.1426828111949e-05, "add_states_from_episodes_to_batch": 6.067726583981478e-06, "batch_individual_items": 0.19529584851067316, "add_one_ts_to_episodes_and_truncate": 0.008470242915609513}}, "connector_pipeline_timer": 0.2876170085729337}, "num_module_steps_trained_lifetime": 112000, "num_non_trainable_parameters": 0, "num_module_steps_trained": 16000, "num_trainable_parameters": 8697, "learner_connector_sum_episodes_length_in": 5000.0, "learner_connector_sum_episodes_length_out": 5100.0, "num_env_steps_trained": 81600, "num_env_steps_trained_lifetime_throughput": 917245.3102805748, "num_module_steps_trained_throughput": 180332.37339387825, "num_module_steps_trained_lifetime_throughput": 180235.63609524863}, "default_policy": {"curr_kl_coeff": 0.5184547305107117, "gradients_default_optimizer_global_norm": 0.6629930138587952, "module_train_batch_size_mean": 1000.0, "weights_seq_no": 7.0, "mean_kl_loss": 0.03348282724618912, "diff_num_grad_updates_vs_sampler_policy": 1.0, "vf_loss": 0.4391690790653229, "vf_loss_unclipped": 92.60839080810547, "total_loss": 0.23724113404750824, "curr_entropy_coeff": 0.0347123860443, "policy_loss": -0.008619887754321098, "num_module_steps_trained_lifetime": 112000, "vf_explained_var": -0.6215693950653076, "default_optimizer_learning_rate": 0.0532857353826, "entropy": 0.10623373091220856, "num_module_steps_trained": 16000, "num_trainable_parameters": 8697, "num_module_steps_trained_lifetime_throughput": 180593.63309642184}}, "num_training_step_calls_per_iteration": 1, "evaluation": {"env_runners": {"env_to_module_connector": {"timers": {"connectors": {"numpy_to_tensor": 2.8828881574173866e-05, "add_observations_from_episodes_to_batch": 6.217851776555195e-06, "add_time_dim_to_batch_and_zero_pad": 5.414552845092256e-06, "batch_individual_items": 1.796246660144763e-05, "add_states_from_episodes_to_batch": 3.236816404614831e-06}}, "connector_pipeline_timer": 0.00011528885499810511}, "num_episodes_lifetime": 140, "episode_len_mean": 50.0, "env_to_module_sum_episodes_length_out": 27.168093332126602, "module_to_env_connector": {"timers": {"connectors": {"get_actions": 0.00015185196984057023, "listify_data_for_vector_env": 3.009277506274844e-05, "un_batch_to_individual_items": 1.4841433456835987e-05, "remove_single_ts_time_rank_from_batch": 1.4014078851754347e-06, "normalize_and_clip_actions": 2.120743775887033e-05, "tensor_to_numpy": 4.368106496328372e-05}}, "connector_pipeline_timer": 0.0003395848795895095}, "num_module_steps_sampled_lifetime": {"default_policy": 7000}, "weights_seq_no": 7.0, "num_env_steps_sampled_lifetime": 36000, "rlmodule_inference_timer": 9.229647207506082e-05, "num_env_steps_sampled": 1000, "num_agent_steps_sampled": {"default_agent": 1000}, "episode_len_min": 50, "episode_duration_sec_mean": 0.034888193100050556, "episode_len_max": 50, "episode_return_max": 17.5, "num_module_steps_sampled": {"default_policy": 1000}, "env_to_module_sum_episodes_length_in": 27.168093332126602, "episode_return_mean": 0.9, "num_agent_steps_sampled_lifetime": {"default_agent": 7000}, "agent_episode_returns_mean": {"default_agent": 0.9}, "num_episodes": 20, "env_reset_timer": 0.0002221539983442295, "module_episode_returns_mean": {"default_policy": 0.9}, "episode_return_min": -16.5, "env_step_timer": 4.126571791149032e-05, "sample": 0.7308917268963393, "time_between_sampling": 4.29565166021297}, "num_healthy_workers": 1, "actor_manager_num_outstanding_async_reqs": 0, "num_remote_worker_restarts": 0}, "num_env_steps_sampled_lifetime": -1202500.0, "fault_tolerance": {"num_healthy_workers": 0, "num_remote_worker_restarts": 0}, "env_runner_group": {"actor_manager_num_outstanding_async_reqs": 0}, "done": false, "training_iteration": 7, "trial_id": "05062_00000", "date": "2025-08-11_18-09-29", "timestamp": 1754928569, "time_this_iter_s": 4.893794775009155, "time_total_s": 35.120641469955444, "pid": 113125, "hostname": "DESKTOP-3SK5A41", "node_ip": "192.168.40.242", "config": {"exploration_config": {}, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 6, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "env": "Umbrella", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": false, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 0, "create_local_env_runner": true, "num_envs_per_env_runner": 1, "gym_env_vectorize_mode": "SYNC", "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "episodes_to_numpy": true, "max_requests_in_flight_per_env_runner": 1, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "merge_env_runner_states": "training_only", "broadcast_env_runner_states": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "complete_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "sampler_perf_stats_ema_coef": null, "_is_online": true, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": "auto", "num_aggregator_actors_per_learner": 0, "max_requests_in_flight_per_aggregator_actor": 3, "local_gpu_idx": 0, "max_requests_in_flight_per_learner": 3, "gamma": 1, "lr": 0.0532857353826, "grad_clip": 0.5, "grad_clip_by": "global_norm", "_train_batch_size_per_learner": 5000, "train_batch_size": 4000, "num_epochs": 3, "minibatch_size": 1000, "shuffle_batch_per_epoch": true, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "log_std_clip_param": 20.0, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "_disable_preprocessor_api": false, "_disable_action_flattening": false}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "_learner_class": null, "callbacks_on_algorithm_init": null, "callbacks_on_env_runners_recreated": null, "callbacks_on_offline_eval_runners_recreated": null, "callbacks_on_checkpoint_loaded": null, "callbacks_on_environment_created": null, "callbacks_on_episode_created": null, "callbacks_on_episode_start": null, "callbacks_on_episode_step": null, "callbacks_on_episode_end": null, "callbacks_on_evaluate_start": null, "callbacks_on_evaluate_end": null, "callbacks_on_evaluate_offline_start": null, "callbacks_on_evaluate_offline_end": null, "callbacks_on_sample_end": null, "callbacks_on_train_result": null, "explore": true, "enable_rl_module_and_learner": true, "enable_env_runner_and_connector_v2": true, "_prior_exploration_config": {"type": "StochasticSampling"}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x723d4b64aac0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "offline_data_class": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_read_batch_size": null, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "materialize_data": false, "materialize_mapped_data": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "ignore_final_observation": false, "prelearner_class": null, "prelearner_buffer_class": null, "prelearner_buffer_kwargs": {}, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_remaining_data": false, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": 1, "evaluation_duration": 20, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_auto_duration_min_env_steps_per_sample": 100, "evaluation_auto_duration_max_env_steps_per_sample": 2000, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 1, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "offline_evaluation_interval": null, "num_offline_eval_runners": 0, "offline_loss_for_module_fn": null, "offline_evaluation_duration": 1, "offline_evaluation_parallel_to_training": false, "offline_evaluation_timeout_s": 120.0, "num_cpus_per_offline_eval_runner": 1, "num_gpus_per_offline_eval_runner": 0, "custom_resources_per_offline_eval_runner": {}, "restart_failed_offline_eval_runners": true, "ignore_offline_eval_runner_failures": false, "max_num_offline_eval_runner_restarts": 1000, "offline_eval_runner_restore_timeout_s": 1800.0, "max_requests_in_flight_per_offline_eval_runner": 1, "validate_offline_eval_runners_after_construction": true, "offline_eval_runner_health_probe_timeout_s": 30.0, "offline_eval_rl_module_inference_only": false, "broadcast_offline_eval_runner_states": false, "offline_eval_batch_size_per_runner": 256, "dataset_num_iters_per_eval_runner": 1, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "log_gradients": true, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 42, "restart_failed_env_runners": true, "ignore_env_runner_failures": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30.0, "env_runner_restore_timeout_s": 1800.0, "_model_config": {}, "_rl_module_spec": "RLModuleSpec(module_class=None, observation_space=None, action_space=None, inference_only=False, learner_only=False, model_config=DefaultModelConfig(fcnet_hiddens=[63, 126], fcnet_activation='tanh', fcnet_kernel_initializer=None, fcnet_kernel_initializer_kwargs=None, fcnet_bias_initializer=None, fcnet_bias_initializer_kwargs=None, conv_filters=None, conv_activation='relu', conv_kernel_initializer=None, conv_kernel_initializer_kwargs=None, conv_bias_initializer=None, conv_bias_initializer_kwargs=None, head_fcnet_hiddens=[], head_fcnet_activation='relu', head_fcnet_kernel_initializer=None, head_fcnet_kernel_initializer_kwargs=None, head_fcnet_bias_initializer=None, head_fcnet_bias_initializer_kwargs=None, free_log_std=False, log_std_clip_param=20.0, vf_share_layers=True, use_lstm=False, max_seq_len=20, lstm_cell_size=256, lstm_use_prev_action=False, lstm_use_prev_reward=False, lstm_kernel_initializer=None, lstm_kernel_initializer_kwargs=None, lstm_bias_initializer=None, lstm_bias_initializer_kwargs=None), catalog_class=None, load_state_path=None, model_config_dict=None)", "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "_validate_config": true, "_use_msgpack_checkpoints": false, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "env_task_fn": -1, "enable_connectors": -1, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.1024108006331, "kl_target": 0.0216481916482, "vf_loss_coeff": 0.5287015453939, "entropy_coeff": 0.0347123860443, "clip_param": 0.1072861819248, "vf_clip_param": 0.4447244315309, "entropy_coeff_schedule": null, "lr_schedule": null, "sgd_minibatch_size": -1, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9119716444993, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.callbacks.callbacks.RLlibCallback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 35.120641469955444, "iterations_since_restore": 7, "perf": {"cpu_util_percent": 12.914285714285715, "ram_util_percent": 70.0}}
{"timers": {"training_iteration": 4.321890313766154, "restore_env_runners": 1.5345071297236408e-05, "training_step": 4.32160803238249, "env_runner_sampling_timer": 3.8624341531511, "learner_update_timer": 0.4555550776973924, "synch_weights": 0.0014148250515414811, "restore_eval_env_runners": 1.4937856236438357e-05, "evaluation_iteration": 0.7426325370498306, "synch_eval_env_connectors": 0.00046937910874426833, "synch_env_connectors": 7.843078877166017e-06}, "env_runners": {"env_to_module_connector": {"timers": {"connectors": {"add_time_dim_to_batch_and_zero_pad": 6.757967686636044e-06, "add_states_from_episodes_to_batch": 3.520063078813925e-06, "batch_individual_items": 1.8401248043241673e-05, "add_observations_from_episodes_to_batch": 6.468408990458163e-06, "numpy_to_tensor": 3.059637571889377e-05}}, "connector_pipeline_timer": 0.00011971356231584261}, "sample": 0.03766712240970346, "module_to_env_connector": {"timers": {"connectors": {"tensor_to_numpy": 4.978837104490613e-05, "listify_data_for_vector_env": 3.0776508658081575e-05, "remove_single_ts_time_rank_from_batch": 1.417185688256212e-06, "un_batch_to_individual_items": 1.4516542363285528e-05, "normalize_and_clip_actions": 2.224813867889474e-05, "get_actions": 0.00016493781944494168}}, "connector_pipeline_timer": 0.0003616535871246707}, "episode_duration_sec_mean": 0.03658367131999511, "num_env_steps_sampled": 5000.0, "num_module_steps_sampled_lifetime": {"default_policy": -1445000.0}, "num_episodes": 100.0, "episode_len_max": 50, "num_episodes_lifetime": -28900.0, "episode_len_mean": 50.0, "env_to_module_sum_episodes_length_out": 27.16809333212661, "episode_return_max": 14.5, "num_agent_steps_sampled_lifetime": {"default_agent": -1445000.0}, "module_episode_returns_mean": {"default_policy": -5.299999999999998}, "env_reset_timer": 9.263750036515606e-05, "env_to_module_sum_episodes_length_in": 27.16809333212661, "agent_episode_returns_mean": {"default_agent": -5.299999999999998}, "episode_len_min": 50, "episode_return_mean": -5.299999999999998, "episode_return_min": -5.5, "num_agent_steps_sampled": {"default_agent": 5000.0}, "weights_seq_no": 7.0, "num_env_steps_sampled_lifetime": -1445000.0, "env_step_timer": 4.230063963458439e-05, "time_between_sampling": 0.012176454587700175, "rlmodule_inference_timer": 0.00010205286160674335, "num_module_steps_sampled": {"default_policy": 5000.0}, "num_env_steps_sampled_lifetime_throughput": 1279.044056577707}, "learners": {"__all_modules__": {"num_env_steps_trained_lifetime": 652800, "learner_connector": {"timers": {"connectors": {"numpy_to_tensor": 0.00016133818471514882, "add_observations_from_episodes_to_batch": 0.0007372242974726996, "add_columns_from_episodes_to_train_batch": 0.06803140263486117, "general_advantage_estimation": 0.01451116470778121, "add_time_dim_to_batch_and_zero_pad": 2.1429559827894214e-05, "add_states_from_episodes_to_batch": 6.062049318571236e-06, "batch_individual_items": 0.19538069103556763, "add_one_ts_to_episodes_and_truncate": 0.008467635486451353}}, "connector_pipeline_timer": 0.28764898349720097}, "num_module_steps_trained_lifetime": 128000, "num_non_trainable_parameters": 0, "num_module_steps_trained": 16000, "num_trainable_parameters": 8697, "learner_connector_sum_episodes_length_in": 5000.0, "learner_connector_sum_episodes_length_out": 5100.0, "num_env_steps_trained": 81600, "num_env_steps_trained_lifetime_throughput": 912282.5408707395, "num_module_steps_trained_throughput": 179340.3197918629, "num_module_steps_trained_lifetime_throughput": 179245.8868291334}, "default_policy": {"curr_kl_coeff": 0.7776820659637451, "gradients_default_optimizer_global_norm": 0.7513607144355774, "module_train_batch_size_mean": 1000.0, "weights_seq_no": 8.0, "mean_kl_loss": 0.1019829735159874, "diff_num_grad_updates_vs_sampler_policy": 1.0, "vf_loss": 0.44472458958625793, "vf_loss_unclipped": 358.5141906738281, "total_loss": 0.4128846228122711, "curr_entropy_coeff": 0.0347123860443, "policy_loss": 0.12750491499900818, "num_module_steps_trained_lifetime": 128000, "vf_explained_var": -1.0, "default_optimizer_learning_rate": 0.0532857353826, "entropy": 0.07548664510250092, "num_module_steps_trained": 16000, "num_trainable_parameters": 8697, "num_module_steps_trained_lifetime_throughput": 179588.21543025164}}, "num_training_step_calls_per_iteration": 1, "evaluation": {"env_runners": {"env_to_module_connector": {"timers": {"connectors": {"numpy_to_tensor": 2.9026556769599368e-05, "add_observations_from_episodes_to_batch": 6.1746927418899404e-06, "add_time_dim_to_batch_and_zero_pad": 5.47709874020633e-06, "batch_individual_items": 1.7579373069360603e-05, "add_states_from_episodes_to_batch": 3.1987334824336555e-06}}, "connector_pipeline_timer": 0.00011489494173686646}, "num_episodes_lifetime": 160, "episode_len_mean": 50.0, "env_to_module_sum_episodes_length_out": 27.168093332126602, "module_to_env_connector": {"timers": {"connectors": {"get_actions": 0.00015355107928161448, "listify_data_for_vector_env": 3.0161195171816955e-05, "un_batch_to_individual_items": 1.5428586749358395e-05, "remove_single_ts_time_rank_from_batch": 1.4165956319126662e-06, "normalize_and_clip_actions": 2.1286274253386127e-05, "tensor_to_numpy": 4.4243653686316526e-05}}, "connector_pipeline_timer": 0.0003430140626252703}, "num_module_steps_sampled_lifetime": {"default_policy": 8000}, "weights_seq_no": 8.0, "num_env_steps_sampled_lifetime": 41000, "rlmodule_inference_timer": 9.408066011320517e-05, "num_env_steps_sampled": 1000, "num_agent_steps_sampled": {"default_agent": 1000}, "episode_len_min": 50, "episode_duration_sec_mean": 0.03491102913005307, "episode_len_max": 50, "episode_return_max": 17.5, "num_module_steps_sampled": {"default_policy": 1000}, "env_to_module_sum_episodes_length_in": 27.168093332126602, "episode_return_mean": 0.7, "num_agent_steps_sampled_lifetime": {"default_agent": 8000}, "agent_episode_returns_mean": {"default_agent": 0.7}, "num_episodes": 20, "env_reset_timer": 0.00022130445836687293, "module_episode_returns_mean": {"default_policy": 0.7}, "episode_return_min": -16.5, "env_step_timer": 4.161784578043051e-05, "sample": 0.7308196946673775, "time_between_sampling": 4.2962856719808356}, "num_healthy_workers": 1, "actor_manager_num_outstanding_async_reqs": 0, "num_remote_worker_restarts": 0}, "num_env_steps_sampled_lifetime": -1445000.0, "fault_tolerance": {"num_healthy_workers": 0, "num_remote_worker_restarts": 0}, "env_runner_group": {"actor_manager_num_outstanding_async_reqs": 0}, "done": false, "training_iteration": 8, "trial_id": "05062_00000", "date": "2025-08-11_18-09-34", "timestamp": 1754928574, "time_this_iter_s": 5.043569087982178, "time_total_s": 40.16421055793762, "pid": 113125, "hostname": "DESKTOP-3SK5A41", "node_ip": "192.168.40.242", "config": {"exploration_config": {}, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 6, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "env": "Umbrella", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": false, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 0, "create_local_env_runner": true, "num_envs_per_env_runner": 1, "gym_env_vectorize_mode": "SYNC", "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "episodes_to_numpy": true, "max_requests_in_flight_per_env_runner": 1, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "merge_env_runner_states": "training_only", "broadcast_env_runner_states": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "complete_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "sampler_perf_stats_ema_coef": null, "_is_online": true, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": "auto", "num_aggregator_actors_per_learner": 0, "max_requests_in_flight_per_aggregator_actor": 3, "local_gpu_idx": 0, "max_requests_in_flight_per_learner": 3, "gamma": 1, "lr": 0.0532857353826, "grad_clip": 0.5, "grad_clip_by": "global_norm", "_train_batch_size_per_learner": 5000, "train_batch_size": 4000, "num_epochs": 3, "minibatch_size": 1000, "shuffle_batch_per_epoch": true, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "log_std_clip_param": 20.0, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "_disable_preprocessor_api": false, "_disable_action_flattening": false}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "_learner_class": null, "callbacks_on_algorithm_init": null, "callbacks_on_env_runners_recreated": null, "callbacks_on_offline_eval_runners_recreated": null, "callbacks_on_checkpoint_loaded": null, "callbacks_on_environment_created": null, "callbacks_on_episode_created": null, "callbacks_on_episode_start": null, "callbacks_on_episode_step": null, "callbacks_on_episode_end": null, "callbacks_on_evaluate_start": null, "callbacks_on_evaluate_end": null, "callbacks_on_evaluate_offline_start": null, "callbacks_on_evaluate_offline_end": null, "callbacks_on_sample_end": null, "callbacks_on_train_result": null, "explore": true, "enable_rl_module_and_learner": true, "enable_env_runner_and_connector_v2": true, "_prior_exploration_config": {"type": "StochasticSampling"}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x723d4b64aac0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "offline_data_class": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_read_batch_size": null, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "materialize_data": false, "materialize_mapped_data": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "ignore_final_observation": false, "prelearner_class": null, "prelearner_buffer_class": null, "prelearner_buffer_kwargs": {}, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_remaining_data": false, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": 1, "evaluation_duration": 20, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_auto_duration_min_env_steps_per_sample": 100, "evaluation_auto_duration_max_env_steps_per_sample": 2000, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 1, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "offline_evaluation_interval": null, "num_offline_eval_runners": 0, "offline_loss_for_module_fn": null, "offline_evaluation_duration": 1, "offline_evaluation_parallel_to_training": false, "offline_evaluation_timeout_s": 120.0, "num_cpus_per_offline_eval_runner": 1, "num_gpus_per_offline_eval_runner": 0, "custom_resources_per_offline_eval_runner": {}, "restart_failed_offline_eval_runners": true, "ignore_offline_eval_runner_failures": false, "max_num_offline_eval_runner_restarts": 1000, "offline_eval_runner_restore_timeout_s": 1800.0, "max_requests_in_flight_per_offline_eval_runner": 1, "validate_offline_eval_runners_after_construction": true, "offline_eval_runner_health_probe_timeout_s": 30.0, "offline_eval_rl_module_inference_only": false, "broadcast_offline_eval_runner_states": false, "offline_eval_batch_size_per_runner": 256, "dataset_num_iters_per_eval_runner": 1, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "log_gradients": true, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 42, "restart_failed_env_runners": true, "ignore_env_runner_failures": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30.0, "env_runner_restore_timeout_s": 1800.0, "_model_config": {}, "_rl_module_spec": "RLModuleSpec(module_class=None, observation_space=None, action_space=None, inference_only=False, learner_only=False, model_config=DefaultModelConfig(fcnet_hiddens=[63, 126], fcnet_activation='tanh', fcnet_kernel_initializer=None, fcnet_kernel_initializer_kwargs=None, fcnet_bias_initializer=None, fcnet_bias_initializer_kwargs=None, conv_filters=None, conv_activation='relu', conv_kernel_initializer=None, conv_kernel_initializer_kwargs=None, conv_bias_initializer=None, conv_bias_initializer_kwargs=None, head_fcnet_hiddens=[], head_fcnet_activation='relu', head_fcnet_kernel_initializer=None, head_fcnet_kernel_initializer_kwargs=None, head_fcnet_bias_initializer=None, head_fcnet_bias_initializer_kwargs=None, free_log_std=False, log_std_clip_param=20.0, vf_share_layers=True, use_lstm=False, max_seq_len=20, lstm_cell_size=256, lstm_use_prev_action=False, lstm_use_prev_reward=False, lstm_kernel_initializer=None, lstm_kernel_initializer_kwargs=None, lstm_bias_initializer=None, lstm_bias_initializer_kwargs=None), catalog_class=None, load_state_path=None, model_config_dict=None)", "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "_validate_config": true, "_use_msgpack_checkpoints": false, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "env_task_fn": -1, "enable_connectors": -1, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.1024108006331, "kl_target": 0.0216481916482, "vf_loss_coeff": 0.5287015453939, "entropy_coeff": 0.0347123860443, "clip_param": 0.1072861819248, "vf_clip_param": 0.4447244315309, "entropy_coeff_schedule": null, "lr_schedule": null, "sgd_minibatch_size": -1, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9119716444993, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.callbacks.callbacks.RLlibCallback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 40.16421055793762, "iterations_since_restore": 8, "perf": {"cpu_util_percent": 13.214285714285714, "ram_util_percent": 70.0}}
{"timers": {"training_iteration": 4.320689842868485, "restore_env_runners": 1.5307620585335413e-05, "training_step": 4.320406912298659, "env_runner_sampling_timer": 3.863287448849591, "learner_update_timer": 0.45350102393041675, "synch_weights": 0.0014139198010200294, "restore_eval_env_runners": 1.4902477669011305e-05, "evaluation_iteration": 0.7425470467193273, "synch_eval_env_connectors": 0.0004684123176507128, "synch_env_connectors": 7.82864809368974e-06}, "env_runners": {"env_to_module_connector": {"timers": {"connectors": {"add_time_dim_to_batch_and_zero_pad": 6.828687502645304e-06, "add_states_from_episodes_to_batch": 3.5346625086638288e-06, "batch_individual_items": 1.8666503883897698e-05, "add_observations_from_episodes_to_batch": 6.564453064255588e-06, "numpy_to_tensor": 3.0866735833892e-05}}, "connector_pipeline_timer": 0.00012094018981011678}, "sample": 0.037751760674860545, "module_to_env_connector": {"timers": {"connectors": {"tensor_to_numpy": 5.01431628664969e-05, "listify_data_for_vector_env": 3.113783063649603e-05, "remove_single_ts_time_rank_from_batch": 1.4461426339423082e-06, "un_batch_to_individual_items": 1.4531805655341096e-05, "normalize_and_clip_actions": 2.236848014686449e-05, "get_actions": 0.0001662078713145827}}, "connector_pipeline_timer": 0.000364421626697006}, "episode_duration_sec_mean": 0.036920758210017085, "num_env_steps_sampled": 5000.0, "num_module_steps_sampled_lifetime": {"default_policy": -1687500.0}, "num_episodes": 100.0, "episode_len_max": 50, "num_episodes_lifetime": -33750.0, "episode_len_mean": 50.0, "env_to_module_sum_episodes_length_out": 27.16809333212661, "episode_return_max": -5.5, "num_agent_steps_sampled_lifetime": {"default_agent": -1687500.0}, "module_episode_returns_mean": {"default_policy": -5.5}, "env_reset_timer": 9.125487427585179e-05, "env_to_module_sum_episodes_length_in": 27.16809333212661, "agent_episode_returns_mean": {"default_agent": -5.5}, "episode_len_min": 50, "episode_return_mean": -5.5, "episode_return_min": -5.5, "num_agent_steps_sampled": {"default_agent": 5000.0}, "weights_seq_no": 8.0, "num_env_steps_sampled_lifetime": -1687500.0, "env_step_timer": 4.2698391906502005e-05, "time_between_sampling": 0.012834945157796478, "rlmodule_inference_timer": 0.00010306536596477452, "num_module_steps_sampled": {"default_policy": 5000.0}, "num_env_steps_sampled_lifetime_throughput": 1271.6305437706192}, "learners": {"__all_modules__": {"num_env_steps_trained_lifetime": 734400, "learner_connector": {"timers": {"connectors": {"numpy_to_tensor": 0.00016142380286291195, "add_observations_from_episodes_to_batch": 0.0007375260544965601, "add_columns_from_episodes_to_train_batch": 0.06802925960851211, "general_advantage_estimation": 0.014479160060700796, "add_time_dim_to_batch_and_zero_pad": 2.141726422160194e-05, "add_states_from_episodes_to_batch": 6.055428827295549e-06, "batch_individual_items": 0.19401187013521076, "add_one_ts_to_episodes_and_truncate": 0.008466418131584514}}, "connector_pipeline_timer": 0.28624486467223326}, "num_module_steps_trained_lifetime": 144000, "num_non_trainable_parameters": 0, "num_module_steps_trained": 16000, "num_trainable_parameters": 8697, "learner_connector_sum_episodes_length_in": 5000.0, "learner_connector_sum_episodes_length_out": 5100.0, "num_env_steps_trained": 81600, "num_env_steps_trained_lifetime_throughput": 906672.0079622571, "num_module_steps_trained_throughput": 178221.678536182, "num_module_steps_trained_lifetime_throughput": 178128.82263022196}, "default_policy": {"curr_kl_coeff": 0.7776820659637451, "gradients_default_optimizer_global_norm": 1.0507670640945435, "module_train_batch_size_mean": 1000.0, "weights_seq_no": 9.0, "mean_kl_loss": 0.032053131610155106, "diff_num_grad_updates_vs_sampler_policy": 1.0, "vf_loss": 0.44472458958625793, "vf_loss_unclipped": 486.3771667480469, "total_loss": 0.2800024151802063, "curr_entropy_coeff": 0.0347123860443, "policy_loss": 0.025685105472803116, "num_module_steps_trained_lifetime": 144000, "vf_explained_var": 0.6815923452377319, "default_optimizer_learning_rate": 0.0532857353826, "entropy": 0.16525377333164215, "num_module_steps_trained": 16000, "num_trainable_parameters": 8697, "num_module_steps_trained_lifetime_throughput": 178454.79495052734}}, "num_training_step_calls_per_iteration": 1, "evaluation": {"env_runners": {"env_to_module_connector": {"timers": {"connectors": {"numpy_to_tensor": 2.9369878434578085e-05, "add_observations_from_episodes_to_batch": 6.365636943331898e-06, "add_time_dim_to_batch_and_zero_pad": 5.422302588021039e-06, "batch_individual_items": 1.764643978362963e-05, "add_states_from_episodes_to_batch": 3.2504550539783294e-06}}, "connector_pipeline_timer": 0.00011544464266034316}, "num_episodes_lifetime": 180, "episode_len_mean": 50.0, "env_to_module_sum_episodes_length_out": 27.168093332126602, "module_to_env_connector": {"timers": {"connectors": {"get_actions": 0.00015363687525755544, "listify_data_for_vector_env": 3.0848603572850554e-05, "un_batch_to_individual_items": 1.547499861753287e-05, "remove_single_ts_time_rank_from_batch": 1.3936689521287424e-06, "normalize_and_clip_actions": 2.1697124060631813e-05, "tensor_to_numpy": 4.777040785798475e-05}}, "connector_pipeline_timer": 0.0003490671713243478}, "num_module_steps_sampled_lifetime": {"default_policy": 9000}, "weights_seq_no": 9.0, "num_env_steps_sampled_lifetime": 46000, "rlmodule_inference_timer": 9.405176787199445e-05, "num_env_steps_sampled": 1000, "num_agent_steps_sampled": {"default_agent": 1000}, "episode_len_min": 50, "episode_duration_sec_mean": 0.03494428817004518, "episode_len_max": 50, "episode_return_max": 17.5, "num_module_steps_sampled": {"default_policy": 1000}, "env_to_module_sum_episodes_length_in": 27.168093332126602, "episode_return_mean": 1.7, "num_agent_steps_sampled_lifetime": {"default_agent": 9000}, "agent_episode_returns_mean": {"default_agent": 1.7}, "num_episodes": 20, "env_reset_timer": 0.00022030141378355986, "module_episode_returns_mean": {"default_policy": 1.7}, "episode_return_min": -16.5, "env_step_timer": 4.1407609614091925e-05, "sample": 0.730791913770702, "time_between_sampling": 4.295903560511025}, "num_healthy_workers": 1, "actor_manager_num_outstanding_async_reqs": 0, "num_remote_worker_restarts": 0}, "num_env_steps_sampled_lifetime": -1687500.0, "fault_tolerance": {"num_healthy_workers": 0, "num_remote_worker_restarts": 0}, "env_runner_group": {"actor_manager_num_outstanding_async_reqs": 0}, "done": false, "training_iteration": 9, "trial_id": "05062_00000", "date": "2025-08-11_18-09-39", "timestamp": 1754928579, "time_this_iter_s": 4.944855213165283, "time_total_s": 45.109065771102905, "pid": 113125, "hostname": "DESKTOP-3SK5A41", "node_ip": "192.168.40.242", "config": {"exploration_config": {}, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 6, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "env": "Umbrella", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": false, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 0, "create_local_env_runner": true, "num_envs_per_env_runner": 1, "gym_env_vectorize_mode": "SYNC", "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "episodes_to_numpy": true, "max_requests_in_flight_per_env_runner": 1, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "merge_env_runner_states": "training_only", "broadcast_env_runner_states": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "complete_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "sampler_perf_stats_ema_coef": null, "_is_online": true, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": "auto", "num_aggregator_actors_per_learner": 0, "max_requests_in_flight_per_aggregator_actor": 3, "local_gpu_idx": 0, "max_requests_in_flight_per_learner": 3, "gamma": 1, "lr": 0.0532857353826, "grad_clip": 0.5, "grad_clip_by": "global_norm", "_train_batch_size_per_learner": 5000, "train_batch_size": 4000, "num_epochs": 3, "minibatch_size": 1000, "shuffle_batch_per_epoch": true, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "log_std_clip_param": 20.0, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "_disable_preprocessor_api": false, "_disable_action_flattening": false}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "_learner_class": null, "callbacks_on_algorithm_init": null, "callbacks_on_env_runners_recreated": null, "callbacks_on_offline_eval_runners_recreated": null, "callbacks_on_checkpoint_loaded": null, "callbacks_on_environment_created": null, "callbacks_on_episode_created": null, "callbacks_on_episode_start": null, "callbacks_on_episode_step": null, "callbacks_on_episode_end": null, "callbacks_on_evaluate_start": null, "callbacks_on_evaluate_end": null, "callbacks_on_evaluate_offline_start": null, "callbacks_on_evaluate_offline_end": null, "callbacks_on_sample_end": null, "callbacks_on_train_result": null, "explore": true, "enable_rl_module_and_learner": true, "enable_env_runner_and_connector_v2": true, "_prior_exploration_config": {"type": "StochasticSampling"}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x723d4b64aac0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "offline_data_class": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_read_batch_size": null, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "materialize_data": false, "materialize_mapped_data": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "ignore_final_observation": false, "prelearner_class": null, "prelearner_buffer_class": null, "prelearner_buffer_kwargs": {}, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_remaining_data": false, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": 1, "evaluation_duration": 20, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_auto_duration_min_env_steps_per_sample": 100, "evaluation_auto_duration_max_env_steps_per_sample": 2000, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 1, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "offline_evaluation_interval": null, "num_offline_eval_runners": 0, "offline_loss_for_module_fn": null, "offline_evaluation_duration": 1, "offline_evaluation_parallel_to_training": false, "offline_evaluation_timeout_s": 120.0, "num_cpus_per_offline_eval_runner": 1, "num_gpus_per_offline_eval_runner": 0, "custom_resources_per_offline_eval_runner": {}, "restart_failed_offline_eval_runners": true, "ignore_offline_eval_runner_failures": false, "max_num_offline_eval_runner_restarts": 1000, "offline_eval_runner_restore_timeout_s": 1800.0, "max_requests_in_flight_per_offline_eval_runner": 1, "validate_offline_eval_runners_after_construction": true, "offline_eval_runner_health_probe_timeout_s": 30.0, "offline_eval_rl_module_inference_only": false, "broadcast_offline_eval_runner_states": false, "offline_eval_batch_size_per_runner": 256, "dataset_num_iters_per_eval_runner": 1, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "log_gradients": true, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 42, "restart_failed_env_runners": true, "ignore_env_runner_failures": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30.0, "env_runner_restore_timeout_s": 1800.0, "_model_config": {}, "_rl_module_spec": "RLModuleSpec(module_class=None, observation_space=None, action_space=None, inference_only=False, learner_only=False, model_config=DefaultModelConfig(fcnet_hiddens=[63, 126], fcnet_activation='tanh', fcnet_kernel_initializer=None, fcnet_kernel_initializer_kwargs=None, fcnet_bias_initializer=None, fcnet_bias_initializer_kwargs=None, conv_filters=None, conv_activation='relu', conv_kernel_initializer=None, conv_kernel_initializer_kwargs=None, conv_bias_initializer=None, conv_bias_initializer_kwargs=None, head_fcnet_hiddens=[], head_fcnet_activation='relu', head_fcnet_kernel_initializer=None, head_fcnet_kernel_initializer_kwargs=None, head_fcnet_bias_initializer=None, head_fcnet_bias_initializer_kwargs=None, free_log_std=False, log_std_clip_param=20.0, vf_share_layers=True, use_lstm=False, max_seq_len=20, lstm_cell_size=256, lstm_use_prev_action=False, lstm_use_prev_reward=False, lstm_kernel_initializer=None, lstm_kernel_initializer_kwargs=None, lstm_bias_initializer=None, lstm_bias_initializer_kwargs=None), catalog_class=None, load_state_path=None, model_config_dict=None)", "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "_validate_config": true, "_use_msgpack_checkpoints": false, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "env_task_fn": -1, "enable_connectors": -1, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.1024108006331, "kl_target": 0.0216481916482, "vf_loss_coeff": 0.5287015453939, "entropy_coeff": 0.0347123860443, "clip_param": 0.1072861819248, "vf_clip_param": 0.4447244315309, "entropy_coeff_schedule": null, "lr_schedule": null, "sgd_minibatch_size": -1, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9119716444993, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.callbacks.callbacks.RLlibCallback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 45.109065771102905, "iterations_since_restore": 9, "perf": {"cpu_util_percent": 13.214285714285714, "ram_util_percent": 70.01428571428572}}
{"timers": {"training_iteration": 4.3205613437198025, "restore_env_runners": 1.527054438055343e-05, "training_step": 4.320277526455674, "env_runner_sampling_timer": 3.863751598611099, "learner_update_timer": 0.45290687072110547, "synch_weights": 0.0014140426030049712, "restore_eval_env_runners": 1.486945289339256e-05, "evaluation_iteration": 0.7425008553021349, "synch_eval_env_connectors": 0.0004675191944733882, "synch_env_connectors": 7.819361610645959e-06}, "env_runners": {"env_to_module_connector": {"timers": {"connectors": {"add_time_dim_to_batch_and_zero_pad": 6.7674750405852634e-06, "add_states_from_episodes_to_batch": 3.5196633607555187e-06, "batch_individual_items": 1.8327413669997663e-05, "add_observations_from_episodes_to_batch": 6.420733667496413e-06, "numpy_to_tensor": 3.059203800457324e-05}}, "connector_pipeline_timer": 0.000119715382986185}, "sample": 0.03775287571128964, "module_to_env_connector": {"timers": {"connectors": {"tensor_to_numpy": 4.9873976097459094e-05, "listify_data_for_vector_env": 3.073658159943192e-05, "remove_single_ts_time_rank_from_batch": 1.4381057747279632e-06, "un_batch_to_individual_items": 1.4522338606532759e-05, "normalize_and_clip_actions": 2.2125531862005093e-05, "get_actions": 0.00016533411231258176}}, "connector_pipeline_timer": 0.0003619033264331104}, "episode_duration_sec_mean": 0.03655793924002865, "num_env_steps_sampled": 5000.0, "num_module_steps_sampled_lifetime": {"default_policy": -1930000.0}, "num_episodes": 100.0, "episode_len_max": 50, "num_episodes_lifetime": -38600.0, "episode_len_mean": 50.0, "env_to_module_sum_episodes_length_out": 27.16809333212661, "episode_return_max": -5.5, "num_agent_steps_sampled_lifetime": {"default_agent": -1930000.0}, "module_episode_returns_mean": {"default_policy": -5.5}, "env_reset_timer": 9.049986636133799e-05, "env_to_module_sum_episodes_length_in": 27.16809333212661, "agent_episode_returns_mean": {"default_agent": -5.5}, "episode_len_min": 50, "episode_return_mean": -5.5, "episode_return_min": -5.5, "num_agent_steps_sampled": {"default_agent": 5000.0}, "weights_seq_no": 9.0, "num_env_steps_sampled_lifetime": -1930000.0, "env_step_timer": 4.23518057956974e-05, "time_between_sampling": 0.01221957404531111, "rlmodule_inference_timer": 0.00010167095916883432, "num_module_steps_sampled": {"default_policy": 5000.0}, "num_env_steps_sampled_lifetime_throughput": 1277.4103977959583}, "learners": {"__all_modules__": {"num_env_steps_trained_lifetime": 816000, "learner_connector": {"timers": {"connectors": {"numpy_to_tensor": 0.00016190156483855074, "add_observations_from_episodes_to_batch": 0.0007368947939536669, "add_columns_from_episodes_to_train_batch": 0.06801988302242146, "general_advantage_estimation": 0.014471766460100002, "add_time_dim_to_batch_and_zero_pad": 2.1411091580679762e-05, "add_states_from_episodes_to_batch": 6.04887454093262e-06, "batch_individual_items": 0.1941135384438614, "add_one_ts_to_episodes_and_truncate": 0.008462462950272148}}, "connector_pipeline_timer": 0.28632529904551585}, "num_module_steps_trained_lifetime": 160000, "num_non_trainable_parameters": 0, "num_module_steps_trained": 16000, "num_trainable_parameters": 8697, "learner_connector_sum_episodes_length_in": 5000.0, "learner_connector_sum_episodes_length_out": 5100.0, "num_env_steps_trained": 81600, "num_env_steps_trained_lifetime_throughput": 901741.3982007654, "num_module_steps_trained_throughput": 177235.25891527347, "num_module_steps_trained_lifetime_throughput": 177145.18129183858}, "default_policy": {"curr_kl_coeff": 0.38884103298187256, "gradients_default_optimizer_global_norm": 0.33901503682136536, "module_train_batch_size_mean": 1000.0, "weights_seq_no": 10.0, "mean_kl_loss": 0.010287762619554996, "diff_num_grad_updates_vs_sampler_policy": 1.0, "vf_loss": 0.44472455978393555, "vf_loss_unclipped": 540.8554077148438, "total_loss": 0.21292059123516083, "curr_entropy_coeff": 0.0347123860443, "policy_loss": -0.02905379980802536, "num_module_steps_trained_lifetime": 160000, "vf_explained_var": 0.48512089252471924, "default_optimizer_learning_rate": 0.0532857353826, "entropy": 0.03320707380771637, "num_module_steps_trained": 16000, "num_trainable_parameters": 8697, "num_module_steps_trained_lifetime_throughput": 177453.60748563005}}, "num_training_step_calls_per_iteration": 1, "evaluation": {"env_runners": {"env_to_module_connector": {"timers": {"connectors": {"numpy_to_tensor": 2.9162118680827067e-05, "add_observations_from_episodes_to_batch": 6.0710830103479766e-06, "add_time_dim_to_batch_and_zero_pad": 5.3412546345073215e-06, "batch_individual_items": 1.791267629725074e-05, "add_states_from_episodes_to_batch": 3.5918454709415576e-06}}, "connector_pipeline_timer": 0.00011615982422363671}, "num_episodes_lifetime": 200, "episode_len_mean": 50.0, "env_to_module_sum_episodes_length_out": 27.168093332126602, "module_to_env_connector": {"timers": {"connectors": {"get_actions": 0.00015130055232792772, "listify_data_for_vector_env": 3.0087309767933535e-05, "un_batch_to_individual_items": 1.536688756009182e-05, "remove_single_ts_time_rank_from_batch": 1.4356217257999847e-06, "normalize_and_clip_actions": 2.143089945029672e-05, "tensor_to_numpy": 4.4632094371919305e-05}}, "connector_pipeline_timer": 0.0003419267421872778}, "num_module_steps_sampled_lifetime": {"default_policy": 10000}, "weights_seq_no": 10.0, "num_env_steps_sampled_lifetime": 51000, "rlmodule_inference_timer": 9.148292702710053e-05, "num_env_steps_sampled": 1000, "num_agent_steps_sampled": {"default_agent": 1000}, "episode_len_min": 50, "episode_duration_sec_mean": 0.03496566020007776, "episode_len_max": 50, "episode_return_max": 17.5, "num_module_steps_sampled": {"default_policy": 1000}, "env_to_module_sum_episodes_length_in": 27.168093332126602, "episode_return_mean": 1.9, "num_agent_steps_sampled_lifetime": {"default_agent": 10000}, "agent_episode_returns_mean": {"default_agent": 1.9}, "num_episodes": 20, "env_reset_timer": 0.00021963039965140603, "module_episode_returns_mean": {"default_policy": 1.9}, "episode_return_min": -16.5, "env_step_timer": 4.107706548607685e-05, "sample": 0.7307617776829985, "time_between_sampling": 4.296580213185916}, "num_healthy_workers": 1, "actor_manager_num_outstanding_async_reqs": 0, "num_remote_worker_restarts": 0}, "num_env_steps_sampled_lifetime": -1930000.0, "fault_tolerance": {"num_healthy_workers": 0, "num_remote_worker_restarts": 0}, "env_runner_group": {"actor_manager_num_outstanding_async_reqs": 0}, "done": false, "training_iteration": 10, "trial_id": "05062_00000", "date": "2025-08-11_18-09-44", "timestamp": 1754928584, "time_this_iter_s": 5.050541162490845, "time_total_s": 50.15960693359375, "pid": 113125, "hostname": "DESKTOP-3SK5A41", "node_ip": "192.168.40.242", "config": {"exploration_config": {}, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 6, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "env": "Umbrella", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": false, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 0, "create_local_env_runner": true, "num_envs_per_env_runner": 1, "gym_env_vectorize_mode": "SYNC", "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "episodes_to_numpy": true, "max_requests_in_flight_per_env_runner": 1, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "merge_env_runner_states": "training_only", "broadcast_env_runner_states": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "complete_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "sampler_perf_stats_ema_coef": null, "_is_online": true, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": "auto", "num_aggregator_actors_per_learner": 0, "max_requests_in_flight_per_aggregator_actor": 3, "local_gpu_idx": 0, "max_requests_in_flight_per_learner": 3, "gamma": 1, "lr": 0.0532857353826, "grad_clip": 0.5, "grad_clip_by": "global_norm", "_train_batch_size_per_learner": 5000, "train_batch_size": 4000, "num_epochs": 3, "minibatch_size": 1000, "shuffle_batch_per_epoch": true, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "log_std_clip_param": 20.0, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "_disable_preprocessor_api": false, "_disable_action_flattening": false}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "_learner_class": null, "callbacks_on_algorithm_init": null, "callbacks_on_env_runners_recreated": null, "callbacks_on_offline_eval_runners_recreated": null, "callbacks_on_checkpoint_loaded": null, "callbacks_on_environment_created": null, "callbacks_on_episode_created": null, "callbacks_on_episode_start": null, "callbacks_on_episode_step": null, "callbacks_on_episode_end": null, "callbacks_on_evaluate_start": null, "callbacks_on_evaluate_end": null, "callbacks_on_evaluate_offline_start": null, "callbacks_on_evaluate_offline_end": null, "callbacks_on_sample_end": null, "callbacks_on_train_result": null, "explore": true, "enable_rl_module_and_learner": true, "enable_env_runner_and_connector_v2": true, "_prior_exploration_config": {"type": "StochasticSampling"}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x723d4b64aac0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "offline_data_class": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_read_batch_size": null, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "materialize_data": false, "materialize_mapped_data": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "ignore_final_observation": false, "prelearner_class": null, "prelearner_buffer_class": null, "prelearner_buffer_kwargs": {}, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_remaining_data": false, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": 1, "evaluation_duration": 20, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_auto_duration_min_env_steps_per_sample": 100, "evaluation_auto_duration_max_env_steps_per_sample": 2000, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 1, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "offline_evaluation_interval": null, "num_offline_eval_runners": 0, "offline_loss_for_module_fn": null, "offline_evaluation_duration": 1, "offline_evaluation_parallel_to_training": false, "offline_evaluation_timeout_s": 120.0, "num_cpus_per_offline_eval_runner": 1, "num_gpus_per_offline_eval_runner": 0, "custom_resources_per_offline_eval_runner": {}, "restart_failed_offline_eval_runners": true, "ignore_offline_eval_runner_failures": false, "max_num_offline_eval_runner_restarts": 1000, "offline_eval_runner_restore_timeout_s": 1800.0, "max_requests_in_flight_per_offline_eval_runner": 1, "validate_offline_eval_runners_after_construction": true, "offline_eval_runner_health_probe_timeout_s": 30.0, "offline_eval_rl_module_inference_only": false, "broadcast_offline_eval_runner_states": false, "offline_eval_batch_size_per_runner": 256, "dataset_num_iters_per_eval_runner": 1, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "log_gradients": true, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 42, "restart_failed_env_runners": true, "ignore_env_runner_failures": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30.0, "env_runner_restore_timeout_s": 1800.0, "_model_config": {}, "_rl_module_spec": "RLModuleSpec(module_class=None, observation_space=None, action_space=None, inference_only=False, learner_only=False, model_config=DefaultModelConfig(fcnet_hiddens=[63, 126], fcnet_activation='tanh', fcnet_kernel_initializer=None, fcnet_kernel_initializer_kwargs=None, fcnet_bias_initializer=None, fcnet_bias_initializer_kwargs=None, conv_filters=None, conv_activation='relu', conv_kernel_initializer=None, conv_kernel_initializer_kwargs=None, conv_bias_initializer=None, conv_bias_initializer_kwargs=None, head_fcnet_hiddens=[], head_fcnet_activation='relu', head_fcnet_kernel_initializer=None, head_fcnet_kernel_initializer_kwargs=None, head_fcnet_bias_initializer=None, head_fcnet_bias_initializer_kwargs=None, free_log_std=False, log_std_clip_param=20.0, vf_share_layers=True, use_lstm=False, max_seq_len=20, lstm_cell_size=256, lstm_use_prev_action=False, lstm_use_prev_reward=False, lstm_kernel_initializer=None, lstm_kernel_initializer_kwargs=None, lstm_bias_initializer=None, lstm_bias_initializer_kwargs=None), catalog_class=None, load_state_path=None, model_config_dict=None)", "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "_validate_config": true, "_use_msgpack_checkpoints": false, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "env_task_fn": -1, "enable_connectors": -1, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.1024108006331, "kl_target": 0.0216481916482, "vf_loss_coeff": 0.5287015453939, "entropy_coeff": 0.0347123860443, "clip_param": 0.1072861819248, "vf_clip_param": 0.4447244315309, "entropy_coeff_schedule": null, "lr_schedule": null, "sgd_minibatch_size": -1, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9119716444993, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.callbacks.callbacks.RLlibCallback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 50.15960693359375, "iterations_since_restore": 10, "perf": {"cpu_util_percent": 13.1, "ram_util_percent": 69.98571428571428}}
{"timers": {"training_iteration": 4.319172940572605, "restore_env_runners": 1.5247838935282808e-05, "training_step": 4.318886784481115, "env_runner_sampling_timer": 3.8644274718949885, "learner_update_timer": 0.45083793303389225, "synch_weights": 0.0014149181769724799, "restore_eval_env_runners": 1.4833758360876419e-05, "evaluation_iteration": 0.7424532087991151, "synch_eval_env_connectors": 0.0004695640025207829, "synch_env_connectors": 7.79916799052771e-06}, "env_runners": {"env_to_module_connector": {"timers": {"connectors": {"add_time_dim_to_batch_and_zero_pad": 6.765267148609e-06, "add_states_from_episodes_to_batch": 3.5210564744527716e-06, "batch_individual_items": 1.853894209335163e-05, "add_observations_from_episodes_to_batch": 6.563080932939658e-06, "numpy_to_tensor": 3.087231943270344e-05}}, "connector_pipeline_timer": 0.00012062322272267311}, "sample": 0.037756995712715694, "module_to_env_connector": {"timers": {"connectors": {"tensor_to_numpy": 4.993297521886095e-05, "listify_data_for_vector_env": 3.091914091907198e-05, "remove_single_ts_time_rank_from_batch": 1.439556728614251e-06, "un_batch_to_individual_items": 1.4577647253689054e-05, "normalize_and_clip_actions": 2.2186417581711143e-05, "get_actions": 0.0001657972001037322}}, "connector_pipeline_timer": 0.000363143002976932}, "episode_duration_sec_mean": 0.03674786324999331, "num_env_steps_sampled": 5000.0, "num_module_steps_sampled_lifetime": {"default_policy": -2172500.0}, "num_episodes": 100.0, "episode_len_max": 50, "num_episodes_lifetime": -43450.0, "episode_len_mean": 50.0, "env_to_module_sum_episodes_length_out": 27.16809333212661, "episode_return_max": -5.5, "num_agent_steps_sampled_lifetime": {"default_agent": -2172500.0}, "module_episode_returns_mean": {"default_policy": -5.5}, "env_reset_timer": 9.095336456014732e-05, "env_to_module_sum_episodes_length_in": 27.16809333212661, "agent_episode_returns_mean": {"default_agent": -5.5}, "episode_len_min": 50, "episode_return_mean": -5.5, "episode_return_min": -5.5, "num_agent_steps_sampled": {"default_agent": 5000.0}, "weights_seq_no": 10.0, "num_env_steps_sampled_lifetime": -2172500.0, "env_step_timer": 4.253010188540888e-05, "time_between_sampling": 0.012898927933248587, "rlmodule_inference_timer": 0.00010262570430581041, "num_module_steps_sampled": {"default_policy": 5000.0}, "num_env_steps_sampled_lifetime_throughput": 1273.0612019057442}, "learners": {"__all_modules__": {"num_env_steps_trained_lifetime": 897600, "learner_connector": {"timers": {"connectors": {"numpy_to_tensor": 0.00016189554919416455, "add_observations_from_episodes_to_batch": 0.0007364068460134693, "add_columns_from_episodes_to_train_batch": 0.06801219920219825, "general_advantage_estimation": 0.014421454795497345, "add_time_dim_to_batch_and_zero_pad": 2.1408980669339936e-05, "add_states_from_episodes_to_batch": 6.042385788338373e-06, "batch_individual_items": 0.19275148005942494, "add_one_ts_to_episodes_and_truncate": 0.008460981320771083}}, "connector_pipeline_timer": 0.2849031420650638}, "num_module_steps_trained_lifetime": 176000, "num_non_trainable_parameters": 0, "num_module_steps_trained": 16000, "num_trainable_parameters": 8697, "learner_connector_sum_episodes_length_in": 5000.0, "learner_connector_sum_episodes_length_out": 5100.0, "num_env_steps_trained": 81600, "num_env_steps_trained_lifetime_throughput": 896909.9421961667, "num_module_steps_trained_throughput": 176268.03070033024, "num_module_steps_trained_lifetime_throughput": 176181.60463153818}, "default_policy": {"curr_kl_coeff": 0.38884103298187256, "gradients_default_optimizer_global_norm": 0.06453527510166168, "module_train_batch_size_mean": 1000.0, "weights_seq_no": 11.0, "mean_kl_loss": 0.024070728570222855, "diff_num_grad_updates_vs_sampler_policy": 1.0, "vf_loss": 0.42653733491897583, "vf_loss_unclipped": 181.38986206054688, "total_loss": 0.1799175888299942, "curr_entropy_coeff": 0.0347123860443, "policy_loss": -0.05488179996609688, "num_module_steps_trained_lifetime": 176000, "vf_explained_var": 0.19176000356674194, "default_optimizer_learning_rate": 0.0532857353826, "entropy": 0.002051421906799078, "num_module_steps_trained": 16000, "num_trainable_parameters": 8697, "num_module_steps_trained_lifetime_throughput": 176473.5593279994}}, "num_training_step_calls_per_iteration": 1, "evaluation": {"env_runners": {"env_to_module_connector": {"timers": {"connectors": {"numpy_to_tensor": 2.8839281325306495e-05, "add_observations_from_episodes_to_batch": 6.5298601986648105e-06, "add_time_dim_to_batch_and_zero_pad": 5.300072569868529e-06, "batch_individual_items": 1.7484511811117458e-05, "add_states_from_episodes_to_batch": 3.474249631726162e-06}}, "connector_pipeline_timer": 0.00011380220825400941}, "num_episodes_lifetime": 220, "episode_len_mean": 50.0, "env_to_module_sum_episodes_length_out": 27.168093332126602, "module_to_env_connector": {"timers": {"connectors": {"get_actions": 0.0001512403869730496, "listify_data_for_vector_env": 2.9912514073613703e-05, "un_batch_to_individual_items": 1.4847600958125411e-05, "remove_single_ts_time_rank_from_batch": 1.4368896825827358e-06, "normalize_and_clip_actions": 2.1849762920826273e-05, "tensor_to_numpy": 4.363388989499982e-05}}, "connector_pipeline_timer": 0.0003401405909693685}, "num_module_steps_sampled_lifetime": {"default_policy": 11000}, "weights_seq_no": 11.0, "num_env_steps_sampled_lifetime": 56000, "rlmodule_inference_timer": 9.353727552280865e-05, "num_env_steps_sampled": 1000, "num_agent_steps_sampled": {"default_agent": 1000}, "episode_len_min": 50, "episode_duration_sec_mean": 0.034858140220094355, "episode_len_max": 50, "episode_return_max": 17.5, "num_module_steps_sampled": {"default_policy": 1000}, "env_to_module_sum_episodes_length_in": 27.168093332126602, "episode_return_mean": 1.7, "num_agent_steps_sampled_lifetime": {"default_agent": 11000}, "agent_episode_returns_mean": {"default_agent": 1.7}, "num_episodes": 20, "env_reset_timer": 0.00021863909565355492, "module_episode_returns_mean": {"default_policy": 1.7}, "episode_return_min": -16.5, "env_step_timer": 4.125702291737025e-05, "sample": 0.7306910219361725, "time_between_sampling": 4.2959701003440545}, "num_healthy_workers": 1, "actor_manager_num_outstanding_async_reqs": 0, "num_remote_worker_restarts": 0}, "num_env_steps_sampled_lifetime": -2172500.0, "fault_tolerance": {"num_healthy_workers": 0, "num_remote_worker_restarts": 0}, "env_runner_group": {"actor_manager_num_outstanding_async_reqs": 0}, "done": false, "training_iteration": 11, "trial_id": "05062_00000", "date": "2025-08-11_18-09-49", "timestamp": 1754928589, "time_this_iter_s": 4.919214248657227, "time_total_s": 55.07882118225098, "pid": 113125, "hostname": "DESKTOP-3SK5A41", "node_ip": "192.168.40.242", "config": {"exploration_config": {}, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 6, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "env": "Umbrella", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": false, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 0, "create_local_env_runner": true, "num_envs_per_env_runner": 1, "gym_env_vectorize_mode": "SYNC", "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "episodes_to_numpy": true, "max_requests_in_flight_per_env_runner": 1, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "merge_env_runner_states": "training_only", "broadcast_env_runner_states": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "complete_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "sampler_perf_stats_ema_coef": null, "_is_online": true, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": "auto", "num_aggregator_actors_per_learner": 0, "max_requests_in_flight_per_aggregator_actor": 3, "local_gpu_idx": 0, "max_requests_in_flight_per_learner": 3, "gamma": 1, "lr": 0.0532857353826, "grad_clip": 0.5, "grad_clip_by": "global_norm", "_train_batch_size_per_learner": 5000, "train_batch_size": 4000, "num_epochs": 3, "minibatch_size": 1000, "shuffle_batch_per_epoch": true, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "log_std_clip_param": 20.0, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "_disable_preprocessor_api": false, "_disable_action_flattening": false}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "_learner_class": null, "callbacks_on_algorithm_init": null, "callbacks_on_env_runners_recreated": null, "callbacks_on_offline_eval_runners_recreated": null, "callbacks_on_checkpoint_loaded": null, "callbacks_on_environment_created": null, "callbacks_on_episode_created": null, "callbacks_on_episode_start": null, "callbacks_on_episode_step": null, "callbacks_on_episode_end": null, "callbacks_on_evaluate_start": null, "callbacks_on_evaluate_end": null, "callbacks_on_evaluate_offline_start": null, "callbacks_on_evaluate_offline_end": null, "callbacks_on_sample_end": null, "callbacks_on_train_result": null, "explore": true, "enable_rl_module_and_learner": true, "enable_env_runner_and_connector_v2": true, "_prior_exploration_config": {"type": "StochasticSampling"}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x723d4b64aac0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "offline_data_class": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_read_batch_size": null, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "materialize_data": false, "materialize_mapped_data": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "ignore_final_observation": false, "prelearner_class": null, "prelearner_buffer_class": null, "prelearner_buffer_kwargs": {}, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_remaining_data": false, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": 1, "evaluation_duration": 20, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_auto_duration_min_env_steps_per_sample": 100, "evaluation_auto_duration_max_env_steps_per_sample": 2000, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 1, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "offline_evaluation_interval": null, "num_offline_eval_runners": 0, "offline_loss_for_module_fn": null, "offline_evaluation_duration": 1, "offline_evaluation_parallel_to_training": false, "offline_evaluation_timeout_s": 120.0, "num_cpus_per_offline_eval_runner": 1, "num_gpus_per_offline_eval_runner": 0, "custom_resources_per_offline_eval_runner": {}, "restart_failed_offline_eval_runners": true, "ignore_offline_eval_runner_failures": false, "max_num_offline_eval_runner_restarts": 1000, "offline_eval_runner_restore_timeout_s": 1800.0, "max_requests_in_flight_per_offline_eval_runner": 1, "validate_offline_eval_runners_after_construction": true, "offline_eval_runner_health_probe_timeout_s": 30.0, "offline_eval_rl_module_inference_only": false, "broadcast_offline_eval_runner_states": false, "offline_eval_batch_size_per_runner": 256, "dataset_num_iters_per_eval_runner": 1, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "log_gradients": true, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 42, "restart_failed_env_runners": true, "ignore_env_runner_failures": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30.0, "env_runner_restore_timeout_s": 1800.0, "_model_config": {}, "_rl_module_spec": "RLModuleSpec(module_class=None, observation_space=None, action_space=None, inference_only=False, learner_only=False, model_config=DefaultModelConfig(fcnet_hiddens=[63, 126], fcnet_activation='tanh', fcnet_kernel_initializer=None, fcnet_kernel_initializer_kwargs=None, fcnet_bias_initializer=None, fcnet_bias_initializer_kwargs=None, conv_filters=None, conv_activation='relu', conv_kernel_initializer=None, conv_kernel_initializer_kwargs=None, conv_bias_initializer=None, conv_bias_initializer_kwargs=None, head_fcnet_hiddens=[], head_fcnet_activation='relu', head_fcnet_kernel_initializer=None, head_fcnet_kernel_initializer_kwargs=None, head_fcnet_bias_initializer=None, head_fcnet_bias_initializer_kwargs=None, free_log_std=False, log_std_clip_param=20.0, vf_share_layers=True, use_lstm=False, max_seq_len=20, lstm_cell_size=256, lstm_use_prev_action=False, lstm_use_prev_reward=False, lstm_kernel_initializer=None, lstm_kernel_initializer_kwargs=None, lstm_bias_initializer=None, lstm_bias_initializer_kwargs=None), catalog_class=None, load_state_path=None, model_config_dict=None)", "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "_validate_config": true, "_use_msgpack_checkpoints": false, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "env_task_fn": -1, "enable_connectors": -1, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.1024108006331, "kl_target": 0.0216481916482, "vf_loss_coeff": 0.5287015453939, "entropy_coeff": 0.0347123860443, "clip_param": 0.1072861819248, "vf_clip_param": 0.4447244315309, "entropy_coeff_schedule": null, "lr_schedule": null, "sgd_minibatch_size": -1, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9119716444993, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.callbacks.callbacks.RLlibCallback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 55.07882118225098, "iterations_since_restore": 11, "perf": {"cpu_util_percent": 12.957142857142857, "ram_util_percent": 69.94285714285715}}
{"timers": {"training_iteration": 4.318869052236875, "restore_env_runners": 1.5203360549750032e-05, "training_step": 4.3185825877063095, "env_runner_sampling_timer": 3.86488685023604, "learner_update_timer": 0.450073062713554, "synch_weights": 0.001414987995197892, "restore_eval_env_runners": 1.4801420778339024e-05, "evaluation_iteration": 0.7423607457411228, "synch_eval_env_connectors": 0.00046886536249901237, "synch_env_connectors": 7.785176306822871e-06}, "env_runners": {"env_to_module_connector": {"timers": {"connectors": {"add_time_dim_to_batch_and_zero_pad": 6.7549209895180065e-06, "add_states_from_episodes_to_batch": 3.5355332249924495e-06, "batch_individual_items": 1.8391349835139705e-05, "add_observations_from_episodes_to_batch": 6.489036315002038e-06, "numpy_to_tensor": 3.060032545263347e-05}}, "connector_pipeline_timer": 0.00011997329216230628}, "sample": 0.03769007752452344, "module_to_env_connector": {"timers": {"connectors": {"tensor_to_numpy": 4.9900065875380475e-05, "listify_data_for_vector_env": 3.07534738547338e-05, "remove_single_ts_time_rank_from_batch": 1.4344821998066577e-06, "un_batch_to_individual_items": 1.4507541077924077e-05, "normalize_and_clip_actions": 2.2192616554977578e-05, "get_actions": 0.00016469041071338203}}, "connector_pipeline_timer": 0.0003614982911709294}, "episode_duration_sec_mean": 0.036572402059964586, "num_env_steps_sampled": 5000.0, "num_module_steps_sampled_lifetime": {"default_policy": -2415000.0}, "num_episodes": 100.0, "episode_len_max": 50, "num_episodes_lifetime": -48300.0, "episode_len_mean": 50.0, "env_to_module_sum_episodes_length_out": 27.16809333212661, "episode_return_max": -5.5, "num_agent_steps_sampled_lifetime": {"default_agent": -2415000.0}, "module_episode_returns_mean": {"default_policy": -5.5}, "env_reset_timer": 9.166248926980653e-05, "env_to_module_sum_episodes_length_in": 27.16809333212661, "agent_episode_returns_mean": {"default_agent": -5.5}, "episode_len_min": 50, "episode_return_mean": -5.5, "episode_return_min": -5.5, "num_agent_steps_sampled": {"default_agent": 5000.0}, "weights_seq_no": 11.0, "num_env_steps_sampled_lifetime": -2415000.0, "env_step_timer": 4.220892998747299e-05, "time_between_sampling": 0.012175757405681635, "rlmodule_inference_timer": 0.00010177277147610861, "num_module_steps_sampled": {"default_policy": 5000.0}, "num_env_steps_sampled_lifetime_throughput": 1279.5030267656182}, "learners": {"__all_modules__": {"num_env_steps_trained_lifetime": 979200, "learner_connector": {"timers": {"connectors": {"numpy_to_tensor": 0.0001618585936975466, "add_observations_from_episodes_to_batch": 0.0007358117775547755, "add_columns_from_episodes_to_train_batch": 0.06799747821018193, "general_advantage_estimation": 0.014380721247547931, "add_time_dim_to_batch_and_zero_pad": 2.139989086838174e-05, "add_states_from_episodes_to_batch": 6.038961937018601e-06, "batch_individual_items": 0.19286935426883048, "add_one_ts_to_episodes_and_truncate": 0.008458003507564637}}, "connector_pipeline_timer": 0.284961702654419}, "num_module_steps_trained_lifetime": 192000, "num_non_trainable_parameters": 0, "num_module_steps_trained": 16000, "num_trainable_parameters": 8697, "learner_connector_sum_episodes_length_in": 5000.0, "learner_connector_sum_episodes_length_out": 5100.0, "num_env_steps_trained": 81600, "num_env_steps_trained_lifetime_throughput": 897016.277240821, "num_module_steps_trained_throughput": 176269.8541536441, "num_module_steps_trained_lifetime_throughput": 176186.61450608802}, "default_policy": {"curr_kl_coeff": 0.19442051649093628, "gradients_default_optimizer_global_norm": 0.005233432166278362, "module_train_batch_size_mean": 1000.0, "weights_seq_no": 12.0, "mean_kl_loss": 0.0004717887204606086, "diff_num_grad_updates_vs_sampler_policy": 1.0, "vf_loss": 0.44472455978393555, "vf_loss_unclipped": 138.65093994140625, "total_loss": 0.20119377970695496, "curr_entropy_coeff": 0.0347123860443, "policy_loss": -0.03391178324818611, "num_module_steps_trained_lifetime": 192000, "vf_explained_var": 0.022832393646240234, "default_optimizer_learning_rate": 0.0532857353826, "entropy": 0.005888089071959257, "num_module_steps_trained": 16000, "num_trainable_parameters": 8697, "num_module_steps_trained_lifetime_throughput": 176460.72951579335}}, "num_training_step_calls_per_iteration": 1, "evaluation": {"env_runners": {"env_to_module_connector": {"timers": {"connectors": {"numpy_to_tensor": 2.9022335866015007e-05, "add_observations_from_episodes_to_batch": 6.097478769551896e-06, "add_time_dim_to_batch_and_zero_pad": 5.356692457858502e-06, "batch_individual_items": 1.7603108833812497e-05, "add_states_from_episodes_to_batch": 3.148046346832769e-06}}, "connector_pipeline_timer": 0.00011375591576094948}, "num_episodes_lifetime": 240, "episode_len_mean": 50.0, "env_to_module_sum_episodes_length_out": 27.168093332126602, "module_to_env_connector": {"timers": {"connectors": {"get_actions": 0.00015075344097944537, "listify_data_for_vector_env": 3.03839902953364e-05, "un_batch_to_individual_items": 1.4851545884578889e-05, "remove_single_ts_time_rank_from_batch": 1.350125415394553e-06, "normalize_and_clip_actions": 2.15046734022505e-05, "tensor_to_numpy": 4.388258726985224e-05}}, "connector_pipeline_timer": 0.0003386681741216832}, "num_module_steps_sampled_lifetime": {"default_policy": 12000}, "weights_seq_no": 12.0, "num_env_steps_sampled_lifetime": 61000, "rlmodule_inference_timer": 9.14474004698869e-05, "num_env_steps_sampled": 1000, "num_agent_steps_sampled": {"default_agent": 1000}, "episode_len_min": 50, "episode_duration_sec_mean": 0.034835092170051214, "episode_len_max": 50, "episode_return_max": 17.5, "num_module_steps_sampled": {"default_policy": 1000}, "env_to_module_sum_episodes_length_in": 27.168093332126602, "episode_return_mean": 1.7, "num_agent_steps_sampled_lifetime": {"default_agent": 12000}, "agent_episode_returns_mean": {"default_agent": 1.7}, "num_episodes": 20, "env_reset_timer": 0.00021763370469483342, "module_episode_returns_mean": {"default_policy": 1.7}, "episode_return_min": -16.5, "env_step_timer": 4.118340076052163e-05, "sample": 0.7305943747268124, "time_between_sampling": 4.296429890420617}, "num_healthy_workers": 1, "actor_manager_num_outstanding_async_reqs": 0, "num_remote_worker_restarts": 0}, "num_env_steps_sampled_lifetime": -2415000.0, "fault_tolerance": {"num_healthy_workers": 0, "num_remote_worker_restarts": 0}, "env_runner_group": {"actor_manager_num_outstanding_async_reqs": 0}, "done": false, "training_iteration": 12, "trial_id": "05062_00000", "date": "2025-08-11_18-09-54", "timestamp": 1754928594, "time_this_iter_s": 5.024013996124268, "time_total_s": 60.102835178375244, "pid": 113125, "hostname": "DESKTOP-3SK5A41", "node_ip": "192.168.40.242", "config": {"exploration_config": {}, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 6, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "env": "Umbrella", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": false, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 0, "create_local_env_runner": true, "num_envs_per_env_runner": 1, "gym_env_vectorize_mode": "SYNC", "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "episodes_to_numpy": true, "max_requests_in_flight_per_env_runner": 1, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "merge_env_runner_states": "training_only", "broadcast_env_runner_states": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "complete_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "sampler_perf_stats_ema_coef": null, "_is_online": true, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": "auto", "num_aggregator_actors_per_learner": 0, "max_requests_in_flight_per_aggregator_actor": 3, "local_gpu_idx": 0, "max_requests_in_flight_per_learner": 3, "gamma": 1, "lr": 0.0532857353826, "grad_clip": 0.5, "grad_clip_by": "global_norm", "_train_batch_size_per_learner": 5000, "train_batch_size": 4000, "num_epochs": 3, "minibatch_size": 1000, "shuffle_batch_per_epoch": true, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "log_std_clip_param": 20.0, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "_disable_preprocessor_api": false, "_disable_action_flattening": false}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "_learner_class": null, "callbacks_on_algorithm_init": null, "callbacks_on_env_runners_recreated": null, "callbacks_on_offline_eval_runners_recreated": null, "callbacks_on_checkpoint_loaded": null, "callbacks_on_environment_created": null, "callbacks_on_episode_created": null, "callbacks_on_episode_start": null, "callbacks_on_episode_step": null, "callbacks_on_episode_end": null, "callbacks_on_evaluate_start": null, "callbacks_on_evaluate_end": null, "callbacks_on_evaluate_offline_start": null, "callbacks_on_evaluate_offline_end": null, "callbacks_on_sample_end": null, "callbacks_on_train_result": null, "explore": true, "enable_rl_module_and_learner": true, "enable_env_runner_and_connector_v2": true, "_prior_exploration_config": {"type": "StochasticSampling"}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x723d4b64aac0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "offline_data_class": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_read_batch_size": null, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "materialize_data": false, "materialize_mapped_data": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "ignore_final_observation": false, "prelearner_class": null, "prelearner_buffer_class": null, "prelearner_buffer_kwargs": {}, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_remaining_data": false, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": 1, "evaluation_duration": 20, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_auto_duration_min_env_steps_per_sample": 100, "evaluation_auto_duration_max_env_steps_per_sample": 2000, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 1, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "offline_evaluation_interval": null, "num_offline_eval_runners": 0, "offline_loss_for_module_fn": null, "offline_evaluation_duration": 1, "offline_evaluation_parallel_to_training": false, "offline_evaluation_timeout_s": 120.0, "num_cpus_per_offline_eval_runner": 1, "num_gpus_per_offline_eval_runner": 0, "custom_resources_per_offline_eval_runner": {}, "restart_failed_offline_eval_runners": true, "ignore_offline_eval_runner_failures": false, "max_num_offline_eval_runner_restarts": 1000, "offline_eval_runner_restore_timeout_s": 1800.0, "max_requests_in_flight_per_offline_eval_runner": 1, "validate_offline_eval_runners_after_construction": true, "offline_eval_runner_health_probe_timeout_s": 30.0, "offline_eval_rl_module_inference_only": false, "broadcast_offline_eval_runner_states": false, "offline_eval_batch_size_per_runner": 256, "dataset_num_iters_per_eval_runner": 1, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "log_gradients": true, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 42, "restart_failed_env_runners": true, "ignore_env_runner_failures": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30.0, "env_runner_restore_timeout_s": 1800.0, "_model_config": {}, "_rl_module_spec": "RLModuleSpec(module_class=None, observation_space=None, action_space=None, inference_only=False, learner_only=False, model_config=DefaultModelConfig(fcnet_hiddens=[63, 126], fcnet_activation='tanh', fcnet_kernel_initializer=None, fcnet_kernel_initializer_kwargs=None, fcnet_bias_initializer=None, fcnet_bias_initializer_kwargs=None, conv_filters=None, conv_activation='relu', conv_kernel_initializer=None, conv_kernel_initializer_kwargs=None, conv_bias_initializer=None, conv_bias_initializer_kwargs=None, head_fcnet_hiddens=[], head_fcnet_activation='relu', head_fcnet_kernel_initializer=None, head_fcnet_kernel_initializer_kwargs=None, head_fcnet_bias_initializer=None, head_fcnet_bias_initializer_kwargs=None, free_log_std=False, log_std_clip_param=20.0, vf_share_layers=True, use_lstm=False, max_seq_len=20, lstm_cell_size=256, lstm_use_prev_action=False, lstm_use_prev_reward=False, lstm_kernel_initializer=None, lstm_kernel_initializer_kwargs=None, lstm_bias_initializer=None, lstm_bias_initializer_kwargs=None), catalog_class=None, load_state_path=None, model_config_dict=None)", "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "_validate_config": true, "_use_msgpack_checkpoints": false, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "env_task_fn": -1, "enable_connectors": -1, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.1024108006331, "kl_target": 0.0216481916482, "vf_loss_coeff": 0.5287015453939, "entropy_coeff": 0.0347123860443, "clip_param": 0.1072861819248, "vf_clip_param": 0.4447244315309, "entropy_coeff_schedule": null, "lr_schedule": null, "sgd_minibatch_size": -1, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9119716444993, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.callbacks.callbacks.RLlibCallback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 60.102835178375244, "iterations_since_restore": 12, "perf": {"cpu_util_percent": 12.7625, "ram_util_percent": 69.9375}}
{"timers": {"training_iteration": 4.317777416774509, "restore_env_runners": 1.5167326945323901e-05, "training_step": 4.317489596889249, "env_runner_sampling_timer": 3.8657344297936787, "learner_update_timer": 0.44810924108641886, "synch_weights": 0.0014324131152486169, "restore_eval_env_runners": 1.4760406566761193e-05, "evaluation_iteration": 0.742243507293714, "synch_eval_env_connectors": 0.0004679787088751097, "synch_env_connectors": 7.772324538474626e-06}, "env_runners": {"env_to_module_connector": {"timers": {"connectors": {"add_time_dim_to_batch_and_zero_pad": 6.909640619035056e-06, "add_states_from_episodes_to_batch": 3.5437591108831707e-06, "batch_individual_items": 1.857388770604039e-05, "add_observations_from_episodes_to_batch": 6.560958751100576e-06, "numpy_to_tensor": 3.086006159272634e-05}}, "connector_pipeline_timer": 0.00012082585210065387}, "sample": 0.03771884687188493, "module_to_env_connector": {"timers": {"connectors": {"tensor_to_numpy": 5.010571809951445e-05, "listify_data_for_vector_env": 3.1127195391780374e-05, "remove_single_ts_time_rank_from_batch": 1.4392831558581555e-06, "un_batch_to_individual_items": 1.4550769523513788e-05, "normalize_and_clip_actions": 2.233020825225653e-05, "get_actions": 0.0001656486791131588}}, "connector_pipeline_timer": 0.00036359920007977614}, "episode_duration_sec_mean": 0.03690759405007156, "num_env_steps_sampled": 5000.0, "num_module_steps_sampled_lifetime": {"default_policy": -2657500.0}, "num_episodes": 100.0, "episode_len_max": 50, "num_episodes_lifetime": -53150.0, "episode_len_mean": 50.0, "env_to_module_sum_episodes_length_out": 27.16809333212661, "episode_return_max": -5.5, "num_agent_steps_sampled_lifetime": {"default_agent": -2657500.0}, "module_episode_returns_mean": {"default_policy": -5.5}, "env_reset_timer": 9.270885406956124e-05, "env_to_module_sum_episodes_length_in": 27.16809333212661, "agent_episode_returns_mean": {"default_agent": -5.5}, "episode_len_min": 50, "episode_return_mean": -5.5, "episode_return_min": -5.5, "num_agent_steps_sampled": {"default_agent": 5000.0}, "weights_seq_no": 12.0, "num_env_steps_sampled_lifetime": -2657500.0, "env_step_timer": 4.258506450753009e-05, "time_between_sampling": 0.012713567579178438, "rlmodule_inference_timer": 0.00010285287609339156, "num_module_steps_sampled": {"default_policy": 5000.0}, "num_env_steps_sampled_lifetime_throughput": 1273.6640233639982}, "learners": {"__all_modules__": {"num_env_steps_trained_lifetime": 1060800, "learner_connector": {"timers": {"connectors": {"numpy_to_tensor": 0.00016186300775886087, "add_observations_from_episodes_to_batch": 0.000735706659773535, "add_columns_from_episodes_to_train_batch": 0.06800735242808044, "general_advantage_estimation": 0.014360313035067058, "add_time_dim_to_batch_and_zero_pad": 2.1403891955282175e-05, "add_states_from_episodes_to_batch": 6.03557231511708e-06, "batch_individual_items": 0.1915373247261373, "add_one_ts_to_episodes_and_truncate": 0.008460505472489}}, "connector_pipeline_timer": 0.2836215596278789}, "num_module_steps_trained_lifetime": 208000, "num_non_trainable_parameters": 0, "num_module_steps_trained": 16000, "num_trainable_parameters": 8697, "learner_connector_sum_episodes_length_in": 5000.0, "learner_connector_sum_episodes_length_out": 5100.0, "num_env_steps_trained": 81600, "num_env_steps_trained_lifetime_throughput": 894036.342865387, "num_module_steps_trained_throughput": 175666.47171010592, "num_module_steps_trained_lifetime_throughput": 175586.31238973304}, "default_policy": {"curr_kl_coeff": 0.09721025824546814, "gradients_default_optimizer_global_norm": 0.0034701144322752953, "module_train_batch_size_mean": 1000.0, "weights_seq_no": 13.0, "mean_kl_loss": 0.00010854958964046091, "diff_num_grad_updates_vs_sampler_policy": 1.0, "vf_loss": 0.44472458958625793, "vf_loss_unclipped": 385.2892150878906, "total_loss": 0.1792864203453064, "curr_entropy_coeff": 0.0347123860443, "policy_loss": -0.05573979392647743, "num_module_steps_trained_lifetime": 208000, "vf_explained_var": -0.10573863983154297, "default_optimizer_learning_rate": 0.0532857353826, "entropy": 0.0034976357128471136, "num_module_steps_trained": 16000, "num_trainable_parameters": 8697, "num_module_steps_trained_lifetime_throughput": 175843.0220199701}}, "num_training_step_calls_per_iteration": 1, "evaluation": {"env_runners": {"env_to_module_connector": {"timers": {"connectors": {"numpy_to_tensor": 3.0145976429202745e-05, "add_observations_from_episodes_to_batch": 6.442500112393394e-06, "add_time_dim_to_batch_and_zero_pad": 5.696711168479373e-06, "batch_individual_items": 1.8588827965692025e-05, "add_states_from_episodes_to_batch": 3.3750061087067774e-06}}, "connector_pipeline_timer": 0.00012023119495561978}, "num_episodes_lifetime": 260, "episode_len_mean": 50.0, "env_to_module_sum_episodes_length_out": 27.168093332126602, "module_to_env_connector": {"timers": {"connectors": {"get_actions": 0.00015800822273766515, "listify_data_for_vector_env": 3.070784285791969e-05, "un_batch_to_individual_items": 1.5015288682786783e-05, "remove_single_ts_time_rank_from_batch": 1.4004197297736164e-06, "normalize_and_clip_actions": 2.2669171615649818e-05, "tensor_to_numpy": 4.6362648254432895e-05}}, "connector_pipeline_timer": 0.0003530190483334169}, "num_module_steps_sampled_lifetime": {"default_policy": 13000}, "weights_seq_no": 13.0, "num_env_steps_sampled_lifetime": 66000, "rlmodule_inference_timer": 9.692861837806244e-05, "num_env_steps_sampled": 1000, "num_agent_steps_sampled": {"default_agent": 1000}, "episode_len_min": 50, "episode_duration_sec_mean": 0.03497664014003021, "episode_len_max": 50, "episode_return_max": 17.5, "num_module_steps_sampled": {"default_policy": 1000}, "env_to_module_sum_episodes_length_in": 27.168093332126602, "episode_return_mean": 1.9, "num_agent_steps_sampled_lifetime": {"default_agent": 13000}, "agent_episode_returns_mean": {"default_agent": 1.9}, "num_episodes": 20, "env_reset_timer": 0.0002168293676539708, "module_episode_returns_mean": {"default_policy": 1.9}, "episode_return_min": -16.5, "env_step_timer": 4.248728008391735e-05, "sample": 0.7306723639895406, "time_between_sampling": 4.296107476576413}, "num_healthy_workers": 1, "actor_manager_num_outstanding_async_reqs": 0, "num_remote_worker_restarts": 0}, "num_env_steps_sampled_lifetime": -2657500.0, "fault_tolerance": {"num_healthy_workers": 0, "num_remote_worker_restarts": 0}, "env_runner_group": {"actor_manager_num_outstanding_async_reqs": 0}, "done": false, "training_iteration": 13, "trial_id": "05062_00000", "date": "2025-08-11_18-09-59", "timestamp": 1754928599, "time_this_iter_s": 4.96244740486145, "time_total_s": 65.0652825832367, "pid": 113125, "hostname": "DESKTOP-3SK5A41", "node_ip": "192.168.40.242", "config": {"exploration_config": {}, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 6, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "env": "Umbrella", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": false, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 0, "create_local_env_runner": true, "num_envs_per_env_runner": 1, "gym_env_vectorize_mode": "SYNC", "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "episodes_to_numpy": true, "max_requests_in_flight_per_env_runner": 1, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "merge_env_runner_states": "training_only", "broadcast_env_runner_states": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "complete_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "sampler_perf_stats_ema_coef": null, "_is_online": true, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": "auto", "num_aggregator_actors_per_learner": 0, "max_requests_in_flight_per_aggregator_actor": 3, "local_gpu_idx": 0, "max_requests_in_flight_per_learner": 3, "gamma": 1, "lr": 0.0532857353826, "grad_clip": 0.5, "grad_clip_by": "global_norm", "_train_batch_size_per_learner": 5000, "train_batch_size": 4000, "num_epochs": 3, "minibatch_size": 1000, "shuffle_batch_per_epoch": true, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "log_std_clip_param": 20.0, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "_disable_preprocessor_api": false, "_disable_action_flattening": false}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "_learner_class": null, "callbacks_on_algorithm_init": null, "callbacks_on_env_runners_recreated": null, "callbacks_on_offline_eval_runners_recreated": null, "callbacks_on_checkpoint_loaded": null, "callbacks_on_environment_created": null, "callbacks_on_episode_created": null, "callbacks_on_episode_start": null, "callbacks_on_episode_step": null, "callbacks_on_episode_end": null, "callbacks_on_evaluate_start": null, "callbacks_on_evaluate_end": null, "callbacks_on_evaluate_offline_start": null, "callbacks_on_evaluate_offline_end": null, "callbacks_on_sample_end": null, "callbacks_on_train_result": null, "explore": true, "enable_rl_module_and_learner": true, "enable_env_runner_and_connector_v2": true, "_prior_exploration_config": {"type": "StochasticSampling"}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x723d4b64aac0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "offline_data_class": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_read_batch_size": null, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "materialize_data": false, "materialize_mapped_data": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "ignore_final_observation": false, "prelearner_class": null, "prelearner_buffer_class": null, "prelearner_buffer_kwargs": {}, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_remaining_data": false, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": 1, "evaluation_duration": 20, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_auto_duration_min_env_steps_per_sample": 100, "evaluation_auto_duration_max_env_steps_per_sample": 2000, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 1, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "offline_evaluation_interval": null, "num_offline_eval_runners": 0, "offline_loss_for_module_fn": null, "offline_evaluation_duration": 1, "offline_evaluation_parallel_to_training": false, "offline_evaluation_timeout_s": 120.0, "num_cpus_per_offline_eval_runner": 1, "num_gpus_per_offline_eval_runner": 0, "custom_resources_per_offline_eval_runner": {}, "restart_failed_offline_eval_runners": true, "ignore_offline_eval_runner_failures": false, "max_num_offline_eval_runner_restarts": 1000, "offline_eval_runner_restore_timeout_s": 1800.0, "max_requests_in_flight_per_offline_eval_runner": 1, "validate_offline_eval_runners_after_construction": true, "offline_eval_runner_health_probe_timeout_s": 30.0, "offline_eval_rl_module_inference_only": false, "broadcast_offline_eval_runner_states": false, "offline_eval_batch_size_per_runner": 256, "dataset_num_iters_per_eval_runner": 1, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "log_gradients": true, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 42, "restart_failed_env_runners": true, "ignore_env_runner_failures": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30.0, "env_runner_restore_timeout_s": 1800.0, "_model_config": {}, "_rl_module_spec": "RLModuleSpec(module_class=None, observation_space=None, action_space=None, inference_only=False, learner_only=False, model_config=DefaultModelConfig(fcnet_hiddens=[63, 126], fcnet_activation='tanh', fcnet_kernel_initializer=None, fcnet_kernel_initializer_kwargs=None, fcnet_bias_initializer=None, fcnet_bias_initializer_kwargs=None, conv_filters=None, conv_activation='relu', conv_kernel_initializer=None, conv_kernel_initializer_kwargs=None, conv_bias_initializer=None, conv_bias_initializer_kwargs=None, head_fcnet_hiddens=[], head_fcnet_activation='relu', head_fcnet_kernel_initializer=None, head_fcnet_kernel_initializer_kwargs=None, head_fcnet_bias_initializer=None, head_fcnet_bias_initializer_kwargs=None, free_log_std=False, log_std_clip_param=20.0, vf_share_layers=True, use_lstm=False, max_seq_len=20, lstm_cell_size=256, lstm_use_prev_action=False, lstm_use_prev_reward=False, lstm_kernel_initializer=None, lstm_kernel_initializer_kwargs=None, lstm_bias_initializer=None, lstm_bias_initializer_kwargs=None), catalog_class=None, load_state_path=None, model_config_dict=None)", "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "_validate_config": true, "_use_msgpack_checkpoints": false, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "env_task_fn": -1, "enable_connectors": -1, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.1024108006331, "kl_target": 0.0216481916482, "vf_loss_coeff": 0.5287015453939, "entropy_coeff": 0.0347123860443, "clip_param": 0.1072861819248, "vf_clip_param": 0.4447244315309, "entropy_coeff_schedule": null, "lr_schedule": null, "sgd_minibatch_size": -1, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9119716444993, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.callbacks.callbacks.RLlibCallback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 65.0652825832367, "iterations_since_restore": 13, "perf": {"cpu_util_percent": 12.999999999999998, "ram_util_percent": 69.98571428571428}}
{"timers": {"training_iteration": 4.31785931264677, "restore_env_runners": 1.5126653675249353e-05, "training_step": 4.317570061960358, "env_runner_sampling_timer": 3.8678389375357374, "learner_update_timer": 0.44607937267556047, "synch_weights": 0.001433872984102664, "restore_eval_env_runners": 1.4727802494550458e-05, "evaluation_iteration": 0.742305382230772, "synch_eval_env_connectors": 0.00046692192178869374, "synch_env_connectors": 7.757601299865717e-06}, "env_runners": {"env_to_module_connector": {"timers": {"connectors": {"add_time_dim_to_batch_and_zero_pad": 6.75971565930147e-06, "add_states_from_episodes_to_batch": 3.509484007642554e-06, "batch_individual_items": 1.845116539094352e-05, "add_observations_from_episodes_to_batch": 6.519596313914611e-06, "numpy_to_tensor": 3.0980425278040585e-05}}, "connector_pipeline_timer": 0.00012050383594741221}, "sample": 0.037868151046988534, "module_to_env_connector": {"timers": {"connectors": {"tensor_to_numpy": 5.0287676105999604e-05, "listify_data_for_vector_env": 3.115185729237134e-05, "remove_single_ts_time_rank_from_batch": 1.434781418597531e-06, "un_batch_to_individual_items": 1.4628798623999248e-05, "normalize_and_clip_actions": 2.2383813583056897e-05, "get_actions": 0.00016574050677179472}}, "connector_pipeline_timer": 0.00036406728379937585}, "episode_duration_sec_mean": 0.03817143102997761, "num_env_steps_sampled": 5000.0, "num_module_steps_sampled_lifetime": {"default_policy": -2900000.0}, "num_episodes": 100.0, "episode_len_max": 50, "num_episodes_lifetime": -58000.0, "episode_len_mean": 50.0, "env_to_module_sum_episodes_length_out": 27.16809333212661, "episode_return_max": -5.5, "num_agent_steps_sampled_lifetime": {"default_agent": -2900000.0}, "module_episode_returns_mean": {"default_policy": -5.5}, "env_reset_timer": 9.305231640371324e-05, "env_to_module_sum_episodes_length_in": 27.16809333212661, "agent_episode_returns_mean": {"default_agent": -5.5}, "episode_len_min": 50, "episode_return_mean": -5.5, "episode_return_min": -5.5, "num_agent_steps_sampled": {"default_agent": 5000.0}, "weights_seq_no": 13.0, "num_env_steps_sampled_lifetime": -2900000.0, "env_step_timer": 4.264971833599916e-05, "time_between_sampling": 0.012293201897585674, "rlmodule_inference_timer": 0.00011109924576873776, "num_module_steps_sampled": {"default_policy": 5000.0}, "num_env_steps_sampled_lifetime_throughput": 1269.6719857121743}, "learners": {"__all_modules__": {"num_env_steps_trained_lifetime": 1142400, "learner_connector": {"timers": {"connectors": {"numpy_to_tensor": 0.00016217837767388828, "add_observations_from_episodes_to_batch": 0.0007352975931759927, "add_columns_from_episodes_to_train_batch": 0.06799915090380226, "general_advantage_estimation": 0.014361593904717572, "add_time_dim_to_batch_and_zero_pad": 2.1402853038715873e-05, "add_states_from_episodes_to_batch": 6.031216590915029e-06, "batch_individual_items": 0.19024026647887746, "add_one_ts_to_episodes_and_truncate": 0.008458385417766745}}, "connector_pipeline_timer": 0.2823152720316}, "num_module_steps_trained_lifetime": 224000, "num_non_trainable_parameters": 0, "num_module_steps_trained": 16000, "num_trainable_parameters": 8697, "learner_connector_sum_episodes_length_in": 5000.0, "learner_connector_sum_episodes_length_out": 5100.0, "num_env_steps_trained": 81600, "num_env_steps_trained_lifetime_throughput": 893500.3315136618, "num_module_steps_trained_throughput": 175542.2688692493, "num_module_steps_trained_lifetime_throughput": 175465.50885408628}, "default_policy": {"curr_kl_coeff": 0.04860512912273407, "gradients_default_optimizer_global_norm": 0.014121107757091522, "module_train_batch_size_mean": 1000.0, "weights_seq_no": 14.0, "mean_kl_loss": 0.00048555800458416343, "diff_num_grad_updates_vs_sampler_policy": 1.0, "vf_loss": 0.44472455978393555, "vf_loss_unclipped": 716.1337280273438, "total_loss": 0.2788979411125183, "curr_entropy_coeff": 0.0347123860443, "policy_loss": 0.04410073906183243, "num_module_steps_trained_lifetime": 224000, "vf_explained_var": -0.03911995887756348, "default_optimizer_learning_rate": 0.0532857353826, "entropy": 0.010846811346709728, "num_module_steps_trained": 16000, "num_trainable_parameters": 8697, "num_module_steps_trained_lifetime_throughput": 175705.92310814696}}, "num_training_step_calls_per_iteration": 1, "evaluation": {"env_runners": {"env_to_module_connector": {"timers": {"connectors": {"numpy_to_tensor": 2.895656817205694e-05, "add_observations_from_episodes_to_batch": 6.080482904722868e-06, "add_time_dim_to_batch_and_zero_pad": 5.384926446219971e-06, "batch_individual_items": 1.7737592984230207e-05, "add_states_from_episodes_to_batch": 3.310802464066305e-06}}, "connector_pipeline_timer": 0.00011520863958111548}, "num_episodes_lifetime": 280, "episode_len_mean": 50.0, "env_to_module_sum_episodes_length_out": 27.168093332126602, "module_to_env_connector": {"timers": {"connectors": {"get_actions": 0.0001530965824289274, "listify_data_for_vector_env": 3.0163102738104508e-05, "un_batch_to_individual_items": 1.5088630696428363e-05, "remove_single_ts_time_rank_from_batch": 1.3797855193857164e-06, "normalize_and_clip_actions": 2.1749954031163085e-05, "tensor_to_numpy": 4.526740411096193e-05}}, "connector_pipeline_timer": 0.00034351104232967797}, "num_module_steps_sampled_lifetime": {"default_policy": 14000}, "weights_seq_no": 14.0, "num_env_steps_sampled_lifetime": 71000, "rlmodule_inference_timer": 9.388610818454786e-05, "num_env_steps_sampled": 1000, "num_agent_steps_sampled": {"default_agent": 1000}, "episode_len_min": 50, "episode_duration_sec_mean": 0.03503281811004854, "episode_len_max": 50, "episode_return_max": 17.5, "num_module_steps_sampled": {"default_policy": 1000}, "env_to_module_sum_episodes_length_in": 27.168093332126602, "episode_return_mean": 1.9, "num_agent_steps_sampled_lifetime": {"default_agent": 14000}, "agent_episode_returns_mean": {"default_agent": 1.9}, "num_episodes": 20, "env_reset_timer": 0.00021608207397463922, "module_episode_returns_mean": {"default_policy": 1.9}, "episode_return_min": -16.5, "env_step_timer": 4.155260125583187e-05, "sample": 0.7307048993596409, "time_between_sampling": 4.296968759850655}, "num_healthy_workers": 1, "actor_manager_num_outstanding_async_reqs": 0, "num_remote_worker_restarts": 0}, "num_env_steps_sampled_lifetime": -2900000.0, "fault_tolerance": {"num_healthy_workers": 0, "num_remote_worker_restarts": 0}, "env_runner_group": {"actor_manager_num_outstanding_async_reqs": 0}, "done": false, "training_iteration": 14, "trial_id": "05062_00000", "date": "2025-08-11_18-10-04", "timestamp": 1754928604, "time_this_iter_s": 5.075682163238525, "time_total_s": 70.14096474647522, "pid": 113125, "hostname": "DESKTOP-3SK5A41", "node_ip": "192.168.40.242", "config": {"exploration_config": {}, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 6, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "env": "Umbrella", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": false, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 0, "create_local_env_runner": true, "num_envs_per_env_runner": 1, "gym_env_vectorize_mode": "SYNC", "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "episodes_to_numpy": true, "max_requests_in_flight_per_env_runner": 1, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "merge_env_runner_states": "training_only", "broadcast_env_runner_states": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "complete_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "sampler_perf_stats_ema_coef": null, "_is_online": true, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": "auto", "num_aggregator_actors_per_learner": 0, "max_requests_in_flight_per_aggregator_actor": 3, "local_gpu_idx": 0, "max_requests_in_flight_per_learner": 3, "gamma": 1, "lr": 0.0532857353826, "grad_clip": 0.5, "grad_clip_by": "global_norm", "_train_batch_size_per_learner": 5000, "train_batch_size": 4000, "num_epochs": 3, "minibatch_size": 1000, "shuffle_batch_per_epoch": true, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "log_std_clip_param": 20.0, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "_disable_preprocessor_api": false, "_disable_action_flattening": false}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "_learner_class": null, "callbacks_on_algorithm_init": null, "callbacks_on_env_runners_recreated": null, "callbacks_on_offline_eval_runners_recreated": null, "callbacks_on_checkpoint_loaded": null, "callbacks_on_environment_created": null, "callbacks_on_episode_created": null, "callbacks_on_episode_start": null, "callbacks_on_episode_step": null, "callbacks_on_episode_end": null, "callbacks_on_evaluate_start": null, "callbacks_on_evaluate_end": null, "callbacks_on_evaluate_offline_start": null, "callbacks_on_evaluate_offline_end": null, "callbacks_on_sample_end": null, "callbacks_on_train_result": null, "explore": true, "enable_rl_module_and_learner": true, "enable_env_runner_and_connector_v2": true, "_prior_exploration_config": {"type": "StochasticSampling"}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x723d4b64aac0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "offline_data_class": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_read_batch_size": null, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "materialize_data": false, "materialize_mapped_data": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "ignore_final_observation": false, "prelearner_class": null, "prelearner_buffer_class": null, "prelearner_buffer_kwargs": {}, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_remaining_data": false, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": 1, "evaluation_duration": 20, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_auto_duration_min_env_steps_per_sample": 100, "evaluation_auto_duration_max_env_steps_per_sample": 2000, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 1, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "offline_evaluation_interval": null, "num_offline_eval_runners": 0, "offline_loss_for_module_fn": null, "offline_evaluation_duration": 1, "offline_evaluation_parallel_to_training": false, "offline_evaluation_timeout_s": 120.0, "num_cpus_per_offline_eval_runner": 1, "num_gpus_per_offline_eval_runner": 0, "custom_resources_per_offline_eval_runner": {}, "restart_failed_offline_eval_runners": true, "ignore_offline_eval_runner_failures": false, "max_num_offline_eval_runner_restarts": 1000, "offline_eval_runner_restore_timeout_s": 1800.0, "max_requests_in_flight_per_offline_eval_runner": 1, "validate_offline_eval_runners_after_construction": true, "offline_eval_runner_health_probe_timeout_s": 30.0, "offline_eval_rl_module_inference_only": false, "broadcast_offline_eval_runner_states": false, "offline_eval_batch_size_per_runner": 256, "dataset_num_iters_per_eval_runner": 1, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "log_gradients": true, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 42, "restart_failed_env_runners": true, "ignore_env_runner_failures": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30.0, "env_runner_restore_timeout_s": 1800.0, "_model_config": {}, "_rl_module_spec": "RLModuleSpec(module_class=None, observation_space=None, action_space=None, inference_only=False, learner_only=False, model_config=DefaultModelConfig(fcnet_hiddens=[63, 126], fcnet_activation='tanh', fcnet_kernel_initializer=None, fcnet_kernel_initializer_kwargs=None, fcnet_bias_initializer=None, fcnet_bias_initializer_kwargs=None, conv_filters=None, conv_activation='relu', conv_kernel_initializer=None, conv_kernel_initializer_kwargs=None, conv_bias_initializer=None, conv_bias_initializer_kwargs=None, head_fcnet_hiddens=[], head_fcnet_activation='relu', head_fcnet_kernel_initializer=None, head_fcnet_kernel_initializer_kwargs=None, head_fcnet_bias_initializer=None, head_fcnet_bias_initializer_kwargs=None, free_log_std=False, log_std_clip_param=20.0, vf_share_layers=True, use_lstm=False, max_seq_len=20, lstm_cell_size=256, lstm_use_prev_action=False, lstm_use_prev_reward=False, lstm_kernel_initializer=None, lstm_kernel_initializer_kwargs=None, lstm_bias_initializer=None, lstm_bias_initializer_kwargs=None), catalog_class=None, load_state_path=None, model_config_dict=None)", "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "_validate_config": true, "_use_msgpack_checkpoints": false, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "env_task_fn": -1, "enable_connectors": -1, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.1024108006331, "kl_target": 0.0216481916482, "vf_loss_coeff": 0.5287015453939, "entropy_coeff": 0.0347123860443, "clip_param": 0.1072861819248, "vf_clip_param": 0.4447244315309, "entropy_coeff_schedule": null, "lr_schedule": null, "sgd_minibatch_size": -1, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9119716444993, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.callbacks.callbacks.RLlibCallback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 70.14096474647522, "iterations_since_restore": 14, "perf": {"cpu_util_percent": 13.142857142857142, "ram_util_percent": 69.95714285714287}}
{"timers": {"training_iteration": 4.316827212440303, "restore_env_runners": 1.5090387141048683e-05, "training_step": 4.3165371622607545, "env_runner_sampling_timer": 3.868912319080382, "learner_update_timer": 0.44397104994879955, "synch_weights": 0.0014334822542577997, "restore_eval_env_runners": 1.4712524474273906e-05, "evaluation_iteration": 0.7423228454184643, "synch_eval_env_connectors": 0.0004659097025773762, "synch_env_connectors": 7.739025281374818e-06}, "env_runners": {"env_to_module_connector": {"timers": {"connectors": {"add_time_dim_to_batch_and_zero_pad": 6.871971143901765e-06, "add_states_from_episodes_to_batch": 3.5206248024988056e-06, "batch_individual_items": 1.8665028640537612e-05, "add_observations_from_episodes_to_batch": 6.557046528050101e-06, "numpy_to_tensor": 3.126359143650703e-05}}, "connector_pipeline_timer": 0.00012159349683178002}, "sample": 0.038940684421095065, "module_to_env_connector": {"timers": {"connectors": {"tensor_to_numpy": 5.0362158829296364e-05, "listify_data_for_vector_env": 3.135174926524842e-05, "remove_single_ts_time_rank_from_batch": 1.452814799364571e-06, "un_batch_to_individual_items": 1.4672127965489224e-05, "normalize_and_clip_actions": 2.2497757424209725e-05, "get_actions": 0.0001678393000070383}}, "connector_pipeline_timer": 0.00036721393217081756}, "episode_duration_sec_mean": 0.037151196919985516, "num_env_steps_sampled": 5000.0, "num_module_steps_sampled_lifetime": {"default_policy": -3142500.0}, "num_episodes": 100.0, "episode_len_max": 50, "num_episodes_lifetime": -62850.0, "episode_len_mean": 50.0, "env_to_module_sum_episodes_length_out": 27.16809333212661, "episode_return_max": -5.5, "num_agent_steps_sampled_lifetime": {"default_agent": -3142500.0}, "module_episode_returns_mean": {"default_policy": -5.5}, "env_reset_timer": 9.451420141728282e-05, "env_to_module_sum_episodes_length_in": 27.16809333212661, "agent_episode_returns_mean": {"default_agent": -5.5}, "episode_len_min": 50, "episode_return_mean": -5.5, "episode_return_min": -5.5, "num_agent_steps_sampled": {"default_agent": 5000.0}, "weights_seq_no": 14.0, "num_env_steps_sampled_lifetime": -3142500.0, "env_step_timer": 4.298632179867138e-05, "time_between_sampling": 0.012053238847760172, "rlmodule_inference_timer": 0.00011759474809027041, "num_module_steps_sampled": {"default_policy": 5000.0}, "num_env_steps_sampled_lifetime_throughput": 1252.312970078519}, "learners": {"__all_modules__": {"num_env_steps_trained_lifetime": 1224000, "learner_connector": {"timers": {"connectors": {"numpy_to_tensor": 0.00016217559389226598, "add_observations_from_episodes_to_batch": 0.0007351256172450882, "add_columns_from_episodes_to_train_batch": 0.06799938439476975, "general_advantage_estimation": 0.014310548965675077, "add_time_dim_to_batch_and_zero_pad": 2.139382450496897e-05, "add_states_from_episodes_to_batch": 6.024904426915905e-06, "batch_individual_items": 0.18891644081408526, "add_one_ts_to_episodes_and_truncate": 0.008457217563586748}}, "connector_pipeline_timer": 0.2809391653112778}, "num_module_steps_trained_lifetime": 240000, "num_non_trainable_parameters": 0, "num_module_steps_trained": 16000, "num_trainable_parameters": 8697, "learner_connector_sum_episodes_length_in": 5000.0, "learner_connector_sum_episodes_length_out": 5100.0, "num_env_steps_trained": 81600, "num_env_steps_trained_lifetime_throughput": 893126.4344913171, "num_module_steps_trained_throughput": 175455.21430907346, "num_module_steps_trained_lifetime_throughput": 175379.15272480814}, "default_policy": {"curr_kl_coeff": 0.024302564561367035, "gradients_default_optimizer_global_norm": 0.031056145206093788, "module_train_batch_size_mean": 1000.0, "weights_seq_no": 15.0, "mean_kl_loss": 8.908030395105015e-06, "diff_num_grad_updates_vs_sampler_policy": 1.0, "vf_loss": 0.4374583661556244, "vf_loss_unclipped": 287.0548400878906, "total_loss": 0.1670331507921219, "curr_entropy_coeff": 0.0347123860443, "policy_loss": -0.06386131048202515, "num_module_steps_trained_lifetime": 240000, "vf_explained_var": -0.033330559730529785, "default_optimizer_learning_rate": 0.0532857353826, "entropy": 0.011259941384196281, "num_module_steps_trained": 16000, "num_trainable_parameters": 8697, "num_module_steps_trained_lifetime_throughput": 175608.2405378598}}, "num_training_step_calls_per_iteration": 1, "evaluation": {"env_runners": {"env_to_module_connector": {"timers": {"connectors": {"numpy_to_tensor": 3.099730441824129e-05, "add_observations_from_episodes_to_batch": 6.5620750919667015e-06, "add_time_dim_to_batch_and_zero_pad": 5.45671465304443e-06, "batch_individual_items": 1.856447418039588e-05, "add_states_from_episodes_to_batch": 3.6690921497620454e-06}}, "connector_pipeline_timer": 0.00012055261896633693}, "num_episodes_lifetime": 300, "episode_len_mean": 50.0, "env_to_module_sum_episodes_length_out": 27.168093332126602, "module_to_env_connector": {"timers": {"connectors": {"get_actions": 0.00015692857306834403, "listify_data_for_vector_env": 3.1110023034334936e-05, "un_batch_to_individual_items": 1.5337642428811577e-05, "remove_single_ts_time_rank_from_batch": 1.4398102718261399e-06, "normalize_and_clip_actions": 2.225639468585034e-05, "tensor_to_numpy": 4.644962705394003e-05}}, "connector_pipeline_timer": 0.0003519879151008595}, "num_module_steps_sampled_lifetime": {"default_policy": 15000}, "weights_seq_no": 15.0, "num_env_steps_sampled_lifetime": 76000, "rlmodule_inference_timer": 9.721182500373162e-05, "num_env_steps_sampled": 1000, "num_agent_steps_sampled": {"default_agent": 1000}, "episode_len_min": 50, "episode_duration_sec_mean": 0.035716047040041304, "episode_len_max": 50, "episode_return_max": 17.5, "num_module_steps_sampled": {"default_policy": 1000}, "env_to_module_sum_episodes_length_in": 27.168093332126602, "episode_return_mean": 1.7, "num_agent_steps_sampled_lifetime": {"default_agent": 15000}, "agent_episode_returns_mean": {"default_agent": 1.7}, "num_episodes": 20, "env_reset_timer": 0.00021511825323630447, "module_episode_returns_mean": {"default_policy": 1.7}, "episode_return_min": -16.5, "env_step_timer": 4.305241782878035e-05, "sample": 0.7313931883460453, "time_between_sampling": 4.296690866172152}, "num_healthy_workers": 1, "actor_manager_num_outstanding_async_reqs": 0, "num_remote_worker_restarts": 0}, "num_env_steps_sampled_lifetime": -3142500.0, "fault_tolerance": {"num_healthy_workers": 0, "num_remote_worker_restarts": 0}, "env_runner_group": {"actor_manager_num_outstanding_async_reqs": 0}, "done": false, "training_iteration": 15, "trial_id": "05062_00000", "date": "2025-08-11_18-10-09", "timestamp": 1754928609, "time_this_iter_s": 5.028775691986084, "time_total_s": 75.1697404384613, "pid": 113125, "hostname": "DESKTOP-3SK5A41", "node_ip": "192.168.40.242", "config": {"exploration_config": {}, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 6, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "env": "Umbrella", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": false, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 0, "create_local_env_runner": true, "num_envs_per_env_runner": 1, "gym_env_vectorize_mode": "SYNC", "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "episodes_to_numpy": true, "max_requests_in_flight_per_env_runner": 1, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "merge_env_runner_states": "training_only", "broadcast_env_runner_states": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "complete_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "sampler_perf_stats_ema_coef": null, "_is_online": true, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": "auto", "num_aggregator_actors_per_learner": 0, "max_requests_in_flight_per_aggregator_actor": 3, "local_gpu_idx": 0, "max_requests_in_flight_per_learner": 3, "gamma": 1, "lr": 0.0532857353826, "grad_clip": 0.5, "grad_clip_by": "global_norm", "_train_batch_size_per_learner": 5000, "train_batch_size": 4000, "num_epochs": 3, "minibatch_size": 1000, "shuffle_batch_per_epoch": true, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "log_std_clip_param": 20.0, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "_disable_preprocessor_api": false, "_disable_action_flattening": false}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "_learner_class": null, "callbacks_on_algorithm_init": null, "callbacks_on_env_runners_recreated": null, "callbacks_on_offline_eval_runners_recreated": null, "callbacks_on_checkpoint_loaded": null, "callbacks_on_environment_created": null, "callbacks_on_episode_created": null, "callbacks_on_episode_start": null, "callbacks_on_episode_step": null, "callbacks_on_episode_end": null, "callbacks_on_evaluate_start": null, "callbacks_on_evaluate_end": null, "callbacks_on_evaluate_offline_start": null, "callbacks_on_evaluate_offline_end": null, "callbacks_on_sample_end": null, "callbacks_on_train_result": null, "explore": true, "enable_rl_module_and_learner": true, "enable_env_runner_and_connector_v2": true, "_prior_exploration_config": {"type": "StochasticSampling"}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x723d4b64aac0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "offline_data_class": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_read_batch_size": null, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "materialize_data": false, "materialize_mapped_data": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "ignore_final_observation": false, "prelearner_class": null, "prelearner_buffer_class": null, "prelearner_buffer_kwargs": {}, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_remaining_data": false, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": 1, "evaluation_duration": 20, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_auto_duration_min_env_steps_per_sample": 100, "evaluation_auto_duration_max_env_steps_per_sample": 2000, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 1, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "offline_evaluation_interval": null, "num_offline_eval_runners": 0, "offline_loss_for_module_fn": null, "offline_evaluation_duration": 1, "offline_evaluation_parallel_to_training": false, "offline_evaluation_timeout_s": 120.0, "num_cpus_per_offline_eval_runner": 1, "num_gpus_per_offline_eval_runner": 0, "custom_resources_per_offline_eval_runner": {}, "restart_failed_offline_eval_runners": true, "ignore_offline_eval_runner_failures": false, "max_num_offline_eval_runner_restarts": 1000, "offline_eval_runner_restore_timeout_s": 1800.0, "max_requests_in_flight_per_offline_eval_runner": 1, "validate_offline_eval_runners_after_construction": true, "offline_eval_runner_health_probe_timeout_s": 30.0, "offline_eval_rl_module_inference_only": false, "broadcast_offline_eval_runner_states": false, "offline_eval_batch_size_per_runner": 256, "dataset_num_iters_per_eval_runner": 1, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "log_gradients": true, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 42, "restart_failed_env_runners": true, "ignore_env_runner_failures": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30.0, "env_runner_restore_timeout_s": 1800.0, "_model_config": {}, "_rl_module_spec": "RLModuleSpec(module_class=None, observation_space=None, action_space=None, inference_only=False, learner_only=False, model_config=DefaultModelConfig(fcnet_hiddens=[63, 126], fcnet_activation='tanh', fcnet_kernel_initializer=None, fcnet_kernel_initializer_kwargs=None, fcnet_bias_initializer=None, fcnet_bias_initializer_kwargs=None, conv_filters=None, conv_activation='relu', conv_kernel_initializer=None, conv_kernel_initializer_kwargs=None, conv_bias_initializer=None, conv_bias_initializer_kwargs=None, head_fcnet_hiddens=[], head_fcnet_activation='relu', head_fcnet_kernel_initializer=None, head_fcnet_kernel_initializer_kwargs=None, head_fcnet_bias_initializer=None, head_fcnet_bias_initializer_kwargs=None, free_log_std=False, log_std_clip_param=20.0, vf_share_layers=True, use_lstm=False, max_seq_len=20, lstm_cell_size=256, lstm_use_prev_action=False, lstm_use_prev_reward=False, lstm_kernel_initializer=None, lstm_kernel_initializer_kwargs=None, lstm_bias_initializer=None, lstm_bias_initializer_kwargs=None), catalog_class=None, load_state_path=None, model_config_dict=None)", "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "_validate_config": true, "_use_msgpack_checkpoints": false, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "env_task_fn": -1, "enable_connectors": -1, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.1024108006331, "kl_target": 0.0216481916482, "vf_loss_coeff": 0.5287015453939, "entropy_coeff": 0.0347123860443, "clip_param": 0.1072861819248, "vf_clip_param": 0.4447244315309, "entropy_coeff_schedule": null, "lr_schedule": null, "sgd_minibatch_size": -1, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9119716444993, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.callbacks.callbacks.RLlibCallback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 75.1697404384613, "iterations_since_restore": 15, "perf": {"cpu_util_percent": 12.799999999999999, "ram_util_percent": 70.0}}
{"timers": {"training_iteration": 4.317902832205901, "restore_env_runners": 1.5052483275150928e-05, "training_step": 4.317611142528148, "env_runner_sampling_timer": 3.8718796127895736, "learner_update_timer": 0.4420685414393103, "synch_weights": 0.0014393264317089536, "restore_eval_env_runners": 1.4674399231870765e-05, "evaluation_iteration": 0.7429898619442828, "synch_eval_env_connectors": 0.00046782160555513484, "synch_env_connectors": 7.737635034280903e-06}, "env_runners": {"env_to_module_connector": {"timers": {"connectors": {"add_time_dim_to_batch_and_zero_pad": 7.063119065713434e-06, "add_states_from_episodes_to_batch": 3.6022053009180013e-06, "batch_individual_items": 1.876586161879631e-05, "add_observations_from_episodes_to_batch": 6.779782463994815e-06, "numpy_to_tensor": 3.139299284191677e-05}}, "connector_pipeline_timer": 0.00012287522823135202}, "sample": 0.03939422670515411, "module_to_env_connector": {"timers": {"connectors": {"tensor_to_numpy": 5.092536956372372e-05, "listify_data_for_vector_env": 3.156269755315607e-05, "remove_single_ts_time_rank_from_batch": 1.4481594896926579e-06, "un_batch_to_individual_items": 1.4846882015586637e-05, "normalize_and_clip_actions": 2.304042924825818e-05, "get_actions": 0.00016950224054237804}}, "connector_pipeline_timer": 0.00037147086712535876}, "episode_duration_sec_mean": 0.039022348919943384, "num_env_steps_sampled": 5000.0, "num_module_steps_sampled_lifetime": {"default_policy": -3385000.0}, "num_episodes": 100.0, "episode_len_max": 50, "num_episodes_lifetime": -67700.0, "episode_len_mean": 50.0, "env_to_module_sum_episodes_length_out": 27.16809333212661, "episode_return_max": -5.5, "num_agent_steps_sampled_lifetime": {"default_agent": -3385000.0}, "module_episode_returns_mean": {"default_policy": -5.5}, "env_reset_timer": 9.538168653427882e-05, "env_to_module_sum_episodes_length_in": 27.16809333212661, "agent_episode_returns_mean": {"default_agent": -5.5}, "episode_len_min": 50, "episode_return_mean": -5.5, "episode_return_min": -5.5, "num_agent_steps_sampled": {"default_agent": 5000.0}, "weights_seq_no": 15.0, "num_env_steps_sampled_lifetime": -3385000.0, "env_step_timer": 4.3602431478377476e-05, "time_between_sampling": 0.012303171509278319, "rlmodule_inference_timer": 0.00014054000638723176, "num_module_steps_sampled": {"default_policy": 5000.0}, "num_env_steps_sampled_lifetime_throughput": 1245.020487484991}, "learners": {"__all_modules__": {"num_env_steps_trained_lifetime": 1305600, "learner_connector": {"timers": {"connectors": {"numpy_to_tensor": 0.00016240183795504404, "add_observations_from_episodes_to_batch": 0.0007348623610656556, "add_columns_from_episodes_to_train_batch": 0.06799392655081887, "general_advantage_estimation": 0.014276711476014847, "add_time_dim_to_batch_and_zero_pad": 2.1385886264174024e-05, "add_states_from_episodes_to_batch": 6.017655386037225e-06, "batch_individual_items": 0.18761125240594248, "add_one_ts_to_episodes_and_truncate": 0.008454344387952999}}, "connector_pipeline_timer": 0.2795913726581689}, "num_module_steps_trained_lifetime": 256000, "num_non_trainable_parameters": 0, "num_module_steps_trained": 16000, "num_trainable_parameters": 8697, "learner_connector_sum_episodes_length_in": 5000.0, "learner_connector_sum_episodes_length_out": 5100.0, "num_env_steps_trained": 81600, "num_env_steps_trained_lifetime_throughput": 889080.0173337385, "num_module_steps_trained_throughput": 174648.6234518766, "num_module_steps_trained_lifetime_throughput": 174573.7905983773}, "default_policy": {"curr_kl_coeff": 0.024302564561367035, "gradients_default_optimizer_global_norm": 0.2412460446357727, "module_train_batch_size_mean": 1000.0, "weights_seq_no": 16.0, "mean_kl_loss": 0.01657155342400074, "diff_num_grad_updates_vs_sampler_policy": 1.0, "vf_loss": 0.43894141912460327, "vf_loss_unclipped": 261.0519714355469, "total_loss": 0.1654282510280609, "curr_entropy_coeff": 0.0347123860443, "policy_loss": -0.06344553083181381, "num_module_steps_trained_lifetime": 256000, "vf_explained_var": -0.07315325736999512, "default_optimizer_learning_rate": 0.0532857353826, "entropy": 0.10364991426467896, "num_module_steps_trained": 16000, "num_trainable_parameters": 8697, "num_module_steps_trained_lifetime_throughput": 174792.2073586659}}, "num_training_step_calls_per_iteration": 1, "evaluation": {"env_runners": {"env_to_module_connector": {"timers": {"connectors": {"numpy_to_tensor": 2.9663329184915163e-05, "add_observations_from_episodes_to_batch": 6.207559385694104e-06, "add_time_dim_to_batch_and_zero_pad": 5.361332510459992e-06, "batch_individual_items": 1.7598898295934314e-05, "add_states_from_episodes_to_batch": 3.281107330211405e-06}}, "connector_pipeline_timer": 0.00011509078243890689}, "num_episodes_lifetime": 320, "episode_len_mean": 50.0, "env_to_module_sum_episodes_length_out": 27.168093332126602, "module_to_env_connector": {"timers": {"connectors": {"get_actions": 0.00015725892873982725, "listify_data_for_vector_env": 3.098577917645851e-05, "un_batch_to_individual_items": 1.5297058263471348e-05, "remove_single_ts_time_rank_from_batch": 1.3982506496217517e-06, "normalize_and_clip_actions": 2.22739316744844e-05, "tensor_to_numpy": 4.501243072792037e-05}}, "connector_pipeline_timer": 0.0003508930746159169}, "num_module_steps_sampled_lifetime": {"default_policy": 16000}, "weights_seq_no": 16.0, "num_env_steps_sampled_lifetime": 81000, "rlmodule_inference_timer": 9.589852287783862e-05, "num_env_steps_sampled": 1000, "num_agent_steps_sampled": {"default_agent": 1000}, "episode_len_min": 50, "episode_duration_sec_mean": 0.035851238990017006, "episode_len_max": 50, "episode_return_max": 17.5, "num_module_steps_sampled": {"default_policy": 1000}, "env_to_module_sum_episodes_length_in": 27.168093332126602, "episode_return_mean": 1.5, "num_agent_steps_sampled_lifetime": {"default_agent": 16000}, "agent_episode_returns_mean": {"default_agent": 1.5}, "num_episodes": 20, "env_reset_timer": 0.00021424007070197797, "module_episode_returns_mean": {"default_policy": 1.5}, "episode_return_min": -16.5, "env_step_timer": 4.177788763163763e-05, "sample": 0.7314636424425793, "time_between_sampling": 4.298512511400424}, "num_healthy_workers": 1, "actor_manager_num_outstanding_async_reqs": 0, "num_remote_worker_restarts": 0}, "num_env_steps_sampled_lifetime": -3385000.0, "fault_tolerance": {"num_healthy_workers": 0, "num_remote_worker_restarts": 0}, "env_runner_group": {"actor_manager_num_outstanding_async_reqs": 0}, "done": false, "training_iteration": 16, "trial_id": "05062_00000", "date": "2025-08-11_18-10-14", "timestamp": 1754928614, "time_this_iter_s": 5.177611351013184, "time_total_s": 80.34735178947449, "pid": 113125, "hostname": "DESKTOP-3SK5A41", "node_ip": "192.168.40.242", "config": {"exploration_config": {}, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 6, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "env": "Umbrella", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": false, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 0, "create_local_env_runner": true, "num_envs_per_env_runner": 1, "gym_env_vectorize_mode": "SYNC", "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "episodes_to_numpy": true, "max_requests_in_flight_per_env_runner": 1, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "merge_env_runner_states": "training_only", "broadcast_env_runner_states": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "complete_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "sampler_perf_stats_ema_coef": null, "_is_online": true, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": "auto", "num_aggregator_actors_per_learner": 0, "max_requests_in_flight_per_aggregator_actor": 3, "local_gpu_idx": 0, "max_requests_in_flight_per_learner": 3, "gamma": 1, "lr": 0.0532857353826, "grad_clip": 0.5, "grad_clip_by": "global_norm", "_train_batch_size_per_learner": 5000, "train_batch_size": 4000, "num_epochs": 3, "minibatch_size": 1000, "shuffle_batch_per_epoch": true, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "log_std_clip_param": 20.0, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "_disable_preprocessor_api": false, "_disable_action_flattening": false}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "_learner_class": null, "callbacks_on_algorithm_init": null, "callbacks_on_env_runners_recreated": null, "callbacks_on_offline_eval_runners_recreated": null, "callbacks_on_checkpoint_loaded": null, "callbacks_on_environment_created": null, "callbacks_on_episode_created": null, "callbacks_on_episode_start": null, "callbacks_on_episode_step": null, "callbacks_on_episode_end": null, "callbacks_on_evaluate_start": null, "callbacks_on_evaluate_end": null, "callbacks_on_evaluate_offline_start": null, "callbacks_on_evaluate_offline_end": null, "callbacks_on_sample_end": null, "callbacks_on_train_result": null, "explore": true, "enable_rl_module_and_learner": true, "enable_env_runner_and_connector_v2": true, "_prior_exploration_config": {"type": "StochasticSampling"}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x723d4b64aac0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "offline_data_class": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_read_batch_size": null, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "materialize_data": false, "materialize_mapped_data": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "ignore_final_observation": false, "prelearner_class": null, "prelearner_buffer_class": null, "prelearner_buffer_kwargs": {}, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_remaining_data": false, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": 1, "evaluation_duration": 20, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_auto_duration_min_env_steps_per_sample": 100, "evaluation_auto_duration_max_env_steps_per_sample": 2000, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 1, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "offline_evaluation_interval": null, "num_offline_eval_runners": 0, "offline_loss_for_module_fn": null, "offline_evaluation_duration": 1, "offline_evaluation_parallel_to_training": false, "offline_evaluation_timeout_s": 120.0, "num_cpus_per_offline_eval_runner": 1, "num_gpus_per_offline_eval_runner": 0, "custom_resources_per_offline_eval_runner": {}, "restart_failed_offline_eval_runners": true, "ignore_offline_eval_runner_failures": false, "max_num_offline_eval_runner_restarts": 1000, "offline_eval_runner_restore_timeout_s": 1800.0, "max_requests_in_flight_per_offline_eval_runner": 1, "validate_offline_eval_runners_after_construction": true, "offline_eval_runner_health_probe_timeout_s": 30.0, "offline_eval_rl_module_inference_only": false, "broadcast_offline_eval_runner_states": false, "offline_eval_batch_size_per_runner": 256, "dataset_num_iters_per_eval_runner": 1, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "log_gradients": true, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 42, "restart_failed_env_runners": true, "ignore_env_runner_failures": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30.0, "env_runner_restore_timeout_s": 1800.0, "_model_config": {}, "_rl_module_spec": "RLModuleSpec(module_class=None, observation_space=None, action_space=None, inference_only=False, learner_only=False, model_config=DefaultModelConfig(fcnet_hiddens=[63, 126], fcnet_activation='tanh', fcnet_kernel_initializer=None, fcnet_kernel_initializer_kwargs=None, fcnet_bias_initializer=None, fcnet_bias_initializer_kwargs=None, conv_filters=None, conv_activation='relu', conv_kernel_initializer=None, conv_kernel_initializer_kwargs=None, conv_bias_initializer=None, conv_bias_initializer_kwargs=None, head_fcnet_hiddens=[], head_fcnet_activation='relu', head_fcnet_kernel_initializer=None, head_fcnet_kernel_initializer_kwargs=None, head_fcnet_bias_initializer=None, head_fcnet_bias_initializer_kwargs=None, free_log_std=False, log_std_clip_param=20.0, vf_share_layers=True, use_lstm=False, max_seq_len=20, lstm_cell_size=256, lstm_use_prev_action=False, lstm_use_prev_reward=False, lstm_kernel_initializer=None, lstm_kernel_initializer_kwargs=None, lstm_bias_initializer=None, lstm_bias_initializer_kwargs=None), catalog_class=None, load_state_path=None, model_config_dict=None)", "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "_validate_config": true, "_use_msgpack_checkpoints": false, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "env_task_fn": -1, "enable_connectors": -1, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.1024108006331, "kl_target": 0.0216481916482, "vf_loss_coeff": 0.5287015453939, "entropy_coeff": 0.0347123860443, "clip_param": 0.1072861819248, "vf_clip_param": 0.4447244315309, "entropy_coeff_schedule": null, "lr_schedule": null, "sgd_minibatch_size": -1, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9119716444993, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.callbacks.callbacks.RLlibCallback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 80.34735178947449, "iterations_since_restore": 16, "perf": {"cpu_util_percent": 13.0125, "ram_util_percent": 69.9625}}
{"timers": {"training_iteration": 4.319136976763846, "restore_env_runners": 1.5020958448124376e-05, "training_step": 4.318843653982867, "env_runner_sampling_timer": 3.873398393561677, "learner_update_timer": 0.44177711300492156, "synch_weights": 0.0014400791673879574, "restore_eval_env_runners": 1.465965524422101e-05, "evaluation_iteration": 0.7430460853048313, "synch_eval_env_connectors": 0.0004684683895014869, "synch_env_connectors": 7.731258687965249e-06}, "env_runners": {"env_to_module_connector": {"timers": {"connectors": {"add_time_dim_to_batch_and_zero_pad": 7.0196298050413844e-06, "add_states_from_episodes_to_batch": 3.5892893147909065e-06, "batch_individual_items": 1.8852617443888368e-05, "add_observations_from_episodes_to_batch": 6.750047110425363e-06, "numpy_to_tensor": 3.167020213693068e-05}}, "connector_pipeline_timer": 0.00012313677814255986}, "sample": 0.0390320151549723, "module_to_env_connector": {"timers": {"connectors": {"tensor_to_numpy": 5.1138099062023427e-05, "listify_data_for_vector_env": 3.178649080465864e-05, "remove_single_ts_time_rank_from_batch": 1.4862659966688811e-06, "un_batch_to_individual_items": 1.4817592324212818e-05, "normalize_and_clip_actions": 2.2786559371542075e-05, "get_actions": 0.00017003104325477572}}, "connector_pipeline_timer": 0.00037156143266810335}, "episode_duration_sec_mean": 0.037614946909989164, "num_env_steps_sampled": 5000.0, "num_module_steps_sampled_lifetime": {"default_policy": -3627500.0}, "num_episodes": 100.0, "episode_len_max": 50, "num_episodes_lifetime": -72550.0, "episode_len_mean": 50.0, "env_to_module_sum_episodes_length_out": 27.16809333212661, "episode_return_max": 14.5, "num_agent_steps_sampled_lifetime": {"default_agent": -3627500.0}, "module_episode_returns_mean": {"default_policy": -4.5}, "env_reset_timer": 9.631176350368312e-05, "env_to_module_sum_episodes_length_in": 27.16809333212661, "agent_episode_returns_mean": {"default_agent": -4.5}, "episode_len_min": 50, "episode_return_mean": -4.5, "episode_return_min": -5.5, "num_agent_steps_sampled": {"default_agent": 5000.0}, "weights_seq_no": 16.0, "num_env_steps_sampled_lifetime": -3627500.0, "env_step_timer": 4.338411486010884e-05, "time_between_sampling": 0.012163518633737618, "rlmodule_inference_timer": 0.00010457996061644896, "num_module_steps_sampled": {"default_policy": 5000.0}, "num_env_steps_sampled_lifetime_throughput": 1246.0794820688736}, "learners": {"__all_modules__": {"num_env_steps_trained_lifetime": 1387200, "learner_connector": {"timers": {"connectors": {"numpy_to_tensor": 0.0001623998195752638, "add_observations_from_episodes_to_batch": 0.0007345527374478002, "add_columns_from_episodes_to_train_batch": 0.06800601427531085, "general_advantage_estimation": 0.014253345361256444, "add_time_dim_to_batch_and_zero_pad": 2.1387027401557894e-05, "add_states_from_episodes_to_batch": 6.012478832606425e-06, "batch_individual_items": 0.18776734488188804, "add_one_ts_to_episodes_and_truncate": 0.008615305944076064}}, "connector_pipeline_timer": 0.2798966699215857}, "num_module_steps_trained_lifetime": 272000, "num_non_trainable_parameters": 0, "num_module_steps_trained": 16000, "num_trainable_parameters": 8697, "learner_connector_sum_episodes_length_in": 5000.0, "learner_connector_sum_episodes_length_out": 5100.0, "num_env_steps_trained": 81600, "num_env_steps_trained_lifetime_throughput": 885367.8853515466, "num_module_steps_trained_throughput": 173903.36712066864, "num_module_steps_trained_lifetime_throughput": 173831.67887796403}, "default_policy": {"curr_kl_coeff": 0.03645384684205055, "gradients_default_optimizer_global_norm": 0.04372613504528999, "module_train_batch_size_mean": 1000.0, "weights_seq_no": 17.0, "mean_kl_loss": 0.5219995379447937, "diff_num_grad_updates_vs_sampler_policy": 1.0, "vf_loss": 0.44472450017929077, "vf_loss_unclipped": 226.95748901367188, "total_loss": 0.24300943315029144, "curr_entropy_coeff": 0.0347123860443, "policy_loss": -0.004475656431168318, "num_module_steps_trained_lifetime": 272000, "vf_explained_var": -0.7500201463699341, "default_optimizer_learning_rate": 0.0532857353826, "entropy": 0.00942900963127613, "num_module_steps_trained": 16000, "num_trainable_parameters": 8697, "num_module_steps_trained_lifetime_throughput": 174036.0418057296}}, "num_training_step_calls_per_iteration": 1, "evaluation": {"env_runners": {"env_to_module_connector": {"timers": {"connectors": {"numpy_to_tensor": 2.857548617388248e-05, "add_observations_from_episodes_to_batch": 6.293853289272141e-06, "add_time_dim_to_batch_and_zero_pad": 5.3718636005790125e-06, "batch_individual_items": 1.7594018214141622e-05, "add_states_from_episodes_to_batch": 3.273579577474166e-06}}, "connector_pipeline_timer": 0.00011393851052212066}, "num_episodes_lifetime": 340, "episode_len_mean": 50.0, "env_to_module_sum_episodes_length_out": 27.168093332126602, "module_to_env_connector": {"timers": {"connectors": {"get_actions": 0.000151197887014982, "listify_data_for_vector_env": 3.0207437734713027e-05, "un_batch_to_individual_items": 1.475811131944542e-05, "remove_single_ts_time_rank_from_batch": 1.4384457748562123e-06, "normalize_and_clip_actions": 2.171102624677641e-05, "tensor_to_numpy": 4.366148589109635e-05}}, "connector_pipeline_timer": 0.0003387800754192843}, "num_module_steps_sampled_lifetime": {"default_policy": 17000}, "weights_seq_no": 17.0, "num_env_steps_sampled_lifetime": 86000, "rlmodule_inference_timer": 9.323464315856008e-05, "num_env_steps_sampled": 1000, "num_agent_steps_sampled": {"default_agent": 1000}, "episode_len_min": 50, "episode_duration_sec_mean": 0.036034063959996275, "episode_len_max": 50, "episode_return_max": 17.5, "num_module_steps_sampled": {"default_policy": 1000}, "env_to_module_sum_episodes_length_in": 27.168093332126602, "episode_return_mean": 1.5, "num_agent_steps_sampled_lifetime": {"default_agent": 17000}, "agent_episode_returns_mean": {"default_agent": 1.5}, "num_episodes": 20, "env_reset_timer": 0.0002133776699917265, "module_episode_returns_mean": {"default_policy": 1.5}, "episode_return_min": -16.5, "env_step_timer": 4.088816958655865e-05, "sample": 0.7315495369981567, "time_between_sampling": 4.300516478166417}, "num_healthy_workers": 1, "actor_manager_num_outstanding_async_reqs": 0, "num_remote_worker_restarts": 0}, "num_env_steps_sampled_lifetime": -3627500.0, "fault_tolerance": {"num_healthy_workers": 0, "num_remote_worker_restarts": 0}, "env_runner_group": {"actor_manager_num_outstanding_async_reqs": 0}, "done": false, "training_iteration": 17, "trial_id": "05062_00000", "date": "2025-08-11_18-10-19", "timestamp": 1754928619, "time_this_iter_s": 5.195905923843384, "time_total_s": 85.54325771331787, "pid": 113125, "hostname": "DESKTOP-3SK5A41", "node_ip": "192.168.40.242", "config": {"exploration_config": {}, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 6, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "env": "Umbrella", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": false, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 0, "create_local_env_runner": true, "num_envs_per_env_runner": 1, "gym_env_vectorize_mode": "SYNC", "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "episodes_to_numpy": true, "max_requests_in_flight_per_env_runner": 1, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "merge_env_runner_states": "training_only", "broadcast_env_runner_states": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "complete_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "sampler_perf_stats_ema_coef": null, "_is_online": true, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": "auto", "num_aggregator_actors_per_learner": 0, "max_requests_in_flight_per_aggregator_actor": 3, "local_gpu_idx": 0, "max_requests_in_flight_per_learner": 3, "gamma": 1, "lr": 0.0532857353826, "grad_clip": 0.5, "grad_clip_by": "global_norm", "_train_batch_size_per_learner": 5000, "train_batch_size": 4000, "num_epochs": 3, "minibatch_size": 1000, "shuffle_batch_per_epoch": true, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "log_std_clip_param": 20.0, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "_disable_preprocessor_api": false, "_disable_action_flattening": false}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "_learner_class": null, "callbacks_on_algorithm_init": null, "callbacks_on_env_runners_recreated": null, "callbacks_on_offline_eval_runners_recreated": null, "callbacks_on_checkpoint_loaded": null, "callbacks_on_environment_created": null, "callbacks_on_episode_created": null, "callbacks_on_episode_start": null, "callbacks_on_episode_step": null, "callbacks_on_episode_end": null, "callbacks_on_evaluate_start": null, "callbacks_on_evaluate_end": null, "callbacks_on_evaluate_offline_start": null, "callbacks_on_evaluate_offline_end": null, "callbacks_on_sample_end": null, "callbacks_on_train_result": null, "explore": true, "enable_rl_module_and_learner": true, "enable_env_runner_and_connector_v2": true, "_prior_exploration_config": {"type": "StochasticSampling"}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x723d4b64aac0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "offline_data_class": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_read_batch_size": null, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "materialize_data": false, "materialize_mapped_data": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "ignore_final_observation": false, "prelearner_class": null, "prelearner_buffer_class": null, "prelearner_buffer_kwargs": {}, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_remaining_data": false, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": 1, "evaluation_duration": 20, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_auto_duration_min_env_steps_per_sample": 100, "evaluation_auto_duration_max_env_steps_per_sample": 2000, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 1, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "offline_evaluation_interval": null, "num_offline_eval_runners": 0, "offline_loss_for_module_fn": null, "offline_evaluation_duration": 1, "offline_evaluation_parallel_to_training": false, "offline_evaluation_timeout_s": 120.0, "num_cpus_per_offline_eval_runner": 1, "num_gpus_per_offline_eval_runner": 0, "custom_resources_per_offline_eval_runner": {}, "restart_failed_offline_eval_runners": true, "ignore_offline_eval_runner_failures": false, "max_num_offline_eval_runner_restarts": 1000, "offline_eval_runner_restore_timeout_s": 1800.0, "max_requests_in_flight_per_offline_eval_runner": 1, "validate_offline_eval_runners_after_construction": true, "offline_eval_runner_health_probe_timeout_s": 30.0, "offline_eval_rl_module_inference_only": false, "broadcast_offline_eval_runner_states": false, "offline_eval_batch_size_per_runner": 256, "dataset_num_iters_per_eval_runner": 1, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "log_gradients": true, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 42, "restart_failed_env_runners": true, "ignore_env_runner_failures": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30.0, "env_runner_restore_timeout_s": 1800.0, "_model_config": {}, "_rl_module_spec": "RLModuleSpec(module_class=None, observation_space=None, action_space=None, inference_only=False, learner_only=False, model_config=DefaultModelConfig(fcnet_hiddens=[63, 126], fcnet_activation='tanh', fcnet_kernel_initializer=None, fcnet_kernel_initializer_kwargs=None, fcnet_bias_initializer=None, fcnet_bias_initializer_kwargs=None, conv_filters=None, conv_activation='relu', conv_kernel_initializer=None, conv_kernel_initializer_kwargs=None, conv_bias_initializer=None, conv_bias_initializer_kwargs=None, head_fcnet_hiddens=[], head_fcnet_activation='relu', head_fcnet_kernel_initializer=None, head_fcnet_kernel_initializer_kwargs=None, head_fcnet_bias_initializer=None, head_fcnet_bias_initializer_kwargs=None, free_log_std=False, log_std_clip_param=20.0, vf_share_layers=True, use_lstm=False, max_seq_len=20, lstm_cell_size=256, lstm_use_prev_action=False, lstm_use_prev_reward=False, lstm_kernel_initializer=None, lstm_kernel_initializer_kwargs=None, lstm_bias_initializer=None, lstm_bias_initializer_kwargs=None), catalog_class=None, load_state_path=None, model_config_dict=None)", "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "_validate_config": true, "_use_msgpack_checkpoints": false, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "env_task_fn": -1, "enable_connectors": -1, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.1024108006331, "kl_target": 0.0216481916482, "vf_loss_coeff": 0.5287015453939, "entropy_coeff": 0.0347123860443, "clip_param": 0.1072861819248, "vf_clip_param": 0.4447244315309, "entropy_coeff_schedule": null, "lr_schedule": null, "sgd_minibatch_size": -1, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9119716444993, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.callbacks.callbacks.RLlibCallback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 85.54325771331787, "iterations_since_restore": 17, "perf": {"cpu_util_percent": 13.171428571428569, "ram_util_percent": 69.89999999999999}}
{"timers": {"training_iteration": 4.317933147916206, "restore_env_runners": 1.4995748860485366e-05, "training_step": 4.3176390153630315, "env_runner_sampling_timer": 3.874185518556063, "learner_update_timer": 0.4397856108648748, "synch_weights": 0.0014399673757147225, "restore_eval_env_runners": 1.4638058688621033e-05, "evaluation_iteration": 0.7431155654317887, "synch_eval_env_connectors": 0.0004676817056018601, "synch_env_connectors": 7.713946103207847e-06}, "env_runners": {"env_to_module_connector": {"timers": {"connectors": {"add_time_dim_to_batch_and_zero_pad": 6.894474892417104e-06, "add_states_from_episodes_to_batch": 3.5228959713222025e-06, "batch_individual_items": 1.86285482635118e-05, "add_observations_from_episodes_to_batch": 6.518665637782827e-06, "numpy_to_tensor": 3.107922362735378e-05}}, "connector_pipeline_timer": 0.00012122856445542333}, "sample": 0.03854747095286356, "module_to_env_connector": {"timers": {"connectors": {"tensor_to_numpy": 5.020643270313655e-05, "listify_data_for_vector_env": 3.115358521613347e-05, "remove_single_ts_time_rank_from_batch": 1.4537179416753283e-06, "un_batch_to_individual_items": 1.461740893306413e-05, "normalize_and_clip_actions": 2.244418898347156e-05, "get_actions": 0.0001665821392362249}}, "connector_pipeline_timer": 0.00036494367414016763}, "episode_duration_sec_mean": 0.03693779193990848, "num_env_steps_sampled": 5000.0, "num_module_steps_sampled_lifetime": {"default_policy": -3870000.0}, "num_episodes": 100.0, "episode_len_max": 50, "num_episodes_lifetime": -77400.0, "episode_len_mean": 50.0, "env_to_module_sum_episodes_length_out": 27.16809333212661, "episode_return_max": -5.5, "num_agent_steps_sampled_lifetime": {"default_agent": -3870000.0}, "module_episode_returns_mean": {"default_policy": -5.5}, "env_reset_timer": 9.513035221333596e-05, "env_to_module_sum_episodes_length_in": 27.16809333212661, "agent_episode_returns_mean": {"default_agent": -5.5}, "episode_len_min": 50, "episode_return_mean": -5.5, "episode_return_min": -5.5, "num_agent_steps_sampled": {"default_agent": 5000.0}, "weights_seq_no": 17.0, "num_env_steps_sampled_lifetime": -3870000.0, "env_step_timer": 4.2737930787618985e-05, "time_between_sampling": 0.013083400933656593, "rlmodule_inference_timer": 0.00010287565433525329, "num_module_steps_sampled": {"default_policy": 5000.0}, "num_env_steps_sampled_lifetime_throughput": 1266.4466664657255}, "learners": {"__all_modules__": {"num_env_steps_trained_lifetime": 1468800, "learner_connector": {"timers": {"connectors": {"numpy_to_tensor": 0.0001624018213824545, "add_observations_from_episodes_to_batch": 0.0007340682100749854, "add_columns_from_episodes_to_train_batch": 0.06800028213255324, "general_advantage_estimation": 0.014206763907636274, "add_time_dim_to_batch_and_zero_pad": 2.1392157121646112e-05, "add_states_from_episodes_to_batch": 6.007354044709932e-06, "batch_individual_items": 0.18647191242307568, "add_one_ts_to_episodes_and_truncate": 0.008613725884639033}}, "connector_pipeline_timer": 0.2785466612123662}, "num_module_steps_trained_lifetime": 288000, "num_non_trainable_parameters": 0, "num_module_steps_trained": 16000, "num_trainable_parameters": 8697, "learner_connector_sum_episodes_length_in": 5000.0, "learner_connector_sum_episodes_length_out": 5100.0, "num_env_steps_trained": 81600, "num_env_steps_trained_lifetime_throughput": 882301.2462880427, "num_module_steps_trained_throughput": 173286.85915533165, "num_module_steps_trained_lifetime_throughput": 173218.4127129068}, "default_policy": {"curr_kl_coeff": 0.018226923421025276, "gradients_default_optimizer_global_norm": 0.33550557494163513, "module_train_batch_size_mean": 1000.0, "weights_seq_no": 18.0, "mean_kl_loss": 7.225833996926667e-06, "diff_num_grad_updates_vs_sampler_policy": 1.0, "vf_loss": 0.3948843777179718, "vf_loss_unclipped": 176.5260772705078, "total_loss": 0.17740167677402496, "curr_entropy_coeff": 0.0347123860443, "policy_loss": -0.03134600818157196, "num_module_steps_trained_lifetime": 288000, "vf_explained_var": -0.004515290260314941, "default_optimizer_learning_rate": 0.0532857353826, "entropy": 0.0008215889101848006, "num_module_steps_trained": 16000, "num_trainable_parameters": 8697, "num_module_steps_trained_lifetime_throughput": 173410.14230480202}}, "num_training_step_calls_per_iteration": 1, "evaluation": {"env_runners": {"env_to_module_connector": {"timers": {"connectors": {"numpy_to_tensor": 2.8873233260529615e-05, "add_observations_from_episodes_to_batch": 6.0380967175244215e-06, "add_time_dim_to_batch_and_zero_pad": 5.258990824993491e-06, "batch_individual_items": 1.7885239614241605e-05, "add_states_from_episodes_to_batch": 3.0978518508929934e-06}}, "connector_pipeline_timer": 0.00011352301772326824}, "num_episodes_lifetime": 360, "episode_len_mean": 50.0, "env_to_module_sum_episodes_length_out": 27.168093332126602, "module_to_env_connector": {"timers": {"connectors": {"get_actions": 0.0001509672974143213, "listify_data_for_vector_env": 2.9798893530107748e-05, "un_batch_to_individual_items": 1.478726177621489e-05, "remove_single_ts_time_rank_from_batch": 1.3499126772134344e-06, "normalize_and_clip_actions": 2.112706449188767e-05, "tensor_to_numpy": 4.3965452301469177e-05}}, "connector_pipeline_timer": 0.00033769128613837454}, "num_module_steps_sampled_lifetime": {"default_policy": 18000}, "weights_seq_no": 18.0, "num_env_steps_sampled_lifetime": 91000, "rlmodule_inference_timer": 9.201012672407298e-05, "num_env_steps_sampled": 1000, "num_agent_steps_sampled": {"default_agent": 1000}, "episode_len_min": 50, "episode_duration_sec_mean": 0.035898639940023715, "episode_len_max": 50, "episode_return_max": 17.5, "num_module_steps_sampled": {"default_policy": 1000}, "env_to_module_sum_episodes_length_in": 27.168093332126602, "episode_return_mean": 1.3, "num_agent_steps_sampled_lifetime": {"default_agent": 18000}, "agent_episode_returns_mean": {"default_agent": 1.3}, "num_episodes": 20, "env_reset_timer": 0.00021246389328645528, "module_episode_returns_mean": {"default_policy": 1.3}, "episode_return_min": -16.5, "env_step_timer": 4.112934669657982e-05, "sample": 0.7314796076181721, "time_between_sampling": 4.300036808304753}, "num_healthy_workers": 1, "actor_manager_num_outstanding_async_reqs": 0, "num_remote_worker_restarts": 0}, "num_env_steps_sampled_lifetime": -3870000.0, "fault_tolerance": {"num_healthy_workers": 0, "num_remote_worker_restarts": 0}, "env_runner_group": {"actor_manager_num_outstanding_async_reqs": 0}, "done": false, "training_iteration": 18, "trial_id": "05062_00000", "date": "2025-08-11_18-10-24", "timestamp": 1754928624, "time_this_iter_s": 4.937523126602173, "time_total_s": 90.48078083992004, "pid": 113125, "hostname": "DESKTOP-3SK5A41", "node_ip": "192.168.40.242", "config": {"exploration_config": {}, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 6, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "env": "Umbrella", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": false, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 0, "create_local_env_runner": true, "num_envs_per_env_runner": 1, "gym_env_vectorize_mode": "SYNC", "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "episodes_to_numpy": true, "max_requests_in_flight_per_env_runner": 1, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "merge_env_runner_states": "training_only", "broadcast_env_runner_states": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "complete_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "sampler_perf_stats_ema_coef": null, "_is_online": true, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": "auto", "num_aggregator_actors_per_learner": 0, "max_requests_in_flight_per_aggregator_actor": 3, "local_gpu_idx": 0, "max_requests_in_flight_per_learner": 3, "gamma": 1, "lr": 0.0532857353826, "grad_clip": 0.5, "grad_clip_by": "global_norm", "_train_batch_size_per_learner": 5000, "train_batch_size": 4000, "num_epochs": 3, "minibatch_size": 1000, "shuffle_batch_per_epoch": true, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "log_std_clip_param": 20.0, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "_disable_preprocessor_api": false, "_disable_action_flattening": false}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "_learner_class": null, "callbacks_on_algorithm_init": null, "callbacks_on_env_runners_recreated": null, "callbacks_on_offline_eval_runners_recreated": null, "callbacks_on_checkpoint_loaded": null, "callbacks_on_environment_created": null, "callbacks_on_episode_created": null, "callbacks_on_episode_start": null, "callbacks_on_episode_step": null, "callbacks_on_episode_end": null, "callbacks_on_evaluate_start": null, "callbacks_on_evaluate_end": null, "callbacks_on_evaluate_offline_start": null, "callbacks_on_evaluate_offline_end": null, "callbacks_on_sample_end": null, "callbacks_on_train_result": null, "explore": true, "enable_rl_module_and_learner": true, "enable_env_runner_and_connector_v2": true, "_prior_exploration_config": {"type": "StochasticSampling"}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x723d4b64aac0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "offline_data_class": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_read_batch_size": null, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "materialize_data": false, "materialize_mapped_data": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "ignore_final_observation": false, "prelearner_class": null, "prelearner_buffer_class": null, "prelearner_buffer_kwargs": {}, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_remaining_data": false, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": 1, "evaluation_duration": 20, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_auto_duration_min_env_steps_per_sample": 100, "evaluation_auto_duration_max_env_steps_per_sample": 2000, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 1, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "offline_evaluation_interval": null, "num_offline_eval_runners": 0, "offline_loss_for_module_fn": null, "offline_evaluation_duration": 1, "offline_evaluation_parallel_to_training": false, "offline_evaluation_timeout_s": 120.0, "num_cpus_per_offline_eval_runner": 1, "num_gpus_per_offline_eval_runner": 0, "custom_resources_per_offline_eval_runner": {}, "restart_failed_offline_eval_runners": true, "ignore_offline_eval_runner_failures": false, "max_num_offline_eval_runner_restarts": 1000, "offline_eval_runner_restore_timeout_s": 1800.0, "max_requests_in_flight_per_offline_eval_runner": 1, "validate_offline_eval_runners_after_construction": true, "offline_eval_runner_health_probe_timeout_s": 30.0, "offline_eval_rl_module_inference_only": false, "broadcast_offline_eval_runner_states": false, "offline_eval_batch_size_per_runner": 256, "dataset_num_iters_per_eval_runner": 1, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "log_gradients": true, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 42, "restart_failed_env_runners": true, "ignore_env_runner_failures": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30.0, "env_runner_restore_timeout_s": 1800.0, "_model_config": {}, "_rl_module_spec": "RLModuleSpec(module_class=None, observation_space=None, action_space=None, inference_only=False, learner_only=False, model_config=DefaultModelConfig(fcnet_hiddens=[63, 126], fcnet_activation='tanh', fcnet_kernel_initializer=None, fcnet_kernel_initializer_kwargs=None, fcnet_bias_initializer=None, fcnet_bias_initializer_kwargs=None, conv_filters=None, conv_activation='relu', conv_kernel_initializer=None, conv_kernel_initializer_kwargs=None, conv_bias_initializer=None, conv_bias_initializer_kwargs=None, head_fcnet_hiddens=[], head_fcnet_activation='relu', head_fcnet_kernel_initializer=None, head_fcnet_kernel_initializer_kwargs=None, head_fcnet_bias_initializer=None, head_fcnet_bias_initializer_kwargs=None, free_log_std=False, log_std_clip_param=20.0, vf_share_layers=True, use_lstm=False, max_seq_len=20, lstm_cell_size=256, lstm_use_prev_action=False, lstm_use_prev_reward=False, lstm_kernel_initializer=None, lstm_kernel_initializer_kwargs=None, lstm_bias_initializer=None, lstm_bias_initializer_kwargs=None), catalog_class=None, load_state_path=None, model_config_dict=None)", "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "_validate_config": true, "_use_msgpack_checkpoints": false, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "env_task_fn": -1, "enable_connectors": -1, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.1024108006331, "kl_target": 0.0216481916482, "vf_loss_coeff": 0.5287015453939, "entropy_coeff": 0.0347123860443, "clip_param": 0.1072861819248, "vf_clip_param": 0.4447244315309, "entropy_coeff_schedule": null, "lr_schedule": null, "sgd_minibatch_size": -1, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9119716444993, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.callbacks.callbacks.RLlibCallback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 90.48078083992004, "iterations_since_restore": 18, "perf": {"cpu_util_percent": 12.47142857142857, "ram_util_percent": 69.89999999999999}}
{"timers": {"training_iteration": 4.317633845347048, "restore_env_runners": 1.495479137422011e-05, "training_step": 4.317339265119402, "env_runner_sampling_timer": 3.874399027300502, "learner_update_timer": 0.43926444273622656, "synch_weights": 0.001440511701961682, "restore_eval_env_runners": 1.460367809963306e-05, "evaluation_iteration": 0.7430273137674729, "synch_eval_env_connectors": 0.0004665338885509151, "synch_env_connectors": 7.698806641337113e-06}, "env_runners": {"env_to_module_connector": {"timers": {"connectors": {"add_time_dim_to_batch_and_zero_pad": 6.660921414940511e-06, "add_states_from_episodes_to_batch": 3.4839030910027204e-06, "batch_individual_items": 1.8325781049528532e-05, "add_observations_from_episodes_to_batch": 6.4321221792685805e-06, "numpy_to_tensor": 3.045415967892241e-05}}, "connector_pipeline_timer": 0.00011929586823187954}, "sample": 0.0380497173944808, "module_to_env_connector": {"timers": {"connectors": {"tensor_to_numpy": 4.9662475033759514e-05, "listify_data_for_vector_env": 3.088166059881708e-05, "remove_single_ts_time_rank_from_batch": 1.4317074247753202e-06, "un_batch_to_individual_items": 1.4480908963610772e-05, "normalize_and_clip_actions": 2.2165141132066864e-05, "get_actions": 0.00016453806179562983}}, "connector_pipeline_timer": 0.0003609142237806693}, "episode_duration_sec_mean": 0.03643117192998034, "num_env_steps_sampled": 5000.0, "num_module_steps_sampled_lifetime": {"default_policy": -4112500.0}, "num_episodes": 100.0, "episode_len_max": 50, "num_episodes_lifetime": -82250.0, "episode_len_mean": 50.0, "env_to_module_sum_episodes_length_out": 27.16809333212661, "episode_return_max": -5.5, "num_agent_steps_sampled_lifetime": {"default_agent": -4112500.0}, "module_episode_returns_mean": {"default_policy": -5.5}, "env_reset_timer": 9.35815043732913e-05, "env_to_module_sum_episodes_length_in": 27.16809333212661, "agent_episode_returns_mean": {"default_agent": -5.5}, "episode_len_min": 50, "episode_return_mean": -5.5, "episode_return_min": -5.5, "num_agent_steps_sampled": {"default_agent": 5000.0}, "weights_seq_no": 18.0, "num_env_steps_sampled_lifetime": -4112500.0, "env_step_timer": 4.220967650761162e-05, "time_between_sampling": 0.012236094055724137, "rlmodule_inference_timer": 0.00010140898771504521, "num_module_steps_sampled": {"default_policy": 5000.0}, "num_env_steps_sampled_lifetime_throughput": 1278.8955815197012}, "learners": {"__all_modules__": {"num_env_steps_trained_lifetime": 1550400, "learner_connector": {"timers": {"connectors": {"numpy_to_tensor": 0.00016239480316670746, "add_observations_from_episodes_to_batch": 0.0007337445279723218, "add_columns_from_episodes_to_train_batch": 0.06798486731122734, "general_advantage_estimation": 0.014162338268560545, "add_time_dim_to_batch_and_zero_pad": 2.1367235543472324e-05, "add_states_from_episodes_to_batch": 5.999280500038819e-06, "batch_individual_items": 0.18661793728884882, "add_one_ts_to_episodes_and_truncate": 0.008608758625795755}}, "connector_pipeline_timer": 0.27862699559024534}, "num_module_steps_trained_lifetime": 304000, "num_non_trainable_parameters": 0, "num_module_steps_trained": 16000, "num_trainable_parameters": 8697, "learner_connector_sum_episodes_length_in": 5000.0, "learner_connector_sum_episodes_length_out": 5100.0, "num_env_steps_trained": 81600, "num_env_steps_trained_lifetime_throughput": 878886.7369187898, "num_module_steps_trained_throughput": 172602.9911269702, "num_module_steps_trained_lifetime_throughput": 172537.65847996259}, "default_policy": {"curr_kl_coeff": 0.009113461710512638, "gradients_default_optimizer_global_norm": 0.03164122253656387, "module_train_batch_size_mean": 1000.0, "weights_seq_no": 19.0, "mean_kl_loss": 0.00027777545619755983, "diff_num_grad_updates_vs_sampler_policy": 1.0, "vf_loss": 0.4355648458003998, "vf_loss_unclipped": 160.70375061035156, "total_loss": 0.16815027594566345, "curr_entropy_coeff": 0.0347123860443, "policy_loss": -0.06199692189693451, "num_module_steps_trained_lifetime": 304000, "vf_explained_var": -0.08711731433868408, "default_optimizer_learning_rate": 0.0532857353826, "entropy": 0.004080406855791807, "num_module_steps_trained": 16000, "num_trainable_parameters": 8697, "num_module_steps_trained_lifetime_throughput": 172717.26566709275}}, "num_training_step_calls_per_iteration": 1, "evaluation": {"env_runners": {"env_to_module_connector": {"timers": {"connectors": {"numpy_to_tensor": 2.9054952017727235e-05, "add_observations_from_episodes_to_batch": 6.082714148429635e-06, "add_time_dim_to_batch_and_zero_pad": 5.607524312180697e-06, "batch_individual_items": 1.774435347453896e-05, "add_states_from_episodes_to_batch": 3.323098955126063e-06}}, "connector_pipeline_timer": 0.00011496109442859014}, "num_episodes_lifetime": 380, "episode_len_mean": 50.0, "env_to_module_sum_episodes_length_out": 27.168093332126602, "module_to_env_connector": {"timers": {"connectors": {"get_actions": 0.00015058913896397075, "listify_data_for_vector_env": 3.0236724125413667e-05, "un_batch_to_individual_items": 1.4992903181460974e-05, "remove_single_ts_time_rank_from_batch": 1.400519227836389e-06, "normalize_and_clip_actions": 2.1722424594590152e-05, "tensor_to_numpy": 4.4521557400960305e-05}}, "connector_pipeline_timer": 0.00033979246232060997}, "num_module_steps_sampled_lifetime": {"default_policy": 19000}, "weights_seq_no": 19.0, "num_env_steps_sampled_lifetime": 96000, "rlmodule_inference_timer": 9.22350466558915e-05, "num_env_steps_sampled": 1000, "num_agent_steps_sampled": {"default_agent": 1000}, "episode_len_min": 50, "episode_duration_sec_mean": 0.03582128487000773, "episode_len_max": 50, "episode_return_max": 17.5, "num_module_steps_sampled": {"default_policy": 1000}, "env_to_module_sum_episodes_length_in": 27.168093332126602, "episode_return_mean": 0.9, "num_agent_steps_sampled_lifetime": {"default_agent": 19000}, "agent_episode_returns_mean": {"default_agent": 0.9}, "num_episodes": 20, "env_reset_timer": 0.00021152325435605838, "module_episode_returns_mean": {"default_policy": 0.9}, "episode_return_min": -16.5, "env_step_timer": 4.1104676064664325e-05, "sample": 0.7314200294819913, "time_between_sampling": 4.3004637991217045}, "num_healthy_workers": 1, "actor_manager_num_outstanding_async_reqs": 0, "num_remote_worker_restarts": 0}, "num_env_steps_sampled_lifetime": -4112500.0, "fault_tolerance": {"num_healthy_workers": 0, "num_remote_worker_restarts": 0}, "env_runner_group": {"actor_manager_num_outstanding_async_reqs": 0}, "done": false, "training_iteration": 19, "trial_id": "05062_00000", "date": "2025-08-11_18-10-30", "timestamp": 1754928630, "time_this_iter_s": 5.028236627578735, "time_total_s": 95.50901746749878, "pid": 113125, "hostname": "DESKTOP-3SK5A41", "node_ip": "192.168.40.242", "config": {"exploration_config": {}, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 6, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "env": "Umbrella", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": false, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 0, "create_local_env_runner": true, "num_envs_per_env_runner": 1, "gym_env_vectorize_mode": "SYNC", "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "episodes_to_numpy": true, "max_requests_in_flight_per_env_runner": 1, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "merge_env_runner_states": "training_only", "broadcast_env_runner_states": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "complete_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "sampler_perf_stats_ema_coef": null, "_is_online": true, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": "auto", "num_aggregator_actors_per_learner": 0, "max_requests_in_flight_per_aggregator_actor": 3, "local_gpu_idx": 0, "max_requests_in_flight_per_learner": 3, "gamma": 1, "lr": 0.0532857353826, "grad_clip": 0.5, "grad_clip_by": "global_norm", "_train_batch_size_per_learner": 5000, "train_batch_size": 4000, "num_epochs": 3, "minibatch_size": 1000, "shuffle_batch_per_epoch": true, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "log_std_clip_param": 20.0, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "_disable_preprocessor_api": false, "_disable_action_flattening": false}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "_learner_class": null, "callbacks_on_algorithm_init": null, "callbacks_on_env_runners_recreated": null, "callbacks_on_offline_eval_runners_recreated": null, "callbacks_on_checkpoint_loaded": null, "callbacks_on_environment_created": null, "callbacks_on_episode_created": null, "callbacks_on_episode_start": null, "callbacks_on_episode_step": null, "callbacks_on_episode_end": null, "callbacks_on_evaluate_start": null, "callbacks_on_evaluate_end": null, "callbacks_on_evaluate_offline_start": null, "callbacks_on_evaluate_offline_end": null, "callbacks_on_sample_end": null, "callbacks_on_train_result": null, "explore": true, "enable_rl_module_and_learner": true, "enable_env_runner_and_connector_v2": true, "_prior_exploration_config": {"type": "StochasticSampling"}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x723d4b64aac0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "offline_data_class": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_read_batch_size": null, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "materialize_data": false, "materialize_mapped_data": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "ignore_final_observation": false, "prelearner_class": null, "prelearner_buffer_class": null, "prelearner_buffer_kwargs": {}, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_remaining_data": false, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": 1, "evaluation_duration": 20, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_auto_duration_min_env_steps_per_sample": 100, "evaluation_auto_duration_max_env_steps_per_sample": 2000, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 1, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "offline_evaluation_interval": null, "num_offline_eval_runners": 0, "offline_loss_for_module_fn": null, "offline_evaluation_duration": 1, "offline_evaluation_parallel_to_training": false, "offline_evaluation_timeout_s": 120.0, "num_cpus_per_offline_eval_runner": 1, "num_gpus_per_offline_eval_runner": 0, "custom_resources_per_offline_eval_runner": {}, "restart_failed_offline_eval_runners": true, "ignore_offline_eval_runner_failures": false, "max_num_offline_eval_runner_restarts": 1000, "offline_eval_runner_restore_timeout_s": 1800.0, "max_requests_in_flight_per_offline_eval_runner": 1, "validate_offline_eval_runners_after_construction": true, "offline_eval_runner_health_probe_timeout_s": 30.0, "offline_eval_rl_module_inference_only": false, "broadcast_offline_eval_runner_states": false, "offline_eval_batch_size_per_runner": 256, "dataset_num_iters_per_eval_runner": 1, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "log_gradients": true, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 42, "restart_failed_env_runners": true, "ignore_env_runner_failures": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30.0, "env_runner_restore_timeout_s": 1800.0, "_model_config": {}, "_rl_module_spec": "RLModuleSpec(module_class=None, observation_space=None, action_space=None, inference_only=False, learner_only=False, model_config=DefaultModelConfig(fcnet_hiddens=[63, 126], fcnet_activation='tanh', fcnet_kernel_initializer=None, fcnet_kernel_initializer_kwargs=None, fcnet_bias_initializer=None, fcnet_bias_initializer_kwargs=None, conv_filters=None, conv_activation='relu', conv_kernel_initializer=None, conv_kernel_initializer_kwargs=None, conv_bias_initializer=None, conv_bias_initializer_kwargs=None, head_fcnet_hiddens=[], head_fcnet_activation='relu', head_fcnet_kernel_initializer=None, head_fcnet_kernel_initializer_kwargs=None, head_fcnet_bias_initializer=None, head_fcnet_bias_initializer_kwargs=None, free_log_std=False, log_std_clip_param=20.0, vf_share_layers=True, use_lstm=False, max_seq_len=20, lstm_cell_size=256, lstm_use_prev_action=False, lstm_use_prev_reward=False, lstm_kernel_initializer=None, lstm_kernel_initializer_kwargs=None, lstm_bias_initializer=None, lstm_bias_initializer_kwargs=None), catalog_class=None, load_state_path=None, model_config_dict=None)", "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "_validate_config": true, "_use_msgpack_checkpoints": false, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "env_task_fn": -1, "enable_connectors": -1, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.1024108006331, "kl_target": 0.0216481916482, "vf_loss_coeff": 0.5287015453939, "entropy_coeff": 0.0347123860443, "clip_param": 0.1072861819248, "vf_clip_param": 0.4447244315309, "entropy_coeff_schedule": null, "lr_schedule": null, "sgd_minibatch_size": -1, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9119716444993, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.callbacks.callbacks.RLlibCallback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 95.50901746749878, "iterations_since_restore": 19, "perf": {"cpu_util_percent": 12.528571428571428, "ram_util_percent": 69.92857142857143}}
{"timers": {"training_iteration": 4.316002741493585, "restore_env_runners": 1.4915243461337054e-05, "training_step": 4.31570783006821, "env_runner_sampling_timer": 3.874855156657501, "learner_update_timer": 0.43717580828887165, "synch_weights": 0.0014405585849378644, "restore_eval_env_runners": 1.4567641310400927e-05, "evaluation_iteration": 0.7429501305598003, "synch_eval_env_connectors": 0.00046620454966719155, "synch_env_connectors": 7.680818578526446e-06}, "env_runners": {"env_to_module_connector": {"timers": {"connectors": {"add_time_dim_to_batch_and_zero_pad": 6.780079365860936e-06, "add_states_from_episodes_to_batch": 3.5270456042848615e-06, "batch_individual_items": 1.856789316931643e-05, "add_observations_from_episodes_to_batch": 6.521296961515353e-06, "numpy_to_tensor": 3.066616258762329e-05}}, "connector_pipeline_timer": 0.00012040926290105968}, "sample": 0.037742902686459315, "module_to_env_connector": {"timers": {"connectors": {"tensor_to_numpy": 4.9638366670963694e-05, "listify_data_for_vector_env": 3.082945337443818e-05, "remove_single_ts_time_rank_from_batch": 1.4324692688287995e-06, "un_batch_to_individual_items": 1.4461965070770959e-05, "normalize_and_clip_actions": 2.2185701239084437e-05, "get_actions": 0.00016468715586309582}}, "connector_pipeline_timer": 0.0003613354988038602}, "episode_duration_sec_mean": 0.03661892966998492, "num_env_steps_sampled": 5000.0, "num_module_steps_sampled_lifetime": {"default_policy": -4355000.0}, "num_episodes": 100.0, "episode_len_max": 50, "num_episodes_lifetime": -87100.0, "episode_len_mean": 50.0, "env_to_module_sum_episodes_length_out": 27.16809333212661, "episode_return_max": -5.5, "num_agent_steps_sampled_lifetime": {"default_agent": -4355000.0}, "module_episode_returns_mean": {"default_policy": -5.5}, "env_reset_timer": 9.134566024330312e-05, "env_to_module_sum_episodes_length_in": 27.16809333212661, "agent_episode_returns_mean": {"default_agent": -5.5}, "episode_len_min": 50, "episode_return_mean": -5.5, "episode_return_min": -5.5, "num_agent_steps_sampled": {"default_agent": 5000.0}, "weights_seq_no": 19.0, "num_env_steps_sampled_lifetime": -4355000.0, "env_step_timer": 4.243479429174926e-05, "time_between_sampling": 0.012854847307375843, "rlmodule_inference_timer": 0.00010207271696630277, "num_module_steps_sampled": {"default_policy": 5000.0}, "num_env_steps_sampled_lifetime_throughput": 1278.090799755348}, "learners": {"__all_modules__": {"num_env_steps_trained_lifetime": 1632000, "learner_connector": {"timers": {"connectors": {"numpy_to_tensor": 0.00016238185513290566, "add_observations_from_episodes_to_batch": 0.0007342140826943746, "add_columns_from_episodes_to_train_batch": 0.06798266362811584, "general_advantage_estimation": 0.014113987885868071, "add_time_dim_to_batch_and_zero_pad": 2.136156318933144e-05, "add_states_from_episodes_to_batch": 6.138287691466459e-06, "batch_individual_items": 0.18532802590596023, "add_one_ts_to_episodes_and_truncate": 0.008605298039539392}}, "connector_pipeline_timer": 0.2772833236143373}, "num_module_steps_trained_lifetime": 320000, "num_non_trainable_parameters": 0, "num_module_steps_trained": 16000, "num_trainable_parameters": 8697, "learner_connector_sum_episodes_length_in": 5000.0, "learner_connector_sum_episodes_length_out": 5100.0, "num_env_steps_trained": 81600, "num_env_steps_trained_lifetime_throughput": 879351.0972860795, "num_module_steps_trained_throughput": 172682.9812471481, "num_module_steps_trained_lifetime_throughput": 172619.65796863826}, "default_policy": {"curr_kl_coeff": 0.004556730855256319, "gradients_default_optimizer_global_norm": 0.1087767705321312, "module_train_batch_size_mean": 1000.0, "weights_seq_no": 20.0, "mean_kl_loss": 0.003244298743084073, "diff_num_grad_updates_vs_sampler_policy": 1.0, "vf_loss": 0.4396471083164215, "vf_loss_unclipped": 149.0602569580078, "total_loss": 0.21161681413650513, "curr_entropy_coeff": 0.0347123860443, "policy_loss": -0.019816234707832336, "num_module_steps_trained_lifetime": 320000, "vf_explained_var": -0.45266127586364746, "default_optimizer_learning_rate": 0.0532857353826, "entropy": 0.02991863712668419, "num_module_steps_trained": 16000, "num_trainable_parameters": 8697, "num_module_steps_trained_lifetime_throughput": 172787.6165756497}}, "num_training_step_calls_per_iteration": 1, "evaluation": {"env_runners": {"env_to_module_connector": {"timers": {"connectors": {"numpy_to_tensor": 2.878872824354168e-05, "add_observations_from_episodes_to_batch": 6.038836810750306e-06, "add_time_dim_to_batch_and_zero_pad": 5.240773668126916e-06, "batch_individual_items": 1.7931523943860596e-05, "add_states_from_episodes_to_batch": 3.214170418919611e-06}}, "connector_pipeline_timer": 0.00011376442522470415}, "num_episodes_lifetime": 400, "episode_len_mean": 50.0, "env_to_module_sum_episodes_length_out": 27.168093332126602, "module_to_env_connector": {"timers": {"connectors": {"get_actions": 0.00015143910604064852, "listify_data_for_vector_env": 2.980192520644293e-05, "un_batch_to_individual_items": 1.4768574682421732e-05, "remove_single_ts_time_rank_from_batch": 1.3561363242407747e-06, "normalize_and_clip_actions": 2.136813569654588e-05, "tensor_to_numpy": 4.401726475397673e-05}}, "connector_pipeline_timer": 0.0003395452024461567}, "num_module_steps_sampled_lifetime": {"default_policy": 20000}, "weights_seq_no": 20.0, "num_env_steps_sampled_lifetime": 101000, "rlmodule_inference_timer": 9.168735410269807e-05, "num_env_steps_sampled": 1000, "num_agent_steps_sampled": {"default_agent": 1000}, "episode_len_min": 50, "episode_duration_sec_mean": 0.03508950182997978, "episode_len_max": 50, "episode_return_max": 17.5, "num_module_steps_sampled": {"default_policy": 1000}, "env_to_module_sum_episodes_length_in": 27.168093332126602, "episode_return_mean": 0.3, "num_agent_steps_sampled_lifetime": {"default_agent": 20000}, "agent_episode_returns_mean": {"default_agent": 0.3}, "num_episodes": 20, "env_reset_timer": 0.00021063802181962415, "module_episode_returns_mean": {"default_policy": 0.3}, "episode_return_min": -16.5, "env_step_timer": 4.1152663680609705e-05, "sample": 0.7313307761271762, "time_between_sampling": 4.299534208720494}, "num_healthy_workers": 1, "actor_manager_num_outstanding_async_reqs": 0, "num_remote_worker_restarts": 0}, "num_env_steps_sampled_lifetime": -4355000.0, "fault_tolerance": {"num_healthy_workers": 0, "num_remote_worker_restarts": 0}, "env_runner_group": {"actor_manager_num_outstanding_async_reqs": 0}, "done": true, "training_iteration": 20, "trial_id": "05062_00000", "date": "2025-08-11_18-10-34", "timestamp": 1754928634, "time_this_iter_s": 4.890849351882935, "time_total_s": 100.39986681938171, "pid": 113125, "hostname": "DESKTOP-3SK5A41", "node_ip": "192.168.40.242", "config": {"exploration_config": {}, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 6, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "env": "Umbrella", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": false, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 0, "create_local_env_runner": true, "num_envs_per_env_runner": 1, "gym_env_vectorize_mode": "SYNC", "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "episodes_to_numpy": true, "max_requests_in_flight_per_env_runner": 1, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "merge_env_runner_states": "training_only", "broadcast_env_runner_states": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "complete_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "sampler_perf_stats_ema_coef": null, "_is_online": true, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": "auto", "num_aggregator_actors_per_learner": 0, "max_requests_in_flight_per_aggregator_actor": 3, "local_gpu_idx": 0, "max_requests_in_flight_per_learner": 3, "gamma": 1, "lr": 0.0532857353826, "grad_clip": 0.5, "grad_clip_by": "global_norm", "_train_batch_size_per_learner": 5000, "train_batch_size": 4000, "num_epochs": 3, "minibatch_size": 1000, "shuffle_batch_per_epoch": true, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "log_std_clip_param": 20.0, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "_disable_preprocessor_api": false, "_disable_action_flattening": false}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "_learner_class": null, "callbacks_on_algorithm_init": null, "callbacks_on_env_runners_recreated": null, "callbacks_on_offline_eval_runners_recreated": null, "callbacks_on_checkpoint_loaded": null, "callbacks_on_environment_created": null, "callbacks_on_episode_created": null, "callbacks_on_episode_start": null, "callbacks_on_episode_step": null, "callbacks_on_episode_end": null, "callbacks_on_evaluate_start": null, "callbacks_on_evaluate_end": null, "callbacks_on_evaluate_offline_start": null, "callbacks_on_evaluate_offline_end": null, "callbacks_on_sample_end": null, "callbacks_on_train_result": null, "explore": true, "enable_rl_module_and_learner": true, "enable_env_runner_and_connector_v2": true, "_prior_exploration_config": {"type": "StochasticSampling"}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x723d4b64aac0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "offline_data_class": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_read_batch_size": null, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "materialize_data": false, "materialize_mapped_data": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "ignore_final_observation": false, "prelearner_class": null, "prelearner_buffer_class": null, "prelearner_buffer_kwargs": {}, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_remaining_data": false, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": 1, "evaluation_duration": 20, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_auto_duration_min_env_steps_per_sample": 100, "evaluation_auto_duration_max_env_steps_per_sample": 2000, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 1, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "offline_evaluation_interval": null, "num_offline_eval_runners": 0, "offline_loss_for_module_fn": null, "offline_evaluation_duration": 1, "offline_evaluation_parallel_to_training": false, "offline_evaluation_timeout_s": 120.0, "num_cpus_per_offline_eval_runner": 1, "num_gpus_per_offline_eval_runner": 0, "custom_resources_per_offline_eval_runner": {}, "restart_failed_offline_eval_runners": true, "ignore_offline_eval_runner_failures": false, "max_num_offline_eval_runner_restarts": 1000, "offline_eval_runner_restore_timeout_s": 1800.0, "max_requests_in_flight_per_offline_eval_runner": 1, "validate_offline_eval_runners_after_construction": true, "offline_eval_runner_health_probe_timeout_s": 30.0, "offline_eval_rl_module_inference_only": false, "broadcast_offline_eval_runner_states": false, "offline_eval_batch_size_per_runner": 256, "dataset_num_iters_per_eval_runner": 1, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "log_gradients": true, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 42, "restart_failed_env_runners": true, "ignore_env_runner_failures": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30.0, "env_runner_restore_timeout_s": 1800.0, "_model_config": {}, "_rl_module_spec": "RLModuleSpec(module_class=None, observation_space=None, action_space=None, inference_only=False, learner_only=False, model_config=DefaultModelConfig(fcnet_hiddens=[63, 126], fcnet_activation='tanh', fcnet_kernel_initializer=None, fcnet_kernel_initializer_kwargs=None, fcnet_bias_initializer=None, fcnet_bias_initializer_kwargs=None, conv_filters=None, conv_activation='relu', conv_kernel_initializer=None, conv_kernel_initializer_kwargs=None, conv_bias_initializer=None, conv_bias_initializer_kwargs=None, head_fcnet_hiddens=[], head_fcnet_activation='relu', head_fcnet_kernel_initializer=None, head_fcnet_kernel_initializer_kwargs=None, head_fcnet_bias_initializer=None, head_fcnet_bias_initializer_kwargs=None, free_log_std=False, log_std_clip_param=20.0, vf_share_layers=True, use_lstm=False, max_seq_len=20, lstm_cell_size=256, lstm_use_prev_action=False, lstm_use_prev_reward=False, lstm_kernel_initializer=None, lstm_kernel_initializer_kwargs=None, lstm_bias_initializer=None, lstm_bias_initializer_kwargs=None), catalog_class=None, load_state_path=None, model_config_dict=None)", "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "_validate_config": true, "_use_msgpack_checkpoints": false, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "env_task_fn": -1, "enable_connectors": -1, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.1024108006331, "kl_target": 0.0216481916482, "vf_loss_coeff": 0.5287015453939, "entropy_coeff": 0.0347123860443, "clip_param": 0.1072861819248, "vf_clip_param": 0.4447244315309, "entropy_coeff_schedule": null, "lr_schedule": null, "sgd_minibatch_size": -1, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9119716444993, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.callbacks.callbacks.RLlibCallback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 100.39986681938171, "iterations_since_restore": 20, "perf": {"cpu_util_percent": 12.842857142857142, "ram_util_percent": 69.97142857142856}}
