{"timers": {"training_iteration": 4.29331442299997, "restore_env_runners": 1.5700000062679464e-05, "training_step": 4.293073923000065, "env_runner_sampling_timer": 3.8708573199999137, "learner_update_timer": 0.41899460299998736, "synch_weights": 0.0014453999999659572}, "env_runners": {"episode_duration_sec_mean": 0.03614816116999009, "env_to_module_connector": {"timers": {"connectors": {"add_time_dim_to_batch_and_zero_pad": 6.802144448193145e-06, "batch_individual_items": 1.8837150187090408e-05, "add_observations_from_episodes_to_batch": 6.6580720404020925e-06, "add_states_from_episodes_to_batch": 3.4926384819220965e-06, "numpy_to_tensor": 3.082990679240492e-05}}, "connector_pipeline_timer": 0.0001220398086583939}, "num_env_steps_sampled_lifetime": 252500.0, "num_agent_steps_sampled_lifetime": {"default_agent": 252500.0}, "env_to_module_sum_episodes_length_out": 26.762340024562445, "num_episodes": 100.0, "episode_len_mean": 50.0, "module_to_env_connector": {"timers": {"connectors": {"get_actions": 0.00016856381726938343, "listify_data_for_vector_env": 3.120061515526001e-05, "un_batch_to_individual_items": 1.4997535490831638e-05, "tensor_to_numpy": 4.771866850163681e-05, "remove_single_ts_time_rank_from_batch": 1.490564205571067e-06, "normalize_and_clip_actions": 2.9497283228164848e-05}}, "connector_pipeline_timer": 0.00037179554491071915}, "num_agent_steps_sampled": {"default_agent": 5000.0}, "num_module_steps_sampled_lifetime": {"default_policy": 252500.0}, "rlmodule_inference_timer": 0.00010371238214124721, "env_to_module_sum_episodes_length_in": 26.762340024562445, "episode_return_max": 14.5, "num_episodes_lifetime": 5050.0, "module_episode_returns_mean": {"default_policy": 3.899999999999998}, "episode_return_mean": 3.899999999999998, "episode_len_min": 50, "sample": 0.03956883081097489, "agent_episode_returns_mean": {"default_agent": 3.899999999999998}, "env_reset_timer": 0.00018958842577496647, "num_module_steps_sampled": {"default_policy": 5000.0}, "time_between_sampling": 0.001340786694607713, "env_step_timer": 4.473447810419834e-05, "weights_seq_no": 0.0, "episode_return_min": -5.5, "episode_len_max": 50, "num_env_steps_sampled": 5000.0, "num_env_steps_sampled_lifetime_throughput": 1255.2398113185836}, "learners": {"__all_modules__": {"learner_connector": {"timers": {"connectors": {"add_columns_from_episodes_to_train_batch": 0.07040150000000267, "numpy_to_tensor": 0.0001692999999249878, "add_states_from_episodes_to_batch": 6.199999916134402e-06, "batch_individual_items": 0.20545350199995482, "add_one_ts_to_episodes_and_truncate": 0.008542299999930947, "general_advantage_estimation": 0.015250999999921078, "add_time_dim_to_batch_and_zero_pad": 2.419999998437561e-05, "add_observations_from_episodes_to_batch": 0.0007916999999224572}}, "connector_pipeline_timer": 0.3009615020000638}, "learner_connector_sum_episodes_length_in": 5000, "num_env_steps_trained": 30600, "num_module_steps_trained_lifetime": 6000, "learner_connector_sum_episodes_length_out": 5100, "num_module_steps_trained": 6000, "num_env_steps_trained_lifetime": 30600, "num_trainable_parameters": 6003, "num_non_trainable_parameters": 0, "num_env_steps_trained_lifetime_throughput": 960982.1594609338, "num_module_steps_trained_throughput": 189634.57834497417, "num_module_steps_trained_lifetime_throughput": 189573.7625960651}, "default_policy": {"module_train_batch_size_mean": 1000.0, "vf_explained_var": -0.020798325538635254, "mean_kl_loss": 8.478845120407641e-05, "num_trainable_parameters": 6003, "num_module_steps_trained_lifetime": 6000, "default_optimizer_learning_rate": 0.0002847858517, "policy_loss": 0.06000814214348793, "curr_entropy_coeff": 0.0090570820258, "vf_loss": 0.0949506089091301, "entropy": 0.691832959651947, "vf_loss_unclipped": 11.986690521240234, "weights_seq_no": 1.0, "total_loss": 0.11730913817882538, "num_module_steps_trained": 6000, "curr_kl_coeff": 0.3732481598854065, "gradients_default_optimizer_global_norm": 0.02067892998456955, "diff_num_grad_updates_vs_sampler_policy": 1.0, "num_module_steps_trained_lifetime_throughput": 190063.07426509744}}, "num_training_step_calls_per_iteration": 1, "num_env_steps_sampled_lifetime": 252500.0, "evaluation": {"env_runners": {"num_episodes": 20, "env_to_module_sum_episodes_length_in": 27.167134025045954, "episode_return_max": 17.5, "module_episode_returns_mean": {"default_policy": -0.9}, "sample": 0.764669605999984, "env_to_module_connector": {"timers": {"connectors": {"add_time_dim_to_batch_and_zero_pad": 5.438743370704407e-06, "add_observations_from_episodes_to_batch": 5.902076890143634e-06, "numpy_to_tensor": 3.0243040661407016e-05, "add_states_from_episodes_to_batch": 3.3973435888626457e-06, "batch_individual_items": 1.8292610992095277e-05}}, "connector_pipeline_timer": 0.00011230527882253218}, "env_step_timer": 4.102627911019889e-05, "weights_seq_no": 1.0, "module_to_env_connector": {"timers": {"connectors": {"un_batch_to_individual_items": 1.5188750901372314e-05, "tensor_to_numpy": 4.517880484254311e-05, "remove_single_ts_time_rank_from_batch": 1.44165852327796e-06, "listify_data_for_vector_env": 3.0260683331084793e-05, "get_actions": 0.0001517294501020312, "normalize_and_clip_actions": 2.1568751907809884e-05}}, "connector_pipeline_timer": 0.0003369719925028196}, "num_agent_steps_sampled": {"default_agent": 1000}, "env_to_module_sum_episodes_length_out": 27.167134025045954, "num_module_steps_sampled_lifetime": {"default_policy": 1000}, "rlmodule_inference_timer": 9.280010628416764e-05, "num_episodes_lifetime": 20, "episode_return_mean": -0.9, "num_module_steps_sampled": {"default_policy": 1000}, "env_reset_timer": 0.00023120000003018504, "num_env_steps_sampled": 1000, "episode_duration_sec_mean": 0.03670743030000949, "num_env_steps_sampled_lifetime": 6000, "num_agent_steps_sampled_lifetime": {"default_agent": 1000}, "episode_len_mean": 50.0, "episode_len_min": 50, "episode_return_min": -14.5, "episode_len_max": 50, "agent_episode_returns_mean": {"default_agent": -0.9}}, "num_healthy_workers": 1, "actor_manager_num_outstanding_async_reqs": 0, "num_remote_worker_restarts": 0}, "fault_tolerance": {"num_healthy_workers": 0, "num_remote_worker_restarts": 0}, "env_runner_group": {"actor_manager_num_outstanding_async_reqs": 0}, "done": false, "training_iteration": 1, "trial_id": "98b6d_00000", "date": "2025-08-11_16-15-28", "timestamp": 1754921728, "time_this_iter_s": 5.07257866859436, "time_total_s": 5.07257866859436, "pid": 16141, "hostname": "DESKTOP-3SK5A41", "node_ip": "192.168.40.242", "config": {"exploration_config": {}, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 6, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "env": "Umbrella", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": false, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 0, "create_local_env_runner": true, "num_envs_per_env_runner": 1, "gym_env_vectorize_mode": "SYNC", "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "episodes_to_numpy": true, "max_requests_in_flight_per_env_runner": 1, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "merge_env_runner_states": "training_only", "broadcast_env_runner_states": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "complete_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "sampler_perf_stats_ema_coef": null, "_is_online": true, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": "auto", "num_aggregator_actors_per_learner": 0, "max_requests_in_flight_per_aggregator_actor": 3, "local_gpu_idx": 0, "max_requests_in_flight_per_learner": 3, "gamma": 1, "lr": 0.0002847858517, "grad_clip": 0.5, "grad_clip_by": "global_norm", "_train_batch_size_per_learner": 5000, "train_batch_size": 4000, "num_epochs": 1, "minibatch_size": 1000, "shuffle_batch_per_epoch": true, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "log_std_clip_param": 20.0, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "_disable_preprocessor_api": false, "_disable_action_flattening": false}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "_learner_class": null, "callbacks_on_algorithm_init": null, "callbacks_on_env_runners_recreated": null, "callbacks_on_offline_eval_runners_recreated": null, "callbacks_on_checkpoint_loaded": null, "callbacks_on_environment_created": null, "callbacks_on_episode_created": null, "callbacks_on_episode_start": null, "callbacks_on_episode_step": null, "callbacks_on_episode_end": null, "callbacks_on_evaluate_start": null, "callbacks_on_evaluate_end": null, "callbacks_on_evaluate_offline_start": null, "callbacks_on_evaluate_offline_end": null, "callbacks_on_sample_end": null, "callbacks_on_train_result": null, "explore": true, "enable_rl_module_and_learner": true, "enable_env_runner_and_connector_v2": true, "_prior_exploration_config": {"type": "StochasticSampling"}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x79cd443c6ac0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "offline_data_class": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_read_batch_size": null, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "materialize_data": false, "materialize_mapped_data": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "ignore_final_observation": false, "prelearner_class": null, "prelearner_buffer_class": null, "prelearner_buffer_kwargs": {}, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_remaining_data": false, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": 1, "evaluation_duration": 20, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_auto_duration_min_env_steps_per_sample": 100, "evaluation_auto_duration_max_env_steps_per_sample": 2000, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 1, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "offline_evaluation_interval": null, "num_offline_eval_runners": 0, "offline_loss_for_module_fn": null, "offline_evaluation_duration": 1, "offline_evaluation_parallel_to_training": false, "offline_evaluation_timeout_s": 120.0, "num_cpus_per_offline_eval_runner": 1, "num_gpus_per_offline_eval_runner": 0, "custom_resources_per_offline_eval_runner": {}, "restart_failed_offline_eval_runners": true, "ignore_offline_eval_runner_failures": false, "max_num_offline_eval_runner_restarts": 1000, "offline_eval_runner_restore_timeout_s": 1800.0, "max_requests_in_flight_per_offline_eval_runner": 1, "validate_offline_eval_runners_after_construction": true, "offline_eval_runner_health_probe_timeout_s": 30.0, "offline_eval_rl_module_inference_only": false, "broadcast_offline_eval_runner_states": false, "offline_eval_batch_size_per_runner": 256, "dataset_num_iters_per_eval_runner": 1, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "log_gradients": true, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 42, "restart_failed_env_runners": true, "ignore_env_runner_failures": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30.0, "env_runner_restore_timeout_s": 1800.0, "_model_config": {}, "_rl_module_spec": "RLModuleSpec(module_class=None, observation_space=None, action_space=None, inference_only=False, learner_only=False, model_config=DefaultModelConfig(fcnet_hiddens=[60, 90], fcnet_activation='tanh', fcnet_kernel_initializer=None, fcnet_kernel_initializer_kwargs=None, fcnet_bias_initializer=None, fcnet_bias_initializer_kwargs=None, conv_filters=None, conv_activation='relu', conv_kernel_initializer=None, conv_kernel_initializer_kwargs=None, conv_bias_initializer=None, conv_bias_initializer_kwargs=None, head_fcnet_hiddens=[], head_fcnet_activation='relu', head_fcnet_kernel_initializer=None, head_fcnet_kernel_initializer_kwargs=None, head_fcnet_bias_initializer=None, head_fcnet_bias_initializer_kwargs=None, free_log_std=False, log_std_clip_param=20.0, vf_share_layers=True, use_lstm=False, max_seq_len=20, lstm_cell_size=256, lstm_use_prev_action=False, lstm_use_prev_reward=False, lstm_kernel_initializer=None, lstm_kernel_initializer_kwargs=None, lstm_bias_initializer=None, lstm_bias_initializer_kwargs=None), catalog_class=None, load_state_path=None, model_config_dict=None)", "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "_validate_config": true, "_use_msgpack_checkpoints": false, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "env_task_fn": -1, "enable_connectors": -1, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.7464963036515, "kl_target": 0.0270990929592, "vf_loss_coeff": 0.6688075857018, "entropy_coeff": 0.0090570820258, "clip_param": 0.1221781641624, "vf_clip_param": 0.1027808522125, "entropy_coeff_schedule": null, "lr_schedule": null, "sgd_minibatch_size": -1, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9099046732075, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.callbacks.callbacks.RLlibCallback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 5.07257866859436, "iterations_since_restore": 1, "perf": {"cpu_util_percent": 11.3375, "ram_util_percent": 89.25}}
{"timers": {"training_iteration": 4.29342694009997, "restore_env_runners": 1.5703000062785574e-05, "training_step": 4.293184380100064, "env_runner_sampling_timer": 3.8732941341299147, "learner_update_timer": 0.416653501969987, "synch_weights": 0.0014512089999664112, "restore_eval_env_runners": 1.3500000022759195e-05, "evaluation_iteration": 0.7764303060000657, "synch_eval_env_connectors": 0.0005751999999574764, "synch_env_connectors": 8.699999966665928e-06}, "env_runners": {"episode_duration_sec_mean": 0.03842037131999744, "env_to_module_connector": {"timers": {"connectors": {"add_time_dim_to_batch_and_zero_pad": 6.985140581567588e-06, "batch_individual_items": 1.944458707453721e-05, "add_observations_from_episodes_to_batch": 6.851126276205181e-06, "add_states_from_episodes_to_batch": 3.749229429582342e-06, "numpy_to_tensor": 3.2006872857062905e-05}}, "connector_pipeline_timer": 0.00012446343324414813}, "num_env_steps_sampled_lifetime": 10000.0, "num_agent_steps_sampled_lifetime": {"default_agent": 10000.0}, "env_to_module_sum_episodes_length_out": 27.16809333212661, "num_episodes": 100.0, "episode_len_mean": 50.0, "module_to_env_connector": {"timers": {"connectors": {"get_actions": 0.0001738372896989478, "listify_data_for_vector_env": 3.257095195117808e-05, "un_batch_to_individual_items": 1.542599666170897e-05, "tensor_to_numpy": 5.1179211850337124e-05, "remove_single_ts_time_rank_from_batch": 1.5255695488825907e-06, "normalize_and_clip_actions": 2.409545178966191e-05}}, "connector_pipeline_timer": 0.00037929902414198836}, "num_agent_steps_sampled": {"default_agent": 5000.0}, "num_module_steps_sampled_lifetime": {"default_policy": 10000.0}, "rlmodule_inference_timer": 0.00010572150463799735, "env_to_module_sum_episodes_length_in": 27.16809333212661, "episode_return_max": 14.5, "num_episodes_lifetime": 200.0, "module_episode_returns_mean": {"default_policy": 2.3000000000000007}, "episode_return_mean": 2.3000000000000007, "episode_len_min": 50, "sample": 0.03886892267800413, "agent_episode_returns_mean": {"default_agent": 2.3000000000000007}, "env_reset_timer": 0.0001345819310784832, "num_module_steps_sampled": {"default_policy": 5000.0}, "time_between_sampling": 0.009294365290688925, "env_step_timer": 4.555542372148458e-05, "weights_seq_no": 1.0, "episode_return_min": -5.5, "episode_len_max": 50, "num_env_steps_sampled": 5000.0, "num_env_steps_sampled_lifetime_throughput": 1239.4353720384106}, "learners": {"__all_modules__": {"learner_connector": {"timers": {"connectors": {"add_columns_from_episodes_to_train_batch": 0.07038253500000337, "numpy_to_tensor": 0.00016930199992657436, "add_states_from_episodes_to_batch": 6.203999917033798e-06, "batch_individual_items": 0.20399302097995586, "add_one_ts_to_episodes_and_truncate": 0.008540013999931944, "general_advantage_estimation": 0.015211792999922409, "add_time_dim_to_batch_and_zero_pad": 2.421199998480006e-05, "add_observations_from_episodes_to_batch": 0.0007908839999231532}}, "connector_pipeline_timer": 0.29943897998006264}, "learner_connector_sum_episodes_length_in": 5000.0, "num_env_steps_trained": 30600, "num_module_steps_trained_lifetime": 12000, "learner_connector_sum_episodes_length_out": 5100.0, "num_module_steps_trained": 6000, "num_env_steps_trained_lifetime": 61200, "num_trainable_parameters": 6003, "num_non_trainable_parameters": 0, "num_env_steps_trained_lifetime_throughput": 958850.3303089079, "num_module_steps_trained_throughput": 189202.52508833635, "num_module_steps_trained_lifetime_throughput": 189141.4760383005}, "default_policy": {"module_train_batch_size_mean": 1000.0, "vf_explained_var": -0.014240503311157227, "mean_kl_loss": 0.00037156903999857605, "num_trainable_parameters": 6003, "num_module_steps_trained_lifetime": 12000, "default_optimizer_learning_rate": 0.0002847858517, "policy_loss": 0.07703109085559845, "curr_entropy_coeff": 0.0090570820258, "vf_loss": 0.09431832283735275, "entropy": 0.6927804946899414, "vf_loss_unclipped": 11.453439712524414, "weights_seq_no": 2.0, "total_loss": 0.133976012468338, "num_module_steps_trained": 6000, "curr_kl_coeff": 0.18662407994270325, "gradients_default_optimizer_global_norm": 0.06007183715701103, "diff_num_grad_updates_vs_sampler_policy": 1.0, "num_module_steps_trained_lifetime_throughput": 189622.17953972725}}, "num_training_step_calls_per_iteration": 1, "evaluation": {"env_runners": {"num_episodes": 20, "env_to_module_sum_episodes_length_in": 27.168093298253442, "episode_return_max": 17.5, "module_episode_returns_mean": {"default_policy": -1.9}, "sample": 0.7644100889499839, "env_to_module_connector": {"timers": {"connectors": {"add_time_dim_to_batch_and_zero_pad": 5.982789768150101e-06, "add_observations_from_episodes_to_batch": 6.460529551184827e-06, "numpy_to_tensor": 2.9465521008734653e-05, "add_states_from_episodes_to_batch": 3.4814912348669003e-06, "batch_individual_items": 1.8966565820997184e-05}}, "connector_pipeline_timer": 0.00011472588072853718}, "env_step_timer": 4.402582915066902e-05, "weights_seq_no": 2.0, "module_to_env_connector": {"timers": {"connectors": {"un_batch_to_individual_items": 1.534158255453357e-05, "tensor_to_numpy": 4.684440568752075e-05, "remove_single_ts_time_rank_from_batch": 1.5064306553851832e-06, "listify_data_for_vector_env": 3.1219602776395957e-05, "get_actions": 0.0001588924399766893, "normalize_and_clip_actions": 2.2593366221317363e-05}}, "connector_pipeline_timer": 0.0003497743078534455}, "num_agent_steps_sampled": {"default_agent": 1000}, "env_to_module_sum_episodes_length_out": 27.168093298253442, "num_module_steps_sampled_lifetime": {"default_policy": 2000}, "rlmodule_inference_timer": 9.554935615777034e-05, "num_episodes_lifetime": 40, "episode_return_mean": -1.9, "num_module_steps_sampled": {"default_policy": 1000}, "env_reset_timer": 0.00023104200002990182, "num_env_steps_sampled": 1000, "episode_duration_sec_mean": 0.03610276267501149, "num_env_steps_sampled_lifetime": 11000, "num_agent_steps_sampled_lifetime": {"default_agent": 2000}, "episode_len_mean": 50.0, "episode_len_min": 50, "episode_return_min": -14.5, "episode_len_max": 50, "agent_episode_returns_mean": {"default_agent": -1.9}, "time_between_sampling": 4.363354932999982}, "num_healthy_workers": 1, "actor_manager_num_outstanding_async_reqs": 0, "num_remote_worker_restarts": 0}, "num_env_steps_sampled_lifetime": 10000.0, "fault_tolerance": {"num_healthy_workers": 0, "num_remote_worker_restarts": 0}, "env_runner_group": {"actor_manager_num_outstanding_async_reqs": 0}, "done": false, "training_iteration": 2, "trial_id": "98b6d_00000", "date": "2025-08-11_16-15-33", "timestamp": 1754921733, "time_this_iter_s": 5.058987140655518, "time_total_s": 10.131565809249878, "pid": 16141, "hostname": "DESKTOP-3SK5A41", "node_ip": "192.168.40.242", "config": {"exploration_config": {}, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 6, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "env": "Umbrella", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": false, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 0, "create_local_env_runner": true, "num_envs_per_env_runner": 1, "gym_env_vectorize_mode": "SYNC", "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "episodes_to_numpy": true, "max_requests_in_flight_per_env_runner": 1, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "merge_env_runner_states": "training_only", "broadcast_env_runner_states": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "complete_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "sampler_perf_stats_ema_coef": null, "_is_online": true, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": "auto", "num_aggregator_actors_per_learner": 0, "max_requests_in_flight_per_aggregator_actor": 3, "local_gpu_idx": 0, "max_requests_in_flight_per_learner": 3, "gamma": 1, "lr": 0.0002847858517, "grad_clip": 0.5, "grad_clip_by": "global_norm", "_train_batch_size_per_learner": 5000, "train_batch_size": 4000, "num_epochs": 1, "minibatch_size": 1000, "shuffle_batch_per_epoch": true, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "log_std_clip_param": 20.0, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "_disable_preprocessor_api": false, "_disable_action_flattening": false}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "_learner_class": null, "callbacks_on_algorithm_init": null, "callbacks_on_env_runners_recreated": null, "callbacks_on_offline_eval_runners_recreated": null, "callbacks_on_checkpoint_loaded": null, "callbacks_on_environment_created": null, "callbacks_on_episode_created": null, "callbacks_on_episode_start": null, "callbacks_on_episode_step": null, "callbacks_on_episode_end": null, "callbacks_on_evaluate_start": null, "callbacks_on_evaluate_end": null, "callbacks_on_evaluate_offline_start": null, "callbacks_on_evaluate_offline_end": null, "callbacks_on_sample_end": null, "callbacks_on_train_result": null, "explore": true, "enable_rl_module_and_learner": true, "enable_env_runner_and_connector_v2": true, "_prior_exploration_config": {"type": "StochasticSampling"}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x79cd443c6ac0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "offline_data_class": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_read_batch_size": null, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "materialize_data": false, "materialize_mapped_data": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "ignore_final_observation": false, "prelearner_class": null, "prelearner_buffer_class": null, "prelearner_buffer_kwargs": {}, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_remaining_data": false, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": 1, "evaluation_duration": 20, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_auto_duration_min_env_steps_per_sample": 100, "evaluation_auto_duration_max_env_steps_per_sample": 2000, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 1, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "offline_evaluation_interval": null, "num_offline_eval_runners": 0, "offline_loss_for_module_fn": null, "offline_evaluation_duration": 1, "offline_evaluation_parallel_to_training": false, "offline_evaluation_timeout_s": 120.0, "num_cpus_per_offline_eval_runner": 1, "num_gpus_per_offline_eval_runner": 0, "custom_resources_per_offline_eval_runner": {}, "restart_failed_offline_eval_runners": true, "ignore_offline_eval_runner_failures": false, "max_num_offline_eval_runner_restarts": 1000, "offline_eval_runner_restore_timeout_s": 1800.0, "max_requests_in_flight_per_offline_eval_runner": 1, "validate_offline_eval_runners_after_construction": true, "offline_eval_runner_health_probe_timeout_s": 30.0, "offline_eval_rl_module_inference_only": false, "broadcast_offline_eval_runner_states": false, "offline_eval_batch_size_per_runner": 256, "dataset_num_iters_per_eval_runner": 1, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "log_gradients": true, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 42, "restart_failed_env_runners": true, "ignore_env_runner_failures": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30.0, "env_runner_restore_timeout_s": 1800.0, "_model_config": {}, "_rl_module_spec": "RLModuleSpec(module_class=None, observation_space=None, action_space=None, inference_only=False, learner_only=False, model_config=DefaultModelConfig(fcnet_hiddens=[60, 90], fcnet_activation='tanh', fcnet_kernel_initializer=None, fcnet_kernel_initializer_kwargs=None, fcnet_bias_initializer=None, fcnet_bias_initializer_kwargs=None, conv_filters=None, conv_activation='relu', conv_kernel_initializer=None, conv_kernel_initializer_kwargs=None, conv_bias_initializer=None, conv_bias_initializer_kwargs=None, head_fcnet_hiddens=[], head_fcnet_activation='relu', head_fcnet_kernel_initializer=None, head_fcnet_kernel_initializer_kwargs=None, head_fcnet_bias_initializer=None, head_fcnet_bias_initializer_kwargs=None, free_log_std=False, log_std_clip_param=20.0, vf_share_layers=True, use_lstm=False, max_seq_len=20, lstm_cell_size=256, lstm_use_prev_action=False, lstm_use_prev_reward=False, lstm_kernel_initializer=None, lstm_kernel_initializer_kwargs=None, lstm_bias_initializer=None, lstm_bias_initializer_kwargs=None), catalog_class=None, load_state_path=None, model_config_dict=None)", "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "_validate_config": true, "_use_msgpack_checkpoints": false, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "env_task_fn": -1, "enable_connectors": -1, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.7464963036515, "kl_target": 0.0270990929592, "vf_loss_coeff": 0.6688075857018, "entropy_coeff": 0.0090570820258, "clip_param": 0.1221781641624, "vf_clip_param": 0.1027808522125, "entropy_coeff_schedule": null, "lr_schedule": null, "sgd_minibatch_size": -1, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9099046732075, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.callbacks.callbacks.RLlibCallback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 10.131565809249878, "iterations_since_restore": 2, "perf": {"cpu_util_percent": 12.957142857142857, "ram_util_percent": 89.41428571428571}}
{"timers": {"training_iteration": 4.294237595708969, "restore_env_runners": 1.5685970061804254e-05, "training_step": 4.293993726309063, "env_runner_sampling_timer": 3.8762966097986156, "learner_update_timer": 0.4144506459502875, "synch_weights": 0.001451354909966801, "restore_eval_env_runners": 1.3666000022567459e-05, "evaluation_iteration": 0.7761615069500658, "synch_eval_env_connectors": 0.0005750129999580622, "synch_env_connectors": 8.696999966559815e-06}, "env_runners": {"episode_duration_sec_mean": 0.03910633100998895, "env_to_module_connector": {"timers": {"connectors": {"add_time_dim_to_batch_and_zero_pad": 6.828159038271924e-06, "batch_individual_items": 1.9249915269440097e-05, "add_observations_from_episodes_to_batch": 6.718640037312248e-06, "add_states_from_episodes_to_batch": 3.6403684541078824e-06, "numpy_to_tensor": 3.1784563511318567e-05}}, "connector_pipeline_timer": 0.0001226801427137097}, "num_env_steps_sampled_lifetime": -232500.0, "num_agent_steps_sampled_lifetime": {"default_agent": -232500.0}, "env_to_module_sum_episodes_length_out": 27.16809333212661, "num_episodes": 100.0, "episode_len_mean": 50.0, "module_to_env_connector": {"timers": {"connectors": {"get_actions": 0.00017072716185516517, "listify_data_for_vector_env": 3.185861981513586e-05, "un_batch_to_individual_items": 1.5111015239691152e-05, "tensor_to_numpy": 5.062150169548619e-05, "remove_single_ts_time_rank_from_batch": 1.521719482223018e-06, "normalize_and_clip_actions": 2.3617826785083828e-05}}, "connector_pipeline_timer": 0.00037336088267467363}, "num_agent_steps_sampled": {"default_agent": 5000.0}, "num_module_steps_sampled_lifetime": {"default_policy": -232500.0}, "rlmodule_inference_timer": 0.00013880518425239604, "env_to_module_sum_episodes_length_in": 27.16809333212661, "episode_return_max": 14.5, "num_episodes_lifetime": -4650.0, "module_episode_returns_mean": {"default_policy": 4.3}, "episode_return_mean": 4.3, "episode_len_min": 50, "sample": 0.03922855928924423, "agent_episode_returns_mean": {"default_agent": 4.3}, "env_reset_timer": 0.00011395598569430121, "num_module_steps_sampled": {"default_policy": 5000.0}, "time_between_sampling": 0.010644437052900706, "env_step_timer": 4.453799749397466e-05, "weights_seq_no": 2.0, "episode_return_min": -5.5, "episode_len_max": 50, "num_env_steps_sampled": 5000.0, "num_env_steps_sampled_lifetime_throughput": 1238.3170261202329}, "learners": {"__all_modules__": {"learner_connector": {"timers": {"connectors": {"add_columns_from_episodes_to_train_batch": 0.07037492065000282, "numpy_to_tensor": 0.0001694819799272409, "add_states_from_episodes_to_batch": 6.201959917711975e-06, "batch_individual_items": 0.2025824437701568, "add_one_ts_to_episodes_and_truncate": 0.008542724859932651, "general_advantage_estimation": 0.015185384069923327, "add_time_dim_to_batch_and_zero_pad": 2.423687998530113e-05, "add_observations_from_episodes_to_batch": 0.000790078159923155}}, "connector_pipeline_timer": 0.2979961011802621}, "learner_connector_sum_episodes_length_in": 5000.0, "num_env_steps_trained": 30600, "num_module_steps_trained_lifetime": 18000, "learner_connector_sum_episodes_length_out": 5100.0, "num_module_steps_trained": 6000, "num_env_steps_trained_lifetime": 91800, "num_trainable_parameters": 6003, "num_non_trainable_parameters": 0, "num_env_steps_trained_lifetime_throughput": 953825.9797243942, "num_module_steps_trained_throughput": 188192.7388450111, "num_module_steps_trained_lifetime_throughput": 188131.71818400922}, "default_policy": {"module_train_batch_size_mean": 1000.0, "vf_explained_var": -0.007626891136169434, "mean_kl_loss": 7.6045403147873e-06, "num_trainable_parameters": 6003, "num_module_steps_trained_lifetime": 18000, "default_optimizer_learning_rate": 0.0002847858517, "policy_loss": 0.2021527737379074, "curr_entropy_coeff": 0.0090570820258, "vf_loss": 0.09427744150161743, "entropy": 0.6928194761276245, "vf_loss_unclipped": 11.454535484313965, "weights_seq_no": 3.0, "total_loss": 0.25893276929855347, "num_module_steps_trained": 6000, "curr_kl_coeff": 0.09331203997135162, "gradients_default_optimizer_global_norm": 0.04674099013209343, "diff_num_grad_updates_vs_sampler_policy": 1.0, "num_module_steps_trained_lifetime_throughput": 188595.43133307155}}, "num_training_step_calls_per_iteration": 1, "evaluation": {"env_runners": {"num_episodes": 20, "env_to_module_sum_episodes_length_in": 27.168093332125434, "episode_return_max": 17.5, "module_episode_returns_mean": {"default_policy": 0.1}, "sample": 0.7640004980604835, "env_to_module_connector": {"timers": {"connectors": {"add_time_dim_to_batch_and_zero_pad": 5.783330603552348e-06, "add_observations_from_episodes_to_batch": 6.079056042242396e-06, "numpy_to_tensor": 2.8805641284062073e-05, "add_states_from_episodes_to_batch": 3.4702296512095893e-06, "batch_individual_items": 1.864955543587575e-05}}, "connector_pipeline_timer": 0.00011207113368282927}, "env_step_timer": 4.24073033978304e-05, "weights_seq_no": 3.0, "module_to_env_connector": {"timers": {"connectors": {"un_batch_to_individual_items": 1.5114828435470881e-05, "tensor_to_numpy": 4.548378621073456e-05, "remove_single_ts_time_rank_from_batch": 1.4129277544410477e-06, "listify_data_for_vector_env": 3.1068451872070105e-05, "get_actions": 0.00015566029119482922, "normalize_and_clip_actions": 2.2012743543908883e-05}}, "connector_pipeline_timer": 0.000343238994327158}, "num_agent_steps_sampled": {"default_agent": 1000}, "env_to_module_sum_episodes_length_out": 27.168093332125434, "num_module_steps_sampled_lifetime": {"default_policy": 3000}, "rlmodule_inference_timer": 9.391585312185652e-05, "num_episodes_lifetime": 60, "episode_return_mean": 0.1, "num_module_steps_sampled": {"default_policy": 1000}, "env_reset_timer": 0.00023005258002933715, "num_env_steps_sampled": 1000, "episode_duration_sec_mean": 0.035652130116672724, "num_env_steps_sampled_lifetime": 16000, "num_agent_steps_sampled_lifetime": {"default_agent": 3000}, "episode_len_mean": 50.0, "episode_len_min": 50, "episode_return_min": -14.5, "episode_len_max": 50, "agent_episode_returns_mean": {"default_agent": 0.1}, "time_between_sampling": 4.364054340679982}, "num_healthy_workers": 1, "actor_manager_num_outstanding_async_reqs": 0, "num_remote_worker_restarts": 0}, "num_env_steps_sampled_lifetime": -232500.0, "fault_tolerance": {"num_healthy_workers": 0, "num_remote_worker_restarts": 0}, "env_runner_group": {"actor_manager_num_outstanding_async_reqs": 0}, "done": false, "training_iteration": 3, "trial_id": "98b6d_00000", "date": "2025-08-11_16-15-38", "timestamp": 1754921738, "time_this_iter_s": 5.113552093505859, "time_total_s": 15.245117902755737, "pid": 16141, "hostname": "DESKTOP-3SK5A41", "node_ip": "192.168.40.242", "config": {"exploration_config": {}, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 6, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "env": "Umbrella", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": false, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 0, "create_local_env_runner": true, "num_envs_per_env_runner": 1, "gym_env_vectorize_mode": "SYNC", "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "episodes_to_numpy": true, "max_requests_in_flight_per_env_runner": 1, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "merge_env_runner_states": "training_only", "broadcast_env_runner_states": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "complete_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "sampler_perf_stats_ema_coef": null, "_is_online": true, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": "auto", "num_aggregator_actors_per_learner": 0, "max_requests_in_flight_per_aggregator_actor": 3, "local_gpu_idx": 0, "max_requests_in_flight_per_learner": 3, "gamma": 1, "lr": 0.0002847858517, "grad_clip": 0.5, "grad_clip_by": "global_norm", "_train_batch_size_per_learner": 5000, "train_batch_size": 4000, "num_epochs": 1, "minibatch_size": 1000, "shuffle_batch_per_epoch": true, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "log_std_clip_param": 20.0, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "_disable_preprocessor_api": false, "_disable_action_flattening": false}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "_learner_class": null, "callbacks_on_algorithm_init": null, "callbacks_on_env_runners_recreated": null, "callbacks_on_offline_eval_runners_recreated": null, "callbacks_on_checkpoint_loaded": null, "callbacks_on_environment_created": null, "callbacks_on_episode_created": null, "callbacks_on_episode_start": null, "callbacks_on_episode_step": null, "callbacks_on_episode_end": null, "callbacks_on_evaluate_start": null, "callbacks_on_evaluate_end": null, "callbacks_on_evaluate_offline_start": null, "callbacks_on_evaluate_offline_end": null, "callbacks_on_sample_end": null, "callbacks_on_train_result": null, "explore": true, "enable_rl_module_and_learner": true, "enable_env_runner_and_connector_v2": true, "_prior_exploration_config": {"type": "StochasticSampling"}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x79cd443c6ac0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "offline_data_class": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_read_batch_size": null, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "materialize_data": false, "materialize_mapped_data": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "ignore_final_observation": false, "prelearner_class": null, "prelearner_buffer_class": null, "prelearner_buffer_kwargs": {}, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_remaining_data": false, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": 1, "evaluation_duration": 20, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_auto_duration_min_env_steps_per_sample": 100, "evaluation_auto_duration_max_env_steps_per_sample": 2000, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 1, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "offline_evaluation_interval": null, "num_offline_eval_runners": 0, "offline_loss_for_module_fn": null, "offline_evaluation_duration": 1, "offline_evaluation_parallel_to_training": false, "offline_evaluation_timeout_s": 120.0, "num_cpus_per_offline_eval_runner": 1, "num_gpus_per_offline_eval_runner": 0, "custom_resources_per_offline_eval_runner": {}, "restart_failed_offline_eval_runners": true, "ignore_offline_eval_runner_failures": false, "max_num_offline_eval_runner_restarts": 1000, "offline_eval_runner_restore_timeout_s": 1800.0, "max_requests_in_flight_per_offline_eval_runner": 1, "validate_offline_eval_runners_after_construction": true, "offline_eval_runner_health_probe_timeout_s": 30.0, "offline_eval_rl_module_inference_only": false, "broadcast_offline_eval_runner_states": false, "offline_eval_batch_size_per_runner": 256, "dataset_num_iters_per_eval_runner": 1, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "log_gradients": true, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 42, "restart_failed_env_runners": true, "ignore_env_runner_failures": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30.0, "env_runner_restore_timeout_s": 1800.0, "_model_config": {}, "_rl_module_spec": "RLModuleSpec(module_class=None, observation_space=None, action_space=None, inference_only=False, learner_only=False, model_config=DefaultModelConfig(fcnet_hiddens=[60, 90], fcnet_activation='tanh', fcnet_kernel_initializer=None, fcnet_kernel_initializer_kwargs=None, fcnet_bias_initializer=None, fcnet_bias_initializer_kwargs=None, conv_filters=None, conv_activation='relu', conv_kernel_initializer=None, conv_kernel_initializer_kwargs=None, conv_bias_initializer=None, conv_bias_initializer_kwargs=None, head_fcnet_hiddens=[], head_fcnet_activation='relu', head_fcnet_kernel_initializer=None, head_fcnet_kernel_initializer_kwargs=None, head_fcnet_bias_initializer=None, head_fcnet_bias_initializer_kwargs=None, free_log_std=False, log_std_clip_param=20.0, vf_share_layers=True, use_lstm=False, max_seq_len=20, lstm_cell_size=256, lstm_use_prev_action=False, lstm_use_prev_reward=False, lstm_kernel_initializer=None, lstm_kernel_initializer_kwargs=None, lstm_bias_initializer=None, lstm_bias_initializer_kwargs=None), catalog_class=None, load_state_path=None, model_config_dict=None)", "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "_validate_config": true, "_use_msgpack_checkpoints": false, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "env_task_fn": -1, "enable_connectors": -1, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.7464963036515, "kl_target": 0.0270990929592, "vf_loss_coeff": 0.6688075857018, "entropy_coeff": 0.0090570820258, "clip_param": 0.1221781641624, "vf_clip_param": 0.1027808522125, "entropy_coeff_schedule": null, "lr_schedule": null, "sgd_minibatch_size": -1, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9099046732075, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.callbacks.callbacks.RLlibCallback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 15.245117902755737, "iterations_since_restore": 3, "perf": {"cpu_util_percent": 12.328571428571427, "ram_util_percent": 89.5}}
{"timers": {"training_iteration": 4.296456632631879, "restore_env_runners": 1.5681110361257193e-05, "training_step": 4.296209708925972, "env_runner_sampling_timer": 3.879191775600629, "learner_update_timer": 0.41375704547078535, "synch_weights": 0.0014570983608670346, "restore_eval_env_runners": 1.3669340021988317e-05, "evaluation_iteration": 0.7757364998805645, "synch_eval_env_connectors": 0.0005746718699576717, "synch_env_connectors": 8.704029967566384e-06}, "env_runners": {"episode_duration_sec_mean": 0.038948699909994944, "env_to_module_connector": {"timers": {"connectors": {"add_time_dim_to_batch_and_zero_pad": 6.989495385765445e-06, "batch_individual_items": 2.0009371088554167e-05, "add_observations_from_episodes_to_batch": 7.06966759685114e-06, "add_states_from_episodes_to_batch": 3.790045695107885e-06, "numpy_to_tensor": 3.258769729719237e-05}}, "connector_pipeline_timer": 0.00012684161713372448}, "num_env_steps_sampled_lifetime": -475000.0, "num_agent_steps_sampled_lifetime": {"default_agent": -475000.0}, "env_to_module_sum_episodes_length_out": 27.16809333212661, "num_episodes": 100.0, "episode_len_mean": 50.0, "module_to_env_connector": {"timers": {"connectors": {"get_actions": 0.00017566983983354197, "listify_data_for_vector_env": 3.271475561798698e-05, "un_batch_to_individual_items": 1.568306505380707e-05, "tensor_to_numpy": 5.233878418696618e-05, "remove_single_ts_time_rank_from_batch": 1.5752030932347303e-06, "normalize_and_clip_actions": 2.4537156863941598e-05}}, "connector_pipeline_timer": 0.0003854417713678922}, "num_agent_steps_sampled": {"default_agent": 5000.0}, "num_module_steps_sampled_lifetime": {"default_policy": -475000.0}, "rlmodule_inference_timer": 0.00010701898004933036, "env_to_module_sum_episodes_length_in": 27.16809333212661, "episode_return_max": 14.5, "num_episodes_lifetime": -9500.0, "module_episode_returns_mean": {"default_policy": 3.100000000000002}, "episode_return_mean": 3.100000000000002, "episode_len_min": 50, "sample": 0.040149625707149195, "agent_episode_returns_mean": {"default_agent": 3.100000000000002}, "env_reset_timer": 0.00010821123106551736, "num_module_steps_sampled": {"default_policy": 5000.0}, "time_between_sampling": 0.011111742285282071, "env_step_timer": 4.6010898118944335e-05, "weights_seq_no": 3.0, "episode_return_min": -5.5, "episode_len_max": 50, "num_env_steps_sampled": 5000.0, "num_env_steps_sampled_lifetime_throughput": 1203.470713160618}, "learners": {"__all_modules__": {"learner_connector": {"timers": {"connectors": {"add_columns_from_episodes_to_train_batch": 0.07038724443350386, "numpy_to_tensor": 0.00016949516012888582, "add_states_from_episodes_to_batch": 6.207940319045292e-06, "batch_individual_items": 0.20264651932245503, "add_one_ts_to_episodes_and_truncate": 0.008541508611332967, "general_advantage_estimation": 0.015145986229223477, "add_time_dim_to_batch_and_zero_pad": 2.4232511185529346e-05, "add_observations_from_episodes_to_batch": 0.0007894743783235764}}, "connector_pipeline_timer": 0.2980313921484587}, "learner_connector_sum_episodes_length_in": 5000.0, "num_env_steps_trained": 30600, "num_module_steps_trained_lifetime": 24000, "learner_connector_sum_episodes_length_out": 5100.0, "num_module_steps_trained": 6000, "num_env_steps_trained_lifetime": 122400, "num_trainable_parameters": 6003, "num_non_trainable_parameters": 0, "num_env_steps_trained_lifetime_throughput": 946109.8964718478, "num_module_steps_trained_throughput": 186647.14195211316, "num_module_steps_trained_lifetime_throughput": 186586.71530269724}, "default_policy": {"module_train_batch_size_mean": 1000.0, "vf_explained_var": -0.004553437232971191, "mean_kl_loss": 2.070252230623737e-05, "num_trainable_parameters": 6003, "num_module_steps_trained_lifetime": 24000, "default_optimizer_learning_rate": 0.0002847858517, "policy_loss": 0.009094568900763988, "curr_entropy_coeff": 0.0090570820258, "vf_loss": 0.09473872184753418, "entropy": 0.6928433179855347, "vf_loss_unclipped": 11.894834518432617, "weights_seq_no": 4.0, "total_loss": 0.06618333607912064, "num_module_steps_trained": 6000, "curr_kl_coeff": 0.04665601998567581, "gradients_default_optimizer_global_norm": 0.07200981676578522, "diff_num_grad_updates_vs_sampler_policy": 1.0, "num_module_steps_trained_lifetime_throughput": 187029.59407391038}}, "num_training_step_calls_per_iteration": 1, "evaluation": {"env_runners": {"num_episodes": 20, "env_to_module_sum_episodes_length_in": 27.168093332126602, "episode_return_max": 17.5, "module_episode_returns_mean": {"default_policy": 0.6}, "sample": 0.7638507970398783, "env_to_module_connector": {"timers": {"connectors": {"add_time_dim_to_batch_and_zero_pad": 5.851923976540692e-06, "add_observations_from_episodes_to_batch": 6.13081694512835e-06, "numpy_to_tensor": 2.8831516565679238e-05, "add_states_from_episodes_to_batch": 3.990449513761528e-06, "batch_individual_items": 1.8831950805903418e-05}}, "connector_pipeline_timer": 0.00011429614577010305}, "env_step_timer": 4.2107093693011745e-05, "weights_seq_no": 4.0, "module_to_env_connector": {"timers": {"connectors": {"un_batch_to_individual_items": 1.5170489106336728e-05, "tensor_to_numpy": 4.5557251527377374e-05, "remove_single_ts_time_rank_from_batch": 1.4716724210489458e-06, "listify_data_for_vector_env": 3.027431335414362e-05, "get_actions": 0.00015577308215259443, "normalize_and_clip_actions": 2.2334119570324894e-05}}, "connector_pipeline_timer": 0.00034393007216993875}, "num_agent_steps_sampled": {"default_agent": 1000}, "env_to_module_sum_episodes_length_out": 27.168093332126602, "num_module_steps_sampled_lifetime": {"default_policy": 4000}, "rlmodule_inference_timer": 9.306338189010415e-05, "num_episodes_lifetime": 80, "episode_return_mean": 0.6, "num_module_steps_sampled": {"default_policy": 1000}, "env_reset_timer": 0.0002299940542283855, "num_env_steps_sampled": 1000, "episode_duration_sec_mean": 0.03573622503750897, "num_env_steps_sampled_lifetime": 21000, "num_agent_steps_sampled_lifetime": {"default_agent": 4000}, "episode_len_mean": 50.0, "episode_len_min": 50, "episode_return_min": -14.5, "episode_len_max": 50, "agent_episode_returns_mean": {"default_agent": 0.6}, "time_between_sampling": 4.366171728153183}, "num_healthy_workers": 1, "actor_manager_num_outstanding_async_reqs": 0, "num_remote_worker_restarts": 0}, "num_env_steps_sampled_lifetime": -475000.0, "fault_tolerance": {"num_healthy_workers": 0, "num_remote_worker_restarts": 0}, "env_runner_group": {"actor_manager_num_outstanding_async_reqs": 0}, "done": false, "training_iteration": 4, "trial_id": "98b6d_00000", "date": "2025-08-11_16-15-44", "timestamp": 1754921744, "time_this_iter_s": 5.2828755378723145, "time_total_s": 20.52799344062805, "pid": 16141, "hostname": "DESKTOP-3SK5A41", "node_ip": "192.168.40.242", "config": {"exploration_config": {}, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 6, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "env": "Umbrella", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": false, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 0, "create_local_env_runner": true, "num_envs_per_env_runner": 1, "gym_env_vectorize_mode": "SYNC", "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "episodes_to_numpy": true, "max_requests_in_flight_per_env_runner": 1, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "merge_env_runner_states": "training_only", "broadcast_env_runner_states": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "complete_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "sampler_perf_stats_ema_coef": null, "_is_online": true, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": "auto", "num_aggregator_actors_per_learner": 0, "max_requests_in_flight_per_aggregator_actor": 3, "local_gpu_idx": 0, "max_requests_in_flight_per_learner": 3, "gamma": 1, "lr": 0.0002847858517, "grad_clip": 0.5, "grad_clip_by": "global_norm", "_train_batch_size_per_learner": 5000, "train_batch_size": 4000, "num_epochs": 1, "minibatch_size": 1000, "shuffle_batch_per_epoch": true, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "log_std_clip_param": 20.0, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "_disable_preprocessor_api": false, "_disable_action_flattening": false}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "_learner_class": null, "callbacks_on_algorithm_init": null, "callbacks_on_env_runners_recreated": null, "callbacks_on_offline_eval_runners_recreated": null, "callbacks_on_checkpoint_loaded": null, "callbacks_on_environment_created": null, "callbacks_on_episode_created": null, "callbacks_on_episode_start": null, "callbacks_on_episode_step": null, "callbacks_on_episode_end": null, "callbacks_on_evaluate_start": null, "callbacks_on_evaluate_end": null, "callbacks_on_evaluate_offline_start": null, "callbacks_on_evaluate_offline_end": null, "callbacks_on_sample_end": null, "callbacks_on_train_result": null, "explore": true, "enable_rl_module_and_learner": true, "enable_env_runner_and_connector_v2": true, "_prior_exploration_config": {"type": "StochasticSampling"}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x79cd443c6ac0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "offline_data_class": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_read_batch_size": null, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "materialize_data": false, "materialize_mapped_data": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "ignore_final_observation": false, "prelearner_class": null, "prelearner_buffer_class": null, "prelearner_buffer_kwargs": {}, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_remaining_data": false, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": 1, "evaluation_duration": 20, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_auto_duration_min_env_steps_per_sample": 100, "evaluation_auto_duration_max_env_steps_per_sample": 2000, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 1, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "offline_evaluation_interval": null, "num_offline_eval_runners": 0, "offline_loss_for_module_fn": null, "offline_evaluation_duration": 1, "offline_evaluation_parallel_to_training": false, "offline_evaluation_timeout_s": 120.0, "num_cpus_per_offline_eval_runner": 1, "num_gpus_per_offline_eval_runner": 0, "custom_resources_per_offline_eval_runner": {}, "restart_failed_offline_eval_runners": true, "ignore_offline_eval_runner_failures": false, "max_num_offline_eval_runner_restarts": 1000, "offline_eval_runner_restore_timeout_s": 1800.0, "max_requests_in_flight_per_offline_eval_runner": 1, "validate_offline_eval_runners_after_construction": true, "offline_eval_runner_health_probe_timeout_s": 30.0, "offline_eval_rl_module_inference_only": false, "broadcast_offline_eval_runner_states": false, "offline_eval_batch_size_per_runner": 256, "dataset_num_iters_per_eval_runner": 1, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "log_gradients": true, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 42, "restart_failed_env_runners": true, "ignore_env_runner_failures": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30.0, "env_runner_restore_timeout_s": 1800.0, "_model_config": {}, "_rl_module_spec": "RLModuleSpec(module_class=None, observation_space=None, action_space=None, inference_only=False, learner_only=False, model_config=DefaultModelConfig(fcnet_hiddens=[60, 90], fcnet_activation='tanh', fcnet_kernel_initializer=None, fcnet_kernel_initializer_kwargs=None, fcnet_bias_initializer=None, fcnet_bias_initializer_kwargs=None, conv_filters=None, conv_activation='relu', conv_kernel_initializer=None, conv_kernel_initializer_kwargs=None, conv_bias_initializer=None, conv_bias_initializer_kwargs=None, head_fcnet_hiddens=[], head_fcnet_activation='relu', head_fcnet_kernel_initializer=None, head_fcnet_kernel_initializer_kwargs=None, head_fcnet_bias_initializer=None, head_fcnet_bias_initializer_kwargs=None, free_log_std=False, log_std_clip_param=20.0, vf_share_layers=True, use_lstm=False, max_seq_len=20, lstm_cell_size=256, lstm_use_prev_action=False, lstm_use_prev_reward=False, lstm_kernel_initializer=None, lstm_kernel_initializer_kwargs=None, lstm_bias_initializer=None, lstm_bias_initializer_kwargs=None), catalog_class=None, load_state_path=None, model_config_dict=None)", "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "_validate_config": true, "_use_msgpack_checkpoints": false, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "env_task_fn": -1, "enable_connectors": -1, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.7464963036515, "kl_target": 0.0270990929592, "vf_loss_coeff": 0.6688075857018, "entropy_coeff": 0.0090570820258, "clip_param": 0.1221781641624, "vf_clip_param": 0.1027808522125, "entropy_coeff_schedule": null, "lr_schedule": null, "sgd_minibatch_size": -1, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9099046732075, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.callbacks.callbacks.RLlibCallback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 20.52799344062805, "iterations_since_restore": 4, "perf": {"cpu_util_percent": 12.8, "ram_util_percent": 89.5}}
{"timers": {"training_iteration": 4.2970593390955605, "restore_env_runners": 1.5657299257422515e-05, "training_step": 4.296810511626713, "env_runner_sampling_timer": 3.882049182644622, "learner_update_timer": 0.4114963370060779, "synch_weights": 0.0014566213772577957, "restore_eval_env_runners": 1.3712646622450846e-05, "evaluation_iteration": 0.7755860148417588, "synch_eval_env_connectors": 0.0005737871512587799, "synch_env_connectors": 8.691989668269797e-06}, "env_runners": {"episode_duration_sec_mean": 0.0389011808100031, "env_to_module_connector": {"timers": {"connectors": {"add_time_dim_to_batch_and_zero_pad": 7.027851109190604e-06, "batch_individual_items": 2.0013901856014804e-05, "add_observations_from_episodes_to_batch": 6.978493023685174e-06, "add_states_from_episodes_to_batch": 3.772999315910921e-06, "numpy_to_tensor": 3.28705464340638e-05}}, "connector_pipeline_timer": 0.00012675852511028588}, "num_env_steps_sampled_lifetime": -717500.0, "num_agent_steps_sampled_lifetime": {"default_agent": -717500.0}, "env_to_module_sum_episodes_length_out": 27.16809333212661, "num_episodes": 100.0, "episode_len_mean": 50.0, "module_to_env_connector": {"timers": {"connectors": {"get_actions": 0.0001777263956807368, "listify_data_for_vector_env": 3.283205985356969e-05, "un_batch_to_individual_items": 1.5661882565426003e-05, "tensor_to_numpy": 5.17224094387443e-05, "remove_single_ts_time_rank_from_batch": 1.605383537003954e-06, "normalize_and_clip_actions": 2.4728241110713204e-05}}, "connector_pipeline_timer": 0.00038647183486419486}, "num_agent_steps_sampled": {"default_agent": 5000.0}, "num_module_steps_sampled_lifetime": {"default_policy": -717500.0}, "rlmodule_inference_timer": 0.00010593924221863869, "env_to_module_sum_episodes_length_in": 27.16809333212661, "episode_return_max": 14.5, "num_episodes_lifetime": -14350.0, "module_episode_returns_mean": {"default_policy": 2.6999999999999993}, "episode_return_mean": 2.6999999999999993, "episode_len_min": 50, "sample": 0.040242682643264374, "agent_episode_returns_mean": {"default_agent": 2.6999999999999993}, "env_reset_timer": 0.00010549040820527162, "num_module_steps_sampled": {"default_policy": 5000.0}, "time_between_sampling": 0.012399886003522553, "env_step_timer": 4.62492713802926e-05, "weights_seq_no": 4.0, "episode_return_min": -5.5, "episode_len_max": 50, "num_env_steps_sampled": 5000.0, "num_env_steps_sampled_lifetime_throughput": 1207.561577310429}, "learners": {"__all_modules__": {"learner_connector": {"timers": {"connectors": {"add_columns_from_episodes_to_train_batch": 0.07037146997916834, "numpy_to_tensor": 0.000169491208527534, "add_states_from_episodes_to_batch": 6.201860915940826e-06, "batch_individual_items": 0.20120917512922978, "add_one_ts_to_episodes_and_truncate": 0.008538013525219719, "general_advantage_estimation": 0.015120166366931217, "add_time_dim_to_batch_and_zero_pad": 2.4214186072881135e-05, "add_observations_from_episodes_to_batch": 0.0007887886345395338}}, "connector_pipeline_timer": 0.2965480462169744}, "learner_connector_sum_episodes_length_in": 5000.0, "num_env_steps_trained": 30600, "num_module_steps_trained_lifetime": 30000, "learner_connector_sum_episodes_length_out": 5100.0, "num_module_steps_trained": 6000, "num_env_steps_trained_lifetime": 153000, "num_trainable_parameters": 6003, "num_non_trainable_parameters": 0, "num_env_steps_trained_lifetime_throughput": 938272.0956638751, "num_module_steps_trained_throughput": 185073.47638929135, "num_module_steps_trained_lifetime_throughput": 185013.14981441322}, "default_policy": {"module_train_batch_size_mean": 1000.0, "vf_explained_var": -0.006736636161804199, "mean_kl_loss": 0.00013515273167286068, "num_trainable_parameters": 6003, "num_module_steps_trained_lifetime": 30000, "default_optimizer_learning_rate": 0.0002847858517, "policy_loss": -0.288912296295166, "curr_entropy_coeff": 0.0090570820258, "vf_loss": 0.09704843908548355, "entropy": 0.6927445530891418, "vf_loss_unclipped": 12.807801246643066, "weights_seq_no": 5.0, "total_loss": -0.2302735298871994, "num_module_steps_trained": 6000, "curr_kl_coeff": 0.023328009992837906, "gradients_default_optimizer_global_norm": 0.06606277823448181, "diff_num_grad_updates_vs_sampler_policy": 1.0, "num_module_steps_trained_lifetime_throughput": 185433.7442606089}}, "num_training_step_calls_per_iteration": 1, "evaluation": {"env_runners": {"num_episodes": 20, "env_to_module_sum_episodes_length_in": 27.168093332126602, "episode_return_max": 17.5, "module_episode_returns_mean": {"default_policy": 0.7}, "sample": 0.7639027780094794, "env_to_module_connector": {"timers": {"connectors": {"add_time_dim_to_batch_and_zero_pad": 5.922267118304603e-06, "add_observations_from_episodes_to_batch": 6.679889663462402e-06, "numpy_to_tensor": 3.1775198610074716e-05, "add_states_from_episodes_to_batch": 3.655360324609536e-06, "batch_individual_items": 2.022273932892151e-05}}, "connector_pipeline_timer": 0.0001202136511765193}, "env_step_timer": 4.687435669174832e-05, "weights_seq_no": 5.0, "module_to_env_connector": {"timers": {"connectors": {"un_batch_to_individual_items": 1.6865124216178534e-05, "tensor_to_numpy": 4.812904400444215e-05, "remove_single_ts_time_rank_from_batch": 1.5950867143053633e-06, "listify_data_for_vector_env": 3.297279411674377e-05, "get_actions": 0.0001729805663792165, "normalize_and_clip_actions": 2.34567243470642e-05}}, "connector_pipeline_timer": 0.0003740600291563922}, "num_agent_steps_sampled": {"default_agent": 1000}, "env_to_module_sum_episodes_length_out": 27.168093332126602, "num_module_steps_sampled_lifetime": {"default_policy": 5000}, "rlmodule_inference_timer": 0.00010467966212375535, "num_episodes_lifetime": 100, "episode_return_mean": 0.7, "num_module_steps_sampled": {"default_policy": 1000}, "env_reset_timer": 0.00022902711368626044, "num_env_steps_sampled": 1000, "episode_duration_sec_mean": 0.03597531797000556, "num_env_steps_sampled_lifetime": 26000, "num_agent_steps_sampled_lifetime": {"default_agent": 5000}, "episode_len_mean": 50.0, "episode_len_min": 50, "episode_return_min": -14.5, "episode_len_max": 50, "agent_episode_returns_mean": {"default_agent": 0.7}, "time_between_sampling": 4.3666514636616505}, "num_healthy_workers": 1, "actor_manager_num_outstanding_async_reqs": 0, "num_remote_worker_restarts": 0}, "num_env_steps_sampled_lifetime": -717500.0, "fault_tolerance": {"num_healthy_workers": 0, "num_remote_worker_restarts": 0}, "env_runner_group": {"actor_manager_num_outstanding_async_reqs": 0}, "done": false, "training_iteration": 5, "trial_id": "98b6d_00000", "date": "2025-08-11_16-15-49", "timestamp": 1754921749, "time_this_iter_s": 5.14138126373291, "time_total_s": 25.669374704360962, "pid": 16141, "hostname": "DESKTOP-3SK5A41", "node_ip": "192.168.40.242", "config": {"exploration_config": {}, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 6, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "env": "Umbrella", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": false, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 0, "create_local_env_runner": true, "num_envs_per_env_runner": 1, "gym_env_vectorize_mode": "SYNC", "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "episodes_to_numpy": true, "max_requests_in_flight_per_env_runner": 1, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "merge_env_runner_states": "training_only", "broadcast_env_runner_states": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "complete_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "sampler_perf_stats_ema_coef": null, "_is_online": true, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": "auto", "num_aggregator_actors_per_learner": 0, "max_requests_in_flight_per_aggregator_actor": 3, "local_gpu_idx": 0, "max_requests_in_flight_per_learner": 3, "gamma": 1, "lr": 0.0002847858517, "grad_clip": 0.5, "grad_clip_by": "global_norm", "_train_batch_size_per_learner": 5000, "train_batch_size": 4000, "num_epochs": 1, "minibatch_size": 1000, "shuffle_batch_per_epoch": true, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "log_std_clip_param": 20.0, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "_disable_preprocessor_api": false, "_disable_action_flattening": false}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "_learner_class": null, "callbacks_on_algorithm_init": null, "callbacks_on_env_runners_recreated": null, "callbacks_on_offline_eval_runners_recreated": null, "callbacks_on_checkpoint_loaded": null, "callbacks_on_environment_created": null, "callbacks_on_episode_created": null, "callbacks_on_episode_start": null, "callbacks_on_episode_step": null, "callbacks_on_episode_end": null, "callbacks_on_evaluate_start": null, "callbacks_on_evaluate_end": null, "callbacks_on_evaluate_offline_start": null, "callbacks_on_evaluate_offline_end": null, "callbacks_on_sample_end": null, "callbacks_on_train_result": null, "explore": true, "enable_rl_module_and_learner": true, "enable_env_runner_and_connector_v2": true, "_prior_exploration_config": {"type": "StochasticSampling"}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x79cd443c6ac0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "offline_data_class": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_read_batch_size": null, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "materialize_data": false, "materialize_mapped_data": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "ignore_final_observation": false, "prelearner_class": null, "prelearner_buffer_class": null, "prelearner_buffer_kwargs": {}, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_remaining_data": false, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": 1, "evaluation_duration": 20, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_auto_duration_min_env_steps_per_sample": 100, "evaluation_auto_duration_max_env_steps_per_sample": 2000, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 1, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "offline_evaluation_interval": null, "num_offline_eval_runners": 0, "offline_loss_for_module_fn": null, "offline_evaluation_duration": 1, "offline_evaluation_parallel_to_training": false, "offline_evaluation_timeout_s": 120.0, "num_cpus_per_offline_eval_runner": 1, "num_gpus_per_offline_eval_runner": 0, "custom_resources_per_offline_eval_runner": {}, "restart_failed_offline_eval_runners": true, "ignore_offline_eval_runner_failures": false, "max_num_offline_eval_runner_restarts": 1000, "offline_eval_runner_restore_timeout_s": 1800.0, "max_requests_in_flight_per_offline_eval_runner": 1, "validate_offline_eval_runners_after_construction": true, "offline_eval_runner_health_probe_timeout_s": 30.0, "offline_eval_rl_module_inference_only": false, "broadcast_offline_eval_runner_states": false, "offline_eval_batch_size_per_runner": 256, "dataset_num_iters_per_eval_runner": 1, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "log_gradients": true, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 42, "restart_failed_env_runners": true, "ignore_env_runner_failures": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30.0, "env_runner_restore_timeout_s": 1800.0, "_model_config": {}, "_rl_module_spec": "RLModuleSpec(module_class=None, observation_space=None, action_space=None, inference_only=False, learner_only=False, model_config=DefaultModelConfig(fcnet_hiddens=[60, 90], fcnet_activation='tanh', fcnet_kernel_initializer=None, fcnet_kernel_initializer_kwargs=None, fcnet_bias_initializer=None, fcnet_bias_initializer_kwargs=None, conv_filters=None, conv_activation='relu', conv_kernel_initializer=None, conv_kernel_initializer_kwargs=None, conv_bias_initializer=None, conv_bias_initializer_kwargs=None, head_fcnet_hiddens=[], head_fcnet_activation='relu', head_fcnet_kernel_initializer=None, head_fcnet_kernel_initializer_kwargs=None, head_fcnet_bias_initializer=None, head_fcnet_bias_initializer_kwargs=None, free_log_std=False, log_std_clip_param=20.0, vf_share_layers=True, use_lstm=False, max_seq_len=20, lstm_cell_size=256, lstm_use_prev_action=False, lstm_use_prev_reward=False, lstm_kernel_initializer=None, lstm_kernel_initializer_kwargs=None, lstm_bias_initializer=None, lstm_bias_initializer_kwargs=None), catalog_class=None, load_state_path=None, model_config_dict=None)", "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "_validate_config": true, "_use_msgpack_checkpoints": false, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "env_task_fn": -1, "enable_connectors": -1, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.7464963036515, "kl_target": 0.0270990929592, "vf_loss_coeff": 0.6688075857018, "entropy_coeff": 0.0090570820258, "clip_param": 0.1221781641624, "vf_clip_param": 0.1027808522125, "entropy_coeff_schedule": null, "lr_schedule": null, "sgd_minibatch_size": -1, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9099046732075, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.callbacks.callbacks.RLlibCallback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 25.669374704360962, "iterations_since_restore": 5, "perf": {"cpu_util_percent": 12.2, "ram_util_percent": 89.47142857142856}}
{"timers": {"training_iteration": 4.305899996184605, "restore_env_runners": 1.5633726264626185e-05, "training_step": 4.305648896990447, "env_runner_sampling_timer": 3.890196891348176, "learner_update_timer": 0.41215993158601694, "synch_weights": 0.0014742621634856437, "restore_eval_env_runners": 1.3681520156186086e-05, "evaluation_iteration": 0.7756252686233414, "synch_eval_env_connectors": 0.0005726822797471141, "synch_env_connectors": 8.686069771041534e-06}, "env_runners": {"episode_duration_sec_mean": 0.0437176045600006, "env_to_module_connector": {"timers": {"connectors": {"add_time_dim_to_batch_and_zero_pad": 7.94708217153122e-06, "batch_individual_items": 2.1680570655835326e-05, "add_observations_from_episodes_to_batch": 7.591817635534068e-06, "add_states_from_episodes_to_batch": 4.2110671643042645e-06, "numpy_to_tensor": 3.6195663076512725e-05}}, "connector_pipeline_timer": 0.00013897696449882512}, "num_env_steps_sampled_lifetime": -960000.0, "num_agent_steps_sampled_lifetime": {"default_agent": -960000.0}, "env_to_module_sum_episodes_length_out": 27.16809333212661, "num_episodes": 100.0, "episode_len_mean": 50.0, "module_to_env_connector": {"timers": {"connectors": {"get_actions": 0.0001975929246964747, "listify_data_for_vector_env": 3.8077741616319247e-05, "un_batch_to_individual_items": 1.6840198649461265e-05, "tensor_to_numpy": 5.709037112341425e-05, "remove_single_ts_time_rank_from_batch": 1.7132610747280731e-06, "normalize_and_clip_actions": 2.6921878418814763e-05}}, "connector_pipeline_timer": 0.0004279583505317462}, "num_agent_steps_sampled": {"default_agent": 5000.0}, "num_module_steps_sampled_lifetime": {"default_policy": -960000.0}, "rlmodule_inference_timer": 0.00012123167149608986, "env_to_module_sum_episodes_length_in": 27.16809333212661, "episode_return_max": 14.5, "num_episodes_lifetime": -19200.0, "module_episode_returns_mean": {"default_policy": 5.299999999999998}, "episode_return_mean": 5.299999999999998, "episode_len_min": 50, "sample": 0.040473104667010124, "agent_episode_returns_mean": {"default_agent": 5.299999999999998}, "env_reset_timer": 0.00010648260014193796, "num_module_steps_sampled": {"default_policy": 5000.0}, "time_between_sampling": 0.012029196015247543, "env_step_timer": 5.219021823204585e-05, "weights_seq_no": 5.0, "episode_return_min": -5.5, "episode_len_max": 50, "num_env_steps_sampled": 5000.0, "num_env_steps_sampled_lifetime_throughput": 1171.759518538135}, "learners": {"__all_modules__": {"learner_connector": {"timers": {"connectors": {"add_columns_from_episodes_to_train_batch": 0.07050328626937694, "numpy_to_tensor": 0.00016968429644272152, "add_states_from_episodes_to_batch": 6.1938423075545755e-06, "batch_individual_items": 0.20177149134793707, "add_one_ts_to_episodes_and_truncate": 0.008597558389967125, "general_advantage_estimation": 0.015204930703262095, "add_time_dim_to_batch_and_zero_pad": 2.420404421202133e-05, "add_observations_from_episodes_to_batch": 0.000795410748193884}}, "connector_pipeline_timer": 0.2973940287148046}, "learner_connector_sum_episodes_length_in": 5000.0, "num_env_steps_trained": 30600, "num_module_steps_trained_lifetime": 36000, "learner_connector_sum_episodes_length_out": 5100.0, "num_module_steps_trained": 6000, "num_env_steps_trained_lifetime": 183600, "num_trainable_parameters": 6003, "num_non_trainable_parameters": 0, "num_env_steps_trained_lifetime_throughput": 925627.434936993, "num_module_steps_trained_throughput": 182553.96402050112, "num_module_steps_trained_lifetime_throughput": 182495.02725376657}, "default_policy": {"module_train_batch_size_mean": 1000.0, "vf_explained_var": -0.007393836975097656, "mean_kl_loss": 4.489378261496313e-05, "num_trainable_parameters": 6003, "num_module_steps_trained_lifetime": 36000, "default_optimizer_learning_rate": 0.0002847858517, "policy_loss": -0.2436695247888565, "curr_entropy_coeff": 0.0090570820258, "vf_loss": 0.09744419902563095, "entropy": 0.6924142837524414, "vf_loss_unclipped": 13.096856117248535, "weights_seq_no": 6.0, "total_loss": -0.18476830422878265, "num_module_steps_trained": 6000, "curr_kl_coeff": 0.011664004996418953, "gradients_default_optimizer_global_norm": 0.021453548222780228, "diff_num_grad_updates_vs_sampler_policy": 1.0, "num_module_steps_trained_lifetime_throughput": 182893.73735230003}}, "num_training_step_calls_per_iteration": 1, "evaluation": {"env_runners": {"num_episodes": 20, "env_to_module_sum_episodes_length_in": 27.168093332126602, "episode_return_max": 17.5, "module_episode_returns_mean": {"default_policy": 1.5}, "sample": 0.764779379149384, "env_to_module_connector": {"timers": {"connectors": {"add_time_dim_to_batch_and_zero_pad": 6.790399149189578e-06, "add_observations_from_episodes_to_batch": 7.660323296900816e-06, "numpy_to_tensor": 3.541503581596227e-05, "add_states_from_episodes_to_batch": 4.549586008091794e-06, "batch_individual_items": 2.2605935492163102e-05}}, "connector_pipeline_timer": 0.00013670641311862528}, "env_step_timer": 5.419145322848592e-05, "weights_seq_no": 6.0, "module_to_env_connector": {"timers": {"connectors": {"un_batch_to_individual_items": 1.8997399300531294e-05, "tensor_to_numpy": 5.524961672945334e-05, "remove_single_ts_time_rank_from_batch": 2.368987974178474e-06, "listify_data_for_vector_env": 3.993526909670454e-05, "get_actions": 0.0001898631817905375, "normalize_and_clip_actions": 2.6808341283338925e-05}}, "connector_pipeline_timer": 0.00042098702377952593}, "num_agent_steps_sampled": {"default_agent": 1000}, "env_to_module_sum_episodes_length_out": 27.168093332126602, "num_module_steps_sampled_lifetime": {"default_policy": 6000}, "rlmodule_inference_timer": 0.00011554781571287123, "num_episodes_lifetime": 120, "episode_return_mean": 1.5, "num_module_steps_sampled": {"default_policy": 1000}, "env_reset_timer": 0.0002282758425492639, "num_env_steps_sampled": 1000, "episode_duration_sec_mean": 0.036814297830003395, "num_env_steps_sampled_lifetime": 31000, "num_agent_steps_sampled_lifetime": {"default_agent": 6000}, "episode_len_mean": 50.0, "episode_len_min": 50, "episode_return_min": -14.5, "episode_len_max": 50, "agent_episode_returns_mean": {"default_agent": 1.5}, "time_between_sampling": 4.375415149495034}, "num_healthy_workers": 1, "actor_manager_num_outstanding_async_reqs": 0, "num_remote_worker_restarts": 0}, "num_env_steps_sampled_lifetime": -960000.0, "fault_tolerance": {"num_healthy_workers": 0, "num_remote_worker_restarts": 0}, "env_runner_group": {"actor_manager_num_outstanding_async_reqs": 0}, "done": false, "training_iteration": 6, "trial_id": "98b6d_00000", "date": "2025-08-11_16-15-55", "timestamp": 1754921755, "time_this_iter_s": 6.050207614898682, "time_total_s": 31.719582319259644, "pid": 16141, "hostname": "DESKTOP-3SK5A41", "node_ip": "192.168.40.242", "config": {"exploration_config": {}, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 6, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "env": "Umbrella", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": false, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 0, "create_local_env_runner": true, "num_envs_per_env_runner": 1, "gym_env_vectorize_mode": "SYNC", "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "episodes_to_numpy": true, "max_requests_in_flight_per_env_runner": 1, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "merge_env_runner_states": "training_only", "broadcast_env_runner_states": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "complete_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "sampler_perf_stats_ema_coef": null, "_is_online": true, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": "auto", "num_aggregator_actors_per_learner": 0, "max_requests_in_flight_per_aggregator_actor": 3, "local_gpu_idx": 0, "max_requests_in_flight_per_learner": 3, "gamma": 1, "lr": 0.0002847858517, "grad_clip": 0.5, "grad_clip_by": "global_norm", "_train_batch_size_per_learner": 5000, "train_batch_size": 4000, "num_epochs": 1, "minibatch_size": 1000, "shuffle_batch_per_epoch": true, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "log_std_clip_param": 20.0, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "_disable_preprocessor_api": false, "_disable_action_flattening": false}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "_learner_class": null, "callbacks_on_algorithm_init": null, "callbacks_on_env_runners_recreated": null, "callbacks_on_offline_eval_runners_recreated": null, "callbacks_on_checkpoint_loaded": null, "callbacks_on_environment_created": null, "callbacks_on_episode_created": null, "callbacks_on_episode_start": null, "callbacks_on_episode_step": null, "callbacks_on_episode_end": null, "callbacks_on_evaluate_start": null, "callbacks_on_evaluate_end": null, "callbacks_on_evaluate_offline_start": null, "callbacks_on_evaluate_offline_end": null, "callbacks_on_sample_end": null, "callbacks_on_train_result": null, "explore": true, "enable_rl_module_and_learner": true, "enable_env_runner_and_connector_v2": true, "_prior_exploration_config": {"type": "StochasticSampling"}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x79cd443c6ac0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "offline_data_class": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_read_batch_size": null, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "materialize_data": false, "materialize_mapped_data": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "ignore_final_observation": false, "prelearner_class": null, "prelearner_buffer_class": null, "prelearner_buffer_kwargs": {}, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_remaining_data": false, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": 1, "evaluation_duration": 20, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_auto_duration_min_env_steps_per_sample": 100, "evaluation_auto_duration_max_env_steps_per_sample": 2000, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 1, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "offline_evaluation_interval": null, "num_offline_eval_runners": 0, "offline_loss_for_module_fn": null, "offline_evaluation_duration": 1, "offline_evaluation_parallel_to_training": false, "offline_evaluation_timeout_s": 120.0, "num_cpus_per_offline_eval_runner": 1, "num_gpus_per_offline_eval_runner": 0, "custom_resources_per_offline_eval_runner": {}, "restart_failed_offline_eval_runners": true, "ignore_offline_eval_runner_failures": false, "max_num_offline_eval_runner_restarts": 1000, "offline_eval_runner_restore_timeout_s": 1800.0, "max_requests_in_flight_per_offline_eval_runner": 1, "validate_offline_eval_runners_after_construction": true, "offline_eval_runner_health_probe_timeout_s": 30.0, "offline_eval_rl_module_inference_only": false, "broadcast_offline_eval_runner_states": false, "offline_eval_batch_size_per_runner": 256, "dataset_num_iters_per_eval_runner": 1, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "log_gradients": true, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 42, "restart_failed_env_runners": true, "ignore_env_runner_failures": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30.0, "env_runner_restore_timeout_s": 1800.0, "_model_config": {}, "_rl_module_spec": "RLModuleSpec(module_class=None, observation_space=None, action_space=None, inference_only=False, learner_only=False, model_config=DefaultModelConfig(fcnet_hiddens=[60, 90], fcnet_activation='tanh', fcnet_kernel_initializer=None, fcnet_kernel_initializer_kwargs=None, fcnet_bias_initializer=None, fcnet_bias_initializer_kwargs=None, conv_filters=None, conv_activation='relu', conv_kernel_initializer=None, conv_kernel_initializer_kwargs=None, conv_bias_initializer=None, conv_bias_initializer_kwargs=None, head_fcnet_hiddens=[], head_fcnet_activation='relu', head_fcnet_kernel_initializer=None, head_fcnet_kernel_initializer_kwargs=None, head_fcnet_bias_initializer=None, head_fcnet_bias_initializer_kwargs=None, free_log_std=False, log_std_clip_param=20.0, vf_share_layers=True, use_lstm=False, max_seq_len=20, lstm_cell_size=256, lstm_use_prev_action=False, lstm_use_prev_reward=False, lstm_kernel_initializer=None, lstm_kernel_initializer_kwargs=None, lstm_bias_initializer=None, lstm_bias_initializer_kwargs=None), catalog_class=None, load_state_path=None, model_config_dict=None)", "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "_validate_config": true, "_use_msgpack_checkpoints": false, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "env_task_fn": -1, "enable_connectors": -1, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.7464963036515, "kl_target": 0.0270990929592, "vf_loss_coeff": 0.6688075857018, "entropy_coeff": 0.0090570820258, "clip_param": 0.1221781641624, "vf_clip_param": 0.1027808522125, "entropy_coeff_schedule": null, "lr_schedule": null, "sgd_minibatch_size": -1, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9099046732075, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.callbacks.callbacks.RLlibCallback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 31.719582319259644, "iterations_since_restore": 6, "perf": {"cpu_util_percent": 13.144444444444444, "ram_util_percent": 89.5}}
{"timers": {"training_iteration": 4.30785381397276, "restore_env_runners": 1.5597389002813817e-05, "training_step": 4.307600541770542, "env_runner_sampling_timer": 3.894264902194694, "learner_update_timer": 0.41000606726015637, "synch_weights": 0.0014963205418507557, "restore_eval_env_runners": 1.3678704954058534e-05, "evaluation_iteration": 0.7765086598471077, "synch_eval_env_connectors": 0.0005733024569505576, "synch_env_connectors": 8.676209073023025e-06}, "env_runners": {"episode_duration_sec_mean": 0.04004950076999875, "env_to_module_connector": {"timers": {"connectors": {"add_time_dim_to_batch_and_zero_pad": 7.244632092845707e-06, "batch_individual_items": 2.0465028056561433e-05, "add_observations_from_episodes_to_batch": 7.25429774180616e-06, "add_states_from_episodes_to_batch": 3.925971095507966e-06, "numpy_to_tensor": 3.383279183629199e-05}}, "connector_pipeline_timer": 0.00013014749861475287}, "num_env_steps_sampled_lifetime": -1202500.0, "num_agent_steps_sampled_lifetime": {"default_agent": -1202500.0}, "env_to_module_sum_episodes_length_out": 27.16809333212661, "num_episodes": 100.0, "episode_len_mean": 50.0, "module_to_env_connector": {"timers": {"connectors": {"get_actions": 0.00018541549190479516, "listify_data_for_vector_env": 3.429445550847737e-05, "un_batch_to_individual_items": 1.5923970630757457e-05, "tensor_to_numpy": 5.371023527211055e-05, "remove_single_ts_time_rank_from_batch": 1.5996078912932958e-06, "normalize_and_clip_actions": 2.5333980709339177e-05}}, "connector_pipeline_timer": 0.00040077700562833336}, "num_agent_steps_sampled": {"default_agent": 5000.0}, "num_module_steps_sampled_lifetime": {"default_policy": -1202500.0}, "rlmodule_inference_timer": 0.00011130997334086671, "env_to_module_sum_episodes_length_in": 27.16809333212661, "episode_return_max": 14.5, "num_episodes_lifetime": -24050.0, "module_episode_returns_mean": {"default_policy": 5.299999999999998}, "episode_return_mean": 5.299999999999998, "episode_len_min": 50, "sample": 0.04335234537421109, "agent_episode_returns_mean": {"default_agent": 5.299999999999998}, "env_reset_timer": 0.00011380946957411032, "num_module_steps_sampled": {"default_policy": 5000.0}, "time_between_sampling": 0.014487104315683143, "env_step_timer": 4.80174706432537e-05, "weights_seq_no": 6.0, "episode_return_min": -5.5, "episode_len_max": 50, "num_env_steps_sampled": 5000.0, "num_env_steps_sampled_lifetime_throughput": 1125.3165916887963}, "learners": {"__all_modules__": {"learner_connector": {"timers": {"connectors": {"add_columns_from_episodes_to_train_batch": 0.07050456240668286, "numpy_to_tensor": 0.0001703314534789701, "add_states_from_episodes_to_batch": 6.188903884221432e-06, "batch_individual_items": 0.200378471424458, "add_one_ts_to_episodes_and_truncate": 0.008599947806067747, "general_advantage_estimation": 0.015167822396229973, "add_time_dim_to_batch_and_zero_pad": 2.4168003770745258e-05, "add_observations_from_episodes_to_batch": 0.0007950136407109418}}, "connector_pipeline_timer": 0.29596810241765664}, "learner_connector_sum_episodes_length_in": 5000.0, "num_env_steps_trained": 30600, "num_module_steps_trained_lifetime": 42000, "learner_connector_sum_episodes_length_out": 5100.0, "num_module_steps_trained": 6000, "num_env_steps_trained_lifetime": 214200, "num_trainable_parameters": 6003, "num_non_trainable_parameters": 0, "num_env_steps_trained_lifetime_throughput": 913919.8975623262, "num_module_steps_trained_throughput": 180219.304935392, "num_module_steps_trained_lifetime_throughput": 180161.03286967822}, "default_policy": {"module_train_batch_size_mean": 1000.0, "vf_explained_var": 0.01399141550064087, "mean_kl_loss": 7.028684649412753e-06, "num_trainable_parameters": 6003, "num_module_steps_trained_lifetime": 42000, "default_optimizer_learning_rate": 0.0002847858517, "policy_loss": -0.04830775409936905, "curr_entropy_coeff": 0.0090570820258, "vf_loss": 0.0959678441286087, "entropy": 0.6924654245376587, "vf_loss_unclipped": 12.33202075958252, "weights_seq_no": 7.0, "total_loss": 0.009604638442397118, "num_module_steps_trained": 6000, "curr_kl_coeff": 0.0058320024982094765, "gradients_default_optimizer_global_norm": 0.012658804655075073, "diff_num_grad_updates_vs_sampler_policy": 1.0, "num_module_steps_trained_lifetime_throughput": 180536.62744056177}}, "num_training_step_calls_per_iteration": 1, "evaluation": {"env_runners": {"num_episodes": 20, "env_to_module_sum_episodes_length_in": 27.168093332126602, "episode_return_max": 17.5, "module_episode_returns_mean": {"default_policy": 2.5}, "sample": 0.7646466953278899, "env_to_module_connector": {"timers": {"connectors": {"add_time_dim_to_batch_and_zero_pad": 5.736890546329371e-06, "add_observations_from_episodes_to_batch": 6.187649757322474e-06, "numpy_to_tensor": 2.87378861089625e-05, "add_states_from_episodes_to_batch": 3.4391251515324306e-06, "batch_individual_items": 1.8001290275710694e-05}}, "connector_pipeline_timer": 0.00011103849570186628}, "env_step_timer": 4.2279851323477174e-05, "weights_seq_no": 7.0, "module_to_env_connector": {"timers": {"connectors": {"un_batch_to_individual_items": 1.5369332458663763e-05, "tensor_to_numpy": 4.529333557099749e-05, "remove_single_ts_time_rank_from_batch": 1.4131647054753302e-06, "listify_data_for_vector_env": 3.0320574004673628e-05, "get_actions": 0.00015595598169030464, "normalize_and_clip_actions": 2.1849382813244046e-05}}, "connector_pipeline_timer": 0.0003423527144797252}, "num_agent_steps_sampled": {"default_agent": 1000}, "env_to_module_sum_episodes_length_out": 27.168093332126602, "num_module_steps_sampled_lifetime": {"default_policy": 7000}, "rlmodule_inference_timer": 9.328678274437389e-05, "num_episodes_lifetime": 140, "episode_return_mean": 2.5, "num_module_steps_sampled": {"default_policy": 1000}, "env_reset_timer": 0.00022767508412338997, "num_env_steps_sampled": 1000, "episode_duration_sec_mean": 0.03693640979000179, "num_env_steps_sampled_lifetime": 36000, "num_agent_steps_sampled_lifetime": {"default_agent": 7000}, "episode_len_mean": 50.0, "episode_len_min": 50, "episode_return_min": -16.5, "episode_len_max": 50, "agent_episode_returns_mean": {"default_agent": 2.5}, "time_between_sampling": 4.377264005740083}, "num_healthy_workers": 1, "actor_manager_num_outstanding_async_reqs": 0, "num_remote_worker_restarts": 0}, "num_env_steps_sampled_lifetime": -1202500.0, "fault_tolerance": {"num_healthy_workers": 0, "num_remote_worker_restarts": 0}, "env_runner_group": {"actor_manager_num_outstanding_async_reqs": 0}, "done": true, "training_iteration": 7, "trial_id": "98b6d_00000", "date": "2025-08-11_16-16-00", "timestamp": 1754921760, "time_this_iter_s": 5.268434047698975, "time_total_s": 36.98801636695862, "pid": 16141, "hostname": "DESKTOP-3SK5A41", "node_ip": "192.168.40.242", "config": {"exploration_config": {}, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 6, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "env": "Umbrella", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": false, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 0, "create_local_env_runner": true, "num_envs_per_env_runner": 1, "gym_env_vectorize_mode": "SYNC", "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "episodes_to_numpy": true, "max_requests_in_flight_per_env_runner": 1, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "merge_env_runner_states": "training_only", "broadcast_env_runner_states": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "complete_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "sampler_perf_stats_ema_coef": null, "_is_online": true, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": "auto", "num_aggregator_actors_per_learner": 0, "max_requests_in_flight_per_aggregator_actor": 3, "local_gpu_idx": 0, "max_requests_in_flight_per_learner": 3, "gamma": 1, "lr": 0.0002847858517, "grad_clip": 0.5, "grad_clip_by": "global_norm", "_train_batch_size_per_learner": 5000, "train_batch_size": 4000, "num_epochs": 1, "minibatch_size": 1000, "shuffle_batch_per_epoch": true, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "log_std_clip_param": 20.0, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "_disable_preprocessor_api": false, "_disable_action_flattening": false}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "_learner_class": null, "callbacks_on_algorithm_init": null, "callbacks_on_env_runners_recreated": null, "callbacks_on_offline_eval_runners_recreated": null, "callbacks_on_checkpoint_loaded": null, "callbacks_on_environment_created": null, "callbacks_on_episode_created": null, "callbacks_on_episode_start": null, "callbacks_on_episode_step": null, "callbacks_on_episode_end": null, "callbacks_on_evaluate_start": null, "callbacks_on_evaluate_end": null, "callbacks_on_evaluate_offline_start": null, "callbacks_on_evaluate_offline_end": null, "callbacks_on_sample_end": null, "callbacks_on_train_result": null, "explore": true, "enable_rl_module_and_learner": true, "enable_env_runner_and_connector_v2": true, "_prior_exploration_config": {"type": "StochasticSampling"}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x79cd443c6ac0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "offline_data_class": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_read_batch_size": null, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "materialize_data": false, "materialize_mapped_data": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "ignore_final_observation": false, "prelearner_class": null, "prelearner_buffer_class": null, "prelearner_buffer_kwargs": {}, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_remaining_data": false, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": 1, "evaluation_duration": 20, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_auto_duration_min_env_steps_per_sample": 100, "evaluation_auto_duration_max_env_steps_per_sample": 2000, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 1, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "offline_evaluation_interval": null, "num_offline_eval_runners": 0, "offline_loss_for_module_fn": null, "offline_evaluation_duration": 1, "offline_evaluation_parallel_to_training": false, "offline_evaluation_timeout_s": 120.0, "num_cpus_per_offline_eval_runner": 1, "num_gpus_per_offline_eval_runner": 0, "custom_resources_per_offline_eval_runner": {}, "restart_failed_offline_eval_runners": true, "ignore_offline_eval_runner_failures": false, "max_num_offline_eval_runner_restarts": 1000, "offline_eval_runner_restore_timeout_s": 1800.0, "max_requests_in_flight_per_offline_eval_runner": 1, "validate_offline_eval_runners_after_construction": true, "offline_eval_runner_health_probe_timeout_s": 30.0, "offline_eval_rl_module_inference_only": false, "broadcast_offline_eval_runner_states": false, "offline_eval_batch_size_per_runner": 256, "dataset_num_iters_per_eval_runner": 1, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "log_gradients": true, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 42, "restart_failed_env_runners": true, "ignore_env_runner_failures": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30.0, "env_runner_restore_timeout_s": 1800.0, "_model_config": {}, "_rl_module_spec": "RLModuleSpec(module_class=None, observation_space=None, action_space=None, inference_only=False, learner_only=False, model_config=DefaultModelConfig(fcnet_hiddens=[60, 90], fcnet_activation='tanh', fcnet_kernel_initializer=None, fcnet_kernel_initializer_kwargs=None, fcnet_bias_initializer=None, fcnet_bias_initializer_kwargs=None, conv_filters=None, conv_activation='relu', conv_kernel_initializer=None, conv_kernel_initializer_kwargs=None, conv_bias_initializer=None, conv_bias_initializer_kwargs=None, head_fcnet_hiddens=[], head_fcnet_activation='relu', head_fcnet_kernel_initializer=None, head_fcnet_kernel_initializer_kwargs=None, head_fcnet_bias_initializer=None, head_fcnet_bias_initializer_kwargs=None, free_log_std=False, log_std_clip_param=20.0, vf_share_layers=True, use_lstm=False, max_seq_len=20, lstm_cell_size=256, lstm_use_prev_action=False, lstm_use_prev_reward=False, lstm_kernel_initializer=None, lstm_kernel_initializer_kwargs=None, lstm_bias_initializer=None, lstm_bias_initializer_kwargs=None), catalog_class=None, load_state_path=None, model_config_dict=None)", "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "_validate_config": true, "_use_msgpack_checkpoints": false, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "env_task_fn": -1, "enable_connectors": -1, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.7464963036515, "kl_target": 0.0270990929592, "vf_loss_coeff": 0.6688075857018, "entropy_coeff": 0.0090570820258, "clip_param": 0.1221781641624, "vf_clip_param": 0.1027808522125, "entropy_coeff_schedule": null, "lr_schedule": null, "sgd_minibatch_size": -1, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9099046732075, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.callbacks.callbacks.RLlibCallback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 36.98801636695862, "iterations_since_restore": 7, "perf": {"cpu_util_percent": 12.3125, "ram_util_percent": 89.57499999999999}}
