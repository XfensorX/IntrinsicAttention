{"timers": {"training_iteration": 4.2340347090000705, "restore_env_runners": 1.5200000007098424e-05, "training_step": 4.233750109000084, "env_runner_sampling_timer": 3.8041744390000076, "learner_update_timer": 0.42620337100015604, "synch_weights": 0.0014032000001407141}, "env_runners": {"episode_len_max": 50, "sample": 0.038960876646213706, "num_episodes": 100.0, "agent_episode_returns_mean": {"default_agent": 3.3}, "module_to_env_connector": {"timers": {"connectors": {"tensor_to_numpy": 4.700176852586008e-05, "un_batch_to_individual_items": 1.5121297589213529e-05, "remove_single_ts_time_rank_from_batch": 1.4981940772170513e-06, "get_actions": 0.00016632890513061668, "normalize_and_clip_actions": 2.7891781176493674e-05, "listify_data_for_vector_env": 3.0350024505655273e-05}}, "connector_pipeline_timer": 0.00036404289831686075}, "env_to_module_connector": {"timers": {"connectors": {"add_time_dim_to_batch_and_zero_pad": 6.690720623551626e-06, "numpy_to_tensor": 3.0996056581024926e-05, "add_observations_from_episodes_to_batch": 6.8314917792309966e-06, "batch_individual_items": 1.86068480067138e-05, "add_states_from_episodes_to_batch": 3.49916388075744e-06}}, "connector_pipeline_timer": 0.00012156384271686801}, "num_env_steps_sampled_lifetime": 252500.0, "time_between_sampling": 0.0012860455720591503, "episode_return_mean": 3.3, "env_reset_timer": 0.00017448939417754396, "episode_duration_sec_mean": 0.03552414656000337, "weights_seq_no": 0.0, "num_module_steps_sampled_lifetime": {"default_policy": 252500.0}, "num_agent_steps_sampled_lifetime": {"default_agent": 252500.0}, "env_to_module_sum_episodes_length_out": 26.762340024562445, "episode_len_min": 50, "rlmodule_inference_timer": 0.00010231399445385648, "episode_return_max": 14.5, "num_episodes_lifetime": 5050.0, "module_episode_returns_mean": {"default_policy": 3.3}, "num_env_steps_sampled": 5000.0, "num_module_steps_sampled": {"default_policy": 5000.0}, "env_step_timer": 4.3277706844575715e-05, "num_agent_steps_sampled": {"default_agent": 5000.0}, "episode_len_mean": 50.0, "env_to_module_sum_episodes_length_in": 26.762340024562445, "episode_return_min": -5.5, "num_env_steps_sampled_lifetime_throughput": 1272.7626896282948}, "learners": {"__all_modules__": {"learner_connector": {"timers": {"connectors": {"general_advantage_estimation": 0.013343398999950296, "add_observations_from_episodes_to_batch": 0.0007815000001301087, "add_time_dim_to_batch_and_zero_pad": 2.7299999828755972e-05, "add_columns_from_episodes_to_train_batch": 0.0698764950000168, "add_one_ts_to_episodes_and_truncate": 0.008494599000187009, "add_states_from_episodes_to_batch": 6.100000064179767e-06, "numpy_to_tensor": 0.00016479999999319261, "batch_individual_items": 0.2087492860000566}}, "connector_pipeline_timer": 0.3018238790000396}, "num_module_steps_trained_lifetime": 6000, "num_env_steps_trained": 30600, "num_module_steps_trained": 6000, "num_non_trainable_parameters": 0, "learner_connector_sum_episodes_length_in": 5000, "num_trainable_parameters": 8947, "learner_connector_sum_episodes_length_out": 5100, "num_env_steps_trained_lifetime": 30600, "num_env_steps_trained_lifetime_throughput": 878145.7117774582, "num_module_steps_trained_throughput": 172506.98584257998, "num_module_steps_trained_lifetime_throughput": 172587.46548875805}, "default_policy": {"vf_loss": 0.3863759934902191, "entropy": 0.36181050539016724, "module_train_batch_size_mean": 1000.0, "num_trainable_parameters": 8947, "gradients_default_optimizer_global_norm": 1.7297306060791016, "policy_loss": 0.10685574263334274, "curr_entropy_coeff": 0.0215908733273, "vf_loss_unclipped": 20.15118980407715, "mean_kl_loss": 0.502109169960022, "weights_seq_no": 1.0, "num_module_steps_trained_lifetime": 6000, "vf_explained_var": -0.41473591327667236, "curr_kl_coeff": 0.4346989095211029, "default_optimizer_learning_rate": 0.0577875573446, "num_module_steps_trained": 6000, "total_loss": 0.5773119330406189, "diff_num_grad_updates_vs_sampler_policy": 1.0, "num_module_steps_trained_lifetime_throughput": 172813.81163145634}}, "num_training_step_calls_per_iteration": 1, "num_env_steps_sampled_lifetime": 252500.0, "evaluation": {"env_runners": {"env_to_module_connector": {"timers": {"connectors": {"add_time_dim_to_batch_and_zero_pad": 5.843008112587698e-06, "add_states_from_episodes_to_batch": 3.752378257596125e-06, "add_observations_from_episodes_to_batch": 6.559857307761959e-06, "numpy_to_tensor": 3.141346155987644e-05, "batch_individual_items": 1.9633463420435747e-05}}, "connector_pipeline_timer": 0.00012023893677188765}, "env_reset_timer": 0.00034890000006271293, "episode_return_mean": 4.1, "env_to_module_sum_episodes_length_out": 27.167134025045954, "num_episodes_lifetime": 20, "env_step_timer": 4.422177156323298e-05, "episode_len_mean": 50.0, "env_to_module_sum_episodes_length_in": 27.167134025045954, "module_to_env_connector": {"timers": {"connectors": {"un_batch_to_individual_items": 1.602754132590953e-05, "listify_data_for_vector_env": 3.33423218767423e-05, "tensor_to_numpy": 4.7844878756512054e-05, "get_actions": 0.00016589215361034558, "remove_single_ts_time_rank_from_batch": 1.5126296376469879e-06, "normalize_and_clip_actions": 2.4240694555741668e-05}}, "connector_pipeline_timer": 0.0003665737195726075}, "num_episodes": 20, "num_env_steps_sampled_lifetime": 6000, "agent_episode_returns_mean": {"default_agent": 4.1}, "rlmodule_inference_timer": 0.00010324674875752548, "episode_return_max": 17.5, "num_module_steps_sampled_lifetime": {"default_policy": 1000}, "sample": 0.7403497489999609, "episode_duration_sec_mean": 0.03553927774997874, "weights_seq_no": 1.0, "episode_len_min": 50, "num_agent_steps_sampled_lifetime": {"default_agent": 1000}, "num_module_steps_sampled": {"default_policy": 1000}, "episode_return_min": -16.5, "module_episode_returns_mean": {"default_policy": 4.1}, "num_env_steps_sampled": 1000, "episode_len_max": 50, "num_agent_steps_sampled": {"default_agent": 1000}}, "num_healthy_workers": 1, "actor_manager_num_outstanding_async_reqs": 0, "num_remote_worker_restarts": 0}, "fault_tolerance": {"num_healthy_workers": 0, "num_remote_worker_restarts": 0}, "env_runner_group": {"actor_manager_num_outstanding_async_reqs": 0}, "done": false, "training_iteration": 1, "trial_id": "471b3_00000", "date": "2025-08-11_16-31-01", "timestamp": 1754922661, "time_this_iter_s": 4.989569902420044, "time_total_s": 4.989569902420044, "pid": 29544, "hostname": "DESKTOP-3SK5A41", "node_ip": "192.168.40.242", "config": {"exploration_config": {}, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 6, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "env": "Umbrella", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": false, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 0, "create_local_env_runner": true, "num_envs_per_env_runner": 1, "gym_env_vectorize_mode": "SYNC", "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "episodes_to_numpy": true, "max_requests_in_flight_per_env_runner": 1, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "merge_env_runner_states": "training_only", "broadcast_env_runner_states": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "complete_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "sampler_perf_stats_ema_coef": null, "_is_online": true, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": "auto", "num_aggregator_actors_per_learner": 0, "max_requests_in_flight_per_aggregator_actor": 3, "local_gpu_idx": 0, "max_requests_in_flight_per_learner": 3, "gamma": 1, "lr": 0.0577875573446, "grad_clip": 0.5, "grad_clip_by": "global_norm", "_train_batch_size_per_learner": 5000, "train_batch_size": 4000, "num_epochs": 1, "minibatch_size": 1000, "shuffle_batch_per_epoch": true, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "log_std_clip_param": 20.0, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "_disable_preprocessor_api": false, "_disable_action_flattening": false}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "_learner_class": null, "callbacks_on_algorithm_init": null, "callbacks_on_env_runners_recreated": null, "callbacks_on_offline_eval_runners_recreated": null, "callbacks_on_checkpoint_loaded": null, "callbacks_on_environment_created": null, "callbacks_on_episode_created": null, "callbacks_on_episode_start": null, "callbacks_on_episode_step": null, "callbacks_on_episode_end": null, "callbacks_on_evaluate_start": null, "callbacks_on_evaluate_end": null, "callbacks_on_evaluate_offline_start": null, "callbacks_on_evaluate_offline_end": null, "callbacks_on_sample_end": null, "callbacks_on_train_result": null, "explore": true, "enable_rl_module_and_learner": true, "enable_env_runner_and_connector_v2": true, "_prior_exploration_config": {"type": "StochasticSampling"}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7985c431aac0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "offline_data_class": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_read_batch_size": null, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "materialize_data": false, "materialize_mapped_data": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "ignore_final_observation": false, "prelearner_class": null, "prelearner_buffer_class": null, "prelearner_buffer_kwargs": {}, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_remaining_data": false, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": 1, "evaluation_duration": 20, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_auto_duration_min_env_steps_per_sample": 100, "evaluation_auto_duration_max_env_steps_per_sample": 2000, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 1, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "offline_evaluation_interval": null, "num_offline_eval_runners": 0, "offline_loss_for_module_fn": null, "offline_evaluation_duration": 1, "offline_evaluation_parallel_to_training": false, "offline_evaluation_timeout_s": 120.0, "num_cpus_per_offline_eval_runner": 1, "num_gpus_per_offline_eval_runner": 0, "custom_resources_per_offline_eval_runner": {}, "restart_failed_offline_eval_runners": true, "ignore_offline_eval_runner_failures": false, "max_num_offline_eval_runner_restarts": 1000, "offline_eval_runner_restore_timeout_s": 1800.0, "max_requests_in_flight_per_offline_eval_runner": 1, "validate_offline_eval_runners_after_construction": true, "offline_eval_runner_health_probe_timeout_s": 30.0, "offline_eval_rl_module_inference_only": false, "broadcast_offline_eval_runner_states": false, "offline_eval_batch_size_per_runner": 256, "dataset_num_iters_per_eval_runner": 1, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "log_gradients": true, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 42, "restart_failed_env_runners": true, "ignore_env_runner_failures": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30.0, "env_runner_restore_timeout_s": 1800.0, "_model_config": {}, "_rl_module_spec": "RLModuleSpec(module_class=None, observation_space=None, action_space=None, inference_only=False, learner_only=False, model_config=DefaultModelConfig(fcnet_hiddens=[124, 66], fcnet_activation='tanh', fcnet_kernel_initializer=None, fcnet_kernel_initializer_kwargs=None, fcnet_bias_initializer=None, fcnet_bias_initializer_kwargs=None, conv_filters=None, conv_activation='relu', conv_kernel_initializer=None, conv_kernel_initializer_kwargs=None, conv_bias_initializer=None, conv_bias_initializer_kwargs=None, head_fcnet_hiddens=[], head_fcnet_activation='relu', head_fcnet_kernel_initializer=None, head_fcnet_kernel_initializer_kwargs=None, head_fcnet_bias_initializer=None, head_fcnet_bias_initializer_kwargs=None, free_log_std=False, log_std_clip_param=20.0, vf_share_layers=True, use_lstm=False, max_seq_len=20, lstm_cell_size=256, lstm_use_prev_action=False, lstm_use_prev_reward=False, lstm_kernel_initializer=None, lstm_kernel_initializer_kwargs=None, lstm_bias_initializer=None, lstm_bias_initializer_kwargs=None), catalog_class=None, load_state_path=None, model_config_dict=None)", "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "_validate_config": true, "_use_msgpack_checkpoints": false, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "env_task_fn": -1, "enable_connectors": -1, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2897992699974, "kl_target": 0.0207555480921, "vf_loss_coeff": 0.8612260576308, "entropy_coeff": 0.0215908733273, "clip_param": 0.2712648583756, "vf_clip_param": 0.4179245214167, "entropy_coeff_schedule": null, "lr_schedule": null, "sgd_minibatch_size": -1, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9219590679041, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.callbacks.callbacks.RLlibCallback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 4.989569902420044, "iterations_since_restore": 1, "perf": {"cpu_util_percent": 10.850000000000001, "ram_util_percent": 89.6}}
{"timers": {"training_iteration": 4.232575266080069, "restore_env_runners": 1.5192000005299632e-05, "training_step": 4.2322899050800835, "env_runner_sampling_timer": 3.805129818820008, "learner_update_timer": 0.42378590525015397, "synch_weights": 0.0014037220001387142, "restore_eval_env_runners": 1.3999999964653398e-05, "evaluation_iteration": 0.7520162490000075, "synch_eval_env_connectors": 0.0003762000001188426, "synch_env_connectors": 8.199999911084888e-06}, "env_runners": {"episode_len_max": 50, "sample": 0.037820946012078104, "num_episodes": 100.0, "agent_episode_returns_mean": {"default_agent": 6.5}, "module_to_env_connector": {"timers": {"connectors": {"tensor_to_numpy": 4.873595300763512e-05, "un_batch_to_individual_items": 1.4925847044136192e-05, "remove_single_ts_time_rank_from_batch": 1.5043213934988486e-06, "get_actions": 0.00016454488008139828, "normalize_and_clip_actions": 2.234565800137357e-05, "listify_data_for_vector_env": 3.041261969286836e-05}}, "connector_pipeline_timer": 0.0003589941223139388}, "env_to_module_connector": {"timers": {"connectors": {"add_time_dim_to_batch_and_zero_pad": 6.547348810773041e-06, "numpy_to_tensor": 3.0862141769082913e-05, "add_observations_from_episodes_to_batch": 6.5829516914107065e-06, "batch_individual_items": 1.8495030124574495e-05, "add_states_from_episodes_to_batch": 3.5229059514413527e-06}}, "connector_pipeline_timer": 0.00011920905301882657}, "num_env_steps_sampled_lifetime": 10000.0, "time_between_sampling": 0.009125122308630834, "episode_return_mean": 6.5, "env_reset_timer": 0.00012246764167144234, "episode_duration_sec_mean": 0.036457789280002546, "weights_seq_no": 1.0, "num_module_steps_sampled_lifetime": {"default_policy": 10000.0}, "num_agent_steps_sampled_lifetime": {"default_agent": 10000.0}, "env_to_module_sum_episodes_length_out": 27.16809333212661, "episode_len_min": 50, "rlmodule_inference_timer": 0.00010132504519497185, "episode_return_max": 14.5, "num_episodes_lifetime": 200.0, "module_episode_returns_mean": {"default_policy": 6.5}, "num_env_steps_sampled": 5000.0, "num_module_steps_sampled": {"default_policy": 5000.0}, "env_step_timer": 4.2626186455476027e-05, "num_agent_steps_sampled": {"default_agent": 5000.0}, "episode_len_mean": 50.0, "env_to_module_sum_episodes_length_in": 27.16809333212661, "episode_return_min": -5.5, "num_env_steps_sampled_lifetime_throughput": 1287.3549561747502}, "learners": {"__all_modules__": {"learner_connector": {"timers": {"connectors": {"general_advantage_estimation": 0.013333670009951675, "add_observations_from_episodes_to_batch": 0.0007806000001301072, "add_time_dim_to_batch_and_zero_pad": 2.727899983028692e-05, "add_columns_from_episodes_to_train_batch": 0.06984876204001694, "add_one_ts_to_episodes_and_truncate": 0.008490597010184047, "add_states_from_episodes_to_batch": 6.106000064391992e-06, "numpy_to_tensor": 0.00016513999999460795, "batch_individual_items": 0.2072503491200564}}, "connector_pipeline_timer": 0.3002818261800394}, "num_module_steps_trained_lifetime": 12000, "num_env_steps_trained": 30600, "num_module_steps_trained": 6000, "num_non_trainable_parameters": 0, "learner_connector_sum_episodes_length_in": 5000.0, "num_trainable_parameters": 8947, "learner_connector_sum_episodes_length_out": 5100.0, "num_env_steps_trained_lifetime": 61200, "num_env_steps_trained_lifetime_throughput": 876704.8671037541, "num_module_steps_trained_throughput": 172220.1320501493, "num_module_steps_trained_lifetime_throughput": 172298.7132135065}, "default_policy": {"vf_loss": 0.37848177552223206, "entropy": 0.5607496500015259, "module_train_batch_size_mean": 1000.0, "num_trainable_parameters": 8947, "gradients_default_optimizer_global_norm": 2.908151149749756, "policy_loss": 0.29880809783935547, "curr_entropy_coeff": 0.0215908733273, "vf_loss_unclipped": 12.80649471282959, "mean_kl_loss": 0.25460928678512573, "weights_seq_no": 2.0, "num_module_steps_trained_lifetime": 12000, "vf_explained_var": 0.2943188548088074, "curr_kl_coeff": 0.6520483493804932, "default_optimizer_learning_rate": 0.0577875573446, "num_module_steps_trained": 6000, "total_loss": 0.7233378291130066, "diff_num_grad_updates_vs_sampler_policy": 1.0, "num_module_steps_trained_lifetime_throughput": 172519.9065582123}}, "num_training_step_calls_per_iteration": 1, "evaluation": {"env_runners": {"env_to_module_connector": {"timers": {"connectors": {"add_time_dim_to_batch_and_zero_pad": 5.176985805235596e-06, "add_states_from_episodes_to_batch": 3.1903245367186255e-06, "add_observations_from_episodes_to_batch": 5.982591069133841e-06, "numpy_to_tensor": 2.8661025997355627e-05, "batch_individual_items": 1.8453005304708324e-05}}, "connector_pipeline_timer": 0.0001090114856475137}, "env_reset_timer": 0.0003466690000618655, "episode_return_mean": 2.1, "env_to_module_sum_episodes_length_out": 27.168093298253442, "num_episodes_lifetime": 40, "env_step_timer": 4.0594304230410495e-05, "episode_len_mean": 50.0, "env_to_module_sum_episodes_length_in": 27.168093298253442, "module_to_env_connector": {"timers": {"connectors": {"un_batch_to_individual_items": 1.5045829099051554e-05, "listify_data_for_vector_env": 3.0465914793538498e-05, "tensor_to_numpy": 4.6337864176208464e-05, "get_actions": 0.00015064823447450115, "remove_single_ts_time_rank_from_batch": 1.4125065979645534e-06, "normalize_and_clip_actions": 2.2346564444108677e-05}}, "connector_pipeline_timer": 0.00033755910012114805}, "num_episodes": 20, "num_env_steps_sampled_lifetime": 11000, "agent_episode_returns_mean": {"default_agent": 2.1}, "rlmodule_inference_timer": 9.382911426619915e-05, "episode_return_max": 17.5, "num_module_steps_sampled_lifetime": {"default_policy": 2000}, "sample": 0.7400707823799622, "episode_duration_sec_mean": 0.03488138607500559, "weights_seq_no": 2.0, "episode_len_min": 50, "num_agent_steps_sampled_lifetime": {"default_agent": 2000}, "num_module_steps_sampled": {"default_policy": 1000}, "episode_return_min": -16.5, "module_episode_returns_mean": {"default_policy": 2.1}, "num_env_steps_sampled": 1000, "episode_len_max": 50, "num_agent_steps_sampled": {"default_agent": 1000}, "time_between_sampling": 4.142842114000132}, "num_healthy_workers": 1, "actor_manager_num_outstanding_async_reqs": 0, "num_remote_worker_restarts": 0}, "num_env_steps_sampled_lifetime": 10000.0, "fault_tolerance": {"num_healthy_workers": 0, "num_remote_worker_restarts": 0}, "env_runner_group": {"actor_manager_num_outstanding_async_reqs": 0}, "done": false, "training_iteration": 2, "trial_id": "471b3_00000", "date": "2025-08-11_16-31-06", "timestamp": 1754922666, "time_this_iter_s": 4.813945531845093, "time_total_s": 9.803515434265137, "pid": 29544, "hostname": "DESKTOP-3SK5A41", "node_ip": "192.168.40.242", "config": {"exploration_config": {}, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 6, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "env": "Umbrella", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": false, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 0, "create_local_env_runner": true, "num_envs_per_env_runner": 1, "gym_env_vectorize_mode": "SYNC", "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "episodes_to_numpy": true, "max_requests_in_flight_per_env_runner": 1, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "merge_env_runner_states": "training_only", "broadcast_env_runner_states": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "complete_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "sampler_perf_stats_ema_coef": null, "_is_online": true, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": "auto", "num_aggregator_actors_per_learner": 0, "max_requests_in_flight_per_aggregator_actor": 3, "local_gpu_idx": 0, "max_requests_in_flight_per_learner": 3, "gamma": 1, "lr": 0.0577875573446, "grad_clip": 0.5, "grad_clip_by": "global_norm", "_train_batch_size_per_learner": 5000, "train_batch_size": 4000, "num_epochs": 1, "minibatch_size": 1000, "shuffle_batch_per_epoch": true, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "log_std_clip_param": 20.0, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "_disable_preprocessor_api": false, "_disable_action_flattening": false}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "_learner_class": null, "callbacks_on_algorithm_init": null, "callbacks_on_env_runners_recreated": null, "callbacks_on_offline_eval_runners_recreated": null, "callbacks_on_checkpoint_loaded": null, "callbacks_on_environment_created": null, "callbacks_on_episode_created": null, "callbacks_on_episode_start": null, "callbacks_on_episode_step": null, "callbacks_on_episode_end": null, "callbacks_on_evaluate_start": null, "callbacks_on_evaluate_end": null, "callbacks_on_evaluate_offline_start": null, "callbacks_on_evaluate_offline_end": null, "callbacks_on_sample_end": null, "callbacks_on_train_result": null, "explore": true, "enable_rl_module_and_learner": true, "enable_env_runner_and_connector_v2": true, "_prior_exploration_config": {"type": "StochasticSampling"}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7985c431aac0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "offline_data_class": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_read_batch_size": null, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "materialize_data": false, "materialize_mapped_data": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "ignore_final_observation": false, "prelearner_class": null, "prelearner_buffer_class": null, "prelearner_buffer_kwargs": {}, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_remaining_data": false, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": 1, "evaluation_duration": 20, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_auto_duration_min_env_steps_per_sample": 100, "evaluation_auto_duration_max_env_steps_per_sample": 2000, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 1, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "offline_evaluation_interval": null, "num_offline_eval_runners": 0, "offline_loss_for_module_fn": null, "offline_evaluation_duration": 1, "offline_evaluation_parallel_to_training": false, "offline_evaluation_timeout_s": 120.0, "num_cpus_per_offline_eval_runner": 1, "num_gpus_per_offline_eval_runner": 0, "custom_resources_per_offline_eval_runner": {}, "restart_failed_offline_eval_runners": true, "ignore_offline_eval_runner_failures": false, "max_num_offline_eval_runner_restarts": 1000, "offline_eval_runner_restore_timeout_s": 1800.0, "max_requests_in_flight_per_offline_eval_runner": 1, "validate_offline_eval_runners_after_construction": true, "offline_eval_runner_health_probe_timeout_s": 30.0, "offline_eval_rl_module_inference_only": false, "broadcast_offline_eval_runner_states": false, "offline_eval_batch_size_per_runner": 256, "dataset_num_iters_per_eval_runner": 1, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "log_gradients": true, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 42, "restart_failed_env_runners": true, "ignore_env_runner_failures": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30.0, "env_runner_restore_timeout_s": 1800.0, "_model_config": {}, "_rl_module_spec": "RLModuleSpec(module_class=None, observation_space=None, action_space=None, inference_only=False, learner_only=False, model_config=DefaultModelConfig(fcnet_hiddens=[124, 66], fcnet_activation='tanh', fcnet_kernel_initializer=None, fcnet_kernel_initializer_kwargs=None, fcnet_bias_initializer=None, fcnet_bias_initializer_kwargs=None, conv_filters=None, conv_activation='relu', conv_kernel_initializer=None, conv_kernel_initializer_kwargs=None, conv_bias_initializer=None, conv_bias_initializer_kwargs=None, head_fcnet_hiddens=[], head_fcnet_activation='relu', head_fcnet_kernel_initializer=None, head_fcnet_kernel_initializer_kwargs=None, head_fcnet_bias_initializer=None, head_fcnet_bias_initializer_kwargs=None, free_log_std=False, log_std_clip_param=20.0, vf_share_layers=True, use_lstm=False, max_seq_len=20, lstm_cell_size=256, lstm_use_prev_action=False, lstm_use_prev_reward=False, lstm_kernel_initializer=None, lstm_kernel_initializer_kwargs=None, lstm_bias_initializer=None, lstm_bias_initializer_kwargs=None), catalog_class=None, load_state_path=None, model_config_dict=None)", "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "_validate_config": true, "_use_msgpack_checkpoints": false, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "env_task_fn": -1, "enable_connectors": -1, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2897992699974, "kl_target": 0.0207555480921, "vf_loss_coeff": 0.8612260576308, "entropy_coeff": 0.0215908733273, "clip_param": 0.2712648583756, "vf_clip_param": 0.4179245214167, "entropy_coeff_schedule": null, "lr_schedule": null, "sgd_minibatch_size": -1, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9219590679041, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.callbacks.callbacks.RLlibCallback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 9.803515434265137, "iterations_since_restore": 2, "perf": {"cpu_util_percent": 12.114285714285714, "ram_util_percent": 89.72857142857143}}
{"timers": {"training_iteration": 4.233494876689269, "restore_env_runners": 1.5181080003412716e-05, "training_step": 4.233208773299282, "env_runner_sampling_timer": 3.8084611639218084, "learner_update_timer": 0.4213662411776511, "synch_weights": 0.0014044607801377653, "restore_eval_env_runners": 1.3992999965921626e-05, "evaluation_iteration": 0.7517147663800073, "synch_eval_env_connectors": 0.0003767460001176914, "synch_env_connectors": 8.19099991076655e-06}, "env_runners": {"episode_len_max": 50, "sample": 0.03812633687231237, "num_episodes": 100.0, "agent_episode_returns_mean": {"default_agent": 7.1}, "module_to_env_connector": {"timers": {"connectors": {"tensor_to_numpy": 4.999795875962735e-05, "un_batch_to_individual_items": 1.520843669487548e-05, "remove_single_ts_time_rank_from_batch": 1.5122725098032134e-06, "get_actions": 0.0001689704470604221, "normalize_and_clip_actions": 2.2955064821811082e-05, "listify_data_for_vector_env": 3.11737076157045e-05}}, "connector_pipeline_timer": 0.0003677466166152654}, "env_to_module_connector": {"timers": {"connectors": {"add_time_dim_to_batch_and_zero_pad": 6.700537071203192e-06, "numpy_to_tensor": 3.1886723358369324e-05, "add_observations_from_episodes_to_batch": 6.795795903093355e-06, "batch_individual_items": 1.8830128395675024e-05, "add_states_from_episodes_to_batch": 3.5388471553744694e-06}}, "connector_pipeline_timer": 0.00012221701831690017}, "num_env_steps_sampled_lifetime": -232500.0, "time_between_sampling": 0.010313597255281885, "episode_return_mean": 7.1, "env_reset_timer": 0.00010528918123825304, "episode_duration_sec_mean": 0.038774901330002665, "weights_seq_no": 2.0, "num_module_steps_sampled_lifetime": {"default_policy": -232500.0}, "num_agent_steps_sampled_lifetime": {"default_agent": -232500.0}, "env_to_module_sum_episodes_length_out": 27.16809333212661, "episode_len_min": 50, "rlmodule_inference_timer": 0.0001384657973307359, "episode_return_max": 14.5, "num_episodes_lifetime": -4650.0, "module_episode_returns_mean": {"default_policy": 7.1}, "num_env_steps_sampled": 5000.0, "num_module_steps_sampled": {"default_policy": 5000.0}, "env_step_timer": 4.38034415215119e-05, "num_agent_steps_sampled": {"default_agent": 5000.0}, "episode_len_mean": 50.0, "env_to_module_sum_episodes_length_in": 27.16809333212661, "episode_return_min": -5.5, "num_env_steps_sampled_lifetime_throughput": 1264.5766754800975}, "learners": {"__all_modules__": {"learner_connector": {"timers": {"connectors": {"general_advantage_estimation": 0.013326085309853445, "add_observations_from_episodes_to_batch": 0.0007796970001296813, "add_time_dim_to_batch_and_zero_pad": 2.725620983248973e-05, "add_columns_from_episodes_to_train_batch": 0.069818526409615, "add_one_ts_to_episodes_and_truncate": 0.008489309040080958, "add_states_from_episodes_to_batch": 6.098940063384362e-06, "numpy_to_tensor": 0.00016559759999422568, "batch_individual_items": 0.2057689716288552}}, "connector_pipeline_timer": 0.2987593439082388}, "num_module_steps_trained_lifetime": 18000, "num_env_steps_trained": 30600, "num_module_steps_trained": 6000, "num_non_trainable_parameters": 0, "learner_connector_sum_episodes_length_in": 5000.0, "num_trainable_parameters": 8947, "learner_connector_sum_episodes_length_out": 5100.0, "num_env_steps_trained_lifetime": 91800, "num_env_steps_trained_lifetime_throughput": 875376.3773937459, "num_module_steps_trained_throughput": 171954.30668723906, "num_module_steps_trained_lifetime_throughput": 172029.2816140824}, "default_policy": {"vf_loss": 0.4079382121562958, "entropy": 0.456123948097229, "module_train_batch_size_mean": 1000.0, "num_trainable_parameters": 8947, "gradients_default_optimizer_global_norm": 4.5724029541015625, "policy_loss": 0.27074116468429565, "curr_entropy_coeff": 0.0215908733273, "vf_loss_unclipped": 21.279525756835938, "mean_kl_loss": 0.5899011492729187, "weights_seq_no": 3.0, "num_module_steps_trained_lifetime": 18000, "vf_explained_var": 0.11036497354507446, "curr_kl_coeff": 0.9780725240707397, "default_optimizer_learning_rate": 0.0577875573446, "num_module_steps_trained": 6000, "total_loss": 0.9968641996383667, "diff_num_grad_updates_vs_sampler_policy": 1.0, "num_module_steps_trained_lifetime_throughput": 172240.65363896688}}, "num_training_step_calls_per_iteration": 1, "evaluation": {"env_runners": {"env_to_module_connector": {"timers": {"connectors": {"add_time_dim_to_batch_and_zero_pad": 5.758827271077473e-06, "add_states_from_episodes_to_batch": 3.3445770069667093e-06, "add_observations_from_episodes_to_batch": 6.618405615715442e-06, "numpy_to_tensor": 3.0266800525398965e-05, "batch_individual_items": 1.8977479491730566e-05}}, "connector_pipeline_timer": 0.00011510509065623949}, "env_reset_timer": 0.0003444893100612944, "episode_return_mean": 2.7666666666666666, "env_to_module_sum_episodes_length_out": 27.168093332125434, "num_episodes_lifetime": 60, "env_step_timer": 4.365547216889366e-05, "episode_len_mean": 50.0, "env_to_module_sum_episodes_length_in": 27.168093332125434, "module_to_env_connector": {"timers": {"connectors": {"un_batch_to_individual_items": 1.542684666264895e-05, "listify_data_for_vector_env": 3.137047376885319e-05, "tensor_to_numpy": 4.6747193963773575e-05, "get_actions": 0.00015762905018418488, "remove_single_ts_time_rank_from_batch": 1.4557510041330429e-06, "normalize_and_clip_actions": 2.2592635171116936e-05}}, "connector_pipeline_timer": 0.0003490282237785646}, "num_episodes": 20, "num_env_steps_sampled_lifetime": 16000, "agent_episode_returns_mean": {"default_agent": 2.7666666666666666}, "rlmodule_inference_timer": 9.833126447539274e-05, "episode_return_max": 17.5, "num_module_steps_sampled_lifetime": {"default_policy": 3000}, "sample": 0.7398748854861624, "episode_duration_sec_mean": 0.0347694256166695, "weights_seq_no": 3.0, "episode_len_min": 50, "num_agent_steps_sampled_lifetime": {"default_agent": 3000}, "num_module_steps_sampled": {"default_policy": 1000}, "episode_return_min": -16.5, "module_episode_returns_mean": {"default_policy": 2.7666666666666666}, "num_env_steps_sampled": 1000, "episode_len_max": 50, "num_agent_steps_sampled": {"default_agent": 1000}, "time_between_sampling": 4.145194174120128}, "num_healthy_workers": 1, "actor_manager_num_outstanding_async_reqs": 0, "num_remote_worker_restarts": 0}, "num_env_steps_sampled_lifetime": -232500.0, "fault_tolerance": {"num_healthy_workers": 0, "num_remote_worker_restarts": 0}, "env_runner_group": {"actor_manager_num_outstanding_async_reqs": 0}, "done": false, "training_iteration": 3, "trial_id": "471b3_00000", "date": "2025-08-11_16-31-11", "timestamp": 1754922671, "time_this_iter_s": 5.059110403060913, "time_total_s": 14.86262583732605, "pid": 29544, "hostname": "DESKTOP-3SK5A41", "node_ip": "192.168.40.242", "config": {"exploration_config": {}, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 6, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "env": "Umbrella", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": false, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 0, "create_local_env_runner": true, "num_envs_per_env_runner": 1, "gym_env_vectorize_mode": "SYNC", "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "episodes_to_numpy": true, "max_requests_in_flight_per_env_runner": 1, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "merge_env_runner_states": "training_only", "broadcast_env_runner_states": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "complete_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "sampler_perf_stats_ema_coef": null, "_is_online": true, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": "auto", "num_aggregator_actors_per_learner": 0, "max_requests_in_flight_per_aggregator_actor": 3, "local_gpu_idx": 0, "max_requests_in_flight_per_learner": 3, "gamma": 1, "lr": 0.0577875573446, "grad_clip": 0.5, "grad_clip_by": "global_norm", "_train_batch_size_per_learner": 5000, "train_batch_size": 4000, "num_epochs": 1, "minibatch_size": 1000, "shuffle_batch_per_epoch": true, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "log_std_clip_param": 20.0, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "_disable_preprocessor_api": false, "_disable_action_flattening": false}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "_learner_class": null, "callbacks_on_algorithm_init": null, "callbacks_on_env_runners_recreated": null, "callbacks_on_offline_eval_runners_recreated": null, "callbacks_on_checkpoint_loaded": null, "callbacks_on_environment_created": null, "callbacks_on_episode_created": null, "callbacks_on_episode_start": null, "callbacks_on_episode_step": null, "callbacks_on_episode_end": null, "callbacks_on_evaluate_start": null, "callbacks_on_evaluate_end": null, "callbacks_on_evaluate_offline_start": null, "callbacks_on_evaluate_offline_end": null, "callbacks_on_sample_end": null, "callbacks_on_train_result": null, "explore": true, "enable_rl_module_and_learner": true, "enable_env_runner_and_connector_v2": true, "_prior_exploration_config": {"type": "StochasticSampling"}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7985c431aac0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "offline_data_class": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_read_batch_size": null, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "materialize_data": false, "materialize_mapped_data": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "ignore_final_observation": false, "prelearner_class": null, "prelearner_buffer_class": null, "prelearner_buffer_kwargs": {}, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_remaining_data": false, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": 1, "evaluation_duration": 20, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_auto_duration_min_env_steps_per_sample": 100, "evaluation_auto_duration_max_env_steps_per_sample": 2000, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 1, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "offline_evaluation_interval": null, "num_offline_eval_runners": 0, "offline_loss_for_module_fn": null, "offline_evaluation_duration": 1, "offline_evaluation_parallel_to_training": false, "offline_evaluation_timeout_s": 120.0, "num_cpus_per_offline_eval_runner": 1, "num_gpus_per_offline_eval_runner": 0, "custom_resources_per_offline_eval_runner": {}, "restart_failed_offline_eval_runners": true, "ignore_offline_eval_runner_failures": false, "max_num_offline_eval_runner_restarts": 1000, "offline_eval_runner_restore_timeout_s": 1800.0, "max_requests_in_flight_per_offline_eval_runner": 1, "validate_offline_eval_runners_after_construction": true, "offline_eval_runner_health_probe_timeout_s": 30.0, "offline_eval_rl_module_inference_only": false, "broadcast_offline_eval_runner_states": false, "offline_eval_batch_size_per_runner": 256, "dataset_num_iters_per_eval_runner": 1, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "log_gradients": true, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 42, "restart_failed_env_runners": true, "ignore_env_runner_failures": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30.0, "env_runner_restore_timeout_s": 1800.0, "_model_config": {}, "_rl_module_spec": "RLModuleSpec(module_class=None, observation_space=None, action_space=None, inference_only=False, learner_only=False, model_config=DefaultModelConfig(fcnet_hiddens=[124, 66], fcnet_activation='tanh', fcnet_kernel_initializer=None, fcnet_kernel_initializer_kwargs=None, fcnet_bias_initializer=None, fcnet_bias_initializer_kwargs=None, conv_filters=None, conv_activation='relu', conv_kernel_initializer=None, conv_kernel_initializer_kwargs=None, conv_bias_initializer=None, conv_bias_initializer_kwargs=None, head_fcnet_hiddens=[], head_fcnet_activation='relu', head_fcnet_kernel_initializer=None, head_fcnet_kernel_initializer_kwargs=None, head_fcnet_bias_initializer=None, head_fcnet_bias_initializer_kwargs=None, free_log_std=False, log_std_clip_param=20.0, vf_share_layers=True, use_lstm=False, max_seq_len=20, lstm_cell_size=256, lstm_use_prev_action=False, lstm_use_prev_reward=False, lstm_kernel_initializer=None, lstm_kernel_initializer_kwargs=None, lstm_bias_initializer=None, lstm_bias_initializer_kwargs=None), catalog_class=None, load_state_path=None, model_config_dict=None)", "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "_validate_config": true, "_use_msgpack_checkpoints": false, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "env_task_fn": -1, "enable_connectors": -1, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2897992699974, "kl_target": 0.0207555480921, "vf_loss_coeff": 0.8612260576308, "entropy_coeff": 0.0215908733273, "clip_param": 0.2712648583756, "vf_clip_param": 0.4179245214167, "entropy_coeff_schedule": null, "lr_schedule": null, "sgd_minibatch_size": -1, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9219590679041, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.callbacks.callbacks.RLlibCallback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 14.86262583732605, "iterations_since_restore": 3, "perf": {"cpu_util_percent": 12.085714285714285, "ram_util_percent": 89.67142857142858}}
{"timers": {"training_iteration": 4.233631678512376, "restore_env_runners": 1.5165269204399462e-05, "training_step": 4.233344407156291, "env_runner_sampling_timer": 3.8095355059025917, "learner_update_timer": 0.4204244147358739, "synch_weights": 0.001404974172336694, "restore_eval_env_runners": 1.3994069966702227e-05, "evaluation_iteration": 0.751503697646208, "synch_eval_env_connectors": 0.00037621854011742924, "synch_env_connectors": 8.19108991304347e-06}, "env_runners": {"episode_len_max": 50, "sample": 0.03874630056025955, "num_episodes": 100.0, "agent_episode_returns_mean": {"default_agent": -2.5}, "module_to_env_connector": {"timers": {"connectors": {"tensor_to_numpy": 4.949379963446728e-05, "un_batch_to_individual_items": 1.4965603331300221e-05, "remove_single_ts_time_rank_from_batch": 1.4815869097502577e-06, "get_actions": 0.00016580218781279596, "normalize_and_clip_actions": 2.260863601524092e-05, "listify_data_for_vector_env": 3.0276277876539713e-05}}, "connector_pipeline_timer": 0.0003611670338733236}, "env_to_module_connector": {"timers": {"connectors": {"add_time_dim_to_batch_and_zero_pad": 6.561139850713189e-06, "numpy_to_tensor": 3.113655640705917e-05, "add_observations_from_episodes_to_batch": 6.5873350307109595e-06, "batch_individual_items": 1.8430779062104282e-05, "add_states_from_episodes_to_batch": 3.4553371728597087e-06}}, "connector_pipeline_timer": 0.00011965211723083941}, "num_env_steps_sampled_lifetime": -475000.0, "time_between_sampling": 0.010828836249886618, "episode_return_mean": -2.5, "env_reset_timer": 0.00010134009428700315, "episode_duration_sec_mean": 0.036601656619993705, "weights_seq_no": 3.0, "num_module_steps_sampled_lifetime": {"default_policy": -475000.0}, "num_agent_steps_sampled_lifetime": {"default_agent": -475000.0}, "env_to_module_sum_episodes_length_out": 27.16809333212661, "episode_len_min": 50, "rlmodule_inference_timer": 0.00010208907610276303, "episode_return_max": 14.5, "num_episodes_lifetime": -9500.0, "module_episode_returns_mean": {"default_policy": -2.5}, "num_env_steps_sampled": 5000.0, "num_module_steps_sampled": {"default_policy": 5000.0}, "env_step_timer": 4.2978875045713454e-05, "num_agent_steps_sampled": {"default_agent": 5000.0}, "episode_len_mean": 50.0, "env_to_module_sum_episodes_length_in": 27.16809333212661, "episode_return_min": -5.5, "num_env_steps_sampled_lifetime_throughput": 1266.847623232794}, "learners": {"__all_modules__": {"learner_connector": {"timers": {"connectors": {"general_advantage_estimation": 0.013335841456755237, "add_observations_from_episodes_to_batch": 0.0007786670301282387, "add_time_dim_to_batch_and_zero_pad": 2.7234647735463797e-05, "add_columns_from_episodes_to_train_batch": 0.06978725613552056, "add_one_ts_to_episodes_and_truncate": 0.008486768949680389, "add_states_from_episodes_to_batch": 6.1059506643978245e-06, "numpy_to_tensor": 0.00016567262399411949, "batch_individual_items": 0.20574276489256527}}, "connector_pipeline_timer": 0.2987077994391543}, "num_module_steps_trained_lifetime": 24000, "num_env_steps_trained": 30600, "num_module_steps_trained": 6000, "num_non_trainable_parameters": 0, "learner_connector_sum_episodes_length_in": 5000.0, "num_trainable_parameters": 8947, "learner_connector_sum_episodes_length_out": 5100.0, "num_env_steps_trained_lifetime": 122400, "num_env_steps_trained_lifetime_throughput": 874313.094719399, "num_module_steps_trained_throughput": 171740.8209540104, "num_module_steps_trained_lifetime_throughput": 171809.82963944267}, "default_policy": {"vf_loss": 0.4179244935512543, "entropy": 0.6285468339920044, "module_train_batch_size_mean": 1000.0, "num_trainable_parameters": 8947, "gradients_default_optimizer_global_norm": 1.2184604406356812, "policy_loss": 0.05722029134631157, "curr_entropy_coeff": 0.0215908733273, "vf_loss_unclipped": 11.88720417022705, "mean_kl_loss": 0.021937351673841476, "weights_seq_no": 4.0, "num_module_steps_trained_lifetime": 24000, "vf_explained_var": 0.8084465265274048, "curr_kl_coeff": 0.9780725240707397, "default_optimizer_learning_rate": 0.0577875573446, "num_module_steps_trained": 6000, "total_loss": 0.4250332713127136, "diff_num_grad_updates_vs_sampler_policy": 1.0, "num_module_steps_trained_lifetime_throughput": 172010.949577032}}, "num_training_step_calls_per_iteration": 1, "evaluation": {"env_runners": {"env_to_module_connector": {"timers": {"connectors": {"add_time_dim_to_batch_and_zero_pad": 5.484313982362359e-06, "add_states_from_episodes_to_batch": 3.179463043158625e-06, "add_observations_from_episodes_to_batch": 5.979992656742446e-06, "numpy_to_tensor": 2.8890928931095128e-05, "batch_individual_items": 1.8000434680208644e-05}}, "connector_pipeline_timer": 0.00010969589468679234}, "env_reset_timer": 0.0003423884169604714, "episode_return_mean": 2.1, "env_to_module_sum_episodes_length_out": 27.168093332126602, "num_episodes_lifetime": 80, "env_step_timer": 4.098981619566951e-05, "episode_len_mean": 50.0, "env_to_module_sum_episodes_length_in": 27.168093332126602, "module_to_env_connector": {"timers": {"connectors": {"un_batch_to_individual_items": 1.4740787508642438e-05, "listify_data_for_vector_env": 3.096638968039102e-05, "tensor_to_numpy": 4.538859389597564e-05, "get_actions": 0.00015085862783957725, "remove_single_ts_time_rank_from_batch": 1.4095288875425687e-06, "normalize_and_clip_actions": 2.1639094138623943e-05}}, "connector_pipeline_timer": 0.00033564578839809147}, "num_episodes": 20, "num_env_steps_sampled_lifetime": 21000, "agent_episode_returns_mean": {"default_agent": 2.1}, "rlmodule_inference_timer": 9.354202242019432e-05, "episode_return_max": 17.5, "num_module_steps_sampled_lifetime": {"default_policy": 4000}, "sample": 0.7396116905713005, "episode_duration_sec_mean": 0.034649930387499236, "weights_seq_no": 4.0, "episode_len_min": 50, "num_agent_steps_sampled_lifetime": {"default_agent": 4000}, "num_module_steps_sampled": {"default_policy": 1000}, "episode_return_min": -16.5, "module_episode_returns_mean": {"default_policy": 2.1}, "num_env_steps_sampled": 1000, "episode_len_max": 50, "num_agent_steps_sampled": {"default_agent": 1000}, "time_between_sampling": 4.146786161958926}, "num_healthy_workers": 1, "actor_manager_num_outstanding_async_reqs": 0, "num_remote_worker_restarts": 0}, "num_env_steps_sampled_lifetime": -475000.0, "fault_tolerance": {"num_healthy_workers": 0, "num_remote_worker_restarts": 0}, "env_runner_group": {"actor_manager_num_outstanding_async_reqs": 0}, "done": false, "training_iteration": 4, "trial_id": "471b3_00000", "date": "2025-08-11_16-31-16", "timestamp": 1754922676, "time_this_iter_s": 4.975141763687134, "time_total_s": 19.837767601013184, "pid": 29544, "hostname": "DESKTOP-3SK5A41", "node_ip": "192.168.40.242", "config": {"exploration_config": {}, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 6, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "env": "Umbrella", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": false, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 0, "create_local_env_runner": true, "num_envs_per_env_runner": 1, "gym_env_vectorize_mode": "SYNC", "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "episodes_to_numpy": true, "max_requests_in_flight_per_env_runner": 1, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "merge_env_runner_states": "training_only", "broadcast_env_runner_states": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "complete_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "sampler_perf_stats_ema_coef": null, "_is_online": true, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": "auto", "num_aggregator_actors_per_learner": 0, "max_requests_in_flight_per_aggregator_actor": 3, "local_gpu_idx": 0, "max_requests_in_flight_per_learner": 3, "gamma": 1, "lr": 0.0577875573446, "grad_clip": 0.5, "grad_clip_by": "global_norm", "_train_batch_size_per_learner": 5000, "train_batch_size": 4000, "num_epochs": 1, "minibatch_size": 1000, "shuffle_batch_per_epoch": true, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "log_std_clip_param": 20.0, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "_disable_preprocessor_api": false, "_disable_action_flattening": false}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "_learner_class": null, "callbacks_on_algorithm_init": null, "callbacks_on_env_runners_recreated": null, "callbacks_on_offline_eval_runners_recreated": null, "callbacks_on_checkpoint_loaded": null, "callbacks_on_environment_created": null, "callbacks_on_episode_created": null, "callbacks_on_episode_start": null, "callbacks_on_episode_step": null, "callbacks_on_episode_end": null, "callbacks_on_evaluate_start": null, "callbacks_on_evaluate_end": null, "callbacks_on_evaluate_offline_start": null, "callbacks_on_evaluate_offline_end": null, "callbacks_on_sample_end": null, "callbacks_on_train_result": null, "explore": true, "enable_rl_module_and_learner": true, "enable_env_runner_and_connector_v2": true, "_prior_exploration_config": {"type": "StochasticSampling"}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7985c431aac0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "offline_data_class": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_read_batch_size": null, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "materialize_data": false, "materialize_mapped_data": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "ignore_final_observation": false, "prelearner_class": null, "prelearner_buffer_class": null, "prelearner_buffer_kwargs": {}, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_remaining_data": false, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": 1, "evaluation_duration": 20, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_auto_duration_min_env_steps_per_sample": 100, "evaluation_auto_duration_max_env_steps_per_sample": 2000, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 1, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "offline_evaluation_interval": null, "num_offline_eval_runners": 0, "offline_loss_for_module_fn": null, "offline_evaluation_duration": 1, "offline_evaluation_parallel_to_training": false, "offline_evaluation_timeout_s": 120.0, "num_cpus_per_offline_eval_runner": 1, "num_gpus_per_offline_eval_runner": 0, "custom_resources_per_offline_eval_runner": {}, "restart_failed_offline_eval_runners": true, "ignore_offline_eval_runner_failures": false, "max_num_offline_eval_runner_restarts": 1000, "offline_eval_runner_restore_timeout_s": 1800.0, "max_requests_in_flight_per_offline_eval_runner": 1, "validate_offline_eval_runners_after_construction": true, "offline_eval_runner_health_probe_timeout_s": 30.0, "offline_eval_rl_module_inference_only": false, "broadcast_offline_eval_runner_states": false, "offline_eval_batch_size_per_runner": 256, "dataset_num_iters_per_eval_runner": 1, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "log_gradients": true, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 42, "restart_failed_env_runners": true, "ignore_env_runner_failures": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30.0, "env_runner_restore_timeout_s": 1800.0, "_model_config": {}, "_rl_module_spec": "RLModuleSpec(module_class=None, observation_space=None, action_space=None, inference_only=False, learner_only=False, model_config=DefaultModelConfig(fcnet_hiddens=[124, 66], fcnet_activation='tanh', fcnet_kernel_initializer=None, fcnet_kernel_initializer_kwargs=None, fcnet_bias_initializer=None, fcnet_bias_initializer_kwargs=None, conv_filters=None, conv_activation='relu', conv_kernel_initializer=None, conv_kernel_initializer_kwargs=None, conv_bias_initializer=None, conv_bias_initializer_kwargs=None, head_fcnet_hiddens=[], head_fcnet_activation='relu', head_fcnet_kernel_initializer=None, head_fcnet_kernel_initializer_kwargs=None, head_fcnet_bias_initializer=None, head_fcnet_bias_initializer_kwargs=None, free_log_std=False, log_std_clip_param=20.0, vf_share_layers=True, use_lstm=False, max_seq_len=20, lstm_cell_size=256, lstm_use_prev_action=False, lstm_use_prev_reward=False, lstm_kernel_initializer=None, lstm_kernel_initializer_kwargs=None, lstm_bias_initializer=None, lstm_bias_initializer_kwargs=None), catalog_class=None, load_state_path=None, model_config_dict=None)", "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "_validate_config": true, "_use_msgpack_checkpoints": false, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "env_task_fn": -1, "enable_connectors": -1, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2897992699974, "kl_target": 0.0207555480921, "vf_loss_coeff": 0.8612260576308, "entropy_coeff": 0.0215908733273, "clip_param": 0.2712648583756, "vf_clip_param": 0.4179245214167, "entropy_coeff_schedule": null, "lr_schedule": null, "sgd_minibatch_size": -1, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9219590679041, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.callbacks.callbacks.RLlibCallback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 19.837767601013184, "iterations_since_restore": 4, "perf": {"cpu_util_percent": 12.7, "ram_util_percent": 89.60000000000001}}
{"timers": {"training_iteration": 4.231929375817251, "restore_env_runners": 1.5163616513113622e-05, "training_step": 4.2316403561747284, "env_runner_sampling_timer": 3.8102033278535643, "learner_update_timer": 0.41805084866851544, "synch_weights": 0.0014037834306141715, "restore_eval_env_runners": 1.4050129267904594e-05, "evaluation_iteration": 0.7512256765997458, "synch_eval_env_connectors": 0.00037642735471725674, "synch_env_connectors": 8.178179014079888e-06}, "env_runners": {"episode_len_max": 50, "sample": 0.03794312774531208, "num_episodes": 100.0, "agent_episode_returns_mean": {"default_agent": -0.5}, "module_to_env_connector": {"timers": {"connectors": {"tensor_to_numpy": 4.8829370507099904e-05, "un_batch_to_individual_items": 1.4817745342113358e-05, "remove_single_ts_time_rank_from_batch": 1.4796734950426965e-06, "get_actions": 0.00016376226631524115, "normalize_and_clip_actions": 2.231899313938947e-05, "listify_data_for_vector_env": 3.0045142102001482e-05}}, "connector_pipeline_timer": 0.00035726795484492804}, "env_to_module_connector": {"timers": {"connectors": {"add_time_dim_to_batch_and_zero_pad": 6.491561933455986e-06, "numpy_to_tensor": 3.071283616059922e-05, "add_observations_from_episodes_to_batch": 6.554475888038795e-06, "batch_individual_items": 1.8248358431573778e-05, "add_states_from_episodes_to_batch": 3.4695265631277142e-06}}, "connector_pipeline_timer": 0.00011842897202576062}, "num_env_steps_sampled_lifetime": -717500.0, "time_between_sampling": 0.011868344270846575, "episode_return_mean": -0.5, "env_reset_timer": 9.697222569263245e-05, "episode_duration_sec_mean": 0.036205920949989825, "weights_seq_no": 4.0, "num_module_steps_sampled_lifetime": {"default_policy": -717500.0}, "num_agent_steps_sampled_lifetime": {"default_agent": -717500.0}, "env_to_module_sum_episodes_length_out": 27.16809333212661, "episode_len_min": 50, "rlmodule_inference_timer": 9.977198348094516e-05, "episode_return_max": 14.5, "num_episodes_lifetime": -14350.0, "module_episode_returns_mean": {"default_policy": -0.5}, "num_env_steps_sampled": 5000.0, "num_module_steps_sampled": {"default_policy": 5000.0}, "env_step_timer": 4.292952445363112e-05, "num_agent_steps_sampled": {"default_agent": 5000.0}, "episode_len_mean": 50.0, "env_to_module_sum_episodes_length_in": 27.16809333212661, "episode_return_min": -5.5, "num_env_steps_sampled_lifetime_throughput": 1287.1599322038116}, "learners": {"__all_modules__": {"learner_connector": {"timers": {"connectors": {"general_advantage_estimation": 0.013311493042186446, "add_observations_from_episodes_to_batch": 0.0007775083598256836, "add_time_dim_to_batch_and_zero_pad": 2.71793012574476e-05, "add_columns_from_episodes_to_train_batch": 0.069757941594165, "add_one_ts_to_episodes_and_truncate": 0.008482203270182417, "add_states_from_episodes_to_batch": 6.097891156596853e-06, "numpy_to_tensor": 0.00016577089775486324, "batch_individual_items": 0.20427350327364155}}, "connector_pipeline_timer": 0.29717832050476245}, "num_module_steps_trained_lifetime": 30000, "num_env_steps_trained": 30600, "num_module_steps_trained": 6000, "num_non_trainable_parameters": 0, "learner_connector_sum_episodes_length_in": 5000.0, "num_trainable_parameters": 8947, "learner_connector_sum_episodes_length_out": 5100.0, "num_env_steps_trained_lifetime": 153000, "num_env_steps_trained_lifetime_throughput": 872193.5668127517, "num_module_steps_trained_throughput": 171319.89534234858, "num_module_steps_trained_lifetime_throughput": 171381.7279107094}, "default_policy": {"vf_loss": 0.35264983773231506, "entropy": 0.6626681089401245, "module_train_batch_size_mean": 1000.0, "num_trainable_parameters": 8947, "gradients_default_optimizer_global_norm": 1.5719966888427734, "policy_loss": 0.179494708776474, "curr_entropy_coeff": 0.0215908733273, "vf_loss_unclipped": 3.823026180267334, "mean_kl_loss": 0.01643148995935917, "weights_seq_no": 5.0, "num_module_steps_trained_lifetime": 30000, "vf_explained_var": 0.7881929278373718, "curr_kl_coeff": 0.9780725240707397, "default_optimizer_learning_rate": 0.0577875573446, "num_module_steps_trained": 6000, "total_loss": 0.4849695563316345, "diff_num_grad_updates_vs_sampler_policy": 1.0, "num_module_steps_trained_lifetime_throughput": 171572.2091932016}}, "num_training_step_calls_per_iteration": 1, "evaluation": {"env_runners": {"env_to_module_connector": {"timers": {"connectors": {"add_time_dim_to_batch_and_zero_pad": 5.228441690365274e-06, "add_states_from_episodes_to_batch": 3.113424366321229e-06, "add_observations_from_episodes_to_batch": 5.945556904937709e-06, "numpy_to_tensor": 2.9372605981966015e-05, "batch_individual_items": 1.8184078230180235e-05}}, "connector_pipeline_timer": 0.00010910384709395774}, "env_reset_timer": 0.0003402425327905959, "episode_return_mean": 2.1, "env_to_module_sum_episodes_length_out": 27.168093332126602, "num_episodes_lifetime": 100, "env_step_timer": 4.039328645456161e-05, "episode_len_mean": 50.0, "env_to_module_sum_episodes_length_in": 27.168093332126602, "module_to_env_connector": {"timers": {"connectors": {"un_batch_to_individual_items": 1.479414276360885e-05, "listify_data_for_vector_env": 2.9495779804051435e-05, "tensor_to_numpy": 4.623156005951114e-05, "get_actions": 0.00014958828759549197, "remove_single_ts_time_rank_from_batch": 1.3743976523947738e-06, "normalize_and_clip_actions": 2.1308371571292405e-05}}, "connector_pipeline_timer": 0.0003339137614163753}, "num_episodes": 20, "num_env_steps_sampled_lifetime": 26000, "agent_episode_returns_mean": {"default_agent": 2.1}, "rlmodule_inference_timer": 9.208354971877166e-05, "episode_return_max": 17.5, "num_module_steps_sampled_lifetime": {"default_policy": 5000}, "sample": 0.7392948069555862, "episode_duration_sec_mean": 0.0345225035999988, "weights_seq_no": 5.0, "episode_len_min": 50, "num_agent_steps_sampled_lifetime": {"default_agent": 5000}, "num_module_steps_sampled": {"default_policy": 1000}, "episode_return_min": -16.5, "module_episode_returns_mean": {"default_policy": 2.1}, "num_env_steps_sampled": 1000, "episode_len_max": 50, "num_agent_steps_sampled": {"default_agent": 1000}, "time_between_sampling": 4.1465129714193365}, "num_healthy_workers": 1, "actor_manager_num_outstanding_async_reqs": 0, "num_remote_worker_restarts": 0}, "num_env_steps_sampled_lifetime": -717500.0, "fault_tolerance": {"num_healthy_workers": 0, "num_remote_worker_restarts": 0}, "env_runner_group": {"actor_manager_num_outstanding_async_reqs": 0}, "done": false, "training_iteration": 5, "trial_id": "471b3_00000", "date": "2025-08-11_16-31-21", "timestamp": 1754922681, "time_this_iter_s": 4.785658836364746, "time_total_s": 24.62342643737793, "pid": 29544, "hostname": "DESKTOP-3SK5A41", "node_ip": "192.168.40.242", "config": {"exploration_config": {}, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 6, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "env": "Umbrella", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": false, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 0, "create_local_env_runner": true, "num_envs_per_env_runner": 1, "gym_env_vectorize_mode": "SYNC", "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "episodes_to_numpy": true, "max_requests_in_flight_per_env_runner": 1, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "merge_env_runner_states": "training_only", "broadcast_env_runner_states": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "complete_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "sampler_perf_stats_ema_coef": null, "_is_online": true, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": "auto", "num_aggregator_actors_per_learner": 0, "max_requests_in_flight_per_aggregator_actor": 3, "local_gpu_idx": 0, "max_requests_in_flight_per_learner": 3, "gamma": 1, "lr": 0.0577875573446, "grad_clip": 0.5, "grad_clip_by": "global_norm", "_train_batch_size_per_learner": 5000, "train_batch_size": 4000, "num_epochs": 1, "minibatch_size": 1000, "shuffle_batch_per_epoch": true, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "log_std_clip_param": 20.0, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "_disable_preprocessor_api": false, "_disable_action_flattening": false}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "_learner_class": null, "callbacks_on_algorithm_init": null, "callbacks_on_env_runners_recreated": null, "callbacks_on_offline_eval_runners_recreated": null, "callbacks_on_checkpoint_loaded": null, "callbacks_on_environment_created": null, "callbacks_on_episode_created": null, "callbacks_on_episode_start": null, "callbacks_on_episode_step": null, "callbacks_on_episode_end": null, "callbacks_on_evaluate_start": null, "callbacks_on_evaluate_end": null, "callbacks_on_evaluate_offline_start": null, "callbacks_on_evaluate_offline_end": null, "callbacks_on_sample_end": null, "callbacks_on_train_result": null, "explore": true, "enable_rl_module_and_learner": true, "enable_env_runner_and_connector_v2": true, "_prior_exploration_config": {"type": "StochasticSampling"}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7985c431aac0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "offline_data_class": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_read_batch_size": null, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "materialize_data": false, "materialize_mapped_data": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "ignore_final_observation": false, "prelearner_class": null, "prelearner_buffer_class": null, "prelearner_buffer_kwargs": {}, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_remaining_data": false, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": 1, "evaluation_duration": 20, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_auto_duration_min_env_steps_per_sample": 100, "evaluation_auto_duration_max_env_steps_per_sample": 2000, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 1, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "offline_evaluation_interval": null, "num_offline_eval_runners": 0, "offline_loss_for_module_fn": null, "offline_evaluation_duration": 1, "offline_evaluation_parallel_to_training": false, "offline_evaluation_timeout_s": 120.0, "num_cpus_per_offline_eval_runner": 1, "num_gpus_per_offline_eval_runner": 0, "custom_resources_per_offline_eval_runner": {}, "restart_failed_offline_eval_runners": true, "ignore_offline_eval_runner_failures": false, "max_num_offline_eval_runner_restarts": 1000, "offline_eval_runner_restore_timeout_s": 1800.0, "max_requests_in_flight_per_offline_eval_runner": 1, "validate_offline_eval_runners_after_construction": true, "offline_eval_runner_health_probe_timeout_s": 30.0, "offline_eval_rl_module_inference_only": false, "broadcast_offline_eval_runner_states": false, "offline_eval_batch_size_per_runner": 256, "dataset_num_iters_per_eval_runner": 1, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "log_gradients": true, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 42, "restart_failed_env_runners": true, "ignore_env_runner_failures": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30.0, "env_runner_restore_timeout_s": 1800.0, "_model_config": {}, "_rl_module_spec": "RLModuleSpec(module_class=None, observation_space=None, action_space=None, inference_only=False, learner_only=False, model_config=DefaultModelConfig(fcnet_hiddens=[124, 66], fcnet_activation='tanh', fcnet_kernel_initializer=None, fcnet_kernel_initializer_kwargs=None, fcnet_bias_initializer=None, fcnet_bias_initializer_kwargs=None, conv_filters=None, conv_activation='relu', conv_kernel_initializer=None, conv_kernel_initializer_kwargs=None, conv_bias_initializer=None, conv_bias_initializer_kwargs=None, head_fcnet_hiddens=[], head_fcnet_activation='relu', head_fcnet_kernel_initializer=None, head_fcnet_kernel_initializer_kwargs=None, head_fcnet_bias_initializer=None, head_fcnet_bias_initializer_kwargs=None, free_log_std=False, log_std_clip_param=20.0, vf_share_layers=True, use_lstm=False, max_seq_len=20, lstm_cell_size=256, lstm_use_prev_action=False, lstm_use_prev_reward=False, lstm_kernel_initializer=None, lstm_kernel_initializer_kwargs=None, lstm_bias_initializer=None, lstm_bias_initializer_kwargs=None), catalog_class=None, load_state_path=None, model_config_dict=None)", "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "_validate_config": true, "_use_msgpack_checkpoints": false, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "env_task_fn": -1, "enable_connectors": -1, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2897992699974, "kl_target": 0.0207555480921, "vf_loss_coeff": 0.8612260576308, "entropy_coeff": 0.0215908733273, "clip_param": 0.2712648583756, "vf_clip_param": 0.4179245214167, "entropy_coeff_schedule": null, "lr_schedule": null, "sgd_minibatch_size": -1, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9219590679041, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.callbacks.callbacks.RLlibCallback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 24.62342643737793, "iterations_since_restore": 5, "perf": {"cpu_util_percent": 12.228571428571428, "ram_util_percent": 89.70000000000002}}
{"timers": {"training_iteration": 4.232181997799079, "restore_env_runners": 1.5125980349741026e-05, "training_step": 4.231892314352981, "env_runner_sampling_timer": 3.811462464185028, "learner_update_timer": 0.4170434403118302, "synch_weights": 0.0014026555963084044, "restore_eval_env_runners": 1.4019627973810956e-05, "evaluation_iteration": 0.7508861151337468, "synch_eval_env_connectors": 0.0003778920811708657, "synch_env_connectors": 8.16339722479311e-06}, "env_runners": {"episode_len_max": 50, "sample": 0.037767661938492146, "num_episodes": 100.0, "agent_episode_returns_mean": {"default_agent": -1.0999999999999996}, "module_to_env_connector": {"timers": {"connectors": {"tensor_to_numpy": 4.946948664755589e-05, "un_batch_to_individual_items": 1.5066294834888193e-05, "remove_single_ts_time_rank_from_batch": 1.484281991806817e-06, "get_actions": 0.00016629028293382742, "normalize_and_clip_actions": 2.2738609195035347e-05, "listify_data_for_vector_env": 3.035282663095073e-05}}, "connector_pipeline_timer": 0.0003623523557444934}, "env_to_module_connector": {"timers": {"connectors": {"add_time_dim_to_batch_and_zero_pad": 6.677707837010504e-06, "numpy_to_tensor": 3.1310882319494596e-05, "add_observations_from_episodes_to_batch": 6.559623989033138e-06, "batch_individual_items": 1.8544620929944855e-05, "add_states_from_episodes_to_batch": 3.493148604083454e-06}}, "connector_pipeline_timer": 0.00012023436562746068}, "num_env_steps_sampled_lifetime": -960000.0, "time_between_sampling": 0.01129874254785903, "episode_return_mean": -1.0999999999999996, "env_reset_timer": 9.505517508380831e-05, "episode_duration_sec_mean": 0.03679312855001399, "weights_seq_no": 5.0, "num_module_steps_sampled_lifetime": {"default_policy": -960000.0}, "num_agent_steps_sampled_lifetime": {"default_agent": -960000.0}, "env_to_module_sum_episodes_length_out": 27.16809333212661, "episode_len_min": 50, "rlmodule_inference_timer": 0.00010300114533291187, "episode_return_max": 14.5, "num_episodes_lifetime": -19200.0, "module_episode_returns_mean": {"default_policy": -1.0999999999999996}, "num_env_steps_sampled": 5000.0, "num_module_steps_sampled": {"default_policy": 5000.0}, "env_step_timer": 4.317205888434172e-05, "num_agent_steps_sampled": {"default_agent": 5000.0}, "episode_len_mean": 50.0, "env_to_module_sum_episodes_length_in": 27.16809333212661, "episode_return_min": -5.5, "num_env_steps_sampled_lifetime_throughput": 1274.6905780767352}, "learners": {"__all_modules__": {"learner_connector": {"timers": {"connectors": {"general_advantage_estimation": 0.013287370121764874, "add_observations_from_episodes_to_batch": 0.0007763132862266243, "add_time_dim_to_batch_and_zero_pad": 2.7146508245747636e-05, "add_columns_from_episodes_to_train_batch": 0.06972347319822435, "add_one_ts_to_episodes_and_truncate": 0.00847853023748069, "add_states_from_episodes_to_batch": 6.222912244788652e-06, "numpy_to_tensor": 0.00016574018877650373, "batch_individual_items": 0.20424916532090365}}, "connector_pipeline_timer": 0.29709015841971437}, "num_module_steps_trained_lifetime": 36000, "num_env_steps_trained": 30600, "num_module_steps_trained": 6000, "num_non_trainable_parameters": 0, "learner_connector_sum_episodes_length_in": 5000.0, "num_trainable_parameters": 8947, "learner_connector_sum_episodes_length_out": 5100.0, "num_env_steps_trained_lifetime": 183600, "num_env_steps_trained_lifetime_throughput": 872389.8871302779, "num_module_steps_trained_throughput": 171353.1546217821, "num_module_steps_trained_lifetime_throughput": 171407.62543859278}, "default_policy": {"vf_loss": 0.41101208329200745, "entropy": 0.5666363835334778, "module_train_batch_size_mean": 1000.0, "num_trainable_parameters": 8947, "gradients_default_optimizer_global_norm": 1.4018179178237915, "policy_loss": 0.02947845496237278, "curr_entropy_coeff": 0.0215908733273, "vf_loss_unclipped": 19.686397552490234, "mean_kl_loss": 0.026791280135512352, "weights_seq_no": 6.0, "num_module_steps_trained_lifetime": 36000, "vf_explained_var": 0.5437059998512268, "curr_kl_coeff": 0.9780725240707397, "default_optimizer_learning_rate": 0.0577875573446, "num_module_steps_trained": 6000, "total_loss": 0.3974224925041199, "diff_num_grad_updates_vs_sampler_policy": 1.0, "num_module_steps_trained_lifetime_throughput": 171585.34328617205}}, "num_training_step_calls_per_iteration": 1, "evaluation": {"env_runners": {"env_to_module_connector": {"timers": {"connectors": {"add_time_dim_to_batch_and_zero_pad": 5.389678360245828e-06, "add_states_from_episodes_to_batch": 3.2138707904891895e-06, "add_observations_from_episodes_to_batch": 5.984208988692837e-06, "numpy_to_tensor": 2.8800437517660185e-05, "batch_individual_items": 1.7619939748460515e-05}}, "connector_pipeline_timer": 0.0001083859938255147}, "env_reset_timer": 0.0003384361074622984, "episode_return_mean": 1.1, "env_to_module_sum_episodes_length_out": 27.168093332126602, "num_episodes_lifetime": 120, "env_step_timer": 4.101517286466485e-05, "episode_len_mean": 50.0, "env_to_module_sum_episodes_length_in": 27.168093332126602, "module_to_env_connector": {"timers": {"connectors": {"un_batch_to_individual_items": 1.4851150306989158e-05, "listify_data_for_vector_env": 2.974364896610026e-05, "tensor_to_numpy": 4.535307955806607e-05, "get_actions": 0.00014977029212415592, "remove_single_ts_time_rank_from_batch": 1.5046335166179417e-06, "normalize_and_clip_actions": 2.2177982729753495e-05}}, "connector_pipeline_timer": 0.0003348174708106611}, "num_episodes": 20, "num_env_steps_sampled_lifetime": 31000, "agent_episode_returns_mean": {"default_agent": 1.1}, "rlmodule_inference_timer": 9.290051847203101e-05, "episode_return_max": 17.5, "num_module_steps_sampled_lifetime": {"default_policy": 6000}, "sample": 0.7389897570160311, "episode_duration_sec_mean": 0.034225107180000124, "weights_seq_no": 6.0, "episode_len_min": 50, "num_agent_steps_sampled_lifetime": {"default_agent": 6000}, "num_module_steps_sampled": {"default_policy": 1000}, "episode_return_min": -16.5, "module_episode_returns_mean": {"default_policy": 1.1}, "num_env_steps_sampled": 1000, "episode_len_max": 50, "num_agent_steps_sampled": {"default_agent": 1000}, "time_between_sampling": 4.148156872475142}, "num_healthy_workers": 1, "actor_manager_num_outstanding_async_reqs": 0, "num_remote_worker_restarts": 0}, "num_env_steps_sampled_lifetime": -960000.0, "fault_tolerance": {"num_healthy_workers": 0, "num_remote_worker_restarts": 0}, "env_runner_group": {"actor_manager_num_outstanding_async_reqs": 0}, "done": false, "training_iteration": 6, "trial_id": "471b3_00000", "date": "2025-08-11_16-31-26", "timestamp": 1754922686, "time_this_iter_s": 4.97952127456665, "time_total_s": 29.60294771194458, "pid": 29544, "hostname": "DESKTOP-3SK5A41", "node_ip": "192.168.40.242", "config": {"exploration_config": {}, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 6, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "env": "Umbrella", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": false, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 0, "create_local_env_runner": true, "num_envs_per_env_runner": 1, "gym_env_vectorize_mode": "SYNC", "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "episodes_to_numpy": true, "max_requests_in_flight_per_env_runner": 1, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "merge_env_runner_states": "training_only", "broadcast_env_runner_states": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "complete_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "sampler_perf_stats_ema_coef": null, "_is_online": true, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": "auto", "num_aggregator_actors_per_learner": 0, "max_requests_in_flight_per_aggregator_actor": 3, "local_gpu_idx": 0, "max_requests_in_flight_per_learner": 3, "gamma": 1, "lr": 0.0577875573446, "grad_clip": 0.5, "grad_clip_by": "global_norm", "_train_batch_size_per_learner": 5000, "train_batch_size": 4000, "num_epochs": 1, "minibatch_size": 1000, "shuffle_batch_per_epoch": true, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "log_std_clip_param": 20.0, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "_disable_preprocessor_api": false, "_disable_action_flattening": false}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "_learner_class": null, "callbacks_on_algorithm_init": null, "callbacks_on_env_runners_recreated": null, "callbacks_on_offline_eval_runners_recreated": null, "callbacks_on_checkpoint_loaded": null, "callbacks_on_environment_created": null, "callbacks_on_episode_created": null, "callbacks_on_episode_start": null, "callbacks_on_episode_step": null, "callbacks_on_episode_end": null, "callbacks_on_evaluate_start": null, "callbacks_on_evaluate_end": null, "callbacks_on_evaluate_offline_start": null, "callbacks_on_evaluate_offline_end": null, "callbacks_on_sample_end": null, "callbacks_on_train_result": null, "explore": true, "enable_rl_module_and_learner": true, "enable_env_runner_and_connector_v2": true, "_prior_exploration_config": {"type": "StochasticSampling"}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7985c431aac0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "offline_data_class": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_read_batch_size": null, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "materialize_data": false, "materialize_mapped_data": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "ignore_final_observation": false, "prelearner_class": null, "prelearner_buffer_class": null, "prelearner_buffer_kwargs": {}, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_remaining_data": false, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": 1, "evaluation_duration": 20, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_auto_duration_min_env_steps_per_sample": 100, "evaluation_auto_duration_max_env_steps_per_sample": 2000, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 1, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "offline_evaluation_interval": null, "num_offline_eval_runners": 0, "offline_loss_for_module_fn": null, "offline_evaluation_duration": 1, "offline_evaluation_parallel_to_training": false, "offline_evaluation_timeout_s": 120.0, "num_cpus_per_offline_eval_runner": 1, "num_gpus_per_offline_eval_runner": 0, "custom_resources_per_offline_eval_runner": {}, "restart_failed_offline_eval_runners": true, "ignore_offline_eval_runner_failures": false, "max_num_offline_eval_runner_restarts": 1000, "offline_eval_runner_restore_timeout_s": 1800.0, "max_requests_in_flight_per_offline_eval_runner": 1, "validate_offline_eval_runners_after_construction": true, "offline_eval_runner_health_probe_timeout_s": 30.0, "offline_eval_rl_module_inference_only": false, "broadcast_offline_eval_runner_states": false, "offline_eval_batch_size_per_runner": 256, "dataset_num_iters_per_eval_runner": 1, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "log_gradients": true, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 42, "restart_failed_env_runners": true, "ignore_env_runner_failures": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30.0, "env_runner_restore_timeout_s": 1800.0, "_model_config": {}, "_rl_module_spec": "RLModuleSpec(module_class=None, observation_space=None, action_space=None, inference_only=False, learner_only=False, model_config=DefaultModelConfig(fcnet_hiddens=[124, 66], fcnet_activation='tanh', fcnet_kernel_initializer=None, fcnet_kernel_initializer_kwargs=None, fcnet_bias_initializer=None, fcnet_bias_initializer_kwargs=None, conv_filters=None, conv_activation='relu', conv_kernel_initializer=None, conv_kernel_initializer_kwargs=None, conv_bias_initializer=None, conv_bias_initializer_kwargs=None, head_fcnet_hiddens=[], head_fcnet_activation='relu', head_fcnet_kernel_initializer=None, head_fcnet_kernel_initializer_kwargs=None, head_fcnet_bias_initializer=None, head_fcnet_bias_initializer_kwargs=None, free_log_std=False, log_std_clip_param=20.0, vf_share_layers=True, use_lstm=False, max_seq_len=20, lstm_cell_size=256, lstm_use_prev_action=False, lstm_use_prev_reward=False, lstm_kernel_initializer=None, lstm_kernel_initializer_kwargs=None, lstm_bias_initializer=None, lstm_bias_initializer_kwargs=None), catalog_class=None, load_state_path=None, model_config_dict=None)", "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "_validate_config": true, "_use_msgpack_checkpoints": false, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "env_task_fn": -1, "enable_connectors": -1, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2897992699974, "kl_target": 0.0207555480921, "vf_loss_coeff": 0.8612260576308, "entropy_coeff": 0.0215908733273, "clip_param": 0.2712648583756, "vf_clip_param": 0.4179245214167, "entropy_coeff_schedule": null, "lr_schedule": null, "sgd_minibatch_size": -1, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9219590679041, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.callbacks.callbacks.RLlibCallback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 29.60294771194458, "iterations_since_restore": 6, "perf": {"cpu_util_percent": 12.285714285714286, "ram_util_percent": 89.70000000000002}}
{"timers": {"training_iteration": 4.230553344501086, "restore_env_runners": 1.5086720546415591e-05, "training_step": 4.230263046889452, "env_runner_sampling_timer": 3.812205361193177, "learner_update_timer": 0.414667305938713, "synch_weights": 0.0014052930403450846, "restore_eval_env_runners": 1.3985431694032596e-05, "evaluation_iteration": 0.7505622391224092, "synch_eval_env_connectors": 0.0003783611703592401, "synch_env_connectors": 8.148763253399201e-06}, "env_runners": {"episode_len_max": 50, "sample": 0.037639308722875645, "num_episodes": 100.0, "agent_episode_returns_mean": {"default_agent": -4.7}, "module_to_env_connector": {"timers": {"connectors": {"tensor_to_numpy": 4.894921407214556e-05, "un_batch_to_individual_items": 1.4904718479939992e-05, "remove_single_ts_time_rank_from_batch": 1.5096354087223906e-06, "get_actions": 0.00016430470485134205, "normalize_and_clip_actions": 2.2303408085405847e-05, "listify_data_for_vector_env": 3.0162362079549496e-05}}, "connector_pipeline_timer": 0.00035817970237951363}, "env_to_module_connector": {"timers": {"connectors": {"add_time_dim_to_batch_and_zero_pad": 6.544856370924367e-06, "numpy_to_tensor": 3.096156570748491e-05, "add_observations_from_episodes_to_batch": 6.45384449187051e-06, "batch_individual_items": 1.8324592488008243e-05, "add_states_from_episodes_to_batch": 3.472825059771165e-06}}, "connector_pipeline_timer": 0.00011892955721842122}, "num_env_steps_sampled_lifetime": -1202500.0, "time_between_sampling": 0.011924386364297353, "episode_return_mean": -4.7, "env_reset_timer": 9.434838762110299e-05, "episode_duration_sec_mean": 0.03631098861000737, "weights_seq_no": 6.0, "num_module_steps_sampled_lifetime": {"default_policy": -1202500.0}, "num_agent_steps_sampled_lifetime": {"default_agent": -1202500.0}, "env_to_module_sum_episodes_length_out": 27.16809333212661, "episode_len_min": 50, "rlmodule_inference_timer": 0.00010065721584965389, "episode_return_max": 14.5, "num_episodes_lifetime": -24050.0, "module_episode_returns_mean": {"default_policy": -4.7}, "num_env_steps_sampled": 5000.0, "num_module_steps_sampled": {"default_policy": 5000.0}, "env_step_timer": 4.259707894376088e-05, "num_agent_steps_sampled": {"default_agent": 5000.0}, "episode_len_mean": 50.0, "env_to_module_sum_episodes_length_in": 27.16809333212661, "episode_return_min": -5.5, "num_env_steps_sampled_lifetime_throughput": 1284.9465401105665}, "learners": {"__all_modules__": {"learner_connector": {"timers": {"connectors": {"general_advantage_estimation": 0.013245166420546817, "add_observations_from_episodes_to_batch": 0.0007754101533652281, "add_time_dim_to_batch_and_zero_pad": 2.7107043163159163e-05, "add_columns_from_episodes_to_train_batch": 0.06969319847624293, "add_one_ts_to_episodes_and_truncate": 0.00847493593510519, "add_states_from_episodes_to_batch": 6.214683121977055e-06, "numpy_to_tensor": 0.00016568878688945877, "batch_individual_items": 0.20278864367769286}}, "connector_pipeline_timer": 0.2955523328555177}, "num_module_steps_trained_lifetime": 42000, "num_env_steps_trained": 30600, "num_module_steps_trained": 6000, "num_non_trainable_parameters": 0, "learner_connector_sum_episodes_length_in": 5000.0, "num_trainable_parameters": 8947, "learner_connector_sum_episodes_length_out": 5100.0, "num_env_steps_trained_lifetime": 214200, "num_env_steps_trained_lifetime_throughput": 871365.1026834145, "num_module_steps_trained_throughput": 171146.79096671118, "num_module_steps_trained_lifetime_throughput": 171193.3740042076}, "default_policy": {"vf_loss": 0.32962942123413086, "entropy": 0.5888758301734924, "module_train_batch_size_mean": 1000.0, "num_trainable_parameters": 8947, "gradients_default_optimizer_global_norm": 2.693652629852295, "policy_loss": 0.12652726471424103, "curr_entropy_coeff": 0.0215908733273, "vf_loss_unclipped": 1.4205124378204346, "mean_kl_loss": 0.12840771675109863, "weights_seq_no": 7.0, "num_module_steps_trained_lifetime": 42000, "vf_explained_var": 0.904095470905304, "curr_kl_coeff": 1.4671087265014648, "default_optimizer_learning_rate": 0.0577875573446, "num_module_steps_trained": 6000, "total_loss": 0.5232904553413391, "diff_num_grad_updates_vs_sampler_policy": 1.0, "num_module_steps_trained_lifetime_throughput": 171360.52871129254}}, "num_training_step_calls_per_iteration": 1, "evaluation": {"env_runners": {"env_to_module_connector": {"timers": {"connectors": {"add_time_dim_to_batch_and_zero_pad": 6.0499238130276406e-06, "add_states_from_episodes_to_batch": 3.804731843043088e-06, "add_observations_from_episodes_to_batch": 6.9620790387550166e-06, "numpy_to_tensor": 3.263986331863852e-05, "batch_individual_items": 2.075817397338554e-05}}, "connector_pipeline_timer": 0.000131671072714787}, "env_reset_timer": 0.00033628074638946103, "episode_return_mean": 0.9, "env_to_module_sum_episodes_length_out": 27.168093332126602, "num_episodes_lifetime": 140, "env_step_timer": 4.724054166228888e-05, "episode_len_mean": 50.0, "env_to_module_sum_episodes_length_in": 27.168093332126602, "module_to_env_connector": {"timers": {"connectors": {"un_batch_to_individual_items": 1.618835269639584e-05, "listify_data_for_vector_env": 3.415813740455405e-05, "tensor_to_numpy": 4.893558748889994e-05, "get_actions": 0.00016891355891199636, "remove_single_ts_time_rank_from_batch": 1.6620585231860416e-06, "normalize_and_clip_actions": 2.4712137140031417e-05}}, "connector_pipeline_timer": 0.00037311344011876874}, "num_episodes": 20, "num_env_steps_sampled_lifetime": 36000, "agent_episode_returns_mean": {"default_agent": 0.9}, "rlmodule_inference_timer": 0.00010561541491854306, "episode_return_max": 17.5, "num_module_steps_sampled_lifetime": {"default_policy": 7000}, "sample": 0.7389520235658708, "episode_duration_sec_mean": 0.03444898641999089, "weights_seq_no": 7.0, "episode_len_min": 50, "num_agent_steps_sampled_lifetime": {"default_agent": 7000}, "num_module_steps_sampled": {"default_policy": 1000}, "episode_return_min": -16.5, "module_episode_returns_mean": {"default_policy": 0.9}, "num_env_steps_sampled": 1000, "episode_len_max": 50, "num_agent_steps_sampled": {"default_agent": 1000}, "time_between_sampling": 4.147895708430391}, "num_healthy_workers": 1, "actor_manager_num_outstanding_async_reqs": 0, "num_remote_worker_restarts": 0}, "num_env_steps_sampled_lifetime": -1202500.0, "fault_tolerance": {"num_healthy_workers": 0, "num_remote_worker_restarts": 0}, "env_runner_group": {"actor_manager_num_outstanding_async_reqs": 0}, "done": true, "training_iteration": 7, "trial_id": "471b3_00000", "date": "2025-08-11_16-31-31", "timestamp": 1754922691, "time_this_iter_s": 4.818454742431641, "time_total_s": 34.42140245437622, "pid": 29544, "hostname": "DESKTOP-3SK5A41", "node_ip": "192.168.40.242", "config": {"exploration_config": {}, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 6, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "env": "Umbrella", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": false, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 0, "create_local_env_runner": true, "num_envs_per_env_runner": 1, "gym_env_vectorize_mode": "SYNC", "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "episodes_to_numpy": true, "max_requests_in_flight_per_env_runner": 1, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "merge_env_runner_states": "training_only", "broadcast_env_runner_states": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "complete_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "sampler_perf_stats_ema_coef": null, "_is_online": true, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": "auto", "num_aggregator_actors_per_learner": 0, "max_requests_in_flight_per_aggregator_actor": 3, "local_gpu_idx": 0, "max_requests_in_flight_per_learner": 3, "gamma": 1, "lr": 0.0577875573446, "grad_clip": 0.5, "grad_clip_by": "global_norm", "_train_batch_size_per_learner": 5000, "train_batch_size": 4000, "num_epochs": 1, "minibatch_size": 1000, "shuffle_batch_per_epoch": true, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "log_std_clip_param": 20.0, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "_disable_preprocessor_api": false, "_disable_action_flattening": false}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "_learner_class": null, "callbacks_on_algorithm_init": null, "callbacks_on_env_runners_recreated": null, "callbacks_on_offline_eval_runners_recreated": null, "callbacks_on_checkpoint_loaded": null, "callbacks_on_environment_created": null, "callbacks_on_episode_created": null, "callbacks_on_episode_start": null, "callbacks_on_episode_step": null, "callbacks_on_episode_end": null, "callbacks_on_evaluate_start": null, "callbacks_on_evaluate_end": null, "callbacks_on_evaluate_offline_start": null, "callbacks_on_evaluate_offline_end": null, "callbacks_on_sample_end": null, "callbacks_on_train_result": null, "explore": true, "enable_rl_module_and_learner": true, "enable_env_runner_and_connector_v2": true, "_prior_exploration_config": {"type": "StochasticSampling"}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7985c431aac0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "offline_data_class": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_read_batch_size": null, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "materialize_data": false, "materialize_mapped_data": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "ignore_final_observation": false, "prelearner_class": null, "prelearner_buffer_class": null, "prelearner_buffer_kwargs": {}, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_remaining_data": false, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": 1, "evaluation_duration": 20, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_auto_duration_min_env_steps_per_sample": 100, "evaluation_auto_duration_max_env_steps_per_sample": 2000, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 1, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "offline_evaluation_interval": null, "num_offline_eval_runners": 0, "offline_loss_for_module_fn": null, "offline_evaluation_duration": 1, "offline_evaluation_parallel_to_training": false, "offline_evaluation_timeout_s": 120.0, "num_cpus_per_offline_eval_runner": 1, "num_gpus_per_offline_eval_runner": 0, "custom_resources_per_offline_eval_runner": {}, "restart_failed_offline_eval_runners": true, "ignore_offline_eval_runner_failures": false, "max_num_offline_eval_runner_restarts": 1000, "offline_eval_runner_restore_timeout_s": 1800.0, "max_requests_in_flight_per_offline_eval_runner": 1, "validate_offline_eval_runners_after_construction": true, "offline_eval_runner_health_probe_timeout_s": 30.0, "offline_eval_rl_module_inference_only": false, "broadcast_offline_eval_runner_states": false, "offline_eval_batch_size_per_runner": 256, "dataset_num_iters_per_eval_runner": 1, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "log_gradients": true, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 42, "restart_failed_env_runners": true, "ignore_env_runner_failures": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30.0, "env_runner_restore_timeout_s": 1800.0, "_model_config": {}, "_rl_module_spec": "RLModuleSpec(module_class=None, observation_space=None, action_space=None, inference_only=False, learner_only=False, model_config=DefaultModelConfig(fcnet_hiddens=[124, 66], fcnet_activation='tanh', fcnet_kernel_initializer=None, fcnet_kernel_initializer_kwargs=None, fcnet_bias_initializer=None, fcnet_bias_initializer_kwargs=None, conv_filters=None, conv_activation='relu', conv_kernel_initializer=None, conv_kernel_initializer_kwargs=None, conv_bias_initializer=None, conv_bias_initializer_kwargs=None, head_fcnet_hiddens=[], head_fcnet_activation='relu', head_fcnet_kernel_initializer=None, head_fcnet_kernel_initializer_kwargs=None, head_fcnet_bias_initializer=None, head_fcnet_bias_initializer_kwargs=None, free_log_std=False, log_std_clip_param=20.0, vf_share_layers=True, use_lstm=False, max_seq_len=20, lstm_cell_size=256, lstm_use_prev_action=False, lstm_use_prev_reward=False, lstm_kernel_initializer=None, lstm_kernel_initializer_kwargs=None, lstm_bias_initializer=None, lstm_bias_initializer_kwargs=None), catalog_class=None, load_state_path=None, model_config_dict=None)", "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "_validate_config": true, "_use_msgpack_checkpoints": false, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "env_task_fn": -1, "enable_connectors": -1, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2897992699974, "kl_target": 0.0207555480921, "vf_loss_coeff": 0.8612260576308, "entropy_coeff": 0.0215908733273, "clip_param": 0.2712648583756, "vf_clip_param": 0.4179245214167, "entropy_coeff_schedule": null, "lr_schedule": null, "sgd_minibatch_size": -1, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9219590679041, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.callbacks.callbacks.RLlibCallback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 34.42140245437622, "iterations_since_restore": 7, "perf": {"cpu_util_percent": 12.442857142857145, "ram_util_percent": 89.75714285714285}}
