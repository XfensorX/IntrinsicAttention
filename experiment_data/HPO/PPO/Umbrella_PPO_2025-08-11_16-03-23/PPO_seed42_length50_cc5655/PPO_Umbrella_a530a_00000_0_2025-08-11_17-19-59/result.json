{"timers": {"training_iteration": 4.300826001999667, "restore_env_runners": 1.4700000065204222e-05, "training_step": 4.300607002000106, "env_runner_sampling_timer": 3.836935402000563, "learner_update_timer": 0.460095999999794, "synch_weights": 0.0016054999996413244}, "env_runners": {"env_to_module_sum_episodes_length_in": 26.762340024562445, "episode_return_min": -5.5, "weights_seq_no": 0.0, "num_episodes_lifetime": 5050.0, "num_episodes": 100.0, "rlmodule_inference_timer": 0.00010288837905820957, "env_reset_timer": 0.0002071771848784891, "num_module_steps_sampled_lifetime": {"default_policy": 252500.0}, "env_to_module_connector": {"timers": {"connectors": {"add_observations_from_episodes_to_batch": 6.348607310076848e-06, "numpy_to_tensor": 3.122399071775342e-05, "add_time_dim_to_batch_and_zero_pad": 6.518964698303167e-06, "batch_individual_items": 1.8650155197970502e-05, "add_states_from_episodes_to_batch": 3.490896726559856e-06}}, "connector_pipeline_timer": 0.00012118118619111875}, "time_between_sampling": 0.0012757908956891146, "module_to_env_connector": {"timers": {"connectors": {"get_actions": 0.00016885786198814936, "un_batch_to_individual_items": 1.5011345365422808e-05, "normalize_and_clip_actions": 2.774358687102057e-05, "tensor_to_numpy": 4.835821765377295e-05, "remove_single_ts_time_rank_from_batch": 1.6075850176061775e-06, "listify_data_for_vector_env": 3.089380993683499e-05}}, "connector_pipeline_timer": 0.00036939438996174946}, "num_env_steps_sampled_lifetime": 252500.0, "episode_len_max": 50, "episode_return_mean": 5.700000000000004, "agent_episode_returns_mean": {"default_agent": 5.700000000000004}, "env_step_timer": 4.420254640225686e-05, "episode_len_mean": 50.0, "module_episode_returns_mean": {"default_policy": 5.700000000000004}, "num_env_steps_sampled": 5000.0, "episode_return_max": 14.5, "env_to_module_sum_episodes_length_out": 26.762340024562445, "num_agent_steps_sampled": {"default_agent": 5000.0}, "num_agent_steps_sampled_lifetime": {"default_agent": 252500.0}, "episode_duration_sec_mean": 0.03587756302000343, "num_module_steps_sampled": {"default_policy": 5000.0}, "episode_len_min": 50, "sample": 0.03932603849268195, "num_env_steps_sampled_lifetime_throughput": 1264.9028552475677}, "learners": {"default_policy": {"vf_loss": 0.29474082589149475, "num_module_steps_trained_lifetime": 16000, "policy_loss": 0.02075767330825329, "gradients_default_optimizer_global_norm": 0.21023955941200256, "num_module_steps_trained": 16000, "default_optimizer_learning_rate": 0.0049847823121, "curr_kl_coeff": 0.3275754451751709, "vf_explained_var": 0.1836065649986267, "mean_kl_loss": 0.0008589954231865704, "total_loss": 0.2358766794204712, "curr_entropy_coeff": 0.0132828111413, "module_train_batch_size_mean": 1000.0, "entropy": 0.6917760968208313, "diff_num_grad_updates_vs_sampler_policy": 1.0, "vf_loss_unclipped": 10.60750961303711, "weights_seq_no": 1.0, "num_trainable_parameters": 3731, "num_module_steps_trained_lifetime_throughput": 223724.8432230664}, "__all_modules__": {"learner_connector": {"timers": {"connectors": {"numpy_to_tensor": 0.00016960000084509375, "batch_individual_items": 0.2056695999999647, "add_observations_from_episodes_to_batch": 0.0009523999997327337, "add_one_ts_to_episodes_and_truncate": 0.008557900000596419, "add_columns_from_episodes_to_train_batch": 0.0727694999995947, "general_advantage_estimation": 0.01118300000052841, "add_states_from_episodes_to_batch": 6.199999916134402e-06, "add_time_dim_to_batch_and_zero_pad": 2.3399999918183312e-05}}, "connector_pipeline_timer": 0.2996615000001839}, "learner_connector_sum_episodes_length_out": 5100, "num_env_steps_trained_lifetime": 81600, "learner_connector_sum_episodes_length_in": 5000, "num_trainable_parameters": 3731, "num_module_steps_trained": 16000, "num_module_steps_trained_lifetime": 16000, "num_non_trainable_parameters": 0, "num_env_steps_trained": 81600, "num_env_steps_trained_lifetime_throughput": 1134659.5274761133, "num_module_steps_trained_throughput": 223253.24548449885, "num_module_steps_trained_lifetime_throughput": 223065.92126046744}}, "num_training_step_calls_per_iteration": 1, "num_env_steps_sampled_lifetime": 252500.0, "evaluation": {"env_runners": {"episode_duration_sec_mean": 0.03468066500008717, "episode_len_min": 50, "num_env_steps_sampled": 1000, "num_agent_steps_sampled": {"default_agent": 1000}, "num_episodes_lifetime": 20, "env_reset_timer": 0.00022340000032272656, "num_agent_steps_sampled_lifetime": {"default_agent": 1000}, "rlmodule_inference_timer": 9.332366789969727e-05, "episode_return_mean": -3.9, "episode_len_mean": 50.0, "env_to_module_connector": {"timers": {"connectors": {"add_states_from_episodes_to_batch": 3.235681977029454e-06, "add_time_dim_to_batch_and_zero_pad": 5.323523665129867e-06, "numpy_to_tensor": 2.9545177581578605e-05, "batch_individual_items": 1.8322986398844998e-05, "add_observations_from_episodes_to_batch": 6.291359388266944e-06}}, "connector_pipeline_timer": 0.0001111906149982983}, "agent_episode_returns_mean": {"default_agent": -3.9}, "env_to_module_sum_episodes_length_out": 27.167134025045954, "module_episode_returns_mean": {"default_policy": -3.9}, "sample": 0.722768300000098, "env_to_module_sum_episodes_length_in": 27.167134025045954, "num_episodes": 20, "num_module_steps_sampled": {"default_policy": 1000}, "module_to_env_connector": {"timers": {"connectors": {"un_batch_to_individual_items": 1.565169104627578e-05, "get_actions": 0.00015659966173982558, "normalize_and_clip_actions": 2.204050425498846e-05, "tensor_to_numpy": 4.644499054236399e-05, "remove_single_ts_time_rank_from_batch": 1.4392620719019906e-06, "listify_data_for_vector_env": 3.093336058235899e-05}}, "connector_pipeline_timer": 0.00034454180376383014}, "episode_len_max": 50, "env_step_timer": 4.255417364188458e-05, "episode_return_max": 13.5, "weights_seq_no": 1.0, "num_env_steps_sampled_lifetime": 6000, "episode_return_min": -16.5, "num_module_steps_sampled_lifetime": {"default_policy": 1000}}, "num_healthy_workers": 1, "actor_manager_num_outstanding_async_reqs": 0, "num_remote_worker_restarts": 0}, "fault_tolerance": {"num_healthy_workers": 0, "num_remote_worker_restarts": 0}, "env_runner_group": {"actor_manager_num_outstanding_async_reqs": 0}, "done": false, "training_iteration": 1, "trial_id": "a530a_00000", "date": "2025-08-11_17-25-17", "timestamp": 1754925917, "time_this_iter_s": 5.038975477218628, "time_total_s": 5.038975477218628, "pid": 75896, "hostname": "DESKTOP-3SK5A41", "node_ip": "192.168.40.242", "config": {"exploration_config": {}, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 6, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "env": "Umbrella", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": false, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 0, "create_local_env_runner": true, "num_envs_per_env_runner": 1, "gym_env_vectorize_mode": "SYNC", "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "episodes_to_numpy": true, "max_requests_in_flight_per_env_runner": 1, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "merge_env_runner_states": "training_only", "broadcast_env_runner_states": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "complete_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "sampler_perf_stats_ema_coef": null, "_is_online": true, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": "auto", "num_aggregator_actors_per_learner": 0, "max_requests_in_flight_per_aggregator_actor": 3, "local_gpu_idx": 0, "max_requests_in_flight_per_learner": 3, "gamma": 1, "lr": 0.0049847823121, "grad_clip": 0.5, "grad_clip_by": "global_norm", "_train_batch_size_per_learner": 5000, "train_batch_size": 4000, "num_epochs": 3, "minibatch_size": 1000, "shuffle_batch_per_epoch": true, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "log_std_clip_param": 20.0, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "_disable_preprocessor_api": false, "_disable_action_flattening": false}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "_learner_class": null, "callbacks_on_algorithm_init": null, "callbacks_on_env_runners_recreated": null, "callbacks_on_offline_eval_runners_recreated": null, "callbacks_on_checkpoint_loaded": null, "callbacks_on_environment_created": null, "callbacks_on_episode_created": null, "callbacks_on_episode_start": null, "callbacks_on_episode_step": null, "callbacks_on_episode_end": null, "callbacks_on_evaluate_start": null, "callbacks_on_evaluate_end": null, "callbacks_on_evaluate_offline_start": null, "callbacks_on_evaluate_offline_end": null, "callbacks_on_sample_end": null, "callbacks_on_train_result": null, "explore": true, "enable_rl_module_and_learner": true, "enable_env_runner_and_connector_v2": true, "_prior_exploration_config": {"type": "StochasticSampling"}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7f44639f2ac0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "offline_data_class": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_read_batch_size": null, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "materialize_data": false, "materialize_mapped_data": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "ignore_final_observation": false, "prelearner_class": null, "prelearner_buffer_class": null, "prelearner_buffer_kwargs": {}, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_remaining_data": false, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": 1, "evaluation_duration": 20, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_auto_duration_min_env_steps_per_sample": 100, "evaluation_auto_duration_max_env_steps_per_sample": 2000, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 1, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "offline_evaluation_interval": null, "num_offline_eval_runners": 0, "offline_loss_for_module_fn": null, "offline_evaluation_duration": 1, "offline_evaluation_parallel_to_training": false, "offline_evaluation_timeout_s": 120.0, "num_cpus_per_offline_eval_runner": 1, "num_gpus_per_offline_eval_runner": 0, "custom_resources_per_offline_eval_runner": {}, "restart_failed_offline_eval_runners": true, "ignore_offline_eval_runner_failures": false, "max_num_offline_eval_runner_restarts": 1000, "offline_eval_runner_restore_timeout_s": 1800.0, "max_requests_in_flight_per_offline_eval_runner": 1, "validate_offline_eval_runners_after_construction": true, "offline_eval_runner_health_probe_timeout_s": 30.0, "offline_eval_rl_module_inference_only": false, "broadcast_offline_eval_runner_states": false, "offline_eval_batch_size_per_runner": 256, "dataset_num_iters_per_eval_runner": 1, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "log_gradients": true, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 42, "restart_failed_env_runners": true, "ignore_env_runner_failures": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30.0, "env_runner_restore_timeout_s": 1800.0, "_model_config": {}, "_rl_module_spec": "RLModuleSpec(module_class=None, observation_space=None, action_space=None, inference_only=False, learner_only=False, model_config=DefaultModelConfig(fcnet_hiddens=[68, 48], fcnet_activation='tanh', fcnet_kernel_initializer=None, fcnet_kernel_initializer_kwargs=None, fcnet_bias_initializer=None, fcnet_bias_initializer_kwargs=None, conv_filters=None, conv_activation='relu', conv_kernel_initializer=None, conv_kernel_initializer_kwargs=None, conv_bias_initializer=None, conv_bias_initializer_kwargs=None, head_fcnet_hiddens=[], head_fcnet_activation='relu', head_fcnet_kernel_initializer=None, head_fcnet_kernel_initializer_kwargs=None, head_fcnet_bias_initializer=None, head_fcnet_bias_initializer_kwargs=None, free_log_std=False, log_std_clip_param=20.0, vf_share_layers=True, use_lstm=False, max_seq_len=20, lstm_cell_size=256, lstm_use_prev_action=False, lstm_use_prev_reward=False, lstm_kernel_initializer=None, lstm_kernel_initializer_kwargs=None, lstm_bias_initializer=None, lstm_bias_initializer_kwargs=None), catalog_class=None, load_state_path=None, model_config_dict=None)", "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "_validate_config": true, "_use_msgpack_checkpoints": false, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "env_task_fn": -1, "enable_connectors": -1, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.6551508793305, "kl_target": 0.018007117439, "vf_loss_coeff": 0.7591243664964, "entropy_coeff": 0.0132828111413, "clip_param": 0.1193136467235, "vf_clip_param": 0.3889481243011, "entropy_coeff_schedule": null, "lr_schedule": null, "sgd_minibatch_size": -1, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9141150497384, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.callbacks.callbacks.RLlibCallback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 5.038975477218628, "iterations_since_restore": 1, "perf": {"cpu_util_percent": 24.125, "ram_util_percent": 87.6625}}
{"timers": {"training_iteration": 4.299261550999662, "restore_env_runners": 1.4683000063087092e-05, "training_step": 4.299040925000108, "env_runner_sampling_timer": 3.837595007990558, "learner_update_timer": 0.4578689540097912, "synch_weights": 0.0016034139996463637, "restore_eval_env_runners": 1.4000000192027073e-05, "evaluation_iteration": 0.7351414999993722, "synch_eval_env_connectors": 0.00044489999982033623, "synch_env_connectors": 9.899999895424116e-06}, "env_runners": {"env_to_module_sum_episodes_length_in": 27.16809333212661, "episode_return_min": -5.5, "weights_seq_no": 1.0, "num_episodes_lifetime": 200.0, "num_episodes": 100.0, "rlmodule_inference_timer": 0.00010040302110330481, "env_reset_timer": 0.000136873270433753, "num_module_steps_sampled_lifetime": {"default_policy": 10000.0}, "env_to_module_connector": {"timers": {"connectors": {"add_observations_from_episodes_to_batch": 6.191180315438735e-06, "numpy_to_tensor": 3.116110069994359e-05, "add_time_dim_to_batch_and_zero_pad": 6.356405726801038e-06, "batch_individual_items": 1.8545200858141788e-05, "add_states_from_episodes_to_batch": 3.4838099639976047e-06}}, "connector_pipeline_timer": 0.00011824042739853724}, "time_between_sampling": 0.009235498243673368, "module_to_env_connector": {"timers": {"connectors": {"get_actions": 0.00016579819950125822, "un_batch_to_individual_items": 1.4859718386961112e-05, "normalize_and_clip_actions": 2.2095340006615122e-05, "tensor_to_numpy": 4.9652551891473905e-05, "remove_single_ts_time_rank_from_batch": 1.6150154206809165e-06, "listify_data_for_vector_env": 3.083658626095756e-05}}, "connector_pipeline_timer": 0.000361503184819054}, "num_env_steps_sampled_lifetime": 10000.0, "episode_len_max": 50, "episode_return_mean": 4.5, "agent_episode_returns_mean": {"default_agent": 4.5}, "env_step_timer": 4.333325622047021e-05, "episode_len_mean": 50.0, "module_episode_returns_mean": {"default_policy": 4.5}, "num_env_steps_sampled": 5000.0, "episode_return_max": 14.5, "env_to_module_sum_episodes_length_out": 27.16809333212661, "num_agent_steps_sampled": {"default_agent": 5000.0}, "num_agent_steps_sampled_lifetime": {"default_agent": 10000.0}, "episode_duration_sec_mean": 0.03649947100001555, "num_module_steps_sampled": {"default_policy": 5000.0}, "episode_len_min": 50, "sample": 0.038109198336770504, "num_env_steps_sampled_lifetime_throughput": 1282.1158908365244}, "learners": {"default_policy": {"vf_loss": 0.2910384237766266, "num_module_steps_trained_lifetime": 32000, "policy_loss": -0.023946546018123627, "gradients_default_optimizer_global_norm": 0.14303456246852875, "num_module_steps_trained": 16000, "default_optimizer_learning_rate": 0.0049847823121, "curr_kl_coeff": 0.16378772258758545, "vf_explained_var": 0.4430718421936035, "mean_kl_loss": 0.0006335350917652249, "total_loss": 0.18798978626728058, "curr_entropy_coeff": 0.0132828111413, "module_train_batch_size_mean": 1000.0, "entropy": 0.6930416822433472, "diff_num_grad_updates_vs_sampler_policy": 1.0, "vf_loss_unclipped": 8.379265785217285, "weights_seq_no": 2.0, "num_trainable_parameters": 3731, "num_module_steps_trained_lifetime_throughput": 222348.3178191831}, "__all_modules__": {"learner_connector": {"timers": {"connectors": {"numpy_to_tensor": 0.00016962000083367457, "batch_individual_items": 0.20419685699996082, "add_observations_from_episodes_to_batch": 0.0009496069997385348, "add_one_ts_to_episodes_and_truncate": 0.008555613000589801, "add_columns_from_episodes_to_train_batch": 0.07272153100959258, "general_advantage_estimation": 0.01117439700052273, "add_states_from_episodes_to_batch": 6.203999910212588e-06, "add_time_dim_to_batch_and_zero_pad": 2.3401999924317353e-05}}, "connector_pipeline_timer": 0.2981272060101855}, "learner_connector_sum_episodes_length_out": 5100.0, "num_env_steps_trained_lifetime": 163200, "learner_connector_sum_episodes_length_in": 5000.0, "num_trainable_parameters": 3731, "num_module_steps_trained": 16000, "num_module_steps_trained_lifetime": 32000, "num_non_trainable_parameters": 0, "num_env_steps_trained": 81600, "num_env_steps_trained_lifetime_throughput": 1127825.839972398, "num_module_steps_trained_throughput": 221892.7813475463, "num_module_steps_trained_lifetime_throughput": 221710.61382735363}}, "num_training_step_calls_per_iteration": 1, "evaluation": {"env_runners": {"episode_duration_sec_mean": 0.03453408750001472, "episode_len_min": 50, "num_env_steps_sampled": 1000, "num_agent_steps_sampled": {"default_agent": 1000}, "num_episodes_lifetime": 40, "env_reset_timer": 0.0002225070003169094, "num_agent_steps_sampled_lifetime": {"default_agent": 2000}, "rlmodule_inference_timer": 8.973344037434763e-05, "episode_return_mean": -1.9, "episode_len_mean": 50.0, "env_to_module_connector": {"timers": {"connectors": {"add_states_from_episodes_to_batch": 3.1176080730769665e-06, "add_time_dim_to_batch_and_zero_pad": 5.2685641945883476e-06, "numpy_to_tensor": 2.8936294782081146e-05, "batch_individual_items": 1.855619422382566e-05, "add_observations_from_episodes_to_batch": 6.25325979401189e-06}}, "connector_pipeline_timer": 0.00011075297923952198}, "agent_episode_returns_mean": {"default_agent": -1.9}, "env_to_module_sum_episodes_length_out": 27.168093298253442, "module_episode_returns_mean": {"default_policy": -1.9}, "sample": 0.7226988280000932, "env_to_module_sum_episodes_length_in": 27.168093298253442, "num_episodes": 20, "num_module_steps_sampled": {"default_policy": 1000}, "module_to_env_connector": {"timers": {"connectors": {"un_batch_to_individual_items": 1.535346990781235e-05, "get_actions": 0.00015154315347017369, "normalize_and_clip_actions": 2.2585312994882113e-05, "tensor_to_numpy": 4.475428743209056e-05, "remove_single_ts_time_rank_from_batch": 1.399526404518817e-06, "listify_data_for_vector_env": 3.05599368341216e-05}}, "connector_pipeline_timer": 0.00033703971464402427}, "episode_len_max": 50, "env_step_timer": 4.180310004498702e-05, "episode_return_max": 17.5, "weights_seq_no": 2.0, "num_env_steps_sampled_lifetime": 11000, "episode_return_min": -16.5, "num_module_steps_sampled_lifetime": {"default_policy": 2000}, "time_between_sampling": 4.200560402000519}, "num_healthy_workers": 1, "actor_manager_num_outstanding_async_reqs": 0, "num_remote_worker_restarts": 0}, "num_env_steps_sampled_lifetime": 10000.0, "fault_tolerance": {"num_healthy_workers": 0, "num_remote_worker_restarts": 0}, "env_runner_group": {"actor_manager_num_outstanding_async_reqs": 0}, "done": false, "training_iteration": 2, "trial_id": "a530a_00000", "date": "2025-08-11_17-25-22", "timestamp": 1754925922, "time_this_iter_s": 4.874479055404663, "time_total_s": 9.913454532623291, "pid": 75896, "hostname": "DESKTOP-3SK5A41", "node_ip": "192.168.40.242", "config": {"exploration_config": {}, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 6, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "env": "Umbrella", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": false, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 0, "create_local_env_runner": true, "num_envs_per_env_runner": 1, "gym_env_vectorize_mode": "SYNC", "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "episodes_to_numpy": true, "max_requests_in_flight_per_env_runner": 1, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "merge_env_runner_states": "training_only", "broadcast_env_runner_states": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "complete_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "sampler_perf_stats_ema_coef": null, "_is_online": true, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": "auto", "num_aggregator_actors_per_learner": 0, "max_requests_in_flight_per_aggregator_actor": 3, "local_gpu_idx": 0, "max_requests_in_flight_per_learner": 3, "gamma": 1, "lr": 0.0049847823121, "grad_clip": 0.5, "grad_clip_by": "global_norm", "_train_batch_size_per_learner": 5000, "train_batch_size": 4000, "num_epochs": 3, "minibatch_size": 1000, "shuffle_batch_per_epoch": true, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "log_std_clip_param": 20.0, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "_disable_preprocessor_api": false, "_disable_action_flattening": false}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "_learner_class": null, "callbacks_on_algorithm_init": null, "callbacks_on_env_runners_recreated": null, "callbacks_on_offline_eval_runners_recreated": null, "callbacks_on_checkpoint_loaded": null, "callbacks_on_environment_created": null, "callbacks_on_episode_created": null, "callbacks_on_episode_start": null, "callbacks_on_episode_step": null, "callbacks_on_episode_end": null, "callbacks_on_evaluate_start": null, "callbacks_on_evaluate_end": null, "callbacks_on_evaluate_offline_start": null, "callbacks_on_evaluate_offline_end": null, "callbacks_on_sample_end": null, "callbacks_on_train_result": null, "explore": true, "enable_rl_module_and_learner": true, "enable_env_runner_and_connector_v2": true, "_prior_exploration_config": {"type": "StochasticSampling"}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7f44639f2ac0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "offline_data_class": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_read_batch_size": null, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "materialize_data": false, "materialize_mapped_data": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "ignore_final_observation": false, "prelearner_class": null, "prelearner_buffer_class": null, "prelearner_buffer_kwargs": {}, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_remaining_data": false, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": 1, "evaluation_duration": 20, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_auto_duration_min_env_steps_per_sample": 100, "evaluation_auto_duration_max_env_steps_per_sample": 2000, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 1, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "offline_evaluation_interval": null, "num_offline_eval_runners": 0, "offline_loss_for_module_fn": null, "offline_evaluation_duration": 1, "offline_evaluation_parallel_to_training": false, "offline_evaluation_timeout_s": 120.0, "num_cpus_per_offline_eval_runner": 1, "num_gpus_per_offline_eval_runner": 0, "custom_resources_per_offline_eval_runner": {}, "restart_failed_offline_eval_runners": true, "ignore_offline_eval_runner_failures": false, "max_num_offline_eval_runner_restarts": 1000, "offline_eval_runner_restore_timeout_s": 1800.0, "max_requests_in_flight_per_offline_eval_runner": 1, "validate_offline_eval_runners_after_construction": true, "offline_eval_runner_health_probe_timeout_s": 30.0, "offline_eval_rl_module_inference_only": false, "broadcast_offline_eval_runner_states": false, "offline_eval_batch_size_per_runner": 256, "dataset_num_iters_per_eval_runner": 1, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "log_gradients": true, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 42, "restart_failed_env_runners": true, "ignore_env_runner_failures": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30.0, "env_runner_restore_timeout_s": 1800.0, "_model_config": {}, "_rl_module_spec": "RLModuleSpec(module_class=None, observation_space=None, action_space=None, inference_only=False, learner_only=False, model_config=DefaultModelConfig(fcnet_hiddens=[68, 48], fcnet_activation='tanh', fcnet_kernel_initializer=None, fcnet_kernel_initializer_kwargs=None, fcnet_bias_initializer=None, fcnet_bias_initializer_kwargs=None, conv_filters=None, conv_activation='relu', conv_kernel_initializer=None, conv_kernel_initializer_kwargs=None, conv_bias_initializer=None, conv_bias_initializer_kwargs=None, head_fcnet_hiddens=[], head_fcnet_activation='relu', head_fcnet_kernel_initializer=None, head_fcnet_kernel_initializer_kwargs=None, head_fcnet_bias_initializer=None, head_fcnet_bias_initializer_kwargs=None, free_log_std=False, log_std_clip_param=20.0, vf_share_layers=True, use_lstm=False, max_seq_len=20, lstm_cell_size=256, lstm_use_prev_action=False, lstm_use_prev_reward=False, lstm_kernel_initializer=None, lstm_kernel_initializer_kwargs=None, lstm_bias_initializer=None, lstm_bias_initializer_kwargs=None), catalog_class=None, load_state_path=None, model_config_dict=None)", "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "_validate_config": true, "_use_msgpack_checkpoints": false, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "env_task_fn": -1, "enable_connectors": -1, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.6551508793305, "kl_target": 0.018007117439, "vf_loss_coeff": 0.7591243664964, "entropy_coeff": 0.0132828111413, "clip_param": 0.1193136467235, "vf_clip_param": 0.3889481243011, "entropy_coeff_schedule": null, "lr_schedule": null, "sgd_minibatch_size": -1, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9141150497384, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.callbacks.callbacks.RLlibCallback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 9.913454532623291, "iterations_since_restore": 2, "perf": {"cpu_util_percent": 13.585714285714285, "ram_util_percent": 87.60000000000001}}
{"timers": {"training_iteration": 4.299061594499667, "restore_env_runners": 1.4682170064588716e-05, "training_step": 4.298838807760107, "env_runner_sampling_timer": 3.8395229019206476, "learner_update_timer": 0.45572875746969294, "synch_weights": 0.001603681859653534, "restore_eval_env_runners": 1.4011000193931976e-05, "evaluation_iteration": 0.7350425919993723, "synch_eval_env_connectors": 0.00044549399981406166, "synch_env_connectors": 9.874999905150615e-06}, "env_runners": {"env_to_module_sum_episodes_length_in": 27.16809333212661, "episode_return_min": -5.5, "weights_seq_no": 2.0, "num_episodes_lifetime": -4650.0, "num_episodes": 100.0, "rlmodule_inference_timer": 0.00013422142755248898, "env_reset_timer": 0.00011038102241753004, "num_module_steps_sampled_lifetime": {"default_policy": -232500.0}, "env_to_module_connector": {"timers": {"connectors": {"add_observations_from_episodes_to_batch": 6.204947775782098e-06, "numpy_to_tensor": 3.117053333688764e-05, "add_time_dim_to_batch_and_zero_pad": 6.386092716092035e-06, "batch_individual_items": 1.8515495792975608e-05, "add_states_from_episodes_to_batch": 3.483393539092103e-06}}, "connector_pipeline_timer": 0.00011795023323355306}, "time_between_sampling": 0.010743553692509558, "module_to_env_connector": {"timers": {"connectors": {"get_actions": 0.00016565951084437182, "un_batch_to_individual_items": 1.4862012821182715e-05, "normalize_and_clip_actions": 2.195587201297622e-05, "tensor_to_numpy": 4.976705531537545e-05, "remove_single_ts_time_rank_from_batch": 1.5908575258860385e-06, "listify_data_for_vector_env": 3.084813763420163e-05}}, "connector_pipeline_timer": 0.00036093189496418093}, "num_env_steps_sampled_lifetime": -232500.0, "episode_len_max": 50, "episode_return_mean": 5.299999999999998, "agent_episode_returns_mean": {"default_agent": 5.299999999999998}, "env_step_timer": 4.339801842587725e-05, "episode_len_mean": 50.0, "module_episode_returns_mean": {"default_policy": 5.299999999999998}, "num_env_steps_sampled": 5000.0, "episode_return_max": 14.5, "env_to_module_sum_episodes_length_out": 27.16809333212661, "num_agent_steps_sampled": {"default_agent": 5000.0}, "num_agent_steps_sampled_lifetime": {"default_agent": -232500.0}, "episode_duration_sec_mean": 0.03778755001001628, "num_module_steps_sampled": {"default_policy": 5000.0}, "episode_len_min": 50, "sample": 0.03807279977106602, "num_env_steps_sampled_lifetime_throughput": 1277.410144079023}, "learners": {"default_policy": {"vf_loss": 0.27901962399482727, "num_module_steps_trained_lifetime": 48000, "policy_loss": -0.0312259029597044, "gradients_default_optimizer_global_norm": 0.10567880421876907, "num_module_steps_trained": 16000, "default_optimizer_learning_rate": 0.0049847823121, "curr_kl_coeff": 0.08189386129379272, "vf_explained_var": 0.6724816560745239, "mean_kl_loss": 0.0034244530834257603, "total_loss": 0.17198385298252106, "curr_entropy_coeff": 0.0132828111413, "module_train_batch_size_mean": 1000.0, "entropy": 0.6897404193878174, "diff_num_grad_updates_vs_sampler_policy": 1.0, "vf_loss_unclipped": 6.251914978027344, "weights_seq_no": 3.0, "num_trainable_parameters": 3731, "num_module_steps_trained_lifetime_throughput": 221087.95511847892}, "__all_modules__": {"learner_connector": {"timers": {"connectors": {"numpy_to_tensor": 0.00016981080083296546, "batch_individual_items": 0.20273009242995824, "add_observations_from_episodes_to_batch": 0.0009488029297423964, "add_one_ts_to_episodes_and_truncate": 0.008715173870587931, "add_columns_from_episodes_to_train_batch": 0.07267641469949267, "general_advantage_estimation": 0.011154799030514731, "add_states_from_episodes_to_batch": 6.198959908579127e-06, "add_time_dim_to_batch_and_zero_pad": 2.341697992933405e-05}}, "connector_pipeline_timer": 0.2967548199500782}, "learner_connector_sum_episodes_length_out": 5100.0, "num_env_steps_trained_lifetime": 244800, "learner_connector_sum_episodes_length_in": 5000.0, "num_trainable_parameters": 3731, "num_module_steps_trained": 16000, "num_module_steps_trained_lifetime": 48000, "num_non_trainable_parameters": 0, "num_env_steps_trained": 81600, "num_env_steps_trained_lifetime_throughput": 1121656.0698515163, "num_module_steps_trained_throughput": 220653.28723168655, "num_module_steps_trained_lifetime_throughput": 220477.70957831558}}, "num_training_step_calls_per_iteration": 1, "evaluation": {"env_runners": {"episode_duration_sec_mean": 0.034646324999994246, "episode_len_min": 50, "num_env_steps_sampled": 1000, "num_agent_steps_sampled": {"default_agent": 1000}, "num_episodes_lifetime": 60, "env_reset_timer": 0.00022200693031563788, "num_agent_steps_sampled_lifetime": {"default_agent": 3000}, "rlmodule_inference_timer": 9.256583047775429e-05, "episode_return_mean": -1.5666666666666667, "episode_len_mean": 50.0, "env_to_module_connector": {"timers": {"connectors": {"add_states_from_episodes_to_batch": 3.456673628796471e-06, "add_time_dim_to_batch_and_zero_pad": 5.723005510357278e-06, "numpy_to_tensor": 2.9576893480642885e-05, "batch_individual_items": 1.8914921194928737e-05, "add_observations_from_episodes_to_batch": 6.330997338681593e-06}}, "connector_pipeline_timer": 0.00011385905083642683}, "agent_episode_returns_mean": {"default_agent": -1.5666666666666667}, "env_to_module_sum_episodes_length_out": 27.168093332125434, "module_episode_returns_mean": {"default_policy": -1.5666666666666667}, "sample": 0.7227321497200938, "env_to_module_sum_episodes_length_in": 27.168093332125434, "num_episodes": 20, "num_module_steps_sampled": {"default_policy": 1000}, "module_to_env_connector": {"timers": {"connectors": {"un_batch_to_individual_items": 1.553886797659399e-05, "get_actions": 0.00015313041233787025, "normalize_and_clip_actions": 2.207492023768569e-05, "tensor_to_numpy": 4.585077883572666e-05, "remove_single_ts_time_rank_from_batch": 1.3809848400350007e-06, "listify_data_for_vector_env": 3.0758320028485164e-05}}, "connector_pipeline_timer": 0.0003392700788545578}, "episode_len_max": 50, "env_step_timer": 4.114514949958857e-05, "episode_return_max": 17.5, "weights_seq_no": 3.0, "num_env_steps_sampled_lifetime": 16000, "episode_return_min": -16.5, "num_module_steps_sampled_lifetime": {"default_policy": 3000}, "time_between_sampling": 4.201930221990515}, "num_healthy_workers": 1, "actor_manager_num_outstanding_async_reqs": 0, "num_remote_worker_restarts": 0}, "num_env_steps_sampled_lifetime": -232500.0, "fault_tolerance": {"num_healthy_workers": 0, "num_remote_worker_restarts": 0}, "env_runner_group": {"actor_manager_num_outstanding_async_reqs": 0}, "done": false, "training_iteration": 3, "trial_id": "a530a_00000", "date": "2025-08-11_17-25-27", "timestamp": 1754925927, "time_this_iter_s": 5.01940131187439, "time_total_s": 14.93285584449768, "pid": 75896, "hostname": "DESKTOP-3SK5A41", "node_ip": "192.168.40.242", "config": {"exploration_config": {}, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 6, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "env": "Umbrella", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": false, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 0, "create_local_env_runner": true, "num_envs_per_env_runner": 1, "gym_env_vectorize_mode": "SYNC", "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "episodes_to_numpy": true, "max_requests_in_flight_per_env_runner": 1, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "merge_env_runner_states": "training_only", "broadcast_env_runner_states": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "complete_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "sampler_perf_stats_ema_coef": null, "_is_online": true, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": "auto", "num_aggregator_actors_per_learner": 0, "max_requests_in_flight_per_aggregator_actor": 3, "local_gpu_idx": 0, "max_requests_in_flight_per_learner": 3, "gamma": 1, "lr": 0.0049847823121, "grad_clip": 0.5, "grad_clip_by": "global_norm", "_train_batch_size_per_learner": 5000, "train_batch_size": 4000, "num_epochs": 3, "minibatch_size": 1000, "shuffle_batch_per_epoch": true, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "log_std_clip_param": 20.0, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "_disable_preprocessor_api": false, "_disable_action_flattening": false}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "_learner_class": null, "callbacks_on_algorithm_init": null, "callbacks_on_env_runners_recreated": null, "callbacks_on_offline_eval_runners_recreated": null, "callbacks_on_checkpoint_loaded": null, "callbacks_on_environment_created": null, "callbacks_on_episode_created": null, "callbacks_on_episode_start": null, "callbacks_on_episode_step": null, "callbacks_on_episode_end": null, "callbacks_on_evaluate_start": null, "callbacks_on_evaluate_end": null, "callbacks_on_evaluate_offline_start": null, "callbacks_on_evaluate_offline_end": null, "callbacks_on_sample_end": null, "callbacks_on_train_result": null, "explore": true, "enable_rl_module_and_learner": true, "enable_env_runner_and_connector_v2": true, "_prior_exploration_config": {"type": "StochasticSampling"}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7f44639f2ac0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "offline_data_class": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_read_batch_size": null, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "materialize_data": false, "materialize_mapped_data": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "ignore_final_observation": false, "prelearner_class": null, "prelearner_buffer_class": null, "prelearner_buffer_kwargs": {}, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_remaining_data": false, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": 1, "evaluation_duration": 20, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_auto_duration_min_env_steps_per_sample": 100, "evaluation_auto_duration_max_env_steps_per_sample": 2000, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 1, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "offline_evaluation_interval": null, "num_offline_eval_runners": 0, "offline_loss_for_module_fn": null, "offline_evaluation_duration": 1, "offline_evaluation_parallel_to_training": false, "offline_evaluation_timeout_s": 120.0, "num_cpus_per_offline_eval_runner": 1, "num_gpus_per_offline_eval_runner": 0, "custom_resources_per_offline_eval_runner": {}, "restart_failed_offline_eval_runners": true, "ignore_offline_eval_runner_failures": false, "max_num_offline_eval_runner_restarts": 1000, "offline_eval_runner_restore_timeout_s": 1800.0, "max_requests_in_flight_per_offline_eval_runner": 1, "validate_offline_eval_runners_after_construction": true, "offline_eval_runner_health_probe_timeout_s": 30.0, "offline_eval_rl_module_inference_only": false, "broadcast_offline_eval_runner_states": false, "offline_eval_batch_size_per_runner": 256, "dataset_num_iters_per_eval_runner": 1, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "log_gradients": true, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 42, "restart_failed_env_runners": true, "ignore_env_runner_failures": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30.0, "env_runner_restore_timeout_s": 1800.0, "_model_config": {}, "_rl_module_spec": "RLModuleSpec(module_class=None, observation_space=None, action_space=None, inference_only=False, learner_only=False, model_config=DefaultModelConfig(fcnet_hiddens=[68, 48], fcnet_activation='tanh', fcnet_kernel_initializer=None, fcnet_kernel_initializer_kwargs=None, fcnet_bias_initializer=None, fcnet_bias_initializer_kwargs=None, conv_filters=None, conv_activation='relu', conv_kernel_initializer=None, conv_kernel_initializer_kwargs=None, conv_bias_initializer=None, conv_bias_initializer_kwargs=None, head_fcnet_hiddens=[], head_fcnet_activation='relu', head_fcnet_kernel_initializer=None, head_fcnet_kernel_initializer_kwargs=None, head_fcnet_bias_initializer=None, head_fcnet_bias_initializer_kwargs=None, free_log_std=False, log_std_clip_param=20.0, vf_share_layers=True, use_lstm=False, max_seq_len=20, lstm_cell_size=256, lstm_use_prev_action=False, lstm_use_prev_reward=False, lstm_kernel_initializer=None, lstm_kernel_initializer_kwargs=None, lstm_bias_initializer=None, lstm_bias_initializer_kwargs=None), catalog_class=None, load_state_path=None, model_config_dict=None)", "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "_validate_config": true, "_use_msgpack_checkpoints": false, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "env_task_fn": -1, "enable_connectors": -1, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.6551508793305, "kl_target": 0.018007117439, "vf_loss_coeff": 0.7591243664964, "entropy_coeff": 0.0132828111413, "clip_param": 0.1193136467235, "vf_clip_param": 0.3889481243011, "entropy_coeff_schedule": null, "lr_schedule": null, "sgd_minibatch_size": -1, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9141150497384, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.callbacks.callbacks.RLlibCallback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 14.93285584449768, "iterations_since_restore": 3, "perf": {"cpu_util_percent": 13.114285714285716, "ram_util_percent": 87.60000000000001}}
{"timers": {"training_iteration": 4.298829180574675, "restore_env_runners": 1.4664348363958196e-05, "training_step": 4.298604417702504, "env_runner_sampling_timer": 3.8399892869214476, "learner_update_timer": 0.45502625089499604, "synch_weights": 0.001601688041058037, "restore_eval_env_runners": 1.402189019581783e-05, "evaluation_iteration": 0.7350511040793761, "synch_eval_env_connectors": 0.00044590605982284615, "synch_env_connectors": 9.850249905684903e-06}, "env_runners": {"env_to_module_sum_episodes_length_in": 27.16809333212661, "episode_return_min": -5.5, "weights_seq_no": 3.0, "num_episodes_lifetime": -9500.0, "num_episodes": 100.0, "rlmodule_inference_timer": 0.00010013093238499699, "env_reset_timer": 0.00010040107915794004, "num_module_steps_sampled_lifetime": {"default_policy": -475000.0}, "env_to_module_connector": {"timers": {"connectors": {"add_observations_from_episodes_to_batch": 6.213987969952775e-06, "numpy_to_tensor": 3.113697584224894e-05, "add_time_dim_to_batch_and_zero_pad": 6.325191829196495e-06, "batch_individual_items": 1.844732428933935e-05, "add_states_from_episodes_to_batch": 3.4696614605937523e-06}}, "connector_pipeline_timer": 0.0001178068909342171}, "time_between_sampling": 0.011384268625261394, "module_to_env_connector": {"timers": {"connectors": {"get_actions": 0.00016557123941198898, "un_batch_to_individual_items": 1.4850254404651071e-05, "normalize_and_clip_actions": 2.196572545479536e-05, "tensor_to_numpy": 4.956434296583651e-05, "remove_single_ts_time_rank_from_batch": 1.5597941623183333e-06, "listify_data_for_vector_env": 3.086484620594595e-05}}, "connector_pipeline_timer": 0.0003605655936194566}, "num_env_steps_sampled_lifetime": -475000.0, "episode_len_max": 50, "episode_return_mean": 5.299999999999998, "agent_episode_returns_mean": {"default_agent": 5.299999999999998}, "env_step_timer": 4.33875325115513e-05, "episode_len_mean": 50.0, "module_episode_returns_mean": {"default_policy": 5.299999999999998}, "num_env_steps_sampled": 5000.0, "episode_return_max": 14.5, "env_to_module_sum_episodes_length_out": 27.16809333212661, "num_agent_steps_sampled": {"default_agent": 5000.0}, "num_agent_steps_sampled_lifetime": {"default_agent": -475000.0}, "episode_duration_sec_mean": 0.036340240020026615, "num_module_steps_sampled": {"default_policy": 5000.0}, "episode_len_min": 50, "sample": 0.03815845071272036, "num_env_steps_sampled_lifetime_throughput": 1284.0925897170782}, "learners": {"default_policy": {"vf_loss": 0.2854441702365875, "num_module_steps_trained_lifetime": 64000, "policy_loss": 0.005824825260788202, "gradients_default_optimizer_global_norm": 0.20446087419986725, "num_module_steps_trained": 16000, "default_optimizer_learning_rate": 0.0049847823121, "curr_kl_coeff": 0.04094693064689636, "vf_explained_var": 0.7841569781303406, "mean_kl_loss": 0.004235157743096352, "total_loss": 0.21383307874202728, "curr_entropy_coeff": 0.0132828111413, "module_train_batch_size_mean": 1000.0, "entropy": 0.6795390248298645, "diff_num_grad_updates_vs_sampler_policy": 1.0, "vf_loss_unclipped": 4.965668678283691, "weights_seq_no": 4.0, "num_trainable_parameters": 3731, "num_module_steps_trained_lifetime_throughput": 219269.03849829224}, "__all_modules__": {"learner_connector": {"timers": {"connectors": {"numpy_to_tensor": 0.00016995569282464383, "batch_individual_items": 0.20274432450566007, "add_observations_from_episodes_to_batch": 0.0009460999004500108, "add_one_ts_to_episodes_and_truncate": 0.00871030413187599, "add_columns_from_episodes_to_train_batch": 0.07265202055249681, "general_advantage_estimation": 0.011147365040214796, "add_states_from_episodes_to_batch": 6.208970312040037e-06, "add_time_dim_to_batch_and_zero_pad": 2.344781013789816e-05}}, "connector_pipeline_timer": 0.29673028075057795}, "learner_connector_sum_episodes_length_out": 5100.0, "num_env_steps_trained_lifetime": 326400, "learner_connector_sum_episodes_length_in": 5000.0, "num_trainable_parameters": 3731, "num_module_steps_trained": 16000, "num_module_steps_trained_lifetime": 64000, "num_non_trainable_parameters": 0, "num_env_steps_trained": 81600, "num_env_steps_trained_lifetime_throughput": 1112655.6661545548, "num_module_steps_trained_throughput": 218857.8416543533, "num_module_steps_trained_lifetime_throughput": 218689.49331305962}}, "num_training_step_calls_per_iteration": 1, "evaluation": {"env_runners": {"episode_duration_sec_mean": 0.03459786874996098, "episode_len_min": 50, "num_env_steps_sampled": 1000, "num_agent_steps_sampled": {"default_agent": 1000}, "num_episodes_lifetime": 80, "env_reset_timer": 0.00022108986101157917, "num_agent_steps_sampled_lifetime": {"default_agent": 4000}, "rlmodule_inference_timer": 8.992275596723592e-05, "episode_return_mean": -0.9, "episode_len_mean": 50.0, "env_to_module_connector": {"timers": {"connectors": {"add_states_from_episodes_to_batch": 3.5000678868774524e-06, "add_time_dim_to_batch_and_zero_pad": 5.475316585891169e-06, "numpy_to_tensor": 2.9281525561926495e-05, "batch_individual_items": 1.8941601142315153e-05, "add_observations_from_episodes_to_batch": 6.466073288122375e-06}}, "connector_pipeline_timer": 0.00011290246861278861}, "agent_episode_returns_mean": {"default_agent": -0.9}, "env_to_module_sum_episodes_length_out": 27.168093332126602, "module_episode_returns_mean": {"default_policy": -0.9}, "sample": 0.7226867532228882, "env_to_module_sum_episodes_length_in": 27.168093332126602, "num_episodes": 20, "num_module_steps_sampled": {"default_policy": 1000}, "module_to_env_connector": {"timers": {"connectors": {"un_batch_to_individual_items": 1.5462884041546607e-05, "get_actions": 0.00015193632913971177, "normalize_and_clip_actions": 2.195792166681433e-05, "tensor_to_numpy": 4.539068400283069e-05, "remove_single_ts_time_rank_from_batch": 1.4143326834856222e-06, "listify_data_for_vector_env": 3.0825645081762405e-05}}, "connector_pipeline_timer": 0.00033685644843062663}, "episode_len_max": 50, "env_step_timer": 4.062097889385343e-05, "episode_return_max": 17.5, "weights_seq_no": 4.0, "num_env_steps_sampled_lifetime": 21000, "episode_return_min": -16.5, "num_module_steps_sampled_lifetime": {"default_policy": 4000}, "time_between_sampling": 4.20322110479061}, "num_healthy_workers": 1, "actor_manager_num_outstanding_async_reqs": 0, "num_remote_worker_restarts": 0}, "num_env_steps_sampled_lifetime": -475000.0, "fault_tolerance": {"num_healthy_workers": 0, "num_remote_worker_restarts": 0}, "env_runner_group": {"actor_manager_num_outstanding_async_reqs": 0}, "done": false, "training_iteration": 4, "trial_id": "a530a_00000", "date": "2025-08-11_17-25-32", "timestamp": 1754925932, "time_this_iter_s": 5.008490085601807, "time_total_s": 19.941345930099487, "pid": 75896, "hostname": "DESKTOP-3SK5A41", "node_ip": "192.168.40.242", "config": {"exploration_config": {}, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 6, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "env": "Umbrella", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": false, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 0, "create_local_env_runner": true, "num_envs_per_env_runner": 1, "gym_env_vectorize_mode": "SYNC", "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "episodes_to_numpy": true, "max_requests_in_flight_per_env_runner": 1, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "merge_env_runner_states": "training_only", "broadcast_env_runner_states": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "complete_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "sampler_perf_stats_ema_coef": null, "_is_online": true, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": "auto", "num_aggregator_actors_per_learner": 0, "max_requests_in_flight_per_aggregator_actor": 3, "local_gpu_idx": 0, "max_requests_in_flight_per_learner": 3, "gamma": 1, "lr": 0.0049847823121, "grad_clip": 0.5, "grad_clip_by": "global_norm", "_train_batch_size_per_learner": 5000, "train_batch_size": 4000, "num_epochs": 3, "minibatch_size": 1000, "shuffle_batch_per_epoch": true, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "log_std_clip_param": 20.0, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "_disable_preprocessor_api": false, "_disable_action_flattening": false}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "_learner_class": null, "callbacks_on_algorithm_init": null, "callbacks_on_env_runners_recreated": null, "callbacks_on_offline_eval_runners_recreated": null, "callbacks_on_checkpoint_loaded": null, "callbacks_on_environment_created": null, "callbacks_on_episode_created": null, "callbacks_on_episode_start": null, "callbacks_on_episode_step": null, "callbacks_on_episode_end": null, "callbacks_on_evaluate_start": null, "callbacks_on_evaluate_end": null, "callbacks_on_evaluate_offline_start": null, "callbacks_on_evaluate_offline_end": null, "callbacks_on_sample_end": null, "callbacks_on_train_result": null, "explore": true, "enable_rl_module_and_learner": true, "enable_env_runner_and_connector_v2": true, "_prior_exploration_config": {"type": "StochasticSampling"}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7f44639f2ac0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "offline_data_class": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_read_batch_size": null, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "materialize_data": false, "materialize_mapped_data": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "ignore_final_observation": false, "prelearner_class": null, "prelearner_buffer_class": null, "prelearner_buffer_kwargs": {}, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_remaining_data": false, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": 1, "evaluation_duration": 20, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_auto_duration_min_env_steps_per_sample": 100, "evaluation_auto_duration_max_env_steps_per_sample": 2000, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 1, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "offline_evaluation_interval": null, "num_offline_eval_runners": 0, "offline_loss_for_module_fn": null, "offline_evaluation_duration": 1, "offline_evaluation_parallel_to_training": false, "offline_evaluation_timeout_s": 120.0, "num_cpus_per_offline_eval_runner": 1, "num_gpus_per_offline_eval_runner": 0, "custom_resources_per_offline_eval_runner": {}, "restart_failed_offline_eval_runners": true, "ignore_offline_eval_runner_failures": false, "max_num_offline_eval_runner_restarts": 1000, "offline_eval_runner_restore_timeout_s": 1800.0, "max_requests_in_flight_per_offline_eval_runner": 1, "validate_offline_eval_runners_after_construction": true, "offline_eval_runner_health_probe_timeout_s": 30.0, "offline_eval_rl_module_inference_only": false, "broadcast_offline_eval_runner_states": false, "offline_eval_batch_size_per_runner": 256, "dataset_num_iters_per_eval_runner": 1, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "log_gradients": true, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 42, "restart_failed_env_runners": true, "ignore_env_runner_failures": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30.0, "env_runner_restore_timeout_s": 1800.0, "_model_config": {}, "_rl_module_spec": "RLModuleSpec(module_class=None, observation_space=None, action_space=None, inference_only=False, learner_only=False, model_config=DefaultModelConfig(fcnet_hiddens=[68, 48], fcnet_activation='tanh', fcnet_kernel_initializer=None, fcnet_kernel_initializer_kwargs=None, fcnet_bias_initializer=None, fcnet_bias_initializer_kwargs=None, conv_filters=None, conv_activation='relu', conv_kernel_initializer=None, conv_kernel_initializer_kwargs=None, conv_bias_initializer=None, conv_bias_initializer_kwargs=None, head_fcnet_hiddens=[], head_fcnet_activation='relu', head_fcnet_kernel_initializer=None, head_fcnet_kernel_initializer_kwargs=None, head_fcnet_bias_initializer=None, head_fcnet_bias_initializer_kwargs=None, free_log_std=False, log_std_clip_param=20.0, vf_share_layers=True, use_lstm=False, max_seq_len=20, lstm_cell_size=256, lstm_use_prev_action=False, lstm_use_prev_reward=False, lstm_kernel_initializer=None, lstm_kernel_initializer_kwargs=None, lstm_bias_initializer=None, lstm_bias_initializer_kwargs=None), catalog_class=None, load_state_path=None, model_config_dict=None)", "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "_validate_config": true, "_use_msgpack_checkpoints": false, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "env_task_fn": -1, "enable_connectors": -1, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.6551508793305, "kl_target": 0.018007117439, "vf_loss_coeff": 0.7591243664964, "entropy_coeff": 0.0132828111413, "clip_param": 0.1193136467235, "vf_clip_param": 0.3889481243011, "entropy_coeff_schedule": null, "lr_schedule": null, "sgd_minibatch_size": -1, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9141150497384, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.callbacks.callbacks.RLlibCallback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 19.941345930099487, "iterations_since_restore": 4, "perf": {"cpu_util_percent": 12.842857142857143, "ram_util_percent": 87.60000000000001}}
{"timers": {"training_iteration": 4.2971758457989315, "restore_env_runners": 1.4628704879697304e-05, "training_step": 4.296949500555478, "env_runner_sampling_timer": 3.8405015080822325, "learner_update_timer": 0.4528484663860436, "synch_weights": 0.0016033271606474447, "restore_eval_env_runners": 1.4057671297053274e-05, "evaluation_iteration": 0.734978937038579, "synch_eval_env_connectors": 0.0004457249992213201, "synch_env_connectors": 9.820747404521171e-06}, "env_runners": {"env_to_module_sum_episodes_length_in": 27.16809333212661, "episode_return_min": -5.5, "weights_seq_no": 4.0, "num_episodes_lifetime": -14350.0, "num_episodes": 100.0, "rlmodule_inference_timer": 9.958721221432553e-05, "env_reset_timer": 9.86469509237613e-05, "num_module_steps_sampled_lifetime": {"default_policy": -717500.0}, "env_to_module_connector": {"timers": {"connectors": {"add_observations_from_episodes_to_batch": 6.243765394492092e-06, "numpy_to_tensor": 3.1118540600215095e-05, "add_time_dim_to_batch_and_zero_pad": 6.321855504505301e-06, "batch_individual_items": 1.8420504310767002e-05, "add_states_from_episodes_to_batch": 3.435192455282476e-06}}, "connector_pipeline_timer": 0.0001178748393126125}, "time_between_sampling": 0.012456888522439338, "module_to_env_connector": {"timers": {"connectors": {"get_actions": 0.00016559229185451733, "un_batch_to_individual_items": 1.4847429721364997e-05, "normalize_and_clip_actions": 2.1890284803894934e-05, "tensor_to_numpy": 4.972096042749716e-05, "remove_single_ts_time_rank_from_batch": 1.563772394793711e-06, "listify_data_for_vector_env": 3.067211838367391e-05}}, "connector_pipeline_timer": 0.00036041959966462157}, "num_env_steps_sampled_lifetime": -717500.0, "episode_len_max": 50, "episode_return_mean": 7.9, "agent_episode_returns_mean": {"default_agent": 7.9}, "env_step_timer": 4.349991941933304e-05, "episode_len_mean": 50.0, "module_episode_returns_mean": {"default_policy": 7.9}, "num_env_steps_sampled": 5000.0, "episode_return_max": 14.5, "env_to_module_sum_episodes_length_out": 27.16809333212661, "num_agent_steps_sampled": {"default_agent": 5000.0}, "num_agent_steps_sampled_lifetime": {"default_agent": -717500.0}, "episode_duration_sec_mean": 0.03638033002999691, "num_module_steps_sampled": {"default_policy": 5000.0}, "episode_len_min": 50, "sample": 0.03768297194580603, "num_env_steps_sampled_lifetime_throughput": 1286.4711836769793}, "learners": {"default_policy": {"vf_loss": 0.2720125913619995, "num_module_steps_trained_lifetime": 80000, "policy_loss": 0.010916424915194511, "gradients_default_optimizer_global_norm": 0.12404888868331909, "num_module_steps_trained": 16000, "default_optimizer_learning_rate": 0.0049847823121, "curr_kl_coeff": 0.02047346532344818, "vf_explained_var": 0.7682809233665466, "mean_kl_loss": 0.0013313238741829991, "total_loss": 0.20846174657344818, "curr_entropy_coeff": 0.0132828111413, "module_train_batch_size_mean": 1000.0, "entropy": 0.6776095628738403, "diff_num_grad_updates_vs_sampler_policy": 1.0, "vf_loss_unclipped": 6.693856239318848, "weights_seq_no": 5.0, "num_trainable_parameters": 3731, "num_module_steps_trained_lifetime_throughput": 217285.8152005772}, "__all_modules__": {"learner_connector": {"timers": {"connectors": {"numpy_to_tensor": 0.00017011013589831033, "batch_individual_items": 0.20130488226059992, "add_observations_from_episodes_to_batch": 0.0009435249014465426, "add_one_ts_to_episodes_and_truncate": 0.008706405090559526, "add_columns_from_episodes_to_train_batch": 0.07261638434696785, "general_advantage_estimation": 0.011124032389818283, "add_states_from_episodes_to_batch": 6.204880604907848e-06, "add_time_dim_to_batch_and_zero_pad": 2.346733203337678e-05}}, "connector_pipeline_timer": 0.29522662494307267}, "learner_connector_sum_episodes_length_out": 5100.0, "num_env_steps_trained_lifetime": 408000, "learner_connector_sum_episodes_length_in": 5000.0, "num_trainable_parameters": 3731, "num_module_steps_trained": 16000, "num_module_steps_trained_lifetime": 80000, "num_non_trainable_parameters": 0, "num_env_steps_trained": 81600, "num_env_steps_trained_lifetime_throughput": 1102823.7025137402, "num_module_steps_trained_throughput": 216898.21588395367, "num_module_steps_trained_lifetime_throughput": 216737.04906937556}}, "num_training_step_calls_per_iteration": 1, "evaluation": {"env_runners": {"episode_duration_sec_mean": 0.03453785200994389, "episode_len_min": 50, "num_env_steps_sampled": 1000, "num_agent_steps_sampled": {"default_agent": 1000}, "num_episodes_lifetime": 100, "env_reset_timer": 0.00022017796239738791, "num_agent_steps_sampled_lifetime": {"default_agent": 5000}, "rlmodule_inference_timer": 8.999629453983773e-05, "episode_return_mean": -0.9, "episode_len_mean": 50.0, "env_to_module_connector": {"timers": {"connectors": {"add_states_from_episodes_to_batch": 3.137291007342816e-06, "add_time_dim_to_batch_and_zero_pad": 5.407761292811522e-06, "numpy_to_tensor": 2.966083797994294e-05, "batch_individual_items": 1.8271001739350802e-05, "add_observations_from_episodes_to_batch": 6.3028089248070325e-06}}, "connector_pipeline_timer": 0.00011050351725339369}, "agent_episode_returns_mean": {"default_agent": -0.9}, "env_to_module_sum_episodes_length_out": 27.168093332126602, "module_episode_returns_mean": {"default_policy": -0.9}, "sample": 0.7226035767006558, "env_to_module_sum_episodes_length_in": 27.168093332126602, "num_episodes": 20, "num_module_steps_sampled": {"default_policy": 1000}, "module_to_env_connector": {"timers": {"connectors": {"un_batch_to_individual_items": 1.5433440560134983e-05, "get_actions": 0.0001515958897783931, "normalize_and_clip_actions": 2.2183404682947015e-05, "tensor_to_numpy": 4.626190532260007e-05, "remove_single_ts_time_rank_from_batch": 1.3908686633166343e-06, "listify_data_for_vector_env": 3.0419040333357478e-05}}, "connector_pipeline_timer": 0.00033812081006074106}, "episode_len_max": 50, "env_step_timer": 4.053660558893412e-05, "episode_return_max": 17.5, "weights_seq_no": 5.0, "num_env_steps_sampled_lifetime": 26000, "episode_return_min": -16.5, "num_module_steps_sampled_lifetime": {"default_policy": 5000}, "time_between_sampling": 4.203066334772705}, "num_healthy_workers": 1, "actor_manager_num_outstanding_async_reqs": 0, "num_remote_worker_restarts": 0}, "num_env_steps_sampled_lifetime": -717500.0, "fault_tolerance": {"num_healthy_workers": 0, "num_remote_worker_restarts": 0}, "env_runner_group": {"actor_manager_num_outstanding_async_reqs": 0}, "done": false, "training_iteration": 5, "trial_id": "a530a_00000", "date": "2025-08-11_17-25-37", "timestamp": 1754925937, "time_this_iter_s": 4.86246132850647, "time_total_s": 24.803807258605957, "pid": 75896, "hostname": "DESKTOP-3SK5A41", "node_ip": "192.168.40.242", "config": {"exploration_config": {}, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 6, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "env": "Umbrella", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": false, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 0, "create_local_env_runner": true, "num_envs_per_env_runner": 1, "gym_env_vectorize_mode": "SYNC", "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "episodes_to_numpy": true, "max_requests_in_flight_per_env_runner": 1, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "merge_env_runner_states": "training_only", "broadcast_env_runner_states": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "complete_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "sampler_perf_stats_ema_coef": null, "_is_online": true, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": "auto", "num_aggregator_actors_per_learner": 0, "max_requests_in_flight_per_aggregator_actor": 3, "local_gpu_idx": 0, "max_requests_in_flight_per_learner": 3, "gamma": 1, "lr": 0.0049847823121, "grad_clip": 0.5, "grad_clip_by": "global_norm", "_train_batch_size_per_learner": 5000, "train_batch_size": 4000, "num_epochs": 3, "minibatch_size": 1000, "shuffle_batch_per_epoch": true, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "log_std_clip_param": 20.0, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "_disable_preprocessor_api": false, "_disable_action_flattening": false}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "_learner_class": null, "callbacks_on_algorithm_init": null, "callbacks_on_env_runners_recreated": null, "callbacks_on_offline_eval_runners_recreated": null, "callbacks_on_checkpoint_loaded": null, "callbacks_on_environment_created": null, "callbacks_on_episode_created": null, "callbacks_on_episode_start": null, "callbacks_on_episode_step": null, "callbacks_on_episode_end": null, "callbacks_on_evaluate_start": null, "callbacks_on_evaluate_end": null, "callbacks_on_evaluate_offline_start": null, "callbacks_on_evaluate_offline_end": null, "callbacks_on_sample_end": null, "callbacks_on_train_result": null, "explore": true, "enable_rl_module_and_learner": true, "enable_env_runner_and_connector_v2": true, "_prior_exploration_config": {"type": "StochasticSampling"}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7f44639f2ac0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "offline_data_class": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_read_batch_size": null, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "materialize_data": false, "materialize_mapped_data": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "ignore_final_observation": false, "prelearner_class": null, "prelearner_buffer_class": null, "prelearner_buffer_kwargs": {}, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_remaining_data": false, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": 1, "evaluation_duration": 20, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_auto_duration_min_env_steps_per_sample": 100, "evaluation_auto_duration_max_env_steps_per_sample": 2000, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 1, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "offline_evaluation_interval": null, "num_offline_eval_runners": 0, "offline_loss_for_module_fn": null, "offline_evaluation_duration": 1, "offline_evaluation_parallel_to_training": false, "offline_evaluation_timeout_s": 120.0, "num_cpus_per_offline_eval_runner": 1, "num_gpus_per_offline_eval_runner": 0, "custom_resources_per_offline_eval_runner": {}, "restart_failed_offline_eval_runners": true, "ignore_offline_eval_runner_failures": false, "max_num_offline_eval_runner_restarts": 1000, "offline_eval_runner_restore_timeout_s": 1800.0, "max_requests_in_flight_per_offline_eval_runner": 1, "validate_offline_eval_runners_after_construction": true, "offline_eval_runner_health_probe_timeout_s": 30.0, "offline_eval_rl_module_inference_only": false, "broadcast_offline_eval_runner_states": false, "offline_eval_batch_size_per_runner": 256, "dataset_num_iters_per_eval_runner": 1, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "log_gradients": true, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 42, "restart_failed_env_runners": true, "ignore_env_runner_failures": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30.0, "env_runner_restore_timeout_s": 1800.0, "_model_config": {}, "_rl_module_spec": "RLModuleSpec(module_class=None, observation_space=None, action_space=None, inference_only=False, learner_only=False, model_config=DefaultModelConfig(fcnet_hiddens=[68, 48], fcnet_activation='tanh', fcnet_kernel_initializer=None, fcnet_kernel_initializer_kwargs=None, fcnet_bias_initializer=None, fcnet_bias_initializer_kwargs=None, conv_filters=None, conv_activation='relu', conv_kernel_initializer=None, conv_kernel_initializer_kwargs=None, conv_bias_initializer=None, conv_bias_initializer_kwargs=None, head_fcnet_hiddens=[], head_fcnet_activation='relu', head_fcnet_kernel_initializer=None, head_fcnet_kernel_initializer_kwargs=None, head_fcnet_bias_initializer=None, head_fcnet_bias_initializer_kwargs=None, free_log_std=False, log_std_clip_param=20.0, vf_share_layers=True, use_lstm=False, max_seq_len=20, lstm_cell_size=256, lstm_use_prev_action=False, lstm_use_prev_reward=False, lstm_kernel_initializer=None, lstm_kernel_initializer_kwargs=None, lstm_bias_initializer=None, lstm_bias_initializer_kwargs=None), catalog_class=None, load_state_path=None, model_config_dict=None)", "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "_validate_config": true, "_use_msgpack_checkpoints": false, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "env_task_fn": -1, "enable_connectors": -1, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.6551508793305, "kl_target": 0.018007117439, "vf_loss_coeff": 0.7591243664964, "entropy_coeff": 0.0132828111413, "clip_param": 0.1193136467235, "vf_clip_param": 0.3889481243011, "entropy_coeff_schedule": null, "lr_schedule": null, "sgd_minibatch_size": -1, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9141150497384, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.callbacks.callbacks.RLlibCallback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 24.803807258605957, "iterations_since_restore": 5, "perf": {"cpu_util_percent": 12.914285714285715, "ram_util_percent": 87.61428571428571}}
{"timers": {"training_iteration": 4.297114576380938, "restore_env_runners": 1.4622417832820602e-05, "training_step": 4.296885714589928, "env_runner_sampling_timer": 3.8411876970414065, "learner_update_timer": 0.45209530772218764, "synch_weights": 0.001600848889036874, "restore_eval_env_runners": 1.4031094588115018e-05, "evaluation_iteration": 0.7348700826781974, "synch_eval_env_connectors": 0.00044570974922857845, "synch_env_connectors": 9.790539929849527e-06}, "env_runners": {"env_to_module_sum_episodes_length_in": 27.16809333212661, "episode_return_min": -5.5, "weights_seq_no": 5.0, "num_episodes_lifetime": -19200.0, "num_episodes": 100.0, "rlmodule_inference_timer": 0.00010046610691298775, "env_reset_timer": 9.707264160861828e-05, "num_module_steps_sampled_lifetime": {"default_policy": -960000.0}, "env_to_module_connector": {"timers": {"connectors": {"add_observations_from_episodes_to_batch": 6.273772143322422e-06, "numpy_to_tensor": 3.135960479299572e-05, "add_time_dim_to_batch_and_zero_pad": 6.380622564061544e-06, "batch_individual_items": 1.860677136129508e-05, "add_states_from_episodes_to_batch": 3.504278464870064e-06}}, "connector_pipeline_timer": 0.0001190297280272219}, "time_between_sampling": 0.011889507107880065, "module_to_env_connector": {"timers": {"connectors": {"get_actions": 0.00016642265350020341, "un_batch_to_individual_items": 1.4998321793537081e-05, "normalize_and_clip_actions": 2.201344086508848e-05, "tensor_to_numpy": 5.003209207047933e-05, "remove_single_ts_time_rank_from_batch": 1.5896626363202307e-06, "listify_data_for_vector_env": 3.071724578345533e-05}}, "connector_pipeline_timer": 0.00036238965034348476}, "num_env_steps_sampled_lifetime": -960000.0, "episode_len_max": 50, "episode_return_mean": 8.299999999999997, "agent_episode_returns_mean": {"default_agent": 8.299999999999997}, "env_step_timer": 4.359852080411492e-05, "episode_len_mean": 50.0, "module_episode_returns_mean": {"default_policy": 8.299999999999997}, "num_env_steps_sampled": 5000.0, "episode_return_max": 14.5, "env_to_module_sum_episodes_length_out": 27.16809333212661, "num_agent_steps_sampled": {"default_agent": 5000.0}, "num_agent_steps_sampled_lifetime": {"default_agent": -960000.0}, "episode_duration_sec_mean": 0.03656558304008285, "num_module_steps_sampled": {"default_policy": 5000.0}, "episode_len_min": 50, "sample": 0.03761109234734487, "num_env_steps_sampled_lifetime_throughput": 1279.1624703555963}, "learners": {"default_policy": {"vf_loss": 0.2618583142757416, "num_module_steps_trained_lifetime": 96000, "policy_loss": 0.017294706776738167, "gradients_default_optimizer_global_norm": 0.22378958761692047, "num_module_steps_trained": 16000, "default_optimizer_learning_rate": 0.0049847823121, "curr_kl_coeff": 0.01023673266172409, "vf_explained_var": 0.7770664691925049, "mean_kl_loss": 0.0031541723292320967, "total_loss": 0.20735891163349152, "curr_entropy_coeff": 0.0132828111413, "module_train_batch_size_mean": 1000.0, "entropy": 0.6612581610679626, "diff_num_grad_updates_vs_sampler_policy": 1.0, "vf_loss_unclipped": 7.4424824714660645, "weights_seq_no": 6.0, "num_trainable_parameters": 3731, "num_module_steps_trained_lifetime_throughput": 215479.6069269076}, "__all_modules__": {"learner_connector": {"timers": {"connectors": {"numpy_to_tensor": 0.00017007403454819749, "batch_individual_items": 0.20135198743799462, "add_observations_from_episodes_to_batch": 0.0009412046524305981, "add_one_ts_to_episodes_and_truncate": 0.008700312039660615, "add_columns_from_episodes_to_train_batch": 0.07256322050349522, "general_advantage_estimation": 0.011096965065924839, "add_states_from_episodes_to_batch": 6.19583180224925e-06, "add_time_dim_to_batch_and_zero_pad": 2.343665871116372e-05}}, "connector_pipeline_timer": 0.29518463269363815}, "learner_connector_sum_episodes_length_out": 5100.0, "num_env_steps_trained_lifetime": 489600, "learner_connector_sum_episodes_length_in": 5000.0, "num_trainable_parameters": 3731, "num_module_steps_trained": 16000, "num_module_steps_trained_lifetime": 96000, "num_non_trainable_parameters": 0, "num_env_steps_trained": 81600, "num_env_steps_trained_lifetime_throughput": 1093885.4457367037, "num_module_steps_trained_throughput": 215115.37863815264, "num_module_steps_trained_lifetime_throughput": 214960.74115912584}}, "num_training_step_calls_per_iteration": 1, "evaluation": {"env_runners": {"episode_duration_sec_mean": 0.03450434701995619, "episode_len_min": 50, "num_env_steps_sampled": 1000, "num_agent_steps_sampled": {"default_agent": 1000}, "num_episodes_lifetime": 120, "env_reset_timer": 0.0002192051827729259, "num_agent_steps_sampled_lifetime": {"default_agent": 6000}, "rlmodule_inference_timer": 9.053796318216375e-05, "episode_return_mean": -0.1, "episode_len_mean": 50.0, "env_to_module_connector": {"timers": {"connectors": {"add_states_from_episodes_to_batch": 3.132148097228912e-06, "add_time_dim_to_batch_and_zero_pad": 5.341770860630522e-06, "numpy_to_tensor": 2.9178213296615946e-05, "batch_individual_items": 1.8650794099059376e-05, "add_observations_from_episodes_to_batch": 6.3542161784321995e-06}}, "connector_pipeline_timer": 0.0001104490664879612}, "agent_episode_returns_mean": {"default_agent": -0.1}, "env_to_module_sum_episodes_length_out": 27.168093332126602, "module_episode_returns_mean": {"default_policy": -0.1}, "sample": 0.7225626669436486, "env_to_module_sum_episodes_length_in": 27.168093332126602, "num_episodes": 20, "num_module_steps_sampled": {"default_policy": 1000}, "module_to_env_connector": {"timers": {"connectors": {"un_batch_to_individual_items": 1.546232326882373e-05, "get_actions": 0.0001514074073701162, "normalize_and_clip_actions": 2.2133730153453567e-05, "tensor_to_numpy": 4.610055737213566e-05, "remove_single_ts_time_rank_from_batch": 1.3447418526342509e-06, "listify_data_for_vector_env": 3.0822367081144965e-05}}, "connector_pipeline_timer": 0.0003374990128777678}, "episode_len_max": 50, "env_step_timer": 4.134656659732513e-05, "episode_return_max": 17.5, "weights_seq_no": 6.0, "num_env_steps_sampled_lifetime": 31000, "episode_return_min": -14.5, "num_module_steps_sampled_lifetime": {"default_policy": 6000}, "time_between_sampling": 4.204473269464978}, "num_healthy_workers": 1, "actor_manager_num_outstanding_async_reqs": 0, "num_remote_worker_restarts": 0}, "num_env_steps_sampled_lifetime": -960000.0, "fault_tolerance": {"num_healthy_workers": 0, "num_remote_worker_restarts": 0}, "env_runner_group": {"actor_manager_num_outstanding_async_reqs": 0}, "done": false, "training_iteration": 6, "trial_id": "a530a_00000", "date": "2025-08-11_17-25-42", "timestamp": 1754925942, "time_this_iter_s": 5.024385213851929, "time_total_s": 29.828192472457886, "pid": 75896, "hostname": "DESKTOP-3SK5A41", "node_ip": "192.168.40.242", "config": {"exploration_config": {}, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 6, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "env": "Umbrella", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": false, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 0, "create_local_env_runner": true, "num_envs_per_env_runner": 1, "gym_env_vectorize_mode": "SYNC", "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "episodes_to_numpy": true, "max_requests_in_flight_per_env_runner": 1, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "merge_env_runner_states": "training_only", "broadcast_env_runner_states": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "complete_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "sampler_perf_stats_ema_coef": null, "_is_online": true, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": "auto", "num_aggregator_actors_per_learner": 0, "max_requests_in_flight_per_aggregator_actor": 3, "local_gpu_idx": 0, "max_requests_in_flight_per_learner": 3, "gamma": 1, "lr": 0.0049847823121, "grad_clip": 0.5, "grad_clip_by": "global_norm", "_train_batch_size_per_learner": 5000, "train_batch_size": 4000, "num_epochs": 3, "minibatch_size": 1000, "shuffle_batch_per_epoch": true, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "log_std_clip_param": 20.0, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "_disable_preprocessor_api": false, "_disable_action_flattening": false}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "_learner_class": null, "callbacks_on_algorithm_init": null, "callbacks_on_env_runners_recreated": null, "callbacks_on_offline_eval_runners_recreated": null, "callbacks_on_checkpoint_loaded": null, "callbacks_on_environment_created": null, "callbacks_on_episode_created": null, "callbacks_on_episode_start": null, "callbacks_on_episode_step": null, "callbacks_on_episode_end": null, "callbacks_on_evaluate_start": null, "callbacks_on_evaluate_end": null, "callbacks_on_evaluate_offline_start": null, "callbacks_on_evaluate_offline_end": null, "callbacks_on_sample_end": null, "callbacks_on_train_result": null, "explore": true, "enable_rl_module_and_learner": true, "enable_env_runner_and_connector_v2": true, "_prior_exploration_config": {"type": "StochasticSampling"}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7f44639f2ac0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "offline_data_class": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_read_batch_size": null, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "materialize_data": false, "materialize_mapped_data": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "ignore_final_observation": false, "prelearner_class": null, "prelearner_buffer_class": null, "prelearner_buffer_kwargs": {}, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_remaining_data": false, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": 1, "evaluation_duration": 20, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_auto_duration_min_env_steps_per_sample": 100, "evaluation_auto_duration_max_env_steps_per_sample": 2000, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 1, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "offline_evaluation_interval": null, "num_offline_eval_runners": 0, "offline_loss_for_module_fn": null, "offline_evaluation_duration": 1, "offline_evaluation_parallel_to_training": false, "offline_evaluation_timeout_s": 120.0, "num_cpus_per_offline_eval_runner": 1, "num_gpus_per_offline_eval_runner": 0, "custom_resources_per_offline_eval_runner": {}, "restart_failed_offline_eval_runners": true, "ignore_offline_eval_runner_failures": false, "max_num_offline_eval_runner_restarts": 1000, "offline_eval_runner_restore_timeout_s": 1800.0, "max_requests_in_flight_per_offline_eval_runner": 1, "validate_offline_eval_runners_after_construction": true, "offline_eval_runner_health_probe_timeout_s": 30.0, "offline_eval_rl_module_inference_only": false, "broadcast_offline_eval_runner_states": false, "offline_eval_batch_size_per_runner": 256, "dataset_num_iters_per_eval_runner": 1, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "log_gradients": true, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 42, "restart_failed_env_runners": true, "ignore_env_runner_failures": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30.0, "env_runner_restore_timeout_s": 1800.0, "_model_config": {}, "_rl_module_spec": "RLModuleSpec(module_class=None, observation_space=None, action_space=None, inference_only=False, learner_only=False, model_config=DefaultModelConfig(fcnet_hiddens=[68, 48], fcnet_activation='tanh', fcnet_kernel_initializer=None, fcnet_kernel_initializer_kwargs=None, fcnet_bias_initializer=None, fcnet_bias_initializer_kwargs=None, conv_filters=None, conv_activation='relu', conv_kernel_initializer=None, conv_kernel_initializer_kwargs=None, conv_bias_initializer=None, conv_bias_initializer_kwargs=None, head_fcnet_hiddens=[], head_fcnet_activation='relu', head_fcnet_kernel_initializer=None, head_fcnet_kernel_initializer_kwargs=None, head_fcnet_bias_initializer=None, head_fcnet_bias_initializer_kwargs=None, free_log_std=False, log_std_clip_param=20.0, vf_share_layers=True, use_lstm=False, max_seq_len=20, lstm_cell_size=256, lstm_use_prev_action=False, lstm_use_prev_reward=False, lstm_kernel_initializer=None, lstm_kernel_initializer_kwargs=None, lstm_bias_initializer=None, lstm_bias_initializer_kwargs=None), catalog_class=None, load_state_path=None, model_config_dict=None)", "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "_validate_config": true, "_use_msgpack_checkpoints": false, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "env_task_fn": -1, "enable_connectors": -1, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.6551508793305, "kl_target": 0.018007117439, "vf_loss_coeff": 0.7591243664964, "entropy_coeff": 0.0132828111413, "clip_param": 0.1193136467235, "vf_clip_param": 0.3889481243011, "entropy_coeff_schedule": null, "lr_schedule": null, "sgd_minibatch_size": -1, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9141150497384, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.callbacks.callbacks.RLlibCallback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 29.828192472457886, "iterations_since_restore": 6, "perf": {"cpu_util_percent": 12.557142857142855, "ram_util_percent": 87.61428571428573}}
{"timers": {"training_iteration": 4.2958660236571236, "restore_env_runners": 1.4586193655351541e-05, "training_step": 4.295635820484032, "env_runner_sampling_timer": 3.842101582111, "learner_update_timer": 0.44992963364495975, "synch_weights": 0.0015997494001478581, "restore_eval_env_runners": 1.400878364034433e-05, "evaluation_iteration": 0.7348033298614197, "synch_eval_env_connectors": 0.0004452286517435346, "synch_env_connectors": 9.759634531405054e-06}, "env_runners": {"env_to_module_sum_episodes_length_in": 27.16809333212661, "episode_return_min": -5.5, "weights_seq_no": 6.0, "num_episodes_lifetime": -24050.0, "num_episodes": 100.0, "rlmodule_inference_timer": 0.00010071778895745298, "env_reset_timer": 9.64180089442645e-05, "num_module_steps_sampled_lifetime": {"default_policy": -1202500.0}, "env_to_module_connector": {"timers": {"connectors": {"add_observations_from_episodes_to_batch": 6.250064551011857e-06, "numpy_to_tensor": 3.14347505502886e-05, "add_time_dim_to_batch_and_zero_pad": 6.4105965121020956e-06, "batch_individual_items": 1.863385210533989e-05, "add_states_from_episodes_to_batch": 3.4737816728998883e-06}}, "connector_pipeline_timer": 0.00011891458428470399}, "time_between_sampling": 0.012599147137187364, "module_to_env_connector": {"timers": {"connectors": {"get_actions": 0.00016749815110346722, "un_batch_to_individual_items": 1.5059485124624375e-05, "normalize_and_clip_actions": 2.2181880800838952e-05, "tensor_to_numpy": 5.015519447796508e-05, "remove_single_ts_time_rank_from_batch": 1.6110474545833197e-06, "listify_data_for_vector_env": 3.08750518604239e-05}}, "connector_pipeline_timer": 0.00036464687457176304}, "num_env_steps_sampled_lifetime": -1202500.0, "episode_len_max": 50, "episode_return_mean": 10.299999999999997, "agent_episode_returns_mean": {"default_agent": 10.299999999999997}, "env_step_timer": 4.3742066850728575e-05, "episode_len_mean": 50.0, "module_episode_returns_mean": {"default_policy": 10.299999999999997}, "num_env_steps_sampled": 5000.0, "episode_return_max": 14.5, "env_to_module_sum_episodes_length_out": 27.16809333212661, "num_agent_steps_sampled": {"default_agent": 5000.0}, "num_agent_steps_sampled_lifetime": {"default_agent": -1202500.0}, "episode_duration_sec_mean": 0.0367537330399955, "num_module_steps_sampled": {"default_policy": 5000.0}, "episode_len_min": 50, "sample": 0.037683629498501764, "num_env_steps_sampled_lifetime_throughput": 1273.774066040788}, "learners": {"default_policy": {"vf_loss": 0.27280640602111816, "num_module_steps_trained_lifetime": 112000, "policy_loss": 0.0479143001139164, "gradients_default_optimizer_global_norm": 0.1919170618057251, "num_module_steps_trained": 16000, "default_optimizer_learning_rate": 0.0049847823121, "curr_kl_coeff": 0.005118366330862045, "vf_explained_var": 0.6615949869155884, "mean_kl_loss": 0.003913315013051033, "total_loss": 0.24662838876247406, "curr_entropy_coeff": 0.0132828111413, "module_train_batch_size_mean": 1000.0, "entropy": 0.6338986754417419, "diff_num_grad_updates_vs_sampler_policy": 1.0, "vf_loss_unclipped": 11.219463348388672, "weights_seq_no": 7.0, "num_trainable_parameters": 3731, "num_module_steps_trained_lifetime_throughput": 213657.09002048348}, "__all_modules__": {"learner_connector": {"timers": {"connectors": {"numpy_to_tensor": 0.00017038129420401225, "batch_individual_items": 0.19991754056361363, "add_observations_from_episodes_to_batch": 0.000938680605913458, "add_one_ts_to_episodes_and_truncate": 0.008695298919262778, "add_columns_from_episodes_to_train_batch": 0.07250014329845923, "general_advantage_estimation": 0.011091842415269951, "add_states_from_episodes_to_batch": 6.182873484444105e-06, "add_time_dim_to_batch_and_zero_pad": 2.3419292121116786e-05}}, "connector_pipeline_timer": 0.29367469836670196}, "learner_connector_sum_episodes_length_out": 5100.0, "num_env_steps_trained_lifetime": 571200, "learner_connector_sum_episodes_length_in": 5000.0, "num_trainable_parameters": 3731, "num_module_steps_trained": 16000, "num_module_steps_trained_lifetime": 112000, "num_non_trainable_parameters": 0, "num_env_steps_trained": 81600, "num_env_steps_trained_lifetime_throughput": 1084856.0572552702, "num_module_steps_trained_throughput": 213315.04745796885, "num_module_steps_trained_lifetime_throughput": 213167.41322367868}}, "num_training_step_calls_per_iteration": 1, "evaluation": {"env_runners": {"episode_duration_sec_mean": 0.03453808701999151, "episode_len_min": 50, "num_env_steps_sampled": 1000, "num_agent_steps_sampled": {"default_agent": 1000}, "num_episodes_lifetime": 140, "env_reset_timer": 0.00021826713094407697, "num_agent_steps_sampled_lifetime": {"default_agent": 7000}, "rlmodule_inference_timer": 9.053134939247303e-05, "episode_return_mean": -0.3, "episode_len_mean": 50.0, "env_to_module_connector": {"timers": {"connectors": {"add_states_from_episodes_to_batch": 3.148582250837169e-06, "add_time_dim_to_batch_and_zero_pad": 5.425067947897305e-06, "numpy_to_tensor": 2.8872995066215604e-05, "batch_individual_items": 1.823430235323835e-05, "add_observations_from_episodes_to_batch": 6.554804518270649e-06}}, "connector_pipeline_timer": 0.00011025120820249063}, "agent_episode_returns_mean": {"default_agent": -0.3}, "env_to_module_sum_episodes_length_out": 27.168093332126602, "module_episode_returns_mean": {"default_policy": -0.3}, "sample": 0.7225339612742163, "env_to_module_sum_episodes_length_in": 27.168093332126602, "num_episodes": 20, "num_module_steps_sampled": {"default_policy": 1000}, "module_to_env_connector": {"timers": {"connectors": {"un_batch_to_individual_items": 1.5416118004199243e-05, "get_actions": 0.0001530996753681107, "normalize_and_clip_actions": 2.1782980201831675e-05, "tensor_to_numpy": 4.5263367321724886e-05, "remove_single_ts_time_rank_from_batch": 1.3819963864799988e-06, "listify_data_for_vector_env": 3.065648049675379e-05}}, "connector_pipeline_timer": 0.00033765735547549094}, "episode_len_max": 50, "env_step_timer": 4.208989867822246e-05, "episode_return_max": 17.5, "weights_seq_no": 7.0, "num_env_steps_sampled_lifetime": 36000, "episode_return_min": -16.5, "num_module_steps_sampled_lifetime": {"default_policy": 7000}, "time_between_sampling": 4.204687792810325}, "num_healthy_workers": 1, "actor_manager_num_outstanding_async_reqs": 0, "num_remote_worker_restarts": 0}, "num_env_steps_sampled_lifetime": -1202500.0, "fault_tolerance": {"num_healthy_workers": 0, "num_remote_worker_restarts": 0}, "env_runner_group": {"actor_manager_num_outstanding_async_reqs": 0}, "done": true, "training_iteration": 7, "trial_id": "a530a_00000", "date": "2025-08-11_17-25-47", "timestamp": 1754925947, "time_this_iter_s": 4.906347751617432, "time_total_s": 34.73454022407532, "pid": 75896, "hostname": "DESKTOP-3SK5A41", "node_ip": "192.168.40.242", "config": {"exploration_config": {}, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 6, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "env": "Umbrella", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": false, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 0, "create_local_env_runner": true, "num_envs_per_env_runner": 1, "gym_env_vectorize_mode": "SYNC", "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "episodes_to_numpy": true, "max_requests_in_flight_per_env_runner": 1, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "merge_env_runner_states": "training_only", "broadcast_env_runner_states": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "complete_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "sampler_perf_stats_ema_coef": null, "_is_online": true, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": "auto", "num_aggregator_actors_per_learner": 0, "max_requests_in_flight_per_aggregator_actor": 3, "local_gpu_idx": 0, "max_requests_in_flight_per_learner": 3, "gamma": 1, "lr": 0.0049847823121, "grad_clip": 0.5, "grad_clip_by": "global_norm", "_train_batch_size_per_learner": 5000, "train_batch_size": 4000, "num_epochs": 3, "minibatch_size": 1000, "shuffle_batch_per_epoch": true, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "log_std_clip_param": 20.0, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "_disable_preprocessor_api": false, "_disable_action_flattening": false}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "_learner_class": null, "callbacks_on_algorithm_init": null, "callbacks_on_env_runners_recreated": null, "callbacks_on_offline_eval_runners_recreated": null, "callbacks_on_checkpoint_loaded": null, "callbacks_on_environment_created": null, "callbacks_on_episode_created": null, "callbacks_on_episode_start": null, "callbacks_on_episode_step": null, "callbacks_on_episode_end": null, "callbacks_on_evaluate_start": null, "callbacks_on_evaluate_end": null, "callbacks_on_evaluate_offline_start": null, "callbacks_on_evaluate_offline_end": null, "callbacks_on_sample_end": null, "callbacks_on_train_result": null, "explore": true, "enable_rl_module_and_learner": true, "enable_env_runner_and_connector_v2": true, "_prior_exploration_config": {"type": "StochasticSampling"}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7f44639f2ac0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "offline_data_class": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_read_batch_size": null, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "materialize_data": false, "materialize_mapped_data": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "ignore_final_observation": false, "prelearner_class": null, "prelearner_buffer_class": null, "prelearner_buffer_kwargs": {}, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_remaining_data": false, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": 1, "evaluation_duration": 20, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_auto_duration_min_env_steps_per_sample": 100, "evaluation_auto_duration_max_env_steps_per_sample": 2000, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 1, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "offline_evaluation_interval": null, "num_offline_eval_runners": 0, "offline_loss_for_module_fn": null, "offline_evaluation_duration": 1, "offline_evaluation_parallel_to_training": false, "offline_evaluation_timeout_s": 120.0, "num_cpus_per_offline_eval_runner": 1, "num_gpus_per_offline_eval_runner": 0, "custom_resources_per_offline_eval_runner": {}, "restart_failed_offline_eval_runners": true, "ignore_offline_eval_runner_failures": false, "max_num_offline_eval_runner_restarts": 1000, "offline_eval_runner_restore_timeout_s": 1800.0, "max_requests_in_flight_per_offline_eval_runner": 1, "validate_offline_eval_runners_after_construction": true, "offline_eval_runner_health_probe_timeout_s": 30.0, "offline_eval_rl_module_inference_only": false, "broadcast_offline_eval_runner_states": false, "offline_eval_batch_size_per_runner": 256, "dataset_num_iters_per_eval_runner": 1, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "log_gradients": true, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 42, "restart_failed_env_runners": true, "ignore_env_runner_failures": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30.0, "env_runner_restore_timeout_s": 1800.0, "_model_config": {}, "_rl_module_spec": "RLModuleSpec(module_class=None, observation_space=None, action_space=None, inference_only=False, learner_only=False, model_config=DefaultModelConfig(fcnet_hiddens=[68, 48], fcnet_activation='tanh', fcnet_kernel_initializer=None, fcnet_kernel_initializer_kwargs=None, fcnet_bias_initializer=None, fcnet_bias_initializer_kwargs=None, conv_filters=None, conv_activation='relu', conv_kernel_initializer=None, conv_kernel_initializer_kwargs=None, conv_bias_initializer=None, conv_bias_initializer_kwargs=None, head_fcnet_hiddens=[], head_fcnet_activation='relu', head_fcnet_kernel_initializer=None, head_fcnet_kernel_initializer_kwargs=None, head_fcnet_bias_initializer=None, head_fcnet_bias_initializer_kwargs=None, free_log_std=False, log_std_clip_param=20.0, vf_share_layers=True, use_lstm=False, max_seq_len=20, lstm_cell_size=256, lstm_use_prev_action=False, lstm_use_prev_reward=False, lstm_kernel_initializer=None, lstm_kernel_initializer_kwargs=None, lstm_bias_initializer=None, lstm_bias_initializer_kwargs=None), catalog_class=None, load_state_path=None, model_config_dict=None)", "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "_validate_config": true, "_use_msgpack_checkpoints": false, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "env_task_fn": -1, "enable_connectors": -1, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.6551508793305, "kl_target": 0.018007117439, "vf_loss_coeff": 0.7591243664964, "entropy_coeff": 0.0132828111413, "clip_param": 0.1193136467235, "vf_clip_param": 0.3889481243011, "entropy_coeff_schedule": null, "lr_schedule": null, "sgd_minibatch_size": -1, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9141150497384, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.callbacks.callbacks.RLlibCallback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 34.73454022407532, "iterations_since_restore": 7, "perf": {"cpu_util_percent": 13.028571428571427, "ram_util_percent": 87.6857142857143}}
