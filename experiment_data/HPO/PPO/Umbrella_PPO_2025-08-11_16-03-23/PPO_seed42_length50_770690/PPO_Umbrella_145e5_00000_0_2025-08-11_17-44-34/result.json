{"timers": {"training_iteration": 4.353445290000309, "restore_env_runners": 1.5100000382517464e-05, "training_step": 4.353207289999773, "env_runner_sampling_timer": 3.8677297900003396, "learner_update_timer": 0.48203990000001795, "synch_weights": 0.001485099999626982}, "env_runners": {"module_to_env_connector": {"timers": {"connectors": {"normalize_and_clip_actions": 2.872399720170608e-05, "get_actions": 0.00016872804518664825, "un_batch_to_individual_items": 1.451557890489875e-05, "listify_data_for_vector_env": 3.151787636499733e-05, "tensor_to_numpy": 4.793998337701429e-05, "remove_single_ts_time_rank_from_batch": 1.509073769936831e-06}}, "connector_pipeline_timer": 0.00037093111425550514}, "env_reset_timer": 0.00020434746902010602, "env_to_module_connector": {"connector_pipeline_timer": 0.00012197472908024021, "timers": {"connectors": {"add_time_dim_to_batch_and_zero_pad": 6.829973236149835e-06, "add_states_from_episodes_to_batch": 3.5039218505412078e-06, "add_observations_from_episodes_to_batch": 6.439850489907239e-06, "batch_individual_items": 1.860098943937751e-05, "numpy_to_tensor": 3.1586588017163395e-05}}}, "num_module_steps_sampled": {"default_policy": 5000.0}, "num_env_steps_sampled_lifetime": 252500.0, "episode_duration_sec_mean": 0.03616681689996769, "env_to_module_sum_episodes_length_in": 26.762340024562445, "num_episodes_lifetime": 5050.0, "env_step_timer": 4.437692426076804e-05, "rlmodule_inference_timer": 0.00010676122777484664, "agent_episode_returns_mean": {"default_agent": 5.299999999999998}, "num_episodes": 100.0, "episode_len_mean": 50.0, "num_module_steps_sampled_lifetime": {"default_policy": 252500.0}, "module_episode_returns_mean": {"default_policy": 5.299999999999998}, "episode_return_mean": 5.299999999999998, "sample": 0.042461139886002364, "weights_seq_no": 0.0, "episode_len_min": 50, "episode_len_max": 50, "num_env_steps_sampled": 5000.0, "num_agent_steps_sampled": {"default_agent": 5000.0}, "episode_return_min": -5.5, "episode_return_max": 14.5, "env_to_module_sum_episodes_length_out": 26.762340024562445, "time_between_sampling": 0.0013048586092731394, "num_agent_steps_sampled_lifetime": {"default_agent": 252500.0}, "num_env_steps_sampled_lifetime_throughput": 1233.3678598966037}, "learners": {"__all_modules__": {"num_module_steps_trained": 16000, "num_trainable_parameters": 5447, "learner_connector": {"timers": {"connectors": {"batch_individual_items": 0.20761309999943478, "numpy_to_tensor": 0.0001720000000204891, "add_one_ts_to_episodes_and_truncate": 0.008534199999303382, "add_observations_from_episodes_to_batch": 0.0008089000002655666, "add_columns_from_episodes_to_train_batch": 0.06802989999960118, "add_time_dim_to_batch_and_zero_pad": 2.299999960087007e-05, "add_states_from_episodes_to_batch": 6.299999768089037e-06, "general_advantage_estimation": 0.011778799999774492}}, "connector_pipeline_timer": 0.2973359999996319}, "learner_connector_sum_episodes_length_in": 5000, "num_non_trainable_parameters": 0, "num_env_steps_trained": 81600, "num_module_steps_trained_lifetime": 16000, "learner_connector_sum_episodes_length_out": 5100, "num_env_steps_trained_lifetime": 81600, "num_env_steps_trained_lifetime_throughput": 840132.4104542171, "num_module_steps_trained_throughput": 165274.36471969375, "num_module_steps_trained_lifetime_throughput": 165159.0454724889}, "default_policy": {"num_module_steps_trained": 16000, "diff_num_grad_updates_vs_sampler_policy": 1.0, "entropy": 0.6772110462188721, "total_loss": 0.0235255416482687, "num_trainable_parameters": 5447, "policy_loss": -0.031538140028715134, "mean_kl_loss": 0.0204129908233881, "module_train_batch_size_mean": 1000.0, "curr_entropy_coeff": 0.0454572554143, "vf_explained_var": -0.31175148487091064, "gradients_default_optimizer_global_norm": 0.2739955484867096, "default_optimizer_learning_rate": 0.0507729549118, "num_module_steps_trained_lifetime": 16000, "weights_seq_no": 1.0, "curr_kl_coeff": 0.2807905972003937, "vf_loss_unclipped": 40.044254302978516, "vf_loss": 0.1055346205830574, "num_module_steps_trained_lifetime_throughput": 165575.1361636449}}, "num_training_step_calls_per_iteration": 1, "num_env_steps_sampled_lifetime": 252500.0, "evaluation": {"env_runners": {"num_episodes_lifetime": 20, "env_step_timer": 4.2329263836119504e-05, "module_to_env_connector": {"timers": {"connectors": {"normalize_and_clip_actions": 2.1754458093947096e-05, "get_actions": 0.00015703802751591806, "tensor_to_numpy": 4.623211922457548e-05, "un_batch_to_individual_items": 1.4922530232778701e-05, "remove_single_ts_time_rank_from_batch": 1.4409167512290167e-06, "listify_data_for_vector_env": 3.0092313103346438e-05}}, "connector_pipeline_timer": 0.0003431657870897325}, "env_to_module_connector": {"connector_pipeline_timer": 0.00011324098367370984, "timers": {"connectors": {"numpy_to_tensor": 3.0228024763753005e-05, "batch_individual_items": 1.7834899625599475e-05, "add_observations_from_episodes_to_batch": 5.820442215098567e-06, "add_time_dim_to_batch_and_zero_pad": 6.306722174537963e-06, "add_states_from_episodes_to_batch": 3.424531471027242e-06}}}, "sample": 0.7358530999999857, "episode_len_max": 50, "num_env_steps_sampled": 1000, "episode_return_max": 13.5, "env_to_module_sum_episodes_length_out": 27.167134025045954, "env_reset_timer": 0.0003645999995569582, "episode_duration_sec_mean": 0.03535366499995689, "env_to_module_sum_episodes_length_in": 27.167134025045954, "rlmodule_inference_timer": 9.711884993841961e-05, "episode_return_mean": -0.9, "weights_seq_no": 1.0, "episode_len_min": 50, "num_module_steps_sampled_lifetime": {"default_policy": 1000}, "num_agent_steps_sampled": {"default_agent": 1000}, "num_agent_steps_sampled_lifetime": {"default_agent": 1000}, "num_env_steps_sampled_lifetime": 6000, "num_episodes": 20, "episode_len_mean": 50.0, "agent_episode_returns_mean": {"default_agent": -0.9}, "num_module_steps_sampled": {"default_policy": 1000}, "module_episode_returns_mean": {"default_policy": -0.9}, "episode_return_min": -14.5}, "num_healthy_workers": 1, "actor_manager_num_outstanding_async_reqs": 0, "num_remote_worker_restarts": 0}, "fault_tolerance": {"num_healthy_workers": 0, "num_remote_worker_restarts": 0}, "env_runner_group": {"actor_manager_num_outstanding_async_reqs": 0}, "done": false, "training_iteration": 1, "trial_id": "145e5_00000", "date": "2025-08-11_17-51-41", "timestamp": 1754927501, "time_this_iter_s": 5.10477352142334, "time_total_s": 5.10477352142334, "pid": 98861, "hostname": "DESKTOP-3SK5A41", "node_ip": "192.168.40.242", "config": {"exploration_config": {}, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 6, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "env": "Umbrella", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": false, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 0, "create_local_env_runner": true, "num_envs_per_env_runner": 1, "gym_env_vectorize_mode": "SYNC", "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "episodes_to_numpy": true, "max_requests_in_flight_per_env_runner": 1, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "merge_env_runner_states": "training_only", "broadcast_env_runner_states": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "complete_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "sampler_perf_stats_ema_coef": null, "_is_online": true, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": "auto", "num_aggregator_actors_per_learner": 0, "max_requests_in_flight_per_aggregator_actor": 3, "local_gpu_idx": 0, "max_requests_in_flight_per_learner": 3, "gamma": 1, "lr": 0.0507729549118, "grad_clip": 0.5, "grad_clip_by": "global_norm", "_train_batch_size_per_learner": 5000, "train_batch_size": 4000, "num_epochs": 3, "minibatch_size": 1000, "shuffle_batch_per_epoch": true, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "log_std_clip_param": 20.0, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "_disable_preprocessor_api": false, "_disable_action_flattening": false}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "_learner_class": null, "callbacks_on_algorithm_init": null, "callbacks_on_env_runners_recreated": null, "callbacks_on_offline_eval_runners_recreated": null, "callbacks_on_checkpoint_loaded": null, "callbacks_on_environment_created": null, "callbacks_on_episode_created": null, "callbacks_on_episode_start": null, "callbacks_on_episode_step": null, "callbacks_on_episode_end": null, "callbacks_on_evaluate_start": null, "callbacks_on_evaluate_end": null, "callbacks_on_evaluate_offline_start": null, "callbacks_on_evaluate_offline_end": null, "callbacks_on_sample_end": null, "callbacks_on_train_result": null, "explore": true, "enable_rl_module_and_learner": true, "enable_env_runner_and_connector_v2": true, "_prior_exploration_config": {"type": "StochasticSampling"}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7c54f75b6ac0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "offline_data_class": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_read_batch_size": null, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "materialize_data": false, "materialize_mapped_data": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "ignore_final_observation": false, "prelearner_class": null, "prelearner_buffer_class": null, "prelearner_buffer_kwargs": {}, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_remaining_data": false, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": 1, "evaluation_duration": 20, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_auto_duration_min_env_steps_per_sample": 100, "evaluation_auto_duration_max_env_steps_per_sample": 2000, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 1, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "offline_evaluation_interval": null, "num_offline_eval_runners": 0, "offline_loss_for_module_fn": null, "offline_evaluation_duration": 1, "offline_evaluation_parallel_to_training": false, "offline_evaluation_timeout_s": 120.0, "num_cpus_per_offline_eval_runner": 1, "num_gpus_per_offline_eval_runner": 0, "custom_resources_per_offline_eval_runner": {}, "restart_failed_offline_eval_runners": true, "ignore_offline_eval_runner_failures": false, "max_num_offline_eval_runner_restarts": 1000, "offline_eval_runner_restore_timeout_s": 1800.0, "max_requests_in_flight_per_offline_eval_runner": 1, "validate_offline_eval_runners_after_construction": true, "offline_eval_runner_health_probe_timeout_s": 30.0, "offline_eval_rl_module_inference_only": false, "broadcast_offline_eval_runner_states": false, "offline_eval_batch_size_per_runner": 256, "dataset_num_iters_per_eval_runner": 1, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "log_gradients": true, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 42, "restart_failed_env_runners": true, "ignore_env_runner_failures": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30.0, "env_runner_restore_timeout_s": 1800.0, "_model_config": {}, "_rl_module_spec": "RLModuleSpec(module_class=None, observation_space=None, action_space=None, inference_only=False, learner_only=False, model_config=DefaultModelConfig(fcnet_hiddens=[38, 126], fcnet_activation='tanh', fcnet_kernel_initializer=None, fcnet_kernel_initializer_kwargs=None, fcnet_bias_initializer=None, fcnet_bias_initializer_kwargs=None, conv_filters=None, conv_activation='relu', conv_kernel_initializer=None, conv_kernel_initializer_kwargs=None, conv_bias_initializer=None, conv_bias_initializer_kwargs=None, head_fcnet_hiddens=[], head_fcnet_activation='relu', head_fcnet_kernel_initializer=None, head_fcnet_kernel_initializer_kwargs=None, head_fcnet_bias_initializer=None, head_fcnet_bias_initializer_kwargs=None, free_log_std=False, log_std_clip_param=20.0, vf_share_layers=True, use_lstm=False, max_seq_len=20, lstm_cell_size=256, lstm_use_prev_action=False, lstm_use_prev_reward=False, lstm_kernel_initializer=None, lstm_kernel_initializer_kwargs=None, lstm_bias_initializer=None, lstm_bias_initializer_kwargs=None), catalog_class=None, load_state_path=None, model_config_dict=None)", "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "_validate_config": true, "_use_msgpack_checkpoints": false, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "env_task_fn": -1, "enable_connectors": -1, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2807905848935, "kl_target": 0.0268196110247, "vf_loss_coeff": 0.7591449667272, "entropy_coeff": 0.0454572554143, "clip_param": 0.2757781835805, "vf_clip_param": 0.1077321361793, "entropy_coeff_schedule": null, "lr_schedule": null, "sgd_minibatch_size": -1, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9403062964939, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.callbacks.callbacks.RLlibCallback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 5.10477352142334, "iterations_since_restore": 1, "perf": {"cpu_util_percent": 11.337499999999999, "ram_util_percent": 83.1625}}
{"timers": {"training_iteration": 4.351871549080306, "restore_env_runners": 1.5085000377439428e-05, "training_step": 4.351631887079774, "env_runner_sampling_timer": 3.868486080080329, "learner_update_timer": 0.4797060410000176, "synch_weights": 0.0014850189996286644, "restore_eval_env_runners": 1.4000000192027073e-05, "evaluation_iteration": 0.7476075999993554, "synch_eval_env_connectors": 0.0005718000002161716, "synch_env_connectors": 7.800000275892671e-06}, "env_runners": {"module_to_env_connector": {"timers": {"connectors": {"normalize_and_clip_actions": 2.2410302745906304e-05, "get_actions": 0.0001661593035657667, "un_batch_to_individual_items": 1.4509003599959846e-05, "listify_data_for_vector_env": 3.1394706096742454e-05, "tensor_to_numpy": 4.99902646125353e-05, "remove_single_ts_time_rank_from_batch": 1.5121546733077952e-06}}, "connector_pipeline_timer": 0.0003631952001933814}, "env_reset_timer": 0.00013407404612131164, "env_to_module_connector": {"connector_pipeline_timer": 0.00011920755757999804, "timers": {"connectors": {"add_time_dim_to_batch_and_zero_pad": 6.6180627384857534e-06, "add_states_from_episodes_to_batch": 3.4509603937128823e-06, "add_observations_from_episodes_to_batch": 6.345059761905523e-06, "batch_individual_items": 1.852432466839117e-05, "numpy_to_tensor": 3.157506559100923e-05}}}, "num_module_steps_sampled": {"default_policy": 5000.0}, "num_env_steps_sampled_lifetime": 10000.0, "episode_duration_sec_mean": 0.03687042598002334, "env_to_module_sum_episodes_length_in": 27.16809333212661, "num_episodes_lifetime": 200.0, "env_step_timer": 4.3330395394193956e-05, "rlmodule_inference_timer": 0.00010363117730533689, "agent_episode_returns_mean": {"default_agent": 2.3000000000000007}, "num_episodes": 100.0, "episode_len_mean": 50.0, "num_module_steps_sampled_lifetime": {"default_policy": 10000.0}, "module_episode_returns_mean": {"default_policy": 2.3000000000000007}, "episode_return_mean": 2.3000000000000007, "sample": 0.039433157521747385, "weights_seq_no": 1.0, "episode_len_min": 50, "episode_len_max": 50, "num_env_steps_sampled": 5000.0, "num_agent_steps_sampled": {"default_agent": 5000.0}, "episode_return_min": -5.5, "episode_return_max": 14.5, "env_to_module_sum_episodes_length_out": 27.16809333212661, "time_between_sampling": 0.009471412598035462, "num_agent_steps_sampled_lifetime": {"default_agent": 10000.0}, "num_env_steps_sampled_lifetime_throughput": 1271.33269010747}, "learners": {"__all_modules__": {"num_module_steps_trained": 16000, "num_trainable_parameters": 5447, "learner_connector": {"timers": {"connectors": {"batch_individual_items": 0.20614906699943275, "numpy_to_tensor": 0.00017206700002134312, "add_one_ts_to_episodes_and_truncate": 0.008530901999311027, "add_observations_from_episodes_to_batch": 0.0008079180002641805, "add_columns_from_episodes_to_train_batch": 0.06803915399960715, "add_time_dim_to_batch_and_zero_pad": 2.300899960573588e-05, "add_states_from_episodes_to_batch": 6.34299976809416e-06, "general_advantage_estimation": 0.011761371999782567}}, "connector_pipeline_timer": 0.2958592519996364}, "learner_connector_sum_episodes_length_in": 5000.0, "num_non_trainable_parameters": 0, "num_env_steps_trained": 81600, "num_module_steps_trained_lifetime": 32000, "learner_connector_sum_episodes_length_out": 5100.0, "num_env_steps_trained_lifetime": 163200, "num_env_steps_trained_lifetime_throughput": 839417.4098246553, "num_module_steps_trained_throughput": 165120.584014833, "num_module_steps_trained_lifetime_throughput": 165006.76843949946}, "default_policy": {"num_module_steps_trained": 16000, "diff_num_grad_updates_vs_sampler_policy": 1.0, "entropy": 0.6918514370918274, "total_loss": 0.11443273723125458, "num_trainable_parameters": 5447, "policy_loss": 0.06363962590694427, "mean_kl_loss": 0.0016327780904248357, "module_train_batch_size_mean": 1000.0, "curr_entropy_coeff": 0.0454572554143, "vf_explained_var": -0.22801899909973145, "gradients_default_optimizer_global_norm": 0.06467491388320923, "default_optimizer_learning_rate": 0.0507729549118, "num_module_steps_trained_lifetime": 32000, "weights_seq_no": 2.0, "curr_kl_coeff": 0.14039529860019684, "vf_loss_unclipped": 281.791748046875, "vf_loss": 0.1077321395277977, "num_module_steps_trained_lifetime_throughput": 165410.83045811986}}, "num_training_step_calls_per_iteration": 1, "evaluation": {"env_runners": {"num_episodes_lifetime": 40, "env_step_timer": 4.1783975939339233e-05, "module_to_env_connector": {"timers": {"connectors": {"normalize_and_clip_actions": 2.2149574358717126e-05, "get_actions": 0.00015603472472255849, "tensor_to_numpy": 4.602822034778892e-05, "un_batch_to_individual_items": 1.5452062683622345e-05, "remove_single_ts_time_rank_from_batch": 1.5127789206634133e-06, "listify_data_for_vector_env": 3.026143257404642e-05}}, "connector_pipeline_timer": 0.00034386966098596053}, "env_to_module_connector": {"connector_pipeline_timer": 0.00011283134374885935, "timers": {"connectors": {"numpy_to_tensor": 2.9444693134987785e-05, "batch_individual_items": 1.7961064276961296e-05, "add_observations_from_episodes_to_batch": 5.9497493100741056e-06, "add_time_dim_to_batch_and_zero_pad": 6.293019854223262e-06, "add_states_from_episodes_to_batch": 3.4886916333914285e-06}}}, "sample": 0.7358179779899819, "episode_len_max": 50, "num_env_steps_sampled": 1000, "episode_return_max": 17.5, "env_to_module_sum_episodes_length_out": 27.168093298253442, "env_reset_timer": 0.0003622679995623912, "episode_duration_sec_mean": 0.03528518247503598, "env_to_module_sum_episodes_length_in": 27.168093298253442, "rlmodule_inference_timer": 9.686851325710412e-05, "episode_return_mean": 0.1, "weights_seq_no": 2.0, "episode_len_min": 50, "num_module_steps_sampled_lifetime": {"default_policy": 2000}, "num_agent_steps_sampled": {"default_agent": 1000}, "num_agent_steps_sampled_lifetime": {"default_agent": 2000}, "num_env_steps_sampled_lifetime": 11000, "num_episodes": 20, "episode_len_mean": 50.0, "agent_episode_returns_mean": {"default_agent": 0.1}, "num_module_steps_sampled": {"default_policy": 1000}, "module_episode_returns_mean": {"default_policy": 0.1}, "episode_return_min": -14.5, "time_between_sampling": 4.252229597999758}, "num_healthy_workers": 1, "actor_manager_num_outstanding_async_reqs": 0, "num_remote_worker_restarts": 0}, "num_env_steps_sampled_lifetime": 10000.0, "fault_tolerance": {"num_healthy_workers": 0, "num_remote_worker_restarts": 0}, "env_runner_group": {"actor_manager_num_outstanding_async_reqs": 0}, "done": false, "training_iteration": 2, "trial_id": "145e5_00000", "date": "2025-08-11_17-51-46", "timestamp": 1754927506, "time_this_iter_s": 4.942752838134766, "time_total_s": 10.047526359558105, "pid": 98861, "hostname": "DESKTOP-3SK5A41", "node_ip": "192.168.40.242", "config": {"exploration_config": {}, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 6, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "env": "Umbrella", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": false, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 0, "create_local_env_runner": true, "num_envs_per_env_runner": 1, "gym_env_vectorize_mode": "SYNC", "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "episodes_to_numpy": true, "max_requests_in_flight_per_env_runner": 1, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "merge_env_runner_states": "training_only", "broadcast_env_runner_states": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "complete_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "sampler_perf_stats_ema_coef": null, "_is_online": true, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": "auto", "num_aggregator_actors_per_learner": 0, "max_requests_in_flight_per_aggregator_actor": 3, "local_gpu_idx": 0, "max_requests_in_flight_per_learner": 3, "gamma": 1, "lr": 0.0507729549118, "grad_clip": 0.5, "grad_clip_by": "global_norm", "_train_batch_size_per_learner": 5000, "train_batch_size": 4000, "num_epochs": 3, "minibatch_size": 1000, "shuffle_batch_per_epoch": true, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "log_std_clip_param": 20.0, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "_disable_preprocessor_api": false, "_disable_action_flattening": false}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "_learner_class": null, "callbacks_on_algorithm_init": null, "callbacks_on_env_runners_recreated": null, "callbacks_on_offline_eval_runners_recreated": null, "callbacks_on_checkpoint_loaded": null, "callbacks_on_environment_created": null, "callbacks_on_episode_created": null, "callbacks_on_episode_start": null, "callbacks_on_episode_step": null, "callbacks_on_episode_end": null, "callbacks_on_evaluate_start": null, "callbacks_on_evaluate_end": null, "callbacks_on_evaluate_offline_start": null, "callbacks_on_evaluate_offline_end": null, "callbacks_on_sample_end": null, "callbacks_on_train_result": null, "explore": true, "enable_rl_module_and_learner": true, "enable_env_runner_and_connector_v2": true, "_prior_exploration_config": {"type": "StochasticSampling"}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7c54f75b6ac0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "offline_data_class": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_read_batch_size": null, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "materialize_data": false, "materialize_mapped_data": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "ignore_final_observation": false, "prelearner_class": null, "prelearner_buffer_class": null, "prelearner_buffer_kwargs": {}, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_remaining_data": false, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": 1, "evaluation_duration": 20, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_auto_duration_min_env_steps_per_sample": 100, "evaluation_auto_duration_max_env_steps_per_sample": 2000, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 1, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "offline_evaluation_interval": null, "num_offline_eval_runners": 0, "offline_loss_for_module_fn": null, "offline_evaluation_duration": 1, "offline_evaluation_parallel_to_training": false, "offline_evaluation_timeout_s": 120.0, "num_cpus_per_offline_eval_runner": 1, "num_gpus_per_offline_eval_runner": 0, "custom_resources_per_offline_eval_runner": {}, "restart_failed_offline_eval_runners": true, "ignore_offline_eval_runner_failures": false, "max_num_offline_eval_runner_restarts": 1000, "offline_eval_runner_restore_timeout_s": 1800.0, "max_requests_in_flight_per_offline_eval_runner": 1, "validate_offline_eval_runners_after_construction": true, "offline_eval_runner_health_probe_timeout_s": 30.0, "offline_eval_rl_module_inference_only": false, "broadcast_offline_eval_runner_states": false, "offline_eval_batch_size_per_runner": 256, "dataset_num_iters_per_eval_runner": 1, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "log_gradients": true, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 42, "restart_failed_env_runners": true, "ignore_env_runner_failures": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30.0, "env_runner_restore_timeout_s": 1800.0, "_model_config": {}, "_rl_module_spec": "RLModuleSpec(module_class=None, observation_space=None, action_space=None, inference_only=False, learner_only=False, model_config=DefaultModelConfig(fcnet_hiddens=[38, 126], fcnet_activation='tanh', fcnet_kernel_initializer=None, fcnet_kernel_initializer_kwargs=None, fcnet_bias_initializer=None, fcnet_bias_initializer_kwargs=None, conv_filters=None, conv_activation='relu', conv_kernel_initializer=None, conv_kernel_initializer_kwargs=None, conv_bias_initializer=None, conv_bias_initializer_kwargs=None, head_fcnet_hiddens=[], head_fcnet_activation='relu', head_fcnet_kernel_initializer=None, head_fcnet_kernel_initializer_kwargs=None, head_fcnet_bias_initializer=None, head_fcnet_bias_initializer_kwargs=None, free_log_std=False, log_std_clip_param=20.0, vf_share_layers=True, use_lstm=False, max_seq_len=20, lstm_cell_size=256, lstm_use_prev_action=False, lstm_use_prev_reward=False, lstm_kernel_initializer=None, lstm_kernel_initializer_kwargs=None, lstm_bias_initializer=None, lstm_bias_initializer_kwargs=None), catalog_class=None, load_state_path=None, model_config_dict=None)", "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "_validate_config": true, "_use_msgpack_checkpoints": false, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "env_task_fn": -1, "enable_connectors": -1, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2807905848935, "kl_target": 0.0268196110247, "vf_loss_coeff": 0.7591449667272, "entropy_coeff": 0.0454572554143, "clip_param": 0.2757781835805, "vf_clip_param": 0.1077321361793, "entropy_coeff_schedule": null, "lr_schedule": null, "sgd_minibatch_size": -1, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9403062964939, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.callbacks.callbacks.RLlibCallback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 10.047526359558105, "iterations_since_restore": 2, "perf": {"cpu_util_percent": 13.099999999999998, "ram_util_percent": 83.3}}
{"timers": {"training_iteration": 4.351701606599505, "restore_env_runners": 1.5089150380663341e-05, "training_step": 4.35145980721897, "env_runner_sampling_timer": 3.870656729289522, "learner_update_timer": 0.477360284590014, "synch_weights": 0.001484925809631386, "restore_eval_env_runners": 1.3978000188217264e-05, "evaluation_iteration": 0.7475505989893645, "synch_eval_env_connectors": 0.0005696180002178153, "synch_env_connectors": 7.799000277373125e-06}, "env_runners": {"module_to_env_connector": {"timers": {"connectors": {"normalize_and_clip_actions": 2.2341149706736487e-05, "get_actions": 0.0001665379963611427, "un_batch_to_individual_items": 1.4684456999191379e-05, "listify_data_for_vector_env": 3.1444589705357156e-05, "tensor_to_numpy": 4.968529920230399e-05, "remove_single_ts_time_rank_from_batch": 1.5116811309594287e-06}}, "connector_pipeline_timer": 0.0003634377741054361}, "env_reset_timer": 0.00010874069760858108, "env_to_module_connector": {"connector_pipeline_timer": 0.00011912242252792538, "timers": {"connectors": {"add_time_dim_to_batch_and_zero_pad": 6.726542863410755e-06, "add_states_from_episodes_to_batch": 3.4825047806112208e-06, "add_observations_from_episodes_to_batch": 6.378701069265265e-06, "batch_individual_items": 1.846107167934879e-05, "numpy_to_tensor": 3.159698243788523e-05}}}, "num_module_steps_sampled": {"default_policy": 5000.0}, "num_env_steps_sampled_lifetime": -232500.0, "episode_duration_sec_mean": 0.03827840900996307, "env_to_module_sum_episodes_length_in": 27.16809333212661, "num_episodes_lifetime": -4650.0, "env_step_timer": 4.353478240391937e-05, "rlmodule_inference_timer": 0.00013817036791885677, "agent_episode_returns_mean": {"default_agent": 10.1}, "num_episodes": 100.0, "episode_len_mean": 50.0, "num_module_steps_sampled_lifetime": {"default_policy": -232500.0}, "module_episode_returns_mean": {"default_policy": 10.1}, "episode_return_mean": 10.1, "sample": 0.03885215940255514, "weights_seq_no": 2.0, "episode_len_min": 50, "episode_len_max": 50, "num_env_steps_sampled": 5000.0, "num_agent_steps_sampled": {"default_agent": 5000.0}, "episode_return_min": -5.5, "episode_return_max": 14.5, "env_to_module_sum_episodes_length_out": 27.16809333212661, "time_between_sampling": 0.010999681331455876, "num_agent_steps_sampled_lifetime": {"default_agent": -232500.0}, "num_env_steps_sampled_lifetime_throughput": 1260.475689545687}, "learners": {"__all_modules__": {"num_module_steps_trained": 16000, "num_trainable_parameters": 5447, "learner_connector": {"timers": {"connectors": {"batch_individual_items": 0.20469116632943904, "numpy_to_tensor": 0.00017198633002153655, "add_one_ts_to_episodes_and_truncate": 0.00853231997931598, "add_observations_from_episodes_to_batch": 0.0008068298202617369, "add_columns_from_episodes_to_train_batch": 0.06803882545961086, "add_time_dim_to_batch_and_zero_pad": 2.3021909613726164e-05, "add_states_from_episodes_to_batch": 6.335569769362337e-06, "general_advantage_estimation": 0.01173249527978114}}, "connector_pipeline_timer": 0.2943715534796437}, "learner_connector_sum_episodes_length_in": 5000.0, "num_non_trainable_parameters": 0, "num_env_steps_trained": 81600, "num_module_steps_trained_lifetime": 48000, "learner_connector_sum_episodes_length_out": 5100.0, "num_env_steps_trained_lifetime": 244800, "num_env_steps_trained_lifetime_throughput": 838801.8637015332, "num_module_steps_trained_throughput": 164980.87945394544, "num_module_steps_trained_lifetime_throughput": 164868.97577656832}, "default_policy": {"num_module_steps_trained": 16000, "diff_num_grad_updates_vs_sampler_policy": 1.0, "entropy": 0.6660427451133728, "total_loss": 0.11839345842599869, "num_trainable_parameters": 5447, "policy_loss": 0.06432255357503891, "mean_kl_loss": 0.019435716792941093, "module_train_batch_size_mean": 1000.0, "curr_entropy_coeff": 0.0454572554143, "vf_explained_var": 0.39992570877075195, "gradients_default_optimizer_global_norm": 0.0425431989133358, "default_optimizer_learning_rate": 0.0507729549118, "num_module_steps_trained_lifetime": 48000, "weights_seq_no": 3.0, "curr_kl_coeff": 0.14039529860019684, "vf_loss_unclipped": 41.84819793701172, "vf_loss": 0.10751397162675858, "num_module_steps_trained_lifetime_throughput": 165256.650212204}}, "num_training_step_calls_per_iteration": 1, "evaluation": {"env_runners": {"num_episodes_lifetime": 60, "env_step_timer": 4.1529298825404134e-05, "module_to_env_connector": {"timers": {"connectors": {"normalize_and_clip_actions": 2.1976678974784752e-05, "get_actions": 0.00015624142467378946, "tensor_to_numpy": 4.7098888916972056e-05, "un_batch_to_individual_items": 1.5839617813733568e-05, "remove_single_ts_time_rank_from_batch": 1.405234973809461e-06, "listify_data_for_vector_env": 3.0103356114553065e-05}}, "connector_pipeline_timer": 0.00034520520594888307}, "env_to_module_connector": {"connector_pipeline_timer": 0.00011428866660078844, "timers": {"connectors": {"numpy_to_tensor": 2.917118982482451e-05, "batch_individual_items": 1.8809966697966507e-05, "add_observations_from_episodes_to_batch": 5.896198055751782e-06, "add_time_dim_to_batch_and_zero_pad": 6.6639699541984676e-06, "add_states_from_episodes_to_batch": 3.443062575777523e-06}}}, "sample": 0.7358325942200862, "episode_len_max": 50, "num_env_steps_sampled": 1000, "episode_return_max": 17.5, "env_to_module_sum_episodes_length_out": 27.168093332125434, "env_reset_timer": 0.00035992231956797694, "episode_duration_sec_mean": 0.03533422333333268, "env_to_module_sum_episodes_length_in": 27.168093332125434, "rlmodule_inference_timer": 9.579046608831711e-05, "episode_return_mean": 0.1, "weights_seq_no": 3.0, "episode_len_min": 50, "num_module_steps_sampled_lifetime": {"default_policy": 3000}, "num_agent_steps_sampled": {"default_agent": 1000}, "num_agent_steps_sampled_lifetime": {"default_agent": 3000}, "num_env_steps_sampled_lifetime": 16000, "num_episodes": 20, "episode_len_mean": 50.0, "agent_episode_returns_mean": {"default_agent": 0.1}, "num_module_steps_sampled": {"default_policy": 1000}, "module_episode_returns_mean": {"default_policy": 0.1}, "episode_return_min": -14.5, "time_between_sampling": 4.253614017029759}, "num_healthy_workers": 1, "actor_manager_num_outstanding_async_reqs": 0, "num_remote_worker_restarts": 0}, "num_env_steps_sampled_lifetime": -232500.0, "fault_tolerance": {"num_healthy_workers": 0, "num_remote_worker_restarts": 0}, "env_runner_group": {"actor_manager_num_outstanding_async_reqs": 0}, "done": false, "training_iteration": 3, "trial_id": "145e5_00000", "date": "2025-08-11_17-51-51", "timestamp": 1754927511, "time_this_iter_s": 5.086776971817017, "time_total_s": 15.134303331375122, "pid": 98861, "hostname": "DESKTOP-3SK5A41", "node_ip": "192.168.40.242", "config": {"exploration_config": {}, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 6, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "env": "Umbrella", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": false, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 0, "create_local_env_runner": true, "num_envs_per_env_runner": 1, "gym_env_vectorize_mode": "SYNC", "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "episodes_to_numpy": true, "max_requests_in_flight_per_env_runner": 1, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "merge_env_runner_states": "training_only", "broadcast_env_runner_states": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "complete_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "sampler_perf_stats_ema_coef": null, "_is_online": true, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": "auto", "num_aggregator_actors_per_learner": 0, "max_requests_in_flight_per_aggregator_actor": 3, "local_gpu_idx": 0, "max_requests_in_flight_per_learner": 3, "gamma": 1, "lr": 0.0507729549118, "grad_clip": 0.5, "grad_clip_by": "global_norm", "_train_batch_size_per_learner": 5000, "train_batch_size": 4000, "num_epochs": 3, "minibatch_size": 1000, "shuffle_batch_per_epoch": true, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "log_std_clip_param": 20.0, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "_disable_preprocessor_api": false, "_disable_action_flattening": false}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "_learner_class": null, "callbacks_on_algorithm_init": null, "callbacks_on_env_runners_recreated": null, "callbacks_on_offline_eval_runners_recreated": null, "callbacks_on_checkpoint_loaded": null, "callbacks_on_environment_created": null, "callbacks_on_episode_created": null, "callbacks_on_episode_start": null, "callbacks_on_episode_step": null, "callbacks_on_episode_end": null, "callbacks_on_evaluate_start": null, "callbacks_on_evaluate_end": null, "callbacks_on_evaluate_offline_start": null, "callbacks_on_evaluate_offline_end": null, "callbacks_on_sample_end": null, "callbacks_on_train_result": null, "explore": true, "enable_rl_module_and_learner": true, "enable_env_runner_and_connector_v2": true, "_prior_exploration_config": {"type": "StochasticSampling"}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7c54f75b6ac0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "offline_data_class": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_read_batch_size": null, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "materialize_data": false, "materialize_mapped_data": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "ignore_final_observation": false, "prelearner_class": null, "prelearner_buffer_class": null, "prelearner_buffer_kwargs": {}, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_remaining_data": false, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": 1, "evaluation_duration": 20, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_auto_duration_min_env_steps_per_sample": 100, "evaluation_auto_duration_max_env_steps_per_sample": 2000, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 1, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "offline_evaluation_interval": null, "num_offline_eval_runners": 0, "offline_loss_for_module_fn": null, "offline_evaluation_duration": 1, "offline_evaluation_parallel_to_training": false, "offline_evaluation_timeout_s": 120.0, "num_cpus_per_offline_eval_runner": 1, "num_gpus_per_offline_eval_runner": 0, "custom_resources_per_offline_eval_runner": {}, "restart_failed_offline_eval_runners": true, "ignore_offline_eval_runner_failures": false, "max_num_offline_eval_runner_restarts": 1000, "offline_eval_runner_restore_timeout_s": 1800.0, "max_requests_in_flight_per_offline_eval_runner": 1, "validate_offline_eval_runners_after_construction": true, "offline_eval_runner_health_probe_timeout_s": 30.0, "offline_eval_rl_module_inference_only": false, "broadcast_offline_eval_runner_states": false, "offline_eval_batch_size_per_runner": 256, "dataset_num_iters_per_eval_runner": 1, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "log_gradients": true, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 42, "restart_failed_env_runners": true, "ignore_env_runner_failures": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30.0, "env_runner_restore_timeout_s": 1800.0, "_model_config": {}, "_rl_module_spec": "RLModuleSpec(module_class=None, observation_space=None, action_space=None, inference_only=False, learner_only=False, model_config=DefaultModelConfig(fcnet_hiddens=[38, 126], fcnet_activation='tanh', fcnet_kernel_initializer=None, fcnet_kernel_initializer_kwargs=None, fcnet_bias_initializer=None, fcnet_bias_initializer_kwargs=None, conv_filters=None, conv_activation='relu', conv_kernel_initializer=None, conv_kernel_initializer_kwargs=None, conv_bias_initializer=None, conv_bias_initializer_kwargs=None, head_fcnet_hiddens=[], head_fcnet_activation='relu', head_fcnet_kernel_initializer=None, head_fcnet_kernel_initializer_kwargs=None, head_fcnet_bias_initializer=None, head_fcnet_bias_initializer_kwargs=None, free_log_std=False, log_std_clip_param=20.0, vf_share_layers=True, use_lstm=False, max_seq_len=20, lstm_cell_size=256, lstm_use_prev_action=False, lstm_use_prev_reward=False, lstm_kernel_initializer=None, lstm_kernel_initializer_kwargs=None, lstm_bias_initializer=None, lstm_bias_initializer_kwargs=None), catalog_class=None, load_state_path=None, model_config_dict=None)", "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "_validate_config": true, "_use_msgpack_checkpoints": false, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "env_task_fn": -1, "enable_connectors": -1, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2807905848935, "kl_target": 0.0268196110247, "vf_loss_coeff": 0.7591449667272, "entropy_coeff": 0.0454572554143, "clip_param": 0.2757781835805, "vf_clip_param": 0.1077321361793, "entropy_coeff_schedule": null, "lr_schedule": null, "sgd_minibatch_size": -1, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9403062964939, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.callbacks.callbacks.RLlibCallback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 15.134303331375122, "iterations_since_restore": 3, "perf": {"cpu_util_percent": 12.728571428571428, "ram_util_percent": 83.38571428571427}}
{"timers": {"training_iteration": 4.351544975553515, "restore_env_runners": 1.506425887221849e-05, "training_step": 4.351301818166782, "env_runner_sampling_timer": 3.8713606670166225, "learner_update_timer": 0.47649287874411045, "synch_weights": 0.0014857015515314343, "restore_eval_env_runners": 1.397122018952359e-05, "evaluation_iteration": 0.747544831009466, "synch_eval_env_connectors": 0.0005690168202124369, "synch_env_connectors": 7.796010272704734e-06}, "env_runners": {"module_to_env_connector": {"timers": {"connectors": {"normalize_and_clip_actions": 2.2389878381057253e-05, "get_actions": 0.0001664051329224541, "un_batch_to_individual_items": 1.463964918927102e-05, "listify_data_for_vector_env": 3.132973509262745e-05, "tensor_to_numpy": 4.9999840143971055e-05, "remove_single_ts_time_rank_from_batch": 1.5140502438896201e-06}}, "connector_pipeline_timer": 0.00036356431736695913}, "env_reset_timer": 0.00010013731313449292, "env_to_module_connector": {"connector_pipeline_timer": 0.0001189862744335907, "timers": {"connectors": {"add_time_dim_to_batch_and_zero_pad": 6.630957916738114e-06, "add_states_from_episodes_to_batch": 3.443506126725318e-06, "add_observations_from_episodes_to_batch": 6.3212111184801114e-06, "batch_individual_items": 1.860213081939153e-05, "numpy_to_tensor": 3.1403833814908467e-05}}}, "num_module_steps_sampled": {"default_policy": 5000.0}, "num_env_steps_sampled_lifetime": -475000.0, "episode_duration_sec_mean": 0.03685430499996982, "env_to_module_sum_episodes_length_in": 27.16809333212661, "num_episodes_lifetime": -9500.0, "env_step_timer": 4.328770661002692e-05, "rlmodule_inference_timer": 0.00010409148869327316, "agent_episode_returns_mean": {"default_agent": 7.1}, "num_episodes": 100.0, "episode_len_mean": 50.0, "num_module_steps_sampled_lifetime": {"default_policy": -475000.0}, "module_episode_returns_mean": {"default_policy": 7.1}, "episode_return_mean": 7.1, "sample": 0.03879549618292187, "weights_seq_no": 3.0, "episode_len_min": 50, "episode_len_max": 50, "num_env_steps_sampled": 5000.0, "num_agent_steps_sampled": {"default_agent": 5000.0}, "episode_return_min": -5.5, "episode_return_max": 14.5, "env_to_module_sum_episodes_length_out": 27.16809333212661, "time_between_sampling": 0.01157907647716068, "num_agent_steps_sampled_lifetime": {"default_agent": -475000.0}, "num_env_steps_sampled_lifetime_throughput": 1265.6600134343769}, "learners": {"__all_modules__": {"num_module_steps_trained": 16000, "num_trainable_parameters": 5447, "learner_connector": {"timers": {"connectors": {"batch_individual_items": 0.20468155166614177, "numpy_to_tensor": 0.00017192046672828655, "add_one_ts_to_episodes_and_truncate": 0.008531562779518723, "add_observations_from_episodes_to_batch": 0.0008057015220529664, "add_columns_from_episodes_to_train_batch": 0.06803920120501357, "add_time_dim_to_batch_and_zero_pad": 2.3027690513809826e-05, "add_states_from_episodes_to_batch": 6.3372140754836435e-06, "general_advantage_estimation": 0.011713415326982553}}, "connector_pipeline_timer": 0.29434071694484315}, "learner_connector_sum_episodes_length_in": 5000.0, "num_non_trainable_parameters": 0, "num_env_steps_trained": 81600, "num_module_steps_trained_lifetime": 64000, "learner_connector_sum_episodes_length_out": 5100.0, "num_env_steps_trained_lifetime": 326400, "num_env_steps_trained_lifetime_throughput": 837870.4619520814, "num_module_steps_trained_throughput": 164774.71100733356, "num_module_steps_trained_lifetime_throughput": 164665.98464122805}, "default_policy": {"num_module_steps_trained": 16000, "diff_num_grad_updates_vs_sampler_policy": 1.0, "entropy": 0.6585983037948608, "total_loss": 0.031785909086465836, "num_trainable_parameters": 5447, "policy_loss": -0.01750808022916317, "mean_kl_loss": 0.0026138564571738243, "module_train_batch_size_mean": 1000.0, "curr_entropy_coeff": 0.0454572554143, "vf_explained_var": -0.13540804386138916, "gradients_default_optimizer_global_norm": 0.09489292651414871, "default_optimizer_learning_rate": 0.0507729549118, "num_module_steps_trained_lifetime": 64000, "weights_seq_no": 4.0, "curr_kl_coeff": 0.07019764930009842, "vf_loss_unclipped": 51.228946685791016, "vf_loss": 0.10388674587011337, "num_module_steps_trained_lifetime_throughput": 165034.82294049344}}, "num_training_step_calls_per_iteration": 1, "evaluation": {"env_runners": {"num_episodes_lifetime": 80, "env_step_timer": 4.2440413061176714e-05, "module_to_env_connector": {"timers": {"connectors": {"normalize_and_clip_actions": 2.2208377798913388e-05, "get_actions": 0.00015701013538142711, "tensor_to_numpy": 4.617497838588848e-05, "un_batch_to_individual_items": 1.558737200439013e-05, "remove_single_ts_time_rank_from_batch": 1.3972010496598235e-06, "listify_data_for_vector_env": 3.0655733512098084e-05}}, "connector_pipeline_timer": 0.0003457844695454804}, "env_to_module_connector": {"connector_pipeline_timer": 0.00011366689938405855, "timers": {"connectors": {"numpy_to_tensor": 2.9569196849914527e-05, "batch_individual_items": 1.8257321373462074e-05, "add_observations_from_episodes_to_batch": 6.228626237415617e-06, "add_time_dim_to_batch_and_zero_pad": 6.484866474929669e-06, "add_states_from_episodes_to_batch": 3.4348620559058742e-06}}}, "sample": 0.7358708932778866, "episode_len_max": 50, "num_env_steps_sampled": 1000, "episode_return_max": 17.5, "env_to_module_sum_episodes_length_out": 27.168093332126602, "env_reset_timer": 0.0003576950963692879, "episode_duration_sec_mean": 0.03539183499998444, "env_to_module_sum_episodes_length_in": 27.168093332126602, "rlmodule_inference_timer": 9.846410332227552e-05, "episode_return_mean": -0.15, "weights_seq_no": 4.0, "episode_len_min": 50, "num_module_steps_sampled_lifetime": {"default_policy": 4000}, "num_agent_steps_sampled": {"default_agent": 1000}, "num_agent_steps_sampled_lifetime": {"default_agent": 4000}, "num_env_steps_sampled_lifetime": 21000, "num_episodes": 20, "episode_len_mean": 50.0, "agent_episode_returns_mean": {"default_agent": -0.15}, "num_module_steps_sampled": {"default_policy": 1000}, "module_episode_returns_mean": {"default_policy": -0.15}, "episode_return_min": -14.5, "time_between_sampling": 4.25499144987946}, "num_healthy_workers": 1, "actor_manager_num_outstanding_async_reqs": 0, "num_remote_worker_restarts": 0}, "num_env_steps_sampled_lifetime": -475000.0, "fault_tolerance": {"num_healthy_workers": 0, "num_remote_worker_restarts": 0}, "env_runner_group": {"actor_manager_num_outstanding_async_reqs": 0}, "done": false, "training_iteration": 4, "trial_id": "145e5_00000", "date": "2025-08-11_17-51-56", "timestamp": 1754927516, "time_this_iter_s": 5.089974880218506, "time_total_s": 20.224278211593628, "pid": 98861, "hostname": "DESKTOP-3SK5A41", "node_ip": "192.168.40.242", "config": {"exploration_config": {}, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 6, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "env": "Umbrella", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": false, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 0, "create_local_env_runner": true, "num_envs_per_env_runner": 1, "gym_env_vectorize_mode": "SYNC", "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "episodes_to_numpy": true, "max_requests_in_flight_per_env_runner": 1, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "merge_env_runner_states": "training_only", "broadcast_env_runner_states": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "complete_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "sampler_perf_stats_ema_coef": null, "_is_online": true, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": "auto", "num_aggregator_actors_per_learner": 0, "max_requests_in_flight_per_aggregator_actor": 3, "local_gpu_idx": 0, "max_requests_in_flight_per_learner": 3, "gamma": 1, "lr": 0.0507729549118, "grad_clip": 0.5, "grad_clip_by": "global_norm", "_train_batch_size_per_learner": 5000, "train_batch_size": 4000, "num_epochs": 3, "minibatch_size": 1000, "shuffle_batch_per_epoch": true, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "log_std_clip_param": 20.0, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "_disable_preprocessor_api": false, "_disable_action_flattening": false}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "_learner_class": null, "callbacks_on_algorithm_init": null, "callbacks_on_env_runners_recreated": null, "callbacks_on_offline_eval_runners_recreated": null, "callbacks_on_checkpoint_loaded": null, "callbacks_on_environment_created": null, "callbacks_on_episode_created": null, "callbacks_on_episode_start": null, "callbacks_on_episode_step": null, "callbacks_on_episode_end": null, "callbacks_on_evaluate_start": null, "callbacks_on_evaluate_end": null, "callbacks_on_evaluate_offline_start": null, "callbacks_on_evaluate_offline_end": null, "callbacks_on_sample_end": null, "callbacks_on_train_result": null, "explore": true, "enable_rl_module_and_learner": true, "enable_env_runner_and_connector_v2": true, "_prior_exploration_config": {"type": "StochasticSampling"}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7c54f75b6ac0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "offline_data_class": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_read_batch_size": null, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "materialize_data": false, "materialize_mapped_data": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "ignore_final_observation": false, "prelearner_class": null, "prelearner_buffer_class": null, "prelearner_buffer_kwargs": {}, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_remaining_data": false, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": 1, "evaluation_duration": 20, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_auto_duration_min_env_steps_per_sample": 100, "evaluation_auto_duration_max_env_steps_per_sample": 2000, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 1, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "offline_evaluation_interval": null, "num_offline_eval_runners": 0, "offline_loss_for_module_fn": null, "offline_evaluation_duration": 1, "offline_evaluation_parallel_to_training": false, "offline_evaluation_timeout_s": 120.0, "num_cpus_per_offline_eval_runner": 1, "num_gpus_per_offline_eval_runner": 0, "custom_resources_per_offline_eval_runner": {}, "restart_failed_offline_eval_runners": true, "ignore_offline_eval_runner_failures": false, "max_num_offline_eval_runner_restarts": 1000, "offline_eval_runner_restore_timeout_s": 1800.0, "max_requests_in_flight_per_offline_eval_runner": 1, "validate_offline_eval_runners_after_construction": true, "offline_eval_runner_health_probe_timeout_s": 30.0, "offline_eval_rl_module_inference_only": false, "broadcast_offline_eval_runner_states": false, "offline_eval_batch_size_per_runner": 256, "dataset_num_iters_per_eval_runner": 1, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "log_gradients": true, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 42, "restart_failed_env_runners": true, "ignore_env_runner_failures": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30.0, "env_runner_restore_timeout_s": 1800.0, "_model_config": {}, "_rl_module_spec": "RLModuleSpec(module_class=None, observation_space=None, action_space=None, inference_only=False, learner_only=False, model_config=DefaultModelConfig(fcnet_hiddens=[38, 126], fcnet_activation='tanh', fcnet_kernel_initializer=None, fcnet_kernel_initializer_kwargs=None, fcnet_bias_initializer=None, fcnet_bias_initializer_kwargs=None, conv_filters=None, conv_activation='relu', conv_kernel_initializer=None, conv_kernel_initializer_kwargs=None, conv_bias_initializer=None, conv_bias_initializer_kwargs=None, head_fcnet_hiddens=[], head_fcnet_activation='relu', head_fcnet_kernel_initializer=None, head_fcnet_kernel_initializer_kwargs=None, head_fcnet_bias_initializer=None, head_fcnet_bias_initializer_kwargs=None, free_log_std=False, log_std_clip_param=20.0, vf_share_layers=True, use_lstm=False, max_seq_len=20, lstm_cell_size=256, lstm_use_prev_action=False, lstm_use_prev_reward=False, lstm_kernel_initializer=None, lstm_kernel_initializer_kwargs=None, lstm_bias_initializer=None, lstm_bias_initializer_kwargs=None), catalog_class=None, load_state_path=None, model_config_dict=None)", "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "_validate_config": true, "_use_msgpack_checkpoints": false, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "env_task_fn": -1, "enable_connectors": -1, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2807905848935, "kl_target": 0.0268196110247, "vf_loss_coeff": 0.7591449667272, "entropy_coeff": 0.0454572554143, "clip_param": 0.2757781835805, "vf_clip_param": 0.1077321361793, "entropy_coeff_schedule": null, "lr_schedule": null, "sgd_minibatch_size": -1, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9403062964939, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.callbacks.callbacks.RLlibCallback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 20.224278211593628, "iterations_since_restore": 4, "perf": {"cpu_util_percent": 12.587499999999999, "ram_util_percent": 83.4}}
{"timers": {"training_iteration": 4.349749741777983, "restore_env_runners": 1.5023616275260504e-05, "training_step": 4.349505004965108, "env_runner_sampling_timer": 3.8720728433264537, "learner_update_timer": 0.47397230295666576, "synch_weights": 0.001491165536017906, "restore_eval_env_runners": 1.3978507988280398e-05, "evaluation_iteration": 0.7475659306993706, "synch_eval_env_connectors": 0.0005673996520103747, "synch_env_connectors": 7.788050175485297e-06}, "env_runners": {"module_to_env_connector": {"timers": {"connectors": {"normalize_and_clip_actions": 2.2545124876079463e-05, "get_actions": 0.00016665614244707242, "un_batch_to_individual_items": 1.4525092943670574e-05, "listify_data_for_vector_env": 3.14043194322802e-05, "tensor_to_numpy": 4.982722511744198e-05, "remove_single_ts_time_rank_from_batch": 1.490951269890887e-06}}, "connector_pipeline_timer": 0.00036363063136064436}, "env_reset_timer": 9.640807920976902e-05, "env_to_module_connector": {"connector_pipeline_timer": 0.00011942659191544131, "timers": {"connectors": {"add_time_dim_to_batch_and_zero_pad": 6.657188013492703e-06, "add_states_from_episodes_to_batch": 3.4422399147777656e-06, "add_observations_from_episodes_to_batch": 6.356615770947753e-06, "batch_individual_items": 1.8453887362779594e-05, "numpy_to_tensor": 3.1737640688331684e-05}}}, "num_module_steps_sampled": {"default_policy": 5000.0}, "num_env_steps_sampled_lifetime": -717500.0, "episode_duration_sec_mean": 0.03684706898995499, "env_to_module_sum_episodes_length_in": 27.16809333212661, "num_episodes_lifetime": -14350.0, "env_step_timer": 4.3271357887412705e-05, "rlmodule_inference_timer": 0.00010321482794387087, "agent_episode_returns_mean": {"default_agent": 7.299999999999996}, "num_episodes": 100.0, "episode_len_mean": 50.0, "num_module_steps_sampled_lifetime": {"default_policy": -717500.0}, "module_episode_returns_mean": {"default_policy": 7.299999999999996}, "episode_return_mean": 7.299999999999996, "sample": 0.03821215213433289, "weights_seq_no": 4.0, "episode_len_min": 50, "episode_len_max": 50, "num_env_steps_sampled": 5000.0, "num_agent_steps_sampled": {"default_agent": 5000.0}, "episode_return_min": -5.5, "episode_return_max": 14.5, "env_to_module_sum_episodes_length_out": 27.16809333212661, "time_between_sampling": 0.012714841603638387, "num_agent_steps_sampled_lifetime": {"default_agent": -717500.0}, "num_env_steps_sampled_lifetime_throughput": 1269.5722014876374}, "learners": {"__all_modules__": {"num_module_steps_trained": 16000, "num_trainable_parameters": 5447, "learner_connector": {"timers": {"connectors": {"batch_individual_items": 0.20324077214948866, "numpy_to_tensor": 0.00017205026206122394, "add_one_ts_to_episodes_and_truncate": 0.00852862315172383, "add_observations_from_episodes_to_batch": 0.0008045325068396026, "add_columns_from_episodes_to_train_batch": 0.06801739019297039, "add_time_dim_to_batch_and_zero_pad": 2.3004413611446022e-05, "add_states_from_episodes_to_batch": 6.325841939599741e-06, "general_advantage_estimation": 0.011699923173716402}}, "connector_pipeline_timer": 0.29286021477539326}, "learner_connector_sum_episodes_length_in": 5000.0, "num_non_trainable_parameters": 0, "num_env_steps_trained": 81600, "num_module_steps_trained_lifetime": 80000, "learner_connector_sum_episodes_length_out": 5100.0, "num_env_steps_trained_lifetime": 408000, "num_env_steps_trained_lifetime_throughput": 843382.1208079541, "num_module_steps_trained_throughput": 165836.48104801623, "num_module_steps_trained_lifetime_throughput": 165731.33903698123}, "default_policy": {"num_module_steps_trained": 16000, "diff_num_grad_updates_vs_sampler_policy": 1.0, "entropy": 0.45669025182724, "total_loss": 0.11615044623613358, "num_trainable_parameters": 5447, "policy_loss": 0.04853401705622673, "mean_kl_loss": 0.09390635043382645, "module_train_batch_size_mean": 1000.0, "curr_entropy_coeff": 0.0454572554143, "vf_explained_var": 0.17068493366241455, "gradients_default_optimizer_global_norm": 0.9286999106407166, "default_optimizer_learning_rate": 0.0507729549118, "num_module_steps_trained_lifetime": 80000, "weights_seq_no": 5.0, "curr_kl_coeff": 0.10529647767543793, "vf_loss_unclipped": 463.8922119140625, "vf_loss": 0.1077321320772171, "num_module_steps_trained_lifetime_throughput": 166080.01281407714}}, "num_training_step_calls_per_iteration": 1, "evaluation": {"env_runners": {"num_episodes_lifetime": 100, "env_step_timer": 4.1969041175842064e-05, "module_to_env_connector": {"timers": {"connectors": {"normalize_and_clip_actions": 2.1656562689770016e-05, "get_actions": 0.0001568674429445614, "tensor_to_numpy": 4.6201469475715655e-05, "un_batch_to_individual_items": 1.5463140652689248e-05, "remove_single_ts_time_rank_from_batch": 1.443568329856936e-06, "listify_data_for_vector_env": 3.113060083369077e-05}}, "connector_pipeline_timer": 0.00034459891881383485}, "env_to_module_connector": {"connector_pipeline_timer": 0.0001128594430302592, "timers": {"connectors": {"numpy_to_tensor": 2.926759246954942e-05, "batch_individual_items": 1.8252138132141207e-05, "add_observations_from_episodes_to_batch": 6.238540955479598e-06, "add_time_dim_to_batch_and_zero_pad": 6.2635548397797114e-06, "add_states_from_episodes_to_batch": 3.3953754180817324e-06}}}, "sample": 0.7358609253451129, "episode_len_max": 50, "num_env_steps_sampled": 1000, "episode_return_max": 17.5, "env_to_module_sum_episodes_length_out": 27.168093332126602, "env_reset_timer": 0.0003556111454053499, "episode_duration_sec_mean": 0.03537916200000837, "env_to_module_sum_episodes_length_in": 27.168093332126602, "rlmodule_inference_timer": 9.601414909668653e-05, "episode_return_mean": -0.3, "weights_seq_no": 5.0, "episode_len_min": 50, "num_module_steps_sampled_lifetime": {"default_policy": 5000}, "num_agent_steps_sampled": {"default_agent": 1000}, "num_agent_steps_sampled_lifetime": {"default_agent": 5000}, "num_env_steps_sampled_lifetime": 26000, "num_episodes": 20, "episode_len_mean": 50.0, "agent_episode_returns_mean": {"default_agent": -0.3}, "num_module_steps_sampled": {"default_policy": 1000}, "module_episode_returns_mean": {"default_policy": -0.3}, "episode_return_min": -16.5, "time_between_sampling": 4.254716253360664}, "num_healthy_workers": 1, "actor_manager_num_outstanding_async_reqs": 0, "num_remote_worker_restarts": 0}, "num_env_steps_sampled_lifetime": -717500.0, "fault_tolerance": {"num_healthy_workers": 0, "num_remote_worker_restarts": 0}, "env_runner_group": {"actor_manager_num_outstanding_async_reqs": 0}, "done": false, "training_iteration": 5, "trial_id": "145e5_00000", "date": "2025-08-11_17-52-01", "timestamp": 1754927521, "time_this_iter_s": 4.921324729919434, "time_total_s": 25.14560294151306, "pid": 98861, "hostname": "DESKTOP-3SK5A41", "node_ip": "192.168.40.242", "config": {"exploration_config": {}, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 6, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "env": "Umbrella", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": false, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 0, "create_local_env_runner": true, "num_envs_per_env_runner": 1, "gym_env_vectorize_mode": "SYNC", "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "episodes_to_numpy": true, "max_requests_in_flight_per_env_runner": 1, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "merge_env_runner_states": "training_only", "broadcast_env_runner_states": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "complete_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "sampler_perf_stats_ema_coef": null, "_is_online": true, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": "auto", "num_aggregator_actors_per_learner": 0, "max_requests_in_flight_per_aggregator_actor": 3, "local_gpu_idx": 0, "max_requests_in_flight_per_learner": 3, "gamma": 1, "lr": 0.0507729549118, "grad_clip": 0.5, "grad_clip_by": "global_norm", "_train_batch_size_per_learner": 5000, "train_batch_size": 4000, "num_epochs": 3, "minibatch_size": 1000, "shuffle_batch_per_epoch": true, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "log_std_clip_param": 20.0, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "_disable_preprocessor_api": false, "_disable_action_flattening": false}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "_learner_class": null, "callbacks_on_algorithm_init": null, "callbacks_on_env_runners_recreated": null, "callbacks_on_offline_eval_runners_recreated": null, "callbacks_on_checkpoint_loaded": null, "callbacks_on_environment_created": null, "callbacks_on_episode_created": null, "callbacks_on_episode_start": null, "callbacks_on_episode_step": null, "callbacks_on_episode_end": null, "callbacks_on_evaluate_start": null, "callbacks_on_evaluate_end": null, "callbacks_on_evaluate_offline_start": null, "callbacks_on_evaluate_offline_end": null, "callbacks_on_sample_end": null, "callbacks_on_train_result": null, "explore": true, "enable_rl_module_and_learner": true, "enable_env_runner_and_connector_v2": true, "_prior_exploration_config": {"type": "StochasticSampling"}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7c54f75b6ac0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "offline_data_class": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_read_batch_size": null, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "materialize_data": false, "materialize_mapped_data": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "ignore_final_observation": false, "prelearner_class": null, "prelearner_buffer_class": null, "prelearner_buffer_kwargs": {}, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_remaining_data": false, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": 1, "evaluation_duration": 20, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_auto_duration_min_env_steps_per_sample": 100, "evaluation_auto_duration_max_env_steps_per_sample": 2000, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 1, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "offline_evaluation_interval": null, "num_offline_eval_runners": 0, "offline_loss_for_module_fn": null, "offline_evaluation_duration": 1, "offline_evaluation_parallel_to_training": false, "offline_evaluation_timeout_s": 120.0, "num_cpus_per_offline_eval_runner": 1, "num_gpus_per_offline_eval_runner": 0, "custom_resources_per_offline_eval_runner": {}, "restart_failed_offline_eval_runners": true, "ignore_offline_eval_runner_failures": false, "max_num_offline_eval_runner_restarts": 1000, "offline_eval_runner_restore_timeout_s": 1800.0, "max_requests_in_flight_per_offline_eval_runner": 1, "validate_offline_eval_runners_after_construction": true, "offline_eval_runner_health_probe_timeout_s": 30.0, "offline_eval_rl_module_inference_only": false, "broadcast_offline_eval_runner_states": false, "offline_eval_batch_size_per_runner": 256, "dataset_num_iters_per_eval_runner": 1, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "log_gradients": true, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 42, "restart_failed_env_runners": true, "ignore_env_runner_failures": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30.0, "env_runner_restore_timeout_s": 1800.0, "_model_config": {}, "_rl_module_spec": "RLModuleSpec(module_class=None, observation_space=None, action_space=None, inference_only=False, learner_only=False, model_config=DefaultModelConfig(fcnet_hiddens=[38, 126], fcnet_activation='tanh', fcnet_kernel_initializer=None, fcnet_kernel_initializer_kwargs=None, fcnet_bias_initializer=None, fcnet_bias_initializer_kwargs=None, conv_filters=None, conv_activation='relu', conv_kernel_initializer=None, conv_kernel_initializer_kwargs=None, conv_bias_initializer=None, conv_bias_initializer_kwargs=None, head_fcnet_hiddens=[], head_fcnet_activation='relu', head_fcnet_kernel_initializer=None, head_fcnet_kernel_initializer_kwargs=None, head_fcnet_bias_initializer=None, head_fcnet_bias_initializer_kwargs=None, free_log_std=False, log_std_clip_param=20.0, vf_share_layers=True, use_lstm=False, max_seq_len=20, lstm_cell_size=256, lstm_use_prev_action=False, lstm_use_prev_reward=False, lstm_kernel_initializer=None, lstm_kernel_initializer_kwargs=None, lstm_bias_initializer=None, lstm_bias_initializer_kwargs=None), catalog_class=None, load_state_path=None, model_config_dict=None)", "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "_validate_config": true, "_use_msgpack_checkpoints": false, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "env_task_fn": -1, "enable_connectors": -1, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2807905848935, "kl_target": 0.0268196110247, "vf_loss_coeff": 0.7591449667272, "entropy_coeff": 0.0454572554143, "clip_param": 0.2757781835805, "vf_clip_param": 0.1077321361793, "entropy_coeff_schedule": null, "lr_schedule": null, "sgd_minibatch_size": -1, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9403062964939, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.callbacks.callbacks.RLlibCallback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 25.14560294151306, "iterations_since_restore": 5, "perf": {"cpu_util_percent": 12.614285714285716, "ram_util_percent": 83.39999999999999}}
{"timers": {"training_iteration": 4.349376324350196, "restore_env_runners": 1.4971380112942595e-05, "training_step": 4.349129904905462, "env_runner_sampling_timer": 3.872701385883195, "learner_update_timer": 0.47296417292709225, "synch_weights": 0.0014903678806627923, "restore_eval_env_runners": 1.3967722908412961e-05, "evaluation_iteration": 0.7475405743923729, "synch_eval_env_connectors": 0.0005657936554886405, "synch_env_connectors": 7.772169672891788e-06}, "env_runners": {"module_to_env_connector": {"timers": {"connectors": {"normalize_and_clip_actions": 2.2406331954135067e-05, "get_actions": 0.00016689583726609708, "un_batch_to_individual_items": 1.4518580866399106e-05, "listify_data_for_vector_env": 3.133135500278446e-05, "tensor_to_numpy": 4.989411169124726e-05, "remove_single_ts_time_rank_from_batch": 1.4981779588057598e-06}}, "connector_pipeline_timer": 0.0003637291395481951}, "env_reset_timer": 9.530173425403003e-05, "env_to_module_connector": {"connector_pipeline_timer": 0.0001189751115599845, "timers": {"connectors": {"add_time_dim_to_batch_and_zero_pad": 6.65227744805902e-06, "add_states_from_episodes_to_batch": 3.4640210577867545e-06, "add_observations_from_episodes_to_batch": 6.3254145503298246e-06, "batch_individual_items": 1.8463724678129393e-05, "numpy_to_tensor": 3.150995993525633e-05}}}, "num_module_steps_sampled": {"default_policy": 5000.0}, "num_env_steps_sampled_lifetime": -960000.0, "episode_duration_sec_mean": 0.03679381798997383, "env_to_module_sum_episodes_length_in": 27.16809333212661, "num_episodes_lifetime": -19200.0, "env_step_timer": 4.331509416459303e-05, "rlmodule_inference_timer": 0.00010328004033386538, "agent_episode_returns_mean": {"default_agent": 7.1}, "num_episodes": 100.0, "episode_len_mean": 50.0, "num_module_steps_sampled_lifetime": {"default_policy": -960000.0}, "module_episode_returns_mean": {"default_policy": 7.1}, "episode_return_mean": 7.1, "sample": 0.03801142992441866, "weights_seq_no": 5.0, "episode_len_min": 50, "episode_len_max": 50, "num_env_steps_sampled": 5000.0, "num_agent_steps_sampled": {"default_agent": 5000.0}, "episode_return_min": -5.5, "episode_return_max": 14.5, "env_to_module_sum_episodes_length_out": 27.16809333212661, "time_between_sampling": 0.012049452362640564, "num_agent_steps_sampled_lifetime": {"default_agent": -960000.0}, "num_env_steps_sampled_lifetime_throughput": 1269.600084431763}, "learners": {"__all_modules__": {"num_module_steps_trained": 16000, "num_trainable_parameters": 5447, "learner_connector": {"timers": {"connectors": {"batch_individual_items": 0.20324611442799329, "numpy_to_tensor": 0.0001719737594441917, "add_one_ts_to_episodes_and_truncate": 0.008529356920205417, "add_observations_from_episodes_to_batch": 0.0008037471817733404, "add_columns_from_episodes_to_train_batch": 0.06802163629104754, "add_time_dim_to_batch_and_zero_pad": 2.2989369475357173e-05, "add_states_from_episodes_to_batch": 6.314583525074678e-06, "general_advantage_estimation": 0.011668902941984192}}, "connector_pipeline_timer": 0.2928382656276393}, "learner_connector_sum_episodes_length_in": 5000.0, "num_non_trainable_parameters": 0, "num_env_steps_trained": 81600, "num_module_steps_trained_lifetime": 96000, "learner_connector_sum_episodes_length_out": 5100.0, "num_env_steps_trained_lifetime": 489600, "num_env_steps_trained_lifetime_throughput": 849990.7917184002, "num_module_steps_trained_throughput": 167112.36069529556, "num_module_steps_trained_lifetime_throughput": 167009.79249382377}, "default_policy": {"num_module_steps_trained": 16000, "diff_num_grad_updates_vs_sampler_policy": 1.0, "entropy": 0.5730360746383667, "total_loss": -0.03896712139248848, "num_trainable_parameters": 5447, "policy_loss": -0.09572118520736694, "mean_kl_loss": 0.01261611096560955, "module_train_batch_size_mean": 1000.0, "curr_entropy_coeff": 0.0454572554143, "vf_explained_var": -0.3487739562988281, "gradients_default_optimizer_global_norm": 0.1271580159664154, "default_optimizer_learning_rate": 0.0507729549118, "num_module_steps_trained_lifetime": 96000, "weights_seq_no": 6.0, "curr_kl_coeff": 0.052648238837718964, "vf_loss_unclipped": 636.1357421875, "vf_loss": 0.10732375085353851, "num_module_steps_trained_lifetime_throughput": 167336.59316110273}}, "num_training_step_calls_per_iteration": 1, "evaluation": {"env_runners": {"num_episodes_lifetime": 120, "env_step_timer": 4.173523571065923e-05, "module_to_env_connector": {"timers": {"connectors": {"normalize_and_clip_actions": 2.2230764508166052e-05, "get_actions": 0.0001585431382250411, "tensor_to_numpy": 4.698840049996134e-05, "un_batch_to_individual_items": 1.5582670059065068e-05, "remove_single_ts_time_rank_from_batch": 1.3810993931966944e-06, "listify_data_for_vector_env": 3.093602207205113e-05}}, "connector_pipeline_timer": 0.000348528765466227}, "env_to_module_connector": {"connector_pipeline_timer": 0.00011405206908140599, "timers": {"connectors": {"numpy_to_tensor": 3.0032371634713613e-05, "batch_individual_items": 1.849770687112417e-05, "add_observations_from_episodes_to_batch": 6.054522102355099e-06, "add_time_dim_to_batch_and_zero_pad": 6.45820208517226e-06, "add_states_from_episodes_to_batch": 3.554350291205415e-06}}}, "sample": 0.7358423640916583, "episode_len_max": 50, "num_env_steps_sampled": 1000, "episode_return_max": 17.5, "env_to_module_sum_episodes_length_out": 27.168093332126602, "env_reset_timer": 0.000353583033953805, "episode_duration_sec_mean": 0.035366597000011095, "env_to_module_sum_episodes_length_in": 27.168093332126602, "rlmodule_inference_timer": 9.680821564313384e-05, "episode_return_mean": -0.5, "weights_seq_no": 6.0, "episode_len_min": 50, "num_module_steps_sampled_lifetime": {"default_policy": 6000}, "num_agent_steps_sampled": {"default_agent": 1000}, "num_agent_steps_sampled_lifetime": {"default_agent": 6000}, "num_env_steps_sampled_lifetime": 31000, "num_episodes": 20, "episode_len_mean": 50.0, "agent_episode_returns_mean": {"default_agent": -0.5}, "num_module_steps_sampled": {"default_policy": 1000}, "module_episode_returns_mean": {"default_policy": -0.5}, "episode_return_min": -16.5, "time_between_sampling": 4.255823293817058}, "num_healthy_workers": 1, "actor_manager_num_outstanding_async_reqs": 0, "num_remote_worker_restarts": 0}, "num_env_steps_sampled_lifetime": -960000.0, "fault_tolerance": {"num_healthy_workers": 0, "num_remote_worker_restarts": 0}, "env_runner_group": {"actor_manager_num_outstanding_async_reqs": 0}, "done": false, "training_iteration": 6, "trial_id": "145e5_00000", "date": "2025-08-11_17-52-06", "timestamp": 1754927526, "time_this_iter_s": 5.060222625732422, "time_total_s": 30.205825567245483, "pid": 98861, "hostname": "DESKTOP-3SK5A41", "node_ip": "192.168.40.242", "config": {"exploration_config": {}, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 6, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "env": "Umbrella", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": false, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 0, "create_local_env_runner": true, "num_envs_per_env_runner": 1, "gym_env_vectorize_mode": "SYNC", "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "episodes_to_numpy": true, "max_requests_in_flight_per_env_runner": 1, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "merge_env_runner_states": "training_only", "broadcast_env_runner_states": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "complete_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "sampler_perf_stats_ema_coef": null, "_is_online": true, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": "auto", "num_aggregator_actors_per_learner": 0, "max_requests_in_flight_per_aggregator_actor": 3, "local_gpu_idx": 0, "max_requests_in_flight_per_learner": 3, "gamma": 1, "lr": 0.0507729549118, "grad_clip": 0.5, "grad_clip_by": "global_norm", "_train_batch_size_per_learner": 5000, "train_batch_size": 4000, "num_epochs": 3, "minibatch_size": 1000, "shuffle_batch_per_epoch": true, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "log_std_clip_param": 20.0, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "_disable_preprocessor_api": false, "_disable_action_flattening": false}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "_learner_class": null, "callbacks_on_algorithm_init": null, "callbacks_on_env_runners_recreated": null, "callbacks_on_offline_eval_runners_recreated": null, "callbacks_on_checkpoint_loaded": null, "callbacks_on_environment_created": null, "callbacks_on_episode_created": null, "callbacks_on_episode_start": null, "callbacks_on_episode_step": null, "callbacks_on_episode_end": null, "callbacks_on_evaluate_start": null, "callbacks_on_evaluate_end": null, "callbacks_on_evaluate_offline_start": null, "callbacks_on_evaluate_offline_end": null, "callbacks_on_sample_end": null, "callbacks_on_train_result": null, "explore": true, "enable_rl_module_and_learner": true, "enable_env_runner_and_connector_v2": true, "_prior_exploration_config": {"type": "StochasticSampling"}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7c54f75b6ac0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "offline_data_class": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_read_batch_size": null, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "materialize_data": false, "materialize_mapped_data": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "ignore_final_observation": false, "prelearner_class": null, "prelearner_buffer_class": null, "prelearner_buffer_kwargs": {}, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_remaining_data": false, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": 1, "evaluation_duration": 20, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_auto_duration_min_env_steps_per_sample": 100, "evaluation_auto_duration_max_env_steps_per_sample": 2000, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 1, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "offline_evaluation_interval": null, "num_offline_eval_runners": 0, "offline_loss_for_module_fn": null, "offline_evaluation_duration": 1, "offline_evaluation_parallel_to_training": false, "offline_evaluation_timeout_s": 120.0, "num_cpus_per_offline_eval_runner": 1, "num_gpus_per_offline_eval_runner": 0, "custom_resources_per_offline_eval_runner": {}, "restart_failed_offline_eval_runners": true, "ignore_offline_eval_runner_failures": false, "max_num_offline_eval_runner_restarts": 1000, "offline_eval_runner_restore_timeout_s": 1800.0, "max_requests_in_flight_per_offline_eval_runner": 1, "validate_offline_eval_runners_after_construction": true, "offline_eval_runner_health_probe_timeout_s": 30.0, "offline_eval_rl_module_inference_only": false, "broadcast_offline_eval_runner_states": false, "offline_eval_batch_size_per_runner": 256, "dataset_num_iters_per_eval_runner": 1, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "log_gradients": true, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 42, "restart_failed_env_runners": true, "ignore_env_runner_failures": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30.0, "env_runner_restore_timeout_s": 1800.0, "_model_config": {}, "_rl_module_spec": "RLModuleSpec(module_class=None, observation_space=None, action_space=None, inference_only=False, learner_only=False, model_config=DefaultModelConfig(fcnet_hiddens=[38, 126], fcnet_activation='tanh', fcnet_kernel_initializer=None, fcnet_kernel_initializer_kwargs=None, fcnet_bias_initializer=None, fcnet_bias_initializer_kwargs=None, conv_filters=None, conv_activation='relu', conv_kernel_initializer=None, conv_kernel_initializer_kwargs=None, conv_bias_initializer=None, conv_bias_initializer_kwargs=None, head_fcnet_hiddens=[], head_fcnet_activation='relu', head_fcnet_kernel_initializer=None, head_fcnet_kernel_initializer_kwargs=None, head_fcnet_bias_initializer=None, head_fcnet_bias_initializer_kwargs=None, free_log_std=False, log_std_clip_param=20.0, vf_share_layers=True, use_lstm=False, max_seq_len=20, lstm_cell_size=256, lstm_use_prev_action=False, lstm_use_prev_reward=False, lstm_kernel_initializer=None, lstm_kernel_initializer_kwargs=None, lstm_bias_initializer=None, lstm_bias_initializer_kwargs=None), catalog_class=None, load_state_path=None, model_config_dict=None)", "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "_validate_config": true, "_use_msgpack_checkpoints": false, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "env_task_fn": -1, "enable_connectors": -1, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2807905848935, "kl_target": 0.0268196110247, "vf_loss_coeff": 0.7591449667272, "entropy_coeff": 0.0454572554143, "clip_param": 0.2757781835805, "vf_clip_param": 0.1077321361793, "entropy_coeff_schedule": null, "lr_schedule": null, "sgd_minibatch_size": -1, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9403062964939, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.callbacks.callbacks.RLlibCallback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 30.205825567245483, "iterations_since_restore": 6, "perf": {"cpu_util_percent": 12.85714285714286, "ram_util_percent": 83.39999999999999}}
{"timers": {"training_iteration": 4.347755969106696, "restore_env_runners": 1.492966631563322e-05, "training_step": 4.347508243856406, "env_runner_sampling_timer": 3.8733549690243714, "learner_update_timer": 0.47068667519782936, "synch_weights": 0.001489824201851741, "restore_eval_env_runners": 1.3941045675746616e-05, "evaluation_iteration": 0.7475021516484469, "synch_eval_env_connectors": 0.000564070718928935, "synch_env_connectors": 7.756447975324215e-06}, "env_runners": {"module_to_env_connector": {"timers": {"connectors": {"normalize_and_clip_actions": 2.256985018204059e-05, "get_actions": 0.00016651882511281091, "un_batch_to_individual_items": 1.4589166590216337e-05, "listify_data_for_vector_env": 3.123432093977202e-05, "tensor_to_numpy": 4.975964873412617e-05, "remove_single_ts_time_rank_from_batch": 1.4998790832177585e-06}}, "connector_pipeline_timer": 0.00036321809581872216}, "env_reset_timer": 9.423361536649958e-05, "env_to_module_connector": {"connector_pipeline_timer": 0.00011879723739296788, "timers": {"connectors": {"add_time_dim_to_batch_and_zero_pad": 6.701021608682901e-06, "add_states_from_episodes_to_batch": 3.451920015505152e-06, "add_observations_from_episodes_to_batch": 6.316170673283059e-06, "batch_individual_items": 1.839444760296155e-05, "numpy_to_tensor": 3.14435655292099e-05}}}, "num_module_steps_sampled": {"default_policy": 5000.0}, "num_env_steps_sampled_lifetime": -1202500.0, "episode_duration_sec_mean": 0.03679618099995424, "env_to_module_sum_episodes_length_in": 27.16809333212661, "num_episodes_lifetime": -24050.0, "env_step_timer": 4.329718181070059e-05, "rlmodule_inference_timer": 0.00010319436187516509, "agent_episode_returns_mean": {"default_agent": 10.700000000000003}, "num_episodes": 100.0, "episode_len_mean": 50.0, "num_module_steps_sampled_lifetime": {"default_policy": -1202500.0}, "module_episode_returns_mean": {"default_policy": 10.700000000000003}, "episode_return_mean": 10.700000000000003, "sample": 0.03791654612480273, "weights_seq_no": 6.0, "episode_len_min": 50, "episode_len_max": 50, "num_env_steps_sampled": 5000.0, "num_agent_steps_sampled": {"default_agent": 5000.0}, "episode_return_min": -5.5, "episode_return_max": 14.5, "env_to_module_sum_episodes_length_out": 27.16809333212661, "time_between_sampling": 0.012741711084635187, "num_agent_steps_sampled_lifetime": {"default_agent": -1202500.0}, "num_env_steps_sampled_lifetime_throughput": 1270.2102158059092}, "learners": {"__all_modules__": {"num_module_steps_trained": 16000, "num_trainable_parameters": 5447, "learner_connector": {"timers": {"connectors": {"batch_individual_items": 0.201824028283719, "numpy_to_tensor": 0.00017190102184888844, "add_one_ts_to_episodes_and_truncate": 0.008527606351004009, "add_observations_from_episodes_to_batch": 0.0008027557099562347, "add_columns_from_episodes_to_train_batch": 0.0680196909281432, "add_time_dim_to_batch_and_zero_pad": 2.2959475784646122e-05, "add_states_from_episodes_to_batch": 6.301437688560825e-06, "general_advantage_estimation": 0.01163761991256268}}, "connector_pipeline_timer": 0.2913794029713635}, "learner_connector_sum_episodes_length_in": 5000.0, "num_non_trainable_parameters": 0, "num_env_steps_trained": 81600, "num_module_steps_trained_lifetime": 112000, "learner_connector_sum_episodes_length_out": 5100.0, "num_env_steps_trained_lifetime": 571200, "num_env_steps_trained_lifetime_throughput": 851995.682473051, "num_module_steps_trained_throughput": 167485.13619788125, "num_module_steps_trained_lifetime_throughput": 167386.027952575}, "default_policy": {"num_module_steps_trained": 16000, "diff_num_grad_updates_vs_sampler_policy": 1.0, "entropy": 0.3780389428138733, "total_loss": 0.04739911109209061, "num_trainable_parameters": 5447, "policy_loss": -0.02139880694448948, "mean_kl_loss": 0.0797409638762474, "module_train_batch_size_mean": 1000.0, "curr_entropy_coeff": 0.0454572554143, "vf_explained_var": -0.12077474594116211, "gradients_default_optimizer_global_norm": 0.5810407400131226, "default_optimizer_learning_rate": 0.0507729549118, "num_module_steps_trained_lifetime": 112000, "weights_seq_no": 7.0, "curr_kl_coeff": 0.07897235453128815, "vf_loss_unclipped": 567.1678466796875, "vf_loss": 0.1077321320772171, "num_module_steps_trained_lifetime_throughput": 167693.06632432676}}, "num_training_step_calls_per_iteration": 1, "evaluation": {"env_runners": {"num_episodes_lifetime": 140, "env_step_timer": 4.1697497556944224e-05, "module_to_env_connector": {"timers": {"connectors": {"normalize_and_clip_actions": 2.1672589743343493e-05, "get_actions": 0.00015569040166706993, "tensor_to_numpy": 4.5863409122088303e-05, "un_batch_to_individual_items": 1.498568395651572e-05, "remove_single_ts_time_rank_from_batch": 1.3867317926292927e-06, "listify_data_for_vector_env": 2.9511499471214807e-05}}, "connector_pipeline_timer": 0.0003409783047531481}, "env_to_module_connector": {"connector_pipeline_timer": 0.00011312641145444194, "timers": {"connectors": {"numpy_to_tensor": 2.926220264369137e-05, "batch_individual_items": 1.861506350094339e-05, "add_observations_from_episodes_to_batch": 5.904990966697024e-06, "add_time_dim_to_batch_and_zero_pad": 6.2396129807912825e-06, "add_states_from_episodes_to_batch": 3.426247775497517e-06}}}, "sample": 0.735776115450735, "episode_len_max": 50, "num_env_steps_sampled": 1000, "episode_return_max": 17.5, "env_to_module_sum_episodes_length_out": 27.168093332126602, "env_reset_timer": 0.0003512732036182202, "episode_duration_sec_mean": 0.0353349820099902, "env_to_module_sum_episodes_length_in": 27.168093332126602, "rlmodule_inference_timer": 9.544117199756092e-05, "episode_return_mean": -0.7, "weights_seq_no": 7.0, "episode_len_min": 50, "num_module_steps_sampled_lifetime": {"default_policy": 7000}, "num_agent_steps_sampled": {"default_agent": 1000}, "num_agent_steps_sampled_lifetime": {"default_agent": 7000}, "num_env_steps_sampled_lifetime": 36000, "num_episodes": 20, "episode_len_mean": 50.0, "agent_episode_returns_mean": {"default_agent": -0.7}, "num_module_steps_sampled": {"default_policy": 1000}, "module_episode_returns_mean": {"default_policy": -0.7}, "episode_return_min": -16.5, "time_between_sampling": 4.255690389878895}, "num_healthy_workers": 1, "actor_manager_num_outstanding_async_reqs": 0, "num_remote_worker_restarts": 0}, "num_env_steps_sampled_lifetime": -1202500.0, "fault_tolerance": {"num_healthy_workers": 0, "num_remote_worker_restarts": 0}, "env_runner_group": {"actor_manager_num_outstanding_async_reqs": 0}, "done": true, "training_iteration": 7, "trial_id": "145e5_00000", "date": "2025-08-11_17-52-11", "timestamp": 1754927531, "time_this_iter_s": 4.931083917617798, "time_total_s": 35.13690948486328, "pid": 98861, "hostname": "DESKTOP-3SK5A41", "node_ip": "192.168.40.242", "config": {"exploration_config": {}, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 6, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "env": "Umbrella", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": false, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 0, "create_local_env_runner": true, "num_envs_per_env_runner": 1, "gym_env_vectorize_mode": "SYNC", "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "episodes_to_numpy": true, "max_requests_in_flight_per_env_runner": 1, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "merge_env_runner_states": "training_only", "broadcast_env_runner_states": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "complete_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "sampler_perf_stats_ema_coef": null, "_is_online": true, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": "auto", "num_aggregator_actors_per_learner": 0, "max_requests_in_flight_per_aggregator_actor": 3, "local_gpu_idx": 0, "max_requests_in_flight_per_learner": 3, "gamma": 1, "lr": 0.0507729549118, "grad_clip": 0.5, "grad_clip_by": "global_norm", "_train_batch_size_per_learner": 5000, "train_batch_size": 4000, "num_epochs": 3, "minibatch_size": 1000, "shuffle_batch_per_epoch": true, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "log_std_clip_param": 20.0, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "_disable_preprocessor_api": false, "_disable_action_flattening": false}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "_learner_class": null, "callbacks_on_algorithm_init": null, "callbacks_on_env_runners_recreated": null, "callbacks_on_offline_eval_runners_recreated": null, "callbacks_on_checkpoint_loaded": null, "callbacks_on_environment_created": null, "callbacks_on_episode_created": null, "callbacks_on_episode_start": null, "callbacks_on_episode_step": null, "callbacks_on_episode_end": null, "callbacks_on_evaluate_start": null, "callbacks_on_evaluate_end": null, "callbacks_on_evaluate_offline_start": null, "callbacks_on_evaluate_offline_end": null, "callbacks_on_sample_end": null, "callbacks_on_train_result": null, "explore": true, "enable_rl_module_and_learner": true, "enable_env_runner_and_connector_v2": true, "_prior_exploration_config": {"type": "StochasticSampling"}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7c54f75b6ac0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "offline_data_class": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_read_batch_size": null, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "materialize_data": false, "materialize_mapped_data": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "ignore_final_observation": false, "prelearner_class": null, "prelearner_buffer_class": null, "prelearner_buffer_kwargs": {}, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_remaining_data": false, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": 1, "evaluation_duration": 20, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_auto_duration_min_env_steps_per_sample": 100, "evaluation_auto_duration_max_env_steps_per_sample": 2000, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 1, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "offline_evaluation_interval": null, "num_offline_eval_runners": 0, "offline_loss_for_module_fn": null, "offline_evaluation_duration": 1, "offline_evaluation_parallel_to_training": false, "offline_evaluation_timeout_s": 120.0, "num_cpus_per_offline_eval_runner": 1, "num_gpus_per_offline_eval_runner": 0, "custom_resources_per_offline_eval_runner": {}, "restart_failed_offline_eval_runners": true, "ignore_offline_eval_runner_failures": false, "max_num_offline_eval_runner_restarts": 1000, "offline_eval_runner_restore_timeout_s": 1800.0, "max_requests_in_flight_per_offline_eval_runner": 1, "validate_offline_eval_runners_after_construction": true, "offline_eval_runner_health_probe_timeout_s": 30.0, "offline_eval_rl_module_inference_only": false, "broadcast_offline_eval_runner_states": false, "offline_eval_batch_size_per_runner": 256, "dataset_num_iters_per_eval_runner": 1, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "log_gradients": true, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 42, "restart_failed_env_runners": true, "ignore_env_runner_failures": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30.0, "env_runner_restore_timeout_s": 1800.0, "_model_config": {}, "_rl_module_spec": "RLModuleSpec(module_class=None, observation_space=None, action_space=None, inference_only=False, learner_only=False, model_config=DefaultModelConfig(fcnet_hiddens=[38, 126], fcnet_activation='tanh', fcnet_kernel_initializer=None, fcnet_kernel_initializer_kwargs=None, fcnet_bias_initializer=None, fcnet_bias_initializer_kwargs=None, conv_filters=None, conv_activation='relu', conv_kernel_initializer=None, conv_kernel_initializer_kwargs=None, conv_bias_initializer=None, conv_bias_initializer_kwargs=None, head_fcnet_hiddens=[], head_fcnet_activation='relu', head_fcnet_kernel_initializer=None, head_fcnet_kernel_initializer_kwargs=None, head_fcnet_bias_initializer=None, head_fcnet_bias_initializer_kwargs=None, free_log_std=False, log_std_clip_param=20.0, vf_share_layers=True, use_lstm=False, max_seq_len=20, lstm_cell_size=256, lstm_use_prev_action=False, lstm_use_prev_reward=False, lstm_kernel_initializer=None, lstm_kernel_initializer_kwargs=None, lstm_bias_initializer=None, lstm_bias_initializer_kwargs=None), catalog_class=None, load_state_path=None, model_config_dict=None)", "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "_validate_config": true, "_use_msgpack_checkpoints": false, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "env_task_fn": -1, "enable_connectors": -1, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2807905848935, "kl_target": 0.0268196110247, "vf_loss_coeff": 0.7591449667272, "entropy_coeff": 0.0454572554143, "clip_param": 0.2757781835805, "vf_clip_param": 0.1077321361793, "entropy_coeff_schedule": null, "lr_schedule": null, "sgd_minibatch_size": -1, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9403062964939, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.callbacks.callbacks.RLlibCallback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 35.13690948486328, "iterations_since_restore": 7, "perf": {"cpu_util_percent": 12.485714285714286, "ram_util_percent": 83.39999999999999}}
