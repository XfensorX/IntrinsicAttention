{"timers": {"training_iteration": 4.2797169330000315, "restore_env_runners": 1.4200000009623182e-05, "training_step": 4.27942343299992, "env_runner_sampling_timer": 3.837826419999942, "learner_update_timer": 0.4375699129999475, "synch_weights": 0.0016304000000673113}, "env_runners": {"episode_len_max": 50, "env_to_module_connector": {"timers": {"connectors": {"add_time_dim_to_batch_and_zero_pad": 6.226783329012984e-06, "add_states_from_episodes_to_batch": 3.3806868440767465e-06, "add_observations_from_episodes_to_batch": 6.316405893310522e-06, "batch_individual_items": 1.8413886026852054e-05, "numpy_to_tensor": 3.150037908677933e-05}}, "connector_pipeline_timer": 0.00012065677935881699}, "env_reset_timer": 0.00021837136297880448, "module_to_env_connector": {"timers": {"connectors": {"tensor_to_numpy": 4.7725226521074746e-05, "remove_single_ts_time_rank_from_batch": 1.4618101224251464e-06, "listify_data_for_vector_env": 3.0935013561343686e-05, "un_batch_to_individual_items": 1.4905724250560427e-05, "get_actions": 0.0001682363324335511, "normalize_and_clip_actions": 2.8527507809318094e-05}}, "connector_pipeline_timer": 0.00036896600547892545}, "env_to_module_sum_episodes_length_out": 26.762340024562445, "num_agent_steps_sampled_lifetime": {"default_agent": 252500.0}, "agent_episode_returns_mean": {"default_agent": 4.7}, "env_to_module_sum_episodes_length_in": 26.762340024562445, "episode_return_min": -5.5, "num_env_steps_sampled_lifetime": 252500.0, "num_episodes_lifetime": 5050.0, "episode_len_mean": 50.0, "time_between_sampling": 0.0012374107983475213, "num_agent_steps_sampled": {"default_agent": 5000.0}, "module_episode_returns_mean": {"default_policy": 4.7}, "episode_len_min": 50, "num_env_steps_sampled": 5000.0, "num_episodes": 100.0, "num_module_steps_sampled_lifetime": {"default_policy": 252500.0}, "episode_return_max": 14.5, "num_module_steps_sampled": {"default_policy": 5000.0}, "episode_return_mean": 4.7, "episode_duration_sec_mean": 0.03589461111999981, "rlmodule_inference_timer": 0.00010227843434026288, "weights_seq_no": 0.0, "env_step_timer": 4.436389719526326e-05, "sample": 0.03938424419673873, "num_env_steps_sampled_lifetime_throughput": 1263.913214087751}, "learners": {"__all_modules__": {"learner_connector": {"timers": {"connectors": {"add_columns_from_episodes_to_train_batch": 0.06664860199998657, "add_observations_from_episodes_to_batch": 0.0007946000000629283, "add_time_dim_to_batch_and_zero_pad": 2.2400000034394907e-05, "batch_individual_items": 0.19780270599994765, "add_one_ts_to_episodes_and_truncate": 0.008275500000081593, "general_advantage_estimation": 0.0140794010000036, "add_states_from_episodes_to_batch": 6.699999971715442e-06, "numpy_to_tensor": 0.00017649999995228427}}, "connector_pipeline_timer": 0.28819290900003125}, "num_env_steps_trained": 56100, "num_module_steps_trained": 11000, "num_non_trainable_parameters": 0, "learner_connector_sum_episodes_length_in": 5000, "num_module_steps_trained_lifetime": 11000, "learner_connector_sum_episodes_length_out": 5100, "num_trainable_parameters": 4148, "num_env_steps_trained_lifetime": 56100, "num_env_steps_trained_lifetime_throughput": 836573.1423954163, "num_module_steps_trained_throughput": 164726.6773024734, "num_module_steps_trained_lifetime_throughput": 164441.82253730443}, "default_policy": {"curr_entropy_coeff": 0.0018408992081, "gradients_default_optimizer_global_norm": 0.08716365694999695, "entropy": 0.6920603513717651, "policy_loss": -0.011031382717192173, "total_loss": 0.22934278845787048, "num_trainable_parameters": 4148, "num_module_steps_trained_lifetime": 11000, "vf_loss": 0.34867939352989197, "module_train_batch_size_mean": 1000.0, "vf_explained_var": -0.06348955631256104, "default_optimizer_learning_rate": 0.0027541439213, "num_module_steps_trained": 11000, "curr_kl_coeff": 0.29699259996414185, "vf_loss_unclipped": 25.986574172973633, "diff_num_grad_updates_vs_sampler_policy": 1.0, "mean_kl_loss": 0.00019372763927094638, "weights_seq_no": 1.0, "num_module_steps_trained_lifetime_throughput": 165119.514788952}}, "num_training_step_calls_per_iteration": 1, "num_env_steps_sampled_lifetime": 252500.0, "evaluation": {"env_runners": {"env_to_module_connector": {"connector_pipeline_timer": 0.00011500895715194483, "timers": {"connectors": {"add_time_dim_to_batch_and_zero_pad": 5.687664392969886e-06, "batch_individual_items": 1.8379405273311846e-05, "numpy_to_tensor": 3.0107765252749618e-05, "add_states_from_episodes_to_batch": 3.349905902910167e-06, "add_observations_from_episodes_to_batch": 6.441650759477924e-06}}}, "num_episodes": 20, "episode_return_max": 17.5, "episode_return_mean": 0.1, "rlmodule_inference_timer": 9.611315536040101e-05, "module_to_env_connector": {"timers": {"connectors": {"un_batch_to_individual_items": 1.5395561903422918e-05, "normalize_and_clip_actions": 2.191605119452115e-05, "tensor_to_numpy": 4.708942577488672e-05, "listify_data_for_vector_env": 3.028104302480923e-05, "remove_single_ts_time_rank_from_batch": 1.4074510417353314e-06, "get_actions": 0.0001638410186557419}}, "connector_pipeline_timer": 0.0003549487858973465}, "sample": 0.7351838230000567, "episode_len_max": 50, "episode_len_mean": 50.0, "num_agent_steps_sampled": {"default_agent": 1000}, "agent_episode_returns_mean": {"default_agent": 0.1}, "num_module_steps_sampled_lifetime": {"default_policy": 1000}, "env_step_timer": 4.252149430660883e-05, "env_reset_timer": 0.00021059999994577083, "episode_return_min": -14.5, "num_env_steps_sampled_lifetime": 6000, "env_to_module_sum_episodes_length_in": 27.167134025045954, "episode_duration_sec_mean": 0.03528722109999194, "num_module_steps_sampled": {"default_policy": 1000}, "num_episodes_lifetime": 20, "episode_len_min": 50, "num_env_steps_sampled": 1000, "num_agent_steps_sampled_lifetime": {"default_agent": 1000}, "module_episode_returns_mean": {"default_policy": 0.1}, "weights_seq_no": 1.0, "env_to_module_sum_episodes_length_out": 27.167134025045954}, "num_healthy_workers": 1, "actor_manager_num_outstanding_async_reqs": 0, "num_remote_worker_restarts": 0}, "fault_tolerance": {"num_healthy_workers": 0, "num_remote_worker_restarts": 0}, "env_runner_group": {"actor_manager_num_outstanding_async_reqs": 0}, "done": false, "training_iteration": 1, "trial_id": "f5bb1_00000", "date": "2025-08-11_16-11-23", "timestamp": 1754921483, "time_this_iter_s": 5.030611991882324, "time_total_s": 5.030611991882324, "pid": 12703, "hostname": "DESKTOP-3SK5A41", "node_ip": "192.168.40.242", "config": {"exploration_config": {}, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 6, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "env": "Umbrella", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": false, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 0, "create_local_env_runner": true, "num_envs_per_env_runner": 1, "gym_env_vectorize_mode": "SYNC", "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "episodes_to_numpy": true, "max_requests_in_flight_per_env_runner": 1, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "merge_env_runner_states": "training_only", "broadcast_env_runner_states": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "complete_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "sampler_perf_stats_ema_coef": null, "_is_online": true, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": "auto", "num_aggregator_actors_per_learner": 0, "max_requests_in_flight_per_aggregator_actor": 3, "local_gpu_idx": 0, "max_requests_in_flight_per_learner": 3, "gamma": 1, "lr": 0.0027541439213, "grad_clip": 0.5, "grad_clip_by": "global_norm", "_train_batch_size_per_learner": 5000, "train_batch_size": 4000, "num_epochs": 2, "minibatch_size": 1000, "shuffle_batch_per_epoch": true, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "log_std_clip_param": 20.0, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "_disable_preprocessor_api": false, "_disable_action_flattening": false}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "_learner_class": null, "callbacks_on_algorithm_init": null, "callbacks_on_env_runners_recreated": null, "callbacks_on_offline_eval_runners_recreated": null, "callbacks_on_checkpoint_loaded": null, "callbacks_on_environment_created": null, "callbacks_on_episode_created": null, "callbacks_on_episode_start": null, "callbacks_on_episode_step": null, "callbacks_on_episode_end": null, "callbacks_on_evaluate_start": null, "callbacks_on_evaluate_end": null, "callbacks_on_evaluate_offline_start": null, "callbacks_on_evaluate_offline_end": null, "callbacks_on_sample_end": null, "callbacks_on_train_result": null, "explore": true, "enable_rl_module_and_learner": true, "enable_env_runner_and_connector_v2": true, "_prior_exploration_config": {"type": "StochasticSampling"}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x73ae51472ac0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "offline_data_class": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_read_batch_size": null, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "materialize_data": false, "materialize_mapped_data": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "ignore_final_observation": false, "prelearner_class": null, "prelearner_buffer_class": null, "prelearner_buffer_kwargs": {}, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_remaining_data": false, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": 1, "evaluation_duration": 20, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_auto_duration_min_env_steps_per_sample": 100, "evaluation_auto_duration_max_env_steps_per_sample": 2000, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 1, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "offline_evaluation_interval": null, "num_offline_eval_runners": 0, "offline_loss_for_module_fn": null, "offline_evaluation_duration": 1, "offline_evaluation_parallel_to_training": false, "offline_evaluation_timeout_s": 120.0, "num_cpus_per_offline_eval_runner": 1, "num_gpus_per_offline_eval_runner": 0, "custom_resources_per_offline_eval_runner": {}, "restart_failed_offline_eval_runners": true, "ignore_offline_eval_runner_failures": false, "max_num_offline_eval_runner_restarts": 1000, "offline_eval_runner_restore_timeout_s": 1800.0, "max_requests_in_flight_per_offline_eval_runner": 1, "validate_offline_eval_runners_after_construction": true, "offline_eval_runner_health_probe_timeout_s": 30.0, "offline_eval_rl_module_inference_only": false, "broadcast_offline_eval_runner_states": false, "offline_eval_batch_size_per_runner": 256, "dataset_num_iters_per_eval_runner": 1, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "log_gradients": true, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 42, "restart_failed_env_runners": true, "ignore_env_runner_failures": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30.0, "env_runner_restore_timeout_s": 1800.0, "_model_config": {}, "_rl_module_spec": "RLModuleSpec(module_class=None, observation_space=None, action_space=None, inference_only=False, learner_only=False, model_config=DefaultModelConfig(fcnet_hiddens=[53, 69], fcnet_activation='tanh', fcnet_kernel_initializer=None, fcnet_kernel_initializer_kwargs=None, fcnet_bias_initializer=None, fcnet_bias_initializer_kwargs=None, conv_filters=None, conv_activation='relu', conv_kernel_initializer=None, conv_kernel_initializer_kwargs=None, conv_bias_initializer=None, conv_bias_initializer_kwargs=None, head_fcnet_hiddens=[], head_fcnet_activation='relu', head_fcnet_kernel_initializer=None, head_fcnet_kernel_initializer_kwargs=None, head_fcnet_bias_initializer=None, head_fcnet_bias_initializer_kwargs=None, free_log_std=False, log_std_clip_param=20.0, vf_share_layers=True, use_lstm=False, max_seq_len=20, lstm_cell_size=256, lstm_use_prev_action=False, lstm_use_prev_reward=False, lstm_kernel_initializer=None, lstm_kernel_initializer_kwargs=None, lstm_bias_initializer=None, lstm_bias_initializer_kwargs=None), catalog_class=None, load_state_path=None, model_config_dict=None)", "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "_validate_config": true, "_use_msgpack_checkpoints": false, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "env_task_fn": -1, "enable_connectors": -1, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.5939852077022, "kl_target": 0.0137962462363, "vf_loss_coeff": 0.69270825127, "entropy_coeff": 0.0018408992081, "clip_param": 0.1749080237695, "vf_clip_param": 0.3721230154351, "entropy_coeff_schedule": null, "lr_schedule": null, "sgd_minibatch_size": -1, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.95565474084, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.callbacks.callbacks.RLlibCallback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 5.030611991882324, "iterations_since_restore": 1, "perf": {"cpu_util_percent": 10.5875, "ram_util_percent": 79.725}}
{"timers": {"training_iteration": 4.279792094790032, "restore_env_runners": 1.4210000009597933e-05, "training_step": 4.27949716078992, "env_runner_sampling_timer": 3.8402055868699425, "learner_update_timer": 0.4352683829199475, "synch_weights": 0.0016283270000667471, "restore_eval_env_runners": 1.4699999951517384e-05, "evaluation_iteration": 0.7475809229999868, "synch_eval_env_connectors": 0.0005916000000070198, "synch_env_connectors": 8.399999956054671e-06}, "env_runners": {"episode_len_max": 50, "env_to_module_connector": {"timers": {"connectors": {"add_time_dim_to_batch_and_zero_pad": 6.397171221859661e-06, "add_states_from_episodes_to_batch": 3.5902325380906016e-06, "add_observations_from_episodes_to_batch": 6.479847858828573e-06, "batch_individual_items": 1.9169612802955372e-05, "numpy_to_tensor": 3.260182507480967e-05}}, "connector_pipeline_timer": 0.00012385293469347857}, "env_reset_timer": 0.0001445108007235254, "module_to_env_connector": {"timers": {"connectors": {"tensor_to_numpy": 5.18155425097117e-05, "remove_single_ts_time_rank_from_batch": 1.5224319578196994e-06, "listify_data_for_vector_env": 3.2266377204466886e-05, "un_batch_to_individual_items": 1.534022230650197e-05, "get_actions": 0.00017203244565626492, "normalize_and_clip_actions": 2.362279234647302e-05}}, "connector_pipeline_timer": 0.00037673014378541937}, "env_to_module_sum_episodes_length_out": 27.16809333212661, "num_agent_steps_sampled_lifetime": {"default_agent": 10000.0}, "agent_episode_returns_mean": {"default_agent": 5.700000000000004}, "env_to_module_sum_episodes_length_in": 27.16809333212661, "episode_return_min": -5.5, "num_env_steps_sampled_lifetime": 10000.0, "num_episodes_lifetime": 200.0, "episode_len_mean": 50.0, "time_between_sampling": 0.009212192616837322, "num_agent_steps_sampled": {"default_agent": 5000.0}, "module_episode_returns_mean": {"default_policy": 5.700000000000004}, "episode_len_min": 50, "num_env_steps_sampled": 5000.0, "num_episodes": 100.0, "num_module_steps_sampled_lifetime": {"default_policy": 10000.0}, "episode_return_max": 14.5, "num_module_steps_sampled": {"default_policy": 5000.0}, "episode_return_mean": 5.700000000000004, "episode_duration_sec_mean": 0.03808581198999944, "rlmodule_inference_timer": 0.00010425880278985636, "weights_seq_no": 1.0, "env_step_timer": 4.513449003914397e-05, "sample": 0.039022430022282714, "num_env_steps_sampled_lifetime_throughput": 1246.4197749685557}, "learners": {"__all_modules__": {"learner_connector": {"timers": {"connectors": {"add_columns_from_episodes_to_train_batch": 0.0666372179999871, "add_observations_from_episodes_to_batch": 0.0007939290000626897, "add_time_dim_to_batch_and_zero_pad": 2.2390000034420154e-05, "batch_individual_items": 0.19641226994994782, "add_one_ts_to_episodes_and_truncate": 0.008272957000081078, "general_advantage_estimation": 0.01405067400000348, "add_states_from_episodes_to_batch": 6.6949999722965e-06, "numpy_to_tensor": 0.0001770089999524771}}, "connector_pipeline_timer": 0.2867580699500309}, "num_env_steps_trained": 56100, "num_module_steps_trained": 11000, "num_non_trainable_parameters": 0, "learner_connector_sum_episodes_length_in": 5000.0, "num_module_steps_trained_lifetime": 22000, "learner_connector_sum_episodes_length_out": 5100.0, "num_trainable_parameters": 4148, "num_env_steps_trained_lifetime": 112200, "num_env_steps_trained_lifetime_throughput": 838010.2028219361, "num_module_steps_trained_throughput": 164990.77745379394, "num_module_steps_trained_lifetime_throughput": 164712.03806495987}, "default_policy": {"curr_entropy_coeff": 0.0018408992081, "gradients_default_optimizer_global_norm": 0.1695559322834015, "entropy": 0.6799131035804749, "policy_loss": 0.020607899874448776, "total_loss": 0.2640035152435303, "num_trainable_parameters": 4148, "num_module_steps_trained_lifetime": 22000, "vf_loss": 0.3519916236400604, "module_train_batch_size_mean": 1000.0, "vf_explained_var": -0.08744215965270996, "default_optimizer_learning_rate": 0.0027541439213, "num_module_steps_trained": 11000, "curr_kl_coeff": 0.14849629998207092, "vf_loss_unclipped": 26.665895462036133, "diff_num_grad_updates_vs_sampler_policy": 1.0, "mean_kl_loss": 0.002760108560323715, "weights_seq_no": 2.0, "num_module_steps_trained_lifetime_throughput": 165371.27172111132}}, "num_training_step_calls_per_iteration": 1, "evaluation": {"env_runners": {"env_to_module_connector": {"connector_pipeline_timer": 0.00011517682748034066, "timers": {"connectors": {"add_time_dim_to_batch_and_zero_pad": 5.699271950318397e-06, "batch_individual_items": 1.829661010148803e-05, "numpy_to_tensor": 3.115957808328857e-05, "add_states_from_episodes_to_batch": 3.3524102386151534e-06, "add_observations_from_episodes_to_batch": 6.515837855349649e-06}}}, "num_episodes": 20, "episode_return_max": 17.5, "episode_return_mean": -0.4, "rlmodule_inference_timer": 9.64269713518332e-05, "module_to_env_connector": {"timers": {"connectors": {"un_batch_to_individual_items": 1.5836501434076734e-05, "normalize_and_clip_actions": 2.2182717863206042e-05, "tensor_to_numpy": 4.645085566768267e-05, "listify_data_for_vector_env": 3.088550620076994e-05, "remove_single_ts_time_rank_from_batch": 1.3865019030537785e-06, "get_actions": 0.00016520241271234375}}, "connector_pipeline_timer": 0.00035585131402630595}, "sample": 0.7352659369600565, "episode_len_max": 50, "episode_len_mean": 50.0, "num_agent_steps_sampled": {"default_agent": 1000}, "agent_episode_returns_mean": {"default_agent": -0.4}, "num_module_steps_sampled_lifetime": {"default_policy": 2000}, "env_step_timer": 4.401722357793981e-05, "env_reset_timer": 0.0002097929999467851, "episode_return_min": -16.5, "num_env_steps_sampled_lifetime": 11000, "env_to_module_sum_episodes_length_in": 27.168093298253442, "episode_duration_sec_mean": 0.035490168524998464, "num_module_steps_sampled": {"default_policy": 1000}, "num_episodes_lifetime": 40, "episode_len_min": 50, "num_env_steps_sampled": 1000, "num_agent_steps_sampled_lifetime": {"default_agent": 2000}, "module_episode_returns_mean": {"default_policy": -0.4}, "weights_seq_no": 2.0, "env_to_module_sum_episodes_length_out": 27.168093298253442, "time_between_sampling": 4.34385011300003}, "num_healthy_workers": 1, "actor_manager_num_outstanding_async_reqs": 0, "num_remote_worker_restarts": 0}, "num_env_steps_sampled_lifetime": 10000.0, "fault_tolerance": {"num_healthy_workers": 0, "num_remote_worker_restarts": 0}, "env_runner_group": {"actor_manager_num_outstanding_async_reqs": 0}, "done": false, "training_iteration": 2, "trial_id": "f5bb1_00000", "date": "2025-08-11_16-11-28", "timestamp": 1754921488, "time_this_iter_s": 5.044259786605835, "time_total_s": 10.07487177848816, "pid": 12703, "hostname": "DESKTOP-3SK5A41", "node_ip": "192.168.40.242", "config": {"exploration_config": {}, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 6, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "env": "Umbrella", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": false, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 0, "create_local_env_runner": true, "num_envs_per_env_runner": 1, "gym_env_vectorize_mode": "SYNC", "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "episodes_to_numpy": true, "max_requests_in_flight_per_env_runner": 1, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "merge_env_runner_states": "training_only", "broadcast_env_runner_states": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "complete_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "sampler_perf_stats_ema_coef": null, "_is_online": true, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": "auto", "num_aggregator_actors_per_learner": 0, "max_requests_in_flight_per_aggregator_actor": 3, "local_gpu_idx": 0, "max_requests_in_flight_per_learner": 3, "gamma": 1, "lr": 0.0027541439213, "grad_clip": 0.5, "grad_clip_by": "global_norm", "_train_batch_size_per_learner": 5000, "train_batch_size": 4000, "num_epochs": 2, "minibatch_size": 1000, "shuffle_batch_per_epoch": true, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "log_std_clip_param": 20.0, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "_disable_preprocessor_api": false, "_disable_action_flattening": false}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "_learner_class": null, "callbacks_on_algorithm_init": null, "callbacks_on_env_runners_recreated": null, "callbacks_on_offline_eval_runners_recreated": null, "callbacks_on_checkpoint_loaded": null, "callbacks_on_environment_created": null, "callbacks_on_episode_created": null, "callbacks_on_episode_start": null, "callbacks_on_episode_step": null, "callbacks_on_episode_end": null, "callbacks_on_evaluate_start": null, "callbacks_on_evaluate_end": null, "callbacks_on_evaluate_offline_start": null, "callbacks_on_evaluate_offline_end": null, "callbacks_on_sample_end": null, "callbacks_on_train_result": null, "explore": true, "enable_rl_module_and_learner": true, "enable_env_runner_and_connector_v2": true, "_prior_exploration_config": {"type": "StochasticSampling"}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x73ae51472ac0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "offline_data_class": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_read_batch_size": null, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "materialize_data": false, "materialize_mapped_data": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "ignore_final_observation": false, "prelearner_class": null, "prelearner_buffer_class": null, "prelearner_buffer_kwargs": {}, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_remaining_data": false, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": 1, "evaluation_duration": 20, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_auto_duration_min_env_steps_per_sample": 100, "evaluation_auto_duration_max_env_steps_per_sample": 2000, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 1, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "offline_evaluation_interval": null, "num_offline_eval_runners": 0, "offline_loss_for_module_fn": null, "offline_evaluation_duration": 1, "offline_evaluation_parallel_to_training": false, "offline_evaluation_timeout_s": 120.0, "num_cpus_per_offline_eval_runner": 1, "num_gpus_per_offline_eval_runner": 0, "custom_resources_per_offline_eval_runner": {}, "restart_failed_offline_eval_runners": true, "ignore_offline_eval_runner_failures": false, "max_num_offline_eval_runner_restarts": 1000, "offline_eval_runner_restore_timeout_s": 1800.0, "max_requests_in_flight_per_offline_eval_runner": 1, "validate_offline_eval_runners_after_construction": true, "offline_eval_runner_health_probe_timeout_s": 30.0, "offline_eval_rl_module_inference_only": false, "broadcast_offline_eval_runner_states": false, "offline_eval_batch_size_per_runner": 256, "dataset_num_iters_per_eval_runner": 1, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "log_gradients": true, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 42, "restart_failed_env_runners": true, "ignore_env_runner_failures": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30.0, "env_runner_restore_timeout_s": 1800.0, "_model_config": {}, "_rl_module_spec": "RLModuleSpec(module_class=None, observation_space=None, action_space=None, inference_only=False, learner_only=False, model_config=DefaultModelConfig(fcnet_hiddens=[53, 69], fcnet_activation='tanh', fcnet_kernel_initializer=None, fcnet_kernel_initializer_kwargs=None, fcnet_bias_initializer=None, fcnet_bias_initializer_kwargs=None, conv_filters=None, conv_activation='relu', conv_kernel_initializer=None, conv_kernel_initializer_kwargs=None, conv_bias_initializer=None, conv_bias_initializer_kwargs=None, head_fcnet_hiddens=[], head_fcnet_activation='relu', head_fcnet_kernel_initializer=None, head_fcnet_kernel_initializer_kwargs=None, head_fcnet_bias_initializer=None, head_fcnet_bias_initializer_kwargs=None, free_log_std=False, log_std_clip_param=20.0, vf_share_layers=True, use_lstm=False, max_seq_len=20, lstm_cell_size=256, lstm_use_prev_action=False, lstm_use_prev_reward=False, lstm_kernel_initializer=None, lstm_kernel_initializer_kwargs=None, lstm_bias_initializer=None, lstm_bias_initializer_kwargs=None), catalog_class=None, load_state_path=None, model_config_dict=None)", "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "_validate_config": true, "_use_msgpack_checkpoints": false, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "env_task_fn": -1, "enable_connectors": -1, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.5939852077022, "kl_target": 0.0137962462363, "vf_loss_coeff": 0.69270825127, "entropy_coeff": 0.0018408992081, "clip_param": 0.1749080237695, "vf_clip_param": 0.3721230154351, "entropy_coeff_schedule": null, "lr_schedule": null, "sgd_minibatch_size": -1, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.95565474084, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.callbacks.callbacks.RLlibCallback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 10.07487177848816, "iterations_since_restore": 2, "perf": {"cpu_util_percent": 16.02857142857143, "ram_util_percent": 80.08571428571429}}
{"timers": {"training_iteration": 4.281105580062132, "restore_env_runners": 1.4205900009835659e-05, "training_step": 4.280809700402021, "env_runner_sampling_timer": 3.842424995071243, "learner_update_timer": 0.43436511424074764, "synch_weights": 0.0016262287300660774, "restore_eval_env_runners": 1.4694999952098441e-05, "evaluation_iteration": 0.7476359919599861, "synch_eval_env_connectors": 0.000589608000007047, "synch_env_connectors": 8.385999956317392e-06}, "env_runners": {"episode_len_max": 50, "env_to_module_connector": {"timers": {"connectors": {"add_time_dim_to_batch_and_zero_pad": 6.369095495709184e-06, "add_states_from_episodes_to_batch": 3.591730190502254e-06, "add_observations_from_episodes_to_batch": 6.553694969005912e-06, "batch_individual_items": 1.8879253615216976e-05, "numpy_to_tensor": 3.298331116724679e-05}}, "connector_pipeline_timer": 0.00012295237258813706}, "env_reset_timer": 0.00012004995377387173, "module_to_env_connector": {"timers": {"connectors": {"tensor_to_numpy": 5.1113161814148984e-05, "remove_single_ts_time_rank_from_batch": 1.4799848929022843e-06, "listify_data_for_vector_env": 3.176752043937811e-05, "un_batch_to_individual_items": 1.5264678354112274e-05, "get_actions": 0.00017371010618307602, "normalize_and_clip_actions": 2.3551697369583977e-05}}, "connector_pipeline_timer": 0.00037614390670306116}, "env_to_module_sum_episodes_length_out": 27.16809333212661, "num_agent_steps_sampled_lifetime": {"default_agent": -232500.0}, "agent_episode_returns_mean": {"default_agent": 4.7}, "env_to_module_sum_episodes_length_in": 27.16809333212661, "episode_return_min": -5.5, "num_env_steps_sampled_lifetime": -232500.0, "num_episodes_lifetime": -4650.0, "episode_len_mean": 50.0, "time_between_sampling": 0.010745889920406135, "num_agent_steps_sampled": {"default_agent": 5000.0}, "module_episode_returns_mean": {"default_policy": 4.7}, "episode_len_min": 50, "num_env_steps_sampled": 5000.0, "num_episodes": 100.0, "num_module_steps_sampled_lifetime": {"default_policy": -232500.0}, "episode_return_max": 14.5, "num_module_steps_sampled": {"default_policy": 5000.0}, "episode_return_mean": 4.7, "episode_duration_sec_mean": 0.037969598959998616, "rlmodule_inference_timer": 0.00010368949938218132, "weights_seq_no": 2.0, "env_step_timer": 4.525107699869899e-05, "sample": 0.039006307841150424, "num_env_steps_sampled_lifetime_throughput": 1242.3053519974321}, "learners": {"__all_modules__": {"learner_connector": {"timers": {"connectors": {"add_columns_from_episodes_to_train_batch": 0.06664742684998708, "add_observations_from_episodes_to_batch": 0.000792910710061301, "add_time_dim_to_batch_and_zero_pad": 2.2382100033757977e-05, "batch_individual_items": 0.19643044133044923, "add_one_ts_to_episodes_and_truncate": 0.008270239440079832, "general_advantage_estimation": 0.014016347260003668, "add_states_from_episodes_to_batch": 6.683049971866239e-06, "numpy_to_tensor": 0.0001769189099532582}}, "connector_pipeline_timer": 0.28674751437053}, "num_env_steps_trained": 56100, "num_module_steps_trained": 11000, "num_non_trainable_parameters": 0, "learner_connector_sum_episodes_length_in": 5000.0, "num_module_steps_trained_lifetime": 33000, "learner_connector_sum_episodes_length_out": 5100.0, "num_trainable_parameters": 4148, "num_env_steps_trained_lifetime": 168300, "num_env_steps_trained_lifetime_throughput": 841353.1742054333, "num_module_steps_trained_throughput": 165623.55859855236, "num_module_steps_trained_lifetime_throughput": 165351.7818235383}, "default_policy": {"curr_entropy_coeff": 0.0018408992081, "gradients_default_optimizer_global_norm": 0.12005545943975449, "entropy": 0.6929500102996826, "policy_loss": -0.022676920518279076, "total_loss": 0.21907280385494232, "num_trainable_parameters": 4148, "num_module_steps_trained_lifetime": 33000, "vf_loss": 0.34866464138031006, "module_train_batch_size_mean": 1000.0, "vf_explained_var": -0.13103604316711426, "default_optimizer_learning_rate": 0.0027541439213, "num_module_steps_trained": 11000, "curr_kl_coeff": 0.14849629998207092, "vf_loss_unclipped": 25.704347610473633, "diff_num_grad_updates_vs_sampler_policy": 1.0, "mean_kl_loss": 0.010117774829268456, "weights_seq_no": 3.0, "num_module_steps_trained_lifetime_throughput": 165986.17254550438}}, "num_training_step_calls_per_iteration": 1, "evaluation": {"env_runners": {"env_to_module_connector": {"connector_pipeline_timer": 0.00011415792743195666, "timers": {"connectors": {"add_time_dim_to_batch_and_zero_pad": 5.510162999945623e-06, "batch_individual_items": 1.844470284411672e-05, "numpy_to_tensor": 3.006492266068366e-05, "add_states_from_episodes_to_batch": 3.4210227328048823e-06, "add_observations_from_episodes_to_batch": 6.1376360913862005e-06}}}, "num_episodes": 20, "episode_return_max": 17.5, "episode_return_mean": -0.5666666666666667, "rlmodule_inference_timer": 9.460211799987471e-05, "module_to_env_connector": {"timers": {"connectors": {"un_batch_to_individual_items": 1.5007443103594351e-05, "normalize_and_clip_actions": 2.154180487697951e-05, "tensor_to_numpy": 4.606762280349073e-05, "listify_data_for_vector_env": 3.0431025539150866e-05, "remove_single_ts_time_rank_from_batch": 1.434035984608787e-06, "get_actions": 0.0001580702645649559}}, "connector_pipeline_timer": 0.0003468367417396052}, "sample": 0.735195542900455, "episode_len_max": 50, "episode_len_mean": 50.0, "num_agent_steps_sampled": {"default_agent": 1000}, "agent_episode_returns_mean": {"default_agent": -0.5666666666666667}, "num_module_steps_sampled_lifetime": {"default_policy": 3000}, "env_step_timer": 4.22501457457378e-05, "env_reset_timer": 0.00020895006994699086, "episode_return_min": -16.5, "num_env_steps_sampled_lifetime": 16000, "env_to_module_sum_episodes_length_in": 27.168093332125434, "episode_duration_sec_mean": 0.035325011183336606, "num_module_steps_sampled": {"default_policy": 1000}, "num_episodes_lifetime": 60, "episode_len_min": 50, "num_env_steps_sampled": 1000, "num_agent_steps_sampled_lifetime": {"default_agent": 3000}, "module_episode_returns_mean": {"default_policy": -0.5666666666666667}, "weights_seq_no": 3.0, "env_to_module_sum_episodes_length_out": 27.168093332125434, "time_between_sampling": 4.345094719100031}, "num_healthy_workers": 1, "actor_manager_num_outstanding_async_reqs": 0, "num_remote_worker_restarts": 0}, "num_env_steps_sampled_lifetime": -232500.0, "fault_tolerance": {"num_healthy_workers": 0, "num_remote_worker_restarts": 0}, "env_runner_group": {"actor_manager_num_outstanding_async_reqs": 0}, "done": false, "training_iteration": 3, "trial_id": "f5bb1_00000", "date": "2025-08-11_16-11-34", "timestamp": 1754921494, "time_this_iter_s": 5.1537511348724365, "time_total_s": 15.228622913360596, "pid": 12703, "hostname": "DESKTOP-3SK5A41", "node_ip": "192.168.40.242", "config": {"exploration_config": {}, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 6, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "env": "Umbrella", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": false, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 0, "create_local_env_runner": true, "num_envs_per_env_runner": 1, "gym_env_vectorize_mode": "SYNC", "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "episodes_to_numpy": true, "max_requests_in_flight_per_env_runner": 1, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "merge_env_runner_states": "training_only", "broadcast_env_runner_states": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "complete_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "sampler_perf_stats_ema_coef": null, "_is_online": true, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": "auto", "num_aggregator_actors_per_learner": 0, "max_requests_in_flight_per_aggregator_actor": 3, "local_gpu_idx": 0, "max_requests_in_flight_per_learner": 3, "gamma": 1, "lr": 0.0027541439213, "grad_clip": 0.5, "grad_clip_by": "global_norm", "_train_batch_size_per_learner": 5000, "train_batch_size": 4000, "num_epochs": 2, "minibatch_size": 1000, "shuffle_batch_per_epoch": true, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "log_std_clip_param": 20.0, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "_disable_preprocessor_api": false, "_disable_action_flattening": false}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "_learner_class": null, "callbacks_on_algorithm_init": null, "callbacks_on_env_runners_recreated": null, "callbacks_on_offline_eval_runners_recreated": null, "callbacks_on_checkpoint_loaded": null, "callbacks_on_environment_created": null, "callbacks_on_episode_created": null, "callbacks_on_episode_start": null, "callbacks_on_episode_step": null, "callbacks_on_episode_end": null, "callbacks_on_evaluate_start": null, "callbacks_on_evaluate_end": null, "callbacks_on_evaluate_offline_start": null, "callbacks_on_evaluate_offline_end": null, "callbacks_on_sample_end": null, "callbacks_on_train_result": null, "explore": true, "enable_rl_module_and_learner": true, "enable_env_runner_and_connector_v2": true, "_prior_exploration_config": {"type": "StochasticSampling"}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x73ae51472ac0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "offline_data_class": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_read_batch_size": null, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "materialize_data": false, "materialize_mapped_data": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "ignore_final_observation": false, "prelearner_class": null, "prelearner_buffer_class": null, "prelearner_buffer_kwargs": {}, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_remaining_data": false, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": 1, "evaluation_duration": 20, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_auto_duration_min_env_steps_per_sample": 100, "evaluation_auto_duration_max_env_steps_per_sample": 2000, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 1, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "offline_evaluation_interval": null, "num_offline_eval_runners": 0, "offline_loss_for_module_fn": null, "offline_evaluation_duration": 1, "offline_evaluation_parallel_to_training": false, "offline_evaluation_timeout_s": 120.0, "num_cpus_per_offline_eval_runner": 1, "num_gpus_per_offline_eval_runner": 0, "custom_resources_per_offline_eval_runner": {}, "restart_failed_offline_eval_runners": true, "ignore_offline_eval_runner_failures": false, "max_num_offline_eval_runner_restarts": 1000, "offline_eval_runner_restore_timeout_s": 1800.0, "max_requests_in_flight_per_offline_eval_runner": 1, "validate_offline_eval_runners_after_construction": true, "offline_eval_runner_health_probe_timeout_s": 30.0, "offline_eval_rl_module_inference_only": false, "broadcast_offline_eval_runner_states": false, "offline_eval_batch_size_per_runner": 256, "dataset_num_iters_per_eval_runner": 1, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "log_gradients": true, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 42, "restart_failed_env_runners": true, "ignore_env_runner_failures": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30.0, "env_runner_restore_timeout_s": 1800.0, "_model_config": {}, "_rl_module_spec": "RLModuleSpec(module_class=None, observation_space=None, action_space=None, inference_only=False, learner_only=False, model_config=DefaultModelConfig(fcnet_hiddens=[53, 69], fcnet_activation='tanh', fcnet_kernel_initializer=None, fcnet_kernel_initializer_kwargs=None, fcnet_bias_initializer=None, fcnet_bias_initializer_kwargs=None, conv_filters=None, conv_activation='relu', conv_kernel_initializer=None, conv_kernel_initializer_kwargs=None, conv_bias_initializer=None, conv_bias_initializer_kwargs=None, head_fcnet_hiddens=[], head_fcnet_activation='relu', head_fcnet_kernel_initializer=None, head_fcnet_kernel_initializer_kwargs=None, head_fcnet_bias_initializer=None, head_fcnet_bias_initializer_kwargs=None, free_log_std=False, log_std_clip_param=20.0, vf_share_layers=True, use_lstm=False, max_seq_len=20, lstm_cell_size=256, lstm_use_prev_action=False, lstm_use_prev_reward=False, lstm_kernel_initializer=None, lstm_kernel_initializer_kwargs=None, lstm_bias_initializer=None, lstm_bias_initializer_kwargs=None), catalog_class=None, load_state_path=None, model_config_dict=None)", "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "_validate_config": true, "_use_msgpack_checkpoints": false, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "env_task_fn": -1, "enable_connectors": -1, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.5939852077022, "kl_target": 0.0137962462363, "vf_loss_coeff": 0.69270825127, "entropy_coeff": 0.0018408992081, "clip_param": 0.1749080237695, "vf_clip_param": 0.3721230154351, "entropy_coeff_schedule": null, "lr_schedule": null, "sgd_minibatch_size": -1, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.95565474084, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.callbacks.callbacks.RLlibCallback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 15.228622913360596, "iterations_since_restore": 3, "perf": {"cpu_util_percent": 13.6, "ram_util_percent": 76.22857142857143}}
{"timers": {"training_iteration": 4.279668681001511, "restore_env_runners": 1.4207841009146364e-05, "training_step": 4.279371240138001, "env_runner_sampling_timer": 3.8432552847705304, "learner_update_timer": 0.4321007361883397, "synch_weights": 0.0016242294427647626, "restore_eval_env_runners": 1.467404995362358e-05, "evaluation_iteration": 0.7475375093503865, "synch_eval_env_connectors": 0.0005880379200076505, "synch_env_connectors": 8.377139957133297e-06}, "env_runners": {"episode_len_max": 50, "env_to_module_connector": {"timers": {"connectors": {"add_time_dim_to_batch_and_zero_pad": 6.131448539113973e-06, "add_states_from_episodes_to_batch": 3.430946591862109e-06, "add_observations_from_episodes_to_batch": 6.275344401383068e-06, "batch_individual_items": 1.8359403469499345e-05, "numpy_to_tensor": 3.1550433839112924e-05}}, "connector_pipeline_timer": 0.00011888527597278295}, "env_reset_timer": 0.00010705591559017765, "module_to_env_connector": {"timers": {"connectors": {"tensor_to_numpy": 5.001071992913646e-05, "remove_single_ts_time_rank_from_batch": 1.4470984427521728e-06, "listify_data_for_vector_env": 3.091055808711793e-05, "un_batch_to_individual_items": 1.4826878324028068e-05, "get_actions": 0.00016608361098439773, "normalize_and_clip_actions": 2.2842222900653727e-05}}, "connector_pipeline_timer": 0.00036335285296166685}, "env_to_module_sum_episodes_length_out": 27.16809333212661, "num_agent_steps_sampled_lifetime": {"default_agent": -475000.0}, "agent_episode_returns_mean": {"default_agent": 3.7}, "env_to_module_sum_episodes_length_in": 27.16809333212661, "episode_return_min": -5.5, "num_env_steps_sampled_lifetime": -475000.0, "num_episodes_lifetime": -9500.0, "episode_len_mean": 50.0, "time_between_sampling": 0.012047860180929824, "num_agent_steps_sampled": {"default_agent": 5000.0}, "module_episode_returns_mean": {"default_policy": 3.7}, "episode_len_min": 50, "num_env_steps_sampled": 5000.0, "num_episodes": 100.0, "num_module_steps_sampled_lifetime": {"default_policy": -475000.0}, "episode_return_max": 14.5, "num_module_steps_sampled": {"default_policy": 5000.0}, "episode_return_mean": 3.7, "episode_duration_sec_mean": 0.03662696655999298, "rlmodule_inference_timer": 9.936404419087129e-05, "weights_seq_no": 3.0, "env_step_timer": 4.378667255131232e-05, "sample": 0.03823183253170246, "num_env_steps_sampled_lifetime_throughput": 1276.6862142945524}, "learners": {"__all_modules__": {"learner_connector": {"timers": {"connectors": {"add_columns_from_episodes_to_train_batch": 0.06665035860148766, "add_observations_from_episodes_to_batch": 0.0007923786029612254, "add_time_dim_to_batch_and_zero_pad": 2.2377279034345403e-05, "batch_individual_items": 0.19504539494714462, "add_one_ts_to_episodes_and_truncate": 0.00826903805567859, "general_advantage_estimation": 0.013981022787404169, "add_states_from_episodes_to_batch": 6.680219472895487e-06, "numpy_to_tensor": 0.000176822720853026}}, "connector_pipeline_timer": 0.28532775928682397}, "num_env_steps_trained": 56100, "num_module_steps_trained": 11000, "num_non_trainable_parameters": 0, "learner_connector_sum_episodes_length_in": 5000.0, "num_module_steps_trained_lifetime": 44000, "learner_connector_sum_episodes_length_out": 5100.0, "num_trainable_parameters": 4148, "num_env_steps_trained_lifetime": 224400, "num_env_steps_trained_lifetime_throughput": 843816.2446302637, "num_module_steps_trained_throughput": 166085.99815880717, "num_module_steps_trained_lifetime_throughput": 165819.67846416583}, "default_policy": {"curr_entropy_coeff": 0.0018408992081, "gradients_default_optimizer_global_norm": 0.11113633960485458, "entropy": 0.6849989295005798, "policy_loss": 0.025441255420446396, "total_loss": 0.2667500078678131, "num_trainable_parameters": 4148, "num_module_steps_trained_lifetime": 44000, "vf_loss": 0.3485884666442871, "module_train_batch_size_mean": 1000.0, "vf_explained_var": -0.14836335182189941, "default_optimizer_learning_rate": 0.0027541439213, "num_module_steps_trained": 11000, "curr_kl_coeff": 0.14849629998207092, "vf_loss_unclipped": 27.778959274291992, "diff_num_grad_updates_vs_sampler_policy": 1.0, "mean_kl_loss": 0.007405308075249195, "weights_seq_no": 4.0, "num_module_steps_trained_lifetime_throughput": 166427.3779632361}}, "num_training_step_calls_per_iteration": 1, "evaluation": {"env_runners": {"env_to_module_connector": {"connector_pipeline_timer": 0.00011235998647997122, "timers": {"connectors": {"add_time_dim_to_batch_and_zero_pad": 5.4499055784416775e-06, "batch_individual_items": 1.8110398411033298e-05, "numpy_to_tensor": 2.9283791114246267e-05, "add_states_from_episodes_to_batch": 3.3986021818714793e-06, "add_observations_from_episodes_to_batch": 6.171705817962335e-06}}}, "num_episodes": 20, "episode_return_max": 17.5, "episode_return_mean": -0.65, "rlmodule_inference_timer": 9.335447480791877e-05, "module_to_env_connector": {"timers": {"connectors": {"un_batch_to_individual_items": 1.4926039903841921e-05, "normalize_and_clip_actions": 2.1614261909757086e-05, "tensor_to_numpy": 4.602892248291811e-05, "listify_data_for_vector_env": 3.0238041076102427e-05, "remove_single_ts_time_rank_from_batch": 1.3774135585443739e-06, "get_actions": 0.00015667641273153194}}, "connector_pipeline_timer": 0.0003432342683907221}, "sample": 0.7351373347714494, "episode_len_max": 50, "episode_len_mean": 50.0, "num_agent_steps_sampled": {"default_agent": 1000}, "agent_episode_returns_mean": {"default_agent": -0.65}, "num_module_steps_sampled_lifetime": {"default_policy": 4000}, "env_step_timer": 4.2037379265567395e-05, "env_reset_timer": 0.0002081695692479677, "episode_return_min": -16.5, "num_env_steps_sampled_lifetime": 21000, "env_to_module_sum_episodes_length_in": 27.168093332126602, "episode_duration_sec_mean": 0.035257233750002115, "num_module_steps_sampled": {"default_policy": 1000}, "num_episodes_lifetime": 80, "episode_len_min": 50, "num_env_steps_sampled": 1000, "num_agent_steps_sampled_lifetime": {"default_agent": 4000}, "module_episode_returns_mean": {"default_policy": -0.65}, "weights_seq_no": 4.0, "env_to_module_sum_episodes_length_out": 27.168093332126602, "time_between_sampling": 4.343570882679031}, "num_healthy_workers": 1, "actor_manager_num_outstanding_async_reqs": 0, "num_remote_worker_restarts": 0}, "num_env_steps_sampled_lifetime": -475000.0, "fault_tolerance": {"num_healthy_workers": 0, "num_remote_worker_restarts": 0}, "env_runner_group": {"actor_manager_num_outstanding_async_reqs": 0}, "done": false, "training_iteration": 4, "trial_id": "f5bb1_00000", "date": "2025-08-11_16-11-38", "timestamp": 1754921498, "time_this_iter_s": 4.881080865859985, "time_total_s": 20.10970377922058, "pid": 12703, "hostname": "DESKTOP-3SK5A41", "node_ip": "192.168.40.242", "config": {"exploration_config": {}, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 6, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "env": "Umbrella", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": false, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 0, "create_local_env_runner": true, "num_envs_per_env_runner": 1, "gym_env_vectorize_mode": "SYNC", "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "episodes_to_numpy": true, "max_requests_in_flight_per_env_runner": 1, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "merge_env_runner_states": "training_only", "broadcast_env_runner_states": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "complete_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "sampler_perf_stats_ema_coef": null, "_is_online": true, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": "auto", "num_aggregator_actors_per_learner": 0, "max_requests_in_flight_per_aggregator_actor": 3, "local_gpu_idx": 0, "max_requests_in_flight_per_learner": 3, "gamma": 1, "lr": 0.0027541439213, "grad_clip": 0.5, "grad_clip_by": "global_norm", "_train_batch_size_per_learner": 5000, "train_batch_size": 4000, "num_epochs": 2, "minibatch_size": 1000, "shuffle_batch_per_epoch": true, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "log_std_clip_param": 20.0, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "_disable_preprocessor_api": false, "_disable_action_flattening": false}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "_learner_class": null, "callbacks_on_algorithm_init": null, "callbacks_on_env_runners_recreated": null, "callbacks_on_offline_eval_runners_recreated": null, "callbacks_on_checkpoint_loaded": null, "callbacks_on_environment_created": null, "callbacks_on_episode_created": null, "callbacks_on_episode_start": null, "callbacks_on_episode_step": null, "callbacks_on_episode_end": null, "callbacks_on_evaluate_start": null, "callbacks_on_evaluate_end": null, "callbacks_on_evaluate_offline_start": null, "callbacks_on_evaluate_offline_end": null, "callbacks_on_sample_end": null, "callbacks_on_train_result": null, "explore": true, "enable_rl_module_and_learner": true, "enable_env_runner_and_connector_v2": true, "_prior_exploration_config": {"type": "StochasticSampling"}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x73ae51472ac0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "offline_data_class": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_read_batch_size": null, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "materialize_data": false, "materialize_mapped_data": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "ignore_final_observation": false, "prelearner_class": null, "prelearner_buffer_class": null, "prelearner_buffer_kwargs": {}, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_remaining_data": false, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": 1, "evaluation_duration": 20, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_auto_duration_min_env_steps_per_sample": 100, "evaluation_auto_duration_max_env_steps_per_sample": 2000, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 1, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "offline_evaluation_interval": null, "num_offline_eval_runners": 0, "offline_loss_for_module_fn": null, "offline_evaluation_duration": 1, "offline_evaluation_parallel_to_training": false, "offline_evaluation_timeout_s": 120.0, "num_cpus_per_offline_eval_runner": 1, "num_gpus_per_offline_eval_runner": 0, "custom_resources_per_offline_eval_runner": {}, "restart_failed_offline_eval_runners": true, "ignore_offline_eval_runner_failures": false, "max_num_offline_eval_runner_restarts": 1000, "offline_eval_runner_restore_timeout_s": 1800.0, "max_requests_in_flight_per_offline_eval_runner": 1, "validate_offline_eval_runners_after_construction": true, "offline_eval_runner_health_probe_timeout_s": 30.0, "offline_eval_rl_module_inference_only": false, "broadcast_offline_eval_runner_states": false, "offline_eval_batch_size_per_runner": 256, "dataset_num_iters_per_eval_runner": 1, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "log_gradients": true, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 42, "restart_failed_env_runners": true, "ignore_env_runner_failures": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30.0, "env_runner_restore_timeout_s": 1800.0, "_model_config": {}, "_rl_module_spec": "RLModuleSpec(module_class=None, observation_space=None, action_space=None, inference_only=False, learner_only=False, model_config=DefaultModelConfig(fcnet_hiddens=[53, 69], fcnet_activation='tanh', fcnet_kernel_initializer=None, fcnet_kernel_initializer_kwargs=None, fcnet_bias_initializer=None, fcnet_bias_initializer_kwargs=None, conv_filters=None, conv_activation='relu', conv_kernel_initializer=None, conv_kernel_initializer_kwargs=None, conv_bias_initializer=None, conv_bias_initializer_kwargs=None, head_fcnet_hiddens=[], head_fcnet_activation='relu', head_fcnet_kernel_initializer=None, head_fcnet_kernel_initializer_kwargs=None, head_fcnet_bias_initializer=None, head_fcnet_bias_initializer_kwargs=None, free_log_std=False, log_std_clip_param=20.0, vf_share_layers=True, use_lstm=False, max_seq_len=20, lstm_cell_size=256, lstm_use_prev_action=False, lstm_use_prev_reward=False, lstm_kernel_initializer=None, lstm_kernel_initializer_kwargs=None, lstm_bias_initializer=None, lstm_bias_initializer_kwargs=None), catalog_class=None, load_state_path=None, model_config_dict=None)", "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "_validate_config": true, "_use_msgpack_checkpoints": false, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "env_task_fn": -1, "enable_connectors": -1, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.5939852077022, "kl_target": 0.0137962462363, "vf_loss_coeff": 0.69270825127, "entropy_coeff": 0.0018408992081, "clip_param": 0.1749080237695, "vf_clip_param": 0.3721230154351, "entropy_coeff_schedule": null, "lr_schedule": null, "sgd_minibatch_size": -1, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.95565474084, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.callbacks.callbacks.RLlibCallback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 20.10970377922058, "iterations_since_restore": 4, "perf": {"cpu_util_percent": 12.142857142857142, "ram_util_percent": 75.8}}
{"timers": {"training_iteration": 4.279863618111496, "restore_env_runners": 1.4170762599358234e-05, "training_step": 4.279565630656621, "env_runner_sampling_timer": 3.844029262812825, "learner_update_timer": 0.43152507485645664, "synch_weights": 0.001622117148336683, "restore_eval_env_runners": 1.4671309453496404e-05, "evaluation_iteration": 0.7474494955668827, "synch_eval_env_connectors": 0.0005860185408077166, "synch_env_connectors": 8.366368557491344e-06}, "env_runners": {"episode_len_max": 50, "env_to_module_connector": {"timers": {"connectors": {"add_time_dim_to_batch_and_zero_pad": 6.164828126240759e-06, "add_states_from_episodes_to_batch": 3.4345698803007104e-06, "add_observations_from_episodes_to_batch": 6.290728926584833e-06, "batch_individual_items": 1.832881214731352e-05, "numpy_to_tensor": 3.15977816958764e-05}}, "connector_pipeline_timer": 0.0001187959324613869}, "env_reset_timer": 0.00010165848495926504, "module_to_env_connector": {"timers": {"connectors": {"tensor_to_numpy": 4.977285670220779e-05, "remove_single_ts_time_rank_from_batch": 1.441885233026894e-06, "listify_data_for_vector_env": 3.073948244112122e-05, "un_batch_to_individual_items": 1.480169261829019e-05, "get_actions": 0.00016637641934490272, "normalize_and_clip_actions": 2.2747654248873923e-05}}, "connector_pipeline_timer": 0.00036314369696940804}, "env_to_module_sum_episodes_length_out": 27.16809333212661, "num_agent_steps_sampled_lifetime": {"default_agent": -717500.0}, "agent_episode_returns_mean": {"default_agent": 7.700000000000004}, "env_to_module_sum_episodes_length_in": 27.16809333212661, "episode_return_min": -5.5, "num_env_steps_sampled_lifetime": -717500.0, "num_episodes_lifetime": -14350.0, "episode_len_mean": 50.0, "time_between_sampling": 0.011707553909254462, "num_agent_steps_sampled": {"default_agent": 5000.0}, "module_episode_returns_mean": {"default_policy": 7.700000000000004}, "episode_len_min": 50, "num_env_steps_sampled": 5000.0, "num_episodes": 100.0, "num_module_steps_sampled_lifetime": {"default_policy": -717500.0}, "episode_return_max": 14.5, "num_module_steps_sampled": {"default_policy": 5000.0}, "episode_return_mean": 7.700000000000004, "episode_duration_sec_mean": 0.036660979840006575, "rlmodule_inference_timer": 0.00010034413934099262, "weights_seq_no": 4.0, "env_step_timer": 4.368112313238316e-05, "sample": 0.037951944639728785, "num_env_steps_sampled_lifetime_throughput": 1274.513998409927}, "learners": {"__all_modules__": {"learner_connector": {"timers": {"connectors": {"add_columns_from_episodes_to_train_batch": 0.06676089702547239, "add_observations_from_episodes_to_batch": 0.0007911258169314825, "add_time_dim_to_batch_and_zero_pad": 2.250750624401768e-05, "batch_individual_items": 0.1952239470076732, "add_one_ts_to_episodes_and_truncate": 0.00826627467512112, "general_advantage_estimation": 0.013939411569529134, "add_states_from_episodes_to_batch": 6.701417277489606e-06, "numpy_to_tensor": 0.00017699349364448875}}, "connector_pipeline_timer": 0.285571850723955}, "num_env_steps_trained": 56100, "num_module_steps_trained": 11000, "num_non_trainable_parameters": 0, "learner_connector_sum_episodes_length_in": 5000.0, "num_module_steps_trained_lifetime": 55000, "learner_connector_sum_episodes_length_out": 5100.0, "num_trainable_parameters": 4148, "num_env_steps_trained_lifetime": 280500, "num_env_steps_trained_lifetime_throughput": 845332.3141853728, "num_module_steps_trained_throughput": 166360.72814912614, "num_module_steps_trained_lifetime_throughput": 166101.0497226475}, "default_policy": {"curr_entropy_coeff": 0.0018408992081, "gradients_default_optimizer_global_norm": 0.09539321064949036, "entropy": 0.6806589961051941, "policy_loss": -0.036685604602098465, "total_loss": 0.20945827662944794, "num_trainable_parameters": 4148, "num_module_steps_trained_lifetime": 55000, "vf_loss": 0.3569391369819641, "module_train_batch_size_mean": 1000.0, "vf_explained_var": -0.19624853134155273, "default_optimizer_learning_rate": 0.0027541439213, "num_module_steps_trained": 11000, "curr_kl_coeff": 0.07424814999103546, "vf_loss_unclipped": 25.61882781982422, "diff_num_grad_updates_vs_sampler_policy": 1.0, "mean_kl_loss": 0.0009574597352184355, "weights_seq_no": 5.0, "num_module_steps_trained_lifetime_throughput": 166680.76062757717}}, "num_training_step_calls_per_iteration": 1, "evaluation": {"env_runners": {"env_to_module_connector": {"connector_pipeline_timer": 0.00011497167244949307, "timers": {"connectors": {"add_time_dim_to_batch_and_zero_pad": 5.5767093839853985e-06, "batch_individual_items": 1.8806039532352136e-05, "numpy_to_tensor": 3.0342009758666126e-05, "add_states_from_episodes_to_batch": 3.4142588764119193e-06, "add_observations_from_episodes_to_batch": 6.4324683930241225e-06}}}, "num_episodes": 20, "episode_return_max": 17.5, "episode_return_mean": -0.3, "rlmodule_inference_timer": 9.513445350252147e-05, "module_to_env_connector": {"timers": {"connectors": {"un_batch_to_individual_items": 1.5624177192420308e-05, "normalize_and_clip_actions": 2.212624108686738e-05, "tensor_to_numpy": 4.6495720378798566e-05, "listify_data_for_vector_env": 3.060516408429367e-05, "remove_single_ts_time_rank_from_batch": 1.4153718933583572e-06, "get_actions": 0.00016062399910966505}}, "connector_pipeline_timer": 0.0003524410015549042}, "sample": 0.7351471484937354, "episode_len_max": 50, "episode_len_mean": 50.0, "num_agent_steps_sampled": {"default_agent": 1000}, "agent_episode_returns_mean": {"default_agent": -0.3}, "num_module_steps_sampled_lifetime": {"default_policy": 5000}, "env_step_timer": 4.36327231726947e-05, "env_reset_timer": 0.00020741487355543462, "episode_return_min": -16.5, "num_env_steps_sampled_lifetime": 26000, "env_to_module_sum_episodes_length_in": 27.168093332126602, "episode_duration_sec_mean": 0.035282213060000914, "num_module_steps_sampled": {"default_policy": 1000}, "num_episodes_lifetime": 100, "episode_len_min": 50, "num_env_steps_sampled": 1000, "num_agent_steps_sampled_lifetime": {"default_agent": 5000}, "module_episode_returns_mean": {"default_policy": -0.3}, "weights_seq_no": 5.0, "env_to_module_sum_episodes_length_out": 27.168093332126602, "time_between_sampling": 4.343709422792239}, "num_healthy_workers": 1, "actor_manager_num_outstanding_async_reqs": 0, "num_remote_worker_restarts": 0}, "num_env_steps_sampled_lifetime": -717500.0, "fault_tolerance": {"num_healthy_workers": 0, "num_remote_worker_restarts": 0}, "env_runner_group": {"actor_manager_num_outstanding_async_reqs": 0}, "done": false, "training_iteration": 5, "trial_id": "f5bb1_00000", "date": "2025-08-11_16-11-44", "timestamp": 1754921504, "time_this_iter_s": 5.049939155578613, "time_total_s": 25.159642934799194, "pid": 12703, "hostname": "DESKTOP-3SK5A41", "node_ip": "192.168.40.242", "config": {"exploration_config": {}, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 6, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "env": "Umbrella", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": false, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 0, "create_local_env_runner": true, "num_envs_per_env_runner": 1, "gym_env_vectorize_mode": "SYNC", "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "episodes_to_numpy": true, "max_requests_in_flight_per_env_runner": 1, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "merge_env_runner_states": "training_only", "broadcast_env_runner_states": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "complete_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "sampler_perf_stats_ema_coef": null, "_is_online": true, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": "auto", "num_aggregator_actors_per_learner": 0, "max_requests_in_flight_per_aggregator_actor": 3, "local_gpu_idx": 0, "max_requests_in_flight_per_learner": 3, "gamma": 1, "lr": 0.0027541439213, "grad_clip": 0.5, "grad_clip_by": "global_norm", "_train_batch_size_per_learner": 5000, "train_batch_size": 4000, "num_epochs": 2, "minibatch_size": 1000, "shuffle_batch_per_epoch": true, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "log_std_clip_param": 20.0, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "_disable_preprocessor_api": false, "_disable_action_flattening": false}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "_learner_class": null, "callbacks_on_algorithm_init": null, "callbacks_on_env_runners_recreated": null, "callbacks_on_offline_eval_runners_recreated": null, "callbacks_on_checkpoint_loaded": null, "callbacks_on_environment_created": null, "callbacks_on_episode_created": null, "callbacks_on_episode_start": null, "callbacks_on_episode_step": null, "callbacks_on_episode_end": null, "callbacks_on_evaluate_start": null, "callbacks_on_evaluate_end": null, "callbacks_on_evaluate_offline_start": null, "callbacks_on_evaluate_offline_end": null, "callbacks_on_sample_end": null, "callbacks_on_train_result": null, "explore": true, "enable_rl_module_and_learner": true, "enable_env_runner_and_connector_v2": true, "_prior_exploration_config": {"type": "StochasticSampling"}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x73ae51472ac0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "offline_data_class": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_read_batch_size": null, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "materialize_data": false, "materialize_mapped_data": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "ignore_final_observation": false, "prelearner_class": null, "prelearner_buffer_class": null, "prelearner_buffer_kwargs": {}, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_remaining_data": false, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": 1, "evaluation_duration": 20, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_auto_duration_min_env_steps_per_sample": 100, "evaluation_auto_duration_max_env_steps_per_sample": 2000, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 1, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "offline_evaluation_interval": null, "num_offline_eval_runners": 0, "offline_loss_for_module_fn": null, "offline_evaluation_duration": 1, "offline_evaluation_parallel_to_training": false, "offline_evaluation_timeout_s": 120.0, "num_cpus_per_offline_eval_runner": 1, "num_gpus_per_offline_eval_runner": 0, "custom_resources_per_offline_eval_runner": {}, "restart_failed_offline_eval_runners": true, "ignore_offline_eval_runner_failures": false, "max_num_offline_eval_runner_restarts": 1000, "offline_eval_runner_restore_timeout_s": 1800.0, "max_requests_in_flight_per_offline_eval_runner": 1, "validate_offline_eval_runners_after_construction": true, "offline_eval_runner_health_probe_timeout_s": 30.0, "offline_eval_rl_module_inference_only": false, "broadcast_offline_eval_runner_states": false, "offline_eval_batch_size_per_runner": 256, "dataset_num_iters_per_eval_runner": 1, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "log_gradients": true, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 42, "restart_failed_env_runners": true, "ignore_env_runner_failures": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30.0, "env_runner_restore_timeout_s": 1800.0, "_model_config": {}, "_rl_module_spec": "RLModuleSpec(module_class=None, observation_space=None, action_space=None, inference_only=False, learner_only=False, model_config=DefaultModelConfig(fcnet_hiddens=[53, 69], fcnet_activation='tanh', fcnet_kernel_initializer=None, fcnet_kernel_initializer_kwargs=None, fcnet_bias_initializer=None, fcnet_bias_initializer_kwargs=None, conv_filters=None, conv_activation='relu', conv_kernel_initializer=None, conv_kernel_initializer_kwargs=None, conv_bias_initializer=None, conv_bias_initializer_kwargs=None, head_fcnet_hiddens=[], head_fcnet_activation='relu', head_fcnet_kernel_initializer=None, head_fcnet_kernel_initializer_kwargs=None, head_fcnet_bias_initializer=None, head_fcnet_bias_initializer_kwargs=None, free_log_std=False, log_std_clip_param=20.0, vf_share_layers=True, use_lstm=False, max_seq_len=20, lstm_cell_size=256, lstm_use_prev_action=False, lstm_use_prev_reward=False, lstm_kernel_initializer=None, lstm_kernel_initializer_kwargs=None, lstm_bias_initializer=None, lstm_bias_initializer_kwargs=None), catalog_class=None, load_state_path=None, model_config_dict=None)", "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "_validate_config": true, "_use_msgpack_checkpoints": false, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "env_task_fn": -1, "enable_connectors": -1, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.5939852077022, "kl_target": 0.0137962462363, "vf_loss_coeff": 0.69270825127, "entropy_coeff": 0.0018408992081, "clip_param": 0.1749080237695, "vf_clip_param": 0.3721230154351, "entropy_coeff_schedule": null, "lr_schedule": null, "sgd_minibatch_size": -1, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.95565474084, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.callbacks.callbacks.RLlibCallback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 25.159642934799194, "iterations_since_restore": 5, "perf": {"cpu_util_percent": 11.925, "ram_util_percent": 75.8}}
{"timers": {"training_iteration": 4.279022862300382, "restore_env_runners": 1.4133054974011573e-05, "training_step": 4.278724111720056, "env_runner_sampling_timer": 3.8454012365346966, "learner_update_timer": 0.42930624012789237, "synch_weights": 0.0016270739768539618, "restore_eval_env_runners": 1.4742596359093164e-05, "evaluation_iteration": 0.7474334076812134, "synch_eval_env_connectors": 0.0005841633553991913, "synch_env_connectors": 8.357704872295507e-06}, "env_runners": {"episode_len_max": 50, "env_to_module_connector": {"timers": {"connectors": {"add_time_dim_to_batch_and_zero_pad": 6.1269105577248025e-06, "add_states_from_episodes_to_batch": 3.3830051361795198e-06, "add_observations_from_episodes_to_batch": 6.270202121107682e-06, "batch_individual_items": 1.837654376569333e-05, "numpy_to_tensor": 3.21323367813611e-05}}, "connector_pipeline_timer": 0.00011943021251327785}, "env_reset_timer": 9.870479041570632e-05, "module_to_env_connector": {"timers": {"connectors": {"tensor_to_numpy": 5.108400680167508e-05, "remove_single_ts_time_rank_from_batch": 1.4253070900698144e-06, "listify_data_for_vector_env": 3.129487966519834e-05, "un_batch_to_individual_items": 1.5125057995452453e-05, "get_actions": 0.00016781621513287762, "normalize_and_clip_actions": 2.2917061963880872e-05}}, "connector_pipeline_timer": 0.00036765063337789914}, "env_to_module_sum_episodes_length_out": 27.16809333212661, "num_agent_steps_sampled_lifetime": {"default_agent": -960000.0}, "agent_episode_returns_mean": {"default_agent": 4.7}, "env_to_module_sum_episodes_length_in": 27.16809333212661, "episode_return_min": -5.5, "num_env_steps_sampled_lifetime": -960000.0, "num_episodes_lifetime": -19200.0, "episode_len_mean": 50.0, "time_between_sampling": 0.012624761939855242, "num_agent_steps_sampled": {"default_agent": 5000.0}, "module_episode_returns_mean": {"default_policy": 4.7}, "episode_len_min": 50, "num_env_steps_sampled": 5000.0, "num_episodes": 100.0, "num_module_steps_sampled_lifetime": {"default_policy": -960000.0}, "episode_return_max": 14.5, "num_module_steps_sampled": {"default_policy": 5000.0}, "episode_return_mean": 4.7, "episode_duration_sec_mean": 0.037210728330001074, "rlmodule_inference_timer": 0.00010042000181348505, "weights_seq_no": 5.0, "env_step_timer": 4.725991783148764e-05, "sample": 0.037829326561303264, "num_env_steps_sampled_lifetime_throughput": 1269.8462975188395}, "learners": {"__all_modules__": {"learner_connector": {"timers": {"connectors": {"add_columns_from_episodes_to_train_batch": 0.06675590806521693, "add_observations_from_episodes_to_batch": 0.000790536558762326, "add_time_dim_to_batch_and_zero_pad": 2.2603431181562867e-05, "batch_individual_items": 0.19386308354759624, "add_one_ts_to_episodes_and_truncate": 0.008267154928370553, "general_advantage_estimation": 0.013905976453833827, "add_states_from_episodes_to_batch": 6.724403104487482e-06, "numpy_to_tensor": 0.00017719655870772368}}, "connector_pipeline_timer": 0.2841731052367158}, "num_env_steps_trained": 56100, "num_module_steps_trained": 11000, "num_non_trainable_parameters": 0, "learner_connector_sum_episodes_length_in": 5000.0, "num_module_steps_trained_lifetime": 66000, "learner_connector_sum_episodes_length_out": 5100.0, "num_trainable_parameters": 4148, "num_env_steps_trained_lifetime": 336600, "num_env_steps_trained_lifetime_throughput": 846445.3320137633, "num_module_steps_trained_throughput": 166557.686541064, "num_module_steps_trained_lifetime_throughput": 166305.16345863798}, "default_policy": {"curr_entropy_coeff": 0.0018408992081, "gradients_default_optimizer_global_norm": 0.05679432675242424, "entropy": 0.6838979125022888, "policy_loss": 0.014985254034399986, "total_loss": 0.2541099190711975, "num_trainable_parameters": 4148, "num_module_steps_trained_lifetime": 66000, "vf_loss": 0.34604328870773315, "module_train_batch_size_mean": 1000.0, "vf_explained_var": -0.18980741500854492, "default_optimizer_learning_rate": 0.0027541439213, "num_module_steps_trained": 11000, "curr_kl_coeff": 0.07424814999103546, "vf_loss_unclipped": 28.745071411132812, "diff_num_grad_updates_vs_sampler_policy": 1.0, "mean_kl_loss": 0.00911249965429306, "weights_seq_no": 6.0, "num_module_steps_trained_lifetime_throughput": 166860.14288126235}}, "num_training_step_calls_per_iteration": 1, "evaluation": {"env_runners": {"env_to_module_connector": {"connector_pipeline_timer": 0.00011430275158776925, "timers": {"connectors": {"add_time_dim_to_batch_and_zero_pad": 5.69338138535852e-06, "batch_individual_items": 1.8311174942082987e-05, "numpy_to_tensor": 2.9615568388628268e-05, "add_states_from_episodes_to_batch": 3.3666228358644514e-06, "add_observations_from_episodes_to_batch": 6.201616946978971e-06}}}, "num_episodes": 20, "episode_return_max": 17.5, "episode_return_mean": -0.1, "rlmodule_inference_timer": 9.552595510490001e-05, "module_to_env_connector": {"timers": {"connectors": {"un_batch_to_individual_items": 1.585176812990374e-05, "normalize_and_clip_actions": 2.209887305174147e-05, "tensor_to_numpy": 4.747899897582036e-05, "listify_data_for_vector_env": 2.9861463428294418e-05, "remove_single_ts_time_rank_from_batch": 1.4178311705797682e-06, "get_actions": 0.00015941929786760347}}, "connector_pipeline_timer": 0.0003502051390285396}, "sample": 0.7350885750887979, "episode_len_max": 50, "episode_len_mean": 50.0, "num_agent_steps_sampled": {"default_agent": 1000}, "agent_episode_returns_mean": {"default_agent": -0.1}, "num_module_steps_sampled_lifetime": {"default_policy": 6000}, "env_step_timer": 4.258402358468559e-05, "env_reset_timer": 0.00020667072481993294, "episode_return_min": -16.5, "num_env_steps_sampled_lifetime": 31000, "env_to_module_sum_episodes_length_in": 27.168093332126602, "episode_duration_sec_mean": 0.03523690292000538, "num_module_steps_sampled": {"default_policy": 1000}, "num_episodes_lifetime": 120, "episode_len_min": 50, "num_env_steps_sampled": 1000, "num_agent_steps_sampled_lifetime": {"default_agent": 6000}, "module_episode_returns_mean": {"default_policy": -0.1}, "weights_seq_no": 6.0, "env_to_module_sum_episodes_length_out": 27.168093332126602, "time_between_sampling": 4.342776026934318}, "num_healthy_workers": 1, "actor_manager_num_outstanding_async_reqs": 0, "num_remote_worker_restarts": 0}, "num_env_steps_sampled_lifetime": -960000.0, "fault_tolerance": {"num_healthy_workers": 0, "num_remote_worker_restarts": 0}, "env_runner_group": {"actor_manager_num_outstanding_async_reqs": 0}, "done": false, "training_iteration": 6, "trial_id": "f5bb1_00000", "date": "2025-08-11_16-11-49", "timestamp": 1754921509, "time_this_iter_s": 4.940025568008423, "time_total_s": 30.099668502807617, "pid": 12703, "hostname": "DESKTOP-3SK5A41", "node_ip": "192.168.40.242", "config": {"exploration_config": {}, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 6, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "env": "Umbrella", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": false, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 0, "create_local_env_runner": true, "num_envs_per_env_runner": 1, "gym_env_vectorize_mode": "SYNC", "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "episodes_to_numpy": true, "max_requests_in_flight_per_env_runner": 1, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "merge_env_runner_states": "training_only", "broadcast_env_runner_states": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "complete_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "sampler_perf_stats_ema_coef": null, "_is_online": true, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": "auto", "num_aggregator_actors_per_learner": 0, "max_requests_in_flight_per_aggregator_actor": 3, "local_gpu_idx": 0, "max_requests_in_flight_per_learner": 3, "gamma": 1, "lr": 0.0027541439213, "grad_clip": 0.5, "grad_clip_by": "global_norm", "_train_batch_size_per_learner": 5000, "train_batch_size": 4000, "num_epochs": 2, "minibatch_size": 1000, "shuffle_batch_per_epoch": true, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "log_std_clip_param": 20.0, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "_disable_preprocessor_api": false, "_disable_action_flattening": false}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "_learner_class": null, "callbacks_on_algorithm_init": null, "callbacks_on_env_runners_recreated": null, "callbacks_on_offline_eval_runners_recreated": null, "callbacks_on_checkpoint_loaded": null, "callbacks_on_environment_created": null, "callbacks_on_episode_created": null, "callbacks_on_episode_start": null, "callbacks_on_episode_step": null, "callbacks_on_episode_end": null, "callbacks_on_evaluate_start": null, "callbacks_on_evaluate_end": null, "callbacks_on_evaluate_offline_start": null, "callbacks_on_evaluate_offline_end": null, "callbacks_on_sample_end": null, "callbacks_on_train_result": null, "explore": true, "enable_rl_module_and_learner": true, "enable_env_runner_and_connector_v2": true, "_prior_exploration_config": {"type": "StochasticSampling"}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x73ae51472ac0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "offline_data_class": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_read_batch_size": null, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "materialize_data": false, "materialize_mapped_data": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "ignore_final_observation": false, "prelearner_class": null, "prelearner_buffer_class": null, "prelearner_buffer_kwargs": {}, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_remaining_data": false, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": 1, "evaluation_duration": 20, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_auto_duration_min_env_steps_per_sample": 100, "evaluation_auto_duration_max_env_steps_per_sample": 2000, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 1, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "offline_evaluation_interval": null, "num_offline_eval_runners": 0, "offline_loss_for_module_fn": null, "offline_evaluation_duration": 1, "offline_evaluation_parallel_to_training": false, "offline_evaluation_timeout_s": 120.0, "num_cpus_per_offline_eval_runner": 1, "num_gpus_per_offline_eval_runner": 0, "custom_resources_per_offline_eval_runner": {}, "restart_failed_offline_eval_runners": true, "ignore_offline_eval_runner_failures": false, "max_num_offline_eval_runner_restarts": 1000, "offline_eval_runner_restore_timeout_s": 1800.0, "max_requests_in_flight_per_offline_eval_runner": 1, "validate_offline_eval_runners_after_construction": true, "offline_eval_runner_health_probe_timeout_s": 30.0, "offline_eval_rl_module_inference_only": false, "broadcast_offline_eval_runner_states": false, "offline_eval_batch_size_per_runner": 256, "dataset_num_iters_per_eval_runner": 1, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "log_gradients": true, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 42, "restart_failed_env_runners": true, "ignore_env_runner_failures": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30.0, "env_runner_restore_timeout_s": 1800.0, "_model_config": {}, "_rl_module_spec": "RLModuleSpec(module_class=None, observation_space=None, action_space=None, inference_only=False, learner_only=False, model_config=DefaultModelConfig(fcnet_hiddens=[53, 69], fcnet_activation='tanh', fcnet_kernel_initializer=None, fcnet_kernel_initializer_kwargs=None, fcnet_bias_initializer=None, fcnet_bias_initializer_kwargs=None, conv_filters=None, conv_activation='relu', conv_kernel_initializer=None, conv_kernel_initializer_kwargs=None, conv_bias_initializer=None, conv_bias_initializer_kwargs=None, head_fcnet_hiddens=[], head_fcnet_activation='relu', head_fcnet_kernel_initializer=None, head_fcnet_kernel_initializer_kwargs=None, head_fcnet_bias_initializer=None, head_fcnet_bias_initializer_kwargs=None, free_log_std=False, log_std_clip_param=20.0, vf_share_layers=True, use_lstm=False, max_seq_len=20, lstm_cell_size=256, lstm_use_prev_action=False, lstm_use_prev_reward=False, lstm_kernel_initializer=None, lstm_kernel_initializer_kwargs=None, lstm_bias_initializer=None, lstm_bias_initializer_kwargs=None), catalog_class=None, load_state_path=None, model_config_dict=None)", "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "_validate_config": true, "_use_msgpack_checkpoints": false, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "env_task_fn": -1, "enable_connectors": -1, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.5939852077022, "kl_target": 0.0137962462363, "vf_loss_coeff": 0.69270825127, "entropy_coeff": 0.0018408992081, "clip_param": 0.1749080237695, "vf_clip_param": 0.3721230154351, "entropy_coeff_schedule": null, "lr_schedule": null, "sgd_minibatch_size": -1, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.95565474084, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.callbacks.callbacks.RLlibCallback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 30.099668502807617, "iterations_since_restore": 6, "perf": {"cpu_util_percent": 12.085714285714285, "ram_util_percent": 75.8}}
{"timers": {"training_iteration": 4.279646511157377, "restore_env_runners": 1.4091724424018981e-05, "training_step": 4.2793465650828555, "env_runner_sampling_timer": 3.8483729926293493, "learner_update_timer": 0.4269576427466135, "synch_weights": 0.001625570237085542, "restore_eval_env_runners": 1.4717170394512092e-05, "evaluation_iteration": 0.7473511646844019, "synch_eval_env_connectors": 0.0005827177218456966, "synch_env_connectors": 8.461127822986735e-06}, "env_runners": {"episode_len_max": 50, "env_to_module_connector": {"timers": {"connectors": {"add_time_dim_to_batch_and_zero_pad": 6.256210451814479e-06, "add_states_from_episodes_to_batch": 3.5505887914096358e-06, "add_observations_from_episodes_to_batch": 6.463600929020071e-06, "batch_individual_items": 1.8739531706140147e-05, "numpy_to_tensor": 3.2244491422590566e-05}}, "connector_pipeline_timer": 0.00012143892704610915}, "env_reset_timer": 9.919401165944473e-05, "module_to_env_connector": {"timers": {"connectors": {"tensor_to_numpy": 5.0882907606544226e-05, "remove_single_ts_time_rank_from_batch": 1.4993502507548026e-06, "listify_data_for_vector_env": 3.14771741368042e-05, "un_batch_to_individual_items": 1.5184895771249581e-05, "get_actions": 0.00016975069422405428, "normalize_and_clip_actions": 2.3559693708017393e-05}}, "connector_pipeline_timer": 0.0003715434042834941}, "env_to_module_sum_episodes_length_out": 27.16809333212661, "num_agent_steps_sampled_lifetime": {"default_agent": -1202500.0}, "agent_episode_returns_mean": {"default_agent": 5.100000000000001}, "env_to_module_sum_episodes_length_in": 27.16809333212661, "episode_return_min": -5.5, "num_env_steps_sampled_lifetime": -1202500.0, "num_episodes_lifetime": -24050.0, "episode_len_mean": 50.0, "time_between_sampling": 0.01190713693755689, "num_agent_steps_sampled": {"default_agent": 5000.0}, "module_episode_returns_mean": {"default_policy": 5.100000000000001}, "episode_len_min": 50, "num_env_steps_sampled": 5000.0, "num_episodes": 100.0, "num_module_steps_sampled_lifetime": {"default_policy": -1202500.0}, "episode_return_max": 14.5, "num_module_steps_sampled": {"default_policy": 5000.0}, "episode_return_mean": 5.100000000000001, "episode_duration_sec_mean": 0.03882559142000558, "rlmodule_inference_timer": 0.00012835832111179418, "weights_seq_no": 6.0, "env_step_timer": 4.4835675227091e-05, "sample": 0.03871970847455505, "num_env_steps_sampled_lifetime_throughput": 1243.4345855583201}, "learners": {"__all_modules__": {"learner_connector": {"timers": {"connectors": {"add_columns_from_episodes_to_train_batch": 0.06674399199456471, "add_observations_from_episodes_to_batch": 0.0007893301931751835, "add_time_dim_to_batch_and_zero_pad": 2.256839687006082e-05, "batch_individual_items": 0.1925031117121205, "add_one_ts_to_episodes_and_truncate": 0.008267538379086907, "general_advantage_estimation": 0.013849139689296058, "add_states_from_episodes_to_batch": 6.705159074003539e-06, "numpy_to_tensor": 0.00017718559312040674}}, "connector_pipeline_timer": 0.28274251919434806}, "num_env_steps_trained": 56100, "num_module_steps_trained": 11000, "num_non_trainable_parameters": 0, "learner_connector_sum_episodes_length_in": 5000.0, "num_module_steps_trained_lifetime": 77000, "learner_connector_sum_episodes_length_out": 5100.0, "num_trainable_parameters": 4148, "num_env_steps_trained_lifetime": 392700, "num_env_steps_trained_lifetime_throughput": 851348.7642882371, "num_module_steps_trained_throughput": 167497.18829439496, "num_module_steps_trained_lifetime_throughput": 167252.6417442824}, "default_policy": {"curr_entropy_coeff": 0.0018408992081, "gradients_default_optimizer_global_norm": 0.1415126621723175, "entropy": 0.6795769929885864, "policy_loss": -0.025525163859128952, "total_loss": 0.21249675750732422, "num_trainable_parameters": 4148, "num_module_steps_trained_lifetime": 77000, "vf_loss": 0.3450579047203064, "module_train_batch_size_mean": 1000.0, "vf_explained_var": -0.20794129371643066, "default_optimizer_learning_rate": 0.0027541439213, "num_module_steps_trained": 11000, "curr_kl_coeff": 0.03712407499551773, "vf_loss_unclipped": 27.001588821411133, "diff_num_grad_updates_vs_sampler_policy": 1.0, "mean_kl_loss": 0.003346832701936364, "weights_seq_no": 7.0, "num_module_steps_trained_lifetime_throughput": 167777.08240346622}}, "num_training_step_calls_per_iteration": 1, "evaluation": {"env_runners": {"env_to_module_connector": {"connector_pipeline_timer": 0.00011259526838172052, "timers": {"connectors": {"add_time_dim_to_batch_and_zero_pad": 5.4824222099159406e-06, "batch_individual_items": 1.8456075964867647e-05, "numpy_to_tensor": 2.9204828023803962e-05, "add_states_from_episodes_to_batch": 3.288918133104e-06, "add_observations_from_episodes_to_batch": 6.337153914090372e-06}}}, "num_episodes": 20, "episode_return_max": 17.5, "episode_return_mean": 0.3, "rlmodule_inference_timer": 9.313027078510979e-05, "module_to_env_connector": {"timers": {"connectors": {"un_batch_to_individual_items": 1.5746957337349942e-05, "normalize_and_clip_actions": 2.1477198534840428e-05, "tensor_to_numpy": 4.584050857124572e-05, "listify_data_for_vector_env": 3.0046691491395163e-05, "remove_single_ts_time_rank_from_batch": 1.4033061038894411e-06, "get_actions": 0.0001559713884955844}}, "connector_pipeline_timer": 0.00034258074326150545}, "sample": 0.7350317234179093, "episode_len_max": 50, "episode_len_mean": 50.0, "num_agent_steps_sampled": {"default_agent": 1000}, "agent_episode_returns_mean": {"default_agent": 0.3}, "num_module_steps_sampled_lifetime": {"default_policy": 7000}, "env_step_timer": 4.190385038518518e-05, "env_reset_timer": 0.00020583001757227623, "episode_return_min": -16.5, "num_env_steps_sampled_lifetime": 36000, "env_to_module_sum_episodes_length_in": 27.168093332126602, "episode_duration_sec_mean": 0.035111041810002915, "num_module_steps_sampled": {"default_policy": 1000}, "num_episodes_lifetime": 140, "episode_len_min": 50, "num_env_steps_sampled": 1000, "num_agent_steps_sampled_lifetime": {"default_agent": 7000}, "module_episode_returns_mean": {"default_policy": 0.3}, "weights_seq_no": 7.0, "env_to_module_sum_episodes_length_out": 27.168093332126602, "time_between_sampling": 4.343306732144975}, "num_healthy_workers": 1, "actor_manager_num_outstanding_async_reqs": 0, "num_remote_worker_restarts": 0}, "num_env_steps_sampled_lifetime": -1202500.0, "fault_tolerance": {"num_healthy_workers": 0, "num_remote_worker_restarts": 0}, "env_runner_group": {"actor_manager_num_outstanding_async_reqs": 0}, "done": true, "training_iteration": 7, "trial_id": "f5bb1_00000", "date": "2025-08-11_16-11-54", "timestamp": 1754921514, "time_this_iter_s": 5.085440158843994, "time_total_s": 35.18510866165161, "pid": 12703, "hostname": "DESKTOP-3SK5A41", "node_ip": "192.168.40.242", "config": {"exploration_config": {}, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 6, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "env": "Umbrella", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": false, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 0, "create_local_env_runner": true, "num_envs_per_env_runner": 1, "gym_env_vectorize_mode": "SYNC", "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "episodes_to_numpy": true, "max_requests_in_flight_per_env_runner": 1, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "merge_env_runner_states": "training_only", "broadcast_env_runner_states": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "complete_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "sampler_perf_stats_ema_coef": null, "_is_online": true, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": "auto", "num_aggregator_actors_per_learner": 0, "max_requests_in_flight_per_aggregator_actor": 3, "local_gpu_idx": 0, "max_requests_in_flight_per_learner": 3, "gamma": 1, "lr": 0.0027541439213, "grad_clip": 0.5, "grad_clip_by": "global_norm", "_train_batch_size_per_learner": 5000, "train_batch_size": 4000, "num_epochs": 2, "minibatch_size": 1000, "shuffle_batch_per_epoch": true, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "log_std_clip_param": 20.0, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "_disable_preprocessor_api": false, "_disable_action_flattening": false}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "_learner_class": null, "callbacks_on_algorithm_init": null, "callbacks_on_env_runners_recreated": null, "callbacks_on_offline_eval_runners_recreated": null, "callbacks_on_checkpoint_loaded": null, "callbacks_on_environment_created": null, "callbacks_on_episode_created": null, "callbacks_on_episode_start": null, "callbacks_on_episode_step": null, "callbacks_on_episode_end": null, "callbacks_on_evaluate_start": null, "callbacks_on_evaluate_end": null, "callbacks_on_evaluate_offline_start": null, "callbacks_on_evaluate_offline_end": null, "callbacks_on_sample_end": null, "callbacks_on_train_result": null, "explore": true, "enable_rl_module_and_learner": true, "enable_env_runner_and_connector_v2": true, "_prior_exploration_config": {"type": "StochasticSampling"}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x73ae51472ac0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "offline_data_class": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_read_batch_size": null, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "materialize_data": false, "materialize_mapped_data": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "ignore_final_observation": false, "prelearner_class": null, "prelearner_buffer_class": null, "prelearner_buffer_kwargs": {}, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_remaining_data": false, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": 1, "evaluation_duration": 20, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_auto_duration_min_env_steps_per_sample": 100, "evaluation_auto_duration_max_env_steps_per_sample": 2000, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 1, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "offline_evaluation_interval": null, "num_offline_eval_runners": 0, "offline_loss_for_module_fn": null, "offline_evaluation_duration": 1, "offline_evaluation_parallel_to_training": false, "offline_evaluation_timeout_s": 120.0, "num_cpus_per_offline_eval_runner": 1, "num_gpus_per_offline_eval_runner": 0, "custom_resources_per_offline_eval_runner": {}, "restart_failed_offline_eval_runners": true, "ignore_offline_eval_runner_failures": false, "max_num_offline_eval_runner_restarts": 1000, "offline_eval_runner_restore_timeout_s": 1800.0, "max_requests_in_flight_per_offline_eval_runner": 1, "validate_offline_eval_runners_after_construction": true, "offline_eval_runner_health_probe_timeout_s": 30.0, "offline_eval_rl_module_inference_only": false, "broadcast_offline_eval_runner_states": false, "offline_eval_batch_size_per_runner": 256, "dataset_num_iters_per_eval_runner": 1, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "log_gradients": true, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 42, "restart_failed_env_runners": true, "ignore_env_runner_failures": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30.0, "env_runner_restore_timeout_s": 1800.0, "_model_config": {}, "_rl_module_spec": "RLModuleSpec(module_class=None, observation_space=None, action_space=None, inference_only=False, learner_only=False, model_config=DefaultModelConfig(fcnet_hiddens=[53, 69], fcnet_activation='tanh', fcnet_kernel_initializer=None, fcnet_kernel_initializer_kwargs=None, fcnet_bias_initializer=None, fcnet_bias_initializer_kwargs=None, conv_filters=None, conv_activation='relu', conv_kernel_initializer=None, conv_kernel_initializer_kwargs=None, conv_bias_initializer=None, conv_bias_initializer_kwargs=None, head_fcnet_hiddens=[], head_fcnet_activation='relu', head_fcnet_kernel_initializer=None, head_fcnet_kernel_initializer_kwargs=None, head_fcnet_bias_initializer=None, head_fcnet_bias_initializer_kwargs=None, free_log_std=False, log_std_clip_param=20.0, vf_share_layers=True, use_lstm=False, max_seq_len=20, lstm_cell_size=256, lstm_use_prev_action=False, lstm_use_prev_reward=False, lstm_kernel_initializer=None, lstm_kernel_initializer_kwargs=None, lstm_bias_initializer=None, lstm_bias_initializer_kwargs=None), catalog_class=None, load_state_path=None, model_config_dict=None)", "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "_validate_config": true, "_use_msgpack_checkpoints": false, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "env_task_fn": -1, "enable_connectors": -1, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.5939852077022, "kl_target": 0.0137962462363, "vf_loss_coeff": 0.69270825127, "entropy_coeff": 0.0018408992081, "clip_param": 0.1749080237695, "vf_clip_param": 0.3721230154351, "entropy_coeff_schedule": null, "lr_schedule": null, "sgd_minibatch_size": -1, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.95565474084, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.callbacks.callbacks.RLlibCallback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 35.18510866165161, "iterations_since_restore": 7, "perf": {"cpu_util_percent": 11.257142857142856, "ram_util_percent": 75.8}}
