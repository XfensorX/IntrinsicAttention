{"timers": {"training_iteration": 4.282022080999923, "restore_env_runners": 1.359999987471383e-05, "training_step": 4.281799181000224, "env_runner_sampling_timer": 3.8223532829997566, "learner_update_timer": 0.4556783979996908, "synch_weights": 0.0015725999996902829}, "env_runners": {"module_to_env_connector": {"timers": {"connectors": {"un_batch_to_individual_items": 1.5016533015825843e-05, "tensor_to_numpy": 4.790273539929831e-05, "normalize_and_clip_actions": 2.7549240071151028e-05, "listify_data_for_vector_env": 3.063589142096837e-05, "remove_single_ts_time_rank_from_batch": 1.4823628580449293e-06, "get_actions": 0.00016634730192273146}}, "connector_pipeline_timer": 0.0003652780319942954}, "num_module_steps_sampled_lifetime": {"default_policy": 252500.0}, "env_reset_timer": 0.00020705751567842338, "module_episode_returns_mean": {"default_policy": 5.100000000000001}, "env_to_module_connector": {"connector_pipeline_timer": 0.00012164879935729102, "timers": {"connectors": {"add_observations_from_episodes_to_batch": 6.428837439142307e-06, "batch_individual_items": 1.8659497676749812e-05, "numpy_to_tensor": 3.2173932718873855e-05, "add_time_dim_to_batch_and_zero_pad": 6.300413403099545e-06, "add_states_from_episodes_to_batch": 3.4727209825453566e-06}}}, "weights_seq_no": 0.0, "num_module_steps_sampled": {"default_policy": 5000.0}, "episode_duration_sec_mean": 0.03574805583999931, "sample": 0.03936554877578498, "env_step_timer": 4.4253318628606136e-05, "episode_return_max": 14.5, "episode_len_max": 50, "time_between_sampling": 0.0012392614706019237, "num_episodes_lifetime": 5050.0, "agent_episode_returns_mean": {"default_agent": 5.100000000000001}, "num_agent_steps_sampled_lifetime": {"default_agent": 252500.0}, "env_to_module_sum_episodes_length_in": 26.762340024562445, "num_env_steps_sampled": 5000.0, "num_episodes": 100.0, "rlmodule_inference_timer": 0.0001049765424024062, "episode_return_mean": 5.100000000000001, "episode_len_min": 50, "episode_return_min": -5.5, "num_agent_steps_sampled": {"default_agent": 5000.0}, "episode_len_mean": 50.0, "env_to_module_sum_episodes_length_out": 26.762340024562445, "num_env_steps_sampled_lifetime": 252500.0, "num_env_steps_sampled_lifetime_throughput": 1266.1983351399274}, "learners": {"default_policy": {"total_loss": 0.2747177481651306, "weights_seq_no": 1.0, "num_trainable_parameters": 12511, "curr_kl_coeff": 0.13970772922039032, "curr_entropy_coeff": 0.0279062776126, "policy_loss": -0.015048264525830746, "mean_kl_loss": 0.0023254898842424154, "num_module_steps_trained": 16000, "gradients_default_optimizer_global_norm": 0.05499565601348877, "entropy": 0.6882236003875732, "default_optimizer_learning_rate": 0.003818468248, "vf_loss": 0.4131568968296051, "vf_loss_unclipped": 17.66187858581543, "module_train_batch_size_mean": 1000.0, "diff_num_grad_updates_vs_sampler_policy": 1.0, "num_module_steps_trained_lifetime": 16000, "vf_explained_var": 0.12761330604553223, "num_module_steps_trained_lifetime_throughput": 198270.41834487254}, "__all_modules__": {"num_env_steps_trained": 81600, "learner_connector": {"timers": {"connectors": {"batch_individual_items": 0.1988406999998915, "general_advantage_estimation": 0.014850498999749107, "add_states_from_episodes_to_batch": 5.999999757477781e-06, "add_one_ts_to_episodes_and_truncate": 0.0084871000003659, "add_time_dim_to_batch_and_zero_pad": 2.3099999907572055e-05, "add_observations_from_episodes_to_batch": 0.0007961000001159846, "add_columns_from_episodes_to_train_batch": 0.0695947989997876, "numpy_to_tensor": 0.00016300000015689875}}, "connector_pipeline_timer": 0.2931317979996493}, "num_module_steps_trained": 16000, "num_module_steps_trained_lifetime": 16000, "learner_connector_sum_episodes_length_in": 5000, "num_env_steps_trained_lifetime": 81600, "num_non_trainable_parameters": 0, "num_trainable_parameters": 12511, "learner_connector_sum_episodes_length_out": 5100, "num_env_steps_trained_lifetime_throughput": 1006956.988284381, "num_module_steps_trained_throughput": 197973.54653054726, "num_module_steps_trained_lifetime_throughput": 197869.6011625213}}, "num_training_step_calls_per_iteration": 1, "num_env_steps_sampled_lifetime": 252500.0, "evaluation": {"env_runners": {"env_reset_timer": 0.00028830000019297586, "module_to_env_connector": {"timers": {"connectors": {"un_batch_to_individual_items": 1.58814538966198e-05, "tensor_to_numpy": 4.4873932453453727e-05, "remove_single_ts_time_rank_from_batch": 1.3959965975678288e-06, "listify_data_for_vector_env": 2.9444015778860153e-05, "get_actions": 0.00015191093129507806, "normalize_and_clip_actions": 2.159528437554639e-05}}, "connector_pipeline_timer": 0.00033789032377672064}, "episode_duration_sec_mean": 0.03477812979997452, "sample": 0.7240383959997416, "num_agent_steps_sampled": {"default_agent": 1000}, "num_episodes_lifetime": 20, "num_episodes": 20, "num_module_steps_sampled_lifetime": {"default_policy": 1000}, "num_module_steps_sampled": {"default_policy": 1000}, "env_to_module_sum_episodes_length_out": 27.167134025045954, "env_to_module_connector": {"timers": {"connectors": {"batch_individual_items": 1.7738928509737347e-05, "add_states_from_episodes_to_batch": 3.145665284138222e-06, "add_observations_from_episodes_to_batch": 5.878197479341849e-06, "add_time_dim_to_batch_and_zero_pad": 5.181523362018667e-06, "numpy_to_tensor": 2.906273904669024e-05}}, "connector_pipeline_timer": 0.00011074625523051366}, "agent_episode_returns_mean": {"default_agent": -0.9}, "num_agent_steps_sampled_lifetime": {"default_agent": 1000}, "weights_seq_no": 1.0, "episode_return_max": 17.5, "episode_return_mean": -0.9, "episode_return_min": -16.5, "episode_len_mean": 50.0, "env_step_timer": 4.1478304712463146e-05, "episode_len_max": 50, "env_to_module_sum_episodes_length_in": 27.167134025045954, "module_episode_returns_mean": {"default_policy": -0.9}, "episode_len_min": 50, "rlmodule_inference_timer": 9.31335655557652e-05, "num_env_steps_sampled": 1000, "num_env_steps_sampled_lifetime": 6000}, "num_healthy_workers": 1, "actor_manager_num_outstanding_async_reqs": 0, "num_remote_worker_restarts": 0}, "fault_tolerance": {"num_healthy_workers": 0, "num_remote_worker_restarts": 0}, "env_runner_group": {"actor_manager_num_outstanding_async_reqs": 0}, "done": false, "training_iteration": 1, "trial_id": "42e43_00000", "date": "2025-08-11_16-37-08", "timestamp": 1754923028, "time_this_iter_s": 5.021472692489624, "time_total_s": 5.021472692489624, "pid": 34665, "hostname": "DESKTOP-3SK5A41", "node_ip": "192.168.40.242", "config": {"exploration_config": {}, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 6, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "env": "Umbrella", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": false, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 0, "create_local_env_runner": true, "num_envs_per_env_runner": 1, "gym_env_vectorize_mode": "SYNC", "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "episodes_to_numpy": true, "max_requests_in_flight_per_env_runner": 1, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "merge_env_runner_states": "training_only", "broadcast_env_runner_states": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "complete_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "sampler_perf_stats_ema_coef": null, "_is_online": true, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": "auto", "num_aggregator_actors_per_learner": 0, "max_requests_in_flight_per_aggregator_actor": 3, "local_gpu_idx": 0, "max_requests_in_flight_per_learner": 3, "gamma": 1, "lr": 0.003818468248, "grad_clip": 0.5, "grad_clip_by": "global_norm", "_train_batch_size_per_learner": 5000, "train_batch_size": 4000, "num_epochs": 3, "minibatch_size": 1000, "shuffle_batch_per_epoch": true, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "log_std_clip_param": 20.0, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "_disable_preprocessor_api": false, "_disable_action_flattening": false}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "_learner_class": null, "callbacks_on_algorithm_init": null, "callbacks_on_env_runners_recreated": null, "callbacks_on_offline_eval_runners_recreated": null, "callbacks_on_checkpoint_loaded": null, "callbacks_on_environment_created": null, "callbacks_on_episode_created": null, "callbacks_on_episode_start": null, "callbacks_on_episode_step": null, "callbacks_on_episode_end": null, "callbacks_on_evaluate_start": null, "callbacks_on_evaluate_end": null, "callbacks_on_evaluate_offline_start": null, "callbacks_on_evaluate_offline_end": null, "callbacks_on_sample_end": null, "callbacks_on_train_result": null, "explore": true, "enable_rl_module_and_learner": true, "enable_env_runner_and_connector_v2": true, "_prior_exploration_config": {"type": "StochasticSampling"}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7f7fc7f76ac0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "offline_data_class": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_read_batch_size": null, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "materialize_data": false, "materialize_mapped_data": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "ignore_final_observation": false, "prelearner_class": null, "prelearner_buffer_class": null, "prelearner_buffer_kwargs": {}, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_remaining_data": false, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": 1, "evaluation_duration": 20, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_auto_duration_min_env_steps_per_sample": 100, "evaluation_auto_duration_max_env_steps_per_sample": 2000, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 1, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "offline_evaluation_interval": null, "num_offline_eval_runners": 0, "offline_loss_for_module_fn": null, "offline_evaluation_duration": 1, "offline_evaluation_parallel_to_training": false, "offline_evaluation_timeout_s": 120.0, "num_cpus_per_offline_eval_runner": 1, "num_gpus_per_offline_eval_runner": 0, "custom_resources_per_offline_eval_runner": {}, "restart_failed_offline_eval_runners": true, "ignore_offline_eval_runner_failures": false, "max_num_offline_eval_runner_restarts": 1000, "offline_eval_runner_restore_timeout_s": 1800.0, "max_requests_in_flight_per_offline_eval_runner": 1, "validate_offline_eval_runners_after_construction": true, "offline_eval_runner_health_probe_timeout_s": 30.0, "offline_eval_rl_module_inference_only": false, "broadcast_offline_eval_runner_states": false, "offline_eval_batch_size_per_runner": 256, "dataset_num_iters_per_eval_runner": 1, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "log_gradients": true, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 42, "restart_failed_env_runners": true, "ignore_env_runner_failures": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30.0, "env_runner_restore_timeout_s": 1800.0, "_model_config": {}, "_rl_module_spec": "RLModuleSpec(module_class=None, observation_space=None, action_space=None, inference_only=False, learner_only=False, model_config=DefaultModelConfig(fcnet_hiddens=[120, 97], fcnet_activation='tanh', fcnet_kernel_initializer=None, fcnet_kernel_initializer_kwargs=None, fcnet_bias_initializer=None, fcnet_bias_initializer_kwargs=None, conv_filters=None, conv_activation='relu', conv_kernel_initializer=None, conv_kernel_initializer_kwargs=None, conv_bias_initializer=None, conv_bias_initializer_kwargs=None, head_fcnet_hiddens=[], head_fcnet_activation='relu', head_fcnet_kernel_initializer=None, head_fcnet_kernel_initializer_kwargs=None, head_fcnet_bias_initializer=None, head_fcnet_bias_initializer_kwargs=None, free_log_std=False, log_std_clip_param=20.0, vf_share_layers=True, use_lstm=False, max_seq_len=20, lstm_cell_size=256, lstm_use_prev_action=False, lstm_use_prev_reward=False, lstm_kernel_initializer=None, lstm_kernel_initializer_kwargs=None, lstm_bias_initializer=None, lstm_bias_initializer_kwargs=None), catalog_class=None, load_state_path=None, model_config_dict=None)", "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "_validate_config": true, "_use_msgpack_checkpoints": false, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "env_task_fn": -1, "enable_connectors": -1, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2794154475684, "kl_target": 0.0205400882743, "vf_loss_coeff": 0.7462588469094, "entropy_coeff": 0.0279062776126, "clip_param": 0.2400715659946, "vf_clip_param": 0.4568186220708, "entropy_coeff_schedule": null, "lr_schedule": null, "sgd_minibatch_size": -1, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9330944222753, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.callbacks.callbacks.RLlibCallback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 5.021472692489624, "iterations_since_restore": 1, "perf": {"cpu_util_percent": 10.9375, "ram_util_percent": 76.1125}}
{"timers": {"training_iteration": 4.2814770282299195, "restore_env_runners": 1.3607999876512623e-05, "training_step": 4.28125166523022, "env_runner_sampling_timer": 3.824059863199759, "learner_update_timer": 0.4534228110296908, "synch_weights": 0.0015709279996917757, "restore_eval_env_runners": 1.560000009703799e-05, "evaluation_iteration": 0.7365605959998902, "synch_eval_env_connectors": 0.0005133999998179206, "synch_env_connectors": 7.79999982114532e-06}, "env_runners": {"module_to_env_connector": {"timers": {"connectors": {"un_batch_to_individual_items": 1.518339322875837e-05, "tensor_to_numpy": 5.013531237725503e-05, "normalize_and_clip_actions": 2.2794081924430915e-05, "listify_data_for_vector_env": 3.146599175246751e-05, "remove_single_ts_time_rank_from_batch": 1.4837860424295769e-06, "get_actions": 0.000168159347808268}}, "connector_pipeline_timer": 0.00036693103756465546}, "num_module_steps_sampled_lifetime": {"default_policy": 10000.0}, "env_reset_timer": 0.00013746439643033868, "module_episode_returns_mean": {"default_policy": 5.100000000000001}, "env_to_module_connector": {"connector_pipeline_timer": 0.00012126831582463042, "timers": {"connectors": {"add_observations_from_episodes_to_batch": 6.530265220192968e-06, "batch_individual_items": 1.8977901498092073e-05, "numpy_to_tensor": 3.225827883414669e-05, "add_time_dim_to_batch_and_zero_pad": 6.340065256092705e-06, "add_states_from_episodes_to_batch": 3.4843300534764263e-06}}}, "weights_seq_no": 1.0, "num_module_steps_sampled": {"default_policy": 5000.0}, "episode_duration_sec_mean": 0.03733437703001073, "sample": 0.03817972813706774, "env_step_timer": 4.425998525533839e-05, "episode_return_max": 14.5, "episode_len_max": 50, "time_between_sampling": 0.00919514182785626, "num_episodes_lifetime": 200.0, "agent_episode_returns_mean": {"default_agent": 5.100000000000001}, "num_agent_steps_sampled_lifetime": {"default_agent": 10000.0}, "env_to_module_sum_episodes_length_in": 27.16809333212661, "num_env_steps_sampled": 5000.0, "num_episodes": 100.0, "rlmodule_inference_timer": 0.0001036530831736371, "episode_return_mean": 5.100000000000001, "episode_len_min": 50, "episode_return_min": -5.5, "num_agent_steps_sampled": {"default_agent": 5000.0}, "episode_len_mean": 50.0, "env_to_module_sum_episodes_length_out": 27.16809333212661, "num_env_steps_sampled_lifetime": 10000.0, "num_env_steps_sampled_lifetime_throughput": 1270.912404482073}, "learners": {"default_policy": {"total_loss": 0.27413854002952576, "weights_seq_no": 2.0, "num_trainable_parameters": 12511, "curr_kl_coeff": 0.06985386461019516, "curr_entropy_coeff": 0.0279062776126, "policy_loss": 0.022781943902373314, "mean_kl_loss": 0.008790755644440651, "num_module_steps_trained": 16000, "gradients_default_optimizer_global_norm": 0.33669981360435486, "entropy": 0.67650306224823, "default_optimizer_learning_rate": 0.003818468248, "vf_loss": 0.36047428846359253, "vf_loss_unclipped": 11.296711921691895, "module_train_batch_size_mean": 1000.0, "diff_num_grad_updates_vs_sampler_policy": 1.0, "num_module_steps_trained_lifetime": 32000, "vf_explained_var": 0.4466251730918884, "num_module_steps_trained_lifetime_throughput": 198094.8309270847}, "__all_modules__": {"num_env_steps_trained": 81600, "learner_connector": {"timers": {"connectors": {"batch_individual_items": 0.19743951000989454, "general_advantage_estimation": 0.014799453009754871, "add_states_from_episodes_to_batch": 6.0019997590643465e-06, "add_one_ts_to_episodes_and_truncate": 0.008485751000362142, "add_time_dim_to_batch_and_zero_pad": 2.3088999910214625e-05, "add_observations_from_episodes_to_batch": 0.0007950060001167003, "add_columns_from_episodes_to_train_batch": 0.06959582500979195, "numpy_to_tensor": 0.00016306100015299306}}, "connector_pipeline_timer": 0.2916767840296552}, "num_module_steps_trained": 16000, "num_module_steps_trained_lifetime": 32000, "learner_connector_sum_episodes_length_in": 5000.0, "num_env_steps_trained_lifetime": 163200, "num_non_trainable_parameters": 0, "num_trainable_parameters": 12511, "learner_connector_sum_episodes_length_out": 5100.0, "num_env_steps_trained_lifetime_throughput": 1006189.236132512, "num_module_steps_trained_throughput": 197809.09935604493, "num_module_steps_trained_lifetime_throughput": 197707.6236385245}}, "num_training_step_calls_per_iteration": 1, "evaluation": {"env_runners": {"env_reset_timer": 0.00028665200019077023, "module_to_env_connector": {"timers": {"connectors": {"un_batch_to_individual_items": 1.5928048767654578e-05, "tensor_to_numpy": 4.7072251440115276e-05, "remove_single_ts_time_rank_from_batch": 1.4878780527168274e-06, "listify_data_for_vector_env": 3.1348240486260915e-05, "get_actions": 0.00015988591095311233, "normalize_and_clip_actions": 2.3371321944878228e-05}}, "connector_pipeline_timer": 0.00035467429993566514}, "episode_duration_sec_mean": 0.035103317525033616, "sample": 0.7241692910897428, "num_agent_steps_sampled": {"default_agent": 1000}, "num_episodes_lifetime": 40, "num_episodes": 20, "num_module_steps_sampled_lifetime": {"default_policy": 2000}, "num_module_steps_sampled": {"default_policy": 1000}, "env_to_module_sum_episodes_length_out": 27.168093298253442, "env_to_module_connector": {"timers": {"connectors": {"batch_individual_items": 1.8909563816270355e-05, "add_states_from_episodes_to_batch": 3.5037054522263262e-06, "add_observations_from_episodes_to_batch": 6.538409671530541e-06, "add_time_dim_to_batch_and_zero_pad": 5.8411043150526824e-06, "numpy_to_tensor": 2.9711024846895097e-05}}, "connector_pipeline_timer": 0.00011649197715208237}, "agent_episode_returns_mean": {"default_agent": 1.1}, "num_agent_steps_sampled_lifetime": {"default_agent": 2000}, "weights_seq_no": 2.0, "episode_return_max": 17.5, "episode_return_mean": 1.1, "episode_return_min": -16.5, "episode_len_mean": 50.0, "env_step_timer": 4.4304327590256e-05, "episode_len_max": 50, "env_to_module_sum_episodes_length_in": 27.168093298253442, "module_episode_returns_mean": {"default_policy": 1.1}, "episode_len_min": 50, "rlmodule_inference_timer": 9.945752780437451e-05, "num_env_steps_sampled": 1000, "num_env_steps_sampled_lifetime": 11000, "time_between_sampling": 4.281444903999727}, "num_healthy_workers": 1, "actor_manager_num_outstanding_async_reqs": 0, "num_remote_worker_restarts": 0}, "num_env_steps_sampled_lifetime": 10000.0, "fault_tolerance": {"num_healthy_workers": 0, "num_remote_worker_restarts": 0}, "env_runner_group": {"actor_manager_num_outstanding_async_reqs": 0}, "done": false, "training_iteration": 2, "trial_id": "42e43_00000", "date": "2025-08-11_16-37-13", "timestamp": 1754923033, "time_this_iter_s": 4.978031635284424, "time_total_s": 9.999504327774048, "pid": 34665, "hostname": "DESKTOP-3SK5A41", "node_ip": "192.168.40.242", "config": {"exploration_config": {}, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 6, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "env": "Umbrella", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": false, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 0, "create_local_env_runner": true, "num_envs_per_env_runner": 1, "gym_env_vectorize_mode": "SYNC", "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "episodes_to_numpy": true, "max_requests_in_flight_per_env_runner": 1, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "merge_env_runner_states": "training_only", "broadcast_env_runner_states": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "complete_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "sampler_perf_stats_ema_coef": null, "_is_online": true, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": "auto", "num_aggregator_actors_per_learner": 0, "max_requests_in_flight_per_aggregator_actor": 3, "local_gpu_idx": 0, "max_requests_in_flight_per_learner": 3, "gamma": 1, "lr": 0.003818468248, "grad_clip": 0.5, "grad_clip_by": "global_norm", "_train_batch_size_per_learner": 5000, "train_batch_size": 4000, "num_epochs": 3, "minibatch_size": 1000, "shuffle_batch_per_epoch": true, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "log_std_clip_param": 20.0, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "_disable_preprocessor_api": false, "_disable_action_flattening": false}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "_learner_class": null, "callbacks_on_algorithm_init": null, "callbacks_on_env_runners_recreated": null, "callbacks_on_offline_eval_runners_recreated": null, "callbacks_on_checkpoint_loaded": null, "callbacks_on_environment_created": null, "callbacks_on_episode_created": null, "callbacks_on_episode_start": null, "callbacks_on_episode_step": null, "callbacks_on_episode_end": null, "callbacks_on_evaluate_start": null, "callbacks_on_evaluate_end": null, "callbacks_on_evaluate_offline_start": null, "callbacks_on_evaluate_offline_end": null, "callbacks_on_sample_end": null, "callbacks_on_train_result": null, "explore": true, "enable_rl_module_and_learner": true, "enable_env_runner_and_connector_v2": true, "_prior_exploration_config": {"type": "StochasticSampling"}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7f7fc7f76ac0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "offline_data_class": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_read_batch_size": null, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "materialize_data": false, "materialize_mapped_data": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "ignore_final_observation": false, "prelearner_class": null, "prelearner_buffer_class": null, "prelearner_buffer_kwargs": {}, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_remaining_data": false, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": 1, "evaluation_duration": 20, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_auto_duration_min_env_steps_per_sample": 100, "evaluation_auto_duration_max_env_steps_per_sample": 2000, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 1, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "offline_evaluation_interval": null, "num_offline_eval_runners": 0, "offline_loss_for_module_fn": null, "offline_evaluation_duration": 1, "offline_evaluation_parallel_to_training": false, "offline_evaluation_timeout_s": 120.0, "num_cpus_per_offline_eval_runner": 1, "num_gpus_per_offline_eval_runner": 0, "custom_resources_per_offline_eval_runner": {}, "restart_failed_offline_eval_runners": true, "ignore_offline_eval_runner_failures": false, "max_num_offline_eval_runner_restarts": 1000, "offline_eval_runner_restore_timeout_s": 1800.0, "max_requests_in_flight_per_offline_eval_runner": 1, "validate_offline_eval_runners_after_construction": true, "offline_eval_runner_health_probe_timeout_s": 30.0, "offline_eval_rl_module_inference_only": false, "broadcast_offline_eval_runner_states": false, "offline_eval_batch_size_per_runner": 256, "dataset_num_iters_per_eval_runner": 1, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "log_gradients": true, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 42, "restart_failed_env_runners": true, "ignore_env_runner_failures": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30.0, "env_runner_restore_timeout_s": 1800.0, "_model_config": {}, "_rl_module_spec": "RLModuleSpec(module_class=None, observation_space=None, action_space=None, inference_only=False, learner_only=False, model_config=DefaultModelConfig(fcnet_hiddens=[120, 97], fcnet_activation='tanh', fcnet_kernel_initializer=None, fcnet_kernel_initializer_kwargs=None, fcnet_bias_initializer=None, fcnet_bias_initializer_kwargs=None, conv_filters=None, conv_activation='relu', conv_kernel_initializer=None, conv_kernel_initializer_kwargs=None, conv_bias_initializer=None, conv_bias_initializer_kwargs=None, head_fcnet_hiddens=[], head_fcnet_activation='relu', head_fcnet_kernel_initializer=None, head_fcnet_kernel_initializer_kwargs=None, head_fcnet_bias_initializer=None, head_fcnet_bias_initializer_kwargs=None, free_log_std=False, log_std_clip_param=20.0, vf_share_layers=True, use_lstm=False, max_seq_len=20, lstm_cell_size=256, lstm_use_prev_action=False, lstm_use_prev_reward=False, lstm_kernel_initializer=None, lstm_kernel_initializer_kwargs=None, lstm_bias_initializer=None, lstm_bias_initializer_kwargs=None), catalog_class=None, load_state_path=None, model_config_dict=None)", "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "_validate_config": true, "_use_msgpack_checkpoints": false, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "env_task_fn": -1, "enable_connectors": -1, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2794154475684, "kl_target": 0.0205400882743, "vf_loss_coeff": 0.7462588469094, "entropy_coeff": 0.0279062776126, "clip_param": 0.2400715659946, "vf_clip_param": 0.4568186220708, "entropy_coeff_schedule": null, "lr_schedule": null, "sgd_minibatch_size": -1, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9330944222753, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.callbacks.callbacks.RLlibCallback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 9.999504327774048, "iterations_since_restore": 2, "perf": {"cpu_util_percent": 14.071428571428573, "ram_util_percent": 75.04285714285713}}
{"timers": {"training_iteration": 4.283267175247623, "restore_env_runners": 1.3713919874180648e-05, "training_step": 4.28303773287792, "env_runner_sampling_timer": 3.8280583088477607, "learner_update_timer": 0.4512127729393976, "synch_weights": 0.0015692757196933598, "restore_eval_env_runners": 1.5589000095133085e-05, "evaluation_iteration": 0.7366612410898915, "synch_eval_env_connectors": 0.000512430999820026, "synch_env_connectors": 7.797999819558755e-06}, "env_runners": {"module_to_env_connector": {"timers": {"connectors": {"un_batch_to_individual_items": 1.556173000499765e-05, "tensor_to_numpy": 5.174470418309119e-05, "normalize_and_clip_actions": 2.3308372668581295e-05, "listify_data_for_vector_env": 3.2457066191800065e-05, "remove_single_ts_time_rank_from_batch": 1.5249334480631516e-06, "get_actions": 0.00017191652526549666}}, "connector_pipeline_timer": 0.0003764744332064055}, "num_module_steps_sampled_lifetime": {"default_policy": -232500.0}, "env_reset_timer": 0.00011659498433179801, "module_episode_returns_mean": {"default_policy": 6.700000000000004}, "env_to_module_connector": {"connector_pipeline_timer": 0.00012470061835339, "timers": {"connectors": {"add_observations_from_episodes_to_batch": 6.80492595370273e-06, "batch_individual_items": 1.946985202955763e-05, "numpy_to_tensor": 3.28506297021975e-05, "add_time_dim_to_batch_and_zero_pad": 6.558807480552827e-06, "add_states_from_episodes_to_batch": 3.63903697644645e-06}}}, "weights_seq_no": 2.0, "num_module_steps_sampled": {"default_policy": 5000.0}, "episode_duration_sec_mean": 0.03961151628001515, "sample": 0.03941839081410976, "env_step_timer": 4.522027762144442e-05, "episode_return_max": 14.5, "episode_len_max": 50, "time_between_sampling": 0.010886146743067928, "num_episodes_lifetime": -4650.0, "agent_episode_returns_mean": {"default_agent": 6.700000000000004}, "num_agent_steps_sampled_lifetime": {"default_agent": -232500.0}, "env_to_module_sum_episodes_length_in": 27.16809333212661, "num_env_steps_sampled": 5000.0, "num_episodes": 100.0, "rlmodule_inference_timer": 0.00014056453147346496, "episode_return_mean": 6.700000000000004, "episode_len_min": 50, "episode_return_min": -5.5, "num_agent_steps_sampled": {"default_agent": 5000.0}, "episode_len_mean": 50.0, "env_to_module_sum_episodes_length_out": 27.16809333212661, "num_env_steps_sampled_lifetime": -232500.0, "num_env_steps_sampled_lifetime_throughput": 1232.8101635393082}, "learners": {"default_policy": {"total_loss": 0.26606249809265137, "weights_seq_no": 3.0, "num_trainable_parameters": 12511, "curr_kl_coeff": 0.03492693230509758, "curr_entropy_coeff": 0.0279062776126, "policy_loss": 0.04403648152947426, "mean_kl_loss": 0.009355359710752964, "num_module_steps_trained": 16000, "gradients_default_optimizer_global_norm": 0.2481110841035843, "entropy": 0.6498137712478638, "default_optimizer_learning_rate": 0.003818468248, "vf_loss": 0.320942759513855, "vf_loss_unclipped": 9.895167350769043, "module_train_batch_size_mean": 1000.0, "diff_num_grad_updates_vs_sampler_policy": 1.0, "num_module_steps_trained_lifetime": 48000, "vf_explained_var": 0.6538280248641968, "num_module_steps_trained_lifetime_throughput": 197584.7242447109}, "__all_modules__": {"num_env_steps_trained": 81600, "learner_connector": {"timers": {"connectors": {"batch_individual_items": 0.19603272390979531, "general_advantage_estimation": 0.014746521479660714, "add_states_from_episodes_to_batch": 6.03097976159006e-06, "add_one_ts_to_episodes_and_truncate": 0.008485197490360315, "add_time_dim_to_batch_and_zero_pad": 2.3255109909996462e-05, "add_observations_from_episodes_to_batch": 0.0007946909401127414, "add_columns_from_episodes_to_train_batch": 0.0695784017696912, "numpy_to_tensor": 0.00016308539015240055}}, "connector_pipeline_timer": 0.2901987821993597}, "num_module_steps_trained": 16000, "num_module_steps_trained_lifetime": 48000, "learner_connector_sum_episodes_length_in": 5000.0, "num_env_steps_trained_lifetime": 244800, "num_non_trainable_parameters": 0, "num_trainable_parameters": 12511, "learner_connector_sum_episodes_length_out": 5100.0, "num_env_steps_trained_lifetime_throughput": 1003749.9120573285, "num_module_steps_trained_throughput": 197313.66338800776, "num_module_steps_trained_lifetime_throughput": 197214.81590044594}}, "num_training_step_calls_per_iteration": 1, "evaluation": {"env_runners": {"env_reset_timer": 0.00028505348018975386, "module_to_env_connector": {"timers": {"connectors": {"un_batch_to_individual_items": 1.532102048303475e-05, "tensor_to_numpy": 4.582490780851882e-05, "remove_single_ts_time_rank_from_batch": 1.3672526478754758e-06, "listify_data_for_vector_env": 2.9612105648732364e-05, "get_actions": 0.00015143480217357926, "normalize_and_clip_actions": 2.1446664975010248e-05}}, "connector_pipeline_timer": 0.00033663939748884356}, "episode_duration_sec_mean": 0.03501407841667212, "sample": 0.7241724012188437, "num_agent_steps_sampled": {"default_agent": 1000}, "num_episodes_lifetime": 60, "num_episodes": 20, "num_module_steps_sampled_lifetime": {"default_policy": 3000}, "num_module_steps_sampled": {"default_policy": 1000}, "env_to_module_sum_episodes_length_out": 27.168093332125434, "env_to_module_connector": {"timers": {"connectors": {"batch_individual_items": 1.766294062708173e-05, "add_states_from_episodes_to_batch": 3.23229459676219e-06, "add_observations_from_episodes_to_batch": 5.896548534466214e-06, "add_time_dim_to_batch_and_zero_pad": 5.181976374935411e-06, "numpy_to_tensor": 2.920488143113004e-05}}, "connector_pipeline_timer": 0.00011003849146749384}, "agent_episode_returns_mean": {"default_agent": 0.1}, "num_agent_steps_sampled_lifetime": {"default_agent": 3000}, "weights_seq_no": 3.0, "episode_return_max": 17.5, "episode_return_mean": 0.1, "episode_return_min": -16.5, "episode_len_mean": 50.0, "env_step_timer": 4.19910243393348e-05, "episode_len_max": 50, "env_to_module_sum_episodes_length_in": 27.168093332125434, "module_episode_returns_mean": {"default_policy": 0.1}, "episode_len_min": 50, "rlmodule_inference_timer": 9.396177115054501e-05, "num_env_steps_sampled": 1000, "num_env_steps_sampled_lifetime": 16000, "time_between_sampling": 4.28387672126973}, "num_healthy_workers": 1, "actor_manager_num_outstanding_async_reqs": 0, "num_remote_worker_restarts": 0}, "num_env_steps_sampled_lifetime": -232500.0, "fault_tolerance": {"num_healthy_workers": 0, "num_remote_worker_restarts": 0}, "env_runner_group": {"actor_manager_num_outstanding_async_reqs": 0}, "done": false, "training_iteration": 3, "trial_id": "42e43_00000", "date": "2025-08-11_16-37-18", "timestamp": 1754923038, "time_this_iter_s": 5.1998291015625, "time_total_s": 15.199333429336548, "pid": 34665, "hostname": "DESKTOP-3SK5A41", "node_ip": "192.168.40.242", "config": {"exploration_config": {}, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 6, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "env": "Umbrella", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": false, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 0, "create_local_env_runner": true, "num_envs_per_env_runner": 1, "gym_env_vectorize_mode": "SYNC", "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "episodes_to_numpy": true, "max_requests_in_flight_per_env_runner": 1, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "merge_env_runner_states": "training_only", "broadcast_env_runner_states": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "complete_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "sampler_perf_stats_ema_coef": null, "_is_online": true, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": "auto", "num_aggregator_actors_per_learner": 0, "max_requests_in_flight_per_aggregator_actor": 3, "local_gpu_idx": 0, "max_requests_in_flight_per_learner": 3, "gamma": 1, "lr": 0.003818468248, "grad_clip": 0.5, "grad_clip_by": "global_norm", "_train_batch_size_per_learner": 5000, "train_batch_size": 4000, "num_epochs": 3, "minibatch_size": 1000, "shuffle_batch_per_epoch": true, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "log_std_clip_param": 20.0, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "_disable_preprocessor_api": false, "_disable_action_flattening": false}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "_learner_class": null, "callbacks_on_algorithm_init": null, "callbacks_on_env_runners_recreated": null, "callbacks_on_offline_eval_runners_recreated": null, "callbacks_on_checkpoint_loaded": null, "callbacks_on_environment_created": null, "callbacks_on_episode_created": null, "callbacks_on_episode_start": null, "callbacks_on_episode_step": null, "callbacks_on_episode_end": null, "callbacks_on_evaluate_start": null, "callbacks_on_evaluate_end": null, "callbacks_on_evaluate_offline_start": null, "callbacks_on_evaluate_offline_end": null, "callbacks_on_sample_end": null, "callbacks_on_train_result": null, "explore": true, "enable_rl_module_and_learner": true, "enable_env_runner_and_connector_v2": true, "_prior_exploration_config": {"type": "StochasticSampling"}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7f7fc7f76ac0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "offline_data_class": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_read_batch_size": null, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "materialize_data": false, "materialize_mapped_data": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "ignore_final_observation": false, "prelearner_class": null, "prelearner_buffer_class": null, "prelearner_buffer_kwargs": {}, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_remaining_data": false, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": 1, "evaluation_duration": 20, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_auto_duration_min_env_steps_per_sample": 100, "evaluation_auto_duration_max_env_steps_per_sample": 2000, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 1, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "offline_evaluation_interval": null, "num_offline_eval_runners": 0, "offline_loss_for_module_fn": null, "offline_evaluation_duration": 1, "offline_evaluation_parallel_to_training": false, "offline_evaluation_timeout_s": 120.0, "num_cpus_per_offline_eval_runner": 1, "num_gpus_per_offline_eval_runner": 0, "custom_resources_per_offline_eval_runner": {}, "restart_failed_offline_eval_runners": true, "ignore_offline_eval_runner_failures": false, "max_num_offline_eval_runner_restarts": 1000, "offline_eval_runner_restore_timeout_s": 1800.0, "max_requests_in_flight_per_offline_eval_runner": 1, "validate_offline_eval_runners_after_construction": true, "offline_eval_runner_health_probe_timeout_s": 30.0, "offline_eval_rl_module_inference_only": false, "broadcast_offline_eval_runner_states": false, "offline_eval_batch_size_per_runner": 256, "dataset_num_iters_per_eval_runner": 1, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "log_gradients": true, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 42, "restart_failed_env_runners": true, "ignore_env_runner_failures": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30.0, "env_runner_restore_timeout_s": 1800.0, "_model_config": {}, "_rl_module_spec": "RLModuleSpec(module_class=None, observation_space=None, action_space=None, inference_only=False, learner_only=False, model_config=DefaultModelConfig(fcnet_hiddens=[120, 97], fcnet_activation='tanh', fcnet_kernel_initializer=None, fcnet_kernel_initializer_kwargs=None, fcnet_bias_initializer=None, fcnet_bias_initializer_kwargs=None, conv_filters=None, conv_activation='relu', conv_kernel_initializer=None, conv_kernel_initializer_kwargs=None, conv_bias_initializer=None, conv_bias_initializer_kwargs=None, head_fcnet_hiddens=[], head_fcnet_activation='relu', head_fcnet_kernel_initializer=None, head_fcnet_kernel_initializer_kwargs=None, head_fcnet_bias_initializer=None, head_fcnet_bias_initializer_kwargs=None, free_log_std=False, log_std_clip_param=20.0, vf_share_layers=True, use_lstm=False, max_seq_len=20, lstm_cell_size=256, lstm_use_prev_action=False, lstm_use_prev_reward=False, lstm_kernel_initializer=None, lstm_kernel_initializer_kwargs=None, lstm_bias_initializer=None, lstm_bias_initializer_kwargs=None), catalog_class=None, load_state_path=None, model_config_dict=None)", "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "_validate_config": true, "_use_msgpack_checkpoints": false, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "env_task_fn": -1, "enable_connectors": -1, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2794154475684, "kl_target": 0.0205400882743, "vf_loss_coeff": 0.7462588469094, "entropy_coeff": 0.0279062776126, "clip_param": 0.2400715659946, "vf_clip_param": 0.4568186220708, "entropy_coeff_schedule": null, "lr_schedule": null, "sgd_minibatch_size": -1, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9330944222753, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.callbacks.callbacks.RLlibCallback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 15.199333429336548, "iterations_since_restore": 3, "perf": {"cpu_util_percent": 12.828571428571431, "ram_util_percent": 71.92857142857143}}
{"timers": {"training_iteration": 4.284185555435149, "restore_env_runners": 1.3706780673973754e-05, "training_step": 4.283954268489137, "env_runner_sampling_timer": 3.8297137047092806, "learner_update_timer": 0.4504732692000021, "synch_weights": 0.0015698009624970889, "restore_eval_env_runners": 1.5584110093459453e-05, "evaluation_iteration": 0.7366377197189901, "synch_eval_env_connectors": 0.0005111666898234488, "synch_env_connectors": 7.792019823909869e-06}, "env_runners": {"module_to_env_connector": {"timers": {"connectors": {"un_batch_to_individual_items": 1.5253344955587713e-05, "tensor_to_numpy": 5.093501329098311e-05, "normalize_and_clip_actions": 2.2615535412676945e-05, "listify_data_for_vector_env": 3.1608299682059726e-05, "remove_single_ts_time_rank_from_batch": 1.4958289710237429e-06, "get_actions": 0.00016779299892481534}}, "connector_pipeline_timer": 0.0003679168641401202}, "num_module_steps_sampled_lifetime": {"default_policy": -475000.0}, "env_reset_timer": 0.00010490811266886174, "module_episode_returns_mean": {"default_policy": 6.5}, "env_to_module_connector": {"connector_pipeline_timer": 0.00012125073251741147, "timers": {"connectors": {"add_observations_from_episodes_to_batch": 6.455001465522652e-06, "batch_individual_items": 1.8933125663417202e-05, "numpy_to_tensor": 3.2034089959993995e-05, "add_time_dim_to_batch_and_zero_pad": 6.361692427471005e-06, "add_states_from_episodes_to_batch": 3.5430099992190514e-06}}}, "weights_seq_no": 3.0, "num_module_steps_sampled": {"default_policy": 5000.0}, "episode_duration_sec_mean": 0.03734267494997766, "sample": 0.03936143223484381, "env_step_timer": 4.422664122436393e-05, "episode_return_max": 14.5, "episode_len_max": 50, "time_between_sampling": 0.011376353039942605, "num_episodes_lifetime": -9500.0, "agent_episode_returns_mean": {"default_agent": 6.5}, "num_agent_steps_sampled_lifetime": {"default_agent": -475000.0}, "env_to_module_sum_episodes_length_in": 27.16809333212661, "num_env_steps_sampled": 5000.0, "num_episodes": 100.0, "rlmodule_inference_timer": 0.00010438863757993124, "episode_return_mean": 6.5, "episode_len_min": 50, "episode_return_min": -5.5, "num_agent_steps_sampled": {"default_agent": 5000.0}, "episode_len_mean": 50.0, "env_to_module_sum_episodes_length_out": 27.16809333212661, "num_env_steps_sampled_lifetime": -475000.0, "num_env_steps_sampled_lifetime_throughput": 1250.1845167394445}, "learners": {"default_policy": {"total_loss": 0.2274145781993866, "weights_seq_no": 4.0, "num_trainable_parameters": 12511, "curr_kl_coeff": 0.01746346615254879, "curr_entropy_coeff": 0.0279062776126, "policy_loss": 0.02963423915207386, "mean_kl_loss": 0.006876958999782801, "num_module_steps_trained": 16000, "gradients_default_optimizer_global_norm": 0.34719935059547424, "entropy": 0.6458526849746704, "default_optimizer_learning_rate": 0.003818468248, "vf_loss": 0.28885889053344727, "vf_loss_unclipped": 11.11960506439209, "module_train_batch_size_mean": 1000.0, "diff_num_grad_updates_vs_sampler_policy": 1.0, "num_module_steps_trained_lifetime": 64000, "vf_explained_var": 0.7215078473091125, "num_module_steps_trained_lifetime_throughput": 197044.94400190414}, "__all_modules__": {"num_env_steps_trained": 81600, "learner_connector": {"timers": {"connectors": {"batch_individual_items": 0.19609456166069597, "general_advantage_estimation": 0.014693494264865098, "add_states_from_episodes_to_batch": 6.0396699664147485e-06, "add_one_ts_to_episodes_and_truncate": 0.008483267515453582, "add_time_dim_to_batch_and_zero_pad": 2.3258558811664896e-05, "add_observations_from_episodes_to_batch": 0.0007938980307115143, "add_columns_from_episodes_to_train_batch": 0.06958371375199679, "numpy_to_tensor": 0.0001631075362547749}}, "connector_pipeline_timer": 0.2902095633673703}, "num_module_steps_trained": 16000, "num_module_steps_trained_lifetime": 64000, "learner_connector_sum_episodes_length_in": 5000.0, "num_env_steps_trained_lifetime": 326400, "num_non_trainable_parameters": 0, "num_trainable_parameters": 12511, "learner_connector_sum_episodes_length_out": 5100.0, "num_env_steps_trained_lifetime_throughput": 1001177.807350366, "num_module_steps_trained_throughput": 196789.62914313073, "num_module_steps_trained_lifetime_throughput": 196694.12587050506}}, "num_training_step_calls_per_iteration": 1, "evaluation": {"env_runners": {"env_reset_timer": 0.00028388294538816224, "module_to_env_connector": {"timers": {"connectors": {"un_batch_to_individual_items": 1.6354057086819053e-05, "tensor_to_numpy": 4.642838954837939e-05, "remove_single_ts_time_rank_from_batch": 1.4579274213875645e-06, "listify_data_for_vector_env": 3.160630340016889e-05, "get_actions": 0.00015712268445854433, "normalize_and_clip_actions": 2.2319442998996303e-05}}, "connector_pipeline_timer": 0.00034985059652560313}, "episode_duration_sec_mean": 0.03578479629999833, "sample": 0.7248628611966565, "num_agent_steps_sampled": {"default_agent": 1000}, "num_episodes_lifetime": 80, "num_episodes": 20, "num_module_steps_sampled_lifetime": {"default_policy": 4000}, "num_module_steps_sampled": {"default_policy": 1000}, "env_to_module_sum_episodes_length_out": 27.168093332126602, "env_to_module_connector": {"timers": {"connectors": {"batch_individual_items": 1.8394038695903795e-05, "add_states_from_episodes_to_batch": 3.5216123040586393e-06, "add_observations_from_episodes_to_batch": 6.275018565459168e-06, "add_time_dim_to_batch_and_zero_pad": 5.403478179607811e-06, "numpy_to_tensor": 2.9504379090356e-05}}, "connector_pipeline_timer": 0.00011531233088289253}, "agent_episode_returns_mean": {"default_agent": -0.9}, "num_agent_steps_sampled_lifetime": {"default_agent": 4000}, "weights_seq_no": 4.0, "episode_return_max": 17.5, "episode_return_mean": -0.9, "episode_return_min": -16.5, "episode_len_mean": 50.0, "env_step_timer": 4.243468819061743e-05, "episode_len_max": 50, "env_to_module_sum_episodes_length_in": 27.168093332126602, "module_episode_returns_mean": {"default_policy": -0.9}, "episode_len_min": 50, "rlmodule_inference_timer": 9.824583271797505e-05, "num_env_steps_sampled": 1000, "num_env_steps_sampled_lifetime": 21000, "time_between_sampling": 4.285345909997031}, "num_healthy_workers": 1, "actor_manager_num_outstanding_async_reqs": 0, "num_remote_worker_restarts": 0}, "num_env_steps_sampled_lifetime": -475000.0, "fault_tolerance": {"num_healthy_workers": 0, "num_remote_worker_restarts": 0}, "env_runner_group": {"actor_manager_num_outstanding_async_reqs": 0}, "done": false, "training_iteration": 4, "trial_id": "42e43_00000", "date": "2025-08-11_16-37-23", "timestamp": 1754923043, "time_this_iter_s": 5.183476686477661, "time_total_s": 20.38281011581421, "pid": 34665, "hostname": "DESKTOP-3SK5A41", "node_ip": "192.168.40.242", "config": {"exploration_config": {}, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 6, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "env": "Umbrella", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": false, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 0, "create_local_env_runner": true, "num_envs_per_env_runner": 1, "gym_env_vectorize_mode": "SYNC", "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "episodes_to_numpy": true, "max_requests_in_flight_per_env_runner": 1, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "merge_env_runner_states": "training_only", "broadcast_env_runner_states": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "complete_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "sampler_perf_stats_ema_coef": null, "_is_online": true, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": "auto", "num_aggregator_actors_per_learner": 0, "max_requests_in_flight_per_aggregator_actor": 3, "local_gpu_idx": 0, "max_requests_in_flight_per_learner": 3, "gamma": 1, "lr": 0.003818468248, "grad_clip": 0.5, "grad_clip_by": "global_norm", "_train_batch_size_per_learner": 5000, "train_batch_size": 4000, "num_epochs": 3, "minibatch_size": 1000, "shuffle_batch_per_epoch": true, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "log_std_clip_param": 20.0, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "_disable_preprocessor_api": false, "_disable_action_flattening": false}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "_learner_class": null, "callbacks_on_algorithm_init": null, "callbacks_on_env_runners_recreated": null, "callbacks_on_offline_eval_runners_recreated": null, "callbacks_on_checkpoint_loaded": null, "callbacks_on_environment_created": null, "callbacks_on_episode_created": null, "callbacks_on_episode_start": null, "callbacks_on_episode_step": null, "callbacks_on_episode_end": null, "callbacks_on_evaluate_start": null, "callbacks_on_evaluate_end": null, "callbacks_on_evaluate_offline_start": null, "callbacks_on_evaluate_offline_end": null, "callbacks_on_sample_end": null, "callbacks_on_train_result": null, "explore": true, "enable_rl_module_and_learner": true, "enable_env_runner_and_connector_v2": true, "_prior_exploration_config": {"type": "StochasticSampling"}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7f7fc7f76ac0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "offline_data_class": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_read_batch_size": null, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "materialize_data": false, "materialize_mapped_data": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "ignore_final_observation": false, "prelearner_class": null, "prelearner_buffer_class": null, "prelearner_buffer_kwargs": {}, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_remaining_data": false, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": 1, "evaluation_duration": 20, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_auto_duration_min_env_steps_per_sample": 100, "evaluation_auto_duration_max_env_steps_per_sample": 2000, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 1, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "offline_evaluation_interval": null, "num_offline_eval_runners": 0, "offline_loss_for_module_fn": null, "offline_evaluation_duration": 1, "offline_evaluation_parallel_to_training": false, "offline_evaluation_timeout_s": 120.0, "num_cpus_per_offline_eval_runner": 1, "num_gpus_per_offline_eval_runner": 0, "custom_resources_per_offline_eval_runner": {}, "restart_failed_offline_eval_runners": true, "ignore_offline_eval_runner_failures": false, "max_num_offline_eval_runner_restarts": 1000, "offline_eval_runner_restore_timeout_s": 1800.0, "max_requests_in_flight_per_offline_eval_runner": 1, "validate_offline_eval_runners_after_construction": true, "offline_eval_runner_health_probe_timeout_s": 30.0, "offline_eval_rl_module_inference_only": false, "broadcast_offline_eval_runner_states": false, "offline_eval_batch_size_per_runner": 256, "dataset_num_iters_per_eval_runner": 1, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "log_gradients": true, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 42, "restart_failed_env_runners": true, "ignore_env_runner_failures": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30.0, "env_runner_restore_timeout_s": 1800.0, "_model_config": {}, "_rl_module_spec": "RLModuleSpec(module_class=None, observation_space=None, action_space=None, inference_only=False, learner_only=False, model_config=DefaultModelConfig(fcnet_hiddens=[120, 97], fcnet_activation='tanh', fcnet_kernel_initializer=None, fcnet_kernel_initializer_kwargs=None, fcnet_bias_initializer=None, fcnet_bias_initializer_kwargs=None, conv_filters=None, conv_activation='relu', conv_kernel_initializer=None, conv_kernel_initializer_kwargs=None, conv_bias_initializer=None, conv_bias_initializer_kwargs=None, head_fcnet_hiddens=[], head_fcnet_activation='relu', head_fcnet_kernel_initializer=None, head_fcnet_kernel_initializer_kwargs=None, head_fcnet_bias_initializer=None, head_fcnet_bias_initializer_kwargs=None, free_log_std=False, log_std_clip_param=20.0, vf_share_layers=True, use_lstm=False, max_seq_len=20, lstm_cell_size=256, lstm_use_prev_action=False, lstm_use_prev_reward=False, lstm_kernel_initializer=None, lstm_kernel_initializer_kwargs=None, lstm_bias_initializer=None, lstm_bias_initializer_kwargs=None), catalog_class=None, load_state_path=None, model_config_dict=None)", "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "_validate_config": true, "_use_msgpack_checkpoints": false, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "env_task_fn": -1, "enable_connectors": -1, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2794154475684, "kl_target": 0.0205400882743, "vf_loss_coeff": 0.7462588469094, "entropy_coeff": 0.0279062776126, "clip_param": 0.2400715659946, "vf_clip_param": 0.4568186220708, "entropy_coeff_schedule": null, "lr_schedule": null, "sgd_minibatch_size": -1, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9330944222753, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.callbacks.callbacks.RLlibCallback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 20.38281011581421, "iterations_since_restore": 4, "perf": {"cpu_util_percent": 12.1375, "ram_util_percent": 71.975}}
{"timers": {"training_iteration": 4.283083342010798, "restore_env_runners": 1.3681712869679728e-05, "training_step": 4.282850396934245, "env_runner_sampling_timer": 3.830818818772188, "learner_update_timer": 0.44826130552799787, "synch_weights": 0.0015692059528727537, "restore_eval_env_runners": 1.5579268991802558e-05, "evaluation_iteration": 0.7373052505118024, "synch_eval_env_connectors": 0.0005098470229274639, "synch_env_connectors": 7.790099622295658e-06}, "env_runners": {"module_to_env_connector": {"timers": {"connectors": {"un_batch_to_individual_items": 1.5053998324963526e-05, "tensor_to_numpy": 4.994704371828578e-05, "normalize_and_clip_actions": 2.246596017286856e-05, "listify_data_for_vector_env": 3.1167370673470245e-05, "remove_single_ts_time_rank_from_batch": 1.4695965197190103e-06, "get_actions": 0.0001657817218606569}}, "connector_pipeline_timer": 0.00036286747561607664}, "num_module_steps_sampled_lifetime": {"default_policy": -717500.0}, "env_reset_timer": 0.0001004967281990946, "module_episode_returns_mean": {"default_policy": 8.700000000000003}, "env_to_module_connector": {"connector_pipeline_timer": 0.00011988877592864722, "timers": {"connectors": {"add_observations_from_episodes_to_batch": 6.454942073302275e-06, "batch_individual_items": 1.8790900434730475e-05, "numpy_to_tensor": 3.168134230991052e-05, "add_time_dim_to_batch_and_zero_pad": 6.252348454814333e-06, "add_states_from_episodes_to_batch": 3.4914612884339775e-06}}}, "weights_seq_no": 4.0, "num_module_steps_sampled": {"default_policy": 5000.0}, "episode_duration_sec_mean": 0.03683670310003889, "sample": 0.03861855385771311, "env_step_timer": 4.398366680418389e-05, "episode_return_max": 14.5, "episode_len_max": 50, "time_between_sampling": 0.01292582033987184, "num_episodes_lifetime": -14350.0, "agent_episode_returns_mean": {"default_agent": 8.700000000000003}, "num_agent_steps_sampled_lifetime": {"default_agent": -717500.0}, "env_to_module_sum_episodes_length_in": 27.16809333212661, "num_env_steps_sampled": 5000.0, "num_episodes": 100.0, "rlmodule_inference_timer": 0.00010235083891196346, "episode_return_mean": 8.700000000000003, "episode_len_min": 50, "episode_return_min": -5.5, "num_agent_steps_sampled": {"default_agent": 5000.0}, "episode_len_mean": 50.0, "env_to_module_sum_episodes_length_out": 27.16809333212661, "num_env_steps_sampled_lifetime": -717500.0, "num_env_steps_sampled_lifetime_throughput": 1267.8981741957587}, "learners": {"default_policy": {"total_loss": 0.23085151612758636, "weights_seq_no": 5.0, "num_trainable_parameters": 12511, "curr_kl_coeff": 0.008731733076274395, "curr_entropy_coeff": 0.0279062776126, "policy_loss": 0.021598318591713905, "mean_kl_loss": 0.003153068944811821, "num_module_steps_trained": 16000, "gradients_default_optimizer_global_norm": 0.28959405422210693, "entropy": 0.6292685270309448, "default_optimizer_learning_rate": 0.003818468248, "vf_loss": 0.303860604763031, "vf_loss_unclipped": 14.103873252868652, "module_train_batch_size_mean": 1000.0, "diff_num_grad_updates_vs_sampler_policy": 1.0, "num_module_steps_trained_lifetime": 80000, "vf_explained_var": 0.6575260162353516, "num_module_steps_trained_lifetime_throughput": 196728.5078429863}, "__all_modules__": {"num_env_steps_trained": 81600, "learner_connector": {"timers": {"connectors": {"batch_individual_items": 0.19471524304408586, "general_advantage_estimation": 0.014649354322214415, "add_states_from_episodes_to_batch": 6.030273264007041e-06, "add_one_ts_to_episodes_and_truncate": 0.008480062840297136, "add_time_dim_to_batch_and_zero_pad": 2.321997322283107e-05, "add_observations_from_episodes_to_batch": 0.0007929120504062849, "add_columns_from_episodes_to_train_batch": 0.06957623962447601, "numpy_to_tensor": 0.00016315146089084033}}, "connector_pipeline_timer": 0.28877375574369335}, "num_module_steps_trained": 16000, "num_module_steps_trained_lifetime": 80000, "learner_connector_sum_episodes_length_in": 5000.0, "num_env_steps_trained_lifetime": 408000, "num_non_trainable_parameters": 0, "num_trainable_parameters": 12511, "learner_connector_sum_episodes_length_out": 5100.0, "num_env_steps_trained_lifetime_throughput": 999744.5537486261, "num_module_steps_trained_throughput": 196489.32657199932, "num_module_steps_trained_lifetime_throughput": 196396.55598528372}}, "num_training_step_calls_per_iteration": 1, "evaluation": {"env_runners": {"env_reset_timer": 0.0002822741159368595, "module_to_env_connector": {"timers": {"connectors": {"un_batch_to_individual_items": 1.5389685563509083e-05, "tensor_to_numpy": 4.565103270927245e-05, "remove_single_ts_time_rank_from_batch": 1.3886658390963398e-06, "listify_data_for_vector_env": 3.135409124786273e-05, "get_actions": 0.00015513849227203412, "normalize_and_clip_actions": 2.1974204163885356e-05}}, "connector_pipeline_timer": 0.0003444365386115906}, "episode_duration_sec_mean": 0.03558385811000335, "sample": 0.7248538406646889, "num_agent_steps_sampled": {"default_agent": 1000}, "num_episodes_lifetime": 100, "num_episodes": 20, "num_module_steps_sampled_lifetime": {"default_policy": 5000}, "num_module_steps_sampled": {"default_policy": 1000}, "env_to_module_sum_episodes_length_out": 27.168093332126602, "env_to_module_connector": {"timers": {"connectors": {"batch_individual_items": 1.8213983425510015e-05, "add_states_from_episodes_to_batch": 3.7920269172395227e-06, "add_observations_from_episodes_to_batch": 6.195419018581412e-06, "add_time_dim_to_batch_and_zero_pad": 5.435919120991561e-06, "numpy_to_tensor": 2.9212569100672892e-05}}, "connector_pipeline_timer": 0.00011270101112365807}, "agent_episode_returns_mean": {"default_agent": -1.3}, "num_agent_steps_sampled_lifetime": {"default_agent": 5000}, "weights_seq_no": 5.0, "episode_return_max": 17.5, "episode_return_mean": -1.3, "episode_return_min": -16.5, "episode_len_mean": 50.0, "env_step_timer": 4.329579961116548e-05, "episode_len_max": 50, "env_to_module_sum_episodes_length_in": 27.168093332126602, "module_episode_returns_mean": {"default_policy": -1.3}, "episode_len_min": 50, "rlmodule_inference_timer": 9.428937165765912e-05, "num_env_steps_sampled": 1000, "num_env_steps_sampled_lifetime": 26000, "time_between_sampling": 4.28480942202706}, "num_healthy_workers": 1, "actor_manager_num_outstanding_async_reqs": 0, "num_remote_worker_restarts": 0}, "num_env_steps_sampled_lifetime": -717500.0, "fault_tolerance": {"num_healthy_workers": 0, "num_remote_worker_restarts": 0}, "env_runner_group": {"actor_manager_num_outstanding_async_reqs": 0}, "done": false, "training_iteration": 5, "trial_id": "42e43_00000", "date": "2025-08-11_16-37-28", "timestamp": 1754923048, "time_this_iter_s": 4.911534547805786, "time_total_s": 25.294344663619995, "pid": 34665, "hostname": "DESKTOP-3SK5A41", "node_ip": "192.168.40.242", "config": {"exploration_config": {}, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 6, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "env": "Umbrella", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": false, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 0, "create_local_env_runner": true, "num_envs_per_env_runner": 1, "gym_env_vectorize_mode": "SYNC", "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "episodes_to_numpy": true, "max_requests_in_flight_per_env_runner": 1, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "merge_env_runner_states": "training_only", "broadcast_env_runner_states": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "complete_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "sampler_perf_stats_ema_coef": null, "_is_online": true, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": "auto", "num_aggregator_actors_per_learner": 0, "max_requests_in_flight_per_aggregator_actor": 3, "local_gpu_idx": 0, "max_requests_in_flight_per_learner": 3, "gamma": 1, "lr": 0.003818468248, "grad_clip": 0.5, "grad_clip_by": "global_norm", "_train_batch_size_per_learner": 5000, "train_batch_size": 4000, "num_epochs": 3, "minibatch_size": 1000, "shuffle_batch_per_epoch": true, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "log_std_clip_param": 20.0, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "_disable_preprocessor_api": false, "_disable_action_flattening": false}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "_learner_class": null, "callbacks_on_algorithm_init": null, "callbacks_on_env_runners_recreated": null, "callbacks_on_offline_eval_runners_recreated": null, "callbacks_on_checkpoint_loaded": null, "callbacks_on_environment_created": null, "callbacks_on_episode_created": null, "callbacks_on_episode_start": null, "callbacks_on_episode_step": null, "callbacks_on_episode_end": null, "callbacks_on_evaluate_start": null, "callbacks_on_evaluate_end": null, "callbacks_on_evaluate_offline_start": null, "callbacks_on_evaluate_offline_end": null, "callbacks_on_sample_end": null, "callbacks_on_train_result": null, "explore": true, "enable_rl_module_and_learner": true, "enable_env_runner_and_connector_v2": true, "_prior_exploration_config": {"type": "StochasticSampling"}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7f7fc7f76ac0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "offline_data_class": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_read_batch_size": null, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "materialize_data": false, "materialize_mapped_data": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "ignore_final_observation": false, "prelearner_class": null, "prelearner_buffer_class": null, "prelearner_buffer_kwargs": {}, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_remaining_data": false, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": 1, "evaluation_duration": 20, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_auto_duration_min_env_steps_per_sample": 100, "evaluation_auto_duration_max_env_steps_per_sample": 2000, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 1, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "offline_evaluation_interval": null, "num_offline_eval_runners": 0, "offline_loss_for_module_fn": null, "offline_evaluation_duration": 1, "offline_evaluation_parallel_to_training": false, "offline_evaluation_timeout_s": 120.0, "num_cpus_per_offline_eval_runner": 1, "num_gpus_per_offline_eval_runner": 0, "custom_resources_per_offline_eval_runner": {}, "restart_failed_offline_eval_runners": true, "ignore_offline_eval_runner_failures": false, "max_num_offline_eval_runner_restarts": 1000, "offline_eval_runner_restore_timeout_s": 1800.0, "max_requests_in_flight_per_offline_eval_runner": 1, "validate_offline_eval_runners_after_construction": true, "offline_eval_runner_health_probe_timeout_s": 30.0, "offline_eval_rl_module_inference_only": false, "broadcast_offline_eval_runner_states": false, "offline_eval_batch_size_per_runner": 256, "dataset_num_iters_per_eval_runner": 1, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "log_gradients": true, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 42, "restart_failed_env_runners": true, "ignore_env_runner_failures": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30.0, "env_runner_restore_timeout_s": 1800.0, "_model_config": {}, "_rl_module_spec": "RLModuleSpec(module_class=None, observation_space=None, action_space=None, inference_only=False, learner_only=False, model_config=DefaultModelConfig(fcnet_hiddens=[120, 97], fcnet_activation='tanh', fcnet_kernel_initializer=None, fcnet_kernel_initializer_kwargs=None, fcnet_bias_initializer=None, fcnet_bias_initializer_kwargs=None, conv_filters=None, conv_activation='relu', conv_kernel_initializer=None, conv_kernel_initializer_kwargs=None, conv_bias_initializer=None, conv_bias_initializer_kwargs=None, head_fcnet_hiddens=[], head_fcnet_activation='relu', head_fcnet_kernel_initializer=None, head_fcnet_kernel_initializer_kwargs=None, head_fcnet_bias_initializer=None, head_fcnet_bias_initializer_kwargs=None, free_log_std=False, log_std_clip_param=20.0, vf_share_layers=True, use_lstm=False, max_seq_len=20, lstm_cell_size=256, lstm_use_prev_action=False, lstm_use_prev_reward=False, lstm_kernel_initializer=None, lstm_kernel_initializer_kwargs=None, lstm_bias_initializer=None, lstm_bias_initializer_kwargs=None), catalog_class=None, load_state_path=None, model_config_dict=None)", "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "_validate_config": true, "_use_msgpack_checkpoints": false, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "env_task_fn": -1, "enable_connectors": -1, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2794154475684, "kl_target": 0.0205400882743, "vf_loss_coeff": 0.7462588469094, "entropy_coeff": 0.0279062776126, "clip_param": 0.2400715659946, "vf_clip_param": 0.4568186220708, "entropy_coeff_schedule": null, "lr_schedule": null, "sgd_minibatch_size": -1, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9330944222753, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.callbacks.callbacks.RLlibCallback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 25.294344663619995, "iterations_since_restore": 5, "perf": {"cpu_util_percent": 12.314285714285713, "ram_util_percent": 71.85714285714285}}
{"timers": {"training_iteration": 4.28303254105069, "restore_env_runners": 1.3650895743216416e-05, "training_step": 4.282798100424904, "env_runner_sampling_timer": 3.8314312779944664, "learner_update_timer": 0.4475952855127188, "synch_weights": 0.0015672399033413254, "restore_eval_env_runners": 1.552347630390579e-05, "evaluation_iteration": 0.7372657790866816, "synch_eval_env_connectors": 0.0005084295527010601, "synch_env_connectors": 7.77619862682061e-06}, "env_runners": {"module_to_env_connector": {"timers": {"connectors": {"un_batch_to_individual_items": 1.4984947939693969e-05, "tensor_to_numpy": 4.955851721901219e-05, "normalize_and_clip_actions": 2.2178745247074274e-05, "listify_data_for_vector_env": 3.081757018557522e-05, "remove_single_ts_time_rank_from_batch": 1.4830092941166829e-06, "get_actions": 0.00016368303293251763}}, "connector_pipeline_timer": 0.00035899959348728995}, "num_module_steps_sampled_lifetime": {"default_policy": -960000.0}, "env_reset_timer": 9.639664685204822e-05, "module_episode_returns_mean": {"default_policy": 11.299999999999997}, "env_to_module_connector": {"connector_pipeline_timer": 0.00011851377587783576, "timers": {"connectors": {"add_observations_from_episodes_to_batch": 6.389400164244853e-06, "batch_individual_items": 1.8644806818890502e-05, "numpy_to_tensor": 3.134459890471177e-05, "add_time_dim_to_batch_and_zero_pad": 6.195034215639024e-06, "add_states_from_episodes_to_batch": 3.424798858534961e-06}}}, "weights_seq_no": 5.0, "num_module_steps_sampled": {"default_policy": 5000.0}, "episode_duration_sec_mean": 0.03641475337002703, "sample": 0.037911218428026666, "env_step_timer": 4.330165593093605e-05, "episode_return_max": 14.5, "episode_len_max": 50, "time_between_sampling": 0.012071876562929186, "num_episodes_lifetime": -19200.0, "agent_episode_returns_mean": {"default_agent": 11.299999999999997}, "num_agent_steps_sampled_lifetime": {"default_agent": -960000.0}, "env_to_module_sum_episodes_length_in": 27.16809333212661, "num_env_steps_sampled": 5000.0, "num_episodes": 100.0, "rlmodule_inference_timer": 0.00010152590289784616, "episode_return_mean": 11.299999999999997, "episode_len_min": 50, "episode_return_min": -5.5, "num_agent_steps_sampled": {"default_agent": 5000.0}, "episode_len_mean": 50.0, "env_to_module_sum_episodes_length_out": 27.16809333212661, "num_env_steps_sampled_lifetime": -960000.0, "num_env_steps_sampled_lifetime_throughput": 1283.5836321936256}, "learners": {"default_policy": {"total_loss": 0.2918970584869385, "weights_seq_no": 6.0, "num_trainable_parameters": 12511, "curr_kl_coeff": 0.0043658665381371975, "curr_entropy_coeff": 0.0279062776126, "policy_loss": 0.07591047137975693, "mean_kl_loss": 0.008181132376194, "num_module_steps_trained": 16000, "gradients_default_optimizer_global_norm": 0.24412661790847778, "entropy": 0.5880230069160461, "default_optimizer_learning_rate": 0.003818468248, "vf_loss": 0.31131914258003235, "vf_loss_unclipped": 14.418774604797363, "module_train_batch_size_mean": 1000.0, "diff_num_grad_updates_vs_sampler_policy": 1.0, "num_module_steps_trained_lifetime": 96000, "vf_explained_var": 0.5550282597541809, "num_module_steps_trained_lifetime_throughput": 196134.8812582376}, "__all_modules__": {"num_env_steps_trained": 81600, "learner_connector": {"timers": {"connectors": {"batch_individual_items": 0.1947604736336464, "general_advantage_estimation": 0.0146229367889905, "add_states_from_episodes_to_batch": 6.038970529260085e-06, "add_one_ts_to_episodes_and_truncate": 0.008476214221892492, "add_time_dim_to_batch_and_zero_pad": 2.330677349127529e-05, "add_observations_from_episodes_to_batch": 0.0007916529299047087, "add_columns_from_episodes_to_train_batch": 0.06957267322823121, "numpy_to_tensor": 0.00016337894628099008}}, "connector_pipeline_timer": 0.2887835962262579}, "num_module_steps_trained": 16000, "num_module_steps_trained_lifetime": 96000, "learner_connector_sum_episodes_length_in": 5000.0, "num_env_steps_trained_lifetime": 489600, "num_non_trainable_parameters": 0, "num_trainable_parameters": 12511, "learner_connector_sum_episodes_length_out": 5100.0, "num_env_steps_trained_lifetime_throughput": 996891.6013085836, "num_module_steps_trained_throughput": 195912.29197817278, "num_module_steps_trained_lifetime_throughput": 195823.0088690785}}, "num_training_step_calls_per_iteration": 1, "evaluation": {"env_runners": {"env_reset_timer": 0.0002807023747762651, "module_to_env_connector": {"timers": {"connectors": {"un_batch_to_individual_items": 1.56374451679216e-05, "tensor_to_numpy": 4.505239843175633e-05, "remove_single_ts_time_rank_from_batch": 1.4538519575074768e-06, "listify_data_for_vector_env": 2.9526429585867728e-05, "get_actions": 0.00015278812144564675, "normalize_and_clip_actions": 2.1939099193062866e-05}}, "connector_pipeline_timer": 0.0003391810333085655}, "episode_duration_sec_mean": 0.03556902622002326, "sample": 0.7248228973280387, "num_agent_steps_sampled": {"default_agent": 1000}, "num_episodes_lifetime": 120, "num_episodes": 20, "num_module_steps_sampled_lifetime": {"default_policy": 6000}, "num_module_steps_sampled": {"default_policy": 1000}, "env_to_module_sum_episodes_length_out": 27.168093332126602, "env_to_module_connector": {"timers": {"connectors": {"batch_individual_items": 1.8226490623879317e-05, "add_states_from_episodes_to_batch": 3.319520090184041e-06, "add_observations_from_episodes_to_batch": 6.287298448489032e-06, "add_time_dim_to_batch_and_zero_pad": 5.802459372028097e-06, "numpy_to_tensor": 2.9209913062629178e-05}}, "connector_pipeline_timer": 0.00011385371759165788}, "agent_episode_returns_mean": {"default_agent": -1.1}, "num_agent_steps_sampled_lifetime": {"default_agent": 6000}, "weights_seq_no": 6.0, "episode_return_max": 17.5, "episode_return_mean": -1.1, "episode_return_min": -16.5, "episode_len_mean": 50.0, "env_step_timer": 4.154798358655066e-05, "episode_len_max": 50, "env_to_module_sum_episodes_length_in": 27.168093332126602, "module_episode_returns_mean": {"default_policy": -1.1}, "episode_len_min": 50, "rlmodule_inference_timer": 9.300595477827228e-05, "num_env_steps_sampled": 1000, "num_env_steps_sampled_lifetime": 31000, "time_between_sampling": 4.28528281626679}, "num_healthy_workers": 1, "actor_manager_num_outstanding_async_reqs": 0, "num_remote_worker_restarts": 0}, "num_env_steps_sampled_lifetime": -960000.0, "fault_tolerance": {"num_healthy_workers": 0, "num_remote_worker_restarts": 0}, "env_runner_group": {"actor_manager_num_outstanding_async_reqs": 0}, "done": false, "training_iteration": 6, "trial_id": "42e43_00000", "date": "2025-08-11_16-37-33", "timestamp": 1754923053, "time_this_iter_s": 5.014664649963379, "time_total_s": 30.309009313583374, "pid": 34665, "hostname": "DESKTOP-3SK5A41", "node_ip": "192.168.40.242", "config": {"exploration_config": {}, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 6, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "env": "Umbrella", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": false, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 0, "create_local_env_runner": true, "num_envs_per_env_runner": 1, "gym_env_vectorize_mode": "SYNC", "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "episodes_to_numpy": true, "max_requests_in_flight_per_env_runner": 1, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "merge_env_runner_states": "training_only", "broadcast_env_runner_states": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "complete_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "sampler_perf_stats_ema_coef": null, "_is_online": true, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": "auto", "num_aggregator_actors_per_learner": 0, "max_requests_in_flight_per_aggregator_actor": 3, "local_gpu_idx": 0, "max_requests_in_flight_per_learner": 3, "gamma": 1, "lr": 0.003818468248, "grad_clip": 0.5, "grad_clip_by": "global_norm", "_train_batch_size_per_learner": 5000, "train_batch_size": 4000, "num_epochs": 3, "minibatch_size": 1000, "shuffle_batch_per_epoch": true, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "log_std_clip_param": 20.0, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "_disable_preprocessor_api": false, "_disable_action_flattening": false}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "_learner_class": null, "callbacks_on_algorithm_init": null, "callbacks_on_env_runners_recreated": null, "callbacks_on_offline_eval_runners_recreated": null, "callbacks_on_checkpoint_loaded": null, "callbacks_on_environment_created": null, "callbacks_on_episode_created": null, "callbacks_on_episode_start": null, "callbacks_on_episode_step": null, "callbacks_on_episode_end": null, "callbacks_on_evaluate_start": null, "callbacks_on_evaluate_end": null, "callbacks_on_evaluate_offline_start": null, "callbacks_on_evaluate_offline_end": null, "callbacks_on_sample_end": null, "callbacks_on_train_result": null, "explore": true, "enable_rl_module_and_learner": true, "enable_env_runner_and_connector_v2": true, "_prior_exploration_config": {"type": "StochasticSampling"}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7f7fc7f76ac0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "offline_data_class": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_read_batch_size": null, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "materialize_data": false, "materialize_mapped_data": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "ignore_final_observation": false, "prelearner_class": null, "prelearner_buffer_class": null, "prelearner_buffer_kwargs": {}, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_remaining_data": false, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": 1, "evaluation_duration": 20, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_auto_duration_min_env_steps_per_sample": 100, "evaluation_auto_duration_max_env_steps_per_sample": 2000, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 1, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "offline_evaluation_interval": null, "num_offline_eval_runners": 0, "offline_loss_for_module_fn": null, "offline_evaluation_duration": 1, "offline_evaluation_parallel_to_training": false, "offline_evaluation_timeout_s": 120.0, "num_cpus_per_offline_eval_runner": 1, "num_gpus_per_offline_eval_runner": 0, "custom_resources_per_offline_eval_runner": {}, "restart_failed_offline_eval_runners": true, "ignore_offline_eval_runner_failures": false, "max_num_offline_eval_runner_restarts": 1000, "offline_eval_runner_restore_timeout_s": 1800.0, "max_requests_in_flight_per_offline_eval_runner": 1, "validate_offline_eval_runners_after_construction": true, "offline_eval_runner_health_probe_timeout_s": 30.0, "offline_eval_rl_module_inference_only": false, "broadcast_offline_eval_runner_states": false, "offline_eval_batch_size_per_runner": 256, "dataset_num_iters_per_eval_runner": 1, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "log_gradients": true, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 42, "restart_failed_env_runners": true, "ignore_env_runner_failures": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30.0, "env_runner_restore_timeout_s": 1800.0, "_model_config": {}, "_rl_module_spec": "RLModuleSpec(module_class=None, observation_space=None, action_space=None, inference_only=False, learner_only=False, model_config=DefaultModelConfig(fcnet_hiddens=[120, 97], fcnet_activation='tanh', fcnet_kernel_initializer=None, fcnet_kernel_initializer_kwargs=None, fcnet_bias_initializer=None, fcnet_bias_initializer_kwargs=None, conv_filters=None, conv_activation='relu', conv_kernel_initializer=None, conv_kernel_initializer_kwargs=None, conv_bias_initializer=None, conv_bias_initializer_kwargs=None, head_fcnet_hiddens=[], head_fcnet_activation='relu', head_fcnet_kernel_initializer=None, head_fcnet_kernel_initializer_kwargs=None, head_fcnet_bias_initializer=None, head_fcnet_bias_initializer_kwargs=None, free_log_std=False, log_std_clip_param=20.0, vf_share_layers=True, use_lstm=False, max_seq_len=20, lstm_cell_size=256, lstm_use_prev_action=False, lstm_use_prev_reward=False, lstm_kernel_initializer=None, lstm_kernel_initializer_kwargs=None, lstm_bias_initializer=None, lstm_bias_initializer_kwargs=None), catalog_class=None, load_state_path=None, model_config_dict=None)", "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "_validate_config": true, "_use_msgpack_checkpoints": false, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "env_task_fn": -1, "enable_connectors": -1, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2794154475684, "kl_target": 0.0205400882743, "vf_loss_coeff": 0.7462588469094, "entropy_coeff": 0.0279062776126, "clip_param": 0.2400715659946, "vf_clip_param": 0.4568186220708, "entropy_coeff_schedule": null, "lr_schedule": null, "sgd_minibatch_size": -1, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9330944222753, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.callbacks.callbacks.RLlibCallback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 30.309009313583374, "iterations_since_restore": 6, "perf": {"cpu_util_percent": 12.700000000000001, "ram_util_percent": 71.88571428571427}}
{"timers": {"training_iteration": 4.281861771750181, "restore_env_runners": 1.3924386783612235e-05, "training_step": 4.281625259530656, "env_runner_sampling_timer": 3.832400431324522, "learner_update_timer": 0.44545323465759196, "synch_weights": 0.0015672935043093623, "restore_eval_env_runners": 1.547724153865886e-05, "evaluation_iteration": 0.7372086033658131, "synch_eval_env_connectors": 0.0005072382571722924, "synch_env_connectors": 7.76443664288688e-06}, "env_runners": {"module_to_env_connector": {"timers": {"connectors": {"un_batch_to_individual_items": 1.5058979361313644e-05, "tensor_to_numpy": 4.993428277264443e-05, "normalize_and_clip_actions": 2.2301466303822407e-05, "listify_data_for_vector_env": 3.1077231545019744e-05, "remove_single_ts_time_rank_from_batch": 1.4768807897610118e-06, "get_actions": 0.0001648830928401154}}, "connector_pipeline_timer": 0.0003616267777664172}, "num_module_steps_sampled_lifetime": {"default_policy": -1202500.0}, "env_reset_timer": 9.527224281266125e-05, "module_episode_returns_mean": {"default_policy": 12.5}, "env_to_module_connector": {"connector_pipeline_timer": 0.00011953726958063013, "timers": {"connectors": {"add_observations_from_episodes_to_batch": 6.385305524972783e-06, "batch_individual_items": 1.8781903443887032e-05, "numpy_to_tensor": 3.158591226821515e-05, "add_time_dim_to_batch_and_zero_pad": 6.283639427559346e-06, "add_states_from_episodes_to_batch": 3.498908460276197e-06}}}, "weights_seq_no": 6.0, "num_module_steps_sampled": {"default_policy": 5000.0}, "episode_duration_sec_mean": 0.036719556100006226, "sample": 0.03773171369611181, "env_step_timer": 4.340312663108179e-05, "episode_return_max": 14.5, "episode_len_max": 50, "time_between_sampling": 0.012710193433397531, "num_episodes_lifetime": -24050.0, "agent_episode_returns_mean": {"default_agent": 12.5}, "num_agent_steps_sampled_lifetime": {"default_agent": -1202500.0}, "env_to_module_sum_episodes_length_in": 27.16809333212661, "num_env_steps_sampled": 5000.0, "num_episodes": 100.0, "rlmodule_inference_timer": 0.00010187840383396139, "episode_return_mean": 12.5, "episode_len_min": 50, "episode_return_min": -5.5, "num_agent_steps_sampled": {"default_agent": 5000.0}, "episode_len_mean": 50.0, "env_to_module_sum_episodes_length_out": 27.16809333212661, "num_env_steps_sampled_lifetime": -1202500.0, "num_env_steps_sampled_lifetime_throughput": 1275.3151777227515}, "learners": {"default_policy": {"total_loss": 0.26630672812461853, "weights_seq_no": 7.0, "num_trainable_parameters": 12511, "curr_kl_coeff": 0.0021829332690685987, "curr_entropy_coeff": 0.0279062776126, "policy_loss": 0.04801194369792938, "mean_kl_loss": 0.006740483921021223, "num_module_steps_trained": 16000, "gradients_default_optimizer_global_norm": 0.09323954582214355, "entropy": 0.6189785599708557, "default_optimizer_learning_rate": 0.003818468248, "vf_loss": 0.3156260550022125, "vf_loss_unclipped": 17.182313919067383, "module_train_batch_size_mean": 1000.0, "diff_num_grad_updates_vs_sampler_policy": 1.0, "num_module_steps_trained_lifetime": 112000, "vf_explained_var": 0.2963517904281616, "num_module_steps_trained_lifetime_throughput": 195809.59547582356}, "__all_modules__": {"num_env_steps_trained": 81600, "learner_connector": {"timers": {"connectors": {"batch_individual_items": 0.19340380089731002, "general_advantage_estimation": 0.014593619421103734, "add_states_from_episodes_to_batch": 6.03158082281049e-06, "add_one_ts_to_episodes_and_truncate": 0.00847487907967769, "add_time_dim_to_batch_and_zero_pad": 2.328370575924294e-05, "add_observations_from_episodes_to_batch": 0.0007916154006054368, "add_columns_from_episodes_to_train_batch": 0.06958255849594593, "numpy_to_tensor": 0.00016342115681986042}}, "connector_pipeline_timer": 0.2874062492639928}, "num_module_steps_trained": 16000, "num_module_steps_trained_lifetime": 112000, "learner_connector_sum_episodes_length_in": 5000.0, "num_env_steps_trained_lifetime": 571200, "num_non_trainable_parameters": 0, "num_trainable_parameters": 12511, "learner_connector_sum_episodes_length_out": 5100.0, "num_env_steps_trained_lifetime_throughput": 995411.5033261564, "num_module_steps_trained_throughput": 195602.58716703267, "num_module_steps_trained_lifetime_throughput": 195516.57769477615}}, "num_training_step_calls_per_iteration": 1, "evaluation": {"env_runners": {"env_reset_timer": 0.00027909335102843365, "module_to_env_connector": {"timers": {"connectors": {"un_batch_to_individual_items": 1.5656155727279424e-05, "tensor_to_numpy": 4.5818814863276086e-05, "remove_single_ts_time_rank_from_batch": 1.517965845231462e-06, "listify_data_for_vector_env": 2.9795014845052693e-05, "get_actions": 0.00014927048270559803, "normalize_and_clip_actions": 2.1732754327155028e-05}}, "connector_pipeline_timer": 0.000335731512777083}, "episode_duration_sec_mean": 0.03534475117000511, "sample": 0.7247092323647609, "num_agent_steps_sampled": {"default_agent": 1000}, "num_episodes_lifetime": 140, "num_episodes": 20, "num_module_steps_sampled_lifetime": {"default_policy": 7000}, "num_module_steps_sampled": {"default_policy": 1000}, "env_to_module_sum_episodes_length_out": 27.168093332126602, "env_to_module_connector": {"timers": {"connectors": {"batch_individual_items": 1.737264418249087e-05, "add_states_from_episodes_to_batch": 3.209410620331583e-06, "add_observations_from_episodes_to_batch": 5.820059721858182e-06, "add_time_dim_to_batch_and_zero_pad": 5.13242121910503e-06, "numpy_to_tensor": 2.8544684569891825e-05}}, "connector_pipeline_timer": 0.00010911510530258005}, "agent_episode_returns_mean": {"default_agent": -2.1}, "num_agent_steps_sampled_lifetime": {"default_agent": 7000}, "weights_seq_no": 7.0, "episode_return_max": 17.5, "episode_return_mean": -2.1, "episode_return_min": -16.5, "episode_len_mean": 50.0, "env_step_timer": 4.130463313819978e-05, "episode_len_max": 50, "env_to_module_sum_episodes_length_in": 27.168093332126602, "module_episode_returns_mean": {"default_policy": -2.1}, "episode_len_min": 50, "rlmodule_inference_timer": 9.344731192494733e-05, "num_env_steps_sampled": 1000, "num_env_steps_sampled_lifetime": 36000, "time_between_sampling": 4.284617667224119}, "num_healthy_workers": 1, "actor_manager_num_outstanding_async_reqs": 0, "num_remote_worker_restarts": 0}, "num_env_steps_sampled_lifetime": -1202500.0, "fault_tolerance": {"num_healthy_workers": 0, "num_remote_worker_restarts": 0}, "env_runner_group": {"actor_manager_num_outstanding_async_reqs": 0}, "done": true, "training_iteration": 7, "trial_id": "42e43_00000", "date": "2025-08-11_16-37-38", "timestamp": 1754923058, "time_this_iter_s": 4.892789363861084, "time_total_s": 35.20179867744446, "pid": 34665, "hostname": "DESKTOP-3SK5A41", "node_ip": "192.168.40.242", "config": {"exploration_config": {}, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 6, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "env": "Umbrella", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": false, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 0, "create_local_env_runner": true, "num_envs_per_env_runner": 1, "gym_env_vectorize_mode": "SYNC", "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "episodes_to_numpy": true, "max_requests_in_flight_per_env_runner": 1, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "merge_env_runner_states": "training_only", "broadcast_env_runner_states": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "complete_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "sampler_perf_stats_ema_coef": null, "_is_online": true, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": "auto", "num_aggregator_actors_per_learner": 0, "max_requests_in_flight_per_aggregator_actor": 3, "local_gpu_idx": 0, "max_requests_in_flight_per_learner": 3, "gamma": 1, "lr": 0.003818468248, "grad_clip": 0.5, "grad_clip_by": "global_norm", "_train_batch_size_per_learner": 5000, "train_batch_size": 4000, "num_epochs": 3, "minibatch_size": 1000, "shuffle_batch_per_epoch": true, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "log_std_clip_param": 20.0, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "_disable_preprocessor_api": false, "_disable_action_flattening": false}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "_learner_class": null, "callbacks_on_algorithm_init": null, "callbacks_on_env_runners_recreated": null, "callbacks_on_offline_eval_runners_recreated": null, "callbacks_on_checkpoint_loaded": null, "callbacks_on_environment_created": null, "callbacks_on_episode_created": null, "callbacks_on_episode_start": null, "callbacks_on_episode_step": null, "callbacks_on_episode_end": null, "callbacks_on_evaluate_start": null, "callbacks_on_evaluate_end": null, "callbacks_on_evaluate_offline_start": null, "callbacks_on_evaluate_offline_end": null, "callbacks_on_sample_end": null, "callbacks_on_train_result": null, "explore": true, "enable_rl_module_and_learner": true, "enable_env_runner_and_connector_v2": true, "_prior_exploration_config": {"type": "StochasticSampling"}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7f7fc7f76ac0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "offline_data_class": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_read_batch_size": null, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "materialize_data": false, "materialize_mapped_data": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "ignore_final_observation": false, "prelearner_class": null, "prelearner_buffer_class": null, "prelearner_buffer_kwargs": {}, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_remaining_data": false, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": 1, "evaluation_duration": 20, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_auto_duration_min_env_steps_per_sample": 100, "evaluation_auto_duration_max_env_steps_per_sample": 2000, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 1, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "offline_evaluation_interval": null, "num_offline_eval_runners": 0, "offline_loss_for_module_fn": null, "offline_evaluation_duration": 1, "offline_evaluation_parallel_to_training": false, "offline_evaluation_timeout_s": 120.0, "num_cpus_per_offline_eval_runner": 1, "num_gpus_per_offline_eval_runner": 0, "custom_resources_per_offline_eval_runner": {}, "restart_failed_offline_eval_runners": true, "ignore_offline_eval_runner_failures": false, "max_num_offline_eval_runner_restarts": 1000, "offline_eval_runner_restore_timeout_s": 1800.0, "max_requests_in_flight_per_offline_eval_runner": 1, "validate_offline_eval_runners_after_construction": true, "offline_eval_runner_health_probe_timeout_s": 30.0, "offline_eval_rl_module_inference_only": false, "broadcast_offline_eval_runner_states": false, "offline_eval_batch_size_per_runner": 256, "dataset_num_iters_per_eval_runner": 1, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "log_gradients": true, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 42, "restart_failed_env_runners": true, "ignore_env_runner_failures": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30.0, "env_runner_restore_timeout_s": 1800.0, "_model_config": {}, "_rl_module_spec": "RLModuleSpec(module_class=None, observation_space=None, action_space=None, inference_only=False, learner_only=False, model_config=DefaultModelConfig(fcnet_hiddens=[120, 97], fcnet_activation='tanh', fcnet_kernel_initializer=None, fcnet_kernel_initializer_kwargs=None, fcnet_bias_initializer=None, fcnet_bias_initializer_kwargs=None, conv_filters=None, conv_activation='relu', conv_kernel_initializer=None, conv_kernel_initializer_kwargs=None, conv_bias_initializer=None, conv_bias_initializer_kwargs=None, head_fcnet_hiddens=[], head_fcnet_activation='relu', head_fcnet_kernel_initializer=None, head_fcnet_kernel_initializer_kwargs=None, head_fcnet_bias_initializer=None, head_fcnet_bias_initializer_kwargs=None, free_log_std=False, log_std_clip_param=20.0, vf_share_layers=True, use_lstm=False, max_seq_len=20, lstm_cell_size=256, lstm_use_prev_action=False, lstm_use_prev_reward=False, lstm_kernel_initializer=None, lstm_kernel_initializer_kwargs=None, lstm_bias_initializer=None, lstm_bias_initializer_kwargs=None), catalog_class=None, load_state_path=None, model_config_dict=None)", "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "_validate_config": true, "_use_msgpack_checkpoints": false, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "env_task_fn": -1, "enable_connectors": -1, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2794154475684, "kl_target": 0.0205400882743, "vf_loss_coeff": 0.7462588469094, "entropy_coeff": 0.0279062776126, "clip_param": 0.2400715659946, "vf_clip_param": 0.4568186220708, "entropy_coeff_schedule": null, "lr_schedule": null, "sgd_minibatch_size": -1, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9330944222753, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.callbacks.callbacks.RLlibCallback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 35.20179867744446, "iterations_since_restore": 7, "perf": {"cpu_util_percent": 12.085714285714285, "ram_util_percent": 71.89999999999999}}
