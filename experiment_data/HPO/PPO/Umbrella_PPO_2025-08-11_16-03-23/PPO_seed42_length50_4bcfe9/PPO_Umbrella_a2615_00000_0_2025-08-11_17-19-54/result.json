{"timers": {"training_iteration": 4.255245790000117, "restore_env_runners": 1.5999999959603883e-05, "training_step": 4.254947090000314, "env_runner_sampling_timer": 3.80479718999959, "learner_update_timer": 0.4463634000003367, "synch_weights": 0.0016129000005093985}, "env_runners": {"env_to_module_sum_episodes_length_out": 26.762340024562445, "agent_episode_returns_mean": {"default_agent": 4.5}, "env_to_module_connector": {"timers": {"connectors": {"add_states_from_episodes_to_batch": 3.5425571326014854e-06, "numpy_to_tensor": 3.099126513372073e-05, "batch_individual_items": 1.8783656637593972e-05, "add_observations_from_episodes_to_batch": 6.443409703485998e-06, "add_time_dim_to_batch_and_zero_pad": 6.465924553162783e-06}}, "connector_pipeline_timer": 0.00012158839928551282}, "module_to_env_connector": {"timers": {"connectors": {"tensor_to_numpy": 4.639451466168066e-05, "un_batch_to_individual_items": 1.512381676751462e-05, "get_actions": 0.00016628389323502493, "remove_single_ts_time_rank_from_batch": 1.3912098794174018e-06, "listify_data_for_vector_env": 3.158969252266949e-05, "normalize_and_clip_actions": 2.8075090984867696e-05}}, "connector_pipeline_timer": 0.00036548888637218455}, "num_env_steps_sampled_lifetime": 252500.0, "episode_return_min": -5.5, "num_env_steps_sampled": 5000.0, "episode_len_min": 50, "env_reset_timer": 0.000191225050154194, "env_step_timer": 4.39313272707546e-05, "num_module_steps_sampled_lifetime": {"default_policy": 252500.0}, "module_episode_returns_mean": {"default_policy": 4.5}, "episode_duration_sec_mean": 0.03556791190003422, "num_agent_steps_sampled": {"default_agent": 5000.0}, "num_module_steps_sampled": {"default_policy": 5000.0}, "num_episodes_lifetime": 5050.0, "episode_return_max": 14.5, "episode_len_mean": 50.0, "episode_return_mean": 4.5, "time_between_sampling": 0.0012179406001609492, "rlmodule_inference_timer": 0.00010217469150867321, "num_agent_steps_sampled_lifetime": {"default_agent": 252500.0}, "episode_len_max": 50, "num_episodes": 100.0, "weights_seq_no": 0.0, "env_to_module_sum_episodes_length_in": 26.762340024562445, "sample": 0.03879833870026198, "num_env_steps_sampled_lifetime_throughput": 1275.0870957646578}, "learners": {"__all_modules__": {"num_trainable_parameters": 10515, "learner_connector_sum_episodes_length_in": 5000, "num_env_steps_trained": 56100, "num_env_steps_trained_lifetime": 56100, "learner_connector": {"timers": {"connectors": {"general_advantage_estimation": 0.013770900000054098, "add_one_ts_to_episodes_and_truncate": 0.008471199999803503, "add_observations_from_episodes_to_batch": 0.0008116999997582752, "add_states_from_episodes_to_batch": 5.899999450775795e-06, "batch_individual_items": 0.20518639999954758, "add_time_dim_to_batch_and_zero_pad": 2.0700000277429353e-05, "add_columns_from_episodes_to_train_batch": 0.06925440000031813, "numpy_to_tensor": 0.00015730000086477958}}, "connector_pipeline_timer": 0.2980154999995648}, "num_non_trainable_parameters": 0, "num_module_steps_trained_lifetime": 11000, "learner_connector_sum_episodes_length_out": 5100, "num_module_steps_trained": 11000, "num_env_steps_trained_lifetime_throughput": 1024004.3850384051, "num_module_steps_trained_throughput": 201555.7850187626, "num_module_steps_trained_lifetime_throughput": 201369.65742932653}, "default_policy": {"vf_explained_var": -0.02239525318145752, "vf_loss": 0.2825557291507721, "policy_loss": 0.024843165650963783, "vf_loss_unclipped": 39.03231430053711, "diff_num_grad_updates_vs_sampler_policy": 1.0, "num_module_steps_trained_lifetime": 11000, "mean_kl_loss": 0.007519361097365618, "curr_entropy_coeff": 0.0034162146123, "module_train_batch_size_mean": 1000.0, "num_module_steps_trained": 11000, "curr_kl_coeff": 0.09047933667898178, "entropy": 0.6831693649291992, "weights_seq_no": 1.0, "total_loss": 0.17914067208766937, "default_optimizer_learning_rate": 0.0018683590437, "num_trainable_parameters": 10515, "gradients_default_optimizer_global_norm": 0.04959792271256447, "num_module_steps_trained_lifetime_throughput": 201984.45106396094}}, "num_training_step_calls_per_iteration": 1, "num_env_steps_sampled_lifetime": 252500.0, "evaluation": {"env_runners": {"module_to_env_connector": {"timers": {"connectors": {"listify_data_for_vector_env": 3.0493962987231902e-05, "un_batch_to_individual_items": 1.5291833420519507e-05, "normalize_and_clip_actions": 2.1754960526387658e-05, "tensor_to_numpy": 4.529538125224727e-05, "get_actions": 0.00015286338101472126, "remove_single_ts_time_rank_from_batch": 1.4084126151325844e-06}}, "connector_pipeline_timer": 0.00034238339104384783}, "env_to_module_sum_episodes_length_in": 27.167134025045954, "num_module_steps_sampled": {"default_policy": 1000}, "num_env_steps_sampled_lifetime": 6000, "num_agent_steps_sampled": {"default_agent": 1000}, "num_env_steps_sampled": 1000, "agent_episode_returns_mean": {"default_agent": -0.9}, "episode_len_max": 50, "weights_seq_no": 1.0, "env_to_module_connector": {"timers": {"connectors": {"add_observations_from_episodes_to_batch": 6.273254948414667e-06, "add_states_from_episodes_to_batch": 3.4262317382439926e-06, "batch_individual_items": 1.8665041285296523e-05, "add_time_dim_to_batch_and_zero_pad": 6.306745236542989e-06, "numpy_to_tensor": 2.91996537186802e-05}}, "connector_pipeline_timer": 0.00011616404152133718}, "sample": 0.7340958999993745, "episode_return_min": -16.5, "episode_len_min": 50, "num_episodes_lifetime": 20, "episode_len_mean": 50.0, "episode_return_mean": -0.9, "num_episodes": 20, "num_module_steps_sampled_lifetime": {"default_policy": 1000}, "env_reset_timer": 0.00021240000023681205, "env_step_timer": 4.200541144027461e-05, "num_agent_steps_sampled_lifetime": {"default_agent": 1000}, "episode_duration_sec_mean": 0.035271490000104676, "rlmodule_inference_timer": 9.7480360781898e-05, "env_to_module_sum_episodes_length_out": 27.167134025045954, "module_episode_returns_mean": {"default_policy": -0.9}, "episode_return_max": 17.5}, "num_healthy_workers": 1, "actor_manager_num_outstanding_async_reqs": 0, "num_remote_worker_restarts": 0}, "fault_tolerance": {"num_healthy_workers": 0, "num_remote_worker_restarts": 0}, "env_runner_group": {"actor_manager_num_outstanding_async_reqs": 0}, "done": false, "training_iteration": 1, "trial_id": "a2615_00000", "date": "2025-08-11_17-26-45", "timestamp": 1754926005, "time_this_iter_s": 5.005371332168579, "time_total_s": 5.005371332168579, "pid": 77556, "hostname": "DESKTOP-3SK5A41", "node_ip": "192.168.40.242", "config": {"exploration_config": {}, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 6, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "env": "Umbrella", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": false, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 0, "create_local_env_runner": true, "num_envs_per_env_runner": 1, "gym_env_vectorize_mode": "SYNC", "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "episodes_to_numpy": true, "max_requests_in_flight_per_env_runner": 1, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "merge_env_runner_states": "training_only", "broadcast_env_runner_states": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "complete_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "sampler_perf_stats_ema_coef": null, "_is_online": true, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": "auto", "num_aggregator_actors_per_learner": 0, "max_requests_in_flight_per_aggregator_actor": 3, "local_gpu_idx": 0, "max_requests_in_flight_per_learner": 3, "gamma": 1, "lr": 0.0018683590437, "grad_clip": 0.5, "grad_clip_by": "global_norm", "_train_batch_size_per_learner": 5000, "train_batch_size": 4000, "num_epochs": 2, "minibatch_size": 1000, "shuffle_batch_per_epoch": true, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "log_std_clip_param": 20.0, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "_disable_preprocessor_api": false, "_disable_action_flattening": false}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "_learner_class": null, "callbacks_on_algorithm_init": null, "callbacks_on_env_runners_recreated": null, "callbacks_on_offline_eval_runners_recreated": null, "callbacks_on_checkpoint_loaded": null, "callbacks_on_environment_created": null, "callbacks_on_episode_created": null, "callbacks_on_episode_start": null, "callbacks_on_episode_step": null, "callbacks_on_episode_end": null, "callbacks_on_evaluate_start": null, "callbacks_on_evaluate_end": null, "callbacks_on_evaluate_offline_start": null, "callbacks_on_evaluate_offline_end": null, "callbacks_on_sample_end": null, "callbacks_on_train_result": null, "explore": true, "enable_rl_module_and_learner": true, "enable_env_runner_and_connector_v2": true, "_prior_exploration_config": {"type": "StochasticSampling"}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x789255972ac0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "offline_data_class": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_read_batch_size": null, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "materialize_data": false, "materialize_mapped_data": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "ignore_final_observation": false, "prelearner_class": null, "prelearner_buffer_class": null, "prelearner_buffer_kwargs": {}, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_remaining_data": false, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": 1, "evaluation_duration": 20, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_auto_duration_min_env_steps_per_sample": 100, "evaluation_auto_duration_max_env_steps_per_sample": 2000, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 1, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "offline_evaluation_interval": null, "num_offline_eval_runners": 0, "offline_loss_for_module_fn": null, "offline_evaluation_duration": 1, "offline_evaluation_parallel_to_training": false, "offline_evaluation_timeout_s": 120.0, "num_cpus_per_offline_eval_runner": 1, "num_gpus_per_offline_eval_runner": 0, "custom_resources_per_offline_eval_runner": {}, "restart_failed_offline_eval_runners": true, "ignore_offline_eval_runner_failures": false, "max_num_offline_eval_runner_restarts": 1000, "offline_eval_runner_restore_timeout_s": 1800.0, "max_requests_in_flight_per_offline_eval_runner": 1, "validate_offline_eval_runners_after_construction": true, "offline_eval_runner_health_probe_timeout_s": 30.0, "offline_eval_rl_module_inference_only": false, "broadcast_offline_eval_runner_states": false, "offline_eval_batch_size_per_runner": 256, "dataset_num_iters_per_eval_runner": 1, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "log_gradients": true, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 42, "restart_failed_env_runners": true, "ignore_env_runner_failures": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30.0, "env_runner_restore_timeout_s": 1800.0, "_model_config": {}, "_rl_module_spec": "RLModuleSpec(module_class=None, observation_space=None, action_space=None, inference_only=False, learner_only=False, model_config=DefaultModelConfig(fcnet_hiddens=[108, 90], fcnet_activation='tanh', fcnet_kernel_initializer=None, fcnet_kernel_initializer_kwargs=None, fcnet_bias_initializer=None, fcnet_bias_initializer_kwargs=None, conv_filters=None, conv_activation='relu', conv_kernel_initializer=None, conv_kernel_initializer_kwargs=None, conv_bias_initializer=None, conv_bias_initializer_kwargs=None, head_fcnet_hiddens=[], head_fcnet_activation='relu', head_fcnet_kernel_initializer=None, head_fcnet_kernel_initializer_kwargs=None, head_fcnet_bias_initializer=None, head_fcnet_bias_initializer_kwargs=None, free_log_std=False, log_std_clip_param=20.0, vf_share_layers=True, use_lstm=False, max_seq_len=20, lstm_cell_size=256, lstm_use_prev_action=False, lstm_use_prev_reward=False, lstm_kernel_initializer=None, lstm_kernel_initializer_kwargs=None, lstm_bias_initializer=None, lstm_bias_initializer_kwargs=None), catalog_class=None, load_state_path=None, model_config_dict=None)", "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "_validate_config": true, "_use_msgpack_checkpoints": false, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "env_task_fn": -1, "enable_connectors": -1, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.1809586766689, "kl_target": 0.02025624843, "vf_loss_coeff": 0.5495223591769, "entropy_coeff": 0.0034162146123, "clip_param": 0.1867229885198, "vf_clip_param": 0.3047866025797, "entropy_coeff_schedule": null, "lr_schedule": null, "sgd_minibatch_size": -1, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9727905109988, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.callbacks.callbacks.RLlibCallback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 5.005371332168579, "iterations_since_restore": 1, "perf": {"cpu_util_percent": 11.4625, "ram_util_percent": 83.125}}
{"timers": {"training_iteration": 4.254591418080118, "restore_env_runners": 1.5960999953676946e-05, "training_step": 4.254291340080307, "env_runner_sampling_timer": 3.8056925490795948, "learner_update_timer": 0.4448000680003315, "synch_weights": 0.0016178230005061778, "restore_eval_env_runners": 1.4900000678608194e-05, "evaluation_iteration": 0.7463874999994005, "synch_eval_env_connectors": 0.0003968999999415246, "synch_env_connectors": 7.300000106624793e-06}, "env_runners": {"env_to_module_sum_episodes_length_out": 27.16809333212661, "agent_episode_returns_mean": {"default_agent": 6.700000000000004}, "env_to_module_connector": {"timers": {"connectors": {"add_states_from_episodes_to_batch": 3.5106117900531345e-06, "numpy_to_tensor": 3.0930899944716855e-05, "batch_individual_items": 1.8771594248589708e-05, "add_observations_from_episodes_to_batch": 6.336258299923406e-06, "add_time_dim_to_batch_and_zero_pad": 6.429612135599987e-06}}, "connector_pipeline_timer": 0.00011858664844935386}, "module_to_env_connector": {"timers": {"connectors": {"tensor_to_numpy": 4.835479277382385e-05, "un_batch_to_individual_items": 1.5044916648808338e-05, "get_actions": 0.0001637700787121822, "remove_single_ts_time_rank_from_batch": 1.3879246559875193e-06, "listify_data_for_vector_env": 3.172651978497836e-05, "normalize_and_clip_actions": 2.2299368031611393e-05}}, "connector_pipeline_timer": 0.00035934169610600883}, "num_env_steps_sampled_lifetime": 10000.0, "episode_return_min": -5.5, "num_env_steps_sampled": 5000.0, "episode_len_min": 50, "env_reset_timer": 0.00012974638450733922, "env_step_timer": 4.3254616400464595e-05, "num_module_steps_sampled_lifetime": {"default_policy": 10000.0}, "module_episode_returns_mean": {"default_policy": 6.700000000000004}, "episode_duration_sec_mean": 0.03636485097997137, "num_agent_steps_sampled": {"default_agent": 5000.0}, "num_module_steps_sampled": {"default_policy": 5000.0}, "num_episodes_lifetime": 200.0, "episode_return_max": 14.5, "episode_len_mean": 50.0, "episode_return_mean": 6.700000000000004, "time_between_sampling": 0.009208850689041613, "rlmodule_inference_timer": 9.950506755441363e-05, "num_agent_steps_sampled_lifetime": {"default_agent": 10000.0}, "episode_len_max": 50, "num_episodes": 100.0, "weights_seq_no": 1.0, "env_to_module_sum_episodes_length_in": 27.16809333212661, "sample": 0.03770820173759481, "num_env_steps_sampled_lifetime_throughput": 1291.910671436179}, "learners": {"__all_modules__": {"num_trainable_parameters": 10515, "learner_connector_sum_episodes_length_in": 5000.0, "num_env_steps_trained": 56100, "num_env_steps_trained_lifetime": 112200, "learner_connector": {"timers": {"connectors": {"general_advantage_estimation": 0.013756045000054656, "add_one_ts_to_episodes_and_truncate": 0.008510250999806885, "add_observations_from_episodes_to_batch": 0.0008143219997600681, "add_states_from_episodes_to_batch": 5.922999453105149e-06, "batch_individual_items": 0.20391346599954885, "add_time_dim_to_batch_and_zero_pad": 2.0866000277237617e-05, "add_columns_from_episodes_to_train_batch": 0.06970632600031422, "numpy_to_tensor": 0.00015771500085975276}}, "connector_pipeline_timer": 0.297223500999562}, "num_non_trainable_parameters": 0, "num_module_steps_trained_lifetime": 22000, "learner_connector_sum_episodes_length_out": 5100.0, "num_module_steps_trained": 11000, "num_env_steps_trained_lifetime_throughput": 1018770.079653345, "num_module_steps_trained_throughput": 200513.53350137197, "num_module_steps_trained_lifetime_throughput": 200330.4906806358}, "default_policy": {"vf_explained_var": -0.015463709831237793, "vf_loss": 0.28856757283210754, "policy_loss": 0.03192779794335365, "vf_loss_unclipped": 42.93065643310547, "diff_num_grad_updates_vs_sampler_policy": 1.0, "num_module_steps_trained_lifetime": 22000, "mean_kl_loss": 0.005282980389893055, "curr_entropy_coeff": 0.0034162146123, "module_train_batch_size_mean": 1000.0, "num_module_steps_trained": 11000, "curr_kl_coeff": 0.04523966833949089, "entropy": 0.6635399460792542, "weights_seq_no": 2.0, "total_loss": 0.18871331214904785, "default_optimizer_learning_rate": 0.0018683590437, "num_trainable_parameters": 10515, "gradients_default_optimizer_global_norm": 0.02787065878510475, "num_module_steps_trained_lifetime_throughput": 200930.74986664363}}, "num_training_step_calls_per_iteration": 1, "evaluation": {"env_runners": {"module_to_env_connector": {"timers": {"connectors": {"listify_data_for_vector_env": 3.0223326992554116e-05, "un_batch_to_individual_items": 1.557768426095577e-05, "normalize_and_clip_actions": 2.227849063173895e-05, "tensor_to_numpy": 4.532900284312791e-05, "get_actions": 0.0001530532932143494, "remove_single_ts_time_rank_from_batch": 1.537578598364465e-06}}, "connector_pipeline_timer": 0.00034316196473099694}, "env_to_module_sum_episodes_length_in": 27.168093298253442, "num_module_steps_sampled": {"default_policy": 1000}, "num_env_steps_sampled_lifetime": 11000, "num_agent_steps_sampled": {"default_agent": 1000}, "num_env_steps_sampled": 1000, "agent_episode_returns_mean": {"default_agent": -0.4}, "episode_len_max": 50, "weights_seq_no": 2.0, "env_to_module_connector": {"timers": {"connectors": {"add_observations_from_episodes_to_batch": 6.296337062532694e-06, "add_states_from_episodes_to_batch": 3.424958636571028e-06, "batch_individual_items": 1.8581795632865483e-05, "add_time_dim_to_batch_and_zero_pad": 6.222103976514468e-06, "numpy_to_tensor": 2.9379561991741607e-05}}, "connector_pipeline_timer": 0.0001153834866488477}, "sample": 0.7344966169893723, "episode_return_min": -16.5, "episode_len_min": 50, "num_episodes_lifetime": 40, "episode_len_mean": 50.0, "episode_return_mean": -0.4, "num_episodes": 20, "num_module_steps_sampled_lifetime": {"default_policy": 2000}, "env_reset_timer": 0.00021176000022933296, "env_step_timer": 4.133617151754294e-05, "num_agent_steps_sampled_lifetime": {"default_agent": 2000}, "episode_duration_sec_mean": 0.03621361247505774, "rlmodule_inference_timer": 9.52526735397319e-05, "env_to_module_sum_episodes_length_out": 27.168093298253442, "module_episode_returns_mean": {"default_policy": -0.4}, "episode_return_max": 17.5, "time_between_sampling": 4.24939909800014}, "num_healthy_workers": 1, "actor_manager_num_outstanding_async_reqs": 0, "num_remote_worker_restarts": 0}, "num_env_steps_sampled_lifetime": 10000.0, "fault_tolerance": {"num_healthy_workers": 0, "num_remote_worker_restarts": 0}, "env_runner_group": {"actor_manager_num_outstanding_async_reqs": 0}, "done": false, "training_iteration": 2, "trial_id": "a2615_00000", "date": "2025-08-11_17-26-50", "timestamp": 1754926010, "time_this_iter_s": 4.979923248291016, "time_total_s": 9.985294580459595, "pid": 77556, "hostname": "DESKTOP-3SK5A41", "node_ip": "192.168.40.242", "config": {"exploration_config": {}, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 6, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "env": "Umbrella", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": false, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 0, "create_local_env_runner": true, "num_envs_per_env_runner": 1, "gym_env_vectorize_mode": "SYNC", "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "episodes_to_numpy": true, "max_requests_in_flight_per_env_runner": 1, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "merge_env_runner_states": "training_only", "broadcast_env_runner_states": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "complete_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "sampler_perf_stats_ema_coef": null, "_is_online": true, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": "auto", "num_aggregator_actors_per_learner": 0, "max_requests_in_flight_per_aggregator_actor": 3, "local_gpu_idx": 0, "max_requests_in_flight_per_learner": 3, "gamma": 1, "lr": 0.0018683590437, "grad_clip": 0.5, "grad_clip_by": "global_norm", "_train_batch_size_per_learner": 5000, "train_batch_size": 4000, "num_epochs": 2, "minibatch_size": 1000, "shuffle_batch_per_epoch": true, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "log_std_clip_param": 20.0, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "_disable_preprocessor_api": false, "_disable_action_flattening": false}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "_learner_class": null, "callbacks_on_algorithm_init": null, "callbacks_on_env_runners_recreated": null, "callbacks_on_offline_eval_runners_recreated": null, "callbacks_on_checkpoint_loaded": null, "callbacks_on_environment_created": null, "callbacks_on_episode_created": null, "callbacks_on_episode_start": null, "callbacks_on_episode_step": null, "callbacks_on_episode_end": null, "callbacks_on_evaluate_start": null, "callbacks_on_evaluate_end": null, "callbacks_on_evaluate_offline_start": null, "callbacks_on_evaluate_offline_end": null, "callbacks_on_sample_end": null, "callbacks_on_train_result": null, "explore": true, "enable_rl_module_and_learner": true, "enable_env_runner_and_connector_v2": true, "_prior_exploration_config": {"type": "StochasticSampling"}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x789255972ac0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "offline_data_class": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_read_batch_size": null, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "materialize_data": false, "materialize_mapped_data": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "ignore_final_observation": false, "prelearner_class": null, "prelearner_buffer_class": null, "prelearner_buffer_kwargs": {}, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_remaining_data": false, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": 1, "evaluation_duration": 20, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_auto_duration_min_env_steps_per_sample": 100, "evaluation_auto_duration_max_env_steps_per_sample": 2000, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 1, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "offline_evaluation_interval": null, "num_offline_eval_runners": 0, "offline_loss_for_module_fn": null, "offline_evaluation_duration": 1, "offline_evaluation_parallel_to_training": false, "offline_evaluation_timeout_s": 120.0, "num_cpus_per_offline_eval_runner": 1, "num_gpus_per_offline_eval_runner": 0, "custom_resources_per_offline_eval_runner": {}, "restart_failed_offline_eval_runners": true, "ignore_offline_eval_runner_failures": false, "max_num_offline_eval_runner_restarts": 1000, "offline_eval_runner_restore_timeout_s": 1800.0, "max_requests_in_flight_per_offline_eval_runner": 1, "validate_offline_eval_runners_after_construction": true, "offline_eval_runner_health_probe_timeout_s": 30.0, "offline_eval_rl_module_inference_only": false, "broadcast_offline_eval_runner_states": false, "offline_eval_batch_size_per_runner": 256, "dataset_num_iters_per_eval_runner": 1, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "log_gradients": true, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 42, "restart_failed_env_runners": true, "ignore_env_runner_failures": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30.0, "env_runner_restore_timeout_s": 1800.0, "_model_config": {}, "_rl_module_spec": "RLModuleSpec(module_class=None, observation_space=None, action_space=None, inference_only=False, learner_only=False, model_config=DefaultModelConfig(fcnet_hiddens=[108, 90], fcnet_activation='tanh', fcnet_kernel_initializer=None, fcnet_kernel_initializer_kwargs=None, fcnet_bias_initializer=None, fcnet_bias_initializer_kwargs=None, conv_filters=None, conv_activation='relu', conv_kernel_initializer=None, conv_kernel_initializer_kwargs=None, conv_bias_initializer=None, conv_bias_initializer_kwargs=None, head_fcnet_hiddens=[], head_fcnet_activation='relu', head_fcnet_kernel_initializer=None, head_fcnet_kernel_initializer_kwargs=None, head_fcnet_bias_initializer=None, head_fcnet_bias_initializer_kwargs=None, free_log_std=False, log_std_clip_param=20.0, vf_share_layers=True, use_lstm=False, max_seq_len=20, lstm_cell_size=256, lstm_use_prev_action=False, lstm_use_prev_reward=False, lstm_kernel_initializer=None, lstm_kernel_initializer_kwargs=None, lstm_bias_initializer=None, lstm_bias_initializer_kwargs=None), catalog_class=None, load_state_path=None, model_config_dict=None)", "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "_validate_config": true, "_use_msgpack_checkpoints": false, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "env_task_fn": -1, "enable_connectors": -1, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.1809586766689, "kl_target": 0.02025624843, "vf_loss_coeff": 0.5495223591769, "entropy_coeff": 0.0034162146123, "clip_param": 0.1867229885198, "vf_clip_param": 0.3047866025797, "entropy_coeff_schedule": null, "lr_schedule": null, "sgd_minibatch_size": -1, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9727905109988, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.callbacks.callbacks.RLlibCallback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 9.985294580459595, "iterations_since_restore": 2, "perf": {"cpu_util_percent": 15.542857142857144, "ram_util_percent": 82.58571428571429}}
{"timers": {"training_iteration": 4.25421428391931, "restore_env_runners": 1.5920389950770184e-05, "training_step": 4.253913341699507, "env_runner_sampling_timer": 3.8076616126088036, "learner_update_timer": 0.4424515003203312, "synch_weights": 0.001615398770502543, "restore_eval_env_runners": 1.5079000668265508e-05, "evaluation_iteration": 0.7467704949894051, "synch_eval_env_connectors": 0.00039879999994809625, "synch_env_connectors": 7.297000101971207e-06}, "env_runners": {"env_to_module_sum_episodes_length_out": 27.16809333212661, "agent_episode_returns_mean": {"default_agent": 8.9}, "env_to_module_connector": {"timers": {"connectors": {"add_states_from_episodes_to_batch": 3.4625020228496027e-06, "numpy_to_tensor": 3.07682061347143e-05, "batch_individual_items": 1.8696820488836105e-05, "add_observations_from_episodes_to_batch": 6.295287918236281e-06, "add_time_dim_to_batch_and_zero_pad": 6.350994535284331e-06}}, "connector_pipeline_timer": 0.00011787520661345338}, "module_to_env_connector": {"timers": {"connectors": {"tensor_to_numpy": 4.810951001507791e-05, "un_batch_to_individual_items": 1.5024611788515573e-05, "get_actions": 0.00016280125490674034, "remove_single_ts_time_rank_from_batch": 1.3824195649389681e-06, "listify_data_for_vector_env": 3.167843644453723e-05, "normalize_and_clip_actions": 2.2243658301691628e-05}}, "connector_pipeline_timer": 0.0003571940714836308}, "num_env_steps_sampled_lifetime": -232500.0, "episode_return_min": -5.5, "num_env_steps_sampled": 5000.0, "episode_len_min": 50, "env_reset_timer": 0.00010864556036565268, "env_step_timer": 4.315733523177763e-05, "num_module_steps_sampled_lifetime": {"default_policy": -232500.0}, "module_episode_returns_mean": {"default_policy": 8.9}, "episode_duration_sec_mean": 0.037509669020028, "num_agent_steps_sampled": {"default_agent": 5000.0}, "num_module_steps_sampled": {"default_policy": 5000.0}, "num_episodes_lifetime": -4650.0, "episode_return_max": 14.5, "episode_len_mean": 50.0, "episode_return_mean": 8.9, "time_between_sampling": 0.011461994654653706, "rlmodule_inference_timer": 0.00013342392529790438, "num_agent_steps_sampled_lifetime": {"default_agent": -232500.0}, "episode_len_max": 50, "num_episodes": 100.0, "weights_seq_no": 2.0, "env_to_module_sum_episodes_length_in": 27.16809333212661, "sample": 0.03785490789359048, "num_env_steps_sampled_lifetime_throughput": 1283.5616104532278}, "learners": {"__all_modules__": {"num_trainable_parameters": 10515, "learner_connector_sum_episodes_length_in": 5000.0, "num_env_steps_trained": 56100, "num_env_steps_trained_lifetime": 168300, "learner_connector": {"timers": {"connectors": {"general_advantage_estimation": 0.013707414550055818, "add_one_ts_to_episodes_and_truncate": 0.008508787489812859, "add_observations_from_episodes_to_batch": 0.0008131157797607556, "add_states_from_episodes_to_batch": 5.919769457523217e-06, "batch_individual_items": 0.20247471433955422, "add_time_dim_to_batch_and_zero_pad": 2.0885340273434847e-05, "add_columns_from_episodes_to_train_batch": 0.06967095274031736, "numpy_to_tensor": 0.0001577378508471156}}, "connector_pipeline_timer": 0.2956976249895678}, "num_non_trainable_parameters": 0, "num_module_steps_trained_lifetime": 33000, "learner_connector_sum_episodes_length_out": 5100.0, "num_module_steps_trained": 11000, "num_env_steps_trained_lifetime_throughput": 1012209.3110549538, "num_module_steps_trained_throughput": 199205.0500910222, "num_module_steps_trained_lifetime_throughput": 199027.02594756402}, "default_policy": {"vf_explained_var": -0.009076952934265137, "vf_loss": 0.29297927021980286, "policy_loss": -0.02881840243935585, "vf_loss_unclipped": 46.3785400390625, "diff_num_grad_updates_vs_sampler_policy": 1.0, "num_module_steps_trained_lifetime": 33000, "mean_kl_loss": 0.0013695643283426762, "curr_entropy_coeff": 0.0034162146123, "module_train_batch_size_mean": 1000.0, "num_module_steps_trained": 11000, "curr_kl_coeff": 0.022619834169745445, "entropy": 0.6653856039047241, "weights_seq_no": 3.0, "total_loss": 0.12996909022331238, "default_optimizer_learning_rate": 0.0018683590437, "num_trainable_parameters": 10515, "gradients_default_optimizer_global_norm": 0.036001451313495636, "num_module_steps_trained_lifetime_throughput": 199603.90331367866}}, "num_training_step_calls_per_iteration": 1, "evaluation": {"env_runners": {"module_to_env_connector": {"timers": {"connectors": {"listify_data_for_vector_env": 3.003491165130275e-05, "un_batch_to_individual_items": 1.5074799321954264e-05, "normalize_and_clip_actions": 2.209578695204372e-05, "tensor_to_numpy": 4.561286165784034e-05, "get_actions": 0.00015429777938191484, "remove_single_ts_time_rank_from_batch": 1.4353802658867257e-06}}, "connector_pipeline_timer": 0.00034362141374615464}, "env_to_module_sum_episodes_length_in": 27.168093332125434, "num_module_steps_sampled": {"default_policy": 1000}, "num_env_steps_sampled_lifetime": 16000, "num_agent_steps_sampled": {"default_agent": 1000}, "num_env_steps_sampled": 1000, "agent_episode_returns_mean": {"default_agent": -0.9}, "episode_len_max": 50, "weights_seq_no": 3.0, "env_to_module_connector": {"timers": {"connectors": {"add_observations_from_episodes_to_batch": 6.12732906486707e-06, "add_states_from_episodes_to_batch": 3.3468631850998384e-06, "batch_individual_items": 1.844509486220022e-05, "add_time_dim_to_batch_and_zero_pad": 6.253455159192715e-06, "numpy_to_tensor": 2.9269244185825904e-05}}, "connector_pipeline_timer": 0.00011464758007163859}, "sample": 0.7344456728194749, "episode_return_min": -16.5, "episode_len_min": 50, "num_episodes_lifetime": 60, "episode_len_mean": 50.0, "episode_return_mean": -0.9, "num_episodes": 20, "num_module_steps_sampled_lifetime": {"default_policy": 3000}, "env_reset_timer": 0.0002109274002255006, "env_step_timer": 4.186535277404861e-05, "num_agent_steps_sampled_lifetime": {"default_agent": 3000}, "episode_duration_sec_mean": 0.035826969983418167, "rlmodule_inference_timer": 9.557321692991496e-05, "env_to_module_sum_episodes_length_out": 27.168093332125434, "module_episode_returns_mean": {"default_policy": -0.9}, "episode_return_max": 17.5, "time_between_sampling": 4.249654493040143}, "num_healthy_workers": 1, "actor_manager_num_outstanding_async_reqs": 0, "num_remote_worker_restarts": 0}, "num_env_steps_sampled_lifetime": -232500.0, "fault_tolerance": {"num_healthy_workers": 0, "num_remote_worker_restarts": 0}, "env_runner_group": {"actor_manager_num_outstanding_async_reqs": 0}, "done": false, "training_iteration": 3, "trial_id": "a2615_00000", "date": "2025-08-11_17-26-55", "timestamp": 1754926015, "time_this_iter_s": 4.9608283042907715, "time_total_s": 14.946122884750366, "pid": 77556, "hostname": "DESKTOP-3SK5A41", "node_ip": "192.168.40.242", "config": {"exploration_config": {}, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 6, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "env": "Umbrella", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": false, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 0, "create_local_env_runner": true, "num_envs_per_env_runner": 1, "gym_env_vectorize_mode": "SYNC", "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "episodes_to_numpy": true, "max_requests_in_flight_per_env_runner": 1, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "merge_env_runner_states": "training_only", "broadcast_env_runner_states": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "complete_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "sampler_perf_stats_ema_coef": null, "_is_online": true, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": "auto", "num_aggregator_actors_per_learner": 0, "max_requests_in_flight_per_aggregator_actor": 3, "local_gpu_idx": 0, "max_requests_in_flight_per_learner": 3, "gamma": 1, "lr": 0.0018683590437, "grad_clip": 0.5, "grad_clip_by": "global_norm", "_train_batch_size_per_learner": 5000, "train_batch_size": 4000, "num_epochs": 2, "minibatch_size": 1000, "shuffle_batch_per_epoch": true, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "log_std_clip_param": 20.0, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "_disable_preprocessor_api": false, "_disable_action_flattening": false}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "_learner_class": null, "callbacks_on_algorithm_init": null, "callbacks_on_env_runners_recreated": null, "callbacks_on_offline_eval_runners_recreated": null, "callbacks_on_checkpoint_loaded": null, "callbacks_on_environment_created": null, "callbacks_on_episode_created": null, "callbacks_on_episode_start": null, "callbacks_on_episode_step": null, "callbacks_on_episode_end": null, "callbacks_on_evaluate_start": null, "callbacks_on_evaluate_end": null, "callbacks_on_evaluate_offline_start": null, "callbacks_on_evaluate_offline_end": null, "callbacks_on_sample_end": null, "callbacks_on_train_result": null, "explore": true, "enable_rl_module_and_learner": true, "enable_env_runner_and_connector_v2": true, "_prior_exploration_config": {"type": "StochasticSampling"}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x789255972ac0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "offline_data_class": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_read_batch_size": null, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "materialize_data": false, "materialize_mapped_data": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "ignore_final_observation": false, "prelearner_class": null, "prelearner_buffer_class": null, "prelearner_buffer_kwargs": {}, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_remaining_data": false, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": 1, "evaluation_duration": 20, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_auto_duration_min_env_steps_per_sample": 100, "evaluation_auto_duration_max_env_steps_per_sample": 2000, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 1, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "offline_evaluation_interval": null, "num_offline_eval_runners": 0, "offline_loss_for_module_fn": null, "offline_evaluation_duration": 1, "offline_evaluation_parallel_to_training": false, "offline_evaluation_timeout_s": 120.0, "num_cpus_per_offline_eval_runner": 1, "num_gpus_per_offline_eval_runner": 0, "custom_resources_per_offline_eval_runner": {}, "restart_failed_offline_eval_runners": true, "ignore_offline_eval_runner_failures": false, "max_num_offline_eval_runner_restarts": 1000, "offline_eval_runner_restore_timeout_s": 1800.0, "max_requests_in_flight_per_offline_eval_runner": 1, "validate_offline_eval_runners_after_construction": true, "offline_eval_runner_health_probe_timeout_s": 30.0, "offline_eval_rl_module_inference_only": false, "broadcast_offline_eval_runner_states": false, "offline_eval_batch_size_per_runner": 256, "dataset_num_iters_per_eval_runner": 1, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "log_gradients": true, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 42, "restart_failed_env_runners": true, "ignore_env_runner_failures": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30.0, "env_runner_restore_timeout_s": 1800.0, "_model_config": {}, "_rl_module_spec": "RLModuleSpec(module_class=None, observation_space=None, action_space=None, inference_only=False, learner_only=False, model_config=DefaultModelConfig(fcnet_hiddens=[108, 90], fcnet_activation='tanh', fcnet_kernel_initializer=None, fcnet_kernel_initializer_kwargs=None, fcnet_bias_initializer=None, fcnet_bias_initializer_kwargs=None, conv_filters=None, conv_activation='relu', conv_kernel_initializer=None, conv_kernel_initializer_kwargs=None, conv_bias_initializer=None, conv_bias_initializer_kwargs=None, head_fcnet_hiddens=[], head_fcnet_activation='relu', head_fcnet_kernel_initializer=None, head_fcnet_kernel_initializer_kwargs=None, head_fcnet_bias_initializer=None, head_fcnet_bias_initializer_kwargs=None, free_log_std=False, log_std_clip_param=20.0, vf_share_layers=True, use_lstm=False, max_seq_len=20, lstm_cell_size=256, lstm_use_prev_action=False, lstm_use_prev_reward=False, lstm_kernel_initializer=None, lstm_kernel_initializer_kwargs=None, lstm_bias_initializer=None, lstm_bias_initializer_kwargs=None), catalog_class=None, load_state_path=None, model_config_dict=None)", "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "_validate_config": true, "_use_msgpack_checkpoints": false, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "env_task_fn": -1, "enable_connectors": -1, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.1809586766689, "kl_target": 0.02025624843, "vf_loss_coeff": 0.5495223591769, "entropy_coeff": 0.0034162146123, "clip_param": 0.1867229885198, "vf_clip_param": 0.3047866025797, "entropy_coeff_schedule": null, "lr_schedule": null, "sgd_minibatch_size": -1, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9727905109988, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.callbacks.callbacks.RLlibCallback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 14.946122884750366, "iterations_since_restore": 3, "perf": {"cpu_util_percent": 12.400000000000002, "ram_util_percent": 78.89999999999999}}
{"timers": {"training_iteration": 4.254405990100122, "restore_env_runners": 1.5875186046199815e-05, "training_step": 4.254104263302504, "env_runner_sampling_timer": 3.808483987502712, "learner_update_timer": 0.44182192331712883, "synch_weights": 0.0016125587828046027, "restore_eval_env_runners": 1.5047210658212862e-05, "evaluation_iteration": 0.7466943930395075, "synch_eval_env_connectors": 0.00039875499995014257, "synch_env_connectors": 7.295030095883704e-06}, "env_runners": {"env_to_module_sum_episodes_length_out": 27.16809333212661, "agent_episode_returns_mean": {"default_agent": 8.700000000000003}, "env_to_module_connector": {"timers": {"connectors": {"add_states_from_episodes_to_batch": 3.536456903838371e-06, "numpy_to_tensor": 3.092043487168908e-05, "batch_individual_items": 1.8704105504641383e-05, "add_observations_from_episodes_to_batch": 6.336703240357388e-06, "add_time_dim_to_batch_and_zero_pad": 6.3702430005360166e-06}}, "connector_pipeline_timer": 0.00011871087446204059}, "module_to_env_connector": {"timers": {"connectors": {"tensor_to_numpy": 4.845623670285317e-05, "un_batch_to_individual_items": 1.5035549350921089e-05, "get_actions": 0.00016357226262175842, "remove_single_ts_time_rank_from_batch": 1.387319288623952e-06, "listify_data_for_vector_env": 3.1739212867831755e-05, "normalize_and_clip_actions": 2.2285778438853993e-05}}, "connector_pipeline_timer": 0.00035905896011504567}, "num_env_steps_sampled_lifetime": -475000.0, "episode_return_min": -5.5, "num_env_steps_sampled": 5000.0, "episode_len_min": 50, "env_reset_timer": 9.824505740841041e-05, "env_step_timer": 4.327291032876285e-05, "num_module_steps_sampled_lifetime": {"default_policy": -475000.0}, "module_episode_returns_mean": {"default_policy": 8.700000000000003}, "episode_duration_sec_mean": 0.03634655300993472, "num_agent_steps_sampled": {"default_agent": 5000.0}, "num_module_steps_sampled": {"default_policy": 5000.0}, "num_episodes_lifetime": -9500.0, "episode_return_max": 14.5, "episode_len_mean": 50.0, "episode_return_mean": 8.700000000000003, "time_between_sampling": 0.011437697724091993, "rlmodule_inference_timer": 0.00010020434843235832, "num_agent_steps_sampled_lifetime": {"default_agent": -475000.0}, "episode_len_max": 50, "num_episodes": 100.0, "weights_seq_no": 3.0, "env_to_module_sum_episodes_length_in": 27.16809333212661, "sample": 0.03801285058694853, "num_env_steps_sampled_lifetime_throughput": 1285.6128270228198}, "learners": {"__all_modules__": {"num_trainable_parameters": 10515, "learner_connector_sum_episodes_length_in": 5000.0, "num_env_steps_trained": 56100, "num_env_steps_trained_lifetime": 224400, "learner_connector": {"timers": {"connectors": {"general_advantage_estimation": 0.013680971404552997, "add_one_ts_to_episodes_and_truncate": 0.00868431461492124, "add_observations_from_episodes_to_batch": 0.0008119116219671459, "add_states_from_episodes_to_batch": 5.926571756187513e-06, "batch_individual_items": 0.20250707119616365, "add_time_dim_to_batch_and_zero_pad": 2.08934868677652e-05, "add_columns_from_episodes_to_train_batch": 0.06964809721291111, "numpy_to_tensor": 0.0001577944723388391}}, "connector_pipeline_timer": 0.2958547527396778}, "num_non_trainable_parameters": 0, "num_module_steps_trained_lifetime": 44000, "learner_connector_sum_episodes_length_out": 5100.0, "num_module_steps_trained": 11000, "num_env_steps_trained_lifetime_throughput": 1004238.4062442938, "num_module_steps_trained_throughput": 197615.29194616625, "num_module_steps_trained_lifetime_throughput": 197443.50048666165}, "default_policy": {"vf_explained_var": -0.009923577308654785, "vf_loss": 0.29535847902297974, "policy_loss": -0.04731979966163635, "vf_loss_unclipped": 47.587806701660156, "diff_num_grad_updates_vs_sampler_policy": 1.0, "num_module_steps_trained_lifetime": 44000, "mean_kl_loss": 0.007190716918557882, "curr_entropy_coeff": 0.0034162146123, "module_train_batch_size_mean": 1000.0, "num_module_steps_trained": 11000, "curr_kl_coeff": 0.011309917084872723, "entropy": 0.6572304368019104, "weights_seq_no": 4.0, "total_loss": 0.11290368437767029, "default_optimizer_learning_rate": 0.0018683590437, "num_trainable_parameters": 10515, "gradients_default_optimizer_global_norm": 0.08854888379573822, "num_module_steps_trained_lifetime_throughput": 197993.05604578502}}, "num_training_step_calls_per_iteration": 1, "evaluation": {"env_runners": {"module_to_env_connector": {"timers": {"connectors": {"listify_data_for_vector_env": 3.123659512270587e-05, "un_batch_to_individual_items": 1.6172707455740874e-05, "normalize_and_clip_actions": 2.234322473030462e-05, "tensor_to_numpy": 4.707758300690061e-05, "get_actions": 0.000160553099183815, "remove_single_ts_time_rank_from_batch": 1.4704086560933663e-06}}, "connector_pipeline_timer": 0.0003563189335869151}, "env_to_module_sum_episodes_length_in": 27.168093332126602, "num_module_steps_sampled": {"default_policy": 1000}, "num_env_steps_sampled_lifetime": 21000, "num_agent_steps_sampled": {"default_agent": 1000}, "num_env_steps_sampled": 1000, "agent_episode_returns_mean": {"default_agent": -0.65}, "episode_len_max": 50, "weights_seq_no": 4.0, "env_to_module_connector": {"timers": {"connectors": {"add_observations_from_episodes_to_batch": 6.458529714297896e-06, "add_states_from_episodes_to_batch": 3.5746519341569346e-06, "batch_individual_items": 1.9196536705442567e-05, "add_time_dim_to_batch_and_zero_pad": 6.368341428664283e-06, "numpy_to_tensor": 3.02065232837659e-05}}, "connector_pipeline_timer": 0.0001187836935936099}, "sample": 0.7345534800912743, "episode_return_min": -16.5, "episode_len_min": 50, "num_episodes_lifetime": 80, "episode_len_mean": 50.0, "episode_return_mean": -0.65, "num_episodes": 20, "num_module_steps_sampled_lifetime": {"default_policy": 4000}, "env_reset_timer": 0.0002101031262217066, "env_step_timer": 4.248295802134333e-05, "num_agent_steps_sampled_lifetime": {"default_agent": 4000}, "episode_duration_sec_mean": 0.0358241237375637, "rlmodule_inference_timer": 0.00010046664009583297, "env_to_module_sum_episodes_length_out": 27.168093332126602, "module_episode_returns_mean": {"default_policy": -0.65}, "episode_return_max": 17.5, "time_between_sampling": 4.250427436129748}, "num_healthy_workers": 1, "actor_manager_num_outstanding_async_reqs": 0, "num_remote_worker_restarts": 0}, "num_env_steps_sampled_lifetime": -475000.0, "fault_tolerance": {"num_healthy_workers": 0, "num_remote_worker_restarts": 0}, "env_runner_group": {"actor_manager_num_outstanding_async_reqs": 0}, "done": false, "training_iteration": 4, "trial_id": "a2615_00000", "date": "2025-08-11_17-27-00", "timestamp": 1754926020, "time_this_iter_s": 5.033306360244751, "time_total_s": 19.979429244995117, "pid": 77556, "hostname": "DESKTOP-3SK5A41", "node_ip": "192.168.40.242", "config": {"exploration_config": {}, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 6, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "env": "Umbrella", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": false, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 0, "create_local_env_runner": true, "num_envs_per_env_runner": 1, "gym_env_vectorize_mode": "SYNC", "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "episodes_to_numpy": true, "max_requests_in_flight_per_env_runner": 1, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "merge_env_runner_states": "training_only", "broadcast_env_runner_states": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "complete_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "sampler_perf_stats_ema_coef": null, "_is_online": true, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": "auto", "num_aggregator_actors_per_learner": 0, "max_requests_in_flight_per_aggregator_actor": 3, "local_gpu_idx": 0, "max_requests_in_flight_per_learner": 3, "gamma": 1, "lr": 0.0018683590437, "grad_clip": 0.5, "grad_clip_by": "global_norm", "_train_batch_size_per_learner": 5000, "train_batch_size": 4000, "num_epochs": 2, "minibatch_size": 1000, "shuffle_batch_per_epoch": true, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "log_std_clip_param": 20.0, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "_disable_preprocessor_api": false, "_disable_action_flattening": false}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "_learner_class": null, "callbacks_on_algorithm_init": null, "callbacks_on_env_runners_recreated": null, "callbacks_on_offline_eval_runners_recreated": null, "callbacks_on_checkpoint_loaded": null, "callbacks_on_environment_created": null, "callbacks_on_episode_created": null, "callbacks_on_episode_start": null, "callbacks_on_episode_step": null, "callbacks_on_episode_end": null, "callbacks_on_evaluate_start": null, "callbacks_on_evaluate_end": null, "callbacks_on_evaluate_offline_start": null, "callbacks_on_evaluate_offline_end": null, "callbacks_on_sample_end": null, "callbacks_on_train_result": null, "explore": true, "enable_rl_module_and_learner": true, "enable_env_runner_and_connector_v2": true, "_prior_exploration_config": {"type": "StochasticSampling"}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x789255972ac0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "offline_data_class": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_read_batch_size": null, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "materialize_data": false, "materialize_mapped_data": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "ignore_final_observation": false, "prelearner_class": null, "prelearner_buffer_class": null, "prelearner_buffer_kwargs": {}, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_remaining_data": false, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": 1, "evaluation_duration": 20, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_auto_duration_min_env_steps_per_sample": 100, "evaluation_auto_duration_max_env_steps_per_sample": 2000, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 1, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "offline_evaluation_interval": null, "num_offline_eval_runners": 0, "offline_loss_for_module_fn": null, "offline_evaluation_duration": 1, "offline_evaluation_parallel_to_training": false, "offline_evaluation_timeout_s": 120.0, "num_cpus_per_offline_eval_runner": 1, "num_gpus_per_offline_eval_runner": 0, "custom_resources_per_offline_eval_runner": {}, "restart_failed_offline_eval_runners": true, "ignore_offline_eval_runner_failures": false, "max_num_offline_eval_runner_restarts": 1000, "offline_eval_runner_restore_timeout_s": 1800.0, "max_requests_in_flight_per_offline_eval_runner": 1, "validate_offline_eval_runners_after_construction": true, "offline_eval_runner_health_probe_timeout_s": 30.0, "offline_eval_rl_module_inference_only": false, "broadcast_offline_eval_runner_states": false, "offline_eval_batch_size_per_runner": 256, "dataset_num_iters_per_eval_runner": 1, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "log_gradients": true, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 42, "restart_failed_env_runners": true, "ignore_env_runner_failures": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30.0, "env_runner_restore_timeout_s": 1800.0, "_model_config": {}, "_rl_module_spec": "RLModuleSpec(module_class=None, observation_space=None, action_space=None, inference_only=False, learner_only=False, model_config=DefaultModelConfig(fcnet_hiddens=[108, 90], fcnet_activation='tanh', fcnet_kernel_initializer=None, fcnet_kernel_initializer_kwargs=None, fcnet_bias_initializer=None, fcnet_bias_initializer_kwargs=None, conv_filters=None, conv_activation='relu', conv_kernel_initializer=None, conv_kernel_initializer_kwargs=None, conv_bias_initializer=None, conv_bias_initializer_kwargs=None, head_fcnet_hiddens=[], head_fcnet_activation='relu', head_fcnet_kernel_initializer=None, head_fcnet_kernel_initializer_kwargs=None, head_fcnet_bias_initializer=None, head_fcnet_bias_initializer_kwargs=None, free_log_std=False, log_std_clip_param=20.0, vf_share_layers=True, use_lstm=False, max_seq_len=20, lstm_cell_size=256, lstm_use_prev_action=False, lstm_use_prev_reward=False, lstm_kernel_initializer=None, lstm_kernel_initializer_kwargs=None, lstm_bias_initializer=None, lstm_bias_initializer_kwargs=None), catalog_class=None, load_state_path=None, model_config_dict=None)", "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "_validate_config": true, "_use_msgpack_checkpoints": false, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "env_task_fn": -1, "enable_connectors": -1, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.1809586766689, "kl_target": 0.02025624843, "vf_loss_coeff": 0.5495223591769, "entropy_coeff": 0.0034162146123, "clip_param": 0.1867229885198, "vf_clip_param": 0.3047866025797, "entropy_coeff_schedule": null, "lr_schedule": null, "sgd_minibatch_size": -1, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9727905109988, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.callbacks.callbacks.RLlibCallback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 19.979429244995117, "iterations_since_restore": 4, "perf": {"cpu_util_percent": 12.857142857142858, "ram_util_percent": 78.89999999999999}}
{"timers": {"training_iteration": 4.25256456421912, "restore_env_runners": 1.58294341821556e-05, "training_step": 4.252262193689478, "env_runner_sampling_timer": 3.8089124066476763, "learner_update_timer": 0.43955362908396084, "synch_weights": 0.0016095921949766435, "restore_eval_env_runners": 1.5044738550802323e-05, "evaluation_iteration": 0.7467778961091066, "synch_eval_env_connectors": 0.00039971744995292286, "synch_env_connectors": 7.288079797259343e-06}, "env_runners": {"env_to_module_sum_episodes_length_out": 27.16809333212661, "agent_episode_returns_mean": {"default_agent": 8.5}, "env_to_module_connector": {"timers": {"connectors": {"add_states_from_episodes_to_batch": 3.4409018454300824e-06, "numpy_to_tensor": 3.074203855312857e-05, "batch_individual_items": 1.8606995770853694e-05, "add_observations_from_episodes_to_batch": 6.2755268192798735e-06, "add_time_dim_to_batch_and_zero_pad": 6.281096058472965e-06}}, "connector_pipeline_timer": 0.00011746868030119437}, "module_to_env_connector": {"timers": {"connectors": {"tensor_to_numpy": 4.802002263417001e-05, "un_batch_to_individual_items": 1.4888432309157602e-05, "get_actions": 0.0001623332543532802, "remove_single_ts_time_rank_from_batch": 1.376818821892582e-06, "listify_data_for_vector_env": 3.1579822817774544e-05, "normalize_and_clip_actions": 2.2136851599236207e-05}}, "connector_pipeline_timer": 0.00035612739974290596}, "num_env_steps_sampled_lifetime": -717500.0, "episode_return_min": -5.5, "num_env_steps_sampled": 5000.0, "episode_len_min": 50, "env_reset_timer": 9.615481622386943e-05, "env_step_timer": 4.2983655706486597e-05, "num_module_steps_sampled_lifetime": {"default_policy": -717500.0}, "module_episode_returns_mean": {"default_policy": 8.5}, "episode_duration_sec_mean": 0.03599003101997368, "num_agent_steps_sampled": {"default_agent": 5000.0}, "num_module_steps_sampled": {"default_policy": 5000.0}, "num_episodes_lifetime": -14350.0, "episode_return_max": 14.5, "episode_len_mean": 50.0, "episode_return_mean": 8.5, "time_between_sampling": 0.012620995050957665, "rlmodule_inference_timer": 9.853720406927078e-05, "num_agent_steps_sampled_lifetime": {"default_agent": -717500.0}, "episode_len_max": 50, "num_episodes": 100.0, "weights_seq_no": 4.0, "env_to_module_sum_episodes_length_in": 27.16809333212661, "sample": 0.03751959921448359, "num_env_steps_sampled_lifetime_throughput": 1294.8676284840246}, "learners": {"__all_modules__": {"num_trainable_parameters": 10515, "learner_connector_sum_episodes_length_in": 5000.0, "num_env_steps_trained": 56100, "num_env_steps_trained_lifetime": 280500, "learner_connector": {"timers": {"connectors": {"general_advantage_estimation": 0.013653313690502914, "add_one_ts_to_episodes_and_truncate": 0.008677618468770788, "add_observations_from_episodes_to_batch": 0.0008108985057502245, "add_states_from_episodes_to_batch": 5.921306040535664e-06, "batch_individual_items": 0.2010852684842064, "add_time_dim_to_batch_and_zero_pad": 2.0879552001437392e-05, "add_columns_from_episodes_to_train_batch": 0.06962891524078103, "numpy_to_tensor": 0.00015777052761584734}}, "connector_pipeline_timer": 0.29437800621228094}, "num_non_trainable_parameters": 0, "num_module_steps_trained_lifetime": 55000, "learner_connector_sum_episodes_length_out": 5100.0, "num_module_steps_trained": 11000, "num_env_steps_trained_lifetime_throughput": 996063.2610644669, "num_module_steps_trained_throughput": 195984.5841731168, "num_module_steps_trained_lifetime_throughput": 195819.58863848908}, "default_policy": {"vf_explained_var": -0.016463875770568848, "vf_loss": 0.29356902837753296, "policy_loss": 0.0337999202311039, "vf_loss_unclipped": 45.668636322021484, "diff_num_grad_updates_vs_sampler_policy": 1.0, "num_module_steps_trained_lifetime": 55000, "mean_kl_loss": 0.003580452175810933, "curr_entropy_coeff": 0.0034162146123, "module_train_batch_size_mean": 1000.0, "num_module_steps_trained": 11000, "curr_kl_coeff": 0.005654958542436361, "entropy": 0.6690783500671387, "weights_seq_no": 5.0, "total_loss": 0.1928774118423462, "default_optimizer_learning_rate": 0.0018683590437, "num_trainable_parameters": 10515, "gradients_default_optimizer_global_norm": 0.0380442850291729, "num_module_steps_trained_lifetime_throughput": 196340.43570030833}}, "num_training_step_calls_per_iteration": 1, "evaluation": {"env_runners": {"module_to_env_connector": {"timers": {"connectors": {"listify_data_for_vector_env": 3.2711541988700684e-05, "un_batch_to_individual_items": 1.705268987221466e-05, "normalize_and_clip_actions": 2.3594935908058316e-05, "tensor_to_numpy": 4.9524765929429387e-05, "get_actions": 0.00016794804725191677, "remove_single_ts_time_rank_from_batch": 1.8204037550716903e-06}}, "connector_pipeline_timer": 0.00037583196122922455}, "env_to_module_sum_episodes_length_in": 27.168093332126602, "num_module_steps_sampled": {"default_policy": 1000}, "num_env_steps_sampled_lifetime": 26000, "num_agent_steps_sampled": {"default_agent": 1000}, "num_env_steps_sampled": 1000, "agent_episode_returns_mean": {"default_agent": -0.9}, "episode_len_max": 50, "weights_seq_no": 5.0, "env_to_module_connector": {"timers": {"connectors": {"add_observations_from_episodes_to_batch": 6.7198500539682084e-06, "add_states_from_episodes_to_batch": 3.739186481475491e-06, "batch_individual_items": 2.0821825754582272e-05, "add_time_dim_to_batch_and_zero_pad": 6.5839110866958574e-06, "numpy_to_tensor": 3.1764320886619884e-05}}, "connector_pipeline_timer": 0.00012457645932788692}, "sample": 0.7346416162903605, "episode_return_min": -16.5, "episode_len_min": 50, "num_episodes_lifetime": 100, "episode_len_mean": 50.0, "episode_return_mean": -0.9, "num_episodes": 20, "num_module_steps_sampled_lifetime": {"default_policy": 5000}, "env_reset_timer": 0.00020950609496114928, "env_step_timer": 4.615213198754493e-05, "num_agent_steps_sampled_lifetime": {"default_agent": 5000}, "episode_duration_sec_mean": 0.035810463990028435, "rlmodule_inference_timer": 0.00010711211879000538, "env_to_module_sum_episodes_length_out": 27.168093332126602, "module_episode_returns_mean": {"default_policy": -0.9}, "episode_return_max": 17.5, "time_between_sampling": 4.249183258788454}, "num_healthy_workers": 1, "actor_manager_num_outstanding_async_reqs": 0, "num_remote_worker_restarts": 0}, "num_env_steps_sampled_lifetime": -717500.0, "fault_tolerance": {"num_healthy_workers": 0, "num_remote_worker_restarts": 0}, "env_runner_group": {"actor_manager_num_outstanding_async_reqs": 0}, "done": false, "training_iteration": 5, "trial_id": "a2615_00000", "date": "2025-08-11_17-27-05", "timestamp": 1754926025, "time_this_iter_s": 4.828293561935425, "time_total_s": 24.807722806930542, "pid": 77556, "hostname": "DESKTOP-3SK5A41", "node_ip": "192.168.40.242", "config": {"exploration_config": {}, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 6, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "env": "Umbrella", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": false, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 0, "create_local_env_runner": true, "num_envs_per_env_runner": 1, "gym_env_vectorize_mode": "SYNC", "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "episodes_to_numpy": true, "max_requests_in_flight_per_env_runner": 1, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "merge_env_runner_states": "training_only", "broadcast_env_runner_states": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "complete_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "sampler_perf_stats_ema_coef": null, "_is_online": true, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": "auto", "num_aggregator_actors_per_learner": 0, "max_requests_in_flight_per_aggregator_actor": 3, "local_gpu_idx": 0, "max_requests_in_flight_per_learner": 3, "gamma": 1, "lr": 0.0018683590437, "grad_clip": 0.5, "grad_clip_by": "global_norm", "_train_batch_size_per_learner": 5000, "train_batch_size": 4000, "num_epochs": 2, "minibatch_size": 1000, "shuffle_batch_per_epoch": true, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "log_std_clip_param": 20.0, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "_disable_preprocessor_api": false, "_disable_action_flattening": false}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "_learner_class": null, "callbacks_on_algorithm_init": null, "callbacks_on_env_runners_recreated": null, "callbacks_on_offline_eval_runners_recreated": null, "callbacks_on_checkpoint_loaded": null, "callbacks_on_environment_created": null, "callbacks_on_episode_created": null, "callbacks_on_episode_start": null, "callbacks_on_episode_step": null, "callbacks_on_episode_end": null, "callbacks_on_evaluate_start": null, "callbacks_on_evaluate_end": null, "callbacks_on_evaluate_offline_start": null, "callbacks_on_evaluate_offline_end": null, "callbacks_on_sample_end": null, "callbacks_on_train_result": null, "explore": true, "enable_rl_module_and_learner": true, "enable_env_runner_and_connector_v2": true, "_prior_exploration_config": {"type": "StochasticSampling"}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x789255972ac0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "offline_data_class": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_read_batch_size": null, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "materialize_data": false, "materialize_mapped_data": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "ignore_final_observation": false, "prelearner_class": null, "prelearner_buffer_class": null, "prelearner_buffer_kwargs": {}, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_remaining_data": false, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": 1, "evaluation_duration": 20, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_auto_duration_min_env_steps_per_sample": 100, "evaluation_auto_duration_max_env_steps_per_sample": 2000, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 1, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "offline_evaluation_interval": null, "num_offline_eval_runners": 0, "offline_loss_for_module_fn": null, "offline_evaluation_duration": 1, "offline_evaluation_parallel_to_training": false, "offline_evaluation_timeout_s": 120.0, "num_cpus_per_offline_eval_runner": 1, "num_gpus_per_offline_eval_runner": 0, "custom_resources_per_offline_eval_runner": {}, "restart_failed_offline_eval_runners": true, "ignore_offline_eval_runner_failures": false, "max_num_offline_eval_runner_restarts": 1000, "offline_eval_runner_restore_timeout_s": 1800.0, "max_requests_in_flight_per_offline_eval_runner": 1, "validate_offline_eval_runners_after_construction": true, "offline_eval_runner_health_probe_timeout_s": 30.0, "offline_eval_rl_module_inference_only": false, "broadcast_offline_eval_runner_states": false, "offline_eval_batch_size_per_runner": 256, "dataset_num_iters_per_eval_runner": 1, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "log_gradients": true, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 42, "restart_failed_env_runners": true, "ignore_env_runner_failures": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30.0, "env_runner_restore_timeout_s": 1800.0, "_model_config": {}, "_rl_module_spec": "RLModuleSpec(module_class=None, observation_space=None, action_space=None, inference_only=False, learner_only=False, model_config=DefaultModelConfig(fcnet_hiddens=[108, 90], fcnet_activation='tanh', fcnet_kernel_initializer=None, fcnet_kernel_initializer_kwargs=None, fcnet_bias_initializer=None, fcnet_bias_initializer_kwargs=None, conv_filters=None, conv_activation='relu', conv_kernel_initializer=None, conv_kernel_initializer_kwargs=None, conv_bias_initializer=None, conv_bias_initializer_kwargs=None, head_fcnet_hiddens=[], head_fcnet_activation='relu', head_fcnet_kernel_initializer=None, head_fcnet_kernel_initializer_kwargs=None, head_fcnet_bias_initializer=None, head_fcnet_bias_initializer_kwargs=None, free_log_std=False, log_std_clip_param=20.0, vf_share_layers=True, use_lstm=False, max_seq_len=20, lstm_cell_size=256, lstm_use_prev_action=False, lstm_use_prev_reward=False, lstm_kernel_initializer=None, lstm_kernel_initializer_kwargs=None, lstm_bias_initializer=None, lstm_bias_initializer_kwargs=None), catalog_class=None, load_state_path=None, model_config_dict=None)", "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "_validate_config": true, "_use_msgpack_checkpoints": false, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "env_task_fn": -1, "enable_connectors": -1, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.1809586766689, "kl_target": 0.02025624843, "vf_loss_coeff": 0.5495223591769, "entropy_coeff": 0.0034162146123, "clip_param": 0.1867229885198, "vf_clip_param": 0.3047866025797, "entropy_coeff_schedule": null, "lr_schedule": null, "sgd_minibatch_size": -1, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9727905109988, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.callbacks.callbacks.RLlibCallback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 24.807722806930542, "iterations_since_restore": 5, "perf": {"cpu_util_percent": 12.514285714285714, "ram_util_percent": 78.89999999999999}}
{"timers": {"training_iteration": 4.252535039636922, "restore_env_runners": 1.578013984267364e-05, "training_step": 4.252232107812582, "env_runner_sampling_timer": 3.8096911576311996, "learner_update_timer": 0.4387456528031129, "synch_weights": 0.0016081032730205797, "restore_eval_env_runners": 1.4994291162768087e-05, "evaluation_iteration": 0.7468412401480143, "synch_eval_env_connectors": 0.00040064827545186556, "synch_env_connectors": 7.282199000140773e-06}, "env_runners": {"env_to_module_sum_episodes_length_out": 27.16809333212661, "agent_episode_returns_mean": {"default_agent": 9.1}, "env_to_module_connector": {"timers": {"connectors": {"add_states_from_episodes_to_batch": 3.5283088272084795e-06, "numpy_to_tensor": 3.083460741155301e-05, "batch_individual_items": 1.869615635136688e-05, "add_observations_from_episodes_to_batch": 6.340607125810803e-06, "add_time_dim_to_batch_and_zero_pad": 6.4801316423636035e-06}}, "connector_pipeline_timer": 0.00011856714680598766}, "module_to_env_connector": {"timers": {"connectors": {"tensor_to_numpy": 4.844283293812585e-05, "un_batch_to_individual_items": 1.503180806253107e-05, "get_actions": 0.0001640656332807248, "remove_single_ts_time_rank_from_batch": 1.379725802937206e-06, "listify_data_for_vector_env": 3.171343873124237e-05, "normalize_and_clip_actions": 2.2441397176676948e-05}}, "connector_pipeline_timer": 0.00035974907519421075}, "num_env_steps_sampled_lifetime": -960000.0, "episode_return_min": -5.5, "num_env_steps_sampled": 5000.0, "episode_len_min": 50, "env_reset_timer": 9.473465674913343e-05, "env_step_timer": 4.317706243788161e-05, "num_module_steps_sampled_lifetime": {"default_policy": -960000.0}, "module_episode_returns_mean": {"default_policy": 9.1}, "episode_duration_sec_mean": 0.03633819705006318, "num_agent_steps_sampled": {"default_agent": 5000.0}, "num_module_steps_sampled": {"default_policy": 5000.0}, "num_episodes_lifetime": -19200.0, "episode_return_max": 14.5, "episode_len_mean": 50.0, "episode_return_mean": 9.1, "time_between_sampling": 0.012001863628637035, "rlmodule_inference_timer": 9.953799734382696e-05, "num_agent_steps_sampled_lifetime": {"default_agent": -960000.0}, "episode_len_max": 50, "num_episodes": 100.0, "weights_seq_no": 5.0, "env_to_module_sum_episodes_length_in": 27.16809333212661, "sample": 0.037344630533142915, "num_env_steps_sampled_lifetime_throughput": 1288.5314800089157}, "learners": {"__all_modules__": {"num_trainable_parameters": 10515, "learner_connector_sum_episodes_length_in": 5000.0, "num_env_steps_trained": 56100, "num_env_steps_trained_lifetime": 336600, "learner_connector": {"timers": {"connectors": {"general_advantage_estimation": 0.01360515855359826, "add_one_ts_to_episodes_and_truncate": 0.008671401284090349, "add_observations_from_episodes_to_batch": 0.0008092845206905348, "add_states_from_episodes_to_batch": 5.913092977386747e-06, "batch_individual_items": 0.20111792680936136, "add_time_dim_to_batch_and_zero_pad": 2.0864756485253317e-05, "add_columns_from_episodes_to_train_batch": 0.06961663608836861, "numpy_to_tensor": 0.0001577768223411466}}, "connector_pipeline_timer": 0.2943418751601614}, "num_non_trainable_parameters": 0, "num_module_steps_trained_lifetime": 66000, "learner_connector_sum_episodes_length_out": 5100.0, "num_module_steps_trained": 11000, "num_env_steps_trained_lifetime_throughput": 987520.2444443728, "num_module_steps_trained_throughput": 194281.09607367837, "num_module_steps_trained_lifetime_throughput": 194122.66421781268}, "default_policy": {"vf_explained_var": -0.013797879219055176, "vf_loss": 0.2922949194908142, "policy_loss": 0.004710004199296236, "vf_loss_unclipped": 47.538822174072266, "diff_num_grad_updates_vs_sampler_policy": 1.0, "num_module_steps_trained_lifetime": 66000, "mean_kl_loss": 0.006384200416505337, "curr_entropy_coeff": 0.0034162146123, "module_train_batch_size_mean": 1000.0, "num_module_steps_trained": 11000, "curr_kl_coeff": 0.0028274792712181807, "entropy": 0.6593641042709351, "weights_seq_no": 6.0, "total_loss": 0.16311615705490112, "default_optimizer_learning_rate": 0.0018683590437, "num_trainable_parameters": 10515, "gradients_default_optimizer_global_norm": 0.06651033461093903, "num_module_steps_trained_lifetime_throughput": 194615.07851340773}}, "num_training_step_calls_per_iteration": 1, "evaluation": {"env_runners": {"module_to_env_connector": {"timers": {"connectors": {"listify_data_for_vector_env": 2.9893462753280007e-05, "un_batch_to_individual_items": 1.5066646338007942e-05, "normalize_and_clip_actions": 2.1693352745441106e-05, "tensor_to_numpy": 4.6170920418044956e-05, "get_actions": 0.00015486999272640474, "remove_single_ts_time_rank_from_batch": 1.5557528226191245e-06}}, "connector_pipeline_timer": 0.00034404377090424787}, "env_to_module_sum_episodes_length_in": 27.168093332126602, "num_module_steps_sampled": {"default_policy": 1000}, "num_env_steps_sampled_lifetime": 31000, "num_agent_steps_sampled": {"default_agent": 1000}, "num_env_steps_sampled": 1000, "agent_episode_returns_mean": {"default_agent": -0.9}, "episode_len_max": 50, "weights_seq_no": 6.0, "env_to_module_connector": {"timers": {"connectors": {"add_observations_from_episodes_to_batch": 6.273918137550819e-06, "add_states_from_episodes_to_batch": 3.5176333415082983e-06, "batch_individual_items": 1.8794490409487477e-05, "add_time_dim_to_batch_and_zero_pad": 6.255386960950544e-06, "numpy_to_tensor": 2.9380005060849773e-05}}, "connector_pipeline_timer": 0.00011658514515139773}, "sample": 0.7346466551374594, "episode_return_min": -16.5, "episode_len_min": 50, "num_episodes_lifetime": 120, "episode_len_mean": 50.0, "episode_return_mean": -0.9, "num_episodes": 20, "num_module_steps_sampled_lifetime": {"default_policy": 6000}, "env_reset_timer": 0.00020865103401295455, "env_step_timer": 4.103698219980265e-05, "num_agent_steps_sampled_lifetime": {"default_agent": 6000}, "episode_duration_sec_mean": 0.035824259999999414, "rlmodule_inference_timer": 9.541654528943563e-05, "env_to_module_sum_episodes_length_out": 27.168093332126602, "module_episode_returns_mean": {"default_policy": -0.9}, "episode_return_max": 17.5, "time_between_sampling": 4.249753051260569}, "num_healthy_workers": 1, "actor_manager_num_outstanding_async_reqs": 0, "num_remote_worker_restarts": 0}, "num_env_steps_sampled_lifetime": -960000.0, "fault_tolerance": {"num_healthy_workers": 0, "num_remote_worker_restarts": 0}, "env_runner_group": {"actor_manager_num_outstanding_async_reqs": 0}, "done": false, "training_iteration": 6, "trial_id": "a2615_00000", "date": "2025-08-11_17-27-10", "timestamp": 1754926030, "time_this_iter_s": 4.999029636383057, "time_total_s": 29.8067524433136, "pid": 77556, "hostname": "DESKTOP-3SK5A41", "node_ip": "192.168.40.242", "config": {"exploration_config": {}, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 6, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "env": "Umbrella", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": false, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 0, "create_local_env_runner": true, "num_envs_per_env_runner": 1, "gym_env_vectorize_mode": "SYNC", "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "episodes_to_numpy": true, "max_requests_in_flight_per_env_runner": 1, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "merge_env_runner_states": "training_only", "broadcast_env_runner_states": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "complete_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "sampler_perf_stats_ema_coef": null, "_is_online": true, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": "auto", "num_aggregator_actors_per_learner": 0, "max_requests_in_flight_per_aggregator_actor": 3, "local_gpu_idx": 0, "max_requests_in_flight_per_learner": 3, "gamma": 1, "lr": 0.0018683590437, "grad_clip": 0.5, "grad_clip_by": "global_norm", "_train_batch_size_per_learner": 5000, "train_batch_size": 4000, "num_epochs": 2, "minibatch_size": 1000, "shuffle_batch_per_epoch": true, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "log_std_clip_param": 20.0, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "_disable_preprocessor_api": false, "_disable_action_flattening": false}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "_learner_class": null, "callbacks_on_algorithm_init": null, "callbacks_on_env_runners_recreated": null, "callbacks_on_offline_eval_runners_recreated": null, "callbacks_on_checkpoint_loaded": null, "callbacks_on_environment_created": null, "callbacks_on_episode_created": null, "callbacks_on_episode_start": null, "callbacks_on_episode_step": null, "callbacks_on_episode_end": null, "callbacks_on_evaluate_start": null, "callbacks_on_evaluate_end": null, "callbacks_on_evaluate_offline_start": null, "callbacks_on_evaluate_offline_end": null, "callbacks_on_sample_end": null, "callbacks_on_train_result": null, "explore": true, "enable_rl_module_and_learner": true, "enable_env_runner_and_connector_v2": true, "_prior_exploration_config": {"type": "StochasticSampling"}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x789255972ac0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "offline_data_class": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_read_batch_size": null, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "materialize_data": false, "materialize_mapped_data": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "ignore_final_observation": false, "prelearner_class": null, "prelearner_buffer_class": null, "prelearner_buffer_kwargs": {}, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_remaining_data": false, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": 1, "evaluation_duration": 20, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_auto_duration_min_env_steps_per_sample": 100, "evaluation_auto_duration_max_env_steps_per_sample": 2000, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 1, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "offline_evaluation_interval": null, "num_offline_eval_runners": 0, "offline_loss_for_module_fn": null, "offline_evaluation_duration": 1, "offline_evaluation_parallel_to_training": false, "offline_evaluation_timeout_s": 120.0, "num_cpus_per_offline_eval_runner": 1, "num_gpus_per_offline_eval_runner": 0, "custom_resources_per_offline_eval_runner": {}, "restart_failed_offline_eval_runners": true, "ignore_offline_eval_runner_failures": false, "max_num_offline_eval_runner_restarts": 1000, "offline_eval_runner_restore_timeout_s": 1800.0, "max_requests_in_flight_per_offline_eval_runner": 1, "validate_offline_eval_runners_after_construction": true, "offline_eval_runner_health_probe_timeout_s": 30.0, "offline_eval_rl_module_inference_only": false, "broadcast_offline_eval_runner_states": false, "offline_eval_batch_size_per_runner": 256, "dataset_num_iters_per_eval_runner": 1, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "log_gradients": true, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 42, "restart_failed_env_runners": true, "ignore_env_runner_failures": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30.0, "env_runner_restore_timeout_s": 1800.0, "_model_config": {}, "_rl_module_spec": "RLModuleSpec(module_class=None, observation_space=None, action_space=None, inference_only=False, learner_only=False, model_config=DefaultModelConfig(fcnet_hiddens=[108, 90], fcnet_activation='tanh', fcnet_kernel_initializer=None, fcnet_kernel_initializer_kwargs=None, fcnet_bias_initializer=None, fcnet_bias_initializer_kwargs=None, conv_filters=None, conv_activation='relu', conv_kernel_initializer=None, conv_kernel_initializer_kwargs=None, conv_bias_initializer=None, conv_bias_initializer_kwargs=None, head_fcnet_hiddens=[], head_fcnet_activation='relu', head_fcnet_kernel_initializer=None, head_fcnet_kernel_initializer_kwargs=None, head_fcnet_bias_initializer=None, head_fcnet_bias_initializer_kwargs=None, free_log_std=False, log_std_clip_param=20.0, vf_share_layers=True, use_lstm=False, max_seq_len=20, lstm_cell_size=256, lstm_use_prev_action=False, lstm_use_prev_reward=False, lstm_kernel_initializer=None, lstm_kernel_initializer_kwargs=None, lstm_bias_initializer=None, lstm_bias_initializer_kwargs=None), catalog_class=None, load_state_path=None, model_config_dict=None)", "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "_validate_config": true, "_use_msgpack_checkpoints": false, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "env_task_fn": -1, "enable_connectors": -1, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.1809586766689, "kl_target": 0.02025624843, "vf_loss_coeff": 0.5495223591769, "entropy_coeff": 0.0034162146123, "clip_param": 0.1867229885198, "vf_clip_param": 0.3047866025797, "entropy_coeff_schedule": null, "lr_schedule": null, "sgd_minibatch_size": -1, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9727905109988, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.callbacks.callbacks.RLlibCallback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 29.8067524433136, "iterations_since_restore": 6, "perf": {"cpu_util_percent": 12.77142857142857, "ram_util_percent": 78.94285714285714}}
{"timers": {"training_iteration": 4.250777556310552, "restore_env_runners": 1.5752338442781817e-05, "training_step": 4.250472560804456, "env_runner_sampling_timer": 3.810183000114889, "learner_update_timer": 0.4364894972850856, "synch_weights": 0.0016061392402909982, "restore_eval_env_runners": 1.4944348248614194e-05, "evaluation_iteration": 0.7468185327565388, "synch_eval_env_connectors": 0.0004006657926971917, "synch_env_connectors": 7.285377006764252e-06}, "env_runners": {"env_to_module_sum_episodes_length_out": 27.16809333212661, "agent_episode_returns_mean": {"default_agent": 9.9}, "env_to_module_connector": {"timers": {"connectors": {"add_states_from_episodes_to_batch": 3.4657018836326996e-06, "numpy_to_tensor": 3.0815964406697624e-05, "batch_individual_items": 1.871541493604724e-05, "add_observations_from_episodes_to_batch": 6.3066776578231465e-06, "add_time_dim_to_batch_and_zero_pad": 6.314032056526903e-06}}, "connector_pipeline_timer": 0.00011796705050419911}, "module_to_env_connector": {"timers": {"connectors": {"tensor_to_numpy": 4.781687564327739e-05, "un_batch_to_individual_items": 1.5027879484283474e-05, "get_actions": 0.00016220274310540028, "remove_single_ts_time_rank_from_batch": 1.3953742195445888e-06, "listify_data_for_vector_env": 3.143547190074456e-05, "normalize_and_clip_actions": 2.2277076993165827e-05}}, "connector_pipeline_timer": 0.00035623564365291216}, "num_env_steps_sampled_lifetime": -1202500.0, "episode_return_min": -5.5, "num_env_steps_sampled": 5000.0, "episode_len_min": 50, "env_reset_timer": 9.360796955088942e-05, "env_step_timer": 4.2961723386328646e-05, "num_module_steps_sampled_lifetime": {"default_policy": -1202500.0}, "module_episode_returns_mean": {"default_policy": 9.9}, "episode_duration_sec_mean": 0.03606133905997922, "num_agent_steps_sampled": {"default_agent": 5000.0}, "num_module_steps_sampled": {"default_policy": 5000.0}, "num_episodes_lifetime": -24050.0, "episode_return_max": 14.5, "episode_len_mean": 50.0, "episode_return_mean": 9.9, "time_between_sampling": 0.012619127367667625, "rlmodule_inference_timer": 9.916859923201872e-05, "num_agent_steps_sampled_lifetime": {"default_agent": -1202500.0}, "episode_len_max": 50, "num_episodes": 100.0, "weights_seq_no": 6.0, "env_to_module_sum_episodes_length_in": 27.16809333212661, "sample": 0.037260701344870674, "num_env_steps_sampled_lifetime_throughput": 1294.7337046787804}, "learners": {"__all_modules__": {"num_trainable_parameters": 10515, "learner_connector_sum_episodes_length_in": 5000.0, "num_env_steps_trained": 56100, "num_env_steps_trained_lifetime": 392700, "learner_connector": {"timers": {"connectors": {"general_advantage_estimation": 0.013558660968067869, "add_one_ts_to_episodes_and_truncate": 0.008668067271245842, "add_observations_from_episodes_to_batch": 0.0008082376754842572, "add_states_from_episodes_to_batch": 5.903962046349773e-06, "batch_individual_items": 0.19971621154127606, "add_time_dim_to_batch_and_zero_pad": 2.0849108916616587e-05, "add_columns_from_episodes_to_train_batch": 0.06959954072748904, "numpy_to_tensor": 0.00015798405412175497}}, "connector_pipeline_timer": 0.2928719334085594}, "num_non_trainable_parameters": 0, "num_module_steps_trained_lifetime": 77000, "learner_connector_sum_episodes_length_out": 5100.0, "num_module_steps_trained": 11000, "num_env_steps_trained_lifetime_throughput": 979405.9545164042, "num_module_steps_trained_throughput": 192662.18910483198, "num_module_steps_trained_lifetime_throughput": 192509.77893701807}, "default_policy": {"vf_explained_var": -0.017589330673217773, "vf_loss": 0.29608842730522156, "policy_loss": 0.0519908182322979, "vf_loss_unclipped": 47.812744140625, "diff_num_grad_updates_vs_sampler_policy": 1.0, "num_module_steps_trained_lifetime": 77000, "mean_kl_loss": 0.00867356825619936, "curr_entropy_coeff": 0.0034162146123, "module_train_batch_size_mean": 1000.0, "num_module_steps_trained": 11000, "curr_kl_coeff": 0.0014137396356090903, "entropy": 0.6382993459701538, "weights_seq_no": 7.0, "total_loss": 0.21254198253154755, "default_optimizer_learning_rate": 0.0018683590437, "num_trainable_parameters": 10515, "gradients_default_optimizer_global_norm": 0.1137552484869957, "num_module_steps_trained_lifetime_throughput": 192974.2477681961}}, "num_training_step_calls_per_iteration": 1, "evaluation": {"env_runners": {"module_to_env_connector": {"timers": {"connectors": {"listify_data_for_vector_env": 2.962388783578948e-05, "un_batch_to_individual_items": 1.5451439362450303e-05, "normalize_and_clip_actions": 2.161275518949969e-05, "tensor_to_numpy": 4.5177901957072715e-05, "get_actions": 0.0001524735484181757, "remove_single_ts_time_rank_from_batch": 1.4218770769642273e-06}}, "connector_pipeline_timer": 0.00034032037070316485}, "env_to_module_sum_episodes_length_in": 27.168093332126602, "num_module_steps_sampled": {"default_policy": 1000}, "num_env_steps_sampled_lifetime": 36000, "num_agent_steps_sampled": {"default_agent": 1000}, "num_env_steps_sampled": 1000, "agent_episode_returns_mean": {"default_agent": -1.5}, "episode_len_max": 50, "weights_seq_no": 7.0, "env_to_module_connector": {"timers": {"connectors": {"add_observations_from_episodes_to_batch": 6.252524379207697e-06, "add_states_from_episodes_to_batch": 3.3321563526314924e-06, "batch_individual_items": 1.8154439735793323e-05, "add_time_dim_to_batch_and_zero_pad": 6.036588450873308e-06, "numpy_to_tensor": 2.883221435451235e-05}}, "connector_pipeline_timer": 0.00011366291400635211}, "sample": 0.7345706636160847, "episode_return_min": -16.5, "episode_len_min": 50, "num_episodes_lifetime": 140, "episode_len_mean": 50.0, "episode_return_mean": -1.5, "num_episodes": 20, "num_module_steps_sampled_lifetime": {"default_policy": 7000}, "env_reset_timer": 0.000207810523674454, "env_step_timer": 4.1360847250942924e-05, "num_agent_steps_sampled_lifetime": {"default_agent": 7000}, "episode_duration_sec_mean": 0.03538234603997807, "rlmodule_inference_timer": 9.589967107918504e-05, "env_to_module_sum_episodes_length_out": 27.168093332126602, "module_episode_returns_mean": {"default_policy": -1.5}, "episode_return_max": 17.5, "time_between_sampling": 4.24856864881796}, "num_healthy_workers": 1, "actor_manager_num_outstanding_async_reqs": 0, "num_remote_worker_restarts": 0}, "num_env_steps_sampled_lifetime": -1202500.0, "fault_tolerance": {"num_healthy_workers": 0, "num_remote_worker_restarts": 0}, "env_runner_group": {"actor_manager_num_outstanding_async_reqs": 0}, "done": true, "training_iteration": 7, "trial_id": "a2615_00000", "date": "2025-08-11_17-27-14", "timestamp": 1754926034, "time_this_iter_s": 4.817593336105347, "time_total_s": 34.624345779418945, "pid": 77556, "hostname": "DESKTOP-3SK5A41", "node_ip": "192.168.40.242", "config": {"exploration_config": {}, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 6, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "env": "Umbrella", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": false, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 0, "create_local_env_runner": true, "num_envs_per_env_runner": 1, "gym_env_vectorize_mode": "SYNC", "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "episodes_to_numpy": true, "max_requests_in_flight_per_env_runner": 1, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "merge_env_runner_states": "training_only", "broadcast_env_runner_states": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "complete_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "sampler_perf_stats_ema_coef": null, "_is_online": true, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": "auto", "num_aggregator_actors_per_learner": 0, "max_requests_in_flight_per_aggregator_actor": 3, "local_gpu_idx": 0, "max_requests_in_flight_per_learner": 3, "gamma": 1, "lr": 0.0018683590437, "grad_clip": 0.5, "grad_clip_by": "global_norm", "_train_batch_size_per_learner": 5000, "train_batch_size": 4000, "num_epochs": 2, "minibatch_size": 1000, "shuffle_batch_per_epoch": true, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "log_std_clip_param": 20.0, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "_disable_preprocessor_api": false, "_disable_action_flattening": false}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "_learner_class": null, "callbacks_on_algorithm_init": null, "callbacks_on_env_runners_recreated": null, "callbacks_on_offline_eval_runners_recreated": null, "callbacks_on_checkpoint_loaded": null, "callbacks_on_environment_created": null, "callbacks_on_episode_created": null, "callbacks_on_episode_start": null, "callbacks_on_episode_step": null, "callbacks_on_episode_end": null, "callbacks_on_evaluate_start": null, "callbacks_on_evaluate_end": null, "callbacks_on_evaluate_offline_start": null, "callbacks_on_evaluate_offline_end": null, "callbacks_on_sample_end": null, "callbacks_on_train_result": null, "explore": true, "enable_rl_module_and_learner": true, "enable_env_runner_and_connector_v2": true, "_prior_exploration_config": {"type": "StochasticSampling"}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x789255972ac0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "offline_data_class": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_read_batch_size": null, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "materialize_data": false, "materialize_mapped_data": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "ignore_final_observation": false, "prelearner_class": null, "prelearner_buffer_class": null, "prelearner_buffer_kwargs": {}, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_remaining_data": false, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": 1, "evaluation_duration": 20, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_auto_duration_min_env_steps_per_sample": 100, "evaluation_auto_duration_max_env_steps_per_sample": 2000, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 1, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "offline_evaluation_interval": null, "num_offline_eval_runners": 0, "offline_loss_for_module_fn": null, "offline_evaluation_duration": 1, "offline_evaluation_parallel_to_training": false, "offline_evaluation_timeout_s": 120.0, "num_cpus_per_offline_eval_runner": 1, "num_gpus_per_offline_eval_runner": 0, "custom_resources_per_offline_eval_runner": {}, "restart_failed_offline_eval_runners": true, "ignore_offline_eval_runner_failures": false, "max_num_offline_eval_runner_restarts": 1000, "offline_eval_runner_restore_timeout_s": 1800.0, "max_requests_in_flight_per_offline_eval_runner": 1, "validate_offline_eval_runners_after_construction": true, "offline_eval_runner_health_probe_timeout_s": 30.0, "offline_eval_rl_module_inference_only": false, "broadcast_offline_eval_runner_states": false, "offline_eval_batch_size_per_runner": 256, "dataset_num_iters_per_eval_runner": 1, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "log_gradients": true, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 42, "restart_failed_env_runners": true, "ignore_env_runner_failures": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30.0, "env_runner_restore_timeout_s": 1800.0, "_model_config": {}, "_rl_module_spec": "RLModuleSpec(module_class=None, observation_space=None, action_space=None, inference_only=False, learner_only=False, model_config=DefaultModelConfig(fcnet_hiddens=[108, 90], fcnet_activation='tanh', fcnet_kernel_initializer=None, fcnet_kernel_initializer_kwargs=None, fcnet_bias_initializer=None, fcnet_bias_initializer_kwargs=None, conv_filters=None, conv_activation='relu', conv_kernel_initializer=None, conv_kernel_initializer_kwargs=None, conv_bias_initializer=None, conv_bias_initializer_kwargs=None, head_fcnet_hiddens=[], head_fcnet_activation='relu', head_fcnet_kernel_initializer=None, head_fcnet_kernel_initializer_kwargs=None, head_fcnet_bias_initializer=None, head_fcnet_bias_initializer_kwargs=None, free_log_std=False, log_std_clip_param=20.0, vf_share_layers=True, use_lstm=False, max_seq_len=20, lstm_cell_size=256, lstm_use_prev_action=False, lstm_use_prev_reward=False, lstm_kernel_initializer=None, lstm_kernel_initializer_kwargs=None, lstm_bias_initializer=None, lstm_bias_initializer_kwargs=None), catalog_class=None, load_state_path=None, model_config_dict=None)", "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "_validate_config": true, "_use_msgpack_checkpoints": false, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "env_task_fn": -1, "enable_connectors": -1, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.1809586766689, "kl_target": 0.02025624843, "vf_loss_coeff": 0.5495223591769, "entropy_coeff": 0.0034162146123, "clip_param": 0.1867229885198, "vf_clip_param": 0.3047866025797, "entropy_coeff_schedule": null, "lr_schedule": null, "sgd_minibatch_size": -1, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9727905109988, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.callbacks.callbacks.RLlibCallback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 34.624345779418945, "iterations_since_restore": 7, "perf": {"cpu_util_percent": 12.428571428571429, "ram_util_percent": 78.95714285714287}}
