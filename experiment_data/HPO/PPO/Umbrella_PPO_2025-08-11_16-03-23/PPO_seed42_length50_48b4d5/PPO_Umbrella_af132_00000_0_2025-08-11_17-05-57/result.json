{"timers": {"training_iteration": 4.257684089999202, "restore_env_runners": 1.6400000276917126e-05, "training_step": 4.257455989999471, "env_runner_sampling_timer": 3.8030402900003537, "learner_update_timer": 0.4509149999994406, "synch_weights": 0.0015021999997770763}, "env_runners": {"env_to_module_connector": {"timers": {"connectors": {"add_observations_from_episodes_to_batch": 6.569404813420216e-06, "add_time_dim_to_batch_and_zero_pad": 6.600562033003668e-06, "add_states_from_episodes_to_batch": 3.500423073427081e-06, "batch_individual_items": 1.8536799949461703e-05, "numpy_to_tensor": 3.105837881421708e-05}}, "connector_pipeline_timer": 0.00012098882190486779}, "num_episodes": 100.0, "num_agent_steps_sampled_lifetime": {"default_agent": 252500.0}, "weights_seq_no": 0.0, "episode_return_max": 14.5, "module_to_env_connector": {"timers": {"connectors": {"normalize_and_clip_actions": 2.8745287173538862e-05, "listify_data_for_vector_env": 3.05442700009219e-05, "get_actions": 0.00016451573283724096, "un_batch_to_individual_items": 1.5372203536457018e-05, "tensor_to_numpy": 4.6809753845306896e-05, "remove_single_ts_time_rank_from_batch": 1.5253939106673427e-06}}, "connector_pipeline_timer": 0.00036376043494451094}, "time_between_sampling": 0.0011904055034622062, "num_episodes_lifetime": 5050.0, "episode_len_max": 50, "sample": 0.038805848661325124, "num_agent_steps_sampled": {"default_agent": 5000.0}, "env_reset_timer": 0.00019173495660279076, "agent_episode_returns_mean": {"default_agent": 7.9}, "rlmodule_inference_timer": 0.00010321543193028415, "episode_return_min": -5.5, "num_env_steps_sampled_lifetime": 252500.0, "episode_len_min": 50, "episode_duration_sec_mean": 0.0355767569099862, "episode_len_mean": 50.0, "num_module_steps_sampled": {"default_policy": 5000.0}, "episode_return_mean": 7.9, "num_module_steps_sampled_lifetime": {"default_policy": 252500.0}, "env_to_module_sum_episodes_length_in": 26.762340024562445, "module_episode_returns_mean": {"default_policy": 7.9}, "num_env_steps_sampled": 5000.0, "env_to_module_sum_episodes_length_out": 26.762340024562445, "env_step_timer": 4.3510339792214434e-05, "num_env_steps_sampled_lifetime_throughput": 1276.0095207529232}, "learners": {"__all_modules__": {"num_non_trainable_parameters": 0, "num_module_steps_trained": 11000, "learner_connector": {"timers": {"connectors": {"add_time_dim_to_batch_and_zero_pad": 2.6200000320386607e-05, "batch_individual_items": 0.20342889999938052, "general_advantage_estimation": 0.012802199999896402, "add_states_from_episodes_to_batch": 6.099999154685065e-06, "numpy_to_tensor": 0.00015870000061113387, "add_one_ts_to_episodes_and_truncate": 0.008229099999880418, "add_columns_from_episodes_to_train_batch": 0.06671399999959249, "add_observations_from_episodes_to_batch": 0.0007492000004276633}}, "connector_pipeline_timer": 0.29239140000026964}, "num_module_steps_trained_lifetime": 11000, "learner_connector_sum_episodes_length_in": 5000, "num_env_steps_trained": 56100, "num_trainable_parameters": 13237, "learner_connector_sum_episodes_length_out": 5100, "num_env_steps_trained_lifetime": 56100, "num_env_steps_trained_lifetime_throughput": 811282.7951046414, "num_module_steps_trained_throughput": 159558.46505875076, "num_module_steps_trained_lifetime_throughput": 159449.67154836268}, "default_policy": {"curr_entropy_coeff": 0.0432335706043, "weights_seq_no": 1.0, "curr_kl_coeff": 0.17925631999969482, "entropy": 0.6879348754882812, "total_loss": 0.02291744574904442, "num_module_steps_trained_lifetime": 11000, "gradients_default_optimizer_global_norm": 0.06100073456764221, "num_module_steps_trained": 11000, "vf_explained_var": 0.017135202884674072, "vf_loss": 0.09730879217386246, "policy_loss": -0.0037474872078746557, "default_optimizer_learning_rate": 3.68800684e-05, "module_train_batch_size_mean": 1000.0, "vf_loss_unclipped": 13.727811813354492, "mean_kl_loss": 0.0001787059591151774, "num_trainable_parameters": 13237, "diff_num_grad_updates_vs_sampler_policy": 1.0, "num_module_steps_trained_lifetime_throughput": 159920.77484518365}}, "num_training_step_calls_per_iteration": 1, "num_env_steps_sampled_lifetime": 252500.0, "evaluation": {"env_runners": {"env_to_module_connector": {"timers": {"connectors": {"add_states_from_episodes_to_batch": 3.3294485947982846e-06, "numpy_to_tensor": 2.9639090854840417e-05, "add_observations_from_episodes_to_batch": 6.092048124427133e-06, "add_time_dim_to_batch_and_zero_pad": 5.278262262036162e-06, "batch_individual_items": 1.792102182920142e-05}}, "connector_pipeline_timer": 0.00011465073611503714}, "episode_len_max": 50, "module_to_env_connector": {"timers": {"connectors": {"remove_single_ts_time_rank_from_batch": 1.3501540516450904e-06, "get_actions": 0.0001563047827339838, "un_batch_to_individual_items": 1.5016529893532695e-05, "tensor_to_numpy": 4.6375623884126126e-05, "normalize_and_clip_actions": 2.1244577770927386e-05, "listify_data_for_vector_env": 3.0437669265072056e-05}}, "connector_pipeline_timer": 0.00034546313736838285}, "episode_return_min": -16.5, "num_env_steps_sampled_lifetime": 6000, "env_to_module_sum_episodes_length_out": 27.167134025045954, "num_episodes_lifetime": 20, "num_agent_steps_sampled_lifetime": {"default_agent": 1000}, "env_reset_timer": 0.00024149999990186188, "rlmodule_inference_timer": 9.885728175113458e-05, "episode_duration_sec_mean": 0.0359042000500267, "episode_len_mean": 50.0, "episode_return_mean": -3.9, "num_env_steps_sampled": 1000, "num_module_steps_sampled": {"default_policy": 1000}, "episode_return_max": 13.5, "module_episode_returns_mean": {"default_policy": -3.9}, "sample": 0.7470759010002439, "episode_len_min": 50, "env_to_module_sum_episodes_length_in": 27.167134025045954, "num_episodes": 20, "num_module_steps_sampled_lifetime": {"default_policy": 1000}, "num_agent_steps_sampled": {"default_agent": 1000}, "agent_episode_returns_mean": {"default_agent": -3.9}, "env_step_timer": 4.192760238008746e-05, "weights_seq_no": 1.0}, "num_healthy_workers": 1, "actor_manager_num_outstanding_async_reqs": 0, "num_remote_worker_restarts": 0}, "fault_tolerance": {"num_healthy_workers": 0, "num_remote_worker_restarts": 0}, "env_runner_group": {"actor_manager_num_outstanding_async_reqs": 0}, "done": false, "training_iteration": 1, "trial_id": "af132_00000", "date": "2025-08-11_17-17-33", "timestamp": 1754925453, "time_this_iter_s": 5.020359754562378, "time_total_s": 5.020359754562378, "pid": 69010, "hostname": "DESKTOP-3SK5A41", "node_ip": "192.168.40.242", "config": {"exploration_config": {}, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 6, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "env": "Umbrella", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": false, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 0, "create_local_env_runner": true, "num_envs_per_env_runner": 1, "gym_env_vectorize_mode": "SYNC", "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "episodes_to_numpy": true, "max_requests_in_flight_per_env_runner": 1, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "merge_env_runner_states": "training_only", "broadcast_env_runner_states": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "complete_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "sampler_perf_stats_ema_coef": null, "_is_online": true, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": "auto", "num_aggregator_actors_per_learner": 0, "max_requests_in_flight_per_aggregator_actor": 3, "local_gpu_idx": 0, "max_requests_in_flight_per_learner": 3, "gamma": 1, "lr": 3.68800684e-05, "grad_clip": 0.5, "grad_clip_by": "global_norm", "_train_batch_size_per_learner": 5000, "train_batch_size": 4000, "num_epochs": 2, "minibatch_size": 1000, "shuffle_batch_per_epoch": true, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "log_std_clip_param": 20.0, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "_disable_preprocessor_api": false, "_disable_action_flattening": false}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "_learner_class": null, "callbacks_on_algorithm_init": null, "callbacks_on_env_runners_recreated": null, "callbacks_on_offline_eval_runners_recreated": null, "callbacks_on_checkpoint_loaded": null, "callbacks_on_environment_created": null, "callbacks_on_episode_created": null, "callbacks_on_episode_start": null, "callbacks_on_episode_step": null, "callbacks_on_episode_end": null, "callbacks_on_evaluate_start": null, "callbacks_on_evaluate_end": null, "callbacks_on_evaluate_offline_start": null, "callbacks_on_evaluate_offline_end": null, "callbacks_on_sample_end": null, "callbacks_on_train_result": null, "explore": true, "enable_rl_module_and_learner": true, "enable_env_runner_and_connector_v2": true, "_prior_exploration_config": {"type": "StochasticSampling"}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7e3fa4feaac0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "offline_data_class": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_read_batch_size": null, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "materialize_data": false, "materialize_mapped_data": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "ignore_final_observation": false, "prelearner_class": null, "prelearner_buffer_class": null, "prelearner_buffer_kwargs": {}, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_remaining_data": false, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": 1, "evaluation_duration": 20, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_auto_duration_min_env_steps_per_sample": 100, "evaluation_auto_duration_max_env_steps_per_sample": 2000, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 1, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "offline_evaluation_interval": null, "num_offline_eval_runners": 0, "offline_loss_for_module_fn": null, "offline_evaluation_duration": 1, "offline_evaluation_parallel_to_training": false, "offline_evaluation_timeout_s": 120.0, "num_cpus_per_offline_eval_runner": 1, "num_gpus_per_offline_eval_runner": 0, "custom_resources_per_offline_eval_runner": {}, "restart_failed_offline_eval_runners": true, "ignore_offline_eval_runner_failures": false, "max_num_offline_eval_runner_restarts": 1000, "offline_eval_runner_restore_timeout_s": 1800.0, "max_requests_in_flight_per_offline_eval_runner": 1, "validate_offline_eval_runners_after_construction": true, "offline_eval_runner_health_probe_timeout_s": 30.0, "offline_eval_rl_module_inference_only": false, "broadcast_offline_eval_runner_states": false, "offline_eval_batch_size_per_runner": 256, "dataset_num_iters_per_eval_runner": 1, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "log_gradients": true, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 42, "restart_failed_env_runners": true, "ignore_env_runner_failures": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30.0, "env_runner_restore_timeout_s": 1800.0, "_model_config": {}, "_rl_module_spec": "RLModuleSpec(module_class=None, observation_space=None, action_space=None, inference_only=False, learner_only=False, model_config=DefaultModelConfig(fcnet_hiddens=[102, 121], fcnet_activation='tanh', fcnet_kernel_initializer=None, fcnet_kernel_initializer_kwargs=None, fcnet_bias_initializer=None, fcnet_bias_initializer_kwargs=None, conv_filters=None, conv_activation='relu', conv_kernel_initializer=None, conv_kernel_initializer_kwargs=None, conv_bias_initializer=None, conv_bias_initializer_kwargs=None, head_fcnet_hiddens=[], head_fcnet_activation='relu', head_fcnet_kernel_initializer=None, head_fcnet_kernel_initializer_kwargs=None, head_fcnet_bias_initializer=None, head_fcnet_bias_initializer_kwargs=None, free_log_std=False, log_std_clip_param=20.0, vf_share_layers=True, use_lstm=False, max_seq_len=20, lstm_cell_size=256, lstm_use_prev_action=False, lstm_use_prev_reward=False, lstm_kernel_initializer=None, lstm_kernel_initializer_kwargs=None, lstm_bias_initializer=None, lstm_bias_initializer_kwargs=None), catalog_class=None, load_state_path=None, model_config_dict=None)", "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "_validate_config": true, "_use_msgpack_checkpoints": false, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "env_task_fn": -1, "enable_connectors": -1, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.3585126254792, "kl_target": 0.0279643282718, "vf_loss_coeff": 0.5790097361641, "entropy_coeff": 0.0432335706043, "clip_param": 0.1935989459602, "vf_clip_param": 0.1014075551514, "entropy_coeff_schedule": null, "lr_schedule": null, "sgd_minibatch_size": -1, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9084803827711, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.callbacks.callbacks.RLlibCallback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 5.020359754562378, "iterations_since_restore": 1, "perf": {"cpu_util_percent": 11.3625, "ram_util_percent": 69.75}}
{"timers": {"training_iteration": 4.256082899109206, "restore_env_runners": 1.6400000276917126e-05, "training_step": 4.255852428109474, "env_runner_sampling_timer": 3.80385070410035, "learner_update_timer": 0.4485023450094468, "synch_weights": 0.0015009809997809497, "restore_eval_env_runners": 1.449999945180025e-05, "evaluation_iteration": 0.7590060009997615, "synch_eval_env_connectors": 0.00044579999939742265, "synch_env_connectors": 2.1800000467919745e-05}, "env_runners": {"env_to_module_connector": {"timers": {"connectors": {"add_observations_from_episodes_to_batch": 6.428715446625303e-06, "add_time_dim_to_batch_and_zero_pad": 6.448156837495977e-06, "add_states_from_episodes_to_batch": 3.4636924371389197e-06, "batch_individual_items": 1.8197525535577935e-05, "numpy_to_tensor": 3.0999845993619755e-05}}, "connector_pipeline_timer": 0.00011816372278467857}, "num_episodes": 100.0, "num_agent_steps_sampled_lifetime": {"default_agent": 10000.0}, "weights_seq_no": 1.0, "episode_return_max": 14.5, "module_to_env_connector": {"timers": {"connectors": {"normalize_and_clip_actions": 2.227795917198886e-05, "listify_data_for_vector_env": 3.056006246979083e-05, "get_actions": 0.00016246815843892607, "un_batch_to_individual_items": 1.5281721033883317e-05, "tensor_to_numpy": 4.85323630466061e-05, "remove_single_ts_time_rank_from_batch": 1.5139006392331233e-06}}, "connector_pipeline_timer": 0.0003575926769114619}, "time_between_sampling": 0.00929118208889523, "num_episodes_lifetime": 200.0, "episode_len_max": 50, "sample": 0.03772226177911579, "num_agent_steps_sampled": {"default_agent": 5000.0}, "env_reset_timer": 0.0001292179119141808, "agent_episode_returns_mean": {"default_agent": 5.700000000000004}, "rlmodule_inference_timer": 0.0001010500583512447, "episode_return_min": -5.5, "num_env_steps_sampled_lifetime": 10000.0, "episode_len_min": 50, "episode_duration_sec_mean": 0.036324265000021116, "episode_len_mean": 50.0, "num_module_steps_sampled": {"default_policy": 5000.0}, "episode_return_mean": 5.700000000000004, "num_module_steps_sampled_lifetime": {"default_policy": 10000.0}, "env_to_module_sum_episodes_length_in": 27.16809333212661, "module_episode_returns_mean": {"default_policy": 5.700000000000004}, "num_env_steps_sampled": 5000.0, "env_to_module_sum_episodes_length_out": 27.16809333212661, "env_step_timer": 4.2612226314222114e-05, "num_env_steps_sampled_lifetime_throughput": 1291.0657037263643}, "learners": {"__all_modules__": {"num_non_trainable_parameters": 0, "num_module_steps_trained": 11000, "learner_connector": {"timers": {"connectors": {"add_time_dim_to_batch_and_zero_pad": 2.6179000315096346e-05, "batch_individual_items": 0.20197673500939345, "general_advantage_estimation": 0.01278020299990203, "add_states_from_episodes_to_batch": 6.100999162299558e-06, "numpy_to_tensor": 0.00015873400060627317, "add_one_ts_to_episodes_and_truncate": 0.008226306999886218, "add_columns_from_episodes_to_train_batch": 0.06671655699959955, "add_observations_from_episodes_to_batch": 0.0007484720004231349}}, "connector_pipeline_timer": 0.2909164690102716}, "num_module_steps_trained_lifetime": 22000, "learner_connector_sum_episodes_length_in": 5000.0, "num_env_steps_trained": 56100, "num_trainable_parameters": 13237, "learner_connector_sum_episodes_length_out": 5100.0, "num_env_steps_trained_lifetime": 112200, "num_env_steps_trained_lifetime_throughput": 813051.7440416529, "num_module_steps_trained_throughput": 159894.36090823176, "num_module_steps_trained_lifetime_throughput": 159787.979322598}, "default_policy": {"curr_entropy_coeff": 0.0432335706043, "weights_seq_no": 2.0, "curr_kl_coeff": 0.08962815999984741, "entropy": 0.6880947947502136, "total_loss": 0.07422540336847305, "num_module_steps_trained_lifetime": 22000, "gradients_default_optimizer_global_norm": 0.020153846591711044, "num_module_steps_trained": 11000, "vf_explained_var": 0.020827889442443848, "vf_loss": 0.09586163610219955, "policy_loss": 0.048467375338077545, "default_optimizer_learning_rate": 3.68800684e-05, "module_train_batch_size_mean": 1000.0, "vf_loss_unclipped": 12.91484546661377, "mean_kl_loss": 1.1074421308876481e-05, "num_trainable_parameters": 13237, "diff_num_grad_updates_vs_sampler_policy": 1.0, "num_module_steps_trained_lifetime_throughput": 160247.1512143788}}, "num_training_step_calls_per_iteration": 1, "evaluation": {"env_runners": {"env_to_module_connector": {"timers": {"connectors": {"add_states_from_episodes_to_batch": 3.2435590147798094e-06, "numpy_to_tensor": 3.0269672043150395e-05, "add_observations_from_episodes_to_batch": 6.124067362406499e-06, "add_time_dim_to_batch_and_zero_pad": 5.5886009990817e-06, "batch_individual_items": 1.8051797670511773e-05}}, "connector_pipeline_timer": 0.0001163036389653582}, "episode_len_max": 50, "module_to_env_connector": {"timers": {"connectors": {"remove_single_ts_time_rank_from_batch": 1.3675252646434835e-06, "get_actions": 0.000156564856613721, "un_batch_to_individual_items": 1.533880472739966e-05, "tensor_to_numpy": 4.588299367227186e-05, "normalize_and_clip_actions": 2.1661066936744252e-05, "listify_data_for_vector_env": 3.0908915065997615e-05}}, "connector_pipeline_timer": 0.0003481976108203176}, "episode_return_min": -16.5, "num_env_steps_sampled_lifetime": 11000, "env_to_module_sum_episodes_length_out": 27.168093298253442, "num_episodes_lifetime": 40, "num_agent_steps_sampled_lifetime": {"default_agent": 2000}, "env_reset_timer": 0.00024038299990024824, "rlmodule_inference_timer": 9.872835064123298e-05, "episode_duration_sec_mean": 0.03585420249994513, "episode_len_mean": 50.0, "episode_return_mean": -1.4, "num_env_steps_sampled": 1000, "num_module_steps_sampled": {"default_policy": 1000}, "episode_return_max": 17.5, "module_episode_returns_mean": {"default_policy": -1.4}, "sample": 0.747046100980242, "episode_len_min": 50, "env_to_module_sum_episodes_length_in": 27.168093298253442, "num_episodes": 20, "num_module_steps_sampled_lifetime": {"default_policy": 2000}, "num_agent_steps_sampled": {"default_agent": 1000}, "agent_episode_returns_mean": {"default_agent": -1.4}, "env_step_timer": 4.2621375218200515e-05, "weights_seq_no": 2.0, "time_between_sampling": 4.151707001000432}, "num_healthy_workers": 1, "actor_manager_num_outstanding_async_reqs": 0, "num_remote_worker_restarts": 0}, "num_env_steps_sampled_lifetime": 10000.0, "fault_tolerance": {"num_healthy_workers": 0, "num_remote_worker_restarts": 0}, "env_runner_group": {"actor_manager_num_outstanding_async_reqs": 0}, "done": false, "training_iteration": 2, "trial_id": "af132_00000", "date": "2025-08-11_17-17-37", "timestamp": 1754925457, "time_this_iter_s": 4.854656457901001, "time_total_s": 9.875016212463379, "pid": 69010, "hostname": "DESKTOP-3SK5A41", "node_ip": "192.168.40.242", "config": {"exploration_config": {}, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 6, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "env": "Umbrella", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": false, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 0, "create_local_env_runner": true, "num_envs_per_env_runner": 1, "gym_env_vectorize_mode": "SYNC", "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "episodes_to_numpy": true, "max_requests_in_flight_per_env_runner": 1, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "merge_env_runner_states": "training_only", "broadcast_env_runner_states": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "complete_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "sampler_perf_stats_ema_coef": null, "_is_online": true, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": "auto", "num_aggregator_actors_per_learner": 0, "max_requests_in_flight_per_aggregator_actor": 3, "local_gpu_idx": 0, "max_requests_in_flight_per_learner": 3, "gamma": 1, "lr": 3.68800684e-05, "grad_clip": 0.5, "grad_clip_by": "global_norm", "_train_batch_size_per_learner": 5000, "train_batch_size": 4000, "num_epochs": 2, "minibatch_size": 1000, "shuffle_batch_per_epoch": true, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "log_std_clip_param": 20.0, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "_disable_preprocessor_api": false, "_disable_action_flattening": false}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "_learner_class": null, "callbacks_on_algorithm_init": null, "callbacks_on_env_runners_recreated": null, "callbacks_on_offline_eval_runners_recreated": null, "callbacks_on_checkpoint_loaded": null, "callbacks_on_environment_created": null, "callbacks_on_episode_created": null, "callbacks_on_episode_start": null, "callbacks_on_episode_step": null, "callbacks_on_episode_end": null, "callbacks_on_evaluate_start": null, "callbacks_on_evaluate_end": null, "callbacks_on_evaluate_offline_start": null, "callbacks_on_evaluate_offline_end": null, "callbacks_on_sample_end": null, "callbacks_on_train_result": null, "explore": true, "enable_rl_module_and_learner": true, "enable_env_runner_and_connector_v2": true, "_prior_exploration_config": {"type": "StochasticSampling"}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7e3fa4feaac0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "offline_data_class": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_read_batch_size": null, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "materialize_data": false, "materialize_mapped_data": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "ignore_final_observation": false, "prelearner_class": null, "prelearner_buffer_class": null, "prelearner_buffer_kwargs": {}, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_remaining_data": false, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": 1, "evaluation_duration": 20, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_auto_duration_min_env_steps_per_sample": 100, "evaluation_auto_duration_max_env_steps_per_sample": 2000, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 1, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "offline_evaluation_interval": null, "num_offline_eval_runners": 0, "offline_loss_for_module_fn": null, "offline_evaluation_duration": 1, "offline_evaluation_parallel_to_training": false, "offline_evaluation_timeout_s": 120.0, "num_cpus_per_offline_eval_runner": 1, "num_gpus_per_offline_eval_runner": 0, "custom_resources_per_offline_eval_runner": {}, "restart_failed_offline_eval_runners": true, "ignore_offline_eval_runner_failures": false, "max_num_offline_eval_runner_restarts": 1000, "offline_eval_runner_restore_timeout_s": 1800.0, "max_requests_in_flight_per_offline_eval_runner": 1, "validate_offline_eval_runners_after_construction": true, "offline_eval_runner_health_probe_timeout_s": 30.0, "offline_eval_rl_module_inference_only": false, "broadcast_offline_eval_runner_states": false, "offline_eval_batch_size_per_runner": 256, "dataset_num_iters_per_eval_runner": 1, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "log_gradients": true, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 42, "restart_failed_env_runners": true, "ignore_env_runner_failures": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30.0, "env_runner_restore_timeout_s": 1800.0, "_model_config": {}, "_rl_module_spec": "RLModuleSpec(module_class=None, observation_space=None, action_space=None, inference_only=False, learner_only=False, model_config=DefaultModelConfig(fcnet_hiddens=[102, 121], fcnet_activation='tanh', fcnet_kernel_initializer=None, fcnet_kernel_initializer_kwargs=None, fcnet_bias_initializer=None, fcnet_bias_initializer_kwargs=None, conv_filters=None, conv_activation='relu', conv_kernel_initializer=None, conv_kernel_initializer_kwargs=None, conv_bias_initializer=None, conv_bias_initializer_kwargs=None, head_fcnet_hiddens=[], head_fcnet_activation='relu', head_fcnet_kernel_initializer=None, head_fcnet_kernel_initializer_kwargs=None, head_fcnet_bias_initializer=None, head_fcnet_bias_initializer_kwargs=None, free_log_std=False, log_std_clip_param=20.0, vf_share_layers=True, use_lstm=False, max_seq_len=20, lstm_cell_size=256, lstm_use_prev_action=False, lstm_use_prev_reward=False, lstm_kernel_initializer=None, lstm_kernel_initializer_kwargs=None, lstm_bias_initializer=None, lstm_bias_initializer_kwargs=None), catalog_class=None, load_state_path=None, model_config_dict=None)", "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "_validate_config": true, "_use_msgpack_checkpoints": false, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "env_task_fn": -1, "enable_connectors": -1, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.3585126254792, "kl_target": 0.0279643282718, "vf_loss_coeff": 0.5790097361641, "entropy_coeff": 0.0432335706043, "clip_param": 0.1935989459602, "vf_clip_param": 0.1014075551514, "entropy_coeff_schedule": null, "lr_schedule": null, "sgd_minibatch_size": -1, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9084803827711, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.callbacks.callbacks.RLlibCallback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 9.875016212463379, "iterations_since_restore": 2, "perf": {"cpu_util_percent": 11.757142857142856, "ram_util_percent": 69.89999999999999}}
{"timers": {"training_iteration": 4.255853318098115, "restore_env_runners": 1.636300027712423e-05, "training_step": 4.255621377808374, "env_runner_sampling_timer": 3.8060954890393415, "learner_update_timer": 0.4460243625593585, "synch_weights": 0.0015026621897838593, "restore_eval_env_runners": 1.4474999452431803e-05, "evaluation_iteration": 0.7589488489797622, "synch_eval_env_connectors": 0.0004459399994084379, "synch_env_connectors": 2.1658000468960382e-05}, "env_runners": {"env_to_module_connector": {"timers": {"connectors": {"add_observations_from_episodes_to_batch": 6.512430272450424e-06, "add_time_dim_to_batch_and_zero_pad": 6.427572665038468e-06, "add_states_from_episodes_to_batch": 3.4570057233272857e-06, "batch_individual_items": 1.8283241986303406e-05, "numpy_to_tensor": 3.111645984396296e-05}}, "connector_pipeline_timer": 0.00011862119416435285}, "num_episodes": 100.0, "num_agent_steps_sampled_lifetime": {"default_agent": -232500.0}, "weights_seq_no": 2.0, "episode_return_max": 14.5, "module_to_env_connector": {"timers": {"connectors": {"normalize_and_clip_actions": 2.2200868255381635e-05, "listify_data_for_vector_env": 3.059985296504076e-05, "get_actions": 0.00016316297011224768, "un_batch_to_individual_items": 1.5225256983006873e-05, "tensor_to_numpy": 4.822610988179524e-05, "remove_single_ts_time_rank_from_batch": 1.5095523284754078e-06}}, "connector_pipeline_timer": 0.0003578708165642354}, "time_between_sampling": 0.010731967526441961, "num_episodes_lifetime": -4650.0, "episode_len_max": 50, "sample": 0.037875947838461446, "num_agent_steps_sampled": {"default_agent": 5000.0}, "env_reset_timer": 0.00010682459903483529, "agent_episode_returns_mean": {"default_agent": 5.899999999999999}, "rlmodule_inference_timer": 0.00013615158497955304, "episode_return_min": -5.5, "num_env_steps_sampled_lifetime": -232500.0, "episode_len_min": 50, "episode_duration_sec_mean": 0.03777109697992273, "episode_len_mean": 50.0, "num_module_steps_sampled": {"default_policy": 5000.0}, "episode_return_mean": 5.899999999999999, "num_module_steps_sampled_lifetime": {"default_policy": -232500.0}, "env_to_module_sum_episodes_length_in": 27.16809333212661, "module_episode_returns_mean": {"default_policy": 5.899999999999999}, "num_env_steps_sampled": 5000.0, "env_to_module_sum_episodes_length_out": 27.16809333212661, "env_step_timer": 4.254910280901556e-05, "num_env_steps_sampled_lifetime_throughput": 1280.10114974714}, "learners": {"__all_modules__": {"num_non_trainable_parameters": 0, "num_module_steps_trained": 11000, "learner_connector": {"timers": {"connectors": {"add_time_dim_to_batch_and_zero_pad": 2.6149210314088122e-05, "batch_individual_items": 0.20053250965929637, "general_advantage_estimation": 0.012757211969904073, "add_states_from_episodes_to_batch": 6.095989169625682e-06, "numpy_to_tensor": 0.00015909766059494357, "add_one_ts_to_episodes_and_truncate": 0.008228896929885831, "add_columns_from_episodes_to_train_batch": 0.06671808342960284, "add_observations_from_episodes_to_batch": 0.0007478082804161203}}, "connector_pipeline_timer": 0.28945310132017465}, "num_module_steps_trained_lifetime": 33000, "learner_connector_sum_episodes_length_in": 5000.0, "num_env_steps_trained": 56100, "num_trainable_parameters": 13237, "learner_connector_sum_episodes_length_out": 5100.0, "num_env_steps_trained_lifetime": 168300, "num_env_steps_trained_lifetime_throughput": 817609.5049042949, "num_module_steps_trained_throughput": 160773.41908553135, "num_module_steps_trained_lifetime_throughput": 160669.7488256727}, "default_policy": {"curr_entropy_coeff": 0.0432335706043, "weights_seq_no": 3.0, "curr_kl_coeff": 0.044814079999923706, "entropy": 0.6872365474700928, "total_loss": -0.02411467395722866, "num_module_steps_trained_lifetime": 33000, "gradients_default_optimizer_global_norm": 0.08376149088144302, "num_module_steps_trained": 11000, "vf_explained_var": 0.020316660404205322, "vf_loss": 0.09554069489240646, "policy_loss": -0.049723029136657715, "default_optimizer_learning_rate": 3.68800684e-05, "module_train_batch_size_mean": 1000.0, "vf_loss_unclipped": 12.560688018798828, "mean_kl_loss": 1.1650717169686686e-05, "num_trainable_parameters": 13237, "diff_num_grad_updates_vs_sampler_policy": 1.0, "num_module_steps_trained_lifetime_throughput": 161110.7021178329}}, "num_training_step_calls_per_iteration": 1, "evaluation": {"env_runners": {"env_to_module_connector": {"timers": {"connectors": {"add_states_from_episodes_to_batch": 3.4555749163076073e-06, "numpy_to_tensor": 3.09563463162189e-05, "add_observations_from_episodes_to_batch": 6.310365443354442e-06, "add_time_dim_to_batch_and_zero_pad": 5.601596542965903e-06, "batch_individual_items": 1.8994407163852145e-05}}, "connector_pipeline_timer": 0.00011947713633763043}, "episode_len_max": 50, "module_to_env_connector": {"timers": {"connectors": {"remove_single_ts_time_rank_from_batch": 1.3764792641808924e-06, "get_actions": 0.00015901566460133906, "un_batch_to_individual_items": 1.5046107681349326e-05, "tensor_to_numpy": 4.740480421482736e-05, "normalize_and_clip_actions": 2.2231415331458856e-05, "listify_data_for_vector_env": 3.194995116942392e-05}}, "connector_pipeline_timer": 0.0003534728972094515}, "episode_return_min": -16.5, "num_env_steps_sampled_lifetime": 16000, "env_to_module_sum_episodes_length_out": 27.168093332125434, "num_episodes_lifetime": 60, "num_agent_steps_sampled_lifetime": {"default_agent": 3000}, "env_reset_timer": 0.00023930216990711411, "rlmodule_inference_timer": 0.00010047988611014118, "episode_duration_sec_mean": 0.035925563316641276, "episode_len_mean": 50.0, "episode_return_mean": -1.9, "num_env_steps_sampled": 1000, "num_module_steps_sampled": {"default_policy": 1000}, "episode_return_max": 17.5, "module_episode_returns_mean": {"default_policy": -1.9}, "sample": 0.7470760409604327, "episode_len_min": 50, "env_to_module_sum_episodes_length_in": 27.168093332125434, "num_episodes": 20, "num_module_steps_sampled_lifetime": {"default_policy": 3000}, "num_agent_steps_sampled": {"default_agent": 1000}, "agent_episode_returns_mean": {"default_agent": -1.9}, "env_step_timer": 4.203498247368066e-05, "weights_seq_no": 3.0, "time_between_sampling": 4.153051447970428}, "num_healthy_workers": 1, "actor_manager_num_outstanding_async_reqs": 0, "num_remote_worker_restarts": 0}, "num_env_steps_sampled_lifetime": -232500.0, "fault_tolerance": {"num_healthy_workers": 0, "num_remote_worker_restarts": 0}, "env_runner_group": {"actor_manager_num_outstanding_async_reqs": 0}, "done": false, "training_iteration": 3, "trial_id": "af132_00000", "date": "2025-08-11_17-17-43", "timestamp": 1754925463, "time_this_iter_s": 4.996975660324097, "time_total_s": 14.871991872787476, "pid": 69010, "hostname": "DESKTOP-3SK5A41", "node_ip": "192.168.40.242", "config": {"exploration_config": {}, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 6, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "env": "Umbrella", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": false, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 0, "create_local_env_runner": true, "num_envs_per_env_runner": 1, "gym_env_vectorize_mode": "SYNC", "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "episodes_to_numpy": true, "max_requests_in_flight_per_env_runner": 1, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "merge_env_runner_states": "training_only", "broadcast_env_runner_states": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "complete_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "sampler_perf_stats_ema_coef": null, "_is_online": true, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": "auto", "num_aggregator_actors_per_learner": 0, "max_requests_in_flight_per_aggregator_actor": 3, "local_gpu_idx": 0, "max_requests_in_flight_per_learner": 3, "gamma": 1, "lr": 3.68800684e-05, "grad_clip": 0.5, "grad_clip_by": "global_norm", "_train_batch_size_per_learner": 5000, "train_batch_size": 4000, "num_epochs": 2, "minibatch_size": 1000, "shuffle_batch_per_epoch": true, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "log_std_clip_param": 20.0, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "_disable_preprocessor_api": false, "_disable_action_flattening": false}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "_learner_class": null, "callbacks_on_algorithm_init": null, "callbacks_on_env_runners_recreated": null, "callbacks_on_offline_eval_runners_recreated": null, "callbacks_on_checkpoint_loaded": null, "callbacks_on_environment_created": null, "callbacks_on_episode_created": null, "callbacks_on_episode_start": null, "callbacks_on_episode_step": null, "callbacks_on_episode_end": null, "callbacks_on_evaluate_start": null, "callbacks_on_evaluate_end": null, "callbacks_on_evaluate_offline_start": null, "callbacks_on_evaluate_offline_end": null, "callbacks_on_sample_end": null, "callbacks_on_train_result": null, "explore": true, "enable_rl_module_and_learner": true, "enable_env_runner_and_connector_v2": true, "_prior_exploration_config": {"type": "StochasticSampling"}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7e3fa4feaac0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "offline_data_class": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_read_batch_size": null, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "materialize_data": false, "materialize_mapped_data": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "ignore_final_observation": false, "prelearner_class": null, "prelearner_buffer_class": null, "prelearner_buffer_kwargs": {}, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_remaining_data": false, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": 1, "evaluation_duration": 20, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_auto_duration_min_env_steps_per_sample": 100, "evaluation_auto_duration_max_env_steps_per_sample": 2000, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 1, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "offline_evaluation_interval": null, "num_offline_eval_runners": 0, "offline_loss_for_module_fn": null, "offline_evaluation_duration": 1, "offline_evaluation_parallel_to_training": false, "offline_evaluation_timeout_s": 120.0, "num_cpus_per_offline_eval_runner": 1, "num_gpus_per_offline_eval_runner": 0, "custom_resources_per_offline_eval_runner": {}, "restart_failed_offline_eval_runners": true, "ignore_offline_eval_runner_failures": false, "max_num_offline_eval_runner_restarts": 1000, "offline_eval_runner_restore_timeout_s": 1800.0, "max_requests_in_flight_per_offline_eval_runner": 1, "validate_offline_eval_runners_after_construction": true, "offline_eval_runner_health_probe_timeout_s": 30.0, "offline_eval_rl_module_inference_only": false, "broadcast_offline_eval_runner_states": false, "offline_eval_batch_size_per_runner": 256, "dataset_num_iters_per_eval_runner": 1, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "log_gradients": true, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 42, "restart_failed_env_runners": true, "ignore_env_runner_failures": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30.0, "env_runner_restore_timeout_s": 1800.0, "_model_config": {}, "_rl_module_spec": "RLModuleSpec(module_class=None, observation_space=None, action_space=None, inference_only=False, learner_only=False, model_config=DefaultModelConfig(fcnet_hiddens=[102, 121], fcnet_activation='tanh', fcnet_kernel_initializer=None, fcnet_kernel_initializer_kwargs=None, fcnet_bias_initializer=None, fcnet_bias_initializer_kwargs=None, conv_filters=None, conv_activation='relu', conv_kernel_initializer=None, conv_kernel_initializer_kwargs=None, conv_bias_initializer=None, conv_bias_initializer_kwargs=None, head_fcnet_hiddens=[], head_fcnet_activation='relu', head_fcnet_kernel_initializer=None, head_fcnet_kernel_initializer_kwargs=None, head_fcnet_bias_initializer=None, head_fcnet_bias_initializer_kwargs=None, free_log_std=False, log_std_clip_param=20.0, vf_share_layers=True, use_lstm=False, max_seq_len=20, lstm_cell_size=256, lstm_use_prev_action=False, lstm_use_prev_reward=False, lstm_kernel_initializer=None, lstm_kernel_initializer_kwargs=None, lstm_bias_initializer=None, lstm_bias_initializer_kwargs=None), catalog_class=None, load_state_path=None, model_config_dict=None)", "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "_validate_config": true, "_use_msgpack_checkpoints": false, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "env_task_fn": -1, "enable_connectors": -1, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.3585126254792, "kl_target": 0.0279643282718, "vf_loss_coeff": 0.5790097361641, "entropy_coeff": 0.0432335706043, "clip_param": 0.1935989459602, "vf_clip_param": 0.1014075551514, "entropy_coeff_schedule": null, "lr_schedule": null, "sgd_minibatch_size": -1, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9084803827711, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.callbacks.callbacks.RLlibCallback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 14.871991872787476, "iterations_since_restore": 3, "perf": {"cpu_util_percent": 11.900000000000002, "ram_util_percent": 69.89999999999999}}
{"timers": {"training_iteration": 4.2560040148671305, "restore_env_runners": 1.633437027458058e-05, "training_step": 4.255770269980289, "env_runner_sampling_timer": 3.8068791231089487, "learner_update_timer": 0.4453867389237613, "synch_weights": 0.0015017425678832594, "restore_eval_env_runners": 1.4458249459403305e-05, "evaluation_iteration": 0.7589584394799616, "synch_eval_env_connectors": 0.00044550759940975695, "synch_env_connectors": 2.1524420459627438e-05}, "env_runners": {"env_to_module_connector": {"timers": {"connectors": {"add_observations_from_episodes_to_batch": 6.441558828312699e-06, "add_time_dim_to_batch_and_zero_pad": 6.401580888452668e-06, "add_states_from_episodes_to_batch": 3.5128812943694474e-06, "batch_individual_items": 1.8174575805921724e-05, "numpy_to_tensor": 3.093310672606392e-05}}, "connector_pipeline_timer": 0.00011807768880977047}, "num_episodes": 100.0, "num_agent_steps_sampled_lifetime": {"default_agent": -475000.0}, "weights_seq_no": 3.0, "episode_return_max": 14.5, "module_to_env_connector": {"timers": {"connectors": {"normalize_and_clip_actions": 2.2417576986744884e-05, "listify_data_for_vector_env": 3.0555263097487896e-05, "get_actions": 0.00016252731790476586, "un_batch_to_individual_items": 1.5220475062323704e-05, "tensor_to_numpy": 4.86764076115546e-05, "remove_single_ts_time_rank_from_batch": 1.4981673184076248e-06}}, "connector_pipeline_timer": 0.00035815660006350994}, "time_between_sampling": 0.011249630421310386, "num_episodes_lifetime": -9500.0, "episode_len_max": 50, "sample": 0.03807786937832734, "num_agent_steps_sampled": {"default_agent": 5000.0}, "env_reset_timer": 9.575599209747754e-05, "agent_episode_returns_mean": {"default_agent": 4.7}, "rlmodule_inference_timer": 0.00010129780147581931, "episode_return_min": -5.5, "num_env_steps_sampled_lifetime": -475000.0, "episode_len_min": 50, "episode_duration_sec_mean": 0.03634660497000369, "episode_len_mean": 50.0, "num_module_steps_sampled": {"default_policy": 5000.0}, "episode_return_mean": 4.7, "num_module_steps_sampled_lifetime": {"default_policy": -475000.0}, "env_to_module_sum_episodes_length_in": 27.16809333212661, "module_episode_returns_mean": {"default_policy": 4.7}, "num_env_steps_sampled": 5000.0, "env_to_module_sum_episodes_length_out": 27.16809333212661, "env_step_timer": 4.2790186151503326e-05, "num_env_steps_sampled_lifetime_throughput": 1285.6177006948935}, "learners": {"__all_modules__": {"num_non_trainable_parameters": 0, "num_module_steps_trained": 11000, "learner_connector": {"timers": {"connectors": {"add_time_dim_to_batch_and_zero_pad": 2.6112718214358212e-05, "batch_individual_items": 0.20068505655269692, "general_advantage_estimation": 0.012755756850204827, "add_states_from_episodes_to_batch": 6.101029280263901e-06, "numpy_to_tensor": 0.0001593266839866728, "add_one_ts_to_episodes_and_truncate": 0.008228215960587388, "add_columns_from_episodes_to_train_batch": 0.06670999259530601, "add_observations_from_episodes_to_batch": 0.0007473311976155427}}, "connector_pipeline_timer": 0.2895959512969722}, "num_module_steps_trained_lifetime": 44000, "learner_connector_sum_episodes_length_in": 5000.0, "num_env_steps_trained": 56100, "num_trainable_parameters": 13237, "learner_connector_sum_episodes_length_out": 5100.0, "num_env_steps_trained_lifetime": 224400, "num_env_steps_trained_lifetime_throughput": 817876.1904662021, "num_module_steps_trained_throughput": 160808.01202558662, "num_module_steps_trained_lifetime_throughput": 160707.71871251147}, "default_policy": {"curr_entropy_coeff": 0.0432335706043, "weights_seq_no": 4.0, "curr_kl_coeff": 0.022407039999961853, "entropy": 0.6883233785629272, "total_loss": 0.01216370239853859, "num_module_steps_trained_lifetime": 44000, "gradients_default_optimizer_global_norm": 0.07063798606395721, "num_module_steps_trained": 11000, "vf_explained_var": 0.02269887924194336, "vf_loss": 0.09575262665748596, "policy_loss": -0.013521828688681126, "default_optimizer_learning_rate": 3.68800684e-05, "module_train_batch_size_mean": 1000.0, "vf_loss_unclipped": 13.305548667907715, "mean_kl_loss": 5.556616451940499e-05, "num_trainable_parameters": 13237, "diff_num_grad_updates_vs_sampler_policy": 1.0, "num_module_steps_trained_lifetime_throughput": 161126.95342800848}}, "num_training_step_calls_per_iteration": 1, "evaluation": {"env_runners": {"env_to_module_connector": {"timers": {"connectors": {"add_states_from_episodes_to_batch": 3.2406526398552606e-06, "numpy_to_tensor": 3.0464943987898204e-05, "add_observations_from_episodes_to_batch": 6.16129648737788e-06, "add_time_dim_to_batch_and_zero_pad": 5.51075738036997e-06, "batch_individual_items": 1.7741790513161145e-05}}, "connector_pipeline_timer": 0.00011569439541463592}, "episode_len_max": 50, "module_to_env_connector": {"timers": {"connectors": {"remove_single_ts_time_rank_from_batch": 1.366629847703022e-06, "get_actions": 0.0001568654437935187, "un_batch_to_individual_items": 1.491048406705904e-05, "tensor_to_numpy": 4.61391046197386e-05, "normalize_and_clip_actions": 2.186049924559446e-05, "listify_data_for_vector_env": 3.143598629069726e-05}}, "connector_pipeline_timer": 0.00034797448982634005}, "episode_return_min": -16.5, "num_env_steps_sampled_lifetime": 21000, "env_to_module_sum_episodes_length_out": 27.168093332126602, "num_episodes_lifetime": 80, "num_agent_steps_sampled_lifetime": {"default_agent": 4000}, "env_reset_timer": 0.00023890414820130077, "rlmodule_inference_timer": 9.87958784119021e-05, "episode_duration_sec_mean": 0.03599038747497616, "episode_len_mean": 50.0, "episode_return_mean": -2.4, "num_env_steps_sampled": 1000, "num_module_steps_sampled": {"default_policy": 1000}, "episode_return_max": 17.5, "module_episode_returns_mean": {"default_policy": -2.4}, "sample": 0.747125525540829, "episode_len_min": 50, "env_to_module_sum_episodes_length_in": 27.168093332126602, "num_episodes": 20, "num_module_steps_sampled_lifetime": {"default_policy": 4000}, "num_agent_steps_sampled": {"default_agent": 1000}, "agent_episode_returns_mean": {"default_agent": -2.4}, "env_step_timer": 4.237195131543544e-05, "weights_seq_no": 4.0, "time_between_sampling": 4.154788320440725}, "num_healthy_workers": 1, "actor_manager_num_outstanding_async_reqs": 0, "num_remote_worker_restarts": 0}, "num_env_steps_sampled_lifetime": -475000.0, "fault_tolerance": {"num_healthy_workers": 0, "num_remote_worker_restarts": 0}, "env_runner_group": {"actor_manager_num_outstanding_async_reqs": 0}, "done": false, "training_iteration": 4, "trial_id": "af132_00000", "date": "2025-08-11_17-17-48", "timestamp": 1754925468, "time_this_iter_s": 5.038724184036255, "time_total_s": 19.91071605682373, "pid": 69010, "hostname": "DESKTOP-3SK5A41", "node_ip": "192.168.40.242", "config": {"exploration_config": {}, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 6, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "env": "Umbrella", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": false, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 0, "create_local_env_runner": true, "num_envs_per_env_runner": 1, "gym_env_vectorize_mode": "SYNC", "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "episodes_to_numpy": true, "max_requests_in_flight_per_env_runner": 1, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "merge_env_runner_states": "training_only", "broadcast_env_runner_states": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "complete_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "sampler_perf_stats_ema_coef": null, "_is_online": true, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": "auto", "num_aggregator_actors_per_learner": 0, "max_requests_in_flight_per_aggregator_actor": 3, "local_gpu_idx": 0, "max_requests_in_flight_per_learner": 3, "gamma": 1, "lr": 3.68800684e-05, "grad_clip": 0.5, "grad_clip_by": "global_norm", "_train_batch_size_per_learner": 5000, "train_batch_size": 4000, "num_epochs": 2, "minibatch_size": 1000, "shuffle_batch_per_epoch": true, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "log_std_clip_param": 20.0, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "_disable_preprocessor_api": false, "_disable_action_flattening": false}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "_learner_class": null, "callbacks_on_algorithm_init": null, "callbacks_on_env_runners_recreated": null, "callbacks_on_offline_eval_runners_recreated": null, "callbacks_on_checkpoint_loaded": null, "callbacks_on_environment_created": null, "callbacks_on_episode_created": null, "callbacks_on_episode_start": null, "callbacks_on_episode_step": null, "callbacks_on_episode_end": null, "callbacks_on_evaluate_start": null, "callbacks_on_evaluate_end": null, "callbacks_on_evaluate_offline_start": null, "callbacks_on_evaluate_offline_end": null, "callbacks_on_sample_end": null, "callbacks_on_train_result": null, "explore": true, "enable_rl_module_and_learner": true, "enable_env_runner_and_connector_v2": true, "_prior_exploration_config": {"type": "StochasticSampling"}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7e3fa4feaac0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "offline_data_class": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_read_batch_size": null, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "materialize_data": false, "materialize_mapped_data": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "ignore_final_observation": false, "prelearner_class": null, "prelearner_buffer_class": null, "prelearner_buffer_kwargs": {}, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_remaining_data": false, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": 1, "evaluation_duration": 20, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_auto_duration_min_env_steps_per_sample": 100, "evaluation_auto_duration_max_env_steps_per_sample": 2000, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 1, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "offline_evaluation_interval": null, "num_offline_eval_runners": 0, "offline_loss_for_module_fn": null, "offline_evaluation_duration": 1, "offline_evaluation_parallel_to_training": false, "offline_evaluation_timeout_s": 120.0, "num_cpus_per_offline_eval_runner": 1, "num_gpus_per_offline_eval_runner": 0, "custom_resources_per_offline_eval_runner": {}, "restart_failed_offline_eval_runners": true, "ignore_offline_eval_runner_failures": false, "max_num_offline_eval_runner_restarts": 1000, "offline_eval_runner_restore_timeout_s": 1800.0, "max_requests_in_flight_per_offline_eval_runner": 1, "validate_offline_eval_runners_after_construction": true, "offline_eval_runner_health_probe_timeout_s": 30.0, "offline_eval_rl_module_inference_only": false, "broadcast_offline_eval_runner_states": false, "offline_eval_batch_size_per_runner": 256, "dataset_num_iters_per_eval_runner": 1, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "log_gradients": true, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 42, "restart_failed_env_runners": true, "ignore_env_runner_failures": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30.0, "env_runner_restore_timeout_s": 1800.0, "_model_config": {}, "_rl_module_spec": "RLModuleSpec(module_class=None, observation_space=None, action_space=None, inference_only=False, learner_only=False, model_config=DefaultModelConfig(fcnet_hiddens=[102, 121], fcnet_activation='tanh', fcnet_kernel_initializer=None, fcnet_kernel_initializer_kwargs=None, fcnet_bias_initializer=None, fcnet_bias_initializer_kwargs=None, conv_filters=None, conv_activation='relu', conv_kernel_initializer=None, conv_kernel_initializer_kwargs=None, conv_bias_initializer=None, conv_bias_initializer_kwargs=None, head_fcnet_hiddens=[], head_fcnet_activation='relu', head_fcnet_kernel_initializer=None, head_fcnet_kernel_initializer_kwargs=None, head_fcnet_bias_initializer=None, head_fcnet_bias_initializer_kwargs=None, free_log_std=False, log_std_clip_param=20.0, vf_share_layers=True, use_lstm=False, max_seq_len=20, lstm_cell_size=256, lstm_use_prev_action=False, lstm_use_prev_reward=False, lstm_kernel_initializer=None, lstm_kernel_initializer_kwargs=None, lstm_bias_initializer=None, lstm_bias_initializer_kwargs=None), catalog_class=None, load_state_path=None, model_config_dict=None)", "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "_validate_config": true, "_use_msgpack_checkpoints": false, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "env_task_fn": -1, "enable_connectors": -1, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.3585126254792, "kl_target": 0.0279643282718, "vf_loss_coeff": 0.5790097361641, "entropy_coeff": 0.0432335706043, "clip_param": 0.1935989459602, "vf_clip_param": 0.1014075551514, "entropy_coeff_schedule": null, "lr_schedule": null, "sgd_minibatch_size": -1, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9084803827711, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.callbacks.callbacks.RLlibCallback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 19.91071605682373, "iterations_since_restore": 4, "perf": {"cpu_util_percent": 12.4, "ram_util_percent": 69.92857142857143}}
{"timers": {"training_iteration": 4.254903405638463, "restore_env_runners": 1.6281026572693917e-05, "training_step": 4.254668886200486, "env_runner_sampling_timer": 3.8081261788078624, "learner_update_timer": 0.44303679752452807, "synch_weights": 0.0015017471422021976, "restore_eval_env_runners": 1.4593666968649813e-05, "evaluation_iteration": 0.7589975450751588, "synch_eval_env_connectors": 0.0004465925234175884, "synch_env_connectors": 2.1380176249963373e-05}, "env_runners": {"env_to_module_connector": {"timers": {"connectors": {"add_observations_from_episodes_to_batch": 6.527580926870892e-06, "add_time_dim_to_batch_and_zero_pad": 6.476926216666366e-06, "add_states_from_episodes_to_batch": 3.5326804562978074e-06, "batch_individual_items": 1.837604516997462e-05, "numpy_to_tensor": 3.12994357661595e-05}}, "connector_pipeline_timer": 0.00011952393411602965}, "num_episodes": 100.0, "num_agent_steps_sampled_lifetime": {"default_agent": -717500.0}, "weights_seq_no": 4.0, "episode_return_max": 14.5, "module_to_env_connector": {"timers": {"connectors": {"normalize_and_clip_actions": 2.2398752193102453e-05, "listify_data_for_vector_env": 3.088499292260732e-05, "get_actions": 0.0001643248899448774, "un_batch_to_individual_items": 1.5350438766422067e-05, "tensor_to_numpy": 4.884693650917156e-05, "remove_single_ts_time_rank_from_batch": 1.5285630645763188e-06}}, "connector_pipeline_timer": 0.00036133801839945807}, "time_between_sampling": 0.012624048189614668, "num_episodes_lifetime": -14350.0, "episode_len_max": 50, "sample": 0.03778236135331504, "num_agent_steps_sampled": {"default_agent": 5000.0}, "env_reset_timer": 9.313375420891402e-05, "agent_episode_returns_mean": {"default_agent": 6.9}, "rlmodule_inference_timer": 0.00010198534411063253, "episode_return_min": -5.5, "num_env_steps_sampled_lifetime": -717500.0, "episode_len_min": 50, "episode_duration_sec_mean": 0.03674668596001539, "episode_len_mean": 50.0, "num_module_steps_sampled": {"default_policy": 5000.0}, "episode_return_mean": 6.9, "num_module_steps_sampled_lifetime": {"default_policy": -717500.0}, "env_to_module_sum_episodes_length_in": 27.16809333212661, "module_episode_returns_mean": {"default_policy": 6.9}, "num_env_steps_sampled": 5000.0, "env_to_module_sum_episodes_length_out": 27.16809333212661, "env_step_timer": 4.295494620118759e-05, "num_env_steps_sampled_lifetime_throughput": 1276.8446848675637}, "learners": {"__all_modules__": {"num_non_trainable_parameters": 0, "num_module_steps_trained": 11000, "learner_connector": {"timers": {"connectors": {"add_time_dim_to_batch_and_zero_pad": 2.6123591029708905e-05, "batch_individual_items": 0.1992842979771728, "general_advantage_estimation": 0.012734136281710322, "add_states_from_episodes_to_batch": 6.098018983449474e-06, "numpy_to_tensor": 0.00015954741714427253, "add_one_ts_to_episodes_and_truncate": 0.008228551800978243, "add_columns_from_episodes_to_train_batch": 0.06672003666935408, "add_observations_from_episodes_to_batch": 0.0007470068856421425}}, "connector_pipeline_timer": 0.28818482677399915}, "num_module_steps_trained_lifetime": 55000, "learner_connector_sum_episodes_length_in": 5000.0, "num_env_steps_trained": 56100, "num_trainable_parameters": 13237, "learner_connector_sum_episodes_length_out": 5100.0, "num_env_steps_trained_lifetime": 280500, "num_env_steps_trained_lifetime_throughput": 820308.6878782593, "num_module_steps_trained_throughput": 161265.38755248807, "num_module_steps_trained_lifetime_throughput": 161168.3157886707}, "default_policy": {"curr_entropy_coeff": 0.0432335706043, "weights_seq_no": 5.0, "curr_kl_coeff": 0.011203519999980927, "entropy": 0.6877562999725342, "total_loss": 0.022425146773457527, "num_module_steps_trained_lifetime": 55000, "gradients_default_optimizer_global_norm": 0.09246409684419632, "num_module_steps_trained": 11000, "vf_explained_var": 0.021802663803100586, "vf_loss": 0.0961051732301712, "policy_loss": -0.003486752975732088, "default_optimizer_learning_rate": 3.68800684e-05, "module_train_batch_size_mean": 1000.0, "vf_loss_unclipped": 13.440192222595215, "mean_kl_loss": 9.888702152238693e-06, "num_trainable_parameters": 13237, "diff_num_grad_updates_vs_sampler_policy": 1.0, "num_module_steps_trained_lifetime_throughput": 161564.1553838951}}, "num_training_step_calls_per_iteration": 1, "evaluation": {"env_runners": {"env_to_module_connector": {"timers": {"connectors": {"add_states_from_episodes_to_batch": 3.3883600815682507e-06, "numpy_to_tensor": 2.992157310667733e-05, "add_observations_from_episodes_to_batch": 6.228548523361143e-06, "add_time_dim_to_batch_and_zero_pad": 5.35990446550223e-06, "batch_individual_items": 1.810385050937357e-05}}, "connector_pipeline_timer": 0.00011689900697445242}, "episode_len_max": 50, "module_to_env_connector": {"timers": {"connectors": {"remove_single_ts_time_rank_from_batch": 1.3636738377072283e-06, "get_actions": 0.00015842727468587828, "un_batch_to_individual_items": 1.4860900683213845e-05, "tensor_to_numpy": 4.705973548369395e-05, "normalize_and_clip_actions": 2.135591528092039e-05, "listify_data_for_vector_env": 3.1004801415438166e-05}}, "connector_pipeline_timer": 0.0003498989659625809}, "episode_return_min": -16.5, "num_env_steps_sampled_lifetime": 26000, "env_to_module_sum_episodes_length_out": 27.168093332126602, "num_episodes_lifetime": 100, "num_agent_steps_sampled_lifetime": {"default_agent": 5000}, "env_reset_timer": 0.000237821106723039, "rlmodule_inference_timer": 9.865610691268184e-05, "episode_duration_sec_mean": 0.035983594969975455, "episode_len_mean": 50.0, "episode_return_mean": -1.5, "num_env_steps_sampled": 1000, "num_module_steps_sampled": {"default_policy": 1000}, "episode_return_max": 17.5, "module_episode_returns_mean": {"default_policy": -1.5}, "sample": 0.747133578275418, "episode_len_min": 50, "env_to_module_sum_episodes_length_in": 27.168093332126602, "num_episodes": 20, "num_module_steps_sampled_lifetime": {"default_policy": 5000}, "num_agent_steps_sampled": {"default_agent": 1000}, "agent_episode_returns_mean": {"default_agent": -1.5}, "env_step_timer": 4.235165667842874e-05, "weights_seq_no": 5.0, "time_between_sampling": 4.1552398301463205}, "num_healthy_workers": 1, "actor_manager_num_outstanding_async_reqs": 0, "num_remote_worker_restarts": 0}, "num_env_steps_sampled_lifetime": -717500.0, "fault_tolerance": {"num_healthy_workers": 0, "num_remote_worker_restarts": 0}, "env_runner_group": {"actor_manager_num_outstanding_async_reqs": 0}, "done": false, "training_iteration": 5, "trial_id": "af132_00000", "date": "2025-08-11_17-17-53", "timestamp": 1754925473, "time_this_iter_s": 4.907534837722778, "time_total_s": 24.81825089454651, "pid": 69010, "hostname": "DESKTOP-3SK5A41", "node_ip": "192.168.40.242", "config": {"exploration_config": {}, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 6, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "env": "Umbrella", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": false, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 0, "create_local_env_runner": true, "num_envs_per_env_runner": 1, "gym_env_vectorize_mode": "SYNC", "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "episodes_to_numpy": true, "max_requests_in_flight_per_env_runner": 1, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "merge_env_runner_states": "training_only", "broadcast_env_runner_states": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "complete_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "sampler_perf_stats_ema_coef": null, "_is_online": true, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": "auto", "num_aggregator_actors_per_learner": 0, "max_requests_in_flight_per_aggregator_actor": 3, "local_gpu_idx": 0, "max_requests_in_flight_per_learner": 3, "gamma": 1, "lr": 3.68800684e-05, "grad_clip": 0.5, "grad_clip_by": "global_norm", "_train_batch_size_per_learner": 5000, "train_batch_size": 4000, "num_epochs": 2, "minibatch_size": 1000, "shuffle_batch_per_epoch": true, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "log_std_clip_param": 20.0, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "_disable_preprocessor_api": false, "_disable_action_flattening": false}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "_learner_class": null, "callbacks_on_algorithm_init": null, "callbacks_on_env_runners_recreated": null, "callbacks_on_offline_eval_runners_recreated": null, "callbacks_on_checkpoint_loaded": null, "callbacks_on_environment_created": null, "callbacks_on_episode_created": null, "callbacks_on_episode_start": null, "callbacks_on_episode_step": null, "callbacks_on_episode_end": null, "callbacks_on_evaluate_start": null, "callbacks_on_evaluate_end": null, "callbacks_on_evaluate_offline_start": null, "callbacks_on_evaluate_offline_end": null, "callbacks_on_sample_end": null, "callbacks_on_train_result": null, "explore": true, "enable_rl_module_and_learner": true, "enable_env_runner_and_connector_v2": true, "_prior_exploration_config": {"type": "StochasticSampling"}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7e3fa4feaac0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "offline_data_class": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_read_batch_size": null, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "materialize_data": false, "materialize_mapped_data": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "ignore_final_observation": false, "prelearner_class": null, "prelearner_buffer_class": null, "prelearner_buffer_kwargs": {}, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_remaining_data": false, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": 1, "evaluation_duration": 20, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_auto_duration_min_env_steps_per_sample": 100, "evaluation_auto_duration_max_env_steps_per_sample": 2000, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 1, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "offline_evaluation_interval": null, "num_offline_eval_runners": 0, "offline_loss_for_module_fn": null, "offline_evaluation_duration": 1, "offline_evaluation_parallel_to_training": false, "offline_evaluation_timeout_s": 120.0, "num_cpus_per_offline_eval_runner": 1, "num_gpus_per_offline_eval_runner": 0, "custom_resources_per_offline_eval_runner": {}, "restart_failed_offline_eval_runners": true, "ignore_offline_eval_runner_failures": false, "max_num_offline_eval_runner_restarts": 1000, "offline_eval_runner_restore_timeout_s": 1800.0, "max_requests_in_flight_per_offline_eval_runner": 1, "validate_offline_eval_runners_after_construction": true, "offline_eval_runner_health_probe_timeout_s": 30.0, "offline_eval_rl_module_inference_only": false, "broadcast_offline_eval_runner_states": false, "offline_eval_batch_size_per_runner": 256, "dataset_num_iters_per_eval_runner": 1, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "log_gradients": true, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 42, "restart_failed_env_runners": true, "ignore_env_runner_failures": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30.0, "env_runner_restore_timeout_s": 1800.0, "_model_config": {}, "_rl_module_spec": "RLModuleSpec(module_class=None, observation_space=None, action_space=None, inference_only=False, learner_only=False, model_config=DefaultModelConfig(fcnet_hiddens=[102, 121], fcnet_activation='tanh', fcnet_kernel_initializer=None, fcnet_kernel_initializer_kwargs=None, fcnet_bias_initializer=None, fcnet_bias_initializer_kwargs=None, conv_filters=None, conv_activation='relu', conv_kernel_initializer=None, conv_kernel_initializer_kwargs=None, conv_bias_initializer=None, conv_bias_initializer_kwargs=None, head_fcnet_hiddens=[], head_fcnet_activation='relu', head_fcnet_kernel_initializer=None, head_fcnet_kernel_initializer_kwargs=None, head_fcnet_bias_initializer=None, head_fcnet_bias_initializer_kwargs=None, free_log_std=False, log_std_clip_param=20.0, vf_share_layers=True, use_lstm=False, max_seq_len=20, lstm_cell_size=256, lstm_use_prev_action=False, lstm_use_prev_reward=False, lstm_kernel_initializer=None, lstm_kernel_initializer_kwargs=None, lstm_bias_initializer=None, lstm_bias_initializer_kwargs=None), catalog_class=None, load_state_path=None, model_config_dict=None)", "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "_validate_config": true, "_use_msgpack_checkpoints": false, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "env_task_fn": -1, "enable_connectors": -1, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.3585126254792, "kl_target": 0.0279643282718, "vf_loss_coeff": 0.5790097361641, "entropy_coeff": 0.0432335706043, "clip_param": 0.1935989459602, "vf_clip_param": 0.1014075551514, "entropy_coeff_schedule": null, "lr_schedule": null, "sgd_minibatch_size": -1, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9084803827711, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.callbacks.callbacks.RLlibCallback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 24.81825089454651, "iterations_since_restore": 5, "perf": {"cpu_util_percent": 12.000000000000002, "ram_util_percent": 69.89999999999999}}
{"timers": {"training_iteration": 4.254971112492076, "restore_env_runners": 1.656721630617442e-05, "training_step": 4.254734995248478, "env_runner_sampling_timer": 3.8091276149397864, "learner_update_timer": 0.4420993575392835, "synch_weights": 0.0015027386707810251, "restore_eval_env_runners": 1.4553730296649329e-05, "evaluation_iteration": 0.7589831346144092, "synch_eval_env_connectors": 0.0004463825981854001, "synch_env_connectors": 2.1235374485356857e-05}, "env_runners": {"env_to_module_connector": {"timers": {"connectors": {"add_observations_from_episodes_to_batch": 6.490048829068158e-06, "add_time_dim_to_batch_and_zero_pad": 6.540455682788793e-06, "add_states_from_episodes_to_batch": 3.558538651702463e-06, "batch_individual_items": 1.8375758562325515e-05, "numpy_to_tensor": 3.1159511901267995e-05}}, "connector_pipeline_timer": 0.000119000314769418}, "num_episodes": 100.0, "num_agent_steps_sampled_lifetime": {"default_agent": -960000.0}, "weights_seq_no": 5.0, "episode_return_max": 14.5, "module_to_env_connector": {"timers": {"connectors": {"normalize_and_clip_actions": 2.246168825239622e-05, "listify_data_for_vector_env": 3.0740738593366894e-05, "get_actions": 0.0001638745163684145, "un_batch_to_individual_items": 1.5265212854943764e-05, "tensor_to_numpy": 4.8656277108046765e-05, "remove_single_ts_time_rank_from_batch": 1.5229996893917768e-06}}, "connector_pipeline_timer": 0.0003602021287977136}, "time_between_sampling": 0.012001401718383597, "num_episodes_lifetime": -19200.0, "episode_len_max": 50, "sample": 0.03766383816665705, "num_agent_steps_sampled": {"default_agent": 5000.0}, "env_reset_timer": 9.184360574547175e-05, "agent_episode_returns_mean": {"default_agent": 7.299999999999996}, "rlmodule_inference_timer": 0.0001016945244501189, "episode_return_min": -5.5, "num_env_steps_sampled_lifetime": -960000.0, "episode_len_min": 50, "episode_duration_sec_mean": 0.036566583929961774, "episode_len_mean": 50.0, "num_module_steps_sampled": {"default_policy": 5000.0}, "episode_return_mean": 7.299999999999996, "num_module_steps_sampled_lifetime": {"default_policy": -960000.0}, "env_to_module_sum_episodes_length_in": 27.16809333212661, "module_episode_returns_mean": {"default_policy": 7.299999999999996}, "num_env_steps_sampled": 5000.0, "env_to_module_sum_episodes_length_out": 27.16809333212661, "env_step_timer": 4.278650194187749e-05, "num_env_steps_sampled_lifetime_throughput": 1281.9175785605057}, "learners": {"__all_modules__": {"num_non_trainable_parameters": 0, "num_module_steps_trained": 11000, "learner_connector": {"timers": {"connectors": {"add_time_dim_to_batch_and_zero_pad": 2.6070355120705658e-05, "batch_individual_items": 0.19933778298740243, "general_advantage_estimation": 0.012709283918894004, "add_states_from_episodes_to_batch": 6.089038798485912e-06, "numpy_to_tensor": 0.00015957494298021448, "add_one_ts_to_episodes_and_truncate": 0.008226460282961303, "add_columns_from_episodes_to_train_batch": 0.06672189830266685, "add_observations_from_episodes_to_batch": 0.0007461148167788903}}, "connector_pipeline_timer": 0.288212297496255}, "num_module_steps_trained_lifetime": 66000, "learner_connector_sum_episodes_length_in": 5000.0, "num_env_steps_trained": 56100, "num_trainable_parameters": 13237, "learner_connector_sum_episodes_length_out": 5100.0, "num_env_steps_trained_lifetime": 336600, "num_env_steps_trained_lifetime_throughput": 824291.0649462839, "num_module_steps_trained_throughput": 162026.58744377783, "num_module_steps_trained_lifetime_throughput": 161932.89740786818}, "default_policy": {"curr_entropy_coeff": 0.0432335706043, "weights_seq_no": 6.0, "curr_kl_coeff": 0.005601759999990463, "entropy": 0.6868122816085815, "total_loss": -0.01152176596224308, "num_module_steps_trained_lifetime": 66000, "gradients_default_optimizer_global_norm": 0.10476259887218475, "num_module_steps_trained": 11000, "vf_explained_var": 0.021352171897888184, "vf_loss": 0.09671752154827118, "policy_loss": -0.03782903030514717, "default_optimizer_learning_rate": 3.68800684e-05, "module_train_batch_size_mean": 1000.0, "vf_loss_unclipped": 14.41501235961914, "mean_kl_loss": 1.8841925339074805e-05, "num_trainable_parameters": 13237, "diff_num_grad_updates_vs_sampler_policy": 1.0, "num_module_steps_trained_lifetime_throughput": 162306.47324682458}}, "num_training_step_calls_per_iteration": 1, "evaluation": {"env_runners": {"env_to_module_connector": {"timers": {"connectors": {"add_states_from_episodes_to_batch": 3.4109522038282186e-06, "numpy_to_tensor": 3.040561016428363e-05, "add_observations_from_episodes_to_batch": 6.2111880928866075e-06, "add_time_dim_to_batch_and_zero_pad": 5.387107086942831e-06, "batch_individual_items": 1.8319990347442957e-05}}, "connector_pipeline_timer": 0.00011695137949091643}, "episode_len_max": 50, "module_to_env_connector": {"timers": {"connectors": {"remove_single_ts_time_rank_from_batch": 1.4625246699821574e-06, "get_actions": 0.00015700102308031425, "un_batch_to_individual_items": 1.526793414932987e-05, "tensor_to_numpy": 4.676845742889392e-05, "normalize_and_clip_actions": 2.1340575258066692e-05, "listify_data_for_vector_env": 3.0507978271574975e-05}}, "connector_pipeline_timer": 0.000349202413750703}, "episode_return_min": -16.5, "num_env_steps_sampled_lifetime": 31000, "env_to_module_sum_episodes_length_out": 27.168093332126602, "num_episodes_lifetime": 120, "num_agent_steps_sampled_lifetime": {"default_agent": 6000}, "env_reset_timer": 0.00023673789564856003, "rlmodule_inference_timer": 0.00010018311613261391, "episode_duration_sec_mean": 0.035978923939956074, "episode_len_mean": 50.0, "episode_return_mean": -0.7, "num_env_steps_sampled": 1000, "num_module_steps_sampled": {"default_policy": 1000}, "episode_return_max": 17.5, "module_episode_returns_mean": {"default_policy": -0.7}, "sample": 0.7471219444726606, "episode_len_min": 50, "env_to_module_sum_episodes_length_in": 27.168093332126602, "num_episodes": 20, "num_module_steps_sampled_lifetime": {"default_policy": 6000}, "num_agent_steps_sampled": {"default_agent": 1000}, "agent_episode_returns_mean": {"default_agent": -0.7}, "env_step_timer": 4.186845912357002e-05, "weights_seq_no": 6.0, "time_between_sampling": 4.1568296507548546}, "num_healthy_workers": 1, "actor_manager_num_outstanding_async_reqs": 0, "num_remote_worker_restarts": 0}, "num_env_steps_sampled_lifetime": -960000.0, "fault_tolerance": {"num_healthy_workers": 0, "num_remote_worker_restarts": 0}, "env_runner_group": {"actor_manager_num_outstanding_async_reqs": 0}, "done": false, "training_iteration": 6, "trial_id": "af132_00000", "date": "2025-08-11_17-17-58", "timestamp": 1754925478, "time_this_iter_s": 5.02144718170166, "time_total_s": 29.83969807624817, "pid": 69010, "hostname": "DESKTOP-3SK5A41", "node_ip": "192.168.40.242", "config": {"exploration_config": {}, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 6, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "env": "Umbrella", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": false, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 0, "create_local_env_runner": true, "num_envs_per_env_runner": 1, "gym_env_vectorize_mode": "SYNC", "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "episodes_to_numpy": true, "max_requests_in_flight_per_env_runner": 1, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "merge_env_runner_states": "training_only", "broadcast_env_runner_states": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "complete_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "sampler_perf_stats_ema_coef": null, "_is_online": true, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": "auto", "num_aggregator_actors_per_learner": 0, "max_requests_in_flight_per_aggregator_actor": 3, "local_gpu_idx": 0, "max_requests_in_flight_per_learner": 3, "gamma": 1, "lr": 3.68800684e-05, "grad_clip": 0.5, "grad_clip_by": "global_norm", "_train_batch_size_per_learner": 5000, "train_batch_size": 4000, "num_epochs": 2, "minibatch_size": 1000, "shuffle_batch_per_epoch": true, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "log_std_clip_param": 20.0, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "_disable_preprocessor_api": false, "_disable_action_flattening": false}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "_learner_class": null, "callbacks_on_algorithm_init": null, "callbacks_on_env_runners_recreated": null, "callbacks_on_offline_eval_runners_recreated": null, "callbacks_on_checkpoint_loaded": null, "callbacks_on_environment_created": null, "callbacks_on_episode_created": null, "callbacks_on_episode_start": null, "callbacks_on_episode_step": null, "callbacks_on_episode_end": null, "callbacks_on_evaluate_start": null, "callbacks_on_evaluate_end": null, "callbacks_on_evaluate_offline_start": null, "callbacks_on_evaluate_offline_end": null, "callbacks_on_sample_end": null, "callbacks_on_train_result": null, "explore": true, "enable_rl_module_and_learner": true, "enable_env_runner_and_connector_v2": true, "_prior_exploration_config": {"type": "StochasticSampling"}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7e3fa4feaac0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "offline_data_class": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_read_batch_size": null, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "materialize_data": false, "materialize_mapped_data": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "ignore_final_observation": false, "prelearner_class": null, "prelearner_buffer_class": null, "prelearner_buffer_kwargs": {}, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_remaining_data": false, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": 1, "evaluation_duration": 20, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_auto_duration_min_env_steps_per_sample": 100, "evaluation_auto_duration_max_env_steps_per_sample": 2000, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 1, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "offline_evaluation_interval": null, "num_offline_eval_runners": 0, "offline_loss_for_module_fn": null, "offline_evaluation_duration": 1, "offline_evaluation_parallel_to_training": false, "offline_evaluation_timeout_s": 120.0, "num_cpus_per_offline_eval_runner": 1, "num_gpus_per_offline_eval_runner": 0, "custom_resources_per_offline_eval_runner": {}, "restart_failed_offline_eval_runners": true, "ignore_offline_eval_runner_failures": false, "max_num_offline_eval_runner_restarts": 1000, "offline_eval_runner_restore_timeout_s": 1800.0, "max_requests_in_flight_per_offline_eval_runner": 1, "validate_offline_eval_runners_after_construction": true, "offline_eval_runner_health_probe_timeout_s": 30.0, "offline_eval_rl_module_inference_only": false, "broadcast_offline_eval_runner_states": false, "offline_eval_batch_size_per_runner": 256, "dataset_num_iters_per_eval_runner": 1, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "log_gradients": true, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 42, "restart_failed_env_runners": true, "ignore_env_runner_failures": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30.0, "env_runner_restore_timeout_s": 1800.0, "_model_config": {}, "_rl_module_spec": "RLModuleSpec(module_class=None, observation_space=None, action_space=None, inference_only=False, learner_only=False, model_config=DefaultModelConfig(fcnet_hiddens=[102, 121], fcnet_activation='tanh', fcnet_kernel_initializer=None, fcnet_kernel_initializer_kwargs=None, fcnet_bias_initializer=None, fcnet_bias_initializer_kwargs=None, conv_filters=None, conv_activation='relu', conv_kernel_initializer=None, conv_kernel_initializer_kwargs=None, conv_bias_initializer=None, conv_bias_initializer_kwargs=None, head_fcnet_hiddens=[], head_fcnet_activation='relu', head_fcnet_kernel_initializer=None, head_fcnet_kernel_initializer_kwargs=None, head_fcnet_bias_initializer=None, head_fcnet_bias_initializer_kwargs=None, free_log_std=False, log_std_clip_param=20.0, vf_share_layers=True, use_lstm=False, max_seq_len=20, lstm_cell_size=256, lstm_use_prev_action=False, lstm_use_prev_reward=False, lstm_kernel_initializer=None, lstm_kernel_initializer_kwargs=None, lstm_bias_initializer=None, lstm_bias_initializer_kwargs=None), catalog_class=None, load_state_path=None, model_config_dict=None)", "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "_validate_config": true, "_use_msgpack_checkpoints": false, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "env_task_fn": -1, "enable_connectors": -1, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.3585126254792, "kl_target": 0.0279643282718, "vf_loss_coeff": 0.5790097361641, "entropy_coeff": 0.0432335706043, "clip_param": 0.1935989459602, "vf_clip_param": 0.1014075551514, "entropy_coeff_schedule": null, "lr_schedule": null, "sgd_minibatch_size": -1, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9084803827711, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.callbacks.callbacks.RLlibCallback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 29.83969807624817, "iterations_since_restore": 6, "perf": {"cpu_util_percent": 11.857142857142858, "ram_util_percent": 69.89999999999999}}
{"timers": {"training_iteration": 4.2536035592971535, "restore_env_runners": 1.6518544142703593e-05, "training_step": 4.253366224225997, "env_runner_sampling_timer": 3.81000462072039, "learner_update_timer": 0.4398536649638881, "synch_weights": 0.0015008412840798553, "restore_eval_env_runners": 1.451519299898334e-05, "evaluation_iteration": 0.7589484662482717, "synch_eval_env_connectors": 0.0004458597722080342, "synch_env_connectors": 2.1089020742837763e-05}, "env_runners": {"env_to_module_connector": {"timers": {"connectors": {"add_observations_from_episodes_to_batch": 6.5136973062732225e-06, "add_time_dim_to_batch_and_zero_pad": 6.4928968668421705e-06, "add_states_from_episodes_to_batch": 3.5875902387900527e-06, "batch_individual_items": 1.8268776785495324e-05, "numpy_to_tensor": 3.112692946085604e-05}}, "connector_pipeline_timer": 0.00011879281277466641}, "num_episodes": 100.0, "num_agent_steps_sampled_lifetime": {"default_agent": -1202500.0}, "weights_seq_no": 6.0, "episode_return_max": 14.5, "module_to_env_connector": {"timers": {"connectors": {"normalize_and_clip_actions": 2.2275411002811946e-05, "listify_data_for_vector_env": 3.077873433069039e-05, "get_actions": 0.00016293433234857533, "un_batch_to_individual_items": 1.5249387771688133e-05, "tensor_to_numpy": 4.871600493085541e-05, "remove_single_ts_time_rank_from_batch": 1.5163456401072794e-06}}, "connector_pipeline_timer": 0.0003588079859534128}, "time_between_sampling": 0.012636734868109296, "num_episodes_lifetime": -24050.0, "episode_len_max": 50, "sample": 0.037622495182128714, "num_agent_steps_sampled": {"default_agent": 5000.0}, "env_reset_timer": 9.165826755927393e-05, "agent_episode_returns_mean": {"default_agent": 5.5}, "rlmodule_inference_timer": 0.00010168095300107994, "episode_return_min": -5.5, "num_env_steps_sampled_lifetime": -1202500.0, "episode_len_min": 50, "episode_duration_sec_mean": 0.03644220893002057, "episode_len_mean": 50.0, "num_module_steps_sampled": {"default_policy": 5000.0}, "episode_return_mean": 5.5, "num_module_steps_sampled_lifetime": {"default_policy": -1202500.0}, "env_to_module_sum_episodes_length_in": 27.16809333212661, "module_episode_returns_mean": {"default_policy": 5.5}, "num_env_steps_sampled": 5000.0, "env_to_module_sum_episodes_length_out": 27.16809333212661, "env_step_timer": 4.2870404549843374e-05, "num_env_steps_sampled_lifetime_throughput": 1280.1807323251796}, "learners": {"__all_modules__": {"num_non_trainable_parameters": 0, "num_module_steps_trained": 11000, "learner_connector": {"timers": {"connectors": {"add_time_dim_to_batch_and_zero_pad": 2.6031651568255982e-05, "batch_individual_items": 0.19792855115752947, "general_advantage_estimation": 0.012689937079708382, "add_states_from_episodes_to_batch": 6.083148410930625e-06, "numpy_to_tensor": 0.00015981319355464952, "add_one_ts_to_episodes_and_truncate": 0.008224550680131745, "add_columns_from_episodes_to_train_batch": 0.06672024831964268, "add_observations_from_episodes_to_batch": 0.0007459006686142913}}, "connector_pipeline_timer": 0.2867802545212875}, "num_module_steps_trained_lifetime": 77000, "learner_connector_sum_episodes_length_in": 5000.0, "num_env_steps_trained": 56100, "num_trainable_parameters": 13237, "learner_connector_sum_episodes_length_out": 5100.0, "num_env_steps_trained_lifetime": 392700, "num_env_steps_trained_lifetime_throughput": 825406.7516194665, "num_module_steps_trained_throughput": 162226.94700864202, "num_module_steps_trained_lifetime_throughput": 162136.39997580508}, "default_policy": {"curr_entropy_coeff": 0.0432335706043, "weights_seq_no": 7.0, "curr_kl_coeff": 0.0028008799999952316, "entropy": 0.6881858110427856, "total_loss": 0.011030236259102821, "num_module_steps_trained_lifetime": 77000, "gradients_default_optimizer_global_norm": 0.09222307056188583, "num_module_steps_trained": 11000, "vf_explained_var": 0.02480030059814453, "vf_loss": 0.09424873441457748, "policy_loss": -0.013788086362183094, "default_optimizer_learning_rate": 3.68800684e-05, "module_train_batch_size_mean": 1000.0, "vf_loss_unclipped": 13.016518592834473, "mean_kl_loss": 1.9837178115267307e-05, "num_trainable_parameters": 13237, "diff_num_grad_updates_vs_sampler_policy": 1.0, "num_module_steps_trained_lifetime_throughput": 162488.27269123102}}, "num_training_step_calls_per_iteration": 1, "evaluation": {"env_runners": {"env_to_module_connector": {"timers": {"connectors": {"add_states_from_episodes_to_batch": 3.2658351227693857e-06, "numpy_to_tensor": 3.09658480083437e-05, "add_observations_from_episodes_to_batch": 6.3815576878253755e-06, "add_time_dim_to_batch_and_zero_pad": 5.563000342983951e-06, "batch_individual_items": 1.8580362542761157e-05}}, "connector_pipeline_timer": 0.0001190669461853732}, "episode_len_max": 50, "module_to_env_connector": {"timers": {"connectors": {"remove_single_ts_time_rank_from_batch": 1.4370826410038936e-06, "get_actions": 0.00015886276801192506, "un_batch_to_individual_items": 1.532109115191246e-05, "tensor_to_numpy": 4.713345112752963e-05, "normalize_and_clip_actions": 2.2319366145872083e-05, "listify_data_for_vector_env": 3.128763881051749e-05}}, "connector_pipeline_timer": 0.00035385822518387494}, "episode_return_min": -16.5, "num_env_steps_sampled_lifetime": 36000, "env_to_module_sum_episodes_length_out": 27.168093332126602, "num_episodes_lifetime": 140, "num_agent_steps_sampled_lifetime": {"default_agent": 7000}, "env_reset_timer": 0.00023560851669645212, "rlmodule_inference_timer": 0.00010143950710541737, "episode_duration_sec_mean": 0.0360559779399955, "episode_len_mean": 50.0, "episode_return_mean": -0.9, "num_env_steps_sampled": 1000, "num_module_steps_sampled": {"default_policy": 1000}, "episode_return_max": 17.5, "module_episode_returns_mean": {"default_policy": -0.9}, "sample": 0.7471754310179333, "episode_len_min": 50, "env_to_module_sum_episodes_length_in": 27.168093332126602, "num_episodes": 20, "num_module_steps_sampled_lifetime": {"default_policy": 7000}, "num_agent_steps_sampled": {"default_agent": 1000}, "agent_episode_returns_mean": {"default_agent": -0.9}, "env_step_timer": 4.3148855549295974e-05, "weights_seq_no": 7.0, "time_between_sampling": 4.156993603177298}, "num_healthy_workers": 1, "actor_manager_num_outstanding_async_reqs": 0, "num_remote_worker_restarts": 0}, "num_env_steps_sampled_lifetime": -1202500.0, "fault_tolerance": {"num_healthy_workers": 0, "num_remote_worker_restarts": 0}, "env_runner_group": {"actor_manager_num_outstanding_async_reqs": 0}, "done": true, "training_iteration": 7, "trial_id": "af132_00000", "date": "2025-08-11_17-18-03", "timestamp": 1754925483, "time_this_iter_s": 4.885359764099121, "time_total_s": 34.72505784034729, "pid": 69010, "hostname": "DESKTOP-3SK5A41", "node_ip": "192.168.40.242", "config": {"exploration_config": {}, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 6, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "env": "Umbrella", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": false, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 0, "create_local_env_runner": true, "num_envs_per_env_runner": 1, "gym_env_vectorize_mode": "SYNC", "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "episodes_to_numpy": true, "max_requests_in_flight_per_env_runner": 1, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "merge_env_runner_states": "training_only", "broadcast_env_runner_states": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "complete_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "sampler_perf_stats_ema_coef": null, "_is_online": true, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": "auto", "num_aggregator_actors_per_learner": 0, "max_requests_in_flight_per_aggregator_actor": 3, "local_gpu_idx": 0, "max_requests_in_flight_per_learner": 3, "gamma": 1, "lr": 3.68800684e-05, "grad_clip": 0.5, "grad_clip_by": "global_norm", "_train_batch_size_per_learner": 5000, "train_batch_size": 4000, "num_epochs": 2, "minibatch_size": 1000, "shuffle_batch_per_epoch": true, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "log_std_clip_param": 20.0, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "_disable_preprocessor_api": false, "_disable_action_flattening": false}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "_learner_class": null, "callbacks_on_algorithm_init": null, "callbacks_on_env_runners_recreated": null, "callbacks_on_offline_eval_runners_recreated": null, "callbacks_on_checkpoint_loaded": null, "callbacks_on_environment_created": null, "callbacks_on_episode_created": null, "callbacks_on_episode_start": null, "callbacks_on_episode_step": null, "callbacks_on_episode_end": null, "callbacks_on_evaluate_start": null, "callbacks_on_evaluate_end": null, "callbacks_on_evaluate_offline_start": null, "callbacks_on_evaluate_offline_end": null, "callbacks_on_sample_end": null, "callbacks_on_train_result": null, "explore": true, "enable_rl_module_and_learner": true, "enable_env_runner_and_connector_v2": true, "_prior_exploration_config": {"type": "StochasticSampling"}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7e3fa4feaac0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "offline_data_class": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_read_batch_size": null, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "materialize_data": false, "materialize_mapped_data": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "ignore_final_observation": false, "prelearner_class": null, "prelearner_buffer_class": null, "prelearner_buffer_kwargs": {}, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_remaining_data": false, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": 1, "evaluation_duration": 20, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_auto_duration_min_env_steps_per_sample": 100, "evaluation_auto_duration_max_env_steps_per_sample": 2000, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 1, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "offline_evaluation_interval": null, "num_offline_eval_runners": 0, "offline_loss_for_module_fn": null, "offline_evaluation_duration": 1, "offline_evaluation_parallel_to_training": false, "offline_evaluation_timeout_s": 120.0, "num_cpus_per_offline_eval_runner": 1, "num_gpus_per_offline_eval_runner": 0, "custom_resources_per_offline_eval_runner": {}, "restart_failed_offline_eval_runners": true, "ignore_offline_eval_runner_failures": false, "max_num_offline_eval_runner_restarts": 1000, "offline_eval_runner_restore_timeout_s": 1800.0, "max_requests_in_flight_per_offline_eval_runner": 1, "validate_offline_eval_runners_after_construction": true, "offline_eval_runner_health_probe_timeout_s": 30.0, "offline_eval_rl_module_inference_only": false, "broadcast_offline_eval_runner_states": false, "offline_eval_batch_size_per_runner": 256, "dataset_num_iters_per_eval_runner": 1, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "log_gradients": true, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 42, "restart_failed_env_runners": true, "ignore_env_runner_failures": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30.0, "env_runner_restore_timeout_s": 1800.0, "_model_config": {}, "_rl_module_spec": "RLModuleSpec(module_class=None, observation_space=None, action_space=None, inference_only=False, learner_only=False, model_config=DefaultModelConfig(fcnet_hiddens=[102, 121], fcnet_activation='tanh', fcnet_kernel_initializer=None, fcnet_kernel_initializer_kwargs=None, fcnet_bias_initializer=None, fcnet_bias_initializer_kwargs=None, conv_filters=None, conv_activation='relu', conv_kernel_initializer=None, conv_kernel_initializer_kwargs=None, conv_bias_initializer=None, conv_bias_initializer_kwargs=None, head_fcnet_hiddens=[], head_fcnet_activation='relu', head_fcnet_kernel_initializer=None, head_fcnet_kernel_initializer_kwargs=None, head_fcnet_bias_initializer=None, head_fcnet_bias_initializer_kwargs=None, free_log_std=False, log_std_clip_param=20.0, vf_share_layers=True, use_lstm=False, max_seq_len=20, lstm_cell_size=256, lstm_use_prev_action=False, lstm_use_prev_reward=False, lstm_kernel_initializer=None, lstm_kernel_initializer_kwargs=None, lstm_bias_initializer=None, lstm_bias_initializer_kwargs=None), catalog_class=None, load_state_path=None, model_config_dict=None)", "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "_validate_config": true, "_use_msgpack_checkpoints": false, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "env_task_fn": -1, "enable_connectors": -1, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.3585126254792, "kl_target": 0.0279643282718, "vf_loss_coeff": 0.5790097361641, "entropy_coeff": 0.0432335706043, "clip_param": 0.1935989459602, "vf_clip_param": 0.1014075551514, "entropy_coeff_schedule": null, "lr_schedule": null, "sgd_minibatch_size": -1, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9084803827711, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.callbacks.callbacks.RLlibCallback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 34.72505784034729, "iterations_since_restore": 7, "perf": {"cpu_util_percent": 12.099999999999998, "ram_util_percent": 69.89999999999999}}
