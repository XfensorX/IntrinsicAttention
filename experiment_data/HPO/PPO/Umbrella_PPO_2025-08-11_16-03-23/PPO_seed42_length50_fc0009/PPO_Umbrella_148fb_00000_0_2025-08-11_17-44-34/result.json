{"timers": {"training_iteration": 4.3350087010003335, "restore_env_runners": 1.7299999854003545e-05, "training_step": 4.334762501000114, "env_runner_sampling_timer": 3.901426899999933, "learner_update_timer": 0.4299514009999257, "synch_weights": 0.0014375999999174383}, "env_runners": {"module_to_env_connector": {"timers": {"connectors": {"remove_single_ts_time_rank_from_batch": 1.4611635288703955e-06, "get_actions": 0.0001678026448807934, "tensor_to_numpy": 4.776498908614594e-05, "normalize_and_clip_actions": 3.0082405803156646e-05, "un_batch_to_individual_items": 1.5612534706759815e-05, "listify_data_for_vector_env": 3.174920177885876e-05}}, "connector_pipeline_timer": 0.0003733628502264471}, "num_env_steps_sampled_lifetime": 252500.0, "agent_episode_returns_mean": {"default_agent": 6.5}, "episode_return_mean": 6.5, "env_step_timer": 4.688921128403183e-05, "num_agent_steps_sampled": {"default_agent": 5000.0}, "episode_len_min": 50, "env_to_module_connector": {"timers": {"connectors": {"add_observations_from_episodes_to_batch": 6.752906082773483e-06, "numpy_to_tensor": 3.1978146232747e-05, "add_states_from_episodes_to_batch": 3.625549884140209e-06, "add_time_dim_to_batch_and_zero_pad": 6.775270762506405e-06, "batch_individual_items": 1.912743900625553e-05}}, "connector_pipeline_timer": 0.0001253196344473034}, "episode_return_min": -5.5, "env_to_module_sum_episodes_length_in": 26.762340024562445, "num_episodes": 100.0, "weights_seq_no": 0.0, "episode_return_max": 14.5, "num_episodes_lifetime": 5050.0, "episode_duration_sec_mean": 0.03644582200005063, "episode_len_max": 50, "num_agent_steps_sampled_lifetime": {"default_agent": 252500.0}, "time_between_sampling": 0.0013506589185686938, "num_module_steps_sampled": {"default_policy": 5000.0}, "rlmodule_inference_timer": 0.00010451804870807116, "num_env_steps_sampled": 5000.0, "episode_len_mean": 50.0, "env_reset_timer": 0.00019379549157044147, "num_module_steps_sampled_lifetime": {"default_policy": 252500.0}, "env_to_module_sum_episodes_length_out": 26.762340024562445, "sample": 0.03930298719311836, "module_episode_returns_mean": {"default_policy": 6.5}, "num_env_steps_sampled_lifetime_throughput": 1253.1560752660776}, "learners": {"__all_modules__": {"learner_connector_sum_episodes_length_out": 5100, "learner_connector": {"connector_pipeline_timer": 0.3069411010001204, "timers": {"connectors": {"general_advantage_estimation": 0.01458349999938946, "add_time_dim_to_batch_and_zero_pad": 2.4599999960628338e-05, "batch_individual_items": 0.21242320100009238, "numpy_to_tensor": 0.00022939999962545699, "add_one_ts_to_episodes_and_truncate": 0.00857449999966775, "add_columns_from_episodes_to_train_batch": 0.06992949999948905, "add_observations_from_episodes_to_batch": 0.0007896999995864462, "add_states_from_episodes_to_batch": 6.100000064179767e-06}}}, "num_env_steps_trained": 30600, "num_env_steps_trained_lifetime": 30600, "num_module_steps_trained_lifetime": 6000, "num_trainable_parameters": 4965, "num_module_steps_trained": 6000, "num_non_trainable_parameters": 0, "learner_connector_sum_episodes_length_in": 5000, "num_env_steps_trained_lifetime_throughput": 886247.4502106218, "num_module_steps_trained_throughput": 174666.53840671762, "num_module_steps_trained_lifetime_throughput": 174611.15544234694}, "default_policy": {"diff_num_grad_updates_vs_sampler_policy": 1.0, "vf_explained_var": 0.2290852665901184, "curr_kl_coeff": 0.7232886552810669, "num_module_steps_trained_lifetime": 6000, "entropy": 0.6725015044212341, "num_trainable_parameters": 4965, "num_module_steps_trained": 6000, "default_optimizer_learning_rate": 0.0602050062423, "weights_seq_no": 1.0, "mean_kl_loss": 0.06555415689945221, "vf_loss": 0.1092611700296402, "vf_loss_unclipped": 20.753660202026367, "module_train_batch_size_mean": 1000.0, "curr_entropy_coeff": 0.0304386028221, "total_loss": -0.04146997258067131, "gradients_default_optimizer_global_norm": 1.2075830698013306, "policy_loss": -0.11037936061620712, "num_module_steps_trained_lifetime_throughput": 175264.29300853153}}, "num_training_step_calls_per_iteration": 1, "num_env_steps_sampled_lifetime": 252500.0, "evaluation": {"env_runners": {"rlmodule_inference_timer": 9.497399188090911e-05, "env_to_module_sum_episodes_length_out": 27.167134025045954, "sample": 0.7340558010000677, "module_episode_returns_mean": {"default_policy": -1.9}, "episode_return_mean": -1.9, "num_agent_steps_sampled": {"default_agent": 1000}, "module_to_env_connector": {"timers": {"connectors": {"un_batch_to_individual_items": 1.5366283022890092e-05, "remove_single_ts_time_rank_from_batch": 1.4563555507568077e-06, "get_actions": 0.00015305490426116547, "normalize_and_clip_actions": 2.227494233359124e-05, "tensor_to_numpy": 4.520292828322998e-05, "listify_data_for_vector_env": 3.032722079017531e-05}}, "connector_pipeline_timer": 0.00034189329259800335}, "env_step_timer": 4.1360261952302566e-05, "env_to_module_connector": {"timers": {"connectors": {"add_observations_from_episodes_to_batch": 6.54881245304973e-06, "add_states_from_episodes_to_batch": 3.2486418471725715e-06, "add_time_dim_to_batch_and_zero_pad": 5.700043443322669e-06, "batch_individual_items": 1.833311849620368e-05, "numpy_to_tensor": 2.9546760611321564e-05}}, "connector_pipeline_timer": 0.00011431056308421776}, "num_episodes": 20, "episode_return_max": 12.5, "env_reset_timer": 0.00021850000030099181, "weights_seq_no": 1.0, "episode_len_max": 50, "num_module_steps_sampled": {"default_policy": 1000}, "num_env_steps_sampled": 1000, "num_env_steps_sampled_lifetime": 6000, "agent_episode_returns_mean": {"default_agent": -1.9}, "episode_len_min": 50, "num_episodes_lifetime": 20, "episode_duration_sec_mean": 0.0352606450499934, "num_agent_steps_sampled_lifetime": {"default_agent": 1000}, "episode_len_mean": 50.0, "num_module_steps_sampled_lifetime": {"default_policy": 1000}, "episode_return_min": -16.5, "env_to_module_sum_episodes_length_in": 27.167134025045954}, "num_healthy_workers": 1, "actor_manager_num_outstanding_async_reqs": 0, "num_remote_worker_restarts": 0}, "fault_tolerance": {"num_healthy_workers": 0, "num_remote_worker_restarts": 0}, "env_runner_group": {"actor_manager_num_outstanding_async_reqs": 0}, "done": false, "training_iteration": 1, "trial_id": "148fb_00000", "date": "2025-08-11_17-49-51", "timestamp": 1754927391, "time_this_iter_s": 5.084855079650879, "time_total_s": 5.084855079650879, "pid": 97502, "hostname": "DESKTOP-3SK5A41", "node_ip": "192.168.40.242", "config": {"exploration_config": {}, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 6, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "env": "Umbrella", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": false, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 0, "create_local_env_runner": true, "num_envs_per_env_runner": 1, "gym_env_vectorize_mode": "SYNC", "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "episodes_to_numpy": true, "max_requests_in_flight_per_env_runner": 1, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "merge_env_runner_states": "training_only", "broadcast_env_runner_states": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "complete_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "sampler_perf_stats_ema_coef": null, "_is_online": true, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": "auto", "num_aggregator_actors_per_learner": 0, "max_requests_in_flight_per_aggregator_actor": 3, "local_gpu_idx": 0, "max_requests_in_flight_per_learner": 3, "gamma": 1, "lr": 0.0602050062423, "grad_clip": 0.5, "grad_clip_by": "global_norm", "_train_batch_size_per_learner": 5000, "train_batch_size": 4000, "num_epochs": 1, "minibatch_size": 1000, "shuffle_batch_per_epoch": true, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "log_std_clip_param": 20.0, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "_disable_preprocessor_api": false, "_disable_action_flattening": false}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "_learner_class": null, "callbacks_on_algorithm_init": null, "callbacks_on_env_runners_recreated": null, "callbacks_on_offline_eval_runners_recreated": null, "callbacks_on_checkpoint_loaded": null, "callbacks_on_environment_created": null, "callbacks_on_episode_created": null, "callbacks_on_episode_start": null, "callbacks_on_episode_step": null, "callbacks_on_episode_end": null, "callbacks_on_evaluate_start": null, "callbacks_on_evaluate_end": null, "callbacks_on_evaluate_offline_start": null, "callbacks_on_evaluate_offline_end": null, "callbacks_on_sample_end": null, "callbacks_on_train_result": null, "explore": true, "enable_rl_module_and_learner": true, "enable_env_runner_and_connector_v2": true, "_prior_exploration_config": {"type": "StochasticSampling"}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7f830969eac0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "offline_data_class": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_read_batch_size": null, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "materialize_data": false, "materialize_mapped_data": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "ignore_final_observation": false, "prelearner_class": null, "prelearner_buffer_class": null, "prelearner_buffer_kwargs": {}, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_remaining_data": false, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": 1, "evaluation_duration": 20, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_auto_duration_min_env_steps_per_sample": 100, "evaluation_auto_duration_max_env_steps_per_sample": 2000, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 1, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "offline_evaluation_interval": null, "num_offline_eval_runners": 0, "offline_loss_for_module_fn": null, "offline_evaluation_duration": 1, "offline_evaluation_parallel_to_training": false, "offline_evaluation_timeout_s": 120.0, "num_cpus_per_offline_eval_runner": 1, "num_gpus_per_offline_eval_runner": 0, "custom_resources_per_offline_eval_runner": {}, "restart_failed_offline_eval_runners": true, "ignore_offline_eval_runner_failures": false, "max_num_offline_eval_runner_restarts": 1000, "offline_eval_runner_restore_timeout_s": 1800.0, "max_requests_in_flight_per_offline_eval_runner": 1, "validate_offline_eval_runners_after_construction": true, "offline_eval_runner_health_probe_timeout_s": 30.0, "offline_eval_rl_module_inference_only": false, "broadcast_offline_eval_runner_states": false, "offline_eval_batch_size_per_runner": 256, "dataset_num_iters_per_eval_runner": 1, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "log_gradients": true, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 42, "restart_failed_env_runners": true, "ignore_env_runner_failures": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30.0, "env_runner_restore_timeout_s": 1800.0, "_model_config": {}, "_rl_module_spec": "RLModuleSpec(module_class=None, observation_space=None, action_space=None, inference_only=False, learner_only=False, model_config=DefaultModelConfig(fcnet_hiddens=[127, 34], fcnet_activation='tanh', fcnet_kernel_initializer=None, fcnet_kernel_initializer_kwargs=None, fcnet_bias_initializer=None, fcnet_bias_initializer_kwargs=None, conv_filters=None, conv_activation='relu', conv_kernel_initializer=None, conv_kernel_initializer_kwargs=None, conv_bias_initializer=None, conv_bias_initializer_kwargs=None, head_fcnet_hiddens=[], head_fcnet_activation='relu', head_fcnet_kernel_initializer=None, head_fcnet_kernel_initializer_kwargs=None, head_fcnet_bias_initializer=None, head_fcnet_bias_initializer_kwargs=None, free_log_std=False, log_std_clip_param=20.0, vf_share_layers=True, use_lstm=False, max_seq_len=20, lstm_cell_size=256, lstm_use_prev_action=False, lstm_use_prev_reward=False, lstm_kernel_initializer=None, lstm_kernel_initializer_kwargs=None, lstm_bias_initializer=None, lstm_bias_initializer_kwargs=None), catalog_class=None, load_state_path=None, model_config_dict=None)", "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "_validate_config": true, "_use_msgpack_checkpoints": false, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "env_task_fn": -1, "enable_connectors": -1, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.4821924166921, "kl_target": 0.0121335369454, "vf_loss_coeff": 0.5287301420718, "entropy_coeff": 0.0304386028221, "clip_param": 0.2973082591601, "vf_clip_param": 0.1116643404955, "entropy_coeff_schedule": null, "lr_schedule": null, "sgd_minibatch_size": -1, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9313529170176, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.callbacks.callbacks.RLlibCallback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 5.084855079650879, "iterations_since_restore": 1, "perf": {"cpu_util_percent": 11.7, "ram_util_percent": 83.075}}
{"timers": {"training_iteration": 4.332421423040333, "restore_env_runners": 1.7263999852730192e-05, "training_step": 4.332173933040113, "env_runner_sampling_timer": 3.9012911020399312, "learner_update_timer": 0.42749579799992715, "synch_weights": 0.0014380139999229868, "restore_eval_env_runners": 1.3300000318849925e-05, "evaluation_iteration": 0.7461933009999484, "synch_eval_env_connectors": 0.00045360000058281, "synch_env_connectors": 9.500000487605575e-06}, "env_runners": {"module_to_env_connector": {"timers": {"connectors": {"remove_single_ts_time_rank_from_batch": 1.3991784797384525e-06, "get_actions": 0.00016204895038198527, "tensor_to_numpy": 4.85239024667571e-05, "normalize_and_clip_actions": 2.2332486800613524e-05, "un_batch_to_individual_items": 1.5009459481010682e-05, "listify_data_for_vector_env": 3.117118371445311e-05}}, "connector_pipeline_timer": 0.00035727812307970934}, "num_env_steps_sampled_lifetime": 10000.0, "agent_episode_returns_mean": {"default_agent": 3.7}, "episode_return_mean": 3.7, "env_step_timer": 4.396762083521617e-05, "num_agent_steps_sampled": {"default_agent": 5000.0}, "episode_len_min": 50, "env_to_module_connector": {"timers": {"connectors": {"add_observations_from_episodes_to_batch": 6.544676377311449e-06, "numpy_to_tensor": 3.1133107244462275e-05, "add_states_from_episodes_to_batch": 3.545998468573868e-06, "add_time_dim_to_batch_and_zero_pad": 6.444633249361268e-06, "batch_individual_items": 1.848876109875824e-05}}, "connector_pipeline_timer": 0.00011889177038664017}, "episode_return_min": -5.5, "env_to_module_sum_episodes_length_in": 27.16809333212661, "num_episodes": 100.0, "weights_seq_no": 1.0, "episode_return_max": 14.5, "num_episodes_lifetime": 200.0, "episode_duration_sec_mean": 0.03630980104001537, "episode_len_max": 50, "num_agent_steps_sampled_lifetime": {"default_agent": 10000.0}, "time_between_sampling": 0.009164284827112172, "num_module_steps_sampled": {"default_policy": 5000.0}, "rlmodule_inference_timer": 9.903426266458607e-05, "num_env_steps_sampled": 5000.0, "episode_len_mean": 50.0, "env_reset_timer": 0.00013312649525874188, "num_module_steps_sampled_lifetime": {"default_policy": 10000.0}, "env_to_module_sum_episodes_length_out": 27.16809333212661, "sample": 0.03825296966112057, "module_episode_returns_mean": {"default_policy": 3.7}, "num_env_steps_sampled_lifetime_throughput": 1281.0799556876975}, "learners": {"__all_modules__": {"learner_connector_sum_episodes_length_out": 5100.0, "learner_connector": {"connector_pipeline_timer": 0.3053590200001236, "timers": {"connectors": {"general_advantage_estimation": 0.014544212999398952, "add_time_dim_to_batch_and_zero_pad": 2.4615999964225922e-05, "batch_individual_items": 0.2108928590000869, "numpy_to_tensor": 0.00022878099963236307, "add_one_ts_to_episodes_and_truncate": 0.008573432999664874, "add_columns_from_episodes_to_train_batch": 0.06992020399949068, "add_observations_from_episodes_to_batch": 0.000788951999584242, "add_states_from_episodes_to_batch": 6.098000058045727e-06}}}, "num_env_steps_trained": 30600, "num_env_steps_trained_lifetime": 61200, "num_module_steps_trained_lifetime": 12000, "num_trainable_parameters": 4965, "num_module_steps_trained": 6000, "num_non_trainable_parameters": 0, "learner_connector_sum_episodes_length_in": 5000.0, "num_env_steps_trained_lifetime_throughput": 885387.3636229921, "num_module_steps_trained_throughput": 174486.6540135438, "num_module_steps_trained_lifetime_throughput": 174431.06281778563}, "default_policy": {"diff_num_grad_updates_vs_sampler_policy": 1.0, "vf_explained_var": 0.04662060737609863, "curr_kl_coeff": 1.0849330425262451, "num_module_steps_trained_lifetime": 12000, "entropy": 0.6653162837028503, "num_trainable_parameters": 4965, "num_module_steps_trained": 6000, "default_optimizer_learning_rate": 0.0602050062423, "weights_seq_no": 2.0, "mean_kl_loss": 0.04468359798192978, "vf_loss": 0.10497965663671494, "vf_loss_unclipped": 14.603506088256836, "module_train_batch_size_mean": 1000.0, "curr_entropy_coeff": 0.0304386028221, "total_loss": 0.1959933191537857, "gradients_default_optimizer_global_norm": 0.7611185312271118, "policy_loss": 0.12841954827308655, "num_module_steps_trained_lifetime_throughput": 175070.37166714115}}, "num_training_step_calls_per_iteration": 1, "evaluation": {"env_runners": {"rlmodule_inference_timer": 9.604564413467307e-05, "env_to_module_sum_episodes_length_out": 27.168093298253442, "sample": 0.734042244010061, "module_episode_returns_mean": {"default_policy": -1.9}, "episode_return_mean": -1.9, "num_agent_steps_sampled": {"default_agent": 1000}, "module_to_env_connector": {"timers": {"connectors": {"un_batch_to_individual_items": 1.5343890728672737e-05, "remove_single_ts_time_rank_from_batch": 1.5243651926068344e-06, "get_actions": 0.0001529052602688841, "normalize_and_clip_actions": 2.2400275729954875e-05, "tensor_to_numpy": 4.556080069315851e-05, "listify_data_for_vector_env": 3.1135450658147e-05}}, "connector_pipeline_timer": 0.0003425166373590857}, "env_step_timer": 4.2010310840488914e-05, "env_to_module_connector": {"timers": {"connectors": {"add_observations_from_episodes_to_batch": 6.2937683739163695e-06, "add_states_from_episodes_to_batch": 3.3623779178257466e-06, "add_time_dim_to_batch_and_zero_pad": 5.623359947429804e-06, "batch_individual_items": 1.853822340420534e-05, "numpy_to_tensor": 2.973097450846684e-05}}, "connector_pipeline_timer": 0.00011505267731575633}, "num_episodes": 20, "episode_return_max": 17.5, "env_reset_timer": 0.00021758600029897935, "weights_seq_no": 2.0, "episode_len_max": 50, "num_module_steps_sampled": {"default_policy": 1000}, "num_env_steps_sampled": 1000, "num_env_steps_sampled_lifetime": 11000, "agent_episode_returns_mean": {"default_agent": -1.9}, "episode_len_min": 50, "num_episodes_lifetime": 40, "episode_duration_sec_mean": 0.03524173007504032, "num_agent_steps_sampled_lifetime": {"default_agent": 2000}, "episode_len_mean": 50.0, "num_module_steps_sampled_lifetime": {"default_policy": 2000}, "episode_return_min": -16.5, "env_to_module_sum_episodes_length_in": 27.168093298253442, "time_between_sampling": 4.132662104999326}, "num_healthy_workers": 1, "actor_manager_num_outstanding_async_reqs": 0, "num_remote_worker_restarts": 0}, "num_env_steps_sampled_lifetime": 10000.0, "fault_tolerance": {"num_healthy_workers": 0, "num_remote_worker_restarts": 0}, "env_runner_group": {"actor_manager_num_outstanding_async_reqs": 0}, "done": false, "training_iteration": 2, "trial_id": "148fb_00000", "date": "2025-08-11_17-49-56", "timestamp": 1754927396, "time_this_iter_s": 4.823451519012451, "time_total_s": 9.90830659866333, "pid": 97502, "hostname": "DESKTOP-3SK5A41", "node_ip": "192.168.40.242", "config": {"exploration_config": {}, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 6, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "env": "Umbrella", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": false, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 0, "create_local_env_runner": true, "num_envs_per_env_runner": 1, "gym_env_vectorize_mode": "SYNC", "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "episodes_to_numpy": true, "max_requests_in_flight_per_env_runner": 1, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "merge_env_runner_states": "training_only", "broadcast_env_runner_states": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "complete_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "sampler_perf_stats_ema_coef": null, "_is_online": true, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": "auto", "num_aggregator_actors_per_learner": 0, "max_requests_in_flight_per_aggregator_actor": 3, "local_gpu_idx": 0, "max_requests_in_flight_per_learner": 3, "gamma": 1, "lr": 0.0602050062423, "grad_clip": 0.5, "grad_clip_by": "global_norm", "_train_batch_size_per_learner": 5000, "train_batch_size": 4000, "num_epochs": 1, "minibatch_size": 1000, "shuffle_batch_per_epoch": true, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "log_std_clip_param": 20.0, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "_disable_preprocessor_api": false, "_disable_action_flattening": false}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "_learner_class": null, "callbacks_on_algorithm_init": null, "callbacks_on_env_runners_recreated": null, "callbacks_on_offline_eval_runners_recreated": null, "callbacks_on_checkpoint_loaded": null, "callbacks_on_environment_created": null, "callbacks_on_episode_created": null, "callbacks_on_episode_start": null, "callbacks_on_episode_step": null, "callbacks_on_episode_end": null, "callbacks_on_evaluate_start": null, "callbacks_on_evaluate_end": null, "callbacks_on_evaluate_offline_start": null, "callbacks_on_evaluate_offline_end": null, "callbacks_on_sample_end": null, "callbacks_on_train_result": null, "explore": true, "enable_rl_module_and_learner": true, "enable_env_runner_and_connector_v2": true, "_prior_exploration_config": {"type": "StochasticSampling"}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7f830969eac0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "offline_data_class": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_read_batch_size": null, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "materialize_data": false, "materialize_mapped_data": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "ignore_final_observation": false, "prelearner_class": null, "prelearner_buffer_class": null, "prelearner_buffer_kwargs": {}, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_remaining_data": false, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": 1, "evaluation_duration": 20, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_auto_duration_min_env_steps_per_sample": 100, "evaluation_auto_duration_max_env_steps_per_sample": 2000, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 1, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "offline_evaluation_interval": null, "num_offline_eval_runners": 0, "offline_loss_for_module_fn": null, "offline_evaluation_duration": 1, "offline_evaluation_parallel_to_training": false, "offline_evaluation_timeout_s": 120.0, "num_cpus_per_offline_eval_runner": 1, "num_gpus_per_offline_eval_runner": 0, "custom_resources_per_offline_eval_runner": {}, "restart_failed_offline_eval_runners": true, "ignore_offline_eval_runner_failures": false, "max_num_offline_eval_runner_restarts": 1000, "offline_eval_runner_restore_timeout_s": 1800.0, "max_requests_in_flight_per_offline_eval_runner": 1, "validate_offline_eval_runners_after_construction": true, "offline_eval_runner_health_probe_timeout_s": 30.0, "offline_eval_rl_module_inference_only": false, "broadcast_offline_eval_runner_states": false, "offline_eval_batch_size_per_runner": 256, "dataset_num_iters_per_eval_runner": 1, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "log_gradients": true, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 42, "restart_failed_env_runners": true, "ignore_env_runner_failures": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30.0, "env_runner_restore_timeout_s": 1800.0, "_model_config": {}, "_rl_module_spec": "RLModuleSpec(module_class=None, observation_space=None, action_space=None, inference_only=False, learner_only=False, model_config=DefaultModelConfig(fcnet_hiddens=[127, 34], fcnet_activation='tanh', fcnet_kernel_initializer=None, fcnet_kernel_initializer_kwargs=None, fcnet_bias_initializer=None, fcnet_bias_initializer_kwargs=None, conv_filters=None, conv_activation='relu', conv_kernel_initializer=None, conv_kernel_initializer_kwargs=None, conv_bias_initializer=None, conv_bias_initializer_kwargs=None, head_fcnet_hiddens=[], head_fcnet_activation='relu', head_fcnet_kernel_initializer=None, head_fcnet_kernel_initializer_kwargs=None, head_fcnet_bias_initializer=None, head_fcnet_bias_initializer_kwargs=None, free_log_std=False, log_std_clip_param=20.0, vf_share_layers=True, use_lstm=False, max_seq_len=20, lstm_cell_size=256, lstm_use_prev_action=False, lstm_use_prev_reward=False, lstm_kernel_initializer=None, lstm_kernel_initializer_kwargs=None, lstm_bias_initializer=None, lstm_bias_initializer_kwargs=None), catalog_class=None, load_state_path=None, model_config_dict=None)", "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "_validate_config": true, "_use_msgpack_checkpoints": false, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "env_task_fn": -1, "enable_connectors": -1, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.4821924166921, "kl_target": 0.0121335369454, "vf_loss_coeff": 0.5287301420718, "entropy_coeff": 0.0304386028221, "clip_param": 0.2973082591601, "vf_clip_param": 0.1116643404955, "entropy_coeff_schedule": null, "lr_schedule": null, "sgd_minibatch_size": -1, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9313529170176, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.callbacks.callbacks.RLlibCallback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 9.90830659866333, "iterations_since_restore": 2, "perf": {"cpu_util_percent": 12.37142857142857, "ram_util_percent": 83.2}}
{"timers": {"training_iteration": 4.331687086919931, "restore_env_runners": 1.7245359853586702e-05, "training_step": 4.33143736281971, "env_runner_sampling_timer": 3.9030089741295346, "learner_update_timer": 0.42504014101992377, "synch_weights": 0.0014375898599262654, "restore_eval_env_runners": 1.3284000324347288e-05, "evaluation_iteration": 0.7461557380099475, "synch_eval_env_connectors": 0.0004533940005785553, "synch_env_connectors": 9.475000479142183e-06}, "env_runners": {"module_to_env_connector": {"timers": {"connectors": {"remove_single_ts_time_rank_from_batch": 1.4578866368178224e-06, "get_actions": 0.00016352439870579978, "tensor_to_numpy": 4.9125576491835424e-05, "normalize_and_clip_actions": 2.266484440401874e-05, "un_batch_to_individual_items": 1.5296113186396935e-05, "listify_data_for_vector_env": 3.1455557379099055e-05}}, "connector_pipeline_timer": 0.0003612146447303369}, "num_env_steps_sampled_lifetime": -232500.0, "agent_episode_returns_mean": {"default_agent": 6.5}, "episode_return_mean": 6.5, "env_step_timer": 4.423597809802146e-05, "num_agent_steps_sampled": {"default_agent": 5000.0}, "episode_len_min": 50, "env_to_module_connector": {"timers": {"connectors": {"add_observations_from_episodes_to_batch": 6.61113495721643e-06, "numpy_to_tensor": 3.150179362378988e-05, "add_states_from_episodes_to_batch": 3.585218356190407e-06, "add_time_dim_to_batch_and_zero_pad": 6.515993367103665e-06, "batch_individual_items": 1.872990285496608e-05}}, "connector_pipeline_timer": 0.00012028790130498901}, "episode_return_min": -5.5, "env_to_module_sum_episodes_length_in": 27.16809333212661, "num_episodes": 100.0, "weights_seq_no": 2.0, "episode_return_max": 14.5, "num_episodes_lifetime": -4650.0, "episode_duration_sec_mean": 0.038141361099988, "episode_len_max": 50, "num_agent_steps_sampled_lifetime": {"default_agent": -232500.0}, "time_between_sampling": 0.010521177838059448, "num_module_steps_sampled": {"default_policy": 5000.0}, "rlmodule_inference_timer": 0.0001343189949043294, "num_env_steps_sampled": 5000.0, "episode_len_mean": 50.0, "env_reset_timer": 0.00010860767734108181, "num_module_steps_sampled_lifetime": {"default_policy": -232500.0}, "env_to_module_sum_episodes_length_out": 27.16809333212661, "sample": 0.03825312732905313, "module_episode_returns_mean": {"default_policy": 6.5}, "num_env_steps_sampled_lifetime_throughput": 1266.3725617729156}, "learners": {"__all_modules__": {"learner_connector_sum_episodes_length_out": 5100.0, "learner_connector": {"connector_pipeline_timer": 0.3038004608001264, "timers": {"connectors": {"general_advantage_estimation": 0.014485861869400742, "add_time_dim_to_batch_and_zero_pad": 2.4785839967171343e-05, "batch_individual_items": 0.20938981041007973, "numpy_to_tensor": 0.0002284441896398675, "add_one_ts_to_episodes_and_truncate": 0.00857464966967118, "add_columns_from_episodes_to_train_batch": 0.06992228995949598, "add_observations_from_episodes_to_batch": 0.0007893254795881148, "add_states_from_episodes_to_batch": 6.111020057051064e-06}}}, "num_env_steps_trained": 30600, "num_env_steps_trained_lifetime": 91800, "num_module_steps_trained_lifetime": 18000, "num_trainable_parameters": 4965, "num_module_steps_trained": 6000, "num_non_trainable_parameters": 0, "learner_connector_sum_episodes_length_in": 5000.0, "num_env_steps_trained_lifetime_throughput": 885206.361198149, "num_module_steps_trained_throughput": 174433.31410190734, "num_module_steps_trained_lifetime_throughput": 174377.1490544807}, "default_policy": {"diff_num_grad_updates_vs_sampler_policy": 1.0, "vf_explained_var": -0.01934361457824707, "curr_kl_coeff": 1.6273995637893677, "num_module_steps_trained_lifetime": 18000, "entropy": 0.6908232569694519, "num_trainable_parameters": 4965, "num_module_steps_trained": 6000, "default_optimizer_learning_rate": 0.0602050062423, "weights_seq_no": 3.0, "mean_kl_loss": 0.032429903745651245, "vf_loss": 0.10523394495248795, "vf_loss_unclipped": 17.014589309692383, "module_train_batch_size_mean": 1000.0, "curr_entropy_coeff": 0.0304386028221, "total_loss": 0.12572960555553436, "gradients_default_optimizer_global_norm": 1.6986212730407715, "policy_loss": 0.05593264847993851, "num_module_steps_trained_lifetime_throughput": 174992.37845782444}}, "num_training_step_calls_per_iteration": 1, "evaluation": {"env_runners": {"rlmodule_inference_timer": 9.562527730645308e-05, "env_to_module_sum_episodes_length_out": 27.168093332125434, "sample": 0.7340375085899645, "module_episode_returns_mean": {"default_policy": -0.5666666666666667}, "episode_return_mean": -0.5666666666666667, "num_agent_steps_sampled": {"default_agent": 1000}, "module_to_env_connector": {"timers": {"connectors": {"un_batch_to_individual_items": 1.553446794197371e-05, "remove_single_ts_time_rank_from_batch": 1.4299149364475708e-06, "get_actions": 0.00015345120590837263, "normalize_and_clip_actions": 2.2734691728004984e-05, "tensor_to_numpy": 4.570101736541972e-05, "listify_data_for_vector_env": 3.089358639793993e-05}}, "connector_pipeline_timer": 0.0003437201945442453}, "env_step_timer": 4.1829698820304983e-05, "env_to_module_connector": {"timers": {"connectors": {"add_observations_from_episodes_to_batch": 6.0838866599932125e-06, "add_states_from_episodes_to_batch": 3.901092004207148e-06, "add_time_dim_to_batch_and_zero_pad": 5.6241016740044105e-06, "batch_individual_items": 1.8038269245865413e-05, "numpy_to_tensor": 2.9408598740696783e-05}}, "connector_pipeline_timer": 0.00011432274135064375}, "num_episodes": 20, "episode_return_max": 17.5, "env_reset_timer": 0.00021669014029275787, "weights_seq_no": 3.0, "episode_len_max": 50, "num_module_steps_sampled": {"default_policy": 1000}, "num_env_steps_sampled": 1000, "num_env_steps_sampled_lifetime": 16000, "agent_episode_returns_mean": {"default_agent": -0.5666666666666667}, "episode_len_min": 50, "num_episodes_lifetime": 60, "episode_duration_sec_mean": 0.03525005673336636, "num_agent_steps_sampled_lifetime": {"default_agent": 3000}, "episode_len_mean": 50.0, "num_module_steps_sampled_lifetime": {"default_policy": 3000}, "episode_return_min": -16.5, "env_to_module_sum_episodes_length_in": 27.168093332125434, "time_between_sampling": 4.134547468059336}, "num_healthy_workers": 1, "actor_manager_num_outstanding_async_reqs": 0, "num_remote_worker_restarts": 0}, "num_env_steps_sampled_lifetime": -232500.0, "fault_tolerance": {"num_healthy_workers": 0, "num_remote_worker_restarts": 0}, "env_runner_group": {"actor_manager_num_outstanding_async_reqs": 0}, "done": false, "training_iteration": 3, "trial_id": "148fb_00000", "date": "2025-08-11_17-50-01", "timestamp": 1754927401, "time_this_iter_s": 5.007522106170654, "time_total_s": 14.915828704833984, "pid": 97502, "hostname": "DESKTOP-3SK5A41", "node_ip": "192.168.40.242", "config": {"exploration_config": {}, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 6, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "env": "Umbrella", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": false, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 0, "create_local_env_runner": true, "num_envs_per_env_runner": 1, "gym_env_vectorize_mode": "SYNC", "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "episodes_to_numpy": true, "max_requests_in_flight_per_env_runner": 1, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "merge_env_runner_states": "training_only", "broadcast_env_runner_states": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "complete_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "sampler_perf_stats_ema_coef": null, "_is_online": true, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": "auto", "num_aggregator_actors_per_learner": 0, "max_requests_in_flight_per_aggregator_actor": 3, "local_gpu_idx": 0, "max_requests_in_flight_per_learner": 3, "gamma": 1, "lr": 0.0602050062423, "grad_clip": 0.5, "grad_clip_by": "global_norm", "_train_batch_size_per_learner": 5000, "train_batch_size": 4000, "num_epochs": 1, "minibatch_size": 1000, "shuffle_batch_per_epoch": true, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "log_std_clip_param": 20.0, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "_disable_preprocessor_api": false, "_disable_action_flattening": false}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "_learner_class": null, "callbacks_on_algorithm_init": null, "callbacks_on_env_runners_recreated": null, "callbacks_on_offline_eval_runners_recreated": null, "callbacks_on_checkpoint_loaded": null, "callbacks_on_environment_created": null, "callbacks_on_episode_created": null, "callbacks_on_episode_start": null, "callbacks_on_episode_step": null, "callbacks_on_episode_end": null, "callbacks_on_evaluate_start": null, "callbacks_on_evaluate_end": null, "callbacks_on_evaluate_offline_start": null, "callbacks_on_evaluate_offline_end": null, "callbacks_on_sample_end": null, "callbacks_on_train_result": null, "explore": true, "enable_rl_module_and_learner": true, "enable_env_runner_and_connector_v2": true, "_prior_exploration_config": {"type": "StochasticSampling"}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7f830969eac0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "offline_data_class": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_read_batch_size": null, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "materialize_data": false, "materialize_mapped_data": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "ignore_final_observation": false, "prelearner_class": null, "prelearner_buffer_class": null, "prelearner_buffer_kwargs": {}, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_remaining_data": false, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": 1, "evaluation_duration": 20, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_auto_duration_min_env_steps_per_sample": 100, "evaluation_auto_duration_max_env_steps_per_sample": 2000, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 1, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "offline_evaluation_interval": null, "num_offline_eval_runners": 0, "offline_loss_for_module_fn": null, "offline_evaluation_duration": 1, "offline_evaluation_parallel_to_training": false, "offline_evaluation_timeout_s": 120.0, "num_cpus_per_offline_eval_runner": 1, "num_gpus_per_offline_eval_runner": 0, "custom_resources_per_offline_eval_runner": {}, "restart_failed_offline_eval_runners": true, "ignore_offline_eval_runner_failures": false, "max_num_offline_eval_runner_restarts": 1000, "offline_eval_runner_restore_timeout_s": 1800.0, "max_requests_in_flight_per_offline_eval_runner": 1, "validate_offline_eval_runners_after_construction": true, "offline_eval_runner_health_probe_timeout_s": 30.0, "offline_eval_rl_module_inference_only": false, "broadcast_offline_eval_runner_states": false, "offline_eval_batch_size_per_runner": 256, "dataset_num_iters_per_eval_runner": 1, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "log_gradients": true, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 42, "restart_failed_env_runners": true, "ignore_env_runner_failures": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30.0, "env_runner_restore_timeout_s": 1800.0, "_model_config": {}, "_rl_module_spec": "RLModuleSpec(module_class=None, observation_space=None, action_space=None, inference_only=False, learner_only=False, model_config=DefaultModelConfig(fcnet_hiddens=[127, 34], fcnet_activation='tanh', fcnet_kernel_initializer=None, fcnet_kernel_initializer_kwargs=None, fcnet_bias_initializer=None, fcnet_bias_initializer_kwargs=None, conv_filters=None, conv_activation='relu', conv_kernel_initializer=None, conv_kernel_initializer_kwargs=None, conv_bias_initializer=None, conv_bias_initializer_kwargs=None, head_fcnet_hiddens=[], head_fcnet_activation='relu', head_fcnet_kernel_initializer=None, head_fcnet_kernel_initializer_kwargs=None, head_fcnet_bias_initializer=None, head_fcnet_bias_initializer_kwargs=None, free_log_std=False, log_std_clip_param=20.0, vf_share_layers=True, use_lstm=False, max_seq_len=20, lstm_cell_size=256, lstm_use_prev_action=False, lstm_use_prev_reward=False, lstm_kernel_initializer=None, lstm_kernel_initializer_kwargs=None, lstm_bias_initializer=None, lstm_bias_initializer_kwargs=None), catalog_class=None, load_state_path=None, model_config_dict=None)", "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "_validate_config": true, "_use_msgpack_checkpoints": false, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "env_task_fn": -1, "enable_connectors": -1, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.4821924166921, "kl_target": 0.0121335369454, "vf_loss_coeff": 0.5287301420718, "entropy_coeff": 0.0304386028221, "clip_param": 0.2973082591601, "vf_clip_param": 0.1116643404955, "entropy_coeff_schedule": null, "lr_schedule": null, "sgd_minibatch_size": -1, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9313529170176, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.callbacks.callbacks.RLlibCallback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 14.915828704833984, "iterations_since_restore": 3, "perf": {"cpu_util_percent": 12.4, "ram_util_percent": 83.25714285714285}}
{"timers": {"training_iteration": 4.330895647180738, "restore_env_runners": 1.720990625231752e-05, "training_step": 4.33064418132151, "env_runner_sampling_timer": 3.9030106684982417, "learner_update_timer": 0.4242396866297235, "synch_weights": 0.0014381829613304778, "restore_eval_env_runners": 1.325116032767255e-05, "evaluation_iteration": 0.7461282436498484, "synch_eval_env_connectors": 0.0004525730605782883, "synch_env_connectors": 9.4552504724561e-06}, "env_runners": {"module_to_env_connector": {"timers": {"connectors": {"remove_single_ts_time_rank_from_batch": 1.3980702677072344e-06, "get_actions": 0.00016245336792910587, "tensor_to_numpy": 4.894442133663568e-05, "normalize_and_clip_actions": 2.2411258765930398e-05, "un_batch_to_individual_items": 1.5113838591970698e-05, "listify_data_for_vector_env": 3.1338293976174374e-05}}, "connector_pipeline_timer": 0.0003587023385457313}, "num_env_steps_sampled_lifetime": -475000.0, "agent_episode_returns_mean": {"default_agent": 6.5}, "episode_return_mean": 6.5, "env_step_timer": 4.406307191620712e-05, "num_agent_steps_sampled": {"default_agent": 5000.0}, "episode_len_min": 50, "env_to_module_connector": {"timers": {"connectors": {"add_observations_from_episodes_to_batch": 6.582030338194446e-06, "numpy_to_tensor": 3.1139761478416016e-05, "add_states_from_episodes_to_batch": 3.532535841335732e-06, "add_time_dim_to_batch_and_zero_pad": 6.436863919316442e-06, "batch_individual_items": 1.8633443372027253e-05}}, "connector_pipeline_timer": 0.00011931757313636723}, "episode_return_min": -5.5, "env_to_module_sum_episodes_length_in": 27.16809333212661, "num_episodes": 100.0, "weights_seq_no": 3.0, "episode_return_max": 14.5, "num_episodes_lifetime": -9500.0, "episode_duration_sec_mean": 0.03645666209993578, "episode_len_max": 50, "num_agent_steps_sampled_lifetime": {"default_agent": -475000.0}, "time_between_sampling": 0.010977096005812308, "num_module_steps_sampled": {"default_policy": 5000.0}, "rlmodule_inference_timer": 0.00010002646499023797, "num_env_steps_sampled": 5000.0, "episode_len_mean": 50.0, "env_reset_timer": 9.951392274914427e-05, "num_module_steps_sampled_lifetime": {"default_policy": -475000.0}, "env_to_module_sum_episodes_length_out": 27.16809333212661, "sample": 0.0384044933979977, "module_episode_returns_mean": {"default_policy": 6.5}, "num_env_steps_sampled_lifetime_throughput": 1275.6288435910742}, "learners": {"__all_modules__": {"learner_connector_sum_episodes_length_out": 5100.0, "learner_connector": {"connector_pipeline_timer": 0.3039205052021238, "timers": {"connectors": {"general_advantage_estimation": 0.014433037250706065, "add_time_dim_to_batch_and_zero_pad": 2.4795981567530363e-05, "batch_individual_items": 0.20939929430597462, "numpy_to_tensor": 0.00022786474774769066, "add_one_ts_to_episodes_and_truncate": 0.008732288182973214, "add_columns_from_episodes_to_train_batch": 0.06992963005989529, "add_observations_from_episodes_to_batch": 0.0007886282247890721, "add_states_from_episodes_to_batch": 6.120909851412762e-06}}}, "num_env_steps_trained": 30600, "num_env_steps_trained_lifetime": 122400, "num_module_steps_trained_lifetime": 24000, "num_trainable_parameters": 4965, "num_module_steps_trained": 6000, "num_non_trainable_parameters": 0, "learner_connector_sum_episodes_length_in": 5000.0, "num_env_steps_trained_lifetime_throughput": 886509.2397254516, "num_module_steps_trained_throughput": 174661.6206400102, "num_module_steps_trained_lifetime_throughput": 174606.1467705628}, "default_policy": {"diff_num_grad_updates_vs_sampler_policy": 1.0, "vf_explained_var": -0.018964648246765137, "curr_kl_coeff": 1.6273995637893677, "num_module_steps_trained_lifetime": 24000, "entropy": 0.6863486170768738, "num_trainable_parameters": 4965, "num_module_steps_trained": 6000, "default_optimizer_learning_rate": 0.0602050062423, "weights_seq_no": 4.0, "mean_kl_loss": 0.00853168498724699, "vf_loss": 0.11085359007120132, "vf_loss_unclipped": 14.170889854431152, "module_train_batch_size_mean": 1000.0, "curr_entropy_coeff": 0.0304386028221, "total_loss": -0.0922846645116806, "gradients_default_optimizer_global_norm": 0.32988491654396057, "policy_loss": -0.14388927817344666, "num_module_steps_trained_lifetime_throughput": 175191.19488422593}}, "num_training_step_calls_per_iteration": 1, "evaluation": {"env_runners": {"rlmodule_inference_timer": 9.784641201109222e-05, "env_to_module_sum_episodes_length_out": 27.168093332126602, "sample": 0.7341204615240691, "module_episode_returns_mean": {"default_policy": -0.65}, "episode_return_mean": -0.65, "num_agent_steps_sampled": {"default_agent": 1000}, "module_to_env_connector": {"timers": {"connectors": {"un_batch_to_individual_items": 1.5956229989388985e-05, "remove_single_ts_time_rank_from_batch": 1.4806923904101922e-06, "get_actions": 0.0001571496683699732, "normalize_and_clip_actions": 2.3728600458184714e-05, "tensor_to_numpy": 4.616052930010476e-05, "listify_data_for_vector_env": 3.163518274503241e-05}}, "connector_pipeline_timer": 0.0003521747152978779}, "env_step_timer": 4.345016211738256e-05, "env_to_module_connector": {"timers": {"connectors": {"add_observations_from_episodes_to_batch": 6.394681389055346e-06, "add_states_from_episodes_to_batch": 3.3783559072369604e-06, "add_time_dim_to_batch_and_zero_pad": 5.776014395932956e-06, "batch_individual_items": 1.8867728581008774e-05, "numpy_to_tensor": 3.056847828906486e-05}}, "connector_pipeline_timer": 0.00011808340759943313}, "num_episodes": 20, "episode_return_max": 17.5, "env_reset_timer": 0.00021580323888659858, "weights_seq_no": 4.0, "episode_len_max": 50, "num_module_steps_sampled": {"default_policy": 1000}, "num_env_steps_sampled": 1000, "num_env_steps_sampled_lifetime": 21000, "agent_episode_returns_mean": {"default_agent": -0.65}, "episode_len_min": 50, "num_episodes_lifetime": 80, "episode_duration_sec_mean": 0.03535094632502478, "num_agent_steps_sampled_lifetime": {"default_agent": 4000}, "episode_len_mean": 50.0, "num_module_steps_sampled_lifetime": {"default_policy": 4000}, "episode_return_min": -16.5, "env_to_module_sum_episodes_length_in": 27.168093332126602, "time_between_sampling": 4.136281771508738}, "num_healthy_workers": 1, "actor_manager_num_outstanding_async_reqs": 0, "num_remote_worker_restarts": 0}, "num_env_steps_sampled_lifetime": -475000.0, "fault_tolerance": {"num_healthy_workers": 0, "num_remote_worker_restarts": 0}, "env_runner_group": {"actor_manager_num_outstanding_async_reqs": 0}, "done": false, "training_iteration": 4, "trial_id": "148fb_00000", "date": "2025-08-11_17-50-06", "timestamp": 1754927406, "time_this_iter_s": 5.0097668170928955, "time_total_s": 19.92559552192688, "pid": 97502, "hostname": "DESKTOP-3SK5A41", "node_ip": "192.168.40.242", "config": {"exploration_config": {}, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 6, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "env": "Umbrella", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": false, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 0, "create_local_env_runner": true, "num_envs_per_env_runner": 1, "gym_env_vectorize_mode": "SYNC", "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "episodes_to_numpy": true, "max_requests_in_flight_per_env_runner": 1, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "merge_env_runner_states": "training_only", "broadcast_env_runner_states": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "complete_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "sampler_perf_stats_ema_coef": null, "_is_online": true, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": "auto", "num_aggregator_actors_per_learner": 0, "max_requests_in_flight_per_aggregator_actor": 3, "local_gpu_idx": 0, "max_requests_in_flight_per_learner": 3, "gamma": 1, "lr": 0.0602050062423, "grad_clip": 0.5, "grad_clip_by": "global_norm", "_train_batch_size_per_learner": 5000, "train_batch_size": 4000, "num_epochs": 1, "minibatch_size": 1000, "shuffle_batch_per_epoch": true, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "log_std_clip_param": 20.0, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "_disable_preprocessor_api": false, "_disable_action_flattening": false}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "_learner_class": null, "callbacks_on_algorithm_init": null, "callbacks_on_env_runners_recreated": null, "callbacks_on_offline_eval_runners_recreated": null, "callbacks_on_checkpoint_loaded": null, "callbacks_on_environment_created": null, "callbacks_on_episode_created": null, "callbacks_on_episode_start": null, "callbacks_on_episode_step": null, "callbacks_on_episode_end": null, "callbacks_on_evaluate_start": null, "callbacks_on_evaluate_end": null, "callbacks_on_evaluate_offline_start": null, "callbacks_on_evaluate_offline_end": null, "callbacks_on_sample_end": null, "callbacks_on_train_result": null, "explore": true, "enable_rl_module_and_learner": true, "enable_env_runner_and_connector_v2": true, "_prior_exploration_config": {"type": "StochasticSampling"}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7f830969eac0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "offline_data_class": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_read_batch_size": null, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "materialize_data": false, "materialize_mapped_data": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "ignore_final_observation": false, "prelearner_class": null, "prelearner_buffer_class": null, "prelearner_buffer_kwargs": {}, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_remaining_data": false, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": 1, "evaluation_duration": 20, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_auto_duration_min_env_steps_per_sample": 100, "evaluation_auto_duration_max_env_steps_per_sample": 2000, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 1, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "offline_evaluation_interval": null, "num_offline_eval_runners": 0, "offline_loss_for_module_fn": null, "offline_evaluation_duration": 1, "offline_evaluation_parallel_to_training": false, "offline_evaluation_timeout_s": 120.0, "num_cpus_per_offline_eval_runner": 1, "num_gpus_per_offline_eval_runner": 0, "custom_resources_per_offline_eval_runner": {}, "restart_failed_offline_eval_runners": true, "ignore_offline_eval_runner_failures": false, "max_num_offline_eval_runner_restarts": 1000, "offline_eval_runner_restore_timeout_s": 1800.0, "max_requests_in_flight_per_offline_eval_runner": 1, "validate_offline_eval_runners_after_construction": true, "offline_eval_runner_health_probe_timeout_s": 30.0, "offline_eval_rl_module_inference_only": false, "broadcast_offline_eval_runner_states": false, "offline_eval_batch_size_per_runner": 256, "dataset_num_iters_per_eval_runner": 1, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "log_gradients": true, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 42, "restart_failed_env_runners": true, "ignore_env_runner_failures": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30.0, "env_runner_restore_timeout_s": 1800.0, "_model_config": {}, "_rl_module_spec": "RLModuleSpec(module_class=None, observation_space=None, action_space=None, inference_only=False, learner_only=False, model_config=DefaultModelConfig(fcnet_hiddens=[127, 34], fcnet_activation='tanh', fcnet_kernel_initializer=None, fcnet_kernel_initializer_kwargs=None, fcnet_bias_initializer=None, fcnet_bias_initializer_kwargs=None, conv_filters=None, conv_activation='relu', conv_kernel_initializer=None, conv_kernel_initializer_kwargs=None, conv_bias_initializer=None, conv_bias_initializer_kwargs=None, head_fcnet_hiddens=[], head_fcnet_activation='relu', head_fcnet_kernel_initializer=None, head_fcnet_kernel_initializer_kwargs=None, head_fcnet_bias_initializer=None, head_fcnet_bias_initializer_kwargs=None, free_log_std=False, log_std_clip_param=20.0, vf_share_layers=True, use_lstm=False, max_seq_len=20, lstm_cell_size=256, lstm_use_prev_action=False, lstm_use_prev_reward=False, lstm_kernel_initializer=None, lstm_kernel_initializer_kwargs=None, lstm_bias_initializer=None, lstm_bias_initializer_kwargs=None), catalog_class=None, load_state_path=None, model_config_dict=None)", "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "_validate_config": true, "_use_msgpack_checkpoints": false, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "env_task_fn": -1, "enable_connectors": -1, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.4821924166921, "kl_target": 0.0121335369454, "vf_loss_coeff": 0.5287301420718, "entropy_coeff": 0.0304386028221, "clip_param": 0.2973082591601, "vf_clip_param": 0.1116643404955, "entropy_coeff_schedule": null, "lr_schedule": null, "sgd_minibatch_size": -1, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9313529170176, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.callbacks.callbacks.RLlibCallback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 19.92559552192688, "iterations_since_restore": 4, "perf": {"cpu_util_percent": 12.62857142857143, "ram_util_percent": 83.24285714285715}}
{"timers": {"training_iteration": 4.328636004828931, "restore_env_runners": 1.7153807190865716e-05, "training_step": 4.328383034628298, "env_runner_sampling_timer": 3.903133061933258, "learner_update_timer": 0.42185200376342724, "synch_weights": 0.0014390361317179303, "restore_eval_env_runners": 1.3398648728236365e-05, "evaluation_iteration": 0.7461885232333515, "synch_eval_env_connectors": 0.0004516423299708186, "synch_env_connectors": 9.43269797027824e-06}, "env_runners": {"module_to_env_connector": {"timers": {"connectors": {"remove_single_ts_time_rank_from_batch": 1.4228437769401654e-06, "get_actions": 0.00016271829670255994, "tensor_to_numpy": 4.9059158220992507e-05, "normalize_and_clip_actions": 2.260753665829694e-05, "un_batch_to_individual_items": 1.5132294129919776e-05, "listify_data_for_vector_env": 3.1522301057924325e-05}}, "connector_pipeline_timer": 0.00035989588267907344}, "num_env_steps_sampled_lifetime": -717500.0, "agent_episode_returns_mean": {"default_agent": 2.3000000000000007}, "episode_return_mean": 2.3000000000000007, "env_step_timer": 4.4229054013542316e-05, "num_agent_steps_sampled": {"default_agent": 5000.0}, "episode_len_min": 50, "env_to_module_connector": {"timers": {"connectors": {"add_observations_from_episodes_to_batch": 6.4735622290249284e-06, "numpy_to_tensor": 3.137410321675014e-05, "add_states_from_episodes_to_batch": 3.5113198396721963e-06, "add_time_dim_to_batch_and_zero_pad": 6.397924174239824e-06, "batch_individual_items": 1.861916893505194e-05}}, "connector_pipeline_timer": 0.00011948185169782243}, "episode_return_min": -5.5, "env_to_module_sum_episodes_length_in": 27.16809333212661, "num_episodes": 100.0, "weights_seq_no": 4.0, "episode_return_max": 14.5, "num_episodes_lifetime": -14350.0, "episode_duration_sec_mean": 0.036547267100040706, "episode_len_max": 50, "num_agent_steps_sampled_lifetime": {"default_agent": -717500.0}, "time_between_sampling": 0.012239177144284099, "num_module_steps_sampled": {"default_policy": 5000.0}, "rlmodule_inference_timer": 9.937781092674567e-05, "num_env_steps_sampled": 5000.0, "episode_len_mean": 50.0, "env_reset_timer": 9.621699049652802e-05, "num_module_steps_sampled_lifetime": {"default_policy": -717500.0}, "env_to_module_sum_episodes_length_out": 27.16809333212661, "sample": 0.037895016515310145, "module_episode_returns_mean": {"default_policy": 2.3000000000000007}, "num_env_steps_sampled_lifetime_throughput": 1277.5714613722619}, "learners": {"__all_modules__": {"learner_connector_sum_episodes_length_out": 5100.0, "learner_connector": {"connector_pipeline_timer": 0.3023483621501041, "timers": {"connectors": {"general_advantage_estimation": 0.014381816878206076, "add_time_dim_to_batch_and_zero_pad": 2.4758021750187994e-05, "batch_individual_items": 0.2079004423629092, "numpy_to_tensor": 0.00022734910027042375, "add_one_ts_to_episodes_and_truncate": 0.008728973301146933, "add_columns_from_episodes_to_train_batch": 0.06991325575930175, "add_observations_from_episodes_to_batch": 0.0007876849425396818, "add_states_from_episodes_to_batch": 6.108700753115982e-06}}}, "num_env_steps_trained": 30600, "num_env_steps_trained_lifetime": 153000, "num_module_steps_trained_lifetime": 30000, "num_trainable_parameters": 4965, "num_module_steps_trained": 6000, "num_non_trainable_parameters": 0, "learner_connector_sum_episodes_length_in": 5000.0, "num_env_steps_trained_lifetime_throughput": 885629.8009674024, "num_module_steps_trained_throughput": 174461.14141506868, "num_module_steps_trained_lifetime_throughput": 174405.66413436393}, "default_policy": {"diff_num_grad_updates_vs_sampler_policy": 1.0, "vf_explained_var": -0.10130858421325684, "curr_kl_coeff": 0.8136997818946838, "num_module_steps_trained_lifetime": 30000, "entropy": 0.6802773475646973, "num_trainable_parameters": 4965, "num_module_steps_trained": 6000, "default_optimizer_learning_rate": 0.0602050062423, "weights_seq_no": 5.0, "mean_kl_loss": 0.001112676691263914, "vf_loss": 0.10935913771390915, "vf_loss_unclipped": 33.79200744628906, "module_train_batch_size_mean": 1000.0, "curr_entropy_coeff": 0.0304386028221, "total_loss": 0.10534294694662094, "gradients_default_optimizer_global_norm": 0.1302173137664795, "policy_loss": 0.0664173886179924, "num_module_steps_trained_lifetime_throughput": 174960.79278691622}}, "num_training_step_calls_per_iteration": 1, "evaluation": {"env_runners": {"rlmodule_inference_timer": 9.695600456272067e-05, "env_to_module_sum_episodes_length_out": 27.168093332126602, "sample": 0.7342822819288336, "module_episode_returns_mean": {"default_policy": -0.3}, "episode_return_mean": -0.3, "num_agent_steps_sampled": {"default_agent": 1000}, "module_to_env_connector": {"timers": {"connectors": {"un_batch_to_individual_items": 1.5535236852950335e-05, "remove_single_ts_time_rank_from_batch": 1.46434026537136e-06, "get_actions": 0.00015735211782542415, "normalize_and_clip_actions": 2.339677876180543e-05, "tensor_to_numpy": 4.532122036312292e-05, "listify_data_for_vector_env": 3.209304982213399e-05}}, "connector_pipeline_timer": 0.0003495649991480356}, "env_step_timer": 4.22697909578445e-05, "env_to_module_connector": {"timers": {"connectors": {"add_observations_from_episodes_to_batch": 6.267474257707024e-06, "add_states_from_episodes_to_batch": 3.4880629325965347e-06, "add_time_dim_to_batch_and_zero_pad": 5.6781245990083355e-06, "batch_individual_items": 1.8754988986066338e-05, "numpy_to_tensor": 3.078181518998245e-05}}, "connector_pipeline_timer": 0.00011802443340800124}, "num_episodes": 20, "episode_return_max": 17.5, "env_reset_timer": 0.00021512920650171654, "weights_seq_no": 5.0, "episode_len_max": 50, "num_module_steps_sampled": {"default_policy": 1000}, "num_env_steps_sampled": 1000, "num_env_steps_sampled_lifetime": 26000, "agent_episode_returns_mean": {"default_agent": -0.3}, "episode_len_min": 50, "num_episodes_lifetime": 100, "episode_duration_sec_mean": 0.035492380080022486, "num_agent_steps_sampled_lifetime": {"default_agent": 5000}, "episode_len_mean": 50.0, "num_module_steps_sampled_lifetime": {"default_policy": 5000}, "episode_return_min": -16.5, "env_to_module_sum_episodes_length_in": 27.168093332126602, "time_between_sampling": 4.136543201913648}, "num_healthy_workers": 1, "actor_manager_num_outstanding_async_reqs": 0, "num_remote_worker_restarts": 0}, "num_env_steps_sampled_lifetime": -717500.0, "fault_tolerance": {"num_healthy_workers": 0, "num_remote_worker_restarts": 0}, "env_runner_group": {"actor_manager_num_outstanding_async_reqs": 0}, "done": false, "training_iteration": 5, "trial_id": "148fb_00000", "date": "2025-08-11_17-50-11", "timestamp": 1754927411, "time_this_iter_s": 4.871345043182373, "time_total_s": 24.796940565109253, "pid": 97502, "hostname": "DESKTOP-3SK5A41", "node_ip": "192.168.40.242", "config": {"exploration_config": {}, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 6, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "env": "Umbrella", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": false, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 0, "create_local_env_runner": true, "num_envs_per_env_runner": 1, "gym_env_vectorize_mode": "SYNC", "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "episodes_to_numpy": true, "max_requests_in_flight_per_env_runner": 1, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "merge_env_runner_states": "training_only", "broadcast_env_runner_states": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "complete_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "sampler_perf_stats_ema_coef": null, "_is_online": true, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": "auto", "num_aggregator_actors_per_learner": 0, "max_requests_in_flight_per_aggregator_actor": 3, "local_gpu_idx": 0, "max_requests_in_flight_per_learner": 3, "gamma": 1, "lr": 0.0602050062423, "grad_clip": 0.5, "grad_clip_by": "global_norm", "_train_batch_size_per_learner": 5000, "train_batch_size": 4000, "num_epochs": 1, "minibatch_size": 1000, "shuffle_batch_per_epoch": true, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "log_std_clip_param": 20.0, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "_disable_preprocessor_api": false, "_disable_action_flattening": false}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "_learner_class": null, "callbacks_on_algorithm_init": null, "callbacks_on_env_runners_recreated": null, "callbacks_on_offline_eval_runners_recreated": null, "callbacks_on_checkpoint_loaded": null, "callbacks_on_environment_created": null, "callbacks_on_episode_created": null, "callbacks_on_episode_start": null, "callbacks_on_episode_step": null, "callbacks_on_episode_end": null, "callbacks_on_evaluate_start": null, "callbacks_on_evaluate_end": null, "callbacks_on_evaluate_offline_start": null, "callbacks_on_evaluate_offline_end": null, "callbacks_on_sample_end": null, "callbacks_on_train_result": null, "explore": true, "enable_rl_module_and_learner": true, "enable_env_runner_and_connector_v2": true, "_prior_exploration_config": {"type": "StochasticSampling"}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7f830969eac0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "offline_data_class": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_read_batch_size": null, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "materialize_data": false, "materialize_mapped_data": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "ignore_final_observation": false, "prelearner_class": null, "prelearner_buffer_class": null, "prelearner_buffer_kwargs": {}, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_remaining_data": false, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": 1, "evaluation_duration": 20, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_auto_duration_min_env_steps_per_sample": 100, "evaluation_auto_duration_max_env_steps_per_sample": 2000, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 1, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "offline_evaluation_interval": null, "num_offline_eval_runners": 0, "offline_loss_for_module_fn": null, "offline_evaluation_duration": 1, "offline_evaluation_parallel_to_training": false, "offline_evaluation_timeout_s": 120.0, "num_cpus_per_offline_eval_runner": 1, "num_gpus_per_offline_eval_runner": 0, "custom_resources_per_offline_eval_runner": {}, "restart_failed_offline_eval_runners": true, "ignore_offline_eval_runner_failures": false, "max_num_offline_eval_runner_restarts": 1000, "offline_eval_runner_restore_timeout_s": 1800.0, "max_requests_in_flight_per_offline_eval_runner": 1, "validate_offline_eval_runners_after_construction": true, "offline_eval_runner_health_probe_timeout_s": 30.0, "offline_eval_rl_module_inference_only": false, "broadcast_offline_eval_runner_states": false, "offline_eval_batch_size_per_runner": 256, "dataset_num_iters_per_eval_runner": 1, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "log_gradients": true, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 42, "restart_failed_env_runners": true, "ignore_env_runner_failures": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30.0, "env_runner_restore_timeout_s": 1800.0, "_model_config": {}, "_rl_module_spec": "RLModuleSpec(module_class=None, observation_space=None, action_space=None, inference_only=False, learner_only=False, model_config=DefaultModelConfig(fcnet_hiddens=[127, 34], fcnet_activation='tanh', fcnet_kernel_initializer=None, fcnet_kernel_initializer_kwargs=None, fcnet_bias_initializer=None, fcnet_bias_initializer_kwargs=None, conv_filters=None, conv_activation='relu', conv_kernel_initializer=None, conv_kernel_initializer_kwargs=None, conv_bias_initializer=None, conv_bias_initializer_kwargs=None, head_fcnet_hiddens=[], head_fcnet_activation='relu', head_fcnet_kernel_initializer=None, head_fcnet_kernel_initializer_kwargs=None, head_fcnet_bias_initializer=None, head_fcnet_bias_initializer_kwargs=None, free_log_std=False, log_std_clip_param=20.0, vf_share_layers=True, use_lstm=False, max_seq_len=20, lstm_cell_size=256, lstm_use_prev_action=False, lstm_use_prev_reward=False, lstm_kernel_initializer=None, lstm_kernel_initializer_kwargs=None, lstm_bias_initializer=None, lstm_bias_initializer_kwargs=None), catalog_class=None, load_state_path=None, model_config_dict=None)", "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "_validate_config": true, "_use_msgpack_checkpoints": false, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "env_task_fn": -1, "enable_connectors": -1, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.4821924166921, "kl_target": 0.0121335369454, "vf_loss_coeff": 0.5287301420718, "entropy_coeff": 0.0304386028221, "clip_param": 0.2973082591601, "vf_clip_param": 0.1116643404955, "entropy_coeff_schedule": null, "lr_schedule": null, "sgd_minibatch_size": -1, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9313529170176, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.callbacks.callbacks.RLlibCallback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 24.796940565109253, "iterations_since_restore": 5, "perf": {"cpu_util_percent": 12.914285714285715, "ram_util_percent": 83.3}}
{"timers": {"training_iteration": 4.327846611810644, "restore_env_runners": 1.7089269124257566e-05, "training_step": 4.327592409312011, "env_runner_sampling_timer": 3.903302171343925, "learner_update_timer": 0.420888978725796, "synch_weights": 0.0014408037703992917, "restore_eval_env_runners": 1.3407662238432912e-05, "evaluation_iteration": 0.7463316710210176, "synch_eval_env_connectors": 0.0004524339066708967, "synch_env_connectors": 9.401370988256349e-06}, "env_runners": {"module_to_env_connector": {"timers": {"connectors": {"remove_single_ts_time_rank_from_batch": 1.4366411806965711e-06, "get_actions": 0.0001632189055705477, "tensor_to_numpy": 4.88743406428317e-05, "normalize_and_clip_actions": 2.273282596877503e-05, "un_batch_to_individual_items": 1.525175591238956e-05, "listify_data_for_vector_env": 3.123902541317445e-05}}, "connector_pipeline_timer": 0.0003599966813030016}, "num_env_steps_sampled_lifetime": -960000.0, "agent_episode_returns_mean": {"default_agent": 0.9000000000000005}, "episode_return_mean": 0.9000000000000005, "env_step_timer": 4.433017576576486e-05, "num_agent_steps_sampled": {"default_agent": 5000.0}, "episode_len_min": 50, "env_to_module_connector": {"timers": {"connectors": {"add_observations_from_episodes_to_batch": 6.618398076669747e-06, "numpy_to_tensor": 3.1782566918871035e-05, "add_states_from_episodes_to_batch": 3.5372712575437823e-06, "add_time_dim_to_batch_and_zero_pad": 6.496280805726832e-06, "batch_individual_items": 1.857748728471545e-05}}, "connector_pipeline_timer": 0.00012003479168965366}, "episode_return_min": -5.5, "env_to_module_sum_episodes_length_in": 27.16809333212661, "num_episodes": 100.0, "weights_seq_no": 5.0, "episode_return_max": 14.5, "num_episodes_lifetime": -19200.0, "episode_duration_sec_mean": 0.03661985903005188, "episode_len_max": 50, "num_agent_steps_sampled_lifetime": {"default_agent": -960000.0}, "time_between_sampling": 0.011734686839037434, "num_module_steps_sampled": {"default_policy": 5000.0}, "rlmodule_inference_timer": 9.983788156435216e-05, "num_env_steps_sampled": 5000.0, "episode_len_mean": 50.0, "env_reset_timer": 9.438482473072265e-05, "num_module_steps_sampled_lifetime": {"default_policy": -960000.0}, "env_to_module_sum_episodes_length_out": 27.16809333212661, "sample": 0.03768325810680404, "module_episode_returns_mean": {"default_policy": 0.9000000000000005}, "num_env_steps_sampled_lifetime_throughput": 1279.5600433605055}, "learners": {"__all_modules__": {"learner_connector_sum_episodes_length_out": 5100.0, "learner_connector": {"connector_pipeline_timer": 0.3022676825285978, "timers": {"connectors": {"general_advantage_estimation": 0.014325863709419887, "add_time_dim_to_batch_and_zero_pad": 2.473944153017527e-05, "batch_individual_items": 0.2078745589392791, "numpy_to_tensor": 0.00022677360927320954, "add_one_ts_to_episodes_and_truncate": 0.0087271915681374, "add_columns_from_episodes_to_train_batch": 0.06991803120171369, "add_observations_from_episodes_to_batch": 0.0007868640931092031, "add_states_from_episodes_to_batch": 6.103613744533941e-06}}}, "num_env_steps_trained": 30600, "num_env_steps_trained_lifetime": 183600, "num_module_steps_trained_lifetime": 36000, "num_trainable_parameters": 4965, "num_module_steps_trained": 6000, "num_non_trainable_parameters": 0, "learner_connector_sum_episodes_length_in": 5000.0, "num_env_steps_trained_lifetime_throughput": 885623.1113648212, "num_module_steps_trained_throughput": 174431.85332008527, "num_module_steps_trained_lifetime_throughput": 174375.8051165121}, "default_policy": {"diff_num_grad_updates_vs_sampler_policy": 1.0, "vf_explained_var": -0.07106590270996094, "curr_kl_coeff": 0.4068498909473419, "num_module_steps_trained_lifetime": 36000, "entropy": 0.6250910758972168, "num_trainable_parameters": 4965, "num_module_steps_trained": 6000, "default_optimizer_learning_rate": 0.0602050062423, "weights_seq_no": 6.0, "mean_kl_loss": 0.0009890745859593153, "vf_loss": 0.10259535163640976, "vf_loss_unclipped": 34.63297653198242, "module_train_batch_size_mean": 1000.0, "curr_entropy_coeff": 0.0304386028221, "total_loss": 0.07795513421297073, "gradients_default_optimizer_global_norm": 0.05252712592482567, "policy_loss": 0.04193194955587387, "num_module_steps_trained_lifetime_throughput": 174900.1582489003}}, "num_training_step_calls_per_iteration": 1, "evaluation": {"env_runners": {"rlmodule_inference_timer": 9.541216056719427e-05, "env_to_module_sum_episodes_length_out": 27.168093332126602, "sample": 0.734304200119551, "module_episode_returns_mean": {"default_policy": 0.1}, "episode_return_mean": 0.1, "num_agent_steps_sampled": {"default_agent": 1000}, "module_to_env_connector": {"timers": {"connectors": {"un_batch_to_individual_items": 1.573146722543263e-05, "remove_single_ts_time_rank_from_batch": 1.680275904557087e-06, "get_actions": 0.000154180372451852, "normalize_and_clip_actions": 2.2481797925758853e-05, "tensor_to_numpy": 4.4559495730526654e-05, "listify_data_for_vector_env": 3.0703993695347504e-05}}, "connector_pipeline_timer": 0.0003432356098364471}, "env_step_timer": 4.203054882242014e-05, "env_to_module_connector": {"timers": {"connectors": {"add_observations_from_episodes_to_batch": 6.156487194804102e-06, "add_states_from_episodes_to_batch": 3.4559170616452208e-06, "add_time_dim_to_batch_and_zero_pad": 5.519804989414888e-06, "batch_individual_items": 1.797063625623252e-05, "numpy_to_tensor": 2.992098684607604e-05}}, "connector_pipeline_timer": 0.0001140543621242421}, "num_episodes": 20, "episode_return_max": 17.5, "env_reset_timer": 0.00021422191443219433, "weights_seq_no": 6.0, "episode_len_max": 50, "num_module_steps_sampled": {"default_policy": 1000}, "num_env_steps_sampled": 1000, "num_env_steps_sampled_lifetime": 31000, "agent_episode_returns_mean": {"default_agent": 0.1}, "episode_len_min": 50, "num_episodes_lifetime": 120, "episode_duration_sec_mean": 0.03551495108001291, "num_agent_steps_sampled_lifetime": {"default_agent": 6000}, "episode_len_mean": 50.0, "num_module_steps_sampled_lifetime": {"default_policy": 6000}, "episode_return_min": -16.5, "env_to_module_sum_episodes_length_in": 27.168093332126602, "time_between_sampling": 4.138211401924512}, "num_healthy_workers": 1, "actor_manager_num_outstanding_async_reqs": 0, "num_remote_worker_restarts": 0}, "num_env_steps_sampled_lifetime": -960000.0, "fault_tolerance": {"num_healthy_workers": 0, "num_remote_worker_restarts": 0}, "env_runner_group": {"actor_manager_num_outstanding_async_reqs": 0}, "done": false, "training_iteration": 6, "trial_id": "148fb_00000", "date": "2025-08-11_17-50-16", "timestamp": 1754927416, "time_this_iter_s": 5.000103950500488, "time_total_s": 29.79704451560974, "pid": 97502, "hostname": "DESKTOP-3SK5A41", "node_ip": "192.168.40.242", "config": {"exploration_config": {}, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 6, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "env": "Umbrella", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": false, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 0, "create_local_env_runner": true, "num_envs_per_env_runner": 1, "gym_env_vectorize_mode": "SYNC", "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "episodes_to_numpy": true, "max_requests_in_flight_per_env_runner": 1, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "merge_env_runner_states": "training_only", "broadcast_env_runner_states": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "complete_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "sampler_perf_stats_ema_coef": null, "_is_online": true, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": "auto", "num_aggregator_actors_per_learner": 0, "max_requests_in_flight_per_aggregator_actor": 3, "local_gpu_idx": 0, "max_requests_in_flight_per_learner": 3, "gamma": 1, "lr": 0.0602050062423, "grad_clip": 0.5, "grad_clip_by": "global_norm", "_train_batch_size_per_learner": 5000, "train_batch_size": 4000, "num_epochs": 1, "minibatch_size": 1000, "shuffle_batch_per_epoch": true, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "log_std_clip_param": 20.0, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "_disable_preprocessor_api": false, "_disable_action_flattening": false}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "_learner_class": null, "callbacks_on_algorithm_init": null, "callbacks_on_env_runners_recreated": null, "callbacks_on_offline_eval_runners_recreated": null, "callbacks_on_checkpoint_loaded": null, "callbacks_on_environment_created": null, "callbacks_on_episode_created": null, "callbacks_on_episode_start": null, "callbacks_on_episode_step": null, "callbacks_on_episode_end": null, "callbacks_on_evaluate_start": null, "callbacks_on_evaluate_end": null, "callbacks_on_evaluate_offline_start": null, "callbacks_on_evaluate_offline_end": null, "callbacks_on_sample_end": null, "callbacks_on_train_result": null, "explore": true, "enable_rl_module_and_learner": true, "enable_env_runner_and_connector_v2": true, "_prior_exploration_config": {"type": "StochasticSampling"}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7f830969eac0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "offline_data_class": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_read_batch_size": null, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "materialize_data": false, "materialize_mapped_data": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "ignore_final_observation": false, "prelearner_class": null, "prelearner_buffer_class": null, "prelearner_buffer_kwargs": {}, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_remaining_data": false, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": 1, "evaluation_duration": 20, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_auto_duration_min_env_steps_per_sample": 100, "evaluation_auto_duration_max_env_steps_per_sample": 2000, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 1, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "offline_evaluation_interval": null, "num_offline_eval_runners": 0, "offline_loss_for_module_fn": null, "offline_evaluation_duration": 1, "offline_evaluation_parallel_to_training": false, "offline_evaluation_timeout_s": 120.0, "num_cpus_per_offline_eval_runner": 1, "num_gpus_per_offline_eval_runner": 0, "custom_resources_per_offline_eval_runner": {}, "restart_failed_offline_eval_runners": true, "ignore_offline_eval_runner_failures": false, "max_num_offline_eval_runner_restarts": 1000, "offline_eval_runner_restore_timeout_s": 1800.0, "max_requests_in_flight_per_offline_eval_runner": 1, "validate_offline_eval_runners_after_construction": true, "offline_eval_runner_health_probe_timeout_s": 30.0, "offline_eval_rl_module_inference_only": false, "broadcast_offline_eval_runner_states": false, "offline_eval_batch_size_per_runner": 256, "dataset_num_iters_per_eval_runner": 1, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "log_gradients": true, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 42, "restart_failed_env_runners": true, "ignore_env_runner_failures": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30.0, "env_runner_restore_timeout_s": 1800.0, "_model_config": {}, "_rl_module_spec": "RLModuleSpec(module_class=None, observation_space=None, action_space=None, inference_only=False, learner_only=False, model_config=DefaultModelConfig(fcnet_hiddens=[127, 34], fcnet_activation='tanh', fcnet_kernel_initializer=None, fcnet_kernel_initializer_kwargs=None, fcnet_bias_initializer=None, fcnet_bias_initializer_kwargs=None, conv_filters=None, conv_activation='relu', conv_kernel_initializer=None, conv_kernel_initializer_kwargs=None, conv_bias_initializer=None, conv_bias_initializer_kwargs=None, head_fcnet_hiddens=[], head_fcnet_activation='relu', head_fcnet_kernel_initializer=None, head_fcnet_kernel_initializer_kwargs=None, head_fcnet_bias_initializer=None, head_fcnet_bias_initializer_kwargs=None, free_log_std=False, log_std_clip_param=20.0, vf_share_layers=True, use_lstm=False, max_seq_len=20, lstm_cell_size=256, lstm_use_prev_action=False, lstm_use_prev_reward=False, lstm_kernel_initializer=None, lstm_kernel_initializer_kwargs=None, lstm_bias_initializer=None, lstm_bias_initializer_kwargs=None), catalog_class=None, load_state_path=None, model_config_dict=None)", "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "_validate_config": true, "_use_msgpack_checkpoints": false, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "env_task_fn": -1, "enable_connectors": -1, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.4821924166921, "kl_target": 0.0121335369454, "vf_loss_coeff": 0.5287301420718, "entropy_coeff": 0.0304386028221, "clip_param": 0.2973082591601, "vf_clip_param": 0.1116643404955, "entropy_coeff_schedule": null, "lr_schedule": null, "sgd_minibatch_size": -1, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9313529170176, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.callbacks.callbacks.RLlibCallback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 29.79704451560974, "iterations_since_restore": 6, "perf": {"cpu_util_percent": 12.685714285714287, "ram_util_percent": 83.3}}
{"timers": {"training_iteration": 4.325252316722535, "restore_env_runners": 1.7038376437259492e-05, "training_step": 4.324997057248887, "env_runner_sampling_timer": 3.903110189660487, "learner_update_timer": 0.41848377593853947, "synch_weights": 0.0014398407326994384, "restore_eval_env_runners": 1.3367585613310144e-05, "evaluation_iteration": 0.7463315743208024, "synch_eval_env_connectors": 0.00045163156760547713, "synch_env_connectors": 9.370357276054677e-06}, "env_runners": {"module_to_env_connector": {"timers": {"connectors": {"remove_single_ts_time_rank_from_batch": 1.3988619105469423e-06, "get_actions": 0.00016202123275747775, "tensor_to_numpy": 4.842701173250485e-05, "normalize_and_clip_actions": 2.2333340577191914e-05, "un_batch_to_individual_items": 1.510916078413965e-05, "listify_data_for_vector_env": 3.114226183749211e-05}}, "connector_pipeline_timer": 0.00035720171173525794}, "num_env_steps_sampled_lifetime": -1202500.0, "agent_episode_returns_mean": {"default_agent": -0.09999999999999998}, "episode_return_mean": -0.09999999999999998, "env_step_timer": 4.404375555380805e-05, "num_agent_steps_sampled": {"default_agent": 5000.0}, "episode_len_min": 50, "env_to_module_connector": {"timers": {"connectors": {"add_observations_from_episodes_to_batch": 6.5476311170591076e-06, "numpy_to_tensor": 3.1206253042251844e-05, "add_states_from_episodes_to_batch": 3.4884735517873375e-06, "add_time_dim_to_batch_and_zero_pad": 6.431947322119915e-06, "batch_individual_items": 1.8528179037785444e-05}}, "connector_pipeline_timer": 0.00011883000624966323}, "episode_return_min": -5.5, "env_to_module_sum_episodes_length_in": 27.16809333212661, "num_episodes": 100.0, "weights_seq_no": 6.0, "episode_return_max": 14.5, "num_episodes_lifetime": -24050.0, "episode_duration_sec_mean": 0.036270659029942184, "episode_len_max": 50, "num_agent_steps_sampled_lifetime": {"default_agent": -1202500.0}, "time_between_sampling": 0.012331293918932456, "num_module_steps_sampled": {"default_policy": 5000.0}, "rlmodule_inference_timer": 9.858130266407932e-05, "num_env_steps_sampled": 5000.0, "episode_len_mean": 50.0, "env_reset_timer": 9.47193645839464e-05, "num_module_steps_sampled_lifetime": {"default_policy": -1202500.0}, "env_to_module_sum_episodes_length_out": 27.16809333212661, "sample": 0.03762533978458389, "module_episode_returns_mean": {"default_policy": -0.09999999999999998}, "num_env_steps_sampled_lifetime_throughput": 1283.7464961364963}, "learners": {"__all_modules__": {"learner_connector_sum_episodes_length_out": 5100.0, "learner_connector": {"connector_pipeline_timer": 0.3007010677033093, "timers": {"connectors": {"general_advantage_estimation": 0.014271325072329066, "add_time_dim_to_batch_and_zero_pad": 2.469604712208917e-05, "batch_individual_items": 0.20638054134988976, "numpy_to_tensor": 0.00022622687318829684, "add_one_ts_to_episodes_and_truncate": 0.008723512652455408, "add_columns_from_episodes_to_train_batch": 0.06990508588969031, "add_observations_from_episodes_to_batch": 0.000786837452182641, "add_states_from_episodes_to_batch": 6.091577607305949e-06}}}, "num_env_steps_trained": 30600, "num_env_steps_trained_lifetime": 214200, "num_module_steps_trained_lifetime": 42000, "num_trainable_parameters": 4965, "num_module_steps_trained": 6000, "num_non_trainable_parameters": 0, "learner_connector_sum_episodes_length_in": 5000.0, "num_env_steps_trained_lifetime_throughput": 884658.7314587309, "num_module_steps_trained_throughput": 174216.82267604148, "num_module_steps_trained_lifetime_throughput": 174160.21333069654}, "default_policy": {"diff_num_grad_updates_vs_sampler_policy": 1.0, "vf_explained_var": -0.05752384662628174, "curr_kl_coeff": 0.4068498909473419, "num_module_steps_trained_lifetime": 42000, "entropy": 0.6371734738349915, "num_trainable_parameters": 4965, "num_module_steps_trained": 6000, "default_optimizer_learning_rate": 0.0602050062423, "weights_seq_no": 7.0, "mean_kl_loss": 0.02057472988963127, "vf_loss": 0.10700894892215729, "vf_loss_unclipped": 45.545291900634766, "module_train_batch_size_mean": 1000.0, "curr_entropy_coeff": 0.0304386028221, "total_loss": -0.022097695618867874, "gradients_default_optimizer_global_norm": 0.703583836555481, "policy_loss": -0.06765271723270416, "num_module_steps_trained_lifetime_throughput": 174653.47969625393}}, "num_training_step_calls_per_iteration": 1, "evaluation": {"env_runners": {"rlmodule_inference_timer": 9.615862744987116e-05, "env_to_module_sum_episodes_length_out": 27.168093332126602, "sample": 0.7343832951183586, "module_episode_returns_mean": {"default_policy": 0.9}, "episode_return_mean": 0.9, "num_agent_steps_sampled": {"default_agent": 1000}, "module_to_env_connector": {"timers": {"connectors": {"un_batch_to_individual_items": 1.5338968956671675e-05, "remove_single_ts_time_rank_from_batch": 1.4684830667043068e-06, "get_actions": 0.00015820065600445814, "normalize_and_clip_actions": 2.323172191444568e-05, "tensor_to_numpy": 4.541960855339545e-05, "listify_data_for_vector_env": 3.1392971600870377e-05}}, "connector_pipeline_timer": 0.00034985334527576285}, "env_step_timer": 4.2392884362389035e-05, "env_to_module_connector": {"timers": {"connectors": {"add_observations_from_episodes_to_batch": 6.330826812030933e-06, "add_states_from_episodes_to_batch": 3.6097520080504744e-06, "add_time_dim_to_batch_and_zero_pad": 5.5819136701120105e-06, "batch_individual_items": 1.8592867519384414e-05, "numpy_to_tensor": 3.0318999028442634e-05}}, "connector_pipeline_timer": 0.00011640863535875282}, "num_episodes": 20, "episode_return_max": 17.5, "env_reset_timer": 0.00021337769528527738, "weights_seq_no": 7.0, "episode_len_max": 50, "num_module_steps_sampled": {"default_policy": 1000}, "num_env_steps_sampled": 1000, "num_env_steps_sampled_lifetime": 36000, "agent_episode_returns_mean": {"default_agent": 0.9}, "episode_len_min": 50, "num_episodes_lifetime": 140, "episode_duration_sec_mean": 0.03560343206002472, "num_agent_steps_sampled_lifetime": {"default_agent": 7000}, "episode_len_mean": 50.0, "num_module_steps_sampled_lifetime": {"default_policy": 7000}, "episode_return_min": -16.5, "env_to_module_sum_episodes_length_in": 27.168093332126602, "time_between_sampling": 4.138055277935274}, "num_healthy_workers": 1, "actor_manager_num_outstanding_async_reqs": 0, "num_remote_worker_restarts": 0}, "num_env_steps_sampled_lifetime": -1202500.0, "fault_tolerance": {"num_healthy_workers": 0, "num_remote_worker_restarts": 0}, "env_runner_group": {"actor_manager_num_outstanding_async_reqs": 0}, "done": false, "training_iteration": 7, "trial_id": "148fb_00000", "date": "2025-08-11_17-50-21", "timestamp": 1754927421, "time_this_iter_s": 4.8255615234375, "time_total_s": 34.62260603904724, "pid": 97502, "hostname": "DESKTOP-3SK5A41", "node_ip": "192.168.40.242", "config": {"exploration_config": {}, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 6, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "env": "Umbrella", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": false, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 0, "create_local_env_runner": true, "num_envs_per_env_runner": 1, "gym_env_vectorize_mode": "SYNC", "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "episodes_to_numpy": true, "max_requests_in_flight_per_env_runner": 1, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "merge_env_runner_states": "training_only", "broadcast_env_runner_states": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "complete_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "sampler_perf_stats_ema_coef": null, "_is_online": true, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": "auto", "num_aggregator_actors_per_learner": 0, "max_requests_in_flight_per_aggregator_actor": 3, "local_gpu_idx": 0, "max_requests_in_flight_per_learner": 3, "gamma": 1, "lr": 0.0602050062423, "grad_clip": 0.5, "grad_clip_by": "global_norm", "_train_batch_size_per_learner": 5000, "train_batch_size": 4000, "num_epochs": 1, "minibatch_size": 1000, "shuffle_batch_per_epoch": true, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "log_std_clip_param": 20.0, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "_disable_preprocessor_api": false, "_disable_action_flattening": false}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "_learner_class": null, "callbacks_on_algorithm_init": null, "callbacks_on_env_runners_recreated": null, "callbacks_on_offline_eval_runners_recreated": null, "callbacks_on_checkpoint_loaded": null, "callbacks_on_environment_created": null, "callbacks_on_episode_created": null, "callbacks_on_episode_start": null, "callbacks_on_episode_step": null, "callbacks_on_episode_end": null, "callbacks_on_evaluate_start": null, "callbacks_on_evaluate_end": null, "callbacks_on_evaluate_offline_start": null, "callbacks_on_evaluate_offline_end": null, "callbacks_on_sample_end": null, "callbacks_on_train_result": null, "explore": true, "enable_rl_module_and_learner": true, "enable_env_runner_and_connector_v2": true, "_prior_exploration_config": {"type": "StochasticSampling"}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7f830969eac0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "offline_data_class": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_read_batch_size": null, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "materialize_data": false, "materialize_mapped_data": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "ignore_final_observation": false, "prelearner_class": null, "prelearner_buffer_class": null, "prelearner_buffer_kwargs": {}, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_remaining_data": false, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": 1, "evaluation_duration": 20, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_auto_duration_min_env_steps_per_sample": 100, "evaluation_auto_duration_max_env_steps_per_sample": 2000, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 1, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "offline_evaluation_interval": null, "num_offline_eval_runners": 0, "offline_loss_for_module_fn": null, "offline_evaluation_duration": 1, "offline_evaluation_parallel_to_training": false, "offline_evaluation_timeout_s": 120.0, "num_cpus_per_offline_eval_runner": 1, "num_gpus_per_offline_eval_runner": 0, "custom_resources_per_offline_eval_runner": {}, "restart_failed_offline_eval_runners": true, "ignore_offline_eval_runner_failures": false, "max_num_offline_eval_runner_restarts": 1000, "offline_eval_runner_restore_timeout_s": 1800.0, "max_requests_in_flight_per_offline_eval_runner": 1, "validate_offline_eval_runners_after_construction": true, "offline_eval_runner_health_probe_timeout_s": 30.0, "offline_eval_rl_module_inference_only": false, "broadcast_offline_eval_runner_states": false, "offline_eval_batch_size_per_runner": 256, "dataset_num_iters_per_eval_runner": 1, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "log_gradients": true, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 42, "restart_failed_env_runners": true, "ignore_env_runner_failures": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30.0, "env_runner_restore_timeout_s": 1800.0, "_model_config": {}, "_rl_module_spec": "RLModuleSpec(module_class=None, observation_space=None, action_space=None, inference_only=False, learner_only=False, model_config=DefaultModelConfig(fcnet_hiddens=[127, 34], fcnet_activation='tanh', fcnet_kernel_initializer=None, fcnet_kernel_initializer_kwargs=None, fcnet_bias_initializer=None, fcnet_bias_initializer_kwargs=None, conv_filters=None, conv_activation='relu', conv_kernel_initializer=None, conv_kernel_initializer_kwargs=None, conv_bias_initializer=None, conv_bias_initializer_kwargs=None, head_fcnet_hiddens=[], head_fcnet_activation='relu', head_fcnet_kernel_initializer=None, head_fcnet_kernel_initializer_kwargs=None, head_fcnet_bias_initializer=None, head_fcnet_bias_initializer_kwargs=None, free_log_std=False, log_std_clip_param=20.0, vf_share_layers=True, use_lstm=False, max_seq_len=20, lstm_cell_size=256, lstm_use_prev_action=False, lstm_use_prev_reward=False, lstm_kernel_initializer=None, lstm_kernel_initializer_kwargs=None, lstm_bias_initializer=None, lstm_bias_initializer_kwargs=None), catalog_class=None, load_state_path=None, model_config_dict=None)", "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "_validate_config": true, "_use_msgpack_checkpoints": false, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "env_task_fn": -1, "enable_connectors": -1, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.4821924166921, "kl_target": 0.0121335369454, "vf_loss_coeff": 0.5287301420718, "entropy_coeff": 0.0304386028221, "clip_param": 0.2973082591601, "vf_clip_param": 0.1116643404955, "entropy_coeff_schedule": null, "lr_schedule": null, "sgd_minibatch_size": -1, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9313529170176, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.callbacks.callbacks.RLlibCallback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 34.62260603904724, "iterations_since_restore": 7, "perf": {"cpu_util_percent": 12.3, "ram_util_percent": 83.3}}
{"timers": {"training_iteration": 4.324150846585312, "restore_env_runners": 1.697399267057291e-05, "training_step": 4.323894427706394, "env_runner_sampling_timer": 3.9029693697938885, "learner_update_timer": 0.41752006617914966, "synch_weights": 0.0014390633253706824, "restore_eval_env_runners": 1.3342909759516641e-05, "evaluation_iteration": 0.7463889975775958, "synch_eval_env_connectors": 0.00045093425192353195, "synch_env_connectors": 9.342653705628606e-06}, "env_runners": {"module_to_env_connector": {"timers": {"connectors": {"remove_single_ts_time_rank_from_batch": 1.4293560415430427e-06, "get_actions": 0.00016153168702166303, "tensor_to_numpy": 4.847189233779332e-05, "normalize_and_clip_actions": 2.243718427699289e-05, "un_batch_to_individual_items": 1.5102829768638406e-05, "listify_data_for_vector_env": 3.105360106602372e-05}}, "connector_pipeline_timer": 0.0003569265014835238}, "num_env_steps_sampled_lifetime": -1445000.0, "agent_episode_returns_mean": {"default_agent": -0.09999999999999998}, "episode_return_mean": -0.09999999999999998, "env_step_timer": 4.38641857067857e-05, "num_agent_steps_sampled": {"default_agent": 5000.0}, "episode_len_min": 50, "env_to_module_connector": {"timers": {"connectors": {"add_observations_from_episodes_to_batch": 6.421208778409319e-06, "numpy_to_tensor": 3.1175973861713926e-05, "add_states_from_episodes_to_batch": 3.4651182838282606e-06, "add_time_dim_to_batch_and_zero_pad": 6.406916708470026e-06, "batch_individual_items": 1.8534725714949847e-05}}, "connector_pipeline_timer": 0.00011920023831677765}, "episode_return_min": -5.5, "env_to_module_sum_episodes_length_in": 27.16809333212661, "num_episodes": 100.0, "weights_seq_no": 7.0, "episode_return_max": 14.5, "num_episodes_lifetime": -28900.0, "episode_duration_sec_mean": 0.03631435101998248, "episode_len_max": 50, "num_agent_steps_sampled_lifetime": {"default_agent": -1445000.0}, "time_between_sampling": 0.011679524006120563, "num_module_steps_sampled": {"default_policy": 5000.0}, "rlmodule_inference_timer": 9.911188216964681e-05, "num_env_steps_sampled": 5000.0, "episode_len_mean": 50.0, "env_reset_timer": 9.392982978453975e-05, "num_module_steps_sampled_lifetime": {"default_policy": -1445000.0}, "env_to_module_sum_episodes_length_out": 27.16809333212661, "sample": 0.0374574801672719, "module_episode_returns_mean": {"default_policy": -0.09999999999999998}, "num_env_steps_sampled_lifetime_throughput": 1285.914700082001}, "learners": {"__all_modules__": {"learner_connector_sum_episodes_length_out": 5100.0, "learner_connector": {"connector_pipeline_timer": 0.3005773020262698, "timers": {"connectors": {"general_advantage_estimation": 0.014217335821603231, "add_time_dim_to_batch_and_zero_pad": 2.466508664941344e-05, "batch_individual_items": 0.20632995593638975, "numpy_to_tensor": 0.00022564260445513318, "add_one_ts_to_episodes_and_truncate": 0.008719269525928684, "add_columns_from_episodes_to_train_batch": 0.06989235403079014, "add_observations_from_episodes_to_batch": 0.0007861490776631505, "add_states_from_episodes_to_batch": 6.08366183462337e-06}}}, "num_env_steps_trained": 30600, "num_env_steps_trained_lifetime": 244800, "num_module_steps_trained_lifetime": 48000, "num_trainable_parameters": 4965, "num_module_steps_trained": 6000, "num_non_trainable_parameters": 0, "learner_connector_sum_episodes_length_in": 5000.0, "num_env_steps_trained_lifetime_throughput": 883348.9129925204, "num_module_steps_trained_throughput": 173936.0336565231, "num_module_steps_trained_lifetime_throughput": 173878.01400270092}, "default_policy": {"diff_num_grad_updates_vs_sampler_policy": 1.0, "vf_explained_var": -0.005691409111022949, "curr_kl_coeff": 0.4068498909473419, "num_module_steps_trained_lifetime": 48000, "entropy": 0.6178569793701172, "num_trainable_parameters": 4965, "num_module_steps_trained": 6000, "default_optimizer_learning_rate": 0.0602050062423, "weights_seq_no": 8.0, "mean_kl_loss": 0.012683908455073833, "vf_loss": 0.10158705711364746, "vf_loss_unclipped": 45.89552688598633, "module_train_batch_size_mean": 1000.0, "curr_entropy_coeff": 0.0304386028221, "total_loss": -0.0023235799744725227, "gradients_default_optimizer_global_norm": 0.41075146198272705, "policy_loss": -0.04238947480916977, "num_module_steps_trained_lifetime_throughput": 174338.66311120082}}, "num_training_step_calls_per_iteration": 1, "evaluation": {"env_runners": {"rlmodule_inference_timer": 9.722241717672639e-05, "env_to_module_sum_episodes_length_out": 27.168093332126602, "sample": 0.7343716031671813, "module_episode_returns_mean": {"default_policy": 1.1}, "episode_return_mean": 1.1, "num_agent_steps_sampled": {"default_agent": 1000}, "module_to_env_connector": {"timers": {"connectors": {"un_batch_to_individual_items": 1.5807026760558175e-05, "remove_single_ts_time_rank_from_batch": 1.4799797517906129e-06, "get_actions": 0.00015546244341228167, "normalize_and_clip_actions": 2.2797472337119167e-05, "tensor_to_numpy": 4.580493504140772e-05, "listify_data_for_vector_env": 3.091470989378398e-05}}, "connector_pipeline_timer": 0.0003466494686665315}, "env_step_timer": 4.2496246030846596e-05, "env_to_module_connector": {"timers": {"connectors": {"add_observations_from_episodes_to_batch": 6.287756556702209e-06, "add_states_from_episodes_to_batch": 3.3231085641802543e-06, "add_time_dim_to_batch_and_zero_pad": 5.671863952771043e-06, "batch_individual_items": 1.8324308616433705e-05, "numpy_to_tensor": 3.0346221571862417e-05}}, "connector_pipeline_timer": 0.00011535990414698362}, "num_episodes": 20, "episode_return_max": 17.5, "env_reset_timer": 0.00021249391832813179, "weights_seq_no": 8.0, "episode_len_max": 50, "num_module_steps_sampled": {"default_policy": 1000}, "num_env_steps_sampled": 1000, "num_env_steps_sampled_lifetime": 41000, "agent_episode_returns_mean": {"default_agent": 1.1}, "episode_len_min": 50, "num_episodes_lifetime": 160, "episode_duration_sec_mean": 0.03559494005001398, "num_agent_steps_sampled_lifetime": {"default_agent": 8000}, "episode_len_mean": 50.0, "num_module_steps_sampled_lifetime": {"default_policy": 8000}, "episode_return_min": -16.5, "env_to_module_sum_episodes_length_in": 27.168093332126602, "time_between_sampling": 4.139372818185924}, "num_healthy_workers": 1, "actor_manager_num_outstanding_async_reqs": 0, "num_remote_worker_restarts": 0}, "num_env_steps_sampled_lifetime": -1445000.0, "fault_tolerance": {"num_healthy_workers": 0, "num_remote_worker_restarts": 0}, "env_runner_group": {"actor_manager_num_outstanding_async_reqs": 0}, "done": false, "training_iteration": 8, "trial_id": "148fb_00000", "date": "2025-08-11_17-50-26", "timestamp": 1754927426, "time_this_iter_s": 4.963308334350586, "time_total_s": 39.58591437339783, "pid": 97502, "hostname": "DESKTOP-3SK5A41", "node_ip": "192.168.40.242", "config": {"exploration_config": {}, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 6, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "env": "Umbrella", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": false, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 0, "create_local_env_runner": true, "num_envs_per_env_runner": 1, "gym_env_vectorize_mode": "SYNC", "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "episodes_to_numpy": true, "max_requests_in_flight_per_env_runner": 1, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "merge_env_runner_states": "training_only", "broadcast_env_runner_states": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "complete_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "sampler_perf_stats_ema_coef": null, "_is_online": true, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": "auto", "num_aggregator_actors_per_learner": 0, "max_requests_in_flight_per_aggregator_actor": 3, "local_gpu_idx": 0, "max_requests_in_flight_per_learner": 3, "gamma": 1, "lr": 0.0602050062423, "grad_clip": 0.5, "grad_clip_by": "global_norm", "_train_batch_size_per_learner": 5000, "train_batch_size": 4000, "num_epochs": 1, "minibatch_size": 1000, "shuffle_batch_per_epoch": true, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "log_std_clip_param": 20.0, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "_disable_preprocessor_api": false, "_disable_action_flattening": false}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "_learner_class": null, "callbacks_on_algorithm_init": null, "callbacks_on_env_runners_recreated": null, "callbacks_on_offline_eval_runners_recreated": null, "callbacks_on_checkpoint_loaded": null, "callbacks_on_environment_created": null, "callbacks_on_episode_created": null, "callbacks_on_episode_start": null, "callbacks_on_episode_step": null, "callbacks_on_episode_end": null, "callbacks_on_evaluate_start": null, "callbacks_on_evaluate_end": null, "callbacks_on_evaluate_offline_start": null, "callbacks_on_evaluate_offline_end": null, "callbacks_on_sample_end": null, "callbacks_on_train_result": null, "explore": true, "enable_rl_module_and_learner": true, "enable_env_runner_and_connector_v2": true, "_prior_exploration_config": {"type": "StochasticSampling"}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7f830969eac0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "offline_data_class": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_read_batch_size": null, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "materialize_data": false, "materialize_mapped_data": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "ignore_final_observation": false, "prelearner_class": null, "prelearner_buffer_class": null, "prelearner_buffer_kwargs": {}, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_remaining_data": false, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": 1, "evaluation_duration": 20, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_auto_duration_min_env_steps_per_sample": 100, "evaluation_auto_duration_max_env_steps_per_sample": 2000, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 1, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "offline_evaluation_interval": null, "num_offline_eval_runners": 0, "offline_loss_for_module_fn": null, "offline_evaluation_duration": 1, "offline_evaluation_parallel_to_training": false, "offline_evaluation_timeout_s": 120.0, "num_cpus_per_offline_eval_runner": 1, "num_gpus_per_offline_eval_runner": 0, "custom_resources_per_offline_eval_runner": {}, "restart_failed_offline_eval_runners": true, "ignore_offline_eval_runner_failures": false, "max_num_offline_eval_runner_restarts": 1000, "offline_eval_runner_restore_timeout_s": 1800.0, "max_requests_in_flight_per_offline_eval_runner": 1, "validate_offline_eval_runners_after_construction": true, "offline_eval_runner_health_probe_timeout_s": 30.0, "offline_eval_rl_module_inference_only": false, "broadcast_offline_eval_runner_states": false, "offline_eval_batch_size_per_runner": 256, "dataset_num_iters_per_eval_runner": 1, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "log_gradients": true, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 42, "restart_failed_env_runners": true, "ignore_env_runner_failures": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30.0, "env_runner_restore_timeout_s": 1800.0, "_model_config": {}, "_rl_module_spec": "RLModuleSpec(module_class=None, observation_space=None, action_space=None, inference_only=False, learner_only=False, model_config=DefaultModelConfig(fcnet_hiddens=[127, 34], fcnet_activation='tanh', fcnet_kernel_initializer=None, fcnet_kernel_initializer_kwargs=None, fcnet_bias_initializer=None, fcnet_bias_initializer_kwargs=None, conv_filters=None, conv_activation='relu', conv_kernel_initializer=None, conv_kernel_initializer_kwargs=None, conv_bias_initializer=None, conv_bias_initializer_kwargs=None, head_fcnet_hiddens=[], head_fcnet_activation='relu', head_fcnet_kernel_initializer=None, head_fcnet_kernel_initializer_kwargs=None, head_fcnet_bias_initializer=None, head_fcnet_bias_initializer_kwargs=None, free_log_std=False, log_std_clip_param=20.0, vf_share_layers=True, use_lstm=False, max_seq_len=20, lstm_cell_size=256, lstm_use_prev_action=False, lstm_use_prev_reward=False, lstm_kernel_initializer=None, lstm_kernel_initializer_kwargs=None, lstm_bias_initializer=None, lstm_bias_initializer_kwargs=None), catalog_class=None, load_state_path=None, model_config_dict=None)", "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "_validate_config": true, "_use_msgpack_checkpoints": false, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "env_task_fn": -1, "enable_connectors": -1, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.4821924166921, "kl_target": 0.0121335369454, "vf_loss_coeff": 0.5287301420718, "entropy_coeff": 0.0304386028221, "clip_param": 0.2973082591601, "vf_clip_param": 0.1116643404955, "entropy_coeff_schedule": null, "lr_schedule": null, "sgd_minibatch_size": -1, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9313529170176, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.callbacks.callbacks.RLlibCallback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 39.58591437339783, "iterations_since_restore": 8, "perf": {"cpu_util_percent": 12.357142857142858, "ram_util_percent": 83.3}}
{"timers": {"training_iteration": 4.321792893169453, "restore_env_runners": 1.6921252743458096e-05, "training_step": 4.32153545347933, "env_runner_sampling_timer": 3.9029603751359425, "learner_update_timer": 0.4151691715273612, "synch_weights": 0.0014377006921109132, "restore_eval_env_runners": 1.3315480659607487e-05, "evaluation_iteration": 0.746357943601818, "synch_eval_env_connectors": 0.00045062890940141323, "synch_env_connectors": 9.329227168370339e-06}, "env_runners": {"module_to_env_connector": {"timers": {"connectors": {"remove_single_ts_time_rank_from_batch": 1.4187691621031267e-06, "get_actions": 0.00016248089241987284, "tensor_to_numpy": 4.8781256326465884e-05, "normalize_and_clip_actions": 2.2563032426990462e-05, "un_batch_to_individual_items": 1.5021170322157291e-05, "listify_data_for_vector_env": 3.142404669634611e-05}}, "connector_pipeline_timer": 0.0003586980871317215}, "num_env_steps_sampled_lifetime": -1687500.0, "agent_episode_returns_mean": {"default_agent": -0.7000000000000002}, "episode_return_mean": -0.7000000000000002, "env_step_timer": 4.405221800032563e-05, "num_agent_steps_sampled": {"default_agent": 5000.0}, "episode_len_min": 50, "env_to_module_connector": {"timers": {"connectors": {"add_observations_from_episodes_to_batch": 6.559230639362781e-06, "numpy_to_tensor": 3.118635428620564e-05, "add_states_from_episodes_to_batch": 3.5018955965165914e-06, "add_time_dim_to_batch_and_zero_pad": 6.441537585493707e-06, "batch_individual_items": 1.8641260128190435e-05}}, "connector_pipeline_timer": 0.0001192045183339066}, "episode_return_min": -5.5, "env_to_module_sum_episodes_length_in": 27.16809333212661, "num_episodes": 100.0, "weights_seq_no": 8.0, "episode_return_max": 14.5, "num_episodes_lifetime": -33750.0, "episode_duration_sec_mean": 0.03641927404006311, "episode_len_max": 50, "num_agent_steps_sampled_lifetime": {"default_agent": -1687500.0}, "time_between_sampling": 0.01228956996457501, "num_module_steps_sampled": {"default_policy": 5000.0}, "rlmodule_inference_timer": 9.890795132915558e-05, "num_env_steps_sampled": 5000.0, "episode_len_mean": 50.0, "env_reset_timer": 9.45854885890923e-05, "num_module_steps_sampled_lifetime": {"default_policy": -1687500.0}, "env_to_module_sum_episodes_length_out": 27.16809333212661, "sample": 0.03745948546363231, "module_episode_returns_mean": {"default_policy": -0.7000000000000002}, "num_env_steps_sampled_lifetime_throughput": 1282.168532997782}, "learners": {"__all_modules__": {"learner_connector_sum_episodes_length_out": 5100.0, "learner_connector": {"connector_pipeline_timer": 0.2990413920160045, "timers": {"connectors": {"general_advantage_estimation": 0.014173628463386661, "add_time_dim_to_batch_and_zero_pad": 2.463443579055941e-05, "batch_individual_items": 0.20485186638702957, "numpy_to_tensor": 0.00022504317841310587, "add_one_ts_to_episodes_and_truncate": 0.008715338830667682, "add_columns_from_episodes_to_train_batch": 0.06988380449047839, "add_observations_from_episodes_to_batch": 0.0007858385868853033, "add_states_from_episodes_to_batch": 6.075825210572669e-06}}}, "num_env_steps_trained": 30600, "num_env_steps_trained_lifetime": 275400, "num_module_steps_trained_lifetime": 54000, "num_trainable_parameters": 4965, "num_module_steps_trained": 6000, "num_non_trainable_parameters": 0, "learner_connector_sum_episodes_length_in": 5000.0, "num_env_steps_trained_lifetime_throughput": 881556.5957792115, "num_module_steps_trained_throughput": 173564.4594257564, "num_module_steps_trained_lifetime_throughput": 173505.11225454576}, "default_policy": {"diff_num_grad_updates_vs_sampler_policy": 1.0, "vf_explained_var": 0.011788487434387207, "curr_kl_coeff": 0.6102748513221741, "num_module_steps_trained_lifetime": 54000, "entropy": 0.6533564329147339, "num_trainable_parameters": 4965, "num_module_steps_trained": 6000, "default_optimizer_learning_rate": 0.0602050062423, "weights_seq_no": 9.0, "mean_kl_loss": 0.024316715076565742, "vf_loss": 0.10231559723615646, "vf_loss_unclipped": 42.48949432373047, "module_train_batch_size_mean": 1000.0, "curr_entropy_coeff": 0.0304386028221, "total_loss": -0.0017893845215439796, "gradients_default_optimizer_global_norm": 1.0728263854980469, "policy_loss": -0.04589271917939186, "num_module_steps_trained_lifetime_throughput": 173933.96130281204}}, "num_training_step_calls_per_iteration": 1, "evaluation": {"env_runners": {"rlmodule_inference_timer": 9.492634234248451e-05, "env_to_module_sum_episodes_length_out": 27.168093332126602, "sample": 0.7344445391355112, "module_episode_returns_mean": {"default_policy": 1.5}, "episode_return_mean": 1.5, "num_agent_steps_sampled": {"default_agent": 1000}, "module_to_env_connector": {"timers": {"connectors": {"un_batch_to_individual_items": 1.601889452846609e-05, "remove_single_ts_time_rank_from_batch": 1.4398936839388617e-06, "get_actions": 0.00015399581012040032, "normalize_and_clip_actions": 2.2398575956905285e-05, "tensor_to_numpy": 4.5698810950673125e-05, "listify_data_for_vector_env": 3.062329674678148e-05}}, "connector_pipeline_timer": 0.0003437655937930347}, "env_step_timer": 4.257816780018839e-05, "env_to_module_connector": {"timers": {"connectors": {"add_observations_from_episodes_to_batch": 6.4846085181791165e-06, "add_states_from_episodes_to_batch": 3.267378397395361e-06, "add_time_dim_to_batch_and_zero_pad": 5.718757217967091e-06, "batch_individual_items": 1.8164215239401295e-05, "numpy_to_tensor": 2.9328066799461857e-05}}, "connector_pipeline_timer": 0.00011417402005474715}, "num_episodes": 20, "episode_return_max": 17.5, "env_reset_timer": 0.00021161497914647947, "weights_seq_no": 9.0, "episode_len_max": 50, "num_module_steps_sampled": {"default_policy": 1000}, "num_env_steps_sampled": 1000, "num_env_steps_sampled_lifetime": 46000, "agent_episode_returns_mean": {"default_agent": 1.5}, "episode_len_min": 50, "num_episodes_lifetime": 180, "episode_duration_sec_mean": 0.035592037030019126, "num_agent_steps_sampled_lifetime": {"default_agent": 9000}, "episode_len_mean": 50.0, "num_module_steps_sampled_lifetime": {"default_policy": 9000}, "episode_return_min": -16.5, "env_to_module_sum_episodes_length_in": 27.168093332126602, "time_between_sampling": 4.139426743054065}, "num_healthy_workers": 1, "actor_manager_num_outstanding_async_reqs": 0, "num_remote_worker_restarts": 0}, "num_env_steps_sampled_lifetime": -1687500.0, "fault_tolerance": {"num_healthy_workers": 0, "num_remote_worker_restarts": 0}, "env_runner_group": {"actor_manager_num_outstanding_async_reqs": 0}, "done": false, "training_iteration": 9, "trial_id": "148fb_00000", "date": "2025-08-11_17-50-31", "timestamp": 1754927431, "time_this_iter_s": 4.844745874404907, "time_total_s": 44.430660247802734, "pid": 97502, "hostname": "DESKTOP-3SK5A41", "node_ip": "192.168.40.242", "config": {"exploration_config": {}, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 6, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "env": "Umbrella", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": false, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 0, "create_local_env_runner": true, "num_envs_per_env_runner": 1, "gym_env_vectorize_mode": "SYNC", "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "episodes_to_numpy": true, "max_requests_in_flight_per_env_runner": 1, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "merge_env_runner_states": "training_only", "broadcast_env_runner_states": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "complete_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "sampler_perf_stats_ema_coef": null, "_is_online": true, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": "auto", "num_aggregator_actors_per_learner": 0, "max_requests_in_flight_per_aggregator_actor": 3, "local_gpu_idx": 0, "max_requests_in_flight_per_learner": 3, "gamma": 1, "lr": 0.0602050062423, "grad_clip": 0.5, "grad_clip_by": "global_norm", "_train_batch_size_per_learner": 5000, "train_batch_size": 4000, "num_epochs": 1, "minibatch_size": 1000, "shuffle_batch_per_epoch": true, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "log_std_clip_param": 20.0, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "_disable_preprocessor_api": false, "_disable_action_flattening": false}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "_learner_class": null, "callbacks_on_algorithm_init": null, "callbacks_on_env_runners_recreated": null, "callbacks_on_offline_eval_runners_recreated": null, "callbacks_on_checkpoint_loaded": null, "callbacks_on_environment_created": null, "callbacks_on_episode_created": null, "callbacks_on_episode_start": null, "callbacks_on_episode_step": null, "callbacks_on_episode_end": null, "callbacks_on_evaluate_start": null, "callbacks_on_evaluate_end": null, "callbacks_on_evaluate_offline_start": null, "callbacks_on_evaluate_offline_end": null, "callbacks_on_sample_end": null, "callbacks_on_train_result": null, "explore": true, "enable_rl_module_and_learner": true, "enable_env_runner_and_connector_v2": true, "_prior_exploration_config": {"type": "StochasticSampling"}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7f830969eac0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "offline_data_class": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_read_batch_size": null, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "materialize_data": false, "materialize_mapped_data": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "ignore_final_observation": false, "prelearner_class": null, "prelearner_buffer_class": null, "prelearner_buffer_kwargs": {}, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_remaining_data": false, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": 1, "evaluation_duration": 20, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_auto_duration_min_env_steps_per_sample": 100, "evaluation_auto_duration_max_env_steps_per_sample": 2000, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 1, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "offline_evaluation_interval": null, "num_offline_eval_runners": 0, "offline_loss_for_module_fn": null, "offline_evaluation_duration": 1, "offline_evaluation_parallel_to_training": false, "offline_evaluation_timeout_s": 120.0, "num_cpus_per_offline_eval_runner": 1, "num_gpus_per_offline_eval_runner": 0, "custom_resources_per_offline_eval_runner": {}, "restart_failed_offline_eval_runners": true, "ignore_offline_eval_runner_failures": false, "max_num_offline_eval_runner_restarts": 1000, "offline_eval_runner_restore_timeout_s": 1800.0, "max_requests_in_flight_per_offline_eval_runner": 1, "validate_offline_eval_runners_after_construction": true, "offline_eval_runner_health_probe_timeout_s": 30.0, "offline_eval_rl_module_inference_only": false, "broadcast_offline_eval_runner_states": false, "offline_eval_batch_size_per_runner": 256, "dataset_num_iters_per_eval_runner": 1, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "log_gradients": true, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 42, "restart_failed_env_runners": true, "ignore_env_runner_failures": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30.0, "env_runner_restore_timeout_s": 1800.0, "_model_config": {}, "_rl_module_spec": "RLModuleSpec(module_class=None, observation_space=None, action_space=None, inference_only=False, learner_only=False, model_config=DefaultModelConfig(fcnet_hiddens=[127, 34], fcnet_activation='tanh', fcnet_kernel_initializer=None, fcnet_kernel_initializer_kwargs=None, fcnet_bias_initializer=None, fcnet_bias_initializer_kwargs=None, conv_filters=None, conv_activation='relu', conv_kernel_initializer=None, conv_kernel_initializer_kwargs=None, conv_bias_initializer=None, conv_bias_initializer_kwargs=None, head_fcnet_hiddens=[], head_fcnet_activation='relu', head_fcnet_kernel_initializer=None, head_fcnet_kernel_initializer_kwargs=None, head_fcnet_bias_initializer=None, head_fcnet_bias_initializer_kwargs=None, free_log_std=False, log_std_clip_param=20.0, vf_share_layers=True, use_lstm=False, max_seq_len=20, lstm_cell_size=256, lstm_use_prev_action=False, lstm_use_prev_reward=False, lstm_kernel_initializer=None, lstm_kernel_initializer_kwargs=None, lstm_bias_initializer=None, lstm_bias_initializer_kwargs=None), catalog_class=None, load_state_path=None, model_config_dict=None)", "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "_validate_config": true, "_use_msgpack_checkpoints": false, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "env_task_fn": -1, "enable_connectors": -1, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.4821924166921, "kl_target": 0.0121335369454, "vf_loss_coeff": 0.5287301420718, "entropy_coeff": 0.0304386028221, "clip_param": 0.2973082591601, "vf_clip_param": 0.1116643404955, "entropy_coeff_schedule": null, "lr_schedule": null, "sgd_minibatch_size": -1, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9313529170176, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.callbacks.callbacks.RLlibCallback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 44.430660247802734, "iterations_since_restore": 9, "perf": {"cpu_util_percent": 12.85714285714286, "ram_util_percent": 83.3}}
{"timers": {"training_iteration": 4.320812589287761, "restore_env_runners": 1.687004021413398e-05, "training_step": 4.320553104994529, "env_runner_sampling_timer": 3.902830237424585, "learner_update_timer": 0.4143158498220852, "synch_weights": 0.0014364796851943323, "restore_eval_env_runners": 1.3278325856407013e-05, "evaluation_iteration": 0.7464067251658081, "synch_eval_env_connectors": 0.0004504196203123527, "synch_env_connectors": 9.29793489584798e-06}, "env_runners": {"module_to_env_connector": {"timers": {"connectors": {"remove_single_ts_time_rank_from_batch": 1.4010864121664742e-06, "get_actions": 0.00016195173389026797, "tensor_to_numpy": 4.850767196192385e-05, "normalize_and_clip_actions": 2.2466657278807032e-05, "un_batch_to_individual_items": 1.5103765499899803e-05, "listify_data_for_vector_env": 3.121120778351828e-05}}, "connector_pipeline_timer": 0.00035737280259787564}, "num_env_steps_sampled_lifetime": -1930000.0, "agent_episode_returns_mean": {"default_agent": 2.5}, "episode_return_mean": 2.5, "env_step_timer": 4.3989934273197795e-05, "num_agent_steps_sampled": {"default_agent": 5000.0}, "episode_len_min": 50, "env_to_module_connector": {"timers": {"connectors": {"add_observations_from_episodes_to_batch": 6.558436676842916e-06, "numpy_to_tensor": 3.1184789042354585e-05, "add_states_from_episodes_to_batch": 3.5104345308828053e-06, "add_time_dim_to_batch_and_zero_pad": 6.406379715900493e-06, "batch_individual_items": 1.859993403746125e-05}}, "connector_pipeline_timer": 0.00011888579144051946}, "episode_return_min": -5.5, "env_to_module_sum_episodes_length_in": 27.16809333212661, "num_episodes": 100.0, "weights_seq_no": 9.0, "episode_return_max": 14.5, "num_episodes_lifetime": -38600.0, "episode_duration_sec_mean": 0.03634092903001147, "episode_len_max": 50, "num_agent_steps_sampled_lifetime": {"default_agent": -1930000.0}, "time_between_sampling": 0.011667372450453815, "num_module_steps_sampled": {"default_policy": 5000.0}, "rlmodule_inference_timer": 9.931349151418023e-05, "num_env_steps_sampled": 5000.0, "episode_len_mean": 50.0, "env_reset_timer": 9.404166946669234e-05, "num_module_steps_sampled_lifetime": {"default_policy": -1930000.0}, "env_to_module_sum_episodes_length_out": 27.16809333212661, "sample": 0.03747718494769529, "module_episode_returns_mean": {"default_policy": 2.5}, "num_env_steps_sampled_lifetime_throughput": 1284.392896986628}, "learners": {"__all_modules__": {"learner_connector_sum_episodes_length_out": 5100.0, "learner_connector": {"connector_pipeline_timer": 0.29899248710584186, "timers": {"connectors": {"general_advantage_estimation": 0.014136460178758905, "add_time_dim_to_batch_and_zero_pad": 2.4596091433947656e-05, "batch_individual_items": 0.20485923573315903, "numpy_to_tensor": 0.00022468674662623928, "add_one_ts_to_episodes_and_truncate": 0.008712842442358612, "add_columns_from_episodes_to_train_batch": 0.0698686134455698, "add_observations_from_episodes_to_batch": 0.0007854492010093026, "add_states_from_episodes_to_batch": 6.063066960164743e-06}}}, "num_env_steps_trained": 30600, "num_env_steps_trained_lifetime": 306000, "num_module_steps_trained_lifetime": 60000, "num_trainable_parameters": 4965, "num_module_steps_trained": 6000, "num_non_trainable_parameters": 0, "learner_connector_sum_episodes_length_in": 5000.0, "num_env_steps_trained_lifetime_throughput": 879380.6788356972, "num_module_steps_trained_throughput": 173117.14296443225, "num_module_steps_trained_lifetime_throughput": 173055.8183740901}, "default_policy": {"diff_num_grad_updates_vs_sampler_policy": 1.0, "vf_explained_var": 0.03828078508377075, "curr_kl_coeff": 0.6102748513221741, "num_module_steps_trained_lifetime": 60000, "entropy": 0.5029668807983398, "num_trainable_parameters": 4965, "num_module_steps_trained": 6000, "default_optimizer_learning_rate": 0.0602050062423, "weights_seq_no": 10.0, "mean_kl_loss": 0.019601015374064445, "vf_loss": 0.10471060872077942, "vf_loss_unclipped": 31.680313110351562, "module_train_batch_size_mean": 1000.0, "curr_entropy_coeff": 0.0304386028221, "total_loss": -0.1570199429988861, "gradients_default_optimizer_global_norm": 0.5760816335678101, "policy_loss": -0.20903602242469788, "num_module_steps_trained_lifetime_throughput": 173454.9100021179}}, "num_training_step_calls_per_iteration": 1, "evaluation": {"env_runners": {"rlmodule_inference_timer": 9.635754041146064e-05, "env_to_module_sum_episodes_length_out": 27.168093332126602, "sample": 0.73444738875416, "module_episode_returns_mean": {"default_policy": 0.7}, "episode_return_mean": 0.7, "num_agent_steps_sampled": {"default_agent": 1000}, "module_to_env_connector": {"timers": {"connectors": {"un_batch_to_individual_items": 1.5643680963664782e-05, "remove_single_ts_time_rank_from_batch": 1.452657581751153e-06, "get_actions": 0.00015442762915058583, "normalize_and_clip_actions": 2.243933913178117e-05, "tensor_to_numpy": 4.5483578694243924e-05, "listify_data_for_vector_env": 3.0052078657941098e-05}}, "connector_pipeline_timer": 0.0003432504700836005}, "env_step_timer": 4.2449133691813465e-05, "env_to_module_connector": {"timers": {"connectors": {"add_observations_from_episodes_to_batch": 6.11769678348768e-06, "add_states_from_episodes_to_batch": 3.321721346694222e-06, "add_time_dim_to_batch_and_zero_pad": 5.67983869126077e-06, "batch_individual_items": 1.7713389436012946e-05, "numpy_to_tensor": 2.9946867161255967e-05}}, "connector_pipeline_timer": 0.00011404558198829378}, "num_episodes": 20, "episode_return_max": 17.5, "env_reset_timer": 0.00021075782935558765, "weights_seq_no": 10.0, "episode_len_max": 50, "num_module_steps_sampled": {"default_policy": 1000}, "num_env_steps_sampled": 1000, "num_env_steps_sampled_lifetime": 51000, "agent_episode_returns_mean": {"default_agent": 0.7}, "episode_len_min": 50, "num_episodes_lifetime": 200, "episode_duration_sec_mean": 0.035442619020013805, "num_agent_steps_sampled_lifetime": {"default_agent": 10000}, "episode_len_mean": 50.0, "num_module_steps_sampled_lifetime": {"default_policy": 10000}, "episode_return_min": -16.5, "env_to_module_sum_episodes_length_in": 27.168093332126602, "time_between_sampling": 4.140810663683526}, "num_healthy_workers": 1, "actor_manager_num_outstanding_async_reqs": 0, "num_remote_worker_restarts": 0}, "num_env_steps_sampled_lifetime": -1930000.0, "fault_tolerance": {"num_healthy_workers": 0, "num_remote_worker_restarts": 0}, "env_runner_group": {"actor_manager_num_outstanding_async_reqs": 0}, "done": false, "training_iteration": 10, "trial_id": "148fb_00000", "date": "2025-08-11_17-50-36", "timestamp": 1754927436, "time_this_iter_s": 4.973297595977783, "time_total_s": 49.40395784378052, "pid": 97502, "hostname": "DESKTOP-3SK5A41", "node_ip": "192.168.40.242", "config": {"exploration_config": {}, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 6, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "env": "Umbrella", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": false, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 0, "create_local_env_runner": true, "num_envs_per_env_runner": 1, "gym_env_vectorize_mode": "SYNC", "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "episodes_to_numpy": true, "max_requests_in_flight_per_env_runner": 1, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "merge_env_runner_states": "training_only", "broadcast_env_runner_states": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "complete_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "sampler_perf_stats_ema_coef": null, "_is_online": true, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": "auto", "num_aggregator_actors_per_learner": 0, "max_requests_in_flight_per_aggregator_actor": 3, "local_gpu_idx": 0, "max_requests_in_flight_per_learner": 3, "gamma": 1, "lr": 0.0602050062423, "grad_clip": 0.5, "grad_clip_by": "global_norm", "_train_batch_size_per_learner": 5000, "train_batch_size": 4000, "num_epochs": 1, "minibatch_size": 1000, "shuffle_batch_per_epoch": true, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "log_std_clip_param": 20.0, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "_disable_preprocessor_api": false, "_disable_action_flattening": false}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "_learner_class": null, "callbacks_on_algorithm_init": null, "callbacks_on_env_runners_recreated": null, "callbacks_on_offline_eval_runners_recreated": null, "callbacks_on_checkpoint_loaded": null, "callbacks_on_environment_created": null, "callbacks_on_episode_created": null, "callbacks_on_episode_start": null, "callbacks_on_episode_step": null, "callbacks_on_episode_end": null, "callbacks_on_evaluate_start": null, "callbacks_on_evaluate_end": null, "callbacks_on_evaluate_offline_start": null, "callbacks_on_evaluate_offline_end": null, "callbacks_on_sample_end": null, "callbacks_on_train_result": null, "explore": true, "enable_rl_module_and_learner": true, "enable_env_runner_and_connector_v2": true, "_prior_exploration_config": {"type": "StochasticSampling"}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7f830969eac0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "offline_data_class": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_read_batch_size": null, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "materialize_data": false, "materialize_mapped_data": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "ignore_final_observation": false, "prelearner_class": null, "prelearner_buffer_class": null, "prelearner_buffer_kwargs": {}, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_remaining_data": false, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": 1, "evaluation_duration": 20, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_auto_duration_min_env_steps_per_sample": 100, "evaluation_auto_duration_max_env_steps_per_sample": 2000, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 1, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "offline_evaluation_interval": null, "num_offline_eval_runners": 0, "offline_loss_for_module_fn": null, "offline_evaluation_duration": 1, "offline_evaluation_parallel_to_training": false, "offline_evaluation_timeout_s": 120.0, "num_cpus_per_offline_eval_runner": 1, "num_gpus_per_offline_eval_runner": 0, "custom_resources_per_offline_eval_runner": {}, "restart_failed_offline_eval_runners": true, "ignore_offline_eval_runner_failures": false, "max_num_offline_eval_runner_restarts": 1000, "offline_eval_runner_restore_timeout_s": 1800.0, "max_requests_in_flight_per_offline_eval_runner": 1, "validate_offline_eval_runners_after_construction": true, "offline_eval_runner_health_probe_timeout_s": 30.0, "offline_eval_rl_module_inference_only": false, "broadcast_offline_eval_runner_states": false, "offline_eval_batch_size_per_runner": 256, "dataset_num_iters_per_eval_runner": 1, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "log_gradients": true, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 42, "restart_failed_env_runners": true, "ignore_env_runner_failures": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30.0, "env_runner_restore_timeout_s": 1800.0, "_model_config": {}, "_rl_module_spec": "RLModuleSpec(module_class=None, observation_space=None, action_space=None, inference_only=False, learner_only=False, model_config=DefaultModelConfig(fcnet_hiddens=[127, 34], fcnet_activation='tanh', fcnet_kernel_initializer=None, fcnet_kernel_initializer_kwargs=None, fcnet_bias_initializer=None, fcnet_bias_initializer_kwargs=None, conv_filters=None, conv_activation='relu', conv_kernel_initializer=None, conv_kernel_initializer_kwargs=None, conv_bias_initializer=None, conv_bias_initializer_kwargs=None, head_fcnet_hiddens=[], head_fcnet_activation='relu', head_fcnet_kernel_initializer=None, head_fcnet_kernel_initializer_kwargs=None, head_fcnet_bias_initializer=None, head_fcnet_bias_initializer_kwargs=None, free_log_std=False, log_std_clip_param=20.0, vf_share_layers=True, use_lstm=False, max_seq_len=20, lstm_cell_size=256, lstm_use_prev_action=False, lstm_use_prev_reward=False, lstm_kernel_initializer=None, lstm_kernel_initializer_kwargs=None, lstm_bias_initializer=None, lstm_bias_initializer_kwargs=None), catalog_class=None, load_state_path=None, model_config_dict=None)", "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "_validate_config": true, "_use_msgpack_checkpoints": false, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "env_task_fn": -1, "enable_connectors": -1, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.4821924166921, "kl_target": 0.0121335369454, "vf_loss_coeff": 0.5287301420718, "entropy_coeff": 0.0304386028221, "clip_param": 0.2973082591601, "vf_clip_param": 0.1116643404955, "entropy_coeff_schedule": null, "lr_schedule": null, "sgd_minibatch_size": -1, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9313529170176, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.callbacks.callbacks.RLlibCallback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 49.40395784378052, "iterations_since_restore": 10, "perf": {"cpu_util_percent": 12.471428571428573, "ram_util_percent": 83.3}}
{"timers": {"training_iteration": 4.318354289474883, "restore_env_runners": 1.6818339811583556e-05, "training_step": 4.318093059024589, "env_runner_sampling_timer": 3.9026889351203384, "learner_update_timer": 0.4119927863338625, "synch_weights": 0.0014358738883455085, "restore_eval_env_runners": 1.3246542593836277e-05, "evaluation_iteration": 0.7463865219241516, "synch_eval_env_connectors": 0.0004498254241050417, "synch_env_connectors": 9.26795554457039e-06}, "env_runners": {"module_to_env_connector": {"timers": {"connectors": {"remove_single_ts_time_rank_from_batch": 1.408162395857814e-06, "get_actions": 0.00016192130044063167, "tensor_to_numpy": 4.858698687405137e-05, "normalize_and_clip_actions": 2.2456095710297726e-05, "un_batch_to_individual_items": 1.5102040814983707e-05, "listify_data_for_vector_env": 3.11831082889268e-05}}, "connector_pipeline_timer": 0.00035732745862192776}, "num_env_steps_sampled_lifetime": -2172500.0, "agent_episode_returns_mean": {"default_agent": 0.09999999999999998}, "episode_return_mean": 0.09999999999999998, "env_step_timer": 4.402167809540798e-05, "num_agent_steps_sampled": {"default_agent": 5000.0}, "episode_len_min": 50, "env_to_module_connector": {"timers": {"connectors": {"add_observations_from_episodes_to_batch": 6.486004944302999e-06, "numpy_to_tensor": 3.1235454275887864e-05, "add_states_from_episodes_to_batch": 3.4710973084718093e-06, "add_time_dim_to_batch_and_zero_pad": 6.403757195466691e-06, "batch_individual_items": 1.851866198851877e-05}}, "connector_pipeline_timer": 0.00011875567265394028}, "episode_return_min": -5.5, "env_to_module_sum_episodes_length_in": 27.16809333212661, "num_episodes": 100.0, "weights_seq_no": 10.0, "episode_return_max": 14.5, "num_episodes_lifetime": -43450.0, "episode_duration_sec_mean": 0.036304137070073905, "episode_len_max": 50, "num_agent_steps_sampled_lifetime": {"default_agent": -2172500.0}, "time_between_sampling": 0.012331468261980743, "num_module_steps_sampled": {"default_policy": 5000.0}, "rlmodule_inference_timer": 9.881668013536817e-05, "num_env_steps_sampled": 5000.0, "episode_len_mean": 50.0, "env_reset_timer": 9.34760031699803e-05, "num_module_steps_sampled_lifetime": {"default_policy": -2172500.0}, "env_to_module_sum_episodes_length_out": 27.16809333212661, "sample": 0.03739588247360769, "module_episode_returns_mean": {"default_policy": 0.09999999999999998}, "num_env_steps_sampled_lifetime_throughput": 1287.1890066750857}, "learners": {"__all_modules__": {"learner_connector_sum_episodes_length_out": 5100.0, "learner_connector": {"connector_pipeline_timer": 0.29746626624477673, "timers": {"connectors": {"general_advantage_estimation": 0.014084708586966761, "add_time_dim_to_batch_and_zero_pad": 2.4568130524287375e-05, "batch_individual_items": 0.20339402837582735, "numpy_to_tensor": 0.0002240938791578473, "add_one_ts_to_episodes_and_truncate": 0.008709943017938714, "add_columns_from_episodes_to_train_batch": 0.06986416431112108, "add_observations_from_episodes_to_batch": 0.0007849627090051635, "add_states_from_episodes_to_batch": 6.052436289299989e-06}}}, "num_env_steps_trained": 30600, "num_env_steps_trained_lifetime": 336600, "num_module_steps_trained_lifetime": 66000, "num_trainable_parameters": 4965, "num_module_steps_trained": 6000, "num_non_trainable_parameters": 0, "learner_connector_sum_episodes_length_in": 5000.0, "num_env_steps_trained_lifetime_throughput": 876961.0429960585, "num_module_steps_trained_throughput": 172621.11264946585, "num_module_steps_trained_lifetime_throughput": 172558.10505533806}, "default_policy": {"diff_num_grad_updates_vs_sampler_policy": 1.0, "vf_explained_var": 0.011823952198028564, "curr_kl_coeff": 0.30513742566108704, "num_module_steps_trained_lifetime": 66000, "entropy": 0.5963530540466309, "num_trainable_parameters": 4965, "num_module_steps_trained": 6000, "default_optimizer_learning_rate": 0.0602050062423, "weights_seq_no": 11.0, "mean_kl_loss": 0.0020776069723069668, "vf_loss": 0.0993000790476799, "vf_loss_unclipped": 45.126399993896484, "module_train_batch_size_mean": 1000.0, "curr_entropy_coeff": 0.0304386028221, "total_loss": -0.08418984711170197, "gradients_default_optimizer_global_norm": 0.06465761363506317, "policy_loss": -0.11980856955051422, "num_module_steps_trained_lifetime_throughput": 172930.11883670525}}, "num_training_step_calls_per_iteration": 1, "evaluation": {"env_runners": {"rlmodule_inference_timer": 9.559831192276751e-05, "env_to_module_sum_episodes_length_out": 27.168093332126602, "sample": 0.7344267188766208, "module_episode_returns_mean": {"default_policy": 0.7}, "episode_return_mean": 0.7, "num_agent_steps_sampled": {"default_agent": 1000}, "module_to_env_connector": {"timers": {"connectors": {"un_batch_to_individual_items": 1.519584181056321e-05, "remove_single_ts_time_rank_from_batch": 1.4411090459155178e-06, "get_actions": 0.00015377459887216404, "normalize_and_clip_actions": 2.2141585989972516e-05, "tensor_to_numpy": 4.529699081558253e-05, "listify_data_for_vector_env": 3.077887768467118e-05}}, "connector_pipeline_timer": 0.00034226935023765607}, "env_step_timer": 4.199019164538914e-05, "env_to_module_connector": {"timers": {"connectors": {"add_observations_from_episodes_to_batch": 6.136314743688721e-06, "add_states_from_episodes_to_batch": 3.6510498719788537e-06, "add_time_dim_to_batch_and_zero_pad": 5.616631790506081e-06, "batch_individual_items": 1.8018465061715926e-05, "numpy_to_tensor": 2.97827491612814e-05}}, "connector_pipeline_timer": 0.00011491469840481612}, "num_episodes": 20, "episode_return_max": 17.5, "env_reset_timer": 0.00020987525106746545, "weights_seq_no": 11.0, "episode_len_max": 50, "num_module_steps_sampled": {"default_policy": 1000}, "num_env_steps_sampled": 1000, "num_env_steps_sampled_lifetime": 56000, "agent_episode_returns_mean": {"default_agent": 0.7}, "episode_len_min": 50, "num_episodes_lifetime": 220, "episode_duration_sec_mean": 0.03540587702003904, "num_agent_steps_sampled_lifetime": {"default_agent": 11000}, "episode_len_mean": 50.0, "num_module_steps_sampled_lifetime": {"default_policy": 11000}, "episode_return_min": -16.5, "env_to_module_sum_episodes_length_in": 27.168093332126602, "time_between_sampling": 4.140709322126689}, "num_healthy_workers": 1, "actor_manager_num_outstanding_async_reqs": 0, "num_remote_worker_restarts": 0}, "num_env_steps_sampled_lifetime": -2172500.0, "fault_tolerance": {"num_healthy_workers": 0, "num_remote_worker_restarts": 0}, "env_runner_group": {"actor_manager_num_outstanding_async_reqs": 0}, "done": false, "training_iteration": 11, "trial_id": "148fb_00000", "date": "2025-08-11_17-50-41", "timestamp": 1754927441, "time_this_iter_s": 4.822147607803345, "time_total_s": 54.22610545158386, "pid": 97502, "hostname": "DESKTOP-3SK5A41", "node_ip": "192.168.40.242", "config": {"exploration_config": {}, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 6, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "env": "Umbrella", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": false, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 0, "create_local_env_runner": true, "num_envs_per_env_runner": 1, "gym_env_vectorize_mode": "SYNC", "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "episodes_to_numpy": true, "max_requests_in_flight_per_env_runner": 1, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "merge_env_runner_states": "training_only", "broadcast_env_runner_states": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "complete_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "sampler_perf_stats_ema_coef": null, "_is_online": true, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": "auto", "num_aggregator_actors_per_learner": 0, "max_requests_in_flight_per_aggregator_actor": 3, "local_gpu_idx": 0, "max_requests_in_flight_per_learner": 3, "gamma": 1, "lr": 0.0602050062423, "grad_clip": 0.5, "grad_clip_by": "global_norm", "_train_batch_size_per_learner": 5000, "train_batch_size": 4000, "num_epochs": 1, "minibatch_size": 1000, "shuffle_batch_per_epoch": true, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "log_std_clip_param": 20.0, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "_disable_preprocessor_api": false, "_disable_action_flattening": false}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "_learner_class": null, "callbacks_on_algorithm_init": null, "callbacks_on_env_runners_recreated": null, "callbacks_on_offline_eval_runners_recreated": null, "callbacks_on_checkpoint_loaded": null, "callbacks_on_environment_created": null, "callbacks_on_episode_created": null, "callbacks_on_episode_start": null, "callbacks_on_episode_step": null, "callbacks_on_episode_end": null, "callbacks_on_evaluate_start": null, "callbacks_on_evaluate_end": null, "callbacks_on_evaluate_offline_start": null, "callbacks_on_evaluate_offline_end": null, "callbacks_on_sample_end": null, "callbacks_on_train_result": null, "explore": true, "enable_rl_module_and_learner": true, "enable_env_runner_and_connector_v2": true, "_prior_exploration_config": {"type": "StochasticSampling"}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7f830969eac0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "offline_data_class": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_read_batch_size": null, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "materialize_data": false, "materialize_mapped_data": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "ignore_final_observation": false, "prelearner_class": null, "prelearner_buffer_class": null, "prelearner_buffer_kwargs": {}, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_remaining_data": false, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": 1, "evaluation_duration": 20, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_auto_duration_min_env_steps_per_sample": 100, "evaluation_auto_duration_max_env_steps_per_sample": 2000, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 1, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "offline_evaluation_interval": null, "num_offline_eval_runners": 0, "offline_loss_for_module_fn": null, "offline_evaluation_duration": 1, "offline_evaluation_parallel_to_training": false, "offline_evaluation_timeout_s": 120.0, "num_cpus_per_offline_eval_runner": 1, "num_gpus_per_offline_eval_runner": 0, "custom_resources_per_offline_eval_runner": {}, "restart_failed_offline_eval_runners": true, "ignore_offline_eval_runner_failures": false, "max_num_offline_eval_runner_restarts": 1000, "offline_eval_runner_restore_timeout_s": 1800.0, "max_requests_in_flight_per_offline_eval_runner": 1, "validate_offline_eval_runners_after_construction": true, "offline_eval_runner_health_probe_timeout_s": 30.0, "offline_eval_rl_module_inference_only": false, "broadcast_offline_eval_runner_states": false, "offline_eval_batch_size_per_runner": 256, "dataset_num_iters_per_eval_runner": 1, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "log_gradients": true, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 42, "restart_failed_env_runners": true, "ignore_env_runner_failures": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30.0, "env_runner_restore_timeout_s": 1800.0, "_model_config": {}, "_rl_module_spec": "RLModuleSpec(module_class=None, observation_space=None, action_space=None, inference_only=False, learner_only=False, model_config=DefaultModelConfig(fcnet_hiddens=[127, 34], fcnet_activation='tanh', fcnet_kernel_initializer=None, fcnet_kernel_initializer_kwargs=None, fcnet_bias_initializer=None, fcnet_bias_initializer_kwargs=None, conv_filters=None, conv_activation='relu', conv_kernel_initializer=None, conv_kernel_initializer_kwargs=None, conv_bias_initializer=None, conv_bias_initializer_kwargs=None, head_fcnet_hiddens=[], head_fcnet_activation='relu', head_fcnet_kernel_initializer=None, head_fcnet_kernel_initializer_kwargs=None, head_fcnet_bias_initializer=None, head_fcnet_bias_initializer_kwargs=None, free_log_std=False, log_std_clip_param=20.0, vf_share_layers=True, use_lstm=False, max_seq_len=20, lstm_cell_size=256, lstm_use_prev_action=False, lstm_use_prev_reward=False, lstm_kernel_initializer=None, lstm_kernel_initializer_kwargs=None, lstm_bias_initializer=None, lstm_bias_initializer_kwargs=None), catalog_class=None, load_state_path=None, model_config_dict=None)", "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "_validate_config": true, "_use_msgpack_checkpoints": false, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "env_task_fn": -1, "enable_connectors": -1, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.4821924166921, "kl_target": 0.0121335369454, "vf_loss_coeff": 0.5287301420718, "entropy_coeff": 0.0304386028221, "clip_param": 0.2973082591601, "vf_clip_param": 0.1116643404955, "entropy_coeff_schedule": null, "lr_schedule": null, "sgd_minibatch_size": -1, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9313529170176, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.callbacks.callbacks.RLlibCallback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 54.22610545158386, "iterations_since_restore": 11, "perf": {"cpu_util_percent": 12.542857142857141, "ram_util_percent": 83.3}}
{"timers": {"training_iteration": 4.317363978620134, "restore_env_runners": 1.6758156417287774e-05, "training_step": 4.317101640474338, "env_runner_sampling_timer": 3.9025799068091342, "learner_update_timer": 0.4111076404705234, "synch_weights": 0.0014354551494609642, "restore_eval_env_runners": 1.321207716833261e-05, "evaluation_iteration": 0.7463432207149091, "synch_eval_env_connectors": 0.0004500561698660352, "synch_env_connectors": 9.238275986805578e-06}, "env_runners": {"module_to_env_connector": {"timers": {"connectors": {"remove_single_ts_time_rank_from_batch": 1.394430332010372e-06, "get_actions": 0.00016177538427838975, "tensor_to_numpy": 4.878003911376714e-05, "normalize_and_clip_actions": 2.2604818819242094e-05, "un_batch_to_individual_items": 1.5147486529025068e-05, "listify_data_for_vector_env": 3.122079300871725e-05}}, "connector_pipeline_timer": 0.00035773829668159403}, "num_env_steps_sampled_lifetime": -2415000.0, "agent_episode_returns_mean": {"default_agent": 3.5}, "episode_return_mean": 3.5, "env_step_timer": 4.4117394792712896e-05, "num_agent_steps_sampled": {"default_agent": 5000.0}, "episode_len_min": 50, "env_to_module_connector": {"timers": {"connectors": {"add_observations_from_episodes_to_batch": 6.508837485689685e-06, "numpy_to_tensor": 3.127456089845795e-05, "add_states_from_episodes_to_batch": 3.5128465902136394e-06, "add_time_dim_to_batch_and_zero_pad": 6.366529008826628e-06, "batch_individual_items": 1.8510470122686535e-05}}, "connector_pipeline_timer": 0.0001189109912509963}, "episode_return_min": -5.5, "env_to_module_sum_episodes_length_in": 27.16809333212661, "num_episodes": 100.0, "weights_seq_no": 11.0, "episode_return_max": 14.5, "num_episodes_lifetime": -48300.0, "episode_duration_sec_mean": 0.036346660040026124, "episode_len_max": 50, "num_agent_steps_sampled_lifetime": {"default_agent": -2415000.0}, "time_between_sampling": 0.011629945163910853, "num_module_steps_sampled": {"default_policy": 5000.0}, "rlmodule_inference_timer": 9.941136117816234e-05, "num_env_steps_sampled": 5000.0, "episode_len_mean": 50.0, "env_reset_timer": 9.42316400329712e-05, "num_module_steps_sampled_lifetime": {"default_policy": -2415000.0}, "env_to_module_sum_episodes_length_out": 27.16809333212661, "sample": 0.03741226138596358, "module_episode_returns_mean": {"default_policy": 3.5}, "num_env_steps_sampled_lifetime_throughput": 1284.6550816616648}, "learners": {"__all_modules__": {"learner_connector_sum_episodes_length_out": 5100.0, "learner_connector": {"connector_pipeline_timer": 0.29738616958232433, "timers": {"connectors": {"general_advantage_estimation": 0.014038511501098003, "add_time_dim_to_batch_and_zero_pad": 2.456244921843856e-05, "batch_individual_items": 0.20337914409206825, "numpy_to_tensor": 0.00022352094036160277, "add_one_ts_to_episodes_and_truncate": 0.008705307587765766, "add_columns_from_episodes_to_train_batch": 0.06985169166801038, "add_observations_from_episodes_to_batch": 0.0007843080819134308, "add_states_from_episodes_to_batch": 6.052911927048786e-06}}}, "num_env_steps_trained": 30600, "num_env_steps_trained_lifetime": 367200, "num_module_steps_trained_lifetime": 72000, "num_trainable_parameters": 4965, "num_module_steps_trained": 6000, "num_non_trainable_parameters": 0, "learner_connector_sum_episodes_length_in": 5000.0, "num_env_steps_trained_lifetime_throughput": 874711.7407707562, "num_module_steps_trained_throughput": 172162.4189488968, "num_module_steps_trained_lifetime_throughput": 172095.5243856908}, "default_policy": {"diff_num_grad_updates_vs_sampler_policy": 1.0, "vf_explained_var": 0.009429514408111572, "curr_kl_coeff": 0.45770615339279175, "num_module_steps_trained_lifetime": 72000, "entropy": 0.5333445072174072, "num_trainable_parameters": 4965, "num_module_steps_trained": 6000, "default_optimizer_learning_rate": 0.0602050062423, "weights_seq_no": 12.0, "mean_kl_loss": 0.04082503169775009, "vf_loss": 0.11081596463918686, "vf_loss_unclipped": 28.869661331176758, "module_train_batch_size_mean": 1000.0, "curr_entropy_coeff": 0.0304386028221, "total_loss": -0.009571830742061138, "gradients_default_optimizer_global_norm": 0.47976529598236084, "policy_loss": -0.06438656151294708, "num_module_steps_trained_lifetime_throughput": 172444.7871536186}}, "num_training_step_calls_per_iteration": 1, "evaluation": {"env_runners": {"rlmodule_inference_timer": 9.622093957807135e-05, "env_to_module_sum_episodes_length_out": 27.168093332126602, "sample": 0.734436926677852, "module_episode_returns_mean": {"default_policy": 0.5}, "episode_return_mean": 0.5, "num_agent_steps_sampled": {"default_agent": 1000}, "module_to_env_connector": {"timers": {"connectors": {"un_batch_to_individual_items": 1.546536825728722e-05, "remove_single_ts_time_rank_from_batch": 1.4286188371034445e-06, "get_actions": 0.00015400286057805107, "normalize_and_clip_actions": 2.2238212348060735e-05, "tensor_to_numpy": 4.565564515104552e-05, "listify_data_for_vector_env": 3.1030254914745324e-05}}, "connector_pipeline_timer": 0.00034385947759447386}, "env_step_timer": 4.194637980889024e-05, "env_to_module_connector": {"timers": {"connectors": {"add_observations_from_episodes_to_batch": 6.5474322763572564e-06, "add_states_from_episodes_to_batch": 3.425999876186457e-06, "add_time_dim_to_batch_and_zero_pad": 5.67233219962124e-06, "batch_individual_items": 1.8301116899427238e-05, "numpy_to_tensor": 2.9787655363303503e-05}}, "connector_pipeline_timer": 0.00011515939732085494}, "num_episodes": 20, "episode_return_max": 17.5, "env_reset_timer": 0.00020900749855334174, "weights_seq_no": 12.0, "episode_len_max": 50, "num_module_steps_sampled": {"default_policy": 1000}, "num_env_steps_sampled": 1000, "num_env_steps_sampled_lifetime": 61000, "agent_episode_returns_mean": {"default_agent": 0.5}, "episode_len_min": 50, "num_episodes_lifetime": 240, "episode_duration_sec_mean": 0.03534071601002324, "num_agent_steps_sampled_lifetime": {"default_agent": 12000}, "episode_len_mean": 50.0, "num_module_steps_sampled_lifetime": {"default_policy": 12000}, "episode_return_min": -16.5, "env_to_module_sum_episodes_length_in": 27.168093332126602, "time_between_sampling": 4.1420497549454245}, "num_healthy_workers": 1, "actor_manager_num_outstanding_async_reqs": 0, "num_remote_worker_restarts": 0}, "num_env_steps_sampled_lifetime": -2415000.0, "fault_tolerance": {"num_healthy_workers": 0, "num_remote_worker_restarts": 0}, "env_runner_group": {"actor_manager_num_outstanding_async_reqs": 0}, "done": false, "training_iteration": 12, "trial_id": "148fb_00000", "date": "2025-08-11_17-50-46", "timestamp": 1754927446, "time_this_iter_s": 4.969754219055176, "time_total_s": 59.19585967063904, "pid": 97502, "hostname": "DESKTOP-3SK5A41", "node_ip": "192.168.40.242", "config": {"exploration_config": {}, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 6, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "env": "Umbrella", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": false, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 0, "create_local_env_runner": true, "num_envs_per_env_runner": 1, "gym_env_vectorize_mode": "SYNC", "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "episodes_to_numpy": true, "max_requests_in_flight_per_env_runner": 1, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "merge_env_runner_states": "training_only", "broadcast_env_runner_states": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "complete_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "sampler_perf_stats_ema_coef": null, "_is_online": true, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": "auto", "num_aggregator_actors_per_learner": 0, "max_requests_in_flight_per_aggregator_actor": 3, "local_gpu_idx": 0, "max_requests_in_flight_per_learner": 3, "gamma": 1, "lr": 0.0602050062423, "grad_clip": 0.5, "grad_clip_by": "global_norm", "_train_batch_size_per_learner": 5000, "train_batch_size": 4000, "num_epochs": 1, "minibatch_size": 1000, "shuffle_batch_per_epoch": true, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "log_std_clip_param": 20.0, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "_disable_preprocessor_api": false, "_disable_action_flattening": false}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "_learner_class": null, "callbacks_on_algorithm_init": null, "callbacks_on_env_runners_recreated": null, "callbacks_on_offline_eval_runners_recreated": null, "callbacks_on_checkpoint_loaded": null, "callbacks_on_environment_created": null, "callbacks_on_episode_created": null, "callbacks_on_episode_start": null, "callbacks_on_episode_step": null, "callbacks_on_episode_end": null, "callbacks_on_evaluate_start": null, "callbacks_on_evaluate_end": null, "callbacks_on_evaluate_offline_start": null, "callbacks_on_evaluate_offline_end": null, "callbacks_on_sample_end": null, "callbacks_on_train_result": null, "explore": true, "enable_rl_module_and_learner": true, "enable_env_runner_and_connector_v2": true, "_prior_exploration_config": {"type": "StochasticSampling"}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7f830969eac0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "offline_data_class": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_read_batch_size": null, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "materialize_data": false, "materialize_mapped_data": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "ignore_final_observation": false, "prelearner_class": null, "prelearner_buffer_class": null, "prelearner_buffer_kwargs": {}, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_remaining_data": false, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": 1, "evaluation_duration": 20, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_auto_duration_min_env_steps_per_sample": 100, "evaluation_auto_duration_max_env_steps_per_sample": 2000, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 1, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "offline_evaluation_interval": null, "num_offline_eval_runners": 0, "offline_loss_for_module_fn": null, "offline_evaluation_duration": 1, "offline_evaluation_parallel_to_training": false, "offline_evaluation_timeout_s": 120.0, "num_cpus_per_offline_eval_runner": 1, "num_gpus_per_offline_eval_runner": 0, "custom_resources_per_offline_eval_runner": {}, "restart_failed_offline_eval_runners": true, "ignore_offline_eval_runner_failures": false, "max_num_offline_eval_runner_restarts": 1000, "offline_eval_runner_restore_timeout_s": 1800.0, "max_requests_in_flight_per_offline_eval_runner": 1, "validate_offline_eval_runners_after_construction": true, "offline_eval_runner_health_probe_timeout_s": 30.0, "offline_eval_rl_module_inference_only": false, "broadcast_offline_eval_runner_states": false, "offline_eval_batch_size_per_runner": 256, "dataset_num_iters_per_eval_runner": 1, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "log_gradients": true, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 42, "restart_failed_env_runners": true, "ignore_env_runner_failures": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30.0, "env_runner_restore_timeout_s": 1800.0, "_model_config": {}, "_rl_module_spec": "RLModuleSpec(module_class=None, observation_space=None, action_space=None, inference_only=False, learner_only=False, model_config=DefaultModelConfig(fcnet_hiddens=[127, 34], fcnet_activation='tanh', fcnet_kernel_initializer=None, fcnet_kernel_initializer_kwargs=None, fcnet_bias_initializer=None, fcnet_bias_initializer_kwargs=None, conv_filters=None, conv_activation='relu', conv_kernel_initializer=None, conv_kernel_initializer_kwargs=None, conv_bias_initializer=None, conv_bias_initializer_kwargs=None, head_fcnet_hiddens=[], head_fcnet_activation='relu', head_fcnet_kernel_initializer=None, head_fcnet_kernel_initializer_kwargs=None, head_fcnet_bias_initializer=None, head_fcnet_bias_initializer_kwargs=None, free_log_std=False, log_std_clip_param=20.0, vf_share_layers=True, use_lstm=False, max_seq_len=20, lstm_cell_size=256, lstm_use_prev_action=False, lstm_use_prev_reward=False, lstm_kernel_initializer=None, lstm_kernel_initializer_kwargs=None, lstm_bias_initializer=None, lstm_bias_initializer_kwargs=None), catalog_class=None, load_state_path=None, model_config_dict=None)", "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "_validate_config": true, "_use_msgpack_checkpoints": false, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "env_task_fn": -1, "enable_connectors": -1, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.4821924166921, "kl_target": 0.0121335369454, "vf_loss_coeff": 0.5287301420718, "entropy_coeff": 0.0304386028221, "clip_param": 0.2973082591601, "vf_clip_param": 0.1116643404955, "entropy_coeff_schedule": null, "lr_schedule": null, "sgd_minibatch_size": -1, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9313529170176, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.callbacks.callbacks.RLlibCallback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 59.19585967063904, "iterations_since_restore": 12, "perf": {"cpu_util_percent": 12.375, "ram_util_percent": 83.2875}}
{"timers": {"training_iteration": 4.314973116833926, "restore_env_runners": 1.681657485504541e-05, "training_step": 4.314709132069588, "env_runner_sampling_timer": 3.9024696847410407, "learner_update_timer": 0.40882271706581086, "synch_weights": 0.0014354665979712385, "restore_eval_env_runners": 1.3187956391374388e-05, "evaluation_iteration": 0.746331454497762, "synch_eval_env_connectors": 0.00045023260817364275, "synch_env_connectors": 9.20489322144528e-06}, "env_runners": {"module_to_env_connector": {"timers": {"connectors": {"remove_single_ts_time_rank_from_batch": 1.4316189741202903e-06, "get_actions": 0.00016205762542421866, "tensor_to_numpy": 4.8546164770631166e-05, "normalize_and_clip_actions": 2.2448109114634197e-05, "un_batch_to_individual_items": 1.5171874334085e-05, "listify_data_for_vector_env": 3.110346147148362e-05}}, "connector_pipeline_timer": 0.0003573911651435673}, "num_env_steps_sampled_lifetime": -2657500.0, "agent_episode_returns_mean": {"default_agent": 2.899999999999998}, "episode_return_mean": 2.899999999999998, "env_step_timer": 4.401781325417599e-05, "num_agent_steps_sampled": {"default_agent": 5000.0}, "episode_len_min": 50, "env_to_module_connector": {"timers": {"connectors": {"add_observations_from_episodes_to_batch": 6.531726694374109e-06, "numpy_to_tensor": 3.128026857550188e-05, "add_states_from_episodes_to_batch": 3.450240063285934e-06, "add_time_dim_to_batch_and_zero_pad": 6.362215166187243e-06, "batch_individual_items": 1.847187865945053e-05}}, "connector_pipeline_timer": 0.00011868657737406599}, "episode_return_min": -5.5, "env_to_module_sum_episodes_length_in": 27.16809333212661, "num_episodes": 100.0, "weights_seq_no": 12.0, "episode_return_max": 14.5, "num_episodes_lifetime": -53150.0, "episode_duration_sec_mean": 0.036318058999959255, "episode_len_max": 50, "num_agent_steps_sampled_lifetime": {"default_agent": -2657500.0}, "time_between_sampling": 0.012292561647748034, "num_module_steps_sampled": {"default_policy": 5000.0}, "rlmodule_inference_timer": 9.895481492481353e-05, "num_env_steps_sampled": 5000.0, "episode_len_mean": 50.0, "env_reset_timer": 9.391159669207694e-05, "num_module_steps_sampled_lifetime": {"default_policy": -2657500.0}, "env_to_module_sum_episodes_length_out": 27.16809333212661, "sample": 0.037399676579582965, "module_episode_returns_mean": {"default_policy": 2.899999999999998}, "num_env_steps_sampled_lifetime_throughput": 1285.8137346694389}, "learners": {"__all_modules__": {"learner_connector_sum_episodes_length_out": 5100.0, "learner_connector": {"connector_pipeline_timer": 0.29587386388649584, "timers": {"connectors": {"general_advantage_estimation": 0.013991897386088676, "add_time_dim_to_batch_and_zero_pad": 2.454982472691646e-05, "batch_individual_items": 0.20192699965114663, "numpy_to_tensor": 0.0002229607309611474, "add_one_ts_to_episodes_and_truncate": 0.008703636511885587, "add_columns_from_episodes_to_train_batch": 0.06984132775133124, "add_observations_from_episodes_to_batch": 0.0007836030010951469, "add_states_from_episodes_to_batch": 6.089382809693447e-06}}}, "num_env_steps_trained": 30600, "num_env_steps_trained_lifetime": 397800, "num_module_steps_trained_lifetime": 78000, "num_trainable_parameters": 4965, "num_module_steps_trained": 6000, "num_non_trainable_parameters": 0, "learner_connector_sum_episodes_length_in": 5000.0, "num_env_steps_trained_lifetime_throughput": 871996.8544036368, "num_module_steps_trained_throughput": 171611.7896373122, "num_module_steps_trained_lifetime_throughput": 171542.06307231938}, "default_policy": {"diff_num_grad_updates_vs_sampler_policy": 1.0, "vf_explained_var": 0.049054503440856934, "curr_kl_coeff": 0.6865592002868652, "num_module_steps_trained_lifetime": 78000, "entropy": 0.6670714616775513, "num_trainable_parameters": 4965, "num_module_steps_trained": 6000, "default_optimizer_learning_rate": 0.0602050062423, "weights_seq_no": 13.0, "mean_kl_loss": 0.061078332364559174, "vf_loss": 0.10591369867324829, "vf_loss_unclipped": 25.285335540771484, "module_train_batch_size_mean": 1000.0, "curr_entropy_coeff": 0.0304386028221, "total_loss": 0.1670399308204651, "gradients_default_optimizer_global_norm": 2.0127499103546143, "policy_loss": 0.1033889576792717, "num_module_steps_trained_lifetime_throughput": 171868.50538695802}}, "num_training_step_calls_per_iteration": 1, "evaluation": {"env_runners": {"rlmodule_inference_timer": 9.52138605255716e-05, "env_to_module_sum_episodes_length_out": 27.168093332126602, "sample": 0.7344040224110759, "module_episode_returns_mean": {"default_policy": 0.5}, "episode_return_mean": 0.5, "num_agent_steps_sampled": {"default_agent": 1000}, "module_to_env_connector": {"timers": {"connectors": {"un_batch_to_individual_items": 1.5644740504456627e-05, "remove_single_ts_time_rank_from_batch": 1.4959780942115083e-06, "get_actions": 0.00015504926033603025, "normalize_and_clip_actions": 2.3207759558823956e-05, "tensor_to_numpy": 4.455131620831222e-05, "listify_data_for_vector_env": 3.106666860900653e-05}}, "connector_pipeline_timer": 0.00034550691853163333}, "env_step_timer": 4.195402380901162e-05, "env_to_module_connector": {"timers": {"connectors": {"add_observations_from_episodes_to_batch": 6.134669700818118e-06, "add_states_from_episodes_to_batch": 3.3822810369767984e-06, "add_time_dim_to_batch_and_zero_pad": 5.69078101344437e-06, "batch_individual_items": 1.8045515914470756e-05, "numpy_to_tensor": 2.978842053388366e-05}}, "connector_pipeline_timer": 0.00011437191108180588}, "num_episodes": 20, "episode_return_max": 17.5, "env_reset_timer": 0.0002083094235624749, "weights_seq_no": 13.0, "episode_len_max": 50, "num_module_steps_sampled": {"default_policy": 1000}, "num_env_steps_sampled": 1000, "num_env_steps_sampled_lifetime": 66000, "agent_episode_returns_mean": {"default_agent": 0.5}, "episode_len_min": 50, "num_episodes_lifetime": 260, "episode_duration_sec_mean": 0.035323702010036866, "num_agent_steps_sampled_lifetime": {"default_agent": 13000}, "episode_len_mean": 50.0, "num_module_steps_sampled_lifetime": {"default_policy": 13000}, "episode_return_min": -16.5, "env_to_module_sum_episodes_length_in": 27.168093332126602, "time_between_sampling": 4.141974471395972}, "num_healthy_workers": 1, "actor_manager_num_outstanding_async_reqs": 0, "num_remote_worker_restarts": 0}, "num_env_steps_sampled_lifetime": -2657500.0, "fault_tolerance": {"num_healthy_workers": 0, "num_remote_worker_restarts": 0}, "env_runner_group": {"actor_manager_num_outstanding_async_reqs": 0}, "done": false, "training_iteration": 13, "trial_id": "148fb_00000", "date": "2025-08-11_17-50-51", "timestamp": 1754927451, "time_this_iter_s": 4.824931383132935, "time_total_s": 64.02079105377197, "pid": 97502, "hostname": "DESKTOP-3SK5A41", "node_ip": "192.168.40.242", "config": {"exploration_config": {}, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 6, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "env": "Umbrella", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": false, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 0, "create_local_env_runner": true, "num_envs_per_env_runner": 1, "gym_env_vectorize_mode": "SYNC", "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "episodes_to_numpy": true, "max_requests_in_flight_per_env_runner": 1, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "merge_env_runner_states": "training_only", "broadcast_env_runner_states": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "complete_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "sampler_perf_stats_ema_coef": null, "_is_online": true, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": "auto", "num_aggregator_actors_per_learner": 0, "max_requests_in_flight_per_aggregator_actor": 3, "local_gpu_idx": 0, "max_requests_in_flight_per_learner": 3, "gamma": 1, "lr": 0.0602050062423, "grad_clip": 0.5, "grad_clip_by": "global_norm", "_train_batch_size_per_learner": 5000, "train_batch_size": 4000, "num_epochs": 1, "minibatch_size": 1000, "shuffle_batch_per_epoch": true, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "log_std_clip_param": 20.0, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "_disable_preprocessor_api": false, "_disable_action_flattening": false}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "_learner_class": null, "callbacks_on_algorithm_init": null, "callbacks_on_env_runners_recreated": null, "callbacks_on_offline_eval_runners_recreated": null, "callbacks_on_checkpoint_loaded": null, "callbacks_on_environment_created": null, "callbacks_on_episode_created": null, "callbacks_on_episode_start": null, "callbacks_on_episode_step": null, "callbacks_on_episode_end": null, "callbacks_on_evaluate_start": null, "callbacks_on_evaluate_end": null, "callbacks_on_evaluate_offline_start": null, "callbacks_on_evaluate_offline_end": null, "callbacks_on_sample_end": null, "callbacks_on_train_result": null, "explore": true, "enable_rl_module_and_learner": true, "enable_env_runner_and_connector_v2": true, "_prior_exploration_config": {"type": "StochasticSampling"}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7f830969eac0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "offline_data_class": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_read_batch_size": null, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "materialize_data": false, "materialize_mapped_data": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "ignore_final_observation": false, "prelearner_class": null, "prelearner_buffer_class": null, "prelearner_buffer_kwargs": {}, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_remaining_data": false, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": 1, "evaluation_duration": 20, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_auto_duration_min_env_steps_per_sample": 100, "evaluation_auto_duration_max_env_steps_per_sample": 2000, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 1, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "offline_evaluation_interval": null, "num_offline_eval_runners": 0, "offline_loss_for_module_fn": null, "offline_evaluation_duration": 1, "offline_evaluation_parallel_to_training": false, "offline_evaluation_timeout_s": 120.0, "num_cpus_per_offline_eval_runner": 1, "num_gpus_per_offline_eval_runner": 0, "custom_resources_per_offline_eval_runner": {}, "restart_failed_offline_eval_runners": true, "ignore_offline_eval_runner_failures": false, "max_num_offline_eval_runner_restarts": 1000, "offline_eval_runner_restore_timeout_s": 1800.0, "max_requests_in_flight_per_offline_eval_runner": 1, "validate_offline_eval_runners_after_construction": true, "offline_eval_runner_health_probe_timeout_s": 30.0, "offline_eval_rl_module_inference_only": false, "broadcast_offline_eval_runner_states": false, "offline_eval_batch_size_per_runner": 256, "dataset_num_iters_per_eval_runner": 1, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "log_gradients": true, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 42, "restart_failed_env_runners": true, "ignore_env_runner_failures": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30.0, "env_runner_restore_timeout_s": 1800.0, "_model_config": {}, "_rl_module_spec": "RLModuleSpec(module_class=None, observation_space=None, action_space=None, inference_only=False, learner_only=False, model_config=DefaultModelConfig(fcnet_hiddens=[127, 34], fcnet_activation='tanh', fcnet_kernel_initializer=None, fcnet_kernel_initializer_kwargs=None, fcnet_bias_initializer=None, fcnet_bias_initializer_kwargs=None, conv_filters=None, conv_activation='relu', conv_kernel_initializer=None, conv_kernel_initializer_kwargs=None, conv_bias_initializer=None, conv_bias_initializer_kwargs=None, head_fcnet_hiddens=[], head_fcnet_activation='relu', head_fcnet_kernel_initializer=None, head_fcnet_kernel_initializer_kwargs=None, head_fcnet_bias_initializer=None, head_fcnet_bias_initializer_kwargs=None, free_log_std=False, log_std_clip_param=20.0, vf_share_layers=True, use_lstm=False, max_seq_len=20, lstm_cell_size=256, lstm_use_prev_action=False, lstm_use_prev_reward=False, lstm_kernel_initializer=None, lstm_kernel_initializer_kwargs=None, lstm_bias_initializer=None, lstm_bias_initializer_kwargs=None), catalog_class=None, load_state_path=None, model_config_dict=None)", "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "_validate_config": true, "_use_msgpack_checkpoints": false, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "env_task_fn": -1, "enable_connectors": -1, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.4821924166921, "kl_target": 0.0121335369454, "vf_loss_coeff": 0.5287301420718, "entropy_coeff": 0.0304386028221, "clip_param": 0.2973082591601, "vf_clip_param": 0.1116643404955, "entropy_coeff_schedule": null, "lr_schedule": null, "sgd_minibatch_size": -1, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9313529170176, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.callbacks.callbacks.RLlibCallback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 64.02079105377197, "iterations_since_restore": 13, "perf": {"cpu_util_percent": 12.816666666666668, "ram_util_percent": 83.3}}
{"timers": {"training_iteration": 4.314041642675586, "restore_env_runners": 1.6763409109046782e-05, "training_step": 4.31377657575889, "env_runner_sampling_timer": 3.902357271903624, "learner_update_timer": 0.40800193789514966, "synch_weights": 0.001434067931992012, "restore_eval_env_runners": 1.3167076826839335e-05, "evaluation_iteration": 0.7462837669527846, "synch_eval_env_connectors": 0.0004502572820928686, "synch_env_connectors": 9.178844291565303e-06}, "env_runners": {"module_to_env_connector": {"timers": {"connectors": {"remove_single_ts_time_rank_from_batch": 1.4137198693502516e-06, "get_actions": 0.00016186001762779907, "tensor_to_numpy": 4.8493055854869955e-05, "normalize_and_clip_actions": 2.2505647638501017e-05, "un_batch_to_individual_items": 1.5085078111637337e-05, "listify_data_for_vector_env": 3.122692688964228e-05}}, "connector_pipeline_timer": 0.0003574462616088113}, "num_env_steps_sampled_lifetime": -2900000.0, "agent_episode_returns_mean": {"default_agent": 7.299999999999996}, "episode_return_mean": 7.299999999999996, "env_step_timer": 4.4077717188108365e-05, "num_agent_steps_sampled": {"default_agent": 5000.0}, "episode_len_min": 50, "env_to_module_connector": {"timers": {"connectors": {"add_observations_from_episodes_to_batch": 6.571919969890542e-06, "numpy_to_tensor": 3.1194085073588446e-05, "add_states_from_episodes_to_batch": 3.489748699531588e-06, "add_time_dim_to_batch_and_zero_pad": 6.4183331404319194e-06, "batch_individual_items": 1.8525008348885375e-05}}, "connector_pipeline_timer": 0.00011913860995448773}, "episode_return_min": -5.5, "env_to_module_sum_episodes_length_in": 27.16809333212661, "num_episodes": 100.0, "weights_seq_no": 13.0, "episode_return_max": 14.5, "num_episodes_lifetime": -58000.0, "episode_duration_sec_mean": 0.03636573700994633, "episode_len_max": 50, "num_agent_steps_sampled_lifetime": {"default_agent": -2900000.0}, "time_between_sampling": 0.011613881147021396, "num_module_steps_sampled": {"default_policy": 5000.0}, "rlmodule_inference_timer": 9.947005961356033e-05, "num_env_steps_sampled": 5000.0, "episode_len_mean": 50.0, "env_reset_timer": 9.373446231337441e-05, "num_module_steps_sampled_lifetime": {"default_policy": -2900000.0}, "env_to_module_sum_episodes_length_out": 27.16809333212661, "sample": 0.037426322366372444, "module_episode_returns_mean": {"default_policy": 7.299999999999996}, "num_env_steps_sampled_lifetime_throughput": 1284.2397654575252}, "learners": {"__all_modules__": {"learner_connector_sum_episodes_length_out": 5100.0, "learner_connector": {"connector_pipeline_timer": 0.2958231902476323, "timers": {"connectors": {"general_advantage_estimation": 0.013957494412231052, "add_time_dim_to_batch_and_zero_pad": 2.453032648157781e-05, "batch_individual_items": 0.201926932654635, "numpy_to_tensor": 0.00022239812364835033, "add_one_ts_to_episodes_and_truncate": 0.008700013146768841, "add_columns_from_episodes_to_train_batch": 0.06983085247381887, "add_observations_from_episodes_to_batch": 0.0007828059710860914, "add_states_from_episodes_to_batch": 6.0794889788529525e-06}}}, "num_env_steps_trained": 30600, "num_env_steps_trained_lifetime": 428400, "num_module_steps_trained_lifetime": 84000, "num_trainable_parameters": 4965, "num_module_steps_trained": 6000, "num_non_trainable_parameters": 0, "learner_connector_sum_episodes_length_in": 5000.0, "num_env_steps_trained_lifetime_throughput": 869209.7765584073, "num_module_steps_trained_throughput": 171047.56296421422, "num_module_steps_trained_lifetime_throughput": 170975.17355955168}, "default_policy": {"diff_num_grad_updates_vs_sampler_policy": 1.0, "vf_explained_var": 0.17261821031570435, "curr_kl_coeff": 0.3432796001434326, "num_module_steps_trained_lifetime": 84000, "entropy": 0.6558497548103333, "num_trainable_parameters": 4965, "num_module_steps_trained": 6000, "default_optimizer_learning_rate": 0.0602050062423, "weights_seq_no": 14.0, "mean_kl_loss": 0.005020750220865011, "vf_loss": 0.09810861945152283, "vf_loss_unclipped": 18.941286087036133, "module_train_batch_size_mean": 1000.0, "curr_entropy_coeff": 0.0304386028221, "total_loss": 0.1559220403432846, "gradients_default_optimizer_global_norm": 0.06099790334701538, "policy_loss": 0.12056517601013184, "num_module_steps_trained_lifetime_throughput": 171279.89213745212}}, "num_training_step_calls_per_iteration": 1, "evaluation": {"env_runners": {"rlmodule_inference_timer": 9.485422744503401e-05, "env_to_module_sum_episodes_length_out": 27.168093332126602, "sample": 0.734397559196968, "module_episode_returns_mean": {"default_policy": 0.3}, "episode_return_mean": 0.3, "num_agent_steps_sampled": {"default_agent": 1000}, "module_to_env_connector": {"timers": {"connectors": {"un_batch_to_individual_items": 1.5286368040537895e-05, "remove_single_ts_time_rank_from_batch": 1.4356267792949554e-06, "get_actions": 0.00015362827834350382, "normalize_and_clip_actions": 2.2427643921643065e-05, "tensor_to_numpy": 4.4657241272105806e-05, "listify_data_for_vector_env": 3.0541526417193254e-05}}, "connector_pipeline_timer": 0.0003415340505383727}, "env_step_timer": 4.174509916936201e-05, "env_to_module_connector": {"timers": {"connectors": {"add_observations_from_episodes_to_batch": 6.160457589352254e-06, "add_states_from_episodes_to_batch": 3.373679743838488e-06, "add_time_dim_to_batch_and_zero_pad": 5.692203963681729e-06, "batch_individual_items": 1.8239284984203827e-05, "numpy_to_tensor": 2.9637691800751173e-05}}, "connector_pipeline_timer": 0.0001148677736472688}, "num_episodes": 20, "episode_return_max": 17.5, "env_reset_timer": 0.00020745932932953514, "weights_seq_no": 14.0, "episode_len_max": 50, "num_module_steps_sampled": {"default_policy": 1000}, "num_env_steps_sampled": 1000, "num_env_steps_sampled_lifetime": 71000, "agent_episode_returns_mean": {"default_agent": 0.3}, "episode_len_min": 50, "num_episodes_lifetime": 280, "episode_duration_sec_mean": 0.03524949701999503, "num_agent_steps_sampled_lifetime": {"default_agent": 14000}, "episode_len_mean": 50.0, "num_module_steps_sampled_lifetime": {"default_policy": 14000}, "episode_return_min": -16.5, "env_to_module_sum_episodes_length_in": 27.168093332126602, "time_between_sampling": 4.143332319692017}, "num_healthy_workers": 1, "actor_manager_num_outstanding_async_reqs": 0, "num_remote_worker_restarts": 0}, "num_env_steps_sampled_lifetime": -2900000.0, "fault_tolerance": {"num_healthy_workers": 0, "num_remote_worker_restarts": 0}, "env_runner_group": {"actor_manager_num_outstanding_async_reqs": 0}, "done": false, "training_iteration": 14, "trial_id": "148fb_00000", "date": "2025-08-11_17-50-56", "timestamp": 1754927456, "time_this_iter_s": 4.9705810546875, "time_total_s": 68.99137210845947, "pid": 97502, "hostname": "DESKTOP-3SK5A41", "node_ip": "192.168.40.242", "config": {"exploration_config": {}, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 6, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "env": "Umbrella", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": false, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 0, "create_local_env_runner": true, "num_envs_per_env_runner": 1, "gym_env_vectorize_mode": "SYNC", "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "episodes_to_numpy": true, "max_requests_in_flight_per_env_runner": 1, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "merge_env_runner_states": "training_only", "broadcast_env_runner_states": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "complete_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "sampler_perf_stats_ema_coef": null, "_is_online": true, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": "auto", "num_aggregator_actors_per_learner": 0, "max_requests_in_flight_per_aggregator_actor": 3, "local_gpu_idx": 0, "max_requests_in_flight_per_learner": 3, "gamma": 1, "lr": 0.0602050062423, "grad_clip": 0.5, "grad_clip_by": "global_norm", "_train_batch_size_per_learner": 5000, "train_batch_size": 4000, "num_epochs": 1, "minibatch_size": 1000, "shuffle_batch_per_epoch": true, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "log_std_clip_param": 20.0, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "_disable_preprocessor_api": false, "_disable_action_flattening": false}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "_learner_class": null, "callbacks_on_algorithm_init": null, "callbacks_on_env_runners_recreated": null, "callbacks_on_offline_eval_runners_recreated": null, "callbacks_on_checkpoint_loaded": null, "callbacks_on_environment_created": null, "callbacks_on_episode_created": null, "callbacks_on_episode_start": null, "callbacks_on_episode_step": null, "callbacks_on_episode_end": null, "callbacks_on_evaluate_start": null, "callbacks_on_evaluate_end": null, "callbacks_on_evaluate_offline_start": null, "callbacks_on_evaluate_offline_end": null, "callbacks_on_sample_end": null, "callbacks_on_train_result": null, "explore": true, "enable_rl_module_and_learner": true, "enable_env_runner_and_connector_v2": true, "_prior_exploration_config": {"type": "StochasticSampling"}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7f830969eac0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "offline_data_class": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_read_batch_size": null, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "materialize_data": false, "materialize_mapped_data": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "ignore_final_observation": false, "prelearner_class": null, "prelearner_buffer_class": null, "prelearner_buffer_kwargs": {}, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_remaining_data": false, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": 1, "evaluation_duration": 20, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_auto_duration_min_env_steps_per_sample": 100, "evaluation_auto_duration_max_env_steps_per_sample": 2000, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 1, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "offline_evaluation_interval": null, "num_offline_eval_runners": 0, "offline_loss_for_module_fn": null, "offline_evaluation_duration": 1, "offline_evaluation_parallel_to_training": false, "offline_evaluation_timeout_s": 120.0, "num_cpus_per_offline_eval_runner": 1, "num_gpus_per_offline_eval_runner": 0, "custom_resources_per_offline_eval_runner": {}, "restart_failed_offline_eval_runners": true, "ignore_offline_eval_runner_failures": false, "max_num_offline_eval_runner_restarts": 1000, "offline_eval_runner_restore_timeout_s": 1800.0, "max_requests_in_flight_per_offline_eval_runner": 1, "validate_offline_eval_runners_after_construction": true, "offline_eval_runner_health_probe_timeout_s": 30.0, "offline_eval_rl_module_inference_only": false, "broadcast_offline_eval_runner_states": false, "offline_eval_batch_size_per_runner": 256, "dataset_num_iters_per_eval_runner": 1, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "log_gradients": true, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 42, "restart_failed_env_runners": true, "ignore_env_runner_failures": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30.0, "env_runner_restore_timeout_s": 1800.0, "_model_config": {}, "_rl_module_spec": "RLModuleSpec(module_class=None, observation_space=None, action_space=None, inference_only=False, learner_only=False, model_config=DefaultModelConfig(fcnet_hiddens=[127, 34], fcnet_activation='tanh', fcnet_kernel_initializer=None, fcnet_kernel_initializer_kwargs=None, fcnet_bias_initializer=None, fcnet_bias_initializer_kwargs=None, conv_filters=None, conv_activation='relu', conv_kernel_initializer=None, conv_kernel_initializer_kwargs=None, conv_bias_initializer=None, conv_bias_initializer_kwargs=None, head_fcnet_hiddens=[], head_fcnet_activation='relu', head_fcnet_kernel_initializer=None, head_fcnet_kernel_initializer_kwargs=None, head_fcnet_bias_initializer=None, head_fcnet_bias_initializer_kwargs=None, free_log_std=False, log_std_clip_param=20.0, vf_share_layers=True, use_lstm=False, max_seq_len=20, lstm_cell_size=256, lstm_use_prev_action=False, lstm_use_prev_reward=False, lstm_kernel_initializer=None, lstm_kernel_initializer_kwargs=None, lstm_bias_initializer=None, lstm_bias_initializer_kwargs=None), catalog_class=None, load_state_path=None, model_config_dict=None)", "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "_validate_config": true, "_use_msgpack_checkpoints": false, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "env_task_fn": -1, "enable_connectors": -1, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.4821924166921, "kl_target": 0.0121335369454, "vf_loss_coeff": 0.5287301420718, "entropy_coeff": 0.0304386028221, "clip_param": 0.2973082591601, "vf_clip_param": 0.1116643404955, "entropy_coeff_schedule": null, "lr_schedule": null, "sgd_minibatch_size": -1, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9313529170176, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.callbacks.callbacks.RLlibCallback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 68.99137210845947, "iterations_since_restore": 14, "perf": {"cpu_util_percent": 12.625, "ram_util_percent": 83.3875}}
{"timers": {"training_iteration": 4.312123327268833, "restore_env_runners": 1.670977502198859e-05, "training_step": 4.3118576150212995, "env_runner_sampling_timer": 3.902628843194581, "learner_update_timer": 0.4058035745261985, "synch_weights": 0.00143409525266492, "restore_eval_env_runners": 1.3136406054564275e-05, "evaluation_iteration": 0.7462555382932539, "synch_eval_env_connectors": 0.0004496147092781105, "synch_env_connectors": 9.153055850984126e-06}, "env_runners": {"module_to_env_connector": {"timers": {"connectors": {"remove_single_ts_time_rank_from_batch": 1.4194120094439447e-06, "get_actions": 0.00016321544869269276, "tensor_to_numpy": 4.879656400313129e-05, "normalize_and_clip_actions": 2.2674621848801097e-05, "un_batch_to_individual_items": 1.5206565902694518e-05, "listify_data_for_vector_env": 3.145742209001449e-05}}, "connector_pipeline_timer": 0.0003601099914008992}, "num_env_steps_sampled_lifetime": -3142500.0, "agent_episode_returns_mean": {"default_agent": 8.299999999999997}, "episode_return_mean": 8.299999999999997, "env_step_timer": 4.4476659123263306e-05, "num_agent_steps_sampled": {"default_agent": 5000.0}, "episode_len_min": 50, "env_to_module_connector": {"timers": {"connectors": {"add_observations_from_episodes_to_batch": 6.617687310928977e-06, "numpy_to_tensor": 3.1524087654181715e-05, "add_states_from_episodes_to_batch": 3.5318213179233573e-06, "add_time_dim_to_batch_and_zero_pad": 6.480131149054339e-06, "batch_individual_items": 1.870510378296398e-05}}, "connector_pipeline_timer": 0.0001203281093910642}, "episode_return_min": -5.5, "env_to_module_sum_episodes_length_in": 27.16809333212661, "num_episodes": 100.0, "weights_seq_no": 14.0, "episode_return_max": 14.5, "num_episodes_lifetime": -62850.0, "episode_duration_sec_mean": 0.03667268400997273, "episode_len_max": 50, "num_agent_steps_sampled_lifetime": {"default_agent": -3142500.0}, "time_between_sampling": 0.01229476514387068, "num_module_steps_sampled": {"default_policy": 5000.0}, "rlmodule_inference_timer": 0.00010038923098869902, "num_env_steps_sampled": 5000.0, "episode_len_mean": 50.0, "env_reset_timer": 9.451894997867288e-05, "num_module_steps_sampled_lifetime": {"default_policy": -3142500.0}, "env_to_module_sum_episodes_length_out": 27.16809333212661, "sample": 0.03754599312053705, "module_episode_returns_mean": {"default_policy": 8.299999999999997}, "num_env_steps_sampled_lifetime_throughput": 1277.0307145506322}, "learners": {"__all_modules__": {"learner_connector_sum_episodes_length_out": 5100.0, "learner_connector": {"connector_pipeline_timer": 0.2943962083551586, "timers": {"connectors": {"general_advantage_estimation": 0.013928742468113271, "add_time_dim_to_batch_and_zero_pad": 2.4679023215539902e-05, "batch_individual_items": 0.20049463633808345, "numpy_to_tensor": 0.00022183914241164215, "add_one_ts_to_episodes_and_truncate": 0.008701967015294618, "add_columns_from_episodes_to_train_batch": 0.06986419994907879, "add_observations_from_episodes_to_batch": 0.0007823179113771625, "add_states_from_episodes_to_batch": 6.117694088018664e-06}}}, "num_env_steps_trained": 30600, "num_env_steps_trained_lifetime": 459000, "num_module_steps_trained_lifetime": 90000, "num_trainable_parameters": 4965, "num_module_steps_trained": 6000, "num_non_trainable_parameters": 0, "learner_connector_sum_episodes_length_in": 5000.0, "num_env_steps_trained_lifetime_throughput": 866477.7953589762, "num_module_steps_trained_throughput": 170491.37919969787, "num_module_steps_trained_lifetime_throughput": 170416.80819450621}, "default_policy": {"diff_num_grad_updates_vs_sampler_policy": 1.0, "vf_explained_var": 0.36492013931274414, "curr_kl_coeff": 0.1716398000717163, "num_module_steps_trained_lifetime": 90000, "entropy": 0.6304357647895813, "num_trainable_parameters": 4965, "num_module_steps_trained": 6000, "default_optimizer_learning_rate": 0.0602050062423, "weights_seq_no": 15.0, "mean_kl_loss": 0.00217934581451118, "vf_loss": 0.11166432499885559, "vf_loss_unclipped": 48.84650802612305, "module_train_batch_size_mean": 1000.0, "curr_entropy_coeff": 0.0304386028221, "total_loss": 0.28533828258514404, "gradients_default_optimizer_global_norm": 0.05645327270030975, "policy_loss": 0.24473945796489716, "num_module_steps_trained_lifetime_throughput": 170702.58861422294}}, "num_training_step_calls_per_iteration": 1, "evaluation": {"env_runners": {"rlmodule_inference_timer": 9.562720700600985e-05, "env_to_module_sum_episodes_length_out": 27.168093332126602, "sample": 0.7344674086049926, "module_episode_returns_mean": {"default_policy": 0.5}, "episode_return_mean": 0.5, "num_agent_steps_sampled": {"default_agent": 1000}, "module_to_env_connector": {"timers": {"connectors": {"un_batch_to_individual_items": 1.610772611408911e-05, "remove_single_ts_time_rank_from_batch": 1.45347332253089e-06, "get_actions": 0.00015644253368249364, "normalize_and_clip_actions": 2.2345054566821565e-05, "tensor_to_numpy": 4.5116561951689934e-05, "listify_data_for_vector_env": 3.054602685381166e-05}}, "connector_pipeline_timer": 0.00034656650709537196}, "env_step_timer": 4.181159416996819e-05, "env_to_module_connector": {"timers": {"connectors": {"add_observations_from_episodes_to_batch": 6.348375220917877e-06, "add_states_from_episodes_to_batch": 3.6113876228845252e-06, "add_time_dim_to_batch_and_zero_pad": 5.777264166515285e-06, "batch_individual_items": 1.831444706828895e-05, "numpy_to_tensor": 3.0351274242105077e-05}}, "connector_pipeline_timer": 0.00011635347321923164}, "num_episodes": 20, "episode_return_max": 17.5, "env_reset_timer": 0.00020681673603535283, "weights_seq_no": 15.0, "episode_len_max": 50, "num_module_steps_sampled": {"default_policy": 1000}, "num_env_steps_sampled": 1000, "num_env_steps_sampled_lifetime": 76000, "agent_episode_returns_mean": {"default_agent": 0.5}, "episode_len_min": 50, "num_episodes_lifetime": 300, "episode_duration_sec_mean": 0.03531250400999852, "num_agent_steps_sampled_lifetime": {"default_agent": 15000}, "episode_len_mean": 50.0, "num_module_steps_sampled_lifetime": {"default_policy": 15000}, "episode_return_min": -16.5, "env_to_module_sum_episodes_length_in": 27.168093332126602, "time_between_sampling": 4.143686879515093}, "num_healthy_workers": 1, "actor_manager_num_outstanding_async_reqs": 0, "num_remote_worker_restarts": 0}, "num_env_steps_sampled_lifetime": -3142500.0, "fault_tolerance": {"num_healthy_workers": 0, "num_remote_worker_restarts": 0}, "env_runner_group": {"actor_manager_num_outstanding_async_reqs": 0}, "done": false, "training_iteration": 15, "trial_id": "148fb_00000", "date": "2025-08-11_17-51-01", "timestamp": 1754927461, "time_this_iter_s": 4.87870717048645, "time_total_s": 73.87007927894592, "pid": 97502, "hostname": "DESKTOP-3SK5A41", "node_ip": "192.168.40.242", "config": {"exploration_config": {}, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 6, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "env": "Umbrella", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": false, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 0, "create_local_env_runner": true, "num_envs_per_env_runner": 1, "gym_env_vectorize_mode": "SYNC", "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "episodes_to_numpy": true, "max_requests_in_flight_per_env_runner": 1, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "merge_env_runner_states": "training_only", "broadcast_env_runner_states": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "complete_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "sampler_perf_stats_ema_coef": null, "_is_online": true, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": "auto", "num_aggregator_actors_per_learner": 0, "max_requests_in_flight_per_aggregator_actor": 3, "local_gpu_idx": 0, "max_requests_in_flight_per_learner": 3, "gamma": 1, "lr": 0.0602050062423, "grad_clip": 0.5, "grad_clip_by": "global_norm", "_train_batch_size_per_learner": 5000, "train_batch_size": 4000, "num_epochs": 1, "minibatch_size": 1000, "shuffle_batch_per_epoch": true, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "log_std_clip_param": 20.0, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "_disable_preprocessor_api": false, "_disable_action_flattening": false}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "_learner_class": null, "callbacks_on_algorithm_init": null, "callbacks_on_env_runners_recreated": null, "callbacks_on_offline_eval_runners_recreated": null, "callbacks_on_checkpoint_loaded": null, "callbacks_on_environment_created": null, "callbacks_on_episode_created": null, "callbacks_on_episode_start": null, "callbacks_on_episode_step": null, "callbacks_on_episode_end": null, "callbacks_on_evaluate_start": null, "callbacks_on_evaluate_end": null, "callbacks_on_evaluate_offline_start": null, "callbacks_on_evaluate_offline_end": null, "callbacks_on_sample_end": null, "callbacks_on_train_result": null, "explore": true, "enable_rl_module_and_learner": true, "enable_env_runner_and_connector_v2": true, "_prior_exploration_config": {"type": "StochasticSampling"}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7f830969eac0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "offline_data_class": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_read_batch_size": null, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "materialize_data": false, "materialize_mapped_data": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "ignore_final_observation": false, "prelearner_class": null, "prelearner_buffer_class": null, "prelearner_buffer_kwargs": {}, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_remaining_data": false, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": 1, "evaluation_duration": 20, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_auto_duration_min_env_steps_per_sample": 100, "evaluation_auto_duration_max_env_steps_per_sample": 2000, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 1, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "offline_evaluation_interval": null, "num_offline_eval_runners": 0, "offline_loss_for_module_fn": null, "offline_evaluation_duration": 1, "offline_evaluation_parallel_to_training": false, "offline_evaluation_timeout_s": 120.0, "num_cpus_per_offline_eval_runner": 1, "num_gpus_per_offline_eval_runner": 0, "custom_resources_per_offline_eval_runner": {}, "restart_failed_offline_eval_runners": true, "ignore_offline_eval_runner_failures": false, "max_num_offline_eval_runner_restarts": 1000, "offline_eval_runner_restore_timeout_s": 1800.0, "max_requests_in_flight_per_offline_eval_runner": 1, "validate_offline_eval_runners_after_construction": true, "offline_eval_runner_health_probe_timeout_s": 30.0, "offline_eval_rl_module_inference_only": false, "broadcast_offline_eval_runner_states": false, "offline_eval_batch_size_per_runner": 256, "dataset_num_iters_per_eval_runner": 1, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "log_gradients": true, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 42, "restart_failed_env_runners": true, "ignore_env_runner_failures": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30.0, "env_runner_restore_timeout_s": 1800.0, "_model_config": {}, "_rl_module_spec": "RLModuleSpec(module_class=None, observation_space=None, action_space=None, inference_only=False, learner_only=False, model_config=DefaultModelConfig(fcnet_hiddens=[127, 34], fcnet_activation='tanh', fcnet_kernel_initializer=None, fcnet_kernel_initializer_kwargs=None, fcnet_bias_initializer=None, fcnet_bias_initializer_kwargs=None, conv_filters=None, conv_activation='relu', conv_kernel_initializer=None, conv_kernel_initializer_kwargs=None, conv_bias_initializer=None, conv_bias_initializer_kwargs=None, head_fcnet_hiddens=[], head_fcnet_activation='relu', head_fcnet_kernel_initializer=None, head_fcnet_kernel_initializer_kwargs=None, head_fcnet_bias_initializer=None, head_fcnet_bias_initializer_kwargs=None, free_log_std=False, log_std_clip_param=20.0, vf_share_layers=True, use_lstm=False, max_seq_len=20, lstm_cell_size=256, lstm_use_prev_action=False, lstm_use_prev_reward=False, lstm_kernel_initializer=None, lstm_kernel_initializer_kwargs=None, lstm_bias_initializer=None, lstm_bias_initializer_kwargs=None), catalog_class=None, load_state_path=None, model_config_dict=None)", "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "_validate_config": true, "_use_msgpack_checkpoints": false, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "env_task_fn": -1, "enable_connectors": -1, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.4821924166921, "kl_target": 0.0121335369454, "vf_loss_coeff": 0.5287301420718, "entropy_coeff": 0.0304386028221, "clip_param": 0.2973082591601, "vf_clip_param": 0.1116643404955, "entropy_coeff_schedule": null, "lr_schedule": null, "sgd_minibatch_size": -1, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9313529170176, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.callbacks.callbacks.RLlibCallback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 73.87007927894592, "iterations_since_restore": 15, "perf": {"cpu_util_percent": 13.928571428571429, "ram_util_percent": 83.39999999999999}}
{"timers": {"training_iteration": 4.311697621036149, "restore_env_runners": 1.6654677269666944e-05, "training_step": 4.311431234911084, "env_runner_sampling_timer": 3.902969519802634, "learner_update_timer": 0.40503408678093694, "synch_weights": 0.0014345013001338938, "restore_eval_env_runners": 1.3114041996358231e-05, "evaluation_iteration": 0.7463070239103253, "synch_eval_env_connectors": 0.000450715562193822, "synch_env_connectors": 9.128525293328307e-06}, "env_runners": {"module_to_env_connector": {"timers": {"connectors": {"remove_single_ts_time_rank_from_batch": 1.453865401818254e-06, "get_actions": 0.00016341464338603216, "tensor_to_numpy": 4.9235990155912345e-05, "normalize_and_clip_actions": 2.2687303233530094e-05, "un_batch_to_individual_items": 1.5293056782324767e-05, "listify_data_for_vector_env": 3.1425485380406954e-05}}, "connector_pipeline_timer": 0.0003612651816891484}, "num_env_steps_sampled_lifetime": -3385000.0, "agent_episode_returns_mean": {"default_agent": 8.9}, "episode_return_mean": 8.9, "env_step_timer": 4.4440121938959514e-05, "num_agent_steps_sampled": {"default_agent": 5000.0}, "episode_len_min": 50, "env_to_module_connector": {"timers": {"connectors": {"add_observations_from_episodes_to_batch": 6.6680389662421985e-06, "numpy_to_tensor": 3.15192625622971e-05, "add_states_from_episodes_to_batch": 3.5753727748365334e-06, "add_time_dim_to_batch_and_zero_pad": 6.565070530611653e-06, "batch_individual_items": 1.878814581198088e-05}}, "connector_pipeline_timer": 0.00012033803251445327}, "episode_return_min": -5.5, "env_to_module_sum_episodes_length_in": 27.16809333212661, "num_episodes": 100.0, "weights_seq_no": 15.0, "episode_return_max": 14.5, "num_episodes_lifetime": -67700.0, "episode_duration_sec_mean": 0.03677819304000879, "episode_len_max": 50, "num_agent_steps_sampled_lifetime": {"default_agent": -3385000.0}, "time_between_sampling": 0.011732735693947253, "num_module_steps_sampled": {"default_policy": 5000.0}, "rlmodule_inference_timer": 0.00010085984682277272, "num_env_steps_sampled": 5000.0, "episode_len_mean": 50.0, "env_reset_timer": 9.466143946058776e-05, "num_module_steps_sampled_lifetime": {"default_policy": -3385000.0}, "env_to_module_sum_episodes_length_out": 27.16809333212661, "sample": 0.03769438033447101, "module_episode_returns_mean": {"default_policy": 8.9}, "num_env_steps_sampled_lifetime_throughput": 1272.57432758282}, "learners": {"__all_modules__": {"learner_connector_sum_episodes_length_out": 5100.0, "learner_connector": {"connector_pipeline_timer": 0.29439098827161275, "timers": {"connectors": {"general_advantage_estimation": 0.013898770043431836, "add_time_dim_to_batch_and_zero_pad": 2.4652232985102792e-05, "batch_individual_items": 0.20052411297470724, "numpy_to_tensor": 0.00022132175097947947, "add_one_ts_to_episodes_and_truncate": 0.008700121345137857, "add_columns_from_episodes_to_train_batch": 0.06986321294958249, "add_observations_from_episodes_to_batch": 0.0007814937322699353, "add_states_from_episodes_to_batch": 6.111517147568049e-06}}}, "num_env_steps_trained": 30600, "num_env_steps_trained_lifetime": 489600, "num_module_steps_trained_lifetime": 96000, "num_trainable_parameters": 4965, "num_module_steps_trained": 6000, "num_non_trainable_parameters": 0, "learner_connector_sum_episodes_length_in": 5000.0, "num_env_steps_trained_lifetime_throughput": 863984.5531425099, "num_module_steps_trained_throughput": 169980.30343278547, "num_module_steps_trained_lifetime_throughput": 169904.3160261731}, "default_policy": {"diff_num_grad_updates_vs_sampler_policy": 1.0, "vf_explained_var": 0.3677496314048767, "curr_kl_coeff": 0.08581990003585815, "num_module_steps_trained_lifetime": 96000, "entropy": 0.6503888964653015, "num_trainable_parameters": 4965, "num_module_steps_trained": 6000, "default_optimizer_learning_rate": 0.0602050062423, "weights_seq_no": 16.0, "mean_kl_loss": 0.003697618143633008, "vf_loss": 0.11166432499885559, "vf_loss_unclipped": 47.39915084838867, "module_train_batch_size_mean": 1000.0, "curr_entropy_coeff": 0.0304386028221, "total_loss": 0.015175788663327694, "gradients_default_optimizer_global_norm": 0.09912917762994766, "policy_loss": -0.024702245369553566, "num_module_steps_trained_lifetime_throughput": 170171.56380802402}}, "num_training_step_calls_per_iteration": 1, "evaluation": {"env_runners": {"rlmodule_inference_timer": 9.480962579951569e-05, "env_to_module_sum_episodes_length_out": 27.168093332126602, "sample": 0.7344567195289429, "module_episode_returns_mean": {"default_policy": 0.3}, "episode_return_mean": 0.3, "num_agent_steps_sampled": {"default_agent": 1000}, "module_to_env_connector": {"timers": {"connectors": {"un_batch_to_individual_items": 1.5799038134126518e-05, "remove_single_ts_time_rank_from_batch": 1.4601044889246436e-06, "get_actions": 0.0001534975836882171, "normalize_and_clip_actions": 2.2929341497950632e-05, "tensor_to_numpy": 4.47575922734997e-05, "listify_data_for_vector_env": 3.07519451867769e-05}}, "connector_pipeline_timer": 0.0003437129197906466}, "env_step_timer": 4.2103320358883064e-05, "env_to_module_connector": {"timers": {"connectors": {"add_observations_from_episodes_to_batch": 6.191998907863035e-06, "add_states_from_episodes_to_batch": 3.4554582482024912e-06, "add_time_dim_to_batch_and_zero_pad": 5.522020086348354e-06, "batch_individual_items": 1.8175532710491575e-05, "numpy_to_tensor": 2.9340322981447617e-05}}, "connector_pipeline_timer": 0.0001141763291816629}, "num_episodes": 20, "episode_return_max": 17.5, "env_reset_timer": 0.00020599156868106967, "weights_seq_no": 16.0, "episode_len_max": 50, "num_module_steps_sampled": {"default_policy": 1000}, "num_env_steps_sampled": 1000, "num_env_steps_sampled_lifetime": 81000, "agent_episode_returns_mean": {"default_agent": 0.3}, "episode_len_min": 50, "num_episodes_lifetime": 320, "episode_duration_sec_mean": 0.035325970010035235, "num_agent_steps_sampled_lifetime": {"default_agent": 16000}, "episode_len_mean": 50.0, "num_module_steps_sampled_lifetime": {"default_policy": 16000}, "episode_return_min": -16.5, "env_to_module_sum_episodes_length_in": 27.168093332126602, "time_between_sampling": 4.145492970759949}, "num_healthy_workers": 1, "actor_manager_num_outstanding_async_reqs": 0, "num_remote_worker_restarts": 0}, "num_env_steps_sampled_lifetime": -3385000.0, "fault_tolerance": {"num_healthy_workers": 0, "num_remote_worker_restarts": 0}, "env_runner_group": {"actor_manager_num_outstanding_async_reqs": 0}, "done": false, "training_iteration": 16, "trial_id": "148fb_00000", "date": "2025-08-11_17-51-06", "timestamp": 1754927466, "time_this_iter_s": 5.016727447509766, "time_total_s": 78.88680672645569, "pid": 97502, "hostname": "DESKTOP-3SK5A41", "node_ip": "192.168.40.242", "config": {"exploration_config": {}, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 6, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "env": "Umbrella", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": false, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 0, "create_local_env_runner": true, "num_envs_per_env_runner": 1, "gym_env_vectorize_mode": "SYNC", "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "episodes_to_numpy": true, "max_requests_in_flight_per_env_runner": 1, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "merge_env_runner_states": "training_only", "broadcast_env_runner_states": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "complete_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "sampler_perf_stats_ema_coef": null, "_is_online": true, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": "auto", "num_aggregator_actors_per_learner": 0, "max_requests_in_flight_per_aggregator_actor": 3, "local_gpu_idx": 0, "max_requests_in_flight_per_learner": 3, "gamma": 1, "lr": 0.0602050062423, "grad_clip": 0.5, "grad_clip_by": "global_norm", "_train_batch_size_per_learner": 5000, "train_batch_size": 4000, "num_epochs": 1, "minibatch_size": 1000, "shuffle_batch_per_epoch": true, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "log_std_clip_param": 20.0, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "_disable_preprocessor_api": false, "_disable_action_flattening": false}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "_learner_class": null, "callbacks_on_algorithm_init": null, "callbacks_on_env_runners_recreated": null, "callbacks_on_offline_eval_runners_recreated": null, "callbacks_on_checkpoint_loaded": null, "callbacks_on_environment_created": null, "callbacks_on_episode_created": null, "callbacks_on_episode_start": null, "callbacks_on_episode_step": null, "callbacks_on_episode_end": null, "callbacks_on_evaluate_start": null, "callbacks_on_evaluate_end": null, "callbacks_on_evaluate_offline_start": null, "callbacks_on_evaluate_offline_end": null, "callbacks_on_sample_end": null, "callbacks_on_train_result": null, "explore": true, "enable_rl_module_and_learner": true, "enable_env_runner_and_connector_v2": true, "_prior_exploration_config": {"type": "StochasticSampling"}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7f830969eac0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "offline_data_class": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_read_batch_size": null, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "materialize_data": false, "materialize_mapped_data": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "ignore_final_observation": false, "prelearner_class": null, "prelearner_buffer_class": null, "prelearner_buffer_kwargs": {}, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_remaining_data": false, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": 1, "evaluation_duration": 20, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_auto_duration_min_env_steps_per_sample": 100, "evaluation_auto_duration_max_env_steps_per_sample": 2000, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 1, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "offline_evaluation_interval": null, "num_offline_eval_runners": 0, "offline_loss_for_module_fn": null, "offline_evaluation_duration": 1, "offline_evaluation_parallel_to_training": false, "offline_evaluation_timeout_s": 120.0, "num_cpus_per_offline_eval_runner": 1, "num_gpus_per_offline_eval_runner": 0, "custom_resources_per_offline_eval_runner": {}, "restart_failed_offline_eval_runners": true, "ignore_offline_eval_runner_failures": false, "max_num_offline_eval_runner_restarts": 1000, "offline_eval_runner_restore_timeout_s": 1800.0, "max_requests_in_flight_per_offline_eval_runner": 1, "validate_offline_eval_runners_after_construction": true, "offline_eval_runner_health_probe_timeout_s": 30.0, "offline_eval_rl_module_inference_only": false, "broadcast_offline_eval_runner_states": false, "offline_eval_batch_size_per_runner": 256, "dataset_num_iters_per_eval_runner": 1, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "log_gradients": true, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 42, "restart_failed_env_runners": true, "ignore_env_runner_failures": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30.0, "env_runner_restore_timeout_s": 1800.0, "_model_config": {}, "_rl_module_spec": "RLModuleSpec(module_class=None, observation_space=None, action_space=None, inference_only=False, learner_only=False, model_config=DefaultModelConfig(fcnet_hiddens=[127, 34], fcnet_activation='tanh', fcnet_kernel_initializer=None, fcnet_kernel_initializer_kwargs=None, fcnet_bias_initializer=None, fcnet_bias_initializer_kwargs=None, conv_filters=None, conv_activation='relu', conv_kernel_initializer=None, conv_kernel_initializer_kwargs=None, conv_bias_initializer=None, conv_bias_initializer_kwargs=None, head_fcnet_hiddens=[], head_fcnet_activation='relu', head_fcnet_kernel_initializer=None, head_fcnet_kernel_initializer_kwargs=None, head_fcnet_bias_initializer=None, head_fcnet_bias_initializer_kwargs=None, free_log_std=False, log_std_clip_param=20.0, vf_share_layers=True, use_lstm=False, max_seq_len=20, lstm_cell_size=256, lstm_use_prev_action=False, lstm_use_prev_reward=False, lstm_kernel_initializer=None, lstm_kernel_initializer_kwargs=None, lstm_bias_initializer=None, lstm_bias_initializer_kwargs=None), catalog_class=None, load_state_path=None, model_config_dict=None)", "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "_validate_config": true, "_use_msgpack_checkpoints": false, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "env_task_fn": -1, "enable_connectors": -1, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.4821924166921, "kl_target": 0.0121335369454, "vf_loss_coeff": 0.5287301420718, "entropy_coeff": 0.0304386028221, "clip_param": 0.2973082591601, "vf_clip_param": 0.1116643404955, "entropy_coeff_schedule": null, "lr_schedule": null, "sgd_minibatch_size": -1, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9313529170176, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.callbacks.callbacks.RLlibCallback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 78.88680672645569, "iterations_since_restore": 16, "perf": {"cpu_util_percent": 12.528571428571428, "ram_util_percent": 83.39999999999999}}
{"timers": {"training_iteration": 4.309404774865788, "restore_env_runners": 1.6599130496348965e-05, "training_step": 4.309136977601967, "env_runner_sampling_timer": 3.9028877986446004, "learner_update_timer": 0.4028202769131266, "synch_weights": 0.0014332862871301003, "restore_eval_env_runners": 1.308190157534889e-05, "evaluation_iteration": 0.7462742006812194, "synch_eval_env_connectors": 0.0004499454065782512, "synch_env_connectors": 9.094240037863689e-06}, "env_runners": {"module_to_env_connector": {"timers": {"connectors": {"remove_single_ts_time_rank_from_batch": 1.422069550421554e-06, "get_actions": 0.0001620025056496245, "tensor_to_numpy": 4.864260762419764e-05, "normalize_and_clip_actions": 2.2433507487401566e-05, "un_batch_to_individual_items": 1.512979426049969e-05, "listify_data_for_vector_env": 3.109551164834065e-05}}, "connector_pipeline_timer": 0.00035771036947230016}, "num_env_steps_sampled_lifetime": -3627500.0, "agent_episode_returns_mean": {"default_agent": 6.299999999999996}, "episode_return_mean": 6.299999999999996, "env_step_timer": 4.400902488749728e-05, "num_agent_steps_sampled": {"default_agent": 5000.0}, "episode_len_min": 50, "env_to_module_connector": {"timers": {"connectors": {"add_observations_from_episodes_to_batch": 6.6183298668844425e-06, "numpy_to_tensor": 3.134303794845731e-05, "add_states_from_episodes_to_batch": 3.5006932193440888e-06, "add_time_dim_to_batch_and_zero_pad": 6.413049695295296e-06, "batch_individual_items": 1.8595312662986963e-05}}, "connector_pipeline_timer": 0.0001197107261678633}, "episode_return_min": -5.5, "env_to_module_sum_episodes_length_in": 27.16809333212661, "num_episodes": 100.0, "weights_seq_no": 16.0, "episode_return_max": 14.5, "num_episodes_lifetime": -72550.0, "episode_duration_sec_mean": 0.03635987103997651, "episode_len_max": 50, "num_agent_steps_sampled_lifetime": {"default_agent": -3627500.0}, "time_between_sampling": 0.012341428793520084, "num_module_steps_sampled": {"default_policy": 5000.0}, "rlmodule_inference_timer": 9.871408902476803e-05, "num_env_steps_sampled": 5000.0, "episode_len_mean": 50.0, "env_reset_timer": 9.419820740938335e-05, "num_module_steps_sampled_lifetime": {"default_policy": -3627500.0}, "env_to_module_sum_episodes_length_out": 27.16809333212661, "sample": 0.037685260723795744, "module_episode_returns_mean": {"default_policy": 6.299999999999996}, "num_env_steps_sampled_lifetime_throughput": 1279.088164703907}, "learners": {"__all_modules__": {"learner_connector_sum_episodes_length_out": 5100.0, "learner_connector": {"connector_pipeline_timer": 0.2929274523888991, "timers": {"connectors": {"general_advantage_estimation": 0.01386153734300266, "add_time_dim_to_batch_and_zero_pad": 2.4613710656545607e-05, "batch_individual_items": 0.19910707884496087, "numpy_to_tensor": 0.00022077153346332595, "add_one_ts_to_episodes_and_truncate": 0.008698118131679472, "add_columns_from_episodes_to_train_batch": 0.06985792382008021, "add_observations_from_episodes_to_batch": 0.0007809207949487332, "add_states_from_episodes_to_batch": 6.101401973348809e-06}}}, "num_env_steps_trained": 30600, "num_env_steps_trained_lifetime": 520200, "num_module_steps_trained_lifetime": 102000, "num_trainable_parameters": 4965, "num_module_steps_trained": 6000, "num_non_trainable_parameters": 0, "learner_connector_sum_episodes_length_in": 5000.0, "num_env_steps_trained_lifetime_throughput": 861574.0602305626, "num_module_steps_trained_throughput": 169487.8510961357, "num_module_steps_trained_lifetime_throughput": 169410.83457431954}, "default_policy": {"diff_num_grad_updates_vs_sampler_policy": 1.0, "vf_explained_var": 0.31846338510513306, "curr_kl_coeff": 0.04290995001792908, "num_module_steps_trained_lifetime": 102000, "entropy": 0.6568072438240051, "num_trainable_parameters": 4965, "num_module_steps_trained": 6000, "default_optimizer_learning_rate": 0.0602050062423, "weights_seq_no": 17.0, "mean_kl_loss": 0.005953906569629908, "vf_loss": 0.10862956941127777, "vf_loss_unclipped": 61.11140823364258, "module_train_batch_size_mean": 1000.0, "curr_entropy_coeff": 0.0304386028221, "total_loss": 0.03528982773423195, "gradients_default_optimizer_global_norm": 0.24916528165340424, "policy_loss": -0.0026645795442163944, "num_module_steps_trained_lifetime_throughput": 169659.70833853135}}, "num_training_step_calls_per_iteration": 1, "evaluation": {"env_runners": {"rlmodule_inference_timer": 9.593009957205775e-05, "env_to_module_sum_episodes_length_out": 27.168093332126602, "sample": 0.7344364813436516, "module_episode_returns_mean": {"default_policy": -0.1}, "episode_return_mean": -0.1, "num_agent_steps_sampled": {"default_agent": 1000}, "module_to_env_connector": {"timers": {"connectors": {"un_batch_to_individual_items": 1.5732242048203015e-05, "remove_single_ts_time_rank_from_batch": 1.487099536139624e-06, "get_actions": 0.0001542158841045186, "normalize_and_clip_actions": 2.241521341305156e-05, "tensor_to_numpy": 4.486942951262971e-05, "listify_data_for_vector_env": 3.076759348474017e-05}}, "connector_pipeline_timer": 0.0003428687804122879}, "env_step_timer": 4.227858159300161e-05, "env_to_module_connector": {"timers": {"connectors": {"add_observations_from_episodes_to_batch": 6.5014856107616e-06, "add_states_from_episodes_to_batch": 3.624064486626741e-06, "add_time_dim_to_batch_and_zero_pad": 5.928866670480414e-06, "batch_individual_items": 1.7949868549083465e-05, "numpy_to_tensor": 2.959663136158814e-05}}, "connector_pipeline_timer": 0.00011530953133409428}, "num_episodes": 20, "episode_return_max": 17.5, "env_reset_timer": 0.00020514465299017326, "weights_seq_no": 17.0, "episode_len_max": 50, "num_module_steps_sampled": {"default_policy": 1000}, "num_env_steps_sampled": 1000, "num_env_steps_sampled_lifetime": 86000, "agent_episode_returns_mean": {"default_agent": -0.1}, "episode_len_min": 50, "num_episodes_lifetime": 340, "episode_duration_sec_mean": 0.0352988100300172, "num_agent_steps_sampled_lifetime": {"default_agent": 17000}, "episode_len_mean": 50.0, "num_module_steps_sampled_lifetime": {"default_policy": 17000}, "episode_return_min": -16.5, "env_to_module_sum_episodes_length_in": 27.168093332126602, "time_between_sampling": 4.145406261092344}, "num_healthy_workers": 1, "actor_manager_num_outstanding_async_reqs": 0, "num_remote_worker_restarts": 0}, "num_env_steps_sampled_lifetime": -3627500.0, "fault_tolerance": {"num_healthy_workers": 0, "num_remote_worker_restarts": 0}, "env_runner_group": {"actor_manager_num_outstanding_async_reqs": 0}, "done": false, "training_iteration": 17, "trial_id": "148fb_00000", "date": "2025-08-11_17-51-11", "timestamp": 1754927471, "time_this_iter_s": 4.82944917678833, "time_total_s": 83.71625590324402, "pid": 97502, "hostname": "DESKTOP-3SK5A41", "node_ip": "192.168.40.242", "config": {"exploration_config": {}, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 6, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "env": "Umbrella", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": false, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 0, "create_local_env_runner": true, "num_envs_per_env_runner": 1, "gym_env_vectorize_mode": "SYNC", "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "episodes_to_numpy": true, "max_requests_in_flight_per_env_runner": 1, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "merge_env_runner_states": "training_only", "broadcast_env_runner_states": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "complete_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "sampler_perf_stats_ema_coef": null, "_is_online": true, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": "auto", "num_aggregator_actors_per_learner": 0, "max_requests_in_flight_per_aggregator_actor": 3, "local_gpu_idx": 0, "max_requests_in_flight_per_learner": 3, "gamma": 1, "lr": 0.0602050062423, "grad_clip": 0.5, "grad_clip_by": "global_norm", "_train_batch_size_per_learner": 5000, "train_batch_size": 4000, "num_epochs": 1, "minibatch_size": 1000, "shuffle_batch_per_epoch": true, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "log_std_clip_param": 20.0, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "_disable_preprocessor_api": false, "_disable_action_flattening": false}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "_learner_class": null, "callbacks_on_algorithm_init": null, "callbacks_on_env_runners_recreated": null, "callbacks_on_offline_eval_runners_recreated": null, "callbacks_on_checkpoint_loaded": null, "callbacks_on_environment_created": null, "callbacks_on_episode_created": null, "callbacks_on_episode_start": null, "callbacks_on_episode_step": null, "callbacks_on_episode_end": null, "callbacks_on_evaluate_start": null, "callbacks_on_evaluate_end": null, "callbacks_on_evaluate_offline_start": null, "callbacks_on_evaluate_offline_end": null, "callbacks_on_sample_end": null, "callbacks_on_train_result": null, "explore": true, "enable_rl_module_and_learner": true, "enable_env_runner_and_connector_v2": true, "_prior_exploration_config": {"type": "StochasticSampling"}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7f830969eac0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "offline_data_class": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_read_batch_size": null, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "materialize_data": false, "materialize_mapped_data": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "ignore_final_observation": false, "prelearner_class": null, "prelearner_buffer_class": null, "prelearner_buffer_kwargs": {}, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_remaining_data": false, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": 1, "evaluation_duration": 20, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_auto_duration_min_env_steps_per_sample": 100, "evaluation_auto_duration_max_env_steps_per_sample": 2000, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 1, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "offline_evaluation_interval": null, "num_offline_eval_runners": 0, "offline_loss_for_module_fn": null, "offline_evaluation_duration": 1, "offline_evaluation_parallel_to_training": false, "offline_evaluation_timeout_s": 120.0, "num_cpus_per_offline_eval_runner": 1, "num_gpus_per_offline_eval_runner": 0, "custom_resources_per_offline_eval_runner": {}, "restart_failed_offline_eval_runners": true, "ignore_offline_eval_runner_failures": false, "max_num_offline_eval_runner_restarts": 1000, "offline_eval_runner_restore_timeout_s": 1800.0, "max_requests_in_flight_per_offline_eval_runner": 1, "validate_offline_eval_runners_after_construction": true, "offline_eval_runner_health_probe_timeout_s": 30.0, "offline_eval_rl_module_inference_only": false, "broadcast_offline_eval_runner_states": false, "offline_eval_batch_size_per_runner": 256, "dataset_num_iters_per_eval_runner": 1, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "log_gradients": true, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 42, "restart_failed_env_runners": true, "ignore_env_runner_failures": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30.0, "env_runner_restore_timeout_s": 1800.0, "_model_config": {}, "_rl_module_spec": "RLModuleSpec(module_class=None, observation_space=None, action_space=None, inference_only=False, learner_only=False, model_config=DefaultModelConfig(fcnet_hiddens=[127, 34], fcnet_activation='tanh', fcnet_kernel_initializer=None, fcnet_kernel_initializer_kwargs=None, fcnet_bias_initializer=None, fcnet_bias_initializer_kwargs=None, conv_filters=None, conv_activation='relu', conv_kernel_initializer=None, conv_kernel_initializer_kwargs=None, conv_bias_initializer=None, conv_bias_initializer_kwargs=None, head_fcnet_hiddens=[], head_fcnet_activation='relu', head_fcnet_kernel_initializer=None, head_fcnet_kernel_initializer_kwargs=None, head_fcnet_bias_initializer=None, head_fcnet_bias_initializer_kwargs=None, free_log_std=False, log_std_clip_param=20.0, vf_share_layers=True, use_lstm=False, max_seq_len=20, lstm_cell_size=256, lstm_use_prev_action=False, lstm_use_prev_reward=False, lstm_kernel_initializer=None, lstm_kernel_initializer_kwargs=None, lstm_bias_initializer=None, lstm_bias_initializer_kwargs=None), catalog_class=None, load_state_path=None, model_config_dict=None)", "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "_validate_config": true, "_use_msgpack_checkpoints": false, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "env_task_fn": -1, "enable_connectors": -1, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.4821924166921, "kl_target": 0.0121335369454, "vf_loss_coeff": 0.5287301420718, "entropy_coeff": 0.0304386028221, "clip_param": 0.2973082591601, "vf_clip_param": 0.1116643404955, "entropy_coeff_schedule": null, "lr_schedule": null, "sgd_minibatch_size": -1, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9313529170176, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.callbacks.callbacks.RLlibCallback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 83.71625590324402, "iterations_since_restore": 17, "perf": {"cpu_util_percent": 12.87142857142857, "ram_util_percent": 83.39999999999999}}
{"timers": {"training_iteration": 4.309964882167129, "restore_env_runners": 1.654713919541775e-05, "training_step": 4.309695771875951, "env_runner_sampling_timer": 3.904200491698153, "learner_update_timer": 0.4020613531539871, "synch_weights": 0.0014351174242575521, "restore_eval_env_runners": 1.3059082554320506e-05, "evaluation_iteration": 0.7462295756844091, "synch_eval_env_connectors": 0.00044928895251652214, "synch_env_connectors": 9.072297644473115e-06}, "env_runners": {"module_to_env_connector": {"timers": {"connectors": {"remove_single_ts_time_rank_from_batch": 1.4755012182653524e-06, "get_actions": 0.0001678753480229444, "tensor_to_numpy": 5.042688008527888e-05, "normalize_and_clip_actions": 2.32194327201092e-05, "un_batch_to_individual_items": 1.5591390628360364e-05, "listify_data_for_vector_env": 3.239118344028785e-05}}, "connector_pipeline_timer": 0.0003704840273193505}, "num_env_steps_sampled_lifetime": -3870000.0, "agent_episode_returns_mean": {"default_agent": 10.299999999999997}, "episode_return_mean": 10.299999999999997, "env_step_timer": 4.533094697651555e-05, "num_agent_steps_sampled": {"default_agent": 5000.0}, "episode_len_min": 50, "env_to_module_connector": {"timers": {"connectors": {"add_observations_from_episodes_to_batch": 6.809040407222378e-06, "numpy_to_tensor": 3.228034694270382e-05, "add_states_from_episodes_to_batch": 3.6665702534483788e-06, "add_time_dim_to_batch_and_zero_pad": 6.655221676707284e-06, "batch_individual_items": 1.9311481216560227e-05}}, "connector_pipeline_timer": 0.00012352637593564264}, "episode_return_min": -5.5, "env_to_module_sum_episodes_length_in": 27.16809333212661, "num_episodes": 100.0, "weights_seq_no": 17.0, "episode_return_max": 14.5, "num_episodes_lifetime": -77400.0, "episode_duration_sec_mean": 0.03766963304000455, "episode_len_max": 50, "num_agent_steps_sampled_lifetime": {"default_agent": -3870000.0}, "time_between_sampling": 0.011654406227537422, "num_module_steps_sampled": {"default_policy": 5000.0}, "rlmodule_inference_timer": 0.00010343139038239468, "num_env_steps_sampled": 5000.0, "episode_len_mean": 50.0, "env_reset_timer": 9.662001234596993e-05, "num_module_steps_sampled_lifetime": {"default_policy": -3870000.0}, "env_to_module_sum_episodes_length_out": 27.16809333212661, "sample": 0.037949512067544475, "module_episode_returns_mean": {"default_policy": 10.299999999999997}, "num_env_steps_sampled_lifetime_throughput": 1252.666169256281}, "learners": {"__all_modules__": {"learner_connector_sum_episodes_length_out": 5100.0, "learner_connector": {"connector_pipeline_timer": 0.2929107878750085, "timers": {"connectors": {"general_advantage_estimation": 0.013805686969570014, "add_time_dim_to_batch_and_zero_pad": 2.458957354873753e-05, "batch_individual_items": 0.19913753606651136, "numpy_to_tensor": 0.00022070781812873658, "add_one_ts_to_episodes_and_truncate": 0.008696645950363135, "add_columns_from_episodes_to_train_batch": 0.06986914158187894, "add_observations_from_episodes_to_batch": 0.0007807205869940184, "add_states_from_episodes_to_batch": 6.097387960178933e-06}}}, "num_env_steps_trained": 30600, "num_env_steps_trained_lifetime": 550800, "num_module_steps_trained_lifetime": 108000, "num_trainable_parameters": 4965, "num_module_steps_trained": 6000, "num_non_trainable_parameters": 0, "learner_connector_sum_episodes_length_in": 5000.0, "num_env_steps_trained_lifetime_throughput": 859209.208991639, "num_module_steps_trained_throughput": 169005.89744825053, "num_module_steps_trained_lifetime_throughput": 168927.09445126614}, "default_policy": {"diff_num_grad_updates_vs_sampler_policy": 1.0, "vf_explained_var": 0.2786133289337158, "curr_kl_coeff": 0.06436492502689362, "num_module_steps_trained_lifetime": 108000, "entropy": 0.6280502676963806, "num_trainable_parameters": 4965, "num_module_steps_trained": 6000, "default_optimizer_learning_rate": 0.0602050062423, "weights_seq_no": 18.0, "mean_kl_loss": 0.076662577688694, "vf_loss": 0.1035102903842926, "vf_loss_unclipped": 31.667675018310547, "module_train_batch_size_mean": 1000.0, "curr_entropy_coeff": 0.0304386028221, "total_loss": 0.0335465632379055, "gradients_default_optimizer_global_norm": 0.9394512176513672, "policy_loss": -0.005355073604732752, "num_module_steps_trained_lifetime_throughput": 169159.54668846572}}, "num_training_step_calls_per_iteration": 1, "evaluation": {"env_runners": {"rlmodule_inference_timer": 9.490305917996449e-05, "env_to_module_sum_episodes_length_out": 27.168093332126602, "sample": 0.7344664785402201, "module_episode_returns_mean": {"default_policy": -0.5}, "episode_return_mean": -0.5, "num_agent_steps_sampled": {"default_agent": 1000}, "module_to_env_connector": {"timers": {"connectors": {"un_batch_to_individual_items": 1.5677681074631086e-05, "remove_single_ts_time_rank_from_batch": 1.4482885763883612e-06, "get_actions": 0.00015343971438483883, "normalize_and_clip_actions": 2.2473070013515533e-05, "tensor_to_numpy": 4.480950491251411e-05, "listify_data_for_vector_env": 3.0860084363505466e-05}}, "connector_pipeline_timer": 0.00034326975515518057}, "env_step_timer": 4.160519112783066e-05, "env_to_module_connector": {"timers": {"connectors": {"add_observations_from_episodes_to_batch": 6.107591124934617e-06, "add_states_from_episodes_to_batch": 3.3361543663549913e-06, "add_time_dim_to_batch_and_zero_pad": 5.69705225183111e-06, "batch_individual_items": 1.8059733914462367e-05, "numpy_to_tensor": 2.9735692097898437e-05}}, "connector_pipeline_timer": 0.00011458514065680982}, "num_episodes": 20, "episode_return_max": 17.5, "env_reset_timer": 0.00020430320646062716, "weights_seq_no": 18.0, "episode_len_max": 50, "num_module_steps_sampled": {"default_policy": 1000}, "num_env_steps_sampled": 1000, "num_env_steps_sampled_lifetime": 91000, "agent_episode_returns_mean": {"default_agent": -0.5}, "episode_len_min": 50, "num_episodes_lifetime": 360, "episode_duration_sec_mean": 0.03535955704001026, "num_agent_steps_sampled_lifetime": {"default_agent": 18000}, "episode_len_mean": 50.0, "num_module_steps_sampled_lifetime": {"default_policy": 18000}, "episode_return_min": -16.5, "env_to_module_sum_episodes_length_in": 27.168093332126602, "time_between_sampling": 4.148158094531419}, "num_healthy_workers": 1, "actor_manager_num_outstanding_async_reqs": 0, "num_remote_worker_restarts": 0}, "num_env_steps_sampled_lifetime": -3870000.0, "fault_tolerance": {"num_healthy_workers": 0, "num_remote_worker_restarts": 0}, "env_runner_group": {"actor_manager_num_outstanding_async_reqs": 0}, "done": false, "training_iteration": 18, "trial_id": "148fb_00000", "date": "2025-08-11_17-51-16", "timestamp": 1754927476, "time_this_iter_s": 5.1178505420684814, "time_total_s": 88.8341064453125, "pid": 97502, "hostname": "DESKTOP-3SK5A41", "node_ip": "192.168.40.242", "config": {"exploration_config": {}, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 6, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "env": "Umbrella", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": false, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 0, "create_local_env_runner": true, "num_envs_per_env_runner": 1, "gym_env_vectorize_mode": "SYNC", "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "episodes_to_numpy": true, "max_requests_in_flight_per_env_runner": 1, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "merge_env_runner_states": "training_only", "broadcast_env_runner_states": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "complete_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "sampler_perf_stats_ema_coef": null, "_is_online": true, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": "auto", "num_aggregator_actors_per_learner": 0, "max_requests_in_flight_per_aggregator_actor": 3, "local_gpu_idx": 0, "max_requests_in_flight_per_learner": 3, "gamma": 1, "lr": 0.0602050062423, "grad_clip": 0.5, "grad_clip_by": "global_norm", "_train_batch_size_per_learner": 5000, "train_batch_size": 4000, "num_epochs": 1, "minibatch_size": 1000, "shuffle_batch_per_epoch": true, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "log_std_clip_param": 20.0, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "_disable_preprocessor_api": false, "_disable_action_flattening": false}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "_learner_class": null, "callbacks_on_algorithm_init": null, "callbacks_on_env_runners_recreated": null, "callbacks_on_offline_eval_runners_recreated": null, "callbacks_on_checkpoint_loaded": null, "callbacks_on_environment_created": null, "callbacks_on_episode_created": null, "callbacks_on_episode_start": null, "callbacks_on_episode_step": null, "callbacks_on_episode_end": null, "callbacks_on_evaluate_start": null, "callbacks_on_evaluate_end": null, "callbacks_on_evaluate_offline_start": null, "callbacks_on_evaluate_offline_end": null, "callbacks_on_sample_end": null, "callbacks_on_train_result": null, "explore": true, "enable_rl_module_and_learner": true, "enable_env_runner_and_connector_v2": true, "_prior_exploration_config": {"type": "StochasticSampling"}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7f830969eac0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "offline_data_class": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_read_batch_size": null, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "materialize_data": false, "materialize_mapped_data": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "ignore_final_observation": false, "prelearner_class": null, "prelearner_buffer_class": null, "prelearner_buffer_kwargs": {}, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_remaining_data": false, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": 1, "evaluation_duration": 20, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_auto_duration_min_env_steps_per_sample": 100, "evaluation_auto_duration_max_env_steps_per_sample": 2000, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 1, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "offline_evaluation_interval": null, "num_offline_eval_runners": 0, "offline_loss_for_module_fn": null, "offline_evaluation_duration": 1, "offline_evaluation_parallel_to_training": false, "offline_evaluation_timeout_s": 120.0, "num_cpus_per_offline_eval_runner": 1, "num_gpus_per_offline_eval_runner": 0, "custom_resources_per_offline_eval_runner": {}, "restart_failed_offline_eval_runners": true, "ignore_offline_eval_runner_failures": false, "max_num_offline_eval_runner_restarts": 1000, "offline_eval_runner_restore_timeout_s": 1800.0, "max_requests_in_flight_per_offline_eval_runner": 1, "validate_offline_eval_runners_after_construction": true, "offline_eval_runner_health_probe_timeout_s": 30.0, "offline_eval_rl_module_inference_only": false, "broadcast_offline_eval_runner_states": false, "offline_eval_batch_size_per_runner": 256, "dataset_num_iters_per_eval_runner": 1, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "log_gradients": true, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 42, "restart_failed_env_runners": true, "ignore_env_runner_failures": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30.0, "env_runner_restore_timeout_s": 1800.0, "_model_config": {}, "_rl_module_spec": "RLModuleSpec(module_class=None, observation_space=None, action_space=None, inference_only=False, learner_only=False, model_config=DefaultModelConfig(fcnet_hiddens=[127, 34], fcnet_activation='tanh', fcnet_kernel_initializer=None, fcnet_kernel_initializer_kwargs=None, fcnet_bias_initializer=None, fcnet_bias_initializer_kwargs=None, conv_filters=None, conv_activation='relu', conv_kernel_initializer=None, conv_kernel_initializer_kwargs=None, conv_bias_initializer=None, conv_bias_initializer_kwargs=None, head_fcnet_hiddens=[], head_fcnet_activation='relu', head_fcnet_kernel_initializer=None, head_fcnet_kernel_initializer_kwargs=None, head_fcnet_bias_initializer=None, head_fcnet_bias_initializer_kwargs=None, free_log_std=False, log_std_clip_param=20.0, vf_share_layers=True, use_lstm=False, max_seq_len=20, lstm_cell_size=256, lstm_use_prev_action=False, lstm_use_prev_reward=False, lstm_kernel_initializer=None, lstm_kernel_initializer_kwargs=None, lstm_bias_initializer=None, lstm_bias_initializer_kwargs=None), catalog_class=None, load_state_path=None, model_config_dict=None)", "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "_validate_config": true, "_use_msgpack_checkpoints": false, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "env_task_fn": -1, "enable_connectors": -1, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.4821924166921, "kl_target": 0.0121335369454, "vf_loss_coeff": 0.5287301420718, "entropy_coeff": 0.0304386028221, "clip_param": 0.2973082591601, "vf_clip_param": 0.1116643404955, "entropy_coeff_schedule": null, "lr_schedule": null, "sgd_minibatch_size": -1, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9313529170176, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.callbacks.callbacks.RLlibCallback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 88.8341064453125, "iterations_since_restore": 18, "perf": {"cpu_util_percent": 13.014285714285714, "ram_util_percent": 83.39999999999999}}
{"timers": {"training_iteration": 4.307834928435464, "restore_env_runners": 1.649866780305449e-05, "training_step": 4.307564793247188, "env_runner_sampling_timer": 3.9042082598611767, "learner_update_timer": 0.3999138426324498, "synch_weights": 0.0014365032500183318, "restore_eval_env_runners": 1.3043491722234177e-05, "evaluation_iteration": 0.7462398519375573, "synch_eval_env_connectors": 0.000448852062989302, "synch_env_connectors": 9.048574668882407e-06}, "env_runners": {"module_to_env_connector": {"timers": {"connectors": {"remove_single_ts_time_rank_from_batch": 1.4785885689879262e-06, "get_actions": 0.0001621385578042988, "tensor_to_numpy": 4.8691814321940966e-05, "normalize_and_clip_actions": 2.259108140817163e-05, "un_batch_to_individual_items": 1.5230402712852918e-05, "listify_data_for_vector_env": 3.126519581534617e-05}}, "connector_pipeline_timer": 0.00035855023660452386}, "num_env_steps_sampled_lifetime": -4112500.0, "agent_episode_returns_mean": {"default_agent": 7.9}, "episode_return_mean": 7.9, "env_step_timer": 4.425590643990879e-05, "num_agent_steps_sampled": {"default_agent": 5000.0}, "episode_len_min": 50, "env_to_module_connector": {"timers": {"connectors": {"add_observations_from_episodes_to_batch": 6.506172555560262e-06, "numpy_to_tensor": 3.1299173874506386e-05, "add_states_from_episodes_to_batch": 3.521891225019001e-06, "add_time_dim_to_batch_and_zero_pad": 6.510584309023785e-06, "batch_individual_items": 1.8547687528705907e-05}}, "connector_pipeline_timer": 0.00011936572074047672}, "episode_return_min": -5.5, "env_to_module_sum_episodes_length_in": 27.16809333212661, "num_episodes": 100.0, "weights_seq_no": 18.0, "episode_return_max": 14.5, "num_episodes_lifetime": -82250.0, "episode_duration_sec_mean": 0.03644884308007931, "episode_len_max": 50, "num_agent_steps_sampled_lifetime": {"default_agent": -4112500.0}, "time_between_sampling": 0.01235999663748327, "num_module_steps_sampled": {"default_policy": 5000.0}, "rlmodule_inference_timer": 9.95215398118645e-05, "num_env_steps_sampled": 5000.0, "episode_len_mean": 50.0, "env_reset_timer": 9.620951086896798e-05, "num_module_steps_sampled_lifetime": {"default_policy": -4112500.0}, "env_to_module_sum_episodes_length_out": 27.16809333212661, "sample": 0.03810194606812999, "module_episode_returns_mean": {"default_policy": 7.9}, "num_env_steps_sampled_lifetime_throughput": 1272.8010111048634}, "learners": {"__all_modules__": {"learner_connector_sum_episodes_length_out": 5100.0, "learner_connector": {"connector_pipeline_timer": 0.2914837620062601, "timers": {"connectors": {"general_advantage_estimation": 0.013775469099876373, "add_time_dim_to_batch_and_zero_pad": 2.455767781475622e-05, "batch_individual_items": 0.1977407777158477, "numpy_to_tensor": 0.00022058673995150487, "add_one_ts_to_episodes_and_truncate": 0.008693854490861281, "add_columns_from_episodes_to_train_batch": 0.06987331316606606, "add_observations_from_episodes_to_batch": 0.0007800533811219676, "add_states_from_episodes_to_batch": 6.086414088408984e-06}}}, "num_env_steps_trained": 30600, "num_env_steps_trained_lifetime": 581400, "num_module_steps_trained_lifetime": 114000, "num_trainable_parameters": 4965, "num_module_steps_trained": 6000, "num_non_trainable_parameters": 0, "learner_connector_sum_episodes_length_in": 5000.0, "num_env_steps_trained_lifetime_throughput": 856503.4588711795, "num_module_steps_trained_throughput": 168457.37133529704, "num_module_steps_trained_lifetime_throughput": 168377.02532932977}, "default_policy": {"diff_num_grad_updates_vs_sampler_policy": 1.0, "vf_explained_var": 0.30192846059799194, "curr_kl_coeff": 0.09654738754034042, "num_module_steps_trained_lifetime": 114000, "entropy": 0.5232760906219482, "num_trainable_parameters": 4965, "num_module_steps_trained": 6000, "default_optimizer_learning_rate": 0.0602050062423, "weights_seq_no": 19.0, "mean_kl_loss": 0.08960013091564178, "vf_loss": 0.10813170671463013, "vf_loss_unclipped": 36.24480056762695, "module_train_batch_size_mean": 1000.0, "curr_entropy_coeff": 0.0304386028221, "total_loss": 0.10511446744203568, "gradients_default_optimizer_global_norm": 0.91710364818573, "policy_loss": 0.05810265988111496, "num_module_steps_trained_lifetime_throughput": 168594.19965776234}}, "num_training_step_calls_per_iteration": 1, "evaluation": {"env_runners": {"rlmodule_inference_timer": 9.613026865336656e-05, "env_to_module_sum_episodes_length_out": 27.168093332126602, "sample": 0.73454225276482, "module_episode_returns_mean": {"default_policy": -1.1}, "episode_return_mean": -1.1, "num_agent_steps_sampled": {"default_agent": 1000}, "module_to_env_connector": {"timers": {"connectors": {"un_batch_to_individual_items": 1.5832742514350213e-05, "remove_single_ts_time_rank_from_batch": 1.5562154554057545e-06, "get_actions": 0.00015742506430296586, "normalize_and_clip_actions": 2.2728016392610065e-05, "tensor_to_numpy": 4.5602285190512585e-05, "listify_data_for_vector_env": 3.086470627793713e-05}}, "connector_pipeline_timer": 0.0003490254826585931}, "env_step_timer": 4.2978913940615124e-05, "env_to_module_connector": {"timers": {"connectors": {"add_observations_from_episodes_to_batch": 6.2306096673750346e-06, "add_states_from_episodes_to_batch": 3.364330008773898e-06, "add_time_dim_to_batch_and_zero_pad": 5.842033501800926e-06, "batch_individual_items": 1.8212532715440876e-05, "numpy_to_tensor": 3.0512300422148542e-05}}, "connector_pipeline_timer": 0.00011631531293381989}, "num_episodes": 20, "episode_return_max": 17.5, "env_reset_timer": 0.0002034991743989181, "weights_seq_no": 19.0, "episode_len_max": 50, "num_module_steps_sampled": {"default_policy": 1000}, "num_env_steps_sampled": 1000, "num_env_steps_sampled_lifetime": 96000, "agent_episode_returns_mean": {"default_agent": -1.1}, "episode_len_min": 50, "num_episodes_lifetime": 380, "episode_duration_sec_mean": 0.03543926704006481, "num_agent_steps_sampled_lifetime": {"default_agent": 19000}, "episode_len_mean": 50.0, "num_module_steps_sampled_lifetime": {"default_policy": 19000}, "episode_return_min": -16.5, "env_to_module_sum_episodes_length_in": 27.168093332126602, "time_between_sampling": 4.148214028676108}, "num_healthy_workers": 1, "actor_manager_num_outstanding_async_reqs": 0, "num_remote_worker_restarts": 0}, "num_env_steps_sampled_lifetime": -4112500.0, "fault_tolerance": {"num_healthy_workers": 0, "num_remote_worker_restarts": 0}, "env_runner_group": {"actor_manager_num_outstanding_async_reqs": 0}, "done": false, "training_iteration": 19, "trial_id": "148fb_00000", "date": "2025-08-11_17-51-21", "timestamp": 1754927481, "time_this_iter_s": 4.854066610336304, "time_total_s": 93.6881730556488, "pid": 97502, "hostname": "DESKTOP-3SK5A41", "node_ip": "192.168.40.242", "config": {"exploration_config": {}, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 6, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "env": "Umbrella", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": false, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 0, "create_local_env_runner": true, "num_envs_per_env_runner": 1, "gym_env_vectorize_mode": "SYNC", "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "episodes_to_numpy": true, "max_requests_in_flight_per_env_runner": 1, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "merge_env_runner_states": "training_only", "broadcast_env_runner_states": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "complete_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "sampler_perf_stats_ema_coef": null, "_is_online": true, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": "auto", "num_aggregator_actors_per_learner": 0, "max_requests_in_flight_per_aggregator_actor": 3, "local_gpu_idx": 0, "max_requests_in_flight_per_learner": 3, "gamma": 1, "lr": 0.0602050062423, "grad_clip": 0.5, "grad_clip_by": "global_norm", "_train_batch_size_per_learner": 5000, "train_batch_size": 4000, "num_epochs": 1, "minibatch_size": 1000, "shuffle_batch_per_epoch": true, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "log_std_clip_param": 20.0, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "_disable_preprocessor_api": false, "_disable_action_flattening": false}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "_learner_class": null, "callbacks_on_algorithm_init": null, "callbacks_on_env_runners_recreated": null, "callbacks_on_offline_eval_runners_recreated": null, "callbacks_on_checkpoint_loaded": null, "callbacks_on_environment_created": null, "callbacks_on_episode_created": null, "callbacks_on_episode_start": null, "callbacks_on_episode_step": null, "callbacks_on_episode_end": null, "callbacks_on_evaluate_start": null, "callbacks_on_evaluate_end": null, "callbacks_on_evaluate_offline_start": null, "callbacks_on_evaluate_offline_end": null, "callbacks_on_sample_end": null, "callbacks_on_train_result": null, "explore": true, "enable_rl_module_and_learner": true, "enable_env_runner_and_connector_v2": true, "_prior_exploration_config": {"type": "StochasticSampling"}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7f830969eac0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "offline_data_class": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_read_batch_size": null, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "materialize_data": false, "materialize_mapped_data": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "ignore_final_observation": false, "prelearner_class": null, "prelearner_buffer_class": null, "prelearner_buffer_kwargs": {}, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_remaining_data": false, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": 1, "evaluation_duration": 20, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_auto_duration_min_env_steps_per_sample": 100, "evaluation_auto_duration_max_env_steps_per_sample": 2000, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 1, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "offline_evaluation_interval": null, "num_offline_eval_runners": 0, "offline_loss_for_module_fn": null, "offline_evaluation_duration": 1, "offline_evaluation_parallel_to_training": false, "offline_evaluation_timeout_s": 120.0, "num_cpus_per_offline_eval_runner": 1, "num_gpus_per_offline_eval_runner": 0, "custom_resources_per_offline_eval_runner": {}, "restart_failed_offline_eval_runners": true, "ignore_offline_eval_runner_failures": false, "max_num_offline_eval_runner_restarts": 1000, "offline_eval_runner_restore_timeout_s": 1800.0, "max_requests_in_flight_per_offline_eval_runner": 1, "validate_offline_eval_runners_after_construction": true, "offline_eval_runner_health_probe_timeout_s": 30.0, "offline_eval_rl_module_inference_only": false, "broadcast_offline_eval_runner_states": false, "offline_eval_batch_size_per_runner": 256, "dataset_num_iters_per_eval_runner": 1, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "log_gradients": true, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 42, "restart_failed_env_runners": true, "ignore_env_runner_failures": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30.0, "env_runner_restore_timeout_s": 1800.0, "_model_config": {}, "_rl_module_spec": "RLModuleSpec(module_class=None, observation_space=None, action_space=None, inference_only=False, learner_only=False, model_config=DefaultModelConfig(fcnet_hiddens=[127, 34], fcnet_activation='tanh', fcnet_kernel_initializer=None, fcnet_kernel_initializer_kwargs=None, fcnet_bias_initializer=None, fcnet_bias_initializer_kwargs=None, conv_filters=None, conv_activation='relu', conv_kernel_initializer=None, conv_kernel_initializer_kwargs=None, conv_bias_initializer=None, conv_bias_initializer_kwargs=None, head_fcnet_hiddens=[], head_fcnet_activation='relu', head_fcnet_kernel_initializer=None, head_fcnet_kernel_initializer_kwargs=None, head_fcnet_bias_initializer=None, head_fcnet_bias_initializer_kwargs=None, free_log_std=False, log_std_clip_param=20.0, vf_share_layers=True, use_lstm=False, max_seq_len=20, lstm_cell_size=256, lstm_use_prev_action=False, lstm_use_prev_reward=False, lstm_kernel_initializer=None, lstm_kernel_initializer_kwargs=None, lstm_bias_initializer=None, lstm_bias_initializer_kwargs=None), catalog_class=None, load_state_path=None, model_config_dict=None)", "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "_validate_config": true, "_use_msgpack_checkpoints": false, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "env_task_fn": -1, "enable_connectors": -1, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.4821924166921, "kl_target": 0.0121335369454, "vf_loss_coeff": 0.5287301420718, "entropy_coeff": 0.0304386028221, "clip_param": 0.2973082591601, "vf_clip_param": 0.1116643404955, "entropy_coeff_schedule": null, "lr_schedule": null, "sgd_minibatch_size": -1, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9313529170176, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.callbacks.callbacks.RLlibCallback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 93.6881730556488, "iterations_since_restore": 19, "perf": {"cpu_util_percent": 12.914285714285715, "ram_util_percent": 83.39999999999999}}
{"timers": {"training_iteration": 4.306865503171113, "restore_env_runners": 1.6449681126095316e-05, "training_step": 4.3065947403347185, "env_runner_sampling_timer": 3.9054664512825656, "learner_update_timer": 0.39768305720612296, "synch_weights": 0.0014370392175131553, "restore_eval_env_runners": 1.3020056810312342e-05, "evaluation_iteration": 0.7462981884281753, "synch_eval_env_connectors": 0.00044980854235646193, "synch_env_connectors": 9.161088921794743e-06}, "env_runners": {"module_to_env_connector": {"timers": {"connectors": {"remove_single_ts_time_rank_from_batch": 1.4190967060288256e-06, "get_actions": 0.00016211916563273025, "tensor_to_numpy": 4.8390999111864906e-05, "normalize_and_clip_actions": 2.2510005156999024e-05, "un_batch_to_individual_items": 1.5182937004801435e-05, "listify_data_for_vector_env": 3.120687193311222e-05}}, "connector_pipeline_timer": 0.00035758159804868733}, "num_env_steps_sampled_lifetime": -4355000.0, "agent_episode_returns_mean": {"default_agent": 3.3}, "episode_return_mean": 3.3, "env_step_timer": 4.3953000404286235e-05, "num_agent_steps_sampled": {"default_agent": 5000.0}, "episode_len_min": 50, "env_to_module_connector": {"timers": {"connectors": {"add_observations_from_episodes_to_batch": 6.492557617082627e-06, "numpy_to_tensor": 3.127365678083569e-05, "add_states_from_episodes_to_batch": 3.498493591813587e-06, "add_time_dim_to_batch_and_zero_pad": 6.439046555359976e-06, "batch_individual_items": 1.8506577386402546e-05}}, "connector_pipeline_timer": 0.00011865794562952659}, "episode_return_min": -5.5, "env_to_module_sum_episodes_length_in": 27.16809333212661, "num_episodes": 100.0, "weights_seq_no": 19.0, "episode_return_max": 14.5, "num_episodes_lifetime": -87100.0, "episode_duration_sec_mean": 0.03772501202002786, "episode_len_max": 50, "num_agent_steps_sampled_lifetime": {"default_agent": -4355000.0}, "time_between_sampling": 0.01175017679239756, "num_module_steps_sampled": {"default_policy": 5000.0}, "rlmodule_inference_timer": 0.00012584108556421342, "num_env_steps_sampled": 5000.0, "episode_len_mean": 50.0, "env_reset_timer": 9.442668518658697e-05, "num_module_steps_sampled_lifetime": {"default_policy": -4355000.0}, "env_to_module_sum_episodes_length_out": 27.16809333212661, "sample": 0.038056749040745005, "module_episode_returns_mean": {"default_policy": 3.3}, "num_env_steps_sampled_lifetime_throughput": 1278.7556489386507}, "learners": {"__all_modules__": {"learner_connector_sum_episodes_length_out": 5100.0, "learner_connector": {"connector_pipeline_timer": 0.290052014386199, "timers": {"connectors": {"general_advantage_estimation": 0.013725929408873735, "add_time_dim_to_batch_and_zero_pad": 2.4568101039600297e-05, "batch_individual_items": 0.1963590969386891, "numpy_to_tensor": 0.00022004387255472604, "add_one_ts_to_episodes_and_truncate": 0.008691262945954467, "add_columns_from_episodes_to_train_batch": 0.06987595003441154, "add_observations_from_episodes_to_batch": 0.0007801718473104222, "add_states_from_episodes_to_batch": 6.105549947322913e-06}}}, "num_env_steps_trained": 30600, "num_env_steps_trained_lifetime": 612000, "num_module_steps_trained_lifetime": 120000, "num_trainable_parameters": 4965, "num_module_steps_trained": 6000, "num_non_trainable_parameters": 0, "learner_connector_sum_episodes_length_in": 5000.0, "num_env_steps_trained_lifetime_throughput": 856649.3271566486, "num_module_steps_trained_throughput": 168469.0843709349, "num_module_steps_trained_lifetime_throughput": 168387.09791550832}, "default_policy": {"diff_num_grad_updates_vs_sampler_policy": 1.0, "vf_explained_var": 0.26056212186813354, "curr_kl_coeff": 0.14482107758522034, "num_module_steps_trained_lifetime": 120000, "entropy": 0.6150454878807068, "num_trainable_parameters": 4965, "num_module_steps_trained": 6000, "default_optimizer_learning_rate": 0.0602050062423, "weights_seq_no": 20.0, "mean_kl_loss": 0.02945934794843197, "vf_loss": 0.10516753792762756, "vf_loss_unclipped": 37.33182144165039, "module_train_batch_size_mean": 1000.0, "curr_entropy_coeff": 0.0304386028221, "total_loss": -0.011343715712428093, "gradients_default_optimizer_global_norm": 0.3256956934928894, "policy_loss": -0.05107206478714943, "num_module_steps_trained_lifetime_throughput": 168587.22921503207}}, "num_training_step_calls_per_iteration": 1, "evaluation": {"env_runners": {"rlmodule_inference_timer": 9.559951781070393e-05, "env_to_module_sum_episodes_length_out": 27.168093332126602, "sample": 0.7345402242271759, "module_episode_returns_mean": {"default_policy": -0.9}, "episode_return_mean": -0.9, "num_agent_steps_sampled": {"default_agent": 1000}, "module_to_env_connector": {"timers": {"connectors": {"un_batch_to_individual_items": 1.5255966190051975e-05, "remove_single_ts_time_rank_from_batch": 1.5207494531132102e-06, "get_actions": 0.00015504205294852963, "normalize_and_clip_actions": 2.2443315199132686e-05, "tensor_to_numpy": 4.514834208077123e-05, "listify_data_for_vector_env": 3.050933161154259e-05}}, "connector_pipeline_timer": 0.00034371231630746127}, "env_step_timer": 4.218814506003077e-05, "env_to_module_connector": {"timers": {"connectors": {"add_observations_from_episodes_to_batch": 6.071050826296049e-06, "add_states_from_episodes_to_batch": 3.3322468531865133e-06, "add_time_dim_to_batch_and_zero_pad": 5.598110262518635e-06, "batch_individual_items": 1.806441084044739e-05, "numpy_to_tensor": 2.972403630027392e-05}}, "connector_pipeline_timer": 0.00011404087796221077}, "num_episodes": 20, "episode_return_max": 17.5, "env_reset_timer": 0.00020267018266120637, "weights_seq_no": 20.0, "episode_len_max": 50, "num_module_steps_sampled": {"default_policy": 1000}, "num_env_steps_sampled": 1000, "num_env_steps_sampled_lifetime": 101000, "agent_episode_returns_mean": {"default_agent": -0.9}, "episode_len_min": 50, "num_episodes_lifetime": 400, "episode_duration_sec_mean": 0.03537605903005897, "num_agent_steps_sampled_lifetime": {"default_agent": 20000}, "episode_len_mean": 50.0, "num_module_steps_sampled_lifetime": {"default_policy": 20000}, "episode_return_min": -16.5, "env_to_module_sum_episodes_length_in": 27.168093332126602, "time_between_sampling": 4.149415135409342}, "num_healthy_workers": 1, "actor_manager_num_outstanding_async_reqs": 0, "num_remote_worker_restarts": 0}, "num_env_steps_sampled_lifetime": -4355000.0, "fault_tolerance": {"num_healthy_workers": 0, "num_remote_worker_restarts": 0}, "env_runner_group": {"actor_manager_num_outstanding_async_reqs": 0}, "done": true, "training_iteration": 20, "trial_id": "148fb_00000", "date": "2025-08-11_17-51-26", "timestamp": 1754927486, "time_this_iter_s": 4.959202289581299, "time_total_s": 98.6473753452301, "pid": 97502, "hostname": "DESKTOP-3SK5A41", "node_ip": "192.168.40.242", "config": {"exploration_config": {}, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 6, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "env": "Umbrella", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": false, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 0, "create_local_env_runner": true, "num_envs_per_env_runner": 1, "gym_env_vectorize_mode": "SYNC", "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "episodes_to_numpy": true, "max_requests_in_flight_per_env_runner": 1, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "merge_env_runner_states": "training_only", "broadcast_env_runner_states": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "complete_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "sampler_perf_stats_ema_coef": null, "_is_online": true, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": "auto", "num_aggregator_actors_per_learner": 0, "max_requests_in_flight_per_aggregator_actor": 3, "local_gpu_idx": 0, "max_requests_in_flight_per_learner": 3, "gamma": 1, "lr": 0.0602050062423, "grad_clip": 0.5, "grad_clip_by": "global_norm", "_train_batch_size_per_learner": 5000, "train_batch_size": 4000, "num_epochs": 1, "minibatch_size": 1000, "shuffle_batch_per_epoch": true, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "log_std_clip_param": 20.0, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "_disable_preprocessor_api": false, "_disable_action_flattening": false}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "_learner_class": null, "callbacks_on_algorithm_init": null, "callbacks_on_env_runners_recreated": null, "callbacks_on_offline_eval_runners_recreated": null, "callbacks_on_checkpoint_loaded": null, "callbacks_on_environment_created": null, "callbacks_on_episode_created": null, "callbacks_on_episode_start": null, "callbacks_on_episode_step": null, "callbacks_on_episode_end": null, "callbacks_on_evaluate_start": null, "callbacks_on_evaluate_end": null, "callbacks_on_evaluate_offline_start": null, "callbacks_on_evaluate_offline_end": null, "callbacks_on_sample_end": null, "callbacks_on_train_result": null, "explore": true, "enable_rl_module_and_learner": true, "enable_env_runner_and_connector_v2": true, "_prior_exploration_config": {"type": "StochasticSampling"}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7f830969eac0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "offline_data_class": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_read_batch_size": null, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "materialize_data": false, "materialize_mapped_data": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "ignore_final_observation": false, "prelearner_class": null, "prelearner_buffer_class": null, "prelearner_buffer_kwargs": {}, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_remaining_data": false, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": 1, "evaluation_duration": 20, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_auto_duration_min_env_steps_per_sample": 100, "evaluation_auto_duration_max_env_steps_per_sample": 2000, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 1, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "offline_evaluation_interval": null, "num_offline_eval_runners": 0, "offline_loss_for_module_fn": null, "offline_evaluation_duration": 1, "offline_evaluation_parallel_to_training": false, "offline_evaluation_timeout_s": 120.0, "num_cpus_per_offline_eval_runner": 1, "num_gpus_per_offline_eval_runner": 0, "custom_resources_per_offline_eval_runner": {}, "restart_failed_offline_eval_runners": true, "ignore_offline_eval_runner_failures": false, "max_num_offline_eval_runner_restarts": 1000, "offline_eval_runner_restore_timeout_s": 1800.0, "max_requests_in_flight_per_offline_eval_runner": 1, "validate_offline_eval_runners_after_construction": true, "offline_eval_runner_health_probe_timeout_s": 30.0, "offline_eval_rl_module_inference_only": false, "broadcast_offline_eval_runner_states": false, "offline_eval_batch_size_per_runner": 256, "dataset_num_iters_per_eval_runner": 1, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "log_gradients": true, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 42, "restart_failed_env_runners": true, "ignore_env_runner_failures": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30.0, "env_runner_restore_timeout_s": 1800.0, "_model_config": {}, "_rl_module_spec": "RLModuleSpec(module_class=None, observation_space=None, action_space=None, inference_only=False, learner_only=False, model_config=DefaultModelConfig(fcnet_hiddens=[127, 34], fcnet_activation='tanh', fcnet_kernel_initializer=None, fcnet_kernel_initializer_kwargs=None, fcnet_bias_initializer=None, fcnet_bias_initializer_kwargs=None, conv_filters=None, conv_activation='relu', conv_kernel_initializer=None, conv_kernel_initializer_kwargs=None, conv_bias_initializer=None, conv_bias_initializer_kwargs=None, head_fcnet_hiddens=[], head_fcnet_activation='relu', head_fcnet_kernel_initializer=None, head_fcnet_kernel_initializer_kwargs=None, head_fcnet_bias_initializer=None, head_fcnet_bias_initializer_kwargs=None, free_log_std=False, log_std_clip_param=20.0, vf_share_layers=True, use_lstm=False, max_seq_len=20, lstm_cell_size=256, lstm_use_prev_action=False, lstm_use_prev_reward=False, lstm_kernel_initializer=None, lstm_kernel_initializer_kwargs=None, lstm_bias_initializer=None, lstm_bias_initializer_kwargs=None), catalog_class=None, load_state_path=None, model_config_dict=None)", "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "_validate_config": true, "_use_msgpack_checkpoints": false, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "env_task_fn": -1, "enable_connectors": -1, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.4821924166921, "kl_target": 0.0121335369454, "vf_loss_coeff": 0.5287301420718, "entropy_coeff": 0.0304386028221, "clip_param": 0.2973082591601, "vf_clip_param": 0.1116643404955, "entropy_coeff_schedule": null, "lr_schedule": null, "sgd_minibatch_size": -1, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9313529170176, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.callbacks.callbacks.RLlibCallback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 98.6473753452301, "iterations_since_restore": 20, "perf": {"cpu_util_percent": 12.771428571428572, "ram_util_percent": 83.39999999999999}}
