{"timers": {"training_iteration": 4.283070098999815, "restore_env_runners": 1.4100000043981709e-05, "training_step": 4.282777499000076, "env_runner_sampling_timer": 3.7872183989993573, "learner_update_timer": 0.4919777000004615, "synch_weights": 0.0014080000000831205}, "env_runners": {"env_to_module_connector": {"timers": {"connectors": {"add_observations_from_episodes_to_batch": 6.527102968854297e-06, "batch_individual_items": 1.8287402330277146e-05, "add_states_from_episodes_to_batch": 3.441494025062821e-06, "numpy_to_tensor": 3.0607471670193476e-05, "add_time_dim_to_batch_and_zero_pad": 6.690735939521217e-06}}, "connector_pipeline_timer": 0.00012142853718408338}, "module_to_env_connector": {"timers": {"connectors": {"listify_data_for_vector_env": 3.0671800509381586e-05, "remove_single_ts_time_rank_from_batch": 1.4388692270291483e-06, "get_actions": 0.00016353240417000777, "tensor_to_numpy": 4.617213997739183e-05, "normalize_and_clip_actions": 2.8054106187697398e-05, "un_batch_to_individual_items": 1.4967018373735241e-05}}, "connector_pipeline_timer": 0.0003614109690409539}, "sample": 0.03891027054623593, "num_module_steps_sampled": {"default_policy": 5000.0}, "num_env_steps_sampled_lifetime": 252500.0, "num_module_steps_sampled_lifetime": {"default_policy": 252500.0}, "weights_seq_no": 0.0, "episode_len_min": 50, "episode_duration_sec_mean": 0.03540212698995675, "time_between_sampling": 0.0012267191114531668, "episode_return_max": 14.5, "num_env_steps_sampled": 5000.0, "num_episodes": 100.0, "episode_len_mean": 50.0, "episode_return_min": -5.5, "env_to_module_sum_episodes_length_out": 26.762340024562445, "episode_return_mean": 3.899999999999998, "env_reset_timer": 0.00019811610220694354, "num_episodes_lifetime": 5050.0, "num_agent_steps_sampled": {"default_agent": 5000.0}, "num_agent_steps_sampled_lifetime": {"default_agent": 252500.0}, "episode_len_max": 50, "agent_episode_returns_mean": {"default_agent": 3.899999999999998}, "rlmodule_inference_timer": 0.00010179962043458982, "env_step_timer": 4.346032233508052e-05, "module_episode_returns_mean": {"default_policy": 3.899999999999998}, "env_to_module_sum_episodes_length_in": 26.762340024562445, "num_env_steps_sampled_lifetime_throughput": 1278.0744347422985}, "learners": {"__all_modules__": {"num_module_steps_trained_lifetime": 16000, "learner_connector_sum_episodes_length_out": 5100, "num_env_steps_trained_lifetime": 81600, "learner_connector_sum_episodes_length_in": 5000, "learner_connector": {"timers": {"connectors": {"add_columns_from_episodes_to_train_batch": 0.07059000000026572, "add_one_ts_to_episodes_and_truncate": 0.008423100000072736, "batch_individual_items": 0.20849120000002586, "add_states_from_episodes_to_batch": 6.100000064179767e-06, "numpy_to_tensor": 0.00016209999921557028, "general_advantage_estimation": 0.015003900000010617, "add_time_dim_to_batch_and_zero_pad": 2.3600000531587284e-05, "add_observations_from_episodes_to_batch": 0.0007816999996066443}}, "connector_pipeline_timer": 0.30382709999958024}, "num_trainable_parameters": 8697, "num_module_steps_trained": 16000, "num_non_trainable_parameters": 0, "num_env_steps_trained": 81600, "num_env_steps_trained_lifetime_throughput": 842181.7795561607, "num_module_steps_trained_throughput": 165779.57096604403, "num_module_steps_trained_lifetime_throughput": 165760.3281617142}, "default_policy": {"num_module_steps_trained_lifetime": 16000, "vf_loss_unclipped": 12.974632263183594, "vf_explained_var": 0.3449993133544922, "entropy": 0.4567550718784332, "module_train_batch_size_mean": 1000.0, "total_loss": 0.4333936870098114, "policy_loss": 0.20136642456054688, "gradients_default_optimizer_global_norm": 0.8064001202583313, "curr_kl_coeff": 0.15361620485782623, "curr_entropy_coeff": 0.0347123860443, "vf_loss": 0.38853660225868225, "weights_seq_no": 1.0, "default_optimizer_learning_rate": 0.0532857353826, "num_trainable_parameters": 8697, "diff_num_grad_updates_vs_sampler_policy": 1.0, "num_module_steps_trained": 16000, "mean_kl_loss": 0.414628803730011, "num_module_steps_trained_lifetime_throughput": 166043.49041419616}}, "num_training_step_calls_per_iteration": 1, "num_env_steps_sampled_lifetime": 252500.0, "evaluation": {"env_runners": {"num_episodes": 20, "episode_return_max": 17.5, "env_to_module_connector": {"timers": {"connectors": {"batch_individual_items": 1.7482668689822318e-05, "add_states_from_episodes_to_batch": 3.327451210866456e-06, "numpy_to_tensor": 2.927167296003995e-05, "add_time_dim_to_batch_and_zero_pad": 5.223045915639376e-06, "add_observations_from_episodes_to_batch": 5.818793675310184e-06}}, "connector_pipeline_timer": 0.00011408398822083085}, "num_episodes_lifetime": 20, "module_to_env_connector": {"timers": {"connectors": {"tensor_to_numpy": 4.545646522920524e-05, "un_batch_to_individual_items": 1.4767499062330638e-05, "get_actions": 0.00015153360700598543, "normalize_and_clip_actions": 2.1332887888382824e-05, "listify_data_for_vector_env": 2.9807967075045337e-05, "remove_single_ts_time_rank_from_batch": 1.465743978013727e-06}}, "connector_pipeline_timer": 0.00034125442242143787}, "env_reset_timer": 0.0003589999996620463, "num_agent_steps_sampled_lifetime": {"default_agent": 1000}, "num_module_steps_sampled_lifetime": {"default_policy": 1000}, "env_step_timer": 4.059125739726717e-05, "episode_len_max": 50, "env_to_module_sum_episodes_length_in": 27.167134025045954, "episode_return_min": -16.5, "env_to_module_sum_episodes_length_out": 27.167134025045954, "rlmodule_inference_timer": 9.349176657147838e-05, "sample": 0.7312426999997115, "episode_duration_sec_mean": 0.03511565500002689, "num_env_steps_sampled": 1000, "num_module_steps_sampled": {"default_policy": 1000}, "agent_episode_returns_mean": {"default_agent": -0.9}, "num_env_steps_sampled_lifetime": 6000, "num_agent_steps_sampled": {"default_agent": 1000}, "episode_len_min": 50, "weights_seq_no": 1.0, "episode_len_mean": 50.0, "episode_return_mean": -0.9, "module_episode_returns_mean": {"default_policy": -0.9}}, "num_healthy_workers": 1, "actor_manager_num_outstanding_async_reqs": 0, "num_remote_worker_restarts": 0}, "fault_tolerance": {"num_healthy_workers": 0, "num_remote_worker_restarts": 0}, "env_runner_group": {"actor_manager_num_outstanding_async_reqs": 0}, "done": false, "training_iteration": 1, "trial_id": "1482f_00000", "date": "2025-08-11_17-49-07", "timestamp": 1754927347, "time_this_iter_s": 5.029086351394653, "time_total_s": 5.029086351394653, "pid": 96629, "hostname": "DESKTOP-3SK5A41", "node_ip": "192.168.40.242", "config": {"exploration_config": {}, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 6, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "env": "Umbrella", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": false, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 0, "create_local_env_runner": true, "num_envs_per_env_runner": 1, "gym_env_vectorize_mode": "SYNC", "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "episodes_to_numpy": true, "max_requests_in_flight_per_env_runner": 1, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "merge_env_runner_states": "training_only", "broadcast_env_runner_states": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "complete_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "sampler_perf_stats_ema_coef": null, "_is_online": true, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": "auto", "num_aggregator_actors_per_learner": 0, "max_requests_in_flight_per_aggregator_actor": 3, "local_gpu_idx": 0, "max_requests_in_flight_per_learner": 3, "gamma": 1, "lr": 0.0532857353826, "grad_clip": 0.5, "grad_clip_by": "global_norm", "_train_batch_size_per_learner": 5000, "train_batch_size": 4000, "num_epochs": 3, "minibatch_size": 1000, "shuffle_batch_per_epoch": true, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "log_std_clip_param": 20.0, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "_disable_preprocessor_api": false, "_disable_action_flattening": false}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "_learner_class": null, "callbacks_on_algorithm_init": null, "callbacks_on_env_runners_recreated": null, "callbacks_on_offline_eval_runners_recreated": null, "callbacks_on_checkpoint_loaded": null, "callbacks_on_environment_created": null, "callbacks_on_episode_created": null, "callbacks_on_episode_start": null, "callbacks_on_episode_step": null, "callbacks_on_episode_end": null, "callbacks_on_evaluate_start": null, "callbacks_on_evaluate_end": null, "callbacks_on_evaluate_offline_start": null, "callbacks_on_evaluate_offline_end": null, "callbacks_on_sample_end": null, "callbacks_on_train_result": null, "explore": true, "enable_rl_module_and_learner": true, "enable_env_runner_and_connector_v2": true, "_prior_exploration_config": {"type": "StochasticSampling"}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7e97e1c12ac0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "offline_data_class": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_read_batch_size": null, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "materialize_data": false, "materialize_mapped_data": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "ignore_final_observation": false, "prelearner_class": null, "prelearner_buffer_class": null, "prelearner_buffer_kwargs": {}, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_remaining_data": false, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": 1, "evaluation_duration": 20, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_auto_duration_min_env_steps_per_sample": 100, "evaluation_auto_duration_max_env_steps_per_sample": 2000, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 1, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "offline_evaluation_interval": null, "num_offline_eval_runners": 0, "offline_loss_for_module_fn": null, "offline_evaluation_duration": 1, "offline_evaluation_parallel_to_training": false, "offline_evaluation_timeout_s": 120.0, "num_cpus_per_offline_eval_runner": 1, "num_gpus_per_offline_eval_runner": 0, "custom_resources_per_offline_eval_runner": {}, "restart_failed_offline_eval_runners": true, "ignore_offline_eval_runner_failures": false, "max_num_offline_eval_runner_restarts": 1000, "offline_eval_runner_restore_timeout_s": 1800.0, "max_requests_in_flight_per_offline_eval_runner": 1, "validate_offline_eval_runners_after_construction": true, "offline_eval_runner_health_probe_timeout_s": 30.0, "offline_eval_rl_module_inference_only": false, "broadcast_offline_eval_runner_states": false, "offline_eval_batch_size_per_runner": 256, "dataset_num_iters_per_eval_runner": 1, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "log_gradients": true, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 42, "restart_failed_env_runners": true, "ignore_env_runner_failures": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30.0, "env_runner_restore_timeout_s": 1800.0, "_model_config": {}, "_rl_module_spec": "RLModuleSpec(module_class=None, observation_space=None, action_space=None, inference_only=False, learner_only=False, model_config=DefaultModelConfig(fcnet_hiddens=[63, 126], fcnet_activation='tanh', fcnet_kernel_initializer=None, fcnet_kernel_initializer_kwargs=None, fcnet_bias_initializer=None, fcnet_bias_initializer_kwargs=None, conv_filters=None, conv_activation='relu', conv_kernel_initializer=None, conv_kernel_initializer_kwargs=None, conv_bias_initializer=None, conv_bias_initializer_kwargs=None, head_fcnet_hiddens=[], head_fcnet_activation='relu', head_fcnet_kernel_initializer=None, head_fcnet_kernel_initializer_kwargs=None, head_fcnet_bias_initializer=None, head_fcnet_bias_initializer_kwargs=None, free_log_std=False, log_std_clip_param=20.0, vf_share_layers=True, use_lstm=False, max_seq_len=20, lstm_cell_size=256, lstm_use_prev_action=False, lstm_use_prev_reward=False, lstm_kernel_initializer=None, lstm_kernel_initializer_kwargs=None, lstm_bias_initializer=None, lstm_bias_initializer_kwargs=None), catalog_class=None, load_state_path=None, model_config_dict=None)", "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "_validate_config": true, "_use_msgpack_checkpoints": false, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "env_task_fn": -1, "enable_connectors": -1, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.1024108006331, "kl_target": 0.0216481916482, "vf_loss_coeff": 0.5287015453939, "entropy_coeff": 0.0347123860443, "clip_param": 0.1072861819248, "vf_clip_param": 0.4447244315309, "entropy_coeff_schedule": null, "lr_schedule": null, "sgd_minibatch_size": -1, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9119716444993, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.callbacks.callbacks.RLlibCallback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 5.029086351394653, "iterations_since_restore": 1, "perf": {"cpu_util_percent": 11.912499999999998, "ram_util_percent": 87.5375}}
{"timers": {"training_iteration": 4.281324083849813, "restore_env_runners": 1.4096000049903522e-05, "training_step": 4.281030680850081, "env_runner_sampling_timer": 3.7881009318593626, "learner_update_timer": 0.4893304379904566, "synch_weights": 0.0014273090000824595, "restore_eval_env_runners": 1.3900000340072438e-05, "evaluation_iteration": 0.7428438000006281, "synch_eval_env_connectors": 0.0004716000003099907, "synch_env_connectors": 8.100000741251279e-06}, "env_runners": {"env_to_module_connector": {"timers": {"connectors": {"add_observations_from_episodes_to_batch": 6.466566053020396e-06, "batch_individual_items": 1.8074478182879036e-05, "add_states_from_episodes_to_batch": 3.41693155945499e-06, "numpy_to_tensor": 3.0856582303710164e-05, "add_time_dim_to_batch_and_zero_pad": 6.516856000205037e-06}}, "connector_pipeline_timer": 0.00011824550968081976}, "module_to_env_connector": {"timers": {"connectors": {"listify_data_for_vector_env": 3.091780815703529e-05, "remove_single_ts_time_rank_from_batch": 1.4275331891568475e-06, "get_actions": 0.00016250720046248534, "tensor_to_numpy": 4.81607471433944e-05, "normalize_and_clip_actions": 2.2273292780463063e-05, "un_batch_to_individual_items": 1.4802511468304523e-05}}, "connector_pipeline_timer": 0.00035661772104965026}, "sample": 0.037636767431172745, "num_module_steps_sampled": {"default_policy": 5000.0}, "num_env_steps_sampled_lifetime": 10000.0, "num_module_steps_sampled_lifetime": {"default_policy": 10000.0}, "weights_seq_no": 1.0, "episode_len_min": 50, "episode_duration_sec_mean": 0.03621906784997918, "time_between_sampling": 0.0094569795202594, "episode_return_max": 14.5, "num_env_steps_sampled": 5000.0, "num_episodes": 100.0, "episode_len_mean": 50.0, "episode_return_min": -5.5, "env_to_module_sum_episodes_length_out": 27.16809333212661, "episode_return_mean": -3.3, "env_reset_timer": 0.00013282047395749014, "num_episodes_lifetime": 200.0, "num_agent_steps_sampled": {"default_agent": 5000.0}, "num_agent_steps_sampled_lifetime": {"default_agent": 10000.0}, "episode_len_max": 50, "agent_episode_returns_mean": {"default_agent": -3.3}, "rlmodule_inference_timer": 9.97396236235363e-05, "env_step_timer": 4.274305011868413e-05, "module_episode_returns_mean": {"default_policy": -3.3}, "env_to_module_sum_episodes_length_in": 27.16809333212661, "num_env_steps_sampled_lifetime_throughput": 1297.044671710039}, "learners": {"__all_modules__": {"num_module_steps_trained_lifetime": 32000, "learner_connector_sum_episodes_length_out": 5100.0, "num_env_steps_trained_lifetime": 163200, "learner_connector_sum_episodes_length_in": 5000.0, "learner_connector": {"timers": {"connectors": {"add_columns_from_episodes_to_train_batch": 0.07055995099026403, "add_one_ts_to_episodes_and_truncate": 0.008422335000068415, "batch_individual_items": 0.20698954800002864, "add_states_from_episodes_to_batch": 6.099000065660221e-06, "numpy_to_tensor": 0.00016214599922022898, "general_advantage_estimation": 0.014949596000014935, "add_time_dim_to_batch_and_zero_pad": 2.359900052397279e-05, "add_observations_from_episodes_to_batch": 0.0007810959996095335}}, "connector_pipeline_timer": 0.3022395199895891}, "num_trainable_parameters": 8697, "num_module_steps_trained": 16000, "num_non_trainable_parameters": 0, "num_env_steps_trained": 81600, "num_env_steps_trained_lifetime_throughput": 846475.469762722, "num_module_steps_trained_throughput": 166607.3535063412, "num_module_steps_trained_lifetime_throughput": 166587.34974405178}, "default_policy": {"num_module_steps_trained_lifetime": 32000, "vf_loss_unclipped": 9.507091522216797, "vf_explained_var": 0.17542046308517456, "entropy": 0.626102089881897, "module_train_batch_size_mean": 1000.0, "total_loss": 0.3108268082141876, "policy_loss": 0.09831461310386658, "gradients_default_optimizer_global_norm": 1.6289957761764526, "curr_kl_coeff": 0.23042431473731995, "curr_entropy_coeff": 0.0347123860443, "vf_loss": 0.425763338804245, "weights_seq_no": 2.0, "default_optimizer_learning_rate": 0.0532857353826, "num_trainable_parameters": 8697, "diff_num_grad_updates_vs_sampler_policy": 1.0, "num_module_steps_trained": 16000, "mean_kl_loss": 0.0595250278711319, "num_module_steps_trained_lifetime_throughput": 166863.57185636405}}, "num_training_step_calls_per_iteration": 1, "evaluation": {"env_runners": {"num_episodes": 20, "episode_return_max": 17.5, "env_to_module_connector": {"timers": {"connectors": {"batch_individual_items": 1.7851199067140866e-05, "add_states_from_episodes_to_batch": 3.4220733423265747e-06, "numpy_to_tensor": 2.9131741208149063e-05, "add_time_dim_to_batch_and_zero_pad": 5.4655187307503615e-06, "add_observations_from_episodes_to_batch": 5.771432815121049e-06}}, "connector_pipeline_timer": 0.0001151206389466619}, "num_episodes_lifetime": 40, "module_to_env_connector": {"timers": {"connectors": {"tensor_to_numpy": 4.544881127893209e-05, "un_batch_to_individual_items": 1.4862253873059015e-05, "get_actions": 0.0001538208344319422, "normalize_and_clip_actions": 2.1511898244588134e-05, "listify_data_for_vector_env": 2.992327414110865e-05, "remove_single_ts_time_rank_from_batch": 1.4048442327896772e-06}}, "connector_pipeline_timer": 0.00034435796751025745}, "env_reset_timer": 0.00035668099966642327, "num_agent_steps_sampled_lifetime": {"default_agent": 2000}, "num_module_steps_sampled_lifetime": {"default_policy": 2000}, "env_step_timer": 4.21723018718972e-05, "episode_len_max": 50, "env_to_module_sum_episodes_length_in": 27.168093298253442, "episode_return_min": -16.5, "env_to_module_sum_episodes_length_out": 27.168093298253442, "rlmodule_inference_timer": 9.42064117580498e-05, "sample": 0.7311909749697133, "episode_duration_sec_mean": 0.03500450492504115, "num_env_steps_sampled": 1000, "num_module_steps_sampled": {"default_policy": 1000}, "agent_episode_returns_mean": {"default_agent": 0.6}, "num_env_steps_sampled_lifetime": 11000, "num_agent_steps_sampled": {"default_agent": 1000}, "episode_len_min": 50, "weights_seq_no": 2.0, "episode_len_mean": 50.0, "episode_return_mean": 0.6, "module_episode_returns_mean": {"default_policy": 0.6}, "time_between_sampling": 4.162850883999454}, "num_healthy_workers": 1, "actor_manager_num_outstanding_async_reqs": 0, "num_remote_worker_restarts": 0}, "num_env_steps_sampled_lifetime": 10000.0, "fault_tolerance": {"num_healthy_workers": 0, "num_remote_worker_restarts": 0}, "env_runner_group": {"actor_manager_num_outstanding_async_reqs": 0}, "done": false, "training_iteration": 2, "trial_id": "1482f_00000", "date": "2025-08-11_17-49-12", "timestamp": 1754927352, "time_this_iter_s": 4.848259449005127, "time_total_s": 9.87734580039978, "pid": 96629, "hostname": "DESKTOP-3SK5A41", "node_ip": "192.168.40.242", "config": {"exploration_config": {}, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 6, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "env": "Umbrella", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": false, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 0, "create_local_env_runner": true, "num_envs_per_env_runner": 1, "gym_env_vectorize_mode": "SYNC", "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "episodes_to_numpy": true, "max_requests_in_flight_per_env_runner": 1, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "merge_env_runner_states": "training_only", "broadcast_env_runner_states": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "complete_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "sampler_perf_stats_ema_coef": null, "_is_online": true, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": "auto", "num_aggregator_actors_per_learner": 0, "max_requests_in_flight_per_aggregator_actor": 3, "local_gpu_idx": 0, "max_requests_in_flight_per_learner": 3, "gamma": 1, "lr": 0.0532857353826, "grad_clip": 0.5, "grad_clip_by": "global_norm", "_train_batch_size_per_learner": 5000, "train_batch_size": 4000, "num_epochs": 3, "minibatch_size": 1000, "shuffle_batch_per_epoch": true, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "log_std_clip_param": 20.0, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "_disable_preprocessor_api": false, "_disable_action_flattening": false}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "_learner_class": null, "callbacks_on_algorithm_init": null, "callbacks_on_env_runners_recreated": null, "callbacks_on_offline_eval_runners_recreated": null, "callbacks_on_checkpoint_loaded": null, "callbacks_on_environment_created": null, "callbacks_on_episode_created": null, "callbacks_on_episode_start": null, "callbacks_on_episode_step": null, "callbacks_on_episode_end": null, "callbacks_on_evaluate_start": null, "callbacks_on_evaluate_end": null, "callbacks_on_evaluate_offline_start": null, "callbacks_on_evaluate_offline_end": null, "callbacks_on_sample_end": null, "callbacks_on_train_result": null, "explore": true, "enable_rl_module_and_learner": true, "enable_env_runner_and_connector_v2": true, "_prior_exploration_config": {"type": "StochasticSampling"}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7e97e1c12ac0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "offline_data_class": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_read_batch_size": null, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "materialize_data": false, "materialize_mapped_data": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "ignore_final_observation": false, "prelearner_class": null, "prelearner_buffer_class": null, "prelearner_buffer_kwargs": {}, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_remaining_data": false, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": 1, "evaluation_duration": 20, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_auto_duration_min_env_steps_per_sample": 100, "evaluation_auto_duration_max_env_steps_per_sample": 2000, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 1, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "offline_evaluation_interval": null, "num_offline_eval_runners": 0, "offline_loss_for_module_fn": null, "offline_evaluation_duration": 1, "offline_evaluation_parallel_to_training": false, "offline_evaluation_timeout_s": 120.0, "num_cpus_per_offline_eval_runner": 1, "num_gpus_per_offline_eval_runner": 0, "custom_resources_per_offline_eval_runner": {}, "restart_failed_offline_eval_runners": true, "ignore_offline_eval_runner_failures": false, "max_num_offline_eval_runner_restarts": 1000, "offline_eval_runner_restore_timeout_s": 1800.0, "max_requests_in_flight_per_offline_eval_runner": 1, "validate_offline_eval_runners_after_construction": true, "offline_eval_runner_health_probe_timeout_s": 30.0, "offline_eval_rl_module_inference_only": false, "broadcast_offline_eval_runner_states": false, "offline_eval_batch_size_per_runner": 256, "dataset_num_iters_per_eval_runner": 1, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "log_gradients": true, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 42, "restart_failed_env_runners": true, "ignore_env_runner_failures": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30.0, "env_runner_restore_timeout_s": 1800.0, "_model_config": {}, "_rl_module_spec": "RLModuleSpec(module_class=None, observation_space=None, action_space=None, inference_only=False, learner_only=False, model_config=DefaultModelConfig(fcnet_hiddens=[63, 126], fcnet_activation='tanh', fcnet_kernel_initializer=None, fcnet_kernel_initializer_kwargs=None, fcnet_bias_initializer=None, fcnet_bias_initializer_kwargs=None, conv_filters=None, conv_activation='relu', conv_kernel_initializer=None, conv_kernel_initializer_kwargs=None, conv_bias_initializer=None, conv_bias_initializer_kwargs=None, head_fcnet_hiddens=[], head_fcnet_activation='relu', head_fcnet_kernel_initializer=None, head_fcnet_kernel_initializer_kwargs=None, head_fcnet_bias_initializer=None, head_fcnet_bias_initializer_kwargs=None, free_log_std=False, log_std_clip_param=20.0, vf_share_layers=True, use_lstm=False, max_seq_len=20, lstm_cell_size=256, lstm_use_prev_action=False, lstm_use_prev_reward=False, lstm_kernel_initializer=None, lstm_kernel_initializer_kwargs=None, lstm_bias_initializer=None, lstm_bias_initializer_kwargs=None), catalog_class=None, load_state_path=None, model_config_dict=None)", "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "_validate_config": true, "_use_msgpack_checkpoints": false, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "env_task_fn": -1, "enable_connectors": -1, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.1024108006331, "kl_target": 0.0216481916482, "vf_loss_coeff": 0.5287015453939, "entropy_coeff": 0.0347123860443, "clip_param": 0.1072861819248, "vf_clip_param": 0.4447244315309, "entropy_coeff_schedule": null, "lr_schedule": null, "sgd_minibatch_size": -1, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9119716444993, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.callbacks.callbacks.RLlibCallback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 9.87734580039978, "iterations_since_restore": 2, "perf": {"cpu_util_percent": 13.442857142857145, "ram_util_percent": 87.6857142857143}}
{"timers": {"training_iteration": 4.281290991851317, "restore_env_runners": 1.4095040051324758e-05, "training_step": 4.280995819881578, "env_runner_sampling_timer": 3.790502122390768, "learner_update_timer": 0.4868952966005487, "synch_weights": 0.0014263409100838543, "restore_eval_env_runners": 1.3896000336899305e-05, "evaluation_iteration": 0.7427722519706186, "synch_eval_env_connectors": 0.0004710250003063265, "synch_env_connectors": 8.089000730251429e-06}, "env_runners": {"env_to_module_connector": {"timers": {"connectors": {"add_observations_from_episodes_to_batch": 6.485493501458512e-06, "batch_individual_items": 1.8188322760198674e-05, "add_states_from_episodes_to_batch": 3.4621948082885573e-06, "numpy_to_tensor": 3.114474669990357e-05, "add_time_dim_to_batch_and_zero_pad": 6.5109204402709136e-06}}, "connector_pipeline_timer": 0.00011928801609673606}, "module_to_env_connector": {"timers": {"connectors": {"listify_data_for_vector_env": 3.070171092616632e-05, "remove_single_ts_time_rank_from_batch": 1.4309119421940437e-06, "get_actions": 0.00016338229880544057, "tensor_to_numpy": 4.8497189522951044e-05, "normalize_and_clip_actions": 2.232507085609449e-05, "un_batch_to_individual_items": 1.48330796207131e-05}}, "connector_pipeline_timer": 0.0003580200497672921}, "sample": 0.03785785477152127, "num_module_steps_sampled": {"default_policy": 5000.0}, "num_env_steps_sampled_lifetime": -232500.0, "num_module_steps_sampled_lifetime": {"default_policy": -232500.0}, "weights_seq_no": 2.0, "episode_len_min": 50, "episode_duration_sec_mean": 0.037766288849998095, "time_between_sampling": 0.010812656855023894, "episode_return_max": 14.5, "num_env_steps_sampled": 5000.0, "num_episodes": 100.0, "episode_len_mean": 50.0, "episode_return_min": -5.5, "env_to_module_sum_episodes_length_out": 27.16809333212661, "episode_return_mean": 1.9, "env_reset_timer": 0.00010808155763600226, "num_episodes_lifetime": -4650.0, "num_agent_steps_sampled": {"default_agent": 5000.0}, "num_agent_steps_sampled_lifetime": {"default_agent": -232500.0}, "episode_len_max": 50, "agent_episode_returns_mean": {"default_agent": 1.9}, "rlmodule_inference_timer": 0.00013440625439513929, "env_step_timer": 4.2826371067473175e-05, "module_episode_returns_mean": {"default_policy": 1.9}, "env_to_module_sum_episodes_length_in": 27.16809333212661, "num_env_steps_sampled_lifetime_throughput": 1278.5159705369372}, "learners": {"__all_modules__": {"num_module_steps_trained_lifetime": 48000, "learner_connector_sum_episodes_length_out": 5100.0, "num_env_steps_trained_lifetime": 244800, "learner_connector_sum_episodes_length_in": 5000.0, "learner_connector": {"timers": {"connectors": {"add_columns_from_episodes_to_train_batch": 0.07053810648036142, "add_one_ts_to_episodes_and_truncate": 0.008423663650068193, "batch_individual_items": 0.20550622052002718, "add_states_from_episodes_to_batch": 6.094010063952738e-06, "numpy_to_tensor": 0.0001623835392316323, "general_advantage_estimation": 0.014932910040019396, "add_time_dim_to_batch_and_zero_pad": 2.360101052108803e-05, "add_observations_from_episodes_to_batch": 0.0007802570396053852}}, "connector_pipeline_timer": 0.30071798278969264}, "num_trainable_parameters": 8697, "num_module_steps_trained": 16000, "num_non_trainable_parameters": 0, "num_env_steps_trained": 81600, "num_env_steps_trained_lifetime_throughput": 848231.1440779495, "num_module_steps_trained_throughput": 166932.65019538946, "num_module_steps_trained_lifetime_throughput": 166910.84386014857}, "default_policy": {"num_module_steps_trained_lifetime": 48000, "vf_loss_unclipped": 15.631722450256348, "vf_explained_var": 0.21717774868011475, "entropy": 0.5249860882759094, "module_train_batch_size_mean": 1000.0, "total_loss": 0.28109487891197205, "policy_loss": 0.06342668831348419, "gradients_default_optimizer_global_norm": 1.0347273349761963, "curr_kl_coeff": 0.3456364870071411, "curr_entropy_coeff": 0.0347123860443, "vf_loss": 0.42533811926841736, "weights_seq_no": 3.0, "default_optimizer_learning_rate": 0.0532857353826, "num_trainable_parameters": 8697, "diff_num_grad_updates_vs_sampler_policy": 1.0, "num_module_steps_trained": 16000, "mean_kl_loss": 0.04780231788754463, "num_module_steps_trained_lifetime_throughput": 167176.05365602963}}, "num_training_step_calls_per_iteration": 1, "evaluation": {"env_runners": {"num_episodes": 20, "episode_return_max": 17.5, "env_to_module_connector": {"timers": {"connectors": {"batch_individual_items": 1.7363157645913545e-05, "add_states_from_episodes_to_batch": 3.3755535679846357e-06, "numpy_to_tensor": 2.8684607501516128e-05, "add_time_dim_to_batch_and_zero_pad": 5.406123124343405e-06, "add_observations_from_episodes_to_batch": 5.774779303894959e-06}}, "connector_pipeline_timer": 0.00011362346001348552}, "num_episodes_lifetime": 60, "module_to_env_connector": {"timers": {"connectors": {"tensor_to_numpy": 4.5725399707527866e-05, "un_batch_to_individual_items": 1.4709370208279247e-05, "get_actions": 0.0001522676150271117, "normalize_and_clip_actions": 2.1193191663752494e-05, "listify_data_for_vector_env": 2.9428189118574774e-05, "remove_single_ts_time_rank_from_batch": 1.4729226328802551e-06}}, "connector_pipeline_timer": 0.000340663179652925}, "env_reset_timer": 0.0003544211896720298, "num_agent_steps_sampled_lifetime": {"default_agent": 3000}, "num_module_steps_sampled_lifetime": {"default_policy": 3000}, "env_step_timer": 4.055329765530401e-05, "episode_len_max": 50, "env_to_module_sum_episodes_length_in": 27.168093332125434, "episode_return_min": -16.5, "env_to_module_sum_episodes_length_out": 27.168093332125434, "rlmodule_inference_timer": 9.369607369245682e-05, "sample": 0.7311448512100189, "episode_duration_sec_mean": 0.03497819660001369, "num_env_steps_sampled": 1000, "num_module_steps_sampled": {"default_policy": 1000}, "agent_episode_returns_mean": {"default_agent": 1.4333333333333333}, "num_env_steps_sampled_lifetime": 16000, "num_agent_steps_sampled": {"default_agent": 1000}, "episode_len_min": 50, "weights_seq_no": 3.0, "episode_len_mean": 50.0, "episode_return_mean": 1.4333333333333333, "module_episode_returns_mean": {"default_policy": 1.4333333333333333}, "time_between_sampling": 4.164553676999458}, "num_healthy_workers": 1, "actor_manager_num_outstanding_async_reqs": 0, "num_remote_worker_restarts": 0}, "num_env_steps_sampled_lifetime": -232500.0, "fault_tolerance": {"num_healthy_workers": 0, "num_remote_worker_restarts": 0}, "env_runner_group": {"actor_manager_num_outstanding_async_reqs": 0}, "done": false, "training_iteration": 3, "trial_id": "1482f_00000", "date": "2025-08-11_17-49-17", "timestamp": 1754927357, "time_this_iter_s": 5.019304990768433, "time_total_s": 14.896650791168213, "pid": 96629, "hostname": "DESKTOP-3SK5A41", "node_ip": "192.168.40.242", "config": {"exploration_config": {}, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 6, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "env": "Umbrella", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": false, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 0, "create_local_env_runner": true, "num_envs_per_env_runner": 1, "gym_env_vectorize_mode": "SYNC", "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "episodes_to_numpy": true, "max_requests_in_flight_per_env_runner": 1, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "merge_env_runner_states": "training_only", "broadcast_env_runner_states": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "complete_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "sampler_perf_stats_ema_coef": null, "_is_online": true, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": "auto", "num_aggregator_actors_per_learner": 0, "max_requests_in_flight_per_aggregator_actor": 3, "local_gpu_idx": 0, "max_requests_in_flight_per_learner": 3, "gamma": 1, "lr": 0.0532857353826, "grad_clip": 0.5, "grad_clip_by": "global_norm", "_train_batch_size_per_learner": 5000, "train_batch_size": 4000, "num_epochs": 3, "minibatch_size": 1000, "shuffle_batch_per_epoch": true, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "log_std_clip_param": 20.0, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "_disable_preprocessor_api": false, "_disable_action_flattening": false}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "_learner_class": null, "callbacks_on_algorithm_init": null, "callbacks_on_env_runners_recreated": null, "callbacks_on_offline_eval_runners_recreated": null, "callbacks_on_checkpoint_loaded": null, "callbacks_on_environment_created": null, "callbacks_on_episode_created": null, "callbacks_on_episode_start": null, "callbacks_on_episode_step": null, "callbacks_on_episode_end": null, "callbacks_on_evaluate_start": null, "callbacks_on_evaluate_end": null, "callbacks_on_evaluate_offline_start": null, "callbacks_on_evaluate_offline_end": null, "callbacks_on_sample_end": null, "callbacks_on_train_result": null, "explore": true, "enable_rl_module_and_learner": true, "enable_env_runner_and_connector_v2": true, "_prior_exploration_config": {"type": "StochasticSampling"}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7e97e1c12ac0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "offline_data_class": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_read_batch_size": null, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "materialize_data": false, "materialize_mapped_data": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "ignore_final_observation": false, "prelearner_class": null, "prelearner_buffer_class": null, "prelearner_buffer_kwargs": {}, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_remaining_data": false, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": 1, "evaluation_duration": 20, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_auto_duration_min_env_steps_per_sample": 100, "evaluation_auto_duration_max_env_steps_per_sample": 2000, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 1, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "offline_evaluation_interval": null, "num_offline_eval_runners": 0, "offline_loss_for_module_fn": null, "offline_evaluation_duration": 1, "offline_evaluation_parallel_to_training": false, "offline_evaluation_timeout_s": 120.0, "num_cpus_per_offline_eval_runner": 1, "num_gpus_per_offline_eval_runner": 0, "custom_resources_per_offline_eval_runner": {}, "restart_failed_offline_eval_runners": true, "ignore_offline_eval_runner_failures": false, "max_num_offline_eval_runner_restarts": 1000, "offline_eval_runner_restore_timeout_s": 1800.0, "max_requests_in_flight_per_offline_eval_runner": 1, "validate_offline_eval_runners_after_construction": true, "offline_eval_runner_health_probe_timeout_s": 30.0, "offline_eval_rl_module_inference_only": false, "broadcast_offline_eval_runner_states": false, "offline_eval_batch_size_per_runner": 256, "dataset_num_iters_per_eval_runner": 1, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "log_gradients": true, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 42, "restart_failed_env_runners": true, "ignore_env_runner_failures": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30.0, "env_runner_restore_timeout_s": 1800.0, "_model_config": {}, "_rl_module_spec": "RLModuleSpec(module_class=None, observation_space=None, action_space=None, inference_only=False, learner_only=False, model_config=DefaultModelConfig(fcnet_hiddens=[63, 126], fcnet_activation='tanh', fcnet_kernel_initializer=None, fcnet_kernel_initializer_kwargs=None, fcnet_bias_initializer=None, fcnet_bias_initializer_kwargs=None, conv_filters=None, conv_activation='relu', conv_kernel_initializer=None, conv_kernel_initializer_kwargs=None, conv_bias_initializer=None, conv_bias_initializer_kwargs=None, head_fcnet_hiddens=[], head_fcnet_activation='relu', head_fcnet_kernel_initializer=None, head_fcnet_kernel_initializer_kwargs=None, head_fcnet_bias_initializer=None, head_fcnet_bias_initializer_kwargs=None, free_log_std=False, log_std_clip_param=20.0, vf_share_layers=True, use_lstm=False, max_seq_len=20, lstm_cell_size=256, lstm_use_prev_action=False, lstm_use_prev_reward=False, lstm_kernel_initializer=None, lstm_kernel_initializer_kwargs=None, lstm_bias_initializer=None, lstm_bias_initializer_kwargs=None), catalog_class=None, load_state_path=None, model_config_dict=None)", "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "_validate_config": true, "_use_msgpack_checkpoints": false, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "env_task_fn": -1, "enable_connectors": -1, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.1024108006331, "kl_target": 0.0216481916482, "vf_loss_coeff": 0.5287015453939, "entropy_coeff": 0.0347123860443, "clip_param": 0.1072861819248, "vf_clip_param": 0.4447244315309, "entropy_coeff_schedule": null, "lr_schedule": null, "sgd_minibatch_size": -1, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9119716444993, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.callbacks.callbacks.RLlibCallback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 14.896650791168213, "iterations_since_restore": 3, "perf": {"cpu_util_percent": 12.7, "ram_util_percent": 87.61428571428573}}
{"timers": {"training_iteration": 4.280892120862805, "restore_env_runners": 1.4129089655485584e-05, "training_step": 4.280595290612758, "env_runner_sampling_timer": 3.7911127850968596, "learner_update_timer": 0.48588397363454544, "synch_weights": 0.0014258885009819113, "restore_eval_env_runners": 1.3887040332065225e-05, "evaluation_iteration": 0.7427090854409103, "synch_eval_env_connectors": 0.0004706767503029368, "synch_env_connectors": 8.081110724015163e-06}, "env_runners": {"env_to_module_connector": {"timers": {"connectors": {"add_observations_from_episodes_to_batch": 6.409012488690218e-06, "batch_individual_items": 1.7999084669201983e-05, "add_states_from_episodes_to_batch": 3.400279568594098e-06, "numpy_to_tensor": 3.072687310449948e-05, "add_time_dim_to_batch_and_zero_pad": 6.45835560117073e-06}}, "connector_pipeline_timer": 0.00011775850081638688}, "module_to_env_connector": {"timers": {"connectors": {"listify_data_for_vector_env": 3.074802936418413e-05, "remove_single_ts_time_rank_from_batch": 1.4562587452377138e-06, "get_actions": 0.00016207970098800043, "tensor_to_numpy": 4.808591169714071e-05, "normalize_and_clip_actions": 2.2061871081469283e-05, "un_batch_to_individual_items": 1.4748785188192316e-05}}, "connector_pipeline_timer": 0.0003556858158773612}, "sample": 0.03791733423657581, "num_module_steps_sampled": {"default_policy": 5000.0}, "num_env_steps_sampled_lifetime": -475000.0, "num_module_steps_sampled_lifetime": {"default_policy": -475000.0}, "weights_seq_no": 3.0, "episode_len_min": 50, "episode_duration_sec_mean": 0.036008982940029466, "time_between_sampling": 0.011425495731313027, "episode_return_max": 14.5, "num_env_steps_sampled": 5000.0, "num_episodes": 100.0, "episode_len_mean": 50.0, "episode_return_min": -5.5, "env_to_module_sum_episodes_length_out": 27.16809333212661, "episode_return_mean": 6.299999999999996, "env_reset_timer": 9.885673586996964e-05, "num_episodes_lifetime": -9500.0, "num_agent_steps_sampled": {"default_agent": 5000.0}, "num_agent_steps_sampled_lifetime": {"default_agent": -475000.0}, "episode_len_max": 50, "agent_episode_returns_mean": {"default_agent": 6.299999999999996}, "rlmodule_inference_timer": 9.883099880575161e-05, "env_step_timer": 4.237840460091487e-05, "module_episode_returns_mean": {"default_policy": 6.299999999999996}, "env_to_module_sum_episodes_length_in": 27.16809333212661, "num_env_steps_sampled_lifetime_throughput": 1295.6812092896555}, "learners": {"__all_modules__": {"num_module_steps_trained_lifetime": 64000, "learner_connector_sum_episodes_length_out": 5100.0, "num_env_steps_trained_lifetime": 326400, "learner_connector_sum_episodes_length_in": 5000.0, "learner_connector": {"timers": {"connectors": {"add_columns_from_episodes_to_train_batch": 0.07051055541556199, "add_one_ts_to_episodes_and_truncate": 0.008424099013561101, "batch_individual_items": 0.2054672873148302, "add_states_from_episodes_to_batch": 6.11106995697719e-06, "numpy_to_tensor": 0.00016240870384458866, "general_advantage_estimation": 0.014897333939615199, "add_time_dim_to_batch_and_zero_pad": 2.3883000422072657e-05, "add_observations_from_episodes_to_batch": 0.0007797144692114652}}, "connector_pipeline_timer": 0.3006158259617896}, "num_trainable_parameters": 8697, "num_module_steps_trained": 16000, "num_non_trainable_parameters": 0, "num_env_steps_trained": 81600, "num_env_steps_trained_lifetime_throughput": 849455.6340444182, "num_module_steps_trained_throughput": 167148.8217233547, "num_module_steps_trained_lifetime_throughput": 167126.40472792718}, "default_policy": {"num_module_steps_trained_lifetime": 64000, "vf_loss_unclipped": 21.26962661743164, "vf_explained_var": 0.1416475772857666, "entropy": 0.45748305320739746, "module_train_batch_size_mean": 1000.0, "total_loss": 0.27123963832855225, "policy_loss": 0.03717781975865364, "gradients_default_optimizer_global_norm": 0.8331597447395325, "curr_kl_coeff": 0.3456364870071411, "curr_entropy_coeff": 0.0347123860443, "vf_loss": 0.44472458958625793, "weights_seq_no": 4.0, "default_optimizer_learning_rate": 0.0532857353826, "num_trainable_parameters": 8697, "diff_num_grad_updates_vs_sampler_policy": 1.0, "num_module_steps_trained": 16000, "mean_kl_loss": 0.04286477342247963, "num_module_steps_trained_lifetime_throughput": 167378.4195126909}}, "num_training_step_calls_per_iteration": 1, "evaluation": {"env_runners": {"num_episodes": 20, "episode_return_max": 17.5, "env_to_module_connector": {"timers": {"connectors": {"batch_individual_items": 1.7556911791483244e-05, "add_states_from_episodes_to_batch": 3.4209207591599365e-06, "numpy_to_tensor": 2.971684479653393e-05, "add_time_dim_to_batch_and_zero_pad": 5.529415830356072e-06, "add_observations_from_episodes_to_batch": 5.958882455577315e-06}}, "connector_pipeline_timer": 0.00011581410717941087}, "num_episodes_lifetime": 80, "module_to_env_connector": {"timers": {"connectors": {"tensor_to_numpy": 4.4620955232886846e-05, "un_batch_to_individual_items": 1.483618693212906e-05, "get_actions": 0.00015398274311643958, "normalize_and_clip_actions": 2.1361342010637107e-05, "listify_data_for_vector_env": 2.9796115866791338e-05, "remove_single_ts_time_rank_from_batch": 1.3692783665756703e-06}}, "connector_pipeline_timer": 0.00034249979064940035}, "env_reset_timer": 0.0003521529777779996, "num_agent_steps_sampled_lifetime": {"default_agent": 4000}, "num_module_steps_sampled_lifetime": {"default_policy": 4000}, "env_step_timer": 4.147605340440535e-05, "episode_len_max": 50, "env_to_module_sum_episodes_length_in": 27.168093332126602, "episode_return_min": -16.5, "env_to_module_sum_episodes_length_out": 27.168093332126602, "rlmodule_inference_timer": 9.264269874724759e-05, "sample": 0.7311253186879181, "episode_duration_sec_mean": 0.034997182449990304, "num_env_steps_sampled": 1000, "num_module_steps_sampled": {"default_policy": 1000}, "agent_episode_returns_mean": {"default_agent": 1.1}, "num_env_steps_sampled_lifetime": 21000, "num_agent_steps_sampled": {"default_agent": 1000}, "episode_len_min": 50, "weights_seq_no": 4.0, "episode_len_mean": 50.0, "episode_return_mean": 1.1, "module_episode_returns_mean": {"default_policy": 1.1}, "time_between_sampling": 4.165886288159461}, "num_healthy_workers": 1, "actor_manager_num_outstanding_async_reqs": 0, "num_remote_worker_restarts": 0}, "num_env_steps_sampled_lifetime": -475000.0, "fault_tolerance": {"num_healthy_workers": 0, "num_remote_worker_restarts": 0}, "env_runner_group": {"actor_manager_num_outstanding_async_reqs": 0}, "done": false, "training_iteration": 4, "trial_id": "1482f_00000", "date": "2025-08-11_17-49-22", "timestamp": 1754927362, "time_this_iter_s": 4.985507488250732, "time_total_s": 19.882158279418945, "pid": 96629, "hostname": "DESKTOP-3SK5A41", "node_ip": "192.168.40.242", "config": {"exploration_config": {}, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 6, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "env": "Umbrella", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": false, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 0, "create_local_env_runner": true, "num_envs_per_env_runner": 1, "gym_env_vectorize_mode": "SYNC", "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "episodes_to_numpy": true, "max_requests_in_flight_per_env_runner": 1, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "merge_env_runner_states": "training_only", "broadcast_env_runner_states": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "complete_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "sampler_perf_stats_ema_coef": null, "_is_online": true, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": "auto", "num_aggregator_actors_per_learner": 0, "max_requests_in_flight_per_aggregator_actor": 3, "local_gpu_idx": 0, "max_requests_in_flight_per_learner": 3, "gamma": 1, "lr": 0.0532857353826, "grad_clip": 0.5, "grad_clip_by": "global_norm", "_train_batch_size_per_learner": 5000, "train_batch_size": 4000, "num_epochs": 3, "minibatch_size": 1000, "shuffle_batch_per_epoch": true, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "log_std_clip_param": 20.0, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "_disable_preprocessor_api": false, "_disable_action_flattening": false}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "_learner_class": null, "callbacks_on_algorithm_init": null, "callbacks_on_env_runners_recreated": null, "callbacks_on_offline_eval_runners_recreated": null, "callbacks_on_checkpoint_loaded": null, "callbacks_on_environment_created": null, "callbacks_on_episode_created": null, "callbacks_on_episode_start": null, "callbacks_on_episode_step": null, "callbacks_on_episode_end": null, "callbacks_on_evaluate_start": null, "callbacks_on_evaluate_end": null, "callbacks_on_evaluate_offline_start": null, "callbacks_on_evaluate_offline_end": null, "callbacks_on_sample_end": null, "callbacks_on_train_result": null, "explore": true, "enable_rl_module_and_learner": true, "enable_env_runner_and_connector_v2": true, "_prior_exploration_config": {"type": "StochasticSampling"}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7e97e1c12ac0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "offline_data_class": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_read_batch_size": null, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "materialize_data": false, "materialize_mapped_data": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "ignore_final_observation": false, "prelearner_class": null, "prelearner_buffer_class": null, "prelearner_buffer_kwargs": {}, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_remaining_data": false, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": 1, "evaluation_duration": 20, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_auto_duration_min_env_steps_per_sample": 100, "evaluation_auto_duration_max_env_steps_per_sample": 2000, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 1, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "offline_evaluation_interval": null, "num_offline_eval_runners": 0, "offline_loss_for_module_fn": null, "offline_evaluation_duration": 1, "offline_evaluation_parallel_to_training": false, "offline_evaluation_timeout_s": 120.0, "num_cpus_per_offline_eval_runner": 1, "num_gpus_per_offline_eval_runner": 0, "custom_resources_per_offline_eval_runner": {}, "restart_failed_offline_eval_runners": true, "ignore_offline_eval_runner_failures": false, "max_num_offline_eval_runner_restarts": 1000, "offline_eval_runner_restore_timeout_s": 1800.0, "max_requests_in_flight_per_offline_eval_runner": 1, "validate_offline_eval_runners_after_construction": true, "offline_eval_runner_health_probe_timeout_s": 30.0, "offline_eval_rl_module_inference_only": false, "broadcast_offline_eval_runner_states": false, "offline_eval_batch_size_per_runner": 256, "dataset_num_iters_per_eval_runner": 1, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "log_gradients": true, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 42, "restart_failed_env_runners": true, "ignore_env_runner_failures": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30.0, "env_runner_restore_timeout_s": 1800.0, "_model_config": {}, "_rl_module_spec": "RLModuleSpec(module_class=None, observation_space=None, action_space=None, inference_only=False, learner_only=False, model_config=DefaultModelConfig(fcnet_hiddens=[63, 126], fcnet_activation='tanh', fcnet_kernel_initializer=None, fcnet_kernel_initializer_kwargs=None, fcnet_bias_initializer=None, fcnet_bias_initializer_kwargs=None, conv_filters=None, conv_activation='relu', conv_kernel_initializer=None, conv_kernel_initializer_kwargs=None, conv_bias_initializer=None, conv_bias_initializer_kwargs=None, head_fcnet_hiddens=[], head_fcnet_activation='relu', head_fcnet_kernel_initializer=None, head_fcnet_kernel_initializer_kwargs=None, head_fcnet_bias_initializer=None, head_fcnet_bias_initializer_kwargs=None, free_log_std=False, log_std_clip_param=20.0, vf_share_layers=True, use_lstm=False, max_seq_len=20, lstm_cell_size=256, lstm_use_prev_action=False, lstm_use_prev_reward=False, lstm_kernel_initializer=None, lstm_kernel_initializer_kwargs=None, lstm_bias_initializer=None, lstm_bias_initializer_kwargs=None), catalog_class=None, load_state_path=None, model_config_dict=None)", "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "_validate_config": true, "_use_msgpack_checkpoints": false, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "env_task_fn": -1, "enable_connectors": -1, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.1024108006331, "kl_target": 0.0216481916482, "vf_loss_coeff": 0.5287015453939, "entropy_coeff": 0.0347123860443, "clip_param": 0.1072861819248, "vf_clip_param": 0.4447244315309, "entropy_coeff_schedule": null, "lr_schedule": null, "sgd_minibatch_size": -1, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9119716444993, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.callbacks.callbacks.RLlibCallback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 19.882158279418945, "iterations_since_restore": 4, "perf": {"cpu_util_percent": 13.142857142857142, "ram_util_percent": 87.70000000000002}}
{"timers": {"training_iteration": 4.279225783624171, "restore_env_runners": 1.4121798760638774e-05, "training_step": 4.278927256676628, "env_runner_sampling_timer": 3.791813391215892, "learner_update_timer": 0.4835137828981972, "synch_weights": 0.0014253996159771165, "restore_eval_env_runners": 1.3906169931301519e-05, "evaluation_iteration": 0.7426736155664985, "synch_eval_env_connectors": 0.0004706419827953877, "synch_env_connectors": 8.064299612975447e-06}, "env_runners": {"env_to_module_connector": {"timers": {"connectors": {"add_observations_from_episodes_to_batch": 6.436028161114049e-06, "batch_individual_items": 1.8045620579646533e-05, "add_states_from_episodes_to_batch": 3.4195082279128685e-06, "numpy_to_tensor": 3.071914009122649e-05, "add_time_dim_to_batch_and_zero_pad": 6.4903922340186205e-06}}, "connector_pipeline_timer": 0.00011813468159414909}, "module_to_env_connector": {"timers": {"connectors": {"listify_data_for_vector_env": 3.066098537910372e-05, "remove_single_ts_time_rank_from_batch": 1.4155331502694562e-06, "get_actions": 0.00016196412370285027, "tensor_to_numpy": 4.7994039764900135e-05, "normalize_and_clip_actions": 2.2368987203035603e-05, "un_batch_to_individual_items": 1.479928418530312e-05}}, "connector_pipeline_timer": 0.0003555875929052055}, "sample": 0.03741000782286329, "num_module_steps_sampled": {"default_policy": 5000.0}, "num_env_steps_sampled_lifetime": -717500.0, "num_module_steps_sampled_lifetime": {"default_policy": -717500.0}, "weights_seq_no": 4.0, "episode_len_min": 50, "episode_duration_sec_mean": 0.03608654197008944, "time_between_sampling": 0.01255153929342786, "episode_return_max": 14.5, "num_env_steps_sampled": 5000.0, "num_episodes": 100.0, "episode_len_mean": 50.0, "episode_return_min": -5.5, "env_to_module_sum_episodes_length_out": 27.16809333212661, "episode_return_mean": 5.899999999999999, "env_reset_timer": 9.644314716792998e-05, "num_episodes_lifetime": -14350.0, "num_agent_steps_sampled": {"default_agent": 5000.0}, "num_agent_steps_sampled_lifetime": {"default_agent": -717500.0}, "episode_len_max": 50, "agent_episode_returns_mean": {"default_agent": 5.899999999999999}, "rlmodule_inference_timer": 9.921862564385519e-05, "env_step_timer": 4.251332363796134e-05, "module_episode_returns_mean": {"default_policy": 5.899999999999999}, "env_to_module_sum_episodes_length_in": 27.16809333212661, "num_env_steps_sampled_lifetime_throughput": 1294.6922255903528}, "learners": {"__all_modules__": {"num_module_steps_trained_lifetime": 80000, "learner_connector_sum_episodes_length_out": 5100.0, "num_env_steps_trained_lifetime": 408000, "learner_connector_sum_episodes_length_in": 5000.0, "learner_connector": {"timers": {"connectors": {"add_columns_from_episodes_to_train_batch": 0.07047822586140762, "add_one_ts_to_episodes_and_truncate": 0.008421820023429331, "batch_individual_items": 0.20400968644168235, "add_states_from_episodes_to_batch": 6.100959263758805e-06, "numpy_to_tensor": 0.0001625166168067721, "general_advantage_estimation": 0.014869476600219303, "add_time_dim_to_batch_and_zero_pad": 2.3851170420626222e-05, "add_observations_from_episodes_to_batch": 0.000778806324515941}}, "connector_pipeline_timer": 0.29909492770217116}, "num_trainable_parameters": 8697, "num_module_steps_trained": 16000, "num_non_trainable_parameters": 0, "num_env_steps_trained": 81600, "num_env_steps_trained_lifetime_throughput": 848831.8192879197, "num_module_steps_trained_throughput": 167000.26093740208, "num_module_steps_trained_lifetime_throughput": 166977.61620280193}, "default_policy": {"num_module_steps_trained_lifetime": 80000, "vf_loss_unclipped": 14.425762176513672, "vf_explained_var": 0.18417131900787354, "entropy": 0.45379549264907837, "module_train_batch_size_mean": 1000.0, "total_loss": 0.17832356691360474, "policy_loss": 0.002909914357587695, "gradients_default_optimizer_global_norm": 0.7065791487693787, "curr_kl_coeff": 0.3456364870071411, "curr_entropy_coeff": 0.0347123860443, "vf_loss": 0.342660516500473, "weights_seq_no": 5.0, "default_optimizer_learning_rate": 0.0532857353826, "num_trainable_parameters": 8697, "diff_num_grad_updates_vs_sampler_policy": 1.0, "num_module_steps_trained": 16000, "mean_kl_loss": 0.028934508562088013, "num_module_steps_trained_lifetime_throughput": 167216.55212821622}}, "num_training_step_calls_per_iteration": 1, "evaluation": {"env_runners": {"num_episodes": 20, "episode_return_max": 17.5, "env_to_module_connector": {"timers": {"connectors": {"batch_individual_items": 1.7756255745821317e-05, "add_states_from_episodes_to_batch": 3.372285846123946e-06, "numpy_to_tensor": 2.9659603390704492e-05, "add_time_dim_to_batch_and_zero_pad": 5.4844951971202855e-06, "add_observations_from_episodes_to_batch": 6.074311517277842e-06}}, "connector_pipeline_timer": 0.00011601681611321239}, "num_episodes_lifetime": 100, "module_to_env_connector": {"timers": {"connectors": {"tensor_to_numpy": 4.546515917479759e-05, "un_batch_to_individual_items": 1.4885746043529174e-05, "get_actions": 0.0001563627273388734, "normalize_and_clip_actions": 2.1967749065786522e-05, "listify_data_for_vector_env": 3.109376295544272e-05, "remove_single_ts_time_rank_from_batch": 1.4541107799455698e-06}}, "connector_pipeline_timer": 0.0003476285015367598}, "env_reset_timer": 0.00034993444799931726, "num_agent_steps_sampled_lifetime": {"default_agent": 5000}, "num_module_steps_sampled_lifetime": {"default_policy": 5000}, "env_step_timer": 4.139452859028481e-05, "episode_len_max": 50, "env_to_module_sum_episodes_length_in": 27.168093332126602, "episode_return_min": -16.5, "env_to_module_sum_episodes_length_out": 27.168093332126602, "rlmodule_inference_timer": 9.489521293358463e-05, "sample": 0.7311147065010405, "episode_duration_sec_mean": 0.03501561395999488, "num_env_steps_sampled": 1000, "num_module_steps_sampled": {"default_policy": 1000}, "agent_episode_returns_mean": {"default_agent": 1.1}, "num_env_steps_sampled_lifetime": 26000, "num_agent_steps_sampled": {"default_agent": 1000}, "episode_len_min": 50, "weights_seq_no": 5.0, "episode_len_mean": 50.0, "episode_return_mean": 1.1, "module_episode_returns_mean": {"default_policy": 1.1}, "time_between_sampling": 4.165921927237867}, "num_healthy_workers": 1, "actor_manager_num_outstanding_async_reqs": 0, "num_remote_worker_restarts": 0}, "num_env_steps_sampled_lifetime": -717500.0, "fault_tolerance": {"num_healthy_workers": 0, "num_remote_worker_restarts": 0}, "env_runner_group": {"actor_manager_num_outstanding_async_reqs": 0}, "done": false, "training_iteration": 5, "trial_id": "1482f_00000", "date": "2025-08-11_17-49-27", "timestamp": 1754927367, "time_this_iter_s": 4.8592774868011475, "time_total_s": 24.741435766220093, "pid": 96629, "hostname": "DESKTOP-3SK5A41", "node_ip": "192.168.40.242", "config": {"exploration_config": {}, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 6, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "env": "Umbrella", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": false, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 0, "create_local_env_runner": true, "num_envs_per_env_runner": 1, "gym_env_vectorize_mode": "SYNC", "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "episodes_to_numpy": true, "max_requests_in_flight_per_env_runner": 1, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "merge_env_runner_states": "training_only", "broadcast_env_runner_states": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "complete_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "sampler_perf_stats_ema_coef": null, "_is_online": true, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": "auto", "num_aggregator_actors_per_learner": 0, "max_requests_in_flight_per_aggregator_actor": 3, "local_gpu_idx": 0, "max_requests_in_flight_per_learner": 3, "gamma": 1, "lr": 0.0532857353826, "grad_clip": 0.5, "grad_clip_by": "global_norm", "_train_batch_size_per_learner": 5000, "train_batch_size": 4000, "num_epochs": 3, "minibatch_size": 1000, "shuffle_batch_per_epoch": true, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "log_std_clip_param": 20.0, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "_disable_preprocessor_api": false, "_disable_action_flattening": false}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "_learner_class": null, "callbacks_on_algorithm_init": null, "callbacks_on_env_runners_recreated": null, "callbacks_on_offline_eval_runners_recreated": null, "callbacks_on_checkpoint_loaded": null, "callbacks_on_environment_created": null, "callbacks_on_episode_created": null, "callbacks_on_episode_start": null, "callbacks_on_episode_step": null, "callbacks_on_episode_end": null, "callbacks_on_evaluate_start": null, "callbacks_on_evaluate_end": null, "callbacks_on_evaluate_offline_start": null, "callbacks_on_evaluate_offline_end": null, "callbacks_on_sample_end": null, "callbacks_on_train_result": null, "explore": true, "enable_rl_module_and_learner": true, "enable_env_runner_and_connector_v2": true, "_prior_exploration_config": {"type": "StochasticSampling"}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7e97e1c12ac0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "offline_data_class": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_read_batch_size": null, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "materialize_data": false, "materialize_mapped_data": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "ignore_final_observation": false, "prelearner_class": null, "prelearner_buffer_class": null, "prelearner_buffer_kwargs": {}, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_remaining_data": false, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": 1, "evaluation_duration": 20, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_auto_duration_min_env_steps_per_sample": 100, "evaluation_auto_duration_max_env_steps_per_sample": 2000, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 1, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "offline_evaluation_interval": null, "num_offline_eval_runners": 0, "offline_loss_for_module_fn": null, "offline_evaluation_duration": 1, "offline_evaluation_parallel_to_training": false, "offline_evaluation_timeout_s": 120.0, "num_cpus_per_offline_eval_runner": 1, "num_gpus_per_offline_eval_runner": 0, "custom_resources_per_offline_eval_runner": {}, "restart_failed_offline_eval_runners": true, "ignore_offline_eval_runner_failures": false, "max_num_offline_eval_runner_restarts": 1000, "offline_eval_runner_restore_timeout_s": 1800.0, "max_requests_in_flight_per_offline_eval_runner": 1, "validate_offline_eval_runners_after_construction": true, "offline_eval_runner_health_probe_timeout_s": 30.0, "offline_eval_rl_module_inference_only": false, "broadcast_offline_eval_runner_states": false, "offline_eval_batch_size_per_runner": 256, "dataset_num_iters_per_eval_runner": 1, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "log_gradients": true, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 42, "restart_failed_env_runners": true, "ignore_env_runner_failures": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30.0, "env_runner_restore_timeout_s": 1800.0, "_model_config": {}, "_rl_module_spec": "RLModuleSpec(module_class=None, observation_space=None, action_space=None, inference_only=False, learner_only=False, model_config=DefaultModelConfig(fcnet_hiddens=[63, 126], fcnet_activation='tanh', fcnet_kernel_initializer=None, fcnet_kernel_initializer_kwargs=None, fcnet_bias_initializer=None, fcnet_bias_initializer_kwargs=None, conv_filters=None, conv_activation='relu', conv_kernel_initializer=None, conv_kernel_initializer_kwargs=None, conv_bias_initializer=None, conv_bias_initializer_kwargs=None, head_fcnet_hiddens=[], head_fcnet_activation='relu', head_fcnet_kernel_initializer=None, head_fcnet_kernel_initializer_kwargs=None, head_fcnet_bias_initializer=None, head_fcnet_bias_initializer_kwargs=None, free_log_std=False, log_std_clip_param=20.0, vf_share_layers=True, use_lstm=False, max_seq_len=20, lstm_cell_size=256, lstm_use_prev_action=False, lstm_use_prev_reward=False, lstm_kernel_initializer=None, lstm_kernel_initializer_kwargs=None, lstm_bias_initializer=None, lstm_bias_initializer_kwargs=None), catalog_class=None, load_state_path=None, model_config_dict=None)", "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "_validate_config": true, "_use_msgpack_checkpoints": false, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "env_task_fn": -1, "enable_connectors": -1, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.1024108006331, "kl_target": 0.0216481916482, "vf_loss_coeff": 0.5287015453939, "entropy_coeff": 0.0347123860443, "clip_param": 0.1072861819248, "vf_clip_param": 0.4447244315309, "entropy_coeff_schedule": null, "lr_schedule": null, "sgd_minibatch_size": -1, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9119716444993, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.callbacks.callbacks.RLlibCallback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 24.741435766220093, "iterations_since_restore": 5, "perf": {"cpu_util_percent": 13.157142857142858, "ram_util_percent": 87.70000000000002}}
{"timers": {"training_iteration": 4.279126081767932, "restore_env_runners": 1.409058077389153e-05, "training_step": 4.278826632089856, "env_runner_sampling_timer": 3.79267799728373, "learner_update_timer": 0.4825491130692107, "synch_weights": 0.0014245676198191557, "restore_eval_env_runners": 1.3875108235808555e-05, "evaluation_iteration": 0.7426476264108258, "synch_eval_env_connectors": 0.0004700185629708814, "synch_env_connectors": 8.043656609872997e-06}, "env_runners": {"env_to_module_connector": {"timers": {"connectors": {"add_observations_from_episodes_to_batch": 6.482258669532651e-06, "batch_individual_items": 1.814251117998691e-05, "add_states_from_episodes_to_batch": 3.4620038914770556e-06, "numpy_to_tensor": 3.097004039195161e-05, "add_time_dim_to_batch_and_zero_pad": 6.602273661402165e-06}}, "connector_pipeline_timer": 0.00011894325228860242}, "module_to_env_connector": {"timers": {"connectors": {"listify_data_for_vector_env": 3.081960996167154e-05, "remove_single_ts_time_rank_from_batch": 1.4345614174959703e-06, "get_actions": 0.00016289341693629763, "tensor_to_numpy": 4.8193536449146976e-05, "normalize_and_clip_actions": 2.231129984183866e-05, "un_batch_to_individual_items": 1.4880162958178088e-05}}, "connector_pipeline_timer": 0.00035738533830854643}, "sample": 0.03726831513742587, "num_module_steps_sampled": {"default_policy": 5000.0}, "num_env_steps_sampled_lifetime": -960000.0, "num_module_steps_sampled_lifetime": {"default_policy": -960000.0}, "weights_seq_no": 5.0, "episode_len_min": 50, "episode_duration_sec_mean": 0.03625889097999789, "time_between_sampling": 0.01210492171461718, "episode_return_max": 14.5, "num_env_steps_sampled": 5000.0, "num_episodes": 100.0, "episode_len_mean": 50.0, "episode_return_min": -5.5, "env_to_module_sum_episodes_length_out": 27.16809333212661, "episode_return_mean": 0.09999999999999998, "env_reset_timer": 9.372219612643727e-05, "num_episodes_lifetime": -19200.0, "num_agent_steps_sampled": {"default_agent": 5000.0}, "num_agent_steps_sampled_lifetime": {"default_agent": -960000.0}, "episode_len_max": 50, "agent_episode_returns_mean": {"default_agent": 0.09999999999999998}, "rlmodule_inference_timer": 9.966285498597878e-05, "env_step_timer": 4.2680090295019344e-05, "module_episode_returns_mean": {"default_policy": 0.09999999999999998}, "env_to_module_sum_episodes_length_in": 27.16809333212661, "num_env_steps_sampled_lifetime_throughput": 1292.5210863166265}, "learners": {"__all_modules__": {"num_module_steps_trained_lifetime": 96000, "learner_connector_sum_episodes_length_out": 5100.0, "num_env_steps_trained_lifetime": 489600, "learner_connector_sum_episodes_length_in": 5000.0, "learner_connector": {"timers": {"connectors": {"add_columns_from_episodes_to_train_batch": 0.0704610626027938, "add_one_ts_to_episodes_and_truncate": 0.008420983823197567, "batch_individual_items": 0.20398311557726614, "add_states_from_episodes_to_batch": 6.095949670070336e-06, "numpy_to_tensor": 0.0001625474506336139, "general_advantage_estimation": 0.014817471834208323, "add_time_dim_to_batch_and_zero_pad": 2.3823658722367386e-05, "add_observations_from_episodes_to_batch": 0.0007784162612687016}}, "connector_pipeline_timer": 0.2989979034251479}, "num_trainable_parameters": 8697, "num_module_steps_trained": 16000, "num_non_trainable_parameters": 0, "num_env_steps_trained": 81600, "num_env_steps_trained_lifetime_throughput": 848055.8417930086, "num_module_steps_trained_throughput": 166824.47789718097, "num_module_steps_trained_lifetime_throughput": 166802.0573397525}, "default_policy": {"num_module_steps_trained_lifetime": 96000, "vf_loss_unclipped": 6.620060920715332, "vf_explained_var": 0.45222538709640503, "entropy": 0.5042178630828857, "module_train_batch_size_mean": 1000.0, "total_loss": 0.23734447360038757, "policy_loss": 0.02491181343793869, "gradients_default_optimizer_global_norm": 1.7447611093521118, "curr_kl_coeff": 0.5184547305107117, "curr_entropy_coeff": 0.0347123860443, "vf_loss": 0.35532253980636597, "weights_seq_no": 6.0, "default_optimizer_learning_rate": 0.0532857353826, "num_trainable_parameters": 8697, "diff_num_grad_updates_vs_sampler_policy": 1.0, "num_module_steps_trained": 16000, "mean_kl_loss": 0.12173401564359665, "num_module_steps_trained_lifetime_throughput": 167026.1017074556}}, "num_training_step_calls_per_iteration": 1, "evaluation": {"env_runners": {"num_episodes": 20, "episode_return_max": 17.5, "env_to_module_connector": {"timers": {"connectors": {"batch_individual_items": 1.7733883152373855e-05, "add_states_from_episodes_to_batch": 3.3011982466141866e-06, "numpy_to_tensor": 2.917114097745223e-05, "add_time_dim_to_batch_and_zero_pad": 5.569659420842031e-06, "add_observations_from_episodes_to_batch": 5.691586094380302e-06}}, "connector_pipeline_timer": 0.00011488511561793276}, "num_episodes_lifetime": 120, "module_to_env_connector": {"timers": {"connectors": {"tensor_to_numpy": 4.4508390590286814e-05, "un_batch_to_individual_items": 1.4957834013858534e-05, "get_actions": 0.00015322638670839842, "normalize_and_clip_actions": 2.1360584141495813e-05, "listify_data_for_vector_env": 2.994288707242741e-05, "remove_single_ts_time_rank_from_batch": 1.38475565568437e-06}}, "connector_pipeline_timer": 0.00034221941616701626}, "env_reset_timer": 0.00034767610351926043, "num_agent_steps_sampled_lifetime": {"default_agent": 6000}, "num_module_steps_sampled_lifetime": {"default_policy": 6000}, "env_step_timer": 4.2005356877868764e-05, "episode_len_max": 50, "env_to_module_sum_episodes_length_in": 27.168093332126602, "episode_return_min": -16.5, "env_to_module_sum_episodes_length_out": 27.168093332126602, "rlmodule_inference_timer": 9.422557769153099e-05, "sample": 0.7310673924260319, "episode_duration_sec_mean": 0.0349738149499899, "num_env_steps_sampled": 1000, "num_module_steps_sampled": {"default_policy": 1000}, "agent_episode_returns_mean": {"default_agent": 1.7}, "num_env_steps_sampled_lifetime": 31000, "num_agent_steps_sampled": {"default_agent": 1000}, "episode_len_min": 50, "weights_seq_no": 6.0, "episode_len_mean": 50.0, "episode_return_mean": 1.7, "module_episode_returns_mean": {"default_policy": 1.7}, "time_between_sampling": 4.167510025945491}, "num_healthy_workers": 1, "actor_manager_num_outstanding_async_reqs": 0, "num_remote_worker_restarts": 0}, "num_env_steps_sampled_lifetime": -960000.0, "fault_tolerance": {"num_healthy_workers": 0, "num_remote_worker_restarts": 0}, "env_runner_group": {"actor_manager_num_outstanding_async_reqs": 0}, "done": false, "training_iteration": 6, "trial_id": "1482f_00000", "date": "2025-08-11_17-49-32", "timestamp": 1754927372, "time_this_iter_s": 5.010427474975586, "time_total_s": 29.75186324119568, "pid": 96629, "hostname": "DESKTOP-3SK5A41", "node_ip": "192.168.40.242", "config": {"exploration_config": {}, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 6, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "env": "Umbrella", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": false, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 0, "create_local_env_runner": true, "num_envs_per_env_runner": 1, "gym_env_vectorize_mode": "SYNC", "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "episodes_to_numpy": true, "max_requests_in_flight_per_env_runner": 1, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "merge_env_runner_states": "training_only", "broadcast_env_runner_states": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "complete_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "sampler_perf_stats_ema_coef": null, "_is_online": true, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": "auto", "num_aggregator_actors_per_learner": 0, "max_requests_in_flight_per_aggregator_actor": 3, "local_gpu_idx": 0, "max_requests_in_flight_per_learner": 3, "gamma": 1, "lr": 0.0532857353826, "grad_clip": 0.5, "grad_clip_by": "global_norm", "_train_batch_size_per_learner": 5000, "train_batch_size": 4000, "num_epochs": 3, "minibatch_size": 1000, "shuffle_batch_per_epoch": true, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "log_std_clip_param": 20.0, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "_disable_preprocessor_api": false, "_disable_action_flattening": false}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "_learner_class": null, "callbacks_on_algorithm_init": null, "callbacks_on_env_runners_recreated": null, "callbacks_on_offline_eval_runners_recreated": null, "callbacks_on_checkpoint_loaded": null, "callbacks_on_environment_created": null, "callbacks_on_episode_created": null, "callbacks_on_episode_start": null, "callbacks_on_episode_step": null, "callbacks_on_episode_end": null, "callbacks_on_evaluate_start": null, "callbacks_on_evaluate_end": null, "callbacks_on_evaluate_offline_start": null, "callbacks_on_evaluate_offline_end": null, "callbacks_on_sample_end": null, "callbacks_on_train_result": null, "explore": true, "enable_rl_module_and_learner": true, "enable_env_runner_and_connector_v2": true, "_prior_exploration_config": {"type": "StochasticSampling"}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7e97e1c12ac0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "offline_data_class": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_read_batch_size": null, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "materialize_data": false, "materialize_mapped_data": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "ignore_final_observation": false, "prelearner_class": null, "prelearner_buffer_class": null, "prelearner_buffer_kwargs": {}, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_remaining_data": false, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": 1, "evaluation_duration": 20, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_auto_duration_min_env_steps_per_sample": 100, "evaluation_auto_duration_max_env_steps_per_sample": 2000, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 1, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "offline_evaluation_interval": null, "num_offline_eval_runners": 0, "offline_loss_for_module_fn": null, "offline_evaluation_duration": 1, "offline_evaluation_parallel_to_training": false, "offline_evaluation_timeout_s": 120.0, "num_cpus_per_offline_eval_runner": 1, "num_gpus_per_offline_eval_runner": 0, "custom_resources_per_offline_eval_runner": {}, "restart_failed_offline_eval_runners": true, "ignore_offline_eval_runner_failures": false, "max_num_offline_eval_runner_restarts": 1000, "offline_eval_runner_restore_timeout_s": 1800.0, "max_requests_in_flight_per_offline_eval_runner": 1, "validate_offline_eval_runners_after_construction": true, "offline_eval_runner_health_probe_timeout_s": 30.0, "offline_eval_rl_module_inference_only": false, "broadcast_offline_eval_runner_states": false, "offline_eval_batch_size_per_runner": 256, "dataset_num_iters_per_eval_runner": 1, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "log_gradients": true, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 42, "restart_failed_env_runners": true, "ignore_env_runner_failures": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30.0, "env_runner_restore_timeout_s": 1800.0, "_model_config": {}, "_rl_module_spec": "RLModuleSpec(module_class=None, observation_space=None, action_space=None, inference_only=False, learner_only=False, model_config=DefaultModelConfig(fcnet_hiddens=[63, 126], fcnet_activation='tanh', fcnet_kernel_initializer=None, fcnet_kernel_initializer_kwargs=None, fcnet_bias_initializer=None, fcnet_bias_initializer_kwargs=None, conv_filters=None, conv_activation='relu', conv_kernel_initializer=None, conv_kernel_initializer_kwargs=None, conv_bias_initializer=None, conv_bias_initializer_kwargs=None, head_fcnet_hiddens=[], head_fcnet_activation='relu', head_fcnet_kernel_initializer=None, head_fcnet_kernel_initializer_kwargs=None, head_fcnet_bias_initializer=None, head_fcnet_bias_initializer_kwargs=None, free_log_std=False, log_std_clip_param=20.0, vf_share_layers=True, use_lstm=False, max_seq_len=20, lstm_cell_size=256, lstm_use_prev_action=False, lstm_use_prev_reward=False, lstm_kernel_initializer=None, lstm_kernel_initializer_kwargs=None, lstm_bias_initializer=None, lstm_bias_initializer_kwargs=None), catalog_class=None, load_state_path=None, model_config_dict=None)", "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "_validate_config": true, "_use_msgpack_checkpoints": false, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "env_task_fn": -1, "enable_connectors": -1, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.1024108006331, "kl_target": 0.0216481916482, "vf_loss_coeff": 0.5287015453939, "entropy_coeff": 0.0347123860443, "clip_param": 0.1072861819248, "vf_clip_param": 0.4447244315309, "entropy_coeff_schedule": null, "lr_schedule": null, "sgd_minibatch_size": -1, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9119716444993, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.callbacks.callbacks.RLlibCallback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 29.75186324119568, "iterations_since_restore": 6, "perf": {"cpu_util_percent": 12.814285714285713, "ram_util_percent": 87.70000000000002}}
{"timers": {"training_iteration": 4.278102710890254, "restore_env_runners": 1.4062674971665347e-05, "training_step": 4.277802228708954, "env_runner_sampling_timer": 3.7939564122608926, "learner_update_timer": 0.4802437439285195, "synch_weights": 0.001424856943621215, "restore_eval_env_runners": 1.3842357151136482e-05, "evaluation_iteration": 0.7425825421367156, "synch_eval_env_connectors": 0.0004694593773406083, "synch_env_connectors": 8.03022004462829e-06}, "env_runners": {"env_to_module_connector": {"timers": {"connectors": {"add_observations_from_episodes_to_batch": 6.601392623082063e-06, "batch_individual_items": 1.8239392053987663e-05, "add_states_from_episodes_to_batch": 3.4687189987512314e-06, "numpy_to_tensor": 3.1352753991727134e-05, "add_time_dim_to_batch_and_zero_pad": 6.629992204728324e-06}}, "connector_pipeline_timer": 0.00011987105000428162}, "module_to_env_connector": {"timers": {"connectors": {"listify_data_for_vector_env": 3.1038900040638356e-05, "remove_single_ts_time_rank_from_batch": 1.43713605237707e-06, "get_actions": 0.0001650309582568634, "tensor_to_numpy": 4.864014466886434e-05, "normalize_and_clip_actions": 2.260567722467451e-05, "un_batch_to_individual_items": 1.4843368768824904e-05}}, "connector_pipeline_timer": 0.000360809992644296}, "sample": 0.03737125522563903, "num_module_steps_sampled": {"default_policy": 5000.0}, "num_env_steps_sampled_lifetime": -1202500.0, "num_module_steps_sampled_lifetime": {"default_policy": -1202500.0}, "weights_seq_no": 6.0, "episode_len_min": 50, "episode_duration_sec_mean": 0.036617105949944745, "time_between_sampling": 0.012797170160797074, "episode_return_max": 14.5, "num_env_steps_sampled": 5000.0, "num_episodes": 100.0, "episode_len_mean": 50.0, "episode_return_min": -5.5, "env_to_module_sum_episodes_length_out": 27.16809333212661, "episode_return_mean": -4.899999999999999, "env_reset_timer": 9.460918945266168e-05, "num_episodes_lifetime": -24050.0, "num_agent_steps_sampled": {"default_agent": 5000.0}, "num_agent_steps_sampled_lifetime": {"default_agent": -1202500.0}, "episode_len_max": 50, "agent_episode_returns_mean": {"default_agent": -4.899999999999999}, "rlmodule_inference_timer": 0.00010091665104377645, "env_step_timer": 4.321605123662451e-05, "module_episode_returns_mean": {"default_policy": -4.899999999999999}, "env_to_module_sum_episodes_length_in": 27.16809333212661, "num_env_steps_sampled_lifetime_throughput": 1280.4023250409368}, "learners": {"__all_modules__": {"num_module_steps_trained_lifetime": 112000, "learner_connector_sum_episodes_length_out": 5100.0, "num_env_steps_trained_lifetime": 571200, "learner_connector_sum_episodes_length_in": 5000.0, "learner_connector": {"timers": {"connectors": {"add_columns_from_episodes_to_train_batch": 0.07043845097677351, "add_one_ts_to_episodes_and_truncate": 0.008419487984965716, "batch_individual_items": 0.20254112341149996, "add_states_from_episodes_to_batch": 6.089990173799205e-06, "numpy_to_tensor": 0.00016288097612835717, "general_advantage_estimation": 0.014793716115869639, "add_time_dim_to_batch_and_zero_pad": 2.3822422129884182e-05, "add_observations_from_episodes_to_batch": 0.0007776720986564302}}, "connector_pipeline_timer": 0.2975077383809}, "num_trainable_parameters": 8697, "num_module_steps_trained": 16000, "num_non_trainable_parameters": 0, "num_env_steps_trained": 81600, "num_env_steps_trained_lifetime_throughput": 846168.5150793705, "num_module_steps_trained_throughput": 166429.57693054652, "num_module_steps_trained_lifetime_throughput": 166407.21731842624}, "default_policy": {"num_module_steps_trained_lifetime": 112000, "vf_loss_unclipped": 92.60839080810547, "vf_explained_var": -0.6215693950653076, "entropy": 0.10623373091220856, "module_train_batch_size_mean": 1000.0, "total_loss": 0.23724113404750824, "policy_loss": -0.008619887754321098, "gradients_default_optimizer_global_norm": 0.6629930138587952, "curr_kl_coeff": 0.5184547305107117, "curr_entropy_coeff": 0.0347123860443, "vf_loss": 0.4391690790653229, "weights_seq_no": 7.0, "default_optimizer_learning_rate": 0.0532857353826, "num_trainable_parameters": 8697, "diff_num_grad_updates_vs_sampler_policy": 1.0, "num_module_steps_trained": 16000, "mean_kl_loss": 0.03348282724618912, "num_module_steps_trained_lifetime_throughput": 166618.0982191172}}, "num_training_step_calls_per_iteration": 1, "evaluation": {"env_runners": {"num_episodes": 20, "episode_return_max": 17.5, "env_to_module_connector": {"timers": {"connectors": {"batch_individual_items": 1.8229695935217953e-05, "add_states_from_episodes_to_batch": 3.318079313088648e-06, "numpy_to_tensor": 2.9275419992995453e-05, "add_time_dim_to_batch_and_zero_pad": 5.58360319388548e-06, "add_observations_from_episodes_to_batch": 6.305090132850321e-06}}, "connector_pipeline_timer": 0.00011620298744474824}, "num_episodes_lifetime": 140, "module_to_env_connector": {"timers": {"connectors": {"tensor_to_numpy": 4.5642690343437574e-05, "un_batch_to_individual_items": 1.4959760323985245e-05, "get_actions": 0.00015290594217559245, "normalize_and_clip_actions": 2.160862557825871e-05, "listify_data_for_vector_env": 2.9997025978311757e-05, "remove_single_ts_time_rank_from_batch": 1.4331339805261073e-06}}, "connector_pipeline_timer": 0.00034381371168223885}, "env_reset_timer": 0.00034543534248231145, "num_agent_steps_sampled_lifetime": {"default_agent": 7000}, "num_module_steps_sampled_lifetime": {"default_policy": 7000}, "env_step_timer": 4.1824876889070163e-05, "episode_len_max": 50, "env_to_module_sum_episodes_length_in": 27.168093332126602, "episode_return_min": -16.5, "env_to_module_sum_episodes_length_out": 27.168093332126602, "rlmodule_inference_timer": 9.369670095782873e-05, "sample": 0.7311153934917721, "episode_duration_sec_mean": 0.03506784096997762, "num_env_steps_sampled": 1000, "num_module_steps_sampled": {"default_policy": 1000}, "agent_episode_returns_mean": {"default_agent": 1.5}, "num_env_steps_sampled_lifetime": 36000, "num_agent_steps_sampled": {"default_agent": 1000}, "episode_len_min": 50, "weights_seq_no": 7.0, "episode_len_mean": 50.0, "episode_return_mean": 1.5, "module_episode_returns_mean": {"default_policy": 1.5}, "time_between_sampling": 4.168183028626041}, "num_healthy_workers": 1, "actor_manager_num_outstanding_async_reqs": 0, "num_remote_worker_restarts": 0}, "num_env_steps_sampled_lifetime": -1202500.0, "fault_tolerance": {"num_healthy_workers": 0, "num_remote_worker_restarts": 0}, "env_runner_group": {"actor_manager_num_outstanding_async_reqs": 0}, "done": true, "training_iteration": 7, "trial_id": "1482f_00000", "date": "2025-08-11_17-49-37", "timestamp": 1754927377, "time_this_iter_s": 4.930308818817139, "time_total_s": 34.68217206001282, "pid": 96629, "hostname": "DESKTOP-3SK5A41", "node_ip": "192.168.40.242", "config": {"exploration_config": {}, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 6, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "env": "Umbrella", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": false, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 0, "create_local_env_runner": true, "num_envs_per_env_runner": 1, "gym_env_vectorize_mode": "SYNC", "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "episodes_to_numpy": true, "max_requests_in_flight_per_env_runner": 1, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "merge_env_runner_states": "training_only", "broadcast_env_runner_states": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "complete_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "sampler_perf_stats_ema_coef": null, "_is_online": true, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": "auto", "num_aggregator_actors_per_learner": 0, "max_requests_in_flight_per_aggregator_actor": 3, "local_gpu_idx": 0, "max_requests_in_flight_per_learner": 3, "gamma": 1, "lr": 0.0532857353826, "grad_clip": 0.5, "grad_clip_by": "global_norm", "_train_batch_size_per_learner": 5000, "train_batch_size": 4000, "num_epochs": 3, "minibatch_size": 1000, "shuffle_batch_per_epoch": true, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "log_std_clip_param": 20.0, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "_disable_preprocessor_api": false, "_disable_action_flattening": false}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "_learner_class": null, "callbacks_on_algorithm_init": null, "callbacks_on_env_runners_recreated": null, "callbacks_on_offline_eval_runners_recreated": null, "callbacks_on_checkpoint_loaded": null, "callbacks_on_environment_created": null, "callbacks_on_episode_created": null, "callbacks_on_episode_start": null, "callbacks_on_episode_step": null, "callbacks_on_episode_end": null, "callbacks_on_evaluate_start": null, "callbacks_on_evaluate_end": null, "callbacks_on_evaluate_offline_start": null, "callbacks_on_evaluate_offline_end": null, "callbacks_on_sample_end": null, "callbacks_on_train_result": null, "explore": true, "enable_rl_module_and_learner": true, "enable_env_runner_and_connector_v2": true, "_prior_exploration_config": {"type": "StochasticSampling"}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7e97e1c12ac0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "offline_data_class": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_read_batch_size": null, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "materialize_data": false, "materialize_mapped_data": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "ignore_final_observation": false, "prelearner_class": null, "prelearner_buffer_class": null, "prelearner_buffer_kwargs": {}, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_remaining_data": false, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": 1, "evaluation_duration": 20, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_auto_duration_min_env_steps_per_sample": 100, "evaluation_auto_duration_max_env_steps_per_sample": 2000, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 1, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "offline_evaluation_interval": null, "num_offline_eval_runners": 0, "offline_loss_for_module_fn": null, "offline_evaluation_duration": 1, "offline_evaluation_parallel_to_training": false, "offline_evaluation_timeout_s": 120.0, "num_cpus_per_offline_eval_runner": 1, "num_gpus_per_offline_eval_runner": 0, "custom_resources_per_offline_eval_runner": {}, "restart_failed_offline_eval_runners": true, "ignore_offline_eval_runner_failures": false, "max_num_offline_eval_runner_restarts": 1000, "offline_eval_runner_restore_timeout_s": 1800.0, "max_requests_in_flight_per_offline_eval_runner": 1, "validate_offline_eval_runners_after_construction": true, "offline_eval_runner_health_probe_timeout_s": 30.0, "offline_eval_rl_module_inference_only": false, "broadcast_offline_eval_runner_states": false, "offline_eval_batch_size_per_runner": 256, "dataset_num_iters_per_eval_runner": 1, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "log_gradients": true, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 42, "restart_failed_env_runners": true, "ignore_env_runner_failures": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30.0, "env_runner_restore_timeout_s": 1800.0, "_model_config": {}, "_rl_module_spec": "RLModuleSpec(module_class=None, observation_space=None, action_space=None, inference_only=False, learner_only=False, model_config=DefaultModelConfig(fcnet_hiddens=[63, 126], fcnet_activation='tanh', fcnet_kernel_initializer=None, fcnet_kernel_initializer_kwargs=None, fcnet_bias_initializer=None, fcnet_bias_initializer_kwargs=None, conv_filters=None, conv_activation='relu', conv_kernel_initializer=None, conv_kernel_initializer_kwargs=None, conv_bias_initializer=None, conv_bias_initializer_kwargs=None, head_fcnet_hiddens=[], head_fcnet_activation='relu', head_fcnet_kernel_initializer=None, head_fcnet_kernel_initializer_kwargs=None, head_fcnet_bias_initializer=None, head_fcnet_bias_initializer_kwargs=None, free_log_std=False, log_std_clip_param=20.0, vf_share_layers=True, use_lstm=False, max_seq_len=20, lstm_cell_size=256, lstm_use_prev_action=False, lstm_use_prev_reward=False, lstm_kernel_initializer=None, lstm_kernel_initializer_kwargs=None, lstm_bias_initializer=None, lstm_bias_initializer_kwargs=None), catalog_class=None, load_state_path=None, model_config_dict=None)", "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "_validate_config": true, "_use_msgpack_checkpoints": false, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "env_task_fn": -1, "enable_connectors": -1, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.1024108006331, "kl_target": 0.0216481916482, "vf_loss_coeff": 0.5287015453939, "entropy_coeff": 0.0347123860443, "clip_param": 0.1072861819248, "vf_clip_param": 0.4447244315309, "entropy_coeff_schedule": null, "lr_schedule": null, "sgd_minibatch_size": -1, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9119716444993, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.callbacks.callbacks.RLlibCallback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 34.68217206001282, "iterations_since_restore": 7, "perf": {"cpu_util_percent": 16.257142857142856, "ram_util_percent": 87.20000000000002}}
