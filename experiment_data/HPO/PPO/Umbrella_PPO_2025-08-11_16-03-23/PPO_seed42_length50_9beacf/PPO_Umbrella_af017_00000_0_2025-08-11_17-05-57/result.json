{"timers": {"training_iteration": 4.330767094999828, "restore_env_runners": 1.5299999176932033e-05, "training_step": 4.330470595000406, "env_runner_sampling_timer": 3.850252995000119, "learner_update_timer": 0.47658839999985503, "synch_weights": 0.001526400000329886}, "env_runners": {"env_to_module_sum_episodes_length_in": 26.762340024562445, "module_to_env_connector": {"timers": {"connectors": {"listify_data_for_vector_env": 3.1153751663385565e-05, "un_batch_to_individual_items": 1.4469219190078636e-05, "get_actions": 0.00016972943830724906, "tensor_to_numpy": 4.711717792513511e-05, "remove_single_ts_time_rank_from_batch": 1.451428995346197e-06, "normalize_and_clip_actions": 2.8257035918846362e-05}}, "connector_pipeline_timer": 0.0003702625141748452}, "num_agent_steps_sampled": {"default_agent": 5000.0}, "env_to_module_sum_episodes_length_out": 26.762340024562445, "num_env_steps_sampled": 5000.0, "episode_duration_sec_mean": 0.03604155594997793, "env_step_timer": 4.400514311844589e-05, "episode_return_mean": 5.700000000000004, "sample": 0.03922325818490748, "env_to_module_connector": {"timers": {"connectors": {"add_time_dim_to_batch_and_zero_pad": 6.398891226670109e-06, "numpy_to_tensor": 3.182779841467182e-05, "add_states_from_episodes_to_batch": 3.4911580346885486e-06, "add_observations_from_episodes_to_batch": 6.362288688987246e-06, "batch_individual_items": 1.8588396656608833e-05}}, "connector_pipeline_timer": 0.00012183978157953945}, "num_episodes": 100.0, "num_module_steps_sampled_lifetime": {"default_policy": 252500.0}, "episode_return_max": 14.5, "num_env_steps_sampled_lifetime": 252500.0, "episode_len_mean": 50.0, "num_agent_steps_sampled_lifetime": {"default_agent": 252500.0}, "episode_len_max": 50, "env_reset_timer": 0.00018225040837479986, "num_module_steps_sampled": {"default_policy": 5000.0}, "num_episodes_lifetime": 5050.0, "episode_return_min": -5.5, "time_between_sampling": 0.0012393725627296709, "rlmodule_inference_timer": 0.00010722037432811247, "episode_len_min": 50, "weights_seq_no": 0.0, "module_episode_returns_mean": {"default_policy": 5.700000000000004}, "agent_episode_returns_mean": {"default_agent": 5.700000000000004}, "num_env_steps_sampled_lifetime_throughput": 1261.9571505055733}, "learners": {"__all_modules__": {"learner_connector": {"timers": {"connectors": {"add_columns_from_episodes_to_train_batch": 0.06887950000054843, "general_advantage_estimation": 0.011631299999862676, "add_observations_from_episodes_to_batch": 0.0007746999999653781, "add_time_dim_to_batch_and_zero_pad": 2.1800000467919745e-05, "add_states_from_episodes_to_batch": 5.700000656361226e-06, "add_one_ts_to_episodes_and_truncate": 0.008344500000021071, "numpy_to_tensor": 0.00016289999985019676, "batch_individual_items": 0.2072084999999788}}, "connector_pipeline_timer": 0.2973410000004151}, "num_module_steps_trained": 16000, "num_non_trainable_parameters": 0, "num_module_steps_trained_lifetime": 16000, "learner_connector_sum_episodes_length_out": 5100, "learner_connector_sum_episodes_length_in": 5000, "num_trainable_parameters": 7067, "num_env_steps_trained_lifetime": 81600, "num_env_steps_trained": 81600, "num_env_steps_trained_lifetime_throughput": 1003534.9593311051, "num_module_steps_trained_throughput": 197521.51968521037, "num_module_steps_trained_lifetime_throughput": 197365.94459333186}, "default_policy": {"num_module_steps_trained": 16000, "vf_explained_var": 0.011629760265350342, "num_module_steps_trained_lifetime": 16000, "module_train_batch_size_mean": 1000.0, "curr_kl_coeff": 0.074189193546772, "policy_loss": 0.01610698364675045, "mean_kl_loss": 4.159446689300239e-06, "vf_loss": 0.09493124485015869, "default_optimizer_learning_rate": 1.02025592e-05, "total_loss": 0.09289178997278214, "num_trainable_parameters": 7067, "gradients_default_optimizer_global_norm": 0.06718326359987259, "curr_entropy_coeff": 0.0028379241987, "vf_loss_unclipped": 12.675533294677734, "entropy": 0.6908682584762573, "weights_seq_no": 1.0, "diff_num_grad_updates_vs_sampler_policy": 1.0, "num_module_steps_trained_lifetime_throughput": 197910.61155614257}}, "num_training_step_calls_per_iteration": 1, "num_env_steps_sampled_lifetime": 252500.0, "evaluation": {"env_runners": {"module_to_env_connector": {"timers": {"connectors": {"tensor_to_numpy": 4.5177768821981086e-05, "get_actions": 0.0001562747367770529, "remove_single_ts_time_rank_from_batch": 1.325865669475323e-06, "normalize_and_clip_actions": 2.195805753637211e-05, "un_batch_to_individual_items": 1.542478387002484e-05, "listify_data_for_vector_env": 3.0646318358682425e-05}}, "connector_pipeline_timer": 0.0003429327938209863}, "env_reset_timer": 0.0002494000000297092, "env_to_module_connector": {"timers": {"connectors": {"add_observations_from_episodes_to_batch": 6.250791838534196e-06, "add_states_from_episodes_to_batch": 3.554416027528881e-06, "add_time_dim_to_batch_and_zero_pad": 5.847976364832484e-06, "batch_individual_items": 1.8385437439476885e-05, "numpy_to_tensor": 2.905194921285797e-05}}, "connector_pipeline_timer": 0.00011294758528590435}, "num_episodes_lifetime": 20, "rlmodule_inference_timer": 9.436710918806415e-05, "num_module_steps_sampled": {"default_policy": 1000}, "agent_episode_returns_mean": {"default_agent": 3.1}, "num_env_steps_sampled_lifetime": 6000, "episode_len_max": 50, "num_module_steps_sampled_lifetime": {"default_policy": 1000}, "weights_seq_no": 1.0, "num_agent_steps_sampled_lifetime": {"default_agent": 1000}, "env_to_module_sum_episodes_length_in": 27.167134025045954, "env_to_module_sum_episodes_length_out": 27.167134025045954, "env_step_timer": 4.211488694454477e-05, "sample": 0.7325612989998262, "num_episodes": 20, "module_episode_returns_mean": {"default_policy": 3.1}, "episode_return_min": -12.5, "episode_len_min": 50, "num_env_steps_sampled": 1000, "episode_return_mean": 3.1, "episode_return_max": 17.5, "num_agent_steps_sampled": {"default_agent": 1000}, "episode_len_mean": 50.0, "episode_duration_sec_mean": 0.03517764994985555}, "num_healthy_workers": 1, "actor_manager_num_outstanding_async_reqs": 0, "num_remote_worker_restarts": 0}, "fault_tolerance": {"num_healthy_workers": 0, "num_remote_worker_restarts": 0}, "env_runner_group": {"actor_manager_num_outstanding_async_reqs": 0}, "done": false, "training_iteration": 1, "trial_id": "af017_00000", "date": "2025-08-11_17-15-43", "timestamp": 1754925343, "time_this_iter_s": 5.079281568527222, "time_total_s": 5.079281568527222, "pid": 67771, "hostname": "DESKTOP-3SK5A41", "node_ip": "192.168.40.242", "config": {"exploration_config": {}, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 6, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "env": "Umbrella", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": false, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 0, "create_local_env_runner": true, "num_envs_per_env_runner": 1, "gym_env_vectorize_mode": "SYNC", "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "episodes_to_numpy": true, "max_requests_in_flight_per_env_runner": 1, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "merge_env_runner_states": "training_only", "broadcast_env_runner_states": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "complete_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "sampler_perf_stats_ema_coef": null, "_is_online": true, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": "auto", "num_aggregator_actors_per_learner": 0, "max_requests_in_flight_per_aggregator_actor": 3, "local_gpu_idx": 0, "max_requests_in_flight_per_learner": 3, "gamma": 1, "lr": 1.02025592e-05, "grad_clip": 0.5, "grad_clip_by": "global_norm", "_train_batch_size_per_learner": 5000, "train_batch_size": 4000, "num_epochs": 3, "minibatch_size": 1000, "shuffle_batch_per_epoch": true, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "log_std_clip_param": 20.0, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "_disable_preprocessor_api": false, "_disable_action_flattening": false}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "_learner_class": null, "callbacks_on_algorithm_init": null, "callbacks_on_env_runners_recreated": null, "callbacks_on_offline_eval_runners_recreated": null, "callbacks_on_checkpoint_loaded": null, "callbacks_on_environment_created": null, "callbacks_on_episode_created": null, "callbacks_on_episode_start": null, "callbacks_on_episode_step": null, "callbacks_on_episode_end": null, "callbacks_on_evaluate_start": null, "callbacks_on_evaluate_end": null, "callbacks_on_evaluate_offline_start": null, "callbacks_on_evaluate_offline_end": null, "callbacks_on_sample_end": null, "callbacks_on_train_result": null, "explore": true, "enable_rl_module_and_learner": true, "enable_env_runner_and_connector_v2": true, "_prior_exploration_config": {"type": "StochasticSampling"}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x77ab39ecaac0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "offline_data_class": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_read_batch_size": null, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "materialize_data": false, "materialize_mapped_data": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "ignore_final_observation": false, "prelearner_class": null, "prelearner_buffer_class": null, "prelearner_buffer_kwargs": {}, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_remaining_data": false, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": 1, "evaluation_duration": 20, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_auto_duration_min_env_steps_per_sample": 100, "evaluation_auto_duration_max_env_steps_per_sample": 2000, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 1, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "offline_evaluation_interval": null, "num_offline_eval_runners": 0, "offline_loss_for_module_fn": null, "offline_evaluation_duration": 1, "offline_evaluation_parallel_to_training": false, "offline_evaluation_timeout_s": 120.0, "num_cpus_per_offline_eval_runner": 1, "num_gpus_per_offline_eval_runner": 0, "custom_resources_per_offline_eval_runner": {}, "restart_failed_offline_eval_runners": true, "ignore_offline_eval_runner_failures": false, "max_num_offline_eval_runner_restarts": 1000, "offline_eval_runner_restore_timeout_s": 1800.0, "max_requests_in_flight_per_offline_eval_runner": 1, "validate_offline_eval_runners_after_construction": true, "offline_eval_runner_health_probe_timeout_s": 30.0, "offline_eval_rl_module_inference_only": false, "broadcast_offline_eval_runner_states": false, "offline_eval_batch_size_per_runner": 256, "dataset_num_iters_per_eval_runner": 1, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "log_gradients": true, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 42, "restart_failed_env_runners": true, "ignore_env_runner_failures": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30.0, "env_runner_restore_timeout_s": 1800.0, "_model_config": {}, "_rl_module_spec": "RLModuleSpec(module_class=None, observation_space=None, action_space=None, inference_only=False, learner_only=False, model_config=DefaultModelConfig(fcnet_hiddens=[114, 56], fcnet_activation='tanh', fcnet_kernel_initializer=None, fcnet_kernel_initializer_kwargs=None, fcnet_bias_initializer=None, fcnet_bias_initializer_kwargs=None, conv_filters=None, conv_activation='relu', conv_kernel_initializer=None, conv_kernel_initializer_kwargs=None, conv_bias_initializer=None, conv_bias_initializer_kwargs=None, head_fcnet_hiddens=[], head_fcnet_activation='relu', head_fcnet_kernel_initializer=None, head_fcnet_kernel_initializer_kwargs=None, head_fcnet_bias_initializer=None, head_fcnet_bias_initializer_kwargs=None, free_log_std=False, log_std_clip_param=20.0, vf_share_layers=True, use_lstm=False, max_seq_len=20, lstm_cell_size=256, lstm_use_prev_action=False, lstm_use_prev_reward=False, lstm_kernel_initializer=None, lstm_kernel_initializer_kwargs=None, lstm_bias_initializer=None, lstm_bias_initializer_kwargs=None), catalog_class=None, load_state_path=None, model_config_dict=None)", "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "_validate_config": true, "_use_msgpack_checkpoints": false, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "env_task_fn": -1, "enable_connectors": -1, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.1483783801338, "kl_target": 0.0299561178854, "vf_loss_coeff": 0.8294931856016, "entropy_coeff": 0.0028379241987, "clip_param": 0.2023271755792, "vf_clip_param": 0.1015383331916, "entropy_coeff_schedule": null, "lr_schedule": null, "sgd_minibatch_size": -1, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9059303202574, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.callbacks.callbacks.RLlibCallback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 5.079281568527222, "iterations_since_restore": 1, "perf": {"cpu_util_percent": 11.774999999999999, "ram_util_percent": 74.0875}}
{"timers": {"training_iteration": 4.329248372019829, "restore_env_runners": 1.528499919004389e-05, "training_step": 4.328951111020405, "env_runner_sampling_timer": 3.85103403602011, "learner_update_timer": 0.47428681299985326, "synch_weights": 0.001526262000325005, "restore_eval_env_runners": 1.3300000318849925e-05, "evaluation_iteration": 0.7450046989997645, "synch_eval_env_connectors": 0.0004931000003125519, "synch_env_connectors": 8.400000297115184e-06}, "env_runners": {"env_to_module_sum_episodes_length_in": 27.16809333212661, "module_to_env_connector": {"timers": {"connectors": {"listify_data_for_vector_env": 3.094054991632901e-05, "un_batch_to_individual_items": 1.4473360829111248e-05, "get_actions": 0.00016708470254333824, "tensor_to_numpy": 4.9710238780276954e-05, "remove_single_ts_time_rank_from_batch": 1.4578217120131356e-06, "normalize_and_clip_actions": 2.2659679613986152e-05}}, "connector_pipeline_timer": 0.00036449631294377063}, "num_agent_steps_sampled": {"default_agent": 5000.0}, "env_to_module_sum_episodes_length_out": 27.16809333212661, "num_env_steps_sampled": 5000.0, "episode_duration_sec_mean": 0.036772780970031824, "env_step_timer": 4.301540902732969e-05, "episode_return_mean": 6.700000000000004, "sample": 0.03816528580901109, "env_to_module_connector": {"timers": {"connectors": {"add_time_dim_to_batch_and_zero_pad": 6.281569872561923e-06, "numpy_to_tensor": 3.16054458512742e-05, "add_states_from_episodes_to_batch": 3.4722140760309076e-06, "add_observations_from_episodes_to_batch": 6.255963162842123e-06, "batch_individual_items": 1.8423158657403597e-05}}, "connector_pipeline_timer": 0.00011935044645899048}, "num_episodes": 100.0, "num_module_steps_sampled_lifetime": {"default_policy": 10000.0}, "episode_return_max": 14.5, "num_env_steps_sampled_lifetime": 10000.0, "episode_len_mean": 50.0, "num_agent_steps_sampled_lifetime": {"default_agent": 10000.0}, "episode_len_max": 50, "env_reset_timer": 0.00012632503266755512, "num_module_steps_sampled": {"default_policy": 5000.0}, "num_episodes_lifetime": 200.0, "episode_return_min": -5.5, "time_between_sampling": 0.00938425586729148, "rlmodule_inference_timer": 0.00010121678951734077, "episode_len_min": 50, "weights_seq_no": 1.0, "module_episode_returns_mean": {"default_policy": 6.700000000000004}, "agent_episode_returns_mean": {"default_agent": 6.700000000000004}, "num_env_steps_sampled_lifetime_throughput": 1274.9442208610176}, "learners": {"__all_modules__": {"learner_connector": {"timers": {"connectors": {"add_columns_from_episodes_to_train_batch": 0.06886098300054982, "general_advantage_estimation": 0.01163043499986088, "add_observations_from_episodes_to_batch": 0.0007740039999680448, "add_time_dim_to_batch_and_zero_pad": 2.180400046199793e-05, "add_states_from_episodes_to_batch": 5.706000647478505e-06, "add_one_ts_to_episodes_and_truncate": 0.008344597000022986, "numpy_to_tensor": 0.00016304199985825107, "batch_individual_items": 0.20572104799997762}}, "connector_pipeline_timer": 0.29583409100041536}, "num_module_steps_trained": 16000, "num_non_trainable_parameters": 0, "num_module_steps_trained_lifetime": 32000, "learner_connector_sum_episodes_length_out": 5100.0, "learner_connector_sum_episodes_length_in": 5000.0, "num_trainable_parameters": 7067, "num_env_steps_trained_lifetime": 163200, "num_env_steps_trained": 81600, "num_env_steps_trained_lifetime_throughput": 998163.9574289727, "num_module_steps_trained_throughput": 196448.30842048387, "num_module_steps_trained_lifetime_throughput": 196296.6248706434}, "default_policy": {"num_module_steps_trained": 16000, "vf_explained_var": 0.011294841766357422, "num_module_steps_trained_lifetime": 32000, "module_train_batch_size_mean": 1000.0, "curr_kl_coeff": 0.037094596773386, "policy_loss": -0.01936880126595497, "mean_kl_loss": 5.923823209741386e-06, "vf_loss": 0.09577071666717529, "default_optimizer_learning_rate": 1.02025592e-05, "total_loss": 0.05811142176389694, "num_trainable_parameters": 7067, "gradients_default_optimizer_global_norm": 0.08595433831214905, "curr_entropy_coeff": 0.0028379241987, "vf_loss_unclipped": 13.45700454711914, "entropy": 0.6911353468894958, "weights_seq_no": 2.0, "diff_num_grad_updates_vs_sampler_policy": 1.0, "num_module_steps_trained_lifetime_throughput": 196823.989190517}}, "num_training_step_calls_per_iteration": 1, "evaluation": {"env_runners": {"module_to_env_connector": {"timers": {"connectors": {"tensor_to_numpy": 4.5184716934352115e-05, "get_actions": 0.00015383801033955557, "remove_single_ts_time_rank_from_batch": 1.4091939385589742e-06, "normalize_and_clip_actions": 2.2429201659087674e-05, "un_batch_to_individual_items": 1.576246965346663e-05, "listify_data_for_vector_env": 3.077648005047944e-05}}, "connector_pipeline_timer": 0.0003422588270117446}, "env_reset_timer": 0.0002482110000346438, "env_to_module_connector": {"timers": {"connectors": {"add_observations_from_episodes_to_batch": 6.469194114348203e-06, "add_states_from_episodes_to_batch": 3.3767126833636505e-06, "add_time_dim_to_batch_and_zero_pad": 6.23308701275444e-06, "batch_individual_items": 1.826394657656309e-05, "numpy_to_tensor": 2.901218875719497e-05}}, "connector_pipeline_timer": 0.0001128202185939882}, "num_episodes_lifetime": 40, "rlmodule_inference_timer": 9.497163279601037e-05, "num_module_steps_sampled": {"default_policy": 1000}, "agent_episode_returns_mean": {"default_agent": -0.4}, "num_env_steps_sampled_lifetime": 11000, "episode_len_max": 50, "num_module_steps_sampled_lifetime": {"default_policy": 2000}, "weights_seq_no": 2.0, "num_agent_steps_sampled_lifetime": {"default_agent": 2000}, "env_to_module_sum_episodes_length_in": 27.168093298253442, "env_to_module_sum_episodes_length_out": 27.168093298253442, "env_step_timer": 4.136012616705439e-05, "sample": 0.7325623420098327, "num_episodes": 20, "module_episode_returns_mean": {"default_policy": -0.4}, "episode_return_min": -16.5, "episode_len_min": 50, "num_env_steps_sampled": 1000, "episode_return_mean": -0.4, "episode_return_max": 17.5, "num_agent_steps_sampled": {"default_agent": 1000}, "episode_len_mean": 50.0, "episode_duration_sec_mean": 0.035188289974962574, "time_between_sampling": 4.234793496999373}, "num_healthy_workers": 1, "actor_manager_num_outstanding_async_reqs": 0, "num_remote_worker_restarts": 0}, "num_env_steps_sampled_lifetime": 10000.0, "fault_tolerance": {"num_healthy_workers": 0, "num_remote_worker_restarts": 0}, "env_runner_group": {"actor_manager_num_outstanding_async_reqs": 0}, "done": false, "training_iteration": 2, "trial_id": "af017_00000", "date": "2025-08-11_17-15-48", "timestamp": 1754925348, "time_this_iter_s": 4.926144361495972, "time_total_s": 10.005425930023193, "pid": 67771, "hostname": "DESKTOP-3SK5A41", "node_ip": "192.168.40.242", "config": {"exploration_config": {}, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 6, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "env": "Umbrella", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": false, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 0, "create_local_env_runner": true, "num_envs_per_env_runner": 1, "gym_env_vectorize_mode": "SYNC", "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "episodes_to_numpy": true, "max_requests_in_flight_per_env_runner": 1, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "merge_env_runner_states": "training_only", "broadcast_env_runner_states": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "complete_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "sampler_perf_stats_ema_coef": null, "_is_online": true, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": "auto", "num_aggregator_actors_per_learner": 0, "max_requests_in_flight_per_aggregator_actor": 3, "local_gpu_idx": 0, "max_requests_in_flight_per_learner": 3, "gamma": 1, "lr": 1.02025592e-05, "grad_clip": 0.5, "grad_clip_by": "global_norm", "_train_batch_size_per_learner": 5000, "train_batch_size": 4000, "num_epochs": 3, "minibatch_size": 1000, "shuffle_batch_per_epoch": true, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "log_std_clip_param": 20.0, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "_disable_preprocessor_api": false, "_disable_action_flattening": false}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "_learner_class": null, "callbacks_on_algorithm_init": null, "callbacks_on_env_runners_recreated": null, "callbacks_on_offline_eval_runners_recreated": null, "callbacks_on_checkpoint_loaded": null, "callbacks_on_environment_created": null, "callbacks_on_episode_created": null, "callbacks_on_episode_start": null, "callbacks_on_episode_step": null, "callbacks_on_episode_end": null, "callbacks_on_evaluate_start": null, "callbacks_on_evaluate_end": null, "callbacks_on_evaluate_offline_start": null, "callbacks_on_evaluate_offline_end": null, "callbacks_on_sample_end": null, "callbacks_on_train_result": null, "explore": true, "enable_rl_module_and_learner": true, "enable_env_runner_and_connector_v2": true, "_prior_exploration_config": {"type": "StochasticSampling"}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x77ab39ecaac0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "offline_data_class": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_read_batch_size": null, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "materialize_data": false, "materialize_mapped_data": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "ignore_final_observation": false, "prelearner_class": null, "prelearner_buffer_class": null, "prelearner_buffer_kwargs": {}, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_remaining_data": false, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": 1, "evaluation_duration": 20, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_auto_duration_min_env_steps_per_sample": 100, "evaluation_auto_duration_max_env_steps_per_sample": 2000, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 1, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "offline_evaluation_interval": null, "num_offline_eval_runners": 0, "offline_loss_for_module_fn": null, "offline_evaluation_duration": 1, "offline_evaluation_parallel_to_training": false, "offline_evaluation_timeout_s": 120.0, "num_cpus_per_offline_eval_runner": 1, "num_gpus_per_offline_eval_runner": 0, "custom_resources_per_offline_eval_runner": {}, "restart_failed_offline_eval_runners": true, "ignore_offline_eval_runner_failures": false, "max_num_offline_eval_runner_restarts": 1000, "offline_eval_runner_restore_timeout_s": 1800.0, "max_requests_in_flight_per_offline_eval_runner": 1, "validate_offline_eval_runners_after_construction": true, "offline_eval_runner_health_probe_timeout_s": 30.0, "offline_eval_rl_module_inference_only": false, "broadcast_offline_eval_runner_states": false, "offline_eval_batch_size_per_runner": 256, "dataset_num_iters_per_eval_runner": 1, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "log_gradients": true, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 42, "restart_failed_env_runners": true, "ignore_env_runner_failures": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30.0, "env_runner_restore_timeout_s": 1800.0, "_model_config": {}, "_rl_module_spec": "RLModuleSpec(module_class=None, observation_space=None, action_space=None, inference_only=False, learner_only=False, model_config=DefaultModelConfig(fcnet_hiddens=[114, 56], fcnet_activation='tanh', fcnet_kernel_initializer=None, fcnet_kernel_initializer_kwargs=None, fcnet_bias_initializer=None, fcnet_bias_initializer_kwargs=None, conv_filters=None, conv_activation='relu', conv_kernel_initializer=None, conv_kernel_initializer_kwargs=None, conv_bias_initializer=None, conv_bias_initializer_kwargs=None, head_fcnet_hiddens=[], head_fcnet_activation='relu', head_fcnet_kernel_initializer=None, head_fcnet_kernel_initializer_kwargs=None, head_fcnet_bias_initializer=None, head_fcnet_bias_initializer_kwargs=None, free_log_std=False, log_std_clip_param=20.0, vf_share_layers=True, use_lstm=False, max_seq_len=20, lstm_cell_size=256, lstm_use_prev_action=False, lstm_use_prev_reward=False, lstm_kernel_initializer=None, lstm_kernel_initializer_kwargs=None, lstm_bias_initializer=None, lstm_bias_initializer_kwargs=None), catalog_class=None, load_state_path=None, model_config_dict=None)", "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "_validate_config": true, "_use_msgpack_checkpoints": false, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "env_task_fn": -1, "enable_connectors": -1, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.1483783801338, "kl_target": 0.0299561178854, "vf_loss_coeff": 0.8294931856016, "entropy_coeff": 0.0028379241987, "clip_param": 0.2023271755792, "vf_clip_param": 0.1015383331916, "entropy_coeff_schedule": null, "lr_schedule": null, "sgd_minibatch_size": -1, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9059303202574, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.callbacks.callbacks.RLlibCallback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 10.005425930023193, "iterations_since_restore": 2, "perf": {"cpu_util_percent": 12.285714285714286, "ram_util_percent": 74.21428571428571}}
{"timers": {"training_iteration": 4.329237823299636, "restore_env_runners": 1.527414920619776e-05, "training_step": 4.3289397589101934, "env_runner_sampling_timer": 3.8534175076599126, "learner_update_timer": 0.47189366186986115, "synch_weights": 0.0015240623803184465, "restore_eval_env_runners": 1.3306000319062149e-05, "evaluation_iteration": 0.7449784960097714, "synch_eval_env_connectors": 0.0004926990003059472, "synch_env_connectors": 8.402000294154277e-06}, "env_runners": {"env_to_module_sum_episodes_length_in": 27.16809333212661, "module_to_env_connector": {"timers": {"connectors": {"listify_data_for_vector_env": 3.098671972768606e-05, "un_batch_to_individual_items": 1.450574653357886e-05, "get_actions": 0.0001676510458167045, "tensor_to_numpy": 5.0080945640382245e-05, "remove_single_ts_time_rank_from_batch": 1.463360807004604e-06, "normalize_and_clip_actions": 2.2842314579938683e-05}}, "connector_pipeline_timer": 0.0003658987934597794}, "num_agent_steps_sampled": {"default_agent": 5000.0}, "env_to_module_sum_episodes_length_out": 27.16809333212661, "num_env_steps_sampled": 5000.0, "episode_duration_sec_mean": 0.038376770999966545, "env_step_timer": 4.327819082270806e-05, "episode_return_mean": 7.299999999999996, "sample": 0.03837543805900178, "env_to_module_connector": {"timers": {"connectors": {"add_time_dim_to_batch_and_zero_pad": 6.3469485298766794e-06, "numpy_to_tensor": 3.1738150158609105e-05, "add_states_from_episodes_to_batch": 3.4563445322800935e-06, "add_observations_from_episodes_to_batch": 6.306569237506818e-06, "batch_individual_items": 1.848179660261561e-05}}, "connector_pipeline_timer": 0.00011988177181070794}, "num_episodes": 100.0, "num_module_steps_sampled_lifetime": {"default_policy": -232500.0}, "episode_return_max": 14.5, "num_env_steps_sampled_lifetime": -232500.0, "episode_len_mean": 50.0, "num_agent_steps_sampled_lifetime": {"default_agent": -232500.0}, "episode_len_max": 50, "env_reset_timer": 0.00010529310653430251, "num_module_steps_sampled": {"default_policy": 5000.0}, "num_episodes_lifetime": -4650.0, "episode_return_min": -5.5, "time_between_sampling": 0.010942611244364166, "rlmodule_inference_timer": 0.00013651938604230407, "episode_len_min": 50, "weights_seq_no": 2.0, "module_episode_returns_mean": {"default_policy": 7.299999999999996}, "agent_episode_returns_mean": {"default_agent": 7.299999999999996}, "num_env_steps_sampled_lifetime_throughput": 1260.9675708622817}, "learners": {"__all_modules__": {"learner_connector": {"timers": {"connectors": {"add_columns_from_episodes_to_train_batch": 0.06884301117054574, "general_advantage_estimation": 0.011605918649861996, "add_observations_from_episodes_to_batch": 0.0007737439599722165, "add_time_dim_to_batch_and_zero_pad": 2.182596045677201e-05, "add_states_from_episodes_to_batch": 5.7089406431259706e-06, "add_one_ts_to_episodes_and_truncate": 0.008345734030020776, "numpy_to_tensor": 0.00016307057985923164, "batch_individual_items": 0.2042367835199708}}, "connector_pipeline_timer": 0.29430836909040864}, "num_module_steps_trained": 16000, "num_non_trainable_parameters": 0, "num_module_steps_trained_lifetime": 48000, "learner_connector_sum_episodes_length_out": 5100.0, "learner_connector_sum_episodes_length_in": 5000.0, "num_trainable_parameters": 7067, "num_env_steps_trained_lifetime": 244800, "num_env_steps_trained": 81600, "num_env_steps_trained_lifetime_throughput": 993026.8573534102, "num_module_steps_trained_throughput": 195412.3221626825, "num_module_steps_trained_lifetime_throughput": 195266.11577959626}, "default_policy": {"num_module_steps_trained": 16000, "vf_explained_var": 0.010897517204284668, "num_module_steps_trained_lifetime": 48000, "module_train_batch_size_mean": 1000.0, "curr_kl_coeff": 0.018547298386693, "policy_loss": 0.002763208234682679, "mean_kl_loss": 2.2802807961852523e-06, "vf_loss": 0.09592612832784653, "default_optimizer_learning_rate": 1.02025592e-05, "total_loss": 0.08037154376506805, "num_trainable_parameters": 7067, "gradients_default_optimizer_global_norm": 0.03577331453561783, "curr_entropy_coeff": 0.0028379241987, "vf_loss_unclipped": 13.152581214904785, "entropy": 0.6912926435470581, "weights_seq_no": 3.0, "diff_num_grad_updates_vs_sampler_policy": 1.0, "num_module_steps_trained_lifetime_throughput": 195769.49806738104}}, "num_training_step_calls_per_iteration": 1, "evaluation": {"env_runners": {"module_to_env_connector": {"timers": {"connectors": {"tensor_to_numpy": 4.4815345327907265e-05, "get_actions": 0.00015576324567684565, "remove_single_ts_time_rank_from_batch": 1.3551403825968674e-06, "normalize_and_clip_actions": 2.2610662992000305e-05, "un_batch_to_individual_items": 1.5747006645819152e-05, "listify_data_for_vector_env": 3.0421534470392805e-05}}, "connector_pipeline_timer": 0.0003432485505467243}, "env_reset_timer": 0.0002478118900336995, "env_to_module_connector": {"timers": {"connectors": {"add_observations_from_episodes_to_batch": 6.53585078990178e-06, "add_states_from_episodes_to_batch": 3.4028207513441718e-06, "add_time_dim_to_batch_and_zero_pad": 6.001526634363648e-06, "batch_individual_items": 1.833002133832761e-05, "numpy_to_tensor": 2.9147129845412895e-05}}, "connector_pipeline_timer": 0.00011468428675764473}, "num_episodes_lifetime": 60, "rlmodule_inference_timer": 9.553444414546038e-05, "num_module_steps_sampled": {"default_policy": 1000}, "agent_episode_returns_mean": {"default_agent": -0.5666666666666667}, "num_env_steps_sampled_lifetime": 16000, "episode_len_max": 50, "num_module_steps_sampled_lifetime": {"default_policy": 3000}, "weights_seq_no": 3.0, "num_agent_steps_sampled_lifetime": {"default_agent": 3000}, "env_to_module_sum_episodes_length_in": 27.168093332125434, "env_to_module_sum_episodes_length_out": 27.168093332125434, "env_step_timer": 4.1456858089474677e-05, "sample": 0.7325493675897393, "num_episodes": 20, "module_episode_returns_mean": {"default_policy": -0.5666666666666667}, "episode_return_min": -16.5, "episode_len_min": 50, "num_env_steps_sampled": 1000, "episode_return_mean": -0.5666666666666667, "episode_return_max": 17.5, "num_agent_steps_sampled": {"default_agent": 1000}, "episode_len_mean": 50.0, "episode_duration_sec_mean": 0.035170351649988635, "time_between_sampling": 4.236280376029372}, "num_healthy_workers": 1, "actor_manager_num_outstanding_async_reqs": 0, "num_remote_worker_restarts": 0}, "num_env_steps_sampled_lifetime": -232500.0, "fault_tolerance": {"num_healthy_workers": 0, "num_remote_worker_restarts": 0}, "env_runner_group": {"actor_manager_num_outstanding_async_reqs": 0}, "done": false, "training_iteration": 3, "trial_id": "af017_00000", "date": "2025-08-11_17-15-53", "timestamp": 1754925353, "time_this_iter_s": 5.0733044147491455, "time_total_s": 15.078730344772339, "pid": 67771, "hostname": "DESKTOP-3SK5A41", "node_ip": "192.168.40.242", "config": {"exploration_config": {}, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 6, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "env": "Umbrella", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": false, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 0, "create_local_env_runner": true, "num_envs_per_env_runner": 1, "gym_env_vectorize_mode": "SYNC", "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "episodes_to_numpy": true, "max_requests_in_flight_per_env_runner": 1, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "merge_env_runner_states": "training_only", "broadcast_env_runner_states": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "complete_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "sampler_perf_stats_ema_coef": null, "_is_online": true, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": "auto", "num_aggregator_actors_per_learner": 0, "max_requests_in_flight_per_aggregator_actor": 3, "local_gpu_idx": 0, "max_requests_in_flight_per_learner": 3, "gamma": 1, "lr": 1.02025592e-05, "grad_clip": 0.5, "grad_clip_by": "global_norm", "_train_batch_size_per_learner": 5000, "train_batch_size": 4000, "num_epochs": 3, "minibatch_size": 1000, "shuffle_batch_per_epoch": true, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "log_std_clip_param": 20.0, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "_disable_preprocessor_api": false, "_disable_action_flattening": false}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "_learner_class": null, "callbacks_on_algorithm_init": null, "callbacks_on_env_runners_recreated": null, "callbacks_on_offline_eval_runners_recreated": null, "callbacks_on_checkpoint_loaded": null, "callbacks_on_environment_created": null, "callbacks_on_episode_created": null, "callbacks_on_episode_start": null, "callbacks_on_episode_step": null, "callbacks_on_episode_end": null, "callbacks_on_evaluate_start": null, "callbacks_on_evaluate_end": null, "callbacks_on_evaluate_offline_start": null, "callbacks_on_evaluate_offline_end": null, "callbacks_on_sample_end": null, "callbacks_on_train_result": null, "explore": true, "enable_rl_module_and_learner": true, "enable_env_runner_and_connector_v2": true, "_prior_exploration_config": {"type": "StochasticSampling"}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x77ab39ecaac0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "offline_data_class": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_read_batch_size": null, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "materialize_data": false, "materialize_mapped_data": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "ignore_final_observation": false, "prelearner_class": null, "prelearner_buffer_class": null, "prelearner_buffer_kwargs": {}, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_remaining_data": false, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": 1, "evaluation_duration": 20, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_auto_duration_min_env_steps_per_sample": 100, "evaluation_auto_duration_max_env_steps_per_sample": 2000, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 1, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "offline_evaluation_interval": null, "num_offline_eval_runners": 0, "offline_loss_for_module_fn": null, "offline_evaluation_duration": 1, "offline_evaluation_parallel_to_training": false, "offline_evaluation_timeout_s": 120.0, "num_cpus_per_offline_eval_runner": 1, "num_gpus_per_offline_eval_runner": 0, "custom_resources_per_offline_eval_runner": {}, "restart_failed_offline_eval_runners": true, "ignore_offline_eval_runner_failures": false, "max_num_offline_eval_runner_restarts": 1000, "offline_eval_runner_restore_timeout_s": 1800.0, "max_requests_in_flight_per_offline_eval_runner": 1, "validate_offline_eval_runners_after_construction": true, "offline_eval_runner_health_probe_timeout_s": 30.0, "offline_eval_rl_module_inference_only": false, "broadcast_offline_eval_runner_states": false, "offline_eval_batch_size_per_runner": 256, "dataset_num_iters_per_eval_runner": 1, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "log_gradients": true, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 42, "restart_failed_env_runners": true, "ignore_env_runner_failures": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30.0, "env_runner_restore_timeout_s": 1800.0, "_model_config": {}, "_rl_module_spec": "RLModuleSpec(module_class=None, observation_space=None, action_space=None, inference_only=False, learner_only=False, model_config=DefaultModelConfig(fcnet_hiddens=[114, 56], fcnet_activation='tanh', fcnet_kernel_initializer=None, fcnet_kernel_initializer_kwargs=None, fcnet_bias_initializer=None, fcnet_bias_initializer_kwargs=None, conv_filters=None, conv_activation='relu', conv_kernel_initializer=None, conv_kernel_initializer_kwargs=None, conv_bias_initializer=None, conv_bias_initializer_kwargs=None, head_fcnet_hiddens=[], head_fcnet_activation='relu', head_fcnet_kernel_initializer=None, head_fcnet_kernel_initializer_kwargs=None, head_fcnet_bias_initializer=None, head_fcnet_bias_initializer_kwargs=None, free_log_std=False, log_std_clip_param=20.0, vf_share_layers=True, use_lstm=False, max_seq_len=20, lstm_cell_size=256, lstm_use_prev_action=False, lstm_use_prev_reward=False, lstm_kernel_initializer=None, lstm_kernel_initializer_kwargs=None, lstm_bias_initializer=None, lstm_bias_initializer_kwargs=None), catalog_class=None, load_state_path=None, model_config_dict=None)", "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "_validate_config": true, "_use_msgpack_checkpoints": false, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "env_task_fn": -1, "enable_connectors": -1, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.1483783801338, "kl_target": 0.0299561178854, "vf_loss_coeff": 0.8294931856016, "entropy_coeff": 0.0028379241987, "clip_param": 0.2023271755792, "vf_clip_param": 0.1015383331916, "entropy_coeff_schedule": null, "lr_schedule": null, "sgd_minibatch_size": -1, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9059303202574, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.callbacks.callbacks.RLlibCallback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 15.078730344772339, "iterations_since_restore": 3, "perf": {"cpu_util_percent": 12.442857142857141, "ram_util_percent": 74.3}}
{"timers": {"training_iteration": 4.329306698076637, "restore_env_runners": 1.524540771245847e-05, "training_step": 4.329007308331089, "env_runner_sampling_timer": 3.8545083875933144, "learner_update_timer": 0.4708664602511647, "synch_weights": 0.0015234847565170086, "restore_eval_env_runners": 1.333494031250666e-05, "evaluation_iteration": 0.7449396790496683, "synch_eval_env_connectors": 0.0004920660103031877, "synch_env_connectors": 8.394980286357167e-06}, "env_runners": {"env_to_module_sum_episodes_length_in": 27.16809333212661, "module_to_env_connector": {"timers": {"connectors": {"listify_data_for_vector_env": 3.112142342971095e-05, "un_batch_to_individual_items": 1.4484546497079441e-05, "get_actions": 0.0001679396063467598, "tensor_to_numpy": 4.9889440716285057e-05, "remove_single_ts_time_rank_from_batch": 1.4876747775027238e-06, "normalize_and_clip_actions": 2.2701003312737734e-05}}, "connector_pipeline_timer": 0.00036635695369713795}, "num_agent_steps_sampled": {"default_agent": 5000.0}, "env_to_module_sum_episodes_length_out": 27.16809333212661, "num_env_steps_sampled": 5000.0, "episode_duration_sec_mean": 0.03709011200998248, "env_step_timer": 4.3254764886128e-05, "episode_return_mean": 3.899999999999998, "sample": 0.03864698209291762, "env_to_module_connector": {"timers": {"connectors": {"add_time_dim_to_batch_and_zero_pad": 6.3801972801253336e-06, "numpy_to_tensor": 3.166653992676157e-05, "add_states_from_episodes_to_batch": 3.5550952424954507e-06, "add_observations_from_episodes_to_batch": 6.3536697473667656e-06, "batch_individual_items": 1.8624140839704038e-05}}, "connector_pipeline_timer": 0.0001203149035223243}, "num_episodes": 100.0, "num_module_steps_sampled_lifetime": {"default_policy": -475000.0}, "episode_return_max": 14.5, "num_env_steps_sampled_lifetime": -475000.0, "episode_len_mean": 50.0, "num_agent_steps_sampled_lifetime": {"default_agent": -475000.0}, "episode_len_max": 50, "env_reset_timer": 9.833529197647226e-05, "num_module_steps_sampled": {"default_policy": 5000.0}, "num_episodes_lifetime": -9500.0, "episode_return_min": -5.5, "time_between_sampling": 0.011420705944049415, "rlmodule_inference_timer": 0.00010247455489770517, "episode_len_min": 50, "weights_seq_no": 3.0, "module_episode_returns_mean": {"default_policy": 3.899999999999998}, "agent_episode_returns_mean": {"default_agent": 3.899999999999998}, "num_env_steps_sampled_lifetime_throughput": 1264.3241204822739}, "learners": {"__all_modules__": {"learner_connector": {"timers": {"connectors": {"add_columns_from_episodes_to_train_batch": 0.06881807105883747, "general_advantage_estimation": 0.011595634463365189, "add_observations_from_episodes_to_batch": 0.0007729165203743751, "add_time_dim_to_batch_and_zero_pad": 2.182170085371035e-05, "add_states_from_episodes_to_batch": 5.71785122993424e-06, "add_one_ts_to_episodes_and_truncate": 0.008343195689713286, "numpy_to_tensor": 0.00016328287406064737, "batch_individual_items": 0.20421459068476894}}, "connector_pipeline_timer": 0.29424792539950256}, "num_module_steps_trained": 16000, "num_non_trainable_parameters": 0, "num_module_steps_trained_lifetime": 64000, "learner_connector_sum_episodes_length_out": 5100.0, "learner_connector_sum_episodes_length_in": 5000.0, "num_trainable_parameters": 7067, "num_env_steps_trained_lifetime": 326400, "num_env_steps_trained": 81600, "num_env_steps_trained_lifetime_throughput": 992225.4371040522, "num_module_steps_trained_throughput": 195223.83882077096, "num_module_steps_trained_lifetime_throughput": 195083.6258650057}, "default_policy": {"num_module_steps_trained": 16000, "vf_explained_var": 0.01101905107498169, "num_module_steps_trained_lifetime": 64000, "module_train_batch_size_mean": 1000.0, "curr_kl_coeff": 0.0092736491933465, "policy_loss": -0.002891757758334279, "mean_kl_loss": 3.4335237160121324e-06, "vf_loss": 0.09557674825191498, "default_optimizer_learning_rate": 1.02025592e-05, "total_loss": 0.07442757487297058, "num_trainable_parameters": 7067, "gradients_default_optimizer_global_norm": 0.05454244837164879, "curr_entropy_coeff": 0.0028379241987, "vf_loss_unclipped": 12.121145248413086, "entropy": 0.6909962892532349, "weights_seq_no": 4.0, "diff_num_grad_updates_vs_sampler_policy": 1.0, "num_module_steps_trained_lifetime_throughput": 195560.4280147587}}, "num_training_step_calls_per_iteration": 1, "evaluation": {"env_runners": {"module_to_env_connector": {"timers": {"connectors": {"tensor_to_numpy": 4.53949820655198e-05, "get_actions": 0.0001550676789065365, "remove_single_ts_time_rank_from_batch": 1.3709417593992924e-06, "normalize_and_clip_actions": 2.2103250099769187e-05, "un_batch_to_individual_items": 1.536719533985356e-05, "listify_data_for_vector_env": 3.0311623650831263e-05}}, "connector_pipeline_timer": 0.0003423983823971082}, "env_reset_timer": 0.00024662777112759436, "env_to_module_connector": {"timers": {"connectors": {"add_observations_from_episodes_to_batch": 6.431156288976539e-06, "add_states_from_episodes_to_batch": 3.3700544778305637e-06, "add_time_dim_to_batch_and_zero_pad": 6.383661951614508e-06, "batch_individual_items": 1.8466461151978494e-05, "numpy_to_tensor": 2.9251641270031002e-05}}, "connector_pipeline_timer": 0.00011473234143344528}, "num_episodes_lifetime": 80, "rlmodule_inference_timer": 9.440577656302516e-05, "num_module_steps_sampled": {"default_policy": 1000}, "agent_episode_returns_mean": {"default_agent": -0.9}, "num_env_steps_sampled_lifetime": 21000, "episode_len_max": 50, "num_module_steps_sampled_lifetime": {"default_policy": 4000}, "weights_seq_no": 4.0, "num_agent_steps_sampled_lifetime": {"default_agent": 4000}, "env_to_module_sum_episodes_length_in": 27.168093332126602, "env_to_module_sum_episodes_length_out": 27.168093332126602, "env_step_timer": 4.1262593966291576e-05, "sample": 0.7325430799238483, "num_episodes": 20, "module_episode_returns_mean": {"default_policy": -0.9}, "episode_return_min": -16.5, "episode_len_min": 50, "num_env_steps_sampled": 1000, "episode_return_mean": -0.9, "episode_return_max": 17.5, "num_agent_steps_sampled": {"default_agent": 1000}, "episode_len_mean": 50.0, "episode_duration_sec_mean": 0.035167291249968, "time_between_sampling": 4.237819405279073}, "num_healthy_workers": 1, "actor_manager_num_outstanding_async_reqs": 0, "num_remote_worker_restarts": 0}, "num_env_steps_sampled_lifetime": -475000.0, "fault_tolerance": {"num_healthy_workers": 0, "num_remote_worker_restarts": 0}, "env_runner_group": {"actor_manager_num_outstanding_async_reqs": 0}, "done": false, "training_iteration": 4, "trial_id": "af017_00000", "date": "2025-08-11_17-15-58", "timestamp": 1754925358, "time_this_iter_s": 5.0825066566467285, "time_total_s": 20.161237001419067, "pid": 67771, "hostname": "DESKTOP-3SK5A41", "node_ip": "192.168.40.242", "config": {"exploration_config": {}, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 6, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "env": "Umbrella", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": false, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 0, "create_local_env_runner": true, "num_envs_per_env_runner": 1, "gym_env_vectorize_mode": "SYNC", "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "episodes_to_numpy": true, "max_requests_in_flight_per_env_runner": 1, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "merge_env_runner_states": "training_only", "broadcast_env_runner_states": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "complete_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "sampler_perf_stats_ema_coef": null, "_is_online": true, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": "auto", "num_aggregator_actors_per_learner": 0, "max_requests_in_flight_per_aggregator_actor": 3, "local_gpu_idx": 0, "max_requests_in_flight_per_learner": 3, "gamma": 1, "lr": 1.02025592e-05, "grad_clip": 0.5, "grad_clip_by": "global_norm", "_train_batch_size_per_learner": 5000, "train_batch_size": 4000, "num_epochs": 3, "minibatch_size": 1000, "shuffle_batch_per_epoch": true, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "log_std_clip_param": 20.0, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "_disable_preprocessor_api": false, "_disable_action_flattening": false}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "_learner_class": null, "callbacks_on_algorithm_init": null, "callbacks_on_env_runners_recreated": null, "callbacks_on_offline_eval_runners_recreated": null, "callbacks_on_checkpoint_loaded": null, "callbacks_on_environment_created": null, "callbacks_on_episode_created": null, "callbacks_on_episode_start": null, "callbacks_on_episode_step": null, "callbacks_on_episode_end": null, "callbacks_on_evaluate_start": null, "callbacks_on_evaluate_end": null, "callbacks_on_evaluate_offline_start": null, "callbacks_on_evaluate_offline_end": null, "callbacks_on_sample_end": null, "callbacks_on_train_result": null, "explore": true, "enable_rl_module_and_learner": true, "enable_env_runner_and_connector_v2": true, "_prior_exploration_config": {"type": "StochasticSampling"}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x77ab39ecaac0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "offline_data_class": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_read_batch_size": null, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "materialize_data": false, "materialize_mapped_data": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "ignore_final_observation": false, "prelearner_class": null, "prelearner_buffer_class": null, "prelearner_buffer_kwargs": {}, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_remaining_data": false, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": 1, "evaluation_duration": 20, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_auto_duration_min_env_steps_per_sample": 100, "evaluation_auto_duration_max_env_steps_per_sample": 2000, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 1, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "offline_evaluation_interval": null, "num_offline_eval_runners": 0, "offline_loss_for_module_fn": null, "offline_evaluation_duration": 1, "offline_evaluation_parallel_to_training": false, "offline_evaluation_timeout_s": 120.0, "num_cpus_per_offline_eval_runner": 1, "num_gpus_per_offline_eval_runner": 0, "custom_resources_per_offline_eval_runner": {}, "restart_failed_offline_eval_runners": true, "ignore_offline_eval_runner_failures": false, "max_num_offline_eval_runner_restarts": 1000, "offline_eval_runner_restore_timeout_s": 1800.0, "max_requests_in_flight_per_offline_eval_runner": 1, "validate_offline_eval_runners_after_construction": true, "offline_eval_runner_health_probe_timeout_s": 30.0, "offline_eval_rl_module_inference_only": false, "broadcast_offline_eval_runner_states": false, "offline_eval_batch_size_per_runner": 256, "dataset_num_iters_per_eval_runner": 1, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "log_gradients": true, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 42, "restart_failed_env_runners": true, "ignore_env_runner_failures": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30.0, "env_runner_restore_timeout_s": 1800.0, "_model_config": {}, "_rl_module_spec": "RLModuleSpec(module_class=None, observation_space=None, action_space=None, inference_only=False, learner_only=False, model_config=DefaultModelConfig(fcnet_hiddens=[114, 56], fcnet_activation='tanh', fcnet_kernel_initializer=None, fcnet_kernel_initializer_kwargs=None, fcnet_bias_initializer=None, fcnet_bias_initializer_kwargs=None, conv_filters=None, conv_activation='relu', conv_kernel_initializer=None, conv_kernel_initializer_kwargs=None, conv_bias_initializer=None, conv_bias_initializer_kwargs=None, head_fcnet_hiddens=[], head_fcnet_activation='relu', head_fcnet_kernel_initializer=None, head_fcnet_kernel_initializer_kwargs=None, head_fcnet_bias_initializer=None, head_fcnet_bias_initializer_kwargs=None, free_log_std=False, log_std_clip_param=20.0, vf_share_layers=True, use_lstm=False, max_seq_len=20, lstm_cell_size=256, lstm_use_prev_action=False, lstm_use_prev_reward=False, lstm_kernel_initializer=None, lstm_kernel_initializer_kwargs=None, lstm_bias_initializer=None, lstm_bias_initializer_kwargs=None), catalog_class=None, load_state_path=None, model_config_dict=None)", "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "_validate_config": true, "_use_msgpack_checkpoints": false, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "env_task_fn": -1, "enable_connectors": -1, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.1483783801338, "kl_target": 0.0299561178854, "vf_loss_coeff": 0.8294931856016, "entropy_coeff": 0.0028379241987, "clip_param": 0.2023271755792, "vf_clip_param": 0.1015383331916, "entropy_coeff_schedule": null, "lr_schedule": null, "sgd_minibatch_size": -1, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9059303202574, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.callbacks.callbacks.RLlibCallback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 20.161237001419067, "iterations_since_restore": 4, "perf": {"cpu_util_percent": 12.485714285714286, "ram_util_percent": 74.3}}
{"timers": {"training_iteration": 4.327750293105869, "restore_env_runners": 1.521795363217612e-05, "training_step": 4.327450280257775, "env_runner_sampling_timer": 3.855410984727378, "learner_update_timer": 0.4684069676486547, "synch_weights": 0.0015225359089569245, "restore_eval_env_runners": 1.3368590907709402e-05, "evaluation_iteration": 0.7449050812691743, "synch_eval_env_connectors": 0.0004910273502010412, "synch_env_connectors": 8.38203048752075e-06}, "env_runners": {"env_to_module_sum_episodes_length_in": 27.16809333212661, "module_to_env_connector": {"timers": {"connectors": {"listify_data_for_vector_env": 3.0892815504488545e-05, "un_batch_to_individual_items": 1.4539655382565515e-05, "get_actions": 0.00016816947967934106, "tensor_to_numpy": 5.0043368648698883e-05, "remove_single_ts_time_rank_from_batch": 1.4578766998266124e-06, "normalize_and_clip_actions": 2.272601879366985e-05}}, "connector_pipeline_timer": 0.0003662784932740553}, "num_agent_steps_sampled": {"default_agent": 5000.0}, "env_to_module_sum_episodes_length_out": 27.16809333212661, "num_env_steps_sampled": 5000.0, "episode_duration_sec_mean": 0.03691716200999508, "env_step_timer": 4.342430166444141e-05, "episode_return_mean": 6.5, "sample": 0.03832080708818883, "env_to_module_connector": {"timers": {"connectors": {"add_time_dim_to_batch_and_zero_pad": 6.380300768190498e-06, "numpy_to_tensor": 3.188483372953648e-05, "add_states_from_episodes_to_batch": 3.5386963596728043e-06, "add_observations_from_episodes_to_batch": 6.265024344976106e-06, "batch_individual_items": 1.8523818976710466e-05}}, "connector_pipeline_timer": 0.00012013936067606097}, "num_episodes": 100.0, "num_module_steps_sampled_lifetime": {"default_policy": -717500.0}, "episode_return_max": 14.5, "num_env_steps_sampled_lifetime": -717500.0, "episode_len_mean": 50.0, "num_agent_steps_sampled_lifetime": {"default_agent": -717500.0}, "episode_len_max": 50, "env_reset_timer": 9.548572278857708e-05, "num_module_steps_sampled": {"default_policy": 5000.0}, "num_episodes_lifetime": -14350.0, "episode_return_min": -5.5, "time_between_sampling": 0.012472639185461664, "rlmodule_inference_timer": 0.00010197590391611317, "episode_len_min": 50, "weights_seq_no": 4.0, "module_episode_returns_mean": {"default_policy": 6.5}, "agent_episode_returns_mean": {"default_agent": 6.5}, "num_env_steps_sampled_lifetime_throughput": 1264.1566635768197}, "learners": {"__all_modules__": {"learner_connector": {"timers": {"connectors": {"add_columns_from_episodes_to_train_batch": 0.06880269834824844, "general_advantage_estimation": 0.01156537711873265, "add_observations_from_episodes_to_batch": 0.000772348355173811, "add_time_dim_to_batch_and_zero_pad": 2.18074838523889e-05, "add_states_from_episodes_to_batch": 5.711672714891338e-06, "add_one_ts_to_episodes_and_truncate": 0.008342066732815382, "numpy_to_tensor": 0.000163322045318548, "batch_individual_items": 0.2027497967779215}}, "connector_pipeline_timer": 0.29273574614550935}, "num_module_steps_trained": 16000, "num_non_trainable_parameters": 0, "num_module_steps_trained_lifetime": 80000, "learner_connector_sum_episodes_length_out": 5100.0, "learner_connector_sum_episodes_length_in": 5000.0, "num_trainable_parameters": 7067, "num_env_steps_trained_lifetime": 408000, "num_env_steps_trained": 81600, "num_env_steps_trained_lifetime_throughput": 991828.2101972328, "num_module_steps_trained_throughput": 195120.66587254222, "num_module_steps_trained_lifetime_throughput": 194984.63459233692}, "default_policy": {"num_module_steps_trained": 16000, "vf_explained_var": 0.010418415069580078, "num_module_steps_trained_lifetime": 80000, "module_train_batch_size_mean": 1000.0, "curr_kl_coeff": 0.00463682459667325, "policy_loss": -0.005805053748190403, "mean_kl_loss": 5.4366046242648736e-06, "vf_loss": 0.09609980136156082, "default_optimizer_learning_rate": 1.02025592e-05, "total_loss": 0.07194828242063522, "num_trainable_parameters": 7067, "gradients_default_optimizer_global_norm": 0.06274370849132538, "curr_entropy_coeff": 0.0028379241987, "vf_loss_unclipped": 12.820938110351562, "entropy": 0.6909475326538086, "weights_seq_no": 5.0, "diff_num_grad_updates_vs_sampler_policy": 1.0, "num_module_steps_trained_lifetime_throughput": 195437.53472062774}}, "num_training_step_calls_per_iteration": 1, "evaluation": {"env_runners": {"module_to_env_connector": {"timers": {"connectors": {"tensor_to_numpy": 4.499327149498476e-05, "get_actions": 0.00015357259110231273, "remove_single_ts_time_rank_from_batch": 1.5087640151518737e-06, "normalize_and_clip_actions": 2.2197834332103478e-05, "un_batch_to_individual_items": 1.5532565213993332e-05, "listify_data_for_vector_env": 3.046953717030026e-05}}, "connector_pipeline_timer": 0.00034168163212524005}, "env_reset_timer": 0.00024548849341626496, "env_to_module_connector": {"timers": {"connectors": {"add_observations_from_episodes_to_batch": 6.370684980265764e-06, "add_states_from_episodes_to_batch": 3.244818391026588e-06, "add_time_dim_to_batch_and_zero_pad": 5.983675332306442e-06, "batch_individual_items": 1.8298405160713014e-05, "numpy_to_tensor": 2.862178310142671e-05}}, "connector_pipeline_timer": 0.00011234911754379695}, "num_episodes_lifetime": 100, "rlmodule_inference_timer": 9.685932067150507e-05, "num_module_steps_sampled": {"default_policy": 1000}, "agent_episode_returns_mean": {"default_agent": -0.7}, "num_env_steps_sampled_lifetime": 26000, "episode_len_max": 50, "num_module_steps_sampled_lifetime": {"default_policy": 5000}, "weights_seq_no": 5.0, "num_agent_steps_sampled_lifetime": {"default_agent": 5000}, "env_to_module_sum_episodes_length_in": 27.168093332126602, "env_to_module_sum_episodes_length_out": 27.168093332126602, "env_step_timer": 4.2003916316530205e-05, "sample": 0.7325643441346107, "num_episodes": 20, "module_episode_returns_mean": {"default_policy": -0.7}, "episode_return_min": -16.5, "episode_len_min": 50, "num_env_steps_sampled": 1000, "episode_return_mean": -0.7, "episode_return_max": 17.5, "num_agent_steps_sampled": {"default_agent": 1000}, "episode_len_mean": 50.0, "episode_duration_sec_mean": 0.03519079700997281, "time_between_sampling": 4.23773194823629}, "num_healthy_workers": 1, "actor_manager_num_outstanding_async_reqs": 0, "num_remote_worker_restarts": 0}, "num_env_steps_sampled_lifetime": -717500.0, "fault_tolerance": {"num_healthy_workers": 0, "num_remote_worker_restarts": 0}, "env_runner_group": {"actor_manager_num_outstanding_async_reqs": 0}, "done": false, "training_iteration": 5, "trial_id": "af017_00000", "date": "2025-08-11_17-16-03", "timestamp": 1754925363, "time_this_iter_s": 4.92285680770874, "time_total_s": 25.084093809127808, "pid": 67771, "hostname": "DESKTOP-3SK5A41", "node_ip": "192.168.40.242", "config": {"exploration_config": {}, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 6, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "env": "Umbrella", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": false, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 0, "create_local_env_runner": true, "num_envs_per_env_runner": 1, "gym_env_vectorize_mode": "SYNC", "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "episodes_to_numpy": true, "max_requests_in_flight_per_env_runner": 1, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "merge_env_runner_states": "training_only", "broadcast_env_runner_states": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "complete_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "sampler_perf_stats_ema_coef": null, "_is_online": true, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": "auto", "num_aggregator_actors_per_learner": 0, "max_requests_in_flight_per_aggregator_actor": 3, "local_gpu_idx": 0, "max_requests_in_flight_per_learner": 3, "gamma": 1, "lr": 1.02025592e-05, "grad_clip": 0.5, "grad_clip_by": "global_norm", "_train_batch_size_per_learner": 5000, "train_batch_size": 4000, "num_epochs": 3, "minibatch_size": 1000, "shuffle_batch_per_epoch": true, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "log_std_clip_param": 20.0, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "_disable_preprocessor_api": false, "_disable_action_flattening": false}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "_learner_class": null, "callbacks_on_algorithm_init": null, "callbacks_on_env_runners_recreated": null, "callbacks_on_offline_eval_runners_recreated": null, "callbacks_on_checkpoint_loaded": null, "callbacks_on_environment_created": null, "callbacks_on_episode_created": null, "callbacks_on_episode_start": null, "callbacks_on_episode_step": null, "callbacks_on_episode_end": null, "callbacks_on_evaluate_start": null, "callbacks_on_evaluate_end": null, "callbacks_on_evaluate_offline_start": null, "callbacks_on_evaluate_offline_end": null, "callbacks_on_sample_end": null, "callbacks_on_train_result": null, "explore": true, "enable_rl_module_and_learner": true, "enable_env_runner_and_connector_v2": true, "_prior_exploration_config": {"type": "StochasticSampling"}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x77ab39ecaac0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "offline_data_class": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_read_batch_size": null, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "materialize_data": false, "materialize_mapped_data": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "ignore_final_observation": false, "prelearner_class": null, "prelearner_buffer_class": null, "prelearner_buffer_kwargs": {}, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_remaining_data": false, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": 1, "evaluation_duration": 20, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_auto_duration_min_env_steps_per_sample": 100, "evaluation_auto_duration_max_env_steps_per_sample": 2000, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 1, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "offline_evaluation_interval": null, "num_offline_eval_runners": 0, "offline_loss_for_module_fn": null, "offline_evaluation_duration": 1, "offline_evaluation_parallel_to_training": false, "offline_evaluation_timeout_s": 120.0, "num_cpus_per_offline_eval_runner": 1, "num_gpus_per_offline_eval_runner": 0, "custom_resources_per_offline_eval_runner": {}, "restart_failed_offline_eval_runners": true, "ignore_offline_eval_runner_failures": false, "max_num_offline_eval_runner_restarts": 1000, "offline_eval_runner_restore_timeout_s": 1800.0, "max_requests_in_flight_per_offline_eval_runner": 1, "validate_offline_eval_runners_after_construction": true, "offline_eval_runner_health_probe_timeout_s": 30.0, "offline_eval_rl_module_inference_only": false, "broadcast_offline_eval_runner_states": false, "offline_eval_batch_size_per_runner": 256, "dataset_num_iters_per_eval_runner": 1, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "log_gradients": true, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 42, "restart_failed_env_runners": true, "ignore_env_runner_failures": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30.0, "env_runner_restore_timeout_s": 1800.0, "_model_config": {}, "_rl_module_spec": "RLModuleSpec(module_class=None, observation_space=None, action_space=None, inference_only=False, learner_only=False, model_config=DefaultModelConfig(fcnet_hiddens=[114, 56], fcnet_activation='tanh', fcnet_kernel_initializer=None, fcnet_kernel_initializer_kwargs=None, fcnet_bias_initializer=None, fcnet_bias_initializer_kwargs=None, conv_filters=None, conv_activation='relu', conv_kernel_initializer=None, conv_kernel_initializer_kwargs=None, conv_bias_initializer=None, conv_bias_initializer_kwargs=None, head_fcnet_hiddens=[], head_fcnet_activation='relu', head_fcnet_kernel_initializer=None, head_fcnet_kernel_initializer_kwargs=None, head_fcnet_bias_initializer=None, head_fcnet_bias_initializer_kwargs=None, free_log_std=False, log_std_clip_param=20.0, vf_share_layers=True, use_lstm=False, max_seq_len=20, lstm_cell_size=256, lstm_use_prev_action=False, lstm_use_prev_reward=False, lstm_kernel_initializer=None, lstm_kernel_initializer_kwargs=None, lstm_bias_initializer=None, lstm_bias_initializer_kwargs=None), catalog_class=None, load_state_path=None, model_config_dict=None)", "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "_validate_config": true, "_use_msgpack_checkpoints": false, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "env_task_fn": -1, "enable_connectors": -1, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.1483783801338, "kl_target": 0.0299561178854, "vf_loss_coeff": 0.8294931856016, "entropy_coeff": 0.0028379241987, "clip_param": 0.2023271755792, "vf_clip_param": 0.1015383331916, "entropy_coeff_schedule": null, "lr_schedule": null, "sgd_minibatch_size": -1, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9059303202574, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.callbacks.callbacks.RLlibCallback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 25.084093809127808, "iterations_since_restore": 5, "perf": {"cpu_util_percent": 12.485714285714286, "ram_util_percent": 74.3}}
{"timers": {"training_iteration": 4.327645316194809, "restore_env_runners": 1.5187774097137955e-05, "training_step": 4.327344290475198, "env_runner_sampling_timer": 3.8561187079001042, "learner_update_timer": 0.4675932949721687, "synch_weights": 0.0015216195498656757, "restore_eval_env_runners": 1.333790500075968e-05, "evaluation_iteration": 0.7449001754664774, "synch_eval_env_connectors": 0.0004894960766987988, "synch_env_connectors": 8.371210183711791e-06}, "env_runners": {"env_to_module_sum_episodes_length_in": 27.16809333212661, "module_to_env_connector": {"timers": {"connectors": {"listify_data_for_vector_env": 3.085882790621157e-05, "un_batch_to_individual_items": 1.4438635274519905e-05, "get_actions": 0.00016694664846076665, "tensor_to_numpy": 4.960290150650591e-05, "remove_single_ts_time_rank_from_batch": 1.4761213890968465e-06, "normalize_and_clip_actions": 2.2764828323746197e-05}}, "connector_pipeline_timer": 0.0003645303532011249}, "num_agent_steps_sampled": {"default_agent": 5000.0}, "env_to_module_sum_episodes_length_out": 27.16809333212661, "num_env_steps_sampled": 5000.0, "episode_duration_sec_mean": 0.036768990020009384, "env_step_timer": 4.330922759228082e-05, "episode_return_mean": 5.299999999999998, "sample": 0.03805334528495777, "env_to_module_connector": {"timers": {"connectors": {"add_time_dim_to_batch_and_zero_pad": 6.326702334152626e-06, "numpy_to_tensor": 3.142830565530563e-05, "add_states_from_episodes_to_batch": 3.511399583195682e-06, "add_observations_from_episodes_to_batch": 6.304969060509947e-06, "batch_individual_items": 1.837661381366821e-05}}, "connector_pipeline_timer": 0.00011922893536220152}, "num_episodes": 100.0, "num_module_steps_sampled_lifetime": {"default_policy": -960000.0}, "episode_return_max": 14.5, "num_env_steps_sampled_lifetime": -960000.0, "episode_len_mean": 50.0, "num_agent_steps_sampled_lifetime": {"default_agent": -960000.0}, "episode_len_max": 50, "env_reset_timer": 9.355124595897282e-05, "num_module_steps_sampled": {"default_policy": 5000.0}, "num_episodes_lifetime": -19200.0, "episode_return_min": -5.5, "time_between_sampling": 0.01194670776217379, "rlmodule_inference_timer": 0.00010121764989851207, "episode_len_min": 50, "weights_seq_no": 5.0, "module_episode_returns_mean": {"default_policy": 5.299999999999998}, "agent_episode_returns_mean": {"default_agent": 5.299999999999998}, "num_env_steps_sampled_lifetime_throughput": 1270.755287346688}, "learners": {"__all_modules__": {"learner_connector": {"timers": {"connectors": {"add_columns_from_episodes_to_train_batch": 0.06879628136476741, "general_advantage_estimation": 0.011558614347545182, "add_observations_from_episodes_to_batch": 0.0007715768716163443, "add_time_dim_to_batch_and_zero_pad": 2.181440900818103e-05, "add_states_from_episodes_to_batch": 5.70655598351841e-06, "add_one_ts_to_episodes_and_truncate": 0.008342215065485761, "numpy_to_tensor": 0.00016336782486260138, "batch_individual_items": 0.2028214468101398}}, "connector_pipeline_timer": 0.2927942586840565}, "num_module_steps_trained": 16000, "num_non_trainable_parameters": 0, "num_module_steps_trained_lifetime": 96000, "learner_connector_sum_episodes_length_out": 5100.0, "learner_connector_sum_episodes_length_in": 5000.0, "num_trainable_parameters": 7067, "num_env_steps_trained_lifetime": 489600, "num_env_steps_trained": 81600, "num_env_steps_trained_lifetime_throughput": 990398.242945929, "num_module_steps_trained_throughput": 194813.90600783832, "num_module_steps_trained_lifetime_throughput": 194681.72383427114}, "default_policy": {"num_module_steps_trained": 16000, "vf_explained_var": 0.011510908603668213, "num_module_steps_trained_lifetime": 96000, "module_train_batch_size_mean": 1000.0, "curr_kl_coeff": 0.002318412298336625, "policy_loss": -0.009974595159292221, "mean_kl_loss": 7.823862233635737e-07, "vf_loss": 0.09473336488008499, "default_optimizer_learning_rate": 1.02025592e-05, "total_loss": 0.06664570420980453, "num_trainable_parameters": 7067, "gradients_default_optimizer_global_norm": 0.041819017380476, "curr_entropy_coeff": 0.0028379241987, "vf_loss_unclipped": 10.878037452697754, "entropy": 0.690781831741333, "weights_seq_no": 6.0, "diff_num_grad_updates_vs_sampler_policy": 1.0, "num_module_steps_trained_lifetime_throughput": 195112.16919918862}}, "num_training_step_calls_per_iteration": 1, "evaluation": {"env_runners": {"module_to_env_connector": {"timers": {"connectors": {"tensor_to_numpy": 4.6072008567824187e-05, "get_actions": 0.00015539135778128453, "remove_single_ts_time_rank_from_batch": 1.3700403771426406e-06, "normalize_and_clip_actions": 2.1695650111274247e-05, "un_batch_to_individual_items": 1.5403546347731e-05, "listify_data_for_vector_env": 3.0311363020553737e-05}}, "connector_pipeline_timer": 0.0003429233478564145}, "env_reset_timer": 0.0002449406084783108, "env_to_module_connector": {"timers": {"connectors": {"add_observations_from_episodes_to_batch": 6.520595565656475e-06, "add_states_from_episodes_to_batch": 3.3057822275823946e-06, "add_time_dim_to_batch_and_zero_pad": 6.203131359783295e-06, "batch_individual_items": 1.8451507464878146e-05, "numpy_to_tensor": 2.9255756213798846e-05}}, "connector_pipeline_timer": 0.00011307465653177528}, "num_episodes_lifetime": 120, "rlmodule_inference_timer": 9.425834029456843e-05, "num_module_steps_sampled": {"default_policy": 1000}, "agent_episode_returns_mean": {"default_agent": -1.7}, "num_env_steps_sampled_lifetime": 31000, "episode_len_max": 50, "num_module_steps_sampled_lifetime": {"default_policy": 6000}, "weights_seq_no": 6.0, "num_agent_steps_sampled_lifetime": {"default_agent": 6000}, "env_to_module_sum_episodes_length_in": 27.168093332126602, "env_to_module_sum_episodes_length_out": 27.168093332126602, "env_step_timer": 4.1907751029563975e-05, "sample": 0.7325654466932634, "num_episodes": 20, "module_episode_returns_mean": {"default_policy": -1.7}, "episode_return_min": -16.5, "episode_len_min": 50, "num_env_steps_sampled": 1000, "episode_return_mean": -1.7, "episode_return_max": 17.5, "num_agent_steps_sampled": {"default_agent": 1000}, "episode_len_mean": 50.0, "episode_duration_sec_mean": 0.03519363402001545, "time_between_sampling": 4.239057951783931}, "num_healthy_workers": 1, "actor_manager_num_outstanding_async_reqs": 0, "num_remote_worker_restarts": 0}, "num_env_steps_sampled_lifetime": -960000.0, "fault_tolerance": {"num_healthy_workers": 0, "num_remote_worker_restarts": 0}, "env_runner_group": {"actor_manager_num_outstanding_async_reqs": 0}, "done": false, "training_iteration": 6, "trial_id": "af017_00000", "date": "2025-08-11_17-16-08", "timestamp": 1754925368, "time_this_iter_s": 5.0636467933654785, "time_total_s": 30.147740602493286, "pid": 67771, "hostname": "DESKTOP-3SK5A41", "node_ip": "192.168.40.242", "config": {"exploration_config": {}, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 6, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "env": "Umbrella", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": false, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 0, "create_local_env_runner": true, "num_envs_per_env_runner": 1, "gym_env_vectorize_mode": "SYNC", "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "episodes_to_numpy": true, "max_requests_in_flight_per_env_runner": 1, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "merge_env_runner_states": "training_only", "broadcast_env_runner_states": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "complete_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "sampler_perf_stats_ema_coef": null, "_is_online": true, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": "auto", "num_aggregator_actors_per_learner": 0, "max_requests_in_flight_per_aggregator_actor": 3, "local_gpu_idx": 0, "max_requests_in_flight_per_learner": 3, "gamma": 1, "lr": 1.02025592e-05, "grad_clip": 0.5, "grad_clip_by": "global_norm", "_train_batch_size_per_learner": 5000, "train_batch_size": 4000, "num_epochs": 3, "minibatch_size": 1000, "shuffle_batch_per_epoch": true, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "log_std_clip_param": 20.0, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "_disable_preprocessor_api": false, "_disable_action_flattening": false}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "_learner_class": null, "callbacks_on_algorithm_init": null, "callbacks_on_env_runners_recreated": null, "callbacks_on_offline_eval_runners_recreated": null, "callbacks_on_checkpoint_loaded": null, "callbacks_on_environment_created": null, "callbacks_on_episode_created": null, "callbacks_on_episode_start": null, "callbacks_on_episode_step": null, "callbacks_on_episode_end": null, "callbacks_on_evaluate_start": null, "callbacks_on_evaluate_end": null, "callbacks_on_evaluate_offline_start": null, "callbacks_on_evaluate_offline_end": null, "callbacks_on_sample_end": null, "callbacks_on_train_result": null, "explore": true, "enable_rl_module_and_learner": true, "enable_env_runner_and_connector_v2": true, "_prior_exploration_config": {"type": "StochasticSampling"}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x77ab39ecaac0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "offline_data_class": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_read_batch_size": null, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "materialize_data": false, "materialize_mapped_data": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "ignore_final_observation": false, "prelearner_class": null, "prelearner_buffer_class": null, "prelearner_buffer_kwargs": {}, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_remaining_data": false, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": 1, "evaluation_duration": 20, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_auto_duration_min_env_steps_per_sample": 100, "evaluation_auto_duration_max_env_steps_per_sample": 2000, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 1, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "offline_evaluation_interval": null, "num_offline_eval_runners": 0, "offline_loss_for_module_fn": null, "offline_evaluation_duration": 1, "offline_evaluation_parallel_to_training": false, "offline_evaluation_timeout_s": 120.0, "num_cpus_per_offline_eval_runner": 1, "num_gpus_per_offline_eval_runner": 0, "custom_resources_per_offline_eval_runner": {}, "restart_failed_offline_eval_runners": true, "ignore_offline_eval_runner_failures": false, "max_num_offline_eval_runner_restarts": 1000, "offline_eval_runner_restore_timeout_s": 1800.0, "max_requests_in_flight_per_offline_eval_runner": 1, "validate_offline_eval_runners_after_construction": true, "offline_eval_runner_health_probe_timeout_s": 30.0, "offline_eval_rl_module_inference_only": false, "broadcast_offline_eval_runner_states": false, "offline_eval_batch_size_per_runner": 256, "dataset_num_iters_per_eval_runner": 1, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "log_gradients": true, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 42, "restart_failed_env_runners": true, "ignore_env_runner_failures": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30.0, "env_runner_restore_timeout_s": 1800.0, "_model_config": {}, "_rl_module_spec": "RLModuleSpec(module_class=None, observation_space=None, action_space=None, inference_only=False, learner_only=False, model_config=DefaultModelConfig(fcnet_hiddens=[114, 56], fcnet_activation='tanh', fcnet_kernel_initializer=None, fcnet_kernel_initializer_kwargs=None, fcnet_bias_initializer=None, fcnet_bias_initializer_kwargs=None, conv_filters=None, conv_activation='relu', conv_kernel_initializer=None, conv_kernel_initializer_kwargs=None, conv_bias_initializer=None, conv_bias_initializer_kwargs=None, head_fcnet_hiddens=[], head_fcnet_activation='relu', head_fcnet_kernel_initializer=None, head_fcnet_kernel_initializer_kwargs=None, head_fcnet_bias_initializer=None, head_fcnet_bias_initializer_kwargs=None, free_log_std=False, log_std_clip_param=20.0, vf_share_layers=True, use_lstm=False, max_seq_len=20, lstm_cell_size=256, lstm_use_prev_action=False, lstm_use_prev_reward=False, lstm_kernel_initializer=None, lstm_kernel_initializer_kwargs=None, lstm_bias_initializer=None, lstm_bias_initializer_kwargs=None), catalog_class=None, load_state_path=None, model_config_dict=None)", "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "_validate_config": true, "_use_msgpack_checkpoints": false, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "env_task_fn": -1, "enable_connectors": -1, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.1483783801338, "kl_target": 0.0299561178854, "vf_loss_coeff": 0.8294931856016, "entropy_coeff": 0.0028379241987, "clip_param": 0.2023271755792, "vf_clip_param": 0.1015383331916, "entropy_coeff_schedule": null, "lr_schedule": null, "sgd_minibatch_size": -1, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9059303202574, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.callbacks.callbacks.RLlibCallback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 30.147740602493286, "iterations_since_restore": 6, "perf": {"cpu_util_percent": 12.5875, "ram_util_percent": 74.3}}
{"timers": {"training_iteration": 4.326281222102863, "restore_env_runners": 1.5170896356394167e-05, "training_step": 4.325979072640447, "env_runner_sampling_timer": 3.8569159198911094, "learner_update_timer": 0.46542263102245, "synch_weights": 0.0015248733543715457, "restore_eval_env_runners": 1.3312525954572135e-05, "evaluation_iteration": 0.7448738117218152, "synch_eval_env_connectors": 0.0004886081159295384, "synch_env_connectors": 8.357498078287336e-06}, "env_runners": {"env_to_module_sum_episodes_length_in": 27.16809333212661, "module_to_env_connector": {"timers": {"connectors": {"listify_data_for_vector_env": 3.078319901319612e-05, "un_batch_to_individual_items": 1.4549181511327025e-05, "get_actions": 0.00016739562627751084, "tensor_to_numpy": 4.9762083085820514e-05, "remove_single_ts_time_rank_from_batch": 1.4765978321104446e-06, "normalize_and_clip_actions": 2.274375086353686e-05}}, "connector_pipeline_timer": 0.00036527437623103484}, "num_agent_steps_sampled": {"default_agent": 5000.0}, "env_to_module_sum_episodes_length_out": 27.16809333212661, "num_env_steps_sampled": 5000.0, "episode_duration_sec_mean": 0.03682277306998914, "env_step_timer": 4.3097347123567863e-05, "episode_return_mean": 5.700000000000004, "sample": 0.03790030964156295, "env_to_module_connector": {"timers": {"connectors": {"add_time_dim_to_batch_and_zero_pad": 6.332411267435718e-06, "numpy_to_tensor": 3.1522485907654466e-05, "add_states_from_episodes_to_batch": 3.514091482672587e-06, "add_observations_from_episodes_to_batch": 6.270886189640745e-06, "batch_individual_items": 1.852701985537805e-05}}, "connector_pipeline_timer": 0.00011944221248338279}, "num_episodes": 100.0, "num_module_steps_sampled_lifetime": {"default_policy": -1202500.0}, "episode_return_max": 14.5, "num_env_steps_sampled_lifetime": -1202500.0, "episode_len_mean": 50.0, "num_agent_steps_sampled_lifetime": {"default_agent": -1202500.0}, "episode_len_max": 50, "env_reset_timer": 9.214374004762846e-05, "num_module_steps_sampled": {"default_policy": 5000.0}, "num_episodes_lifetime": -24050.0, "episode_return_min": -5.5, "time_between_sampling": 0.012777057613804248, "rlmodule_inference_timer": 0.0001012901685380689, "episode_len_min": 50, "weights_seq_no": 6.0, "module_episode_returns_mean": {"default_policy": 5.700000000000004}, "agent_episode_returns_mean": {"default_agent": 5.700000000000004}, "num_env_steps_sampled_lifetime_throughput": 1271.6706749086372}, "learners": {"__all_modules__": {"learner_connector": {"timers": {"connectors": {"add_columns_from_episodes_to_train_batch": 0.06878259655111651, "general_advantage_estimation": 0.011556633204075649, "add_observations_from_episodes_to_batch": 0.000770597102895907, "add_time_dim_to_batch_and_zero_pad": 2.1782264915583254e-05, "add_states_from_episodes_to_batch": 5.70149042855416e-06, "add_one_ts_to_episodes_and_truncate": 0.00834009091483551, "numpy_to_tensor": 0.00016358314661419563, "batch_individual_items": 0.2013792393420401}}, "connector_pipeline_timer": 0.2913335730972198}, "num_module_steps_trained": 16000, "num_non_trainable_parameters": 0, "num_module_steps_trained_lifetime": 112000, "learner_connector_sum_episodes_length_out": 5100.0, "learner_connector_sum_episodes_length_in": 5000.0, "num_trainable_parameters": 7067, "num_env_steps_trained_lifetime": 571200, "num_env_steps_trained": 81600, "num_env_steps_trained_lifetime_throughput": 983934.2462095199, "num_module_steps_trained_throughput": 193520.08544396976, "num_module_steps_trained_lifetime_throughput": 193392.66102403364}, "default_policy": {"num_module_steps_trained": 16000, "vf_explained_var": 0.011427104473114014, "num_module_steps_trained_lifetime": 112000, "module_train_batch_size_mean": 1000.0, "curr_kl_coeff": 0.0011592061491683125, "policy_loss": 0.05143844708800316, "mean_kl_loss": 5.060417720414989e-07, "vf_loss": 0.09453723579645157, "default_optimizer_learning_rate": 1.02025592e-05, "total_loss": 0.12789589166641235, "num_trainable_parameters": 7067, "gradients_default_optimizer_global_norm": 0.09411834925413132, "curr_entropy_coeff": 0.0028379241987, "vf_loss_unclipped": 11.08261775970459, "entropy": 0.6908449530601501, "weights_seq_no": 7.0, "diff_num_grad_updates_vs_sampler_policy": 1.0, "num_module_steps_trained_lifetime_throughput": 193799.73548752192}}, "num_training_step_calls_per_iteration": 1, "evaluation": {"env_runners": {"module_to_env_connector": {"timers": {"connectors": {"tensor_to_numpy": 4.6049060175106725e-05, "get_actions": 0.0001540537554917813, "remove_single_ts_time_rank_from_batch": 1.414191457122618e-06, "normalize_and_clip_actions": 2.2192247983339687e-05, "un_batch_to_individual_items": 1.554332332513718e-05, "listify_data_for_vector_env": 3.01351987711507e-05}}, "connector_pipeline_timer": 0.00034250360650081953}, "env_reset_timer": 0.00024374020239981026, "env_to_module_connector": {"timers": {"connectors": {"add_observations_from_episodes_to_batch": 6.674331247632324e-06, "add_states_from_episodes_to_batch": 3.5261019180268518e-06, "add_time_dim_to_batch_and_zero_pad": 5.97343762091843e-06, "batch_individual_items": 1.8474216140820126e-05, "numpy_to_tensor": 2.8762319158128586e-05}}, "connector_pipeline_timer": 0.00011446874744719923}, "num_episodes_lifetime": 140, "rlmodule_inference_timer": 9.552428208916948e-05, "num_module_steps_sampled": {"default_policy": 1000}, "agent_episode_returns_mean": {"default_agent": -1.3}, "num_env_steps_sampled_lifetime": 36000, "episode_len_max": 50, "num_module_steps_sampled_lifetime": {"default_policy": 7000}, "weights_seq_no": 7.0, "num_agent_steps_sampled_lifetime": {"default_agent": 7000}, "env_to_module_sum_episodes_length_in": 27.168093332126602, "env_to_module_sum_episodes_length_out": 27.168093332126602, "env_step_timer": 4.2074617315207555e-05, "sample": 0.7325555642463323, "num_episodes": 20, "module_episode_returns_mean": {"default_policy": -1.3}, "episode_return_min": -16.5, "episode_len_min": 50, "num_env_steps_sampled": 1000, "episode_return_mean": -1.3, "episode_return_max": 17.5, "num_agent_steps_sampled": {"default_agent": 1000}, "episode_len_mean": 50.0, "episode_duration_sec_mean": 0.03518442304002747, "time_between_sampling": 4.239149512336097}, "num_healthy_workers": 1, "actor_manager_num_outstanding_async_reqs": 0, "num_remote_worker_restarts": 0}, "num_env_steps_sampled_lifetime": -1202500.0, "fault_tolerance": {"num_healthy_workers": 0, "num_remote_worker_restarts": 0}, "env_runner_group": {"actor_manager_num_outstanding_async_reqs": 0}, "done": false, "training_iteration": 7, "trial_id": "af017_00000", "date": "2025-08-11_17-16-13", "timestamp": 1754925373, "time_this_iter_s": 4.937577962875366, "time_total_s": 35.08531856536865, "pid": 67771, "hostname": "DESKTOP-3SK5A41", "node_ip": "192.168.40.242", "config": {"exploration_config": {}, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 6, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "env": "Umbrella", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": false, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 0, "create_local_env_runner": true, "num_envs_per_env_runner": 1, "gym_env_vectorize_mode": "SYNC", "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "episodes_to_numpy": true, "max_requests_in_flight_per_env_runner": 1, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "merge_env_runner_states": "training_only", "broadcast_env_runner_states": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "complete_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "sampler_perf_stats_ema_coef": null, "_is_online": true, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": "auto", "num_aggregator_actors_per_learner": 0, "max_requests_in_flight_per_aggregator_actor": 3, "local_gpu_idx": 0, "max_requests_in_flight_per_learner": 3, "gamma": 1, "lr": 1.02025592e-05, "grad_clip": 0.5, "grad_clip_by": "global_norm", "_train_batch_size_per_learner": 5000, "train_batch_size": 4000, "num_epochs": 3, "minibatch_size": 1000, "shuffle_batch_per_epoch": true, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "log_std_clip_param": 20.0, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "_disable_preprocessor_api": false, "_disable_action_flattening": false}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "_learner_class": null, "callbacks_on_algorithm_init": null, "callbacks_on_env_runners_recreated": null, "callbacks_on_offline_eval_runners_recreated": null, "callbacks_on_checkpoint_loaded": null, "callbacks_on_environment_created": null, "callbacks_on_episode_created": null, "callbacks_on_episode_start": null, "callbacks_on_episode_step": null, "callbacks_on_episode_end": null, "callbacks_on_evaluate_start": null, "callbacks_on_evaluate_end": null, "callbacks_on_evaluate_offline_start": null, "callbacks_on_evaluate_offline_end": null, "callbacks_on_sample_end": null, "callbacks_on_train_result": null, "explore": true, "enable_rl_module_and_learner": true, "enable_env_runner_and_connector_v2": true, "_prior_exploration_config": {"type": "StochasticSampling"}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x77ab39ecaac0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "offline_data_class": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_read_batch_size": null, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "materialize_data": false, "materialize_mapped_data": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "ignore_final_observation": false, "prelearner_class": null, "prelearner_buffer_class": null, "prelearner_buffer_kwargs": {}, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_remaining_data": false, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": 1, "evaluation_duration": 20, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_auto_duration_min_env_steps_per_sample": 100, "evaluation_auto_duration_max_env_steps_per_sample": 2000, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 1, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "offline_evaluation_interval": null, "num_offline_eval_runners": 0, "offline_loss_for_module_fn": null, "offline_evaluation_duration": 1, "offline_evaluation_parallel_to_training": false, "offline_evaluation_timeout_s": 120.0, "num_cpus_per_offline_eval_runner": 1, "num_gpus_per_offline_eval_runner": 0, "custom_resources_per_offline_eval_runner": {}, "restart_failed_offline_eval_runners": true, "ignore_offline_eval_runner_failures": false, "max_num_offline_eval_runner_restarts": 1000, "offline_eval_runner_restore_timeout_s": 1800.0, "max_requests_in_flight_per_offline_eval_runner": 1, "validate_offline_eval_runners_after_construction": true, "offline_eval_runner_health_probe_timeout_s": 30.0, "offline_eval_rl_module_inference_only": false, "broadcast_offline_eval_runner_states": false, "offline_eval_batch_size_per_runner": 256, "dataset_num_iters_per_eval_runner": 1, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "log_gradients": true, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 42, "restart_failed_env_runners": true, "ignore_env_runner_failures": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30.0, "env_runner_restore_timeout_s": 1800.0, "_model_config": {}, "_rl_module_spec": "RLModuleSpec(module_class=None, observation_space=None, action_space=None, inference_only=False, learner_only=False, model_config=DefaultModelConfig(fcnet_hiddens=[114, 56], fcnet_activation='tanh', fcnet_kernel_initializer=None, fcnet_kernel_initializer_kwargs=None, fcnet_bias_initializer=None, fcnet_bias_initializer_kwargs=None, conv_filters=None, conv_activation='relu', conv_kernel_initializer=None, conv_kernel_initializer_kwargs=None, conv_bias_initializer=None, conv_bias_initializer_kwargs=None, head_fcnet_hiddens=[], head_fcnet_activation='relu', head_fcnet_kernel_initializer=None, head_fcnet_kernel_initializer_kwargs=None, head_fcnet_bias_initializer=None, head_fcnet_bias_initializer_kwargs=None, free_log_std=False, log_std_clip_param=20.0, vf_share_layers=True, use_lstm=False, max_seq_len=20, lstm_cell_size=256, lstm_use_prev_action=False, lstm_use_prev_reward=False, lstm_kernel_initializer=None, lstm_kernel_initializer_kwargs=None, lstm_bias_initializer=None, lstm_bias_initializer_kwargs=None), catalog_class=None, load_state_path=None, model_config_dict=None)", "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "_validate_config": true, "_use_msgpack_checkpoints": false, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "env_task_fn": -1, "enable_connectors": -1, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.1483783801338, "kl_target": 0.0299561178854, "vf_loss_coeff": 0.8294931856016, "entropy_coeff": 0.0028379241987, "clip_param": 0.2023271755792, "vf_clip_param": 0.1015383331916, "entropy_coeff_schedule": null, "lr_schedule": null, "sgd_minibatch_size": -1, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9059303202574, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.callbacks.callbacks.RLlibCallback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 35.08531856536865, "iterations_since_restore": 7, "perf": {"cpu_util_percent": 12.5, "ram_util_percent": 74.3}}
{"timers": {"training_iteration": 4.326631835951831, "restore_env_runners": 1.5136187392421142e-05, "training_step": 4.326327055984039, "env_runner_sampling_timer": 3.8579343897621907, "learner_update_timer": 0.4647465217122315, "synch_weights": 0.0015233536208298889, "restore_eval_env_runners": 1.3288400697366011e-05, "evaluation_iteration": 0.7448389946245945, "synch_eval_env_connectors": 0.0004885110347744092, "synch_env_connectors": 8.344923101531617e-06}, "env_runners": {"env_to_module_sum_episodes_length_in": 27.16809333212661, "module_to_env_connector": {"timers": {"connectors": {"listify_data_for_vector_env": 3.100438262919856e-05, "un_batch_to_individual_items": 1.4574886784763678e-05, "get_actions": 0.00016836774240279126, "tensor_to_numpy": 5.01515004913966e-05, "remove_single_ts_time_rank_from_batch": 1.4734222930721084e-06, "normalize_and_clip_actions": 2.2827309516350846e-05}}, "connector_pipeline_timer": 0.0003672928718644732}, "num_agent_steps_sampled": {"default_agent": 5000.0}, "env_to_module_sum_episodes_length_out": 27.16809333212661, "num_env_steps_sampled": 5000.0, "episode_duration_sec_mean": 0.03705886706003185, "env_step_timer": 4.333346309350064e-05, "episode_return_mean": 6.299999999999996, "sample": 0.03799299349974357, "env_to_module_connector": {"timers": {"connectors": {"add_time_dim_to_batch_and_zero_pad": 6.422697707243629e-06, "numpy_to_tensor": 3.168355304100836e-05, "add_states_from_episodes_to_batch": 3.5446873652030757e-06, "add_observations_from_episodes_to_batch": 6.314303741679731e-06, "batch_individual_items": 1.8533843042635684e-05}}, "connector_pipeline_timer": 0.00012015183714181456}, "num_episodes": 100.0, "num_module_steps_sampled_lifetime": {"default_policy": -1445000.0}, "episode_return_max": 14.5, "num_env_steps_sampled_lifetime": -1445000.0, "episode_len_mean": 50.0, "num_agent_steps_sampled_lifetime": {"default_agent": -1445000.0}, "episode_len_max": 50, "env_reset_timer": 9.366575723590162e-05, "num_module_steps_sampled": {"default_policy": 5000.0}, "num_episodes_lifetime": -28900.0, "episode_return_min": -5.5, "time_between_sampling": 0.012211988306907826, "rlmodule_inference_timer": 0.00010226485047755079, "episode_len_min": 50, "weights_seq_no": 7.0, "module_episode_returns_mean": {"default_policy": 6.299999999999996}, "agent_episode_returns_mean": {"default_agent": 6.299999999999996}, "num_env_steps_sampled_lifetime_throughput": 1264.6725460632515}, "learners": {"__all_modules__": {"learner_connector": {"timers": {"connectors": {"add_columns_from_episodes_to_train_batch": 0.06875820158560803, "general_advantage_estimation": 0.011532178872034959, "add_observations_from_episodes_to_batch": 0.0007695581318738759, "add_time_dim_to_batch_and_zero_pad": 2.1754442267084587e-05, "add_states_from_episodes_to_batch": 5.693475524485966e-06, "add_one_ts_to_episodes_and_truncate": 0.008519490005687582, "numpy_to_tensor": 0.0001637293151474199, "batch_individual_items": 0.2013999539486182}}, "connector_pipeline_timer": 0.2914840953662435}, "num_module_steps_trained": 16000, "num_non_trainable_parameters": 0, "num_module_steps_trained_lifetime": 128000, "learner_connector_sum_episodes_length_out": 5100.0, "learner_connector_sum_episodes_length_in": 5000.0, "num_trainable_parameters": 7067, "num_env_steps_trained_lifetime": 652800, "num_env_steps_trained": 81600, "num_env_steps_trained_lifetime_throughput": 978509.6493785067, "num_module_steps_trained_throughput": 192433.38906487063, "num_module_steps_trained_lifetime_throughput": 192309.89597241062}, "default_policy": {"num_module_steps_trained": 16000, "vf_explained_var": 0.010435283184051514, "num_module_steps_trained_lifetime": 128000, "module_train_batch_size_mean": 1000.0, "curr_kl_coeff": 0.0005796030745841563, "policy_loss": 0.001627521007321775, "mean_kl_loss": 2.9266675483086146e-06, "vf_loss": 0.09629125148057938, "default_optimizer_learning_rate": 1.02025592e-05, "total_loss": 0.07953917235136032, "num_trainable_parameters": 7067, "gradients_default_optimizer_global_norm": 0.06158152595162392, "curr_entropy_coeff": 0.0028379241987, "vf_loss_unclipped": 12.129490852355957, "entropy": 0.6911000609397888, "weights_seq_no": 8.0, "diff_num_grad_updates_vs_sampler_policy": 1.0, "num_module_steps_trained_lifetime_throughput": 192695.11219850517}}, "num_training_step_calls_per_iteration": 1, "evaluation": {"env_runners": {"module_to_env_connector": {"timers": {"connectors": {"tensor_to_numpy": 4.678722619811933e-05, "get_actions": 0.00016113902765368157, "remove_single_ts_time_rank_from_batch": 1.4680052350740241e-06, "normalize_and_clip_actions": 2.2953334734174263e-05, "un_batch_to_individual_items": 1.6034478522650645e-05, "listify_data_for_vector_env": 3.1491510137637354e-05}}, "connector_pipeline_timer": 0.00035667064137179}, "env_reset_timer": 0.00024376080037483592, "env_to_module_connector": {"timers": {"connectors": {"add_observations_from_episodes_to_batch": 6.5733132125569075e-06, "add_states_from_episodes_to_batch": 3.3690975567485384e-06, "add_time_dim_to_batch_and_zero_pad": 6.0921048872957154e-06, "batch_individual_items": 1.860416605673853e-05, "numpy_to_tensor": 2.984933491381512e-05}}, "connector_pipeline_timer": 0.00011548343587009828}, "num_episodes_lifetime": 160, "rlmodule_inference_timer": 9.821822440099426e-05, "num_module_steps_sampled": {"default_policy": 1000}, "agent_episode_returns_mean": {"default_agent": -0.9}, "num_env_steps_sampled_lifetime": 41000, "episode_len_max": 50, "num_module_steps_sampled_lifetime": {"default_policy": 8000}, "weights_seq_no": 8.0, "num_agent_steps_sampled_lifetime": {"default_agent": 8000}, "env_to_module_sum_episodes_length_in": 27.168093332126602, "env_to_module_sum_episodes_length_out": 27.168093332126602, "env_step_timer": 4.241086396649559e-05, "sample": 0.7326033776038662, "num_episodes": 20, "module_episode_returns_mean": {"default_policy": -0.9}, "episode_return_min": -16.5, "episode_len_min": 50, "num_env_steps_sampled": 1000, "episode_return_mean": -0.9, "episode_return_max": 17.5, "num_agent_steps_sampled": {"default_agent": 1000}, "episode_len_mean": 50.0, "episode_duration_sec_mean": 0.0352384730400172, "time_between_sampling": 4.240925611282741}, "num_healthy_workers": 1, "actor_manager_num_outstanding_async_reqs": 0, "num_remote_worker_restarts": 0}, "num_env_steps_sampled_lifetime": -1445000.0, "fault_tolerance": {"num_healthy_workers": 0, "num_remote_worker_restarts": 0}, "env_runner_group": {"actor_manager_num_outstanding_async_reqs": 0}, "done": false, "training_iteration": 8, "trial_id": "af017_00000", "date": "2025-08-11_17-16-18", "timestamp": 1754925378, "time_this_iter_s": 5.114429235458374, "time_total_s": 40.199747800827026, "pid": 67771, "hostname": "DESKTOP-3SK5A41", "node_ip": "192.168.40.242", "config": {"exploration_config": {}, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 6, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "env": "Umbrella", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": false, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 0, "create_local_env_runner": true, "num_envs_per_env_runner": 1, "gym_env_vectorize_mode": "SYNC", "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "episodes_to_numpy": true, "max_requests_in_flight_per_env_runner": 1, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "merge_env_runner_states": "training_only", "broadcast_env_runner_states": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "complete_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "sampler_perf_stats_ema_coef": null, "_is_online": true, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": "auto", "num_aggregator_actors_per_learner": 0, "max_requests_in_flight_per_aggregator_actor": 3, "local_gpu_idx": 0, "max_requests_in_flight_per_learner": 3, "gamma": 1, "lr": 1.02025592e-05, "grad_clip": 0.5, "grad_clip_by": "global_norm", "_train_batch_size_per_learner": 5000, "train_batch_size": 4000, "num_epochs": 3, "minibatch_size": 1000, "shuffle_batch_per_epoch": true, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "log_std_clip_param": 20.0, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "_disable_preprocessor_api": false, "_disable_action_flattening": false}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "_learner_class": null, "callbacks_on_algorithm_init": null, "callbacks_on_env_runners_recreated": null, "callbacks_on_offline_eval_runners_recreated": null, "callbacks_on_checkpoint_loaded": null, "callbacks_on_environment_created": null, "callbacks_on_episode_created": null, "callbacks_on_episode_start": null, "callbacks_on_episode_step": null, "callbacks_on_episode_end": null, "callbacks_on_evaluate_start": null, "callbacks_on_evaluate_end": null, "callbacks_on_evaluate_offline_start": null, "callbacks_on_evaluate_offline_end": null, "callbacks_on_sample_end": null, "callbacks_on_train_result": null, "explore": true, "enable_rl_module_and_learner": true, "enable_env_runner_and_connector_v2": true, "_prior_exploration_config": {"type": "StochasticSampling"}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x77ab39ecaac0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "offline_data_class": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_read_batch_size": null, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "materialize_data": false, "materialize_mapped_data": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "ignore_final_observation": false, "prelearner_class": null, "prelearner_buffer_class": null, "prelearner_buffer_kwargs": {}, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_remaining_data": false, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": 1, "evaluation_duration": 20, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_auto_duration_min_env_steps_per_sample": 100, "evaluation_auto_duration_max_env_steps_per_sample": 2000, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 1, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "offline_evaluation_interval": null, "num_offline_eval_runners": 0, "offline_loss_for_module_fn": null, "offline_evaluation_duration": 1, "offline_evaluation_parallel_to_training": false, "offline_evaluation_timeout_s": 120.0, "num_cpus_per_offline_eval_runner": 1, "num_gpus_per_offline_eval_runner": 0, "custom_resources_per_offline_eval_runner": {}, "restart_failed_offline_eval_runners": true, "ignore_offline_eval_runner_failures": false, "max_num_offline_eval_runner_restarts": 1000, "offline_eval_runner_restore_timeout_s": 1800.0, "max_requests_in_flight_per_offline_eval_runner": 1, "validate_offline_eval_runners_after_construction": true, "offline_eval_runner_health_probe_timeout_s": 30.0, "offline_eval_rl_module_inference_only": false, "broadcast_offline_eval_runner_states": false, "offline_eval_batch_size_per_runner": 256, "dataset_num_iters_per_eval_runner": 1, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "log_gradients": true, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 42, "restart_failed_env_runners": true, "ignore_env_runner_failures": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30.0, "env_runner_restore_timeout_s": 1800.0, "_model_config": {}, "_rl_module_spec": "RLModuleSpec(module_class=None, observation_space=None, action_space=None, inference_only=False, learner_only=False, model_config=DefaultModelConfig(fcnet_hiddens=[114, 56], fcnet_activation='tanh', fcnet_kernel_initializer=None, fcnet_kernel_initializer_kwargs=None, fcnet_bias_initializer=None, fcnet_bias_initializer_kwargs=None, conv_filters=None, conv_activation='relu', conv_kernel_initializer=None, conv_kernel_initializer_kwargs=None, conv_bias_initializer=None, conv_bias_initializer_kwargs=None, head_fcnet_hiddens=[], head_fcnet_activation='relu', head_fcnet_kernel_initializer=None, head_fcnet_kernel_initializer_kwargs=None, head_fcnet_bias_initializer=None, head_fcnet_bias_initializer_kwargs=None, free_log_std=False, log_std_clip_param=20.0, vf_share_layers=True, use_lstm=False, max_seq_len=20, lstm_cell_size=256, lstm_use_prev_action=False, lstm_use_prev_reward=False, lstm_kernel_initializer=None, lstm_kernel_initializer_kwargs=None, lstm_bias_initializer=None, lstm_bias_initializer_kwargs=None), catalog_class=None, load_state_path=None, model_config_dict=None)", "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "_validate_config": true, "_use_msgpack_checkpoints": false, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "env_task_fn": -1, "enable_connectors": -1, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.1483783801338, "kl_target": 0.0299561178854, "vf_loss_coeff": 0.8294931856016, "entropy_coeff": 0.0028379241987, "clip_param": 0.2023271755792, "vf_clip_param": 0.1015383331916, "entropy_coeff_schedule": null, "lr_schedule": null, "sgd_minibatch_size": -1, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9059303202574, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.callbacks.callbacks.RLlibCallback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 40.199747800827026, "iterations_since_restore": 8, "perf": {"cpu_util_percent": 12.428571428571429, "ram_util_percent": 74.3}}
{"timers": {"training_iteration": 4.325267151602313, "restore_env_runners": 1.5092825522316982e-05, "training_step": 4.324961616434199, "env_runner_sampling_timer": 3.8589092698745766, "learner_update_timer": 0.4624022544951088, "synch_weights": 0.0015226070846201432, "restore_eval_env_runners": 1.3302516691044394e-05, "evaluation_iteration": 0.7448694096783491, "synch_eval_env_connectors": 0.0004886419244221864, "synch_env_connectors": 8.330473868409417e-06}, "env_runners": {"env_to_module_sum_episodes_length_in": 27.16809333212661, "module_to_env_connector": {"timers": {"connectors": {"listify_data_for_vector_env": 3.1125892030564606e-05, "un_batch_to_individual_items": 1.4485113121836328e-05, "get_actions": 0.00016864500759490998, "tensor_to_numpy": 5.001152288761232e-05, "remove_single_ts_time_rank_from_batch": 1.4826561196199385e-06, "normalize_and_clip_actions": 2.279383722724488e-05}}, "connector_pipeline_timer": 0.000367121193776385}, "num_agent_steps_sampled": {"default_agent": 5000.0}, "env_to_module_sum_episodes_length_out": 27.16809333212661, "num_env_steps_sampled": 5000.0, "episode_duration_sec_mean": 0.037023522009985765, "env_step_timer": 4.336899201661478e-05, "episode_return_mean": 5.899999999999999, "sample": 0.03805867989049326, "env_to_module_connector": {"timers": {"connectors": {"add_time_dim_to_batch_and_zero_pad": 6.3528470747414705e-06, "numpy_to_tensor": 3.185196782993217e-05, "add_states_from_episodes_to_batch": 3.5117228411907166e-06, "add_observations_from_episodes_to_batch": 6.340964365790079e-06, "batch_individual_items": 1.8512825654613867e-05}}, "connector_pipeline_timer": 0.00012002592205103876}, "num_episodes": 100.0, "num_module_steps_sampled_lifetime": {"default_policy": -1687500.0}, "episode_return_max": 14.5, "num_env_steps_sampled_lifetime": -1687500.0, "episode_len_mean": 50.0, "num_agent_steps_sampled_lifetime": {"default_agent": -1687500.0}, "episode_len_max": 50, "env_reset_timer": 9.475845209617353e-05, "num_module_steps_sampled": {"default_policy": 5000.0}, "num_episodes_lifetime": -33750.0, "episode_return_min": -5.5, "time_between_sampling": 0.012986878751677887, "rlmodule_inference_timer": 0.00010214095443967395, "episode_len_min": 50, "weights_seq_no": 8.0, "module_episode_returns_mean": {"default_policy": 5.899999999999999}, "agent_episode_returns_mean": {"default_agent": 5.899999999999999}, "num_env_steps_sampled_lifetime_throughput": 1262.9353505294716}, "learners": {"__all_modules__": {"learner_connector": {"timers": {"connectors": {"add_columns_from_episodes_to_train_batch": 0.06873748356975629, "general_advantage_estimation": 0.01150220508331695, "add_observations_from_episodes_to_batch": 0.0007694605505480049, "add_time_dim_to_batch_and_zero_pad": 2.1755897847612485e-05, "add_states_from_episodes_to_batch": 5.6885407650170925e-06, "add_one_ts_to_episodes_and_truncate": 0.008516321105630748, "numpy_to_tensor": 0.0001638620219948875, "batch_individual_items": 0.19996779240913934}}, "connector_pipeline_timer": 0.28999806641258474}, "num_module_steps_trained": 16000, "num_non_trainable_parameters": 0, "num_module_steps_trained_lifetime": 144000, "learner_connector_sum_episodes_length_out": 5100.0, "learner_connector_sum_episodes_length_in": 5000.0, "num_trainable_parameters": 7067, "num_env_steps_trained_lifetime": 734400, "num_env_steps_trained": 81600, "num_env_steps_trained_lifetime_throughput": 974324.3234360432, "num_module_steps_trained_throughput": 191588.28246174415, "num_module_steps_trained_lifetime_throughput": 191468.47900189782}, "default_policy": {"num_module_steps_trained": 16000, "vf_explained_var": 0.009778022766113281, "num_module_steps_trained_lifetime": 144000, "module_train_batch_size_mean": 1000.0, "curr_kl_coeff": 0.00028980153729207814, "policy_loss": -0.050331372767686844, "mean_kl_loss": 5.523413619812345e-06, "vf_loss": 0.09614159166812897, "default_optimizer_learning_rate": 1.02025592e-05, "total_loss": 0.02745562233030796, "num_trainable_parameters": 7067, "gradients_default_optimizer_global_norm": 0.04733841121196747, "curr_entropy_coeff": 0.0028379241987, "vf_loss_unclipped": 13.496346473693848, "entropy": 0.6912857890129089, "weights_seq_no": 9.0, "diff_num_grad_updates_vs_sampler_policy": 1.0, "num_module_steps_trained_lifetime_throughput": 191832.64538495732}}, "num_training_step_calls_per_iteration": 1, "evaluation": {"env_runners": {"module_to_env_connector": {"timers": {"connectors": {"tensor_to_numpy": 4.531907497502185e-05, "get_actions": 0.00015539555315746307, "remove_single_ts_time_rank_from_batch": 1.3566542084434605e-06, "normalize_and_clip_actions": 2.2177122928888363e-05, "un_batch_to_individual_items": 1.5398632747219275e-05, "listify_data_for_vector_env": 3.103975516530662e-05}}, "connector_pipeline_timer": 0.00034332478883778534}, "env_reset_timer": 0.00024305719237785093, "env_to_module_connector": {"timers": {"connectors": {"add_observations_from_episodes_to_batch": 6.414621511062536e-06, "add_states_from_episodes_to_batch": 3.321619177365614e-06, "add_time_dim_to_batch_and_zero_pad": 6.018192755949781e-06, "batch_individual_items": 1.849199237631964e-05, "numpy_to_tensor": 2.8949588602901e-05}}, "connector_pipeline_timer": 0.00011319183234495497}, "num_episodes_lifetime": 180, "rlmodule_inference_timer": 9.493911043639672e-05, "num_module_steps_sampled": {"default_policy": 1000}, "agent_episode_returns_mean": {"default_agent": -0.5}, "num_env_steps_sampled_lifetime": 46000, "episode_len_max": 50, "num_module_steps_sampled_lifetime": {"default_policy": 9000}, "weights_seq_no": 9.0, "num_agent_steps_sampled_lifetime": {"default_agent": 9000}, "env_to_module_sum_episodes_length_in": 27.168093332126602, "env_to_module_sum_episodes_length_out": 27.168093332126602, "env_step_timer": 4.212806363154974e-05, "sample": 0.7326761348278326, "num_episodes": 20, "module_episode_returns_mean": {"default_policy": -0.5}, "episode_return_min": -16.5, "episode_len_min": 50, "num_env_steps_sampled": 1000, "episode_return_mean": -0.5, "episode_return_max": 17.5, "num_agent_steps_sampled": {"default_agent": 1000}, "episode_len_mean": 50.0, "episode_duration_sec_mean": 0.03531290503006858, "time_between_sampling": 4.240975467179915}, "num_healthy_workers": 1, "actor_manager_num_outstanding_async_reqs": 0, "num_remote_worker_restarts": 0}, "num_env_steps_sampled_lifetime": -1687500.0, "fault_tolerance": {"num_healthy_workers": 0, "num_remote_worker_restarts": 0}, "env_runner_group": {"actor_manager_num_outstanding_async_reqs": 0}, "done": false, "training_iteration": 9, "trial_id": "af017_00000", "date": "2025-08-11_17-16-23", "timestamp": 1754925383, "time_this_iter_s": 4.944740295410156, "time_total_s": 45.14448809623718, "pid": 67771, "hostname": "DESKTOP-3SK5A41", "node_ip": "192.168.40.242", "config": {"exploration_config": {}, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 6, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "env": "Umbrella", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": false, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 0, "create_local_env_runner": true, "num_envs_per_env_runner": 1, "gym_env_vectorize_mode": "SYNC", "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "episodes_to_numpy": true, "max_requests_in_flight_per_env_runner": 1, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "merge_env_runner_states": "training_only", "broadcast_env_runner_states": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "complete_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "sampler_perf_stats_ema_coef": null, "_is_online": true, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": "auto", "num_aggregator_actors_per_learner": 0, "max_requests_in_flight_per_aggregator_actor": 3, "local_gpu_idx": 0, "max_requests_in_flight_per_learner": 3, "gamma": 1, "lr": 1.02025592e-05, "grad_clip": 0.5, "grad_clip_by": "global_norm", "_train_batch_size_per_learner": 5000, "train_batch_size": 4000, "num_epochs": 3, "minibatch_size": 1000, "shuffle_batch_per_epoch": true, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "log_std_clip_param": 20.0, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "_disable_preprocessor_api": false, "_disable_action_flattening": false}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "_learner_class": null, "callbacks_on_algorithm_init": null, "callbacks_on_env_runners_recreated": null, "callbacks_on_offline_eval_runners_recreated": null, "callbacks_on_checkpoint_loaded": null, "callbacks_on_environment_created": null, "callbacks_on_episode_created": null, "callbacks_on_episode_start": null, "callbacks_on_episode_step": null, "callbacks_on_episode_end": null, "callbacks_on_evaluate_start": null, "callbacks_on_evaluate_end": null, "callbacks_on_evaluate_offline_start": null, "callbacks_on_evaluate_offline_end": null, "callbacks_on_sample_end": null, "callbacks_on_train_result": null, "explore": true, "enable_rl_module_and_learner": true, "enable_env_runner_and_connector_v2": true, "_prior_exploration_config": {"type": "StochasticSampling"}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x77ab39ecaac0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "offline_data_class": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_read_batch_size": null, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "materialize_data": false, "materialize_mapped_data": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "ignore_final_observation": false, "prelearner_class": null, "prelearner_buffer_class": null, "prelearner_buffer_kwargs": {}, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_remaining_data": false, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": 1, "evaluation_duration": 20, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_auto_duration_min_env_steps_per_sample": 100, "evaluation_auto_duration_max_env_steps_per_sample": 2000, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 1, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "offline_evaluation_interval": null, "num_offline_eval_runners": 0, "offline_loss_for_module_fn": null, "offline_evaluation_duration": 1, "offline_evaluation_parallel_to_training": false, "offline_evaluation_timeout_s": 120.0, "num_cpus_per_offline_eval_runner": 1, "num_gpus_per_offline_eval_runner": 0, "custom_resources_per_offline_eval_runner": {}, "restart_failed_offline_eval_runners": true, "ignore_offline_eval_runner_failures": false, "max_num_offline_eval_runner_restarts": 1000, "offline_eval_runner_restore_timeout_s": 1800.0, "max_requests_in_flight_per_offline_eval_runner": 1, "validate_offline_eval_runners_after_construction": true, "offline_eval_runner_health_probe_timeout_s": 30.0, "offline_eval_rl_module_inference_only": false, "broadcast_offline_eval_runner_states": false, "offline_eval_batch_size_per_runner": 256, "dataset_num_iters_per_eval_runner": 1, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "log_gradients": true, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 42, "restart_failed_env_runners": true, "ignore_env_runner_failures": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30.0, "env_runner_restore_timeout_s": 1800.0, "_model_config": {}, "_rl_module_spec": "RLModuleSpec(module_class=None, observation_space=None, action_space=None, inference_only=False, learner_only=False, model_config=DefaultModelConfig(fcnet_hiddens=[114, 56], fcnet_activation='tanh', fcnet_kernel_initializer=None, fcnet_kernel_initializer_kwargs=None, fcnet_bias_initializer=None, fcnet_bias_initializer_kwargs=None, conv_filters=None, conv_activation='relu', conv_kernel_initializer=None, conv_kernel_initializer_kwargs=None, conv_bias_initializer=None, conv_bias_initializer_kwargs=None, head_fcnet_hiddens=[], head_fcnet_activation='relu', head_fcnet_kernel_initializer=None, head_fcnet_kernel_initializer_kwargs=None, head_fcnet_bias_initializer=None, head_fcnet_bias_initializer_kwargs=None, free_log_std=False, log_std_clip_param=20.0, vf_share_layers=True, use_lstm=False, max_seq_len=20, lstm_cell_size=256, lstm_use_prev_action=False, lstm_use_prev_reward=False, lstm_kernel_initializer=None, lstm_kernel_initializer_kwargs=None, lstm_bias_initializer=None, lstm_bias_initializer_kwargs=None), catalog_class=None, load_state_path=None, model_config_dict=None)", "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "_validate_config": true, "_use_msgpack_checkpoints": false, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "env_task_fn": -1, "enable_connectors": -1, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.1483783801338, "kl_target": 0.0299561178854, "vf_loss_coeff": 0.8294931856016, "entropy_coeff": 0.0028379241987, "clip_param": 0.2023271755792, "vf_clip_param": 0.1015383331916, "entropy_coeff_schedule": null, "lr_schedule": null, "sgd_minibatch_size": -1, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9059303202574, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.callbacks.callbacks.RLlibCallback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 45.14448809623718, "iterations_since_restore": 9, "perf": {"cpu_util_percent": 12.471428571428573, "ram_util_percent": 74.3}}
{"timers": {"training_iteration": 4.3251179030862925, "restore_env_runners": 1.5063897268377407e-05, "training_step": 4.324811956269862, "env_runner_sampling_timer": 3.8597347851758372, "learner_update_timer": 0.4614264889501621, "synch_weights": 0.0015220990137761181, "restore_eval_env_runners": 1.3279491524993093e-05, "evaluation_iteration": 0.7449164335815658, "synch_eval_env_connectors": 0.0004877165051801285, "synch_env_connectors": 8.32016913079157e-06}, "env_runners": {"env_to_module_sum_episodes_length_in": 27.16809333212661, "module_to_env_connector": {"timers": {"connectors": {"listify_data_for_vector_env": 3.090431467357154e-05, "un_batch_to_individual_items": 1.4501951019990744e-05, "get_actions": 0.000167448851722519, "tensor_to_numpy": 4.980273942827961e-05, "remove_single_ts_time_rank_from_batch": 1.4700260519604183e-06, "normalize_and_clip_actions": 2.278607459556197e-05}}, "connector_pipeline_timer": 0.00036538445685416204}, "num_agent_steps_sampled": {"default_agent": 5000.0}, "env_to_module_sum_episodes_length_out": 27.16809333212661, "num_env_steps_sampled": 5000.0, "episode_duration_sec_mean": 0.03691156099001091, "env_step_timer": 4.3331948815143975e-05, "episode_return_mean": 4.5, "sample": 0.037993341051147114, "env_to_module_connector": {"timers": {"connectors": {"add_time_dim_to_batch_and_zero_pad": 6.354946065453094e-06, "numpy_to_tensor": 3.154233263643279e-05, "add_states_from_episodes_to_batch": 3.5272096009233853e-06, "add_observations_from_episodes_to_batch": 6.283130777094167e-06, "batch_individual_items": 1.8517449475260836e-05}}, "connector_pipeline_timer": 0.00011976386206165924}, "num_episodes": 100.0, "num_module_steps_sampled_lifetime": {"default_policy": -1930000.0}, "episode_return_max": 14.5, "num_env_steps_sampled_lifetime": -1930000.0, "episode_len_mean": 50.0, "num_agent_steps_sampled_lifetime": {"default_agent": -1930000.0}, "episode_len_max": 50, "env_reset_timer": 9.446098292357433e-05, "num_module_steps_sampled": {"default_policy": 5000.0}, "num_episodes_lifetime": -38600.0, "episode_return_min": -5.5, "time_between_sampling": 0.01219845851293826, "rlmodule_inference_timer": 0.00010173604170784852, "episode_len_min": 50, "weights_seq_no": 9.0, "module_episode_returns_mean": {"default_policy": 4.5}, "agent_episode_returns_mean": {"default_agent": 4.5}, "num_env_steps_sampled_lifetime_throughput": 1268.5461469652744}, "learners": {"__all_modules__": {"learner_connector": {"timers": {"connectors": {"add_columns_from_episodes_to_train_batch": 0.06871886173405865, "general_advantage_estimation": 0.011471934032487741, "add_observations_from_episodes_to_batch": 0.0007683769450414087, "add_time_dim_to_batch_and_zero_pad": 2.173433887000575e-05, "add_states_from_episodes_to_batch": 5.683655362237855e-06, "add_one_ts_to_episodes_and_truncate": 0.008511566894576404, "numpy_to_tensor": 0.00016389140177027256, "batch_individual_items": 0.19999914148504158}}, "connector_pipeline_timer": 0.2899746277484625}, "num_module_steps_trained": 16000, "num_non_trainable_parameters": 0, "num_module_steps_trained_lifetime": 160000, "learner_connector_sum_episodes_length_out": 5100.0, "learner_connector_sum_episodes_length_in": 5000.0, "num_trainable_parameters": 7067, "num_env_steps_trained_lifetime": 816000, "num_env_steps_trained": 81600, "num_env_steps_trained_lifetime_throughput": 974928.1906567495, "num_module_steps_trained_throughput": 191681.31733156866, "num_module_steps_trained_lifetime_throughput": 191565.9749141103}, "default_policy": {"num_module_steps_trained": 16000, "vf_explained_var": 0.011421263217926025, "num_module_steps_trained_lifetime": 160000, "module_train_batch_size_mean": 1000.0, "curr_kl_coeff": 0.00014490076864603907, "policy_loss": 0.01718299649655819, "mean_kl_loss": 1.6990952644846402e-07, "vf_loss": 0.09518104046583176, "default_optimizer_learning_rate": 1.02025592e-05, "total_loss": 0.09417348355054855, "num_trainable_parameters": 7067, "gradients_default_optimizer_global_norm": 0.095258928835392, "curr_entropy_coeff": 0.0028379241987, "vf_loss_unclipped": 11.43674373626709, "entropy": 0.6911888718605042, "weights_seq_no": 10.0, "diff_num_grad_updates_vs_sampler_policy": 1.0, "num_module_steps_trained_lifetime_throughput": 191909.3514298747}}, "num_training_step_calls_per_iteration": 1, "evaluation": {"env_runners": {"module_to_env_connector": {"timers": {"connectors": {"tensor_to_numpy": 4.5760494721952575e-05, "get_actions": 0.00015542742940207385, "remove_single_ts_time_rank_from_batch": 1.3426949888444214e-06, "normalize_and_clip_actions": 2.2175192513988556e-05, "un_batch_to_individual_items": 1.5407317213738363e-05, "listify_data_for_vector_env": 3.097873153420611e-05}}, "connector_pipeline_timer": 0.0003437872818462036}, "env_reset_timer": 0.00024183762046204257, "env_to_module_connector": {"timers": {"connectors": {"add_observations_from_episodes_to_batch": 6.48569040343719e-06, "add_states_from_episodes_to_batch": 3.327761541146151e-06, "add_time_dim_to_batch_and_zero_pad": 6.044421310058189e-06, "batch_individual_items": 1.880722284004416e-05, "numpy_to_tensor": 2.922726018983532e-05}}, "connector_pipeline_timer": 0.00011425278270615036}, "num_episodes_lifetime": 200, "rlmodule_inference_timer": 9.430795824203631e-05, "num_module_steps_sampled": {"default_policy": 1000}, "agent_episode_returns_mean": {"default_agent": -0.7}, "num_env_steps_sampled_lifetime": 51000, "episode_len_max": 50, "num_module_steps_sampled_lifetime": {"default_policy": 10000}, "weights_seq_no": 10.0, "num_agent_steps_sampled_lifetime": {"default_agent": 10000}, "env_to_module_sum_episodes_length_in": 27.168093332126602, "env_to_module_sum_episodes_length_out": 27.168093332126602, "env_step_timer": 4.213927538566661e-05, "sample": 0.7326967624695557, "num_episodes": 20, "module_episode_returns_mean": {"default_policy": -0.7}, "episode_return_min": -16.5, "episode_len_min": 50, "num_env_steps_sampled": 1000, "episode_return_mean": -0.7, "episode_return_max": 17.5, "num_agent_steps_sampled": {"default_agent": 1000}, "episode_len_mean": 50.0, "episode_duration_sec_mean": 0.035314473010075745, "time_between_sampling": 4.242206498508121}, "num_healthy_workers": 1, "actor_manager_num_outstanding_async_reqs": 0, "num_remote_worker_restarts": 0}, "num_env_steps_sampled_lifetime": -1930000.0, "fault_tolerance": {"num_healthy_workers": 0, "num_remote_worker_restarts": 0}, "env_runner_group": {"actor_manager_num_outstanding_async_reqs": 0}, "done": false, "training_iteration": 10, "trial_id": "af017_00000", "date": "2025-08-11_17-16-28", "timestamp": 1754925388, "time_this_iter_s": 5.059196710586548, "time_total_s": 50.20368480682373, "pid": 67771, "hostname": "DESKTOP-3SK5A41", "node_ip": "192.168.40.242", "config": {"exploration_config": {}, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 6, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "env": "Umbrella", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": false, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 0, "create_local_env_runner": true, "num_envs_per_env_runner": 1, "gym_env_vectorize_mode": "SYNC", "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "episodes_to_numpy": true, "max_requests_in_flight_per_env_runner": 1, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "merge_env_runner_states": "training_only", "broadcast_env_runner_states": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "complete_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "sampler_perf_stats_ema_coef": null, "_is_online": true, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": "auto", "num_aggregator_actors_per_learner": 0, "max_requests_in_flight_per_aggregator_actor": 3, "local_gpu_idx": 0, "max_requests_in_flight_per_learner": 3, "gamma": 1, "lr": 1.02025592e-05, "grad_clip": 0.5, "grad_clip_by": "global_norm", "_train_batch_size_per_learner": 5000, "train_batch_size": 4000, "num_epochs": 3, "minibatch_size": 1000, "shuffle_batch_per_epoch": true, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "log_std_clip_param": 20.0, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "_disable_preprocessor_api": false, "_disable_action_flattening": false}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "_learner_class": null, "callbacks_on_algorithm_init": null, "callbacks_on_env_runners_recreated": null, "callbacks_on_offline_eval_runners_recreated": null, "callbacks_on_checkpoint_loaded": null, "callbacks_on_environment_created": null, "callbacks_on_episode_created": null, "callbacks_on_episode_start": null, "callbacks_on_episode_step": null, "callbacks_on_episode_end": null, "callbacks_on_evaluate_start": null, "callbacks_on_evaluate_end": null, "callbacks_on_evaluate_offline_start": null, "callbacks_on_evaluate_offline_end": null, "callbacks_on_sample_end": null, "callbacks_on_train_result": null, "explore": true, "enable_rl_module_and_learner": true, "enable_env_runner_and_connector_v2": true, "_prior_exploration_config": {"type": "StochasticSampling"}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x77ab39ecaac0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "offline_data_class": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_read_batch_size": null, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "materialize_data": false, "materialize_mapped_data": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "ignore_final_observation": false, "prelearner_class": null, "prelearner_buffer_class": null, "prelearner_buffer_kwargs": {}, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_remaining_data": false, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": 1, "evaluation_duration": 20, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_auto_duration_min_env_steps_per_sample": 100, "evaluation_auto_duration_max_env_steps_per_sample": 2000, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 1, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "offline_evaluation_interval": null, "num_offline_eval_runners": 0, "offline_loss_for_module_fn": null, "offline_evaluation_duration": 1, "offline_evaluation_parallel_to_training": false, "offline_evaluation_timeout_s": 120.0, "num_cpus_per_offline_eval_runner": 1, "num_gpus_per_offline_eval_runner": 0, "custom_resources_per_offline_eval_runner": {}, "restart_failed_offline_eval_runners": true, "ignore_offline_eval_runner_failures": false, "max_num_offline_eval_runner_restarts": 1000, "offline_eval_runner_restore_timeout_s": 1800.0, "max_requests_in_flight_per_offline_eval_runner": 1, "validate_offline_eval_runners_after_construction": true, "offline_eval_runner_health_probe_timeout_s": 30.0, "offline_eval_rl_module_inference_only": false, "broadcast_offline_eval_runner_states": false, "offline_eval_batch_size_per_runner": 256, "dataset_num_iters_per_eval_runner": 1, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "log_gradients": true, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 42, "restart_failed_env_runners": true, "ignore_env_runner_failures": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30.0, "env_runner_restore_timeout_s": 1800.0, "_model_config": {}, "_rl_module_spec": "RLModuleSpec(module_class=None, observation_space=None, action_space=None, inference_only=False, learner_only=False, model_config=DefaultModelConfig(fcnet_hiddens=[114, 56], fcnet_activation='tanh', fcnet_kernel_initializer=None, fcnet_kernel_initializer_kwargs=None, fcnet_bias_initializer=None, fcnet_bias_initializer_kwargs=None, conv_filters=None, conv_activation='relu', conv_kernel_initializer=None, conv_kernel_initializer_kwargs=None, conv_bias_initializer=None, conv_bias_initializer_kwargs=None, head_fcnet_hiddens=[], head_fcnet_activation='relu', head_fcnet_kernel_initializer=None, head_fcnet_kernel_initializer_kwargs=None, head_fcnet_bias_initializer=None, head_fcnet_bias_initializer_kwargs=None, free_log_std=False, log_std_clip_param=20.0, vf_share_layers=True, use_lstm=False, max_seq_len=20, lstm_cell_size=256, lstm_use_prev_action=False, lstm_use_prev_reward=False, lstm_kernel_initializer=None, lstm_kernel_initializer_kwargs=None, lstm_bias_initializer=None, lstm_bias_initializer_kwargs=None), catalog_class=None, load_state_path=None, model_config_dict=None)", "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "_validate_config": true, "_use_msgpack_checkpoints": false, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "env_task_fn": -1, "enable_connectors": -1, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.1483783801338, "kl_target": 0.0299561178854, "vf_loss_coeff": 0.8294931856016, "entropy_coeff": 0.0028379241987, "clip_param": 0.2023271755792, "vf_clip_param": 0.1015383331916, "entropy_coeff_schedule": null, "lr_schedule": null, "sgd_minibatch_size": -1, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9059303202574, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.callbacks.callbacks.RLlibCallback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 50.20368480682373, "iterations_since_restore": 10, "perf": {"cpu_util_percent": 12.028571428571428, "ram_util_percent": 74.3}}
{"timers": {"training_iteration": 4.323608557045431, "restore_env_runners": 1.503325829084319e-05, "training_step": 4.323301050697164, "env_runner_sampling_timer": 3.860588630314079, "learner_update_timer": 0.459061265060665, "synch_weights": 0.0015205200236418858, "restore_eval_env_runners": 1.3247696614831442e-05, "evaluation_iteration": 0.7449099442357568, "synch_eval_env_connectors": 0.0004866593401300513, "synch_env_connectors": 8.303967440337676e-06}, "env_runners": {"env_to_module_sum_episodes_length_in": 27.16809333212661, "module_to_env_connector": {"timers": {"connectors": {"listify_data_for_vector_env": 3.0973324642854554e-05, "un_batch_to_individual_items": 1.4529781685557648e-05, "get_actions": 0.00016788187224178248, "tensor_to_numpy": 4.9810857510101425e-05, "remove_single_ts_time_rank_from_batch": 1.4824806124876074e-06, "normalize_and_clip_actions": 2.2803682654675672e-05}}, "connector_pipeline_timer": 0.0003658972806416711}, "num_agent_steps_sampled": {"default_agent": 5000.0}, "env_to_module_sum_episodes_length_out": 27.16809333212661, "num_env_steps_sampled": 5000.0, "episode_duration_sec_mean": 0.0369225989899951, "env_step_timer": 4.336081992605417e-05, "episode_return_mean": 5.299999999999998, "sample": 0.037964968784602, "env_to_module_connector": {"timers": {"connectors": {"add_time_dim_to_batch_and_zero_pad": 6.303111476649218e-06, "numpy_to_tensor": 3.169903283389555e-05, "add_states_from_episodes_to_batch": 3.495462016054952e-06, "add_observations_from_episodes_to_batch": 6.304845128440555e-06, "batch_individual_items": 1.84372965508376e-05}}, "connector_pipeline_timer": 0.00011957734336592662}, "num_episodes": 100.0, "num_module_steps_sampled_lifetime": {"default_policy": -2172500.0}, "episode_return_max": 14.5, "num_env_steps_sampled_lifetime": -2172500.0, "episode_len_mean": 50.0, "num_agent_steps_sampled_lifetime": {"default_agent": -2172500.0}, "episode_len_max": 50, "env_reset_timer": 9.418254558810367e-05, "num_module_steps_sampled": {"default_policy": 5000.0}, "num_episodes_lifetime": -43450.0, "episode_return_min": -5.5, "time_between_sampling": 0.01272638511170356, "rlmodule_inference_timer": 0.00010191873595134458, "episode_len_min": 50, "weights_seq_no": 10.0, "module_episode_returns_mean": {"default_policy": 5.299999999999998}, "agent_episode_returns_mean": {"default_agent": 5.299999999999998}, "num_env_steps_sampled_lifetime_throughput": 1267.4375740192231}, "learners": {"__all_modules__": {"learner_connector": {"timers": {"connectors": {"add_columns_from_episodes_to_train_batch": 0.0686996201167198, "general_advantage_estimation": 0.011445381692157293, "add_observations_from_episodes_to_batch": 0.0007683681755881017, "add_time_dim_to_batch_and_zero_pad": 2.1721995477945946e-05, "add_states_from_episodes_to_batch": 5.6788188134864105e-06, "add_one_ts_to_episodes_and_truncate": 0.008508596225636407, "numpy_to_tensor": 0.0001639164877538256, "batch_individual_items": 0.19857961607018332}}, "connector_pipeline_timer": 0.28850619547097917}, "num_module_steps_trained": 16000, "num_non_trainable_parameters": 0, "num_module_steps_trained_lifetime": 176000, "learner_connector_sum_episodes_length_out": 5100.0, "learner_connector_sum_episodes_length_in": 5000.0, "num_trainable_parameters": 7067, "num_env_steps_trained_lifetime": 897600, "num_env_steps_trained": 81600, "num_env_steps_trained_lifetime_throughput": 975842.4531615924, "num_module_steps_trained_throughput": 191839.07058069052, "num_module_steps_trained_lifetime_throughput": 191727.04093339317}, "default_policy": {"num_module_steps_trained": 16000, "vf_explained_var": 0.010677039623260498, "num_module_steps_trained_lifetime": 176000, "module_train_batch_size_mean": 1000.0, "curr_kl_coeff": 7.245038432301953e-05, "policy_loss": -0.05075990781188011, "mean_kl_loss": 1.979840362764662e-06, "vf_loss": 0.09599918127059937, "default_optimizer_learning_rate": 1.02025592e-05, "total_loss": 0.026909098029136658, "num_trainable_parameters": 7067, "gradients_default_optimizer_global_norm": 0.039759453386068344, "curr_entropy_coeff": 0.0028379241987, "vf_loss_unclipped": 11.428617477416992, "entropy": 0.6912344694137573, "weights_seq_no": 11.0, "diff_num_grad_updates_vs_sampler_policy": 1.0, "num_module_steps_trained_lifetime_throughput": 192049.70382640674}}, "num_training_step_calls_per_iteration": 1, "evaluation": {"env_runners": {"module_to_env_connector": {"timers": {"connectors": {"tensor_to_numpy": 4.521938128332439e-05, "get_actions": 0.00015469741428483102, "remove_single_ts_time_rank_from_batch": 1.352018432384847e-06, "normalize_and_clip_actions": 2.199710513594209e-05, "un_batch_to_individual_items": 1.550313149355334e-05, "listify_data_for_vector_env": 3.0182509444103012e-05}}, "connector_pipeline_timer": 0.0003409668089491493}, "env_reset_timer": 0.00024065424425714625, "env_to_module_connector": {"timers": {"connectors": {"add_observations_from_episodes_to_batch": 6.425966967071201e-06, "add_states_from_episodes_to_batch": 3.5039530116951313e-06, "add_time_dim_to_batch_and_zero_pad": 6.196369768293209e-06, "batch_individual_items": 1.864258503140751e-05, "numpy_to_tensor": 2.9315907533025285e-05}}, "connector_pipeline_timer": 0.00011439233938888897}, "num_episodes_lifetime": 220, "rlmodule_inference_timer": 9.567582535927418e-05, "num_module_steps_sampled": {"default_policy": 1000}, "agent_episode_returns_mean": {"default_agent": -0.1}, "num_env_steps_sampled_lifetime": 56000, "episode_len_max": 50, "num_module_steps_sampled_lifetime": {"default_policy": 11000}, "weights_seq_no": 11.0, "num_agent_steps_sampled_lifetime": {"default_agent": 11000}, "env_to_module_sum_episodes_length_in": 27.168093332126602, "env_to_module_sum_episodes_length_out": 27.168093332126602, "env_step_timer": 4.227404524519849e-05, "sample": 0.7327277078248566, "num_episodes": 20, "module_episode_returns_mean": {"default_policy": -0.1}, "episode_return_min": -16.5, "episode_len_min": 50, "num_env_steps_sampled": 1000, "episode_return_mean": -0.1, "episode_return_max": 17.5, "num_agent_steps_sampled": {"default_agent": 1000}, "episode_len_mean": 50.0, "episode_duration_sec_mean": 0.03534217299006741, "time_between_sampling": 4.242087909513033}, "num_healthy_workers": 1, "actor_manager_num_outstanding_async_reqs": 0, "num_remote_worker_restarts": 0}, "num_env_steps_sampled_lifetime": -2172500.0, "fault_tolerance": {"num_healthy_workers": 0, "num_remote_worker_restarts": 0}, "env_runner_group": {"actor_manager_num_outstanding_async_reqs": 0}, "done": false, "training_iteration": 11, "trial_id": "af017_00000", "date": "2025-08-11_17-16-33", "timestamp": 1754925393, "time_this_iter_s": 4.926477670669556, "time_total_s": 55.130162477493286, "pid": 67771, "hostname": "DESKTOP-3SK5A41", "node_ip": "192.168.40.242", "config": {"exploration_config": {}, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 6, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "env": "Umbrella", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": false, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 0, "create_local_env_runner": true, "num_envs_per_env_runner": 1, "gym_env_vectorize_mode": "SYNC", "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "episodes_to_numpy": true, "max_requests_in_flight_per_env_runner": 1, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "merge_env_runner_states": "training_only", "broadcast_env_runner_states": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "complete_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "sampler_perf_stats_ema_coef": null, "_is_online": true, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": "auto", "num_aggregator_actors_per_learner": 0, "max_requests_in_flight_per_aggregator_actor": 3, "local_gpu_idx": 0, "max_requests_in_flight_per_learner": 3, "gamma": 1, "lr": 1.02025592e-05, "grad_clip": 0.5, "grad_clip_by": "global_norm", "_train_batch_size_per_learner": 5000, "train_batch_size": 4000, "num_epochs": 3, "minibatch_size": 1000, "shuffle_batch_per_epoch": true, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "log_std_clip_param": 20.0, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "_disable_preprocessor_api": false, "_disable_action_flattening": false}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "_learner_class": null, "callbacks_on_algorithm_init": null, "callbacks_on_env_runners_recreated": null, "callbacks_on_offline_eval_runners_recreated": null, "callbacks_on_checkpoint_loaded": null, "callbacks_on_environment_created": null, "callbacks_on_episode_created": null, "callbacks_on_episode_start": null, "callbacks_on_episode_step": null, "callbacks_on_episode_end": null, "callbacks_on_evaluate_start": null, "callbacks_on_evaluate_end": null, "callbacks_on_evaluate_offline_start": null, "callbacks_on_evaluate_offline_end": null, "callbacks_on_sample_end": null, "callbacks_on_train_result": null, "explore": true, "enable_rl_module_and_learner": true, "enable_env_runner_and_connector_v2": true, "_prior_exploration_config": {"type": "StochasticSampling"}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x77ab39ecaac0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "offline_data_class": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_read_batch_size": null, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "materialize_data": false, "materialize_mapped_data": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "ignore_final_observation": false, "prelearner_class": null, "prelearner_buffer_class": null, "prelearner_buffer_kwargs": {}, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_remaining_data": false, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": 1, "evaluation_duration": 20, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_auto_duration_min_env_steps_per_sample": 100, "evaluation_auto_duration_max_env_steps_per_sample": 2000, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 1, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "offline_evaluation_interval": null, "num_offline_eval_runners": 0, "offline_loss_for_module_fn": null, "offline_evaluation_duration": 1, "offline_evaluation_parallel_to_training": false, "offline_evaluation_timeout_s": 120.0, "num_cpus_per_offline_eval_runner": 1, "num_gpus_per_offline_eval_runner": 0, "custom_resources_per_offline_eval_runner": {}, "restart_failed_offline_eval_runners": true, "ignore_offline_eval_runner_failures": false, "max_num_offline_eval_runner_restarts": 1000, "offline_eval_runner_restore_timeout_s": 1800.0, "max_requests_in_flight_per_offline_eval_runner": 1, "validate_offline_eval_runners_after_construction": true, "offline_eval_runner_health_probe_timeout_s": 30.0, "offline_eval_rl_module_inference_only": false, "broadcast_offline_eval_runner_states": false, "offline_eval_batch_size_per_runner": 256, "dataset_num_iters_per_eval_runner": 1, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "log_gradients": true, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 42, "restart_failed_env_runners": true, "ignore_env_runner_failures": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30.0, "env_runner_restore_timeout_s": 1800.0, "_model_config": {}, "_rl_module_spec": "RLModuleSpec(module_class=None, observation_space=None, action_space=None, inference_only=False, learner_only=False, model_config=DefaultModelConfig(fcnet_hiddens=[114, 56], fcnet_activation='tanh', fcnet_kernel_initializer=None, fcnet_kernel_initializer_kwargs=None, fcnet_bias_initializer=None, fcnet_bias_initializer_kwargs=None, conv_filters=None, conv_activation='relu', conv_kernel_initializer=None, conv_kernel_initializer_kwargs=None, conv_bias_initializer=None, conv_bias_initializer_kwargs=None, head_fcnet_hiddens=[], head_fcnet_activation='relu', head_fcnet_kernel_initializer=None, head_fcnet_kernel_initializer_kwargs=None, head_fcnet_bias_initializer=None, head_fcnet_bias_initializer_kwargs=None, free_log_std=False, log_std_clip_param=20.0, vf_share_layers=True, use_lstm=False, max_seq_len=20, lstm_cell_size=256, lstm_use_prev_action=False, lstm_use_prev_reward=False, lstm_kernel_initializer=None, lstm_kernel_initializer_kwargs=None, lstm_bias_initializer=None, lstm_bias_initializer_kwargs=None), catalog_class=None, load_state_path=None, model_config_dict=None)", "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "_validate_config": true, "_use_msgpack_checkpoints": false, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "env_task_fn": -1, "enable_connectors": -1, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.1483783801338, "kl_target": 0.0299561178854, "vf_loss_coeff": 0.8294931856016, "entropy_coeff": 0.0028379241987, "clip_param": 0.2023271755792, "vf_clip_param": 0.1015383331916, "entropy_coeff_schedule": null, "lr_schedule": null, "sgd_minibatch_size": -1, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9059303202574, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.callbacks.callbacks.RLlibCallback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 55.130162477493286, "iterations_since_restore": 11, "perf": {"cpu_util_percent": 12.725, "ram_util_percent": 74.3}}
{"timers": {"training_iteration": 4.32350210622498, "restore_env_runners": 1.4997925710486582e-05, "training_step": 4.3231935669401915, "env_runner_sampling_timer": 3.861250613790935, "learner_update_timer": 0.45829154838006064, "synch_weights": 0.0015184698234023807, "restore_eval_env_runners": 1.3230219651234952e-05, "evaluation_iteration": 0.7449199227734011, "synch_eval_env_connectors": 0.0004870267467289513, "synch_env_connectors": 8.291927760866508e-06}, "env_runners": {"env_to_module_sum_episodes_length_in": 27.16809333212661, "module_to_env_connector": {"timers": {"connectors": {"listify_data_for_vector_env": 3.070922481299372e-05, "un_batch_to_individual_items": 1.4456048103000362e-05, "get_actions": 0.00016700608226590362, "tensor_to_numpy": 4.979146004561883e-05, "remove_single_ts_time_rank_from_batch": 1.4697627257110144e-06, "normalize_and_clip_actions": 2.274428085947283e-05}}, "connector_pipeline_timer": 0.00036426013834685365}, "num_agent_steps_sampled": {"default_agent": 5000.0}, "env_to_module_sum_episodes_length_out": 27.16809333212661, "num_env_steps_sampled": 5000.0, "episode_duration_sec_mean": 0.03677383577998626, "env_step_timer": 4.317520114778635e-05, "episode_return_mean": 3.3, "sample": 0.0379303485348822, "env_to_module_connector": {"timers": {"connectors": {"add_time_dim_to_batch_and_zero_pad": 6.303272339687305e-06, "numpy_to_tensor": 3.140140800030775e-05, "add_states_from_episodes_to_batch": 3.5033078617223294e-06, "add_observations_from_episodes_to_batch": 6.309359358097932e-06, "batch_individual_items": 1.8469657321952666e-05}}, "connector_pipeline_timer": 0.00011932998837928163}, "num_episodes": 100.0, "num_module_steps_sampled_lifetime": {"default_policy": -2415000.0}, "episode_return_max": 14.5, "num_env_steps_sampled_lifetime": -2415000.0, "episode_len_mean": 50.0, "num_agent_steps_sampled_lifetime": {"default_agent": -2415000.0}, "episode_len_max": 50, "env_reset_timer": 9.427197143639453e-05, "num_module_steps_sampled": {"default_policy": 5000.0}, "num_episodes_lifetime": -48300.0, "episode_return_min": -5.5, "time_between_sampling": 0.01206330475363296, "rlmodule_inference_timer": 0.00010137353256175174, "episode_len_min": 50, "weights_seq_no": 11.0, "module_episode_returns_mean": {"default_policy": 3.3}, "agent_episode_returns_mean": {"default_agent": 3.3}, "num_env_steps_sampled_lifetime_throughput": 1270.713988888768}, "learners": {"__all_modules__": {"learner_connector": {"timers": {"connectors": {"add_columns_from_episodes_to_train_batch": 0.06868402090555369, "general_advantage_estimation": 0.01141465587523533, "add_observations_from_episodes_to_batch": 0.0007677384938300999, "add_time_dim_to_batch_and_zero_pad": 2.1695775522343197e-05, "add_states_from_episodes_to_batch": 5.673030622607986e-06, "add_one_ts_to_episodes_and_truncate": 0.008504528263380811, "numpy_to_tensor": 0.00016427332287715965, "batch_individual_items": 0.19862681589947515}}, "connector_pipeline_timer": 0.2885025994962685}, "num_module_steps_trained": 16000, "num_non_trainable_parameters": 0, "num_module_steps_trained_lifetime": 192000, "learner_connector_sum_episodes_length_out": 5100.0, "learner_connector_sum_episodes_length_in": 5000.0, "num_trainable_parameters": 7067, "num_env_steps_trained_lifetime": 979200, "num_env_steps_trained": 81600, "num_env_steps_trained_lifetime_throughput": 972778.068577645, "num_module_steps_trained_throughput": 191217.7128526347, "num_module_steps_trained_lifetime_throughput": 191109.65738889057}, "default_policy": {"num_module_steps_trained": 16000, "vf_explained_var": 0.011142611503601074, "num_module_steps_trained_lifetime": 192000, "module_train_batch_size_mean": 1000.0, "curr_kl_coeff": 3.622519216150977e-05, "policy_loss": -0.042049914598464966, "mean_kl_loss": 5.543780048355984e-07, "vf_loss": 0.09315762668848038, "default_optimizer_learning_rate": 1.02025592e-05, "total_loss": 0.033262528479099274, "num_trainable_parameters": 7067, "gradients_default_optimizer_global_norm": 0.052368730306625366, "curr_entropy_coeff": 0.0028379241987, "vf_loss_unclipped": 11.99958610534668, "entropy": 0.6910651922225952, "weights_seq_no": 12.0, "diff_num_grad_updates_vs_sampler_policy": 1.0, "num_module_steps_trained_lifetime_throughput": 191413.11243673813}}, "num_training_step_calls_per_iteration": 1, "evaluation": {"env_runners": {"module_to_env_connector": {"timers": {"connectors": {"tensor_to_numpy": 4.528878440848397e-05, "get_actions": 0.00015614787058450933, "remove_single_ts_time_rank_from_batch": 1.36005351785498e-06, "normalize_and_clip_actions": 2.2306548337429322e-05, "un_batch_to_individual_items": 1.5919069739046316e-05, "listify_data_for_vector_env": 3.0426389821894965e-05}}, "connector_pipeline_timer": 0.00034475304083354596}, "env_reset_timer": 0.0002395477018090189, "env_to_module_connector": {"timers": {"connectors": {"add_observations_from_episodes_to_batch": 6.556144927813213e-06, "add_states_from_episodes_to_batch": 3.392877517415529e-06, "add_time_dim_to_batch_and_zero_pad": 6.023640023934599e-06, "batch_individual_items": 1.8819876829675335e-05, "numpy_to_tensor": 2.897102608841021e-05}}, "connector_pipeline_timer": 0.00011378360493403424}, "num_episodes_lifetime": 240, "rlmodule_inference_timer": 9.537908085472062e-05, "num_module_steps_sampled": {"default_policy": 1000}, "agent_episode_returns_mean": {"default_agent": 0.5}, "num_env_steps_sampled_lifetime": 61000, "episode_len_max": 50, "num_module_steps_sampled_lifetime": {"default_policy": 12000}, "weights_seq_no": 12.0, "num_agent_steps_sampled_lifetime": {"default_agent": 12000}, "env_to_module_sum_episodes_length_in": 27.168093332126602, "env_to_module_sum_episodes_length_out": 27.168093332126602, "env_step_timer": 4.244244514929265e-05, "sample": 0.7327425137066117, "num_episodes": 20, "module_episode_returns_mean": {"default_policy": 0.5}, "episode_return_min": -16.5, "episode_len_min": 50, "num_env_steps_sampled": 1000, "episode_return_mean": 0.5, "episode_return_max": 17.5, "num_agent_steps_sampled": {"default_agent": 1000}, "episode_len_mean": 50.0, "episode_duration_sec_mean": 0.03536250694004593, "time_between_sampling": 4.243350616167907}, "num_healthy_workers": 1, "actor_manager_num_outstanding_async_reqs": 0, "num_remote_worker_restarts": 0}, "num_env_steps_sampled_lifetime": -2415000.0, "fault_tolerance": {"num_healthy_workers": 0, "num_remote_worker_restarts": 0}, "env_runner_group": {"actor_manager_num_outstanding_async_reqs": 0}, "done": false, "training_iteration": 12, "trial_id": "af017_00000", "date": "2025-08-11_17-16-38", "timestamp": 1754925398, "time_this_iter_s": 5.062032222747803, "time_total_s": 60.19219470024109, "pid": 67771, "hostname": "DESKTOP-3SK5A41", "node_ip": "192.168.40.242", "config": {"exploration_config": {}, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 6, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "env": "Umbrella", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": false, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 0, "create_local_env_runner": true, "num_envs_per_env_runner": 1, "gym_env_vectorize_mode": "SYNC", "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "episodes_to_numpy": true, "max_requests_in_flight_per_env_runner": 1, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "merge_env_runner_states": "training_only", "broadcast_env_runner_states": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "complete_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "sampler_perf_stats_ema_coef": null, "_is_online": true, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": "auto", "num_aggregator_actors_per_learner": 0, "max_requests_in_flight_per_aggregator_actor": 3, "local_gpu_idx": 0, "max_requests_in_flight_per_learner": 3, "gamma": 1, "lr": 1.02025592e-05, "grad_clip": 0.5, "grad_clip_by": "global_norm", "_train_batch_size_per_learner": 5000, "train_batch_size": 4000, "num_epochs": 3, "minibatch_size": 1000, "shuffle_batch_per_epoch": true, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "log_std_clip_param": 20.0, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "_disable_preprocessor_api": false, "_disable_action_flattening": false}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "_learner_class": null, "callbacks_on_algorithm_init": null, "callbacks_on_env_runners_recreated": null, "callbacks_on_offline_eval_runners_recreated": null, "callbacks_on_checkpoint_loaded": null, "callbacks_on_environment_created": null, "callbacks_on_episode_created": null, "callbacks_on_episode_start": null, "callbacks_on_episode_step": null, "callbacks_on_episode_end": null, "callbacks_on_evaluate_start": null, "callbacks_on_evaluate_end": null, "callbacks_on_evaluate_offline_start": null, "callbacks_on_evaluate_offline_end": null, "callbacks_on_sample_end": null, "callbacks_on_train_result": null, "explore": true, "enable_rl_module_and_learner": true, "enable_env_runner_and_connector_v2": true, "_prior_exploration_config": {"type": "StochasticSampling"}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x77ab39ecaac0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "offline_data_class": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_read_batch_size": null, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "materialize_data": false, "materialize_mapped_data": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "ignore_final_observation": false, "prelearner_class": null, "prelearner_buffer_class": null, "prelearner_buffer_kwargs": {}, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_remaining_data": false, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": 1, "evaluation_duration": 20, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_auto_duration_min_env_steps_per_sample": 100, "evaluation_auto_duration_max_env_steps_per_sample": 2000, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 1, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "offline_evaluation_interval": null, "num_offline_eval_runners": 0, "offline_loss_for_module_fn": null, "offline_evaluation_duration": 1, "offline_evaluation_parallel_to_training": false, "offline_evaluation_timeout_s": 120.0, "num_cpus_per_offline_eval_runner": 1, "num_gpus_per_offline_eval_runner": 0, "custom_resources_per_offline_eval_runner": {}, "restart_failed_offline_eval_runners": true, "ignore_offline_eval_runner_failures": false, "max_num_offline_eval_runner_restarts": 1000, "offline_eval_runner_restore_timeout_s": 1800.0, "max_requests_in_flight_per_offline_eval_runner": 1, "validate_offline_eval_runners_after_construction": true, "offline_eval_runner_health_probe_timeout_s": 30.0, "offline_eval_rl_module_inference_only": false, "broadcast_offline_eval_runner_states": false, "offline_eval_batch_size_per_runner": 256, "dataset_num_iters_per_eval_runner": 1, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "log_gradients": true, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 42, "restart_failed_env_runners": true, "ignore_env_runner_failures": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30.0, "env_runner_restore_timeout_s": 1800.0, "_model_config": {}, "_rl_module_spec": "RLModuleSpec(module_class=None, observation_space=None, action_space=None, inference_only=False, learner_only=False, model_config=DefaultModelConfig(fcnet_hiddens=[114, 56], fcnet_activation='tanh', fcnet_kernel_initializer=None, fcnet_kernel_initializer_kwargs=None, fcnet_bias_initializer=None, fcnet_bias_initializer_kwargs=None, conv_filters=None, conv_activation='relu', conv_kernel_initializer=None, conv_kernel_initializer_kwargs=None, conv_bias_initializer=None, conv_bias_initializer_kwargs=None, head_fcnet_hiddens=[], head_fcnet_activation='relu', head_fcnet_kernel_initializer=None, head_fcnet_kernel_initializer_kwargs=None, head_fcnet_bias_initializer=None, head_fcnet_bias_initializer_kwargs=None, free_log_std=False, log_std_clip_param=20.0, vf_share_layers=True, use_lstm=False, max_seq_len=20, lstm_cell_size=256, lstm_use_prev_action=False, lstm_use_prev_reward=False, lstm_kernel_initializer=None, lstm_kernel_initializer_kwargs=None, lstm_bias_initializer=None, lstm_bias_initializer_kwargs=None), catalog_class=None, load_state_path=None, model_config_dict=None)", "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "_validate_config": true, "_use_msgpack_checkpoints": false, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "env_task_fn": -1, "enable_connectors": -1, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.1483783801338, "kl_target": 0.0299561178854, "vf_loss_coeff": 0.8294931856016, "entropy_coeff": 0.0028379241987, "clip_param": 0.2023271755792, "vf_clip_param": 0.1015383331916, "entropy_coeff_schedule": null, "lr_schedule": null, "sgd_minibatch_size": -1, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9059303202574, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.callbacks.callbacks.RLlibCallback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 60.19219470024109, "iterations_since_restore": 12, "perf": {"cpu_util_percent": 12.62857142857143, "ram_util_percent": 74.3}}
{"timers": {"training_iteration": 4.322118712002737, "restore_env_runners": 1.4968946447050817e-05, "training_step": 4.321809786110789, "env_runner_sampling_timer": 3.862016423493029, "learner_update_timer": 0.4561402438962618, "synch_weights": 0.0015198361251671558, "restore_eval_env_runners": 1.3208917454101293e-05, "evaluation_iteration": 0.7449111985056706, "synch_eval_env_connectors": 0.0004872744792607909, "synch_env_connectors": 8.27700849172636e-06}, "env_runners": {"env_to_module_sum_episodes_length_in": 27.16809333212661, "module_to_env_connector": {"timers": {"connectors": {"listify_data_for_vector_env": 3.102508756095595e-05, "un_batch_to_individual_items": 1.4480703325623992e-05, "get_actions": 0.00016763456694024405, "tensor_to_numpy": 4.977583082295072e-05, "remove_single_ts_time_rank_from_batch": 1.471629500883121e-06, "normalize_and_clip_actions": 2.285027065853013e-05}}, "connector_pipeline_timer": 0.0003655135759271779}, "num_agent_steps_sampled": {"default_agent": 5000.0}, "env_to_module_sum_episodes_length_out": 27.16809333212661, "num_env_steps_sampled": 5000.0, "episode_duration_sec_mean": 0.036861322839968125, "env_step_timer": 4.3172147353999526e-05, "episode_return_mean": 3.3, "sample": 0.0378762501249592, "env_to_module_connector": {"timers": {"connectors": {"add_time_dim_to_batch_and_zero_pad": 6.342125186885296e-06, "numpy_to_tensor": 3.1544045009169475e-05, "add_states_from_episodes_to_batch": 3.5320023853265633e-06, "add_observations_from_episodes_to_batch": 6.3403495845398645e-06, "batch_individual_items": 1.8485839128719994e-05}}, "connector_pipeline_timer": 0.00011938572811319828}, "num_episodes": 100.0, "num_module_steps_sampled_lifetime": {"default_policy": -2657500.0}, "episode_return_max": 14.5, "num_env_steps_sampled_lifetime": -2657500.0, "episode_len_mean": 50.0, "num_agent_steps_sampled_lifetime": {"default_agent": -2657500.0}, "episode_len_max": 50, "env_reset_timer": 9.306921911386419e-05, "num_module_steps_sampled": {"default_policy": 5000.0}, "num_episodes_lifetime": -53150.0, "episode_return_min": -5.5, "time_between_sampling": 0.012794287263669385, "rlmodule_inference_timer": 0.0001016594012573366, "episode_len_min": 50, "weights_seq_no": 12.0, "module_episode_returns_mean": {"default_policy": 3.3}, "agent_episode_returns_mean": {"default_agent": 3.3}, "num_env_steps_sampled_lifetime_throughput": 1270.8071608045977}, "learners": {"__all_modules__": {"learner_connector": {"timers": {"connectors": {"add_columns_from_episodes_to_train_batch": 0.06866695169649165, "general_advantage_estimation": 0.01141012931648588, "add_observations_from_episodes_to_batch": 0.0007672851088926594, "add_time_dim_to_batch_and_zero_pad": 2.168481777137451e-05, "add_states_from_episodes_to_batch": 5.668300312157892e-06, "add_one_ts_to_episodes_and_truncate": 0.008501005980755023, "numpy_to_tensor": 0.0001648235896486493, "batch_individual_items": 0.19722602874047865}}, "connector_pipeline_timer": 0.2870779635013078}, "num_module_steps_trained": 16000, "num_non_trainable_parameters": 0, "num_module_steps_trained_lifetime": 208000, "learner_connector_sum_episodes_length_out": 5100.0, "learner_connector_sum_episodes_length_in": 5000.0, "num_trainable_parameters": 7067, "num_env_steps_trained_lifetime": 1060800, "num_env_steps_trained": 81600, "num_env_steps_trained_lifetime_throughput": 967776.5935872102, "num_module_steps_trained_throughput": 190216.46912190982, "num_module_steps_trained_lifetime_throughput": 190111.5907806301}, "default_policy": {"num_module_steps_trained": 16000, "vf_explained_var": 0.011754453182220459, "num_module_steps_trained_lifetime": 208000, "module_train_batch_size_mean": 1000.0, "curr_kl_coeff": 1.8112596080754884e-05, "policy_loss": -0.03302968665957451, "mean_kl_loss": 1.8444335410094936e-06, "vf_loss": 0.09524382650852203, "default_optimizer_learning_rate": 1.02025592e-05, "total_loss": 0.0440128892660141, "num_trainable_parameters": 7067, "gradients_default_optimizer_global_norm": 0.045101799070835114, "curr_entropy_coeff": 0.0028379241987, "vf_loss_unclipped": 11.525084495544434, "entropy": 0.6911889910697937, "weights_seq_no": 13.0, "diff_num_grad_updates_vs_sampler_policy": 1.0, "num_module_steps_trained_lifetime_throughput": 190397.20496147574}}, "num_training_step_calls_per_iteration": 1, "evaluation": {"env_runners": {"module_to_env_connector": {"timers": {"connectors": {"tensor_to_numpy": 4.6513150385980294e-05, "get_actions": 0.00015608449769531318, "remove_single_ts_time_rank_from_batch": 1.4124514039128618e-06, "normalize_and_clip_actions": 2.268146622025831e-05, "un_batch_to_individual_items": 1.632580078712443e-05, "listify_data_for_vector_env": 3.0829849490878864e-05}}, "connector_pipeline_timer": 0.0003480101284842569}, "env_reset_timer": 0.00023841622478409943, "env_to_module_connector": {"timers": {"connectors": {"add_observations_from_episodes_to_batch": 6.54517035270482e-06, "add_states_from_episodes_to_batch": 3.399089629740373e-06, "add_time_dim_to_batch_and_zero_pad": 6.004741316099156e-06, "batch_individual_items": 1.8682535460989972e-05, "numpy_to_tensor": 2.9187684115175713e-05}}, "connector_pipeline_timer": 0.00011461467098029083}, "num_episodes_lifetime": 260, "rlmodule_inference_timer": 9.598649117145474e-05, "num_module_steps_sampled": {"default_policy": 1000}, "agent_episode_returns_mean": {"default_agent": 0.1}, "num_env_steps_sampled_lifetime": 66000, "episode_len_max": 50, "num_module_steps_sampled_lifetime": {"default_policy": 13000}, "weights_seq_no": 13.0, "num_agent_steps_sampled_lifetime": {"default_agent": 13000}, "env_to_module_sum_episodes_length_in": 27.168093332126602, "env_to_module_sum_episodes_length_out": 27.168093332126602, "env_step_timer": 4.250203665078031e-05, "sample": 0.7327832625595441, "num_episodes": 20, "module_episode_returns_mean": {"default_policy": 0.1}, "episode_return_min": -16.5, "episode_len_min": 50, "num_env_steps_sampled": 1000, "episode_return_mean": 0.1, "episode_return_max": 17.5, "num_agent_steps_sampled": {"default_agent": 1000}, "episode_len_mean": 50.0, "episode_duration_sec_mean": 0.03535953593003796, "time_between_sampling": 4.2433348528462265}, "num_healthy_workers": 1, "actor_manager_num_outstanding_async_reqs": 0, "num_remote_worker_restarts": 0}, "num_env_steps_sampled_lifetime": -2657500.0, "fault_tolerance": {"num_healthy_workers": 0, "num_remote_worker_restarts": 0}, "env_runner_group": {"actor_manager_num_outstanding_async_reqs": 0}, "done": false, "training_iteration": 13, "trial_id": "af017_00000", "date": "2025-08-11_17-16-43", "timestamp": 1754925403, "time_this_iter_s": 4.9366278648376465, "time_total_s": 65.12882256507874, "pid": 67771, "hostname": "DESKTOP-3SK5A41", "node_ip": "192.168.40.242", "config": {"exploration_config": {}, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 6, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "env": "Umbrella", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": false, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 0, "create_local_env_runner": true, "num_envs_per_env_runner": 1, "gym_env_vectorize_mode": "SYNC", "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "episodes_to_numpy": true, "max_requests_in_flight_per_env_runner": 1, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "merge_env_runner_states": "training_only", "broadcast_env_runner_states": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "complete_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "sampler_perf_stats_ema_coef": null, "_is_online": true, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": "auto", "num_aggregator_actors_per_learner": 0, "max_requests_in_flight_per_aggregator_actor": 3, "local_gpu_idx": 0, "max_requests_in_flight_per_learner": 3, "gamma": 1, "lr": 1.02025592e-05, "grad_clip": 0.5, "grad_clip_by": "global_norm", "_train_batch_size_per_learner": 5000, "train_batch_size": 4000, "num_epochs": 3, "minibatch_size": 1000, "shuffle_batch_per_epoch": true, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "log_std_clip_param": 20.0, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "_disable_preprocessor_api": false, "_disable_action_flattening": false}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "_learner_class": null, "callbacks_on_algorithm_init": null, "callbacks_on_env_runners_recreated": null, "callbacks_on_offline_eval_runners_recreated": null, "callbacks_on_checkpoint_loaded": null, "callbacks_on_environment_created": null, "callbacks_on_episode_created": null, "callbacks_on_episode_start": null, "callbacks_on_episode_step": null, "callbacks_on_episode_end": null, "callbacks_on_evaluate_start": null, "callbacks_on_evaluate_end": null, "callbacks_on_evaluate_offline_start": null, "callbacks_on_evaluate_offline_end": null, "callbacks_on_sample_end": null, "callbacks_on_train_result": null, "explore": true, "enable_rl_module_and_learner": true, "enable_env_runner_and_connector_v2": true, "_prior_exploration_config": {"type": "StochasticSampling"}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x77ab39ecaac0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "offline_data_class": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_read_batch_size": null, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "materialize_data": false, "materialize_mapped_data": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "ignore_final_observation": false, "prelearner_class": null, "prelearner_buffer_class": null, "prelearner_buffer_kwargs": {}, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_remaining_data": false, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": 1, "evaluation_duration": 20, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_auto_duration_min_env_steps_per_sample": 100, "evaluation_auto_duration_max_env_steps_per_sample": 2000, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 1, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "offline_evaluation_interval": null, "num_offline_eval_runners": 0, "offline_loss_for_module_fn": null, "offline_evaluation_duration": 1, "offline_evaluation_parallel_to_training": false, "offline_evaluation_timeout_s": 120.0, "num_cpus_per_offline_eval_runner": 1, "num_gpus_per_offline_eval_runner": 0, "custom_resources_per_offline_eval_runner": {}, "restart_failed_offline_eval_runners": true, "ignore_offline_eval_runner_failures": false, "max_num_offline_eval_runner_restarts": 1000, "offline_eval_runner_restore_timeout_s": 1800.0, "max_requests_in_flight_per_offline_eval_runner": 1, "validate_offline_eval_runners_after_construction": true, "offline_eval_runner_health_probe_timeout_s": 30.0, "offline_eval_rl_module_inference_only": false, "broadcast_offline_eval_runner_states": false, "offline_eval_batch_size_per_runner": 256, "dataset_num_iters_per_eval_runner": 1, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "log_gradients": true, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 42, "restart_failed_env_runners": true, "ignore_env_runner_failures": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30.0, "env_runner_restore_timeout_s": 1800.0, "_model_config": {}, "_rl_module_spec": "RLModuleSpec(module_class=None, observation_space=None, action_space=None, inference_only=False, learner_only=False, model_config=DefaultModelConfig(fcnet_hiddens=[114, 56], fcnet_activation='tanh', fcnet_kernel_initializer=None, fcnet_kernel_initializer_kwargs=None, fcnet_bias_initializer=None, fcnet_bias_initializer_kwargs=None, conv_filters=None, conv_activation='relu', conv_kernel_initializer=None, conv_kernel_initializer_kwargs=None, conv_bias_initializer=None, conv_bias_initializer_kwargs=None, head_fcnet_hiddens=[], head_fcnet_activation='relu', head_fcnet_kernel_initializer=None, head_fcnet_kernel_initializer_kwargs=None, head_fcnet_bias_initializer=None, head_fcnet_bias_initializer_kwargs=None, free_log_std=False, log_std_clip_param=20.0, vf_share_layers=True, use_lstm=False, max_seq_len=20, lstm_cell_size=256, lstm_use_prev_action=False, lstm_use_prev_reward=False, lstm_kernel_initializer=None, lstm_kernel_initializer_kwargs=None, lstm_bias_initializer=None, lstm_bias_initializer_kwargs=None), catalog_class=None, load_state_path=None, model_config_dict=None)", "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "_validate_config": true, "_use_msgpack_checkpoints": false, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "env_task_fn": -1, "enable_connectors": -1, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.1483783801338, "kl_target": 0.0299561178854, "vf_loss_coeff": 0.8294931856016, "entropy_coeff": 0.0028379241987, "clip_param": 0.2023271755792, "vf_clip_param": 0.1015383331916, "entropy_coeff_schedule": null, "lr_schedule": null, "sgd_minibatch_size": -1, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9059303202574, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.callbacks.callbacks.RLlibCallback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 65.12882256507874, "iterations_since_restore": 13, "perf": {"cpu_util_percent": 12.142857142857142, "ram_util_percent": 74.3}}
{"timers": {"training_iteration": 4.321965054832714, "restore_env_runners": 1.4934256985132133e-05, "training_step": 4.321655689199688, "env_runner_sampling_timer": 3.8641521212081003, "learner_update_timer": 0.45384883845730223, "synch_weights": 0.0015198737639238562, "restore_eval_env_runners": 1.3194828277670742e-05, "evaluation_iteration": 0.744930401510615, "synch_eval_env_connectors": 0.00048722673446452755, "synch_env_connectors": 8.260238409143573e-06}, "env_runners": {"env_to_module_sum_episodes_length_in": 27.16809333212661, "module_to_env_connector": {"timers": {"connectors": {"listify_data_for_vector_env": 3.084318978402503e-05, "un_batch_to_individual_items": 1.4575217432314588e-05, "get_actions": 0.00016723541292106386, "tensor_to_numpy": 4.9825477214429457e-05, "remove_single_ts_time_rank_from_batch": 1.5134015479168011e-06, "normalize_and_clip_actions": 2.2810793067935887e-05}}, "connector_pipeline_timer": 0.0003648371106945821}, "num_agent_steps_sampled": {"default_agent": 5000.0}, "env_to_module_sum_episodes_length_out": 27.16809333212661, "num_env_steps_sampled": 5000.0, "episode_duration_sec_mean": 0.0382342589599739, "env_step_timer": 4.317826875647212e-05, "episode_return_mean": 5.299999999999998, "sample": 0.03789206571231399, "env_to_module_connector": {"timers": {"connectors": {"add_time_dim_to_batch_and_zero_pad": 6.301883060517513e-06, "numpy_to_tensor": 3.1558570668692136e-05, "add_states_from_episodes_to_batch": 3.5255851234352433e-06, "add_observations_from_episodes_to_batch": 6.274568548820095e-06, "batch_individual_items": 1.8381153925164687e-05}}, "connector_pipeline_timer": 0.00011917018389936447}, "num_episodes": 100.0, "num_module_steps_sampled_lifetime": {"default_policy": -2900000.0}, "episode_return_max": 14.5, "num_env_steps_sampled_lifetime": -2900000.0, "episode_len_mean": 50.0, "num_agent_steps_sampled_lifetime": {"default_agent": -2900000.0}, "episode_len_max": 50, "env_reset_timer": 9.293012737350994e-05, "num_module_steps_sampled": {"default_policy": 5000.0}, "num_episodes_lifetime": -58000.0, "episode_return_min": -5.5, "time_between_sampling": 0.012202414456619766, "rlmodule_inference_timer": 0.00011012137692541566, "episode_len_min": 50, "weights_seq_no": 13.0, "module_episode_returns_mean": {"default_policy": 5.299999999999998}, "agent_episode_returns_mean": {"default_agent": 5.299999999999998}, "num_env_steps_sampled_lifetime_throughput": 1270.1220598865473}, "learners": {"__all_modules__": {"learner_connector": {"timers": {"connectors": {"add_columns_from_episodes_to_train_batch": 0.0686471631795332, "general_advantage_estimation": 0.011385258023324248, "add_observations_from_episodes_to_batch": 0.0007665662577950432, "add_time_dim_to_batch_and_zero_pad": 2.167396959791551e-05, "add_states_from_episodes_to_batch": 5.663617304812299e-06, "add_one_ts_to_episodes_and_truncate": 0.008496665920945027, "numpy_to_tensor": 0.0001650933537502762, "batch_individual_items": 0.19583428545308146}}, "connector_pipeline_timer": 0.28563674386629156}, "num_module_steps_trained": 16000, "num_non_trainable_parameters": 0, "num_module_steps_trained_lifetime": 224000, "learner_connector_sum_episodes_length_out": 5100.0, "learner_connector_sum_episodes_length_in": 5000.0, "num_trainable_parameters": 7067, "num_env_steps_trained_lifetime": 1142400, "num_env_steps_trained": 81600, "num_env_steps_trained_lifetime_throughput": 966298.9833584833, "num_module_steps_trained_throughput": 189908.0405174497, "num_module_steps_trained_lifetime_throughput": 189807.1274759435}, "default_policy": {"num_module_steps_trained": 16000, "vf_explained_var": 0.009502828121185303, "num_module_steps_trained_lifetime": 224000, "module_train_batch_size_mean": 1000.0, "curr_kl_coeff": 9.056298040377442e-06, "policy_loss": -0.04332568123936653, "mean_kl_loss": 2.0176726138743106e-06, "vf_loss": 0.0949430987238884, "default_optimizer_learning_rate": 1.02025592e-05, "total_loss": 0.033466897904872894, "num_trainable_parameters": 7067, "gradients_default_optimizer_global_norm": 0.029925435781478882, "curr_entropy_coeff": 0.0028379241987, "vf_loss_unclipped": 14.44472599029541, "entropy": 0.691378116607666, "weights_seq_no": 14.0, "diff_num_grad_updates_vs_sampler_policy": 1.0, "num_module_steps_trained_lifetime_throughput": 190074.7487252888}}, "num_training_step_calls_per_iteration": 1, "evaluation": {"env_runners": {"module_to_env_connector": {"timers": {"connectors": {"tensor_to_numpy": 4.560083384046661e-05, "get_actions": 0.00015640045526503865, "remove_single_ts_time_rank_from_batch": 1.4909280800013417e-06, "normalize_and_clip_actions": 2.269692263685299e-05, "un_batch_to_individual_items": 1.5411128243395465e-05, "listify_data_for_vector_env": 3.080480006523493e-05}}, "connector_pipeline_timer": 0.0003463906117530671}, "env_reset_timer": 0.00023723506253788232, "env_to_module_connector": {"timers": {"connectors": {"add_observations_from_episodes_to_batch": 6.553729375035182e-06, "add_states_from_episodes_to_batch": 3.3905680664503727e-06, "add_time_dim_to_batch_and_zero_pad": 6.262927106159552e-06, "batch_individual_items": 1.8647955329302905e-05, "numpy_to_tensor": 2.9945122520300036e-05}}, "connector_pipeline_timer": 0.00011492218116077454}, "num_episodes_lifetime": 280, "rlmodule_inference_timer": 9.640814923390344e-05, "num_module_steps_sampled": {"default_policy": 1000}, "agent_episode_returns_mean": {"default_agent": 0.7}, "num_env_steps_sampled_lifetime": 71000, "episode_len_max": 50, "num_module_steps_sampled_lifetime": {"default_policy": 14000}, "weights_seq_no": 14.0, "num_agent_steps_sampled_lifetime": {"default_agent": 14000}, "env_to_module_sum_episodes_length_in": 27.168093332126602, "env_to_module_sum_episodes_length_out": 27.168093332126602, "env_step_timer": 4.268367526925872e-05, "sample": 0.732781889923948, "num_episodes": 20, "module_episode_returns_mean": {"default_policy": 0.7}, "episode_return_min": -16.5, "episode_len_min": 50, "num_env_steps_sampled": 1000, "episode_return_mean": 0.7, "episode_return_max": 17.5, "num_agent_steps_sampled": {"default_agent": 1000}, "episode_len_mean": 50.0, "episode_duration_sec_mean": 0.03529071492001094, "time_between_sampling": 4.2445128362577655}, "num_healthy_workers": 1, "actor_manager_num_outstanding_async_reqs": 0, "num_remote_worker_restarts": 0}, "num_env_steps_sampled_lifetime": -2900000.0, "fault_tolerance": {"num_healthy_workers": 0, "num_remote_worker_restarts": 0}, "env_runner_group": {"actor_manager_num_outstanding_async_reqs": 0}, "done": false, "training_iteration": 14, "trial_id": "af017_00000", "date": "2025-08-11_17-16-48", "timestamp": 1754925408, "time_this_iter_s": 5.053020477294922, "time_total_s": 70.18184304237366, "pid": 67771, "hostname": "DESKTOP-3SK5A41", "node_ip": "192.168.40.242", "config": {"exploration_config": {}, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 6, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "env": "Umbrella", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": false, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 0, "create_local_env_runner": true, "num_envs_per_env_runner": 1, "gym_env_vectorize_mode": "SYNC", "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "episodes_to_numpy": true, "max_requests_in_flight_per_env_runner": 1, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "merge_env_runner_states": "training_only", "broadcast_env_runner_states": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "complete_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "sampler_perf_stats_ema_coef": null, "_is_online": true, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": "auto", "num_aggregator_actors_per_learner": 0, "max_requests_in_flight_per_aggregator_actor": 3, "local_gpu_idx": 0, "max_requests_in_flight_per_learner": 3, "gamma": 1, "lr": 1.02025592e-05, "grad_clip": 0.5, "grad_clip_by": "global_norm", "_train_batch_size_per_learner": 5000, "train_batch_size": 4000, "num_epochs": 3, "minibatch_size": 1000, "shuffle_batch_per_epoch": true, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "log_std_clip_param": 20.0, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "_disable_preprocessor_api": false, "_disable_action_flattening": false}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "_learner_class": null, "callbacks_on_algorithm_init": null, "callbacks_on_env_runners_recreated": null, "callbacks_on_offline_eval_runners_recreated": null, "callbacks_on_checkpoint_loaded": null, "callbacks_on_environment_created": null, "callbacks_on_episode_created": null, "callbacks_on_episode_start": null, "callbacks_on_episode_step": null, "callbacks_on_episode_end": null, "callbacks_on_evaluate_start": null, "callbacks_on_evaluate_end": null, "callbacks_on_evaluate_offline_start": null, "callbacks_on_evaluate_offline_end": null, "callbacks_on_sample_end": null, "callbacks_on_train_result": null, "explore": true, "enable_rl_module_and_learner": true, "enable_env_runner_and_connector_v2": true, "_prior_exploration_config": {"type": "StochasticSampling"}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x77ab39ecaac0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "offline_data_class": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_read_batch_size": null, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "materialize_data": false, "materialize_mapped_data": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "ignore_final_observation": false, "prelearner_class": null, "prelearner_buffer_class": null, "prelearner_buffer_kwargs": {}, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_remaining_data": false, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": 1, "evaluation_duration": 20, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_auto_duration_min_env_steps_per_sample": 100, "evaluation_auto_duration_max_env_steps_per_sample": 2000, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 1, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "offline_evaluation_interval": null, "num_offline_eval_runners": 0, "offline_loss_for_module_fn": null, "offline_evaluation_duration": 1, "offline_evaluation_parallel_to_training": false, "offline_evaluation_timeout_s": 120.0, "num_cpus_per_offline_eval_runner": 1, "num_gpus_per_offline_eval_runner": 0, "custom_resources_per_offline_eval_runner": {}, "restart_failed_offline_eval_runners": true, "ignore_offline_eval_runner_failures": false, "max_num_offline_eval_runner_restarts": 1000, "offline_eval_runner_restore_timeout_s": 1800.0, "max_requests_in_flight_per_offline_eval_runner": 1, "validate_offline_eval_runners_after_construction": true, "offline_eval_runner_health_probe_timeout_s": 30.0, "offline_eval_rl_module_inference_only": false, "broadcast_offline_eval_runner_states": false, "offline_eval_batch_size_per_runner": 256, "dataset_num_iters_per_eval_runner": 1, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "log_gradients": true, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 42, "restart_failed_env_runners": true, "ignore_env_runner_failures": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30.0, "env_runner_restore_timeout_s": 1800.0, "_model_config": {}, "_rl_module_spec": "RLModuleSpec(module_class=None, observation_space=None, action_space=None, inference_only=False, learner_only=False, model_config=DefaultModelConfig(fcnet_hiddens=[114, 56], fcnet_activation='tanh', fcnet_kernel_initializer=None, fcnet_kernel_initializer_kwargs=None, fcnet_bias_initializer=None, fcnet_bias_initializer_kwargs=None, conv_filters=None, conv_activation='relu', conv_kernel_initializer=None, conv_kernel_initializer_kwargs=None, conv_bias_initializer=None, conv_bias_initializer_kwargs=None, head_fcnet_hiddens=[], head_fcnet_activation='relu', head_fcnet_kernel_initializer=None, head_fcnet_kernel_initializer_kwargs=None, head_fcnet_bias_initializer=None, head_fcnet_bias_initializer_kwargs=None, free_log_std=False, log_std_clip_param=20.0, vf_share_layers=True, use_lstm=False, max_seq_len=20, lstm_cell_size=256, lstm_use_prev_action=False, lstm_use_prev_reward=False, lstm_kernel_initializer=None, lstm_kernel_initializer_kwargs=None, lstm_bias_initializer=None, lstm_bias_initializer_kwargs=None), catalog_class=None, load_state_path=None, model_config_dict=None)", "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "_validate_config": true, "_use_msgpack_checkpoints": false, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "env_task_fn": -1, "enable_connectors": -1, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.1483783801338, "kl_target": 0.0299561178854, "vf_loss_coeff": 0.8294931856016, "entropy_coeff": 0.0028379241987, "clip_param": 0.2023271755792, "vf_clip_param": 0.1015383331916, "entropy_coeff_schedule": null, "lr_schedule": null, "sgd_minibatch_size": -1, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9059303202574, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.callbacks.callbacks.RLlibCallback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 70.18184304237366, "iterations_since_restore": 14, "perf": {"cpu_util_percent": 11.914285714285713, "ram_util_percent": 74.32857142857142}}
{"timers": {"training_iteration": 4.320488091264384, "restore_env_runners": 1.4887914417408185e-05, "training_step": 4.3201782842876915, "env_runner_sampling_timer": 3.8648929669760177, "learner_update_timer": 0.4516299700727276, "synch_weights": 0.0015185490262902889, "restore_eval_env_runners": 1.3165879997021408e-05, "evaluation_iteration": 0.7449022604855035, "synch_eval_env_connectors": 0.0004869114671219057, "synch_env_connectors": 8.243636027386613e-06}, "env_runners": {"env_to_module_sum_episodes_length_in": 27.16809333212661, "module_to_env_connector": {"timers": {"connectors": {"listify_data_for_vector_env": 3.088779732104854e-05, "un_batch_to_individual_items": 1.4527041824206589e-05, "get_actions": 0.0001668843689043096, "tensor_to_numpy": 4.997740077446186e-05, "remove_single_ts_time_rank_from_batch": 1.479178218245278e-06, "normalize_and_clip_actions": 2.273965729741456e-05}}, "connector_pipeline_timer": 0.0003647360253686957}, "num_agent_steps_sampled": {"default_agent": 5000.0}, "env_to_module_sum_episodes_length_out": 27.16809333212661, "num_env_steps_sampled": 5000.0, "episode_duration_sec_mean": 0.036862664980017126, "env_step_timer": 4.315531887493535e-05, "episode_return_mean": 6.5, "sample": 0.03875212289519239, "env_to_module_connector": {"timers": {"connectors": {"add_time_dim_to_batch_and_zero_pad": 6.3508937024542255e-06, "numpy_to_tensor": 3.1769715933376636e-05, "add_states_from_episodes_to_batch": 3.530393767649415e-06, "add_observations_from_episodes_to_batch": 6.299092040434642e-06, "batch_individual_items": 1.846903444069345e-05}}, "connector_pipeline_timer": 0.00011971129222293379}, "num_episodes": 100.0, "num_module_steps_sampled_lifetime": {"default_policy": -3142500.0}, "episode_return_max": 14.5, "num_env_steps_sampled_lifetime": -3142500.0, "episode_len_mean": 50.0, "num_agent_steps_sampled_lifetime": {"default_agent": -3142500.0}, "episode_len_max": 50, "env_reset_timer": 9.377546267351528e-05, "num_module_steps_sampled": {"default_policy": 5000.0}, "num_episodes_lifetime": -62850.0, "episode_return_min": -5.5, "time_between_sampling": 0.011846588075472368, "rlmodule_inference_timer": 0.00011572228689711521, "episode_len_min": 50, "weights_seq_no": 14.0, "module_episode_returns_mean": {"default_policy": 6.5}, "agent_episode_returns_mean": {"default_agent": 6.5}, "num_env_steps_sampled_lifetime_throughput": 1261.5634188739425}, "learners": {"__all_modules__": {"learner_connector": {"timers": {"connectors": {"add_columns_from_episodes_to_train_batch": 0.06863108854774137, "general_advantage_estimation": 0.011357951443093277, "add_observations_from_episodes_to_batch": 0.0007660075952183624, "add_time_dim_to_batch_and_zero_pad": 2.165522989984484e-05, "add_states_from_episodes_to_batch": 5.659981126059709e-06, "add_one_ts_to_episodes_and_truncate": 0.008494020261735442, "numpy_to_tensor": 0.00016511242021424142, "batch_individual_items": 0.1944603815985545}}, "connector_pipeline_timer": 0.28421611842763195}, "num_module_steps_trained": 16000, "num_non_trainable_parameters": 0, "num_module_steps_trained_lifetime": 240000, "learner_connector_sum_episodes_length_out": 5100.0, "learner_connector_sum_episodes_length_in": 5000.0, "num_trainable_parameters": 7067, "num_env_steps_trained_lifetime": 1224000, "num_env_steps_trained": 81600, "num_env_steps_trained_lifetime_throughput": 963959.7717590887, "num_module_steps_trained_throughput": 189432.881934231, "num_module_steps_trained_lifetime_throughput": 189334.98439251498}, "default_policy": {"num_module_steps_trained": 16000, "vf_explained_var": 0.009134113788604736, "num_module_steps_trained_lifetime": 240000, "module_train_batch_size_mean": 1000.0, "curr_kl_coeff": 4.528149020188721e-06, "policy_loss": -0.03208775818347931, "mean_kl_loss": 4.952297331328737e-06, "vf_loss": 0.09573321044445038, "default_optimizer_learning_rate": 1.02025592e-05, "total_loss": 0.04535963013768196, "num_trainable_parameters": 7067, "gradients_default_optimizer_global_norm": 0.07571196556091309, "curr_entropy_coeff": 0.0028379241987, "vf_loss_unclipped": 12.539077758789062, "entropy": 0.6915894150733948, "weights_seq_no": 15.0, "diff_num_grad_updates_vs_sampler_policy": 1.0, "num_module_steps_trained_lifetime_throughput": 189587.32752590918}}, "num_training_step_calls_per_iteration": 1, "evaluation": {"env_runners": {"module_to_env_connector": {"timers": {"connectors": {"tensor_to_numpy": 4.6478567138983947e-05, "get_actions": 0.0001556763918779428, "remove_single_ts_time_rank_from_batch": 1.457276118106132e-06, "normalize_and_clip_actions": 2.277855736690028e-05, "un_batch_to_individual_items": 1.5484739054172478e-05, "listify_data_for_vector_env": 3.0215274091655762e-05}}, "connector_pipeline_timer": 0.0003450998646778638}, "env_reset_timer": 0.00023610971191265204, "env_to_module_connector": {"timers": {"connectors": {"add_observations_from_episodes_to_batch": 6.4970087707547776e-06, "add_states_from_episodes_to_batch": 3.4026075922119393e-06, "add_time_dim_to_batch_and_zero_pad": 6.240743034514254e-06, "batch_individual_items": 1.799666153356459e-05, "numpy_to_tensor": 2.9495636856511223e-05}}, "connector_pipeline_timer": 0.0001132932292445457}, "num_episodes_lifetime": 300, "rlmodule_inference_timer": 9.636483624505653e-05, "num_module_steps_sampled": {"default_policy": 1000}, "agent_episode_returns_mean": {"default_agent": 0.7}, "num_env_steps_sampled_lifetime": 76000, "episode_len_max": 50, "num_module_steps_sampled_lifetime": {"default_policy": 15000}, "weights_seq_no": 15.0, "num_agent_steps_sampled_lifetime": {"default_agent": 15000}, "env_to_module_sum_episodes_length_in": 27.168093332126602, "env_to_module_sum_episodes_length_out": 27.168093332126602, "env_step_timer": 4.2363330913452484e-05, "sample": 0.732760355024705, "num_episodes": 20, "module_episode_returns_mean": {"default_policy": 0.7}, "episode_return_min": -16.5, "episode_len_min": 50, "num_env_steps_sampled": 1000, "episode_return_mean": 0.7, "episode_return_max": 17.5, "num_agent_steps_sampled": {"default_agent": 1000}, "episode_len_mean": 50.0, "episode_duration_sec_mean": 0.03525277093002842, "time_between_sampling": 4.244361495875186}, "num_healthy_workers": 1, "actor_manager_num_outstanding_async_reqs": 0, "num_remote_worker_restarts": 0}, "num_env_steps_sampled_lifetime": -3142500.0, "fault_tolerance": {"num_healthy_workers": 0, "num_remote_worker_restarts": 0}, "env_runner_group": {"actor_manager_num_outstanding_async_reqs": 0}, "done": false, "training_iteration": 15, "trial_id": "af017_00000", "date": "2025-08-11_17-16-53", "timestamp": 1754925413, "time_this_iter_s": 4.9198198318481445, "time_total_s": 75.1016628742218, "pid": 67771, "hostname": "DESKTOP-3SK5A41", "node_ip": "192.168.40.242", "config": {"exploration_config": {}, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 6, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "env": "Umbrella", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": false, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 0, "create_local_env_runner": true, "num_envs_per_env_runner": 1, "gym_env_vectorize_mode": "SYNC", "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "episodes_to_numpy": true, "max_requests_in_flight_per_env_runner": 1, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "merge_env_runner_states": "training_only", "broadcast_env_runner_states": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "complete_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "sampler_perf_stats_ema_coef": null, "_is_online": true, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": "auto", "num_aggregator_actors_per_learner": 0, "max_requests_in_flight_per_aggregator_actor": 3, "local_gpu_idx": 0, "max_requests_in_flight_per_learner": 3, "gamma": 1, "lr": 1.02025592e-05, "grad_clip": 0.5, "grad_clip_by": "global_norm", "_train_batch_size_per_learner": 5000, "train_batch_size": 4000, "num_epochs": 3, "minibatch_size": 1000, "shuffle_batch_per_epoch": true, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "log_std_clip_param": 20.0, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "_disable_preprocessor_api": false, "_disable_action_flattening": false}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "_learner_class": null, "callbacks_on_algorithm_init": null, "callbacks_on_env_runners_recreated": null, "callbacks_on_offline_eval_runners_recreated": null, "callbacks_on_checkpoint_loaded": null, "callbacks_on_environment_created": null, "callbacks_on_episode_created": null, "callbacks_on_episode_start": null, "callbacks_on_episode_step": null, "callbacks_on_episode_end": null, "callbacks_on_evaluate_start": null, "callbacks_on_evaluate_end": null, "callbacks_on_evaluate_offline_start": null, "callbacks_on_evaluate_offline_end": null, "callbacks_on_sample_end": null, "callbacks_on_train_result": null, "explore": true, "enable_rl_module_and_learner": true, "enable_env_runner_and_connector_v2": true, "_prior_exploration_config": {"type": "StochasticSampling"}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x77ab39ecaac0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "offline_data_class": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_read_batch_size": null, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "materialize_data": false, "materialize_mapped_data": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "ignore_final_observation": false, "prelearner_class": null, "prelearner_buffer_class": null, "prelearner_buffer_kwargs": {}, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_remaining_data": false, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": 1, "evaluation_duration": 20, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_auto_duration_min_env_steps_per_sample": 100, "evaluation_auto_duration_max_env_steps_per_sample": 2000, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 1, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "offline_evaluation_interval": null, "num_offline_eval_runners": 0, "offline_loss_for_module_fn": null, "offline_evaluation_duration": 1, "offline_evaluation_parallel_to_training": false, "offline_evaluation_timeout_s": 120.0, "num_cpus_per_offline_eval_runner": 1, "num_gpus_per_offline_eval_runner": 0, "custom_resources_per_offline_eval_runner": {}, "restart_failed_offline_eval_runners": true, "ignore_offline_eval_runner_failures": false, "max_num_offline_eval_runner_restarts": 1000, "offline_eval_runner_restore_timeout_s": 1800.0, "max_requests_in_flight_per_offline_eval_runner": 1, "validate_offline_eval_runners_after_construction": true, "offline_eval_runner_health_probe_timeout_s": 30.0, "offline_eval_rl_module_inference_only": false, "broadcast_offline_eval_runner_states": false, "offline_eval_batch_size_per_runner": 256, "dataset_num_iters_per_eval_runner": 1, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "log_gradients": true, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 42, "restart_failed_env_runners": true, "ignore_env_runner_failures": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30.0, "env_runner_restore_timeout_s": 1800.0, "_model_config": {}, "_rl_module_spec": "RLModuleSpec(module_class=None, observation_space=None, action_space=None, inference_only=False, learner_only=False, model_config=DefaultModelConfig(fcnet_hiddens=[114, 56], fcnet_activation='tanh', fcnet_kernel_initializer=None, fcnet_kernel_initializer_kwargs=None, fcnet_bias_initializer=None, fcnet_bias_initializer_kwargs=None, conv_filters=None, conv_activation='relu', conv_kernel_initializer=None, conv_kernel_initializer_kwargs=None, conv_bias_initializer=None, conv_bias_initializer_kwargs=None, head_fcnet_hiddens=[], head_fcnet_activation='relu', head_fcnet_kernel_initializer=None, head_fcnet_kernel_initializer_kwargs=None, head_fcnet_bias_initializer=None, head_fcnet_bias_initializer_kwargs=None, free_log_std=False, log_std_clip_param=20.0, vf_share_layers=True, use_lstm=False, max_seq_len=20, lstm_cell_size=256, lstm_use_prev_action=False, lstm_use_prev_reward=False, lstm_kernel_initializer=None, lstm_kernel_initializer_kwargs=None, lstm_bias_initializer=None, lstm_bias_initializer_kwargs=None), catalog_class=None, load_state_path=None, model_config_dict=None)", "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "_validate_config": true, "_use_msgpack_checkpoints": false, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "env_task_fn": -1, "enable_connectors": -1, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.1483783801338, "kl_target": 0.0299561178854, "vf_loss_coeff": 0.8294931856016, "entropy_coeff": 0.0028379241987, "clip_param": 0.2023271755792, "vf_clip_param": 0.1015383331916, "entropy_coeff_schedule": null, "lr_schedule": null, "sgd_minibatch_size": -1, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9059303202574, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.callbacks.callbacks.RLlibCallback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 75.1016628742218, "iterations_since_restore": 15, "perf": {"cpu_util_percent": 12.557142857142859, "ram_util_percent": 74.31428571428572}}
{"timers": {"training_iteration": 4.320285597331737, "restore_env_runners": 1.4845035270920117e-05, "training_step": 4.319974958424809, "env_runner_sampling_timer": 3.8669410072862567, "learner_update_timer": 0.4493782923720028, "synch_weights": 0.0015172365360254427, "restore_eval_env_runners": 1.3144221197910338e-05, "evaluation_iteration": 0.7448575468806425, "synch_eval_env_connectors": 0.00048647935244846554, "synch_env_connectors": 8.235199666698541e-06}, "env_runners": {"env_to_module_sum_episodes_length_in": 27.16809333212661, "module_to_env_connector": {"timers": {"connectors": {"listify_data_for_vector_env": 3.083070032182764e-05, "un_batch_to_individual_items": 1.4494832526937116e-05, "get_actions": 0.00016744016635663735, "tensor_to_numpy": 4.963686121007505e-05, "remove_single_ts_time_rank_from_batch": 1.4793784816427442e-06, "normalize_and_clip_actions": 2.2738601250492442e-05}}, "connector_pipeline_timer": 0.0003649186125991942}, "num_agent_steps_sampled": {"default_agent": 5000.0}, "env_to_module_sum_episodes_length_out": 27.16809333212661, "num_env_steps_sampled": 5000.0, "episode_duration_sec_mean": 0.038177521980005624, "env_step_timer": 4.304730007258647e-05, "episode_return_mean": 5.5, "sample": 0.03905906104358647, "env_to_module_connector": {"timers": {"connectors": {"add_time_dim_to_batch_and_zero_pad": 6.339086094827743e-06, "numpy_to_tensor": 3.159129187296498e-05, "add_states_from_episodes_to_batch": 3.475057976502859e-06, "add_observations_from_episodes_to_batch": 6.2741558512334745e-06, "batch_individual_items": 1.8425710602348517e-05}}, "connector_pipeline_timer": 0.00011914663208375826}, "num_episodes": 100.0, "num_module_steps_sampled_lifetime": {"default_policy": -3385000.0}, "episode_return_max": 14.5, "num_env_steps_sampled_lifetime": -3385000.0, "episode_len_mean": 50.0, "num_agent_steps_sampled_lifetime": {"default_agent": -3385000.0}, "episode_len_max": 50, "env_reset_timer": 9.416599235356047e-05, "num_module_steps_sampled": {"default_policy": 5000.0}, "num_episodes_lifetime": -67700.0, "episode_return_min": -5.5, "time_between_sampling": 0.011749141793574487, "rlmodule_inference_timer": 0.00013481304859945805, "episode_len_min": 50, "weights_seq_no": 15.0, "module_episode_returns_mean": {"default_policy": 5.5}, "agent_episode_returns_mean": {"default_agent": 5.5}, "num_env_steps_sampled_lifetime_throughput": 1259.5965001481893}, "learners": {"__all_modules__": {"learner_connector": {"timers": {"connectors": {"add_columns_from_episodes_to_train_batch": 0.06861580266226543, "general_advantage_estimation": 0.011328964928663749, "add_observations_from_episodes_to_batch": 0.0007651455192610663, "add_time_dim_to_batch_and_zero_pad": 2.1641677600447552e-05, "add_states_from_episodes_to_batch": 5.656381318189592e-06, "add_one_ts_to_episodes_and_truncate": 0.00849026205911253, "numpy_to_tensor": 0.0001651302960059525, "batch_individual_items": 0.19309343578256183}}, "connector_pipeline_timer": 0.2828000892433525}, "num_module_steps_trained": 16000, "num_non_trainable_parameters": 0, "num_module_steps_trained_lifetime": 256000, "learner_connector_sum_episodes_length_out": 5100.0, "learner_connector_sum_episodes_length_in": 5000.0, "num_trainable_parameters": 7067, "num_env_steps_trained_lifetime": 1305600, "num_env_steps_trained": 81600, "num_env_steps_trained_lifetime_throughput": 963009.6119314862, "num_module_steps_trained_throughput": 189229.80580378126, "num_module_steps_trained_lifetime_throughput": 189135.14308451774}, "default_policy": {"num_module_steps_trained": 16000, "vf_explained_var": 0.010260522365570068, "num_module_steps_trained_lifetime": 256000, "module_train_batch_size_mean": 1000.0, "curr_kl_coeff": 2.2640745100943604e-06, "policy_loss": -0.036006029695272446, "mean_kl_loss": 2.1355489820962248e-07, "vf_loss": 0.0940878763794899, "default_optimizer_learning_rate": 1.02025592e-05, "total_loss": 0.04007674753665924, "num_trainable_parameters": 7067, "gradients_default_optimizer_global_norm": 0.06126552075147629, "curr_entropy_coeff": 0.0028379241987, "vf_loss_unclipped": 12.169129371643066, "entropy": 0.6915199756622314, "weights_seq_no": 16.0, "diff_num_grad_updates_vs_sampler_policy": 1.0, "num_module_steps_trained_lifetime_throughput": 189369.65628014272}}, "num_training_step_calls_per_iteration": 1, "evaluation": {"env_runners": {"module_to_env_connector": {"timers": {"connectors": {"tensor_to_numpy": 4.59473855719635e-05, "get_actions": 0.00015427965151686957, "remove_single_ts_time_rank_from_batch": 1.451464057618167e-06, "normalize_and_clip_actions": 2.1971813048146878e-05, "un_batch_to_individual_items": 1.5976864122287483e-05, "listify_data_for_vector_env": 3.0463183055346115e-05}}, "connector_pipeline_timer": 0.0003428194286158612}, "env_reset_timer": 0.00023516461478904097, "env_to_module_connector": {"timers": {"connectors": {"add_observations_from_episodes_to_batch": 6.482979522257658e-06, "add_states_from_episodes_to_batch": 3.577974809644298e-06, "add_time_dim_to_batch_and_zero_pad": 6.016198286600362e-06, "batch_individual_items": 1.8248617860961767e-05, "numpy_to_tensor": 2.9397530256386007e-05}}, "connector_pipeline_timer": 0.0001140766428582708}, "num_episodes_lifetime": 320, "rlmodule_inference_timer": 9.645436552662678e-05, "num_module_steps_sampled": {"default_policy": 1000}, "agent_episode_returns_mean": {"default_agent": -0.5}, "num_env_steps_sampled_lifetime": 81000, "episode_len_max": 50, "num_module_steps_sampled_lifetime": {"default_policy": 16000}, "weights_seq_no": 16.0, "num_agent_steps_sampled_lifetime": {"default_agent": 16000}, "env_to_module_sum_episodes_length_in": 27.168093332126602, "env_to_module_sum_episodes_length_out": 27.168093332126602, "env_step_timer": 4.1594908671085236e-05, "sample": 0.7328119024744535, "num_episodes": 20, "module_episode_returns_mean": {"default_policy": -0.5}, "episode_return_min": -16.5, "episode_len_min": 50, "num_env_steps_sampled": 1000, "episode_return_mean": -0.5, "episode_return_max": 17.5, "num_agent_steps_sampled": {"default_agent": 1000}, "episode_len_mean": 50.0, "episode_duration_sec_mean": 0.0352751159500076, "time_between_sampling": 4.245490753896428}, "num_healthy_workers": 1, "actor_manager_num_outstanding_async_reqs": 0, "num_remote_worker_restarts": 0}, "num_env_steps_sampled_lifetime": -3385000.0, "fault_tolerance": {"num_healthy_workers": 0, "num_remote_worker_restarts": 0}, "env_runner_group": {"actor_manager_num_outstanding_async_reqs": 0}, "done": false, "training_iteration": 16, "trial_id": "af017_00000", "date": "2025-08-11_17-16-58", "timestamp": 1754925418, "time_this_iter_s": 5.052760362625122, "time_total_s": 80.15442323684692, "pid": 67771, "hostname": "DESKTOP-3SK5A41", "node_ip": "192.168.40.242", "config": {"exploration_config": {}, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 6, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "env": "Umbrella", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": false, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 0, "create_local_env_runner": true, "num_envs_per_env_runner": 1, "gym_env_vectorize_mode": "SYNC", "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "episodes_to_numpy": true, "max_requests_in_flight_per_env_runner": 1, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "merge_env_runner_states": "training_only", "broadcast_env_runner_states": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "complete_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "sampler_perf_stats_ema_coef": null, "_is_online": true, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": "auto", "num_aggregator_actors_per_learner": 0, "max_requests_in_flight_per_aggregator_actor": 3, "local_gpu_idx": 0, "max_requests_in_flight_per_learner": 3, "gamma": 1, "lr": 1.02025592e-05, "grad_clip": 0.5, "grad_clip_by": "global_norm", "_train_batch_size_per_learner": 5000, "train_batch_size": 4000, "num_epochs": 3, "minibatch_size": 1000, "shuffle_batch_per_epoch": true, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "log_std_clip_param": 20.0, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "_disable_preprocessor_api": false, "_disable_action_flattening": false}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "_learner_class": null, "callbacks_on_algorithm_init": null, "callbacks_on_env_runners_recreated": null, "callbacks_on_offline_eval_runners_recreated": null, "callbacks_on_checkpoint_loaded": null, "callbacks_on_environment_created": null, "callbacks_on_episode_created": null, "callbacks_on_episode_start": null, "callbacks_on_episode_step": null, "callbacks_on_episode_end": null, "callbacks_on_evaluate_start": null, "callbacks_on_evaluate_end": null, "callbacks_on_evaluate_offline_start": null, "callbacks_on_evaluate_offline_end": null, "callbacks_on_sample_end": null, "callbacks_on_train_result": null, "explore": true, "enable_rl_module_and_learner": true, "enable_env_runner_and_connector_v2": true, "_prior_exploration_config": {"type": "StochasticSampling"}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x77ab39ecaac0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "offline_data_class": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_read_batch_size": null, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "materialize_data": false, "materialize_mapped_data": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "ignore_final_observation": false, "prelearner_class": null, "prelearner_buffer_class": null, "prelearner_buffer_kwargs": {}, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_remaining_data": false, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": 1, "evaluation_duration": 20, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_auto_duration_min_env_steps_per_sample": 100, "evaluation_auto_duration_max_env_steps_per_sample": 2000, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 1, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "offline_evaluation_interval": null, "num_offline_eval_runners": 0, "offline_loss_for_module_fn": null, "offline_evaluation_duration": 1, "offline_evaluation_parallel_to_training": false, "offline_evaluation_timeout_s": 120.0, "num_cpus_per_offline_eval_runner": 1, "num_gpus_per_offline_eval_runner": 0, "custom_resources_per_offline_eval_runner": {}, "restart_failed_offline_eval_runners": true, "ignore_offline_eval_runner_failures": false, "max_num_offline_eval_runner_restarts": 1000, "offline_eval_runner_restore_timeout_s": 1800.0, "max_requests_in_flight_per_offline_eval_runner": 1, "validate_offline_eval_runners_after_construction": true, "offline_eval_runner_health_probe_timeout_s": 30.0, "offline_eval_rl_module_inference_only": false, "broadcast_offline_eval_runner_states": false, "offline_eval_batch_size_per_runner": 256, "dataset_num_iters_per_eval_runner": 1, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "log_gradients": true, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 42, "restart_failed_env_runners": true, "ignore_env_runner_failures": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30.0, "env_runner_restore_timeout_s": 1800.0, "_model_config": {}, "_rl_module_spec": "RLModuleSpec(module_class=None, observation_space=None, action_space=None, inference_only=False, learner_only=False, model_config=DefaultModelConfig(fcnet_hiddens=[114, 56], fcnet_activation='tanh', fcnet_kernel_initializer=None, fcnet_kernel_initializer_kwargs=None, fcnet_bias_initializer=None, fcnet_bias_initializer_kwargs=None, conv_filters=None, conv_activation='relu', conv_kernel_initializer=None, conv_kernel_initializer_kwargs=None, conv_bias_initializer=None, conv_bias_initializer_kwargs=None, head_fcnet_hiddens=[], head_fcnet_activation='relu', head_fcnet_kernel_initializer=None, head_fcnet_kernel_initializer_kwargs=None, head_fcnet_bias_initializer=None, head_fcnet_bias_initializer_kwargs=None, free_log_std=False, log_std_clip_param=20.0, vf_share_layers=True, use_lstm=False, max_seq_len=20, lstm_cell_size=256, lstm_use_prev_action=False, lstm_use_prev_reward=False, lstm_kernel_initializer=None, lstm_kernel_initializer_kwargs=None, lstm_bias_initializer=None, lstm_bias_initializer_kwargs=None), catalog_class=None, load_state_path=None, model_config_dict=None)", "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "_validate_config": true, "_use_msgpack_checkpoints": false, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "env_task_fn": -1, "enable_connectors": -1, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.1483783801338, "kl_target": 0.0299561178854, "vf_loss_coeff": 0.8294931856016, "entropy_coeff": 0.0028379241987, "clip_param": 0.2023271755792, "vf_clip_param": 0.1015383331916, "entropy_coeff_schedule": null, "lr_schedule": null, "sgd_minibatch_size": -1, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9059303202574, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.callbacks.callbacks.RLlibCallback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 80.15442323684692, "iterations_since_restore": 16, "perf": {"cpu_util_percent": 12.085714285714285, "ram_util_percent": 74.3}}
{"timers": {"training_iteration": 4.320241484358415, "restore_env_runners": 1.4813584917801831e-05, "training_step": 4.319930513840561, "env_runner_sampling_timer": 3.8676897732133937, "learner_update_timer": 0.448584833448284, "synch_weights": 0.0015167711706654597, "restore_eval_env_runners": 1.3121778988270833e-05, "evaluation_iteration": 0.7448832874118342, "synch_eval_env_connectors": 0.0004864765589201183, "synch_env_connectors": 8.217847664751538e-06}, "env_runners": {"env_to_module_sum_episodes_length_in": 27.16809333212661, "module_to_env_connector": {"timers": {"connectors": {"listify_data_for_vector_env": 3.094640046302119e-05, "un_batch_to_individual_items": 1.4573698290686409e-05, "get_actions": 0.0001674192229847241, "tensor_to_numpy": 4.976530259909044e-05, "remove_single_ts_time_rank_from_batch": 1.5074178058283797e-06, "normalize_and_clip_actions": 2.272250216640405e-05}}, "connector_pipeline_timer": 0.0003654664766662049}, "num_agent_steps_sampled": {"default_agent": 5000.0}, "env_to_module_sum_episodes_length_out": 27.16809333212661, "num_env_steps_sampled": 5000.0, "episode_duration_sec_mean": 0.036900170000080834, "env_step_timer": 4.332420829652579e-05, "episode_return_mean": 4.7, "sample": 0.038345055150067295, "env_to_module_connector": {"timers": {"connectors": {"add_time_dim_to_batch_and_zero_pad": 6.333234417513028e-06, "numpy_to_tensor": 3.171439299116518e-05, "add_states_from_episodes_to_batch": 3.4667344048613356e-06, "add_observations_from_episodes_to_batch": 6.3378535091295085e-06, "batch_individual_items": 1.8441129464142798e-05}}, "connector_pipeline_timer": 0.00011955709499689984}, "num_episodes": 100.0, "num_module_steps_sampled_lifetime": {"default_policy": -3627500.0}, "episode_return_max": 14.5, "num_env_steps_sampled_lifetime": -3627500.0, "episode_len_mean": 50.0, "num_agent_steps_sampled_lifetime": {"default_agent": -3627500.0}, "episode_len_max": 50, "env_reset_timer": 9.403052517239421e-05, "num_module_steps_sampled": {"default_policy": 5000.0}, "num_episodes_lifetime": -72550.0, "episode_return_min": -5.5, "time_between_sampling": 0.011724463498735878, "rlmodule_inference_timer": 0.00010185682965528024, "episode_len_min": 50, "weights_seq_no": 16.0, "module_episode_returns_mean": {"default_policy": 4.7}, "agent_episode_returns_mean": {"default_agent": 4.7}, "num_env_steps_sampled_lifetime_throughput": 1270.7906199121774}, "learners": {"__all_modules__": {"learner_connector": {"timers": {"connectors": {"add_columns_from_episodes_to_train_batch": 0.06860256963564171, "general_advantage_estimation": 0.011300062279383356, "add_observations_from_episodes_to_batch": 0.0007643120640701138, "add_time_dim_to_batch_and_zero_pad": 2.1631260819602878e-05, "add_states_from_episodes_to_batch": 5.651817500783683e-06, "add_one_ts_to_episodes_and_truncate": 0.00848539943852396, "numpy_to_tensor": 0.0001656309930431882, "batch_individual_items": 0.19321811242473233}}, "connector_pipeline_timer": 0.28287815235092695}, "num_module_steps_trained": 16000, "num_non_trainable_parameters": 0, "num_module_steps_trained_lifetime": 272000, "learner_connector_sum_episodes_length_out": 5100.0, "learner_connector_sum_episodes_length_in": 5000.0, "num_trainable_parameters": 7067, "num_env_steps_trained_lifetime": 1387200, "num_env_steps_trained": 81600, "num_env_steps_trained_lifetime_throughput": 964477.6046758657, "num_module_steps_trained_throughput": 189503.47187513494, "num_module_steps_trained_lifetime_throughput": 189411.7683322796}, "default_policy": {"num_module_steps_trained": 16000, "vf_explained_var": 0.01194906234741211, "num_module_steps_trained_lifetime": 272000, "module_train_batch_size_mean": 1000.0, "curr_kl_coeff": 1.1320372550471802e-06, "policy_loss": -0.00033037876710295677, "mean_kl_loss": 7.484943864710658e-08, "vf_loss": 0.09401178359985352, "default_optimizer_learning_rate": 1.02025592e-05, "total_loss": 0.07568956166505814, "num_trainable_parameters": 7067, "gradients_default_optimizer_global_norm": 0.06996896862983704, "curr_entropy_coeff": 0.0028379241987, "vf_loss_unclipped": 11.43120288848877, "entropy": 0.6914269924163818, "weights_seq_no": 17.0, "diff_num_grad_updates_vs_sampler_policy": 1.0, "num_module_steps_trained_lifetime_throughput": 189629.28899395093}}, "num_training_step_calls_per_iteration": 1, "evaluation": {"env_runners": {"module_to_env_connector": {"timers": {"connectors": {"tensor_to_numpy": 4.520844898191749e-05, "get_actions": 0.0001559877452212821, "remove_single_ts_time_rank_from_batch": 1.3938329659792206e-06, "normalize_and_clip_actions": 2.2074571501979183e-05, "un_batch_to_individual_items": 1.5446501565086933e-05, "listify_data_for_vector_env": 3.0369008536995323e-05}}, "connector_pipeline_timer": 0.000343471080558909}, "env_reset_timer": 0.00023405896864277955, "env_to_module_connector": {"timers": {"connectors": {"add_observations_from_episodes_to_batch": 6.4804063387457114e-06, "add_states_from_episodes_to_batch": 3.3114078715294854e-06, "add_time_dim_to_batch_and_zero_pad": 6.0879560243651836e-06, "batch_individual_items": 1.8365391557262384e-05, "numpy_to_tensor": 2.926380248533687e-05}}, "connector_pipeline_timer": 0.00011453097311290525}, "num_episodes_lifetime": 340, "rlmodule_inference_timer": 9.485265542481408e-05, "num_module_steps_sampled": {"default_policy": 1000}, "agent_episode_returns_mean": {"default_agent": -1.1}, "num_env_steps_sampled_lifetime": 86000, "episode_len_max": 50, "num_module_steps_sampled_lifetime": {"default_policy": 17000}, "weights_seq_no": 17.0, "num_agent_steps_sampled_lifetime": {"default_agent": 17000}, "env_to_module_sum_episodes_length_in": 27.168093332126602, "env_to_module_sum_episodes_length_out": 27.168093332126602, "env_step_timer": 4.3875738106666115e-05, "sample": 0.7327898994497087, "num_episodes": 20, "module_episode_returns_mean": {"default_policy": -1.1}, "episode_return_min": -16.5, "episode_len_min": 50, "num_env_steps_sampled": 1000, "episode_return_mean": -1.1, "episode_return_max": 17.5, "num_agent_steps_sampled": {"default_agent": 1000}, "episode_len_mean": 50.0, "episode_duration_sec_mean": 0.0352453659800085, "time_between_sampling": 4.246749397357456}, "num_healthy_workers": 1, "actor_manager_num_outstanding_async_reqs": 0, "num_remote_worker_restarts": 0}, "num_env_steps_sampled_lifetime": -3627500.0, "fault_tolerance": {"num_healthy_workers": 0, "num_remote_worker_restarts": 0}, "env_runner_group": {"actor_manager_num_outstanding_async_reqs": 0}, "done": false, "training_iteration": 17, "trial_id": "af017_00000", "date": "2025-08-11_17-17-03", "timestamp": 1754925423, "time_this_iter_s": 5.0604424476623535, "time_total_s": 85.21486568450928, "pid": 67771, "hostname": "DESKTOP-3SK5A41", "node_ip": "192.168.40.242", "config": {"exploration_config": {}, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 6, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "env": "Umbrella", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": false, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 0, "create_local_env_runner": true, "num_envs_per_env_runner": 1, "gym_env_vectorize_mode": "SYNC", "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "episodes_to_numpy": true, "max_requests_in_flight_per_env_runner": 1, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "merge_env_runner_states": "training_only", "broadcast_env_runner_states": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "complete_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "sampler_perf_stats_ema_coef": null, "_is_online": true, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": "auto", "num_aggregator_actors_per_learner": 0, "max_requests_in_flight_per_aggregator_actor": 3, "local_gpu_idx": 0, "max_requests_in_flight_per_learner": 3, "gamma": 1, "lr": 1.02025592e-05, "grad_clip": 0.5, "grad_clip_by": "global_norm", "_train_batch_size_per_learner": 5000, "train_batch_size": 4000, "num_epochs": 3, "minibatch_size": 1000, "shuffle_batch_per_epoch": true, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "log_std_clip_param": 20.0, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "_disable_preprocessor_api": false, "_disable_action_flattening": false}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "_learner_class": null, "callbacks_on_algorithm_init": null, "callbacks_on_env_runners_recreated": null, "callbacks_on_offline_eval_runners_recreated": null, "callbacks_on_checkpoint_loaded": null, "callbacks_on_environment_created": null, "callbacks_on_episode_created": null, "callbacks_on_episode_start": null, "callbacks_on_episode_step": null, "callbacks_on_episode_end": null, "callbacks_on_evaluate_start": null, "callbacks_on_evaluate_end": null, "callbacks_on_evaluate_offline_start": null, "callbacks_on_evaluate_offline_end": null, "callbacks_on_sample_end": null, "callbacks_on_train_result": null, "explore": true, "enable_rl_module_and_learner": true, "enable_env_runner_and_connector_v2": true, "_prior_exploration_config": {"type": "StochasticSampling"}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x77ab39ecaac0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "offline_data_class": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_read_batch_size": null, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "materialize_data": false, "materialize_mapped_data": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "ignore_final_observation": false, "prelearner_class": null, "prelearner_buffer_class": null, "prelearner_buffer_kwargs": {}, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_remaining_data": false, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": 1, "evaluation_duration": 20, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_auto_duration_min_env_steps_per_sample": 100, "evaluation_auto_duration_max_env_steps_per_sample": 2000, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 1, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "offline_evaluation_interval": null, "num_offline_eval_runners": 0, "offline_loss_for_module_fn": null, "offline_evaluation_duration": 1, "offline_evaluation_parallel_to_training": false, "offline_evaluation_timeout_s": 120.0, "num_cpus_per_offline_eval_runner": 1, "num_gpus_per_offline_eval_runner": 0, "custom_resources_per_offline_eval_runner": {}, "restart_failed_offline_eval_runners": true, "ignore_offline_eval_runner_failures": false, "max_num_offline_eval_runner_restarts": 1000, "offline_eval_runner_restore_timeout_s": 1800.0, "max_requests_in_flight_per_offline_eval_runner": 1, "validate_offline_eval_runners_after_construction": true, "offline_eval_runner_health_probe_timeout_s": 30.0, "offline_eval_rl_module_inference_only": false, "broadcast_offline_eval_runner_states": false, "offline_eval_batch_size_per_runner": 256, "dataset_num_iters_per_eval_runner": 1, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "log_gradients": true, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 42, "restart_failed_env_runners": true, "ignore_env_runner_failures": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30.0, "env_runner_restore_timeout_s": 1800.0, "_model_config": {}, "_rl_module_spec": "RLModuleSpec(module_class=None, observation_space=None, action_space=None, inference_only=False, learner_only=False, model_config=DefaultModelConfig(fcnet_hiddens=[114, 56], fcnet_activation='tanh', fcnet_kernel_initializer=None, fcnet_kernel_initializer_kwargs=None, fcnet_bias_initializer=None, fcnet_bias_initializer_kwargs=None, conv_filters=None, conv_activation='relu', conv_kernel_initializer=None, conv_kernel_initializer_kwargs=None, conv_bias_initializer=None, conv_bias_initializer_kwargs=None, head_fcnet_hiddens=[], head_fcnet_activation='relu', head_fcnet_kernel_initializer=None, head_fcnet_kernel_initializer_kwargs=None, head_fcnet_bias_initializer=None, head_fcnet_bias_initializer_kwargs=None, free_log_std=False, log_std_clip_param=20.0, vf_share_layers=True, use_lstm=False, max_seq_len=20, lstm_cell_size=256, lstm_use_prev_action=False, lstm_use_prev_reward=False, lstm_kernel_initializer=None, lstm_kernel_initializer_kwargs=None, lstm_bias_initializer=None, lstm_bias_initializer_kwargs=None), catalog_class=None, load_state_path=None, model_config_dict=None)", "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "_validate_config": true, "_use_msgpack_checkpoints": false, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "env_task_fn": -1, "enable_connectors": -1, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.1483783801338, "kl_target": 0.0299561178854, "vf_loss_coeff": 0.8294931856016, "entropy_coeff": 0.0028379241987, "clip_param": 0.2023271755792, "vf_clip_param": 0.1015383331916, "entropy_coeff_schedule": null, "lr_schedule": null, "sgd_minibatch_size": -1, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9059303202574, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.callbacks.callbacks.RLlibCallback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 85.21486568450928, "iterations_since_restore": 17, "perf": {"cpu_util_percent": 12.3625, "ram_util_percent": 74.3}}
{"timers": {"training_iteration": 4.31874227749483, "restore_env_runners": 1.477044906779028e-05, "training_step": 4.318430938682155, "env_runner_sampling_timer": 3.8683634764612562, "learner_update_timer": 0.4464115111138063, "synch_weights": 0.0015158634589660031, "restore_eval_env_runners": 1.3096561196074137e-05, "evaluation_iteration": 0.7448383065377134, "synch_eval_env_connectors": 0.00048556079333265663, "synch_env_connectors": 8.206669192131178e-06}, "env_runners": {"env_to_module_sum_episodes_length_in": 27.16809333212661, "module_to_env_connector": {"timers": {"connectors": {"listify_data_for_vector_env": 3.0818839280199235e-05, "un_batch_to_individual_items": 1.4478883719434218e-05, "get_actions": 0.0001675272143583445, "tensor_to_numpy": 4.984991354114619e-05, "remove_single_ts_time_rank_from_batch": 1.4511401652826393e-06, "normalize_and_clip_actions": 2.2840529949896468e-05}}, "connector_pipeline_timer": 0.00036542392772661295}, "num_agent_steps_sampled": {"default_agent": 5000.0}, "env_to_module_sum_episodes_length_out": 27.16809333212661, "num_env_steps_sampled": 5000.0, "episode_duration_sec_mean": 0.03683088699004655, "env_step_timer": 4.322309896885769e-05, "episode_return_mean": 4.100000000000001, "sample": 0.03808263288391785, "env_to_module_connector": {"timers": {"connectors": {"add_time_dim_to_batch_and_zero_pad": 6.328475042504832e-06, "numpy_to_tensor": 3.1612829169995477e-05, "add_states_from_episodes_to_batch": 3.5303808661052925e-06, "add_observations_from_episodes_to_batch": 6.2697267652759065e-06, "batch_individual_items": 1.8494998467147198e-05}}, "connector_pipeline_timer": 0.00011936501055337159}, "num_episodes": 100.0, "num_module_steps_sampled_lifetime": {"default_policy": -3870000.0}, "episode_return_max": 14.5, "num_env_steps_sampled_lifetime": -3870000.0, "episode_len_mean": 50.0, "num_agent_steps_sampled_lifetime": {"default_agent": -3870000.0}, "episode_len_max": 50, "env_reset_timer": 9.440269933646796e-05, "num_module_steps_sampled": {"default_policy": 5000.0}, "num_episodes_lifetime": -77400.0, "episode_return_min": -5.5, "time_between_sampling": 0.012560640610817582, "rlmodule_inference_timer": 0.0001012520319973224, "episode_len_min": 50, "weights_seq_no": 17.0, "module_episode_returns_mean": {"default_policy": 4.100000000000001}, "agent_episode_returns_mean": {"default_agent": 4.100000000000001}, "num_env_steps_sampled_lifetime_throughput": 1269.3413828241219}, "learners": {"__all_modules__": {"learner_connector": {"timers": {"connectors": {"add_columns_from_episodes_to_train_batch": 0.06858543793928565, "general_advantage_estimation": 0.01127704765658311, "add_observations_from_episodes_to_batch": 0.0007634089434374069, "add_time_dim_to_batch_and_zero_pad": 2.1612948209315332e-05, "add_states_from_episodes_to_batch": 5.644299325993194e-06, "add_one_ts_to_episodes_and_truncate": 0.008482027444134678, "numpy_to_tensor": 0.00016563468311083898, "batch_individual_items": 0.19186408430048177}}, "connector_pipeline_timer": 0.28147958982741206}, "num_module_steps_trained": 16000, "num_non_trainable_parameters": 0, "num_module_steps_trained_lifetime": 288000, "learner_connector_sum_episodes_length_out": 5100.0, "learner_connector_sum_episodes_length_in": 5000.0, "num_trainable_parameters": 7067, "num_env_steps_trained_lifetime": 1468800, "num_env_steps_trained": 81600, "num_env_steps_trained_lifetime_throughput": 963591.4902987968, "num_module_steps_trained_throughput": 189313.8184078159, "num_module_steps_trained_lifetime_throughput": 189224.57943511027}, "default_policy": {"num_module_steps_trained": 16000, "vf_explained_var": 0.013027012348175049, "num_module_steps_trained_lifetime": 288000, "module_train_batch_size_mean": 1000.0, "curr_kl_coeff": 5.660186275235901e-07, "policy_loss": 0.011318473145365715, "mean_kl_loss": 7.725509476586012e-07, "vf_loss": 0.09358201175928116, "default_optimizer_learning_rate": 1.02025592e-05, "total_loss": 0.0869821235537529, "num_trainable_parameters": 7067, "gradients_default_optimizer_global_norm": 0.08448582887649536, "curr_entropy_coeff": 0.0028379241987, "vf_loss_unclipped": 11.814176559448242, "entropy": 0.691348135471344, "weights_seq_no": 18.0, "diff_num_grad_updates_vs_sampler_policy": 1.0, "num_module_steps_trained_lifetime_throughput": 189427.61991775245}}, "num_training_step_calls_per_iteration": 1, "evaluation": {"env_runners": {"module_to_env_connector": {"timers": {"connectors": {"tensor_to_numpy": 4.554155406110132e-05, "get_actions": 0.00015558571030344803, "remove_single_ts_time_rank_from_batch": 1.6868958189558479e-06, "normalize_and_clip_actions": 2.2193544289360028e-05, "un_batch_to_individual_items": 1.5756050788140986e-05, "listify_data_for_vector_env": 3.040344660354622e-05}}, "connector_pipeline_timer": 0.0003445402089185607}, "env_reset_timer": 0.00023294037895713187, "env_to_module_connector": {"timers": {"connectors": {"add_observations_from_episodes_to_batch": 6.851671263788149e-06, "add_states_from_episodes_to_batch": 3.295961450426972e-06, "add_time_dim_to_batch_and_zero_pad": 6.007291659901224e-06, "batch_individual_items": 1.8430731576225985e-05, "numpy_to_tensor": 2.8865306618801857e-05}}, "connector_pipeline_timer": 0.00011330468252511201}, "num_episodes_lifetime": 360, "rlmodule_inference_timer": 9.464094061994881e-05, "num_module_steps_sampled": {"default_policy": 1000}, "agent_episode_returns_mean": {"default_agent": -1.1}, "num_env_steps_sampled_lifetime": 91000, "episode_len_max": 50, "num_module_steps_sampled_lifetime": {"default_policy": 18000}, "weights_seq_no": 18.0, "num_agent_steps_sampled_lifetime": {"default_agent": 18000}, "env_to_module_sum_episodes_length_in": 27.168093332126602, "env_to_module_sum_episodes_length_out": 27.168093332126602, "env_step_timer": 4.2337809996088585e-05, "sample": 0.7327639984552143, "num_episodes": 20, "module_episode_returns_mean": {"default_policy": -1.1}, "episode_return_min": -16.5, "episode_len_min": 50, "num_env_steps_sampled": 1000, "episode_return_mean": -1.1, "episode_return_max": 17.5, "num_agent_steps_sampled": {"default_agent": 1000}, "episode_len_mean": 50.0, "episode_duration_sec_mean": 0.035182804989999567, "time_between_sampling": 4.246540580363882}, "num_healthy_workers": 1, "actor_manager_num_outstanding_async_reqs": 0, "num_remote_worker_restarts": 0}, "num_env_steps_sampled_lifetime": -3870000.0, "fault_tolerance": {"num_healthy_workers": 0, "num_remote_worker_restarts": 0}, "env_runner_group": {"actor_manager_num_outstanding_async_reqs": 0}, "done": false, "training_iteration": 18, "trial_id": "af017_00000", "date": "2025-08-11_17-17-08", "timestamp": 1754925428, "time_this_iter_s": 4.915543556213379, "time_total_s": 90.13040924072266, "pid": 67771, "hostname": "DESKTOP-3SK5A41", "node_ip": "192.168.40.242", "config": {"exploration_config": {}, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 6, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "env": "Umbrella", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": false, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 0, "create_local_env_runner": true, "num_envs_per_env_runner": 1, "gym_env_vectorize_mode": "SYNC", "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "episodes_to_numpy": true, "max_requests_in_flight_per_env_runner": 1, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "merge_env_runner_states": "training_only", "broadcast_env_runner_states": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "complete_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "sampler_perf_stats_ema_coef": null, "_is_online": true, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": "auto", "num_aggregator_actors_per_learner": 0, "max_requests_in_flight_per_aggregator_actor": 3, "local_gpu_idx": 0, "max_requests_in_flight_per_learner": 3, "gamma": 1, "lr": 1.02025592e-05, "grad_clip": 0.5, "grad_clip_by": "global_norm", "_train_batch_size_per_learner": 5000, "train_batch_size": 4000, "num_epochs": 3, "minibatch_size": 1000, "shuffle_batch_per_epoch": true, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "log_std_clip_param": 20.0, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "_disable_preprocessor_api": false, "_disable_action_flattening": false}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "_learner_class": null, "callbacks_on_algorithm_init": null, "callbacks_on_env_runners_recreated": null, "callbacks_on_offline_eval_runners_recreated": null, "callbacks_on_checkpoint_loaded": null, "callbacks_on_environment_created": null, "callbacks_on_episode_created": null, "callbacks_on_episode_start": null, "callbacks_on_episode_step": null, "callbacks_on_episode_end": null, "callbacks_on_evaluate_start": null, "callbacks_on_evaluate_end": null, "callbacks_on_evaluate_offline_start": null, "callbacks_on_evaluate_offline_end": null, "callbacks_on_sample_end": null, "callbacks_on_train_result": null, "explore": true, "enable_rl_module_and_learner": true, "enable_env_runner_and_connector_v2": true, "_prior_exploration_config": {"type": "StochasticSampling"}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x77ab39ecaac0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "offline_data_class": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_read_batch_size": null, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "materialize_data": false, "materialize_mapped_data": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "ignore_final_observation": false, "prelearner_class": null, "prelearner_buffer_class": null, "prelearner_buffer_kwargs": {}, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_remaining_data": false, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": 1, "evaluation_duration": 20, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_auto_duration_min_env_steps_per_sample": 100, "evaluation_auto_duration_max_env_steps_per_sample": 2000, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 1, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "offline_evaluation_interval": null, "num_offline_eval_runners": 0, "offline_loss_for_module_fn": null, "offline_evaluation_duration": 1, "offline_evaluation_parallel_to_training": false, "offline_evaluation_timeout_s": 120.0, "num_cpus_per_offline_eval_runner": 1, "num_gpus_per_offline_eval_runner": 0, "custom_resources_per_offline_eval_runner": {}, "restart_failed_offline_eval_runners": true, "ignore_offline_eval_runner_failures": false, "max_num_offline_eval_runner_restarts": 1000, "offline_eval_runner_restore_timeout_s": 1800.0, "max_requests_in_flight_per_offline_eval_runner": 1, "validate_offline_eval_runners_after_construction": true, "offline_eval_runner_health_probe_timeout_s": 30.0, "offline_eval_rl_module_inference_only": false, "broadcast_offline_eval_runner_states": false, "offline_eval_batch_size_per_runner": 256, "dataset_num_iters_per_eval_runner": 1, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "log_gradients": true, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 42, "restart_failed_env_runners": true, "ignore_env_runner_failures": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30.0, "env_runner_restore_timeout_s": 1800.0, "_model_config": {}, "_rl_module_spec": "RLModuleSpec(module_class=None, observation_space=None, action_space=None, inference_only=False, learner_only=False, model_config=DefaultModelConfig(fcnet_hiddens=[114, 56], fcnet_activation='tanh', fcnet_kernel_initializer=None, fcnet_kernel_initializer_kwargs=None, fcnet_bias_initializer=None, fcnet_bias_initializer_kwargs=None, conv_filters=None, conv_activation='relu', conv_kernel_initializer=None, conv_kernel_initializer_kwargs=None, conv_bias_initializer=None, conv_bias_initializer_kwargs=None, head_fcnet_hiddens=[], head_fcnet_activation='relu', head_fcnet_kernel_initializer=None, head_fcnet_kernel_initializer_kwargs=None, head_fcnet_bias_initializer=None, head_fcnet_bias_initializer_kwargs=None, free_log_std=False, log_std_clip_param=20.0, vf_share_layers=True, use_lstm=False, max_seq_len=20, lstm_cell_size=256, lstm_use_prev_action=False, lstm_use_prev_reward=False, lstm_kernel_initializer=None, lstm_kernel_initializer_kwargs=None, lstm_bias_initializer=None, lstm_bias_initializer_kwargs=None), catalog_class=None, load_state_path=None, model_config_dict=None)", "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "_validate_config": true, "_use_msgpack_checkpoints": false, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "env_task_fn": -1, "enable_connectors": -1, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.1483783801338, "kl_target": 0.0299561178854, "vf_loss_coeff": 0.8294931856016, "entropy_coeff": 0.0028379241987, "clip_param": 0.2023271755792, "vf_clip_param": 0.1015383331916, "entropy_coeff_schedule": null, "lr_schedule": null, "sgd_minibatch_size": -1, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9059303202574, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.callbacks.callbacks.RLlibCallback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 90.13040924072266, "iterations_since_restore": 18, "perf": {"cpu_util_percent": 12.057142857142859, "ram_util_percent": 74.3}}
{"timers": {"training_iteration": 4.3188633416998865, "restore_env_runners": 1.4744744578395972e-05, "training_step": 4.318551218275343, "env_runner_sampling_timer": 3.869101039676644, "learner_update_timer": 0.4457945620026641, "synch_weights": 0.0015141648243764659, "restore_eval_env_runners": 1.3074595586452993e-05, "evaluation_iteration": 0.7447890004723364, "synch_eval_env_connectors": 0.00048494518539772004, "synch_env_connectors": 8.186602508466158e-06}, "env_runners": {"env_to_module_sum_episodes_length_in": 27.16809333212661, "module_to_env_connector": {"timers": {"connectors": {"listify_data_for_vector_env": 3.0992000314342516e-05, "un_batch_to_individual_items": 1.4499135705885456e-05, "get_actions": 0.00016805488609994003, "tensor_to_numpy": 4.98570795449419e-05, "remove_single_ts_time_rank_from_batch": 1.4844756777919926e-06, "normalize_and_clip_actions": 2.2711566581279594e-05}}, "connector_pipeline_timer": 0.00036617250389461104}, "num_agent_steps_sampled": {"default_agent": 5000.0}, "env_to_module_sum_episodes_length_out": 27.16809333212661, "num_env_steps_sampled": 5000.0, "episode_duration_sec_mean": 0.03691263298000193, "env_step_timer": 4.3289918848482136e-05, "episode_return_mean": 4.5, "sample": 0.037955273486627, "env_to_module_connector": {"timers": {"connectors": {"add_time_dim_to_batch_and_zero_pad": 6.387009147593429e-06, "numpy_to_tensor": 3.1733533950437266e-05, "add_states_from_episodes_to_batch": 3.537191206447489e-06, "add_observations_from_episodes_to_batch": 6.339416480545457e-06, "batch_individual_items": 1.849234109256587e-05}}, "connector_pipeline_timer": 0.0001200045929483629}, "num_episodes": 100.0, "num_module_steps_sampled_lifetime": {"default_policy": -4112500.0}, "episode_return_max": 14.5, "num_env_steps_sampled_lifetime": -4112500.0, "episode_len_mean": 50.0, "num_agent_steps_sampled_lifetime": {"default_agent": -4112500.0}, "episode_len_max": 50, "env_reset_timer": 9.306445643481142e-05, "num_module_steps_sampled": {"default_policy": 5000.0}, "num_episodes_lifetime": -82250.0, "episode_return_min": -5.5, "time_between_sampling": 0.01198923606011422, "rlmodule_inference_timer": 0.00010132023323448057, "episode_len_min": 50, "weights_seq_no": 18.0, "module_episode_returns_mean": {"default_policy": 4.5}, "agent_episode_returns_mean": {"default_agent": 4.5}, "num_env_steps_sampled_lifetime_throughput": 1269.394775231275}, "learners": {"__all_modules__": {"learner_connector": {"timers": {"connectors": {"add_columns_from_episodes_to_train_batch": 0.0685718925598942, "general_advantage_estimation": 0.011261144180019299, "add_observations_from_episodes_to_batch": 0.0007629588539994469, "add_time_dim_to_batch_and_zero_pad": 2.1616818728940466e-05, "add_states_from_episodes_to_batch": 5.641856334643288e-06, "add_one_ts_to_episodes_and_truncate": 0.008478627169699222, "numpy_to_tensor": 0.00016586233628270464, "batch_individual_items": 0.19197875445747253}}, "connector_pipeline_timer": 0.2815612849291393}, "num_module_steps_trained": 16000, "num_non_trainable_parameters": 0, "num_module_steps_trained_lifetime": 304000, "learner_connector_sum_episodes_length_out": 5100.0, "learner_connector_sum_episodes_length_in": 5000.0, "num_trainable_parameters": 7067, "num_env_steps_trained_lifetime": 1550400, "num_env_steps_trained": 81600, "num_env_steps_trained_lifetime_throughput": 960213.9800225308, "num_module_steps_trained_throughput": 188635.17983041538, "num_module_steps_trained_lifetime_throughput": 188548.61823599512}, "default_policy": {"num_module_steps_trained": 16000, "vf_explained_var": 0.014323413372039795, "num_module_steps_trained_lifetime": 304000, "module_train_batch_size_mean": 1000.0, "curr_kl_coeff": 2.8300931376179506e-07, "policy_loss": 0.019666358828544617, "mean_kl_loss": 1.7697315342957154e-05, "vf_loss": 0.09363152831792831, "default_optimizer_learning_rate": 1.02025592e-05, "total_loss": 0.09537214040756226, "num_trainable_parameters": 7067, "gradients_default_optimizer_global_norm": 0.06993516534566879, "curr_entropy_coeff": 0.0028379241987, "vf_loss_unclipped": 10.541501998901367, "entropy": 0.6909791231155396, "weights_seq_no": 19.0, "diff_num_grad_updates_vs_sampler_policy": 1.0, "num_module_steps_trained_lifetime_throughput": 188739.8311613088}}, "num_training_step_calls_per_iteration": 1, "evaluation": {"env_runners": {"module_to_env_connector": {"timers": {"connectors": {"tensor_to_numpy": 4.5568247502556313e-05, "get_actions": 0.00015739639826914178, "remove_single_ts_time_rank_from_batch": 1.5437732280665302e-06, "normalize_and_clip_actions": 2.2005950554373078e-05, "un_batch_to_individual_items": 1.5677712999558892e-05, "listify_data_for_vector_env": 3.147906760727496e-05}}, "connector_pipeline_timer": 0.00034712585171147164}, "env_reset_timer": 0.0002326449751667453, "env_to_module_connector": {"timers": {"connectors": {"add_observations_from_episodes_to_batch": 6.720021755318126e-06, "add_states_from_episodes_to_batch": 3.6738619008641514e-06, "add_time_dim_to_batch_and_zero_pad": 6.312170825670667e-06, "batch_individual_items": 1.868926239340901e-05, "numpy_to_tensor": 2.9989918138957485e-05}}, "connector_pipeline_timer": 0.00011670850182358501}, "num_episodes_lifetime": 380, "rlmodule_inference_timer": 9.538125424845786e-05, "num_module_steps_sampled": {"default_policy": 1000}, "agent_episode_returns_mean": {"default_agent": -2.5}, "num_env_steps_sampled_lifetime": 96000, "episode_len_max": 50, "num_module_steps_sampled_lifetime": {"default_policy": 19000}, "weights_seq_no": 19.0, "num_agent_steps_sampled_lifetime": {"default_agent": 19000}, "env_to_module_sum_episodes_length_in": 27.168093332126602, "env_to_module_sum_episodes_length_out": 27.168093332126602, "env_step_timer": 4.2097544577268805e-05, "sample": 0.7327580324406624, "num_episodes": 20, "module_episode_returns_mean": {"default_policy": -2.5}, "episode_return_min": -16.5, "episode_len_min": 50, "num_env_steps_sampled": 1000, "episode_return_mean": -2.5, "episode_return_max": 17.5, "num_agent_steps_sampled": {"default_agent": 1000}, "episode_len_mean": 50.0, "episode_duration_sec_mean": 0.03518009696997069, "time_between_sampling": 4.247930212540245}, "num_healthy_workers": 1, "actor_manager_num_outstanding_async_reqs": 0, "num_remote_worker_restarts": 0}, "num_env_steps_sampled_lifetime": -4112500.0, "fault_tolerance": {"num_healthy_workers": 0, "num_remote_worker_restarts": 0}, "env_runner_group": {"actor_manager_num_outstanding_async_reqs": 0}, "done": false, "training_iteration": 19, "trial_id": "af017_00000", "date": "2025-08-11_17-17-13", "timestamp": 1754925433, "time_this_iter_s": 5.078489780426025, "time_total_s": 95.20889902114868, "pid": 67771, "hostname": "DESKTOP-3SK5A41", "node_ip": "192.168.40.242", "config": {"exploration_config": {}, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 6, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "env": "Umbrella", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": false, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 0, "create_local_env_runner": true, "num_envs_per_env_runner": 1, "gym_env_vectorize_mode": "SYNC", "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "episodes_to_numpy": true, "max_requests_in_flight_per_env_runner": 1, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "merge_env_runner_states": "training_only", "broadcast_env_runner_states": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "complete_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "sampler_perf_stats_ema_coef": null, "_is_online": true, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": "auto", "num_aggregator_actors_per_learner": 0, "max_requests_in_flight_per_aggregator_actor": 3, "local_gpu_idx": 0, "max_requests_in_flight_per_learner": 3, "gamma": 1, "lr": 1.02025592e-05, "grad_clip": 0.5, "grad_clip_by": "global_norm", "_train_batch_size_per_learner": 5000, "train_batch_size": 4000, "num_epochs": 3, "minibatch_size": 1000, "shuffle_batch_per_epoch": true, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "log_std_clip_param": 20.0, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "_disable_preprocessor_api": false, "_disable_action_flattening": false}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "_learner_class": null, "callbacks_on_algorithm_init": null, "callbacks_on_env_runners_recreated": null, "callbacks_on_offline_eval_runners_recreated": null, "callbacks_on_checkpoint_loaded": null, "callbacks_on_environment_created": null, "callbacks_on_episode_created": null, "callbacks_on_episode_start": null, "callbacks_on_episode_step": null, "callbacks_on_episode_end": null, "callbacks_on_evaluate_start": null, "callbacks_on_evaluate_end": null, "callbacks_on_evaluate_offline_start": null, "callbacks_on_evaluate_offline_end": null, "callbacks_on_sample_end": null, "callbacks_on_train_result": null, "explore": true, "enable_rl_module_and_learner": true, "enable_env_runner_and_connector_v2": true, "_prior_exploration_config": {"type": "StochasticSampling"}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x77ab39ecaac0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "offline_data_class": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_read_batch_size": null, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "materialize_data": false, "materialize_mapped_data": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "ignore_final_observation": false, "prelearner_class": null, "prelearner_buffer_class": null, "prelearner_buffer_kwargs": {}, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_remaining_data": false, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": 1, "evaluation_duration": 20, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_auto_duration_min_env_steps_per_sample": 100, "evaluation_auto_duration_max_env_steps_per_sample": 2000, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 1, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "offline_evaluation_interval": null, "num_offline_eval_runners": 0, "offline_loss_for_module_fn": null, "offline_evaluation_duration": 1, "offline_evaluation_parallel_to_training": false, "offline_evaluation_timeout_s": 120.0, "num_cpus_per_offline_eval_runner": 1, "num_gpus_per_offline_eval_runner": 0, "custom_resources_per_offline_eval_runner": {}, "restart_failed_offline_eval_runners": true, "ignore_offline_eval_runner_failures": false, "max_num_offline_eval_runner_restarts": 1000, "offline_eval_runner_restore_timeout_s": 1800.0, "max_requests_in_flight_per_offline_eval_runner": 1, "validate_offline_eval_runners_after_construction": true, "offline_eval_runner_health_probe_timeout_s": 30.0, "offline_eval_rl_module_inference_only": false, "broadcast_offline_eval_runner_states": false, "offline_eval_batch_size_per_runner": 256, "dataset_num_iters_per_eval_runner": 1, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "log_gradients": true, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 42, "restart_failed_env_runners": true, "ignore_env_runner_failures": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30.0, "env_runner_restore_timeout_s": 1800.0, "_model_config": {}, "_rl_module_spec": "RLModuleSpec(module_class=None, observation_space=None, action_space=None, inference_only=False, learner_only=False, model_config=DefaultModelConfig(fcnet_hiddens=[114, 56], fcnet_activation='tanh', fcnet_kernel_initializer=None, fcnet_kernel_initializer_kwargs=None, fcnet_bias_initializer=None, fcnet_bias_initializer_kwargs=None, conv_filters=None, conv_activation='relu', conv_kernel_initializer=None, conv_kernel_initializer_kwargs=None, conv_bias_initializer=None, conv_bias_initializer_kwargs=None, head_fcnet_hiddens=[], head_fcnet_activation='relu', head_fcnet_kernel_initializer=None, head_fcnet_kernel_initializer_kwargs=None, head_fcnet_bias_initializer=None, head_fcnet_bias_initializer_kwargs=None, free_log_std=False, log_std_clip_param=20.0, vf_share_layers=True, use_lstm=False, max_seq_len=20, lstm_cell_size=256, lstm_use_prev_action=False, lstm_use_prev_reward=False, lstm_kernel_initializer=None, lstm_kernel_initializer_kwargs=None, lstm_bias_initializer=None, lstm_bias_initializer_kwargs=None), catalog_class=None, load_state_path=None, model_config_dict=None)", "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "_validate_config": true, "_use_msgpack_checkpoints": false, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "env_task_fn": -1, "enable_connectors": -1, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.1483783801338, "kl_target": 0.0299561178854, "vf_loss_coeff": 0.8294931856016, "entropy_coeff": 0.0028379241987, "clip_param": 0.2023271755792, "vf_clip_param": 0.1015383331916, "entropy_coeff_schedule": null, "lr_schedule": null, "sgd_minibatch_size": -1, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9059303202574, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.callbacks.callbacks.RLlibCallback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 95.20889902114868, "iterations_since_restore": 19, "perf": {"cpu_util_percent": 12.357142857142858, "ram_util_percent": 74.3}}
{"timers": {"training_iteration": 4.317591476122882, "restore_env_runners": 1.471129713664429e-05, "training_step": 4.3172789459325855, "env_runner_sampling_timer": 3.8698723421298777, "learner_update_timer": 0.4437509443726374, "synch_weights": 0.001513446176135054, "restore_eval_env_runners": 1.3057849625525794e-05, "evaluation_iteration": 0.7447642144376083, "synch_eval_env_connectors": 0.0004843347335436133, "synch_env_connectors": 8.185736481699062e-06}, "env_runners": {"env_to_module_sum_episodes_length_in": 27.16809333212661, "module_to_env_connector": {"timers": {"connectors": {"listify_data_for_vector_env": 3.087445909926578e-05, "un_batch_to_individual_items": 1.45842126436623e-05, "get_actions": 0.00016789042641821312, "tensor_to_numpy": 4.985422593365058e-05, "remove_single_ts_time_rank_from_batch": 1.4824173690016515e-06, "normalize_and_clip_actions": 2.2900078184767818e-05}}, "connector_pipeline_timer": 0.0003660904837637641}, "num_agent_steps_sampled": {"default_agent": 5000.0}, "env_to_module_sum_episodes_length_out": 27.16809333212661, "num_env_steps_sampled": 5000.0, "episode_duration_sec_mean": 0.036933649870024954, "env_step_timer": 4.3474027470972455e-05, "episode_return_mean": 5.100000000000001, "sample": 0.03801128628004979, "env_to_module_connector": {"timers": {"connectors": {"add_time_dim_to_batch_and_zero_pad": 6.352553471470651e-06, "numpy_to_tensor": 3.181770545702342e-05, "add_states_from_episodes_to_batch": 3.4895333185586015e-06, "add_observations_from_episodes_to_batch": 6.281062159244665e-06, "batch_individual_items": 1.848594384931103e-05}}, "connector_pipeline_timer": 0.00011964753761768326}, "num_episodes": 100.0, "num_module_steps_sampled_lifetime": {"default_policy": -4355000.0}, "episode_return_max": 14.5, "num_env_steps_sampled_lifetime": -4355000.0, "episode_len_mean": 50.0, "num_agent_steps_sampled_lifetime": {"default_agent": -4355000.0}, "episode_len_max": 50, "env_reset_timer": 9.383339390524602e-05, "num_module_steps_sampled": {"default_policy": 5000.0}, "num_episodes_lifetime": -87100.0, "episode_return_min": -5.5, "time_between_sampling": 0.012797040257353374, "rlmodule_inference_timer": 0.00010145722586036904, "episode_len_min": 50, "weights_seq_no": 19.0, "module_episode_returns_mean": {"default_policy": 5.100000000000001}, "agent_episode_returns_mean": {"default_agent": 5.100000000000001}, "num_env_steps_sampled_lifetime_throughput": 1265.8397733837235}, "learners": {"__all_modules__": {"learner_connector": {"timers": {"connectors": {"add_columns_from_episodes_to_train_batch": 0.06856016463429855, "general_advantage_estimation": 0.011249412738219068, "add_observations_from_episodes_to_batch": 0.000762659265457999, "add_time_dim_to_batch_and_zero_pad": 2.1609650541464447e-05, "add_states_from_episodes_to_batch": 5.635437770033749e-06, "add_one_ts_to_episodes_and_truncate": 0.008474967898005337, "numpy_to_tensor": 0.000165870712916692, "batch_individual_items": 0.190641288912898}}, "connector_pipeline_timer": 0.2801965050798469}, "num_module_steps_trained": 16000, "num_non_trainable_parameters": 0, "num_module_steps_trained_lifetime": 320000, "learner_connector_sum_episodes_length_out": 5100.0, "learner_connector_sum_episodes_length_in": 5000.0, "num_trainable_parameters": 7067, "num_env_steps_trained_lifetime": 1632000, "num_env_steps_trained": 81600, "num_env_steps_trained_lifetime_throughput": 955406.3535812639, "num_module_steps_trained_throughput": 187678.8810824836, "num_module_steps_trained_lifetime_throughput": 187593.79644087257}, "default_policy": {"num_module_steps_trained": 16000, "vf_explained_var": 0.012503862380981445, "num_module_steps_trained_lifetime": 320000, "module_train_batch_size_mean": 1000.0, "curr_kl_coeff": 1.4150465688089753e-07, "policy_loss": -0.0037324202712625265, "mean_kl_loss": 1.0410850336484145e-05, "vf_loss": 0.09491168707609177, "default_optimizer_learning_rate": 1.02025592e-05, "total_loss": 0.07303602248430252, "num_trainable_parameters": 7067, "gradients_default_optimizer_global_norm": 0.05621599778532982, "curr_entropy_coeff": 0.0028379241987, "vf_loss_unclipped": 12.099662780761719, "entropy": 0.6907026767730713, "weights_seq_no": 20.0, "diff_num_grad_updates_vs_sampler_policy": 1.0, "num_module_steps_trained_lifetime_throughput": 187775.43904915222}}, "num_training_step_calls_per_iteration": 1, "evaluation": {"env_runners": {"module_to_env_connector": {"timers": {"connectors": {"tensor_to_numpy": 4.602069742276305e-05, "get_actions": 0.0001566183548929661, "remove_single_ts_time_rank_from_batch": 1.3655389114192477e-06, "normalize_and_clip_actions": 2.235457901932265e-05, "un_batch_to_individual_items": 1.572234792986485e-05, "listify_data_for_vector_env": 3.1794139571821346e-05}}, "connector_pipeline_timer": 0.0003469394026372539}, "env_reset_timer": 0.00023155552542093597, "env_to_module_connector": {"timers": {"connectors": {"add_observations_from_episodes_to_batch": 6.459255821206603e-06, "add_states_from_episodes_to_batch": 3.34137916839706e-06, "add_time_dim_to_batch_and_zero_pad": 6.411609317504482e-06, "batch_individual_items": 1.8868961286899043e-05, "numpy_to_tensor": 3.0448489357606778e-05}}, "connector_pipeline_timer": 0.00011552846702969359}, "num_episodes_lifetime": 400, "rlmodule_inference_timer": 9.639622173782658e-05, "num_module_steps_sampled": {"default_policy": 1000}, "agent_episode_returns_mean": {"default_agent": -2.1}, "num_env_steps_sampled_lifetime": 101000, "episode_len_max": 50, "num_module_steps_sampled_lifetime": {"default_policy": 20000}, "weights_seq_no": 20.0, "num_agent_steps_sampled_lifetime": {"default_agent": 20000}, "env_to_module_sum_episodes_length_in": 27.168093332126602, "env_to_module_sum_episodes_length_out": 27.168093332126602, "env_step_timer": 4.2335091618805486e-05, "sample": 0.732777500086253, "num_episodes": 20, "module_episode_returns_mean": {"default_policy": -2.1}, "episode_return_min": -16.5, "episode_len_min": 50, "num_env_steps_sampled": 1000, "episode_return_mean": -2.1, "episode_return_max": 17.5, "num_agent_steps_sampled": {"default_agent": 1000}, "episode_len_mean": 50.0, "episode_duration_sec_mean": 0.03521227493993138, "time_between_sampling": 4.247959192254844}, "num_healthy_workers": 1, "actor_manager_num_outstanding_async_reqs": 0, "num_remote_worker_restarts": 0}, "num_env_steps_sampled_lifetime": -4355000.0, "fault_tolerance": {"num_healthy_workers": 0, "num_remote_worker_restarts": 0}, "env_runner_group": {"actor_manager_num_outstanding_async_reqs": 0}, "done": true, "training_iteration": 20, "trial_id": "af017_00000", "date": "2025-08-11_17-17-18", "timestamp": 1754925438, "time_this_iter_s": 4.941364049911499, "time_total_s": 100.15026307106018, "pid": 67771, "hostname": "DESKTOP-3SK5A41", "node_ip": "192.168.40.242", "config": {"exploration_config": {}, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 6, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "env": "Umbrella", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": false, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 0, "create_local_env_runner": true, "num_envs_per_env_runner": 1, "gym_env_vectorize_mode": "SYNC", "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "episodes_to_numpy": true, "max_requests_in_flight_per_env_runner": 1, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "merge_env_runner_states": "training_only", "broadcast_env_runner_states": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "complete_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "sampler_perf_stats_ema_coef": null, "_is_online": true, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": "auto", "num_aggregator_actors_per_learner": 0, "max_requests_in_flight_per_aggregator_actor": 3, "local_gpu_idx": 0, "max_requests_in_flight_per_learner": 3, "gamma": 1, "lr": 1.02025592e-05, "grad_clip": 0.5, "grad_clip_by": "global_norm", "_train_batch_size_per_learner": 5000, "train_batch_size": 4000, "num_epochs": 3, "minibatch_size": 1000, "shuffle_batch_per_epoch": true, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "log_std_clip_param": 20.0, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "_disable_preprocessor_api": false, "_disable_action_flattening": false}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "_learner_class": null, "callbacks_on_algorithm_init": null, "callbacks_on_env_runners_recreated": null, "callbacks_on_offline_eval_runners_recreated": null, "callbacks_on_checkpoint_loaded": null, "callbacks_on_environment_created": null, "callbacks_on_episode_created": null, "callbacks_on_episode_start": null, "callbacks_on_episode_step": null, "callbacks_on_episode_end": null, "callbacks_on_evaluate_start": null, "callbacks_on_evaluate_end": null, "callbacks_on_evaluate_offline_start": null, "callbacks_on_evaluate_offline_end": null, "callbacks_on_sample_end": null, "callbacks_on_train_result": null, "explore": true, "enable_rl_module_and_learner": true, "enable_env_runner_and_connector_v2": true, "_prior_exploration_config": {"type": "StochasticSampling"}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x77ab39ecaac0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "offline_data_class": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_read_batch_size": null, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "materialize_data": false, "materialize_mapped_data": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "ignore_final_observation": false, "prelearner_class": null, "prelearner_buffer_class": null, "prelearner_buffer_kwargs": {}, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_remaining_data": false, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": 1, "evaluation_duration": 20, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_auto_duration_min_env_steps_per_sample": 100, "evaluation_auto_duration_max_env_steps_per_sample": 2000, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 1, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "offline_evaluation_interval": null, "num_offline_eval_runners": 0, "offline_loss_for_module_fn": null, "offline_evaluation_duration": 1, "offline_evaluation_parallel_to_training": false, "offline_evaluation_timeout_s": 120.0, "num_cpus_per_offline_eval_runner": 1, "num_gpus_per_offline_eval_runner": 0, "custom_resources_per_offline_eval_runner": {}, "restart_failed_offline_eval_runners": true, "ignore_offline_eval_runner_failures": false, "max_num_offline_eval_runner_restarts": 1000, "offline_eval_runner_restore_timeout_s": 1800.0, "max_requests_in_flight_per_offline_eval_runner": 1, "validate_offline_eval_runners_after_construction": true, "offline_eval_runner_health_probe_timeout_s": 30.0, "offline_eval_rl_module_inference_only": false, "broadcast_offline_eval_runner_states": false, "offline_eval_batch_size_per_runner": 256, "dataset_num_iters_per_eval_runner": 1, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "log_gradients": true, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 42, "restart_failed_env_runners": true, "ignore_env_runner_failures": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30.0, "env_runner_restore_timeout_s": 1800.0, "_model_config": {}, "_rl_module_spec": "RLModuleSpec(module_class=None, observation_space=None, action_space=None, inference_only=False, learner_only=False, model_config=DefaultModelConfig(fcnet_hiddens=[114, 56], fcnet_activation='tanh', fcnet_kernel_initializer=None, fcnet_kernel_initializer_kwargs=None, fcnet_bias_initializer=None, fcnet_bias_initializer_kwargs=None, conv_filters=None, conv_activation='relu', conv_kernel_initializer=None, conv_kernel_initializer_kwargs=None, conv_bias_initializer=None, conv_bias_initializer_kwargs=None, head_fcnet_hiddens=[], head_fcnet_activation='relu', head_fcnet_kernel_initializer=None, head_fcnet_kernel_initializer_kwargs=None, head_fcnet_bias_initializer=None, head_fcnet_bias_initializer_kwargs=None, free_log_std=False, log_std_clip_param=20.0, vf_share_layers=True, use_lstm=False, max_seq_len=20, lstm_cell_size=256, lstm_use_prev_action=False, lstm_use_prev_reward=False, lstm_kernel_initializer=None, lstm_kernel_initializer_kwargs=None, lstm_bias_initializer=None, lstm_bias_initializer_kwargs=None), catalog_class=None, load_state_path=None, model_config_dict=None)", "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "_validate_config": true, "_use_msgpack_checkpoints": false, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "env_task_fn": -1, "enable_connectors": -1, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.1483783801338, "kl_target": 0.0299561178854, "vf_loss_coeff": 0.8294931856016, "entropy_coeff": 0.0028379241987, "clip_param": 0.2023271755792, "vf_clip_param": 0.1015383331916, "entropy_coeff_schedule": null, "lr_schedule": null, "sgd_minibatch_size": -1, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9059303202574, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.callbacks.callbacks.RLlibCallback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 100.15026307106018, "iterations_since_restore": 20, "perf": {"cpu_util_percent": 12.371428571428572, "ram_util_percent": 74.3}}
