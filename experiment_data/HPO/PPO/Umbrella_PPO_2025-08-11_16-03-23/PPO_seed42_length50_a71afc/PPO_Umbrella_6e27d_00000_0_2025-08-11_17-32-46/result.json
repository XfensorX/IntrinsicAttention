{"timers": {"training_iteration": 4.1482309030006945, "restore_env_runners": 1.4600000213249587e-05, "training_step": 4.148030402999211, "env_runner_sampling_timer": 3.744952103000287, "learner_update_timer": 0.39974830000028305, "synch_weights": 0.001403299999765295}, "env_runners": {"num_episodes_lifetime": 5050.0, "env_to_module_connector": {"timers": {"connectors": {"add_observations_from_episodes_to_batch": 6.134508413650874e-06, "numpy_to_tensor": 3.070064358007512e-05, "add_time_dim_to_batch_and_zero_pad": 6.36221194704075e-06, "batch_individual_items": 1.8676840840741037e-05, "add_states_from_episodes_to_batch": 3.4528217361644877e-06}}, "connector_pipeline_timer": 0.00011927502050522858}, "agent_episode_returns_mean": {"default_agent": 8.5}, "module_episode_returns_mean": {"default_policy": 8.5}, "num_episodes": 100.0, "time_between_sampling": 0.0012273568888611767, "num_agent_steps_sampled": {"default_agent": 5000.0}, "num_agent_steps_sampled_lifetime": {"default_agent": 252500.0}, "episode_len_max": 50, "rlmodule_inference_timer": 0.00010073032739496963, "sample": 0.03865657820820785, "module_to_env_connector": {"timers": {"connectors": {"un_batch_to_individual_items": 1.4540046533826852e-05, "normalize_and_clip_actions": 2.7695828218614477e-05, "tensor_to_numpy": 4.653982372868781e-05, "listify_data_for_vector_env": 3.102273564558934e-05, "remove_single_ts_time_rank_from_batch": 1.464087329670506e-06, "get_actions": 0.00016333500830916823}}, "connector_pipeline_timer": 0.0003599580790045358}, "env_step_timer": 4.229568787985819e-05, "episode_len_mean": 50.0, "num_module_steps_sampled_lifetime": {"default_policy": 252500.0}, "env_reset_timer": 0.00019791260177414152, "env_to_module_sum_episodes_length_in": 26.762340024562445, "weights_seq_no": 0.0, "episode_duration_sec_mean": 0.03499742302998131, "episode_return_max": 14.5, "num_env_steps_sampled_lifetime": 252500.0, "env_to_module_sum_episodes_length_out": 26.762340024562445, "num_module_steps_sampled": {"default_policy": 5000.0}, "episode_return_min": -5.5, "num_env_steps_sampled": 5000.0, "episode_return_mean": 8.5, "episode_len_min": 50, "num_env_steps_sampled_lifetime_throughput": 1292.6759119129686}, "learners": {"default_policy": {"vf_explained_var": -0.0021828413009643555, "num_trainable_parameters": 7055, "vf_loss_unclipped": 69.29861450195312, "vf_loss": 0.45436471700668335, "weights_seq_no": 1.0, "entropy": 0.6848167181015015, "policy_loss": -0.2616588771343231, "mean_kl_loss": 0.0006390680791810155, "gradients_default_optimizer_global_norm": 0.03563692048192024, "num_module_steps_trained": 6000, "default_optimizer_learning_rate": 0.0004386306194, "total_loss": 0.002596070058643818, "diff_num_grad_updates_vs_sampler_policy": 1.0, "curr_kl_coeff": 0.3050880432128906, "module_train_batch_size_mean": 1000.0, "curr_entropy_coeff": 0.0376490504491, "num_module_steps_trained_lifetime": 6000, "num_module_steps_trained_lifetime_throughput": 209565.18756459173}, "__all_modules__": {"num_env_steps_trained": 30600, "num_env_steps_trained_lifetime": 30600, "learner_connector": {"timers": {"connectors": {"add_columns_from_episodes_to_train_batch": 0.07015169999976933, "add_observations_from_episodes_to_batch": 0.0007634000003235997, "add_time_dim_to_batch_and_zero_pad": 1.9899999642802868e-05, "add_one_ts_to_episodes_and_truncate": 0.008494199999404373, "numpy_to_tensor": 0.0001578999999765074, "batch_individual_items": 0.19747479999932693, "general_advantage_estimation": 0.011380300000382704, "add_states_from_episodes_to_batch": 5.9000003602704965e-06}}, "connector_pipeline_timer": 0.2887965999998414}, "num_non_trainable_parameters": 0, "num_module_steps_trained_lifetime": 6000, "learner_connector_sum_episodes_length_in": 5000, "num_trainable_parameters": 7055, "learner_connector_sum_episodes_length_out": 5100, "num_module_steps_trained": 6000, "num_env_steps_trained_lifetime_throughput": 1059454.687886579, "num_module_steps_trained_throughput": 208989.52408765003, "num_module_steps_trained_lifetime_throughput": 208707.54459433182}}, "num_training_step_calls_per_iteration": 1, "num_env_steps_sampled_lifetime": 252500.0, "evaluation": {"env_runners": {"env_to_module_sum_episodes_length_in": 27.167134025045954, "module_to_env_connector": {"timers": {"connectors": {"un_batch_to_individual_items": 1.5398706406069508e-05, "tensor_to_numpy": 4.513098445159604e-05, "get_actions": 0.00015371128151091994, "normalize_and_clip_actions": 2.210175461857151e-05, "listify_data_for_vector_env": 3.079024845516793e-05, "remove_single_ts_time_rank_from_batch": 1.355828178836951e-06}}, "connector_pipeline_timer": 0.0003402800628283421}, "episode_return_max": 13.5, "episode_len_min": 50, "sample": 0.725600900000245, "agent_episode_returns_mean": {"default_agent": -1.9}, "episode_len_mean": 50.0, "env_to_module_connector": {"timers": {"connectors": {"batch_individual_items": 1.7789383224486174e-05, "numpy_to_tensor": 2.9684931079215452e-05, "add_states_from_episodes_to_batch": 3.281413673507305e-06, "add_observations_from_episodes_to_batch": 6.2308330930324915e-06, "add_time_dim_to_batch_and_zero_pad": 5.517014801860042e-06}}, "connector_pipeline_timer": 0.00011218829873476557}, "weights_seq_no": 1.0, "episode_return_min": -11.5, "num_module_steps_sampled_lifetime": {"default_policy": 1000}, "num_episodes": 20, "episode_len_max": 50, "env_reset_timer": 0.0002122999994753627, "num_env_steps_sampled_lifetime": 6000, "env_to_module_sum_episodes_length_out": 27.167134025045954, "num_episodes_lifetime": 20, "num_module_steps_sampled": {"default_policy": 1000}, "rlmodule_inference_timer": 9.621636597706989e-05, "module_episode_returns_mean": {"default_policy": -1.9}, "num_agent_steps_sampled": {"default_agent": 1000}, "num_agent_steps_sampled_lifetime": {"default_agent": 1000}, "episode_duration_sec_mean": 0.03485580500000651, "num_env_steps_sampled": 1000, "episode_return_mean": -1.9, "env_step_timer": 4.14497850941924e-05}, "num_healthy_workers": 1, "actor_manager_num_outstanding_async_reqs": 0, "num_remote_worker_restarts": 0}, "fault_tolerance": {"num_healthy_workers": 0, "num_remote_worker_restarts": 0}, "env_runner_group": {"actor_manager_num_outstanding_async_reqs": 0}, "done": false, "training_iteration": 1, "trial_id": "6e27d_00000", "date": "2025-08-11_17-40-40", "timestamp": 1754926840, "time_this_iter_s": 4.88861083984375, "time_total_s": 4.88861083984375, "pid": 89029, "hostname": "DESKTOP-3SK5A41", "node_ip": "192.168.40.242", "config": {"exploration_config": {}, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 6, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "env": "Umbrella", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": false, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 0, "create_local_env_runner": true, "num_envs_per_env_runner": 1, "gym_env_vectorize_mode": "SYNC", "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "episodes_to_numpy": true, "max_requests_in_flight_per_env_runner": 1, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "merge_env_runner_states": "training_only", "broadcast_env_runner_states": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "complete_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "sampler_perf_stats_ema_coef": null, "_is_online": true, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": "auto", "num_aggregator_actors_per_learner": 0, "max_requests_in_flight_per_aggregator_actor": 3, "local_gpu_idx": 0, "max_requests_in_flight_per_learner": 3, "gamma": 1, "lr": 0.0004386306194, "grad_clip": 0.5, "grad_clip_by": "global_norm", "_train_batch_size_per_learner": 5000, "train_batch_size": 4000, "num_epochs": 1, "minibatch_size": 1000, "shuffle_batch_per_epoch": true, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "log_std_clip_param": 20.0, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "_disable_preprocessor_api": false, "_disable_action_flattening": false}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "_learner_class": null, "callbacks_on_algorithm_init": null, "callbacks_on_env_runners_recreated": null, "callbacks_on_offline_eval_runners_recreated": null, "callbacks_on_checkpoint_loaded": null, "callbacks_on_environment_created": null, "callbacks_on_episode_created": null, "callbacks_on_episode_start": null, "callbacks_on_episode_step": null, "callbacks_on_episode_end": null, "callbacks_on_evaluate_start": null, "callbacks_on_evaluate_end": null, "callbacks_on_evaluate_offline_start": null, "callbacks_on_evaluate_offline_end": null, "callbacks_on_sample_end": null, "callbacks_on_train_result": null, "explore": true, "enable_rl_module_and_learner": true, "enable_env_runner_and_connector_v2": true, "_prior_exploration_config": {"type": "StochasticSampling"}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x760009bd6ac0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "offline_data_class": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_read_batch_size": null, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "materialize_data": false, "materialize_mapped_data": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "ignore_final_observation": false, "prelearner_class": null, "prelearner_buffer_class": null, "prelearner_buffer_kwargs": {}, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_remaining_data": false, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": 1, "evaluation_duration": 20, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_auto_duration_min_env_steps_per_sample": 100, "evaluation_auto_duration_max_env_steps_per_sample": 2000, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 1, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "offline_evaluation_interval": null, "num_offline_eval_runners": 0, "offline_loss_for_module_fn": null, "offline_evaluation_duration": 1, "offline_evaluation_parallel_to_training": false, "offline_evaluation_timeout_s": 120.0, "num_cpus_per_offline_eval_runner": 1, "num_gpus_per_offline_eval_runner": 0, "custom_resources_per_offline_eval_runner": {}, "restart_failed_offline_eval_runners": true, "ignore_offline_eval_runner_failures": false, "max_num_offline_eval_runner_restarts": 1000, "offline_eval_runner_restore_timeout_s": 1800.0, "max_requests_in_flight_per_offline_eval_runner": 1, "validate_offline_eval_runners_after_construction": true, "offline_eval_runner_health_probe_timeout_s": 30.0, "offline_eval_rl_module_inference_only": false, "broadcast_offline_eval_runner_states": false, "offline_eval_batch_size_per_runner": 256, "dataset_num_iters_per_eval_runner": 1, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "log_gradients": true, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 42, "restart_failed_env_runners": true, "ignore_env_runner_failures": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30.0, "env_runner_restore_timeout_s": 1800.0, "_model_config": {}, "_rl_module_spec": "RLModuleSpec(module_class=None, observation_space=None, action_space=None, inference_only=False, learner_only=False, model_config=DefaultModelConfig(fcnet_hiddens=[89, 72], fcnet_activation='tanh', fcnet_kernel_initializer=None, fcnet_kernel_initializer_kwargs=None, fcnet_bias_initializer=None, fcnet_bias_initializer_kwargs=None, conv_filters=None, conv_activation='relu', conv_kernel_initializer=None, conv_kernel_initializer_kwargs=None, conv_bias_initializer=None, conv_bias_initializer_kwargs=None, head_fcnet_hiddens=[], head_fcnet_activation='relu', head_fcnet_kernel_initializer=None, head_fcnet_kernel_initializer_kwargs=None, head_fcnet_bias_initializer=None, head_fcnet_bias_initializer_kwargs=None, free_log_std=False, log_std_clip_param=20.0, vf_share_layers=True, use_lstm=False, max_seq_len=20, lstm_cell_size=256, lstm_use_prev_action=False, lstm_use_prev_reward=False, lstm_kernel_initializer=None, lstm_kernel_initializer_kwargs=None, lstm_bias_initializer=None, lstm_bias_initializer_kwargs=None), catalog_class=None, load_state_path=None, model_config_dict=None)", "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "_validate_config": true, "_use_msgpack_checkpoints": false, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "env_task_fn": -1, "enable_connectors": -1, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.6101760640943, "kl_target": 0.0088832044531, "vf_loss_coeff": 0.6374785266784, "entropy_coeff": 0.0376490504491, "clip_param": 0.2961700372778, "vf_clip_param": 0.4555106473841, "entropy_coeff_schedule": null, "lr_schedule": null, "sgd_minibatch_size": -1, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9828134201416, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.callbacks.callbacks.RLlibCallback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 4.88861083984375, "iterations_since_restore": 1, "perf": {"cpu_util_percent": 11.328571428571427, "ram_util_percent": 83.21428571428571}}
{"timers": {"training_iteration": 4.147337220000681, "restore_env_runners": 1.4575000204786194e-05, "training_step": 4.147135264999224, "env_runner_sampling_timer": 3.746268833000286, "learner_update_timer": 0.3975347520002833, "synch_weights": 0.0014021419997607154, "restore_eval_env_runners": 1.3099999705445953e-05, "evaluation_iteration": 0.7373793999995542, "synch_eval_env_connectors": 0.00039600000036443816, "synch_env_connectors": 8.400000297115184e-06}, "env_runners": {"num_episodes_lifetime": 200.0, "env_to_module_connector": {"timers": {"connectors": {"add_observations_from_episodes_to_batch": 6.146043393008236e-06, "numpy_to_tensor": 3.097372813066519e-05, "add_time_dim_to_batch_and_zero_pad": 6.2351309889878115e-06, "batch_individual_items": 1.8721395867807985e-05, "add_states_from_episodes_to_batch": 3.4370344192119318e-06}}, "connector_pipeline_timer": 0.0001180181015095033}, "agent_episode_returns_mean": {"default_agent": 4.5}, "module_episode_returns_mean": {"default_policy": 4.5}, "num_episodes": 100.0, "time_between_sampling": 0.008858838848398533, "num_agent_steps_sampled": {"default_agent": 5000.0}, "num_agent_steps_sampled_lifetime": {"default_agent": 10000.0}, "episode_len_max": 50, "rlmodule_inference_timer": 9.942181488253653e-05, "sample": 0.03747098939747538, "module_to_env_connector": {"timers": {"connectors": {"un_batch_to_individual_items": 1.4539806021948839e-05, "normalize_and_clip_actions": 2.2262638410223318e-05, "tensor_to_numpy": 4.8595000828103846e-05, "listify_data_for_vector_env": 3.129198396759111e-05, "remove_single_ts_time_rank_from_batch": 1.5187014963245825e-06, "get_actions": 0.00016483704257308173}}, "connector_pipeline_timer": 0.0003591433747106216}, "env_step_timer": 4.2191035170129765e-05, "episode_len_mean": 50.0, "num_module_steps_sampled_lifetime": {"default_policy": 10000.0}, "env_reset_timer": 0.00013058421779634595, "env_to_module_sum_episodes_length_in": 27.16809333212661, "weights_seq_no": 1.0, "episode_duration_sec_mean": 0.03623062602997379, "episode_return_max": 14.5, "num_env_steps_sampled_lifetime": 10000.0, "env_to_module_sum_episodes_length_out": 27.16809333212661, "num_module_steps_sampled": {"default_policy": 5000.0}, "episode_return_min": -5.5, "num_env_steps_sampled": 5000.0, "episode_return_mean": 4.5, "episode_len_min": 50, "num_env_steps_sampled_lifetime_throughput": 1295.7529797428042}, "learners": {"default_policy": {"vf_explained_var": 0.007673084735870361, "num_trainable_parameters": 7055, "vf_loss_unclipped": 61.14714431762695, "vf_loss": 0.4529709219932556, "weights_seq_no": 2.0, "entropy": 0.6848956346511841, "policy_loss": -0.28350090980529785, "mean_kl_loss": 7.99761910457164e-05, "gradients_default_optimizer_global_norm": 0.025437714532017708, "num_module_steps_trained": 6000, "default_optimizer_learning_rate": 0.0004386306194, "total_loss": -0.02050294727087021, "diff_num_grad_updates_vs_sampler_policy": 1.0, "curr_kl_coeff": 0.1525440216064453, "module_train_batch_size_mean": 1000.0, "curr_entropy_coeff": 0.0376490504491, "num_module_steps_trained_lifetime": 12000, "num_module_steps_trained_lifetime_throughput": 208867.69102170368}, "__all_modules__": {"num_env_steps_trained": 30600, "num_env_steps_trained_lifetime": 61200, "learner_connector": {"timers": {"connectors": {"add_columns_from_episodes_to_train_batch": 0.07011264799976744, "add_observations_from_episodes_to_batch": 0.0007627120003235177, "add_time_dim_to_batch_and_zero_pad": 1.9905999652110042e-05, "add_one_ts_to_episodes_and_truncate": 0.008490459999411542, "numpy_to_tensor": 0.00015793799997481983, "batch_individual_items": 0.19606579199933546, "general_advantage_estimation": 0.011369337000378435, "add_states_from_episodes_to_batch": 5.8990003617509495e-06}}, "connector_pipeline_timer": 0.2873324469998443}, "num_non_trainable_parameters": 0, "num_module_steps_trained_lifetime": 12000, "learner_connector_sum_episodes_length_in": 5000.0, "num_trainable_parameters": 7055, "learner_connector_sum_episodes_length_out": 5100.0, "num_module_steps_trained": 6000, "num_env_steps_trained_lifetime_throughput": 1056021.6504775009, "num_module_steps_trained_throughput": 208303.1284743849, "num_module_steps_trained_lifetime_throughput": 208023.81555704685}}, "num_training_step_calls_per_iteration": 1, "evaluation": {"env_runners": {"env_to_module_sum_episodes_length_in": 27.168093298253442, "module_to_env_connector": {"timers": {"connectors": {"un_batch_to_individual_items": 1.5220437821478313e-05, "tensor_to_numpy": 4.4527071244279914e-05, "get_actions": 0.00015388103628264494, "normalize_and_clip_actions": 2.1404809243482416e-05, "listify_data_for_vector_env": 3.01331170454932e-05, "remove_single_ts_time_rank_from_batch": 1.3440181265342847e-06}}, "connector_pipeline_timer": 0.00033671330220383405}, "episode_return_max": 13.5, "episode_len_min": 50, "sample": 0.725510491000241, "agent_episode_returns_mean": {"default_agent": -3.9}, "episode_len_mean": 50.0, "env_to_module_connector": {"timers": {"connectors": {"batch_individual_items": 1.755875311983331e-05, "numpy_to_tensor": 2.8813957518511542e-05, "add_states_from_episodes_to_batch": 3.380214764266246e-06, "add_observations_from_episodes_to_batch": 5.984020466085971e-06, "add_time_dim_to_batch_and_zero_pad": 5.416877317385516e-06}}, "connector_pipeline_timer": 0.00011025383504450472}, "weights_seq_no": 2.0, "episode_return_min": -16.5, "num_module_steps_sampled_lifetime": {"default_policy": 2000}, "num_episodes": 20, "episode_len_max": 50, "env_reset_timer": 0.0002115379994847899, "num_env_steps_sampled_lifetime": 11000, "env_to_module_sum_episodes_length_out": 27.168093298253442, "num_episodes_lifetime": 40, "num_module_steps_sampled": {"default_policy": 1000}, "rlmodule_inference_timer": 9.455110307487169e-05, "module_episode_returns_mean": {"default_policy": -3.9}, "num_agent_steps_sampled": {"default_agent": 1000}, "num_agent_steps_sampled_lifetime": {"default_agent": 2000}, "episode_duration_sec_mean": 0.034651632500049344, "num_env_steps_sampled": 1000, "episode_return_mean": -3.9, "env_step_timer": 4.1498761879676116e-05, "time_between_sampling": 4.1160871029997}, "num_healthy_workers": 1, "actor_manager_num_outstanding_async_reqs": 0, "num_remote_worker_restarts": 0}, "num_env_steps_sampled_lifetime": 10000.0, "fault_tolerance": {"num_healthy_workers": 0, "num_remote_worker_restarts": 0}, "env_runner_group": {"actor_manager_num_outstanding_async_reqs": 0}, "done": false, "training_iteration": 2, "trial_id": "6e27d_00000", "date": "2025-08-11_17-40-44", "timestamp": 1754926844, "time_this_iter_s": 4.78946852684021, "time_total_s": 9.67807936668396, "pid": 89029, "hostname": "DESKTOP-3SK5A41", "node_ip": "192.168.40.242", "config": {"exploration_config": {}, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 6, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "env": "Umbrella", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": false, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 0, "create_local_env_runner": true, "num_envs_per_env_runner": 1, "gym_env_vectorize_mode": "SYNC", "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "episodes_to_numpy": true, "max_requests_in_flight_per_env_runner": 1, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "merge_env_runner_states": "training_only", "broadcast_env_runner_states": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "complete_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "sampler_perf_stats_ema_coef": null, "_is_online": true, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": "auto", "num_aggregator_actors_per_learner": 0, "max_requests_in_flight_per_aggregator_actor": 3, "local_gpu_idx": 0, "max_requests_in_flight_per_learner": 3, "gamma": 1, "lr": 0.0004386306194, "grad_clip": 0.5, "grad_clip_by": "global_norm", "_train_batch_size_per_learner": 5000, "train_batch_size": 4000, "num_epochs": 1, "minibatch_size": 1000, "shuffle_batch_per_epoch": true, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "log_std_clip_param": 20.0, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "_disable_preprocessor_api": false, "_disable_action_flattening": false}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "_learner_class": null, "callbacks_on_algorithm_init": null, "callbacks_on_env_runners_recreated": null, "callbacks_on_offline_eval_runners_recreated": null, "callbacks_on_checkpoint_loaded": null, "callbacks_on_environment_created": null, "callbacks_on_episode_created": null, "callbacks_on_episode_start": null, "callbacks_on_episode_step": null, "callbacks_on_episode_end": null, "callbacks_on_evaluate_start": null, "callbacks_on_evaluate_end": null, "callbacks_on_evaluate_offline_start": null, "callbacks_on_evaluate_offline_end": null, "callbacks_on_sample_end": null, "callbacks_on_train_result": null, "explore": true, "enable_rl_module_and_learner": true, "enable_env_runner_and_connector_v2": true, "_prior_exploration_config": {"type": "StochasticSampling"}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x760009bd6ac0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "offline_data_class": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_read_batch_size": null, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "materialize_data": false, "materialize_mapped_data": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "ignore_final_observation": false, "prelearner_class": null, "prelearner_buffer_class": null, "prelearner_buffer_kwargs": {}, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_remaining_data": false, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": 1, "evaluation_duration": 20, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_auto_duration_min_env_steps_per_sample": 100, "evaluation_auto_duration_max_env_steps_per_sample": 2000, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 1, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "offline_evaluation_interval": null, "num_offline_eval_runners": 0, "offline_loss_for_module_fn": null, "offline_evaluation_duration": 1, "offline_evaluation_parallel_to_training": false, "offline_evaluation_timeout_s": 120.0, "num_cpus_per_offline_eval_runner": 1, "num_gpus_per_offline_eval_runner": 0, "custom_resources_per_offline_eval_runner": {}, "restart_failed_offline_eval_runners": true, "ignore_offline_eval_runner_failures": false, "max_num_offline_eval_runner_restarts": 1000, "offline_eval_runner_restore_timeout_s": 1800.0, "max_requests_in_flight_per_offline_eval_runner": 1, "validate_offline_eval_runners_after_construction": true, "offline_eval_runner_health_probe_timeout_s": 30.0, "offline_eval_rl_module_inference_only": false, "broadcast_offline_eval_runner_states": false, "offline_eval_batch_size_per_runner": 256, "dataset_num_iters_per_eval_runner": 1, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "log_gradients": true, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 42, "restart_failed_env_runners": true, "ignore_env_runner_failures": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30.0, "env_runner_restore_timeout_s": 1800.0, "_model_config": {}, "_rl_module_spec": "RLModuleSpec(module_class=None, observation_space=None, action_space=None, inference_only=False, learner_only=False, model_config=DefaultModelConfig(fcnet_hiddens=[89, 72], fcnet_activation='tanh', fcnet_kernel_initializer=None, fcnet_kernel_initializer_kwargs=None, fcnet_bias_initializer=None, fcnet_bias_initializer_kwargs=None, conv_filters=None, conv_activation='relu', conv_kernel_initializer=None, conv_kernel_initializer_kwargs=None, conv_bias_initializer=None, conv_bias_initializer_kwargs=None, head_fcnet_hiddens=[], head_fcnet_activation='relu', head_fcnet_kernel_initializer=None, head_fcnet_kernel_initializer_kwargs=None, head_fcnet_bias_initializer=None, head_fcnet_bias_initializer_kwargs=None, free_log_std=False, log_std_clip_param=20.0, vf_share_layers=True, use_lstm=False, max_seq_len=20, lstm_cell_size=256, lstm_use_prev_action=False, lstm_use_prev_reward=False, lstm_kernel_initializer=None, lstm_kernel_initializer_kwargs=None, lstm_bias_initializer=None, lstm_bias_initializer_kwargs=None), catalog_class=None, load_state_path=None, model_config_dict=None)", "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "_validate_config": true, "_use_msgpack_checkpoints": false, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "env_task_fn": -1, "enable_connectors": -1, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.6101760640943, "kl_target": 0.0088832044531, "vf_loss_coeff": 0.6374785266784, "entropy_coeff": 0.0376490504491, "clip_param": 0.2961700372778, "vf_clip_param": 0.4555106473841, "entropy_coeff_schedule": null, "lr_schedule": null, "sgd_minibatch_size": -1, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9828134201416, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.callbacks.callbacks.RLlibCallback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 9.67807936668396, "iterations_since_restore": 2, "perf": {"cpu_util_percent": 13.528571428571427, "ram_util_percent": 81.51428571428572}}
{"timers": {"training_iteration": 4.148251644820675, "restore_env_runners": 1.4555250198100113e-05, "training_step": 4.1480477403692335, "env_runner_sampling_timer": 3.7490745636902774, "learner_update_timer": 0.39563567148028267, "synch_weights": 0.0014048455797589668, "restore_eval_env_runners": 1.3101999711579994e-05, "evaluation_iteration": 0.7372647329995562, "synch_eval_env_connectors": 0.0003960620003635995, "synch_env_connectors": 8.394000287808012e-06}, "env_runners": {"num_episodes_lifetime": -4650.0, "env_to_module_connector": {"timers": {"connectors": {"add_observations_from_episodes_to_batch": 6.189946272890335e-06, "numpy_to_tensor": 3.146053805768035e-05, "add_time_dim_to_batch_and_zero_pad": 6.160527247393942e-06, "batch_individual_items": 1.8720669652452827e-05, "add_states_from_episodes_to_batch": 3.354819339667663e-06}}, "connector_pipeline_timer": 0.00011815970607141845}, "agent_episode_returns_mean": {"default_agent": 7.9}, "module_episode_returns_mean": {"default_policy": 7.9}, "num_episodes": 100.0, "time_between_sampling": 0.010215934833555138, "num_agent_steps_sampled": {"default_agent": 5000.0}, "num_agent_steps_sampled_lifetime": {"default_agent": -232500.0}, "episode_len_max": 50, "rlmodule_inference_timer": 0.000133662059872011, "sample": 0.03771385354243335, "module_to_env_connector": {"timers": {"connectors": {"un_batch_to_individual_items": 1.450117596580998e-05, "normalize_and_clip_actions": 2.2888032746802813e-05, "tensor_to_numpy": 4.8664114906559664e-05, "listify_data_for_vector_env": 3.165132099358314e-05, "remove_single_ts_time_rank_from_batch": 1.4781354540155508e-06, "get_actions": 0.00016384587160954116}}, "connector_pipeline_timer": 0.00035987599426827444}, "env_step_timer": 4.262721857967324e-05, "episode_len_mean": 50.0, "num_module_steps_sampled_lifetime": {"default_policy": -232500.0}, "env_reset_timer": 0.00010875077894018271, "env_to_module_sum_episodes_length_in": 27.16809333212661, "weights_seq_no": 2.0, "episode_duration_sec_mean": 0.03776390400998936, "episode_return_max": 14.5, "num_env_steps_sampled_lifetime": -232500.0, "env_to_module_sum_episodes_length_out": 27.16809333212661, "num_module_steps_sampled": {"default_policy": 5000.0}, "episode_return_min": -5.5, "num_env_steps_sampled": 5000.0, "episode_return_mean": 7.9, "episode_len_min": 50, "num_env_steps_sampled_lifetime_throughput": 1286.9825019526393}, "learners": {"default_policy": {"vf_explained_var": 0.015030920505523682, "num_trainable_parameters": 7055, "vf_loss_unclipped": 64.45970916748047, "vf_loss": 0.4528927803039551, "weights_seq_no": 3.0, "entropy": 0.6751201748847961, "policy_loss": -0.05981535464525223, "mean_kl_loss": 0.0017090580658987164, "gradients_default_optimizer_global_norm": 0.027418039739131927, "num_module_steps_trained": 6000, "default_optimizer_learning_rate": 0.0004386306194, "total_loss": 0.20373712480068207, "diff_num_grad_updates_vs_sampler_policy": 1.0, "curr_kl_coeff": 0.07627201080322266, "module_train_batch_size_mean": 1000.0, "curr_entropy_coeff": 0.0376490504491, "num_module_steps_trained_lifetime": 18000, "num_module_steps_trained_lifetime_throughput": 206978.75021018085}, "__all_modules__": {"num_env_steps_trained": 30600, "num_env_steps_trained_lifetime": 91800, "learner_connector": {"timers": {"connectors": {"add_columns_from_episodes_to_train_batch": 0.07009636951977054, "add_observations_from_episodes_to_batch": 0.0007629028803239634, "add_time_dim_to_batch_and_zero_pad": 1.992693965730723e-05, "add_one_ts_to_episodes_and_truncate": 0.008491383399418555, "numpy_to_tensor": 0.0001590886199806846, "batch_individual_items": 0.1947086120793448, "general_advantage_estimation": 0.011386924630378234, "add_states_from_episodes_to_batch": 5.899010361736145e-06}}, "connector_pipeline_timer": 0.2859794965298474}, "num_non_trainable_parameters": 0, "num_module_steps_trained_lifetime": 18000, "learner_connector_sum_episodes_length_in": 5000.0, "num_trainable_parameters": 7055, "learner_connector_sum_episodes_length_out": 5100.0, "num_module_steps_trained": 6000, "num_env_steps_trained_lifetime_throughput": 1046571.6024986412, "num_module_steps_trained_throughput": 206430.3875669394, "num_module_steps_trained_lifetime_throughput": 206154.37254074073}}, "num_training_step_calls_per_iteration": 1, "evaluation": {"env_runners": {"env_to_module_sum_episodes_length_in": 27.168093332125434, "module_to_env_connector": {"timers": {"connectors": {"un_batch_to_individual_items": 1.538123294772072e-05, "tensor_to_numpy": 4.500071406563766e-05, "get_actions": 0.00015362885946235767, "normalize_and_clip_actions": 2.1925184817613356e-05, "listify_data_for_vector_env": 3.005635660772031e-05, "remove_single_ts_time_rank_from_batch": 1.705163839372049e-06}}, "connector_pipeline_timer": 0.00034007590224530165}, "episode_return_max": 17.5, "episode_len_min": 50, "sample": 0.7255747331002455, "agent_episode_returns_mean": {"default_agent": -2.566666666666667}, "episode_len_mean": 50.0, "env_to_module_connector": {"timers": {"connectors": {"batch_individual_items": 1.824841725109517e-05, "numpy_to_tensor": 2.8907008809122393e-05, "add_states_from_episodes_to_batch": 3.298377882538908e-06, "add_observations_from_episodes_to_batch": 5.926816444957943e-06, "add_time_dim_to_batch_and_zero_pad": 5.433438056439843e-06}}, "connector_pipeline_timer": 0.00011201037309538997}, "weights_seq_no": 3.0, "episode_return_min": -16.5, "num_module_steps_sampled_lifetime": {"default_policy": 3000}, "num_episodes": 20, "episode_len_max": 50, "env_reset_timer": 0.00021145161948743407, "num_env_steps_sampled_lifetime": 16000, "env_to_module_sum_episodes_length_out": 27.168093332125434, "num_episodes_lifetime": 60, "num_module_steps_sampled": {"default_policy": 1000}, "rlmodule_inference_timer": 9.48045605101478e-05, "module_episode_returns_mean": {"default_policy": -2.566666666666667}, "num_agent_steps_sampled": {"default_agent": 1000}, "num_agent_steps_sampled_lifetime": {"default_agent": 3000}, "episode_duration_sec_mean": 0.034821870016700514, "num_env_steps_sampled": 1000, "episode_return_mean": -2.566666666666667, "env_step_timer": 4.1116272769880444e-05, "time_between_sampling": 4.117862227989708}, "num_healthy_workers": 1, "actor_manager_num_outstanding_async_reqs": 0, "num_remote_worker_restarts": 0}, "num_env_steps_sampled_lifetime": -232500.0, "fault_tolerance": {"num_healthy_workers": 0, "num_remote_worker_restarts": 0}, "env_runner_group": {"actor_manager_num_outstanding_async_reqs": 0}, "done": false, "training_iteration": 3, "trial_id": "6e27d_00000", "date": "2025-08-11_17-40-49", "timestamp": 1754926849, "time_this_iter_s": 4.984476566314697, "time_total_s": 14.662555932998657, "pid": 89029, "hostname": "DESKTOP-3SK5A41", "node_ip": "192.168.40.242", "config": {"exploration_config": {}, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 6, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "env": "Umbrella", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": false, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 0, "create_local_env_runner": true, "num_envs_per_env_runner": 1, "gym_env_vectorize_mode": "SYNC", "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "episodes_to_numpy": true, "max_requests_in_flight_per_env_runner": 1, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "merge_env_runner_states": "training_only", "broadcast_env_runner_states": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "complete_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "sampler_perf_stats_ema_coef": null, "_is_online": true, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": "auto", "num_aggregator_actors_per_learner": 0, "max_requests_in_flight_per_aggregator_actor": 3, "local_gpu_idx": 0, "max_requests_in_flight_per_learner": 3, "gamma": 1, "lr": 0.0004386306194, "grad_clip": 0.5, "grad_clip_by": "global_norm", "_train_batch_size_per_learner": 5000, "train_batch_size": 4000, "num_epochs": 1, "minibatch_size": 1000, "shuffle_batch_per_epoch": true, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "log_std_clip_param": 20.0, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "_disable_preprocessor_api": false, "_disable_action_flattening": false}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "_learner_class": null, "callbacks_on_algorithm_init": null, "callbacks_on_env_runners_recreated": null, "callbacks_on_offline_eval_runners_recreated": null, "callbacks_on_checkpoint_loaded": null, "callbacks_on_environment_created": null, "callbacks_on_episode_created": null, "callbacks_on_episode_start": null, "callbacks_on_episode_step": null, "callbacks_on_episode_end": null, "callbacks_on_evaluate_start": null, "callbacks_on_evaluate_end": null, "callbacks_on_evaluate_offline_start": null, "callbacks_on_evaluate_offline_end": null, "callbacks_on_sample_end": null, "callbacks_on_train_result": null, "explore": true, "enable_rl_module_and_learner": true, "enable_env_runner_and_connector_v2": true, "_prior_exploration_config": {"type": "StochasticSampling"}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x760009bd6ac0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "offline_data_class": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_read_batch_size": null, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "materialize_data": false, "materialize_mapped_data": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "ignore_final_observation": false, "prelearner_class": null, "prelearner_buffer_class": null, "prelearner_buffer_kwargs": {}, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_remaining_data": false, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": 1, "evaluation_duration": 20, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_auto_duration_min_env_steps_per_sample": 100, "evaluation_auto_duration_max_env_steps_per_sample": 2000, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 1, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "offline_evaluation_interval": null, "num_offline_eval_runners": 0, "offline_loss_for_module_fn": null, "offline_evaluation_duration": 1, "offline_evaluation_parallel_to_training": false, "offline_evaluation_timeout_s": 120.0, "num_cpus_per_offline_eval_runner": 1, "num_gpus_per_offline_eval_runner": 0, "custom_resources_per_offline_eval_runner": {}, "restart_failed_offline_eval_runners": true, "ignore_offline_eval_runner_failures": false, "max_num_offline_eval_runner_restarts": 1000, "offline_eval_runner_restore_timeout_s": 1800.0, "max_requests_in_flight_per_offline_eval_runner": 1, "validate_offline_eval_runners_after_construction": true, "offline_eval_runner_health_probe_timeout_s": 30.0, "offline_eval_rl_module_inference_only": false, "broadcast_offline_eval_runner_states": false, "offline_eval_batch_size_per_runner": 256, "dataset_num_iters_per_eval_runner": 1, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "log_gradients": true, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 42, "restart_failed_env_runners": true, "ignore_env_runner_failures": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30.0, "env_runner_restore_timeout_s": 1800.0, "_model_config": {}, "_rl_module_spec": "RLModuleSpec(module_class=None, observation_space=None, action_space=None, inference_only=False, learner_only=False, model_config=DefaultModelConfig(fcnet_hiddens=[89, 72], fcnet_activation='tanh', fcnet_kernel_initializer=None, fcnet_kernel_initializer_kwargs=None, fcnet_bias_initializer=None, fcnet_bias_initializer_kwargs=None, conv_filters=None, conv_activation='relu', conv_kernel_initializer=None, conv_kernel_initializer_kwargs=None, conv_bias_initializer=None, conv_bias_initializer_kwargs=None, head_fcnet_hiddens=[], head_fcnet_activation='relu', head_fcnet_kernel_initializer=None, head_fcnet_kernel_initializer_kwargs=None, head_fcnet_bias_initializer=None, head_fcnet_bias_initializer_kwargs=None, free_log_std=False, log_std_clip_param=20.0, vf_share_layers=True, use_lstm=False, max_seq_len=20, lstm_cell_size=256, lstm_use_prev_action=False, lstm_use_prev_reward=False, lstm_kernel_initializer=None, lstm_kernel_initializer_kwargs=None, lstm_bias_initializer=None, lstm_bias_initializer_kwargs=None), catalog_class=None, load_state_path=None, model_config_dict=None)", "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "_validate_config": true, "_use_msgpack_checkpoints": false, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "env_task_fn": -1, "enable_connectors": -1, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.6101760640943, "kl_target": 0.0088832044531, "vf_loss_coeff": 0.6374785266784, "entropy_coeff": 0.0376490504491, "clip_param": 0.2961700372778, "vf_clip_param": 0.4555106473841, "entropy_coeff_schedule": null, "lr_schedule": null, "sgd_minibatch_size": -1, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9828134201416, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.callbacks.callbacks.RLlibCallback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 14.662555932998657, "iterations_since_restore": 3, "perf": {"cpu_util_percent": 13.1875, "ram_util_percent": 78.9875}}
{"timers": {"training_iteration": 4.149101035362471, "restore_env_runners": 1.45336976944418e-05, "training_step": 4.1488955339555424, "env_runner_sampling_timer": 3.750672504043375, "learner_update_timer": 0.3948850057654827, "synch_weights": 0.00140406212395915, "restore_eval_env_runners": 1.3106979713211333e-05, "evaluation_iteration": 0.7373051496795672, "synch_eval_env_connectors": 0.0003954463803554972, "synch_env_connectors": 8.38306028599618e-06}, "env_runners": {"num_episodes_lifetime": -9500.0, "env_to_module_connector": {"timers": {"connectors": {"add_observations_from_episodes_to_batch": 6.20094930022013e-06, "numpy_to_tensor": 3.112327773145002e-05, "add_time_dim_to_batch_and_zero_pad": 6.322313510784335e-06, "batch_individual_items": 1.8944684552165133e-05, "add_states_from_episodes_to_batch": 3.453069352187977e-06}}, "connector_pipeline_timer": 0.00011905557478268182}, "agent_episode_returns_mean": {"default_agent": 6.5}, "module_episode_returns_mean": {"default_policy": 6.5}, "num_episodes": 100.0, "time_between_sampling": 0.011002500762263858, "num_agent_steps_sampled": {"default_agent": 5000.0}, "num_agent_steps_sampled_lifetime": {"default_agent": -475000.0}, "episode_len_max": 50, "rlmodule_inference_timer": 0.00010052998332780801, "sample": 0.03820674933998178, "module_to_env_connector": {"timers": {"connectors": {"un_batch_to_individual_items": 1.4879458875413974e-05, "normalize_and_clip_actions": 2.246684180026965e-05, "tensor_to_numpy": 4.914878173097705e-05, "listify_data_for_vector_env": 3.1991512141401905e-05, "remove_single_ts_time_rank_from_batch": 1.5186647517813874e-06, "get_actions": 0.00016500946445917466}}, "connector_pipeline_timer": 0.0003619898166357936}, "env_step_timer": 4.2574549024199194e-05, "episode_len_mean": 50.0, "num_module_steps_sampled_lifetime": {"default_policy": -475000.0}, "env_reset_timer": 0.00010158535891427024, "env_to_module_sum_episodes_length_in": 27.16809333212661, "weights_seq_no": 3.0, "episode_duration_sec_mean": 0.03655082199003118, "episode_return_max": 14.5, "num_env_steps_sampled_lifetime": -475000.0, "env_to_module_sum_episodes_length_out": 27.16809333212661, "num_module_steps_sampled": {"default_policy": 5000.0}, "episode_return_min": -5.5, "num_env_steps_sampled": 5000.0, "episode_return_mean": 6.5, "episode_len_min": 50, "num_env_steps_sampled_lifetime_throughput": 1278.9903422667212}, "learners": {"default_policy": {"vf_explained_var": 0.02278977632522583, "num_trainable_parameters": 7055, "vf_loss_unclipped": 63.296836853027344, "vf_loss": 0.4496908485889435, "weights_seq_no": 4.0, "entropy": 0.6551574468612671, "policy_loss": -0.13655686378479004, "mean_kl_loss": 0.0027329043950885534, "gradients_default_optimizer_global_norm": 0.11016684025526047, "num_module_steps_trained": 6000, "default_optimizer_learning_rate": 0.0004386306194, "total_loss": 0.12565377354621887, "diff_num_grad_updates_vs_sampler_policy": 1.0, "curr_kl_coeff": 0.03813600540161133, "module_train_batch_size_mean": 1000.0, "curr_entropy_coeff": 0.0376490504491, "num_module_steps_trained_lifetime": 24000, "num_module_steps_trained_lifetime_throughput": 205414.1028941437}, "__all_modules__": {"num_env_steps_trained": 30600, "num_env_steps_trained_lifetime": 122400, "learner_connector": {"timers": {"connectors": {"add_columns_from_episodes_to_train_batch": 0.070079093824572, "add_observations_from_episodes_to_batch": 0.0007624058515213618, "add_time_dim_to_batch_and_zero_pad": 1.9926670257162186e-05, "add_one_ts_to_episodes_and_truncate": 0.00848894156542806, "numpy_to_tensor": 0.00015924473377749017, "batch_individual_items": 0.19478976595855102, "general_advantage_estimation": 0.011366959384070197, "add_states_from_episodes_to_batch": 5.904020263414167e-06}}, "connector_pipeline_timer": 0.2860203095645488}, "num_non_trainable_parameters": 0, "num_module_steps_trained_lifetime": 24000, "learner_connector_sum_episodes_length_in": 5000.0, "num_trainable_parameters": 7055, "learner_connector_sum_episodes_length_out": 5100.0, "num_module_steps_trained": 6000, "num_env_steps_trained_lifetime_throughput": 1038855.9937594808, "num_module_steps_trained_throughput": 204889.95962330513, "num_module_steps_trained_lifetime_throughput": 204618.63000508596}}, "num_training_step_calls_per_iteration": 1, "evaluation": {"env_runners": {"env_to_module_sum_episodes_length_in": 27.168093332126602, "module_to_env_connector": {"timers": {"connectors": {"un_batch_to_individual_items": 1.5599056094864005e-05, "tensor_to_numpy": 4.539825893199605e-05, "get_actions": 0.00015437984360840837, "normalize_and_clip_actions": 2.215299628703133e-05, "listify_data_for_vector_env": 3.0023971089481567e-05, "remove_single_ts_time_rank_from_batch": 1.409461830180544e-06}}, "connector_pipeline_timer": 0.00034182811633741753}, "episode_return_max": 17.5, "episode_len_min": 50, "sample": 0.7255280327692397, "agent_episode_returns_mean": {"default_agent": -2.65}, "episode_len_mean": 50.0, "env_to_module_connector": {"timers": {"connectors": {"batch_individual_items": 1.7912154622150655e-05, "numpy_to_tensor": 2.952305376351265e-05, "add_states_from_episodes_to_batch": 3.5605333363788192e-06, "add_observations_from_episodes_to_batch": 6.003008924144498e-06, "add_time_dim_to_batch_and_zero_pad": 5.397011560640944e-06}}, "connector_pipeline_timer": 0.0001125411219890528}, "weights_seq_no": 4.0, "episode_return_min": -16.5, "num_module_steps_sampled_lifetime": {"default_policy": 4000}, "num_episodes": 20, "episode_len_max": 50, "env_reset_timer": 0.00021097210329127392, "num_env_steps_sampled_lifetime": 21000, "env_to_module_sum_episodes_length_out": 27.168093332126602, "num_episodes_lifetime": 80, "num_module_steps_sampled": {"default_policy": 1000}, "rlmodule_inference_timer": 9.601623164334904e-05, "module_episode_returns_mean": {"default_policy": -2.65}, "num_agent_steps_sampled": {"default_agent": 1000}, "num_agent_steps_sampled_lifetime": {"default_agent": 4000}, "episode_duration_sec_mean": 0.03478300876256526, "num_env_steps_sampled": 1000, "episode_return_mean": -2.65, "env_step_timer": 4.19782383130814e-05, "time_between_sampling": 4.119561427699815}, "num_healthy_workers": 1, "actor_manager_num_outstanding_async_reqs": 0, "num_remote_worker_restarts": 0}, "num_env_steps_sampled_lifetime": -475000.0, "fault_tolerance": {"num_healthy_workers": 0, "num_remote_worker_restarts": 0}, "env_runner_group": {"actor_manager_num_outstanding_async_reqs": 0}, "done": false, "training_iteration": 4, "trial_id": "6e27d_00000", "date": "2025-08-11_17-40-54", "timestamp": 1754926854, "time_this_iter_s": 4.967697858810425, "time_total_s": 19.630253791809082, "pid": 89029, "hostname": "DESKTOP-3SK5A41", "node_ip": "192.168.40.242", "config": {"exploration_config": {}, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 6, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "env": "Umbrella", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": false, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 0, "create_local_env_runner": true, "num_envs_per_env_runner": 1, "gym_env_vectorize_mode": "SYNC", "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "episodes_to_numpy": true, "max_requests_in_flight_per_env_runner": 1, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "merge_env_runner_states": "training_only", "broadcast_env_runner_states": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "complete_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "sampler_perf_stats_ema_coef": null, "_is_online": true, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": "auto", "num_aggregator_actors_per_learner": 0, "max_requests_in_flight_per_aggregator_actor": 3, "local_gpu_idx": 0, "max_requests_in_flight_per_learner": 3, "gamma": 1, "lr": 0.0004386306194, "grad_clip": 0.5, "grad_clip_by": "global_norm", "_train_batch_size_per_learner": 5000, "train_batch_size": 4000, "num_epochs": 1, "minibatch_size": 1000, "shuffle_batch_per_epoch": true, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "log_std_clip_param": 20.0, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "_disable_preprocessor_api": false, "_disable_action_flattening": false}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "_learner_class": null, "callbacks_on_algorithm_init": null, "callbacks_on_env_runners_recreated": null, "callbacks_on_offline_eval_runners_recreated": null, "callbacks_on_checkpoint_loaded": null, "callbacks_on_environment_created": null, "callbacks_on_episode_created": null, "callbacks_on_episode_start": null, "callbacks_on_episode_step": null, "callbacks_on_episode_end": null, "callbacks_on_evaluate_start": null, "callbacks_on_evaluate_end": null, "callbacks_on_evaluate_offline_start": null, "callbacks_on_evaluate_offline_end": null, "callbacks_on_sample_end": null, "callbacks_on_train_result": null, "explore": true, "enable_rl_module_and_learner": true, "enable_env_runner_and_connector_v2": true, "_prior_exploration_config": {"type": "StochasticSampling"}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x760009bd6ac0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "offline_data_class": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_read_batch_size": null, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "materialize_data": false, "materialize_mapped_data": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "ignore_final_observation": false, "prelearner_class": null, "prelearner_buffer_class": null, "prelearner_buffer_kwargs": {}, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_remaining_data": false, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": 1, "evaluation_duration": 20, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_auto_duration_min_env_steps_per_sample": 100, "evaluation_auto_duration_max_env_steps_per_sample": 2000, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 1, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "offline_evaluation_interval": null, "num_offline_eval_runners": 0, "offline_loss_for_module_fn": null, "offline_evaluation_duration": 1, "offline_evaluation_parallel_to_training": false, "offline_evaluation_timeout_s": 120.0, "num_cpus_per_offline_eval_runner": 1, "num_gpus_per_offline_eval_runner": 0, "custom_resources_per_offline_eval_runner": {}, "restart_failed_offline_eval_runners": true, "ignore_offline_eval_runner_failures": false, "max_num_offline_eval_runner_restarts": 1000, "offline_eval_runner_restore_timeout_s": 1800.0, "max_requests_in_flight_per_offline_eval_runner": 1, "validate_offline_eval_runners_after_construction": true, "offline_eval_runner_health_probe_timeout_s": 30.0, "offline_eval_rl_module_inference_only": false, "broadcast_offline_eval_runner_states": false, "offline_eval_batch_size_per_runner": 256, "dataset_num_iters_per_eval_runner": 1, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "log_gradients": true, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 42, "restart_failed_env_runners": true, "ignore_env_runner_failures": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30.0, "env_runner_restore_timeout_s": 1800.0, "_model_config": {}, "_rl_module_spec": "RLModuleSpec(module_class=None, observation_space=None, action_space=None, inference_only=False, learner_only=False, model_config=DefaultModelConfig(fcnet_hiddens=[89, 72], fcnet_activation='tanh', fcnet_kernel_initializer=None, fcnet_kernel_initializer_kwargs=None, fcnet_bias_initializer=None, fcnet_bias_initializer_kwargs=None, conv_filters=None, conv_activation='relu', conv_kernel_initializer=None, conv_kernel_initializer_kwargs=None, conv_bias_initializer=None, conv_bias_initializer_kwargs=None, head_fcnet_hiddens=[], head_fcnet_activation='relu', head_fcnet_kernel_initializer=None, head_fcnet_kernel_initializer_kwargs=None, head_fcnet_bias_initializer=None, head_fcnet_bias_initializer_kwargs=None, free_log_std=False, log_std_clip_param=20.0, vf_share_layers=True, use_lstm=False, max_seq_len=20, lstm_cell_size=256, lstm_use_prev_action=False, lstm_use_prev_reward=False, lstm_kernel_initializer=None, lstm_kernel_initializer_kwargs=None, lstm_bias_initializer=None, lstm_bias_initializer_kwargs=None), catalog_class=None, load_state_path=None, model_config_dict=None)", "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "_validate_config": true, "_use_msgpack_checkpoints": false, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "env_task_fn": -1, "enable_connectors": -1, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.6101760640943, "kl_target": 0.0088832044531, "vf_loss_coeff": 0.6374785266784, "entropy_coeff": 0.0376490504491, "clip_param": 0.2961700372778, "vf_clip_param": 0.4555106473841, "entropy_coeff_schedule": null, "lr_schedule": null, "sgd_minibatch_size": -1, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9828134201416, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.callbacks.callbacks.RLlibCallback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 19.630253791809082, "iterations_since_restore": 4, "perf": {"cpu_util_percent": 11.857142857142858, "ram_util_percent": 79.0}}
{"timers": {"training_iteration": 4.147846002998843, "restore_env_runners": 1.4505360717088297e-05, "training_step": 4.147638646605978, "env_runner_sampling_timer": 3.75156300699294, "learner_update_timer": 0.39273551270782775, "synch_weights": 0.0014033075027226217, "restore_eval_env_runners": 1.31259099122899e-05, "evaluation_iteration": 0.7372369961827736, "synch_eval_env_connectors": 0.0003963479165569624, "synch_env_connectors": 8.36922967954888e-06}, "env_runners": {"num_episodes_lifetime": -14350.0, "env_to_module_connector": {"timers": {"connectors": {"add_observations_from_episodes_to_batch": 6.1143365035564685e-06, "numpy_to_tensor": 3.064177064232567e-05, "add_time_dim_to_batch_and_zero_pad": 6.205106116334703e-06, "batch_individual_items": 1.8751466056457557e-05, "add_states_from_episodes_to_batch": 3.369293199305513e-06}}, "connector_pipeline_timer": 0.00011729405387047944}, "agent_episode_returns_mean": {"default_agent": 10.1}, "module_episode_returns_mean": {"default_policy": 10.1}, "num_episodes": 100.0, "time_between_sampling": 0.011927616597116468, "num_agent_steps_sampled": {"default_agent": 5000.0}, "num_agent_steps_sampled_lifetime": {"default_agent": -717500.0}, "episode_len_max": 50, "rlmodule_inference_timer": 9.764853847062936e-05, "sample": 0.0375061953802134, "module_to_env_connector": {"timers": {"connectors": {"un_batch_to_individual_items": 1.4516804379114538e-05, "normalize_and_clip_actions": 2.2071133632263362e-05, "tensor_to_numpy": 4.829491606543118e-05, "listify_data_for_vector_env": 3.1264331575330876e-05, "remove_single_ts_time_rank_from_batch": 1.469825413169887e-06, "get_actions": 0.00016195121383784543}}, "connector_pipeline_timer": 0.00035512868079207735}, "env_step_timer": 4.203379048808693e-05, "episode_len_mean": 50.0, "num_module_steps_sampled_lifetime": {"default_policy": -717500.0}, "env_reset_timer": 9.509173836478877e-05, "env_to_module_sum_episodes_length_in": 27.16809333212661, "weights_seq_no": 4.0, "episode_duration_sec_mean": 0.03586329199002647, "episode_return_max": 14.5, "num_env_steps_sampled_lifetime": -717500.0, "env_to_module_sum_episodes_length_out": 27.16809333212661, "num_module_steps_sampled": {"default_policy": 5000.0}, "episode_return_min": -5.5, "num_env_steps_sampled": 5000.0, "episode_return_mean": 10.1, "episode_len_min": 50, "num_env_steps_sampled_lifetime_throughput": 1301.1578521286829}, "learners": {"default_policy": {"vf_explained_var": 0.032855212688446045, "num_trainable_parameters": 7055, "vf_loss_unclipped": 63.434383392333984, "vf_loss": 0.4440121650695801, "weights_seq_no": 5.0, "entropy": 0.6384875178337097, "policy_loss": 0.30006492137908936, "mean_kl_loss": 0.0011102018179371953, "gradients_default_optimizer_global_norm": 0.1193845123052597, "num_module_steps_trained": 6000, "default_optimizer_learning_rate": 0.0004386306194, "total_loss": 0.5591170191764832, "diff_num_grad_updates_vs_sampler_policy": 1.0, "curr_kl_coeff": 0.019068002700805664, "module_train_batch_size_mean": 1000.0, "curr_entropy_coeff": 0.0376490504491, "num_module_steps_trained_lifetime": 30000, "num_module_steps_trained_lifetime_throughput": 203679.67188047984}, "__all_modules__": {"num_env_steps_trained": 30600, "num_env_steps_trained_lifetime": 153000, "learner_connector": {"timers": {"connectors": {"add_columns_from_episodes_to_train_batch": 0.07006352788632372, "add_observations_from_episodes_to_batch": 0.0007621077930015216, "add_time_dim_to_batch_and_zero_pad": 1.9913403561169546e-05, "add_one_ts_to_episodes_and_truncate": 0.00848657814977938, "numpy_to_tensor": 0.00015953328643803576, "batch_individual_items": 0.1934066822989649, "general_advantage_estimation": 0.011343458790234101, "add_states_from_episodes_to_batch": 5.896980056556011e-06}}, "connector_pipeline_timer": 0.2845952754689}, "num_non_trainable_parameters": 0, "num_module_steps_trained_lifetime": 30000, "learner_connector_sum_episodes_length_in": 5000.0, "num_trainable_parameters": 7055, "learner_connector_sum_episodes_length_out": 5100.0, "num_module_steps_trained": 6000, "num_env_steps_trained_lifetime_throughput": 1030326.1620243028, "num_module_steps_trained_throughput": 203185.12172788242, "num_module_steps_trained_lifetime_throughput": 202919.8130958773}}, "num_training_step_calls_per_iteration": 1, "evaluation": {"env_runners": {"env_to_module_sum_episodes_length_in": 27.168093332126602, "module_to_env_connector": {"timers": {"connectors": {"un_batch_to_individual_items": 1.538248433907467e-05, "tensor_to_numpy": 4.4546390764654037e-05, "get_actions": 0.0001539593882002854, "normalize_and_clip_actions": 2.189659316186088e-05, "listify_data_for_vector_env": 3.039418367821968e-05, "remove_single_ts_time_rank_from_batch": 1.3967773121760393e-06}}, "connector_pipeline_timer": 0.00033886248846309}, "episode_return_max": 17.5, "episode_len_min": 50, "sample": 0.7254794434415395, "agent_episode_returns_mean": {"default_agent": -2.7}, "episode_len_mean": 50.0, "env_to_module_connector": {"timers": {"connectors": {"batch_individual_items": 1.7647700407068507e-05, "numpy_to_tensor": 2.858440134627811e-05, "add_states_from_episodes_to_batch": 3.22132922366839e-06, "add_observations_from_episodes_to_batch": 5.924502863473797e-06, "add_time_dim_to_batch_and_zero_pad": 5.3733365622816284e-06}}, "connector_pipeline_timer": 0.00011020634415577116}, "weights_seq_no": 5.0, "episode_return_min": -16.5, "num_module_steps_sampled_lifetime": {"default_policy": 5000}, "num_episodes": 20, "episode_len_max": 50, "env_reset_timer": 0.00021072438225752543, "num_env_steps_sampled_lifetime": 26000, "env_to_module_sum_episodes_length_out": 27.168093332126602, "num_episodes_lifetime": 100, "num_module_steps_sampled": {"default_policy": 1000}, "rlmodule_inference_timer": 9.480697651233081e-05, "module_episode_returns_mean": {"default_policy": -2.7}, "num_agent_steps_sampled": {"default_agent": 1000}, "num_agent_steps_sampled_lifetime": {"default_agent": 5000}, "episode_duration_sec_mean": 0.034755527010038346, "num_env_steps_sampled": 1000, "episode_return_mean": -2.7, "env_step_timer": 4.109330821070668e-05, "time_between_sampling": 4.119145499412817}, "num_healthy_workers": 1, "actor_manager_num_outstanding_async_reqs": 0, "num_remote_worker_restarts": 0}, "num_env_steps_sampled_lifetime": -717500.0, "fault_tolerance": {"num_healthy_workers": 0, "num_remote_worker_restarts": 0}, "env_runner_group": {"actor_manager_num_outstanding_async_reqs": 0}, "done": false, "training_iteration": 5, "trial_id": "6e27d_00000", "date": "2025-08-11_17-40-59", "timestamp": 1754926859, "time_this_iter_s": 4.758800983428955, "time_total_s": 24.389054775238037, "pid": 89029, "hostname": "DESKTOP-3SK5A41", "node_ip": "192.168.40.242", "config": {"exploration_config": {}, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 6, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "env": "Umbrella", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": false, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 0, "create_local_env_runner": true, "num_envs_per_env_runner": 1, "gym_env_vectorize_mode": "SYNC", "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "episodes_to_numpy": true, "max_requests_in_flight_per_env_runner": 1, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "merge_env_runner_states": "training_only", "broadcast_env_runner_states": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "complete_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "sampler_perf_stats_ema_coef": null, "_is_online": true, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": "auto", "num_aggregator_actors_per_learner": 0, "max_requests_in_flight_per_aggregator_actor": 3, "local_gpu_idx": 0, "max_requests_in_flight_per_learner": 3, "gamma": 1, "lr": 0.0004386306194, "grad_clip": 0.5, "grad_clip_by": "global_norm", "_train_batch_size_per_learner": 5000, "train_batch_size": 4000, "num_epochs": 1, "minibatch_size": 1000, "shuffle_batch_per_epoch": true, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "log_std_clip_param": 20.0, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "_disable_preprocessor_api": false, "_disable_action_flattening": false}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "_learner_class": null, "callbacks_on_algorithm_init": null, "callbacks_on_env_runners_recreated": null, "callbacks_on_offline_eval_runners_recreated": null, "callbacks_on_checkpoint_loaded": null, "callbacks_on_environment_created": null, "callbacks_on_episode_created": null, "callbacks_on_episode_start": null, "callbacks_on_episode_step": null, "callbacks_on_episode_end": null, "callbacks_on_evaluate_start": null, "callbacks_on_evaluate_end": null, "callbacks_on_evaluate_offline_start": null, "callbacks_on_evaluate_offline_end": null, "callbacks_on_sample_end": null, "callbacks_on_train_result": null, "explore": true, "enable_rl_module_and_learner": true, "enable_env_runner_and_connector_v2": true, "_prior_exploration_config": {"type": "StochasticSampling"}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x760009bd6ac0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "offline_data_class": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_read_batch_size": null, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "materialize_data": false, "materialize_mapped_data": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "ignore_final_observation": false, "prelearner_class": null, "prelearner_buffer_class": null, "prelearner_buffer_kwargs": {}, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_remaining_data": false, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": 1, "evaluation_duration": 20, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_auto_duration_min_env_steps_per_sample": 100, "evaluation_auto_duration_max_env_steps_per_sample": 2000, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 1, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "offline_evaluation_interval": null, "num_offline_eval_runners": 0, "offline_loss_for_module_fn": null, "offline_evaluation_duration": 1, "offline_evaluation_parallel_to_training": false, "offline_evaluation_timeout_s": 120.0, "num_cpus_per_offline_eval_runner": 1, "num_gpus_per_offline_eval_runner": 0, "custom_resources_per_offline_eval_runner": {}, "restart_failed_offline_eval_runners": true, "ignore_offline_eval_runner_failures": false, "max_num_offline_eval_runner_restarts": 1000, "offline_eval_runner_restore_timeout_s": 1800.0, "max_requests_in_flight_per_offline_eval_runner": 1, "validate_offline_eval_runners_after_construction": true, "offline_eval_runner_health_probe_timeout_s": 30.0, "offline_eval_rl_module_inference_only": false, "broadcast_offline_eval_runner_states": false, "offline_eval_batch_size_per_runner": 256, "dataset_num_iters_per_eval_runner": 1, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "log_gradients": true, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 42, "restart_failed_env_runners": true, "ignore_env_runner_failures": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30.0, "env_runner_restore_timeout_s": 1800.0, "_model_config": {}, "_rl_module_spec": "RLModuleSpec(module_class=None, observation_space=None, action_space=None, inference_only=False, learner_only=False, model_config=DefaultModelConfig(fcnet_hiddens=[89, 72], fcnet_activation='tanh', fcnet_kernel_initializer=None, fcnet_kernel_initializer_kwargs=None, fcnet_bias_initializer=None, fcnet_bias_initializer_kwargs=None, conv_filters=None, conv_activation='relu', conv_kernel_initializer=None, conv_kernel_initializer_kwargs=None, conv_bias_initializer=None, conv_bias_initializer_kwargs=None, head_fcnet_hiddens=[], head_fcnet_activation='relu', head_fcnet_kernel_initializer=None, head_fcnet_kernel_initializer_kwargs=None, head_fcnet_bias_initializer=None, head_fcnet_bias_initializer_kwargs=None, free_log_std=False, log_std_clip_param=20.0, vf_share_layers=True, use_lstm=False, max_seq_len=20, lstm_cell_size=256, lstm_use_prev_action=False, lstm_use_prev_reward=False, lstm_kernel_initializer=None, lstm_kernel_initializer_kwargs=None, lstm_bias_initializer=None, lstm_bias_initializer_kwargs=None), catalog_class=None, load_state_path=None, model_config_dict=None)", "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "_validate_config": true, "_use_msgpack_checkpoints": false, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "env_task_fn": -1, "enable_connectors": -1, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.6101760640943, "kl_target": 0.0088832044531, "vf_loss_coeff": 0.6374785266784, "entropy_coeff": 0.0376490504491, "clip_param": 0.2961700372778, "vf_clip_param": 0.4555106473841, "entropy_coeff_schedule": null, "lr_schedule": null, "sgd_minibatch_size": -1, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9828134201416, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.callbacks.callbacks.RLlibCallback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 24.389054775238037, "iterations_since_restore": 5, "perf": {"cpu_util_percent": 12.283333333333333, "ram_util_percent": 79.0}}
{"timers": {"training_iteration": 4.148205540958851, "restore_env_runners": 1.4467307106122973e-05, "training_step": 4.147996800129923, "env_runner_sampling_timer": 3.752591653913016, "learner_update_timer": 0.39206147758075294, "synch_weights": 0.001402611427695715, "restore_eval_env_runners": 1.309465081064079e-05, "evaluation_iteration": 0.7371678522209495, "synch_eval_env_connectors": 0.0003961524373973409, "synch_env_connectors": 8.347537381914737e-06}, "env_runners": {"num_episodes_lifetime": -19200.0, "env_to_module_connector": {"timers": {"connectors": {"add_observations_from_episodes_to_batch": 6.203740970362678e-06, "numpy_to_tensor": 3.067316582533108e-05, "add_time_dim_to_batch_and_zero_pad": 6.259710083773314e-06, "batch_individual_items": 1.8846507541718755e-05, "add_states_from_episodes_to_batch": 3.3992722955399905e-06}}, "connector_pipeline_timer": 0.0001178114915332526}, "agent_episode_returns_mean": {"default_agent": 9.9}, "module_episode_returns_mean": {"default_policy": 9.9}, "num_episodes": 100.0, "time_between_sampling": 0.0113797498215068, "num_agent_steps_sampled": {"default_agent": 5000.0}, "num_agent_steps_sampled_lifetime": {"default_agent": -960000.0}, "episode_len_max": 50, "rlmodule_inference_timer": 9.877726017701723e-05, "sample": 0.03719577962018544, "module_to_env_connector": {"timers": {"connectors": {"un_batch_to_individual_items": 1.4613455504448985e-05, "normalize_and_clip_actions": 2.2176405783953276e-05, "tensor_to_numpy": 4.852697824998332e-05, "listify_data_for_vector_env": 3.1657759311848646e-05, "remove_single_ts_time_rank_from_batch": 1.4890996556961452e-06, "get_actions": 0.00016264985596556943}}, "connector_pipeline_timer": 0.00035698270600485174}, "env_step_timer": 4.2143661194061084e-05, "episode_len_mean": 50.0, "num_module_steps_sampled_lifetime": {"default_policy": -960000.0}, "env_reset_timer": 9.223761108977754e-05, "env_to_module_sum_episodes_length_in": 27.16809333212661, "weights_seq_no": 5.0, "episode_duration_sec_mean": 0.03603550699002879, "episode_return_max": 14.5, "num_env_steps_sampled_lifetime": -960000.0, "env_to_module_sum_episodes_length_out": 27.16809333212661, "num_module_steps_sampled": {"default_policy": 5000.0}, "episode_return_min": -5.5, "num_env_steps_sampled": 5000.0, "episode_return_mean": 9.9, "episode_len_min": 50, "num_env_steps_sampled_lifetime_throughput": 1297.9799330362328}, "learners": {"default_policy": {"vf_explained_var": 0.04707533121109009, "num_trainable_parameters": 7055, "vf_loss_unclipped": 83.41609954833984, "vf_loss": 0.45138949155807495, "weights_seq_no": 6.0, "entropy": 0.6537779569625854, "policy_loss": -0.3579336106777191, "mean_kl_loss": 0.00011571335926419124, "gradients_default_optimizer_global_norm": 0.045532360672950745, "num_module_steps_trained": 6000, "default_optimizer_learning_rate": 0.0004386306194, "total_loss": -0.09479445964097977, "diff_num_grad_updates_vs_sampler_policy": 1.0, "curr_kl_coeff": 0.009534001350402832, "module_train_batch_size_mean": 1000.0, "curr_entropy_coeff": 0.0376490504491, "num_module_steps_trained_lifetime": 36000, "num_module_steps_trained_lifetime_throughput": 202050.84759025436}, "__all_modules__": {"num_env_steps_trained": 30600, "num_env_steps_trained_lifetime": 183600, "learner_connector": {"timers": {"connectors": {"add_columns_from_episodes_to_train_batch": 0.07004234560746295, "add_observations_from_episodes_to_batch": 0.0007614947150738218, "add_time_dim_to_batch_and_zero_pad": 1.9896269528963696e-05, "add_one_ts_to_episodes_and_truncate": 0.008484541368284262, "numpy_to_tensor": 0.00015960695357660384, "batch_individual_items": 0.19352434347598108, "general_advantage_estimation": 0.011333271202338138, "add_states_from_episodes_to_batch": 5.887010256207799e-06}}, "connector_pipeline_timer": 0.2846783377142107}, "num_non_trainable_parameters": 0, "num_module_steps_trained_lifetime": 36000, "learner_connector_sum_episodes_length_in": 5000.0, "num_trainable_parameters": 7055, "learner_connector_sum_episodes_length_out": 5100.0, "num_module_steps_trained": 6000, "num_env_steps_trained_lifetime_throughput": 1022367.110857644, "num_module_steps_trained_throughput": 201586.98453608315, "num_module_steps_trained_lifetime_throughput": 201328.4265525171}}, "num_training_step_calls_per_iteration": 1, "evaluation": {"env_runners": {"env_to_module_sum_episodes_length_in": 27.168093332126602, "module_to_env_connector": {"timers": {"connectors": {"un_batch_to_individual_items": 1.531367704939229e-05, "tensor_to_numpy": 4.496502312727522e-05, "get_actions": 0.00015444589579425796, "normalize_and_clip_actions": 2.189422562733112e-05, "listify_data_for_vector_env": 3.053477895112332e-05, "remove_single_ts_time_rank_from_batch": 1.379879612299294e-06}}, "connector_pipeline_timer": 0.00034021768633786385}, "episode_return_max": 17.5, "episode_len_min": 50, "sample": 0.7254505130071259, "agent_episode_returns_mean": {"default_agent": -2.5}, "episode_len_mean": 50.0, "env_to_module_connector": {"timers": {"connectors": {"batch_individual_items": 1.7826729502612033e-05, "numpy_to_tensor": 2.924648335883223e-05, "add_states_from_episodes_to_batch": 3.2962587097351366e-06, "add_observations_from_episodes_to_batch": 6.074710498155511e-06, "add_time_dim_to_batch_and_zero_pad": 5.553026204554619e-06}}, "connector_pipeline_timer": 0.0001117705210148612}, "weights_seq_no": 6.0, "episode_return_min": -16.5, "num_module_steps_sampled_lifetime": {"default_policy": 6000}, "num_episodes": 20, "episode_len_max": 50, "env_reset_timer": 0.00020989513843467942, "num_env_steps_sampled_lifetime": 31000, "env_to_module_sum_episodes_length_out": 27.168093332126602, "num_episodes_lifetime": 120, "num_module_steps_sampled": {"default_policy": 1000}, "rlmodule_inference_timer": 9.427198454758868e-05, "module_episode_returns_mean": {"default_policy": -2.5}, "num_agent_steps_sampled": {"default_agent": 1000}, "num_agent_steps_sampled_lifetime": {"default_agent": 6000}, "episode_duration_sec_mean": 0.034728894010022486, "num_env_steps_sampled": 1000, "episode_return_mean": -2.5, "env_step_timer": 4.1514675684106955e-05, "time_between_sampling": 4.120350549408681}, "num_healthy_workers": 1, "actor_manager_num_outstanding_async_reqs": 0, "num_remote_worker_restarts": 0}, "num_env_steps_sampled_lifetime": -960000.0, "fault_tolerance": {"num_healthy_workers": 0, "num_remote_worker_restarts": 0}, "env_runner_group": {"actor_manager_num_outstanding_async_reqs": 0}, "done": false, "training_iteration": 6, "trial_id": "6e27d_00000", "date": "2025-08-11_17-41-04", "timestamp": 1754926864, "time_this_iter_s": 4.922776460647583, "time_total_s": 29.31183123588562, "pid": 89029, "hostname": "DESKTOP-3SK5A41", "node_ip": "192.168.40.242", "config": {"exploration_config": {}, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 6, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "env": "Umbrella", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": false, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 0, "create_local_env_runner": true, "num_envs_per_env_runner": 1, "gym_env_vectorize_mode": "SYNC", "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "episodes_to_numpy": true, "max_requests_in_flight_per_env_runner": 1, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "merge_env_runner_states": "training_only", "broadcast_env_runner_states": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "complete_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "sampler_perf_stats_ema_coef": null, "_is_online": true, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": "auto", "num_aggregator_actors_per_learner": 0, "max_requests_in_flight_per_aggregator_actor": 3, "local_gpu_idx": 0, "max_requests_in_flight_per_learner": 3, "gamma": 1, "lr": 0.0004386306194, "grad_clip": 0.5, "grad_clip_by": "global_norm", "_train_batch_size_per_learner": 5000, "train_batch_size": 4000, "num_epochs": 1, "minibatch_size": 1000, "shuffle_batch_per_epoch": true, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "log_std_clip_param": 20.0, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "_disable_preprocessor_api": false, "_disable_action_flattening": false}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "_learner_class": null, "callbacks_on_algorithm_init": null, "callbacks_on_env_runners_recreated": null, "callbacks_on_offline_eval_runners_recreated": null, "callbacks_on_checkpoint_loaded": null, "callbacks_on_environment_created": null, "callbacks_on_episode_created": null, "callbacks_on_episode_start": null, "callbacks_on_episode_step": null, "callbacks_on_episode_end": null, "callbacks_on_evaluate_start": null, "callbacks_on_evaluate_end": null, "callbacks_on_evaluate_offline_start": null, "callbacks_on_evaluate_offline_end": null, "callbacks_on_sample_end": null, "callbacks_on_train_result": null, "explore": true, "enable_rl_module_and_learner": true, "enable_env_runner_and_connector_v2": true, "_prior_exploration_config": {"type": "StochasticSampling"}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x760009bd6ac0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "offline_data_class": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_read_batch_size": null, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "materialize_data": false, "materialize_mapped_data": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "ignore_final_observation": false, "prelearner_class": null, "prelearner_buffer_class": null, "prelearner_buffer_kwargs": {}, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_remaining_data": false, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": 1, "evaluation_duration": 20, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_auto_duration_min_env_steps_per_sample": 100, "evaluation_auto_duration_max_env_steps_per_sample": 2000, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 1, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "offline_evaluation_interval": null, "num_offline_eval_runners": 0, "offline_loss_for_module_fn": null, "offline_evaluation_duration": 1, "offline_evaluation_parallel_to_training": false, "offline_evaluation_timeout_s": 120.0, "num_cpus_per_offline_eval_runner": 1, "num_gpus_per_offline_eval_runner": 0, "custom_resources_per_offline_eval_runner": {}, "restart_failed_offline_eval_runners": true, "ignore_offline_eval_runner_failures": false, "max_num_offline_eval_runner_restarts": 1000, "offline_eval_runner_restore_timeout_s": 1800.0, "max_requests_in_flight_per_offline_eval_runner": 1, "validate_offline_eval_runners_after_construction": true, "offline_eval_runner_health_probe_timeout_s": 30.0, "offline_eval_rl_module_inference_only": false, "broadcast_offline_eval_runner_states": false, "offline_eval_batch_size_per_runner": 256, "dataset_num_iters_per_eval_runner": 1, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "log_gradients": true, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 42, "restart_failed_env_runners": true, "ignore_env_runner_failures": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30.0, "env_runner_restore_timeout_s": 1800.0, "_model_config": {}, "_rl_module_spec": "RLModuleSpec(module_class=None, observation_space=None, action_space=None, inference_only=False, learner_only=False, model_config=DefaultModelConfig(fcnet_hiddens=[89, 72], fcnet_activation='tanh', fcnet_kernel_initializer=None, fcnet_kernel_initializer_kwargs=None, fcnet_bias_initializer=None, fcnet_bias_initializer_kwargs=None, conv_filters=None, conv_activation='relu', conv_kernel_initializer=None, conv_kernel_initializer_kwargs=None, conv_bias_initializer=None, conv_bias_initializer_kwargs=None, head_fcnet_hiddens=[], head_fcnet_activation='relu', head_fcnet_kernel_initializer=None, head_fcnet_kernel_initializer_kwargs=None, head_fcnet_bias_initializer=None, head_fcnet_bias_initializer_kwargs=None, free_log_std=False, log_std_clip_param=20.0, vf_share_layers=True, use_lstm=False, max_seq_len=20, lstm_cell_size=256, lstm_use_prev_action=False, lstm_use_prev_reward=False, lstm_kernel_initializer=None, lstm_kernel_initializer_kwargs=None, lstm_bias_initializer=None, lstm_bias_initializer_kwargs=None), catalog_class=None, load_state_path=None, model_config_dict=None)", "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "_validate_config": true, "_use_msgpack_checkpoints": false, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "env_task_fn": -1, "enable_connectors": -1, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.6101760640943, "kl_target": 0.0088832044531, "vf_loss_coeff": 0.6374785266784, "entropy_coeff": 0.0376490504491, "clip_param": 0.2961700372778, "vf_clip_param": 0.4555106473841, "entropy_coeff_schedule": null, "lr_schedule": null, "sgd_minibatch_size": -1, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9828134201416, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.callbacks.callbacks.RLlibCallback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 29.31183123588562, "iterations_since_restore": 6, "perf": {"cpu_util_percent": 11.8625, "ram_util_percent": 79.0}}
{"timers": {"training_iteration": 4.146812254529258, "restore_env_runners": 1.4434634032959982e-05, "training_step": 4.1466021021086235, "env_runner_sampling_timer": 3.7533327213538876, "learner_update_timer": 0.3899235048049528, "synch_weights": 0.001402172313421857, "restore_eval_env_runners": 1.3073704303393526e-05, "evaluation_iteration": 0.737123497698738, "synch_eval_env_connectors": 0.0003971559130216323, "synch_env_connectors": 8.330062010430065e-06}, "env_runners": {"num_episodes_lifetime": -24050.0, "env_to_module_connector": {"timers": {"connectors": {"add_observations_from_episodes_to_batch": 6.097881910405891e-06, "numpy_to_tensor": 3.0569521255343425e-05, "add_time_dim_to_batch_and_zero_pad": 6.2045891231419215e-06, "batch_individual_items": 1.8738127306001867e-05, "add_states_from_episodes_to_batch": 3.354707413900654e-06}}, "connector_pipeline_timer": 0.00011712517556955621}, "agent_episode_returns_mean": {"default_agent": 9.5}, "module_episode_returns_mean": {"default_policy": 9.5}, "num_episodes": 100.0, "time_between_sampling": 0.012110013787602507, "num_agent_steps_sampled": {"default_agent": 5000.0}, "num_agent_steps_sampled_lifetime": {"default_agent": -1202500.0}, "episode_len_max": 50, "rlmodule_inference_timer": 9.761197555335682e-05, "sample": 0.0369915574193906, "module_to_env_connector": {"timers": {"connectors": {"un_batch_to_individual_items": 1.458213521716027e-05, "normalize_and_clip_actions": 2.1951117577750142e-05, "tensor_to_numpy": 4.809130666552134e-05, "listify_data_for_vector_env": 3.1344949762326725e-05, "remove_single_ts_time_rank_from_batch": 1.4582279230161902e-06, "get_actions": 0.00016172787949778053}}, "connector_pipeline_timer": 0.0003544678395281977}, "env_step_timer": 4.168354967361089e-05, "episode_len_mean": 50.0, "num_module_steps_sampled_lifetime": {"default_policy": -1202500.0}, "env_reset_timer": 9.037266761398487e-05, "env_to_module_sum_episodes_length_in": 27.16809333212661, "weights_seq_no": 6.0, "episode_duration_sec_mean": 0.035763343979951956, "episode_return_max": 14.5, "num_env_steps_sampled_lifetime": -1202500.0, "env_to_module_sum_episodes_length_out": 27.16809333212661, "num_module_steps_sampled": {"default_policy": 5000.0}, "episode_return_min": -5.5, "num_env_steps_sampled": 5000.0, "episode_return_mean": 9.5, "episode_len_min": 50, "num_env_steps_sampled_lifetime_throughput": 1305.5466024088614}, "learners": {"default_policy": {"vf_explained_var": 0.053653061389923096, "num_trainable_parameters": 7055, "vf_loss_unclipped": 87.9405746459961, "vf_loss": 0.4528121054172516, "weights_seq_no": 7.0, "entropy": 0.6550392508506775, "policy_loss": -0.45683014392852783, "mean_kl_loss": 5.681049151462503e-05, "gradients_default_optimizer_global_norm": 0.04992608726024628, "num_module_steps_trained": 6000, "default_optimizer_learning_rate": 0.0004386306194, "total_loss": -0.1928332895040512, "diff_num_grad_updates_vs_sampler_policy": 1.0, "curr_kl_coeff": 0.004767000675201416, "module_train_batch_size_mean": 1000.0, "curr_entropy_coeff": 0.0376490504491, "num_module_steps_trained_lifetime": 42000, "num_module_steps_trained_lifetime_throughput": 200356.90180307388}, "__all_modules__": {"num_env_steps_trained": 30600, "num_env_steps_trained_lifetime": 214200, "learner_connector": {"timers": {"connectors": {"add_columns_from_episodes_to_train_batch": 0.07001462615138702, "add_observations_from_episodes_to_batch": 0.0007617707679187358, "add_time_dim_to_batch_and_zero_pad": 1.9878306829465415e-05, "add_one_ts_to_episodes_and_truncate": 0.00848171395460421, "numpy_to_tensor": 0.0001596098840473736, "batch_individual_items": 0.1921580930412184, "general_advantage_estimation": 0.011312298490322586, "add_states_from_episodes_to_batch": 5.8791401599971075e-06}}, "connector_pipeline_timer": 0.28326031933706913}, "num_non_trainable_parameters": 0, "num_module_steps_trained_lifetime": 42000, "learner_connector_sum_episodes_length_in": 5000.0, "num_trainable_parameters": 7055, "learner_connector_sum_episodes_length_out": 5100.0, "num_module_steps_trained": 6000, "num_env_steps_trained_lifetime_throughput": 1014088.3135829279, "num_module_steps_trained_throughput": 199922.50719039436, "num_module_steps_trained_lifetime_throughput": 199671.86752228005}}, "num_training_step_calls_per_iteration": 1, "evaluation": {"env_runners": {"env_to_module_sum_episodes_length_in": 27.168093332126602, "module_to_env_connector": {"timers": {"connectors": {"un_batch_to_individual_items": 1.5500041476111236e-05, "tensor_to_numpy": 4.55054154903158e-05, "get_actions": 0.00015380405167683326, "normalize_and_clip_actions": 2.1832521811903647e-05, "listify_data_for_vector_env": 3.0019416357856668e-05, "remove_single_ts_time_rank_from_batch": 1.3682802800059618e-06}}, "connector_pipeline_timer": 0.0003395709112893254}, "episode_return_max": 17.5, "episode_len_min": 50, "sample": 0.725480068877055, "agent_episode_returns_mean": {"default_agent": -1.5}, "episode_len_mean": 50.0, "env_to_module_connector": {"timers": {"connectors": {"batch_individual_items": 1.8049798254154573e-05, "numpy_to_tensor": 2.8933282043646812e-05, "add_states_from_episodes_to_batch": 3.3791079558204778e-06, "add_observations_from_episodes_to_batch": 6.036095776815343e-06, "add_time_dim_to_batch_and_zero_pad": 5.460510309267715e-06}}, "connector_pipeline_timer": 0.00011146351934438934}, "weights_seq_no": 7.0, "episode_return_min": -16.5, "num_module_steps_sampled_lifetime": {"default_policy": 7000}, "num_episodes": 20, "episode_len_max": 50, "env_reset_timer": 0.0002092531870488141, "num_env_steps_sampled_lifetime": 36000, "env_to_module_sum_episodes_length_out": 27.168093332126602, "num_episodes_lifetime": 140, "num_module_steps_sampled": {"default_policy": 1000}, "rlmodule_inference_timer": 9.508760132536093e-05, "module_episode_returns_mean": {"default_policy": -1.5}, "num_agent_steps_sampled": {"default_agent": 1000}, "num_agent_steps_sampled_lifetime": {"default_agent": 7000}, "episode_duration_sec_mean": 0.03484328501001073, "num_env_steps_sampled": 1000, "episode_return_mean": -1.5, "env_step_timer": 4.15589785457316e-05, "time_between_sampling": 4.11977355789459}, "num_healthy_workers": 1, "actor_manager_num_outstanding_async_reqs": 0, "num_remote_worker_restarts": 0}, "num_env_steps_sampled_lifetime": -1202500.0, "fault_tolerance": {"num_healthy_workers": 0, "num_remote_worker_restarts": 0}, "env_runner_group": {"actor_manager_num_outstanding_async_reqs": 0}, "done": true, "training_iteration": 7, "trial_id": "6e27d_00000", "date": "2025-08-11_17-41-09", "timestamp": 1754926869, "time_this_iter_s": 4.751577377319336, "time_total_s": 34.063408613204956, "pid": 89029, "hostname": "DESKTOP-3SK5A41", "node_ip": "192.168.40.242", "config": {"exploration_config": {}, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 6, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "env": "Umbrella", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": false, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 0, "create_local_env_runner": true, "num_envs_per_env_runner": 1, "gym_env_vectorize_mode": "SYNC", "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "episodes_to_numpy": true, "max_requests_in_flight_per_env_runner": 1, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "merge_env_runner_states": "training_only", "broadcast_env_runner_states": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "complete_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "sampler_perf_stats_ema_coef": null, "_is_online": true, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": "auto", "num_aggregator_actors_per_learner": 0, "max_requests_in_flight_per_aggregator_actor": 3, "local_gpu_idx": 0, "max_requests_in_flight_per_learner": 3, "gamma": 1, "lr": 0.0004386306194, "grad_clip": 0.5, "grad_clip_by": "global_norm", "_train_batch_size_per_learner": 5000, "train_batch_size": 4000, "num_epochs": 1, "minibatch_size": 1000, "shuffle_batch_per_epoch": true, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "log_std_clip_param": 20.0, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "_disable_preprocessor_api": false, "_disable_action_flattening": false}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "_learner_class": null, "callbacks_on_algorithm_init": null, "callbacks_on_env_runners_recreated": null, "callbacks_on_offline_eval_runners_recreated": null, "callbacks_on_checkpoint_loaded": null, "callbacks_on_environment_created": null, "callbacks_on_episode_created": null, "callbacks_on_episode_start": null, "callbacks_on_episode_step": null, "callbacks_on_episode_end": null, "callbacks_on_evaluate_start": null, "callbacks_on_evaluate_end": null, "callbacks_on_evaluate_offline_start": null, "callbacks_on_evaluate_offline_end": null, "callbacks_on_sample_end": null, "callbacks_on_train_result": null, "explore": true, "enable_rl_module_and_learner": true, "enable_env_runner_and_connector_v2": true, "_prior_exploration_config": {"type": "StochasticSampling"}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x760009bd6ac0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "offline_data_class": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_read_batch_size": null, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "materialize_data": false, "materialize_mapped_data": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "ignore_final_observation": false, "prelearner_class": null, "prelearner_buffer_class": null, "prelearner_buffer_kwargs": {}, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_remaining_data": false, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": 1, "evaluation_duration": 20, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_auto_duration_min_env_steps_per_sample": 100, "evaluation_auto_duration_max_env_steps_per_sample": 2000, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 1, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "offline_evaluation_interval": null, "num_offline_eval_runners": 0, "offline_loss_for_module_fn": null, "offline_evaluation_duration": 1, "offline_evaluation_parallel_to_training": false, "offline_evaluation_timeout_s": 120.0, "num_cpus_per_offline_eval_runner": 1, "num_gpus_per_offline_eval_runner": 0, "custom_resources_per_offline_eval_runner": {}, "restart_failed_offline_eval_runners": true, "ignore_offline_eval_runner_failures": false, "max_num_offline_eval_runner_restarts": 1000, "offline_eval_runner_restore_timeout_s": 1800.0, "max_requests_in_flight_per_offline_eval_runner": 1, "validate_offline_eval_runners_after_construction": true, "offline_eval_runner_health_probe_timeout_s": 30.0, "offline_eval_rl_module_inference_only": false, "broadcast_offline_eval_runner_states": false, "offline_eval_batch_size_per_runner": 256, "dataset_num_iters_per_eval_runner": 1, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "log_gradients": true, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 42, "restart_failed_env_runners": true, "ignore_env_runner_failures": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30.0, "env_runner_restore_timeout_s": 1800.0, "_model_config": {}, "_rl_module_spec": "RLModuleSpec(module_class=None, observation_space=None, action_space=None, inference_only=False, learner_only=False, model_config=DefaultModelConfig(fcnet_hiddens=[89, 72], fcnet_activation='tanh', fcnet_kernel_initializer=None, fcnet_kernel_initializer_kwargs=None, fcnet_bias_initializer=None, fcnet_bias_initializer_kwargs=None, conv_filters=None, conv_activation='relu', conv_kernel_initializer=None, conv_kernel_initializer_kwargs=None, conv_bias_initializer=None, conv_bias_initializer_kwargs=None, head_fcnet_hiddens=[], head_fcnet_activation='relu', head_fcnet_kernel_initializer=None, head_fcnet_kernel_initializer_kwargs=None, head_fcnet_bias_initializer=None, head_fcnet_bias_initializer_kwargs=None, free_log_std=False, log_std_clip_param=20.0, vf_share_layers=True, use_lstm=False, max_seq_len=20, lstm_cell_size=256, lstm_use_prev_action=False, lstm_use_prev_reward=False, lstm_kernel_initializer=None, lstm_kernel_initializer_kwargs=None, lstm_bias_initializer=None, lstm_bias_initializer_kwargs=None), catalog_class=None, load_state_path=None, model_config_dict=None)", "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "_validate_config": true, "_use_msgpack_checkpoints": false, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "env_task_fn": -1, "enable_connectors": -1, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.6101760640943, "kl_target": 0.0088832044531, "vf_loss_coeff": 0.6374785266784, "entropy_coeff": 0.0376490504491, "clip_param": 0.2961700372778, "vf_clip_param": 0.4555106473841, "entropy_coeff_schedule": null, "lr_schedule": null, "sgd_minibatch_size": -1, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9828134201416, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.callbacks.callbacks.RLlibCallback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 34.063408613204956, "iterations_since_restore": 7, "perf": {"cpu_util_percent": 11.5, "ram_util_percent": 79.0}}
