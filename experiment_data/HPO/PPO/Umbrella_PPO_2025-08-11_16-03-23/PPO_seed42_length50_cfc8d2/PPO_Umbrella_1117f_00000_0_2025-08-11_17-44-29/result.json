{"timers": {"training_iteration": 4.3708410279996315, "restore_env_runners": 4.509999962465372e-05, "training_step": 4.370591728000363, "env_runner_sampling_timer": 3.9275442239995755, "learner_update_timer": 0.43945540400000027, "synch_weights": 0.0015831999999136315}, "env_runners": {"env_to_module_connector": {"timers": {"connectors": {"numpy_to_tensor": 3.220194899655638e-05, "add_states_from_episodes_to_batch": 3.654997677310633e-06, "add_observations_from_episodes_to_batch": 6.461771421316235e-06, "add_time_dim_to_batch_and_zero_pad": 6.776979781935202e-06, "batch_individual_items": 1.94760492772246e-05}}, "connector_pipeline_timer": 0.0001248067368784219}, "weights_seq_no": 0.0, "num_agent_steps_sampled": {"default_agent": 5000.0}, "num_episodes_lifetime": 5050.0, "module_to_env_connector": {"timers": {"connectors": {"un_batch_to_individual_items": 1.5333996896698543e-05, "normalize_and_clip_actions": 2.860784114723411e-05, "tensor_to_numpy": 4.8386914181057434e-05, "get_actions": 0.00017144584925712916, "listify_data_for_vector_env": 3.143623898861598e-05, "remove_single_ts_time_rank_from_batch": 1.5487770008321621e-06}}, "connector_pipeline_timer": 0.0003754702996194417}, "episode_return_max": 14.5, "episode_return_mean": 4.5, "env_step_timer": 4.525834721298645e-05, "time_between_sampling": 0.0012175691982250433, "episode_len_mean": 50.0, "episode_return_min": -5.5, "num_episodes": 100.0, "rlmodule_inference_timer": 0.0001054659057393835, "sample": 0.0393401858397281, "module_episode_returns_mean": {"default_policy": 4.5}, "agent_episode_returns_mean": {"default_agent": 4.5}, "num_module_steps_sampled": {"default_policy": 5000.0}, "env_to_module_sum_episodes_length_in": 26.762340024562445, "env_reset_timer": 0.00019116425882940912, "num_env_steps_sampled": 5000.0, "num_agent_steps_sampled_lifetime": {"default_agent": 252500.0}, "episode_duration_sec_mean": 0.03674490821997095, "num_env_steps_sampled_lifetime": 252500.0, "episode_len_max": 50, "env_to_module_sum_episodes_length_out": 26.762340024562445, "episode_len_min": 50, "num_module_steps_sampled_lifetime": {"default_policy": 252500.0}, "num_env_steps_sampled_lifetime_throughput": 1247.0724965834866}, "learners": {"__all_modules__": {"num_trainable_parameters": 5987, "learner_connector_sum_episodes_length_out": 5100, "num_module_steps_trained_lifetime": 11000, "learner_connector": {"timers": {"connectors": {"general_advantage_estimation": 0.014411000000109198, "add_time_dim_to_batch_and_zero_pad": 2.5100000129896216e-05, "numpy_to_tensor": 0.00020820000008825446, "add_states_from_episodes_to_batch": 6.799999937356915e-06, "add_one_ts_to_episodes_and_truncate": 0.008661300000312622, "add_columns_from_episodes_to_train_batch": 0.06978500100012752, "batch_individual_items": 0.20542360199942777, "add_observations_from_episodes_to_batch": 0.0007629000001543318}}, "connector_pipeline_timer": 0.2996639029997823}, "num_non_trainable_parameters": 0, "num_env_steps_trained": 56100, "num_module_steps_trained": 11000, "learner_connector_sum_episodes_length_in": 5000, "num_env_steps_trained_lifetime": 56100, "num_env_steps_trained_lifetime_throughput": 1054014.143410512, "num_module_steps_trained_throughput": 207425.95762549905, "num_module_steps_trained_lifetime_throughput": 207258.78488394324}, "default_policy": {"module_train_batch_size_mean": 1000.0, "num_trainable_parameters": 5987, "vf_explained_var": 0.2515529990196228, "curr_kl_coeff": 0.11631657183170319, "mean_kl_loss": 0.006611311342567205, "num_module_steps_trained": 11000, "vf_loss_unclipped": 9.005064964294434, "diff_num_grad_updates_vs_sampler_policy": 1.0, "total_loss": 0.10582409799098969, "default_optimizer_learning_rate": 0.0050505681543, "weights_seq_no": 1.0, "gradients_default_optimizer_global_norm": 0.36101749539375305, "entropy": 0.689060628414154, "policy_loss": 0.012072121724486351, "num_module_steps_trained_lifetime": 11000, "curr_entropy_coeff": 0.0045811242641, "vf_loss": 0.1845211535692215, "num_module_steps_trained_lifetime_throughput": 207819.232643684}}, "num_training_step_calls_per_iteration": 1, "num_env_steps_sampled_lifetime": 252500.0, "evaluation": {"env_runners": {"rlmodule_inference_timer": 9.57793710788942e-05, "num_episodes": 20, "module_to_env_connector": {"timers": {"connectors": {"tensor_to_numpy": 4.537753757281596e-05, "listify_data_for_vector_env": 3.0238282318406226e-05, "get_actions": 0.00015571474664288743, "remove_single_ts_time_rank_from_batch": 1.3370105112661343e-06, "un_batch_to_individual_items": 1.5155592068381523e-05, "normalize_and_clip_actions": 2.1914845893065338e-05}}, "connector_pipeline_timer": 0.0003442605218935455}, "env_reset_timer": 0.0002097000005960581, "num_env_steps_sampled": 1000, "env_to_module_connector": {"timers": {"connectors": {"add_observations_from_episodes_to_batch": 6.257547978175376e-06, "add_time_dim_to_batch_and_zero_pad": 5.380757082764975e-06, "numpy_to_tensor": 2.946149746975657e-05, "add_states_from_episodes_to_batch": 3.2689768147584764e-06, "batch_individual_items": 1.8290442977445462e-05}}, "connector_pipeline_timer": 0.0001140292112171192}, "num_agent_steps_sampled": {"default_agent": 1000}, "episode_len_max": 50, "module_episode_returns_mean": {"default_policy": -0.9}, "env_step_timer": 4.117705370024527e-05, "agent_episode_returns_mean": {"default_agent": -0.9}, "num_agent_steps_sampled_lifetime": {"default_agent": 1000}, "episode_len_mean": 50.0, "env_to_module_sum_episodes_length_in": 27.167134025045954, "env_to_module_sum_episodes_length_out": 27.167134025045954, "episode_len_min": 50, "num_module_steps_sampled": {"default_policy": 1000}, "episode_return_mean": -0.9, "episode_return_min": -16.5, "sample": 0.7352787070003615, "num_module_steps_sampled_lifetime": {"default_policy": 1000}, "episode_duration_sec_mean": 0.035323345300093935, "num_env_steps_sampled_lifetime": 6000, "weights_seq_no": 1.0, "num_episodes_lifetime": 20, "episode_return_max": 17.5}, "num_healthy_workers": 1, "actor_manager_num_outstanding_async_reqs": 0, "num_remote_worker_restarts": 0}, "fault_tolerance": {"num_healthy_workers": 0, "num_remote_worker_restarts": 0}, "env_runner_group": {"actor_manager_num_outstanding_async_reqs": 0}, "done": false, "training_iteration": 1, "trial_id": "1117f_00000", "date": "2025-08-11_17-55-02", "timestamp": 1754927702, "time_this_iter_s": 5.121421575546265, "time_total_s": 5.121421575546265, "pid": 101658, "hostname": "DESKTOP-3SK5A41", "node_ip": "192.168.40.242", "config": {"exploration_config": {}, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 6, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "env": "Umbrella", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": false, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 0, "create_local_env_runner": true, "num_envs_per_env_runner": 1, "gym_env_vectorize_mode": "SYNC", "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "episodes_to_numpy": true, "max_requests_in_flight_per_env_runner": 1, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "merge_env_runner_states": "training_only", "broadcast_env_runner_states": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "complete_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "sampler_perf_stats_ema_coef": null, "_is_online": true, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": "auto", "num_aggregator_actors_per_learner": 0, "max_requests_in_flight_per_aggregator_actor": 3, "local_gpu_idx": 0, "max_requests_in_flight_per_learner": 3, "gamma": 1, "lr": 0.0050505681543, "grad_clip": 0.5, "grad_clip_by": "global_norm", "_train_batch_size_per_learner": 5000, "train_batch_size": 4000, "num_epochs": 2, "minibatch_size": 1000, "shuffle_batch_per_epoch": true, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "log_std_clip_param": 20.0, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "_disable_preprocessor_api": false, "_disable_action_flattening": false}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "_learner_class": null, "callbacks_on_algorithm_init": null, "callbacks_on_env_runners_recreated": null, "callbacks_on_offline_eval_runners_recreated": null, "callbacks_on_checkpoint_loaded": null, "callbacks_on_environment_created": null, "callbacks_on_episode_created": null, "callbacks_on_episode_start": null, "callbacks_on_episode_step": null, "callbacks_on_episode_end": null, "callbacks_on_evaluate_start": null, "callbacks_on_evaluate_end": null, "callbacks_on_evaluate_offline_start": null, "callbacks_on_evaluate_offline_end": null, "callbacks_on_sample_end": null, "callbacks_on_train_result": null, "explore": true, "enable_rl_module_and_learner": true, "enable_env_runner_and_connector_v2": true, "_prior_exploration_config": {"type": "StochasticSampling"}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x77ab39ecaac0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "offline_data_class": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_read_batch_size": null, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "materialize_data": false, "materialize_mapped_data": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "ignore_final_observation": false, "prelearner_class": null, "prelearner_buffer_class": null, "prelearner_buffer_kwargs": {}, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_remaining_data": false, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": 1, "evaluation_duration": 20, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_auto_duration_min_env_steps_per_sample": 100, "evaluation_auto_duration_max_env_steps_per_sample": 2000, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 1, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "offline_evaluation_interval": null, "num_offline_eval_runners": 0, "offline_loss_for_module_fn": null, "offline_evaluation_duration": 1, "offline_evaluation_parallel_to_training": false, "offline_evaluation_timeout_s": 120.0, "num_cpus_per_offline_eval_runner": 1, "num_gpus_per_offline_eval_runner": 0, "custom_resources_per_offline_eval_runner": {}, "restart_failed_offline_eval_runners": true, "ignore_offline_eval_runner_failures": false, "max_num_offline_eval_runner_restarts": 1000, "offline_eval_runner_restore_timeout_s": 1800.0, "max_requests_in_flight_per_offline_eval_runner": 1, "validate_offline_eval_runners_after_construction": true, "offline_eval_runner_health_probe_timeout_s": 30.0, "offline_eval_rl_module_inference_only": false, "broadcast_offline_eval_runner_states": false, "offline_eval_batch_size_per_runner": 256, "dataset_num_iters_per_eval_runner": 1, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "log_gradients": true, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 42, "restart_failed_env_runners": true, "ignore_env_runner_failures": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30.0, "env_runner_restore_timeout_s": 1800.0, "_model_config": {}, "_rl_module_spec": "RLModuleSpec(module_class=None, observation_space=None, action_space=None, inference_only=False, learner_only=False, model_config=DefaultModelConfig(fcnet_hiddens=[44, 121], fcnet_activation='tanh', fcnet_kernel_initializer=None, fcnet_kernel_initializer_kwargs=None, fcnet_bias_initializer=None, fcnet_bias_initializer_kwargs=None, conv_filters=None, conv_activation='relu', conv_kernel_initializer=None, conv_kernel_initializer_kwargs=None, conv_bias_initializer=None, conv_bias_initializer_kwargs=None, head_fcnet_hiddens=[], head_fcnet_activation='relu', head_fcnet_kernel_initializer=None, head_fcnet_kernel_initializer_kwargs=None, head_fcnet_bias_initializer=None, head_fcnet_bias_initializer_kwargs=None, free_log_std=False, log_std_clip_param=20.0, vf_share_layers=True, use_lstm=False, max_seq_len=20, lstm_cell_size=256, lstm_use_prev_action=False, lstm_use_prev_reward=False, lstm_kernel_initializer=None, lstm_kernel_initializer_kwargs=None, lstm_bias_initializer=None, lstm_bias_initializer_kwargs=None), catalog_class=None, load_state_path=None, model_config_dict=None)", "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "_validate_config": true, "_use_msgpack_checkpoints": false, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "env_task_fn": -1, "enable_connectors": -1, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2326331382298, "kl_target": 0.0157623383336, "vf_loss_coeff": 0.5168547272885, "entropy_coeff": 0.0045811242641, "clip_param": 0.1219640961782, "vf_clip_param": 0.2247386827741, "entropy_coeff_schedule": null, "lr_schedule": null, "sgd_minibatch_size": -1, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9065181339776, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.callbacks.callbacks.RLlibCallback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 5.121421575546265, "iterations_since_restore": 1, "perf": {"cpu_util_percent": 11.125, "ram_util_percent": 74.525}}
{"timers": {"training_iteration": 4.368494496099629, "restore_env_runners": 4.478499962715432e-05, "training_step": 4.368243277100355, "env_runner_sampling_timer": 3.927574128119577, "learner_update_timer": 0.4370768479799972, "synch_weights": 0.0015830439999172086, "restore_eval_env_runners": 1.4500000361294951e-05, "evaluation_iteration": 0.7476419069998883, "synch_eval_env_connectors": 0.0005370999997467152, "synch_env_connectors": 8.199999683711212e-06}, "env_runners": {"env_to_module_connector": {"timers": {"connectors": {"numpy_to_tensor": 3.157751665476454e-05, "add_states_from_episodes_to_batch": 3.5104960759010007e-06, "add_observations_from_episodes_to_batch": 6.280248056048261e-06, "add_time_dim_to_batch_and_zero_pad": 6.442419703890349e-06, "batch_individual_items": 1.8823134660679237e-05}}, "connector_pipeline_timer": 0.00012018064227201365}, "weights_seq_no": 1.0, "num_agent_steps_sampled": {"default_agent": 5000.0}, "num_episodes_lifetime": 200.0, "module_to_env_connector": {"timers": {"connectors": {"un_batch_to_individual_items": 1.5046026467557885e-05, "normalize_and_clip_actions": 2.2381504936376668e-05, "tensor_to_numpy": 4.934515485849454e-05, "get_actions": 0.00016732478526949027, "listify_data_for_vector_env": 3.105236949022847e-05, "remove_single_ts_time_rank_from_batch": 1.4680264562729987e-06}}, "connector_pipeline_timer": 0.0003641404721037003}, "episode_return_max": 14.5, "episode_return_mean": 3.7, "env_step_timer": 4.3245165373011085e-05, "time_between_sampling": 0.009175081949121153, "episode_len_mean": 50.0, "episode_return_min": -5.5, "num_episodes": 100.0, "rlmodule_inference_timer": 0.00010105827013748257, "sample": 0.038471426490078744, "module_episode_returns_mean": {"default_policy": 3.7}, "agent_episode_returns_mean": {"default_agent": 3.7}, "num_module_steps_sampled": {"default_policy": 5000.0}, "env_to_module_sum_episodes_length_in": 27.16809333212661, "env_reset_timer": 0.0001298572420941812, "num_env_steps_sampled": 5000.0, "num_agent_steps_sampled_lifetime": {"default_agent": 10000.0}, "episode_duration_sec_mean": 0.03677865232007207, "num_env_steps_sampled_lifetime": 10000.0, "episode_len_max": 50, "env_to_module_sum_episodes_length_out": 27.16809333212661, "episode_len_min": 50, "num_module_steps_sampled_lifetime": {"default_policy": 10000.0}, "num_env_steps_sampled_lifetime_throughput": 1271.3264024608156}, "learners": {"__all_modules__": {"num_trainable_parameters": 5987, "learner_connector_sum_episodes_length_out": 5100.0, "num_module_steps_trained_lifetime": 22000, "learner_connector": {"timers": {"connectors": {"general_advantage_estimation": 0.014359926010101845, "add_time_dim_to_batch_and_zero_pad": 2.5074000132008222e-05, "numpy_to_tensor": 0.0002078990000882186, "add_states_from_episodes_to_batch": 6.795999934183783e-06, "add_one_ts_to_episodes_and_truncate": 0.008655660000313219, "add_columns_from_episodes_to_train_batch": 0.06976222900012544, "batch_individual_items": 0.20394004797943127, "add_observations_from_episodes_to_batch": 0.0007620920001500052}}, "connector_pipeline_timer": 0.29809891498978686}, "num_non_trainable_parameters": 0, "num_env_steps_trained": 56100, "num_module_steps_trained": 11000, "learner_connector_sum_episodes_length_in": 5000.0, "num_env_steps_trained_lifetime": 112200, "num_env_steps_trained_lifetime_throughput": 1052149.7877371444, "num_module_steps_trained_throughput": 207050.1110046047, "num_module_steps_trained_lifetime_throughput": 206883.66476431538}, "default_policy": {"module_train_batch_size_mean": 1000.0, "num_trainable_parameters": 5987, "vf_explained_var": 0.48333144187927246, "curr_kl_coeff": 0.05815828591585159, "mean_kl_loss": 0.00411228509619832, "num_module_steps_trained": 11000, "vf_loss_unclipped": 7.323639869689941, "diff_num_grad_updates_vs_sampler_policy": 1.0, "total_loss": 0.1487361341714859, "default_optimizer_learning_rate": 0.0050505681543, "weights_seq_no": 2.0, "gradients_default_optimizer_global_norm": 0.05813949927687645, "entropy": 0.692939817905426, "policy_loss": 0.05368026718497276, "num_module_steps_trained_lifetime": 22000, "curr_entropy_coeff": 0.0045811242641, "vf_loss": 0.18912851810455322, "num_module_steps_trained_lifetime_throughput": 207432.967274925}}, "num_training_step_calls_per_iteration": 1, "evaluation": {"env_runners": {"rlmodule_inference_timer": 9.555646547611668e-05, "num_episodes": 20, "module_to_env_connector": {"timers": {"connectors": {"tensor_to_numpy": 4.504350059987948e-05, "listify_data_for_vector_env": 2.9910301831209803e-05, "get_actions": 0.00015532145660207908, "remove_single_ts_time_rank_from_batch": 1.3575330327107846e-06, "un_batch_to_individual_items": 1.5050042419091556e-05, "normalize_and_clip_actions": 2.230631165418246e-05}}, "connector_pipeline_timer": 0.000342019942286024}, "env_reset_timer": 0.00020918000058372854, "num_env_steps_sampled": 1000, "env_to_module_connector": {"timers": {"connectors": {"add_observations_from_episodes_to_batch": 6.177909240806213e-06, "add_time_dim_to_batch_and_zero_pad": 5.311745358041022e-06, "numpy_to_tensor": 2.9082703538822825e-05, "add_states_from_episodes_to_batch": 3.2537364265343754e-06, "batch_individual_items": 1.8132585699265524e-05}}, "connector_pipeline_timer": 0.00011270685631331054}, "num_agent_steps_sampled": {"default_agent": 1000}, "episode_len_max": 50, "module_episode_returns_mean": {"default_policy": 2.1}, "env_step_timer": 4.231680745445953e-05, "agent_episode_returns_mean": {"default_agent": 2.1}, "num_agent_steps_sampled_lifetime": {"default_agent": 2000}, "episode_len_mean": 50.0, "env_to_module_sum_episodes_length_in": 27.168093298253442, "env_to_module_sum_episodes_length_out": 27.168093298253442, "episode_len_min": 50, "num_module_steps_sampled": {"default_policy": 1000}, "episode_return_mean": 2.1, "episode_return_min": -16.5, "sample": 0.7352540060003594, "num_module_steps_sampled_lifetime": {"default_policy": 2000}, "episode_duration_sec_mean": 0.03527780282508956, "num_env_steps_sampled_lifetime": 11000, "weights_seq_no": 2.0, "num_episodes_lifetime": 40, "episode_return_max": 17.5, "time_between_sampling": 4.192276638999829}, "num_healthy_workers": 1, "actor_manager_num_outstanding_async_reqs": 0, "num_remote_worker_restarts": 0}, "num_env_steps_sampled_lifetime": 10000.0, "fault_tolerance": {"num_healthy_workers": 0, "num_remote_worker_restarts": 0}, "env_runner_group": {"actor_manager_num_outstanding_async_reqs": 0}, "done": false, "training_iteration": 2, "trial_id": "1117f_00000", "date": "2025-08-11_17-55-07", "timestamp": 1754927707, "time_this_iter_s": 4.882749080657959, "time_total_s": 10.004170656204224, "pid": 101658, "hostname": "DESKTOP-3SK5A41", "node_ip": "192.168.40.242", "config": {"exploration_config": {}, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 6, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "env": "Umbrella", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": false, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 0, "create_local_env_runner": true, "num_envs_per_env_runner": 1, "gym_env_vectorize_mode": "SYNC", "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "episodes_to_numpy": true, "max_requests_in_flight_per_env_runner": 1, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "merge_env_runner_states": "training_only", "broadcast_env_runner_states": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "complete_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "sampler_perf_stats_ema_coef": null, "_is_online": true, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": "auto", "num_aggregator_actors_per_learner": 0, "max_requests_in_flight_per_aggregator_actor": 3, "local_gpu_idx": 0, "max_requests_in_flight_per_learner": 3, "gamma": 1, "lr": 0.0050505681543, "grad_clip": 0.5, "grad_clip_by": "global_norm", "_train_batch_size_per_learner": 5000, "train_batch_size": 4000, "num_epochs": 2, "minibatch_size": 1000, "shuffle_batch_per_epoch": true, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "log_std_clip_param": 20.0, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "_disable_preprocessor_api": false, "_disable_action_flattening": false}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "_learner_class": null, "callbacks_on_algorithm_init": null, "callbacks_on_env_runners_recreated": null, "callbacks_on_offline_eval_runners_recreated": null, "callbacks_on_checkpoint_loaded": null, "callbacks_on_environment_created": null, "callbacks_on_episode_created": null, "callbacks_on_episode_start": null, "callbacks_on_episode_step": null, "callbacks_on_episode_end": null, "callbacks_on_evaluate_start": null, "callbacks_on_evaluate_end": null, "callbacks_on_evaluate_offline_start": null, "callbacks_on_evaluate_offline_end": null, "callbacks_on_sample_end": null, "callbacks_on_train_result": null, "explore": true, "enable_rl_module_and_learner": true, "enable_env_runner_and_connector_v2": true, "_prior_exploration_config": {"type": "StochasticSampling"}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x77ab39ecaac0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "offline_data_class": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_read_batch_size": null, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "materialize_data": false, "materialize_mapped_data": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "ignore_final_observation": false, "prelearner_class": null, "prelearner_buffer_class": null, "prelearner_buffer_kwargs": {}, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_remaining_data": false, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": 1, "evaluation_duration": 20, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_auto_duration_min_env_steps_per_sample": 100, "evaluation_auto_duration_max_env_steps_per_sample": 2000, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 1, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "offline_evaluation_interval": null, "num_offline_eval_runners": 0, "offline_loss_for_module_fn": null, "offline_evaluation_duration": 1, "offline_evaluation_parallel_to_training": false, "offline_evaluation_timeout_s": 120.0, "num_cpus_per_offline_eval_runner": 1, "num_gpus_per_offline_eval_runner": 0, "custom_resources_per_offline_eval_runner": {}, "restart_failed_offline_eval_runners": true, "ignore_offline_eval_runner_failures": false, "max_num_offline_eval_runner_restarts": 1000, "offline_eval_runner_restore_timeout_s": 1800.0, "max_requests_in_flight_per_offline_eval_runner": 1, "validate_offline_eval_runners_after_construction": true, "offline_eval_runner_health_probe_timeout_s": 30.0, "offline_eval_rl_module_inference_only": false, "broadcast_offline_eval_runner_states": false, "offline_eval_batch_size_per_runner": 256, "dataset_num_iters_per_eval_runner": 1, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "log_gradients": true, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 42, "restart_failed_env_runners": true, "ignore_env_runner_failures": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30.0, "env_runner_restore_timeout_s": 1800.0, "_model_config": {}, "_rl_module_spec": "RLModuleSpec(module_class=None, observation_space=None, action_space=None, inference_only=False, learner_only=False, model_config=DefaultModelConfig(fcnet_hiddens=[44, 121], fcnet_activation='tanh', fcnet_kernel_initializer=None, fcnet_kernel_initializer_kwargs=None, fcnet_bias_initializer=None, fcnet_bias_initializer_kwargs=None, conv_filters=None, conv_activation='relu', conv_kernel_initializer=None, conv_kernel_initializer_kwargs=None, conv_bias_initializer=None, conv_bias_initializer_kwargs=None, head_fcnet_hiddens=[], head_fcnet_activation='relu', head_fcnet_kernel_initializer=None, head_fcnet_kernel_initializer_kwargs=None, head_fcnet_bias_initializer=None, head_fcnet_bias_initializer_kwargs=None, free_log_std=False, log_std_clip_param=20.0, vf_share_layers=True, use_lstm=False, max_seq_len=20, lstm_cell_size=256, lstm_use_prev_action=False, lstm_use_prev_reward=False, lstm_kernel_initializer=None, lstm_kernel_initializer_kwargs=None, lstm_bias_initializer=None, lstm_bias_initializer_kwargs=None), catalog_class=None, load_state_path=None, model_config_dict=None)", "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "_validate_config": true, "_use_msgpack_checkpoints": false, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "env_task_fn": -1, "enable_connectors": -1, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2326331382298, "kl_target": 0.0157623383336, "vf_loss_coeff": 0.5168547272885, "entropy_coeff": 0.0045811242641, "clip_param": 0.1219640961782, "vf_clip_param": 0.2247386827741, "entropy_coeff_schedule": null, "lr_schedule": null, "sgd_minibatch_size": -1, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9065181339776, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.callbacks.callbacks.RLlibCallback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 10.004170656204224, "iterations_since_restore": 2, "perf": {"cpu_util_percent": 12.857142857142858, "ram_util_percent": 74.7}}
{"timers": {"training_iteration": 4.367998183258632, "restore_env_runners": 4.4471149623495866e-05, "training_step": 4.367744591449353, "env_runner_sampling_timer": 3.929369264948385, "learner_update_timer": 0.4347815855102027, "synch_weights": 0.0015811365599148303, "restore_eval_env_runners": 1.4478000357485144e-05, "evaluation_iteration": 0.7475904429998901, "synch_eval_env_connectors": 0.0005355359997520281, "synch_env_connectors": 8.19799968667212e-06}, "env_runners": {"env_to_module_connector": {"timers": {"connectors": {"numpy_to_tensor": 3.180040533710716e-05, "add_states_from_episodes_to_batch": 3.521960343567452e-06, "add_observations_from_episodes_to_batch": 6.304539677861153e-06, "add_time_dim_to_batch_and_zero_pad": 6.435693425756574e-06, "batch_individual_items": 1.89377221793204e-05}}, "connector_pipeline_timer": 0.00012077806762480605}, "weights_seq_no": 2.0, "num_agent_steps_sampled": {"default_agent": 5000.0}, "num_episodes_lifetime": -4650.0, "module_to_env_connector": {"timers": {"connectors": {"un_batch_to_individual_items": 1.517047108796132e-05, "normalize_and_clip_actions": 2.2520100233082452e-05, "tensor_to_numpy": 4.974745991709932e-05, "get_actions": 0.00016944452092935335, "listify_data_for_vector_env": 3.089905373215724e-05, "remove_single_ts_time_rank_from_batch": 1.5093782768308062e-06}}, "connector_pipeline_timer": 0.00036712032330180543}, "episode_return_max": 14.5, "episode_return_mean": 3.899999999999998, "env_step_timer": 4.3732644406993635e-05, "time_between_sampling": 0.010570100684422157, "episode_len_mean": 50.0, "episode_return_min": -5.5, "num_episodes": 100.0, "rlmodule_inference_timer": 0.0001375474060644649, "sample": 0.038628112300686274, "module_episode_returns_mean": {"default_policy": 3.899999999999998}, "agent_episode_returns_mean": {"default_agent": 3.899999999999998}, "num_module_steps_sampled": {"default_policy": 5000.0}, "env_to_module_sum_episodes_length_in": 27.16809333212661, "env_reset_timer": 0.00010941947792113599, "num_env_steps_sampled": 5000.0, "num_agent_steps_sampled_lifetime": {"default_agent": -232500.0}, "episode_duration_sec_mean": 0.03853387210004257, "num_env_steps_sampled_lifetime": -232500.0, "episode_len_max": 50, "env_to_module_sum_episodes_length_out": 27.16809333212661, "episode_len_min": 50, "num_module_steps_sampled_lifetime": {"default_policy": -232500.0}, "num_env_steps_sampled_lifetime_throughput": 1254.0323044385048}, "learners": {"__all_modules__": {"num_trainable_parameters": 5987, "learner_connector_sum_episodes_length_out": 5100.0, "num_module_steps_trained_lifetime": 33000, "learner_connector": {"timers": {"connectors": {"general_advantage_estimation": 0.014302275749995624, "add_time_dim_to_batch_and_zero_pad": 2.507526013050665e-05, "numpy_to_tensor": 0.00020746201008478237, "add_states_from_episodes_to_batch": 6.7910399416177824e-06, "add_one_ts_to_episodes_and_truncate": 0.008652901400315204, "add_columns_from_episodes_to_train_batch": 0.06972939271012173, "batch_individual_items": 0.20246513350963524, "add_observations_from_episodes_to_batch": 0.0007617900801542418}}, "connector_pipeline_timer": 0.2965291948498845}, "num_non_trainable_parameters": 0, "num_env_steps_trained": 56100, "num_module_steps_trained": 11000, "learner_connector_sum_episodes_length_in": 5000.0, "num_env_steps_trained_lifetime": 168300, "num_env_steps_trained_lifetime_throughput": 1046164.5579167603, "num_module_steps_trained_throughput": 205858.2607554273, "num_module_steps_trained_lifetime_throughput": 205694.97958288086}, "default_policy": {"module_train_batch_size_mean": 1000.0, "num_trainable_parameters": 5987, "vf_explained_var": 0.6585862636566162, "curr_kl_coeff": 0.029079142957925797, "mean_kl_loss": 0.0018600517651066184, "num_module_steps_trained": 11000, "vf_loss_unclipped": 5.509097576141357, "diff_num_grad_updates_vs_sampler_policy": 1.0, "total_loss": 0.08692361414432526, "default_optimizer_learning_rate": 0.0050505681543, "weights_seq_no": 3.0, "gradients_default_optimizer_global_norm": 0.04236506670713425, "entropy": 0.6905856728553772, "policy_loss": -0.0028791974764317274, "num_module_steps_trained_lifetime": 33000, "curr_entropy_coeff": 0.0045811242641, "vf_loss": 0.17966030538082123, "num_module_steps_trained_lifetime_throughput": 206225.29958137136}}, "num_training_step_calls_per_iteration": 1, "evaluation": {"env_runners": {"rlmodule_inference_timer": 9.530254681271932e-05, "num_episodes": 20, "module_to_env_connector": {"timers": {"connectors": {"tensor_to_numpy": 4.523192255273678e-05, "listify_data_for_vector_env": 3.0060756261251166e-05, "get_actions": 0.0001554653464057684, "remove_single_ts_time_rank_from_batch": 1.365926624819156e-06, "un_batch_to_individual_items": 1.5116104030118174e-05, "normalize_and_clip_actions": 2.21912119090625e-05}}, "connector_pipeline_timer": 0.0003429483387825186}, "env_reset_timer": 0.00020860820057405361, "num_env_steps_sampled": 1000, "env_to_module_connector": {"timers": {"connectors": {"add_observations_from_episodes_to_batch": 6.128441028587153e-06, "add_time_dim_to_batch_and_zero_pad": 5.305900932760352e-06, "numpy_to_tensor": 2.957750239452343e-05, "add_states_from_episodes_to_batch": 3.308707160265287e-06, "batch_individual_items": 1.8203155008275555e-05}}, "connector_pipeline_timer": 0.0001135374901885634}, "num_agent_steps_sampled": {"default_agent": 1000}, "episode_len_max": 50, "module_episode_returns_mean": {"default_policy": 1.7666666666666666}, "env_step_timer": 4.161921147022514e-05, "agent_episode_returns_mean": {"default_agent": 1.7666666666666666}, "num_agent_steps_sampled_lifetime": {"default_agent": 3000}, "episode_len_mean": 50.0, "env_to_module_sum_episodes_length_in": 27.168093332125434, "env_to_module_sum_episodes_length_out": 27.168093332125434, "episode_len_min": 50, "num_module_steps_sampled": {"default_policy": 1000}, "episode_return_mean": 1.7666666666666666, "episode_return_min": -16.5, "sample": 0.73514630195036, "num_module_steps_sampled_lifetime": {"default_policy": 3000}, "episode_duration_sec_mean": 0.03512730023338311, "num_env_steps_sampled_lifetime": 16000, "weights_seq_no": 3.0, "num_episodes_lifetime": 60, "episode_return_max": 17.5, "time_between_sampling": 4.194076807729835}, "num_healthy_workers": 1, "actor_manager_num_outstanding_async_reqs": 0, "num_remote_worker_restarts": 0}, "num_env_steps_sampled_lifetime": -232500.0, "fault_tolerance": {"num_healthy_workers": 0, "num_remote_worker_restarts": 0}, "env_runner_group": {"actor_manager_num_outstanding_async_reqs": 0}, "done": false, "training_iteration": 3, "trial_id": "1117f_00000", "date": "2025-08-11_17-55-12", "timestamp": 1754927712, "time_this_iter_s": 5.0576395988464355, "time_total_s": 15.06181025505066, "pid": 101658, "hostname": "DESKTOP-3SK5A41", "node_ip": "192.168.40.242", "config": {"exploration_config": {}, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 6, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "env": "Umbrella", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": false, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 0, "create_local_env_runner": true, "num_envs_per_env_runner": 1, "gym_env_vectorize_mode": "SYNC", "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "episodes_to_numpy": true, "max_requests_in_flight_per_env_runner": 1, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "merge_env_runner_states": "training_only", "broadcast_env_runner_states": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "complete_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "sampler_perf_stats_ema_coef": null, "_is_online": true, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": "auto", "num_aggregator_actors_per_learner": 0, "max_requests_in_flight_per_aggregator_actor": 3, "local_gpu_idx": 0, "max_requests_in_flight_per_learner": 3, "gamma": 1, "lr": 0.0050505681543, "grad_clip": 0.5, "grad_clip_by": "global_norm", "_train_batch_size_per_learner": 5000, "train_batch_size": 4000, "num_epochs": 2, "minibatch_size": 1000, "shuffle_batch_per_epoch": true, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "log_std_clip_param": 20.0, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "_disable_preprocessor_api": false, "_disable_action_flattening": false}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "_learner_class": null, "callbacks_on_algorithm_init": null, "callbacks_on_env_runners_recreated": null, "callbacks_on_offline_eval_runners_recreated": null, "callbacks_on_checkpoint_loaded": null, "callbacks_on_environment_created": null, "callbacks_on_episode_created": null, "callbacks_on_episode_start": null, "callbacks_on_episode_step": null, "callbacks_on_episode_end": null, "callbacks_on_evaluate_start": null, "callbacks_on_evaluate_end": null, "callbacks_on_evaluate_offline_start": null, "callbacks_on_evaluate_offline_end": null, "callbacks_on_sample_end": null, "callbacks_on_train_result": null, "explore": true, "enable_rl_module_and_learner": true, "enable_env_runner_and_connector_v2": true, "_prior_exploration_config": {"type": "StochasticSampling"}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x77ab39ecaac0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "offline_data_class": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_read_batch_size": null, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "materialize_data": false, "materialize_mapped_data": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "ignore_final_observation": false, "prelearner_class": null, "prelearner_buffer_class": null, "prelearner_buffer_kwargs": {}, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_remaining_data": false, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": 1, "evaluation_duration": 20, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_auto_duration_min_env_steps_per_sample": 100, "evaluation_auto_duration_max_env_steps_per_sample": 2000, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 1, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "offline_evaluation_interval": null, "num_offline_eval_runners": 0, "offline_loss_for_module_fn": null, "offline_evaluation_duration": 1, "offline_evaluation_parallel_to_training": false, "offline_evaluation_timeout_s": 120.0, "num_cpus_per_offline_eval_runner": 1, "num_gpus_per_offline_eval_runner": 0, "custom_resources_per_offline_eval_runner": {}, "restart_failed_offline_eval_runners": true, "ignore_offline_eval_runner_failures": false, "max_num_offline_eval_runner_restarts": 1000, "offline_eval_runner_restore_timeout_s": 1800.0, "max_requests_in_flight_per_offline_eval_runner": 1, "validate_offline_eval_runners_after_construction": true, "offline_eval_runner_health_probe_timeout_s": 30.0, "offline_eval_rl_module_inference_only": false, "broadcast_offline_eval_runner_states": false, "offline_eval_batch_size_per_runner": 256, "dataset_num_iters_per_eval_runner": 1, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "log_gradients": true, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 42, "restart_failed_env_runners": true, "ignore_env_runner_failures": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30.0, "env_runner_restore_timeout_s": 1800.0, "_model_config": {}, "_rl_module_spec": "RLModuleSpec(module_class=None, observation_space=None, action_space=None, inference_only=False, learner_only=False, model_config=DefaultModelConfig(fcnet_hiddens=[44, 121], fcnet_activation='tanh', fcnet_kernel_initializer=None, fcnet_kernel_initializer_kwargs=None, fcnet_bias_initializer=None, fcnet_bias_initializer_kwargs=None, conv_filters=None, conv_activation='relu', conv_kernel_initializer=None, conv_kernel_initializer_kwargs=None, conv_bias_initializer=None, conv_bias_initializer_kwargs=None, head_fcnet_hiddens=[], head_fcnet_activation='relu', head_fcnet_kernel_initializer=None, head_fcnet_kernel_initializer_kwargs=None, head_fcnet_bias_initializer=None, head_fcnet_bias_initializer_kwargs=None, free_log_std=False, log_std_clip_param=20.0, vf_share_layers=True, use_lstm=False, max_seq_len=20, lstm_cell_size=256, lstm_use_prev_action=False, lstm_use_prev_reward=False, lstm_kernel_initializer=None, lstm_kernel_initializer_kwargs=None, lstm_bias_initializer=None, lstm_bias_initializer_kwargs=None), catalog_class=None, load_state_path=None, model_config_dict=None)", "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "_validate_config": true, "_use_msgpack_checkpoints": false, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "env_task_fn": -1, "enable_connectors": -1, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2326331382298, "kl_target": 0.0157623383336, "vf_loss_coeff": 0.5168547272885, "entropy_coeff": 0.0045811242641, "clip_param": 0.1219640961782, "vf_clip_param": 0.2247386827741, "entropy_coeff_schedule": null, "lr_schedule": null, "sgd_minibatch_size": -1, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9065181339776, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.callbacks.callbacks.RLlibCallback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 15.06181025505066, "iterations_since_restore": 3, "perf": {"cpu_util_percent": 14.114285714285714, "ram_util_percent": 70.92857142857143}}
{"timers": {"training_iteration": 4.367390635496046, "restore_env_runners": 4.4160438128968954e-05, "training_step": 4.367135630604857, "env_runner_sampling_timer": 3.929474487358902, "learner_update_timer": 0.4340648576650979, "synch_weights": 0.0015801941943125886, "restore_eval_env_runners": 1.4454220356674342e-05, "evaluation_iteration": 0.7474555595798976, "synch_eval_env_connectors": 0.0005356426397536779, "synch_env_connectors": 8.193019684949833e-06}, "env_runners": {"env_to_module_connector": {"timers": {"connectors": {"numpy_to_tensor": 3.159026249185382e-05, "add_states_from_episodes_to_batch": 3.505195602117839e-06, "add_observations_from_episodes_to_batch": 6.274198656789682e-06, "add_time_dim_to_batch_and_zero_pad": 6.5253092448015745e-06, "batch_individual_items": 1.8899237248414463e-05}}, "connector_pipeline_timer": 0.00012020430519989147}, "weights_seq_no": 3.0, "num_agent_steps_sampled": {"default_agent": 5000.0}, "num_episodes_lifetime": -9500.0, "module_to_env_connector": {"timers": {"connectors": {"un_batch_to_individual_items": 1.5032439436296866e-05, "normalize_and_clip_actions": 2.2398686121387002e-05, "tensor_to_numpy": 4.962126607759023e-05, "get_actions": 0.00016752817483317966, "listify_data_for_vector_env": 3.095689015339881e-05, "remove_single_ts_time_rank_from_batch": 1.4971222651400993e-06}}, "connector_pipeline_timer": 0.0003647526643404606}, "episode_return_max": 14.5, "episode_return_mean": 4.5, "env_step_timer": 4.3485770951142716e-05, "time_between_sampling": 0.011081796602169618, "episode_len_mean": 50.0, "episode_return_min": -5.5, "num_episodes": 100.0, "rlmodule_inference_timer": 0.00010199484054023121, "sample": 0.03868939532639756, "module_episode_returns_mean": {"default_policy": 4.5}, "agent_episode_returns_mean": {"default_agent": 4.5}, "num_module_steps_sampled": {"default_policy": 5000.0}, "env_to_module_sum_episodes_length_in": 27.16809333212661, "env_reset_timer": 9.989388634481361e-05, "num_env_steps_sampled": 5000.0, "num_agent_steps_sampled_lifetime": {"default_agent": -475000.0}, "episode_duration_sec_mean": 0.036866947060007094, "num_env_steps_sampled_lifetime": -475000.0, "episode_len_max": 50, "env_to_module_sum_episodes_length_out": 27.16809333212661, "episode_len_min": 50, "num_module_steps_sampled_lifetime": {"default_policy": -475000.0}, "num_env_steps_sampled_lifetime_throughput": 1268.2604964706088}, "learners": {"__all_modules__": {"num_trainable_parameters": 5987, "learner_connector_sum_episodes_length_out": 5100.0, "num_module_steps_trained_lifetime": 44000, "learner_connector": {"timers": {"connectors": {"general_advantage_estimation": 0.014266071992498028, "add_time_dim_to_batch_and_zero_pad": 2.5117507522891172e-05, "numpy_to_tensor": 0.00020708938998350275, "add_states_from_episodes_to_batch": 6.803129541999624e-06, "add_one_ts_to_episodes_and_truncate": 0.00864739938630859, "add_columns_from_episodes_to_train_batch": 0.06971686078302128, "batch_individual_items": 0.20250159418454455, "add_observations_from_episodes_to_batch": 0.0007615111793470168}}, "connector_pipeline_timer": 0.2965108039113858}, "num_non_trainable_parameters": 0, "num_env_steps_trained": 56100, "num_module_steps_trained": 11000, "learner_connector_sum_episodes_length_in": 5000.0, "num_env_steps_trained_lifetime": 224400, "num_env_steps_trained_lifetime_throughput": 1037767.9697360126, "num_module_steps_trained_throughput": 204186.8478440413, "num_module_steps_trained_lifetime_throughput": 204028.1429016947}, "default_policy": {"module_train_batch_size_mean": 1000.0, "num_trainable_parameters": 5987, "vf_explained_var": 0.7407022714614868, "curr_kl_coeff": 0.014539571478962898, "mean_kl_loss": 0.005065616220235825, "num_module_steps_trained": 11000, "vf_loss_unclipped": 5.843615531921387, "diff_num_grad_updates_vs_sampler_policy": 1.0, "total_loss": 0.06512600183486938, "default_optimizer_learning_rate": 0.0050505681543, "weights_seq_no": 4.0, "gradients_default_optimizer_global_norm": 0.238346129655838, "entropy": 0.68506920337677, "policy_loss": -0.022837964817881584, "num_module_steps_trained_lifetime": 44000, "curr_entropy_coeff": 0.0045811242641, "vf_loss": 0.1759779453277588, "num_module_steps_trained_lifetime_throughput": 204534.81114558282}}, "num_training_step_calls_per_iteration": 1, "evaluation": {"env_runners": {"rlmodule_inference_timer": 9.518987194502291e-05, "num_episodes": 20, "module_to_env_connector": {"timers": {"connectors": {"tensor_to_numpy": 4.513628814332753e-05, "listify_data_for_vector_env": 3.059877712215643e-05, "get_actions": 0.0001559111291665482, "remove_single_ts_time_rank_from_batch": 1.354140974274154e-06, "un_batch_to_individual_items": 1.5389109100256737e-05, "normalize_and_clip_actions": 2.1857134860847764e-05}}, "connector_pipeline_timer": 0.0003435283128752547}, "env_reset_timer": 0.00020779311856931052, "num_env_steps_sampled": 1000, "env_to_module_connector": {"timers": {"connectors": {"add_observations_from_episodes_to_batch": 6.294810366177664e-06, "add_time_dim_to_batch_and_zero_pad": 5.443010156464377e-06, "numpy_to_tensor": 2.8959600382750912e-05, "add_states_from_episodes_to_batch": 3.29349094584308e-06, "batch_individual_items": 1.8224167061955965e-05}}, "connector_pipeline_timer": 0.00011218853031616146}, "num_agent_steps_sampled": {"default_agent": 1000}, "episode_len_max": 50, "module_episode_returns_mean": {"default_policy": 0.6}, "env_step_timer": 4.176179727122578e-05, "agent_episode_returns_mean": {"default_agent": 0.6}, "num_agent_steps_sampled_lifetime": {"default_agent": 4000}, "episode_len_mean": 50.0, "env_to_module_sum_episodes_length_in": 27.168093332126602, "env_to_module_sum_episodes_length_out": 27.168093332126602, "episode_len_min": 50, "num_module_steps_sampled": {"default_policy": 1000}, "episode_return_mean": 0.6, "episode_return_min": -16.5, "sample": 0.735056890960857, "num_module_steps_sampled_lifetime": {"default_policy": 4000}, "episode_duration_sec_mean": 0.03507461896257382, "num_env_steps_sampled_lifetime": 21000, "weights_seq_no": 4.0, "num_episodes_lifetime": 80, "episode_return_max": 17.5, "time_between_sampling": 4.195765831722533}, "num_healthy_workers": 1, "actor_manager_num_outstanding_async_reqs": 0, "num_remote_worker_restarts": 0}, "num_env_steps_sampled_lifetime": -475000.0, "fault_tolerance": {"num_healthy_workers": 0, "num_remote_worker_restarts": 0}, "env_runner_group": {"actor_manager_num_outstanding_async_reqs": 0}, "done": false, "training_iteration": 4, "trial_id": "1117f_00000", "date": "2025-08-11_17-55-17", "timestamp": 1754927717, "time_this_iter_s": 5.0480711460113525, "time_total_s": 20.10988140106201, "pid": 101658, "hostname": "DESKTOP-3SK5A41", "node_ip": "192.168.40.242", "config": {"exploration_config": {}, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 6, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "env": "Umbrella", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": false, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 0, "create_local_env_runner": true, "num_envs_per_env_runner": 1, "gym_env_vectorize_mode": "SYNC", "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "episodes_to_numpy": true, "max_requests_in_flight_per_env_runner": 1, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "merge_env_runner_states": "training_only", "broadcast_env_runner_states": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "complete_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "sampler_perf_stats_ema_coef": null, "_is_online": true, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": "auto", "num_aggregator_actors_per_learner": 0, "max_requests_in_flight_per_aggregator_actor": 3, "local_gpu_idx": 0, "max_requests_in_flight_per_learner": 3, "gamma": 1, "lr": 0.0050505681543, "grad_clip": 0.5, "grad_clip_by": "global_norm", "_train_batch_size_per_learner": 5000, "train_batch_size": 4000, "num_epochs": 2, "minibatch_size": 1000, "shuffle_batch_per_epoch": true, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "log_std_clip_param": 20.0, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "_disable_preprocessor_api": false, "_disable_action_flattening": false}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "_learner_class": null, "callbacks_on_algorithm_init": null, "callbacks_on_env_runners_recreated": null, "callbacks_on_offline_eval_runners_recreated": null, "callbacks_on_checkpoint_loaded": null, "callbacks_on_environment_created": null, "callbacks_on_episode_created": null, "callbacks_on_episode_start": null, "callbacks_on_episode_step": null, "callbacks_on_episode_end": null, "callbacks_on_evaluate_start": null, "callbacks_on_evaluate_end": null, "callbacks_on_evaluate_offline_start": null, "callbacks_on_evaluate_offline_end": null, "callbacks_on_sample_end": null, "callbacks_on_train_result": null, "explore": true, "enable_rl_module_and_learner": true, "enable_env_runner_and_connector_v2": true, "_prior_exploration_config": {"type": "StochasticSampling"}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x77ab39ecaac0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "offline_data_class": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_read_batch_size": null, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "materialize_data": false, "materialize_mapped_data": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "ignore_final_observation": false, "prelearner_class": null, "prelearner_buffer_class": null, "prelearner_buffer_kwargs": {}, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_remaining_data": false, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": 1, "evaluation_duration": 20, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_auto_duration_min_env_steps_per_sample": 100, "evaluation_auto_duration_max_env_steps_per_sample": 2000, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 1, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "offline_evaluation_interval": null, "num_offline_eval_runners": 0, "offline_loss_for_module_fn": null, "offline_evaluation_duration": 1, "offline_evaluation_parallel_to_training": false, "offline_evaluation_timeout_s": 120.0, "num_cpus_per_offline_eval_runner": 1, "num_gpus_per_offline_eval_runner": 0, "custom_resources_per_offline_eval_runner": {}, "restart_failed_offline_eval_runners": true, "ignore_offline_eval_runner_failures": false, "max_num_offline_eval_runner_restarts": 1000, "offline_eval_runner_restore_timeout_s": 1800.0, "max_requests_in_flight_per_offline_eval_runner": 1, "validate_offline_eval_runners_after_construction": true, "offline_eval_runner_health_probe_timeout_s": 30.0, "offline_eval_rl_module_inference_only": false, "broadcast_offline_eval_runner_states": false, "offline_eval_batch_size_per_runner": 256, "dataset_num_iters_per_eval_runner": 1, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "log_gradients": true, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 42, "restart_failed_env_runners": true, "ignore_env_runner_failures": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30.0, "env_runner_restore_timeout_s": 1800.0, "_model_config": {}, "_rl_module_spec": "RLModuleSpec(module_class=None, observation_space=None, action_space=None, inference_only=False, learner_only=False, model_config=DefaultModelConfig(fcnet_hiddens=[44, 121], fcnet_activation='tanh', fcnet_kernel_initializer=None, fcnet_kernel_initializer_kwargs=None, fcnet_bias_initializer=None, fcnet_bias_initializer_kwargs=None, conv_filters=None, conv_activation='relu', conv_kernel_initializer=None, conv_kernel_initializer_kwargs=None, conv_bias_initializer=None, conv_bias_initializer_kwargs=None, head_fcnet_hiddens=[], head_fcnet_activation='relu', head_fcnet_kernel_initializer=None, head_fcnet_kernel_initializer_kwargs=None, head_fcnet_bias_initializer=None, head_fcnet_bias_initializer_kwargs=None, free_log_std=False, log_std_clip_param=20.0, vf_share_layers=True, use_lstm=False, max_seq_len=20, lstm_cell_size=256, lstm_use_prev_action=False, lstm_use_prev_reward=False, lstm_kernel_initializer=None, lstm_kernel_initializer_kwargs=None, lstm_bias_initializer=None, lstm_bias_initializer_kwargs=None), catalog_class=None, load_state_path=None, model_config_dict=None)", "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "_validate_config": true, "_use_msgpack_checkpoints": false, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "env_task_fn": -1, "enable_connectors": -1, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2326331382298, "kl_target": 0.0157623383336, "vf_loss_coeff": 0.5168547272885, "entropy_coeff": 0.0045811242641, "clip_param": 0.1219640961782, "vf_clip_param": 0.2247386827741, "entropy_coeff_schedule": null, "lr_schedule": null, "sgd_minibatch_size": -1, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9065181339776, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.callbacks.callbacks.RLlibCallback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 20.10988140106201, "iterations_since_restore": 4, "perf": {"cpu_util_percent": 13.0, "ram_util_percent": 70.3}}
{"timers": {"training_iteration": 4.3650077952810875, "restore_env_runners": 4.382883374853841e-05, "training_step": 4.364751973438811, "env_runner_sampling_timer": 3.929426897615319, "learner_update_timer": 0.4317268350984454, "synch_weights": 0.0015794082523670212, "restore_eval_env_runners": 1.4479678156088995e-05, "evaluation_iteration": 0.7473406190140985, "synch_eval_env_connectors": 0.0005338912133487446, "synch_env_connectors": 8.187089493820169e-06}, "env_runners": {"env_to_module_connector": {"timers": {"connectors": {"numpy_to_tensor": 3.144209540136886e-05, "add_states_from_episodes_to_batch": 3.49414932928531e-06, "add_observations_from_episodes_to_batch": 6.2016464365004655e-06, "add_time_dim_to_batch_and_zero_pad": 6.4305494391354465e-06, "batch_individual_items": 1.870054733528022e-05}}, "connector_pipeline_timer": 0.00011936105916610946}, "weights_seq_no": 4.0, "num_agent_steps_sampled": {"default_agent": 5000.0}, "num_episodes_lifetime": -14350.0, "module_to_env_connector": {"timers": {"connectors": {"un_batch_to_individual_items": 1.5030215362959384e-05, "normalize_and_clip_actions": 2.232827216302703e-05, "tensor_to_numpy": 4.948962162239743e-05, "get_actions": 0.00016728240543390497, "listify_data_for_vector_env": 3.089319105884177e-05, "remove_single_ts_time_rank_from_batch": 1.4785543861879272e-06}}, "connector_pipeline_timer": 0.00036415709982481155}, "episode_return_max": 14.5, "episode_return_mean": 8.1, "env_step_timer": 4.319419757496097e-05, "time_between_sampling": 0.01226659709690699, "episode_len_mean": 50.0, "episode_return_min": -5.5, "num_episodes": 100.0, "rlmodule_inference_timer": 0.00010080977851925113, "sample": 0.03814470829346662, "module_episode_returns_mean": {"default_policy": 8.1}, "agent_episode_returns_mean": {"default_agent": 8.1}, "num_module_steps_sampled": {"default_policy": 5000.0}, "env_to_module_sum_episodes_length_in": 27.16809333212661, "env_reset_timer": 9.631841208463388e-05, "num_env_steps_sampled": 5000.0, "num_agent_steps_sampled_lifetime": {"default_agent": -717500.0}, "episode_duration_sec_mean": 0.03670447912999408, "num_env_steps_sampled_lifetime": -717500.0, "episode_len_max": 50, "env_to_module_sum_episodes_length_out": 27.16809333212661, "episode_len_min": 50, "num_module_steps_sampled_lifetime": {"default_policy": -717500.0}, "num_env_steps_sampled_lifetime_throughput": 1273.3950676086508}, "learners": {"__all_modules__": {"num_trainable_parameters": 5987, "learner_connector_sum_episodes_length_out": 5100.0, "num_module_steps_trained_lifetime": 55000, "learner_connector": {"timers": {"connectors": {"general_advantage_estimation": 0.014216368272579256, "add_time_dim_to_batch_and_zero_pad": 2.5077332453609686e-05, "numpy_to_tensor": 0.0002071524960894212, "add_states_from_episodes_to_batch": 6.794098250182333e-06, "add_one_ts_to_episodes_and_truncate": 0.00864282139244701, "add_columns_from_episodes_to_train_batch": 0.06969527218519286, "batch_individual_items": 0.20105344324270183, "add_observations_from_episodes_to_batch": 0.0007608640675605104}}, "connector_pipeline_timer": 0.29498544888227146}, "num_non_trainable_parameters": 0, "num_env_steps_trained": 56100, "num_module_steps_trained": 11000, "learner_connector_sum_episodes_length_in": 5000.0, "num_env_steps_trained_lifetime": 280500, "num_env_steps_trained_lifetime_throughput": 1032305.8942838057, "num_module_steps_trained_throughput": 203090.032549034, "num_module_steps_trained_lifetime_throughput": 202935.88074805436}, "default_policy": {"module_train_batch_size_mean": 1000.0, "num_trainable_parameters": 5987, "vf_explained_var": 0.6917997598648071, "curr_kl_coeff": 0.007269785739481449, "mean_kl_loss": 0.0033032111823558807, "num_module_steps_trained": 11000, "vf_loss_unclipped": 7.032468795776367, "diff_num_grad_updates_vs_sampler_policy": 1.0, "total_loss": 0.04706839099526405, "default_optimizer_learning_rate": 0.0050505681543, "weights_seq_no": 5.0, "gradients_default_optimizer_global_norm": 0.14669714868068695, "entropy": 0.6770870685577393, "policy_loss": -0.044740572571754456, "num_module_steps_trained_lifetime": 55000, "curr_entropy_coeff": 0.0045811242641, "vf_loss": 0.1835385262966156, "num_module_steps_trained_lifetime_throughput": 203417.04494578275}}, "num_training_step_calls_per_iteration": 1, "evaluation": {"env_runners": {"rlmodule_inference_timer": 9.599852677312794e-05, "num_episodes": 20, "module_to_env_connector": {"timers": {"connectors": {"tensor_to_numpy": 4.576913496920739e-05, "listify_data_for_vector_env": 3.012835709555171e-05, "get_actions": 0.0001563125646254454, "remove_single_ts_time_rank_from_batch": 1.3976045239090616e-06, "un_batch_to_individual_items": 1.5275457482058545e-05, "normalize_and_clip_actions": 2.1889844437136362e-05}}, "connector_pipeline_timer": 0.0003461357555491933}, "env_reset_timer": 0.00020699518738038572, "num_env_steps_sampled": 1000, "env_to_module_connector": {"timers": {"connectors": {"add_observations_from_episodes_to_batch": 6.292849333747277e-06, "add_time_dim_to_batch_and_zero_pad": 5.350294237699055e-06, "numpy_to_tensor": 2.986899907180364e-05, "add_states_from_episodes_to_batch": 3.2375597760998816e-06, "batch_individual_items": 1.8258000727856818e-05}}, "connector_pipeline_timer": 0.00011397517690739942}, "num_agent_steps_sampled": {"default_agent": 1000}, "episode_len_max": 50, "module_episode_returns_mean": {"default_policy": 0.1}, "env_step_timer": 4.247758895247501e-05, "agent_episode_returns_mean": {"default_agent": 0.1}, "num_agent_steps_sampled_lifetime": {"default_agent": 5000}, "episode_len_mean": 50.0, "env_to_module_sum_episodes_length_in": 27.168093332126602, "env_to_module_sum_episodes_length_out": 27.168093332126602, "episode_len_min": 50, "num_module_steps_sampled": {"default_policy": 1000}, "episode_return_mean": 0.1, "episode_return_min": -16.5, "sample": 0.7350062940812443, "num_module_steps_sampled_lifetime": {"default_policy": 5000}, "episode_duration_sec_mean": 0.035078337200056924, "num_env_steps_sampled_lifetime": 26000, "weights_seq_no": 5.0, "num_episodes_lifetime": 100, "episode_return_max": 17.5, "time_between_sampling": 4.195646830545313}, "num_healthy_workers": 1, "actor_manager_num_outstanding_async_reqs": 0, "num_remote_worker_restarts": 0}, "num_env_steps_sampled_lifetime": -717500.0, "fault_tolerance": {"num_healthy_workers": 0, "num_remote_worker_restarts": 0}, "env_runner_group": {"actor_manager_num_outstanding_async_reqs": 0}, "done": false, "training_iteration": 5, "trial_id": "1117f_00000", "date": "2025-08-11_17-55-22", "timestamp": 1754927722, "time_this_iter_s": 4.873706817626953, "time_total_s": 24.983588218688965, "pid": 101658, "hostname": "DESKTOP-3SK5A41", "node_ip": "192.168.40.242", "config": {"exploration_config": {}, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 6, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "env": "Umbrella", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": false, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 0, "create_local_env_runner": true, "num_envs_per_env_runner": 1, "gym_env_vectorize_mode": "SYNC", "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "episodes_to_numpy": true, "max_requests_in_flight_per_env_runner": 1, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "merge_env_runner_states": "training_only", "broadcast_env_runner_states": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "complete_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "sampler_perf_stats_ema_coef": null, "_is_online": true, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": "auto", "num_aggregator_actors_per_learner": 0, "max_requests_in_flight_per_aggregator_actor": 3, "local_gpu_idx": 0, "max_requests_in_flight_per_learner": 3, "gamma": 1, "lr": 0.0050505681543, "grad_clip": 0.5, "grad_clip_by": "global_norm", "_train_batch_size_per_learner": 5000, "train_batch_size": 4000, "num_epochs": 2, "minibatch_size": 1000, "shuffle_batch_per_epoch": true, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "log_std_clip_param": 20.0, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "_disable_preprocessor_api": false, "_disable_action_flattening": false}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "_learner_class": null, "callbacks_on_algorithm_init": null, "callbacks_on_env_runners_recreated": null, "callbacks_on_offline_eval_runners_recreated": null, "callbacks_on_checkpoint_loaded": null, "callbacks_on_environment_created": null, "callbacks_on_episode_created": null, "callbacks_on_episode_start": null, "callbacks_on_episode_step": null, "callbacks_on_episode_end": null, "callbacks_on_evaluate_start": null, "callbacks_on_evaluate_end": null, "callbacks_on_evaluate_offline_start": null, "callbacks_on_evaluate_offline_end": null, "callbacks_on_sample_end": null, "callbacks_on_train_result": null, "explore": true, "enable_rl_module_and_learner": true, "enable_env_runner_and_connector_v2": true, "_prior_exploration_config": {"type": "StochasticSampling"}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x77ab39ecaac0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "offline_data_class": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_read_batch_size": null, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "materialize_data": false, "materialize_mapped_data": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "ignore_final_observation": false, "prelearner_class": null, "prelearner_buffer_class": null, "prelearner_buffer_kwargs": {}, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_remaining_data": false, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": 1, "evaluation_duration": 20, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_auto_duration_min_env_steps_per_sample": 100, "evaluation_auto_duration_max_env_steps_per_sample": 2000, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 1, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "offline_evaluation_interval": null, "num_offline_eval_runners": 0, "offline_loss_for_module_fn": null, "offline_evaluation_duration": 1, "offline_evaluation_parallel_to_training": false, "offline_evaluation_timeout_s": 120.0, "num_cpus_per_offline_eval_runner": 1, "num_gpus_per_offline_eval_runner": 0, "custom_resources_per_offline_eval_runner": {}, "restart_failed_offline_eval_runners": true, "ignore_offline_eval_runner_failures": false, "max_num_offline_eval_runner_restarts": 1000, "offline_eval_runner_restore_timeout_s": 1800.0, "max_requests_in_flight_per_offline_eval_runner": 1, "validate_offline_eval_runners_after_construction": true, "offline_eval_runner_health_probe_timeout_s": 30.0, "offline_eval_rl_module_inference_only": false, "broadcast_offline_eval_runner_states": false, "offline_eval_batch_size_per_runner": 256, "dataset_num_iters_per_eval_runner": 1, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "log_gradients": true, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 42, "restart_failed_env_runners": true, "ignore_env_runner_failures": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30.0, "env_runner_restore_timeout_s": 1800.0, "_model_config": {}, "_rl_module_spec": "RLModuleSpec(module_class=None, observation_space=None, action_space=None, inference_only=False, learner_only=False, model_config=DefaultModelConfig(fcnet_hiddens=[44, 121], fcnet_activation='tanh', fcnet_kernel_initializer=None, fcnet_kernel_initializer_kwargs=None, fcnet_bias_initializer=None, fcnet_bias_initializer_kwargs=None, conv_filters=None, conv_activation='relu', conv_kernel_initializer=None, conv_kernel_initializer_kwargs=None, conv_bias_initializer=None, conv_bias_initializer_kwargs=None, head_fcnet_hiddens=[], head_fcnet_activation='relu', head_fcnet_kernel_initializer=None, head_fcnet_kernel_initializer_kwargs=None, head_fcnet_bias_initializer=None, head_fcnet_bias_initializer_kwargs=None, free_log_std=False, log_std_clip_param=20.0, vf_share_layers=True, use_lstm=False, max_seq_len=20, lstm_cell_size=256, lstm_use_prev_action=False, lstm_use_prev_reward=False, lstm_kernel_initializer=None, lstm_kernel_initializer_kwargs=None, lstm_bias_initializer=None, lstm_bias_initializer_kwargs=None), catalog_class=None, load_state_path=None, model_config_dict=None)", "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "_validate_config": true, "_use_msgpack_checkpoints": false, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "env_task_fn": -1, "enable_connectors": -1, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2326331382298, "kl_target": 0.0157623383336, "vf_loss_coeff": 0.5168547272885, "entropy_coeff": 0.0045811242641, "clip_param": 0.1219640961782, "vf_clip_param": 0.2247386827741, "entropy_coeff_schedule": null, "lr_schedule": null, "sgd_minibatch_size": -1, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9065181339776, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.callbacks.callbacks.RLlibCallback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 24.983588218688965, "iterations_since_restore": 5, "perf": {"cpu_util_percent": 12.614285714285714, "ram_util_percent": 70.3}}
{"timers": {"training_iteration": 4.364631289418279, "restore_env_runners": 4.3511545413817074e-05, "training_step": 4.364374178794418, "env_runner_sampling_timer": 3.9296799627191636, "learner_update_timer": 0.43109110075746293, "synch_weights": 0.00157908316984329, "restore_eval_env_runners": 1.4440881372214118e-05, "evaluation_iteration": 0.7472648868539561, "synch_eval_env_connectors": 0.0005336633012156544, "synch_env_connectors": 8.171218601216444e-06}, "env_runners": {"env_to_module_connector": {"timers": {"connectors": {"numpy_to_tensor": 3.166988094102332e-05, "add_states_from_episodes_to_batch": 3.533323677091208e-06, "add_observations_from_episodes_to_batch": 6.3292989136772895e-06, "add_time_dim_to_batch_and_zero_pad": 6.59416301927419e-06, "batch_individual_items": 1.8887585575183067e-05}}, "connector_pipeline_timer": 0.00012073589945482342}, "weights_seq_no": 5.0, "num_agent_steps_sampled": {"default_agent": 5000.0}, "num_episodes_lifetime": -19200.0, "module_to_env_connector": {"timers": {"connectors": {"un_batch_to_individual_items": 1.5152875453633526e-05, "normalize_and_clip_actions": 2.2541015740878253e-05, "tensor_to_numpy": 4.961864324282594e-05, "get_actions": 0.00016840663893391664, "listify_data_for_vector_env": 3.104727956653768e-05, "remove_single_ts_time_rank_from_batch": 1.5112035165540702e-06}}, "connector_pipeline_timer": 0.0003664260958347269}, "episode_return_max": 14.5, "episode_return_mean": 5.100000000000001, "env_step_timer": 4.347941903262135e-05, "time_between_sampling": 0.011699815109871914, "episode_len_mean": 50.0, "episode_return_min": -5.5, "num_episodes": 100.0, "rlmodule_inference_timer": 0.0001023067334447638, "sample": 0.03802214192913961, "module_episode_returns_mean": {"default_policy": 5.100000000000001}, "agent_episode_returns_mean": {"default_agent": 5.100000000000001}, "num_module_steps_sampled": {"default_policy": 5000.0}, "env_to_module_sum_episodes_length_in": 27.16809333212661, "env_reset_timer": 9.472518799946418e-05, "num_env_steps_sampled": 5000.0, "num_agent_steps_sampled_lifetime": {"default_agent": -960000.0}, "episode_duration_sec_mean": 0.037015864080021874, "num_env_steps_sampled_lifetime": -960000.0, "episode_len_max": 50, "env_to_module_sum_episodes_length_out": 27.16809333212661, "episode_len_min": 50, "num_module_steps_sampled_lifetime": {"default_policy": -960000.0}, "num_env_steps_sampled_lifetime_throughput": 1265.257006730982}, "learners": {"__all_modules__": {"num_trainable_parameters": 5987, "learner_connector_sum_episodes_length_out": 5100.0, "num_module_steps_trained_lifetime": 66000, "learner_connector": {"timers": {"connectors": {"general_advantage_estimation": 0.014188990589857195, "add_time_dim_to_batch_and_zero_pad": 2.5037559135021016e-05, "numpy_to_tensor": 0.0002068219711249272, "add_states_from_episodes_to_batch": 6.783157265149175e-06, "add_one_ts_to_episodes_and_truncate": 0.008636906178516058, "add_columns_from_episodes_to_train_batch": 0.0696792944633457, "batch_individual_items": 0.20106429282026983, "add_observations_from_episodes_to_batch": 0.0007599094268837944}}, "connector_pipeline_timer": 0.29494500740345075}, "num_non_trainable_parameters": 0, "num_env_steps_trained": 56100, "num_module_steps_trained": 11000, "learner_connector_sum_episodes_length_in": 5000.0, "num_env_steps_trained_lifetime": 336600, "num_env_steps_trained_lifetime_throughput": 1022327.9447576717, "num_module_steps_trained_throughput": 201110.49558743276, "num_module_steps_trained_lifetime_throughput": 200959.8566460661}, "default_policy": {"module_train_batch_size_mean": 1000.0, "num_trainable_parameters": 5987, "vf_explained_var": 0.7743428349494934, "curr_kl_coeff": 0.0036348928697407246, "mean_kl_loss": 0.004360034596174955, "num_module_steps_trained": 11000, "vf_loss_unclipped": 6.375833988189697, "diff_num_grad_updates_vs_sampler_policy": 1.0, "total_loss": 0.02059295028448105, "default_optimizer_learning_rate": 0.0050505681543, "weights_seq_no": 6.0, "gradients_default_optimizer_global_norm": 0.10046796500682831, "entropy": 0.6635468602180481, "policy_loss": -0.06689494103193283, "num_module_steps_trained_lifetime": 66000, "curr_entropy_coeff": 0.0045811242641, "vf_loss": 0.1750897765159607, "num_module_steps_trained_lifetime_throughput": 201418.12299858162}}, "num_training_step_calls_per_iteration": 1, "evaluation": {"env_runners": {"rlmodule_inference_timer": 9.493818394320753e-05, "num_episodes": 20, "module_to_env_connector": {"timers": {"connectors": {"tensor_to_numpy": 4.5479574982697145e-05, "listify_data_for_vector_env": 3.054887700153736e-05, "get_actions": 0.00015894166589325946, "remove_single_ts_time_rank_from_batch": 1.3556351371211355e-06, "un_batch_to_individual_items": 1.5059528377942263e-05, "normalize_and_clip_actions": 2.2446922061126994e-05}}, "connector_pipeline_timer": 0.0003481463376772311}, "env_reset_timer": 0.0002061962355075793, "num_env_steps_sampled": 1000, "env_to_module_connector": {"timers": {"connectors": {"add_observations_from_episodes_to_batch": 6.434732910326204e-06, "add_time_dim_to_batch_and_zero_pad": 5.415355517353377e-06, "numpy_to_tensor": 3.019997523444114e-05, "add_states_from_episodes_to_batch": 3.369377615322087e-06, "batch_individual_items": 1.8336475924769773e-05}}, "connector_pipeline_timer": 0.00011466310325763828}, "num_agent_steps_sampled": {"default_agent": 1000}, "episode_len_max": 50, "module_episode_returns_mean": {"default_policy": -0.1}, "env_step_timer": 4.326574106391188e-05, "agent_episode_returns_mean": {"default_agent": -0.1}, "num_agent_steps_sampled_lifetime": {"default_agent": 6000}, "episode_len_mean": 50.0, "env_to_module_sum_episodes_length_in": 27.168093332126602, "env_to_module_sum_episodes_length_out": 27.168093332126602, "episode_len_min": 50, "num_module_steps_sampled": {"default_policy": 1000}, "episode_return_mean": -0.1, "episode_return_min": -16.5, "sample": 0.7349554471504285, "num_module_steps_sampled_lifetime": {"default_policy": 6000}, "episode_duration_sec_mean": 0.035032423150023535, "num_env_steps_sampled_lifetime": 31000, "weights_seq_no": 6.0, "num_episodes_lifetime": 120, "episode_return_max": 17.5, "time_between_sampling": 4.197516494329859}, "num_healthy_workers": 1, "actor_manager_num_outstanding_async_reqs": 0, "num_remote_worker_restarts": 0}, "num_env_steps_sampled_lifetime": -960000.0, "fault_tolerance": {"num_healthy_workers": 0, "num_remote_worker_restarts": 0}, "env_runner_group": {"actor_manager_num_outstanding_async_reqs": 0}, "done": false, "training_iteration": 6, "trial_id": "1117f_00000", "date": "2025-08-11_17-55-27", "timestamp": 1754927727, "time_this_iter_s": 5.0713417530059814, "time_total_s": 30.054929971694946, "pid": 101658, "hostname": "DESKTOP-3SK5A41", "node_ip": "192.168.40.242", "config": {"exploration_config": {}, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 6, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "env": "Umbrella", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": false, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 0, "create_local_env_runner": true, "num_envs_per_env_runner": 1, "gym_env_vectorize_mode": "SYNC", "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "episodes_to_numpy": true, "max_requests_in_flight_per_env_runner": 1, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "merge_env_runner_states": "training_only", "broadcast_env_runner_states": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "complete_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "sampler_perf_stats_ema_coef": null, "_is_online": true, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": "auto", "num_aggregator_actors_per_learner": 0, "max_requests_in_flight_per_aggregator_actor": 3, "local_gpu_idx": 0, "max_requests_in_flight_per_learner": 3, "gamma": 1, "lr": 0.0050505681543, "grad_clip": 0.5, "grad_clip_by": "global_norm", "_train_batch_size_per_learner": 5000, "train_batch_size": 4000, "num_epochs": 2, "minibatch_size": 1000, "shuffle_batch_per_epoch": true, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "log_std_clip_param": 20.0, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "_disable_preprocessor_api": false, "_disable_action_flattening": false}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "_learner_class": null, "callbacks_on_algorithm_init": null, "callbacks_on_env_runners_recreated": null, "callbacks_on_offline_eval_runners_recreated": null, "callbacks_on_checkpoint_loaded": null, "callbacks_on_environment_created": null, "callbacks_on_episode_created": null, "callbacks_on_episode_start": null, "callbacks_on_episode_step": null, "callbacks_on_episode_end": null, "callbacks_on_evaluate_start": null, "callbacks_on_evaluate_end": null, "callbacks_on_evaluate_offline_start": null, "callbacks_on_evaluate_offline_end": null, "callbacks_on_sample_end": null, "callbacks_on_train_result": null, "explore": true, "enable_rl_module_and_learner": true, "enable_env_runner_and_connector_v2": true, "_prior_exploration_config": {"type": "StochasticSampling"}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x77ab39ecaac0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "offline_data_class": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_read_batch_size": null, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "materialize_data": false, "materialize_mapped_data": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "ignore_final_observation": false, "prelearner_class": null, "prelearner_buffer_class": null, "prelearner_buffer_kwargs": {}, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_remaining_data": false, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": 1, "evaluation_duration": 20, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_auto_duration_min_env_steps_per_sample": 100, "evaluation_auto_duration_max_env_steps_per_sample": 2000, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 1, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "offline_evaluation_interval": null, "num_offline_eval_runners": 0, "offline_loss_for_module_fn": null, "offline_evaluation_duration": 1, "offline_evaluation_parallel_to_training": false, "offline_evaluation_timeout_s": 120.0, "num_cpus_per_offline_eval_runner": 1, "num_gpus_per_offline_eval_runner": 0, "custom_resources_per_offline_eval_runner": {}, "restart_failed_offline_eval_runners": true, "ignore_offline_eval_runner_failures": false, "max_num_offline_eval_runner_restarts": 1000, "offline_eval_runner_restore_timeout_s": 1800.0, "max_requests_in_flight_per_offline_eval_runner": 1, "validate_offline_eval_runners_after_construction": true, "offline_eval_runner_health_probe_timeout_s": 30.0, "offline_eval_rl_module_inference_only": false, "broadcast_offline_eval_runner_states": false, "offline_eval_batch_size_per_runner": 256, "dataset_num_iters_per_eval_runner": 1, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "log_gradients": true, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 42, "restart_failed_env_runners": true, "ignore_env_runner_failures": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30.0, "env_runner_restore_timeout_s": 1800.0, "_model_config": {}, "_rl_module_spec": "RLModuleSpec(module_class=None, observation_space=None, action_space=None, inference_only=False, learner_only=False, model_config=DefaultModelConfig(fcnet_hiddens=[44, 121], fcnet_activation='tanh', fcnet_kernel_initializer=None, fcnet_kernel_initializer_kwargs=None, fcnet_bias_initializer=None, fcnet_bias_initializer_kwargs=None, conv_filters=None, conv_activation='relu', conv_kernel_initializer=None, conv_kernel_initializer_kwargs=None, conv_bias_initializer=None, conv_bias_initializer_kwargs=None, head_fcnet_hiddens=[], head_fcnet_activation='relu', head_fcnet_kernel_initializer=None, head_fcnet_kernel_initializer_kwargs=None, head_fcnet_bias_initializer=None, head_fcnet_bias_initializer_kwargs=None, free_log_std=False, log_std_clip_param=20.0, vf_share_layers=True, use_lstm=False, max_seq_len=20, lstm_cell_size=256, lstm_use_prev_action=False, lstm_use_prev_reward=False, lstm_kernel_initializer=None, lstm_kernel_initializer_kwargs=None, lstm_bias_initializer=None, lstm_bias_initializer_kwargs=None), catalog_class=None, load_state_path=None, model_config_dict=None)", "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "_validate_config": true, "_use_msgpack_checkpoints": false, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "env_task_fn": -1, "enable_connectors": -1, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2326331382298, "kl_target": 0.0157623383336, "vf_loss_coeff": 0.5168547272885, "entropy_coeff": 0.0045811242641, "clip_param": 0.1219640961782, "vf_clip_param": 0.2247386827741, "entropy_coeff_schedule": null, "lr_schedule": null, "sgd_minibatch_size": -1, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9065181339776, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.callbacks.callbacks.RLlibCallback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 30.054929971694946, "iterations_since_restore": 6, "perf": {"cpu_util_percent": 12.600000000000001, "ram_util_percent": 70.3}}
{"timers": {"training_iteration": 4.362391492574098, "restore_env_runners": 4.318842995757714e-05, "training_step": 4.36213268005648, "env_runner_sampling_timer": 3.929666543141973, "learner_update_timer": 0.42885753374988766, "synch_weights": 0.0015776143381421215, "restore_eval_env_runners": 1.4417472561256025e-05, "evaluation_iteration": 0.7471892109954162, "synch_eval_env_connectors": 0.0005331756682006913, "synch_env_connectors": 8.156506416058301e-06}, "env_runners": {"env_to_module_connector": {"timers": {"connectors": {"numpy_to_tensor": 3.136166151128331e-05, "add_states_from_episodes_to_batch": 3.5516441013464265e-06, "add_observations_from_episodes_to_batch": 6.226453017416692e-06, "add_time_dim_to_batch_and_zero_pad": 6.5149879426377175e-06, "batch_individual_items": 1.8846864479572988e-05}}, "connector_pipeline_timer": 0.00012011664775475835}, "weights_seq_no": 6.0, "num_agent_steps_sampled": {"default_agent": 5000.0}, "num_episodes_lifetime": -24050.0, "module_to_env_connector": {"timers": {"connectors": {"un_batch_to_individual_items": 1.508350336657464e-05, "normalize_and_clip_actions": 2.227969607363334e-05, "tensor_to_numpy": 4.93776087307464e-05, "get_actions": 0.0001671571705726542, "listify_data_for_vector_env": 3.084859630971803e-05, "remove_single_ts_time_rank_from_batch": 1.5145335096366968e-06}}, "connector_pipeline_timer": 0.00036414988654653494}, "episode_return_max": 14.5, "episode_return_mean": 9.5, "env_step_timer": 4.324394650690945e-05, "time_between_sampling": 0.012550457826508576, "episode_len_mean": 50.0, "episode_return_min": -5.5, "num_episodes": 100.0, "rlmodule_inference_timer": 0.00010086071518893521, "sample": 0.037932617967642475, "module_episode_returns_mean": {"default_policy": 9.5}, "agent_episode_returns_mean": {"default_agent": 9.5}, "num_module_steps_sampled": {"default_policy": 5000.0}, "env_to_module_sum_episodes_length_in": 27.16809333212661, "env_reset_timer": 9.499954073453219e-05, "num_env_steps_sampled": 5000.0, "num_agent_steps_sampled_lifetime": {"default_agent": -1202500.0}, "episode_duration_sec_mean": 0.03673973804993693, "num_env_steps_sampled_lifetime": -1202500.0, "episode_len_max": 50, "env_to_module_sum_episodes_length_out": 27.16809333212661, "episode_len_min": 50, "num_module_steps_sampled_lifetime": {"default_policy": -1202500.0}, "num_env_steps_sampled_lifetime_throughput": 1272.0533445884466}, "learners": {"__all_modules__": {"num_trainable_parameters": 5987, "learner_connector_sum_episodes_length_out": 5100.0, "num_module_steps_trained_lifetime": 77000, "learner_connector": {"timers": {"connectors": {"general_advantage_estimation": 0.014136688683959352, "add_time_dim_to_batch_and_zero_pad": 2.5000183537562377e-05, "numpy_to_tensor": 0.00020636275141450413, "add_states_from_episodes_to_batch": 6.772325699061295e-06, "add_one_ts_to_episodes_and_truncate": 0.008630810116734113, "add_columns_from_episodes_to_train_batch": 0.06964708751871485, "batch_individual_items": 0.19962151589206836, "add_observations_from_episodes_to_batch": 0.0007589553326180746}}, "connector_pipeline_timer": 0.29340956832941334}, "num_non_trainable_parameters": 0, "num_env_steps_trained": 56100, "num_module_steps_trained": 11000, "learner_connector_sum_episodes_length_in": 5000.0, "num_env_steps_trained_lifetime": 392700, "num_env_steps_trained_lifetime_throughput": 1012703.0408786037, "num_module_steps_trained_throughput": 199198.96972635924, "num_module_steps_trained_lifetime_throughput": 199053.05015622132}, "default_policy": {"module_train_batch_size_mean": 1000.0, "num_trainable_parameters": 5987, "vf_explained_var": 0.6779311895370483, "curr_kl_coeff": 0.0018174464348703623, "mean_kl_loss": 0.0025449723470956087, "num_module_steps_trained": 11000, "vf_loss_unclipped": 10.756875038146973, "diff_num_grad_updates_vs_sampler_policy": 1.0, "total_loss": 0.07321377098560333, "default_optimizer_learning_rate": 0.0050505681543, "weights_seq_no": 7.0, "gradients_default_optimizer_global_norm": 0.12340763211250305, "entropy": 0.653450608253479, "policy_loss": -0.014997479505836964, "num_module_steps_trained_lifetime": 77000, "curr_entropy_coeff": 0.0045811242641, "vf_loss": 0.17644324898719788, "num_module_steps_trained_lifetime_throughput": 199486.6708893031}}, "num_training_step_calls_per_iteration": 1, "evaluation": {"env_runners": {"rlmodule_inference_timer": 9.474417237906957e-05, "num_episodes": 20, "module_to_env_connector": {"timers": {"connectors": {"tensor_to_numpy": 4.441483506288342e-05, "listify_data_for_vector_env": 3.0443116497950545e-05, "get_actions": 0.00015456331452097662, "remove_single_ts_time_rank_from_batch": 1.3227077756377654e-06, "un_batch_to_individual_items": 1.5128492219944677e-05, "normalize_and_clip_actions": 2.1202176083218662e-05}}, "connector_pipeline_timer": 0.00033941483612906183}, "env_reset_timer": 0.00020536627314757402, "num_env_steps_sampled": 1000, "env_to_module_connector": {"timers": {"connectors": {"add_observations_from_episodes_to_batch": 6.182958520093879e-06, "add_time_dim_to_batch_and_zero_pad": 5.223887075895486e-06, "numpy_to_tensor": 2.922468497162054e-05, "add_states_from_episodes_to_batch": 3.367303589618582e-06, "batch_individual_items": 1.781217965406663e-05}}, "connector_pipeline_timer": 0.00011217342076122431}, "num_agent_steps_sampled": {"default_agent": 1000}, "episode_len_max": 50, "module_episode_returns_mean": {"default_policy": -1.1}, "env_step_timer": 4.174221537107809e-05, "agent_episode_returns_mean": {"default_agent": -1.1}, "num_agent_steps_sampled_lifetime": {"default_agent": 7000}, "episode_len_mean": 50.0, "env_to_module_sum_episodes_length_in": 27.168093332126602, "env_to_module_sum_episodes_length_out": 27.168093332126602, "episode_len_min": 50, "num_module_steps_sampled": {"default_policy": 1000}, "episode_return_mean": -1.1, "episode_return_min": -16.5, "sample": 0.7348448836889233, "num_module_steps_sampled_lifetime": {"default_policy": 7000}, "episode_duration_sec_mean": 0.034946323090025544, "num_env_steps_sampled_lifetime": 36000, "weights_seq_no": 7.0, "num_episodes_lifetime": 140, "episode_return_max": 17.5, "time_between_sampling": 4.197493681436553}, "num_healthy_workers": 1, "actor_manager_num_outstanding_async_reqs": 0, "num_remote_worker_restarts": 0}, "num_env_steps_sampled_lifetime": -1202500.0, "fault_tolerance": {"num_healthy_workers": 0, "num_remote_worker_restarts": 0}, "env_runner_group": {"actor_manager_num_outstanding_async_reqs": 0}, "done": false, "training_iteration": 7, "trial_id": "1117f_00000", "date": "2025-08-11_17-55-32", "timestamp": 1754927732, "time_this_iter_s": 4.8784499168396, "time_total_s": 34.933379888534546, "pid": 101658, "hostname": "DESKTOP-3SK5A41", "node_ip": "192.168.40.242", "config": {"exploration_config": {}, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 6, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "env": "Umbrella", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": false, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 0, "create_local_env_runner": true, "num_envs_per_env_runner": 1, "gym_env_vectorize_mode": "SYNC", "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "episodes_to_numpy": true, "max_requests_in_flight_per_env_runner": 1, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "merge_env_runner_states": "training_only", "broadcast_env_runner_states": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "complete_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "sampler_perf_stats_ema_coef": null, "_is_online": true, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": "auto", "num_aggregator_actors_per_learner": 0, "max_requests_in_flight_per_aggregator_actor": 3, "local_gpu_idx": 0, "max_requests_in_flight_per_learner": 3, "gamma": 1, "lr": 0.0050505681543, "grad_clip": 0.5, "grad_clip_by": "global_norm", "_train_batch_size_per_learner": 5000, "train_batch_size": 4000, "num_epochs": 2, "minibatch_size": 1000, "shuffle_batch_per_epoch": true, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "log_std_clip_param": 20.0, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "_disable_preprocessor_api": false, "_disable_action_flattening": false}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "_learner_class": null, "callbacks_on_algorithm_init": null, "callbacks_on_env_runners_recreated": null, "callbacks_on_offline_eval_runners_recreated": null, "callbacks_on_checkpoint_loaded": null, "callbacks_on_environment_created": null, "callbacks_on_episode_created": null, "callbacks_on_episode_start": null, "callbacks_on_episode_step": null, "callbacks_on_episode_end": null, "callbacks_on_evaluate_start": null, "callbacks_on_evaluate_end": null, "callbacks_on_evaluate_offline_start": null, "callbacks_on_evaluate_offline_end": null, "callbacks_on_sample_end": null, "callbacks_on_train_result": null, "explore": true, "enable_rl_module_and_learner": true, "enable_env_runner_and_connector_v2": true, "_prior_exploration_config": {"type": "StochasticSampling"}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x77ab39ecaac0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "offline_data_class": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_read_batch_size": null, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "materialize_data": false, "materialize_mapped_data": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "ignore_final_observation": false, "prelearner_class": null, "prelearner_buffer_class": null, "prelearner_buffer_kwargs": {}, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_remaining_data": false, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": 1, "evaluation_duration": 20, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_auto_duration_min_env_steps_per_sample": 100, "evaluation_auto_duration_max_env_steps_per_sample": 2000, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 1, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "offline_evaluation_interval": null, "num_offline_eval_runners": 0, "offline_loss_for_module_fn": null, "offline_evaluation_duration": 1, "offline_evaluation_parallel_to_training": false, "offline_evaluation_timeout_s": 120.0, "num_cpus_per_offline_eval_runner": 1, "num_gpus_per_offline_eval_runner": 0, "custom_resources_per_offline_eval_runner": {}, "restart_failed_offline_eval_runners": true, "ignore_offline_eval_runner_failures": false, "max_num_offline_eval_runner_restarts": 1000, "offline_eval_runner_restore_timeout_s": 1800.0, "max_requests_in_flight_per_offline_eval_runner": 1, "validate_offline_eval_runners_after_construction": true, "offline_eval_runner_health_probe_timeout_s": 30.0, "offline_eval_rl_module_inference_only": false, "broadcast_offline_eval_runner_states": false, "offline_eval_batch_size_per_runner": 256, "dataset_num_iters_per_eval_runner": 1, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "log_gradients": true, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 42, "restart_failed_env_runners": true, "ignore_env_runner_failures": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30.0, "env_runner_restore_timeout_s": 1800.0, "_model_config": {}, "_rl_module_spec": "RLModuleSpec(module_class=None, observation_space=None, action_space=None, inference_only=False, learner_only=False, model_config=DefaultModelConfig(fcnet_hiddens=[44, 121], fcnet_activation='tanh', fcnet_kernel_initializer=None, fcnet_kernel_initializer_kwargs=None, fcnet_bias_initializer=None, fcnet_bias_initializer_kwargs=None, conv_filters=None, conv_activation='relu', conv_kernel_initializer=None, conv_kernel_initializer_kwargs=None, conv_bias_initializer=None, conv_bias_initializer_kwargs=None, head_fcnet_hiddens=[], head_fcnet_activation='relu', head_fcnet_kernel_initializer=None, head_fcnet_kernel_initializer_kwargs=None, head_fcnet_bias_initializer=None, head_fcnet_bias_initializer_kwargs=None, free_log_std=False, log_std_clip_param=20.0, vf_share_layers=True, use_lstm=False, max_seq_len=20, lstm_cell_size=256, lstm_use_prev_action=False, lstm_use_prev_reward=False, lstm_kernel_initializer=None, lstm_kernel_initializer_kwargs=None, lstm_bias_initializer=None, lstm_bias_initializer_kwargs=None), catalog_class=None, load_state_path=None, model_config_dict=None)", "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "_validate_config": true, "_use_msgpack_checkpoints": false, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "env_task_fn": -1, "enable_connectors": -1, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2326331382298, "kl_target": 0.0157623383336, "vf_loss_coeff": 0.5168547272885, "entropy_coeff": 0.0045811242641, "clip_param": 0.1219640961782, "vf_clip_param": 0.2247386827741, "entropy_coeff_schedule": null, "lr_schedule": null, "sgd_minibatch_size": -1, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9065181339776, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.callbacks.callbacks.RLlibCallback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 34.933379888534546, "iterations_since_restore": 7, "perf": {"cpu_util_percent": 12.214285714285714, "ram_util_percent": 70.3}}
{"timers": {"training_iteration": 4.3617133906883625, "restore_env_runners": 4.287354565759228e-05, "training_step": 4.361453418295913, "env_runner_sampling_timer": 3.9297076647505564, "learner_update_timer": 0.4281289974123924, "synch_weights": 0.0015796101947617598, "restore_eval_env_runners": 1.4375297830156346e-05, "evaluation_iteration": 0.7470525578954611, "synch_eval_env_connectors": 0.0005323159115192171, "synch_env_connectors": 8.13794134957861e-06}, "env_runners": {"env_to_module_connector": {"timers": {"connectors": {"numpy_to_tensor": 3.14976436820215e-05, "add_states_from_episodes_to_batch": 3.5499988926727234e-06, "add_observations_from_episodes_to_batch": 6.2673553300088e-06, "add_time_dim_to_batch_and_zero_pad": 6.489791115313532e-06, "batch_individual_items": 1.876720301740839e-05}}, "connector_pipeline_timer": 0.00012004070910031375}, "weights_seq_no": 7.0, "num_agent_steps_sampled": {"default_agent": 5000.0}, "num_episodes_lifetime": -28900.0, "module_to_env_connector": {"timers": {"connectors": {"un_batch_to_individual_items": 1.504314705366974e-05, "normalize_and_clip_actions": 2.240076125852009e-05, "tensor_to_numpy": 4.938911935141333e-05, "get_actions": 0.0001671018330716939, "listify_data_for_vector_env": 3.103585433786079e-05, "remove_single_ts_time_rank_from_batch": 1.516570429714484e-06}}, "connector_pipeline_timer": 0.0003642765819870619}, "episode_return_max": 14.5, "episode_return_mean": 9.5, "env_step_timer": 4.338996729106968e-05, "time_between_sampling": 0.01182745300389664, "episode_len_mean": 50.0, "episode_return_min": -5.5, "num_episodes": 100.0, "rlmodule_inference_timer": 0.00010148095088251874, "sample": 0.03788668606704761, "module_episode_returns_mean": {"default_policy": 9.5}, "agent_episode_returns_mean": {"default_agent": 9.5}, "num_module_steps_sampled": {"default_policy": 5000.0}, "env_to_module_sum_episodes_length_in": 27.16809333212661, "env_reset_timer": 9.477453537293569e-05, "num_env_steps_sampled": 5000.0, "num_agent_steps_sampled_lifetime": {"default_agent": -1445000.0}, "episode_duration_sec_mean": 0.03682021303002331, "num_env_steps_sampled_lifetime": -1445000.0, "episode_len_max": 50, "env_to_module_sum_episodes_length_out": 27.16809333212661, "episode_len_min": 50, "num_module_steps_sampled_lifetime": {"default_policy": -1445000.0}, "num_env_steps_sampled_lifetime_throughput": 1270.1746862928544}, "learners": {"__all_modules__": {"num_trainable_parameters": 5987, "learner_connector_sum_episodes_length_out": 5100.0, "num_module_steps_trained_lifetime": 88000, "learner_connector": {"timers": {"connectors": {"general_advantage_estimation": 0.014083596797118007, "add_time_dim_to_batch_and_zero_pad": 2.4948181700095236e-05, "numpy_to_tensor": 0.0002065441238963963, "add_states_from_episodes_to_batch": 6.7636024365784395e-06, "add_one_ts_to_episodes_and_truncate": 0.008624768015562162, "add_columns_from_episodes_to_train_batch": 0.06962205264353005, "batch_individual_items": 0.19965083873314574, "add_observations_from_episodes_to_batch": 0.0007589467792917394}}, "connector_pipeline_timer": 0.29335400864611755}, "num_non_trainable_parameters": 0, "num_env_steps_trained": 56100, "num_module_steps_trained": 11000, "learner_connector_sum_episodes_length_in": 5000.0, "num_env_steps_trained_lifetime": 448800, "num_env_steps_trained_lifetime_throughput": 1003053.0949872512, "num_module_steps_trained_throughput": 197280.89932295893, "num_module_steps_trained_lifetime_throughput": 197139.9974744752}, "default_policy": {"module_train_batch_size_mean": 1000.0, "num_trainable_parameters": 5987, "vf_explained_var": 0.6671789884567261, "curr_kl_coeff": 0.0009087232174351811, "mean_kl_loss": 0.0033173176925629377, "num_module_steps_trained": 11000, "vf_loss_unclipped": 11.249316215515137, "diff_num_grad_updates_vs_sampler_policy": 1.0, "total_loss": 0.08898665755987167, "default_optimizer_learning_rate": 0.0050505681543, "weights_seq_no": 8.0, "gradients_default_optimizer_global_norm": 0.06678148359060287, "entropy": 0.6386468410491943, "policy_loss": 0.003028531325981021, "num_module_steps_trained_lifetime": 88000, "curr_entropy_coeff": 0.0045811242641, "vf_loss": 0.17195898294448853, "num_module_steps_trained_lifetime_throughput": 197549.68246487586}}, "num_training_step_calls_per_iteration": 1, "evaluation": {"env_runners": {"rlmodule_inference_timer": 9.530950616065062e-05, "num_episodes": 20, "module_to_env_connector": {"timers": {"connectors": {"tensor_to_numpy": 4.5078792049078984e-05, "listify_data_for_vector_env": 3.043597669883566e-05, "get_actions": 0.0001539872425518388, "remove_single_ts_time_rank_from_batch": 1.3865879952497434e-06, "un_batch_to_individual_items": 1.550575128700272e-05, "normalize_and_clip_actions": 2.172327164810089e-05}}, "connector_pipeline_timer": 0.00034134954817345613}, "env_reset_timer": 0.00020486361042093624, "num_env_steps_sampled": 1000, "env_to_module_connector": {"timers": {"connectors": {"add_observations_from_episodes_to_batch": 6.120498248219813e-06, "add_time_dim_to_batch_and_zero_pad": 5.246446062922746e-06, "numpy_to_tensor": 2.9391146670288464e-05, "add_states_from_episodes_to_batch": 3.201774371074729e-06, "batch_individual_items": 1.8565603331060797e-05}}, "connector_pipeline_timer": 0.00011321362563186095}, "num_agent_steps_sampled": {"default_agent": 1000}, "episode_len_max": 50, "module_episode_returns_mean": {"default_policy": -1.9}, "env_step_timer": 4.1934476928665474e-05, "agent_episode_returns_mean": {"default_agent": -1.9}, "num_agent_steps_sampled_lifetime": {"default_agent": 8000}, "episode_len_mean": 50.0, "env_to_module_sum_episodes_length_in": 27.168093332126602, "env_to_module_sum_episodes_length_out": 27.168093332126602, "episode_len_min": 50, "num_module_steps_sampled": {"default_policy": 1000}, "episode_return_mean": -1.9, "episode_return_min": -16.5, "sample": 0.7348015268620354, "num_module_steps_sampled_lifetime": {"default_policy": 8000}, "episode_duration_sec_mean": 0.03500418509002884, "num_env_steps_sampled_lifetime": 41000, "weights_seq_no": 8.0, "num_episodes_lifetime": 160, "episode_return_max": 17.5, "time_between_sampling": 4.19904636566219}, "num_healthy_workers": 1, "actor_manager_num_outstanding_async_reqs": 0, "num_remote_worker_restarts": 0}, "num_env_steps_sampled_lifetime": -1445000.0, "fault_tolerance": {"num_healthy_workers": 0, "num_remote_worker_restarts": 0}, "env_runner_group": {"actor_manager_num_outstanding_async_reqs": 0}, "done": false, "training_iteration": 8, "trial_id": "1117f_00000", "date": "2025-08-11_17-55-37", "timestamp": 1754927737, "time_this_iter_s": 5.039551258087158, "time_total_s": 39.972931146621704, "pid": 101658, "hostname": "DESKTOP-3SK5A41", "node_ip": "192.168.40.242", "config": {"exploration_config": {}, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 6, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "env": "Umbrella", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": false, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 0, "create_local_env_runner": true, "num_envs_per_env_runner": 1, "gym_env_vectorize_mode": "SYNC", "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "episodes_to_numpy": true, "max_requests_in_flight_per_env_runner": 1, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "merge_env_runner_states": "training_only", "broadcast_env_runner_states": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "complete_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "sampler_perf_stats_ema_coef": null, "_is_online": true, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": "auto", "num_aggregator_actors_per_learner": 0, "max_requests_in_flight_per_aggregator_actor": 3, "local_gpu_idx": 0, "max_requests_in_flight_per_learner": 3, "gamma": 1, "lr": 0.0050505681543, "grad_clip": 0.5, "grad_clip_by": "global_norm", "_train_batch_size_per_learner": 5000, "train_batch_size": 4000, "num_epochs": 2, "minibatch_size": 1000, "shuffle_batch_per_epoch": true, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "log_std_clip_param": 20.0, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "_disable_preprocessor_api": false, "_disable_action_flattening": false}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "_learner_class": null, "callbacks_on_algorithm_init": null, "callbacks_on_env_runners_recreated": null, "callbacks_on_offline_eval_runners_recreated": null, "callbacks_on_checkpoint_loaded": null, "callbacks_on_environment_created": null, "callbacks_on_episode_created": null, "callbacks_on_episode_start": null, "callbacks_on_episode_step": null, "callbacks_on_episode_end": null, "callbacks_on_evaluate_start": null, "callbacks_on_evaluate_end": null, "callbacks_on_evaluate_offline_start": null, "callbacks_on_evaluate_offline_end": null, "callbacks_on_sample_end": null, "callbacks_on_train_result": null, "explore": true, "enable_rl_module_and_learner": true, "enable_env_runner_and_connector_v2": true, "_prior_exploration_config": {"type": "StochasticSampling"}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x77ab39ecaac0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "offline_data_class": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_read_batch_size": null, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "materialize_data": false, "materialize_mapped_data": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "ignore_final_observation": false, "prelearner_class": null, "prelearner_buffer_class": null, "prelearner_buffer_kwargs": {}, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_remaining_data": false, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": 1, "evaluation_duration": 20, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_auto_duration_min_env_steps_per_sample": 100, "evaluation_auto_duration_max_env_steps_per_sample": 2000, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 1, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "offline_evaluation_interval": null, "num_offline_eval_runners": 0, "offline_loss_for_module_fn": null, "offline_evaluation_duration": 1, "offline_evaluation_parallel_to_training": false, "offline_evaluation_timeout_s": 120.0, "num_cpus_per_offline_eval_runner": 1, "num_gpus_per_offline_eval_runner": 0, "custom_resources_per_offline_eval_runner": {}, "restart_failed_offline_eval_runners": true, "ignore_offline_eval_runner_failures": false, "max_num_offline_eval_runner_restarts": 1000, "offline_eval_runner_restore_timeout_s": 1800.0, "max_requests_in_flight_per_offline_eval_runner": 1, "validate_offline_eval_runners_after_construction": true, "offline_eval_runner_health_probe_timeout_s": 30.0, "offline_eval_rl_module_inference_only": false, "broadcast_offline_eval_runner_states": false, "offline_eval_batch_size_per_runner": 256, "dataset_num_iters_per_eval_runner": 1, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "log_gradients": true, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 42, "restart_failed_env_runners": true, "ignore_env_runner_failures": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30.0, "env_runner_restore_timeout_s": 1800.0, "_model_config": {}, "_rl_module_spec": "RLModuleSpec(module_class=None, observation_space=None, action_space=None, inference_only=False, learner_only=False, model_config=DefaultModelConfig(fcnet_hiddens=[44, 121], fcnet_activation='tanh', fcnet_kernel_initializer=None, fcnet_kernel_initializer_kwargs=None, fcnet_bias_initializer=None, fcnet_bias_initializer_kwargs=None, conv_filters=None, conv_activation='relu', conv_kernel_initializer=None, conv_kernel_initializer_kwargs=None, conv_bias_initializer=None, conv_bias_initializer_kwargs=None, head_fcnet_hiddens=[], head_fcnet_activation='relu', head_fcnet_kernel_initializer=None, head_fcnet_kernel_initializer_kwargs=None, head_fcnet_bias_initializer=None, head_fcnet_bias_initializer_kwargs=None, free_log_std=False, log_std_clip_param=20.0, vf_share_layers=True, use_lstm=False, max_seq_len=20, lstm_cell_size=256, lstm_use_prev_action=False, lstm_use_prev_reward=False, lstm_kernel_initializer=None, lstm_kernel_initializer_kwargs=None, lstm_bias_initializer=None, lstm_bias_initializer_kwargs=None), catalog_class=None, load_state_path=None, model_config_dict=None)", "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "_validate_config": true, "_use_msgpack_checkpoints": false, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "env_task_fn": -1, "enable_connectors": -1, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2326331382298, "kl_target": 0.0157623383336, "vf_loss_coeff": 0.5168547272885, "entropy_coeff": 0.0045811242641, "clip_param": 0.1219640961782, "vf_clip_param": 0.2247386827741, "entropy_coeff_schedule": null, "lr_schedule": null, "sgd_minibatch_size": -1, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9065181339776, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.callbacks.callbacks.RLlibCallback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 39.972931146621704, "iterations_since_restore": 8, "perf": {"cpu_util_percent": 12.457142857142856, "ram_util_percent": 70.28571428571429}}
{"timers": {"training_iteration": 4.359414735811484, "restore_env_runners": 4.256281019912681e-05, "training_step": 4.359153182142955, "env_runner_sampling_timer": 3.9297084921330505, "learner_update_timer": 0.42582531343826885, "synch_weights": 0.001578970092813621, "restore_eval_env_runners": 1.4344544857367513e-05, "evaluation_iteration": 0.7469826063265138, "synch_eval_env_connectors": 0.0005310177524023893, "synch_env_connectors": 8.126561932495486e-06}, "env_runners": {"env_to_module_connector": {"timers": {"connectors": {"numpy_to_tensor": 3.129841299498279e-05, "add_states_from_episodes_to_batch": 3.5381163993528036e-06, "add_observations_from_episodes_to_batch": 6.214826885445828e-06, "add_time_dim_to_batch_and_zero_pad": 6.483720137925849e-06, "batch_individual_items": 1.8766019187316842e-05}}, "connector_pipeline_timer": 0.00011964677768229213}, "weights_seq_no": 8.0, "num_agent_steps_sampled": {"default_agent": 5000.0}, "num_episodes_lifetime": -33750.0, "module_to_env_connector": {"timers": {"connectors": {"un_batch_to_individual_items": 1.5148970864356814e-05, "normalize_and_clip_actions": 2.2296085391724566e-05, "tensor_to_numpy": 4.945362518490437e-05, "get_actions": 0.00016725300676916573, "listify_data_for_vector_env": 3.094275553119937e-05, "remove_single_ts_time_rank_from_batch": 1.5117175281707872e-06}}, "connector_pipeline_timer": 0.00036441920664663524}, "episode_return_max": 14.5, "episode_return_mean": 10.900000000000007, "env_step_timer": 4.328782227224355e-05, "time_between_sampling": 0.01251039288955713, "episode_len_mean": 50.0, "episode_return_min": -5.5, "num_episodes": 100.0, "rlmodule_inference_timer": 0.0001014463549335781, "sample": 0.03784174621967968, "module_episode_returns_mean": {"default_policy": 10.900000000000007}, "agent_episode_returns_mean": {"default_agent": 10.900000000000007}, "num_module_steps_sampled": {"default_policy": 5000.0}, "env_to_module_sum_episodes_length_in": 27.16809333212661, "env_reset_timer": 9.441318778455705e-05, "num_env_steps_sampled": 5000.0, "num_agent_steps_sampled_lifetime": {"default_agent": -1687500.0}, "episode_duration_sec_mean": 0.03677573602994927, "num_env_steps_sampled_lifetime": -1687500.0, "episode_len_max": 50, "env_to_module_sum_episodes_length_out": 27.16809333212661, "episode_len_min": 50, "num_module_steps_sampled_lifetime": {"default_policy": -1687500.0}, "num_env_steps_sampled_lifetime_throughput": 1272.9022772576093}, "learners": {"__all_modules__": {"num_trainable_parameters": 5987, "learner_connector_sum_episodes_length_out": 5100.0, "num_module_steps_trained_lifetime": 99000, "learner_connector": {"timers": {"connectors": {"general_advantage_estimation": 0.014036047829146518, "add_time_dim_to_batch_and_zero_pad": 2.4928699879102985e-05, "numpy_to_tensor": 0.00020625468265658635, "add_states_from_episodes_to_batch": 6.751966411161774e-06, "add_one_ts_to_episodes_and_truncate": 0.008622068335399783, "add_columns_from_episodes_to_train_batch": 0.0696066241170885, "batch_individual_items": 0.19822866134581227, "add_observations_from_episodes_to_batch": 0.000758249311500066}}, "connector_pipeline_timer": 0.2918645765596615}, "num_non_trainable_parameters": 0, "num_env_steps_trained": 56100, "num_module_steps_trained": 11000, "learner_connector_sum_episodes_length_in": 5000.0, "num_env_steps_trained_lifetime": 504900, "num_env_steps_trained_lifetime_throughput": 998659.9969480645, "num_module_steps_trained_throughput": 196390.5579571124, "num_module_steps_trained_lifetime_throughput": 196254.38307785537}, "default_policy": {"module_train_batch_size_mean": 1000.0, "num_trainable_parameters": 5987, "vf_explained_var": 0.5553150177001953, "curr_kl_coeff": 0.00045436160871759057, "mean_kl_loss": 0.001274325419217348, "num_module_steps_trained": 11000, "vf_loss_unclipped": 13.175600051879883, "diff_num_grad_updates_vs_sampler_policy": 1.0, "total_loss": 0.08089155703783035, "default_optimizer_learning_rate": 0.0050505681543, "weights_seq_no": 9.0, "gradients_default_optimizer_global_norm": 0.04689349979162216, "entropy": 0.6257888674736023, "policy_loss": -0.008700414560735226, "num_module_steps_trained_lifetime": 99000, "curr_entropy_coeff": 0.0045811242641, "vf_loss": 0.17888511717319489, "num_module_steps_trained_lifetime_throughput": 196640.1594451342}}, "num_training_step_calls_per_iteration": 1, "evaluation": {"env_runners": {"rlmodule_inference_timer": 9.768846227326909e-05, "num_episodes": 20, "module_to_env_connector": {"timers": {"connectors": {"tensor_to_numpy": 4.57643906059191e-05, "listify_data_for_vector_env": 3.0180751088765143e-05, "get_actions": 0.0001585040190442, "remove_single_ts_time_rank_from_batch": 1.3705614356125995e-06, "un_batch_to_individual_items": 1.527914940045642e-05, "normalize_and_clip_actions": 2.1631847953257557e-05}}, "connector_pipeline_timer": 0.0003466131509186283}, "env_reset_timer": 0.00020401097431961898, "num_env_steps_sampled": 1000, "env_to_module_connector": {"timers": {"connectors": {"add_observations_from_episodes_to_batch": 6.292239856107455e-06, "add_time_dim_to_batch_and_zero_pad": 5.380895142391576e-06, "numpy_to_tensor": 3.0129446633121392e-05, "add_states_from_episodes_to_batch": 3.3103962449607522e-06, "batch_individual_items": 1.793202571359673e-05}}, "connector_pipeline_timer": 0.00011429194625109118}, "num_agent_steps_sampled": {"default_agent": 1000}, "episode_len_max": 50, "module_episode_returns_mean": {"default_policy": -1.1}, "env_step_timer": 4.245035817326933e-05, "agent_episode_returns_mean": {"default_agent": -1.1}, "num_agent_steps_sampled_lifetime": {"default_agent": 9000}, "episode_len_mean": 50.0, "env_to_module_sum_episodes_length_in": 27.168093332126602, "env_to_module_sum_episodes_length_out": 27.168093332126602, "episode_len_min": 50, "num_module_steps_sampled": {"default_policy": 1000}, "episode_return_mean": -1.1, "episode_return_min": -16.5, "sample": 0.7347226585934122, "num_module_steps_sampled_lifetime": {"default_policy": 9000}, "episode_duration_sec_mean": 0.035010088059989355, "num_env_steps_sampled_lifetime": 46000, "weights_seq_no": 9.0, "num_episodes_lifetime": 180, "episode_return_max": 17.5, "time_between_sampling": 4.198906789035564}, "num_healthy_workers": 1, "actor_manager_num_outstanding_async_reqs": 0, "num_remote_worker_restarts": 0}, "num_env_steps_sampled_lifetime": -1687500.0, "fault_tolerance": {"num_healthy_workers": 0, "num_remote_worker_restarts": 0}, "env_runner_group": {"actor_manager_num_outstanding_async_reqs": 0}, "done": false, "training_iteration": 9, "trial_id": "1117f_00000", "date": "2025-08-11_17-55-42", "timestamp": 1754927742, "time_this_iter_s": 4.873311996459961, "time_total_s": 44.846243143081665, "pid": 101658, "hostname": "DESKTOP-3SK5A41", "node_ip": "192.168.40.242", "config": {"exploration_config": {}, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 6, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "env": "Umbrella", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": false, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 0, "create_local_env_runner": true, "num_envs_per_env_runner": 1, "gym_env_vectorize_mode": "SYNC", "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "episodes_to_numpy": true, "max_requests_in_flight_per_env_runner": 1, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "merge_env_runner_states": "training_only", "broadcast_env_runner_states": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "complete_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "sampler_perf_stats_ema_coef": null, "_is_online": true, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": "auto", "num_aggregator_actors_per_learner": 0, "max_requests_in_flight_per_aggregator_actor": 3, "local_gpu_idx": 0, "max_requests_in_flight_per_learner": 3, "gamma": 1, "lr": 0.0050505681543, "grad_clip": 0.5, "grad_clip_by": "global_norm", "_train_batch_size_per_learner": 5000, "train_batch_size": 4000, "num_epochs": 2, "minibatch_size": 1000, "shuffle_batch_per_epoch": true, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "log_std_clip_param": 20.0, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "_disable_preprocessor_api": false, "_disable_action_flattening": false}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "_learner_class": null, "callbacks_on_algorithm_init": null, "callbacks_on_env_runners_recreated": null, "callbacks_on_offline_eval_runners_recreated": null, "callbacks_on_checkpoint_loaded": null, "callbacks_on_environment_created": null, "callbacks_on_episode_created": null, "callbacks_on_episode_start": null, "callbacks_on_episode_step": null, "callbacks_on_episode_end": null, "callbacks_on_evaluate_start": null, "callbacks_on_evaluate_end": null, "callbacks_on_evaluate_offline_start": null, "callbacks_on_evaluate_offline_end": null, "callbacks_on_sample_end": null, "callbacks_on_train_result": null, "explore": true, "enable_rl_module_and_learner": true, "enable_env_runner_and_connector_v2": true, "_prior_exploration_config": {"type": "StochasticSampling"}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x77ab39ecaac0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "offline_data_class": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_read_batch_size": null, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "materialize_data": false, "materialize_mapped_data": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "ignore_final_observation": false, "prelearner_class": null, "prelearner_buffer_class": null, "prelearner_buffer_kwargs": {}, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_remaining_data": false, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": 1, "evaluation_duration": 20, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_auto_duration_min_env_steps_per_sample": 100, "evaluation_auto_duration_max_env_steps_per_sample": 2000, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 1, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "offline_evaluation_interval": null, "num_offline_eval_runners": 0, "offline_loss_for_module_fn": null, "offline_evaluation_duration": 1, "offline_evaluation_parallel_to_training": false, "offline_evaluation_timeout_s": 120.0, "num_cpus_per_offline_eval_runner": 1, "num_gpus_per_offline_eval_runner": 0, "custom_resources_per_offline_eval_runner": {}, "restart_failed_offline_eval_runners": true, "ignore_offline_eval_runner_failures": false, "max_num_offline_eval_runner_restarts": 1000, "offline_eval_runner_restore_timeout_s": 1800.0, "max_requests_in_flight_per_offline_eval_runner": 1, "validate_offline_eval_runners_after_construction": true, "offline_eval_runner_health_probe_timeout_s": 30.0, "offline_eval_rl_module_inference_only": false, "broadcast_offline_eval_runner_states": false, "offline_eval_batch_size_per_runner": 256, "dataset_num_iters_per_eval_runner": 1, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "log_gradients": true, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 42, "restart_failed_env_runners": true, "ignore_env_runner_failures": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30.0, "env_runner_restore_timeout_s": 1800.0, "_model_config": {}, "_rl_module_spec": "RLModuleSpec(module_class=None, observation_space=None, action_space=None, inference_only=False, learner_only=False, model_config=DefaultModelConfig(fcnet_hiddens=[44, 121], fcnet_activation='tanh', fcnet_kernel_initializer=None, fcnet_kernel_initializer_kwargs=None, fcnet_bias_initializer=None, fcnet_bias_initializer_kwargs=None, conv_filters=None, conv_activation='relu', conv_kernel_initializer=None, conv_kernel_initializer_kwargs=None, conv_bias_initializer=None, conv_bias_initializer_kwargs=None, head_fcnet_hiddens=[], head_fcnet_activation='relu', head_fcnet_kernel_initializer=None, head_fcnet_kernel_initializer_kwargs=None, head_fcnet_bias_initializer=None, head_fcnet_bias_initializer_kwargs=None, free_log_std=False, log_std_clip_param=20.0, vf_share_layers=True, use_lstm=False, max_seq_len=20, lstm_cell_size=256, lstm_use_prev_action=False, lstm_use_prev_reward=False, lstm_kernel_initializer=None, lstm_kernel_initializer_kwargs=None, lstm_bias_initializer=None, lstm_bias_initializer_kwargs=None), catalog_class=None, load_state_path=None, model_config_dict=None)", "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "_validate_config": true, "_use_msgpack_checkpoints": false, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "env_task_fn": -1, "enable_connectors": -1, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2326331382298, "kl_target": 0.0157623383336, "vf_loss_coeff": 0.5168547272885, "entropy_coeff": 0.0045811242641, "clip_param": 0.1219640961782, "vf_clip_param": 0.2247386827741, "entropy_coeff_schedule": null, "lr_schedule": null, "sgd_minibatch_size": -1, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9065181339776, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.callbacks.callbacks.RLlibCallback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 44.846243143081665, "iterations_since_restore": 9, "perf": {"cpu_util_percent": 12.357142857142858, "ram_util_percent": 70.21428571428571}}
{"timers": {"training_iteration": 4.358655457463372, "restore_env_runners": 4.225118209207288e-05, "training_step": 4.358392780331525, "env_runner_sampling_timer": 3.9296260592217163, "learner_update_timer": 0.4251438723038873, "synch_weights": 0.0015778403918825779, "restore_eval_env_runners": 1.4312099408172528e-05, "evaluation_iteration": 0.7468761772632478, "synch_eval_env_connectors": 0.000529714574876093, "synch_env_connectors": 8.115296318678141e-06}, "env_runners": {"env_to_module_connector": {"timers": {"connectors": {"numpy_to_tensor": 3.138098691608704e-05, "add_states_from_episodes_to_batch": 3.5362766567345452e-06, "add_observations_from_episodes_to_batch": 6.224793099677073e-06, "add_time_dim_to_batch_and_zero_pad": 6.515771901272994e-06, "batch_individual_items": 1.8710928090503387e-05}}, "connector_pipeline_timer": 0.00011962060205395768}, "weights_seq_no": 9.0, "num_agent_steps_sampled": {"default_agent": 5000.0}, "num_episodes_lifetime": -38600.0, "module_to_env_connector": {"timers": {"connectors": {"un_batch_to_individual_items": 1.5053289287985917e-05, "normalize_and_clip_actions": 2.2254649608418046e-05, "tensor_to_numpy": 4.9499904885325485e-05, "get_actions": 0.00016695374991904829, "listify_data_for_vector_env": 3.0737913961775335e-05, "remove_single_ts_time_rank_from_batch": 1.4866481802365875e-06}}, "connector_pipeline_timer": 0.00036347636258604187}, "episode_return_max": 14.5, "episode_return_mean": 13.099999999999993, "env_step_timer": 4.318650086709392e-05, "time_between_sampling": 0.011725385871100766, "episode_len_mean": 50.0, "episode_return_min": -5.5, "num_episodes": 100.0, "rlmodule_inference_timer": 0.00010116721957714049, "sample": 0.03779226160216541, "module_episode_returns_mean": {"default_policy": 13.099999999999993}, "agent_episode_returns_mean": {"default_agent": 13.099999999999993}, "num_module_steps_sampled": {"default_policy": 5000.0}, "env_to_module_sum_episodes_length_in": 27.16809333212661, "env_reset_timer": 9.415577024505602e-05, "num_env_steps_sampled": 5000.0, "num_agent_steps_sampled_lifetime": {"default_agent": -1930000.0}, "episode_duration_sec_mean": 0.0366883020098885, "num_env_steps_sampled_lifetime": -1930000.0, "episode_len_max": 50, "env_to_module_sum_episodes_length_out": 27.16809333212661, "episode_len_min": 50, "num_module_steps_sampled_lifetime": {"default_policy": -1930000.0}, "num_env_steps_sampled_lifetime_throughput": 1274.5039415092117}, "learners": {"__all_modules__": {"num_trainable_parameters": 5987, "learner_connector_sum_episodes_length_out": 5100.0, "num_module_steps_trained_lifetime": 110000, "learner_connector": {"timers": {"connectors": {"general_advantage_estimation": 0.014002449350859945, "add_time_dim_to_batch_and_zero_pad": 2.4890412886259383e-05, "numpy_to_tensor": 0.00020586213583148846, "add_states_from_episodes_to_batch": 6.741446744518822e-06, "add_one_ts_to_episodes_and_truncate": 0.008618604652045914, "add_columns_from_episodes_to_train_batch": 0.06958872687592015, "batch_individual_items": 0.1982748567323593, "add_observations_from_episodes_to_batch": 0.0007576188183793367}}, "connector_pipeline_timer": 0.29185400079406804}, "num_non_trainable_parameters": 0, "num_env_steps_trained": 56100, "num_module_steps_trained": 11000, "learner_connector_sum_episodes_length_in": 5000.0, "num_env_steps_trained_lifetime": 561000, "num_env_steps_trained_lifetime_throughput": 992524.9919915978, "num_module_steps_trained_throughput": 195161.07025840375, "num_module_steps_trained_lifetime_throughput": 195029.08916920365}, "default_policy": {"module_train_batch_size_mean": 1000.0, "num_trainable_parameters": 5987, "vf_explained_var": 0.16518843173980713, "curr_kl_coeff": 0.00022718080435879529, "mean_kl_loss": 0.0035121000837534666, "num_module_steps_trained": 11000, "vf_loss_unclipped": 16.98948860168457, "diff_num_grad_updates_vs_sampler_policy": 1.0, "total_loss": 0.05078987777233124, "default_optimizer_learning_rate": 0.0050505681543, "weights_seq_no": 10.0, "gradients_default_optimizer_global_norm": 0.12673281133174896, "entropy": 0.617910623550415, "policy_loss": -0.040539879351854324, "num_module_steps_trained_lifetime": 110000, "curr_entropy_coeff": 0.0045811242641, "vf_loss": 0.18217670917510986, "num_module_steps_trained_lifetime_throughput": 195392.53711130103}}, "num_training_step_calls_per_iteration": 1, "evaluation": {"env_runners": {"rlmodule_inference_timer": 9.558651991311139e-05, "num_episodes": 20, "module_to_env_connector": {"timers": {"connectors": {"tensor_to_numpy": 4.5458446722245544e-05, "listify_data_for_vector_env": 3.015935619228401e-05, "get_actions": 0.0001576825674636028, "remove_single_ts_time_rank_from_batch": 1.569378501478809e-06, "un_batch_to_individual_items": 1.593516433615318e-05, "normalize_and_clip_actions": 2.1725617459863322e-05}}, "connector_pipeline_timer": 0.0003463217888123736}, "env_reset_timer": 0.000203181864575298, "num_env_steps_sampled": 1000, "env_to_module_connector": {"timers": {"connectors": {"add_observations_from_episodes_to_batch": 6.2329492964464196e-06, "add_time_dim_to_batch_and_zero_pad": 5.320024168057949e-06, "numpy_to_tensor": 3.0261261483116427e-05, "add_states_from_episodes_to_batch": 3.360239812509276e-06, "batch_individual_items": 1.8621195531316355e-05}}, "connector_pipeline_timer": 0.00011498586551203285}, "num_agent_steps_sampled": {"default_agent": 1000}, "episode_len_max": 50, "module_episode_returns_mean": {"default_policy": -0.3}, "env_step_timer": 4.3298183635667224e-05, "agent_episode_returns_mean": {"default_agent": -0.3}, "num_agent_steps_sampled_lifetime": {"default_agent": 10000}, "episode_len_mean": 50.0, "env_to_module_sum_episodes_length_in": 27.168093332126602, "env_to_module_sum_episodes_length_out": 27.168093332126602, "episode_len_min": 50, "num_module_steps_sampled": {"default_policy": 1000}, "episode_return_mean": -0.3, "episode_return_min": -16.5, "sample": 0.734680337007479, "num_module_steps_sampled_lifetime": {"default_policy": 10000}, "episode_duration_sec_mean": 0.03501508102998741, "num_env_steps_sampled_lifetime": 51000, "weights_seq_no": 10.0, "num_episodes_lifetime": 200, "episode_return_max": 17.5, "time_between_sampling": 4.200276068155216}, "num_healthy_workers": 1, "actor_manager_num_outstanding_async_reqs": 0, "num_remote_worker_restarts": 0}, "num_env_steps_sampled_lifetime": -1930000.0, "fault_tolerance": {"num_healthy_workers": 0, "num_remote_worker_restarts": 0}, "env_runner_group": {"actor_manager_num_outstanding_async_reqs": 0}, "done": false, "training_iteration": 10, "trial_id": "1117f_00000", "date": "2025-08-11_17-55-47", "timestamp": 1754927747, "time_this_iter_s": 5.0285484790802, "time_total_s": 49.874791622161865, "pid": 101658, "hostname": "DESKTOP-3SK5A41", "node_ip": "192.168.40.242", "config": {"exploration_config": {}, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 6, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "env": "Umbrella", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": false, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 0, "create_local_env_runner": true, "num_envs_per_env_runner": 1, "gym_env_vectorize_mode": "SYNC", "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "episodes_to_numpy": true, "max_requests_in_flight_per_env_runner": 1, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "merge_env_runner_states": "training_only", "broadcast_env_runner_states": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "complete_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "sampler_perf_stats_ema_coef": null, "_is_online": true, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": "auto", "num_aggregator_actors_per_learner": 0, "max_requests_in_flight_per_aggregator_actor": 3, "local_gpu_idx": 0, "max_requests_in_flight_per_learner": 3, "gamma": 1, "lr": 0.0050505681543, "grad_clip": 0.5, "grad_clip_by": "global_norm", "_train_batch_size_per_learner": 5000, "train_batch_size": 4000, "num_epochs": 2, "minibatch_size": 1000, "shuffle_batch_per_epoch": true, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "log_std_clip_param": 20.0, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "_disable_preprocessor_api": false, "_disable_action_flattening": false}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "_learner_class": null, "callbacks_on_algorithm_init": null, "callbacks_on_env_runners_recreated": null, "callbacks_on_offline_eval_runners_recreated": null, "callbacks_on_checkpoint_loaded": null, "callbacks_on_environment_created": null, "callbacks_on_episode_created": null, "callbacks_on_episode_start": null, "callbacks_on_episode_step": null, "callbacks_on_episode_end": null, "callbacks_on_evaluate_start": null, "callbacks_on_evaluate_end": null, "callbacks_on_evaluate_offline_start": null, "callbacks_on_evaluate_offline_end": null, "callbacks_on_sample_end": null, "callbacks_on_train_result": null, "explore": true, "enable_rl_module_and_learner": true, "enable_env_runner_and_connector_v2": true, "_prior_exploration_config": {"type": "StochasticSampling"}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x77ab39ecaac0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "offline_data_class": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_read_batch_size": null, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "materialize_data": false, "materialize_mapped_data": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "ignore_final_observation": false, "prelearner_class": null, "prelearner_buffer_class": null, "prelearner_buffer_kwargs": {}, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_remaining_data": false, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": 1, "evaluation_duration": 20, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_auto_duration_min_env_steps_per_sample": 100, "evaluation_auto_duration_max_env_steps_per_sample": 2000, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 1, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "offline_evaluation_interval": null, "num_offline_eval_runners": 0, "offline_loss_for_module_fn": null, "offline_evaluation_duration": 1, "offline_evaluation_parallel_to_training": false, "offline_evaluation_timeout_s": 120.0, "num_cpus_per_offline_eval_runner": 1, "num_gpus_per_offline_eval_runner": 0, "custom_resources_per_offline_eval_runner": {}, "restart_failed_offline_eval_runners": true, "ignore_offline_eval_runner_failures": false, "max_num_offline_eval_runner_restarts": 1000, "offline_eval_runner_restore_timeout_s": 1800.0, "max_requests_in_flight_per_offline_eval_runner": 1, "validate_offline_eval_runners_after_construction": true, "offline_eval_runner_health_probe_timeout_s": 30.0, "offline_eval_rl_module_inference_only": false, "broadcast_offline_eval_runner_states": false, "offline_eval_batch_size_per_runner": 256, "dataset_num_iters_per_eval_runner": 1, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "log_gradients": true, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 42, "restart_failed_env_runners": true, "ignore_env_runner_failures": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30.0, "env_runner_restore_timeout_s": 1800.0, "_model_config": {}, "_rl_module_spec": "RLModuleSpec(module_class=None, observation_space=None, action_space=None, inference_only=False, learner_only=False, model_config=DefaultModelConfig(fcnet_hiddens=[44, 121], fcnet_activation='tanh', fcnet_kernel_initializer=None, fcnet_kernel_initializer_kwargs=None, fcnet_bias_initializer=None, fcnet_bias_initializer_kwargs=None, conv_filters=None, conv_activation='relu', conv_kernel_initializer=None, conv_kernel_initializer_kwargs=None, conv_bias_initializer=None, conv_bias_initializer_kwargs=None, head_fcnet_hiddens=[], head_fcnet_activation='relu', head_fcnet_kernel_initializer=None, head_fcnet_kernel_initializer_kwargs=None, head_fcnet_bias_initializer=None, head_fcnet_bias_initializer_kwargs=None, free_log_std=False, log_std_clip_param=20.0, vf_share_layers=True, use_lstm=False, max_seq_len=20, lstm_cell_size=256, lstm_use_prev_action=False, lstm_use_prev_reward=False, lstm_kernel_initializer=None, lstm_kernel_initializer_kwargs=None, lstm_bias_initializer=None, lstm_bias_initializer_kwargs=None), catalog_class=None, load_state_path=None, model_config_dict=None)", "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "_validate_config": true, "_use_msgpack_checkpoints": false, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "env_task_fn": -1, "enable_connectors": -1, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2326331382298, "kl_target": 0.0157623383336, "vf_loss_coeff": 0.5168547272885, "entropy_coeff": 0.0045811242641, "clip_param": 0.1219640961782, "vf_clip_param": 0.2247386827741, "entropy_coeff_schedule": null, "lr_schedule": null, "sgd_minibatch_size": -1, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9065181339776, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.callbacks.callbacks.RLlibCallback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 49.874791622161865, "iterations_since_restore": 10, "perf": {"cpu_util_percent": 12.799999999999999, "ram_util_percent": 70.3}}
{"timers": {"training_iteration": 4.35673343989874, "restore_env_runners": 4.194167027666488e-05, "training_step": 4.356469849538214, "env_runner_sampling_timer": 3.9298285726394977, "learner_update_timer": 0.42301756958085257, "synch_weights": 0.0015760629879633047, "restore_eval_env_runners": 1.4283978407547679e-05, "evaluation_iteration": 0.7468086834906187, "synch_eval_env_connectors": 0.0005288504291310328, "synch_env_connectors": 8.09414335761361e-06}, "env_runners": {"env_to_module_connector": {"timers": {"connectors": {"numpy_to_tensor": 3.169839007625479e-05, "add_states_from_episodes_to_batch": 3.545943986778244e-06, "add_observations_from_episodes_to_batch": 6.250812327701404e-06, "add_time_dim_to_batch_and_zero_pad": 6.606962799970872e-06, "batch_individual_items": 1.890913074441219e-05}}, "connector_pipeline_timer": 0.00012051055923171726}, "weights_seq_no": 10.0, "num_agent_steps_sampled": {"default_agent": 5000.0}, "num_episodes_lifetime": -43450.0, "module_to_env_connector": {"timers": {"connectors": {"un_batch_to_individual_items": 1.5157324782314247e-05, "normalize_and_clip_actions": 2.2425678449633506e-05, "tensor_to_numpy": 4.9770324477475704e-05, "get_actions": 0.00016781858707842296, "listify_data_for_vector_env": 3.1054698840640736e-05, "remove_single_ts_time_rank_from_batch": 1.5040793951819965e-06}}, "connector_pipeline_timer": 0.0003655551347771251}, "episode_return_max": 14.5, "episode_return_mean": 12.700000000000003, "env_step_timer": 4.3498834237464065e-05, "time_between_sampling": 0.01250122209118627, "episode_len_mean": 50.0, "episode_return_min": -5.5, "num_episodes": 100.0, "rlmodule_inference_timer": 0.00010202949008507328, "sample": 0.037846226306732726, "module_episode_returns_mean": {"default_policy": 12.700000000000003}, "agent_episode_returns_mean": {"default_agent": 12.700000000000003}, "num_module_steps_sampled": {"default_policy": 5000.0}, "env_to_module_sum_episodes_length_in": 27.16809333212661, "env_reset_timer": 9.415972053758116e-05, "num_env_steps_sampled": 5000.0, "num_agent_steps_sampled_lifetime": {"default_agent": -2172500.0}, "episode_duration_sec_mean": 0.0369467660099872, "num_env_steps_sampled_lifetime": -2172500.0, "episode_len_max": 50, "env_to_module_sum_episodes_length_out": 27.16809333212661, "episode_len_min": 50, "num_module_steps_sampled_lifetime": {"default_policy": -2172500.0}, "num_env_steps_sampled_lifetime_throughput": 1268.0638096750552}, "learners": {"__all_modules__": {"num_trainable_parameters": 5987, "learner_connector_sum_episodes_length_out": 5100.0, "num_module_steps_trained_lifetime": 121000, "learner_connector": {"timers": {"connectors": {"general_advantage_estimation": 0.013959323857351467, "add_time_dim_to_batch_and_zero_pad": 2.497550875405241e-05, "numpy_to_tensor": 0.00020560651447783007, "add_states_from_episodes_to_batch": 6.749032275178974e-06, "add_one_ts_to_episodes_and_truncate": 0.008617802605529069, "add_columns_from_episodes_to_train_batch": 0.06958759360715741, "batch_individual_items": 0.19686368616504396, "add_observations_from_episodes_to_batch": 0.0007580096301878205}}, "connector_pipeline_timer": 0.2903976287861256}, "num_non_trainable_parameters": 0, "num_env_steps_trained": 56100, "num_module_steps_trained": 11000, "learner_connector_sum_episodes_length_in": 5000.0, "num_env_steps_trained_lifetime": 617100, "num_env_steps_trained_lifetime_throughput": 985658.089661735, "num_module_steps_trained_throughput": 193790.07627150917, "num_module_steps_trained_lifetime_throughput": 193661.63972382303}, "default_policy": {"module_train_batch_size_mean": 1000.0, "num_trainable_parameters": 5987, "vf_explained_var": 0.27009904384613037, "curr_kl_coeff": 0.00011359040217939764, "mean_kl_loss": 0.0016673848731443286, "num_module_steps_trained": 11000, "vf_loss_unclipped": 15.931329727172852, "diff_num_grad_updates_vs_sampler_policy": 1.0, "total_loss": 0.1181817501783371, "default_optimizer_learning_rate": 0.0050505681543, "weights_seq_no": 11.0, "gradients_default_optimizer_global_norm": 0.19729436933994293, "entropy": 0.5961676836013794, "policy_loss": 0.029831653460860252, "num_module_steps_trained_lifetime": 121000, "curr_entropy_coeff": 0.0045811242641, "vf_loss": 0.1762213259935379, "num_module_steps_trained_lifetime_throughput": 194004.11976137062}}, "num_training_step_calls_per_iteration": 1, "evaluation": {"env_runners": {"rlmodule_inference_timer": 9.647480852688844e-05, "num_episodes": 20, "module_to_env_connector": {"timers": {"connectors": {"tensor_to_numpy": 4.486007123736932e-05, "listify_data_for_vector_env": 3.0930427818294215e-05, "get_actions": 0.00015474215154653945, "remove_single_ts_time_rank_from_batch": 1.4720858326410156e-06, "un_batch_to_individual_items": 1.5166574928142183e-05, "normalize_and_clip_actions": 2.213633167366929e-05}}, "connector_pipeline_timer": 0.00034249421531447}, "env_reset_timer": 0.0002023350459305322, "num_env_steps_sampled": 1000, "env_to_module_connector": {"timers": {"connectors": {"add_observations_from_episodes_to_batch": 6.652400803031676e-06, "add_time_dim_to_batch_and_zero_pad": 5.277533413675398e-06, "numpy_to_tensor": 2.8961456417363525e-05, "add_states_from_episodes_to_batch": 3.2016411200936455e-06, "batch_individual_items": 1.838910853696653e-05}}, "connector_pipeline_timer": 0.00011268440323931719}, "num_agent_steps_sampled": {"default_agent": 1000}, "episode_len_max": 50, "module_episode_returns_mean": {"default_policy": -0.7}, "env_step_timer": 4.212374257520819e-05, "agent_episode_returns_mean": {"default_agent": -0.7}, "num_agent_steps_sampled_lifetime": {"default_agent": 11000}, "episode_len_mean": 50.0, "env_to_module_sum_episodes_length_in": 27.168093332126602, "env_to_module_sum_episodes_length_out": 27.168093332126602, "episode_len_min": 50, "num_module_steps_sampled": {"default_policy": 1000}, "episode_return_mean": -0.7, "episode_return_min": -16.5, "sample": 0.7346469796374026, "num_module_steps_sampled_lifetime": {"default_policy": 11000}, "episode_duration_sec_mean": 0.03502741601998423, "num_env_steps_sampled_lifetime": 56000, "weights_seq_no": 11.0, "num_episodes_lifetime": 220, "episode_return_max": 17.5, "time_between_sampling": 4.200482774483661}, "num_healthy_workers": 1, "actor_manager_num_outstanding_async_reqs": 0, "num_remote_worker_restarts": 0}, "num_env_steps_sampled_lifetime": -2172500.0, "fault_tolerance": {"num_healthy_workers": 0, "num_remote_worker_restarts": 0}, "env_runner_group": {"actor_manager_num_outstanding_async_reqs": 0}, "done": false, "training_iteration": 11, "trial_id": "1117f_00000", "date": "2025-08-11_17-55-52", "timestamp": 1754927752, "time_this_iter_s": 4.912265062332153, "time_total_s": 54.78705668449402, "pid": 101658, "hostname": "DESKTOP-3SK5A41", "node_ip": "192.168.40.242", "config": {"exploration_config": {}, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 6, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "env": "Umbrella", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": false, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 0, "create_local_env_runner": true, "num_envs_per_env_runner": 1, "gym_env_vectorize_mode": "SYNC", "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "episodes_to_numpy": true, "max_requests_in_flight_per_env_runner": 1, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "merge_env_runner_states": "training_only", "broadcast_env_runner_states": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "complete_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "sampler_perf_stats_ema_coef": null, "_is_online": true, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": "auto", "num_aggregator_actors_per_learner": 0, "max_requests_in_flight_per_aggregator_actor": 3, "local_gpu_idx": 0, "max_requests_in_flight_per_learner": 3, "gamma": 1, "lr": 0.0050505681543, "grad_clip": 0.5, "grad_clip_by": "global_norm", "_train_batch_size_per_learner": 5000, "train_batch_size": 4000, "num_epochs": 2, "minibatch_size": 1000, "shuffle_batch_per_epoch": true, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "log_std_clip_param": 20.0, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "_disable_preprocessor_api": false, "_disable_action_flattening": false}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "_learner_class": null, "callbacks_on_algorithm_init": null, "callbacks_on_env_runners_recreated": null, "callbacks_on_offline_eval_runners_recreated": null, "callbacks_on_checkpoint_loaded": null, "callbacks_on_environment_created": null, "callbacks_on_episode_created": null, "callbacks_on_episode_start": null, "callbacks_on_episode_step": null, "callbacks_on_episode_end": null, "callbacks_on_evaluate_start": null, "callbacks_on_evaluate_end": null, "callbacks_on_evaluate_offline_start": null, "callbacks_on_evaluate_offline_end": null, "callbacks_on_sample_end": null, "callbacks_on_train_result": null, "explore": true, "enable_rl_module_and_learner": true, "enable_env_runner_and_connector_v2": true, "_prior_exploration_config": {"type": "StochasticSampling"}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x77ab39ecaac0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "offline_data_class": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_read_batch_size": null, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "materialize_data": false, "materialize_mapped_data": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "ignore_final_observation": false, "prelearner_class": null, "prelearner_buffer_class": null, "prelearner_buffer_kwargs": {}, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_remaining_data": false, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": 1, "evaluation_duration": 20, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_auto_duration_min_env_steps_per_sample": 100, "evaluation_auto_duration_max_env_steps_per_sample": 2000, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 1, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "offline_evaluation_interval": null, "num_offline_eval_runners": 0, "offline_loss_for_module_fn": null, "offline_evaluation_duration": 1, "offline_evaluation_parallel_to_training": false, "offline_evaluation_timeout_s": 120.0, "num_cpus_per_offline_eval_runner": 1, "num_gpus_per_offline_eval_runner": 0, "custom_resources_per_offline_eval_runner": {}, "restart_failed_offline_eval_runners": true, "ignore_offline_eval_runner_failures": false, "max_num_offline_eval_runner_restarts": 1000, "offline_eval_runner_restore_timeout_s": 1800.0, "max_requests_in_flight_per_offline_eval_runner": 1, "validate_offline_eval_runners_after_construction": true, "offline_eval_runner_health_probe_timeout_s": 30.0, "offline_eval_rl_module_inference_only": false, "broadcast_offline_eval_runner_states": false, "offline_eval_batch_size_per_runner": 256, "dataset_num_iters_per_eval_runner": 1, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "log_gradients": true, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 42, "restart_failed_env_runners": true, "ignore_env_runner_failures": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30.0, "env_runner_restore_timeout_s": 1800.0, "_model_config": {}, "_rl_module_spec": "RLModuleSpec(module_class=None, observation_space=None, action_space=None, inference_only=False, learner_only=False, model_config=DefaultModelConfig(fcnet_hiddens=[44, 121], fcnet_activation='tanh', fcnet_kernel_initializer=None, fcnet_kernel_initializer_kwargs=None, fcnet_bias_initializer=None, fcnet_bias_initializer_kwargs=None, conv_filters=None, conv_activation='relu', conv_kernel_initializer=None, conv_kernel_initializer_kwargs=None, conv_bias_initializer=None, conv_bias_initializer_kwargs=None, head_fcnet_hiddens=[], head_fcnet_activation='relu', head_fcnet_kernel_initializer=None, head_fcnet_kernel_initializer_kwargs=None, head_fcnet_bias_initializer=None, head_fcnet_bias_initializer_kwargs=None, free_log_std=False, log_std_clip_param=20.0, vf_share_layers=True, use_lstm=False, max_seq_len=20, lstm_cell_size=256, lstm_use_prev_action=False, lstm_use_prev_reward=False, lstm_kernel_initializer=None, lstm_kernel_initializer_kwargs=None, lstm_bias_initializer=None, lstm_bias_initializer_kwargs=None), catalog_class=None, load_state_path=None, model_config_dict=None)", "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "_validate_config": true, "_use_msgpack_checkpoints": false, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "env_task_fn": -1, "enable_connectors": -1, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2326331382298, "kl_target": 0.0157623383336, "vf_loss_coeff": 0.5168547272885, "entropy_coeff": 0.0045811242641, "clip_param": 0.1219640961782, "vf_clip_param": 0.2247386827741, "entropy_coeff_schedule": null, "lr_schedule": null, "sgd_minibatch_size": -1, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9065181339776, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.callbacks.callbacks.RLlibCallback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 54.78705668449402, "iterations_since_restore": 11, "perf": {"cpu_util_percent": 11.971428571428572, "ram_util_percent": 70.3}}
{"timers": {"training_iteration": 4.356188671509748, "restore_env_runners": 4.164525357370137e-05, "training_step": 4.355923797052827, "env_runner_sampling_timer": 3.929978054923098, "learner_update_timer": 0.4223229288850449, "synch_weights": 0.001574429358087681, "restore_eval_env_runners": 1.424613862263867e-05, "evaluation_iteration": 0.7467483646557153, "synch_eval_env_connectors": 0.0005280969248379361, "synch_env_connectors": 8.085201917489229e-06}, "env_runners": {"env_to_module_connector": {"timers": {"connectors": {"numpy_to_tensor": 3.153191054705071e-05, "add_states_from_episodes_to_batch": 3.537103137416826e-06, "add_observations_from_episodes_to_batch": 6.292705134558952e-06, "add_time_dim_to_batch_and_zero_pad": 6.526608534498918e-06, "batch_individual_items": 1.8875310060240515e-05}}, "connector_pipeline_timer": 0.00012030426009877694}, "weights_seq_no": 11.0, "num_agent_steps_sampled": {"default_agent": 5000.0}, "num_episodes_lifetime": -48300.0, "module_to_env_connector": {"timers": {"connectors": {"un_batch_to_individual_items": 1.5228102012184789e-05, "normalize_and_clip_actions": 2.2464368180851977e-05, "tensor_to_numpy": 4.9779555518363486e-05, "get_actions": 0.00016783738766677086, "listify_data_for_vector_env": 3.0984318141829274e-05, "remove_single_ts_time_rank_from_batch": 1.503238211415506e-06}}, "connector_pipeline_timer": 0.0003659075865651071}, "episode_return_max": 14.5, "episode_return_mean": 12.900000000000007, "env_step_timer": 4.342219772892184e-05, "time_between_sampling": 0.01187387909200618, "episode_len_mean": 50.0, "episode_return_min": -5.5, "num_episodes": 100.0, "rlmodule_inference_timer": 0.00010163796511716535, "sample": 0.03792346871527344, "module_episode_returns_mean": {"default_policy": 12.900000000000007}, "agent_episode_returns_mean": {"default_agent": 12.900000000000007}, "num_module_steps_sampled": {"default_policy": 5000.0}, "env_to_module_sum_episodes_length_in": 27.16809333212661, "env_reset_timer": 9.458365214455023e-05, "num_env_steps_sampled": 5000.0, "num_agent_steps_sampled_lifetime": {"default_agent": -2415000.0}, "episode_duration_sec_mean": 0.03690889401011191, "num_env_steps_sampled_lifetime": -2415000.0, "episode_len_max": 50, "env_to_module_sum_episodes_length_out": 27.16809333212661, "episode_len_min": 50, "num_module_steps_sampled_lifetime": {"default_policy": -2415000.0}, "num_env_steps_sampled_lifetime_throughput": 1267.761361208088}, "learners": {"__all_modules__": {"num_trainable_parameters": 5987, "learner_connector_sum_episodes_length_out": 5100.0, "num_module_steps_trained_lifetime": 132000, "learner_connector": {"timers": {"connectors": {"general_advantage_estimation": 0.01390644761877263, "add_time_dim_to_batch_and_zero_pad": 2.4933753667805725e-05, "numpy_to_tensor": 0.0002052244493376929, "add_states_from_episodes_to_batch": 6.740541946934942e-06, "add_one_ts_to_episodes_and_truncate": 0.00861411157947345, "add_columns_from_episodes_to_train_batch": 0.06956872067108652, "batch_individual_items": 0.19701491530339624, "add_observations_from_episodes_to_batch": 0.0007575255338853069}}, "connector_pipeline_timer": 0.29047182149827155}, "num_non_trainable_parameters": 0, "num_env_steps_trained": 56100, "num_module_steps_trained": 11000, "learner_connector_sum_episodes_length_in": 5000.0, "num_env_steps_trained_lifetime": 673200, "num_env_steps_trained_lifetime_throughput": 982444.4665295334, "num_module_steps_trained_throughput": 193137.47777672112, "num_module_steps_trained_lifetime_throughput": 193012.80660869664}, "default_policy": {"module_train_batch_size_mean": 1000.0, "num_trainable_parameters": 5987, "vf_explained_var": 0.14756447076797485, "curr_kl_coeff": 5.679520108969882e-05, "mean_kl_loss": 0.006518518086522818, "num_module_steps_trained": 11000, "vf_loss_unclipped": 18.502038955688477, "diff_num_grad_updates_vs_sampler_policy": 1.0, "total_loss": 0.09977684170007706, "default_optimizer_learning_rate": 0.0050505681543, "weights_seq_no": 12.0, "gradients_default_optimizer_global_norm": 0.2014060765504837, "entropy": 0.592818558216095, "policy_loss": 0.004385799169540405, "num_module_steps_trained_lifetime": 132000, "curr_entropy_coeff": 0.0045811242641, "vf_loss": 0.18981364369392395, "num_module_steps_trained_lifetime_throughput": 193334.54693863948}}, "num_training_step_calls_per_iteration": 1, "evaluation": {"env_runners": {"rlmodule_inference_timer": 9.654190182897708e-05, "num_episodes": 20, "module_to_env_connector": {"timers": {"connectors": {"tensor_to_numpy": 4.523027063846831e-05, "listify_data_for_vector_env": 3.1584861226803124e-05, "get_actions": 0.00015808993800254912, "remove_single_ts_time_rank_from_batch": 1.3776113550520724e-06, "un_batch_to_individual_items": 1.513579307980767e-05, "normalize_and_clip_actions": 2.147219191140709e-05}}, "connector_pipeline_timer": 0.00034635013275681866}, "env_reset_timer": 0.0002015156954713703, "num_env_steps_sampled": 1000, "env_to_module_connector": {"timers": {"connectors": {"add_observations_from_episodes_to_batch": 6.295790582063943e-06, "add_time_dim_to_batch_and_zero_pad": 5.806007474235721e-06, "numpy_to_tensor": 3.0181293842780773e-05, "add_states_from_episodes_to_batch": 3.4639893809385576e-06, "batch_individual_items": 1.8181894345679506e-05}}, "connector_pipeline_timer": 0.00011447512402714278}, "num_agent_steps_sampled": {"default_agent": 1000}, "episode_len_max": 50, "module_episode_returns_mean": {"default_policy": -0.9}, "env_step_timer": 4.193945566076776e-05, "agent_episode_returns_mean": {"default_agent": -0.9}, "num_agent_steps_sampled_lifetime": {"default_agent": 12000}, "episode_len_mean": 50.0, "env_to_module_sum_episodes_length_in": 27.168093332126602, "env_to_module_sum_episodes_length_out": 27.168093332126602, "episode_len_min": 50, "num_module_steps_sampled": {"default_policy": 1000}, "episode_return_mean": -0.9, "episode_return_min": -16.5, "sample": 0.7345627788410221, "num_module_steps_sampled_lifetime": {"default_policy": 12000}, "episode_duration_sec_mean": 0.03504834500997276, "num_env_steps_sampled_lifetime": 61000, "weights_seq_no": 12.0, "num_episodes_lifetime": 240, "episode_return_max": 17.5, "time_between_sampling": 4.202039067748823}, "num_healthy_workers": 1, "actor_manager_num_outstanding_async_reqs": 0, "num_remote_worker_restarts": 0}, "num_env_steps_sampled_lifetime": -2415000.0, "fault_tolerance": {"num_healthy_workers": 0, "num_remote_worker_restarts": 0}, "env_runner_group": {"actor_manager_num_outstanding_async_reqs": 0}, "done": false, "training_iteration": 12, "trial_id": "1117f_00000", "date": "2025-08-11_17-55-57", "timestamp": 1754927757, "time_this_iter_s": 5.042283773422241, "time_total_s": 59.82934045791626, "pid": 101658, "hostname": "DESKTOP-3SK5A41", "node_ip": "192.168.40.242", "config": {"exploration_config": {}, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 6, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "env": "Umbrella", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": false, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 0, "create_local_env_runner": true, "num_envs_per_env_runner": 1, "gym_env_vectorize_mode": "SYNC", "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "episodes_to_numpy": true, "max_requests_in_flight_per_env_runner": 1, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "merge_env_runner_states": "training_only", "broadcast_env_runner_states": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "complete_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "sampler_perf_stats_ema_coef": null, "_is_online": true, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": "auto", "num_aggregator_actors_per_learner": 0, "max_requests_in_flight_per_aggregator_actor": 3, "local_gpu_idx": 0, "max_requests_in_flight_per_learner": 3, "gamma": 1, "lr": 0.0050505681543, "grad_clip": 0.5, "grad_clip_by": "global_norm", "_train_batch_size_per_learner": 5000, "train_batch_size": 4000, "num_epochs": 2, "minibatch_size": 1000, "shuffle_batch_per_epoch": true, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "log_std_clip_param": 20.0, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "_disable_preprocessor_api": false, "_disable_action_flattening": false}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "_learner_class": null, "callbacks_on_algorithm_init": null, "callbacks_on_env_runners_recreated": null, "callbacks_on_offline_eval_runners_recreated": null, "callbacks_on_checkpoint_loaded": null, "callbacks_on_environment_created": null, "callbacks_on_episode_created": null, "callbacks_on_episode_start": null, "callbacks_on_episode_step": null, "callbacks_on_episode_end": null, "callbacks_on_evaluate_start": null, "callbacks_on_evaluate_end": null, "callbacks_on_evaluate_offline_start": null, "callbacks_on_evaluate_offline_end": null, "callbacks_on_sample_end": null, "callbacks_on_train_result": null, "explore": true, "enable_rl_module_and_learner": true, "enable_env_runner_and_connector_v2": true, "_prior_exploration_config": {"type": "StochasticSampling"}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x77ab39ecaac0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "offline_data_class": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_read_batch_size": null, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "materialize_data": false, "materialize_mapped_data": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "ignore_final_observation": false, "prelearner_class": null, "prelearner_buffer_class": null, "prelearner_buffer_kwargs": {}, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_remaining_data": false, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": 1, "evaluation_duration": 20, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_auto_duration_min_env_steps_per_sample": 100, "evaluation_auto_duration_max_env_steps_per_sample": 2000, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 1, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "offline_evaluation_interval": null, "num_offline_eval_runners": 0, "offline_loss_for_module_fn": null, "offline_evaluation_duration": 1, "offline_evaluation_parallel_to_training": false, "offline_evaluation_timeout_s": 120.0, "num_cpus_per_offline_eval_runner": 1, "num_gpus_per_offline_eval_runner": 0, "custom_resources_per_offline_eval_runner": {}, "restart_failed_offline_eval_runners": true, "ignore_offline_eval_runner_failures": false, "max_num_offline_eval_runner_restarts": 1000, "offline_eval_runner_restore_timeout_s": 1800.0, "max_requests_in_flight_per_offline_eval_runner": 1, "validate_offline_eval_runners_after_construction": true, "offline_eval_runner_health_probe_timeout_s": 30.0, "offline_eval_rl_module_inference_only": false, "broadcast_offline_eval_runner_states": false, "offline_eval_batch_size_per_runner": 256, "dataset_num_iters_per_eval_runner": 1, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "log_gradients": true, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 42, "restart_failed_env_runners": true, "ignore_env_runner_failures": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30.0, "env_runner_restore_timeout_s": 1800.0, "_model_config": {}, "_rl_module_spec": "RLModuleSpec(module_class=None, observation_space=None, action_space=None, inference_only=False, learner_only=False, model_config=DefaultModelConfig(fcnet_hiddens=[44, 121], fcnet_activation='tanh', fcnet_kernel_initializer=None, fcnet_kernel_initializer_kwargs=None, fcnet_bias_initializer=None, fcnet_bias_initializer_kwargs=None, conv_filters=None, conv_activation='relu', conv_kernel_initializer=None, conv_kernel_initializer_kwargs=None, conv_bias_initializer=None, conv_bias_initializer_kwargs=None, head_fcnet_hiddens=[], head_fcnet_activation='relu', head_fcnet_kernel_initializer=None, head_fcnet_kernel_initializer_kwargs=None, head_fcnet_bias_initializer=None, head_fcnet_bias_initializer_kwargs=None, free_log_std=False, log_std_clip_param=20.0, vf_share_layers=True, use_lstm=False, max_seq_len=20, lstm_cell_size=256, lstm_use_prev_action=False, lstm_use_prev_reward=False, lstm_kernel_initializer=None, lstm_kernel_initializer_kwargs=None, lstm_bias_initializer=None, lstm_bias_initializer_kwargs=None), catalog_class=None, load_state_path=None, model_config_dict=None)", "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "_validate_config": true, "_use_msgpack_checkpoints": false, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "env_task_fn": -1, "enable_connectors": -1, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2326331382298, "kl_target": 0.0157623383336, "vf_loss_coeff": 0.5168547272885, "entropy_coeff": 0.0045811242641, "clip_param": 0.1219640961782, "vf_clip_param": 0.2247386827741, "entropy_coeff_schedule": null, "lr_schedule": null, "sgd_minibatch_size": -1, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9065181339776, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.callbacks.callbacks.RLlibCallback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 59.82934045791626, "iterations_since_restore": 12, "perf": {"cpu_util_percent": 12.042857142857144, "ram_util_percent": 70.3}}
{"timers": {"training_iteration": 4.353881063814654, "restore_env_runners": 4.1344801039035724e-05, "training_step": 4.353615197102299, "env_runner_sampling_timer": 3.929867579383862, "learner_update_timer": 0.4201233976061925, "synch_weights": 0.0015734040645075, "restore_eval_env_runners": 1.4205677240020108e-05, "evaluation_iteration": 0.7466404400091641, "synch_eval_env_connectors": 0.0005272119555934646, "synch_env_connectors": 8.067349895995227e-06}, "env_runners": {"env_to_module_connector": {"timers": {"connectors": {"numpy_to_tensor": 3.139412151536519e-05, "add_states_from_episodes_to_batch": 3.4993355817451754e-06, "add_observations_from_episodes_to_batch": 6.1876949718300725e-06, "add_time_dim_to_batch_and_zero_pad": 6.484572616629245e-06, "batch_individual_items": 1.863250141773573e-05}}, "connector_pipeline_timer": 0.0001193289195845728}, "weights_seq_no": 12.0, "num_agent_steps_sampled": {"default_agent": 5000.0}, "num_episodes_lifetime": -53150.0, "module_to_env_connector": {"timers": {"connectors": {"un_batch_to_individual_items": 1.5109828128835978e-05, "normalize_and_clip_actions": 2.2304555002574503e-05, "tensor_to_numpy": 4.941828312900144e-05, "get_actions": 0.00016698213474447947, "listify_data_for_vector_env": 3.091058942991828e-05, "remove_single_ts_time_rank_from_batch": 1.4963719700032231e-06}}, "connector_pipeline_timer": 0.00036381142174161116}, "episode_return_max": 14.5, "episode_return_mean": 14.3, "env_step_timer": 4.314780975633519e-05, "time_between_sampling": 0.012496748070327026, "episode_len_mean": 50.0, "episode_return_min": -5.5, "num_episodes": 100.0, "rlmodule_inference_timer": 0.00010094510006937026, "sample": 0.037872849630740245, "module_episode_returns_mean": {"default_policy": 14.3}, "agent_episode_returns_mean": {"default_agent": 14.3}, "num_module_steps_sampled": {"default_policy": 5000.0}, "env_to_module_sum_episodes_length_in": 27.16809333212661, "env_reset_timer": 9.37214431954672e-05, "num_env_steps_sampled": 5000.0, "num_agent_steps_sampled_lifetime": {"default_agent": -2657500.0}, "episode_duration_sec_mean": 0.03666887300998495, "num_env_steps_sampled_lifetime": -2657500.0, "episode_len_max": 50, "env_to_module_sum_episodes_length_out": 27.16809333212661, "episode_len_min": 50, "num_module_steps_sampled_lifetime": {"default_policy": -2657500.0}, "num_env_steps_sampled_lifetime_throughput": 1272.8693885857485}, "learners": {"__all_modules__": {"num_trainable_parameters": 5987, "learner_connector_sum_episodes_length_out": 5100.0, "num_module_steps_trained_lifetime": 143000, "learner_connector": {"timers": {"connectors": {"general_advantage_estimation": 0.013855487142581651, "add_time_dim_to_batch_and_zero_pad": 2.4900416129672826e-05, "numpy_to_tensor": 0.00020483120484387905, "add_states_from_episodes_to_batch": 6.730136534029205e-06, "add_one_ts_to_episodes_and_truncate": 0.008608399463678355, "add_columns_from_episodes_to_train_batch": 0.0695419214643758, "batch_individual_items": 0.19561944616036644, "add_observations_from_episodes_to_batch": 0.0007568332785428321}}, "connector_pipeline_timer": 0.2889911102932893}, "num_non_trainable_parameters": 0, "num_env_steps_trained": 56100, "num_module_steps_trained": 11000, "learner_connector_sum_episodes_length_in": 5000.0, "num_env_steps_trained_lifetime": 729300, "num_env_steps_trained_lifetime_throughput": 979264.6500635103, "num_module_steps_trained_throughput": 192495.9936491778, "num_module_steps_trained_lifetime_throughput": 192374.0074298415}, "default_policy": {"module_train_batch_size_mean": 1000.0, "num_trainable_parameters": 5987, "vf_explained_var": -1.0, "curr_kl_coeff": 2.839760054484941e-05, "mean_kl_loss": 0.0010969281429424882, "num_module_steps_trained": 11000, "vf_loss_unclipped": 17.996349334716797, "diff_num_grad_updates_vs_sampler_policy": 1.0, "total_loss": 0.1396498829126358, "default_optimizer_learning_rate": 0.0050505681543, "weights_seq_no": 13.0, "gradients_default_optimizer_global_norm": 0.09225352853536606, "entropy": 0.5803704261779785, "policy_loss": 0.050002988427877426, "num_module_steps_trained_lifetime": 143000, "curr_entropy_coeff": 0.0045811242641, "vf_loss": 0.17859096825122833, "num_module_steps_trained_lifetime_throughput": 192677.67780461264}}, "num_training_step_calls_per_iteration": 1, "evaluation": {"env_runners": {"rlmodule_inference_timer": 9.617100150074384e-05, "num_episodes": 20, "module_to_env_connector": {"timers": {"connectors": {"tensor_to_numpy": 4.5103885885227797e-05, "listify_data_for_vector_env": 3.04591050318231e-05, "get_actions": 0.00015713164548733751, "remove_single_ts_time_rank_from_batch": 1.3885549469243607e-06, "un_batch_to_individual_items": 1.5449353286081867e-05, "normalize_and_clip_actions": 2.221383180204055e-05}}, "connector_pipeline_timer": 0.0003459234656674677}, "env_reset_timer": 0.0002012555385196153, "num_env_steps_sampled": 1000, "env_to_module_connector": {"timers": {"connectors": {"add_observations_from_episodes_to_batch": 6.336199693970028e-06, "add_time_dim_to_batch_and_zero_pad": 5.5150799407419835e-06, "numpy_to_tensor": 2.9912119134051004e-05, "add_states_from_episodes_to_batch": 3.29599810738585e-06, "batch_individual_items": 1.861892553403507e-05}}, "connector_pipeline_timer": 0.00011539324722575903}, "num_agent_steps_sampled": {"default_agent": 1000}, "episode_len_max": 50, "module_episode_returns_mean": {"default_policy": -0.5}, "env_step_timer": 4.2405225584442597e-05, "agent_episode_returns_mean": {"default_agent": -0.5}, "num_agent_steps_sampled_lifetime": {"default_agent": 13000}, "episode_len_mean": 50.0, "env_to_module_sum_episodes_length_in": 27.168093332126602, "env_to_module_sum_episodes_length_out": 27.168093332126602, "episode_len_min": 50, "num_module_steps_sampled": {"default_policy": 1000}, "episode_return_mean": -0.5, "episode_return_min": -16.5, "sample": 0.7345266380526141, "num_module_steps_sampled_lifetime": {"default_policy": 13000}, "episode_duration_sec_mean": 0.03505150299996785, "num_env_steps_sampled_lifetime": 66000, "weights_seq_no": 13.0, "num_episodes_lifetime": 260, "episode_return_max": 17.5, "time_between_sampling": 4.201836273091335}, "num_healthy_workers": 1, "actor_manager_num_outstanding_async_reqs": 0, "num_remote_worker_restarts": 0}, "num_env_steps_sampled_lifetime": -2657500.0, "fault_tolerance": {"num_healthy_workers": 0, "num_remote_worker_restarts": 0}, "env_runner_group": {"actor_manager_num_outstanding_async_reqs": 0}, "done": false, "training_iteration": 13, "trial_id": "1117f_00000", "date": "2025-08-11_17-56-02", "timestamp": 1754927762, "time_this_iter_s": 4.871665000915527, "time_total_s": 64.70100545883179, "pid": 101658, "hostname": "DESKTOP-3SK5A41", "node_ip": "192.168.40.242", "config": {"exploration_config": {}, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 6, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "env": "Umbrella", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": false, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 0, "create_local_env_runner": true, "num_envs_per_env_runner": 1, "gym_env_vectorize_mode": "SYNC", "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "episodes_to_numpy": true, "max_requests_in_flight_per_env_runner": 1, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "merge_env_runner_states": "training_only", "broadcast_env_runner_states": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "complete_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "sampler_perf_stats_ema_coef": null, "_is_online": true, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": "auto", "num_aggregator_actors_per_learner": 0, "max_requests_in_flight_per_aggregator_actor": 3, "local_gpu_idx": 0, "max_requests_in_flight_per_learner": 3, "gamma": 1, "lr": 0.0050505681543, "grad_clip": 0.5, "grad_clip_by": "global_norm", "_train_batch_size_per_learner": 5000, "train_batch_size": 4000, "num_epochs": 2, "minibatch_size": 1000, "shuffle_batch_per_epoch": true, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "log_std_clip_param": 20.0, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "_disable_preprocessor_api": false, "_disable_action_flattening": false}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "_learner_class": null, "callbacks_on_algorithm_init": null, "callbacks_on_env_runners_recreated": null, "callbacks_on_offline_eval_runners_recreated": null, "callbacks_on_checkpoint_loaded": null, "callbacks_on_environment_created": null, "callbacks_on_episode_created": null, "callbacks_on_episode_start": null, "callbacks_on_episode_step": null, "callbacks_on_episode_end": null, "callbacks_on_evaluate_start": null, "callbacks_on_evaluate_end": null, "callbacks_on_evaluate_offline_start": null, "callbacks_on_evaluate_offline_end": null, "callbacks_on_sample_end": null, "callbacks_on_train_result": null, "explore": true, "enable_rl_module_and_learner": true, "enable_env_runner_and_connector_v2": true, "_prior_exploration_config": {"type": "StochasticSampling"}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x77ab39ecaac0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "offline_data_class": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_read_batch_size": null, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "materialize_data": false, "materialize_mapped_data": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "ignore_final_observation": false, "prelearner_class": null, "prelearner_buffer_class": null, "prelearner_buffer_kwargs": {}, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_remaining_data": false, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": 1, "evaluation_duration": 20, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_auto_duration_min_env_steps_per_sample": 100, "evaluation_auto_duration_max_env_steps_per_sample": 2000, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 1, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "offline_evaluation_interval": null, "num_offline_eval_runners": 0, "offline_loss_for_module_fn": null, "offline_evaluation_duration": 1, "offline_evaluation_parallel_to_training": false, "offline_evaluation_timeout_s": 120.0, "num_cpus_per_offline_eval_runner": 1, "num_gpus_per_offline_eval_runner": 0, "custom_resources_per_offline_eval_runner": {}, "restart_failed_offline_eval_runners": true, "ignore_offline_eval_runner_failures": false, "max_num_offline_eval_runner_restarts": 1000, "offline_eval_runner_restore_timeout_s": 1800.0, "max_requests_in_flight_per_offline_eval_runner": 1, "validate_offline_eval_runners_after_construction": true, "offline_eval_runner_health_probe_timeout_s": 30.0, "offline_eval_rl_module_inference_only": false, "broadcast_offline_eval_runner_states": false, "offline_eval_batch_size_per_runner": 256, "dataset_num_iters_per_eval_runner": 1, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "log_gradients": true, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 42, "restart_failed_env_runners": true, "ignore_env_runner_failures": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30.0, "env_runner_restore_timeout_s": 1800.0, "_model_config": {}, "_rl_module_spec": "RLModuleSpec(module_class=None, observation_space=None, action_space=None, inference_only=False, learner_only=False, model_config=DefaultModelConfig(fcnet_hiddens=[44, 121], fcnet_activation='tanh', fcnet_kernel_initializer=None, fcnet_kernel_initializer_kwargs=None, fcnet_bias_initializer=None, fcnet_bias_initializer_kwargs=None, conv_filters=None, conv_activation='relu', conv_kernel_initializer=None, conv_kernel_initializer_kwargs=None, conv_bias_initializer=None, conv_bias_initializer_kwargs=None, head_fcnet_hiddens=[], head_fcnet_activation='relu', head_fcnet_kernel_initializer=None, head_fcnet_kernel_initializer_kwargs=None, head_fcnet_bias_initializer=None, head_fcnet_bias_initializer_kwargs=None, free_log_std=False, log_std_clip_param=20.0, vf_share_layers=True, use_lstm=False, max_seq_len=20, lstm_cell_size=256, lstm_use_prev_action=False, lstm_use_prev_reward=False, lstm_kernel_initializer=None, lstm_kernel_initializer_kwargs=None, lstm_bias_initializer=None, lstm_bias_initializer_kwargs=None), catalog_class=None, load_state_path=None, model_config_dict=None)", "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "_validate_config": true, "_use_msgpack_checkpoints": false, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "env_task_fn": -1, "enable_connectors": -1, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2326331382298, "kl_target": 0.0157623383336, "vf_loss_coeff": 0.5168547272885, "entropy_coeff": 0.0045811242641, "clip_param": 0.1219640961782, "vf_clip_param": 0.2247386827741, "entropy_coeff_schedule": null, "lr_schedule": null, "sgd_minibatch_size": -1, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9065181339776, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.callbacks.callbacks.RLlibCallback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 64.70100545883179, "iterations_since_restore": 13, "perf": {"cpu_util_percent": 12.200000000000001, "ram_util_percent": 70.25714285714285}}
{"timers": {"training_iteration": 4.3531800802065055, "restore_env_runners": 4.1051353032889865e-05, "training_step": 4.3529131021612715, "env_runner_sampling_timer": 3.9297847066100204, "learner_update_timer": 0.4195043806401288, "synch_weights": 0.0015709870238650688, "restore_eval_env_runners": 1.4175620465518146e-05, "evaluation_iteration": 0.7465841306090772, "synch_eval_env_connectors": 0.000525932836037794, "synch_env_connectors": 8.047676388582125e-06}, "env_runners": {"env_to_module_connector": {"timers": {"connectors": {"numpy_to_tensor": 3.1410076690152735e-05, "add_states_from_episodes_to_batch": 3.5078529844640026e-06, "add_observations_from_episodes_to_batch": 6.287851770286293e-06, "add_time_dim_to_batch_and_zero_pad": 6.4997787807506665e-06, "batch_individual_items": 1.8736563275138427e-05}}, "connector_pipeline_timer": 0.00011972057379881006}, "weights_seq_no": 13.0, "num_agent_steps_sampled": {"default_agent": 5000.0}, "num_episodes_lifetime": -58000.0, "module_to_env_connector": {"timers": {"connectors": {"un_batch_to_individual_items": 1.5069325301815346e-05, "normalize_and_clip_actions": 2.2276125614677014e-05, "tensor_to_numpy": 4.946759246088668e-05, "get_actions": 0.0001667364137623544, "listify_data_for_vector_env": 3.0913937291590154e-05, "remove_single_ts_time_rank_from_batch": 1.4921589906893446e-06}}, "connector_pipeline_timer": 0.0003634531893044594}, "episode_return_max": 14.5, "episode_return_mean": 13.5, "env_step_timer": 4.316390456179848e-05, "time_between_sampling": 0.011806657374647091, "episode_len_mean": 50.0, "episode_return_min": -5.5, "num_episodes": 100.0, "rlmodule_inference_timer": 0.00010149697105255323, "sample": 0.03777307212626338, "module_episode_returns_mean": {"default_policy": 13.5}, "agent_episode_returns_mean": {"default_agent": 13.5}, "num_module_steps_sampled": {"default_policy": 5000.0}, "env_to_module_sum_episodes_length_in": 27.16809333212661, "env_reset_timer": 9.279063590322828e-05, "num_env_steps_sampled": 5000.0, "num_agent_steps_sampled_lifetime": {"default_agent": -2900000.0}, "episode_duration_sec_mean": 0.03671535001999473, "num_env_steps_sampled_lifetime": -2900000.0, "episode_len_max": 50, "env_to_module_sum_episodes_length_out": 27.16809333212661, "episode_len_min": 50, "num_module_steps_sampled_lifetime": {"default_policy": -2900000.0}, "num_env_steps_sampled_lifetime_throughput": 1275.2282702197247}, "learners": {"__all_modules__": {"num_trainable_parameters": 5987, "learner_connector_sum_episodes_length_out": 5100.0, "num_module_steps_trained_lifetime": 154000, "learner_connector": {"timers": {"connectors": {"general_advantage_estimation": 0.013819253271159775, "add_time_dim_to_batch_and_zero_pad": 2.4860411968189484e-05, "numpy_to_tensor": 0.00020447889279479625, "add_states_from_episodes_to_batch": 6.719835166157578e-06, "add_one_ts_to_episodes_and_truncate": 0.008604105469045394, "add_columns_from_episodes_to_train_batch": 0.06951835425973232, "batch_individual_items": 0.1956989896987669, "add_observations_from_episodes_to_batch": 0.0007562769457537973}}, "connector_pipeline_timer": 0.2890049172003586}, "num_non_trainable_parameters": 0, "num_env_steps_trained": 56100, "num_module_steps_trained": 11000, "learner_connector_sum_episodes_length_in": 5000.0, "num_env_steps_trained_lifetime": 785400, "num_env_steps_trained_lifetime_throughput": 973910.1258634309, "num_module_steps_trained_throughput": 191425.81184073543, "num_module_steps_trained_lifetime_throughput": 191307.45167947942}, "default_policy": {"module_train_batch_size_mean": 1000.0, "num_trainable_parameters": 5987, "vf_explained_var": -0.47253310680389404, "curr_kl_coeff": 2.839760054484941e-05, "mean_kl_loss": 0.009157456457614899, "num_module_steps_trained": 11000, "vf_loss_unclipped": 21.411529541015625, "diff_num_grad_updates_vs_sampler_policy": 1.0, "total_loss": 0.0491856187582016, "default_optimizer_learning_rate": 0.0050505681543, "weights_seq_no": 14.0, "gradients_default_optimizer_global_norm": 0.11399198323488235, "entropy": 0.5124441385269165, "policy_loss": -0.043192822486162186, "num_module_steps_trained_lifetime": 154000, "curr_entropy_coeff": 0.0045811242641, "vf_loss": 0.18327344954013824, "num_module_steps_trained_lifetime_throughput": 191593.57060632206}}, "num_training_step_calls_per_iteration": 1, "evaluation": {"env_runners": {"rlmodule_inference_timer": 9.547977658526972e-05, "num_episodes": 20, "module_to_env_connector": {"timers": {"connectors": {"tensor_to_numpy": 4.593563023088917e-05, "listify_data_for_vector_env": 3.0189198691538444e-05, "get_actions": 0.000155522029822215, "remove_single_ts_time_rank_from_batch": 1.3731593808360754e-06, "un_batch_to_individual_items": 1.5037729987473882e-05, "normalize_and_clip_actions": 2.1896884423749492e-05}}, "connector_pipeline_timer": 0.0003441106296622887}, "env_reset_timer": 0.00020042898313392589, "num_env_steps_sampled": 1000, "env_to_module_connector": {"timers": {"connectors": {"add_observations_from_episodes_to_batch": 6.388933546566275e-06, "add_time_dim_to_batch_and_zero_pad": 5.421969017114306e-06, "numpy_to_tensor": 2.9273749088925298e-05, "add_states_from_episodes_to_batch": 3.340358330249356e-06, "batch_individual_items": 1.8596222290277032e-05}}, "connector_pipeline_timer": 0.00011429931963938553}, "num_agent_steps_sampled": {"default_agent": 1000}, "episode_len_max": 50, "module_episode_returns_mean": {"default_policy": -0.5}, "env_step_timer": 4.1073890494687935e-05, "agent_episode_returns_mean": {"default_agent": -0.5}, "num_agent_steps_sampled_lifetime": {"default_agent": 14000}, "episode_len_mean": 50.0, "env_to_module_sum_episodes_length_in": 27.168093332126602, "env_to_module_sum_episodes_length_out": 27.168093332126602, "episode_len_min": 50, "num_module_steps_sampled": {"default_policy": 1000}, "episode_return_mean": -0.5, "episode_return_min": -16.5, "sample": 0.7345361276820875, "num_module_steps_sampled_lifetime": {"default_policy": 14000}, "episode_duration_sec_mean": 0.03513581300998339, "num_env_steps_sampled_lifetime": 71000, "weights_seq_no": 14.0, "num_episodes_lifetime": 280, "episode_return_max": 17.5, "time_between_sampling": 4.203224131390421}, "num_healthy_workers": 1, "actor_manager_num_outstanding_async_reqs": 0, "num_remote_worker_restarts": 0}, "num_env_steps_sampled_lifetime": -2900000.0, "fault_tolerance": {"num_healthy_workers": 0, "num_remote_worker_restarts": 0}, "env_runner_group": {"actor_manager_num_outstanding_async_reqs": 0}, "done": false, "training_iteration": 14, "trial_id": "1117f_00000", "date": "2025-08-11_17-56-07", "timestamp": 1754927767, "time_this_iter_s": 5.033463478088379, "time_total_s": 69.73446893692017, "pid": 101658, "hostname": "DESKTOP-3SK5A41", "node_ip": "192.168.40.242", "config": {"exploration_config": {}, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 6, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "env": "Umbrella", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": false, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 0, "create_local_env_runner": true, "num_envs_per_env_runner": 1, "gym_env_vectorize_mode": "SYNC", "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "episodes_to_numpy": true, "max_requests_in_flight_per_env_runner": 1, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "merge_env_runner_states": "training_only", "broadcast_env_runner_states": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "complete_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "sampler_perf_stats_ema_coef": null, "_is_online": true, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": "auto", "num_aggregator_actors_per_learner": 0, "max_requests_in_flight_per_aggregator_actor": 3, "local_gpu_idx": 0, "max_requests_in_flight_per_learner": 3, "gamma": 1, "lr": 0.0050505681543, "grad_clip": 0.5, "grad_clip_by": "global_norm", "_train_batch_size_per_learner": 5000, "train_batch_size": 4000, "num_epochs": 2, "minibatch_size": 1000, "shuffle_batch_per_epoch": true, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "log_std_clip_param": 20.0, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "_disable_preprocessor_api": false, "_disable_action_flattening": false}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "_learner_class": null, "callbacks_on_algorithm_init": null, "callbacks_on_env_runners_recreated": null, "callbacks_on_offline_eval_runners_recreated": null, "callbacks_on_checkpoint_loaded": null, "callbacks_on_environment_created": null, "callbacks_on_episode_created": null, "callbacks_on_episode_start": null, "callbacks_on_episode_step": null, "callbacks_on_episode_end": null, "callbacks_on_evaluate_start": null, "callbacks_on_evaluate_end": null, "callbacks_on_evaluate_offline_start": null, "callbacks_on_evaluate_offline_end": null, "callbacks_on_sample_end": null, "callbacks_on_train_result": null, "explore": true, "enable_rl_module_and_learner": true, "enable_env_runner_and_connector_v2": true, "_prior_exploration_config": {"type": "StochasticSampling"}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x77ab39ecaac0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "offline_data_class": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_read_batch_size": null, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "materialize_data": false, "materialize_mapped_data": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "ignore_final_observation": false, "prelearner_class": null, "prelearner_buffer_class": null, "prelearner_buffer_kwargs": {}, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_remaining_data": false, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": 1, "evaluation_duration": 20, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_auto_duration_min_env_steps_per_sample": 100, "evaluation_auto_duration_max_env_steps_per_sample": 2000, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 1, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "offline_evaluation_interval": null, "num_offline_eval_runners": 0, "offline_loss_for_module_fn": null, "offline_evaluation_duration": 1, "offline_evaluation_parallel_to_training": false, "offline_evaluation_timeout_s": 120.0, "num_cpus_per_offline_eval_runner": 1, "num_gpus_per_offline_eval_runner": 0, "custom_resources_per_offline_eval_runner": {}, "restart_failed_offline_eval_runners": true, "ignore_offline_eval_runner_failures": false, "max_num_offline_eval_runner_restarts": 1000, "offline_eval_runner_restore_timeout_s": 1800.0, "max_requests_in_flight_per_offline_eval_runner": 1, "validate_offline_eval_runners_after_construction": true, "offline_eval_runner_health_probe_timeout_s": 30.0, "offline_eval_rl_module_inference_only": false, "broadcast_offline_eval_runner_states": false, "offline_eval_batch_size_per_runner": 256, "dataset_num_iters_per_eval_runner": 1, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "log_gradients": true, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 42, "restart_failed_env_runners": true, "ignore_env_runner_failures": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30.0, "env_runner_restore_timeout_s": 1800.0, "_model_config": {}, "_rl_module_spec": "RLModuleSpec(module_class=None, observation_space=None, action_space=None, inference_only=False, learner_only=False, model_config=DefaultModelConfig(fcnet_hiddens=[44, 121], fcnet_activation='tanh', fcnet_kernel_initializer=None, fcnet_kernel_initializer_kwargs=None, fcnet_bias_initializer=None, fcnet_bias_initializer_kwargs=None, conv_filters=None, conv_activation='relu', conv_kernel_initializer=None, conv_kernel_initializer_kwargs=None, conv_bias_initializer=None, conv_bias_initializer_kwargs=None, head_fcnet_hiddens=[], head_fcnet_activation='relu', head_fcnet_kernel_initializer=None, head_fcnet_kernel_initializer_kwargs=None, head_fcnet_bias_initializer=None, head_fcnet_bias_initializer_kwargs=None, free_log_std=False, log_std_clip_param=20.0, vf_share_layers=True, use_lstm=False, max_seq_len=20, lstm_cell_size=256, lstm_use_prev_action=False, lstm_use_prev_reward=False, lstm_kernel_initializer=None, lstm_kernel_initializer_kwargs=None, lstm_bias_initializer=None, lstm_bias_initializer_kwargs=None), catalog_class=None, load_state_path=None, model_config_dict=None)", "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "_validate_config": true, "_use_msgpack_checkpoints": false, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "env_task_fn": -1, "enable_connectors": -1, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2326331382298, "kl_target": 0.0157623383336, "vf_loss_coeff": 0.5168547272885, "entropy_coeff": 0.0045811242641, "clip_param": 0.1219640961782, "vf_clip_param": 0.2247386827741, "entropy_coeff_schedule": null, "lr_schedule": null, "sgd_minibatch_size": -1, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9065181339776, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.callbacks.callbacks.RLlibCallback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 69.73446893692017, "iterations_since_restore": 14, "perf": {"cpu_util_percent": 12.485714285714284, "ram_util_percent": 70.28571428571429}}
{"timers": {"training_iteration": 4.351054144444436, "restore_env_runners": 4.0756839503632335e-05, "training_step": 4.350785957179659, "env_runner_sampling_timer": 3.9297185375739208, "learner_update_timer": 0.4174411088437253, "synch_weights": 0.0015685391536195375, "restore_eval_env_runners": 1.4129864255163618e-05, "evaluation_iteration": 0.7465695713129927, "synch_eval_env_connectors": 0.0005244515076776546, "synch_env_connectors": 8.028199625338102e-06}, "env_runners": {"env_to_module_connector": {"timers": {"connectors": {"numpy_to_tensor": 3.1354729953817035e-05, "add_states_from_episodes_to_batch": 3.502326891287415e-06, "add_observations_from_episodes_to_batch": 6.228906554039326e-06, "add_time_dim_to_batch_and_zero_pad": 6.540805951090091e-06, "batch_individual_items": 1.881990846483196e-05}}, "connector_pipeline_timer": 0.00011954641489656133}, "weights_seq_no": 14.0, "num_agent_steps_sampled": {"default_agent": 5000.0}, "num_episodes_lifetime": -62850.0, "module_to_env_connector": {"timers": {"connectors": {"un_batch_to_individual_items": 1.5161629148884238e-05, "normalize_and_clip_actions": 2.226181201274806e-05, "tensor_to_numpy": 4.962413452112915e-05, "get_actions": 0.00016691181035005816, "listify_data_for_vector_env": 3.09797843629739e-05, "remove_single_ts_time_rank_from_batch": 1.495625157973823e-06}}, "connector_pipeline_timer": 0.0003639221043514215}, "episode_return_max": 14.5, "episode_return_mean": 14.099999999999993, "env_step_timer": 4.313963383073267e-05, "time_between_sampling": 0.012544001844632353, "episode_len_mean": 50.0, "episode_return_min": -5.5, "num_episodes": 100.0, "rlmodule_inference_timer": 0.00010097652132432974, "sample": 0.03776085203665451, "module_episode_returns_mean": {"default_policy": 14.099999999999993}, "agent_episode_returns_mean": {"default_agent": 14.099999999999993}, "num_module_steps_sampled": {"default_policy": 5000.0}, "env_to_module_sum_episodes_length_in": 27.16809333212661, "env_reset_timer": 9.2226457775465e-05, "num_env_steps_sampled": 5000.0, "num_agent_steps_sampled_lifetime": {"default_agent": -3142500.0}, "episode_duration_sec_mean": 0.0367073100300786, "num_env_steps_sampled_lifetime": -3142500.0, "episode_len_max": 50, "env_to_module_sum_episodes_length_out": 27.16809333212661, "episode_len_min": 50, "num_module_steps_sampled_lifetime": {"default_policy": -3142500.0}, "num_env_steps_sampled_lifetime_throughput": 1274.9878259057682}, "learners": {"__all_modules__": {"num_trainable_parameters": 5987, "learner_connector_sum_episodes_length_out": 5100.0, "num_module_steps_trained_lifetime": 165000, "learner_connector": {"timers": {"connectors": {"general_advantage_estimation": 0.013798923738453123, "add_time_dim_to_batch_and_zero_pad": 2.4821807846840524e-05, "numpy_to_tensor": 0.0002040561038666185, "add_states_from_episodes_to_batch": 6.7136368151378e-06, "add_one_ts_to_episodes_and_truncate": 0.008599049414349993, "add_columns_from_episodes_to_train_batch": 0.06950781272713596, "batch_individual_items": 0.1943119608017803, "add_observations_from_episodes_to_batch": 0.0007562831762956804}}, "connector_pipeline_timer": 0.28758082903835386}, "num_non_trainable_parameters": 0, "num_env_steps_trained": 56100, "num_module_steps_trained": 11000, "learner_connector_sum_episodes_length_in": 5000.0, "num_env_steps_trained_lifetime": 841500, "num_env_steps_trained_lifetime_throughput": 967831.2513159607, "num_module_steps_trained_throughput": 190215.27907072855, "num_module_steps_trained_lifetime_throughput": 190100.84166321254}, "default_policy": {"module_train_batch_size_mean": 1000.0, "num_trainable_parameters": 5987, "vf_explained_var": -1.0, "curr_kl_coeff": 1.4198800272424705e-05, "mean_kl_loss": 0.0009918567957356572, "num_module_steps_trained": 11000, "vf_loss_unclipped": 21.883708953857422, "diff_num_grad_updates_vs_sampler_policy": 1.0, "total_loss": 0.07055630534887314, "default_optimizer_learning_rate": 0.0050505681543, "weights_seq_no": 15.0, "gradients_default_optimizer_global_norm": 0.0647158995270729, "entropy": 0.5229709148406982, "policy_loss": -0.021000048145651817, "num_module_steps_trained_lifetime": 165000, "curr_entropy_coeff": 0.0045811242641, "vf_loss": 0.18177664279937744, "num_module_steps_trained_lifetime_throughput": 190368.76374402578}}, "num_training_step_calls_per_iteration": 1, "evaluation": {"env_runners": {"rlmodule_inference_timer": 9.5186484889901e-05, "num_episodes": 20, "module_to_env_connector": {"timers": {"connectors": {"tensor_to_numpy": 4.543505874110343e-05, "listify_data_for_vector_env": 2.96502388685019e-05, "get_actions": 0.00015442411251070625, "remove_single_ts_time_rank_from_batch": 1.3320169667800786e-06, "un_batch_to_individual_items": 1.5310578455551177e-05, "normalize_and_clip_actions": 2.1694148040218375e-05}}, "connector_pipeline_timer": 0.0003411291845317036}, "env_reset_timer": 0.00019988669330276077, "num_env_steps_sampled": 1000, "env_to_module_connector": {"timers": {"connectors": {"add_observations_from_episodes_to_batch": 6.690417805914067e-06, "add_time_dim_to_batch_and_zero_pad": 5.288139271806185e-06, "numpy_to_tensor": 2.9175747228631524e-05, "add_states_from_episodes_to_batch": 3.3715009974799216e-06, "batch_individual_items": 1.8274709475134842e-05}}, "connector_pipeline_timer": 0.0001134645899247025}, "num_agent_steps_sampled": {"default_agent": 1000}, "episode_len_max": 50, "module_episode_returns_mean": {"default_policy": -0.9}, "env_step_timer": 4.196801555281884e-05, "agent_episode_returns_mean": {"default_agent": -0.9}, "num_agent_steps_sampled_lifetime": {"default_agent": 15000}, "episode_len_mean": 50.0, "env_to_module_sum_episodes_length_in": 27.168093332126602, "env_to_module_sum_episodes_length_out": 27.168093332126602, "episode_len_min": 50, "num_module_steps_sampled": {"default_policy": 1000}, "episode_return_mean": -0.9, "episode_return_min": -16.5, "sample": 0.7344753214252631, "num_module_steps_sampled_lifetime": {"default_policy": 15000}, "episode_duration_sec_mean": 0.03511537202997715, "num_env_steps_sampled_lifetime": 76000, "weights_seq_no": 15.0, "num_episodes_lifetime": 300, "episode_return_max": 17.5, "time_between_sampling": 4.203134610116514}, "num_healthy_workers": 1, "actor_manager_num_outstanding_async_reqs": 0, "num_remote_worker_restarts": 0}, "num_env_steps_sampled_lifetime": -3142500.0, "fault_tolerance": {"num_healthy_workers": 0, "num_remote_worker_restarts": 0}, "env_runner_group": {"actor_manager_num_outstanding_async_reqs": 0}, "done": false, "training_iteration": 15, "trial_id": "1117f_00000", "date": "2025-08-11_17-56-12", "timestamp": 1754927772, "time_this_iter_s": 4.883451461791992, "time_total_s": 74.61792039871216, "pid": 101658, "hostname": "DESKTOP-3SK5A41", "node_ip": "192.168.40.242", "config": {"exploration_config": {}, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 6, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "env": "Umbrella", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": false, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 0, "create_local_env_runner": true, "num_envs_per_env_runner": 1, "gym_env_vectorize_mode": "SYNC", "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "episodes_to_numpy": true, "max_requests_in_flight_per_env_runner": 1, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "merge_env_runner_states": "training_only", "broadcast_env_runner_states": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "complete_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "sampler_perf_stats_ema_coef": null, "_is_online": true, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": "auto", "num_aggregator_actors_per_learner": 0, "max_requests_in_flight_per_aggregator_actor": 3, "local_gpu_idx": 0, "max_requests_in_flight_per_learner": 3, "gamma": 1, "lr": 0.0050505681543, "grad_clip": 0.5, "grad_clip_by": "global_norm", "_train_batch_size_per_learner": 5000, "train_batch_size": 4000, "num_epochs": 2, "minibatch_size": 1000, "shuffle_batch_per_epoch": true, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "log_std_clip_param": 20.0, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "_disable_preprocessor_api": false, "_disable_action_flattening": false}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "_learner_class": null, "callbacks_on_algorithm_init": null, "callbacks_on_env_runners_recreated": null, "callbacks_on_offline_eval_runners_recreated": null, "callbacks_on_checkpoint_loaded": null, "callbacks_on_environment_created": null, "callbacks_on_episode_created": null, "callbacks_on_episode_start": null, "callbacks_on_episode_step": null, "callbacks_on_episode_end": null, "callbacks_on_evaluate_start": null, "callbacks_on_evaluate_end": null, "callbacks_on_evaluate_offline_start": null, "callbacks_on_evaluate_offline_end": null, "callbacks_on_sample_end": null, "callbacks_on_train_result": null, "explore": true, "enable_rl_module_and_learner": true, "enable_env_runner_and_connector_v2": true, "_prior_exploration_config": {"type": "StochasticSampling"}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x77ab39ecaac0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "offline_data_class": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_read_batch_size": null, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "materialize_data": false, "materialize_mapped_data": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "ignore_final_observation": false, "prelearner_class": null, "prelearner_buffer_class": null, "prelearner_buffer_kwargs": {}, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_remaining_data": false, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": 1, "evaluation_duration": 20, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_auto_duration_min_env_steps_per_sample": 100, "evaluation_auto_duration_max_env_steps_per_sample": 2000, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 1, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "offline_evaluation_interval": null, "num_offline_eval_runners": 0, "offline_loss_for_module_fn": null, "offline_evaluation_duration": 1, "offline_evaluation_parallel_to_training": false, "offline_evaluation_timeout_s": 120.0, "num_cpus_per_offline_eval_runner": 1, "num_gpus_per_offline_eval_runner": 0, "custom_resources_per_offline_eval_runner": {}, "restart_failed_offline_eval_runners": true, "ignore_offline_eval_runner_failures": false, "max_num_offline_eval_runner_restarts": 1000, "offline_eval_runner_restore_timeout_s": 1800.0, "max_requests_in_flight_per_offline_eval_runner": 1, "validate_offline_eval_runners_after_construction": true, "offline_eval_runner_health_probe_timeout_s": 30.0, "offline_eval_rl_module_inference_only": false, "broadcast_offline_eval_runner_states": false, "offline_eval_batch_size_per_runner": 256, "dataset_num_iters_per_eval_runner": 1, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "log_gradients": true, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 42, "restart_failed_env_runners": true, "ignore_env_runner_failures": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30.0, "env_runner_restore_timeout_s": 1800.0, "_model_config": {}, "_rl_module_spec": "RLModuleSpec(module_class=None, observation_space=None, action_space=None, inference_only=False, learner_only=False, model_config=DefaultModelConfig(fcnet_hiddens=[44, 121], fcnet_activation='tanh', fcnet_kernel_initializer=None, fcnet_kernel_initializer_kwargs=None, fcnet_bias_initializer=None, fcnet_bias_initializer_kwargs=None, conv_filters=None, conv_activation='relu', conv_kernel_initializer=None, conv_kernel_initializer_kwargs=None, conv_bias_initializer=None, conv_bias_initializer_kwargs=None, head_fcnet_hiddens=[], head_fcnet_activation='relu', head_fcnet_kernel_initializer=None, head_fcnet_kernel_initializer_kwargs=None, head_fcnet_bias_initializer=None, head_fcnet_bias_initializer_kwargs=None, free_log_std=False, log_std_clip_param=20.0, vf_share_layers=True, use_lstm=False, max_seq_len=20, lstm_cell_size=256, lstm_use_prev_action=False, lstm_use_prev_reward=False, lstm_kernel_initializer=None, lstm_kernel_initializer_kwargs=None, lstm_bias_initializer=None, lstm_bias_initializer_kwargs=None), catalog_class=None, load_state_path=None, model_config_dict=None)", "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "_validate_config": true, "_use_msgpack_checkpoints": false, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "env_task_fn": -1, "enable_connectors": -1, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2326331382298, "kl_target": 0.0157623383336, "vf_loss_coeff": 0.5168547272885, "entropy_coeff": 0.0045811242641, "clip_param": 0.1219640961782, "vf_clip_param": 0.2247386827741, "entropy_coeff_schedule": null, "lr_schedule": null, "sgd_minibatch_size": -1, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9065181339776, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.callbacks.callbacks.RLlibCallback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 74.61792039871216, "iterations_since_restore": 15, "perf": {"cpu_util_percent": 11.557142857142859, "ram_util_percent": 70.21428571428571}}
{"timers": {"training_iteration": 4.350640520199993, "restore_env_runners": 4.045927110945516e-05, "training_step": 4.350371703807863, "env_runner_sampling_timer": 3.9313901243881806, "learner_update_timer": 0.4153550117652858, "synch_weights": 0.0015676037620836185, "restore_eval_env_runners": 1.4098565613471127e-05, "evaluation_iteration": 0.7464856666198606, "synch_eval_env_connectors": 0.0005233619925977773, "synch_env_connectors": 8.012917623804704e-06}, "env_runners": {"env_to_module_connector": {"timers": {"connectors": {"numpy_to_tensor": 3.1448144463353214e-05, "add_states_from_episodes_to_batch": 3.5447543712864586e-06, "add_observations_from_episodes_to_batch": 6.347283513997124e-06, "add_time_dim_to_batch_and_zero_pad": 6.579387627888355e-06, "batch_individual_items": 1.902846441267964e-05}}, "connector_pipeline_timer": 0.00012056830963690573}, "weights_seq_no": 15.0, "num_agent_steps_sampled": {"default_agent": 5000.0}, "num_episodes_lifetime": -67700.0, "module_to_env_connector": {"timers": {"connectors": {"un_batch_to_individual_items": 1.5169909466449494e-05, "normalize_and_clip_actions": 2.2495489106928065e-05, "tensor_to_numpy": 4.967559508316461e-05, "get_actions": 0.00016820209207275865, "listify_data_for_vector_env": 3.1122621381856056e-05, "remove_single_ts_time_rank_from_batch": 1.5428494708122552e-06}}, "connector_pipeline_timer": 0.0003664893536540905}, "episode_return_max": 14.5, "episode_return_mean": 14.3, "env_step_timer": 4.3646889674786867e-05, "time_between_sampling": 0.011867462930345738, "episode_len_mean": 50.0, "episode_return_min": -5.5, "num_episodes": 100.0, "rlmodule_inference_timer": 0.00013359401944302226, "sample": 0.03812167123693462, "module_episode_returns_mean": {"default_policy": 14.3}, "agent_episode_returns_mean": {"default_agent": 14.3}, "num_module_steps_sampled": {"default_policy": 5000.0}, "env_to_module_sum_episodes_length_in": 27.16809333212661, "env_reset_timer": 9.238854291844375e-05, "num_env_steps_sampled": 5000.0, "num_agent_steps_sampled_lifetime": {"default_agent": -3385000.0}, "episode_duration_sec_mean": 0.03844786518000548, "num_env_steps_sampled_lifetime": -3385000.0, "episode_len_max": 50, "env_to_module_sum_episodes_length_out": 27.16809333212661, "episode_len_min": 50, "num_module_steps_sampled_lifetime": {"default_policy": -3385000.0}, "num_env_steps_sampled_lifetime_throughput": 1260.849504789916}, "learners": {"__all_modules__": {"num_trainable_parameters": 5987, "learner_connector_sum_episodes_length_out": 5100.0, "num_module_steps_trained_lifetime": 176000, "learner_connector": {"timers": {"connectors": {"general_advantage_estimation": 0.013747814501067518, "add_time_dim_to_batch_and_zero_pad": 2.4784589774319546e-05, "numpy_to_tensor": 0.00020368354282328626, "add_states_from_episodes_to_batch": 6.704500452069581e-06, "add_one_ts_to_episodes_and_truncate": 0.008597804920208762, "add_columns_from_episodes_to_train_batch": 0.06948859859985987, "batch_individual_items": 0.19294371619376455, "add_observations_from_episodes_to_batch": 0.0007558633445261715}}, "connector_pipeline_timer": 0.28613953474797266}, "num_non_trainable_parameters": 0, "num_env_steps_trained": 56100, "num_module_steps_trained": 11000, "learner_connector_sum_episodes_length_in": 5000.0, "num_env_steps_trained_lifetime": 897600, "num_env_steps_trained_lifetime_throughput": 961422.9487038334, "num_module_steps_trained_throughput": 188941.11476498417, "num_module_steps_trained_lifetime_throughput": 188830.0024215061}, "default_policy": {"module_train_batch_size_mean": 1000.0, "num_trainable_parameters": 5987, "vf_explained_var": -1.0, "curr_kl_coeff": 7.099400136212353e-06, "mean_kl_loss": 0.002276585903018713, "num_module_steps_trained": 11000, "vf_loss_unclipped": 23.994359970092773, "diff_num_grad_updates_vs_sampler_policy": 1.0, "total_loss": 0.08646315336227417, "default_optimizer_learning_rate": 0.0050505681543, "weights_seq_no": 16.0, "gradients_default_optimizer_global_norm": 0.1933644711971283, "entropy": 0.5174582004547119, "policy_loss": -0.006135464645922184, "num_module_steps_trained_lifetime": 176000, "curr_entropy_coeff": 0.0045811242641, "vf_loss": 0.18374432623386383, "num_module_steps_trained_lifetime_throughput": 189081.48052386486}}, "num_training_step_calls_per_iteration": 1, "evaluation": {"env_runners": {"rlmodule_inference_timer": 9.970883635810627e-05, "num_episodes": 20, "module_to_env_connector": {"timers": {"connectors": {"tensor_to_numpy": 4.737122899244076e-05, "listify_data_for_vector_env": 3.0856371468370804e-05, "get_actions": 0.000165589229076055, "remove_single_ts_time_rank_from_batch": 1.4377582490782473e-06, "un_batch_to_individual_items": 1.5169688923719463e-05, "normalize_and_clip_actions": 2.3718674849133565e-05}}, "connector_pipeline_timer": 0.0003607843420068067}, "env_reset_timer": 0.0001991128263660719, "num_env_steps_sampled": 1000, "env_to_module_connector": {"timers": {"connectors": {"add_observations_from_episodes_to_batch": 6.37574774140589e-06, "add_time_dim_to_batch_and_zero_pad": 6.615817120702012e-06, "numpy_to_tensor": 3.0973862553524316e-05, "add_states_from_episodes_to_batch": 3.3579953454820297e-06, "batch_individual_items": 1.876654743360293e-05}}, "connector_pipeline_timer": 0.00011803695684393347}, "num_agent_steps_sampled": {"default_agent": 1000}, "episode_len_max": 50, "module_episode_returns_mean": {"default_policy": -0.7}, "env_step_timer": 4.362257082997566e-05, "agent_episode_returns_mean": {"default_agent": -0.7}, "num_agent_steps_sampled_lifetime": {"default_agent": 16000}, "episode_len_mean": 50.0, "env_to_module_sum_episodes_length_in": 27.168093332126602, "env_to_module_sum_episodes_length_out": 27.168093332126602, "episode_len_min": 50, "num_module_steps_sampled": {"default_policy": 1000}, "episode_return_mean": -0.7, "episode_return_min": -16.5, "sample": 0.7348767692410145, "num_module_steps_sampled_lifetime": {"default_policy": 16000}, "episode_duration_sec_mean": 0.035522171049969985, "num_env_steps_sampled_lifetime": 81000, "weights_seq_no": 16.0, "num_episodes_lifetime": 320, "episode_return_max": 17.5, "time_between_sampling": 4.204750516215348}, "num_healthy_workers": 1, "actor_manager_num_outstanding_async_reqs": 0, "num_remote_worker_restarts": 0}, "num_env_steps_sampled_lifetime": -3385000.0, "fault_tolerance": {"num_healthy_workers": 0, "num_remote_worker_restarts": 0}, "env_runner_group": {"actor_manager_num_outstanding_async_reqs": 0}, "done": false, "training_iteration": 16, "trial_id": "1117f_00000", "date": "2025-08-11_17-56-17", "timestamp": 1754927777, "time_this_iter_s": 5.098648309707642, "time_total_s": 79.7165687084198, "pid": 101658, "hostname": "DESKTOP-3SK5A41", "node_ip": "192.168.40.242", "config": {"exploration_config": {}, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 6, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "env": "Umbrella", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": false, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 0, "create_local_env_runner": true, "num_envs_per_env_runner": 1, "gym_env_vectorize_mode": "SYNC", "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "episodes_to_numpy": true, "max_requests_in_flight_per_env_runner": 1, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "merge_env_runner_states": "training_only", "broadcast_env_runner_states": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "complete_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "sampler_perf_stats_ema_coef": null, "_is_online": true, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": "auto", "num_aggregator_actors_per_learner": 0, "max_requests_in_flight_per_aggregator_actor": 3, "local_gpu_idx": 0, "max_requests_in_flight_per_learner": 3, "gamma": 1, "lr": 0.0050505681543, "grad_clip": 0.5, "grad_clip_by": "global_norm", "_train_batch_size_per_learner": 5000, "train_batch_size": 4000, "num_epochs": 2, "minibatch_size": 1000, "shuffle_batch_per_epoch": true, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "log_std_clip_param": 20.0, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "_disable_preprocessor_api": false, "_disable_action_flattening": false}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "_learner_class": null, "callbacks_on_algorithm_init": null, "callbacks_on_env_runners_recreated": null, "callbacks_on_offline_eval_runners_recreated": null, "callbacks_on_checkpoint_loaded": null, "callbacks_on_environment_created": null, "callbacks_on_episode_created": null, "callbacks_on_episode_start": null, "callbacks_on_episode_step": null, "callbacks_on_episode_end": null, "callbacks_on_evaluate_start": null, "callbacks_on_evaluate_end": null, "callbacks_on_evaluate_offline_start": null, "callbacks_on_evaluate_offline_end": null, "callbacks_on_sample_end": null, "callbacks_on_train_result": null, "explore": true, "enable_rl_module_and_learner": true, "enable_env_runner_and_connector_v2": true, "_prior_exploration_config": {"type": "StochasticSampling"}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x77ab39ecaac0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "offline_data_class": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_read_batch_size": null, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "materialize_data": false, "materialize_mapped_data": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "ignore_final_observation": false, "prelearner_class": null, "prelearner_buffer_class": null, "prelearner_buffer_kwargs": {}, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_remaining_data": false, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": 1, "evaluation_duration": 20, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_auto_duration_min_env_steps_per_sample": 100, "evaluation_auto_duration_max_env_steps_per_sample": 2000, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 1, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "offline_evaluation_interval": null, "num_offline_eval_runners": 0, "offline_loss_for_module_fn": null, "offline_evaluation_duration": 1, "offline_evaluation_parallel_to_training": false, "offline_evaluation_timeout_s": 120.0, "num_cpus_per_offline_eval_runner": 1, "num_gpus_per_offline_eval_runner": 0, "custom_resources_per_offline_eval_runner": {}, "restart_failed_offline_eval_runners": true, "ignore_offline_eval_runner_failures": false, "max_num_offline_eval_runner_restarts": 1000, "offline_eval_runner_restore_timeout_s": 1800.0, "max_requests_in_flight_per_offline_eval_runner": 1, "validate_offline_eval_runners_after_construction": true, "offline_eval_runner_health_probe_timeout_s": 30.0, "offline_eval_rl_module_inference_only": false, "broadcast_offline_eval_runner_states": false, "offline_eval_batch_size_per_runner": 256, "dataset_num_iters_per_eval_runner": 1, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "log_gradients": true, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 42, "restart_failed_env_runners": true, "ignore_env_runner_failures": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30.0, "env_runner_restore_timeout_s": 1800.0, "_model_config": {}, "_rl_module_spec": "RLModuleSpec(module_class=None, observation_space=None, action_space=None, inference_only=False, learner_only=False, model_config=DefaultModelConfig(fcnet_hiddens=[44, 121], fcnet_activation='tanh', fcnet_kernel_initializer=None, fcnet_kernel_initializer_kwargs=None, fcnet_bias_initializer=None, fcnet_bias_initializer_kwargs=None, conv_filters=None, conv_activation='relu', conv_kernel_initializer=None, conv_kernel_initializer_kwargs=None, conv_bias_initializer=None, conv_bias_initializer_kwargs=None, head_fcnet_hiddens=[], head_fcnet_activation='relu', head_fcnet_kernel_initializer=None, head_fcnet_kernel_initializer_kwargs=None, head_fcnet_bias_initializer=None, head_fcnet_bias_initializer_kwargs=None, free_log_std=False, log_std_clip_param=20.0, vf_share_layers=True, use_lstm=False, max_seq_len=20, lstm_cell_size=256, lstm_use_prev_action=False, lstm_use_prev_reward=False, lstm_kernel_initializer=None, lstm_kernel_initializer_kwargs=None, lstm_bias_initializer=None, lstm_bias_initializer_kwargs=None), catalog_class=None, load_state_path=None, model_config_dict=None)", "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "_validate_config": true, "_use_msgpack_checkpoints": false, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "env_task_fn": -1, "enable_connectors": -1, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2326331382298, "kl_target": 0.0157623383336, "vf_loss_coeff": 0.5168547272885, "entropy_coeff": 0.0045811242641, "clip_param": 0.1219640961782, "vf_clip_param": 0.2247386827741, "entropy_coeff_schedule": null, "lr_schedule": null, "sgd_minibatch_size": -1, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9065181339776, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.callbacks.callbacks.RLlibCallback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 79.7165687084198, "iterations_since_restore": 16, "perf": {"cpu_util_percent": 12.25, "ram_util_percent": 70.3}}
{"timers": {"training_iteration": 4.350566807127993, "restore_env_runners": 4.0165678397739296e-05, "training_step": 4.350297094899787, "env_runner_sampling_timer": 3.931924654264298, "learner_update_timer": 0.414745560657638, "synch_weights": 0.0015656097244616625, "restore_eval_env_runners": 1.4062579956502883e-05, "evaluation_iteration": 0.7468639349836566, "synch_eval_env_connectors": 0.0005224503726670266, "synch_env_connectors": 7.995788445247547e-06}, "env_runners": {"env_to_module_connector": {"timers": {"connectors": {"numpy_to_tensor": 3.175242066787494e-05, "add_states_from_episodes_to_batch": 3.5912307906437786e-06, "add_observations_from_episodes_to_batch": 6.326783544310297e-06, "add_time_dim_to_batch_and_zero_pad": 6.570049599909015e-06, "batch_individual_items": 1.903788227012232e-05}}, "connector_pipeline_timer": 0.00012157720258896801}, "weights_seq_no": 16.0, "num_agent_steps_sampled": {"default_agent": 5000.0}, "num_episodes_lifetime": -72550.0, "module_to_env_connector": {"timers": {"connectors": {"un_batch_to_individual_items": 1.5274886534990096e-05, "normalize_and_clip_actions": 2.2607010512742768e-05, "tensor_to_numpy": 5.000004859462657e-05, "get_actions": 0.00016942835535098202, "listify_data_for_vector_env": 3.1332280662506776e-05, "remove_single_ts_time_rank_from_batch": 1.5076559150138533e-06}}, "connector_pipeline_timer": 0.00036911671394925844}, "episode_return_max": 14.5, "episode_return_mean": 14.3, "env_step_timer": 4.387151762476174e-05, "time_between_sampling": 0.011902705759710723, "episode_len_mean": 50.0, "episode_return_min": -5.5, "num_episodes": 100.0, "rlmodule_inference_timer": 0.00010241206880717504, "sample": 0.038869267412810375, "module_episode_returns_mean": {"default_policy": 14.3}, "agent_episode_returns_mean": {"default_agent": 14.3}, "num_module_steps_sampled": {"default_policy": 5000.0}, "env_to_module_sum_episodes_length_in": 27.16809333212661, "env_reset_timer": 9.3985230874338e-05, "num_env_steps_sampled": 5000.0, "num_agent_steps_sampled_lifetime": {"default_agent": -3627500.0}, "episode_duration_sec_mean": 0.037256384109969065, "num_env_steps_sampled_lifetime": -3627500.0, "episode_len_max": 50, "env_to_module_sum_episodes_length_out": 27.16809333212661, "episode_len_min": 50, "num_module_steps_sampled_lifetime": {"default_policy": -3627500.0}, "num_env_steps_sampled_lifetime_throughput": 1252.430379407836}, "learners": {"__all_modules__": {"num_trainable_parameters": 5987, "learner_connector_sum_episodes_length_out": 5100.0, "num_module_steps_trained_lifetime": 187000, "learner_connector": {"timers": {"connectors": {"general_advantage_estimation": 0.013695761356054327, "add_time_dim_to_batch_and_zero_pad": 2.4762743878506866e-05, "numpy_to_tensor": 0.00020333770739271672, "add_states_from_episodes_to_batch": 6.697455449671136e-06, "add_one_ts_to_episodes_and_truncate": 0.008591698871003287, "add_columns_from_episodes_to_train_batch": 0.06947358861386506, "batch_individual_items": 0.19304332204182453, "add_observations_from_episodes_to_batch": 0.0007551927110789808}}, "connector_pipeline_timer": 0.2861642744104871}, "num_non_trainable_parameters": 0, "num_env_steps_trained": 56100, "num_module_steps_trained": 11000, "learner_connector_sum_episodes_length_in": 5000.0, "num_env_steps_trained_lifetime": 953700, "num_env_steps_trained_lifetime_throughput": 955219.5639110348, "num_module_steps_trained_throughput": 187708.24590545378, "num_module_steps_trained_lifetime_throughput": 187599.71145998692}, "default_policy": {"module_train_batch_size_mean": 1000.0, "num_trainable_parameters": 5987, "vf_explained_var": -1.0, "curr_kl_coeff": 3.5497000681061763e-06, "mean_kl_loss": 0.0021003340370953083, "num_module_steps_trained": 11000, "vf_loss_unclipped": 23.22175407409668, "diff_num_grad_updates_vs_sampler_policy": 1.0, "total_loss": 0.0977381095290184, "default_optimizer_learning_rate": 0.0050505681543, "weights_seq_no": 17.0, "gradients_default_optimizer_global_norm": 0.24523569643497467, "entropy": 0.5572579503059387, "policy_loss": 0.007137141190469265, "num_module_steps_trained_lifetime": 187000, "curr_entropy_coeff": 0.0045811242641, "vf_loss": 0.18023212254047394, "num_module_steps_trained_lifetime_throughput": 187835.4747092965}}, "num_training_step_calls_per_iteration": 1, "evaluation": {"env_runners": {"rlmodule_inference_timer": 9.439078776986247e-05, "num_episodes": 20, "module_to_env_connector": {"timers": {"connectors": {"tensor_to_numpy": 4.5244045142189394e-05, "listify_data_for_vector_env": 2.9986347970084964e-05, "get_actions": 0.00015631436196180152, "remove_single_ts_time_rank_from_batch": 1.3604503036206771e-06, "un_batch_to_individual_items": 1.5585999526658127e-05, "normalize_and_clip_actions": 2.138835570171228e-05}}, "connector_pipeline_timer": 0.00034275896238349394}, "env_reset_timer": 0.00019929069810182353, "num_env_steps_sampled": 1000, "env_to_module_connector": {"timers": {"connectors": {"add_observations_from_episodes_to_batch": 6.152816638233806e-06, "add_time_dim_to_batch_and_zero_pad": 5.481490449624118e-06, "numpy_to_tensor": 2.9111777084231696e-05, "add_states_from_episodes_to_batch": 3.3246685553026445e-06, "batch_individual_items": 1.8150560321088868e-05}}, "connector_pipeline_timer": 0.00011363971245747862}, "num_agent_steps_sampled": {"default_agent": 1000}, "episode_len_max": 50, "module_episode_returns_mean": {"default_policy": -0.9}, "env_step_timer": 4.1898366782147654e-05, "agent_episode_returns_mean": {"default_agent": -0.9}, "num_agent_steps_sampled_lifetime": {"default_agent": 17000}, "episode_len_mean": 50.0, "env_to_module_sum_episodes_length_in": 27.168093332126602, "env_to_module_sum_episodes_length_out": 27.168093332126602, "episode_len_min": 50, "num_module_steps_sampled": {"default_policy": 1000}, "episode_return_mean": -0.9, "episode_return_min": -16.5, "sample": 0.7348849185486108, "num_module_steps_sampled_lifetime": {"default_policy": 17000}, "episode_duration_sec_mean": 0.03560891004995938, "num_env_steps_sampled_lifetime": 86000, "weights_seq_no": 17.0, "num_episodes_lifetime": 340, "episode_return_max": 17.5, "time_between_sampling": 4.20668705619319}, "num_healthy_workers": 1, "actor_manager_num_outstanding_async_reqs": 0, "num_remote_worker_restarts": 0}, "num_env_steps_sampled_lifetime": -3627500.0, "fault_tolerance": {"num_healthy_workers": 0, "num_remote_worker_restarts": 0}, "env_runner_group": {"actor_manager_num_outstanding_async_reqs": 0}, "done": false, "training_iteration": 17, "trial_id": "1117f_00000", "date": "2025-08-11_17-56-22", "timestamp": 1754927782, "time_this_iter_s": 5.093656063079834, "time_total_s": 84.81022477149963, "pid": 101658, "hostname": "DESKTOP-3SK5A41", "node_ip": "192.168.40.242", "config": {"exploration_config": {}, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 6, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "env": "Umbrella", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": false, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 0, "create_local_env_runner": true, "num_envs_per_env_runner": 1, "gym_env_vectorize_mode": "SYNC", "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "episodes_to_numpy": true, "max_requests_in_flight_per_env_runner": 1, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "merge_env_runner_states": "training_only", "broadcast_env_runner_states": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "complete_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "sampler_perf_stats_ema_coef": null, "_is_online": true, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": "auto", "num_aggregator_actors_per_learner": 0, "max_requests_in_flight_per_aggregator_actor": 3, "local_gpu_idx": 0, "max_requests_in_flight_per_learner": 3, "gamma": 1, "lr": 0.0050505681543, "grad_clip": 0.5, "grad_clip_by": "global_norm", "_train_batch_size_per_learner": 5000, "train_batch_size": 4000, "num_epochs": 2, "minibatch_size": 1000, "shuffle_batch_per_epoch": true, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "log_std_clip_param": 20.0, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "_disable_preprocessor_api": false, "_disable_action_flattening": false}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "_learner_class": null, "callbacks_on_algorithm_init": null, "callbacks_on_env_runners_recreated": null, "callbacks_on_offline_eval_runners_recreated": null, "callbacks_on_checkpoint_loaded": null, "callbacks_on_environment_created": null, "callbacks_on_episode_created": null, "callbacks_on_episode_start": null, "callbacks_on_episode_step": null, "callbacks_on_episode_end": null, "callbacks_on_evaluate_start": null, "callbacks_on_evaluate_end": null, "callbacks_on_evaluate_offline_start": null, "callbacks_on_evaluate_offline_end": null, "callbacks_on_sample_end": null, "callbacks_on_train_result": null, "explore": true, "enable_rl_module_and_learner": true, "enable_env_runner_and_connector_v2": true, "_prior_exploration_config": {"type": "StochasticSampling"}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x77ab39ecaac0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "offline_data_class": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_read_batch_size": null, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "materialize_data": false, "materialize_mapped_data": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "ignore_final_observation": false, "prelearner_class": null, "prelearner_buffer_class": null, "prelearner_buffer_kwargs": {}, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_remaining_data": false, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": 1, "evaluation_duration": 20, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_auto_duration_min_env_steps_per_sample": 100, "evaluation_auto_duration_max_env_steps_per_sample": 2000, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 1, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "offline_evaluation_interval": null, "num_offline_eval_runners": 0, "offline_loss_for_module_fn": null, "offline_evaluation_duration": 1, "offline_evaluation_parallel_to_training": false, "offline_evaluation_timeout_s": 120.0, "num_cpus_per_offline_eval_runner": 1, "num_gpus_per_offline_eval_runner": 0, "custom_resources_per_offline_eval_runner": {}, "restart_failed_offline_eval_runners": true, "ignore_offline_eval_runner_failures": false, "max_num_offline_eval_runner_restarts": 1000, "offline_eval_runner_restore_timeout_s": 1800.0, "max_requests_in_flight_per_offline_eval_runner": 1, "validate_offline_eval_runners_after_construction": true, "offline_eval_runner_health_probe_timeout_s": 30.0, "offline_eval_rl_module_inference_only": false, "broadcast_offline_eval_runner_states": false, "offline_eval_batch_size_per_runner": 256, "dataset_num_iters_per_eval_runner": 1, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "log_gradients": true, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 42, "restart_failed_env_runners": true, "ignore_env_runner_failures": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30.0, "env_runner_restore_timeout_s": 1800.0, "_model_config": {}, "_rl_module_spec": "RLModuleSpec(module_class=None, observation_space=None, action_space=None, inference_only=False, learner_only=False, model_config=DefaultModelConfig(fcnet_hiddens=[44, 121], fcnet_activation='tanh', fcnet_kernel_initializer=None, fcnet_kernel_initializer_kwargs=None, fcnet_bias_initializer=None, fcnet_bias_initializer_kwargs=None, conv_filters=None, conv_activation='relu', conv_kernel_initializer=None, conv_kernel_initializer_kwargs=None, conv_bias_initializer=None, conv_bias_initializer_kwargs=None, head_fcnet_hiddens=[], head_fcnet_activation='relu', head_fcnet_kernel_initializer=None, head_fcnet_kernel_initializer_kwargs=None, head_fcnet_bias_initializer=None, head_fcnet_bias_initializer_kwargs=None, free_log_std=False, log_std_clip_param=20.0, vf_share_layers=True, use_lstm=False, max_seq_len=20, lstm_cell_size=256, lstm_use_prev_action=False, lstm_use_prev_reward=False, lstm_kernel_initializer=None, lstm_kernel_initializer_kwargs=None, lstm_bias_initializer=None, lstm_bias_initializer_kwargs=None), catalog_class=None, load_state_path=None, model_config_dict=None)", "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "_validate_config": true, "_use_msgpack_checkpoints": false, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "env_task_fn": -1, "enable_connectors": -1, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2326331382298, "kl_target": 0.0157623383336, "vf_loss_coeff": 0.5168547272885, "entropy_coeff": 0.0045811242641, "clip_param": 0.1219640961782, "vf_clip_param": 0.2247386827741, "entropy_coeff_schedule": null, "lr_schedule": null, "sgd_minibatch_size": -1, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9065181339776, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.callbacks.callbacks.RLlibCallback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 84.81022477149963, "iterations_since_restore": 17, "perf": {"cpu_util_percent": 12.0, "ram_util_percent": 70.21428571428571}}
{"timers": {"training_iteration": 4.348511906096718, "restore_env_runners": 3.98740216055261e-05, "training_step": 4.348241446990791, "env_runner_sampling_timer": 3.9318957077616568, "learner_update_timer": 0.41271939205106156, "synch_weights": 0.0015640886272092116, "restore_eval_env_runners": 1.4020954155892095e-05, "evaluation_iteration": 0.7468476276338226, "synch_eval_env_connectors": 0.0005211078689412418, "synch_env_connectors": 7.975830553822375e-06}, "env_runners": {"env_to_module_connector": {"timers": {"connectors": {"numpy_to_tensor": 3.1489932697452965e-05, "add_states_from_episodes_to_batch": 3.547009052927249e-06, "add_observations_from_episodes_to_batch": 6.27435216929141e-06, "add_time_dim_to_batch_and_zero_pad": 6.432889443537277e-06, "batch_individual_items": 1.8847366419273457e-05}}, "connector_pipeline_timer": 0.00012012642131825925}, "weights_seq_no": 17.0, "num_agent_steps_sampled": {"default_agent": 5000.0}, "num_episodes_lifetime": -77400.0, "module_to_env_connector": {"timers": {"connectors": {"un_batch_to_individual_items": 1.5076002629283773e-05, "normalize_and_clip_actions": 2.24009413281532e-05, "tensor_to_numpy": 4.9515304404768444e-05, "get_actions": 0.00016706824052691342, "listify_data_for_vector_env": 3.0869073153506404e-05, "remove_single_ts_time_rank_from_batch": 1.4915057660003869e-06}}, "connector_pipeline_timer": 0.00036408327017440164}, "episode_return_max": 14.5, "episode_return_mean": 14.5, "env_step_timer": 4.3323409309534086e-05, "time_between_sampling": 0.012576544955622907, "episode_len_mean": 50.0, "episode_return_min": 14.5, "num_episodes": 100.0, "rlmodule_inference_timer": 0.00010128046366029024, "sample": 0.038310644455833015, "module_episode_returns_mean": {"default_policy": 14.5}, "agent_episode_returns_mean": {"default_agent": 14.5}, "num_module_steps_sampled": {"default_policy": 5000.0}, "env_to_module_sum_episodes_length_in": 27.16809333212661, "env_reset_timer": 9.438148928065353e-05, "num_env_steps_sampled": 5000.0, "num_agent_steps_sampled_lifetime": {"default_agent": -3870000.0}, "episode_duration_sec_mean": 0.03676361103993259, "num_env_steps_sampled_lifetime": -3870000.0, "episode_len_max": 50, "env_to_module_sum_episodes_length_out": 27.16809333212661, "episode_len_min": 50, "num_module_steps_sampled_lifetime": {"default_policy": -3870000.0}, "num_env_steps_sampled_lifetime_throughput": 1270.6321550992413}, "learners": {"__all_modules__": {"num_trainable_parameters": 5987, "learner_connector_sum_episodes_length_out": 5100.0, "num_module_steps_trained_lifetime": 198000, "learner_connector": {"timers": {"connectors": {"general_advantage_estimation": 0.013667498742492772, "add_time_dim_to_batch_and_zero_pad": 2.4759116433194037e-05, "numpy_to_tensor": 0.00020294733031475505, "add_states_from_episodes_to_batch": 6.695480889894408e-06, "add_one_ts_to_episodes_and_truncate": 0.008587069882294478, "add_columns_from_episodes_to_train_batch": 0.06944985972772724, "batch_individual_items": 0.19168733482140682, "add_observations_from_episodes_to_batch": 0.0007545087839685861}}, "connector_pipeline_timer": 0.2847504106663823}, "num_non_trainable_parameters": 0, "num_env_steps_trained": 56100, "num_module_steps_trained": 11000, "learner_connector_sum_episodes_length_in": 5000.0, "num_env_steps_trained_lifetime": 1009800, "num_env_steps_trained_lifetime_throughput": 948870.2559575494, "num_module_steps_trained_throughput": 186447.40651991963, "num_module_steps_trained_lifetime_throughput": 186341.7245267053}, "default_policy": {"module_train_batch_size_mean": 1000.0, "num_trainable_parameters": 5987, "vf_explained_var": -1.0, "curr_kl_coeff": 1.7748500340530882e-06, "mean_kl_loss": 0.001661202753894031, "num_module_steps_trained": 11000, "vf_loss_unclipped": 25.053003311157227, "diff_num_grad_updates_vs_sampler_policy": 1.0, "total_loss": 0.09643708914518356, "default_optimizer_learning_rate": 0.0050505681543, "weights_seq_no": 18.0, "gradients_default_optimizer_global_norm": 0.14371158182621002, "entropy": 0.5300506949424744, "policy_loss": 0.005387771409004927, "num_module_steps_trained_lifetime": 198000, "curr_entropy_coeff": 0.0045811242641, "vf_loss": 0.18085841834545135, "num_module_steps_trained_lifetime_throughput": 186562.9036239775}}, "num_training_step_calls_per_iteration": 1, "evaluation": {"env_runners": {"rlmodule_inference_timer": 9.481433387460971e-05, "num_episodes": 20, "module_to_env_connector": {"timers": {"connectors": {"tensor_to_numpy": 4.4914744887623145e-05, "listify_data_for_vector_env": 3.0160262740577016e-05, "get_actions": 0.00015538679316017914, "remove_single_ts_time_rank_from_batch": 1.3547316989051296e-06, "un_batch_to_individual_items": 1.5496058093595485e-05, "normalize_and_clip_actions": 2.154147425756905e-05}}, "connector_pipeline_timer": 0.0003421489320774831}, "env_reset_timer": 0.00019848979112052428, "num_env_steps_sampled": 1000, "env_to_module_connector": {"timers": {"connectors": {"add_observations_from_episodes_to_batch": 6.178478150802033e-06, "add_time_dim_to_batch_and_zero_pad": 5.326606669133667e-06, "numpy_to_tensor": 2.950694331468231e-05, "add_states_from_episodes_to_batch": 3.4386873332484173e-06, "batch_individual_items": 1.8172121066524276e-05}}, "connector_pipeline_timer": 0.00011262570741819962}, "num_agent_steps_sampled": {"default_agent": 1000}, "episode_len_max": 50, "module_episode_returns_mean": {"default_policy": -1.1}, "env_step_timer": 4.2403645347135025e-05, "agent_episode_returns_mean": {"default_agent": -1.1}, "num_agent_steps_sampled_lifetime": {"default_agent": 18000}, "episode_len_mean": 50.0, "env_to_module_sum_episodes_length_in": 27.168093332126602, "env_to_module_sum_episodes_length_out": 27.168093332126602, "episode_len_min": 50, "num_module_steps_sampled": {"default_policy": 1000}, "episode_return_mean": -1.1, "episode_return_min": -16.5, "sample": 0.7348654723731235, "num_module_steps_sampled_lifetime": {"default_policy": 18000}, "episode_duration_sec_mean": 0.035629615049956556, "num_env_steps_sampled_lifetime": 91000, "weights_seq_no": 18.0, "num_episodes_lifetime": 360, "episode_return_max": 17.5, "time_between_sampling": 4.2066151036712585}, "num_healthy_workers": 1, "actor_manager_num_outstanding_async_reqs": 0, "num_remote_worker_restarts": 0}, "num_env_steps_sampled_lifetime": -3870000.0, "fault_tolerance": {"num_healthy_workers": 0, "num_remote_worker_restarts": 0}, "env_runner_group": {"actor_manager_num_outstanding_async_reqs": 0}, "done": false, "training_iteration": 18, "trial_id": "1117f_00000", "date": "2025-08-11_17-56-27", "timestamp": 1754927787, "time_this_iter_s": 4.892352104187012, "time_total_s": 89.70257687568665, "pid": 101658, "hostname": "DESKTOP-3SK5A41", "node_ip": "192.168.40.242", "config": {"exploration_config": {}, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 6, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "env": "Umbrella", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": false, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 0, "create_local_env_runner": true, "num_envs_per_env_runner": 1, "gym_env_vectorize_mode": "SYNC", "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "episodes_to_numpy": true, "max_requests_in_flight_per_env_runner": 1, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "merge_env_runner_states": "training_only", "broadcast_env_runner_states": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "complete_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "sampler_perf_stats_ema_coef": null, "_is_online": true, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": "auto", "num_aggregator_actors_per_learner": 0, "max_requests_in_flight_per_aggregator_actor": 3, "local_gpu_idx": 0, "max_requests_in_flight_per_learner": 3, "gamma": 1, "lr": 0.0050505681543, "grad_clip": 0.5, "grad_clip_by": "global_norm", "_train_batch_size_per_learner": 5000, "train_batch_size": 4000, "num_epochs": 2, "minibatch_size": 1000, "shuffle_batch_per_epoch": true, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "log_std_clip_param": 20.0, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "_disable_preprocessor_api": false, "_disable_action_flattening": false}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "_learner_class": null, "callbacks_on_algorithm_init": null, "callbacks_on_env_runners_recreated": null, "callbacks_on_offline_eval_runners_recreated": null, "callbacks_on_checkpoint_loaded": null, "callbacks_on_environment_created": null, "callbacks_on_episode_created": null, "callbacks_on_episode_start": null, "callbacks_on_episode_step": null, "callbacks_on_episode_end": null, "callbacks_on_evaluate_start": null, "callbacks_on_evaluate_end": null, "callbacks_on_evaluate_offline_start": null, "callbacks_on_evaluate_offline_end": null, "callbacks_on_sample_end": null, "callbacks_on_train_result": null, "explore": true, "enable_rl_module_and_learner": true, "enable_env_runner_and_connector_v2": true, "_prior_exploration_config": {"type": "StochasticSampling"}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x77ab39ecaac0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "offline_data_class": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_read_batch_size": null, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "materialize_data": false, "materialize_mapped_data": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "ignore_final_observation": false, "prelearner_class": null, "prelearner_buffer_class": null, "prelearner_buffer_kwargs": {}, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_remaining_data": false, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": 1, "evaluation_duration": 20, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_auto_duration_min_env_steps_per_sample": 100, "evaluation_auto_duration_max_env_steps_per_sample": 2000, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 1, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "offline_evaluation_interval": null, "num_offline_eval_runners": 0, "offline_loss_for_module_fn": null, "offline_evaluation_duration": 1, "offline_evaluation_parallel_to_training": false, "offline_evaluation_timeout_s": 120.0, "num_cpus_per_offline_eval_runner": 1, "num_gpus_per_offline_eval_runner": 0, "custom_resources_per_offline_eval_runner": {}, "restart_failed_offline_eval_runners": true, "ignore_offline_eval_runner_failures": false, "max_num_offline_eval_runner_restarts": 1000, "offline_eval_runner_restore_timeout_s": 1800.0, "max_requests_in_flight_per_offline_eval_runner": 1, "validate_offline_eval_runners_after_construction": true, "offline_eval_runner_health_probe_timeout_s": 30.0, "offline_eval_rl_module_inference_only": false, "broadcast_offline_eval_runner_states": false, "offline_eval_batch_size_per_runner": 256, "dataset_num_iters_per_eval_runner": 1, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "log_gradients": true, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 42, "restart_failed_env_runners": true, "ignore_env_runner_failures": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30.0, "env_runner_restore_timeout_s": 1800.0, "_model_config": {}, "_rl_module_spec": "RLModuleSpec(module_class=None, observation_space=None, action_space=None, inference_only=False, learner_only=False, model_config=DefaultModelConfig(fcnet_hiddens=[44, 121], fcnet_activation='tanh', fcnet_kernel_initializer=None, fcnet_kernel_initializer_kwargs=None, fcnet_bias_initializer=None, fcnet_bias_initializer_kwargs=None, conv_filters=None, conv_activation='relu', conv_kernel_initializer=None, conv_kernel_initializer_kwargs=None, conv_bias_initializer=None, conv_bias_initializer_kwargs=None, head_fcnet_hiddens=[], head_fcnet_activation='relu', head_fcnet_kernel_initializer=None, head_fcnet_kernel_initializer_kwargs=None, head_fcnet_bias_initializer=None, head_fcnet_bias_initializer_kwargs=None, free_log_std=False, log_std_clip_param=20.0, vf_share_layers=True, use_lstm=False, max_seq_len=20, lstm_cell_size=256, lstm_use_prev_action=False, lstm_use_prev_reward=False, lstm_kernel_initializer=None, lstm_kernel_initializer_kwargs=None, lstm_bias_initializer=None, lstm_bias_initializer_kwargs=None), catalog_class=None, load_state_path=None, model_config_dict=None)", "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "_validate_config": true, "_use_msgpack_checkpoints": false, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "env_task_fn": -1, "enable_connectors": -1, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2326331382298, "kl_target": 0.0157623383336, "vf_loss_coeff": 0.5168547272885, "entropy_coeff": 0.0045811242641, "clip_param": 0.1219640961782, "vf_clip_param": 0.2247386827741, "entropy_coeff_schedule": null, "lr_schedule": null, "sgd_minibatch_size": -1, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9065181339776, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.callbacks.callbacks.RLlibCallback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 89.70257687568665, "iterations_since_restore": 18, "perf": {"cpu_util_percent": 11.914285714285713, "ram_util_percent": 70.22857142857143}}
{"timers": {"training_iteration": 4.347954024035754, "restore_env_runners": 3.958228139477135e-05, "training_step": 4.34768275352088, "env_runner_sampling_timer": 3.931893919684046, "learner_update_timer": 0.4121616991305527, "synch_weights": 0.001562522740936258, "restore_eval_env_runners": 1.3992744612231412e-05, "evaluation_iteration": 0.7468025123674807, "synch_eval_env_connectors": 0.000519650790251219, "synch_env_connectors": 7.961072252099081e-06}, "env_runners": {"env_to_module_connector": {"timers": {"connectors": {"numpy_to_tensor": 3.1441652085328916e-05, "add_states_from_episodes_to_batch": 3.5162036741103276e-06, "add_observations_from_episodes_to_batch": 6.26856021857693e-06, "add_time_dim_to_batch_and_zero_pad": 6.441589613500956e-06, "batch_individual_items": 1.8858991030480378e-05}}, "connector_pipeline_timer": 0.00011999896723321876}, "weights_seq_no": 18.0, "num_agent_steps_sampled": {"default_agent": 5000.0}, "num_episodes_lifetime": -82250.0, "module_to_env_connector": {"timers": {"connectors": {"un_batch_to_individual_items": 1.5070279327653072e-05, "normalize_and_clip_actions": 2.242265591477161e-05, "tensor_to_numpy": 4.973748590935077e-05, "get_actions": 0.00016685323143717312, "listify_data_for_vector_env": 3.093491330496383e-05, "remove_single_ts_time_rank_from_batch": 1.4923006730766547e-06}}, "connector_pipeline_timer": 0.0003643287842282965}, "episode_return_max": 14.5, "episode_return_mean": 14.3, "env_step_timer": 4.3342393250748276e-05, "time_between_sampling": 0.01189326431615233, "episode_len_mean": 50.0, "episode_return_min": -5.5, "num_episodes": 100.0, "rlmodule_inference_timer": 0.00010146223912777911, "sample": 0.037968350176734694, "module_episode_returns_mean": {"default_policy": 14.3}, "agent_episode_returns_mean": {"default_agent": 14.3}, "num_module_steps_sampled": {"default_policy": 5000.0}, "env_to_module_sum_episodes_length_in": 27.16809333212661, "env_reset_timer": 9.31553068362945e-05, "num_env_steps_sampled": 5000.0, "num_agent_steps_sampled_lifetime": {"default_agent": -4112500.0}, "episode_duration_sec_mean": 0.036794026999905326, "num_env_steps_sampled_lifetime": -4112500.0, "episode_len_max": 50, "env_to_module_sum_episodes_length_out": 27.16809333212661, "episode_len_min": 50, "num_module_steps_sampled_lifetime": {"default_policy": -4112500.0}, "num_env_steps_sampled_lifetime_throughput": 1272.531639151086}, "learners": {"__all_modules__": {"num_trainable_parameters": 5987, "learner_connector_sum_episodes_length_out": 5100.0, "num_module_steps_trained_lifetime": 209000, "learner_connector": {"timers": {"connectors": {"general_advantage_estimation": 0.013638771755072243, "add_time_dim_to_batch_and_zero_pad": 2.4727525267407256e-05, "numpy_to_tensor": 0.0002025798570067292, "add_states_from_episodes_to_batch": 6.685526078464129e-06, "add_one_ts_to_episodes_and_truncate": 0.008582439183471059, "add_columns_from_episodes_to_train_batch": 0.06942543313045259, "batch_individual_items": 0.19180416747318563, "add_observations_from_episodes_to_batch": 0.0007538166961333123}}, "connector_pipeline_timer": 0.2848071215597171}, "num_non_trainable_parameters": 0, "num_env_steps_trained": 56100, "num_module_steps_trained": 11000, "learner_connector_sum_episodes_length_in": 5000.0, "num_env_steps_trained_lifetime": 1065900, "num_env_steps_trained_lifetime_throughput": 942785.0048093277, "num_module_steps_trained_throughput": 185239.65735325142, "num_module_steps_trained_lifetime_throughput": 185136.75796208318}, "default_policy": {"module_train_batch_size_mean": 1000.0, "num_trainable_parameters": 5987, "vf_explained_var": -1.0, "curr_kl_coeff": 8.874250170265441e-07, "mean_kl_loss": 0.002794621279463172, "num_module_steps_trained": 11000, "vf_loss_unclipped": 24.787473678588867, "diff_num_grad_updates_vs_sampler_policy": 1.0, "total_loss": 0.10060639679431915, "default_optimizer_learning_rate": 0.0050505681543, "weights_seq_no": 19.0, "gradients_default_optimizer_global_norm": 0.2517003118991852, "entropy": 0.5235276222229004, "policy_loss": 0.00881590973585844, "num_module_steps_trained_lifetime": 209000, "curr_entropy_coeff": 0.0045811242641, "vf_loss": 0.18223461508750916, "num_module_steps_trained_lifetime_throughput": 185344.28689378905}}, "num_training_step_calls_per_iteration": 1, "evaluation": {"env_runners": {"rlmodule_inference_timer": 9.589919373522472e-05, "num_episodes": 20, "module_to_env_connector": {"timers": {"connectors": {"tensor_to_numpy": 4.498210611034978e-05, "listify_data_for_vector_env": 3.0304716853837392e-05, "get_actions": 0.0001559373219211595, "remove_single_ts_time_rank_from_batch": 1.3565984656013048e-06, "un_batch_to_individual_items": 1.5080451570349835e-05, "normalize_and_clip_actions": 2.2089064020071808e-05}}, "connector_pipeline_timer": 0.0003439535984513618}, "env_reset_timer": 0.00019769889321517202, "num_env_steps_sampled": 1000, "env_to_module_connector": {"timers": {"connectors": {"add_observations_from_episodes_to_batch": 6.349439117802541e-06, "add_time_dim_to_batch_and_zero_pad": 5.447024996618992e-06, "numpy_to_tensor": 2.908114682161201e-05, "add_states_from_episodes_to_batch": 3.282007392125725e-06, "batch_individual_items": 1.8308010557362488e-05}}, "connector_pipeline_timer": 0.00011325054212966808}, "num_agent_steps_sampled": {"default_agent": 1000}, "episode_len_max": 50, "module_episode_returns_mean": {"default_policy": -1.3}, "env_step_timer": 4.210391569348571e-05, "agent_episode_returns_mean": {"default_agent": -1.3}, "num_agent_steps_sampled_lifetime": {"default_agent": 19000}, "episode_len_mean": 50.0, "env_to_module_sum_episodes_length_in": 27.168093332126602, "env_to_module_sum_episodes_length_out": 27.168093332126602, "episode_len_min": 50, "num_module_steps_sampled": {"default_policy": 1000}, "episode_return_mean": -1.3, "episode_return_min": -16.5, "sample": 0.7348299266493892, "num_module_steps_sampled_lifetime": {"default_policy": 19000}, "episode_duration_sec_mean": 0.03558752503992764, "num_env_steps_sampled_lifetime": 96000, "weights_seq_no": 19.0, "num_episodes_lifetime": 380, "episode_return_max": 17.5, "time_between_sampling": 4.208023281634547}, "num_healthy_workers": 1, "actor_manager_num_outstanding_async_reqs": 0, "num_remote_worker_restarts": 0}, "num_env_steps_sampled_lifetime": -4112500.0, "fault_tolerance": {"num_healthy_workers": 0, "num_remote_worker_restarts": 0}, "env_runner_group": {"actor_manager_num_outstanding_async_reqs": 0}, "done": false, "training_iteration": 19, "trial_id": "1117f_00000", "date": "2025-08-11_17-56-32", "timestamp": 1754927792, "time_this_iter_s": 5.038722991943359, "time_total_s": 94.74129986763, "pid": 101658, "hostname": "DESKTOP-3SK5A41", "node_ip": "192.168.40.242", "config": {"exploration_config": {}, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 6, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "env": "Umbrella", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": false, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 0, "create_local_env_runner": true, "num_envs_per_env_runner": 1, "gym_env_vectorize_mode": "SYNC", "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "episodes_to_numpy": true, "max_requests_in_flight_per_env_runner": 1, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "merge_env_runner_states": "training_only", "broadcast_env_runner_states": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "complete_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "sampler_perf_stats_ema_coef": null, "_is_online": true, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": "auto", "num_aggregator_actors_per_learner": 0, "max_requests_in_flight_per_aggregator_actor": 3, "local_gpu_idx": 0, "max_requests_in_flight_per_learner": 3, "gamma": 1, "lr": 0.0050505681543, "grad_clip": 0.5, "grad_clip_by": "global_norm", "_train_batch_size_per_learner": 5000, "train_batch_size": 4000, "num_epochs": 2, "minibatch_size": 1000, "shuffle_batch_per_epoch": true, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "log_std_clip_param": 20.0, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "_disable_preprocessor_api": false, "_disable_action_flattening": false}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "_learner_class": null, "callbacks_on_algorithm_init": null, "callbacks_on_env_runners_recreated": null, "callbacks_on_offline_eval_runners_recreated": null, "callbacks_on_checkpoint_loaded": null, "callbacks_on_environment_created": null, "callbacks_on_episode_created": null, "callbacks_on_episode_start": null, "callbacks_on_episode_step": null, "callbacks_on_episode_end": null, "callbacks_on_evaluate_start": null, "callbacks_on_evaluate_end": null, "callbacks_on_evaluate_offline_start": null, "callbacks_on_evaluate_offline_end": null, "callbacks_on_sample_end": null, "callbacks_on_train_result": null, "explore": true, "enable_rl_module_and_learner": true, "enable_env_runner_and_connector_v2": true, "_prior_exploration_config": {"type": "StochasticSampling"}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x77ab39ecaac0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "offline_data_class": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_read_batch_size": null, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "materialize_data": false, "materialize_mapped_data": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "ignore_final_observation": false, "prelearner_class": null, "prelearner_buffer_class": null, "prelearner_buffer_kwargs": {}, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_remaining_data": false, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": 1, "evaluation_duration": 20, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_auto_duration_min_env_steps_per_sample": 100, "evaluation_auto_duration_max_env_steps_per_sample": 2000, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 1, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "offline_evaluation_interval": null, "num_offline_eval_runners": 0, "offline_loss_for_module_fn": null, "offline_evaluation_duration": 1, "offline_evaluation_parallel_to_training": false, "offline_evaluation_timeout_s": 120.0, "num_cpus_per_offline_eval_runner": 1, "num_gpus_per_offline_eval_runner": 0, "custom_resources_per_offline_eval_runner": {}, "restart_failed_offline_eval_runners": true, "ignore_offline_eval_runner_failures": false, "max_num_offline_eval_runner_restarts": 1000, "offline_eval_runner_restore_timeout_s": 1800.0, "max_requests_in_flight_per_offline_eval_runner": 1, "validate_offline_eval_runners_after_construction": true, "offline_eval_runner_health_probe_timeout_s": 30.0, "offline_eval_rl_module_inference_only": false, "broadcast_offline_eval_runner_states": false, "offline_eval_batch_size_per_runner": 256, "dataset_num_iters_per_eval_runner": 1, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "log_gradients": true, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 42, "restart_failed_env_runners": true, "ignore_env_runner_failures": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30.0, "env_runner_restore_timeout_s": 1800.0, "_model_config": {}, "_rl_module_spec": "RLModuleSpec(module_class=None, observation_space=None, action_space=None, inference_only=False, learner_only=False, model_config=DefaultModelConfig(fcnet_hiddens=[44, 121], fcnet_activation='tanh', fcnet_kernel_initializer=None, fcnet_kernel_initializer_kwargs=None, fcnet_bias_initializer=None, fcnet_bias_initializer_kwargs=None, conv_filters=None, conv_activation='relu', conv_kernel_initializer=None, conv_kernel_initializer_kwargs=None, conv_bias_initializer=None, conv_bias_initializer_kwargs=None, head_fcnet_hiddens=[], head_fcnet_activation='relu', head_fcnet_kernel_initializer=None, head_fcnet_kernel_initializer_kwargs=None, head_fcnet_bias_initializer=None, head_fcnet_bias_initializer_kwargs=None, free_log_std=False, log_std_clip_param=20.0, vf_share_layers=True, use_lstm=False, max_seq_len=20, lstm_cell_size=256, lstm_use_prev_action=False, lstm_use_prev_reward=False, lstm_kernel_initializer=None, lstm_kernel_initializer_kwargs=None, lstm_bias_initializer=None, lstm_bias_initializer_kwargs=None), catalog_class=None, load_state_path=None, model_config_dict=None)", "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "_validate_config": true, "_use_msgpack_checkpoints": false, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "env_task_fn": -1, "enable_connectors": -1, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2326331382298, "kl_target": 0.0157623383336, "vf_loss_coeff": 0.5168547272885, "entropy_coeff": 0.0045811242641, "clip_param": 0.1219640961782, "vf_clip_param": 0.2247386827741, "entropy_coeff_schedule": null, "lr_schedule": null, "sgd_minibatch_size": -1, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9065181339776, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.callbacks.callbacks.RLlibCallback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 94.74129986763, "iterations_since_restore": 19, "perf": {"cpu_util_percent": 11.700000000000001, "ram_util_percent": 70.27142857142857}}
{"timers": {"training_iteration": 4.346124343805399, "restore_env_runners": 3.9307458583587684e-05, "training_step": 4.345851597995671, "env_runner_sampling_timer": 3.932120078487213, "learner_update_timer": 0.41010170814924674, "synch_weights": 0.0015600105135223238, "restore_eval_env_runners": 1.3969817165700013e-05, "evaluation_iteration": 0.7467427112438066, "synch_eval_env_connectors": 0.0005179552823497584, "synch_env_connectors": 7.948461530432113e-06}, "env_runners": {"env_to_module_connector": {"timers": {"connectors": {"numpy_to_tensor": 3.1552998691336246e-05, "add_states_from_episodes_to_batch": 3.5741044276329423e-06, "add_observations_from_episodes_to_batch": 6.285752472899855e-06, "add_time_dim_to_batch_and_zero_pad": 6.454335727928139e-06, "batch_individual_items": 1.887392873789691e-05}}, "connector_pipeline_timer": 0.00012037000823217337}, "weights_seq_no": 19.0, "num_agent_steps_sampled": {"default_agent": 5000.0}, "num_episodes_lifetime": -87100.0, "module_to_env_connector": {"timers": {"connectors": {"un_batch_to_individual_items": 1.5118695906640163e-05, "normalize_and_clip_actions": 2.2469934071595944e-05, "tensor_to_numpy": 4.9941775786532496e-05, "get_actions": 0.00016836715086622757, "listify_data_for_vector_env": 3.114536153002227e-05, "remove_single_ts_time_rank_from_batch": 1.506887487555656e-06}}, "connector_pipeline_timer": 0.00036648834730890407}, "episode_return_max": 14.5, "episode_return_mean": 14.3, "env_step_timer": 4.357340319574864e-05, "time_between_sampling": 0.01255078882500215, "episode_len_mean": 50.0, "episode_return_min": -5.5, "num_episodes": 100.0, "rlmodule_inference_timer": 0.0001017550167701005, "sample": 0.037967596078147224, "module_episode_returns_mean": {"default_policy": 14.3}, "agent_episode_returns_mean": {"default_agent": 14.3}, "num_module_steps_sampled": {"default_policy": 5000.0}, "env_to_module_sum_episodes_length_in": 27.16809333212661, "env_reset_timer": 9.235751000541776e-05, "num_env_steps_sampled": 5000.0, "num_agent_steps_sampled_lifetime": {"default_agent": -4355000.0}, "episode_duration_sec_mean": 0.03700191199994151, "num_env_steps_sampled_lifetime": -4355000.0, "episode_len_max": 50, "env_to_module_sum_episodes_length_out": 27.16809333212661, "episode_len_min": 50, "num_module_steps_sampled_lifetime": {"default_policy": -4355000.0}, "num_env_steps_sampled_lifetime_throughput": 1267.2325913828638}, "learners": {"__all_modules__": {"num_trainable_parameters": 5987, "learner_connector_sum_episodes_length_out": 5100.0, "num_module_steps_trained_lifetime": 220000, "learner_connector": {"timers": {"connectors": {"general_advantage_estimation": 0.013592947037524906, "add_time_dim_to_batch_and_zero_pad": 2.468125001729525e-05, "numpy_to_tensor": 0.00020222505843664948, "add_states_from_episodes_to_batch": 6.675670815148153e-06, "add_one_ts_to_episodes_and_truncate": 0.008579429791641559, "add_columns_from_episodes_to_train_batch": 0.06941436480913997, "batch_individual_items": 0.1904555717984533, "add_observations_from_episodes_to_batch": 0.0007536325291713745}}, "connector_pipeline_timer": 0.28339732335411866}, "num_non_trainable_parameters": 0, "num_env_steps_trained": 56100, "num_module_steps_trained": 11000, "learner_connector_sum_episodes_length_in": 5000.0, "num_env_steps_trained_lifetime": 1122000, "num_env_steps_trained_lifetime_throughput": 938242.4341901742, "num_module_steps_trained_throughput": 184336.03247762605, "num_module_steps_trained_lifetime_throughput": 184234.95850114475}, "default_policy": {"module_train_batch_size_mean": 1000.0, "num_trainable_parameters": 5987, "vf_explained_var": -1.0, "curr_kl_coeff": 4.4371250851327204e-07, "mean_kl_loss": 0.006093129515647888, "num_module_steps_trained": 11000, "vf_loss_unclipped": 27.238492965698242, "diff_num_grad_updates_vs_sampler_policy": 1.0, "total_loss": 0.0852586179971695, "default_optimizer_learning_rate": 0.0050505681543, "weights_seq_no": 20.0, "gradients_default_optimizer_global_norm": 0.19177991151809692, "entropy": 0.49466606974601746, "policy_loss": -0.0020536582451313734, "num_module_steps_trained_lifetime": 220000, "curr_entropy_coeff": 0.0045811242641, "vf_loss": 0.1733144372701645, "num_module_steps_trained_lifetime_throughput": 184430.08056374258}}, "num_training_step_calls_per_iteration": 1, "evaluation": {"env_runners": {"rlmodule_inference_timer": 9.58728626809079e-05, "num_episodes": 20, "module_to_env_connector": {"timers": {"connectors": {"tensor_to_numpy": 4.54071938877748e-05, "listify_data_for_vector_env": 3.0299383066997186e-05, "get_actions": 0.0001556232025461377, "remove_single_ts_time_rank_from_batch": 1.442918052483841e-06, "un_batch_to_individual_items": 1.5228049967666868e-05, "normalize_and_clip_actions": 2.163067442125486e-05}}, "connector_pipeline_timer": 0.00034250231308951857}, "env_reset_timer": 0.0001969459042808395, "num_env_steps_sampled": 1000, "env_to_module_connector": {"timers": {"connectors": {"add_observations_from_episodes_to_batch": 6.085976214839836e-06, "add_time_dim_to_batch_and_zero_pad": 5.3259013966131965e-06, "numpy_to_tensor": 2.9234453940389e-05, "add_states_from_episodes_to_batch": 3.2897102374294815e-06, "batch_individual_items": 1.7770698183924948e-05}}, "connector_pipeline_timer": 0.00011086297050095541}, "num_agent_steps_sampled": {"default_agent": 1000}, "episode_len_max": 50, "module_episode_returns_mean": {"default_policy": -1.3}, "env_step_timer": 4.137424118835194e-05, "agent_episode_returns_mean": {"default_agent": -1.3}, "num_agent_steps_sampled_lifetime": {"default_agent": 20000}, "episode_len_mean": 50.0, "env_to_module_sum_episodes_length_in": 27.168093332126602, "env_to_module_sum_episodes_length_out": 27.168093332126602, "episode_len_min": 50, "num_module_steps_sampled": {"default_policy": 1000}, "episode_return_mean": -1.3, "episode_return_min": -16.5, "sample": 0.7347392703828979, "num_module_steps_sampled_lifetime": {"default_policy": 20000}, "episode_duration_sec_mean": 0.035559828019922864, "num_env_steps_sampled_lifetime": 101000, "weights_seq_no": 20.0, "num_episodes_lifetime": 400, "episode_return_max": 17.5, "time_between_sampling": 4.208128179818198}, "num_healthy_workers": 1, "actor_manager_num_outstanding_async_reqs": 0, "num_remote_worker_restarts": 0}, "num_env_steps_sampled_lifetime": -4355000.0, "fault_tolerance": {"num_healthy_workers": 0, "num_remote_worker_restarts": 0}, "env_runner_group": {"actor_manager_num_outstanding_async_reqs": 0}, "done": true, "training_iteration": 20, "trial_id": "1117f_00000", "date": "2025-08-11_17-56-37", "timestamp": 1754927797, "time_this_iter_s": 4.905580997467041, "time_total_s": 99.64688086509705, "pid": 101658, "hostname": "DESKTOP-3SK5A41", "node_ip": "192.168.40.242", "config": {"exploration_config": {}, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 6, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "env": "Umbrella", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": false, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 0, "create_local_env_runner": true, "num_envs_per_env_runner": 1, "gym_env_vectorize_mode": "SYNC", "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "episodes_to_numpy": true, "max_requests_in_flight_per_env_runner": 1, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "merge_env_runner_states": "training_only", "broadcast_env_runner_states": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "complete_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "sampler_perf_stats_ema_coef": null, "_is_online": true, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": "auto", "num_aggregator_actors_per_learner": 0, "max_requests_in_flight_per_aggregator_actor": 3, "local_gpu_idx": 0, "max_requests_in_flight_per_learner": 3, "gamma": 1, "lr": 0.0050505681543, "grad_clip": 0.5, "grad_clip_by": "global_norm", "_train_batch_size_per_learner": 5000, "train_batch_size": 4000, "num_epochs": 2, "minibatch_size": 1000, "shuffle_batch_per_epoch": true, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "log_std_clip_param": 20.0, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "_disable_preprocessor_api": false, "_disable_action_flattening": false}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "_learner_class": null, "callbacks_on_algorithm_init": null, "callbacks_on_env_runners_recreated": null, "callbacks_on_offline_eval_runners_recreated": null, "callbacks_on_checkpoint_loaded": null, "callbacks_on_environment_created": null, "callbacks_on_episode_created": null, "callbacks_on_episode_start": null, "callbacks_on_episode_step": null, "callbacks_on_episode_end": null, "callbacks_on_evaluate_start": null, "callbacks_on_evaluate_end": null, "callbacks_on_evaluate_offline_start": null, "callbacks_on_evaluate_offline_end": null, "callbacks_on_sample_end": null, "callbacks_on_train_result": null, "explore": true, "enable_rl_module_and_learner": true, "enable_env_runner_and_connector_v2": true, "_prior_exploration_config": {"type": "StochasticSampling"}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x77ab39ecaac0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "offline_data_class": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_read_batch_size": null, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "materialize_data": false, "materialize_mapped_data": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "ignore_final_observation": false, "prelearner_class": null, "prelearner_buffer_class": null, "prelearner_buffer_kwargs": {}, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_remaining_data": false, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": 1, "evaluation_duration": 20, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_auto_duration_min_env_steps_per_sample": 100, "evaluation_auto_duration_max_env_steps_per_sample": 2000, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 1, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "offline_evaluation_interval": null, "num_offline_eval_runners": 0, "offline_loss_for_module_fn": null, "offline_evaluation_duration": 1, "offline_evaluation_parallel_to_training": false, "offline_evaluation_timeout_s": 120.0, "num_cpus_per_offline_eval_runner": 1, "num_gpus_per_offline_eval_runner": 0, "custom_resources_per_offline_eval_runner": {}, "restart_failed_offline_eval_runners": true, "ignore_offline_eval_runner_failures": false, "max_num_offline_eval_runner_restarts": 1000, "offline_eval_runner_restore_timeout_s": 1800.0, "max_requests_in_flight_per_offline_eval_runner": 1, "validate_offline_eval_runners_after_construction": true, "offline_eval_runner_health_probe_timeout_s": 30.0, "offline_eval_rl_module_inference_only": false, "broadcast_offline_eval_runner_states": false, "offline_eval_batch_size_per_runner": 256, "dataset_num_iters_per_eval_runner": 1, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "log_gradients": true, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 42, "restart_failed_env_runners": true, "ignore_env_runner_failures": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30.0, "env_runner_restore_timeout_s": 1800.0, "_model_config": {}, "_rl_module_spec": "RLModuleSpec(module_class=None, observation_space=None, action_space=None, inference_only=False, learner_only=False, model_config=DefaultModelConfig(fcnet_hiddens=[44, 121], fcnet_activation='tanh', fcnet_kernel_initializer=None, fcnet_kernel_initializer_kwargs=None, fcnet_bias_initializer=None, fcnet_bias_initializer_kwargs=None, conv_filters=None, conv_activation='relu', conv_kernel_initializer=None, conv_kernel_initializer_kwargs=None, conv_bias_initializer=None, conv_bias_initializer_kwargs=None, head_fcnet_hiddens=[], head_fcnet_activation='relu', head_fcnet_kernel_initializer=None, head_fcnet_kernel_initializer_kwargs=None, head_fcnet_bias_initializer=None, head_fcnet_bias_initializer_kwargs=None, free_log_std=False, log_std_clip_param=20.0, vf_share_layers=True, use_lstm=False, max_seq_len=20, lstm_cell_size=256, lstm_use_prev_action=False, lstm_use_prev_reward=False, lstm_kernel_initializer=None, lstm_kernel_initializer_kwargs=None, lstm_bias_initializer=None, lstm_bias_initializer_kwargs=None), catalog_class=None, load_state_path=None, model_config_dict=None)", "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "_validate_config": true, "_use_msgpack_checkpoints": false, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "env_task_fn": -1, "enable_connectors": -1, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2326331382298, "kl_target": 0.0157623383336, "vf_loss_coeff": 0.5168547272885, "entropy_coeff": 0.0045811242641, "clip_param": 0.1219640961782, "vf_clip_param": 0.2247386827741, "entropy_coeff_schedule": null, "lr_schedule": null, "sgd_minibatch_size": -1, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9065181339776, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.callbacks.callbacks.RLlibCallback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 99.64688086509705, "iterations_since_restore": 20, "perf": {"cpu_util_percent": 11.628571428571428, "ram_util_percent": 70.27142857142857}}
