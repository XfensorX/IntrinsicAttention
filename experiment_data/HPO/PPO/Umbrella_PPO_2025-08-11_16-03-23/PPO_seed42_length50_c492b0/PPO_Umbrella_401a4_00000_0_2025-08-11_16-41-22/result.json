{"timers": {"training_iteration": 4.434815040000103, "restore_env_runners": 1.4999999621068127e-05, "training_step": 4.434517340000184, "env_runner_sampling_timer": 3.9237806339997405, "learner_update_timer": 0.5071038060000319, "synch_weights": 0.0014375000000654836}, "env_runners": {"sample": 0.04064754928890294, "module_to_env_connector": {"timers": {"connectors": {"remove_single_ts_time_rank_from_batch": 1.6088886657119912e-06, "listify_data_for_vector_env": 3.18046677788638e-05, "un_batch_to_individual_items": 1.7436788575964765e-05, "get_actions": 0.00017223785086002363, "tensor_to_numpy": 4.866653153146691e-05, "normalize_and_clip_actions": 2.938065556051297e-05}}, "connector_pipeline_timer": 0.00038072827611835934}, "episode_len_min": 50, "num_episodes": 100.0, "num_env_steps_sampled": 5000.0, "num_agent_steps_sampled_lifetime": {"default_agent": 252500.0}, "num_episodes_lifetime": 5050.0, "env_to_module_connector": {"connector_pipeline_timer": 0.00012532022859788726, "timers": {"connectors": {"numpy_to_tensor": 3.206912824127583e-05, "add_observations_from_episodes_to_batch": 6.770320161052795e-06, "add_time_dim_to_batch_and_zero_pad": 6.640627343330511e-06, "batch_individual_items": 1.9310001835601356e-05, "add_states_from_episodes_to_batch": 3.486399086656391e-06}}}, "num_agent_steps_sampled": {"default_agent": 5000.0}, "num_module_steps_sampled_lifetime": {"default_policy": 252500.0}, "module_episode_returns_mean": {"default_policy": 2.6999999999999993}, "env_reset_timer": 0.0002174605705593602, "rlmodule_inference_timer": 0.00010245268832856419, "env_to_module_sum_episodes_length_in": 26.762340024562445, "num_module_steps_sampled": {"default_policy": 5000.0}, "episode_duration_sec_mean": 0.03663724233997072, "env_to_module_sum_episodes_length_out": 26.762340024562445, "agent_episode_returns_mean": {"default_agent": 2.6999999999999993}, "episode_len_max": 50, "time_between_sampling": 0.0013744774145910805, "episode_return_min": -5.5, "weights_seq_no": 0.0, "episode_return_max": 14.5, "env_step_timer": 4.5422065773692794e-05, "episode_len_mean": 50.0, "num_env_steps_sampled_lifetime": 252500.0, "episode_return_mean": 2.6999999999999993, "num_env_steps_sampled_lifetime_throughput": 1230.0355017584282}, "learners": {"__all_modules__": {"num_env_steps_trained_lifetime": 81600, "num_module_steps_trained": 16000, "learner_connector": {"timers": {"connectors": {"add_time_dim_to_batch_and_zero_pad": 2.369999992879457e-05, "batch_individual_items": 0.21256780299972888, "general_advantage_estimation": 0.014146200000141107, "add_states_from_episodes_to_batch": 6.199999916134402e-06, "numpy_to_tensor": 0.00016499999992447556, "add_observations_from_episodes_to_batch": 0.0007901000003585068, "add_columns_from_episodes_to_train_batch": 0.06996620100017026, "add_one_ts_to_episodes_and_truncate": 0.00837520000004588}}, "connector_pipeline_timer": 0.3063339039999846}, "num_trainable_parameters": 1504, "num_module_steps_trained_lifetime": 16000, "num_env_steps_trained": 81600, "num_non_trainable_parameters": 0, "learner_connector_sum_episodes_length_in": 5000, "learner_connector_sum_episodes_length_out": 5100, "num_env_steps_trained_lifetime_throughput": 938399.4171031333, "num_module_steps_trained_throughput": 184993.63963998112, "num_module_steps_trained_lifetime_throughput": 184875.16667651033}, "default_policy": {"weights_seq_no": 1.0, "vf_loss": 0.12139124423265457, "vf_loss_unclipped": 25.978300094604492, "policy_loss": 0.03751281648874283, "curr_kl_coeff": 0.13892580568790436, "total_loss": 0.11390364170074463, "num_module_steps_trained_lifetime": 16000, "entropy": 0.6755844950675964, "vf_explained_var": 0.01617562770843506, "num_trainable_parameters": 1504, "curr_entropy_coeff": 0.0070182010851, "module_train_batch_size_mean": 1000.0, "default_optimizer_learning_rate": 0.0002467453741, "gradients_default_optimizer_global_norm": 0.0363188236951828, "diff_num_grad_updates_vs_sampler_policy": 1.0, "num_module_steps_trained": 16000, "mean_kl_loss": 0.00033098948188126087, "num_module_steps_trained_lifetime_throughput": 185354.55737004406}}, "num_training_step_calls_per_iteration": 1, "num_env_steps_sampled_lifetime": 252500.0, "evaluation": {"env_runners": {"num_env_steps_sampled_lifetime": 6000, "module_to_env_connector": {"timers": {"connectors": {"normalize_and_clip_actions": 2.2283080890816933e-05, "remove_single_ts_time_rank_from_batch": 1.4245414814723508e-06, "listify_data_for_vector_env": 3.2048730583121854e-05, "un_batch_to_individual_items": 1.6163314571209455e-05, "get_actions": 0.00016129545857223983, "tensor_to_numpy": 4.6332563605629834e-05}}, "connector_pipeline_timer": 0.00035372609658105203}, "num_agent_steps_sampled": {"default_agent": 1000}, "env_to_module_connector": {"timers": {"connectors": {"add_observations_from_episodes_to_batch": 6.4497890124100055e-06, "add_time_dim_to_batch_and_zero_pad": 5.984653350357264e-06, "add_states_from_episodes_to_batch": 3.7209432078788856e-06, "numpy_to_tensor": 3.0162639529581226e-05, "batch_individual_items": 1.9606682421518842e-05}}, "connector_pipeline_timer": 0.00011668893938271633}, "env_to_module_sum_episodes_length_out": 27.167134025045954, "episode_return_min": -16.5, "episode_return_mean": -0.9, "episode_len_mean": 50.0, "num_agent_steps_sampled_lifetime": {"default_agent": 1000}, "sample": 0.7591794089998984, "num_episodes": 20, "num_module_steps_sampled_lifetime": {"default_policy": 1000}, "module_episode_returns_mean": {"default_policy": -0.9}, "agent_episode_returns_mean": {"default_agent": -0.9}, "env_reset_timer": 0.00031790000002729357, "rlmodule_inference_timer": 9.809594623999685e-05, "episode_len_max": 50, "episode_return_max": 17.5, "episode_len_min": 50, "num_env_steps_sampled": 1000, "num_episodes_lifetime": 20, "env_to_module_sum_episodes_length_in": 27.167134025045954, "episode_duration_sec_mean": 0.036460105450009904, "num_module_steps_sampled": {"default_policy": 1000}, "weights_seq_no": 1.0, "env_step_timer": 4.484888554835953e-05}, "num_healthy_workers": 1, "actor_manager_num_outstanding_async_reqs": 0, "num_remote_worker_restarts": 0}, "fault_tolerance": {"num_healthy_workers": 0, "num_remote_worker_restarts": 0}, "env_runner_group": {"actor_manager_num_outstanding_async_reqs": 0}, "done": false, "training_iteration": 1, "trial_id": "401a4_00000", "date": "2025-08-11_16-45-53", "timestamp": 1754923553, "time_this_iter_s": 5.210051536560059, "time_total_s": 5.210051536560059, "pid": 41381, "hostname": "DESKTOP-3SK5A41", "node_ip": "192.168.40.242", "config": {"exploration_config": {}, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 6, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "env": "Umbrella", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": false, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 0, "create_local_env_runner": true, "num_envs_per_env_runner": 1, "gym_env_vectorize_mode": "SYNC", "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "episodes_to_numpy": true, "max_requests_in_flight_per_env_runner": 1, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "merge_env_runner_states": "training_only", "broadcast_env_runner_states": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "complete_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "sampler_perf_stats_ema_coef": null, "_is_online": true, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": "auto", "num_aggregator_actors_per_learner": 0, "max_requests_in_flight_per_aggregator_actor": 3, "local_gpu_idx": 0, "max_requests_in_flight_per_learner": 3, "gamma": 1, "lr": 0.0002467453741, "grad_clip": 0.5, "grad_clip_by": "global_norm", "_train_batch_size_per_learner": 5000, "train_batch_size": 4000, "num_epochs": 3, "minibatch_size": 1000, "shuffle_batch_per_epoch": true, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "log_std_clip_param": 20.0, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "_disable_preprocessor_api": false, "_disable_action_flattening": false}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "_learner_class": null, "callbacks_on_algorithm_init": null, "callbacks_on_env_runners_recreated": null, "callbacks_on_offline_eval_runners_recreated": null, "callbacks_on_checkpoint_loaded": null, "callbacks_on_environment_created": null, "callbacks_on_episode_created": null, "callbacks_on_episode_start": null, "callbacks_on_episode_step": null, "callbacks_on_episode_end": null, "callbacks_on_evaluate_start": null, "callbacks_on_evaluate_end": null, "callbacks_on_evaluate_offline_start": null, "callbacks_on_evaluate_offline_end": null, "callbacks_on_sample_end": null, "callbacks_on_train_result": null, "explore": true, "enable_rl_module_and_learner": true, "enable_env_runner_and_connector_v2": true, "_prior_exploration_config": {"type": "StochasticSampling"}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x72219cf82ac0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "offline_data_class": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_read_batch_size": null, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "materialize_data": false, "materialize_mapped_data": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "ignore_final_observation": false, "prelearner_class": null, "prelearner_buffer_class": null, "prelearner_buffer_kwargs": {}, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_remaining_data": false, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": 1, "evaluation_duration": 20, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_auto_duration_min_env_steps_per_sample": 100, "evaluation_auto_duration_max_env_steps_per_sample": 2000, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 1, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "offline_evaluation_interval": null, "num_offline_eval_runners": 0, "offline_loss_for_module_fn": null, "offline_evaluation_duration": 1, "offline_evaluation_parallel_to_training": false, "offline_evaluation_timeout_s": 120.0, "num_cpus_per_offline_eval_runner": 1, "num_gpus_per_offline_eval_runner": 0, "custom_resources_per_offline_eval_runner": {}, "restart_failed_offline_eval_runners": true, "ignore_offline_eval_runner_failures": false, "max_num_offline_eval_runner_restarts": 1000, "offline_eval_runner_restore_timeout_s": 1800.0, "max_requests_in_flight_per_offline_eval_runner": 1, "validate_offline_eval_runners_after_construction": true, "offline_eval_runner_health_probe_timeout_s": 30.0, "offline_eval_rl_module_inference_only": false, "broadcast_offline_eval_runner_states": false, "offline_eval_batch_size_per_runner": 256, "dataset_num_iters_per_eval_runner": 1, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "log_gradients": true, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 42, "restart_failed_env_runners": true, "ignore_env_runner_failures": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30.0, "env_runner_restore_timeout_s": 1800.0, "_model_config": {}, "_rl_module_spec": "RLModuleSpec(module_class=None, observation_space=None, action_space=None, inference_only=False, learner_only=False, model_config=DefaultModelConfig(fcnet_hiddens=[37, 33], fcnet_activation='tanh', fcnet_kernel_initializer=None, fcnet_kernel_initializer_kwargs=None, fcnet_bias_initializer=None, fcnet_bias_initializer_kwargs=None, conv_filters=None, conv_activation='relu', conv_kernel_initializer=None, conv_kernel_initializer_kwargs=None, conv_bias_initializer=None, conv_bias_initializer_kwargs=None, head_fcnet_hiddens=[], head_fcnet_activation='relu', head_fcnet_kernel_initializer=None, head_fcnet_kernel_initializer_kwargs=None, head_fcnet_bias_initializer=None, head_fcnet_bias_initializer_kwargs=None, free_log_std=False, log_std_clip_param=20.0, vf_share_layers=True, use_lstm=False, max_seq_len=20, lstm_cell_size=256, lstm_use_prev_action=False, lstm_use_prev_reward=False, lstm_kernel_initializer=None, lstm_kernel_initializer_kwargs=None, lstm_bias_initializer=None, lstm_bias_initializer_kwargs=None), catalog_class=None, load_state_path=None, model_config_dict=None)", "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "_validate_config": true, "_use_msgpack_checkpoints": false, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "env_task_fn": -1, "enable_connectors": -1, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2778516099996, "kl_target": 0.0287023736013, "vf_loss_coeff": 0.6675954092171, "entropy_coeff": 0.0070182010851, "clip_param": 0.2775300644704, "vf_clip_param": 0.1234717562345, "entropy_coeff_schedule": null, "lr_schedule": null, "sgd_minibatch_size": -1, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9606647579607, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.callbacks.callbacks.RLlibCallback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 5.210051536560059, "iterations_since_restore": 1, "perf": {"cpu_util_percent": 11.35, "ram_util_percent": 89.3875}}
{"timers": {"training_iteration": 4.432611139100099, "restore_env_runners": 1.4995999622442469e-05, "training_step": 4.432312397100186, "env_runner_sampling_timer": 3.9243632701397426, "learner_update_timer": 0.5043150319600318, "synch_weights": 0.0014378880000640493, "restore_eval_env_runners": 1.4199999895936344e-05, "evaluation_iteration": 0.7719780100001117, "synch_eval_env_connectors": 0.0004521000000750064, "synch_env_connectors": 7.3999999585794285e-06}, "env_runners": {"sample": 0.03905334241465077, "module_to_env_connector": {"timers": {"connectors": {"remove_single_ts_time_rank_from_batch": 1.5960126114013369e-06, "listify_data_for_vector_env": 3.137860707113098e-05, "un_batch_to_individual_items": 1.5085119680852853e-05, "get_actions": 0.0001680441823749327, "tensor_to_numpy": 5.01854189400292e-05, "normalize_and_clip_actions": 2.291069805734888e-05}}, "connector_pipeline_timer": 0.0003680956846126978}, "episode_len_min": 50, "num_episodes": 100.0, "num_env_steps_sampled": 5000.0, "num_agent_steps_sampled_lifetime": {"default_agent": 10000.0}, "num_episodes_lifetime": 200.0, "env_to_module_connector": {"connector_pipeline_timer": 0.00012293490147779898, "timers": {"connectors": {"numpy_to_tensor": 3.181691318486948e-05, "add_observations_from_episodes_to_batch": 6.573057966788865e-06, "add_time_dim_to_batch_and_zero_pad": 6.5153966533118885e-06, "batch_individual_items": 1.9073083837236678e-05, "add_states_from_episodes_to_batch": 3.5083497444927495e-06}}}, "num_agent_steps_sampled": {"default_agent": 5000.0}, "num_module_steps_sampled_lifetime": {"default_policy": 10000.0}, "module_episode_returns_mean": {"default_policy": 1.3000000000000003}, "env_reset_timer": 0.00014327688521765988, "rlmodule_inference_timer": 9.937815460280859e-05, "env_to_module_sum_episodes_length_in": 27.16809333212661, "num_module_steps_sampled": {"default_policy": 5000.0}, "episode_duration_sec_mean": 0.03715322342003674, "env_to_module_sum_episodes_length_out": 27.16809333212661, "agent_episode_returns_mean": {"default_agent": 1.3000000000000003}, "episode_len_max": 50, "time_between_sampling": 0.009846477967646894, "episode_return_min": -5.5, "weights_seq_no": 1.0, "episode_return_max": 14.5, "env_step_timer": 4.392474734087144e-05, "episode_len_mean": 50.0, "num_env_steps_sampled_lifetime": 10000.0, "episode_return_mean": 1.3000000000000003, "num_env_steps_sampled_lifetime_throughput": 1258.7242010091036}, "learners": {"__all_modules__": {"num_env_steps_trained_lifetime": 163200, "num_module_steps_trained": 16000, "learner_connector": {"timers": {"connectors": {"add_time_dim_to_batch_and_zero_pad": 2.3713999930805587e-05, "batch_individual_items": 0.2110529869697302, "general_advantage_estimation": 0.014087826000140921, "add_states_from_episodes_to_batch": 6.19799991909531e-06, "numpy_to_tensor": 0.00016507099992395523, "add_observations_from_episodes_to_batch": 0.0007894910003551558, "add_columns_from_episodes_to_train_batch": 0.06994613600016693, "add_one_ts_to_episodes_and_truncate": 0.00837489500004267}}, "connector_pipeline_timer": 0.30473976096998284}, "num_trainable_parameters": 1504, "num_module_steps_trained_lifetime": 32000, "num_env_steps_trained": 81600, "num_non_trainable_parameters": 0, "learner_connector_sum_episodes_length_in": 5000.0, "learner_connector_sum_episodes_length_out": 5100.0, "num_env_steps_trained_lifetime_throughput": 940567.8189569935, "num_module_steps_trained_throughput": 185390.3313708319, "num_module_steps_trained_lifetime_throughput": 185274.51105443784}, "default_policy": {"weights_seq_no": 2.0, "vf_loss": 0.12081867456436157, "vf_loss_unclipped": 24.561582565307617, "policy_loss": 0.03542880713939667, "curr_kl_coeff": 0.06946290284395218, "total_loss": 0.11137785762548447, "num_module_steps_trained_lifetime": 32000, "entropy": 0.6807659864425659, "vf_explained_var": 0.017065227031707764, "num_trainable_parameters": 1504, "curr_entropy_coeff": 0.0070182010851, "module_train_batch_size_mean": 1000.0, "default_optimizer_learning_rate": 0.0002467453741, "gradients_default_optimizer_global_norm": 0.00984426960349083, "diff_num_grad_updates_vs_sampler_policy": 1.0, "num_module_steps_trained": 16000, "mean_kl_loss": 0.0004954524338245392, "num_module_steps_trained_lifetime_throughput": 185739.0974612674}}, "num_training_step_calls_per_iteration": 1, "evaluation": {"env_runners": {"num_env_steps_sampled_lifetime": 11000, "module_to_env_connector": {"timers": {"connectors": {"normalize_and_clip_actions": 2.2458488187061205e-05, "remove_single_ts_time_rank_from_batch": 1.417729676133785e-06, "listify_data_for_vector_env": 3.183412486056204e-05, "un_batch_to_individual_items": 1.580377602477031e-05, "get_actions": 0.00016074546090314365, "tensor_to_numpy": 4.6600817281953174e-05}}, "connector_pipeline_timer": 0.0003538207706757972}, "num_agent_steps_sampled": {"default_agent": 1000}, "env_to_module_connector": {"timers": {"connectors": {"add_observations_from_episodes_to_batch": 6.4058746568901e-06, "add_time_dim_to_batch_and_zero_pad": 5.694053404225518e-06, "add_states_from_episodes_to_batch": 3.3407253492366864e-06, "numpy_to_tensor": 2.9601890540474635e-05, "batch_individual_items": 1.8850430983221453e-05}}, "connector_pipeline_timer": 0.00011318106707508922}, "env_to_module_sum_episodes_length_out": 27.168093298253442, "episode_return_min": -16.5, "episode_return_mean": -1.9, "episode_len_mean": 50.0, "num_agent_steps_sampled_lifetime": {"default_agent": 2000}, "sample": 0.7589594489898991, "num_episodes": 20, "num_module_steps_sampled_lifetime": {"default_policy": 2000}, "module_episode_returns_mean": {"default_policy": -1.9}, "agent_episode_returns_mean": {"default_agent": -1.9}, "env_reset_timer": 0.0003160030000253755, "rlmodule_inference_timer": 9.432984181787356e-05, "episode_len_max": 50, "episode_return_max": 17.5, "episode_len_min": 50, "num_env_steps_sampled": 1000, "num_episodes_lifetime": 40, "env_to_module_sum_episodes_length_in": 27.168093298253442, "episode_duration_sec_mean": 0.035943412924973474, "num_module_steps_sampled": {"default_policy": 1000}, "weights_seq_no": 2.0, "env_step_timer": 4.3091113010900535e-05, "time_between_sampling": 4.2718788510001104}, "num_healthy_workers": 1, "actor_manager_num_outstanding_async_reqs": 0, "num_remote_worker_restarts": 0}, "num_env_steps_sampled_lifetime": 10000.0, "fault_tolerance": {"num_healthy_workers": 0, "num_remote_worker_restarts": 0}, "env_runner_group": {"actor_manager_num_outstanding_async_reqs": 0}, "done": false, "training_iteration": 2, "trial_id": "401a4_00000", "date": "2025-08-11_16-45-58", "timestamp": 1754923558, "time_this_iter_s": 4.965466260910034, "time_total_s": 10.175517797470093, "pid": 41381, "hostname": "DESKTOP-3SK5A41", "node_ip": "192.168.40.242", "config": {"exploration_config": {}, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 6, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "env": "Umbrella", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": false, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 0, "create_local_env_runner": true, "num_envs_per_env_runner": 1, "gym_env_vectorize_mode": "SYNC", "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "episodes_to_numpy": true, "max_requests_in_flight_per_env_runner": 1, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "merge_env_runner_states": "training_only", "broadcast_env_runner_states": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "complete_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "sampler_perf_stats_ema_coef": null, "_is_online": true, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": "auto", "num_aggregator_actors_per_learner": 0, "max_requests_in_flight_per_aggregator_actor": 3, "local_gpu_idx": 0, "max_requests_in_flight_per_learner": 3, "gamma": 1, "lr": 0.0002467453741, "grad_clip": 0.5, "grad_clip_by": "global_norm", "_train_batch_size_per_learner": 5000, "train_batch_size": 4000, "num_epochs": 3, "minibatch_size": 1000, "shuffle_batch_per_epoch": true, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "log_std_clip_param": 20.0, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "_disable_preprocessor_api": false, "_disable_action_flattening": false}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "_learner_class": null, "callbacks_on_algorithm_init": null, "callbacks_on_env_runners_recreated": null, "callbacks_on_offline_eval_runners_recreated": null, "callbacks_on_checkpoint_loaded": null, "callbacks_on_environment_created": null, "callbacks_on_episode_created": null, "callbacks_on_episode_start": null, "callbacks_on_episode_step": null, "callbacks_on_episode_end": null, "callbacks_on_evaluate_start": null, "callbacks_on_evaluate_end": null, "callbacks_on_evaluate_offline_start": null, "callbacks_on_evaluate_offline_end": null, "callbacks_on_sample_end": null, "callbacks_on_train_result": null, "explore": true, "enable_rl_module_and_learner": true, "enable_env_runner_and_connector_v2": true, "_prior_exploration_config": {"type": "StochasticSampling"}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x72219cf82ac0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "offline_data_class": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_read_batch_size": null, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "materialize_data": false, "materialize_mapped_data": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "ignore_final_observation": false, "prelearner_class": null, "prelearner_buffer_class": null, "prelearner_buffer_kwargs": {}, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_remaining_data": false, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": 1, "evaluation_duration": 20, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_auto_duration_min_env_steps_per_sample": 100, "evaluation_auto_duration_max_env_steps_per_sample": 2000, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 1, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "offline_evaluation_interval": null, "num_offline_eval_runners": 0, "offline_loss_for_module_fn": null, "offline_evaluation_duration": 1, "offline_evaluation_parallel_to_training": false, "offline_evaluation_timeout_s": 120.0, "num_cpus_per_offline_eval_runner": 1, "num_gpus_per_offline_eval_runner": 0, "custom_resources_per_offline_eval_runner": {}, "restart_failed_offline_eval_runners": true, "ignore_offline_eval_runner_failures": false, "max_num_offline_eval_runner_restarts": 1000, "offline_eval_runner_restore_timeout_s": 1800.0, "max_requests_in_flight_per_offline_eval_runner": 1, "validate_offline_eval_runners_after_construction": true, "offline_eval_runner_health_probe_timeout_s": 30.0, "offline_eval_rl_module_inference_only": false, "broadcast_offline_eval_runner_states": false, "offline_eval_batch_size_per_runner": 256, "dataset_num_iters_per_eval_runner": 1, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "log_gradients": true, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 42, "restart_failed_env_runners": true, "ignore_env_runner_failures": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30.0, "env_runner_restore_timeout_s": 1800.0, "_model_config": {}, "_rl_module_spec": "RLModuleSpec(module_class=None, observation_space=None, action_space=None, inference_only=False, learner_only=False, model_config=DefaultModelConfig(fcnet_hiddens=[37, 33], fcnet_activation='tanh', fcnet_kernel_initializer=None, fcnet_kernel_initializer_kwargs=None, fcnet_bias_initializer=None, fcnet_bias_initializer_kwargs=None, conv_filters=None, conv_activation='relu', conv_kernel_initializer=None, conv_kernel_initializer_kwargs=None, conv_bias_initializer=None, conv_bias_initializer_kwargs=None, head_fcnet_hiddens=[], head_fcnet_activation='relu', head_fcnet_kernel_initializer=None, head_fcnet_kernel_initializer_kwargs=None, head_fcnet_bias_initializer=None, head_fcnet_bias_initializer_kwargs=None, free_log_std=False, log_std_clip_param=20.0, vf_share_layers=True, use_lstm=False, max_seq_len=20, lstm_cell_size=256, lstm_use_prev_action=False, lstm_use_prev_reward=False, lstm_kernel_initializer=None, lstm_kernel_initializer_kwargs=None, lstm_bias_initializer=None, lstm_bias_initializer_kwargs=None), catalog_class=None, load_state_path=None, model_config_dict=None)", "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "_validate_config": true, "_use_msgpack_checkpoints": false, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "env_task_fn": -1, "enable_connectors": -1, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2778516099996, "kl_target": 0.0287023736013, "vf_loss_coeff": 0.6675954092171, "entropy_coeff": 0.0070182010851, "clip_param": 0.2775300644704, "vf_clip_param": 0.1234717562345, "entropy_coeff_schedule": null, "lr_schedule": null, "sgd_minibatch_size": -1, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9606647579607, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.callbacks.callbacks.RLlibCallback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 10.175517797470093, "iterations_since_restore": 2, "perf": {"cpu_util_percent": 13.185714285714287, "ram_util_percent": 89.5}}
{"timers": {"training_iteration": 4.432715840899095, "restore_env_runners": 1.4985039629618768e-05, "training_step": 4.432415841319186, "env_runner_sampling_timer": 3.9271281686183492, "learner_update_timer": 0.5016496206504345, "synch_weights": 0.001440757120062608, "restore_eval_env_runners": 1.4188999898578913e-05, "evaluation_iteration": 0.7717265109901109, "synch_eval_env_connectors": 0.00045287800007372427, "synch_env_connectors": 7.709999958933623e-06}, "env_runners": {"sample": 0.03909714736470767, "module_to_env_connector": {"timers": {"connectors": {"remove_single_ts_time_rank_from_batch": 1.6196891234211303e-06, "listify_data_for_vector_env": 3.188072167082605e-05, "un_batch_to_individual_items": 1.5362215438910404e-05, "get_actions": 0.0001714706072911631, "tensor_to_numpy": 5.1189755901572124e-05, "normalize_and_clip_actions": 2.315569584971197e-05}}, "connector_pipeline_timer": 0.0003749137314295638}, "episode_len_min": 50, "num_episodes": 100.0, "num_env_steps_sampled": 5000.0, "num_agent_steps_sampled_lifetime": {"default_agent": -232500.0}, "num_episodes_lifetime": -4650.0, "env_to_module_connector": {"connector_pipeline_timer": 0.00012490545676670993, "timers": {"connectors": {"numpy_to_tensor": 3.2342238435467615e-05, "add_observations_from_episodes_to_batch": 6.61401194560777e-06, "add_time_dim_to_batch_and_zero_pad": 6.611107862587498e-06, "batch_individual_items": 1.9587162698110454e-05, "add_states_from_episodes_to_batch": 3.541781600436391e-06}}}, "num_agent_steps_sampled": {"default_agent": 5000.0}, "num_module_steps_sampled_lifetime": {"default_policy": -232500.0}, "module_episode_returns_mean": {"default_policy": 3.7}, "env_reset_timer": 0.00011556434287944743, "rlmodule_inference_timer": 0.0001370837028302047, "env_to_module_sum_episodes_length_in": 27.16809333212661, "num_module_steps_sampled": {"default_policy": 5000.0}, "episode_duration_sec_mean": 0.039317125159982425, "env_to_module_sum_episodes_length_out": 27.16809333212661, "agent_episode_returns_mean": {"default_agent": 3.7}, "episode_len_max": 50, "time_between_sampling": 0.011084856968419992, "episode_return_min": -5.5, "weights_seq_no": 2.0, "episode_return_max": 14.5, "env_step_timer": 4.5165211197914374e-05, "episode_len_mean": 50.0, "num_env_steps_sampled_lifetime": -232500.0, "episode_return_mean": 3.7, "num_env_steps_sampled_lifetime_throughput": 1234.0977974690895}, "learners": {"__all_modules__": {"num_env_steps_trained_lifetime": 244800, "num_module_steps_trained": 16000, "learner_connector": {"timers": {"connectors": {"add_time_dim_to_batch_and_zero_pad": 2.3753859930684485e-05, "batch_individual_items": 0.20955227710003257, "general_advantage_estimation": 0.014026490740136614, "add_states_from_episodes_to_batch": 6.193019917373022e-06, "numpy_to_tensor": 0.00016510228992660812, "add_observations_from_episodes_to_batch": 0.0007883360903505035, "add_columns_from_episodes_to_train_batch": 0.06992706065016424, "add_one_ts_to_episodes_and_truncate": 0.008379351050044077}}, "connector_pipeline_timer": 0.30316185137028534}, "num_trainable_parameters": 1504, "num_module_steps_trained_lifetime": 48000, "num_env_steps_trained": 81600, "num_non_trainable_parameters": 0, "learner_connector_sum_episodes_length_in": 5000.0, "learner_connector_sum_episodes_length_out": 5100.0, "num_env_steps_trained_lifetime_throughput": 939787.6418570201, "num_module_steps_trained_throughput": 185201.0570129345, "num_module_steps_trained_lifetime_throughput": 185088.07553798807}, "default_policy": {"weights_seq_no": 3.0, "vf_loss": 0.12071166187524796, "vf_loss_unclipped": 27.908855438232422, "policy_loss": -0.051600709557533264, "curr_kl_coeff": 0.03473145142197609, "total_loss": 0.02427511289715767, "num_module_steps_trained_lifetime": 48000, "entropy": 0.6749985218048096, "vf_explained_var": 0.020808696746826172, "num_trainable_parameters": 1504, "curr_entropy_coeff": 0.0070182010851, "module_train_batch_size_mean": 1000.0, "default_optimizer_learning_rate": 0.0002467453741, "gradients_default_optimizer_global_norm": 0.02429376170039177, "diff_num_grad_updates_vs_sampler_policy": 1.0, "num_module_steps_trained": 16000, "mean_kl_loss": 0.0003821436548605561, "num_module_steps_trained_lifetime_throughput": 185533.90982849724}}, "num_training_step_calls_per_iteration": 1, "evaluation": {"env_runners": {"num_env_steps_sampled_lifetime": 16000, "module_to_env_connector": {"timers": {"connectors": {"normalize_and_clip_actions": 2.2016048250639975e-05, "remove_single_ts_time_rank_from_batch": 1.4578646210727266e-06, "listify_data_for_vector_env": 3.201546064049584e-05, "un_batch_to_individual_items": 1.5803887071491025e-05, "get_actions": 0.00015650372761651682, "tensor_to_numpy": 4.553251095441405e-05}}, "connector_pipeline_timer": 0.00034651572621730844}, "num_agent_steps_sampled": {"default_agent": 1000}, "env_to_module_connector": {"timers": {"connectors": {"add_observations_from_episodes_to_batch": 6.272709228665683e-06, "add_time_dim_to_batch_and_zero_pad": 5.6129186699368955e-06, "add_states_from_episodes_to_batch": 3.398185646332892e-06, "numpy_to_tensor": 2.9362875930604804e-05, "batch_individual_items": 1.8477659905000306e-05}}, "connector_pipeline_timer": 0.00011298041989483431}, "env_to_module_sum_episodes_length_out": 27.168093332125434, "episode_return_min": -16.5, "episode_return_mean": -0.9, "episode_len_mean": 50.0, "num_agent_steps_sampled_lifetime": {"default_agent": 3000}, "sample": 0.7586684885299986, "num_episodes": 20, "num_module_steps_sampled_lifetime": {"default_policy": 3000}, "module_episode_returns_mean": {"default_policy": -0.9}, "agent_episode_returns_mean": {"default_agent": -0.9}, "env_reset_timer": 0.0003145289700256399, "rlmodule_inference_timer": 9.430487574976952e-05, "episode_len_max": 50, "episode_return_max": 17.5, "episode_len_min": 50, "num_env_steps_sampled": 1000, "num_episodes_lifetime": 60, "env_to_module_sum_episodes_length_in": 27.168093332125434, "episode_duration_sec_mean": 0.03564376199998757, "num_module_steps_sampled": {"default_policy": 1000}, "weights_seq_no": 3.0, "env_step_timer": 4.236822160068636e-05, "time_between_sampling": 4.274152447690108}, "num_healthy_workers": 1, "actor_manager_num_outstanding_async_reqs": 0, "num_remote_worker_restarts": 0}, "num_env_steps_sampled_lifetime": -232500.0, "fault_tolerance": {"num_healthy_workers": 0, "num_remote_worker_restarts": 0}, "env_runner_group": {"actor_manager_num_outstanding_async_reqs": 0}, "done": false, "training_iteration": 3, "trial_id": "401a4_00000", "date": "2025-08-11_16-46-03", "timestamp": 1754923563, "time_this_iter_s": 5.186775207519531, "time_total_s": 15.362293004989624, "pid": 41381, "hostname": "DESKTOP-3SK5A41", "node_ip": "192.168.40.242", "config": {"exploration_config": {}, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 6, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "env": "Umbrella", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": false, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 0, "create_local_env_runner": true, "num_envs_per_env_runner": 1, "gym_env_vectorize_mode": "SYNC", "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "episodes_to_numpy": true, "max_requests_in_flight_per_env_runner": 1, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "merge_env_runner_states": "training_only", "broadcast_env_runner_states": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "complete_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "sampler_perf_stats_ema_coef": null, "_is_online": true, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": "auto", "num_aggregator_actors_per_learner": 0, "max_requests_in_flight_per_aggregator_actor": 3, "local_gpu_idx": 0, "max_requests_in_flight_per_learner": 3, "gamma": 1, "lr": 0.0002467453741, "grad_clip": 0.5, "grad_clip_by": "global_norm", "_train_batch_size_per_learner": 5000, "train_batch_size": 4000, "num_epochs": 3, "minibatch_size": 1000, "shuffle_batch_per_epoch": true, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "log_std_clip_param": 20.0, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "_disable_preprocessor_api": false, "_disable_action_flattening": false}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "_learner_class": null, "callbacks_on_algorithm_init": null, "callbacks_on_env_runners_recreated": null, "callbacks_on_offline_eval_runners_recreated": null, "callbacks_on_checkpoint_loaded": null, "callbacks_on_environment_created": null, "callbacks_on_episode_created": null, "callbacks_on_episode_start": null, "callbacks_on_episode_step": null, "callbacks_on_episode_end": null, "callbacks_on_evaluate_start": null, "callbacks_on_evaluate_end": null, "callbacks_on_evaluate_offline_start": null, "callbacks_on_evaluate_offline_end": null, "callbacks_on_sample_end": null, "callbacks_on_train_result": null, "explore": true, "enable_rl_module_and_learner": true, "enable_env_runner_and_connector_v2": true, "_prior_exploration_config": {"type": "StochasticSampling"}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x72219cf82ac0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "offline_data_class": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_read_batch_size": null, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "materialize_data": false, "materialize_mapped_data": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "ignore_final_observation": false, "prelearner_class": null, "prelearner_buffer_class": null, "prelearner_buffer_kwargs": {}, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_remaining_data": false, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": 1, "evaluation_duration": 20, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_auto_duration_min_env_steps_per_sample": 100, "evaluation_auto_duration_max_env_steps_per_sample": 2000, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 1, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "offline_evaluation_interval": null, "num_offline_eval_runners": 0, "offline_loss_for_module_fn": null, "offline_evaluation_duration": 1, "offline_evaluation_parallel_to_training": false, "offline_evaluation_timeout_s": 120.0, "num_cpus_per_offline_eval_runner": 1, "num_gpus_per_offline_eval_runner": 0, "custom_resources_per_offline_eval_runner": {}, "restart_failed_offline_eval_runners": true, "ignore_offline_eval_runner_failures": false, "max_num_offline_eval_runner_restarts": 1000, "offline_eval_runner_restore_timeout_s": 1800.0, "max_requests_in_flight_per_offline_eval_runner": 1, "validate_offline_eval_runners_after_construction": true, "offline_eval_runner_health_probe_timeout_s": 30.0, "offline_eval_rl_module_inference_only": false, "broadcast_offline_eval_runner_states": false, "offline_eval_batch_size_per_runner": 256, "dataset_num_iters_per_eval_runner": 1, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "log_gradients": true, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 42, "restart_failed_env_runners": true, "ignore_env_runner_failures": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30.0, "env_runner_restore_timeout_s": 1800.0, "_model_config": {}, "_rl_module_spec": "RLModuleSpec(module_class=None, observation_space=None, action_space=None, inference_only=False, learner_only=False, model_config=DefaultModelConfig(fcnet_hiddens=[37, 33], fcnet_activation='tanh', fcnet_kernel_initializer=None, fcnet_kernel_initializer_kwargs=None, fcnet_bias_initializer=None, fcnet_bias_initializer_kwargs=None, conv_filters=None, conv_activation='relu', conv_kernel_initializer=None, conv_kernel_initializer_kwargs=None, conv_bias_initializer=None, conv_bias_initializer_kwargs=None, head_fcnet_hiddens=[], head_fcnet_activation='relu', head_fcnet_kernel_initializer=None, head_fcnet_kernel_initializer_kwargs=None, head_fcnet_bias_initializer=None, head_fcnet_bias_initializer_kwargs=None, free_log_std=False, log_std_clip_param=20.0, vf_share_layers=True, use_lstm=False, max_seq_len=20, lstm_cell_size=256, lstm_use_prev_action=False, lstm_use_prev_reward=False, lstm_kernel_initializer=None, lstm_kernel_initializer_kwargs=None, lstm_bias_initializer=None, lstm_bias_initializer_kwargs=None), catalog_class=None, load_state_path=None, model_config_dict=None)", "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "_validate_config": true, "_use_msgpack_checkpoints": false, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "env_task_fn": -1, "enable_connectors": -1, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2778516099996, "kl_target": 0.0287023736013, "vf_loss_coeff": 0.6675954092171, "entropy_coeff": 0.0070182010851, "clip_param": 0.2775300644704, "vf_clip_param": 0.1234717562345, "entropy_coeff_schedule": null, "lr_schedule": null, "sgd_minibatch_size": -1, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9606647579607, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.callbacks.callbacks.RLlibCallback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 15.362293004989624, "iterations_since_restore": 3, "perf": {"cpu_util_percent": 12.7625, "ram_util_percent": 89.55}}
{"timers": {"training_iteration": 4.432290984610105, "restore_env_runners": 1.4968189231963606e-05, "training_step": 4.431990322025992, "env_runner_sampling_timer": 3.9278292050521646, "learner_update_timer": 0.5005224424439315, "synch_weights": 0.001440329548860792, "restore_eval_env_runners": 1.418410989685981e-05, "evaluation_iteration": 0.7714069249102101, "synch_eval_env_connectors": 0.00045290622007501045, "synch_env_connectors": 7.695899957025177e-06}, "env_runners": {"sample": 0.039436068728625685, "module_to_env_connector": {"timers": {"connectors": {"remove_single_ts_time_rank_from_batch": 1.584602023001413e-06, "listify_data_for_vector_env": 3.1701691378547844e-05, "un_batch_to_individual_items": 1.5026938519423055e-05, "get_actions": 0.00016896918837488298, "tensor_to_numpy": 5.0367111412963444e-05, "normalize_and_clip_actions": 2.3003877076238e-05}}, "connector_pipeline_timer": 0.00036974489767283876}, "episode_len_min": 50, "num_episodes": 100.0, "num_env_steps_sampled": 5000.0, "num_agent_steps_sampled_lifetime": {"default_agent": -475000.0}, "num_episodes_lifetime": -9500.0, "env_to_module_connector": {"connector_pipeline_timer": 0.00012335715610988459, "timers": {"connectors": {"numpy_to_tensor": 3.1891793503535425e-05, "add_observations_from_episodes_to_batch": 6.426317313787437e-06, "add_time_dim_to_batch_and_zero_pad": 6.484937220751117e-06, "batch_individual_items": 1.9325760285763097e-05, "add_states_from_episodes_to_batch": 3.532898987258373e-06}}}, "num_agent_steps_sampled": {"default_agent": 5000.0}, "num_module_steps_sampled_lifetime": {"default_policy": -475000.0}, "module_episode_returns_mean": {"default_policy": 4.100000000000001}, "env_reset_timer": 0.00010461785779710074, "rlmodule_inference_timer": 9.994680915048668e-05, "env_to_module_sum_episodes_length_in": 27.16809333212661, "num_module_steps_sampled": {"default_policy": 5000.0}, "episode_duration_sec_mean": 0.037318579120010326, "env_to_module_sum_episodes_length_out": 27.16809333212661, "agent_episode_returns_mean": {"default_agent": 4.100000000000001}, "episode_len_max": 50, "time_between_sampling": 0.011556505017906614, "episode_return_min": -5.5, "weights_seq_no": 3.0, "episode_return_max": 14.5, "env_step_timer": 4.458021614982716e-05, "episode_len_mean": 50.0, "num_env_steps_sampled_lifetime": -475000.0, "episode_return_mean": 4.100000000000001, "num_env_steps_sampled_lifetime_throughput": 1242.979272390596}, "learners": {"__all_modules__": {"num_env_steps_trained_lifetime": 326400, "num_module_steps_trained": 16000, "learner_connector": {"timers": {"connectors": {"add_time_dim_to_batch_and_zero_pad": 2.375232133214604e-05, "batch_individual_items": 0.20960719632902963, "general_advantage_estimation": 0.013979979832734782, "add_states_from_episodes_to_batch": 6.200089716092408e-06, "numpy_to_tensor": 0.000165133267024687, "add_observations_from_episodes_to_batch": 0.000787691729443842, "add_columns_from_episodes_to_train_batch": 0.06990102004366475, "add_one_ts_to_episodes_and_truncate": 0.008379119539543437}}, "connector_pipeline_timer": 0.3031439978565831}, "num_trainable_parameters": 1504, "num_module_steps_trained_lifetime": 64000, "num_env_steps_trained": 81600, "num_non_trainable_parameters": 0, "learner_connector_sum_episodes_length_in": 5000.0, "learner_connector_sum_episodes_length_out": 5100.0, "num_env_steps_trained_lifetime_throughput": 939291.8894440874, "num_module_steps_trained_throughput": 185065.4397198843, "num_module_steps_trained_lifetime_throughput": 184954.26322949087}, "default_policy": {"weights_seq_no": 4.0, "vf_loss": 0.12107490003108978, "vf_loss_unclipped": 28.07969093322754, "policy_loss": -0.0024550845846533775, "curr_kl_coeff": 0.017365725710988045, "total_loss": 0.07364001125097275, "num_module_steps_trained_lifetime": 64000, "entropy": 0.6745952367782593, "vf_explained_var": 0.022068917751312256, "num_trainable_parameters": 1504, "curr_entropy_coeff": 0.0070182010851, "module_train_batch_size_mean": 1000.0, "default_optimizer_learning_rate": 0.0002467453741, "gradients_default_optimizer_global_norm": 0.062429141253232956, "diff_num_grad_updates_vs_sampler_policy": 1.0, "num_module_steps_trained": 16000, "mean_kl_loss": 1.4072166777623352e-05, "num_module_steps_trained_lifetime_throughput": 185380.7355196212}}, "num_training_step_calls_per_iteration": 1, "evaluation": {"env_runners": {"num_env_steps_sampled_lifetime": 21000, "module_to_env_connector": {"timers": {"connectors": {"normalize_and_clip_actions": 2.1974597175614717e-05, "remove_single_ts_time_rank_from_batch": 1.6855936114608622e-06, "listify_data_for_vector_env": 3.131248036944135e-05, "un_batch_to_individual_items": 1.617969549036867e-05, "get_actions": 0.00015783310401905134, "tensor_to_numpy": 4.5452539674875295e-05}}, "connector_pipeline_timer": 0.0003471815453169125}, "num_agent_steps_sampled": {"default_agent": 1000}, "env_to_module_connector": {"timers": {"connectors": {"add_observations_from_episodes_to_batch": 6.298636299652457e-06, "add_time_dim_to_batch_and_zero_pad": 5.652463231188281e-06, "add_states_from_episodes_to_batch": 3.441619958953027e-06, "numpy_to_tensor": 2.9467440189803944e-05, "batch_individual_items": 1.8460585317206053e-05}}, "connector_pipeline_timer": 0.00011326481172249085}, "env_to_module_sum_episodes_length_out": 27.168093332126602, "episode_return_min": -16.5, "episode_return_mean": -0.4, "episode_len_mean": 50.0, "num_agent_steps_sampled_lifetime": {"default_agent": 4000}, "sample": 0.7583735076546978, "num_episodes": 20, "num_module_steps_sampled_lifetime": {"default_policy": 4000}, "module_episode_returns_mean": {"default_policy": -0.4}, "agent_episode_returns_mean": {"default_agent": -0.4}, "env_reset_timer": 0.00031273068032755335, "rlmodule_inference_timer": 9.458862368829531e-05, "episode_len_max": 50, "episode_return_max": 17.5, "episode_len_min": 50, "num_env_steps_sampled": 1000, "num_episodes_lifetime": 80, "env_to_module_sum_episodes_length_in": 27.168093332126602, "episode_duration_sec_mean": 0.035496947762487706, "num_module_steps_sampled": {"default_policy": 1000}, "weights_seq_no": 4.0, "env_step_timer": 4.209758607956639e-05, "time_between_sampling": 4.275870791333205}, "num_healthy_workers": 1, "actor_manager_num_outstanding_async_reqs": 0, "num_remote_worker_restarts": 0}, "num_env_steps_sampled_lifetime": -475000.0, "fault_tolerance": {"num_healthy_workers": 0, "num_remote_worker_restarts": 0}, "env_runner_group": {"actor_manager_num_outstanding_async_reqs": 0}, "done": false, "training_iteration": 4, "trial_id": "401a4_00000", "date": "2025-08-11_16-46-09", "timestamp": 1754923569, "time_this_iter_s": 5.1341493129730225, "time_total_s": 20.496442317962646, "pid": 41381, "hostname": "DESKTOP-3SK5A41", "node_ip": "192.168.40.242", "config": {"exploration_config": {}, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 6, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "env": "Umbrella", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": false, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 0, "create_local_env_runner": true, "num_envs_per_env_runner": 1, "gym_env_vectorize_mode": "SYNC", "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "episodes_to_numpy": true, "max_requests_in_flight_per_env_runner": 1, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "merge_env_runner_states": "training_only", "broadcast_env_runner_states": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "complete_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "sampler_perf_stats_ema_coef": null, "_is_online": true, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": "auto", "num_aggregator_actors_per_learner": 0, "max_requests_in_flight_per_aggregator_actor": 3, "local_gpu_idx": 0, "max_requests_in_flight_per_learner": 3, "gamma": 1, "lr": 0.0002467453741, "grad_clip": 0.5, "grad_clip_by": "global_norm", "_train_batch_size_per_learner": 5000, "train_batch_size": 4000, "num_epochs": 3, "minibatch_size": 1000, "shuffle_batch_per_epoch": true, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "log_std_clip_param": 20.0, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "_disable_preprocessor_api": false, "_disable_action_flattening": false}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "_learner_class": null, "callbacks_on_algorithm_init": null, "callbacks_on_env_runners_recreated": null, "callbacks_on_offline_eval_runners_recreated": null, "callbacks_on_checkpoint_loaded": null, "callbacks_on_environment_created": null, "callbacks_on_episode_created": null, "callbacks_on_episode_start": null, "callbacks_on_episode_step": null, "callbacks_on_episode_end": null, "callbacks_on_evaluate_start": null, "callbacks_on_evaluate_end": null, "callbacks_on_evaluate_offline_start": null, "callbacks_on_evaluate_offline_end": null, "callbacks_on_sample_end": null, "callbacks_on_train_result": null, "explore": true, "enable_rl_module_and_learner": true, "enable_env_runner_and_connector_v2": true, "_prior_exploration_config": {"type": "StochasticSampling"}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x72219cf82ac0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "offline_data_class": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_read_batch_size": null, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "materialize_data": false, "materialize_mapped_data": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "ignore_final_observation": false, "prelearner_class": null, "prelearner_buffer_class": null, "prelearner_buffer_kwargs": {}, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_remaining_data": false, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": 1, "evaluation_duration": 20, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_auto_duration_min_env_steps_per_sample": 100, "evaluation_auto_duration_max_env_steps_per_sample": 2000, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 1, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "offline_evaluation_interval": null, "num_offline_eval_runners": 0, "offline_loss_for_module_fn": null, "offline_evaluation_duration": 1, "offline_evaluation_parallel_to_training": false, "offline_evaluation_timeout_s": 120.0, "num_cpus_per_offline_eval_runner": 1, "num_gpus_per_offline_eval_runner": 0, "custom_resources_per_offline_eval_runner": {}, "restart_failed_offline_eval_runners": true, "ignore_offline_eval_runner_failures": false, "max_num_offline_eval_runner_restarts": 1000, "offline_eval_runner_restore_timeout_s": 1800.0, "max_requests_in_flight_per_offline_eval_runner": 1, "validate_offline_eval_runners_after_construction": true, "offline_eval_runner_health_probe_timeout_s": 30.0, "offline_eval_rl_module_inference_only": false, "broadcast_offline_eval_runner_states": false, "offline_eval_batch_size_per_runner": 256, "dataset_num_iters_per_eval_runner": 1, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "log_gradients": true, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 42, "restart_failed_env_runners": true, "ignore_env_runner_failures": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30.0, "env_runner_restore_timeout_s": 1800.0, "_model_config": {}, "_rl_module_spec": "RLModuleSpec(module_class=None, observation_space=None, action_space=None, inference_only=False, learner_only=False, model_config=DefaultModelConfig(fcnet_hiddens=[37, 33], fcnet_activation='tanh', fcnet_kernel_initializer=None, fcnet_kernel_initializer_kwargs=None, fcnet_bias_initializer=None, fcnet_bias_initializer_kwargs=None, conv_filters=None, conv_activation='relu', conv_kernel_initializer=None, conv_kernel_initializer_kwargs=None, conv_bias_initializer=None, conv_bias_initializer_kwargs=None, head_fcnet_hiddens=[], head_fcnet_activation='relu', head_fcnet_kernel_initializer=None, head_fcnet_kernel_initializer_kwargs=None, head_fcnet_bias_initializer=None, head_fcnet_bias_initializer_kwargs=None, free_log_std=False, log_std_clip_param=20.0, vf_share_layers=True, use_lstm=False, max_seq_len=20, lstm_cell_size=256, lstm_use_prev_action=False, lstm_use_prev_reward=False, lstm_kernel_initializer=None, lstm_kernel_initializer_kwargs=None, lstm_bias_initializer=None, lstm_bias_initializer_kwargs=None), catalog_class=None, load_state_path=None, model_config_dict=None)", "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "_validate_config": true, "_use_msgpack_checkpoints": false, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "env_task_fn": -1, "enable_connectors": -1, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2778516099996, "kl_target": 0.0287023736013, "vf_loss_coeff": 0.6675954092171, "entropy_coeff": 0.0070182010851, "clip_param": 0.2775300644704, "vf_clip_param": 0.1234717562345, "entropy_coeff_schedule": null, "lr_schedule": null, "sgd_minibatch_size": -1, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9606647579607, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.callbacks.callbacks.RLlibCallback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 20.496442317962646, "iterations_since_restore": 4, "perf": {"cpu_util_percent": 13.342857142857143, "ram_util_percent": 89.52857142857144}}
{"timers": {"training_iteration": 4.429696031804006, "restore_env_runners": 1.494950733669843e-05, "training_step": 4.4293942028457325, "env_runner_sampling_timer": 3.927844585041646, "learner_update_timer": 0.497908775019493, "synch_weights": 0.0014406132533702324, "restore_eval_env_runners": 1.4193268797168913e-05, "evaluation_iteration": 0.7710857256711067, "synch_eval_env_connectors": 0.0004524001578755856, "synch_env_connectors": 7.69294095704072e-06}, "env_runners": {"sample": 0.03848449647670376, "module_to_env_connector": {"timers": {"connectors": {"remove_single_ts_time_rank_from_batch": 1.5609219317857666e-06, "listify_data_for_vector_env": 3.0966307704057676e-05, "un_batch_to_individual_items": 1.4941101709824304e-05, "get_actions": 0.00016567219742297134, "tensor_to_numpy": 4.965954519750206e-05, "normalize_and_clip_actions": 2.259989647224612e-05}}, "connector_pipeline_timer": 0.0003633563077246967}, "episode_len_min": 50, "num_episodes": 100.0, "num_env_steps_sampled": 5000.0, "num_agent_steps_sampled_lifetime": {"default_agent": -717500.0}, "num_episodes_lifetime": -14350.0, "env_to_module_connector": {"connector_pipeline_timer": 0.00012075225850183925, "timers": {"connectors": {"numpy_to_tensor": 3.130814794352285e-05, "add_observations_from_episodes_to_batch": 6.402743672863658e-06, "add_time_dim_to_batch_and_zero_pad": 6.315793898146439e-06, "batch_individual_items": 1.8775407437188435e-05, "add_states_from_episodes_to_batch": 3.3941378765106266e-06}}}, "num_agent_steps_sampled": {"default_agent": 5000.0}, "num_module_steps_sampled_lifetime": {"default_policy": -717500.0}, "module_episode_returns_mean": {"default_policy": 3.7}, "env_reset_timer": 0.0001008378828406663, "rlmodule_inference_timer": 9.800185439446482e-05, "env_to_module_sum_episodes_length_in": 27.16809333212661, "num_module_steps_sampled": {"default_policy": 5000.0}, "episode_duration_sec_mean": 0.036663512039990576, "env_to_module_sum_episodes_length_out": 27.16809333212661, "agent_episode_returns_mean": {"default_agent": 3.7}, "episode_len_max": 50, "time_between_sampling": 0.012673957287831742, "episode_return_min": -5.5, "weights_seq_no": 4.0, "episode_return_max": 14.5, "env_step_timer": 4.363866635685952e-05, "episode_len_mean": 50.0, "num_env_steps_sampled_lifetime": -717500.0, "episode_return_mean": 3.7, "num_env_steps_sampled_lifetime_throughput": 1271.3892054312325}, "learners": {"__all_modules__": {"num_env_steps_trained_lifetime": 408000, "num_module_steps_trained": 16000, "learner_connector": {"timers": {"connectors": {"add_time_dim_to_batch_and_zero_pad": 2.373979812223555e-05, "batch_individual_items": 0.2081269063657392, "general_advantage_estimation": 0.013941597034403652, "add_states_from_episodes_to_batch": 6.191088822321963e-06, "numpy_to_tensor": 0.00016513893435696414, "add_observations_from_episodes_to_batch": 0.0007864558121493487, "add_columns_from_episodes_to_train_batch": 0.06987603984322822, "add_one_ts_to_episodes_and_truncate": 0.008377943344149172}}, "connector_pipeline_timer": 0.30159834687801573}, "num_trainable_parameters": 1504, "num_module_steps_trained_lifetime": 80000, "num_env_steps_trained": 81600, "num_non_trainable_parameters": 0, "learner_connector_sum_episodes_length_in": 5000.0, "learner_connector_sum_episodes_length_out": 5100.0, "num_env_steps_trained_lifetime_throughput": 938034.102387455, "num_module_steps_trained_throughput": 184776.92565892046, "num_module_steps_trained_lifetime_throughput": 184668.793886294}, "default_policy": {"weights_seq_no": 5.0, "vf_loss": 0.12083230167627335, "vf_loss_unclipped": 27.034221649169922, "policy_loss": -0.04551533982157707, "curr_kl_coeff": 0.008682862855494022, "total_loss": 0.030401501804590225, "num_module_steps_trained_lifetime": 80000, "entropy": 0.6772094368934631, "vf_explained_var": 0.022914648056030273, "num_trainable_parameters": 1504, "curr_entropy_coeff": 0.0070182010851, "module_train_batch_size_mean": 1000.0, "default_optimizer_learning_rate": 0.0002467453741, "gradients_default_optimizer_global_norm": 0.03429725393652916, "diff_num_grad_updates_vs_sampler_policy": 1.0, "num_module_steps_trained": 16000, "mean_kl_loss": 0.0001464330416638404, "num_module_steps_trained_lifetime_throughput": 185073.87424115345}}, "num_training_step_calls_per_iteration": 1, "evaluation": {"env_runners": {"num_env_steps_sampled_lifetime": 26000, "module_to_env_connector": {"timers": {"connectors": {"normalize_and_clip_actions": 2.18055719455134e-05, "remove_single_ts_time_rank_from_batch": 1.4703019029987967e-06, "listify_data_for_vector_env": 3.105188342393147e-05, "un_batch_to_individual_items": 1.6215620712803727e-05, "get_actions": 0.00015828949780977462, "tensor_to_numpy": 4.673877680313248e-05}}, "connector_pipeline_timer": 0.00034872498617501043}, "num_agent_steps_sampled": {"default_agent": 1000}, "env_to_module_connector": {"timers": {"connectors": {"add_observations_from_episodes_to_batch": 5.952872788390777e-06, "add_time_dim_to_batch_and_zero_pad": 6.006104575630711e-06, "add_states_from_episodes_to_batch": 3.5047238187680788e-06, "numpy_to_tensor": 2.931593346346471e-05, "batch_individual_items": 1.839132449729005e-05}}, "connector_pipeline_timer": 0.00011226739953409828}, "env_to_module_sum_episodes_length_out": 27.168093332126602, "episode_return_min": -16.5, "episode_return_mean": 0.1, "episode_len_mean": 50.0, "num_agent_steps_sampled_lifetime": {"default_agent": 5000}, "sample": 0.758201928588151, "num_episodes": 20, "num_module_steps_sampled_lifetime": {"default_policy": 5000}, "module_episode_returns_mean": {"default_policy": 0.1}, "agent_episode_returns_mean": {"default_agent": 0.1}, "env_reset_timer": 0.00031123337352584676, "rlmodule_inference_timer": 9.588071869100577e-05, "episode_len_max": 50, "episode_return_max": 17.5, "episode_len_min": 50, "num_env_steps_sampled": 1000, "num_episodes_lifetime": 100, "env_to_module_sum_episodes_length_in": 27.168093332126602, "episode_duration_sec_mean": 0.03552040521998606, "num_module_steps_sampled": {"default_policy": 1000}, "weights_seq_no": 5.0, "env_step_timer": 4.291139828654034e-05, "time_between_sampling": 4.275427956459874}, "num_healthy_workers": 1, "actor_manager_num_outstanding_async_reqs": 0, "num_remote_worker_restarts": 0}, "num_env_steps_sampled_lifetime": -717500.0, "fault_tolerance": {"num_healthy_workers": 0, "num_remote_worker_restarts": 0}, "env_runner_group": {"actor_manager_num_outstanding_async_reqs": 0}, "done": false, "training_iteration": 5, "trial_id": "401a4_00000", "date": "2025-08-11_16-46-14", "timestamp": 1754923574, "time_this_iter_s": 4.928875923156738, "time_total_s": 25.425318241119385, "pid": 41381, "hostname": "DESKTOP-3SK5A41", "node_ip": "192.168.40.242", "config": {"exploration_config": {}, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 6, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "env": "Umbrella", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": false, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 0, "create_local_env_runner": true, "num_envs_per_env_runner": 1, "gym_env_vectorize_mode": "SYNC", "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "episodes_to_numpy": true, "max_requests_in_flight_per_env_runner": 1, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "merge_env_runner_states": "training_only", "broadcast_env_runner_states": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "complete_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "sampler_perf_stats_ema_coef": null, "_is_online": true, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": "auto", "num_aggregator_actors_per_learner": 0, "max_requests_in_flight_per_aggregator_actor": 3, "local_gpu_idx": 0, "max_requests_in_flight_per_learner": 3, "gamma": 1, "lr": 0.0002467453741, "grad_clip": 0.5, "grad_clip_by": "global_norm", "_train_batch_size_per_learner": 5000, "train_batch_size": 4000, "num_epochs": 3, "minibatch_size": 1000, "shuffle_batch_per_epoch": true, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "log_std_clip_param": 20.0, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "_disable_preprocessor_api": false, "_disable_action_flattening": false}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "_learner_class": null, "callbacks_on_algorithm_init": null, "callbacks_on_env_runners_recreated": null, "callbacks_on_offline_eval_runners_recreated": null, "callbacks_on_checkpoint_loaded": null, "callbacks_on_environment_created": null, "callbacks_on_episode_created": null, "callbacks_on_episode_start": null, "callbacks_on_episode_step": null, "callbacks_on_episode_end": null, "callbacks_on_evaluate_start": null, "callbacks_on_evaluate_end": null, "callbacks_on_evaluate_offline_start": null, "callbacks_on_evaluate_offline_end": null, "callbacks_on_sample_end": null, "callbacks_on_train_result": null, "explore": true, "enable_rl_module_and_learner": true, "enable_env_runner_and_connector_v2": true, "_prior_exploration_config": {"type": "StochasticSampling"}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x72219cf82ac0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "offline_data_class": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_read_batch_size": null, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "materialize_data": false, "materialize_mapped_data": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "ignore_final_observation": false, "prelearner_class": null, "prelearner_buffer_class": null, "prelearner_buffer_kwargs": {}, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_remaining_data": false, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": 1, "evaluation_duration": 20, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_auto_duration_min_env_steps_per_sample": 100, "evaluation_auto_duration_max_env_steps_per_sample": 2000, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 1, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "offline_evaluation_interval": null, "num_offline_eval_runners": 0, "offline_loss_for_module_fn": null, "offline_evaluation_duration": 1, "offline_evaluation_parallel_to_training": false, "offline_evaluation_timeout_s": 120.0, "num_cpus_per_offline_eval_runner": 1, "num_gpus_per_offline_eval_runner": 0, "custom_resources_per_offline_eval_runner": {}, "restart_failed_offline_eval_runners": true, "ignore_offline_eval_runner_failures": false, "max_num_offline_eval_runner_restarts": 1000, "offline_eval_runner_restore_timeout_s": 1800.0, "max_requests_in_flight_per_offline_eval_runner": 1, "validate_offline_eval_runners_after_construction": true, "offline_eval_runner_health_probe_timeout_s": 30.0, "offline_eval_rl_module_inference_only": false, "broadcast_offline_eval_runner_states": false, "offline_eval_batch_size_per_runner": 256, "dataset_num_iters_per_eval_runner": 1, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "log_gradients": true, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 42, "restart_failed_env_runners": true, "ignore_env_runner_failures": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30.0, "env_runner_restore_timeout_s": 1800.0, "_model_config": {}, "_rl_module_spec": "RLModuleSpec(module_class=None, observation_space=None, action_space=None, inference_only=False, learner_only=False, model_config=DefaultModelConfig(fcnet_hiddens=[37, 33], fcnet_activation='tanh', fcnet_kernel_initializer=None, fcnet_kernel_initializer_kwargs=None, fcnet_bias_initializer=None, fcnet_bias_initializer_kwargs=None, conv_filters=None, conv_activation='relu', conv_kernel_initializer=None, conv_kernel_initializer_kwargs=None, conv_bias_initializer=None, conv_bias_initializer_kwargs=None, head_fcnet_hiddens=[], head_fcnet_activation='relu', head_fcnet_kernel_initializer=None, head_fcnet_kernel_initializer_kwargs=None, head_fcnet_bias_initializer=None, head_fcnet_bias_initializer_kwargs=None, free_log_std=False, log_std_clip_param=20.0, vf_share_layers=True, use_lstm=False, max_seq_len=20, lstm_cell_size=256, lstm_use_prev_action=False, lstm_use_prev_reward=False, lstm_kernel_initializer=None, lstm_kernel_initializer_kwargs=None, lstm_bias_initializer=None, lstm_bias_initializer_kwargs=None), catalog_class=None, load_state_path=None, model_config_dict=None)", "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "_validate_config": true, "_use_msgpack_checkpoints": false, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "env_task_fn": -1, "enable_connectors": -1, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2778516099996, "kl_target": 0.0287023736013, "vf_loss_coeff": 0.6675954092171, "entropy_coeff": 0.0070182010851, "clip_param": 0.2775300644704, "vf_clip_param": 0.1234717562345, "entropy_coeff_schedule": null, "lr_schedule": null, "sgd_minibatch_size": -1, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9606647579607, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.callbacks.callbacks.RLlibCallback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 25.425318241119385, "iterations_since_restore": 5, "perf": {"cpu_util_percent": 13.028571428571428, "ram_util_percent": 89.5}}
{"timers": {"training_iteration": 4.429248918495968, "restore_env_runners": 1.4934012265039492e-05, "training_step": 4.428944671827275, "env_runner_sampling_timer": 3.92855205220123, "learner_update_timer": 0.4967505322692982, "synch_weights": 0.0014405401208356994, "restore_eval_env_runners": 1.416833610878814e-05, "evaluation_iteration": 0.7708903184243963, "synch_eval_env_connectors": 0.00045266815629655457, "synch_env_connectors": 7.671011547899884e-06}, "env_runners": {"sample": 0.03824212846967605, "module_to_env_connector": {"timers": {"connectors": {"remove_single_ts_time_rank_from_batch": 1.5870657867685464e-06, "listify_data_for_vector_env": 3.137385490392147e-05, "un_batch_to_individual_items": 1.5182577289388874e-05, "get_actions": 0.00016906727668493775, "tensor_to_numpy": 5.051891577084148e-05, "normalize_and_clip_actions": 2.3149294641544668e-05}}, "connector_pipeline_timer": 0.0003699059676355228}, "episode_len_min": 50, "num_episodes": 100.0, "num_env_steps_sampled": 5000.0, "num_agent_steps_sampled_lifetime": {"default_agent": -960000.0}, "num_episodes_lifetime": -19200.0, "env_to_module_connector": {"connector_pipeline_timer": 0.00012297993370897277, "timers": {"connectors": {"numpy_to_tensor": 3.192156195365513e-05, "add_observations_from_episodes_to_batch": 6.495986495381773e-06, "add_time_dim_to_batch_and_zero_pad": 6.4919430363089285e-06, "batch_individual_items": 1.9218816008674275e-05, "add_states_from_episodes_to_batch": 3.5045359611995114e-06}}}, "num_agent_steps_sampled": {"default_agent": 5000.0}, "num_module_steps_sampled_lifetime": {"default_policy": -960000.0}, "module_episode_returns_mean": {"default_policy": 3.7}, "env_reset_timer": 9.947354396686104e-05, "rlmodule_inference_timer": 0.00010003649483194844, "env_to_module_sum_episodes_length_in": 27.16809333212661, "num_module_steps_sampled": {"default_policy": 5000.0}, "episode_duration_sec_mean": 0.037336586009987516, "env_to_module_sum_episodes_length_out": 27.16809333212661, "agent_episode_returns_mean": {"default_agent": 3.7}, "episode_len_max": 50, "time_between_sampling": 0.012195170376305867, "episode_return_min": -5.5, "weights_seq_no": 5.0, "episode_return_max": 14.5, "env_step_timer": 4.450708240295388e-05, "episode_len_mean": 50.0, "num_env_steps_sampled_lifetime": -960000.0, "episode_return_mean": 3.7, "num_env_steps_sampled_lifetime_throughput": 1257.6391760034574}, "learners": {"__all_modules__": {"num_env_steps_trained_lifetime": 489600, "num_module_steps_trained": 16000, "learner_connector": {"timers": {"connectors": {"add_time_dim_to_batch_and_zero_pad": 2.3720400141144916e-05, "batch_individual_items": 0.20812484130207876, "general_advantage_estimation": 0.013899846064062577, "add_states_from_episodes_to_batch": 6.1821779329417506e-06, "numpy_to_tensor": 0.00016583754501314565, "add_observations_from_episodes_to_batch": 0.0007857542540235264, "add_columns_from_episodes_to_train_batch": 0.06986308744479885, "add_one_ts_to_episodes_and_truncate": 0.008377752910708436}}, "connector_pipeline_timer": 0.30154133040923514}, "num_trainable_parameters": 1504, "num_module_steps_trained_lifetime": 96000, "num_env_steps_trained": 81600, "num_non_trainable_parameters": 0, "learner_connector_sum_episodes_length_in": 5000.0, "learner_connector_sum_episodes_length_out": 5100.0, "num_env_steps_trained_lifetime_throughput": 938348.3123537248, "num_module_steps_trained_throughput": 184799.2763758896, "num_module_steps_trained_lifetime_throughput": 184693.28752952637}, "default_policy": {"weights_seq_no": 6.0, "vf_loss": 0.1207575872540474, "vf_loss_unclipped": 26.0220947265625, "policy_loss": -0.022864636033773422, "curr_kl_coeff": 0.004341431427747011, "total_loss": 0.053021300584077835, "num_module_steps_trained_lifetime": 96000, "entropy": 0.6743215918540955, "vf_explained_var": 0.024693310260772705, "num_trainable_parameters": 1504, "curr_entropy_coeff": 0.0070182010851, "module_train_batch_size_mean": 1000.0, "default_optimizer_learning_rate": 0.0002467453741, "gradients_default_optimizer_global_norm": 0.022518817335367203, "diff_num_grad_updates_vs_sampler_policy": 1.0, "num_module_steps_trained": 16000, "mean_kl_loss": 0.00014322921924758703, "num_module_steps_trained_lifetime_throughput": 185079.1331994748}}, "num_training_step_calls_per_iteration": 1, "evaluation": {"env_runners": {"num_env_steps_sampled_lifetime": 31000, "module_to_env_connector": {"timers": {"connectors": {"normalize_and_clip_actions": 2.296509521487547e-05, "remove_single_ts_time_rank_from_batch": 1.5155310186945291e-06, "listify_data_for_vector_env": 3.144462914555985e-05, "un_batch_to_individual_items": 1.5855960871793664e-05, "get_actions": 0.00016052048847457824, "tensor_to_numpy": 4.6538454206368975e-05}}, "connector_pipeline_timer": 0.0003528909618480607}, "num_agent_steps_sampled": {"default_agent": 1000}, "env_to_module_connector": {"timers": {"connectors": {"add_observations_from_episodes_to_batch": 6.285992084072381e-06, "add_time_dim_to_batch_and_zero_pad": 6.106172183728555e-06, "add_states_from_episodes_to_batch": 3.6150776479362224e-06, "numpy_to_tensor": 2.9795536196735364e-05, "batch_individual_items": 1.8898158431338748e-05}}, "connector_pipeline_timer": 0.00011479606483496341}, "env_to_module_sum_episodes_length_out": 27.168093332126602, "episode_return_min": -16.5, "episode_return_mean": 0.7, "episode_len_mean": 50.0, "num_agent_steps_sampled_lifetime": {"default_agent": 6000}, "sample": 0.7579652963022698, "num_episodes": 20, "num_module_steps_sampled_lifetime": {"default_policy": 6000}, "module_episode_returns_mean": {"default_policy": 0.7}, "agent_episode_returns_mean": {"default_agent": 0.7}, "env_reset_timer": 0.00030935503979179283, "rlmodule_inference_timer": 9.673997477502784e-05, "episode_len_max": 50, "episode_return_max": 17.5, "episode_len_min": 50, "num_env_steps_sampled": 1000, "num_episodes_lifetime": 120, "env_to_module_sum_episodes_length_in": 27.168093332126602, "episode_duration_sec_mean": 0.03528807712998969, "num_module_steps_sampled": {"default_policy": 1000}, "weights_seq_no": 6.0, "env_step_timer": 4.462070774052968e-05, "time_between_sampling": 4.277056366905272}, "num_healthy_workers": 1, "actor_manager_num_outstanding_async_reqs": 0, "num_remote_worker_restarts": 0}, "num_env_steps_sampled_lifetime": -960000.0, "fault_tolerance": {"num_healthy_workers": 0, "num_remote_worker_restarts": 0}, "env_runner_group": {"actor_manager_num_outstanding_async_reqs": 0}, "done": false, "training_iteration": 6, "trial_id": "401a4_00000", "date": "2025-08-11_16-46-19", "timestamp": 1754923579, "time_this_iter_s": 5.134013414382935, "time_total_s": 30.55933165550232, "pid": 41381, "hostname": "DESKTOP-3SK5A41", "node_ip": "192.168.40.242", "config": {"exploration_config": {}, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 6, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "env": "Umbrella", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": false, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 0, "create_local_env_runner": true, "num_envs_per_env_runner": 1, "gym_env_vectorize_mode": "SYNC", "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "episodes_to_numpy": true, "max_requests_in_flight_per_env_runner": 1, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "merge_env_runner_states": "training_only", "broadcast_env_runner_states": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "complete_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "sampler_perf_stats_ema_coef": null, "_is_online": true, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": "auto", "num_aggregator_actors_per_learner": 0, "max_requests_in_flight_per_aggregator_actor": 3, "local_gpu_idx": 0, "max_requests_in_flight_per_learner": 3, "gamma": 1, "lr": 0.0002467453741, "grad_clip": 0.5, "grad_clip_by": "global_norm", "_train_batch_size_per_learner": 5000, "train_batch_size": 4000, "num_epochs": 3, "minibatch_size": 1000, "shuffle_batch_per_epoch": true, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "log_std_clip_param": 20.0, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "_disable_preprocessor_api": false, "_disable_action_flattening": false}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "_learner_class": null, "callbacks_on_algorithm_init": null, "callbacks_on_env_runners_recreated": null, "callbacks_on_offline_eval_runners_recreated": null, "callbacks_on_checkpoint_loaded": null, "callbacks_on_environment_created": null, "callbacks_on_episode_created": null, "callbacks_on_episode_start": null, "callbacks_on_episode_step": null, "callbacks_on_episode_end": null, "callbacks_on_evaluate_start": null, "callbacks_on_evaluate_end": null, "callbacks_on_evaluate_offline_start": null, "callbacks_on_evaluate_offline_end": null, "callbacks_on_sample_end": null, "callbacks_on_train_result": null, "explore": true, "enable_rl_module_and_learner": true, "enable_env_runner_and_connector_v2": true, "_prior_exploration_config": {"type": "StochasticSampling"}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x72219cf82ac0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "offline_data_class": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_read_batch_size": null, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "materialize_data": false, "materialize_mapped_data": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "ignore_final_observation": false, "prelearner_class": null, "prelearner_buffer_class": null, "prelearner_buffer_kwargs": {}, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_remaining_data": false, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": 1, "evaluation_duration": 20, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_auto_duration_min_env_steps_per_sample": 100, "evaluation_auto_duration_max_env_steps_per_sample": 2000, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 1, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "offline_evaluation_interval": null, "num_offline_eval_runners": 0, "offline_loss_for_module_fn": null, "offline_evaluation_duration": 1, "offline_evaluation_parallel_to_training": false, "offline_evaluation_timeout_s": 120.0, "num_cpus_per_offline_eval_runner": 1, "num_gpus_per_offline_eval_runner": 0, "custom_resources_per_offline_eval_runner": {}, "restart_failed_offline_eval_runners": true, "ignore_offline_eval_runner_failures": false, "max_num_offline_eval_runner_restarts": 1000, "offline_eval_runner_restore_timeout_s": 1800.0, "max_requests_in_flight_per_offline_eval_runner": 1, "validate_offline_eval_runners_after_construction": true, "offline_eval_runner_health_probe_timeout_s": 30.0, "offline_eval_rl_module_inference_only": false, "broadcast_offline_eval_runner_states": false, "offline_eval_batch_size_per_runner": 256, "dataset_num_iters_per_eval_runner": 1, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "log_gradients": true, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 42, "restart_failed_env_runners": true, "ignore_env_runner_failures": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30.0, "env_runner_restore_timeout_s": 1800.0, "_model_config": {}, "_rl_module_spec": "RLModuleSpec(module_class=None, observation_space=None, action_space=None, inference_only=False, learner_only=False, model_config=DefaultModelConfig(fcnet_hiddens=[37, 33], fcnet_activation='tanh', fcnet_kernel_initializer=None, fcnet_kernel_initializer_kwargs=None, fcnet_bias_initializer=None, fcnet_bias_initializer_kwargs=None, conv_filters=None, conv_activation='relu', conv_kernel_initializer=None, conv_kernel_initializer_kwargs=None, conv_bias_initializer=None, conv_bias_initializer_kwargs=None, head_fcnet_hiddens=[], head_fcnet_activation='relu', head_fcnet_kernel_initializer=None, head_fcnet_kernel_initializer_kwargs=None, head_fcnet_bias_initializer=None, head_fcnet_bias_initializer_kwargs=None, free_log_std=False, log_std_clip_param=20.0, vf_share_layers=True, use_lstm=False, max_seq_len=20, lstm_cell_size=256, lstm_use_prev_action=False, lstm_use_prev_reward=False, lstm_kernel_initializer=None, lstm_kernel_initializer_kwargs=None, lstm_bias_initializer=None, lstm_bias_initializer_kwargs=None), catalog_class=None, load_state_path=None, model_config_dict=None)", "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "_validate_config": true, "_use_msgpack_checkpoints": false, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "env_task_fn": -1, "enable_connectors": -1, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2778516099996, "kl_target": 0.0287023736013, "vf_loss_coeff": 0.6675954092171, "entropy_coeff": 0.0070182010851, "clip_param": 0.2775300644704, "vf_clip_param": 0.1234717562345, "entropy_coeff_schedule": null, "lr_schedule": null, "sgd_minibatch_size": -1, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9606647579607, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.callbacks.callbacks.RLlibCallback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 30.55933165550232, "iterations_since_restore": 6, "perf": {"cpu_util_percent": 12.985714285714286, "ram_util_percent": 89.48571428571428}}
{"timers": {"training_iteration": 4.427725446311008, "restore_env_runners": 1.4899672140393448e-05, "training_step": 4.427420797109001, "env_runner_sampling_timer": 3.929746693679221, "learner_update_timer": 0.49403356994660536, "synch_weights": 0.0014395517196274601, "restore_eval_env_runners": 1.4133652743905817e-05, "evaluation_iteration": 0.7706277562401521, "synch_eval_env_connectors": 0.00045339747473305183, "synch_env_connectors": 7.650301431370004e-06}, "env_runners": {"sample": 0.03861040178748512, "module_to_env_connector": {"timers": {"connectors": {"remove_single_ts_time_rank_from_batch": 1.628314652826375e-06, "listify_data_for_vector_env": 3.2010221848374205e-05, "un_batch_to_individual_items": 1.5199454553155918e-05, "get_actions": 0.00017114429018540988, "tensor_to_numpy": 5.083079492008469e-05, "normalize_and_clip_actions": 2.3270998467236244e-05}}, "connector_pipeline_timer": 0.000373930625474084}, "episode_len_min": 50, "num_episodes": 100.0, "num_env_steps_sampled": 5000.0, "num_agent_steps_sampled_lifetime": {"default_agent": -1202500.0}, "num_episodes_lifetime": -24050.0, "env_to_module_connector": {"connector_pipeline_timer": 0.00012483621263916132, "timers": {"connectors": {"numpy_to_tensor": 3.2515669795463684e-05, "add_observations_from_episodes_to_batch": 6.678136830771929e-06, "add_time_dim_to_batch_and_zero_pad": 6.6837124145789474e-06, "batch_individual_items": 1.938527555061143e-05, "add_states_from_episodes_to_batch": 3.5305642389415523e-06}}}, "num_agent_steps_sampled": {"default_agent": 5000.0}, "num_module_steps_sampled_lifetime": {"default_policy": -1202500.0}, "module_episode_returns_mean": {"default_policy": 3.100000000000002}, "env_reset_timer": 0.00010122593444683228, "rlmodule_inference_timer": 0.00010100305027753145, "env_to_module_sum_episodes_length_in": 27.16809333212661, "num_module_steps_sampled": {"default_policy": 5000.0}, "episode_duration_sec_mean": 0.037761930000015126, "env_to_module_sum_episodes_length_out": 27.16809333212661, "agent_episode_returns_mean": {"default_agent": 3.100000000000002}, "episode_len_max": 50, "time_between_sampling": 0.012932413473355225, "episode_return_min": -5.5, "weights_seq_no": 6.0, "episode_return_max": 14.5, "env_step_timer": 4.517302621378068e-05, "episode_len_mean": 50.0, "num_env_steps_sampled_lifetime": -1202500.0, "episode_return_mean": 3.100000000000002, "num_env_steps_sampled_lifetime_throughput": 1234.9861069135065}, "learners": {"__all_modules__": {"num_env_steps_trained_lifetime": 571200, "num_module_steps_trained": 16000, "learner_connector": {"timers": {"connectors": {"add_time_dim_to_batch_and_zero_pad": 2.369219613954685e-05, "batch_individual_items": 0.20664895988905627, "general_advantage_estimation": 0.013851497603423866, "add_states_from_episodes_to_batch": 6.178356154148018e-06, "numpy_to_tensor": 0.00016630716956400797, "add_observations_from_episodes_to_batch": 0.0007850987114803419, "add_columns_from_episodes_to_train_batch": 0.06983928757034749, "add_one_ts_to_episodes_and_truncate": 0.008377175381600476}}, "connector_pipeline_timer": 0.29999181010514697}, "num_trainable_parameters": 1504, "num_module_steps_trained_lifetime": 112000, "num_env_steps_trained": 81600, "num_non_trainable_parameters": 0, "learner_connector_sum_episodes_length_in": 5000.0, "learner_connector_sum_episodes_length_out": 5100.0, "num_env_steps_trained_lifetime_throughput": 941070.6595649864, "num_module_steps_trained_throughput": 185297.90745372098, "num_module_steps_trained_lifetime_throughput": 185193.357683572}, "default_policy": {"weights_seq_no": 7.0, "vf_loss": 0.12051153182983398, "vf_loss_unclipped": 25.064149856567383, "policy_loss": -0.03610551729798317, "curr_kl_coeff": 0.0021707157138735056, "total_loss": 0.03963245451450348, "num_module_steps_trained_lifetime": 112000, "entropy": 0.6718912720680237, "vf_explained_var": 0.025511622428894043, "num_trainable_parameters": 1504, "curr_entropy_coeff": 0.0070182010851, "module_train_batch_size_mean": 1000.0, "default_optimizer_learning_rate": 0.0002467453741, "gradients_default_optimizer_global_norm": 0.052337173372507095, "diff_num_grad_updates_vs_sampler_policy": 1.0, "num_module_steps_trained": 16000, "mean_kl_loss": 0.00011053834168706089, "num_module_steps_trained_lifetime_throughput": 185560.68147212593}}, "num_training_step_calls_per_iteration": 1, "evaluation": {"env_runners": {"num_env_steps_sampled_lifetime": 36000, "module_to_env_connector": {"timers": {"connectors": {"normalize_and_clip_actions": 2.2467678595028822e-05, "remove_single_ts_time_rank_from_batch": 1.4433762783097747e-06, "listify_data_for_vector_env": 3.047747475794939e-05, "un_batch_to_individual_items": 1.5930713512970063e-05, "get_actions": 0.00015398983321474033, "tensor_to_numpy": 4.443654319108821e-05}}, "connector_pipeline_timer": 0.00034068755935741184}, "num_agent_steps_sampled": {"default_agent": 1000}, "env_to_module_connector": {"timers": {"connectors": {"add_observations_from_episodes_to_batch": 6.0263905402924775e-06, "add_time_dim_to_batch_and_zero_pad": 5.515585846738814e-06, "add_states_from_episodes_to_batch": 3.3409936304633976e-06, "numpy_to_tensor": 2.9086365742905816e-05, "batch_individual_items": 1.865884617672999e-05}}, "connector_pipeline_timer": 0.00011123099804643229}, "env_to_module_sum_episodes_length_out": 27.168093332126602, "episode_return_min": -16.5, "episode_return_mean": 1.7, "episode_len_mean": 50.0, "num_agent_steps_sampled_lifetime": {"default_agent": 7000}, "sample": 0.757661519339246, "num_episodes": 20, "num_module_steps_sampled_lifetime": {"default_policy": 7000}, "module_episode_returns_mean": {"default_policy": 1.7}, "agent_episode_returns_mean": {"default_agent": 1.7}, "env_reset_timer": 0.000307906489391427, "rlmodule_inference_timer": 9.461277789601523e-05, "episode_len_max": 50, "episode_return_max": 17.5, "episode_len_min": 50, "num_env_steps_sampled": 1000, "num_episodes_lifetime": 140, "env_to_module_sum_episodes_length_in": 27.168093332126602, "episode_duration_sec_mean": 0.03519664404999276, "num_module_steps_sampled": {"default_policy": 1000}, "weights_seq_no": 7.0, "env_step_timer": 4.212684055410808e-05, "time_between_sampling": 4.277651546236219}, "num_healthy_workers": 1, "actor_manager_num_outstanding_async_reqs": 0, "num_remote_worker_restarts": 0}, "num_env_steps_sampled_lifetime": -1202500.0, "fault_tolerance": {"num_healthy_workers": 0, "num_remote_worker_restarts": 0}, "env_runner_group": {"actor_manager_num_outstanding_async_reqs": 0}, "done": true, "training_iteration": 7, "trial_id": "401a4_00000", "date": "2025-08-11_16-46-24", "timestamp": 1754923584, "time_this_iter_s": 5.0184485912323, "time_total_s": 35.57778024673462, "pid": 41381, "hostname": "DESKTOP-3SK5A41", "node_ip": "192.168.40.242", "config": {"exploration_config": {}, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 6, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "env": "Umbrella", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": false, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 0, "create_local_env_runner": true, "num_envs_per_env_runner": 1, "gym_env_vectorize_mode": "SYNC", "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "episodes_to_numpy": true, "max_requests_in_flight_per_env_runner": 1, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "merge_env_runner_states": "training_only", "broadcast_env_runner_states": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "complete_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "sampler_perf_stats_ema_coef": null, "_is_online": true, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": "auto", "num_aggregator_actors_per_learner": 0, "max_requests_in_flight_per_aggregator_actor": 3, "local_gpu_idx": 0, "max_requests_in_flight_per_learner": 3, "gamma": 1, "lr": 0.0002467453741, "grad_clip": 0.5, "grad_clip_by": "global_norm", "_train_batch_size_per_learner": 5000, "train_batch_size": 4000, "num_epochs": 3, "minibatch_size": 1000, "shuffle_batch_per_epoch": true, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "log_std_clip_param": 20.0, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "_disable_preprocessor_api": false, "_disable_action_flattening": false}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "_learner_class": null, "callbacks_on_algorithm_init": null, "callbacks_on_env_runners_recreated": null, "callbacks_on_offline_eval_runners_recreated": null, "callbacks_on_checkpoint_loaded": null, "callbacks_on_environment_created": null, "callbacks_on_episode_created": null, "callbacks_on_episode_start": null, "callbacks_on_episode_step": null, "callbacks_on_episode_end": null, "callbacks_on_evaluate_start": null, "callbacks_on_evaluate_end": null, "callbacks_on_evaluate_offline_start": null, "callbacks_on_evaluate_offline_end": null, "callbacks_on_sample_end": null, "callbacks_on_train_result": null, "explore": true, "enable_rl_module_and_learner": true, "enable_env_runner_and_connector_v2": true, "_prior_exploration_config": {"type": "StochasticSampling"}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x72219cf82ac0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "offline_data_class": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_read_batch_size": null, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "materialize_data": false, "materialize_mapped_data": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "ignore_final_observation": false, "prelearner_class": null, "prelearner_buffer_class": null, "prelearner_buffer_kwargs": {}, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_remaining_data": false, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": 1, "evaluation_duration": 20, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_auto_duration_min_env_steps_per_sample": 100, "evaluation_auto_duration_max_env_steps_per_sample": 2000, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 1, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "offline_evaluation_interval": null, "num_offline_eval_runners": 0, "offline_loss_for_module_fn": null, "offline_evaluation_duration": 1, "offline_evaluation_parallel_to_training": false, "offline_evaluation_timeout_s": 120.0, "num_cpus_per_offline_eval_runner": 1, "num_gpus_per_offline_eval_runner": 0, "custom_resources_per_offline_eval_runner": {}, "restart_failed_offline_eval_runners": true, "ignore_offline_eval_runner_failures": false, "max_num_offline_eval_runner_restarts": 1000, "offline_eval_runner_restore_timeout_s": 1800.0, "max_requests_in_flight_per_offline_eval_runner": 1, "validate_offline_eval_runners_after_construction": true, "offline_eval_runner_health_probe_timeout_s": 30.0, "offline_eval_rl_module_inference_only": false, "broadcast_offline_eval_runner_states": false, "offline_eval_batch_size_per_runner": 256, "dataset_num_iters_per_eval_runner": 1, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "log_gradients": true, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 42, "restart_failed_env_runners": true, "ignore_env_runner_failures": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30.0, "env_runner_restore_timeout_s": 1800.0, "_model_config": {}, "_rl_module_spec": "RLModuleSpec(module_class=None, observation_space=None, action_space=None, inference_only=False, learner_only=False, model_config=DefaultModelConfig(fcnet_hiddens=[37, 33], fcnet_activation='tanh', fcnet_kernel_initializer=None, fcnet_kernel_initializer_kwargs=None, fcnet_bias_initializer=None, fcnet_bias_initializer_kwargs=None, conv_filters=None, conv_activation='relu', conv_kernel_initializer=None, conv_kernel_initializer_kwargs=None, conv_bias_initializer=None, conv_bias_initializer_kwargs=None, head_fcnet_hiddens=[], head_fcnet_activation='relu', head_fcnet_kernel_initializer=None, head_fcnet_kernel_initializer_kwargs=None, head_fcnet_bias_initializer=None, head_fcnet_bias_initializer_kwargs=None, free_log_std=False, log_std_clip_param=20.0, vf_share_layers=True, use_lstm=False, max_seq_len=20, lstm_cell_size=256, lstm_use_prev_action=False, lstm_use_prev_reward=False, lstm_kernel_initializer=None, lstm_kernel_initializer_kwargs=None, lstm_bias_initializer=None, lstm_bias_initializer_kwargs=None), catalog_class=None, load_state_path=None, model_config_dict=None)", "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "_validate_config": true, "_use_msgpack_checkpoints": false, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "env_task_fn": -1, "enable_connectors": -1, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2778516099996, "kl_target": 0.0287023736013, "vf_loss_coeff": 0.6675954092171, "entropy_coeff": 0.0070182010851, "clip_param": 0.2775300644704, "vf_clip_param": 0.1234717562345, "entropy_coeff_schedule": null, "lr_schedule": null, "sgd_minibatch_size": -1, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9606647579607, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.callbacks.callbacks.RLlibCallback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 35.57778024673462, "iterations_since_restore": 7, "perf": {"cpu_util_percent": 18.585714285714285, "ram_util_percent": 88.12857142857142}}
