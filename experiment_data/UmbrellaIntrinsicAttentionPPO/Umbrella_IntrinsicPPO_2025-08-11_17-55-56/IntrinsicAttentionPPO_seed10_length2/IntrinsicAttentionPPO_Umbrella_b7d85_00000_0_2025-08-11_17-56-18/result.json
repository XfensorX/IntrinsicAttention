{"timers": {"training_iteration": 12.008823583018966, "restore_env_runners": 1.4666933566331863e-05, "training_step": 12.00862425006926, "env_runner_sampling_timer": 1.6090109589276835, "learner_update_timer": 10.190734458970837, "synch_weights": 0.0016616249922662973}, "env_runners": {"rlmodule_inference_timer": 3.586475163489724e-05, "module_to_env_connector": {"timers": {"connectors": {"listify_data_for_vector_env": 1.0503281209159184e-05, "un_batch_to_individual_items": 6.603806933702125e-06, "get_actions": 4.533137144035796e-05, "remove_single_ts_time_rank_from_batch": 1.215820606870048e-05, "tensor_to_numpy": 1.5712037786497192e-05, "normalize_and_clip_actions": 1.0162488032773596e-05}}, "connector_pipeline_timer": 0.0001272500817734369}, "module_episode_returns_mean": {"default_policy": -1.2200000000000002}, "episode_len_mean": 20.0, "episode_return_min": -10.5, "num_env_steps_sampled": 5000.0, "episode_return_max": 9.5, "env_to_module_sum_episodes_length_in": 10.191744832559449, "num_agent_steps_sampled": {"default_agent": 5000.0}, "episode_len_min": 20, "env_to_module_connector": {"connector_pipeline_timer": 6.202446790208092e-05, "timers": {"connectors": {"add_states_from_episodes_to_batch": 2.7375853541597905e-06, "batch_individual_items": 1.247038074593922e-05, "numpy_to_tensor": 1.3061680730113923e-05, "add_time_dim_to_batch_and_zero_pad": 7.152715661417907e-06, "add_observations_from_episodes_to_batch": 2.9451967330863987e-06}}}, "episode_len_max": 20, "num_episodes_lifetime": 31375.0, "env_step_timer": 1.447473870283694e-05, "env_reset_timer": 7.986464660897491e-05, "weights_seq_no": 0.0, "episode_return_mean": -1.2200000000000002, "num_module_steps_sampled": {"default_policy": 5000.0}, "time_between_sampling": 0.0006592078897245048, "num_env_steps_sampled_lifetime": 627500.0, "agent_episode_returns_mean": {"default_agent": -1.2200000000000002}, "sample": 0.006336621770814402, "num_agent_steps_sampled_lifetime": {"default_agent": 627500.0}, "env_to_module_sum_episodes_length_out": 10.191744832559449, "episode_duration_sec_mean": 0.005240040158852933, "num_module_steps_sampled_lifetime": {"default_policy": 627500.0}, "num_episodes": 250.0, "num_env_steps_sampled_lifetime_throughput": 3095.4746637194344}, "__all_modules__": {"learner_connector_sum_episodes_length_in": 5000, "learner_connector": {"connector_pipeline_timer": 0.1706844159634784, "timers": {"connectors": {"add_one_ts_to_episodes_and_truncate": 0.0090785410720855, "add_observations_from_episodes_to_batch": 0.0008839169749990106, "add_columns_from_episodes_to_train_batch": 0.04174470796715468, "add_time_dim_to_batch_and_zero_pad": 0.10270029096864164, "add_states_from_episodes_to_batch": 0.0034417909337207675, "batch_individual_items": 0.012635207967832685, "numpy_to_tensor": 6.104097701609135e-05}}}, "learner_connector_sum_episodes_length_out": 5250}, "learners": {"default_policy": {"num_module_steps_trained": 5994, "curr_kl_coeff": 0.08079196512699127, "num_module_steps_trained_lifetime": 5994, "num_trainable_parameters": 16595, "diff_num_grad_updates_vs_sampler_policy": 1.0, "weights_seq_no": 1.0, "use_intrinsic_rewards": 0.0, "total_loss": 0.20458640158176422, "vf_loss": 0.2640724182128906, "mean_kl_loss": 4.236697350279428e-06, "vf_loss_unclipped": 38.342002868652344, "curr_entropy_coeff": 0.0015431216992, "policy_loss": -7.101288792910054e-05, "entropy": 0.6928334832191467, "vf_explained_var": -0.0002963542938232422, "module_train_batch_size_mean": 999.0, "num_module_steps_trained_lifetime_throughput": 655.668004622461}, "intrinsic_reward_module": {"default_optimizer_learning_rate": 0.0002715581955, "num_module_steps_trained_lifetime": 5994, "num_trainable_parameters": 8266, "diff_num_grad_updates_vs_sampler_policy": 1.0, "total_loss": 0.0, "weights_seq_no": 1.0, "curr_entropy_coeff": 0.0015431216992, "module_train_batch_size_mean": 999.0, "num_module_steps_trained": 5994, "gradients_default_optimizer_global_norm": 0.0, "num_module_steps_trained_lifetime_throughput": 655.6797065794467}, "__all_modules__": {"num_env_steps_trained": 31500, "num_non_trainable_parameters": 0, "num_module_steps_trained": 11988, "num_env_steps_trained_lifetime": 31500, "num_module_steps_trained_lifetime": 11988, "num_trainable_parameters": 24861, "num_env_steps_trained_lifetime_throughput": 3445.784862954566, "num_module_steps_trained_throughput": 32348886.52280817, "num_module_steps_trained_lifetime_throughput": 13151291.589377474}, "differentiable_learners": {"intrinsic_attention_ppo_learner": {"default_policy": {"use_intrinsic_rewards": 1.0, "vf_loss": 0.2661822736263275, "vf_loss_unclipped": 38.332794189453125, "policy_loss": -6.794553337385878e-05, "num_module_steps_trained": 35964, "entropy": 0.6928340792655945, "vf_explained_var": 0.0006704330444335938, "module_train_batch_size_mean": 999.0, "num_module_steps_trained_lifetime": 35964, "total_loss": 0.2062331885099411, "diff_num_grad_updates_vs_sampler_policy": 6.0, "mean_kl_loss": 4.070301656611264e-06, "weights_seq_no": 6.0}, "__all_modules__": {"num_env_steps_trained": 189000, "num_module_steps_trained": 71928, "num_env_steps_trained_lifetime": 189000, "num_module_steps_trained_lifetime": 71928, "num_env_steps_trained_lifetime_throughput": 49531.871229341545}, "intrinsic_reward_module": {"num_module_steps_trained": 35964, "module_train_batch_size_mean": 999.0, "num_module_steps_trained_lifetime": 35964, "total_loss": 0.0, "diff_num_grad_updates_vs_sampler_policy": 6.0, "weights_seq_no": 6.0}}}, "IntrinsicAttentionMask": [[[0.333563894033432, 0.33311280608177185, 0.33332329988479614], [0.3338854908943176, 0.3328053653240204, 0.333309143781662], [0.3337353467941284, 0.33294886350631714, 0.33331578969955444]], [[0.3333032429218292, 0.33342838287353516, 0.33326834440231323], [0.33336129784584045, 0.33324486017227173, 0.33339381217956543], [0.3332870304584503, 0.3334796130657196, 0.3332332968711853]], [[0.3331693112850189, 0.33321335911750793, 0.33361729979515076], [0.3331868350505829, 0.33322617411613464, 0.3335869610309601], [0.3333473801612854, 0.33334359526634216, 0.3333090543746948]], [[0.33330076932907104, 0.3333454430103302, 0.333353728055954], [0.3334006369113922, 0.33330821990966797, 0.33329111337661743], [0.33341914415359497, 0.3333013355731964, 0.3332795202732086]], [[0.33319759368896484, 0.3331684470176697, 0.33363401889801025], [0.3331756889820099, 0.3331418037414551, 0.3336825370788574], [0.3335250914096832, 0.3335663378238678, 0.33290866017341614]], [[0.3332620859146118, 0.33350029587745667, 0.33323755860328674], [0.33558744192123413, 0.3280377984046936, 0.3363747298717499], [0.33302098512649536, 0.33406540751457214, 0.3329136073589325]]]}, "num_training_step_calls_per_iteration": 1, "num_env_steps_sampled_lifetime": 627500.0, "evaluation": {"env_runners": {"module_episode_returns_mean": {"default_policy": -0.55}, "num_env_steps_sampled_lifetime": 5400, "sample": 0.1289839589735493, "num_episodes": 20, "env_to_module_connector": {"timers": {"connectors": {"batch_individual_items": 1.3249086374341319e-05, "numpy_to_tensor": 1.3852425448716717e-05, "add_time_dim_to_batch_and_zero_pad": 8.496582820332754e-06, "add_states_from_episodes_to_batch": 2.8064450864006604e-06, "add_observations_from_episodes_to_batch": 3.5927373637118965e-06}}, "connector_pipeline_timer": 6.821488165926332e-05}, "episode_return_min": -12.5, "num_agent_steps_sampled_lifetime": {"default_agent": 400}, "episode_return_mean": -0.55, "module_to_env_connector": {"timers": {"connectors": {"remove_single_ts_time_rank_from_batch": 1.3122396904898263e-05, "un_batch_to_individual_items": 6.748207634351553e-06, "listify_data_for_vector_env": 1.0652816806666972e-05, "get_actions": 4.767760973892662e-05, "tensor_to_numpy": 1.8024303213325256e-05, "normalize_and_clip_actions": 9.367883146267261e-06}}, "connector_pipeline_timer": 0.00013240242487138894}, "episode_duration_sec_mean": 0.00581229156232439, "num_env_steps_sampled": 400, "episode_return_max": 13.5, "env_to_module_sum_episodes_length_in": 10.216013141322508, "num_episodes_lifetime": 20, "env_to_module_sum_episodes_length_out": 10.216013141322508, "num_agent_steps_sampled": {"default_agent": 400}, "episode_len_mean": 20.0, "episode_len_min": 20, "agent_episode_returns_mean": {"default_agent": -0.55}, "num_module_steps_sampled_lifetime": {"default_policy": 400}, "env_reset_timer": 0.0007324159378185868, "rlmodule_inference_timer": 3.85462882702194e-05, "num_module_steps_sampled": {"default_policy": 400}, "episode_len_max": 20, "env_step_timer": 1.586305482068336e-05, "weights_seq_no": 1.0}, "num_healthy_workers": 1, "actor_manager_num_outstanding_async_reqs": 0, "num_remote_worker_restarts": 0}, "fault_tolerance": {"num_healthy_workers": 0, "num_remote_worker_restarts": 0}, "env_runner_group": {"actor_manager_num_outstanding_async_reqs": 0}, "done": false, "training_iteration": 1, "trial_id": "b7d85_00000", "date": "2025-08-11_18-00-19", "timestamp": 1754928019, "time_this_iter_s": 12.153176069259644, "time_total_s": 12.153176069259644, "pid": 10036, "hostname": "Mac", "node_ip": "127.0.0.1", "config": {"exploration_config": {}, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 2, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "env": "Umbrella", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": false, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 0, "create_local_env_runner": true, "num_envs_per_env_runner": 1, "gym_env_vectorize_mode": "SYNC", "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "episodes_to_numpy": true, "max_requests_in_flight_per_env_runner": 1, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "merge_env_runner_states": "training_only", "broadcast_env_runner_states": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "complete_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "sampler_perf_stats_ema_coef": null, "_is_online": true, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": "auto", "num_aggregator_actors_per_learner": 0, "max_requests_in_flight_per_aggregator_actor": 3, "local_gpu_idx": 0, "max_requests_in_flight_per_learner": 3, "gamma": 1, "lr": 0.0002715581955, "grad_clip": 0.5, "grad_clip_by": "global_norm", "_train_batch_size_per_learner": 5000, "train_batch_size": 4000, "num_epochs": 1, "minibatch_size": 1000, "shuffle_batch_per_epoch": true, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "log_std_clip_param": 20.0, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "_disable_preprocessor_api": false, "_disable_action_flattening": false}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {"intrinsic_reward_coeff": 0.2795015916508}, "optimizer": {}, "_learner_class": "<class 'source.intrinsic_attention_ppo.learners.IntrinsicAttentionMetaLearner.IntrinsicAttentionMetaLearner'>", "callbacks_on_algorithm_init": null, "callbacks_on_env_runners_recreated": null, "callbacks_on_offline_eval_runners_recreated": null, "callbacks_on_checkpoint_loaded": null, "callbacks_on_environment_created": null, "callbacks_on_episode_created": null, "callbacks_on_episode_start": null, "callbacks_on_episode_step": null, "callbacks_on_episode_end": null, "callbacks_on_evaluate_start": null, "callbacks_on_evaluate_end": null, "callbacks_on_evaluate_offline_start": null, "callbacks_on_evaluate_offline_end": null, "callbacks_on_sample_end": null, "callbacks_on_train_result": null, "explore": true, "enable_rl_module_and_learner": true, "enable_env_runner_and_connector_v2": true, "_prior_exploration_config": {"type": "StochasticSampling"}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x155e4d8a0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "offline_data_class": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_read_batch_size": null, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "materialize_data": false, "materialize_mapped_data": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "ignore_final_observation": false, "prelearner_class": null, "prelearner_buffer_class": null, "prelearner_buffer_kwargs": {}, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_remaining_data": false, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": 1, "evaluation_duration": 20, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_auto_duration_min_env_steps_per_sample": 100, "evaluation_auto_duration_max_env_steps_per_sample": 2000, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 1, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "offline_evaluation_interval": null, "num_offline_eval_runners": 0, "offline_loss_for_module_fn": null, "offline_evaluation_duration": 1, "offline_evaluation_parallel_to_training": false, "offline_evaluation_timeout_s": 120.0, "num_cpus_per_offline_eval_runner": 1, "num_gpus_per_offline_eval_runner": 0, "custom_resources_per_offline_eval_runner": {}, "restart_failed_offline_eval_runners": true, "ignore_offline_eval_runner_failures": false, "max_num_offline_eval_runner_restarts": 1000, "offline_eval_runner_restore_timeout_s": 1800.0, "max_requests_in_flight_per_offline_eval_runner": 1, "validate_offline_eval_runners_after_construction": true, "offline_eval_runner_health_probe_timeout_s": 30.0, "offline_eval_rl_module_inference_only": false, "broadcast_offline_eval_runner_states": false, "offline_eval_batch_size_per_runner": 256, "dataset_num_iters_per_eval_runner": 1, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "log_gradients": false, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 10, "restart_failed_env_runners": true, "ignore_env_runner_failures": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30.0, "env_runner_restore_timeout_s": 1800.0, "_model_config": {}, "_rl_module_spec": "MultiRLModuleSpec(multi_rl_module_class=<class 'ray.rllib.core.rl_module.multi_rl_module.MultiRLModule'>, observation_space=None, action_space=None, inference_only=False, model_config=None, rl_module_specs={'default_policy': RLModuleSpec(module_class=<class 'source.intrinsic_attention_ppo.rl_modules.DifferentiablePPOModule.DifferentiablePPOModule'>, observation_space=None, action_space=None, inference_only=False, learner_only=False, model_config={'vf_share_layers': True, 'embedding_dim': 62, 'max_seq_len': 3, 'policy_head_hidden_sizes': [32], 'value_head_hidden_sizes': [101], 'embedding_hidden_sizes': [121]}, catalog_class=None, load_state_path=None, model_config_dict=None), 'intrinsic_reward_module': RLModuleSpec(module_class=<class 'source.intrinsic_attention_ppo.rl_modules.IntrinsicAttentionModule.IntrinsicAttentionModule'>, observation_space=None, action_space=None, inference_only=False, learner_only=True, model_config={'intrinsic_reward_network': {'encoder_hidden_sizes': [], 'encoding_dim': 1, 'num_heads': 1, 'head_hidden_sizes': None, 'layers': [{'type': 'attention'}]}, 'extrinsic_value_hidden_layers': [127, 60], 'vf_share_layers': True, 'max_seq_len': 3}, catalog_class=None, load_state_path=None, model_config_dict=None)}, load_state_path=None, modules_to_load=None, module_specs={'default_policy': RLModuleSpec(module_class=<class 'source.intrinsic_attention_ppo.rl_modules.DifferentiablePPOModule.DifferentiablePPOModule'>, observation_space=None, action_space=None, inference_only=False, learner_only=False, model_config={'vf_share_layers': True, 'embedding_dim': 62, 'max_seq_len': 3, 'policy_head_hidden_sizes': [32], 'value_head_hidden_sizes': [101], 'embedding_hidden_sizes': [121]}, catalog_class=None, load_state_path=None, model_config_dict=None), 'intrinsic_reward_module': RLModuleSpec(module_class=<class 'source.intrinsic_attention_ppo.rl_modules.IntrinsicAttentionModule.IntrinsicAttentionModule'>, observation_space=None, action_space=None, inference_only=False, learner_only=True, model_config={'intrinsic_reward_network': {'encoder_hidden_sizes': [], 'encoding_dim': 1, 'num_heads': 1, 'head_hidden_sizes': None, 'layers': [{'type': 'attention'}]}, 'extrinsic_value_hidden_layers': [127, 60], 'vf_share_layers': True, 'max_seq_len': 3}, catalog_class=None, load_state_path=None, model_config_dict=None)})", "algorithm_config_overrides_per_module": {"intrinsic_reward_module": {"lr": 0.0002715581955}}, "_per_module_overrides": {}, "_validate_config": true, "_use_msgpack_checkpoints": false, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "env_task_fn": -1, "enable_connectors": -1, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.161583927863, "kl_target": 0.0201019014258, "vf_loss_coeff": 0.7790510010087, "entropy_coeff": 0.0015431216992, "clip_param": 0.2459212356676, "vf_clip_param": 0.3769744131561, "entropy_coeff_schedule": null, "lr_schedule": null, "sgd_minibatch_size": -1, "vf_share_layers": -1, "differentiable_learner_configs": ["DifferentiableLearnerConfig(learner_class=<class 'source.intrinsic_attention_ppo.learners.IntrinsicAttentionPPOLearner.IntrinsicAttentionPPOLearner'>, learner_connector=None, add_default_connectors_to_learner_pipeline=True, is_multi_agent=False, policies_to_update=['default_policy'], lr=0.0060984166342, num_total_minibatches=0, num_epochs=1, minibatch_size=1000, shuffle_batch_per_epoch=True)"], "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9485408017724, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.callbacks.callbacks.RLlibCallback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 12.153176069259644, "iterations_since_restore": 1, "perf": {"cpu_util_percent": 44.87777777777778, "ram_util_percent": 80.5}}
{"timers": {"training_iteration": 11.999347445938037, "restore_env_runners": 1.4590674545615912e-05, "training_step": 11.999147177148844, "env_runner_sampling_timer": 1.6090812876680864, "learner_update_timer": 10.179371708541876, "synch_weights": 0.0016820529126562178, "restore_eval_env_runners": 4.837499000132084e-05, "evaluation_iteration": 0.1417280409950763, "synch_eval_env_connectors": 0.0002491660416126251, "synch_env_connectors": 4.083034582436085e-06}, "env_runners": {"rlmodule_inference_timer": 3.4176362077650597e-05, "module_to_env_connector": {"timers": {"connectors": {"listify_data_for_vector_env": 1.077904225820754e-05, "un_batch_to_individual_items": 6.750520860344187e-06, "get_actions": 4.25902178855335e-05, "remove_single_ts_time_rank_from_batch": 1.2459801800550347e-05, "tensor_to_numpy": 1.636518174473939e-05, "normalize_and_clip_actions": 8.34245894369089e-06}}, "connector_pipeline_timer": 0.00012476563670906534}, "module_episode_returns_mean": {"default_policy": -0.17999999999999997}, "episode_len_mean": 20.0, "episode_return_min": -10.5, "num_env_steps_sampled": 5000.0, "episode_return_max": 9.5, "env_to_module_sum_episodes_length_in": 10.36823839457432, "num_agent_steps_sampled": {"default_agent": 5000.0}, "episode_len_min": 20, "env_to_module_connector": {"connector_pipeline_timer": 6.156643779297433e-05, "timers": {"connectors": {"add_states_from_episodes_to_batch": 2.8310505533576715e-06, "batch_individual_items": 1.2769672077643137e-05, "numpy_to_tensor": 1.3161387531418197e-05, "add_time_dim_to_batch_and_zero_pad": 7.25779379902061e-06, "add_observations_from_episodes_to_batch": 2.9115012192381203e-06}}}, "episode_len_max": 20, "num_episodes_lifetime": 500.0, "env_step_timer": 1.4571855010267819e-05, "env_reset_timer": 4.7751736161532264e-05, "weights_seq_no": 1.0, "episode_return_mean": -0.17999999999999997, "num_module_steps_sampled": {"default_policy": 5000.0}, "time_between_sampling": 0.039674332683998816, "num_env_steps_sampled_lifetime": 10000.0, "agent_episode_returns_mean": {"default_agent": -0.17999999999999997}, "sample": 0.005908912126910352, "num_agent_steps_sampled_lifetime": {"default_agent": 10000.0}, "env_to_module_sum_episodes_length_out": 10.36823839457432, "episode_duration_sec_mean": 0.005538204025477175, "num_module_steps_sampled_lifetime": {"default_policy": 10000.0}, "num_episodes": 250.0, "num_env_steps_sampled_lifetime_throughput": 3110.625948840467}, "__all_modules__": {"learner_connector_sum_episodes_length_in": 5000.0, "learner_connector": {"connector_pipeline_timer": 0.17236267347354442, "timers": {"connectors": {"add_one_ts_to_episodes_and_truncate": 0.009078409412177281, "add_observations_from_episodes_to_batch": 0.0008839407155755908, "add_columns_from_episodes_to_train_batch": 0.04177823879756033, "add_time_dim_to_batch_and_zero_pad": 0.10278439263813197, "add_states_from_episodes_to_batch": 0.0034508101048413664, "batch_individual_items": 0.014186725467443467, "numpy_to_tensor": 6.114639691077173e-05}}}, "learner_connector_sum_episodes_length_out": 5250.0}, "learners": {"default_policy": {"num_module_steps_trained": 5994, "curr_kl_coeff": 0.040395982563495636, "num_module_steps_trained_lifetime": 11988, "num_trainable_parameters": 16595, "diff_num_grad_updates_vs_sampler_policy": 1.0, "weights_seq_no": 2.0, "use_intrinsic_rewards": 0.0, "total_loss": 0.20433159172534943, "vf_loss": 0.26398125290870667, "mean_kl_loss": 3.913193359039724e-05, "vf_loss_unclipped": 38.42979431152344, "curr_entropy_coeff": 0.0015431216992, "policy_loss": -0.00025765979080460966, "entropy": 0.6925932168960571, "vf_explained_var": 0.00029712915420532227, "module_train_batch_size_mean": 999.0, "num_module_steps_trained_lifetime_throughput": 655.0351977615223}, "intrinsic_reward_module": {"default_optimizer_learning_rate": 0.0002715581955, "num_module_steps_trained_lifetime": 11988, "num_trainable_parameters": 8266, "diff_num_grad_updates_vs_sampler_policy": 1.0, "total_loss": 0.0, "weights_seq_no": 2.0, "curr_entropy_coeff": 0.0015431216992, "module_train_batch_size_mean": 999.0, "num_module_steps_trained": 5994, "gradients_default_optimizer_global_norm": 0.0, "num_module_steps_trained_lifetime_throughput": 655.0467409297189}, "__all_modules__": {"num_env_steps_trained": 31500, "num_non_trainable_parameters": 0, "num_module_steps_trained": 11988, "num_env_steps_trained_lifetime": 63000, "num_module_steps_trained_lifetime": 23976, "num_trainable_parameters": 24861, "num_env_steps_trained_lifetime_throughput": 3442.4581959474226, "num_module_steps_trained_throughput": 31885435.33145801, "num_module_steps_trained_lifetime_throughput": 13134088.009247117}, "differentiable_learners": {"intrinsic_attention_ppo_learner": {"default_policy": {"use_intrinsic_rewards": 1.0, "vf_loss": 0.26537466049194336, "vf_loss_unclipped": 38.415367126464844, "policy_loss": -0.00025149676366709173, "num_module_steps_trained": 35964, "entropy": 0.6925992369651794, "vf_explained_var": 0.0007589459419250488, "module_train_batch_size_mean": 999.0, "num_module_steps_trained_lifetime": 71928, "total_loss": 0.2054261714220047, "diff_num_grad_updates_vs_sampler_policy": 11.0, "mean_kl_loss": 3.745829235413112e-05, "weights_seq_no": 12.0}, "__all_modules__": {"num_env_steps_trained": 189000, "num_module_steps_trained": 71928, "num_env_steps_trained_lifetime": 378000, "num_module_steps_trained_lifetime": 143856, "num_env_steps_trained_lifetime_throughput": 49248.71618099123}, "intrinsic_reward_module": {"num_module_steps_trained": 35964, "module_train_batch_size_mean": 999.0, "num_module_steps_trained_lifetime": 71928, "total_loss": 0.0, "diff_num_grad_updates_vs_sampler_policy": 11.0, "weights_seq_no": 12.0}}}, "IntrinsicAttentionMask": [[[0.33282384276390076, 0.33332306146621704, 0.3338530957698822], [0.332948237657547, 0.3333256244659424, 0.333726167678833], [0.3330800533294678, 0.3333282768726349, 0.33359161019325256]], [[0.33305618166923523, 0.3338043987751007, 0.33313944935798645], [0.3336184322834015, 0.3328489363193512, 0.3335326313972473], [0.33311882615089417, 0.3336979150772095, 0.33318328857421875]], [[0.33337050676345825, 0.3333218991756439, 0.3333076238632202], [0.3338516354560852, 0.33317363262176514, 0.33297470211982727], [0.3339930772781372, 0.33313003182411194, 0.33287689089775085]], [[0.3331930637359619, 0.3334192931652069, 0.33338770270347595], [0.3333428204059601, 0.3333275318145752, 0.3333296775817871], [0.33332186937332153, 0.3333403170108795, 0.3333377242088318]], [[0.33319759368896484, 0.3331684470176697, 0.33363401889801025], [0.3331756889820099, 0.3331418037414551, 0.3336825370788574], [0.3335250914096832, 0.3335663378238678, 0.33290866017341614]], [[0.3329913914203644, 0.33379262685775757, 0.33321601152420044], [0.3401593863964081, 0.32422876358032227, 0.33561187982559204], [0.33500248193740845, 0.3310958743095398, 0.33390167355537415]]]}, "num_training_step_calls_per_iteration": 1, "evaluation": {"env_runners": {"module_episode_returns_mean": {"default_policy": -2.05}, "num_env_steps_sampled_lifetime": 10400, "sample": 0.13014208438340574, "num_episodes": 20, "env_to_module_connector": {"timers": {"connectors": {"batch_individual_items": 2.98958442857372e-05, "numpy_to_tensor": 3.268484208821554e-05, "add_time_dim_to_batch_and_zero_pad": 1.6117154610890807e-05, "add_states_from_episodes_to_batch": 5.5890078786388875e-06, "add_observations_from_episodes_to_batch": 7.099425462843523e-06}}, "connector_pipeline_timer": 0.0001369670717723243}, "episode_return_min": -14.5, "num_agent_steps_sampled_lifetime": {"default_agent": 800}, "episode_return_mean": -2.05, "module_to_env_connector": {"timers": {"connectors": {"remove_single_ts_time_rank_from_batch": 2.2387016642024548e-05, "un_batch_to_individual_items": 1.1560774526625435e-05, "listify_data_for_vector_env": 2.2604214494770126e-05, "get_actions": 0.00011007184784272328, "tensor_to_numpy": 3.84397258951294e-05, "normalize_and_clip_actions": 1.684331877435719e-05}}, "connector_pipeline_timer": 0.00027419569229122914}, "episode_duration_sec_mean": 0.008394466657773592, "num_env_steps_sampled": 400, "episode_return_max": 13.5, "env_to_module_sum_episodes_length_in": 10.366003441359926, "num_episodes_lifetime": 40, "env_to_module_sum_episodes_length_out": 10.366003441359926, "num_agent_steps_sampled": {"default_agent": 400}, "episode_len_mean": 20.0, "episode_len_min": 20, "agent_episode_returns_mean": {"default_agent": -2.05}, "num_module_steps_sampled_lifetime": {"default_policy": 800}, "env_reset_timer": 0.0007638967782258988, "rlmodule_inference_timer": 8.409144106842079e-05, "num_module_steps_sampled": {"default_policy": 400}, "episode_len_max": 20, "env_step_timer": 4.119169472828144e-05, "weights_seq_no": 2.0, "time_between_sampling": 11.13148416695185}, "num_healthy_workers": 1, "actor_manager_num_outstanding_async_reqs": 0, "num_remote_worker_restarts": 0}, "num_env_steps_sampled_lifetime": 10000.0, "fault_tolerance": {"num_healthy_workers": 0, "num_remote_worker_restarts": 0}, "env_runner_group": {"actor_manager_num_outstanding_async_reqs": 0}, "done": false, "training_iteration": 2, "trial_id": "b7d85_00000", "date": "2025-08-11_18-00-31", "timestamp": 1754928031, "time_this_iter_s": 11.323981761932373, "time_total_s": 23.477157831192017, "pid": 10036, "hostname": "Mac", "node_ip": "127.0.0.1", "config": {"exploration_config": {}, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 2, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "env": "Umbrella", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": false, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 0, "create_local_env_runner": true, "num_envs_per_env_runner": 1, "gym_env_vectorize_mode": "SYNC", "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "episodes_to_numpy": true, "max_requests_in_flight_per_env_runner": 1, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "merge_env_runner_states": "training_only", "broadcast_env_runner_states": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "complete_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "sampler_perf_stats_ema_coef": null, "_is_online": true, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": "auto", "num_aggregator_actors_per_learner": 0, "max_requests_in_flight_per_aggregator_actor": 3, "local_gpu_idx": 0, "max_requests_in_flight_per_learner": 3, "gamma": 1, "lr": 0.0002715581955, "grad_clip": 0.5, "grad_clip_by": "global_norm", "_train_batch_size_per_learner": 5000, "train_batch_size": 4000, "num_epochs": 1, "minibatch_size": 1000, "shuffle_batch_per_epoch": true, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "log_std_clip_param": 20.0, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "_disable_preprocessor_api": false, "_disable_action_flattening": false}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {"intrinsic_reward_coeff": 0.2795015916508}, "optimizer": {}, "_learner_class": "<class 'source.intrinsic_attention_ppo.learners.IntrinsicAttentionMetaLearner.IntrinsicAttentionMetaLearner'>", "callbacks_on_algorithm_init": null, "callbacks_on_env_runners_recreated": null, "callbacks_on_offline_eval_runners_recreated": null, "callbacks_on_checkpoint_loaded": null, "callbacks_on_environment_created": null, "callbacks_on_episode_created": null, "callbacks_on_episode_start": null, "callbacks_on_episode_step": null, "callbacks_on_episode_end": null, "callbacks_on_evaluate_start": null, "callbacks_on_evaluate_end": null, "callbacks_on_evaluate_offline_start": null, "callbacks_on_evaluate_offline_end": null, "callbacks_on_sample_end": null, "callbacks_on_train_result": null, "explore": true, "enable_rl_module_and_learner": true, "enable_env_runner_and_connector_v2": true, "_prior_exploration_config": {"type": "StochasticSampling"}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x155e4d8a0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "offline_data_class": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_read_batch_size": null, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "materialize_data": false, "materialize_mapped_data": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "ignore_final_observation": false, "prelearner_class": null, "prelearner_buffer_class": null, "prelearner_buffer_kwargs": {}, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_remaining_data": false, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": 1, "evaluation_duration": 20, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_auto_duration_min_env_steps_per_sample": 100, "evaluation_auto_duration_max_env_steps_per_sample": 2000, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 1, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "offline_evaluation_interval": null, "num_offline_eval_runners": 0, "offline_loss_for_module_fn": null, "offline_evaluation_duration": 1, "offline_evaluation_parallel_to_training": false, "offline_evaluation_timeout_s": 120.0, "num_cpus_per_offline_eval_runner": 1, "num_gpus_per_offline_eval_runner": 0, "custom_resources_per_offline_eval_runner": {}, "restart_failed_offline_eval_runners": true, "ignore_offline_eval_runner_failures": false, "max_num_offline_eval_runner_restarts": 1000, "offline_eval_runner_restore_timeout_s": 1800.0, "max_requests_in_flight_per_offline_eval_runner": 1, "validate_offline_eval_runners_after_construction": true, "offline_eval_runner_health_probe_timeout_s": 30.0, "offline_eval_rl_module_inference_only": false, "broadcast_offline_eval_runner_states": false, "offline_eval_batch_size_per_runner": 256, "dataset_num_iters_per_eval_runner": 1, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "log_gradients": false, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 10, "restart_failed_env_runners": true, "ignore_env_runner_failures": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30.0, "env_runner_restore_timeout_s": 1800.0, "_model_config": {}, "_rl_module_spec": "MultiRLModuleSpec(multi_rl_module_class=<class 'ray.rllib.core.rl_module.multi_rl_module.MultiRLModule'>, observation_space=None, action_space=None, inference_only=False, model_config=None, rl_module_specs={'default_policy': RLModuleSpec(module_class=<class 'source.intrinsic_attention_ppo.rl_modules.DifferentiablePPOModule.DifferentiablePPOModule'>, observation_space=None, action_space=None, inference_only=False, learner_only=False, model_config={'vf_share_layers': True, 'embedding_dim': 62, 'max_seq_len': 3, 'policy_head_hidden_sizes': [32], 'value_head_hidden_sizes': [101], 'embedding_hidden_sizes': [121]}, catalog_class=None, load_state_path=None, model_config_dict=None), 'intrinsic_reward_module': RLModuleSpec(module_class=<class 'source.intrinsic_attention_ppo.rl_modules.IntrinsicAttentionModule.IntrinsicAttentionModule'>, observation_space=None, action_space=None, inference_only=False, learner_only=True, model_config={'intrinsic_reward_network': {'encoder_hidden_sizes': [], 'encoding_dim': 1, 'num_heads': 1, 'head_hidden_sizes': None, 'layers': [{'type': 'attention'}]}, 'extrinsic_value_hidden_layers': [127, 60], 'vf_share_layers': True, 'max_seq_len': 3}, catalog_class=None, load_state_path=None, model_config_dict=None)}, load_state_path=None, modules_to_load=None, module_specs={'default_policy': RLModuleSpec(module_class=<class 'source.intrinsic_attention_ppo.rl_modules.DifferentiablePPOModule.DifferentiablePPOModule'>, observation_space=None, action_space=None, inference_only=False, learner_only=False, model_config={'vf_share_layers': True, 'embedding_dim': 62, 'max_seq_len': 3, 'policy_head_hidden_sizes': [32], 'value_head_hidden_sizes': [101], 'embedding_hidden_sizes': [121]}, catalog_class=None, load_state_path=None, model_config_dict=None), 'intrinsic_reward_module': RLModuleSpec(module_class=<class 'source.intrinsic_attention_ppo.rl_modules.IntrinsicAttentionModule.IntrinsicAttentionModule'>, observation_space=None, action_space=None, inference_only=False, learner_only=True, model_config={'intrinsic_reward_network': {'encoder_hidden_sizes': [], 'encoding_dim': 1, 'num_heads': 1, 'head_hidden_sizes': None, 'layers': [{'type': 'attention'}]}, 'extrinsic_value_hidden_layers': [127, 60], 'vf_share_layers': True, 'max_seq_len': 3}, catalog_class=None, load_state_path=None, model_config_dict=None)})", "algorithm_config_overrides_per_module": {"intrinsic_reward_module": {"lr": 0.0002715581955}}, "_per_module_overrides": {}, "_validate_config": true, "_use_msgpack_checkpoints": false, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "env_task_fn": -1, "enable_connectors": -1, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.161583927863, "kl_target": 0.0201019014258, "vf_loss_coeff": 0.7790510010087, "entropy_coeff": 0.0015431216992, "clip_param": 0.2459212356676, "vf_clip_param": 0.3769744131561, "entropy_coeff_schedule": null, "lr_schedule": null, "sgd_minibatch_size": -1, "vf_share_layers": -1, "differentiable_learner_configs": ["DifferentiableLearnerConfig(learner_class=<class 'source.intrinsic_attention_ppo.learners.IntrinsicAttentionPPOLearner.IntrinsicAttentionPPOLearner'>, learner_connector=None, add_default_connectors_to_learner_pipeline=True, is_multi_agent=False, policies_to_update=['default_policy'], lr=0.0060984166342, num_total_minibatches=0, num_epochs=1, minibatch_size=1000, shuffle_batch_per_epoch=True)"], "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9485408017724, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.callbacks.callbacks.RLlibCallback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 23.477157831192017, "iterations_since_restore": 2, "perf": {"cpu_util_percent": 46.212500000000006, "ram_util_percent": 80.79374999999999}}
{"timers": {"training_iteration": 11.9921562448094, "restore_env_runners": 1.4517267770133913e-05, "training_step": 11.991954889537896, "env_runner_sampling_timer": 1.609256795211369, "learner_update_timer": 10.171849474786978, "synch_weights": 0.001685502804466523, "restore_eval_env_runners": 4.838414955884218e-05, "evaluation_iteration": 0.14290891683427617, "synch_eval_env_connectors": 0.00025170230073854325, "synch_env_connectors": 4.150954773649573e-06}, "env_runners": {"rlmodule_inference_timer": 3.449429327670836e-05, "module_to_env_connector": {"timers": {"connectors": {"listify_data_for_vector_env": 1.0864624003316464e-05, "un_batch_to_individual_items": 7.930452349503014e-06, "get_actions": 4.318738462128522e-05, "remove_single_ts_time_rank_from_batch": 1.2276787347870485e-05, "tensor_to_numpy": 1.6247218670786e-05, "normalize_and_clip_actions": 8.26139434411266e-06}}, "connector_pipeline_timer": 0.00012596278112344275}, "module_episode_returns_mean": {"default_policy": 0.54}, "episode_len_mean": 20.0, "episode_return_min": -10.5, "num_env_steps_sampled": 5000.0, "episode_return_max": 9.5, "env_to_module_sum_episodes_length_in": 10.36823839457432, "num_agent_steps_sampled": {"default_agent": 5000.0}, "episode_len_min": 20, "env_to_module_connector": {"connector_pipeline_timer": 6.178253333229692e-05, "timers": {"connectors": {"add_states_from_episodes_to_batch": 2.8188320860663093e-06, "batch_individual_items": 1.2867032273375653e-05, "numpy_to_tensor": 1.3323560710748913e-05, "add_time_dim_to_batch_and_zero_pad": 7.233396627750481e-06, "add_observations_from_episodes_to_batch": 2.862924603461035e-06}}}, "episode_len_max": 20, "num_episodes_lifetime": -30375.0, "env_step_timer": 1.4961265130237734e-05, "env_reset_timer": 4.569840296217998e-05, "weights_seq_no": 2.0, "episode_return_mean": 0.54, "num_module_steps_sampled": {"default_policy": 5000.0}, "time_between_sampling": 0.039561257275477754, "num_env_steps_sampled_lifetime": -607500.0, "agent_episode_returns_mean": {"default_agent": 0.54}, "sample": 0.005966598967847711, "num_agent_steps_sampled_lifetime": {"default_agent": -607500.0}, "env_to_module_sum_episodes_length_out": 10.36823839457432, "episode_duration_sec_mean": 0.005575869138352576, "num_module_steps_sampled_lifetime": {"default_policy": -607500.0}, "num_episodes": 250.0, "num_env_steps_sampled_lifetime_throughput": 3116.5966081400225}, "__all_modules__": {"learner_connector_sum_episodes_length_in": 5000.0, "learner_connector": {"connector_pipeline_timer": 0.17240494173923507, "timers": {"connectors": {"add_one_ts_to_episodes_and_truncate": 0.009077104068070186, "add_observations_from_episodes_to_batch": 0.0008838546486455017, "add_columns_from_episodes_to_train_batch": 0.04179262390867807, "add_time_dim_to_batch_and_zero_pad": 0.10282251163171603, "add_states_from_episodes_to_batch": 0.0034542674139491285, "batch_individual_items": 0.014174515713425354, "numpy_to_tensor": 6.127910275245086e-05}}}, "learner_connector_sum_episodes_length_out": 5250.0}, "learners": {"default_policy": {"num_module_steps_trained": 5994, "curr_kl_coeff": 0.020197991281747818, "num_module_steps_trained_lifetime": 17982, "num_trainable_parameters": 16595, "diff_num_grad_updates_vs_sampler_policy": 1.0, "weights_seq_no": 3.0, "use_intrinsic_rewards": 0.0, "total_loss": 0.20440034568309784, "vf_loss": 0.2639201283454895, "mean_kl_loss": 6.975194264668971e-05, "vf_loss_unclipped": 37.65215301513672, "curr_entropy_coeff": 0.0015431216992, "policy_loss": -0.00014149578055366874, "entropy": 0.6922544240951538, "vf_explained_var": 0.00047403573989868164, "module_train_batch_size_mean": 999.0, "num_module_steps_trained_lifetime_throughput": 653.6293697928157}, "intrinsic_reward_module": {"default_optimizer_learning_rate": 0.0002715581955, "num_module_steps_trained_lifetime": 17982, "num_trainable_parameters": 8266, "diff_num_grad_updates_vs_sampler_policy": 1.0, "total_loss": 0.0, "weights_seq_no": 3.0, "curr_entropy_coeff": 0.0015431216992, "module_train_batch_size_mean": 999.0, "num_module_steps_trained": 5994, "gradients_default_optimizer_global_norm": 0.0, "num_module_steps_trained_lifetime_throughput": 653.6406521243637}, "__all_modules__": {"num_env_steps_trained": 31500, "num_non_trainable_parameters": 0, "num_module_steps_trained": 11988, "num_env_steps_trained_lifetime": 94500, "num_module_steps_trained_lifetime": 35964, "num_trainable_parameters": 24861, "num_env_steps_trained_lifetime_throughput": 3435.068319597591, "num_module_steps_trained_throughput": 31171976.999460436, "num_module_steps_trained_lifetime_throughput": 13089878.495625235}, "differentiable_learners": {"intrinsic_attention_ppo_learner": {"default_policy": {"use_intrinsic_rewards": 1.0, "vf_loss": 0.2648017108440399, "vf_loss_unclipped": 37.76158142089844, "policy_loss": -0.00013862924242857844, "num_module_steps_trained": 35964, "entropy": 0.6922566294670105, "vf_explained_var": 0.0007874369621276855, "module_train_batch_size_mean": 999.0, "num_module_steps_trained_lifetime": 107892, "total_loss": 0.20509828627109528, "diff_num_grad_updates_vs_sampler_policy": 16.0, "mean_kl_loss": 6.899841537233442e-05, "weights_seq_no": 18.0}, "__all_modules__": {"num_env_steps_trained": 189000, "num_module_steps_trained": 71928, "num_env_steps_trained_lifetime": 567000, "num_module_steps_trained_lifetime": 215784, "num_env_steps_trained_lifetime_throughput": 48753.37460505878}, "intrinsic_reward_module": {"num_module_steps_trained": 35964, "module_train_batch_size_mean": 999.0, "num_module_steps_trained_lifetime": 107892, "total_loss": 0.0, "diff_num_grad_updates_vs_sampler_policy": 16.0, "weights_seq_no": 18.0}}}, "IntrinsicAttentionMask": [[[0.3320032060146332, 0.33373305201530457, 0.33426374197006226], [0.33312907814979553, 0.3333948254585266, 0.33347609639167786], [0.33347368240356445, 0.33329108357429504, 0.3332352638244629]], [[0.3334238827228546, 0.33322572708129883, 0.33335041999816895], [0.33348649740219116, 0.33315128087997437, 0.3333622217178345], [0.33344706892967224, 0.33319810032844543, 0.33335480093955994]], [[0.33336278796195984, 0.3334261178970337, 0.3332110345363617], [0.33336061239242554, 0.33341923356056213, 0.33322015404701233], [0.3333680331707001, 0.33344265818595886, 0.3331892788410187]], [[0.33299461007118225, 0.3334888815879822, 0.3335164487361908], [0.33403488993644714, 0.33301103115081787, 0.3329541087150574], [0.3340928554534912, 0.3329843580722809, 0.33292272686958313]], [[0.33324572443962097, 0.33336034417152405, 0.33339402079582214], [0.3337267339229584, 0.33321213722229004, 0.3330610990524292], [0.333868145942688, 0.33316856622695923, 0.3329632878303528]], [[0.3337322771549225, 0.33215251564979553, 0.3341151475906372], [0.3351402282714844, 0.32796135544776917, 0.33689841628074646], [0.3333888649940491, 0.33316922187805176, 0.33344194293022156]]]}, "num_training_step_calls_per_iteration": 1, "evaluation": {"env_runners": {"module_episode_returns_mean": {"default_policy": -1.2166666666666666}, "num_env_steps_sampled_lifetime": 15400, "sample": 0.12999798644972033, "num_episodes": 20, "env_to_module_connector": {"timers": {"connectors": {"batch_individual_items": 1.2706677754195392e-05, "numpy_to_tensor": 1.2402385604391434e-05, "add_time_dim_to_batch_and_zero_pad": 7.100060537431532e-06, "add_states_from_episodes_to_batch": 2.7841739248972186e-06, "add_observations_from_episodes_to_batch": 2.8344918526002806e-06}}, "connector_pipeline_timer": 6.028839357262898e-05}, "episode_return_min": -14.5, "num_agent_steps_sampled_lifetime": {"default_agent": 1200}, "episode_return_mean": -1.2166666666666666, "module_to_env_connector": {"timers": {"connectors": {"remove_single_ts_time_rank_from_batch": 1.2068299024156195e-05, "un_batch_to_individual_items": 6.67590512672026e-06, "listify_data_for_vector_env": 1.0530339367228105e-05, "get_actions": 3.670697793260451e-05, "tensor_to_numpy": 1.5341680084106307e-05, "normalize_and_clip_actions": 8.145020288834598e-06}}, "connector_pipeline_timer": 0.00011592314670388783}, "episode_duration_sec_mean": 0.007351691669706876, "num_env_steps_sampled": 400, "episode_return_max": 13.5, "env_to_module_sum_episodes_length_in": 10.368205581254823, "num_episodes_lifetime": 60, "env_to_module_sum_episodes_length_out": 10.368205581254823, "num_agent_steps_sampled": {"default_agent": 400}, "episode_len_mean": 20.0, "episode_len_min": 20, "agent_episode_returns_mean": {"default_agent": -1.2166666666666666}, "num_module_steps_sampled_lifetime": {"default_policy": 1200}, "env_reset_timer": 0.0007596065600402654, "rlmodule_inference_timer": 3.1964311601894936e-05, "num_module_steps_sampled": {"default_policy": 400}, "episode_len_max": 20, "env_step_timer": 1.4112838756624518e-05, "weights_seq_no": 3.0, "time_between_sampling": 11.133564625702565}, "num_healthy_workers": 1, "actor_manager_num_outstanding_async_reqs": 0, "num_remote_worker_restarts": 0}, "num_env_steps_sampled_lifetime": -607500.0, "fault_tolerance": {"num_healthy_workers": 0, "num_remote_worker_restarts": 0}, "env_runner_group": {"actor_manager_num_outstanding_async_reqs": 0}, "done": false, "training_iteration": 3, "trial_id": "b7d85_00000", "date": "2025-08-11_18-00-42", "timestamp": 1754928042, "time_this_iter_s": 11.40840220451355, "time_total_s": 34.885560035705566, "pid": 10036, "hostname": "Mac", "node_ip": "127.0.0.1", "config": {"exploration_config": {}, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 2, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "env": "Umbrella", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": false, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 0, "create_local_env_runner": true, "num_envs_per_env_runner": 1, "gym_env_vectorize_mode": "SYNC", "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "episodes_to_numpy": true, "max_requests_in_flight_per_env_runner": 1, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "merge_env_runner_states": "training_only", "broadcast_env_runner_states": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "complete_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "sampler_perf_stats_ema_coef": null, "_is_online": true, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": "auto", "num_aggregator_actors_per_learner": 0, "max_requests_in_flight_per_aggregator_actor": 3, "local_gpu_idx": 0, "max_requests_in_flight_per_learner": 3, "gamma": 1, "lr": 0.0002715581955, "grad_clip": 0.5, "grad_clip_by": "global_norm", "_train_batch_size_per_learner": 5000, "train_batch_size": 4000, "num_epochs": 1, "minibatch_size": 1000, "shuffle_batch_per_epoch": true, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "log_std_clip_param": 20.0, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "_disable_preprocessor_api": false, "_disable_action_flattening": false}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {"intrinsic_reward_coeff": 0.2795015916508}, "optimizer": {}, "_learner_class": "<class 'source.intrinsic_attention_ppo.learners.IntrinsicAttentionMetaLearner.IntrinsicAttentionMetaLearner'>", "callbacks_on_algorithm_init": null, "callbacks_on_env_runners_recreated": null, "callbacks_on_offline_eval_runners_recreated": null, "callbacks_on_checkpoint_loaded": null, "callbacks_on_environment_created": null, "callbacks_on_episode_created": null, "callbacks_on_episode_start": null, "callbacks_on_episode_step": null, "callbacks_on_episode_end": null, "callbacks_on_evaluate_start": null, "callbacks_on_evaluate_end": null, "callbacks_on_evaluate_offline_start": null, "callbacks_on_evaluate_offline_end": null, "callbacks_on_sample_end": null, "callbacks_on_train_result": null, "explore": true, "enable_rl_module_and_learner": true, "enable_env_runner_and_connector_v2": true, "_prior_exploration_config": {"type": "StochasticSampling"}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x155e4d8a0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "offline_data_class": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_read_batch_size": null, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "materialize_data": false, "materialize_mapped_data": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "ignore_final_observation": false, "prelearner_class": null, "prelearner_buffer_class": null, "prelearner_buffer_kwargs": {}, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_remaining_data": false, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": 1, "evaluation_duration": 20, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_auto_duration_min_env_steps_per_sample": 100, "evaluation_auto_duration_max_env_steps_per_sample": 2000, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 1, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "offline_evaluation_interval": null, "num_offline_eval_runners": 0, "offline_loss_for_module_fn": null, "offline_evaluation_duration": 1, "offline_evaluation_parallel_to_training": false, "offline_evaluation_timeout_s": 120.0, "num_cpus_per_offline_eval_runner": 1, "num_gpus_per_offline_eval_runner": 0, "custom_resources_per_offline_eval_runner": {}, "restart_failed_offline_eval_runners": true, "ignore_offline_eval_runner_failures": false, "max_num_offline_eval_runner_restarts": 1000, "offline_eval_runner_restore_timeout_s": 1800.0, "max_requests_in_flight_per_offline_eval_runner": 1, "validate_offline_eval_runners_after_construction": true, "offline_eval_runner_health_probe_timeout_s": 30.0, "offline_eval_rl_module_inference_only": false, "broadcast_offline_eval_runner_states": false, "offline_eval_batch_size_per_runner": 256, "dataset_num_iters_per_eval_runner": 1, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "log_gradients": false, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 10, "restart_failed_env_runners": true, "ignore_env_runner_failures": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30.0, "env_runner_restore_timeout_s": 1800.0, "_model_config": {}, "_rl_module_spec": "MultiRLModuleSpec(multi_rl_module_class=<class 'ray.rllib.core.rl_module.multi_rl_module.MultiRLModule'>, observation_space=None, action_space=None, inference_only=False, model_config=None, rl_module_specs={'default_policy': RLModuleSpec(module_class=<class 'source.intrinsic_attention_ppo.rl_modules.DifferentiablePPOModule.DifferentiablePPOModule'>, observation_space=None, action_space=None, inference_only=False, learner_only=False, model_config={'vf_share_layers': True, 'embedding_dim': 62, 'max_seq_len': 3, 'policy_head_hidden_sizes': [32], 'value_head_hidden_sizes': [101], 'embedding_hidden_sizes': [121]}, catalog_class=None, load_state_path=None, model_config_dict=None), 'intrinsic_reward_module': RLModuleSpec(module_class=<class 'source.intrinsic_attention_ppo.rl_modules.IntrinsicAttentionModule.IntrinsicAttentionModule'>, observation_space=None, action_space=None, inference_only=False, learner_only=True, model_config={'intrinsic_reward_network': {'encoder_hidden_sizes': [], 'encoding_dim': 1, 'num_heads': 1, 'head_hidden_sizes': None, 'layers': [{'type': 'attention'}]}, 'extrinsic_value_hidden_layers': [127, 60], 'vf_share_layers': True, 'max_seq_len': 3}, catalog_class=None, load_state_path=None, model_config_dict=None)}, load_state_path=None, modules_to_load=None, module_specs={'default_policy': RLModuleSpec(module_class=<class 'source.intrinsic_attention_ppo.rl_modules.DifferentiablePPOModule.DifferentiablePPOModule'>, observation_space=None, action_space=None, inference_only=False, learner_only=False, model_config={'vf_share_layers': True, 'embedding_dim': 62, 'max_seq_len': 3, 'policy_head_hidden_sizes': [32], 'value_head_hidden_sizes': [101], 'embedding_hidden_sizes': [121]}, catalog_class=None, load_state_path=None, model_config_dict=None), 'intrinsic_reward_module': RLModuleSpec(module_class=<class 'source.intrinsic_attention_ppo.rl_modules.IntrinsicAttentionModule.IntrinsicAttentionModule'>, observation_space=None, action_space=None, inference_only=False, learner_only=True, model_config={'intrinsic_reward_network': {'encoder_hidden_sizes': [], 'encoding_dim': 1, 'num_heads': 1, 'head_hidden_sizes': None, 'layers': [{'type': 'attention'}]}, 'extrinsic_value_hidden_layers': [127, 60], 'vf_share_layers': True, 'max_seq_len': 3}, catalog_class=None, load_state_path=None, model_config_dict=None)})", "algorithm_config_overrides_per_module": {"intrinsic_reward_module": {"lr": 0.0002715581955}}, "_per_module_overrides": {}, "_validate_config": true, "_use_msgpack_checkpoints": false, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "env_task_fn": -1, "enable_connectors": -1, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.161583927863, "kl_target": 0.0201019014258, "vf_loss_coeff": 0.7790510010087, "entropy_coeff": 0.0015431216992, "clip_param": 0.2459212356676, "vf_clip_param": 0.3769744131561, "entropy_coeff_schedule": null, "lr_schedule": null, "sgd_minibatch_size": -1, "vf_share_layers": -1, "differentiable_learner_configs": ["DifferentiableLearnerConfig(learner_class=<class 'source.intrinsic_attention_ppo.learners.IntrinsicAttentionPPOLearner.IntrinsicAttentionPPOLearner'>, learner_connector=None, add_default_connectors_to_learner_pipeline=True, is_multi_agent=False, policies_to_update=['default_policy'], lr=0.0060984166342, num_total_minibatches=0, num_epochs=1, minibatch_size=1000, shuffle_batch_per_epoch=True)"], "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9485408017724, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.callbacks.callbacks.RLlibCallback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 34.885560035705566, "iterations_since_restore": 3, "perf": {"cpu_util_percent": 43.224999999999994, "ram_util_percent": 80.22500000000001}}
{"timers": {"training_iteration": 11.990408546951077, "restore_env_runners": 1.444043437880464e-05, "training_step": 11.990207026472975, "env_runner_sampling_timer": 1.608751404759384, "learner_update_timer": 10.170316539198254, "synch_weights": 0.0016781777768104802, "restore_eval_env_runners": 4.8526558466255665e-05, "evaluation_iteration": 0.1427286484963028, "synch_eval_env_connectors": 0.0002514406872214749, "synch_env_connectors": 4.228195839095861e-06}, "env_runners": {"rlmodule_inference_timer": 3.299363753946302e-05, "module_to_env_connector": {"timers": {"connectors": {"listify_data_for_vector_env": 1.0499091145117777e-05, "un_batch_to_individual_items": 6.572694998644677e-06, "get_actions": 4.1464559640353585e-05, "remove_single_ts_time_rank_from_batch": 1.2086892465409758e-05, "tensor_to_numpy": 1.5760718309805437e-05, "normalize_and_clip_actions": 8.042984109088169e-06}}, "connector_pipeline_timer": 0.00012095403775559387}, "module_episode_returns_mean": {"default_policy": -0.5}, "episode_len_mean": 20.0, "episode_return_min": -10.5, "num_env_steps_sampled": 5000.0, "episode_return_max": 9.5, "env_to_module_sum_episodes_length_in": 10.36823839457432, "num_agent_steps_sampled": {"default_agent": 5000.0}, "episode_len_min": 20, "env_to_module_connector": {"connector_pipeline_timer": 5.960588879317681e-05, "timers": {"connectors": {"add_states_from_episodes_to_batch": 2.7285359122941924e-06, "batch_individual_items": 1.2342617395113688e-05, "numpy_to_tensor": 1.2715440130957399e-05, "add_time_dim_to_batch_and_zero_pad": 7.000565682395869e-06, "add_observations_from_episodes_to_batch": 2.778229386744298e-06}}}, "episode_len_max": 20, "num_episodes_lifetime": -61250.0, "env_step_timer": 1.3956904737753469e-05, "env_reset_timer": 3.9545516539667316e-05, "weights_seq_no": 3.0, "episode_return_mean": -0.5, "num_module_steps_sampled": {"default_policy": 5000.0}, "time_between_sampling": 0.03969329548286787, "num_env_steps_sampled_lifetime": -1225000.0, "agent_episode_returns_mean": {"default_agent": -0.5}, "sample": 0.005746077005868918, "num_agent_steps_sampled_lifetime": {"default_agent": -1225000.0}, "env_to_module_sum_episodes_length_out": 10.36823839457432, "episode_duration_sec_mean": 0.005364732794929296, "num_module_steps_sampled_lifetime": {"default_policy": -1225000.0}, "num_episodes": 250.0, "num_env_steps_sampled_lifetime_throughput": 3211.602039570154}, "__all_modules__": {"learner_connector_sum_episodes_length_in": 5000.0, "learner_connector": {"connector_pipeline_timer": 0.1725306110722972, "timers": {"connectors": {"add_one_ts_to_episodes_and_truncate": 0.009094068437954994, "add_observations_from_episodes_to_batch": 0.0008861065218799051, "add_columns_from_episodes_to_train_batch": 0.0418006539199925, "add_time_dim_to_batch_and_zero_pad": 0.10292692359497117, "add_states_from_episodes_to_batch": 0.0034618701596754835, "batch_individual_items": 0.01416015596630564, "numpy_to_tensor": 6.180797233886551e-05}}}, "learner_connector_sum_episodes_length_out": 5250.0}, "learners": {"default_policy": {"num_module_steps_trained": 5994, "curr_kl_coeff": 0.010098995640873909, "num_module_steps_trained_lifetime": 23976, "num_trainable_parameters": 16595, "diff_num_grad_updates_vs_sampler_policy": 1.0, "weights_seq_no": 4.0, "use_intrinsic_rewards": 0.0, "total_loss": 0.2041553258895874, "vf_loss": 0.26388540863990784, "mean_kl_loss": 5.7177123380824924e-05, "vf_loss_unclipped": 38.194480895996094, "curr_entropy_coeff": 0.0015431216992, "policy_loss": -0.0003586459788493812, "entropy": 0.6917074918746948, "vf_explained_var": -0.00023829936981201172, "module_train_batch_size_mean": 999.0, "num_module_steps_trained_lifetime_throughput": 651.5257746571712}, "intrinsic_reward_module": {"default_optimizer_learning_rate": 0.0002715581955, "num_module_steps_trained_lifetime": 23976, "num_trainable_parameters": 8266, "diff_num_grad_updates_vs_sampler_policy": 1.0, "total_loss": 0.0, "weights_seq_no": 4.0, "curr_entropy_coeff": 0.0015431216992, "module_train_batch_size_mean": 999.0, "num_module_steps_trained": 5994, "gradients_default_optimizer_global_norm": 0.0, "num_module_steps_trained_lifetime_throughput": 651.5366693684758}, "__all_modules__": {"num_env_steps_trained": 31500, "num_non_trainable_parameters": 0, "num_module_steps_trained": 11988, "num_env_steps_trained_lifetime": 126000, "num_module_steps_trained_lifetime": 47952, "num_trainable_parameters": 24861, "num_env_steps_trained_lifetime_throughput": 3424.011024076457, "num_module_steps_trained_throughput": 30360128.66799367, "num_module_steps_trained_lifetime_throughput": 13045455.683481263}, "differentiable_learners": {"intrinsic_attention_ppo_learner": {"default_policy": {"use_intrinsic_rewards": 1.0, "vf_loss": 0.2644830346107483, "vf_loss_unclipped": 38.187477111816406, "policy_loss": -0.0003495028358884156, "num_module_steps_trained": 35964, "entropy": 0.6917209625244141, "vf_explained_var": 0.0009056925773620605, "module_train_batch_size_mean": 999.0, "num_module_steps_trained_lifetime": 143856, "total_loss": 0.20463766157627106, "diff_num_grad_updates_vs_sampler_policy": 21.0, "mean_kl_loss": 5.444673661259003e-05, "weights_seq_no": 24.0}, "__all_modules__": {"num_env_steps_trained": 189000, "num_module_steps_trained": 71928, "num_env_steps_trained_lifetime": 756000, "num_module_steps_trained_lifetime": 287712, "num_env_steps_trained_lifetime_throughput": 48089.76978784577}, "intrinsic_reward_module": {"num_module_steps_trained": 35964, "module_train_batch_size_mean": 999.0, "num_module_steps_trained_lifetime": 143856, "total_loss": 0.0, "diff_num_grad_updates_vs_sampler_policy": 21.0, "weights_seq_no": 24.0}}}, "IntrinsicAttentionMask": [[[0.3334004878997803, 0.33343952894210815, 0.33316004276275635], [0.3333923816680908, 0.33342671394348145, 0.3331809341907501], [0.3334503769874573, 0.33351844549179077, 0.33303117752075195]], [[0.33305624127388, 0.33328092098236084, 0.33366280794143677], [0.33322519063949585, 0.33331289887428284, 0.3334618806838989], [0.3335121273994446, 0.3333670198917389, 0.33312079310417175]], [[0.33335384726524353, 0.33339792490005493, 0.3332482576370239], [0.33335164189338684, 0.333391010761261, 0.3332573175430298], [0.3333590626716614, 0.3334144353866577, 0.33322644233703613]], [[0.3333202600479126, 0.333046019077301, 0.33363375067710876], [0.33331364393234253, 0.3329024612903595, 0.3337838649749756], [0.3333277404308319, 0.3332099914550781, 0.33346232771873474]], [[0.33319759368896484, 0.3331684470176697, 0.33363401889801025], [0.3331756889820099, 0.3331418037414551, 0.3336825370788574], [0.3335250914096832, 0.3335663378238678, 0.33290866017341614]], [[0.3341153562068939, 0.33196160197257996, 0.3339230716228485], [0.33789896965026855, 0.32533949613571167, 0.33676159381866455], [0.33445313572883606, 0.3313693702220917, 0.3341774642467499]]]}, "num_training_step_calls_per_iteration": 1, "evaluation": {"env_runners": {"module_episode_returns_mean": {"default_policy": -1.05}, "num_env_steps_sampled_lifetime": 20400, "sample": 0.1300427186649586, "num_episodes": 20, "env_to_module_connector": {"timers": {"connectors": {"batch_individual_items": 1.4863796287860416e-05, "numpy_to_tensor": 1.4527680204851383e-05, "add_time_dim_to_batch_and_zero_pad": 7.675122160718214e-06, "add_states_from_episodes_to_batch": 3.1827037364804524e-06, "add_observations_from_episodes_to_batch": 3.0568457120153376e-06}}, "connector_pipeline_timer": 6.88592771540328e-05}, "episode_return_min": -14.5, "num_agent_steps_sampled_lifetime": {"default_agent": 1600}, "episode_return_mean": -1.05, "module_to_env_connector": {"timers": {"connectors": {"remove_single_ts_time_rank_from_batch": 1.3074093684148252e-05, "un_batch_to_individual_items": 7.413503664252387e-06, "listify_data_for_vector_env": 1.1892511041031542e-05, "get_actions": 4.2768730646303274e-05, "tensor_to_numpy": 1.69575265540238e-05, "normalize_and_clip_actions": 9.66356640294014e-06}}, "connector_pipeline_timer": 0.00013105262900662277}, "episode_duration_sec_mean": 0.007042137002281379, "num_env_steps_sampled": 400, "episode_return_max": 13.5, "env_to_module_sum_episodes_length_in": 10.368237912813044, "num_episodes_lifetime": 80, "env_to_module_sum_episodes_length_out": 10.368237912813044, "num_agent_steps_sampled": {"default_agent": 400}, "episode_len_mean": 20.0, "episode_len_min": 20, "agent_episode_returns_mean": {"default_agent": -1.05}, "num_module_steps_sampled_lifetime": {"default_policy": 1600}, "env_reset_timer": 0.0007557079940726982, "rlmodule_inference_timer": 3.5096095909454536e-05, "num_module_steps_sampled": {"default_policy": 400}, "episode_len_max": 20, "env_step_timer": 1.6248250936209326e-05, "weights_seq_no": 4.0, "time_between_sampling": 11.14071381402599}, "num_healthy_workers": 1, "actor_manager_num_outstanding_async_reqs": 0, "num_remote_worker_restarts": 0}, "num_env_steps_sampled_lifetime": -1225000.0, "fault_tolerance": {"num_healthy_workers": 0, "num_remote_worker_restarts": 0}, "env_runner_group": {"actor_manager_num_outstanding_async_reqs": 0}, "done": false, "training_iteration": 4, "trial_id": "b7d85_00000", "date": "2025-08-11_18-00-54", "timestamp": 1754928054, "time_this_iter_s": 11.963715076446533, "time_total_s": 46.8492751121521, "pid": 10036, "hostname": "Mac", "node_ip": "127.0.0.1", "config": {"exploration_config": {}, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 2, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "env": "Umbrella", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": false, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 0, "create_local_env_runner": true, "num_envs_per_env_runner": 1, "gym_env_vectorize_mode": "SYNC", "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "episodes_to_numpy": true, "max_requests_in_flight_per_env_runner": 1, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "merge_env_runner_states": "training_only", "broadcast_env_runner_states": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "complete_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "sampler_perf_stats_ema_coef": null, "_is_online": true, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": "auto", "num_aggregator_actors_per_learner": 0, "max_requests_in_flight_per_aggregator_actor": 3, "local_gpu_idx": 0, "max_requests_in_flight_per_learner": 3, "gamma": 1, "lr": 0.0002715581955, "grad_clip": 0.5, "grad_clip_by": "global_norm", "_train_batch_size_per_learner": 5000, "train_batch_size": 4000, "num_epochs": 1, "minibatch_size": 1000, "shuffle_batch_per_epoch": true, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "log_std_clip_param": 20.0, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "_disable_preprocessor_api": false, "_disable_action_flattening": false}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {"intrinsic_reward_coeff": 0.2795015916508}, "optimizer": {}, "_learner_class": "<class 'source.intrinsic_attention_ppo.learners.IntrinsicAttentionMetaLearner.IntrinsicAttentionMetaLearner'>", "callbacks_on_algorithm_init": null, "callbacks_on_env_runners_recreated": null, "callbacks_on_offline_eval_runners_recreated": null, "callbacks_on_checkpoint_loaded": null, "callbacks_on_environment_created": null, "callbacks_on_episode_created": null, "callbacks_on_episode_start": null, "callbacks_on_episode_step": null, "callbacks_on_episode_end": null, "callbacks_on_evaluate_start": null, "callbacks_on_evaluate_end": null, "callbacks_on_evaluate_offline_start": null, "callbacks_on_evaluate_offline_end": null, "callbacks_on_sample_end": null, "callbacks_on_train_result": null, "explore": true, "enable_rl_module_and_learner": true, "enable_env_runner_and_connector_v2": true, "_prior_exploration_config": {"type": "StochasticSampling"}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x155e4d8a0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "offline_data_class": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_read_batch_size": null, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "materialize_data": false, "materialize_mapped_data": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "ignore_final_observation": false, "prelearner_class": null, "prelearner_buffer_class": null, "prelearner_buffer_kwargs": {}, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_remaining_data": false, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": 1, "evaluation_duration": 20, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_auto_duration_min_env_steps_per_sample": 100, "evaluation_auto_duration_max_env_steps_per_sample": 2000, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 1, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "offline_evaluation_interval": null, "num_offline_eval_runners": 0, "offline_loss_for_module_fn": null, "offline_evaluation_duration": 1, "offline_evaluation_parallel_to_training": false, "offline_evaluation_timeout_s": 120.0, "num_cpus_per_offline_eval_runner": 1, "num_gpus_per_offline_eval_runner": 0, "custom_resources_per_offline_eval_runner": {}, "restart_failed_offline_eval_runners": true, "ignore_offline_eval_runner_failures": false, "max_num_offline_eval_runner_restarts": 1000, "offline_eval_runner_restore_timeout_s": 1800.0, "max_requests_in_flight_per_offline_eval_runner": 1, "validate_offline_eval_runners_after_construction": true, "offline_eval_runner_health_probe_timeout_s": 30.0, "offline_eval_rl_module_inference_only": false, "broadcast_offline_eval_runner_states": false, "offline_eval_batch_size_per_runner": 256, "dataset_num_iters_per_eval_runner": 1, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "log_gradients": false, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 10, "restart_failed_env_runners": true, "ignore_env_runner_failures": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30.0, "env_runner_restore_timeout_s": 1800.0, "_model_config": {}, "_rl_module_spec": "MultiRLModuleSpec(multi_rl_module_class=<class 'ray.rllib.core.rl_module.multi_rl_module.MultiRLModule'>, observation_space=None, action_space=None, inference_only=False, model_config=None, rl_module_specs={'default_policy': RLModuleSpec(module_class=<class 'source.intrinsic_attention_ppo.rl_modules.DifferentiablePPOModule.DifferentiablePPOModule'>, observation_space=None, action_space=None, inference_only=False, learner_only=False, model_config={'vf_share_layers': True, 'embedding_dim': 62, 'max_seq_len': 3, 'policy_head_hidden_sizes': [32], 'value_head_hidden_sizes': [101], 'embedding_hidden_sizes': [121]}, catalog_class=None, load_state_path=None, model_config_dict=None), 'intrinsic_reward_module': RLModuleSpec(module_class=<class 'source.intrinsic_attention_ppo.rl_modules.IntrinsicAttentionModule.IntrinsicAttentionModule'>, observation_space=None, action_space=None, inference_only=False, learner_only=True, model_config={'intrinsic_reward_network': {'encoder_hidden_sizes': [], 'encoding_dim': 1, 'num_heads': 1, 'head_hidden_sizes': None, 'layers': [{'type': 'attention'}]}, 'extrinsic_value_hidden_layers': [127, 60], 'vf_share_layers': True, 'max_seq_len': 3}, catalog_class=None, load_state_path=None, model_config_dict=None)}, load_state_path=None, modules_to_load=None, module_specs={'default_policy': RLModuleSpec(module_class=<class 'source.intrinsic_attention_ppo.rl_modules.DifferentiablePPOModule.DifferentiablePPOModule'>, observation_space=None, action_space=None, inference_only=False, learner_only=False, model_config={'vf_share_layers': True, 'embedding_dim': 62, 'max_seq_len': 3, 'policy_head_hidden_sizes': [32], 'value_head_hidden_sizes': [101], 'embedding_hidden_sizes': [121]}, catalog_class=None, load_state_path=None, model_config_dict=None), 'intrinsic_reward_module': RLModuleSpec(module_class=<class 'source.intrinsic_attention_ppo.rl_modules.IntrinsicAttentionModule.IntrinsicAttentionModule'>, observation_space=None, action_space=None, inference_only=False, learner_only=True, model_config={'intrinsic_reward_network': {'encoder_hidden_sizes': [], 'encoding_dim': 1, 'num_heads': 1, 'head_hidden_sizes': None, 'layers': [{'type': 'attention'}]}, 'extrinsic_value_hidden_layers': [127, 60], 'vf_share_layers': True, 'max_seq_len': 3}, catalog_class=None, load_state_path=None, model_config_dict=None)})", "algorithm_config_overrides_per_module": {"intrinsic_reward_module": {"lr": 0.0002715581955}}, "_per_module_overrides": {}, "_validate_config": true, "_use_msgpack_checkpoints": false, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "env_task_fn": -1, "enable_connectors": -1, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.161583927863, "kl_target": 0.0201019014258, "vf_loss_coeff": 0.7790510010087, "entropy_coeff": 0.0015431216992, "clip_param": 0.2459212356676, "vf_clip_param": 0.3769744131561, "entropy_coeff_schedule": null, "lr_schedule": null, "sgd_minibatch_size": -1, "vf_share_layers": -1, "differentiable_learner_configs": ["DifferentiableLearnerConfig(learner_class=<class 'source.intrinsic_attention_ppo.learners.IntrinsicAttentionPPOLearner.IntrinsicAttentionPPOLearner'>, learner_connector=None, add_default_connectors_to_learner_pipeline=True, is_multi_agent=False, policies_to_update=['default_policy'], lr=0.0060984166342, num_total_minibatches=0, num_epochs=1, minibatch_size=1000, shuffle_batch_per_epoch=True)"], "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9485408017724, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.callbacks.callbacks.RLlibCallback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 46.8492751121521, "iterations_since_restore": 4, "perf": {"cpu_util_percent": 45.711764705882345, "ram_util_percent": 80.7}}
{"timers": {"training_iteration": 11.987886701901541, "restore_env_runners": 1.4352699849528726e-05, "training_step": 11.987685244537685, "env_runner_sampling_timer": 1.6087030648817908, "learner_update_timer": 10.167725900886849, "synch_weights": 0.0016707993383966967, "restore_eval_env_runners": 4.8315042346715924e-05, "evaluation_iteration": 0.1427376703414975, "synch_eval_env_connectors": 0.00025003752978867847, "synch_env_connectors": 4.237163397832774e-06}, "env_runners": {"rlmodule_inference_timer": 3.413341383519947e-05, "module_to_env_connector": {"timers": {"connectors": {"listify_data_for_vector_env": 1.0762566368802409e-05, "un_batch_to_individual_items": 6.727337416027258e-06, "get_actions": 4.287386035994653e-05, "remove_single_ts_time_rank_from_batch": 1.2287434771712333e-05, "tensor_to_numpy": 1.6133433505813047e-05, "normalize_and_clip_actions": 8.225309611122625e-06}}, "connector_pipeline_timer": 0.0001241340897360857}, "module_episode_returns_mean": {"default_policy": -0.3400000000000001}, "episode_len_mean": 20.0, "episode_return_min": -10.5, "num_env_steps_sampled": 5000.0, "episode_return_max": 9.5, "env_to_module_sum_episodes_length_in": 10.36823839457432, "num_agent_steps_sampled": {"default_agent": 5000.0}, "episode_len_min": 20, "env_to_module_connector": {"connector_pipeline_timer": 6.126354037565881e-05, "timers": {"connectors": {"add_states_from_episodes_to_batch": 2.7839590221234506e-06, "batch_individual_items": 1.2718630697682246e-05, "numpy_to_tensor": 1.311845748523851e-05, "add_time_dim_to_batch_and_zero_pad": 7.18240101358311e-06, "add_observations_from_episodes_to_batch": 2.8903441989678352e-06}}}, "episode_len_max": 20, "num_episodes_lifetime": -92125.0, "env_step_timer": 1.4403085122329073e-05, "env_reset_timer": 4.355859967566702e-05, "weights_seq_no": 4.0, "episode_return_mean": -0.3400000000000001, "num_module_steps_sampled": {"default_policy": 5000.0}, "time_between_sampling": 0.04199797629330295, "num_env_steps_sampled_lifetime": -1842500.0, "agent_episode_returns_mean": {"default_agent": -0.3400000000000001}, "sample": 0.0058577849619670915, "num_agent_steps_sampled_lifetime": {"default_agent": -1842500.0}, "env_to_module_sum_episodes_length_out": 10.36823839457432, "episode_duration_sec_mean": 0.005507400341331962, "num_module_steps_sampled_lifetime": {"default_policy": -1842500.0}, "num_episodes": 250.0, "num_env_steps_sampled_lifetime_throughput": 3110.757221914744}, "__all_modules__": {"learner_connector_sum_episodes_length_in": 5000.0, "learner_connector": {"connector_pipeline_timer": 0.1725211345516769, "timers": {"connectors": {"add_one_ts_to_episodes_and_truncate": 0.009091301502966432, "add_observations_from_episodes_to_batch": 0.0008858475372949697, "add_columns_from_episodes_to_train_batch": 0.04180058030118331, "add_time_dim_to_batch_and_zero_pad": 0.10293328560914589, "add_states_from_episodes_to_batch": 0.0034640335483980492, "batch_individual_items": 0.014145261066436437, "numpy_to_tensor": 6.195614292035462e-05}}}, "learner_connector_sum_episodes_length_out": 5250.0}, "learners": {"default_policy": {"num_module_steps_trained": 5994, "curr_kl_coeff": 0.0050494978204369545, "num_module_steps_trained_lifetime": 29970, "num_trainable_parameters": 16595, "diff_num_grad_updates_vs_sampler_policy": 1.0, "weights_seq_no": 5.0, "use_intrinsic_rewards": 0.0, "total_loss": 0.2039257287979126, "vf_loss": 0.2638728618621826, "mean_kl_loss": 3.9648399251746014e-05, "vf_loss_unclipped": 38.83375930786133, "curr_entropy_coeff": 0.0015431216992, "policy_loss": -0.0005785937537439167, "entropy": 0.6911320090293884, "vf_explained_var": -0.0004652738571166992, "module_train_batch_size_mean": 999.0, "num_module_steps_trained_lifetime_throughput": 648.7265639064233}, "intrinsic_reward_module": {"default_optimizer_learning_rate": 0.0002715581955, "num_module_steps_trained_lifetime": 29970, "num_trainable_parameters": 8266, "diff_num_grad_updates_vs_sampler_policy": 1.0, "total_loss": 0.0, "weights_seq_no": 5.0, "curr_entropy_coeff": 0.0015431216992, "module_train_batch_size_mean": 999.0, "num_module_steps_trained": 5994, "gradients_default_optimizer_global_norm": 0.0, "num_module_steps_trained_lifetime_throughput": 648.7370211862587}, "__all_modules__": {"num_env_steps_trained": 31500, "num_non_trainable_parameters": 0, "num_module_steps_trained": 11988, "num_env_steps_trained_lifetime": 157500, "num_module_steps_trained_lifetime": 59940, "num_trainable_parameters": 24861, "num_env_steps_trained_lifetime_throughput": 3409.2977657226, "num_module_steps_trained_throughput": 29526719.312723074, "num_module_steps_trained_lifetime_throughput": 13015654.15271227}, "differentiable_learners": {"intrinsic_attention_ppo_learner": {"default_policy": {"use_intrinsic_rewards": 1.0, "vf_loss": 0.26428577303886414, "vf_loss_unclipped": 38.75017547607422, "policy_loss": -0.0005431475001387298, "num_module_steps_trained": 35964, "entropy": 0.6911650896072388, "vf_explained_var": 0.0010333657264709473, "module_train_batch_size_mean": 999.0, "num_module_steps_trained_lifetime": 179820, "total_loss": 0.2042880803346634, "diff_num_grad_updates_vs_sampler_policy": 26.0, "mean_kl_loss": 3.509373709675856e-05, "weights_seq_no": 30.0}, "__all_modules__": {"num_env_steps_trained": 189000, "num_module_steps_trained": 71928, "num_env_steps_trained_lifetime": 945000, "num_module_steps_trained_lifetime": 359640, "num_env_steps_trained_lifetime_throughput": 47320.24572828826}, "intrinsic_reward_module": {"num_module_steps_trained": 35964, "module_train_batch_size_mean": 999.0, "num_module_steps_trained_lifetime": 179820, "total_loss": 0.0, "diff_num_grad_updates_vs_sampler_policy": 26.0, "weights_seq_no": 30.0}}}, "IntrinsicAttentionMask": [[[0.3324126601219177, 0.33291128277778625, 0.33467599749565125], [0.3326374888420105, 0.333014577627182, 0.3343479335308075], [0.33343034982681274, 0.3333776891231537, 0.33319196105003357]], [[0.333376407623291, 0.3332821726799011, 0.33334147930145264], [0.33343905210494995, 0.33320772647857666, 0.33335328102111816], [0.33339962363243103, 0.3332545757293701, 0.33334586024284363]], [[0.3332633078098297, 0.3332482576370239, 0.33348843455314636], [0.33324140310287476, 0.3332216441631317, 0.33353695273399353], [0.33359068632125854, 0.33364608883857727, 0.3327632248401642]], [[0.3332251012325287, 0.33337366580963135, 0.3334012031555176], [0.33332493901252747, 0.3333364725112915, 0.33333858847618103], [0.3333434462547302, 0.33332955837249756, 0.33332696557044983]], [[0.3332218527793884, 0.3336280584335327, 0.33315008878707886], [0.3334593176841736, 0.3330000638961792, 0.33354055881500244], [0.3331798315048218, 0.33373910188674927, 0.33308106660842896]], [[0.3337322771549225, 0.33215251564979553, 0.3341151475906372], [0.3351402282714844, 0.32796135544776917, 0.33689841628074646], [0.3333888649940491, 0.33316922187805176, 0.33344194293022156]]]}, "num_training_step_calls_per_iteration": 1, "evaluation": {"env_runners": {"module_episode_returns_mean": {"default_policy": -1.35}, "num_env_steps_sampled_lifetime": 25400, "sample": 0.129889259388772, "num_episodes": 20, "env_to_module_connector": {"timers": {"connectors": {"batch_individual_items": 1.2487707981860536e-05, "numpy_to_tensor": 1.2002529631944382e-05, "add_time_dim_to_batch_and_zero_pad": 6.965829616891042e-06, "add_states_from_episodes_to_batch": 2.7093700308322312e-06, "add_observations_from_episodes_to_batch": 2.7904315888956965e-06}}, "connector_pipeline_timer": 5.902957849230588e-05}, "episode_return_min": -14.5, "num_agent_steps_sampled_lifetime": {"default_agent": 2000}, "episode_return_mean": -1.35, "module_to_env_connector": {"timers": {"connectors": {"remove_single_ts_time_rank_from_batch": 1.1860657905532004e-05, "un_batch_to_individual_items": 6.4924130660316355e-06, "listify_data_for_vector_env": 1.0283047274376062e-05, "get_actions": 3.5315386746911036e-05, "tensor_to_numpy": 1.5251598918773505e-05, "normalize_and_clip_actions": 8.016804216161753e-06}}, "connector_pipeline_timer": 0.0001134332407447685}, "episode_duration_sec_mean": 0.006679781248094514, "num_env_steps_sampled": 400, "episode_return_max": 13.5, "env_to_module_sum_episodes_length_in": 10.368238387501162, "num_episodes_lifetime": 100, "env_to_module_sum_episodes_length_out": 10.368238387501162, "num_agent_steps_sampled": {"default_agent": 400}, "episode_len_mean": 20.0, "episode_len_min": 20, "agent_episode_returns_mean": {"default_agent": -1.35}, "num_module_steps_sampled_lifetime": {"default_policy": 2000}, "env_reset_timer": 0.000751393004010739, "rlmodule_inference_timer": 3.1246218719796085e-05, "num_module_steps_sampled": {"default_policy": 400}, "episode_len_max": 20, "env_step_timer": 1.3698921766711565e-05, "weights_seq_no": 5.0, "time_between_sampling": 11.14696940296648}, "num_healthy_workers": 1, "actor_manager_num_outstanding_async_reqs": 0, "num_remote_worker_restarts": 0}, "num_env_steps_sampled_lifetime": -1842500.0, "fault_tolerance": {"num_healthy_workers": 0, "num_remote_worker_restarts": 0}, "env_runner_group": {"actor_manager_num_outstanding_async_reqs": 0}, "done": false, "training_iteration": 5, "trial_id": "b7d85_00000", "date": "2025-08-11_18-01-06", "timestamp": 1754928066, "time_this_iter_s": 11.864217042922974, "time_total_s": 58.71349215507507, "pid": 10036, "hostname": "Mac", "node_ip": "127.0.0.1", "config": {"exploration_config": {}, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 2, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "env": "Umbrella", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": false, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 0, "create_local_env_runner": true, "num_envs_per_env_runner": 1, "gym_env_vectorize_mode": "SYNC", "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "episodes_to_numpy": true, "max_requests_in_flight_per_env_runner": 1, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "merge_env_runner_states": "training_only", "broadcast_env_runner_states": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "complete_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "sampler_perf_stats_ema_coef": null, "_is_online": true, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": "auto", "num_aggregator_actors_per_learner": 0, "max_requests_in_flight_per_aggregator_actor": 3, "local_gpu_idx": 0, "max_requests_in_flight_per_learner": 3, "gamma": 1, "lr": 0.0002715581955, "grad_clip": 0.5, "grad_clip_by": "global_norm", "_train_batch_size_per_learner": 5000, "train_batch_size": 4000, "num_epochs": 1, "minibatch_size": 1000, "shuffle_batch_per_epoch": true, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "log_std_clip_param": 20.0, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "_disable_preprocessor_api": false, "_disable_action_flattening": false}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {"intrinsic_reward_coeff": 0.2795015916508}, "optimizer": {}, "_learner_class": "<class 'source.intrinsic_attention_ppo.learners.IntrinsicAttentionMetaLearner.IntrinsicAttentionMetaLearner'>", "callbacks_on_algorithm_init": null, "callbacks_on_env_runners_recreated": null, "callbacks_on_offline_eval_runners_recreated": null, "callbacks_on_checkpoint_loaded": null, "callbacks_on_environment_created": null, "callbacks_on_episode_created": null, "callbacks_on_episode_start": null, "callbacks_on_episode_step": null, "callbacks_on_episode_end": null, "callbacks_on_evaluate_start": null, "callbacks_on_evaluate_end": null, "callbacks_on_evaluate_offline_start": null, "callbacks_on_evaluate_offline_end": null, "callbacks_on_sample_end": null, "callbacks_on_train_result": null, "explore": true, "enable_rl_module_and_learner": true, "enable_env_runner_and_connector_v2": true, "_prior_exploration_config": {"type": "StochasticSampling"}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x155e4d8a0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "offline_data_class": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_read_batch_size": null, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "materialize_data": false, "materialize_mapped_data": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "ignore_final_observation": false, "prelearner_class": null, "prelearner_buffer_class": null, "prelearner_buffer_kwargs": {}, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_remaining_data": false, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": 1, "evaluation_duration": 20, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_auto_duration_min_env_steps_per_sample": 100, "evaluation_auto_duration_max_env_steps_per_sample": 2000, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 1, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "offline_evaluation_interval": null, "num_offline_eval_runners": 0, "offline_loss_for_module_fn": null, "offline_evaluation_duration": 1, "offline_evaluation_parallel_to_training": false, "offline_evaluation_timeout_s": 120.0, "num_cpus_per_offline_eval_runner": 1, "num_gpus_per_offline_eval_runner": 0, "custom_resources_per_offline_eval_runner": {}, "restart_failed_offline_eval_runners": true, "ignore_offline_eval_runner_failures": false, "max_num_offline_eval_runner_restarts": 1000, "offline_eval_runner_restore_timeout_s": 1800.0, "max_requests_in_flight_per_offline_eval_runner": 1, "validate_offline_eval_runners_after_construction": true, "offline_eval_runner_health_probe_timeout_s": 30.0, "offline_eval_rl_module_inference_only": false, "broadcast_offline_eval_runner_states": false, "offline_eval_batch_size_per_runner": 256, "dataset_num_iters_per_eval_runner": 1, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "log_gradients": false, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 10, "restart_failed_env_runners": true, "ignore_env_runner_failures": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30.0, "env_runner_restore_timeout_s": 1800.0, "_model_config": {}, "_rl_module_spec": "MultiRLModuleSpec(multi_rl_module_class=<class 'ray.rllib.core.rl_module.multi_rl_module.MultiRLModule'>, observation_space=None, action_space=None, inference_only=False, model_config=None, rl_module_specs={'default_policy': RLModuleSpec(module_class=<class 'source.intrinsic_attention_ppo.rl_modules.DifferentiablePPOModule.DifferentiablePPOModule'>, observation_space=None, action_space=None, inference_only=False, learner_only=False, model_config={'vf_share_layers': True, 'embedding_dim': 62, 'max_seq_len': 3, 'policy_head_hidden_sizes': [32], 'value_head_hidden_sizes': [101], 'embedding_hidden_sizes': [121]}, catalog_class=None, load_state_path=None, model_config_dict=None), 'intrinsic_reward_module': RLModuleSpec(module_class=<class 'source.intrinsic_attention_ppo.rl_modules.IntrinsicAttentionModule.IntrinsicAttentionModule'>, observation_space=None, action_space=None, inference_only=False, learner_only=True, model_config={'intrinsic_reward_network': {'encoder_hidden_sizes': [], 'encoding_dim': 1, 'num_heads': 1, 'head_hidden_sizes': None, 'layers': [{'type': 'attention'}]}, 'extrinsic_value_hidden_layers': [127, 60], 'vf_share_layers': True, 'max_seq_len': 3}, catalog_class=None, load_state_path=None, model_config_dict=None)}, load_state_path=None, modules_to_load=None, module_specs={'default_policy': RLModuleSpec(module_class=<class 'source.intrinsic_attention_ppo.rl_modules.DifferentiablePPOModule.DifferentiablePPOModule'>, observation_space=None, action_space=None, inference_only=False, learner_only=False, model_config={'vf_share_layers': True, 'embedding_dim': 62, 'max_seq_len': 3, 'policy_head_hidden_sizes': [32], 'value_head_hidden_sizes': [101], 'embedding_hidden_sizes': [121]}, catalog_class=None, load_state_path=None, model_config_dict=None), 'intrinsic_reward_module': RLModuleSpec(module_class=<class 'source.intrinsic_attention_ppo.rl_modules.IntrinsicAttentionModule.IntrinsicAttentionModule'>, observation_space=None, action_space=None, inference_only=False, learner_only=True, model_config={'intrinsic_reward_network': {'encoder_hidden_sizes': [], 'encoding_dim': 1, 'num_heads': 1, 'head_hidden_sizes': None, 'layers': [{'type': 'attention'}]}, 'extrinsic_value_hidden_layers': [127, 60], 'vf_share_layers': True, 'max_seq_len': 3}, catalog_class=None, load_state_path=None, model_config_dict=None)})", "algorithm_config_overrides_per_module": {"intrinsic_reward_module": {"lr": 0.0002715581955}}, "_per_module_overrides": {}, "_validate_config": true, "_use_msgpack_checkpoints": false, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "env_task_fn": -1, "enable_connectors": -1, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.161583927863, "kl_target": 0.0201019014258, "vf_loss_coeff": 0.7790510010087, "entropy_coeff": 0.0015431216992, "clip_param": 0.2459212356676, "vf_clip_param": 0.3769744131561, "entropy_coeff_schedule": null, "lr_schedule": null, "sgd_minibatch_size": -1, "vf_share_layers": -1, "differentiable_learner_configs": ["DifferentiableLearnerConfig(learner_class=<class 'source.intrinsic_attention_ppo.learners.IntrinsicAttentionPPOLearner.IntrinsicAttentionPPOLearner'>, learner_connector=None, add_default_connectors_to_learner_pipeline=True, is_multi_agent=False, policies_to_update=['default_policy'], lr=0.0060984166342, num_total_minibatches=0, num_epochs=1, minibatch_size=1000, shuffle_batch_per_epoch=True)"], "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9485408017724, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.callbacks.callbacks.RLlibCallback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 58.71349215507507, "iterations_since_restore": 5, "perf": {"cpu_util_percent": 44.74117647058823, "ram_util_percent": 79.87647058823529}}
{"timers": {"training_iteration": 11.979571252381945, "restore_env_runners": 1.435750226918601e-05, "training_step": 11.979369055842005, "env_runner_sampling_timer": 1.6083147979832337, "learner_update_timer": 10.15955292062744, "synch_weights": 0.0016686146849362008, "restore_eval_env_runners": 4.7938971900418395e-05, "evaluation_iteration": 0.14254311613708767, "synch_eval_env_connectors": 0.0002488921543310512, "synch_env_connectors": 4.23687124608201e-06}, "env_runners": {"rlmodule_inference_timer": 3.342878177040117e-05, "module_to_env_connector": {"timers": {"connectors": {"listify_data_for_vector_env": 1.0513657961087231e-05, "un_batch_to_individual_items": 6.558084497915412e-06, "get_actions": 4.167176901621546e-05, "remove_single_ts_time_rank_from_batch": 1.2082575178369987e-05, "tensor_to_numpy": 1.5806536787998587e-05, "normalize_and_clip_actions": 8.07434583410787e-06}}, "connector_pipeline_timer": 0.00012133678686096058}, "module_episode_returns_mean": {"default_policy": 0.54}, "episode_len_mean": 20.0, "episode_return_min": -10.5, "num_env_steps_sampled": 5000.0, "episode_return_max": 9.5, "env_to_module_sum_episodes_length_in": 10.36823839457432, "num_agent_steps_sampled": {"default_agent": 5000.0}, "episode_len_min": 20, "env_to_module_connector": {"connector_pipeline_timer": 6.0038363058671245e-05, "timers": {"connectors": {"add_states_from_episodes_to_batch": 2.7300682336680182e-06, "batch_individual_items": 1.2477091066092846e-05, "numpy_to_tensor": 1.2782693802253745e-05, "add_time_dim_to_batch_and_zero_pad": 7.0199294289304165e-06, "add_observations_from_episodes_to_batch": 2.804260880015321e-06}}}, "episode_len_max": 20, "num_episodes_lifetime": -123000.0, "env_step_timer": 1.405716731792438e-05, "env_reset_timer": 4.2253248749797816e-05, "weights_seq_no": 5.0, "episode_return_mean": 0.54, "num_module_steps_sampled": {"default_policy": 5000.0}, "time_between_sampling": 0.04165257271953009, "num_env_steps_sampled_lifetime": -2460000.0, "agent_episode_returns_mean": {"default_agent": 0.54}, "sample": 0.005764646814490462, "num_agent_steps_sampled_lifetime": {"default_agent": -2460000.0}, "env_to_module_sum_episodes_length_out": 10.36823839457432, "episode_duration_sec_mean": 0.005394428835250436, "num_module_steps_sampled_lifetime": {"default_policy": -2460000.0}, "num_episodes": 250.0, "num_env_steps_sampled_lifetime_throughput": 3192.676245955931}, "__all_modules__": {"learner_connector_sum_episodes_length_in": 5000.0, "learner_connector": {"connector_pipeline_timer": 0.17265251820571376, "timers": {"connectors": {"add_one_ts_to_episodes_and_truncate": 0.009089145157947974, "add_observations_from_episodes_to_batch": 0.0008853078121097746, "add_columns_from_episodes_to_train_batch": 0.04185380074869145, "add_time_dim_to_batch_and_zero_pad": 0.1030148844124046, "add_states_from_episodes_to_batch": 0.0034685978036351245, "batch_individual_items": 0.014139692205234736, "numpy_to_tensor": 6.221283146946989e-05}}}, "learner_connector_sum_episodes_length_out": 5250.0}, "learners": {"default_policy": {"num_module_steps_trained": 5994, "curr_kl_coeff": 0.0025247489102184772, "num_module_steps_trained_lifetime": 35964, "num_trainable_parameters": 16595, "diff_num_grad_updates_vs_sampler_policy": 1.0, "weights_seq_no": 6.0, "use_intrinsic_rewards": 0.0, "total_loss": 0.20433668792247772, "vf_loss": 0.2638755142688751, "mean_kl_loss": 3.353858119226061e-05, "vf_loss_unclipped": 38.21855926513672, "curr_entropy_coeff": 0.0015431216992, "policy_loss": -0.00017021282110363245, "entropy": 0.690653383731842, "vf_explained_var": -0.00044906139373779297, "module_train_batch_size_mean": 999.0, "num_module_steps_trained_lifetime_throughput": 645.983814085722}, "intrinsic_reward_module": {"default_optimizer_learning_rate": 0.0002715581955, "num_module_steps_trained_lifetime": 35964, "num_trainable_parameters": 8266, "diff_num_grad_updates_vs_sampler_policy": 1.0, "total_loss": 0.0, "weights_seq_no": 6.0, "curr_entropy_coeff": 0.0015431216992, "module_train_batch_size_mean": 999.0, "num_module_steps_trained": 5994, "gradients_default_optimizer_global_norm": 0.0, "num_module_steps_trained_lifetime_throughput": 645.993807819541}, "__all_modules__": {"num_env_steps_trained": 31500, "num_non_trainable_parameters": 0, "num_module_steps_trained": 11988, "num_env_steps_trained_lifetime": 189000, "num_module_steps_trained_lifetime": 71928, "num_trainable_parameters": 24861, "num_env_steps_trained_lifetime_throughput": 3394.881039849687, "num_module_steps_trained_throughput": 28699819.062073406, "num_module_steps_trained_lifetime_throughput": 12989556.941747779}, "differentiable_learners": {"intrinsic_attention_ppo_learner": {"default_policy": {"use_intrinsic_rewards": 1.0, "vf_loss": 0.2641426622867584, "vf_loss_unclipped": 38.19318389892578, "policy_loss": -0.00016731317737139761, "num_module_steps_trained": 35964, "entropy": 0.6906630396842957, "vf_explained_var": 0.0010298490524291992, "module_train_batch_size_mean": 999.0, "num_module_steps_trained_lifetime": 215784, "total_loss": 0.2045527547597885, "diff_num_grad_updates_vs_sampler_policy": 31.0, "mean_kl_loss": 3.241041849832982e-05, "weights_seq_no": 36.0}, "__all_modules__": {"num_env_steps_trained": 189000, "num_module_steps_trained": 71928, "num_env_steps_trained_lifetime": 1134000, "num_module_steps_trained_lifetime": 431568, "num_env_steps_trained_lifetime_throughput": 46491.16522062869}, "intrinsic_reward_module": {"num_module_steps_trained": 35964, "module_train_batch_size_mean": 999.0, "num_module_steps_trained_lifetime": 215784, "total_loss": 0.0, "diff_num_grad_updates_vs_sampler_policy": 31.0, "weights_seq_no": 36.0}}}, "IntrinsicAttentionMask": [[[0.3332371115684509, 0.3332761228084564, 0.33348673582077026], [0.33324870467185974, 0.333283007144928, 0.3334682285785675], [0.3333113491535187, 0.3333202600479126, 0.33336836099624634]], [[0.33305618166923523, 0.3338043987751007, 0.33313944935798645], [0.3336184322834015, 0.3328489363193512, 0.3335326313972473], [0.33311882615089417, 0.3336979150772095, 0.33318328857421875]], [[0.33316925168037415, 0.3337670862674713, 0.3330637216567993], [0.33340683579444885, 0.33313897252082825, 0.3334541916847229], [0.3331272006034851, 0.33387812972068787, 0.332994669675827]], [[0.3332251012325287, 0.33337366580963135, 0.3334012031555176], [0.33332493901252747, 0.3333364725112915, 0.33333858847618103], [0.3333434462547302, 0.33332955837249756, 0.33332696557044983]], [[0.33328717947006226, 0.33327725529670715, 0.3334355056285858], [0.3332652747631073, 0.33325067162513733, 0.333484023809433], [0.3336145579814911, 0.3336750864982605, 0.3327103853225708]], [[0.3333110213279724, 0.33347582817077637, 0.33321312069892883], [0.3338097333908081, 0.3302435874938965, 0.3359466791152954], [0.33300647139549255, 0.3354024887084961, 0.33159103989601135]]]}, "num_training_step_calls_per_iteration": 1, "evaluation": {"env_runners": {"module_episode_returns_mean": {"default_policy": -1.35}, "num_env_steps_sampled_lifetime": 30400, "sample": 0.1297167638851498, "num_episodes": 20, "env_to_module_connector": {"timers": {"connectors": {"batch_individual_items": 1.2506952144888871e-05, "numpy_to_tensor": 1.2091049045470832e-05, "add_time_dim_to_batch_and_zero_pad": 7.038444330560319e-06, "add_states_from_episodes_to_batch": 2.7533954647262438e-06, "add_observations_from_episodes_to_batch": 2.790142109109611e-06}}, "connector_pipeline_timer": 5.933193384818152e-05}, "episode_return_min": -14.5, "num_agent_steps_sampled_lifetime": {"default_agent": 2400}, "episode_return_mean": -1.35, "module_to_env_connector": {"timers": {"connectors": {"remove_single_ts_time_rank_from_batch": 1.1924847957261344e-05, "un_batch_to_individual_items": 6.481209775153139e-06, "listify_data_for_vector_env": 1.029844336734847e-05, "get_actions": 3.54281151051726e-05, "tensor_to_numpy": 1.5172580606202527e-05, "normalize_and_clip_actions": 8.060674627791972e-06}}, "connector_pipeline_timer": 0.00011354911303935742}, "episode_duration_sec_mean": 0.006553117126459256, "num_env_steps_sampled": 400, "episode_return_max": 13.5, "env_to_module_sum_episodes_length_in": 10.368238394470474, "num_episodes_lifetime": 120, "env_to_module_sum_episodes_length_out": 10.368238394470474, "num_agent_steps_sampled": {"default_agent": 400}, "episode_len_mean": 20.0, "episode_len_min": 20, "agent_episode_returns_mean": {"default_agent": -1.35}, "num_module_steps_sampled_lifetime": {"default_policy": 2400}, "env_reset_timer": 0.0007446778239409037, "rlmodule_inference_timer": 3.0439096814013913e-05, "num_module_steps_sampled": {"default_policy": 400}, "episode_len_max": 20, "env_step_timer": 1.3714644198739335e-05, "weights_seq_no": 6.0, "time_between_sampling": 11.147341437277184}, "num_healthy_workers": 1, "actor_manager_num_outstanding_async_reqs": 0, "num_remote_worker_restarts": 0}, "num_env_steps_sampled_lifetime": -2460000.0, "fault_tolerance": {"num_healthy_workers": 0, "num_remote_worker_restarts": 0}, "env_runner_group": {"actor_manager_num_outstanding_async_reqs": 0}, "done": false, "training_iteration": 6, "trial_id": "b7d85_00000", "date": "2025-08-11_18-01-17", "timestamp": 1754928077, "time_this_iter_s": 11.277830839157104, "time_total_s": 69.99132299423218, "pid": 10036, "hostname": "Mac", "node_ip": "127.0.0.1", "config": {"exploration_config": {}, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 2, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "env": "Umbrella", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": false, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 0, "create_local_env_runner": true, "num_envs_per_env_runner": 1, "gym_env_vectorize_mode": "SYNC", "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "episodes_to_numpy": true, "max_requests_in_flight_per_env_runner": 1, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "merge_env_runner_states": "training_only", "broadcast_env_runner_states": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "complete_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "sampler_perf_stats_ema_coef": null, "_is_online": true, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": "auto", "num_aggregator_actors_per_learner": 0, "max_requests_in_flight_per_aggregator_actor": 3, "local_gpu_idx": 0, "max_requests_in_flight_per_learner": 3, "gamma": 1, "lr": 0.0002715581955, "grad_clip": 0.5, "grad_clip_by": "global_norm", "_train_batch_size_per_learner": 5000, "train_batch_size": 4000, "num_epochs": 1, "minibatch_size": 1000, "shuffle_batch_per_epoch": true, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "log_std_clip_param": 20.0, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "_disable_preprocessor_api": false, "_disable_action_flattening": false}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {"intrinsic_reward_coeff": 0.2795015916508}, "optimizer": {}, "_learner_class": "<class 'source.intrinsic_attention_ppo.learners.IntrinsicAttentionMetaLearner.IntrinsicAttentionMetaLearner'>", "callbacks_on_algorithm_init": null, "callbacks_on_env_runners_recreated": null, "callbacks_on_offline_eval_runners_recreated": null, "callbacks_on_checkpoint_loaded": null, "callbacks_on_environment_created": null, "callbacks_on_episode_created": null, "callbacks_on_episode_start": null, "callbacks_on_episode_step": null, "callbacks_on_episode_end": null, "callbacks_on_evaluate_start": null, "callbacks_on_evaluate_end": null, "callbacks_on_evaluate_offline_start": null, "callbacks_on_evaluate_offline_end": null, "callbacks_on_sample_end": null, "callbacks_on_train_result": null, "explore": true, "enable_rl_module_and_learner": true, "enable_env_runner_and_connector_v2": true, "_prior_exploration_config": {"type": "StochasticSampling"}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x155e4d8a0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "offline_data_class": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_read_batch_size": null, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "materialize_data": false, "materialize_mapped_data": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "ignore_final_observation": false, "prelearner_class": null, "prelearner_buffer_class": null, "prelearner_buffer_kwargs": {}, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_remaining_data": false, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": 1, "evaluation_duration": 20, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_auto_duration_min_env_steps_per_sample": 100, "evaluation_auto_duration_max_env_steps_per_sample": 2000, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 1, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "offline_evaluation_interval": null, "num_offline_eval_runners": 0, "offline_loss_for_module_fn": null, "offline_evaluation_duration": 1, "offline_evaluation_parallel_to_training": false, "offline_evaluation_timeout_s": 120.0, "num_cpus_per_offline_eval_runner": 1, "num_gpus_per_offline_eval_runner": 0, "custom_resources_per_offline_eval_runner": {}, "restart_failed_offline_eval_runners": true, "ignore_offline_eval_runner_failures": false, "max_num_offline_eval_runner_restarts": 1000, "offline_eval_runner_restore_timeout_s": 1800.0, "max_requests_in_flight_per_offline_eval_runner": 1, "validate_offline_eval_runners_after_construction": true, "offline_eval_runner_health_probe_timeout_s": 30.0, "offline_eval_rl_module_inference_only": false, "broadcast_offline_eval_runner_states": false, "offline_eval_batch_size_per_runner": 256, "dataset_num_iters_per_eval_runner": 1, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "log_gradients": false, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 10, "restart_failed_env_runners": true, "ignore_env_runner_failures": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30.0, "env_runner_restore_timeout_s": 1800.0, "_model_config": {}, "_rl_module_spec": "MultiRLModuleSpec(multi_rl_module_class=<class 'ray.rllib.core.rl_module.multi_rl_module.MultiRLModule'>, observation_space=None, action_space=None, inference_only=False, model_config=None, rl_module_specs={'default_policy': RLModuleSpec(module_class=<class 'source.intrinsic_attention_ppo.rl_modules.DifferentiablePPOModule.DifferentiablePPOModule'>, observation_space=None, action_space=None, inference_only=False, learner_only=False, model_config={'vf_share_layers': True, 'embedding_dim': 62, 'max_seq_len': 3, 'policy_head_hidden_sizes': [32], 'value_head_hidden_sizes': [101], 'embedding_hidden_sizes': [121]}, catalog_class=None, load_state_path=None, model_config_dict=None), 'intrinsic_reward_module': RLModuleSpec(module_class=<class 'source.intrinsic_attention_ppo.rl_modules.IntrinsicAttentionModule.IntrinsicAttentionModule'>, observation_space=None, action_space=None, inference_only=False, learner_only=True, model_config={'intrinsic_reward_network': {'encoder_hidden_sizes': [], 'encoding_dim': 1, 'num_heads': 1, 'head_hidden_sizes': None, 'layers': [{'type': 'attention'}]}, 'extrinsic_value_hidden_layers': [127, 60], 'vf_share_layers': True, 'max_seq_len': 3}, catalog_class=None, load_state_path=None, model_config_dict=None)}, load_state_path=None, modules_to_load=None, module_specs={'default_policy': RLModuleSpec(module_class=<class 'source.intrinsic_attention_ppo.rl_modules.DifferentiablePPOModule.DifferentiablePPOModule'>, observation_space=None, action_space=None, inference_only=False, learner_only=False, model_config={'vf_share_layers': True, 'embedding_dim': 62, 'max_seq_len': 3, 'policy_head_hidden_sizes': [32], 'value_head_hidden_sizes': [101], 'embedding_hidden_sizes': [121]}, catalog_class=None, load_state_path=None, model_config_dict=None), 'intrinsic_reward_module': RLModuleSpec(module_class=<class 'source.intrinsic_attention_ppo.rl_modules.IntrinsicAttentionModule.IntrinsicAttentionModule'>, observation_space=None, action_space=None, inference_only=False, learner_only=True, model_config={'intrinsic_reward_network': {'encoder_hidden_sizes': [], 'encoding_dim': 1, 'num_heads': 1, 'head_hidden_sizes': None, 'layers': [{'type': 'attention'}]}, 'extrinsic_value_hidden_layers': [127, 60], 'vf_share_layers': True, 'max_seq_len': 3}, catalog_class=None, load_state_path=None, model_config_dict=None)})", "algorithm_config_overrides_per_module": {"intrinsic_reward_module": {"lr": 0.0002715581955}}, "_per_module_overrides": {}, "_validate_config": true, "_use_msgpack_checkpoints": false, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "env_task_fn": -1, "enable_connectors": -1, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.161583927863, "kl_target": 0.0201019014258, "vf_loss_coeff": 0.7790510010087, "entropy_coeff": 0.0015431216992, "clip_param": 0.2459212356676, "vf_clip_param": 0.3769744131561, "entropy_coeff_schedule": null, "lr_schedule": null, "sgd_minibatch_size": -1, "vf_share_layers": -1, "differentiable_learner_configs": ["DifferentiableLearnerConfig(learner_class=<class 'source.intrinsic_attention_ppo.learners.IntrinsicAttentionPPOLearner.IntrinsicAttentionPPOLearner'>, learner_connector=None, add_default_connectors_to_learner_pipeline=True, is_multi_agent=False, policies_to_update=['default_policy'], lr=0.0060984166342, num_total_minibatches=0, num_epochs=1, minibatch_size=1000, shuffle_batch_per_epoch=True)"], "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9485408017724, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.callbacks.callbacks.RLlibCallback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 69.99132299423218, "iterations_since_restore": 6, "perf": {"cpu_util_percent": 37.987500000000004, "ram_util_percent": 79.67500000000001}}
{"timers": {"training_iteration": 11.973348453187242, "restore_env_runners": 1.4271006842939114e-05, "training_step": 11.97314588653395, "env_runner_sampling_timer": 1.6089509912535378, "learner_update_timer": 10.152601017251232, "synch_weights": 0.001661877697662465, "restore_eval_env_runners": 4.783833244605883e-05, "evaluation_iteration": 0.1423036024761233, "synch_eval_env_connectors": 0.00024809115250874807, "synch_env_connectors": 4.288252956441638e-06}, "env_runners": {"rlmodule_inference_timer": 3.284875441853447e-05, "module_to_env_connector": {"timers": {"connectors": {"listify_data_for_vector_env": 1.0414032790352282e-05, "un_batch_to_individual_items": 6.54197484623969e-06, "get_actions": 4.09089426726452e-05, "remove_single_ts_time_rank_from_batch": 1.2047600525775354e-05, "tensor_to_numpy": 1.5681091511453544e-05, "normalize_and_clip_actions": 8.015289798107554e-06}}, "connector_pipeline_timer": 0.00012010260471265966}, "module_episode_returns_mean": {"default_policy": 0.22}, "episode_len_mean": 20.0, "episode_return_min": -10.5, "num_env_steps_sampled": 5000.0, "episode_return_max": 9.5, "env_to_module_sum_episodes_length_in": 10.36823839457432, "num_agent_steps_sampled": {"default_agent": 5000.0}, "episode_len_min": 20, "env_to_module_connector": {"connector_pipeline_timer": 5.93725293139553e-05, "timers": {"connectors": {"add_states_from_episodes_to_batch": 2.7291010685788415e-06, "batch_individual_items": 1.2288944691393561e-05, "numpy_to_tensor": 1.2628035984286121e-05, "add_time_dim_to_batch_and_zero_pad": 6.943964805900702e-06, "add_observations_from_episodes_to_batch": 2.780452936546515e-06}}}, "episode_len_max": 20, "num_episodes_lifetime": -153875.0, "env_step_timer": 1.3881349794766979e-05, "env_reset_timer": 4.199558323741368e-05, "weights_seq_no": 6.0, "episode_return_mean": 0.22, "num_module_steps_sampled": {"default_policy": 5000.0}, "time_between_sampling": 0.03998489180822344, "num_env_steps_sampled_lifetime": -3077500.0, "agent_episode_returns_mean": {"default_agent": 0.22}, "sample": 0.005736333937609049, "num_agent_steps_sampled_lifetime": {"default_agent": -3077500.0}, "env_to_module_sum_episodes_length_out": 10.36823839457432, "episode_duration_sec_mean": 0.005317905350122599, "num_module_steps_sampled_lifetime": {"default_policy": -3077500.0}, "num_episodes": 250.0, "num_env_steps_sampled_lifetime_throughput": 3197.109364261398}, "__all_modules__": {"learner_connector_sum_episodes_length_in": 5000.0, "learner_connector": {"connector_pipeline_timer": 0.17264937969342092, "timers": {"connectors": {"add_one_ts_to_episodes_and_truncate": 0.0090849682863251, "add_observations_from_episodes_to_batch": 0.0008858205643263056, "add_columns_from_episodes_to_train_batch": 0.0418575302417485, "add_time_dim_to_batch_and_zero_pad": 0.10302604306884412, "add_states_from_episodes_to_batch": 0.003471402666367215, "batch_individual_items": 0.01412247695401763, "numpy_to_tensor": 6.243195403073996e-05}}}, "learner_connector_sum_episodes_length_out": 5250.0}, "learners": {"default_policy": {"num_module_steps_trained": 5994, "curr_kl_coeff": 0.0012623744551092386, "num_module_steps_trained_lifetime": 41958, "num_trainable_parameters": 16595, "diff_num_grad_updates_vs_sampler_policy": 1.0, "weights_seq_no": 7.0, "use_intrinsic_rewards": 0.0, "total_loss": 0.2037929743528366, "vf_loss": 0.26387354731559753, "mean_kl_loss": 0.000141844036988914, "vf_loss_unclipped": 38.85084915161133, "curr_entropy_coeff": 0.0015431216992, "policy_loss": -0.0007147014257498085, "entropy": 0.6892695426940918, "vf_explained_var": -0.0004292726516723633, "module_train_batch_size_mean": 999.0, "num_module_steps_trained_lifetime_throughput": 643.1635571989281}, "intrinsic_reward_module": {"default_optimizer_learning_rate": 0.0002715581955, "num_module_steps_trained_lifetime": 41958, "num_trainable_parameters": 8266, "diff_num_grad_updates_vs_sampler_policy": 1.0, "total_loss": 0.0, "weights_seq_no": 7.0, "curr_entropy_coeff": 0.0015431216992, "module_train_batch_size_mean": 999.0, "num_module_steps_trained": 5994, "gradients_default_optimizer_global_norm": 0.0, "num_module_steps_trained_lifetime_throughput": 643.1730795012422}, "__all_modules__": {"num_env_steps_trained": 31500, "num_non_trainable_parameters": 0, "num_module_steps_trained": 11988, "num_env_steps_trained_lifetime": 220500, "num_module_steps_trained_lifetime": 83916, "num_trainable_parameters": 24861, "num_env_steps_trained_lifetime_throughput": 3380.056944147187, "num_module_steps_trained_throughput": 27855184.07385631, "num_module_steps_trained_lifetime_throughput": 12926188.670052966}, "differentiable_learners": {"intrinsic_attention_ppo_learner": {"default_policy": {"use_intrinsic_rewards": 1.0, "vf_loss": 0.2640642523765564, "vf_loss_unclipped": 38.774261474609375, "policy_loss": -0.0007017619209364057, "num_module_steps_trained": 35964, "entropy": 0.6892976760864258, "vf_explained_var": 0.0011487007141113281, "module_train_batch_size_mean": 999.0, "num_module_steps_trained_lifetime": 251748, "total_loss": 0.20397613942623138, "diff_num_grad_updates_vs_sampler_policy": 36.0, "mean_kl_loss": 0.00013647708692587912, "weights_seq_no": 42.0}, "__all_modules__": {"num_env_steps_trained": 189000, "num_module_steps_trained": 71928, "num_env_steps_trained_lifetime": 1323000, "num_module_steps_trained_lifetime": 503496, "num_env_steps_trained_lifetime_throughput": 45627.67496693085}, "intrinsic_reward_module": {"num_module_steps_trained": 35964, "module_train_batch_size_mean": 999.0, "num_module_steps_trained_lifetime": 251748, "total_loss": 0.0, "diff_num_grad_updates_vs_sampler_policy": 36.0, "weights_seq_no": 42.0}}}, "IntrinsicAttentionMask": [[[0.3320032060146332, 0.33373305201530457, 0.33426374197006226], [0.33312907814979553, 0.3333948254585266, 0.33347609639167786], [0.33347368240356445, 0.33329108357429504, 0.3332352638244629]], [[0.3331843316555023, 0.3333051800727844, 0.33351048827171326], [0.33335331082344055, 0.33333712816238403, 0.3333096206188202], [0.3336402475833893, 0.3333911597728729, 0.3329685926437378]], [[0.3333528935909271, 0.3333042860031128, 0.3333428204059601], [0.3336060047149658, 0.33292850852012634, 0.33346542716026306], [0.33340537548065186, 0.33322638273239136, 0.3333682417869568]], [[0.33332523703575134, 0.3335515558719635, 0.33312326669692993], [0.3333338797092438, 0.3333185911178589, 0.33334752917289734], [0.333317369222641, 0.3337595760822296, 0.33292296528816223]], [[0.33309656381607056, 0.3335026204586029, 0.3334008753299713], [0.33360132575035095, 0.33314186334609985, 0.33325690031051636], [0.3334748446941376, 0.33323222398757935, 0.33329296112060547]], [[0.33199673891067505, 0.33546510338783264, 0.3325382173061371], [0.337152361869812, 0.3272652328014374, 0.33558252453804016], [0.3328067362308502, 0.33417272567749023, 0.33302056789398193]]]}, "num_training_step_calls_per_iteration": 1, "evaluation": {"env_runners": {"module_episode_returns_mean": {"default_policy": -0.15}, "num_env_steps_sampled_lifetime": 35400, "sample": 0.12959348833616255, "num_episodes": 20, "env_to_module_connector": {"timers": {"connectors": {"batch_individual_items": 1.2921487996243575e-05, "numpy_to_tensor": 1.2623228261946628e-05, "add_time_dim_to_batch_and_zero_pad": 7.240521906473581e-06, "add_states_from_episodes_to_batch": 2.8322682082791565e-06, "add_observations_from_episodes_to_batch": 2.8261977706449392e-06}}, "connector_pipeline_timer": 6.080568072298654e-05}, "episode_return_min": -14.5, "num_agent_steps_sampled_lifetime": {"default_agent": 2800}, "episode_return_mean": -0.15, "module_to_env_connector": {"timers": {"connectors": {"remove_single_ts_time_rank_from_batch": 1.2046052684139664e-05, "un_batch_to_individual_items": 6.6265350229109934e-06, "listify_data_for_vector_env": 1.0692764697291471e-05, "get_actions": 3.676036576531233e-05, "tensor_to_numpy": 1.5485750690826946e-05, "normalize_and_clip_actions": 8.195635351909708e-06}}, "connector_pipeline_timer": 0.00011649063755978617}, "episode_duration_sec_mean": 0.005424591245828197, "num_env_steps_sampled": 400, "episode_return_max": 13.5, "env_to_module_sum_episodes_length_in": 10.368238394572801, "num_episodes_lifetime": 140, "env_to_module_sum_episodes_length_out": 10.368238394572801, "num_agent_steps_sampled": {"default_agent": 400}, "episode_len_mean": 20.0, "episode_len_min": 20, "agent_episode_returns_mean": {"default_agent": -0.15}, "num_module_steps_sampled_lifetime": {"default_policy": 2800}, "env_reset_timer": 0.0007402956254975407, "rlmodule_inference_timer": 3.154276910135474e-05, "num_module_steps_sampled": {"default_policy": 400}, "episode_len_max": 20, "env_step_timer": 1.429142664951359e-05, "weights_seq_no": 7.0, "time_between_sampling": 11.149680819984438}, "num_healthy_workers": 1, "actor_manager_num_outstanding_async_reqs": 0, "num_remote_worker_restarts": 0}, "num_env_steps_sampled_lifetime": -3077500.0, "fault_tolerance": {"num_healthy_workers": 0, "num_remote_worker_restarts": 0}, "env_runner_group": {"actor_manager_num_outstanding_async_reqs": 0}, "done": false, "training_iteration": 7, "trial_id": "b7d85_00000", "date": "2025-08-11_18-01-29", "timestamp": 1754928089, "time_this_iter_s": 11.485467910766602, "time_total_s": 81.47679090499878, "pid": 10036, "hostname": "Mac", "node_ip": "127.0.0.1", "config": {"exploration_config": {}, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 2, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "env": "Umbrella", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": false, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 0, "create_local_env_runner": true, "num_envs_per_env_runner": 1, "gym_env_vectorize_mode": "SYNC", "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "episodes_to_numpy": true, "max_requests_in_flight_per_env_runner": 1, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "merge_env_runner_states": "training_only", "broadcast_env_runner_states": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "complete_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "sampler_perf_stats_ema_coef": null, "_is_online": true, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": "auto", "num_aggregator_actors_per_learner": 0, "max_requests_in_flight_per_aggregator_actor": 3, "local_gpu_idx": 0, "max_requests_in_flight_per_learner": 3, "gamma": 1, "lr": 0.0002715581955, "grad_clip": 0.5, "grad_clip_by": "global_norm", "_train_batch_size_per_learner": 5000, "train_batch_size": 4000, "num_epochs": 1, "minibatch_size": 1000, "shuffle_batch_per_epoch": true, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "log_std_clip_param": 20.0, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "_disable_preprocessor_api": false, "_disable_action_flattening": false}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {"intrinsic_reward_coeff": 0.2795015916508}, "optimizer": {}, "_learner_class": "<class 'source.intrinsic_attention_ppo.learners.IntrinsicAttentionMetaLearner.IntrinsicAttentionMetaLearner'>", "callbacks_on_algorithm_init": null, "callbacks_on_env_runners_recreated": null, "callbacks_on_offline_eval_runners_recreated": null, "callbacks_on_checkpoint_loaded": null, "callbacks_on_environment_created": null, "callbacks_on_episode_created": null, "callbacks_on_episode_start": null, "callbacks_on_episode_step": null, "callbacks_on_episode_end": null, "callbacks_on_evaluate_start": null, "callbacks_on_evaluate_end": null, "callbacks_on_evaluate_offline_start": null, "callbacks_on_evaluate_offline_end": null, "callbacks_on_sample_end": null, "callbacks_on_train_result": null, "explore": true, "enable_rl_module_and_learner": true, "enable_env_runner_and_connector_v2": true, "_prior_exploration_config": {"type": "StochasticSampling"}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x155e4d8a0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "offline_data_class": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_read_batch_size": null, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "materialize_data": false, "materialize_mapped_data": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "ignore_final_observation": false, "prelearner_class": null, "prelearner_buffer_class": null, "prelearner_buffer_kwargs": {}, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_remaining_data": false, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": 1, "evaluation_duration": 20, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_auto_duration_min_env_steps_per_sample": 100, "evaluation_auto_duration_max_env_steps_per_sample": 2000, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 1, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "offline_evaluation_interval": null, "num_offline_eval_runners": 0, "offline_loss_for_module_fn": null, "offline_evaluation_duration": 1, "offline_evaluation_parallel_to_training": false, "offline_evaluation_timeout_s": 120.0, "num_cpus_per_offline_eval_runner": 1, "num_gpus_per_offline_eval_runner": 0, "custom_resources_per_offline_eval_runner": {}, "restart_failed_offline_eval_runners": true, "ignore_offline_eval_runner_failures": false, "max_num_offline_eval_runner_restarts": 1000, "offline_eval_runner_restore_timeout_s": 1800.0, "max_requests_in_flight_per_offline_eval_runner": 1, "validate_offline_eval_runners_after_construction": true, "offline_eval_runner_health_probe_timeout_s": 30.0, "offline_eval_rl_module_inference_only": false, "broadcast_offline_eval_runner_states": false, "offline_eval_batch_size_per_runner": 256, "dataset_num_iters_per_eval_runner": 1, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "log_gradients": false, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 10, "restart_failed_env_runners": true, "ignore_env_runner_failures": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30.0, "env_runner_restore_timeout_s": 1800.0, "_model_config": {}, "_rl_module_spec": "MultiRLModuleSpec(multi_rl_module_class=<class 'ray.rllib.core.rl_module.multi_rl_module.MultiRLModule'>, observation_space=None, action_space=None, inference_only=False, model_config=None, rl_module_specs={'default_policy': RLModuleSpec(module_class=<class 'source.intrinsic_attention_ppo.rl_modules.DifferentiablePPOModule.DifferentiablePPOModule'>, observation_space=None, action_space=None, inference_only=False, learner_only=False, model_config={'vf_share_layers': True, 'embedding_dim': 62, 'max_seq_len': 3, 'policy_head_hidden_sizes': [32], 'value_head_hidden_sizes': [101], 'embedding_hidden_sizes': [121]}, catalog_class=None, load_state_path=None, model_config_dict=None), 'intrinsic_reward_module': RLModuleSpec(module_class=<class 'source.intrinsic_attention_ppo.rl_modules.IntrinsicAttentionModule.IntrinsicAttentionModule'>, observation_space=None, action_space=None, inference_only=False, learner_only=True, model_config={'intrinsic_reward_network': {'encoder_hidden_sizes': [], 'encoding_dim': 1, 'num_heads': 1, 'head_hidden_sizes': None, 'layers': [{'type': 'attention'}]}, 'extrinsic_value_hidden_layers': [127, 60], 'vf_share_layers': True, 'max_seq_len': 3}, catalog_class=None, load_state_path=None, model_config_dict=None)}, load_state_path=None, modules_to_load=None, module_specs={'default_policy': RLModuleSpec(module_class=<class 'source.intrinsic_attention_ppo.rl_modules.DifferentiablePPOModule.DifferentiablePPOModule'>, observation_space=None, action_space=None, inference_only=False, learner_only=False, model_config={'vf_share_layers': True, 'embedding_dim': 62, 'max_seq_len': 3, 'policy_head_hidden_sizes': [32], 'value_head_hidden_sizes': [101], 'embedding_hidden_sizes': [121]}, catalog_class=None, load_state_path=None, model_config_dict=None), 'intrinsic_reward_module': RLModuleSpec(module_class=<class 'source.intrinsic_attention_ppo.rl_modules.IntrinsicAttentionModule.IntrinsicAttentionModule'>, observation_space=None, action_space=None, inference_only=False, learner_only=True, model_config={'intrinsic_reward_network': {'encoder_hidden_sizes': [], 'encoding_dim': 1, 'num_heads': 1, 'head_hidden_sizes': None, 'layers': [{'type': 'attention'}]}, 'extrinsic_value_hidden_layers': [127, 60], 'vf_share_layers': True, 'max_seq_len': 3}, catalog_class=None, load_state_path=None, model_config_dict=None)})", "algorithm_config_overrides_per_module": {"intrinsic_reward_module": {"lr": 0.0002715581955}}, "_per_module_overrides": {}, "_validate_config": true, "_use_msgpack_checkpoints": false, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "env_task_fn": -1, "enable_connectors": -1, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.161583927863, "kl_target": 0.0201019014258, "vf_loss_coeff": 0.7790510010087, "entropy_coeff": 0.0015431216992, "clip_param": 0.2459212356676, "vf_clip_param": 0.3769744131561, "entropy_coeff_schedule": null, "lr_schedule": null, "sgd_minibatch_size": -1, "vf_share_layers": -1, "differentiable_learner_configs": ["DifferentiableLearnerConfig(learner_class=<class 'source.intrinsic_attention_ppo.learners.IntrinsicAttentionPPOLearner.IntrinsicAttentionPPOLearner'>, learner_connector=None, add_default_connectors_to_learner_pipeline=True, is_multi_agent=False, policies_to_update=['default_policy'], lr=0.0060984166342, num_total_minibatches=0, num_epochs=1, minibatch_size=1000, shuffle_batch_per_epoch=True)"], "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9485408017724, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.callbacks.callbacks.RLlibCallback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 81.47679090499878, "iterations_since_restore": 7, "perf": {"cpu_util_percent": 40.01875, "ram_util_percent": 79.80625}}
{"timers": {"training_iteration": 11.973125593235222, "restore_env_runners": 1.4189126108470733e-05, "training_step": 11.97292241266841, "env_runner_sampling_timer": 1.6098470663413684, "learner_update_timer": 10.14846932999931, "synch_weights": 0.0016636580805755087, "restore_eval_env_runners": 4.749869872291767e-05, "evaluation_iteration": 0.14213420104131916, "synch_eval_env_connectors": 0.00024682982070080495, "synch_env_connectors": 4.299950586362561e-06}, "env_runners": {"rlmodule_inference_timer": 5.41483288705811e-05, "module_to_env_connector": {"timers": {"connectors": {"listify_data_for_vector_env": 1.065128150364763e-05, "un_batch_to_individual_items": 6.710261528581428e-06, "get_actions": 4.3219316450303794e-05, "remove_single_ts_time_rank_from_batch": 1.2224844312733355e-05, "tensor_to_numpy": 1.6097102182233603e-05, "normalize_and_clip_actions": 8.196006459620522e-06}}, "connector_pipeline_timer": 0.00012416583703400965}, "module_episode_returns_mean": {"default_policy": 0.7800000000000001}, "episode_len_mean": 20.0, "episode_return_min": -10.5, "num_env_steps_sampled": 5000.0, "episode_return_max": 9.5, "env_to_module_sum_episodes_length_in": 10.36823839457432, "num_agent_steps_sampled": {"default_agent": 5000.0}, "episode_len_min": 20, "env_to_module_connector": {"connector_pipeline_timer": 6.0471715061386795e-05, "timers": {"connectors": {"add_states_from_episodes_to_batch": 2.7535010669939604e-06, "batch_individual_items": 1.2474450621409722e-05, "numpy_to_tensor": 1.2996217692229385e-05, "add_time_dim_to_batch_and_zero_pad": 7.119582714218902e-06, "add_observations_from_episodes_to_batch": 2.8554100115550457e-06}}}, "episode_len_max": 20, "num_episodes_lifetime": -184750.0, "env_step_timer": 1.4366551425307416e-05, "env_reset_timer": 4.270658321678191e-05, "weights_seq_no": 7.0, "episode_return_mean": 0.7800000000000001, "num_module_steps_sampled": {"default_policy": 5000.0}, "time_between_sampling": 0.03989281944728444, "num_env_steps_sampled_lifetime": -3695000.0, "agent_episode_returns_mean": {"default_agent": 0.7800000000000001}, "sample": 0.0059706803813466295, "num_agent_steps_sampled_lifetime": {"default_agent": -3695000.0}, "env_to_module_sum_episodes_length_out": 10.36823839457432, "episode_duration_sec_mean": 0.00589691200107336, "num_module_steps_sampled_lifetime": {"default_policy": -3695000.0}, "num_episodes": 250.0, "num_env_steps_sampled_lifetime_throughput": 3130.99920564528}, "__all_modules__": {"learner_connector_sum_episodes_length_in": 5000.0, "learner_connector": {"connector_pipeline_timer": 0.17544786756703398, "timers": {"connectors": {"add_one_ts_to_episodes_and_truncate": 0.009116220692688094, "add_observations_from_episodes_to_batch": 0.0008868069481958377, "add_columns_from_episodes_to_train_batch": 0.04211581827836213, "add_time_dim_to_batch_and_zero_pad": 0.10539989429893978, "add_states_from_episodes_to_batch": 0.003493461969555692, "batch_individual_items": 0.014230926354522637, "numpy_to_tensor": 6.428305496916395e-05}}}, "learner_connector_sum_episodes_length_out": 5250.0}, "learners": {"default_policy": {"num_module_steps_trained": 5994, "curr_kl_coeff": 0.0006311872275546193, "num_module_steps_trained_lifetime": 47952, "num_trainable_parameters": 16595, "diff_num_grad_updates_vs_sampler_policy": 1.0, "weights_seq_no": 8.0, "use_intrinsic_rewards": 0.0, "total_loss": 0.20371368527412415, "vf_loss": 0.2638704180717468, "mean_kl_loss": 0.00011484237620607018, "vf_loss_unclipped": 37.84132385253906, "curr_entropy_coeff": 0.0015431216992, "policy_loss": -0.0007934169261716306, "entropy": 0.6879218816757202, "vf_explained_var": -0.0005568265914916992, "module_train_batch_size_mean": 999.0, "num_module_steps_trained_lifetime_throughput": 640.2265787149718}, "intrinsic_reward_module": {"default_optimizer_learning_rate": 0.0002715581955, "num_module_steps_trained_lifetime": 47952, "num_trainable_parameters": 8266, "diff_num_grad_updates_vs_sampler_policy": 1.0, "total_loss": 0.0, "weights_seq_no": 8.0, "curr_entropy_coeff": 0.0015431216992, "module_train_batch_size_mean": 999.0, "num_module_steps_trained": 5994, "gradients_default_optimizer_global_norm": 0.0, "num_module_steps_trained_lifetime_throughput": 640.2356344648975}, "__all_modules__": {"num_env_steps_trained": 31500, "num_non_trainable_parameters": 0, "num_module_steps_trained": 11988, "num_env_steps_trained_lifetime": 252000, "num_module_steps_trained_lifetime": 95904, "num_trainable_parameters": 24861, "num_env_steps_trained_lifetime_throughput": 3364.6194096236527, "num_module_steps_trained_throughput": 27049770.953989606, "num_module_steps_trained_lifetime_throughput": 12866562.809350729}, "differentiable_learners": {"intrinsic_attention_ppo_learner": {"default_policy": {"use_intrinsic_rewards": 1.0, "vf_loss": 0.2639870345592499, "vf_loss_unclipped": 37.83311080932617, "policy_loss": -0.0007719832938164473, "num_module_steps_trained": 35964, "entropy": 0.6879647374153137, "vf_explained_var": 0.001063525676727295, "module_train_batch_size_mean": 999.0, "num_module_steps_trained_lifetime": 287712, "total_loss": 0.20384332537651062, "diff_num_grad_updates_vs_sampler_policy": 41.0, "mean_kl_loss": 0.00010850185935851187, "weights_seq_no": 48.0}, "__all_modules__": {"num_env_steps_trained": 189000, "num_module_steps_trained": 71928, "num_env_steps_trained_lifetime": 1512000, "num_module_steps_trained_lifetime": 575424, "num_env_steps_trained_lifetime_throughput": 44743.53374392868}, "intrinsic_reward_module": {"num_module_steps_trained": 35964, "module_train_batch_size_mean": 999.0, "num_module_steps_trained_lifetime": 287712, "total_loss": 0.0, "diff_num_grad_updates_vs_sampler_policy": 41.0, "weights_seq_no": 48.0}}}, "IntrinsicAttentionMask": [[[0.33241334557533264, 0.33414533734321594, 0.3334413170814514], [0.3331921100616455, 0.333457887172699, 0.3333500027656555], [0.33287596702575684, 0.3337368369102478, 0.33338719606399536]], [[0.33305618166923523, 0.3338043987751007, 0.33313944935798645], [0.3336184322834015, 0.3328489363193512, 0.3335326313972473], [0.33311882615089417, 0.3336979150772095, 0.33318328857421875]], [[0.3328327238559723, 0.33369123935699463, 0.3334760069847107], [0.33333730697631836, 0.3333304822444916, 0.33333221077919006], [0.33321088552474976, 0.33342084288597107, 0.3333682417869568]], [[0.3332251012325287, 0.33337366580963135, 0.3334012031555176], [0.33332493901252747, 0.3333364725112915, 0.33333858847618103], [0.3333434462547302, 0.33332955837249756, 0.33332696557044983]], [[0.333319753408432, 0.33329057693481445, 0.33338966965675354], [0.3333175480365753, 0.3332836925983429, 0.3333987593650818], [0.33332499861717224, 0.3333071172237396, 0.33336788415908813]], [[0.33199673891067505, 0.33546510338783264, 0.3325382173061371], [0.337152361869812, 0.3272652328014374, 0.33558252453804016], [0.3328067362308502, 0.33417272567749023, 0.33302056789398193]]]}, "num_training_step_calls_per_iteration": 1, "evaluation": {"env_runners": {"module_episode_returns_mean": {"default_policy": -0.15}, "num_env_steps_sampled_lifetime": 40400, "sample": 0.12967604304351654, "num_episodes": 20, "env_to_module_connector": {"timers": {"connectors": {"batch_individual_items": 1.60684279287769e-05, "numpy_to_tensor": 1.561074637586851e-05, "add_time_dim_to_batch_and_zero_pad": 8.805273503329659e-06, "add_states_from_episodes_to_batch": 3.0064312303070525e-06, "add_observations_from_episodes_to_batch": 3.0680526272267436e-06}}, "connector_pipeline_timer": 7.102396586287201e-05}, "episode_return_min": -14.5, "num_agent_steps_sampled_lifetime": {"default_agent": 3200}, "episode_return_mean": -0.15, "module_to_env_connector": {"timers": {"connectors": {"remove_single_ts_time_rank_from_batch": 1.3240390149346217e-05, "un_batch_to_individual_items": 8.195164520841824e-06, "listify_data_for_vector_env": 1.1506113152910635e-05, "get_actions": 4.287494337099556e-05, "tensor_to_numpy": 1.7754602284692646e-05, "normalize_and_clip_actions": 8.946332476310145e-06}}, "connector_pipeline_timer": 0.00013241996513616228}, "episode_duration_sec_mean": 0.0056248545658309015, "num_env_steps_sampled": 400, "episode_return_max": 13.5, "env_to_module_sum_episodes_length_in": 10.3682383945743, "num_episodes_lifetime": 160, "env_to_module_sum_episodes_length_out": 10.3682383945743, "num_agent_steps_sampled": {"default_agent": 400}, "episode_len_mean": 20.0, "episode_len_min": 20, "agent_episode_returns_mean": {"default_agent": -0.15}, "num_module_steps_sampled_lifetime": {"default_policy": 3200}, "env_reset_timer": 0.0007365705889824226, "rlmodule_inference_timer": 3.588274079151625e-05, "num_module_steps_sampled": {"default_policy": 400}, "episode_len_max": 20, "env_step_timer": 1.758340903393161e-05, "weights_seq_no": 8.0, "time_between_sampling": 11.157998356363947}, "num_healthy_workers": 1, "actor_manager_num_outstanding_async_reqs": 0, "num_remote_worker_restarts": 0}, "num_env_steps_sampled_lifetime": -3695000.0, "fault_tolerance": {"num_healthy_workers": 0, "num_remote_worker_restarts": 0}, "env_runner_group": {"actor_manager_num_outstanding_async_reqs": 0}, "done": false, "training_iteration": 8, "trial_id": "b7d85_00000", "date": "2025-08-11_18-01-41", "timestamp": 1754928101, "time_this_iter_s": 12.102432012557983, "time_total_s": 93.57922291755676, "pid": 10036, "hostname": "Mac", "node_ip": "127.0.0.1", "config": {"exploration_config": {}, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 2, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "env": "Umbrella", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": false, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 0, "create_local_env_runner": true, "num_envs_per_env_runner": 1, "gym_env_vectorize_mode": "SYNC", "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "episodes_to_numpy": true, "max_requests_in_flight_per_env_runner": 1, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "merge_env_runner_states": "training_only", "broadcast_env_runner_states": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "complete_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "sampler_perf_stats_ema_coef": null, "_is_online": true, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": "auto", "num_aggregator_actors_per_learner": 0, "max_requests_in_flight_per_aggregator_actor": 3, "local_gpu_idx": 0, "max_requests_in_flight_per_learner": 3, "gamma": 1, "lr": 0.0002715581955, "grad_clip": 0.5, "grad_clip_by": "global_norm", "_train_batch_size_per_learner": 5000, "train_batch_size": 4000, "num_epochs": 1, "minibatch_size": 1000, "shuffle_batch_per_epoch": true, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "log_std_clip_param": 20.0, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "_disable_preprocessor_api": false, "_disable_action_flattening": false}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {"intrinsic_reward_coeff": 0.2795015916508}, "optimizer": {}, "_learner_class": "<class 'source.intrinsic_attention_ppo.learners.IntrinsicAttentionMetaLearner.IntrinsicAttentionMetaLearner'>", "callbacks_on_algorithm_init": null, "callbacks_on_env_runners_recreated": null, "callbacks_on_offline_eval_runners_recreated": null, "callbacks_on_checkpoint_loaded": null, "callbacks_on_environment_created": null, "callbacks_on_episode_created": null, "callbacks_on_episode_start": null, "callbacks_on_episode_step": null, "callbacks_on_episode_end": null, "callbacks_on_evaluate_start": null, "callbacks_on_evaluate_end": null, "callbacks_on_evaluate_offline_start": null, "callbacks_on_evaluate_offline_end": null, "callbacks_on_sample_end": null, "callbacks_on_train_result": null, "explore": true, "enable_rl_module_and_learner": true, "enable_env_runner_and_connector_v2": true, "_prior_exploration_config": {"type": "StochasticSampling"}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x155e4d8a0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "offline_data_class": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_read_batch_size": null, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "materialize_data": false, "materialize_mapped_data": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "ignore_final_observation": false, "prelearner_class": null, "prelearner_buffer_class": null, "prelearner_buffer_kwargs": {}, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_remaining_data": false, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": 1, "evaluation_duration": 20, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_auto_duration_min_env_steps_per_sample": 100, "evaluation_auto_duration_max_env_steps_per_sample": 2000, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 1, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "offline_evaluation_interval": null, "num_offline_eval_runners": 0, "offline_loss_for_module_fn": null, "offline_evaluation_duration": 1, "offline_evaluation_parallel_to_training": false, "offline_evaluation_timeout_s": 120.0, "num_cpus_per_offline_eval_runner": 1, "num_gpus_per_offline_eval_runner": 0, "custom_resources_per_offline_eval_runner": {}, "restart_failed_offline_eval_runners": true, "ignore_offline_eval_runner_failures": false, "max_num_offline_eval_runner_restarts": 1000, "offline_eval_runner_restore_timeout_s": 1800.0, "max_requests_in_flight_per_offline_eval_runner": 1, "validate_offline_eval_runners_after_construction": true, "offline_eval_runner_health_probe_timeout_s": 30.0, "offline_eval_rl_module_inference_only": false, "broadcast_offline_eval_runner_states": false, "offline_eval_batch_size_per_runner": 256, "dataset_num_iters_per_eval_runner": 1, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "log_gradients": false, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 10, "restart_failed_env_runners": true, "ignore_env_runner_failures": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30.0, "env_runner_restore_timeout_s": 1800.0, "_model_config": {}, "_rl_module_spec": "MultiRLModuleSpec(multi_rl_module_class=<class 'ray.rllib.core.rl_module.multi_rl_module.MultiRLModule'>, observation_space=None, action_space=None, inference_only=False, model_config=None, rl_module_specs={'default_policy': RLModuleSpec(module_class=<class 'source.intrinsic_attention_ppo.rl_modules.DifferentiablePPOModule.DifferentiablePPOModule'>, observation_space=None, action_space=None, inference_only=False, learner_only=False, model_config={'vf_share_layers': True, 'embedding_dim': 62, 'max_seq_len': 3, 'policy_head_hidden_sizes': [32], 'value_head_hidden_sizes': [101], 'embedding_hidden_sizes': [121]}, catalog_class=None, load_state_path=None, model_config_dict=None), 'intrinsic_reward_module': RLModuleSpec(module_class=<class 'source.intrinsic_attention_ppo.rl_modules.IntrinsicAttentionModule.IntrinsicAttentionModule'>, observation_space=None, action_space=None, inference_only=False, learner_only=True, model_config={'intrinsic_reward_network': {'encoder_hidden_sizes': [], 'encoding_dim': 1, 'num_heads': 1, 'head_hidden_sizes': None, 'layers': [{'type': 'attention'}]}, 'extrinsic_value_hidden_layers': [127, 60], 'vf_share_layers': True, 'max_seq_len': 3}, catalog_class=None, load_state_path=None, model_config_dict=None)}, load_state_path=None, modules_to_load=None, module_specs={'default_policy': RLModuleSpec(module_class=<class 'source.intrinsic_attention_ppo.rl_modules.DifferentiablePPOModule.DifferentiablePPOModule'>, observation_space=None, action_space=None, inference_only=False, learner_only=False, model_config={'vf_share_layers': True, 'embedding_dim': 62, 'max_seq_len': 3, 'policy_head_hidden_sizes': [32], 'value_head_hidden_sizes': [101], 'embedding_hidden_sizes': [121]}, catalog_class=None, load_state_path=None, model_config_dict=None), 'intrinsic_reward_module': RLModuleSpec(module_class=<class 'source.intrinsic_attention_ppo.rl_modules.IntrinsicAttentionModule.IntrinsicAttentionModule'>, observation_space=None, action_space=None, inference_only=False, learner_only=True, model_config={'intrinsic_reward_network': {'encoder_hidden_sizes': [], 'encoding_dim': 1, 'num_heads': 1, 'head_hidden_sizes': None, 'layers': [{'type': 'attention'}]}, 'extrinsic_value_hidden_layers': [127, 60], 'vf_share_layers': True, 'max_seq_len': 3}, catalog_class=None, load_state_path=None, model_config_dict=None)})", "algorithm_config_overrides_per_module": {"intrinsic_reward_module": {"lr": 0.0002715581955}}, "_per_module_overrides": {}, "_validate_config": true, "_use_msgpack_checkpoints": false, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "env_task_fn": -1, "enable_connectors": -1, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.161583927863, "kl_target": 0.0201019014258, "vf_loss_coeff": 0.7790510010087, "entropy_coeff": 0.0015431216992, "clip_param": 0.2459212356676, "vf_clip_param": 0.3769744131561, "entropy_coeff_schedule": null, "lr_schedule": null, "sgd_minibatch_size": -1, "vf_share_layers": -1, "differentiable_learner_configs": ["DifferentiableLearnerConfig(learner_class=<class 'source.intrinsic_attention_ppo.learners.IntrinsicAttentionPPOLearner.IntrinsicAttentionPPOLearner'>, learner_connector=None, add_default_connectors_to_learner_pipeline=True, is_multi_agent=False, policies_to_update=['default_policy'], lr=0.0060984166342, num_total_minibatches=0, num_epochs=1, minibatch_size=1000, shuffle_batch_per_epoch=True)"], "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9485408017724, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.callbacks.callbacks.RLlibCallback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 93.57922291755676, "iterations_since_restore": 8, "perf": {"cpu_util_percent": 45.29444444444445, "ram_util_percent": 81.6888888888889}}
{"timers": {"training_iteration": 11.967386711882991, "restore_env_runners": 1.410431560798421e-05, "training_step": 11.967183179791707, "env_runner_sampling_timer": 1.6094099781785025, "learner_update_timer": 10.14177899836982, "synch_weights": 0.0016650552494265054, "restore_eval_env_runners": 4.748246144533937e-05, "evaluation_iteration": 0.14219263528110446, "synch_eval_env_connectors": 0.00024642527161902424, "synch_env_connectors": 4.3727913106360446e-06}, "env_runners": {"rlmodule_inference_timer": 3.372277697804469e-05, "module_to_env_connector": {"timers": {"connectors": {"listify_data_for_vector_env": 1.050994623646628e-05, "un_batch_to_individual_items": 6.587501947496018e-06, "get_actions": 4.220004880509295e-05, "remove_single_ts_time_rank_from_batch": 1.2099755265473957e-05, "tensor_to_numpy": 1.5917079078986923e-05, "normalize_and_clip_actions": 8.053603495466734e-06}}, "connector_pipeline_timer": 0.00012202960715181226}, "module_episode_returns_mean": {"default_policy": 0.7000000000000002}, "episode_len_mean": 20.0, "episode_return_min": -10.5, "num_env_steps_sampled": 5000.0, "episode_return_max": 9.5, "env_to_module_sum_episodes_length_in": 10.36823839457432, "num_agent_steps_sampled": {"default_agent": 5000.0}, "episode_len_min": 20, "env_to_module_connector": {"connector_pipeline_timer": 6.004812917944886e-05, "timers": {"connectors": {"add_states_from_episodes_to_batch": 2.741162892838812e-06, "batch_individual_items": 1.2407008981681574e-05, "numpy_to_tensor": 1.2893677024636204e-05, "add_time_dim_to_batch_and_zero_pad": 7.053885252031346e-06, "add_observations_from_episodes_to_batch": 2.854672561728199e-06}}}, "episode_len_max": 20, "num_episodes_lifetime": -215625.0, "env_step_timer": 1.4179870910115419e-05, "env_reset_timer": 4.031206963414571e-05, "weights_seq_no": 8.0, "episode_return_mean": 0.7000000000000002, "num_module_steps_sampled": {"default_policy": 5000.0}, "time_between_sampling": 0.042019478673668974, "num_env_steps_sampled_lifetime": -4312500.0, "agent_episode_returns_mean": {"default_agent": 0.7000000000000002}, "sample": 0.006040329220276599, "num_agent_steps_sampled_lifetime": {"default_agent": -4312500.0}, "env_to_module_sum_episodes_length_out": 10.36823839457432, "episode_duration_sec_mean": 0.005406300653237851, "num_module_steps_sampled_lifetime": {"default_policy": -4312500.0}, "num_episodes": 250.0, "num_env_steps_sampled_lifetime_throughput": 3187.252792334292}, "__all_modules__": {"learner_connector_sum_episodes_length_in": 5000.0, "learner_connector": {"connector_pipeline_timer": 0.17673082889169842, "timers": {"connectors": {"add_one_ts_to_episodes_and_truncate": 0.009111418066507134, "add_observations_from_episodes_to_batch": 0.0008872597191862348, "add_columns_from_episodes_to_train_batch": 0.04211575759652675, "add_time_dim_to_batch_and_zero_pad": 0.10539783702596212, "add_states_from_episodes_to_batch": 0.0034965319395928716, "batch_individual_items": 0.015517427090465705, "numpy_to_tensor": 6.432189433642993e-05}}}, "learner_connector_sum_episodes_length_out": 5250.0}, "learners": {"default_policy": {"num_module_steps_trained": 5994, "curr_kl_coeff": 0.00031559361377730966, "num_module_steps_trained_lifetime": 53946, "num_trainable_parameters": 16595, "diff_num_grad_updates_vs_sampler_policy": 1.0, "weights_seq_no": 9.0, "use_intrinsic_rewards": 0.0, "total_loss": 0.20377954840660095, "vf_loss": 0.26386967301368713, "mean_kl_loss": 0.00011221104796277359, "vf_loss_unclipped": 37.947021484375, "curr_entropy_coeff": 0.0015431216992, "policy_loss": -0.0007294229581020772, "entropy": 0.6862872838973999, "vf_explained_var": -0.0004622936248779297, "module_train_batch_size_mean": 999.0, "num_module_steps_trained_lifetime_throughput": 637.4176018724472}, "intrinsic_reward_module": {"default_optimizer_learning_rate": 0.0002715581955, "num_module_steps_trained_lifetime": 53946, "num_trainable_parameters": 8266, "diff_num_grad_updates_vs_sampler_policy": 1.0, "total_loss": 0.0, "weights_seq_no": 9.0, "curr_entropy_coeff": 0.0015431216992, "module_train_batch_size_mean": 999.0, "num_module_steps_trained": 5994, "gradients_default_optimizer_global_norm": 0.0, "num_module_steps_trained_lifetime_throughput": 637.42619351947}, "__all_modules__": {"num_env_steps_trained": 31500, "num_non_trainable_parameters": 0, "num_module_steps_trained": 11988, "num_env_steps_trained_lifetime": 283500, "num_module_steps_trained_lifetime": 107892, "num_trainable_parameters": 24861, "num_env_steps_trained_lifetime_throughput": 3349.854581863615, "num_module_steps_trained_throughput": 26270797.304480404, "num_module_steps_trained_lifetime_throughput": 12806296.002504706}, "differentiable_learners": {"intrinsic_attention_ppo_learner": {"default_policy": {"use_intrinsic_rewards": 1.0, "vf_loss": 0.263939768075943, "vf_loss_unclipped": 37.92803192138672, "policy_loss": -0.0007113182218745351, "num_module_steps_trained": 35964, "entropy": 0.6863321661949158, "vf_explained_var": 0.001103520393371582, "module_train_batch_size_mean": 999.0, "num_module_steps_trained_lifetime": 323676, "total_loss": 0.20386932790279388, "diff_num_grad_updates_vs_sampler_policy": 46.0, "mean_kl_loss": 0.00010648014722391963, "weights_seq_no": 54.0}, "__all_modules__": {"num_env_steps_trained": 189000, "num_module_steps_trained": 71928, "num_env_steps_trained_lifetime": 1701000, "num_module_steps_trained_lifetime": 647352, "num_env_steps_trained_lifetime_throughput": 43868.9666003075}, "intrinsic_reward_module": {"num_module_steps_trained": 35964, "module_train_batch_size_mean": 999.0, "num_module_steps_trained_lifetime": 323676, "total_loss": 0.0, "diff_num_grad_updates_vs_sampler_policy": 46.0, "weights_seq_no": 54.0}}}, "IntrinsicAttentionMask": [[[0.3334004878997803, 0.33343952894210815, 0.33316004276275635], [0.3333923816680908, 0.33342671394348145, 0.3331809341907501], [0.3334503769874573, 0.33351844549179077, 0.33303117752075195]], [[0.3334238827228546, 0.33322572708129883, 0.33335041999816895], [0.33348649740219116, 0.33315128087997437, 0.3333622217178345], [0.33344706892967224, 0.33319810032844543, 0.33335480093955994]], [[0.3332633376121521, 0.33343732357025146, 0.3332993984222412], [0.3335164487361908, 0.33306148648262024, 0.33342209458351135], [0.33331578969955444, 0.33335939049720764, 0.3333248496055603]], [[0.3331098258495331, 0.33360427618026733, 0.3332858681678772], [0.333795964717865, 0.332772821187973, 0.3334311246871948], [0.33335423469543457, 0.33330801129341125, 0.3333377540111542]], [[0.333319753408432, 0.33329057693481445, 0.33338966965675354], [0.3333175480365753, 0.3332836925983429, 0.3333987593650818], [0.33332499861717224, 0.3333071172237396, 0.33336788415908813]], [[0.3341153562068939, 0.33196160197257996, 0.3339230716228485], [0.33789893984794617, 0.32533949613571167, 0.33676156401634216], [0.33445313572883606, 0.3313693702220917, 0.3341774642467499]]]}, "num_training_step_calls_per_iteration": 1, "evaluation": {"env_runners": {"module_episode_returns_mean": {"default_policy": 0.25}, "num_env_steps_sampled_lifetime": 45400, "sample": 0.12994882803343374, "num_episodes": 20, "env_to_module_connector": {"timers": {"connectors": {"batch_individual_items": 1.699384228239813e-05, "numpy_to_tensor": 1.800065465858834e-05, "add_time_dim_to_batch_and_zero_pad": 1.2142525808433847e-05, "add_states_from_episodes_to_batch": 3.601325962127299e-06, "add_observations_from_episodes_to_batch": 4.312980068063905e-06}}, "connector_pipeline_timer": 8.643026199048712e-05}, "episode_return_min": -14.5, "num_agent_steps_sampled_lifetime": {"default_agent": 3600}, "episode_return_mean": 0.25, "module_to_env_connector": {"timers": {"connectors": {"remove_single_ts_time_rank_from_batch": 1.6069148121719905e-05, "un_batch_to_individual_items": 8.77540413905869e-06, "listify_data_for_vector_env": 1.5078746684050734e-05, "get_actions": 6.448807294811407e-05, "tensor_to_numpy": 2.3334022764714454e-05, "normalize_and_clip_actions": 1.2945689310365278e-05}}, "connector_pipeline_timer": 0.00017699052090651134}, "episode_duration_sec_mean": 0.005840133283054456, "num_env_steps_sampled": 400, "episode_return_max": 13.5, "env_to_module_sum_episodes_length_in": 10.368238394574323, "num_episodes_lifetime": 180, "env_to_module_sum_episodes_length_out": 10.368238394574323, "num_agent_steps_sampled": {"default_agent": 400}, "episode_len_mean": 20.0, "episode_len_min": 20, "agent_episode_returns_mean": {"default_agent": 0.25}, "num_module_steps_sampled_lifetime": {"default_policy": 3600}, "env_reset_timer": 0.0007322640530686392, "rlmodule_inference_timer": 4.5895508719445076e-05, "num_module_steps_sampled": {"default_policy": 400}, "episode_len_max": 20, "env_step_timer": 2.2118809634771692e-05, "weights_seq_no": 9.0, "time_between_sampling": 11.160769336139982}, "num_healthy_workers": 1, "actor_manager_num_outstanding_async_reqs": 0, "num_remote_worker_restarts": 0}, "num_env_steps_sampled_lifetime": -4312500.0, "fault_tolerance": {"num_healthy_workers": 0, "num_remote_worker_restarts": 0}, "env_runner_group": {"actor_manager_num_outstanding_async_reqs": 0}, "done": false, "training_iteration": 9, "trial_id": "b7d85_00000", "date": "2025-08-11_18-01-53", "timestamp": 1754928113, "time_this_iter_s": 11.571640014648438, "time_total_s": 105.1508629322052, "pid": 10036, "hostname": "Mac", "node_ip": "127.0.0.1", "config": {"exploration_config": {}, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 2, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "env": "Umbrella", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": false, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 0, "create_local_env_runner": true, "num_envs_per_env_runner": 1, "gym_env_vectorize_mode": "SYNC", "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "episodes_to_numpy": true, "max_requests_in_flight_per_env_runner": 1, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "merge_env_runner_states": "training_only", "broadcast_env_runner_states": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "complete_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "sampler_perf_stats_ema_coef": null, "_is_online": true, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": "auto", "num_aggregator_actors_per_learner": 0, "max_requests_in_flight_per_aggregator_actor": 3, "local_gpu_idx": 0, "max_requests_in_flight_per_learner": 3, "gamma": 1, "lr": 0.0002715581955, "grad_clip": 0.5, "grad_clip_by": "global_norm", "_train_batch_size_per_learner": 5000, "train_batch_size": 4000, "num_epochs": 1, "minibatch_size": 1000, "shuffle_batch_per_epoch": true, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "log_std_clip_param": 20.0, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "_disable_preprocessor_api": false, "_disable_action_flattening": false}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {"intrinsic_reward_coeff": 0.2795015916508}, "optimizer": {}, "_learner_class": "<class 'source.intrinsic_attention_ppo.learners.IntrinsicAttentionMetaLearner.IntrinsicAttentionMetaLearner'>", "callbacks_on_algorithm_init": null, "callbacks_on_env_runners_recreated": null, "callbacks_on_offline_eval_runners_recreated": null, "callbacks_on_checkpoint_loaded": null, "callbacks_on_environment_created": null, "callbacks_on_episode_created": null, "callbacks_on_episode_start": null, "callbacks_on_episode_step": null, "callbacks_on_episode_end": null, "callbacks_on_evaluate_start": null, "callbacks_on_evaluate_end": null, "callbacks_on_evaluate_offline_start": null, "callbacks_on_evaluate_offline_end": null, "callbacks_on_sample_end": null, "callbacks_on_train_result": null, "explore": true, "enable_rl_module_and_learner": true, "enable_env_runner_and_connector_v2": true, "_prior_exploration_config": {"type": "StochasticSampling"}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x155e4d8a0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "offline_data_class": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_read_batch_size": null, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "materialize_data": false, "materialize_mapped_data": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "ignore_final_observation": false, "prelearner_class": null, "prelearner_buffer_class": null, "prelearner_buffer_kwargs": {}, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_remaining_data": false, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": 1, "evaluation_duration": 20, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_auto_duration_min_env_steps_per_sample": 100, "evaluation_auto_duration_max_env_steps_per_sample": 2000, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 1, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "offline_evaluation_interval": null, "num_offline_eval_runners": 0, "offline_loss_for_module_fn": null, "offline_evaluation_duration": 1, "offline_evaluation_parallel_to_training": false, "offline_evaluation_timeout_s": 120.0, "num_cpus_per_offline_eval_runner": 1, "num_gpus_per_offline_eval_runner": 0, "custom_resources_per_offline_eval_runner": {}, "restart_failed_offline_eval_runners": true, "ignore_offline_eval_runner_failures": false, "max_num_offline_eval_runner_restarts": 1000, "offline_eval_runner_restore_timeout_s": 1800.0, "max_requests_in_flight_per_offline_eval_runner": 1, "validate_offline_eval_runners_after_construction": true, "offline_eval_runner_health_probe_timeout_s": 30.0, "offline_eval_rl_module_inference_only": false, "broadcast_offline_eval_runner_states": false, "offline_eval_batch_size_per_runner": 256, "dataset_num_iters_per_eval_runner": 1, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "log_gradients": false, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 10, "restart_failed_env_runners": true, "ignore_env_runner_failures": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30.0, "env_runner_restore_timeout_s": 1800.0, "_model_config": {}, "_rl_module_spec": "MultiRLModuleSpec(multi_rl_module_class=<class 'ray.rllib.core.rl_module.multi_rl_module.MultiRLModule'>, observation_space=None, action_space=None, inference_only=False, model_config=None, rl_module_specs={'default_policy': RLModuleSpec(module_class=<class 'source.intrinsic_attention_ppo.rl_modules.DifferentiablePPOModule.DifferentiablePPOModule'>, observation_space=None, action_space=None, inference_only=False, learner_only=False, model_config={'vf_share_layers': True, 'embedding_dim': 62, 'max_seq_len': 3, 'policy_head_hidden_sizes': [32], 'value_head_hidden_sizes': [101], 'embedding_hidden_sizes': [121]}, catalog_class=None, load_state_path=None, model_config_dict=None), 'intrinsic_reward_module': RLModuleSpec(module_class=<class 'source.intrinsic_attention_ppo.rl_modules.IntrinsicAttentionModule.IntrinsicAttentionModule'>, observation_space=None, action_space=None, inference_only=False, learner_only=True, model_config={'intrinsic_reward_network': {'encoder_hidden_sizes': [], 'encoding_dim': 1, 'num_heads': 1, 'head_hidden_sizes': None, 'layers': [{'type': 'attention'}]}, 'extrinsic_value_hidden_layers': [127, 60], 'vf_share_layers': True, 'max_seq_len': 3}, catalog_class=None, load_state_path=None, model_config_dict=None)}, load_state_path=None, modules_to_load=None, module_specs={'default_policy': RLModuleSpec(module_class=<class 'source.intrinsic_attention_ppo.rl_modules.DifferentiablePPOModule.DifferentiablePPOModule'>, observation_space=None, action_space=None, inference_only=False, learner_only=False, model_config={'vf_share_layers': True, 'embedding_dim': 62, 'max_seq_len': 3, 'policy_head_hidden_sizes': [32], 'value_head_hidden_sizes': [101], 'embedding_hidden_sizes': [121]}, catalog_class=None, load_state_path=None, model_config_dict=None), 'intrinsic_reward_module': RLModuleSpec(module_class=<class 'source.intrinsic_attention_ppo.rl_modules.IntrinsicAttentionModule.IntrinsicAttentionModule'>, observation_space=None, action_space=None, inference_only=False, learner_only=True, model_config={'intrinsic_reward_network': {'encoder_hidden_sizes': [], 'encoding_dim': 1, 'num_heads': 1, 'head_hidden_sizes': None, 'layers': [{'type': 'attention'}]}, 'extrinsic_value_hidden_layers': [127, 60], 'vf_share_layers': True, 'max_seq_len': 3}, catalog_class=None, load_state_path=None, model_config_dict=None)})", "algorithm_config_overrides_per_module": {"intrinsic_reward_module": {"lr": 0.0002715581955}}, "_per_module_overrides": {}, "_validate_config": true, "_use_msgpack_checkpoints": false, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "env_task_fn": -1, "enable_connectors": -1, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.161583927863, "kl_target": 0.0201019014258, "vf_loss_coeff": 0.7790510010087, "entropy_coeff": 0.0015431216992, "clip_param": 0.2459212356676, "vf_clip_param": 0.3769744131561, "entropy_coeff_schedule": null, "lr_schedule": null, "sgd_minibatch_size": -1, "vf_share_layers": -1, "differentiable_learner_configs": ["DifferentiableLearnerConfig(learner_class=<class 'source.intrinsic_attention_ppo.learners.IntrinsicAttentionPPOLearner.IntrinsicAttentionPPOLearner'>, learner_connector=None, add_default_connectors_to_learner_pipeline=True, is_multi_agent=False, policies_to_update=['default_policy'], lr=0.0060984166342, num_total_minibatches=0, num_epochs=1, minibatch_size=1000, shuffle_batch_per_epoch=True)"], "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9485408017724, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.callbacks.callbacks.RLlibCallback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 105.1508629322052, "iterations_since_restore": 9, "perf": {"cpu_util_percent": 42.85, "ram_util_percent": 82.09375}}
{"timers": {"training_iteration": 11.991575002683371, "restore_env_runners": 1.4022432390150378e-05, "training_step": 11.991370511323261, "env_runner_sampling_timer": 1.6117640396466977, "learner_update_timer": 10.16350707047629, "synch_weights": 0.001667470106365337, "restore_eval_env_runners": 4.7439296695147716e-05, "evaluation_iteration": 0.1424578843491048, "synch_eval_env_connectors": 0.0002459714381691324, "synch_env_connectors": 4.373643480870091e-06}, "env_runners": {"rlmodule_inference_timer": 3.984579050671758e-05, "module_to_env_connector": {"timers": {"connectors": {"listify_data_for_vector_env": 1.1967697461204606e-05, "un_batch_to_individual_items": 7.509892953806704e-06, "get_actions": 5.1429730112507146e-05, "remove_single_ts_time_rank_from_batch": 1.3660781636318343e-05, "tensor_to_numpy": 1.8303690323132815e-05, "normalize_and_clip_actions": 9.281092362281334e-06}}, "connector_pipeline_timer": 0.00014242497706497303}, "module_episode_returns_mean": {"default_policy": -0.019999999999999997}, "episode_len_mean": 20.0, "episode_return_min": -10.5, "num_env_steps_sampled": 5000.0, "episode_return_max": 9.5, "env_to_module_sum_episodes_length_in": 10.36823839457432, "num_agent_steps_sampled": {"default_agent": 5000.0}, "episode_len_min": 20, "env_to_module_connector": {"connector_pipeline_timer": 6.940820011398132e-05, "timers": {"connectors": {"add_states_from_episodes_to_batch": 3.1627812527377786e-06, "batch_individual_items": 1.4480751925786093e-05, "numpy_to_tensor": 1.5580931154855566e-05, "add_time_dim_to_batch_and_zero_pad": 8.317958814116038e-06, "add_observations_from_episodes_to_batch": 3.234166378842727e-06}}}, "episode_len_max": 20, "num_episodes_lifetime": -246500.0, "env_step_timer": 1.70702300252483e-05, "env_reset_timer": 5.070214840189272e-05, "weights_seq_no": 9.0, "episode_return_mean": -0.019999999999999997, "num_module_steps_sampled": {"default_policy": 5000.0}, "time_between_sampling": 0.040795056573818676, "num_env_steps_sampled_lifetime": -4930000.0, "agent_episode_returns_mean": {"default_agent": -0.019999999999999997}, "sample": 0.006513768720106196, "num_agent_steps_sampled_lifetime": {"default_agent": -4930000.0}, "env_to_module_sum_episodes_length_out": 10.36823839457432, "episode_duration_sec_mean": 0.006328069178387526, "num_module_steps_sampled_lifetime": {"default_policy": -4930000.0}, "num_episodes": 250.0, "num_env_steps_sampled_lifetime_throughput": 2767.0573570334927}, "__all_modules__": {"learner_connector_sum_episodes_length_in": 5000.0, "learner_connector": {"connector_pipeline_timer": 0.17671990560297118, "timers": {"connectors": {"add_one_ts_to_episodes_and_truncate": 0.009108279715216109, "add_observations_from_episodes_to_batch": 0.000886790461883273, "add_columns_from_episodes_to_train_batch": 0.042113647521034, "add_time_dim_to_batch_and_zero_pad": 0.10539405240553634, "add_states_from_episodes_to_batch": 0.003505911620257218, "batch_individual_items": 0.015505336978914794, "numpy_to_tensor": 6.545325467964095e-05}}}, "learner_connector_sum_episodes_length_out": 5250.0}, "learners": {"default_policy": {"num_module_steps_trained": 5994, "curr_kl_coeff": 0.00015779680688865483, "num_module_steps_trained_lifetime": 59940, "num_trainable_parameters": 16595, "diff_num_grad_updates_vs_sampler_policy": 1.0, "weights_seq_no": 10.0, "use_intrinsic_rewards": 0.0, "total_loss": 0.20446550846099854, "vf_loss": 0.2638700604438782, "mean_kl_loss": 5.525582309928723e-05, "vf_loss_unclipped": 38.836219787597656, "curr_entropy_coeff": 0.0015431216992, "policy_loss": -4.565778363030404e-05, "entropy": 0.685003936290741, "vf_explained_var": 0.00011485815048217773, "module_train_batch_size_mean": 999.0, "num_module_steps_trained_lifetime_throughput": 633.2509191642354}, "intrinsic_reward_module": {"default_optimizer_learning_rate": 0.0002715581955, "num_module_steps_trained_lifetime": 59940, "num_trainable_parameters": 8266, "diff_num_grad_updates_vs_sampler_policy": 1.0, "total_loss": 0.0, "weights_seq_no": 10.0, "curr_entropy_coeff": 0.0015431216992, "module_train_batch_size_mean": 999.0, "num_module_steps_trained": 5994, "gradients_default_optimizer_global_norm": 0.0, "num_module_steps_trained_lifetime_throughput": 633.259078649574}, "__all_modules__": {"num_env_steps_trained": 31500, "num_non_trainable_parameters": 0, "num_module_steps_trained": 11988, "num_env_steps_trained_lifetime": 315000, "num_module_steps_trained_lifetime": 119880, "num_trainable_parameters": 24861, "num_env_steps_trained_lifetime_throughput": 3327.9547224339053, "num_module_steps_trained_throughput": 25492476.11385277, "num_module_steps_trained_lifetime_throughput": 12721757.756539797}, "differentiable_learners": {"intrinsic_attention_ppo_learner": {"default_policy": {"use_intrinsic_rewards": 1.0, "vf_loss": 0.2639382481575012, "vf_loss_unclipped": 38.78207015991211, "policy_loss": -4.511576480581425e-05, "num_module_steps_trained": 35964, "entropy": 0.6850022673606873, "vf_explained_var": 0.0012636184692382812, "module_train_batch_size_mean": 999.0, "num_module_steps_trained_lifetime": 359640, "total_loss": 0.20452815294265747, "diff_num_grad_updates_vs_sampler_policy": 51.0, "mean_kl_loss": 5.538075492950156e-05, "weights_seq_no": 60.0}, "__all_modules__": {"num_env_steps_trained": 189000, "num_module_steps_trained": 71928, "num_env_steps_trained_lifetime": 1890000, "num_module_steps_trained_lifetime": 719280, "num_env_steps_trained_lifetime_throughput": 42999.306610960084}, "intrinsic_reward_module": {"num_module_steps_trained": 35964, "module_train_batch_size_mean": 999.0, "num_module_steps_trained_lifetime": 359640, "total_loss": 0.0, "diff_num_grad_updates_vs_sampler_policy": 51.0, "weights_seq_no": 60.0}}}, "IntrinsicAttentionMask": [[[0.3324126601219177, 0.33291128277778625, 0.33467599749565125], [0.3326374888420105, 0.333014577627182, 0.3343479335308075], [0.33343034982681274, 0.3333776891231537, 0.33319196105003357]], [[0.333376407623291, 0.3332821726799011, 0.33334147930145264], [0.33343905210494995, 0.33320772647857666, 0.33335328102111816], [0.33339962363243103, 0.3332545757293701, 0.33334586024284363]], [[0.3332633376121521, 0.33343732357025146, 0.3332993984222412], [0.3335164487361908, 0.33306148648262024, 0.33342209458351135], [0.33331578969955444, 0.33335939049720764, 0.3333248496055603]], [[0.33310753107070923, 0.3334716856479645, 0.3334208130836487], [0.3332572877407074, 0.33337992429733276, 0.33336278796195984], [0.33323636651039124, 0.3333927392959595, 0.3333708941936493]], [[0.33328717947006226, 0.33327725529670715, 0.3334355056285858], [0.3332652747631073, 0.33325067162513733, 0.333484023809433], [0.3336145579814911, 0.3336750864982605, 0.3327103853225708]], [[0.332539826631546, 0.33519235253334045, 0.3322678506374359], [0.33487415313720703, 0.32971593737602234, 0.33540990948677063], [0.33229777216911316, 0.33575886487960815, 0.3319433629512787]]]}, "num_training_step_calls_per_iteration": 1, "evaluation": {"env_runners": {"module_episode_returns_mean": {"default_policy": 0.85}, "num_env_steps_sampled_lifetime": 50400, "sample": 0.12992510516349104, "num_episodes": 20, "env_to_module_connector": {"timers": {"connectors": {"batch_individual_items": 1.3939501478374542e-05, "numpy_to_tensor": 1.3930085088929072e-05, "add_time_dim_to_batch_and_zero_pad": 7.830349239687765e-06, "add_states_from_episodes_to_batch": 3.0811298961622547e-06, "add_observations_from_episodes_to_batch": 3.078010645517118e-06}}, "connector_pipeline_timer": 6.568586464193076e-05}, "episode_return_min": -14.5, "num_agent_steps_sampled_lifetime": {"default_agent": 4000}, "episode_return_mean": 0.85, "module_to_env_connector": {"timers": {"connectors": {"remove_single_ts_time_rank_from_batch": 1.3466243360082299e-05, "un_batch_to_individual_items": 6.944872299945248e-06, "listify_data_for_vector_env": 1.1570710819144814e-05, "get_actions": 4.1711987537395785e-05, "tensor_to_numpy": 1.692445113190764e-05, "normalize_and_clip_actions": 9.405619691628626e-06}}, "connector_pipeline_timer": 0.00013001208890775663}, "episode_duration_sec_mean": 0.005956355388043448, "num_env_steps_sampled": 400, "episode_return_max": 13.5, "env_to_module_sum_episodes_length_in": 10.368238394574323, "num_episodes_lifetime": 200, "env_to_module_sum_episodes_length_out": 10.368238394574323, "num_agent_steps_sampled": {"default_agent": 400}, "episode_len_mean": 20.0, "episode_len_min": 20, "agent_episode_returns_mean": {"default_agent": 0.85}, "num_module_steps_sampled_lifetime": {"default_policy": 4000}, "env_reset_timer": 0.0007280197421476598, "rlmodule_inference_timer": 3.5289864874109105e-05, "num_module_steps_sampled": {"default_policy": 400}, "episode_len_max": 20, "env_step_timer": 1.6508632548690576e-05, "weights_seq_no": 10.0, "time_between_sampling": 11.193394159027758}, "num_healthy_workers": 1, "actor_manager_num_outstanding_async_reqs": 0, "num_remote_worker_restarts": 0}, "num_env_steps_sampled_lifetime": -4930000.0, "fault_tolerance": {"num_healthy_workers": 0, "num_remote_worker_restarts": 0}, "env_runner_group": {"actor_manager_num_outstanding_async_reqs": 0}, "done": false, "training_iteration": 10, "trial_id": "b7d85_00000", "date": "2025-08-11_18-02-07", "timestamp": 1754928127, "time_this_iter_s": 14.526333093643188, "time_total_s": 119.67719602584839, "pid": 10036, "hostname": "Mac", "node_ip": "127.0.0.1", "config": {"exploration_config": {}, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 2, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "env": "Umbrella", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": false, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 0, "create_local_env_runner": true, "num_envs_per_env_runner": 1, "gym_env_vectorize_mode": "SYNC", "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "episodes_to_numpy": true, "max_requests_in_flight_per_env_runner": 1, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "merge_env_runner_states": "training_only", "broadcast_env_runner_states": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "complete_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "sampler_perf_stats_ema_coef": null, "_is_online": true, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": "auto", "num_aggregator_actors_per_learner": 0, "max_requests_in_flight_per_aggregator_actor": 3, "local_gpu_idx": 0, "max_requests_in_flight_per_learner": 3, "gamma": 1, "lr": 0.0002715581955, "grad_clip": 0.5, "grad_clip_by": "global_norm", "_train_batch_size_per_learner": 5000, "train_batch_size": 4000, "num_epochs": 1, "minibatch_size": 1000, "shuffle_batch_per_epoch": true, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "log_std_clip_param": 20.0, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "_disable_preprocessor_api": false, "_disable_action_flattening": false}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {"intrinsic_reward_coeff": 0.2795015916508}, "optimizer": {}, "_learner_class": "<class 'source.intrinsic_attention_ppo.learners.IntrinsicAttentionMetaLearner.IntrinsicAttentionMetaLearner'>", "callbacks_on_algorithm_init": null, "callbacks_on_env_runners_recreated": null, "callbacks_on_offline_eval_runners_recreated": null, "callbacks_on_checkpoint_loaded": null, "callbacks_on_environment_created": null, "callbacks_on_episode_created": null, "callbacks_on_episode_start": null, "callbacks_on_episode_step": null, "callbacks_on_episode_end": null, "callbacks_on_evaluate_start": null, "callbacks_on_evaluate_end": null, "callbacks_on_evaluate_offline_start": null, "callbacks_on_evaluate_offline_end": null, "callbacks_on_sample_end": null, "callbacks_on_train_result": null, "explore": true, "enable_rl_module_and_learner": true, "enable_env_runner_and_connector_v2": true, "_prior_exploration_config": {"type": "StochasticSampling"}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x155e4d8a0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "offline_data_class": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_read_batch_size": null, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "materialize_data": false, "materialize_mapped_data": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "ignore_final_observation": false, "prelearner_class": null, "prelearner_buffer_class": null, "prelearner_buffer_kwargs": {}, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_remaining_data": false, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": 1, "evaluation_duration": 20, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_auto_duration_min_env_steps_per_sample": 100, "evaluation_auto_duration_max_env_steps_per_sample": 2000, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 1, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "offline_evaluation_interval": null, "num_offline_eval_runners": 0, "offline_loss_for_module_fn": null, "offline_evaluation_duration": 1, "offline_evaluation_parallel_to_training": false, "offline_evaluation_timeout_s": 120.0, "num_cpus_per_offline_eval_runner": 1, "num_gpus_per_offline_eval_runner": 0, "custom_resources_per_offline_eval_runner": {}, "restart_failed_offline_eval_runners": true, "ignore_offline_eval_runner_failures": false, "max_num_offline_eval_runner_restarts": 1000, "offline_eval_runner_restore_timeout_s": 1800.0, "max_requests_in_flight_per_offline_eval_runner": 1, "validate_offline_eval_runners_after_construction": true, "offline_eval_runner_health_probe_timeout_s": 30.0, "offline_eval_rl_module_inference_only": false, "broadcast_offline_eval_runner_states": false, "offline_eval_batch_size_per_runner": 256, "dataset_num_iters_per_eval_runner": 1, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "log_gradients": false, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 10, "restart_failed_env_runners": true, "ignore_env_runner_failures": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30.0, "env_runner_restore_timeout_s": 1800.0, "_model_config": {}, "_rl_module_spec": "MultiRLModuleSpec(multi_rl_module_class=<class 'ray.rllib.core.rl_module.multi_rl_module.MultiRLModule'>, observation_space=None, action_space=None, inference_only=False, model_config=None, rl_module_specs={'default_policy': RLModuleSpec(module_class=<class 'source.intrinsic_attention_ppo.rl_modules.DifferentiablePPOModule.DifferentiablePPOModule'>, observation_space=None, action_space=None, inference_only=False, learner_only=False, model_config={'vf_share_layers': True, 'embedding_dim': 62, 'max_seq_len': 3, 'policy_head_hidden_sizes': [32], 'value_head_hidden_sizes': [101], 'embedding_hidden_sizes': [121]}, catalog_class=None, load_state_path=None, model_config_dict=None), 'intrinsic_reward_module': RLModuleSpec(module_class=<class 'source.intrinsic_attention_ppo.rl_modules.IntrinsicAttentionModule.IntrinsicAttentionModule'>, observation_space=None, action_space=None, inference_only=False, learner_only=True, model_config={'intrinsic_reward_network': {'encoder_hidden_sizes': [], 'encoding_dim': 1, 'num_heads': 1, 'head_hidden_sizes': None, 'layers': [{'type': 'attention'}]}, 'extrinsic_value_hidden_layers': [127, 60], 'vf_share_layers': True, 'max_seq_len': 3}, catalog_class=None, load_state_path=None, model_config_dict=None)}, load_state_path=None, modules_to_load=None, module_specs={'default_policy': RLModuleSpec(module_class=<class 'source.intrinsic_attention_ppo.rl_modules.DifferentiablePPOModule.DifferentiablePPOModule'>, observation_space=None, action_space=None, inference_only=False, learner_only=False, model_config={'vf_share_layers': True, 'embedding_dim': 62, 'max_seq_len': 3, 'policy_head_hidden_sizes': [32], 'value_head_hidden_sizes': [101], 'embedding_hidden_sizes': [121]}, catalog_class=None, load_state_path=None, model_config_dict=None), 'intrinsic_reward_module': RLModuleSpec(module_class=<class 'source.intrinsic_attention_ppo.rl_modules.IntrinsicAttentionModule.IntrinsicAttentionModule'>, observation_space=None, action_space=None, inference_only=False, learner_only=True, model_config={'intrinsic_reward_network': {'encoder_hidden_sizes': [], 'encoding_dim': 1, 'num_heads': 1, 'head_hidden_sizes': None, 'layers': [{'type': 'attention'}]}, 'extrinsic_value_hidden_layers': [127, 60], 'vf_share_layers': True, 'max_seq_len': 3}, catalog_class=None, load_state_path=None, model_config_dict=None)})", "algorithm_config_overrides_per_module": {"intrinsic_reward_module": {"lr": 0.0002715581955}}, "_per_module_overrides": {}, "_validate_config": true, "_use_msgpack_checkpoints": false, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "env_task_fn": -1, "enable_connectors": -1, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.161583927863, "kl_target": 0.0201019014258, "vf_loss_coeff": 0.7790510010087, "entropy_coeff": 0.0015431216992, "clip_param": 0.2459212356676, "vf_clip_param": 0.3769744131561, "entropy_coeff_schedule": null, "lr_schedule": null, "sgd_minibatch_size": -1, "vf_share_layers": -1, "differentiable_learner_configs": ["DifferentiableLearnerConfig(learner_class=<class 'source.intrinsic_attention_ppo.learners.IntrinsicAttentionPPOLearner.IntrinsicAttentionPPOLearner'>, learner_connector=None, add_default_connectors_to_learner_pipeline=True, is_multi_agent=False, policies_to_update=['default_policy'], lr=0.0060984166342, num_total_minibatches=0, num_epochs=1, minibatch_size=1000, shuffle_batch_per_epoch=True)"], "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9485408017724, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.callbacks.callbacks.RLlibCallback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 119.67719602584839, "iterations_since_restore": 10, "perf": {"cpu_util_percent": 52.81904761904763, "ram_util_percent": 82.92380952380952}}
{"timers": {"training_iteration": 12.001008978906466, "restore_env_runners": 1.39597080742955e-05, "training_step": 12.00080284703958, "env_runner_sampling_timer": 1.6151696675899205, "learner_update_timer": 10.169292328100845, "synch_weights": 0.00166651332591609, "restore_eval_env_runners": 4.747698446092925e-05, "evaluation_iteration": 0.14240215216609367, "synch_eval_env_connectors": 0.0002455663028777681, "synch_env_connectors": 4.384068110388153e-06}, "env_runners": {"rlmodule_inference_timer": 4.338690110847943e-05, "module_to_env_connector": {"timers": {"connectors": {"listify_data_for_vector_env": 1.2606221517322225e-05, "un_batch_to_individual_items": 7.671745568589829e-06, "get_actions": 5.574316341008252e-05, "remove_single_ts_time_rank_from_batch": 1.3959373000566492e-05, "tensor_to_numpy": 2.044907174715174e-05, "normalize_and_clip_actions": 9.959180799528292e-06}}, "connector_pipeline_timer": 0.00015139465215639465}, "module_episode_returns_mean": {"default_policy": 2.3000000000000007}, "episode_len_mean": 20.0, "episode_return_min": -10.5, "num_env_steps_sampled": 5000.0, "episode_return_max": 9.5, "env_to_module_sum_episodes_length_in": 10.36823839457432, "num_agent_steps_sampled": {"default_agent": 5000.0}, "episode_len_min": 20, "env_to_module_connector": {"connector_pipeline_timer": 7.22788250470533e-05, "timers": {"connectors": {"add_states_from_episodes_to_batch": 3.1640449556994174e-06, "batch_individual_items": 1.4882667373186676e-05, "numpy_to_tensor": 1.6468656838550285e-05, "add_time_dim_to_batch_and_zero_pad": 8.687595619116943e-06, "add_observations_from_episodes_to_batch": 3.370931995777407e-06}}}, "episode_len_max": 20, "num_episodes_lifetime": -277375.0, "env_step_timer": 1.784194709717156e-05, "env_reset_timer": 6.075528995164289e-05, "weights_seq_no": 10.0, "episode_return_mean": 2.3000000000000007, "num_module_steps_sampled": {"default_policy": 5000.0}, "time_between_sampling": 0.05066393105362735, "num_env_steps_sampled_lifetime": -5547500.0, "agent_episode_returns_mean": {"default_agent": 2.3000000000000007}, "sample": 0.006977223316788269, "num_agent_steps_sampled_lifetime": {"default_agent": -5547500.0}, "env_to_module_sum_episodes_length_out": 10.36823839457432, "episode_duration_sec_mean": 0.006701262302696707, "num_module_steps_sampled_lifetime": {"default_policy": -5547500.0}, "num_episodes": 250.0, "num_env_steps_sampled_lifetime_throughput": 2685.1578107017467}, "__all_modules__": {"learner_connector_sum_episodes_length_in": 5000.0, "learner_connector": {"connector_pipeline_timer": 0.1767858632166867, "timers": {"connectors": {"add_one_ts_to_episodes_and_truncate": 0.00915687900843952, "add_observations_from_episodes_to_batch": 0.0008871321372854194, "add_columns_from_episodes_to_train_batch": 0.042129999375886136, "add_time_dim_to_batch_and_zero_pad": 0.10540711230061525, "add_states_from_episodes_to_batch": 0.0035151920838175366, "batch_individual_items": 0.015482276108935359, "numpy_to_tensor": 6.650580148751816e-05}}}, "learner_connector_sum_episodes_length_out": 5250.0}, "learners": {"default_policy": {"num_module_steps_trained": 5994, "curr_kl_coeff": 7.889840344432741e-05, "num_module_steps_trained_lifetime": 65934, "num_trainable_parameters": 16595, "diff_num_grad_updates_vs_sampler_policy": 1.0, "weights_seq_no": 11.0, "use_intrinsic_rewards": 0.0, "total_loss": 0.20423255860805511, "vf_loss": 0.26386961340904236, "mean_kl_loss": 4.098971112398431e-05, "vf_loss_unclipped": 37.68043518066406, "curr_entropy_coeff": 0.0015431216992, "policy_loss": -0.0002801696537062526, "entropy": 0.6837818622589111, "vf_explained_var": 1.430511474609375e-05, "module_train_batch_size_mean": 999.0, "num_module_steps_trained_lifetime_throughput": 628.8463537582797}, "intrinsic_reward_module": {"default_optimizer_learning_rate": 0.0002715581955, "num_module_steps_trained_lifetime": 65934, "num_trainable_parameters": 8266, "diff_num_grad_updates_vs_sampler_policy": 1.0, "total_loss": 0.0, "weights_seq_no": 11.0, "curr_entropy_coeff": 0.0015431216992, "module_train_batch_size_mean": 999.0, "num_module_steps_trained": 5994, "gradients_default_optimizer_global_norm": 0.0, "num_module_steps_trained_lifetime_throughput": 628.8540865387445}, "__all_modules__": {"num_env_steps_trained": 31500, "num_non_trainable_parameters": 0, "num_module_steps_trained": 11988, "num_env_steps_trained_lifetime": 346500, "num_module_steps_trained_lifetime": 131868, "num_trainable_parameters": 24861, "num_env_steps_trained_lifetime_throughput": 3304.8048141438167, "num_module_steps_trained_throughput": 24770481.244125362, "num_module_steps_trained_lifetime_throughput": 12660160.768803759}, "differentiable_learners": {"intrinsic_attention_ppo_learner": {"default_policy": {"use_intrinsic_rewards": 1.0, "vf_loss": 0.26391276717185974, "vf_loss_unclipped": 37.676944732666016, "policy_loss": -0.0002722319040913135, "num_module_steps_trained": 35964, "entropy": 0.683807909488678, "vf_explained_var": 0.0011040568351745605, "module_train_batch_size_mean": 999.0, "num_module_steps_trained_lifetime": 395604, "total_loss": 0.20428039133548737, "diff_num_grad_updates_vs_sampler_policy": 56.0, "mean_kl_loss": 3.9238704630406573e-05, "weights_seq_no": 66.0}, "__all_modules__": {"num_env_steps_trained": 189000, "num_module_steps_trained": 71928, "num_env_steps_trained_lifetime": 2079000, "num_module_steps_trained_lifetime": 791208, "num_env_steps_trained_lifetime_throughput": 42130.27067535402}, "intrinsic_reward_module": {"num_module_steps_trained": 35964, "module_train_batch_size_mean": 999.0, "num_module_steps_trained_lifetime": 395604, "total_loss": 0.0, "diff_num_grad_updates_vs_sampler_policy": 56.0, "weights_seq_no": 66.0}}}, "IntrinsicAttentionMask": [[[0.3332371115684509, 0.3332761228084564, 0.33348673582077026], [0.33324870467185974, 0.33328303694725037, 0.3334682285785675], [0.3333113491535187, 0.3333202600479126, 0.33336836099624634]], [[0.3333032429218292, 0.33342838287353516, 0.33326834440231323], [0.33336129784584045, 0.33324486017227173, 0.33339381217956543], [0.3332870304584503, 0.3334796130657196, 0.3332332968711853]], [[0.3330974578857422, 0.33395665884017944, 0.332945853471756], [0.33333519101142883, 0.33332839608192444, 0.33333641290664673], [0.33305537700653076, 0.3340677320957184, 0.3328768014907837]], [[0.3334575295448303, 0.3332870602607727, 0.33325546979904175], [0.3335573971271515, 0.3332498073577881, 0.3331928253173828], [0.33357590436935425, 0.33324289321899414, 0.3331812024116516]], [[0.33307555317878723, 0.33341267704963684, 0.3335117995738983], [0.33355647325515747, 0.33326461911201477, 0.33317890763282776], [0.3336978554725647, 0.33322107791900635, 0.33308109641075134]], [[0.33310362696647644, 0.3337364196777344, 0.3331598937511444], [0.336893767118454, 0.3270964026451111, 0.3360098600387573], [0.33344200253486633, 0.33314263820648193, 0.33341535925865173]]]}, "num_training_step_calls_per_iteration": 1, "evaluation": {"env_runners": {"module_episode_returns_mean": {"default_policy": 0.85}, "num_env_steps_sampled_lifetime": 55400, "sample": 0.12983314744208221, "num_episodes": 20, "env_to_module_connector": {"timers": {"connectors": {"batch_individual_items": 1.259645656949326e-05, "numpy_to_tensor": 1.2405601421822958e-05, "add_time_dim_to_batch_and_zero_pad": 7.11218056369777e-06, "add_states_from_episodes_to_batch": 2.750663405870762e-06, "add_observations_from_episodes_to_batch": 2.792592475019852e-06}}, "connector_pipeline_timer": 5.988220917506104e-05}, "episode_return_min": -14.5, "num_agent_steps_sampled_lifetime": {"default_agent": 4400}, "episode_return_mean": 0.85, "module_to_env_connector": {"timers": {"connectors": {"remove_single_ts_time_rank_from_batch": 1.2161138134731016e-05, "un_batch_to_individual_items": 6.56364599826808e-06, "listify_data_for_vector_env": 1.0452186415974714e-05, "get_actions": 3.654367592115135e-05, "tensor_to_numpy": 1.5381059700565513e-05, "normalize_and_clip_actions": 8.114296897281292e-06}}, "connector_pipeline_timer": 0.00011589950705469964}, "episode_duration_sec_mean": 0.006016577037516981, "num_env_steps_sampled": 400, "episode_return_max": 13.5, "env_to_module_sum_episodes_length_in": 10.368238394574323, "num_episodes_lifetime": 220, "env_to_module_sum_episodes_length_out": 10.368238394574323, "num_agent_steps_sampled": {"default_agent": 400}, "episode_len_mean": 20.0, "episode_len_min": 20, "agent_episode_returns_mean": {"default_agent": 0.85}, "num_module_steps_sampled_lifetime": {"default_policy": 4400}, "env_reset_timer": 0.0007238199651550702, "rlmodule_inference_timer": 3.1352231990597354e-05, "num_module_steps_sampled": {"default_policy": 400}, "episode_len_max": 20, "env_step_timer": 1.4176379739820134e-05, "weights_seq_no": 11.0, "time_between_sampling": 11.211422892437321}, "num_healthy_workers": 1, "actor_manager_num_outstanding_async_reqs": 0, "num_remote_worker_restarts": 0}, "num_env_steps_sampled_lifetime": -5547500.0, "fault_tolerance": {"num_healthy_workers": 0, "num_remote_worker_restarts": 0}, "env_runner_group": {"actor_manager_num_outstanding_async_reqs": 0}, "done": false, "training_iteration": 11, "trial_id": "b7d85_00000", "date": "2025-08-11_18-02-20", "timestamp": 1754928140, "time_this_iter_s": 13.067461967468262, "time_total_s": 132.74465799331665, "pid": 10036, "hostname": "Mac", "node_ip": "127.0.0.1", "config": {"exploration_config": {}, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 2, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "env": "Umbrella", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": false, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 0, "create_local_env_runner": true, "num_envs_per_env_runner": 1, "gym_env_vectorize_mode": "SYNC", "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "episodes_to_numpy": true, "max_requests_in_flight_per_env_runner": 1, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "merge_env_runner_states": "training_only", "broadcast_env_runner_states": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "complete_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "sampler_perf_stats_ema_coef": null, "_is_online": true, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": "auto", "num_aggregator_actors_per_learner": 0, "max_requests_in_flight_per_aggregator_actor": 3, "local_gpu_idx": 0, "max_requests_in_flight_per_learner": 3, "gamma": 1, "lr": 0.0002715581955, "grad_clip": 0.5, "grad_clip_by": "global_norm", "_train_batch_size_per_learner": 5000, "train_batch_size": 4000, "num_epochs": 1, "minibatch_size": 1000, "shuffle_batch_per_epoch": true, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "log_std_clip_param": 20.0, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "_disable_preprocessor_api": false, "_disable_action_flattening": false}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {"intrinsic_reward_coeff": 0.2795015916508}, "optimizer": {}, "_learner_class": "<class 'source.intrinsic_attention_ppo.learners.IntrinsicAttentionMetaLearner.IntrinsicAttentionMetaLearner'>", "callbacks_on_algorithm_init": null, "callbacks_on_env_runners_recreated": null, "callbacks_on_offline_eval_runners_recreated": null, "callbacks_on_checkpoint_loaded": null, "callbacks_on_environment_created": null, "callbacks_on_episode_created": null, "callbacks_on_episode_start": null, "callbacks_on_episode_step": null, "callbacks_on_episode_end": null, "callbacks_on_evaluate_start": null, "callbacks_on_evaluate_end": null, "callbacks_on_evaluate_offline_start": null, "callbacks_on_evaluate_offline_end": null, "callbacks_on_sample_end": null, "callbacks_on_train_result": null, "explore": true, "enable_rl_module_and_learner": true, "enable_env_runner_and_connector_v2": true, "_prior_exploration_config": {"type": "StochasticSampling"}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x155e4d8a0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "offline_data_class": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_read_batch_size": null, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "materialize_data": false, "materialize_mapped_data": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "ignore_final_observation": false, "prelearner_class": null, "prelearner_buffer_class": null, "prelearner_buffer_kwargs": {}, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_remaining_data": false, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": 1, "evaluation_duration": 20, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_auto_duration_min_env_steps_per_sample": 100, "evaluation_auto_duration_max_env_steps_per_sample": 2000, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 1, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "offline_evaluation_interval": null, "num_offline_eval_runners": 0, "offline_loss_for_module_fn": null, "offline_evaluation_duration": 1, "offline_evaluation_parallel_to_training": false, "offline_evaluation_timeout_s": 120.0, "num_cpus_per_offline_eval_runner": 1, "num_gpus_per_offline_eval_runner": 0, "custom_resources_per_offline_eval_runner": {}, "restart_failed_offline_eval_runners": true, "ignore_offline_eval_runner_failures": false, "max_num_offline_eval_runner_restarts": 1000, "offline_eval_runner_restore_timeout_s": 1800.0, "max_requests_in_flight_per_offline_eval_runner": 1, "validate_offline_eval_runners_after_construction": true, "offline_eval_runner_health_probe_timeout_s": 30.0, "offline_eval_rl_module_inference_only": false, "broadcast_offline_eval_runner_states": false, "offline_eval_batch_size_per_runner": 256, "dataset_num_iters_per_eval_runner": 1, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "log_gradients": false, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 10, "restart_failed_env_runners": true, "ignore_env_runner_failures": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30.0, "env_runner_restore_timeout_s": 1800.0, "_model_config": {}, "_rl_module_spec": "MultiRLModuleSpec(multi_rl_module_class=<class 'ray.rllib.core.rl_module.multi_rl_module.MultiRLModule'>, observation_space=None, action_space=None, inference_only=False, model_config=None, rl_module_specs={'default_policy': RLModuleSpec(module_class=<class 'source.intrinsic_attention_ppo.rl_modules.DifferentiablePPOModule.DifferentiablePPOModule'>, observation_space=None, action_space=None, inference_only=False, learner_only=False, model_config={'vf_share_layers': True, 'embedding_dim': 62, 'max_seq_len': 3, 'policy_head_hidden_sizes': [32], 'value_head_hidden_sizes': [101], 'embedding_hidden_sizes': [121]}, catalog_class=None, load_state_path=None, model_config_dict=None), 'intrinsic_reward_module': RLModuleSpec(module_class=<class 'source.intrinsic_attention_ppo.rl_modules.IntrinsicAttentionModule.IntrinsicAttentionModule'>, observation_space=None, action_space=None, inference_only=False, learner_only=True, model_config={'intrinsic_reward_network': {'encoder_hidden_sizes': [], 'encoding_dim': 1, 'num_heads': 1, 'head_hidden_sizes': None, 'layers': [{'type': 'attention'}]}, 'extrinsic_value_hidden_layers': [127, 60], 'vf_share_layers': True, 'max_seq_len': 3}, catalog_class=None, load_state_path=None, model_config_dict=None)}, load_state_path=None, modules_to_load=None, module_specs={'default_policy': RLModuleSpec(module_class=<class 'source.intrinsic_attention_ppo.rl_modules.DifferentiablePPOModule.DifferentiablePPOModule'>, observation_space=None, action_space=None, inference_only=False, learner_only=False, model_config={'vf_share_layers': True, 'embedding_dim': 62, 'max_seq_len': 3, 'policy_head_hidden_sizes': [32], 'value_head_hidden_sizes': [101], 'embedding_hidden_sizes': [121]}, catalog_class=None, load_state_path=None, model_config_dict=None), 'intrinsic_reward_module': RLModuleSpec(module_class=<class 'source.intrinsic_attention_ppo.rl_modules.IntrinsicAttentionModule.IntrinsicAttentionModule'>, observation_space=None, action_space=None, inference_only=False, learner_only=True, model_config={'intrinsic_reward_network': {'encoder_hidden_sizes': [], 'encoding_dim': 1, 'num_heads': 1, 'head_hidden_sizes': None, 'layers': [{'type': 'attention'}]}, 'extrinsic_value_hidden_layers': [127, 60], 'vf_share_layers': True, 'max_seq_len': 3}, catalog_class=None, load_state_path=None, model_config_dict=None)})", "algorithm_config_overrides_per_module": {"intrinsic_reward_module": {"lr": 0.0002715581955}}, "_per_module_overrides": {}, "_validate_config": true, "_use_msgpack_checkpoints": false, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "env_task_fn": -1, "enable_connectors": -1, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.161583927863, "kl_target": 0.0201019014258, "vf_loss_coeff": 0.7790510010087, "entropy_coeff": 0.0015431216992, "clip_param": 0.2459212356676, "vf_clip_param": 0.3769744131561, "entropy_coeff_schedule": null, "lr_schedule": null, "sgd_minibatch_size": -1, "vf_share_layers": -1, "differentiable_learner_configs": ["DifferentiableLearnerConfig(learner_class=<class 'source.intrinsic_attention_ppo.learners.IntrinsicAttentionPPOLearner.IntrinsicAttentionPPOLearner'>, learner_connector=None, add_default_connectors_to_learner_pipeline=True, is_multi_agent=False, policies_to_update=['default_policy'], lr=0.0060984166342, num_total_minibatches=0, num_epochs=1, minibatch_size=1000, shuffle_batch_per_epoch=True)"], "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9485408017724, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.callbacks.callbacks.RLlibCallback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 132.74465799331665, "iterations_since_restore": 11, "perf": {"cpu_util_percent": 47.605555555555554, "ram_util_percent": 83.26666666666667}}
{"timers": {"training_iteration": 11.997266971618304, "restore_env_runners": 1.3883440928626399e-05, "training_step": 11.997060461068967, "env_runner_sampling_timer": 1.6157597692431884, "learner_update_timer": 10.164870321899713, "synch_weights": 0.0016643611122449434, "restore_eval_env_runners": 4.7494714291921675e-05, "evaluation_iteration": 0.14227178648441424, "synch_eval_env_connectors": 0.0002451189694602621, "synch_env_connectors": 4.383147430135425e-06}, "env_runners": {"rlmodule_inference_timer": 3.578113126289867e-05, "module_to_env_connector": {"timers": {"connectors": {"listify_data_for_vector_env": 1.1128262555618042e-05, "un_batch_to_individual_items": 6.940330317479031e-06, "get_actions": 4.542956373168407e-05, "remove_single_ts_time_rank_from_batch": 1.2575847326451063e-05, "tensor_to_numpy": 1.6809455784978096e-05, "normalize_and_clip_actions": 8.444488232809844e-06}}, "connector_pipeline_timer": 0.00012921861924558974}, "module_episode_returns_mean": {"default_policy": 0.86}, "episode_len_mean": 20.0, "episode_return_min": -10.5, "num_env_steps_sampled": 5000.0, "episode_return_max": 9.5, "env_to_module_sum_episodes_length_in": 10.36823839457432, "num_agent_steps_sampled": {"default_agent": 5000.0}, "episode_len_min": 20, "env_to_module_connector": {"connector_pipeline_timer": 6.356227219620703e-05, "timers": {"connectors": {"add_states_from_episodes_to_batch": 2.8948006201137425e-06, "batch_individual_items": 1.3037716350500442e-05, "numpy_to_tensor": 1.4078936723253187e-05, "add_time_dim_to_batch_and_zero_pad": 7.477003845924197e-06, "add_observations_from_episodes_to_batch": 2.944430763085909e-06}}}, "episode_len_max": 20, "num_episodes_lifetime": -308250.0, "env_step_timer": 1.5117037190521217e-05, "env_reset_timer": 5.499523328254106e-05, "weights_seq_no": 11.0, "episode_return_mean": 0.86, "num_module_steps_sampled": {"default_policy": 5000.0}, "time_between_sampling": 0.04556014842652123, "num_env_steps_sampled_lifetime": -6165000.0, "agent_episode_returns_mean": {"default_agent": 0.86}, "sample": 0.006469675936834562, "num_agent_steps_sampled_lifetime": {"default_agent": -6165000.0}, "env_to_module_sum_episodes_length_out": 10.36823839457432, "episode_duration_sec_mean": 0.005727516635321082, "num_module_steps_sampled_lifetime": {"default_policy": -6165000.0}, "num_episodes": 250.0, "num_env_steps_sampled_lifetime_throughput": 2986.0592322541643}, "__all_modules__": {"learner_connector_sum_episodes_length_in": 5000.0, "learner_connector": {"connector_pipeline_timer": 0.1767537391643717, "timers": {"connectors": {"add_one_ts_to_episodes_and_truncate": 0.00915796187727942, "add_observations_from_episodes_to_batch": 0.0008870012258884365, "add_columns_from_episodes_to_train_batch": 0.04211722021222395, "add_time_dim_to_batch_and_zero_pad": 0.10540870325662485, "add_states_from_episodes_to_batch": 0.0035201268325939, "batch_individual_items": 0.015455201257710416, "numpy_to_tensor": 6.673324386573562e-05}}}, "learner_connector_sum_episodes_length_out": 5250.0}, "learners": {"default_policy": {"num_module_steps_trained": 5994, "curr_kl_coeff": 3.944920172216371e-05, "num_module_steps_trained_lifetime": 71928, "num_trainable_parameters": 16595, "diff_num_grad_updates_vs_sampler_policy": 1.0, "weights_seq_no": 12.0, "use_intrinsic_rewards": 0.0, "total_loss": 0.20365677773952484, "vf_loss": 0.26386770606040955, "mean_kl_loss": 7.762389577692375e-05, "vf_loss_unclipped": 37.707828521728516, "curr_entropy_coeff": 0.0015431216992, "policy_loss": -0.0008571752114221454, "entropy": 0.6820229887962341, "vf_explained_var": -0.0002491474151611328, "module_train_batch_size_mean": 999.0, "num_module_steps_trained_lifetime_throughput": 624.9802850513736}, "intrinsic_reward_module": {"default_optimizer_learning_rate": 0.0002715581955, "num_module_steps_trained_lifetime": 71928, "num_trainable_parameters": 8266, "diff_num_grad_updates_vs_sampler_policy": 1.0, "total_loss": 0.0, "weights_seq_no": 12.0, "curr_entropy_coeff": 0.0015431216992, "module_train_batch_size_mean": 999.0, "num_module_steps_trained": 5994, "gradients_default_optimizer_global_norm": 0.0, "num_module_steps_trained_lifetime_throughput": 624.9876051559248}, "__all_modules__": {"num_env_steps_trained": 31500, "num_non_trainable_parameters": 0, "num_module_steps_trained": 11988, "num_env_steps_trained_lifetime": 378000, "num_module_steps_trained_lifetime": 143856, "num_trainable_parameters": 24861, "num_env_steps_trained_lifetime_throughput": 3284.4849341495546, "num_module_steps_trained_throughput": 24091292.779187493, "num_module_steps_trained_lifetime_throughput": 12607283.594523793}, "differentiable_learners": {"intrinsic_attention_ppo_learner": {"default_policy": {"use_intrinsic_rewards": 1.0, "vf_loss": 0.2639034688472748, "vf_loss_unclipped": 37.69321060180664, "policy_loss": -0.0008218960138037801, "num_module_steps_trained": 35964, "entropy": 0.6820995807647705, "vf_explained_var": 0.0011636614799499512, "module_train_batch_size_mean": 999.0, "num_module_steps_trained_lifetime": 431568, "total_loss": 0.20373131334781647, "diff_num_grad_updates_vs_sampler_policy": 61.0, "mean_kl_loss": 7.128124707378447e-05, "weights_seq_no": 72.0}, "__all_modules__": {"num_env_steps_trained": 189000, "num_module_steps_trained": 71928, "num_env_steps_trained_lifetime": 2268000, "num_module_steps_trained_lifetime": 863136, "num_env_steps_trained_lifetime_throughput": 41299.28158849905}, "intrinsic_reward_module": {"num_module_steps_trained": 35964, "module_train_batch_size_mean": 999.0, "num_module_steps_trained_lifetime": 431568, "total_loss": 0.0, "diff_num_grad_updates_vs_sampler_policy": 61.0, "weights_seq_no": 72.0}}}, "IntrinsicAttentionMask": [[[0.33241334557533264, 0.33414533734321594, 0.3334413170814514], [0.3331921100616455, 0.333457887172699, 0.3333500027656555], [0.33287596702575684, 0.3337368369102478, 0.33338719606399536]], [[0.3332701027393341, 0.3335331976413727, 0.3331966996192932], [0.33332815766334534, 0.33334964513778687, 0.333322137594223], [0.3332538902759552, 0.3335844576358795, 0.3331616520881653]], [[0.3331693112850189, 0.33321335911750793, 0.33361729979515076], [0.3331868350505829, 0.33322617411613464, 0.3335869610309601], [0.3333473801612854, 0.33334359526634216, 0.3333090543746948]], [[0.3333202600479126, 0.333046019077301, 0.33363375067710876], [0.33331364393234253, 0.3329024612903595, 0.3337838649749756], [0.3333277404308319, 0.3332099914550781, 0.33346232771873474]], [[0.333319753408432, 0.33329057693481445, 0.33338966965675354], [0.3333175480365753, 0.3332836925983429, 0.3333987593650818], [0.33332499861717224, 0.3333071172237396, 0.33336788415908813]], [[0.3333110213279724, 0.33347582817077637, 0.33321312069892883], [0.3338097631931305, 0.3302435874938965, 0.3359467089176178], [0.33300647139549255, 0.3354024887084961, 0.33159103989601135]]]}, "num_training_step_calls_per_iteration": 1, "evaluation": {"env_runners": {"module_episode_returns_mean": {"default_policy": 0.65}, "num_env_steps_sampled_lifetime": 60400, "sample": 0.1300838197182129, "num_episodes": 20, "env_to_module_connector": {"timers": {"connectors": {"batch_individual_items": 1.4845109783461348e-05, "numpy_to_tensor": 1.491962988504579e-05, "add_time_dim_to_batch_and_zero_pad": 8.688469651325253e-06, "add_states_from_episodes_to_batch": 3.112862405319794e-06, "add_observations_from_episodes_to_batch": 3.3763037502520453e-06}}, "connector_pipeline_timer": 7.000850687148151e-05}, "episode_return_min": -14.5, "num_agent_steps_sampled_lifetime": {"default_agent": 4800}, "episode_return_mean": 0.65, "module_to_env_connector": {"timers": {"connectors": {"remove_single_ts_time_rank_from_batch": 1.4240977588891278e-05, "un_batch_to_individual_items": 7.233050689297649e-06, "listify_data_for_vector_env": 1.2802422438352162e-05, "get_actions": 4.7356916716590643e-05, "tensor_to_numpy": 1.787897940747955e-05, "normalize_and_clip_actions": 9.449778903530696e-06}}, "connector_pipeline_timer": 0.0001392629280756501}, "episode_duration_sec_mean": 0.006359709136886522, "num_env_steps_sampled": 400, "episode_return_max": 13.5, "env_to_module_sum_episodes_length_in": 10.368238394574323, "num_episodes_lifetime": 240, "env_to_module_sum_episodes_length_out": 10.368238394574323, "num_agent_steps_sampled": {"default_agent": 400}, "episode_len_mean": 20.0, "episode_len_min": 20, "agent_episode_returns_mean": {"default_agent": 0.65}, "num_module_steps_sampled_lifetime": {"default_policy": 4800}, "env_reset_timer": 0.0007201709348586289, "rlmodule_inference_timer": 3.7716256090324676e-05, "num_module_steps_sampled": {"default_policy": 400}, "episode_len_max": 20, "env_step_timer": 1.7569603263010967e-05, "weights_seq_no": 12.0, "time_between_sampling": 11.215904900592887}, "num_healthy_workers": 1, "actor_manager_num_outstanding_async_reqs": 0, "num_remote_worker_restarts": 0}, "num_env_steps_sampled_lifetime": -6165000.0, "fault_tolerance": {"num_healthy_workers": 0, "num_remote_worker_restarts": 0}, "env_runner_group": {"actor_manager_num_outstanding_async_reqs": 0}, "done": false, "training_iteration": 12, "trial_id": "b7d85_00000", "date": "2025-08-11_18-02-32", "timestamp": 1754928152, "time_this_iter_s": 11.796873092651367, "time_total_s": 144.54153108596802, "pid": 10036, "hostname": "Mac", "node_ip": "127.0.0.1", "config": {"exploration_config": {}, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 2, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "env": "Umbrella", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": false, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 0, "create_local_env_runner": true, "num_envs_per_env_runner": 1, "gym_env_vectorize_mode": "SYNC", "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "episodes_to_numpy": true, "max_requests_in_flight_per_env_runner": 1, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "merge_env_runner_states": "training_only", "broadcast_env_runner_states": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "complete_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "sampler_perf_stats_ema_coef": null, "_is_online": true, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": "auto", "num_aggregator_actors_per_learner": 0, "max_requests_in_flight_per_aggregator_actor": 3, "local_gpu_idx": 0, "max_requests_in_flight_per_learner": 3, "gamma": 1, "lr": 0.0002715581955, "grad_clip": 0.5, "grad_clip_by": "global_norm", "_train_batch_size_per_learner": 5000, "train_batch_size": 4000, "num_epochs": 1, "minibatch_size": 1000, "shuffle_batch_per_epoch": true, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "log_std_clip_param": 20.0, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "_disable_preprocessor_api": false, "_disable_action_flattening": false}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {"intrinsic_reward_coeff": 0.2795015916508}, "optimizer": {}, "_learner_class": "<class 'source.intrinsic_attention_ppo.learners.IntrinsicAttentionMetaLearner.IntrinsicAttentionMetaLearner'>", "callbacks_on_algorithm_init": null, "callbacks_on_env_runners_recreated": null, "callbacks_on_offline_eval_runners_recreated": null, "callbacks_on_checkpoint_loaded": null, "callbacks_on_environment_created": null, "callbacks_on_episode_created": null, "callbacks_on_episode_start": null, "callbacks_on_episode_step": null, "callbacks_on_episode_end": null, "callbacks_on_evaluate_start": null, "callbacks_on_evaluate_end": null, "callbacks_on_evaluate_offline_start": null, "callbacks_on_evaluate_offline_end": null, "callbacks_on_sample_end": null, "callbacks_on_train_result": null, "explore": true, "enable_rl_module_and_learner": true, "enable_env_runner_and_connector_v2": true, "_prior_exploration_config": {"type": "StochasticSampling"}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x155e4d8a0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "offline_data_class": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_read_batch_size": null, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "materialize_data": false, "materialize_mapped_data": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "ignore_final_observation": false, "prelearner_class": null, "prelearner_buffer_class": null, "prelearner_buffer_kwargs": {}, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_remaining_data": false, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": 1, "evaluation_duration": 20, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_auto_duration_min_env_steps_per_sample": 100, "evaluation_auto_duration_max_env_steps_per_sample": 2000, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 1, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "offline_evaluation_interval": null, "num_offline_eval_runners": 0, "offline_loss_for_module_fn": null, "offline_evaluation_duration": 1, "offline_evaluation_parallel_to_training": false, "offline_evaluation_timeout_s": 120.0, "num_cpus_per_offline_eval_runner": 1, "num_gpus_per_offline_eval_runner": 0, "custom_resources_per_offline_eval_runner": {}, "restart_failed_offline_eval_runners": true, "ignore_offline_eval_runner_failures": false, "max_num_offline_eval_runner_restarts": 1000, "offline_eval_runner_restore_timeout_s": 1800.0, "max_requests_in_flight_per_offline_eval_runner": 1, "validate_offline_eval_runners_after_construction": true, "offline_eval_runner_health_probe_timeout_s": 30.0, "offline_eval_rl_module_inference_only": false, "broadcast_offline_eval_runner_states": false, "offline_eval_batch_size_per_runner": 256, "dataset_num_iters_per_eval_runner": 1, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "log_gradients": false, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 10, "restart_failed_env_runners": true, "ignore_env_runner_failures": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30.0, "env_runner_restore_timeout_s": 1800.0, "_model_config": {}, "_rl_module_spec": "MultiRLModuleSpec(multi_rl_module_class=<class 'ray.rllib.core.rl_module.multi_rl_module.MultiRLModule'>, observation_space=None, action_space=None, inference_only=False, model_config=None, rl_module_specs={'default_policy': RLModuleSpec(module_class=<class 'source.intrinsic_attention_ppo.rl_modules.DifferentiablePPOModule.DifferentiablePPOModule'>, observation_space=None, action_space=None, inference_only=False, learner_only=False, model_config={'vf_share_layers': True, 'embedding_dim': 62, 'max_seq_len': 3, 'policy_head_hidden_sizes': [32], 'value_head_hidden_sizes': [101], 'embedding_hidden_sizes': [121]}, catalog_class=None, load_state_path=None, model_config_dict=None), 'intrinsic_reward_module': RLModuleSpec(module_class=<class 'source.intrinsic_attention_ppo.rl_modules.IntrinsicAttentionModule.IntrinsicAttentionModule'>, observation_space=None, action_space=None, inference_only=False, learner_only=True, model_config={'intrinsic_reward_network': {'encoder_hidden_sizes': [], 'encoding_dim': 1, 'num_heads': 1, 'head_hidden_sizes': None, 'layers': [{'type': 'attention'}]}, 'extrinsic_value_hidden_layers': [127, 60], 'vf_share_layers': True, 'max_seq_len': 3}, catalog_class=None, load_state_path=None, model_config_dict=None)}, load_state_path=None, modules_to_load=None, module_specs={'default_policy': RLModuleSpec(module_class=<class 'source.intrinsic_attention_ppo.rl_modules.DifferentiablePPOModule.DifferentiablePPOModule'>, observation_space=None, action_space=None, inference_only=False, learner_only=False, model_config={'vf_share_layers': True, 'embedding_dim': 62, 'max_seq_len': 3, 'policy_head_hidden_sizes': [32], 'value_head_hidden_sizes': [101], 'embedding_hidden_sizes': [121]}, catalog_class=None, load_state_path=None, model_config_dict=None), 'intrinsic_reward_module': RLModuleSpec(module_class=<class 'source.intrinsic_attention_ppo.rl_modules.IntrinsicAttentionModule.IntrinsicAttentionModule'>, observation_space=None, action_space=None, inference_only=False, learner_only=True, model_config={'intrinsic_reward_network': {'encoder_hidden_sizes': [], 'encoding_dim': 1, 'num_heads': 1, 'head_hidden_sizes': None, 'layers': [{'type': 'attention'}]}, 'extrinsic_value_hidden_layers': [127, 60], 'vf_share_layers': True, 'max_seq_len': 3}, catalog_class=None, load_state_path=None, model_config_dict=None)})", "algorithm_config_overrides_per_module": {"intrinsic_reward_module": {"lr": 0.0002715581955}}, "_per_module_overrides": {}, "_validate_config": true, "_use_msgpack_checkpoints": false, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "env_task_fn": -1, "enable_connectors": -1, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.161583927863, "kl_target": 0.0201019014258, "vf_loss_coeff": 0.7790510010087, "entropy_coeff": 0.0015431216992, "clip_param": 0.2459212356676, "vf_clip_param": 0.3769744131561, "entropy_coeff_schedule": null, "lr_schedule": null, "sgd_minibatch_size": -1, "vf_share_layers": -1, "differentiable_learner_configs": ["DifferentiableLearnerConfig(learner_class=<class 'source.intrinsic_attention_ppo.learners.IntrinsicAttentionPPOLearner.IntrinsicAttentionPPOLearner'>, learner_connector=None, add_default_connectors_to_learner_pipeline=True, is_multi_agent=False, policies_to_update=['default_policy'], lr=0.0060984166342, num_total_minibatches=0, num_epochs=1, minibatch_size=1000, shuffle_batch_per_epoch=True)"], "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9485408017724, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.callbacks.callbacks.RLlibCallback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 144.54153108596802, "iterations_since_restore": 12, "perf": {"cpu_util_percent": 37.741176470588236, "ram_util_percent": 82.3}}
{"timers": {"training_iteration": 11.990317801481988, "restore_env_runners": 1.3802936416341522e-05, "training_step": 11.990110302287302, "env_runner_sampling_timer": 1.6176228569706623, "learner_update_timer": 10.155993688681363, "synch_weights": 0.0016636904213502897, "restore_eval_env_runners": 4.810018748289456e-05, "evaluation_iteration": 0.14251738612030482, "synch_eval_env_connectors": 0.0002443665307682096, "synch_env_connectors": 4.3789064784809755e-06}, "env_runners": {"rlmodule_inference_timer": 3.9038018892025336e-05, "module_to_env_connector": {"timers": {"connectors": {"listify_data_for_vector_env": 1.1894218771589166e-05, "un_batch_to_individual_items": 7.325735271529138e-06, "get_actions": 5.032964189052315e-05, "remove_single_ts_time_rank_from_batch": 1.341158360264065e-05, "tensor_to_numpy": 1.8193839902967546e-05, "normalize_and_clip_actions": 9.059465718986898e-06}}, "connector_pipeline_timer": 0.00013985038673362737}, "module_episode_returns_mean": {"default_policy": 0.38000000000000006}, "episode_len_mean": 20.0, "episode_return_min": -10.5, "num_env_steps_sampled": 5000.0, "episode_return_max": 9.5, "env_to_module_sum_episodes_length_in": 10.36823839457432, "num_agent_steps_sampled": {"default_agent": 5000.0}, "episode_len_min": 20, "env_to_module_connector": {"connector_pipeline_timer": 6.789856283336819e-05, "timers": {"connectors": {"add_states_from_episodes_to_batch": 3.062715261660325e-06, "batch_individual_items": 1.4052594062420496e-05, "numpy_to_tensor": 1.5185724172007285e-05, "add_time_dim_to_batch_and_zero_pad": 8.175923984748946e-06, "add_observations_from_episodes_to_batch": 3.1313285534564365e-06}}}, "episode_len_max": 20, "num_episodes_lifetime": -339125.0, "env_step_timer": 1.638561703761892e-05, "env_reset_timer": 5.5768923138868155e-05, "weights_seq_no": 12.0, "episode_return_mean": 0.38000000000000006, "num_module_steps_sampled": {"default_policy": 5000.0}, "time_between_sampling": 0.04152036986166952, "num_env_steps_sampled_lifetime": -6782500.0, "agent_episode_returns_mean": {"default_agent": 0.38000000000000006}, "sample": 0.00660591240776342, "num_agent_steps_sampled_lifetime": {"default_agent": -6782500.0}, "env_to_module_sum_episodes_length_out": 10.36823839457432, "episode_duration_sec_mean": 0.006191969009581954, "num_module_steps_sampled_lifetime": {"default_policy": -6782500.0}, "num_episodes": 250.0, "num_env_steps_sampled_lifetime_throughput": 2873.6684130059825}, "__all_modules__": {"learner_connector_sum_episodes_length_in": 5000.0, "learner_connector": {"connector_pipeline_timer": 0.17671203469278382, "timers": {"connectors": {"add_one_ts_to_episodes_and_truncate": 0.009155842668451502, "add_observations_from_episodes_to_batch": 0.0008863162130899067, "add_columns_from_episodes_to_train_batch": 0.04211342758984136, "add_time_dim_to_batch_and_zero_pad": 0.1053982745644084, "add_states_from_episodes_to_batch": 0.0035254501440853897, "batch_individual_items": 0.015425105494310767, "numpy_to_tensor": 6.70517512969053e-05}}}, "learner_connector_sum_episodes_length_out": 5250.0}, "learners": {"default_policy": {"num_module_steps_trained": 5994, "curr_kl_coeff": 1.9724600861081854e-05, "num_module_steps_trained_lifetime": 77922, "num_trainable_parameters": 16595, "diff_num_grad_updates_vs_sampler_policy": 1.0, "weights_seq_no": 13.0, "use_intrinsic_rewards": 0.0, "total_loss": 0.2042686492204666, "vf_loss": 0.2638716697692871, "mean_kl_loss": 2.877766382880509e-05, "vf_loss_unclipped": 38.4720344543457, "curr_entropy_coeff": 0.0015431216992, "policy_loss": -0.00024997274158522487, "entropy": 0.6810036301612854, "vf_explained_var": -0.00037729740142822266, "module_train_batch_size_mean": 999.0, "num_module_steps_trained_lifetime_throughput": 621.8379212174689}, "intrinsic_reward_module": {"default_optimizer_learning_rate": 0.0002715581955, "num_module_steps_trained_lifetime": 77922, "num_trainable_parameters": 8266, "diff_num_grad_updates_vs_sampler_policy": 1.0, "total_loss": 0.0, "weights_seq_no": 13.0, "curr_entropy_coeff": 0.0015431216992, "module_train_batch_size_mean": 999.0, "num_module_steps_trained": 5994, "gradients_default_optimizer_global_norm": 0.0, "num_module_steps_trained_lifetime_throughput": 621.8448229342421}, "__all_modules__": {"num_env_steps_trained": 31500, "num_non_trainable_parameters": 0, "num_module_steps_trained": 11988, "num_env_steps_trained_lifetime": 409500, "num_module_steps_trained_lifetime": 155844, "num_trainable_parameters": 24861, "num_env_steps_trained_lifetime_throughput": 3267.968395942829, "num_module_steps_trained_throughput": 23466858.738310944, "num_module_steps_trained_lifetime_throughput": 12571772.757000074}, "differentiable_learners": {"intrinsic_attention_ppo_learner": {"default_policy": {"use_intrinsic_rewards": 1.0, "vf_loss": 0.26388952136039734, "vf_loss_unclipped": 38.41930389404297, "policy_loss": -0.00024306686827912927, "num_module_steps_trained": 35964, "entropy": 0.6810368299484253, "vf_explained_var": 0.001301586627960205, "module_train_batch_size_mean": 999.0, "num_module_steps_trained_lifetime": 467532, "total_loss": 0.20429378747940063, "diff_num_grad_updates_vs_sampler_policy": 66.0, "mean_kl_loss": 2.7165127903572284e-05, "weights_seq_no": 78.0}, "__all_modules__": {"num_env_steps_trained": 189000, "num_module_steps_trained": 71928, "num_env_steps_trained_lifetime": 2457000, "num_module_steps_trained_lifetime": 935064, "num_env_steps_trained_lifetime_throughput": 40511.31183159953}, "intrinsic_reward_module": {"num_module_steps_trained": 35964, "module_train_batch_size_mean": 999.0, "num_module_steps_trained_lifetime": 467532, "total_loss": 0.0, "diff_num_grad_updates_vs_sampler_policy": 66.0, "weights_seq_no": 78.0}}}, "IntrinsicAttentionMask": [[[0.3320032060146332, 0.33373305201530457, 0.33426374197006226], [0.33312907814979553, 0.3333948254585266, 0.33347609639167786], [0.33347368240356445, 0.33329108357429504, 0.3332352638244629]], [[0.33311641216278076, 0.3333794176578522, 0.33350417017936707], [0.3333156108856201, 0.33333709836006165, 0.33334729075431824], [0.3334100544452667, 0.33331701159477234, 0.33327290415763855]], [[0.3332633376121521, 0.33343732357025146, 0.3332993984222412], [0.3335164487361908, 0.33306148648262024, 0.33342209458351135], [0.33331578969955444, 0.33335939049720764, 0.3333248496055603]], [[0.3334575295448303, 0.3332870602607727, 0.33325546979904175], [0.3335573971271515, 0.3332497775554657, 0.3331928253173828], [0.33357590436935425, 0.33324289321899414, 0.3331812024116516]], [[0.33309656381607056, 0.3335026204586029, 0.3334008753299713], [0.33360132575035095, 0.33314186334609985, 0.33325690031051636], [0.3334748446941376, 0.33323222398757935, 0.33329296112060547]], [[0.33199673891067505, 0.33546510338783264, 0.3325382173061371], [0.337152361869812, 0.3272651731967926, 0.33558252453804016], [0.3328067362308502, 0.33417272567749023, 0.33302056789398193]]]}, "num_training_step_calls_per_iteration": 1, "evaluation": {"env_runners": {"module_episode_returns_mean": {"default_policy": -0.75}, "num_env_steps_sampled_lifetime": 65400, "sample": 0.12993638819181347, "num_episodes": 20, "env_to_module_connector": {"timers": {"connectors": {"batch_individual_items": 1.2363158302911846e-05, "numpy_to_tensor": 1.2029834346269623e-05, "add_time_dim_to_batch_and_zero_pad": 6.976598882275478e-06, "add_states_from_episodes_to_batch": 2.6775163841530236e-06, "add_observations_from_episodes_to_batch": 2.743309804533909e-06}}, "connector_pipeline_timer": 5.87106002759463e-05}, "episode_return_min": -14.5, "num_agent_steps_sampled_lifetime": {"default_agent": 5200}, "episode_return_mean": -0.75, "module_to_env_connector": {"timers": {"connectors": {"remove_single_ts_time_rank_from_batch": 1.2039471722038006e-05, "un_batch_to_individual_items": 6.535133455548849e-06, "listify_data_for_vector_env": 1.0337619261586843e-05, "get_actions": 3.580833508801722e-05, "tensor_to_numpy": 1.5208103979260038e-05, "normalize_and_clip_actions": 7.968897640890621e-06}}, "connector_pipeline_timer": 0.00011406818271122563}, "episode_duration_sec_mean": 0.006155852042138576, "num_env_steps_sampled": 400, "episode_return_max": 13.5, "env_to_module_sum_episodes_length_in": 10.368238394574323, "num_episodes_lifetime": 260, "env_to_module_sum_episodes_length_out": 10.368238394574323, "num_agent_steps_sampled": {"default_agent": 400}, "episode_len_mean": 20.0, "episode_len_min": 20, "agent_episode_returns_mean": {"default_agent": -0.75}, "num_module_steps_sampled_lifetime": {"default_policy": 5200}, "env_reset_timer": 0.0007162979749543784, "rlmodule_inference_timer": 3.072874384517209e-05, "num_module_steps_sampled": {"default_policy": 400}, "episode_len_max": 20, "env_step_timer": 1.3802220362382937e-05, "weights_seq_no": 13.0, "time_between_sampling": 11.217142135746931}, "num_healthy_workers": 1, "actor_manager_num_outstanding_async_reqs": 0, "num_remote_worker_restarts": 0}, "num_env_steps_sampled_lifetime": -6782500.0, "fault_tolerance": {"num_healthy_workers": 0, "num_remote_worker_restarts": 0}, "env_runner_group": {"actor_manager_num_outstanding_async_reqs": 0}, "done": false, "training_iteration": 13, "trial_id": "b7d85_00000", "date": "2025-08-11_18-02-44", "timestamp": 1754928164, "time_this_iter_s": 11.429884910583496, "time_total_s": 155.9714159965515, "pid": 10036, "hostname": "Mac", "node_ip": "127.0.0.1", "config": {"exploration_config": {}, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 2, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "env": "Umbrella", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": false, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 0, "create_local_env_runner": true, "num_envs_per_env_runner": 1, "gym_env_vectorize_mode": "SYNC", "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "episodes_to_numpy": true, "max_requests_in_flight_per_env_runner": 1, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "merge_env_runner_states": "training_only", "broadcast_env_runner_states": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "complete_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "sampler_perf_stats_ema_coef": null, "_is_online": true, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": "auto", "num_aggregator_actors_per_learner": 0, "max_requests_in_flight_per_aggregator_actor": 3, "local_gpu_idx": 0, "max_requests_in_flight_per_learner": 3, "gamma": 1, "lr": 0.0002715581955, "grad_clip": 0.5, "grad_clip_by": "global_norm", "_train_batch_size_per_learner": 5000, "train_batch_size": 4000, "num_epochs": 1, "minibatch_size": 1000, "shuffle_batch_per_epoch": true, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "log_std_clip_param": 20.0, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "_disable_preprocessor_api": false, "_disable_action_flattening": false}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {"intrinsic_reward_coeff": 0.2795015916508}, "optimizer": {}, "_learner_class": "<class 'source.intrinsic_attention_ppo.learners.IntrinsicAttentionMetaLearner.IntrinsicAttentionMetaLearner'>", "callbacks_on_algorithm_init": null, "callbacks_on_env_runners_recreated": null, "callbacks_on_offline_eval_runners_recreated": null, "callbacks_on_checkpoint_loaded": null, "callbacks_on_environment_created": null, "callbacks_on_episode_created": null, "callbacks_on_episode_start": null, "callbacks_on_episode_step": null, "callbacks_on_episode_end": null, "callbacks_on_evaluate_start": null, "callbacks_on_evaluate_end": null, "callbacks_on_evaluate_offline_start": null, "callbacks_on_evaluate_offline_end": null, "callbacks_on_sample_end": null, "callbacks_on_train_result": null, "explore": true, "enable_rl_module_and_learner": true, "enable_env_runner_and_connector_v2": true, "_prior_exploration_config": {"type": "StochasticSampling"}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x155e4d8a0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "offline_data_class": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_read_batch_size": null, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "materialize_data": false, "materialize_mapped_data": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "ignore_final_observation": false, "prelearner_class": null, "prelearner_buffer_class": null, "prelearner_buffer_kwargs": {}, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_remaining_data": false, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": 1, "evaluation_duration": 20, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_auto_duration_min_env_steps_per_sample": 100, "evaluation_auto_duration_max_env_steps_per_sample": 2000, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 1, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "offline_evaluation_interval": null, "num_offline_eval_runners": 0, "offline_loss_for_module_fn": null, "offline_evaluation_duration": 1, "offline_evaluation_parallel_to_training": false, "offline_evaluation_timeout_s": 120.0, "num_cpus_per_offline_eval_runner": 1, "num_gpus_per_offline_eval_runner": 0, "custom_resources_per_offline_eval_runner": {}, "restart_failed_offline_eval_runners": true, "ignore_offline_eval_runner_failures": false, "max_num_offline_eval_runner_restarts": 1000, "offline_eval_runner_restore_timeout_s": 1800.0, "max_requests_in_flight_per_offline_eval_runner": 1, "validate_offline_eval_runners_after_construction": true, "offline_eval_runner_health_probe_timeout_s": 30.0, "offline_eval_rl_module_inference_only": false, "broadcast_offline_eval_runner_states": false, "offline_eval_batch_size_per_runner": 256, "dataset_num_iters_per_eval_runner": 1, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "log_gradients": false, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 10, "restart_failed_env_runners": true, "ignore_env_runner_failures": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30.0, "env_runner_restore_timeout_s": 1800.0, "_model_config": {}, "_rl_module_spec": "MultiRLModuleSpec(multi_rl_module_class=<class 'ray.rllib.core.rl_module.multi_rl_module.MultiRLModule'>, observation_space=None, action_space=None, inference_only=False, model_config=None, rl_module_specs={'default_policy': RLModuleSpec(module_class=<class 'source.intrinsic_attention_ppo.rl_modules.DifferentiablePPOModule.DifferentiablePPOModule'>, observation_space=None, action_space=None, inference_only=False, learner_only=False, model_config={'vf_share_layers': True, 'embedding_dim': 62, 'max_seq_len': 3, 'policy_head_hidden_sizes': [32], 'value_head_hidden_sizes': [101], 'embedding_hidden_sizes': [121]}, catalog_class=None, load_state_path=None, model_config_dict=None), 'intrinsic_reward_module': RLModuleSpec(module_class=<class 'source.intrinsic_attention_ppo.rl_modules.IntrinsicAttentionModule.IntrinsicAttentionModule'>, observation_space=None, action_space=None, inference_only=False, learner_only=True, model_config={'intrinsic_reward_network': {'encoder_hidden_sizes': [], 'encoding_dim': 1, 'num_heads': 1, 'head_hidden_sizes': None, 'layers': [{'type': 'attention'}]}, 'extrinsic_value_hidden_layers': [127, 60], 'vf_share_layers': True, 'max_seq_len': 3}, catalog_class=None, load_state_path=None, model_config_dict=None)}, load_state_path=None, modules_to_load=None, module_specs={'default_policy': RLModuleSpec(module_class=<class 'source.intrinsic_attention_ppo.rl_modules.DifferentiablePPOModule.DifferentiablePPOModule'>, observation_space=None, action_space=None, inference_only=False, learner_only=False, model_config={'vf_share_layers': True, 'embedding_dim': 62, 'max_seq_len': 3, 'policy_head_hidden_sizes': [32], 'value_head_hidden_sizes': [101], 'embedding_hidden_sizes': [121]}, catalog_class=None, load_state_path=None, model_config_dict=None), 'intrinsic_reward_module': RLModuleSpec(module_class=<class 'source.intrinsic_attention_ppo.rl_modules.IntrinsicAttentionModule.IntrinsicAttentionModule'>, observation_space=None, action_space=None, inference_only=False, learner_only=True, model_config={'intrinsic_reward_network': {'encoder_hidden_sizes': [], 'encoding_dim': 1, 'num_heads': 1, 'head_hidden_sizes': None, 'layers': [{'type': 'attention'}]}, 'extrinsic_value_hidden_layers': [127, 60], 'vf_share_layers': True, 'max_seq_len': 3}, catalog_class=None, load_state_path=None, model_config_dict=None)})", "algorithm_config_overrides_per_module": {"intrinsic_reward_module": {"lr": 0.0002715581955}}, "_per_module_overrides": {}, "_validate_config": true, "_use_msgpack_checkpoints": false, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "env_task_fn": -1, "enable_connectors": -1, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.161583927863, "kl_target": 0.0201019014258, "vf_loss_coeff": 0.7790510010087, "entropy_coeff": 0.0015431216992, "clip_param": 0.2459212356676, "vf_clip_param": 0.3769744131561, "entropy_coeff_schedule": null, "lr_schedule": null, "sgd_minibatch_size": -1, "vf_share_layers": -1, "differentiable_learner_configs": ["DifferentiableLearnerConfig(learner_class=<class 'source.intrinsic_attention_ppo.learners.IntrinsicAttentionPPOLearner.IntrinsicAttentionPPOLearner'>, learner_connector=None, add_default_connectors_to_learner_pipeline=True, is_multi_agent=False, policies_to_update=['default_policy'], lr=0.0060984166342, num_total_minibatches=0, num_epochs=1, minibatch_size=1000, shuffle_batch_per_epoch=True)"], "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9485408017724, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.callbacks.callbacks.RLlibCallback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 155.9714159965515, "iterations_since_restore": 13, "perf": {"cpu_util_percent": 43.90625, "ram_util_percent": 80.775}}
{"timers": {"training_iteration": 11.986366398056653, "restore_env_runners": 1.3807406391013584e-05, "training_step": 11.986158098433883, "env_runner_sampling_timer": 1.6190802100711896, "learner_update_timer": 10.150521440124413, "synch_weights": 0.0016621593469437852, "restore_eval_env_runners": 4.8077106440625086e-05, "evaluation_iteration": 0.14233592350923743, "synch_eval_env_connectors": 0.00024402286515281852, "synch_env_connectors": 4.380947797592994e-06}, "env_runners": {"rlmodule_inference_timer": 7.003094275165127e-05, "module_to_env_connector": {"timers": {"connectors": {"listify_data_for_vector_env": 1.0757682074449423e-05, "un_batch_to_individual_items": 6.680315716033093e-06, "get_actions": 4.2557090584782865e-05, "remove_single_ts_time_rank_from_batch": 1.2195230798858702e-05, "tensor_to_numpy": 1.6033313008615613e-05, "normalize_and_clip_actions": 8.18150316032157e-06}}, "connector_pipeline_timer": 0.0001234434136399542}, "module_episode_returns_mean": {"default_policy": 1.0199999999999996}, "episode_len_mean": 20.0, "episode_return_min": -10.5, "num_env_steps_sampled": 5000.0, "episode_return_max": 9.5, "env_to_module_sum_episodes_length_in": 10.36823839457432, "num_agent_steps_sampled": {"default_agent": 5000.0}, "episode_len_min": 20, "env_to_module_connector": {"connector_pipeline_timer": 6.104762489024152e-05, "timers": {"connectors": {"add_states_from_episodes_to_batch": 2.79540883787595e-06, "batch_individual_items": 1.2620798247390434e-05, "numpy_to_tensor": 1.3053381930354115e-05, "add_time_dim_to_batch_and_zero_pad": 7.230224972196431e-06, "add_observations_from_episodes_to_batch": 2.878865601438023e-06}}}, "episode_len_max": 20, "num_episodes_lifetime": -370000.0, "env_step_timer": 1.4344591137733183e-05, "env_reset_timer": 4.7727356525113704e-05, "weights_seq_no": 13.0, "episode_return_mean": 1.0199999999999996, "num_module_steps_sampled": {"default_policy": 5000.0}, "time_between_sampling": 0.03930324232283034, "num_env_steps_sampled_lifetime": -7400000.0, "agent_episode_returns_mean": {"default_agent": 1.0199999999999996}, "sample": 0.006470610629962957, "num_agent_steps_sampled_lifetime": {"default_agent": -7400000.0}, "env_to_module_sum_episodes_length_out": 10.36823839457432, "episode_duration_sec_mean": 0.006135638347361235, "num_module_steps_sampled_lifetime": {"default_policy": -7400000.0}, "num_episodes": 250.0, "num_env_steps_sampled_lifetime_throughput": 3127.9492818942476}, "__all_modules__": {"learner_connector_sum_episodes_length_in": 5000.0, "learner_connector": {"connector_pipeline_timer": 0.17666149934566874, "timers": {"connectors": {"add_one_ts_to_episodes_and_truncate": 0.009152922162329165, "add_observations_from_episodes_to_batch": 0.0008869301312706338, "add_columns_from_episodes_to_train_batch": 0.042112127063708475, "add_time_dim_to_batch_and_zero_pad": 0.1053755430692977, "add_states_from_episodes_to_batch": 0.0035277631429024006, "batch_individual_items": 0.015398581939297848, "numpy_to_tensor": 6.718540288743948e-05}}}, "learner_connector_sum_episodes_length_out": 5250.0}, "learners": {"default_policy": {"num_module_steps_trained": 5994, "curr_kl_coeff": 9.862300430540927e-06, "num_module_steps_trained_lifetime": 83916, "num_trainable_parameters": 16595, "diff_num_grad_updates_vs_sampler_policy": 1.0, "weights_seq_no": 14.0, "use_intrinsic_rewards": 0.0, "total_loss": 0.2031542956829071, "vf_loss": 0.263869047164917, "mean_kl_loss": 0.00012872608203906566, "vf_loss_unclipped": 37.92949676513672, "curr_entropy_coeff": 0.0015431216992, "policy_loss": -0.0013664846774190664, "entropy": 0.6782837510108948, "vf_explained_var": 0.0001328587532043457, "module_train_batch_size_mean": 999.0, "num_module_steps_trained_lifetime_throughput": 619.228546880646}, "intrinsic_reward_module": {"default_optimizer_learning_rate": 0.0002715581955, "num_module_steps_trained_lifetime": 83916, "num_trainable_parameters": 8266, "diff_num_grad_updates_vs_sampler_policy": 1.0, "total_loss": 0.0, "weights_seq_no": 14.0, "curr_entropy_coeff": 0.0015431216992, "module_train_batch_size_mean": 999.0, "num_module_steps_trained": 5994, "gradients_default_optimizer_global_norm": 0.0, "num_module_steps_trained_lifetime_throughput": 619.2350589154447}, "__all_modules__": {"num_env_steps_trained": 31500, "num_non_trainable_parameters": 0, "num_module_steps_trained": 11988, "num_env_steps_trained_lifetime": 441000, "num_module_steps_trained_lifetime": 167832, "num_trainable_parameters": 24861, "num_env_steps_trained_lifetime_throughput": 3254.252971758931, "num_module_steps_trained_throughput": 22866560.479174852, "num_module_steps_trained_lifetime_throughput": 12529099.354701137}, "differentiable_learners": {"intrinsic_attention_ppo_learner": {"default_policy": {"use_intrinsic_rewards": 1.0, "vf_loss": 0.2638968527317047, "vf_loss_unclipped": 37.915443420410156, "policy_loss": -0.001306465594097972, "num_module_steps_trained": 35964, "entropy": 0.6784041523933411, "vf_explained_var": 0.0012279152870178223, "module_train_batch_size_mean": 999.0, "num_module_steps_trained_lifetime": 503496, "total_loss": 0.2032548040151596, "diff_num_grad_updates_vs_sampler_policy": 71.0, "mean_kl_loss": 0.00011766079842345789, "weights_seq_no": 84.0}, "__all_modules__": {"num_env_steps_trained": 189000, "num_module_steps_trained": 71928, "num_env_steps_trained_lifetime": 2646000, "num_module_steps_trained_lifetime": 1006992, "num_env_steps_trained_lifetime_throughput": 39764.240332748705}, "intrinsic_reward_module": {"num_module_steps_trained": 35964, "module_train_batch_size_mean": 999.0, "num_module_steps_trained_lifetime": 503496, "total_loss": 0.0, "diff_num_grad_updates_vs_sampler_policy": 71.0, "weights_seq_no": 84.0}}}, "IntrinsicAttentionMask": [[[0.3334003686904907, 0.33294951915740967, 0.3336501121520996], [0.3334934711456299, 0.3324146270751953, 0.3340919613838196], [0.33334866166114807, 0.3332456350326538, 0.33340567350387573]], [[0.33327004313468933, 0.3330720067024231, 0.33365797996520996], [0.33322617411613464, 0.33289119601249695, 0.333882600069046], [0.3333556652069092, 0.33342576026916504, 0.3332185447216034]], [[0.3332633376121521, 0.33343732357025146, 0.3332993984222412], [0.3335164487361908, 0.33306148648262024, 0.33342209458351135], [0.33331578969955444, 0.33335939049720764, 0.3333248496055603]], [[0.3334575295448303, 0.3332870602607727, 0.33325546979904175], [0.3335573971271515, 0.3332497775554657, 0.3331928253173828], [0.33357590436935425, 0.33324289321899414, 0.3331812024116516]], [[0.33328717947006226, 0.3334018290042877, 0.33331096172332764], [0.33354032039642334, 0.3330260217189789, 0.3334336280822754], [0.3333396911621094, 0.3333239257335663, 0.33333641290664673]], [[0.3329913914203644, 0.33379262685775757, 0.33321601152420044], [0.3401593863964081, 0.3242287337779999, 0.33561187982559204], [0.33500248193740845, 0.3310958743095398, 0.33390167355537415]]]}, "num_training_step_calls_per_iteration": 1, "evaluation": {"env_runners": {"module_episode_returns_mean": {"default_policy": -1.55}, "num_env_steps_sampled_lifetime": 70400, "sample": 0.12979151347087636, "num_episodes": 20, "env_to_module_connector": {"timers": {"connectors": {"batch_individual_items": 1.2491752941671788e-05, "numpy_to_tensor": 1.205392831196841e-05, "add_time_dim_to_batch_and_zero_pad": 6.983807861977089e-06, "add_states_from_episodes_to_batch": 2.7177606558845355e-06, "add_observations_from_episodes_to_batch": 2.8661398487374257e-06}}, "connector_pipeline_timer": 5.9291183057879516e-05}, "episode_return_min": -14.5, "num_agent_steps_sampled_lifetime": {"default_agent": 5600}, "episode_return_mean": -1.55, "module_to_env_connector": {"timers": {"connectors": {"remove_single_ts_time_rank_from_batch": 1.1881427621709613e-05, "un_batch_to_individual_items": 6.4541406989944495e-06, "listify_data_for_vector_env": 1.021864169435468e-05, "get_actions": 3.582617941008841e-05, "tensor_to_numpy": 1.5371319328286364e-05, "normalize_and_clip_actions": 7.940246865474406e-06}}, "connector_pipeline_timer": 0.00011414020236038823}, "episode_duration_sec_mean": 0.005767897453624755, "num_env_steps_sampled": 400, "episode_return_max": 13.5, "env_to_module_sum_episodes_length_in": 10.368238394574323, "num_episodes_lifetime": 280, "env_to_module_sum_episodes_length_out": 10.368238394574323, "num_agent_steps_sampled": {"default_agent": 400}, "episode_len_mean": 20.0, "episode_len_min": 20, "agent_episode_returns_mean": {"default_agent": -1.55}, "num_module_steps_sampled_lifetime": {"default_policy": 5600}, "env_reset_timer": 0.0007128220745022132, "rlmodule_inference_timer": 3.088310514113054e-05, "num_module_steps_sampled": {"default_policy": 400}, "episode_len_max": 20, "env_step_timer": 1.3854778533196788e-05, "weights_seq_no": 14.0, "time_between_sampling": 11.221233648969907}, "num_healthy_workers": 1, "actor_manager_num_outstanding_async_reqs": 0, "num_remote_worker_restarts": 0}, "num_env_steps_sampled_lifetime": -7400000.0, "fault_tolerance": {"num_healthy_workers": 0, "num_remote_worker_restarts": 0}, "env_runner_group": {"actor_manager_num_outstanding_async_reqs": 0}, "done": false, "training_iteration": 14, "trial_id": "b7d85_00000", "date": "2025-08-11_18-02-55", "timestamp": 1754928175, "time_this_iter_s": 11.722774982452393, "time_total_s": 167.6941909790039, "pid": 10036, "hostname": "Mac", "node_ip": "127.0.0.1", "config": {"exploration_config": {}, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 2, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "env": "Umbrella", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": false, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 0, "create_local_env_runner": true, "num_envs_per_env_runner": 1, "gym_env_vectorize_mode": "SYNC", "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "episodes_to_numpy": true, "max_requests_in_flight_per_env_runner": 1, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "merge_env_runner_states": "training_only", "broadcast_env_runner_states": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "complete_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "sampler_perf_stats_ema_coef": null, "_is_online": true, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": "auto", "num_aggregator_actors_per_learner": 0, "max_requests_in_flight_per_aggregator_actor": 3, "local_gpu_idx": 0, "max_requests_in_flight_per_learner": 3, "gamma": 1, "lr": 0.0002715581955, "grad_clip": 0.5, "grad_clip_by": "global_norm", "_train_batch_size_per_learner": 5000, "train_batch_size": 4000, "num_epochs": 1, "minibatch_size": 1000, "shuffle_batch_per_epoch": true, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "log_std_clip_param": 20.0, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "_disable_preprocessor_api": false, "_disable_action_flattening": false}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {"intrinsic_reward_coeff": 0.2795015916508}, "optimizer": {}, "_learner_class": "<class 'source.intrinsic_attention_ppo.learners.IntrinsicAttentionMetaLearner.IntrinsicAttentionMetaLearner'>", "callbacks_on_algorithm_init": null, "callbacks_on_env_runners_recreated": null, "callbacks_on_offline_eval_runners_recreated": null, "callbacks_on_checkpoint_loaded": null, "callbacks_on_environment_created": null, "callbacks_on_episode_created": null, "callbacks_on_episode_start": null, "callbacks_on_episode_step": null, "callbacks_on_episode_end": null, "callbacks_on_evaluate_start": null, "callbacks_on_evaluate_end": null, "callbacks_on_evaluate_offline_start": null, "callbacks_on_evaluate_offline_end": null, "callbacks_on_sample_end": null, "callbacks_on_train_result": null, "explore": true, "enable_rl_module_and_learner": true, "enable_env_runner_and_connector_v2": true, "_prior_exploration_config": {"type": "StochasticSampling"}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x155e4d8a0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "offline_data_class": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_read_batch_size": null, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "materialize_data": false, "materialize_mapped_data": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "ignore_final_observation": false, "prelearner_class": null, "prelearner_buffer_class": null, "prelearner_buffer_kwargs": {}, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_remaining_data": false, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": 1, "evaluation_duration": 20, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_auto_duration_min_env_steps_per_sample": 100, "evaluation_auto_duration_max_env_steps_per_sample": 2000, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 1, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "offline_evaluation_interval": null, "num_offline_eval_runners": 0, "offline_loss_for_module_fn": null, "offline_evaluation_duration": 1, "offline_evaluation_parallel_to_training": false, "offline_evaluation_timeout_s": 120.0, "num_cpus_per_offline_eval_runner": 1, "num_gpus_per_offline_eval_runner": 0, "custom_resources_per_offline_eval_runner": {}, "restart_failed_offline_eval_runners": true, "ignore_offline_eval_runner_failures": false, "max_num_offline_eval_runner_restarts": 1000, "offline_eval_runner_restore_timeout_s": 1800.0, "max_requests_in_flight_per_offline_eval_runner": 1, "validate_offline_eval_runners_after_construction": true, "offline_eval_runner_health_probe_timeout_s": 30.0, "offline_eval_rl_module_inference_only": false, "broadcast_offline_eval_runner_states": false, "offline_eval_batch_size_per_runner": 256, "dataset_num_iters_per_eval_runner": 1, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "log_gradients": false, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 10, "restart_failed_env_runners": true, "ignore_env_runner_failures": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30.0, "env_runner_restore_timeout_s": 1800.0, "_model_config": {}, "_rl_module_spec": "MultiRLModuleSpec(multi_rl_module_class=<class 'ray.rllib.core.rl_module.multi_rl_module.MultiRLModule'>, observation_space=None, action_space=None, inference_only=False, model_config=None, rl_module_specs={'default_policy': RLModuleSpec(module_class=<class 'source.intrinsic_attention_ppo.rl_modules.DifferentiablePPOModule.DifferentiablePPOModule'>, observation_space=None, action_space=None, inference_only=False, learner_only=False, model_config={'vf_share_layers': True, 'embedding_dim': 62, 'max_seq_len': 3, 'policy_head_hidden_sizes': [32], 'value_head_hidden_sizes': [101], 'embedding_hidden_sizes': [121]}, catalog_class=None, load_state_path=None, model_config_dict=None), 'intrinsic_reward_module': RLModuleSpec(module_class=<class 'source.intrinsic_attention_ppo.rl_modules.IntrinsicAttentionModule.IntrinsicAttentionModule'>, observation_space=None, action_space=None, inference_only=False, learner_only=True, model_config={'intrinsic_reward_network': {'encoder_hidden_sizes': [], 'encoding_dim': 1, 'num_heads': 1, 'head_hidden_sizes': None, 'layers': [{'type': 'attention'}]}, 'extrinsic_value_hidden_layers': [127, 60], 'vf_share_layers': True, 'max_seq_len': 3}, catalog_class=None, load_state_path=None, model_config_dict=None)}, load_state_path=None, modules_to_load=None, module_specs={'default_policy': RLModuleSpec(module_class=<class 'source.intrinsic_attention_ppo.rl_modules.DifferentiablePPOModule.DifferentiablePPOModule'>, observation_space=None, action_space=None, inference_only=False, learner_only=False, model_config={'vf_share_layers': True, 'embedding_dim': 62, 'max_seq_len': 3, 'policy_head_hidden_sizes': [32], 'value_head_hidden_sizes': [101], 'embedding_hidden_sizes': [121]}, catalog_class=None, load_state_path=None, model_config_dict=None), 'intrinsic_reward_module': RLModuleSpec(module_class=<class 'source.intrinsic_attention_ppo.rl_modules.IntrinsicAttentionModule.IntrinsicAttentionModule'>, observation_space=None, action_space=None, inference_only=False, learner_only=True, model_config={'intrinsic_reward_network': {'encoder_hidden_sizes': [], 'encoding_dim': 1, 'num_heads': 1, 'head_hidden_sizes': None, 'layers': [{'type': 'attention'}]}, 'extrinsic_value_hidden_layers': [127, 60], 'vf_share_layers': True, 'max_seq_len': 3}, catalog_class=None, load_state_path=None, model_config_dict=None)})", "algorithm_config_overrides_per_module": {"intrinsic_reward_module": {"lr": 0.0002715581955}}, "_per_module_overrides": {}, "_validate_config": true, "_use_msgpack_checkpoints": false, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "env_task_fn": -1, "enable_connectors": -1, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.161583927863, "kl_target": 0.0201019014258, "vf_loss_coeff": 0.7790510010087, "entropy_coeff": 0.0015431216992, "clip_param": 0.2459212356676, "vf_clip_param": 0.3769744131561, "entropy_coeff_schedule": null, "lr_schedule": null, "sgd_minibatch_size": -1, "vf_share_layers": -1, "differentiable_learner_configs": ["DifferentiableLearnerConfig(learner_class=<class 'source.intrinsic_attention_ppo.learners.IntrinsicAttentionPPOLearner.IntrinsicAttentionPPOLearner'>, learner_connector=None, add_default_connectors_to_learner_pipeline=True, is_multi_agent=False, policies_to_update=['default_policy'], lr=0.0060984166342, num_total_minibatches=0, num_epochs=1, minibatch_size=1000, shuffle_batch_per_epoch=True)"], "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9485408017724, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.callbacks.callbacks.RLlibCallback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 167.6941909790039, "iterations_since_restore": 14, "perf": {"cpu_util_percent": 38.588235294117645, "ram_util_percent": 80.73529411764706}}
{"timers": {"training_iteration": 11.986221921575808, "restore_env_runners": 1.3769752183711363e-05, "training_step": 11.98601330452936, "env_runner_sampling_timer": 1.6195219950512991, "learner_update_timer": 10.14981581572312, "synch_weights": 0.001660426093848802, "restore_eval_env_runners": 4.811967579887895e-05, "evaluation_iteration": 0.14215666677405847, "synch_eval_env_connectors": 0.000243608887087204, "synch_env_connectors": 4.386718441029937e-06}, "env_runners": {"rlmodule_inference_timer": 5.469142807804038e-05, "module_to_env_connector": {"timers": {"connectors": {"listify_data_for_vector_env": 1.039129804612439e-05, "un_batch_to_individual_items": 6.510423764648126e-06, "get_actions": 4.062060459545018e-05, "remove_single_ts_time_rank_from_batch": 1.2000885403917874e-05, "tensor_to_numpy": 1.5723974499163586e-05, "normalize_and_clip_actions": 7.99407930999798e-06}}, "connector_pipeline_timer": 0.00011974171569332823}, "module_episode_returns_mean": {"default_policy": 0.86}, "episode_len_mean": 20.0, "episode_return_min": -10.5, "num_env_steps_sampled": 5000.0, "episode_return_max": 9.5, "env_to_module_sum_episodes_length_in": 10.36823839457432, "num_agent_steps_sampled": {"default_agent": 5000.0}, "episode_len_min": 20, "env_to_module_connector": {"connector_pipeline_timer": 5.9260345327773326e-05, "timers": {"connectors": {"add_states_from_episodes_to_batch": 2.7144217643083848e-06, "batch_individual_items": 1.2256630501497347e-05, "numpy_to_tensor": 1.2574592255886114e-05, "add_time_dim_to_batch_and_zero_pad": 6.947459255042074e-06, "add_observations_from_episodes_to_batch": 2.7795930702951276e-06}}}, "episode_len_max": 20, "num_episodes_lifetime": -400875.0, "env_step_timer": 1.3852458896740071e-05, "env_reset_timer": 4.196897905251523e-05, "weights_seq_no": 14.0, "episode_return_mean": 0.86, "num_module_steps_sampled": {"default_policy": 5000.0}, "time_between_sampling": 0.04032683047085372, "num_env_steps_sampled_lifetime": -8017500.0, "agent_episode_returns_mean": {"default_agent": 0.86}, "sample": 0.006034644039320014, "num_agent_steps_sampled_lifetime": {"default_agent": -8017500.0}, "env_to_module_sum_episodes_length_out": 10.36823839457432, "episode_duration_sec_mean": 0.005796514965593817, "num_module_steps_sampled_lifetime": {"default_policy": -8017500.0}, "num_episodes": 250.0, "num_env_steps_sampled_lifetime_throughput": 3218.6937891008165}, "__all_modules__": {"learner_connector_sum_episodes_length_in": 5000.0, "learner_connector": {"connector_pipeline_timer": 0.17665934143249248, "timers": {"connectors": {"add_one_ts_to_episodes_and_truncate": 0.009160574190676443, "add_observations_from_episodes_to_batch": 0.0008937945795636427, "add_columns_from_episodes_to_train_batch": 0.042138941622941795, "add_time_dim_to_batch_and_zero_pad": 0.10535924597831077, "add_states_from_episodes_to_batch": 0.0035299992616130006, "batch_individual_items": 0.015369167369957991, "numpy_to_tensor": 6.715396933453976e-05}}}, "learner_connector_sum_episodes_length_out": 5250.0}, "learners": {"default_policy": {"num_module_steps_trained": 5994, "curr_kl_coeff": 4.931150215270463e-06, "num_module_steps_trained_lifetime": 89910, "num_trainable_parameters": 16595, "diff_num_grad_updates_vs_sampler_policy": 1.0, "weights_seq_no": 15.0, "use_intrinsic_rewards": 0.0, "total_loss": 0.20371516048908234, "vf_loss": 0.2638705372810364, "mean_kl_loss": 7.639368413947523e-05, "vf_loss_unclipped": 37.7994384765625, "curr_entropy_coeff": 0.0015431216992, "policy_loss": -0.0008102075080387294, "entropy": 0.6760585308074951, "vf_explained_var": 0.00029587745666503906, "module_train_batch_size_mean": 999.0, "num_module_steps_trained_lifetime_throughput": 616.4504414898388}, "intrinsic_reward_module": {"default_optimizer_learning_rate": 0.0002715581955, "num_module_steps_trained_lifetime": 89910, "num_trainable_parameters": 8266, "diff_num_grad_updates_vs_sampler_policy": 1.0, "total_loss": 0.0, "weights_seq_no": 15.0, "curr_entropy_coeff": 0.0015431216992, "module_train_batch_size_mean": 999.0, "num_module_steps_trained": 5994, "gradients_default_optimizer_global_norm": 0.0, "num_module_steps_trained_lifetime_throughput": 616.4565643188478}, "__all_modules__": {"num_env_steps_trained": 31500, "num_non_trainable_parameters": 0, "num_module_steps_trained": 11988, "num_env_steps_trained_lifetime": 472500, "num_module_steps_trained_lifetime": 179820, "num_trainable_parameters": 24861, "num_env_steps_trained_lifetime_throughput": 3239.6509296194563, "num_module_steps_trained_throughput": 22299326.884352572, "num_module_steps_trained_lifetime_throughput": 12499445.210443433}, "differentiable_learners": {"intrinsic_attention_ppo_learner": {"default_policy": {"use_intrinsic_rewards": 1.0, "vf_loss": 0.2638952136039734, "vf_loss_unclipped": 37.794456481933594, "policy_loss": -0.0007754394900985062, "num_module_steps_trained": 35964, "entropy": 0.6761559247970581, "vf_explained_var": 0.0012159943580627441, "module_train_batch_size_mean": 999.0, "num_module_steps_trained_lifetime": 539460, "total_loss": 0.20378029346466064, "diff_num_grad_updates_vs_sampler_policy": 76.0, "mean_kl_loss": 6.996186857577413e-05, "weights_seq_no": 90.0}, "__all_modules__": {"num_env_steps_trained": 189000, "num_module_steps_trained": 71928, "num_env_steps_trained_lifetime": 2835000, "num_module_steps_trained_lifetime": 1078920, "num_env_steps_trained_lifetime_throughput": 39056.3255059307}, "intrinsic_reward_module": {"num_module_steps_trained": 35964, "module_train_batch_size_mean": 999.0, "num_module_steps_trained_lifetime": 539460, "total_loss": 0.0, "diff_num_grad_updates_vs_sampler_policy": 76.0, "weights_seq_no": 90.0}}}, "IntrinsicAttentionMask": [[[0.3332371115684509, 0.3332761228084564, 0.33348673582077026], [0.33324870467185974, 0.33328303694725037, 0.3334682285785675], [0.3333113491535187, 0.3333202600479126, 0.33336836099624634]], [[0.33305624127388, 0.33328092098236084, 0.33366280794143677], [0.33322519063949585, 0.33331289887428284, 0.3334618806838989], [0.3335121273994446, 0.3333670198917389, 0.33312079310417175]], [[0.3333528935909271, 0.3333042860031128, 0.3333428204059601], [0.3336060047149658, 0.33292850852012634, 0.33346542716026306], [0.33340537548065186, 0.33322638273239136, 0.3333682417869568]], [[0.33326613903045654, 0.3333107829093933, 0.33342307806015015], [0.333472341299057, 0.33337992429733276, 0.3331477642059326], [0.3339904844760895, 0.3335530459880829, 0.33245646953582764]], [[0.33319759368896484, 0.3335348665714264, 0.3332675099372864], [0.3334507644176483, 0.3331589996814728, 0.3333902657032013], [0.3332500755786896, 0.33345693349838257, 0.33329296112060547]], [[0.3341153562068939, 0.33196160197257996, 0.3339230716228485], [0.3378989100456238, 0.32533958554267883, 0.3367615342140198], [0.33445313572883606, 0.3313693702220917, 0.3341774642467499]]]}, "num_training_step_calls_per_iteration": 1, "evaluation": {"env_runners": {"module_episode_returns_mean": {"default_policy": -1.35}, "num_env_steps_sampled_lifetime": 75400, "sample": 0.12964445375585926, "num_episodes": 20, "env_to_module_connector": {"timers": {"connectors": {"batch_individual_items": 1.2641312262193855e-05, "numpy_to_tensor": 1.2266309991380319e-05, "add_time_dim_to_batch_and_zero_pad": 7.1750019200915246e-06, "add_states_from_episodes_to_batch": 2.715673928231519e-06, "add_observations_from_episodes_to_batch": 2.793285604726726e-06}}, "connector_pipeline_timer": 5.989615543710547e-05}, "episode_return_min": -14.5, "num_agent_steps_sampled_lifetime": {"default_agent": 6000}, "episode_return_mean": -1.35, "module_to_env_connector": {"timers": {"connectors": {"remove_single_ts_time_rank_from_batch": 1.1856166712632312e-05, "un_batch_to_individual_items": 6.438299671532006e-06, "listify_data_for_vector_env": 1.0366079079588986e-05, "get_actions": 3.641837424835451e-05, "tensor_to_numpy": 1.5302031599099124e-05, "normalize_and_clip_actions": 7.984530311027613e-06}}, "connector_pipeline_timer": 0.00011474893503167526}, "episode_duration_sec_mean": 0.005658579524606466, "num_env_steps_sampled": 400, "episode_return_max": 13.5, "env_to_module_sum_episodes_length_in": 10.368238394574323, "num_episodes_lifetime": 300, "env_to_module_sum_episodes_length_out": 10.368238394574323, "num_agent_steps_sampled": {"default_agent": 400}, "episode_len_mean": 20.0, "episode_len_min": 20, "agent_episode_returns_mean": {"default_agent": -1.35}, "num_module_steps_sampled_lifetime": {"default_policy": 6000}, "env_reset_timer": 0.0007088242734026495, "rlmodule_inference_timer": 3.191666349874318e-05, "num_module_steps_sampled": {"default_policy": 400}, "episode_len_max": 20, "env_step_timer": 1.3912151914175363e-05, "weights_seq_no": 15.0, "time_between_sampling": 11.229036395810425}, "num_healthy_workers": 1, "actor_manager_num_outstanding_async_reqs": 0, "num_remote_worker_restarts": 0}, "num_env_steps_sampled_lifetime": -8017500.0, "fault_tolerance": {"num_healthy_workers": 0, "num_remote_worker_restarts": 0}, "env_runner_group": {"actor_manager_num_outstanding_async_reqs": 0}, "done": false, "training_iteration": 15, "trial_id": "b7d85_00000", "date": "2025-08-11_18-03-07", "timestamp": 1754928187, "time_this_iter_s": 12.098942995071411, "time_total_s": 179.79313397407532, "pid": 10036, "hostname": "Mac", "node_ip": "127.0.0.1", "config": {"exploration_config": {}, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 2, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "env": "Umbrella", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": false, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 0, "create_local_env_runner": true, "num_envs_per_env_runner": 1, "gym_env_vectorize_mode": "SYNC", "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "episodes_to_numpy": true, "max_requests_in_flight_per_env_runner": 1, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "merge_env_runner_states": "training_only", "broadcast_env_runner_states": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "complete_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "sampler_perf_stats_ema_coef": null, "_is_online": true, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": "auto", "num_aggregator_actors_per_learner": 0, "max_requests_in_flight_per_aggregator_actor": 3, "local_gpu_idx": 0, "max_requests_in_flight_per_learner": 3, "gamma": 1, "lr": 0.0002715581955, "grad_clip": 0.5, "grad_clip_by": "global_norm", "_train_batch_size_per_learner": 5000, "train_batch_size": 4000, "num_epochs": 1, "minibatch_size": 1000, "shuffle_batch_per_epoch": true, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "log_std_clip_param": 20.0, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "_disable_preprocessor_api": false, "_disable_action_flattening": false}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {"intrinsic_reward_coeff": 0.2795015916508}, "optimizer": {}, "_learner_class": "<class 'source.intrinsic_attention_ppo.learners.IntrinsicAttentionMetaLearner.IntrinsicAttentionMetaLearner'>", "callbacks_on_algorithm_init": null, "callbacks_on_env_runners_recreated": null, "callbacks_on_offline_eval_runners_recreated": null, "callbacks_on_checkpoint_loaded": null, "callbacks_on_environment_created": null, "callbacks_on_episode_created": null, "callbacks_on_episode_start": null, "callbacks_on_episode_step": null, "callbacks_on_episode_end": null, "callbacks_on_evaluate_start": null, "callbacks_on_evaluate_end": null, "callbacks_on_evaluate_offline_start": null, "callbacks_on_evaluate_offline_end": null, "callbacks_on_sample_end": null, "callbacks_on_train_result": null, "explore": true, "enable_rl_module_and_learner": true, "enable_env_runner_and_connector_v2": true, "_prior_exploration_config": {"type": "StochasticSampling"}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x155e4d8a0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "offline_data_class": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_read_batch_size": null, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "materialize_data": false, "materialize_mapped_data": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "ignore_final_observation": false, "prelearner_class": null, "prelearner_buffer_class": null, "prelearner_buffer_kwargs": {}, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_remaining_data": false, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": 1, "evaluation_duration": 20, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_auto_duration_min_env_steps_per_sample": 100, "evaluation_auto_duration_max_env_steps_per_sample": 2000, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 1, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "offline_evaluation_interval": null, "num_offline_eval_runners": 0, "offline_loss_for_module_fn": null, "offline_evaluation_duration": 1, "offline_evaluation_parallel_to_training": false, "offline_evaluation_timeout_s": 120.0, "num_cpus_per_offline_eval_runner": 1, "num_gpus_per_offline_eval_runner": 0, "custom_resources_per_offline_eval_runner": {}, "restart_failed_offline_eval_runners": true, "ignore_offline_eval_runner_failures": false, "max_num_offline_eval_runner_restarts": 1000, "offline_eval_runner_restore_timeout_s": 1800.0, "max_requests_in_flight_per_offline_eval_runner": 1, "validate_offline_eval_runners_after_construction": true, "offline_eval_runner_health_probe_timeout_s": 30.0, "offline_eval_rl_module_inference_only": false, "broadcast_offline_eval_runner_states": false, "offline_eval_batch_size_per_runner": 256, "dataset_num_iters_per_eval_runner": 1, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "log_gradients": false, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 10, "restart_failed_env_runners": true, "ignore_env_runner_failures": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30.0, "env_runner_restore_timeout_s": 1800.0, "_model_config": {}, "_rl_module_spec": "MultiRLModuleSpec(multi_rl_module_class=<class 'ray.rllib.core.rl_module.multi_rl_module.MultiRLModule'>, observation_space=None, action_space=None, inference_only=False, model_config=None, rl_module_specs={'default_policy': RLModuleSpec(module_class=<class 'source.intrinsic_attention_ppo.rl_modules.DifferentiablePPOModule.DifferentiablePPOModule'>, observation_space=None, action_space=None, inference_only=False, learner_only=False, model_config={'vf_share_layers': True, 'embedding_dim': 62, 'max_seq_len': 3, 'policy_head_hidden_sizes': [32], 'value_head_hidden_sizes': [101], 'embedding_hidden_sizes': [121]}, catalog_class=None, load_state_path=None, model_config_dict=None), 'intrinsic_reward_module': RLModuleSpec(module_class=<class 'source.intrinsic_attention_ppo.rl_modules.IntrinsicAttentionModule.IntrinsicAttentionModule'>, observation_space=None, action_space=None, inference_only=False, learner_only=True, model_config={'intrinsic_reward_network': {'encoder_hidden_sizes': [], 'encoding_dim': 1, 'num_heads': 1, 'head_hidden_sizes': None, 'layers': [{'type': 'attention'}]}, 'extrinsic_value_hidden_layers': [127, 60], 'vf_share_layers': True, 'max_seq_len': 3}, catalog_class=None, load_state_path=None, model_config_dict=None)}, load_state_path=None, modules_to_load=None, module_specs={'default_policy': RLModuleSpec(module_class=<class 'source.intrinsic_attention_ppo.rl_modules.DifferentiablePPOModule.DifferentiablePPOModule'>, observation_space=None, action_space=None, inference_only=False, learner_only=False, model_config={'vf_share_layers': True, 'embedding_dim': 62, 'max_seq_len': 3, 'policy_head_hidden_sizes': [32], 'value_head_hidden_sizes': [101], 'embedding_hidden_sizes': [121]}, catalog_class=None, load_state_path=None, model_config_dict=None), 'intrinsic_reward_module': RLModuleSpec(module_class=<class 'source.intrinsic_attention_ppo.rl_modules.IntrinsicAttentionModule.IntrinsicAttentionModule'>, observation_space=None, action_space=None, inference_only=False, learner_only=True, model_config={'intrinsic_reward_network': {'encoder_hidden_sizes': [], 'encoding_dim': 1, 'num_heads': 1, 'head_hidden_sizes': None, 'layers': [{'type': 'attention'}]}, 'extrinsic_value_hidden_layers': [127, 60], 'vf_share_layers': True, 'max_seq_len': 3}, catalog_class=None, load_state_path=None, model_config_dict=None)})", "algorithm_config_overrides_per_module": {"intrinsic_reward_module": {"lr": 0.0002715581955}}, "_per_module_overrides": {}, "_validate_config": true, "_use_msgpack_checkpoints": false, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "env_task_fn": -1, "enable_connectors": -1, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.161583927863, "kl_target": 0.0201019014258, "vf_loss_coeff": 0.7790510010087, "entropy_coeff": 0.0015431216992, "clip_param": 0.2459212356676, "vf_clip_param": 0.3769744131561, "entropy_coeff_schedule": null, "lr_schedule": null, "sgd_minibatch_size": -1, "vf_share_layers": -1, "differentiable_learner_configs": ["DifferentiableLearnerConfig(learner_class=<class 'source.intrinsic_attention_ppo.learners.IntrinsicAttentionPPOLearner.IntrinsicAttentionPPOLearner'>, learner_connector=None, add_default_connectors_to_learner_pipeline=True, is_multi_agent=False, policies_to_update=['default_policy'], lr=0.0060984166342, num_total_minibatches=0, num_epochs=1, minibatch_size=1000, shuffle_batch_per_epoch=True)"], "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9485408017724, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.callbacks.callbacks.RLlibCallback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 179.79313397407532, "iterations_since_restore": 15, "perf": {"cpu_util_percent": 40.37647058823529, "ram_util_percent": 80.98823529411764}}
{"timers": {"training_iteration": 11.982601248609999, "restore_env_runners": 1.3749964756433441e-05, "training_step": 11.982391795653557, "env_runner_sampling_timer": 1.6198420784305836, "learner_update_timer": 10.145787062975536, "synch_weights": 0.0016630155820866524, "restore_eval_env_runners": 4.812388902339262e-05, "evaluation_iteration": 0.14197412719622288, "synch_eval_env_connectors": 0.00024277946819177662, "synch_env_connectors": 4.378261305059736e-06}, "env_runners": {"rlmodule_inference_timer": 3.547341830240262e-05, "module_to_env_connector": {"timers": {"connectors": {"listify_data_for_vector_env": 1.0972221742047095e-05, "un_batch_to_individual_items": 6.8404667886276855e-06, "get_actions": 4.501435922397848e-05, "remove_single_ts_time_rank_from_batch": 1.242935539782511e-05, "tensor_to_numpy": 1.672447338515027e-05, "normalize_and_clip_actions": 8.462234575059897e-06}}, "connector_pipeline_timer": 0.0001280427985150408}, "module_episode_returns_mean": {"default_policy": 1.0199999999999996}, "episode_len_mean": 20.0, "episode_return_min": -10.5, "num_env_steps_sampled": 5000.0, "episode_return_max": 9.5, "env_to_module_sum_episodes_length_in": 10.36823839457432, "num_agent_steps_sampled": {"default_agent": 5000.0}, "episode_len_min": 20, "env_to_module_connector": {"connector_pipeline_timer": 6.253638662908687e-05, "timers": {"connectors": {"add_states_from_episodes_to_batch": 2.8281625839472367e-06, "batch_individual_items": 1.2918550896296587e-05, "numpy_to_tensor": 1.3818549097784666e-05, "add_time_dim_to_batch_and_zero_pad": 7.337679542047344e-06, "add_observations_from_episodes_to_batch": 2.930810941172507e-06}}}, "episode_len_max": 20, "num_episodes_lifetime": -431750.0, "env_step_timer": 1.4982914358536804e-05, "env_reset_timer": 4.290203823420355e-05, "weights_seq_no": 15.0, "episode_return_mean": 1.0199999999999996, "num_module_steps_sampled": {"default_policy": 5000.0}, "time_between_sampling": 0.04217658901122256, "num_env_steps_sampled_lifetime": -8635000.0, "agent_episode_returns_mean": {"default_agent": 1.0199999999999996}, "sample": 0.006233686623881315, "num_agent_steps_sampled_lifetime": {"default_agent": -8635000.0}, "env_to_module_sum_episodes_length_out": 10.36823839457432, "episode_duration_sec_mean": 0.005666560154408218, "num_module_steps_sampled_lifetime": {"default_policy": -8635000.0}, "num_episodes": 250.0, "num_env_steps_sampled_lifetime_throughput": 3039.5748581010307}, "__all_modules__": {"learner_connector_sum_episodes_length_in": 5000.0, "learner_connector": {"connector_pipeline_timer": 0.1766376667680681, "timers": {"connectors": {"add_one_ts_to_episodes_and_truncate": 0.00915757386966646, "add_observations_from_episodes_to_batch": 0.0008935541342204055, "add_columns_from_episodes_to_train_batch": 0.04214624595642143, "add_time_dim_to_batch_and_zero_pad": 0.1053512955980803, "add_states_from_episodes_to_batch": 0.003532635938538394, "batch_individual_items": 0.015348465696096585, "numpy_to_tensor": 6.740367996216537e-05}}}, "learner_connector_sum_episodes_length_out": 5250.0}, "learners": {"default_policy": {"num_module_steps_trained": 5994, "curr_kl_coeff": 2.4655751076352317e-06, "num_module_steps_trained_lifetime": 95904, "num_trainable_parameters": 16595, "diff_num_grad_updates_vs_sampler_policy": 1.0, "weights_seq_no": 16.0, "use_intrinsic_rewards": 0.0, "total_loss": 0.20459192991256714, "vf_loss": 0.2638699412345886, "mean_kl_loss": 2.915083859988954e-05, "vf_loss_unclipped": 38.43840408325195, "curr_entropy_coeff": 0.0015431216992, "policy_loss": 6.514116830658168e-05, "entropy": 0.6748428344726562, "vf_explained_var": 7.015466690063477e-05, "module_train_batch_size_mean": 999.0, "num_module_steps_trained_lifetime_throughput": 613.8159046935024}, "intrinsic_reward_module": {"default_optimizer_learning_rate": 0.0002715581955, "num_module_steps_trained_lifetime": 95904, "num_trainable_parameters": 8266, "diff_num_grad_updates_vs_sampler_policy": 1.0, "total_loss": 0.0, "weights_seq_no": 16.0, "curr_entropy_coeff": 0.0015431216992, "module_train_batch_size_mean": 999.0, "num_module_steps_trained": 5994, "gradients_default_optimizer_global_norm": 0.0, "num_module_steps_trained_lifetime_throughput": 613.8216631992434}, "__all_modules__": {"num_env_steps_trained": 31500, "num_non_trainable_parameters": 0, "num_module_steps_trained": 11988, "num_env_steps_trained_lifetime": 504000, "num_module_steps_trained_lifetime": 191808, "num_trainable_parameters": 24861, "num_env_steps_trained_lifetime_throughput": 3225.8034756072466, "num_module_steps_trained_throughput": 21771119.546452414, "num_module_steps_trained_lifetime_throughput": 12483878.846812768}, "differentiable_learners": {"intrinsic_attention_ppo_learner": {"default_policy": {"use_intrinsic_rewards": 1.0, "vf_loss": 0.26388391852378845, "vf_loss_unclipped": 38.399322509765625, "policy_loss": 6.782670243410394e-05, "num_module_steps_trained": 35964, "entropy": 0.6748186945915222, "vf_explained_var": 0.0013318657875061035, "module_train_batch_size_mean": 999.0, "num_module_steps_trained_lifetime": 575424, "total_loss": 0.20461037755012512, "diff_num_grad_updates_vs_sampler_policy": 81.0, "mean_kl_loss": 3.0123461328912526e-05, "weights_seq_no": 96.0}, "__all_modules__": {"num_env_steps_trained": 189000, "num_module_steps_trained": 71928, "num_env_steps_trained_lifetime": 3024000, "num_module_steps_trained_lifetime": 1150848, "num_env_steps_trained_lifetime_throughput": 38378.74104334444}, "intrinsic_reward_module": {"num_module_steps_trained": 35964, "module_train_batch_size_mean": 999.0, "num_module_steps_trained_lifetime": 575424, "total_loss": 0.0, "diff_num_grad_updates_vs_sampler_policy": 81.0, "weights_seq_no": 96.0}}}, "IntrinsicAttentionMask": [[[0.33282384276390076, 0.33332309126853943, 0.3338530957698822], [0.332948237657547, 0.3333256244659424, 0.333726167678833], [0.3330800533294678, 0.3333282768726349, 0.33359161019325256]], [[0.3332781195640564, 0.3333989977836609, 0.3333229124546051], [0.33334076404571533, 0.3333245813846588, 0.3333347737789154], [0.333301305770874, 0.3333714008331299, 0.3333272933959961]], [[0.3331693410873413, 0.3332133889198303, 0.33361732959747314], [0.3331868350505829, 0.33322617411613464, 0.3335869610309601], [0.3333473801612854, 0.33334359526634216, 0.3333090543746948]], [[0.3334575295448303, 0.3332870602607727, 0.33325546979904175], [0.3335573971271515, 0.3332498073577881, 0.3331928253173828], [0.33357590436935425, 0.33324289321899414, 0.333181232213974]], [[0.33307555317878723, 0.33341267704963684, 0.3335117995738983], [0.33355647325515747, 0.33326461911201477, 0.33317890763282776], [0.3336978554725647, 0.33322107791900635, 0.33308109641075134]], [[0.332991361618042, 0.3337925970554352, 0.33321601152420044], [0.34015926718711853, 0.3242289423942566, 0.33561182022094727], [0.33500248193740845, 0.3310959041118622, 0.33390167355537415]]]}, "num_training_step_calls_per_iteration": 1, "evaluation": {"env_runners": {"module_episode_returns_mean": {"default_policy": -0.55}, "num_env_steps_sampled_lifetime": 80400, "sample": 0.12965027088865355, "num_episodes": 20, "env_to_module_connector": {"timers": {"connectors": {"batch_individual_items": 1.349932288540428e-05, "numpy_to_tensor": 1.316223364813055e-05, "add_time_dim_to_batch_and_zero_pad": 7.668655959277588e-06, "add_states_from_episodes_to_batch": 2.8604705691988844e-06, "add_observations_from_episodes_to_batch": 2.9688157449320443e-06}}, "connector_pipeline_timer": 6.322806767140143e-05}, "episode_return_min": -14.5, "num_agent_steps_sampled_lifetime": {"default_agent": 6400}, "episode_return_mean": -0.55, "module_to_env_connector": {"timers": {"connectors": {"remove_single_ts_time_rank_from_batch": 1.2428194926431096e-05, "un_batch_to_individual_items": 7.003623181200342e-06, "listify_data_for_vector_env": 1.0783449605734905e-05, "get_actions": 3.99822713024211e-05, "tensor_to_numpy": 1.611645112103091e-05, "normalize_and_clip_actions": 8.308378389144274e-06}}, "connector_pipeline_timer": 0.0001220383701754651}, "episode_duration_sec_mean": 0.0057453936920501296, "num_env_steps_sampled": 400, "episode_return_max": 13.5, "env_to_module_sum_episodes_length_in": 10.368238394574323, "num_episodes_lifetime": 320, "env_to_module_sum_episodes_length_out": 10.368238394574323, "num_agent_steps_sampled": {"default_agent": 400}, "episode_len_mean": 20.0, "episode_len_min": 20, "agent_episode_returns_mean": {"default_agent": -0.55}, "num_module_steps_sampled_lifetime": {"default_policy": 6400}, "env_reset_timer": 0.0007053747801451452, "rlmodule_inference_timer": 3.368327289932281e-05, "num_module_steps_sampled": {"default_policy": 400}, "episode_len_max": 20, "env_step_timer": 1.564773176427196e-05, "weights_seq_no": 16.0, "time_between_sampling": 11.233308258523115}, "num_healthy_workers": 1, "actor_manager_num_outstanding_async_reqs": 0, "num_remote_worker_restarts": 0}, "num_env_steps_sampled_lifetime": -8635000.0, "fault_tolerance": {"num_healthy_workers": 0, "num_remote_worker_restarts": 0}, "env_runner_group": {"actor_manager_num_outstanding_async_reqs": 0}, "done": false, "training_iteration": 16, "trial_id": "b7d85_00000", "date": "2025-08-11_18-03-19", "timestamp": 1754928199, "time_this_iter_s": 11.767637968063354, "time_total_s": 191.56077194213867, "pid": 10036, "hostname": "Mac", "node_ip": "127.0.0.1", "config": {"exploration_config": {}, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 2, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "env": "Umbrella", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": false, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 0, "create_local_env_runner": true, "num_envs_per_env_runner": 1, "gym_env_vectorize_mode": "SYNC", "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "episodes_to_numpy": true, "max_requests_in_flight_per_env_runner": 1, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "merge_env_runner_states": "training_only", "broadcast_env_runner_states": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "complete_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "sampler_perf_stats_ema_coef": null, "_is_online": true, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": "auto", "num_aggregator_actors_per_learner": 0, "max_requests_in_flight_per_aggregator_actor": 3, "local_gpu_idx": 0, "max_requests_in_flight_per_learner": 3, "gamma": 1, "lr": 0.0002715581955, "grad_clip": 0.5, "grad_clip_by": "global_norm", "_train_batch_size_per_learner": 5000, "train_batch_size": 4000, "num_epochs": 1, "minibatch_size": 1000, "shuffle_batch_per_epoch": true, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "log_std_clip_param": 20.0, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "_disable_preprocessor_api": false, "_disable_action_flattening": false}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {"intrinsic_reward_coeff": 0.2795015916508}, "optimizer": {}, "_learner_class": "<class 'source.intrinsic_attention_ppo.learners.IntrinsicAttentionMetaLearner.IntrinsicAttentionMetaLearner'>", "callbacks_on_algorithm_init": null, "callbacks_on_env_runners_recreated": null, "callbacks_on_offline_eval_runners_recreated": null, "callbacks_on_checkpoint_loaded": null, "callbacks_on_environment_created": null, "callbacks_on_episode_created": null, "callbacks_on_episode_start": null, "callbacks_on_episode_step": null, "callbacks_on_episode_end": null, "callbacks_on_evaluate_start": null, "callbacks_on_evaluate_end": null, "callbacks_on_evaluate_offline_start": null, "callbacks_on_evaluate_offline_end": null, "callbacks_on_sample_end": null, "callbacks_on_train_result": null, "explore": true, "enable_rl_module_and_learner": true, "enable_env_runner_and_connector_v2": true, "_prior_exploration_config": {"type": "StochasticSampling"}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x155e4d8a0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "offline_data_class": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_read_batch_size": null, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "materialize_data": false, "materialize_mapped_data": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "ignore_final_observation": false, "prelearner_class": null, "prelearner_buffer_class": null, "prelearner_buffer_kwargs": {}, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_remaining_data": false, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": 1, "evaluation_duration": 20, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_auto_duration_min_env_steps_per_sample": 100, "evaluation_auto_duration_max_env_steps_per_sample": 2000, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 1, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "offline_evaluation_interval": null, "num_offline_eval_runners": 0, "offline_loss_for_module_fn": null, "offline_evaluation_duration": 1, "offline_evaluation_parallel_to_training": false, "offline_evaluation_timeout_s": 120.0, "num_cpus_per_offline_eval_runner": 1, "num_gpus_per_offline_eval_runner": 0, "custom_resources_per_offline_eval_runner": {}, "restart_failed_offline_eval_runners": true, "ignore_offline_eval_runner_failures": false, "max_num_offline_eval_runner_restarts": 1000, "offline_eval_runner_restore_timeout_s": 1800.0, "max_requests_in_flight_per_offline_eval_runner": 1, "validate_offline_eval_runners_after_construction": true, "offline_eval_runner_health_probe_timeout_s": 30.0, "offline_eval_rl_module_inference_only": false, "broadcast_offline_eval_runner_states": false, "offline_eval_batch_size_per_runner": 256, "dataset_num_iters_per_eval_runner": 1, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "log_gradients": false, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 10, "restart_failed_env_runners": true, "ignore_env_runner_failures": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30.0, "env_runner_restore_timeout_s": 1800.0, "_model_config": {}, "_rl_module_spec": "MultiRLModuleSpec(multi_rl_module_class=<class 'ray.rllib.core.rl_module.multi_rl_module.MultiRLModule'>, observation_space=None, action_space=None, inference_only=False, model_config=None, rl_module_specs={'default_policy': RLModuleSpec(module_class=<class 'source.intrinsic_attention_ppo.rl_modules.DifferentiablePPOModule.DifferentiablePPOModule'>, observation_space=None, action_space=None, inference_only=False, learner_only=False, model_config={'vf_share_layers': True, 'embedding_dim': 62, 'max_seq_len': 3, 'policy_head_hidden_sizes': [32], 'value_head_hidden_sizes': [101], 'embedding_hidden_sizes': [121]}, catalog_class=None, load_state_path=None, model_config_dict=None), 'intrinsic_reward_module': RLModuleSpec(module_class=<class 'source.intrinsic_attention_ppo.rl_modules.IntrinsicAttentionModule.IntrinsicAttentionModule'>, observation_space=None, action_space=None, inference_only=False, learner_only=True, model_config={'intrinsic_reward_network': {'encoder_hidden_sizes': [], 'encoding_dim': 1, 'num_heads': 1, 'head_hidden_sizes': None, 'layers': [{'type': 'attention'}]}, 'extrinsic_value_hidden_layers': [127, 60], 'vf_share_layers': True, 'max_seq_len': 3}, catalog_class=None, load_state_path=None, model_config_dict=None)}, load_state_path=None, modules_to_load=None, module_specs={'default_policy': RLModuleSpec(module_class=<class 'source.intrinsic_attention_ppo.rl_modules.DifferentiablePPOModule.DifferentiablePPOModule'>, observation_space=None, action_space=None, inference_only=False, learner_only=False, model_config={'vf_share_layers': True, 'embedding_dim': 62, 'max_seq_len': 3, 'policy_head_hidden_sizes': [32], 'value_head_hidden_sizes': [101], 'embedding_hidden_sizes': [121]}, catalog_class=None, load_state_path=None, model_config_dict=None), 'intrinsic_reward_module': RLModuleSpec(module_class=<class 'source.intrinsic_attention_ppo.rl_modules.IntrinsicAttentionModule.IntrinsicAttentionModule'>, observation_space=None, action_space=None, inference_only=False, learner_only=True, model_config={'intrinsic_reward_network': {'encoder_hidden_sizes': [], 'encoding_dim': 1, 'num_heads': 1, 'head_hidden_sizes': None, 'layers': [{'type': 'attention'}]}, 'extrinsic_value_hidden_layers': [127, 60], 'vf_share_layers': True, 'max_seq_len': 3}, catalog_class=None, load_state_path=None, model_config_dict=None)})", "algorithm_config_overrides_per_module": {"intrinsic_reward_module": {"lr": 0.0002715581955}}, "_per_module_overrides": {}, "_validate_config": true, "_use_msgpack_checkpoints": false, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "env_task_fn": -1, "enable_connectors": -1, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.161583927863, "kl_target": 0.0201019014258, "vf_loss_coeff": 0.7790510010087, "entropy_coeff": 0.0015431216992, "clip_param": 0.2459212356676, "vf_clip_param": 0.3769744131561, "entropy_coeff_schedule": null, "lr_schedule": null, "sgd_minibatch_size": -1, "vf_share_layers": -1, "differentiable_learner_configs": ["DifferentiableLearnerConfig(learner_class=<class 'source.intrinsic_attention_ppo.learners.IntrinsicAttentionPPOLearner.IntrinsicAttentionPPOLearner'>, learner_connector=None, add_default_connectors_to_learner_pipeline=True, is_multi_agent=False, policies_to_update=['default_policy'], lr=0.0060984166342, num_total_minibatches=0, num_epochs=1, minibatch_size=1000, shuffle_batch_per_epoch=True)"], "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9485408017724, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.callbacks.callbacks.RLlibCallback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 191.56077194213867, "iterations_since_restore": 16, "perf": {"cpu_util_percent": 40.88235294117647, "ram_util_percent": 81.39411764705883}}
{"timers": {"training_iteration": 11.9807986490442, "restore_env_runners": 1.3743294975844654e-05, "training_step": 11.980588833116654, "env_runner_sampling_timer": 1.6201004847263878, "learner_update_timer": 10.143529566506208, "synch_weights": 0.00165657708710585, "restore_eval_env_runners": 4.802140039780332e-05, "evaluation_iteration": 0.14195659467462968, "synch_eval_env_connectors": 0.00024239667278335274, "synch_env_connectors": 4.375318351059245e-06}, "env_runners": {"rlmodule_inference_timer": 3.480073601848717e-05, "module_to_env_connector": {"timers": {"connectors": {"listify_data_for_vector_env": 1.0793091448071532e-05, "un_batch_to_individual_items": 6.756827735143249e-06, "get_actions": 4.443979497134523e-05, "remove_single_ts_time_rank_from_batch": 1.2429451356016765e-05, "tensor_to_numpy": 1.6411594368750587e-05, "normalize_and_clip_actions": 8.367377993159369e-06}}, "connector_pipeline_timer": 0.00012650369941312695}, "module_episode_returns_mean": {"default_policy": 1.9799999999999998}, "episode_len_mean": 20.0, "episode_return_min": -10.5, "num_env_steps_sampled": 5000.0, "episode_return_max": 9.5, "env_to_module_sum_episodes_length_in": 10.36823839457432, "num_agent_steps_sampled": {"default_agent": 5000.0}, "episode_len_min": 20, "env_to_module_connector": {"connector_pipeline_timer": 6.181527716785856e-05, "timers": {"connectors": {"add_states_from_episodes_to_batch": 2.78993228885874e-06, "batch_individual_items": 1.2754803478673508e-05, "numpy_to_tensor": 1.3381819162759087e-05, "add_time_dim_to_batch_and_zero_pad": 7.356847723364551e-06, "add_observations_from_episodes_to_batch": 2.9416515176171926e-06}}}, "episode_len_max": 20, "num_episodes_lifetime": -462625.0, "env_step_timer": 1.4740204750355094e-05, "env_reset_timer": 4.981272873805865e-05, "weights_seq_no": 16.0, "episode_return_mean": 1.9799999999999998, "num_module_steps_sampled": {"default_policy": 5000.0}, "time_between_sampling": 0.04117957498416909, "num_env_steps_sampled_lifetime": -9252500.0, "agent_episode_returns_mean": {"default_agent": 1.9799999999999998}, "sample": 0.00602393526564296, "num_agent_steps_sampled_lifetime": {"default_agent": -9252500.0}, "env_to_module_sum_episodes_length_out": 10.36823839457432, "episode_duration_sec_mean": 0.0056167768142186105, "num_module_steps_sampled_lifetime": {"default_policy": -9252500.0}, "num_episodes": 250.0, "num_env_steps_sampled_lifetime_throughput": 3060.9264383898117}, "__all_modules__": {"learner_connector_sum_episodes_length_in": 5000.0, "learner_connector": {"connector_pipeline_timer": 0.1766752155103005, "timers": {"connectors": {"add_one_ts_to_episodes_and_truncate": 0.009169481470741425, "add_observations_from_episodes_to_batch": 0.0008938223428198634, "add_columns_from_episodes_to_train_batch": 0.042154891416822146, "add_time_dim_to_batch_and_zero_pad": 0.10536783973177286, "add_states_from_episodes_to_batch": 0.0035366566587355223, "batch_individual_items": 0.015343737289409055, "numpy_to_tensor": 6.775214338136726e-05}}}, "learner_connector_sum_episodes_length_out": 5250.0}, "learners": {"default_policy": {"num_module_steps_trained": 5994, "curr_kl_coeff": 1.2327875538176158e-06, "num_module_steps_trained_lifetime": 101898, "num_trainable_parameters": 16595, "diff_num_grad_updates_vs_sampler_policy": 1.0, "weights_seq_no": 17.0, "use_intrinsic_rewards": 0.0, "total_loss": 0.20367743074893951, "vf_loss": 0.2638693153858185, "mean_kl_loss": 0.00011991658539045602, "vf_loss_unclipped": 37.42350387573242, "curr_entropy_coeff": 0.0015431216992, "policy_loss": -0.0008542645373381674, "entropy": 0.6713480353355408, "vf_explained_var": 0.00011271238327026367, "module_train_batch_size_mean": 999.0, "num_module_steps_trained_lifetime_throughput": 611.3121656864788}, "intrinsic_reward_module": {"default_optimizer_learning_rate": 0.0002715581955, "num_module_steps_trained_lifetime": 101898, "num_trainable_parameters": 8266, "diff_num_grad_updates_vs_sampler_policy": 1.0, "total_loss": 0.0, "weights_seq_no": 17.0, "curr_entropy_coeff": 0.0015431216992, "module_train_batch_size_mean": 999.0, "num_module_steps_trained": 5994, "gradients_default_optimizer_global_norm": 0.0, "num_module_steps_trained_lifetime_throughput": 611.3175755227751}, "__all_modules__": {"num_env_steps_trained": 31500, "num_non_trainable_parameters": 0, "num_module_steps_trained": 11988, "num_env_steps_trained_lifetime": 535500, "num_module_steps_trained_lifetime": 203796, "num_trainable_parameters": 24861, "num_env_steps_trained_lifetime_throughput": 3212.6435023657023, "num_module_steps_trained_throughput": 21277792.459350754, "num_module_steps_trained_lifetime_throughput": 12478150.179027556}, "differentiable_learners": {"intrinsic_attention_ppo_learner": {"default_policy": {"use_intrinsic_rewards": 1.0, "vf_loss": 0.2638821303844452, "vf_loss_unclipped": 37.4317741394043, "policy_loss": -0.000829345197416842, "num_module_steps_trained": 35964, "entropy": 0.6714425683021545, "vf_explained_var": 0.0011886954307556152, "module_train_batch_size_mean": 999.0, "num_module_steps_trained_lifetime": 611388, "total_loss": 0.20373038947582245, "diff_num_grad_updates_vs_sampler_policy": 86.0, "mean_kl_loss": 0.00011291578266536817, "weights_seq_no": 102.0}, "__all_modules__": {"num_env_steps_trained": 189000, "num_module_steps_trained": 71928, "num_env_steps_trained_lifetime": 3213000, "num_module_steps_trained_lifetime": 1222776, "num_env_steps_trained_lifetime_throughput": 37721.12630461007}, "intrinsic_reward_module": {"num_module_steps_trained": 35964, "module_train_batch_size_mean": 999.0, "num_module_steps_trained_lifetime": 611388, "total_loss": 0.0, "diff_num_grad_updates_vs_sampler_policy": 86.0, "weights_seq_no": 102.0}}}, "IntrinsicAttentionMask": [[[0.3324126899242401, 0.33291128277778625, 0.33467599749565125], [0.3326375186443329, 0.333014577627182, 0.3343479335308075], [0.33343034982681274, 0.3333776891231537, 0.33319199085235596]], [[0.3333032429218292, 0.3332090377807617, 0.33348771929740906], [0.3332594335079193, 0.33302825689315796, 0.33371230959892273], [0.3333887755870819, 0.33356285095214844, 0.33304843306541443]], [[0.3332633078098297, 0.3332482576370239, 0.33348843455314636], [0.33324140310287476, 0.3332216441631317, 0.33353695273399353], [0.33359068632125854, 0.33364608883857727, 0.3327632248401642]], [[0.3333202004432678, 0.3336845934391022, 0.33299514651298523], [0.3333289623260498, 0.33345162868499756, 0.333219438791275], [0.33331233263015747, 0.33389270305633545, 0.3327949643135071]], [[0.3329443335533142, 0.3336114287376404, 0.333444207906723], [0.33344897627830505, 0.33325067162513733, 0.33330032229423523], [0.33332252502441406, 0.3333410322666168, 0.33333641290664673]], [[0.332991361618042, 0.3337925970554352, 0.33321601152420044], [0.34015923738479614, 0.3242289423942566, 0.3356117904186249], [0.33500248193740845, 0.3310959041118622, 0.33390167355537415]]]}, "num_training_step_calls_per_iteration": 1, "evaluation": {"env_runners": {"module_episode_returns_mean": {"default_policy": -0.95}, "num_env_steps_sampled_lifetime": 85400, "sample": 0.1295103960997576, "num_episodes": 20, "env_to_module_connector": {"timers": {"connectors": {"batch_individual_items": 1.2484824248110408e-05, "numpy_to_tensor": 1.2082171075493958e-05, "add_time_dim_to_batch_and_zero_pad": 7.059417305971702e-06, "add_states_from_episodes_to_batch": 2.732843466618167e-06, "add_observations_from_episodes_to_batch": 2.7744527604061167e-06}}, "connector_pipeline_timer": 5.940766112848706e-05}, "episode_return_min": -14.5, "num_agent_steps_sampled_lifetime": {"default_agent": 6800}, "episode_return_mean": -0.95, "module_to_env_connector": {"timers": {"connectors": {"remove_single_ts_time_rank_from_batch": 1.1916639382294945e-05, "un_batch_to_individual_items": 6.453885161189026e-06, "listify_data_for_vector_env": 1.0269967513274142e-05, "get_actions": 3.5553156512445396e-05, "tensor_to_numpy": 1.5149142137692355e-05, "normalize_and_clip_actions": 7.914007639222497e-06}}, "connector_pipeline_timer": 0.00011340796078521086}, "episode_duration_sec_mean": 0.005389807879691943, "num_env_steps_sampled": 400, "episode_return_max": 13.5, "env_to_module_sum_episodes_length_in": 10.368238394574323, "num_episodes_lifetime": 340, "env_to_module_sum_episodes_length_out": 10.368238394574323, "num_agent_steps_sampled": {"default_agent": 400}, "episode_len_mean": 20.0, "episode_len_min": 20, "agent_episode_returns_mean": {"default_agent": -0.95}, "num_module_steps_sampled_lifetime": {"default_policy": 6800}, "env_reset_timer": 0.0007020206123183303, "rlmodule_inference_timer": 3.091986013732988e-05, "num_module_steps_sampled": {"default_policy": 400}, "episode_len_max": 20, "env_step_timer": 1.3806402130135497e-05, "weights_seq_no": 17.0, "time_between_sampling": 11.239324392187656}, "num_healthy_workers": 1, "actor_manager_num_outstanding_async_reqs": 0, "num_remote_worker_restarts": 0}, "num_env_steps_sampled_lifetime": -9252500.0, "fault_tolerance": {"num_healthy_workers": 0, "num_remote_worker_restarts": 0}, "env_runner_group": {"actor_manager_num_outstanding_async_reqs": 0}, "done": false, "training_iteration": 17, "trial_id": "b7d85_00000", "date": "2025-08-11_18-03-31", "timestamp": 1754928211, "time_this_iter_s": 11.929145097732544, "time_total_s": 203.48991703987122, "pid": 10036, "hostname": "Mac", "node_ip": "127.0.0.1", "config": {"exploration_config": {}, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 2, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "env": "Umbrella", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": false, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 0, "create_local_env_runner": true, "num_envs_per_env_runner": 1, "gym_env_vectorize_mode": "SYNC", "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "episodes_to_numpy": true, "max_requests_in_flight_per_env_runner": 1, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "merge_env_runner_states": "training_only", "broadcast_env_runner_states": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "complete_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "sampler_perf_stats_ema_coef": null, "_is_online": true, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": "auto", "num_aggregator_actors_per_learner": 0, "max_requests_in_flight_per_aggregator_actor": 3, "local_gpu_idx": 0, "max_requests_in_flight_per_learner": 3, "gamma": 1, "lr": 0.0002715581955, "grad_clip": 0.5, "grad_clip_by": "global_norm", "_train_batch_size_per_learner": 5000, "train_batch_size": 4000, "num_epochs": 1, "minibatch_size": 1000, "shuffle_batch_per_epoch": true, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "log_std_clip_param": 20.0, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "_disable_preprocessor_api": false, "_disable_action_flattening": false}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {"intrinsic_reward_coeff": 0.2795015916508}, "optimizer": {}, "_learner_class": "<class 'source.intrinsic_attention_ppo.learners.IntrinsicAttentionMetaLearner.IntrinsicAttentionMetaLearner'>", "callbacks_on_algorithm_init": null, "callbacks_on_env_runners_recreated": null, "callbacks_on_offline_eval_runners_recreated": null, "callbacks_on_checkpoint_loaded": null, "callbacks_on_environment_created": null, "callbacks_on_episode_created": null, "callbacks_on_episode_start": null, "callbacks_on_episode_step": null, "callbacks_on_episode_end": null, "callbacks_on_evaluate_start": null, "callbacks_on_evaluate_end": null, "callbacks_on_evaluate_offline_start": null, "callbacks_on_evaluate_offline_end": null, "callbacks_on_sample_end": null, "callbacks_on_train_result": null, "explore": true, "enable_rl_module_and_learner": true, "enable_env_runner_and_connector_v2": true, "_prior_exploration_config": {"type": "StochasticSampling"}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x155e4d8a0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "offline_data_class": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_read_batch_size": null, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "materialize_data": false, "materialize_mapped_data": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "ignore_final_observation": false, "prelearner_class": null, "prelearner_buffer_class": null, "prelearner_buffer_kwargs": {}, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_remaining_data": false, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": 1, "evaluation_duration": 20, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_auto_duration_min_env_steps_per_sample": 100, "evaluation_auto_duration_max_env_steps_per_sample": 2000, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 1, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "offline_evaluation_interval": null, "num_offline_eval_runners": 0, "offline_loss_for_module_fn": null, "offline_evaluation_duration": 1, "offline_evaluation_parallel_to_training": false, "offline_evaluation_timeout_s": 120.0, "num_cpus_per_offline_eval_runner": 1, "num_gpus_per_offline_eval_runner": 0, "custom_resources_per_offline_eval_runner": {}, "restart_failed_offline_eval_runners": true, "ignore_offline_eval_runner_failures": false, "max_num_offline_eval_runner_restarts": 1000, "offline_eval_runner_restore_timeout_s": 1800.0, "max_requests_in_flight_per_offline_eval_runner": 1, "validate_offline_eval_runners_after_construction": true, "offline_eval_runner_health_probe_timeout_s": 30.0, "offline_eval_rl_module_inference_only": false, "broadcast_offline_eval_runner_states": false, "offline_eval_batch_size_per_runner": 256, "dataset_num_iters_per_eval_runner": 1, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "log_gradients": false, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 10, "restart_failed_env_runners": true, "ignore_env_runner_failures": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30.0, "env_runner_restore_timeout_s": 1800.0, "_model_config": {}, "_rl_module_spec": "MultiRLModuleSpec(multi_rl_module_class=<class 'ray.rllib.core.rl_module.multi_rl_module.MultiRLModule'>, observation_space=None, action_space=None, inference_only=False, model_config=None, rl_module_specs={'default_policy': RLModuleSpec(module_class=<class 'source.intrinsic_attention_ppo.rl_modules.DifferentiablePPOModule.DifferentiablePPOModule'>, observation_space=None, action_space=None, inference_only=False, learner_only=False, model_config={'vf_share_layers': True, 'embedding_dim': 62, 'max_seq_len': 3, 'policy_head_hidden_sizes': [32], 'value_head_hidden_sizes': [101], 'embedding_hidden_sizes': [121]}, catalog_class=None, load_state_path=None, model_config_dict=None), 'intrinsic_reward_module': RLModuleSpec(module_class=<class 'source.intrinsic_attention_ppo.rl_modules.IntrinsicAttentionModule.IntrinsicAttentionModule'>, observation_space=None, action_space=None, inference_only=False, learner_only=True, model_config={'intrinsic_reward_network': {'encoder_hidden_sizes': [], 'encoding_dim': 1, 'num_heads': 1, 'head_hidden_sizes': None, 'layers': [{'type': 'attention'}]}, 'extrinsic_value_hidden_layers': [127, 60], 'vf_share_layers': True, 'max_seq_len': 3}, catalog_class=None, load_state_path=None, model_config_dict=None)}, load_state_path=None, modules_to_load=None, module_specs={'default_policy': RLModuleSpec(module_class=<class 'source.intrinsic_attention_ppo.rl_modules.DifferentiablePPOModule.DifferentiablePPOModule'>, observation_space=None, action_space=None, inference_only=False, learner_only=False, model_config={'vf_share_layers': True, 'embedding_dim': 62, 'max_seq_len': 3, 'policy_head_hidden_sizes': [32], 'value_head_hidden_sizes': [101], 'embedding_hidden_sizes': [121]}, catalog_class=None, load_state_path=None, model_config_dict=None), 'intrinsic_reward_module': RLModuleSpec(module_class=<class 'source.intrinsic_attention_ppo.rl_modules.IntrinsicAttentionModule.IntrinsicAttentionModule'>, observation_space=None, action_space=None, inference_only=False, learner_only=True, model_config={'intrinsic_reward_network': {'encoder_hidden_sizes': [], 'encoding_dim': 1, 'num_heads': 1, 'head_hidden_sizes': None, 'layers': [{'type': 'attention'}]}, 'extrinsic_value_hidden_layers': [127, 60], 'vf_share_layers': True, 'max_seq_len': 3}, catalog_class=None, load_state_path=None, model_config_dict=None)})", "algorithm_config_overrides_per_module": {"intrinsic_reward_module": {"lr": 0.0002715581955}}, "_per_module_overrides": {}, "_validate_config": true, "_use_msgpack_checkpoints": false, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "env_task_fn": -1, "enable_connectors": -1, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.161583927863, "kl_target": 0.0201019014258, "vf_loss_coeff": 0.7790510010087, "entropy_coeff": 0.0015431216992, "clip_param": 0.2459212356676, "vf_clip_param": 0.3769744131561, "entropy_coeff_schedule": null, "lr_schedule": null, "sgd_minibatch_size": -1, "vf_share_layers": -1, "differentiable_learner_configs": ["DifferentiableLearnerConfig(learner_class=<class 'source.intrinsic_attention_ppo.learners.IntrinsicAttentionPPOLearner.IntrinsicAttentionPPOLearner'>, learner_connector=None, add_default_connectors_to_learner_pipeline=True, is_multi_agent=False, policies_to_update=['default_policy'], lr=0.0060984166342, num_total_minibatches=0, num_epochs=1, minibatch_size=1000, shuffle_batch_per_epoch=True)"], "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9485408017724, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.callbacks.callbacks.RLlibCallback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 203.48991703987122, "iterations_since_restore": 17, "perf": {"cpu_util_percent": 45.147058823529406, "ram_util_percent": 81.65294117647058}}
{"timers": {"training_iteration": 11.986334105053627, "restore_env_runners": 1.366586131880259e-05, "training_step": 11.986124085204965, "env_runner_sampling_timer": 1.627924105708312, "learner_update_timer": 10.14110570293192, "synch_weights": 0.0016555888166880106, "restore_eval_env_runners": 4.7647846111683124e-05, "evaluation_iteration": 0.1417741920585445, "synch_eval_env_connectors": 0.00024098062641943714, "synch_env_connectors": 4.372395513373014e-06}, "env_runners": {"rlmodule_inference_timer": 5.442285751135117e-05, "module_to_env_connector": {"timers": {"connectors": {"listify_data_for_vector_env": 1.4892032581531229e-05, "un_batch_to_individual_items": 1.400872850245979e-05, "get_actions": 7.099925075847045e-05, "remove_single_ts_time_rank_from_batch": 1.8624754547491376e-05, "tensor_to_numpy": 2.5263301514805885e-05, "normalize_and_clip_actions": 1.1451784063432526e-05}}, "connector_pipeline_timer": 0.00019274156774063686}, "module_episode_returns_mean": {"default_policy": 1.8199999999999996}, "episode_len_mean": 20.0, "episode_return_min": -10.5, "num_env_steps_sampled": 5000.0, "episode_return_max": 9.5, "env_to_module_sum_episodes_length_in": 10.36823839457432, "num_agent_steps_sampled": {"default_agent": 5000.0}, "episode_len_min": 20, "env_to_module_connector": {"connector_pipeline_timer": 8.394546652924313e-05, "timers": {"connectors": {"add_states_from_episodes_to_batch": 3.7512896875238945e-06, "batch_individual_items": 1.7552347120831188e-05, "numpy_to_tensor": 2.010407428018939e-05, "add_time_dim_to_batch_and_zero_pad": 1.0094590838752944e-05, "add_observations_from_episodes_to_batch": 3.964367453795294e-06}}}, "episode_len_max": 20, "num_episodes_lifetime": -493500.0, "env_step_timer": 2.197208342891645e-05, "env_reset_timer": 6.767892363601313e-05, "weights_seq_no": 17.0, "episode_return_mean": 1.8199999999999996, "num_module_steps_sampled": {"default_policy": 5000.0}, "time_between_sampling": 0.041867706816045486, "num_env_steps_sampled_lifetime": -9870000.0, "agent_episode_returns_mean": {"default_agent": 1.8199999999999996}, "sample": 0.008355263112421376, "num_agent_steps_sampled_lifetime": {"default_agent": -9870000.0}, "env_to_module_sum_episodes_length_out": 10.36823839457432, "episode_duration_sec_mean": 0.008246451514307406, "num_module_steps_sampled_lifetime": {"default_policy": -9870000.0}, "num_episodes": 250.0, "num_env_steps_sampled_lifetime_throughput": 2516.986511637445}, "__all_modules__": {"learner_connector_sum_episodes_length_in": 5000.0, "learner_connector": {"connector_pipeline_timer": 0.17668562376619962, "timers": {"connectors": {"add_one_ts_to_episodes_and_truncate": 0.009179067486601713, "add_observations_from_episodes_to_batch": 0.0008939199495448171, "add_columns_from_episodes_to_train_batch": 0.04216044208306479, "add_time_dim_to_batch_and_zero_pad": 0.10537051133489062, "add_states_from_episodes_to_batch": 0.0035393913426867694, "batch_individual_items": 0.015333044917290869, "numpy_to_tensor": 6.809670190706534e-05}}}, "learner_connector_sum_episodes_length_out": 5250.0}, "learners": {"default_policy": {"num_module_steps_trained": 5994, "curr_kl_coeff": 6.163937769088079e-07, "num_module_steps_trained_lifetime": 107892, "num_trainable_parameters": 16595, "diff_num_grad_updates_vs_sampler_policy": 1.0, "weights_seq_no": 18.0, "use_intrinsic_rewards": 0.0, "total_loss": 0.2038652002811432, "vf_loss": 0.2638692557811737, "mean_kl_loss": 8.015844650799409e-05, "vf_loss_unclipped": 37.692264556884766, "curr_entropy_coeff": 0.0015431216992, "policy_loss": -0.0006703668623231351, "entropy": 0.6688030958175659, "vf_explained_var": 0.00029164552688598633, "module_train_batch_size_mean": 999.0, "num_module_steps_trained_lifetime_throughput": 608.9651624107327}, "intrinsic_reward_module": {"default_optimizer_learning_rate": 0.0002715581955, "num_module_steps_trained_lifetime": 107892, "num_trainable_parameters": 8266, "diff_num_grad_updates_vs_sampler_policy": 1.0, "total_loss": 0.0, "weights_seq_no": 18.0, "curr_entropy_coeff": 0.0015431216992, "module_train_batch_size_mean": 999.0, "num_module_steps_trained": 5994, "gradients_default_optimizer_global_norm": 0.0, "num_module_steps_trained_lifetime_throughput": 608.9702524281884}, "__all_modules__": {"num_env_steps_trained": 31500, "num_non_trainable_parameters": 0, "num_module_steps_trained": 11988, "num_env_steps_trained_lifetime": 567000, "num_module_steps_trained_lifetime": 215784, "num_trainable_parameters": 24861, "num_env_steps_trained_lifetime_throughput": 3200.307298866184, "num_module_steps_trained_throughput": 20790006.181693695, "num_module_steps_trained_lifetime_throughput": 12459431.512623439}, "differentiable_learners": {"intrinsic_attention_ppo_learner": {"default_policy": {"use_intrinsic_rewards": 1.0, "vf_loss": 0.26388317346572876, "vf_loss_unclipped": 37.694820404052734, "policy_loss": -0.0006492722313851118, "num_module_steps_trained": 35964, "entropy": 0.6688918471336365, "vf_explained_var": 0.0012984275817871094, "module_train_batch_size_mean": 999.0, "num_module_steps_trained_lifetime": 647352, "total_loss": 0.20390914380550385, "diff_num_grad_updates_vs_sampler_policy": 91.0, "mean_kl_loss": 7.508411363232881e-05, "weights_seq_no": 108.0}, "__all_modules__": {"num_env_steps_trained": 189000, "num_module_steps_trained": 71928, "num_env_steps_trained_lifetime": 3402000, "num_module_steps_trained_lifetime": 1294704, "num_env_steps_trained_lifetime_throughput": 37086.010437837336}, "intrinsic_reward_module": {"num_module_steps_trained": 35964, "module_train_batch_size_mean": 999.0, "num_module_steps_trained_lifetime": 647352, "total_loss": 0.0, "diff_num_grad_updates_vs_sampler_policy": 91.0, "weights_seq_no": 108.0}}}, "IntrinsicAttentionMask": [[[0.3324126899242401, 0.33291128277778625, 0.33467599749565125], [0.3326375186443329, 0.333014577627182, 0.3343479335308075], [0.33343034982681274, 0.3333776891231537, 0.33319199085235596]], [[0.333376407623291, 0.3332821726799011, 0.33334147930145264], [0.33343905210494995, 0.33320772647857666, 0.33335328102111816], [0.33339962363243103, 0.3332545757293701, 0.33334586024284363]], [[0.3332003057003021, 0.3333742618560791, 0.3334254026412964], [0.3336813747882843, 0.33322617411613464, 0.3330925405025482], [0.33382272720336914, 0.33318254351615906, 0.3329946994781494]], [[0.3333202600479126, 0.333046019077301, 0.33363375067710876], [0.33331361413002014, 0.3329024612903595, 0.3337838649749756], [0.3333277404308319, 0.3332099914550781, 0.33346232771873474]], [[0.33328717947006226, 0.3334018290042877, 0.33331096172332764], [0.33354032039642334, 0.3330260217189789, 0.3334336280822754], [0.333339661359787, 0.3333238959312439, 0.33333641290664673]], [[0.332539826631546, 0.33519235253334045, 0.3322678506374359], [0.33487406373023987, 0.3297160267829895, 0.33540982007980347], [0.33229777216911316, 0.33575883507728577, 0.3319433629512787]]]}, "num_training_step_calls_per_iteration": 1, "evaluation": {"env_runners": {"module_episode_returns_mean": {"default_policy": 0.25}, "num_env_steps_sampled_lifetime": 90400, "sample": 0.12940733629815748, "num_episodes": 20, "env_to_module_connector": {"timers": {"connectors": {"batch_individual_items": 1.265945968122711e-05, "numpy_to_tensor": 1.239545404473849e-05, "add_time_dim_to_batch_and_zero_pad": 7.169311598587631e-06, "add_states_from_episodes_to_batch": 2.7830536660725326e-06, "add_observations_from_episodes_to_batch": 2.8134239723856653e-06}}, "connector_pipeline_timer": 6.012505635463912e-05}, "episode_return_min": -14.5, "num_agent_steps_sampled_lifetime": {"default_agent": 7200}, "episode_return_mean": 0.25, "module_to_env_connector": {"timers": {"connectors": {"remove_single_ts_time_rank_from_batch": 1.1873155008540713e-05, "un_batch_to_individual_items": 6.532587885104593e-06, "listify_data_for_vector_env": 1.0499697245152584e-05, "get_actions": 3.631688385082418e-05, "tensor_to_numpy": 1.539808892237035e-05, "normalize_and_clip_actions": 7.999362618321149e-06}}, "connector_pipeline_timer": 0.00011507062116665133}, "episode_duration_sec_mean": 0.0054245795565657316, "num_env_steps_sampled": 400, "episode_return_max": 13.5, "env_to_module_sum_episodes_length_in": 10.368238394574323, "num_episodes_lifetime": 360, "env_to_module_sum_episodes_length_out": 10.368238394574323, "num_agent_steps_sampled": {"default_agent": 400}, "episode_len_mean": 20.0, "episode_len_min": 20, "agent_episode_returns_mean": {"default_agent": 0.25}, "num_module_steps_sampled_lifetime": {"default_policy": 7200}, "env_reset_timer": 0.0006981929054751229, "rlmodule_inference_timer": 3.1317139880067976e-05, "num_module_steps_sampled": {"default_policy": 400}, "episode_len_max": 20, "env_step_timer": 1.4378987040632432e-05, "weights_seq_no": 18.0, "time_between_sampling": 11.252567387846124}, "num_healthy_workers": 1, "actor_manager_num_outstanding_async_reqs": 0, "num_remote_worker_restarts": 0}, "num_env_steps_sampled_lifetime": -9870000.0, "fault_tolerance": {"num_healthy_workers": 0, "num_remote_worker_restarts": 0}, "env_runner_group": {"actor_manager_num_outstanding_async_reqs": 0}, "done": false, "training_iteration": 18, "trial_id": "b7d85_00000", "date": "2025-08-11_18-03-44", "timestamp": 1754928224, "time_this_iter_s": 12.665526866912842, "time_total_s": 216.15544390678406, "pid": 10036, "hostname": "Mac", "node_ip": "127.0.0.1", "config": {"exploration_config": {}, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 2, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "env": "Umbrella", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": false, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 0, "create_local_env_runner": true, "num_envs_per_env_runner": 1, "gym_env_vectorize_mode": "SYNC", "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "episodes_to_numpy": true, "max_requests_in_flight_per_env_runner": 1, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "merge_env_runner_states": "training_only", "broadcast_env_runner_states": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "complete_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "sampler_perf_stats_ema_coef": null, "_is_online": true, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": "auto", "num_aggregator_actors_per_learner": 0, "max_requests_in_flight_per_aggregator_actor": 3, "local_gpu_idx": 0, "max_requests_in_flight_per_learner": 3, "gamma": 1, "lr": 0.0002715581955, "grad_clip": 0.5, "grad_clip_by": "global_norm", "_train_batch_size_per_learner": 5000, "train_batch_size": 4000, "num_epochs": 1, "minibatch_size": 1000, "shuffle_batch_per_epoch": true, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "log_std_clip_param": 20.0, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "_disable_preprocessor_api": false, "_disable_action_flattening": false}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {"intrinsic_reward_coeff": 0.2795015916508}, "optimizer": {}, "_learner_class": "<class 'source.intrinsic_attention_ppo.learners.IntrinsicAttentionMetaLearner.IntrinsicAttentionMetaLearner'>", "callbacks_on_algorithm_init": null, "callbacks_on_env_runners_recreated": null, "callbacks_on_offline_eval_runners_recreated": null, "callbacks_on_checkpoint_loaded": null, "callbacks_on_environment_created": null, "callbacks_on_episode_created": null, "callbacks_on_episode_start": null, "callbacks_on_episode_step": null, "callbacks_on_episode_end": null, "callbacks_on_evaluate_start": null, "callbacks_on_evaluate_end": null, "callbacks_on_evaluate_offline_start": null, "callbacks_on_evaluate_offline_end": null, "callbacks_on_sample_end": null, "callbacks_on_train_result": null, "explore": true, "enable_rl_module_and_learner": true, "enable_env_runner_and_connector_v2": true, "_prior_exploration_config": {"type": "StochasticSampling"}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x155e4d8a0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "offline_data_class": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_read_batch_size": null, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "materialize_data": false, "materialize_mapped_data": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "ignore_final_observation": false, "prelearner_class": null, "prelearner_buffer_class": null, "prelearner_buffer_kwargs": {}, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_remaining_data": false, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": 1, "evaluation_duration": 20, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_auto_duration_min_env_steps_per_sample": 100, "evaluation_auto_duration_max_env_steps_per_sample": 2000, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 1, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "offline_evaluation_interval": null, "num_offline_eval_runners": 0, "offline_loss_for_module_fn": null, "offline_evaluation_duration": 1, "offline_evaluation_parallel_to_training": false, "offline_evaluation_timeout_s": 120.0, "num_cpus_per_offline_eval_runner": 1, "num_gpus_per_offline_eval_runner": 0, "custom_resources_per_offline_eval_runner": {}, "restart_failed_offline_eval_runners": true, "ignore_offline_eval_runner_failures": false, "max_num_offline_eval_runner_restarts": 1000, "offline_eval_runner_restore_timeout_s": 1800.0, "max_requests_in_flight_per_offline_eval_runner": 1, "validate_offline_eval_runners_after_construction": true, "offline_eval_runner_health_probe_timeout_s": 30.0, "offline_eval_rl_module_inference_only": false, "broadcast_offline_eval_runner_states": false, "offline_eval_batch_size_per_runner": 256, "dataset_num_iters_per_eval_runner": 1, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "log_gradients": false, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 10, "restart_failed_env_runners": true, "ignore_env_runner_failures": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30.0, "env_runner_restore_timeout_s": 1800.0, "_model_config": {}, "_rl_module_spec": "MultiRLModuleSpec(multi_rl_module_class=<class 'ray.rllib.core.rl_module.multi_rl_module.MultiRLModule'>, observation_space=None, action_space=None, inference_only=False, model_config=None, rl_module_specs={'default_policy': RLModuleSpec(module_class=<class 'source.intrinsic_attention_ppo.rl_modules.DifferentiablePPOModule.DifferentiablePPOModule'>, observation_space=None, action_space=None, inference_only=False, learner_only=False, model_config={'vf_share_layers': True, 'embedding_dim': 62, 'max_seq_len': 3, 'policy_head_hidden_sizes': [32], 'value_head_hidden_sizes': [101], 'embedding_hidden_sizes': [121]}, catalog_class=None, load_state_path=None, model_config_dict=None), 'intrinsic_reward_module': RLModuleSpec(module_class=<class 'source.intrinsic_attention_ppo.rl_modules.IntrinsicAttentionModule.IntrinsicAttentionModule'>, observation_space=None, action_space=None, inference_only=False, learner_only=True, model_config={'intrinsic_reward_network': {'encoder_hidden_sizes': [], 'encoding_dim': 1, 'num_heads': 1, 'head_hidden_sizes': None, 'layers': [{'type': 'attention'}]}, 'extrinsic_value_hidden_layers': [127, 60], 'vf_share_layers': True, 'max_seq_len': 3}, catalog_class=None, load_state_path=None, model_config_dict=None)}, load_state_path=None, modules_to_load=None, module_specs={'default_policy': RLModuleSpec(module_class=<class 'source.intrinsic_attention_ppo.rl_modules.DifferentiablePPOModule.DifferentiablePPOModule'>, observation_space=None, action_space=None, inference_only=False, learner_only=False, model_config={'vf_share_layers': True, 'embedding_dim': 62, 'max_seq_len': 3, 'policy_head_hidden_sizes': [32], 'value_head_hidden_sizes': [101], 'embedding_hidden_sizes': [121]}, catalog_class=None, load_state_path=None, model_config_dict=None), 'intrinsic_reward_module': RLModuleSpec(module_class=<class 'source.intrinsic_attention_ppo.rl_modules.IntrinsicAttentionModule.IntrinsicAttentionModule'>, observation_space=None, action_space=None, inference_only=False, learner_only=True, model_config={'intrinsic_reward_network': {'encoder_hidden_sizes': [], 'encoding_dim': 1, 'num_heads': 1, 'head_hidden_sizes': None, 'layers': [{'type': 'attention'}]}, 'extrinsic_value_hidden_layers': [127, 60], 'vf_share_layers': True, 'max_seq_len': 3}, catalog_class=None, load_state_path=None, model_config_dict=None)})", "algorithm_config_overrides_per_module": {"intrinsic_reward_module": {"lr": 0.0002715581955}}, "_per_module_overrides": {}, "_validate_config": true, "_use_msgpack_checkpoints": false, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "env_task_fn": -1, "enable_connectors": -1, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.161583927863, "kl_target": 0.0201019014258, "vf_loss_coeff": 0.7790510010087, "entropy_coeff": 0.0015431216992, "clip_param": 0.2459212356676, "vf_clip_param": 0.3769744131561, "entropy_coeff_schedule": null, "lr_schedule": null, "sgd_minibatch_size": -1, "vf_share_layers": -1, "differentiable_learner_configs": ["DifferentiableLearnerConfig(learner_class=<class 'source.intrinsic_attention_ppo.learners.IntrinsicAttentionPPOLearner.IntrinsicAttentionPPOLearner'>, learner_connector=None, add_default_connectors_to_learner_pipeline=True, is_multi_agent=False, policies_to_update=['default_policy'], lr=0.0060984166342, num_total_minibatches=0, num_epochs=1, minibatch_size=1000, shuffle_batch_per_epoch=True)"], "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9485408017724, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.callbacks.callbacks.RLlibCallback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 216.15544390678406, "iterations_since_restore": 18, "perf": {"cpu_util_percent": 52.77222222222221, "ram_util_percent": 82.2}}
{"timers": {"training_iteration": 11.982873596083003, "restore_env_runners": 1.3588371957086321e-05, "training_step": 11.98266349894244, "env_runner_sampling_timer": 1.6301895517304947, "learner_update_timer": 10.13534093507169, "synch_weights": 0.0016526812582894604, "restore_eval_env_runners": 4.7560948032600474e-05, "evaluation_iteration": 0.14163543972773218, "synch_eval_env_connectors": 0.00024027790067406962, "synch_env_connectors": 4.3690816447518495e-06}, "env_runners": {"rlmodule_inference_timer": 6.961430768230009e-05, "module_to_env_connector": {"timers": {"connectors": {"listify_data_for_vector_env": 1.1317964958284064e-05, "un_batch_to_individual_items": 6.998617174512812e-06, "get_actions": 4.6838094066195284e-05, "remove_single_ts_time_rank_from_batch": 1.2899150124303386e-05, "tensor_to_numpy": 1.7038551501490162e-05, "normalize_and_clip_actions": 8.64425332559919e-06}}, "connector_pipeline_timer": 0.00013186017932280948}, "module_episode_returns_mean": {"default_policy": 1.74}, "episode_len_mean": 20.0, "episode_return_min": -10.5, "num_env_steps_sampled": 5000.0, "episode_return_max": 9.5, "env_to_module_sum_episodes_length_in": 10.36823839457432, "num_agent_steps_sampled": {"default_agent": 5000.0}, "episode_len_min": 20, "env_to_module_connector": {"connector_pipeline_timer": 6.401274375747126e-05, "timers": {"connectors": {"add_states_from_episodes_to_batch": 2.890272112881475e-06, "batch_individual_items": 1.3176148294739141e-05, "numpy_to_tensor": 1.4036078601846166e-05, "add_time_dim_to_batch_and_zero_pad": 7.720030043929637e-06, "add_observations_from_episodes_to_batch": 3.019749747028974e-06}}}, "episode_len_max": 20, "num_episodes_lifetime": -524375.0, "env_step_timer": 1.5610975307793635e-05, "env_reset_timer": 5.6847109267816806e-05, "weights_seq_no": 18.0, "episode_return_mean": 1.74, "num_module_steps_sampled": {"default_policy": 5000.0}, "time_between_sampling": 0.04172226504561452, "num_env_steps_sampled_lifetime": -10487500.0, "agent_episode_returns_mean": {"default_agent": 1.74}, "sample": 0.007221273225452789, "num_agent_steps_sampled_lifetime": {"default_agent": -10487500.0}, "env_to_module_sum_episodes_length_out": 10.36823839457432, "episode_duration_sec_mean": 0.006431121520698069, "num_module_steps_sampled_lifetime": {"default_policy": -10487500.0}, "num_episodes": 250.0, "num_env_steps_sampled_lifetime_throughput": 2937.1145507890815}, "__all_modules__": {"learner_connector_sum_episodes_length_in": 5000.0, "learner_connector": {"connector_pipeline_timer": 0.17662663586826433, "timers": {"connectors": {"add_one_ts_to_episodes_and_truncate": 0.009179351402238002, "add_observations_from_episodes_to_batch": 0.0008933474097986682, "add_columns_from_episodes_to_train_batch": 0.042157381412654356, "add_time_dim_to_batch_and_zero_pad": 0.10533668372074398, "add_states_from_episodes_to_batch": 0.0035408274291407666, "batch_individual_items": 0.015310012388086103, "numpy_to_tensor": 6.819198526901737e-05}}}, "learner_connector_sum_episodes_length_out": 5250.0}, "learners": {"default_policy": {"num_module_steps_trained": 5994, "curr_kl_coeff": 3.0819688845440396e-07, "num_module_steps_trained_lifetime": 113886, "num_trainable_parameters": 16595, "diff_num_grad_updates_vs_sampler_policy": 1.0, "weights_seq_no": 19.0, "use_intrinsic_rewards": 0.0, "total_loss": 0.20428575575351715, "vf_loss": 0.2638690173625946, "mean_kl_loss": 5.620501906378195e-05, "vf_loss_unclipped": 37.42587661743164, "curr_entropy_coeff": 0.0015431216992, "policy_loss": -0.000253435195190832, "entropy": 0.6663248538970947, "vf_explained_var": 1.2040138244628906e-05, "module_train_batch_size_mean": 999.0, "num_module_steps_trained_lifetime_throughput": 607.0689451430427}, "intrinsic_reward_module": {"default_optimizer_learning_rate": 0.0002715581955, "num_module_steps_trained_lifetime": 113886, "num_trainable_parameters": 8266, "diff_num_grad_updates_vs_sampler_policy": 1.0, "total_loss": 0.0, "weights_seq_no": 19.0, "curr_entropy_coeff": 0.0015431216992, "module_train_batch_size_mean": 999.0, "num_module_steps_trained": 5994, "gradients_default_optimizer_global_norm": 0.0, "num_module_steps_trained_lifetime_throughput": 607.0736898464918}, "__all_modules__": {"num_env_steps_trained": 31500, "num_non_trainable_parameters": 0, "num_module_steps_trained": 11988, "num_env_steps_trained_lifetime": 598500, "num_module_steps_trained_lifetime": 227772, "num_trainable_parameters": 24861, "num_env_steps_trained_lifetime_throughput": 3190.3402158170747, "num_module_steps_trained_throughput": 20301348.38956621, "num_module_steps_trained_lifetime_throughput": 12435605.571461352}, "differentiable_learners": {"intrinsic_attention_ppo_learner": {"default_policy": {"use_intrinsic_rewards": 1.0, "vf_loss": 0.2638958990573883, "vf_loss_unclipped": 37.44068908691406, "policy_loss": -0.0002481488627381623, "num_module_steps_trained": 35964, "entropy": 0.666351854801178, "vf_explained_var": 0.0012331604957580566, "module_train_batch_size_mean": 999.0, "num_module_steps_trained_lifetime": 683316, "total_loss": 0.20432084798812866, "diff_num_grad_updates_vs_sampler_policy": 96.0, "mean_kl_loss": 5.490757030202076e-05, "weights_seq_no": 114.0}, "__all_modules__": {"num_env_steps_trained": 189000, "num_module_steps_trained": 71928, "num_env_steps_trained_lifetime": 3591000, "num_module_steps_trained_lifetime": 1366632, "num_env_steps_trained_lifetime_throughput": 36486.03059715057}, "intrinsic_reward_module": {"num_module_steps_trained": 35964, "module_train_batch_size_mean": 999.0, "num_module_steps_trained_lifetime": 683316, "total_loss": 0.0, "diff_num_grad_updates_vs_sampler_policy": 96.0, "weights_seq_no": 114.0}}}, "IntrinsicAttentionMask": [[[0.3334004878997803, 0.33343952894210815, 0.33316004276275635], [0.3333923816680908, 0.33342671394348145, 0.3331809341907501], [0.3334503769874573, 0.33351844549179077, 0.33303117752075195]], [[0.3334238827228546, 0.33322572708129883, 0.33335041999816895], [0.33348649740219116, 0.33315128087997437, 0.3333622217178345], [0.33344706892967224, 0.33319810032844543, 0.33335480093955994]], [[0.3328327238559723, 0.33369123935699463, 0.3334760069847107], [0.33333730697631836, 0.3333304822444916, 0.33333221077919006], [0.33321088552474976, 0.33342084288597107, 0.3333682417869568]], [[0.3334575295448303, 0.3332870602607727, 0.33325546979904175], [0.3335573971271515, 0.3332498073577881, 0.3331928253173828], [0.33357590436935425, 0.33324289321899414, 0.333181232213974]], [[0.33319759368896484, 0.3331684470176697, 0.33363401889801025], [0.3331756889820099, 0.3331418037414551, 0.3336825370788574], [0.3335250914096832, 0.3335663378238678, 0.33290866017341614]], [[0.33310365676879883, 0.3337364196777344, 0.3331599235534668], [0.3368936777114868, 0.32709652185440063, 0.33600980043411255], [0.33344200253486633, 0.33314263820648193, 0.33341535925865173]]]}, "num_training_step_calls_per_iteration": 1, "evaluation": {"env_runners": {"module_episode_returns_mean": {"default_policy": 0.45}, "num_env_steps_sampled_lifetime": 95400, "sample": 0.12925069293482916, "num_episodes": 20, "env_to_module_connector": {"timers": {"connectors": {"batch_individual_items": 1.2349022118417681e-05, "numpy_to_tensor": 1.1904769377094193e-05, "add_time_dim_to_batch_and_zero_pad": 6.8830527810015525e-06, "add_states_from_episodes_to_batch": 2.7168095444078437e-06, "add_observations_from_episodes_to_batch": 2.7511453808622076e-06}}, "connector_pipeline_timer": 5.85685210172371e-05}, "episode_return_min": -14.5, "num_agent_steps_sampled_lifetime": {"default_agent": 7600}, "episode_return_mean": 0.45, "module_to_env_connector": {"timers": {"connectors": {"remove_single_ts_time_rank_from_batch": 1.1900753716802336e-05, "un_batch_to_individual_items": 6.400503241408369e-06, "listify_data_for_vector_env": 1.0260417534764238e-05, "get_actions": 3.521084852604906e-05, "tensor_to_numpy": 1.4945185023942722e-05, "normalize_and_clip_actions": 7.871198842502617e-06}}, "connector_pipeline_timer": 0.00011251864088382463}, "episode_duration_sec_mean": 0.005412363349460065, "num_env_steps_sampled": 400, "episode_return_max": 13.5, "env_to_module_sum_episodes_length_in": 10.368238394574323, "num_episodes_lifetime": 380, "env_to_module_sum_episodes_length_out": 10.368238394574323, "num_agent_steps_sampled": {"default_agent": 400}, "episode_len_mean": 20.0, "episode_len_min": 20, "agent_episode_returns_mean": {"default_agent": 0.45}, "num_module_steps_sampled_lifetime": {"default_policy": 7600}, "env_reset_timer": 0.0006943463972680558, "rlmodule_inference_timer": 3.0259354933175376e-05, "num_module_steps_sampled": {"default_policy": 400}, "episode_len_max": 20, "env_step_timer": 1.3585713522682397e-05, "weights_seq_no": 19.0, "time_between_sampling": 11.256741683547594}, "num_healthy_workers": 1, "actor_manager_num_outstanding_async_reqs": 0, "num_remote_worker_restarts": 0}, "num_env_steps_sampled_lifetime": -10487500.0, "fault_tolerance": {"num_healthy_workers": 0, "num_remote_worker_restarts": 0}, "env_runner_group": {"actor_manager_num_outstanding_async_reqs": 0}, "done": false, "training_iteration": 19, "trial_id": "b7d85_00000", "date": "2025-08-11_18-03-56", "timestamp": 1754928236, "time_this_iter_s": 11.765905380249023, "time_total_s": 227.92134928703308, "pid": 10036, "hostname": "Mac", "node_ip": "127.0.0.1", "config": {"exploration_config": {}, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 2, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "env": "Umbrella", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": false, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 0, "create_local_env_runner": true, "num_envs_per_env_runner": 1, "gym_env_vectorize_mode": "SYNC", "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "episodes_to_numpy": true, "max_requests_in_flight_per_env_runner": 1, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "merge_env_runner_states": "training_only", "broadcast_env_runner_states": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "complete_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "sampler_perf_stats_ema_coef": null, "_is_online": true, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": "auto", "num_aggregator_actors_per_learner": 0, "max_requests_in_flight_per_aggregator_actor": 3, "local_gpu_idx": 0, "max_requests_in_flight_per_learner": 3, "gamma": 1, "lr": 0.0002715581955, "grad_clip": 0.5, "grad_clip_by": "global_norm", "_train_batch_size_per_learner": 5000, "train_batch_size": 4000, "num_epochs": 1, "minibatch_size": 1000, "shuffle_batch_per_epoch": true, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "log_std_clip_param": 20.0, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "_disable_preprocessor_api": false, "_disable_action_flattening": false}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {"intrinsic_reward_coeff": 0.2795015916508}, "optimizer": {}, "_learner_class": "<class 'source.intrinsic_attention_ppo.learners.IntrinsicAttentionMetaLearner.IntrinsicAttentionMetaLearner'>", "callbacks_on_algorithm_init": null, "callbacks_on_env_runners_recreated": null, "callbacks_on_offline_eval_runners_recreated": null, "callbacks_on_checkpoint_loaded": null, "callbacks_on_environment_created": null, "callbacks_on_episode_created": null, "callbacks_on_episode_start": null, "callbacks_on_episode_step": null, "callbacks_on_episode_end": null, "callbacks_on_evaluate_start": null, "callbacks_on_evaluate_end": null, "callbacks_on_evaluate_offline_start": null, "callbacks_on_evaluate_offline_end": null, "callbacks_on_sample_end": null, "callbacks_on_train_result": null, "explore": true, "enable_rl_module_and_learner": true, "enable_env_runner_and_connector_v2": true, "_prior_exploration_config": {"type": "StochasticSampling"}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x155e4d8a0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "offline_data_class": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_read_batch_size": null, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "materialize_data": false, "materialize_mapped_data": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "ignore_final_observation": false, "prelearner_class": null, "prelearner_buffer_class": null, "prelearner_buffer_kwargs": {}, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_remaining_data": false, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": 1, "evaluation_duration": 20, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_auto_duration_min_env_steps_per_sample": 100, "evaluation_auto_duration_max_env_steps_per_sample": 2000, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 1, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "offline_evaluation_interval": null, "num_offline_eval_runners": 0, "offline_loss_for_module_fn": null, "offline_evaluation_duration": 1, "offline_evaluation_parallel_to_training": false, "offline_evaluation_timeout_s": 120.0, "num_cpus_per_offline_eval_runner": 1, "num_gpus_per_offline_eval_runner": 0, "custom_resources_per_offline_eval_runner": {}, "restart_failed_offline_eval_runners": true, "ignore_offline_eval_runner_failures": false, "max_num_offline_eval_runner_restarts": 1000, "offline_eval_runner_restore_timeout_s": 1800.0, "max_requests_in_flight_per_offline_eval_runner": 1, "validate_offline_eval_runners_after_construction": true, "offline_eval_runner_health_probe_timeout_s": 30.0, "offline_eval_rl_module_inference_only": false, "broadcast_offline_eval_runner_states": false, "offline_eval_batch_size_per_runner": 256, "dataset_num_iters_per_eval_runner": 1, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "log_gradients": false, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 10, "restart_failed_env_runners": true, "ignore_env_runner_failures": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30.0, "env_runner_restore_timeout_s": 1800.0, "_model_config": {}, "_rl_module_spec": "MultiRLModuleSpec(multi_rl_module_class=<class 'ray.rllib.core.rl_module.multi_rl_module.MultiRLModule'>, observation_space=None, action_space=None, inference_only=False, model_config=None, rl_module_specs={'default_policy': RLModuleSpec(module_class=<class 'source.intrinsic_attention_ppo.rl_modules.DifferentiablePPOModule.DifferentiablePPOModule'>, observation_space=None, action_space=None, inference_only=False, learner_only=False, model_config={'vf_share_layers': True, 'embedding_dim': 62, 'max_seq_len': 3, 'policy_head_hidden_sizes': [32], 'value_head_hidden_sizes': [101], 'embedding_hidden_sizes': [121]}, catalog_class=None, load_state_path=None, model_config_dict=None), 'intrinsic_reward_module': RLModuleSpec(module_class=<class 'source.intrinsic_attention_ppo.rl_modules.IntrinsicAttentionModule.IntrinsicAttentionModule'>, observation_space=None, action_space=None, inference_only=False, learner_only=True, model_config={'intrinsic_reward_network': {'encoder_hidden_sizes': [], 'encoding_dim': 1, 'num_heads': 1, 'head_hidden_sizes': None, 'layers': [{'type': 'attention'}]}, 'extrinsic_value_hidden_layers': [127, 60], 'vf_share_layers': True, 'max_seq_len': 3}, catalog_class=None, load_state_path=None, model_config_dict=None)}, load_state_path=None, modules_to_load=None, module_specs={'default_policy': RLModuleSpec(module_class=<class 'source.intrinsic_attention_ppo.rl_modules.DifferentiablePPOModule.DifferentiablePPOModule'>, observation_space=None, action_space=None, inference_only=False, learner_only=False, model_config={'vf_share_layers': True, 'embedding_dim': 62, 'max_seq_len': 3, 'policy_head_hidden_sizes': [32], 'value_head_hidden_sizes': [101], 'embedding_hidden_sizes': [121]}, catalog_class=None, load_state_path=None, model_config_dict=None), 'intrinsic_reward_module': RLModuleSpec(module_class=<class 'source.intrinsic_attention_ppo.rl_modules.IntrinsicAttentionModule.IntrinsicAttentionModule'>, observation_space=None, action_space=None, inference_only=False, learner_only=True, model_config={'intrinsic_reward_network': {'encoder_hidden_sizes': [], 'encoding_dim': 1, 'num_heads': 1, 'head_hidden_sizes': None, 'layers': [{'type': 'attention'}]}, 'extrinsic_value_hidden_layers': [127, 60], 'vf_share_layers': True, 'max_seq_len': 3}, catalog_class=None, load_state_path=None, model_config_dict=None)})", "algorithm_config_overrides_per_module": {"intrinsic_reward_module": {"lr": 0.0002715581955}}, "_per_module_overrides": {}, "_validate_config": true, "_use_msgpack_checkpoints": false, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "env_task_fn": -1, "enable_connectors": -1, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.161583927863, "kl_target": 0.0201019014258, "vf_loss_coeff": 0.7790510010087, "entropy_coeff": 0.0015431216992, "clip_param": 0.2459212356676, "vf_clip_param": 0.3769744131561, "entropy_coeff_schedule": null, "lr_schedule": null, "sgd_minibatch_size": -1, "vf_share_layers": -1, "differentiable_learner_configs": ["DifferentiableLearnerConfig(learner_class=<class 'source.intrinsic_attention_ppo.learners.IntrinsicAttentionPPOLearner.IntrinsicAttentionPPOLearner'>, learner_connector=None, add_default_connectors_to_learner_pipeline=True, is_multi_agent=False, policies_to_update=['default_policy'], lr=0.0060984166342, num_total_minibatches=0, num_epochs=1, minibatch_size=1000, shuffle_batch_per_epoch=True)"], "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9485408017724, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.callbacks.callbacks.RLlibCallback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 227.92134928703308, "iterations_since_restore": 19, "perf": {"cpu_util_percent": 40.094117647058816, "ram_util_percent": 82.63529411764706}}
{"timers": {"training_iteration": 11.978949675122422, "restore_env_runners": 1.3529147726938494e-05, "training_step": 11.978739092282812, "env_runner_sampling_timer": 1.6307291545436582, "learner_update_timer": 10.13083226406098, "synch_weights": 0.00165223236556973, "restore_eval_env_runners": 4.752700897006011e-05, "evaluation_iteration": 0.14144357449010408, "synch_eval_env_connectors": 0.00023961887184837803, "synch_env_connectors": 4.368720611088316e-06}, "env_runners": {"rlmodule_inference_timer": 3.2896442441037886e-05, "module_to_env_connector": {"timers": {"connectors": {"listify_data_for_vector_env": 1.0456091658895102e-05, "un_batch_to_individual_items": 6.502589508435351e-06, "get_actions": 4.150186046427353e-05, "remove_single_ts_time_rank_from_batch": 1.2002767997646033e-05, "tensor_to_numpy": 1.565583881865184e-05, "normalize_and_clip_actions": 8.018464852725759e-06}}, "connector_pipeline_timer": 0.00012066657139499863}, "module_episode_returns_mean": {"default_policy": 1.74}, "episode_len_mean": 20.0, "episode_return_min": -10.5, "num_env_steps_sampled": 5000.0, "episode_return_max": 9.5, "env_to_module_sum_episodes_length_in": 10.36823839457432, "num_agent_steps_sampled": {"default_agent": 5000.0}, "episode_len_min": 20, "env_to_module_connector": {"connector_pipeline_timer": 5.9627119100306105e-05, "timers": {"connectors": {"add_states_from_episodes_to_batch": 2.7158526978332064e-06, "batch_individual_items": 1.2468945211650604e-05, "numpy_to_tensor": 1.2708148976263372e-05, "add_time_dim_to_batch_and_zero_pad": 6.946229509798231e-06, "add_observations_from_episodes_to_batch": 2.7773646589931404e-06}}}, "episode_len_max": 20, "num_episodes_lifetime": -555250.0, "env_step_timer": 1.3861600550055393e-05, "env_reset_timer": 4.235851243159998e-05, "weights_seq_no": 19.0, "episode_return_mean": 1.74, "num_module_steps_sampled": {"default_policy": 5000.0}, "time_between_sampling": 0.0407185342334445, "num_env_steps_sampled_lifetime": -11105000.0, "agent_episode_returns_mean": {"default_agent": 1.74}, "sample": 0.0059437995441374404, "num_agent_steps_sampled_lifetime": {"default_agent": -11105000.0}, "env_to_module_sum_episodes_length_out": 10.36823839457432, "episode_duration_sec_mean": 0.005337588205933571, "num_module_steps_sampled_lifetime": {"default_policy": -11105000.0}, "num_episodes": 250.0, "num_env_steps_sampled_lifetime_throughput": 3199.3951765643724}, "__all_modules__": {"learner_connector_sum_episodes_length_in": 5000.0, "learner_connector": {"connector_pipeline_timer": 0.17657782492929344, "timers": {"connectors": {"add_one_ts_to_episodes_and_truncate": 0.009175483308591163, "add_observations_from_episodes_to_batch": 0.0008937914355101701, "add_columns_from_episodes_to_train_batch": 0.042158922178862905, "add_time_dim_to_batch_and_zero_pad": 0.10531336604342657, "add_states_from_episodes_to_batch": 0.003542989984585428, "batch_individual_items": 0.015284254764696309, "numpy_to_tensor": 6.830506448493012e-05}}}, "learner_connector_sum_episodes_length_out": 5250.0}, "learners": {"default_policy": {"num_module_steps_trained": 5994, "curr_kl_coeff": 1.5409844422720198e-07, "num_module_steps_trained_lifetime": 119880, "num_trainable_parameters": 16595, "diff_num_grad_updates_vs_sampler_policy": 1.0, "weights_seq_no": 20.0, "use_intrinsic_rewards": 0.0, "total_loss": 0.20354360342025757, "vf_loss": 0.26387056708335876, "mean_kl_loss": 0.00010624810238368809, "vf_loss_unclipped": 37.68377685546875, "curr_entropy_coeff": 0.0015431216992, "policy_loss": -0.0010018839966505766, "entropy": 0.6630488038063049, "vf_explained_var": -0.000156402587890625, "module_train_batch_size_mean": 999.0, "num_module_steps_trained_lifetime_throughput": 605.2651567511249}, "intrinsic_reward_module": {"default_optimizer_learning_rate": 0.0002715581955, "num_module_steps_trained_lifetime": 119880, "num_trainable_parameters": 8266, "diff_num_grad_updates_vs_sampler_policy": 1.0, "total_loss": 0.0, "weights_seq_no": 20.0, "curr_entropy_coeff": 0.0015431216992, "module_train_batch_size_mean": 999.0, "num_module_steps_trained": 5994, "gradients_default_optimizer_global_norm": 0.0, "num_module_steps_trained_lifetime_throughput": 605.2695730923493}, "__all_modules__": {"num_env_steps_trained": 31500, "num_non_trainable_parameters": 0, "num_module_steps_trained": 11988, "num_env_steps_trained_lifetime": 630000, "num_module_steps_trained_lifetime": 239760, "num_trainable_parameters": 24861, "num_env_steps_trained_lifetime_throughput": 3180.8589429577205, "num_module_steps_trained_throughput": 19833914.662356965, "num_module_steps_trained_lifetime_throughput": 12400649.075584067}, "differentiable_learners": {"intrinsic_attention_ppo_learner": {"default_policy": {"use_intrinsic_rewards": 1.0, "vf_loss": 0.26388442516326904, "vf_loss_unclipped": 37.681514739990234, "policy_loss": -0.0009617048199288547, "num_module_steps_trained": 35964, "entropy": 0.6631923913955688, "vf_explained_var": 0.0013043880462646484, "module_train_batch_size_mean": 999.0, "num_module_steps_trained_lifetime": 719280, "total_loss": 0.2036101222038269, "diff_num_grad_updates_vs_sampler_policy": 101.0, "mean_kl_loss": 9.773913188837469e-05, "weights_seq_no": 120.0}, "__all_modules__": {"num_env_steps_trained": 189000, "num_module_steps_trained": 71928, "num_env_steps_trained_lifetime": 3780000, "num_module_steps_trained_lifetime": 1438560, "num_env_steps_trained_lifetime_throughput": 35920.34737483989}, "intrinsic_reward_module": {"num_module_steps_trained": 35964, "module_train_batch_size_mean": 999.0, "num_module_steps_trained_lifetime": 719280, "total_loss": 0.0, "diff_num_grad_updates_vs_sampler_policy": 101.0, "weights_seq_no": 120.0}}}, "IntrinsicAttentionMask": [[[0.333563894033432, 0.33311280608177185, 0.33332329988479614], [0.3338854908943176, 0.3328053653240204, 0.333309143781662], [0.3337353467941284, 0.33294886350631714, 0.33331578969955444]], [[0.33288198709487915, 0.3336298167705536, 0.33348822593688965], [0.3337981104850769, 0.3330281972885132, 0.3331736922264099], [0.3336247205734253, 0.3331420123577118, 0.3332332670688629]], [[0.3328327238559723, 0.33369123935699463, 0.3334760069847107], [0.33333730697631836, 0.3333304822444916, 0.33333221077919006], [0.33321088552474976, 0.33342084288597107, 0.3333682417869568]], [[0.33332520723342896, 0.3335515558719635, 0.33312323689460754], [0.3333338797092438, 0.3333185911178589, 0.33334752917289734], [0.333317369222641, 0.3337595760822296, 0.33292296528816223]], [[0.3333287239074707, 0.3333187997341156, 0.3333524763584137], [0.333326518535614, 0.33331188559532166, 0.33336156606674194], [0.33333393931388855, 0.3333353102207184, 0.3333306908607483]], [[0.3337322771549225, 0.3321525454521179, 0.3341151475906372], [0.3351401388645172, 0.3279615044593811, 0.3368983268737793], [0.3333888649940491, 0.33316922187805176, 0.33344194293022156]]]}, "num_training_step_calls_per_iteration": 1, "evaluation": {"env_runners": {"module_episode_returns_mean": {"default_policy": 0.05}, "num_env_steps_sampled_lifetime": 100400, "sample": 0.1291091835054162, "num_episodes": 20, "env_to_module_connector": {"timers": {"connectors": {"batch_individual_items": 1.2441644366311658e-05, "numpy_to_tensor": 1.2069278996993362e-05, "add_time_dim_to_batch_and_zero_pad": 7.054378428889851e-06, "add_states_from_episodes_to_batch": 2.731151184499679e-06, "add_observations_from_episodes_to_batch": 2.7412424909502883e-06}}, "connector_pipeline_timer": 5.927774906066406e-05}, "episode_return_min": -14.5, "num_agent_steps_sampled_lifetime": {"default_agent": 8000}, "episode_return_mean": 0.05, "module_to_env_connector": {"timers": {"connectors": {"remove_single_ts_time_rank_from_batch": 1.1852920688653367e-05, "un_batch_to_individual_items": 6.530418801782174e-06, "listify_data_for_vector_env": 1.0399464185002767e-05, "get_actions": 3.5525734333233716e-05, "tensor_to_numpy": 1.5173074914376946e-05, "normalize_and_clip_actions": 7.950699769006917e-06}}, "connector_pipeline_timer": 0.00011378804822493308}, "episode_duration_sec_mean": 0.00540948543464765, "num_env_steps_sampled": 400, "episode_return_max": 13.5, "env_to_module_sum_episodes_length_in": 10.368238394574323, "num_episodes_lifetime": 400, "env_to_module_sum_episodes_length_out": 10.368238394574323, "num_agent_steps_sampled": {"default_agent": 400}, "episode_len_mean": 20.0, "episode_len_min": 20, "agent_episode_returns_mean": {"default_agent": 0.05}, "num_module_steps_sampled_lifetime": {"default_policy": 8000}, "env_reset_timer": 0.0006905291829440059, "rlmodule_inference_timer": 3.060239316471449e-05, "num_module_steps_sampled": {"default_policy": 400}, "episode_len_max": 20, "env_step_timer": 1.3670554773266244e-05, "weights_seq_no": 20.0, "time_between_sampling": 11.260356256712303}, "num_healthy_workers": 1, "actor_manager_num_outstanding_async_reqs": 0, "num_remote_worker_restarts": 0}, "num_env_steps_sampled_lifetime": -11105000.0, "fault_tolerance": {"num_healthy_workers": 0, "num_remote_worker_restarts": 0}, "env_runner_group": {"actor_manager_num_outstanding_async_reqs": 0}, "done": true, "training_iteration": 20, "trial_id": "b7d85_00000", "date": "2025-08-11_18-04-07", "timestamp": 1754928247, "time_this_iter_s": 11.71773099899292, "time_total_s": 239.639080286026, "pid": 10036, "hostname": "Mac", "node_ip": "127.0.0.1", "config": {"exploration_config": {}, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 2, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "env": "Umbrella", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": false, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 0, "create_local_env_runner": true, "num_envs_per_env_runner": 1, "gym_env_vectorize_mode": "SYNC", "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "episodes_to_numpy": true, "max_requests_in_flight_per_env_runner": 1, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "merge_env_runner_states": "training_only", "broadcast_env_runner_states": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "complete_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "sampler_perf_stats_ema_coef": null, "_is_online": true, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": "auto", "num_aggregator_actors_per_learner": 0, "max_requests_in_flight_per_aggregator_actor": 3, "local_gpu_idx": 0, "max_requests_in_flight_per_learner": 3, "gamma": 1, "lr": 0.0002715581955, "grad_clip": 0.5, "grad_clip_by": "global_norm", "_train_batch_size_per_learner": 5000, "train_batch_size": 4000, "num_epochs": 1, "minibatch_size": 1000, "shuffle_batch_per_epoch": true, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "log_std_clip_param": 20.0, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "_disable_preprocessor_api": false, "_disable_action_flattening": false}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {"intrinsic_reward_coeff": 0.2795015916508}, "optimizer": {}, "_learner_class": "<class 'source.intrinsic_attention_ppo.learners.IntrinsicAttentionMetaLearner.IntrinsicAttentionMetaLearner'>", "callbacks_on_algorithm_init": null, "callbacks_on_env_runners_recreated": null, "callbacks_on_offline_eval_runners_recreated": null, "callbacks_on_checkpoint_loaded": null, "callbacks_on_environment_created": null, "callbacks_on_episode_created": null, "callbacks_on_episode_start": null, "callbacks_on_episode_step": null, "callbacks_on_episode_end": null, "callbacks_on_evaluate_start": null, "callbacks_on_evaluate_end": null, "callbacks_on_evaluate_offline_start": null, "callbacks_on_evaluate_offline_end": null, "callbacks_on_sample_end": null, "callbacks_on_train_result": null, "explore": true, "enable_rl_module_and_learner": true, "enable_env_runner_and_connector_v2": true, "_prior_exploration_config": {"type": "StochasticSampling"}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x155e4d8a0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "offline_data_class": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_read_batch_size": null, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "materialize_data": false, "materialize_mapped_data": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "ignore_final_observation": false, "prelearner_class": null, "prelearner_buffer_class": null, "prelearner_buffer_kwargs": {}, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_remaining_data": false, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": 1, "evaluation_duration": 20, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_auto_duration_min_env_steps_per_sample": 100, "evaluation_auto_duration_max_env_steps_per_sample": 2000, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 1, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "offline_evaluation_interval": null, "num_offline_eval_runners": 0, "offline_loss_for_module_fn": null, "offline_evaluation_duration": 1, "offline_evaluation_parallel_to_training": false, "offline_evaluation_timeout_s": 120.0, "num_cpus_per_offline_eval_runner": 1, "num_gpus_per_offline_eval_runner": 0, "custom_resources_per_offline_eval_runner": {}, "restart_failed_offline_eval_runners": true, "ignore_offline_eval_runner_failures": false, "max_num_offline_eval_runner_restarts": 1000, "offline_eval_runner_restore_timeout_s": 1800.0, "max_requests_in_flight_per_offline_eval_runner": 1, "validate_offline_eval_runners_after_construction": true, "offline_eval_runner_health_probe_timeout_s": 30.0, "offline_eval_rl_module_inference_only": false, "broadcast_offline_eval_runner_states": false, "offline_eval_batch_size_per_runner": 256, "dataset_num_iters_per_eval_runner": 1, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "log_gradients": false, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 10, "restart_failed_env_runners": true, "ignore_env_runner_failures": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30.0, "env_runner_restore_timeout_s": 1800.0, "_model_config": {}, "_rl_module_spec": "MultiRLModuleSpec(multi_rl_module_class=<class 'ray.rllib.core.rl_module.multi_rl_module.MultiRLModule'>, observation_space=None, action_space=None, inference_only=False, model_config=None, rl_module_specs={'default_policy': RLModuleSpec(module_class=<class 'source.intrinsic_attention_ppo.rl_modules.DifferentiablePPOModule.DifferentiablePPOModule'>, observation_space=None, action_space=None, inference_only=False, learner_only=False, model_config={'vf_share_layers': True, 'embedding_dim': 62, 'max_seq_len': 3, 'policy_head_hidden_sizes': [32], 'value_head_hidden_sizes': [101], 'embedding_hidden_sizes': [121]}, catalog_class=None, load_state_path=None, model_config_dict=None), 'intrinsic_reward_module': RLModuleSpec(module_class=<class 'source.intrinsic_attention_ppo.rl_modules.IntrinsicAttentionModule.IntrinsicAttentionModule'>, observation_space=None, action_space=None, inference_only=False, learner_only=True, model_config={'intrinsic_reward_network': {'encoder_hidden_sizes': [], 'encoding_dim': 1, 'num_heads': 1, 'head_hidden_sizes': None, 'layers': [{'type': 'attention'}]}, 'extrinsic_value_hidden_layers': [127, 60], 'vf_share_layers': True, 'max_seq_len': 3}, catalog_class=None, load_state_path=None, model_config_dict=None)}, load_state_path=None, modules_to_load=None, module_specs={'default_policy': RLModuleSpec(module_class=<class 'source.intrinsic_attention_ppo.rl_modules.DifferentiablePPOModule.DifferentiablePPOModule'>, observation_space=None, action_space=None, inference_only=False, learner_only=False, model_config={'vf_share_layers': True, 'embedding_dim': 62, 'max_seq_len': 3, 'policy_head_hidden_sizes': [32], 'value_head_hidden_sizes': [101], 'embedding_hidden_sizes': [121]}, catalog_class=None, load_state_path=None, model_config_dict=None), 'intrinsic_reward_module': RLModuleSpec(module_class=<class 'source.intrinsic_attention_ppo.rl_modules.IntrinsicAttentionModule.IntrinsicAttentionModule'>, observation_space=None, action_space=None, inference_only=False, learner_only=True, model_config={'intrinsic_reward_network': {'encoder_hidden_sizes': [], 'encoding_dim': 1, 'num_heads': 1, 'head_hidden_sizes': None, 'layers': [{'type': 'attention'}]}, 'extrinsic_value_hidden_layers': [127, 60], 'vf_share_layers': True, 'max_seq_len': 3}, catalog_class=None, load_state_path=None, model_config_dict=None)})", "algorithm_config_overrides_per_module": {"intrinsic_reward_module": {"lr": 0.0002715581955}}, "_per_module_overrides": {}, "_validate_config": true, "_use_msgpack_checkpoints": false, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "env_task_fn": -1, "enable_connectors": -1, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.161583927863, "kl_target": 0.0201019014258, "vf_loss_coeff": 0.7790510010087, "entropy_coeff": 0.0015431216992, "clip_param": 0.2459212356676, "vf_clip_param": 0.3769744131561, "entropy_coeff_schedule": null, "lr_schedule": null, "sgd_minibatch_size": -1, "vf_share_layers": -1, "differentiable_learner_configs": ["DifferentiableLearnerConfig(learner_class=<class 'source.intrinsic_attention_ppo.learners.IntrinsicAttentionPPOLearner.IntrinsicAttentionPPOLearner'>, learner_connector=None, add_default_connectors_to_learner_pipeline=True, is_multi_agent=False, policies_to_update=['default_policy'], lr=0.0060984166342, num_total_minibatches=0, num_epochs=1, minibatch_size=1000, shuffle_batch_per_epoch=True)"], "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9485408017724, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.callbacks.callbacks.RLlibCallback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 239.639080286026, "iterations_since_restore": 20, "perf": {"cpu_util_percent": 39.4875, "ram_util_percent": 82.3375}}
