{"timers": {"training_iteration": 10.301312624942511, "restore_env_runners": 1.1582975275814533e-05, "training_step": 10.30115629103966, "env_runner_sampling_timer": 1.6619597499957308, "learner_update_timer": 8.449358833022416, "synch_weights": 0.00133050000295043}, "env_runners": {"episode_duration_sec_mean": 0.005762449366971852, "env_to_module_connector": {"timers": {"connectors": {"numpy_to_tensor": 1.3488196084242385e-05, "add_observations_from_episodes_to_batch": 2.9885754423937595e-06, "batch_individual_items": 1.3156626048694796e-05, "add_time_dim_to_batch_and_zero_pad": 7.475802436735952e-06, "add_states_from_episodes_to_batch": 2.8339307550607093e-06}}, "connector_pipeline_timer": 6.419323626362454e-05}, "num_env_steps_sampled": 5000.0, "episode_return_min": -11.5, "module_to_env_connector": {"timers": {"connectors": {"normalize_and_clip_actions": 1.027347891574099e-05, "un_batch_to_individual_items": 6.827891981266881e-06, "get_actions": 4.519441443520013e-05, "remove_single_ts_time_rank_from_batch": 1.2367987249071285e-05, "listify_data_for_vector_env": 1.0896237452586238e-05, "tensor_to_numpy": 1.5719985729419815e-05}}, "connector_pipeline_timer": 0.00012865094599546253}, "env_reset_timer": 8.539938965667448e-05, "sample": 0.006666630864386927, "num_episodes_lifetime": 31375.0, "env_to_module_sum_episodes_length_out": 10.191744832559449, "env_step_timer": 1.493984347496012e-05, "num_module_steps_sampled_lifetime": {"default_policy": 627500.0}, "weights_seq_no": 0.0, "module_episode_returns_mean": {"default_policy": -0.7800000000000001}, "env_to_module_sum_episodes_length_in": 10.191744832559449, "episode_len_mean": 20.0, "agent_episode_returns_mean": {"default_agent": -0.7800000000000001}, "time_between_sampling": 0.0005235130512771529, "num_module_steps_sampled": {"default_policy": 5000.0}, "episode_return_max": 8.5, "episode_len_min": 20, "episode_len_max": 20, "rlmodule_inference_timer": 5.6061614894879694e-05, "num_agent_steps_sampled": {"default_agent": 5000.0}, "num_episodes": 250.0, "num_env_steps_sampled_lifetime": 627500.0, "num_agent_steps_sampled_lifetime": {"default_agent": 627500.0}, "episode_return_mean": -0.7800000000000001, "num_env_steps_sampled_lifetime_throughput": 2997.1144455118756}, "__all_modules__": {"learner_connector_sum_episodes_length_in": 5000, "learner_connector": {"connector_pipeline_timer": 0.15243533405009657, "timers": {"connectors": {"add_one_ts_to_episodes_and_truncate": 0.008807624923065305, "add_observations_from_episodes_to_batch": 0.0008096670499071479, "add_columns_from_episodes_to_train_batch": 0.041083083022385836, "add_time_dim_to_batch_and_zero_pad": 0.09024483303073794, "add_states_from_episodes_to_batch": 0.003611583961173892, "batch_individual_items": 0.00764391606207937, "numpy_to_tensor": 7.91249331086874e-05}}}, "learner_connector_sum_episodes_length_out": 5250}, "learners": {"default_policy": {"num_module_steps_trained_lifetime": 5985, "weights_seq_no": 1.0, "entropy": 0.6924129724502563, "num_module_steps_trained": 5985, "vf_loss": 0.3205900490283966, "mean_kl_loss": 1.2421804058249108e-05, "num_trainable_parameters": 16595, "curr_entropy_coeff": 0.0015431216992, "module_train_batch_size_mean": 998.9117791197002, "vf_explained_var": -0.0033043622970581055, "total_loss": 0.24874383211135864, "vf_loss_unclipped": 41.59443664550781, "policy_loss": 5.4303101933328435e-05, "use_intrinsic_rewards": 0.0, "diff_num_grad_updates_vs_sampler_policy": 1.0, "curr_kl_coeff": 0.08079196512699127, "num_module_steps_trained_lifetime_throughput": 648.8356714485517}, "intrinsic_reward_module": {"total_loss": 0.0, "gradients_default_optimizer_global_norm": 0.0, "num_module_steps_trained_lifetime": 5985, "num_module_steps_trained": 5985, "weights_seq_no": 1.0, "num_trainable_parameters": 8266, "curr_entropy_coeff": 0.0015431216992, "module_train_batch_size_mean": 998.9117791197002, "default_optimizer_learning_rate": 0.0002715581955, "diff_num_grad_updates_vs_sampler_policy": 1.0, "num_module_steps_trained_lifetime_throughput": 648.8453667567825}, "differentiable_learners": {"intrinsic_attention_ppo_learner": {"default_policy": {"num_module_steps_trained": 35910, "weights_seq_no": 6.0, "entropy": 0.6924077272415161, "vf_loss": 0.321176141500473, "mean_kl_loss": 1.3089919775666203e-05, "module_train_batch_size_mean": 998.5423314844973, "vf_explained_var": 0.0015918612480163574, "diff_num_grad_updates_vs_sampler_policy": 6.0, "total_loss": 0.24920344352722168, "vf_loss_unclipped": 41.35555648803711, "policy_loss": 5.720637636841275e-05, "use_intrinsic_rewards": 1.0, "num_module_steps_trained_lifetime": 35910}, "intrinsic_reward_module": {"module_train_batch_size_mean": 998.5423314844973, "diff_num_grad_updates_vs_sampler_policy": 6.0, "total_loss": 0.0, "num_module_steps_trained_lifetime": 35910, "num_module_steps_trained": 35910, "weights_seq_no": 6.0}, "__all_modules__": {"num_module_steps_trained_lifetime": 71820, "num_module_steps_trained": 71820, "num_env_steps_trained": 216000, "num_env_steps_trained_lifetime": 216000, "num_env_steps_trained_lifetime_throughput": 63023.33401250141}}}, "__all_modules__": {"num_module_steps_trained_lifetime": 11970, "num_module_steps_trained": 11970, "num_trainable_parameters": 24861, "num_env_steps_trained": 36000, "num_env_steps_trained_lifetime": 36000, "num_non_trainable_parameters": 0, "num_env_steps_trained_lifetime_throughput": 3907.6063059172457, "num_module_steps_trained_throughput": 29711763.285240993, "num_module_steps_trained_lifetime_throughput": 11544475.63466925}, "IntrinsicAttentionMask": [[[0.1666092723608017, 0.165935680270195, 0.1668335348367691, 0.16796796023845673, 0.16627085208892822, 0.16638271510601044], [0.16654439270496368, 0.1651458591222763, 0.16701139509677887, 0.16938404738903046, 0.1658409833908081, 0.16607333719730377], [0.16663016378879547, 0.16619814932346344, 0.16677387058734894, 0.16749970614910126, 0.16641318798065186, 0.16648492217063904], [0.1667306125164032, 0.16752174496650696, 0.16646873950958252, 0.16515573859214783, 0.16712722182273865, 0.16699592769145966], [0.1665770709514618, 0.16553916037082672, 0.1669231653213501, 0.16867759823799133, 0.1660553216934204, 0.16622772812843323], [0.16658779978752136, 0.16567030549049377, 0.1668935865163803, 0.16844260692596436, 0.16612666845321655, 0.16627906262874603]], [[0.1651778668165207, 0.16769522428512573, 0.1645602583885193, 0.167068213224411, 0.1718602478504181, 0.1636381894350052], [0.16595694422721863, 0.16716426610946655, 0.16565927863121033, 0.16686443984508514, 0.1691412776708603, 0.16521377861499786], [0.16498365998268127, 0.1678251326084137, 0.16428740322589874, 0.16711688041687012, 0.17253847420215607, 0.16324850916862488], [0.16576474905014038, 0.16729672253131866, 0.16538751125335693, 0.16691598296165466, 0.16981177031993866, 0.1648232489824295], [0.16720318794250488, 0.16628152132034302, 0.16743223369121552, 0.16650930047035217, 0.1647973507642746, 0.16777640581130981], [0.16469143331050873, 0.16801878809928894, 0.16387757658958435, 0.16718849539756775, 0.17355938255786896, 0.16266433894634247]], [[0.16667398810386658, 0.1673898696899414, 0.16618192195892334, 0.1661115437746048, 0.16717728972434998, 0.16646535694599152], [0.16664916276931763, 0.16530801355838776, 0.16758066415786743, 0.16771455109119415, 0.16570451855659485, 0.16704314947128296], [0.16668449342250824, 0.16883458197116852, 0.16521726548671722, 0.16500812768936157, 0.1681942343711853, 0.16606134176254272], [0.166685551404953, 0.16904211044311523, 0.16507907211780548, 0.16485020518302917, 0.16833995282649994, 0.16600307822227478], [0.1666577011346817, 0.16592372953891754, 0.16716592013835907, 0.16723886132240295, 0.16614100337028503, 0.1668728142976761], [0.16667909920215607, 0.16800105571746826, 0.16577322781085968, 0.1656438559293747, 0.16760802268981934, 0.16629473865032196]], [[0.16474315524101257, 0.16415594518184662, 0.163570836186409, 0.1683560460805893, 0.1720159947872162, 0.16715802252292633], [0.16467760503292084, 0.16407081484794617, 0.16346625983715057, 0.16841258108615875, 0.17219899594783783, 0.16717377305030823], [0.16461201012134552, 0.16398563981056213, 0.16336168348789215, 0.16846908628940582, 0.17238213121891022, 0.16718947887420654], [0.165140762925148, 0.16467295587062836, 0.16420644521713257, 0.16801166534423828, 0.17090708017349243, 0.16706110537052155], [0.16553378105163574, 0.16518497467041016, 0.16483689844608307, 0.16766880452632904, 0.16981260478496552, 0.16696293652057648], [0.165010005235672, 0.1645027995109558, 0.16399717330932617, 0.1681251972913742, 0.17127157747745514, 0.16709323227405548]], [[0.1669473499059677, 0.16627240180969238, 0.16819563508033752, 0.16728456318378448, 0.16559433937072754, 0.16570577025413513], [0.1672457754611969, 0.16584135591983795, 0.1698593944311142, 0.16794972121715546, 0.1644366830587387, 0.1646670699119568], [0.16638463735580444, 0.16705253720283508, 0.16516341269016266, 0.1660529524087906, 0.1677289754152298, 0.16761744022369385], [0.1667967140674591, 0.16648532450199127, 0.16737081110477448, 0.1669520139694214, 0.1661718189716339, 0.16622337698936462], [0.16754133999347687, 0.16540178656578064, 0.17154815793037415, 0.1686173379421234, 0.16327129304409027, 0.16362006962299347], [0.16749307513237, 0.16547447443008423, 0.1712694615125656, 0.1685076802968979, 0.16346295177936554, 0.16379235684871674]], [[0.1646878868341446, 0.16410088539123535, 0.16351597011089325, 0.16829955577850342, 0.17762193083763123, 0.16177372634410858], [0.16461852192878723, 0.16401195526123047, 0.1634076088666916, 0.1683521717786789, 0.1780017614364624, 0.16160793602466583], [0.16454899311065674, 0.16392289102077484, 0.16329915821552277, 0.16840459406375885, 0.17838221788406372, 0.16144217550754547], [0.1651059240102768, 0.1646381914615631, 0.16417180001735687, 0.16797621548175812, 0.175327330827713, 0.1627805233001709], [0.1661193072795868, 0.16595108807086945, 0.16578301787376404, 0.1671450436115265, 0.16972166299819946, 0.16527986526489258], [0.16433943808078766, 0.16365481913089752, 0.1629730463027954, 0.16856080293655396, 0.1795271933078766, 0.16094471514225006]]]}, "num_training_step_calls_per_iteration": 1, "num_env_steps_sampled_lifetime": 627500.0, "evaluation": {"env_runners": {"env_to_module_connector": {"timers": {"connectors": {"add_states_from_episodes_to_batch": 2.7961133604625016e-06, "numpy_to_tensor": 1.2597824172852068e-05, "add_time_dim_to_batch_and_zero_pad": 7.064063618595381e-06, "add_observations_from_episodes_to_batch": 2.834169731649041e-06, "batch_individual_items": 1.2345639887525941e-05}}, "connector_pipeline_timer": 6.200265825963077e-05}, "module_to_env_connector": {"timers": {"connectors": {"tensor_to_numpy": 1.6293120294354225e-05, "remove_single_ts_time_rank_from_batch": 1.260149419739771e-05, "un_batch_to_individual_items": 6.694783868741256e-06, "normalize_and_clip_actions": 8.882511718235564e-06, "get_actions": 4.352425292280496e-05, "listify_data_for_vector_env": 1.0400413173794256e-05}}, "connector_pipeline_timer": 0.0001247853219689381}, "num_env_steps_sampled": 400, "num_agent_steps_sampled_lifetime": {"default_agent": 400}, "env_step_timer": 1.4898203555015952e-05, "episode_len_max": 20, "num_episodes_lifetime": 20, "sample": 0.11565458297263831, "weights_seq_no": 1.0, "env_to_module_sum_episodes_length_in": 10.216013141322508, "module_episode_returns_mean": {"default_policy": -2.25}, "num_env_steps_sampled_lifetime": 5400, "agent_episode_returns_mean": {"default_agent": -2.25}, "episode_duration_sec_mean": 0.005273547937395051, "episode_return_mean": -2.25, "episode_return_min": -14.5, "env_reset_timer": 0.00046483404003083706, "episode_len_mean": 20.0, "episode_return_max": 14.5, "rlmodule_inference_timer": 3.425957734471663e-05, "episode_len_min": 20, "num_episodes": 20, "env_to_module_sum_episodes_length_out": 10.216013141322508, "num_module_steps_sampled_lifetime": {"default_policy": 400}, "num_module_steps_sampled": {"default_policy": 400}, "num_agent_steps_sampled": {"default_agent": 400}}, "num_healthy_workers": 1, "actor_manager_num_outstanding_async_reqs": 0, "num_remote_worker_restarts": 0}, "fault_tolerance": {"num_healthy_workers": 0, "num_remote_worker_restarts": 0}, "env_runner_group": {"actor_manager_num_outstanding_async_reqs": 0}, "done": false, "training_iteration": 1, "trial_id": "b5096_00000", "date": "2025-08-11_18-44-33", "timestamp": 1754930673, "time_this_iter_s": 10.42839503288269, "time_total_s": 10.42839503288269, "pid": 11702, "hostname": "Mac", "node_ip": "127.0.0.1", "config": {"exploration_config": {}, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 2, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "env": "Umbrella", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": false, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 0, "create_local_env_runner": true, "num_envs_per_env_runner": 1, "gym_env_vectorize_mode": "SYNC", "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "episodes_to_numpy": true, "max_requests_in_flight_per_env_runner": 1, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "merge_env_runner_states": "training_only", "broadcast_env_runner_states": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "complete_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "sampler_perf_stats_ema_coef": null, "_is_online": true, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": "auto", "num_aggregator_actors_per_learner": 0, "max_requests_in_flight_per_aggregator_actor": 3, "local_gpu_idx": 0, "max_requests_in_flight_per_learner": 3, "gamma": 1, "lr": 0.0002715581955, "grad_clip": 0.5, "grad_clip_by": "global_norm", "_train_batch_size_per_learner": 5000, "train_batch_size": 4000, "num_epochs": 1, "minibatch_size": 1000, "shuffle_batch_per_epoch": true, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "log_std_clip_param": 20.0, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "_disable_preprocessor_api": false, "_disable_action_flattening": false}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {"intrinsic_reward_coeff": 0.2795015916508}, "optimizer": {}, "_learner_class": "<class 'source.intrinsic_attention_ppo.learners.IntrinsicAttentionMetaLearner.IntrinsicAttentionMetaLearner'>", "callbacks_on_algorithm_init": null, "callbacks_on_env_runners_recreated": null, "callbacks_on_offline_eval_runners_recreated": null, "callbacks_on_checkpoint_loaded": null, "callbacks_on_environment_created": null, "callbacks_on_episode_created": null, "callbacks_on_episode_start": null, "callbacks_on_episode_step": null, "callbacks_on_episode_end": null, "callbacks_on_evaluate_start": null, "callbacks_on_evaluate_end": null, "callbacks_on_evaluate_offline_start": null, "callbacks_on_evaluate_offline_end": null, "callbacks_on_sample_end": null, "callbacks_on_train_result": null, "explore": true, "enable_rl_module_and_learner": true, "enable_env_runner_and_connector_v2": true, "_prior_exploration_config": {"type": "StochasticSampling"}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x3866e5760>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "offline_data_class": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_read_batch_size": null, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "materialize_data": false, "materialize_mapped_data": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "ignore_final_observation": false, "prelearner_class": null, "prelearner_buffer_class": null, "prelearner_buffer_kwargs": {}, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_remaining_data": false, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": 1, "evaluation_duration": 20, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_auto_duration_min_env_steps_per_sample": 100, "evaluation_auto_duration_max_env_steps_per_sample": 2000, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 1, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "offline_evaluation_interval": null, "num_offline_eval_runners": 0, "offline_loss_for_module_fn": null, "offline_evaluation_duration": 1, "offline_evaluation_parallel_to_training": false, "offline_evaluation_timeout_s": 120.0, "num_cpus_per_offline_eval_runner": 1, "num_gpus_per_offline_eval_runner": 0, "custom_resources_per_offline_eval_runner": {}, "restart_failed_offline_eval_runners": true, "ignore_offline_eval_runner_failures": false, "max_num_offline_eval_runner_restarts": 1000, "offline_eval_runner_restore_timeout_s": 1800.0, "max_requests_in_flight_per_offline_eval_runner": 1, "validate_offline_eval_runners_after_construction": true, "offline_eval_runner_health_probe_timeout_s": 30.0, "offline_eval_rl_module_inference_only": false, "broadcast_offline_eval_runner_states": false, "offline_eval_batch_size_per_runner": 256, "dataset_num_iters_per_eval_runner": 1, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "log_gradients": false, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 8, "restart_failed_env_runners": true, "ignore_env_runner_failures": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30.0, "env_runner_restore_timeout_s": 1800.0, "_model_config": {}, "_rl_module_spec": "MultiRLModuleSpec(multi_rl_module_class=<class 'ray.rllib.core.rl_module.multi_rl_module.MultiRLModule'>, observation_space=None, action_space=None, inference_only=False, model_config=None, rl_module_specs={'default_policy': RLModuleSpec(module_class=<class 'source.intrinsic_attention_ppo.rl_modules.DifferentiablePPOModule.DifferentiablePPOModule'>, observation_space=None, action_space=None, inference_only=False, learner_only=False, model_config={'vf_share_layers': True, 'embedding_dim': 62, 'max_seq_len': 6, 'policy_head_hidden_sizes': [32], 'value_head_hidden_sizes': [101], 'embedding_hidden_sizes': [121]}, catalog_class=None, load_state_path=None, model_config_dict=None), 'intrinsic_reward_module': RLModuleSpec(module_class=<class 'source.intrinsic_attention_ppo.rl_modules.IntrinsicAttentionModule.IntrinsicAttentionModule'>, observation_space=None, action_space=None, inference_only=False, learner_only=True, model_config={'intrinsic_reward_network': {'encoder_hidden_sizes': [], 'encoding_dim': 1, 'num_heads': 1, 'head_hidden_sizes': None, 'layers': [{'type': 'attention'}]}, 'extrinsic_value_hidden_layers': [127, 60], 'vf_share_layers': True, 'max_seq_len': 6}, catalog_class=None, load_state_path=None, model_config_dict=None)}, load_state_path=None, modules_to_load=None, module_specs={'default_policy': RLModuleSpec(module_class=<class 'source.intrinsic_attention_ppo.rl_modules.DifferentiablePPOModule.DifferentiablePPOModule'>, observation_space=None, action_space=None, inference_only=False, learner_only=False, model_config={'vf_share_layers': True, 'embedding_dim': 62, 'max_seq_len': 6, 'policy_head_hidden_sizes': [32], 'value_head_hidden_sizes': [101], 'embedding_hidden_sizes': [121]}, catalog_class=None, load_state_path=None, model_config_dict=None), 'intrinsic_reward_module': RLModuleSpec(module_class=<class 'source.intrinsic_attention_ppo.rl_modules.IntrinsicAttentionModule.IntrinsicAttentionModule'>, observation_space=None, action_space=None, inference_only=False, learner_only=True, model_config={'intrinsic_reward_network': {'encoder_hidden_sizes': [], 'encoding_dim': 1, 'num_heads': 1, 'head_hidden_sizes': None, 'layers': [{'type': 'attention'}]}, 'extrinsic_value_hidden_layers': [127, 60], 'vf_share_layers': True, 'max_seq_len': 6}, catalog_class=None, load_state_path=None, model_config_dict=None)})", "algorithm_config_overrides_per_module": {"intrinsic_reward_module": {"lr": 0.0002715581955}}, "_per_module_overrides": {}, "_validate_config": true, "_use_msgpack_checkpoints": false, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "env_task_fn": -1, "enable_connectors": -1, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.161583927863, "kl_target": 0.0201019014258, "vf_loss_coeff": 0.7790510010087, "entropy_coeff": 0.0015431216992, "clip_param": 0.2459212356676, "vf_clip_param": 0.3769744131561, "entropy_coeff_schedule": null, "lr_schedule": null, "sgd_minibatch_size": -1, "vf_share_layers": -1, "differentiable_learner_configs": ["DifferentiableLearnerConfig(learner_class=<class 'source.intrinsic_attention_ppo.learners.IntrinsicAttentionPPOLearner.IntrinsicAttentionPPOLearner'>, learner_connector=None, add_default_connectors_to_learner_pipeline=True, is_multi_agent=False, policies_to_update=['default_policy'], lr=0.0060984166342, num_total_minibatches=0, num_epochs=1, minibatch_size=1000, shuffle_batch_per_epoch=True)"], "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9485408017724, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.callbacks.callbacks.RLlibCallback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 10.42839503288269, "iterations_since_restore": 1, "perf": {"cpu_util_percent": 39.46666666666667, "ram_util_percent": 80.07999999999998}}
{"timers": {"training_iteration": 10.295331330363405, "restore_env_runners": 1.1539225233718753e-05, "training_step": 10.295174215629231, "env_runner_sampling_timer": 1.6618201291665902, "learner_update_timer": 8.443398456771392, "synch_weights": 0.0013264954218175262, "restore_eval_env_runners": 3.216706681996584e-05, "evaluation_iteration": 0.12480137508828193, "synch_eval_env_connectors": 0.0001562919933348894, "synch_env_connectors": 4.375004209578037e-06}, "env_runners": {"episode_duration_sec_mean": 0.005315306029748171, "env_to_module_connector": {"timers": {"connectors": {"numpy_to_tensor": 1.2733402737634701e-05, "add_observations_from_episodes_to_batch": 2.8324947812607544e-06, "batch_individual_items": 1.2626969387881979e-05, "add_time_dim_to_batch_and_zero_pad": 7.079216556156333e-06, "add_states_from_episodes_to_batch": 2.73429913176621e-06}}, "connector_pipeline_timer": 6.025713300044811e-05}, "num_env_steps_sampled": 5000.0, "episode_return_min": -11.5, "module_to_env_connector": {"timers": {"connectors": {"normalize_and_clip_actions": 8.104417964818475e-06, "un_batch_to_individual_items": 6.560343003714641e-06, "get_actions": 3.9954256671782065e-05, "remove_single_ts_time_rank_from_batch": 1.195119113216508e-05, "listify_data_for_vector_env": 1.0556652928159688e-05, "tensor_to_numpy": 1.5294327056384728e-05}}, "connector_pipeline_timer": 0.00011896373120321231}, "env_reset_timer": 4.426889612522793e-05, "sample": 0.005945018343358175, "num_episodes_lifetime": 500.0, "env_to_module_sum_episodes_length_out": 10.36823839457432, "env_step_timer": 1.402674775470264e-05, "num_module_steps_sampled_lifetime": {"default_policy": 10000.0}, "weights_seq_no": 1.0, "module_episode_returns_mean": {"default_policy": -0.6199999999999999}, "env_to_module_sum_episodes_length_in": 10.36823839457432, "episode_len_mean": 20.0, "agent_episode_returns_mean": {"default_agent": -0.6199999999999999}, "time_between_sampling": 0.032979991639923566, "num_module_steps_sampled": {"default_policy": 5000.0}, "episode_return_max": 8.5, "episode_len_min": 20, "episode_len_max": 20, "rlmodule_inference_timer": 3.1690754235732406e-05, "num_agent_steps_sampled": {"default_agent": 5000.0}, "num_episodes": 250.0, "num_env_steps_sampled_lifetime": 10000.0, "num_agent_steps_sampled_lifetime": {"default_agent": 10000.0}, "episode_return_mean": -0.6199999999999999, "num_env_steps_sampled_lifetime_throughput": 3229.0089480552124}, "__all_modules__": {"learner_connector_sum_episodes_length_in": 5000.0, "learner_connector": {"connector_pipeline_timer": 0.1524367815500591, "timers": {"connectors": {"add_one_ts_to_episodes_and_truncate": 0.008806171173928306, "add_observations_from_episodes_to_batch": 0.0008098553796298802, "add_columns_from_episodes_to_train_batch": 0.04108684469247237, "add_time_dim_to_batch_and_zero_pad": 0.0902448651206214, "add_states_from_episodes_to_batch": 0.003612240211805329, "batch_individual_items": 0.007642876900499687, "numpy_to_tensor": 7.895285380072891e-05}}}, "learner_connector_sum_episodes_length_out": 5250.0}, "learners": {"default_policy": {"num_module_steps_trained_lifetime": 11970, "weights_seq_no": 2.0, "entropy": 0.6924245357513428, "num_module_steps_trained": 5985, "vf_loss": 0.32066428661346436, "mean_kl_loss": 6.358316113619367e-07, "num_trainable_parameters": 16595, "curr_entropy_coeff": 0.0015431216992, "module_train_batch_size_mean": 998.828720912135, "vf_explained_var": -0.004081368446350098, "total_loss": 0.24871297180652618, "vf_loss_unclipped": 42.25907516479492, "policy_loss": -3.241386002628133e-05, "use_intrinsic_rewards": 0.0, "diff_num_grad_updates_vs_sampler_policy": 1.0, "curr_kl_coeff": 0.040395982563495636, "num_module_steps_trained_lifetime_throughput": 649.5855152984951}, "intrinsic_reward_module": {"total_loss": 0.0, "gradients_default_optimizer_global_norm": 0.0, "num_module_steps_trained_lifetime": 11970, "num_module_steps_trained": 5985, "weights_seq_no": 2.0, "num_trainable_parameters": 8266, "curr_entropy_coeff": 0.0015431216992, "module_train_batch_size_mean": 998.828720912135, "default_optimizer_learning_rate": 0.0002715581955, "diff_num_grad_updates_vs_sampler_policy": 1.0, "num_module_steps_trained_lifetime_throughput": 649.5950645999853}, "differentiable_learners": {"intrinsic_attention_ppo_learner": {"default_policy": {"num_module_steps_trained": 35910, "weights_seq_no": 12.0, "entropy": 0.6924236416816711, "vf_loss": 0.3210189640522003, "mean_kl_loss": 6.518777126984787e-07, "module_train_batch_size_mean": 998.2236050808158, "vf_explained_var": 0.0016205906867980957, "diff_num_grad_updates_vs_sampler_policy": 11.0, "total_loss": 0.2489902228116989, "vf_loss_unclipped": 42.098289489746094, "policy_loss": -3.155701415380463e-05, "use_intrinsic_rewards": 1.0, "num_module_steps_trained_lifetime": 71820}, "intrinsic_reward_module": {"module_train_batch_size_mean": 998.2236050808158, "diff_num_grad_updates_vs_sampler_policy": 11.0, "total_loss": 0.0, "num_module_steps_trained_lifetime": 71820, "num_module_steps_trained": 35910, "weights_seq_no": 12.0}, "__all_modules__": {"num_module_steps_trained_lifetime": 143640, "num_module_steps_trained": 71820, "num_env_steps_trained": 216000, "num_env_steps_trained_lifetime": 432000, "num_env_steps_trained_lifetime_throughput": 62676.10035433454}}}, "__all_modules__": {"num_module_steps_trained_lifetime": 23940, "num_module_steps_trained": 11970, "num_trainable_parameters": 24861, "num_env_steps_trained": 36000, "num_env_steps_trained_lifetime": 72000, "num_non_trainable_parameters": 0, "num_env_steps_trained_lifetime_throughput": 3912.062512947068, "num_module_steps_trained_throughput": 29300175.76601755, "num_module_steps_trained_lifetime_throughput": 11557728.741213968}, "IntrinsicAttentionMask": [[[0.16694676876068115, 0.1652599722146988, 0.16717149317264557, 0.16830821335315704, 0.16559377312660217, 0.16671976447105408], [0.1676774024963379, 0.16147533059120178, 0.1685166358947754, 0.1728087216615677, 0.16268913447856903, 0.1668327897787094], [0.16684682667255402, 0.16576455533504486, 0.1669907122850418, 0.16771750152111053, 0.1659790277481079, 0.16670140624046326], [0.1663321703672409, 0.16831767559051514, 0.16607092320919037, 0.16476106643676758, 0.1679212749004364, 0.16659684479236603], [0.16753560304641724, 0.16222387552261353, 0.1682521402835846, 0.17190872132778168, 0.16326573491096497, 0.1668139398097992], [0.16704711318016052, 0.1647503823041916, 0.16735373437404633, 0.1689070165157318, 0.1652042120695114, 0.16673754155635834]], [[0.1646878868341446, 0.16410088539123535, 0.16351597011089325, 0.16829955577850342, 0.17762190103530884, 0.1617737114429474], [0.16461853682994843, 0.16401197016239166, 0.16340763866901398, 0.1683521717786789, 0.1780017614364624, 0.16160796582698822], [0.16454899311065674, 0.16392287611961365, 0.16329915821552277, 0.16840459406375885, 0.17838218808174133, 0.16144217550754547], [0.1651059091091156, 0.1646381914615631, 0.16417178511619568, 0.16797620058059692, 0.17532730102539062, 0.1627805083990097], [0.16611932218074799, 0.16595108807086945, 0.16578303277492523, 0.16714505851268768, 0.16972167789936066, 0.16527988016605377], [0.16433943808078766, 0.16365480422973633, 0.1629730463027954, 0.16856080293655396, 0.1795271635055542, 0.16094471514225006]], [[0.1667804718017578, 0.1668541580438614, 0.1662880927324295, 0.16557994484901428, 0.16728408634662628, 0.16721324622631073], [0.1667468398809433, 0.16679860651493073, 0.16640080511569977, 0.16590259969234467, 0.1671004593372345, 0.16705073416233063], [0.16700108349323273, 0.16722184419631958, 0.16553106904029846, 0.16343195736408234, 0.16851365566253662, 0.1683003306388855], [0.16730575263500214, 0.16773967444896698, 0.16443036496639252, 0.16036680340766907, 0.17028988897800446, 0.16986747086048126], [0.16654738783836365, 0.16647164523601532, 0.16705526411533356, 0.16779108345508575, 0.16603104770183563, 0.16610349714756012], [0.16658063232898712, 0.16652584075927734, 0.16694779694080353, 0.16747920215129852, 0.16620703041553497, 0.16625946760177612]], [[0.16563230752944946, 0.1650419384241104, 0.1644536852836609, 0.1638675034046173, 0.1729443371295929, 0.16806021332740784], [0.16559645533561707, 0.1649862676858902, 0.164378359913826, 0.16377267241477966, 0.17315974831581116, 0.1681065559387207], [0.1655605286359787, 0.1649305671453476, 0.1643030047416687, 0.16367782652378082, 0.17337535321712494, 0.1681528389453888], [0.16552451252937317, 0.16487477719783783, 0.16422757506370544, 0.1635829210281372, 0.17359112203121185, 0.16819903254508972], [0.16606174409389496, 0.16571182012557983, 0.1653626412153244, 0.16501417756080627, 0.1703542023897171, 0.167495459318161], [0.16577793657779694, 0.16526836156845093, 0.16476038098335266, 0.16425396502017975, 0.17206859588623047, 0.16787086427211761]], [[0.16677974164485931, 0.1661054790019989, 0.16700424253940582, 0.16711661219596863, 0.16644097864627838, 0.16655297577381134], [0.1669013351202011, 0.16549983620643616, 0.16736933588981628, 0.16760383546352386, 0.16619643568992615, 0.1664292961359024], [0.16673921048641205, 0.16630689799785614, 0.16688300669193268, 0.16695494949817657, 0.1665220856666565, 0.16659387946128845], [0.16671890020370483, 0.16640765964984894, 0.1668223738670349, 0.16687414050102234, 0.16656261682510376, 0.16661429405212402], [0.16684085130691528, 0.16580131649971008, 0.16718748211860657, 0.1673610657453537, 0.16631829738616943, 0.16649097204208374], [0.16682066023349762, 0.16590189933776855, 0.16712686419487, 0.1672801822423935, 0.16635888814926147, 0.16651150584220886]], [[0.16703404486179352, 0.16690434515476227, 0.16560310125350952, 0.16664522886276245, 0.16742675006389618, 0.16638651490211487], [0.16709105670452118, 0.16694115102291107, 0.16543817520141602, 0.1666417270898819, 0.16754506528377533, 0.1663428246974945], [0.16766391694545746, 0.16730976104736328, 0.16378289461135864, 0.166603684425354, 0.16873909533023834, 0.1659005731344223], [0.16720500588417053, 0.16701462864875793, 0.16510865092277527, 0.16663455963134766, 0.167781800031662, 0.16625532507896423], [0.16686151921749115, 0.1667928397655487, 0.16610240936279297, 0.1666555553674698, 0.16706931591033936, 0.16651839017868042], [0.16731885075569153, 0.16708797216415405, 0.16477961838245392, 0.1666271984577179, 0.16801868379116058, 0.16616769134998322]]]}, "num_training_step_calls_per_iteration": 1, "evaluation": {"env_runners": {"env_to_module_connector": {"timers": {"connectors": {"add_states_from_episodes_to_batch": 2.7329586539937253e-06, "numpy_to_tensor": 1.2294010001500094e-05, "add_time_dim_to_batch_and_zero_pad": 6.937601862096481e-06, "add_observations_from_episodes_to_batch": 2.8017315587674844e-06, "batch_individual_items": 1.2246788575809142e-05}}, "connector_pipeline_timer": 5.903059922790779e-05}, "module_to_env_connector": {"timers": {"connectors": {"tensor_to_numpy": 1.5139825064483787e-05, "remove_single_ts_time_rank_from_batch": 1.1954665568390658e-05, "un_batch_to_individual_items": 6.817291388334617e-06, "normalize_and_clip_actions": 8.108443401348611e-06, "get_actions": 3.6937912349096474e-05, "listify_data_for_vector_env": 1.0498134445780203e-05}}, "connector_pipeline_timer": 0.00011604764748969788}, "num_env_steps_sampled": 400, "num_agent_steps_sampled_lifetime": {"default_agent": 800}, "env_step_timer": 1.448240740600186e-05, "episode_len_max": 20, "num_episodes_lifetime": 40, "sample": 0.11565667797229254, "weights_seq_no": 2.0, "env_to_module_sum_episodes_length_in": 10.366003441359926, "module_episode_returns_mean": {"default_policy": 0.25}, "num_env_steps_sampled_lifetime": 10400, "agent_episode_returns_mean": {"default_agent": 0.25}, "episode_duration_sec_mean": 0.005291321888216771, "episode_return_mean": 0.25, "episode_return_min": -14.5, "env_reset_timer": 0.000461131528718397, "episode_len_mean": 20.0, "episode_return_max": 14.5, "rlmodule_inference_timer": 3.145678484725142e-05, "episode_len_min": 20, "num_episodes": 20, "env_to_module_sum_episodes_length_out": 10.366003441359926, "num_module_steps_sampled_lifetime": {"default_policy": 800}, "num_module_steps_sampled": {"default_policy": 400}, "num_agent_steps_sampled": {"default_agent": 400}, "time_between_sampling": 9.740799625054933}, "num_healthy_workers": 1, "actor_manager_num_outstanding_async_reqs": 0, "num_remote_worker_restarts": 0}, "num_env_steps_sampled_lifetime": 10000.0, "fault_tolerance": {"num_healthy_workers": 0, "num_remote_worker_restarts": 0}, "env_runner_group": {"actor_manager_num_outstanding_async_reqs": 0}, "done": false, "training_iteration": 2, "trial_id": "b5096_00000", "date": "2025-08-11_18-44-43", "timestamp": 1754930683, "time_this_iter_s": 9.828182935714722, "time_total_s": 20.256577968597412, "pid": 11702, "hostname": "Mac", "node_ip": "127.0.0.1", "config": {"exploration_config": {}, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 2, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "env": "Umbrella", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": false, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 0, "create_local_env_runner": true, "num_envs_per_env_runner": 1, "gym_env_vectorize_mode": "SYNC", "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "episodes_to_numpy": true, "max_requests_in_flight_per_env_runner": 1, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "merge_env_runner_states": "training_only", "broadcast_env_runner_states": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "complete_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "sampler_perf_stats_ema_coef": null, "_is_online": true, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": "auto", "num_aggregator_actors_per_learner": 0, "max_requests_in_flight_per_aggregator_actor": 3, "local_gpu_idx": 0, "max_requests_in_flight_per_learner": 3, "gamma": 1, "lr": 0.0002715581955, "grad_clip": 0.5, "grad_clip_by": "global_norm", "_train_batch_size_per_learner": 5000, "train_batch_size": 4000, "num_epochs": 1, "minibatch_size": 1000, "shuffle_batch_per_epoch": true, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "log_std_clip_param": 20.0, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "_disable_preprocessor_api": false, "_disable_action_flattening": false}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {"intrinsic_reward_coeff": 0.2795015916508}, "optimizer": {}, "_learner_class": "<class 'source.intrinsic_attention_ppo.learners.IntrinsicAttentionMetaLearner.IntrinsicAttentionMetaLearner'>", "callbacks_on_algorithm_init": null, "callbacks_on_env_runners_recreated": null, "callbacks_on_offline_eval_runners_recreated": null, "callbacks_on_checkpoint_loaded": null, "callbacks_on_environment_created": null, "callbacks_on_episode_created": null, "callbacks_on_episode_start": null, "callbacks_on_episode_step": null, "callbacks_on_episode_end": null, "callbacks_on_evaluate_start": null, "callbacks_on_evaluate_end": null, "callbacks_on_evaluate_offline_start": null, "callbacks_on_evaluate_offline_end": null, "callbacks_on_sample_end": null, "callbacks_on_train_result": null, "explore": true, "enable_rl_module_and_learner": true, "enable_env_runner_and_connector_v2": true, "_prior_exploration_config": {"type": "StochasticSampling"}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x3866e5760>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "offline_data_class": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_read_batch_size": null, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "materialize_data": false, "materialize_mapped_data": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "ignore_final_observation": false, "prelearner_class": null, "prelearner_buffer_class": null, "prelearner_buffer_kwargs": {}, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_remaining_data": false, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": 1, "evaluation_duration": 20, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_auto_duration_min_env_steps_per_sample": 100, "evaluation_auto_duration_max_env_steps_per_sample": 2000, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 1, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "offline_evaluation_interval": null, "num_offline_eval_runners": 0, "offline_loss_for_module_fn": null, "offline_evaluation_duration": 1, "offline_evaluation_parallel_to_training": false, "offline_evaluation_timeout_s": 120.0, "num_cpus_per_offline_eval_runner": 1, "num_gpus_per_offline_eval_runner": 0, "custom_resources_per_offline_eval_runner": {}, "restart_failed_offline_eval_runners": true, "ignore_offline_eval_runner_failures": false, "max_num_offline_eval_runner_restarts": 1000, "offline_eval_runner_restore_timeout_s": 1800.0, "max_requests_in_flight_per_offline_eval_runner": 1, "validate_offline_eval_runners_after_construction": true, "offline_eval_runner_health_probe_timeout_s": 30.0, "offline_eval_rl_module_inference_only": false, "broadcast_offline_eval_runner_states": false, "offline_eval_batch_size_per_runner": 256, "dataset_num_iters_per_eval_runner": 1, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "log_gradients": false, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 8, "restart_failed_env_runners": true, "ignore_env_runner_failures": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30.0, "env_runner_restore_timeout_s": 1800.0, "_model_config": {}, "_rl_module_spec": "MultiRLModuleSpec(multi_rl_module_class=<class 'ray.rllib.core.rl_module.multi_rl_module.MultiRLModule'>, observation_space=None, action_space=None, inference_only=False, model_config=None, rl_module_specs={'default_policy': RLModuleSpec(module_class=<class 'source.intrinsic_attention_ppo.rl_modules.DifferentiablePPOModule.DifferentiablePPOModule'>, observation_space=None, action_space=None, inference_only=False, learner_only=False, model_config={'vf_share_layers': True, 'embedding_dim': 62, 'max_seq_len': 6, 'policy_head_hidden_sizes': [32], 'value_head_hidden_sizes': [101], 'embedding_hidden_sizes': [121]}, catalog_class=None, load_state_path=None, model_config_dict=None), 'intrinsic_reward_module': RLModuleSpec(module_class=<class 'source.intrinsic_attention_ppo.rl_modules.IntrinsicAttentionModule.IntrinsicAttentionModule'>, observation_space=None, action_space=None, inference_only=False, learner_only=True, model_config={'intrinsic_reward_network': {'encoder_hidden_sizes': [], 'encoding_dim': 1, 'num_heads': 1, 'head_hidden_sizes': None, 'layers': [{'type': 'attention'}]}, 'extrinsic_value_hidden_layers': [127, 60], 'vf_share_layers': True, 'max_seq_len': 6}, catalog_class=None, load_state_path=None, model_config_dict=None)}, load_state_path=None, modules_to_load=None, module_specs={'default_policy': RLModuleSpec(module_class=<class 'source.intrinsic_attention_ppo.rl_modules.DifferentiablePPOModule.DifferentiablePPOModule'>, observation_space=None, action_space=None, inference_only=False, learner_only=False, model_config={'vf_share_layers': True, 'embedding_dim': 62, 'max_seq_len': 6, 'policy_head_hidden_sizes': [32], 'value_head_hidden_sizes': [101], 'embedding_hidden_sizes': [121]}, catalog_class=None, load_state_path=None, model_config_dict=None), 'intrinsic_reward_module': RLModuleSpec(module_class=<class 'source.intrinsic_attention_ppo.rl_modules.IntrinsicAttentionModule.IntrinsicAttentionModule'>, observation_space=None, action_space=None, inference_only=False, learner_only=True, model_config={'intrinsic_reward_network': {'encoder_hidden_sizes': [], 'encoding_dim': 1, 'num_heads': 1, 'head_hidden_sizes': None, 'layers': [{'type': 'attention'}]}, 'extrinsic_value_hidden_layers': [127, 60], 'vf_share_layers': True, 'max_seq_len': 6}, catalog_class=None, load_state_path=None, model_config_dict=None)})", "algorithm_config_overrides_per_module": {"intrinsic_reward_module": {"lr": 0.0002715581955}}, "_per_module_overrides": {}, "_validate_config": true, "_use_msgpack_checkpoints": false, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "env_task_fn": -1, "enable_connectors": -1, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.161583927863, "kl_target": 0.0201019014258, "vf_loss_coeff": 0.7790510010087, "entropy_coeff": 0.0015431216992, "clip_param": 0.2459212356676, "vf_clip_param": 0.3769744131561, "entropy_coeff_schedule": null, "lr_schedule": null, "sgd_minibatch_size": -1, "vf_share_layers": -1, "differentiable_learner_configs": ["DifferentiableLearnerConfig(learner_class=<class 'source.intrinsic_attention_ppo.learners.IntrinsicAttentionPPOLearner.IntrinsicAttentionPPOLearner'>, learner_connector=None, add_default_connectors_to_learner_pipeline=True, is_multi_agent=False, policies_to_update=['default_policy'], lr=0.0060984166342, num_total_minibatches=0, num_epochs=1, minibatch_size=1000, shuffle_batch_per_epoch=True)"], "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9485408017724, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.callbacks.callbacks.RLlibCallback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 20.256577968597412, "iterations_since_restore": 2, "perf": {"cpu_util_percent": 33.42857142857143, "ram_util_percent": 80.27857142857144}}
{"timers": {"training_iteration": 10.288820404139358, "restore_env_runners": 1.1500912730116398e-05, "training_step": 10.288662782642641, "env_runner_sampling_timer": 1.661348482034856, "learner_update_timer": 8.436275006793602, "synch_weights": 0.0013267267182120123, "restore_eval_env_runners": 3.199247526936233e-05, "evaluation_iteration": 0.12477475508698262, "synch_eval_env_connectors": 0.00015614198287948965, "synch_env_connectors": 4.374164855107665e-06}, "env_runners": {"episode_duration_sec_mean": 0.005521165827289224, "env_to_module_connector": {"timers": {"connectors": {"numpy_to_tensor": 1.3483773051009223e-05, "add_observations_from_episodes_to_batch": 2.921987413960021e-06, "batch_individual_items": 1.3097451102929188e-05, "add_time_dim_to_batch_and_zero_pad": 7.335838902232693e-06, "add_states_from_episodes_to_batch": 2.784299469814556e-06}}, "connector_pipeline_timer": 6.253009169263595e-05}, "num_env_steps_sampled": 5000.0, "episode_return_min": -11.5, "module_to_env_connector": {"timers": {"connectors": {"normalize_and_clip_actions": 8.42182449179225e-06, "un_batch_to_individual_items": 6.759912411145652e-06, "get_actions": 4.20939432620446e-05, "remove_single_ts_time_rank_from_batch": 1.2355489020771886e-05, "listify_data_for_vector_env": 1.0987324730073621e-05, "tensor_to_numpy": 1.591318517150599e-05}}, "connector_pipeline_timer": 0.00012384760537846945}, "env_reset_timer": 4.4996404936010885e-05, "sample": 0.0058774028317301885, "num_episodes_lifetime": -30375.0, "env_to_module_sum_episodes_length_out": 10.36823839457432, "env_step_timer": 1.4608533296683408e-05, "num_module_steps_sampled_lifetime": {"default_policy": -607500.0}, "weights_seq_no": 2.0, "module_episode_returns_mean": {"default_policy": -1.3400000000000003}, "env_to_module_sum_episodes_length_in": 10.36823839457432, "episode_len_mean": 20.0, "agent_episode_returns_mean": {"default_agent": -1.3400000000000003}, "time_between_sampling": 0.03350379894966161, "num_module_steps_sampled": {"default_policy": 5000.0}, "episode_return_max": 8.5, "episode_len_min": 20, "episode_len_max": 20, "rlmodule_inference_timer": 3.345687062122148e-05, "num_agent_steps_sampled": {"default_agent": 5000.0}, "num_episodes": 250.0, "num_env_steps_sampled_lifetime": -607500.0, "num_agent_steps_sampled_lifetime": {"default_agent": -607500.0}, "episode_return_mean": -1.3400000000000003, "num_env_steps_sampled_lifetime_throughput": 3089.5292730871147}, "__all_modules__": {"learner_connector_sum_episodes_length_in": 5000.0, "learner_connector": {"connector_pipeline_timer": 0.15339825414362132, "timers": {"connectors": {"add_one_ts_to_episodes_and_truncate": 0.008804009052237962, "add_observations_from_episodes_to_batch": 0.0008102801666362211, "add_columns_from_episodes_to_train_batch": 0.041088101245113653, "add_time_dim_to_batch_and_zero_pad": 0.09023321813013171, "add_states_from_episodes_to_batch": 0.0036129036392667335, "batch_individual_items": 0.008616365631262307, "numpy_to_tensor": 7.884416513843462e-05}}}, "learner_connector_sum_episodes_length_out": 5250.0}, "learners": {"default_policy": {"num_module_steps_trained_lifetime": 17955, "weights_seq_no": 3.0, "entropy": 0.6923352479934692, "num_module_steps_trained": 5985, "vf_loss": 0.3205430209636688, "mean_kl_loss": 1.217023964272812e-06, "num_trainable_parameters": 16595, "curr_entropy_coeff": 0.0015431216992, "module_train_batch_size_mean": 998.7505232584676, "vf_explained_var": -0.001675724983215332, "total_loss": 0.24862082302570343, "vf_loss_unclipped": 41.82904052734375, "policy_loss": -3.0207735107978806e-05, "use_intrinsic_rewards": 0.0, "diff_num_grad_updates_vs_sampler_policy": 1.0, "curr_kl_coeff": 0.020197991281747818, "num_module_steps_trained_lifetime_throughput": 650.8447320216387}, "intrinsic_reward_module": {"total_loss": 0.0, "gradients_default_optimizer_global_norm": 0.0, "num_module_steps_trained_lifetime": 17955, "num_module_steps_trained": 5985, "weights_seq_no": 3.0, "num_trainable_parameters": 8266, "curr_entropy_coeff": 0.0015431216992, "module_train_batch_size_mean": 998.7505232584676, "default_optimizer_learning_rate": 0.0002715581955, "diff_num_grad_updates_vs_sampler_policy": 1.0, "num_module_steps_trained_lifetime_throughput": 650.8540417602419}, "differentiable_learners": {"intrinsic_attention_ppo_learner": {"default_policy": {"num_module_steps_trained": 35910, "weights_seq_no": 18.0, "entropy": 0.6923373341560364, "vf_loss": 0.3209307789802551, "mean_kl_loss": 1.1334544751662179e-06, "module_train_batch_size_mean": 998.0016398003509, "vf_explained_var": 0.0012806057929992676, "diff_num_grad_updates_vs_sampler_policy": 16.0, "total_loss": 0.2489238828420639, "vf_loss_unclipped": 41.68272399902344, "policy_loss": -2.9381821150309406e-05, "use_intrinsic_rewards": 1.0, "num_module_steps_trained_lifetime": 107730}, "intrinsic_reward_module": {"module_train_batch_size_mean": 998.0016398003509, "diff_num_grad_updates_vs_sampler_policy": 16.0, "total_loss": 0.0, "num_module_steps_trained_lifetime": 107730, "num_module_steps_trained": 35910, "weights_seq_no": 18.0}, "__all_modules__": {"num_module_steps_trained_lifetime": 215460, "num_module_steps_trained": 71820, "num_env_steps_trained": 216000, "num_env_steps_trained_lifetime": 648000, "num_env_steps_trained_lifetime_throughput": 62071.58314994912}}}, "__all_modules__": {"num_module_steps_trained_lifetime": 35910, "num_module_steps_trained": 11970, "num_trainable_parameters": 24861, "num_env_steps_trained": 36000, "num_env_steps_trained_lifetime": 108000, "num_non_trainable_parameters": 0, "num_env_steps_trained_lifetime_throughput": 3919.546693986083, "num_module_steps_trained_throughput": 28685752.62472225, "num_module_steps_trained_lifetime_throughput": 11575504.025825137}, "IntrinsicAttentionMask": [[[0.16678033769130707, 0.1674966663122177, 0.16628795862197876, 0.16557982563972473, 0.16664212942123413, 0.16721311211585999], [0.1664462387561798, 0.16510675847530365, 0.16737660765647888, 0.16872872412204742, 0.16670657694339752, 0.16563498973846436], [0.16699989140033722, 0.16915400326251984, 0.16552987694740295, 0.16343079507350922, 0.16658639907836914, 0.1682991236448288], [0.1673010289669037, 0.17155857384204865, 0.16442571580410004, 0.16036225855350494, 0.16648979485034943, 0.16986265778541565], [0.16684278845787048, 0.16796065866947174, 0.16607598960399628, 0.1649753451347351, 0.166627436876297, 0.16751785576343536], [0.16658057272434235, 0.1660497635602951, 0.16694772243499756, 0.16747912764549255, 0.16668343544006348, 0.16625940799713135]], [[0.16719229519367218, 0.16307541728019714, 0.16636689007282257, 0.16595572233200073, 0.17227329313755035, 0.1651364266872406], [0.16743388772010803, 0.16132089495658875, 0.16620229184627533, 0.16558988392353058, 0.17508110404014587, 0.16437184810638428], [0.1672411412000656, 0.1627265363931656, 0.1663351207971573, 0.16588395833969116, 0.17282800376415253, 0.1649852842092514], [0.167265385389328, 0.16255217790603638, 0.16631905734539032, 0.16584789752960205, 0.17310583591461182, 0.16490958631038666], [0.16688740253448486, 0.1651923805475235, 0.16654956340789795, 0.1663808971643448, 0.16894574463367462, 0.16604407131671906], [0.1673136055469513, 0.16220375895500183, 0.1662866324186325, 0.16577550768852234, 0.17366252839565277, 0.16475798189640045]], [[0.16710153222084045, 0.16717535257339478, 0.16596898436546326, 0.16589869558811188, 0.16696305572986603, 0.16689234972000122], [0.16697227954864502, 0.16702410578727722, 0.16617633402347565, 0.16612687706947327, 0.16687504947185516, 0.16682538390159607], [0.1690855324268341, 0.16950269043445587, 0.1627911627292633, 0.16240698099136353, 0.1683054119348526, 0.1679082065820694], [0.16920872032642365, 0.16964754462242126, 0.16259415447711945, 0.16219082474708557, 0.1683882176876068, 0.16797052323818207], [0.16734398901462555, 0.16745920479297638, 0.165580153465271, 0.1654709130525589, 0.16712796688079834, 0.16701771318912506], [0.16746781766414642, 0.1676042377948761, 0.16538165509700775, 0.16525258123874664, 0.16721211373806, 0.16708162426948547]], [[0.16908231377601624, 0.164918914437294, 0.16824759542942047, 0.16410472989082336, 0.17035183310508728, 0.16329456865787506], [0.17026707530021667, 0.1640506237745285, 0.16901461780071259, 0.16284389793872833, 0.17217771708965302, 0.1616460531949997], [0.16931767761707306, 0.16474699974060059, 0.16840039193630219, 0.16385449469089508, 0.17071357369422913, 0.16296681761741638], [0.1705019623041153, 0.16387759149074554, 0.16916604340076447, 0.16259357333183289, 0.17254120111465454, 0.16131961345672607], [0.16872642934322357, 0.1651783287525177, 0.16801610589027405, 0.1644829362630844, 0.16980575025081635, 0.16379046440124512], [0.17073675990104675, 0.16370433568954468, 0.16931717097759247, 0.16234321892261505, 0.17290502786636353, 0.16099341213703156]], [[0.16688746213912964, 0.1676042377948761, 0.16575635969638824, 0.16632430255413055, 0.16674916446208954, 0.1666785478591919], [0.16624613106250763, 0.1649082601070404, 0.16839133203029633, 0.16730892658233643, 0.16650615632534027, 0.16663916409015656], [0.16787777841091156, 0.17193973064422607, 0.1616283804178238, 0.16474199295043945, 0.16710323095321655, 0.16670885682106018], [0.16738389432430267, 0.16975028812885284, 0.16369645297527313, 0.16554084420204163, 0.16692999005317688, 0.16669853031635284], [0.16700994968414307, 0.16812893748283386, 0.16524963080883026, 0.16613268852233887, 0.16679437458515167, 0.1666843295097351], [0.1670723855495453, 0.1683974713087082, 0.16499114036560059, 0.16603468358516693, 0.1668172925710678, 0.16668710112571716]], [[0.16473683714866638, 0.1695561408996582, 0.16356457769870758, 0.1629815697669983, 0.17200930416584015, 0.16715160012245178], [0.16526804864406586, 0.16876830160617828, 0.16441242396831512, 0.16398628056049347, 0.17053958773612976, 0.1670253574848175], [0.1646047830581665, 0.16975104808807373, 0.1633545309305191, 0.16273295879364014, 0.17237447202205658, 0.16718213260173798], [0.16453871130943298, 0.1698485016822815, 0.16324950754642487, 0.16260869801044464, 0.17255724966526031, 0.1671973019838333], [0.16553156077861786, 0.1683754175901413, 0.16483469307422638, 0.1644873470067978, 0.16981031000614166, 0.1669607013463974], [0.16500531136989594, 0.1691586971282959, 0.1639924943447113, 0.16348843276500702, 0.17126663029193878, 0.16708847880363464]]]}, "num_training_step_calls_per_iteration": 1, "evaluation": {"env_runners": {"env_to_module_connector": {"timers": {"connectors": {"add_states_from_episodes_to_batch": 2.6911937981309097e-06, "numpy_to_tensor": 1.2062010842153204e-05, "add_time_dim_to_batch_and_zero_pad": 6.688129040337437e-06, "add_observations_from_episodes_to_batch": 2.7670606697322258e-06, "batch_individual_items": 1.2308616967652516e-05}}, "connector_pipeline_timer": 5.849283530382406e-05}, "module_to_env_connector": {"timers": {"connectors": {"tensor_to_numpy": 1.4947506036741694e-05, "remove_single_ts_time_rank_from_batch": 1.1993016008071888e-05, "un_batch_to_individual_items": 6.543088271018262e-06, "normalize_and_clip_actions": 7.851096506309293e-06, "get_actions": 3.5785128022275056e-05, "listify_data_for_vector_env": 1.0307348238370257e-05}}, "connector_pipeline_timer": 0.00011360090790840583}, "num_env_steps_sampled": 400, "num_agent_steps_sampled_lifetime": {"default_agent": 1200}, "env_step_timer": 1.3763078217400642e-05, "episode_len_max": 20, "num_episodes_lifetime": 60, "sample": 0.11563866286199774, "weights_seq_no": 3.0, "env_to_module_sum_episodes_length_in": 10.368205581254823, "module_episode_returns_mean": {"default_policy": 0.08333333333333333}, "num_env_steps_sampled_lifetime": 15400, "agent_episode_returns_mean": {"default_agent": 0.08333333333333333}, "episode_duration_sec_mean": 0.00525869796401821, "episode_return_mean": 0.08333333333333333, "episode_return_min": -14.5, "env_reset_timer": 0.0004591035439283587, "episode_len_mean": 20.0, "episode_return_max": 14.5, "rlmodule_inference_timer": 3.13379670347226e-05, "episode_len_min": 20, "num_episodes": 20, "env_to_module_sum_episodes_length_out": 10.368205581254823, "num_module_steps_sampled_lifetime": {"default_policy": 1200}, "num_module_steps_sampled": {"default_policy": 400}, "num_agent_steps_sampled": {"default_agent": 400}, "time_between_sampling": 9.740078024223912}, "num_healthy_workers": 1, "actor_manager_num_outstanding_async_reqs": 0, "num_remote_worker_restarts": 0}, "num_env_steps_sampled_lifetime": -607500.0, "fault_tolerance": {"num_healthy_workers": 0, "num_remote_worker_restarts": 0}, "env_runner_group": {"actor_manager_num_outstanding_async_reqs": 0}, "done": false, "training_iteration": 3, "trial_id": "b5096_00000", "date": "2025-08-11_18-44-53", "timestamp": 1754930693, "time_this_iter_s": 9.768599033355713, "time_total_s": 30.025177001953125, "pid": 11702, "hostname": "Mac", "node_ip": "127.0.0.1", "config": {"exploration_config": {}, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 2, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "env": "Umbrella", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": false, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 0, "create_local_env_runner": true, "num_envs_per_env_runner": 1, "gym_env_vectorize_mode": "SYNC", "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "episodes_to_numpy": true, "max_requests_in_flight_per_env_runner": 1, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "merge_env_runner_states": "training_only", "broadcast_env_runner_states": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "complete_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "sampler_perf_stats_ema_coef": null, "_is_online": true, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": "auto", "num_aggregator_actors_per_learner": 0, "max_requests_in_flight_per_aggregator_actor": 3, "local_gpu_idx": 0, "max_requests_in_flight_per_learner": 3, "gamma": 1, "lr": 0.0002715581955, "grad_clip": 0.5, "grad_clip_by": "global_norm", "_train_batch_size_per_learner": 5000, "train_batch_size": 4000, "num_epochs": 1, "minibatch_size": 1000, "shuffle_batch_per_epoch": true, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "log_std_clip_param": 20.0, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "_disable_preprocessor_api": false, "_disable_action_flattening": false}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {"intrinsic_reward_coeff": 0.2795015916508}, "optimizer": {}, "_learner_class": "<class 'source.intrinsic_attention_ppo.learners.IntrinsicAttentionMetaLearner.IntrinsicAttentionMetaLearner'>", "callbacks_on_algorithm_init": null, "callbacks_on_env_runners_recreated": null, "callbacks_on_offline_eval_runners_recreated": null, "callbacks_on_checkpoint_loaded": null, "callbacks_on_environment_created": null, "callbacks_on_episode_created": null, "callbacks_on_episode_start": null, "callbacks_on_episode_step": null, "callbacks_on_episode_end": null, "callbacks_on_evaluate_start": null, "callbacks_on_evaluate_end": null, "callbacks_on_evaluate_offline_start": null, "callbacks_on_evaluate_offline_end": null, "callbacks_on_sample_end": null, "callbacks_on_train_result": null, "explore": true, "enable_rl_module_and_learner": true, "enable_env_runner_and_connector_v2": true, "_prior_exploration_config": {"type": "StochasticSampling"}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x3866e5760>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "offline_data_class": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_read_batch_size": null, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "materialize_data": false, "materialize_mapped_data": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "ignore_final_observation": false, "prelearner_class": null, "prelearner_buffer_class": null, "prelearner_buffer_kwargs": {}, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_remaining_data": false, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": 1, "evaluation_duration": 20, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_auto_duration_min_env_steps_per_sample": 100, "evaluation_auto_duration_max_env_steps_per_sample": 2000, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 1, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "offline_evaluation_interval": null, "num_offline_eval_runners": 0, "offline_loss_for_module_fn": null, "offline_evaluation_duration": 1, "offline_evaluation_parallel_to_training": false, "offline_evaluation_timeout_s": 120.0, "num_cpus_per_offline_eval_runner": 1, "num_gpus_per_offline_eval_runner": 0, "custom_resources_per_offline_eval_runner": {}, "restart_failed_offline_eval_runners": true, "ignore_offline_eval_runner_failures": false, "max_num_offline_eval_runner_restarts": 1000, "offline_eval_runner_restore_timeout_s": 1800.0, "max_requests_in_flight_per_offline_eval_runner": 1, "validate_offline_eval_runners_after_construction": true, "offline_eval_runner_health_probe_timeout_s": 30.0, "offline_eval_rl_module_inference_only": false, "broadcast_offline_eval_runner_states": false, "offline_eval_batch_size_per_runner": 256, "dataset_num_iters_per_eval_runner": 1, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "log_gradients": false, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 8, "restart_failed_env_runners": true, "ignore_env_runner_failures": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30.0, "env_runner_restore_timeout_s": 1800.0, "_model_config": {}, "_rl_module_spec": "MultiRLModuleSpec(multi_rl_module_class=<class 'ray.rllib.core.rl_module.multi_rl_module.MultiRLModule'>, observation_space=None, action_space=None, inference_only=False, model_config=None, rl_module_specs={'default_policy': RLModuleSpec(module_class=<class 'source.intrinsic_attention_ppo.rl_modules.DifferentiablePPOModule.DifferentiablePPOModule'>, observation_space=None, action_space=None, inference_only=False, learner_only=False, model_config={'vf_share_layers': True, 'embedding_dim': 62, 'max_seq_len': 6, 'policy_head_hidden_sizes': [32], 'value_head_hidden_sizes': [101], 'embedding_hidden_sizes': [121]}, catalog_class=None, load_state_path=None, model_config_dict=None), 'intrinsic_reward_module': RLModuleSpec(module_class=<class 'source.intrinsic_attention_ppo.rl_modules.IntrinsicAttentionModule.IntrinsicAttentionModule'>, observation_space=None, action_space=None, inference_only=False, learner_only=True, model_config={'intrinsic_reward_network': {'encoder_hidden_sizes': [], 'encoding_dim': 1, 'num_heads': 1, 'head_hidden_sizes': None, 'layers': [{'type': 'attention'}]}, 'extrinsic_value_hidden_layers': [127, 60], 'vf_share_layers': True, 'max_seq_len': 6}, catalog_class=None, load_state_path=None, model_config_dict=None)}, load_state_path=None, modules_to_load=None, module_specs={'default_policy': RLModuleSpec(module_class=<class 'source.intrinsic_attention_ppo.rl_modules.DifferentiablePPOModule.DifferentiablePPOModule'>, observation_space=None, action_space=None, inference_only=False, learner_only=False, model_config={'vf_share_layers': True, 'embedding_dim': 62, 'max_seq_len': 6, 'policy_head_hidden_sizes': [32], 'value_head_hidden_sizes': [101], 'embedding_hidden_sizes': [121]}, catalog_class=None, load_state_path=None, model_config_dict=None), 'intrinsic_reward_module': RLModuleSpec(module_class=<class 'source.intrinsic_attention_ppo.rl_modules.IntrinsicAttentionModule.IntrinsicAttentionModule'>, observation_space=None, action_space=None, inference_only=False, learner_only=True, model_config={'intrinsic_reward_network': {'encoder_hidden_sizes': [], 'encoding_dim': 1, 'num_heads': 1, 'head_hidden_sizes': None, 'layers': [{'type': 'attention'}]}, 'extrinsic_value_hidden_layers': [127, 60], 'vf_share_layers': True, 'max_seq_len': 6}, catalog_class=None, load_state_path=None, model_config_dict=None)})", "algorithm_config_overrides_per_module": {"intrinsic_reward_module": {"lr": 0.0002715581955}}, "_per_module_overrides": {}, "_validate_config": true, "_use_msgpack_checkpoints": false, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "env_task_fn": -1, "enable_connectors": -1, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.161583927863, "kl_target": 0.0201019014258, "vf_loss_coeff": 0.7790510010087, "entropy_coeff": 0.0015431216992, "clip_param": 0.2459212356676, "vf_clip_param": 0.3769744131561, "entropy_coeff_schedule": null, "lr_schedule": null, "sgd_minibatch_size": -1, "vf_share_layers": -1, "differentiable_learner_configs": ["DifferentiableLearnerConfig(learner_class=<class 'source.intrinsic_attention_ppo.learners.IntrinsicAttentionPPOLearner.IntrinsicAttentionPPOLearner'>, learner_connector=None, add_default_connectors_to_learner_pipeline=True, is_multi_agent=False, policies_to_update=['default_policy'], lr=0.0060984166342, num_total_minibatches=0, num_epochs=1, minibatch_size=1000, shuffle_batch_per_epoch=True)"], "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9485408017724, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.callbacks.callbacks.RLlibCallback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 30.025177001953125, "iterations_since_restore": 3, "perf": {"cpu_util_percent": 36.37142857142857, "ram_util_percent": 80.52142857142859}}
{"timers": {"training_iteration": 10.282392840928884, "restore_env_runners": 1.1461313955835068e-05, "training_step": 10.282234568986407, "env_runner_sampling_timer": 1.6608025301243088, "learner_update_timer": 8.43029673922651, "synch_weights": 0.0013244577815745724, "restore_eval_env_runners": 3.205463025951758e-05, "evaluation_iteration": 0.12474327378681627, "synch_eval_env_connectors": 0.00015603890360798686, "synch_env_connectors": 4.372502688784152e-06}, "env_runners": {"episode_duration_sec_mean": 0.00550936400098726, "env_to_module_connector": {"timers": {"connectors": {"numpy_to_tensor": 1.3387588232857129e-05, "add_observations_from_episodes_to_batch": 2.915876425520975e-06, "batch_individual_items": 1.2885263648440806e-05, "add_time_dim_to_batch_and_zero_pad": 7.305972795892949e-06, "add_states_from_episodes_to_batch": 2.789406559202608e-06}}, "connector_pipeline_timer": 6.199125834847549e-05}, "num_env_steps_sampled": 5000.0, "episode_return_min": -11.5, "module_to_env_connector": {"timers": {"connectors": {"normalize_and_clip_actions": 8.352379706468035e-06, "un_batch_to_individual_items": 6.679126762314027e-06, "get_actions": 4.2106521132106055e-05, "remove_single_ts_time_rank_from_batch": 1.2330669837782818e-05, "listify_data_for_vector_env": 1.0980874206046115e-05, "tensor_to_numpy": 1.5846326188477962e-05}}, "connector_pipeline_timer": 0.00012369208043589667}, "env_reset_timer": 4.7414550738939036e-05, "sample": 0.005929096573395389, "num_episodes_lifetime": -61250.0, "env_to_module_sum_episodes_length_out": 10.36823839457432, "env_step_timer": 1.4651755351255906e-05, "num_module_steps_sampled_lifetime": {"default_policy": -1225000.0}, "weights_seq_no": 3.0, "module_episode_returns_mean": {"default_policy": -1.5}, "env_to_module_sum_episodes_length_in": 10.36823839457432, "episode_len_mean": 20.0, "agent_episode_returns_mean": {"default_agent": -1.5}, "time_between_sampling": 0.033239089276177455, "num_module_steps_sampled": {"default_policy": 5000.0}, "episode_return_max": 8.5, "episode_len_min": 20, "episode_len_max": 20, "rlmodule_inference_timer": 3.317724700481806e-05, "num_agent_steps_sampled": {"default_agent": 5000.0}, "num_episodes": 250.0, "num_env_steps_sampled_lifetime": -1225000.0, "num_agent_steps_sampled_lifetime": {"default_agent": -1225000.0}, "episode_return_mean": -1.5, "num_env_steps_sampled_lifetime_throughput": 3118.2895090697866}, "__all_modules__": {"learner_connector_sum_episodes_length_in": 5000.0, "learner_connector": {"connector_pipeline_timer": 0.1533758828526471, "timers": {"connectors": {"add_one_ts_to_episodes_and_truncate": 0.008806008962802472, "add_observations_from_episodes_to_batch": 0.0008103194549067411, "add_columns_from_episodes_to_train_batch": 0.04109014398219879, "add_time_dim_to_batch_and_zero_pad": 0.0902165938594687, "add_states_from_episodes_to_batch": 0.0036134025232185383, "batch_individual_items": 0.008606379474672373, "numpy_to_tensor": 7.890864383487496e-05}}}, "learner_connector_sum_episodes_length_out": 5250.0}, "learners": {"default_policy": {"num_module_steps_trained_lifetime": 23940, "weights_seq_no": 4.0, "entropy": 0.6921147704124451, "num_module_steps_trained": 5985, "vf_loss": 0.3205561935901642, "mean_kl_loss": 1.6966347175184637e-05, "num_trainable_parameters": 16595, "curr_entropy_coeff": 0.0015431216992, "module_train_batch_size_mean": 998.6769017198101, "vf_explained_var": 0.00022685527801513672, "total_loss": 0.2482421100139618, "vf_loss_unclipped": 42.129268646240234, "policy_loss": -0.0004198420501779765, "use_intrinsic_rewards": 0.0, "diff_num_grad_updates_vs_sampler_policy": 1.0, "curr_kl_coeff": 0.010098995640873909, "num_module_steps_trained_lifetime_throughput": 652.3996267766046}, "intrinsic_reward_module": {"total_loss": 0.0, "gradients_default_optimizer_global_norm": 0.0, "num_module_steps_trained_lifetime": 23940, "num_module_steps_trained": 5985, "weights_seq_no": 4.0, "num_trainable_parameters": 8266, "curr_entropy_coeff": 0.0015431216992, "module_train_batch_size_mean": 998.6769017198101, "default_optimizer_learning_rate": 0.0002715581955, "diff_num_grad_updates_vs_sampler_policy": 1.0, "num_module_steps_trained_lifetime_throughput": 652.4086151413078}, "differentiable_learners": {"intrinsic_attention_ppo_learner": {"default_policy": {"num_module_steps_trained": 35910, "weights_seq_no": 24.0, "entropy": 0.6921347975730896, "vf_loss": 0.32084619998931885, "mean_kl_loss": 1.4479724086413626e-05, "module_train_batch_size_mean": 997.847060245087, "vf_explained_var": 0.0012627840042114258, "diff_num_grad_updates_vs_sampler_policy": 21.0, "total_loss": 0.2485019713640213, "vf_loss_unclipped": 42.11386489868164, "policy_loss": -0.00038788540405221283, "use_intrinsic_rewards": 1.0, "num_module_steps_trained_lifetime": 143640}, "intrinsic_reward_module": {"module_train_batch_size_mean": 997.847060245087, "diff_num_grad_updates_vs_sampler_policy": 21.0, "total_loss": 0.0, "num_module_steps_trained_lifetime": 143640, "num_module_steps_trained": 35910, "weights_seq_no": 24.0}, "__all_modules__": {"num_module_steps_trained_lifetime": 287280, "num_module_steps_trained": 71820, "num_env_steps_trained": 216000, "num_env_steps_trained_lifetime": 864000, "num_env_steps_trained_lifetime_throughput": 61293.07546201814}}}, "__all_modules__": {"num_module_steps_trained_lifetime": 47880, "num_module_steps_trained": 11970, "num_trainable_parameters": 24861, "num_env_steps_trained": 36000, "num_env_steps_trained_lifetime": 144000, "num_non_trainable_parameters": 0, "num_env_steps_trained_lifetime_throughput": 3928.7851407634244, "num_module_steps_trained_throughput": 27982629.4609624, "num_module_steps_trained_lifetime_throughput": 11596753.340438612}, "IntrinsicAttentionMask": [[[0.16660764813423157, 0.16593408584594727, 0.16785340011119843, 0.1679663360118866, 0.16525740921497345, 0.1663811206817627], [0.16653741896152496, 0.16513898968696594, 0.16913995146751404, 0.1693769246339798, 0.16374027729034424, 0.16606642305850983], [0.1667194366455078, 0.1673886626958847, 0.16549576818943024, 0.16538572311401367, 0.16806645691394806, 0.16694390773773193], [0.1667284220457077, 0.16751952469348907, 0.1652834415435791, 0.1651535928249359, 0.16832131147384644, 0.16699370741844177], [0.166459858417511, 0.16433416306972504, 0.17044079303741455, 0.17080488801002502, 0.16221745312213898, 0.1657428741455078], [0.1665848046541214, 0.1656673550605774, 0.16828516125679016, 0.16843953728675842, 0.16474702954292297, 0.16627609729766846]], [[0.16471321880817413, 0.1672234684228897, 0.1669105589389801, 0.16659823060035706, 0.17137672007083893, 0.16317787766456604], [0.16573238372802734, 0.16693805158138275, 0.16678829491138458, 0.16663864254951477, 0.1689123660326004, 0.16499023139476776], [0.16560639441013336, 0.16697394847869873, 0.1668040007352829, 0.1666342169046402, 0.16921618580818176, 0.16476526856422424], [0.1654803603887558, 0.16700968146324158, 0.1668195277452469, 0.1666296124458313, 0.16952037811279297, 0.16454046964645386], [0.16737669706344604, 0.16645410656929016, 0.1665680855512619, 0.16668212413787842, 0.16496846079826355, 0.16795051097869873], [0.16408014297485352, 0.16739515960216522, 0.166981041431427, 0.16656795144081116, 0.17291510105133057, 0.16206060349941254]], [[0.1669941246509552, 0.16706791520118713, 0.1658623069524765, 0.1657920777797699, 0.1674983948469162, 0.1667850911617279], [0.16689693927764893, 0.16694875061511993, 0.1661013513803482, 0.1660519242286682, 0.1672508865594864, 0.16675011813640594], [0.16847093403339386, 0.16888657212257385, 0.162199467420578, 0.16181665658950806, 0.17132845520973206, 0.16729788482189178], [0.16856169700622559, 0.1689988374710083, 0.16197243332862854, 0.16157065331935883, 0.17156819999217987, 0.16732822358608246], [0.1663275957107544, 0.16625194251537323, 0.16749654710292816, 0.1675696223974228, 0.1658119410276413, 0.16654227674007416], [0.16726893186569214, 0.1674051731824875, 0.16518522799015045, 0.16505631804466248, 0.16820113360881805, 0.166883185505867]], [[0.16293905675411224, 0.16770575940608978, 0.16177959740161896, 0.1665123850107193, 0.1757356822490692, 0.16532747447490692], [0.16396084427833557, 0.16743341088294983, 0.16311198472976685, 0.16656658053398132, 0.17322300374507904, 0.16570423543453217], [0.16268563270568848, 0.16777189075946808, 0.16144995391368866, 0.16649757325649261, 0.17636212706565857, 0.16523292660713196], [0.16370800137519836, 0.16750167310237885, 0.16278180480003357, 0.16655400395393372, 0.17384281754493713, 0.16561168432235718], [0.16561256349086761, 0.16697318851947784, 0.16527730226516724, 0.1666351705789566, 0.1692039519548416, 0.16629783809185028], [0.1634550392627716, 0.16756941378116608, 0.16245175898075104, 0.16654086112976074, 0.17446428537368774, 0.1655186414718628]], [[0.1667809784412384, 0.16749730706214905, 0.1662886142730713, 0.16621819138526917, 0.16664277017116547, 0.1665721982717514], [0.16644851863384247, 0.1651090383529663, 0.16737890243530273, 0.16751261055469513, 0.16670887172222137, 0.1668420433998108], [0.16700555384159088, 0.16915974020957947, 0.16553549468517303, 0.16532595455646515, 0.1665920466184616, 0.16638116538524628], [0.16703742742538452, 0.16939891874790192, 0.1654275506734848, 0.1651981920003891, 0.16658444702625275, 0.1663534790277481], [0.16684433817863464, 0.1679622083902359, 0.16607750952243805, 0.1659679412841797, 0.16662895679473877, 0.16651903092861176], [0.16687661409378052, 0.16820013523101807, 0.16596965491771698, 0.16584010422229767, 0.16662180423736572, 0.16649176180362701]], [[0.16781075298786163, 0.16367864608764648, 0.16698229312896729, 0.1628705859184265, 0.17291052639484406, 0.16574726998806], [0.1683523803949356, 0.16220584511756897, 0.1671140193939209, 0.1610126793384552, 0.17604151368141174, 0.165273517370224], [0.1679193675518036, 0.16338643431663513, 0.16700966656208038, 0.16250130534172058, 0.17352886497974396, 0.16565434634685516], [0.1684582233428955, 0.16191324591636658, 0.16713830828666687, 0.16064462065696716, 0.17666776478290558, 0.16517780721187592], [0.16714195907115936, 0.16544432938098907, 0.16680358350276947, 0.16510941088199615, 0.16920343041419983, 0.1662973314523697], [0.16808129847049713, 0.16294799745082855, 0.1670496016740799, 0.1619478315114975, 0.1744593381881714, 0.16551394760608673]]]}, "num_training_step_calls_per_iteration": 1, "evaluation": {"env_runners": {"env_to_module_connector": {"timers": {"connectors": {"add_states_from_episodes_to_batch": 2.7951736173509544e-06, "numpy_to_tensor": 1.3503951082059318e-05, "add_time_dim_to_batch_and_zero_pad": 7.031141017976198e-06, "add_observations_from_episodes_to_batch": 2.9185319814602184e-06, "batch_individual_items": 1.275998967309365e-05}}, "connector_pipeline_timer": 6.208133474891083e-05}, "module_to_env_connector": {"timers": {"connectors": {"tensor_to_numpy": 1.5964080585844365e-05, "remove_single_ts_time_rank_from_batch": 1.2409187042179922e-05, "un_batch_to_individual_items": 7.054446486450897e-06, "normalize_and_clip_actions": 8.313703020602033e-06, "get_actions": 4.070915363497779e-05, "listify_data_for_vector_env": 1.0948024134472145e-05}}, "connector_pipeline_timer": 0.00012343104559966471}, "num_env_steps_sampled": 400, "num_agent_steps_sampled_lifetime": {"default_agent": 1600}, "env_step_timer": 1.5333791540924338e-05, "episode_len_max": 20, "num_episodes_lifetime": 80, "sample": 0.1157400470632118, "weights_seq_no": 4.0, "env_to_module_sum_episodes_length_in": 10.368237912813044, "module_episode_returns_mean": {"default_policy": 0.25}, "num_env_steps_sampled_lifetime": 20400, "agent_episode_returns_mean": {"default_agent": 0.25}, "episode_duration_sec_mean": 0.005379980251018423, "episode_return_mean": 0.25, "episode_return_min": -14.5, "env_reset_timer": 0.00045588709869969174, "episode_len_mean": 20.0, "episode_return_max": 14.5, "rlmodule_inference_timer": 3.433758981062217e-05, "episode_len_min": 20, "num_episodes": 20, "env_to_module_sum_episodes_length_out": 10.368237912813044, "num_module_steps_sampled_lifetime": {"default_policy": 1600}, "num_module_steps_sampled": {"default_policy": 400}, "num_agent_steps_sampled": {"default_agent": 400}, "time_between_sampling": 9.739406191061647}, "num_healthy_workers": 1, "actor_manager_num_outstanding_async_reqs": 0, "num_remote_worker_restarts": 0}, "num_env_steps_sampled_lifetime": -1225000.0, "fault_tolerance": {"num_healthy_workers": 0, "num_remote_worker_restarts": 0}, "env_runner_group": {"actor_manager_num_outstanding_async_reqs": 0}, "done": false, "training_iteration": 4, "trial_id": "b5096_00000", "date": "2025-08-11_18-45-02", "timestamp": 1754930702, "time_this_iter_s": 9.781454086303711, "time_total_s": 39.806631088256836, "pid": 11702, "hostname": "Mac", "node_ip": "127.0.0.1", "config": {"exploration_config": {}, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 2, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "env": "Umbrella", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": false, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 0, "create_local_env_runner": true, "num_envs_per_env_runner": 1, "gym_env_vectorize_mode": "SYNC", "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "episodes_to_numpy": true, "max_requests_in_flight_per_env_runner": 1, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "merge_env_runner_states": "training_only", "broadcast_env_runner_states": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "complete_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "sampler_perf_stats_ema_coef": null, "_is_online": true, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": "auto", "num_aggregator_actors_per_learner": 0, "max_requests_in_flight_per_aggregator_actor": 3, "local_gpu_idx": 0, "max_requests_in_flight_per_learner": 3, "gamma": 1, "lr": 0.0002715581955, "grad_clip": 0.5, "grad_clip_by": "global_norm", "_train_batch_size_per_learner": 5000, "train_batch_size": 4000, "num_epochs": 1, "minibatch_size": 1000, "shuffle_batch_per_epoch": true, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "log_std_clip_param": 20.0, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "_disable_preprocessor_api": false, "_disable_action_flattening": false}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {"intrinsic_reward_coeff": 0.2795015916508}, "optimizer": {}, "_learner_class": "<class 'source.intrinsic_attention_ppo.learners.IntrinsicAttentionMetaLearner.IntrinsicAttentionMetaLearner'>", "callbacks_on_algorithm_init": null, "callbacks_on_env_runners_recreated": null, "callbacks_on_offline_eval_runners_recreated": null, "callbacks_on_checkpoint_loaded": null, "callbacks_on_environment_created": null, "callbacks_on_episode_created": null, "callbacks_on_episode_start": null, "callbacks_on_episode_step": null, "callbacks_on_episode_end": null, "callbacks_on_evaluate_start": null, "callbacks_on_evaluate_end": null, "callbacks_on_evaluate_offline_start": null, "callbacks_on_evaluate_offline_end": null, "callbacks_on_sample_end": null, "callbacks_on_train_result": null, "explore": true, "enable_rl_module_and_learner": true, "enable_env_runner_and_connector_v2": true, "_prior_exploration_config": {"type": "StochasticSampling"}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x3866e5760>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "offline_data_class": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_read_batch_size": null, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "materialize_data": false, "materialize_mapped_data": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "ignore_final_observation": false, "prelearner_class": null, "prelearner_buffer_class": null, "prelearner_buffer_kwargs": {}, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_remaining_data": false, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": 1, "evaluation_duration": 20, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_auto_duration_min_env_steps_per_sample": 100, "evaluation_auto_duration_max_env_steps_per_sample": 2000, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 1, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "offline_evaluation_interval": null, "num_offline_eval_runners": 0, "offline_loss_for_module_fn": null, "offline_evaluation_duration": 1, "offline_evaluation_parallel_to_training": false, "offline_evaluation_timeout_s": 120.0, "num_cpus_per_offline_eval_runner": 1, "num_gpus_per_offline_eval_runner": 0, "custom_resources_per_offline_eval_runner": {}, "restart_failed_offline_eval_runners": true, "ignore_offline_eval_runner_failures": false, "max_num_offline_eval_runner_restarts": 1000, "offline_eval_runner_restore_timeout_s": 1800.0, "max_requests_in_flight_per_offline_eval_runner": 1, "validate_offline_eval_runners_after_construction": true, "offline_eval_runner_health_probe_timeout_s": 30.0, "offline_eval_rl_module_inference_only": false, "broadcast_offline_eval_runner_states": false, "offline_eval_batch_size_per_runner": 256, "dataset_num_iters_per_eval_runner": 1, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "log_gradients": false, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 8, "restart_failed_env_runners": true, "ignore_env_runner_failures": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30.0, "env_runner_restore_timeout_s": 1800.0, "_model_config": {}, "_rl_module_spec": "MultiRLModuleSpec(multi_rl_module_class=<class 'ray.rllib.core.rl_module.multi_rl_module.MultiRLModule'>, observation_space=None, action_space=None, inference_only=False, model_config=None, rl_module_specs={'default_policy': RLModuleSpec(module_class=<class 'source.intrinsic_attention_ppo.rl_modules.DifferentiablePPOModule.DifferentiablePPOModule'>, observation_space=None, action_space=None, inference_only=False, learner_only=False, model_config={'vf_share_layers': True, 'embedding_dim': 62, 'max_seq_len': 6, 'policy_head_hidden_sizes': [32], 'value_head_hidden_sizes': [101], 'embedding_hidden_sizes': [121]}, catalog_class=None, load_state_path=None, model_config_dict=None), 'intrinsic_reward_module': RLModuleSpec(module_class=<class 'source.intrinsic_attention_ppo.rl_modules.IntrinsicAttentionModule.IntrinsicAttentionModule'>, observation_space=None, action_space=None, inference_only=False, learner_only=True, model_config={'intrinsic_reward_network': {'encoder_hidden_sizes': [], 'encoding_dim': 1, 'num_heads': 1, 'head_hidden_sizes': None, 'layers': [{'type': 'attention'}]}, 'extrinsic_value_hidden_layers': [127, 60], 'vf_share_layers': True, 'max_seq_len': 6}, catalog_class=None, load_state_path=None, model_config_dict=None)}, load_state_path=None, modules_to_load=None, module_specs={'default_policy': RLModuleSpec(module_class=<class 'source.intrinsic_attention_ppo.rl_modules.DifferentiablePPOModule.DifferentiablePPOModule'>, observation_space=None, action_space=None, inference_only=False, learner_only=False, model_config={'vf_share_layers': True, 'embedding_dim': 62, 'max_seq_len': 6, 'policy_head_hidden_sizes': [32], 'value_head_hidden_sizes': [101], 'embedding_hidden_sizes': [121]}, catalog_class=None, load_state_path=None, model_config_dict=None), 'intrinsic_reward_module': RLModuleSpec(module_class=<class 'source.intrinsic_attention_ppo.rl_modules.IntrinsicAttentionModule.IntrinsicAttentionModule'>, observation_space=None, action_space=None, inference_only=False, learner_only=True, model_config={'intrinsic_reward_network': {'encoder_hidden_sizes': [], 'encoding_dim': 1, 'num_heads': 1, 'head_hidden_sizes': None, 'layers': [{'type': 'attention'}]}, 'extrinsic_value_hidden_layers': [127, 60], 'vf_share_layers': True, 'max_seq_len': 6}, catalog_class=None, load_state_path=None, model_config_dict=None)})", "algorithm_config_overrides_per_module": {"intrinsic_reward_module": {"lr": 0.0002715581955}}, "_per_module_overrides": {}, "_validate_config": true, "_use_msgpack_checkpoints": false, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "env_task_fn": -1, "enable_connectors": -1, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.161583927863, "kl_target": 0.0201019014258, "vf_loss_coeff": 0.7790510010087, "entropy_coeff": 0.0015431216992, "clip_param": 0.2459212356676, "vf_clip_param": 0.3769744131561, "entropy_coeff_schedule": null, "lr_schedule": null, "sgd_minibatch_size": -1, "vf_share_layers": -1, "differentiable_learner_configs": ["DifferentiableLearnerConfig(learner_class=<class 'source.intrinsic_attention_ppo.learners.IntrinsicAttentionPPOLearner.IntrinsicAttentionPPOLearner'>, learner_connector=None, add_default_connectors_to_learner_pipeline=True, is_multi_agent=False, policies_to_update=['default_policy'], lr=0.0060984166342, num_total_minibatches=0, num_epochs=1, minibatch_size=1000, shuffle_batch_per_epoch=True)"], "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9485408017724, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.callbacks.callbacks.RLlibCallback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 39.806631088256836, "iterations_since_restore": 4, "perf": {"cpu_util_percent": 36.964285714285715, "ram_util_percent": 80.75}}
{"timers": {"training_iteration": 10.277635430019568, "restore_env_runners": 1.142378056501155e-05, "training_step": 10.277476524967073, "env_runner_sampling_timer": 1.660749486493408, "learner_update_timer": 8.425467700584038, "synch_weights": 0.0013276723640103696, "restore_eval_env_runners": 3.1864913823897946e-05, "evaluation_iteration": 0.12482169021904618, "synch_eval_env_connectors": 0.0001557956037626136, "synch_env_connectors": 4.372117922059261e-06}, "env_runners": {"episode_duration_sec_mean": 0.005670581168495122, "env_to_module_connector": {"timers": {"connectors": {"numpy_to_tensor": 1.3682803452567429e-05, "add_observations_from_episodes_to_batch": 3.012867398278712e-06, "batch_individual_items": 1.3434459852954922e-05, "add_time_dim_to_batch_and_zero_pad": 7.555754729977441e-06, "add_states_from_episodes_to_batch": 2.865941176381375e-06}}, "connector_pipeline_timer": 6.389682911272987e-05}, "num_env_steps_sampled": 5000.0, "episode_return_min": -11.5, "module_to_env_connector": {"timers": {"connectors": {"normalize_and_clip_actions": 8.556552136688657e-06, "un_batch_to_individual_items": 6.8903192962454765e-06, "get_actions": 4.392776408815051e-05, "remove_single_ts_time_rank_from_batch": 1.2559101868930281e-05, "listify_data_for_vector_env": 1.1162558530309455e-05, "tensor_to_numpy": 1.6250253122614223e-05}}, "connector_pipeline_timer": 0.00012734656263551546}, "env_reset_timer": 5.020545974408032e-05, "sample": 0.006054600493786606, "num_episodes_lifetime": -92125.0, "env_to_module_sum_episodes_length_out": 10.36823839457432, "env_step_timer": 1.4996181051034052e-05, "num_module_steps_sampled_lifetime": {"default_policy": -1842500.0}, "weights_seq_no": 4.0, "module_episode_returns_mean": {"default_policy": 0.09999999999999998}, "env_to_module_sum_episodes_length_in": 10.36823839457432, "episode_len_mean": 20.0, "agent_episode_returns_mean": {"default_agent": 0.09999999999999998}, "time_between_sampling": 0.03329087563201949, "num_module_steps_sampled": {"default_policy": 5000.0}, "episode_return_max": 8.5, "episode_len_min": 20, "episode_len_max": 20, "rlmodule_inference_timer": 3.4426912501097306e-05, "num_agent_steps_sampled": {"default_agent": 5000.0}, "num_episodes": 250.0, "num_env_steps_sampled_lifetime": -1842500.0, "num_agent_steps_sampled_lifetime": {"default_agent": -1842500.0}, "episode_return_mean": 0.09999999999999998, "num_env_steps_sampled_lifetime_throughput": 3036.437492144422}, "__all_modules__": {"learner_connector_sum_episodes_length_in": 5000.0, "learner_connector": {"connector_pipeline_timer": 0.15337310235453167, "timers": {"connectors": {"add_one_ts_to_episodes_and_truncate": 0.0088056663734569, "add_observations_from_episodes_to_batch": 0.0008106054301736014, "add_columns_from_episodes_to_train_batch": 0.041096465041758554, "add_time_dim_to_batch_and_zero_pad": 0.09021758209124747, "add_states_from_episodes_to_batch": 0.00361520515821465, "batch_individual_items": 0.008594920679898156, "numpy_to_tensor": 7.882913788689183e-05}}}, "learner_connector_sum_episodes_length_out": 5250.0}, "learners": {"default_policy": {"num_module_steps_trained_lifetime": 29925, "weights_seq_no": 5.0, "entropy": 0.6915451884269714, "num_module_steps_trained": 5985, "vf_loss": 0.32055026292800903, "mean_kl_loss": 5.38546264579054e-05, "num_trainable_parameters": 16595, "curr_entropy_coeff": 0.0015431216992, "module_train_batch_size_mean": 998.6075885025957, "vf_explained_var": 0.0007799267768859863, "total_loss": 0.24812345206737518, "vf_loss_unclipped": 41.57207107543945, "policy_loss": -0.0005349640268832445, "use_intrinsic_rewards": 0.0, "diff_num_grad_updates_vs_sampler_policy": 1.0, "curr_kl_coeff": 0.0050494978204369545, "num_module_steps_trained_lifetime_throughput": 653.9729757218824}, "intrinsic_reward_module": {"total_loss": 0.0, "gradients_default_optimizer_global_norm": 0.0, "num_module_steps_trained_lifetime": 29925, "num_module_steps_trained": 5985, "weights_seq_no": 5.0, "num_trainable_parameters": 8266, "curr_entropy_coeff": 0.0015431216992, "module_train_batch_size_mean": 998.6075885025957, "default_optimizer_learning_rate": 0.0002715581955, "diff_num_grad_updates_vs_sampler_policy": 1.0, "num_module_steps_trained_lifetime_throughput": 653.9816002317839}, "differentiable_learners": {"intrinsic_attention_ppo_learner": {"default_policy": {"num_module_steps_trained": 35910, "weights_seq_no": 30.0, "entropy": 0.6915634870529175, "vf_loss": 0.3207952380180359, "mean_kl_loss": 5.052302731201053e-05, "module_train_batch_size_mean": 997.7394089995611, "vf_explained_var": 0.0011254549026489258, "diff_num_grad_updates_vs_sampler_policy": 26.0, "total_loss": 0.24833914637565613, "vf_loss_unclipped": 41.54947280883789, "policy_loss": -0.0005177269340492785, "use_intrinsic_rewards": 1.0, "num_module_steps_trained_lifetime": 179550}, "intrinsic_reward_module": {"module_train_batch_size_mean": 997.7394089995611, "diff_num_grad_updates_vs_sampler_policy": 26.0, "total_loss": 0.0, "num_module_steps_trained_lifetime": 179550, "num_module_steps_trained": 35910, "weights_seq_no": 30.0}, "__all_modules__": {"num_module_steps_trained_lifetime": 359100, "num_module_steps_trained": 71820, "num_env_steps_trained": 216000, "num_env_steps_trained_lifetime": 1080000, "num_env_steps_trained_lifetime_throughput": 60396.2677591921}}}, "__all_modules__": {"num_module_steps_trained_lifetime": 59850, "num_module_steps_trained": 11970, "num_trainable_parameters": 24861, "num_env_steps_trained": 36000, "num_env_steps_trained_lifetime": 180000, "num_non_trainable_parameters": 0, "num_env_steps_trained_lifetime_throughput": 3938.116609851776, "num_module_steps_trained_throughput": 27246339.76426868, "num_module_steps_trained_lifetime_throughput": 11615387.72307582}, "IntrinsicAttentionMask": [[[0.16711632907390594, 0.1654278188943863, 0.16734129190444946, 0.16847915947437286, 0.16576196253299713, 0.16587349772453308], [0.16830633580684662, 0.1620810627937317, 0.16914871335029602, 0.17345687747001648, 0.16329941153526306, 0.16370755434036255], [0.16695548593997955, 0.1658724993467331, 0.1670994758605957, 0.16782672703266144, 0.16608712077140808, 0.16615872085094452], [0.1661340594291687, 0.1681171953678131, 0.16587312519550323, 0.164564847946167, 0.16772127151489258, 0.16758951544761658], [0.16807332634925842, 0.16274461150169373, 0.16879215836524963, 0.17246046662330627, 0.1637897938489914, 0.16413968801498413], [0.16799527406692505, 0.16296593844890594, 0.16867300868034363, 0.17212912440299988, 0.16395312547683716, 0.16428352892398834]], [[0.1656227707862854, 0.16503243148326874, 0.169860377907753, 0.1638580709695816, 0.17293435335159302, 0.16269207000732422], [0.16558623313903809, 0.1649760901927948, 0.16996809840202332, 0.16376256942749023, 0.17314903438091278, 0.1625579595565796], [0.16587893664836884, 0.1654290109872818, 0.16909752786159515, 0.16453279554843903, 0.17142027616500854, 0.16364145278930664], [0.16551293432712555, 0.1648632436990738, 0.17018349468708038, 0.16357149183750153, 0.17357894778251648, 0.16228985786437988], [0.16605837643146515, 0.16570846736431122, 0.1685553640127182, 0.16501083970069885, 0.17035074532032013, 0.16431616246700287], [0.16543933749198914, 0.1647501140832901, 0.17039881646633148, 0.16338030993938446, 0.17400957643985748, 0.16202187538146973]], [[0.16660776734352112, 0.16593420505523682, 0.16785351932048798, 0.16796645522117615, 0.16626937687397003, 0.1653687208890915], [0.16653792560100555, 0.16513948142528534, 0.16914045810699463, 0.1693774312734604, 0.16583457589149475, 0.1639701873064041], [0.16671955585479736, 0.16738879680633545, 0.1654958873987198, 0.16538584232330322, 0.16705511510372162, 0.16795483231544495], [0.16672858595848083, 0.1675196886062622, 0.16528359055519104, 0.16515374183654785, 0.1671251803636551, 0.16818924248218536], [0.16657350957393646, 0.16553565859794617, 0.16849902272224426, 0.16867396235466003, 0.16605180501937866, 0.1646661013364792], [0.1664741039276123, 0.16446782648563385, 0.17022749781608582, 0.1705705225467682, 0.1654641032218933, 0.16279596090316772]], [[0.16722966730594635, 0.16592590510845184, 0.16697005927562714, 0.16684040427207947, 0.16762283444404602, 0.165411114692688], [0.16810844838619232, 0.1647651344537735, 0.16743943095207214, 0.16710592806339264, 0.16912469267845154, 0.16345633566379547], [0.1674044281244278, 0.16569550335407257, 0.16706380248069763, 0.16689375042915344, 0.1679205745458603, 0.1650218963623047], [0.16749174892902374, 0.16558031737804413, 0.16711057722568512, 0.16692031919956207, 0.168069526553154, 0.16482752561569214], [0.16696524620056152, 0.16627410054206848, 0.16682782769203186, 0.1667591631412506, 0.16717317700386047, 0.16600050032138824], [0.16845622658729553, 0.16430425643920898, 0.16762378811836243, 0.16720910370349884, 0.1697222739458084, 0.1626843959093094]], [[0.16688744723796844, 0.1676042377948761, 0.16575634479522705, 0.16632430255413055, 0.16674914956092834, 0.1666785478591919], [0.16624613106250763, 0.1649082750082016, 0.16839133203029633, 0.16730892658233643, 0.16650615632534027, 0.16663917899131775], [0.16787777841091156, 0.17193973064422607, 0.1616283804178238, 0.16474199295043945, 0.16710323095321655, 0.16670885682106018], [0.16738389432430267, 0.16975028812885284, 0.16369643807411194, 0.16554084420204163, 0.16692999005317688, 0.16669853031635284], [0.16700997948646545, 0.16812896728515625, 0.16524966061115265, 0.16613270342350006, 0.16679438948631287, 0.1666843444108963], [0.1670723855495453, 0.1683974713087082, 0.1649911254644394, 0.16603468358516693, 0.16681727766990662, 0.16668708622455597]], [[0.16517876088619232, 0.16486966609954834, 0.16738231480121613, 0.16706909239292145, 0.17186111211776733, 0.16363908350467682], [0.16508182883262634, 0.1647530198097229, 0.16742712259292603, 0.16709363460540771, 0.17220009863376617, 0.16344431042671204], [0.16586117446422577, 0.16569234430789948, 0.16706061363220215, 0.16689056158065796, 0.16947652399539948, 0.16501875221729279], [0.16576509177684784, 0.16557635366916656, 0.16710659861564636, 0.16691634058952332, 0.16981208324432373, 0.16482359170913696], [0.16720329225063324, 0.16731777787208557, 0.16639550030231476, 0.16650943458080292, 0.16479752957820892, 0.16777649521827698], [0.1646929532289505, 0.16428552567958832, 0.16760468482971191, 0.1671900451183319, 0.17356091737747192, 0.16266585886478424]]]}, "num_training_step_calls_per_iteration": 1, "evaluation": {"env_runners": {"env_to_module_connector": {"timers": {"connectors": {"add_states_from_episodes_to_batch": 2.816301016270837e-06, "numpy_to_tensor": 1.2858716807780053e-05, "add_time_dim_to_batch_and_zero_pad": 7.168591304936521e-06, "add_observations_from_episodes_to_batch": 2.8830227477590806e-06, "batch_individual_items": 1.3050864079638228e-05}}, "connector_pipeline_timer": 6.172419596027902e-05}, "module_to_env_connector": {"timers": {"connectors": {"tensor_to_numpy": 1.6381682070055598e-05, "remove_single_ts_time_rank_from_batch": 1.256314527013959e-05, "un_batch_to_individual_items": 7.021064454846186e-06, "normalize_and_clip_actions": 8.370833139408492e-06, "get_actions": 3.84961561040317e-05, "listify_data_for_vector_env": 1.0930021022800487e-05}}, "connector_pipeline_timer": 0.00012145307583576935}, "num_env_steps_sampled": 400, "num_agent_steps_sampled_lifetime": {"default_agent": 2000}, "env_step_timer": 1.5081520903174412e-05, "episode_len_max": 20, "num_episodes_lifetime": 100, "sample": 0.1158268386729191, "weights_seq_no": 5.0, "env_to_module_sum_episodes_length_in": 10.368238387501162, "module_episode_returns_mean": {"default_policy": 0.55}, "num_env_steps_sampled_lifetime": 25400, "agent_episode_returns_mean": {"default_agent": 0.55}, "episode_duration_sec_mean": 0.005434159600408748, "episode_return_mean": 0.55, "episode_return_min": -14.5, "env_reset_timer": 0.00045491697680849236, "episode_len_mean": 20.0, "episode_return_max": 14.5, "rlmodule_inference_timer": 3.338475219975576e-05, "episode_len_min": 20, "num_episodes": 20, "env_to_module_sum_episodes_length_out": 10.368238387501162, "num_module_steps_sampled_lifetime": {"default_policy": 2000}, "num_module_steps_sampled": {"default_policy": 400}, "num_agent_steps_sampled": {"default_agent": 400}, "time_between_sampling": 9.740333240401}, "num_healthy_workers": 1, "actor_manager_num_outstanding_async_reqs": 0, "num_remote_worker_restarts": 0}, "num_env_steps_sampled_lifetime": -1842500.0, "fault_tolerance": {"num_healthy_workers": 0, "num_remote_worker_restarts": 0}, "env_runner_group": {"actor_manager_num_outstanding_async_reqs": 0}, "done": false, "training_iteration": 5, "trial_id": "b5096_00000", "date": "2025-08-11_18-45-12", "timestamp": 1754930712, "time_this_iter_s": 9.942861080169678, "time_total_s": 49.749492168426514, "pid": 11702, "hostname": "Mac", "node_ip": "127.0.0.1", "config": {"exploration_config": {}, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 2, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "env": "Umbrella", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": false, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 0, "create_local_env_runner": true, "num_envs_per_env_runner": 1, "gym_env_vectorize_mode": "SYNC", "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "episodes_to_numpy": true, "max_requests_in_flight_per_env_runner": 1, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "merge_env_runner_states": "training_only", "broadcast_env_runner_states": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "complete_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "sampler_perf_stats_ema_coef": null, "_is_online": true, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": "auto", "num_aggregator_actors_per_learner": 0, "max_requests_in_flight_per_aggregator_actor": 3, "local_gpu_idx": 0, "max_requests_in_flight_per_learner": 3, "gamma": 1, "lr": 0.0002715581955, "grad_clip": 0.5, "grad_clip_by": "global_norm", "_train_batch_size_per_learner": 5000, "train_batch_size": 4000, "num_epochs": 1, "minibatch_size": 1000, "shuffle_batch_per_epoch": true, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "log_std_clip_param": 20.0, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "_disable_preprocessor_api": false, "_disable_action_flattening": false}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {"intrinsic_reward_coeff": 0.2795015916508}, "optimizer": {}, "_learner_class": "<class 'source.intrinsic_attention_ppo.learners.IntrinsicAttentionMetaLearner.IntrinsicAttentionMetaLearner'>", "callbacks_on_algorithm_init": null, "callbacks_on_env_runners_recreated": null, "callbacks_on_offline_eval_runners_recreated": null, "callbacks_on_checkpoint_loaded": null, "callbacks_on_environment_created": null, "callbacks_on_episode_created": null, "callbacks_on_episode_start": null, "callbacks_on_episode_step": null, "callbacks_on_episode_end": null, "callbacks_on_evaluate_start": null, "callbacks_on_evaluate_end": null, "callbacks_on_evaluate_offline_start": null, "callbacks_on_evaluate_offline_end": null, "callbacks_on_sample_end": null, "callbacks_on_train_result": null, "explore": true, "enable_rl_module_and_learner": true, "enable_env_runner_and_connector_v2": true, "_prior_exploration_config": {"type": "StochasticSampling"}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x3866e5760>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "offline_data_class": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_read_batch_size": null, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "materialize_data": false, "materialize_mapped_data": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "ignore_final_observation": false, "prelearner_class": null, "prelearner_buffer_class": null, "prelearner_buffer_kwargs": {}, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_remaining_data": false, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": 1, "evaluation_duration": 20, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_auto_duration_min_env_steps_per_sample": 100, "evaluation_auto_duration_max_env_steps_per_sample": 2000, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 1, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "offline_evaluation_interval": null, "num_offline_eval_runners": 0, "offline_loss_for_module_fn": null, "offline_evaluation_duration": 1, "offline_evaluation_parallel_to_training": false, "offline_evaluation_timeout_s": 120.0, "num_cpus_per_offline_eval_runner": 1, "num_gpus_per_offline_eval_runner": 0, "custom_resources_per_offline_eval_runner": {}, "restart_failed_offline_eval_runners": true, "ignore_offline_eval_runner_failures": false, "max_num_offline_eval_runner_restarts": 1000, "offline_eval_runner_restore_timeout_s": 1800.0, "max_requests_in_flight_per_offline_eval_runner": 1, "validate_offline_eval_runners_after_construction": true, "offline_eval_runner_health_probe_timeout_s": 30.0, "offline_eval_rl_module_inference_only": false, "broadcast_offline_eval_runner_states": false, "offline_eval_batch_size_per_runner": 256, "dataset_num_iters_per_eval_runner": 1, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "log_gradients": false, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 8, "restart_failed_env_runners": true, "ignore_env_runner_failures": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30.0, "env_runner_restore_timeout_s": 1800.0, "_model_config": {}, "_rl_module_spec": "MultiRLModuleSpec(multi_rl_module_class=<class 'ray.rllib.core.rl_module.multi_rl_module.MultiRLModule'>, observation_space=None, action_space=None, inference_only=False, model_config=None, rl_module_specs={'default_policy': RLModuleSpec(module_class=<class 'source.intrinsic_attention_ppo.rl_modules.DifferentiablePPOModule.DifferentiablePPOModule'>, observation_space=None, action_space=None, inference_only=False, learner_only=False, model_config={'vf_share_layers': True, 'embedding_dim': 62, 'max_seq_len': 6, 'policy_head_hidden_sizes': [32], 'value_head_hidden_sizes': [101], 'embedding_hidden_sizes': [121]}, catalog_class=None, load_state_path=None, model_config_dict=None), 'intrinsic_reward_module': RLModuleSpec(module_class=<class 'source.intrinsic_attention_ppo.rl_modules.IntrinsicAttentionModule.IntrinsicAttentionModule'>, observation_space=None, action_space=None, inference_only=False, learner_only=True, model_config={'intrinsic_reward_network': {'encoder_hidden_sizes': [], 'encoding_dim': 1, 'num_heads': 1, 'head_hidden_sizes': None, 'layers': [{'type': 'attention'}]}, 'extrinsic_value_hidden_layers': [127, 60], 'vf_share_layers': True, 'max_seq_len': 6}, catalog_class=None, load_state_path=None, model_config_dict=None)}, load_state_path=None, modules_to_load=None, module_specs={'default_policy': RLModuleSpec(module_class=<class 'source.intrinsic_attention_ppo.rl_modules.DifferentiablePPOModule.DifferentiablePPOModule'>, observation_space=None, action_space=None, inference_only=False, learner_only=False, model_config={'vf_share_layers': True, 'embedding_dim': 62, 'max_seq_len': 6, 'policy_head_hidden_sizes': [32], 'value_head_hidden_sizes': [101], 'embedding_hidden_sizes': [121]}, catalog_class=None, load_state_path=None, model_config_dict=None), 'intrinsic_reward_module': RLModuleSpec(module_class=<class 'source.intrinsic_attention_ppo.rl_modules.IntrinsicAttentionModule.IntrinsicAttentionModule'>, observation_space=None, action_space=None, inference_only=False, learner_only=True, model_config={'intrinsic_reward_network': {'encoder_hidden_sizes': [], 'encoding_dim': 1, 'num_heads': 1, 'head_hidden_sizes': None, 'layers': [{'type': 'attention'}]}, 'extrinsic_value_hidden_layers': [127, 60], 'vf_share_layers': True, 'max_seq_len': 6}, catalog_class=None, load_state_path=None, model_config_dict=None)})", "algorithm_config_overrides_per_module": {"intrinsic_reward_module": {"lr": 0.0002715581955}}, "_per_module_overrides": {}, "_validate_config": true, "_use_msgpack_checkpoints": false, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "env_task_fn": -1, "enable_connectors": -1, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.161583927863, "kl_target": 0.0201019014258, "vf_loss_coeff": 0.7790510010087, "entropy_coeff": 0.0015431216992, "clip_param": 0.2459212356676, "vf_clip_param": 0.3769744131561, "entropy_coeff_schedule": null, "lr_schedule": null, "sgd_minibatch_size": -1, "vf_share_layers": -1, "differentiable_learner_configs": ["DifferentiableLearnerConfig(learner_class=<class 'source.intrinsic_attention_ppo.learners.IntrinsicAttentionPPOLearner.IntrinsicAttentionPPOLearner'>, learner_connector=None, add_default_connectors_to_learner_pipeline=True, is_multi_agent=False, policies_to_update=['default_policy'], lr=0.0060984166342, num_total_minibatches=0, num_epochs=1, minibatch_size=1000, shuffle_batch_per_epoch=True)"], "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9485408017724, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.callbacks.callbacks.RLlibCallback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 49.749492168426514, "iterations_since_restore": 5, "perf": {"cpu_util_percent": 39.642857142857146, "ram_util_percent": 82.04285714285716}}
{"timers": {"training_iteration": 10.270735409468994, "restore_env_runners": 1.1374132308217455e-05, "training_step": 10.270574930967971, "env_runner_sampling_timer": 1.6601144470483067, "learner_update_timer": 8.419084088997364, "synch_weights": 0.0013293198110524726, "restore_eval_env_runners": 3.196043431196944e-05, "evaluation_iteration": 0.12490576415649242, "synch_eval_env_connectors": 0.0001558980573412939, "synch_env_connectors": 4.3742271267354956e-06}, "env_runners": {"episode_duration_sec_mean": 0.005463784324470909, "env_to_module_connector": {"timers": {"connectors": {"numpy_to_tensor": 1.3288511551341702e-05, "add_observations_from_episodes_to_batch": 2.9133790147289166e-06, "batch_individual_items": 1.2838777787104721e-05, "add_time_dim_to_batch_and_zero_pad": 7.213619786449916e-06, "add_states_from_episodes_to_batch": 2.7763640894533145e-06}}, "connector_pipeline_timer": 6.170600326147152e-05}, "num_env_steps_sampled": 5000.0, "episode_return_min": -11.5, "module_to_env_connector": {"timers": {"connectors": {"normalize_and_clip_actions": 8.35062421074673e-06, "un_batch_to_individual_items": 6.69014298817405e-06, "get_actions": 4.133066990835766e-05, "remove_single_ts_time_rank_from_batch": 1.229637348808851e-05, "listify_data_for_vector_env": 1.0896107557543811e-05, "tensor_to_numpy": 1.565136936777789e-05}}, "connector_pipeline_timer": 0.00012254452302699328}, "env_reset_timer": 4.481190892133043e-05, "sample": 0.005804127025272655, "num_episodes_lifetime": -123000.0, "env_to_module_sum_episodes_length_out": 10.36823839457432, "env_step_timer": 1.4420138849428375e-05, "num_module_steps_sampled_lifetime": {"default_policy": -2460000.0}, "weights_seq_no": 5.0, "module_episode_returns_mean": {"default_policy": -0.14000000000000007}, "env_to_module_sum_episodes_length_in": 10.36823839457432, "episode_len_mean": 20.0, "agent_episode_returns_mean": {"default_agent": -0.14000000000000007}, "time_between_sampling": 0.03370425847075195, "num_module_steps_sampled": {"default_policy": 5000.0}, "episode_return_max": 8.5, "episode_len_min": 20, "episode_len_max": 20, "rlmodule_inference_timer": 3.274500972228792e-05, "num_agent_steps_sampled": {"default_agent": 5000.0}, "num_episodes": 250.0, "num_env_steps_sampled_lifetime": -2460000.0, "num_agent_steps_sampled_lifetime": {"default_agent": -2460000.0}, "episode_return_mean": -0.14000000000000007, "num_env_steps_sampled_lifetime_throughput": 3167.558432403409}, "__all_modules__": {"learner_connector_sum_episodes_length_in": 5000.0, "learner_connector": {"connector_pipeline_timer": 0.15335922300042268, "timers": {"connectors": {"add_one_ts_to_episodes_and_truncate": 0.0088062576291965, "add_observations_from_episodes_to_batch": 0.0008108502054657027, "add_columns_from_episodes_to_train_batch": 0.04110276123210896, "add_time_dim_to_batch_and_zero_pad": 0.09020625669044492, "add_states_from_episodes_to_batch": 0.0036165468566198376, "batch_individual_items": 0.00858403939277816, "numpy_to_tensor": 7.890376693199255e-05}}}, "learner_connector_sum_episodes_length_out": 5250.0}, "learners": {"default_policy": {"num_module_steps_trained_lifetime": 35910, "weights_seq_no": 6.0, "entropy": 0.6912329196929932, "num_module_steps_trained": 5985, "vf_loss": 0.32051414251327515, "mean_kl_loss": 1.7154865417978726e-05, "num_trainable_parameters": 16595, "curr_entropy_coeff": 0.0015431216992, "module_train_batch_size_mean": 998.5423314844973, "vf_explained_var": 4.488229751586914e-05, "total_loss": 0.248580664396286, "vf_loss_unclipped": 41.86684036254883, "policy_loss": -4.964991603628732e-05, "use_intrinsic_rewards": 0.0, "diff_num_grad_updates_vs_sampler_policy": 1.0, "curr_kl_coeff": 0.0025247489102184772, "num_module_steps_trained_lifetime_throughput": 655.7001716144733}, "intrinsic_reward_module": {"total_loss": 0.0, "gradients_default_optimizer_global_norm": 0.0, "num_module_steps_trained_lifetime": 35910, "num_module_steps_trained": 5985, "weights_seq_no": 6.0, "num_trainable_parameters": 8266, "curr_entropy_coeff": 0.0015431216992, "module_train_batch_size_mean": 998.5423314844973, "default_optimizer_learning_rate": 0.0002715581955, "diff_num_grad_updates_vs_sampler_policy": 1.0, "num_module_steps_trained_lifetime_throughput": 655.7083924051017}, "differentiable_learners": {"intrinsic_attention_ppo_learner": {"default_policy": {"num_module_steps_trained": 35910, "weights_seq_no": 36.0, "entropy": 0.6912336349487305, "vf_loss": 0.3207402527332306, "mean_kl_loss": 1.706982948235236e-05, "module_train_batch_size_mean": 997.6644392492373, "vf_explained_var": 0.0010883212089538574, "diff_num_grad_updates_vs_sampler_policy": 31.0, "total_loss": 0.24876044690608978, "vf_loss_unclipped": 41.834686279296875, "policy_loss": -4.869674376095645e-05, "use_intrinsic_rewards": 1.0, "num_module_steps_trained_lifetime": 215460}, "intrinsic_reward_module": {"module_train_batch_size_mean": 997.6644392492373, "diff_num_grad_updates_vs_sampler_policy": 31.0, "total_loss": 0.0, "num_module_steps_trained_lifetime": 215460, "num_module_steps_trained": 35910, "weights_seq_no": 36.0}, "__all_modules__": {"num_module_steps_trained_lifetime": 430920, "num_module_steps_trained": 71820, "num_env_steps_trained": 216000, "num_env_steps_trained_lifetime": 1296000, "num_env_steps_trained_lifetime_throughput": 59435.88332299955}}}, "__all_modules__": {"num_module_steps_trained_lifetime": 71820, "num_module_steps_trained": 11970, "num_trainable_parameters": 24861, "num_env_steps_trained": 36000, "num_env_steps_trained_lifetime": 216000, "num_non_trainable_parameters": 0, "num_env_steps_trained_lifetime_throughput": 3948.3633180059683, "num_module_steps_trained_throughput": 26505594.731768955, "num_module_steps_trained_lifetime_throughput": 11631902.31521874}, "IntrinsicAttentionMask": [[[0.16694894433021545, 0.16627401113510132, 0.16717366874217987, 0.16728615760803223, 0.16660985350608826, 0.16570736467838287], [0.16725274920463562, 0.16584832966327667, 0.16772174835205078, 0.16795673966407776, 0.16654640436172485, 0.16467399895191193], [0.16684770584106445, 0.16641512513160706, 0.16699160635471344, 0.16706359386444092, 0.16663044691085815, 0.1660514622926712], [0.16679704189300537, 0.16648565232753754, 0.16690057516098022, 0.16695235669612885, 0.16664068400859833, 0.16622371971607208], [0.16710162162780762, 0.16606047749519348, 0.16744878888130188, 0.1676226407289505, 0.1665782481431961, 0.16518816351890564], [0.1675075739622116, 0.1654888391494751, 0.1681833565235138, 0.16852226853370667, 0.1664913147687912, 0.16380660235881805]], [[0.16652469336986542, 0.16593115031719208, 0.16533970832824707, 0.1647503823041916, 0.173876091837883, 0.16357801854610443], [0.16651871800422668, 0.16590516269207, 0.1652938425540924, 0.16468478739261627, 0.1741241216659546, 0.16347339749336243], [0.16651268303394318, 0.16587910056114197, 0.16524791717529297, 0.16461914777755737, 0.17437241971492767, 0.16336877644062042], [0.1665065437555313, 0.16585294902324677, 0.16520191729068756, 0.1645534485578537, 0.17462098598480225, 0.16326412558555603], [0.16659080982208252, 0.16623976826667786, 0.16588947176933289, 0.1655399203300476, 0.17089694738388062, 0.16484300792217255], [0.16649407148361206, 0.16580048203468323, 0.1651097536087036, 0.1644219160079956, 0.17511896789073944, 0.16305483877658844]], [[0.16694848239421844, 0.16526168584823608, 0.16717320680618286, 0.16728569567203522, 0.16660939157009125, 0.16672149300575256], [0.1677013784646988, 0.16149848699569702, 0.16854073107242584, 0.16896197199821472, 0.1664406806230545, 0.16685669124126434], [0.16684752702713013, 0.16576524078845978, 0.1669914275407791, 0.1670634150505066, 0.16663026809692383, 0.16670212149620056], [0.16679693758487701, 0.16601745784282684, 0.16690047085285187, 0.1669522523880005, 0.16664057970046997, 0.16669228672981262], [0.16710054874420166, 0.1645028442144394, 0.16744771599769592, 0.16762156784534454, 0.16657719016075134, 0.16675014793872833], [0.1670503169298172, 0.16475357115268707, 0.167356938123703, 0.16751046478748322, 0.1665879189968109, 0.16674073040485382]], [[0.16762275993824005, 0.1663159281015396, 0.16618677973747253, 0.16605772078037262, 0.16801685094833374, 0.16579993069171906], [0.16912302374839783, 0.16575954854488373, 0.16542938351631165, 0.1650998741388321, 0.1701454073190689, 0.16444283723831177], [0.1692720651626587, 0.16570384800434113, 0.16535381972789764, 0.16500453650951385, 0.17035754024982452, 0.16430817544460297], [0.16942116618156433, 0.16564808785915375, 0.16527822613716125, 0.16490918397903442, 0.17056986689567566, 0.16417355835437775], [0.16717323660850525, 0.16648122668266296, 0.16641269624233246, 0.16634419560432434, 0.1673814207315445, 0.16620728373527527], [0.16971942782402039, 0.1655362993478775, 0.16512680053710938, 0.16471828520298004, 0.17099496722221375, 0.1639043241739273]], [[0.1666073203086853, 0.16492396593093872, 0.16785305738449097, 0.16796599328517914, 0.16626891493797302, 0.16638077795505524], [0.16641448438167572, 0.1602591872215271, 0.17107953131198883, 0.1715071201324463, 0.16516345739364624, 0.1655762642621994], [0.16671910881996155, 0.168401837348938, 0.16549544036388397, 0.1653853952884674, 0.1670546531677246, 0.16694357991218567], [0.1667279601097107, 0.16871817409992218, 0.1652829647064209, 0.1651531159877777, 0.16712453961372375, 0.16699324548244476], [0.1665724217891693, 0.16398294270038605, 0.16849792003631592, 0.1686728596687317, 0.1660507321357727, 0.16622312366962433], [0.16658417880535126, 0.16429387032985687, 0.16828453540802002, 0.16843891143798828, 0.16612307727336884, 0.16627547144889832]], [[0.16612865030765533, 0.16581778228282928, 0.1655074805021286, 0.16802985966205597, 0.16993612051010132, 0.1645801067352295], [0.16609333455562592, 0.1657625138759613, 0.16543234884738922, 0.1681174635887146, 0.17014846205711365, 0.16444578766822815], [0.1660580039024353, 0.16570723056793213, 0.16535720229148865, 0.16820508241653442, 0.17036102712154388, 0.16431154310703278], [0.16634149849414825, 0.16615211963653564, 0.16596294939517975, 0.16749674081802368, 0.16864992678165436, 0.16539672017097473], [0.1665498912334442, 0.16648134589195251, 0.166412815451622, 0.1669670045375824, 0.16738153994083405, 0.16620740294456482], [0.16595147550106049, 0.1655409187078476, 0.16513140499591827, 0.16846764087677002, 0.17099973559379578, 0.16390888392925262]]]}, "num_training_step_calls_per_iteration": 1, "evaluation": {"env_runners": {"env_to_module_connector": {"timers": {"connectors": {"add_states_from_episodes_to_batch": 2.6885914581965202e-06, "numpy_to_tensor": 1.1844628010629957e-05, "add_time_dim_to_batch_and_zero_pad": 6.711770949128081e-06, "add_observations_from_episodes_to_batch": 2.7186347170656753e-06, "batch_individual_items": 1.2175904497728648e-05}}, "connector_pipeline_timer": 5.80067578133436e-05}, "module_to_env_connector": {"timers": {"connectors": {"tensor_to_numpy": 1.4667688574186876e-05, "remove_single_ts_time_rank_from_batch": 1.1888070487843783e-05, "un_batch_to_individual_items": 6.474433006540799e-06, "normalize_and_clip_actions": 7.963856414910556e-06, "get_actions": 3.5441269663733524e-05, "listify_data_for_vector_env": 1.0271469646734465e-05}}, "connector_pipeline_timer": 0.00011285364714381773}, "num_env_steps_sampled": 400, "num_agent_steps_sampled_lifetime": {"default_agent": 2400}, "env_step_timer": 1.38482786561428e-05, "episode_len_max": 20, "num_episodes_lifetime": 120, "sample": 0.11580826237640879, "weights_seq_no": 6.0, "env_to_module_sum_episodes_length_in": 10.368238394470474, "module_episode_returns_mean": {"default_policy": 1.15}, "num_env_steps_sampled_lifetime": 30400, "agent_episode_returns_mean": {"default_agent": 1.15}, "episode_duration_sec_mean": 0.005418447491247207, "episode_return_mean": 1.15, "episode_return_min": -14.5, "env_reset_timer": 0.00045355697684217906, "episode_len_mean": 20.0, "episode_return_max": 14.5, "rlmodule_inference_timer": 3.019292167455257e-05, "episode_len_min": 20, "num_episodes": 20, "env_to_module_sum_episodes_length_out": 10.368238394470474, "num_module_steps_sampled_lifetime": {"default_policy": 2400}, "num_module_steps_sampled": {"default_policy": 400}, "num_agent_steps_sampled": {"default_agent": 400}, "time_between_sampling": 9.73911549882669}, "num_healthy_workers": 1, "actor_manager_num_outstanding_async_reqs": 0, "num_remote_worker_restarts": 0}, "num_env_steps_sampled_lifetime": -2460000.0, "fault_tolerance": {"num_healthy_workers": 0, "num_remote_worker_restarts": 0}, "env_runner_group": {"actor_manager_num_outstanding_async_reqs": 0}, "done": false, "training_iteration": 6, "trial_id": "b5096_00000", "date": "2025-08-11_18-45-22", "timestamp": 1754930722, "time_this_iter_s": 9.712769985198975, "time_total_s": 59.46226215362549, "pid": 11702, "hostname": "Mac", "node_ip": "127.0.0.1", "config": {"exploration_config": {}, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 2, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "env": "Umbrella", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": false, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 0, "create_local_env_runner": true, "num_envs_per_env_runner": 1, "gym_env_vectorize_mode": "SYNC", "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "episodes_to_numpy": true, "max_requests_in_flight_per_env_runner": 1, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "merge_env_runner_states": "training_only", "broadcast_env_runner_states": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "complete_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "sampler_perf_stats_ema_coef": null, "_is_online": true, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": "auto", "num_aggregator_actors_per_learner": 0, "max_requests_in_flight_per_aggregator_actor": 3, "local_gpu_idx": 0, "max_requests_in_flight_per_learner": 3, "gamma": 1, "lr": 0.0002715581955, "grad_clip": 0.5, "grad_clip_by": "global_norm", "_train_batch_size_per_learner": 5000, "train_batch_size": 4000, "num_epochs": 1, "minibatch_size": 1000, "shuffle_batch_per_epoch": true, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "log_std_clip_param": 20.0, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "_disable_preprocessor_api": false, "_disable_action_flattening": false}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {"intrinsic_reward_coeff": 0.2795015916508}, "optimizer": {}, "_learner_class": "<class 'source.intrinsic_attention_ppo.learners.IntrinsicAttentionMetaLearner.IntrinsicAttentionMetaLearner'>", "callbacks_on_algorithm_init": null, "callbacks_on_env_runners_recreated": null, "callbacks_on_offline_eval_runners_recreated": null, "callbacks_on_checkpoint_loaded": null, "callbacks_on_environment_created": null, "callbacks_on_episode_created": null, "callbacks_on_episode_start": null, "callbacks_on_episode_step": null, "callbacks_on_episode_end": null, "callbacks_on_evaluate_start": null, "callbacks_on_evaluate_end": null, "callbacks_on_evaluate_offline_start": null, "callbacks_on_evaluate_offline_end": null, "callbacks_on_sample_end": null, "callbacks_on_train_result": null, "explore": true, "enable_rl_module_and_learner": true, "enable_env_runner_and_connector_v2": true, "_prior_exploration_config": {"type": "StochasticSampling"}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x3866e5760>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "offline_data_class": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_read_batch_size": null, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "materialize_data": false, "materialize_mapped_data": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "ignore_final_observation": false, "prelearner_class": null, "prelearner_buffer_class": null, "prelearner_buffer_kwargs": {}, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_remaining_data": false, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": 1, "evaluation_duration": 20, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_auto_duration_min_env_steps_per_sample": 100, "evaluation_auto_duration_max_env_steps_per_sample": 2000, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 1, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "offline_evaluation_interval": null, "num_offline_eval_runners": 0, "offline_loss_for_module_fn": null, "offline_evaluation_duration": 1, "offline_evaluation_parallel_to_training": false, "offline_evaluation_timeout_s": 120.0, "num_cpus_per_offline_eval_runner": 1, "num_gpus_per_offline_eval_runner": 0, "custom_resources_per_offline_eval_runner": {}, "restart_failed_offline_eval_runners": true, "ignore_offline_eval_runner_failures": false, "max_num_offline_eval_runner_restarts": 1000, "offline_eval_runner_restore_timeout_s": 1800.0, "max_requests_in_flight_per_offline_eval_runner": 1, "validate_offline_eval_runners_after_construction": true, "offline_eval_runner_health_probe_timeout_s": 30.0, "offline_eval_rl_module_inference_only": false, "broadcast_offline_eval_runner_states": false, "offline_eval_batch_size_per_runner": 256, "dataset_num_iters_per_eval_runner": 1, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "log_gradients": false, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 8, "restart_failed_env_runners": true, "ignore_env_runner_failures": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30.0, "env_runner_restore_timeout_s": 1800.0, "_model_config": {}, "_rl_module_spec": "MultiRLModuleSpec(multi_rl_module_class=<class 'ray.rllib.core.rl_module.multi_rl_module.MultiRLModule'>, observation_space=None, action_space=None, inference_only=False, model_config=None, rl_module_specs={'default_policy': RLModuleSpec(module_class=<class 'source.intrinsic_attention_ppo.rl_modules.DifferentiablePPOModule.DifferentiablePPOModule'>, observation_space=None, action_space=None, inference_only=False, learner_only=False, model_config={'vf_share_layers': True, 'embedding_dim': 62, 'max_seq_len': 6, 'policy_head_hidden_sizes': [32], 'value_head_hidden_sizes': [101], 'embedding_hidden_sizes': [121]}, catalog_class=None, load_state_path=None, model_config_dict=None), 'intrinsic_reward_module': RLModuleSpec(module_class=<class 'source.intrinsic_attention_ppo.rl_modules.IntrinsicAttentionModule.IntrinsicAttentionModule'>, observation_space=None, action_space=None, inference_only=False, learner_only=True, model_config={'intrinsic_reward_network': {'encoder_hidden_sizes': [], 'encoding_dim': 1, 'num_heads': 1, 'head_hidden_sizes': None, 'layers': [{'type': 'attention'}]}, 'extrinsic_value_hidden_layers': [127, 60], 'vf_share_layers': True, 'max_seq_len': 6}, catalog_class=None, load_state_path=None, model_config_dict=None)}, load_state_path=None, modules_to_load=None, module_specs={'default_policy': RLModuleSpec(module_class=<class 'source.intrinsic_attention_ppo.rl_modules.DifferentiablePPOModule.DifferentiablePPOModule'>, observation_space=None, action_space=None, inference_only=False, learner_only=False, model_config={'vf_share_layers': True, 'embedding_dim': 62, 'max_seq_len': 6, 'policy_head_hidden_sizes': [32], 'value_head_hidden_sizes': [101], 'embedding_hidden_sizes': [121]}, catalog_class=None, load_state_path=None, model_config_dict=None), 'intrinsic_reward_module': RLModuleSpec(module_class=<class 'source.intrinsic_attention_ppo.rl_modules.IntrinsicAttentionModule.IntrinsicAttentionModule'>, observation_space=None, action_space=None, inference_only=False, learner_only=True, model_config={'intrinsic_reward_network': {'encoder_hidden_sizes': [], 'encoding_dim': 1, 'num_heads': 1, 'head_hidden_sizes': None, 'layers': [{'type': 'attention'}]}, 'extrinsic_value_hidden_layers': [127, 60], 'vf_share_layers': True, 'max_seq_len': 6}, catalog_class=None, load_state_path=None, model_config_dict=None)})", "algorithm_config_overrides_per_module": {"intrinsic_reward_module": {"lr": 0.0002715581955}}, "_per_module_overrides": {}, "_validate_config": true, "_use_msgpack_checkpoints": false, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "env_task_fn": -1, "enable_connectors": -1, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.161583927863, "kl_target": 0.0201019014258, "vf_loss_coeff": 0.7790510010087, "entropy_coeff": 0.0015431216992, "clip_param": 0.2459212356676, "vf_clip_param": 0.3769744131561, "entropy_coeff_schedule": null, "lr_schedule": null, "sgd_minibatch_size": -1, "vf_share_layers": -1, "differentiable_learner_configs": ["DifferentiableLearnerConfig(learner_class=<class 'source.intrinsic_attention_ppo.learners.IntrinsicAttentionPPOLearner.IntrinsicAttentionPPOLearner'>, learner_connector=None, add_default_connectors_to_learner_pipeline=True, is_multi_agent=False, policies_to_update=['default_policy'], lr=0.0060984166342, num_total_minibatches=0, num_epochs=1, minibatch_size=1000, shuffle_batch_per_epoch=True)"], "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9485408017724, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.callbacks.callbacks.RLlibCallback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 59.46226215362549, "iterations_since_restore": 6, "perf": {"cpu_util_percent": 37.521428571428565, "ram_util_percent": 82.55714285714285}}
{"timers": {"training_iteration": 10.262270874544772, "restore_env_runners": 1.1337890993181907e-05, "training_step": 10.2621094754079, "env_runner_sampling_timer": 1.658897521747906, "learner_update_timer": 8.411740717697528, "synch_weights": 0.0013248782833691958, "restore_eval_env_runners": 3.204792037943992e-05, "evaluation_iteration": 0.12487871234484103, "synch_eval_env_connectors": 0.00015602574735248508, "synch_env_connectors": 4.372154555762874e-06}, "env_runners": {"episode_duration_sec_mean": 0.005282325496897103, "env_to_module_connector": {"timers": {"connectors": {"numpy_to_tensor": 1.256612701920393e-05, "add_observations_from_episodes_to_batch": 2.811117481536999e-06, "batch_individual_items": 1.267574688199027e-05, "add_time_dim_to_batch_and_zero_pad": 7.0314317071727524e-06, "add_states_from_episodes_to_batch": 2.709512346026754e-06}}, "connector_pipeline_timer": 5.988816305788473e-05}, "num_env_steps_sampled": 5000.0, "episode_return_min": -11.5, "module_to_env_connector": {"timers": {"connectors": {"normalize_and_clip_actions": 8.135216171144696e-06, "un_batch_to_individual_items": 6.541883394411193e-06, "get_actions": 3.9316696783114945e-05, "remove_single_ts_time_rank_from_batch": 1.1967197958596434e-05, "listify_data_for_vector_env": 1.0590437003648348e-05, "tensor_to_numpy": 1.521640152840833e-05}}, "connector_pipeline_timer": 0.00011822212580826838}, "env_reset_timer": 4.39623561969498e-05, "sample": 0.005763742540162113, "num_episodes_lifetime": -153875.0, "env_to_module_sum_episodes_length_out": 10.36823839457432, "env_step_timer": 1.3918445064317751e-05, "num_module_steps_sampled_lifetime": {"default_policy": -3077500.0}, "weights_seq_no": 6.0, "module_episode_returns_mean": {"default_policy": -1.0999999999999996}, "env_to_module_sum_episodes_length_in": 10.36823839457432, "episode_len_mean": 20.0, "agent_episode_returns_mean": {"default_agent": -1.0999999999999996}, "time_between_sampling": 0.03310085596224909, "num_module_steps_sampled": {"default_policy": 5000.0}, "episode_return_max": 8.5, "episode_len_min": 20, "episode_len_max": 20, "rlmodule_inference_timer": 3.1728576799670864e-05, "num_agent_steps_sampled": {"default_agent": 5000.0}, "num_episodes": 250.0, "num_env_steps_sampled_lifetime": -3077500.0, "num_agent_steps_sampled_lifetime": {"default_agent": -3077500.0}, "episode_return_mean": -1.0999999999999996, "num_env_steps_sampled_lifetime_throughput": 3232.9315070380508}, "__all_modules__": {"learner_connector_sum_episodes_length_in": 5000.0, "learner_connector": {"connector_pipeline_timer": 0.15334967077093165, "timers": {"connectors": {"add_one_ts_to_episodes_and_truncate": 0.008806138802872497, "add_observations_from_episodes_to_batch": 0.0008118233732613207, "add_columns_from_episodes_to_train_batch": 0.04110669319972689, "add_time_dim_to_batch_and_zero_pad": 0.09019590329407755, "add_states_from_episodes_to_batch": 0.003624233047919689, "batch_individual_items": 0.008572590658432412, "numpy_to_tensor": 7.889555942245599e-05}}}, "learner_connector_sum_episodes_length_out": 5250.0}, "learners": {"default_policy": {"num_module_steps_trained_lifetime": 41895, "weights_seq_no": 7.0, "entropy": 0.6906840205192566, "num_module_steps_trained": 5985, "vf_loss": 0.32051384449005127, "mean_kl_loss": 2.930186383309774e-05, "num_trainable_parameters": 16595, "curr_entropy_coeff": 0.0015431216992, "module_train_batch_size_mean": 998.4808932973482, "vf_explained_var": -0.0005594491958618164, "total_loss": 0.24808192253112793, "vf_loss_unclipped": 41.515472412109375, "policy_loss": -0.0005489643081091344, "use_intrinsic_rewards": 0.0, "diff_num_grad_updates_vs_sampler_policy": 1.0, "curr_kl_coeff": 0.0012623744551092386, "num_module_steps_trained_lifetime_throughput": 657.6470901273776}, "intrinsic_reward_module": {"total_loss": 0.0, "gradients_default_optimizer_global_norm": 0.0, "num_module_steps_trained_lifetime": 41895, "num_module_steps_trained": 5985, "weights_seq_no": 7.0, "num_trainable_parameters": 8266, "curr_entropy_coeff": 0.0015431216992, "module_train_batch_size_mean": 998.4808932973482, "default_optimizer_learning_rate": 0.0002715581955, "diff_num_grad_updates_vs_sampler_policy": 1.0, "num_module_steps_trained_lifetime_throughput": 657.6549086577093}, "differentiable_learners": {"intrinsic_attention_ppo_learner": {"default_policy": {"num_module_steps_trained": 35910, "weights_seq_no": 42.0, "entropy": 0.6907122135162354, "vf_loss": 0.32070547342300415, "mean_kl_loss": 2.6291148969903588e-05, "module_train_batch_size_mean": 997.6122293241576, "vf_explained_var": 0.0009153485298156738, "diff_num_grad_updates_vs_sampler_policy": 36.0, "total_loss": 0.24826230108737946, "vf_loss_unclipped": 41.43526840209961, "policy_loss": -0.0005220300517976284, "use_intrinsic_rewards": 1.0, "num_module_steps_trained_lifetime": 251370}, "intrinsic_reward_module": {"module_train_batch_size_mean": 997.6122293241576, "diff_num_grad_updates_vs_sampler_policy": 36.0, "total_loss": 0.0, "num_module_steps_trained_lifetime": 251370, "num_module_steps_trained": 35910, "weights_seq_no": 42.0}, "__all_modules__": {"num_module_steps_trained_lifetime": 502740, "num_module_steps_trained": 71820, "num_env_steps_trained": 216000, "num_env_steps_trained_lifetime": 1512000, "num_env_steps_trained_lifetime_throughput": 58447.05263938243}}}, "__all_modules__": {"num_module_steps_trained_lifetime": 83790, "num_module_steps_trained": 11970, "num_trainable_parameters": 24861, "num_env_steps_trained": 36000, "num_env_steps_trained_lifetime": 252000, "num_non_trainable_parameters": 0, "num_env_steps_trained_lifetime_throughput": 3959.927043619581, "num_module_steps_trained_throughput": 25797595.158827316, "num_module_steps_trained_lifetime_throughput": 11659377.556509526}, "IntrinsicAttentionMask": [[[0.16667340695858002, 0.16738927364349365, 0.16554374992847443, 0.16611096262931824, 0.16717669367790222, 0.16710589826107025], [0.1666470170021057, 0.1653059422969818, 0.16879738867282867, 0.16771237552165985, 0.1657024323940277, 0.16583479940891266], [0.16667184233665466, 0.17070460319519043, 0.16046732664108276, 0.16355857253074646, 0.16949884593486786, 0.16909880936145782], [0.166679248213768, 0.16903568804264069, 0.16300733387470245, 0.16484396159648895, 0.16833356022834778, 0.16810016334056854], [0.16665707528591156, 0.1659231334924698, 0.16782833635807037, 0.16723820567131042, 0.16614040732383728, 0.16621290147304535], [0.16665998101234436, 0.1661289483308792, 0.1675061136484146, 0.16708000004291534, 0.16628621518611908, 0.16633868217468262]], [[0.16612687706947327, 0.16865868866443634, 0.16550573706626892, 0.165196031332016, 0.16993431746959686, 0.1645783632993698], [0.16641058027744293, 0.1676212102174759, 0.16611211001873016, 0.1659630686044693, 0.16822758316993713, 0.165665403008461], [0.16605573892593384, 0.16891565918922424, 0.16535493731498718, 0.1650056540966034, 0.17035870254039764, 0.1643092930316925], [0.16602003574371338, 0.1690441370010376, 0.16527946293354034, 0.16491040587425232, 0.17057114839553833, 0.16417478024959564], [0.16654980182647705, 0.16710445284843445, 0.16641272604465485, 0.16634422540664673, 0.16738145053386688, 0.16620731353759766], [0.16594837605953217, 0.1693011224269867, 0.16512832045555115, 0.16471980512142181, 0.1709965467453003, 0.16390582919120789]], [[0.16694527864456177, 0.1652585119009018, 0.1681935340166092, 0.16830670833587646, 0.16559231281280518, 0.16570371389389038], [0.1676565706729889, 0.16145533323287964, 0.17235644161701202, 0.17278721928596497, 0.16266897320747375, 0.1630755364894867], [0.16638264060020447, 0.1680619716644287, 0.16516144573688507, 0.1650516241788864, 0.16772694885730743, 0.16761542856693268], [0.16633014380931854, 0.16831561923027039, 0.16488860547542572, 0.1647590696811676, 0.16791923344135284, 0.1677873134613037], [0.16752038896083832, 0.16220921277999878, 0.17152667045593262, 0.17189309000968933, 0.16325095295906067, 0.16359968483448029], [0.1674744337797165, 0.16246071457862854, 0.1712503731250763, 0.1715954691171646, 0.16344483196735382, 0.16377419233322144]], [[0.1668359786272049, 0.16670642793178558, 0.16657696664333344, 0.16644762456417084, 0.16841134428977966, 0.16502170264720917], [0.16686178743839264, 0.16671207547187805, 0.1665624976158142, 0.1664130538702011, 0.1686837077140808, 0.16476686298847198], [0.16688747704029083, 0.16671760380268097, 0.16654790937900543, 0.16637837886810303, 0.16895639896392822, 0.16451230645179749], [0.1669130027294159, 0.16672296822071075, 0.16653315722942352, 0.1663435399532318, 0.16922935843467712, 0.1642579883337021], [0.16651280224323273, 0.16662681102752686, 0.16674090921878815, 0.1668550670146942, 0.16513963043689728, 0.16812476515769958], [0.1671866625547409, 0.16677306592464447, 0.1663604974746704, 0.16594892740249634, 0.17227250337600708, 0.1614583283662796]], [[0.1667809784412384, 0.16749730706214905, 0.1662885993719101, 0.16621817648410797, 0.16664277017116547, 0.1665721982717514], [0.16644851863384247, 0.1651090383529663, 0.16737890243530273, 0.16751261055469513, 0.16670887172222137, 0.1668420433998108], [0.16700556874275208, 0.16915975511074066, 0.16553550958633423, 0.16532596945762634, 0.1665920615196228, 0.16638116538524628], [0.16703744232654572, 0.1693989336490631, 0.165427565574646, 0.1651982069015503, 0.16658446192741394, 0.1663534939289093], [0.16684433817863464, 0.1679622083902359, 0.16607750952243805, 0.1659679263830185, 0.16662895679473877, 0.16651903092861176], [0.16687661409378052, 0.16820013523101807, 0.1659696400165558, 0.16584010422229767, 0.16662180423736572, 0.16649176180362701]], [[0.16517876088619232, 0.16486966609954834, 0.16738231480121613, 0.16706909239292145, 0.17186111211776733, 0.16363908350467682], [0.16508182883262634, 0.1647530198097229, 0.16742712259292603, 0.16709363460540771, 0.17220009863376617, 0.16344431042671204], [0.16586117446422577, 0.16569234430789948, 0.16706061363220215, 0.16689056158065796, 0.16947652399539948, 0.16501875221729279], [0.16576509177684784, 0.16557635366916656, 0.16710659861564636, 0.16691632568836212, 0.16981208324432373, 0.16482359170913696], [0.16720329225063324, 0.16731777787208557, 0.16639550030231476, 0.16650943458080292, 0.16479754447937012, 0.16777649521827698], [0.1646929681301117, 0.1642855405807495, 0.16760468482971191, 0.1671900451183319, 0.17356091737747192, 0.16266585886478424]]]}, "num_training_step_calls_per_iteration": 1, "evaluation": {"env_runners": {"env_to_module_connector": {"timers": {"connectors": {"add_states_from_episodes_to_batch": 2.7121631795815965e-06, "numpy_to_tensor": 1.2449831732316777e-05, "add_time_dim_to_batch_and_zero_pad": 6.8861770735332136e-06, "add_observations_from_episodes_to_batch": 2.8415538084805504e-06, "batch_individual_items": 1.2613767256882373e-05}}, "connector_pipeline_timer": 5.9697130296914264e-05}, "module_to_env_connector": {"timers": {"connectors": {"tensor_to_numpy": 1.5356182423345215e-05, "remove_single_ts_time_rank_from_batch": 1.2010733065474268e-05, "un_batch_to_individual_items": 6.702506141683097e-06, "normalize_and_clip_actions": 8.056049190371778e-06, "get_actions": 3.7559167883145866e-05, "listify_data_for_vector_env": 1.0561878139886349e-05}}, "connector_pipeline_timer": 0.00011749549107511902}, "num_env_steps_sampled": 400, "num_agent_steps_sampled_lifetime": {"default_agent": 2800}, "env_step_timer": 1.4448160235147399e-05, "episode_len_max": 20, "num_episodes_lifetime": 140, "sample": 0.11584105766218397, "weights_seq_no": 7.0, "env_to_module_sum_episodes_length_in": 10.368238394572801, "module_episode_returns_mean": {"default_policy": 0.35}, "num_env_steps_sampled_lifetime": 35400, "agent_episode_returns_mean": {"default_agent": 0.35}, "episode_duration_sec_mean": 0.005445542904781177, "episode_return_mean": 0.35, "episode_return_min": -14.5, "env_reset_timer": 0.0004498539070099803, "episode_len_mean": 20.0, "episode_return_max": 14.5, "rlmodule_inference_timer": 3.220111699553894e-05, "episode_len_min": 20, "num_episodes": 20, "env_to_module_sum_episodes_length_out": 10.368238394572801, "num_module_steps_sampled_lifetime": {"default_policy": 2800}, "num_module_steps_sampled": {"default_policy": 400}, "num_agent_steps_sampled": {"default_agent": 400}, "time_between_sampling": 9.736230456338516}, "num_healthy_workers": 1, "actor_manager_num_outstanding_async_reqs": 0, "num_remote_worker_restarts": 0}, "num_env_steps_sampled_lifetime": -3077500.0, "fault_tolerance": {"num_healthy_workers": 0, "num_remote_worker_restarts": 0}, "env_runner_group": {"actor_manager_num_outstanding_async_reqs": 0}, "done": false, "training_iteration": 7, "trial_id": "b5096_00000", "date": "2025-08-11_18-45-32", "timestamp": 1754930732, "time_this_iter_s": 9.551868915557861, "time_total_s": 69.01413106918335, "pid": 11702, "hostname": "Mac", "node_ip": "127.0.0.1", "config": {"exploration_config": {}, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 2, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "env": "Umbrella", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": false, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 0, "create_local_env_runner": true, "num_envs_per_env_runner": 1, "gym_env_vectorize_mode": "SYNC", "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "episodes_to_numpy": true, "max_requests_in_flight_per_env_runner": 1, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "merge_env_runner_states": "training_only", "broadcast_env_runner_states": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "complete_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "sampler_perf_stats_ema_coef": null, "_is_online": true, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": "auto", "num_aggregator_actors_per_learner": 0, "max_requests_in_flight_per_aggregator_actor": 3, "local_gpu_idx": 0, "max_requests_in_flight_per_learner": 3, "gamma": 1, "lr": 0.0002715581955, "grad_clip": 0.5, "grad_clip_by": "global_norm", "_train_batch_size_per_learner": 5000, "train_batch_size": 4000, "num_epochs": 1, "minibatch_size": 1000, "shuffle_batch_per_epoch": true, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "log_std_clip_param": 20.0, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "_disable_preprocessor_api": false, "_disable_action_flattening": false}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {"intrinsic_reward_coeff": 0.2795015916508}, "optimizer": {}, "_learner_class": "<class 'source.intrinsic_attention_ppo.learners.IntrinsicAttentionMetaLearner.IntrinsicAttentionMetaLearner'>", "callbacks_on_algorithm_init": null, "callbacks_on_env_runners_recreated": null, "callbacks_on_offline_eval_runners_recreated": null, "callbacks_on_checkpoint_loaded": null, "callbacks_on_environment_created": null, "callbacks_on_episode_created": null, "callbacks_on_episode_start": null, "callbacks_on_episode_step": null, "callbacks_on_episode_end": null, "callbacks_on_evaluate_start": null, "callbacks_on_evaluate_end": null, "callbacks_on_evaluate_offline_start": null, "callbacks_on_evaluate_offline_end": null, "callbacks_on_sample_end": null, "callbacks_on_train_result": null, "explore": true, "enable_rl_module_and_learner": true, "enable_env_runner_and_connector_v2": true, "_prior_exploration_config": {"type": "StochasticSampling"}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x3866e5760>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "offline_data_class": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_read_batch_size": null, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "materialize_data": false, "materialize_mapped_data": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "ignore_final_observation": false, "prelearner_class": null, "prelearner_buffer_class": null, "prelearner_buffer_kwargs": {}, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_remaining_data": false, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": 1, "evaluation_duration": 20, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_auto_duration_min_env_steps_per_sample": 100, "evaluation_auto_duration_max_env_steps_per_sample": 2000, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 1, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "offline_evaluation_interval": null, "num_offline_eval_runners": 0, "offline_loss_for_module_fn": null, "offline_evaluation_duration": 1, "offline_evaluation_parallel_to_training": false, "offline_evaluation_timeout_s": 120.0, "num_cpus_per_offline_eval_runner": 1, "num_gpus_per_offline_eval_runner": 0, "custom_resources_per_offline_eval_runner": {}, "restart_failed_offline_eval_runners": true, "ignore_offline_eval_runner_failures": false, "max_num_offline_eval_runner_restarts": 1000, "offline_eval_runner_restore_timeout_s": 1800.0, "max_requests_in_flight_per_offline_eval_runner": 1, "validate_offline_eval_runners_after_construction": true, "offline_eval_runner_health_probe_timeout_s": 30.0, "offline_eval_rl_module_inference_only": false, "broadcast_offline_eval_runner_states": false, "offline_eval_batch_size_per_runner": 256, "dataset_num_iters_per_eval_runner": 1, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "log_gradients": false, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 8, "restart_failed_env_runners": true, "ignore_env_runner_failures": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30.0, "env_runner_restore_timeout_s": 1800.0, "_model_config": {}, "_rl_module_spec": "MultiRLModuleSpec(multi_rl_module_class=<class 'ray.rllib.core.rl_module.multi_rl_module.MultiRLModule'>, observation_space=None, action_space=None, inference_only=False, model_config=None, rl_module_specs={'default_policy': RLModuleSpec(module_class=<class 'source.intrinsic_attention_ppo.rl_modules.DifferentiablePPOModule.DifferentiablePPOModule'>, observation_space=None, action_space=None, inference_only=False, learner_only=False, model_config={'vf_share_layers': True, 'embedding_dim': 62, 'max_seq_len': 6, 'policy_head_hidden_sizes': [32], 'value_head_hidden_sizes': [101], 'embedding_hidden_sizes': [121]}, catalog_class=None, load_state_path=None, model_config_dict=None), 'intrinsic_reward_module': RLModuleSpec(module_class=<class 'source.intrinsic_attention_ppo.rl_modules.IntrinsicAttentionModule.IntrinsicAttentionModule'>, observation_space=None, action_space=None, inference_only=False, learner_only=True, model_config={'intrinsic_reward_network': {'encoder_hidden_sizes': [], 'encoding_dim': 1, 'num_heads': 1, 'head_hidden_sizes': None, 'layers': [{'type': 'attention'}]}, 'extrinsic_value_hidden_layers': [127, 60], 'vf_share_layers': True, 'max_seq_len': 6}, catalog_class=None, load_state_path=None, model_config_dict=None)}, load_state_path=None, modules_to_load=None, module_specs={'default_policy': RLModuleSpec(module_class=<class 'source.intrinsic_attention_ppo.rl_modules.DifferentiablePPOModule.DifferentiablePPOModule'>, observation_space=None, action_space=None, inference_only=False, learner_only=False, model_config={'vf_share_layers': True, 'embedding_dim': 62, 'max_seq_len': 6, 'policy_head_hidden_sizes': [32], 'value_head_hidden_sizes': [101], 'embedding_hidden_sizes': [121]}, catalog_class=None, load_state_path=None, model_config_dict=None), 'intrinsic_reward_module': RLModuleSpec(module_class=<class 'source.intrinsic_attention_ppo.rl_modules.IntrinsicAttentionModule.IntrinsicAttentionModule'>, observation_space=None, action_space=None, inference_only=False, learner_only=True, model_config={'intrinsic_reward_network': {'encoder_hidden_sizes': [], 'encoding_dim': 1, 'num_heads': 1, 'head_hidden_sizes': None, 'layers': [{'type': 'attention'}]}, 'extrinsic_value_hidden_layers': [127, 60], 'vf_share_layers': True, 'max_seq_len': 6}, catalog_class=None, load_state_path=None, model_config_dict=None)})", "algorithm_config_overrides_per_module": {"intrinsic_reward_module": {"lr": 0.0002715581955}}, "_per_module_overrides": {}, "_validate_config": true, "_use_msgpack_checkpoints": false, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "env_task_fn": -1, "enable_connectors": -1, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.161583927863, "kl_target": 0.0201019014258, "vf_loss_coeff": 0.7790510010087, "entropy_coeff": 0.0015431216992, "clip_param": 0.2459212356676, "vf_clip_param": 0.3769744131561, "entropy_coeff_schedule": null, "lr_schedule": null, "sgd_minibatch_size": -1, "vf_share_layers": -1, "differentiable_learner_configs": ["DifferentiableLearnerConfig(learner_class=<class 'source.intrinsic_attention_ppo.learners.IntrinsicAttentionPPOLearner.IntrinsicAttentionPPOLearner'>, learner_connector=None, add_default_connectors_to_learner_pipeline=True, is_multi_agent=False, policies_to_update=['default_policy'], lr=0.0060984166342, num_total_minibatches=0, num_epochs=1, minibatch_size=1000, shuffle_batch_per_epoch=True)"], "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9485408017724, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.callbacks.callbacks.RLlibCallback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 69.01413106918335, "iterations_since_restore": 7, "perf": {"cpu_util_percent": 36.614285714285714, "ram_util_percent": 82.22857142857143}}
{"timers": {"training_iteration": 10.25524094454932, "restore_env_runners": 1.1285761676522894e-05, "training_step": 10.255079115233421, "env_runner_sampling_timer": 1.6581440819507647, "learner_update_timer": 8.405378649271565, "synch_weights": 0.0013212915904048839, "restore_eval_env_runners": 3.179994114561968e-05, "evaluation_iteration": 0.12487736813207317, "synch_eval_env_connectors": 0.00015562173966103077, "synch_env_connectors": 4.378013131618119e-06}, "env_runners": {"episode_duration_sec_mean": 0.005434085179120299, "env_to_module_connector": {"timers": {"connectors": {"numpy_to_tensor": 1.3148920895621436e-05, "add_observations_from_episodes_to_batch": 2.862014184220448e-06, "batch_individual_items": 1.2914232159526565e-05, "add_time_dim_to_batch_and_zero_pad": 7.160201244158783e-06, "add_states_from_episodes_to_batch": 2.75616716505196e-06}}, "connector_pipeline_timer": 6.126924210773554e-05}, "num_env_steps_sampled": 5000.0, "episode_return_min": -11.5, "module_to_env_connector": {"timers": {"connectors": {"normalize_and_clip_actions": 8.319901988823434e-06, "un_batch_to_individual_items": 6.662861849369742e-06, "get_actions": 4.1225388907040496e-05, "remove_single_ts_time_rank_from_batch": 1.221042623782164e-05, "listify_data_for_vector_env": 1.0828922345220896e-05, "tensor_to_numpy": 1.5701495108147562e-05}}, "connector_pipeline_timer": 0.00012203371254165029}, "env_reset_timer": 4.41740997728973e-05, "sample": 0.005785242263321126, "num_episodes_lifetime": -184750.0, "env_to_module_sum_episodes_length_out": 10.36823839457432, "env_step_timer": 1.4395237865718203e-05, "num_module_steps_sampled_lifetime": {"default_policy": -3695000.0}, "weights_seq_no": 7.0, "module_episode_returns_mean": {"default_policy": 0.4200000000000001}, "env_to_module_sum_episodes_length_in": 10.36823839457432, "episode_len_mean": 20.0, "agent_episode_returns_mean": {"default_agent": 0.4200000000000001}, "time_between_sampling": 0.03266008669018274, "num_module_steps_sampled": {"default_policy": 5000.0}, "episode_return_max": 8.5, "episode_len_min": 20, "episode_len_max": 20, "rlmodule_inference_timer": 3.2594426923095915e-05, "num_agent_steps_sampled": {"default_agent": 5000.0}, "num_episodes": 250.0, "num_env_steps_sampled_lifetime": -3695000.0, "num_agent_steps_sampled_lifetime": {"default_agent": -3695000.0}, "episode_return_mean": 0.4200000000000001, "num_env_steps_sampled_lifetime_throughput": 3153.3395093366767}, "__all_modules__": {"learner_connector_sum_episodes_length_in": 5000.0, "learner_connector": {"connector_pipeline_timer": 0.15333046781373752, "timers": {"connectors": {"add_one_ts_to_episodes_and_truncate": 0.008806124085269455, "add_observations_from_episodes_to_batch": 0.0008120838890091785, "add_columns_from_episodes_to_train_batch": 0.04111411585824965, "add_time_dim_to_batch_and_zero_pad": 0.09017866968117405, "add_states_from_episodes_to_batch": 0.0036241332173250827, "batch_individual_items": 0.008563443501424671, "numpy_to_tensor": 7.887452352882418e-05}}}, "learner_connector_sum_episodes_length_out": 5250.0}, "learners": {"default_policy": {"num_module_steps_trained_lifetime": 47880, "weights_seq_no": 8.0, "entropy": 0.6901026368141174, "num_module_steps_trained": 5985, "vf_loss": 0.32051512598991394, "mean_kl_loss": 3.398145054234192e-05, "num_trainable_parameters": 16595, "curr_entropy_coeff": 0.0015431216992, "module_train_batch_size_mean": 998.4230504637324, "vf_explained_var": -0.0005257129669189453, "total_loss": 0.24837516248226166, "vf_loss_unclipped": 41.7741584777832, "policy_loss": -0.00025761983124539256, "use_intrinsic_rewards": 0.0, "diff_num_grad_updates_vs_sampler_policy": 1.0, "curr_kl_coeff": 0.0006311872275546193, "num_module_steps_trained_lifetime_throughput": 659.5715410833245}, "intrinsic_reward_module": {"total_loss": 0.0, "gradients_default_optimizer_global_norm": 0.0, "num_module_steps_trained_lifetime": 47880, "num_module_steps_trained": 5985, "weights_seq_no": 8.0, "num_trainable_parameters": 8266, "curr_entropy_coeff": 0.0015431216992, "module_train_batch_size_mean": 998.4230504637324, "default_optimizer_learning_rate": 0.0002715581955, "diff_num_grad_updates_vs_sampler_policy": 1.0, "num_module_steps_trained_lifetime_throughput": 659.5789553124138}, "differentiable_learners": {"intrinsic_attention_ppo_learner": {"default_policy": {"num_module_steps_trained": 35910, "weights_seq_no": 48.0, "entropy": 0.6901164650917053, "vf_loss": 0.32067182660102844, "mean_kl_loss": 3.253196700825356e-05, "module_train_batch_size_mean": 997.5758696422192, "vf_explained_var": 0.0008576512336730957, "diff_num_grad_updates_vs_sampler_policy": 41.0, "total_loss": 0.24850809574127197, "vf_loss_unclipped": 41.724708557128906, "policy_loss": -0.0002519324771128595, "use_intrinsic_rewards": 1.0, "num_module_steps_trained_lifetime": 287280}, "intrinsic_reward_module": {"module_train_batch_size_mean": 997.5758696422192, "diff_num_grad_updates_vs_sampler_policy": 41.0, "total_loss": 0.0, "num_module_steps_trained_lifetime": 287280, "num_module_steps_trained": 35910, "weights_seq_no": 48.0}, "__all_modules__": {"num_module_steps_trained_lifetime": 574560, "num_module_steps_trained": 71820, "num_env_steps_trained": 216000, "num_env_steps_trained_lifetime": 1728000, "num_env_steps_trained_lifetime_throughput": 57452.3665469207}}}, "__all_modules__": {"num_module_steps_trained_lifetime": 95760, "num_module_steps_trained": 11970, "num_trainable_parameters": 24861, "num_env_steps_trained": 36000, "num_env_steps_trained_lifetime": 288000, "num_non_trainable_parameters": 0, "num_env_steps_trained_lifetime_throughput": 3971.356699788474, "num_module_steps_trained_throughput": 25117527.430576652, "num_module_steps_trained_lifetime_throughput": 11686187.994663}, "IntrinsicAttentionMask": [[[0.16678115725517273, 0.1668548434972763, 0.16628877818584442, 0.1662183552980423, 0.1666429489850998, 0.16721393167972565], [0.16674718260765076, 0.16679894924163818, 0.16640114784240723, 0.16635163128376007, 0.16665008664131165, 0.16705109179019928], [0.1670071929693222, 0.16722793877124786, 0.16553711891174316, 0.16532757878303528, 0.16659367084503174, 0.16830648481845856], [0.16703937947750092, 0.16728125512599945, 0.1654295027256012, 0.1652001440525055, 0.16658641397953033, 0.16846337914466858], [0.16684477031230927, 0.16695965826511383, 0.16607795655727386, 0.1659683734178543, 0.16662940382957458, 0.16751983761787415], [0.16658100485801697, 0.16652622818946838, 0.16694816946983337, 0.16700083017349243, 0.1666838675737381, 0.16625986993312836]], [[0.16780458390712738, 0.1673898696899414, 0.1669761687517166, 0.16286462545394897, 0.17290419340133667, 0.16206058859825134], [0.16785836219787598, 0.1674232929944992, 0.16698934137821198, 0.16267935931682587, 0.17321252822875977, 0.1618371456861496], [0.16791196167469025, 0.1674565225839615, 0.16700230538845062, 0.16249413788318634, 0.1735212206840515, 0.1616138219833374], [0.1684427410364151, 0.1677815467119217, 0.1671229600906372, 0.16062985360622406, 0.17665153741836548, 0.1593712717294693], [0.1671409159898758, 0.16697165369987488, 0.1668025553226471, 0.16510838270187378, 0.16920238733291626, 0.16477413475513458], [0.16854608058929443, 0.16784392297267914, 0.16714470088481903, 0.16026023030281067, 0.17727726697921753, 0.15892775356769562]], [[0.16694685816764832, 0.16526007652282715, 0.16819514334201813, 0.1672840714454651, 0.16559387743473053, 0.16671986877918243], [0.16767899692058563, 0.16147693991661072, 0.1723794937133789, 0.16893941164016724, 0.16269074380397797, 0.16683441400527954], [0.16638419032096863, 0.16806353628635406, 0.16516298055648804, 0.16605250537395477, 0.1677284985780716, 0.16660821437835693], [0.16679660975933075, 0.16601713001728058, 0.16737070679664612, 0.16695190966129303, 0.16617172956466675, 0.16669195890426636], [0.16753675043582916, 0.16222505271434784, 0.1715434193611145, 0.16861270368099213, 0.16326689720153809, 0.1668151170015335], [0.16704730689525604, 0.1647506207227707, 0.16875238716602325, 0.16750745475292206, 0.16520443558692932, 0.16673775017261505]], [[0.1638478934764862, 0.16864117980003357, 0.16804008185863495, 0.16744114458560944, 0.17108111083507538, 0.16094858944416046], [0.16461966931819916, 0.16810619831085205, 0.16767047345638275, 0.16723588109016418, 0.169870525598526, 0.16249726712703705], [0.1645241528749466, 0.16817261278629303, 0.16771647334098816, 0.16726155579090118, 0.1700202375650406, 0.16230493783950806], [0.16442863643169403, 0.16823899745941162, 0.1677624136209488, 0.16728715598583221, 0.17017002403736115, 0.1621127724647522], [0.16500365734100342, 0.167838454246521, 0.16748479008674622, 0.16713187098503113, 0.16926877200603485, 0.16327250003814697], [0.16336941719055176, 0.1689707636833191, 0.16826684772968292, 0.16756585240364075, 0.17183242738246918, 0.1599947065114975]], [[0.1669948399066925, 0.16706861555576324, 0.1658630073070526, 0.16643132269382477, 0.16685645282268524, 0.16678579151630402], [0.16689728200435638, 0.1669490933418274, 0.16610169410705566, 0.16650137305259705, 0.1668000966310501, 0.1667504608631134], [0.1684924215078354, 0.16890810430049896, 0.16222012042999268, 0.16534514725208282, 0.16771502792835236, 0.16731920838356018], [0.16774019598960876, 0.1679830700159073, 0.16404490172863007, 0.16589322686195374, 0.16728530824184418, 0.16705337166786194], [0.16717781126499176, 0.16729290783405304, 0.1654157191514969, 0.16629965603351593, 0.16696201264858246, 0.16685184836387634], [0.16727127134799957, 0.16740751266479492, 0.1651875227689743, 0.16623231768608093, 0.16701585054397583, 0.16688551008701324]], [[0.1678122729063034, 0.16368013620376587, 0.1632756143808365, 0.16657112538814545, 0.1729121059179306, 0.16574878990650177], [0.168355792760849, 0.16220912337303162, 0.1616114377975464, 0.16650162637233734, 0.17604508996009827, 0.16527687013149261], [0.16840901970863342, 0.16206306219100952, 0.16144642233848572, 0.16649392247200012, 0.17635826766490936, 0.16522930562496185], [0.1679755002260208, 0.16324226558208466, 0.1627798229455948, 0.16655199229717255, 0.1738407164812088, 0.1656096875667572], [0.16714219748973846, 0.16544456779956818, 0.16527701914310455, 0.16663490235805511, 0.16920368373394012, 0.1662975698709488], [0.16808368265628815, 0.1629503071308136, 0.162449449300766, 0.16653850674629211, 0.17446181178092957, 0.16551630198955536]]]}, "num_training_step_calls_per_iteration": 1, "evaluation": {"env_runners": {"env_to_module_connector": {"timers": {"connectors": {"add_states_from_episodes_to_batch": 2.6446775979432155e-06, "numpy_to_tensor": 1.1850087302826633e-05, "add_time_dim_to_batch_and_zero_pad": 6.614118622003838e-06, "add_observations_from_episodes_to_batch": 2.733970430309223e-06, "batch_individual_items": 1.213096968408923e-05}}, "connector_pipeline_timer": 5.7661649610433874e-05}, "module_to_env_connector": {"timers": {"connectors": {"tensor_to_numpy": 1.4753434434569745e-05, "remove_single_ts_time_rank_from_batch": 1.1855949993146795e-05, "un_batch_to_individual_items": 6.4834032379835436e-06, "normalize_and_clip_actions": 7.781994367863376e-06, "get_actions": 3.509194799473164e-05, "listify_data_for_vector_env": 1.019043978590141e-05}}, "connector_pipeline_timer": 0.00011213682200547139}, "num_env_steps_sampled": 400, "num_agent_steps_sampled_lifetime": {"default_agent": 3200}, "env_step_timer": 1.3637689028476873e-05, "episode_len_max": 20, "num_episodes_lifetime": 160, "sample": 0.11581901500611544, "weights_seq_no": 8.0, "env_to_module_sum_episodes_length_in": 10.3682383945743, "module_episode_returns_mean": {"default_policy": 0.75}, "num_env_steps_sampled_lifetime": 40400, "agent_episode_returns_mean": {"default_agent": 0.75}, "episode_duration_sec_mean": 0.005440456212963909, "episode_return_mean": 0.75, "episode_return_min": -14.5, "env_reset_timer": 0.0004491999583318442, "episode_len_mean": 20.0, "episode_return_max": 14.5, "rlmodule_inference_timer": 3.030443497701706e-05, "episode_len_min": 20, "num_episodes": 20, "env_to_module_sum_episodes_length_out": 10.3682383945743, "num_module_steps_sampled_lifetime": {"default_policy": 3200}, "num_module_steps_sampled": {"default_policy": 400}, "num_agent_steps_sampled": {"default_agent": 400}, "time_between_sampling": 9.734711014275709}, "num_healthy_workers": 1, "actor_manager_num_outstanding_async_reqs": 0, "num_remote_worker_restarts": 0}, "num_env_steps_sampled_lifetime": -3695000.0, "fault_tolerance": {"num_healthy_workers": 0, "num_remote_worker_restarts": 0}, "env_runner_group": {"actor_manager_num_outstanding_async_reqs": 0}, "done": false, "training_iteration": 8, "trial_id": "b5096_00000", "date": "2025-08-11_18-45-41", "timestamp": 1754930741, "time_this_iter_s": 9.684532880783081, "time_total_s": 78.69866394996643, "pid": 11702, "hostname": "Mac", "node_ip": "127.0.0.1", "config": {"exploration_config": {}, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 2, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "env": "Umbrella", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": false, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 0, "create_local_env_runner": true, "num_envs_per_env_runner": 1, "gym_env_vectorize_mode": "SYNC", "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "episodes_to_numpy": true, "max_requests_in_flight_per_env_runner": 1, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "merge_env_runner_states": "training_only", "broadcast_env_runner_states": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "complete_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "sampler_perf_stats_ema_coef": null, "_is_online": true, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": "auto", "num_aggregator_actors_per_learner": 0, "max_requests_in_flight_per_aggregator_actor": 3, "local_gpu_idx": 0, "max_requests_in_flight_per_learner": 3, "gamma": 1, "lr": 0.0002715581955, "grad_clip": 0.5, "grad_clip_by": "global_norm", "_train_batch_size_per_learner": 5000, "train_batch_size": 4000, "num_epochs": 1, "minibatch_size": 1000, "shuffle_batch_per_epoch": true, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "log_std_clip_param": 20.0, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "_disable_preprocessor_api": false, "_disable_action_flattening": false}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {"intrinsic_reward_coeff": 0.2795015916508}, "optimizer": {}, "_learner_class": "<class 'source.intrinsic_attention_ppo.learners.IntrinsicAttentionMetaLearner.IntrinsicAttentionMetaLearner'>", "callbacks_on_algorithm_init": null, "callbacks_on_env_runners_recreated": null, "callbacks_on_offline_eval_runners_recreated": null, "callbacks_on_checkpoint_loaded": null, "callbacks_on_environment_created": null, "callbacks_on_episode_created": null, "callbacks_on_episode_start": null, "callbacks_on_episode_step": null, "callbacks_on_episode_end": null, "callbacks_on_evaluate_start": null, "callbacks_on_evaluate_end": null, "callbacks_on_evaluate_offline_start": null, "callbacks_on_evaluate_offline_end": null, "callbacks_on_sample_end": null, "callbacks_on_train_result": null, "explore": true, "enable_rl_module_and_learner": true, "enable_env_runner_and_connector_v2": true, "_prior_exploration_config": {"type": "StochasticSampling"}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x3866e5760>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "offline_data_class": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_read_batch_size": null, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "materialize_data": false, "materialize_mapped_data": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "ignore_final_observation": false, "prelearner_class": null, "prelearner_buffer_class": null, "prelearner_buffer_kwargs": {}, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_remaining_data": false, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": 1, "evaluation_duration": 20, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_auto_duration_min_env_steps_per_sample": 100, "evaluation_auto_duration_max_env_steps_per_sample": 2000, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 1, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "offline_evaluation_interval": null, "num_offline_eval_runners": 0, "offline_loss_for_module_fn": null, "offline_evaluation_duration": 1, "offline_evaluation_parallel_to_training": false, "offline_evaluation_timeout_s": 120.0, "num_cpus_per_offline_eval_runner": 1, "num_gpus_per_offline_eval_runner": 0, "custom_resources_per_offline_eval_runner": {}, "restart_failed_offline_eval_runners": true, "ignore_offline_eval_runner_failures": false, "max_num_offline_eval_runner_restarts": 1000, "offline_eval_runner_restore_timeout_s": 1800.0, "max_requests_in_flight_per_offline_eval_runner": 1, "validate_offline_eval_runners_after_construction": true, "offline_eval_runner_health_probe_timeout_s": 30.0, "offline_eval_rl_module_inference_only": false, "broadcast_offline_eval_runner_states": false, "offline_eval_batch_size_per_runner": 256, "dataset_num_iters_per_eval_runner": 1, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "log_gradients": false, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 8, "restart_failed_env_runners": true, "ignore_env_runner_failures": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30.0, "env_runner_restore_timeout_s": 1800.0, "_model_config": {}, "_rl_module_spec": "MultiRLModuleSpec(multi_rl_module_class=<class 'ray.rllib.core.rl_module.multi_rl_module.MultiRLModule'>, observation_space=None, action_space=None, inference_only=False, model_config=None, rl_module_specs={'default_policy': RLModuleSpec(module_class=<class 'source.intrinsic_attention_ppo.rl_modules.DifferentiablePPOModule.DifferentiablePPOModule'>, observation_space=None, action_space=None, inference_only=False, learner_only=False, model_config={'vf_share_layers': True, 'embedding_dim': 62, 'max_seq_len': 6, 'policy_head_hidden_sizes': [32], 'value_head_hidden_sizes': [101], 'embedding_hidden_sizes': [121]}, catalog_class=None, load_state_path=None, model_config_dict=None), 'intrinsic_reward_module': RLModuleSpec(module_class=<class 'source.intrinsic_attention_ppo.rl_modules.IntrinsicAttentionModule.IntrinsicAttentionModule'>, observation_space=None, action_space=None, inference_only=False, learner_only=True, model_config={'intrinsic_reward_network': {'encoder_hidden_sizes': [], 'encoding_dim': 1, 'num_heads': 1, 'head_hidden_sizes': None, 'layers': [{'type': 'attention'}]}, 'extrinsic_value_hidden_layers': [127, 60], 'vf_share_layers': True, 'max_seq_len': 6}, catalog_class=None, load_state_path=None, model_config_dict=None)}, load_state_path=None, modules_to_load=None, module_specs={'default_policy': RLModuleSpec(module_class=<class 'source.intrinsic_attention_ppo.rl_modules.DifferentiablePPOModule.DifferentiablePPOModule'>, observation_space=None, action_space=None, inference_only=False, learner_only=False, model_config={'vf_share_layers': True, 'embedding_dim': 62, 'max_seq_len': 6, 'policy_head_hidden_sizes': [32], 'value_head_hidden_sizes': [101], 'embedding_hidden_sizes': [121]}, catalog_class=None, load_state_path=None, model_config_dict=None), 'intrinsic_reward_module': RLModuleSpec(module_class=<class 'source.intrinsic_attention_ppo.rl_modules.IntrinsicAttentionModule.IntrinsicAttentionModule'>, observation_space=None, action_space=None, inference_only=False, learner_only=True, model_config={'intrinsic_reward_network': {'encoder_hidden_sizes': [], 'encoding_dim': 1, 'num_heads': 1, 'head_hidden_sizes': None, 'layers': [{'type': 'attention'}]}, 'extrinsic_value_hidden_layers': [127, 60], 'vf_share_layers': True, 'max_seq_len': 6}, catalog_class=None, load_state_path=None, model_config_dict=None)})", "algorithm_config_overrides_per_module": {"intrinsic_reward_module": {"lr": 0.0002715581955}}, "_per_module_overrides": {}, "_validate_config": true, "_use_msgpack_checkpoints": false, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "env_task_fn": -1, "enable_connectors": -1, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.161583927863, "kl_target": 0.0201019014258, "vf_loss_coeff": 0.7790510010087, "entropy_coeff": 0.0015431216992, "clip_param": 0.2459212356676, "vf_clip_param": 0.3769744131561, "entropy_coeff_schedule": null, "lr_schedule": null, "sgd_minibatch_size": -1, "vf_share_layers": -1, "differentiable_learner_configs": ["DifferentiableLearnerConfig(learner_class=<class 'source.intrinsic_attention_ppo.learners.IntrinsicAttentionPPOLearner.IntrinsicAttentionPPOLearner'>, learner_connector=None, add_default_connectors_to_learner_pipeline=True, is_multi_agent=False, policies_to_update=['default_policy'], lr=0.0060984166342, num_total_minibatches=0, num_epochs=1, minibatch_size=1000, shuffle_batch_per_epoch=True)"], "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9485408017724, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.callbacks.callbacks.RLlibCallback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 78.69866394996643, "iterations_since_restore": 8, "perf": {"cpu_util_percent": 36.99999999999999, "ram_util_percent": 82.58461538461539}}
{"timers": {"training_iteration": 10.25751258135426, "restore_env_runners": 1.1242904592772201e-05, "training_step": 10.257349737831849, "env_runner_sampling_timer": 1.6568755615407444, "learner_update_timer": 8.408821510699775, "synch_weights": 0.0013225482549928398, "restore_eval_env_runners": 3.156402152097078e-05, "evaluation_iteration": 0.12485231653005556, "synch_eval_env_connectors": 0.00015507552180598624, "synch_env_connectors": 4.376732741841297e-06}, "env_runners": {"episode_duration_sec_mean": 0.005269124658312648, "env_to_module_connector": {"timers": {"connectors": {"numpy_to_tensor": 1.2508635220483337e-05, "add_observations_from_episodes_to_batch": 2.810496860521546e-06, "batch_individual_items": 1.2609550450047392e-05, "add_time_dim_to_batch_and_zero_pad": 7.033927606497853e-06, "add_states_from_episodes_to_batch": 2.715073617271048e-06}}, "connector_pipeline_timer": 5.972349009077042e-05}, "num_env_steps_sampled": 5000.0, "episode_return_min": -11.5, "module_to_env_connector": {"timers": {"connectors": {"normalize_and_clip_actions": 8.075402243740108e-06, "un_batch_to_individual_items": 6.522829310708841e-06, "get_actions": 3.926987209446924e-05, "remove_single_ts_time_rank_from_batch": 1.1935219437571743e-05, "listify_data_for_vector_env": 1.0536849860123053e-05, "tensor_to_numpy": 1.5203685716525708e-05}}, "connector_pipeline_timer": 0.00011793811613456526}, "env_reset_timer": 4.065708078164098e-05, "sample": 0.0056750498973838414, "num_episodes_lifetime": -215625.0, "env_to_module_sum_episodes_length_out": 10.36823839457432, "env_step_timer": 1.3907277761273064e-05, "num_module_steps_sampled_lifetime": {"default_policy": -4312500.0}, "weights_seq_no": 8.0, "module_episode_returns_mean": {"default_policy": -0.7800000000000001}, "env_to_module_sum_episodes_length_in": 10.36823839457432, "episode_len_mean": 20.0, "agent_episode_returns_mean": {"default_agent": -0.7800000000000001}, "time_between_sampling": 0.032950409612674494, "num_module_steps_sampled": {"default_policy": 5000.0}, "episode_return_max": 8.5, "episode_len_min": 20, "episode_len_max": 20, "rlmodule_inference_timer": 3.1534306401778664e-05, "num_agent_steps_sampled": {"default_agent": 5000.0}, "num_episodes": 250.0, "num_env_steps_sampled_lifetime": -4312500.0, "num_agent_steps_sampled_lifetime": {"default_agent": -4312500.0}, "episode_return_mean": -0.7800000000000001, "num_env_steps_sampled_lifetime_throughput": 3255.238951152821}, "__all_modules__": {"learner_connector_sum_episodes_length_in": 5000.0, "learner_connector": {"connector_pipeline_timer": 0.15331066563562012, "timers": {"connectors": {"add_one_ts_to_episodes_and_truncate": 0.00880594992457021, "add_observations_from_episodes_to_batch": 0.000812323879789069, "add_columns_from_episodes_to_train_batch": 0.041116440529000445, "add_time_dim_to_batch_and_zero_pad": 0.09016458173437394, "add_states_from_episodes_to_batch": 0.0036255027151924804, "batch_individual_items": 0.008554635316125365, "numpy_to_tensor": 7.873160858951592e-05}}}, "learner_connector_sum_episodes_length_out": 5250.0}, "learners": {"default_policy": {"num_module_steps_trained_lifetime": 53865, "weights_seq_no": 9.0, "entropy": 0.6896764039993286, "num_module_steps_trained": 5985, "vf_loss": 0.3205201029777527, "mean_kl_loss": 1.3537879567593336e-05, "num_trainable_parameters": 16595, "curr_entropy_coeff": 0.0015431216992, "module_train_batch_size_mean": 998.3685925840979, "vf_explained_var": -0.00038564205169677734, "total_loss": 0.2485511153936386, "vf_loss_unclipped": 41.62213897705078, "policy_loss": -8.616517880000174e-05, "use_intrinsic_rewards": 0.0, "diff_num_grad_updates_vs_sampler_policy": 1.0, "curr_kl_coeff": 0.00031559361377730966, "num_module_steps_trained_lifetime_throughput": 660.552383903052}, "intrinsic_reward_module": {"total_loss": 0.0, "gradients_default_optimizer_global_norm": 0.0, "num_module_steps_trained_lifetime": 53865, "num_module_steps_trained": 5985, "weights_seq_no": 9.0, "num_trainable_parameters": 8266, "curr_entropy_coeff": 0.0015431216992, "module_train_batch_size_mean": 998.3685925840979, "default_optimizer_learning_rate": 0.0002715581955, "diff_num_grad_updates_vs_sampler_policy": 1.0, "num_module_steps_trained_lifetime_throughput": 660.5593915212601}, "differentiable_learners": {"intrinsic_attention_ppo_learner": {"default_policy": {"num_module_steps_trained": 35910, "weights_seq_no": 54.0, "entropy": 0.6896829009056091, "vf_loss": 0.32064539194107056, "mean_kl_loss": 1.3123538337822538e-05, "module_train_batch_size_mean": 997.5505482791133, "vf_explained_var": 0.0008387565612792969, "diff_num_grad_updates_vs_sampler_policy": 46.0, "total_loss": 0.24865277111530304, "vf_loss_unclipped": 41.58628845214844, "policy_loss": -8.420048834523186e-05, "use_intrinsic_rewards": 1.0, "num_module_steps_trained_lifetime": 323190}, "intrinsic_reward_module": {"module_train_batch_size_mean": 997.5505482791133, "diff_num_grad_updates_vs_sampler_policy": 46.0, "total_loss": 0.0, "num_module_steps_trained_lifetime": 323190, "num_module_steps_trained": 35910, "weights_seq_no": 54.0}, "__all_modules__": {"num_module_steps_trained_lifetime": 646380, "num_module_steps_trained": 71820, "num_env_steps_trained": 216000, "num_env_steps_trained_lifetime": 1944000, "num_env_steps_trained_lifetime_throughput": 56441.85561042219}}}, "__all_modules__": {"num_module_steps_trained_lifetime": 107730, "num_module_steps_trained": 11970, "num_trainable_parameters": 24861, "num_env_steps_trained": 36000, "num_env_steps_trained_lifetime": 324000, "num_non_trainable_parameters": 0, "num_env_steps_trained_lifetime_throughput": 3977.1090125516366, "num_module_steps_trained_throughput": 24470829.399571653, "num_module_steps_trained_lifetime_throughput": 11719504.292862901}, "IntrinsicAttentionMask": [[[0.16688744723796844, 0.1676042377948761, 0.16575634479522705, 0.16632428765296936, 0.16674914956092834, 0.1666785329580307], [0.16624613106250763, 0.1649082899093628, 0.16839133203029633, 0.16730892658233643, 0.16650617122650146, 0.16663919389247894], [0.16787777841091156, 0.17193973064422607, 0.1616283804178238, 0.16474200785160065, 0.16710321605205536, 0.16670885682106018], [0.16738390922546387, 0.16975030303001404, 0.16369645297527313, 0.16554085910320282, 0.16692999005317688, 0.16669854521751404], [0.16700997948646545, 0.16812896728515625, 0.16524964570999146, 0.16613270342350006, 0.16679438948631287, 0.1666843444108963], [0.1670723855495453, 0.1683974713087082, 0.1649911254644394, 0.16603468358516693, 0.16681727766990662, 0.16668708622455597]], [[0.1646879017353058, 0.16410090029239655, 0.16351599991321564, 0.1682995855808258, 0.17762187123298645, 0.16177374124526978], [0.16461853682994843, 0.16401197016239166, 0.16340763866901398, 0.1683521866798401, 0.17800171673297882, 0.16160796582698822], [0.16454902291297913, 0.16392289102077484, 0.16329917311668396, 0.16840460896492004, 0.17838215827941895, 0.16144219040870667], [0.165105938911438, 0.1646382063627243, 0.16417181491851807, 0.1679762303829193, 0.17532728612422943, 0.1627805382013321], [0.1661193072795868, 0.16595107316970825, 0.16578301787376404, 0.1671450436115265, 0.16972169280052185, 0.16527985036373138], [0.16433945298194885, 0.16365481913089752, 0.1629730463027954, 0.16856081783771515, 0.17952711880207062, 0.16094473004341125]], [[0.16694848239421844, 0.16526168584823608, 0.16717320680618286, 0.16728569567203522, 0.16660939157009125, 0.16672149300575256], [0.1677013784646988, 0.16149850189685822, 0.16854073107242584, 0.16896197199821472, 0.1664406955242157, 0.16685669124126434], [0.16684752702713013, 0.16576525568962097, 0.1669914275407791, 0.1670634150505066, 0.16663026809692383, 0.16670212149620056], [0.16679693758487701, 0.16601747274398804, 0.16690047085285187, 0.1669522523880005, 0.16664057970046997, 0.16669228672981262], [0.16710054874420166, 0.16450287401676178, 0.16744771599769592, 0.16762156784534454, 0.16657719016075134, 0.16675014793872833], [0.1670503169298172, 0.16475358605384827, 0.167356938123703, 0.16751046478748322, 0.1665879189968109, 0.16674074530601501]], [[0.16742374002933502, 0.16611845791339874, 0.1659894585609436, 0.16586056351661682, 0.1690046489238739, 0.16560307145118713], [0.1685992181301117, 0.1652461588382721, 0.1649170070886612, 0.16458852589130402, 0.17271551489830017, 0.16393353044986725], [0.16871516406536102, 0.1651586890220642, 0.16480980813503265, 0.16446168720722198, 0.17308704555034637, 0.16376760601997375], [0.168831005692482, 0.1650710552930832, 0.16470247507095337, 0.1643347144126892, 0.17345915734767914, 0.16360166668891907], [0.16599540412425995, 0.16714411973953247, 0.16725856065750122, 0.16737307608127594, 0.16462650895118713, 0.16760236024856567], [0.16906221210956573, 0.16489528119564056, 0.1644873470067978, 0.1640804409980774, 0.17420509457588196, 0.16326960921287537]], [[0.16694699227809906, 0.1652602106332779, 0.16819527745246887, 0.16728420555591583, 0.16660790145397186, 0.16570542752742767], [0.1676805466413498, 0.1614784449338913, 0.17238108813762665, 0.1689409762620926, 0.16642002761363983, 0.16309888660907745], [0.16638430953025818, 0.16806365549564362, 0.1651630997657776, 0.16605262458324432, 0.16671918332576752, 0.1676170974969864], [0.16679660975933075, 0.16601714491844177, 0.1673707216978073, 0.16695192456245422, 0.1666402667760849, 0.16622328758239746], [0.16709697246551514, 0.16449934244155884, 0.16902852058410645, 0.16761799156665802, 0.166573628783226, 0.16518358886241913], [0.16748999059200287, 0.1624758094549179, 0.17126628756523132, 0.16850458085536957, 0.166473850607872, 0.16378942131996155]], [[0.16565686464309692, 0.16818150877952576, 0.1678667962551117, 0.16472864151000977, 0.16945351660251617, 0.16411271691322327], [0.16618479788303375, 0.1673937737941742, 0.1672435998916626, 0.16573788225650787, 0.16799932718276978, 0.1654406189918518], [0.16611967980861664, 0.16749148070812225, 0.16732099652290344, 0.16561293601989746, 0.16817907989025116, 0.1652759462594986], [0.16545958817005157, 0.168473482131958, 0.16809730231761932, 0.16435369849205017, 0.16999532282352448, 0.16362056136131287], [0.16644613444805145, 0.1670004427433014, 0.16693168878555298, 0.1662406623363495, 0.1672772616147995, 0.16610383987426758], [0.16532772779464722, 0.16866794228553772, 0.1682506799697876, 0.16410374641418457, 0.17035700380802155, 0.16329282522201538]]]}, "num_training_step_calls_per_iteration": 1, "evaluation": {"env_runners": {"env_to_module_connector": {"timers": {"connectors": {"add_states_from_episodes_to_batch": 2.7024901692490677e-06, "numpy_to_tensor": 1.2481325039973498e-05, "add_time_dim_to_batch_and_zero_pad": 6.859873510121776e-06, "add_observations_from_episodes_to_batch": 2.7586542459161257e-06, "batch_individual_items": 1.2476917739763823e-05}}, "connector_pipeline_timer": 5.9325374461298915e-05}, "module_to_env_connector": {"timers": {"connectors": {"tensor_to_numpy": 1.5134384181447386e-05, "remove_single_ts_time_rank_from_batch": 1.2011506321055941e-05, "un_batch_to_individual_items": 6.513298273411448e-06, "normalize_and_clip_actions": 8.006269113542937e-06, "get_actions": 3.7034587856815226e-05, "listify_data_for_vector_env": 1.0503957662993732e-05}}, "connector_pipeline_timer": 0.00011523777954414937}, "num_env_steps_sampled": 400, "num_agent_steps_sampled_lifetime": {"default_agent": 3600}, "env_step_timer": 1.4340777680405175e-05, "episode_len_max": 20, "num_episodes_lifetime": 180, "sample": 0.11581223943599896, "weights_seq_no": 9.0, "env_to_module_sum_episodes_length_in": 10.368238394574323, "module_episode_returns_mean": {"default_policy": 0.15}, "num_env_steps_sampled_lifetime": 45400, "agent_episode_returns_mean": {"default_agent": 0.15}, "episode_duration_sec_mean": 0.005341032019350678, "episode_return_mean": 0.15, "episode_return_min": -14.5, "env_reset_timer": 0.00044829087776500625, "episode_len_mean": 20.0, "episode_return_max": 14.5, "rlmodule_inference_timer": 3.193197735674621e-05, "episode_len_min": 20, "num_episodes": 20, "env_to_module_sum_episodes_length_out": 10.368238394574323, "num_module_steps_sampled_lifetime": {"default_policy": 3600}, "num_module_steps_sampled": {"default_policy": 400}, "num_agent_steps_sampled": {"default_agent": 400}, "time_between_sampling": 9.742501127883305}, "num_healthy_workers": 1, "actor_manager_num_outstanding_async_reqs": 0, "num_remote_worker_restarts": 0}, "num_env_steps_sampled_lifetime": -4312500.0, "fault_tolerance": {"num_healthy_workers": 0, "num_remote_worker_restarts": 0}, "env_runner_group": {"actor_manager_num_outstanding_async_reqs": 0}, "done": false, "training_iteration": 9, "trial_id": "b5096_00000", "date": "2025-08-11_18-45-52", "timestamp": 1754930752, "time_this_iter_s": 10.60997724533081, "time_total_s": 89.30864119529724, "pid": 11702, "hostname": "Mac", "node_ip": "127.0.0.1", "config": {"exploration_config": {}, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 2, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "env": "Umbrella", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": false, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 0, "create_local_env_runner": true, "num_envs_per_env_runner": 1, "gym_env_vectorize_mode": "SYNC", "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "episodes_to_numpy": true, "max_requests_in_flight_per_env_runner": 1, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "merge_env_runner_states": "training_only", "broadcast_env_runner_states": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "complete_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "sampler_perf_stats_ema_coef": null, "_is_online": true, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": "auto", "num_aggregator_actors_per_learner": 0, "max_requests_in_flight_per_aggregator_actor": 3, "local_gpu_idx": 0, "max_requests_in_flight_per_learner": 3, "gamma": 1, "lr": 0.0002715581955, "grad_clip": 0.5, "grad_clip_by": "global_norm", "_train_batch_size_per_learner": 5000, "train_batch_size": 4000, "num_epochs": 1, "minibatch_size": 1000, "shuffle_batch_per_epoch": true, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "log_std_clip_param": 20.0, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "_disable_preprocessor_api": false, "_disable_action_flattening": false}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {"intrinsic_reward_coeff": 0.2795015916508}, "optimizer": {}, "_learner_class": "<class 'source.intrinsic_attention_ppo.learners.IntrinsicAttentionMetaLearner.IntrinsicAttentionMetaLearner'>", "callbacks_on_algorithm_init": null, "callbacks_on_env_runners_recreated": null, "callbacks_on_offline_eval_runners_recreated": null, "callbacks_on_checkpoint_loaded": null, "callbacks_on_environment_created": null, "callbacks_on_episode_created": null, "callbacks_on_episode_start": null, "callbacks_on_episode_step": null, "callbacks_on_episode_end": null, "callbacks_on_evaluate_start": null, "callbacks_on_evaluate_end": null, "callbacks_on_evaluate_offline_start": null, "callbacks_on_evaluate_offline_end": null, "callbacks_on_sample_end": null, "callbacks_on_train_result": null, "explore": true, "enable_rl_module_and_learner": true, "enable_env_runner_and_connector_v2": true, "_prior_exploration_config": {"type": "StochasticSampling"}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x3866e5760>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "offline_data_class": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_read_batch_size": null, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "materialize_data": false, "materialize_mapped_data": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "ignore_final_observation": false, "prelearner_class": null, "prelearner_buffer_class": null, "prelearner_buffer_kwargs": {}, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_remaining_data": false, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": 1, "evaluation_duration": 20, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_auto_duration_min_env_steps_per_sample": 100, "evaluation_auto_duration_max_env_steps_per_sample": 2000, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 1, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "offline_evaluation_interval": null, "num_offline_eval_runners": 0, "offline_loss_for_module_fn": null, "offline_evaluation_duration": 1, "offline_evaluation_parallel_to_training": false, "offline_evaluation_timeout_s": 120.0, "num_cpus_per_offline_eval_runner": 1, "num_gpus_per_offline_eval_runner": 0, "custom_resources_per_offline_eval_runner": {}, "restart_failed_offline_eval_runners": true, "ignore_offline_eval_runner_failures": false, "max_num_offline_eval_runner_restarts": 1000, "offline_eval_runner_restore_timeout_s": 1800.0, "max_requests_in_flight_per_offline_eval_runner": 1, "validate_offline_eval_runners_after_construction": true, "offline_eval_runner_health_probe_timeout_s": 30.0, "offline_eval_rl_module_inference_only": false, "broadcast_offline_eval_runner_states": false, "offline_eval_batch_size_per_runner": 256, "dataset_num_iters_per_eval_runner": 1, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "log_gradients": false, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 8, "restart_failed_env_runners": true, "ignore_env_runner_failures": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30.0, "env_runner_restore_timeout_s": 1800.0, "_model_config": {}, "_rl_module_spec": "MultiRLModuleSpec(multi_rl_module_class=<class 'ray.rllib.core.rl_module.multi_rl_module.MultiRLModule'>, observation_space=None, action_space=None, inference_only=False, model_config=None, rl_module_specs={'default_policy': RLModuleSpec(module_class=<class 'source.intrinsic_attention_ppo.rl_modules.DifferentiablePPOModule.DifferentiablePPOModule'>, observation_space=None, action_space=None, inference_only=False, learner_only=False, model_config={'vf_share_layers': True, 'embedding_dim': 62, 'max_seq_len': 6, 'policy_head_hidden_sizes': [32], 'value_head_hidden_sizes': [101], 'embedding_hidden_sizes': [121]}, catalog_class=None, load_state_path=None, model_config_dict=None), 'intrinsic_reward_module': RLModuleSpec(module_class=<class 'source.intrinsic_attention_ppo.rl_modules.IntrinsicAttentionModule.IntrinsicAttentionModule'>, observation_space=None, action_space=None, inference_only=False, learner_only=True, model_config={'intrinsic_reward_network': {'encoder_hidden_sizes': [], 'encoding_dim': 1, 'num_heads': 1, 'head_hidden_sizes': None, 'layers': [{'type': 'attention'}]}, 'extrinsic_value_hidden_layers': [127, 60], 'vf_share_layers': True, 'max_seq_len': 6}, catalog_class=None, load_state_path=None, model_config_dict=None)}, load_state_path=None, modules_to_load=None, module_specs={'default_policy': RLModuleSpec(module_class=<class 'source.intrinsic_attention_ppo.rl_modules.DifferentiablePPOModule.DifferentiablePPOModule'>, observation_space=None, action_space=None, inference_only=False, learner_only=False, model_config={'vf_share_layers': True, 'embedding_dim': 62, 'max_seq_len': 6, 'policy_head_hidden_sizes': [32], 'value_head_hidden_sizes': [101], 'embedding_hidden_sizes': [121]}, catalog_class=None, load_state_path=None, model_config_dict=None), 'intrinsic_reward_module': RLModuleSpec(module_class=<class 'source.intrinsic_attention_ppo.rl_modules.IntrinsicAttentionModule.IntrinsicAttentionModule'>, observation_space=None, action_space=None, inference_only=False, learner_only=True, model_config={'intrinsic_reward_network': {'encoder_hidden_sizes': [], 'encoding_dim': 1, 'num_heads': 1, 'head_hidden_sizes': None, 'layers': [{'type': 'attention'}]}, 'extrinsic_value_hidden_layers': [127, 60], 'vf_share_layers': True, 'max_seq_len': 6}, catalog_class=None, load_state_path=None, model_config_dict=None)})", "algorithm_config_overrides_per_module": {"intrinsic_reward_module": {"lr": 0.0002715581955}}, "_per_module_overrides": {}, "_validate_config": true, "_use_msgpack_checkpoints": false, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "env_task_fn": -1, "enable_connectors": -1, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.161583927863, "kl_target": 0.0201019014258, "vf_loss_coeff": 0.7790510010087, "entropy_coeff": 0.0015431216992, "clip_param": 0.2459212356676, "vf_clip_param": 0.3769744131561, "entropy_coeff_schedule": null, "lr_schedule": null, "sgd_minibatch_size": -1, "vf_share_layers": -1, "differentiable_learner_configs": ["DifferentiableLearnerConfig(learner_class=<class 'source.intrinsic_attention_ppo.learners.IntrinsicAttentionPPOLearner.IntrinsicAttentionPPOLearner'>, learner_connector=None, add_default_connectors_to_learner_pipeline=True, is_multi_agent=False, policies_to_update=['default_policy'], lr=0.0060984166342, num_total_minibatches=0, num_epochs=1, minibatch_size=1000, shuffle_batch_per_epoch=True)"], "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9485408017724, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.callbacks.callbacks.RLlibCallback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 89.30864119529724, "iterations_since_restore": 9, "perf": {"cpu_util_percent": 48.84375, "ram_util_percent": 80.40625}}
{"timers": {"training_iteration": 10.256392573450652, "restore_env_runners": 1.1270895708032127e-05, "training_step": 10.25622920712357, "env_runner_sampling_timer": 1.659055451755538, "learner_update_timer": 8.405407793923112, "synch_weights": 0.0013262994418736442, "restore_eval_env_runners": 3.165796184008512e-05, "evaluation_iteration": 0.12484672627485463, "synch_eval_env_connectors": 0.00015555351661079966, "synch_env_connectors": 4.374216019559039e-06}, "env_runners": {"episode_duration_sec_mean": 0.005898494986817243, "env_to_module_connector": {"timers": {"connectors": {"numpy_to_tensor": 1.4376317880603317e-05, "add_observations_from_episodes_to_batch": 3.0563207805424783e-06, "batch_individual_items": 1.3822845595143932e-05, "add_time_dim_to_batch_and_zero_pad": 7.727409161407505e-06, "add_states_from_episodes_to_batch": 2.9437552547151772e-06}}, "connector_pipeline_timer": 6.580039093311916e-05}, "num_env_steps_sampled": 5000.0, "episode_return_min": -11.5, "module_to_env_connector": {"timers": {"connectors": {"normalize_and_clip_actions": 8.919724470441734e-06, "un_batch_to_individual_items": 7.160511676603675e-06, "get_actions": 4.553661137060004e-05, "remove_single_ts_time_rank_from_batch": 1.3198641703981417e-05, "listify_data_for_vector_env": 1.1859707379827146e-05, "tensor_to_numpy": 1.7030202959882846e-05}}, "connector_pipeline_timer": 0.0001325380067178514}, "env_reset_timer": 4.681287913070355e-05, "sample": 0.006165370093409643, "num_episodes_lifetime": -246500.0, "env_to_module_sum_episodes_length_out": 10.36823839457432, "env_step_timer": 1.5676671846154594e-05, "num_module_steps_sampled_lifetime": {"default_policy": -4930000.0}, "weights_seq_no": 9.0, "module_episode_returns_mean": {"default_policy": -0.6199999999999999}, "env_to_module_sum_episodes_length_in": 10.36823839457432, "episode_len_mean": 20.0, "agent_episode_returns_mean": {"default_agent": -0.6199999999999999}, "time_between_sampling": 0.037178072255064316, "num_module_steps_sampled": {"default_policy": 5000.0}, "episode_return_max": 8.5, "episode_len_min": 20, "episode_len_max": 20, "rlmodule_inference_timer": 3.5838324866308704e-05, "num_agent_steps_sampled": {"default_agent": 5000.0}, "num_episodes": 250.0, "num_env_steps_sampled_lifetime": -4930000.0, "num_agent_steps_sampled_lifetime": {"default_agent": -4930000.0}, "episode_return_mean": -0.6199999999999999, "num_env_steps_sampled_lifetime_throughput": 3043.7463082224467}, "__all_modules__": {"learner_connector_sum_episodes_length_in": 5000.0, "learner_connector": {"connector_pipeline_timer": 0.1533038864791509, "timers": {"connectors": {"add_one_ts_to_episodes_and_truncate": 0.008811794175272876, "add_observations_from_episodes_to_batch": 0.000812708141160977, "add_columns_from_episodes_to_train_batch": 0.0411258952938919, "add_time_dim_to_batch_and_zero_pad": 0.09015324258678324, "add_states_from_episodes_to_batch": 0.0036255118477572213, "batch_individual_items": 0.00854384396291464, "numpy_to_tensor": 7.875846168326892e-05}}}, "learner_connector_sum_episodes_length_out": 5250.0}, "learners": {"default_policy": {"num_module_steps_trained_lifetime": 59850, "weights_seq_no": 10.0, "entropy": 0.6892510056495667, "num_module_steps_trained": 5985, "vf_loss": 0.32051119208335876, "mean_kl_loss": 2.0688550648628734e-05, "num_trainable_parameters": 16595, "curr_entropy_coeff": 0.0015431216992, "module_train_batch_size_mean": 998.3173215714437, "vf_explained_var": -0.0005583763122558594, "total_loss": 0.2483719289302826, "vf_loss_unclipped": 42.404239654541016, "policy_loss": -0.00025904178619384766, "use_intrinsic_rewards": 0.0, "diff_num_grad_updates_vs_sampler_policy": 1.0, "curr_kl_coeff": 0.00015779680688865483, "num_module_steps_trained_lifetime_throughput": 661.6064999163981}, "intrinsic_reward_module": {"total_loss": 0.0, "gradients_default_optimizer_global_norm": 0.0, "num_module_steps_trained_lifetime": 59850, "num_module_steps_trained": 5985, "weights_seq_no": 10.0, "num_trainable_parameters": 8266, "curr_entropy_coeff": 0.0015431216992, "module_train_batch_size_mean": 998.3173215714437, "default_optimizer_learning_rate": 0.0002715581955, "diff_num_grad_updates_vs_sampler_policy": 1.0, "num_module_steps_trained_lifetime_throughput": 661.6130445551984}, "differentiable_learners": {"intrinsic_attention_ppo_learner": {"default_policy": {"num_module_steps_trained": 35910, "weights_seq_no": 60.0, "entropy": 0.6892723441123962, "vf_loss": 0.32061967253685, "mean_kl_loss": 1.917309418786317e-05, "module_train_batch_size_mean": 997.532914147147, "vf_explained_var": 0.0009932518005371094, "diff_num_grad_updates_vs_sampler_policy": 51.0, "total_loss": 0.24846917390823364, "vf_loss_unclipped": 42.3663215637207, "policy_loss": -0.00024937628768384457, "use_intrinsic_rewards": 1.0, "num_module_steps_trained_lifetime": 359100}, "intrinsic_reward_module": {"module_train_batch_size_mean": 997.532914147147, "diff_num_grad_updates_vs_sampler_policy": 51.0, "total_loss": 0.0, "num_module_steps_trained_lifetime": 359100, "num_module_steps_trained": 35910, "weights_seq_no": 60.0}, "__all_modules__": {"num_module_steps_trained_lifetime": 718200, "num_module_steps_trained": 71820, "num_env_steps_trained": 216000, "num_env_steps_trained_lifetime": 2160000, "num_env_steps_trained_lifetime_throughput": 55421.76965167066}}}, "__all_modules__": {"num_module_steps_trained_lifetime": 119700, "num_module_steps_trained": 11970, "num_trainable_parameters": 24861, "num_env_steps_trained": 36000, "num_env_steps_trained_lifetime": 360000, "num_non_trainable_parameters": 0, "num_env_steps_trained_lifetime_throughput": 3983.30683919953, "num_module_steps_trained_throughput": 23827418.550689016, "num_module_steps_trained_lifetime_throughput": 11724124.723619046}, "IntrinsicAttentionMask": [[[0.1666073054075241, 0.16492395102977753, 0.16785304248332977, 0.16796597838401794, 0.16626890003681183, 0.16638076305389404], [0.16641446948051453, 0.1602592021226883, 0.17107951641082764, 0.1715071052312851, 0.16516347229480743, 0.1655762642621994], [0.16671909391880035, 0.1684018224477768, 0.16549542546272278, 0.1653853803873062, 0.16705463826656342, 0.16694356501102448], [0.1667279750108719, 0.16871818900108337, 0.1652829796075821, 0.1651531308889389, 0.16712455451488495, 0.16699324548244476], [0.1665724217891693, 0.16398295760154724, 0.16849790513515472, 0.1686728447675705, 0.1660507172346115, 0.16622312366962433], [0.16658416390419006, 0.16429385542869568, 0.16828450560569763, 0.1684388816356659, 0.16612307727336884, 0.16627547144889832]], [[0.16519035398960114, 0.1677078902721405, 0.16739405691623688, 0.167080819606781, 0.1689763069152832, 0.16365055739879608], [0.16595982015132904, 0.16716715693473816, 0.16701717674732208, 0.16686733067035675, 0.16777189075946808, 0.16521663963794708], [0.16586460173130035, 0.16723430156707764, 0.16706407070159912, 0.16689401865005493, 0.16792084276676178, 0.16502216458320618], [0.16576936841011047, 0.16730137169361115, 0.1671108901500702, 0.16692063212394714, 0.16806983947753906, 0.1648278385400772], [0.1663426011800766, 0.16689656674861908, 0.16682787239551544, 0.166759192943573, 0.16717322170734406, 0.16600053012371063], [0.16471323370933533, 0.16804103553295135, 0.1676253229379654, 0.1672106385231018, 0.16972382366657257, 0.16268590092658997]], [[0.1664392501115799, 0.1657663732767105, 0.16768372058868408, 0.1677965521812439, 0.16610118746757507, 0.16621294617652893], [0.16618944704532623, 0.1647939532995224, 0.16878652572631836, 0.16902300715446472, 0.16548758745193481, 0.16571944952011108], [0.1668882519006729, 0.16755816340446472, 0.16566334664821625, 0.16555318236351013, 0.16722413897514343, 0.16711294651031494], [0.16692814230918884, 0.16772018373012543, 0.16548141837120056, 0.16535140573978424, 0.1673251986503601, 0.16719374060630798], [0.16631436347961426, 0.1652781367301941, 0.1682368665933609, 0.16841153800487518, 0.16579347848892212, 0.16596561670303345], [0.16635578870773315, 0.16543962061405182, 0.16805382072925568, 0.16820797324180603, 0.16589534282684326, 0.16604752838611603]], [[0.16721269488334656, 0.1667994260787964, 0.1663871854543686, 0.16597597301006317, 0.1684681475162506, 0.16515657305717468], [0.1672392338514328, 0.16680575907230377, 0.16637340188026428, 0.16594217717647552, 0.16855642199516296, 0.16508306562900543], [0.16726574301719666, 0.16681206226348877, 0.16635958850383759, 0.1659083515405655, 0.1686447113752365, 0.16500955820083618], [0.1672922521829605, 0.16681833565235138, 0.1663457602262497, 0.16587452590465546, 0.16873303055763245, 0.16493606567382812], [0.1671324074268341, 0.1667802333831787, 0.16642878949642181, 0.1660781055688858, 0.1682015210390091, 0.16537891328334808], [0.16734524071216583, 0.1668308675289154, 0.16631807386875153, 0.1658068597316742, 0.16890977323055267, 0.1647891402244568]], [[0.1668875813484192, 0.16696131229400635, 0.166394904255867, 0.16568627953529358, 0.1667492836713791, 0.1673206388950348], [0.16682203114032745, 0.16687381267547607, 0.1664758324623108, 0.1659773588180542, 0.16672489047050476, 0.16712607443332672], [0.16732336580753326, 0.16754452884197235, 0.16585052013397217, 0.16374735534191132, 0.16690906882286072, 0.1686251163482666], [0.16794319450855255, 0.16837871074676514, 0.16505683958530426, 0.1609777808189392, 0.1671288013458252, 0.17051462829113007], [0.16701029241085052, 0.16712528467178345, 0.16624270379543304, 0.16514092683792114, 0.16679470241069794, 0.16768603026866913], [0.16650131344795227, 0.16644655168056488, 0.16686828434467316, 0.16739940643310547, 0.16660411655902863, 0.1661803126335144]], [[0.16703204810619354, 0.165729820728302, 0.16560113430023193, 0.16664324700832367, 0.16860926151275635, 0.1663845330476761], [0.16759391129016876, 0.1642608344554901, 0.1639336794614792, 0.1665944755077362, 0.17168566584587097, 0.16593147814273834], [0.16764895617961884, 0.16411495208740234, 0.16376827657222748, 0.16658879816532135, 0.1719931960105896, 0.16588576138019562], [0.1672006994485855, 0.16529257595539093, 0.16510438919067383, 0.16663025319576263, 0.1695210337638855, 0.1662510335445404], [0.16634045541286469, 0.16749154031276703, 0.16760621964931488, 0.16668236255645752, 0.16496871411800385, 0.16691069304943085], [0.16731248795986176, 0.1650010049343109, 0.1647733449935913, 0.1666208803653717, 0.1701308786869049, 0.16616137325763702]]]}, "num_training_step_calls_per_iteration": 1, "evaluation": {"env_runners": {"env_to_module_connector": {"timers": {"connectors": {"add_states_from_episodes_to_batch": 2.635549584942618e-06, "numpy_to_tensor": 1.1873818642704372e-05, "add_time_dim_to_batch_and_zero_pad": 6.611045608244014e-06, "add_observations_from_episodes_to_batch": 2.734839993459614e-06, "batch_individual_items": 1.2050199816279093e-05}}, "connector_pipeline_timer": 5.755074135291228e-05}, "module_to_env_connector": {"timers": {"connectors": {"tensor_to_numpy": 1.4764600286562736e-05, "remove_single_ts_time_rank_from_batch": 1.1726342160244498e-05, "un_batch_to_individual_items": 6.44116280826832e-06, "normalize_and_clip_actions": 7.880189080981231e-06, "get_actions": 3.501014569554797e-05, "listify_data_for_vector_env": 1.0209545265948322e-05}}, "connector_pipeline_timer": 0.00011199110113791329}, "num_env_steps_sampled": 400, "num_agent_steps_sampled_lifetime": {"default_agent": 4000}, "env_step_timer": 1.375515616198092e-05, "episode_len_max": 20, "num_episodes_lifetime": 200, "sample": 0.1157640162123357, "weights_seq_no": 10.0, "env_to_module_sum_episodes_length_in": 10.368238394574323, "module_episode_returns_mean": {"default_policy": -0.05}, "num_env_steps_sampled_lifetime": 50400, "agent_episode_returns_mean": {"default_agent": -0.05}, "episode_duration_sec_mean": 0.005230249960441143, "episode_return_mean": -0.05, "episode_return_min": -14.5, "env_reset_timer": 0.00044462296937240216, "episode_len_mean": 20.0, "episode_return_max": 14.5, "rlmodule_inference_timer": 3.029570129720101e-05, "episode_len_min": 20, "num_episodes": 20, "env_to_module_sum_episodes_length_out": 10.368238394574323, "num_module_steps_sampled_lifetime": {"default_policy": 4000}, "num_module_steps_sampled": {"default_policy": 400}, "num_agent_steps_sampled": {"default_agent": 400}, "time_between_sampling": 9.746801937014537}, "num_healthy_workers": 1, "actor_manager_num_outstanding_async_reqs": 0, "num_remote_worker_restarts": 0}, "num_env_steps_sampled_lifetime": -4930000.0, "fault_tolerance": {"num_healthy_workers": 0, "num_remote_worker_restarts": 0}, "env_runner_group": {"actor_manager_num_outstanding_async_reqs": 0}, "done": false, "training_iteration": 10, "trial_id": "b5096_00000", "date": "2025-08-11_18-46-02", "timestamp": 1754930762, "time_this_iter_s": 10.264723062515259, "time_total_s": 99.5733642578125, "pid": 11702, "hostname": "Mac", "node_ip": "127.0.0.1", "config": {"exploration_config": {}, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 2, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "env": "Umbrella", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": false, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 0, "create_local_env_runner": true, "num_envs_per_env_runner": 1, "gym_env_vectorize_mode": "SYNC", "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "episodes_to_numpy": true, "max_requests_in_flight_per_env_runner": 1, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "merge_env_runner_states": "training_only", "broadcast_env_runner_states": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "complete_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "sampler_perf_stats_ema_coef": null, "_is_online": true, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": "auto", "num_aggregator_actors_per_learner": 0, "max_requests_in_flight_per_aggregator_actor": 3, "local_gpu_idx": 0, "max_requests_in_flight_per_learner": 3, "gamma": 1, "lr": 0.0002715581955, "grad_clip": 0.5, "grad_clip_by": "global_norm", "_train_batch_size_per_learner": 5000, "train_batch_size": 4000, "num_epochs": 1, "minibatch_size": 1000, "shuffle_batch_per_epoch": true, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "log_std_clip_param": 20.0, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "_disable_preprocessor_api": false, "_disable_action_flattening": false}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {"intrinsic_reward_coeff": 0.2795015916508}, "optimizer": {}, "_learner_class": "<class 'source.intrinsic_attention_ppo.learners.IntrinsicAttentionMetaLearner.IntrinsicAttentionMetaLearner'>", "callbacks_on_algorithm_init": null, "callbacks_on_env_runners_recreated": null, "callbacks_on_offline_eval_runners_recreated": null, "callbacks_on_checkpoint_loaded": null, "callbacks_on_environment_created": null, "callbacks_on_episode_created": null, "callbacks_on_episode_start": null, "callbacks_on_episode_step": null, "callbacks_on_episode_end": null, "callbacks_on_evaluate_start": null, "callbacks_on_evaluate_end": null, "callbacks_on_evaluate_offline_start": null, "callbacks_on_evaluate_offline_end": null, "callbacks_on_sample_end": null, "callbacks_on_train_result": null, "explore": true, "enable_rl_module_and_learner": true, "enable_env_runner_and_connector_v2": true, "_prior_exploration_config": {"type": "StochasticSampling"}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x3866e5760>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "offline_data_class": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_read_batch_size": null, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "materialize_data": false, "materialize_mapped_data": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "ignore_final_observation": false, "prelearner_class": null, "prelearner_buffer_class": null, "prelearner_buffer_kwargs": {}, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_remaining_data": false, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": 1, "evaluation_duration": 20, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_auto_duration_min_env_steps_per_sample": 100, "evaluation_auto_duration_max_env_steps_per_sample": 2000, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 1, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "offline_evaluation_interval": null, "num_offline_eval_runners": 0, "offline_loss_for_module_fn": null, "offline_evaluation_duration": 1, "offline_evaluation_parallel_to_training": false, "offline_evaluation_timeout_s": 120.0, "num_cpus_per_offline_eval_runner": 1, "num_gpus_per_offline_eval_runner": 0, "custom_resources_per_offline_eval_runner": {}, "restart_failed_offline_eval_runners": true, "ignore_offline_eval_runner_failures": false, "max_num_offline_eval_runner_restarts": 1000, "offline_eval_runner_restore_timeout_s": 1800.0, "max_requests_in_flight_per_offline_eval_runner": 1, "validate_offline_eval_runners_after_construction": true, "offline_eval_runner_health_probe_timeout_s": 30.0, "offline_eval_rl_module_inference_only": false, "broadcast_offline_eval_runner_states": false, "offline_eval_batch_size_per_runner": 256, "dataset_num_iters_per_eval_runner": 1, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "log_gradients": false, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 8, "restart_failed_env_runners": true, "ignore_env_runner_failures": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30.0, "env_runner_restore_timeout_s": 1800.0, "_model_config": {}, "_rl_module_spec": "MultiRLModuleSpec(multi_rl_module_class=<class 'ray.rllib.core.rl_module.multi_rl_module.MultiRLModule'>, observation_space=None, action_space=None, inference_only=False, model_config=None, rl_module_specs={'default_policy': RLModuleSpec(module_class=<class 'source.intrinsic_attention_ppo.rl_modules.DifferentiablePPOModule.DifferentiablePPOModule'>, observation_space=None, action_space=None, inference_only=False, learner_only=False, model_config={'vf_share_layers': True, 'embedding_dim': 62, 'max_seq_len': 6, 'policy_head_hidden_sizes': [32], 'value_head_hidden_sizes': [101], 'embedding_hidden_sizes': [121]}, catalog_class=None, load_state_path=None, model_config_dict=None), 'intrinsic_reward_module': RLModuleSpec(module_class=<class 'source.intrinsic_attention_ppo.rl_modules.IntrinsicAttentionModule.IntrinsicAttentionModule'>, observation_space=None, action_space=None, inference_only=False, learner_only=True, model_config={'intrinsic_reward_network': {'encoder_hidden_sizes': [], 'encoding_dim': 1, 'num_heads': 1, 'head_hidden_sizes': None, 'layers': [{'type': 'attention'}]}, 'extrinsic_value_hidden_layers': [127, 60], 'vf_share_layers': True, 'max_seq_len': 6}, catalog_class=None, load_state_path=None, model_config_dict=None)}, load_state_path=None, modules_to_load=None, module_specs={'default_policy': RLModuleSpec(module_class=<class 'source.intrinsic_attention_ppo.rl_modules.DifferentiablePPOModule.DifferentiablePPOModule'>, observation_space=None, action_space=None, inference_only=False, learner_only=False, model_config={'vf_share_layers': True, 'embedding_dim': 62, 'max_seq_len': 6, 'policy_head_hidden_sizes': [32], 'value_head_hidden_sizes': [101], 'embedding_hidden_sizes': [121]}, catalog_class=None, load_state_path=None, model_config_dict=None), 'intrinsic_reward_module': RLModuleSpec(module_class=<class 'source.intrinsic_attention_ppo.rl_modules.IntrinsicAttentionModule.IntrinsicAttentionModule'>, observation_space=None, action_space=None, inference_only=False, learner_only=True, model_config={'intrinsic_reward_network': {'encoder_hidden_sizes': [], 'encoding_dim': 1, 'num_heads': 1, 'head_hidden_sizes': None, 'layers': [{'type': 'attention'}]}, 'extrinsic_value_hidden_layers': [127, 60], 'vf_share_layers': True, 'max_seq_len': 6}, catalog_class=None, load_state_path=None, model_config_dict=None)})", "algorithm_config_overrides_per_module": {"intrinsic_reward_module": {"lr": 0.0002715581955}}, "_per_module_overrides": {}, "_validate_config": true, "_use_msgpack_checkpoints": false, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "env_task_fn": -1, "enable_connectors": -1, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.161583927863, "kl_target": 0.0201019014258, "vf_loss_coeff": 0.7790510010087, "entropy_coeff": 0.0015431216992, "clip_param": 0.2459212356676, "vf_clip_param": 0.3769744131561, "entropy_coeff_schedule": null, "lr_schedule": null, "sgd_minibatch_size": -1, "vf_share_layers": -1, "differentiable_learner_configs": ["DifferentiableLearnerConfig(learner_class=<class 'source.intrinsic_attention_ppo.learners.IntrinsicAttentionPPOLearner.IntrinsicAttentionPPOLearner'>, learner_connector=None, add_default_connectors_to_learner_pipeline=True, is_multi_agent=False, policies_to_update=['default_policy'], lr=0.0060984166342, num_total_minibatches=0, num_epochs=1, minibatch_size=1000, shuffle_batch_per_epoch=True)"], "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9485408017724, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.callbacks.callbacks.RLlibCallback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 99.5733642578125, "iterations_since_restore": 10, "perf": {"cpu_util_percent": 39.114285714285714, "ram_util_percent": 79.75}}
{"timers": {"training_iteration": 10.248266088126403, "restore_env_runners": 1.122276698658208e-05, "training_step": 10.248102089212505, "env_runner_sampling_timer": 1.6587566126580668, "learner_update_timer": 8.397471441403924, "synch_weights": 0.0013282751967839085, "restore_eval_env_runners": 3.1413461932346634e-05, "evaluation_iteration": 0.12476141234266871, "synch_eval_env_connectors": 0.00015514881209353115, "synch_env_connectors": 4.369642958545339e-06}, "env_runners": {"episode_duration_sec_mean": 0.005657316850032658, "env_to_module_connector": {"timers": {"connectors": {"numpy_to_tensor": 2.7859934108854807e-05, "add_observations_from_episodes_to_batch": 2.813429582186003e-06, "batch_individual_items": 1.2590239161449149e-05, "add_time_dim_to_batch_and_zero_pad": 7.0577651859690665e-06, "add_states_from_episodes_to_batch": 2.728813637947372e-06}}, "connector_pipeline_timer": 7.519473337572355e-05}, "num_env_steps_sampled": 5000.0, "episode_return_min": -11.5, "module_to_env_connector": {"timers": {"connectors": {"normalize_and_clip_actions": 8.09179601619319e-06, "un_batch_to_individual_items": 6.558044997117858e-06, "get_actions": 3.982470700096036e-05, "remove_single_ts_time_rank_from_batch": 1.1974192205188274e-05, "listify_data_for_vector_env": 1.0599989525806503e-05, "tensor_to_numpy": 1.527713893232637e-05}}, "connector_pipeline_timer": 0.00011880009087214747}, "env_reset_timer": 4.0252691644315165e-05, "sample": 0.006074254987100763, "num_episodes_lifetime": -277375.0, "env_to_module_sum_episodes_length_out": 10.36823839457432, "env_step_timer": 1.3952491291070974e-05, "num_module_steps_sampled_lifetime": {"default_policy": -5547500.0}, "weights_seq_no": 10.0, "module_episode_returns_mean": {"default_policy": -1.0999999999999996}, "env_to_module_sum_episodes_length_in": 10.36823839457432, "episode_len_mean": 20.0, "agent_episode_returns_mean": {"default_agent": -1.0999999999999996}, "time_between_sampling": 0.03436662256672407, "num_module_steps_sampled": {"default_policy": 5000.0}, "episode_return_max": 8.5, "episode_len_min": 20, "episode_len_max": 20, "rlmodule_inference_timer": 3.179651992904203e-05, "num_agent_steps_sampled": {"default_agent": 5000.0}, "num_episodes": 250.0, "num_env_steps_sampled_lifetime": -5547500.0, "num_agent_steps_sampled_lifetime": {"default_agent": -5547500.0}, "episode_return_mean": -1.0999999999999996, "num_env_steps_sampled_lifetime_throughput": 3231.72463730581}, "__all_modules__": {"learner_connector_sum_episodes_length_in": 5000.0, "learner_connector": {"connector_pipeline_timer": 0.15329595053449116, "timers": {"connectors": {"add_one_ts_to_episodes_and_truncate": 0.00881340665367001, "add_observations_from_episodes_to_batch": 0.0008129098100132668, "add_columns_from_episodes_to_train_batch": 0.04113310759023907, "add_time_dim_to_batch_and_zero_pad": 0.09014127349089891, "add_states_from_episodes_to_batch": 0.003627205068293032, "batch_individual_items": 0.008536050113341064, "numpy_to_tensor": 8.022920741717798e-05}}}, "learner_connector_sum_episodes_length_out": 5250.0}, "learners": {"default_policy": {"num_module_steps_trained_lifetime": 65835, "weights_seq_no": 11.0, "entropy": 0.6884905695915222, "num_module_steps_trained": 5985, "vf_loss": 0.3205111026763916, "mean_kl_loss": 2.5450000975979492e-05, "num_trainable_parameters": 16595, "curr_entropy_coeff": 0.0015431216992, "module_train_batch_size_mean": 998.2690509307901, "vf_explained_var": -0.0005556344985961914, "total_loss": 0.24850040674209595, "vf_loss_unclipped": 41.91103744506836, "policy_loss": -0.00013164477422833443, "use_intrinsic_rewards": 0.0, "diff_num_grad_updates_vs_sampler_policy": 1.0, "curr_kl_coeff": 7.889840344432741e-05, "num_module_steps_trained_lifetime_throughput": 663.0726454086772}, "intrinsic_reward_module": {"total_loss": 0.0, "gradients_default_optimizer_global_norm": 0.0, "num_module_steps_trained_lifetime": 65835, "num_module_steps_trained": 5985, "weights_seq_no": 11.0, "num_trainable_parameters": 8266, "curr_entropy_coeff": 0.0015431216992, "module_train_batch_size_mean": 998.2690509307901, "default_optimizer_learning_rate": 0.0002715581955, "diff_num_grad_updates_vs_sampler_policy": 1.0, "num_module_steps_trained_lifetime_throughput": 663.078741322159}, "differentiable_learners": {"intrinsic_attention_ppo_learner": {"default_policy": {"num_module_steps_trained": 35910, "weights_seq_no": 66.0, "entropy": 0.68849778175354, "vf_loss": 0.3206067383289337, "mean_kl_loss": 2.489544749550987e-05, "module_train_batch_size_mean": 997.5206335045569, "vf_explained_var": 0.0007515549659729004, "diff_num_grad_updates_vs_sampler_policy": 56.0, "total_loss": 0.24858109652996063, "vf_loss_unclipped": 41.86838150024414, "policy_loss": -0.0001294884568778798, "use_intrinsic_rewards": 1.0, "num_module_steps_trained_lifetime": 395010}, "intrinsic_reward_module": {"module_train_batch_size_mean": 997.5206335045569, "diff_num_grad_updates_vs_sampler_policy": 56.0, "total_loss": 0.0, "num_module_steps_trained_lifetime": 395010, "num_module_steps_trained": 35910, "weights_seq_no": 66.0}, "__all_modules__": {"num_module_steps_trained_lifetime": 790020, "num_module_steps_trained": 71820, "num_env_steps_trained": 216000, "num_env_steps_trained_lifetime": 2376000, "num_env_steps_trained_lifetime_throughput": 54440.61282369294}}}, "__all_modules__": {"num_module_steps_trained_lifetime": 131670, "num_module_steps_trained": 11970, "num_trainable_parameters": 24861, "num_env_steps_trained": 36000, "num_env_steps_trained_lifetime": 396000, "num_non_trainable_parameters": 0, "num_env_steps_trained_lifetime_throughput": 3991.987480311417, "num_module_steps_trained_throughput": 23226328.218336765, "num_module_steps_trained_lifetime_throughput": 11738068.50177919}, "IntrinsicAttentionMask": [[[0.1667802780866623, 0.16749660670757294, 0.16628789901733398, 0.16557975113391876, 0.16728389263153076, 0.1665714979171753], [0.16644610464572906, 0.1651066392660141, 0.16737645864486694, 0.1687285453081131, 0.165502667427063, 0.1668396145105362], [0.1669994741678238, 0.16915357112884521, 0.16552945971488953, 0.1634303778409958, 0.1685120016336441, 0.1663750857114792], [0.16729947924613953, 0.17155694961547852, 0.16442418098449707, 0.16036075353622437, 0.1702834516763687, 0.1660752296447754], [0.16654722392559052, 0.16581378877162933, 0.16705507040023804, 0.16779087483882904, 0.1660309135913849, 0.16676218807697296], [0.16687427461147308, 0.16819779574871063, 0.16596731543540955, 0.16466686129570007, 0.1678042858839035, 0.16648942232131958]], [[0.16564519703388214, 0.16533522307872772, 0.16785497963428497, 0.16471704840660095, 0.17234641313552856, 0.16410116851329803], [0.1655779480934143, 0.16524814069271088, 0.16793029010295868, 0.164590522646904, 0.1727176010608673, 0.16393549740314484], [0.16611622273921967, 0.16594713926315308, 0.16731750965118408, 0.1656094789505005, 0.16973713040351868, 0.16527250409126282], [0.16544294357299805, 0.16507354378700256, 0.1680804193019867, 0.1643371880054474, 0.17346176505088806, 0.16360412538051605], [0.1670299917459488, 0.16714435815811157, 0.16622304916381836, 0.16737331449985504, 0.16462674736976624, 0.16760259866714478], [0.16530731320381165, 0.1648983657360077, 0.16822990775108337, 0.16408349573612213, 0.17420834302902222, 0.1632726639509201]], [[0.16678109765052795, 0.16685478389263153, 0.16628873348236084, 0.16621831059455872, 0.16728472709655762, 0.16657231748104095], [0.16674715280532837, 0.1667989045381546, 0.16640110313892365, 0.1663515865802765, 0.16710078716278076, 0.16660045087337494], [0.16700680553913116, 0.16722753643989563, 0.16553673148155212, 0.16532717645168304, 0.16851940751075745, 0.16638238728046417], [0.16703888773918152, 0.16728073358535767, 0.1654289960861206, 0.1651996374130249, 0.16869676113128662, 0.1663549244403839], [0.16654808819293976, 0.16647234559059143, 0.16705593466758728, 0.16712883114814758, 0.16603177785873413, 0.1667630523443222], [0.16687706112861633, 0.16701297461986542, 0.1659700870513916, 0.16584055125713348, 0.16780708730220795, 0.16649220883846283]], [[0.16905991733074188, 0.16489705443382263, 0.1644895225763321, 0.16408298909664154, 0.17419765889644623, 0.1632729321718216], [0.17021644115447998, 0.16400183737277985, 0.16339753568172455, 0.16279546916484833, 0.17799070477485657, 0.16159796714782715], [0.1703304797410965, 0.1639121025800705, 0.163288414478302, 0.16266711056232452, 0.1783704161643982, 0.16143155097961426], [0.1704443395137787, 0.16382218897342682, 0.16317912936210632, 0.16253860294818878, 0.1787506639957428, 0.1612650603055954], [0.16765311360359192, 0.16595028340816498, 0.16578222811222076, 0.16561433672904968, 0.16972090303897858, 0.1652790606021881], [0.17067165672779083, 0.16364188492298126, 0.16296017169952393, 0.16228128969669342, 0.17951293289661407, 0.1609320044517517]], [[0.16694848239421844, 0.16526170074939728, 0.16717322170734406, 0.16728569567203522, 0.16660940647125244, 0.16672149300575256], [0.1677013784646988, 0.1614985167980194, 0.16854073107242584, 0.16896197199821472, 0.1664407104253769, 0.16685670614242554], [0.16684752702713013, 0.16576525568962097, 0.1669914275407791, 0.1670634150505066, 0.16663028299808502, 0.16670212149620056], [0.16679693758487701, 0.16601747274398804, 0.16690047085285187, 0.1669522523880005, 0.16664057970046997, 0.16669230163097382], [0.16710053384304047, 0.16450285911560059, 0.16744770109653473, 0.16762155294418335, 0.16657717525959015, 0.16675013303756714], [0.1670503169298172, 0.16475360095500946, 0.167356938123703, 0.16751046478748322, 0.1665879338979721, 0.1667407602071762]], [[0.16294217109680176, 0.16236138343811035, 0.16711120307445526, 0.1665155589580536, 0.17573903501033783, 0.1653306484222412], [0.162815660238266, 0.16221573948860168, 0.16712422668933868, 0.16650842130184174, 0.1760522723197937, 0.16528363525867462], [0.1638362556695938, 0.1633918583393097, 0.1670152097940445, 0.16656219959259033, 0.17353461682796478, 0.1656598448753357], [0.16370996832847595, 0.16324619948863983, 0.16702917218208313, 0.1665560007095337, 0.17384490370750427, 0.16561366617679596], [0.16561280190944672, 0.16544508934020996, 0.16680434346199036, 0.1666354238986969, 0.1692042201757431, 0.16629809141159058], [0.16345736384391785, 0.1629549264907837, 0.16705672442913055, 0.16654324531555176, 0.17446675896644592, 0.16552099585533142]]]}, "num_training_step_calls_per_iteration": 1, "evaluation": {"env_runners": {"env_to_module_connector": {"timers": {"connectors": {"add_states_from_episodes_to_batch": 3.2048368399959842e-06, "numpy_to_tensor": 1.410897371450876e-05, "add_time_dim_to_batch_and_zero_pad": 8.015350435071729e-06, "add_observations_from_episodes_to_batch": 3.39853185963632e-06, "batch_individual_items": 1.4516855252694357e-05}}, "connector_pipeline_timer": 6.86802437461231e-05}, "module_to_env_connector": {"timers": {"connectors": {"tensor_to_numpy": 1.7164220909191537e-05, "remove_single_ts_time_rank_from_batch": 1.3786557768535399e-05, "un_batch_to_individual_items": 7.717022126935827e-06, "normalize_and_clip_actions": 9.084275939802461e-06, "get_actions": 4.5698253823883734e-05, "listify_data_for_vector_env": 1.2225275470497076e-05}}, "connector_pipeline_timer": 0.00013547960974672824}, "num_env_steps_sampled": 400, "num_agent_steps_sampled_lifetime": {"default_agent": 4400}, "env_step_timer": 1.7487859798299808e-05, "episode_len_max": 20, "num_episodes_lifetime": 220, "sample": 0.11593795563996297, "weights_seq_no": 11.0, "env_to_module_sum_episodes_length_in": 10.368238394574323, "module_episode_returns_mean": {"default_policy": -0.05}, "num_env_steps_sampled_lifetime": 55400, "agent_episode_returns_mean": {"default_agent": -0.05}, "episode_duration_sec_mean": 0.005405018327292055, "episode_return_mean": -0.05, "episode_return_min": -14.5, "env_reset_timer": 0.00044352090949654306, "episode_len_mean": 20.0, "episode_return_max": 14.5, "rlmodule_inference_timer": 3.713620459560507e-05, "episode_len_min": 20, "num_episodes": 20, "env_to_module_sum_episodes_length_out": 10.368238394574323, "num_module_steps_sampled_lifetime": {"default_policy": 4400}, "num_module_steps_sampled": {"default_policy": 400}, "num_agent_steps_sampled": {"default_agent": 400}, "time_between_sampling": 9.744016892233914}, "num_healthy_workers": 1, "actor_manager_num_outstanding_async_reqs": 0, "num_remote_worker_restarts": 0}, "num_env_steps_sampled_lifetime": -5547500.0, "fault_tolerance": {"num_healthy_workers": 0, "num_remote_worker_restarts": 0}, "env_runner_group": {"actor_manager_num_outstanding_async_reqs": 0}, "done": false, "training_iteration": 11, "trial_id": "b5096_00000", "date": "2025-08-11_18-46-12", "timestamp": 1754930772, "time_this_iter_s": 9.588966131210327, "time_total_s": 109.16233038902283, "pid": 11702, "hostname": "Mac", "node_ip": "127.0.0.1", "config": {"exploration_config": {}, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 2, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "env": "Umbrella", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": false, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 0, "create_local_env_runner": true, "num_envs_per_env_runner": 1, "gym_env_vectorize_mode": "SYNC", "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "episodes_to_numpy": true, "max_requests_in_flight_per_env_runner": 1, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "merge_env_runner_states": "training_only", "broadcast_env_runner_states": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "complete_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "sampler_perf_stats_ema_coef": null, "_is_online": true, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": "auto", "num_aggregator_actors_per_learner": 0, "max_requests_in_flight_per_aggregator_actor": 3, "local_gpu_idx": 0, "max_requests_in_flight_per_learner": 3, "gamma": 1, "lr": 0.0002715581955, "grad_clip": 0.5, "grad_clip_by": "global_norm", "_train_batch_size_per_learner": 5000, "train_batch_size": 4000, "num_epochs": 1, "minibatch_size": 1000, "shuffle_batch_per_epoch": true, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "log_std_clip_param": 20.0, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "_disable_preprocessor_api": false, "_disable_action_flattening": false}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {"intrinsic_reward_coeff": 0.2795015916508}, "optimizer": {}, "_learner_class": "<class 'source.intrinsic_attention_ppo.learners.IntrinsicAttentionMetaLearner.IntrinsicAttentionMetaLearner'>", "callbacks_on_algorithm_init": null, "callbacks_on_env_runners_recreated": null, "callbacks_on_offline_eval_runners_recreated": null, "callbacks_on_checkpoint_loaded": null, "callbacks_on_environment_created": null, "callbacks_on_episode_created": null, "callbacks_on_episode_start": null, "callbacks_on_episode_step": null, "callbacks_on_episode_end": null, "callbacks_on_evaluate_start": null, "callbacks_on_evaluate_end": null, "callbacks_on_evaluate_offline_start": null, "callbacks_on_evaluate_offline_end": null, "callbacks_on_sample_end": null, "callbacks_on_train_result": null, "explore": true, "enable_rl_module_and_learner": true, "enable_env_runner_and_connector_v2": true, "_prior_exploration_config": {"type": "StochasticSampling"}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x3866e5760>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "offline_data_class": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_read_batch_size": null, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "materialize_data": false, "materialize_mapped_data": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "ignore_final_observation": false, "prelearner_class": null, "prelearner_buffer_class": null, "prelearner_buffer_kwargs": {}, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_remaining_data": false, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": 1, "evaluation_duration": 20, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_auto_duration_min_env_steps_per_sample": 100, "evaluation_auto_duration_max_env_steps_per_sample": 2000, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 1, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "offline_evaluation_interval": null, "num_offline_eval_runners": 0, "offline_loss_for_module_fn": null, "offline_evaluation_duration": 1, "offline_evaluation_parallel_to_training": false, "offline_evaluation_timeout_s": 120.0, "num_cpus_per_offline_eval_runner": 1, "num_gpus_per_offline_eval_runner": 0, "custom_resources_per_offline_eval_runner": {}, "restart_failed_offline_eval_runners": true, "ignore_offline_eval_runner_failures": false, "max_num_offline_eval_runner_restarts": 1000, "offline_eval_runner_restore_timeout_s": 1800.0, "max_requests_in_flight_per_offline_eval_runner": 1, "validate_offline_eval_runners_after_construction": true, "offline_eval_runner_health_probe_timeout_s": 30.0, "offline_eval_rl_module_inference_only": false, "broadcast_offline_eval_runner_states": false, "offline_eval_batch_size_per_runner": 256, "dataset_num_iters_per_eval_runner": 1, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "log_gradients": false, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 8, "restart_failed_env_runners": true, "ignore_env_runner_failures": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30.0, "env_runner_restore_timeout_s": 1800.0, "_model_config": {}, "_rl_module_spec": "MultiRLModuleSpec(multi_rl_module_class=<class 'ray.rllib.core.rl_module.multi_rl_module.MultiRLModule'>, observation_space=None, action_space=None, inference_only=False, model_config=None, rl_module_specs={'default_policy': RLModuleSpec(module_class=<class 'source.intrinsic_attention_ppo.rl_modules.DifferentiablePPOModule.DifferentiablePPOModule'>, observation_space=None, action_space=None, inference_only=False, learner_only=False, model_config={'vf_share_layers': True, 'embedding_dim': 62, 'max_seq_len': 6, 'policy_head_hidden_sizes': [32], 'value_head_hidden_sizes': [101], 'embedding_hidden_sizes': [121]}, catalog_class=None, load_state_path=None, model_config_dict=None), 'intrinsic_reward_module': RLModuleSpec(module_class=<class 'source.intrinsic_attention_ppo.rl_modules.IntrinsicAttentionModule.IntrinsicAttentionModule'>, observation_space=None, action_space=None, inference_only=False, learner_only=True, model_config={'intrinsic_reward_network': {'encoder_hidden_sizes': [], 'encoding_dim': 1, 'num_heads': 1, 'head_hidden_sizes': None, 'layers': [{'type': 'attention'}]}, 'extrinsic_value_hidden_layers': [127, 60], 'vf_share_layers': True, 'max_seq_len': 6}, catalog_class=None, load_state_path=None, model_config_dict=None)}, load_state_path=None, modules_to_load=None, module_specs={'default_policy': RLModuleSpec(module_class=<class 'source.intrinsic_attention_ppo.rl_modules.DifferentiablePPOModule.DifferentiablePPOModule'>, observation_space=None, action_space=None, inference_only=False, learner_only=False, model_config={'vf_share_layers': True, 'embedding_dim': 62, 'max_seq_len': 6, 'policy_head_hidden_sizes': [32], 'value_head_hidden_sizes': [101], 'embedding_hidden_sizes': [121]}, catalog_class=None, load_state_path=None, model_config_dict=None), 'intrinsic_reward_module': RLModuleSpec(module_class=<class 'source.intrinsic_attention_ppo.rl_modules.IntrinsicAttentionModule.IntrinsicAttentionModule'>, observation_space=None, action_space=None, inference_only=False, learner_only=True, model_config={'intrinsic_reward_network': {'encoder_hidden_sizes': [], 'encoding_dim': 1, 'num_heads': 1, 'head_hidden_sizes': None, 'layers': [{'type': 'attention'}]}, 'extrinsic_value_hidden_layers': [127, 60], 'vf_share_layers': True, 'max_seq_len': 6}, catalog_class=None, load_state_path=None, model_config_dict=None)})", "algorithm_config_overrides_per_module": {"intrinsic_reward_module": {"lr": 0.0002715581955}}, "_per_module_overrides": {}, "_validate_config": true, "_use_msgpack_checkpoints": false, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "env_task_fn": -1, "enable_connectors": -1, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.161583927863, "kl_target": 0.0201019014258, "vf_loss_coeff": 0.7790510010087, "entropy_coeff": 0.0015431216992, "clip_param": 0.2459212356676, "vf_clip_param": 0.3769744131561, "entropy_coeff_schedule": null, "lr_schedule": null, "sgd_minibatch_size": -1, "vf_share_layers": -1, "differentiable_learner_configs": ["DifferentiableLearnerConfig(learner_class=<class 'source.intrinsic_attention_ppo.learners.IntrinsicAttentionPPOLearner.IntrinsicAttentionPPOLearner'>, learner_connector=None, add_default_connectors_to_learner_pipeline=True, is_multi_agent=False, policies_to_update=['default_policy'], lr=0.0060984166342, num_total_minibatches=0, num_epochs=1, minibatch_size=1000, shuffle_batch_per_epoch=True)"], "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9485408017724, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.callbacks.callbacks.RLlibCallback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 109.16233038902283, "iterations_since_restore": 11, "perf": {"cpu_util_percent": 39.75, "ram_util_percent": 78.87142857142855}}
{"timers": {"training_iteration": 10.244524457664618, "restore_env_runners": 1.124844956356532e-05, "training_step": 10.244359936650055, "env_runner_sampling_timer": 1.6590857723614283, "learner_update_timer": 8.393305440320308, "synch_weights": 0.0013226870354200021, "restore_eval_env_runners": 3.148557705269988e-05, "evaluation_iteration": 0.1249355390496523, "synch_eval_env_connectors": 0.00015528191421539892, "synch_env_connectors": 4.3696965710556655e-06}, "env_runners": {"episode_duration_sec_mean": 0.005881394986994567, "env_to_module_connector": {"timers": {"connectors": {"numpy_to_tensor": 1.2927658613304944e-05, "add_observations_from_episodes_to_batch": 2.8728551090730064e-06, "batch_individual_items": 1.2800600421074243e-05, "add_time_dim_to_batch_and_zero_pad": 7.172552215067705e-06, "add_states_from_episodes_to_batch": 2.7718023273363796e-06}}, "connector_pipeline_timer": 6.108783836581417e-05}, "num_env_steps_sampled": 5000.0, "episode_return_min": -11.5, "module_to_env_connector": {"timers": {"connectors": {"normalize_and_clip_actions": 8.206346442466924e-06, "un_batch_to_individual_items": 6.626807668592116e-06, "get_actions": 4.0905992984872275e-05, "remove_single_ts_time_rank_from_batch": 1.2105183987017731e-05, "listify_data_for_vector_env": 1.072384754546769e-05, "tensor_to_numpy": 1.564093940576794e-05}}, "connector_pipeline_timer": 0.00012098432846976933}, "env_reset_timer": 4.296610678170759e-05, "sample": 0.006231563009259328, "num_episodes_lifetime": -308250.0, "env_to_module_sum_episodes_length_out": 10.36823839457432, "env_step_timer": 1.4276189477061816e-05, "num_module_steps_sampled_lifetime": {"default_policy": -6165000.0}, "weights_seq_no": 11.0, "module_episode_returns_mean": {"default_policy": -0.3}, "env_to_module_sum_episodes_length_in": 10.36823839457432, "episode_len_mean": 20.0, "agent_episode_returns_mean": {"default_agent": -0.3}, "time_between_sampling": 0.032583131364137284, "num_module_steps_sampled": {"default_policy": 5000.0}, "episode_return_max": 8.5, "episode_len_min": 20, "episode_len_max": 20, "rlmodule_inference_timer": 5.638817653287852e-05, "num_agent_steps_sampled": {"default_agent": 5000.0}, "num_episodes": 250.0, "num_env_steps_sampled_lifetime": -6165000.0, "num_agent_steps_sampled_lifetime": {"default_agent": -6165000.0}, "episode_return_mean": -0.3, "num_env_steps_sampled_lifetime_throughput": 3166.6792500237566}, "__all_modules__": {"learner_connector_sum_episodes_length_in": 5000.0, "learner_connector": {"connector_pipeline_timer": 0.1532887068596493, "timers": {"connectors": {"add_one_ts_to_episodes_and_truncate": 0.008815232586446889, "add_observations_from_episodes_to_batch": 0.0008130982118003323, "add_columns_from_episodes_to_train_batch": 0.04114762734484321, "add_time_dim_to_batch_and_zero_pad": 0.09012622867631041, "add_states_from_episodes_to_batch": 0.00362826760689774, "batch_individual_items": 0.008526503361779916, "numpy_to_tensor": 8.021566523713345e-05}}}, "learner_connector_sum_episodes_length_out": 5250.0}, "learners": {"default_policy": {"num_module_steps_trained_lifetime": 71820, "weights_seq_no": 12.0, "entropy": 0.687642514705658, "num_module_steps_trained": 5985, "vf_loss": 0.32051408290863037, "mean_kl_loss": 4.0151746361516416e-05, "num_trainable_parameters": 16595, "curr_entropy_coeff": 0.0015431216992, "module_train_batch_size_mean": 998.2236050808158, "vf_explained_var": 5.1021575927734375e-05, "total_loss": 0.24820485711097717, "vf_loss_unclipped": 42.14546585083008, "policy_loss": -0.0004308691422920674, "use_intrinsic_rewards": 0.0, "diff_num_grad_updates_vs_sampler_policy": 1.0, "curr_kl_coeff": 3.944920172216371e-05, "num_module_steps_trained_lifetime_throughput": 664.3724038252298}, "intrinsic_reward_module": {"total_loss": 0.0, "gradients_default_optimizer_global_norm": 0.0, "num_module_steps_trained_lifetime": 71820, "num_module_steps_trained": 5985, "weights_seq_no": 12.0, "num_trainable_parameters": 8266, "curr_entropy_coeff": 0.0015431216992, "module_train_batch_size_mean": 998.2236050808158, "default_optimizer_learning_rate": 0.0002715581955, "diff_num_grad_updates_vs_sampler_policy": 1.0, "num_module_steps_trained_lifetime_throughput": 664.3780800992414}, "differentiable_learners": {"intrinsic_attention_ppo_learner": {"default_policy": {"num_module_steps_trained": 35910, "weights_seq_no": 72.0, "entropy": 0.6876695156097412, "vf_loss": 0.3205932676792145, "mean_kl_loss": 3.7856545532122254e-05, "module_train_batch_size_mean": 997.512081102731, "vf_explained_var": 0.0007946491241455078, "diff_num_grad_updates_vs_sampler_policy": 61.0, "total_loss": 0.2482861578464508, "vf_loss_unclipped": 42.12284851074219, "policy_loss": -0.00041731802048161626, "use_intrinsic_rewards": 1.0, "num_module_steps_trained_lifetime": 430920}, "intrinsic_reward_module": {"module_train_batch_size_mean": 997.512081102731, "diff_num_grad_updates_vs_sampler_policy": 61.0, "total_loss": 0.0, "num_module_steps_trained_lifetime": 430920, "num_module_steps_trained": 35910, "weights_seq_no": 72.0}, "__all_modules__": {"num_module_steps_trained_lifetime": 861840, "num_module_steps_trained": 71820, "num_env_steps_trained": 216000, "num_env_steps_trained_lifetime": 2592000, "num_env_steps_trained_lifetime_throughput": 53494.404559194256}}}, "__all_modules__": {"num_module_steps_trained_lifetime": 143640, "num_module_steps_trained": 11970, "num_trainable_parameters": 24861, "num_env_steps_trained": 36000, "num_env_steps_trained_lifetime": 432000, "num_non_trainable_parameters": 0, "num_env_steps_trained_lifetime_throughput": 3999.672080419142, "num_module_steps_trained_throughput": 22674400.003284957, "num_module_steps_trained_lifetime_throughput": 11771401.08033222}, "IntrinsicAttentionMask": [[[0.1664392352104187, 0.16576635837554932, 0.16768372058868408, 0.1677965372800827, 0.16610118746757507, 0.16621293127536774], [0.16618946194648743, 0.1647939532995224, 0.16878652572631836, 0.16902300715446472, 0.16548758745193481, 0.16571944952011108], [0.1668882519006729, 0.16755816340446472, 0.16566333174705505, 0.16555316746234894, 0.16722413897514343, 0.16711294651031494], [0.16692814230918884, 0.16772018373012543, 0.16548140347003937, 0.16535140573978424, 0.1673251986503601, 0.16719374060630798], [0.16631437838077545, 0.16527815163135529, 0.1682368665933609, 0.16841153800487518, 0.1657934933900833, 0.16596561670303345], [0.16635578870773315, 0.16543962061405182, 0.16805380582809448, 0.16820795834064484, 0.16589532792568207, 0.16604751348495483]], [[0.16842913627624512, 0.16801287233829498, 0.1638757884502411, 0.1634707748889923, 0.17354771494865417, 0.1626637578010559], [0.16851341724395752, 0.16807664930820465, 0.16373860836029053, 0.16331420838832855, 0.17388847470283508, 0.16246870160102844], [0.16935326159000397, 0.16870887577533722, 0.1623516082763672, 0.16173385083675385, 0.1773470789194107, 0.16050539910793304], [0.16943567991256714, 0.16877058148384094, 0.16221345961093903, 0.16157671809196472, 0.17769284546375275, 0.16031071543693542], [0.16739648580551147, 0.16722695529460907, 0.16552847623825073, 0.16536083817481995, 0.16946111619472504, 0.16502606868743896], [0.1695999950170517, 0.1688934564590454, 0.1619369387626648, 0.16126231849193573, 0.17838576436042786, 0.15992151200771332]], [[0.16699400544166565, 0.1677112579345703, 0.16586217284202576, 0.16579192876815796, 0.1668556183576584, 0.16678495705127716], [0.16604408621788025, 0.16470786929130554, 0.16818664968013763, 0.16832101345062256, 0.16630379855632782, 0.16643664240837097], [0.16846659779548645, 0.17254279553890228, 0.16219526529312134, 0.16181246936321259, 0.16768932342529297, 0.16729356348514557], [0.16855688393115997, 0.17284637689590454, 0.16196778416633606, 0.16156601905822754, 0.16773952543735504, 0.16732344031333923], [0.16717582941055298, 0.1682959347963333, 0.1654137372970581, 0.16530460119247437, 0.16696003079414368, 0.16684988141059875], [0.16726846992969513, 0.1685951203107834, 0.16518475115299225, 0.16505584120750427, 0.16701306402683258, 0.1668827086687088]], [[0.16381505131721497, 0.16323116421699524, 0.16264936327934265, 0.1674075871706009, 0.17668047547340393, 0.16621632874011993], [0.163717120885849, 0.16311387717723846, 0.1625128537416458, 0.1674303263425827, 0.17702701687812805, 0.1661987453699112], [0.16361911594867706, 0.16299653053283691, 0.16237632930278778, 0.16745293140411377, 0.17737407982349396, 0.1661810278892517], [0.16440795361995697, 0.16394221782684326, 0.16347777843475342, 0.1672661155462265, 0.17458610236644745, 0.16631977260112762], [0.16586606204509735, 0.1656980812549591, 0.1655302792787552, 0.1668902486562729, 0.16946296393871307, 0.1665523797273636], [0.1642131805419922, 0.16370843350887299, 0.16320525109767914, 0.1673133373260498, 0.17527349293231964, 0.16628636419773102]], [[0.16677969694137573, 0.16749602556228638, 0.16564932465553284, 0.1655791699886322, 0.1672833114862442, 0.16721247136592865], [0.16644398868083954, 0.16510456800460815, 0.16859173774719238, 0.16872641444206238, 0.16550056636333466, 0.16563278436660767], [0.16725219786167145, 0.171299010515213, 0.16102607548236847, 0.16064605116844177, 0.17008903622627258, 0.16968762874603271], [0.1672791987657547, 0.1715361624956131, 0.16074003279209137, 0.1603413075208664, 0.17026281356811523, 0.169840469956398], [0.16654658317565918, 0.165813148021698, 0.16771705448627472, 0.1677902340888977, 0.16603027284145355, 0.16610270738601685], [0.1665802150964737, 0.16604945063591003, 0.16742591559886932, 0.1674787402153015, 0.16620664298534393, 0.1662590652704239]], [[0.1637994349002838, 0.16859132051467896, 0.16799040138721466, 0.1620541661977768, 0.1766636222600937, 0.1609009951353073], [0.16459405422210693, 0.16808004677295685, 0.16764438152313232, 0.1633175164461136, 0.17389199137687683, 0.1624719798564911], [0.16449612379074097, 0.16814395785331726, 0.16768789291381836, 0.16316120326519012, 0.1742335557937622, 0.16227728128433228], [0.16350209712982178, 0.1687784343957901, 0.16811591386795044, 0.16158424317836761, 0.17770111560821533, 0.16031818091869354], [0.1658647656440735, 0.16722749173641205, 0.16705812513828278, 0.16536135971546173, 0.16946165263652802, 0.16502659022808075], [0.1633032262325287, 0.16890230774879456, 0.16819867491722107, 0.16127078235149384, 0.1783951222896576, 0.15992990136146545]]]}, "num_training_step_calls_per_iteration": 1, "evaluation": {"env_runners": {"env_to_module_connector": {"timers": {"connectors": {"add_states_from_episodes_to_batch": 2.6513145159412363e-06, "numpy_to_tensor": 1.1958904337326396e-05, "add_time_dim_to_batch_and_zero_pad": 6.613644173836754e-06, "add_observations_from_episodes_to_batch": 2.735502497819008e-06, "batch_individual_items": 1.2020458068592111e-05}}, "connector_pipeline_timer": 5.782142581856723e-05}, "module_to_env_connector": {"timers": {"connectors": {"tensor_to_numpy": 1.4817282751922318e-05, "remove_single_ts_time_rank_from_batch": 1.1857691140880707e-05, "un_batch_to_individual_items": 6.440647994443994e-06, "normalize_and_clip_actions": 7.830803521860974e-06, "get_actions": 3.5325998347977115e-05, "listify_data_for_vector_env": 1.0140584229432887e-05}}, "connector_pipeline_timer": 0.00011244180758573039}, "num_env_steps_sampled": 400, "num_agent_steps_sampled_lifetime": {"default_agent": 4800}, "env_step_timer": 1.3617973845796706e-05, "episode_len_max": 20, "num_episodes_lifetime": 240, "sample": 0.11588254233364767, "weights_seq_no": 12.0, "env_to_module_sum_episodes_length_in": 10.368238394574323, "module_episode_returns_mean": {"default_policy": -0.85}, "num_env_steps_sampled_lifetime": 60400, "agent_episode_returns_mean": {"default_agent": -0.85}, "episode_duration_sec_mean": 0.005333555425750092, "episode_return_mean": -0.85, "episode_return_min": -14.5, "env_reset_timer": 0.0004397748709577206, "episode_len_mean": 20.0, "episode_return_max": 14.5, "rlmodule_inference_timer": 3.0149888127183276e-05, "episode_len_min": 20, "num_episodes": 20, "env_to_module_sum_episodes_length_out": 10.368238394574323, "num_module_steps_sampled_lifetime": {"default_policy": 4800}, "num_module_steps_sampled": {"default_policy": 400}, "num_agent_steps_sampled": {"default_agent": 400}, "time_between_sampling": 9.745600773732422}, "num_healthy_workers": 1, "actor_manager_num_outstanding_async_reqs": 0, "num_remote_worker_restarts": 0}, "num_env_steps_sampled_lifetime": -6165000.0, "fault_tolerance": {"num_healthy_workers": 0, "num_remote_worker_restarts": 0}, "env_runner_group": {"actor_manager_num_outstanding_async_reqs": 0}, "done": false, "training_iteration": 12, "trial_id": "b5096_00000", "date": "2025-08-11_18-46-22", "timestamp": 1754930782, "time_this_iter_s": 9.992555856704712, "time_total_s": 119.15488624572754, "pid": 11702, "hostname": "Mac", "node_ip": "127.0.0.1", "config": {"exploration_config": {}, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 2, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "env": "Umbrella", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": false, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 0, "create_local_env_runner": true, "num_envs_per_env_runner": 1, "gym_env_vectorize_mode": "SYNC", "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "episodes_to_numpy": true, "max_requests_in_flight_per_env_runner": 1, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "merge_env_runner_states": "training_only", "broadcast_env_runner_states": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "complete_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "sampler_perf_stats_ema_coef": null, "_is_online": true, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": "auto", "num_aggregator_actors_per_learner": 0, "max_requests_in_flight_per_aggregator_actor": 3, "local_gpu_idx": 0, "max_requests_in_flight_per_learner": 3, "gamma": 1, "lr": 0.0002715581955, "grad_clip": 0.5, "grad_clip_by": "global_norm", "_train_batch_size_per_learner": 5000, "train_batch_size": 4000, "num_epochs": 1, "minibatch_size": 1000, "shuffle_batch_per_epoch": true, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "log_std_clip_param": 20.0, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "_disable_preprocessor_api": false, "_disable_action_flattening": false}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {"intrinsic_reward_coeff": 0.2795015916508}, "optimizer": {}, "_learner_class": "<class 'source.intrinsic_attention_ppo.learners.IntrinsicAttentionMetaLearner.IntrinsicAttentionMetaLearner'>", "callbacks_on_algorithm_init": null, "callbacks_on_env_runners_recreated": null, "callbacks_on_offline_eval_runners_recreated": null, "callbacks_on_checkpoint_loaded": null, "callbacks_on_environment_created": null, "callbacks_on_episode_created": null, "callbacks_on_episode_start": null, "callbacks_on_episode_step": null, "callbacks_on_episode_end": null, "callbacks_on_evaluate_start": null, "callbacks_on_evaluate_end": null, "callbacks_on_evaluate_offline_start": null, "callbacks_on_evaluate_offline_end": null, "callbacks_on_sample_end": null, "callbacks_on_train_result": null, "explore": true, "enable_rl_module_and_learner": true, "enable_env_runner_and_connector_v2": true, "_prior_exploration_config": {"type": "StochasticSampling"}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x3866e5760>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "offline_data_class": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_read_batch_size": null, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "materialize_data": false, "materialize_mapped_data": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "ignore_final_observation": false, "prelearner_class": null, "prelearner_buffer_class": null, "prelearner_buffer_kwargs": {}, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_remaining_data": false, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": 1, "evaluation_duration": 20, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_auto_duration_min_env_steps_per_sample": 100, "evaluation_auto_duration_max_env_steps_per_sample": 2000, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 1, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "offline_evaluation_interval": null, "num_offline_eval_runners": 0, "offline_loss_for_module_fn": null, "offline_evaluation_duration": 1, "offline_evaluation_parallel_to_training": false, "offline_evaluation_timeout_s": 120.0, "num_cpus_per_offline_eval_runner": 1, "num_gpus_per_offline_eval_runner": 0, "custom_resources_per_offline_eval_runner": {}, "restart_failed_offline_eval_runners": true, "ignore_offline_eval_runner_failures": false, "max_num_offline_eval_runner_restarts": 1000, "offline_eval_runner_restore_timeout_s": 1800.0, "max_requests_in_flight_per_offline_eval_runner": 1, "validate_offline_eval_runners_after_construction": true, "offline_eval_runner_health_probe_timeout_s": 30.0, "offline_eval_rl_module_inference_only": false, "broadcast_offline_eval_runner_states": false, "offline_eval_batch_size_per_runner": 256, "dataset_num_iters_per_eval_runner": 1, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "log_gradients": false, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 8, "restart_failed_env_runners": true, "ignore_env_runner_failures": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30.0, "env_runner_restore_timeout_s": 1800.0, "_model_config": {}, "_rl_module_spec": "MultiRLModuleSpec(multi_rl_module_class=<class 'ray.rllib.core.rl_module.multi_rl_module.MultiRLModule'>, observation_space=None, action_space=None, inference_only=False, model_config=None, rl_module_specs={'default_policy': RLModuleSpec(module_class=<class 'source.intrinsic_attention_ppo.rl_modules.DifferentiablePPOModule.DifferentiablePPOModule'>, observation_space=None, action_space=None, inference_only=False, learner_only=False, model_config={'vf_share_layers': True, 'embedding_dim': 62, 'max_seq_len': 6, 'policy_head_hidden_sizes': [32], 'value_head_hidden_sizes': [101], 'embedding_hidden_sizes': [121]}, catalog_class=None, load_state_path=None, model_config_dict=None), 'intrinsic_reward_module': RLModuleSpec(module_class=<class 'source.intrinsic_attention_ppo.rl_modules.IntrinsicAttentionModule.IntrinsicAttentionModule'>, observation_space=None, action_space=None, inference_only=False, learner_only=True, model_config={'intrinsic_reward_network': {'encoder_hidden_sizes': [], 'encoding_dim': 1, 'num_heads': 1, 'head_hidden_sizes': None, 'layers': [{'type': 'attention'}]}, 'extrinsic_value_hidden_layers': [127, 60], 'vf_share_layers': True, 'max_seq_len': 6}, catalog_class=None, load_state_path=None, model_config_dict=None)}, load_state_path=None, modules_to_load=None, module_specs={'default_policy': RLModuleSpec(module_class=<class 'source.intrinsic_attention_ppo.rl_modules.DifferentiablePPOModule.DifferentiablePPOModule'>, observation_space=None, action_space=None, inference_only=False, learner_only=False, model_config={'vf_share_layers': True, 'embedding_dim': 62, 'max_seq_len': 6, 'policy_head_hidden_sizes': [32], 'value_head_hidden_sizes': [101], 'embedding_hidden_sizes': [121]}, catalog_class=None, load_state_path=None, model_config_dict=None), 'intrinsic_reward_module': RLModuleSpec(module_class=<class 'source.intrinsic_attention_ppo.rl_modules.IntrinsicAttentionModule.IntrinsicAttentionModule'>, observation_space=None, action_space=None, inference_only=False, learner_only=True, model_config={'intrinsic_reward_network': {'encoder_hidden_sizes': [], 'encoding_dim': 1, 'num_heads': 1, 'head_hidden_sizes': None, 'layers': [{'type': 'attention'}]}, 'extrinsic_value_hidden_layers': [127, 60], 'vf_share_layers': True, 'max_seq_len': 6}, catalog_class=None, load_state_path=None, model_config_dict=None)})", "algorithm_config_overrides_per_module": {"intrinsic_reward_module": {"lr": 0.0002715581955}}, "_per_module_overrides": {}, "_validate_config": true, "_use_msgpack_checkpoints": false, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "env_task_fn": -1, "enable_connectors": -1, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.161583927863, "kl_target": 0.0201019014258, "vf_loss_coeff": 0.7790510010087, "entropy_coeff": 0.0015431216992, "clip_param": 0.2459212356676, "vf_clip_param": 0.3769744131561, "entropy_coeff_schedule": null, "lr_schedule": null, "sgd_minibatch_size": -1, "vf_share_layers": -1, "differentiable_learner_configs": ["DifferentiableLearnerConfig(learner_class=<class 'source.intrinsic_attention_ppo.learners.IntrinsicAttentionPPOLearner.IntrinsicAttentionPPOLearner'>, learner_connector=None, add_default_connectors_to_learner_pipeline=True, is_multi_agent=False, policies_to_update=['default_policy'], lr=0.0060984166342, num_total_minibatches=0, num_epochs=1, minibatch_size=1000, shuffle_batch_per_epoch=True)"], "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9485408017724, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.callbacks.callbacks.RLlibCallback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 119.15488624572754, "iterations_since_restore": 12, "perf": {"cpu_util_percent": 41.06428571428571, "ram_util_percent": 79.91428571428571}}
{"timers": {"training_iteration": 10.238003765587754, "restore_env_runners": 1.120262448120777e-05, "training_step": 10.23783883019373, "env_runner_sampling_timer": 1.6586395883876186, "learner_update_timer": 8.387107727996645, "synch_weights": 0.0013188239150616298, "restore_eval_env_runners": 3.123322117600211e-05, "evaluation_iteration": 0.12484203781888906, "synch_eval_env_connectors": 0.00015500242490863001, "synch_env_connectors": 4.369749647440889e-06}, "env_runners": {"episode_duration_sec_mean": 0.005268668479751798, "env_to_module_connector": {"timers": {"connectors": {"numpy_to_tensor": 1.2498375189088615e-05, "add_observations_from_episodes_to_batch": 2.811574245339433e-06, "batch_individual_items": 1.25501148924167e-05, "add_time_dim_to_batch_and_zero_pad": 7.105604941297445e-06, "add_states_from_episodes_to_batch": 2.7160926159171547e-06}}, "connector_pipeline_timer": 5.983439768605335e-05}, "num_env_steps_sampled": 5000.0, "episode_return_min": -11.5, "module_to_env_connector": {"timers": {"connectors": {"normalize_and_clip_actions": 8.048009647302078e-06, "un_batch_to_individual_items": 6.514643182433499e-06, "get_actions": 3.9256533130223174e-05, "remove_single_ts_time_rank_from_batch": 1.1936665153722097e-05, "listify_data_for_vector_env": 1.0552830181330937e-05, "tensor_to_numpy": 1.5167881079201481e-05}}, "connector_pipeline_timer": 0.00011787931427548606}, "env_reset_timer": 3.888685512482797e-05, "sample": 0.005711182941675775, "num_episodes_lifetime": -339125.0, "env_to_module_sum_episodes_length_out": 10.36823839457432, "env_step_timer": 1.3900814813047616e-05, "num_module_steps_sampled_lifetime": {"default_policy": -6782500.0}, "weights_seq_no": 12.0, "module_episode_returns_mean": {"default_policy": -0.14000000000000007}, "env_to_module_sum_episodes_length_in": 10.36823839457432, "episode_len_mean": 20.0, "agent_episode_returns_mean": {"default_agent": -0.14000000000000007}, "time_between_sampling": 0.03393378240066366, "num_module_steps_sampled": {"default_policy": 5000.0}, "episode_return_max": 8.5, "episode_len_min": 20, "episode_len_max": 20, "rlmodule_inference_timer": 3.153881087156731e-05, "num_agent_steps_sampled": {"default_agent": 5000.0}, "num_episodes": 250.0, "num_env_steps_sampled_lifetime": -6782500.0, "num_agent_steps_sampled_lifetime": {"default_agent": -6782500.0}, "episode_return_mean": -0.14000000000000007, "num_env_steps_sampled_lifetime_throughput": 3243.1578114037616}, "__all_modules__": {"learner_connector_sum_episodes_length_in": 5000.0, "learner_connector": {"connector_pipeline_timer": 0.15331282937089943, "timers": {"connectors": {"add_one_ts_to_episodes_and_truncate": 0.008814272341264563, "add_observations_from_episodes_to_batch": 0.0008138834803452071, "add_columns_from_episodes_to_train_batch": 0.04114264982206652, "add_time_dim_to_batch_and_zero_pad": 0.09015845222976172, "add_states_from_episodes_to_batch": 0.003633532851383639, "batch_individual_items": 0.008518678747862114, "numpy_to_tensor": 8.00814182106798e-05}}}, "learner_connector_sum_episodes_length_out": 5250.0}, "learners": {"default_policy": {"num_module_steps_trained_lifetime": 77805, "weights_seq_no": 13.0, "entropy": 0.6869597434997559, "num_module_steps_trained": 5985, "vf_loss": 0.32051488757133484, "mean_kl_loss": 1.8862454453483224e-05, "num_trainable_parameters": 16595, "curr_entropy_coeff": 0.0015431216992, "module_train_batch_size_mean": 998.1808187151925, "vf_explained_var": 0.0005345940589904785, "total_loss": 0.24855448305606842, "vf_loss_unclipped": 41.99930191040039, "policy_loss": -8.292590791825205e-05, "use_intrinsic_rewards": 0.0, "diff_num_grad_updates_vs_sampler_policy": 1.0, "curr_kl_coeff": 1.9724600861081854e-05, "num_module_steps_trained_lifetime_throughput": 665.7592328681994}, "intrinsic_reward_module": {"total_loss": 0.0, "gradients_default_optimizer_global_norm": 0.0, "num_module_steps_trained_lifetime": 77805, "num_module_steps_trained": 5985, "weights_seq_no": 13.0, "num_trainable_parameters": 8266, "curr_entropy_coeff": 0.0015431216992, "module_train_batch_size_mean": 998.1808187151925, "default_optimizer_learning_rate": 0.0002715581955, "diff_num_grad_updates_vs_sampler_policy": 1.0, "num_module_steps_trained_lifetime_throughput": 665.7644974698673}, "differentiable_learners": {"intrinsic_attention_ppo_learner": {"default_policy": {"num_module_steps_trained": 35910, "weights_seq_no": 78.0, "entropy": 0.6869640946388245, "vf_loss": 0.3205820620059967, "mean_kl_loss": 1.861930468294304e-05, "module_train_batch_size_mean": 997.5061250970534, "vf_explained_var": 0.0007195472717285156, "diff_num_grad_updates_vs_sampler_policy": 66.0, "total_loss": 0.2486109882593155, "vf_loss_unclipped": 41.99811935424805, "policy_loss": -8.173682726919651e-05, "use_intrinsic_rewards": 1.0, "num_module_steps_trained_lifetime": 466830}, "intrinsic_reward_module": {"module_train_batch_size_mean": 997.5061250970534, "diff_num_grad_updates_vs_sampler_policy": 66.0, "total_loss": 0.0, "num_module_steps_trained_lifetime": 466830, "num_module_steps_trained": 35910, "weights_seq_no": 78.0}, "__all_modules__": {"num_module_steps_trained_lifetime": 933660, "num_module_steps_trained": 71820, "num_env_steps_trained": 216000, "num_env_steps_trained_lifetime": 2808000, "num_env_steps_trained_lifetime_throughput": 52589.29159112669}}}, "__all_modules__": {"num_module_steps_trained_lifetime": 155610, "num_module_steps_trained": 11970, "num_trainable_parameters": 24861, "num_env_steps_trained": 36000, "num_env_steps_trained_lifetime": 468000, "num_non_trainable_parameters": 0, "num_env_steps_trained_lifetime_throughput": 4007.887010735381, "num_module_steps_trained_throughput": 22149292.888930164, "num_module_steps_trained_lifetime_throughput": 11806763.613456849}, "IntrinsicAttentionMask": [[[0.16694732010364532, 0.1662723869085312, 0.16819560527801514, 0.1672845333814621, 0.16559433937072754, 0.16570575535297394], [0.1672457456588745, 0.16584140062332153, 0.16985933482646942, 0.16794970631599426, 0.1644367277622223, 0.16466711461544037], [0.16638465225696564, 0.16705253720283508, 0.16516342759132385, 0.16605296730995178, 0.1677289754152298, 0.16761744022369385], [0.1667966991662979, 0.16648532450199127, 0.16737079620361328, 0.1669519990682602, 0.16617180407047272, 0.16622337698936462], [0.1675412952899933, 0.16540181636810303, 0.17154808342456818, 0.16861727833747864, 0.16327135264873505, 0.16362012922763824], [0.1674930453300476, 0.1654745191335678, 0.17126940190792084, 0.1685076504945755, 0.1634630262851715, 0.1637924164533615]], [[0.1638478934764862, 0.16864117980003357, 0.16804008185863495, 0.16744112968444824, 0.17108109593391418, 0.16094857454299927], [0.16461965441703796, 0.16810619831085205, 0.16767047345638275, 0.16723588109016418, 0.1698705106973648, 0.16249726712703705], [0.1645241677761078, 0.16817262768745422, 0.16771647334098816, 0.16726155579090118, 0.1700202375650406, 0.16230495274066925], [0.16442865133285522, 0.16823901236057281, 0.1677624136209488, 0.16728715598583221, 0.17017000913619995, 0.1621127724647522], [0.16500365734100342, 0.1678384691476822, 0.1674848049879074, 0.16713187098503113, 0.16926877200603485, 0.16327250003814697], [0.16336940228939056, 0.16897077858448029, 0.16826684772968292, 0.16756585240364075, 0.17183241248130798, 0.1599947214126587]], [[0.16694697737693787, 0.1652602106332779, 0.16819526255130768, 0.16728419065475464, 0.16660790145397186, 0.16570541262626648], [0.1676805317401886, 0.1614784449338913, 0.17238107323646545, 0.1689409762620926, 0.16642002761363983, 0.16309887170791626], [0.16638432443141937, 0.1680636703968048, 0.1651630997657776, 0.16605263948440552, 0.1667191982269287, 0.16761711239814758], [0.16679662466049194, 0.16601715981960297, 0.1673707216978073, 0.16695192456245422, 0.1666402667760849, 0.16622330248355865], [0.16709697246551514, 0.16449934244155884, 0.16902850568294525, 0.16761797666549683, 0.166573628783226, 0.16518357396125793], [0.16748999059200287, 0.1624758243560791, 0.17126628756523132, 0.16850458085536957, 0.1664738655090332, 0.16378943622112274]], [[0.16294217109680176, 0.16236138343811035, 0.16711120307445526, 0.1665155589580536, 0.17573903501033783, 0.1653306484222412], [0.162815660238266, 0.16221573948860168, 0.16712422668933868, 0.16650842130184174, 0.1760522723197937, 0.16528363525867462], [0.1638362556695938, 0.1633918583393097, 0.1670152097940445, 0.16656219959259033, 0.17353461682796478, 0.1656598448753357], [0.16370996832847595, 0.16324619948863983, 0.16702917218208313, 0.1665560007095337, 0.17384490370750427, 0.16561366617679596], [0.16561280190944672, 0.16544508934020996, 0.16680434346199036, 0.1666354238986969, 0.1692042201757431, 0.16629809141159058], [0.16345736384391785, 0.1629549264907837, 0.16705672442913055, 0.16654324531555176, 0.17446675896644592, 0.16552099585533142]], [[0.16694723069667816, 0.16627229750156403, 0.16717195510864258, 0.16830867528915405, 0.16559424996376038, 0.16570566594600677], [0.16724525392055511, 0.16584087908267975, 0.1677142083644867, 0.17009679973125458, 0.1644362360239029, 0.16466662287712097], [0.16684700548648834, 0.16641442477703094, 0.16699089109897614, 0.16771766543388367, 0.16597920656204224, 0.1660507619380951], [0.16633281111717224, 0.167122021317482, 0.1660715490579605, 0.16476169228553772, 0.16792191565036774, 0.1677899807691574], [0.16754013299942017, 0.1654006689786911, 0.16825668513774872, 0.17191334068775177, 0.16327020525932312, 0.16361898183822632], [0.16749197244644165, 0.16547346115112305, 0.16816769540309906, 0.1716134399175644, 0.16346196830272675, 0.16379137337207794]], [[0.1684529334306717, 0.16803660988807678, 0.16389894485473633, 0.1672070473432541, 0.1697177141904831, 0.16268673539161682], [0.1685396283864975, 0.16810278594493866, 0.1637640744447708, 0.167232483625412, 0.16986706852912903, 0.1624939739704132], [0.16941039264202118, 0.16876578330993652, 0.16240638494491577, 0.16748391091823578, 0.17137396335601807, 0.1605595499277115], [0.16871286928653717, 0.1682349443435669, 0.16349439322948456, 0.16728311777114868, 0.17016589641571045, 0.16210885345935822], [0.168190598487854, 0.16783618927001953, 0.16430678963661194, 0.16712962090969086, 0.1692664921283722, 0.16327030956745148], [0.16966873407363892, 0.16896189749240875, 0.1620025634765625, 0.16755706071853638, 0.1718233972787857, 0.15998631715774536]]]}, "num_training_step_calls_per_iteration": 1, "evaluation": {"env_runners": {"env_to_module_connector": {"timers": {"connectors": {"add_states_from_episodes_to_batch": 2.6861536437210252e-06, "numpy_to_tensor": 1.1967031187573778e-05, "add_time_dim_to_batch_and_zero_pad": 6.726778245332432e-06, "add_observations_from_episodes_to_batch": 2.785870678515386e-06, "batch_individual_items": 1.2053090496675013e-05}}, "connector_pipeline_timer": 5.788900255915366e-05}, "module_to_env_connector": {"timers": {"connectors": {"tensor_to_numpy": 1.4865692445787047e-05, "remove_single_ts_time_rank_from_batch": 1.1883361429476408e-05, "un_batch_to_individual_items": 6.540406315399735e-06, "normalize_and_clip_actions": 7.905656807431939e-06, "get_actions": 3.5736217867309064e-05, "listify_data_for_vector_env": 1.0239261217197632e-05}}, "connector_pipeline_timer": 0.00011317839970518421}, "num_env_steps_sampled": 400, "num_agent_steps_sampled_lifetime": {"default_agent": 5200}, "env_step_timer": 1.387917638303263e-05, "episode_len_max": 20, "num_episodes_lifetime": 260, "sample": 0.11584320816103107, "weights_seq_no": 13.0, "env_to_module_sum_episodes_length_in": 10.368238394574323, "module_episode_returns_mean": {"default_policy": -0.85}, "num_env_steps_sampled_lifetime": 65400, "agent_episode_returns_mean": {"default_agent": -0.85}, "episode_duration_sec_mean": 0.005326459583593532, "episode_return_mean": -0.85, "episode_return_min": -14.5, "env_reset_timer": 0.00043670212185996816, "episode_len_mean": 20.0, "episode_return_max": 14.5, "rlmodule_inference_timer": 3.068214553509351e-05, "episode_len_min": 20, "num_episodes": 20, "env_to_module_sum_episodes_length_out": 10.368238394574323, "num_module_steps_sampled_lifetime": {"default_policy": 5200}, "num_module_steps_sampled": {"default_policy": 400}, "num_agent_steps_sampled": {"default_agent": 400}, "time_between_sampling": 9.744287403914498}, "num_healthy_workers": 1, "actor_manager_num_outstanding_async_reqs": 0, "num_remote_worker_restarts": 0}, "num_env_steps_sampled_lifetime": -6782500.0, "fault_tolerance": {"num_healthy_workers": 0, "num_remote_worker_restarts": 0}, "env_runner_group": {"actor_manager_num_outstanding_async_reqs": 0}, "done": false, "training_iteration": 13, "trial_id": "b5096_00000", "date": "2025-08-11_18-46-32", "timestamp": 1754930792, "time_this_iter_s": 9.713093042373657, "time_total_s": 128.8679792881012, "pid": 11702, "hostname": "Mac", "node_ip": "127.0.0.1", "config": {"exploration_config": {}, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 2, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "env": "Umbrella", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": false, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 0, "create_local_env_runner": true, "num_envs_per_env_runner": 1, "gym_env_vectorize_mode": "SYNC", "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "episodes_to_numpy": true, "max_requests_in_flight_per_env_runner": 1, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "merge_env_runner_states": "training_only", "broadcast_env_runner_states": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "complete_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "sampler_perf_stats_ema_coef": null, "_is_online": true, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": "auto", "num_aggregator_actors_per_learner": 0, "max_requests_in_flight_per_aggregator_actor": 3, "local_gpu_idx": 0, "max_requests_in_flight_per_learner": 3, "gamma": 1, "lr": 0.0002715581955, "grad_clip": 0.5, "grad_clip_by": "global_norm", "_train_batch_size_per_learner": 5000, "train_batch_size": 4000, "num_epochs": 1, "minibatch_size": 1000, "shuffle_batch_per_epoch": true, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "log_std_clip_param": 20.0, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "_disable_preprocessor_api": false, "_disable_action_flattening": false}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {"intrinsic_reward_coeff": 0.2795015916508}, "optimizer": {}, "_learner_class": "<class 'source.intrinsic_attention_ppo.learners.IntrinsicAttentionMetaLearner.IntrinsicAttentionMetaLearner'>", "callbacks_on_algorithm_init": null, "callbacks_on_env_runners_recreated": null, "callbacks_on_offline_eval_runners_recreated": null, "callbacks_on_checkpoint_loaded": null, "callbacks_on_environment_created": null, "callbacks_on_episode_created": null, "callbacks_on_episode_start": null, "callbacks_on_episode_step": null, "callbacks_on_episode_end": null, "callbacks_on_evaluate_start": null, "callbacks_on_evaluate_end": null, "callbacks_on_evaluate_offline_start": null, "callbacks_on_evaluate_offline_end": null, "callbacks_on_sample_end": null, "callbacks_on_train_result": null, "explore": true, "enable_rl_module_and_learner": true, "enable_env_runner_and_connector_v2": true, "_prior_exploration_config": {"type": "StochasticSampling"}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x3866e5760>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "offline_data_class": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_read_batch_size": null, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "materialize_data": false, "materialize_mapped_data": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "ignore_final_observation": false, "prelearner_class": null, "prelearner_buffer_class": null, "prelearner_buffer_kwargs": {}, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_remaining_data": false, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": 1, "evaluation_duration": 20, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_auto_duration_min_env_steps_per_sample": 100, "evaluation_auto_duration_max_env_steps_per_sample": 2000, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 1, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "offline_evaluation_interval": null, "num_offline_eval_runners": 0, "offline_loss_for_module_fn": null, "offline_evaluation_duration": 1, "offline_evaluation_parallel_to_training": false, "offline_evaluation_timeout_s": 120.0, "num_cpus_per_offline_eval_runner": 1, "num_gpus_per_offline_eval_runner": 0, "custom_resources_per_offline_eval_runner": {}, "restart_failed_offline_eval_runners": true, "ignore_offline_eval_runner_failures": false, "max_num_offline_eval_runner_restarts": 1000, "offline_eval_runner_restore_timeout_s": 1800.0, "max_requests_in_flight_per_offline_eval_runner": 1, "validate_offline_eval_runners_after_construction": true, "offline_eval_runner_health_probe_timeout_s": 30.0, "offline_eval_rl_module_inference_only": false, "broadcast_offline_eval_runner_states": false, "offline_eval_batch_size_per_runner": 256, "dataset_num_iters_per_eval_runner": 1, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "log_gradients": false, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 8, "restart_failed_env_runners": true, "ignore_env_runner_failures": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30.0, "env_runner_restore_timeout_s": 1800.0, "_model_config": {}, "_rl_module_spec": "MultiRLModuleSpec(multi_rl_module_class=<class 'ray.rllib.core.rl_module.multi_rl_module.MultiRLModule'>, observation_space=None, action_space=None, inference_only=False, model_config=None, rl_module_specs={'default_policy': RLModuleSpec(module_class=<class 'source.intrinsic_attention_ppo.rl_modules.DifferentiablePPOModule.DifferentiablePPOModule'>, observation_space=None, action_space=None, inference_only=False, learner_only=False, model_config={'vf_share_layers': True, 'embedding_dim': 62, 'max_seq_len': 6, 'policy_head_hidden_sizes': [32], 'value_head_hidden_sizes': [101], 'embedding_hidden_sizes': [121]}, catalog_class=None, load_state_path=None, model_config_dict=None), 'intrinsic_reward_module': RLModuleSpec(module_class=<class 'source.intrinsic_attention_ppo.rl_modules.IntrinsicAttentionModule.IntrinsicAttentionModule'>, observation_space=None, action_space=None, inference_only=False, learner_only=True, model_config={'intrinsic_reward_network': {'encoder_hidden_sizes': [], 'encoding_dim': 1, 'num_heads': 1, 'head_hidden_sizes': None, 'layers': [{'type': 'attention'}]}, 'extrinsic_value_hidden_layers': [127, 60], 'vf_share_layers': True, 'max_seq_len': 6}, catalog_class=None, load_state_path=None, model_config_dict=None)}, load_state_path=None, modules_to_load=None, module_specs={'default_policy': RLModuleSpec(module_class=<class 'source.intrinsic_attention_ppo.rl_modules.DifferentiablePPOModule.DifferentiablePPOModule'>, observation_space=None, action_space=None, inference_only=False, learner_only=False, model_config={'vf_share_layers': True, 'embedding_dim': 62, 'max_seq_len': 6, 'policy_head_hidden_sizes': [32], 'value_head_hidden_sizes': [101], 'embedding_hidden_sizes': [121]}, catalog_class=None, load_state_path=None, model_config_dict=None), 'intrinsic_reward_module': RLModuleSpec(module_class=<class 'source.intrinsic_attention_ppo.rl_modules.IntrinsicAttentionModule.IntrinsicAttentionModule'>, observation_space=None, action_space=None, inference_only=False, learner_only=True, model_config={'intrinsic_reward_network': {'encoder_hidden_sizes': [], 'encoding_dim': 1, 'num_heads': 1, 'head_hidden_sizes': None, 'layers': [{'type': 'attention'}]}, 'extrinsic_value_hidden_layers': [127, 60], 'vf_share_layers': True, 'max_seq_len': 6}, catalog_class=None, load_state_path=None, model_config_dict=None)})", "algorithm_config_overrides_per_module": {"intrinsic_reward_module": {"lr": 0.0002715581955}}, "_per_module_overrides": {}, "_validate_config": true, "_use_msgpack_checkpoints": false, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "env_task_fn": -1, "enable_connectors": -1, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.161583927863, "kl_target": 0.0201019014258, "vf_loss_coeff": 0.7790510010087, "entropy_coeff": 0.0015431216992, "clip_param": 0.2459212356676, "vf_clip_param": 0.3769744131561, "entropy_coeff_schedule": null, "lr_schedule": null, "sgd_minibatch_size": -1, "vf_share_layers": -1, "differentiable_learner_configs": ["DifferentiableLearnerConfig(learner_class=<class 'source.intrinsic_attention_ppo.learners.IntrinsicAttentionPPOLearner.IntrinsicAttentionPPOLearner'>, learner_connector=None, add_default_connectors_to_learner_pipeline=True, is_multi_agent=False, policies_to_update=['default_policy'], lr=0.0060984166342, num_total_minibatches=0, num_epochs=1, minibatch_size=1000, shuffle_batch_per_epoch=True)"], "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9485408017724, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.callbacks.callbacks.RLlibCallback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 128.8679792881012, "iterations_since_restore": 13, "perf": {"cpu_util_percent": 37.45, "ram_util_percent": 79.09285714285714}}
{"timers": {"training_iteration": 10.233537018761043, "restore_env_runners": 1.1161017864568805e-05, "training_step": 10.233371833981238, "env_runner_sampling_timer": 1.658725388754617, "learner_update_timer": 8.382468904466766, "synch_weights": 0.0013140740055890422, "restore_eval_env_runners": 3.1111718123934024e-05, "evaluation_iteration": 0.1247698049403593, "synch_eval_env_connectors": 0.00015460031044795854, "synch_env_connectors": 4.359803281070545e-06}, "env_runners": {"episode_duration_sec_mean": 0.005434358674567193, "env_to_module_connector": {"timers": {"connectors": {"numpy_to_tensor": 1.30243605698382e-05, "add_observations_from_episodes_to_batch": 2.8935185814431984e-06, "batch_individual_items": 1.2897828250295555e-05, "add_time_dim_to_batch_and_zero_pad": 7.2667012471114604e-06, "add_states_from_episodes_to_batch": 2.7705978309356806e-06}}, "connector_pipeline_timer": 6.13303381374643e-05}, "num_env_steps_sampled": 5000.0, "episode_return_min": -11.5, "module_to_env_connector": {"timers": {"connectors": {"normalize_and_clip_actions": 8.323568585672148e-06, "un_batch_to_individual_items": 6.641787549020946e-06, "get_actions": 4.079009185695384e-05, "remove_single_ts_time_rank_from_batch": 1.2244832946525528e-05, "listify_data_for_vector_env": 1.0972935088711585e-05, "tensor_to_numpy": 1.567060982374681e-05}}, "connector_pipeline_timer": 0.00012166399696300991}, "env_reset_timer": 3.901269121658064e-05, "sample": 0.00578818640762196, "num_episodes_lifetime": -370000.0, "env_to_module_sum_episodes_length_out": 10.36823839457432, "env_step_timer": 1.4448637377331906e-05, "num_module_steps_sampled_lifetime": {"default_policy": -7400000.0}, "weights_seq_no": 13.0, "module_episode_returns_mean": {"default_policy": -0.3}, "env_to_module_sum_episodes_length_in": 10.36823839457432, "episode_len_mean": 20.0, "agent_episode_returns_mean": {"default_agent": -0.3}, "time_between_sampling": 0.03332158049929214, "num_module_steps_sampled": {"default_policy": 5000.0}, "episode_return_max": 8.5, "episode_len_min": 20, "episode_len_max": 20, "rlmodule_inference_timer": 3.253631830130679e-05, "num_agent_steps_sampled": {"default_agent": 5000.0}, "num_episodes": 250.0, "num_env_steps_sampled_lifetime": -7400000.0, "num_agent_steps_sampled_lifetime": {"default_agent": -7400000.0}, "episode_return_mean": -0.3, "num_env_steps_sampled_lifetime_throughput": 3192.4319682888026}, "__all_modules__": {"learner_connector_sum_episodes_length_in": 5000.0, "learner_connector": {"connector_pipeline_timer": 0.15329076399751682, "timers": {"connectors": {"add_one_ts_to_episodes_and_truncate": 0.008813866288245415, "add_observations_from_episodes_to_batch": 0.0008138704745864845, "add_columns_from_episodes_to_train_batch": 0.041156684573970356, "add_time_dim_to_batch_and_zero_pad": 0.09013285354756677, "add_states_from_episodes_to_batch": 0.0036335441931099662, "batch_individual_items": 0.008508991541090893, "numpy_to_tensor": 7.999018451893862e-05}}}, "learner_connector_sum_episodes_length_out": 5250.0}, "learners": {"default_policy": {"num_module_steps_trained_lifetime": 83790, "weights_seq_no": 14.0, "entropy": 0.6863128542900085, "num_module_steps_trained": 5985, "vf_loss": 0.3205125331878662, "mean_kl_loss": 1.7090162145905197e-05, "num_trainable_parameters": 16595, "curr_entropy_coeff": 0.0015431216992, "module_train_batch_size_mean": 998.1405362012929, "vf_explained_var": 0.000561058521270752, "total_loss": 0.2483392357826233, "vf_loss_unclipped": 41.9822998046875, "policy_loss": -0.00029734167037531734, "use_intrinsic_rewards": 0.0, "diff_num_grad_updates_vs_sampler_policy": 1.0, "curr_kl_coeff": 9.862300430540927e-06, "num_module_steps_trained_lifetime_throughput": 666.9833933529673}, "intrinsic_reward_module": {"total_loss": 0.0, "gradients_default_optimizer_global_norm": 0.0, "num_module_steps_trained_lifetime": 83790, "num_module_steps_trained": 5985, "weights_seq_no": 14.0, "num_trainable_parameters": 8266, "curr_entropy_coeff": 0.0015431216992, "module_train_batch_size_mean": 998.1405362012929, "default_optimizer_learning_rate": 0.0002715581955, "diff_num_grad_updates_vs_sampler_policy": 1.0, "num_module_steps_trained_lifetime_throughput": 666.9882689122092}, "differentiable_learners": {"intrinsic_attention_ppo_learner": {"default_policy": {"num_module_steps_trained": 35910, "weights_seq_no": 84.0, "entropy": 0.6863467693328857, "vf_loss": 0.3205717206001282, "mean_kl_loss": 1.5455001630471088e-05, "module_train_batch_size_mean": 997.501977255973, "vf_explained_var": 0.0007508993148803711, "diff_num_grad_updates_vs_sampler_policy": 71.0, "total_loss": 0.24840275943279266, "vf_loss_unclipped": 41.98231506347656, "policy_loss": -0.0002823389077093452, "use_intrinsic_rewards": 1.0, "num_module_steps_trained_lifetime": 502740}, "intrinsic_reward_module": {"module_train_batch_size_mean": 997.501977255973, "diff_num_grad_updates_vs_sampler_policy": 71.0, "total_loss": 0.0, "num_module_steps_trained_lifetime": 502740, "num_module_steps_trained": 35910, "weights_seq_no": 84.0}, "__all_modules__": {"num_module_steps_trained_lifetime": 1005480, "num_module_steps_trained": 71820, "num_env_steps_trained": 216000, "num_env_steps_trained_lifetime": 3024000, "num_env_steps_trained_lifetime_throughput": 51718.733975360075}}}, "__all_modules__": {"num_module_steps_trained_lifetime": 167580, "num_module_steps_trained": 11970, "num_trainable_parameters": 24861, "num_env_steps_trained": 36000, "num_env_steps_trained_lifetime": 504000, "num_non_trainable_parameters": 0, "num_env_steps_trained_lifetime_throughput": 4015.128220596842, "num_module_steps_trained_throughput": 21652705.528793175, "num_module_steps_trained_lifetime_throughput": 11845411.657138772}, "IntrinsicAttentionMask": [[[0.1668875366449356, 0.16696126759052277, 0.16639482975006104, 0.1656862199306488, 0.16739147901535034, 0.16667862236499786], [0.16682201623916626, 0.16687379777431488, 0.1664758175611496, 0.1659773588180542, 0.16717581450939178, 0.16667525470256805], [0.16732297837734222, 0.1675441414117813, 0.16585011780261993, 0.16374696791172028, 0.16883845627307892, 0.1666973978281021], [0.16794158518314362, 0.1683771163225174, 0.1650552749633789, 0.16097624599933624, 0.17093703150749207, 0.16671264171600342], [0.16643774509429932, 0.16636206209659576, 0.16694526374340057, 0.16768057644367218, 0.16592176258563995, 0.16665257513523102], [0.16707269847393036, 0.16720877587795258, 0.16616465151309967, 0.16486264765262604, 0.16800381243228912, 0.16668738424777985]], [[0.16905991733074188, 0.16489705443382263, 0.1644895076751709, 0.16408298909664154, 0.17419765889644623, 0.1632729321718216], [0.17021645605564117, 0.16400185227394104, 0.16339755058288574, 0.16279548406600952, 0.17799073457717896, 0.16159799695014954], [0.1703304797410965, 0.1639121025800705, 0.163288414478302, 0.16266709566116333, 0.1783704161643982, 0.16143155097961426], [0.1704443395137787, 0.16382218897342682, 0.16317911446094513, 0.1625385880470276, 0.1787506639957428, 0.1612650603055954], [0.16765311360359192, 0.16595028340816498, 0.16578222811222076, 0.16561433672904968, 0.16972090303897858, 0.1652790755033493], [0.17067165672779083, 0.16364189982414246, 0.16296017169952393, 0.16228128969669342, 0.17951294779777527, 0.1609320044517517]], [[0.16678033769130707, 0.1674966663122177, 0.16628795862197876, 0.16557979583740234, 0.16664211452007294, 0.16721311211585999], [0.166446253657341, 0.16510680317878723, 0.16737660765647888, 0.16872870922088623, 0.16670659184455872, 0.16563503444194794], [0.16699989140033722, 0.16915400326251984, 0.16552987694740295, 0.16343078017234802, 0.16658638417720795, 0.1682991236448288], [0.16730104386806488, 0.17155857384204865, 0.16442573070526123, 0.16036225855350494, 0.16648976504802704, 0.16986265778541565], [0.16684278845787048, 0.16796065866947174, 0.1660759598016739, 0.16497528553009033, 0.1666274070739746, 0.16751784086227417], [0.16658057272434235, 0.1660497933626175, 0.16694770753383636, 0.16747909784317017, 0.16668343544006348, 0.16625940799713135]], [[0.16660048067569733, 0.16628873348236084, 0.1659775674343109, 0.16566696763038635, 0.17041876912117004, 0.1650475412607193], [0.16659557819366455, 0.16626374423503876, 0.1659325808286667, 0.16560207307338715, 0.17066295444965363, 0.16494303941726685], [0.166590616106987, 0.1662387251853943, 0.16588756442070007, 0.16553714871406555, 0.17090743780136108, 0.1648385375738144], [0.16658557951450348, 0.16621360182762146, 0.1658424735069275, 0.16547217965126038, 0.17115218937397003, 0.16473403573036194], [0.16665367782115936, 0.1665850728750229, 0.1665164977312088, 0.1664479672908783, 0.16748584806919098, 0.16631095111370087], [0.16657525300979614, 0.16616317629814148, 0.165752112865448, 0.1653420627117157, 0.1716424971818924, 0.16452500224113464]], [[0.16678114235401154, 0.1668548434972763, 0.16628876328468323, 0.1662183552980423, 0.1666429340839386, 0.16721393167972565], [0.16674718260765076, 0.166798934340477, 0.16640113294124603, 0.16635161638259888, 0.16665008664131165, 0.16705109179019928], [0.1670071929693222, 0.16722793877124786, 0.16553711891174316, 0.16532757878303528, 0.16659367084503174, 0.16830648481845856], [0.1670393943786621, 0.16728125512599945, 0.1654295027256012, 0.1652001440525055, 0.16658641397953033, 0.16846337914466858], [0.16684477031230927, 0.16695964336395264, 0.16607794165611267, 0.16596835851669312, 0.16662940382957458, 0.16751983761787415], [0.16658101975917816, 0.16652622818946838, 0.16694816946983337, 0.16700083017349243, 0.1666838824748993, 0.16625986993312836]], [[0.16518135368824005, 0.16487225890159607, 0.16456374526023865, 0.16707172989845276, 0.17186382412910461, 0.16644705832004547], [0.16508479416370392, 0.16475597023963928, 0.16442780196666718, 0.16709662973880768, 0.1722031831741333, 0.16643165051937103], [0.16498811542987823, 0.16463959217071533, 0.16429181396961212, 0.16712136566638947, 0.17254304885864258, 0.16641607880592346], [0.16576604545116425, 0.16557732224464417, 0.1653888076543808, 0.16691730916500092, 0.16981306672096252, 0.16653743386268616], [0.1672036349773407, 0.16731812059879303, 0.16743268072605133, 0.16650977730751038, 0.16479788720607758, 0.1667378842830658], [0.16557398438453674, 0.16534551978111267, 0.16511736810207367, 0.16696876287460327, 0.17048610746860504, 0.16650831699371338]]]}, "num_training_step_calls_per_iteration": 1, "evaluation": {"env_runners": {"env_to_module_connector": {"timers": {"connectors": {"add_states_from_episodes_to_batch": 2.7289999422588453e-06, "numpy_to_tensor": 1.2235368842382828e-05, "add_time_dim_to_batch_and_zero_pad": 6.7625836346969345e-06, "add_observations_from_episodes_to_batch": 2.758829967133615e-06, "batch_individual_items": 1.2387707249850807e-05}}, "connector_pipeline_timer": 5.889832394582318e-05}, "module_to_env_connector": {"timers": {"connectors": {"tensor_to_numpy": 1.520812878834735e-05, "remove_single_ts_time_rank_from_batch": 1.1935762854750787e-05, "un_batch_to_individual_items": 6.522646717239692e-06, "normalize_and_clip_actions": 7.966451979112697e-06, "get_actions": 3.618468679352789e-05, "listify_data_for_vector_env": 1.0372990450672819e-05}}, "connector_pipeline_timer": 0.000114506692269024}, "num_env_steps_sampled": 400, "num_agent_steps_sampled_lifetime": {"default_agent": 5600}, "env_step_timer": 1.3990342523791695e-05, "episode_len_max": 20, "num_episodes_lifetime": 280, "sample": 0.11581043649935052, "weights_seq_no": 14.0, "env_to_module_sum_episodes_length_in": 10.368238394574323, "module_episode_returns_mean": {"default_policy": 0.55}, "num_env_steps_sampled_lifetime": 70400, "agent_episode_returns_mean": {"default_agent": 0.55}, "episode_duration_sec_mean": 0.005313894193386659, "episode_return_mean": 0.55, "episode_return_min": -14.5, "env_reset_timer": 0.0004330938503070609, "episode_len_mean": 20.0, "episode_return_max": 14.5, "rlmodule_inference_timer": 3.118163744912006e-05, "episode_len_min": 20, "num_episodes": 20, "env_to_module_sum_episodes_length_out": 10.368238394574323, "num_module_steps_sampled_lifetime": {"default_policy": 5600}, "num_module_steps_sampled": {"default_policy": 400}, "num_agent_steps_sampled": {"default_agent": 400}, "time_between_sampling": 9.744983841125187}, "num_healthy_workers": 1, "actor_manager_num_outstanding_async_reqs": 0, "num_remote_worker_restarts": 0}, "num_env_steps_sampled_lifetime": -7400000.0, "fault_tolerance": {"num_healthy_workers": 0, "num_remote_worker_restarts": 0}, "env_runner_group": {"actor_manager_num_outstanding_async_reqs": 0}, "done": false, "training_iteration": 14, "trial_id": "b5096_00000", "date": "2025-08-11_18-46-42", "timestamp": 1754930802, "time_this_iter_s": 9.912168979644775, "time_total_s": 138.78014826774597, "pid": 11702, "hostname": "Mac", "node_ip": "127.0.0.1", "config": {"exploration_config": {}, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 2, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "env": "Umbrella", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": false, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 0, "create_local_env_runner": true, "num_envs_per_env_runner": 1, "gym_env_vectorize_mode": "SYNC", "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "episodes_to_numpy": true, "max_requests_in_flight_per_env_runner": 1, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "merge_env_runner_states": "training_only", "broadcast_env_runner_states": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "complete_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "sampler_perf_stats_ema_coef": null, "_is_online": true, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": "auto", "num_aggregator_actors_per_learner": 0, "max_requests_in_flight_per_aggregator_actor": 3, "local_gpu_idx": 0, "max_requests_in_flight_per_learner": 3, "gamma": 1, "lr": 0.0002715581955, "grad_clip": 0.5, "grad_clip_by": "global_norm", "_train_batch_size_per_learner": 5000, "train_batch_size": 4000, "num_epochs": 1, "minibatch_size": 1000, "shuffle_batch_per_epoch": true, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "log_std_clip_param": 20.0, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "_disable_preprocessor_api": false, "_disable_action_flattening": false}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {"intrinsic_reward_coeff": 0.2795015916508}, "optimizer": {}, "_learner_class": "<class 'source.intrinsic_attention_ppo.learners.IntrinsicAttentionMetaLearner.IntrinsicAttentionMetaLearner'>", "callbacks_on_algorithm_init": null, "callbacks_on_env_runners_recreated": null, "callbacks_on_offline_eval_runners_recreated": null, "callbacks_on_checkpoint_loaded": null, "callbacks_on_environment_created": null, "callbacks_on_episode_created": null, "callbacks_on_episode_start": null, "callbacks_on_episode_step": null, "callbacks_on_episode_end": null, "callbacks_on_evaluate_start": null, "callbacks_on_evaluate_end": null, "callbacks_on_evaluate_offline_start": null, "callbacks_on_evaluate_offline_end": null, "callbacks_on_sample_end": null, "callbacks_on_train_result": null, "explore": true, "enable_rl_module_and_learner": true, "enable_env_runner_and_connector_v2": true, "_prior_exploration_config": {"type": "StochasticSampling"}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x3866e5760>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "offline_data_class": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_read_batch_size": null, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "materialize_data": false, "materialize_mapped_data": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "ignore_final_observation": false, "prelearner_class": null, "prelearner_buffer_class": null, "prelearner_buffer_kwargs": {}, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_remaining_data": false, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": 1, "evaluation_duration": 20, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_auto_duration_min_env_steps_per_sample": 100, "evaluation_auto_duration_max_env_steps_per_sample": 2000, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 1, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "offline_evaluation_interval": null, "num_offline_eval_runners": 0, "offline_loss_for_module_fn": null, "offline_evaluation_duration": 1, "offline_evaluation_parallel_to_training": false, "offline_evaluation_timeout_s": 120.0, "num_cpus_per_offline_eval_runner": 1, "num_gpus_per_offline_eval_runner": 0, "custom_resources_per_offline_eval_runner": {}, "restart_failed_offline_eval_runners": true, "ignore_offline_eval_runner_failures": false, "max_num_offline_eval_runner_restarts": 1000, "offline_eval_runner_restore_timeout_s": 1800.0, "max_requests_in_flight_per_offline_eval_runner": 1, "validate_offline_eval_runners_after_construction": true, "offline_eval_runner_health_probe_timeout_s": 30.0, "offline_eval_rl_module_inference_only": false, "broadcast_offline_eval_runner_states": false, "offline_eval_batch_size_per_runner": 256, "dataset_num_iters_per_eval_runner": 1, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "log_gradients": false, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 8, "restart_failed_env_runners": true, "ignore_env_runner_failures": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30.0, "env_runner_restore_timeout_s": 1800.0, "_model_config": {}, "_rl_module_spec": "MultiRLModuleSpec(multi_rl_module_class=<class 'ray.rllib.core.rl_module.multi_rl_module.MultiRLModule'>, observation_space=None, action_space=None, inference_only=False, model_config=None, rl_module_specs={'default_policy': RLModuleSpec(module_class=<class 'source.intrinsic_attention_ppo.rl_modules.DifferentiablePPOModule.DifferentiablePPOModule'>, observation_space=None, action_space=None, inference_only=False, learner_only=False, model_config={'vf_share_layers': True, 'embedding_dim': 62, 'max_seq_len': 6, 'policy_head_hidden_sizes': [32], 'value_head_hidden_sizes': [101], 'embedding_hidden_sizes': [121]}, catalog_class=None, load_state_path=None, model_config_dict=None), 'intrinsic_reward_module': RLModuleSpec(module_class=<class 'source.intrinsic_attention_ppo.rl_modules.IntrinsicAttentionModule.IntrinsicAttentionModule'>, observation_space=None, action_space=None, inference_only=False, learner_only=True, model_config={'intrinsic_reward_network': {'encoder_hidden_sizes': [], 'encoding_dim': 1, 'num_heads': 1, 'head_hidden_sizes': None, 'layers': [{'type': 'attention'}]}, 'extrinsic_value_hidden_layers': [127, 60], 'vf_share_layers': True, 'max_seq_len': 6}, catalog_class=None, load_state_path=None, model_config_dict=None)}, load_state_path=None, modules_to_load=None, module_specs={'default_policy': RLModuleSpec(module_class=<class 'source.intrinsic_attention_ppo.rl_modules.DifferentiablePPOModule.DifferentiablePPOModule'>, observation_space=None, action_space=None, inference_only=False, learner_only=False, model_config={'vf_share_layers': True, 'embedding_dim': 62, 'max_seq_len': 6, 'policy_head_hidden_sizes': [32], 'value_head_hidden_sizes': [101], 'embedding_hidden_sizes': [121]}, catalog_class=None, load_state_path=None, model_config_dict=None), 'intrinsic_reward_module': RLModuleSpec(module_class=<class 'source.intrinsic_attention_ppo.rl_modules.IntrinsicAttentionModule.IntrinsicAttentionModule'>, observation_space=None, action_space=None, inference_only=False, learner_only=True, model_config={'intrinsic_reward_network': {'encoder_hidden_sizes': [], 'encoding_dim': 1, 'num_heads': 1, 'head_hidden_sizes': None, 'layers': [{'type': 'attention'}]}, 'extrinsic_value_hidden_layers': [127, 60], 'vf_share_layers': True, 'max_seq_len': 6}, catalog_class=None, load_state_path=None, model_config_dict=None)})", "algorithm_config_overrides_per_module": {"intrinsic_reward_module": {"lr": 0.0002715581955}}, "_per_module_overrides": {}, "_validate_config": true, "_use_msgpack_checkpoints": false, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "env_task_fn": -1, "enable_connectors": -1, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.161583927863, "kl_target": 0.0201019014258, "vf_loss_coeff": 0.7790510010087, "entropy_coeff": 0.0015431216992, "clip_param": 0.2459212356676, "vf_clip_param": 0.3769744131561, "entropy_coeff_schedule": null, "lr_schedule": null, "sgd_minibatch_size": -1, "vf_share_layers": -1, "differentiable_learner_configs": ["DifferentiableLearnerConfig(learner_class=<class 'source.intrinsic_attention_ppo.learners.IntrinsicAttentionPPOLearner.IntrinsicAttentionPPOLearner'>, learner_connector=None, add_default_connectors_to_learner_pipeline=True, is_multi_agent=False, policies_to_update=['default_policy'], lr=0.0060984166342, num_total_minibatches=0, num_epochs=1, minibatch_size=1000, shuffle_batch_per_epoch=True)"], "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9485408017724, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.callbacks.callbacks.RLlibCallback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 138.78014826774597, "iterations_since_restore": 14, "perf": {"cpu_util_percent": 40.41428571428572, "ram_util_percent": 79.41428571428573}}
{"timers": {"training_iteration": 10.22715611232309, "restore_env_runners": 1.1108157842236298e-05, "training_step": 10.226990876471248, "env_runner_sampling_timer": 1.6587276931965038, "learner_update_timer": 8.37601821751159, "synch_weights": 0.001309392015622782, "restore_eval_env_runners": 3.0863941355147504e-05, "evaluation_iteration": 0.12470069273018068, "synch_eval_env_connectors": 0.0001542755564563383, "synch_env_connectors": 4.35787611270779e-06}, "env_runners": {"episode_duration_sec_mean": 0.005390973173547536, "env_to_module_connector": {"timers": {"connectors": {"numpy_to_tensor": 1.2840411743916224e-05, "add_observations_from_episodes_to_batch": 2.8791170554657447e-06, "batch_individual_items": 1.2825923774370815e-05, "add_time_dim_to_batch_and_zero_pad": 7.170381828733757e-06, "add_states_from_episodes_to_batch": 2.7576168359586137e-06}}, "connector_pipeline_timer": 6.0929100338161085e-05}, "num_env_steps_sampled": 5000.0, "episode_return_min": -11.5, "module_to_env_connector": {"timers": {"connectors": {"normalize_and_clip_actions": 8.251475896387127e-06, "un_batch_to_individual_items": 6.630677378807332e-06, "get_actions": 4.0747409854212094e-05, "remove_single_ts_time_rank_from_batch": 1.21722430284195e-05, "listify_data_for_vector_env": 1.0744379453451542e-05, "tensor_to_numpy": 1.5608482647560736e-05}}, "connector_pipeline_timer": 0.00012105696460354441}, "env_reset_timer": 3.7894287256913216e-05, "sample": 0.0057804966916911345, "num_episodes_lifetime": -400875.0, "env_to_module_sum_episodes_length_out": 10.36823839457432, "env_step_timer": 1.4338643639743642e-05, "num_module_steps_sampled_lifetime": {"default_policy": -8017500.0}, "weights_seq_no": 14.0, "module_episode_returns_mean": {"default_policy": 0.09999999999999998}, "env_to_module_sum_episodes_length_in": 10.36823839457432, "episode_len_mean": 20.0, "agent_episode_returns_mean": {"default_agent": 0.09999999999999998}, "time_between_sampling": 0.03381752413142846, "num_module_steps_sampled": {"default_policy": 5000.0}, "episode_return_max": 8.5, "episode_len_min": 20, "episode_len_max": 20, "rlmodule_inference_timer": 3.231590966755586e-05, "num_agent_steps_sampled": {"default_agent": 5000.0}, "num_episodes": 250.0, "num_env_steps_sampled_lifetime": -8017500.0, "num_agent_steps_sampled_lifetime": {"default_agent": -8017500.0}, "episode_return_mean": 0.09999999999999998, "num_env_steps_sampled_lifetime_throughput": 3200.9647483299364}, "__all_modules__": {"learner_connector_sum_episodes_length_in": 5000.0, "learner_connector": {"connector_pipeline_timer": 0.15327009177806486, "timers": {"connectors": {"add_one_ts_to_episodes_and_truncate": 0.00881484887556584, "add_observations_from_episodes_to_batch": 0.0008137709393197813, "add_columns_from_episodes_to_train_batch": 0.04115901481812365, "add_time_dim_to_batch_and_zero_pad": 0.09012076709166571, "add_states_from_episodes_to_batch": 0.003633667081174961, "batch_individual_items": 0.008497772876177161, "numpy_to_tensor": 7.982445281109502e-05}}}, "learner_connector_sum_episodes_length_out": 5250.0}, "learners": {"default_policy": {"num_module_steps_trained_lifetime": 89775, "weights_seq_no": 15.0, "entropy": 0.6853356957435608, "num_module_steps_trained": 5985, "vf_loss": 0.3205120265483856, "mean_kl_loss": 2.624019907671027e-05, "num_trainable_parameters": 16595, "curr_entropy_coeff": 0.0015431216992, "module_train_batch_size_mean": 998.1026110140886, "vf_explained_var": 3.814697265625e-05, "total_loss": 0.24847756326198578, "vf_loss_unclipped": 41.48874282836914, "policy_loss": -0.0001600779505679384, "use_intrinsic_rewards": 0.0, "diff_num_grad_updates_vs_sampler_policy": 1.0, "curr_kl_coeff": 4.931150215270463e-06, "num_module_steps_trained_lifetime_throughput": 668.3203267957742}, "intrinsic_reward_module": {"total_loss": 0.0, "gradients_default_optimizer_global_norm": 0.0, "num_module_steps_trained_lifetime": 89775, "num_module_steps_trained": 5985, "weights_seq_no": 15.0, "num_trainable_parameters": 8266, "curr_entropy_coeff": 0.0015431216992, "module_train_batch_size_mean": 998.1026110140886, "default_optimizer_learning_rate": 0.0002715581955, "diff_num_grad_updates_vs_sampler_policy": 1.0, "num_module_steps_trained_lifetime_throughput": 668.3248318641952}, "differentiable_learners": {"intrinsic_attention_ppo_learner": {"default_policy": {"num_module_steps_trained": 35910, "weights_seq_no": 90.0, "entropy": 0.6853498220443726, "vf_loss": 0.3205653429031372, "mean_kl_loss": 2.5434908820898272e-05, "module_train_batch_size_mean": 997.499088644618, "vf_explained_var": 0.0005771517753601074, "diff_num_grad_updates_vs_sampler_policy": 76.0, "total_loss": 0.2485276162624359, "vf_loss_unclipped": 41.492740631103516, "policy_loss": -0.00015568682283628732, "use_intrinsic_rewards": 1.0, "num_module_steps_trained_lifetime": 538650}, "intrinsic_reward_module": {"module_train_batch_size_mean": 997.499088644618, "diff_num_grad_updates_vs_sampler_policy": 76.0, "total_loss": 0.0, "num_module_steps_trained_lifetime": 538650, "num_module_steps_trained": 35910, "weights_seq_no": 90.0}, "__all_modules__": {"num_module_steps_trained_lifetime": 1077300, "num_module_steps_trained": 71820, "num_env_steps_trained": 216000, "num_env_steps_trained_lifetime": 3240000, "num_env_steps_trained_lifetime_throughput": 50888.253926516896}}}, "__all_modules__": {"num_module_steps_trained_lifetime": 179550, "num_module_steps_trained": 11970, "num_trainable_parameters": 24861, "num_env_steps_trained": 36000, "num_env_steps_trained_lifetime": 540000, "num_non_trainable_parameters": 0, "num_env_steps_trained_lifetime_throughput": 4023.051254146949, "num_module_steps_trained_throughput": 21178580.337571424, "num_module_steps_trained_lifetime_throughput": 11874382.082084479}, "IntrinsicAttentionMask": [[[0.16699479520320892, 0.16706857085227966, 0.16650177538394928, 0.16579271852970123, 0.16685640811920166, 0.16678574681282043], [0.1668972671031952, 0.1669490784406662, 0.1665509045124054, 0.16605223715305328, 0.16680008172988892, 0.1667504459619522], [0.16764649748802185, 0.16786807775497437, 0.16617079079151154, 0.16406355798244476, 0.16723138093948364, 0.16701969504356384], [0.16858388483524323, 0.16902107000350952, 0.16568651795387268, 0.16159190237522125, 0.16776639223098755, 0.16735023260116577], [0.1671777218580246, 0.16729281842708588, 0.16640935838222504, 0.1653064787387848, 0.1669619232416153, 0.16685175895690918], [0.16727113723754883, 0.16740737855434418, 0.16636201739311218, 0.1650584638118744, 0.16701571643352509, 0.1668853610754013]], [[0.1656443029642105, 0.16816875338554382, 0.16502495110034943, 0.16471615433692932, 0.17234548926353455, 0.1641002744436264], [0.16618193686008453, 0.16739089787006378, 0.165883868932724, 0.16573503613471985, 0.16937056183815002, 0.16543777287006378], [0.1655094176530838, 0.1683599352836609, 0.1648109257221222, 0.16446278989315033, 0.1730882227420807, 0.1637687087059021], [0.16544170677661896, 0.16845528781414032, 0.16470371186733246, 0.1643359512090683, 0.1734604686498642, 0.16360288858413696], [0.16702985763549805, 0.16610917448997498, 0.16725866496562958, 0.1673731803894043, 0.1646266132593155, 0.16760246455669403], [0.16530577838420868, 0.16864556074142456, 0.16448889672756195, 0.16408197581768036, 0.17420673370361328, 0.16327114403247833]], [[0.16688694059848785, 0.166960671544075, 0.16575583815574646, 0.16568563878536224, 0.1673908829689026, 0.16731999814510345], [0.16682171821594238, 0.166873499751091, 0.16602647304534912, 0.16597706079483032, 0.1671755164861679, 0.16712576150894165], [0.16786223649978638, 0.1682763695716858, 0.16161340475082397, 0.16123199462890625, 0.17070943117141724, 0.17030654847621918], [0.16792118549346924, 0.16835665702819824, 0.16135692596435547, 0.16095668077468872, 0.17091625928878784, 0.1704922914505005], [0.16643711924552917, 0.16636142134666443, 0.16760681569576263, 0.16767995059490204, 0.165921151638031, 0.16599354147911072], [0.1665009707212448, 0.16644620895385742, 0.1673462688922882, 0.167399063706398, 0.16612756252288818, 0.16617996990680695]], [[0.16386038064956665, 0.1632763296365738, 0.16805291175842285, 0.16745391488075256, 0.17109414935112, 0.16626231372356415], [0.163765549659729, 0.16316214203834534, 0.16809925436973572, 0.16747987270355225, 0.17124520242214203, 0.1662479192018509], [0.16453145444393158, 0.16408516466617584, 0.1677238941192627, 0.16726896166801453, 0.17002776265144348, 0.16636277735233307], [0.16443657875061035, 0.1639707386493683, 0.16777050495147705, 0.16729523241519928, 0.17017821967601776, 0.16634872555732727], [0.1650080680847168, 0.16466036438941956, 0.16748926043510437, 0.1671363264322281, 0.1692732870578766, 0.1664326936006546], [0.16424687206745148, 0.16374200582504272, 0.1678636074066162, 0.16734765470027924, 0.1704794019460678, 0.16632047295570374]], [[0.16677822172641754, 0.16610397398471832, 0.16802524030208588, 0.16711509227752686, 0.166439488530159, 0.16553790867328644], [0.1668948084115982, 0.16549339890480042, 0.16950291395187378, 0.16759727895259857, 0.1661899834871292, 0.16432158648967743], [0.16655278205871582, 0.167221337556839, 0.16533032059669495, 0.1662207692861557, 0.16688799858093262, 0.16778682172298431], [0.16671858727931976, 0.16640734672546387, 0.16729241609573364, 0.16687381267547607, 0.1665623039007187, 0.16614553332328796], [0.16683728992938995, 0.16579779982566833, 0.1687658280134201, 0.16735748946666718, 0.1663147658109665, 0.16492687165737152], [0.1669897437095642, 0.1649772822856903, 0.17075476050376892, 0.16800130903720856, 0.1659766435623169, 0.16330024600028992]], [[0.16742636263370514, 0.16612106561660767, 0.16599206626415253, 0.16586317121982574, 0.16781999170780182, 0.1667773276567459], [0.16861672699451447, 0.1652633100748062, 0.16493414342403412, 0.16460561752319336, 0.16963604092597961, 0.16694414615631104], [0.16873490810394287, 0.16517800092697144, 0.1648290902376175, 0.16448090970516205, 0.16981692612171173, 0.16696028411388397], [0.1688530594110489, 0.1650926172733307, 0.16472399234771729, 0.16435618698596954, 0.16999788582324982, 0.16697631776332855], [0.16706928610801697, 0.1663776934146881, 0.16630919277668, 0.16624073684215546, 0.16727733612060547, 0.16672571003437042], [0.16801708936691284, 0.16569587588310242, 0.16546723246574402, 0.16523893177509308, 0.1687198281288147, 0.1668611317873001]]]}, "num_training_step_calls_per_iteration": 1, "evaluation": {"env_runners": {"env_to_module_connector": {"timers": {"connectors": {"add_states_from_episodes_to_batch": 2.6973478945495735e-06, "numpy_to_tensor": 1.2264632318401586e-05, "add_time_dim_to_batch_and_zero_pad": 6.698547722175009e-06, "add_observations_from_episodes_to_batch": 2.7520937322346684e-06, "batch_individual_items": 1.2182039070553822e-05}}, "connector_pipeline_timer": 5.8420573108211245e-05}, "module_to_env_connector": {"timers": {"connectors": {"tensor_to_numpy": 1.4868968428582639e-05, "remove_single_ts_time_rank_from_batch": 1.1861492059032352e-05, "un_batch_to_individual_items": 6.48968859407854e-06, "normalize_and_clip_actions": 7.914729653180228e-06, "get_actions": 3.572463483609726e-05, "listify_data_for_vector_env": 1.045610822358827e-05}}, "connector_pipeline_timer": 0.00011343916640673317}, "num_env_steps_sampled": 400, "num_agent_steps_sampled_lifetime": {"default_agent": 6000}, "env_step_timer": 1.3892323131222695e-05, "episode_len_max": 20, "num_episodes_lifetime": 300, "sample": 0.11577220838451602, "weights_seq_no": 15.0, "env_to_module_sum_episodes_length_in": 10.368238394574323, "module_episode_returns_mean": {"default_policy": 0.55}, "num_env_steps_sampled_lifetime": 75400, "agent_episode_returns_mean": {"default_agent": 0.55}, "episode_duration_sec_mean": 0.00532623129314743, "episode_return_mean": 0.55, "episode_return_min": -14.5, "env_reset_timer": 0.0004295379118844566, "episode_len_mean": 20.0, "episode_return_max": 14.5, "rlmodule_inference_timer": 3.094625280113338e-05, "episode_len_min": 20, "num_episodes": 20, "env_to_module_sum_episodes_length_out": 10.368238394574323, "num_module_steps_sampled_lifetime": {"default_policy": 6000}, "num_module_steps_sampled": {"default_policy": 400}, "num_agent_steps_sampled": {"default_agent": 400}, "time_between_sampling": 9.743702617294463}, "num_healthy_workers": 1, "actor_manager_num_outstanding_async_reqs": 0, "num_remote_worker_restarts": 0}, "num_env_steps_sampled_lifetime": -8017500.0, "fault_tolerance": {"num_healthy_workers": 0, "num_remote_worker_restarts": 0}, "env_runner_group": {"actor_manager_num_outstanding_async_reqs": 0}, "done": false, "training_iteration": 15, "trial_id": "b5096_00000", "date": "2025-08-11_18-46-51", "timestamp": 1754930811, "time_this_iter_s": 9.715522766113281, "time_total_s": 148.49567103385925, "pid": 11702, "hostname": "Mac", "node_ip": "127.0.0.1", "config": {"exploration_config": {}, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 2, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "env": "Umbrella", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": false, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 0, "create_local_env_runner": true, "num_envs_per_env_runner": 1, "gym_env_vectorize_mode": "SYNC", "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "episodes_to_numpy": true, "max_requests_in_flight_per_env_runner": 1, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "merge_env_runner_states": "training_only", "broadcast_env_runner_states": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "complete_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "sampler_perf_stats_ema_coef": null, "_is_online": true, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": "auto", "num_aggregator_actors_per_learner": 0, "max_requests_in_flight_per_aggregator_actor": 3, "local_gpu_idx": 0, "max_requests_in_flight_per_learner": 3, "gamma": 1, "lr": 0.0002715581955, "grad_clip": 0.5, "grad_clip_by": "global_norm", "_train_batch_size_per_learner": 5000, "train_batch_size": 4000, "num_epochs": 1, "minibatch_size": 1000, "shuffle_batch_per_epoch": true, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "log_std_clip_param": 20.0, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "_disable_preprocessor_api": false, "_disable_action_flattening": false}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {"intrinsic_reward_coeff": 0.2795015916508}, "optimizer": {}, "_learner_class": "<class 'source.intrinsic_attention_ppo.learners.IntrinsicAttentionMetaLearner.IntrinsicAttentionMetaLearner'>", "callbacks_on_algorithm_init": null, "callbacks_on_env_runners_recreated": null, "callbacks_on_offline_eval_runners_recreated": null, "callbacks_on_checkpoint_loaded": null, "callbacks_on_environment_created": null, "callbacks_on_episode_created": null, "callbacks_on_episode_start": null, "callbacks_on_episode_step": null, "callbacks_on_episode_end": null, "callbacks_on_evaluate_start": null, "callbacks_on_evaluate_end": null, "callbacks_on_evaluate_offline_start": null, "callbacks_on_evaluate_offline_end": null, "callbacks_on_sample_end": null, "callbacks_on_train_result": null, "explore": true, "enable_rl_module_and_learner": true, "enable_env_runner_and_connector_v2": true, "_prior_exploration_config": {"type": "StochasticSampling"}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x3866e5760>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "offline_data_class": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_read_batch_size": null, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "materialize_data": false, "materialize_mapped_data": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "ignore_final_observation": false, "prelearner_class": null, "prelearner_buffer_class": null, "prelearner_buffer_kwargs": {}, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_remaining_data": false, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": 1, "evaluation_duration": 20, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_auto_duration_min_env_steps_per_sample": 100, "evaluation_auto_duration_max_env_steps_per_sample": 2000, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 1, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "offline_evaluation_interval": null, "num_offline_eval_runners": 0, "offline_loss_for_module_fn": null, "offline_evaluation_duration": 1, "offline_evaluation_parallel_to_training": false, "offline_evaluation_timeout_s": 120.0, "num_cpus_per_offline_eval_runner": 1, "num_gpus_per_offline_eval_runner": 0, "custom_resources_per_offline_eval_runner": {}, "restart_failed_offline_eval_runners": true, "ignore_offline_eval_runner_failures": false, "max_num_offline_eval_runner_restarts": 1000, "offline_eval_runner_restore_timeout_s": 1800.0, "max_requests_in_flight_per_offline_eval_runner": 1, "validate_offline_eval_runners_after_construction": true, "offline_eval_runner_health_probe_timeout_s": 30.0, "offline_eval_rl_module_inference_only": false, "broadcast_offline_eval_runner_states": false, "offline_eval_batch_size_per_runner": 256, "dataset_num_iters_per_eval_runner": 1, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "log_gradients": false, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 8, "restart_failed_env_runners": true, "ignore_env_runner_failures": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30.0, "env_runner_restore_timeout_s": 1800.0, "_model_config": {}, "_rl_module_spec": "MultiRLModuleSpec(multi_rl_module_class=<class 'ray.rllib.core.rl_module.multi_rl_module.MultiRLModule'>, observation_space=None, action_space=None, inference_only=False, model_config=None, rl_module_specs={'default_policy': RLModuleSpec(module_class=<class 'source.intrinsic_attention_ppo.rl_modules.DifferentiablePPOModule.DifferentiablePPOModule'>, observation_space=None, action_space=None, inference_only=False, learner_only=False, model_config={'vf_share_layers': True, 'embedding_dim': 62, 'max_seq_len': 6, 'policy_head_hidden_sizes': [32], 'value_head_hidden_sizes': [101], 'embedding_hidden_sizes': [121]}, catalog_class=None, load_state_path=None, model_config_dict=None), 'intrinsic_reward_module': RLModuleSpec(module_class=<class 'source.intrinsic_attention_ppo.rl_modules.IntrinsicAttentionModule.IntrinsicAttentionModule'>, observation_space=None, action_space=None, inference_only=False, learner_only=True, model_config={'intrinsic_reward_network': {'encoder_hidden_sizes': [], 'encoding_dim': 1, 'num_heads': 1, 'head_hidden_sizes': None, 'layers': [{'type': 'attention'}]}, 'extrinsic_value_hidden_layers': [127, 60], 'vf_share_layers': True, 'max_seq_len': 6}, catalog_class=None, load_state_path=None, model_config_dict=None)}, load_state_path=None, modules_to_load=None, module_specs={'default_policy': RLModuleSpec(module_class=<class 'source.intrinsic_attention_ppo.rl_modules.DifferentiablePPOModule.DifferentiablePPOModule'>, observation_space=None, action_space=None, inference_only=False, learner_only=False, model_config={'vf_share_layers': True, 'embedding_dim': 62, 'max_seq_len': 6, 'policy_head_hidden_sizes': [32], 'value_head_hidden_sizes': [101], 'embedding_hidden_sizes': [121]}, catalog_class=None, load_state_path=None, model_config_dict=None), 'intrinsic_reward_module': RLModuleSpec(module_class=<class 'source.intrinsic_attention_ppo.rl_modules.IntrinsicAttentionModule.IntrinsicAttentionModule'>, observation_space=None, action_space=None, inference_only=False, learner_only=True, model_config={'intrinsic_reward_network': {'encoder_hidden_sizes': [], 'encoding_dim': 1, 'num_heads': 1, 'head_hidden_sizes': None, 'layers': [{'type': 'attention'}]}, 'extrinsic_value_hidden_layers': [127, 60], 'vf_share_layers': True, 'max_seq_len': 6}, catalog_class=None, load_state_path=None, model_config_dict=None)})", "algorithm_config_overrides_per_module": {"intrinsic_reward_module": {"lr": 0.0002715581955}}, "_per_module_overrides": {}, "_validate_config": true, "_use_msgpack_checkpoints": false, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "env_task_fn": -1, "enable_connectors": -1, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.161583927863, "kl_target": 0.0201019014258, "vf_loss_coeff": 0.7790510010087, "entropy_coeff": 0.0015431216992, "clip_param": 0.2459212356676, "vf_clip_param": 0.3769744131561, "entropy_coeff_schedule": null, "lr_schedule": null, "sgd_minibatch_size": -1, "vf_share_layers": -1, "differentiable_learner_configs": ["DifferentiableLearnerConfig(learner_class=<class 'source.intrinsic_attention_ppo.learners.IntrinsicAttentionPPOLearner.IntrinsicAttentionPPOLearner'>, learner_connector=None, add_default_connectors_to_learner_pipeline=True, is_multi_agent=False, policies_to_update=['default_policy'], lr=0.0060984166342, num_total_minibatches=0, num_epochs=1, minibatch_size=1000, shuffle_batch_per_epoch=True)"], "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9485408017724, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.callbacks.callbacks.RLlibCallback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 148.49567103385925, "iterations_since_restore": 15, "perf": {"cpu_util_percent": 32.67142857142857, "ram_util_percent": 78.72142857142858}}
{"timers": {"training_iteration": 10.221177308700055, "restore_env_runners": 1.1058746116398536e-05, "training_step": 10.221011472287364, "env_runner_sampling_timer": 1.657750335433758, "learner_update_timer": 8.370131040756442, "synch_weights": 0.0013064697654675546, "restore_eval_env_runners": 3.0611551496796366e-05, "evaluation_iteration": 0.12462575414311705, "synch_eval_env_connectors": 0.00015382280104250017, "synch_env_connectors": 4.35262709629223e-06}, "env_runners": {"episode_duration_sec_mean": 0.005378502331208436, "env_to_module_connector": {"timers": {"connectors": {"numpy_to_tensor": 1.2958226167471575e-05, "add_observations_from_episodes_to_batch": 2.8493260012312868e-06, "batch_individual_items": 1.2774943604802896e-05, "add_time_dim_to_batch_and_zero_pad": 7.094408776445858e-06, "add_states_from_episodes_to_batch": 2.7664621762365e-06}}, "connector_pipeline_timer": 6.088346467838381e-05}, "num_env_steps_sampled": 5000.0, "episode_return_min": -11.5, "module_to_env_connector": {"timers": {"connectors": {"normalize_and_clip_actions": 8.183688483373497e-06, "un_batch_to_individual_items": 6.588356119660058e-06, "get_actions": 4.0613089016151654e-05, "remove_single_ts_time_rank_from_batch": 1.2086939087348178e-05, "listify_data_for_vector_env": 1.0696774824850494e-05, "tensor_to_numpy": 1.5534975853047685e-05}}, "connector_pipeline_timer": 0.00012045163941708852}, "env_reset_timer": 3.757112235129307e-05, "sample": 0.0056894264288678345, "num_episodes_lifetime": -431750.0, "env_to_module_sum_episodes_length_out": 10.36823839457432, "env_step_timer": 1.4182854667305993e-05, "num_module_steps_sampled_lifetime": {"default_policy": -8635000.0}, "weights_seq_no": 15.0, "module_episode_returns_mean": {"default_policy": -0.06}, "env_to_module_sum_episodes_length_in": 10.36823839457432, "episode_len_mean": 20.0, "agent_episode_returns_mean": {"default_agent": -0.06}, "time_between_sampling": 0.03298311522409207, "num_module_steps_sampled": {"default_policy": 5000.0}, "episode_return_max": 8.5, "episode_len_min": 20, "episode_len_max": 20, "rlmodule_inference_timer": 3.22488410086465e-05, "num_agent_steps_sampled": {"default_agent": 5000.0}, "num_episodes": 250.0, "num_env_steps_sampled_lifetime": -8635000.0, "num_agent_steps_sampled_lifetime": {"default_agent": -8635000.0}, "episode_return_mean": -0.06, "num_env_steps_sampled_lifetime_throughput": 3215.3170117814166}, "__all_modules__": {"learner_connector_sum_episodes_length_in": 5000.0, "learner_connector": {"connector_pipeline_timer": 0.15406921086024725, "timers": {"connectors": {"add_one_ts_to_episodes_and_truncate": 0.008811309967036425, "add_observations_from_episodes_to_batch": 0.0008135482296593311, "add_columns_from_episodes_to_train_batch": 0.04115219049938635, "add_time_dim_to_batch_and_zero_pad": 0.0901149556705835, "add_states_from_episodes_to_batch": 0.003633864580284863, "batch_individual_items": 0.009313944317655778, "numpy_to_tensor": 7.95670482568212e-05}}}, "learner_connector_sum_episodes_length_out": 5250.0}, "learners": {"default_policy": {"num_module_steps_trained_lifetime": 95760, "weights_seq_no": 16.0, "entropy": 0.6839078068733215, "num_module_steps_trained": 5985, "vf_loss": 0.3205137550830841, "mean_kl_loss": 6.151954585220665e-05, "num_trainable_parameters": 16595, "curr_entropy_coeff": 0.0015431216992, "module_train_batch_size_mean": 998.0669052031734, "vf_explained_var": -0.00014841556549072266, "total_loss": 0.24777956306934357, "vf_loss_unclipped": 41.637229919433594, "policy_loss": -0.000861680950038135, "use_intrinsic_rewards": 0.0, "diff_num_grad_updates_vs_sampler_policy": 1.0, "curr_kl_coeff": 2.4655751076352317e-06, "num_module_steps_trained_lifetime_throughput": 669.7305451447929}, "intrinsic_reward_module": {"total_loss": 0.0, "gradients_default_optimizer_global_norm": 0.0, "num_module_steps_trained_lifetime": 95760, "num_module_steps_trained": 5985, "weights_seq_no": 16.0, "num_trainable_parameters": 8266, "curr_entropy_coeff": 0.0015431216992, "module_train_batch_size_mean": 998.0669052031734, "default_optimizer_learning_rate": 0.0002715581955, "diff_num_grad_updates_vs_sampler_policy": 1.0, "num_module_steps_trained_lifetime_throughput": 669.7346960199208}, "differentiable_learners": {"intrinsic_attention_ppo_learner": {"default_policy": {"num_module_steps_trained": 35910, "weights_seq_no": 96.0, "entropy": 0.683971107006073, "vf_loss": 0.3205609917640686, "mean_kl_loss": 5.641197640215978e-05, "module_train_batch_size_mean": 997.4970769774884, "vf_explained_var": 0.0005471110343933105, "diff_num_grad_updates_vs_sampler_policy": 81.0, "total_loss": 0.24786217510700226, "vf_loss_unclipped": 41.63789367675781, "policy_loss": -0.000824857852421701, "use_intrinsic_rewards": 1.0, "num_module_steps_trained_lifetime": 574560}, "intrinsic_reward_module": {"module_train_batch_size_mean": 997.4970769774884, "diff_num_grad_updates_vs_sampler_policy": 81.0, "total_loss": 0.0, "num_module_steps_trained_lifetime": 574560, "num_module_steps_trained": 35910, "weights_seq_no": 96.0}, "__all_modules__": {"num_module_steps_trained_lifetime": 1149120, "num_module_steps_trained": 71820, "num_env_steps_trained": 216000, "num_env_steps_trained_lifetime": 3456000, "num_env_steps_trained_lifetime_throughput": 50098.24147721629}}}, "__all_modules__": {"num_module_steps_trained_lifetime": 191520, "num_module_steps_trained": 11970, "num_trainable_parameters": 24861, "num_env_steps_trained": 36000, "num_env_steps_trained_lifetime": 576000, "num_non_trainable_parameters": 0, "num_env_steps_trained_lifetime_throughput": 4031.4208186451488, "num_module_steps_trained_throughput": 20719778.11703934, "num_module_steps_trained_lifetime_throughput": 11891753.548561329}, "IntrinsicAttentionMask": [[[0.16678038239479065, 0.1674967110157013, 0.16564999520778656, 0.16621758043766022, 0.1666421741247177, 0.16721315681934357], [0.16644640266895294, 0.16510695219039917, 0.16859418153762817, 0.1675104796886444, 0.16670675575733185, 0.16563518345355988], [0.16727334260940552, 0.17132066190242767, 0.16104643046855927, 0.16414883732795715, 0.16650156676769257, 0.16970907151699066], [0.16703109443187714, 0.16939249634742737, 0.1633514165878296, 0.1651919186115265, 0.16657812893390656, 0.16845500469207764], [0.16684292256832123, 0.16796079277992249, 0.1650843471288681, 0.16596652567386627, 0.16662754118442535, 0.16751797497272491], [0.16658058762550354, 0.1660498082637787, 0.16742630302906036, 0.1670003980398178, 0.16668345034122467, 0.16625943779945374]], [[0.16474001109600067, 0.1641528159379959, 0.1689550280570984, 0.162984699010849, 0.172012597322464, 0.16715481877326965], [0.16467423737049103, 0.16406746208667755, 0.16903197765350342, 0.16286061704158783, 0.17219537496566772, 0.16717036068439484], [0.16520428657531738, 0.164756178855896, 0.1684097945690155, 0.1638636291027069, 0.1707230806350708, 0.16704311966896057], [0.164542555809021, 0.16389667987823486, 0.16918574273586273, 0.16261249780654907, 0.17256127297878265, 0.1672012209892273], [0.1655326634645462, 0.16518384218215942, 0.16802175343036652, 0.16448843479156494, 0.1698114424943924, 0.16696181893348694], [0.16500765085220337, 0.16450047492980957, 0.16864116489887238, 0.16349077224731445, 0.17126905918121338, 0.16709087789058685]], [[0.16660764813423157, 0.16593410074710846, 0.16785340011119843, 0.1679663360118866, 0.16525742411613464, 0.1663811206817627], [0.16653741896152496, 0.16513900458812714, 0.16913993656635284, 0.1693769097328186, 0.16374029219150543, 0.16606643795967102], [0.1667194366455078, 0.1673886775970459, 0.16549576818943024, 0.16538572311401367, 0.16806647181510925, 0.16694392263889313], [0.1667284220457077, 0.16751950979232788, 0.1652834266424179, 0.16515357792377472, 0.16832131147384644, 0.16699370741844177], [0.166459858417511, 0.16433416306972504, 0.17044076323509216, 0.17080485820770264, 0.16221745312213898, 0.16574285924434662], [0.1665848046541214, 0.1656673699617386, 0.16828516125679016, 0.16843953728675842, 0.16474705934524536, 0.16627611219882965]], [[0.16473054885864258, 0.16954965889453888, 0.16355831921100616, 0.16834315657615662, 0.17200271785259247, 0.1618156135082245], [0.16526471078395844, 0.1687649041414261, 0.1644091010093689, 0.16789118945598602, 0.1705361306667328, 0.16313399374485016], [0.16459763050079346, 0.16974367201328278, 0.16334742307662964, 0.1684543788433075, 0.17236696183681488, 0.16148988902568817], [0.1651327759027481, 0.16895945370197296, 0.16419850289821625, 0.16800352931022644, 0.17089872062206268, 0.16280698776245117], [0.16552932560443878, 0.16837316751480103, 0.1648324728012085, 0.1676643341779709, 0.169808030128479, 0.1637926548719406], [0.16439785063266754, 0.1700344830751419, 0.1630309671163559, 0.1686207354068756, 0.17291413247585297, 0.16100192070007324]], [[0.16677606105804443, 0.16509100794792175, 0.16802306473255157, 0.1681361198425293, 0.16542446613311768, 0.16654931008815765], [0.1670324206352234, 0.1608542948961258, 0.17171478271484375, 0.17214396595954895, 0.16206340491771698, 0.16619111597537994], [0.1665506511926651, 0.16823166608810425, 0.16532820463180542, 0.1652182787656784, 0.1678963005542755, 0.16677488386631012], [0.16652874648571014, 0.1685165911912918, 0.16508547961711884, 0.16495579481124878, 0.16811972856521606, 0.16679370403289795], [0.16698618233203888, 0.16169196367263794, 0.17097969353199005, 0.17134493589401245, 0.1627303808927536, 0.16626693308353424], [0.16681382060050964, 0.16452035307884216, 0.16851651668548584, 0.16867110133171082, 0.16497354209423065, 0.16650471091270447]], [[0.16781073808670044, 0.16367864608764648, 0.16698229312896729, 0.1628705859184265, 0.17291051149368286, 0.16574726998806], [0.1683523952960968, 0.16220584511756897, 0.1671140342950821, 0.1610126942396164, 0.17604151368141174, 0.1652735471725464], [0.1679193675518036, 0.16338644921779633, 0.16700966656208038, 0.16250130534172058, 0.17352885007858276, 0.16565436124801636], [0.1684582382440567, 0.16191326081752777, 0.16713832318782806, 0.16064462065696716, 0.17666776478290558, 0.1651778221130371], [0.16714194416999817, 0.16544432938098907, 0.16680358350276947, 0.16510939598083496, 0.16920343041419983, 0.1662973165512085], [0.16808128356933594, 0.16294799745082855, 0.1670496016740799, 0.1619478166103363, 0.174459308385849, 0.16551393270492554]]]}, "num_training_step_calls_per_iteration": 1, "evaluation": {"env_runners": {"env_to_module_connector": {"timers": {"connectors": {"add_states_from_episodes_to_batch": 2.742638719217313e-06, "numpy_to_tensor": 1.2540633071317181e-05, "add_time_dim_to_batch_and_zero_pad": 6.928801572761655e-06, "add_observations_from_episodes_to_batch": 2.8505999654032856e-06, "batch_individual_items": 1.252533869419923e-05}}, "connector_pipeline_timer": 6.011375060722956e-05}, "module_to_env_connector": {"timers": {"connectors": {"tensor_to_numpy": 1.5668998257558538e-05, "remove_single_ts_time_rank_from_batch": 1.2123849930490387e-05, "un_batch_to_individual_items": 6.634677399089334e-06, "normalize_and_clip_actions": 8.112664516452225e-06, "get_actions": 3.8085293622560855e-05, "listify_data_for_vector_env": 1.047809144690066e-05}}, "connector_pipeline_timer": 0.00011794207905037791}, "num_env_steps_sampled": 400, "num_agent_steps_sampled_lifetime": {"default_agent": 6400}, "env_step_timer": 1.4501748243963124e-05, "episode_len_max": 20, "num_episodes_lifetime": 320, "sample": 0.1157502467206729, "weights_seq_no": 16.0, "env_to_module_sum_episodes_length_in": 10.368238394574323, "module_episode_returns_mean": {"default_policy": 0.55}, "num_env_steps_sampled_lifetime": 80400, "agent_episode_returns_mean": {"default_agent": 0.55}, "episode_duration_sec_mean": 0.005156550417887047, "episode_return_mean": 0.55, "episode_return_min": -14.5, "env_reset_timer": 0.0004265541923457086, "episode_len_mean": 20.0, "episode_return_max": 14.5, "rlmodule_inference_timer": 3.2090611720206166e-05, "episode_len_min": 20, "num_episodes": 20, "env_to_module_sum_episodes_length_out": 10.368238394574323, "num_module_steps_sampled_lifetime": {"default_policy": 6400}, "num_module_steps_sampled": {"default_policy": 400}, "num_agent_steps_sampled": {"default_agent": 400}, "time_between_sampling": 9.742780591531664}, "num_healthy_workers": 1, "actor_manager_num_outstanding_async_reqs": 0, "num_remote_worker_restarts": 0}, "num_env_steps_sampled_lifetime": -8635000.0, "fault_tolerance": {"num_healthy_workers": 0, "num_remote_worker_restarts": 0}, "env_runner_group": {"actor_manager_num_outstanding_async_reqs": 0}, "done": false, "training_iteration": 16, "trial_id": "b5096_00000", "date": "2025-08-11_18-47-01", "timestamp": 1754930821, "time_this_iter_s": 9.75272011756897, "time_total_s": 158.24839115142822, "pid": 11702, "hostname": "Mac", "node_ip": "127.0.0.1", "config": {"exploration_config": {}, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 2, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "env": "Umbrella", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": false, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 0, "create_local_env_runner": true, "num_envs_per_env_runner": 1, "gym_env_vectorize_mode": "SYNC", "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "episodes_to_numpy": true, "max_requests_in_flight_per_env_runner": 1, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "merge_env_runner_states": "training_only", "broadcast_env_runner_states": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "complete_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "sampler_perf_stats_ema_coef": null, "_is_online": true, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": "auto", "num_aggregator_actors_per_learner": 0, "max_requests_in_flight_per_aggregator_actor": 3, "local_gpu_idx": 0, "max_requests_in_flight_per_learner": 3, "gamma": 1, "lr": 0.0002715581955, "grad_clip": 0.5, "grad_clip_by": "global_norm", "_train_batch_size_per_learner": 5000, "train_batch_size": 4000, "num_epochs": 1, "minibatch_size": 1000, "shuffle_batch_per_epoch": true, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "log_std_clip_param": 20.0, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "_disable_preprocessor_api": false, "_disable_action_flattening": false}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {"intrinsic_reward_coeff": 0.2795015916508}, "optimizer": {}, "_learner_class": "<class 'source.intrinsic_attention_ppo.learners.IntrinsicAttentionMetaLearner.IntrinsicAttentionMetaLearner'>", "callbacks_on_algorithm_init": null, "callbacks_on_env_runners_recreated": null, "callbacks_on_offline_eval_runners_recreated": null, "callbacks_on_checkpoint_loaded": null, "callbacks_on_environment_created": null, "callbacks_on_episode_created": null, "callbacks_on_episode_start": null, "callbacks_on_episode_step": null, "callbacks_on_episode_end": null, "callbacks_on_evaluate_start": null, "callbacks_on_evaluate_end": null, "callbacks_on_evaluate_offline_start": null, "callbacks_on_evaluate_offline_end": null, "callbacks_on_sample_end": null, "callbacks_on_train_result": null, "explore": true, "enable_rl_module_and_learner": true, "enable_env_runner_and_connector_v2": true, "_prior_exploration_config": {"type": "StochasticSampling"}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x3866e5760>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "offline_data_class": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_read_batch_size": null, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "materialize_data": false, "materialize_mapped_data": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "ignore_final_observation": false, "prelearner_class": null, "prelearner_buffer_class": null, "prelearner_buffer_kwargs": {}, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_remaining_data": false, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": 1, "evaluation_duration": 20, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_auto_duration_min_env_steps_per_sample": 100, "evaluation_auto_duration_max_env_steps_per_sample": 2000, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 1, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "offline_evaluation_interval": null, "num_offline_eval_runners": 0, "offline_loss_for_module_fn": null, "offline_evaluation_duration": 1, "offline_evaluation_parallel_to_training": false, "offline_evaluation_timeout_s": 120.0, "num_cpus_per_offline_eval_runner": 1, "num_gpus_per_offline_eval_runner": 0, "custom_resources_per_offline_eval_runner": {}, "restart_failed_offline_eval_runners": true, "ignore_offline_eval_runner_failures": false, "max_num_offline_eval_runner_restarts": 1000, "offline_eval_runner_restore_timeout_s": 1800.0, "max_requests_in_flight_per_offline_eval_runner": 1, "validate_offline_eval_runners_after_construction": true, "offline_eval_runner_health_probe_timeout_s": 30.0, "offline_eval_rl_module_inference_only": false, "broadcast_offline_eval_runner_states": false, "offline_eval_batch_size_per_runner": 256, "dataset_num_iters_per_eval_runner": 1, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "log_gradients": false, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 8, "restart_failed_env_runners": true, "ignore_env_runner_failures": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30.0, "env_runner_restore_timeout_s": 1800.0, "_model_config": {}, "_rl_module_spec": "MultiRLModuleSpec(multi_rl_module_class=<class 'ray.rllib.core.rl_module.multi_rl_module.MultiRLModule'>, observation_space=None, action_space=None, inference_only=False, model_config=None, rl_module_specs={'default_policy': RLModuleSpec(module_class=<class 'source.intrinsic_attention_ppo.rl_modules.DifferentiablePPOModule.DifferentiablePPOModule'>, observation_space=None, action_space=None, inference_only=False, learner_only=False, model_config={'vf_share_layers': True, 'embedding_dim': 62, 'max_seq_len': 6, 'policy_head_hidden_sizes': [32], 'value_head_hidden_sizes': [101], 'embedding_hidden_sizes': [121]}, catalog_class=None, load_state_path=None, model_config_dict=None), 'intrinsic_reward_module': RLModuleSpec(module_class=<class 'source.intrinsic_attention_ppo.rl_modules.IntrinsicAttentionModule.IntrinsicAttentionModule'>, observation_space=None, action_space=None, inference_only=False, learner_only=True, model_config={'intrinsic_reward_network': {'encoder_hidden_sizes': [], 'encoding_dim': 1, 'num_heads': 1, 'head_hidden_sizes': None, 'layers': [{'type': 'attention'}]}, 'extrinsic_value_hidden_layers': [127, 60], 'vf_share_layers': True, 'max_seq_len': 6}, catalog_class=None, load_state_path=None, model_config_dict=None)}, load_state_path=None, modules_to_load=None, module_specs={'default_policy': RLModuleSpec(module_class=<class 'source.intrinsic_attention_ppo.rl_modules.DifferentiablePPOModule.DifferentiablePPOModule'>, observation_space=None, action_space=None, inference_only=False, learner_only=False, model_config={'vf_share_layers': True, 'embedding_dim': 62, 'max_seq_len': 6, 'policy_head_hidden_sizes': [32], 'value_head_hidden_sizes': [101], 'embedding_hidden_sizes': [121]}, catalog_class=None, load_state_path=None, model_config_dict=None), 'intrinsic_reward_module': RLModuleSpec(module_class=<class 'source.intrinsic_attention_ppo.rl_modules.IntrinsicAttentionModule.IntrinsicAttentionModule'>, observation_space=None, action_space=None, inference_only=False, learner_only=True, model_config={'intrinsic_reward_network': {'encoder_hidden_sizes': [], 'encoding_dim': 1, 'num_heads': 1, 'head_hidden_sizes': None, 'layers': [{'type': 'attention'}]}, 'extrinsic_value_hidden_layers': [127, 60], 'vf_share_layers': True, 'max_seq_len': 6}, catalog_class=None, load_state_path=None, model_config_dict=None)})", "algorithm_config_overrides_per_module": {"intrinsic_reward_module": {"lr": 0.0002715581955}}, "_per_module_overrides": {}, "_validate_config": true, "_use_msgpack_checkpoints": false, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "env_task_fn": -1, "enable_connectors": -1, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.161583927863, "kl_target": 0.0201019014258, "vf_loss_coeff": 0.7790510010087, "entropy_coeff": 0.0015431216992, "clip_param": 0.2459212356676, "vf_clip_param": 0.3769744131561, "entropy_coeff_schedule": null, "lr_schedule": null, "sgd_minibatch_size": -1, "vf_share_layers": -1, "differentiable_learner_configs": ["DifferentiableLearnerConfig(learner_class=<class 'source.intrinsic_attention_ppo.learners.IntrinsicAttentionPPOLearner.IntrinsicAttentionPPOLearner'>, learner_connector=None, add_default_connectors_to_learner_pipeline=True, is_multi_agent=False, policies_to_update=['default_policy'], lr=0.0060984166342, num_total_minibatches=0, num_epochs=1, minibatch_size=1000, shuffle_batch_per_epoch=True)"], "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9485408017724, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.callbacks.callbacks.RLlibCallback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 158.24839115142822, "iterations_since_restore": 16, "perf": {"cpu_util_percent": 38.30714285714286, "ram_util_percent": 78.74999999999999}}
{"timers": {"training_iteration": 10.21656779936263, "restore_env_runners": 1.1022328020923709e-05, "training_step": 10.216401711734916, "env_runner_sampling_timer": 1.6575556512397738, "learner_update_timer": 8.365660712019432, "synch_weights": 0.001305712567813922, "restore_eval_env_runners": 3.055252633825286e-05, "evaluation_iteration": 0.12458217244157194, "synch_eval_env_connectors": 0.00015338457209479212, "synch_env_connectors": 4.3570208642529285e-06}, "env_runners": {"episode_duration_sec_mean": 0.005634756137616929, "env_to_module_connector": {"timers": {"connectors": {"numpy_to_tensor": 1.366512991498831e-05, "add_observations_from_episodes_to_batch": 2.9662803387212578e-06, "batch_individual_items": 1.3164102324377803e-05, "add_time_dim_to_batch_and_zero_pad": 7.502907327555613e-06, "add_states_from_episodes_to_batch": 2.866386244179643e-06}}, "connector_pipeline_timer": 6.318800030904893e-05}, "num_env_steps_sampled": 5000.0, "episode_return_min": -11.5, "module_to_env_connector": {"timers": {"connectors": {"normalize_and_clip_actions": 8.57393363804556e-06, "un_batch_to_individual_items": 6.81064373132972e-06, "get_actions": 4.345139073178213e-05, "remove_single_ts_time_rank_from_batch": 1.2516653297227444e-05, "listify_data_for_vector_env": 1.1172854455177398e-05, "tensor_to_numpy": 1.6174324214191475e-05}}, "connector_pipeline_timer": 0.00012666768807797612}, "env_reset_timer": 4.3201063772269165e-05, "sample": 0.00593872159909528, "num_episodes_lifetime": -462625.0, "env_to_module_sum_episodes_length_out": 10.36823839457432, "env_step_timer": 1.4890947557831039e-05, "num_module_steps_sampled_lifetime": {"default_policy": -9252500.0}, "weights_seq_no": 16.0, "module_episode_returns_mean": {"default_policy": 1.8600000000000003}, "env_to_module_sum_episodes_length_in": 10.36823839457432, "episode_len_mean": 20.0, "agent_episode_returns_mean": {"default_agent": 1.8600000000000003}, "time_between_sampling": 0.0333229620295953, "num_module_steps_sampled": {"default_policy": 5000.0}, "episode_return_max": 8.5, "episode_len_min": 20, "episode_len_max": 20, "rlmodule_inference_timer": 3.431077585823582e-05, "num_agent_steps_sampled": {"default_agent": 5000.0}, "num_episodes": 250.0, "num_env_steps_sampled_lifetime": -9252500.0, "num_agent_steps_sampled_lifetime": {"default_agent": -9252500.0}, "episode_return_mean": 1.8600000000000003, "num_env_steps_sampled_lifetime_throughput": 3085.0814851699815}, "__all_modules__": {"learner_connector_sum_episodes_length_in": 5000.0, "learner_connector": {"connector_pipeline_timer": 0.15403841875159113, "timers": {"connectors": {"add_one_ts_to_episodes_and_truncate": 0.00881088519746132, "add_observations_from_episodes_to_batch": 0.000813702747622614, "add_columns_from_episodes_to_train_batch": 0.04115096984433243, "add_time_dim_to_batch_and_zero_pad": 0.09010291861388586, "add_states_from_episodes_to_batch": 0.003634067603878698, "batch_individual_items": 0.009297167794705748, "numpy_to_tensor": 7.94105386364455e-05}}}, "learner_connector_sum_episodes_length_out": 5250.0}, "learners": {"default_policy": {"num_module_steps_trained_lifetime": 101745, "weights_seq_no": 17.0, "entropy": 0.6829750537872314, "num_module_steps_trained": 5985, "vf_loss": 0.3205125331878662, "mean_kl_loss": 1.492972114647273e-05, "num_trainable_parameters": 16595, "curr_entropy_coeff": 0.0015431216992, "module_train_batch_size_mean": 998.0332888909784, "vf_explained_var": -0.00028336048126220703, "total_loss": 0.2484162449836731, "vf_loss_unclipped": 40.999114990234375, "policy_loss": -0.00022548361448571086, "use_intrinsic_rewards": 0.0, "diff_num_grad_updates_vs_sampler_policy": 1.0, "curr_kl_coeff": 1.2327875538176158e-06, "num_module_steps_trained_lifetime_throughput": 671.0543979016054}, "intrinsic_reward_module": {"total_loss": 0.0, "gradients_default_optimizer_global_norm": 0.0, "num_module_steps_trained_lifetime": 101745, "num_module_steps_trained": 5985, "weights_seq_no": 17.0, "num_trainable_parameters": 8266, "curr_entropy_coeff": 0.0015431216992, "module_train_batch_size_mean": 998.0332888909784, "default_optimizer_learning_rate": 0.0002715581955, "diff_num_grad_updates_vs_sampler_policy": 1.0, "num_module_steps_trained_lifetime_throughput": 671.0582291943489}, "differentiable_learners": {"intrinsic_attention_ppo_learner": {"default_policy": {"num_module_steps_trained": 35910, "weights_seq_no": 102.0, "entropy": 0.6830109357833862, "vf_loss": 0.3205550014972687, "mean_kl_loss": 1.358170084131416e-05, "module_train_batch_size_mean": 997.4956760259092, "vf_explained_var": 0.00028401613235473633, "diff_num_grad_updates_vs_sampler_policy": 86.0, "total_loss": 0.24846157431602478, "vf_loss_unclipped": 41.05150604248047, "policy_loss": -0.00021534126426558942, "use_intrinsic_rewards": 1.0, "num_module_steps_trained_lifetime": 610470}, "intrinsic_reward_module": {"module_train_batch_size_mean": 997.4956760259092, "diff_num_grad_updates_vs_sampler_policy": 86.0, "total_loss": 0.0, "num_module_steps_trained_lifetime": 610470, "num_module_steps_trained": 35910, "weights_seq_no": 102.0}, "__all_modules__": {"num_module_steps_trained_lifetime": 1220940, "num_module_steps_trained": 71820, "num_env_steps_trained": 216000, "num_env_steps_trained_lifetime": 3672000, "num_env_steps_trained_lifetime_throughput": 49348.83936303958}}}, "__all_modules__": {"num_module_steps_trained_lifetime": 203490, "num_module_steps_trained": 11970, "num_trainable_parameters": 24861, "num_env_steps_trained": 36000, "num_env_steps_trained_lifetime": 612000, "num_non_trainable_parameters": 0, "num_env_steps_trained_lifetime_throughput": 4039.2743385822537, "num_module_steps_trained_throughput": 20276081.497510314, "num_module_steps_trained_lifetime_throughput": 11876860.26941524}, "IntrinsicAttentionMask": [[[0.16677649319171906, 0.16610227525234222, 0.1680235117673874, 0.1681365668773651, 0.1654248982667923, 0.16553619503974915], [0.1668873280286789, 0.16548599302768707, 0.16949531435966492, 0.16973279416561127, 0.164084330201149, 0.16431422531604767], [0.16655108332633972, 0.1672196388244629, 0.16532865166664124, 0.16521872580051422, 0.16789674758911133, 0.16778510808944702], [0.1665293574333191, 0.16731950640678406, 0.16508609056472778, 0.16495639085769653, 0.168120339512825, 0.16798825562000275], [0.16699069738388062, 0.16485823690891266, 0.17098429799079895, 0.17134955525398254, 0.1627347618341446, 0.16308240592479706], [0.1669742614030838, 0.16496197879314423, 0.17073893547058105, 0.1710829883813858, 0.16295671463012695, 0.16328510642051697]], [[0.1668359637260437, 0.1667064130306244, 0.16657696664333344, 0.16644760966300964, 0.16841131448745728, 0.16502168774604797], [0.16686178743839264, 0.16671207547187805, 0.1665624976158142, 0.1664130538702011, 0.16868369281291962, 0.16476687788963318], [0.16688746213912964, 0.16671760380268097, 0.16654789447784424, 0.16637836396694183, 0.16895636916160583, 0.16451230645179749], [0.1669130027294159, 0.16672296822071075, 0.16653315722942352, 0.1663435399532318, 0.16922934353351593, 0.16425800323486328], [0.16651280224323273, 0.16662682592868805, 0.16674090921878815, 0.1668550670146942, 0.16513964533805847, 0.16812476515769958], [0.1671866774559021, 0.16677309572696686, 0.1663605123758316, 0.16594895720481873, 0.17227250337600708, 0.161458358168602]], [[0.16677801311016083, 0.1661037653684616, 0.16700249910354614, 0.16813808679580688, 0.16542638838291168, 0.16655124723911285], [0.1668938249349594, 0.16549243032932281, 0.1673618108034134, 0.16973939538002014, 0.16409072279930115, 0.1664218306541443], [0.16673848032951355, 0.16630619764328003, 0.16688229143619537, 0.1676086038351059, 0.165871262550354, 0.16659317910671234], [0.16653139889240265, 0.1673215627670288, 0.16626985371112823, 0.1649584174156189, 0.16812239587306976, 0.16679635643959045], [0.16700579226016998, 0.1648731529712677, 0.16772006452083588, 0.17136505246162415, 0.1627494990825653, 0.16628646850585938], [0.16681744158267975, 0.16589872539043427, 0.16712364554405212, 0.1686747670173645, 0.16497713327407837, 0.16650831699371338]], [[0.16473054885864258, 0.16954965889453888, 0.16355831921100616, 0.16834314167499542, 0.17200268805027008, 0.1618156135082245], [0.16526472568511963, 0.1687649041414261, 0.1644091159105301, 0.16789117455482483, 0.1705361157655716, 0.16313400864601135], [0.16459764540195465, 0.16974367201328278, 0.16334743797779083, 0.1684543937444687, 0.1723669469356537, 0.16148990392684937], [0.1651327759027481, 0.16895945370197296, 0.16419850289821625, 0.16800352931022644, 0.1708987057209015, 0.16280700266361237], [0.16552934050559998, 0.16837316751480103, 0.1648324728012085, 0.1676643192768097, 0.1698080152273178, 0.1637926697731018], [0.16439786553382874, 0.1700344681739807, 0.1630309820175171, 0.16862072050571442, 0.17291410267353058, 0.16100192070007324]], [[0.16660764813423157, 0.16593408584594727, 0.16785340011119843, 0.1679663360118866, 0.16525740921497345, 0.1663811206817627], [0.16653741896152496, 0.16513901948928833, 0.16913993656635284, 0.1693769097328186, 0.16374030709266663, 0.16606643795967102], [0.166719451546669, 0.1673886626958847, 0.16549578309059143, 0.16538573801517487, 0.16806645691394806, 0.16694390773773193], [0.1667284369468689, 0.16751950979232788, 0.1652834415435791, 0.1651535928249359, 0.16832129657268524, 0.16699370741844177], [0.166459858417511, 0.16433419287204742, 0.17044076323509216, 0.17080485820770264, 0.16221746802330017, 0.1657428741455078], [0.1665848046541214, 0.16566738486289978, 0.16828516125679016, 0.16843953728675842, 0.16474705934524536, 0.16627611219882965]], [[0.16652469336986542, 0.16593115031719208, 0.16533972322940826, 0.1647503823041916, 0.17387603223323822, 0.16357803344726562], [0.16651873290538788, 0.16590516269207, 0.1652938574552536, 0.16468480229377747, 0.17412406206130981, 0.16347341239452362], [0.16651268303394318, 0.16587910056114197, 0.16524793207645416, 0.16461916267871857, 0.1743723601102829, 0.16336877644062042], [0.1665065586566925, 0.16585296392440796, 0.16520193219184875, 0.1645534634590149, 0.17462092638015747, 0.16326414048671722], [0.1665908247232437, 0.16623979806900024, 0.16588950157165527, 0.1655399352312088, 0.17089694738388062, 0.16484302282333374], [0.16649407148361206, 0.16580046713352203, 0.1651097685098648, 0.1644219309091568, 0.17511889338493347, 0.16305483877658844]]]}, "num_training_step_calls_per_iteration": 1, "evaluation": {"env_runners": {"env_to_module_connector": {"timers": {"connectors": {"add_states_from_episodes_to_batch": 2.746749980194422e-06, "numpy_to_tensor": 1.2438580370459631e-05, "add_time_dim_to_batch_and_zero_pad": 6.910103745497509e-06, "add_observations_from_episodes_to_batch": 2.8075459413737536e-06, "batch_individual_items": 1.2453077726025065e-05}}, "connector_pipeline_timer": 5.979010970916625e-05}, "module_to_env_connector": {"timers": {"connectors": {"tensor_to_numpy": 1.5376466198462314e-05, "remove_single_ts_time_rank_from_batch": 1.2146579112816199e-05, "un_batch_to_individual_items": 6.65816444605554e-06, "normalize_and_clip_actions": 8.123826256687759e-06, "get_actions": 3.730794297352534e-05, "listify_data_for_vector_env": 1.0553821964994123e-05}}, "connector_pipeline_timer": 0.00011712342316324748}, "num_env_steps_sampled": 400, "num_agent_steps_sampled_lifetime": {"default_agent": 6800}, "env_step_timer": 1.4210914446071253e-05, "episode_len_max": 20, "num_episodes_lifetime": 340, "sample": 0.1158265217527582, "weights_seq_no": 17.0, "env_to_module_sum_episodes_length_in": 10.368238394574323, "module_episode_returns_mean": {"default_policy": 1.55}, "num_env_steps_sampled_lifetime": 85400, "agent_episode_returns_mean": {"default_agent": 1.55}, "episode_duration_sec_mean": 0.005265580407576635, "episode_return_mean": 1.55, "episode_return_min": -14.5, "env_reset_timer": 0.00042317948141962913, "episode_len_mean": 20.0, "episode_return_max": 14.5, "rlmodule_inference_timer": 3.199070173382597e-05, "episode_len_min": 20, "num_episodes": 20, "env_to_module_sum_episodes_length_out": 10.368238394574323, "num_module_steps_sampled_lifetime": {"default_policy": 6800}, "num_module_steps_sampled": {"default_policy": 400}, "num_agent_steps_sampled": {"default_agent": 400}, "time_between_sampling": 9.743211678536541}, "num_healthy_workers": 1, "actor_manager_num_outstanding_async_reqs": 0, "num_remote_worker_restarts": 0}, "num_env_steps_sampled_lifetime": -9252500.0, "fault_tolerance": {"num_healthy_workers": 0, "num_remote_worker_restarts": 0}, "env_runner_group": {"actor_manager_num_outstanding_async_reqs": 0}, "done": false, "training_iteration": 17, "trial_id": "b5096_00000", "date": "2025-08-11_18-47-11", "timestamp": 1754930831, "time_this_iter_s": 9.892713069915771, "time_total_s": 168.141104221344, "pid": 11702, "hostname": "Mac", "node_ip": "127.0.0.1", "config": {"exploration_config": {}, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 2, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "env": "Umbrella", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": false, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 0, "create_local_env_runner": true, "num_envs_per_env_runner": 1, "gym_env_vectorize_mode": "SYNC", "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "episodes_to_numpy": true, "max_requests_in_flight_per_env_runner": 1, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "merge_env_runner_states": "training_only", "broadcast_env_runner_states": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "complete_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "sampler_perf_stats_ema_coef": null, "_is_online": true, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": "auto", "num_aggregator_actors_per_learner": 0, "max_requests_in_flight_per_aggregator_actor": 3, "local_gpu_idx": 0, "max_requests_in_flight_per_learner": 3, "gamma": 1, "lr": 0.0002715581955, "grad_clip": 0.5, "grad_clip_by": "global_norm", "_train_batch_size_per_learner": 5000, "train_batch_size": 4000, "num_epochs": 1, "minibatch_size": 1000, "shuffle_batch_per_epoch": true, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "log_std_clip_param": 20.0, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "_disable_preprocessor_api": false, "_disable_action_flattening": false}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {"intrinsic_reward_coeff": 0.2795015916508}, "optimizer": {}, "_learner_class": "<class 'source.intrinsic_attention_ppo.learners.IntrinsicAttentionMetaLearner.IntrinsicAttentionMetaLearner'>", "callbacks_on_algorithm_init": null, "callbacks_on_env_runners_recreated": null, "callbacks_on_offline_eval_runners_recreated": null, "callbacks_on_checkpoint_loaded": null, "callbacks_on_environment_created": null, "callbacks_on_episode_created": null, "callbacks_on_episode_start": null, "callbacks_on_episode_step": null, "callbacks_on_episode_end": null, "callbacks_on_evaluate_start": null, "callbacks_on_evaluate_end": null, "callbacks_on_evaluate_offline_start": null, "callbacks_on_evaluate_offline_end": null, "callbacks_on_sample_end": null, "callbacks_on_train_result": null, "explore": true, "enable_rl_module_and_learner": true, "enable_env_runner_and_connector_v2": true, "_prior_exploration_config": {"type": "StochasticSampling"}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x3866e5760>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "offline_data_class": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_read_batch_size": null, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "materialize_data": false, "materialize_mapped_data": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "ignore_final_observation": false, "prelearner_class": null, "prelearner_buffer_class": null, "prelearner_buffer_kwargs": {}, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_remaining_data": false, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": 1, "evaluation_duration": 20, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_auto_duration_min_env_steps_per_sample": 100, "evaluation_auto_duration_max_env_steps_per_sample": 2000, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 1, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "offline_evaluation_interval": null, "num_offline_eval_runners": 0, "offline_loss_for_module_fn": null, "offline_evaluation_duration": 1, "offline_evaluation_parallel_to_training": false, "offline_evaluation_timeout_s": 120.0, "num_cpus_per_offline_eval_runner": 1, "num_gpus_per_offline_eval_runner": 0, "custom_resources_per_offline_eval_runner": {}, "restart_failed_offline_eval_runners": true, "ignore_offline_eval_runner_failures": false, "max_num_offline_eval_runner_restarts": 1000, "offline_eval_runner_restore_timeout_s": 1800.0, "max_requests_in_flight_per_offline_eval_runner": 1, "validate_offline_eval_runners_after_construction": true, "offline_eval_runner_health_probe_timeout_s": 30.0, "offline_eval_rl_module_inference_only": false, "broadcast_offline_eval_runner_states": false, "offline_eval_batch_size_per_runner": 256, "dataset_num_iters_per_eval_runner": 1, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "log_gradients": false, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 8, "restart_failed_env_runners": true, "ignore_env_runner_failures": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30.0, "env_runner_restore_timeout_s": 1800.0, "_model_config": {}, "_rl_module_spec": "MultiRLModuleSpec(multi_rl_module_class=<class 'ray.rllib.core.rl_module.multi_rl_module.MultiRLModule'>, observation_space=None, action_space=None, inference_only=False, model_config=None, rl_module_specs={'default_policy': RLModuleSpec(module_class=<class 'source.intrinsic_attention_ppo.rl_modules.DifferentiablePPOModule.DifferentiablePPOModule'>, observation_space=None, action_space=None, inference_only=False, learner_only=False, model_config={'vf_share_layers': True, 'embedding_dim': 62, 'max_seq_len': 6, 'policy_head_hidden_sizes': [32], 'value_head_hidden_sizes': [101], 'embedding_hidden_sizes': [121]}, catalog_class=None, load_state_path=None, model_config_dict=None), 'intrinsic_reward_module': RLModuleSpec(module_class=<class 'source.intrinsic_attention_ppo.rl_modules.IntrinsicAttentionModule.IntrinsicAttentionModule'>, observation_space=None, action_space=None, inference_only=False, learner_only=True, model_config={'intrinsic_reward_network': {'encoder_hidden_sizes': [], 'encoding_dim': 1, 'num_heads': 1, 'head_hidden_sizes': None, 'layers': [{'type': 'attention'}]}, 'extrinsic_value_hidden_layers': [127, 60], 'vf_share_layers': True, 'max_seq_len': 6}, catalog_class=None, load_state_path=None, model_config_dict=None)}, load_state_path=None, modules_to_load=None, module_specs={'default_policy': RLModuleSpec(module_class=<class 'source.intrinsic_attention_ppo.rl_modules.DifferentiablePPOModule.DifferentiablePPOModule'>, observation_space=None, action_space=None, inference_only=False, learner_only=False, model_config={'vf_share_layers': True, 'embedding_dim': 62, 'max_seq_len': 6, 'policy_head_hidden_sizes': [32], 'value_head_hidden_sizes': [101], 'embedding_hidden_sizes': [121]}, catalog_class=None, load_state_path=None, model_config_dict=None), 'intrinsic_reward_module': RLModuleSpec(module_class=<class 'source.intrinsic_attention_ppo.rl_modules.IntrinsicAttentionModule.IntrinsicAttentionModule'>, observation_space=None, action_space=None, inference_only=False, learner_only=True, model_config={'intrinsic_reward_network': {'encoder_hidden_sizes': [], 'encoding_dim': 1, 'num_heads': 1, 'head_hidden_sizes': None, 'layers': [{'type': 'attention'}]}, 'extrinsic_value_hidden_layers': [127, 60], 'vf_share_layers': True, 'max_seq_len': 6}, catalog_class=None, load_state_path=None, model_config_dict=None)})", "algorithm_config_overrides_per_module": {"intrinsic_reward_module": {"lr": 0.0002715581955}}, "_per_module_overrides": {}, "_validate_config": true, "_use_msgpack_checkpoints": false, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "env_task_fn": -1, "enable_connectors": -1, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.161583927863, "kl_target": 0.0201019014258, "vf_loss_coeff": 0.7790510010087, "entropy_coeff": 0.0015431216992, "clip_param": 0.2459212356676, "vf_clip_param": 0.3769744131561, "entropy_coeff_schedule": null, "lr_schedule": null, "sgd_minibatch_size": -1, "vf_share_layers": -1, "differentiable_learner_configs": ["DifferentiableLearnerConfig(learner_class=<class 'source.intrinsic_attention_ppo.learners.IntrinsicAttentionPPOLearner.IntrinsicAttentionPPOLearner'>, learner_connector=None, add_default_connectors_to_learner_pipeline=True, is_multi_agent=False, policies_to_update=['default_policy'], lr=0.0060984166342, num_total_minibatches=0, num_epochs=1, minibatch_size=1000, shuffle_batch_per_epoch=True)"], "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9485408017724, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.callbacks.callbacks.RLlibCallback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 168.141104221344, "iterations_since_restore": 17, "perf": {"cpu_util_percent": 37.82857142857142, "ram_util_percent": 79.15714285714286}}
{"timers": {"training_iteration": 10.21262717052896, "restore_env_runners": 1.0970024855783027e-05, "training_step": 10.212460592947407, "env_runner_sampling_timer": 1.6569164197277422, "learner_update_timer": 8.362309494899815, "synch_weights": 0.001301265861599149, "restore_eval_env_runners": 3.0325751383473377e-05, "evaluation_iteration": 0.12463096530716217, "synch_eval_env_connectors": 0.0001533211368717033, "synch_env_connectors": 4.3501203178326656e-06}, "env_runners": {"episode_duration_sec_mean": 0.0054774943422526146, "env_to_module_connector": {"timers": {"connectors": {"numpy_to_tensor": 1.3195827301575109e-05, "add_observations_from_episodes_to_batch": 2.8826460562572443e-06, "batch_individual_items": 1.2830168575532622e-05, "add_time_dim_to_batch_and_zero_pad": 7.204113682942518e-06, "add_states_from_episodes_to_batch": 2.7961041586796786e-06}}, "connector_pipeline_timer": 6.152264407786205e-05}, "num_env_steps_sampled": 5000.0, "episode_return_min": -11.5, "module_to_env_connector": {"timers": {"connectors": {"normalize_and_clip_actions": 8.348568444347573e-06, "un_batch_to_individual_items": 6.708592865563402e-06, "get_actions": 4.170333007540519e-05, "remove_single_ts_time_rank_from_batch": 1.2233837308821962e-05, "listify_data_for_vector_env": 1.0891429711658168e-05, "tensor_to_numpy": 1.575185860287326e-05}}, "connector_pipeline_timer": 0.00012282082446322132}, "env_reset_timer": 4.088668147133479e-05, "sample": 0.005818622811685601, "num_episodes_lifetime": -493500.0, "env_to_module_sum_episodes_length_out": 10.36823839457432, "env_step_timer": 1.4523137162946325e-05, "num_module_steps_sampled_lifetime": {"default_policy": -9870000.0}, "weights_seq_no": 17.0, "module_episode_returns_mean": {"default_policy": 0.09999999999999998}, "env_to_module_sum_episodes_length_in": 10.36823839457432, "episode_len_mean": 20.0, "agent_episode_returns_mean": {"default_agent": 0.09999999999999998}, "time_between_sampling": 0.03355840073334313, "num_module_steps_sampled": {"default_policy": 5000.0}, "episode_return_max": 8.5, "episode_len_min": 20, "episode_len_max": 20, "rlmodule_inference_timer": 3.295354184127592e-05, "num_agent_steps_sampled": {"default_agent": 5000.0}, "num_episodes": 250.0, "num_env_steps_sampled_lifetime": -9870000.0, "num_agent_steps_sampled_lifetime": {"default_agent": -9870000.0}, "episode_return_mean": 0.09999999999999998, "num_env_steps_sampled_lifetime_throughput": 3160.9600279860497}, "__all_modules__": {"learner_connector_sum_episodes_length_in": 5000.0, "learner_connector": {"connector_pipeline_timer": 0.15400362456496355, "timers": {"connectors": {"add_one_ts_to_episodes_and_truncate": 0.008809643015076361, "add_observations_from_episodes_to_batch": 0.0008136723895574511, "add_columns_from_episodes_to_train_batch": 0.041153849726144484, "add_time_dim_to_batch_and_zero_pad": 0.09008660650779063, "add_states_from_episodes_to_batch": 0.0036338631773858722, "batch_individual_items": 0.009278102366358221, "numpy_to_tensor": 7.918684271566224e-05}}}, "learner_connector_sum_episodes_length_out": 5250.0}, "learners": {"default_policy": {"num_module_steps_trained_lifetime": 107730, "weights_seq_no": 18.0, "entropy": 0.6815385818481445, "num_module_steps_trained": 5985, "vf_loss": 0.32051199674606323, "mean_kl_loss": 5.458965097204782e-05, "num_trainable_parameters": 16595, "curr_entropy_coeff": 0.0015431216992, "module_train_batch_size_mean": 998.0016398003509, "vf_explained_var": 5.5670738220214844e-05, "total_loss": 0.24829141795635223, "vf_loss_unclipped": 41.230770111083984, "policy_loss": -0.00035208690678700805, "use_intrinsic_rewards": 0.0, "diff_num_grad_updates_vs_sampler_policy": 1.0, "curr_kl_coeff": 6.163937769088079e-07, "num_module_steps_trained_lifetime_throughput": 672.1347440800861}, "intrinsic_reward_module": {"total_loss": 0.0, "gradients_default_optimizer_global_norm": 0.0, "num_module_steps_trained_lifetime": 107730, "num_module_steps_trained": 5985, "weights_seq_no": 18.0, "num_trainable_parameters": 8266, "curr_entropy_coeff": 0.0015431216992, "module_train_batch_size_mean": 998.0016398003509, "default_optimizer_learning_rate": 0.0002715581955, "diff_num_grad_updates_vs_sampler_policy": 1.0, "num_module_steps_trained_lifetime_throughput": 672.1382807509601}, "differentiable_learners": {"intrinsic_attention_ppo_learner": {"default_policy": {"num_module_steps_trained": 35910, "weights_seq_no": 108.0, "entropy": 0.6815680265426636, "vf_loss": 0.3205512762069702, "mean_kl_loss": 5.257909288047813e-05, "module_train_batch_size_mean": 997.4947003847115, "vf_explained_var": 0.0004855990409851074, "diff_num_grad_updates_vs_sampler_policy": 91.0, "total_loss": 0.2483382523059845, "vf_loss_unclipped": 41.280662536621094, "policy_loss": -0.00034429653896950185, "use_intrinsic_rewards": 1.0, "num_module_steps_trained_lifetime": 646380}, "intrinsic_reward_module": {"module_train_batch_size_mean": 997.4947003847115, "diff_num_grad_updates_vs_sampler_policy": 91.0, "total_loss": 0.0, "num_module_steps_trained_lifetime": 646380, "num_module_steps_trained": 35910, "weights_seq_no": 108.0}, "__all_modules__": {"num_module_steps_trained_lifetime": 1292760, "num_module_steps_trained": 71820, "num_env_steps_trained": 216000, "num_env_steps_trained_lifetime": 3888000, "num_env_steps_trained_lifetime_throughput": 48627.66787349331}}}, "__all_modules__": {"num_module_steps_trained_lifetime": 215460, "num_module_steps_trained": 11970, "num_trainable_parameters": 24861, "num_env_steps_trained": 36000, "num_env_steps_trained_lifetime": 648000, "num_non_trainable_parameters": 0, "num_env_steps_trained_lifetime_throughput": 4045.669504899321, "num_module_steps_trained_throughput": 19845738.52247937, "num_module_steps_trained_lifetime_throughput": 11866516.70200536}, "IntrinsicAttentionMask": [[[0.16677813231945038, 0.16610388457775116, 0.1670026183128357, 0.16813820600509644, 0.16643938422203064, 0.16553780436515808], [0.1668943166732788, 0.16549290716648102, 0.1673622876405716, 0.16973988711833954, 0.16618949174880981, 0.16432110965251923], [0.16673852503299713, 0.16630622744560242, 0.16688232123851776, 0.16760864853858948, 0.16652141511440277, 0.16594280302524567], [0.1665315479040146, 0.16732169687747955, 0.16627000272274017, 0.16495859622955322, 0.16692766547203064, 0.16799046099185944], [0.16683700680732727, 0.16579753160476685, 0.16718362271785736, 0.16894076764583588, 0.166314497590065, 0.16492660343647003], [0.16698870062828064, 0.16497626900672913, 0.16766239702701569, 0.1710977852344513, 0.1659756302833557, 0.16329924762248993]], [[0.16473683714866638, 0.1695561408996582, 0.16356459259986877, 0.16298158466815948, 0.17200924456119537, 0.16715161502361298], [0.16526806354522705, 0.16876831650733948, 0.16441243886947632, 0.16398629546165466, 0.17053954303264618, 0.1670253425836563], [0.1646048128604889, 0.16975104808807373, 0.1633545458316803, 0.16273297369480133, 0.1723744124174118, 0.16718214750289917], [0.16453874111175537, 0.1698485165834427, 0.16324953734874725, 0.16260872781276703, 0.17255720496177673, 0.1671973317861557], [0.16553157567977905, 0.1683754324913025, 0.16483469307422638, 0.16448736190795898, 0.16981029510498047, 0.1669607162475586], [0.16500531136989594, 0.1691586971282959, 0.1639925092458725, 0.1634884476661682, 0.171266570687294, 0.16708847880363464]], [[0.16699418425559998, 0.16706795990467072, 0.16586238145828247, 0.16579213738441467, 0.1668557971715927, 0.16742749512195587], [0.1668969839811325, 0.16694878041744232, 0.1661013811826706, 0.1660519391298294, 0.16679979860782623, 0.16720116138458252], [0.16847242414951324, 0.16888800263404846, 0.1622008979320526, 0.16181808710098267, 0.1676950752735138, 0.1709255576133728], [0.16856329143047333, 0.16900040209293365, 0.1619739830493927, 0.1615721881389618, 0.16774588823318481, 0.17114418745040894], [0.1671762764453888, 0.16729135811328888, 0.16541418433189392, 0.16530504822731018, 0.1669604629278183, 0.16785266995429993], [0.16642171144485474, 0.16636697947978973, 0.1672666221857071, 0.1673193871974945, 0.1665244847536087, 0.16610087454319]], [[0.1665247082710266, 0.16593115031719208, 0.16533972322940826, 0.16475039720535278, 0.17387601733207703, 0.16357803344726562], [0.16651873290538788, 0.16590516269207, 0.1652938425540924, 0.16468480229377747, 0.17412403225898743, 0.16347341239452362], [0.16651266813278198, 0.16587908565998077, 0.16524791717529297, 0.16461914777755737, 0.1743723303079605, 0.16336879134178162], [0.1665065437555313, 0.16585294902324677, 0.16520193219184875, 0.1645534485578537, 0.17462089657783508, 0.16326414048671722], [0.16659080982208252, 0.16623976826667786, 0.16588948667049408, 0.1655399203300476, 0.17089691758155823, 0.16484300792217255], [0.16649408638477325, 0.16580048203468323, 0.1651097685098648, 0.164421945810318, 0.17511887848377228, 0.16305485367774963]], [[0.16699476540088654, 0.16706854104995728, 0.16650177538394928, 0.16579271852970123, 0.16685637831687927, 0.16678571701049805], [0.1668972671031952, 0.1669490784406662, 0.1665509194135666, 0.16605223715305328, 0.16680008172988892, 0.1667504459619522], [0.16764648258686066, 0.16786804795265198, 0.16617079079151154, 0.16406357288360596, 0.16723136603832245, 0.16701968014240265], [0.16858389973640442, 0.16902105510234833, 0.16568654775619507, 0.16159194707870483, 0.16776637732982635, 0.16735023260116577], [0.1671777069568634, 0.16729280352592468, 0.16640935838222504, 0.1653064787387848, 0.1669619083404541, 0.16685174405574799], [0.16727113723754883, 0.16740736365318298, 0.16636201739311218, 0.1650584638118744, 0.1670157015323639, 0.1668853461742401]], [[0.16762275993824005, 0.1663159281015396, 0.16618677973747253, 0.1660577356815338, 0.16801682114601135, 0.16579994559288025], [0.16912300884723663, 0.16575953364372253, 0.16542938351631165, 0.1650998741388321, 0.17014534771442413, 0.16444283723831177], [0.16927208006381989, 0.16570386290550232, 0.16535384953022003, 0.16500456631183624, 0.17035751044750214, 0.16430820524692535], [0.16942115128040314, 0.16564808785915375, 0.16527822613716125, 0.16490918397903442, 0.17056980729103088, 0.16417357325553894], [0.16717323660850525, 0.16648121178150177, 0.16641269624233246, 0.16634419560432434, 0.1673814207315445, 0.16620726883411407], [0.169719398021698, 0.1655362993478775, 0.16512678563594818, 0.16471828520298004, 0.17099489271640778, 0.1639043241739273]]]}, "num_training_step_calls_per_iteration": 1, "evaluation": {"env_runners": {"env_to_module_connector": {"timers": {"connectors": {"add_states_from_episodes_to_batch": 2.6686223515194294e-06, "numpy_to_tensor": 1.1929967424527511e-05, "add_time_dim_to_batch_and_zero_pad": 6.6201473267941394e-06, "add_observations_from_episodes_to_batch": 2.7207488226796786e-06, "batch_individual_items": 1.2081726835493649e-05}}, "connector_pipeline_timer": 5.7959545991794764e-05}, "module_to_env_connector": {"timers": {"connectors": {"tensor_to_numpy": 1.4720567152282665e-05, "remove_single_ts_time_rank_from_batch": 1.1780064479691437e-05, "un_batch_to_individual_items": 6.468122587749796e-06, "normalize_and_clip_actions": 7.876341953963386e-06, "get_actions": 3.518003689588523e-05, "listify_data_for_vector_env": 1.0202027847228399e-05}}, "connector_pipeline_timer": 0.00011249190543093521}, "num_env_steps_sampled": 400, "num_agent_steps_sampled_lifetime": {"default_agent": 7200}, "env_step_timer": 1.380815499978421e-05, "episode_len_max": 20, "num_episodes_lifetime": 360, "sample": 0.11578556612556655, "weights_seq_no": 18.0, "env_to_module_sum_episodes_length_in": 10.368238394574323, "module_episode_returns_mean": {"default_policy": 1.15}, "num_env_steps_sampled_lifetime": 90400, "agent_episode_returns_mean": {"default_agent": 1.15}, "episode_duration_sec_mean": 0.0052663112489972266, "episode_return_mean": 1.15, "episode_return_min": -14.5, "env_reset_timer": 0.0004197843565384837, "episode_len_mean": 20.0, "episode_return_max": 14.5, "rlmodule_inference_timer": 3.0394348698291427e-05, "episode_len_min": 20, "num_episodes": 20, "env_to_module_sum_episodes_length_out": 10.368238394574323, "num_module_steps_sampled_lifetime": {"default_policy": 7200}, "num_module_steps_sampled": {"default_policy": 400}, "num_agent_steps_sampled": {"default_agent": 400}, "time_between_sampling": 9.744236617171325}, "num_healthy_workers": 1, "actor_manager_num_outstanding_async_reqs": 0, "num_remote_worker_restarts": 0}, "num_env_steps_sampled_lifetime": -9870000.0, "fault_tolerance": {"num_healthy_workers": 0, "num_remote_worker_restarts": 0}, "env_runner_group": {"actor_manager_num_outstanding_async_reqs": 0}, "done": false, "training_iteration": 18, "trial_id": "b5096_00000", "date": "2025-08-11_18-47-21", "timestamp": 1754930841, "time_this_iter_s": 9.942991256713867, "time_total_s": 178.08409547805786, "pid": 11702, "hostname": "Mac", "node_ip": "127.0.0.1", "config": {"exploration_config": {}, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 2, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "env": "Umbrella", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": false, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 0, "create_local_env_runner": true, "num_envs_per_env_runner": 1, "gym_env_vectorize_mode": "SYNC", "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "episodes_to_numpy": true, "max_requests_in_flight_per_env_runner": 1, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "merge_env_runner_states": "training_only", "broadcast_env_runner_states": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "complete_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "sampler_perf_stats_ema_coef": null, "_is_online": true, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": "auto", "num_aggregator_actors_per_learner": 0, "max_requests_in_flight_per_aggregator_actor": 3, "local_gpu_idx": 0, "max_requests_in_flight_per_learner": 3, "gamma": 1, "lr": 0.0002715581955, "grad_clip": 0.5, "grad_clip_by": "global_norm", "_train_batch_size_per_learner": 5000, "train_batch_size": 4000, "num_epochs": 1, "minibatch_size": 1000, "shuffle_batch_per_epoch": true, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "log_std_clip_param": 20.0, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "_disable_preprocessor_api": false, "_disable_action_flattening": false}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {"intrinsic_reward_coeff": 0.2795015916508}, "optimizer": {}, "_learner_class": "<class 'source.intrinsic_attention_ppo.learners.IntrinsicAttentionMetaLearner.IntrinsicAttentionMetaLearner'>", "callbacks_on_algorithm_init": null, "callbacks_on_env_runners_recreated": null, "callbacks_on_offline_eval_runners_recreated": null, "callbacks_on_checkpoint_loaded": null, "callbacks_on_environment_created": null, "callbacks_on_episode_created": null, "callbacks_on_episode_start": null, "callbacks_on_episode_step": null, "callbacks_on_episode_end": null, "callbacks_on_evaluate_start": null, "callbacks_on_evaluate_end": null, "callbacks_on_evaluate_offline_start": null, "callbacks_on_evaluate_offline_end": null, "callbacks_on_sample_end": null, "callbacks_on_train_result": null, "explore": true, "enable_rl_module_and_learner": true, "enable_env_runner_and_connector_v2": true, "_prior_exploration_config": {"type": "StochasticSampling"}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x3866e5760>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "offline_data_class": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_read_batch_size": null, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "materialize_data": false, "materialize_mapped_data": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "ignore_final_observation": false, "prelearner_class": null, "prelearner_buffer_class": null, "prelearner_buffer_kwargs": {}, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_remaining_data": false, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": 1, "evaluation_duration": 20, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_auto_duration_min_env_steps_per_sample": 100, "evaluation_auto_duration_max_env_steps_per_sample": 2000, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 1, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "offline_evaluation_interval": null, "num_offline_eval_runners": 0, "offline_loss_for_module_fn": null, "offline_evaluation_duration": 1, "offline_evaluation_parallel_to_training": false, "offline_evaluation_timeout_s": 120.0, "num_cpus_per_offline_eval_runner": 1, "num_gpus_per_offline_eval_runner": 0, "custom_resources_per_offline_eval_runner": {}, "restart_failed_offline_eval_runners": true, "ignore_offline_eval_runner_failures": false, "max_num_offline_eval_runner_restarts": 1000, "offline_eval_runner_restore_timeout_s": 1800.0, "max_requests_in_flight_per_offline_eval_runner": 1, "validate_offline_eval_runners_after_construction": true, "offline_eval_runner_health_probe_timeout_s": 30.0, "offline_eval_rl_module_inference_only": false, "broadcast_offline_eval_runner_states": false, "offline_eval_batch_size_per_runner": 256, "dataset_num_iters_per_eval_runner": 1, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "log_gradients": false, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 8, "restart_failed_env_runners": true, "ignore_env_runner_failures": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30.0, "env_runner_restore_timeout_s": 1800.0, "_model_config": {}, "_rl_module_spec": "MultiRLModuleSpec(multi_rl_module_class=<class 'ray.rllib.core.rl_module.multi_rl_module.MultiRLModule'>, observation_space=None, action_space=None, inference_only=False, model_config=None, rl_module_specs={'default_policy': RLModuleSpec(module_class=<class 'source.intrinsic_attention_ppo.rl_modules.DifferentiablePPOModule.DifferentiablePPOModule'>, observation_space=None, action_space=None, inference_only=False, learner_only=False, model_config={'vf_share_layers': True, 'embedding_dim': 62, 'max_seq_len': 6, 'policy_head_hidden_sizes': [32], 'value_head_hidden_sizes': [101], 'embedding_hidden_sizes': [121]}, catalog_class=None, load_state_path=None, model_config_dict=None), 'intrinsic_reward_module': RLModuleSpec(module_class=<class 'source.intrinsic_attention_ppo.rl_modules.IntrinsicAttentionModule.IntrinsicAttentionModule'>, observation_space=None, action_space=None, inference_only=False, learner_only=True, model_config={'intrinsic_reward_network': {'encoder_hidden_sizes': [], 'encoding_dim': 1, 'num_heads': 1, 'head_hidden_sizes': None, 'layers': [{'type': 'attention'}]}, 'extrinsic_value_hidden_layers': [127, 60], 'vf_share_layers': True, 'max_seq_len': 6}, catalog_class=None, load_state_path=None, model_config_dict=None)}, load_state_path=None, modules_to_load=None, module_specs={'default_policy': RLModuleSpec(module_class=<class 'source.intrinsic_attention_ppo.rl_modules.DifferentiablePPOModule.DifferentiablePPOModule'>, observation_space=None, action_space=None, inference_only=False, learner_only=False, model_config={'vf_share_layers': True, 'embedding_dim': 62, 'max_seq_len': 6, 'policy_head_hidden_sizes': [32], 'value_head_hidden_sizes': [101], 'embedding_hidden_sizes': [121]}, catalog_class=None, load_state_path=None, model_config_dict=None), 'intrinsic_reward_module': RLModuleSpec(module_class=<class 'source.intrinsic_attention_ppo.rl_modules.IntrinsicAttentionModule.IntrinsicAttentionModule'>, observation_space=None, action_space=None, inference_only=False, learner_only=True, model_config={'intrinsic_reward_network': {'encoder_hidden_sizes': [], 'encoding_dim': 1, 'num_heads': 1, 'head_hidden_sizes': None, 'layers': [{'type': 'attention'}]}, 'extrinsic_value_hidden_layers': [127, 60], 'vf_share_layers': True, 'max_seq_len': 6}, catalog_class=None, load_state_path=None, model_config_dict=None)})", "algorithm_config_overrides_per_module": {"intrinsic_reward_module": {"lr": 0.0002715581955}}, "_per_module_overrides": {}, "_validate_config": true, "_use_msgpack_checkpoints": false, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "env_task_fn": -1, "enable_connectors": -1, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.161583927863, "kl_target": 0.0201019014258, "vf_loss_coeff": 0.7790510010087, "entropy_coeff": 0.0015431216992, "clip_param": 0.2459212356676, "vf_clip_param": 0.3769744131561, "entropy_coeff_schedule": null, "lr_schedule": null, "sgd_minibatch_size": -1, "vf_share_layers": -1, "differentiable_learner_configs": ["DifferentiableLearnerConfig(learner_class=<class 'source.intrinsic_attention_ppo.learners.IntrinsicAttentionPPOLearner.IntrinsicAttentionPPOLearner'>, learner_connector=None, add_default_connectors_to_learner_pipeline=True, is_multi_agent=False, policies_to_update=['default_policy'], lr=0.0060984166342, num_total_minibatches=0, num_epochs=1, minibatch_size=1000, shuffle_batch_per_epoch=True)"], "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9485408017724, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.callbacks.callbacks.RLlibCallback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 178.08409547805786, "iterations_since_restore": 18, "perf": {"cpu_util_percent": 31.349999999999998, "ram_util_percent": 79.38571428571429}}
{"timers": {"training_iteration": 10.203891731744228, "restore_env_runners": 1.0929495098995106e-05, "training_step": 10.203724557427668, "env_runner_sampling_timer": 1.6555200717811709, "learner_update_timer": 8.354914009531198, "synch_weights": 0.001297951953201534, "restore_eval_env_runners": 3.008916376029571e-05, "evaluation_iteration": 0.12455873440428179, "synch_eval_env_connectors": 0.00015300875552068708, "synch_env_connectors": 4.348288814949072e-06}, "env_runners": {"episode_duration_sec_mean": 0.005229013354051861, "env_to_module_connector": {"timers": {"connectors": {"numpy_to_tensor": 1.2442769145290019e-05, "add_observations_from_episodes_to_batch": 2.793519828002859e-06, "batch_individual_items": 1.2486187434468446e-05, "add_time_dim_to_batch_and_zero_pad": 6.950780793062418e-06, "add_states_from_episodes_to_batch": 2.7150214702498006e-06}}, "connector_pipeline_timer": 5.940579267015156e-05}, "num_env_steps_sampled": 5000.0, "episode_return_min": -11.5, "module_to_env_connector": {"timers": {"connectors": {"normalize_and_clip_actions": 8.015463750476214e-06, "un_batch_to_individual_items": 6.497803981157929e-06, "get_actions": 3.8798092807409175e-05, "remove_single_ts_time_rank_from_batch": 1.1851690192798636e-05, "listify_data_for_vector_env": 1.0514345349978821e-05, "tensor_to_numpy": 1.5095763762695936e-05}}, "connector_pipeline_timer": 0.00011714685005122137}, "env_reset_timer": 4.002136839374418e-05, "sample": 0.005754503021854523, "num_episodes_lifetime": -524375.0, "env_to_module_sum_episodes_length_out": 10.36823839457432, "env_step_timer": 1.3806252114334885e-05, "num_module_steps_sampled_lifetime": {"default_policy": -10487500.0}, "weights_seq_no": 18.0, "module_episode_returns_mean": {"default_policy": 0.8199999999999998}, "env_to_module_sum_episodes_length_in": 10.36823839457432, "episode_len_mean": 20.0, "agent_episode_returns_mean": {"default_agent": 0.8199999999999998}, "time_between_sampling": 0.03392315738123008, "num_module_steps_sampled": {"default_policy": 5000.0}, "episode_return_max": 8.5, "episode_len_min": 20, "episode_len_max": 20, "rlmodule_inference_timer": 3.1269964605911316e-05, "num_agent_steps_sampled": {"default_agent": 5000.0}, "num_episodes": 250.0, "num_env_steps_sampled_lifetime": -10487500.0, "num_agent_steps_sampled_lifetime": {"default_agent": -10487500.0}, "episode_return_mean": 0.8199999999999998, "num_env_steps_sampled_lifetime_throughput": 3256.9963922895095}, "__all_modules__": {"learner_connector_sum_episodes_length_in": 5000.0, "learner_connector": {"connector_pipeline_timer": 0.1539722937397335, "timers": {"connectors": {"add_one_ts_to_episodes_and_truncate": 0.008807247004657036, "add_observations_from_episodes_to_batch": 0.0008136627461713156, "add_columns_from_episodes_to_train_batch": 0.04115851080895081, "add_time_dim_to_batch_and_zero_pad": 0.09007139961258409, "add_states_from_episodes_to_batch": 0.0036338649562003226, "batch_individual_items": 0.00926055343242462, "numpy_to_tensor": 7.896163401657074e-05}}}, "learner_connector_sum_episodes_length_out": 5250.0}, "learners": {"default_policy": {"num_module_steps_trained_lifetime": 113715, "weights_seq_no": 19.0, "entropy": 0.6800424456596375, "num_module_steps_trained": 5985, "vf_loss": 0.3205117881298065, "mean_kl_loss": 4.9798771215137094e-05, "num_trainable_parameters": 16595, "curr_entropy_coeff": 0.0015431216992, "module_train_batch_size_mean": 997.9718428097785, "vf_explained_var": 0.00011545419692993164, "total_loss": 0.2482822984457016, "vf_loss_unclipped": 41.50238037109375, "policy_loss": -0.0003633800952229649, "use_intrinsic_rewards": 0.0, "diff_num_grad_updates_vs_sampler_policy": 1.0, "curr_kl_coeff": 3.0819688845440396e-07, "num_module_steps_trained_lifetime_throughput": 673.4512997932993}, "intrinsic_reward_module": {"total_loss": 0.0, "gradients_default_optimizer_global_norm": 0.0, "num_module_steps_trained_lifetime": 113715, "num_module_steps_trained": 5985, "weights_seq_no": 19.0, "num_trainable_parameters": 8266, "curr_entropy_coeff": 0.0015431216992, "module_train_batch_size_mean": 997.9718428097785, "default_optimizer_learning_rate": 0.0002715581955, "diff_num_grad_updates_vs_sampler_policy": 1.0, "num_module_steps_trained_lifetime_throughput": 673.4545534189997}, "differentiable_learners": {"intrinsic_attention_ppo_learner": {"default_policy": {"num_module_steps_trained": 35910, "weights_seq_no": 114.0, "entropy": 0.6800739169120789, "vf_loss": 0.32054808735847473, "mean_kl_loss": 4.786203498952091e-05, "module_train_batch_size_mean": 997.4940209352853, "vf_explained_var": 0.0004774928092956543, "diff_num_grad_updates_vs_sampler_policy": 96.0, "total_loss": 0.24832671880722046, "vf_loss_unclipped": 41.542362213134766, "policy_loss": -0.00035488957655616105, "use_intrinsic_rewards": 1.0, "num_module_steps_trained_lifetime": 682290}, "intrinsic_reward_module": {"module_train_batch_size_mean": 997.4940209352853, "diff_num_grad_updates_vs_sampler_policy": 96.0, "total_loss": 0.0, "num_module_steps_trained_lifetime": 682290, "num_module_steps_trained": 35910, "weights_seq_no": 114.0}, "__all_modules__": {"num_module_steps_trained_lifetime": 1364580, "num_module_steps_trained": 71820, "num_env_steps_trained": 216000, "num_env_steps_trained_lifetime": 4104000, "num_env_steps_trained_lifetime_throughput": 47950.63387332154}}}, "__all_modules__": {"num_module_steps_trained_lifetime": 227430, "num_module_steps_trained": 11970, "num_trainable_parameters": 24861, "num_env_steps_trained": 36000, "num_env_steps_trained_lifetime": 684000, "num_non_trainable_parameters": 0, "num_env_steps_trained_lifetime_throughput": 4053.492001872685, "num_module_steps_trained_throughput": 19460446.929448023, "num_module_steps_trained_lifetime_throughput": 11884666.403313268}, "IntrinsicAttentionMask": [[[0.16699400544166565, 0.16771122813224792, 0.16586220264434814, 0.16579195857048035, 0.1668556183576584, 0.16678495705127716], [0.16604407131671906, 0.16470785439014435, 0.16818663477897644, 0.16832099854946136, 0.16630379855632782, 0.16643664240837097], [0.16846661269664764, 0.1725427359342575, 0.16219530999660492, 0.16181251406669617, 0.16768929362297058, 0.16729353368282318], [0.16855689883232117, 0.17284631729125977, 0.16196782886981964, 0.16156606376171112, 0.16773949563503265, 0.16732341051101685], [0.16717582941055298, 0.16829591989517212, 0.1654137372970581, 0.16530461609363556, 0.16696001589298248, 0.16684986650943756], [0.16726848483085632, 0.1685951203107834, 0.16518476605415344, 0.16505585610866547, 0.16701306402683258, 0.16688272356987]], [[0.16782821714878082, 0.16741342842578888, 0.1669996827840805, 0.1665869504213333, 0.16908825933933258, 0.1620834320783615], [0.16788439452648163, 0.1674492359161377, 0.1670152246952057, 0.16658233106136322, 0.1692066192626953, 0.16186225414276123], [0.16794048249721527, 0.16748495399951935, 0.1670306771993637, 0.16657762229442596, 0.16932496428489685, 0.16164128482341766], [0.16799654066562653, 0.16752062737941742, 0.16704607009887695, 0.16657285392284393, 0.16944333910942078, 0.16142058372497559], [0.16765816509723663, 0.1673048883676529, 0.16695234179496765, 0.1666005402803421, 0.16873061656951904, 0.16275344789028168], [0.1686139702796936, 0.16791154444217682, 0.16721202433109283, 0.16651543974876404, 0.17075517773628235, 0.1589917689561844]], [[0.1667805165052414, 0.16685418784618378, 0.1656501591205597, 0.16621774435043335, 0.16728411614894867, 0.16721327602863312], [0.1667468547821045, 0.16679860651493073, 0.16595196723937988, 0.1663513034582138, 0.16710048913955688, 0.16705076396465302], [0.16727766394615173, 0.16769029200077057, 0.16105061769485474, 0.1641530990600586, 0.17011487483978271, 0.16971339285373688], [0.16703255474567413, 0.1672743856906891, 0.1633528769016266, 0.16519339382648468, 0.16869033873081207, 0.16845645010471344], [0.16654744744300842, 0.1664717197418213, 0.16771793365478516, 0.16712819039821625, 0.166031152009964, 0.16610358655452728], [0.1665806621313095, 0.16652588546276093, 0.16742637753486633, 0.16700047254562378, 0.16620709002017975, 0.1662595272064209]], [[0.16660046577453613, 0.16628871858119965, 0.16597755253314972, 0.16566696763038635, 0.17041869461536407, 0.1650475412607193], [0.16659559309482574, 0.16626375913619995, 0.16593261063098907, 0.16560210287570953, 0.17066290974617004, 0.16494306921958923], [0.1665906012058258, 0.1662387102842331, 0.16588756442070007, 0.16553714871406555, 0.17090736329555511, 0.16483855247497559], [0.16658557951450348, 0.16621360182762146, 0.1658424735069275, 0.16547217965126038, 0.17115211486816406, 0.16473405063152313], [0.16665367782115936, 0.1665850728750229, 0.1665164977312088, 0.1664479672908783, 0.16748584806919098, 0.16631096601486206], [0.16657525300979614, 0.16616317629814148, 0.165752112865448, 0.1653420627117157, 0.17164242267608643, 0.16452500224113464]], [[0.1666092425584793, 0.165935680270195, 0.1668335199356079, 0.16796796023845673, 0.16627085208892822, 0.16638271510601044], [0.1665443629026413, 0.1651459038257599, 0.16701136529445648, 0.1693839579820633, 0.1658410131931305, 0.16607338190078735], [0.16663013398647308, 0.16619811952114105, 0.16677385568618774, 0.16749970614910126, 0.16641317307949066, 0.16648492217063904], [0.16673064231872559, 0.16752171516418457, 0.1664687693119049, 0.1651557981967926, 0.16712720692157745, 0.16699589788913727], [0.1665770411491394, 0.1655391901731491, 0.16692310571670532, 0.16867750883102417, 0.1660553514957428, 0.16622774302959442], [0.16658778488636017, 0.16567033529281616, 0.16689355671405792, 0.1684425324201584, 0.16612669825553894, 0.16627909243106842]], [[0.1690870076417923, 0.16492348909378052, 0.1645158976316452, 0.16410930454730988, 0.17035648226737976, 0.16700784862041473], [0.17027752101421356, 0.16406071186065674, 0.16345618665218353, 0.1628539115190506, 0.1721881777048111, 0.16716347634792328], [0.17039568722248077, 0.16397489607334137, 0.16335096955299377, 0.162729412317276, 0.17237059772014618, 0.16717848181724548], [0.1705138236284256, 0.16388902068138123, 0.16324569284915924, 0.1626048982143402, 0.17255309224128723, 0.16719339787960052], [0.16872984170913696, 0.16518163681030273, 0.16483357548713684, 0.16448624432086945, 0.16980913281440735, 0.16695958375930786], [0.16967780888080597, 0.16449576616287231, 0.16399016976356506, 0.16348610818386078, 0.17126408219337463, 0.16708607971668243]]]}, "num_training_step_calls_per_iteration": 1, "evaluation": {"env_runners": {"env_to_module_connector": {"timers": {"connectors": {"add_states_from_episodes_to_batch": 2.716085612066066e-06, "numpy_to_tensor": 1.1857462579400684e-05, "add_time_dim_to_batch_and_zero_pad": 6.786603050417135e-06, "add_observations_from_episodes_to_batch": 2.771415494064879e-06, "batch_individual_items": 1.2146815668278024e-05}}, "connector_pipeline_timer": 5.8382141882811995e-05}, "module_to_env_connector": {"timers": {"connectors": {"tensor_to_numpy": 1.4807994132595657e-05, "remove_single_ts_time_rank_from_batch": 1.1894245014626047e-05, "un_batch_to_individual_items": 6.5322535690509284e-06, "normalize_and_clip_actions": 7.89829386885766e-06, "get_actions": 3.518676613542667e-05, "listify_data_for_vector_env": 1.0325793984763345e-05}}, "connector_pipeline_timer": 0.00011279175260153685}, "num_env_steps_sampled": 400, "num_agent_steps_sampled_lifetime": {"default_agent": 7600}, "env_step_timer": 1.380883039023837e-05, "episode_len_max": 20, "num_episodes_lifetime": 380, "sample": 0.11575782005432347, "weights_seq_no": 19.0, "env_to_module_sum_episodes_length_in": 10.368238394574323, "module_episode_returns_mean": {"default_policy": 1.15}, "num_env_steps_sampled_lifetime": 95400, "agent_episode_returns_mean": {"default_agent": 1.15}, "episode_duration_sec_mean": 0.005268888330319897, "episode_return_mean": 1.15, "episode_return_min": -14.5, "env_reset_timer": 0.000416409012833177, "episode_len_mean": 20.0, "episode_return_max": 14.5, "rlmodule_inference_timer": 3.0428745367342606e-05, "episode_len_min": 20, "num_episodes": 20, "env_to_module_sum_episodes_length_out": 10.368238394574323, "num_module_steps_sampled_lifetime": {"default_policy": 7600}, "num_module_steps_sampled": {"default_policy": 400}, "num_agent_steps_sampled": {"default_agent": 400}, "time_between_sampling": 9.740415352670045}, "num_healthy_workers": 1, "actor_manager_num_outstanding_async_reqs": 0, "num_remote_worker_restarts": 0}, "num_env_steps_sampled_lifetime": -10487500.0, "fault_tolerance": {"num_healthy_workers": 0, "num_remote_worker_restarts": 0}, "env_runner_group": {"actor_manager_num_outstanding_async_reqs": 0}, "done": false, "training_iteration": 19, "trial_id": "b5096_00000", "date": "2025-08-11_18-47-30", "timestamp": 1754930850, "time_this_iter_s": 9.460462093353271, "time_total_s": 187.54455757141113, "pid": 11702, "hostname": "Mac", "node_ip": "127.0.0.1", "config": {"exploration_config": {}, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 2, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "env": "Umbrella", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": false, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 0, "create_local_env_runner": true, "num_envs_per_env_runner": 1, "gym_env_vectorize_mode": "SYNC", "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "episodes_to_numpy": true, "max_requests_in_flight_per_env_runner": 1, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "merge_env_runner_states": "training_only", "broadcast_env_runner_states": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "complete_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "sampler_perf_stats_ema_coef": null, "_is_online": true, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": "auto", "num_aggregator_actors_per_learner": 0, "max_requests_in_flight_per_aggregator_actor": 3, "local_gpu_idx": 0, "max_requests_in_flight_per_learner": 3, "gamma": 1, "lr": 0.0002715581955, "grad_clip": 0.5, "grad_clip_by": "global_norm", "_train_batch_size_per_learner": 5000, "train_batch_size": 4000, "num_epochs": 1, "minibatch_size": 1000, "shuffle_batch_per_epoch": true, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "log_std_clip_param": 20.0, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "_disable_preprocessor_api": false, "_disable_action_flattening": false}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {"intrinsic_reward_coeff": 0.2795015916508}, "optimizer": {}, "_learner_class": "<class 'source.intrinsic_attention_ppo.learners.IntrinsicAttentionMetaLearner.IntrinsicAttentionMetaLearner'>", "callbacks_on_algorithm_init": null, "callbacks_on_env_runners_recreated": null, "callbacks_on_offline_eval_runners_recreated": null, "callbacks_on_checkpoint_loaded": null, "callbacks_on_environment_created": null, "callbacks_on_episode_created": null, "callbacks_on_episode_start": null, "callbacks_on_episode_step": null, "callbacks_on_episode_end": null, "callbacks_on_evaluate_start": null, "callbacks_on_evaluate_end": null, "callbacks_on_evaluate_offline_start": null, "callbacks_on_evaluate_offline_end": null, "callbacks_on_sample_end": null, "callbacks_on_train_result": null, "explore": true, "enable_rl_module_and_learner": true, "enable_env_runner_and_connector_v2": true, "_prior_exploration_config": {"type": "StochasticSampling"}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x3866e5760>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "offline_data_class": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_read_batch_size": null, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "materialize_data": false, "materialize_mapped_data": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "ignore_final_observation": false, "prelearner_class": null, "prelearner_buffer_class": null, "prelearner_buffer_kwargs": {}, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_remaining_data": false, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": 1, "evaluation_duration": 20, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_auto_duration_min_env_steps_per_sample": 100, "evaluation_auto_duration_max_env_steps_per_sample": 2000, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 1, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "offline_evaluation_interval": null, "num_offline_eval_runners": 0, "offline_loss_for_module_fn": null, "offline_evaluation_duration": 1, "offline_evaluation_parallel_to_training": false, "offline_evaluation_timeout_s": 120.0, "num_cpus_per_offline_eval_runner": 1, "num_gpus_per_offline_eval_runner": 0, "custom_resources_per_offline_eval_runner": {}, "restart_failed_offline_eval_runners": true, "ignore_offline_eval_runner_failures": false, "max_num_offline_eval_runner_restarts": 1000, "offline_eval_runner_restore_timeout_s": 1800.0, "max_requests_in_flight_per_offline_eval_runner": 1, "validate_offline_eval_runners_after_construction": true, "offline_eval_runner_health_probe_timeout_s": 30.0, "offline_eval_rl_module_inference_only": false, "broadcast_offline_eval_runner_states": false, "offline_eval_batch_size_per_runner": 256, "dataset_num_iters_per_eval_runner": 1, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "log_gradients": false, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 8, "restart_failed_env_runners": true, "ignore_env_runner_failures": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30.0, "env_runner_restore_timeout_s": 1800.0, "_model_config": {}, "_rl_module_spec": "MultiRLModuleSpec(multi_rl_module_class=<class 'ray.rllib.core.rl_module.multi_rl_module.MultiRLModule'>, observation_space=None, action_space=None, inference_only=False, model_config=None, rl_module_specs={'default_policy': RLModuleSpec(module_class=<class 'source.intrinsic_attention_ppo.rl_modules.DifferentiablePPOModule.DifferentiablePPOModule'>, observation_space=None, action_space=None, inference_only=False, learner_only=False, model_config={'vf_share_layers': True, 'embedding_dim': 62, 'max_seq_len': 6, 'policy_head_hidden_sizes': [32], 'value_head_hidden_sizes': [101], 'embedding_hidden_sizes': [121]}, catalog_class=None, load_state_path=None, model_config_dict=None), 'intrinsic_reward_module': RLModuleSpec(module_class=<class 'source.intrinsic_attention_ppo.rl_modules.IntrinsicAttentionModule.IntrinsicAttentionModule'>, observation_space=None, action_space=None, inference_only=False, learner_only=True, model_config={'intrinsic_reward_network': {'encoder_hidden_sizes': [], 'encoding_dim': 1, 'num_heads': 1, 'head_hidden_sizes': None, 'layers': [{'type': 'attention'}]}, 'extrinsic_value_hidden_layers': [127, 60], 'vf_share_layers': True, 'max_seq_len': 6}, catalog_class=None, load_state_path=None, model_config_dict=None)}, load_state_path=None, modules_to_load=None, module_specs={'default_policy': RLModuleSpec(module_class=<class 'source.intrinsic_attention_ppo.rl_modules.DifferentiablePPOModule.DifferentiablePPOModule'>, observation_space=None, action_space=None, inference_only=False, learner_only=False, model_config={'vf_share_layers': True, 'embedding_dim': 62, 'max_seq_len': 6, 'policy_head_hidden_sizes': [32], 'value_head_hidden_sizes': [101], 'embedding_hidden_sizes': [121]}, catalog_class=None, load_state_path=None, model_config_dict=None), 'intrinsic_reward_module': RLModuleSpec(module_class=<class 'source.intrinsic_attention_ppo.rl_modules.IntrinsicAttentionModule.IntrinsicAttentionModule'>, observation_space=None, action_space=None, inference_only=False, learner_only=True, model_config={'intrinsic_reward_network': {'encoder_hidden_sizes': [], 'encoding_dim': 1, 'num_heads': 1, 'head_hidden_sizes': None, 'layers': [{'type': 'attention'}]}, 'extrinsic_value_hidden_layers': [127, 60], 'vf_share_layers': True, 'max_seq_len': 6}, catalog_class=None, load_state_path=None, model_config_dict=None)})", "algorithm_config_overrides_per_module": {"intrinsic_reward_module": {"lr": 0.0002715581955}}, "_per_module_overrides": {}, "_validate_config": true, "_use_msgpack_checkpoints": false, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "env_task_fn": -1, "enable_connectors": -1, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.161583927863, "kl_target": 0.0201019014258, "vf_loss_coeff": 0.7790510010087, "entropy_coeff": 0.0015431216992, "clip_param": 0.2459212356676, "vf_clip_param": 0.3769744131561, "entropy_coeff_schedule": null, "lr_schedule": null, "sgd_minibatch_size": -1, "vf_share_layers": -1, "differentiable_learner_configs": ["DifferentiableLearnerConfig(learner_class=<class 'source.intrinsic_attention_ppo.learners.IntrinsicAttentionPPOLearner.IntrinsicAttentionPPOLearner'>, learner_connector=None, add_default_connectors_to_learner_pipeline=True, is_multi_agent=False, policies_to_update=['default_policy'], lr=0.0060984166342, num_total_minibatches=0, num_epochs=1, minibatch_size=1000, shuffle_batch_per_epoch=True)"], "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9485408017724, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.callbacks.callbacks.RLlibCallback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 187.54455757141113, "iterations_since_restore": 19, "perf": {"cpu_util_percent": 34.26923076923077, "ram_util_percent": 79.14615384615385}}
{"timers": {"training_iteration": 10.19587218776662, "restore_env_runners": 1.0882700041834381e-05, "training_step": 10.195704897683688, "env_runner_sampling_timer": 1.6543985331430995, "learner_update_timer": 8.347962625685716, "synch_weights": 0.001293804103944477, "restore_eval_env_runners": 2.9856191149753026e-05, "evaluation_iteration": 0.12449640414108637, "synch_eval_env_connectors": 0.00015255408826129986, "synch_env_connectors": 4.344384807914303e-06}, "env_runners": {"episode_duration_sec_mean": 0.005311191656161099, "env_to_module_connector": {"timers": {"connectors": {"numpy_to_tensor": 1.2775735452862866e-05, "add_observations_from_episodes_to_batch": 2.8202618981099635e-06, "batch_individual_items": 1.26225182711336e-05, "add_time_dim_to_batch_and_zero_pad": 7.0810179633142235e-06, "add_states_from_episodes_to_batch": 2.7234535616977305e-06}}, "connector_pipeline_timer": 6.024964043030378e-05}, "num_env_steps_sampled": 5000.0, "episode_return_min": -11.5, "module_to_env_connector": {"timers": {"connectors": {"normalize_and_clip_actions": 8.121045887036708e-06, "un_batch_to_individual_items": 6.547915870483279e-06, "get_actions": 3.966856416710577e-05, "remove_single_ts_time_rank_from_batch": 1.1983085151480495e-05, "listify_data_for_vector_env": 1.0603089588809788e-05, "tensor_to_numpy": 1.527475330644291e-05}}, "connector_pipeline_timer": 0.00011882784383432981}, "env_reset_timer": 3.8418123952760135e-05, "sample": 0.005646007812997878, "num_episodes_lifetime": -555250.0, "env_to_module_sum_episodes_length_out": 10.36823839457432, "env_step_timer": 1.4006704036925246e-05, "num_module_steps_sampled_lifetime": {"default_policy": -11105000.0}, "weights_seq_no": 19.0, "module_episode_returns_mean": {"default_policy": 1.0600000000000005}, "env_to_module_sum_episodes_length_in": 10.36823839457432, "episode_len_mean": 20.0, "agent_episode_returns_mean": {"default_agent": 1.0600000000000005}, "time_between_sampling": 0.03244822205667208, "num_module_steps_sampled": {"default_policy": 5000.0}, "episode_return_max": 8.5, "episode_len_min": 20, "episode_len_max": 20, "rlmodule_inference_timer": 3.1658958202674216e-05, "num_agent_steps_sampled": {"default_agent": 5000.0}, "num_episodes": 250.0, "num_env_steps_sampled_lifetime": -11105000.0, "num_agent_steps_sampled_lifetime": {"default_agent": -11105000.0}, "episode_return_mean": 1.0600000000000005, "num_env_steps_sampled_lifetime_throughput": 3242.710266186922}, "__all_modules__": {"learner_connector_sum_episodes_length_in": 5000.0, "learner_connector": {"connector_pipeline_timer": 0.15393037663219455, "timers": {"connectors": {"add_one_ts_to_episodes_and_truncate": 0.008807996194639236, "add_observations_from_episodes_to_batch": 0.0008136377788455124, "add_columns_from_episodes_to_train_batch": 0.04115876528032617, "add_time_dim_to_batch_and_zero_pad": 0.0900475785368089, "add_states_from_episodes_to_batch": 0.003635360056886275, "batch_individual_items": 0.009240568318351414, "numpy_to_tensor": 7.885242797958048e-05}}}, "learner_connector_sum_episodes_length_out": 5250.0}, "learners": {"default_policy": {"num_module_steps_trained_lifetime": 119700, "weights_seq_no": 20.0, "entropy": 0.6788454055786133, "num_module_steps_trained": 5985, "vf_loss": 0.32051119208335876, "mean_kl_loss": 3.56543532689102e-05, "num_trainable_parameters": 16595, "curr_entropy_coeff": 0.0015431216992, "module_train_batch_size_mean": 997.9437895346426, "vf_explained_var": -7.271766662597656e-05, "total_loss": 0.24811385571956635, "vf_loss_unclipped": 42.02406311035156, "policy_loss": -0.0005331839201971889, "use_intrinsic_rewards": 0.0, "diff_num_grad_updates_vs_sampler_policy": 1.0, "curr_kl_coeff": 1.5409844422720198e-07, "num_module_steps_trained_lifetime_throughput": 674.8501001050805}, "intrinsic_reward_module": {"total_loss": 0.0, "gradients_default_optimizer_global_norm": 0.0, "num_module_steps_trained_lifetime": 119700, "num_module_steps_trained": 5985, "weights_seq_no": 20.0, "num_trainable_parameters": 8266, "curr_entropy_coeff": 0.0015431216992, "module_train_batch_size_mean": 997.9437895346426, "default_optimizer_learning_rate": 0.0002715581955, "diff_num_grad_updates_vs_sampler_policy": 1.0, "num_module_steps_trained_lifetime_throughput": 674.8531016155936}, "differentiable_learners": {"intrinsic_attention_ppo_learner": {"default_policy": {"num_module_steps_trained": 35910, "weights_seq_no": 120.0, "entropy": 0.6789087057113647, "vf_loss": 0.3205447793006897, "mean_kl_loss": 3.253508475609124e-05, "module_train_batch_size_mean": 997.4935477577241, "vf_explained_var": 0.0006012916564941406, "diff_num_grad_updates_vs_sampler_policy": 101.0, "total_loss": 0.24816890060901642, "vf_loss_unclipped": 42.00508117675781, "policy_loss": -0.0005094874068163335, "use_intrinsic_rewards": 1.0, "num_module_steps_trained_lifetime": 718200}, "intrinsic_reward_module": {"module_train_batch_size_mean": 997.4935477577241, "diff_num_grad_updates_vs_sampler_policy": 101.0, "total_loss": 0.0, "num_module_steps_trained_lifetime": 718200, "num_module_steps_trained": 35910, "weights_seq_no": 120.0}, "__all_modules__": {"num_module_steps_trained_lifetime": 1436400, "num_module_steps_trained": 71820, "num_env_steps_trained": 216000, "num_env_steps_trained_lifetime": 4320000, "num_env_steps_trained_lifetime_throughput": 47318.09561173156}}}, "__all_modules__": {"num_module_steps_trained_lifetime": 239400, "num_module_steps_trained": 11970, "num_trainable_parameters": 24861, "num_env_steps_trained": 36000, "num_env_steps_trained_lifetime": 720000, "num_non_trainable_parameters": 0, "num_env_steps_trained_lifetime_throughput": 4061.8144877608343, "num_module_steps_trained_throughput": 19094892.308737684, "num_module_steps_trained_lifetime_throughput": 11909710.950552303}, "IntrinsicAttentionMask": [[[0.16688740253448486, 0.16760414838790894, 0.16639472544193268, 0.16568613052368164, 0.16674908995628357, 0.16667847335338593], [0.1662459671497345, 0.16490814089775085, 0.16717520356178284, 0.16852566599845886, 0.16650602221488953, 0.1666390299797058], [0.16732175648212433, 0.16947996616363525, 0.16584892570972443, 0.16374580562114716, 0.1669074296951294, 0.16669616103172302], [0.16793684661388397, 0.1722104698419571, 0.16505062580108643, 0.1609717458486557, 0.16712245345115662, 0.16670788824558258], [0.1670098602771759, 0.1681288480758667, 0.16624227166175842, 0.16514049470424652, 0.16679427027702332, 0.16668422520160675], [0.16707223653793335, 0.16839730739593506, 0.16616420447826385, 0.16486220061779022, 0.1668170988559723, 0.16668690741062164]], [[0.16762275993824005, 0.1663159430027008, 0.16618679463863373, 0.1660577654838562, 0.16801682114601135, 0.16579996049404144], [0.16912300884723663, 0.16575954854488373, 0.16542939841747284, 0.1650998890399933, 0.17014533281326294, 0.16444285213947296], [0.1692720651626587, 0.16570386290550232, 0.16535384953022003, 0.16500456631183624, 0.17035748064517975, 0.16430820524692535], [0.16942115128040314, 0.16564808785915375, 0.16527822613716125, 0.16490918397903442, 0.1705697774887085, 0.16417357325553894], [0.16717325150966644, 0.16648121178150177, 0.16641268134117126, 0.16634418070316315, 0.1673814207315445, 0.16620726883411407], [0.1697194129228592, 0.1655363142490387, 0.16512680053710938, 0.16471830010414124, 0.17099487781524658, 0.1639043390750885]], [[0.1669941395521164, 0.16706790030002594, 0.16586235165596008, 0.16579210758209229, 0.167498379945755, 0.1667850911617279], [0.16689695417881012, 0.16694875061511993, 0.1661013513803482, 0.16605190932750702, 0.16725090146064758, 0.16675011813640594], [0.16847097873687744, 0.16888654232025146, 0.16219952702522278, 0.16181673109531403, 0.17132841050624847, 0.1672978550195694], [0.16856172680854797, 0.16899879276752472, 0.16197247803211212, 0.1615706980228424, 0.1715681403875351, 0.16732819378376007], [0.1663275957107544, 0.16625197231769562, 0.16749653220176697, 0.1675696074962616, 0.16581198573112488, 0.16654230654239655], [0.16726893186569214, 0.1674051582813263, 0.16518521308898926, 0.1650562882423401, 0.16820113360881805, 0.16688315570354462]], [[0.16703404486179352, 0.16690434515476227, 0.1656031310558319, 0.16664522886276245, 0.1674267202615738, 0.16638652980327606], [0.16709105670452118, 0.16694113612174988, 0.1654381901025772, 0.1666417121887207, 0.16754502058029175, 0.1663428246974945], [0.16766394674777985, 0.16730977594852448, 0.16378293931484222, 0.1666036993265152, 0.16873903572559357, 0.1659006029367447], [0.16720500588417053, 0.16701464354991913, 0.16510866582393646, 0.16663455963134766, 0.1677817553281784, 0.16625533998012543], [0.16686153411865234, 0.1667928397655487, 0.16610237956047058, 0.1666555553674698, 0.16706931591033936, 0.16651839017868042], [0.16731885075569153, 0.16708797216415405, 0.16477961838245392, 0.1666271984577179, 0.1680186241865158, 0.1661677062511444]], [[0.16656720638275146, 0.1672825813293457, 0.1660754680633545, 0.16600514948368073, 0.1670701503753662, 0.16699939966201782], [0.16685037314891815, 0.16550768911838531, 0.1677829921245575, 0.16791702806949615, 0.1659046709537506, 0.1660372018814087], [0.1663651019334793, 0.16851097345352173, 0.16490070521831512, 0.1646919697523117, 0.1678718477487564, 0.16765934228897095], [0.16633570194244385, 0.16868722438812256, 0.16473262012004852, 0.16450423002243042, 0.16798655688762665, 0.16775363683700562], [0.16676762700080872, 0.16603322327136993, 0.16727614402770996, 0.16734912991523743, 0.16625063121318817, 0.16632317006587982], [0.166739821434021, 0.16620855033397675, 0.16710731387138367, 0.1671600341796875, 0.16636589169502258, 0.16641837358474731]], [[0.16563233733177185, 0.1650419682264328, 0.16445370018482208, 0.1638675332069397, 0.17294420301914215, 0.16806022822856903], [0.16559645533561707, 0.16498629748821259, 0.16437837481498718, 0.16377270221710205, 0.17315959930419922, 0.1681065708398819], [0.1655605435371399, 0.1649305820465088, 0.1643030196428299, 0.1636778563261032, 0.173375204205513, 0.16815285384655], [0.16552454233169556, 0.16487480700016022, 0.16422761976718903, 0.16358298063278198, 0.1735909879207611, 0.1681990623474121], [0.16606174409389496, 0.16571182012557983, 0.1653626263141632, 0.16501419246196747, 0.17035415768623352, 0.1674954742193222], [0.16577792167663574, 0.16526837646961212, 0.16476038098335266, 0.16425396502017975, 0.17206844687461853, 0.16787084937095642]]]}, "num_training_step_calls_per_iteration": 1, "evaluation": {"env_runners": {"env_to_module_connector": {"timers": {"connectors": {"add_states_from_episodes_to_batch": 2.692539846564019e-06, "numpy_to_tensor": 1.1915981439882274e-05, "add_time_dim_to_batch_and_zero_pad": 6.713997828904299e-06, "add_observations_from_episodes_to_batch": 2.743802414208119e-06, "batch_individual_items": 1.216298173647496e-05}}, "connector_pipeline_timer": 5.8302931404024353e-05}, "module_to_env_connector": {"timers": {"connectors": {"tensor_to_numpy": 1.4951189477696328e-05, "remove_single_ts_time_rank_from_batch": 1.2053088489174733e-05, "un_batch_to_individual_items": 6.5377134501173975e-06, "normalize_and_clip_actions": 8.05135230824459e-06, "get_actions": 3.563488606578219e-05, "listify_data_for_vector_env": 1.0307240668314987e-05}}, "connector_pipeline_timer": 0.0001140691106352654}, "num_env_steps_sampled": 400, "num_agent_steps_sampled_lifetime": {"default_agent": 8000}, "env_step_timer": 1.3803030930455676e-05, "episode_len_max": 20, "num_episodes_lifetime": 400, "sample": 0.11572106643479237, "weights_seq_no": 20.0, "env_to_module_sum_episodes_length_in": 10.368238394574323, "module_episode_returns_mean": {"default_policy": 1.15}, "num_env_steps_sampled_lifetime": 100400, "agent_episode_returns_mean": {"default_agent": 1.15}, "episode_duration_sec_mean": 0.005266778717050329, "episode_return_mean": 1.15, "episode_return_min": -14.5, "env_reset_timer": 0.00041305451210573265, "episode_len_mean": 20.0, "episode_return_max": 14.5, "rlmodule_inference_timer": 3.024923869668276e-05, "episode_len_min": 20, "num_episodes": 20, "env_to_module_sum_episodes_length_out": 10.368238394574323, "num_module_steps_sampled_lifetime": {"default_policy": 8000}, "num_module_steps_sampled": {"default_policy": 400}, "num_agent_steps_sampled": {"default_agent": 400}, "time_between_sampling": 9.737254885814016}, "num_healthy_workers": 1, "actor_manager_num_outstanding_async_reqs": 0, "num_remote_worker_restarts": 0}, "num_env_steps_sampled_lifetime": -11105000.0, "fault_tolerance": {"num_healthy_workers": 0, "num_remote_worker_restarts": 0}, "env_runner_group": {"actor_manager_num_outstanding_async_reqs": 0}, "done": true, "training_iteration": 20, "trial_id": "b5096_00000", "date": "2025-08-11_18-47-40", "timestamp": 1754930860, "time_this_iter_s": 9.522014856338501, "time_total_s": 197.06657242774963, "pid": 11702, "hostname": "Mac", "node_ip": "127.0.0.1", "config": {"exploration_config": {}, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 2, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "env": "Umbrella", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": false, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 0, "create_local_env_runner": true, "num_envs_per_env_runner": 1, "gym_env_vectorize_mode": "SYNC", "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "episodes_to_numpy": true, "max_requests_in_flight_per_env_runner": 1, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "merge_env_runner_states": "training_only", "broadcast_env_runner_states": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "complete_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "sampler_perf_stats_ema_coef": null, "_is_online": true, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": "auto", "num_aggregator_actors_per_learner": 0, "max_requests_in_flight_per_aggregator_actor": 3, "local_gpu_idx": 0, "max_requests_in_flight_per_learner": 3, "gamma": 1, "lr": 0.0002715581955, "grad_clip": 0.5, "grad_clip_by": "global_norm", "_train_batch_size_per_learner": 5000, "train_batch_size": 4000, "num_epochs": 1, "minibatch_size": 1000, "shuffle_batch_per_epoch": true, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "log_std_clip_param": 20.0, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "_disable_preprocessor_api": false, "_disable_action_flattening": false}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {"intrinsic_reward_coeff": 0.2795015916508}, "optimizer": {}, "_learner_class": "<class 'source.intrinsic_attention_ppo.learners.IntrinsicAttentionMetaLearner.IntrinsicAttentionMetaLearner'>", "callbacks_on_algorithm_init": null, "callbacks_on_env_runners_recreated": null, "callbacks_on_offline_eval_runners_recreated": null, "callbacks_on_checkpoint_loaded": null, "callbacks_on_environment_created": null, "callbacks_on_episode_created": null, "callbacks_on_episode_start": null, "callbacks_on_episode_step": null, "callbacks_on_episode_end": null, "callbacks_on_evaluate_start": null, "callbacks_on_evaluate_end": null, "callbacks_on_evaluate_offline_start": null, "callbacks_on_evaluate_offline_end": null, "callbacks_on_sample_end": null, "callbacks_on_train_result": null, "explore": true, "enable_rl_module_and_learner": true, "enable_env_runner_and_connector_v2": true, "_prior_exploration_config": {"type": "StochasticSampling"}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x3866e5760>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "offline_data_class": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_read_batch_size": null, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "materialize_data": false, "materialize_mapped_data": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "ignore_final_observation": false, "prelearner_class": null, "prelearner_buffer_class": null, "prelearner_buffer_kwargs": {}, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_remaining_data": false, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": 1, "evaluation_duration": 20, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_auto_duration_min_env_steps_per_sample": 100, "evaluation_auto_duration_max_env_steps_per_sample": 2000, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 1, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "offline_evaluation_interval": null, "num_offline_eval_runners": 0, "offline_loss_for_module_fn": null, "offline_evaluation_duration": 1, "offline_evaluation_parallel_to_training": false, "offline_evaluation_timeout_s": 120.0, "num_cpus_per_offline_eval_runner": 1, "num_gpus_per_offline_eval_runner": 0, "custom_resources_per_offline_eval_runner": {}, "restart_failed_offline_eval_runners": true, "ignore_offline_eval_runner_failures": false, "max_num_offline_eval_runner_restarts": 1000, "offline_eval_runner_restore_timeout_s": 1800.0, "max_requests_in_flight_per_offline_eval_runner": 1, "validate_offline_eval_runners_after_construction": true, "offline_eval_runner_health_probe_timeout_s": 30.0, "offline_eval_rl_module_inference_only": false, "broadcast_offline_eval_runner_states": false, "offline_eval_batch_size_per_runner": 256, "dataset_num_iters_per_eval_runner": 1, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "log_gradients": false, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 8, "restart_failed_env_runners": true, "ignore_env_runner_failures": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30.0, "env_runner_restore_timeout_s": 1800.0, "_model_config": {}, "_rl_module_spec": "MultiRLModuleSpec(multi_rl_module_class=<class 'ray.rllib.core.rl_module.multi_rl_module.MultiRLModule'>, observation_space=None, action_space=None, inference_only=False, model_config=None, rl_module_specs={'default_policy': RLModuleSpec(module_class=<class 'source.intrinsic_attention_ppo.rl_modules.DifferentiablePPOModule.DifferentiablePPOModule'>, observation_space=None, action_space=None, inference_only=False, learner_only=False, model_config={'vf_share_layers': True, 'embedding_dim': 62, 'max_seq_len': 6, 'policy_head_hidden_sizes': [32], 'value_head_hidden_sizes': [101], 'embedding_hidden_sizes': [121]}, catalog_class=None, load_state_path=None, model_config_dict=None), 'intrinsic_reward_module': RLModuleSpec(module_class=<class 'source.intrinsic_attention_ppo.rl_modules.IntrinsicAttentionModule.IntrinsicAttentionModule'>, observation_space=None, action_space=None, inference_only=False, learner_only=True, model_config={'intrinsic_reward_network': {'encoder_hidden_sizes': [], 'encoding_dim': 1, 'num_heads': 1, 'head_hidden_sizes': None, 'layers': [{'type': 'attention'}]}, 'extrinsic_value_hidden_layers': [127, 60], 'vf_share_layers': True, 'max_seq_len': 6}, catalog_class=None, load_state_path=None, model_config_dict=None)}, load_state_path=None, modules_to_load=None, module_specs={'default_policy': RLModuleSpec(module_class=<class 'source.intrinsic_attention_ppo.rl_modules.DifferentiablePPOModule.DifferentiablePPOModule'>, observation_space=None, action_space=None, inference_only=False, learner_only=False, model_config={'vf_share_layers': True, 'embedding_dim': 62, 'max_seq_len': 6, 'policy_head_hidden_sizes': [32], 'value_head_hidden_sizes': [101], 'embedding_hidden_sizes': [121]}, catalog_class=None, load_state_path=None, model_config_dict=None), 'intrinsic_reward_module': RLModuleSpec(module_class=<class 'source.intrinsic_attention_ppo.rl_modules.IntrinsicAttentionModule.IntrinsicAttentionModule'>, observation_space=None, action_space=None, inference_only=False, learner_only=True, model_config={'intrinsic_reward_network': {'encoder_hidden_sizes': [], 'encoding_dim': 1, 'num_heads': 1, 'head_hidden_sizes': None, 'layers': [{'type': 'attention'}]}, 'extrinsic_value_hidden_layers': [127, 60], 'vf_share_layers': True, 'max_seq_len': 6}, catalog_class=None, load_state_path=None, model_config_dict=None)})", "algorithm_config_overrides_per_module": {"intrinsic_reward_module": {"lr": 0.0002715581955}}, "_per_module_overrides": {}, "_validate_config": true, "_use_msgpack_checkpoints": false, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "env_task_fn": -1, "enable_connectors": -1, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.161583927863, "kl_target": 0.0201019014258, "vf_loss_coeff": 0.7790510010087, "entropy_coeff": 0.0015431216992, "clip_param": 0.2459212356676, "vf_clip_param": 0.3769744131561, "entropy_coeff_schedule": null, "lr_schedule": null, "sgd_minibatch_size": -1, "vf_share_layers": -1, "differentiable_learner_configs": ["DifferentiableLearnerConfig(learner_class=<class 'source.intrinsic_attention_ppo.learners.IntrinsicAttentionPPOLearner.IntrinsicAttentionPPOLearner'>, learner_connector=None, add_default_connectors_to_learner_pipeline=True, is_multi_agent=False, policies_to_update=['default_policy'], lr=0.0060984166342, num_total_minibatches=0, num_epochs=1, minibatch_size=1000, shuffle_batch_per_epoch=True)"], "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9485408017724, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.callbacks.callbacks.RLlibCallback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 197.06657242774963, "iterations_since_restore": 20, "perf": {"cpu_util_percent": 34.50000000000001, "ram_util_percent": 78.95714285714284}}
