{"timers": {"training_iteration": 10.557583500049077, "restore_env_runners": 9.95793379843235e-06, "training_step": 10.55733229208272, "env_runner_sampling_timer": 1.7197175830369815, "learner_update_timer": 8.643911625025794, "synch_weights": 0.001858375035226345}, "env_runners": {"episode_return_max": 10.5, "module_to_env_connector": {"timers": {"connectors": {"tensor_to_numpy": 1.636403928981827e-05, "normalize_and_clip_actions": 1.0790310633596377e-05, "un_batch_to_individual_items": 7.069599836419786e-06, "listify_data_for_vector_env": 1.1229420379562514e-05, "get_actions": 4.9732759887461756e-05, "remove_single_ts_time_rank_from_batch": 1.269017915967196e-05}}, "connector_pipeline_timer": 0.00013645315457263153}, "episode_len_mean": 20.0, "episode_len_max": 20, "num_module_steps_sampled_lifetime": {"default_policy": 627500.0}, "num_env_steps_sampled_lifetime": 627500.0, "module_episode_returns_mean": {"default_policy": 2.899999999999998}, "env_to_module_sum_episodes_length_out": 10.191744832559449, "episode_return_mean": 2.899999999999998, "env_to_module_connector": {"timers": {"connectors": {"add_time_dim_to_batch_and_zero_pad": 7.717115471811023e-06, "add_observations_from_episodes_to_batch": 3.095413237561336e-06, "add_states_from_episodes_to_batch": 2.92831614080672e-06, "numpy_to_tensor": 1.4058675672362837e-05, "batch_individual_items": 1.3345152924996419e-05}}, "connector_pipeline_timer": 6.616409671400134e-05}, "agent_episode_returns_mean": {"default_agent": 2.899999999999998}, "env_step_timer": 1.5934165333093164e-05, "sample": 0.006995491243003509, "num_episodes": 250.0, "num_agent_steps_sampled_lifetime": {"default_agent": 627500.0}, "num_episodes_lifetime": 31375.0, "env_to_module_sum_episodes_length_in": 10.191744832559449, "num_agent_steps_sampled": {"default_agent": 5000.0}, "num_env_steps_sampled": 5000.0, "num_module_steps_sampled": {"default_policy": 5000.0}, "episode_return_min": -9.5, "episode_duration_sec_mean": 0.005949608188122512, "weights_seq_no": 0.0, "time_between_sampling": 0.0005359246897168237, "env_reset_timer": 0.00010734888569912577, "episode_len_min": 20, "rlmodule_inference_timer": 6.178405017012893e-05, "num_env_steps_sampled_lifetime_throughput": 2882.372172664911}, "__all_modules__": {"learner_connector_sum_episodes_length_in": 5000, "learner_connector": {"connector_pipeline_timer": 0.15493429207708687, "timers": {"connectors": {"add_one_ts_to_episodes_and_truncate": 0.009008125052787364, "add_observations_from_episodes_to_batch": 0.000834665959700942, "add_columns_from_episodes_to_train_batch": 0.04136416700202972, "add_time_dim_to_batch_and_zero_pad": 0.09213125007227063, "add_states_from_episodes_to_batch": 0.003746333997696638, "batch_individual_items": 0.007623499957844615, "numpy_to_tensor": 7.083301898092031e-05}}}, "learner_connector_sum_episodes_length_out": 5250}, "learners": {"__all_modules__": {"num_non_trainable_parameters": 0, "num_trainable_parameters": 24861, "num_module_steps_trained_lifetime": 11970, "num_env_steps_trained": 36000, "num_module_steps_trained": 11970, "num_env_steps_trained_lifetime": 36000, "num_env_steps_trained_lifetime_throughput": 4741.999303317402, "num_module_steps_trained_throughput": 30815759.632599548, "num_module_steps_trained_lifetime_throughput": 15640396.714219347}, "default_policy": {"vf_explained_var": 0.0028798580169677734, "vf_loss_unclipped": 42.54353713989258, "use_intrinsic_rewards": 0.0, "weights_seq_no": 1.0, "total_loss": 0.24872010946273804, "num_trainable_parameters": 16595, "curr_entropy_coeff": 0.0015431216992, "num_module_steps_trained_lifetime": 5985, "vf_loss": 0.3205713629722595, "diff_num_grad_updates_vs_sampler_policy": 1.0, "curr_kl_coeff": 0.08079196512699127, "num_module_steps_trained": 5985, "mean_kl_loss": 9.126686563831754e-06, "module_train_batch_size_mean": 998.9117791197002, "policy_loss": 3.190156348864548e-05, "entropy": 0.6834850907325745, "num_module_steps_trained_lifetime_throughput": 787.3576324296073}, "intrinsic_reward_module": {"num_module_steps_trained": 5985, "diff_num_grad_updates_vs_sampler_policy": 1.0, "gradients_default_optimizer_global_norm": 0.0, "weights_seq_no": 1.0, "module_train_batch_size_mean": 998.9117791197002, "num_trainable_parameters": 8266, "default_optimizer_learning_rate": 0.0002715581955, "curr_entropy_coeff": 0.0015431216992, "num_module_steps_trained_lifetime": 5985, "total_loss": 0.0, "num_module_steps_trained_lifetime_throughput": 787.3722929751284}, "differentiable_learners": {"intrinsic_attention_ppo_learner": {"default_policy": {"vf_loss_unclipped": 42.593406677246094, "num_module_steps_trained_lifetime": 35910, "total_loss": 0.24887947738170624, "vf_loss": 0.3207722306251526, "mean_kl_loss": 9.532222065899987e-06, "diff_num_grad_updates_vs_sampler_policy": 6.0, "policy_loss": 3.4677832445595413e-05, "num_module_steps_trained": 35910, "vf_explained_var": 0.003141462802886963, "use_intrinsic_rewards": 1.0, "weights_seq_no": 6.0, "module_train_batch_size_mean": 998.5423314844973, "entropy": 0.6834717988967896}, "__all_modules__": {"num_module_steps_trained_lifetime": 71820, "num_env_steps_trained_lifetime": 216000, "num_env_steps_trained": 216000, "num_module_steps_trained": 71820, "num_env_steps_trained_lifetime_throughput": 62097.820944859115}, "intrinsic_reward_module": {"num_module_steps_trained": 35910, "weights_seq_no": 6.0, "module_train_batch_size_mean": 998.5423314844973, "total_loss": 0.0, "num_module_steps_trained_lifetime": 35910, "diff_num_grad_updates_vs_sampler_policy": 6.0}}}, "IntrinsicAttentionMask": [[[0.16742384433746338, 0.16611531376838684, 0.16692620515823364, 0.16665565967559814, 0.16657449305057526, 0.16630452871322632], [0.16814476251602173, 0.16559256613254547, 0.167171910405159, 0.16664420068264008, 0.1664860099554062, 0.16596046090126038], [0.16769711673259735, 0.16591691970825195, 0.16701951622962952, 0.16665144264698029, 0.16654103994369507, 0.166174054145813], [0.16784611344337463, 0.16580884158611298, 0.16707028448581696, 0.16664907336235046, 0.16652274131774902, 0.16610290110111237], [0.16789090633392334, 0.16577641665935516, 0.16708554327487946, 0.16664835810661316, 0.1665172576904297, 0.16608154773712158], [0.16804003715515137, 0.16566838324069977, 0.1671362966299057, 0.16664592921733856, 0.16649891436100006, 0.16601040959358215]], [[0.16632211208343506, 0.1665576994419098, 0.1670474112033844, 0.16651248931884766, 0.16674835979938507, 0.1668119579553604], [0.1663549393415451, 0.1665680855512619, 0.1670110523700714, 0.16652719676494598, 0.1667405664920807, 0.16679809987545013], [0.16642311215400696, 0.1665896773338318, 0.16693569719791412, 0.16655771434307098, 0.16672442853450775, 0.1667693704366684], [0.1663486659526825, 0.16656611859798431, 0.16701804101467133, 0.16652439534664154, 0.16674207150936127, 0.16680076718330383], [0.16638149321079254, 0.16657650470733643, 0.16698168218135834, 0.16653908789157867, 0.16673427820205688, 0.16678689420223236], [0.1663903445005417, 0.16657930612564087, 0.16697189211845398, 0.16654305160045624, 0.16673217713832855, 0.1667831689119339]], [[0.1663258969783783, 0.16655871272087097, 0.16704264283180237, 0.16609421372413635, 0.16716858744621277, 0.16680997610092163], [0.16635878384113312, 0.16656915843486786, 0.16700634360313416, 0.16614942252635956, 0.167120099067688, 0.16679616272449493], [0.16642703115940094, 0.1665908247232437, 0.16693107783794403, 0.16626398265361786, 0.1670195758342743, 0.16676752269268036], [0.16629309952259064, 0.16654828190803528, 0.16707880795001984, 0.16603921353816986, 0.16721689701080322, 0.16682371497154236], [0.16644476354122162, 0.166596457362175, 0.1669115275144577, 0.16629375517368317, 0.16699346899986267, 0.16676007211208344], [0.16639424860477448, 0.1665804237127304, 0.1669672280550003, 0.16620893776416779, 0.16706787049770355, 0.16678129136562347]], [[0.16642151772975922, 0.1666572391986847, 0.16714724898338318, 0.16661201417446136, 0.1662503182888031, 0.16691164672374725], [0.16644489765167236, 0.1666581630706787, 0.16710136830806732, 0.1666172444820404, 0.1662900149822235, 0.1668882966041565], [0.16649341583251953, 0.16666005551815033, 0.1670062243938446, 0.16662809252738953, 0.1663723587989807, 0.1668398231267929], [0.16644041240215302, 0.16665798425674438, 0.1671101599931717, 0.16661623120307922, 0.16628240048885345, 0.16689276695251465], [0.16640450060367584, 0.16665656864643097, 0.1671806126832962, 0.16660819947719574, 0.1662214696407318, 0.16692864894866943], [0.16647012531757355, 0.1666591614484787, 0.16705194115638733, 0.16662289202213287, 0.16633281111717224, 0.16686312854290009]], [[0.1674237847328186, 0.16611525416374207, 0.16692614555358887, 0.16620983183383942, 0.16657443344593048, 0.16675050556659698], [0.1681446135044098, 0.16559241712093353, 0.16717176139354706, 0.16577626764774323, 0.16648586094379425, 0.16682906448841095], [0.1676970273256302, 0.1659168303012848, 0.16701942682266235, 0.16604535281658173, 0.1665409505367279, 0.16678044199943542], [0.1680922508239746, 0.16563032567501068, 0.1671539694070816, 0.16580772399902344, 0.16649232804775238, 0.1668233871459961], [0.1678907871246338, 0.1657762974500656, 0.1670854240655899, 0.16592879593372345, 0.16651713848114014, 0.1668015420436859], [0.16779372096061707, 0.16584667563438416, 0.16705237329006195, 0.16598716378211975, 0.1665290743112564, 0.16679097712039948]], [[0.16632193326950073, 0.16655752062797546, 0.16704723238945007, 0.16711094975471497, 0.16674818098545074, 0.1662142127752304], [0.16635480523109436, 0.16656796634197235, 0.16701091825962067, 0.16706854104995728, 0.16674041748046875, 0.1662573516368866], [0.1664230227470398, 0.16658958792686462, 0.16693560779094696, 0.16698060929775238, 0.1667243391275406, 0.16634684801101685], [0.16643187403678894, 0.16659238934516907, 0.1669258177280426, 0.1669691801071167, 0.16672223806381226, 0.16635845601558685], [0.16638138890266418, 0.16657638549804688, 0.16698157787322998, 0.16703426837921143, 0.16673415899276733, 0.1662922203540802], [0.16630686819553375, 0.16655273735523224, 0.1670638471841812, 0.16713035106658936, 0.1667517125606537, 0.16619446873664856]]]}, "num_training_step_calls_per_iteration": 1, "num_env_steps_sampled_lifetime": 627500.0, "evaluation": {"env_runners": {"agent_episode_returns_mean": {"default_agent": -0.35}, "num_agent_steps_sampled": {"default_agent": 400}, "num_agent_steps_sampled_lifetime": {"default_agent": 400}, "episode_return_min": -13.5, "module_to_env_connector": {"timers": {"connectors": {"remove_single_ts_time_rank_from_batch": 1.3489748789779953e-05, "tensor_to_numpy": 1.897276251018372e-05, "normalize_and_clip_actions": 1.0975268717719033e-05, "listify_data_for_vector_env": 1.0953025329713204e-05, "get_actions": 5.08784551555995e-05, "un_batch_to_individual_items": 7.191465478996166e-06}}, "connector_pipeline_timer": 0.00014002005577470173}, "rlmodule_inference_timer": 3.973620247132495e-05, "env_step_timer": 1.886597716739185e-05, "num_episodes_lifetime": 20, "env_to_module_sum_episodes_length_in": 10.216013141322508, "num_env_steps_sampled": 400, "env_to_module_connector": {"timers": {"connectors": {"add_observations_from_episodes_to_batch": 3.87062875086551e-06, "add_time_dim_to_batch_and_zero_pad": 8.407128361106354e-06, "batch_individual_items": 1.3772953182218139e-05, "numpy_to_tensor": 1.4124854800069763e-05, "add_states_from_episodes_to_batch": 3.860854643400014e-06}}, "connector_pipeline_timer": 7.063085999158125e-05}, "num_module_steps_sampled": {"default_policy": 400}, "env_reset_timer": 0.0006752090994268656, "num_module_steps_sampled_lifetime": {"default_policy": 400}, "env_to_module_sum_episodes_length_out": 10.216013141322508, "module_episode_returns_mean": {"default_policy": -0.35}, "episode_return_mean": -0.35, "num_episodes": 20, "episode_len_mean": 20.0, "episode_return_max": 14.5, "num_env_steps_sampled_lifetime": 5400, "sample": 0.13026070804335177, "episode_duration_sec_mean": 0.0059060312050860375, "weights_seq_no": 1.0, "episode_len_min": 20, "episode_len_max": 20}, "num_healthy_workers": 1, "actor_manager_num_outstanding_async_reqs": 0, "num_remote_worker_restarts": 0}, "fault_tolerance": {"num_healthy_workers": 0, "num_remote_worker_restarts": 0}, "env_runner_group": {"actor_manager_num_outstanding_async_reqs": 0}, "done": false, "training_iteration": 1, "trial_id": "b1df4_00000", "date": "2025-08-11_18-00-50", "timestamp": 1754928050, "time_this_iter_s": 10.702582120895386, "time_total_s": 10.702582120895386, "pid": 10074, "hostname": "Mac", "node_ip": "127.0.0.1", "config": {"exploration_config": {}, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 2, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "env": "Umbrella", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": false, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 0, "create_local_env_runner": true, "num_envs_per_env_runner": 1, "gym_env_vectorize_mode": "SYNC", "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "episodes_to_numpy": true, "max_requests_in_flight_per_env_runner": 1, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "merge_env_runner_states": "training_only", "broadcast_env_runner_states": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "complete_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "sampler_perf_stats_ema_coef": null, "_is_online": true, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": "auto", "num_aggregator_actors_per_learner": 0, "max_requests_in_flight_per_aggregator_actor": 3, "local_gpu_idx": 0, "max_requests_in_flight_per_learner": 3, "gamma": 1, "lr": 0.0002715581955, "grad_clip": 0.5, "grad_clip_by": "global_norm", "_train_batch_size_per_learner": 5000, "train_batch_size": 4000, "num_epochs": 1, "minibatch_size": 1000, "shuffle_batch_per_epoch": true, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "log_std_clip_param": 20.0, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "_disable_preprocessor_api": false, "_disable_action_flattening": false}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {"intrinsic_reward_coeff": 0.2795015916508}, "optimizer": {}, "_learner_class": "<class 'source.intrinsic_attention_ppo.learners.IntrinsicAttentionMetaLearner.IntrinsicAttentionMetaLearner'>", "callbacks_on_algorithm_init": null, "callbacks_on_env_runners_recreated": null, "callbacks_on_offline_eval_runners_recreated": null, "callbacks_on_checkpoint_loaded": null, "callbacks_on_environment_created": null, "callbacks_on_episode_created": null, "callbacks_on_episode_start": null, "callbacks_on_episode_step": null, "callbacks_on_episode_end": null, "callbacks_on_evaluate_start": null, "callbacks_on_evaluate_end": null, "callbacks_on_evaluate_offline_start": null, "callbacks_on_evaluate_offline_end": null, "callbacks_on_sample_end": null, "callbacks_on_train_result": null, "explore": true, "enable_rl_module_and_learner": true, "enable_env_runner_and_connector_v2": true, "_prior_exploration_config": {"type": "StochasticSampling"}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x3855fd760>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "offline_data_class": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_read_batch_size": null, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "materialize_data": false, "materialize_mapped_data": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "ignore_final_observation": false, "prelearner_class": null, "prelearner_buffer_class": null, "prelearner_buffer_kwargs": {}, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_remaining_data": false, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": 1, "evaluation_duration": 20, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_auto_duration_min_env_steps_per_sample": 100, "evaluation_auto_duration_max_env_steps_per_sample": 2000, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 1, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "offline_evaluation_interval": null, "num_offline_eval_runners": 0, "offline_loss_for_module_fn": null, "offline_evaluation_duration": 1, "offline_evaluation_parallel_to_training": false, "offline_evaluation_timeout_s": 120.0, "num_cpus_per_offline_eval_runner": 1, "num_gpus_per_offline_eval_runner": 0, "custom_resources_per_offline_eval_runner": {}, "restart_failed_offline_eval_runners": true, "ignore_offline_eval_runner_failures": false, "max_num_offline_eval_runner_restarts": 1000, "offline_eval_runner_restore_timeout_s": 1800.0, "max_requests_in_flight_per_offline_eval_runner": 1, "validate_offline_eval_runners_after_construction": true, "offline_eval_runner_health_probe_timeout_s": 30.0, "offline_eval_rl_module_inference_only": false, "broadcast_offline_eval_runner_states": false, "offline_eval_batch_size_per_runner": 256, "dataset_num_iters_per_eval_runner": 1, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "log_gradients": false, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 6, "restart_failed_env_runners": true, "ignore_env_runner_failures": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30.0, "env_runner_restore_timeout_s": 1800.0, "_model_config": {}, "_rl_module_spec": "MultiRLModuleSpec(multi_rl_module_class=<class 'ray.rllib.core.rl_module.multi_rl_module.MultiRLModule'>, observation_space=None, action_space=None, inference_only=False, model_config=None, rl_module_specs={'default_policy': RLModuleSpec(module_class=<class 'source.intrinsic_attention_ppo.rl_modules.DifferentiablePPOModule.DifferentiablePPOModule'>, observation_space=None, action_space=None, inference_only=False, learner_only=False, model_config={'vf_share_layers': True, 'embedding_dim': 62, 'max_seq_len': 6, 'policy_head_hidden_sizes': [32], 'value_head_hidden_sizes': [101], 'embedding_hidden_sizes': [121]}, catalog_class=None, load_state_path=None, model_config_dict=None), 'intrinsic_reward_module': RLModuleSpec(module_class=<class 'source.intrinsic_attention_ppo.rl_modules.IntrinsicAttentionModule.IntrinsicAttentionModule'>, observation_space=None, action_space=None, inference_only=False, learner_only=True, model_config={'intrinsic_reward_network': {'encoder_hidden_sizes': [], 'encoding_dim': 1, 'num_heads': 1, 'head_hidden_sizes': None, 'layers': [{'type': 'attention'}]}, 'extrinsic_value_hidden_layers': [127, 60], 'vf_share_layers': True, 'max_seq_len': 6}, catalog_class=None, load_state_path=None, model_config_dict=None)}, load_state_path=None, modules_to_load=None, module_specs={'default_policy': RLModuleSpec(module_class=<class 'source.intrinsic_attention_ppo.rl_modules.DifferentiablePPOModule.DifferentiablePPOModule'>, observation_space=None, action_space=None, inference_only=False, learner_only=False, model_config={'vf_share_layers': True, 'embedding_dim': 62, 'max_seq_len': 6, 'policy_head_hidden_sizes': [32], 'value_head_hidden_sizes': [101], 'embedding_hidden_sizes': [121]}, catalog_class=None, load_state_path=None, model_config_dict=None), 'intrinsic_reward_module': RLModuleSpec(module_class=<class 'source.intrinsic_attention_ppo.rl_modules.IntrinsicAttentionModule.IntrinsicAttentionModule'>, observation_space=None, action_space=None, inference_only=False, learner_only=True, model_config={'intrinsic_reward_network': {'encoder_hidden_sizes': [], 'encoding_dim': 1, 'num_heads': 1, 'head_hidden_sizes': None, 'layers': [{'type': 'attention'}]}, 'extrinsic_value_hidden_layers': [127, 60], 'vf_share_layers': True, 'max_seq_len': 6}, catalog_class=None, load_state_path=None, model_config_dict=None)})", "algorithm_config_overrides_per_module": {"intrinsic_reward_module": {"lr": 0.0002715581955}}, "_per_module_overrides": {}, "_validate_config": true, "_use_msgpack_checkpoints": false, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "env_task_fn": -1, "enable_connectors": -1, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.161583927863, "kl_target": 0.0201019014258, "vf_loss_coeff": 0.7790510010087, "entropy_coeff": 0.0015431216992, "clip_param": 0.2459212356676, "vf_clip_param": 0.3769744131561, "entropy_coeff_schedule": null, "lr_schedule": null, "sgd_minibatch_size": -1, "vf_share_layers": -1, "differentiable_learner_configs": ["DifferentiableLearnerConfig(learner_class=<class 'source.intrinsic_attention_ppo.learners.IntrinsicAttentionPPOLearner.IntrinsicAttentionPPOLearner'>, learner_connector=None, add_default_connectors_to_learner_pipeline=True, is_multi_agent=False, policies_to_update=['default_policy'], lr=0.0060984166342, num_total_minibatches=0, num_epochs=1, minibatch_size=1000, shuffle_batch_per_epoch=True)"], "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9485408017724, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.callbacks.callbacks.RLlibCallback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 10.702582120895386, "iterations_since_restore": 1, "perf": {"cpu_util_percent": 44.95625, "ram_util_percent": 81.16875}}
{"timers": {"training_iteration": 10.550036265469389, "restore_env_runners": 9.93210356682539e-06, "training_step": 10.549785170411923, "env_runner_sampling_timer": 1.7204272522067185, "learner_update_timer": 8.63546746627544, "synch_weights": 0.0018490400351583959, "restore_eval_env_runners": 7.912504952400923e-05, "evaluation_iteration": 0.14223087497521192, "synch_eval_env_connectors": 0.00022054091095924377, "synch_env_connectors": 5.249981768429279e-06}, "env_runners": {"episode_return_max": 10.5, "module_to_env_connector": {"timers": {"connectors": {"tensor_to_numpy": 1.6263302011381066e-05, "normalize_and_clip_actions": 8.638019986565364e-06, "un_batch_to_individual_items": 7.029387255457594e-06, "listify_data_for_vector_env": 1.1208299190946235e-05, "get_actions": 4.266033653660248e-05, "remove_single_ts_time_rank_from_batch": 1.2590888136452548e-05}}, "connector_pipeline_timer": 0.00012649616608889714}, "episode_len_mean": 20.0, "episode_len_max": 20, "num_module_steps_sampled_lifetime": {"default_policy": 10000.0}, "num_env_steps_sampled_lifetime": 10000.0, "module_episode_returns_mean": {"default_policy": 2.5}, "env_to_module_sum_episodes_length_out": 10.36823839457432, "episode_return_mean": 2.5, "env_to_module_connector": {"timers": {"connectors": {"add_time_dim_to_batch_and_zero_pad": 7.451747945071449e-06, "add_observations_from_episodes_to_batch": 3.0237774573331673e-06, "add_states_from_episodes_to_batch": 2.9417614617553313e-06, "numpy_to_tensor": 1.3890609428098981e-05, "batch_individual_items": 1.3202594093334504e-05}}, "connector_pipeline_timer": 6.365957143352332e-05}, "agent_episode_returns_mean": {"default_agent": 2.5}, "env_step_timer": 1.5008621914721804e-05, "sample": 0.00633072021532345, "num_episodes": 250.0, "num_agent_steps_sampled_lifetime": {"default_agent": 10000.0}, "num_episodes_lifetime": 500.0, "env_to_module_sum_episodes_length_in": 10.36823839457432, "num_agent_steps_sampled": {"default_agent": 5000.0}, "num_env_steps_sampled": 5000.0, "num_module_steps_sampled": {"default_policy": 5000.0}, "episode_return_min": -9.5, "episode_duration_sec_mean": 0.005657598834484815, "weights_seq_no": 1.0, "time_between_sampling": 0.03396888196250825, "env_reset_timer": 5.5638201889800726e-05, "episode_len_min": 20, "rlmodule_inference_timer": 3.3976294952554684e-05, "num_env_steps_sampled_lifetime_throughput": 3018.545868290711}, "__all_modules__": {"learner_connector_sum_episodes_length_in": 5000.0, "learner_connector": {"connector_pipeline_timer": 0.15498342499719003, "timers": {"connectors": {"add_one_ts_to_episodes_and_truncate": 0.009009384642122314, "add_observations_from_episodes_to_batch": 0.0008349788805935533, "add_columns_from_episodes_to_train_batch": 0.0413748274219688, "add_time_dim_to_batch_and_zero_pad": 0.09216590132098645, "add_states_from_episodes_to_batch": 0.00374657399719581, "batch_individual_items": 0.007625298288185149, "numpy_to_tensor": 7.108135847374797e-05}}}, "learner_connector_sum_episodes_length_out": 5250.0}, "learners": {"__all_modules__": {"num_non_trainable_parameters": 0, "num_trainable_parameters": 24861, "num_module_steps_trained_lifetime": 23940, "num_env_steps_trained": 36000, "num_module_steps_trained": 11970, "num_env_steps_trained_lifetime": 72000, "num_env_steps_trained_lifetime_throughput": 4734.531026199792, "num_module_steps_trained_throughput": 30396428.99761529, "num_module_steps_trained_lifetime_throughput": 15572069.399109188}, "default_policy": {"vf_explained_var": 0.001542508602142334, "vf_loss_unclipped": 42.409027099609375, "use_intrinsic_rewards": 0.0, "weights_seq_no": 2.0, "total_loss": 0.24880024790763855, "num_trainable_parameters": 16595, "curr_entropy_coeff": 0.0015431216992, "num_module_steps_trained_lifetime": 11970, "vf_loss": 0.3207232654094696, "diff_num_grad_updates_vs_sampler_policy": 1.0, "curr_kl_coeff": 0.040395982563495636, "num_module_steps_trained": 5985, "mean_kl_loss": 8.019105735002086e-06, "module_train_batch_size_mean": 998.828720912135, "policy_loss": -6.3743018472450785e-06, "entropy": 0.682900607585907, "num_module_steps_trained_lifetime_throughput": 786.1276612980785}, "intrinsic_reward_module": {"num_module_steps_trained": 5985, "diff_num_grad_updates_vs_sampler_policy": 1.0, "gradients_default_optimizer_global_norm": 0.0, "weights_seq_no": 2.0, "module_train_batch_size_mean": 998.828720912135, "num_trainable_parameters": 8266, "default_optimizer_learning_rate": 0.0002715581955, "curr_entropy_coeff": 0.0015431216992, "num_module_steps_trained_lifetime": 11970, "total_loss": 0.0, "num_module_steps_trained_lifetime_throughput": 786.1421139809376}, "differentiable_learners": {"intrinsic_attention_ppo_learner": {"default_policy": {"vf_loss_unclipped": 42.35747528076172, "num_module_steps_trained_lifetime": 71820, "total_loss": 0.24881793558597565, "vf_loss": 0.3207446038722992, "mean_kl_loss": 8.131280992529355e-06, "diff_num_grad_updates_vs_sampler_policy": 11.0, "policy_loss": -5.979326488159131e-06, "num_module_steps_trained": 35910, "vf_explained_var": 0.0030959248542785645, "use_intrinsic_rewards": 1.0, "weights_seq_no": 12.0, "module_train_batch_size_mean": 998.2236050808158, "entropy": 0.6828963756561279}, "__all_modules__": {"num_module_steps_trained_lifetime": 143640, "num_env_steps_trained_lifetime": 432000, "num_env_steps_trained": 216000, "num_module_steps_trained": 71820, "num_env_steps_trained_lifetime_throughput": 61769.10124143763}, "intrinsic_reward_module": {"num_module_steps_trained": 35910, "weights_seq_no": 12.0, "module_train_batch_size_mean": 998.2236050808158, "total_loss": 0.0, "num_module_steps_trained_lifetime": 71820, "diff_num_grad_updates_vs_sampler_policy": 11.0}}}, "IntrinsicAttentionMask": [[[0.16742384433746338, 0.1665608286857605, 0.16647969186306, 0.1662098914384842, 0.167021244764328, 0.16630452871322632], [0.16789844632148743, 0.16649413108825684, 0.16636234521865845, 0.16592438519001007, 0.16724276542663574, 0.16607795655727386], [0.16794323921203613, 0.16648782789707184, 0.16635127365589142, 0.1658974587917328, 0.16726364195346832, 0.1660565882921219], [0.16809239983558655, 0.16646678745746613, 0.16631434857845306, 0.16580787301063538, 0.16733312606811523, 0.16598545014858246], [0.16764482855796814, 0.1665298044681549, 0.16642507910728455, 0.1660768687725067, 0.16712446510791779, 0.1661989837884903], [0.16804002225399017, 0.16647416353225708, 0.16632729768753052, 0.1658392995595932, 0.1673087328672409, 0.16601039469242096]], [[0.1666209101676941, 0.16685692965984344, 0.166748046875, 0.16681164503097534, 0.16644951701164246, 0.16651301085948944], [0.1666252762079239, 0.16683876514434814, 0.166740283370018, 0.16679780185222626, 0.1664702147245407, 0.166527658700943], [0.16662326455116272, 0.1668471395969391, 0.16674385964870453, 0.16680417954921722, 0.16646067798137665, 0.166520893573761], [0.16662444174289703, 0.1668422520160675, 0.1667417585849762, 0.16680045425891876, 0.16646625101566315, 0.16652485728263855], [0.1666177362203598, 0.1668701320886612, 0.16675367951393127, 0.1668217033147812, 0.16643446683883667, 0.16650235652923584], [0.16661891341209412, 0.16686522960662842, 0.16675159335136414, 0.16681796312332153, 0.16644003987312317, 0.16650629043579102]], [[0.16642436385154724, 0.16665732860565186, 0.16714154183864594, 0.16619254648685455, 0.1666754186153412, 0.16690872609615326], [0.16644777357578278, 0.16665825247764587, 0.16709567606449127, 0.16623829305171967, 0.16667461395263672, 0.1668853908777237], [0.16649629175662994, 0.1666601598262787, 0.16700054705142975, 0.1663331687450409, 0.16667288541793823, 0.1668369174003601], [0.16640105843544006, 0.16665640473365784, 0.16718727350234985, 0.16614700853824615, 0.16667625308036804, 0.16693201661109924], [0.16644959151744843, 0.16665832698345184, 0.16709211468696594, 0.1662418395280838, 0.16667453944683075, 0.16688357293605804], [0.16647298634052277, 0.16665925085544586, 0.16704624891281128, 0.1662875860929489, 0.16667373478412628, 0.1668602079153061]], [[0.16693446040153503, 0.1666596531867981, 0.16657719016075134, 0.16662535071372986, 0.1668042689561844, 0.16639915108680725], [0.16698621213436127, 0.16665825247764587, 0.1665598750114441, 0.16661733388900757, 0.16683082282543182, 0.16634748876094818], [0.16700175404548645, 0.16665783524513245, 0.16655465960502625, 0.16661493480205536, 0.16683879494667053, 0.1663319617509842], [0.1669926792383194, 0.16665808856487274, 0.16655771434307098, 0.16661635041236877, 0.16683414578437805, 0.16634103655815125], [0.16695895791053772, 0.16665898263454437, 0.16656897962093353, 0.16662155091762543, 0.1668168306350708, 0.16637466847896576], [0.16703535616397858, 0.16665694117546082, 0.16654343903064728, 0.1666097342967987, 0.166856050491333, 0.16629844903945923]], [[0.16727450489997864, 0.16596713662147522, 0.16677729785442352, 0.16650700569152832, 0.16687226295471191, 0.16660182178020477], [0.16785266995429993, 0.16530491411685944, 0.1668815016746521, 0.1663547158241272, 0.1670667827129364, 0.16653940081596375], [0.16749371588230133, 0.16571567952632904, 0.16681693494319916, 0.16644930839538574, 0.166946142911911, 0.1665782332420349], [0.167613223195076, 0.16557878255844116, 0.16683846712112427, 0.16641783714294434, 0.16698633134365082, 0.16656534373760223], [0.16745178401470184, 0.1657637506723404, 0.1668093502521515, 0.16646036505699158, 0.16693201661109924, 0.16658276319503784], [0.1675712764263153, 0.16562682390213013, 0.166830912232399, 0.16642887890338898, 0.16697223484516144, 0.16656987369060516]], [[0.16670756042003632, 0.16643311083316803, 0.1668039709329605, 0.166852205991745, 0.1665775328874588, 0.16662569344043732], [0.16671542823314667, 0.16638801991939545, 0.16683049499988556, 0.1668880581855774, 0.16656029224395752, 0.1666177660226822], [0.16670477390289307, 0.1664489209651947, 0.16679465770721436, 0.1668396145105362, 0.1665835678577423, 0.16662846505641937], [0.16670338809490204, 0.16645684838294983, 0.16678999364376068, 0.1668333262205124, 0.16658657789230347, 0.1666298657655716], [0.16671127080917358, 0.16641172766685486, 0.16681651771068573, 0.1668691635131836, 0.16656935214996338, 0.16662192344665527], [0.16670988500118256, 0.16641965508460999, 0.16681186854839325, 0.1668628752231598, 0.16657237708568573, 0.1666233092546463]]]}, "num_training_step_calls_per_iteration": 1, "evaluation": {"env_runners": {"agent_episode_returns_mean": {"default_agent": 1.15}, "num_agent_steps_sampled": {"default_agent": 400}, "num_agent_steps_sampled_lifetime": {"default_agent": 800}, "episode_return_min": -13.5, "module_to_env_connector": {"timers": {"connectors": {"remove_single_ts_time_rank_from_batch": 1.2572726775207125e-05, "tensor_to_numpy": 1.682762187657882e-05, "normalize_and_clip_actions": 8.2235638250485e-06, "listify_data_for_vector_env": 1.0691165220497051e-05, "get_actions": 4.394036218653905e-05, "un_batch_to_individual_items": 8.082805115144175e-06}}, "connector_pipeline_timer": 0.00012890032781999016}, "rlmodule_inference_timer": 3.634738589230377e-05, "env_step_timer": 1.6012587808706537e-05, "num_episodes_lifetime": 40, "env_to_module_sum_episodes_length_in": 10.366003441359926, "num_env_steps_sampled": 400, "env_to_module_connector": {"timers": {"connectors": {"add_observations_from_episodes_to_batch": 2.9354518784797665e-06, "add_time_dim_to_batch_and_zero_pad": 7.731906852156097e-06, "batch_individual_items": 1.309143503799112e-05, "numpy_to_tensor": 1.3445360352209682e-05, "add_states_from_episodes_to_batch": 3.2488289110393642e-06}}, "connector_pipeline_timer": 6.464479436432416e-05}, "num_module_steps_sampled": {"default_policy": 400}, "env_reset_timer": 0.0006692470086272805, "num_module_steps_sampled_lifetime": {"default_policy": 800}, "env_to_module_sum_episodes_length_out": 10.366003441359926, "module_episode_returns_mean": {"default_policy": 1.15}, "episode_return_mean": 1.15, "num_episodes": 20, "episode_len_mean": 20.0, "episode_return_max": 14.5, "num_env_steps_sampled_lifetime": 10400, "sample": 0.13015987763297743, "episode_duration_sec_mean": 0.0057041874999413265, "weights_seq_no": 2.0, "episode_len_min": 20, "episode_len_max": 20, "time_between_sampling": 9.867444165982306}, "num_healthy_workers": 1, "actor_manager_num_outstanding_async_reqs": 0, "num_remote_worker_restarts": 0}, "num_env_steps_sampled_lifetime": 10000.0, "fault_tolerance": {"num_healthy_workers": 0, "num_remote_worker_restarts": 0}, "env_runner_group": {"actor_manager_num_outstanding_async_reqs": 0}, "done": false, "training_iteration": 2, "trial_id": "b1df4_00000", "date": "2025-08-11_18-01-00", "timestamp": 1754928060, "time_this_iter_s": 9.931741952896118, "time_total_s": 20.634324073791504, "pid": 10074, "hostname": "Mac", "node_ip": "127.0.0.1", "config": {"exploration_config": {}, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 2, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "env": "Umbrella", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": false, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 0, "create_local_env_runner": true, "num_envs_per_env_runner": 1, "gym_env_vectorize_mode": "SYNC", "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "episodes_to_numpy": true, "max_requests_in_flight_per_env_runner": 1, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "merge_env_runner_states": "training_only", "broadcast_env_runner_states": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "complete_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "sampler_perf_stats_ema_coef": null, "_is_online": true, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": "auto", "num_aggregator_actors_per_learner": 0, "max_requests_in_flight_per_aggregator_actor": 3, "local_gpu_idx": 0, "max_requests_in_flight_per_learner": 3, "gamma": 1, "lr": 0.0002715581955, "grad_clip": 0.5, "grad_clip_by": "global_norm", "_train_batch_size_per_learner": 5000, "train_batch_size": 4000, "num_epochs": 1, "minibatch_size": 1000, "shuffle_batch_per_epoch": true, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "log_std_clip_param": 20.0, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "_disable_preprocessor_api": false, "_disable_action_flattening": false}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {"intrinsic_reward_coeff": 0.2795015916508}, "optimizer": {}, "_learner_class": "<class 'source.intrinsic_attention_ppo.learners.IntrinsicAttentionMetaLearner.IntrinsicAttentionMetaLearner'>", "callbacks_on_algorithm_init": null, "callbacks_on_env_runners_recreated": null, "callbacks_on_offline_eval_runners_recreated": null, "callbacks_on_checkpoint_loaded": null, "callbacks_on_environment_created": null, "callbacks_on_episode_created": null, "callbacks_on_episode_start": null, "callbacks_on_episode_step": null, "callbacks_on_episode_end": null, "callbacks_on_evaluate_start": null, "callbacks_on_evaluate_end": null, "callbacks_on_evaluate_offline_start": null, "callbacks_on_evaluate_offline_end": null, "callbacks_on_sample_end": null, "callbacks_on_train_result": null, "explore": true, "enable_rl_module_and_learner": true, "enable_env_runner_and_connector_v2": true, "_prior_exploration_config": {"type": "StochasticSampling"}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x3855fd760>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "offline_data_class": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_read_batch_size": null, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "materialize_data": false, "materialize_mapped_data": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "ignore_final_observation": false, "prelearner_class": null, "prelearner_buffer_class": null, "prelearner_buffer_kwargs": {}, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_remaining_data": false, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": 1, "evaluation_duration": 20, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_auto_duration_min_env_steps_per_sample": 100, "evaluation_auto_duration_max_env_steps_per_sample": 2000, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 1, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "offline_evaluation_interval": null, "num_offline_eval_runners": 0, "offline_loss_for_module_fn": null, "offline_evaluation_duration": 1, "offline_evaluation_parallel_to_training": false, "offline_evaluation_timeout_s": 120.0, "num_cpus_per_offline_eval_runner": 1, "num_gpus_per_offline_eval_runner": 0, "custom_resources_per_offline_eval_runner": {}, "restart_failed_offline_eval_runners": true, "ignore_offline_eval_runner_failures": false, "max_num_offline_eval_runner_restarts": 1000, "offline_eval_runner_restore_timeout_s": 1800.0, "max_requests_in_flight_per_offline_eval_runner": 1, "validate_offline_eval_runners_after_construction": true, "offline_eval_runner_health_probe_timeout_s": 30.0, "offline_eval_rl_module_inference_only": false, "broadcast_offline_eval_runner_states": false, "offline_eval_batch_size_per_runner": 256, "dataset_num_iters_per_eval_runner": 1, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "log_gradients": false, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 6, "restart_failed_env_runners": true, "ignore_env_runner_failures": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30.0, "env_runner_restore_timeout_s": 1800.0, "_model_config": {}, "_rl_module_spec": "MultiRLModuleSpec(multi_rl_module_class=<class 'ray.rllib.core.rl_module.multi_rl_module.MultiRLModule'>, observation_space=None, action_space=None, inference_only=False, model_config=None, rl_module_specs={'default_policy': RLModuleSpec(module_class=<class 'source.intrinsic_attention_ppo.rl_modules.DifferentiablePPOModule.DifferentiablePPOModule'>, observation_space=None, action_space=None, inference_only=False, learner_only=False, model_config={'vf_share_layers': True, 'embedding_dim': 62, 'max_seq_len': 6, 'policy_head_hidden_sizes': [32], 'value_head_hidden_sizes': [101], 'embedding_hidden_sizes': [121]}, catalog_class=None, load_state_path=None, model_config_dict=None), 'intrinsic_reward_module': RLModuleSpec(module_class=<class 'source.intrinsic_attention_ppo.rl_modules.IntrinsicAttentionModule.IntrinsicAttentionModule'>, observation_space=None, action_space=None, inference_only=False, learner_only=True, model_config={'intrinsic_reward_network': {'encoder_hidden_sizes': [], 'encoding_dim': 1, 'num_heads': 1, 'head_hidden_sizes': None, 'layers': [{'type': 'attention'}]}, 'extrinsic_value_hidden_layers': [127, 60], 'vf_share_layers': True, 'max_seq_len': 6}, catalog_class=None, load_state_path=None, model_config_dict=None)}, load_state_path=None, modules_to_load=None, module_specs={'default_policy': RLModuleSpec(module_class=<class 'source.intrinsic_attention_ppo.rl_modules.DifferentiablePPOModule.DifferentiablePPOModule'>, observation_space=None, action_space=None, inference_only=False, learner_only=False, model_config={'vf_share_layers': True, 'embedding_dim': 62, 'max_seq_len': 6, 'policy_head_hidden_sizes': [32], 'value_head_hidden_sizes': [101], 'embedding_hidden_sizes': [121]}, catalog_class=None, load_state_path=None, model_config_dict=None), 'intrinsic_reward_module': RLModuleSpec(module_class=<class 'source.intrinsic_attention_ppo.rl_modules.IntrinsicAttentionModule.IntrinsicAttentionModule'>, observation_space=None, action_space=None, inference_only=False, learner_only=True, model_config={'intrinsic_reward_network': {'encoder_hidden_sizes': [], 'encoding_dim': 1, 'num_heads': 1, 'head_hidden_sizes': None, 'layers': [{'type': 'attention'}]}, 'extrinsic_value_hidden_layers': [127, 60], 'vf_share_layers': True, 'max_seq_len': 6}, catalog_class=None, load_state_path=None, model_config_dict=None)})", "algorithm_config_overrides_per_module": {"intrinsic_reward_module": {"lr": 0.0002715581955}}, "_per_module_overrides": {}, "_validate_config": true, "_use_msgpack_checkpoints": false, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "env_task_fn": -1, "enable_connectors": -1, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.161583927863, "kl_target": 0.0201019014258, "vf_loss_coeff": 0.7790510010087, "entropy_coeff": 0.0015431216992, "clip_param": 0.2459212356676, "vf_clip_param": 0.3769744131561, "entropy_coeff_schedule": null, "lr_schedule": null, "sgd_minibatch_size": -1, "vf_share_layers": -1, "differentiable_learner_configs": ["DifferentiableLearnerConfig(learner_class=<class 'source.intrinsic_attention_ppo.learners.IntrinsicAttentionPPOLearner.IntrinsicAttentionPPOLearner'>, learner_connector=None, add_default_connectors_to_learner_pipeline=True, is_multi_agent=False, policies_to_update=['default_policy'], lr=0.0060984166342, num_total_minibatches=0, num_epochs=1, minibatch_size=1000, shuffle_batch_per_epoch=True)"], "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9485408017724, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.callbacks.callbacks.RLlibCallback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 20.634324073791504, "iterations_since_restore": 2, "perf": {"cpu_util_percent": 41.307142857142864, "ram_util_percent": 80.12142857142858}}
{"timers": {"training_iteration": 10.546582852814334, "restore_env_runners": 9.89736276678741e-06, "training_step": 10.546331918287917, "env_runner_sampling_timer": 1.7228602180248709, "learner_update_timer": 8.628416658692702, "synch_weights": 0.001843260885262862, "restore_eval_env_runners": 7.841379847377538e-05, "evaluation_iteration": 0.14207093331613577, "synch_eval_env_connectors": 0.00021959175122901798, "synch_env_connectors": 5.247481167316436e-06}, "env_runners": {"episode_return_max": 10.5, "module_to_env_connector": {"timers": {"connectors": {"tensor_to_numpy": 2.1222154643426534e-05, "normalize_and_clip_actions": 9.731081163304463e-06, "un_batch_to_individual_items": 7.938935058895987e-06, "listify_data_for_vector_env": 1.2930708660896874e-05, "get_actions": 5.3451846739066395e-05, "remove_single_ts_time_rank_from_batch": 1.4692981806281185e-05}}, "connector_pipeline_timer": 0.0001517720822211101}, "episode_len_mean": 20.0, "episode_len_max": 20, "num_module_steps_sampled_lifetime": {"default_policy": -607500.0}, "num_env_steps_sampled_lifetime": -607500.0, "module_episode_returns_mean": {"default_policy": 2.0200000000000005}, "env_to_module_sum_episodes_length_out": 10.36823839457432, "episode_return_mean": 2.0200000000000005, "env_to_module_connector": {"timers": {"connectors": {"add_time_dim_to_batch_and_zero_pad": 8.526945024637979e-06, "add_observations_from_episodes_to_batch": 3.374738730399988e-06, "add_states_from_episodes_to_batch": 3.239128358218862e-06, "numpy_to_tensor": 1.633863712675364e-05, "batch_individual_items": 1.5231849907334476e-05}}, "connector_pipeline_timer": 7.278724591461061e-05}, "agent_episode_returns_mean": {"default_agent": 2.0200000000000005}, "env_step_timer": 1.8461156285937044e-05, "sample": 0.006717455022314861, "num_episodes": 250.0, "num_agent_steps_sampled_lifetime": {"default_agent": -607500.0}, "num_episodes_lifetime": -30375.0, "env_to_module_sum_episodes_length_in": 10.36823839457432, "num_agent_steps_sampled": {"default_agent": 5000.0}, "num_env_steps_sampled": 5000.0, "num_module_steps_sampled": {"default_policy": 5000.0}, "episode_return_min": -9.5, "episode_duration_sec_mean": 0.006729375655297188, "weights_seq_no": 2.0, "time_between_sampling": 0.033590443088544045, "env_reset_timer": 5.48010603608943e-05, "episode_len_min": 20, "rlmodule_inference_timer": 4.220468661099326e-05, "num_env_steps_sampled_lifetime_throughput": 2880.385927691437}, "__all_modules__": {"learner_connector_sum_episodes_length_in": 5000.0, "learner_connector": {"connector_pipeline_timer": 0.1560231424174621, "timers": {"connectors": {"add_one_ts_to_episodes_and_truncate": 0.009012970795400907, "add_observations_from_episodes_to_batch": 0.0008362095116521232, "add_columns_from_episodes_to_train_batch": 0.04138555081874365, "add_time_dim_to_batch_and_zero_pad": 0.09218203730769456, "add_states_from_episodes_to_batch": 0.003746617007325403, "batch_individual_items": 0.00863314739598427, "numpy_to_tensor": 7.136054544243962e-05}}}, "learner_connector_sum_episodes_length_out": 5250.0}, "learners": {"__all_modules__": {"num_non_trainable_parameters": 0, "num_trainable_parameters": 24861, "num_module_steps_trained_lifetime": 35910, "num_env_steps_trained": 36000, "num_module_steps_trained": 11970, "num_env_steps_trained_lifetime": 108000, "num_env_steps_trained_lifetime_throughput": 4721.640532254462, "num_module_steps_trained_throughput": 29749103.38552188, "num_module_steps_trained_lifetime_throughput": 15455000.001804318}, "default_policy": {"vf_explained_var": -0.0017718076705932617, "vf_loss_unclipped": 44.16998291015625, "use_intrinsic_rewards": 0.0, "weights_seq_no": 3.0, "total_loss": 0.24831576645374298, "num_trainable_parameters": 16595, "curr_entropy_coeff": 0.0015431216992, "num_module_steps_trained_lifetime": 17955, "vf_loss": 0.3205367922782898, "diff_num_grad_updates_vs_sampler_policy": 1.0, "curr_kl_coeff": 0.020197991281747818, "num_module_steps_trained": 5985, "mean_kl_loss": 1.4404988178284839e-05, "module_train_batch_size_mean": 998.7505232584676, "policy_loss": -0.00034631782909855247, "entropy": 0.6823880076408386, "num_module_steps_trained_lifetime_throughput": 784.0038440267574}, "intrinsic_reward_module": {"num_module_steps_trained": 5985, "diff_num_grad_updates_vs_sampler_policy": 1.0, "gradients_default_optimizer_global_norm": 0.0, "weights_seq_no": 3.0, "module_train_batch_size_mean": 998.7505232584676, "num_trainable_parameters": 8266, "default_optimizer_learning_rate": 0.0002715581955, "curr_entropy_coeff": 0.0015431216992, "num_module_steps_trained_lifetime": 17955, "total_loss": 0.0, "num_module_steps_trained_lifetime_throughput": 784.0179452790339}, "differentiable_learners": {"intrinsic_attention_ppo_learner": {"default_policy": {"vf_loss_unclipped": 44.07978820800781, "num_module_steps_trained_lifetime": 107730, "total_loss": 0.24843858182430267, "vf_loss": 0.3206697404384613, "mean_kl_loss": 1.2887236152892001e-05, "diff_num_grad_updates_vs_sampler_policy": 16.0, "policy_loss": -0.00032851615105755627, "num_module_steps_trained": 35910, "vf_explained_var": 0.002932608127593994, "use_intrinsic_rewards": 1.0, "weights_seq_no": 18.0, "module_train_batch_size_mean": 998.0016398003509, "entropy": 0.68243008852005}, "__all_modules__": {"num_module_steps_trained_lifetime": 215460, "num_env_steps_trained_lifetime": 648000, "num_env_steps_trained": 216000, "num_module_steps_trained": 71820, "num_env_steps_trained_lifetime_throughput": 61182.246000247236}, "intrinsic_reward_module": {"num_module_steps_trained": 35910, "weights_seq_no": 18.0, "module_train_batch_size_mean": 998.0016398003509, "total_loss": 0.0, "num_module_steps_trained_lifetime": 107730, "diff_num_grad_updates_vs_sampler_policy": 16.0}}}, "IntrinsicAttentionMask": [[[0.16742387413978577, 0.16656085848808289, 0.16692623496055603, 0.16620992124080658, 0.16657452285289764, 0.1663045585155487], [0.16789855062961578, 0.1664942353963852, 0.16708822548389435, 0.16592448949813843, 0.16651642322540283, 0.16607806086540222], [0.16769719123840332, 0.1665225476026535, 0.16701959073543549, 0.16604551672935486, 0.16654111444950104, 0.16617412865161896], [0.1680925488471985, 0.16646693646907806, 0.16715426743030548, 0.16580800712108612, 0.16649262607097626, 0.1659855991601944], [0.1678910106420517, 0.16649529337882996, 0.1670856475830078, 0.16592900454998016, 0.16651736199855804, 0.16608165204524994], [0.1680401712656021, 0.16647429764270782, 0.16713644564151764, 0.16583944857120514, 0.1664990484714508, 0.1660105437040329]], [[0.1664213389158249, 0.16665707528591156, 0.16714707016944885, 0.16721083223819733, 0.16625015437602997, 0.1663135588169098], [0.16644474864006042, 0.16665801405906677, 0.16710121929645538, 0.16715887188911438, 0.16628986597061157, 0.16634725034236908], [0.16649332642555237, 0.16665996611118317, 0.16700613498687744, 0.16705115139484406, 0.16637226939201355, 0.16641712188720703], [0.16649964451789856, 0.16666023433208466, 0.16699379682540894, 0.16703717410564423, 0.16638298332691193, 0.16642619669437408], [0.16640430688858032, 0.16665637493133545, 0.16718041896820068, 0.16724860668182373, 0.1662212759256363, 0.1662890762090683], [0.16641061007976532, 0.16665662825107574, 0.1671680510044098, 0.1672345995903015, 0.16623196005821228, 0.16629813611507416]], [[0.1662278175354004, 0.16646049916744232, 0.16694414615631104, 0.1665860116481781, 0.16707001626491547, 0.16671161353588104], [0.1662701517343521, 0.1664804071187973, 0.1669173538684845, 0.16659380495548248, 0.16703104972839355, 0.16670729219913483], [0.16635796427726746, 0.16652168333530426, 0.16686178743839264, 0.1666099727153778, 0.1669502556324005, 0.16669830679893494], [0.1662929505109787, 0.16649112105369568, 0.16690291464328766, 0.16659800708293915, 0.16701005399227142, 0.1667049527168274], [0.16638079285621643, 0.16653242707252502, 0.1668473780155182, 0.16661418974399567, 0.16692928969860077, 0.1666959822177887], [0.16631576418876648, 0.16650186479091644, 0.16688849031925201, 0.1666022092103958, 0.16698907315731049, 0.16670262813568115]], [[0.16693435609340668, 0.1662067174911499, 0.16657708585262299, 0.1666252464056015, 0.16680416464805603, 0.16685238480567932], [0.16707150638103485, 0.1659715175628662, 0.16653108596801758, 0.1666039228439331, 0.166874498128891, 0.16694746911525726], [0.1670016348361969, 0.16609133780002594, 0.1665545403957367, 0.1666148155927658, 0.16683867573738098, 0.16689904034137726], [0.16699254512786865, 0.16610689461231232, 0.16655758023262024, 0.16661621630191803, 0.1668340116739273, 0.16689273715019226], [0.16695886850357056, 0.16616471111774445, 0.16656889021396637, 0.16662146151065826, 0.16681674122810364, 0.1668693870306015], [0.1669497787952423, 0.16618026793003082, 0.16657191514968872, 0.16662286221981049, 0.16681207716464996, 0.1668630838394165]], [[0.16652292013168335, 0.16675600409507751, 0.16664846241474152, 0.16629096865653992, 0.16677410900592804, 0.16700756549835205], [0.16653679311275482, 0.16674739122390747, 0.16665023565292358, 0.16632720828056335, 0.16676375269889832, 0.16697463393211365], [0.16653038561344147, 0.16675136983394623, 0.16664941608905792, 0.16631048917770386, 0.16676852107048035, 0.16698981821537018], [0.16650906205177307, 0.16676457226276398, 0.16664668917655945, 0.16625484824180603, 0.16678442060947418, 0.1670403629541397], [0.16653788089752197, 0.16674672067165375, 0.16665038466453552, 0.166330024600029, 0.16676294803619385, 0.1669720858335495], [0.16655175387859344, 0.1667380928993225, 0.1666521430015564, 0.16636626422405243, 0.16675257682800293, 0.1669391542673111]], [[0.16649988293647766, 0.16625408828258514, 0.1669931262731552, 0.16703642904758453, 0.16638343036174774, 0.1668330878019333], [0.16646389663219452, 0.16616524755954742, 0.16706345975399017, 0.16711612045764923, 0.16632241010665894, 0.1668688803911209], [0.16657187044620514, 0.1664319932460785, 0.16685228049755096, 0.166876882314682, 0.1665056198835373, 0.1667613387107849], [0.16657817363739014, 0.16644759476184845, 0.16683994233608246, 0.16686290502548218, 0.16651631891727448, 0.16675503551959991], [0.1664828360080719, 0.16621200740337372, 0.16702644526958466, 0.16707415878772736, 0.16635452210903168, 0.1668500304222107], [0.16654853522777557, 0.1663743108510971, 0.1668979376554489, 0.16692858934402466, 0.16646601259708405, 0.1667845994234085]]]}, "num_training_step_calls_per_iteration": 1, "evaluation": {"env_runners": {"agent_episode_returns_mean": {"default_agent": 2.9833333333333334}, "num_agent_steps_sampled": {"default_agent": 400}, "num_agent_steps_sampled_lifetime": {"default_agent": 1200}, "episode_return_min": -13.5, "module_to_env_connector": {"timers": {"connectors": {"remove_single_ts_time_rank_from_batch": 1.224732197360225e-05, "tensor_to_numpy": 1.631329076576862e-05, "normalize_and_clip_actions": 8.358516661633668e-06, "listify_data_for_vector_env": 1.0611428350303577e-05, "get_actions": 3.885961162242267e-05, "un_batch_to_individual_items": 6.7094729678208696e-06}}, "connector_pipeline_timer": 0.00012085523743101497}, "rlmodule_inference_timer": 3.441250780483474e-05, "env_step_timer": 1.4679493727050805e-05, "num_episodes_lifetime": 60, "env_to_module_sum_episodes_length_in": 10.368205581254823, "num_env_steps_sampled": 400, "env_to_module_connector": {"timers": {"connectors": {"add_observations_from_episodes_to_batch": 2.8207466126038943e-06, "add_time_dim_to_batch_and_zero_pad": 7.0667920115860085e-06, "batch_individual_items": 1.2695141901229417e-05, "numpy_to_tensor": 1.3614183871474467e-05, "add_states_from_episodes_to_batch": 2.7783525262109585e-06}}, "connector_pipeline_timer": 6.219972188705021e-05}, "num_module_steps_sampled": {"default_policy": 400}, "env_reset_timer": 0.0006659949489054269, "num_module_steps_sampled_lifetime": {"default_policy": 1200}, "env_to_module_sum_episodes_length_out": 10.368205581254823, "module_episode_returns_mean": {"default_policy": 2.9833333333333334}, "episode_return_mean": 2.9833333333333334, "num_episodes": 20, "episode_len_mean": 20.0, "episode_return_max": 14.5, "num_env_steps_sampled_lifetime": 15400, "sample": 0.13011195427695055, "episode_duration_sec_mean": 0.005697168062518661, "weights_seq_no": 3.0, "episode_len_min": 20, "episode_len_max": 20, "time_between_sampling": 9.871087820151589}, "num_healthy_workers": 1, "actor_manager_num_outstanding_async_reqs": 0, "num_remote_worker_restarts": 0}, "num_env_steps_sampled_lifetime": -607500.0, "fault_tolerance": {"num_healthy_workers": 0, "num_remote_worker_restarts": 0}, "env_runner_group": {"actor_manager_num_outstanding_async_reqs": 0}, "done": false, "training_iteration": 3, "trial_id": "b1df4_00000", "date": "2025-08-11_18-01-10", "timestamp": 1754928070, "time_this_iter_s": 10.342944860458374, "time_total_s": 30.977268934249878, "pid": 10074, "hostname": "Mac", "node_ip": "127.0.0.1", "config": {"exploration_config": {}, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 2, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "env": "Umbrella", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": false, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 0, "create_local_env_runner": true, "num_envs_per_env_runner": 1, "gym_env_vectorize_mode": "SYNC", "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "episodes_to_numpy": true, "max_requests_in_flight_per_env_runner": 1, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "merge_env_runner_states": "training_only", "broadcast_env_runner_states": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "complete_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "sampler_perf_stats_ema_coef": null, "_is_online": true, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": "auto", "num_aggregator_actors_per_learner": 0, "max_requests_in_flight_per_aggregator_actor": 3, "local_gpu_idx": 0, "max_requests_in_flight_per_learner": 3, "gamma": 1, "lr": 0.0002715581955, "grad_clip": 0.5, "grad_clip_by": "global_norm", "_train_batch_size_per_learner": 5000, "train_batch_size": 4000, "num_epochs": 1, "minibatch_size": 1000, "shuffle_batch_per_epoch": true, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "log_std_clip_param": 20.0, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "_disable_preprocessor_api": false, "_disable_action_flattening": false}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {"intrinsic_reward_coeff": 0.2795015916508}, "optimizer": {}, "_learner_class": "<class 'source.intrinsic_attention_ppo.learners.IntrinsicAttentionMetaLearner.IntrinsicAttentionMetaLearner'>", "callbacks_on_algorithm_init": null, "callbacks_on_env_runners_recreated": null, "callbacks_on_offline_eval_runners_recreated": null, "callbacks_on_checkpoint_loaded": null, "callbacks_on_environment_created": null, "callbacks_on_episode_created": null, "callbacks_on_episode_start": null, "callbacks_on_episode_step": null, "callbacks_on_episode_end": null, "callbacks_on_evaluate_start": null, "callbacks_on_evaluate_end": null, "callbacks_on_evaluate_offline_start": null, "callbacks_on_evaluate_offline_end": null, "callbacks_on_sample_end": null, "callbacks_on_train_result": null, "explore": true, "enable_rl_module_and_learner": true, "enable_env_runner_and_connector_v2": true, "_prior_exploration_config": {"type": "StochasticSampling"}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x3855fd760>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "offline_data_class": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_read_batch_size": null, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "materialize_data": false, "materialize_mapped_data": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "ignore_final_observation": false, "prelearner_class": null, "prelearner_buffer_class": null, "prelearner_buffer_kwargs": {}, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_remaining_data": false, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": 1, "evaluation_duration": 20, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_auto_duration_min_env_steps_per_sample": 100, "evaluation_auto_duration_max_env_steps_per_sample": 2000, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 1, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "offline_evaluation_interval": null, "num_offline_eval_runners": 0, "offline_loss_for_module_fn": null, "offline_evaluation_duration": 1, "offline_evaluation_parallel_to_training": false, "offline_evaluation_timeout_s": 120.0, "num_cpus_per_offline_eval_runner": 1, "num_gpus_per_offline_eval_runner": 0, "custom_resources_per_offline_eval_runner": {}, "restart_failed_offline_eval_runners": true, "ignore_offline_eval_runner_failures": false, "max_num_offline_eval_runner_restarts": 1000, "offline_eval_runner_restore_timeout_s": 1800.0, "max_requests_in_flight_per_offline_eval_runner": 1, "validate_offline_eval_runners_after_construction": true, "offline_eval_runner_health_probe_timeout_s": 30.0, "offline_eval_rl_module_inference_only": false, "broadcast_offline_eval_runner_states": false, "offline_eval_batch_size_per_runner": 256, "dataset_num_iters_per_eval_runner": 1, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "log_gradients": false, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 6, "restart_failed_env_runners": true, "ignore_env_runner_failures": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30.0, "env_runner_restore_timeout_s": 1800.0, "_model_config": {}, "_rl_module_spec": "MultiRLModuleSpec(multi_rl_module_class=<class 'ray.rllib.core.rl_module.multi_rl_module.MultiRLModule'>, observation_space=None, action_space=None, inference_only=False, model_config=None, rl_module_specs={'default_policy': RLModuleSpec(module_class=<class 'source.intrinsic_attention_ppo.rl_modules.DifferentiablePPOModule.DifferentiablePPOModule'>, observation_space=None, action_space=None, inference_only=False, learner_only=False, model_config={'vf_share_layers': True, 'embedding_dim': 62, 'max_seq_len': 6, 'policy_head_hidden_sizes': [32], 'value_head_hidden_sizes': [101], 'embedding_hidden_sizes': [121]}, catalog_class=None, load_state_path=None, model_config_dict=None), 'intrinsic_reward_module': RLModuleSpec(module_class=<class 'source.intrinsic_attention_ppo.rl_modules.IntrinsicAttentionModule.IntrinsicAttentionModule'>, observation_space=None, action_space=None, inference_only=False, learner_only=True, model_config={'intrinsic_reward_network': {'encoder_hidden_sizes': [], 'encoding_dim': 1, 'num_heads': 1, 'head_hidden_sizes': None, 'layers': [{'type': 'attention'}]}, 'extrinsic_value_hidden_layers': [127, 60], 'vf_share_layers': True, 'max_seq_len': 6}, catalog_class=None, load_state_path=None, model_config_dict=None)}, load_state_path=None, modules_to_load=None, module_specs={'default_policy': RLModuleSpec(module_class=<class 'source.intrinsic_attention_ppo.rl_modules.DifferentiablePPOModule.DifferentiablePPOModule'>, observation_space=None, action_space=None, inference_only=False, learner_only=False, model_config={'vf_share_layers': True, 'embedding_dim': 62, 'max_seq_len': 6, 'policy_head_hidden_sizes': [32], 'value_head_hidden_sizes': [101], 'embedding_hidden_sizes': [121]}, catalog_class=None, load_state_path=None, model_config_dict=None), 'intrinsic_reward_module': RLModuleSpec(module_class=<class 'source.intrinsic_attention_ppo.rl_modules.IntrinsicAttentionModule.IntrinsicAttentionModule'>, observation_space=None, action_space=None, inference_only=False, learner_only=True, model_config={'intrinsic_reward_network': {'encoder_hidden_sizes': [], 'encoding_dim': 1, 'num_heads': 1, 'head_hidden_sizes': None, 'layers': [{'type': 'attention'}]}, 'extrinsic_value_hidden_layers': [127, 60], 'vf_share_layers': True, 'max_seq_len': 6}, catalog_class=None, load_state_path=None, model_config_dict=None)})", "algorithm_config_overrides_per_module": {"intrinsic_reward_module": {"lr": 0.0002715581955}}, "_per_module_overrides": {}, "_validate_config": true, "_use_msgpack_checkpoints": false, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "env_task_fn": -1, "enable_connectors": -1, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.161583927863, "kl_target": 0.0201019014258, "vf_loss_coeff": 0.7790510010087, "entropy_coeff": 0.0015431216992, "clip_param": 0.2459212356676, "vf_clip_param": 0.3769744131561, "entropy_coeff_schedule": null, "lr_schedule": null, "sgd_minibatch_size": -1, "vf_share_layers": -1, "differentiable_learner_configs": ["DifferentiableLearnerConfig(learner_class=<class 'source.intrinsic_attention_ppo.learners.IntrinsicAttentionPPOLearner.IntrinsicAttentionPPOLearner'>, learner_connector=None, add_default_connectors_to_learner_pipeline=True, is_multi_agent=False, policies_to_update=['default_policy'], lr=0.0060984166342, num_total_minibatches=0, num_epochs=1, minibatch_size=1000, shuffle_batch_per_epoch=True)"], "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9485408017724, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.callbacks.callbacks.RLlibCallback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 30.977268934249878, "iterations_since_restore": 3, "perf": {"cpu_util_percent": 44.900000000000006, "ram_util_percent": 79.63333333333334}}
{"timers": {"training_iteration": 10.538092356365647, "restore_env_runners": 9.8704688497819e-06, "training_step": 10.537841699514415, "env_runner_sampling_timer": 1.7213452408454117, "learner_update_timer": 8.62133955460584, "synch_weights": 0.0018344999367832207, "restore_eval_env_runners": 7.780007971450685e-05, "evaluation_iteration": 0.1420023231527186, "synch_eval_env_connectors": 0.00021900000425521284, "synch_env_connectors": 5.237506097182631e-06}, "env_runners": {"episode_return_max": 10.5, "module_to_env_connector": {"timers": {"connectors": {"tensor_to_numpy": 1.5518603009755565e-05, "normalize_and_clip_actions": 8.295934498646022e-06, "un_batch_to_individual_items": 6.759318654644411e-06, "listify_data_for_vector_env": 1.0825814453964286e-05, "get_actions": 3.994157032713452e-05, "remove_single_ts_time_rank_from_batch": 1.2253273312286114e-05}}, "connector_pipeline_timer": 0.00012073232363479192}, "episode_len_mean": 20.0, "episode_len_max": 20, "num_module_steps_sampled_lifetime": {"default_policy": -1225000.0}, "num_env_steps_sampled_lifetime": -1225000.0, "module_episode_returns_mean": {"default_policy": 2.8199999999999994}, "env_to_module_sum_episodes_length_out": 10.36823839457432, "episode_return_mean": 2.8199999999999994, "env_to_module_connector": {"timers": {"connectors": {"add_time_dim_to_batch_and_zero_pad": 7.236410791047901e-06, "add_observations_from_episodes_to_batch": 2.9107017244525124e-06, "add_states_from_episodes_to_batch": 2.8373694447871365e-06, "numpy_to_tensor": 1.3062698278141717e-05, "batch_individual_items": 1.278513724503982e-05}}, "connector_pipeline_timer": 6.12167538928288e-05}, "agent_episode_returns_mean": {"default_agent": 2.8199999999999994}, "env_step_timer": 1.4259472966555193e-05, "sample": 0.0063261290639715665, "num_episodes": 250.0, "num_agent_steps_sampled_lifetime": {"default_agent": -1225000.0}, "num_episodes_lifetime": -61250.0, "env_to_module_sum_episodes_length_in": 10.36823839457432, "num_agent_steps_sampled": {"default_agent": 5000.0}, "num_env_steps_sampled": 5000.0, "num_module_steps_sampled": {"default_policy": 5000.0}, "episode_return_min": -9.5, "episode_duration_sec_mean": 0.005385297532193365, "weights_seq_no": 3.0, "time_between_sampling": 0.034111210322012225, "env_reset_timer": 5.030277717077114e-05, "episode_len_min": 20, "rlmodule_inference_timer": 3.2415027333172435e-05, "num_env_steps_sampled_lifetime_throughput": 3141.9682754634596}, "__all_modules__": {"learner_connector_sum_episodes_length_in": 5000.0, "learner_connector": {"connector_pipeline_timer": 0.1560262789137495, "timers": {"connectors": {"add_one_ts_to_episodes_and_truncate": 0.00901151150767447, "add_observations_from_episodes_to_batch": 0.0008363861660702387, "add_columns_from_episodes_to_train_batch": 0.04138555865048326, "add_time_dim_to_batch_and_zero_pad": 0.09219515735517442, "add_states_from_episodes_to_batch": 0.003747132507136324, "batch_individual_items": 0.008624207172549098, "numpy_to_tensor": 7.143734996463172e-05}}}, "learner_connector_sum_episodes_length_out": 5250.0}, "learners": {"__all_modules__": {"num_non_trainable_parameters": 0, "num_trainable_parameters": 24861, "num_module_steps_trained_lifetime": 47880, "num_env_steps_trained": 36000, "num_module_steps_trained": 11970, "num_env_steps_trained_lifetime": 144000, "num_env_steps_trained_lifetime_throughput": 4705.532249902882, "num_module_steps_trained_throughput": 29008060.910669923, "num_module_steps_trained_lifetime_throughput": 15322897.413998565}, "default_policy": {"vf_explained_var": -0.0028318166732788086, "vf_loss_unclipped": 43.717227935791016, "use_intrinsic_rewards": 0.0, "weights_seq_no": 4.0, "total_loss": 0.24862569570541382, "num_trainable_parameters": 16595, "curr_entropy_coeff": 0.0015431216992, "num_module_steps_trained_lifetime": 23940, "vf_loss": 0.3205440640449524, "diff_num_grad_updates_vs_sampler_policy": 1.0, "curr_kl_coeff": 0.010098995640873909, "num_module_steps_trained": 5985, "mean_kl_loss": 1.572128530824557e-05, "module_train_batch_size_mean": 998.6769017198101, "policy_loss": -4.318846913520247e-05, "entropy": 0.6814794540405273, "num_module_steps_trained_lifetime_throughput": 781.3503270091279}, "intrinsic_reward_module": {"num_module_steps_trained": 5985, "diff_num_grad_updates_vs_sampler_policy": 1.0, "gradients_default_optimizer_global_norm": 0.0, "weights_seq_no": 4.0, "module_train_batch_size_mean": 998.6769017198101, "num_trainable_parameters": 8266, "default_optimizer_learning_rate": 0.0002715581955, "curr_entropy_coeff": 0.0015431216992, "num_module_steps_trained_lifetime": 23940, "total_loss": 0.0, "num_module_steps_trained_lifetime_throughput": 781.3639784153862}, "differentiable_learners": {"intrinsic_attention_ppo_learner": {"default_policy": {"vf_loss_unclipped": 43.61554718017578, "num_module_steps_trained_lifetime": 143640, "total_loss": 0.24871888756752014, "vf_loss": 0.32066184282302856, "mean_kl_loss": 1.5604749933118e-05, "diff_num_grad_updates_vs_sampler_policy": 21.0, "policy_loss": -4.398068267619237e-05, "num_module_steps_trained": 35910, "vf_explained_var": 0.0029471516609191895, "use_intrinsic_rewards": 1.0, "weights_seq_no": 24.0, "module_train_batch_size_mean": 997.847060245087, "entropy": 0.6814824938774109}, "__all_modules__": {"num_module_steps_trained_lifetime": 287280, "num_env_steps_trained_lifetime": 864000, "num_env_steps_trained": 216000, "num_module_steps_trained": 71820, "num_env_steps_trained_lifetime_throughput": 60418.734664569965}, "intrinsic_reward_module": {"num_module_steps_trained": 35910, "weights_seq_no": 24.0, "module_train_batch_size_mean": 997.847060245087, "total_loss": 0.0, "num_module_steps_trained_lifetime": 143640, "diff_num_grad_updates_vs_sampler_policy": 21.0}}}, "IntrinsicAttentionMask": [[[0.16632597148418427, 0.16655878722667694, 0.16704271733760834, 0.1666843742132187, 0.16716866195201874, 0.1662195324897766], [0.1663588434457779, 0.16656921803951263, 0.16700640320777893, 0.1666826754808426, 0.16712015867233276, 0.1662626564502716], [0.16642706096172333, 0.1665908545255661, 0.16693110764026642, 0.16667917370796204, 0.16701960563659668, 0.16635215282440186], [0.16637657582759857, 0.1665748506784439, 0.1669868379831314, 0.16668178141117096, 0.16709403693675995, 0.166285902261734], [0.1664447784423828, 0.16659647226333618, 0.1669115424156189, 0.1666782647371292, 0.16699348390102386, 0.16637539863586426], [0.16631090641021729, 0.16655398905277252, 0.16705933213233948, 0.16668513417243958, 0.16719084978103638, 0.16619977355003357]], [[0.1666209101676941, 0.16685692965984344, 0.1667480319738388, 0.16681164503097534, 0.16644951701164246, 0.16651301085948944], [0.1666252762079239, 0.16683876514434814, 0.1667402684688568, 0.16679780185222626, 0.1664702147245407, 0.166527658700943], [0.16662326455116272, 0.1668471395969391, 0.16674385964870453, 0.16680417954921722, 0.16646067798137665, 0.166520893573761], [0.16662444174289703, 0.1668422520160675, 0.1667417585849762, 0.16680045425891876, 0.16646625101566315, 0.16652485728263855], [0.1666177362203598, 0.1668701320886612, 0.16675367951393127, 0.16682168841362, 0.16643446683883667, 0.16650235652923584], [0.16661889851093292, 0.16686522960662842, 0.16675159335136414, 0.16681796312332153, 0.16644003987312317, 0.16650629043579102]], [[0.16720007359981537, 0.16633820533752441, 0.16670309007167816, 0.1664329320192337, 0.16679801046848297, 0.16652768850326538], [0.16753420233726501, 0.16613292694091797, 0.16672563552856445, 0.16628670692443848, 0.16687993705272675, 0.16644062101840973], [0.16739246249198914, 0.16621994972229004, 0.1667160838842392, 0.16634869575500488, 0.16684521734714508, 0.1664775311946869], [0.16749736666679382, 0.16615553200244904, 0.16672314703464508, 0.16630280017852783, 0.16687092185020447, 0.16645020246505737], [0.16735567152500153, 0.1662425696849823, 0.16671361029148102, 0.16636481881141663, 0.1668362021446228, 0.16648714244365692], [0.16746054589748383, 0.1661781370639801, 0.1667206734418869, 0.16631890833377838, 0.1668619066476822, 0.1664597988128662]], [[0.16693426668643951, 0.16620661318302155, 0.16703081130981445, 0.16662514209747314, 0.1663508415222168, 0.16685229539871216], [0.16707128286361694, 0.1659712940454483, 0.1672174334526062, 0.166603684425354, 0.16618911921977997, 0.16694724559783936], [0.1669161170721054, 0.16623780131340027, 0.16700612008571625, 0.16662798821926117, 0.16637225449085236, 0.16683971881866455], [0.1669923961162567, 0.16610674560070038, 0.16710998117923737, 0.1666160523891449, 0.16628222167491913, 0.16689258813858032], [0.16704407334327698, 0.16601800918579102, 0.1671803742647171, 0.16660796105861664, 0.1662212312221527, 0.16692841053009033], [0.16694965958595276, 0.16618014872074127, 0.1670517921447754, 0.16662274301052094, 0.1663326621055603, 0.16686297953128815]], [[0.16742375493049622, 0.16611522436141968, 0.16647960245609283, 0.16620980203151703, 0.16702115535736084, 0.1667504757642746], [0.16814444959163666, 0.1655922681093216, 0.16630107164382935, 0.1657761037349701, 0.1673571914434433, 0.16682890057563782], [0.16794298589229584, 0.16573823988437653, 0.16635102033615112, 0.1658972203731537, 0.16726338863372803, 0.1668071150779724], [0.16809210181236267, 0.16563019156455994, 0.1663140505552292, 0.1658075749874115, 0.16733284294605255, 0.16682325303554535], [0.1676446795463562, 0.16595469415187836, 0.1664249300956726, 0.16607671976089478, 0.16712431609630585, 0.16677464544773102], [0.1677936315536499, 0.16584660112857819, 0.16638803482055664, 0.16598708927631378, 0.16719380021095276, 0.1667908877134323]], [[0.16673392057418823, 0.16657531261444092, 0.16678962111473083, 0.16681748628616333, 0.1663970649242401, 0.16668662428855896], [0.16675640642642975, 0.16654475033283234, 0.16683073341846466, 0.1668679267168045, 0.1663069725036621, 0.1666932851076126], [0.1667260378599167, 0.1665860265493393, 0.1667751967906952, 0.16679978370666504, 0.16642868518829346, 0.16668428480625153], [0.16672207415103912, 0.16659137606620789, 0.16676796972751617, 0.1667909175157547, 0.16644448041915894, 0.1666831076145172], [0.16678164899349213, 0.16651034355163574, 0.16687697172164917, 0.16692465543746948, 0.16620565950870514, 0.16670073568820953], [0.16674061119556427, 0.16656619310379028, 0.16680186986923218, 0.16683250665664673, 0.1663701832294464, 0.16668859124183655]]]}, "num_training_step_calls_per_iteration": 1, "evaluation": {"env_runners": {"agent_episode_returns_mean": {"default_agent": 1.9}, "num_agent_steps_sampled": {"default_agent": 400}, "num_agent_steps_sampled_lifetime": {"default_agent": 1600}, "episode_return_min": -13.5, "module_to_env_connector": {"timers": {"connectors": {"remove_single_ts_time_rank_from_batch": 1.1851312680426021e-05, "tensor_to_numpy": 1.4889753890297482e-05, "normalize_and_clip_actions": 7.757992670541055e-06, "listify_data_for_vector_env": 1.032327407716642e-05, "get_actions": 3.5618607444152796e-05, "un_batch_to_individual_items": 6.4406158630257255e-06}}, "connector_pipeline_timer": 0.0001130056483295087}, "rlmodule_inference_timer": 3.059792004600573e-05, "env_step_timer": 1.366147094437071e-05, "num_episodes_lifetime": 80, "env_to_module_sum_episodes_length_in": 10.368237912813044, "num_env_steps_sampled": 400, "env_to_module_connector": {"timers": {"connectors": {"add_observations_from_episodes_to_batch": 2.7526624693062194e-06, "add_time_dim_to_batch_and_zero_pad": 6.8116245404589095e-06, "batch_individual_items": 1.2190296122906437e-05, "numpy_to_tensor": 1.2071002447459761e-05, "add_states_from_episodes_to_batch": 2.6912002336911485e-06}}, "connector_pipeline_timer": 5.875018010543681e-05}, "num_module_steps_sampled": {"default_policy": 400}, "env_reset_timer": 0.0006603579198945081, "num_module_steps_sampled_lifetime": {"default_policy": 1600}, "env_to_module_sum_episodes_length_out": 10.368237912813044, "module_episode_returns_mean": {"default_policy": 1.9}, "episode_return_mean": 1.9, "num_episodes": 20, "episode_len_mean": 20.0, "episode_return_max": 14.5, "num_env_steps_sampled_lifetime": 20400, "sample": 0.12993222348363334, "episode_duration_sec_mean": 0.005562182780704461, "weights_seq_no": 4.0, "episode_len_min": 20, "episode_len_max": 20, "time_between_sampling": 9.869631610290392}, "num_healthy_workers": 1, "actor_manager_num_outstanding_async_reqs": 0, "num_remote_worker_restarts": 0}, "num_env_steps_sampled_lifetime": -1225000.0, "fault_tolerance": {"num_healthy_workers": 0, "num_remote_worker_restarts": 0}, "env_runner_group": {"actor_manager_num_outstanding_async_reqs": 0}, "done": false, "training_iteration": 4, "trial_id": "b1df4_00000", "date": "2025-08-11_18-01-20", "timestamp": 1754928080, "time_this_iter_s": 9.817857027053833, "time_total_s": 40.79512596130371, "pid": 10074, "hostname": "Mac", "node_ip": "127.0.0.1", "config": {"exploration_config": {}, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 2, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "env": "Umbrella", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": false, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 0, "create_local_env_runner": true, "num_envs_per_env_runner": 1, "gym_env_vectorize_mode": "SYNC", "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "episodes_to_numpy": true, "max_requests_in_flight_per_env_runner": 1, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "merge_env_runner_states": "training_only", "broadcast_env_runner_states": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "complete_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "sampler_perf_stats_ema_coef": null, "_is_online": true, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": "auto", "num_aggregator_actors_per_learner": 0, "max_requests_in_flight_per_aggregator_actor": 3, "local_gpu_idx": 0, "max_requests_in_flight_per_learner": 3, "gamma": 1, "lr": 0.0002715581955, "grad_clip": 0.5, "grad_clip_by": "global_norm", "_train_batch_size_per_learner": 5000, "train_batch_size": 4000, "num_epochs": 1, "minibatch_size": 1000, "shuffle_batch_per_epoch": true, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "log_std_clip_param": 20.0, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "_disable_preprocessor_api": false, "_disable_action_flattening": false}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {"intrinsic_reward_coeff": 0.2795015916508}, "optimizer": {}, "_learner_class": "<class 'source.intrinsic_attention_ppo.learners.IntrinsicAttentionMetaLearner.IntrinsicAttentionMetaLearner'>", "callbacks_on_algorithm_init": null, "callbacks_on_env_runners_recreated": null, "callbacks_on_offline_eval_runners_recreated": null, "callbacks_on_checkpoint_loaded": null, "callbacks_on_environment_created": null, "callbacks_on_episode_created": null, "callbacks_on_episode_start": null, "callbacks_on_episode_step": null, "callbacks_on_episode_end": null, "callbacks_on_evaluate_start": null, "callbacks_on_evaluate_end": null, "callbacks_on_evaluate_offline_start": null, "callbacks_on_evaluate_offline_end": null, "callbacks_on_sample_end": null, "callbacks_on_train_result": null, "explore": true, "enable_rl_module_and_learner": true, "enable_env_runner_and_connector_v2": true, "_prior_exploration_config": {"type": "StochasticSampling"}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x3855fd760>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "offline_data_class": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_read_batch_size": null, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "materialize_data": false, "materialize_mapped_data": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "ignore_final_observation": false, "prelearner_class": null, "prelearner_buffer_class": null, "prelearner_buffer_kwargs": {}, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_remaining_data": false, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": 1, "evaluation_duration": 20, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_auto_duration_min_env_steps_per_sample": 100, "evaluation_auto_duration_max_env_steps_per_sample": 2000, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 1, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "offline_evaluation_interval": null, "num_offline_eval_runners": 0, "offline_loss_for_module_fn": null, "offline_evaluation_duration": 1, "offline_evaluation_parallel_to_training": false, "offline_evaluation_timeout_s": 120.0, "num_cpus_per_offline_eval_runner": 1, "num_gpus_per_offline_eval_runner": 0, "custom_resources_per_offline_eval_runner": {}, "restart_failed_offline_eval_runners": true, "ignore_offline_eval_runner_failures": false, "max_num_offline_eval_runner_restarts": 1000, "offline_eval_runner_restore_timeout_s": 1800.0, "max_requests_in_flight_per_offline_eval_runner": 1, "validate_offline_eval_runners_after_construction": true, "offline_eval_runner_health_probe_timeout_s": 30.0, "offline_eval_rl_module_inference_only": false, "broadcast_offline_eval_runner_states": false, "offline_eval_batch_size_per_runner": 256, "dataset_num_iters_per_eval_runner": 1, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "log_gradients": false, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 6, "restart_failed_env_runners": true, "ignore_env_runner_failures": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30.0, "env_runner_restore_timeout_s": 1800.0, "_model_config": {}, "_rl_module_spec": "MultiRLModuleSpec(multi_rl_module_class=<class 'ray.rllib.core.rl_module.multi_rl_module.MultiRLModule'>, observation_space=None, action_space=None, inference_only=False, model_config=None, rl_module_specs={'default_policy': RLModuleSpec(module_class=<class 'source.intrinsic_attention_ppo.rl_modules.DifferentiablePPOModule.DifferentiablePPOModule'>, observation_space=None, action_space=None, inference_only=False, learner_only=False, model_config={'vf_share_layers': True, 'embedding_dim': 62, 'max_seq_len': 6, 'policy_head_hidden_sizes': [32], 'value_head_hidden_sizes': [101], 'embedding_hidden_sizes': [121]}, catalog_class=None, load_state_path=None, model_config_dict=None), 'intrinsic_reward_module': RLModuleSpec(module_class=<class 'source.intrinsic_attention_ppo.rl_modules.IntrinsicAttentionModule.IntrinsicAttentionModule'>, observation_space=None, action_space=None, inference_only=False, learner_only=True, model_config={'intrinsic_reward_network': {'encoder_hidden_sizes': [], 'encoding_dim': 1, 'num_heads': 1, 'head_hidden_sizes': None, 'layers': [{'type': 'attention'}]}, 'extrinsic_value_hidden_layers': [127, 60], 'vf_share_layers': True, 'max_seq_len': 6}, catalog_class=None, load_state_path=None, model_config_dict=None)}, load_state_path=None, modules_to_load=None, module_specs={'default_policy': RLModuleSpec(module_class=<class 'source.intrinsic_attention_ppo.rl_modules.DifferentiablePPOModule.DifferentiablePPOModule'>, observation_space=None, action_space=None, inference_only=False, learner_only=False, model_config={'vf_share_layers': True, 'embedding_dim': 62, 'max_seq_len': 6, 'policy_head_hidden_sizes': [32], 'value_head_hidden_sizes': [101], 'embedding_hidden_sizes': [121]}, catalog_class=None, load_state_path=None, model_config_dict=None), 'intrinsic_reward_module': RLModuleSpec(module_class=<class 'source.intrinsic_attention_ppo.rl_modules.IntrinsicAttentionModule.IntrinsicAttentionModule'>, observation_space=None, action_space=None, inference_only=False, learner_only=True, model_config={'intrinsic_reward_network': {'encoder_hidden_sizes': [], 'encoding_dim': 1, 'num_heads': 1, 'head_hidden_sizes': None, 'layers': [{'type': 'attention'}]}, 'extrinsic_value_hidden_layers': [127, 60], 'vf_share_layers': True, 'max_seq_len': 6}, catalog_class=None, load_state_path=None, model_config_dict=None)})", "algorithm_config_overrides_per_module": {"intrinsic_reward_module": {"lr": 0.0002715581955}}, "_per_module_overrides": {}, "_validate_config": true, "_use_msgpack_checkpoints": false, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "env_task_fn": -1, "enable_connectors": -1, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.161583927863, "kl_target": 0.0201019014258, "vf_loss_coeff": 0.7790510010087, "entropy_coeff": 0.0015431216992, "clip_param": 0.2459212356676, "vf_clip_param": 0.3769744131561, "entropy_coeff_schedule": null, "lr_schedule": null, "sgd_minibatch_size": -1, "vf_share_layers": -1, "differentiable_learner_configs": ["DifferentiableLearnerConfig(learner_class=<class 'source.intrinsic_attention_ppo.learners.IntrinsicAttentionPPOLearner.IntrinsicAttentionPPOLearner'>, learner_connector=None, add_default_connectors_to_learner_pipeline=True, is_multi_agent=False, policies_to_update=['default_policy'], lr=0.0060984166342, num_total_minibatches=0, num_epochs=1, minibatch_size=1000, shuffle_batch_per_epoch=True)"], "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9485408017724, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.callbacks.callbacks.RLlibCallback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 40.79512596130371, "iterations_since_restore": 4, "perf": {"cpu_util_percent": 37.05, "ram_util_percent": 79.46428571428571}}
{"timers": {"training_iteration": 10.53240758447206, "restore_env_runners": 9.837593533317558e-06, "training_step": 10.532156754598505, "env_runner_sampling_timer": 1.719781005517748, "learner_update_timer": 8.617116734479985, "synch_weights": 0.0018308911881567958, "restore_eval_env_runners": 7.712041959632187e-05, "evaluation_iteration": 0.14175856117228525, "synch_eval_env_connectors": 0.00021805083321849815, "synch_env_connectors": 5.222631903830915e-06}, "env_runners": {"episode_return_max": 10.5, "module_to_env_connector": {"timers": {"connectors": {"tensor_to_numpy": 1.5457494341888318e-05, "normalize_and_clip_actions": 8.238962242292695e-06, "un_batch_to_individual_items": 6.769352330145901e-06, "listify_data_for_vector_env": 1.0757242815267681e-05, "get_actions": 3.94236361686581e-05, "remove_single_ts_time_rank_from_batch": 1.2151108672106208e-05}}, "connector_pipeline_timer": 0.00011987118611344675}, "episode_len_mean": 20.0, "episode_len_max": 20, "num_module_steps_sampled_lifetime": {"default_policy": -1842500.0}, "num_env_steps_sampled_lifetime": -1842500.0, "module_episode_returns_mean": {"default_policy": 2.660000000000001}, "env_to_module_sum_episodes_length_out": 10.36823839457432, "episode_return_mean": 2.660000000000001, "env_to_module_connector": {"timers": {"connectors": {"add_time_dim_to_batch_and_zero_pad": 7.184282330797867e-06, "add_observations_from_episodes_to_batch": 2.9335195171925233e-06, "add_states_from_episodes_to_batch": 2.8084159748183293e-06, "numpy_to_tensor": 1.2836570984055071e-05, "batch_individual_items": 1.2661567159590998e-05}}, "connector_pipeline_timer": 6.0807592251758875e-05}, "agent_episode_returns_mean": {"default_agent": 2.660000000000001}, "env_step_timer": 1.4062827891583093e-05, "sample": 0.005812155930050144, "num_episodes": 250.0, "num_agent_steps_sampled_lifetime": {"default_agent": -1842500.0}, "num_episodes_lifetime": -92125.0, "env_to_module_sum_episodes_length_in": 10.36823839457432, "num_agent_steps_sampled": {"default_agent": 5000.0}, "num_env_steps_sampled": 5000.0, "num_module_steps_sampled": {"default_policy": 5000.0}, "episode_return_min": -9.5, "episode_duration_sec_mean": 0.005360560984816402, "weights_seq_no": 4.0, "time_between_sampling": 0.03364627410465765, "env_reset_timer": 4.487780927005383e-05, "episode_len_min": 20, "rlmodule_inference_timer": 3.205939594020095e-05, "num_env_steps_sampled_lifetime_throughput": 3188.3350145878303}, "__all_modules__": {"learner_connector_sum_episodes_length_in": 5000.0, "learner_connector": {"connector_pipeline_timer": 0.15602426070454933, "timers": {"connectors": {"add_one_ts_to_episodes_and_truncate": 0.009012724302210753, "add_observations_from_episodes_to_batch": 0.0008374660550145235, "add_columns_from_episodes_to_train_batch": 0.041393823894022574, "add_time_dim_to_batch_and_zero_pad": 0.0921920362017461, "add_states_from_episodes_to_batch": 0.0037470424317777406, "batch_individual_items": 0.008615270930441734, "numpy_to_tensor": 7.146297627894442e-05}}}, "learner_connector_sum_episodes_length_out": 5250.0}, "learners": {"__all_modules__": {"num_non_trainable_parameters": 0, "num_trainable_parameters": 24861, "num_module_steps_trained_lifetime": 59850, "num_env_steps_trained": 36000, "num_module_steps_trained": 11970, "num_env_steps_trained_lifetime": 180000, "num_env_steps_trained_lifetime_throughput": 4684.965592446426, "num_module_steps_trained_throughput": 28243221.820674885, "num_module_steps_trained_lifetime_throughput": 15192495.663545046}, "default_policy": {"vf_explained_var": -0.001202225685119629, "vf_loss_unclipped": 43.48118591308594, "use_intrinsic_rewards": 0.0, "weights_seq_no": 5.0, "total_loss": 0.24865618348121643, "num_trainable_parameters": 16595, "curr_entropy_coeff": 0.0015431216992, "num_module_steps_trained_lifetime": 29925, "vf_loss": 0.3205222487449646, "diff_num_grad_updates_vs_sampler_policy": 1.0, "curr_kl_coeff": 0.0050494978204369545, "num_module_steps_trained": 5985, "mean_kl_loss": 9.521623724140227e-06, "module_train_batch_size_mean": 998.6075885025957, "policy_loss": 3.428398713367642e-06, "entropy": 0.6807708740234375, "num_module_steps_trained_lifetime_throughput": 777.9591956220281}, "intrinsic_reward_module": {"num_module_steps_trained": 5985, "diff_num_grad_updates_vs_sampler_policy": 1.0, "gradients_default_optimizer_global_norm": 0.0, "weights_seq_no": 5.0, "module_train_batch_size_mean": 998.6075885025957, "num_trainable_parameters": 8266, "default_optimizer_learning_rate": 0.0002715581955, "curr_entropy_coeff": 0.0015431216992, "num_module_steps_trained_lifetime": 29925, "total_loss": 0.0, "num_module_steps_trained_lifetime_throughput": 777.9723392335987}, "differentiable_learners": {"intrinsic_attention_ppo_learner": {"default_policy": {"vf_loss_unclipped": 43.386287689208984, "num_module_steps_trained_lifetime": 179550, "total_loss": 0.24875791370868683, "vf_loss": 0.3206499218940735, "mean_kl_loss": 9.698854228190612e-06, "diff_num_grad_updates_vs_sampler_policy": 26.0, "policy_loss": 4.170313331997022e-06, "num_module_steps_trained": 35910, "vf_explained_var": 0.002938568592071533, "use_intrinsic_rewards": 1.0, "weights_seq_no": 30.0, "module_train_batch_size_mean": 997.7394089995611, "entropy": 0.6807639598846436}, "__all_modules__": {"num_module_steps_trained_lifetime": 359100, "num_env_steps_trained_lifetime": 1080000, "num_env_steps_trained": 216000, "num_module_steps_trained": 71820, "num_env_steps_trained_lifetime_throughput": 59531.36664896902}, "intrinsic_reward_module": {"num_module_steps_trained": 35910, "weights_seq_no": 30.0, "module_train_batch_size_mean": 997.7394089995611, "total_loss": 0.0, "num_module_steps_trained_lifetime": 179550, "diff_num_grad_updates_vs_sampler_policy": 26.0}}}, "IntrinsicAttentionMask": [[[0.16642437875270844, 0.16665734350681305, 0.16654986143112183, 0.16678300499916077, 0.1672675758600235, 0.166317880153656], [0.16644777357578278, 0.16665825247764587, 0.16656115651130676, 0.1667717695236206, 0.16720949113368988, 0.1663515269756317], [0.16643700003623962, 0.16665783524513245, 0.1665559560060501, 0.16677695512771606, 0.16723628342151642, 0.16633601486682892], [0.16646037995815277, 0.16665875911712646, 0.16656725108623505, 0.1667657494544983, 0.167178213596344, 0.16636967658996582], [0.16650891304016113, 0.16666066646575928, 0.16659066081047058, 0.1667424887418747, 0.1670578271150589, 0.16643951833248138], [0.16641367971897125, 0.16665691137313843, 0.16654469072818756, 0.16678813099861145, 0.16729415953159332, 0.16630247235298157]], [[0.1667831391096115, 0.16650857031345367, 0.16687960922718048, 0.16647431254386902, 0.16665306687355042, 0.16670125722885132], [0.16680563986301422, 0.16647803783416748, 0.1669207662343979, 0.16643717885017395, 0.1666504293680191, 0.16670791804790497], [0.16677524149417877, 0.16651929914951324, 0.16686517000198364, 0.16648735105991364, 0.16665399074554443, 0.16669891774654388], [0.16680845618247986, 0.16647422313690186, 0.16692590713500977, 0.16643252968788147, 0.16665010154247284, 0.16670875251293182], [0.1667937934398651, 0.16649411618709564, 0.16689909994602203, 0.16645672917366028, 0.16665181517601013, 0.16670440137386322], [0.16678984463214874, 0.16649946570396423, 0.16689187288284302, 0.166463240981102, 0.16665226221084595, 0.1667032390832901]], [[0.16734935343265533, 0.1664867252111435, 0.16640563309192657, 0.16658152639865875, 0.16650037467479706, 0.1666763722896576], [0.16777731478214264, 0.16637401282787323, 0.1662423312664032, 0.16652800142765045, 0.16639618575572968, 0.1666821390390396], [0.16781769692897797, 0.16636337339878082, 0.16622690856456757, 0.16652294993400574, 0.16638635098934174, 0.1666826754808426], [0.16773013770580292, 0.1663864403963089, 0.16626031696796417, 0.1665339171886444, 0.16640767455101013, 0.16668151319026947], [0.16777051985263824, 0.16637581586837769, 0.16624490916728973, 0.1665288656949997, 0.1663978546857834, 0.16668204963207245], [0.1676829606294632, 0.16639885306358337, 0.16627830266952515, 0.16653980314731598, 0.1664191484451294, 0.16668088734149933]], [[0.16682131588459015, 0.16666261851787567, 0.16661496460437775, 0.16664279997348785, 0.1664842814207077, 0.1667739897966385], [0.1668730527162552, 0.16666124761104584, 0.16659767925739288, 0.16663481295108795, 0.16642332077026367, 0.16680988669395447], [0.16688859462738037, 0.1666608452796936, 0.16659247875213623, 0.16663241386413574, 0.16640500724315643, 0.1668206751346588], [0.16687950491905212, 0.1666610687971115, 0.16659551858901978, 0.16663381457328796, 0.16641569137573242, 0.16681435704231262], [0.16693125665187836, 0.16665969789028168, 0.16657821834087372, 0.16662581264972687, 0.16635474562644958, 0.1668502688407898], [0.16683673858642578, 0.16666221618652344, 0.16660982370376587, 0.16664043068885803, 0.1664661020040512, 0.16678470373153687]], [[0.1665227711200714, 0.16675586998462677, 0.16724036633968353, 0.16629081964492798, 0.1667739748954773, 0.1664162129163742], [0.16653667390346527, 0.16674727201461792, 0.16718491911888123, 0.1663270890712738, 0.16676363348960876, 0.16644038259983063], [0.16656552255153656, 0.16672945022583008, 0.16706998646259308, 0.16640233993530273, 0.16674219071865082, 0.1664905548095703], [0.16650889813899994, 0.16676440834999084, 0.16729561984539032, 0.1662546694278717, 0.16678427159786224, 0.16639208793640137], [0.16653776168823242, 0.1667466163635254, 0.1671806275844574, 0.16632992029190063, 0.1667628288269043, 0.16644227504730225], [0.16651639342308044, 0.16675977408885956, 0.16726572811603546, 0.16627420485019684, 0.16677868366241455, 0.1664051115512848]], [[0.16673395037651062, 0.1665753424167633, 0.16652771830558777, 0.16681751608848572, 0.16665881872177124, 0.16668665409088135], [0.16675645112991333, 0.16654479503631592, 0.16648127138614655, 0.16686797142028809, 0.16665618121623993, 0.1666933298110962], [0.16676321625709534, 0.1665356159210205, 0.1664673089981079, 0.16688314080238342, 0.16665539145469666, 0.16669532656669617], [0.1667221039533615, 0.16659140586853027, 0.16655217111110687, 0.1667909473180771, 0.16666018962860107, 0.1666831374168396], [0.16674461960792542, 0.16656088829040527, 0.16650572419166565, 0.16684141755104065, 0.16665758192539215, 0.16668982803821564], [0.16674067080020905, 0.16656625270843506, 0.16651387512683868, 0.1668325662612915, 0.16665804386138916, 0.16668865084648132]]]}, "num_training_step_calls_per_iteration": 1, "evaluation": {"env_runners": {"agent_episode_returns_mean": {"default_agent": 1.45}, "num_agent_steps_sampled": {"default_agent": 400}, "num_agent_steps_sampled_lifetime": {"default_agent": 2000}, "episode_return_min": -13.5, "module_to_env_connector": {"timers": {"connectors": {"remove_single_ts_time_rank_from_batch": 1.2014989803836723e-05, "tensor_to_numpy": 1.571415937611292e-05, "normalize_and_clip_actions": 8.262310098878782e-06, "listify_data_for_vector_env": 1.0778825447711842e-05, "get_actions": 4.156600556117838e-05, "un_batch_to_individual_items": 6.638934728892986e-06}}, "connector_pipeline_timer": 0.0001226924967495381}, "rlmodule_inference_timer": 3.521265495063127e-05, "env_step_timer": 1.4890483153832589e-05, "num_episodes_lifetime": 100, "env_to_module_sum_episodes_length_in": 10.368238387501162, "num_env_steps_sampled": 400, "env_to_module_connector": {"timers": {"connectors": {"add_observations_from_episodes_to_batch": 2.968114917266522e-06, "add_time_dim_to_batch_and_zero_pad": 7.07062672610024e-06, "batch_individual_items": 1.27921605022784e-05, "numpy_to_tensor": 1.308566188943133e-05, "add_states_from_episodes_to_batch": 2.814845943270882e-06}}, "connector_pipeline_timer": 6.164419375286592e-05}, "num_module_steps_sampled": {"default_policy": 400}, "env_reset_timer": 0.000658712670650679, "num_module_steps_sampled_lifetime": {"default_policy": 2000}, "env_to_module_sum_episodes_length_out": 10.368238387501162, "module_episode_returns_mean": {"default_policy": 1.45}, "episode_return_mean": 1.45, "num_episodes": 20, "episode_len_mean": 20.0, "episode_return_max": 14.5, "num_env_steps_sampled_lifetime": 25400, "sample": 0.12989811666849552, "episode_duration_sec_mean": 0.005558733280049637, "weights_seq_no": 5.0, "episode_len_min": 20, "episode_len_max": 20, "time_between_sampling": 9.87099488001722}, "num_healthy_workers": 1, "actor_manager_num_outstanding_async_reqs": 0, "num_remote_worker_restarts": 0}, "num_env_steps_sampled_lifetime": -1842500.0, "fault_tolerance": {"num_healthy_workers": 0, "num_remote_worker_restarts": 0}, "env_runner_group": {"actor_manager_num_outstanding_async_reqs": 0}, "done": false, "training_iteration": 5, "trial_id": "b1df4_00000", "date": "2025-08-11_18-01-30", "timestamp": 1754928090, "time_this_iter_s": 10.108261108398438, "time_total_s": 50.90338706970215, "pid": 10074, "hostname": "Mac", "node_ip": "127.0.0.1", "config": {"exploration_config": {}, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 2, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "env": "Umbrella", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": false, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 0, "create_local_env_runner": true, "num_envs_per_env_runner": 1, "gym_env_vectorize_mode": "SYNC", "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "episodes_to_numpy": true, "max_requests_in_flight_per_env_runner": 1, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "merge_env_runner_states": "training_only", "broadcast_env_runner_states": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "complete_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "sampler_perf_stats_ema_coef": null, "_is_online": true, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": "auto", "num_aggregator_actors_per_learner": 0, "max_requests_in_flight_per_aggregator_actor": 3, "local_gpu_idx": 0, "max_requests_in_flight_per_learner": 3, "gamma": 1, "lr": 0.0002715581955, "grad_clip": 0.5, "grad_clip_by": "global_norm", "_train_batch_size_per_learner": 5000, "train_batch_size": 4000, "num_epochs": 1, "minibatch_size": 1000, "shuffle_batch_per_epoch": true, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "log_std_clip_param": 20.0, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "_disable_preprocessor_api": false, "_disable_action_flattening": false}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {"intrinsic_reward_coeff": 0.2795015916508}, "optimizer": {}, "_learner_class": "<class 'source.intrinsic_attention_ppo.learners.IntrinsicAttentionMetaLearner.IntrinsicAttentionMetaLearner'>", "callbacks_on_algorithm_init": null, "callbacks_on_env_runners_recreated": null, "callbacks_on_offline_eval_runners_recreated": null, "callbacks_on_checkpoint_loaded": null, "callbacks_on_environment_created": null, "callbacks_on_episode_created": null, "callbacks_on_episode_start": null, "callbacks_on_episode_step": null, "callbacks_on_episode_end": null, "callbacks_on_evaluate_start": null, "callbacks_on_evaluate_end": null, "callbacks_on_evaluate_offline_start": null, "callbacks_on_evaluate_offline_end": null, "callbacks_on_sample_end": null, "callbacks_on_train_result": null, "explore": true, "enable_rl_module_and_learner": true, "enable_env_runner_and_connector_v2": true, "_prior_exploration_config": {"type": "StochasticSampling"}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x3855fd760>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "offline_data_class": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_read_batch_size": null, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "materialize_data": false, "materialize_mapped_data": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "ignore_final_observation": false, "prelearner_class": null, "prelearner_buffer_class": null, "prelearner_buffer_kwargs": {}, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_remaining_data": false, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": 1, "evaluation_duration": 20, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_auto_duration_min_env_steps_per_sample": 100, "evaluation_auto_duration_max_env_steps_per_sample": 2000, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 1, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "offline_evaluation_interval": null, "num_offline_eval_runners": 0, "offline_loss_for_module_fn": null, "offline_evaluation_duration": 1, "offline_evaluation_parallel_to_training": false, "offline_evaluation_timeout_s": 120.0, "num_cpus_per_offline_eval_runner": 1, "num_gpus_per_offline_eval_runner": 0, "custom_resources_per_offline_eval_runner": {}, "restart_failed_offline_eval_runners": true, "ignore_offline_eval_runner_failures": false, "max_num_offline_eval_runner_restarts": 1000, "offline_eval_runner_restore_timeout_s": 1800.0, "max_requests_in_flight_per_offline_eval_runner": 1, "validate_offline_eval_runners_after_construction": true, "offline_eval_runner_health_probe_timeout_s": 30.0, "offline_eval_rl_module_inference_only": false, "broadcast_offline_eval_runner_states": false, "offline_eval_batch_size_per_runner": 256, "dataset_num_iters_per_eval_runner": 1, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "log_gradients": false, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 6, "restart_failed_env_runners": true, "ignore_env_runner_failures": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30.0, "env_runner_restore_timeout_s": 1800.0, "_model_config": {}, "_rl_module_spec": "MultiRLModuleSpec(multi_rl_module_class=<class 'ray.rllib.core.rl_module.multi_rl_module.MultiRLModule'>, observation_space=None, action_space=None, inference_only=False, model_config=None, rl_module_specs={'default_policy': RLModuleSpec(module_class=<class 'source.intrinsic_attention_ppo.rl_modules.DifferentiablePPOModule.DifferentiablePPOModule'>, observation_space=None, action_space=None, inference_only=False, learner_only=False, model_config={'vf_share_layers': True, 'embedding_dim': 62, 'max_seq_len': 6, 'policy_head_hidden_sizes': [32], 'value_head_hidden_sizes': [101], 'embedding_hidden_sizes': [121]}, catalog_class=None, load_state_path=None, model_config_dict=None), 'intrinsic_reward_module': RLModuleSpec(module_class=<class 'source.intrinsic_attention_ppo.rl_modules.IntrinsicAttentionModule.IntrinsicAttentionModule'>, observation_space=None, action_space=None, inference_only=False, learner_only=True, model_config={'intrinsic_reward_network': {'encoder_hidden_sizes': [], 'encoding_dim': 1, 'num_heads': 1, 'head_hidden_sizes': None, 'layers': [{'type': 'attention'}]}, 'extrinsic_value_hidden_layers': [127, 60], 'vf_share_layers': True, 'max_seq_len': 6}, catalog_class=None, load_state_path=None, model_config_dict=None)}, load_state_path=None, modules_to_load=None, module_specs={'default_policy': RLModuleSpec(module_class=<class 'source.intrinsic_attention_ppo.rl_modules.DifferentiablePPOModule.DifferentiablePPOModule'>, observation_space=None, action_space=None, inference_only=False, learner_only=False, model_config={'vf_share_layers': True, 'embedding_dim': 62, 'max_seq_len': 6, 'policy_head_hidden_sizes': [32], 'value_head_hidden_sizes': [101], 'embedding_hidden_sizes': [121]}, catalog_class=None, load_state_path=None, model_config_dict=None), 'intrinsic_reward_module': RLModuleSpec(module_class=<class 'source.intrinsic_attention_ppo.rl_modules.IntrinsicAttentionModule.IntrinsicAttentionModule'>, observation_space=None, action_space=None, inference_only=False, learner_only=True, model_config={'intrinsic_reward_network': {'encoder_hidden_sizes': [], 'encoding_dim': 1, 'num_heads': 1, 'head_hidden_sizes': None, 'layers': [{'type': 'attention'}]}, 'extrinsic_value_hidden_layers': [127, 60], 'vf_share_layers': True, 'max_seq_len': 6}, catalog_class=None, load_state_path=None, model_config_dict=None)})", "algorithm_config_overrides_per_module": {"intrinsic_reward_module": {"lr": 0.0002715581955}}, "_per_module_overrides": {}, "_validate_config": true, "_use_msgpack_checkpoints": false, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "env_task_fn": -1, "enable_connectors": -1, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.161583927863, "kl_target": 0.0201019014258, "vf_loss_coeff": 0.7790510010087, "entropy_coeff": 0.0015431216992, "clip_param": 0.2459212356676, "vf_clip_param": 0.3769744131561, "entropy_coeff_schedule": null, "lr_schedule": null, "sgd_minibatch_size": -1, "vf_share_layers": -1, "differentiable_learner_configs": ["DifferentiableLearnerConfig(learner_class=<class 'source.intrinsic_attention_ppo.learners.IntrinsicAttentionPPOLearner.IntrinsicAttentionPPOLearner'>, learner_connector=None, add_default_connectors_to_learner_pipeline=True, is_multi_agent=False, policies_to_update=['default_policy'], lr=0.0060984166342, num_total_minibatches=0, num_epochs=1, minibatch_size=1000, shuffle_batch_per_epoch=True)"], "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9485408017724, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.callbacks.callbacks.RLlibCallback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 50.90338706970215, "iterations_since_restore": 5, "perf": {"cpu_util_percent": 35.964285714285715, "ram_util_percent": 79.75714285714285}}
{"timers": {"training_iteration": 10.532414041126696, "restore_env_runners": 9.797967754297562e-06, "training_step": 10.532163167471907, "env_runner_sampling_timer": 1.7237268833829826, "learner_update_timer": 8.612780615885695, "synch_weights": 0.0018239301857332095, "restore_eval_env_runners": 7.706629536575637e-05, "evaluation_iteration": 0.14169847346990153, "synch_eval_env_connectors": 0.00021738824447700987, "synch_env_connectors": 5.249155893395654e-06}, "env_runners": {"episode_return_max": 10.5, "module_to_env_connector": {"timers": {"connectors": {"tensor_to_numpy": 2.306062093215812e-05, "normalize_and_clip_actions": 9.911034742585738e-06, "un_batch_to_individual_items": 7.897660867984603e-06, "listify_data_for_vector_env": 1.2814456675033163e-05, "get_actions": 5.467645864525192e-05, "remove_single_ts_time_rank_from_batch": 1.4060778731979033e-05}}, "connector_pipeline_timer": 0.0001551588356218524}, "episode_len_mean": 20.0, "episode_len_max": 20, "num_module_steps_sampled_lifetime": {"default_policy": -2460000.0}, "num_env_steps_sampled_lifetime": -2460000.0, "module_episode_returns_mean": {"default_policy": 2.18}, "env_to_module_sum_episodes_length_out": 10.36823839457432, "episode_return_mean": 2.18, "env_to_module_connector": {"timers": {"connectors": {"add_time_dim_to_batch_and_zero_pad": 8.999102719370805e-06, "add_observations_from_episodes_to_batch": 3.631973392539194e-06, "add_states_from_episodes_to_batch": 3.32807110070512e-06, "numpy_to_tensor": 1.8458572403128767e-05, "batch_individual_items": 1.564979061088479e-05}}, "connector_pipeline_timer": 7.574912671477335e-05}, "agent_episode_returns_mean": {"default_agent": 2.18}, "env_step_timer": 2.7350243627396625e-05, "sample": 0.007123886927841475, "num_episodes": 250.0, "num_agent_steps_sampled_lifetime": {"default_agent": -2460000.0}, "num_episodes_lifetime": -123000.0, "env_to_module_sum_episodes_length_in": 10.36823839457432, "num_agent_steps_sampled": {"default_agent": 5000.0}, "num_env_steps_sampled": 5000.0, "num_module_steps_sampled": {"default_policy": 5000.0}, "episode_return_min": -9.5, "episode_duration_sec_mean": 0.007344010638538747, "weights_seq_no": 5.0, "time_between_sampling": 0.034766786719270824, "env_reset_timer": 5.493450109560119e-05, "episode_len_min": 20, "rlmodule_inference_timer": 4.7134256189210464e-05, "num_env_steps_sampled_lifetime_throughput": 2868.8804334913557}, "__all_modules__": {"learner_connector_sum_episodes_length_in": 5000.0, "learner_connector": {"connector_pipeline_timer": 0.15620532726811506, "timers": {"connectors": {"add_one_ts_to_episodes_and_truncate": 0.00904097538897791, "add_observations_from_episodes_to_batch": 0.0008380818144929456, "add_columns_from_episodes_to_train_batch": 0.04144829690395813, "add_time_dim_to_batch_and_zero_pad": 0.09228315625893094, "add_states_from_episodes_to_batch": 0.003749835347802753, "batch_individual_items": 0.008618698641309158, "numpy_to_tensor": 7.181542681831893e-05}}}, "learner_connector_sum_episodes_length_out": 5250.0}, "learners": {"__all_modules__": {"num_non_trainable_parameters": 0, "num_trainable_parameters": 24861, "num_module_steps_trained_lifetime": 71820, "num_env_steps_trained": 36000, "num_module_steps_trained": 11970, "num_env_steps_trained_lifetime": 216000, "num_env_steps_trained_lifetime_throughput": 4661.18479674234, "num_module_steps_trained_throughput": 27480595.586316984, "num_module_steps_trained_lifetime_throughput": 15063206.472579878}, "default_policy": {"vf_explained_var": 0.0006553530693054199, "vf_loss_unclipped": 42.5413932800293, "use_intrinsic_rewards": 0.0, "weights_seq_no": 6.0, "total_loss": 0.24869008362293243, "num_trainable_parameters": 16595, "curr_entropy_coeff": 0.0015431216992, "num_module_steps_trained_lifetime": 35910, "vf_loss": 0.3205487132072449, "diff_num_grad_updates_vs_sampler_policy": 1.0, "curr_kl_coeff": 0.0025247489102184772, "num_module_steps_trained": 5985, "mean_kl_loss": 2.5686440494609997e-06, "module_train_batch_size_mean": 998.5423314844973, "policy_loss": 1.590865576872602e-05, "entropy": 0.680232584476471, "num_module_steps_trained_lifetime_throughput": 774.035710084767}, "intrinsic_reward_module": {"num_module_steps_trained": 5985, "diff_num_grad_updates_vs_sampler_policy": 1.0, "gradients_default_optimizer_global_norm": 0.0, "weights_seq_no": 6.0, "module_train_batch_size_mean": 998.5423314844973, "num_trainable_parameters": 8266, "default_optimizer_learning_rate": 0.0002715581955, "curr_entropy_coeff": 0.0015431216992, "num_module_steps_trained_lifetime": 35910, "total_loss": 0.0, "num_module_steps_trained_lifetime_throughput": 774.0483117406366}, "differentiable_learners": {"intrinsic_attention_ppo_learner": {"default_policy": {"vf_loss_unclipped": 42.468849182128906, "num_module_steps_trained_lifetime": 215460, "total_loss": 0.24877525866031647, "vf_loss": 0.32065218687057495, "mean_kl_loss": 2.8411700441210996e-06, "diff_num_grad_updates_vs_sampler_policy": 31.0, "policy_loss": 2.0020872398163192e-05, "num_module_steps_trained": 35910, "vf_explained_var": 0.002969801425933838, "use_intrinsic_rewards": 1.0, "weights_seq_no": 36.0, "module_train_batch_size_mean": 997.6644392492373, "entropy": 0.680212676525116}, "__all_modules__": {"num_module_steps_trained_lifetime": 430920, "num_env_steps_trained_lifetime": 1296000, "num_env_steps_trained": 216000, "num_module_steps_trained": 71820, "num_env_steps_trained_lifetime_throughput": 58566.9243137015}, "intrinsic_reward_module": {"num_module_steps_trained": 35910, "weights_seq_no": 36.0, "module_train_batch_size_mean": 997.6644392492373, "total_loss": 0.0, "num_module_steps_trained_lifetime": 215460, "diff_num_grad_updates_vs_sampler_policy": 31.0}}}, "IntrinsicAttentionMask": [[[0.16632609069347382, 0.16655892133712769, 0.16645149886608124, 0.16668450832366943, 0.16716879606246948, 0.16681018471717834], [0.16635896265506744, 0.16656933724880219, 0.16647228598594666, 0.16668280959129333, 0.16712027788162231, 0.16679634153842926], [0.1663438230752945, 0.16656453907489777, 0.166462704539299, 0.16668358445167542, 0.16714265942573547, 0.16680273413658142], [0.16637665033340454, 0.16657494008541107, 0.16648346185684204, 0.16668187081813812, 0.1670941263437271, 0.16678886115550995], [0.1664448380470276, 0.16659653186798096, 0.16652655601501465, 0.166678324341774, 0.16699354350566864, 0.1667601466178894], [0.16639438271522522, 0.16658055782318115, 0.16649466753005981, 0.1666809618473053, 0.1670680046081543, 0.16678142547607422]], [[0.16673392057418823, 0.16657531261444092, 0.16678962111473083, 0.16681748628616333, 0.1663970649242401, 0.16668662428855896], [0.16675640642642975, 0.16654475033283234, 0.16683073341846466, 0.1668679267168045, 0.1663069725036621, 0.1666932851076126], [0.1667260378599167, 0.1665860265493393, 0.1667751967906952, 0.16679978370666504, 0.16642868518829346, 0.16668428480625153], [0.16672207415103912, 0.16659137606620789, 0.16676796972751617, 0.1667909175157547, 0.16644448041915894, 0.1666831076145172], [0.16678164899349213, 0.16651034355163574, 0.16687697172164917, 0.16692465543746948, 0.16620565950870514, 0.16670073568820953], [0.16674061119556427, 0.16656619310379028, 0.16680186986923218, 0.16683250665664673, 0.1663701832294464, 0.16668859124183655]], [[0.16734927892684937, 0.16648665070533752, 0.16685186326503754, 0.16658145189285278, 0.1665003001689911, 0.1662304699420929], [0.16777710616588593, 0.16637380421161652, 0.16696736216545105, 0.16652779281139374, 0.16639599204063416, 0.16595792770385742], [0.16759561002254486, 0.16642168164253235, 0.16691841185092926, 0.16655057668685913, 0.1664402335882187, 0.16607345640659332], [0.1677299439907074, 0.16638624668121338, 0.1669546514749527, 0.1665337234735489, 0.1664074808359146, 0.16598793864250183], [0.16777031123638153, 0.16637560725212097, 0.1669655293226242, 0.16652865707874298, 0.16639764606952667, 0.16596224904060364], [0.16790473461151123, 0.16634014248847961, 0.16700172424316406, 0.16651175916194916, 0.166364848613739, 0.16587674617767334]], [[0.16685880720615387, 0.16658411920070648, 0.16650168597698212, 0.16654983162879944, 0.166728675365448, 0.1667768806219101], [0.16689594089984894, 0.16656817495822906, 0.16646982729434967, 0.16652727127075195, 0.16674064099788666, 0.1667981594800949], [0.16690710186958313, 0.16656337678432465, 0.16646026074886322, 0.16652049124240875, 0.16674423217773438, 0.16680456697940826], [0.16690057516098022, 0.1665661782026291, 0.1664658486843109, 0.16652445495128632, 0.16674213111400604, 0.1668008267879486], [0.1668763905763626, 0.1665765643119812, 0.16648660600185394, 0.16653914749622345, 0.16673433780670166, 0.16678695380687714], [0.1668698638677597, 0.16657935082912445, 0.16649217903614044, 0.16654309630393982, 0.16673222184181213, 0.16678321361541748]], [[0.16727450489997864, 0.16596713662147522, 0.16677729785442352, 0.16650702059268951, 0.16687226295471191, 0.16660182178020477], [0.16785266995429993, 0.16530491411685944, 0.1668815016746521, 0.1663547158241272, 0.1670667827129364, 0.16653941571712494], [0.16749371588230133, 0.16571567952632904, 0.16681693494319916, 0.16644932329654694, 0.166946142911911, 0.1665782332420349], [0.167613223195076, 0.16557878255844116, 0.16683846712112427, 0.16641783714294434, 0.16698633134365082, 0.16656534373760223], [0.16745178401470184, 0.1657637506723404, 0.1668093502521515, 0.16646036505699158, 0.16693201661109924, 0.16658276319503784], [0.1675712764263153, 0.16562682390213013, 0.166830912232399, 0.16642887890338898, 0.16697223484516144, 0.16656987369060516]], [[0.16656774282455444, 0.16672810912132263, 0.1670611947774887, 0.16669733822345734, 0.16645124554634094, 0.16649441421031952], [0.1665816307067871, 0.1667194813489914, 0.1670057773590088, 0.16669303178787231, 0.16648146510124207, 0.16651856899261475], [0.16661043465137482, 0.16670162975788116, 0.1668909192085266, 0.1666841357946396, 0.16654416918754578, 0.16656872630119324], [0.1665789783000946, 0.1667211502790451, 0.1670164167881012, 0.16669388115406036, 0.16647568345069885, 0.16651394963264465], [0.16655763983726501, 0.16673436760902405, 0.16710148751735687, 0.16670045256614685, 0.1664292812347412, 0.16647683084011078], [0.16656136512756348, 0.1667320281267166, 0.16708654165267944, 0.16669927537441254, 0.16643740236759186, 0.1664833277463913]]]}, "num_training_step_calls_per_iteration": 1, "evaluation": {"env_runners": {"agent_episode_returns_mean": {"default_agent": 1.45}, "num_agent_steps_sampled": {"default_agent": 400}, "num_agent_steps_sampled_lifetime": {"default_agent": 2400}, "episode_return_min": -13.5, "module_to_env_connector": {"timers": {"connectors": {"remove_single_ts_time_rank_from_batch": 1.4256012936015942e-05, "tensor_to_numpy": 1.7262243707103643e-05, "normalize_and_clip_actions": 8.963320486748226e-06, "listify_data_for_vector_env": 1.1609584025957351e-05, "get_actions": 4.585734881020266e-05, "un_batch_to_individual_items": 7.0781318201624455e-06}}, "connector_pipeline_timer": 0.00013600493246572343}, "rlmodule_inference_timer": 3.729562046665266e-05, "env_step_timer": 1.72091125576443e-05, "num_episodes_lifetime": 120, "env_to_module_sum_episodes_length_in": 10.368238394470474, "num_env_steps_sampled": 400, "env_to_module_connector": {"timers": {"connectors": {"add_observations_from_episodes_to_batch": 3.0824971499860995e-06, "add_time_dim_to_batch_and_zero_pad": 8.059365322217376e-06, "batch_individual_items": 1.586867546550907e-05, "numpy_to_tensor": 1.4606254796723719e-05, "add_states_from_episodes_to_batch": 3.0342091859325882e-06}}, "connector_pipeline_timer": 7.074775775406583e-05}, "num_module_steps_sampled": {"default_policy": 400}, "env_reset_timer": 0.000656023043935753, "num_module_steps_sampled_lifetime": {"default_policy": 2400}, "env_to_module_sum_episodes_length_out": 10.368238394470474, "module_episode_returns_mean": {"default_policy": 1.45}, "episode_return_mean": 1.45, "num_episodes": 20, "episode_len_mean": 20.0, "episode_return_max": 14.5, "num_env_steps_sampled_lifetime": 30400, "sample": 0.12997136009138752, "episode_duration_sec_mean": 0.005622302007395774, "weights_seq_no": 6.0, "episode_len_min": 20, "episode_len_max": 20, "time_between_sampling": 9.878005572047742}, "num_healthy_workers": 1, "actor_manager_num_outstanding_async_reqs": 0, "num_remote_worker_restarts": 0}, "num_env_steps_sampled_lifetime": -2460000.0, "fault_tolerance": {"num_healthy_workers": 0, "num_remote_worker_restarts": 0}, "env_runner_group": {"actor_manager_num_outstanding_async_reqs": 0}, "done": false, "training_iteration": 6, "trial_id": "b1df4_00000", "date": "2025-08-11_18-01-41", "timestamp": 1754928101, "time_this_iter_s": 10.683205842971802, "time_total_s": 61.58659291267395, "pid": 10074, "hostname": "Mac", "node_ip": "127.0.0.1", "config": {"exploration_config": {}, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 2, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "env": "Umbrella", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": false, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 0, "create_local_env_runner": true, "num_envs_per_env_runner": 1, "gym_env_vectorize_mode": "SYNC", "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "episodes_to_numpy": true, "max_requests_in_flight_per_env_runner": 1, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "merge_env_runner_states": "training_only", "broadcast_env_runner_states": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "complete_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "sampler_perf_stats_ema_coef": null, "_is_online": true, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": "auto", "num_aggregator_actors_per_learner": 0, "max_requests_in_flight_per_aggregator_actor": 3, "local_gpu_idx": 0, "max_requests_in_flight_per_learner": 3, "gamma": 1, "lr": 0.0002715581955, "grad_clip": 0.5, "grad_clip_by": "global_norm", "_train_batch_size_per_learner": 5000, "train_batch_size": 4000, "num_epochs": 1, "minibatch_size": 1000, "shuffle_batch_per_epoch": true, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "log_std_clip_param": 20.0, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "_disable_preprocessor_api": false, "_disable_action_flattening": false}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {"intrinsic_reward_coeff": 0.2795015916508}, "optimizer": {}, "_learner_class": "<class 'source.intrinsic_attention_ppo.learners.IntrinsicAttentionMetaLearner.IntrinsicAttentionMetaLearner'>", "callbacks_on_algorithm_init": null, "callbacks_on_env_runners_recreated": null, "callbacks_on_offline_eval_runners_recreated": null, "callbacks_on_checkpoint_loaded": null, "callbacks_on_environment_created": null, "callbacks_on_episode_created": null, "callbacks_on_episode_start": null, "callbacks_on_episode_step": null, "callbacks_on_episode_end": null, "callbacks_on_evaluate_start": null, "callbacks_on_evaluate_end": null, "callbacks_on_evaluate_offline_start": null, "callbacks_on_evaluate_offline_end": null, "callbacks_on_sample_end": null, "callbacks_on_train_result": null, "explore": true, "enable_rl_module_and_learner": true, "enable_env_runner_and_connector_v2": true, "_prior_exploration_config": {"type": "StochasticSampling"}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x3855fd760>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "offline_data_class": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_read_batch_size": null, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "materialize_data": false, "materialize_mapped_data": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "ignore_final_observation": false, "prelearner_class": null, "prelearner_buffer_class": null, "prelearner_buffer_kwargs": {}, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_remaining_data": false, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": 1, "evaluation_duration": 20, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_auto_duration_min_env_steps_per_sample": 100, "evaluation_auto_duration_max_env_steps_per_sample": 2000, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 1, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "offline_evaluation_interval": null, "num_offline_eval_runners": 0, "offline_loss_for_module_fn": null, "offline_evaluation_duration": 1, "offline_evaluation_parallel_to_training": false, "offline_evaluation_timeout_s": 120.0, "num_cpus_per_offline_eval_runner": 1, "num_gpus_per_offline_eval_runner": 0, "custom_resources_per_offline_eval_runner": {}, "restart_failed_offline_eval_runners": true, "ignore_offline_eval_runner_failures": false, "max_num_offline_eval_runner_restarts": 1000, "offline_eval_runner_restore_timeout_s": 1800.0, "max_requests_in_flight_per_offline_eval_runner": 1, "validate_offline_eval_runners_after_construction": true, "offline_eval_runner_health_probe_timeout_s": 30.0, "offline_eval_rl_module_inference_only": false, "broadcast_offline_eval_runner_states": false, "offline_eval_batch_size_per_runner": 256, "dataset_num_iters_per_eval_runner": 1, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "log_gradients": false, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 6, "restart_failed_env_runners": true, "ignore_env_runner_failures": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30.0, "env_runner_restore_timeout_s": 1800.0, "_model_config": {}, "_rl_module_spec": "MultiRLModuleSpec(multi_rl_module_class=<class 'ray.rllib.core.rl_module.multi_rl_module.MultiRLModule'>, observation_space=None, action_space=None, inference_only=False, model_config=None, rl_module_specs={'default_policy': RLModuleSpec(module_class=<class 'source.intrinsic_attention_ppo.rl_modules.DifferentiablePPOModule.DifferentiablePPOModule'>, observation_space=None, action_space=None, inference_only=False, learner_only=False, model_config={'vf_share_layers': True, 'embedding_dim': 62, 'max_seq_len': 6, 'policy_head_hidden_sizes': [32], 'value_head_hidden_sizes': [101], 'embedding_hidden_sizes': [121]}, catalog_class=None, load_state_path=None, model_config_dict=None), 'intrinsic_reward_module': RLModuleSpec(module_class=<class 'source.intrinsic_attention_ppo.rl_modules.IntrinsicAttentionModule.IntrinsicAttentionModule'>, observation_space=None, action_space=None, inference_only=False, learner_only=True, model_config={'intrinsic_reward_network': {'encoder_hidden_sizes': [], 'encoding_dim': 1, 'num_heads': 1, 'head_hidden_sizes': None, 'layers': [{'type': 'attention'}]}, 'extrinsic_value_hidden_layers': [127, 60], 'vf_share_layers': True, 'max_seq_len': 6}, catalog_class=None, load_state_path=None, model_config_dict=None)}, load_state_path=None, modules_to_load=None, module_specs={'default_policy': RLModuleSpec(module_class=<class 'source.intrinsic_attention_ppo.rl_modules.DifferentiablePPOModule.DifferentiablePPOModule'>, observation_space=None, action_space=None, inference_only=False, learner_only=False, model_config={'vf_share_layers': True, 'embedding_dim': 62, 'max_seq_len': 6, 'policy_head_hidden_sizes': [32], 'value_head_hidden_sizes': [101], 'embedding_hidden_sizes': [121]}, catalog_class=None, load_state_path=None, model_config_dict=None), 'intrinsic_reward_module': RLModuleSpec(module_class=<class 'source.intrinsic_attention_ppo.rl_modules.IntrinsicAttentionModule.IntrinsicAttentionModule'>, observation_space=None, action_space=None, inference_only=False, learner_only=True, model_config={'intrinsic_reward_network': {'encoder_hidden_sizes': [], 'encoding_dim': 1, 'num_heads': 1, 'head_hidden_sizes': None, 'layers': [{'type': 'attention'}]}, 'extrinsic_value_hidden_layers': [127, 60], 'vf_share_layers': True, 'max_seq_len': 6}, catalog_class=None, load_state_path=None, model_config_dict=None)})", "algorithm_config_overrides_per_module": {"intrinsic_reward_module": {"lr": 0.0002715581955}}, "_per_module_overrides": {}, "_validate_config": true, "_use_msgpack_checkpoints": false, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "env_task_fn": -1, "enable_connectors": -1, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.161583927863, "kl_target": 0.0201019014258, "vf_loss_coeff": 0.7790510010087, "entropy_coeff": 0.0015431216992, "clip_param": 0.2459212356676, "vf_clip_param": 0.3769744131561, "entropy_coeff_schedule": null, "lr_schedule": null, "sgd_minibatch_size": -1, "vf_share_layers": -1, "differentiable_learner_configs": ["DifferentiableLearnerConfig(learner_class=<class 'source.intrinsic_attention_ppo.learners.IntrinsicAttentionPPOLearner.IntrinsicAttentionPPOLearner'>, learner_connector=None, add_default_connectors_to_learner_pipeline=True, is_multi_agent=False, policies_to_update=['default_policy'], lr=0.0060984166342, num_total_minibatches=0, num_epochs=1, minibatch_size=1000, shuffle_batch_per_epoch=True)"], "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9485408017724, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.callbacks.callbacks.RLlibCallback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 61.58659291267395, "iterations_since_restore": 6, "perf": {"cpu_util_percent": 50.75333333333334, "ram_util_percent": 81.79999999999998}}
{"timers": {"training_iteration": 10.527486137795414, "restore_env_runners": 9.762897752516643e-06, "training_step": 10.527235728717255, "env_runner_sampling_timer": 1.7226582249689981, "learner_update_timer": 8.608851881397023, "synch_weights": 0.0018159458839642412, "restore_eval_env_runners": 7.638396253753499e-05, "evaluation_iteration": 0.14174997081558388, "synch_eval_env_connectors": 0.00021784769174595686, "synch_env_connectors": 5.240004594624647e-06}, "env_runners": {"episode_return_max": 10.5, "module_to_env_connector": {"timers": {"connectors": {"tensor_to_numpy": 1.6151944279252242e-05, "normalize_and_clip_actions": 8.445672538415932e-06, "un_batch_to_individual_items": 6.947021140789002e-06, "listify_data_for_vector_env": 1.1058341767003571e-05, "get_actions": 4.1675018148531346e-05, "remove_single_ts_time_rank_from_batch": 1.2386327867309141e-05}}, "connector_pipeline_timer": 0.00012458786332193567}, "episode_len_mean": 20.0, "episode_len_max": 20, "num_module_steps_sampled_lifetime": {"default_policy": -3077500.0}, "num_env_steps_sampled_lifetime": -3077500.0, "module_episode_returns_mean": {"default_policy": 3.06}, "env_to_module_sum_episodes_length_out": 10.36823839457432, "episode_return_mean": 3.06, "env_to_module_connector": {"timers": {"connectors": {"add_time_dim_to_batch_and_zero_pad": 7.4170796682522016e-06, "add_observations_from_episodes_to_batch": 2.9797287524633564e-06, "add_states_from_episodes_to_batch": 2.883587823837807e-06, "numpy_to_tensor": 1.348911094898457e-05, "batch_individual_items": 1.3159510376991494e-05}}, "connector_pipeline_timer": 6.289458672745378e-05}, "agent_episode_returns_mean": {"default_agent": 3.06}, "env_step_timer": 1.4740623399792875e-05, "sample": 0.00653941147238484, "num_episodes": 250.0, "num_agent_steps_sampled_lifetime": {"default_agent": -3077500.0}, "num_episodes_lifetime": -153875.0, "env_to_module_sum_episodes_length_in": 10.36823839457432, "num_agent_steps_sampled": {"default_agent": 5000.0}, "num_env_steps_sampled": 5000.0, "num_module_steps_sampled": {"default_policy": 5000.0}, "episode_return_min": -9.5, "episode_duration_sec_mean": 0.005553916987031698, "weights_seq_no": 6.0, "time_between_sampling": 0.03490892092186707, "env_reset_timer": 5.056463806483855e-05, "episode_len_min": 20, "rlmodule_inference_timer": 3.357087243210971e-05, "num_env_steps_sampled_lifetime_throughput": 3075.922546021278}, "__all_modules__": {"learner_connector_sum_episodes_length_in": 5000.0, "learner_connector": {"connector_pipeline_timer": 0.1561773723356323, "timers": {"connectors": {"add_one_ts_to_episodes_and_truncate": 0.009039553964604857, "add_observations_from_episodes_to_batch": 0.000838162666133918, "add_columns_from_episodes_to_train_batch": 0.0414561756049805, "add_time_dim_to_batch_and_zero_pad": 0.09226165094592804, "add_states_from_episodes_to_batch": 0.003749973244815048, "batch_individual_items": 0.008606348324221894, "numpy_to_tensor": 7.170727253836382e-05}}}, "learner_connector_sum_episodes_length_out": 5250.0}, "learners": {"__all_modules__": {"num_non_trainable_parameters": 0, "num_trainable_parameters": 24861, "num_module_steps_trained_lifetime": 83790, "num_env_steps_trained": 36000, "num_module_steps_trained": 11970, "num_env_steps_trained_lifetime": 252000, "num_env_steps_trained_lifetime_throughput": 4635.627284936138, "num_module_steps_trained_throughput": 26721400.306850195, "num_module_steps_trained_lifetime_throughput": 14921033.068858135}, "default_policy": {"vf_explained_var": 0.0011126399040222168, "vf_loss_unclipped": 42.630836486816406, "use_intrinsic_rewards": 0.0, "weights_seq_no": 7.0, "total_loss": 0.24862001836299896, "num_trainable_parameters": 16595, "curr_entropy_coeff": 0.0015431216992, "num_module_steps_trained_lifetime": 41895, "vf_loss": 0.32052597403526306, "diff_num_grad_updates_vs_sampler_policy": 1.0, "curr_kl_coeff": 0.0012623744551092386, "num_module_steps_trained": 5985, "mean_kl_loss": 6.108829779805092e-07, "module_train_batch_size_mean": 998.4808932973482, "policy_loss": -3.6085206374991685e-05, "entropy": 0.6804113984107971, "num_module_steps_trained_lifetime_throughput": 769.817721530885}, "intrinsic_reward_module": {"num_module_steps_trained": 5985, "diff_num_grad_updates_vs_sampler_policy": 1.0, "gradients_default_optimizer_global_norm": 0.0, "weights_seq_no": 7.0, "module_train_batch_size_mean": 998.4808932973482, "num_trainable_parameters": 8266, "default_optimizer_learning_rate": 0.0002715581955, "curr_entropy_coeff": 0.0015431216992, "num_module_steps_trained_lifetime": 41895, "total_loss": 0.0, "num_module_steps_trained_lifetime_throughput": 769.8297867271135}, "differentiable_learners": {"intrinsic_attention_ppo_learner": {"default_policy": {"vf_loss_unclipped": 42.58675003051758, "num_module_steps_trained_lifetime": 251370, "total_loss": 0.24870604276657104, "vf_loss": 0.32063451409339905, "mean_kl_loss": 5.486905365614803e-07, "diff_num_grad_updates_vs_sampler_policy": 36.0, "policy_loss": -3.4751770726870745e-05, "num_module_steps_trained": 35910, "vf_explained_var": 0.002862870693206787, "use_intrinsic_rewards": 1.0, "weights_seq_no": 42.0, "module_train_batch_size_mean": 997.6122293241576, "entropy": 0.6804033517837524}, "__all_modules__": {"num_module_steps_trained_lifetime": 502740, "num_env_steps_trained_lifetime": 1512000, "num_env_steps_trained": 216000, "num_module_steps_trained": 71820, "num_env_steps_trained_lifetime_throughput": 57566.07814438639}, "intrinsic_reward_module": {"num_module_steps_trained": 35910, "weights_seq_no": 42.0, "module_train_batch_size_mean": 997.6122293241576, "total_loss": 0.0, "num_module_steps_trained_lifetime": 251370, "diff_num_grad_updates_vs_sampler_policy": 36.0}}}, "IntrinsicAttentionMask": [[[0.1664242148399353, 0.1660671979188919, 0.1665496975183487, 0.16678284108638763, 0.16726741194725037, 0.16690859198570251], [0.16638824343681335, 0.16597847640514374, 0.16653230786323547, 0.16679999232292175, 0.16735656559467316, 0.16694439947605133], [0.16643686592578888, 0.16609837114810944, 0.16655582189559937, 0.16677682101726532, 0.16723614931106567, 0.1668960303068161], [0.16646027565002441, 0.16615618765354156, 0.1665671467781067, 0.16676564514636993, 0.16717810928821564, 0.16687269508838654], [0.16650882363319397, 0.16627611219882965, 0.16659057140350342, 0.16674239933490753, 0.16705773770809174, 0.16682425141334534], [0.1664728969335556, 0.1661873310804367, 0.16657322645187378, 0.16675959527492523, 0.16714683175086975, 0.16686011850833893]], [[0.16642117500305176, 0.16605991125106812, 0.16714690625667572, 0.1672106683254242, 0.16624999046325684, 0.166911318898201], [0.16638515889644623, 0.16597113013267517, 0.16721726953983307, 0.16729038953781128, 0.16618895530700684, 0.16694708168506622], [0.1664932668209076, 0.1662377417087555, 0.16700607538223267, 0.16705109179019928, 0.16637220978736877, 0.16683967411518097], [0.1664995551109314, 0.16625331342220306, 0.16699370741844177, 0.16703708469867706, 0.16638289391994476, 0.16683337092399597], [0.1664041131734848, 0.16601786017417908, 0.16718022525310516, 0.1672484129667282, 0.16622108221054077, 0.1669282615184784], [0.16646990180015564, 0.1661800891160965, 0.16705173254013062, 0.16710281372070312, 0.16633260250091553, 0.16686290502548218]], [[0.16632597148418427, 0.16655878722667694, 0.16704271733760834, 0.1666843742132187, 0.16716866195201874, 0.1662195324897766], [0.1663588434457779, 0.16656921803951263, 0.16700640320777893, 0.1666826754808426, 0.16712015867233276, 0.1662626564502716], [0.16642706096172333, 0.1665908545255661, 0.16693110764026642, 0.16667917370796204, 0.16701960563659668, 0.16635215282440186], [0.16637657582759857, 0.1665748506784439, 0.1669868379831314, 0.16668178141117096, 0.16709403693675995, 0.166285902261734], [0.1664447784423828, 0.16659647226333618, 0.1669115424156189, 0.1666782647371292, 0.16699348390102386, 0.16637539863586426], [0.16631090641021729, 0.16655398905277252, 0.16705933213233948, 0.16668513417243958, 0.16719084978103638, 0.16619977355003357]], [[0.16682127118110657, 0.16640083491802216, 0.16687700152397156, 0.16664275527000427, 0.1667460948228836, 0.16651204228401184], [0.16695831716060638, 0.1661653369665146, 0.16706356406211853, 0.16662141680717468, 0.16681639850139618, 0.16637490689754486], [0.16680312156677246, 0.16643202304840088, 0.16685231029987335, 0.1666455715894699, 0.16673678159713745, 0.16653019189834595], [0.16687943041324615, 0.1663009077310562, 0.16695615649223328, 0.1666337251663208, 0.16677594184875488, 0.16645386815071106], [0.16684575378894806, 0.16635875403881073, 0.166910320520401, 0.16663895547389984, 0.16675865650177002, 0.16648754477500916], [0.16692204773426056, 0.16622769832611084, 0.16701418161392212, 0.16662709414958954, 0.16679781675338745, 0.16641122102737427]], [[0.16632597148418427, 0.16655878722667694, 0.16704271733760834, 0.1666843742132187, 0.16716866195201874, 0.1662195324897766], [0.1663588434457779, 0.16656921803951263, 0.16700640320777893, 0.1666826754808426, 0.16712015867233276, 0.1662626564502716], [0.16642706096172333, 0.1665908545255661, 0.16693110764026642, 0.16667917370796204, 0.16701960563659668, 0.16635215282440186], [0.16637657582759857, 0.1665748506784439, 0.1669868379831314, 0.16668178141117096, 0.16709403693675995, 0.166285902261734], [0.1664447784423828, 0.16659647226333618, 0.1669115424156189, 0.1666782647371292, 0.16699348390102386, 0.16637539863586426], [0.16631090641021729, 0.16655398905277252, 0.16705933213233948, 0.16668513417243958, 0.16719084978103638, 0.16619977355003357]], [[0.166520893573761, 0.16615940630435944, 0.16664794087409973, 0.16731084883213043, 0.1663496047258377, 0.1670113205909729], [0.16649946570396423, 0.1660851538181305, 0.1666451245546341, 0.16740532219409943, 0.1663031429052353, 0.16706179082393646], [0.1665283888578415, 0.16618545353412628, 0.16664890944957733, 0.16727769374847412, 0.16636589169502258, 0.16699360311031342], [0.16656747460365295, 0.16632112860679626, 0.16665400564670563, 0.16710521280765533, 0.16645075380802155, 0.16690140962600708], [0.16651076078414917, 0.16612425446510315, 0.16664661467075348, 0.16735559701919556, 0.1663276106119156, 0.16703523695468903], [0.16654983162879944, 0.16625986993312836, 0.16665171086788177, 0.1671830415725708, 0.16641245782375336, 0.1669430136680603]]]}, "num_training_step_calls_per_iteration": 1, "evaluation": {"env_runners": {"agent_episode_returns_mean": {"default_agent": 1.05}, "num_agent_steps_sampled": {"default_agent": 400}, "num_agent_steps_sampled_lifetime": {"default_agent": 2800}, "episode_return_min": -13.5, "module_to_env_connector": {"timers": {"connectors": {"remove_single_ts_time_rank_from_batch": 1.208705812717493e-05, "tensor_to_numpy": 1.5113070304403049e-05, "normalize_and_clip_actions": 7.828350132815133e-06, "listify_data_for_vector_env": 1.0425052682234466e-05, "get_actions": 3.652413376371137e-05, "un_batch_to_individual_items": 6.541950134863806e-06}}, "connector_pipeline_timer": 0.00011485913993742396}, "rlmodule_inference_timer": 3.1048096455965026e-05, "env_step_timer": 1.3810238158620908e-05, "num_episodes_lifetime": 140, "env_to_module_sum_episodes_length_in": 10.368238394572801, "num_env_steps_sampled": 400, "env_to_module_connector": {"timers": {"connectors": {"add_observations_from_episodes_to_batch": 2.776807574621984e-06, "add_time_dim_to_batch_and_zero_pad": 6.963562712000372e-06, "batch_individual_items": 1.2327210658746937e-05, "numpy_to_tensor": 1.2223424430074719e-05, "add_states_from_episodes_to_batch": 2.680563637690412e-06}}, "connector_pipeline_timer": 5.932404761552768e-05}, "num_module_steps_sampled": {"default_policy": 400}, "env_reset_timer": 0.000653073233304351, "num_module_steps_sampled_lifetime": {"default_policy": 2800}, "env_to_module_sum_episodes_length_out": 10.368238394572801, "module_episode_returns_mean": {"default_policy": 1.05}, "episode_return_mean": 1.05, "num_episodes": 20, "episode_len_mean": 20.0, "episode_return_max": 14.5, "num_env_steps_sampled_lifetime": 35400, "sample": 0.1298442177402455, "episode_duration_sec_mean": 0.005587406549602747, "weights_seq_no": 7.0, "episode_len_min": 20, "episode_len_max": 20, "time_between_sampling": 9.879941077997051}, "num_healthy_workers": 1, "actor_manager_num_outstanding_async_reqs": 0, "num_remote_worker_restarts": 0}, "num_env_steps_sampled_lifetime": -3077500.0, "fault_tolerance": {"num_healthy_workers": 0, "num_remote_worker_restarts": 0}, "env_runner_group": {"actor_manager_num_outstanding_async_reqs": 0}, "done": false, "training_iteration": 7, "trial_id": "b1df4_00000", "date": "2025-08-11_18-01-51", "timestamp": 1754928111, "time_this_iter_s": 10.168265104293823, "time_total_s": 71.75485801696777, "pid": 10074, "hostname": "Mac", "node_ip": "127.0.0.1", "config": {"exploration_config": {}, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 2, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "env": "Umbrella", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": false, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 0, "create_local_env_runner": true, "num_envs_per_env_runner": 1, "gym_env_vectorize_mode": "SYNC", "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "episodes_to_numpy": true, "max_requests_in_flight_per_env_runner": 1, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "merge_env_runner_states": "training_only", "broadcast_env_runner_states": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "complete_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "sampler_perf_stats_ema_coef": null, "_is_online": true, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": "auto", "num_aggregator_actors_per_learner": 0, "max_requests_in_flight_per_aggregator_actor": 3, "local_gpu_idx": 0, "max_requests_in_flight_per_learner": 3, "gamma": 1, "lr": 0.0002715581955, "grad_clip": 0.5, "grad_clip_by": "global_norm", "_train_batch_size_per_learner": 5000, "train_batch_size": 4000, "num_epochs": 1, "minibatch_size": 1000, "shuffle_batch_per_epoch": true, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "log_std_clip_param": 20.0, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "_disable_preprocessor_api": false, "_disable_action_flattening": false}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {"intrinsic_reward_coeff": 0.2795015916508}, "optimizer": {}, "_learner_class": "<class 'source.intrinsic_attention_ppo.learners.IntrinsicAttentionMetaLearner.IntrinsicAttentionMetaLearner'>", "callbacks_on_algorithm_init": null, "callbacks_on_env_runners_recreated": null, "callbacks_on_offline_eval_runners_recreated": null, "callbacks_on_checkpoint_loaded": null, "callbacks_on_environment_created": null, "callbacks_on_episode_created": null, "callbacks_on_episode_start": null, "callbacks_on_episode_step": null, "callbacks_on_episode_end": null, "callbacks_on_evaluate_start": null, "callbacks_on_evaluate_end": null, "callbacks_on_evaluate_offline_start": null, "callbacks_on_evaluate_offline_end": null, "callbacks_on_sample_end": null, "callbacks_on_train_result": null, "explore": true, "enable_rl_module_and_learner": true, "enable_env_runner_and_connector_v2": true, "_prior_exploration_config": {"type": "StochasticSampling"}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x3855fd760>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "offline_data_class": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_read_batch_size": null, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "materialize_data": false, "materialize_mapped_data": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "ignore_final_observation": false, "prelearner_class": null, "prelearner_buffer_class": null, "prelearner_buffer_kwargs": {}, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_remaining_data": false, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": 1, "evaluation_duration": 20, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_auto_duration_min_env_steps_per_sample": 100, "evaluation_auto_duration_max_env_steps_per_sample": 2000, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 1, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "offline_evaluation_interval": null, "num_offline_eval_runners": 0, "offline_loss_for_module_fn": null, "offline_evaluation_duration": 1, "offline_evaluation_parallel_to_training": false, "offline_evaluation_timeout_s": 120.0, "num_cpus_per_offline_eval_runner": 1, "num_gpus_per_offline_eval_runner": 0, "custom_resources_per_offline_eval_runner": {}, "restart_failed_offline_eval_runners": true, "ignore_offline_eval_runner_failures": false, "max_num_offline_eval_runner_restarts": 1000, "offline_eval_runner_restore_timeout_s": 1800.0, "max_requests_in_flight_per_offline_eval_runner": 1, "validate_offline_eval_runners_after_construction": true, "offline_eval_runner_health_probe_timeout_s": 30.0, "offline_eval_rl_module_inference_only": false, "broadcast_offline_eval_runner_states": false, "offline_eval_batch_size_per_runner": 256, "dataset_num_iters_per_eval_runner": 1, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "log_gradients": false, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 6, "restart_failed_env_runners": true, "ignore_env_runner_failures": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30.0, "env_runner_restore_timeout_s": 1800.0, "_model_config": {}, "_rl_module_spec": "MultiRLModuleSpec(multi_rl_module_class=<class 'ray.rllib.core.rl_module.multi_rl_module.MultiRLModule'>, observation_space=None, action_space=None, inference_only=False, model_config=None, rl_module_specs={'default_policy': RLModuleSpec(module_class=<class 'source.intrinsic_attention_ppo.rl_modules.DifferentiablePPOModule.DifferentiablePPOModule'>, observation_space=None, action_space=None, inference_only=False, learner_only=False, model_config={'vf_share_layers': True, 'embedding_dim': 62, 'max_seq_len': 6, 'policy_head_hidden_sizes': [32], 'value_head_hidden_sizes': [101], 'embedding_hidden_sizes': [121]}, catalog_class=None, load_state_path=None, model_config_dict=None), 'intrinsic_reward_module': RLModuleSpec(module_class=<class 'source.intrinsic_attention_ppo.rl_modules.IntrinsicAttentionModule.IntrinsicAttentionModule'>, observation_space=None, action_space=None, inference_only=False, learner_only=True, model_config={'intrinsic_reward_network': {'encoder_hidden_sizes': [], 'encoding_dim': 1, 'num_heads': 1, 'head_hidden_sizes': None, 'layers': [{'type': 'attention'}]}, 'extrinsic_value_hidden_layers': [127, 60], 'vf_share_layers': True, 'max_seq_len': 6}, catalog_class=None, load_state_path=None, model_config_dict=None)}, load_state_path=None, modules_to_load=None, module_specs={'default_policy': RLModuleSpec(module_class=<class 'source.intrinsic_attention_ppo.rl_modules.DifferentiablePPOModule.DifferentiablePPOModule'>, observation_space=None, action_space=None, inference_only=False, learner_only=False, model_config={'vf_share_layers': True, 'embedding_dim': 62, 'max_seq_len': 6, 'policy_head_hidden_sizes': [32], 'value_head_hidden_sizes': [101], 'embedding_hidden_sizes': [121]}, catalog_class=None, load_state_path=None, model_config_dict=None), 'intrinsic_reward_module': RLModuleSpec(module_class=<class 'source.intrinsic_attention_ppo.rl_modules.IntrinsicAttentionModule.IntrinsicAttentionModule'>, observation_space=None, action_space=None, inference_only=False, learner_only=True, model_config={'intrinsic_reward_network': {'encoder_hidden_sizes': [], 'encoding_dim': 1, 'num_heads': 1, 'head_hidden_sizes': None, 'layers': [{'type': 'attention'}]}, 'extrinsic_value_hidden_layers': [127, 60], 'vf_share_layers': True, 'max_seq_len': 6}, catalog_class=None, load_state_path=None, model_config_dict=None)})", "algorithm_config_overrides_per_module": {"intrinsic_reward_module": {"lr": 0.0002715581955}}, "_per_module_overrides": {}, "_validate_config": true, "_use_msgpack_checkpoints": false, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "env_task_fn": -1, "enable_connectors": -1, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.161583927863, "kl_target": 0.0201019014258, "vf_loss_coeff": 0.7790510010087, "entropy_coeff": 0.0015431216992, "clip_param": 0.2459212356676, "vf_clip_param": 0.3769744131561, "entropy_coeff_schedule": null, "lr_schedule": null, "sgd_minibatch_size": -1, "vf_share_layers": -1, "differentiable_learner_configs": ["DifferentiableLearnerConfig(learner_class=<class 'source.intrinsic_attention_ppo.learners.IntrinsicAttentionPPOLearner.IntrinsicAttentionPPOLearner'>, learner_connector=None, add_default_connectors_to_learner_pipeline=True, is_multi_agent=False, policies_to_update=['default_policy'], lr=0.0060984166342, num_total_minibatches=0, num_epochs=1, minibatch_size=1000, shuffle_batch_per_epoch=True)"], "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9485408017724, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.callbacks.callbacks.RLlibCallback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 71.75485801696777, "iterations_since_restore": 7, "perf": {"cpu_util_percent": 43.059999999999995, "ram_util_percent": 82.05999999999999}}
{"timers": {"training_iteration": 10.544275754337527, "restore_env_runners": 9.731518406336749e-06, "training_step": 10.54402480309063, "env_runner_sampling_timer": 1.721440384798447, "learner_update_timer": 8.626282257582341, "synch_weights": 0.0018162276749738736, "restore_eval_env_runners": 7.573095262684532e-05, "evaluation_iteration": 0.14159060693771308, "synch_eval_env_connectors": 0.00021711046445239198, "synch_env_connectors": 5.228444207728507e-06}, "env_runners": {"episode_return_max": 10.5, "module_to_env_connector": {"timers": {"connectors": {"tensor_to_numpy": 1.5754093892087822e-05, "normalize_and_clip_actions": 8.46765762661793e-06, "un_batch_to_individual_items": 6.808232899130207e-06, "listify_data_for_vector_env": 1.0892938133877314e-05, "get_actions": 4.035877972922485e-05, "remove_single_ts_time_rank_from_batch": 1.2268528281089108e-05}}, "connector_pipeline_timer": 0.00012187532380548916}, "episode_len_mean": 20.0, "episode_len_max": 20, "num_module_steps_sampled_lifetime": {"default_policy": -3695000.0}, "num_env_steps_sampled_lifetime": -3695000.0, "module_episode_returns_mean": {"default_policy": 1.3000000000000003}, "env_to_module_sum_episodes_length_out": 10.36823839457432, "episode_return_mean": 1.3000000000000003, "env_to_module_connector": {"timers": {"connectors": {"add_time_dim_to_batch_and_zero_pad": 7.300426581659485e-06, "add_observations_from_episodes_to_batch": 2.933391339714245e-06, "add_states_from_episodes_to_batch": 2.8438423488279e-06, "numpy_to_tensor": 1.3287734524653085e-05, "batch_individual_items": 1.3024446365147548e-05}}, "connector_pipeline_timer": 6.209889721384811e-05}, "agent_episode_returns_mean": {"default_agent": 1.3000000000000003}, "env_step_timer": 1.452690184349919e-05, "sample": 0.005784144451720661, "num_episodes": 250.0, "num_agent_steps_sampled_lifetime": {"default_agent": -3695000.0}, "num_episodes_lifetime": -184750.0, "env_to_module_sum_episodes_length_in": 10.36823839457432, "num_agent_steps_sampled": {"default_agent": 5000.0}, "num_env_steps_sampled": 5000.0, "num_module_steps_sampled": {"default_policy": 5000.0}, "episode_return_min": -9.5, "episode_duration_sec_mean": 0.005496595543343573, "weights_seq_no": 7.0, "time_between_sampling": 0.03486541814966302, "env_reset_timer": 4.110132263458726e-05, "episode_len_min": 20, "rlmodule_inference_timer": 3.275511240170937e-05, "num_env_steps_sampled_lifetime_throughput": 3186.784151091926}, "__all_modules__": {"learner_connector_sum_episodes_length_in": 5000.0, "learner_connector": {"connector_pipeline_timer": 0.15655824944288196, "timers": {"connectors": {"add_one_ts_to_episodes_and_truncate": 0.00905680675569944, "add_observations_from_episodes_to_batch": 0.0008394651993586708, "add_columns_from_episodes_to_train_batch": 0.04152257842971432, "add_time_dim_to_batch_and_zero_pad": 0.09252519235663376, "add_states_from_episodes_to_batch": 0.0037636830920544633, "batch_individual_items": 0.008624673171344275, "numpy_to_tensor": 7.182435983169246e-05}}}, "learner_connector_sum_episodes_length_out": 5250.0}, "learners": {"__all_modules__": {"num_non_trainable_parameters": 0, "num_trainable_parameters": 24861, "num_module_steps_trained_lifetime": 95760, "num_env_steps_trained": 36000, "num_module_steps_trained": 11970, "num_env_steps_trained_lifetime": 288000, "num_env_steps_trained_lifetime_throughput": 4600.354469089563, "num_module_steps_trained_throughput": 25930356.18337577, "num_module_steps_trained_lifetime_throughput": 14739945.908315865}, "default_policy": {"vf_explained_var": 0.0002187490463256836, "vf_loss_unclipped": 42.76200866699219, "use_intrinsic_rewards": 0.0, "weights_seq_no": 8.0, "total_loss": 0.24847383797168732, "num_trainable_parameters": 16595, "curr_entropy_coeff": 0.0015431216992, "num_module_steps_trained_lifetime": 47880, "vf_loss": 0.3205123245716095, "diff_num_grad_updates_vs_sampler_policy": 1.0, "curr_kl_coeff": 0.0006311872275546193, "num_module_steps_trained": 5985, "mean_kl_loss": 3.3239450658584246e-06, "module_train_batch_size_mean": 998.4230504637324, "policy_loss": -0.00017223504255525768, "entropy": 0.6800419092178345, "num_module_steps_trained_lifetime_throughput": 763.9858967726166}, "intrinsic_reward_module": {"num_module_steps_trained": 5985, "diff_num_grad_updates_vs_sampler_policy": 1.0, "gradients_default_optimizer_global_norm": 0.0, "weights_seq_no": 8.0, "module_train_batch_size_mean": 998.4230504637324, "num_trainable_parameters": 8266, "default_optimizer_learning_rate": 0.0002715581955, "curr_entropy_coeff": 0.0015431216992, "num_module_steps_trained_lifetime": 47880, "total_loss": 0.0, "num_module_steps_trained_lifetime_throughput": 763.9974173184592}, "differentiable_learners": {"intrinsic_attention_ppo_learner": {"default_policy": {"vf_loss_unclipped": 42.69804000854492, "num_module_steps_trained_lifetime": 287280, "total_loss": 0.24857018887996674, "vf_loss": 0.3206178545951843, "mean_kl_loss": 2.710821490836679e-06, "diff_num_grad_updates_vs_sampler_policy": 41.0, "policy_loss": -0.0001584467536304146, "num_module_steps_trained": 35910, "vf_explained_var": 0.002826869487762451, "use_intrinsic_rewards": 1.0, "weights_seq_no": 48.0, "module_train_batch_size_mean": 997.5758696422192, "entropy": 0.6800832152366638}, "__all_modules__": {"num_module_steps_trained_lifetime": 574560, "num_env_steps_trained_lifetime": 1728000, "num_env_steps_trained": 216000, "num_module_steps_trained": 71820, "num_env_steps_trained_lifetime_throughput": 56536.18823090185}, "intrinsic_reward_module": {"num_module_steps_trained": 35910, "weights_seq_no": 48.0, "module_train_batch_size_mean": 997.5758696422192, "total_loss": 0.0, "num_module_steps_trained_lifetime": 287280, "diff_num_grad_updates_vs_sampler_policy": 41.0}}}, "IntrinsicAttentionMask": [[[0.16742375493049622, 0.16611522436141968, 0.16647960245609283, 0.16620980203151703, 0.16702115535736084, 0.1667504757642746], [0.16814444959163666, 0.1655922681093216, 0.16630107164382935, 0.1657761037349701, 0.1673571914434433, 0.16682890057563782], [0.16794298589229584, 0.16573823988437653, 0.16635102033615112, 0.1658972203731537, 0.16726338863372803, 0.1668071150779724], [0.16809210181236267, 0.16563019156455994, 0.1663140505552292, 0.1658075749874115, 0.16733284294605255, 0.16682325303554535], [0.1676446795463562, 0.16595469415187836, 0.1664249300956726, 0.16607671976089478, 0.16712431609630585, 0.16677464544773102], [0.1677936315536499, 0.16584660112857819, 0.16638803482055664, 0.16598708927631378, 0.16719380021095276, 0.1667908877134323]], [[0.16678301990032196, 0.16650845110416412, 0.16687949001789093, 0.1669277399778366, 0.16620013117790222, 0.16670112311840057], [0.1668054610490799, 0.16647787392139435, 0.16692058742046356, 0.16697818040847778, 0.1661101132631302, 0.16670773923397064], [0.1667751520872116, 0.1665191948413849, 0.16686508059501648, 0.1669100522994995, 0.16623175144195557, 0.16669881343841553], [0.16677120327949524, 0.16652455925941467, 0.16685785353183746, 0.16690120100975037, 0.16624754667282104, 0.1666976511478424], [0.16683071851730347, 0.16644346714019775, 0.16696684062480927, 0.16703493893146515, 0.16600891947746277, 0.16671518981456757], [0.1667897254228592, 0.16649934649467468, 0.16689175367355347, 0.1669427901506424, 0.1661733090877533, 0.16670310497283936]], [[0.16727453470230103, 0.16641229391098022, 0.1667773276567459, 0.166061669588089, 0.1668722927570343, 0.16660185158252716], [0.16765528917312622, 0.166253000497818, 0.1668461263179779, 0.16568408906459808, 0.16700056195259094, 0.16656091809272766], [0.1674937903881073, 0.1663205772638321, 0.16681700944900513, 0.1658441126346588, 0.16694621741771698, 0.16657830774784088], [0.1678108423948288, 0.16618795692920685, 0.16687412559986115, 0.16553013026714325, 0.16705285012722015, 0.1665441244840622], [0.1674518585205078, 0.16633811593055725, 0.16680942475795746, 0.16588570177555084, 0.1669320911169052, 0.1665828377008438], [0.16757136583328247, 0.1662881076335907, 0.16683100163936615, 0.16576722264289856, 0.1669723242521286, 0.16656996309757233]], [[0.16678304970264435, 0.1665084809064865, 0.16687951982021332, 0.166927769780159, 0.16665296256542206, 0.16624821722507477], [0.16680550575256348, 0.16647791862487793, 0.16692063212394714, 0.16697822511196136, 0.16665029525756836, 0.1661674827337265], [0.1667751669883728, 0.16651920974254608, 0.16686509549617767, 0.1669100672006607, 0.16665391623973846, 0.16627657413482666], [0.16677120327949524, 0.16652455925941467, 0.16685785353183746, 0.16690120100975037, 0.16665436327457428, 0.16629073023796082], [0.16679370403289795, 0.16649401187896729, 0.16689899563789368, 0.16695167124271393, 0.16665171086788177, 0.16620998084545135], [0.16682681441307068, 0.16644886136054993, 0.16695965826511383, 0.1670261174440384, 0.16664773225784302, 0.16609083116054535]], [[0.16642436385154724, 0.16665732860565186, 0.16714154183864594, 0.16619256138801575, 0.1666754186153412, 0.16690872609615326], [0.16644777357578278, 0.16665825247764587, 0.16709567606449127, 0.16623829305171967, 0.16667461395263672, 0.1668853908777237], [0.16649629175662994, 0.1666601598262787, 0.16700054705142975, 0.1663331687450409, 0.16667288541793823, 0.1668369323015213], [0.16640105843544006, 0.16665640473365784, 0.16718727350234985, 0.16614700853824615, 0.16667625308036804, 0.16693201661109924], [0.16644959151744843, 0.16665832698345184, 0.16709211468696594, 0.166241854429245, 0.16667453944683075, 0.16688357293605804], [0.16647298634052277, 0.16665925085544586, 0.16704624891281128, 0.1662876009941101, 0.16667373478412628, 0.16686022281646729]], [[0.16636469960212708, 0.16652487218379974, 0.1668575555086136, 0.16690081357955933, 0.16665442287921906, 0.1666976362466812], [0.16640706360340118, 0.16654478013515472, 0.16683076322078705, 0.1668679565191269, 0.16665616631507874, 0.166693314909935], [0.16649490594863892, 0.1665860265493393, 0.1667751967906952, 0.16679978370666504, 0.16665971279144287, 0.16668428480625153], [0.1665063351392746, 0.16659140586853027, 0.16676799952983856, 0.1667909473180771, 0.16666018962860107, 0.1666831374168396], [0.16644130647182465, 0.16656087338924408, 0.16680912673473358, 0.16684140264987946, 0.16665756702423096, 0.16668981313705444], [0.16645270586013794, 0.16656622290611267, 0.16680189967155457, 0.16683253645896912, 0.16665801405906677, 0.16668862104415894]]]}, "num_training_step_calls_per_iteration": 1, "evaluation": {"env_runners": {"agent_episode_returns_mean": {"default_agent": -0.15}, "num_agent_steps_sampled": {"default_agent": 400}, "num_agent_steps_sampled_lifetime": {"default_agent": 3200}, "episode_return_min": -13.5, "module_to_env_connector": {"timers": {"connectors": {"remove_single_ts_time_rank_from_batch": 1.3298009626719297e-05, "tensor_to_numpy": 1.6973763412673753e-05, "normalize_and_clip_actions": 9.78209406764446e-06, "listify_data_for_vector_env": 1.2245811987837415e-05, "get_actions": 4.536331183783183e-05, "un_batch_to_individual_items": 7.666738649397002e-06}}, "connector_pipeline_timer": 0.00013604900274180847}, "rlmodule_inference_timer": 3.853550692455315e-05, "env_step_timer": 1.710475380452268e-05, "num_episodes_lifetime": 160, "env_to_module_sum_episodes_length_in": 10.3682383945743, "num_env_steps_sampled": 400, "env_to_module_connector": {"timers": {"connectors": {"add_observations_from_episodes_to_batch": 3.186052219486312e-06, "add_time_dim_to_batch_and_zero_pad": 9.039439965475267e-06, "batch_individual_items": 1.4533807521980114e-05, "numpy_to_tensor": 1.5536724331186903e-05, "add_states_from_episodes_to_batch": 3.0242113497117247e-06}}, "connector_pipeline_timer": 7.079155826191003e-05}, "num_module_steps_sampled": {"default_policy": 400}, "env_reset_timer": 0.0006499487504236898, "num_module_steps_sampled_lifetime": {"default_policy": 3200}, "env_to_module_sum_episodes_length_out": 10.3682383945743, "module_episode_returns_mean": {"default_policy": -0.15}, "episode_return_mean": -0.15, "num_episodes": 20, "episode_len_mean": 20.0, "episode_return_max": 14.5, "num_env_steps_sampled_lifetime": 40400, "sample": 0.1298975138928198, "episode_duration_sec_mean": 0.005680169902043417, "weights_seq_no": 8.0, "episode_len_min": 20, "episode_len_max": 20, "time_between_sampling": 9.90371167221695}, "num_healthy_workers": 1, "actor_manager_num_outstanding_async_reqs": 0, "num_remote_worker_restarts": 0}, "num_env_steps_sampled_lifetime": -3695000.0, "fault_tolerance": {"num_healthy_workers": 0, "num_remote_worker_restarts": 0}, "env_runner_group": {"actor_manager_num_outstanding_async_reqs": 0}, "done": false, "training_iteration": 8, "trial_id": "b1df4_00000", "date": "2025-08-11_18-02-03", "timestamp": 1754928123, "time_this_iter_s": 12.354887247085571, "time_total_s": 84.10974526405334, "pid": 10074, "hostname": "Mac", "node_ip": "127.0.0.1", "config": {"exploration_config": {}, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 2, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "env": "Umbrella", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": false, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 0, "create_local_env_runner": true, "num_envs_per_env_runner": 1, "gym_env_vectorize_mode": "SYNC", "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "episodes_to_numpy": true, "max_requests_in_flight_per_env_runner": 1, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "merge_env_runner_states": "training_only", "broadcast_env_runner_states": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "complete_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "sampler_perf_stats_ema_coef": null, "_is_online": true, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": "auto", "num_aggregator_actors_per_learner": 0, "max_requests_in_flight_per_aggregator_actor": 3, "local_gpu_idx": 0, "max_requests_in_flight_per_learner": 3, "gamma": 1, "lr": 0.0002715581955, "grad_clip": 0.5, "grad_clip_by": "global_norm", "_train_batch_size_per_learner": 5000, "train_batch_size": 4000, "num_epochs": 1, "minibatch_size": 1000, "shuffle_batch_per_epoch": true, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "log_std_clip_param": 20.0, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "_disable_preprocessor_api": false, "_disable_action_flattening": false}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {"intrinsic_reward_coeff": 0.2795015916508}, "optimizer": {}, "_learner_class": "<class 'source.intrinsic_attention_ppo.learners.IntrinsicAttentionMetaLearner.IntrinsicAttentionMetaLearner'>", "callbacks_on_algorithm_init": null, "callbacks_on_env_runners_recreated": null, "callbacks_on_offline_eval_runners_recreated": null, "callbacks_on_checkpoint_loaded": null, "callbacks_on_environment_created": null, "callbacks_on_episode_created": null, "callbacks_on_episode_start": null, "callbacks_on_episode_step": null, "callbacks_on_episode_end": null, "callbacks_on_evaluate_start": null, "callbacks_on_evaluate_end": null, "callbacks_on_evaluate_offline_start": null, "callbacks_on_evaluate_offline_end": null, "callbacks_on_sample_end": null, "callbacks_on_train_result": null, "explore": true, "enable_rl_module_and_learner": true, "enable_env_runner_and_connector_v2": true, "_prior_exploration_config": {"type": "StochasticSampling"}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x3855fd760>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "offline_data_class": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_read_batch_size": null, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "materialize_data": false, "materialize_mapped_data": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "ignore_final_observation": false, "prelearner_class": null, "prelearner_buffer_class": null, "prelearner_buffer_kwargs": {}, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_remaining_data": false, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": 1, "evaluation_duration": 20, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_auto_duration_min_env_steps_per_sample": 100, "evaluation_auto_duration_max_env_steps_per_sample": 2000, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 1, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "offline_evaluation_interval": null, "num_offline_eval_runners": 0, "offline_loss_for_module_fn": null, "offline_evaluation_duration": 1, "offline_evaluation_parallel_to_training": false, "offline_evaluation_timeout_s": 120.0, "num_cpus_per_offline_eval_runner": 1, "num_gpus_per_offline_eval_runner": 0, "custom_resources_per_offline_eval_runner": {}, "restart_failed_offline_eval_runners": true, "ignore_offline_eval_runner_failures": false, "max_num_offline_eval_runner_restarts": 1000, "offline_eval_runner_restore_timeout_s": 1800.0, "max_requests_in_flight_per_offline_eval_runner": 1, "validate_offline_eval_runners_after_construction": true, "offline_eval_runner_health_probe_timeout_s": 30.0, "offline_eval_rl_module_inference_only": false, "broadcast_offline_eval_runner_states": false, "offline_eval_batch_size_per_runner": 256, "dataset_num_iters_per_eval_runner": 1, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "log_gradients": false, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 6, "restart_failed_env_runners": true, "ignore_env_runner_failures": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30.0, "env_runner_restore_timeout_s": 1800.0, "_model_config": {}, "_rl_module_spec": "MultiRLModuleSpec(multi_rl_module_class=<class 'ray.rllib.core.rl_module.multi_rl_module.MultiRLModule'>, observation_space=None, action_space=None, inference_only=False, model_config=None, rl_module_specs={'default_policy': RLModuleSpec(module_class=<class 'source.intrinsic_attention_ppo.rl_modules.DifferentiablePPOModule.DifferentiablePPOModule'>, observation_space=None, action_space=None, inference_only=False, learner_only=False, model_config={'vf_share_layers': True, 'embedding_dim': 62, 'max_seq_len': 6, 'policy_head_hidden_sizes': [32], 'value_head_hidden_sizes': [101], 'embedding_hidden_sizes': [121]}, catalog_class=None, load_state_path=None, model_config_dict=None), 'intrinsic_reward_module': RLModuleSpec(module_class=<class 'source.intrinsic_attention_ppo.rl_modules.IntrinsicAttentionModule.IntrinsicAttentionModule'>, observation_space=None, action_space=None, inference_only=False, learner_only=True, model_config={'intrinsic_reward_network': {'encoder_hidden_sizes': [], 'encoding_dim': 1, 'num_heads': 1, 'head_hidden_sizes': None, 'layers': [{'type': 'attention'}]}, 'extrinsic_value_hidden_layers': [127, 60], 'vf_share_layers': True, 'max_seq_len': 6}, catalog_class=None, load_state_path=None, model_config_dict=None)}, load_state_path=None, modules_to_load=None, module_specs={'default_policy': RLModuleSpec(module_class=<class 'source.intrinsic_attention_ppo.rl_modules.DifferentiablePPOModule.DifferentiablePPOModule'>, observation_space=None, action_space=None, inference_only=False, learner_only=False, model_config={'vf_share_layers': True, 'embedding_dim': 62, 'max_seq_len': 6, 'policy_head_hidden_sizes': [32], 'value_head_hidden_sizes': [101], 'embedding_hidden_sizes': [121]}, catalog_class=None, load_state_path=None, model_config_dict=None), 'intrinsic_reward_module': RLModuleSpec(module_class=<class 'source.intrinsic_attention_ppo.rl_modules.IntrinsicAttentionModule.IntrinsicAttentionModule'>, observation_space=None, action_space=None, inference_only=False, learner_only=True, model_config={'intrinsic_reward_network': {'encoder_hidden_sizes': [], 'encoding_dim': 1, 'num_heads': 1, 'head_hidden_sizes': None, 'layers': [{'type': 'attention'}]}, 'extrinsic_value_hidden_layers': [127, 60], 'vf_share_layers': True, 'max_seq_len': 6}, catalog_class=None, load_state_path=None, model_config_dict=None)})", "algorithm_config_overrides_per_module": {"intrinsic_reward_module": {"lr": 0.0002715581955}}, "_per_module_overrides": {}, "_validate_config": true, "_use_msgpack_checkpoints": false, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "env_task_fn": -1, "enable_connectors": -1, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.161583927863, "kl_target": 0.0201019014258, "vf_loss_coeff": 0.7790510010087, "entropy_coeff": 0.0015431216992, "clip_param": 0.2459212356676, "vf_clip_param": 0.3769744131561, "entropy_coeff_schedule": null, "lr_schedule": null, "sgd_minibatch_size": -1, "vf_share_layers": -1, "differentiable_learner_configs": ["DifferentiableLearnerConfig(learner_class=<class 'source.intrinsic_attention_ppo.learners.IntrinsicAttentionPPOLearner.IntrinsicAttentionPPOLearner'>, learner_connector=None, add_default_connectors_to_learner_pipeline=True, is_multi_agent=False, policies_to_update=['default_policy'], lr=0.0060984166342, num_total_minibatches=0, num_epochs=1, minibatch_size=1000, shuffle_batch_per_epoch=True)"], "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9485408017724, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.callbacks.callbacks.RLlibCallback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 84.10974526405334, "iterations_since_restore": 8, "perf": {"cpu_util_percent": 55.870588235294115, "ram_util_percent": 82.81764705882354}}
{"timers": {"training_iteration": 10.549039802634285, "restore_env_runners": 9.694203679142983e-06, "training_step": 10.548788548389503, "env_runner_sampling_timer": 1.7223966555299133, "learner_update_timer": 8.629256993756254, "synch_weights": 0.0018165495575968818, "restore_eval_env_runners": 7.544823344306872e-05, "evaluation_iteration": 0.14162547544834336, "synch_eval_env_connectors": 0.00021680853003588742, "synch_env_connectors": 5.256579469969269e-06}, "env_runners": {"episode_return_max": 10.5, "module_to_env_connector": {"timers": {"connectors": {"tensor_to_numpy": 1.744779666393858e-05, "normalize_and_clip_actions": 9.168341845107374e-06, "un_batch_to_individual_items": 7.412303061243276e-06, "listify_data_for_vector_env": 1.178412252180972e-05, "get_actions": 4.678232711049086e-05, "remove_single_ts_time_rank_from_batch": 1.3459910770976158e-05}}, "connector_pipeline_timer": 0.0001359358583070232}, "episode_len_mean": 20.0, "episode_len_max": 20, "num_module_steps_sampled_lifetime": {"default_policy": -4312500.0}, "num_env_steps_sampled_lifetime": -4312500.0, "module_episode_returns_mean": {"default_policy": 0.8199999999999998}, "env_to_module_sum_episodes_length_out": 10.36823839457432, "episode_return_mean": 0.8199999999999998, "env_to_module_connector": {"timers": {"connectors": {"add_time_dim_to_batch_and_zero_pad": 8.158871625778034e-06, "add_observations_from_episodes_to_batch": 3.2595562181223114e-06, "add_states_from_episodes_to_batch": 3.1338726086371445e-06, "numpy_to_tensor": 1.5354378837771167e-05, "batch_individual_items": 1.4384488022025359e-05}}, "connector_pipeline_timer": 6.880633817859769e-05}, "agent_episode_returns_mean": {"default_agent": 0.8199999999999998}, "env_step_timer": 1.6296535113286138e-05, "sample": 0.006180437463040521, "num_episodes": 250.0, "num_agent_steps_sampled_lifetime": {"default_agent": -4312500.0}, "num_episodes_lifetime": -215625.0, "env_to_module_sum_episodes_length_in": 10.36823839457432, "num_agent_steps_sampled": {"default_agent": 5000.0}, "num_env_steps_sampled": 5000.0, "num_module_steps_sampled": {"default_policy": 5000.0}, "episode_return_min": -9.5, "episode_duration_sec_mean": 0.006225878841709344, "weights_seq_no": 8.0, "time_between_sampling": 0.042936005701799555, "env_reset_timer": 5.0414861461045445e-05, "episode_len_min": 20, "rlmodule_inference_timer": 3.823234910139777e-05, "num_env_steps_sampled_lifetime_throughput": 2916.218438609777}, "__all_modules__": {"learner_connector_sum_episodes_length_in": 5000.0, "learner_connector": {"connector_pipeline_timer": 0.15713586861813125, "timers": {"connectors": {"add_one_ts_to_episodes_and_truncate": 0.009086961188284155, "add_observations_from_episodes_to_batch": 0.0008407242972408084, "add_columns_from_episodes_to_train_batch": 0.04164670764519969, "add_time_dim_to_batch_and_zero_pad": 0.0928414729332022, "add_states_from_episodes_to_batch": 0.0037722637609004174, "batch_individual_items": 0.008720885610095258, "numpy_to_tensor": 7.246195659225868e-05}}}, "learner_connector_sum_episodes_length_out": 5250.0}, "learners": {"__all_modules__": {"num_non_trainable_parameters": 0, "num_trainable_parameters": 24861, "num_module_steps_trained_lifetime": 107730, "num_env_steps_trained": 36000, "num_module_steps_trained": 11970, "num_env_steps_trained_lifetime": 324000, "num_env_steps_trained_lifetime_throughput": 4565.141664963952, "num_module_steps_trained_throughput": 25180949.64670794, "num_module_steps_trained_lifetime_throughput": 14574719.755215134}, "default_policy": {"vf_explained_var": 0.0005716681480407715, "vf_loss_unclipped": 43.42715835571289, "use_intrinsic_rewards": 0.0, "weights_seq_no": 9.0, "total_loss": 0.24831123650074005, "num_trainable_parameters": 16595, "curr_entropy_coeff": 0.0015431216992, "num_module_steps_trained_lifetime": 53865, "vf_loss": 0.32051512598991394, "diff_num_grad_updates_vs_sampler_policy": 1.0, "curr_kl_coeff": 0.00031559361377730966, "num_module_steps_trained": 5985, "mean_kl_loss": 1.8494954929337837e-05, "module_train_batch_size_mean": 998.3685925840979, "policy_loss": -0.0003383541770745069, "entropy": 0.6792044043540955, "num_module_steps_trained_lifetime_throughput": 758.1638590297837}, "intrinsic_reward_module": {"num_module_steps_trained": 5985, "diff_num_grad_updates_vs_sampler_policy": 1.0, "gradients_default_optimizer_global_norm": 0.0, "weights_seq_no": 9.0, "module_train_batch_size_mean": 998.3685925840979, "num_trainable_parameters": 8266, "default_optimizer_learning_rate": 0.0002715581955, "curr_entropy_coeff": 0.0015431216992, "num_module_steps_trained_lifetime": 53865, "total_loss": 0.0, "num_module_steps_trained_lifetime_throughput": 758.1748133039303}, "differentiable_learners": {"intrinsic_attention_ppo_learner": {"default_policy": {"vf_loss_unclipped": 43.370574951171875, "num_module_steps_trained_lifetime": 323190, "total_loss": 0.2483917772769928, "vf_loss": 0.320596307516098, "mean_kl_loss": 1.6943338778219186e-05, "diff_num_grad_updates_vs_sampler_policy": 46.0, "policy_loss": -0.00032368089887313545, "num_module_steps_trained": 35910, "vf_explained_var": 0.0027292370796203613, "use_intrinsic_rewards": 1.0, "weights_seq_no": 54.0, "module_train_batch_size_mean": 997.5505482791133, "entropy": 0.6792471408843994}, "__all_modules__": {"num_module_steps_trained_lifetime": 646380, "num_env_steps_trained_lifetime": 1944000, "num_env_steps_trained": 216000, "num_module_steps_trained": 71820, "num_env_steps_trained_lifetime_throughput": 55475.987029185366}, "intrinsic_reward_module": {"num_module_steps_trained": 35910, "weights_seq_no": 54.0, "module_train_batch_size_mean": 997.5505482791133, "total_loss": 0.0, "num_module_steps_trained_lifetime": 323190, "diff_num_grad_updates_vs_sampler_policy": 46.0}}}, "IntrinsicAttentionMask": [[[0.1663258969783783, 0.16655871272087097, 0.16704264283180237, 0.16609421372413635, 0.16716858744621277, 0.16680997610092163], [0.16635878384113312, 0.16656915843486786, 0.16700634360313416, 0.16614942252635956, 0.167120099067688, 0.16679616272449493], [0.16642703115940094, 0.1665908247232437, 0.16693107783794403, 0.16626398265361786, 0.1670195758342743, 0.16676752269268036], [0.16629309952259064, 0.16654828190803528, 0.16707880795001984, 0.16603921353816986, 0.16721689701080322, 0.16682371497154236], [0.16644476354122162, 0.166596457362175, 0.1669115275144577, 0.16629375517368317, 0.16699346899986267, 0.16676007211208344], [0.16639424860477448, 0.1665804237127304, 0.1669672280550003, 0.16620893776416779, 0.16706787049770355, 0.16678129136562347]], [[0.16669030487537384, 0.1665317267179489, 0.16674599051475525, 0.16677384078502655, 0.16661518812179565, 0.16664300858974457], [0.16669818758964539, 0.16648660600185394, 0.1667724996805191, 0.16680967807769775, 0.16659796237945557, 0.16663509607315063], [0.1666875183582306, 0.16654755175113678, 0.1667366623878479, 0.16676124930381775, 0.16662122309207916, 0.16664578020572662], [0.16668613255023956, 0.1665554642677307, 0.16673201322555542, 0.16675496101379395, 0.16662423312664032, 0.16664716601371765], [0.1666940301656723, 0.16651034355163574, 0.16675853729248047, 0.16679079830646515, 0.16660702228546143, 0.16663925349712372], [0.16669264435768127, 0.16651827096939087, 0.166753888130188, 0.16678451001644135, 0.16661004722118378, 0.16664063930511475]], [[0.16642417013645172, 0.16665713489055634, 0.16714134812355042, 0.16619236767292023, 0.16726736724376678, 0.1663176715373993], [0.16644760966300964, 0.16665808856487274, 0.16709551215171814, 0.16623812913894653, 0.16720932722091675, 0.16635136306285858], [0.16649620234966278, 0.16666005551815033, 0.1670004427433014, 0.16633307933807373, 0.16708898544311523, 0.16642124950885773], [0.16640080511569977, 0.16665615141391754, 0.16718702018260956, 0.16614674031734467, 0.1673251986503601, 0.16628406941890717], [0.16650880873203278, 0.16666056215763092, 0.166975736618042, 0.16635774075984955, 0.16705772280693054, 0.16643941402435303], [0.16641342639923096, 0.16665665805339813, 0.16716229915618896, 0.16617140173912048, 0.16729390621185303, 0.16630221903324127]], [[0.1667776107788086, 0.1666189581155777, 0.16657131910324097, 0.16686119139194489, 0.16670246422290802, 0.16646845638751984], [0.16681469976902008, 0.1666029691696167, 0.16653943061828613, 0.16692626476287842, 0.1667144000530243, 0.166402205824852], [0.16682584583759308, 0.16659817099571228, 0.1665298342704773, 0.16694581508636475, 0.16671797633171082, 0.166382297873497], [0.16675809025764465, 0.16662736237049103, 0.16658812761306763, 0.16682694852352142, 0.16669617593288422, 0.16650335490703583], [0.16679517924785614, 0.16661138832569122, 0.1665562242269516, 0.16689200699329376, 0.1667081117630005, 0.1664370745420456], [0.16684991121292114, 0.16658778488636017, 0.16650912165641785, 0.1669880598783493, 0.16672572493553162, 0.16633930802345276]], [[0.16742396354675293, 0.16656094789505005, 0.16647981107234955, 0.16621001064777374, 0.1665746122598648, 0.1667506843805313], [0.1678987592458725, 0.1664944440126419, 0.16636265814304352, 0.16592469811439514, 0.16651663184165955, 0.1668027937412262], [0.1679435670375824, 0.1664881557226181, 0.1663515865802765, 0.16589778661727905, 0.1665111482143402, 0.16680768132209778], [0.16809283196926117, 0.16646721959114075, 0.16631478071212769, 0.1658082902431488, 0.16649289429187775, 0.16682398319244385], [0.1678912192583084, 0.16649551689624786, 0.16636452078819275, 0.16592921316623688, 0.16651757061481476, 0.16680197417736053], [0.16779407858848572, 0.16650912165641785, 0.16638848185539246, 0.1659875363111496, 0.16652943193912506, 0.16679133474826813]], [[0.16682130098342896, 0.16640086472034454, 0.16661494970321655, 0.16664278507232666, 0.166746124625206, 0.1667739748954773], [0.16695842146873474, 0.16616545617580414, 0.16656902432441711, 0.16662152111530304, 0.16681651771068573, 0.16686907410621643], [0.1668885499238968, 0.16628538072109222, 0.16659243404865265, 0.16663236916065216, 0.16678065061569214, 0.16682063043117523], [0.16687947511672974, 0.1663009524345398, 0.1665954887866974, 0.16663378477096558, 0.16677600145339966, 0.16681432723999023], [0.16684578359127045, 0.1663587987422943, 0.16660675406455994, 0.16663898527622223, 0.1667587012052536, 0.16679096221923828], [0.1668366938829422, 0.16637437045574188, 0.1666097790002823, 0.16664038598537445, 0.16675402224063873, 0.16678465902805328]]]}, "num_training_step_calls_per_iteration": 1, "evaluation": {"env_runners": {"agent_episode_returns_mean": {"default_agent": 0.65}, "num_agent_steps_sampled": {"default_agent": 400}, "num_agent_steps_sampled_lifetime": {"default_agent": 3600}, "episode_return_min": -13.5, "module_to_env_connector": {"timers": {"connectors": {"remove_single_ts_time_rank_from_batch": 1.178082598664419e-05, "tensor_to_numpy": 1.5004194703171324e-05, "normalize_and_clip_actions": 7.777234378883772e-06, "listify_data_for_vector_env": 1.0369407752406945e-05, "get_actions": 3.5420588113379614e-05, "un_batch_to_individual_items": 6.423362450038259e-06}}, "connector_pipeline_timer": 0.00011281360726867472}, "rlmodule_inference_timer": 3.0395432973133596e-05, "env_step_timer": 1.363228081851851e-05, "num_episodes_lifetime": 180, "env_to_module_sum_episodes_length_in": 10.368238394574323, "num_env_steps_sampled": 400, "env_to_module_connector": {"timers": {"connectors": {"add_observations_from_episodes_to_batch": 2.7122063451648683e-06, "add_time_dim_to_batch_and_zero_pad": 6.717011982679654e-06, "batch_individual_items": 1.2161081279453597e-05, "numpy_to_tensor": 1.1974103486978314e-05, "add_states_from_episodes_to_batch": 2.6873512547168193e-06}}, "connector_pipeline_timer": 5.842091669677858e-05}, "num_module_steps_sampled": {"default_policy": 400}, "env_reset_timer": 0.0006474005130292745, "num_module_steps_sampled_lifetime": {"default_policy": 3600}, "env_to_module_sum_episodes_length_out": 10.368238394574323, "module_episode_returns_mean": {"default_policy": 0.65}, "episode_return_mean": 0.65, "num_episodes": 20, "episode_len_mean": 20.0, "episode_return_max": 14.5, "num_env_steps_sampled_lifetime": 45400, "sample": 0.12974244125335316, "episode_duration_sec_mean": 0.005689549952512607, "weights_seq_no": 9.0, "episode_len_min": 20, "episode_len_max": 20, "time_between_sampling": 9.91519825715535}, "num_healthy_workers": 1, "actor_manager_num_outstanding_async_reqs": 0, "num_remote_worker_restarts": 0}, "num_env_steps_sampled_lifetime": -4312500.0, "fault_tolerance": {"num_healthy_workers": 0, "num_remote_worker_restarts": 0}, "env_runner_group": {"actor_manager_num_outstanding_async_reqs": 0}, "done": false, "training_iteration": 9, "trial_id": "b1df4_00000", "date": "2025-08-11_18-02-14", "timestamp": 1754928134, "time_this_iter_s": 11.147847175598145, "time_total_s": 95.25759243965149, "pid": 10074, "hostname": "Mac", "node_ip": "127.0.0.1", "config": {"exploration_config": {}, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 2, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "env": "Umbrella", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": false, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 0, "create_local_env_runner": true, "num_envs_per_env_runner": 1, "gym_env_vectorize_mode": "SYNC", "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "episodes_to_numpy": true, "max_requests_in_flight_per_env_runner": 1, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "merge_env_runner_states": "training_only", "broadcast_env_runner_states": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "complete_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "sampler_perf_stats_ema_coef": null, "_is_online": true, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": "auto", "num_aggregator_actors_per_learner": 0, "max_requests_in_flight_per_aggregator_actor": 3, "local_gpu_idx": 0, "max_requests_in_flight_per_learner": 3, "gamma": 1, "lr": 0.0002715581955, "grad_clip": 0.5, "grad_clip_by": "global_norm", "_train_batch_size_per_learner": 5000, "train_batch_size": 4000, "num_epochs": 1, "minibatch_size": 1000, "shuffle_batch_per_epoch": true, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "log_std_clip_param": 20.0, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "_disable_preprocessor_api": false, "_disable_action_flattening": false}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {"intrinsic_reward_coeff": 0.2795015916508}, "optimizer": {}, "_learner_class": "<class 'source.intrinsic_attention_ppo.learners.IntrinsicAttentionMetaLearner.IntrinsicAttentionMetaLearner'>", "callbacks_on_algorithm_init": null, "callbacks_on_env_runners_recreated": null, "callbacks_on_offline_eval_runners_recreated": null, "callbacks_on_checkpoint_loaded": null, "callbacks_on_environment_created": null, "callbacks_on_episode_created": null, "callbacks_on_episode_start": null, "callbacks_on_episode_step": null, "callbacks_on_episode_end": null, "callbacks_on_evaluate_start": null, "callbacks_on_evaluate_end": null, "callbacks_on_evaluate_offline_start": null, "callbacks_on_evaluate_offline_end": null, "callbacks_on_sample_end": null, "callbacks_on_train_result": null, "explore": true, "enable_rl_module_and_learner": true, "enable_env_runner_and_connector_v2": true, "_prior_exploration_config": {"type": "StochasticSampling"}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x3855fd760>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "offline_data_class": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_read_batch_size": null, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "materialize_data": false, "materialize_mapped_data": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "ignore_final_observation": false, "prelearner_class": null, "prelearner_buffer_class": null, "prelearner_buffer_kwargs": {}, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_remaining_data": false, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": 1, "evaluation_duration": 20, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_auto_duration_min_env_steps_per_sample": 100, "evaluation_auto_duration_max_env_steps_per_sample": 2000, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 1, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "offline_evaluation_interval": null, "num_offline_eval_runners": 0, "offline_loss_for_module_fn": null, "offline_evaluation_duration": 1, "offline_evaluation_parallel_to_training": false, "offline_evaluation_timeout_s": 120.0, "num_cpus_per_offline_eval_runner": 1, "num_gpus_per_offline_eval_runner": 0, "custom_resources_per_offline_eval_runner": {}, "restart_failed_offline_eval_runners": true, "ignore_offline_eval_runner_failures": false, "max_num_offline_eval_runner_restarts": 1000, "offline_eval_runner_restore_timeout_s": 1800.0, "max_requests_in_flight_per_offline_eval_runner": 1, "validate_offline_eval_runners_after_construction": true, "offline_eval_runner_health_probe_timeout_s": 30.0, "offline_eval_rl_module_inference_only": false, "broadcast_offline_eval_runner_states": false, "offline_eval_batch_size_per_runner": 256, "dataset_num_iters_per_eval_runner": 1, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "log_gradients": false, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 6, "restart_failed_env_runners": true, "ignore_env_runner_failures": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30.0, "env_runner_restore_timeout_s": 1800.0, "_model_config": {}, "_rl_module_spec": "MultiRLModuleSpec(multi_rl_module_class=<class 'ray.rllib.core.rl_module.multi_rl_module.MultiRLModule'>, observation_space=None, action_space=None, inference_only=False, model_config=None, rl_module_specs={'default_policy': RLModuleSpec(module_class=<class 'source.intrinsic_attention_ppo.rl_modules.DifferentiablePPOModule.DifferentiablePPOModule'>, observation_space=None, action_space=None, inference_only=False, learner_only=False, model_config={'vf_share_layers': True, 'embedding_dim': 62, 'max_seq_len': 6, 'policy_head_hidden_sizes': [32], 'value_head_hidden_sizes': [101], 'embedding_hidden_sizes': [121]}, catalog_class=None, load_state_path=None, model_config_dict=None), 'intrinsic_reward_module': RLModuleSpec(module_class=<class 'source.intrinsic_attention_ppo.rl_modules.IntrinsicAttentionModule.IntrinsicAttentionModule'>, observation_space=None, action_space=None, inference_only=False, learner_only=True, model_config={'intrinsic_reward_network': {'encoder_hidden_sizes': [], 'encoding_dim': 1, 'num_heads': 1, 'head_hidden_sizes': None, 'layers': [{'type': 'attention'}]}, 'extrinsic_value_hidden_layers': [127, 60], 'vf_share_layers': True, 'max_seq_len': 6}, catalog_class=None, load_state_path=None, model_config_dict=None)}, load_state_path=None, modules_to_load=None, module_specs={'default_policy': RLModuleSpec(module_class=<class 'source.intrinsic_attention_ppo.rl_modules.DifferentiablePPOModule.DifferentiablePPOModule'>, observation_space=None, action_space=None, inference_only=False, learner_only=False, model_config={'vf_share_layers': True, 'embedding_dim': 62, 'max_seq_len': 6, 'policy_head_hidden_sizes': [32], 'value_head_hidden_sizes': [101], 'embedding_hidden_sizes': [121]}, catalog_class=None, load_state_path=None, model_config_dict=None), 'intrinsic_reward_module': RLModuleSpec(module_class=<class 'source.intrinsic_attention_ppo.rl_modules.IntrinsicAttentionModule.IntrinsicAttentionModule'>, observation_space=None, action_space=None, inference_only=False, learner_only=True, model_config={'intrinsic_reward_network': {'encoder_hidden_sizes': [], 'encoding_dim': 1, 'num_heads': 1, 'head_hidden_sizes': None, 'layers': [{'type': 'attention'}]}, 'extrinsic_value_hidden_layers': [127, 60], 'vf_share_layers': True, 'max_seq_len': 6}, catalog_class=None, load_state_path=None, model_config_dict=None)})", "algorithm_config_overrides_per_module": {"intrinsic_reward_module": {"lr": 0.0002715581955}}, "_per_module_overrides": {}, "_validate_config": true, "_use_msgpack_checkpoints": false, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "env_task_fn": -1, "enable_connectors": -1, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.161583927863, "kl_target": 0.0201019014258, "vf_loss_coeff": 0.7790510010087, "entropy_coeff": 0.0015431216992, "clip_param": 0.2459212356676, "vf_clip_param": 0.3769744131561, "entropy_coeff_schedule": null, "lr_schedule": null, "sgd_minibatch_size": -1, "vf_share_layers": -1, "differentiable_learner_configs": ["DifferentiableLearnerConfig(learner_class=<class 'source.intrinsic_attention_ppo.learners.IntrinsicAttentionPPOLearner.IntrinsicAttentionPPOLearner'>, learner_connector=None, add_default_connectors_to_learner_pipeline=True, is_multi_agent=False, policies_to_update=['default_policy'], lr=0.0060984166342, num_total_minibatches=0, num_epochs=1, minibatch_size=1000, shuffle_batch_per_epoch=True)"], "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9485408017724, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.callbacks.callbacks.RLlibCallback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 95.25759243965149, "iterations_since_restore": 9, "perf": {"cpu_util_percent": 54.51875, "ram_util_percent": 83.175}}
{"timers": {"training_iteration": 10.552763444608168, "restore_env_runners": 9.723511730566426e-06, "training_step": 10.552512265815098, "env_runner_sampling_timer": 1.7321884718940936, "learner_update_timer": 8.622724230068913, "synch_weights": 0.0018140798916638497, "restore_eval_env_runners": 7.51358301442033e-05, "evaluation_iteration": 0.14144936402392919, "synch_eval_env_connectors": 0.00021664253448555024, "synch_env_connectors": 5.287764021945092e-06}, "env_runners": {"episode_return_max": 10.5, "module_to_env_connector": {"timers": {"connectors": {"tensor_to_numpy": 2.4070085150388363e-05, "normalize_and_clip_actions": 1.2234302686906586e-05, "un_batch_to_individual_items": 1.0207095094499507e-05, "listify_data_for_vector_env": 1.8320979956305292e-05, "get_actions": 7.094932705771286e-05, "remove_single_ts_time_rank_from_batch": 1.7746871549666234e-05}}, "connector_pipeline_timer": 0.0001929165738774883}, "episode_len_mean": 20.0, "episode_len_max": 20, "num_module_steps_sampled_lifetime": {"default_policy": -4930000.0}, "num_env_steps_sampled_lifetime": -4930000.0, "module_episode_returns_mean": {"default_policy": 1.8600000000000003}, "env_to_module_sum_episodes_length_out": 10.36823839457432, "episode_return_mean": 1.8600000000000003, "env_to_module_connector": {"timers": {"connectors": {"add_time_dim_to_batch_and_zero_pad": 1.1007068878626611e-05, "add_observations_from_episodes_to_batch": 4.188998287763368e-06, "add_states_from_episodes_to_batch": 5.281311108578429e-06, "numpy_to_tensor": 2.1178811527777567e-05, "batch_individual_items": 1.9598590255378626e-05}}, "connector_pipeline_timer": 9.163716113914122e-05}, "agent_episode_returns_mean": {"default_agent": 1.8600000000000003}, "env_step_timer": 2.3724420534577595e-05, "sample": 0.008345481210632735, "num_episodes": 250.0, "num_agent_steps_sampled_lifetime": {"default_agent": -4930000.0}, "num_episodes_lifetime": -246500.0, "env_to_module_sum_episodes_length_in": 10.36823839457432, "num_agent_steps_sampled": {"default_agent": 5000.0}, "num_env_steps_sampled": 5000.0, "num_module_steps_sampled": {"default_policy": 5000.0}, "episode_return_min": -9.5, "episode_duration_sec_mean": 0.008398669318761676, "weights_seq_no": 9.0, "time_between_sampling": 0.03948523559991376, "env_reset_timer": 6.828110622219966e-05, "episode_len_min": 20, "rlmodule_inference_timer": 5.5040776184467775e-05, "num_env_steps_sampled_lifetime_throughput": 2397.087625452234}, "__all_modules__": {"learner_connector_sum_episodes_length_in": 5000.0, "learner_connector": {"connector_pipeline_timer": 0.15737914451188226, "timers": {"connectors": {"add_one_ts_to_episodes_and_truncate": 0.009166692826539447, "add_observations_from_episodes_to_batch": 0.0008424258041162594, "add_columns_from_episodes_to_train_batch": 0.04169683098885785, "add_time_dim_to_batch_and_zero_pad": 0.09294129278416906, "add_states_from_episodes_to_batch": 0.003782091543568234, "batch_individual_items": 0.008722623004028802, "numpy_to_tensor": 7.267275625612665e-05}}}, "learner_connector_sum_episodes_length_out": 5250.0}, "learners": {"__all_modules__": {"num_non_trainable_parameters": 0, "num_trainable_parameters": 24861, "num_module_steps_trained_lifetime": 119700, "num_env_steps_trained": 36000, "num_module_steps_trained": 11970, "num_env_steps_trained_lifetime": 360000, "num_env_steps_trained_lifetime_throughput": 4534.872628617001, "num_module_steps_trained_throughput": 24472135.81141519, "num_module_steps_trained_lifetime_throughput": 14418722.772615405}, "default_policy": {"vf_explained_var": 0.0007159113883972168, "vf_loss_unclipped": 41.63642501831055, "use_intrinsic_rewards": 0.0, "weights_seq_no": 10.0, "total_loss": 0.24808263778686523, "num_trainable_parameters": 16595, "curr_entropy_coeff": 0.0015431216992, "num_module_steps_trained_lifetime": 59850, "vf_loss": 0.32052916288375854, "diff_num_grad_updates_vs_sampler_policy": 1.0, "curr_kl_coeff": 0.00015779680688865483, "num_module_steps_trained": 5985, "mean_kl_loss": 1.728527968225535e-05, "module_train_batch_size_mean": 998.3173215714437, "policy_loss": -0.0005800341605208814, "entropy": 0.6777704358100891, "num_module_steps_trained_lifetime_throughput": 753.1624958335505}, "intrinsic_reward_module": {"num_module_steps_trained": 5985, "diff_num_grad_updates_vs_sampler_policy": 1.0, "gradients_default_optimizer_global_norm": 0.0, "weights_seq_no": 10.0, "module_train_batch_size_mean": 998.3173215714437, "num_trainable_parameters": 8266, "default_optimizer_learning_rate": 0.0002715581955, "curr_entropy_coeff": 0.0015431216992, "num_module_steps_trained_lifetime": 59850, "total_loss": 0.0, "num_module_steps_trained_lifetime_throughput": 753.1728358117699}, "differentiable_learners": {"intrinsic_attention_ppo_learner": {"default_policy": {"vf_loss_unclipped": 41.55739974975586, "num_module_steps_trained_lifetime": 359100, "total_loss": 0.24819636344909668, "vf_loss": 0.320615291595459, "mean_kl_loss": 1.4659909538750071e-05, "diff_num_grad_updates_vs_sampler_policy": 51.0, "policy_loss": -0.0005356767796911299, "num_module_steps_trained": 35910, "vf_explained_var": 0.0028714537620544434, "use_intrinsic_rewards": 1.0, "weights_seq_no": 60.0, "module_train_batch_size_mean": 997.532914147147, "entropy": 0.6778514981269836}, "__all_modules__": {"num_module_steps_trained_lifetime": 718200, "num_env_steps_trained_lifetime": 2160000, "num_env_steps_trained": 216000, "num_module_steps_trained": 71820, "num_env_steps_trained_lifetime_throughput": 54434.167046831586}, "intrinsic_reward_module": {"num_module_steps_trained": 35910, "weights_seq_no": 60.0, "module_train_batch_size_mean": 997.532914147147, "total_loss": 0.0, "num_module_steps_trained_lifetime": 359100, "diff_num_grad_updates_vs_sampler_policy": 51.0}}}, "IntrinsicAttentionMask": [[[0.1664242148399353, 0.1660671979188919, 0.1665496975183487, 0.16678284108638763, 0.16726741194725037, 0.16690859198570251], [0.16638824343681335, 0.16597847640514374, 0.16653230786323547, 0.16679999232292175, 0.16735656559467316, 0.16694439947605133], [0.16643686592578888, 0.16609837114810944, 0.16655582189559937, 0.16677682101726532, 0.16723614931106567, 0.1668960303068161], [0.16646027565002441, 0.16615618765354156, 0.1665671467781067, 0.16676564514636993, 0.16717810928821564, 0.16687269508838654], [0.16650882363319397, 0.16627611219882965, 0.16659057140350342, 0.16674239933490753, 0.16705773770809174, 0.16682425141334534], [0.1664728969335556, 0.1661873310804367, 0.16657322645187378, 0.16675959527492523, 0.16714683175086975, 0.16686011850833893]], [[0.16677764058113098, 0.16661898791790009, 0.16657134890556335, 0.16659916937351227, 0.1667024940252304, 0.16673032939434052], [0.16681475937366486, 0.16660302877426147, 0.1665394902229309, 0.16657660901546478, 0.16671445965766907, 0.16675162315368652], [0.16682592034339905, 0.16659824550151825, 0.16652992367744446, 0.16656982898712158, 0.16671806573867798, 0.16675803065299988], [0.16681939363479614, 0.1666010469198227, 0.16653551161289215, 0.16657379269599915, 0.16671594977378845, 0.16675427556037903], [0.16679522395133972, 0.1666114330291748, 0.16655626893043518, 0.16658850014209747, 0.16670815646648407, 0.16674041748046875], [0.166788712143898, 0.16661423444747925, 0.16656185686588287, 0.16659246385097504, 0.16670605540275574, 0.1667366921901703]], [[0.16742384433746338, 0.1665608286857605, 0.16647969186306, 0.1662098914384842, 0.167021244764328, 0.16630452871322632], [0.16789844632148743, 0.16649413108825684, 0.16636234521865845, 0.16592438519001007, 0.16724276542663574, 0.16607795655727386], [0.16794323921203613, 0.16648782789707184, 0.16635127365589142, 0.1658974587917328, 0.16726364195346832, 0.1660565882921219], [0.16809239983558655, 0.16646678745746613, 0.16631434857845306, 0.16580787301063538, 0.16733312606811523, 0.16598545014858246], [0.16764481365680695, 0.1665297895669937, 0.16642504930496216, 0.1660768687725067, 0.1671244502067566, 0.1661989837884903], [0.16804002225399017, 0.16647416353225708, 0.16632729768753052, 0.1658392995595932, 0.1673087328672409, 0.16601039469242096]], [[0.1668585240840912, 0.16613121330738068, 0.16695502400398254, 0.1670033037662506, 0.16627536714076996, 0.16677658259868622], [0.1669565886259079, 0.16585735976696014, 0.1671026349067688, 0.16717571020126343, 0.16607503592967987, 0.16683264076709747], [0.16684553027153015, 0.1661674827337265, 0.1669354885816574, 0.16698049008846283, 0.166301891207695, 0.16676916182041168], [0.16683903336524963, 0.16618561744689941, 0.16692571341991425, 0.16696907579898834, 0.16631515324115753, 0.16676545143127441], [0.16693712770938873, 0.1659117192029953, 0.1670733392238617, 0.16714148223400116, 0.16611480712890625, 0.16682152450084686], [0.16686953604221344, 0.1661003977060318, 0.1669716089963913, 0.1670226752758026, 0.16625283658504486, 0.16678288578987122]], [[0.16642430424690247, 0.16606728732585907, 0.16714148223400116, 0.1667829304933548, 0.1666753590106964, 0.16690866649150848], [0.1663883477449417, 0.1659785807132721, 0.16721190512180328, 0.1668000966310501, 0.1666765958070755, 0.1669445037841797], [0.16649626195430756, 0.1662450134754181, 0.16700051724910736, 0.16674849390983582, 0.16667285561561584, 0.1668369024991989], [0.1664603352546692, 0.16615623235702515, 0.1670709103345871, 0.16676568984985352, 0.16667412221431732, 0.1668727546930313], [0.16644953191280365, 0.16612957417964935, 0.16709205508232117, 0.1667708456516266, 0.16667447984218597, 0.16688351333141327], [0.166472926735878, 0.1661873757839203, 0.1670461893081665, 0.1667596399784088, 0.1666736751794815, 0.1668601632118225]], [[0.16656775772571564, 0.16632185876369476, 0.16665413975715637, 0.16669735312461853, 0.16685783863067627, 0.166901096701622], [0.16654641926288605, 0.1662476360797882, 0.1666514128446579, 0.16670392453670502, 0.16689901053905487, 0.16695161163806915], [0.16657522320747375, 0.16634789109230042, 0.16665507853031158, 0.1666950285434723, 0.16684336960315704, 0.16688334941864014], [0.1665789932012558, 0.16636094450950623, 0.16665558516979218, 0.16669389605522156, 0.16683615744113922, 0.16687451303005219], [0.16659286618232727, 0.16640929877758026, 0.16665732860565186, 0.16668957471847534, 0.1668093204498291, 0.16684159636497498], [0.16659662127494812, 0.16642235219478607, 0.16665782034397125, 0.1666884422302246, 0.16680210828781128, 0.16683274507522583]]]}, "num_training_step_calls_per_iteration": 1, "evaluation": {"env_runners": {"agent_episode_returns_mean": {"default_agent": 0.45}, "num_agent_steps_sampled": {"default_agent": 400}, "num_agent_steps_sampled_lifetime": {"default_agent": 4000}, "episode_return_min": -13.5, "module_to_env_connector": {"timers": {"connectors": {"remove_single_ts_time_rank_from_batch": 1.1859167211618552e-05, "tensor_to_numpy": 1.5482868987835667e-05, "normalize_and_clip_actions": 7.89926023083163e-06, "listify_data_for_vector_env": 1.0352623186821888e-05, "get_actions": 3.775457272470645e-05, "un_batch_to_individual_items": 6.519798964730306e-06}}, "connector_pipeline_timer": 0.00011630673017827568}, "rlmodule_inference_timer": 3.1363741215778714e-05, "env_step_timer": 1.3925768899726473e-05, "num_episodes_lifetime": 200, "env_to_module_sum_episodes_length_in": 10.368238394574323, "num_env_steps_sampled": 400, "env_to_module_connector": {"timers": {"connectors": {"add_observations_from_episodes_to_batch": 2.7648074155958175e-06, "add_time_dim_to_batch_and_zero_pad": 6.9722594662739045e-06, "batch_individual_items": 1.249272373777692e-05, "numpy_to_tensor": 1.231416393517349e-05, "add_states_from_episodes_to_batch": 2.7135737169070733e-06}}, "connector_pipeline_timer": 5.9705243478913855e-05}, "num_module_steps_sampled": {"default_policy": 400}, "env_reset_timer": 0.0006440369180789245, "num_module_steps_sampled_lifetime": {"default_policy": 4000}, "env_to_module_sum_episodes_length_out": 10.368238394574323, "module_episode_returns_mean": {"default_policy": 0.45}, "episode_return_mean": 0.45, "num_episodes": 20, "episode_len_mean": 20.0, "episode_return_max": 14.5, "num_env_steps_sampled_lifetime": 50400, "sample": 0.12962287267099357, "episode_duration_sec_mean": 0.005654132058843971, "weights_seq_no": 10.0, "episode_len_min": 20, "episode_len_max": 20, "time_between_sampling": 9.92561067917385}, "num_healthy_workers": 1, "actor_manager_num_outstanding_async_reqs": 0, "num_remote_worker_restarts": 0}, "num_env_steps_sampled_lifetime": -4930000.0, "fault_tolerance": {"num_healthy_workers": 0, "num_remote_worker_restarts": 0}, "env_runner_group": {"actor_manager_num_outstanding_async_reqs": 0}, "done": false, "training_iteration": 10, "trial_id": "b1df4_00000", "date": "2025-08-11_18-02-26", "timestamp": 1754928146, "time_this_iter_s": 11.052628993988037, "time_total_s": 106.31022143363953, "pid": 10074, "hostname": "Mac", "node_ip": "127.0.0.1", "config": {"exploration_config": {}, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 2, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "env": "Umbrella", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": false, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 0, "create_local_env_runner": true, "num_envs_per_env_runner": 1, "gym_env_vectorize_mode": "SYNC", "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "episodes_to_numpy": true, "max_requests_in_flight_per_env_runner": 1, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "merge_env_runner_states": "training_only", "broadcast_env_runner_states": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "complete_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "sampler_perf_stats_ema_coef": null, "_is_online": true, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": "auto", "num_aggregator_actors_per_learner": 0, "max_requests_in_flight_per_aggregator_actor": 3, "local_gpu_idx": 0, "max_requests_in_flight_per_learner": 3, "gamma": 1, "lr": 0.0002715581955, "grad_clip": 0.5, "grad_clip_by": "global_norm", "_train_batch_size_per_learner": 5000, "train_batch_size": 4000, "num_epochs": 1, "minibatch_size": 1000, "shuffle_batch_per_epoch": true, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "log_std_clip_param": 20.0, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "_disable_preprocessor_api": false, "_disable_action_flattening": false}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {"intrinsic_reward_coeff": 0.2795015916508}, "optimizer": {}, "_learner_class": "<class 'source.intrinsic_attention_ppo.learners.IntrinsicAttentionMetaLearner.IntrinsicAttentionMetaLearner'>", "callbacks_on_algorithm_init": null, "callbacks_on_env_runners_recreated": null, "callbacks_on_offline_eval_runners_recreated": null, "callbacks_on_checkpoint_loaded": null, "callbacks_on_environment_created": null, "callbacks_on_episode_created": null, "callbacks_on_episode_start": null, "callbacks_on_episode_step": null, "callbacks_on_episode_end": null, "callbacks_on_evaluate_start": null, "callbacks_on_evaluate_end": null, "callbacks_on_evaluate_offline_start": null, "callbacks_on_evaluate_offline_end": null, "callbacks_on_sample_end": null, "callbacks_on_train_result": null, "explore": true, "enable_rl_module_and_learner": true, "enable_env_runner_and_connector_v2": true, "_prior_exploration_config": {"type": "StochasticSampling"}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x3855fd760>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "offline_data_class": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_read_batch_size": null, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "materialize_data": false, "materialize_mapped_data": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "ignore_final_observation": false, "prelearner_class": null, "prelearner_buffer_class": null, "prelearner_buffer_kwargs": {}, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_remaining_data": false, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": 1, "evaluation_duration": 20, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_auto_duration_min_env_steps_per_sample": 100, "evaluation_auto_duration_max_env_steps_per_sample": 2000, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 1, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "offline_evaluation_interval": null, "num_offline_eval_runners": 0, "offline_loss_for_module_fn": null, "offline_evaluation_duration": 1, "offline_evaluation_parallel_to_training": false, "offline_evaluation_timeout_s": 120.0, "num_cpus_per_offline_eval_runner": 1, "num_gpus_per_offline_eval_runner": 0, "custom_resources_per_offline_eval_runner": {}, "restart_failed_offline_eval_runners": true, "ignore_offline_eval_runner_failures": false, "max_num_offline_eval_runner_restarts": 1000, "offline_eval_runner_restore_timeout_s": 1800.0, "max_requests_in_flight_per_offline_eval_runner": 1, "validate_offline_eval_runners_after_construction": true, "offline_eval_runner_health_probe_timeout_s": 30.0, "offline_eval_rl_module_inference_only": false, "broadcast_offline_eval_runner_states": false, "offline_eval_batch_size_per_runner": 256, "dataset_num_iters_per_eval_runner": 1, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "log_gradients": false, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 6, "restart_failed_env_runners": true, "ignore_env_runner_failures": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30.0, "env_runner_restore_timeout_s": 1800.0, "_model_config": {}, "_rl_module_spec": "MultiRLModuleSpec(multi_rl_module_class=<class 'ray.rllib.core.rl_module.multi_rl_module.MultiRLModule'>, observation_space=None, action_space=None, inference_only=False, model_config=None, rl_module_specs={'default_policy': RLModuleSpec(module_class=<class 'source.intrinsic_attention_ppo.rl_modules.DifferentiablePPOModule.DifferentiablePPOModule'>, observation_space=None, action_space=None, inference_only=False, learner_only=False, model_config={'vf_share_layers': True, 'embedding_dim': 62, 'max_seq_len': 6, 'policy_head_hidden_sizes': [32], 'value_head_hidden_sizes': [101], 'embedding_hidden_sizes': [121]}, catalog_class=None, load_state_path=None, model_config_dict=None), 'intrinsic_reward_module': RLModuleSpec(module_class=<class 'source.intrinsic_attention_ppo.rl_modules.IntrinsicAttentionModule.IntrinsicAttentionModule'>, observation_space=None, action_space=None, inference_only=False, learner_only=True, model_config={'intrinsic_reward_network': {'encoder_hidden_sizes': [], 'encoding_dim': 1, 'num_heads': 1, 'head_hidden_sizes': None, 'layers': [{'type': 'attention'}]}, 'extrinsic_value_hidden_layers': [127, 60], 'vf_share_layers': True, 'max_seq_len': 6}, catalog_class=None, load_state_path=None, model_config_dict=None)}, load_state_path=None, modules_to_load=None, module_specs={'default_policy': RLModuleSpec(module_class=<class 'source.intrinsic_attention_ppo.rl_modules.DifferentiablePPOModule.DifferentiablePPOModule'>, observation_space=None, action_space=None, inference_only=False, learner_only=False, model_config={'vf_share_layers': True, 'embedding_dim': 62, 'max_seq_len': 6, 'policy_head_hidden_sizes': [32], 'value_head_hidden_sizes': [101], 'embedding_hidden_sizes': [121]}, catalog_class=None, load_state_path=None, model_config_dict=None), 'intrinsic_reward_module': RLModuleSpec(module_class=<class 'source.intrinsic_attention_ppo.rl_modules.IntrinsicAttentionModule.IntrinsicAttentionModule'>, observation_space=None, action_space=None, inference_only=False, learner_only=True, model_config={'intrinsic_reward_network': {'encoder_hidden_sizes': [], 'encoding_dim': 1, 'num_heads': 1, 'head_hidden_sizes': None, 'layers': [{'type': 'attention'}]}, 'extrinsic_value_hidden_layers': [127, 60], 'vf_share_layers': True, 'max_seq_len': 6}, catalog_class=None, load_state_path=None, model_config_dict=None)})", "algorithm_config_overrides_per_module": {"intrinsic_reward_module": {"lr": 0.0002715581955}}, "_per_module_overrides": {}, "_validate_config": true, "_use_msgpack_checkpoints": false, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "env_task_fn": -1, "enable_connectors": -1, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.161583927863, "kl_target": 0.0201019014258, "vf_loss_coeff": 0.7790510010087, "entropy_coeff": 0.0015431216992, "clip_param": 0.2459212356676, "vf_clip_param": 0.3769744131561, "entropy_coeff_schedule": null, "lr_schedule": null, "sgd_minibatch_size": -1, "vf_share_layers": -1, "differentiable_learner_configs": ["DifferentiableLearnerConfig(learner_class=<class 'source.intrinsic_attention_ppo.learners.IntrinsicAttentionPPOLearner.IntrinsicAttentionPPOLearner'>, learner_connector=None, add_default_connectors_to_learner_pipeline=True, is_multi_agent=False, policies_to_update=['default_policy'], lr=0.0060984166342, num_total_minibatches=0, num_epochs=1, minibatch_size=1000, shuffle_batch_per_epoch=True)"], "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9485408017724, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.callbacks.callbacks.RLlibCallback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 106.31022143363953, "iterations_since_restore": 10, "perf": {"cpu_util_percent": 44.95, "ram_util_percent": 83.07499999999999}}
{"timers": {"training_iteration": 10.55028956600144, "restore_env_runners": 9.77169564836766e-06, "training_step": 10.550038271077574, "env_runner_sampling_timer": 1.7317452621751963, "learner_update_timer": 8.62061969568884, "synch_weights": 0.0018106182522506411, "restore_eval_env_runners": 7.482947173875117e-05, "evaluation_iteration": 0.1413170974637724, "synch_eval_env_connectors": 0.00021618193935896515, "synch_env_connectors": 5.3423866182070685e-06}, "env_runners": {"episode_return_max": 10.5, "module_to_env_connector": {"timers": {"connectors": {"tensor_to_numpy": 1.5307601613400117e-05, "normalize_and_clip_actions": 8.154509943640166e-06, "un_batch_to_individual_items": 6.718694263421162e-06, "listify_data_for_vector_env": 1.0678563845116086e-05, "get_actions": 3.927264959296078e-05, "remove_single_ts_time_rank_from_batch": 1.2094525304966251e-05}}, "connector_pipeline_timer": 0.00011905729241659759}, "episode_len_mean": 20.0, "episode_len_max": 20, "num_module_steps_sampled_lifetime": {"default_policy": -5547500.0}, "num_env_steps_sampled_lifetime": -5547500.0, "module_episode_returns_mean": {"default_policy": 1.699999999999999}, "env_to_module_sum_episodes_length_out": 10.36823839457432, "episode_return_mean": 1.699999999999999, "env_to_module_connector": {"timers": {"connectors": {"add_time_dim_to_batch_and_zero_pad": 7.106019035704533e-06, "add_observations_from_episodes_to_batch": 2.8771902130334266e-06, "add_states_from_episodes_to_batch": 2.797154475748719e-06, "numpy_to_tensor": 3.802485816549656e-05, "batch_individual_items": 1.2607132828180961e-05}}, "connector_pipeline_timer": 8.561146565944284e-05}, "agent_episode_returns_mean": {"default_agent": 1.699999999999999}, "env_step_timer": 1.4024516331634485e-05, "sample": 0.007413718607222774, "num_episodes": 250.0, "num_agent_steps_sampled_lifetime": {"default_agent": -5547500.0}, "num_episodes_lifetime": -277375.0, "env_to_module_sum_episodes_length_in": 10.36823839457432, "num_agent_steps_sampled": {"default_agent": 5000.0}, "num_env_steps_sampled": 5000.0, "num_module_steps_sampled": {"default_policy": 5000.0}, "episode_return_min": -9.5, "episode_duration_sec_mean": 0.00588352646538988, "weights_seq_no": 10.0, "time_between_sampling": 0.034508891255869215, "env_reset_timer": 5.212564497920791e-05, "episode_len_min": 20, "rlmodule_inference_timer": 3.2033179503440564e-05, "num_env_steps_sampled_lifetime_throughput": 3171.9053372968638}, "__all_modules__": {"learner_connector_sum_episodes_length_in": 5000.0, "learner_connector": {"connector_pipeline_timer": 0.15736627765663022, "timers": {"connectors": {"add_one_ts_to_episodes_and_truncate": 0.009162536727599818, "add_observations_from_episodes_to_batch": 0.0008425252966596694, "add_columns_from_episodes_to_train_batch": 0.04170597475826367, "add_time_dim_to_batch_and_zero_pad": 0.09293187068575229, "add_states_from_episodes_to_batch": 0.003784708537907034, "batch_individual_items": 0.008712084683884068, "numpy_to_tensor": 7.255269803943599e-05}}}, "learner_connector_sum_episodes_length_out": 5250.0}, "learners": {"__all_modules__": {"num_non_trainable_parameters": 0, "num_trainable_parameters": 24861, "num_module_steps_trained_lifetime": 131670, "num_env_steps_trained": 36000, "num_module_steps_trained": 11970, "num_env_steps_trained_lifetime": 396000, "num_env_steps_trained_lifetime_throughput": 4505.602373077112, "num_module_steps_trained_throughput": 23800349.842141487, "num_module_steps_trained_lifetime_throughput": 14271266.734070374}, "default_policy": {"vf_explained_var": 0.0005255341529846191, "vf_loss_unclipped": 42.42390823364258, "use_intrinsic_rewards": 0.0, "weights_seq_no": 11.0, "total_loss": 0.2476280927658081, "num_trainable_parameters": 16595, "curr_entropy_coeff": 0.0015431216992, "num_module_steps_trained_lifetime": 65835, "vf_loss": 0.3205157518386841, "diff_num_grad_updates_vs_sampler_policy": 1.0, "curr_kl_coeff": 7.889840344432741e-05, "num_module_steps_trained": 5985, "mean_kl_loss": 4.258653279975988e-05, "module_train_batch_size_mean": 998.2690509307901, "policy_loss": -0.0010263655567541718, "entropy": 0.6763376593589783, "num_module_steps_trained_lifetime_throughput": 748.3264533211968}, "intrinsic_reward_module": {"num_module_steps_trained": 5985, "diff_num_grad_updates_vs_sampler_policy": 1.0, "gradients_default_optimizer_global_norm": 0.0, "weights_seq_no": 11.0, "module_train_batch_size_mean": 998.2690509307901, "num_trainable_parameters": 8266, "default_optimizer_learning_rate": 0.0002715581955, "curr_entropy_coeff": 0.0015431216992, "num_module_steps_trained_lifetime": 65835, "total_loss": 0.0, "num_module_steps_trained_lifetime_throughput": 748.3361985448313}, "differentiable_learners": {"intrinsic_attention_ppo_learner": {"default_policy": {"vf_loss_unclipped": 42.34212112426758, "num_module_steps_trained_lifetime": 395010, "total_loss": 0.24775046110153198, "vf_loss": 0.3205971121788025, "mean_kl_loss": 3.8067257264629006e-05, "diff_num_grad_updates_vs_sampler_policy": 56.0, "policy_loss": -0.000973388843704015, "num_module_steps_trained": 35910, "vf_explained_var": 0.002758800983428955, "use_intrinsic_rewards": 1.0, "weights_seq_no": 66.0, "module_train_batch_size_mean": 997.5206335045569, "entropy": 0.6764287948608398}, "__all_modules__": {"num_module_steps_trained_lifetime": 790020, "num_env_steps_trained_lifetime": 2376000, "num_env_steps_trained": 216000, "num_module_steps_trained": 71820, "num_env_steps_trained_lifetime_throughput": 53428.100994311855}, "intrinsic_reward_module": {"num_module_steps_trained": 35910, "weights_seq_no": 66.0, "module_train_batch_size_mean": 997.5206335045569, "total_loss": 0.0, "num_module_steps_trained_lifetime": 395010, "diff_num_grad_updates_vs_sampler_policy": 56.0}}}, "IntrinsicAttentionMask": [[[0.16632616519927979, 0.16655898094177246, 0.16704291105270386, 0.1666845679283142, 0.1665770709514618, 0.16681022942066193], [0.1663590371608734, 0.16656939685344696, 0.16700658202171326, 0.1666828691959381, 0.1665857434272766, 0.16679640114307404], [0.16642716526985168, 0.16659095883369446, 0.16693121194839478, 0.1666792929172516, 0.1666036993265152, 0.1667676717042923], [0.1663767248392105, 0.16657501459121704, 0.16698700189590454, 0.1666819304227829, 0.16659040749073029, 0.1667889505624771], [0.16636157035827637, 0.16657020151615143, 0.16700375080108643, 0.16668272018432617, 0.16658639907836914, 0.16679531335830688], [0.1663944274187088, 0.16658060252666473, 0.16696742177009583, 0.16668100655078888, 0.16659507155418396, 0.166781485080719]], [[0.16682127118110657, 0.16640083491802216, 0.16687700152397156, 0.16664275527000427, 0.1667460948228836, 0.16651204228401184], [0.16695831716060638, 0.1661653369665146, 0.16706356406211853, 0.16662141680717468, 0.16681639850139618, 0.16637490689754486], [0.16680312156677246, 0.16643202304840088, 0.16685231029987335, 0.1666455715894699, 0.16673678159713745, 0.16653019189834595], [0.16687943041324615, 0.1663009077310562, 0.16695615649223328, 0.1666337251663208, 0.16677594184875488, 0.16645386815071106], [0.16684575378894806, 0.16635875403881073, 0.166910320520401, 0.16663895547389984, 0.16675865650177002, 0.16648754477500916], [0.16692204773426056, 0.16622769832611084, 0.16701418161392212, 0.16662709414958954, 0.16679781675338745, 0.16641122102737427]], [[0.16734923422336578, 0.16648660600185394, 0.16685181856155396, 0.16613581776618958, 0.1665002554655075, 0.16667625308036804], [0.16777698695659637, 0.16637368500232697, 0.1669672429561615, 0.16580435633659363, 0.1663958728313446, 0.16668181121349335], [0.1675955206155777, 0.16642159223556519, 0.1669183224439621, 0.16594484448432922, 0.16644014418125153, 0.1666794866323471], [0.1679517924785614, 0.1663275510072708, 0.16701428592205048, 0.16566917300224304, 0.16635319590568542, 0.16668400168418884], [0.16777020692825317, 0.16637550294399261, 0.16696542501449585, 0.16580961644649506, 0.16639754176139832, 0.16668173670768738], [0.1676826924085617, 0.16639858484268188, 0.166941836476326, 0.1658773422241211, 0.1664188802242279, 0.16668061912059784]], [[0.16632188856601715, 0.16655749082565308, 0.1670471876859665, 0.16711090505123138, 0.16615080833435059, 0.1668117344379425], [0.16635477542877197, 0.16656793653964996, 0.16701088845729828, 0.1670685112476349, 0.16619998216629028, 0.166797935962677], [0.1664230078458786, 0.16658957302570343, 0.16693559288978577, 0.1669805943965912, 0.16630199551582336, 0.16676926612854004], [0.16643185913562775, 0.16659237444400787, 0.1669258028268814, 0.1669691652059555, 0.1663152426481247, 0.16676554083824158], [0.16629797220230103, 0.1665498912334442, 0.167073592543602, 0.16714173555374146, 0.16611506044864655, 0.16682177782058716], [0.16639022529125214, 0.16657917201519012, 0.16697175800800323, 0.16702282428741455, 0.1662529706954956, 0.16678303480148315]], [[0.16652292013168335, 0.16675600409507751, 0.16664846241474152, 0.16629096865653992, 0.16677410900592804, 0.16700756549835205], [0.16653679311275482, 0.16674739122390747, 0.16665023565292358, 0.16632720828056335, 0.16676375269889832, 0.16697463393211365], [0.16653038561344147, 0.16675136983394623, 0.16664941608905792, 0.16631048917770386, 0.16676852107048035, 0.16698981821537018], [0.16650906205177307, 0.16676457226276398, 0.16664668917655945, 0.16625484824180603, 0.16678442060947418, 0.1670403629541397], [0.16653788089752197, 0.16674672067165375, 0.16665038466453552, 0.166330024600029, 0.16676294803619385, 0.1669720858335495], [0.16655175387859344, 0.1667380928993225, 0.1666521430015564, 0.16636626422405243, 0.16675257682800293, 0.1669391542673111]], [[0.1668587028980255, 0.16658401489257812, 0.16695521771907806, 0.16654972732067108, 0.16627556085586548, 0.16677677631378174], [0.166895791888237, 0.16656801104545593, 0.16701097786426544, 0.16652712225914001, 0.16620007157325745, 0.16679802536964417], [0.16684569418430328, 0.1665896326303482, 0.16693565249443054, 0.1665576696395874, 0.16630205512046814, 0.16676932573318481], [0.1669004112482071, 0.16656601428985596, 0.16701793670654297, 0.16652429103851318, 0.16619063913822174, 0.16680066287517548], [0.16693750023841858, 0.16655001044273376, 0.16707371175289154, 0.16650165617465973, 0.1661151796579361, 0.1668218970298767], [0.16686975955963135, 0.1665792614221573, 0.1669718474149704, 0.16654300689697266, 0.16625306010246277, 0.16678312420845032]]]}, "num_training_step_calls_per_iteration": 1, "evaluation": {"env_runners": {"agent_episode_returns_mean": {"default_agent": 1.05}, "num_agent_steps_sampled": {"default_agent": 400}, "num_agent_steps_sampled_lifetime": {"default_agent": 4400}, "episode_return_min": -13.5, "module_to_env_connector": {"timers": {"connectors": {"remove_single_ts_time_rank_from_batch": 1.1698148354027067e-05, "tensor_to_numpy": 1.4834869641584136e-05, "normalize_and_clip_actions": 7.821878132602397e-06, "listify_data_for_vector_env": 1.0213051625127735e-05, "get_actions": 3.556073914190392e-05, "un_batch_to_individual_items": 6.41157333010498e-06}}, "connector_pipeline_timer": 0.00011282684542415731}, "rlmodule_inference_timer": 3.0420701448817962e-05, "env_step_timer": 1.3534250773097054e-05, "num_episodes_lifetime": 220, "env_to_module_sum_episodes_length_in": 10.368238394574323, "num_env_steps_sampled": 400, "env_to_module_connector": {"timers": {"connectors": {"add_observations_from_episodes_to_batch": 2.708376798293053e-06, "add_time_dim_to_batch_and_zero_pad": 6.69177868651924e-06, "batch_individual_items": 1.2129905146926515e-05, "numpy_to_tensor": 1.2051729928684563e-05, "add_states_from_episodes_to_batch": 2.692925998561574e-06}}, "connector_pipeline_timer": 5.864958872516516e-05}, "num_module_steps_sampled": {"default_policy": 400}, "env_reset_timer": 0.0006405440486408667, "num_module_steps_sampled_lifetime": {"default_policy": 4400}, "env_to_module_sum_episodes_length_out": 10.368238394574323, "module_episode_returns_mean": {"default_policy": 1.05}, "episode_return_mean": 1.05, "num_episodes": 20, "episode_len_mean": 20.0, "episode_return_max": 14.5, "num_env_steps_sampled_lifetime": 55400, "sample": 0.12946593310477553, "episode_duration_sec_mean": 0.0054504954116418956, "weights_seq_no": 11.0, "episode_len_min": 20, "episode_len_max": 20, "time_between_sampling": 9.929725383632173}, "num_healthy_workers": 1, "actor_manager_num_outstanding_async_reqs": 0, "num_remote_worker_restarts": 0}, "num_env_steps_sampled_lifetime": -5547500.0, "fault_tolerance": {"num_healthy_workers": 0, "num_remote_worker_restarts": 0}, "env_runner_group": {"actor_manager_num_outstanding_async_reqs": 0}, "done": false, "training_iteration": 11, "trial_id": "b1df4_00000", "date": "2025-08-11_18-02-36", "timestamp": 1754928156, "time_this_iter_s": 10.431145906448364, "time_total_s": 116.74136734008789, "pid": 10074, "hostname": "Mac", "node_ip": "127.0.0.1", "config": {"exploration_config": {}, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 2, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "env": "Umbrella", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": false, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 0, "create_local_env_runner": true, "num_envs_per_env_runner": 1, "gym_env_vectorize_mode": "SYNC", "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "episodes_to_numpy": true, "max_requests_in_flight_per_env_runner": 1, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "merge_env_runner_states": "training_only", "broadcast_env_runner_states": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "complete_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "sampler_perf_stats_ema_coef": null, "_is_online": true, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": "auto", "num_aggregator_actors_per_learner": 0, "max_requests_in_flight_per_aggregator_actor": 3, "local_gpu_idx": 0, "max_requests_in_flight_per_learner": 3, "gamma": 1, "lr": 0.0002715581955, "grad_clip": 0.5, "grad_clip_by": "global_norm", "_train_batch_size_per_learner": 5000, "train_batch_size": 4000, "num_epochs": 1, "minibatch_size": 1000, "shuffle_batch_per_epoch": true, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "log_std_clip_param": 20.0, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "_disable_preprocessor_api": false, "_disable_action_flattening": false}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {"intrinsic_reward_coeff": 0.2795015916508}, "optimizer": {}, "_learner_class": "<class 'source.intrinsic_attention_ppo.learners.IntrinsicAttentionMetaLearner.IntrinsicAttentionMetaLearner'>", "callbacks_on_algorithm_init": null, "callbacks_on_env_runners_recreated": null, "callbacks_on_offline_eval_runners_recreated": null, "callbacks_on_checkpoint_loaded": null, "callbacks_on_environment_created": null, "callbacks_on_episode_created": null, "callbacks_on_episode_start": null, "callbacks_on_episode_step": null, "callbacks_on_episode_end": null, "callbacks_on_evaluate_start": null, "callbacks_on_evaluate_end": null, "callbacks_on_evaluate_offline_start": null, "callbacks_on_evaluate_offline_end": null, "callbacks_on_sample_end": null, "callbacks_on_train_result": null, "explore": true, "enable_rl_module_and_learner": true, "enable_env_runner_and_connector_v2": true, "_prior_exploration_config": {"type": "StochasticSampling"}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x3855fd760>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "offline_data_class": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_read_batch_size": null, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "materialize_data": false, "materialize_mapped_data": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "ignore_final_observation": false, "prelearner_class": null, "prelearner_buffer_class": null, "prelearner_buffer_kwargs": {}, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_remaining_data": false, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": 1, "evaluation_duration": 20, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_auto_duration_min_env_steps_per_sample": 100, "evaluation_auto_duration_max_env_steps_per_sample": 2000, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 1, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "offline_evaluation_interval": null, "num_offline_eval_runners": 0, "offline_loss_for_module_fn": null, "offline_evaluation_duration": 1, "offline_evaluation_parallel_to_training": false, "offline_evaluation_timeout_s": 120.0, "num_cpus_per_offline_eval_runner": 1, "num_gpus_per_offline_eval_runner": 0, "custom_resources_per_offline_eval_runner": {}, "restart_failed_offline_eval_runners": true, "ignore_offline_eval_runner_failures": false, "max_num_offline_eval_runner_restarts": 1000, "offline_eval_runner_restore_timeout_s": 1800.0, "max_requests_in_flight_per_offline_eval_runner": 1, "validate_offline_eval_runners_after_construction": true, "offline_eval_runner_health_probe_timeout_s": 30.0, "offline_eval_rl_module_inference_only": false, "broadcast_offline_eval_runner_states": false, "offline_eval_batch_size_per_runner": 256, "dataset_num_iters_per_eval_runner": 1, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "log_gradients": false, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 6, "restart_failed_env_runners": true, "ignore_env_runner_failures": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30.0, "env_runner_restore_timeout_s": 1800.0, "_model_config": {}, "_rl_module_spec": "MultiRLModuleSpec(multi_rl_module_class=<class 'ray.rllib.core.rl_module.multi_rl_module.MultiRLModule'>, observation_space=None, action_space=None, inference_only=False, model_config=None, rl_module_specs={'default_policy': RLModuleSpec(module_class=<class 'source.intrinsic_attention_ppo.rl_modules.DifferentiablePPOModule.DifferentiablePPOModule'>, observation_space=None, action_space=None, inference_only=False, learner_only=False, model_config={'vf_share_layers': True, 'embedding_dim': 62, 'max_seq_len': 6, 'policy_head_hidden_sizes': [32], 'value_head_hidden_sizes': [101], 'embedding_hidden_sizes': [121]}, catalog_class=None, load_state_path=None, model_config_dict=None), 'intrinsic_reward_module': RLModuleSpec(module_class=<class 'source.intrinsic_attention_ppo.rl_modules.IntrinsicAttentionModule.IntrinsicAttentionModule'>, observation_space=None, action_space=None, inference_only=False, learner_only=True, model_config={'intrinsic_reward_network': {'encoder_hidden_sizes': [], 'encoding_dim': 1, 'num_heads': 1, 'head_hidden_sizes': None, 'layers': [{'type': 'attention'}]}, 'extrinsic_value_hidden_layers': [127, 60], 'vf_share_layers': True, 'max_seq_len': 6}, catalog_class=None, load_state_path=None, model_config_dict=None)}, load_state_path=None, modules_to_load=None, module_specs={'default_policy': RLModuleSpec(module_class=<class 'source.intrinsic_attention_ppo.rl_modules.DifferentiablePPOModule.DifferentiablePPOModule'>, observation_space=None, action_space=None, inference_only=False, learner_only=False, model_config={'vf_share_layers': True, 'embedding_dim': 62, 'max_seq_len': 6, 'policy_head_hidden_sizes': [32], 'value_head_hidden_sizes': [101], 'embedding_hidden_sizes': [121]}, catalog_class=None, load_state_path=None, model_config_dict=None), 'intrinsic_reward_module': RLModuleSpec(module_class=<class 'source.intrinsic_attention_ppo.rl_modules.IntrinsicAttentionModule.IntrinsicAttentionModule'>, observation_space=None, action_space=None, inference_only=False, learner_only=True, model_config={'intrinsic_reward_network': {'encoder_hidden_sizes': [], 'encoding_dim': 1, 'num_heads': 1, 'head_hidden_sizes': None, 'layers': [{'type': 'attention'}]}, 'extrinsic_value_hidden_layers': [127, 60], 'vf_share_layers': True, 'max_seq_len': 6}, catalog_class=None, load_state_path=None, model_config_dict=None)})", "algorithm_config_overrides_per_module": {"intrinsic_reward_module": {"lr": 0.0002715581955}}, "_per_module_overrides": {}, "_validate_config": true, "_use_msgpack_checkpoints": false, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "env_task_fn": -1, "enable_connectors": -1, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.161583927863, "kl_target": 0.0201019014258, "vf_loss_coeff": 0.7790510010087, "entropy_coeff": 0.0015431216992, "clip_param": 0.2459212356676, "vf_clip_param": 0.3769744131561, "entropy_coeff_schedule": null, "lr_schedule": null, "sgd_minibatch_size": -1, "vf_share_layers": -1, "differentiable_learner_configs": ["DifferentiableLearnerConfig(learner_class=<class 'source.intrinsic_attention_ppo.learners.IntrinsicAttentionPPOLearner.IntrinsicAttentionPPOLearner'>, learner_connector=None, add_default_connectors_to_learner_pipeline=True, is_multi_agent=False, policies_to_update=['default_policy'], lr=0.0060984166342, num_total_minibatches=0, num_epochs=1, minibatch_size=1000, shuffle_batch_per_epoch=True)"], "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9485408017724, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.callbacks.callbacks.RLlibCallback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 116.74136734008789, "iterations_since_restore": 11, "perf": {"cpu_util_percent": 43.79333333333334, "ram_util_percent": 81.29333333333334}}
{"timers": {"training_iteration": 10.542729056592368, "restore_env_runners": 9.820638714321556e-06, "training_step": 10.542477727116387, "env_runner_sampling_timer": 1.7317549883027004, "learner_update_timer": 8.612973181231569, "synch_weights": 0.001807304989119901, "restore_eval_env_runners": 7.45428371140602e-05, "evaluation_iteration": 0.1411317256588539, "synch_eval_env_connectors": 0.00021589929026953977, "synch_env_connectors": 5.39604272919463e-06}, "env_runners": {"episode_return_max": 10.5, "module_to_env_connector": {"timers": {"connectors": {"tensor_to_numpy": 1.5623881969321736e-05, "normalize_and_clip_actions": 8.350118222230845e-06, "un_batch_to_individual_items": 6.806304403411669e-06, "listify_data_for_vector_env": 1.0894568818834798e-05, "get_actions": 4.0324116902728216e-05, "remove_single_ts_time_rank_from_batch": 1.2271225250039412e-05}}, "connector_pipeline_timer": 0.00012162891821254965}, "episode_len_mean": 20.0, "episode_len_max": 20, "num_module_steps_sampled_lifetime": {"default_policy": -6165000.0}, "num_env_steps_sampled_lifetime": -6165000.0, "module_episode_returns_mean": {"default_policy": 2.259999999999999}, "env_to_module_sum_episodes_length_out": 10.36823839457432, "episode_return_mean": 2.259999999999999, "env_to_module_connector": {"timers": {"connectors": {"add_time_dim_to_batch_and_zero_pad": 7.303273057163411e-06, "add_observations_from_episodes_to_batch": 2.9612930603152993e-06, "add_states_from_episodes_to_batch": 2.8638449756057922e-06, "numpy_to_tensor": 1.3160843403633761e-05, "batch_individual_items": 1.2807754523563205e-05}}, "connector_pipeline_timer": 6.173202070239361e-05}, "agent_episode_returns_mean": {"default_agent": 2.259999999999999}, "env_step_timer": 1.4272980334443723e-05, "sample": 0.006450555466133496, "num_episodes": 250.0, "num_agent_steps_sampled_lifetime": {"default_agent": -6165000.0}, "num_episodes_lifetime": -308250.0, "env_to_module_sum_episodes_length_in": 10.36823839457432, "num_agent_steps_sampled": {"default_agent": 5000.0}, "num_env_steps_sampled": 5000.0, "num_module_steps_sampled": {"default_policy": 5000.0}, "episode_return_min": -9.5, "episode_duration_sec_mean": 0.006030102853663265, "weights_seq_no": 11.0, "time_between_sampling": 0.035478072783175746, "env_reset_timer": 4.299589034123864e-05, "episode_len_min": 20, "rlmodule_inference_timer": 6.142600530299696e-05, "num_env_steps_sampled_lifetime_throughput": 3156.1440032626474}, "__all_modules__": {"learner_connector_sum_episodes_length_in": 5000.0, "learner_connector": {"connector_pipeline_timer": 0.15735746904001513, "timers": {"connectors": {"add_one_ts_to_episodes_and_truncate": 0.009162943020347897, "add_observations_from_episodes_to_batch": 0.0008427462946283441, "add_columns_from_episodes_to_train_batch": 0.04171081835012848, "add_time_dim_to_batch_and_zero_pad": 0.0929260161490862, "add_states_from_episodes_to_batch": 0.003785561041732007, "batch_individual_items": 0.008703280917669629, "numpy_to_tensor": 7.249717150413932e-05}}}, "learner_connector_sum_episodes_length_out": 5250.0}, "learners": {"__all_modules__": {"num_non_trainable_parameters": 0, "num_trainable_parameters": 24861, "num_module_steps_trained_lifetime": 143640, "num_env_steps_trained": 36000, "num_module_steps_trained": 11970, "num_env_steps_trained_lifetime": 432000, "num_env_steps_trained_lifetime_throughput": 4481.244439046272, "num_module_steps_trained_throughput": 23185043.84629163, "num_module_steps_trained_lifetime_throughput": 14152230.180396173}, "default_policy": {"vf_explained_var": -0.0006132125854492188, "vf_loss_unclipped": 42.462528228759766, "use_intrinsic_rewards": 0.0, "weights_seq_no": 12.0, "total_loss": 0.24862918257713318, "num_trainable_parameters": 16595, "curr_entropy_coeff": 0.0015431216992, "num_module_steps_trained_lifetime": 71820, "vf_loss": 0.320513516664505, "diff_num_grad_updates_vs_sampler_policy": 1.0, "curr_kl_coeff": 3.944920172216371e-05, "num_module_steps_trained": 5985, "mean_kl_loss": 3.2043039936979767e-06, "module_train_batch_size_mean": 998.2236050808158, "policy_loss": -2.4176977603929117e-05, "entropy": 0.6758841276168823, "num_module_steps_trained_lifetime_throughput": 744.3059584628173}, "intrinsic_reward_module": {"num_module_steps_trained": 5985, "diff_num_grad_updates_vs_sampler_policy": 1.0, "gradients_default_optimizer_global_norm": 0.0, "weights_seq_no": 12.0, "module_train_batch_size_mean": 998.2236050808158, "num_trainable_parameters": 8266, "default_optimizer_learning_rate": 0.0002715581955, "curr_entropy_coeff": 0.0015431216992, "num_module_steps_trained_lifetime": 71820, "total_loss": 0.0, "num_module_steps_trained_lifetime_throughput": 744.3151308648613}, "differentiable_learners": {"intrinsic_attention_ppo_learner": {"default_policy": {"vf_loss_unclipped": 42.33821487426758, "num_module_steps_trained_lifetime": 430920, "total_loss": 0.2486901730298996, "vf_loss": 0.32058942317962646, "mean_kl_loss": 3.3411681670258986e-06, "diff_num_grad_updates_vs_sampler_policy": 61.0, "policy_loss": -2.2889693354954943e-05, "num_module_steps_trained": 35910, "vf_explained_var": 0.0027007460594177246, "use_intrinsic_rewards": 1.0, "weights_seq_no": 72.0, "module_train_batch_size_mean": 997.512081102731, "entropy": 0.6758738160133362}, "__all_modules__": {"num_module_steps_trained_lifetime": 861840, "num_env_steps_trained_lifetime": 2592000, "num_env_steps_trained": 216000, "num_module_steps_trained": 71820, "num_env_steps_trained_lifetime_throughput": 52468.98458794581}, "intrinsic_reward_module": {"num_module_steps_trained": 35910, "weights_seq_no": 72.0, "module_train_batch_size_mean": 997.512081102731, "total_loss": 0.0, "num_module_steps_trained_lifetime": 430920, "diff_num_grad_updates_vs_sampler_policy": 61.0}}}, "IntrinsicAttentionMask": [[[0.16642430424690247, 0.16606728732585907, 0.16714148223400116, 0.1667829304933548, 0.1666753590106964, 0.16690866649150848], [0.1663883477449417, 0.1659785807132721, 0.16721190512180328, 0.1668000966310501, 0.1666765958070755, 0.1669445037841797], [0.16649626195430756, 0.1662450134754181, 0.16700051724910736, 0.16674849390983582, 0.16667285561561584, 0.1668369024991989], [0.1664603352546692, 0.16615623235702515, 0.1670709103345871, 0.16676568984985352, 0.16667412221431732, 0.1668727546930313], [0.16644953191280365, 0.16612957417964935, 0.16709205508232117, 0.1667708456516266, 0.16667447984218597, 0.16688351333141327], [0.166472926735878, 0.1661873757839203, 0.1670461893081665, 0.1667596399784088, 0.1666736751794815, 0.1668601632118225]], [[0.16678304970264435, 0.1665084809064865, 0.16687951982021332, 0.166927769780159, 0.16665296256542206, 0.16624821722507477], [0.16680550575256348, 0.16647791862487793, 0.16692063212394714, 0.16697822511196136, 0.16665029525756836, 0.1661674827337265], [0.1667751669883728, 0.16651920974254608, 0.16686509549617767, 0.1669100672006607, 0.16665391623973846, 0.16627657413482666], [0.16677120327949524, 0.16652455925941467, 0.16685785353183746, 0.16690120100975037, 0.16665436327457428, 0.16629073023796082], [0.16679370403289795, 0.16649401187896729, 0.16689899563789368, 0.16695167124271393, 0.16665171086788177, 0.16620998084545135], [0.16682681441307068, 0.16644886136054993, 0.16695965826511383, 0.1670261174440384, 0.16664773225784302, 0.16609083116054535]], [[0.1664242148399353, 0.1660671979188919, 0.1665496975183487, 0.16678284108638763, 0.16726741194725037, 0.16690859198570251], [0.16638824343681335, 0.16597847640514374, 0.16653230786323547, 0.16679999232292175, 0.16735656559467316, 0.16694439947605133], [0.16643686592578888, 0.16609837114810944, 0.16655582189559937, 0.16677682101726532, 0.16723614931106567, 0.1668960303068161], [0.16646027565002441, 0.16615618765354156, 0.1665671467781067, 0.16676564514636993, 0.16717810928821564, 0.16687269508838654], [0.16650882363319397, 0.16627611219882965, 0.16659057140350342, 0.16674239933490753, 0.16705773770809174, 0.16682425141334534], [0.1664728969335556, 0.1661873310804367, 0.16657322645187378, 0.16675961017608643, 0.16714683175086975, 0.16686011850833893]], [[0.16622261703014374, 0.16645807027816772, 0.16694748401641846, 0.16701115667819977, 0.16664861142635345, 0.16671216487884521], [0.16626493632793427, 0.1664779782295227, 0.16692069172859192, 0.16697828471660614, 0.16665035486221313, 0.166707843542099], [0.1663527488708496, 0.16651923954486847, 0.16686512529850006, 0.1669100970029831, 0.16665394604206085, 0.1666988581418991], [0.1663641631603241, 0.16652460396289825, 0.16685789823532104, 0.16690124571323395, 0.16665440797805786, 0.166697695851326], [0.16629911959171295, 0.16649404168128967, 0.16689901053905487, 0.16695168614387512, 0.16665172576904297, 0.16670432686805725], [0.16631053388118744, 0.16649939119815826, 0.16689179837703705, 0.16694283485412598, 0.16665220260620117, 0.16670314967632294]], [[0.1663258969783783, 0.16655871272087097, 0.16704264283180237, 0.16609421372413635, 0.16716858744621277, 0.16680997610092163], [0.16635878384113312, 0.16656915843486786, 0.16700634360313416, 0.16614942252635956, 0.167120099067688, 0.16679616272449493], [0.16642703115940094, 0.1665908247232437, 0.16693107783794403, 0.16626398265361786, 0.1670195758342743, 0.16676752269268036], [0.16629309952259064, 0.16654828190803528, 0.16707880795001984, 0.16603921353816986, 0.16721689701080322, 0.16682371497154236], [0.16644476354122162, 0.166596457362175, 0.1669115275144577, 0.16629375517368317, 0.16699346899986267, 0.16676007211208344], [0.16639424860477448, 0.1665804237127304, 0.1669672280550003, 0.16620893776416779, 0.16706787049770355, 0.16678129136562347]], [[0.16685859858989716, 0.16658389568328857, 0.1669550985097885, 0.16700337827205658, 0.16627544164657593, 0.16632351279258728], [0.16689564287662506, 0.1665678769350052, 0.1670108288526535, 0.1670684516429901, 0.1661999225616455, 0.16625726222991943], [0.16684558987617493, 0.16658952832221985, 0.16693554818630219, 0.1669805496931076, 0.16630195081233978, 0.16634678840637207], [0.1668390929698944, 0.16659234464168549, 0.16692577302455902, 0.16696913540363312, 0.1663152128458023, 0.16635841131210327], [0.16693730652332306, 0.16654981672763824, 0.16707351803779602, 0.16714166104793549, 0.16611498594284058, 0.166182741522789], [0.16693079471588135, 0.1665526181459427, 0.16706372797489166, 0.1671302318572998, 0.1661282330751419, 0.166194349527359]]]}, "num_training_step_calls_per_iteration": 1, "evaluation": {"env_runners": {"agent_episode_returns_mean": {"default_agent": 1.25}, "num_agent_steps_sampled": {"default_agent": 400}, "num_agent_steps_sampled_lifetime": {"default_agent": 4800}, "episode_return_min": -13.5, "module_to_env_connector": {"timers": {"connectors": {"remove_single_ts_time_rank_from_batch": 1.1745890563952774e-05, "tensor_to_numpy": 1.498356288454351e-05, "normalize_and_clip_actions": 7.772894843612998e-06, "listify_data_for_vector_env": 1.02937285651161e-05, "get_actions": 3.558839547132513e-05, "un_batch_to_individual_items": 6.422419229643085e-06}}, "connector_pipeline_timer": 0.00011308758772187942}, "rlmodule_inference_timer": 3.0372111145136324e-05, "env_step_timer": 1.3645501167868035e-05, "num_episodes_lifetime": 240, "env_to_module_sum_episodes_length_in": 10.368238394574323, "num_env_steps_sampled": 400, "env_to_module_connector": {"timers": {"connectors": {"add_observations_from_episodes_to_batch": 2.719088437304278e-06, "add_time_dim_to_batch_and_zero_pad": 6.803004307177663e-06, "batch_individual_items": 1.2263966313562344e-05, "numpy_to_tensor": 1.2101203704702047e-05, "add_states_from_episodes_to_batch": 2.675776592178101e-06}}, "connector_pipeline_timer": 5.921460391684499e-05}, "num_module_steps_sampled": {"default_policy": 400}, "env_reset_timer": 0.0006358261076161535, "num_module_steps_sampled_lifetime": {"default_policy": 4800}, "env_to_module_sum_episodes_length_out": 10.368238394574323, "module_episode_returns_mean": {"default_policy": 1.25}, "episode_return_mean": 1.25, "num_episodes": 20, "episode_len_mean": 20.0, "episode_return_max": 14.5, "num_env_steps_sampled_lifetime": 60400, "sample": 0.12930433461438476, "episode_duration_sec_mean": 0.005423730043694377, "weights_seq_no": 12.0, "episode_len_min": 20, "episode_len_max": 20, "time_between_sampling": 9.928662060626461}, "num_healthy_workers": 1, "actor_manager_num_outstanding_async_reqs": 0, "num_remote_worker_restarts": 0}, "num_env_steps_sampled_lifetime": -6165000.0, "fault_tolerance": {"num_healthy_workers": 0, "num_remote_worker_restarts": 0}, "env_runner_group": {"actor_manager_num_outstanding_async_reqs": 0}, "done": false, "training_iteration": 12, "trial_id": "b1df4_00000", "date": "2025-08-11_18-02-46", "timestamp": 1754928166, "time_this_iter_s": 9.917015790939331, "time_total_s": 126.65838313102722, "pid": 10074, "hostname": "Mac", "node_ip": "127.0.0.1", "config": {"exploration_config": {}, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 2, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "env": "Umbrella", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": false, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 0, "create_local_env_runner": true, "num_envs_per_env_runner": 1, "gym_env_vectorize_mode": "SYNC", "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "episodes_to_numpy": true, "max_requests_in_flight_per_env_runner": 1, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "merge_env_runner_states": "training_only", "broadcast_env_runner_states": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "complete_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "sampler_perf_stats_ema_coef": null, "_is_online": true, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": "auto", "num_aggregator_actors_per_learner": 0, "max_requests_in_flight_per_aggregator_actor": 3, "local_gpu_idx": 0, "max_requests_in_flight_per_learner": 3, "gamma": 1, "lr": 0.0002715581955, "grad_clip": 0.5, "grad_clip_by": "global_norm", "_train_batch_size_per_learner": 5000, "train_batch_size": 4000, "num_epochs": 1, "minibatch_size": 1000, "shuffle_batch_per_epoch": true, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "log_std_clip_param": 20.0, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "_disable_preprocessor_api": false, "_disable_action_flattening": false}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {"intrinsic_reward_coeff": 0.2795015916508}, "optimizer": {}, "_learner_class": "<class 'source.intrinsic_attention_ppo.learners.IntrinsicAttentionMetaLearner.IntrinsicAttentionMetaLearner'>", "callbacks_on_algorithm_init": null, "callbacks_on_env_runners_recreated": null, "callbacks_on_offline_eval_runners_recreated": null, "callbacks_on_checkpoint_loaded": null, "callbacks_on_environment_created": null, "callbacks_on_episode_created": null, "callbacks_on_episode_start": null, "callbacks_on_episode_step": null, "callbacks_on_episode_end": null, "callbacks_on_evaluate_start": null, "callbacks_on_evaluate_end": null, "callbacks_on_evaluate_offline_start": null, "callbacks_on_evaluate_offline_end": null, "callbacks_on_sample_end": null, "callbacks_on_train_result": null, "explore": true, "enable_rl_module_and_learner": true, "enable_env_runner_and_connector_v2": true, "_prior_exploration_config": {"type": "StochasticSampling"}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x3855fd760>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "offline_data_class": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_read_batch_size": null, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "materialize_data": false, "materialize_mapped_data": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "ignore_final_observation": false, "prelearner_class": null, "prelearner_buffer_class": null, "prelearner_buffer_kwargs": {}, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_remaining_data": false, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": 1, "evaluation_duration": 20, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_auto_duration_min_env_steps_per_sample": 100, "evaluation_auto_duration_max_env_steps_per_sample": 2000, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 1, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "offline_evaluation_interval": null, "num_offline_eval_runners": 0, "offline_loss_for_module_fn": null, "offline_evaluation_duration": 1, "offline_evaluation_parallel_to_training": false, "offline_evaluation_timeout_s": 120.0, "num_cpus_per_offline_eval_runner": 1, "num_gpus_per_offline_eval_runner": 0, "custom_resources_per_offline_eval_runner": {}, "restart_failed_offline_eval_runners": true, "ignore_offline_eval_runner_failures": false, "max_num_offline_eval_runner_restarts": 1000, "offline_eval_runner_restore_timeout_s": 1800.0, "max_requests_in_flight_per_offline_eval_runner": 1, "validate_offline_eval_runners_after_construction": true, "offline_eval_runner_health_probe_timeout_s": 30.0, "offline_eval_rl_module_inference_only": false, "broadcast_offline_eval_runner_states": false, "offline_eval_batch_size_per_runner": 256, "dataset_num_iters_per_eval_runner": 1, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "log_gradients": false, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 6, "restart_failed_env_runners": true, "ignore_env_runner_failures": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30.0, "env_runner_restore_timeout_s": 1800.0, "_model_config": {}, "_rl_module_spec": "MultiRLModuleSpec(multi_rl_module_class=<class 'ray.rllib.core.rl_module.multi_rl_module.MultiRLModule'>, observation_space=None, action_space=None, inference_only=False, model_config=None, rl_module_specs={'default_policy': RLModuleSpec(module_class=<class 'source.intrinsic_attention_ppo.rl_modules.DifferentiablePPOModule.DifferentiablePPOModule'>, observation_space=None, action_space=None, inference_only=False, learner_only=False, model_config={'vf_share_layers': True, 'embedding_dim': 62, 'max_seq_len': 6, 'policy_head_hidden_sizes': [32], 'value_head_hidden_sizes': [101], 'embedding_hidden_sizes': [121]}, catalog_class=None, load_state_path=None, model_config_dict=None), 'intrinsic_reward_module': RLModuleSpec(module_class=<class 'source.intrinsic_attention_ppo.rl_modules.IntrinsicAttentionModule.IntrinsicAttentionModule'>, observation_space=None, action_space=None, inference_only=False, learner_only=True, model_config={'intrinsic_reward_network': {'encoder_hidden_sizes': [], 'encoding_dim': 1, 'num_heads': 1, 'head_hidden_sizes': None, 'layers': [{'type': 'attention'}]}, 'extrinsic_value_hidden_layers': [127, 60], 'vf_share_layers': True, 'max_seq_len': 6}, catalog_class=None, load_state_path=None, model_config_dict=None)}, load_state_path=None, modules_to_load=None, module_specs={'default_policy': RLModuleSpec(module_class=<class 'source.intrinsic_attention_ppo.rl_modules.DifferentiablePPOModule.DifferentiablePPOModule'>, observation_space=None, action_space=None, inference_only=False, learner_only=False, model_config={'vf_share_layers': True, 'embedding_dim': 62, 'max_seq_len': 6, 'policy_head_hidden_sizes': [32], 'value_head_hidden_sizes': [101], 'embedding_hidden_sizes': [121]}, catalog_class=None, load_state_path=None, model_config_dict=None), 'intrinsic_reward_module': RLModuleSpec(module_class=<class 'source.intrinsic_attention_ppo.rl_modules.IntrinsicAttentionModule.IntrinsicAttentionModule'>, observation_space=None, action_space=None, inference_only=False, learner_only=True, model_config={'intrinsic_reward_network': {'encoder_hidden_sizes': [], 'encoding_dim': 1, 'num_heads': 1, 'head_hidden_sizes': None, 'layers': [{'type': 'attention'}]}, 'extrinsic_value_hidden_layers': [127, 60], 'vf_share_layers': True, 'max_seq_len': 6}, catalog_class=None, load_state_path=None, model_config_dict=None)})", "algorithm_config_overrides_per_module": {"intrinsic_reward_module": {"lr": 0.0002715581955}}, "_per_module_overrides": {}, "_validate_config": true, "_use_msgpack_checkpoints": false, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "env_task_fn": -1, "enable_connectors": -1, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.161583927863, "kl_target": 0.0201019014258, "vf_loss_coeff": 0.7790510010087, "entropy_coeff": 0.0015431216992, "clip_param": 0.2459212356676, "vf_clip_param": 0.3769744131561, "entropy_coeff_schedule": null, "lr_schedule": null, "sgd_minibatch_size": -1, "vf_share_layers": -1, "differentiable_learner_configs": ["DifferentiableLearnerConfig(learner_class=<class 'source.intrinsic_attention_ppo.learners.IntrinsicAttentionPPOLearner.IntrinsicAttentionPPOLearner'>, learner_connector=None, add_default_connectors_to_learner_pipeline=True, is_multi_agent=False, policies_to_update=['default_policy'], lr=0.0060984166342, num_total_minibatches=0, num_epochs=1, minibatch_size=1000, shuffle_batch_per_epoch=True)"], "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9485408017724, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.callbacks.callbacks.RLlibCallback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 126.65838313102722, "iterations_since_restore": 12, "perf": {"cpu_util_percent": 42.278571428571425, "ram_util_percent": 80.7}}
{"timers": {"training_iteration": 10.538939271446228, "restore_env_runners": 9.802012677026015e-06, "training_step": 10.538687933185267, "env_runner_sampling_timer": 1.736099550080372, "learner_update_timer": 8.604463227759704, "synch_weights": 0.0018039269393649731, "restore_eval_env_runners": 7.397573838950696e-05, "evaluation_iteration": 0.1409183250627232, "synch_eval_env_connectors": 0.00021499654791036423, "synch_env_connectors": 5.394582119586977e-06}, "env_runners": {"episode_return_max": 10.5, "module_to_env_connector": {"timers": {"connectors": {"tensor_to_numpy": 1.8057420577747606e-05, "normalize_and_clip_actions": 1.0126199468546267e-05, "un_batch_to_individual_items": 1.2702991583513215e-05, "listify_data_for_vector_env": 1.5020482532744518e-05, "get_actions": 4.983009561667461e-05, "remove_single_ts_time_rank_from_batch": 1.3441896309655677e-05}}, "connector_pipeline_timer": 0.0001505781840757335}, "episode_len_mean": 20.0, "episode_len_max": 20, "num_module_steps_sampled_lifetime": {"default_policy": -6782500.0}, "num_env_steps_sampled_lifetime": -6782500.0, "module_episode_returns_mean": {"default_policy": 3.1399999999999992}, "env_to_module_sum_episodes_length_out": 10.36823839457432, "episode_return_mean": 3.1399999999999992, "env_to_module_connector": {"timers": {"connectors": {"add_time_dim_to_batch_and_zero_pad": 9.010041279719796e-06, "add_observations_from_episodes_to_batch": 3.385662348644198e-06, "add_states_from_episodes_to_batch": 3.2239746023889524e-06, "numpy_to_tensor": 1.5586652933188043e-05, "batch_individual_items": 1.5104740358165995e-05}}, "connector_pipeline_timer": 7.174315166176048e-05}, "agent_episode_returns_mean": {"default_agent": 3.1399999999999992}, "env_step_timer": 2.028704321777297e-05, "sample": 0.006961468209299128, "num_episodes": 250.0, "num_agent_steps_sampled_lifetime": {"default_agent": -6782500.0}, "num_episodes_lifetime": -339125.0, "env_to_module_sum_episodes_length_in": 10.36823839457432, "num_agent_steps_sampled": {"default_agent": 5000.0}, "num_env_steps_sampled": 5000.0, "num_module_steps_sampled": {"default_policy": 5000.0}, "episode_return_min": -9.5, "episode_duration_sec_mean": 0.00669002287974581, "weights_seq_no": 12.0, "time_between_sampling": 0.03434175317962477, "env_reset_timer": 4.6185600677631935e-05, "episode_len_min": 20, "rlmodule_inference_timer": 4.063015074365969e-05, "num_env_steps_sampled_lifetime_throughput": 2973.852953181924}, "__all_modules__": {"learner_connector_sum_episodes_length_in": 5000.0, "learner_connector": {"connector_pipeline_timer": 0.1574716001795874, "timers": {"connectors": {"add_one_ts_to_episodes_and_truncate": 0.009163156920445762, "add_observations_from_episodes_to_batch": 0.000843506332373102, "add_columns_from_episodes_to_train_batch": 0.04183976974598284, "add_time_dim_to_batch_and_zero_pad": 0.09291896431702519, "add_states_from_episodes_to_batch": 0.0037859020911944455, "batch_individual_items": 0.008694434358086204, "numpy_to_tensor": 7.25855296142757e-05}}}, "learner_connector_sum_episodes_length_out": 5250.0}, "learners": {"__all_modules__": {"num_non_trainable_parameters": 0, "num_trainable_parameters": 24861, "num_module_steps_trained_lifetime": 155610, "num_env_steps_trained": 36000, "num_module_steps_trained": 11970, "num_env_steps_trained_lifetime": 468000, "num_env_steps_trained_lifetime_throughput": 4460.9154000147255, "num_module_steps_trained_throughput": 22609796.265334327, "num_module_steps_trained_lifetime_throughput": 14055921.514413914}, "default_policy": {"vf_explained_var": -0.0006672143936157227, "vf_loss_unclipped": 44.25940704345703, "use_intrinsic_rewards": 0.0, "weights_seq_no": 13.0, "total_loss": 0.24841547012329102, "num_trainable_parameters": 16595, "curr_entropy_coeff": 0.0015431216992, "num_module_steps_trained_lifetime": 77805, "vf_loss": 0.3205231726169586, "diff_num_grad_updates_vs_sampler_policy": 1.0, "curr_kl_coeff": 1.9724600861081854e-05, "num_module_steps_trained": 5985, "mean_kl_loss": 1.5157505913521163e-05, "module_train_batch_size_mean": 998.1808187151925, "policy_loss": -0.00024605399812571704, "entropy": 0.6754859685897827, "num_module_steps_trained_lifetime_throughput": 740.9539103743517}, "intrinsic_reward_module": {"num_module_steps_trained": 5985, "diff_num_grad_updates_vs_sampler_policy": 1.0, "gradients_default_optimizer_global_norm": 0.0, "weights_seq_no": 13.0, "module_train_batch_size_mean": 998.1808187151925, "num_trainable_parameters": 8266, "default_optimizer_learning_rate": 0.0002715581955, "curr_entropy_coeff": 0.0015431216992, "num_module_steps_trained_lifetime": 77805, "total_loss": 0.0, "num_module_steps_trained_lifetime_throughput": 740.9625212975608}, "differentiable_learners": {"intrinsic_attention_ppo_learner": {"default_policy": {"vf_loss_unclipped": 44.10133361816406, "num_module_steps_trained_lifetime": 466830, "total_loss": 0.24845443665981293, "vf_loss": 0.3205625116825104, "mean_kl_loss": 1.4257548173191026e-05, "diff_num_grad_updates_vs_sampler_policy": 66.0, "policy_loss": -0.0002400241355644539, "num_module_steps_trained": 35910, "vf_explained_var": 0.002479374408721924, "use_intrinsic_rewards": 1.0, "weights_seq_no": 78.0, "module_train_batch_size_mean": 997.5061250970534, "entropy": 0.6755167841911316}, "__all_modules__": {"num_module_steps_trained_lifetime": 933660, "num_env_steps_trained_lifetime": 2808000, "num_env_steps_trained": 216000, "num_module_steps_trained": 71820, "num_env_steps_trained_lifetime_throughput": 51564.60044257004}, "intrinsic_reward_module": {"num_module_steps_trained": 35910, "weights_seq_no": 78.0, "module_train_batch_size_mean": 997.5061250970534, "total_loss": 0.0, "num_module_steps_trained_lifetime": 466830, "diff_num_grad_updates_vs_sampler_policy": 66.0}}}, "IntrinsicAttentionMask": [[[0.16749845445156097, 0.16618932783603668, 0.16655388474464417, 0.1662839651107788, 0.16709567606449127, 0.16637864708900452], [0.1682906597852707, 0.16573625802993774, 0.16644567251205444, 0.16592027246952057, 0.16750271618366241, 0.1661044806241989], [0.16806916892528534, 0.1658627837896347, 0.16647599637508392, 0.16602185368537903, 0.16738906502723694, 0.16618110239505768], [0.16823309659957886, 0.16576912999153137, 0.166453555226326, 0.16594664752483368, 0.1674731969833374, 0.1661243736743927], [0.16774126887321472, 0.16605031490325928, 0.16652080416679382, 0.16617241501808167, 0.1672206073999405, 0.16629460453987122], [0.16817554831504822, 0.1658019870519638, 0.16646143794059753, 0.16597305238246918, 0.1674436628818512, 0.16614428162574768]], [[0.16693441569805145, 0.16665960848331451, 0.16657714545726776, 0.16662530601024628, 0.16635100543498993, 0.1668524444103241], [0.16698618233203888, 0.16665823757648468, 0.1665598452091217, 0.16661730408668518, 0.16629008948802948, 0.16688835620880127], [0.16700173914432526, 0.16665782034397125, 0.16655464470386505, 0.16661491990089417, 0.16627179086208344, 0.1668991595506668], [0.16699263453483582, 0.16665804386138916, 0.1665576696395874, 0.1666163057088852, 0.16628246009349823, 0.16689282655715942], [0.16704440116882324, 0.16665665805339813, 0.16654035449028015, 0.1666082739830017, 0.16622155904769897, 0.1669287234544754], [0.16694985330104828, 0.16665920615196228, 0.1665719896554947, 0.16662293672561646, 0.16633285582065582, 0.16686315834522247]], [[0.16652269661426544, 0.16616545617580414, 0.16724029183387756, 0.1668815165758133, 0.16677390038967133, 0.16641613841056824], [0.16650129854679108, 0.16609124839305878, 0.16732540726661682, 0.16691331565380096, 0.1667897254228592, 0.1663789600133896], [0.16656546294689178, 0.16631411015987396, 0.1670699268579483, 0.1668177992105484, 0.16674213111400604, 0.16649049520492554], [0.1665441244840622, 0.1662398725748062, 0.16715501248836517, 0.16684964299201965, 0.16675801575183868, 0.16645337641239166], [0.16653768718242645, 0.16621756553649902, 0.16718055307865143, 0.16685917973518372, 0.16676275432109833, 0.16644220054149628], [0.16651631891727448, 0.16614332795143127, 0.1672656536102295, 0.16689099371433258, 0.16677860915660858, 0.16640503704547882]], [[0.16643230617046356, 0.1665925234556198, 0.1669253408908844, 0.16696862876415253, 0.1667221486568451, 0.16635902225971222], [0.16646519303321838, 0.1666029542684555, 0.1668890416622162, 0.16692624986171722, 0.1667143851518631, 0.1664021909236908], [0.16653341054916382, 0.1666245460510254, 0.16681376099586487, 0.16683834791183472, 0.16669824719429016, 0.16649170219898224], [0.16654226183891296, 0.16662734746932983, 0.1668039709329605, 0.16682693362236023, 0.16669616103172302, 0.16650334000587463], [0.1664917767047882, 0.16661137342453003, 0.1668597161769867, 0.16689199209213257, 0.1667080968618393, 0.1664370596408844], [0.16641727089881897, 0.16658776998519897, 0.16694198548793793, 0.1669880449771881, 0.16672571003437042, 0.16633929312229156]], [[0.16720007359981537, 0.16633820533752441, 0.16670309007167816, 0.1664329320192337, 0.16679801046848297, 0.16652768850326538], [0.16753420233726501, 0.16613294184207916, 0.16672563552856445, 0.16628670692443848, 0.16687993705272675, 0.16644062101840973], [0.16739246249198914, 0.16621994972229004, 0.1667160838842392, 0.16634869575500488, 0.16684521734714508, 0.1664775311946869], [0.16749736666679382, 0.16615553200244904, 0.16672314703464508, 0.16630280017852783, 0.16687092185020447, 0.16645020246505737], [0.16735567152500153, 0.1662425696849823, 0.16671361029148102, 0.16636481881141663, 0.1668362021446228, 0.16648714244365692], [0.16746054589748383, 0.1661781370639801, 0.1667206734418869, 0.16631890833377838, 0.1668619066476822, 0.1664597988128662]], [[0.16642135381698608, 0.16606009006500244, 0.16654832661151886, 0.16721084713935852, 0.16684786975383759, 0.16691149771213531], [0.16638539731502533, 0.16597136855125427, 0.16653095185756683, 0.16729062795639038, 0.16687434911727905, 0.16694732010364532], [0.16643397510051727, 0.16609123349189758, 0.16655443608760834, 0.16718286275863647, 0.16683857142925262, 0.1668989509344101], [0.16649965941905975, 0.16625341773033142, 0.16658616065979004, 0.16703718900680542, 0.16679014265537262, 0.16683347523212433], [0.1664636880159378, 0.1661645919084549, 0.166568785905838, 0.1671168953180313, 0.16681663691997528, 0.16686928272247314], [0.166470006108284, 0.16618019342422485, 0.16657184064388275, 0.16710291802883148, 0.166812002658844, 0.16686300933361053]]]}, "num_training_step_calls_per_iteration": 1, "evaluation": {"env_runners": {"agent_episode_returns_mean": {"default_agent": 0.65}, "num_agent_steps_sampled": {"default_agent": 400}, "num_agent_steps_sampled_lifetime": {"default_agent": 5200}, "episode_return_min": -13.5, "module_to_env_connector": {"timers": {"connectors": {"remove_single_ts_time_rank_from_batch": 1.1743475006201386e-05, "tensor_to_numpy": 1.4687301500020662e-05, "normalize_and_clip_actions": 7.838979606626633e-06, "listify_data_for_vector_env": 1.0204914942610694e-05, "get_actions": 3.529989463317959e-05, "un_batch_to_individual_items": 6.446247806939838e-06}}, "connector_pipeline_timer": 0.0001122557072681496}, "rlmodule_inference_timer": 3.0265934880406205e-05, "env_step_timer": 1.356744450034682e-05, "num_episodes_lifetime": 260, "env_to_module_sum_episodes_length_in": 10.368238394574323, "num_env_steps_sampled": 400, "env_to_module_connector": {"timers": {"connectors": {"add_observations_from_episodes_to_batch": 2.715495736725537e-06, "add_time_dim_to_batch_and_zero_pad": 6.673319524914753e-06, "batch_individual_items": 1.202277514865762e-05, "numpy_to_tensor": 1.1922764777737838e-05, "add_states_from_episodes_to_batch": 2.6518711767732894e-06}}, "connector_pipeline_timer": 5.796577905235021e-05}, "num_module_steps_sampled": {"default_policy": 400}, "env_reset_timer": 0.0006327032565075932, "num_module_steps_sampled_lifetime": {"default_policy": 5200}, "env_to_module_sum_episodes_length_out": 10.368238394574323, "module_episode_returns_mean": {"default_policy": 0.65}, "episode_return_mean": 0.65, "num_episodes": 20, "episode_len_mean": 20.0, "episode_return_max": 14.5, "num_env_steps_sampled_lifetime": 65400, "sample": 0.12914455376933912, "episode_duration_sec_mean": 0.005228562955744564, "weights_seq_no": 13.0, "episode_len_min": 20, "episode_len_max": 20, "time_between_sampling": 9.931288146679838}, "num_healthy_workers": 1, "actor_manager_num_outstanding_async_reqs": 0, "num_remote_worker_restarts": 0}, "num_env_steps_sampled_lifetime": -6782500.0, "fault_tolerance": {"num_healthy_workers": 0, "num_remote_worker_restarts": 0}, "env_runner_group": {"actor_manager_num_outstanding_async_reqs": 0}, "done": false, "training_iteration": 13, "trial_id": "b1df4_00000", "date": "2025-08-11_18-02-56", "timestamp": 1754928176, "time_this_iter_s": 10.28880000114441, "time_total_s": 136.94718313217163, "pid": 10074, "hostname": "Mac", "node_ip": "127.0.0.1", "config": {"exploration_config": {}, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 2, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "env": "Umbrella", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": false, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 0, "create_local_env_runner": true, "num_envs_per_env_runner": 1, "gym_env_vectorize_mode": "SYNC", "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "episodes_to_numpy": true, "max_requests_in_flight_per_env_runner": 1, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "merge_env_runner_states": "training_only", "broadcast_env_runner_states": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "complete_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "sampler_perf_stats_ema_coef": null, "_is_online": true, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": "auto", "num_aggregator_actors_per_learner": 0, "max_requests_in_flight_per_aggregator_actor": 3, "local_gpu_idx": 0, "max_requests_in_flight_per_learner": 3, "gamma": 1, "lr": 0.0002715581955, "grad_clip": 0.5, "grad_clip_by": "global_norm", "_train_batch_size_per_learner": 5000, "train_batch_size": 4000, "num_epochs": 1, "minibatch_size": 1000, "shuffle_batch_per_epoch": true, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "log_std_clip_param": 20.0, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "_disable_preprocessor_api": false, "_disable_action_flattening": false}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {"intrinsic_reward_coeff": 0.2795015916508}, "optimizer": {}, "_learner_class": "<class 'source.intrinsic_attention_ppo.learners.IntrinsicAttentionMetaLearner.IntrinsicAttentionMetaLearner'>", "callbacks_on_algorithm_init": null, "callbacks_on_env_runners_recreated": null, "callbacks_on_offline_eval_runners_recreated": null, "callbacks_on_checkpoint_loaded": null, "callbacks_on_environment_created": null, "callbacks_on_episode_created": null, "callbacks_on_episode_start": null, "callbacks_on_episode_step": null, "callbacks_on_episode_end": null, "callbacks_on_evaluate_start": null, "callbacks_on_evaluate_end": null, "callbacks_on_evaluate_offline_start": null, "callbacks_on_evaluate_offline_end": null, "callbacks_on_sample_end": null, "callbacks_on_train_result": null, "explore": true, "enable_rl_module_and_learner": true, "enable_env_runner_and_connector_v2": true, "_prior_exploration_config": {"type": "StochasticSampling"}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x3855fd760>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "offline_data_class": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_read_batch_size": null, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "materialize_data": false, "materialize_mapped_data": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "ignore_final_observation": false, "prelearner_class": null, "prelearner_buffer_class": null, "prelearner_buffer_kwargs": {}, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_remaining_data": false, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": 1, "evaluation_duration": 20, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_auto_duration_min_env_steps_per_sample": 100, "evaluation_auto_duration_max_env_steps_per_sample": 2000, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 1, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "offline_evaluation_interval": null, "num_offline_eval_runners": 0, "offline_loss_for_module_fn": null, "offline_evaluation_duration": 1, "offline_evaluation_parallel_to_training": false, "offline_evaluation_timeout_s": 120.0, "num_cpus_per_offline_eval_runner": 1, "num_gpus_per_offline_eval_runner": 0, "custom_resources_per_offline_eval_runner": {}, "restart_failed_offline_eval_runners": true, "ignore_offline_eval_runner_failures": false, "max_num_offline_eval_runner_restarts": 1000, "offline_eval_runner_restore_timeout_s": 1800.0, "max_requests_in_flight_per_offline_eval_runner": 1, "validate_offline_eval_runners_after_construction": true, "offline_eval_runner_health_probe_timeout_s": 30.0, "offline_eval_rl_module_inference_only": false, "broadcast_offline_eval_runner_states": false, "offline_eval_batch_size_per_runner": 256, "dataset_num_iters_per_eval_runner": 1, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "log_gradients": false, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 6, "restart_failed_env_runners": true, "ignore_env_runner_failures": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30.0, "env_runner_restore_timeout_s": 1800.0, "_model_config": {}, "_rl_module_spec": "MultiRLModuleSpec(multi_rl_module_class=<class 'ray.rllib.core.rl_module.multi_rl_module.MultiRLModule'>, observation_space=None, action_space=None, inference_only=False, model_config=None, rl_module_specs={'default_policy': RLModuleSpec(module_class=<class 'source.intrinsic_attention_ppo.rl_modules.DifferentiablePPOModule.DifferentiablePPOModule'>, observation_space=None, action_space=None, inference_only=False, learner_only=False, model_config={'vf_share_layers': True, 'embedding_dim': 62, 'max_seq_len': 6, 'policy_head_hidden_sizes': [32], 'value_head_hidden_sizes': [101], 'embedding_hidden_sizes': [121]}, catalog_class=None, load_state_path=None, model_config_dict=None), 'intrinsic_reward_module': RLModuleSpec(module_class=<class 'source.intrinsic_attention_ppo.rl_modules.IntrinsicAttentionModule.IntrinsicAttentionModule'>, observation_space=None, action_space=None, inference_only=False, learner_only=True, model_config={'intrinsic_reward_network': {'encoder_hidden_sizes': [], 'encoding_dim': 1, 'num_heads': 1, 'head_hidden_sizes': None, 'layers': [{'type': 'attention'}]}, 'extrinsic_value_hidden_layers': [127, 60], 'vf_share_layers': True, 'max_seq_len': 6}, catalog_class=None, load_state_path=None, model_config_dict=None)}, load_state_path=None, modules_to_load=None, module_specs={'default_policy': RLModuleSpec(module_class=<class 'source.intrinsic_attention_ppo.rl_modules.DifferentiablePPOModule.DifferentiablePPOModule'>, observation_space=None, action_space=None, inference_only=False, learner_only=False, model_config={'vf_share_layers': True, 'embedding_dim': 62, 'max_seq_len': 6, 'policy_head_hidden_sizes': [32], 'value_head_hidden_sizes': [101], 'embedding_hidden_sizes': [121]}, catalog_class=None, load_state_path=None, model_config_dict=None), 'intrinsic_reward_module': RLModuleSpec(module_class=<class 'source.intrinsic_attention_ppo.rl_modules.IntrinsicAttentionModule.IntrinsicAttentionModule'>, observation_space=None, action_space=None, inference_only=False, learner_only=True, model_config={'intrinsic_reward_network': {'encoder_hidden_sizes': [], 'encoding_dim': 1, 'num_heads': 1, 'head_hidden_sizes': None, 'layers': [{'type': 'attention'}]}, 'extrinsic_value_hidden_layers': [127, 60], 'vf_share_layers': True, 'max_seq_len': 6}, catalog_class=None, load_state_path=None, model_config_dict=None)})", "algorithm_config_overrides_per_module": {"intrinsic_reward_module": {"lr": 0.0002715581955}}, "_per_module_overrides": {}, "_validate_config": true, "_use_msgpack_checkpoints": false, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "env_task_fn": -1, "enable_connectors": -1, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.161583927863, "kl_target": 0.0201019014258, "vf_loss_coeff": 0.7790510010087, "entropy_coeff": 0.0015431216992, "clip_param": 0.2459212356676, "vf_clip_param": 0.3769744131561, "entropy_coeff_schedule": null, "lr_schedule": null, "sgd_minibatch_size": -1, "vf_share_layers": -1, "differentiable_learner_configs": ["DifferentiableLearnerConfig(learner_class=<class 'source.intrinsic_attention_ppo.learners.IntrinsicAttentionPPOLearner.IntrinsicAttentionPPOLearner'>, learner_connector=None, add_default_connectors_to_learner_pipeline=True, is_multi_agent=False, policies_to_update=['default_policy'], lr=0.0060984166342, num_total_minibatches=0, num_epochs=1, minibatch_size=1000, shuffle_batch_per_epoch=True)"], "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9485408017724, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.callbacks.callbacks.RLlibCallback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 136.94718313217163, "iterations_since_restore": 13, "perf": {"cpu_util_percent": 43.442857142857136, "ram_util_percent": 80.89285714285714}}
{"timers": {"training_iteration": 10.538825833731726, "restore_env_runners": 9.812743087293604e-06, "training_step": 10.538574586354137, "env_runner_sampling_timer": 1.735324294998673, "learner_update_timer": 8.605053357152245, "synch_weights": 0.001804055590614787, "restore_eval_env_runners": 7.369307179692674e-05, "evaluation_iteration": 0.14072839848254304, "synch_eval_env_connectors": 0.00021457283189697945, "synch_env_connectors": 5.416466910722735e-06}, "env_runners": {"episode_return_max": 10.5, "module_to_env_connector": {"timers": {"connectors": {"tensor_to_numpy": 1.519484066352821e-05, "normalize_and_clip_actions": 8.152707044051956e-06, "un_batch_to_individual_items": 6.633290832790836e-06, "listify_data_for_vector_env": 1.0641902697032909e-05, "get_actions": 3.8341712649451344e-05, "remove_single_ts_time_rank_from_batch": 1.2030188627348746e-05}}, "connector_pipeline_timer": 0.00011772507105776453}, "episode_len_mean": 20.0, "episode_len_max": 20, "num_module_steps_sampled_lifetime": {"default_policy": -7400000.0}, "num_env_steps_sampled_lifetime": -7400000.0, "module_episode_returns_mean": {"default_policy": 4.18}, "env_to_module_sum_episodes_length_out": 10.36823839457432, "episode_return_mean": 4.18, "env_to_module_connector": {"timers": {"connectors": {"add_time_dim_to_batch_and_zero_pad": 7.037833322627319e-06, "add_observations_from_episodes_to_batch": 2.8761719391960115e-06, "add_states_from_episodes_to_batch": 2.7860457075613465e-06, "numpy_to_tensor": 1.2557130133184095e-05, "batch_individual_items": 1.2518697002550004e-05}}, "connector_pipeline_timer": 5.991968879644722e-05}, "agent_episode_returns_mean": {"default_agent": 4.18}, "env_step_timer": 1.3912917821260442e-05, "sample": 0.005877484083775585, "num_episodes": 250.0, "num_agent_steps_sampled_lifetime": {"default_agent": -7400000.0}, "num_episodes_lifetime": -370000.0, "env_to_module_sum_episodes_length_in": 10.36823839457432, "num_agent_steps_sampled": {"default_agent": 5000.0}, "num_env_steps_sampled": 5000.0, "num_module_steps_sampled": {"default_policy": 5000.0}, "episode_return_min": -9.5, "episode_duration_sec_mean": 0.005274306172970682, "weights_seq_no": 13.0, "time_between_sampling": 0.033606222110280394, "env_reset_timer": 3.9900121258529226e-05, "episode_len_min": 20, "rlmodule_inference_timer": 3.164144597694235e-05, "num_env_steps_sampled_lifetime_throughput": 3251.5931619949865}, "__all_modules__": {"learner_connector_sum_episodes_length_in": 5000.0, "learner_connector": {"connector_pipeline_timer": 0.15744758834757713, "timers": {"connectors": {"add_one_ts_to_episodes_and_truncate": 0.009163213690839781, "add_observations_from_episodes_to_batch": 0.0008447791893026478, "add_columns_from_episodes_to_train_batch": 0.041845052048762994, "add_time_dim_to_batch_and_zero_pad": 0.09289674509447442, "add_states_from_episodes_to_batch": 0.0037861901500408474, "batch_individual_items": 0.008686120014858202, "numpy_to_tensor": 7.252175502888675e-05}}}, "learner_connector_sum_episodes_length_out": 5250.0}, "learners": {"__all_modules__": {"num_non_trainable_parameters": 0, "num_trainable_parameters": 24861, "num_module_steps_trained_lifetime": 167580, "num_env_steps_trained": 36000, "num_module_steps_trained": 11970, "num_env_steps_trained_lifetime": 504000, "num_env_steps_trained_lifetime_throughput": 4438.303165904464, "num_module_steps_trained_throughput": 22046834.1156562, "num_module_steps_trained_lifetime_throughput": 13951762.381864388}, "default_policy": {"vf_explained_var": 0.0006967782974243164, "vf_loss_unclipped": 45.12190246582031, "use_intrinsic_rewards": 0.0, "weights_seq_no": 14.0, "total_loss": 0.24839024245738983, "num_trainable_parameters": 16595, "curr_entropy_coeff": 0.0015431216992, "num_module_steps_trained_lifetime": 83790, "vf_loss": 0.3205210566520691, "diff_num_grad_updates_vs_sampler_policy": 1.0, "curr_kl_coeff": 9.862300430540927e-06, "num_module_steps_trained": 5985, "mean_kl_loss": 1.754924414854031e-05, "module_train_batch_size_mean": 998.1405362012929, "policy_loss": -0.0002708520623855293, "entropy": 0.6747086644172668, "num_module_steps_trained_lifetime_throughput": 737.2208040088733}, "intrinsic_reward_module": {"num_module_steps_trained": 5985, "diff_num_grad_updates_vs_sampler_policy": 1.0, "gradients_default_optimizer_global_norm": 0.0, "weights_seq_no": 14.0, "module_train_batch_size_mean": 998.1405362012929, "num_trainable_parameters": 8266, "default_optimizer_learning_rate": 0.0002715581955, "curr_entropy_coeff": 0.0015431216992, "num_module_steps_trained_lifetime": 83790, "total_loss": 0.0, "num_module_steps_trained_lifetime_throughput": 737.2288830738022}, "differentiable_learners": {"intrinsic_attention_ppo_learner": {"default_policy": {"vf_loss_unclipped": 44.9819221496582, "num_module_steps_trained_lifetime": 502740, "total_loss": 0.24842415750026703, "vf_loss": 0.32054969668388367, "mean_kl_loss": 1.6485080777783878e-05, "diff_num_grad_updates_vs_sampler_policy": 71.0, "policy_loss": -0.00026186107425019145, "num_module_steps_trained": 35910, "vf_explained_var": 0.002310633659362793, "use_intrinsic_rewards": 1.0, "weights_seq_no": 84.0, "module_train_batch_size_mean": 997.501977255973, "entropy": 0.6747433543205261}, "__all_modules__": {"num_module_steps_trained_lifetime": 1005480, "num_env_steps_trained_lifetime": 3024000, "num_env_steps_trained": 216000, "num_module_steps_trained": 71820, "num_env_steps_trained_lifetime_throughput": 50700.4196980524}, "intrinsic_reward_module": {"num_module_steps_trained": 35910, "weights_seq_no": 84.0, "module_train_batch_size_mean": 997.501977255973, "total_loss": 0.0, "num_module_steps_trained_lifetime": 502740, "diff_num_grad_updates_vs_sampler_policy": 71.0}}}, "IntrinsicAttentionMask": [[[0.1673491895198822, 0.16604124009609222, 0.16685177385807037, 0.16658136248588562, 0.16650021076202393, 0.16667620837688446], [0.16799882054328918, 0.1654488444328308, 0.1670268028974533, 0.1664995700120926, 0.16634149849414825, 0.16668441891670227], [0.16759546101093292, 0.16581635177135468, 0.16691826283931732, 0.1665504276752472, 0.16644008457660675, 0.16667942702770233], [0.16772973537445068, 0.16569389402866364, 0.16695444285869598, 0.16653351485729218, 0.1664072871208191, 0.16668112576007843], [0.16777008771896362, 0.16565711796283722, 0.1669653058052063, 0.16652843356132507, 0.16639742255210876, 0.16668161749839783], [0.16768260300159454, 0.1657368689775467, 0.16694174706935883, 0.16653946042060852, 0.16641879081726074, 0.16668052971363068]], [[0.166733980178833, 0.1665753573179245, 0.1667896807193756, 0.16655555367469788, 0.16665884852409363, 0.16668668389320374], [0.16675646603107452, 0.1665448099374771, 0.16683080792427063, 0.16651839017868042, 0.16665619611740112, 0.16669334471225739], [0.16672605276107788, 0.16658605635166168, 0.16677521169185638, 0.1665685623884201, 0.16665972769260406, 0.16668429970741272], [0.16675928235054016, 0.1665409952402115, 0.1668359488248825, 0.16651375591754913, 0.16665586829185486, 0.16669417917728424], [0.1667446345090866, 0.16656090319156647, 0.16680915653705597, 0.16653795540332794, 0.16665759682655334, 0.16668982803821564], [0.16674065589904785, 0.16656623780727386, 0.16680191457271576, 0.16654445230960846, 0.16665802896022797, 0.16668865084648132]], [[0.16757334768772125, 0.1662636399269104, 0.16662836074829102, 0.16635830700397491, 0.16672323644161224, 0.1664530336856842], [0.16843758523464203, 0.16588094830513, 0.16659098863601685, 0.16606512665748596, 0.16677594184875488, 0.16624948382377625], [0.16819588840007782, 0.16598783433437347, 0.1666015237569809, 0.16614703834056854, 0.16676130890846252, 0.16630639135837555], [0.16837474703788757, 0.16590869426727295, 0.16659371554851532, 0.1660863757133484, 0.16677212715148926, 0.16626425087451935], [0.16813315451145172, 0.1660156100988388, 0.16660425066947937, 0.16616833209991455, 0.1667575240135193, 0.16632118821144104], [0.1683119684457779, 0.16593648493289948, 0.16659647226333618, 0.1661076843738556, 0.16676834225654602, 0.16627906262874603]], [[0.16656774282455444, 0.16672810912132263, 0.1670611947774887, 0.16669733822345734, 0.16645124554634094, 0.16649441421031952], [0.1665816307067871, 0.1667194813489914, 0.1670057773590088, 0.16669303178787231, 0.16648146510124207, 0.16651856899261475], [0.16661043465137482, 0.16670162975788116, 0.1668909192085266, 0.1666841357946396, 0.16654416918754578, 0.16656872630119324], [0.1665789783000946, 0.1667211502790451, 0.1670164167881012, 0.16669388115406036, 0.16647568345069885, 0.16651394963264465], [0.16655763983726501, 0.16673436760902405, 0.16710148751735687, 0.16670045256614685, 0.1664292812347412, 0.16647683084011078], [0.16656136512756348, 0.1667320281267166, 0.16708654165267944, 0.16669927537441254, 0.16643740236759186, 0.1664833277463913]], [[0.16642437875270844, 0.16665734350681305, 0.16654986143112183, 0.16678300499916077, 0.1672675758600235, 0.166317880153656], [0.16644777357578278, 0.16665825247764587, 0.16656115651130676, 0.1667717844247818, 0.16720949113368988, 0.1663515269756317], [0.16643700003623962, 0.16665783524513245, 0.1665559560060501, 0.16677695512771606, 0.16723628342151642, 0.16633601486682892], [0.16646037995815277, 0.16665875911712646, 0.16656725108623505, 0.1667657494544983, 0.167178213596344, 0.16636967658996582], [0.16650891304016113, 0.16666066646575928, 0.16659066081047058, 0.1667424887418747, 0.1670578271150589, 0.16643951833248138], [0.16641367971897125, 0.16665691137313843, 0.16654469072818756, 0.16678813099861145, 0.16729415953159332, 0.16630247235298157]], [[0.16700996458530426, 0.16628199815750122, 0.16665253043174744, 0.16715487837791443, 0.16642628610134125, 0.16647440195083618], [0.16718581318855286, 0.16608506441116333, 0.16664503514766693, 0.16740523278713226, 0.16630305349826813, 0.1663757711648941], [0.16709621250629425, 0.1661854088306427, 0.16664886474609375, 0.16727764904499054, 0.1663658618927002, 0.16642604768276215], [0.16697503626346588, 0.16632109880447388, 0.16665397584438324, 0.16710518300533295, 0.16645072400569916, 0.1664939671754837], [0.16715089976787567, 0.166124165058136, 0.16664652526378632, 0.1673555076122284, 0.16632752120494843, 0.16639535129070282], [0.16713924705982208, 0.1661372035741806, 0.1666470319032669, 0.16733893752098083, 0.16633568704128265, 0.16640189290046692]]]}, "num_training_step_calls_per_iteration": 1, "evaluation": {"env_runners": {"agent_episode_returns_mean": {"default_agent": -0.35}, "num_agent_steps_sampled": {"default_agent": 400}, "num_agent_steps_sampled_lifetime": {"default_agent": 5600}, "episode_return_min": -13.5, "module_to_env_connector": {"timers": {"connectors": {"remove_single_ts_time_rank_from_batch": 1.2192989429907501e-05, "tensor_to_numpy": 1.6188745555950196e-05, "normalize_and_clip_actions": 8.128362764290696e-06, "listify_data_for_vector_env": 1.0953205446139506e-05, "get_actions": 4.043110562488302e-05, "un_batch_to_individual_items": 7.005288938248968e-06}}, "connector_pipeline_timer": 0.00012199073137594996}, "rlmodule_inference_timer": 3.300712614838029e-05, "env_step_timer": 1.4806241481715929e-05, "num_episodes_lifetime": 280, "env_to_module_sum_episodes_length_in": 10.368238394574323, "num_env_steps_sampled": 400, "env_to_module_connector": {"timers": {"connectors": {"add_observations_from_episodes_to_batch": 2.8586528920388183e-06, "add_time_dim_to_batch_and_zero_pad": 7.234353533486343e-06, "batch_individual_items": 1.3312552500290755e-05, "numpy_to_tensor": 1.3294937967340698e-05, "add_states_from_episodes_to_batch": 2.7541104818662583e-06}}, "connector_pipeline_timer": 6.323241083780699e-05}, "num_module_steps_sampled": {"default_policy": 400}, "env_reset_timer": 0.0006304341337701967, "num_module_steps_sampled_lifetime": {"default_policy": 5600}, "env_to_module_sum_episodes_length_out": 10.368238394574323, "module_episode_returns_mean": {"default_policy": -0.35}, "episode_return_mean": -0.35, "num_episodes": 20, "episode_len_mean": 20.0, "episode_return_max": 13.5, "num_env_steps_sampled_lifetime": 70400, "sample": 0.12909991656124284, "episode_duration_sec_mean": 0.005326327508082613, "weights_seq_no": 14.0, "episode_len_min": 20, "episode_len_max": 20, "time_between_sampling": 9.937546053133191}, "num_healthy_workers": 1, "actor_manager_num_outstanding_async_reqs": 0, "num_remote_worker_restarts": 0}, "num_env_steps_sampled_lifetime": -7400000.0, "fault_tolerance": {"num_healthy_workers": 0, "num_remote_worker_restarts": 0}, "env_runner_group": {"actor_manager_num_outstanding_async_reqs": 0}, "done": false, "training_iteration": 14, "trial_id": "b1df4_00000", "date": "2025-08-11_18-03-07", "timestamp": 1754928187, "time_this_iter_s": 10.665480136871338, "time_total_s": 147.61266326904297, "pid": 10074, "hostname": "Mac", "node_ip": "127.0.0.1", "config": {"exploration_config": {}, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 2, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "env": "Umbrella", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": false, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 0, "create_local_env_runner": true, "num_envs_per_env_runner": 1, "gym_env_vectorize_mode": "SYNC", "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "episodes_to_numpy": true, "max_requests_in_flight_per_env_runner": 1, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "merge_env_runner_states": "training_only", "broadcast_env_runner_states": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "complete_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "sampler_perf_stats_ema_coef": null, "_is_online": true, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": "auto", "num_aggregator_actors_per_learner": 0, "max_requests_in_flight_per_aggregator_actor": 3, "local_gpu_idx": 0, "max_requests_in_flight_per_learner": 3, "gamma": 1, "lr": 0.0002715581955, "grad_clip": 0.5, "grad_clip_by": "global_norm", "_train_batch_size_per_learner": 5000, "train_batch_size": 4000, "num_epochs": 1, "minibatch_size": 1000, "shuffle_batch_per_epoch": true, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "log_std_clip_param": 20.0, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "_disable_preprocessor_api": false, "_disable_action_flattening": false}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {"intrinsic_reward_coeff": 0.2795015916508}, "optimizer": {}, "_learner_class": "<class 'source.intrinsic_attention_ppo.learners.IntrinsicAttentionMetaLearner.IntrinsicAttentionMetaLearner'>", "callbacks_on_algorithm_init": null, "callbacks_on_env_runners_recreated": null, "callbacks_on_offline_eval_runners_recreated": null, "callbacks_on_checkpoint_loaded": null, "callbacks_on_environment_created": null, "callbacks_on_episode_created": null, "callbacks_on_episode_start": null, "callbacks_on_episode_step": null, "callbacks_on_episode_end": null, "callbacks_on_evaluate_start": null, "callbacks_on_evaluate_end": null, "callbacks_on_evaluate_offline_start": null, "callbacks_on_evaluate_offline_end": null, "callbacks_on_sample_end": null, "callbacks_on_train_result": null, "explore": true, "enable_rl_module_and_learner": true, "enable_env_runner_and_connector_v2": true, "_prior_exploration_config": {"type": "StochasticSampling"}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x3855fd760>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "offline_data_class": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_read_batch_size": null, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "materialize_data": false, "materialize_mapped_data": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "ignore_final_observation": false, "prelearner_class": null, "prelearner_buffer_class": null, "prelearner_buffer_kwargs": {}, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_remaining_data": false, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": 1, "evaluation_duration": 20, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_auto_duration_min_env_steps_per_sample": 100, "evaluation_auto_duration_max_env_steps_per_sample": 2000, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 1, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "offline_evaluation_interval": null, "num_offline_eval_runners": 0, "offline_loss_for_module_fn": null, "offline_evaluation_duration": 1, "offline_evaluation_parallel_to_training": false, "offline_evaluation_timeout_s": 120.0, "num_cpus_per_offline_eval_runner": 1, "num_gpus_per_offline_eval_runner": 0, "custom_resources_per_offline_eval_runner": {}, "restart_failed_offline_eval_runners": true, "ignore_offline_eval_runner_failures": false, "max_num_offline_eval_runner_restarts": 1000, "offline_eval_runner_restore_timeout_s": 1800.0, "max_requests_in_flight_per_offline_eval_runner": 1, "validate_offline_eval_runners_after_construction": true, "offline_eval_runner_health_probe_timeout_s": 30.0, "offline_eval_rl_module_inference_only": false, "broadcast_offline_eval_runner_states": false, "offline_eval_batch_size_per_runner": 256, "dataset_num_iters_per_eval_runner": 1, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "log_gradients": false, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 6, "restart_failed_env_runners": true, "ignore_env_runner_failures": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30.0, "env_runner_restore_timeout_s": 1800.0, "_model_config": {}, "_rl_module_spec": "MultiRLModuleSpec(multi_rl_module_class=<class 'ray.rllib.core.rl_module.multi_rl_module.MultiRLModule'>, observation_space=None, action_space=None, inference_only=False, model_config=None, rl_module_specs={'default_policy': RLModuleSpec(module_class=<class 'source.intrinsic_attention_ppo.rl_modules.DifferentiablePPOModule.DifferentiablePPOModule'>, observation_space=None, action_space=None, inference_only=False, learner_only=False, model_config={'vf_share_layers': True, 'embedding_dim': 62, 'max_seq_len': 6, 'policy_head_hidden_sizes': [32], 'value_head_hidden_sizes': [101], 'embedding_hidden_sizes': [121]}, catalog_class=None, load_state_path=None, model_config_dict=None), 'intrinsic_reward_module': RLModuleSpec(module_class=<class 'source.intrinsic_attention_ppo.rl_modules.IntrinsicAttentionModule.IntrinsicAttentionModule'>, observation_space=None, action_space=None, inference_only=False, learner_only=True, model_config={'intrinsic_reward_network': {'encoder_hidden_sizes': [], 'encoding_dim': 1, 'num_heads': 1, 'head_hidden_sizes': None, 'layers': [{'type': 'attention'}]}, 'extrinsic_value_hidden_layers': [127, 60], 'vf_share_layers': True, 'max_seq_len': 6}, catalog_class=None, load_state_path=None, model_config_dict=None)}, load_state_path=None, modules_to_load=None, module_specs={'default_policy': RLModuleSpec(module_class=<class 'source.intrinsic_attention_ppo.rl_modules.DifferentiablePPOModule.DifferentiablePPOModule'>, observation_space=None, action_space=None, inference_only=False, learner_only=False, model_config={'vf_share_layers': True, 'embedding_dim': 62, 'max_seq_len': 6, 'policy_head_hidden_sizes': [32], 'value_head_hidden_sizes': [101], 'embedding_hidden_sizes': [121]}, catalog_class=None, load_state_path=None, model_config_dict=None), 'intrinsic_reward_module': RLModuleSpec(module_class=<class 'source.intrinsic_attention_ppo.rl_modules.IntrinsicAttentionModule.IntrinsicAttentionModule'>, observation_space=None, action_space=None, inference_only=False, learner_only=True, model_config={'intrinsic_reward_network': {'encoder_hidden_sizes': [], 'encoding_dim': 1, 'num_heads': 1, 'head_hidden_sizes': None, 'layers': [{'type': 'attention'}]}, 'extrinsic_value_hidden_layers': [127, 60], 'vf_share_layers': True, 'max_seq_len': 6}, catalog_class=None, load_state_path=None, model_config_dict=None)})", "algorithm_config_overrides_per_module": {"intrinsic_reward_module": {"lr": 0.0002715581955}}, "_per_module_overrides": {}, "_validate_config": true, "_use_msgpack_checkpoints": false, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "env_task_fn": -1, "enable_connectors": -1, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.161583927863, "kl_target": 0.0201019014258, "vf_loss_coeff": 0.7790510010087, "entropy_coeff": 0.0015431216992, "clip_param": 0.2459212356676, "vf_clip_param": 0.3769744131561, "entropy_coeff_schedule": null, "lr_schedule": null, "sgd_minibatch_size": -1, "vf_share_layers": -1, "differentiable_learner_configs": ["DifferentiableLearnerConfig(learner_class=<class 'source.intrinsic_attention_ppo.learners.IntrinsicAttentionPPOLearner.IntrinsicAttentionPPOLearner'>, learner_connector=None, add_default_connectors_to_learner_pipeline=True, is_multi_agent=False, policies_to_update=['default_policy'], lr=0.0060984166342, num_total_minibatches=0, num_epochs=1, minibatch_size=1000, shuffle_batch_per_epoch=True)"], "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9485408017724, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.callbacks.callbacks.RLlibCallback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 147.61266326904297, "iterations_since_restore": 14, "perf": {"cpu_util_percent": 47.00666666666667, "ram_util_percent": 80.92}}
{"timers": {"training_iteration": 10.533402405804145, "restore_env_runners": 9.817115854829629e-06, "training_step": 10.533151135491037, "env_runner_sampling_timer": 1.7356573449689479, "learner_update_timer": 8.599192966490719, "synch_weights": 0.0018063858755021146, "restore_eval_env_runners": 7.339156115811423e-05, "evaluation_iteration": 0.1406651207478644, "synch_eval_env_connectors": 0.00021471502321110015, "synch_env_connectors": 5.441471645377133e-06}, "env_runners": {"episode_return_max": 10.5, "module_to_env_connector": {"timers": {"connectors": {"tensor_to_numpy": 1.609937122333554e-05, "normalize_and_clip_actions": 8.522922116737476e-06, "un_batch_to_individual_items": 6.962137077289446e-06, "listify_data_for_vector_env": 1.1185340822143222e-05, "get_actions": 4.209742748659666e-05, "remove_single_ts_time_rank_from_batch": 1.2574353228802457e-05}}, "connector_pipeline_timer": 0.00012516731533134356}, "episode_len_mean": 20.0, "episode_len_max": 20, "num_module_steps_sampled_lifetime": {"default_policy": -8017500.0}, "num_env_steps_sampled_lifetime": -8017500.0, "module_episode_returns_mean": {"default_policy": 2.740000000000001}, "env_to_module_sum_episodes_length_out": 10.36823839457432, "episode_return_mean": 2.740000000000001, "env_to_module_connector": {"timers": {"connectors": {"add_time_dim_to_batch_and_zero_pad": 7.512214838802181e-06, "add_observations_from_episodes_to_batch": 3.0383077841206146e-06, "add_states_from_episodes_to_batch": 2.9465453209231725e-06, "numpy_to_tensor": 1.364370104155359e-05, "batch_individual_items": 1.31235783328576e-05}}, "connector_pipeline_timer": 6.318787090056499e-05}, "agent_episode_returns_mean": {"default_agent": 2.740000000000001}, "env_step_timer": 1.496624325749495e-05, "sample": 0.00584113228711923, "num_episodes": 250.0, "num_agent_steps_sampled_lifetime": {"default_agent": -8017500.0}, "num_episodes_lifetime": -400875.0, "env_to_module_sum_episodes_length_in": 10.36823839457432, "num_agent_steps_sampled": {"default_agent": 5000.0}, "num_env_steps_sampled": 5000.0, "num_module_steps_sampled": {"default_policy": 5000.0}, "episode_return_min": -9.5, "episode_duration_sec_mean": 0.005614096301607788, "weights_seq_no": 14.0, "time_between_sampling": 0.036804783345662194, "env_reset_timer": 4.118828638056796e-05, "episode_len_min": 20, "rlmodule_inference_timer": 3.400279033999247e-05, "num_env_steps_sampled_lifetime_throughput": 3084.8701531274482}, "__all_modules__": {"learner_connector_sum_episodes_length_in": 5000.0, "learner_connector": {"connector_pipeline_timer": 0.15743622330344403, "timers": {"connectors": {"add_one_ts_to_episodes_and_truncate": 0.009164732803388535, "add_observations_from_episodes_to_batch": 0.0008458501474215423, "add_columns_from_episodes_to_train_batch": 0.04185325361866651, "add_time_dim_to_batch_and_zero_pad": 0.09288746014348229, "add_states_from_episodes_to_batch": 0.0037859019979727794, "batch_individual_items": 0.008674029235033676, "numpy_to_tensor": 7.245403841059101e-05}}}, "learner_connector_sum_episodes_length_out": 5250.0}, "learners": {"__all_modules__": {"num_non_trainable_parameters": 0, "num_trainable_parameters": 24861, "num_module_steps_trained_lifetime": 179550, "num_env_steps_trained": 36000, "num_module_steps_trained": 11970, "num_env_steps_trained_lifetime": 540000, "num_env_steps_trained_lifetime_throughput": 4417.624658178967, "num_module_steps_trained_throughput": 21501285.97847967, "num_module_steps_trained_lifetime_throughput": 13831856.149688981}, "default_policy": {"vf_explained_var": 0.001329660415649414, "vf_loss_unclipped": 43.297855377197266, "use_intrinsic_rewards": 0.0, "weights_seq_no": 15.0, "total_loss": 0.24865902960300446, "num_trainable_parameters": 16595, "curr_entropy_coeff": 0.0015431216992, "num_module_steps_trained_lifetime": 89775, "vf_loss": 0.32051903009414673, "diff_num_grad_updates_vs_sampler_policy": 1.0, "curr_kl_coeff": 4.931150215270463e-06, "num_module_steps_trained": 5985, "mean_kl_loss": 4.2845790630963165e-06, "module_train_batch_size_mean": 998.1026110140886, "policy_loss": -2.495347189324093e-06, "entropy": 0.6734224557876587, "num_module_steps_trained_lifetime_throughput": 733.8086017885724}, "intrinsic_reward_module": {"num_module_steps_trained": 5985, "diff_num_grad_updates_vs_sampler_policy": 1.0, "gradients_default_optimizer_global_norm": 0.0, "weights_seq_no": 15.0, "module_train_batch_size_mean": 998.1026110140886, "num_trainable_parameters": 8266, "default_optimizer_learning_rate": 0.0002715581955, "curr_entropy_coeff": 0.0015431216992, "num_module_steps_trained_lifetime": 89775, "total_loss": 0.0, "num_module_steps_trained_lifetime_throughput": 733.8161851089775}, "differentiable_learners": {"intrinsic_attention_ppo_learner": {"default_policy": {"vf_loss_unclipped": 43.2196159362793, "num_module_steps_trained_lifetime": 538650, "total_loss": 0.24869705736637115, "vf_loss": 0.3205668330192566, "mean_kl_loss": 4.3432451093394775e-06, "diff_num_grad_updates_vs_sampler_policy": 76.0, "policy_loss": -2.399778622930171e-06, "num_module_steps_trained": 35910, "vf_explained_var": 0.0025420784950256348, "use_intrinsic_rewards": 1.0, "weights_seq_no": 90.0, "module_train_batch_size_mean": 997.499088644618, "entropy": 0.6734188795089722}, "__all_modules__": {"num_module_steps_trained_lifetime": 1077300, "num_env_steps_trained_lifetime": 3240000, "num_env_steps_trained": 216000, "num_module_steps_trained": 71820, "num_env_steps_trained_lifetime_throughput": 49879.93006471791}, "intrinsic_reward_module": {"num_module_steps_trained": 35910, "weights_seq_no": 90.0, "module_train_batch_size_mean": 997.499088644618, "total_loss": 0.0, "num_module_steps_trained_lifetime": 538650, "diff_num_grad_updates_vs_sampler_policy": 76.0}}}, "IntrinsicAttentionMask": [[[0.1673491895198822, 0.16648656129837036, 0.16640546917915344, 0.166135773062706, 0.16694676876068115, 0.16667620837688446], [0.16777688264846802, 0.1663735806941986, 0.16624189913272858, 0.16580425202846527, 0.16712167859077454, 0.166681706905365], [0.16781723499298096, 0.1663629114627838, 0.16622646152973175, 0.16577298939228058, 0.16713815927505493, 0.16668221354484558], [0.16795164346694946, 0.16632740199565887, 0.16617508232593536, 0.1656690239906311, 0.16719301044940948, 0.1666838526725769], [0.16754834353923798, 0.16643396019935608, 0.1663292944431305, 0.16598129272460938, 0.1670282781124115, 0.16667881608009338], [0.16768260300159454, 0.16639849543571472, 0.1662779450416565, 0.16587725281715393, 0.16708315908908844, 0.16668052971363068]], [[0.1667775809764862, 0.16635724902153015, 0.16683329641819, 0.1665991097688675, 0.16670241951942444, 0.16673026978969574], [0.16687588393688202, 0.16608329117298126, 0.1669810712337494, 0.16653914749622345, 0.1667340248823166, 0.1667865812778473], [0.16676457226276398, 0.16639354825019836, 0.16681374609470367, 0.1666070520877838, 0.16669823229312897, 0.16672281920909882], [0.16681930422782898, 0.16624099016189575, 0.1668960005044937, 0.1665736883878708, 0.1667158603668213, 0.16675418615341187], [0.16679514944553375, 0.16630831360816956, 0.1668597012758255, 0.1665884256362915, 0.1667080968618393, 0.16674034297466278], [0.16678863763809204, 0.16632644832134247, 0.16684992611408234, 0.16659238934516907, 0.16670599579811096, 0.16673661768436432]], [[0.1664242148399353, 0.1660671979188919, 0.1665496975183487, 0.16678284108638763, 0.16726741194725037, 0.16690859198570251], [0.16638824343681335, 0.16597847640514374, 0.16653230786323547, 0.16679999232292175, 0.16735656559467316, 0.16694439947605133], [0.16643686592578888, 0.16609837114810944, 0.16655582189559937, 0.16677682101726532, 0.16723614931106567, 0.1668960303068161], [0.16646027565002441, 0.16615618765354156, 0.1665671467781067, 0.16676564514636993, 0.16717810928821564, 0.16687269508838654], [0.16650882363319397, 0.16627611219882965, 0.16659057140350342, 0.16674239933490753, 0.16705773770809174, 0.16682425141334534], [0.1664728969335556, 0.1661873310804367, 0.16657322645187378, 0.16675959527492523, 0.16714683175086975, 0.16686011850833893]], [[0.16669030487537384, 0.1665317267179489, 0.16674599051475525, 0.16677384078502655, 0.16661518812179565, 0.16664300858974457], [0.16669818758964539, 0.16648660600185394, 0.1667724996805191, 0.16680967807769775, 0.16659796237945557, 0.16663509607315063], [0.1666875183582306, 0.16654755175113678, 0.1667366623878479, 0.16676124930381775, 0.16662122309207916, 0.16664578020572662], [0.16668613255023956, 0.1665554642677307, 0.16673201322555542, 0.16675496101379395, 0.16662423312664032, 0.16664716601371765], [0.1666940301656723, 0.16651034355163574, 0.16675853729248047, 0.16679079830646515, 0.16660702228546143, 0.16663925349712372], [0.16669264435768127, 0.16651827096939087, 0.166753888130188, 0.16678451001644135, 0.16661004722118378, 0.16664063930511475]], [[0.16642408072948456, 0.16606706380844116, 0.16714125871658325, 0.1667827069759369, 0.16726727783679962, 0.16631758213043213], [0.16638807952404022, 0.1659782975912094, 0.1672116219997406, 0.16679981350898743, 0.16735638678073883, 0.1662658154964447], [0.1664961576461792, 0.16624489426612854, 0.1670003980398178, 0.16674837470054626, 0.16708894073963165, 0.16642120480537415], [0.16646015644073486, 0.16615606844425201, 0.16707074642181396, 0.16676552593708038, 0.1671779900789261, 0.1663694530725479], [0.1665087789297104, 0.16627606749534607, 0.1669757068157196, 0.16674235463142395, 0.16705769300460815, 0.16643938422203064], [0.166413351893425, 0.1660405993461609, 0.167162224650383, 0.16678780317306519, 0.16729383170604706, 0.1663021445274353]], [[0.1668587028980255, 0.16658399999141693, 0.16650158166885376, 0.16700348258018494, 0.16672855615615845, 0.16632361710071564], [0.166895791888237, 0.16656802594661713, 0.16646967828273773, 0.16706860065460205, 0.16674049198627472, 0.16625741124153137], [0.16690693795681, 0.1665632128715515, 0.1664600968360901, 0.16708816587924957, 0.16674406826496124, 0.16623753309249878], [0.16683916747570038, 0.16659241914749146, 0.16651837527751923, 0.1669692099094391, 0.16672226786613464, 0.16635848581790924], [0.16687627136707306, 0.16657644510269165, 0.1664864867925644, 0.1670343279838562, 0.1667342185974121, 0.16629227995872498], [0.16693098843097687, 0.1665528118610382, 0.16643938422203064, 0.16713042557239532, 0.16675180196762085, 0.16619454324245453]]]}, "num_training_step_calls_per_iteration": 1, "evaluation": {"env_runners": {"agent_episode_returns_mean": {"default_agent": -0.35}, "num_agent_steps_sampled": {"default_agent": 400}, "num_agent_steps_sampled_lifetime": {"default_agent": 6000}, "episode_return_min": -13.5, "module_to_env_connector": {"timers": {"connectors": {"remove_single_ts_time_rank_from_batch": 1.6909229029775204e-05, "tensor_to_numpy": 2.3126504253446837e-05, "normalize_and_clip_actions": 1.074065544013753e-05, "listify_data_for_vector_env": 1.4681564562968288e-05, "get_actions": 6.591339918808197e-05, "un_batch_to_individual_items": 8.99100590199784e-06}}, "connector_pipeline_timer": 0.00017804598450836052}, "rlmodule_inference_timer": 5.0896630709062046e-05, "env_step_timer": 2.3719078269558567e-05, "num_episodes_lifetime": 300, "env_to_module_sum_episodes_length_in": 10.368238394574323, "num_env_steps_sampled": 400, "env_to_module_connector": {"timers": {"connectors": {"add_observations_from_episodes_to_batch": 3.775958047199965e-06, "add_time_dim_to_batch_and_zero_pad": 1.072626760401995e-05, "batch_individual_items": 1.7290786028978107e-05, "numpy_to_tensor": 1.834708931284153e-05, "add_states_from_episodes_to_batch": 3.4287011480736277e-06}}, "connector_pipeline_timer": 8.34619735522523e-05}, "num_module_steps_sampled": {"default_policy": 400}, "env_reset_timer": 0.0006273235431771803, "num_module_steps_sampled_lifetime": {"default_policy": 6000}, "env_to_module_sum_episodes_length_out": 10.368238394574323, "module_episode_returns_mean": {"default_policy": -0.35}, "episode_return_mean": -0.35, "num_episodes": 20, "episode_len_mean": 20.0, "episode_return_max": 13.5, "num_env_steps_sampled_lifetime": 75400, "sample": 0.12930180572587952, "episode_duration_sec_mean": 0.005631303306436166, "weights_seq_no": 15.0, "episode_len_min": 20, "episode_len_max": 20, "time_between_sampling": 9.938495771761268}, "num_healthy_workers": 1, "actor_manager_num_outstanding_async_reqs": 0, "num_remote_worker_restarts": 0}, "num_env_steps_sampled_lifetime": -8017500.0, "fault_tolerance": {"num_healthy_workers": 0, "num_remote_worker_restarts": 0}, "env_runner_group": {"actor_manager_num_outstanding_async_reqs": 0}, "done": false, "training_iteration": 15, "trial_id": "b1df4_00000", "date": "2025-08-11_18-03-17", "timestamp": 1754928197, "time_this_iter_s": 10.158861875534058, "time_total_s": 157.77152514457703, "pid": 10074, "hostname": "Mac", "node_ip": "127.0.0.1", "config": {"exploration_config": {}, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 2, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "env": "Umbrella", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": false, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 0, "create_local_env_runner": true, "num_envs_per_env_runner": 1, "gym_env_vectorize_mode": "SYNC", "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "episodes_to_numpy": true, "max_requests_in_flight_per_env_runner": 1, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "merge_env_runner_states": "training_only", "broadcast_env_runner_states": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "complete_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "sampler_perf_stats_ema_coef": null, "_is_online": true, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": "auto", "num_aggregator_actors_per_learner": 0, "max_requests_in_flight_per_aggregator_actor": 3, "local_gpu_idx": 0, "max_requests_in_flight_per_learner": 3, "gamma": 1, "lr": 0.0002715581955, "grad_clip": 0.5, "grad_clip_by": "global_norm", "_train_batch_size_per_learner": 5000, "train_batch_size": 4000, "num_epochs": 1, "minibatch_size": 1000, "shuffle_batch_per_epoch": true, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "log_std_clip_param": 20.0, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "_disable_preprocessor_api": false, "_disable_action_flattening": false}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {"intrinsic_reward_coeff": 0.2795015916508}, "optimizer": {}, "_learner_class": "<class 'source.intrinsic_attention_ppo.learners.IntrinsicAttentionMetaLearner.IntrinsicAttentionMetaLearner'>", "callbacks_on_algorithm_init": null, "callbacks_on_env_runners_recreated": null, "callbacks_on_offline_eval_runners_recreated": null, "callbacks_on_checkpoint_loaded": null, "callbacks_on_environment_created": null, "callbacks_on_episode_created": null, "callbacks_on_episode_start": null, "callbacks_on_episode_step": null, "callbacks_on_episode_end": null, "callbacks_on_evaluate_start": null, "callbacks_on_evaluate_end": null, "callbacks_on_evaluate_offline_start": null, "callbacks_on_evaluate_offline_end": null, "callbacks_on_sample_end": null, "callbacks_on_train_result": null, "explore": true, "enable_rl_module_and_learner": true, "enable_env_runner_and_connector_v2": true, "_prior_exploration_config": {"type": "StochasticSampling"}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x3855fd760>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "offline_data_class": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_read_batch_size": null, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "materialize_data": false, "materialize_mapped_data": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "ignore_final_observation": false, "prelearner_class": null, "prelearner_buffer_class": null, "prelearner_buffer_kwargs": {}, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_remaining_data": false, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": 1, "evaluation_duration": 20, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_auto_duration_min_env_steps_per_sample": 100, "evaluation_auto_duration_max_env_steps_per_sample": 2000, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 1, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "offline_evaluation_interval": null, "num_offline_eval_runners": 0, "offline_loss_for_module_fn": null, "offline_evaluation_duration": 1, "offline_evaluation_parallel_to_training": false, "offline_evaluation_timeout_s": 120.0, "num_cpus_per_offline_eval_runner": 1, "num_gpus_per_offline_eval_runner": 0, "custom_resources_per_offline_eval_runner": {}, "restart_failed_offline_eval_runners": true, "ignore_offline_eval_runner_failures": false, "max_num_offline_eval_runner_restarts": 1000, "offline_eval_runner_restore_timeout_s": 1800.0, "max_requests_in_flight_per_offline_eval_runner": 1, "validate_offline_eval_runners_after_construction": true, "offline_eval_runner_health_probe_timeout_s": 30.0, "offline_eval_rl_module_inference_only": false, "broadcast_offline_eval_runner_states": false, "offline_eval_batch_size_per_runner": 256, "dataset_num_iters_per_eval_runner": 1, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "log_gradients": false, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 6, "restart_failed_env_runners": true, "ignore_env_runner_failures": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30.0, "env_runner_restore_timeout_s": 1800.0, "_model_config": {}, "_rl_module_spec": "MultiRLModuleSpec(multi_rl_module_class=<class 'ray.rllib.core.rl_module.multi_rl_module.MultiRLModule'>, observation_space=None, action_space=None, inference_only=False, model_config=None, rl_module_specs={'default_policy': RLModuleSpec(module_class=<class 'source.intrinsic_attention_ppo.rl_modules.DifferentiablePPOModule.DifferentiablePPOModule'>, observation_space=None, action_space=None, inference_only=False, learner_only=False, model_config={'vf_share_layers': True, 'embedding_dim': 62, 'max_seq_len': 6, 'policy_head_hidden_sizes': [32], 'value_head_hidden_sizes': [101], 'embedding_hidden_sizes': [121]}, catalog_class=None, load_state_path=None, model_config_dict=None), 'intrinsic_reward_module': RLModuleSpec(module_class=<class 'source.intrinsic_attention_ppo.rl_modules.IntrinsicAttentionModule.IntrinsicAttentionModule'>, observation_space=None, action_space=None, inference_only=False, learner_only=True, model_config={'intrinsic_reward_network': {'encoder_hidden_sizes': [], 'encoding_dim': 1, 'num_heads': 1, 'head_hidden_sizes': None, 'layers': [{'type': 'attention'}]}, 'extrinsic_value_hidden_layers': [127, 60], 'vf_share_layers': True, 'max_seq_len': 6}, catalog_class=None, load_state_path=None, model_config_dict=None)}, load_state_path=None, modules_to_load=None, module_specs={'default_policy': RLModuleSpec(module_class=<class 'source.intrinsic_attention_ppo.rl_modules.DifferentiablePPOModule.DifferentiablePPOModule'>, observation_space=None, action_space=None, inference_only=False, learner_only=False, model_config={'vf_share_layers': True, 'embedding_dim': 62, 'max_seq_len': 6, 'policy_head_hidden_sizes': [32], 'value_head_hidden_sizes': [101], 'embedding_hidden_sizes': [121]}, catalog_class=None, load_state_path=None, model_config_dict=None), 'intrinsic_reward_module': RLModuleSpec(module_class=<class 'source.intrinsic_attention_ppo.rl_modules.IntrinsicAttentionModule.IntrinsicAttentionModule'>, observation_space=None, action_space=None, inference_only=False, learner_only=True, model_config={'intrinsic_reward_network': {'encoder_hidden_sizes': [], 'encoding_dim': 1, 'num_heads': 1, 'head_hidden_sizes': None, 'layers': [{'type': 'attention'}]}, 'extrinsic_value_hidden_layers': [127, 60], 'vf_share_layers': True, 'max_seq_len': 6}, catalog_class=None, load_state_path=None, model_config_dict=None)})", "algorithm_config_overrides_per_module": {"intrinsic_reward_module": {"lr": 0.0002715581955}}, "_per_module_overrides": {}, "_validate_config": true, "_use_msgpack_checkpoints": false, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "env_task_fn": -1, "enable_connectors": -1, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.161583927863, "kl_target": 0.0201019014258, "vf_loss_coeff": 0.7790510010087, "entropy_coeff": 0.0015431216992, "clip_param": 0.2459212356676, "vf_clip_param": 0.3769744131561, "entropy_coeff_schedule": null, "lr_schedule": null, "sgd_minibatch_size": -1, "vf_share_layers": -1, "differentiable_learner_configs": ["DifferentiableLearnerConfig(learner_class=<class 'source.intrinsic_attention_ppo.learners.IntrinsicAttentionPPOLearner.IntrinsicAttentionPPOLearner'>, learner_connector=None, add_default_connectors_to_learner_pipeline=True, is_multi_agent=False, policies_to_update=['default_policy'], lr=0.0060984166342, num_total_minibatches=0, num_epochs=1, minibatch_size=1000, shuffle_batch_per_epoch=True)"], "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9485408017724, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.callbacks.callbacks.RLlibCallback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 157.77152514457703, "iterations_since_restore": 15, "perf": {"cpu_util_percent": 40.019999999999996, "ram_util_percent": 81.48666666666666}}
{"timers": {"training_iteration": 10.531810771746365, "restore_env_runners": 9.84144504698016e-06, "training_step": 10.531559524966097, "env_runner_sampling_timer": 1.734891114429753, "learner_update_timer": 8.596315312655678, "synch_weights": 0.0018053507669003519, "restore_eval_env_runners": 7.312889476928852e-05, "evaluation_iteration": 0.14084621578966475, "synch_eval_env_connectors": 0.00021449329276220885, "synch_env_connectors": 5.469966756975287e-06}, "env_runners": {"episode_return_max": 10.5, "module_to_env_connector": {"timers": {"connectors": {"tensor_to_numpy": 1.666829939761007e-05, "normalize_and_clip_actions": 8.71429979209161e-06, "un_batch_to_individual_items": 6.97396358294957e-06, "listify_data_for_vector_env": 1.1103225606188328e-05, "get_actions": 4.246408902871607e-05, "remove_single_ts_time_rank_from_batch": 1.2596551578630443e-05}}, "connector_pipeline_timer": 0.00012642884802344028}, "episode_len_mean": 20.0, "episode_len_max": 20, "num_module_steps_sampled_lifetime": {"default_policy": -8635000.0}, "num_env_steps_sampled_lifetime": -8635000.0, "module_episode_returns_mean": {"default_policy": 2.8199999999999994}, "env_to_module_sum_episodes_length_out": 10.36823839457432, "episode_return_mean": 2.8199999999999994, "env_to_module_connector": {"timers": {"connectors": {"add_time_dim_to_batch_and_zero_pad": 7.563522418349231e-06, "add_observations_from_episodes_to_batch": 3.0705045474140167e-06, "add_states_from_episodes_to_batch": 2.9296082789437993e-06, "numpy_to_tensor": 1.3881193949003306e-05, "batch_individual_items": 1.330066126403569e-05}}, "connector_pipeline_timer": 6.375797149481288e-05}, "agent_episode_returns_mean": {"default_agent": 2.8199999999999994}, "env_step_timer": 1.5019654513057784e-05, "sample": 0.006137010793103924, "num_episodes": 250.0, "num_agent_steps_sampled_lifetime": {"default_agent": -8635000.0}, "num_episodes_lifetime": -431750.0, "env_to_module_sum_episodes_length_in": 10.36823839457432, "num_agent_steps_sampled": {"default_agent": 5000.0}, "num_env_steps_sampled": 5000.0, "num_module_steps_sampled": {"default_policy": 5000.0}, "episode_return_min": -9.5, "episode_duration_sec_mean": 0.005649135179352018, "weights_seq_no": 15.0, "time_between_sampling": 0.03463057911783648, "env_reset_timer": 4.953093263463278e-05, "episode_len_min": 20, "rlmodule_inference_timer": 3.435161386275754e-05, "num_env_steps_sampled_lifetime_throughput": 3023.0311040120177}, "__all_modules__": {"learner_connector_sum_episodes_length_in": 5000.0, "learner_connector": {"connector_pipeline_timer": 0.15931919981984066, "timers": {"connectors": {"add_one_ts_to_episodes_and_truncate": 0.00917857714473755, "add_observations_from_episodes_to_batch": 0.0008461720655410039, "add_columns_from_episodes_to_train_batch": 0.04191111067266498, "add_time_dim_to_batch_and_zero_pad": 0.09297508804232633, "add_states_from_episodes_to_batch": 0.0037903804784832997, "batch_individual_items": 0.010392423522455469, "numpy_to_tensor": 7.2912828340719e-05}}}, "learner_connector_sum_episodes_length_out": 5250.0}, "learners": {"__all_modules__": {"num_non_trainable_parameters": 0, "num_trainable_parameters": 24861, "num_module_steps_trained_lifetime": 191520, "num_env_steps_trained": 36000, "num_module_steps_trained": 11970, "num_env_steps_trained_lifetime": 576000, "num_env_steps_trained_lifetime_throughput": 4396.841243546795, "num_module_steps_trained_throughput": 20991454.112221897, "num_module_steps_trained_lifetime_throughput": 13731043.050448947}, "default_policy": {"vf_explained_var": 0.0016763806343078613, "vf_loss_unclipped": 43.73003387451172, "use_intrinsic_rewards": 0.0, "weights_seq_no": 16.0, "total_loss": 0.24850624799728394, "num_trainable_parameters": 16595, "curr_entropy_coeff": 0.0015431216992, "num_module_steps_trained_lifetime": 95760, "vf_loss": 0.32051822543144226, "diff_num_grad_updates_vs_sampler_policy": 1.0, "curr_kl_coeff": 2.4655751076352317e-06, "num_module_steps_trained": 5985, "mean_kl_loss": 2.0614706954802386e-05, "module_train_batch_size_mean": 998.0669052031734, "policy_loss": -0.00015634474402759224, "entropy": 0.6723341941833496, "num_module_steps_trained_lifetime_throughput": 730.3780627200257}, "intrinsic_reward_module": {"num_module_steps_trained": 5985, "diff_num_grad_updates_vs_sampler_policy": 1.0, "gradients_default_optimizer_global_norm": 0.0, "weights_seq_no": 16.0, "module_train_batch_size_mean": 998.0669052031734, "num_trainable_parameters": 8266, "default_optimizer_learning_rate": 0.0002715581955, "curr_entropy_coeff": 0.0015431216992, "num_module_steps_trained_lifetime": 95760, "total_loss": 0.0, "num_module_steps_trained_lifetime_throughput": 730.3851815595636}, "differentiable_learners": {"intrinsic_attention_ppo_learner": {"default_policy": {"vf_loss_unclipped": 43.66081237792969, "num_module_steps_trained_lifetime": 574560, "total_loss": 0.24854399263858795, "vf_loss": 0.32055890560150146, "mean_kl_loss": 2.0053232219652273e-05, "diff_num_grad_updates_vs_sampler_policy": 81.0, "policy_loss": -0.00015344297571573406, "num_module_steps_trained": 35910, "vf_explained_var": 0.0024657845497131348, "use_intrinsic_rewards": 1.0, "weights_seq_no": 96.0, "module_train_batch_size_mean": 997.4970769774884, "entropy": 0.6723517179489136}, "__all_modules__": {"num_module_steps_trained_lifetime": 1149120, "num_env_steps_trained_lifetime": 3456000, "num_env_steps_trained": 216000, "num_module_steps_trained": 71820, "num_env_steps_trained_lifetime_throughput": 49085.47390291905}, "intrinsic_reward_module": {"num_module_steps_trained": 35910, "weights_seq_no": 96.0, "module_train_batch_size_mean": 997.4970769774884, "total_loss": 0.0, "num_module_steps_trained_lifetime": 574560, "diff_num_grad_updates_vs_sampler_policy": 81.0}}}, "IntrinsicAttentionMask": [[[0.1664242148399353, 0.1660671979188919, 0.1665496975183487, 0.16678284108638763, 0.16726741194725037, 0.16690859198570251], [0.16638824343681335, 0.16597847640514374, 0.16653230786323547, 0.16679999232292175, 0.16735656559467316, 0.16694439947605133], [0.16643686592578888, 0.16609837114810944, 0.16655582189559937, 0.16677682101726532, 0.16723614931106567, 0.1668960303068161], [0.16646027565002441, 0.16615618765354156, 0.1665671467781067, 0.16676564514636993, 0.16717810928821564, 0.16687269508838654], [0.16650882363319397, 0.16627611219882965, 0.16659057140350342, 0.16674239933490753, 0.16705773770809174, 0.16682425141334534], [0.1664728969335556, 0.1661873310804367, 0.16657322645187378, 0.16675959527492523, 0.16714683175086975, 0.16686011850833893]], [[0.16686496138572693, 0.16644442081451416, 0.16665856540203094, 0.1669485867023468, 0.16652783751487732, 0.16655564308166504], [0.16704079508781433, 0.1662474423646927, 0.16665121912956238, 0.1671987771987915, 0.16640466451644897, 0.16645711660385132], [0.16695119440555573, 0.16634778678417206, 0.16665497422218323, 0.16707126796245575, 0.16646742820739746, 0.1665073186159134], [0.16683006286621094, 0.1664835512638092, 0.16666002571582794, 0.1668989509344101, 0.16655229032039642, 0.16657520830631256], [0.16700588166713715, 0.16628654301166534, 0.16665267944335938, 0.16714908182621002, 0.16642913222312927, 0.16647668182849884], [0.16699424386024475, 0.16629956662654877, 0.16665317118167877, 0.16713251173496246, 0.1664372682571411, 0.16648319363594055]], [[0.16742391884326935, 0.16611537337303162, 0.16647976636886597, 0.1666557490825653, 0.16657456755638123, 0.16675063967704773], [0.1681450754404068, 0.16559287905693054, 0.1663016825914383, 0.16664451360702515, 0.16648632287979126, 0.16682952642440796], [0.16794346272945404, 0.16573871672153473, 0.16635148227214813, 0.1666477471590042, 0.16651104390621185, 0.16680757701396942], [0.16784630715847015, 0.1658090353012085, 0.16637547314167023, 0.1666492521762848, 0.16652293503284454, 0.1667969673871994], [0.16789110004901886, 0.1657765954732895, 0.1663644015789032, 0.16664855182170868, 0.1665174514055252, 0.16680185496807098], [0.16779398918151855, 0.16584695875644684, 0.1663883924484253, 0.16665008664131165, 0.1665293425321579, 0.16679124534130096]], [[0.16649995744228363, 0.1662541627883911, 0.16658630967140198, 0.1670365035533905, 0.1667899191379547, 0.16683316230773926], [0.16646401584148407, 0.16616536676883698, 0.16656894981861115, 0.16711623966693878, 0.16681644320487976, 0.16686899960041046], [0.16651257872581482, 0.16628533601760864, 0.16659240424633026, 0.16700853407382965, 0.16678062081336975, 0.16682058572769165], [0.16657820343971252, 0.16644762456417084, 0.166624054312706, 0.16686293482780457, 0.16673213243484497, 0.1667550653219223], [0.16654229164123535, 0.16635878384113312, 0.16660673916339874, 0.16694262623786926, 0.1667586863040924, 0.1667909473180771], [0.16654857993125916, 0.1663743555545807, 0.1666097640991211, 0.16692863404750824, 0.16675402224063873, 0.1667846441268921]], [[0.16734902560710907, 0.1660410761833191, 0.16685160994529724, 0.16613560914993286, 0.16694660484790802, 0.16667604446411133], [0.16799820959568024, 0.16544824838638306, 0.16702620685100555, 0.16563192009925842, 0.1672116369009018, 0.16668380796909332], [0.16759514808654785, 0.1658160388469696, 0.16691794991493225, 0.16594447195529938, 0.16704723238945007, 0.16667911410331726], [0.1679510623216629, 0.16549120843410492, 0.16701357066631317, 0.16566845774650574, 0.16719242930412292, 0.16668328642845154], [0.1675480753183365, 0.16585905849933624, 0.1669052690267563, 0.16598102450370789, 0.16702800989151, 0.1666785478591919], [0.1676822453737259, 0.16573651134967804, 0.16694138944149017, 0.16587691009044647, 0.1670828014612198, 0.16668017208576202]], [[0.16693426668643951, 0.16620662808418274, 0.16657699644565582, 0.1670791208744049, 0.16680407524108887, 0.16639895737171173], [0.16707128286361694, 0.1659712940454483, 0.16653087735176086, 0.1672905534505844, 0.16687427461147308, 0.16626179218292236], [0.16700145602226257, 0.1660911738872528, 0.16655436158180237, 0.1671827882528305, 0.16683849692344666, 0.16633166372776031], [0.16690704226493835, 0.16625337302684784, 0.16658611595630646, 0.16703714430332184, 0.16679009795188904, 0.1664261668920517], [0.166958749294281, 0.1661645770072937, 0.16656877100467682, 0.16711688041687012, 0.1668166220188141, 0.16637445986270905], [0.16703499853610992, 0.1660335659980774, 0.16654308140277863, 0.16723455488681793, 0.16685567796230316, 0.16629809141159058]]]}, "num_training_step_calls_per_iteration": 1, "evaluation": {"env_runners": {"agent_episode_returns_mean": {"default_agent": -0.75}, "num_agent_steps_sampled": {"default_agent": 400}, "num_agent_steps_sampled_lifetime": {"default_agent": 6400}, "episode_return_min": -13.5, "module_to_env_connector": {"timers": {"connectors": {"remove_single_ts_time_rank_from_batch": 1.2291927097010957e-05, "tensor_to_numpy": 1.607926875532266e-05, "normalize_and_clip_actions": 8.736606518705279e-06, "listify_data_for_vector_env": 1.0964319548291975e-05, "get_actions": 4.3171693390190775e-05, "un_batch_to_individual_items": 7.10828424139734e-06}}, "connector_pipeline_timer": 0.00012606414847064656}, "rlmodule_inference_timer": 3.3518935607734855e-05, "env_step_timer": 1.5815110614562134e-05, "num_episodes_lifetime": 320, "env_to_module_sum_episodes_length_in": 10.368238394574323, "num_env_steps_sampled": 400, "env_to_module_connector": {"timers": {"connectors": {"add_observations_from_episodes_to_batch": 2.9729490571302863e-06, "add_time_dim_to_batch_and_zero_pad": 7.479539926561515e-06, "batch_individual_items": 1.3183918917818068e-05, "numpy_to_tensor": 1.3475535897103403e-05, "add_states_from_episodes_to_batch": 2.7917088225806757e-06}}, "connector_pipeline_timer": 6.363704429116664e-05}, "num_module_steps_sampled": {"default_policy": 400}, "env_reset_timer": 0.0006245886478427017, "num_module_steps_sampled_lifetime": {"default_policy": 6400}, "env_to_module_sum_episodes_length_out": 10.368238394574323, "module_episode_returns_mean": {"default_policy": -0.75}, "episode_return_mean": -0.75, "num_episodes": 20, "episode_len_mean": 20.0, "episode_return_max": 14.5, "num_env_steps_sampled_lifetime": 80400, "sample": 0.1291963889187514, "episode_duration_sec_mean": 0.005673959157429635, "weights_seq_no": 16.0, "episode_len_min": 20, "episode_len_max": 20, "time_between_sampling": 9.943300548213868}, "num_healthy_workers": 1, "actor_manager_num_outstanding_async_reqs": 0, "num_remote_worker_restarts": 0}, "num_env_steps_sampled_lifetime": -8635000.0, "fault_tolerance": {"num_healthy_workers": 0, "num_remote_worker_restarts": 0}, "env_runner_group": {"actor_manager_num_outstanding_async_reqs": 0}, "done": false, "training_iteration": 16, "trial_id": "b1df4_00000", "date": "2025-08-11_18-03-28", "timestamp": 1754928208, "time_this_iter_s": 10.50556492805481, "time_total_s": 168.27709007263184, "pid": 10074, "hostname": "Mac", "node_ip": "127.0.0.1", "config": {"exploration_config": {}, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 2, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "env": "Umbrella", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": false, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 0, "create_local_env_runner": true, "num_envs_per_env_runner": 1, "gym_env_vectorize_mode": "SYNC", "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "episodes_to_numpy": true, "max_requests_in_flight_per_env_runner": 1, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "merge_env_runner_states": "training_only", "broadcast_env_runner_states": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "complete_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "sampler_perf_stats_ema_coef": null, "_is_online": true, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": "auto", "num_aggregator_actors_per_learner": 0, "max_requests_in_flight_per_aggregator_actor": 3, "local_gpu_idx": 0, "max_requests_in_flight_per_learner": 3, "gamma": 1, "lr": 0.0002715581955, "grad_clip": 0.5, "grad_clip_by": "global_norm", "_train_batch_size_per_learner": 5000, "train_batch_size": 4000, "num_epochs": 1, "minibatch_size": 1000, "shuffle_batch_per_epoch": true, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "log_std_clip_param": 20.0, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "_disable_preprocessor_api": false, "_disable_action_flattening": false}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {"intrinsic_reward_coeff": 0.2795015916508}, "optimizer": {}, "_learner_class": "<class 'source.intrinsic_attention_ppo.learners.IntrinsicAttentionMetaLearner.IntrinsicAttentionMetaLearner'>", "callbacks_on_algorithm_init": null, "callbacks_on_env_runners_recreated": null, "callbacks_on_offline_eval_runners_recreated": null, "callbacks_on_checkpoint_loaded": null, "callbacks_on_environment_created": null, "callbacks_on_episode_created": null, "callbacks_on_episode_start": null, "callbacks_on_episode_step": null, "callbacks_on_episode_end": null, "callbacks_on_evaluate_start": null, "callbacks_on_evaluate_end": null, "callbacks_on_evaluate_offline_start": null, "callbacks_on_evaluate_offline_end": null, "callbacks_on_sample_end": null, "callbacks_on_train_result": null, "explore": true, "enable_rl_module_and_learner": true, "enable_env_runner_and_connector_v2": true, "_prior_exploration_config": {"type": "StochasticSampling"}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x3855fd760>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "offline_data_class": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_read_batch_size": null, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "materialize_data": false, "materialize_mapped_data": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "ignore_final_observation": false, "prelearner_class": null, "prelearner_buffer_class": null, "prelearner_buffer_kwargs": {}, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_remaining_data": false, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": 1, "evaluation_duration": 20, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_auto_duration_min_env_steps_per_sample": 100, "evaluation_auto_duration_max_env_steps_per_sample": 2000, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 1, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "offline_evaluation_interval": null, "num_offline_eval_runners": 0, "offline_loss_for_module_fn": null, "offline_evaluation_duration": 1, "offline_evaluation_parallel_to_training": false, "offline_evaluation_timeout_s": 120.0, "num_cpus_per_offline_eval_runner": 1, "num_gpus_per_offline_eval_runner": 0, "custom_resources_per_offline_eval_runner": {}, "restart_failed_offline_eval_runners": true, "ignore_offline_eval_runner_failures": false, "max_num_offline_eval_runner_restarts": 1000, "offline_eval_runner_restore_timeout_s": 1800.0, "max_requests_in_flight_per_offline_eval_runner": 1, "validate_offline_eval_runners_after_construction": true, "offline_eval_runner_health_probe_timeout_s": 30.0, "offline_eval_rl_module_inference_only": false, "broadcast_offline_eval_runner_states": false, "offline_eval_batch_size_per_runner": 256, "dataset_num_iters_per_eval_runner": 1, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "log_gradients": false, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 6, "restart_failed_env_runners": true, "ignore_env_runner_failures": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30.0, "env_runner_restore_timeout_s": 1800.0, "_model_config": {}, "_rl_module_spec": "MultiRLModuleSpec(multi_rl_module_class=<class 'ray.rllib.core.rl_module.multi_rl_module.MultiRLModule'>, observation_space=None, action_space=None, inference_only=False, model_config=None, rl_module_specs={'default_policy': RLModuleSpec(module_class=<class 'source.intrinsic_attention_ppo.rl_modules.DifferentiablePPOModule.DifferentiablePPOModule'>, observation_space=None, action_space=None, inference_only=False, learner_only=False, model_config={'vf_share_layers': True, 'embedding_dim': 62, 'max_seq_len': 6, 'policy_head_hidden_sizes': [32], 'value_head_hidden_sizes': [101], 'embedding_hidden_sizes': [121]}, catalog_class=None, load_state_path=None, model_config_dict=None), 'intrinsic_reward_module': RLModuleSpec(module_class=<class 'source.intrinsic_attention_ppo.rl_modules.IntrinsicAttentionModule.IntrinsicAttentionModule'>, observation_space=None, action_space=None, inference_only=False, learner_only=True, model_config={'intrinsic_reward_network': {'encoder_hidden_sizes': [], 'encoding_dim': 1, 'num_heads': 1, 'head_hidden_sizes': None, 'layers': [{'type': 'attention'}]}, 'extrinsic_value_hidden_layers': [127, 60], 'vf_share_layers': True, 'max_seq_len': 6}, catalog_class=None, load_state_path=None, model_config_dict=None)}, load_state_path=None, modules_to_load=None, module_specs={'default_policy': RLModuleSpec(module_class=<class 'source.intrinsic_attention_ppo.rl_modules.DifferentiablePPOModule.DifferentiablePPOModule'>, observation_space=None, action_space=None, inference_only=False, learner_only=False, model_config={'vf_share_layers': True, 'embedding_dim': 62, 'max_seq_len': 6, 'policy_head_hidden_sizes': [32], 'value_head_hidden_sizes': [101], 'embedding_hidden_sizes': [121]}, catalog_class=None, load_state_path=None, model_config_dict=None), 'intrinsic_reward_module': RLModuleSpec(module_class=<class 'source.intrinsic_attention_ppo.rl_modules.IntrinsicAttentionModule.IntrinsicAttentionModule'>, observation_space=None, action_space=None, inference_only=False, learner_only=True, model_config={'intrinsic_reward_network': {'encoder_hidden_sizes': [], 'encoding_dim': 1, 'num_heads': 1, 'head_hidden_sizes': None, 'layers': [{'type': 'attention'}]}, 'extrinsic_value_hidden_layers': [127, 60], 'vf_share_layers': True, 'max_seq_len': 6}, catalog_class=None, load_state_path=None, model_config_dict=None)})", "algorithm_config_overrides_per_module": {"intrinsic_reward_module": {"lr": 0.0002715581955}}, "_per_module_overrides": {}, "_validate_config": true, "_use_msgpack_checkpoints": false, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "env_task_fn": -1, "enable_connectors": -1, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.161583927863, "kl_target": 0.0201019014258, "vf_loss_coeff": 0.7790510010087, "entropy_coeff": 0.0015431216992, "clip_param": 0.2459212356676, "vf_clip_param": 0.3769744131561, "entropy_coeff_schedule": null, "lr_schedule": null, "sgd_minibatch_size": -1, "vf_share_layers": -1, "differentiable_learner_configs": ["DifferentiableLearnerConfig(learner_class=<class 'source.intrinsic_attention_ppo.learners.IntrinsicAttentionPPOLearner.IntrinsicAttentionPPOLearner'>, learner_connector=None, add_default_connectors_to_learner_pipeline=True, is_multi_agent=False, policies_to_update=['default_policy'], lr=0.0060984166342, num_total_minibatches=0, num_epochs=1, minibatch_size=1000, shuffle_batch_per_epoch=True)"], "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9485408017724, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.callbacks.callbacks.RLlibCallback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 168.27709007263184, "iterations_since_restore": 16, "perf": {"cpu_util_percent": 39.986666666666665, "ram_util_percent": 81.47333333333333}}
{"timers": {"training_iteration": 10.538283814448642, "restore_env_runners": 9.855121089131424e-06, "training_step": 10.53803248929689, "env_runner_sampling_timer": 1.733996029535964, "learner_update_timer": 8.603474144949706, "synch_weights": 0.0018037760086890952, "restore_eval_env_runners": 7.295593603338406e-05, "evaluation_iteration": 0.14071888238101948, "synch_eval_env_connectors": 0.00021421335890162504, "synch_env_connectors": 5.5077672116695615e-06}, "env_runners": {"episode_return_max": 10.5, "module_to_env_connector": {"timers": {"connectors": {"tensor_to_numpy": 1.617915006916937e-05, "normalize_and_clip_actions": 8.638736892829221e-06, "un_batch_to_individual_items": 6.9804901896493585e-06, "listify_data_for_vector_env": 1.1105235104429473e-05, "get_actions": 4.205150438590702e-05, "remove_single_ts_time_rank_from_batch": 1.2642404922894452e-05}}, "connector_pipeline_timer": 0.00012563484854415642}, "episode_len_mean": 20.0, "episode_len_max": 20, "num_module_steps_sampled_lifetime": {"default_policy": -9252500.0}, "num_env_steps_sampled_lifetime": -9252500.0, "module_episode_returns_mean": {"default_policy": 3.62}, "env_to_module_sum_episodes_length_out": 10.36823839457432, "episode_return_mean": 3.62, "env_to_module_connector": {"timers": {"connectors": {"add_time_dim_to_batch_and_zero_pad": 7.666055496415298e-06, "add_observations_from_episodes_to_batch": 3.0350399336763754e-06, "add_states_from_episodes_to_batch": 2.898978527936845e-06, "numpy_to_tensor": 1.3689000128294016e-05, "batch_individual_items": 1.3255832128104418e-05}}, "connector_pipeline_timer": 6.367911500346821e-05}, "agent_episode_returns_mean": {"default_agent": 3.62}, "env_step_timer": 1.4846818687260007e-05, "sample": 0.006055664967922507, "num_episodes": 250.0, "num_agent_steps_sampled_lifetime": {"default_agent": -9252500.0}, "num_episodes_lifetime": -462625.0, "env_to_module_sum_episodes_length_in": 10.36823839457432, "num_agent_steps_sampled": {"default_agent": 5000.0}, "num_env_steps_sampled": 5000.0, "num_module_steps_sampled": {"default_policy": 5000.0}, "episode_return_min": -9.5, "episode_duration_sec_mean": 0.005627503326628354, "weights_seq_no": 16.0, "time_between_sampling": 0.03590950124878126, "env_reset_timer": 4.856587183459293e-05, "episode_len_min": 20, "rlmodule_inference_timer": 3.38633982313641e-05, "num_env_steps_sampled_lifetime_throughput": 3086.993036492111}, "__all_modules__": {"learner_connector_sum_episodes_length_in": 5000.0, "learner_connector": {"connector_pipeline_timer": 0.15943855782216268, "timers": {"connectors": {"add_one_ts_to_episodes_and_truncate": 0.009177194713581407, "add_observations_from_episodes_to_batch": 0.0008469699346005233, "add_columns_from_episodes_to_train_batch": 0.04203308039609141, "add_time_dim_to_batch_and_zero_pad": 0.09299850799135564, "add_states_from_episodes_to_batch": 0.003790674172932696, "batch_individual_items": 0.010366628867009675, "numpy_to_tensor": 7.319286024440722e-05}}}, "learner_connector_sum_episodes_length_out": 5250.0}, "learners": {"__all_modules__": {"num_non_trainable_parameters": 0, "num_trainable_parameters": 24861, "num_module_steps_trained_lifetime": 203490, "num_env_steps_trained": 36000, "num_module_steps_trained": 11970, "num_env_steps_trained_lifetime": 612000, "num_env_steps_trained_lifetime_throughput": 4371.859445027725, "num_module_steps_trained_throughput": 20489791.93046035, "num_module_steps_trained_lifetime_throughput": 13626279.112448886}, "default_policy": {"vf_explained_var": 0.0013633966445922852, "vf_loss_unclipped": 44.97935485839844, "use_intrinsic_rewards": 0.0, "weights_seq_no": 17.0, "total_loss": 0.24849511682987213, "num_trainable_parameters": 16595, "curr_entropy_coeff": 0.0015431216992, "num_module_steps_trained_lifetime": 101745, "vf_loss": 0.3205161690711975, "diff_num_grad_updates_vs_sampler_policy": 1.0, "curr_kl_coeff": 1.2327875538176158e-06, "num_module_steps_trained": 5985, "mean_kl_loss": 2.531043537601363e-05, "module_train_batch_size_mean": 998.0332888909784, "policy_loss": -0.00016718775441404432, "entropy": 0.6714613437652588, "num_module_steps_trained_lifetime_throughput": 726.2493988420201}, "intrinsic_reward_module": {"num_module_steps_trained": 5985, "diff_num_grad_updates_vs_sampler_policy": 1.0, "gradients_default_optimizer_global_norm": 0.0, "weights_seq_no": 17.0, "module_train_batch_size_mean": 998.0332888909784, "num_trainable_parameters": 8266, "default_optimizer_learning_rate": 0.0002715581955, "curr_entropy_coeff": 0.0015431216992, "num_module_steps_trained_lifetime": 101745, "total_loss": 0.0, "num_module_steps_trained_lifetime_throughput": 726.2560397071321}, "differentiable_learners": {"intrinsic_attention_ppo_learner": {"default_policy": {"vf_loss_unclipped": 44.86984634399414, "num_module_steps_trained_lifetime": 610470, "total_loss": 0.24852316081523895, "vf_loss": 0.32054445147514343, "mean_kl_loss": 2.462115116941277e-05, "diff_num_grad_updates_vs_sampler_policy": 86.0, "policy_loss": -0.0001651103957556188, "num_module_steps_trained": 35910, "vf_explained_var": 0.0023227930068969727, "use_intrinsic_rewards": 1.0, "weights_seq_no": 102.0, "module_train_batch_size_mean": 997.4956760259092, "entropy": 0.6714807152748108}, "__all_modules__": {"num_module_steps_trained_lifetime": 1220940, "num_env_steps_trained_lifetime": 3672000, "num_env_steps_trained": 216000, "num_module_steps_trained": 71820, "num_env_steps_trained_lifetime_throughput": 48306.59930216121}, "intrinsic_reward_module": {"num_module_steps_trained": 35910, "weights_seq_no": 102.0, "module_train_batch_size_mean": 997.4956760259092, "total_loss": 0.0, "num_module_steps_trained_lifetime": 610470, "diff_num_grad_updates_vs_sampler_policy": 86.0}}}, "IntrinsicAttentionMask": [[[0.16642460227012634, 0.16665755212306976, 0.16655008494853973, 0.16678321361541748, 0.1666756570339203, 0.16690896451473236], [0.1664479523897171, 0.1666584312915802, 0.1665613204240799, 0.16677196323871613, 0.16667477786540985, 0.16688555479049683], [0.16643717885017395, 0.16665802896022797, 0.16655613481998444, 0.1667771339416504, 0.16667518019676208, 0.16689634323120117], [0.1664605289697647, 0.1666589081287384, 0.16656740009784698, 0.16676589846611023, 0.16667431592941284, 0.16687294840812683], [0.16644975543022156, 0.16665849089622498, 0.16656219959259033, 0.1667710691690445, 0.16667470335960388, 0.16688373684883118], [0.1664731204509735, 0.1666593849658966, 0.16657346487045288, 0.16675983369350433, 0.16667385399341583, 0.16686034202575684]], [[0.16693423688411713, 0.16620659828186035, 0.16657696664333344, 0.16707909107208252, 0.1663508266210556, 0.16685226559638977], [0.16707122325897217, 0.16597123444080353, 0.1665308177471161, 0.16729049384593964, 0.1661890596151352, 0.16694718599319458], [0.16700144112110138, 0.1660911589860916, 0.16655434668064117, 0.1671827733516693, 0.16627149283885956, 0.16689884662628174], [0.16690704226493835, 0.16625337302684784, 0.16658611595630646, 0.16703714430332184, 0.16638295352458954, 0.16683343052864075], [0.1670440286397934, 0.16601794958114624, 0.1665399819612503, 0.16724850237369537, 0.16622117161750793, 0.16692835092544556], [0.16694964468479156, 0.16618013381958008, 0.16657178103923798, 0.1671028584241867, 0.1663326472043991, 0.16686294972896576]], [[0.16734911501407623, 0.1664864867925644, 0.1668516993522644, 0.16613569855690002, 0.16694669425487518, 0.16623030602931976], [0.1677766740322113, 0.1663733720779419, 0.16696693003177643, 0.16580404341220856, 0.16712146997451782, 0.165957510471344], [0.16759531199932098, 0.16642138361930847, 0.16691811382770538, 0.1659446358680725, 0.1670473963022232, 0.16607317328453064], [0.16795136034488678, 0.1663271188735962, 0.16701385378837585, 0.16566874086856842, 0.1671927273273468, 0.16584616899490356], [0.16754820942878723, 0.16643382608890533, 0.16690540313720703, 0.16598115861415863, 0.16702814400196075, 0.16610321402549744], [0.16790419816970825, 0.16633960604667664, 0.16700120270252228, 0.16570524871349335, 0.16717348992824554, 0.16587620973587036]], [[0.16677764058113098, 0.16661898791790009, 0.16657134890556335, 0.16659916937351227, 0.1667024940252304, 0.16673032939434052], [0.16681475937366486, 0.16660302877426147, 0.1665394902229309, 0.16657660901546478, 0.16671445965766907, 0.16675162315368652], [0.16682592034339905, 0.16659824550151825, 0.16652992367744446, 0.16656982898712158, 0.16671806573867798, 0.16675803065299988], [0.16681939363479614, 0.1666010469198227, 0.16653551161289215, 0.16657379269599915, 0.16671594977378845, 0.16675427556037903], [0.16679522395133972, 0.1666114330291748, 0.16655626893043518, 0.16658850014209747, 0.16670815646648407, 0.16674041748046875], [0.166788712143898, 0.16661423444747925, 0.16656185686588287, 0.16659246385097504, 0.16670605540275574, 0.1667366772890091]], [[0.16734907031059265, 0.16604112088680267, 0.16685165464878082, 0.16658124327659607, 0.1669466495513916, 0.16623026132583618], [0.16799837350845337, 0.1654484122991562, 0.1670263707637787, 0.16649910807609558, 0.16721180081367493, 0.16581597924232483], [0.16759523749351501, 0.16581612825393677, 0.16691803932189941, 0.16655020415782928, 0.16704732179641724, 0.16607309877872467], [0.1677294373512268, 0.16569358110427856, 0.1669541448354721, 0.1665332168340683, 0.16710211336612701, 0.16598744690418243], [0.16754813492298126, 0.16585911810398102, 0.16690532863140106, 0.16655613481998444, 0.16702806949615479, 0.16610313951969147], [0.1679040640592575, 0.16553433239459991, 0.16700106859207153, 0.16651108860969543, 0.1671733558177948, 0.16587607562541962]], [[0.16686496138572693, 0.16644442081451416, 0.16665856540203094, 0.1669485867023468, 0.16652783751487732, 0.16655564308166504], [0.16704079508781433, 0.1662474423646927, 0.16665121912956238, 0.1671987771987915, 0.16640466451644897, 0.16645711660385132], [0.16695119440555573, 0.16634778678417206, 0.16665497422218323, 0.16707126796245575, 0.16646742820739746, 0.1665073186159134], [0.16683006286621094, 0.1664835512638092, 0.16666002571582794, 0.1668989509344101, 0.16655229032039642, 0.16657520830631256], [0.16700588166713715, 0.16628654301166534, 0.16665267944335938, 0.16714908182621002, 0.16642913222312927, 0.16647668182849884], [0.16699424386024475, 0.16629956662654877, 0.16665317118167877, 0.16713251173496246, 0.1664372682571411, 0.16648319363594055]]]}, "num_training_step_calls_per_iteration": 1, "evaluation": {"env_runners": {"agent_episode_returns_mean": {"default_agent": -0.75}, "num_agent_steps_sampled": {"default_agent": 400}, "num_agent_steps_sampled_lifetime": {"default_agent": 6800}, "episode_return_min": -13.5, "module_to_env_connector": {"timers": {"connectors": {"remove_single_ts_time_rank_from_batch": 1.220836294030848e-05, "tensor_to_numpy": 1.6199280878669348e-05, "normalize_and_clip_actions": 8.067164946721062e-06, "listify_data_for_vector_env": 1.1163426722388043e-05, "get_actions": 4.03128329467329e-05, "un_batch_to_individual_items": 6.644477265091271e-06}}, "connector_pipeline_timer": 0.0001215880002910848}, "rlmodule_inference_timer": 3.428314257129255e-05, "env_step_timer": 1.5766531163470766e-05, "num_episodes_lifetime": 340, "env_to_module_sum_episodes_length_in": 10.368238394574323, "num_env_steps_sampled": 400, "env_to_module_connector": {"timers": {"connectors": {"add_observations_from_episodes_to_batch": 2.8272521504992174e-06, "add_time_dim_to_batch_and_zero_pad": 7.470920806822426e-06, "batch_individual_items": 1.3315212952128254e-05, "numpy_to_tensor": 1.3651705841971518e-05, "add_states_from_episodes_to_batch": 2.77552663400691e-06}}, "connector_pipeline_timer": 6.33400783975468e-05}, "num_module_steps_sampled": {"default_policy": 400}, "env_reset_timer": 0.0006216681708530272, "num_module_steps_sampled_lifetime": {"default_policy": 6800}, "env_to_module_sum_episodes_length_out": 10.368238394574323, "module_episode_returns_mean": {"default_policy": -0.75}, "episode_return_mean": -0.75, "num_episodes": 20, "episode_len_mean": 20.0, "episode_return_max": 14.5, "num_env_steps_sampled_lifetime": 85400, "sample": 0.12910877252944297, "episode_duration_sec_mean": 0.00572831831057556, "weights_seq_no": 17.0, "episode_len_min": 20, "episode_len_max": 20, "time_between_sampling": 9.956021859812004}, "num_healthy_workers": 1, "actor_manager_num_outstanding_async_reqs": 0, "num_remote_worker_restarts": 0}, "num_env_steps_sampled_lifetime": -9252500.0, "fault_tolerance": {"num_healthy_workers": 0, "num_remote_worker_restarts": 0}, "env_runner_group": {"actor_manager_num_outstanding_async_reqs": 0}, "done": false, "training_iteration": 17, "trial_id": "b1df4_00000", "date": "2025-08-11_18-03-39", "timestamp": 1754928219, "time_this_iter_s": 11.31306791305542, "time_total_s": 179.59015798568726, "pid": 10074, "hostname": "Mac", "node_ip": "127.0.0.1", "config": {"exploration_config": {}, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 2, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "env": "Umbrella", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": false, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 0, "create_local_env_runner": true, "num_envs_per_env_runner": 1, "gym_env_vectorize_mode": "SYNC", "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "episodes_to_numpy": true, "max_requests_in_flight_per_env_runner": 1, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "merge_env_runner_states": "training_only", "broadcast_env_runner_states": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "complete_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "sampler_perf_stats_ema_coef": null, "_is_online": true, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": "auto", "num_aggregator_actors_per_learner": 0, "max_requests_in_flight_per_aggregator_actor": 3, "local_gpu_idx": 0, "max_requests_in_flight_per_learner": 3, "gamma": 1, "lr": 0.0002715581955, "grad_clip": 0.5, "grad_clip_by": "global_norm", "_train_batch_size_per_learner": 5000, "train_batch_size": 4000, "num_epochs": 1, "minibatch_size": 1000, "shuffle_batch_per_epoch": true, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "log_std_clip_param": 20.0, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "_disable_preprocessor_api": false, "_disable_action_flattening": false}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {"intrinsic_reward_coeff": 0.2795015916508}, "optimizer": {}, "_learner_class": "<class 'source.intrinsic_attention_ppo.learners.IntrinsicAttentionMetaLearner.IntrinsicAttentionMetaLearner'>", "callbacks_on_algorithm_init": null, "callbacks_on_env_runners_recreated": null, "callbacks_on_offline_eval_runners_recreated": null, "callbacks_on_checkpoint_loaded": null, "callbacks_on_environment_created": null, "callbacks_on_episode_created": null, "callbacks_on_episode_start": null, "callbacks_on_episode_step": null, "callbacks_on_episode_end": null, "callbacks_on_evaluate_start": null, "callbacks_on_evaluate_end": null, "callbacks_on_evaluate_offline_start": null, "callbacks_on_evaluate_offline_end": null, "callbacks_on_sample_end": null, "callbacks_on_train_result": null, "explore": true, "enable_rl_module_and_learner": true, "enable_env_runner_and_connector_v2": true, "_prior_exploration_config": {"type": "StochasticSampling"}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x3855fd760>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "offline_data_class": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_read_batch_size": null, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "materialize_data": false, "materialize_mapped_data": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "ignore_final_observation": false, "prelearner_class": null, "prelearner_buffer_class": null, "prelearner_buffer_kwargs": {}, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_remaining_data": false, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": 1, "evaluation_duration": 20, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_auto_duration_min_env_steps_per_sample": 100, "evaluation_auto_duration_max_env_steps_per_sample": 2000, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 1, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "offline_evaluation_interval": null, "num_offline_eval_runners": 0, "offline_loss_for_module_fn": null, "offline_evaluation_duration": 1, "offline_evaluation_parallel_to_training": false, "offline_evaluation_timeout_s": 120.0, "num_cpus_per_offline_eval_runner": 1, "num_gpus_per_offline_eval_runner": 0, "custom_resources_per_offline_eval_runner": {}, "restart_failed_offline_eval_runners": true, "ignore_offline_eval_runner_failures": false, "max_num_offline_eval_runner_restarts": 1000, "offline_eval_runner_restore_timeout_s": 1800.0, "max_requests_in_flight_per_offline_eval_runner": 1, "validate_offline_eval_runners_after_construction": true, "offline_eval_runner_health_probe_timeout_s": 30.0, "offline_eval_rl_module_inference_only": false, "broadcast_offline_eval_runner_states": false, "offline_eval_batch_size_per_runner": 256, "dataset_num_iters_per_eval_runner": 1, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "log_gradients": false, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 6, "restart_failed_env_runners": true, "ignore_env_runner_failures": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30.0, "env_runner_restore_timeout_s": 1800.0, "_model_config": {}, "_rl_module_spec": "MultiRLModuleSpec(multi_rl_module_class=<class 'ray.rllib.core.rl_module.multi_rl_module.MultiRLModule'>, observation_space=None, action_space=None, inference_only=False, model_config=None, rl_module_specs={'default_policy': RLModuleSpec(module_class=<class 'source.intrinsic_attention_ppo.rl_modules.DifferentiablePPOModule.DifferentiablePPOModule'>, observation_space=None, action_space=None, inference_only=False, learner_only=False, model_config={'vf_share_layers': True, 'embedding_dim': 62, 'max_seq_len': 6, 'policy_head_hidden_sizes': [32], 'value_head_hidden_sizes': [101], 'embedding_hidden_sizes': [121]}, catalog_class=None, load_state_path=None, model_config_dict=None), 'intrinsic_reward_module': RLModuleSpec(module_class=<class 'source.intrinsic_attention_ppo.rl_modules.IntrinsicAttentionModule.IntrinsicAttentionModule'>, observation_space=None, action_space=None, inference_only=False, learner_only=True, model_config={'intrinsic_reward_network': {'encoder_hidden_sizes': [], 'encoding_dim': 1, 'num_heads': 1, 'head_hidden_sizes': None, 'layers': [{'type': 'attention'}]}, 'extrinsic_value_hidden_layers': [127, 60], 'vf_share_layers': True, 'max_seq_len': 6}, catalog_class=None, load_state_path=None, model_config_dict=None)}, load_state_path=None, modules_to_load=None, module_specs={'default_policy': RLModuleSpec(module_class=<class 'source.intrinsic_attention_ppo.rl_modules.DifferentiablePPOModule.DifferentiablePPOModule'>, observation_space=None, action_space=None, inference_only=False, learner_only=False, model_config={'vf_share_layers': True, 'embedding_dim': 62, 'max_seq_len': 6, 'policy_head_hidden_sizes': [32], 'value_head_hidden_sizes': [101], 'embedding_hidden_sizes': [121]}, catalog_class=None, load_state_path=None, model_config_dict=None), 'intrinsic_reward_module': RLModuleSpec(module_class=<class 'source.intrinsic_attention_ppo.rl_modules.IntrinsicAttentionModule.IntrinsicAttentionModule'>, observation_space=None, action_space=None, inference_only=False, learner_only=True, model_config={'intrinsic_reward_network': {'encoder_hidden_sizes': [], 'encoding_dim': 1, 'num_heads': 1, 'head_hidden_sizes': None, 'layers': [{'type': 'attention'}]}, 'extrinsic_value_hidden_layers': [127, 60], 'vf_share_layers': True, 'max_seq_len': 6}, catalog_class=None, load_state_path=None, model_config_dict=None)})", "algorithm_config_overrides_per_module": {"intrinsic_reward_module": {"lr": 0.0002715581955}}, "_per_module_overrides": {}, "_validate_config": true, "_use_msgpack_checkpoints": false, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "env_task_fn": -1, "enable_connectors": -1, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.161583927863, "kl_target": 0.0201019014258, "vf_loss_coeff": 0.7790510010087, "entropy_coeff": 0.0015431216992, "clip_param": 0.2459212356676, "vf_clip_param": 0.3769744131561, "entropy_coeff_schedule": null, "lr_schedule": null, "sgd_minibatch_size": -1, "vf_share_layers": -1, "differentiable_learner_configs": ["DifferentiableLearnerConfig(learner_class=<class 'source.intrinsic_attention_ppo.learners.IntrinsicAttentionPPOLearner.IntrinsicAttentionPPOLearner'>, learner_connector=None, add_default_connectors_to_learner_pipeline=True, is_multi_agent=False, policies_to_update=['default_policy'], lr=0.0060984166342, num_total_minibatches=0, num_epochs=1, minibatch_size=1000, shuffle_batch_per_epoch=True)"], "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9485408017724, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.callbacks.callbacks.RLlibCallback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 179.59015798568726, "iterations_since_restore": 17, "perf": {"cpu_util_percent": 55.13125, "ram_util_percent": 82.59375}}
{"timers": {"training_iteration": 10.536024327554697, "restore_env_runners": 9.812819433440448e-06, "training_step": 10.53577288899302, "env_runner_sampling_timer": 1.732706499660459, "learner_update_timer": 8.60246123517052, "synch_weights": 0.001802244908633359, "restore_eval_env_runners": 7.269720563649386e-05, "evaluation_iteration": 0.140619539387661, "synch_eval_env_connectors": 0.00021370039604145618, "synch_env_connectors": 5.548940563486157e-06}, "env_runners": {"episode_return_max": 10.5, "module_to_env_connector": {"timers": {"connectors": {"tensor_to_numpy": 1.582337477180227e-05, "normalize_and_clip_actions": 8.437136379644839e-06, "un_batch_to_individual_items": 6.865466196014045e-06, "listify_data_for_vector_env": 1.0970917215096987e-05, "get_actions": 4.083454872921035e-05, "remove_single_ts_time_rank_from_batch": 1.2381740850141292e-05}}, "connector_pipeline_timer": 0.00012282639888339534}, "episode_len_mean": 20.0, "episode_len_max": 20, "num_module_steps_sampled_lifetime": {"default_policy": -9870000.0}, "num_env_steps_sampled_lifetime": -9870000.0, "module_episode_returns_mean": {"default_policy": 3.4599999999999995}, "env_to_module_sum_episodes_length_out": 10.36823839457432, "episode_return_mean": 3.4599999999999995, "env_to_module_connector": {"timers": {"connectors": {"add_time_dim_to_batch_and_zero_pad": 7.417971331284051e-06, "add_observations_from_episodes_to_batch": 3.0037438288523226e-06, "add_states_from_episodes_to_batch": 2.8825733274282464e-06, "numpy_to_tensor": 1.3331108150964673e-05, "batch_individual_items": 1.2919147325991597e-05}}, "connector_pipeline_timer": 6.216884986670021e-05}, "agent_episode_returns_mean": {"default_agent": 3.4599999999999995}, "env_step_timer": 1.4551570787041674e-05, "sample": 0.005875054047256753, "num_episodes": 250.0, "num_agent_steps_sampled_lifetime": {"default_agent": -9870000.0}, "num_episodes_lifetime": -493500.0, "env_to_module_sum_episodes_length_in": 10.36823839457432, "num_agent_steps_sampled": {"default_agent": 5000.0}, "num_env_steps_sampled": 5000.0, "num_module_steps_sampled": {"default_policy": 5000.0}, "episode_return_min": -9.5, "episode_duration_sec_mean": 0.0054951111525297185, "weights_seq_no": 17.0, "time_between_sampling": 0.03902104991855073, "env_reset_timer": 4.6700046143712315e-05, "episode_len_min": 20, "rlmodule_inference_timer": 3.2842891156310876e-05, "num_env_steps_sampled_lifetime_throughput": 3125.5465798897762}, "__all_modules__": {"learner_connector_sum_episodes_length_in": 5000.0, "learner_connector": {"connector_pipeline_timer": 0.15939385807302728, "timers": {"connectors": {"add_one_ts_to_episodes_and_truncate": 0.009172739856228622, "add_observations_from_episodes_to_batch": 0.0008472452354865292, "add_columns_from_episodes_to_train_batch": 0.0420302287616855, "add_time_dim_to_batch_and_zero_pad": 0.09298967333060468, "add_states_from_episodes_to_batch": 0.0037899311810062264, "batch_individual_items": 0.0103388675788977, "numpy_to_tensor": 7.331176233476104e-05}}}, "learner_connector_sum_episodes_length_out": 5250.0}, "learners": {"__all_modules__": {"num_non_trainable_parameters": 0, "num_trainable_parameters": 24861, "num_module_steps_trained_lifetime": 215460, "num_env_steps_trained": 36000, "num_module_steps_trained": 11970, "num_env_steps_trained_lifetime": 648000, "num_env_steps_trained_lifetime_throughput": 4347.885261068512, "num_module_steps_trained_throughput": 20029577.20351611, "num_module_steps_trained_lifetime_throughput": 13538044.505955894}, "default_policy": {"vf_explained_var": 0.0009320378303527832, "vf_loss_unclipped": 43.87286376953125, "use_intrinsic_rewards": 0.0, "weights_seq_no": 18.0, "total_loss": 0.24835418164730072, "num_trainable_parameters": 16595, "curr_entropy_coeff": 0.0015431216992, "num_module_steps_trained_lifetime": 107730, "vf_loss": 0.3205188512802124, "diff_num_grad_updates_vs_sampler_policy": 1.0, "curr_kl_coeff": 6.163937769088079e-07, "num_module_steps_trained": 5985, "mean_kl_loss": 1.6162244719453156e-05, "module_train_batch_size_mean": 998.0016398003509, "policy_loss": -0.00031284402939490974, "entropy": 0.6697357892990112, "num_module_steps_trained_lifetime_throughput": 722.2863424340555}, "intrinsic_reward_module": {"num_module_steps_trained": 5985, "diff_num_grad_updates_vs_sampler_policy": 1.0, "gradients_default_optimizer_global_norm": 0.0, "weights_seq_no": 18.0, "module_train_batch_size_mean": 998.0016398003509, "num_trainable_parameters": 8266, "default_optimizer_learning_rate": 0.0002715581955, "curr_entropy_coeff": 0.0015431216992, "num_module_steps_trained_lifetime": 107730, "total_loss": 0.0, "num_module_steps_trained_lifetime_throughput": 722.2925428931118}, "differentiable_learners": {"intrinsic_attention_ppo_learner": {"default_policy": {"vf_loss_unclipped": 43.772586822509766, "num_module_steps_trained_lifetime": 646380, "total_loss": 0.2483951449394226, "vf_loss": 0.3205539584159851, "mean_kl_loss": 1.5002553482190706e-05, "diff_num_grad_updates_vs_sampler_policy": 91.0, "policy_loss": -0.00030161257018335164, "num_module_steps_trained": 35910, "vf_explained_var": 0.002467930316925049, "use_intrinsic_rewards": 1.0, "weights_seq_no": 108.0, "module_train_batch_size_mean": 997.4947003847115, "entropy": 0.6697800755500793}, "__all_modules__": {"num_module_steps_trained_lifetime": 1292760, "num_env_steps_trained_lifetime": 3888000, "num_env_steps_trained": 216000, "num_module_steps_trained": 71820, "num_env_steps_trained_lifetime_throughput": 47552.89262653652}, "intrinsic_reward_module": {"num_module_steps_trained": 35910, "weights_seq_no": 108.0, "module_train_batch_size_mean": 997.4947003847115, "total_loss": 0.0, "num_module_steps_trained_lifetime": 646380, "diff_num_grad_updates_vs_sampler_policy": 91.0}}}, "IntrinsicAttentionMask": [[[0.1674237847328186, 0.16611525416374207, 0.16692614555358887, 0.16620983183383942, 0.16657443344593048, 0.16675050556659698], [0.1681446135044098, 0.16559243202209473, 0.16717176139354706, 0.16577626764774323, 0.16648586094379425, 0.16682906448841095], [0.1676970273256302, 0.1659168303012848, 0.16701942682266235, 0.16604535281658173, 0.1665409505367279, 0.16678044199943542], [0.1680922508239746, 0.16563032567501068, 0.1671539694070816, 0.16580772399902344, 0.16649232804775238, 0.1668233871459961], [0.1678907871246338, 0.1657762974500656, 0.1670854240655899, 0.16592879593372345, 0.16651713848114014, 0.1668015420436859], [0.16779372096061707, 0.16584669053554535, 0.16705237329006195, 0.16598717868328094, 0.1665290743112564, 0.16679097712039948]], [[0.16673395037651062, 0.1665753424167633, 0.16652771830558777, 0.16681751608848572, 0.16665881872177124, 0.16668665409088135], [0.16675645112991333, 0.16654479503631592, 0.16648127138614655, 0.16686797142028809, 0.16665618121623993, 0.1666933298110962], [0.16676321625709534, 0.1665356159210205, 0.1664673089981079, 0.16688314080238342, 0.16665539145469666, 0.16669532656669617], [0.1667221039533615, 0.16659140586853027, 0.16655217111110687, 0.1667909473180771, 0.16666018962860107, 0.1666831374168396], [0.16674461960792542, 0.16656088829040527, 0.16650572419166565, 0.16684141755104065, 0.16665758192539215, 0.16668982803821564], [0.16674067080020905, 0.16656625270843506, 0.16651387512683868, 0.1668325662612915, 0.16665804386138916, 0.16668865084648132]], [[0.16642430424690247, 0.16606728732585907, 0.16714148223400116, 0.1667829304933548, 0.1666753590106964, 0.16690866649150848], [0.1663883477449417, 0.1659785807132721, 0.16721190512180328, 0.1668000966310501, 0.1666765958070755, 0.1669445037841797], [0.16649626195430756, 0.1662450134754181, 0.16700051724910736, 0.16674849390983582, 0.16667285561561584, 0.1668369024991989], [0.1664603352546692, 0.16615623235702515, 0.1670709103345871, 0.16676568984985352, 0.16667412221431732, 0.16687273979187012], [0.16644953191280365, 0.16612955927848816, 0.16709205508232117, 0.1667708456516266, 0.16667447984218597, 0.16688351333141327], [0.166472926735878, 0.1661873757839203, 0.1670461893081665, 0.1667596399784088, 0.1666736751794815, 0.16686014831066132]], [[0.16685880720615387, 0.16658411920070648, 0.16650168597698212, 0.16654983162879944, 0.166728675365448, 0.1667768806219101], [0.16689594089984894, 0.16656816005706787, 0.16646982729434967, 0.16652727127075195, 0.16674064099788666, 0.1667981594800949], [0.16690710186958313, 0.16656337678432465, 0.16646026074886322, 0.16652049124240875, 0.16674423217773438, 0.16680456697940826], [0.16690057516098022, 0.1665661782026291, 0.1664658486843109, 0.16652445495128632, 0.16674213111400604, 0.1668008267879486], [0.1668763905763626, 0.1665765643119812, 0.16648660600185394, 0.16653914749622345, 0.16673433780670166, 0.16678695380687714], [0.1668698638677597, 0.16657935082912445, 0.16649217903614044, 0.16654309630393982, 0.16673222184181213, 0.16678321361541748]], [[0.16642408072948456, 0.16606706380844116, 0.16714125871658325, 0.1667827069759369, 0.16726727783679962, 0.16631758213043213], [0.16638807952404022, 0.1659782975912094, 0.1672116219997406, 0.16679981350898743, 0.16735638678073883, 0.1662658154964447], [0.1664961576461792, 0.16624489426612854, 0.1670003980398178, 0.16674837470054626, 0.16708894073963165, 0.16642120480537415], [0.16646015644073486, 0.16615606844425201, 0.16707074642181396, 0.16676552593708038, 0.1671779900789261, 0.1663694530725479], [0.1665087789297104, 0.16627606749534607, 0.1669757068157196, 0.16674235463142395, 0.16705769300460815, 0.16643938422203064], [0.166413351893425, 0.1660405993461609, 0.167162224650383, 0.16678780317306519, 0.16729383170604706, 0.1663021445274353]], [[0.16682128608226776, 0.16666258871555328, 0.16661494970321655, 0.16690489649772644, 0.16648425161838531, 0.16651205718517303], [0.16687297821044922, 0.16666118800640106, 0.1665976196527481, 0.16698458790779114, 0.1664232462644577, 0.1664603352546692], [0.1668885350227356, 0.16666077077388763, 0.16659240424633026, 0.16700854897499084, 0.16640493273735046, 0.1664448231458664], [0.1667940765619278, 0.16666333377361298, 0.1666240692138672, 0.16686294972896576, 0.16651636362075806, 0.1665392816066742], [0.16693115234375, 0.16665959358215332, 0.16657809913158417, 0.1670742779970169, 0.16635464131832123, 0.1664021760225296], [0.16692209243774414, 0.1666598618030548, 0.1665811687707901, 0.16706030070781708, 0.1663653552532196, 0.16641126573085785]]]}, "num_training_step_calls_per_iteration": 1, "evaluation": {"env_runners": {"agent_episode_returns_mean": {"default_agent": -0.35}, "num_agent_steps_sampled": {"default_agent": 400}, "num_agent_steps_sampled_lifetime": {"default_agent": 7200}, "episode_return_min": -13.5, "module_to_env_connector": {"timers": {"connectors": {"remove_single_ts_time_rank_from_batch": 1.1801995084129362e-05, "tensor_to_numpy": 1.5803607136385665e-05, "normalize_and_clip_actions": 7.842233583192248e-06, "listify_data_for_vector_env": 1.029768490550205e-05, "get_actions": 3.670663435299623e-05, "un_batch_to_individual_items": 6.498491714967723e-06}}, "connector_pipeline_timer": 0.00011500093344415318}, "rlmodule_inference_timer": 3.025985212123201e-05, "env_step_timer": 1.3847017876007565e-05, "num_episodes_lifetime": 360, "env_to_module_sum_episodes_length_in": 10.368238394574323, "num_env_steps_sampled": 400, "env_to_module_connector": {"timers": {"connectors": {"add_observations_from_episodes_to_batch": 2.7637329684040805e-06, "add_time_dim_to_batch_and_zero_pad": 6.836708130884233e-06, "batch_individual_items": 1.2113869394977343e-05, "numpy_to_tensor": 1.190547732463218e-05, "add_states_from_episodes_to_batch": 2.660612228784855e-06}}, "connector_pipeline_timer": 5.831861368860742e-05}, "num_module_steps_sampled": {"default_policy": 400}, "env_reset_timer": 0.0006184423291473913, "num_module_steps_sampled_lifetime": {"default_policy": 7200}, "env_to_module_sum_episodes_length_out": 10.368238394574323, "module_episode_returns_mean": {"default_policy": -0.35}, "episode_return_mean": -0.35, "num_episodes": 20, "episode_len_mean": 20.0, "episode_return_max": 14.5, "num_env_steps_sampled_lifetime": 90400, "sample": 0.12896340314397917, "episode_duration_sec_mean": 0.005738872877554968, "weights_seq_no": 18.0, "episode_len_min": 20, "episode_len_max": 20, "time_between_sampling": 9.95997144371437}, "num_healthy_workers": 1, "actor_manager_num_outstanding_async_reqs": 0, "num_remote_worker_restarts": 0}, "num_env_steps_sampled_lifetime": -9870000.0, "fault_tolerance": {"num_healthy_workers": 0, "num_remote_worker_restarts": 0}, "env_runner_group": {"actor_manager_num_outstanding_async_reqs": 0}, "done": false, "training_iteration": 18, "trial_id": "b1df4_00000", "date": "2025-08-11_18-03-49", "timestamp": 1754928229, "time_this_iter_s": 10.439069986343384, "time_total_s": 190.02922797203064, "pid": 10074, "hostname": "Mac", "node_ip": "127.0.0.1", "config": {"exploration_config": {}, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 2, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "env": "Umbrella", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": false, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 0, "create_local_env_runner": true, "num_envs_per_env_runner": 1, "gym_env_vectorize_mode": "SYNC", "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "episodes_to_numpy": true, "max_requests_in_flight_per_env_runner": 1, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "merge_env_runner_states": "training_only", "broadcast_env_runner_states": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "complete_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "sampler_perf_stats_ema_coef": null, "_is_online": true, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": "auto", "num_aggregator_actors_per_learner": 0, "max_requests_in_flight_per_aggregator_actor": 3, "local_gpu_idx": 0, "max_requests_in_flight_per_learner": 3, "gamma": 1, "lr": 0.0002715581955, "grad_clip": 0.5, "grad_clip_by": "global_norm", "_train_batch_size_per_learner": 5000, "train_batch_size": 4000, "num_epochs": 1, "minibatch_size": 1000, "shuffle_batch_per_epoch": true, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "log_std_clip_param": 20.0, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "_disable_preprocessor_api": false, "_disable_action_flattening": false}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {"intrinsic_reward_coeff": 0.2795015916508}, "optimizer": {}, "_learner_class": "<class 'source.intrinsic_attention_ppo.learners.IntrinsicAttentionMetaLearner.IntrinsicAttentionMetaLearner'>", "callbacks_on_algorithm_init": null, "callbacks_on_env_runners_recreated": null, "callbacks_on_offline_eval_runners_recreated": null, "callbacks_on_checkpoint_loaded": null, "callbacks_on_environment_created": null, "callbacks_on_episode_created": null, "callbacks_on_episode_start": null, "callbacks_on_episode_step": null, "callbacks_on_episode_end": null, "callbacks_on_evaluate_start": null, "callbacks_on_evaluate_end": null, "callbacks_on_evaluate_offline_start": null, "callbacks_on_evaluate_offline_end": null, "callbacks_on_sample_end": null, "callbacks_on_train_result": null, "explore": true, "enable_rl_module_and_learner": true, "enable_env_runner_and_connector_v2": true, "_prior_exploration_config": {"type": "StochasticSampling"}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x3855fd760>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "offline_data_class": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_read_batch_size": null, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "materialize_data": false, "materialize_mapped_data": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "ignore_final_observation": false, "prelearner_class": null, "prelearner_buffer_class": null, "prelearner_buffer_kwargs": {}, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_remaining_data": false, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": 1, "evaluation_duration": 20, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_auto_duration_min_env_steps_per_sample": 100, "evaluation_auto_duration_max_env_steps_per_sample": 2000, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 1, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "offline_evaluation_interval": null, "num_offline_eval_runners": 0, "offline_loss_for_module_fn": null, "offline_evaluation_duration": 1, "offline_evaluation_parallel_to_training": false, "offline_evaluation_timeout_s": 120.0, "num_cpus_per_offline_eval_runner": 1, "num_gpus_per_offline_eval_runner": 0, "custom_resources_per_offline_eval_runner": {}, "restart_failed_offline_eval_runners": true, "ignore_offline_eval_runner_failures": false, "max_num_offline_eval_runner_restarts": 1000, "offline_eval_runner_restore_timeout_s": 1800.0, "max_requests_in_flight_per_offline_eval_runner": 1, "validate_offline_eval_runners_after_construction": true, "offline_eval_runner_health_probe_timeout_s": 30.0, "offline_eval_rl_module_inference_only": false, "broadcast_offline_eval_runner_states": false, "offline_eval_batch_size_per_runner": 256, "dataset_num_iters_per_eval_runner": 1, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "log_gradients": false, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 6, "restart_failed_env_runners": true, "ignore_env_runner_failures": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30.0, "env_runner_restore_timeout_s": 1800.0, "_model_config": {}, "_rl_module_spec": "MultiRLModuleSpec(multi_rl_module_class=<class 'ray.rllib.core.rl_module.multi_rl_module.MultiRLModule'>, observation_space=None, action_space=None, inference_only=False, model_config=None, rl_module_specs={'default_policy': RLModuleSpec(module_class=<class 'source.intrinsic_attention_ppo.rl_modules.DifferentiablePPOModule.DifferentiablePPOModule'>, observation_space=None, action_space=None, inference_only=False, learner_only=False, model_config={'vf_share_layers': True, 'embedding_dim': 62, 'max_seq_len': 6, 'policy_head_hidden_sizes': [32], 'value_head_hidden_sizes': [101], 'embedding_hidden_sizes': [121]}, catalog_class=None, load_state_path=None, model_config_dict=None), 'intrinsic_reward_module': RLModuleSpec(module_class=<class 'source.intrinsic_attention_ppo.rl_modules.IntrinsicAttentionModule.IntrinsicAttentionModule'>, observation_space=None, action_space=None, inference_only=False, learner_only=True, model_config={'intrinsic_reward_network': {'encoder_hidden_sizes': [], 'encoding_dim': 1, 'num_heads': 1, 'head_hidden_sizes': None, 'layers': [{'type': 'attention'}]}, 'extrinsic_value_hidden_layers': [127, 60], 'vf_share_layers': True, 'max_seq_len': 6}, catalog_class=None, load_state_path=None, model_config_dict=None)}, load_state_path=None, modules_to_load=None, module_specs={'default_policy': RLModuleSpec(module_class=<class 'source.intrinsic_attention_ppo.rl_modules.DifferentiablePPOModule.DifferentiablePPOModule'>, observation_space=None, action_space=None, inference_only=False, learner_only=False, model_config={'vf_share_layers': True, 'embedding_dim': 62, 'max_seq_len': 6, 'policy_head_hidden_sizes': [32], 'value_head_hidden_sizes': [101], 'embedding_hidden_sizes': [121]}, catalog_class=None, load_state_path=None, model_config_dict=None), 'intrinsic_reward_module': RLModuleSpec(module_class=<class 'source.intrinsic_attention_ppo.rl_modules.IntrinsicAttentionModule.IntrinsicAttentionModule'>, observation_space=None, action_space=None, inference_only=False, learner_only=True, model_config={'intrinsic_reward_network': {'encoder_hidden_sizes': [], 'encoding_dim': 1, 'num_heads': 1, 'head_hidden_sizes': None, 'layers': [{'type': 'attention'}]}, 'extrinsic_value_hidden_layers': [127, 60], 'vf_share_layers': True, 'max_seq_len': 6}, catalog_class=None, load_state_path=None, model_config_dict=None)})", "algorithm_config_overrides_per_module": {"intrinsic_reward_module": {"lr": 0.0002715581955}}, "_per_module_overrides": {}, "_validate_config": true, "_use_msgpack_checkpoints": false, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "env_task_fn": -1, "enable_connectors": -1, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.161583927863, "kl_target": 0.0201019014258, "vf_loss_coeff": 0.7790510010087, "entropy_coeff": 0.0015431216992, "clip_param": 0.2459212356676, "vf_clip_param": 0.3769744131561, "entropy_coeff_schedule": null, "lr_schedule": null, "sgd_minibatch_size": -1, "vf_share_layers": -1, "differentiable_learner_configs": ["DifferentiableLearnerConfig(learner_class=<class 'source.intrinsic_attention_ppo.learners.IntrinsicAttentionPPOLearner.IntrinsicAttentionPPOLearner'>, learner_connector=None, add_default_connectors_to_learner_pipeline=True, is_multi_agent=False, policies_to_update=['default_policy'], lr=0.0060984166342, num_total_minibatches=0, num_epochs=1, minibatch_size=1000, shuffle_batch_per_epoch=True)"], "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9485408017724, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.callbacks.callbacks.RLlibCallback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 190.02922797203064, "iterations_since_restore": 18, "perf": {"cpu_util_percent": 44.20666666666667, "ram_util_percent": 82.13333333333335}}
{"timers": {"training_iteration": 10.525753846359612, "restore_env_runners": 9.785940908523782e-06, "training_step": 10.525502589263574, "env_runner_sampling_timer": 1.7311393513337765, "learner_update_timer": 8.59372114364954, "synch_weights": 0.0017956024588884685, "restore_eval_env_runners": 7.24023230169282e-05, "evaluation_iteration": 0.14044710983408193, "synch_eval_env_connectors": 0.00021324839210577756, "synch_env_connectors": 5.558861434726196e-06}, "env_runners": {"episode_return_max": 10.5, "module_to_env_connector": {"timers": {"connectors": {"tensor_to_numpy": 1.547226097096999e-05, "normalize_and_clip_actions": 8.281443227571338e-06, "un_batch_to_individual_items": 6.7498476910109255e-06, "listify_data_for_vector_env": 1.0747492066718947e-05, "get_actions": 3.970244760107393e-05, "remove_single_ts_time_rank_from_batch": 1.2233827108783036e-05}}, "connector_pipeline_timer": 0.00012045060005177476}, "episode_len_mean": 20.0, "episode_len_max": 20, "num_module_steps_sampled_lifetime": {"default_policy": -10487500.0}, "num_env_steps_sampled_lifetime": -10487500.0, "module_episode_returns_mean": {"default_policy": 2.899999999999998}, "env_to_module_sum_episodes_length_out": 10.36823839457432, "episode_return_mean": 2.899999999999998, "env_to_module_connector": {"timers": {"connectors": {"add_time_dim_to_batch_and_zero_pad": 7.176368369550263e-06, "add_observations_from_episodes_to_batch": 2.9078302919615516e-06, "add_states_from_episodes_to_batch": 2.80565895495593e-06, "numpy_to_tensor": 1.2961802123170768e-05, "batch_individual_items": 1.2689221622566297e-05}}, "connector_pipeline_timer": 6.1011053693596975e-05}, "agent_episode_returns_mean": {"default_agent": 2.899999999999998}, "env_step_timer": 1.4150375968942936e-05, "sample": 0.005811369305170941, "num_episodes": 250.0, "num_agent_steps_sampled_lifetime": {"default_agent": -10487500.0}, "num_episodes_lifetime": -524375.0, "env_to_module_sum_episodes_length_in": 10.36823839457432, "num_agent_steps_sampled": {"default_agent": 5000.0}, "num_env_steps_sampled": 5000.0, "num_module_steps_sampled": {"default_policy": 5000.0}, "episode_return_min": -9.5, "episode_duration_sec_mean": 0.005394487178418787, "weights_seq_no": 18.0, "time_between_sampling": 0.036187822999971204, "env_reset_timer": 4.48434271372181e-05, "episode_len_min": 20, "rlmodule_inference_timer": 3.243779161394567e-05, "num_env_steps_sampled_lifetime_throughput": 3175.5521188429357}, "__all_modules__": {"learner_connector_sum_episodes_length_in": 5000.0, "learner_connector": {"connector_pipeline_timer": 0.15934704449280362, "timers": {"connectors": {"add_one_ts_to_episodes_and_truncate": 0.009174722877853897, "add_observations_from_episodes_to_batch": 0.0008473111135711421, "add_columns_from_episodes_to_train_batch": 0.04203035939370501, "add_time_dim_to_batch_and_zero_pad": 0.0929681511764563, "add_states_from_episodes_to_batch": 0.0037890522791415625, "batch_individual_items": 0.010312565572734439, "numpy_to_tensor": 7.338739475783054e-05}}}, "learner_connector_sum_episodes_length_out": 5250.0}, "learners": {"__all_modules__": {"num_non_trainable_parameters": 0, "num_trainable_parameters": 24861, "num_module_steps_trained_lifetime": 227430, "num_env_steps_trained": 36000, "num_module_steps_trained": 11970, "num_env_steps_trained_lifetime": 684000, "num_env_steps_trained_lifetime_throughput": 4330.071607490169, "num_module_steps_trained_throughput": 19610547.201938502, "num_module_steps_trained_lifetime_throughput": 13474461.351118283}, "default_policy": {"vf_explained_var": 0.0010091662406921387, "vf_loss_unclipped": 43.08113479614258, "use_intrinsic_rewards": 0.0, "weights_seq_no": 19.0, "total_loss": 0.24867862462997437, "num_trainable_parameters": 16595, "curr_entropy_coeff": 0.0015431216992, "num_module_steps_trained_lifetime": 113715, "vf_loss": 0.32051873207092285, "diff_num_grad_updates_vs_sampler_policy": 1.0, "curr_kl_coeff": 3.0819688845440396e-07, "num_module_steps_trained": 5985, "mean_kl_loss": 1.7415416095900582e-06, "module_train_batch_size_mean": 997.9718428097785, "policy_loss": 1.0429303983983118e-05, "entropy": 0.6689053773880005, "num_module_steps_trained_lifetime_throughput": 719.3458544745199}, "intrinsic_reward_module": {"num_module_steps_trained": 5985, "diff_num_grad_updates_vs_sampler_policy": 1.0, "gradients_default_optimizer_global_norm": 0.0, "weights_seq_no": 19.0, "module_train_batch_size_mean": 997.9718428097785, "num_trainable_parameters": 8266, "default_optimizer_learning_rate": 0.0002715581955, "curr_entropy_coeff": 0.0015431216992, "num_module_steps_trained_lifetime": 113715, "total_loss": 0.0, "num_module_steps_trained_lifetime_throughput": 719.351623077745}, "differentiable_learners": {"intrinsic_attention_ppo_learner": {"default_policy": {"vf_loss_unclipped": 43.00454330444336, "num_module_steps_trained_lifetime": 682290, "total_loss": 0.24871420860290527, "vf_loss": 0.32055866718292236, "mean_kl_loss": 1.967533762581297e-06, "diff_num_grad_updates_vs_sampler_policy": 96.0, "policy_loss": 1.4497006304736715e-05, "num_module_steps_trained": 35910, "vf_explained_var": 0.0024750232696533203, "use_intrinsic_rewards": 1.0, "weights_seq_no": 114.0, "module_train_batch_size_mean": 997.4940209352853, "entropy": 0.6688788533210754}, "__all_modules__": {"num_module_steps_trained_lifetime": 1364580, "num_env_steps_trained_lifetime": 4104000, "num_env_steps_trained": 216000, "num_module_steps_trained": 71820, "num_env_steps_trained_lifetime_throughput": 46850.298065997704}, "intrinsic_reward_module": {"num_module_steps_trained": 35910, "weights_seq_no": 114.0, "module_train_batch_size_mean": 997.4940209352853, "total_loss": 0.0, "num_module_steps_trained_lifetime": 682290, "diff_num_grad_updates_vs_sampler_policy": 96.0}}}, "IntrinsicAttentionMask": [[[0.16632609069347382, 0.16655892133712769, 0.16645149886608124, 0.16668450832366943, 0.16716879606246948, 0.16681018471717834], [0.16635896265506744, 0.16656933724880219, 0.16647228598594666, 0.16668279469013214, 0.16712027788162231, 0.16679634153842926], [0.1663438230752945, 0.16656453907489777, 0.166462704539299, 0.16668358445167542, 0.16714265942573547, 0.16680273413658142], [0.16637665033340454, 0.16657494008541107, 0.16648346185684204, 0.16668187081813812, 0.1670941263437271, 0.16678886115550995], [0.1664448380470276, 0.16659653186798096, 0.16652655601501465, 0.166678324341774, 0.16699354350566864, 0.1667601466178894], [0.16639438271522522, 0.16658055782318115, 0.16649466753005981, 0.1666809618473053, 0.1670680046081543, 0.16678142547607422]], [[0.16636469960212708, 0.16652487218379974, 0.1668575555086136, 0.16690081357955933, 0.16665442287921906, 0.1666976362466812], [0.16640706360340118, 0.16654478013515472, 0.16683076322078705, 0.1668679565191269, 0.16665616631507874, 0.1666933000087738], [0.16649490594863892, 0.1665860265493393, 0.1667751967906952, 0.16679978370666504, 0.16665971279144287, 0.16668428480625153], [0.1665063351392746, 0.16659140586853027, 0.16676799952983856, 0.1667909473180771, 0.16666018962860107, 0.1666831374168396], [0.16644130647182465, 0.16656087338924408, 0.16680912673473358, 0.16684140264987946, 0.16665756702423096, 0.16668981313705444], [0.16645270586013794, 0.16656622290611267, 0.16680189967155457, 0.16683253645896912, 0.16665801405906677, 0.16668862104415894]], [[0.16734927892684937, 0.16648665070533752, 0.16685186326503754, 0.16658145189285278, 0.1665003001689911, 0.1662304699420929], [0.16777710616588593, 0.16637380421161652, 0.16696736216545105, 0.16652779281139374, 0.16639599204063416, 0.16595792770385742], [0.16759561002254486, 0.16642168164253235, 0.16691841185092926, 0.16655057668685913, 0.1664402335882187, 0.16607345640659332], [0.1677299439907074, 0.16638624668121338, 0.1669546514749527, 0.1665337234735489, 0.1664074808359146, 0.16598793864250183], [0.16777031123638153, 0.16637559235095978, 0.1669655293226242, 0.16652865707874298, 0.16639764606952667, 0.16596224904060364], [0.16790473461151123, 0.16634012758731842, 0.16700172424316406, 0.16651175916194916, 0.166364848613739, 0.16587674617767334]], [[0.1667775809764862, 0.16635724902153015, 0.16657128930091858, 0.1668611615896225, 0.16670243442058563, 0.16673026978969574], [0.16687585413455963, 0.16608327627182007, 0.16648665070533752, 0.16703367233276367, 0.1667340099811554, 0.1667865514755249], [0.1668258011341095, 0.16622284054756165, 0.1665297895669937, 0.16694577038288116, 0.16671793162822723, 0.16675789654254913], [0.16675807535648346, 0.16641171276569366, 0.16658811271190643, 0.16682693362236023, 0.16669616103172302, 0.16671909391880035], [0.16679514944553375, 0.16630829870700836, 0.1665561944246292, 0.16689197719097137, 0.1667080819606781, 0.16674034297466278], [0.16678863763809204, 0.16632644832134247, 0.1665617823600769, 0.1668805629014969, 0.16670599579811096, 0.16673661768436432]], [[0.16734927892684937, 0.16648665070533752, 0.16685186326503754, 0.16658145189285278, 0.1665003001689911, 0.1662304699420929], [0.16777710616588593, 0.16637380421161652, 0.16696736216545105, 0.16652779281139374, 0.16639599204063416, 0.16595792770385742], [0.16759561002254486, 0.16642168164253235, 0.16691841185092926, 0.16655057668685913, 0.1664402335882187, 0.16607345640659332], [0.1677299439907074, 0.16638624668121338, 0.1669546514749527, 0.1665337234735489, 0.1664074808359146, 0.16598793864250183], [0.16777031123638153, 0.16637559235095978, 0.1669655293226242, 0.16652865707874298, 0.16639764606952667, 0.16596224904060364], [0.16790473461151123, 0.16634012758731842, 0.16700172424316406, 0.16651175916194916, 0.166364848613739, 0.16587674617767334]], [[0.16632206737995148, 0.1665576547384262, 0.16644896566867828, 0.1671110838651657, 0.1667483150959015, 0.16681191325187683], [0.1663549244403839, 0.1665680855512619, 0.1664697378873825, 0.16706866025924683, 0.1667405366897583, 0.16679808497428894], [0.16633976995944977, 0.1665632724761963, 0.16646015644073486, 0.16708822548389435, 0.16674412786960602, 0.1668044626712799], [0.1664319485425949, 0.16659246385097504, 0.1665184199810028, 0.16696925461292267, 0.16672231256961823, 0.16676563024520874], [0.16638147830963135, 0.16657647490501404, 0.16648651659488678, 0.1670343577861786, 0.1667342483997345, 0.16678686439990997], [0.1663903295993805, 0.16657927632331848, 0.16649210453033447, 0.1670229285955429, 0.16673214733600616, 0.1667831391096115]]]}, "num_training_step_calls_per_iteration": 1, "evaluation": {"env_runners": {"agent_episode_returns_mean": {"default_agent": 0.05}, "num_agent_steps_sampled": {"default_agent": 400}, "num_agent_steps_sampled_lifetime": {"default_agent": 7600}, "episode_return_min": -13.5, "module_to_env_connector": {"timers": {"connectors": {"remove_single_ts_time_rank_from_batch": 1.2028573425968712e-05, "tensor_to_numpy": 1.5084363697386862e-05, "normalize_and_clip_actions": 7.97567016437841e-06, "listify_data_for_vector_env": 1.0379445758376244e-05, "get_actions": 3.630253097540175e-05, "un_batch_to_individual_items": 6.542964687396641e-06}}, "connector_pipeline_timer": 0.00011470675814847103}, "rlmodule_inference_timer": 3.118228994242784e-05, "env_step_timer": 1.3930979564645624e-05, "num_episodes_lifetime": 380, "env_to_module_sum_episodes_length_in": 10.368238394574323, "num_env_steps_sampled": 400, "env_to_module_connector": {"timers": {"connectors": {"add_observations_from_episodes_to_batch": 2.782400621293609e-06, "add_time_dim_to_batch_and_zero_pad": 7.268729382565927e-06, "batch_individual_items": 1.2462559180174197e-05, "numpy_to_tensor": 1.230965776640729e-05, "add_states_from_episodes_to_batch": 2.7087906266082945e-06}}, "connector_pipeline_timer": 5.993655055325108e-05}, "num_module_steps_sampled": {"default_policy": 400}, "env_reset_timer": 0.000613500816367709, "num_module_steps_sampled_lifetime": {"default_policy": 7600}, "env_to_module_sum_episodes_length_out": 10.368238394574323, "module_episode_returns_mean": {"default_policy": 0.05}, "episode_return_mean": 0.05, "num_episodes": 20, "episode_len_mean": 20.0, "episode_return_max": 14.5, "num_env_steps_sampled_lifetime": 95400, "sample": 0.1288219803630867, "episode_duration_sec_mean": 0.0056542912474833425, "weights_seq_no": 19.0, "episode_len_min": 20, "episode_len_max": 20, "time_between_sampling": 9.955765456356726}, "num_healthy_workers": 1, "actor_manager_num_outstanding_async_reqs": 0, "num_remote_worker_restarts": 0}, "num_env_steps_sampled_lifetime": -10487500.0, "fault_tolerance": {"num_healthy_workers": 0, "num_remote_worker_restarts": 0}, "env_runner_group": {"actor_manager_num_outstanding_async_reqs": 0}, "done": false, "training_iteration": 19, "trial_id": "b1df4_00000", "date": "2025-08-11_18-03-59", "timestamp": 1754928239, "time_this_iter_s": 9.634934186935425, "time_total_s": 199.66416215896606, "pid": 10074, "hostname": "Mac", "node_ip": "127.0.0.1", "config": {"exploration_config": {}, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 2, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "env": "Umbrella", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": false, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 0, "create_local_env_runner": true, "num_envs_per_env_runner": 1, "gym_env_vectorize_mode": "SYNC", "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "episodes_to_numpy": true, "max_requests_in_flight_per_env_runner": 1, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "merge_env_runner_states": "training_only", "broadcast_env_runner_states": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "complete_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "sampler_perf_stats_ema_coef": null, "_is_online": true, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": "auto", "num_aggregator_actors_per_learner": 0, "max_requests_in_flight_per_aggregator_actor": 3, "local_gpu_idx": 0, "max_requests_in_flight_per_learner": 3, "gamma": 1, "lr": 0.0002715581955, "grad_clip": 0.5, "grad_clip_by": "global_norm", "_train_batch_size_per_learner": 5000, "train_batch_size": 4000, "num_epochs": 1, "minibatch_size": 1000, "shuffle_batch_per_epoch": true, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "log_std_clip_param": 20.0, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "_disable_preprocessor_api": false, "_disable_action_flattening": false}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {"intrinsic_reward_coeff": 0.2795015916508}, "optimizer": {}, "_learner_class": "<class 'source.intrinsic_attention_ppo.learners.IntrinsicAttentionMetaLearner.IntrinsicAttentionMetaLearner'>", "callbacks_on_algorithm_init": null, "callbacks_on_env_runners_recreated": null, "callbacks_on_offline_eval_runners_recreated": null, "callbacks_on_checkpoint_loaded": null, "callbacks_on_environment_created": null, "callbacks_on_episode_created": null, "callbacks_on_episode_start": null, "callbacks_on_episode_step": null, "callbacks_on_episode_end": null, "callbacks_on_evaluate_start": null, "callbacks_on_evaluate_end": null, "callbacks_on_evaluate_offline_start": null, "callbacks_on_evaluate_offline_end": null, "callbacks_on_sample_end": null, "callbacks_on_train_result": null, "explore": true, "enable_rl_module_and_learner": true, "enable_env_runner_and_connector_v2": true, "_prior_exploration_config": {"type": "StochasticSampling"}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x3855fd760>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "offline_data_class": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_read_batch_size": null, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "materialize_data": false, "materialize_mapped_data": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "ignore_final_observation": false, "prelearner_class": null, "prelearner_buffer_class": null, "prelearner_buffer_kwargs": {}, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_remaining_data": false, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": 1, "evaluation_duration": 20, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_auto_duration_min_env_steps_per_sample": 100, "evaluation_auto_duration_max_env_steps_per_sample": 2000, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 1, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "offline_evaluation_interval": null, "num_offline_eval_runners": 0, "offline_loss_for_module_fn": null, "offline_evaluation_duration": 1, "offline_evaluation_parallel_to_training": false, "offline_evaluation_timeout_s": 120.0, "num_cpus_per_offline_eval_runner": 1, "num_gpus_per_offline_eval_runner": 0, "custom_resources_per_offline_eval_runner": {}, "restart_failed_offline_eval_runners": true, "ignore_offline_eval_runner_failures": false, "max_num_offline_eval_runner_restarts": 1000, "offline_eval_runner_restore_timeout_s": 1800.0, "max_requests_in_flight_per_offline_eval_runner": 1, "validate_offline_eval_runners_after_construction": true, "offline_eval_runner_health_probe_timeout_s": 30.0, "offline_eval_rl_module_inference_only": false, "broadcast_offline_eval_runner_states": false, "offline_eval_batch_size_per_runner": 256, "dataset_num_iters_per_eval_runner": 1, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "log_gradients": false, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 6, "restart_failed_env_runners": true, "ignore_env_runner_failures": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30.0, "env_runner_restore_timeout_s": 1800.0, "_model_config": {}, "_rl_module_spec": "MultiRLModuleSpec(multi_rl_module_class=<class 'ray.rllib.core.rl_module.multi_rl_module.MultiRLModule'>, observation_space=None, action_space=None, inference_only=False, model_config=None, rl_module_specs={'default_policy': RLModuleSpec(module_class=<class 'source.intrinsic_attention_ppo.rl_modules.DifferentiablePPOModule.DifferentiablePPOModule'>, observation_space=None, action_space=None, inference_only=False, learner_only=False, model_config={'vf_share_layers': True, 'embedding_dim': 62, 'max_seq_len': 6, 'policy_head_hidden_sizes': [32], 'value_head_hidden_sizes': [101], 'embedding_hidden_sizes': [121]}, catalog_class=None, load_state_path=None, model_config_dict=None), 'intrinsic_reward_module': RLModuleSpec(module_class=<class 'source.intrinsic_attention_ppo.rl_modules.IntrinsicAttentionModule.IntrinsicAttentionModule'>, observation_space=None, action_space=None, inference_only=False, learner_only=True, model_config={'intrinsic_reward_network': {'encoder_hidden_sizes': [], 'encoding_dim': 1, 'num_heads': 1, 'head_hidden_sizes': None, 'layers': [{'type': 'attention'}]}, 'extrinsic_value_hidden_layers': [127, 60], 'vf_share_layers': True, 'max_seq_len': 6}, catalog_class=None, load_state_path=None, model_config_dict=None)}, load_state_path=None, modules_to_load=None, module_specs={'default_policy': RLModuleSpec(module_class=<class 'source.intrinsic_attention_ppo.rl_modules.DifferentiablePPOModule.DifferentiablePPOModule'>, observation_space=None, action_space=None, inference_only=False, learner_only=False, model_config={'vf_share_layers': True, 'embedding_dim': 62, 'max_seq_len': 6, 'policy_head_hidden_sizes': [32], 'value_head_hidden_sizes': [101], 'embedding_hidden_sizes': [121]}, catalog_class=None, load_state_path=None, model_config_dict=None), 'intrinsic_reward_module': RLModuleSpec(module_class=<class 'source.intrinsic_attention_ppo.rl_modules.IntrinsicAttentionModule.IntrinsicAttentionModule'>, observation_space=None, action_space=None, inference_only=False, learner_only=True, model_config={'intrinsic_reward_network': {'encoder_hidden_sizes': [], 'encoding_dim': 1, 'num_heads': 1, 'head_hidden_sizes': None, 'layers': [{'type': 'attention'}]}, 'extrinsic_value_hidden_layers': [127, 60], 'vf_share_layers': True, 'max_seq_len': 6}, catalog_class=None, load_state_path=None, model_config_dict=None)})", "algorithm_config_overrides_per_module": {"intrinsic_reward_module": {"lr": 0.0002715581955}}, "_per_module_overrides": {}, "_validate_config": true, "_use_msgpack_checkpoints": false, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "env_task_fn": -1, "enable_connectors": -1, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.161583927863, "kl_target": 0.0201019014258, "vf_loss_coeff": 0.7790510010087, "entropy_coeff": 0.0015431216992, "clip_param": 0.2459212356676, "vf_clip_param": 0.3769744131561, "entropy_coeff_schedule": null, "lr_schedule": null, "sgd_minibatch_size": -1, "vf_share_layers": -1, "differentiable_learner_configs": ["DifferentiableLearnerConfig(learner_class=<class 'source.intrinsic_attention_ppo.learners.IntrinsicAttentionPPOLearner.IntrinsicAttentionPPOLearner'>, learner_connector=None, add_default_connectors_to_learner_pipeline=True, is_multi_agent=False, policies_to_update=['default_policy'], lr=0.0060984166342, num_total_minibatches=0, num_epochs=1, minibatch_size=1000, shuffle_batch_per_epoch=True)"], "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9485408017724, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.callbacks.callbacks.RLlibCallback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 199.66416215896606, "iterations_since_restore": 19, "perf": {"cpu_util_percent": 37.9, "ram_util_percent": 82.46153846153847}}
{"timers": {"training_iteration": 10.521045804975353, "restore_env_runners": 9.748080792154927e-06, "training_step": 10.52079486587012, "env_runner_sampling_timer": 1.7295479699012943, "learner_update_timer": 8.590523503463322, "synch_weights": 0.0017890972642152863, "restore_eval_env_runners": 7.182871885993828e-05, "evaluation_iteration": 0.14027112415515605, "synch_eval_env_connectors": 0.00021236632748476933, "synch_env_connectors": 5.55077259999076e-06}, "env_runners": {"episode_return_max": 10.5, "module_to_env_connector": {"timers": {"connectors": {"tensor_to_numpy": 1.54199398848088e-05, "normalize_and_clip_actions": 8.242529775877549e-06, "un_batch_to_individual_items": 6.7367708347226744e-06, "listify_data_for_vector_env": 1.0733705632112737e-05, "get_actions": 3.9889931606073836e-05, "remove_single_ts_time_rank_from_batch": 1.2154901617427378e-05}}, "connector_pipeline_timer": 0.00012027380179252492}, "episode_len_mean": 20.0, "episode_len_max": 20, "num_module_steps_sampled_lifetime": {"default_policy": -11105000.0}, "num_env_steps_sampled_lifetime": -11105000.0, "module_episode_returns_mean": {"default_policy": 3.38}, "env_to_module_sum_episodes_length_out": 10.36823839457432, "episode_return_mean": 3.38, "env_to_module_connector": {"timers": {"connectors": {"add_time_dim_to_batch_and_zero_pad": 7.255447639674758e-06, "add_observations_from_episodes_to_batch": 2.8992707301344307e-06, "add_states_from_episodes_to_batch": 2.815886765092611e-06, "numpy_to_tensor": 1.3096538274757998e-05, "batch_individual_items": 1.2680139062023675e-05}}, "connector_pipeline_timer": 6.11730398795613e-05}, "agent_episode_returns_mean": {"default_agent": 3.38}, "env_step_timer": 1.4174196524252257e-05, "sample": 0.005776636696366426, "num_episodes": 250.0, "num_agent_steps_sampled_lifetime": {"default_agent": -11105000.0}, "num_episodes_lifetime": -555250.0, "env_to_module_sum_episodes_length_in": 10.36823839457432, "num_agent_steps_sampled": {"default_agent": 5000.0}, "num_env_steps_sampled": 5000.0, "num_module_steps_sampled": {"default_policy": 5000.0}, "episode_return_min": -9.5, "episode_duration_sec_mean": 0.005385089018847794, "weights_seq_no": 19.0, "time_between_sampling": 0.03308980537263928, "env_reset_timer": 4.377170684147766e-05, "episode_len_min": 20, "rlmodule_inference_timer": 3.223546545964449e-05, "num_env_steps_sampled_lifetime_throughput": 3176.0607670067425}, "__all_modules__": {"learner_connector_sum_episodes_length_in": 5000.0, "learner_connector": {"connector_pipeline_timer": 0.15934250779746567, "timers": {"connectors": {"add_one_ts_to_episodes_and_truncate": 0.009170590649159401, "add_observations_from_episodes_to_batch": 0.0008476721721473483, "add_columns_from_episodes_to_train_batch": 0.04203478079981602, "add_time_dim_to_batch_and_zero_pad": 0.09297828549373409, "add_states_from_episodes_to_batch": 0.0037972438371576835, "batch_individual_items": 0.01028930532723256, "numpy_to_tensor": 7.342143119761925e-05}}}, "learner_connector_sum_episodes_length_out": 5250.0}, "learners": {"__all_modules__": {"num_non_trainable_parameters": 0, "num_trainable_parameters": 24861, "num_module_steps_trained_lifetime": 239400, "num_env_steps_trained": 36000, "num_module_steps_trained": 11970, "num_env_steps_trained_lifetime": 720000, "num_env_steps_trained_lifetime_throughput": 4315.576160487648, "num_module_steps_trained_throughput": 19205259.52245777, "num_module_steps_trained_lifetime_throughput": 13407173.643647835}, "default_policy": {"vf_explained_var": 0.00040036439895629883, "vf_loss_unclipped": 44.551334381103516, "use_intrinsic_rewards": 0.0, "weights_seq_no": 20.0, "total_loss": 0.2481665313243866, "num_trainable_parameters": 16595, "curr_entropy_coeff": 0.0015431216992, "num_module_steps_trained_lifetime": 119700, "vf_loss": 0.32051417231559753, "diff_num_grad_updates_vs_sampler_policy": 1.0, "curr_kl_coeff": 1.5409844422720198e-07, "num_module_steps_trained": 5985, "mean_kl_loss": 2.4305556507897563e-05, "module_train_batch_size_mean": 997.9437895346426, "policy_loss": -0.0004992656176909804, "entropy": 0.6681957840919495, "num_module_steps_trained_lifetime_throughput": 716.9554925352683}, "intrinsic_reward_module": {"num_module_steps_trained": 5985, "diff_num_grad_updates_vs_sampler_policy": 1.0, "gradients_default_optimizer_global_norm": 0.0, "weights_seq_no": 20.0, "module_train_batch_size_mean": 997.9437895346426, "num_trainable_parameters": 8266, "default_optimizer_learning_rate": 0.0002715581955, "curr_entropy_coeff": 0.0015431216992, "num_module_steps_trained_lifetime": 119700, "total_loss": 0.0, "num_module_steps_trained_lifetime_throughput": 716.9607947718401}, "differentiable_learners": {"intrinsic_attention_ppo_learner": {"default_policy": {"vf_loss_unclipped": 44.43768310546875, "num_module_steps_trained_lifetime": 718200, "total_loss": 0.24821223318576813, "vf_loss": 0.3205438256263733, "mean_kl_loss": 2.231977487099357e-05, "diff_num_grad_updates_vs_sampler_policy": 101.0, "policy_loss": -0.00048018910456448793, "num_module_steps_trained": 35910, "vf_explained_var": 0.0023332834243774414, "use_intrinsic_rewards": 1.0, "weights_seq_no": 120.0, "module_train_batch_size_mean": 997.4935477577241, "entropy": 0.6682600378990173}, "__all_modules__": {"num_module_steps_trained_lifetime": 1436400, "num_env_steps_trained_lifetime": 4320000, "num_env_steps_trained": 216000, "num_module_steps_trained": 71820, "num_env_steps_trained_lifetime_throughput": 46197.731404178776}, "intrinsic_reward_module": {"num_module_steps_trained": 35910, "weights_seq_no": 120.0, "module_train_batch_size_mean": 997.4935477577241, "total_loss": 0.0, "num_module_steps_trained_lifetime": 718200, "diff_num_grad_updates_vs_sampler_policy": 101.0}}}, "IntrinsicAttentionMask": [[[0.16652241349220276, 0.16616517305374146, 0.16724000871181488, 0.16629046201705933, 0.16736610233783722, 0.16641584038734436], [0.16650092601776123, 0.16609087586402893, 0.16732503473758698, 0.16623467206954956, 0.16746990382671356, 0.16637858748435974], [0.16656532883644104, 0.16631396114826202, 0.16706979274749756, 0.16640214622020721, 0.1671583652496338, 0.1664903610944748], [0.16650845110416412, 0.16611693799495697, 0.1672951877117157, 0.16625423729419708, 0.1674334555864334, 0.16639165580272675], [0.16657285392284393, 0.16634005308151245, 0.16703996062278748, 0.16642172634601593, 0.1671219766139984, 0.1665034294128418], [0.1665160059928894, 0.1661430299282074, 0.16726535558700562, 0.166273832321167, 0.16739703714847565, 0.16640473902225494]], [[0.16652096807956696, 0.1661594808101654, 0.16724713146686554, 0.16671156883239746, 0.16694772243499756, 0.1664131134748459], [0.1664995700120926, 0.16608525812625885, 0.1673322468996048, 0.16671808063983917, 0.16698886454105377, 0.16637594997882843], [0.1665637344121933, 0.16630811989307404, 0.16707676649093628, 0.16669847071170807, 0.16686531901359558, 0.16648750007152557], [0.1665322184562683, 0.16619855165481567, 0.16720233857631683, 0.16670814156532288, 0.1669260710477829, 0.1664326936006546], [0.16654613614082336, 0.1662469059228897, 0.16714692115783691, 0.16670389473438263, 0.16689926385879517, 0.1664568930864334], [0.166514590382576, 0.16613735258579254, 0.16727250814437866, 0.16671352088451385, 0.1669599860906601, 0.16640204191207886]], [[0.16734902560710907, 0.1660410761833191, 0.16685160994529724, 0.16613560914993286, 0.16694660484790802, 0.16667604446411133], [0.16799820959568024, 0.16544824838638306, 0.16702620685100555, 0.16563192009925842, 0.1672116369009018, 0.16668380796909332], [0.16759514808654785, 0.1658160388469696, 0.16691794991493225, 0.16594447195529938, 0.16704723238945007, 0.16667911410331726], [0.1679510623216629, 0.16549120843410492, 0.16701357066631317, 0.16566845774650574, 0.16719242930412292, 0.16668327152729034], [0.1675480753183365, 0.16585905849933624, 0.1669052690267563, 0.16598102450370789, 0.16702800989151, 0.1666785478591919], [0.1676822453737259, 0.16573651134967804, 0.16694138944149017, 0.16587691009044647, 0.1670828014612198, 0.16668017208576202]], [[0.16693435609340668, 0.1662067174911499, 0.16657708585262299, 0.1666252464056015, 0.16680416464805603, 0.16685238480567932], [0.16707150638103485, 0.1659715175628662, 0.16653108596801758, 0.1666039228439331, 0.166874498128891, 0.16694746911525726], [0.1670016348361969, 0.16609133780002594, 0.1665545403957367, 0.1666148155927658, 0.16683867573738098, 0.16689904034137726], [0.16699254512786865, 0.16610689461231232, 0.16655758023262024, 0.16661621630191803, 0.1668340116739273, 0.16689273715019226], [0.16695886850357056, 0.16616471111774445, 0.16656889021396637, 0.16662146151065826, 0.16681674122810364, 0.1668693870306015], [0.1669497787952423, 0.16618026793003082, 0.16657191514968872, 0.16662286221981049, 0.16681207716464996, 0.1668630838394165]], [[0.16652262210845947, 0.16616538166999817, 0.1672402173280716, 0.16629067063331604, 0.16677382588386536, 0.16700726747512817], [0.1665012091398239, 0.1660911589860916, 0.16732531785964966, 0.16623495519161224, 0.16678963601589203, 0.16705773770809174], [0.1665654480457306, 0.16631409525871277, 0.1670699119567871, 0.16640226542949677, 0.16674211621284485, 0.1669062227010727], [0.1665087193250656, 0.16611719131469727, 0.167295441031456, 0.16625449061393738, 0.16678409278392792, 0.16704002022743225], [0.16653764247894287, 0.16621750593185425, 0.16718050837516785, 0.1663297861814499, 0.16676270961761475, 0.1669718623161316], [0.16655157506465912, 0.16626587510108948, 0.16712510585784912, 0.1663661003112793, 0.1667524129152298, 0.16693897545337677]], [[0.1665675938129425, 0.16632169485092163, 0.16706104576587677, 0.16710436344146729, 0.1664511114358902, 0.16649426519870758], [0.16654616594314575, 0.1662473827600479, 0.16714604198932648, 0.16719871759414673, 0.1664046049118042, 0.16645705699920654], [0.16661038994789124, 0.1664704829454422, 0.16689087450504303, 0.16691547632217407, 0.1665441244840622, 0.16656868159770966], [0.1666141301393509, 0.16648352146148682, 0.166875958442688, 0.1668989211320877, 0.16655226051807404, 0.16657517850399017], [0.1665574312210083, 0.16628648340702057, 0.16710127890110016, 0.16714902222156525, 0.1664290726184845, 0.16647662222385406], [0.16656120121479034, 0.16629953682422638, 0.1670863777399063, 0.16713248193264008, 0.16643723845481873, 0.16648316383361816]]]}, "num_training_step_calls_per_iteration": 1, "evaluation": {"env_runners": {"agent_episode_returns_mean": {"default_agent": 0.05}, "num_agent_steps_sampled": {"default_agent": 400}, "num_agent_steps_sampled_lifetime": {"default_agent": 8000}, "episode_return_min": -13.5, "module_to_env_connector": {"timers": {"connectors": {"remove_single_ts_time_rank_from_batch": 1.198280879811344e-05, "tensor_to_numpy": 1.5851840001651856e-05, "normalize_and_clip_actions": 8.034676362220457e-06, "listify_data_for_vector_env": 1.0572043056869666e-05, "get_actions": 3.9015914305145136e-05, "un_batch_to_individual_items": 6.6227010757011806e-06}}, "connector_pipeline_timer": 0.00011888039043205957}, "rlmodule_inference_timer": 3.234451671376509e-05, "env_step_timer": 1.4464110739005355e-05, "num_episodes_lifetime": 400, "env_to_module_sum_episodes_length_in": 10.368238394574323, "num_env_steps_sampled": 400, "env_to_module_connector": {"timers": {"connectors": {"add_observations_from_episodes_to_batch": 2.790589192443659e-06, "add_time_dim_to_batch_and_zero_pad": 7.018473837872151e-06, "batch_individual_items": 1.3038742204598687e-05, "numpy_to_tensor": 1.2537867292640324e-05, "add_states_from_episodes_to_batch": 2.722839259337425e-06}}, "connector_pipeline_timer": 6.04964107888172e-05}, "num_module_steps_sampled": {"default_policy": 400}, "env_reset_timer": 0.000610494977548934, "num_module_steps_sampled_lifetime": {"default_policy": 8000}, "env_to_module_sum_episodes_length_out": 10.368238394574323, "module_episode_returns_mean": {"default_policy": 0.05}, "episode_return_mean": 0.05, "num_episodes": 20, "episode_len_mean": 20.0, "episode_return_max": 14.5, "num_env_steps_sampled_lifetime": 100400, "sample": 0.12872603388939927, "episode_duration_sec_mean": 0.005354283396154642, "weights_seq_no": 20.0, "episode_len_min": 20, "episode_len_max": 20, "time_between_sampling": 9.957052343873462}, "num_healthy_workers": 1, "actor_manager_num_outstanding_async_reqs": 0, "num_remote_worker_restarts": 0}, "num_env_steps_sampled_lifetime": -11105000.0, "fault_tolerance": {"num_healthy_workers": 0, "num_remote_worker_restarts": 0}, "env_runner_group": {"actor_manager_num_outstanding_async_reqs": 0}, "done": true, "training_iteration": 20, "trial_id": "b1df4_00000", "date": "2025-08-11_18-04-09", "timestamp": 1754928249, "time_this_iter_s": 10.186733961105347, "time_total_s": 209.8508961200714, "pid": 10074, "hostname": "Mac", "node_ip": "127.0.0.1", "config": {"exploration_config": {}, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 2, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "env": "Umbrella", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": false, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 0, "create_local_env_runner": true, "num_envs_per_env_runner": 1, "gym_env_vectorize_mode": "SYNC", "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "episodes_to_numpy": true, "max_requests_in_flight_per_env_runner": 1, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "merge_env_runner_states": "training_only", "broadcast_env_runner_states": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "complete_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "sampler_perf_stats_ema_coef": null, "_is_online": true, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": "auto", "num_aggregator_actors_per_learner": 0, "max_requests_in_flight_per_aggregator_actor": 3, "local_gpu_idx": 0, "max_requests_in_flight_per_learner": 3, "gamma": 1, "lr": 0.0002715581955, "grad_clip": 0.5, "grad_clip_by": "global_norm", "_train_batch_size_per_learner": 5000, "train_batch_size": 4000, "num_epochs": 1, "minibatch_size": 1000, "shuffle_batch_per_epoch": true, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "log_std_clip_param": 20.0, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "_disable_preprocessor_api": false, "_disable_action_flattening": false}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {"intrinsic_reward_coeff": 0.2795015916508}, "optimizer": {}, "_learner_class": "<class 'source.intrinsic_attention_ppo.learners.IntrinsicAttentionMetaLearner.IntrinsicAttentionMetaLearner'>", "callbacks_on_algorithm_init": null, "callbacks_on_env_runners_recreated": null, "callbacks_on_offline_eval_runners_recreated": null, "callbacks_on_checkpoint_loaded": null, "callbacks_on_environment_created": null, "callbacks_on_episode_created": null, "callbacks_on_episode_start": null, "callbacks_on_episode_step": null, "callbacks_on_episode_end": null, "callbacks_on_evaluate_start": null, "callbacks_on_evaluate_end": null, "callbacks_on_evaluate_offline_start": null, "callbacks_on_evaluate_offline_end": null, "callbacks_on_sample_end": null, "callbacks_on_train_result": null, "explore": true, "enable_rl_module_and_learner": true, "enable_env_runner_and_connector_v2": true, "_prior_exploration_config": {"type": "StochasticSampling"}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x3855fd760>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "offline_data_class": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_read_batch_size": null, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "materialize_data": false, "materialize_mapped_data": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "ignore_final_observation": false, "prelearner_class": null, "prelearner_buffer_class": null, "prelearner_buffer_kwargs": {}, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_remaining_data": false, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": 1, "evaluation_duration": 20, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_auto_duration_min_env_steps_per_sample": 100, "evaluation_auto_duration_max_env_steps_per_sample": 2000, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 1, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "offline_evaluation_interval": null, "num_offline_eval_runners": 0, "offline_loss_for_module_fn": null, "offline_evaluation_duration": 1, "offline_evaluation_parallel_to_training": false, "offline_evaluation_timeout_s": 120.0, "num_cpus_per_offline_eval_runner": 1, "num_gpus_per_offline_eval_runner": 0, "custom_resources_per_offline_eval_runner": {}, "restart_failed_offline_eval_runners": true, "ignore_offline_eval_runner_failures": false, "max_num_offline_eval_runner_restarts": 1000, "offline_eval_runner_restore_timeout_s": 1800.0, "max_requests_in_flight_per_offline_eval_runner": 1, "validate_offline_eval_runners_after_construction": true, "offline_eval_runner_health_probe_timeout_s": 30.0, "offline_eval_rl_module_inference_only": false, "broadcast_offline_eval_runner_states": false, "offline_eval_batch_size_per_runner": 256, "dataset_num_iters_per_eval_runner": 1, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "log_gradients": false, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 6, "restart_failed_env_runners": true, "ignore_env_runner_failures": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30.0, "env_runner_restore_timeout_s": 1800.0, "_model_config": {}, "_rl_module_spec": "MultiRLModuleSpec(multi_rl_module_class=<class 'ray.rllib.core.rl_module.multi_rl_module.MultiRLModule'>, observation_space=None, action_space=None, inference_only=False, model_config=None, rl_module_specs={'default_policy': RLModuleSpec(module_class=<class 'source.intrinsic_attention_ppo.rl_modules.DifferentiablePPOModule.DifferentiablePPOModule'>, observation_space=None, action_space=None, inference_only=False, learner_only=False, model_config={'vf_share_layers': True, 'embedding_dim': 62, 'max_seq_len': 6, 'policy_head_hidden_sizes': [32], 'value_head_hidden_sizes': [101], 'embedding_hidden_sizes': [121]}, catalog_class=None, load_state_path=None, model_config_dict=None), 'intrinsic_reward_module': RLModuleSpec(module_class=<class 'source.intrinsic_attention_ppo.rl_modules.IntrinsicAttentionModule.IntrinsicAttentionModule'>, observation_space=None, action_space=None, inference_only=False, learner_only=True, model_config={'intrinsic_reward_network': {'encoder_hidden_sizes': [], 'encoding_dim': 1, 'num_heads': 1, 'head_hidden_sizes': None, 'layers': [{'type': 'attention'}]}, 'extrinsic_value_hidden_layers': [127, 60], 'vf_share_layers': True, 'max_seq_len': 6}, catalog_class=None, load_state_path=None, model_config_dict=None)}, load_state_path=None, modules_to_load=None, module_specs={'default_policy': RLModuleSpec(module_class=<class 'source.intrinsic_attention_ppo.rl_modules.DifferentiablePPOModule.DifferentiablePPOModule'>, observation_space=None, action_space=None, inference_only=False, learner_only=False, model_config={'vf_share_layers': True, 'embedding_dim': 62, 'max_seq_len': 6, 'policy_head_hidden_sizes': [32], 'value_head_hidden_sizes': [101], 'embedding_hidden_sizes': [121]}, catalog_class=None, load_state_path=None, model_config_dict=None), 'intrinsic_reward_module': RLModuleSpec(module_class=<class 'source.intrinsic_attention_ppo.rl_modules.IntrinsicAttentionModule.IntrinsicAttentionModule'>, observation_space=None, action_space=None, inference_only=False, learner_only=True, model_config={'intrinsic_reward_network': {'encoder_hidden_sizes': [], 'encoding_dim': 1, 'num_heads': 1, 'head_hidden_sizes': None, 'layers': [{'type': 'attention'}]}, 'extrinsic_value_hidden_layers': [127, 60], 'vf_share_layers': True, 'max_seq_len': 6}, catalog_class=None, load_state_path=None, model_config_dict=None)})", "algorithm_config_overrides_per_module": {"intrinsic_reward_module": {"lr": 0.0002715581955}}, "_per_module_overrides": {}, "_validate_config": true, "_use_msgpack_checkpoints": false, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "env_task_fn": -1, "enable_connectors": -1, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.161583927863, "kl_target": 0.0201019014258, "vf_loss_coeff": 0.7790510010087, "entropy_coeff": 0.0015431216992, "clip_param": 0.2459212356676, "vf_clip_param": 0.3769744131561, "entropy_coeff_schedule": null, "lr_schedule": null, "sgd_minibatch_size": -1, "vf_share_layers": -1, "differentiable_learner_configs": ["DifferentiableLearnerConfig(learner_class=<class 'source.intrinsic_attention_ppo.learners.IntrinsicAttentionPPOLearner.IntrinsicAttentionPPOLearner'>, learner_connector=None, add_default_connectors_to_learner_pipeline=True, is_multi_agent=False, policies_to_update=['default_policy'], lr=0.0060984166342, num_total_minibatches=0, num_epochs=1, minibatch_size=1000, shuffle_batch_per_epoch=True)"], "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9485408017724, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.callbacks.callbacks.RLlibCallback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 209.8508961200714, "iterations_since_restore": 20, "perf": {"cpu_util_percent": 41.75333333333334, "ram_util_percent": 82.22666666666667}}
