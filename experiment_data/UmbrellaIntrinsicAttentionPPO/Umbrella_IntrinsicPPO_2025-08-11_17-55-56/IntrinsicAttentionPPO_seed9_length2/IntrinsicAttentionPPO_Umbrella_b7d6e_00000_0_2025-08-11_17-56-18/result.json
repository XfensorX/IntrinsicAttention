{"timers": {"training_iteration": 10.366216582944617, "restore_env_runners": 6.762496195733547e-05, "training_step": 10.365877875010483, "env_runner_sampling_timer": 1.7600402920506895, "learner_update_timer": 8.384092250023969, "synch_weights": 0.0017702090553939342}, "env_runners": {"env_to_module_connector": {"timers": {"connectors": {"numpy_to_tensor": 1.4542423508718865e-05, "add_time_dim_to_batch_and_zero_pad": 8.351757207263405e-06, "batch_individual_items": 1.3804546056631144e-05, "add_observations_from_episodes_to_batch": 3.2955040968484188e-06, "add_states_from_episodes_to_batch": 3.0570337514422565e-06}}, "connector_pipeline_timer": 6.83323158646027e-05}, "module_to_env_connector": {"timers": {"connectors": {"tensor_to_numpy": 1.626334490577863e-05, "un_batch_to_individual_items": 7.187035990523504e-06, "listify_data_for_vector_env": 1.1167412919026997e-05, "get_actions": 4.966952841336349e-05, "remove_single_ts_time_rank_from_batch": 1.2807636991682647e-05, "normalize_and_clip_actions": 1.1117814422977724e-05}}, "connector_pipeline_timer": 0.0001364710501516419}, "module_episode_returns_mean": {"default_policy": 4.019999999999998}, "episode_len_min": 20, "env_reset_timer": 0.0005422498956805617, "agent_episode_returns_mean": {"default_agent": 4.019999999999998}, "time_between_sampling": 0.0007567647178648217, "env_to_module_sum_episodes_length_out": 10.191744832559449, "num_module_steps_sampled": {"default_policy": 5000.0}, "env_step_timer": 1.629895834696822e-05, "weights_seq_no": 0.0, "num_env_steps_sampled_lifetime": 627500.0, "num_agent_steps_sampled": {"default_agent": 5000.0}, "num_episodes_lifetime": 31375.0, "episode_len_mean": 20.0, "episode_duration_sec_mean": 0.00561650560423732, "episode_return_max": 14.5, "episode_len_max": 20, "num_module_steps_sampled_lifetime": {"default_policy": 627500.0}, "episode_return_min": -5.5, "rlmodule_inference_timer": 3.834893201363651e-05, "episode_return_mean": 4.019999999999998, "env_to_module_sum_episodes_length_in": 10.191744832559449, "num_agent_steps_sampled_lifetime": {"default_agent": 627500.0}, "num_episodes": 250.0, "sample": 0.0075872950152149204, "num_env_steps_sampled": 5000.0, "num_env_steps_sampled_lifetime_throughput": 2845.2767057557157}, "__all_modules__": {"learner_connector_sum_episodes_length_in": 5000, "learner_connector": {"connector_pipeline_timer": 0.1811595840845257, "timers": {"connectors": {"add_one_ts_to_episodes_and_truncate": 0.009569291025400162, "add_observations_from_episodes_to_batch": 0.00084958306979388, "add_columns_from_episodes_to_train_batch": 0.04260033299215138, "add_time_dim_to_batch_and_zero_pad": 0.11008650006260723, "add_states_from_episodes_to_batch": 0.003928874968551099, "batch_individual_items": 0.01384533301461488, "numpy_to_tensor": 8.504197467118502e-05}}}, "learner_connector_sum_episodes_length_out": 5250}, "learners": {"default_policy": {"num_module_steps_trained_lifetime": 5994, "policy_loss": -0.00033500141580589116, "diff_num_grad_updates_vs_sampler_policy": 1.0, "num_trainable_parameters": 16595, "mean_kl_loss": 2.0168188711977564e-05, "curr_entropy_coeff": 0.0015431216992, "total_loss": 0.2049035131931305, "module_train_batch_size_mean": 999.0, "curr_kl_coeff": 0.08079196512699127, "use_intrinsic_rewards": 0.0, "weights_seq_no": 1.0, "vf_loss": 0.2648153007030487, "num_module_steps_trained": 5994, "entropy": 0.6929791569709778, "vf_loss_unclipped": 35.56096267700195, "vf_explained_var": 0.006551563739776611, "num_module_steps_trained_lifetime_throughput": 714.5964144682316}, "intrinsic_reward_module": {"diff_num_grad_updates_vs_sampler_policy": 1.0, "gradients_default_optimizer_global_norm": 0.0, "num_trainable_parameters": 8266, "curr_entropy_coeff": 0.0015431216992, "total_loss": 0.0, "module_train_batch_size_mean": 999.0, "default_optimizer_learning_rate": 0.0002715581955, "weights_seq_no": 1.0, "num_module_steps_trained": 5994, "num_module_steps_trained_lifetime": 5994, "num_module_steps_trained_lifetime_throughput": 714.6079641861842}, "differentiable_learners": {"intrinsic_attention_ppo_learner": {"default_policy": {"policy_loss": -0.00032046815613284707, "diff_num_grad_updates_vs_sampler_policy": 6.0, "mean_kl_loss": 1.8496637494536117e-05, "total_loss": 0.20810244977474213, "module_train_batch_size_mean": 999.0, "use_intrinsic_rewards": 1.0, "weights_seq_no": 6.0, "vf_loss": 0.2689031958580017, "num_module_steps_trained": 35964, "entropy": 0.6929836273193359, "vf_loss_unclipped": 35.785213470458984, "vf_explained_var": 0.002116262912750244, "num_module_steps_trained_lifetime": 35964}, "__all_modules__": {"num_env_steps_trained": 189000, "num_module_steps_trained": 71928, "num_module_steps_trained_lifetime": 71928, "num_env_steps_trained_lifetime": 189000, "num_env_steps_trained_lifetime_throughput": 50321.67986602986}, "intrinsic_reward_module": {"num_module_steps_trained_lifetime": 35964, "diff_num_grad_updates_vs_sampler_policy": 6.0, "total_loss": 0.0, "module_train_batch_size_mean": 999.0, "weights_seq_no": 6.0, "num_module_steps_trained": 35964}}}, "__all_modules__": {"num_trainable_parameters": 24861, "num_env_steps_trained": 31500, "num_module_steps_trained": 11988, "num_non_trainable_parameters": 0, "num_module_steps_trained_lifetime": 11988, "num_env_steps_trained_lifetime": 31500, "num_env_steps_trained_lifetime_throughput": 3755.534978851166, "num_module_steps_trained_throughput": 26997763.828059983, "num_module_steps_trained_lifetime_throughput": 10937355.299711633}, "IntrinsicAttentionMask": [[[0.3347730338573456, 0.3330914378166199, 0.33213552832603455], [0.3339039087295532, 0.33323782682418823, 0.33285826444625854], [0.33340832591056824, 0.3333207964897156, 0.3332708477973938]], [[0.33399343490600586, 0.3360387682914734, 0.329967737197876], [0.33407992124557495, 0.3363988995552063, 0.32952114939689636], [0.33382076025009155, 0.33532363176345825, 0.3308556079864502]], [[0.33417025208473206, 0.3329436480998993, 0.3328860402107239], [0.3339449167251587, 0.33304861187934875, 0.33300650119781494], [0.33393430709838867, 0.3330535590648651, 0.3330121636390686]], [[0.3334607481956482, 0.3330641984939575, 0.3334750533103943], [0.33273741602897644, 0.3345918655395508, 0.33267074823379517], [0.33348679542541504, 0.3330092132091522, 0.3335040211677551]], [[0.33282479643821716, 0.333607941865921, 0.33356723189353943], [0.3326491713523865, 0.33370280265808105, 0.3336479961872101], [0.3326583206653595, 0.3336979150772095, 0.3336438238620758]], [[0.31302201747894287, 0.3772366940975189, 0.3097412586212158], [0.23724475502967834, 0.5361856818199158, 0.2265695333480835], [0.31699618697166443, 0.3687005937099457, 0.31430327892303467]]]}, "num_training_step_calls_per_iteration": 1, "num_env_steps_sampled_lifetime": 627500.0, "evaluation": {"env_runners": {"env_to_module_connector": {"timers": {"connectors": {"add_observations_from_episodes_to_batch": 3.379753479664602e-06, "numpy_to_tensor": 1.2861167783879327e-05, "batch_individual_items": 1.27399760891673e-05, "add_states_from_episodes_to_batch": 2.8632411470584726e-06, "add_time_dim_to_batch_and_zero_pad": 7.998663165678109e-06}}, "connector_pipeline_timer": 6.468197726315416e-05}, "num_module_steps_sampled_lifetime": {"default_policy": 400}, "num_env_steps_sampled_lifetime": 5400, "weights_seq_no": 1.0, "module_to_env_connector": {"timers": {"connectors": {"get_actions": 4.573697213322598e-05, "un_batch_to_individual_items": 6.5672464153042855e-06, "listify_data_for_vector_env": 1.0429145915170886e-05, "remove_single_ts_time_rank_from_batch": 1.2713392978995318e-05, "normalize_and_clip_actions": 9.289473794687859e-06, "tensor_to_numpy": 1.7132422351854907e-05}}, "connector_pipeline_timer": 0.00012851801266726838}, "episode_return_min": -13.5, "rlmodule_inference_timer": 3.792376708315101e-05, "num_episodes": 20, "num_agent_steps_sampled": {"default_agent": 400}, "num_env_steps_sampled": 400, "episode_len_max": 20, "env_to_module_sum_episodes_length_in": 10.216013141322508, "agent_episode_returns_mean": {"default_agent": 1.7}, "env_reset_timer": 0.0005608330247923732, "episode_len_min": 20, "env_to_module_sum_episodes_length_out": 10.216013141322508, "env_step_timer": 1.5187331288467905e-05, "episode_len_mean": 20.0, "episode_duration_sec_mean": 0.005390408309176564, "num_module_steps_sampled": {"default_policy": 400}, "module_episode_returns_mean": {"default_policy": 1.7}, "sample": 0.11882312502712011, "num_agent_steps_sampled_lifetime": {"default_agent": 400}, "num_episodes_lifetime": 20, "episode_return_max": 12.5, "episode_return_mean": 1.7}, "num_healthy_workers": 1, "actor_manager_num_outstanding_async_reqs": 0, "num_remote_worker_restarts": 0}, "fault_tolerance": {"num_healthy_workers": 0, "num_remote_worker_restarts": 0}, "env_runner_group": {"actor_manager_num_outstanding_async_reqs": 0}, "done": false, "training_iteration": 1, "trial_id": "b7d6e_00000", "date": "2025-08-11_18-08-18", "timestamp": 1754928498, "time_this_iter_s": 10.499353170394897, "time_total_s": 10.499353170394897, "pid": 10343, "hostname": "Mac", "node_ip": "127.0.0.1", "config": {"exploration_config": {}, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 2, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "env": "Umbrella", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": false, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 0, "create_local_env_runner": true, "num_envs_per_env_runner": 1, "gym_env_vectorize_mode": "SYNC", "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "episodes_to_numpy": true, "max_requests_in_flight_per_env_runner": 1, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "merge_env_runner_states": "training_only", "broadcast_env_runner_states": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "complete_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "sampler_perf_stats_ema_coef": null, "_is_online": true, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": "auto", "num_aggregator_actors_per_learner": 0, "max_requests_in_flight_per_aggregator_actor": 3, "local_gpu_idx": 0, "max_requests_in_flight_per_learner": 3, "gamma": 1, "lr": 0.0002715581955, "grad_clip": 0.5, "grad_clip_by": "global_norm", "_train_batch_size_per_learner": 5000, "train_batch_size": 4000, "num_epochs": 1, "minibatch_size": 1000, "shuffle_batch_per_epoch": true, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "log_std_clip_param": 20.0, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "_disable_preprocessor_api": false, "_disable_action_flattening": false}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {"intrinsic_reward_coeff": 0.2795015916508}, "optimizer": {}, "_learner_class": "<class 'source.intrinsic_attention_ppo.learners.IntrinsicAttentionMetaLearner.IntrinsicAttentionMetaLearner'>", "callbacks_on_algorithm_init": null, "callbacks_on_env_runners_recreated": null, "callbacks_on_offline_eval_runners_recreated": null, "callbacks_on_checkpoint_loaded": null, "callbacks_on_environment_created": null, "callbacks_on_episode_created": null, "callbacks_on_episode_start": null, "callbacks_on_episode_step": null, "callbacks_on_episode_end": null, "callbacks_on_evaluate_start": null, "callbacks_on_evaluate_end": null, "callbacks_on_evaluate_offline_start": null, "callbacks_on_evaluate_offline_end": null, "callbacks_on_sample_end": null, "callbacks_on_train_result": null, "explore": true, "enable_rl_module_and_learner": true, "enable_env_runner_and_connector_v2": true, "_prior_exploration_config": {"type": "StochasticSampling"}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x1616f98a0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "offline_data_class": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_read_batch_size": null, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "materialize_data": false, "materialize_mapped_data": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "ignore_final_observation": false, "prelearner_class": null, "prelearner_buffer_class": null, "prelearner_buffer_kwargs": {}, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_remaining_data": false, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": 1, "evaluation_duration": 20, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_auto_duration_min_env_steps_per_sample": 100, "evaluation_auto_duration_max_env_steps_per_sample": 2000, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 1, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "offline_evaluation_interval": null, "num_offline_eval_runners": 0, "offline_loss_for_module_fn": null, "offline_evaluation_duration": 1, "offline_evaluation_parallel_to_training": false, "offline_evaluation_timeout_s": 120.0, "num_cpus_per_offline_eval_runner": 1, "num_gpus_per_offline_eval_runner": 0, "custom_resources_per_offline_eval_runner": {}, "restart_failed_offline_eval_runners": true, "ignore_offline_eval_runner_failures": false, "max_num_offline_eval_runner_restarts": 1000, "offline_eval_runner_restore_timeout_s": 1800.0, "max_requests_in_flight_per_offline_eval_runner": 1, "validate_offline_eval_runners_after_construction": true, "offline_eval_runner_health_probe_timeout_s": 30.0, "offline_eval_rl_module_inference_only": false, "broadcast_offline_eval_runner_states": false, "offline_eval_batch_size_per_runner": 256, "dataset_num_iters_per_eval_runner": 1, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "log_gradients": false, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 9, "restart_failed_env_runners": true, "ignore_env_runner_failures": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30.0, "env_runner_restore_timeout_s": 1800.0, "_model_config": {}, "_rl_module_spec": "MultiRLModuleSpec(multi_rl_module_class=<class 'ray.rllib.core.rl_module.multi_rl_module.MultiRLModule'>, observation_space=None, action_space=None, inference_only=False, model_config=None, rl_module_specs={'default_policy': RLModuleSpec(module_class=<class 'source.intrinsic_attention_ppo.rl_modules.DifferentiablePPOModule.DifferentiablePPOModule'>, observation_space=None, action_space=None, inference_only=False, learner_only=False, model_config={'vf_share_layers': True, 'embedding_dim': 62, 'max_seq_len': 3, 'policy_head_hidden_sizes': [32], 'value_head_hidden_sizes': [101], 'embedding_hidden_sizes': [121]}, catalog_class=None, load_state_path=None, model_config_dict=None), 'intrinsic_reward_module': RLModuleSpec(module_class=<class 'source.intrinsic_attention_ppo.rl_modules.IntrinsicAttentionModule.IntrinsicAttentionModule'>, observation_space=None, action_space=None, inference_only=False, learner_only=True, model_config={'intrinsic_reward_network': {'encoder_hidden_sizes': [], 'encoding_dim': 1, 'num_heads': 1, 'head_hidden_sizes': None, 'layers': [{'type': 'attention'}]}, 'extrinsic_value_hidden_layers': [127, 60], 'vf_share_layers': True, 'max_seq_len': 3}, catalog_class=None, load_state_path=None, model_config_dict=None)}, load_state_path=None, modules_to_load=None, module_specs={'default_policy': RLModuleSpec(module_class=<class 'source.intrinsic_attention_ppo.rl_modules.DifferentiablePPOModule.DifferentiablePPOModule'>, observation_space=None, action_space=None, inference_only=False, learner_only=False, model_config={'vf_share_layers': True, 'embedding_dim': 62, 'max_seq_len': 3, 'policy_head_hidden_sizes': [32], 'value_head_hidden_sizes': [101], 'embedding_hidden_sizes': [121]}, catalog_class=None, load_state_path=None, model_config_dict=None), 'intrinsic_reward_module': RLModuleSpec(module_class=<class 'source.intrinsic_attention_ppo.rl_modules.IntrinsicAttentionModule.IntrinsicAttentionModule'>, observation_space=None, action_space=None, inference_only=False, learner_only=True, model_config={'intrinsic_reward_network': {'encoder_hidden_sizes': [], 'encoding_dim': 1, 'num_heads': 1, 'head_hidden_sizes': None, 'layers': [{'type': 'attention'}]}, 'extrinsic_value_hidden_layers': [127, 60], 'vf_share_layers': True, 'max_seq_len': 3}, catalog_class=None, load_state_path=None, model_config_dict=None)})", "algorithm_config_overrides_per_module": {"intrinsic_reward_module": {"lr": 0.0002715581955}}, "_per_module_overrides": {}, "_validate_config": true, "_use_msgpack_checkpoints": false, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "env_task_fn": -1, "enable_connectors": -1, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.161583927863, "kl_target": 0.0201019014258, "vf_loss_coeff": 0.7790510010087, "entropy_coeff": 0.0015431216992, "clip_param": 0.2459212356676, "vf_clip_param": 0.3769744131561, "entropy_coeff_schedule": null, "lr_schedule": null, "sgd_minibatch_size": -1, "vf_share_layers": -1, "differentiable_learner_configs": ["DifferentiableLearnerConfig(learner_class=<class 'source.intrinsic_attention_ppo.learners.IntrinsicAttentionPPOLearner.IntrinsicAttentionPPOLearner'>, learner_connector=None, add_default_connectors_to_learner_pipeline=True, is_multi_agent=False, policies_to_update=['default_policy'], lr=0.0060984166342, num_total_minibatches=0, num_epochs=1, minibatch_size=1000, shuffle_batch_per_epoch=True)"], "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9485408017724, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.callbacks.callbacks.RLlibCallback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 10.499353170394897, "iterations_since_restore": 1, "perf": {"cpu_util_percent": 39.0, "ram_util_percent": 81.41874999999999}}
{"timers": {"training_iteration": 10.373241365035065, "restore_env_runners": 6.702329264953732e-05, "training_step": 10.372903165010502, "env_runner_sampling_timer": 1.7583582024706992, "learner_update_timer": 8.391367623774567, "synch_weights": 0.0017682302941102533, "restore_eval_env_runners": 5.9249927289783955e-05, "evaluation_iteration": 0.13055479200556874, "synch_eval_env_connectors": 0.00018645799718797207, "synch_env_connectors": 4.415982402861118e-06}, "env_runners": {"env_to_module_connector": {"timers": {"connectors": {"numpy_to_tensor": 1.3129754371762261e-05, "add_time_dim_to_batch_and_zero_pad": 7.2438284114025844e-06, "batch_individual_items": 1.283901334074902e-05, "add_observations_from_episodes_to_batch": 2.9449080002557694e-06, "add_states_from_episodes_to_batch": 2.876977315438064e-06}}, "connector_pipeline_timer": 6.200996469474056e-05}, "module_to_env_connector": {"timers": {"connectors": {"tensor_to_numpy": 1.5680294128239487e-05, "un_batch_to_individual_items": 6.776464997243377e-06, "listify_data_for_vector_env": 1.0682757487836054e-05, "get_actions": 4.028053314183963e-05, "remove_single_ts_time_rank_from_batch": 1.2309797766870092e-05, "normalize_and_clip_actions": 8.27819786499127e-06}}, "connector_pipeline_timer": 0.00012149592077488581}, "module_episode_returns_mean": {"default_policy": 4.420000000000002}, "episode_len_min": 20, "env_reset_timer": 8.764144366366849e-05, "agent_episode_returns_mean": {"default_agent": 4.420000000000002}, "time_between_sampling": 0.03307697749236031, "env_to_module_sum_episodes_length_out": 10.36823839457432, "num_module_steps_sampled": {"default_policy": 5000.0}, "env_step_timer": 1.455334765177134e-05, "weights_seq_no": 1.0, "num_env_steps_sampled_lifetime": 10000.0, "num_agent_steps_sampled": {"default_agent": 5000.0}, "num_episodes_lifetime": 500.0, "episode_len_mean": 20.0, "episode_duration_sec_mean": 0.005427658676169813, "episode_return_max": 14.5, "episode_len_max": 20, "num_module_steps_sampled_lifetime": {"default_policy": 10000.0}, "episode_return_min": -5.5, "rlmodule_inference_timer": 3.243841489794565e-05, "episode_return_mean": 4.420000000000002, "env_to_module_sum_episodes_length_in": 10.36823839457432, "num_agent_steps_sampled_lifetime": {"default_agent": 10000.0}, "num_episodes": 250.0, "sample": 0.0060131606374527295, "num_env_steps_sampled": 5000.0, "num_env_steps_sampled_lifetime_throughput": 3133.582683776388}, "__all_modules__": {"learner_connector_sum_episodes_length_in": 5000.0, "learner_connector": {"connector_pipeline_timer": 0.1824861740740016, "timers": {"connectors": {"add_one_ts_to_episodes_and_truncate": 0.009563989785965532, "add_observations_from_episodes_to_batch": 0.0008496743289288134, "add_columns_from_episodes_to_train_batch": 0.0425957838317845, "add_time_dim_to_batch_and_zero_pad": 0.11002477423171513, "add_states_from_episodes_to_batch": 0.003928055809810758, "batch_individual_items": 0.01524494718411006, "numpy_to_tensor": 8.496363530866801e-05}}}, "learner_connector_sum_episodes_length_out": 5250.0}, "learners": {"default_policy": {"num_module_steps_trained_lifetime": 11988, "policy_loss": -0.0005681572365574539, "diff_num_grad_updates_vs_sampler_policy": 1.0, "num_trainable_parameters": 16595, "mean_kl_loss": 5.1674796850420535e-05, "curr_entropy_coeff": 0.0015431216992, "total_loss": 0.20433741807937622, "module_train_batch_size_mean": 999.0, "curr_kl_coeff": 0.040395982563495636, "use_intrinsic_rewards": 0.0, "weights_seq_no": 2.0, "vf_loss": 0.2643863260746002, "num_module_steps_trained": 5994, "entropy": 0.692768394947052, "vf_loss_unclipped": 36.891414642333984, "vf_explained_var": 0.006823718547821045, "num_module_steps_trained_lifetime_throughput": 713.5172668020044}, "intrinsic_reward_module": {"diff_num_grad_updates_vs_sampler_policy": 1.0, "gradients_default_optimizer_global_norm": 0.0, "num_trainable_parameters": 8266, "curr_entropy_coeff": 0.0015431216992, "total_loss": 0.0, "module_train_batch_size_mean": 999.0, "default_optimizer_learning_rate": 0.0002715581955, "weights_seq_no": 2.0, "num_module_steps_trained": 5994, "num_module_steps_trained_lifetime": 11988, "num_module_steps_trained_lifetime_throughput": 713.528646920455}, "differentiable_learners": {"intrinsic_attention_ppo_learner": {"default_policy": {"policy_loss": -0.0005500023253262043, "diff_num_grad_updates_vs_sampler_policy": 11.0, "mean_kl_loss": 4.884647933067754e-05, "total_loss": 0.20657528936862946, "module_train_batch_size_mean": 999.0, "use_intrinsic_rewards": 1.0, "weights_seq_no": 12.0, "vf_loss": 0.2672307789325714, "num_module_steps_trained": 35964, "entropy": 0.6927756071090698, "vf_loss_unclipped": 37.10007095336914, "vf_explained_var": 0.00217515230178833, "num_module_steps_trained_lifetime": 71928}, "__all_modules__": {"num_env_steps_trained": 189000, "num_module_steps_trained": 71928, "num_module_steps_trained_lifetime": 143856, "num_env_steps_trained_lifetime": 378000, "num_env_steps_trained_lifetime_throughput": 50048.95925350677}, "intrinsic_reward_module": {"num_module_steps_trained_lifetime": 71928, "diff_num_grad_updates_vs_sampler_policy": 11.0, "total_loss": 0.0, "module_train_batch_size_mean": 999.0, "weights_seq_no": 12.0, "num_module_steps_trained": 35964}}}, "__all_modules__": {"num_trainable_parameters": 24861, "num_env_steps_trained": 31500, "num_module_steps_trained": 11988, "num_non_trainable_parameters": 0, "num_module_steps_trained_lifetime": 23976, "num_env_steps_trained_lifetime": 63000, "num_env_steps_trained_lifetime_throughput": 3749.8618464560873, "num_module_steps_trained_throughput": 26643742.768461294, "num_module_steps_trained_lifetime_throughput": 10953397.821681248}, "IntrinsicAttentionMask": [[[0.33507829904556274, 0.33248335123062134, 0.3324383795261383], [0.3334524631500244, 0.33327531814575195, 0.333272248506546], [0.3334242105484009, 0.33328908681869507, 0.33328673243522644]], [[0.33470049500465393, 0.3367501497268677, 0.3285493552684784], [0.3348800241947174, 0.33720454573631287, 0.32791540026664734], [0.33415165543556213, 0.335369348526001, 0.33047905564308167]], [[0.33268654346466064, 0.3348510265350342, 0.33246245980262756], [0.33260536193847656, 0.3350413143634796, 0.33235326409339905], [0.33269497752189636, 0.33483123779296875, 0.3324737846851349]], [[0.3324712812900543, 0.3367629647254944, 0.3307656943798065], [0.33201107382774353, 0.33857372403144836, 0.3294152319431305], [0.33265459537506104, 0.33603808283805847, 0.3313073515892029]], [[0.33309921622276306, 0.33305853605270386, 0.3338422179222107], [0.3331034481525421, 0.3330634832382202, 0.33383309841156006], [0.33302247524261475, 0.33296850323677063, 0.334009051322937]], [[0.33949393033981323, 0.32133692502975464, 0.33916914463043213], [0.2525455057621002, 0.49195945262908936, 0.2554950714111328], [0.33809468150138855, 0.3240600824356079, 0.3378451466560364]]]}, "num_training_step_calls_per_iteration": 1, "evaluation": {"env_runners": {"env_to_module_connector": {"timers": {"connectors": {"add_observations_from_episodes_to_batch": 2.8080865394653098e-06, "numpy_to_tensor": 1.1914437696698934e-05, "batch_individual_items": 1.2426422474582591e-05, "add_states_from_episodes_to_batch": 2.75431330327488e-06, "add_time_dim_to_batch_and_zero_pad": 7.220650225974408e-06}}, "connector_pipeline_timer": 5.9390932683130224e-05}, "num_module_steps_sampled_lifetime": {"default_policy": 800}, "num_env_steps_sampled_lifetime": 10400, "weights_seq_no": 2.0, "module_to_env_connector": {"timers": {"connectors": {"get_actions": 3.663642032805036e-05, "un_batch_to_individual_items": 6.396199788990635e-06, "listify_data_for_vector_env": 1.0226820232906064e-05, "remove_single_ts_time_rank_from_batch": 1.1729721618422839e-05, "normalize_and_clip_actions": 7.839951041385464e-06, "tensor_to_numpy": 1.5142803830330286e-05}}, "connector_pipeline_timer": 0.00011421830851635773}, "episode_return_min": -13.5, "rlmodule_inference_timer": 3.125570037244864e-05, "num_episodes": 20, "num_agent_steps_sampled": {"default_agent": 400}, "num_env_steps_sampled": 400, "episode_len_max": 20, "env_to_module_sum_episodes_length_in": 10.366003441359926, "agent_episode_returns_mean": {"default_agent": 2.2}, "env_reset_timer": 0.0005588405346497893, "episode_len_min": 20, "env_to_module_sum_episodes_length_out": 10.366003441359926, "env_step_timer": 1.3770327284542013e-05, "episode_len_mean": 20.0, "episode_duration_sec_mean": 0.005332468790584244, "num_module_steps_sampled": {"default_policy": 400}, "module_episode_returns_mean": {"default_policy": 2.2}, "sample": 0.11879288336611353, "num_agent_steps_sampled_lifetime": {"default_agent": 800}, "num_episodes_lifetime": 40, "episode_return_max": 15.5, "episode_return_mean": 2.2, "time_between_sampling": 11.12376879202202}, "num_healthy_workers": 1, "actor_manager_num_outstanding_async_reqs": 0, "num_remote_worker_restarts": 0}, "num_env_steps_sampled_lifetime": 10000.0, "fault_tolerance": {"num_healthy_workers": 0, "num_remote_worker_restarts": 0}, "env_runner_group": {"actor_manager_num_outstanding_async_reqs": 0}, "done": false, "training_iteration": 2, "trial_id": "b7d6e_00000", "date": "2025-08-11_18-08-30", "timestamp": 1754928510, "time_this_iter_s": 11.196050882339478, "time_total_s": 21.695404052734375, "pid": 10343, "hostname": "Mac", "node_ip": "127.0.0.1", "config": {"exploration_config": {}, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 2, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "env": "Umbrella", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": false, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 0, "create_local_env_runner": true, "num_envs_per_env_runner": 1, "gym_env_vectorize_mode": "SYNC", "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "episodes_to_numpy": true, "max_requests_in_flight_per_env_runner": 1, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "merge_env_runner_states": "training_only", "broadcast_env_runner_states": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "complete_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "sampler_perf_stats_ema_coef": null, "_is_online": true, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": "auto", "num_aggregator_actors_per_learner": 0, "max_requests_in_flight_per_aggregator_actor": 3, "local_gpu_idx": 0, "max_requests_in_flight_per_learner": 3, "gamma": 1, "lr": 0.0002715581955, "grad_clip": 0.5, "grad_clip_by": "global_norm", "_train_batch_size_per_learner": 5000, "train_batch_size": 4000, "num_epochs": 1, "minibatch_size": 1000, "shuffle_batch_per_epoch": true, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "log_std_clip_param": 20.0, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "_disable_preprocessor_api": false, "_disable_action_flattening": false}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {"intrinsic_reward_coeff": 0.2795015916508}, "optimizer": {}, "_learner_class": "<class 'source.intrinsic_attention_ppo.learners.IntrinsicAttentionMetaLearner.IntrinsicAttentionMetaLearner'>", "callbacks_on_algorithm_init": null, "callbacks_on_env_runners_recreated": null, "callbacks_on_offline_eval_runners_recreated": null, "callbacks_on_checkpoint_loaded": null, "callbacks_on_environment_created": null, "callbacks_on_episode_created": null, "callbacks_on_episode_start": null, "callbacks_on_episode_step": null, "callbacks_on_episode_end": null, "callbacks_on_evaluate_start": null, "callbacks_on_evaluate_end": null, "callbacks_on_evaluate_offline_start": null, "callbacks_on_evaluate_offline_end": null, "callbacks_on_sample_end": null, "callbacks_on_train_result": null, "explore": true, "enable_rl_module_and_learner": true, "enable_env_runner_and_connector_v2": true, "_prior_exploration_config": {"type": "StochasticSampling"}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x1616f98a0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "offline_data_class": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_read_batch_size": null, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "materialize_data": false, "materialize_mapped_data": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "ignore_final_observation": false, "prelearner_class": null, "prelearner_buffer_class": null, "prelearner_buffer_kwargs": {}, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_remaining_data": false, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": 1, "evaluation_duration": 20, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_auto_duration_min_env_steps_per_sample": 100, "evaluation_auto_duration_max_env_steps_per_sample": 2000, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 1, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "offline_evaluation_interval": null, "num_offline_eval_runners": 0, "offline_loss_for_module_fn": null, "offline_evaluation_duration": 1, "offline_evaluation_parallel_to_training": false, "offline_evaluation_timeout_s": 120.0, "num_cpus_per_offline_eval_runner": 1, "num_gpus_per_offline_eval_runner": 0, "custom_resources_per_offline_eval_runner": {}, "restart_failed_offline_eval_runners": true, "ignore_offline_eval_runner_failures": false, "max_num_offline_eval_runner_restarts": 1000, "offline_eval_runner_restore_timeout_s": 1800.0, "max_requests_in_flight_per_offline_eval_runner": 1, "validate_offline_eval_runners_after_construction": true, "offline_eval_runner_health_probe_timeout_s": 30.0, "offline_eval_rl_module_inference_only": false, "broadcast_offline_eval_runner_states": false, "offline_eval_batch_size_per_runner": 256, "dataset_num_iters_per_eval_runner": 1, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "log_gradients": false, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 9, "restart_failed_env_runners": true, "ignore_env_runner_failures": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30.0, "env_runner_restore_timeout_s": 1800.0, "_model_config": {}, "_rl_module_spec": "MultiRLModuleSpec(multi_rl_module_class=<class 'ray.rllib.core.rl_module.multi_rl_module.MultiRLModule'>, observation_space=None, action_space=None, inference_only=False, model_config=None, rl_module_specs={'default_policy': RLModuleSpec(module_class=<class 'source.intrinsic_attention_ppo.rl_modules.DifferentiablePPOModule.DifferentiablePPOModule'>, observation_space=None, action_space=None, inference_only=False, learner_only=False, model_config={'vf_share_layers': True, 'embedding_dim': 62, 'max_seq_len': 3, 'policy_head_hidden_sizes': [32], 'value_head_hidden_sizes': [101], 'embedding_hidden_sizes': [121]}, catalog_class=None, load_state_path=None, model_config_dict=None), 'intrinsic_reward_module': RLModuleSpec(module_class=<class 'source.intrinsic_attention_ppo.rl_modules.IntrinsicAttentionModule.IntrinsicAttentionModule'>, observation_space=None, action_space=None, inference_only=False, learner_only=True, model_config={'intrinsic_reward_network': {'encoder_hidden_sizes': [], 'encoding_dim': 1, 'num_heads': 1, 'head_hidden_sizes': None, 'layers': [{'type': 'attention'}]}, 'extrinsic_value_hidden_layers': [127, 60], 'vf_share_layers': True, 'max_seq_len': 3}, catalog_class=None, load_state_path=None, model_config_dict=None)}, load_state_path=None, modules_to_load=None, module_specs={'default_policy': RLModuleSpec(module_class=<class 'source.intrinsic_attention_ppo.rl_modules.DifferentiablePPOModule.DifferentiablePPOModule'>, observation_space=None, action_space=None, inference_only=False, learner_only=False, model_config={'vf_share_layers': True, 'embedding_dim': 62, 'max_seq_len': 3, 'policy_head_hidden_sizes': [32], 'value_head_hidden_sizes': [101], 'embedding_hidden_sizes': [121]}, catalog_class=None, load_state_path=None, model_config_dict=None), 'intrinsic_reward_module': RLModuleSpec(module_class=<class 'source.intrinsic_attention_ppo.rl_modules.IntrinsicAttentionModule.IntrinsicAttentionModule'>, observation_space=None, action_space=None, inference_only=False, learner_only=True, model_config={'intrinsic_reward_network': {'encoder_hidden_sizes': [], 'encoding_dim': 1, 'num_heads': 1, 'head_hidden_sizes': None, 'layers': [{'type': 'attention'}]}, 'extrinsic_value_hidden_layers': [127, 60], 'vf_share_layers': True, 'max_seq_len': 3}, catalog_class=None, load_state_path=None, model_config_dict=None)})", "algorithm_config_overrides_per_module": {"intrinsic_reward_module": {"lr": 0.0002715581955}}, "_per_module_overrides": {}, "_validate_config": true, "_use_msgpack_checkpoints": false, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "env_task_fn": -1, "enable_connectors": -1, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.161583927863, "kl_target": 0.0201019014258, "vf_loss_coeff": 0.7790510010087, "entropy_coeff": 0.0015431216992, "clip_param": 0.2459212356676, "vf_clip_param": 0.3769744131561, "entropy_coeff_schedule": null, "lr_schedule": null, "sgd_minibatch_size": -1, "vf_share_layers": -1, "differentiable_learner_configs": ["DifferentiableLearnerConfig(learner_class=<class 'source.intrinsic_attention_ppo.learners.IntrinsicAttentionPPOLearner.IntrinsicAttentionPPOLearner'>, learner_connector=None, add_default_connectors_to_learner_pipeline=True, is_multi_agent=False, policies_to_update=['default_policy'], lr=0.0060984166342, num_total_minibatches=0, num_epochs=1, minibatch_size=1000, shuffle_batch_per_epoch=True)"], "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9485408017724, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.callbacks.callbacks.RLlibCallback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 21.695404052734375, "iterations_since_restore": 2, "perf": {"cpu_util_percent": 47.16875, "ram_util_percent": 81.4875}}
{"timers": {"training_iteration": 10.388957015974821, "restore_env_runners": 6.642139900941402e-05, "training_step": 10.388619408359997, "env_runner_sampling_timer": 1.7576865846063823, "learner_update_timer": 8.407666876706468, "synch_weights": 0.0017690771601977756, "restore_eval_env_runners": 5.902451812289655e-05, "evaluation_iteration": 0.13049426658544688, "synch_eval_env_connectors": 0.00018629924743436275, "synch_env_connectors": 4.42099291831255e-06}, "env_runners": {"env_to_module_connector": {"timers": {"connectors": {"numpy_to_tensor": 1.410089691184854e-05, "add_time_dim_to_batch_and_zero_pad": 7.741801215827072e-06, "batch_individual_items": 1.3589176444891902e-05, "add_observations_from_episodes_to_batch": 3.0741864535956527e-06, "add_states_from_episodes_to_batch": 2.9789446147540226e-06}}, "connector_pipeline_timer": 6.525352180777138e-05}, "module_to_env_connector": {"timers": {"connectors": {"tensor_to_numpy": 1.6524565634561687e-05, "un_batch_to_individual_items": 7.0826232593169194e-06, "listify_data_for_vector_env": 1.1271748182184834e-05, "get_actions": 4.36480316713498e-05, "remove_single_ts_time_rank_from_batch": 1.2816079964572531e-05, "normalize_and_clip_actions": 8.658484988622715e-06}}, "connector_pipeline_timer": 0.000128648297678169}, "module_episode_returns_mean": {"default_policy": 5.460000000000001}, "episode_len_min": 20, "env_reset_timer": 5.481587971382603e-05, "agent_episode_returns_mean": {"default_agent": 5.460000000000001}, "time_between_sampling": 0.03856641063554363, "env_to_module_sum_episodes_length_out": 10.36823839457432, "num_module_steps_sampled": {"default_policy": 5000.0}, "env_step_timer": 1.54398471883145e-05, "weights_seq_no": 2.0, "num_env_steps_sampled_lifetime": -607500.0, "num_agent_steps_sampled": {"default_agent": 5000.0}, "num_episodes_lifetime": -30375.0, "episode_len_mean": 20.0, "episode_duration_sec_mean": 0.005763984353281556, "episode_return_max": 14.5, "episode_len_max": 20, "num_module_steps_sampled_lifetime": {"default_policy": -607500.0}, "episode_return_min": -5.5, "rlmodule_inference_timer": 3.45767641190483e-05, "episode_return_mean": 5.460000000000001, "env_to_module_sum_episodes_length_in": 10.36823839457432, "num_agent_steps_sampled_lifetime": {"default_agent": -607500.0}, "num_episodes": 250.0, "sample": 0.006104811101961998, "num_env_steps_sampled": 5000.0, "num_env_steps_sampled_lifetime_throughput": 3008.5351951393154}, "__all_modules__": {"learner_connector_sum_episodes_length_in": 5000.0, "learner_connector": {"connector_pipeline_timer": 0.18245143983368764, "timers": {"connectors": {"add_one_ts_to_episodes_and_truncate": 0.00956144363770727, "add_observations_from_episodes_to_batch": 0.0008499604965210892, "add_columns_from_episodes_to_train_batch": 0.04260022308327025, "add_time_dim_to_batch_and_zero_pad": 0.11000925440905848, "add_states_from_episodes_to_batch": 0.003927871501678601, "batch_individual_items": 0.015224477712565566, "numpy_to_tensor": 8.484107899712397e-05}}}, "learner_connector_sum_episodes_length_out": 5250.0}, "learners": {"default_policy": {"num_module_steps_trained_lifetime": 17982, "policy_loss": -0.00027064018649980426, "diff_num_grad_updates_vs_sampler_policy": 1.0, "num_trainable_parameters": 16595, "mean_kl_loss": 2.5161218218272552e-05, "curr_entropy_coeff": 0.0015431216992, "total_loss": 0.20469683408737183, "module_train_batch_size_mean": 999.0, "curr_kl_coeff": 0.020197991281747818, "use_intrinsic_rewards": 0.0, "weights_seq_no": 3.0, "vf_loss": 0.26446953415870667, "num_module_steps_trained": 5994, "entropy": 0.6926069259643555, "vf_loss_unclipped": 41.34327697753906, "vf_explained_var": 0.004577696323394775, "num_module_steps_trained_lifetime_throughput": 710.7656232871286}, "intrinsic_reward_module": {"diff_num_grad_updates_vs_sampler_policy": 1.0, "gradients_default_optimizer_global_norm": 0.0, "num_trainable_parameters": 8266, "curr_entropy_coeff": 0.0015431216992, "total_loss": 0.0, "module_train_batch_size_mean": 999.0, "default_optimizer_learning_rate": 0.0002715581955, "weights_seq_no": 3.0, "num_module_steps_trained": 5994, "num_module_steps_trained_lifetime": 17982, "num_module_steps_trained_lifetime_throughput": 710.7767276824288}, "differentiable_learners": {"intrinsic_attention_ppo_learner": {"default_policy": {"policy_loss": -0.00026278215227648616, "diff_num_grad_updates_vs_sampler_policy": 16.0, "mean_kl_loss": 2.3870352379162796e-05, "total_loss": 0.20607821643352509, "module_train_batch_size_mean": 999.0, "use_intrinsic_rewards": 1.0, "weights_seq_no": 18.0, "vf_loss": 0.26622894406318665, "num_module_steps_trained": 35964, "entropy": 0.6926128268241882, "vf_loss_unclipped": 41.201786041259766, "vf_explained_var": 0.0023083090782165527, "num_module_steps_trained_lifetime": 107892}, "__all_modules__": {"num_env_steps_trained": 189000, "num_module_steps_trained": 71928, "num_module_steps_trained_lifetime": 215784, "num_env_steps_trained_lifetime": 567000, "num_env_steps_trained_lifetime_throughput": 49549.118911030295}, "intrinsic_reward_module": {"num_module_steps_trained_lifetime": 107892, "diff_num_grad_updates_vs_sampler_policy": 16.0, "total_loss": 0.0, "module_train_batch_size_mean": 999.0, "weights_seq_no": 18.0, "num_module_steps_trained": 35964}}}, "__all_modules__": {"num_trainable_parameters": 24861, "num_env_steps_trained": 31500, "num_module_steps_trained": 11988, "num_non_trainable_parameters": 0, "num_module_steps_trained_lifetime": 35964, "num_env_steps_trained_lifetime": 94500, "num_env_steps_trained_lifetime_throughput": 3735.397951726584, "num_module_steps_trained_throughput": 26120130.36214422, "num_module_steps_trained_lifetime_throughput": 10986262.6149735}, "IntrinsicAttentionMask": [[[0.33477309346199036, 0.3321805000305176, 0.33304643630981445], [0.3334316313266754, 0.33325448632240295, 0.33331379294395447], [0.33388057351112366, 0.33289480209350586, 0.3332245945930481]], [[0.33469218015670776, 0.33360350131988525, 0.33170437812805176], [0.33427926898002625, 0.33352184295654297, 0.332198828458786], [0.3335559666156769, 0.3333778977394104, 0.33306607604026794]], [[0.3337801694869995, 0.33372241258621216, 0.3324974477291107], [0.33377450704574585, 0.3337174654006958, 0.33250802755355835], [0.3336542844772339, 0.3336128294467926, 0.3327329158782959]], [[0.3319561779499054, 0.3362411856651306, 0.33180272579193115], [0.3312288224697113, 0.3377760052680969, 0.3309951722621918], [0.3319823145866394, 0.33618587255477905, 0.33183175325393677]], [[0.3343002498149872, 0.3341749906539917, 0.3315247893333435], [0.3342945873737335, 0.33417007327079773, 0.33153530955314636], [0.3341745138168335, 0.33406558632850647, 0.33175989985466003]], [[0.31435996294021606, 0.37223362922668457, 0.31340643763542175], [0.23171082139015198, 0.5400766134262085, 0.22821255028247833], [0.3157605826854706, 0.3693676292896271, 0.3148716986179352]]]}, "num_training_step_calls_per_iteration": 1, "evaluation": {"env_runners": {"env_to_module_connector": {"timers": {"connectors": {"add_observations_from_episodes_to_batch": 2.9581414708656727e-06, "numpy_to_tensor": 1.2871559398583813e-05, "batch_individual_items": 1.2904136582720525e-05, "add_states_from_episodes_to_batch": 2.892807869908487e-06, "add_time_dim_to_batch_and_zero_pad": 7.336595967357187e-06}}, "connector_pipeline_timer": 6.19365939800332e-05}, "num_module_steps_sampled_lifetime": {"default_policy": 1200}, "num_env_steps_sampled_lifetime": 15400, "weights_seq_no": 3.0, "module_to_env_connector": {"timers": {"connectors": {"get_actions": 4.085974392097082e-05, "un_batch_to_individual_items": 6.68222947053699e-06, "listify_data_for_vector_env": 1.0965013945398463e-05, "remove_single_ts_time_rank_from_batch": 1.213063988024002e-05, "normalize_and_clip_actions": 8.215204966832752e-06, "tensor_to_numpy": 1.614292003088616e-05}}, "connector_pipeline_timer": 0.00012249135215968733}, "episode_return_min": -13.5, "rlmodule_inference_timer": 3.4500479145030786e-05, "num_episodes": 20, "num_agent_steps_sampled": {"default_agent": 400}, "num_env_steps_sampled": 400, "episode_len_max": 20, "env_to_module_sum_episodes_length_in": 10.368205581254823, "agent_episode_returns_mean": {"default_agent": 2.7}, "env_reset_timer": 0.0005575404599774629, "episode_len_min": 20, "env_to_module_sum_episodes_length_out": 10.368205581254823, "env_step_timer": 1.4746876190410403e-05, "episode_len_mean": 20.0, "episode_duration_sec_mean": 0.005547291007436191, "num_module_steps_sampled": {"default_policy": 400}, "module_episode_returns_mean": {"default_policy": 2.7}, "sample": 0.11892070578165585, "num_agent_steps_sampled_lifetime": {"default_agent": 1200}, "num_episodes_lifetime": 60, "episode_return_max": 15.5, "episode_return_mean": 2.7, "time_between_sampling": 11.13228182618157}, "num_healthy_workers": 1, "actor_manager_num_outstanding_async_reqs": 0, "num_remote_worker_restarts": 0}, "num_env_steps_sampled_lifetime": -607500.0, "fault_tolerance": {"num_healthy_workers": 0, "num_remote_worker_restarts": 0}, "env_runner_group": {"actor_manager_num_outstanding_async_reqs": 0}, "done": false, "training_iteration": 3, "trial_id": "b7d6e_00000", "date": "2025-08-11_18-08-42", "timestamp": 1754928522, "time_this_iter_s": 12.088752746582031, "time_total_s": 33.784156799316406, "pid": 10343, "hostname": "Mac", "node_ip": "127.0.0.1", "config": {"exploration_config": {}, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 2, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "env": "Umbrella", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": false, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 0, "create_local_env_runner": true, "num_envs_per_env_runner": 1, "gym_env_vectorize_mode": "SYNC", "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "episodes_to_numpy": true, "max_requests_in_flight_per_env_runner": 1, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "merge_env_runner_states": "training_only", "broadcast_env_runner_states": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "complete_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "sampler_perf_stats_ema_coef": null, "_is_online": true, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": "auto", "num_aggregator_actors_per_learner": 0, "max_requests_in_flight_per_aggregator_actor": 3, "local_gpu_idx": 0, "max_requests_in_flight_per_learner": 3, "gamma": 1, "lr": 0.0002715581955, "grad_clip": 0.5, "grad_clip_by": "global_norm", "_train_batch_size_per_learner": 5000, "train_batch_size": 4000, "num_epochs": 1, "minibatch_size": 1000, "shuffle_batch_per_epoch": true, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "log_std_clip_param": 20.0, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "_disable_preprocessor_api": false, "_disable_action_flattening": false}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {"intrinsic_reward_coeff": 0.2795015916508}, "optimizer": {}, "_learner_class": "<class 'source.intrinsic_attention_ppo.learners.IntrinsicAttentionMetaLearner.IntrinsicAttentionMetaLearner'>", "callbacks_on_algorithm_init": null, "callbacks_on_env_runners_recreated": null, "callbacks_on_offline_eval_runners_recreated": null, "callbacks_on_checkpoint_loaded": null, "callbacks_on_environment_created": null, "callbacks_on_episode_created": null, "callbacks_on_episode_start": null, "callbacks_on_episode_step": null, "callbacks_on_episode_end": null, "callbacks_on_evaluate_start": null, "callbacks_on_evaluate_end": null, "callbacks_on_evaluate_offline_start": null, "callbacks_on_evaluate_offline_end": null, "callbacks_on_sample_end": null, "callbacks_on_train_result": null, "explore": true, "enable_rl_module_and_learner": true, "enable_env_runner_and_connector_v2": true, "_prior_exploration_config": {"type": "StochasticSampling"}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x1616f98a0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "offline_data_class": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_read_batch_size": null, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "materialize_data": false, "materialize_mapped_data": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "ignore_final_observation": false, "prelearner_class": null, "prelearner_buffer_class": null, "prelearner_buffer_kwargs": {}, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_remaining_data": false, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": 1, "evaluation_duration": 20, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_auto_duration_min_env_steps_per_sample": 100, "evaluation_auto_duration_max_env_steps_per_sample": 2000, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 1, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "offline_evaluation_interval": null, "num_offline_eval_runners": 0, "offline_loss_for_module_fn": null, "offline_evaluation_duration": 1, "offline_evaluation_parallel_to_training": false, "offline_evaluation_timeout_s": 120.0, "num_cpus_per_offline_eval_runner": 1, "num_gpus_per_offline_eval_runner": 0, "custom_resources_per_offline_eval_runner": {}, "restart_failed_offline_eval_runners": true, "ignore_offline_eval_runner_failures": false, "max_num_offline_eval_runner_restarts": 1000, "offline_eval_runner_restore_timeout_s": 1800.0, "max_requests_in_flight_per_offline_eval_runner": 1, "validate_offline_eval_runners_after_construction": true, "offline_eval_runner_health_probe_timeout_s": 30.0, "offline_eval_rl_module_inference_only": false, "broadcast_offline_eval_runner_states": false, "offline_eval_batch_size_per_runner": 256, "dataset_num_iters_per_eval_runner": 1, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "log_gradients": false, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 9, "restart_failed_env_runners": true, "ignore_env_runner_failures": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30.0, "env_runner_restore_timeout_s": 1800.0, "_model_config": {}, "_rl_module_spec": "MultiRLModuleSpec(multi_rl_module_class=<class 'ray.rllib.core.rl_module.multi_rl_module.MultiRLModule'>, observation_space=None, action_space=None, inference_only=False, model_config=None, rl_module_specs={'default_policy': RLModuleSpec(module_class=<class 'source.intrinsic_attention_ppo.rl_modules.DifferentiablePPOModule.DifferentiablePPOModule'>, observation_space=None, action_space=None, inference_only=False, learner_only=False, model_config={'vf_share_layers': True, 'embedding_dim': 62, 'max_seq_len': 3, 'policy_head_hidden_sizes': [32], 'value_head_hidden_sizes': [101], 'embedding_hidden_sizes': [121]}, catalog_class=None, load_state_path=None, model_config_dict=None), 'intrinsic_reward_module': RLModuleSpec(module_class=<class 'source.intrinsic_attention_ppo.rl_modules.IntrinsicAttentionModule.IntrinsicAttentionModule'>, observation_space=None, action_space=None, inference_only=False, learner_only=True, model_config={'intrinsic_reward_network': {'encoder_hidden_sizes': [], 'encoding_dim': 1, 'num_heads': 1, 'head_hidden_sizes': None, 'layers': [{'type': 'attention'}]}, 'extrinsic_value_hidden_layers': [127, 60], 'vf_share_layers': True, 'max_seq_len': 3}, catalog_class=None, load_state_path=None, model_config_dict=None)}, load_state_path=None, modules_to_load=None, module_specs={'default_policy': RLModuleSpec(module_class=<class 'source.intrinsic_attention_ppo.rl_modules.DifferentiablePPOModule.DifferentiablePPOModule'>, observation_space=None, action_space=None, inference_only=False, learner_only=False, model_config={'vf_share_layers': True, 'embedding_dim': 62, 'max_seq_len': 3, 'policy_head_hidden_sizes': [32], 'value_head_hidden_sizes': [101], 'embedding_hidden_sizes': [121]}, catalog_class=None, load_state_path=None, model_config_dict=None), 'intrinsic_reward_module': RLModuleSpec(module_class=<class 'source.intrinsic_attention_ppo.rl_modules.IntrinsicAttentionModule.IntrinsicAttentionModule'>, observation_space=None, action_space=None, inference_only=False, learner_only=True, model_config={'intrinsic_reward_network': {'encoder_hidden_sizes': [], 'encoding_dim': 1, 'num_heads': 1, 'head_hidden_sizes': None, 'layers': [{'type': 'attention'}]}, 'extrinsic_value_hidden_layers': [127, 60], 'vf_share_layers': True, 'max_seq_len': 3}, catalog_class=None, load_state_path=None, model_config_dict=None)})", "algorithm_config_overrides_per_module": {"intrinsic_reward_module": {"lr": 0.0002715581955}}, "_per_module_overrides": {}, "_validate_config": true, "_use_msgpack_checkpoints": false, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "env_task_fn": -1, "enable_connectors": -1, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.161583927863, "kl_target": 0.0201019014258, "vf_loss_coeff": 0.7790510010087, "entropy_coeff": 0.0015431216992, "clip_param": 0.2459212356676, "vf_clip_param": 0.3769744131561, "entropy_coeff_schedule": null, "lr_schedule": null, "sgd_minibatch_size": -1, "vf_share_layers": -1, "differentiable_learner_configs": ["DifferentiableLearnerConfig(learner_class=<class 'source.intrinsic_attention_ppo.learners.IntrinsicAttentionPPOLearner.IntrinsicAttentionPPOLearner'>, learner_connector=None, add_default_connectors_to_learner_pipeline=True, is_multi_agent=False, policies_to_update=['default_policy'], lr=0.0060984166342, num_total_minibatches=0, num_epochs=1, minibatch_size=1000, shuffle_batch_per_epoch=True)"], "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9485408017724, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.callbacks.callbacks.RLlibCallback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 33.784156799316406, "iterations_since_restore": 3, "perf": {"cpu_util_percent": 53.80588235294118, "ram_util_percent": 81.98235294117647}}
{"timers": {"training_iteration": 10.400636206234338, "restore_env_runners": 6.582968498929404e-05, "training_step": 10.400299089276718, "env_runner_sampling_timer": 1.7573904662596354, "learner_update_timer": 8.418886378780142, "synch_weights": 0.0017660630486622685, "restore_eval_env_runners": 5.896177288377658e-05, "evaluation_iteration": 0.13059816933982074, "synch_eval_env_connectors": 0.00018620291567640376, "synch_env_connectors": 4.4226122088730335e-06}, "env_runners": {"env_to_module_connector": {"timers": {"connectors": {"numpy_to_tensor": 1.4162030637777084e-05, "add_time_dim_to_batch_and_zero_pad": 7.714397375827452e-06, "batch_individual_items": 1.3617131822994344e-05, "add_observations_from_episodes_to_batch": 3.1032984807850945e-06, "add_states_from_episodes_to_batch": 2.9807846701507015e-06}}, "connector_pipeline_timer": 6.55587072709169e-05}, "module_to_env_connector": {"timers": {"connectors": {"tensor_to_numpy": 1.6521879944982622e-05, "un_batch_to_individual_items": 7.157933993534495e-06, "listify_data_for_vector_env": 1.1456872133060982e-05, "get_actions": 4.4242747795015405e-05, "remove_single_ts_time_rank_from_batch": 1.2908936072678106e-05, "normalize_and_clip_actions": 8.812984678564765e-06}}, "connector_pipeline_timer": 0.00012986632085782817}, "module_episode_returns_mean": {"default_policy": 5.22}, "episode_len_min": 20, "env_reset_timer": 5.110203663786295e-05, "agent_episode_returns_mean": {"default_agent": 5.22}, "time_between_sampling": 0.04197027605531572, "env_to_module_sum_episodes_length_out": 10.36823839457432, "num_module_steps_sampled": {"default_policy": 5000.0}, "env_step_timer": 1.5642930000491897e-05, "weights_seq_no": 3.0, "num_env_steps_sampled_lifetime": -1225000.0, "num_agent_steps_sampled": {"default_agent": 5000.0}, "num_episodes_lifetime": -61250.0, "episode_len_mean": 20.0, "episode_duration_sec_mean": 0.00591349033266306, "episode_return_max": 14.5, "episode_len_max": 20, "num_module_steps_sampled_lifetime": {"default_policy": -1225000.0}, "episode_return_min": -5.5, "rlmodule_inference_timer": 3.4930054240046176e-05, "episode_return_mean": 5.22, "env_to_module_sum_episodes_length_in": 10.36823839457432, "num_agent_steps_sampled_lifetime": {"default_agent": -1225000.0}, "num_episodes": 250.0, "sample": 0.006136599809389185, "num_env_steps_sampled": 5000.0, "num_env_steps_sampled_lifetime_throughput": 3016.3191001441946}, "__all_modules__": {"learner_connector_sum_episodes_length_in": 5000.0, "learner_connector": {"connector_pipeline_timer": 0.1830709929349511, "timers": {"connectors": {"add_one_ts_to_episodes_and_truncate": 0.009558332121054409, "add_observations_from_episodes_to_batch": 0.000850104221630725, "add_columns_from_episodes_to_train_batch": 0.04267454585188546, "add_time_dim_to_batch_and_zero_pad": 0.1104237256152107, "add_states_from_episodes_to_batch": 0.003931823206640314, "batch_individual_items": 0.015353730435112605, "numpy_to_tensor": 8.492599894606972e-05}}}, "learner_connector_sum_episodes_length_out": 5250.0}, "learners": {"default_policy": {"num_module_steps_trained_lifetime": 23976, "policy_loss": -0.0004353610856924206, "diff_num_grad_updates_vs_sampler_policy": 1.0, "num_trainable_parameters": 16595, "mean_kl_loss": 3.925578130292706e-05, "curr_entropy_coeff": 0.0015431216992, "total_loss": 0.20412735641002655, "module_train_batch_size_mean": 999.0, "curr_kl_coeff": 0.010098995640873909, "use_intrinsic_rewards": 0.0, "weights_seq_no": 4.0, "vf_loss": 0.2639496326446533, "num_module_steps_trained": 5994, "entropy": 0.6923035979270935, "vf_loss_unclipped": 42.09244918823242, "vf_explained_var": 0.002254009246826172, "num_module_steps_trained_lifetime_throughput": 707.3889378982738}, "intrinsic_reward_module": {"diff_num_grad_updates_vs_sampler_policy": 1.0, "gradients_default_optimizer_global_norm": 0.0, "num_trainable_parameters": 8266, "curr_entropy_coeff": 0.0015431216992, "total_loss": 0.0, "module_train_batch_size_mean": 999.0, "default_optimizer_learning_rate": 0.0002715581955, "weights_seq_no": 4.0, "num_module_steps_trained": 5994, "num_module_steps_trained_lifetime": 23976, "num_module_steps_trained_lifetime_throughput": 707.3996802829707}, "differentiable_learners": {"intrinsic_attention_ppo_learner": {"default_policy": {"policy_loss": -0.00042203624616377056, "diff_num_grad_updates_vs_sampler_policy": 21.0, "mean_kl_loss": 3.7141631764825433e-05, "total_loss": 0.2053222358226776, "module_train_batch_size_mean": 999.0, "use_intrinsic_rewards": 1.0, "weights_seq_no": 24.0, "vf_loss": 0.26545968651771545, "num_module_steps_trained": 35964, "entropy": 0.6923133730888367, "vf_loss_unclipped": 41.91456604003906, "vf_explained_var": 0.0023113489151000977, "num_module_steps_trained_lifetime": 143856}, "__all_modules__": {"num_env_steps_trained": 189000, "num_module_steps_trained": 71928, "num_module_steps_trained_lifetime": 287712, "num_env_steps_trained_lifetime": 756000, "num_env_steps_trained_lifetime_throughput": 48885.40296206192}, "intrinsic_reward_module": {"num_module_steps_trained_lifetime": 143856, "diff_num_grad_updates_vs_sampler_policy": 21.0, "total_loss": 0.0, "module_train_batch_size_mean": 999.0, "weights_seq_no": 24.0, "num_module_steps_trained": 35964}}}, "__all_modules__": {"num_trainable_parameters": 24861, "num_env_steps_trained": 31500, "num_module_steps_trained": 11988, "num_non_trainable_parameters": 0, "num_module_steps_trained_lifetime": 47952, "num_env_steps_trained_lifetime": 126000, "num_env_steps_trained_lifetime_throughput": 3717.648414146338, "num_module_steps_trained_throughput": 25506747.586827494, "num_module_steps_trained_lifetime_throughput": 11017127.517128704}, "IntrinsicAttentionMask": [[[0.33507829904556274, 0.33248335123062134, 0.3324383795261383], [0.3334524631500244, 0.33327534794807434, 0.333272248506546], [0.3334241807460785, 0.3332890570163727, 0.33328670263290405]], [[0.33356207609176636, 0.33426231145858765, 0.3321755826473236], [0.3336501121520996, 0.33462220430374146, 0.33172765374183655], [0.33338630199432373, 0.3335476219654083, 0.33306610584259033]], [[0.3351786732673645, 0.332474023103714, 0.3323472738265991], [0.3349529802799225, 0.3325791656970978, 0.33246785402297974], [0.33494237065315247, 0.3325841426849365, 0.3324735462665558]], [[0.3332485556602478, 0.33367297053337097, 0.3330785036087036], [0.33279624581336975, 0.33547621965408325, 0.3317275941371918], [0.33342859148979187, 0.33295106887817383, 0.3336202800273895]], [[0.3330991864204407, 0.3338829576969147, 0.33301785588264465], [0.3330181837081909, 0.334073007106781, 0.3329087793827057], [0.3331076204776764, 0.333863228559494, 0.333029180765152]], [[0.3143598735332489, 0.3722338378429413, 0.3134063482284546], [0.23171007633209229, 0.5400781631469727, 0.22821176052093506], [0.3157605230808258, 0.369367778301239, 0.3148716688156128]]]}, "num_training_step_calls_per_iteration": 1, "evaluation": {"env_runners": {"env_to_module_connector": {"timers": {"connectors": {"add_observations_from_episodes_to_batch": 3.2111206208837716e-06, "numpy_to_tensor": 1.5487129803906623e-05, "batch_individual_items": 1.4101954756102375e-05, "add_states_from_episodes_to_batch": 3.242677830922821e-06, "add_time_dim_to_batch_and_zero_pad": 8.181346305190936e-06}}, "connector_pipeline_timer": 6.921943375872332e-05}, "num_module_steps_sampled_lifetime": {"default_policy": 1600}, "num_env_steps_sampled_lifetime": 20400, "weights_seq_no": 4.0, "module_to_env_connector": {"timers": {"connectors": {"get_actions": 4.905598946653945e-05, "un_batch_to_individual_items": 7.5343741896737525e-06, "listify_data_for_vector_env": 1.2786111680971606e-05, "remove_single_ts_time_rank_from_batch": 1.3032886065616543e-05, "normalize_and_clip_actions": 9.089420384563676e-06, "tensor_to_numpy": 1.8612441311233265e-05}}, "connector_pipeline_timer": 0.00014158700201514314}, "episode_return_min": -13.5, "rlmodule_inference_timer": 4.133389516149269e-05, "num_episodes": 20, "num_agent_steps_sampled": {"default_agent": 400}, "num_env_steps_sampled": 400, "episode_len_max": 20, "env_to_module_sum_episodes_length_in": 10.368237912813044, "agent_episode_returns_mean": {"default_agent": 2.7}, "env_reset_timer": 0.0005553350554271602, "episode_len_min": 20, "env_to_module_sum_episodes_length_out": 10.368237912813044, "env_step_timer": 1.765085653706343e-05, "episode_len_mean": 20.0, "episode_duration_sec_mean": 0.005632791691459716, "num_module_steps_sampled": {"default_policy": 400}, "module_episode_returns_mean": {"default_policy": 2.7}, "sample": 0.11902981372386112, "num_agent_steps_sampled_lifetime": {"default_agent": 1600}, "num_episodes_lifetime": 80, "episode_return_max": 15.5, "episode_return_mean": 2.7, "time_between_sampling": 11.136945255418995}, "num_healthy_workers": 1, "actor_manager_num_outstanding_async_reqs": 0, "num_remote_worker_restarts": 0}, "num_env_steps_sampled_lifetime": -1225000.0, "fault_tolerance": {"num_healthy_workers": 0, "num_remote_worker_restarts": 0}, "env_runner_group": {"actor_manager_num_outstanding_async_reqs": 0}, "done": false, "training_iteration": 4, "trial_id": "b7d6e_00000", "date": "2025-08-11_18-08-54", "timestamp": 1754928534, "time_this_iter_s": 11.700417041778564, "time_total_s": 45.48457384109497, "pid": 10343, "hostname": "Mac", "node_ip": "127.0.0.1", "config": {"exploration_config": {}, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 2, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "env": "Umbrella", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": false, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 0, "create_local_env_runner": true, "num_envs_per_env_runner": 1, "gym_env_vectorize_mode": "SYNC", "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "episodes_to_numpy": true, "max_requests_in_flight_per_env_runner": 1, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "merge_env_runner_states": "training_only", "broadcast_env_runner_states": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "complete_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "sampler_perf_stats_ema_coef": null, "_is_online": true, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": "auto", "num_aggregator_actors_per_learner": 0, "max_requests_in_flight_per_aggregator_actor": 3, "local_gpu_idx": 0, "max_requests_in_flight_per_learner": 3, "gamma": 1, "lr": 0.0002715581955, "grad_clip": 0.5, "grad_clip_by": "global_norm", "_train_batch_size_per_learner": 5000, "train_batch_size": 4000, "num_epochs": 1, "minibatch_size": 1000, "shuffle_batch_per_epoch": true, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "log_std_clip_param": 20.0, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "_disable_preprocessor_api": false, "_disable_action_flattening": false}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {"intrinsic_reward_coeff": 0.2795015916508}, "optimizer": {}, "_learner_class": "<class 'source.intrinsic_attention_ppo.learners.IntrinsicAttentionMetaLearner.IntrinsicAttentionMetaLearner'>", "callbacks_on_algorithm_init": null, "callbacks_on_env_runners_recreated": null, "callbacks_on_offline_eval_runners_recreated": null, "callbacks_on_checkpoint_loaded": null, "callbacks_on_environment_created": null, "callbacks_on_episode_created": null, "callbacks_on_episode_start": null, "callbacks_on_episode_step": null, "callbacks_on_episode_end": null, "callbacks_on_evaluate_start": null, "callbacks_on_evaluate_end": null, "callbacks_on_evaluate_offline_start": null, "callbacks_on_evaluate_offline_end": null, "callbacks_on_sample_end": null, "callbacks_on_train_result": null, "explore": true, "enable_rl_module_and_learner": true, "enable_env_runner_and_connector_v2": true, "_prior_exploration_config": {"type": "StochasticSampling"}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x1616f98a0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "offline_data_class": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_read_batch_size": null, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "materialize_data": false, "materialize_mapped_data": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "ignore_final_observation": false, "prelearner_class": null, "prelearner_buffer_class": null, "prelearner_buffer_kwargs": {}, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_remaining_data": false, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": 1, "evaluation_duration": 20, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_auto_duration_min_env_steps_per_sample": 100, "evaluation_auto_duration_max_env_steps_per_sample": 2000, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 1, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "offline_evaluation_interval": null, "num_offline_eval_runners": 0, "offline_loss_for_module_fn": null, "offline_evaluation_duration": 1, "offline_evaluation_parallel_to_training": false, "offline_evaluation_timeout_s": 120.0, "num_cpus_per_offline_eval_runner": 1, "num_gpus_per_offline_eval_runner": 0, "custom_resources_per_offline_eval_runner": {}, "restart_failed_offline_eval_runners": true, "ignore_offline_eval_runner_failures": false, "max_num_offline_eval_runner_restarts": 1000, "offline_eval_runner_restore_timeout_s": 1800.0, "max_requests_in_flight_per_offline_eval_runner": 1, "validate_offline_eval_runners_after_construction": true, "offline_eval_runner_health_probe_timeout_s": 30.0, "offline_eval_rl_module_inference_only": false, "broadcast_offline_eval_runner_states": false, "offline_eval_batch_size_per_runner": 256, "dataset_num_iters_per_eval_runner": 1, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "log_gradients": false, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 9, "restart_failed_env_runners": true, "ignore_env_runner_failures": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30.0, "env_runner_restore_timeout_s": 1800.0, "_model_config": {}, "_rl_module_spec": "MultiRLModuleSpec(multi_rl_module_class=<class 'ray.rllib.core.rl_module.multi_rl_module.MultiRLModule'>, observation_space=None, action_space=None, inference_only=False, model_config=None, rl_module_specs={'default_policy': RLModuleSpec(module_class=<class 'source.intrinsic_attention_ppo.rl_modules.DifferentiablePPOModule.DifferentiablePPOModule'>, observation_space=None, action_space=None, inference_only=False, learner_only=False, model_config={'vf_share_layers': True, 'embedding_dim': 62, 'max_seq_len': 3, 'policy_head_hidden_sizes': [32], 'value_head_hidden_sizes': [101], 'embedding_hidden_sizes': [121]}, catalog_class=None, load_state_path=None, model_config_dict=None), 'intrinsic_reward_module': RLModuleSpec(module_class=<class 'source.intrinsic_attention_ppo.rl_modules.IntrinsicAttentionModule.IntrinsicAttentionModule'>, observation_space=None, action_space=None, inference_only=False, learner_only=True, model_config={'intrinsic_reward_network': {'encoder_hidden_sizes': [], 'encoding_dim': 1, 'num_heads': 1, 'head_hidden_sizes': None, 'layers': [{'type': 'attention'}]}, 'extrinsic_value_hidden_layers': [127, 60], 'vf_share_layers': True, 'max_seq_len': 3}, catalog_class=None, load_state_path=None, model_config_dict=None)}, load_state_path=None, modules_to_load=None, module_specs={'default_policy': RLModuleSpec(module_class=<class 'source.intrinsic_attention_ppo.rl_modules.DifferentiablePPOModule.DifferentiablePPOModule'>, observation_space=None, action_space=None, inference_only=False, learner_only=False, model_config={'vf_share_layers': True, 'embedding_dim': 62, 'max_seq_len': 3, 'policy_head_hidden_sizes': [32], 'value_head_hidden_sizes': [101], 'embedding_hidden_sizes': [121]}, catalog_class=None, load_state_path=None, model_config_dict=None), 'intrinsic_reward_module': RLModuleSpec(module_class=<class 'source.intrinsic_attention_ppo.rl_modules.IntrinsicAttentionModule.IntrinsicAttentionModule'>, observation_space=None, action_space=None, inference_only=False, learner_only=True, model_config={'intrinsic_reward_network': {'encoder_hidden_sizes': [], 'encoding_dim': 1, 'num_heads': 1, 'head_hidden_sizes': None, 'layers': [{'type': 'attention'}]}, 'extrinsic_value_hidden_layers': [127, 60], 'vf_share_layers': True, 'max_seq_len': 3}, catalog_class=None, load_state_path=None, model_config_dict=None)})", "algorithm_config_overrides_per_module": {"intrinsic_reward_module": {"lr": 0.0002715581955}}, "_per_module_overrides": {}, "_validate_config": true, "_use_msgpack_checkpoints": false, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "env_task_fn": -1, "enable_connectors": -1, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.161583927863, "kl_target": 0.0201019014258, "vf_loss_coeff": 0.7790510010087, "entropy_coeff": 0.0015431216992, "clip_param": 0.2459212356676, "vf_clip_param": 0.3769744131561, "entropy_coeff_schedule": null, "lr_schedule": null, "sgd_minibatch_size": -1, "vf_share_layers": -1, "differentiable_learner_configs": ["DifferentiableLearnerConfig(learner_class=<class 'source.intrinsic_attention_ppo.learners.IntrinsicAttentionPPOLearner.IntrinsicAttentionPPOLearner'>, learner_connector=None, add_default_connectors_to_learner_pipeline=True, is_multi_agent=False, policies_to_update=['default_policy'], lr=0.0060984166342, num_total_minibatches=0, num_epochs=1, minibatch_size=1000, shuffle_batch_per_epoch=True)"], "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9485408017724, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.callbacks.callbacks.RLlibCallback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 45.48457384109497, "iterations_since_restore": 4, "perf": {"cpu_util_percent": 49.90625, "ram_util_percent": 81.95625}}
{"timers": {"training_iteration": 10.406760720002069, "restore_env_runners": 6.525638762247982e-05, "training_step": 10.406424387974308, "env_runner_sampling_timer": 1.7568695774274998, "learner_update_timer": 8.425515002912043, "synch_weights": 0.0017570457470863395, "restore_eval_env_runners": 5.8855075013707395e-05, "evaluation_iteration": 0.13069757514625788, "synch_eval_env_connectors": 0.0001865100473904749, "synch_env_connectors": 4.434635641984642e-06}, "env_runners": {"env_to_module_connector": {"timers": {"connectors": {"numpy_to_tensor": 1.4356906181856845e-05, "add_time_dim_to_batch_and_zero_pad": 7.866271538143679e-06, "batch_individual_items": 1.3709060551688216e-05, "add_observations_from_episodes_to_batch": 3.200630713338724e-06, "add_states_from_episodes_to_batch": 3.0971923110292166e-06}}, "connector_pipeline_timer": 6.650837866746303e-05}, "module_to_env_connector": {"timers": {"connectors": {"tensor_to_numpy": 1.6774518454513864e-05, "un_batch_to_individual_items": 7.238854151619734e-06, "listify_data_for_vector_env": 1.161400280708556e-05, "get_actions": 4.488726212830867e-05, "remove_single_ts_time_rank_from_batch": 1.3090608069692975e-05, "normalize_and_clip_actions": 8.805542956215952e-06}}, "connector_pipeline_timer": 0.00013159669953803388}, "module_episode_returns_mean": {"default_policy": 5.700000000000004}, "episode_len_min": 20, "env_reset_timer": 4.886990703291187e-05, "agent_episode_returns_mean": {"default_agent": 5.700000000000004}, "time_between_sampling": 0.04070160606359398, "env_to_module_sum_episodes_length_out": 10.36823839457432, "num_module_steps_sampled": {"default_policy": 5000.0}, "env_step_timer": 1.6067116076153572e-05, "weights_seq_no": 4.0, "num_env_steps_sampled_lifetime": -1842500.0, "num_agent_steps_sampled": {"default_agent": 5000.0}, "num_episodes_lifetime": -92125.0, "episode_len_mean": 20.0, "episode_duration_sec_mean": 0.005828886498231441, "episode_return_max": 14.5, "episode_len_max": 20, "num_module_steps_sampled_lifetime": {"default_policy": -1842500.0}, "episode_return_min": -5.5, "rlmodule_inference_timer": 3.612951677347233e-05, "episode_return_mean": 5.700000000000004, "env_to_module_sum_episodes_length_in": 10.36823839457432, "num_agent_steps_sampled_lifetime": {"default_agent": -1842500.0}, "num_episodes": 250.0, "sample": 0.006399958769034859, "num_env_steps_sampled": 5000.0, "num_env_steps_sampled_lifetime_throughput": 2982.922637076363}, "__all_modules__": {"learner_connector_sum_episodes_length_in": 5000.0, "learner_connector": {"connector_pipeline_timer": 0.18300435842523433, "timers": {"connectors": {"add_one_ts_to_episodes_and_truncate": 0.009554719639847206, "add_observations_from_episodes_to_batch": 0.0008501106795842165, "add_columns_from_episodes_to_train_batch": 0.04267462580288889, "add_time_dim_to_batch_and_zero_pad": 0.11038001710958997, "add_states_from_episodes_to_batch": 0.003931987885225625, "batch_individual_items": 0.015333146881196741, "numpy_to_tensor": 8.646673852879668e-05}}}, "learner_connector_sum_episodes_length_out": 5250.0}, "learners": {"default_policy": {"num_module_steps_trained_lifetime": 29970, "policy_loss": -5.752167999162339e-05, "diff_num_grad_updates_vs_sampler_policy": 1.0, "num_trainable_parameters": 16595, "mean_kl_loss": 5.639461505779764e-06, "curr_entropy_coeff": 0.0015431216992, "total_loss": 0.20448295772075653, "module_train_batch_size_mean": 999.0, "curr_kl_coeff": 0.0050494978204369545, "use_intrinsic_rewards": 0.0, "weights_seq_no": 5.0, "vf_loss": 0.2639218270778656, "num_module_steps_trained": 5994, "entropy": 0.6921748518943787, "vf_loss_unclipped": 42.8080940246582, "vf_explained_var": 0.0005921721458435059, "num_module_steps_trained_lifetime_throughput": 703.7295641033767}, "intrinsic_reward_module": {"diff_num_grad_updates_vs_sampler_policy": 1.0, "gradients_default_optimizer_global_norm": 0.0, "num_trainable_parameters": 8266, "curr_entropy_coeff": 0.0015431216992, "total_loss": 0.0, "module_train_batch_size_mean": 999.0, "default_optimizer_learning_rate": 0.0002715581955, "weights_seq_no": 5.0, "num_module_steps_trained": 5994, "num_module_steps_trained_lifetime": 29970, "num_module_steps_trained_lifetime_throughput": 703.7398945038276}, "differentiable_learners": {"intrinsic_attention_ppo_learner": {"default_policy": {"policy_loss": -5.6515607866458595e-05, "diff_num_grad_updates_vs_sampler_policy": 26.0, "mean_kl_loss": 5.432762009149883e-06, "total_loss": 0.20528675615787506, "module_train_batch_size_mean": 999.0, "use_intrinsic_rewards": 1.0, "weights_seq_no": 30.0, "vf_loss": 0.2649511992931366, "num_module_steps_trained": 35964, "entropy": 0.6921776533126831, "vf_loss_unclipped": 42.631343841552734, "vf_explained_var": 0.002332925796508789, "num_module_steps_trained_lifetime": 179820}, "__all_modules__": {"num_env_steps_trained": 189000, "num_module_steps_trained": 71928, "num_module_steps_trained_lifetime": 359640, "num_env_steps_trained_lifetime": 945000, "num_env_steps_trained_lifetime_throughput": 48134.165344359964}, "intrinsic_reward_module": {"num_module_steps_trained_lifetime": 179820, "diff_num_grad_updates_vs_sampler_policy": 26.0, "total_loss": 0.0, "module_train_batch_size_mean": 999.0, "weights_seq_no": 30.0, "num_module_steps_trained": 35964}}}, "__all_modules__": {"num_trainable_parameters": 24861, "num_env_steps_trained": 31500, "num_module_steps_trained": 11988, "num_non_trainable_parameters": 0, "num_module_steps_trained_lifetime": 59940, "num_env_steps_trained_lifetime": 157500, "num_env_steps_trained_lifetime_throughput": 3698.4127056321167, "num_module_steps_trained_throughput": 24865773.09067855, "num_module_steps_trained_lifetime_throughput": 11046861.904149834}, "IntrinsicAttentionMask": [[[0.3318576216697693, 0.33410122990608215, 0.33404120802879333], [0.33118322491645813, 0.33445215225219727, 0.3343645930290222], [0.3312011957168579, 0.33444279432296753, 0.3343559503555298]], [[0.33356210589408875, 0.33426234126091003, 0.332175612449646], [0.3336501121520996, 0.33462220430374146, 0.33172765374183655], [0.33338630199432373, 0.3335476219654083, 0.33306610584259033]], [[0.33268681168556213, 0.3325747549533844, 0.33473849296569824], [0.3326909840106964, 0.332579642534256, 0.33472931385040283], [0.3326099216938019, 0.33248457312583923, 0.3349055349826813]], [[0.3334607481956482, 0.33306416869163513, 0.3334750533103943], [0.33273741602897644, 0.33459189534187317, 0.33267074823379517], [0.33348679542541504, 0.33300918340682983, 0.3335040211677551]], [[0.33269941806793213, 0.3325895369052887, 0.3347110152244568], [0.33270367980003357, 0.33259451389312744, 0.33470189571380615], [0.33262255787849426, 0.3324993848800659, 0.3348780572414398]], [[0.3145408630371094, 0.3764030933380127, 0.3090561032295227], [0.245699942111969, 0.5262687802314758, 0.22803127765655518], [0.32067742943763733, 0.3624713122844696, 0.31685131788253784]]]}, "num_training_step_calls_per_iteration": 1, "evaluation": {"env_runners": {"env_to_module_connector": {"timers": {"connectors": {"add_observations_from_episodes_to_batch": 2.8289033106502376e-06, "numpy_to_tensor": 1.1953361175994317e-05, "batch_individual_items": 1.2270153494680156e-05, "add_states_from_episodes_to_batch": 2.7727150693640942e-06, "add_time_dim_to_batch_and_zero_pad": 6.8080740388270524e-06}}, "connector_pipeline_timer": 5.860239819865235e-05}, "num_module_steps_sampled_lifetime": {"default_policy": 2000}, "num_env_steps_sampled_lifetime": 25400, "weights_seq_no": 5.0, "module_to_env_connector": {"timers": {"connectors": {"get_actions": 3.606442337476302e-05, "un_batch_to_individual_items": 6.5051996336916005e-06, "listify_data_for_vector_env": 1.0324075577684603e-05, "remove_single_ts_time_rank_from_batch": 1.1936806407327918e-05, "normalize_and_clip_actions": 7.97209556418034e-06, "tensor_to_numpy": 1.4736897892627917e-05}}, "connector_pipeline_timer": 0.0001139800961469339}, "episode_return_min": -13.5, "rlmodule_inference_timer": 3.116561638982407e-05, "num_episodes": 20, "num_agent_steps_sampled": {"default_agent": 400}, "num_env_steps_sampled": 400, "episode_len_max": 20, "env_to_module_sum_episodes_length_in": 10.368238387501162, "agent_episode_returns_mean": {"default_agent": 2.1}, "env_reset_timer": 0.0005532517045196565, "episode_len_min": 20, "env_to_module_sum_episodes_length_out": 10.368238387501162, "env_step_timer": 1.368361671770393e-05, "episode_len_mean": 20.0, "episode_duration_sec_mean": 0.00555051960167475, "num_module_steps_sampled": {"default_policy": 400}, "module_episode_returns_mean": {"default_policy": 2.1}, "sample": 0.11898385600676432, "num_agent_steps_sampled_lifetime": {"default_agent": 2000}, "num_episodes_lifetime": 100, "episode_return_max": 15.5, "episode_return_mean": 2.1, "time_between_sampling": 11.13610574994429}, "num_healthy_workers": 1, "actor_manager_num_outstanding_async_reqs": 0, "num_remote_worker_restarts": 0}, "num_env_steps_sampled_lifetime": -1842500.0, "fault_tolerance": {"num_healthy_workers": 0, "num_remote_worker_restarts": 0}, "env_runner_group": {"actor_manager_num_outstanding_async_reqs": 0}, "done": false, "training_iteration": 5, "trial_id": "b7d6e_00000", "date": "2025-08-11_18-09-05", "timestamp": 1754928545, "time_this_iter_s": 11.139084100723267, "time_total_s": 56.62365794181824, "pid": 10343, "hostname": "Mac", "node_ip": "127.0.0.1", "config": {"exploration_config": {}, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 2, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "env": "Umbrella", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": false, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 0, "create_local_env_runner": true, "num_envs_per_env_runner": 1, "gym_env_vectorize_mode": "SYNC", "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "episodes_to_numpy": true, "max_requests_in_flight_per_env_runner": 1, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "merge_env_runner_states": "training_only", "broadcast_env_runner_states": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "complete_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "sampler_perf_stats_ema_coef": null, "_is_online": true, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": "auto", "num_aggregator_actors_per_learner": 0, "max_requests_in_flight_per_aggregator_actor": 3, "local_gpu_idx": 0, "max_requests_in_flight_per_learner": 3, "gamma": 1, "lr": 0.0002715581955, "grad_clip": 0.5, "grad_clip_by": "global_norm", "_train_batch_size_per_learner": 5000, "train_batch_size": 4000, "num_epochs": 1, "minibatch_size": 1000, "shuffle_batch_per_epoch": true, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "log_std_clip_param": 20.0, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "_disable_preprocessor_api": false, "_disable_action_flattening": false}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {"intrinsic_reward_coeff": 0.2795015916508}, "optimizer": {}, "_learner_class": "<class 'source.intrinsic_attention_ppo.learners.IntrinsicAttentionMetaLearner.IntrinsicAttentionMetaLearner'>", "callbacks_on_algorithm_init": null, "callbacks_on_env_runners_recreated": null, "callbacks_on_offline_eval_runners_recreated": null, "callbacks_on_checkpoint_loaded": null, "callbacks_on_environment_created": null, "callbacks_on_episode_created": null, "callbacks_on_episode_start": null, "callbacks_on_episode_step": null, "callbacks_on_episode_end": null, "callbacks_on_evaluate_start": null, "callbacks_on_evaluate_end": null, "callbacks_on_evaluate_offline_start": null, "callbacks_on_evaluate_offline_end": null, "callbacks_on_sample_end": null, "callbacks_on_train_result": null, "explore": true, "enable_rl_module_and_learner": true, "enable_env_runner_and_connector_v2": true, "_prior_exploration_config": {"type": "StochasticSampling"}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x1616f98a0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "offline_data_class": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_read_batch_size": null, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "materialize_data": false, "materialize_mapped_data": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "ignore_final_observation": false, "prelearner_class": null, "prelearner_buffer_class": null, "prelearner_buffer_kwargs": {}, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_remaining_data": false, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": 1, "evaluation_duration": 20, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_auto_duration_min_env_steps_per_sample": 100, "evaluation_auto_duration_max_env_steps_per_sample": 2000, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 1, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "offline_evaluation_interval": null, "num_offline_eval_runners": 0, "offline_loss_for_module_fn": null, "offline_evaluation_duration": 1, "offline_evaluation_parallel_to_training": false, "offline_evaluation_timeout_s": 120.0, "num_cpus_per_offline_eval_runner": 1, "num_gpus_per_offline_eval_runner": 0, "custom_resources_per_offline_eval_runner": {}, "restart_failed_offline_eval_runners": true, "ignore_offline_eval_runner_failures": false, "max_num_offline_eval_runner_restarts": 1000, "offline_eval_runner_restore_timeout_s": 1800.0, "max_requests_in_flight_per_offline_eval_runner": 1, "validate_offline_eval_runners_after_construction": true, "offline_eval_runner_health_probe_timeout_s": 30.0, "offline_eval_rl_module_inference_only": false, "broadcast_offline_eval_runner_states": false, "offline_eval_batch_size_per_runner": 256, "dataset_num_iters_per_eval_runner": 1, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "log_gradients": false, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 9, "restart_failed_env_runners": true, "ignore_env_runner_failures": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30.0, "env_runner_restore_timeout_s": 1800.0, "_model_config": {}, "_rl_module_spec": "MultiRLModuleSpec(multi_rl_module_class=<class 'ray.rllib.core.rl_module.multi_rl_module.MultiRLModule'>, observation_space=None, action_space=None, inference_only=False, model_config=None, rl_module_specs={'default_policy': RLModuleSpec(module_class=<class 'source.intrinsic_attention_ppo.rl_modules.DifferentiablePPOModule.DifferentiablePPOModule'>, observation_space=None, action_space=None, inference_only=False, learner_only=False, model_config={'vf_share_layers': True, 'embedding_dim': 62, 'max_seq_len': 3, 'policy_head_hidden_sizes': [32], 'value_head_hidden_sizes': [101], 'embedding_hidden_sizes': [121]}, catalog_class=None, load_state_path=None, model_config_dict=None), 'intrinsic_reward_module': RLModuleSpec(module_class=<class 'source.intrinsic_attention_ppo.rl_modules.IntrinsicAttentionModule.IntrinsicAttentionModule'>, observation_space=None, action_space=None, inference_only=False, learner_only=True, model_config={'intrinsic_reward_network': {'encoder_hidden_sizes': [], 'encoding_dim': 1, 'num_heads': 1, 'head_hidden_sizes': None, 'layers': [{'type': 'attention'}]}, 'extrinsic_value_hidden_layers': [127, 60], 'vf_share_layers': True, 'max_seq_len': 3}, catalog_class=None, load_state_path=None, model_config_dict=None)}, load_state_path=None, modules_to_load=None, module_specs={'default_policy': RLModuleSpec(module_class=<class 'source.intrinsic_attention_ppo.rl_modules.DifferentiablePPOModule.DifferentiablePPOModule'>, observation_space=None, action_space=None, inference_only=False, learner_only=False, model_config={'vf_share_layers': True, 'embedding_dim': 62, 'max_seq_len': 3, 'policy_head_hidden_sizes': [32], 'value_head_hidden_sizes': [101], 'embedding_hidden_sizes': [121]}, catalog_class=None, load_state_path=None, model_config_dict=None), 'intrinsic_reward_module': RLModuleSpec(module_class=<class 'source.intrinsic_attention_ppo.rl_modules.IntrinsicAttentionModule.IntrinsicAttentionModule'>, observation_space=None, action_space=None, inference_only=False, learner_only=True, model_config={'intrinsic_reward_network': {'encoder_hidden_sizes': [], 'encoding_dim': 1, 'num_heads': 1, 'head_hidden_sizes': None, 'layers': [{'type': 'attention'}]}, 'extrinsic_value_hidden_layers': [127, 60], 'vf_share_layers': True, 'max_seq_len': 3}, catalog_class=None, load_state_path=None, model_config_dict=None)})", "algorithm_config_overrides_per_module": {"intrinsic_reward_module": {"lr": 0.0002715581955}}, "_per_module_overrides": {}, "_validate_config": true, "_use_msgpack_checkpoints": false, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "env_task_fn": -1, "enable_connectors": -1, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.161583927863, "kl_target": 0.0201019014258, "vf_loss_coeff": 0.7790510010087, "entropy_coeff": 0.0015431216992, "clip_param": 0.2459212356676, "vf_clip_param": 0.3769744131561, "entropy_coeff_schedule": null, "lr_schedule": null, "sgd_minibatch_size": -1, "vf_share_layers": -1, "differentiable_learner_configs": ["DifferentiableLearnerConfig(learner_class=<class 'source.intrinsic_attention_ppo.learners.IntrinsicAttentionPPOLearner.IntrinsicAttentionPPOLearner'>, learner_connector=None, add_default_connectors_to_learner_pipeline=True, is_multi_agent=False, policies_to_update=['default_policy'], lr=0.0060984166342, num_total_minibatches=0, num_epochs=1, minibatch_size=1000, shuffle_batch_per_epoch=True)"], "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9485408017724, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.callbacks.callbacks.RLlibCallback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 56.62365794181824, "iterations_since_restore": 5, "perf": {"cpu_util_percent": 46.1875, "ram_util_percent": 80.95625}}
{"timers": {"training_iteration": 10.409188596132266, "restore_env_runners": 6.465965420629678e-05, "training_step": 10.408851345344448, "env_runner_sampling_timer": 1.7562962745722772, "learner_update_timer": 8.428474452472274, "synch_weights": 0.001780234449798846, "restore_eval_env_runners": 5.8353183829138295e-05, "evaluation_iteration": 0.13062357522558496, "synch_eval_env_connectors": 0.00018579494752416498, "synch_env_connectors": 4.435699410149827e-06}, "env_runners": {"env_to_module_connector": {"timers": {"connectors": {"numpy_to_tensor": 1.3818436962727536e-05, "add_time_dim_to_batch_and_zero_pad": 7.532372525761942e-06, "batch_individual_items": 1.3197469697141879e-05, "add_observations_from_episodes_to_batch": 2.995015053450776e-06, "add_states_from_episodes_to_batch": 2.9599516118820484e-06}}, "connector_pipeline_timer": 6.489041758234469e-05}, "module_to_env_connector": {"timers": {"connectors": {"tensor_to_numpy": 1.8912252257784466e-05, "un_batch_to_individual_items": 7.094625101792606e-06, "listify_data_for_vector_env": 1.1157609122905068e-05, "get_actions": 4.365095866845019e-05, "remove_single_ts_time_rank_from_batch": 1.3783107847020251e-05, "normalize_and_clip_actions": 8.592315876578868e-06}}, "connector_pipeline_timer": 0.00013269625940518916}, "module_episode_returns_mean": {"default_policy": 5.700000000000004}, "episode_len_min": 20, "env_reset_timer": 5.145305409567097e-05, "agent_episode_returns_mean": {"default_agent": 5.700000000000004}, "time_between_sampling": 0.03855158556954542, "env_to_module_sum_episodes_length_out": 10.36823839457432, "num_module_steps_sampled": {"default_policy": 5000.0}, "env_step_timer": 1.5358227693615072e-05, "weights_seq_no": 5.0, "num_env_steps_sampled_lifetime": -2460000.0, "num_agent_steps_sampled": {"default_agent": 5000.0}, "num_episodes_lifetime": -123000.0, "episode_len_mean": 20.0, "episode_duration_sec_mean": 0.005836720373947176, "episode_return_max": 14.5, "episode_len_max": 20, "num_module_steps_sampled_lifetime": {"default_policy": -2460000.0}, "episode_return_min": -5.5, "rlmodule_inference_timer": 3.507167151958407e-05, "episode_return_mean": 5.700000000000004, "env_to_module_sum_episodes_length_in": 10.36823839457432, "num_agent_steps_sampled_lifetime": {"default_agent": -2460000.0}, "num_episodes": 250.0, "sample": 0.0063614214965972225, "num_env_steps_sampled": 5000.0, "num_env_steps_sampled_lifetime_throughput": 3142.723332618308}, "__all_modules__": {"learner_connector_sum_episodes_length_in": 5000.0, "learner_connector": {"connector_pipeline_timer": 0.18291869651112358, "timers": {"connectors": {"add_one_ts_to_episodes_and_truncate": 0.009549590783854183, "add_observations_from_episodes_to_batch": 0.0008505449923981445, "add_columns_from_episodes_to_train_batch": 0.042672162464708334, "add_time_dim_to_batch_and_zero_pad": 0.11032129443866044, "add_states_from_episodes_to_batch": 0.0039312700861038495, "batch_individual_items": 0.015314542492970208, "numpy_to_tensor": 8.660957124811486e-05}}}, "learner_connector_sum_episodes_length_out": 5250.0}, "learners": {"default_policy": {"num_module_steps_trained_lifetime": 35964, "policy_loss": -0.0011473544873297215, "diff_num_grad_updates_vs_sampler_policy": 1.0, "num_trainable_parameters": 16595, "mean_kl_loss": 6.307898729573935e-05, "curr_entropy_coeff": 0.0015431216992, "total_loss": 0.20340512692928314, "module_train_batch_size_mean": 999.0, "curr_kl_coeff": 0.0025247489102184772, "use_intrinsic_rewards": 0.0, "weights_seq_no": 6.0, "vf_loss": 0.26393580436706543, "num_module_steps_trained": 5994, "entropy": 0.6916490793228149, "vf_loss_unclipped": 44.229915618896484, "vf_explained_var": -0.00029075145721435547, "num_module_steps_trained_lifetime_throughput": 700.1809680029439}, "intrinsic_reward_module": {"diff_num_grad_updates_vs_sampler_policy": 1.0, "gradients_default_optimizer_global_norm": 0.0, "num_trainable_parameters": 8266, "curr_entropy_coeff": 0.0015431216992, "total_loss": 0.0, "module_train_batch_size_mean": 999.0, "default_optimizer_learning_rate": 0.0002715581955, "weights_seq_no": 6.0, "num_module_steps_trained": 5994, "num_module_steps_trained_lifetime": 35964, "num_module_steps_trained_lifetime_throughput": 700.1910598696195}, "differentiable_learners": {"intrinsic_attention_ppo_learner": {"default_policy": {"policy_loss": -0.0010954920435324311, "diff_num_grad_updates_vs_sampler_policy": 31.0, "mean_kl_loss": 5.7343077060068026e-05, "total_loss": 0.20401529967784882, "module_train_batch_size_mean": 999.0, "use_intrinsic_rewards": 1.0, "weights_seq_no": 36.0, "vf_loss": 0.26464104652404785, "num_module_steps_trained": 35964, "entropy": 0.6916772127151489, "vf_loss_unclipped": 44.033607482910156, "vf_explained_var": 0.002302110195159912, "num_module_steps_trained_lifetime": 215784}, "__all_modules__": {"num_env_steps_trained": 189000, "num_module_steps_trained": 71928, "num_module_steps_trained_lifetime": 431568, "num_env_steps_trained_lifetime": 1134000, "num_env_steps_trained_lifetime_throughput": 47346.60604531638}, "intrinsic_reward_module": {"num_module_steps_trained_lifetime": 215784, "diff_num_grad_updates_vs_sampler_policy": 31.0, "total_loss": 0.0, "module_train_batch_size_mean": 999.0, "weights_seq_no": 36.0, "num_module_steps_trained": 35964}}}, "__all_modules__": {"num_trainable_parameters": 24861, "num_env_steps_trained": 31500, "num_module_steps_trained": 11988, "num_non_trainable_parameters": 0, "num_module_steps_trained_lifetime": 71928, "num_env_steps_trained_lifetime": 189000, "num_env_steps_trained_lifetime_throughput": 3679.7579142529357, "num_module_steps_trained_throughput": 24190636.899272107, "num_module_steps_trained_lifetime_throughput": 11040042.029095387}, "IntrinsicAttentionMask": [[[0.33477306365966797, 0.3330914378166199, 0.33213552832603455], [0.3339039087295532, 0.33323782682418823, 0.33285826444625854], [0.33340832591056824, 0.3333207964897156, 0.3332708775997162]], [[0.33356210589408875, 0.33426234126091003, 0.332175612449646], [0.3336501121520996, 0.33462220430374146, 0.33172765374183655], [0.33338630199432373, 0.3335476219654083, 0.33306610584259033]], [[0.3333910405635834, 0.3333333432674408, 0.3332756757736206], [0.3333902955055237, 0.3333333134651184, 0.3332763612270355], [0.333389550447464, 0.3333333134651184, 0.3332771062850952]], [[0.3318035900592804, 0.33525997400283813, 0.33293649554252625], [0.3308079242706299, 0.3365170955657959, 0.3326749801635742], [0.33147603273391724, 0.3356732130050659, 0.33285069465637207]], [[0.3341384828090668, 0.33295851945877075, 0.33290308713912964], [0.333913117647171, 0.33306342363357544, 0.3330235183238983], [0.3339024782180786, 0.3330683410167694, 0.3330291211605072]], [[0.33992907404899597, 0.32112517952919006, 0.33894577622413635], [0.24480664730072021, 0.5012900233268738, 0.253903329372406], [0.33537501096725464, 0.32954901456832886, 0.3350759744644165]]]}, "num_training_step_calls_per_iteration": 1, "evaluation": {"env_runners": {"env_to_module_connector": {"timers": {"connectors": {"add_observations_from_episodes_to_batch": 5.079840835843779e-06, "numpy_to_tensor": 2.9806567116545753e-05, "batch_individual_items": 2.314746614226624e-05, "add_states_from_episodes_to_batch": 4.9081924546483205e-06, "add_time_dim_to_batch_and_zero_pad": 1.4728197068708752e-05}}, "connector_pipeline_timer": 0.00011362865377081281}, "num_module_steps_sampled_lifetime": {"default_policy": 2400}, "num_env_steps_sampled_lifetime": 30400, "weights_seq_no": 6.0, "module_to_env_connector": {"timers": {"connectors": {"get_actions": 0.00010401214589050315, "un_batch_to_individual_items": 1.2543344853863803e-05, "listify_data_for_vector_env": 2.090109209182696e-05, "remove_single_ts_time_rank_from_batch": 2.3221353406318448e-05, "normalize_and_clip_actions": 1.5228467659942737e-05, "tensor_to_numpy": 3.135557989256451e-05}}, "connector_pipeline_timer": 0.0002601115560507284}, "episode_return_min": -13.5, "rlmodule_inference_timer": 7.55004909360813e-05, "num_episodes": 20, "num_agent_steps_sampled": {"default_agent": 400}, "num_env_steps_sampled": 400, "episode_len_max": 20, "env_to_module_sum_episodes_length_in": 10.368238394470474, "agent_episode_returns_mean": {"default_agent": 1.3}, "env_reset_timer": 0.0005808579368969656, "episode_len_min": 20, "env_to_module_sum_episodes_length_out": 10.368238394470474, "env_step_timer": 3.0445055590288067e-05, "episode_len_mean": 20.0, "episode_duration_sec_mean": 0.007314079200150445, "num_module_steps_sampled": {"default_policy": 400}, "module_episode_returns_mean": {"default_policy": 1.3}, "sample": 0.12094090577750831, "num_agent_steps_sampled_lifetime": {"default_agent": 2400}, "num_episodes_lifetime": 120, "episode_return_max": 15.5, "episode_return_mean": 1.3, "time_between_sampling": 11.131613128285437}, "num_healthy_workers": 1, "actor_manager_num_outstanding_async_reqs": 0, "num_remote_worker_restarts": 0}, "num_env_steps_sampled_lifetime": -2460000.0, "fault_tolerance": {"num_healthy_workers": 0, "num_remote_worker_restarts": 0}, "env_runner_group": {"actor_manager_num_outstanding_async_reqs": 0}, "done": false, "training_iteration": 6, "trial_id": "b7d6e_00000", "date": "2025-08-11_18-09-16", "timestamp": 1754928556, "time_this_iter_s": 10.998199701309204, "time_total_s": 67.62185764312744, "pid": 10343, "hostname": "Mac", "node_ip": "127.0.0.1", "config": {"exploration_config": {}, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 2, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "env": "Umbrella", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": false, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 0, "create_local_env_runner": true, "num_envs_per_env_runner": 1, "gym_env_vectorize_mode": "SYNC", "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "episodes_to_numpy": true, "max_requests_in_flight_per_env_runner": 1, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "merge_env_runner_states": "training_only", "broadcast_env_runner_states": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "complete_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "sampler_perf_stats_ema_coef": null, "_is_online": true, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": "auto", "num_aggregator_actors_per_learner": 0, "max_requests_in_flight_per_aggregator_actor": 3, "local_gpu_idx": 0, "max_requests_in_flight_per_learner": 3, "gamma": 1, "lr": 0.0002715581955, "grad_clip": 0.5, "grad_clip_by": "global_norm", "_train_batch_size_per_learner": 5000, "train_batch_size": 4000, "num_epochs": 1, "minibatch_size": 1000, "shuffle_batch_per_epoch": true, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "log_std_clip_param": 20.0, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "_disable_preprocessor_api": false, "_disable_action_flattening": false}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {"intrinsic_reward_coeff": 0.2795015916508}, "optimizer": {}, "_learner_class": "<class 'source.intrinsic_attention_ppo.learners.IntrinsicAttentionMetaLearner.IntrinsicAttentionMetaLearner'>", "callbacks_on_algorithm_init": null, "callbacks_on_env_runners_recreated": null, "callbacks_on_offline_eval_runners_recreated": null, "callbacks_on_checkpoint_loaded": null, "callbacks_on_environment_created": null, "callbacks_on_episode_created": null, "callbacks_on_episode_start": null, "callbacks_on_episode_step": null, "callbacks_on_episode_end": null, "callbacks_on_evaluate_start": null, "callbacks_on_evaluate_end": null, "callbacks_on_evaluate_offline_start": null, "callbacks_on_evaluate_offline_end": null, "callbacks_on_sample_end": null, "callbacks_on_train_result": null, "explore": true, "enable_rl_module_and_learner": true, "enable_env_runner_and_connector_v2": true, "_prior_exploration_config": {"type": "StochasticSampling"}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x1616f98a0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "offline_data_class": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_read_batch_size": null, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "materialize_data": false, "materialize_mapped_data": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "ignore_final_observation": false, "prelearner_class": null, "prelearner_buffer_class": null, "prelearner_buffer_kwargs": {}, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_remaining_data": false, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": 1, "evaluation_duration": 20, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_auto_duration_min_env_steps_per_sample": 100, "evaluation_auto_duration_max_env_steps_per_sample": 2000, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 1, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "offline_evaluation_interval": null, "num_offline_eval_runners": 0, "offline_loss_for_module_fn": null, "offline_evaluation_duration": 1, "offline_evaluation_parallel_to_training": false, "offline_evaluation_timeout_s": 120.0, "num_cpus_per_offline_eval_runner": 1, "num_gpus_per_offline_eval_runner": 0, "custom_resources_per_offline_eval_runner": {}, "restart_failed_offline_eval_runners": true, "ignore_offline_eval_runner_failures": false, "max_num_offline_eval_runner_restarts": 1000, "offline_eval_runner_restore_timeout_s": 1800.0, "max_requests_in_flight_per_offline_eval_runner": 1, "validate_offline_eval_runners_after_construction": true, "offline_eval_runner_health_probe_timeout_s": 30.0, "offline_eval_rl_module_inference_only": false, "broadcast_offline_eval_runner_states": false, "offline_eval_batch_size_per_runner": 256, "dataset_num_iters_per_eval_runner": 1, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "log_gradients": false, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 9, "restart_failed_env_runners": true, "ignore_env_runner_failures": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30.0, "env_runner_restore_timeout_s": 1800.0, "_model_config": {}, "_rl_module_spec": "MultiRLModuleSpec(multi_rl_module_class=<class 'ray.rllib.core.rl_module.multi_rl_module.MultiRLModule'>, observation_space=None, action_space=None, inference_only=False, model_config=None, rl_module_specs={'default_policy': RLModuleSpec(module_class=<class 'source.intrinsic_attention_ppo.rl_modules.DifferentiablePPOModule.DifferentiablePPOModule'>, observation_space=None, action_space=None, inference_only=False, learner_only=False, model_config={'vf_share_layers': True, 'embedding_dim': 62, 'max_seq_len': 3, 'policy_head_hidden_sizes': [32], 'value_head_hidden_sizes': [101], 'embedding_hidden_sizes': [121]}, catalog_class=None, load_state_path=None, model_config_dict=None), 'intrinsic_reward_module': RLModuleSpec(module_class=<class 'source.intrinsic_attention_ppo.rl_modules.IntrinsicAttentionModule.IntrinsicAttentionModule'>, observation_space=None, action_space=None, inference_only=False, learner_only=True, model_config={'intrinsic_reward_network': {'encoder_hidden_sizes': [], 'encoding_dim': 1, 'num_heads': 1, 'head_hidden_sizes': None, 'layers': [{'type': 'attention'}]}, 'extrinsic_value_hidden_layers': [127, 60], 'vf_share_layers': True, 'max_seq_len': 3}, catalog_class=None, load_state_path=None, model_config_dict=None)}, load_state_path=None, modules_to_load=None, module_specs={'default_policy': RLModuleSpec(module_class=<class 'source.intrinsic_attention_ppo.rl_modules.DifferentiablePPOModule.DifferentiablePPOModule'>, observation_space=None, action_space=None, inference_only=False, learner_only=False, model_config={'vf_share_layers': True, 'embedding_dim': 62, 'max_seq_len': 3, 'policy_head_hidden_sizes': [32], 'value_head_hidden_sizes': [101], 'embedding_hidden_sizes': [121]}, catalog_class=None, load_state_path=None, model_config_dict=None), 'intrinsic_reward_module': RLModuleSpec(module_class=<class 'source.intrinsic_attention_ppo.rl_modules.IntrinsicAttentionModule.IntrinsicAttentionModule'>, observation_space=None, action_space=None, inference_only=False, learner_only=True, model_config={'intrinsic_reward_network': {'encoder_hidden_sizes': [], 'encoding_dim': 1, 'num_heads': 1, 'head_hidden_sizes': None, 'layers': [{'type': 'attention'}]}, 'extrinsic_value_hidden_layers': [127, 60], 'vf_share_layers': True, 'max_seq_len': 3}, catalog_class=None, load_state_path=None, model_config_dict=None)})", "algorithm_config_overrides_per_module": {"intrinsic_reward_module": {"lr": 0.0002715581955}}, "_per_module_overrides": {}, "_validate_config": true, "_use_msgpack_checkpoints": false, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "env_task_fn": -1, "enable_connectors": -1, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.161583927863, "kl_target": 0.0201019014258, "vf_loss_coeff": 0.7790510010087, "entropy_coeff": 0.0015431216992, "clip_param": 0.2459212356676, "vf_clip_param": 0.3769744131561, "entropy_coeff_schedule": null, "lr_schedule": null, "sgd_minibatch_size": -1, "vf_share_layers": -1, "differentiable_learner_configs": ["DifferentiableLearnerConfig(learner_class=<class 'source.intrinsic_attention_ppo.learners.IntrinsicAttentionPPOLearner.IntrinsicAttentionPPOLearner'>, learner_connector=None, add_default_connectors_to_learner_pipeline=True, is_multi_agent=False, policies_to_update=['default_policy'], lr=0.0060984166342, num_total_minibatches=0, num_epochs=1, minibatch_size=1000, shuffle_batch_per_epoch=True)"], "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9485408017724, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.callbacks.callbacks.RLlibCallback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 67.62185764312744, "iterations_since_restore": 6, "perf": {"cpu_util_percent": 43.06875, "ram_util_percent": 79.94375}}
{"timers": {"training_iteration": 10.410079517670999, "restore_env_runners": 6.42213887034092e-05, "training_step": 10.409740774810363, "env_runner_sampling_timer": 1.756829018496401, "learner_update_timer": 8.428839932527515, "synch_weights": 0.0017773546054231963, "restore_eval_env_runners": 5.8496730868236344e-05, "evaluation_iteration": 0.132731286142645, "synch_eval_env_connectors": 0.00018714490838920268, "synch_env_connectors": 4.493422355145495e-06}, "env_runners": {"env_to_module_connector": {"timers": {"connectors": {"numpy_to_tensor": 1.3565645429498795e-05, "add_time_dim_to_batch_and_zero_pad": 7.377958475111201e-06, "batch_individual_items": 1.3097705032287729e-05, "add_observations_from_episodes_to_batch": 3.008827525293534e-06, "add_states_from_episodes_to_batch": 2.892568306366675e-06}}, "connector_pipeline_timer": 6.306825421134276e-05}, "module_to_env_connector": {"timers": {"connectors": {"tensor_to_numpy": 1.5978047723777423e-05, "un_batch_to_individual_items": 6.9988690104094016e-06, "listify_data_for_vector_env": 1.0928395529768107e-05, "get_actions": 4.2283565317870134e-05, "remove_single_ts_time_rank_from_batch": 1.2628407198816488e-05, "normalize_and_clip_actions": 8.564320730194535e-06}}, "connector_pipeline_timer": 0.00012529909742411198}, "module_episode_returns_mean": {"default_policy": 4.66}, "episode_len_min": 20, "env_reset_timer": 4.866385561098459e-05, "agent_episode_returns_mean": {"default_agent": 4.66}, "time_between_sampling": 0.03866161827784913, "env_to_module_sum_episodes_length_out": 10.36823839457432, "num_module_steps_sampled": {"default_policy": 5000.0}, "env_step_timer": 1.5029532155216522e-05, "weights_seq_no": 6.0, "num_env_steps_sampled_lifetime": -3077500.0, "num_agent_steps_sampled": {"default_agent": 5000.0}, "num_episodes_lifetime": -153875.0, "episode_len_mean": 20.0, "episode_duration_sec_mean": 0.005596428019460288, "episode_return_max": 14.5, "episode_len_max": 20, "num_module_steps_sampled_lifetime": {"default_policy": -3077500.0}, "episode_return_min": -5.5, "rlmodule_inference_timer": 3.370541430164083e-05, "episode_return_mean": 4.66, "env_to_module_sum_episodes_length_in": 10.36823839457432, "num_agent_steps_sampled_lifetime": {"default_agent": -3077500.0}, "num_episodes": 250.0, "sample": 0.006003752427171125, "num_env_steps_sampled": 5000.0, "num_env_steps_sampled_lifetime_throughput": 3086.3348331871684}, "__all_modules__": {"learner_connector_sum_episodes_length_in": 5000.0, "learner_connector": {"connector_pipeline_timer": 0.1828194741366438, "timers": {"connectors": {"add_one_ts_to_episodes_and_truncate": 0.009545462376151316, "add_observations_from_episodes_to_batch": 0.0008515007926303272, "add_columns_from_episodes_to_train_batch": 0.04266890751038814, "add_time_dim_to_batch_and_zero_pad": 0.11025772399380081, "add_states_from_episodes_to_batch": 0.00393027946516954, "batch_individual_items": 0.01528743539794913, "numpy_to_tensor": 8.638180519242837e-05}}}, "learner_connector_sum_episodes_length_out": 5250.0}, "learners": {"default_policy": {"num_module_steps_trained_lifetime": 41958, "policy_loss": -9.493772813584656e-05, "diff_num_grad_updates_vs_sampler_policy": 1.0, "num_trainable_parameters": 16595, "mean_kl_loss": 7.814315722498577e-06, "curr_entropy_coeff": 0.0015431216992, "total_loss": 0.20440693199634552, "module_train_batch_size_mean": 999.0, "curr_kl_coeff": 0.0012623744551092386, "use_intrinsic_rewards": 0.0, "weights_seq_no": 7.0, "vf_loss": 0.26387089490890503, "num_module_steps_trained": 5994, "entropy": 0.6914660930633545, "vf_loss_unclipped": 45.704891204833984, "vf_explained_var": -0.0006822347640991211, "num_module_steps_trained_lifetime_throughput": 696.9078601856742}, "intrinsic_reward_module": {"diff_num_grad_updates_vs_sampler_policy": 1.0, "gradients_default_optimizer_global_norm": 0.0, "num_trainable_parameters": 8266, "curr_entropy_coeff": 0.0015431216992, "total_loss": 0.0, "module_train_batch_size_mean": 999.0, "default_optimizer_learning_rate": 0.0002715581955, "weights_seq_no": 7.0, "num_module_steps_trained": 5994, "num_module_steps_trained_lifetime": 41958, "num_module_steps_trained_lifetime_throughput": 696.9175996848509}, "differentiable_learners": {"intrinsic_attention_ppo_learner": {"default_policy": {"policy_loss": -9.273078467231244e-05, "diff_num_grad_updates_vs_sampler_policy": 36.0, "mean_kl_loss": 7.456341336364858e-06, "total_loss": 0.2048443704843521, "module_train_batch_size_mean": 999.0, "use_intrinsic_rewards": 1.0, "weights_seq_no": 42.0, "vf_loss": 0.2644280195236206, "num_module_steps_trained": 35964, "entropy": 0.6914715766906738, "vf_loss_unclipped": 45.456233978271484, "vf_explained_var": 0.002321183681488037, "num_module_steps_trained_lifetime": 251748}, "__all_modules__": {"num_env_steps_trained": 189000, "num_module_steps_trained": 71928, "num_module_steps_trained_lifetime": 503496, "num_env_steps_trained_lifetime": 1323000, "num_env_steps_trained_lifetime_throughput": 46544.81547271902}, "intrinsic_reward_module": {"num_module_steps_trained_lifetime": 251748, "diff_num_grad_updates_vs_sampler_policy": 36.0, "total_loss": 0.0, "module_train_batch_size_mean": 999.0, "weights_seq_no": 42.0, "num_module_steps_trained": 35964}}}, "__all_modules__": {"num_trainable_parameters": 24861, "num_env_steps_trained": 31500, "num_module_steps_trained": 11988, "num_non_trainable_parameters": 0, "num_module_steps_trained_lifetime": 83916, "num_env_steps_trained_lifetime": 220500, "num_env_steps_trained_lifetime_throughput": 3662.551124221385, "num_module_steps_trained_throughput": 23549364.62080733, "num_module_steps_trained_lifetime_throughput": 11058462.960345635}, "IntrinsicAttentionMask": [[[0.3322606086730957, 0.33450692892074585, 0.33323249220848083], [0.3317698836326599, 0.33504459261894226, 0.33318549394607544], [0.33204784989356995, 0.33473995327949524, 0.3332121968269348]], [[0.33356210589408875, 0.33426234126091003, 0.332175612449646], [0.3336501121520996, 0.33462220430374146, 0.33172765374183655], [0.33338630199432373, 0.3335476219654083, 0.33306610584259033]], [[0.3337802588939667, 0.3325550854206085, 0.33366474509239197], [0.33365997672080994, 0.3327644467353821, 0.333575576543808], [0.33376890420913696, 0.3325747549533844, 0.33365631103515625]], [[0.33179906010627747, 0.3365257978439331, 0.33167514204978943], [0.3304286301136017, 0.3393758237361908, 0.3301955461502075], [0.33183518052101135, 0.3364506959915161, 0.3317141532897949]], [[0.33282479643821716, 0.333607941865921, 0.33356723189353943], [0.3326491713523865, 0.33370280265808105, 0.3336479961872101], [0.3326583206653595, 0.3336979150772095, 0.3336438238620758]], [[0.33992907404899597, 0.32112517952919006, 0.33894577622413635], [0.24480675160884857, 0.5012899041175842, 0.25390341877937317], [0.33537501096725464, 0.32954904437065125, 0.3350759744644165]]]}, "num_training_step_calls_per_iteration": 1, "evaluation": {"env_runners": {"env_to_module_connector": {"timers": {"connectors": {"add_observations_from_episodes_to_batch": 2.802410634402608e-06, "numpy_to_tensor": 1.2173784095285802e-05, "batch_individual_items": 1.2463181967567747e-05, "add_states_from_episodes_to_batch": 2.8242764345042303e-06, "add_time_dim_to_batch_and_zero_pad": 6.8754478834494226e-06}}, "connector_pipeline_timer": 5.934097678890059e-05}, "num_module_steps_sampled_lifetime": {"default_policy": 2800}, "num_env_steps_sampled_lifetime": 35400, "weights_seq_no": 7.0, "module_to_env_connector": {"timers": {"connectors": {"get_actions": 3.700635109790689e-05, "un_batch_to_individual_items": 6.607030365040647e-06, "listify_data_for_vector_env": 1.0586117763392592e-05, "remove_single_ts_time_rank_from_batch": 1.2092197814238182e-05, "normalize_and_clip_actions": 8.040137554647893e-06, "tensor_to_numpy": 1.5216819701675128e-05}}, "connector_pipeline_timer": 0.00011633542243497212}, "episode_return_min": -13.5, "rlmodule_inference_timer": 3.14992435058607e-05, "num_episodes": 20, "num_agent_steps_sampled": {"default_agent": 400}, "num_env_steps_sampled": 400, "episode_len_max": 20, "env_to_module_sum_episodes_length_in": 10.368238394572801, "agent_episode_returns_mean": {"default_agent": 0.7}, "env_reset_timer": 0.0005784106078018793, "episode_len_min": 20, "env_to_module_sum_episodes_length_out": 10.368238394572801, "env_step_timer": 1.4195796534540256e-05, "episode_len_mean": 20.0, "episode_duration_sec_mean": 0.007313613764708861, "num_module_steps_sampled": {"default_policy": 400}, "module_episode_returns_mean": {"default_policy": 0.7}, "sample": 0.12089141546920536, "num_agent_steps_sampled_lifetime": {"default_agent": 2800}, "num_episodes_lifetime": 140, "episode_return_max": 15.5, "episode_return_mean": 0.7, "time_between_sampling": 11.12632181075241}, "num_healthy_workers": 1, "actor_manager_num_outstanding_async_reqs": 0, "num_remote_worker_restarts": 0}, "num_env_steps_sampled_lifetime": -3077500.0, "fault_tolerance": {"num_healthy_workers": 0, "num_remote_worker_restarts": 0}, "env_runner_group": {"actor_manager_num_outstanding_async_reqs": 0}, "done": false, "training_iteration": 7, "trial_id": "b7d6e_00000", "date": "2025-08-11_18-09-26", "timestamp": 1754928566, "time_this_iter_s": 10.626380681991577, "time_total_s": 78.24823832511902, "pid": 10343, "hostname": "Mac", "node_ip": "127.0.0.1", "config": {"exploration_config": {}, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 2, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "env": "Umbrella", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": false, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 0, "create_local_env_runner": true, "num_envs_per_env_runner": 1, "gym_env_vectorize_mode": "SYNC", "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "episodes_to_numpy": true, "max_requests_in_flight_per_env_runner": 1, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "merge_env_runner_states": "training_only", "broadcast_env_runner_states": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "complete_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "sampler_perf_stats_ema_coef": null, "_is_online": true, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": "auto", "num_aggregator_actors_per_learner": 0, "max_requests_in_flight_per_aggregator_actor": 3, "local_gpu_idx": 0, "max_requests_in_flight_per_learner": 3, "gamma": 1, "lr": 0.0002715581955, "grad_clip": 0.5, "grad_clip_by": "global_norm", "_train_batch_size_per_learner": 5000, "train_batch_size": 4000, "num_epochs": 1, "minibatch_size": 1000, "shuffle_batch_per_epoch": true, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "log_std_clip_param": 20.0, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "_disable_preprocessor_api": false, "_disable_action_flattening": false}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {"intrinsic_reward_coeff": 0.2795015916508}, "optimizer": {}, "_learner_class": "<class 'source.intrinsic_attention_ppo.learners.IntrinsicAttentionMetaLearner.IntrinsicAttentionMetaLearner'>", "callbacks_on_algorithm_init": null, "callbacks_on_env_runners_recreated": null, "callbacks_on_offline_eval_runners_recreated": null, "callbacks_on_checkpoint_loaded": null, "callbacks_on_environment_created": null, "callbacks_on_episode_created": null, "callbacks_on_episode_start": null, "callbacks_on_episode_step": null, "callbacks_on_episode_end": null, "callbacks_on_evaluate_start": null, "callbacks_on_evaluate_end": null, "callbacks_on_evaluate_offline_start": null, "callbacks_on_evaluate_offline_end": null, "callbacks_on_sample_end": null, "callbacks_on_train_result": null, "explore": true, "enable_rl_module_and_learner": true, "enable_env_runner_and_connector_v2": true, "_prior_exploration_config": {"type": "StochasticSampling"}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x1616f98a0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "offline_data_class": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_read_batch_size": null, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "materialize_data": false, "materialize_mapped_data": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "ignore_final_observation": false, "prelearner_class": null, "prelearner_buffer_class": null, "prelearner_buffer_kwargs": {}, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_remaining_data": false, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": 1, "evaluation_duration": 20, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_auto_duration_min_env_steps_per_sample": 100, "evaluation_auto_duration_max_env_steps_per_sample": 2000, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 1, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "offline_evaluation_interval": null, "num_offline_eval_runners": 0, "offline_loss_for_module_fn": null, "offline_evaluation_duration": 1, "offline_evaluation_parallel_to_training": false, "offline_evaluation_timeout_s": 120.0, "num_cpus_per_offline_eval_runner": 1, "num_gpus_per_offline_eval_runner": 0, "custom_resources_per_offline_eval_runner": {}, "restart_failed_offline_eval_runners": true, "ignore_offline_eval_runner_failures": false, "max_num_offline_eval_runner_restarts": 1000, "offline_eval_runner_restore_timeout_s": 1800.0, "max_requests_in_flight_per_offline_eval_runner": 1, "validate_offline_eval_runners_after_construction": true, "offline_eval_runner_health_probe_timeout_s": 30.0, "offline_eval_rl_module_inference_only": false, "broadcast_offline_eval_runner_states": false, "offline_eval_batch_size_per_runner": 256, "dataset_num_iters_per_eval_runner": 1, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "log_gradients": false, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 9, "restart_failed_env_runners": true, "ignore_env_runner_failures": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30.0, "env_runner_restore_timeout_s": 1800.0, "_model_config": {}, "_rl_module_spec": "MultiRLModuleSpec(multi_rl_module_class=<class 'ray.rllib.core.rl_module.multi_rl_module.MultiRLModule'>, observation_space=None, action_space=None, inference_only=False, model_config=None, rl_module_specs={'default_policy': RLModuleSpec(module_class=<class 'source.intrinsic_attention_ppo.rl_modules.DifferentiablePPOModule.DifferentiablePPOModule'>, observation_space=None, action_space=None, inference_only=False, learner_only=False, model_config={'vf_share_layers': True, 'embedding_dim': 62, 'max_seq_len': 3, 'policy_head_hidden_sizes': [32], 'value_head_hidden_sizes': [101], 'embedding_hidden_sizes': [121]}, catalog_class=None, load_state_path=None, model_config_dict=None), 'intrinsic_reward_module': RLModuleSpec(module_class=<class 'source.intrinsic_attention_ppo.rl_modules.IntrinsicAttentionModule.IntrinsicAttentionModule'>, observation_space=None, action_space=None, inference_only=False, learner_only=True, model_config={'intrinsic_reward_network': {'encoder_hidden_sizes': [], 'encoding_dim': 1, 'num_heads': 1, 'head_hidden_sizes': None, 'layers': [{'type': 'attention'}]}, 'extrinsic_value_hidden_layers': [127, 60], 'vf_share_layers': True, 'max_seq_len': 3}, catalog_class=None, load_state_path=None, model_config_dict=None)}, load_state_path=None, modules_to_load=None, module_specs={'default_policy': RLModuleSpec(module_class=<class 'source.intrinsic_attention_ppo.rl_modules.DifferentiablePPOModule.DifferentiablePPOModule'>, observation_space=None, action_space=None, inference_only=False, learner_only=False, model_config={'vf_share_layers': True, 'embedding_dim': 62, 'max_seq_len': 3, 'policy_head_hidden_sizes': [32], 'value_head_hidden_sizes': [101], 'embedding_hidden_sizes': [121]}, catalog_class=None, load_state_path=None, model_config_dict=None), 'intrinsic_reward_module': RLModuleSpec(module_class=<class 'source.intrinsic_attention_ppo.rl_modules.IntrinsicAttentionModule.IntrinsicAttentionModule'>, observation_space=None, action_space=None, inference_only=False, learner_only=True, model_config={'intrinsic_reward_network': {'encoder_hidden_sizes': [], 'encoding_dim': 1, 'num_heads': 1, 'head_hidden_sizes': None, 'layers': [{'type': 'attention'}]}, 'extrinsic_value_hidden_layers': [127, 60], 'vf_share_layers': True, 'max_seq_len': 3}, catalog_class=None, load_state_path=None, model_config_dict=None)})", "algorithm_config_overrides_per_module": {"intrinsic_reward_module": {"lr": 0.0002715581955}}, "_per_module_overrides": {}, "_validate_config": true, "_use_msgpack_checkpoints": false, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "env_task_fn": -1, "enable_connectors": -1, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.161583927863, "kl_target": 0.0201019014258, "vf_loss_coeff": 0.7790510010087, "entropy_coeff": 0.0015431216992, "clip_param": 0.2459212356676, "vf_clip_param": 0.3769744131561, "entropy_coeff_schedule": null, "lr_schedule": null, "sgd_minibatch_size": -1, "vf_share_layers": -1, "differentiable_learner_configs": ["DifferentiableLearnerConfig(learner_class=<class 'source.intrinsic_attention_ppo.learners.IntrinsicAttentionPPOLearner.IntrinsicAttentionPPOLearner'>, learner_connector=None, add_default_connectors_to_learner_pipeline=True, is_multi_agent=False, policies_to_update=['default_policy'], lr=0.0060984166342, num_total_minibatches=0, num_epochs=1, minibatch_size=1000, shuffle_batch_per_epoch=True)"], "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9485408017724, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.callbacks.callbacks.RLlibCallback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 78.24823832511902, "iterations_since_restore": 7, "perf": {"cpu_util_percent": 40.980000000000004, "ram_util_percent": 80.79333333333334}}
{"timers": {"training_iteration": 10.435357230403422, "restore_env_runners": 6.364084466895972e-05, "training_step": 10.435019275811904, "env_runner_sampling_timer": 1.763460849560742, "learner_update_timer": 8.447325616531371, "synch_weights": 0.0017750623087982498, "restore_eval_env_runners": 5.833884248090184e-05, "evaluation_iteration": 0.13265393078147703, "synch_eval_env_connectors": 0.0001873372095946912, "synch_env_connectors": 4.4934884742462415e-06}, "env_runners": {"env_to_module_connector": {"timers": {"connectors": {"numpy_to_tensor": 1.9699565622065826e-05, "add_time_dim_to_batch_and_zero_pad": 1.005548786621079e-05, "batch_individual_items": 1.8428047979586365e-05, "add_observations_from_episodes_to_batch": 3.896718164182345e-06, "add_states_from_episodes_to_batch": 3.5952133651790674e-06}}, "connector_pipeline_timer": 8.527969456990247e-05}, "module_to_env_connector": {"timers": {"connectors": {"tensor_to_numpy": 2.1792366093606463e-05, "un_batch_to_individual_items": 9.543086705789582e-06, "listify_data_for_vector_env": 1.4320522516287901e-05, "get_actions": 6.377587366953259e-05, "remove_single_ts_time_rank_from_batch": 1.5137349941868125e-05, "normalize_and_clip_actions": 1.0757012136302704e-05}}, "connector_pipeline_timer": 0.00017103548539789372}, "module_episode_returns_mean": {"default_policy": 5.14}, "episode_len_min": 20, "env_reset_timer": 7.305003725232683e-05, "agent_episode_returns_mean": {"default_agent": 5.14}, "time_between_sampling": 0.03629693129717707, "env_to_module_sum_episodes_length_out": 10.36823839457432, "num_module_steps_sampled": {"default_policy": 5000.0}, "env_step_timer": 2.1563901677220326e-05, "weights_seq_no": 7.0, "num_env_steps_sampled_lifetime": -3695000.0, "num_agent_steps_sampled": {"default_agent": 5000.0}, "num_episodes_lifetime": -184750.0, "episode_len_mean": 20.0, "episode_duration_sec_mean": 0.008381879379972814, "episode_return_max": 14.5, "episode_len_max": 20, "num_module_steps_sampled_lifetime": {"default_policy": -3695000.0}, "episode_return_min": -5.5, "rlmodule_inference_timer": 8.049297606465968e-05, "episode_return_mean": 5.14, "env_to_module_sum_episodes_length_in": 10.36823839457432, "num_agent_steps_sampled_lifetime": {"default_agent": -3695000.0}, "num_episodes": 250.0, "sample": 0.007777382958655729, "num_env_steps_sampled": 5000.0, "num_env_steps_sampled_lifetime_throughput": 2570.5613541894368}, "__all_modules__": {"learner_connector_sum_episodes_length_in": 5000.0, "learner_connector": {"connector_pipeline_timer": 0.18285679355471274, "timers": {"connectors": {"add_one_ts_to_episodes_and_truncate": 0.009550805663098736, "add_observations_from_episodes_to_batch": 0.0008519395339062158, "add_columns_from_episodes_to_train_batch": 0.04270953551517664, "add_time_dim_to_batch_and_zero_pad": 0.11023931092301413, "add_states_from_episodes_to_batch": 0.003932395840383393, "batch_individual_items": 0.01529545063459436, "numpy_to_tensor": 8.621548721292373e-05}}}, "learner_connector_sum_episodes_length_out": 5250.0}, "learners": {"default_policy": {"num_module_steps_trained_lifetime": 47952, "policy_loss": -0.0001359412126475945, "diff_num_grad_updates_vs_sampler_policy": 1.0, "num_trainable_parameters": 16595, "mean_kl_loss": 4.988071850675624e-06, "curr_entropy_coeff": 0.0015431216992, "total_loss": 0.20438607037067413, "module_train_batch_size_mean": 999.0, "curr_kl_coeff": 0.0006311872275546193, "use_intrinsic_rewards": 0.0, "weights_seq_no": 8.0, "vf_loss": 0.26389631628990173, "num_module_steps_trained": 5994, "entropy": 0.691248893737793, "vf_loss_unclipped": 44.32073211669922, "vf_explained_var": -0.000586390495300293, "num_module_steps_trained_lifetime_throughput": 692.8418964607641}, "intrinsic_reward_module": {"diff_num_grad_updates_vs_sampler_policy": 1.0, "gradients_default_optimizer_global_norm": 0.0, "num_trainable_parameters": 8266, "curr_entropy_coeff": 0.0015431216992, "total_loss": 0.0, "module_train_batch_size_mean": 999.0, "default_optimizer_learning_rate": 0.0002715581955, "weights_seq_no": 8.0, "num_module_steps_trained": 5994, "num_module_steps_trained_lifetime": 47952, "num_module_steps_trained_lifetime_throughput": 692.8512525279774}, "differentiable_learners": {"intrinsic_attention_ppo_learner": {"default_policy": {"policy_loss": -0.00012806462473236024, "diff_num_grad_updates_vs_sampler_policy": 41.0, "mean_kl_loss": 4.378480753075564e-06, "total_loss": 0.20465363562107086, "module_train_batch_size_mean": 999.0, "use_intrinsic_rewards": 1.0, "weights_seq_no": 48.0, "vf_loss": 0.26422879099845886, "num_module_steps_trained": 35964, "entropy": 0.6912610530853271, "vf_loss_unclipped": 44.09322738647461, "vf_explained_var": 0.0022884607315063477, "num_module_steps_trained_lifetime": 287712}, "__all_modules__": {"num_env_steps_trained": 189000, "num_module_steps_trained": 71928, "num_module_steps_trained_lifetime": 575424, "num_env_steps_trained_lifetime": 1512000, "num_env_steps_trained_lifetime_throughput": 45709.37057343024}, "intrinsic_reward_module": {"num_module_steps_trained_lifetime": 287712, "diff_num_grad_updates_vs_sampler_policy": 41.0, "total_loss": 0.0, "module_train_batch_size_mean": 999.0, "weights_seq_no": 48.0, "num_module_steps_trained": 35964}}}, "__all_modules__": {"num_trainable_parameters": 24861, "num_env_steps_trained": 31500, "num_module_steps_trained": 11988, "num_non_trainable_parameters": 0, "num_module_steps_trained_lifetime": 95904, "num_env_steps_trained_lifetime": 252000, "num_env_steps_trained_lifetime_throughput": 3641.177891819466, "num_module_steps_trained_throughput": 22909746.27500929, "num_module_steps_trained_lifetime_throughput": 11059740.969024828}, "IntrinsicAttentionMask": [[[0.3318576514720917, 0.33410122990608215, 0.33404120802879333], [0.3311832547187805, 0.33445215225219727, 0.3343645930290222], [0.3312012255191803, 0.33444279432296753, 0.3343559503555298]], [[0.3357151746749878, 0.3355938196182251, 0.3286910057067871], [0.33570078015327454, 0.33558017015457153, 0.32871904969215393], [0.33487242460250854, 0.334794282913208, 0.33033326268196106]], [[0.33193114399909973, 0.3340907096862793, 0.33397814631462097], [0.33175572752952576, 0.33418548107147217, 0.3340587913990021], [0.3317648470401764, 0.3341805636882782, 0.3340546190738678]], [[0.332221120595932, 0.33568185567855835, 0.33209702372550964], [0.3314944803714752, 0.33721548318862915, 0.331290066242218], [0.332247257232666, 0.33562663197517395, 0.33212608098983765]], [[0.33514684438705444, 0.33248889446258545, 0.3323643207550049], [0.33492112159729004, 0.33259397745132446, 0.3324848711490631], [0.33491051197052, 0.3325989544391632, 0.33249056339263916]], [[0.31302177906036377, 0.3772372007369995, 0.30974099040031433], [0.2372428923845291, 0.536189615726471, 0.2265675663948059], [0.3169960379600525, 0.36870095133781433, 0.31430307030677795]]]}, "num_training_step_calls_per_iteration": 1, "evaluation": {"env_runners": {"env_to_module_connector": {"timers": {"connectors": {"add_observations_from_episodes_to_batch": 2.8122098731224484e-06, "numpy_to_tensor": 1.2202655289582646e-05, "batch_individual_items": 1.2411028411392256e-05, "add_states_from_episodes_to_batch": 2.796940365734379e-06, "add_time_dim_to_batch_and_zero_pad": 7.072483941857036e-06}}, "connector_pipeline_timer": 5.958822167010407e-05}, "num_module_steps_sampled_lifetime": {"default_policy": 3200}, "num_env_steps_sampled_lifetime": 40400, "weights_seq_no": 8.0, "module_to_env_connector": {"timers": {"connectors": {"get_actions": 3.729717856313875e-05, "un_batch_to_individual_items": 6.512878996478102e-06, "listify_data_for_vector_env": 1.0617089418741515e-05, "remove_single_ts_time_rank_from_batch": 1.1971396854421828e-05, "normalize_and_clip_actions": 8.110168923075892e-06, "tensor_to_numpy": 1.541813022790977e-05}}, "connector_pipeline_timer": 0.00011643946975659731}, "episode_return_min": -13.5, "rlmodule_inference_timer": 3.154309925507407e-05, "num_episodes": 20, "num_agent_steps_sampled": {"default_agent": 400}, "num_env_steps_sampled": 400, "episode_len_max": 20, "env_to_module_sum_episodes_length_in": 10.3682383945743, "agent_episode_returns_mean": {"default_agent": 0.7}, "env_reset_timer": 0.0005757410819006312, "episode_len_min": 20, "env_to_module_sum_episodes_length_out": 10.3682383945743, "env_step_timer": 1.4020560883277865e-05, "episode_len_mean": 20.0, "episode_duration_sec_mean": 0.0071922429522965105, "num_module_steps_sampled": {"default_policy": 400}, "module_episode_returns_mean": {"default_policy": 0.7}, "sample": 0.12085812965508355, "num_agent_steps_sampled_lifetime": {"default_agent": 3200}, "num_episodes_lifetime": 160, "episode_return_max": 15.5, "episode_return_mean": 0.7, "time_between_sampling": 11.144723016394668}, "num_healthy_workers": 1, "actor_manager_num_outstanding_async_reqs": 0, "num_remote_worker_restarts": 0}, "num_env_steps_sampled_lifetime": -3695000.0, "fault_tolerance": {"num_healthy_workers": 0, "num_remote_worker_restarts": 0}, "env_runner_group": {"actor_manager_num_outstanding_async_reqs": 0}, "done": false, "training_iteration": 8, "trial_id": "b7d6e_00000", "date": "2025-08-11_18-09-40", "timestamp": 1754928580, "time_this_iter_s": 13.066759824752808, "time_total_s": 91.31499814987183, "pid": 10343, "hostname": "Mac", "node_ip": "127.0.0.1", "config": {"exploration_config": {}, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 2, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "env": "Umbrella", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": false, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 0, "create_local_env_runner": true, "num_envs_per_env_runner": 1, "gym_env_vectorize_mode": "SYNC", "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "episodes_to_numpy": true, "max_requests_in_flight_per_env_runner": 1, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "merge_env_runner_states": "training_only", "broadcast_env_runner_states": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "complete_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "sampler_perf_stats_ema_coef": null, "_is_online": true, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": "auto", "num_aggregator_actors_per_learner": 0, "max_requests_in_flight_per_aggregator_actor": 3, "local_gpu_idx": 0, "max_requests_in_flight_per_learner": 3, "gamma": 1, "lr": 0.0002715581955, "grad_clip": 0.5, "grad_clip_by": "global_norm", "_train_batch_size_per_learner": 5000, "train_batch_size": 4000, "num_epochs": 1, "minibatch_size": 1000, "shuffle_batch_per_epoch": true, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "log_std_clip_param": 20.0, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "_disable_preprocessor_api": false, "_disable_action_flattening": false}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {"intrinsic_reward_coeff": 0.2795015916508}, "optimizer": {}, "_learner_class": "<class 'source.intrinsic_attention_ppo.learners.IntrinsicAttentionMetaLearner.IntrinsicAttentionMetaLearner'>", "callbacks_on_algorithm_init": null, "callbacks_on_env_runners_recreated": null, "callbacks_on_offline_eval_runners_recreated": null, "callbacks_on_checkpoint_loaded": null, "callbacks_on_environment_created": null, "callbacks_on_episode_created": null, "callbacks_on_episode_start": null, "callbacks_on_episode_step": null, "callbacks_on_episode_end": null, "callbacks_on_evaluate_start": null, "callbacks_on_evaluate_end": null, "callbacks_on_evaluate_offline_start": null, "callbacks_on_evaluate_offline_end": null, "callbacks_on_sample_end": null, "callbacks_on_train_result": null, "explore": true, "enable_rl_module_and_learner": true, "enable_env_runner_and_connector_v2": true, "_prior_exploration_config": {"type": "StochasticSampling"}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x1616f98a0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "offline_data_class": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_read_batch_size": null, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "materialize_data": false, "materialize_mapped_data": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "ignore_final_observation": false, "prelearner_class": null, "prelearner_buffer_class": null, "prelearner_buffer_kwargs": {}, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_remaining_data": false, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": 1, "evaluation_duration": 20, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_auto_duration_min_env_steps_per_sample": 100, "evaluation_auto_duration_max_env_steps_per_sample": 2000, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 1, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "offline_evaluation_interval": null, "num_offline_eval_runners": 0, "offline_loss_for_module_fn": null, "offline_evaluation_duration": 1, "offline_evaluation_parallel_to_training": false, "offline_evaluation_timeout_s": 120.0, "num_cpus_per_offline_eval_runner": 1, "num_gpus_per_offline_eval_runner": 0, "custom_resources_per_offline_eval_runner": {}, "restart_failed_offline_eval_runners": true, "ignore_offline_eval_runner_failures": false, "max_num_offline_eval_runner_restarts": 1000, "offline_eval_runner_restore_timeout_s": 1800.0, "max_requests_in_flight_per_offline_eval_runner": 1, "validate_offline_eval_runners_after_construction": true, "offline_eval_runner_health_probe_timeout_s": 30.0, "offline_eval_rl_module_inference_only": false, "broadcast_offline_eval_runner_states": false, "offline_eval_batch_size_per_runner": 256, "dataset_num_iters_per_eval_runner": 1, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "log_gradients": false, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 9, "restart_failed_env_runners": true, "ignore_env_runner_failures": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30.0, "env_runner_restore_timeout_s": 1800.0, "_model_config": {}, "_rl_module_spec": "MultiRLModuleSpec(multi_rl_module_class=<class 'ray.rllib.core.rl_module.multi_rl_module.MultiRLModule'>, observation_space=None, action_space=None, inference_only=False, model_config=None, rl_module_specs={'default_policy': RLModuleSpec(module_class=<class 'source.intrinsic_attention_ppo.rl_modules.DifferentiablePPOModule.DifferentiablePPOModule'>, observation_space=None, action_space=None, inference_only=False, learner_only=False, model_config={'vf_share_layers': True, 'embedding_dim': 62, 'max_seq_len': 3, 'policy_head_hidden_sizes': [32], 'value_head_hidden_sizes': [101], 'embedding_hidden_sizes': [121]}, catalog_class=None, load_state_path=None, model_config_dict=None), 'intrinsic_reward_module': RLModuleSpec(module_class=<class 'source.intrinsic_attention_ppo.rl_modules.IntrinsicAttentionModule.IntrinsicAttentionModule'>, observation_space=None, action_space=None, inference_only=False, learner_only=True, model_config={'intrinsic_reward_network': {'encoder_hidden_sizes': [], 'encoding_dim': 1, 'num_heads': 1, 'head_hidden_sizes': None, 'layers': [{'type': 'attention'}]}, 'extrinsic_value_hidden_layers': [127, 60], 'vf_share_layers': True, 'max_seq_len': 3}, catalog_class=None, load_state_path=None, model_config_dict=None)}, load_state_path=None, modules_to_load=None, module_specs={'default_policy': RLModuleSpec(module_class=<class 'source.intrinsic_attention_ppo.rl_modules.DifferentiablePPOModule.DifferentiablePPOModule'>, observation_space=None, action_space=None, inference_only=False, learner_only=False, model_config={'vf_share_layers': True, 'embedding_dim': 62, 'max_seq_len': 3, 'policy_head_hidden_sizes': [32], 'value_head_hidden_sizes': [101], 'embedding_hidden_sizes': [121]}, catalog_class=None, load_state_path=None, model_config_dict=None), 'intrinsic_reward_module': RLModuleSpec(module_class=<class 'source.intrinsic_attention_ppo.rl_modules.IntrinsicAttentionModule.IntrinsicAttentionModule'>, observation_space=None, action_space=None, inference_only=False, learner_only=True, model_config={'intrinsic_reward_network': {'encoder_hidden_sizes': [], 'encoding_dim': 1, 'num_heads': 1, 'head_hidden_sizes': None, 'layers': [{'type': 'attention'}]}, 'extrinsic_value_hidden_layers': [127, 60], 'vf_share_layers': True, 'max_seq_len': 3}, catalog_class=None, load_state_path=None, model_config_dict=None)})", "algorithm_config_overrides_per_module": {"intrinsic_reward_module": {"lr": 0.0002715581955}}, "_per_module_overrides": {}, "_validate_config": true, "_use_msgpack_checkpoints": false, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "env_task_fn": -1, "enable_connectors": -1, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.161583927863, "kl_target": 0.0201019014258, "vf_loss_coeff": 0.7790510010087, "entropy_coeff": 0.0015431216992, "clip_param": 0.2459212356676, "vf_clip_param": 0.3769744131561, "entropy_coeff_schedule": null, "lr_schedule": null, "sgd_minibatch_size": -1, "vf_share_layers": -1, "differentiable_learner_configs": ["DifferentiableLearnerConfig(learner_class=<class 'source.intrinsic_attention_ppo.learners.IntrinsicAttentionPPOLearner.IntrinsicAttentionPPOLearner'>, learner_connector=None, add_default_connectors_to_learner_pipeline=True, is_multi_agent=False, policies_to_update=['default_policy'], lr=0.0060984166342, num_total_minibatches=0, num_epochs=1, minibatch_size=1000, shuffle_batch_per_epoch=True)"], "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9485408017724, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.callbacks.callbacks.RLlibCallback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 91.31499814987183, "iterations_since_restore": 8, "perf": {"cpu_util_percent": 51.17368421052632, "ram_util_percent": 81.41578947368421}}
{"timers": {"training_iteration": 10.439925263939248, "restore_env_runners": 6.30615169828683e-05, "training_step": 10.439588212644288, "env_runner_sampling_timer": 1.7614334518947559, "learner_update_timer": 8.45261903370582, "synch_weights": 0.0017714954363192033, "restore_eval_env_runners": 5.8139624618121704e-05, "evaluation_iteration": 0.13258661105375938, "synch_eval_env_connectors": 0.00018717466775508717, "synch_env_connectors": 4.49271341353239e-06}, "env_runners": {"env_to_module_connector": {"timers": {"connectors": {"numpy_to_tensor": 1.3041754883399523e-05, "add_time_dim_to_batch_and_zero_pad": 7.072684557369266e-06, "batch_individual_items": 1.2558623696777839e-05, "add_observations_from_episodes_to_batch": 2.9078397875172067e-06, "add_states_from_episodes_to_batch": 2.795432330050215e-06}}, "connector_pipeline_timer": 6.0859890047591626e-05}, "module_to_env_connector": {"timers": {"connectors": {"tensor_to_numpy": 1.5363924004392516e-05, "un_batch_to_individual_items": 6.706919840289876e-06, "listify_data_for_vector_env": 1.0564532110402375e-05, "get_actions": 3.957804998836948e-05, "remove_single_ts_time_rank_from_batch": 1.2137249143194462e-05, "normalize_and_clip_actions": 8.187095105518531e-06}}, "connector_pipeline_timer": 0.00011964924946918562}, "module_episode_returns_mean": {"default_policy": 6.74}, "episode_len_min": 20, "env_reset_timer": 5.38543077311804e-05, "agent_episode_returns_mean": {"default_agent": 6.74}, "time_between_sampling": 0.04268421460775062, "env_to_module_sum_episodes_length_out": 10.36823839457432, "num_module_steps_sampled": {"default_policy": 5000.0}, "env_step_timer": 1.4255684976466989e-05, "weights_seq_no": 8.0, "num_env_steps_sampled_lifetime": -4312500.0, "num_agent_steps_sampled": {"default_agent": 5000.0}, "num_episodes_lifetime": -215625.0, "episode_len_mean": 20.0, "episode_duration_sec_mean": 0.00535385931842029, "episode_return_max": 14.5, "episode_len_max": 20, "num_module_steps_sampled_lifetime": {"default_policy": -4312500.0}, "episode_return_min": -5.5, "rlmodule_inference_timer": 3.1728693834713145e-05, "episode_return_mean": 6.74, "env_to_module_sum_episodes_length_in": 10.36823839457432, "num_agent_steps_sampled_lifetime": {"default_agent": -4312500.0}, "num_episodes": 250.0, "sample": 0.006793926917121284, "num_env_steps_sampled": 5000.0, "num_env_steps_sampled_lifetime_throughput": 3205.6597524840945}, "__all_modules__": {"learner_connector_sum_episodes_length_in": 5000.0, "learner_connector": {"connector_pipeline_timer": 0.18404749729023914, "timers": {"connectors": {"add_one_ts_to_episodes_and_truncate": 0.009549959277204718, "add_observations_from_episodes_to_batch": 0.000852955547611628, "add_columns_from_episodes_to_train_batch": 0.04270504099023152, "add_time_dim_to_batch_and_zero_pad": 0.11018145864280919, "add_states_from_episodes_to_batch": 0.0039317631311899465, "batch_individual_items": 0.01654970237767174, "numpy_to_tensor": 8.616792177975446e-05}}}, "learner_connector_sum_episodes_length_out": 5250.0}, "learners": {"default_policy": {"num_module_steps_trained_lifetime": 53946, "policy_loss": -0.00020868219144176692, "diff_num_grad_updates_vs_sampler_policy": 1.0, "num_trainable_parameters": 16595, "mean_kl_loss": 1.0568111974862404e-05, "curr_entropy_coeff": 0.0015431216992, "total_loss": 0.20430338382720947, "module_train_batch_size_mean": 999.0, "curr_kl_coeff": 0.00031559361377730966, "use_intrinsic_rewards": 0.0, "weights_seq_no": 9.0, "vf_loss": 0.2638830840587616, "num_module_steps_trained": 5994, "entropy": 0.691028356552124, "vf_loss_unclipped": 46.45376968383789, "vf_explained_var": -0.00017547607421875, "num_module_steps_trained_lifetime_throughput": 688.857311202886}, "intrinsic_reward_module": {"diff_num_grad_updates_vs_sampler_policy": 1.0, "gradients_default_optimizer_global_norm": 0.0, "num_trainable_parameters": 8266, "curr_entropy_coeff": 0.0015431216992, "total_loss": 0.0, "module_train_batch_size_mean": 999.0, "default_optimizer_learning_rate": 0.0002715581955, "weights_seq_no": 9.0, "num_module_steps_trained": 5994, "num_module_steps_trained_lifetime": 53946, "num_module_steps_trained_lifetime_throughput": 688.8662448748983}, "differentiable_learners": {"intrinsic_attention_ppo_learner": {"default_policy": {"policy_loss": -0.00019960047211498022, "diff_num_grad_updates_vs_sampler_policy": 46.0, "mean_kl_loss": 9.568964742356911e-06, "total_loss": 0.20451337099075317, "module_train_batch_size_mean": 999.0, "use_intrinsic_rewards": 1.0, "weights_seq_no": 54.0, "vf_loss": 0.2641390264034271, "num_module_steps_trained": 35964, "entropy": 0.6910428404808044, "vf_loss_unclipped": 46.222328186035156, "vf_explained_var": 0.0022819042205810547, "num_module_steps_trained_lifetime": 323676}, "__all_modules__": {"num_env_steps_trained": 189000, "num_module_steps_trained": 71928, "num_module_steps_trained_lifetime": 647352, "num_env_steps_trained_lifetime": 1701000, "num_env_steps_trained_lifetime_throughput": 44877.41915138809}, "intrinsic_reward_module": {"num_module_steps_trained_lifetime": 323676, "diff_num_grad_updates_vs_sampler_policy": 46.0, "total_loss": 0.0, "module_train_batch_size_mean": 999.0, "weights_seq_no": 54.0, "num_module_steps_trained": 35964}}}, "__all_modules__": {"num_trainable_parameters": 24861, "num_env_steps_trained": 31500, "num_module_steps_trained": 11988, "num_non_trainable_parameters": 0, "num_module_steps_trained_lifetime": 107892, "num_env_steps_trained_lifetime": 283500, "num_env_steps_trained_lifetime_throughput": 3620.2327783649807, "num_module_steps_trained_throughput": 22326289.25621982, "num_module_steps_trained_lifetime_throughput": 11059747.938811818}, "IntrinsicAttentionMask": [[[0.3322606086730957, 0.33450692892074585, 0.33323249220848083], [0.3317698836326599, 0.33504459261894226, 0.33318549394607544], [0.33204784989356995, 0.33473995327949524, 0.3332121968269348]], [[0.3350366950035095, 0.3339468538761139, 0.3310164511203766], [0.33451923727989197, 0.3337612748146057, 0.3317194879055023], [0.3331194519996643, 0.3332557678222656, 0.33362483978271484]], [[0.33279743790626526, 0.3336227536201477, 0.33357980847358704], [0.33262181282043457, 0.33371761441230774, 0.3336605727672577], [0.3326309323310852, 0.33371269702911377, 0.3336564004421234]], [[0.3331969678401947, 0.3336213231086731, 0.3331817090511322], [0.33247295022010803, 0.3351503312587738, 0.3323768079280853], [0.33322304487228394, 0.333566278219223, 0.33321067690849304]], [[0.33195847272872925, 0.334075927734375, 0.33396559953689575], [0.3317830562591553, 0.33417069911956787, 0.33404624462127686], [0.3317921757698059, 0.3341657817363739, 0.3340420424938202]], [[0.31435972452163696, 0.37223413586616516, 0.3134061396121979], [0.23170872032642365, 0.5400809049606323, 0.22821035981178284], [0.31576043367385864, 0.3693680763244629, 0.31487154960632324]]]}, "num_training_step_calls_per_iteration": 1, "evaluation": {"env_runners": {"env_to_module_connector": {"timers": {"connectors": {"add_observations_from_episodes_to_batch": 3.2243471973817965e-06, "numpy_to_tensor": 1.5866941346859827e-05, "batch_individual_items": 1.5343203438507006e-05, "add_states_from_episodes_to_batch": 3.1186570665492596e-06, "add_time_dim_to_batch_and_zero_pad": 8.294157853332794e-06}}, "connector_pipeline_timer": 7.076114064165755e-05}, "num_module_steps_sampled_lifetime": {"default_policy": 3600}, "num_env_steps_sampled_lifetime": 45400, "weights_seq_no": 9.0, "module_to_env_connector": {"timers": {"connectors": {"get_actions": 4.576853355992826e-05, "un_batch_to_individual_items": 7.009535226497342e-06, "listify_data_for_vector_env": 1.1375051341788211e-05, "remove_single_ts_time_rank_from_batch": 1.2890606750026837e-05, "normalize_and_clip_actions": 9.006171331603323e-06, "tensor_to_numpy": 1.7675066244911174e-05}}, "connector_pipeline_timer": 0.000133642251685737}, "episode_return_min": -13.5, "rlmodule_inference_timer": 3.679733918543157e-05, "num_episodes": 20, "num_agent_steps_sampled": {"default_agent": 400}, "num_env_steps_sampled": 400, "episode_len_max": 20, "env_to_module_sum_episodes_length_in": 10.368238394574323, "agent_episode_returns_mean": {"default_agent": -0.3}, "env_reset_timer": 0.0005734890912542119, "episode_len_min": 20, "env_to_module_sum_episodes_length_out": 10.368238394574323, "env_step_timer": 1.6990580503516708e-05, "episode_len_mean": 20.0, "episode_duration_sec_mean": 0.007157322973944247, "num_module_steps_sampled": {"default_policy": 400}, "module_episode_returns_mean": {"default_policy": -0.3}, "sample": 0.12090587168956839, "num_agent_steps_sampled_lifetime": {"default_agent": 3600}, "num_episodes_lifetime": 180, "episode_return_max": 15.5, "episode_return_mean": -0.3, "time_between_sampling": 11.142522770400307}, "num_healthy_workers": 1, "actor_manager_num_outstanding_async_reqs": 0, "num_remote_worker_restarts": 0}, "num_env_steps_sampled_lifetime": -4312500.0, "fault_tolerance": {"num_healthy_workers": 0, "num_remote_worker_restarts": 0}, "env_runner_group": {"actor_manager_num_outstanding_async_reqs": 0}, "done": false, "training_iteration": 9, "trial_id": "b7d6e_00000", "date": "2025-08-11_18-09-51", "timestamp": 1754928591, "time_this_iter_s": 11.030090093612671, "time_total_s": 102.3450882434845, "pid": 10343, "hostname": "Mac", "node_ip": "127.0.0.1", "config": {"exploration_config": {}, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 2, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "env": "Umbrella", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": false, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 0, "create_local_env_runner": true, "num_envs_per_env_runner": 1, "gym_env_vectorize_mode": "SYNC", "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "episodes_to_numpy": true, "max_requests_in_flight_per_env_runner": 1, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "merge_env_runner_states": "training_only", "broadcast_env_runner_states": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "complete_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "sampler_perf_stats_ema_coef": null, "_is_online": true, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": "auto", "num_aggregator_actors_per_learner": 0, "max_requests_in_flight_per_aggregator_actor": 3, "local_gpu_idx": 0, "max_requests_in_flight_per_learner": 3, "gamma": 1, "lr": 0.0002715581955, "grad_clip": 0.5, "grad_clip_by": "global_norm", "_train_batch_size_per_learner": 5000, "train_batch_size": 4000, "num_epochs": 1, "minibatch_size": 1000, "shuffle_batch_per_epoch": true, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "log_std_clip_param": 20.0, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "_disable_preprocessor_api": false, "_disable_action_flattening": false}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {"intrinsic_reward_coeff": 0.2795015916508}, "optimizer": {}, "_learner_class": "<class 'source.intrinsic_attention_ppo.learners.IntrinsicAttentionMetaLearner.IntrinsicAttentionMetaLearner'>", "callbacks_on_algorithm_init": null, "callbacks_on_env_runners_recreated": null, "callbacks_on_offline_eval_runners_recreated": null, "callbacks_on_checkpoint_loaded": null, "callbacks_on_environment_created": null, "callbacks_on_episode_created": null, "callbacks_on_episode_start": null, "callbacks_on_episode_step": null, "callbacks_on_episode_end": null, "callbacks_on_evaluate_start": null, "callbacks_on_evaluate_end": null, "callbacks_on_evaluate_offline_start": null, "callbacks_on_evaluate_offline_end": null, "callbacks_on_sample_end": null, "callbacks_on_train_result": null, "explore": true, "enable_rl_module_and_learner": true, "enable_env_runner_and_connector_v2": true, "_prior_exploration_config": {"type": "StochasticSampling"}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x1616f98a0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "offline_data_class": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_read_batch_size": null, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "materialize_data": false, "materialize_mapped_data": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "ignore_final_observation": false, "prelearner_class": null, "prelearner_buffer_class": null, "prelearner_buffer_kwargs": {}, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_remaining_data": false, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": 1, "evaluation_duration": 20, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_auto_duration_min_env_steps_per_sample": 100, "evaluation_auto_duration_max_env_steps_per_sample": 2000, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 1, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "offline_evaluation_interval": null, "num_offline_eval_runners": 0, "offline_loss_for_module_fn": null, "offline_evaluation_duration": 1, "offline_evaluation_parallel_to_training": false, "offline_evaluation_timeout_s": 120.0, "num_cpus_per_offline_eval_runner": 1, "num_gpus_per_offline_eval_runner": 0, "custom_resources_per_offline_eval_runner": {}, "restart_failed_offline_eval_runners": true, "ignore_offline_eval_runner_failures": false, "max_num_offline_eval_runner_restarts": 1000, "offline_eval_runner_restore_timeout_s": 1800.0, "max_requests_in_flight_per_offline_eval_runner": 1, "validate_offline_eval_runners_after_construction": true, "offline_eval_runner_health_probe_timeout_s": 30.0, "offline_eval_rl_module_inference_only": false, "broadcast_offline_eval_runner_states": false, "offline_eval_batch_size_per_runner": 256, "dataset_num_iters_per_eval_runner": 1, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "log_gradients": false, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 9, "restart_failed_env_runners": true, "ignore_env_runner_failures": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30.0, "env_runner_restore_timeout_s": 1800.0, "_model_config": {}, "_rl_module_spec": "MultiRLModuleSpec(multi_rl_module_class=<class 'ray.rllib.core.rl_module.multi_rl_module.MultiRLModule'>, observation_space=None, action_space=None, inference_only=False, model_config=None, rl_module_specs={'default_policy': RLModuleSpec(module_class=<class 'source.intrinsic_attention_ppo.rl_modules.DifferentiablePPOModule.DifferentiablePPOModule'>, observation_space=None, action_space=None, inference_only=False, learner_only=False, model_config={'vf_share_layers': True, 'embedding_dim': 62, 'max_seq_len': 3, 'policy_head_hidden_sizes': [32], 'value_head_hidden_sizes': [101], 'embedding_hidden_sizes': [121]}, catalog_class=None, load_state_path=None, model_config_dict=None), 'intrinsic_reward_module': RLModuleSpec(module_class=<class 'source.intrinsic_attention_ppo.rl_modules.IntrinsicAttentionModule.IntrinsicAttentionModule'>, observation_space=None, action_space=None, inference_only=False, learner_only=True, model_config={'intrinsic_reward_network': {'encoder_hidden_sizes': [], 'encoding_dim': 1, 'num_heads': 1, 'head_hidden_sizes': None, 'layers': [{'type': 'attention'}]}, 'extrinsic_value_hidden_layers': [127, 60], 'vf_share_layers': True, 'max_seq_len': 3}, catalog_class=None, load_state_path=None, model_config_dict=None)}, load_state_path=None, modules_to_load=None, module_specs={'default_policy': RLModuleSpec(module_class=<class 'source.intrinsic_attention_ppo.rl_modules.DifferentiablePPOModule.DifferentiablePPOModule'>, observation_space=None, action_space=None, inference_only=False, learner_only=False, model_config={'vf_share_layers': True, 'embedding_dim': 62, 'max_seq_len': 3, 'policy_head_hidden_sizes': [32], 'value_head_hidden_sizes': [101], 'embedding_hidden_sizes': [121]}, catalog_class=None, load_state_path=None, model_config_dict=None), 'intrinsic_reward_module': RLModuleSpec(module_class=<class 'source.intrinsic_attention_ppo.rl_modules.IntrinsicAttentionModule.IntrinsicAttentionModule'>, observation_space=None, action_space=None, inference_only=False, learner_only=True, model_config={'intrinsic_reward_network': {'encoder_hidden_sizes': [], 'encoding_dim': 1, 'num_heads': 1, 'head_hidden_sizes': None, 'layers': [{'type': 'attention'}]}, 'extrinsic_value_hidden_layers': [127, 60], 'vf_share_layers': True, 'max_seq_len': 3}, catalog_class=None, load_state_path=None, model_config_dict=None)})", "algorithm_config_overrides_per_module": {"intrinsic_reward_module": {"lr": 0.0002715581955}}, "_per_module_overrides": {}, "_validate_config": true, "_use_msgpack_checkpoints": false, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "env_task_fn": -1, "enable_connectors": -1, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.161583927863, "kl_target": 0.0201019014258, "vf_loss_coeff": 0.7790510010087, "entropy_coeff": 0.0015431216992, "clip_param": 0.2459212356676, "vf_clip_param": 0.3769744131561, "entropy_coeff_schedule": null, "lr_schedule": null, "sgd_minibatch_size": -1, "vf_share_layers": -1, "differentiable_learner_configs": ["DifferentiableLearnerConfig(learner_class=<class 'source.intrinsic_attention_ppo.learners.IntrinsicAttentionPPOLearner.IntrinsicAttentionPPOLearner'>, learner_connector=None, add_default_connectors_to_learner_pipeline=True, is_multi_agent=False, policies_to_update=['default_policy'], lr=0.0060984166342, num_total_minibatches=0, num_epochs=1, minibatch_size=1000, shuffle_batch_per_epoch=True)"], "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9485408017724, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.callbacks.callbacks.RLlibCallback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 102.3450882434845, "iterations_since_restore": 9, "perf": {"cpu_util_percent": 45.379999999999995, "ram_util_percent": 80.56666666666666}}
{"timers": {"training_iteration": 10.439524588800316, "restore_env_runners": 6.248923171004101e-05, "training_step": 10.439187859677283, "env_runner_sampling_timer": 1.760084894046579, "learner_update_timer": 8.453517883367716, "synch_weights": 0.0017692109009633274, "restore_eval_env_runners": 5.791531840180599e-05, "evaluation_iteration": 0.13260964119335053, "synch_eval_env_connectors": 0.00018679708146520133, "synch_env_connectors": 4.48737680204397e-06}, "env_runners": {"env_to_module_connector": {"timers": {"connectors": {"numpy_to_tensor": 1.3556323524984235e-05, "add_time_dim_to_batch_and_zero_pad": 7.3701675747144686e-06, "batch_individual_items": 1.3184750020929614e-05, "add_observations_from_episodes_to_batch": 2.9763445951408894e-06, "add_states_from_episodes_to_batch": 2.898793350929715e-06}}, "connector_pipeline_timer": 6.320986721779323e-05}, "module_to_env_connector": {"timers": {"connectors": {"tensor_to_numpy": 1.5790003795932603e-05, "un_batch_to_individual_items": 6.997285315777711e-06, "listify_data_for_vector_env": 1.0925995192427044e-05, "get_actions": 4.13339530457881e-05, "remove_single_ts_time_rank_from_batch": 1.2436514922470872e-05, "normalize_and_clip_actions": 8.413456826357643e-06}}, "connector_pipeline_timer": 0.00012356401474626307}, "module_episode_returns_mean": {"default_policy": 5.460000000000001}, "episode_len_min": 20, "env_reset_timer": 4.611314597605415e-05, "agent_episode_returns_mean": {"default_agent": 5.460000000000001}, "time_between_sampling": 0.03884631275861116, "env_to_module_sum_episodes_length_out": 10.36823839457432, "num_module_steps_sampled": {"default_policy": 5000.0}, "env_step_timer": 1.4803635231467209e-05, "weights_seq_no": 9.0, "num_env_steps_sampled_lifetime": -4930000.0, "num_agent_steps_sampled": {"default_agent": 5000.0}, "num_episodes_lifetime": -246500.0, "episode_len_mean": 20.0, "episode_duration_sec_mean": 0.005549654501955957, "episode_return_max": 14.5, "episode_len_max": 20, "num_module_steps_sampled_lifetime": {"default_policy": -4930000.0}, "episode_return_min": -5.5, "rlmodule_inference_timer": 3.345717893772455e-05, "episode_return_mean": 5.460000000000001, "env_to_module_sum_episodes_length_in": 10.36823839457432, "num_agent_steps_sampled_lifetime": {"default_agent": -4930000.0}, "num_episodes": 250.0, "sample": 0.005971168884131174, "num_env_steps_sampled": 5000.0, "num_env_steps_sampled_lifetime_throughput": 3088.83530518139}, "__all_modules__": {"learner_connector_sum_episodes_length_in": 5000.0, "learner_connector": {"connector_pipeline_timer": 0.18398220523714634, "timers": {"connectors": {"add_one_ts_to_episodes_and_truncate": 0.009547829263840988, "add_observations_from_episodes_to_batch": 0.000853288491515996, "add_columns_from_episodes_to_train_batch": 0.04270885724995983, "add_time_dim_to_batch_and_zero_pad": 0.11014558030559625, "add_states_from_episodes_to_batch": 0.003934735919683842, "batch_individual_items": 0.0165159011832269, "numpy_to_tensor": 8.608124264242318e-05}}}, "learner_connector_sum_episodes_length_out": 5250.0}, "learners": {"default_policy": {"num_module_steps_trained_lifetime": 59940, "policy_loss": -0.0006269761943258345, "diff_num_grad_updates_vs_sampler_policy": 1.0, "num_trainable_parameters": 16595, "mean_kl_loss": 3.4642242098925635e-05, "curr_entropy_coeff": 0.0015431216992, "total_loss": 0.20387482643127441, "module_train_batch_size_mean": 999.0, "curr_kl_coeff": 0.00015779680688865483, "use_intrinsic_rewards": 0.0, "weights_seq_no": 10.0, "vf_loss": 0.2638685405254364, "num_module_steps_trained": 5994, "entropy": 0.6903558969497681, "vf_loss_unclipped": 44.248435974121094, "vf_explained_var": 0.0003406405448913574, "num_module_steps_trained_lifetime_throughput": 685.6246420585205}, "intrinsic_reward_module": {"diff_num_grad_updates_vs_sampler_policy": 1.0, "gradients_default_optimizer_global_norm": 0.0, "num_trainable_parameters": 8266, "curr_entropy_coeff": 0.0015431216992, "total_loss": 0.0, "module_train_batch_size_mean": 999.0, "default_optimizer_learning_rate": 0.0002715581955, "weights_seq_no": 10.0, "num_module_steps_trained": 5994, "num_module_steps_trained_lifetime": 59940, "num_module_steps_trained_lifetime_throughput": 685.6331299567892}, "differentiable_learners": {"intrinsic_attention_ppo_learner": {"default_policy": {"policy_loss": -0.0005988881457597017, "diff_num_grad_updates_vs_sampler_policy": 51.0, "mean_kl_loss": 3.1564650271320716e-05, "total_loss": 0.20406055450439453, "module_train_batch_size_mean": 999.0, "use_intrinsic_rewards": 1.0, "weights_seq_no": 60.0, "vf_loss": 0.2640645205974579, "num_module_steps_trained": 35964, "entropy": 0.6903838515281677, "vf_loss_unclipped": 44.11136245727539, "vf_explained_var": 0.0021551847457885742, "num_module_steps_trained_lifetime": 359640}, "__all_modules__": {"num_env_steps_trained": 189000, "num_module_steps_trained": 71928, "num_module_steps_trained_lifetime": 719280, "num_env_steps_trained_lifetime": 1890000, "num_env_steps_trained_lifetime_throughput": 44065.85492769318}, "intrinsic_reward_module": {"num_module_steps_trained_lifetime": 359640, "diff_num_grad_updates_vs_sampler_policy": 51.0, "total_loss": 0.0, "module_train_batch_size_mean": 999.0, "weights_seq_no": 60.0, "num_module_steps_trained": 35964}}}, "__all_modules__": {"num_trainable_parameters": 24861, "num_env_steps_trained": 31500, "num_module_steps_trained": 11988, "num_non_trainable_parameters": 0, "num_module_steps_trained_lifetime": 119880, "num_env_steps_trained_lifetime": 315000, "num_env_steps_trained_lifetime_throughput": 3603.2392164540693, "num_module_steps_trained_throughput": 21792849.321819287, "num_module_steps_trained_lifetime_throughput": 11094124.67137057}, "IntrinsicAttentionMask": [[[0.3322606086730957, 0.33450692892074585, 0.33323249220848083], [0.3317699134349823, 0.33504459261894226, 0.33318549394607544], [0.33204787969589233, 0.33473995327949524, 0.3332121968269348]], [[0.33653903007507324, 0.3339633643627167, 0.3294975757598877], [0.33612576127052307, 0.3338835537433624, 0.3299906551837921], [0.3354017734527588, 0.33374273777008057, 0.33085542917251587]], [[0.3343171775341034, 0.3341897130012512, 0.3314930498600006], [0.3343115448951721, 0.33418482542037964, 0.33150362968444824], [0.3341914713382721, 0.33408036828041077, 0.33172816038131714]], [[0.33247822523117065, 0.3351972997188568, 0.3323245346546173], [0.3321918249130249, 0.3358212113380432, 0.3319869935512543], [0.33249446749687195, 0.33516189455986023, 0.3323436677455902]], [[0.3334582448005676, 0.3333333134651184, 0.33320844173431396], [0.3334575295448303, 0.3333333134651184, 0.33320915699005127], [0.33345678448677063, 0.3333333134651184, 0.33320990204811096]], [[0.3429511785507202, 0.3155484199523926, 0.3415004014968872], [0.24812711775302887, 0.49487078189849854, 0.2570020854473114], [0.33842965960502625, 0.32389602065086365, 0.3376742899417877]]]}, "num_training_step_calls_per_iteration": 1, "evaluation": {"env_runners": {"env_to_module_connector": {"timers": {"connectors": {"add_observations_from_episodes_to_batch": 2.84077322908552e-06, "numpy_to_tensor": 1.2142786165305268e-05, "batch_individual_items": 1.2450324201460184e-05, "add_states_from_episodes_to_batch": 2.8005214594621206e-06, "add_time_dim_to_batch_and_zero_pad": 6.866461776177886e-06}}, "connector_pipeline_timer": 5.9265994171345334e-05}, "num_module_steps_sampled_lifetime": {"default_policy": 4000}, "num_env_steps_sampled_lifetime": 50400, "weights_seq_no": 10.0, "module_to_env_connector": {"timers": {"connectors": {"get_actions": 3.667632751926012e-05, "un_batch_to_individual_items": 6.492317876030394e-06, "listify_data_for_vector_env": 1.0402124991048781e-05, "remove_single_ts_time_rank_from_batch": 1.1913625454121259e-05, "normalize_and_clip_actions": 7.987869124340464e-06, "tensor_to_numpy": 1.5010979551880348e-05}}, "connector_pipeline_timer": 0.00011483686129391119}, "episode_return_min": -13.5, "rlmodule_inference_timer": 3.1352685545523195e-05, "num_episodes": 20, "num_agent_steps_sampled": {"default_agent": 400}, "num_env_steps_sampled": 400, "episode_len_max": 20, "env_to_module_sum_episodes_length_in": 10.368238394574323, "agent_episode_returns_mean": {"default_agent": 0.1}, "env_reset_timer": 0.0005712225399059484, "episode_len_min": 20, "env_to_module_sum_episodes_length_out": 10.368238394574323, "env_step_timer": 1.4051570869979435e-05, "episode_len_mean": 20.0, "episode_duration_sec_mean": 0.007170270462520421, "num_module_steps_sampled": {"default_policy": 400}, "module_episode_returns_mean": {"default_policy": 0.1}, "sample": 0.12085829505302427, "num_agent_steps_sampled_lifetime": {"default_agent": 4000}, "num_episodes_lifetime": 200, "episode_return_max": 15.5, "episode_return_mean": 0.1, "time_between_sampling": 11.135454498945405}, "num_healthy_workers": 1, "actor_manager_num_outstanding_async_reqs": 0, "num_remote_worker_restarts": 0}, "num_env_steps_sampled_lifetime": -4930000.0, "fault_tolerance": {"num_healthy_workers": 0, "num_remote_worker_restarts": 0}, "env_runner_group": {"actor_manager_num_outstanding_async_reqs": 0}, "done": false, "training_iteration": 10, "trial_id": "b7d6e_00000", "date": "2025-08-11_18-10-01", "timestamp": 1754928601, "time_this_iter_s": 10.529245853424072, "time_total_s": 112.87433409690857, "pid": 10343, "hostname": "Mac", "node_ip": "127.0.0.1", "config": {"exploration_config": {}, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 2, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "env": "Umbrella", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": false, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 0, "create_local_env_runner": true, "num_envs_per_env_runner": 1, "gym_env_vectorize_mode": "SYNC", "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "episodes_to_numpy": true, "max_requests_in_flight_per_env_runner": 1, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "merge_env_runner_states": "training_only", "broadcast_env_runner_states": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "complete_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "sampler_perf_stats_ema_coef": null, "_is_online": true, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": "auto", "num_aggregator_actors_per_learner": 0, "max_requests_in_flight_per_aggregator_actor": 3, "local_gpu_idx": 0, "max_requests_in_flight_per_learner": 3, "gamma": 1, "lr": 0.0002715581955, "grad_clip": 0.5, "grad_clip_by": "global_norm", "_train_batch_size_per_learner": 5000, "train_batch_size": 4000, "num_epochs": 1, "minibatch_size": 1000, "shuffle_batch_per_epoch": true, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "log_std_clip_param": 20.0, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "_disable_preprocessor_api": false, "_disable_action_flattening": false}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {"intrinsic_reward_coeff": 0.2795015916508}, "optimizer": {}, "_learner_class": "<class 'source.intrinsic_attention_ppo.learners.IntrinsicAttentionMetaLearner.IntrinsicAttentionMetaLearner'>", "callbacks_on_algorithm_init": null, "callbacks_on_env_runners_recreated": null, "callbacks_on_offline_eval_runners_recreated": null, "callbacks_on_checkpoint_loaded": null, "callbacks_on_environment_created": null, "callbacks_on_episode_created": null, "callbacks_on_episode_start": null, "callbacks_on_episode_step": null, "callbacks_on_episode_end": null, "callbacks_on_evaluate_start": null, "callbacks_on_evaluate_end": null, "callbacks_on_evaluate_offline_start": null, "callbacks_on_evaluate_offline_end": null, "callbacks_on_sample_end": null, "callbacks_on_train_result": null, "explore": true, "enable_rl_module_and_learner": true, "enable_env_runner_and_connector_v2": true, "_prior_exploration_config": {"type": "StochasticSampling"}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x1616f98a0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "offline_data_class": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_read_batch_size": null, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "materialize_data": false, "materialize_mapped_data": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "ignore_final_observation": false, "prelearner_class": null, "prelearner_buffer_class": null, "prelearner_buffer_kwargs": {}, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_remaining_data": false, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": 1, "evaluation_duration": 20, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_auto_duration_min_env_steps_per_sample": 100, "evaluation_auto_duration_max_env_steps_per_sample": 2000, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 1, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "offline_evaluation_interval": null, "num_offline_eval_runners": 0, "offline_loss_for_module_fn": null, "offline_evaluation_duration": 1, "offline_evaluation_parallel_to_training": false, "offline_evaluation_timeout_s": 120.0, "num_cpus_per_offline_eval_runner": 1, "num_gpus_per_offline_eval_runner": 0, "custom_resources_per_offline_eval_runner": {}, "restart_failed_offline_eval_runners": true, "ignore_offline_eval_runner_failures": false, "max_num_offline_eval_runner_restarts": 1000, "offline_eval_runner_restore_timeout_s": 1800.0, "max_requests_in_flight_per_offline_eval_runner": 1, "validate_offline_eval_runners_after_construction": true, "offline_eval_runner_health_probe_timeout_s": 30.0, "offline_eval_rl_module_inference_only": false, "broadcast_offline_eval_runner_states": false, "offline_eval_batch_size_per_runner": 256, "dataset_num_iters_per_eval_runner": 1, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "log_gradients": false, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 9, "restart_failed_env_runners": true, "ignore_env_runner_failures": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30.0, "env_runner_restore_timeout_s": 1800.0, "_model_config": {}, "_rl_module_spec": "MultiRLModuleSpec(multi_rl_module_class=<class 'ray.rllib.core.rl_module.multi_rl_module.MultiRLModule'>, observation_space=None, action_space=None, inference_only=False, model_config=None, rl_module_specs={'default_policy': RLModuleSpec(module_class=<class 'source.intrinsic_attention_ppo.rl_modules.DifferentiablePPOModule.DifferentiablePPOModule'>, observation_space=None, action_space=None, inference_only=False, learner_only=False, model_config={'vf_share_layers': True, 'embedding_dim': 62, 'max_seq_len': 3, 'policy_head_hidden_sizes': [32], 'value_head_hidden_sizes': [101], 'embedding_hidden_sizes': [121]}, catalog_class=None, load_state_path=None, model_config_dict=None), 'intrinsic_reward_module': RLModuleSpec(module_class=<class 'source.intrinsic_attention_ppo.rl_modules.IntrinsicAttentionModule.IntrinsicAttentionModule'>, observation_space=None, action_space=None, inference_only=False, learner_only=True, model_config={'intrinsic_reward_network': {'encoder_hidden_sizes': [], 'encoding_dim': 1, 'num_heads': 1, 'head_hidden_sizes': None, 'layers': [{'type': 'attention'}]}, 'extrinsic_value_hidden_layers': [127, 60], 'vf_share_layers': True, 'max_seq_len': 3}, catalog_class=None, load_state_path=None, model_config_dict=None)}, load_state_path=None, modules_to_load=None, module_specs={'default_policy': RLModuleSpec(module_class=<class 'source.intrinsic_attention_ppo.rl_modules.DifferentiablePPOModule.DifferentiablePPOModule'>, observation_space=None, action_space=None, inference_only=False, learner_only=False, model_config={'vf_share_layers': True, 'embedding_dim': 62, 'max_seq_len': 3, 'policy_head_hidden_sizes': [32], 'value_head_hidden_sizes': [101], 'embedding_hidden_sizes': [121]}, catalog_class=None, load_state_path=None, model_config_dict=None), 'intrinsic_reward_module': RLModuleSpec(module_class=<class 'source.intrinsic_attention_ppo.rl_modules.IntrinsicAttentionModule.IntrinsicAttentionModule'>, observation_space=None, action_space=None, inference_only=False, learner_only=True, model_config={'intrinsic_reward_network': {'encoder_hidden_sizes': [], 'encoding_dim': 1, 'num_heads': 1, 'head_hidden_sizes': None, 'layers': [{'type': 'attention'}]}, 'extrinsic_value_hidden_layers': [127, 60], 'vf_share_layers': True, 'max_seq_len': 3}, catalog_class=None, load_state_path=None, model_config_dict=None)})", "algorithm_config_overrides_per_module": {"intrinsic_reward_module": {"lr": 0.0002715581955}}, "_per_module_overrides": {}, "_validate_config": true, "_use_msgpack_checkpoints": false, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "env_task_fn": -1, "enable_connectors": -1, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.161583927863, "kl_target": 0.0201019014258, "vf_loss_coeff": 0.7790510010087, "entropy_coeff": 0.0015431216992, "clip_param": 0.2459212356676, "vf_clip_param": 0.3769744131561, "entropy_coeff_schedule": null, "lr_schedule": null, "sgd_minibatch_size": -1, "vf_share_layers": -1, "differentiable_learner_configs": ["DifferentiableLearnerConfig(learner_class=<class 'source.intrinsic_attention_ppo.learners.IntrinsicAttentionPPOLearner.IntrinsicAttentionPPOLearner'>, learner_connector=None, add_default_connectors_to_learner_pipeline=True, is_multi_agent=False, policies_to_update=['default_policy'], lr=0.0060984166342, num_total_minibatches=0, num_epochs=1, minibatch_size=1000, shuffle_batch_per_epoch=True)"], "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9485408017724, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.callbacks.callbacks.RLlibCallback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 112.87433409690857, "iterations_since_restore": 10, "perf": {"cpu_util_percent": 43.29333333333333, "ram_util_percent": 80.64}}
{"timers": {"training_iteration": 10.448436063743046, "restore_env_runners": 6.192725954608161e-05, "training_step": 10.448100497750104, "env_runner_sampling_timer": 1.758612153026635, "learner_update_timer": 8.463784652453226, "synch_weights": 0.001764133792549964, "restore_eval_env_runners": 5.7758665524528335e-05, "evaluation_iteration": 0.13254704978180526, "synch_eval_env_connectors": 0.00018794536062573887, "synch_env_connectors": 4.479163383020051e-06}, "env_runners": {"env_to_module_connector": {"timers": {"connectors": {"numpy_to_tensor": 1.328843634499799e-05, "add_time_dim_to_batch_and_zero_pad": 7.267747143114773e-06, "batch_individual_items": 1.2951336363433826e-05, "add_observations_from_episodes_to_batch": 2.937688051466189e-06, "add_states_from_episodes_to_batch": 2.8629300985995675e-06}}, "connector_pipeline_timer": 6.228790441556452e-05}, "module_to_env_connector": {"timers": {"connectors": {"tensor_to_numpy": 1.565039751450354e-05, "un_batch_to_individual_items": 6.8874640822566294e-06, "listify_data_for_vector_env": 1.0899455739347982e-05, "get_actions": 4.1025100424830935e-05, "remove_single_ts_time_rank_from_batch": 1.2408653590953842e-05, "normalize_and_clip_actions": 8.483726674059178e-06}}, "connector_pipeline_timer": 0.0001228104675842904}, "module_episode_returns_mean": {"default_policy": 4.5}, "episode_len_min": 20, "env_reset_timer": 5.0562998023680586e-05, "agent_episode_returns_mean": {"default_agent": 4.5}, "time_between_sampling": 0.036451694631112495, "env_to_module_sum_episodes_length_out": 10.36823839457432, "num_module_steps_sampled": {"default_policy": 5000.0}, "env_step_timer": 1.4725783347566308e-05, "weights_seq_no": 10.0, "num_env_steps_sampled_lifetime": -5547500.0, "num_agent_steps_sampled": {"default_agent": 5000.0}, "num_episodes_lifetime": -277375.0, "episode_len_mean": 20.0, "episode_duration_sec_mean": 0.005499391529243437, "episode_return_max": 14.5, "episode_len_max": 20, "num_module_steps_sampled_lifetime": {"default_policy": -5547500.0}, "episode_return_min": -5.5, "rlmodule_inference_timer": 3.313124994898471e-05, "episode_return_mean": 4.5, "env_to_module_sum_episodes_length_in": 10.36823839457432, "num_agent_steps_sampled_lifetime": {"default_agent": -5547500.0}, "num_episodes": 250.0, "sample": 0.005962046384240941, "num_env_steps_sampled": 5000.0, "num_env_steps_sampled_lifetime_throughput": 3089.744959671834}, "__all_modules__": {"learner_connector_sum_episodes_length_in": 5000.0, "learner_connector": {"connector_pipeline_timer": 0.1840130315148524, "timers": {"connectors": {"add_one_ts_to_episodes_and_truncate": 0.009543313892006156, "add_observations_from_episodes_to_batch": 0.000853235186884001, "add_columns_from_episodes_to_train_batch": 0.042712342427514705, "add_time_dim_to_batch_and_zero_pad": 0.11020408825235506, "add_states_from_episodes_to_batch": 0.00393573814013605, "batch_individual_items": 0.016488739251268085, "numpy_to_tensor": 8.5993759736597e-05}}}, "learner_connector_sum_episodes_length_out": 5250.0}, "learners": {"default_policy": {"num_module_steps_trained_lifetime": 65934, "policy_loss": -0.0006651920848526061, "diff_num_grad_updates_vs_sampler_policy": 1.0, "num_trainable_parameters": 16595, "mean_kl_loss": 3.550931069185026e-05, "curr_entropy_coeff": 0.0015431216992, "total_loss": 0.2038409262895584, "module_train_batch_size_mean": 999.0, "curr_kl_coeff": 7.889840344432741e-05, "use_intrinsic_rewards": 0.0, "weights_seq_no": 11.0, "vf_loss": 0.263872891664505, "num_module_steps_trained": 5994, "entropy": 0.6896942257881165, "vf_loss_unclipped": 44.236270904541016, "vf_explained_var": 0.0005555152893066406, "num_module_steps_trained_lifetime_throughput": 682.2792737450686}, "intrinsic_reward_module": {"diff_num_grad_updates_vs_sampler_policy": 1.0, "gradients_default_optimizer_global_norm": 0.0, "num_trainable_parameters": 8266, "curr_entropy_coeff": 0.0015431216992, "total_loss": 0.0, "module_train_batch_size_mean": 999.0, "default_optimizer_learning_rate": 0.0002715581955, "weights_seq_no": 11.0, "num_module_steps_trained": 5994, "num_module_steps_trained_lifetime": 65934, "num_module_steps_trained_lifetime_throughput": 682.2873327049394}, "differentiable_learners": {"intrinsic_attention_ppo_learner": {"default_policy": {"policy_loss": -0.0006337205995805562, "diff_num_grad_updates_vs_sampler_policy": 56.0, "mean_kl_loss": 3.213535819668323e-05, "total_loss": 0.20398974418640137, "module_train_batch_size_mean": 999.0, "use_intrinsic_rewards": 1.0, "weights_seq_no": 66.0, "vf_loss": 0.26401689648628235, "num_module_steps_trained": 35964, "entropy": 0.6897279620170593, "vf_loss_unclipped": 44.12333297729492, "vf_explained_var": 0.002067089080810547, "num_module_steps_trained_lifetime": 395604}, "__all_modules__": {"num_env_steps_trained": 189000, "num_module_steps_trained": 71928, "num_module_steps_trained_lifetime": 791208, "num_env_steps_trained_lifetime": 2079000, "num_env_steps_trained_lifetime_throughput": 43270.81534511174}, "intrinsic_reward_module": {"num_module_steps_trained_lifetime": 395604, "diff_num_grad_updates_vs_sampler_policy": 56.0, "total_loss": 0.0, "module_train_batch_size_mean": 999.0, "weights_seq_no": 66.0, "num_module_steps_trained": 35964}}}, "__all_modules__": {"num_trainable_parameters": 24861, "num_env_steps_trained": 31500, "num_module_steps_trained": 11988, "num_non_trainable_parameters": 0, "num_module_steps_trained_lifetime": 131868, "num_env_steps_trained_lifetime": 346500, "num_env_steps_trained_lifetime_throughput": 3585.653528795785, "num_module_steps_trained_throughput": 21273780.068592995, "num_module_steps_trained_lifetime_throughput": 11124833.573049206}, "IntrinsicAttentionMask": [[[0.3318576514720917, 0.33410122990608215, 0.33404120802879333], [0.3311832547187805, 0.33445215225219727, 0.3343645930290222], [0.3312012255191803, 0.33444279432296753, 0.3343559503555298]], [[0.33652207255363464, 0.33640041947364807, 0.3270775377750397], [0.3365028202533722, 0.3363819122314453, 0.3271152973175049], [0.3350035548210144, 0.33494025468826294, 0.33005619049072266]], [[0.33193111419677734, 0.3340907096862793, 0.33397814631462097], [0.33175572752952576, 0.33418548107147217, 0.33405882120132446], [0.3317648470401764, 0.3341805636882782, 0.3340546190738678]], [[0.3331969678401947, 0.3336213231086731, 0.3331817090511322], [0.33247292041778564, 0.3351503312587738, 0.33237677812576294], [0.33322304487228394, 0.333566278219223, 0.33321067690849304]], [[0.3343002498149872, 0.3341749906539917, 0.3315247595310211], [0.3342945873737335, 0.33417007327079773, 0.33153530955314636], [0.3341745138168335, 0.33406558632850647, 0.33175987005233765]], [[0.33992916345596313, 0.32112500071525574, 0.3389458656311035], [0.24480512738227844, 0.501292884349823, 0.2539019286632538], [0.33537501096725464, 0.3295489549636841, 0.3350759744644165]]]}, "num_training_step_calls_per_iteration": 1, "evaluation": {"env_runners": {"env_to_module_connector": {"timers": {"connectors": {"add_observations_from_episodes_to_batch": 2.8065298476849715e-06, "numpy_to_tensor": 1.2076486025046602e-05, "batch_individual_items": 1.2301576440669284e-05, "add_states_from_episodes_to_batch": 2.8048235150150942e-06, "add_time_dim_to_batch_and_zero_pad": 6.84780144908668e-06}}, "connector_pipeline_timer": 5.887723581584543e-05}, "num_module_steps_sampled_lifetime": {"default_policy": 4400}, "num_env_steps_sampled_lifetime": 55400, "weights_seq_no": 11.0, "module_to_env_connector": {"timers": {"connectors": {"get_actions": 3.7135456556779554e-05, "un_batch_to_individual_items": 6.517377053721652e-06, "listify_data_for_vector_env": 1.0501236072821717e-05, "remove_single_ts_time_rank_from_batch": 1.1730763925721198e-05, "normalize_and_clip_actions": 7.952282716556649e-06, "tensor_to_numpy": 1.4910675806194281e-05}}, "connector_pipeline_timer": 0.00011515066055684568}, "episode_return_min": -13.5, "rlmodule_inference_timer": 3.128592898454882e-05, "num_episodes": 20, "num_agent_steps_sampled": {"default_agent": 400}, "num_env_steps_sampled": 400, "episode_len_max": 20, "env_to_module_sum_episodes_length_in": 10.368238394574323, "agent_episode_returns_mean": {"default_agent": 1.5}, "env_reset_timer": 0.0005697390638193493, "episode_len_min": 20, "env_to_module_sum_episodes_length_out": 10.368238394574323, "env_step_timer": 1.398035664758634e-05, "episode_len_mean": 20.0, "episode_duration_sec_mean": 0.005415014213649556, "num_module_steps_sampled": {"default_policy": 400}, "module_episode_returns_mean": {"default_policy": 1.5}, "sample": 0.12084305794235023, "num_agent_steps_sampled_lifetime": {"default_agent": 4400}, "num_episodes_lifetime": 220, "episode_return_max": 15.5, "episode_return_mean": 1.5, "time_between_sampling": 11.137745345625074}, "num_healthy_workers": 1, "actor_manager_num_outstanding_async_reqs": 0, "num_remote_worker_restarts": 0}, "num_env_steps_sampled_lifetime": -5547500.0, "fault_tolerance": {"num_healthy_workers": 0, "num_remote_worker_restarts": 0}, "env_runner_group": {"actor_manager_num_outstanding_async_reqs": 0}, "done": false, "training_iteration": 11, "trial_id": "b7d6e_00000", "date": "2025-08-11_18-10-13", "timestamp": 1754928613, "time_this_iter_s": 11.462268114089966, "time_total_s": 124.33660221099854, "pid": 10343, "hostname": "Mac", "node_ip": "127.0.0.1", "config": {"exploration_config": {}, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 2, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "env": "Umbrella", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": false, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 0, "create_local_env_runner": true, "num_envs_per_env_runner": 1, "gym_env_vectorize_mode": "SYNC", "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "episodes_to_numpy": true, "max_requests_in_flight_per_env_runner": 1, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "merge_env_runner_states": "training_only", "broadcast_env_runner_states": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "complete_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "sampler_perf_stats_ema_coef": null, "_is_online": true, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": "auto", "num_aggregator_actors_per_learner": 0, "max_requests_in_flight_per_aggregator_actor": 3, "local_gpu_idx": 0, "max_requests_in_flight_per_learner": 3, "gamma": 1, "lr": 0.0002715581955, "grad_clip": 0.5, "grad_clip_by": "global_norm", "_train_batch_size_per_learner": 5000, "train_batch_size": 4000, "num_epochs": 1, "minibatch_size": 1000, "shuffle_batch_per_epoch": true, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "log_std_clip_param": 20.0, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "_disable_preprocessor_api": false, "_disable_action_flattening": false}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {"intrinsic_reward_coeff": 0.2795015916508}, "optimizer": {}, "_learner_class": "<class 'source.intrinsic_attention_ppo.learners.IntrinsicAttentionMetaLearner.IntrinsicAttentionMetaLearner'>", "callbacks_on_algorithm_init": null, "callbacks_on_env_runners_recreated": null, "callbacks_on_offline_eval_runners_recreated": null, "callbacks_on_checkpoint_loaded": null, "callbacks_on_environment_created": null, "callbacks_on_episode_created": null, "callbacks_on_episode_start": null, "callbacks_on_episode_step": null, "callbacks_on_episode_end": null, "callbacks_on_evaluate_start": null, "callbacks_on_evaluate_end": null, "callbacks_on_evaluate_offline_start": null, "callbacks_on_evaluate_offline_end": null, "callbacks_on_sample_end": null, "callbacks_on_train_result": null, "explore": true, "enable_rl_module_and_learner": true, "enable_env_runner_and_connector_v2": true, "_prior_exploration_config": {"type": "StochasticSampling"}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x1616f98a0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "offline_data_class": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_read_batch_size": null, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "materialize_data": false, "materialize_mapped_data": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "ignore_final_observation": false, "prelearner_class": null, "prelearner_buffer_class": null, "prelearner_buffer_kwargs": {}, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_remaining_data": false, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": 1, "evaluation_duration": 20, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_auto_duration_min_env_steps_per_sample": 100, "evaluation_auto_duration_max_env_steps_per_sample": 2000, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 1, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "offline_evaluation_interval": null, "num_offline_eval_runners": 0, "offline_loss_for_module_fn": null, "offline_evaluation_duration": 1, "offline_evaluation_parallel_to_training": false, "offline_evaluation_timeout_s": 120.0, "num_cpus_per_offline_eval_runner": 1, "num_gpus_per_offline_eval_runner": 0, "custom_resources_per_offline_eval_runner": {}, "restart_failed_offline_eval_runners": true, "ignore_offline_eval_runner_failures": false, "max_num_offline_eval_runner_restarts": 1000, "offline_eval_runner_restore_timeout_s": 1800.0, "max_requests_in_flight_per_offline_eval_runner": 1, "validate_offline_eval_runners_after_construction": true, "offline_eval_runner_health_probe_timeout_s": 30.0, "offline_eval_rl_module_inference_only": false, "broadcast_offline_eval_runner_states": false, "offline_eval_batch_size_per_runner": 256, "dataset_num_iters_per_eval_runner": 1, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "log_gradients": false, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 9, "restart_failed_env_runners": true, "ignore_env_runner_failures": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30.0, "env_runner_restore_timeout_s": 1800.0, "_model_config": {}, "_rl_module_spec": "MultiRLModuleSpec(multi_rl_module_class=<class 'ray.rllib.core.rl_module.multi_rl_module.MultiRLModule'>, observation_space=None, action_space=None, inference_only=False, model_config=None, rl_module_specs={'default_policy': RLModuleSpec(module_class=<class 'source.intrinsic_attention_ppo.rl_modules.DifferentiablePPOModule.DifferentiablePPOModule'>, observation_space=None, action_space=None, inference_only=False, learner_only=False, model_config={'vf_share_layers': True, 'embedding_dim': 62, 'max_seq_len': 3, 'policy_head_hidden_sizes': [32], 'value_head_hidden_sizes': [101], 'embedding_hidden_sizes': [121]}, catalog_class=None, load_state_path=None, model_config_dict=None), 'intrinsic_reward_module': RLModuleSpec(module_class=<class 'source.intrinsic_attention_ppo.rl_modules.IntrinsicAttentionModule.IntrinsicAttentionModule'>, observation_space=None, action_space=None, inference_only=False, learner_only=True, model_config={'intrinsic_reward_network': {'encoder_hidden_sizes': [], 'encoding_dim': 1, 'num_heads': 1, 'head_hidden_sizes': None, 'layers': [{'type': 'attention'}]}, 'extrinsic_value_hidden_layers': [127, 60], 'vf_share_layers': True, 'max_seq_len': 3}, catalog_class=None, load_state_path=None, model_config_dict=None)}, load_state_path=None, modules_to_load=None, module_specs={'default_policy': RLModuleSpec(module_class=<class 'source.intrinsic_attention_ppo.rl_modules.DifferentiablePPOModule.DifferentiablePPOModule'>, observation_space=None, action_space=None, inference_only=False, learner_only=False, model_config={'vf_share_layers': True, 'embedding_dim': 62, 'max_seq_len': 3, 'policy_head_hidden_sizes': [32], 'value_head_hidden_sizes': [101], 'embedding_hidden_sizes': [121]}, catalog_class=None, load_state_path=None, model_config_dict=None), 'intrinsic_reward_module': RLModuleSpec(module_class=<class 'source.intrinsic_attention_ppo.rl_modules.IntrinsicAttentionModule.IntrinsicAttentionModule'>, observation_space=None, action_space=None, inference_only=False, learner_only=True, model_config={'intrinsic_reward_network': {'encoder_hidden_sizes': [], 'encoding_dim': 1, 'num_heads': 1, 'head_hidden_sizes': None, 'layers': [{'type': 'attention'}]}, 'extrinsic_value_hidden_layers': [127, 60], 'vf_share_layers': True, 'max_seq_len': 3}, catalog_class=None, load_state_path=None, model_config_dict=None)})", "algorithm_config_overrides_per_module": {"intrinsic_reward_module": {"lr": 0.0002715581955}}, "_per_module_overrides": {}, "_validate_config": true, "_use_msgpack_checkpoints": false, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "env_task_fn": -1, "enable_connectors": -1, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.161583927863, "kl_target": 0.0201019014258, "vf_loss_coeff": 0.7790510010087, "entropy_coeff": 0.0015431216992, "clip_param": 0.2459212356676, "vf_clip_param": 0.3769744131561, "entropy_coeff_schedule": null, "lr_schedule": null, "sgd_minibatch_size": -1, "vf_share_layers": -1, "differentiable_learner_configs": ["DifferentiableLearnerConfig(learner_class=<class 'source.intrinsic_attention_ppo.learners.IntrinsicAttentionPPOLearner.IntrinsicAttentionPPOLearner'>, learner_connector=None, add_default_connectors_to_learner_pipeline=True, is_multi_agent=False, policies_to_update=['default_policy'], lr=0.0060984166342, num_total_minibatches=0, num_epochs=1, minibatch_size=1000, shuffle_batch_per_epoch=True)"], "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9485408017724, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.callbacks.callbacks.RLlibCallback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 124.33660221099854, "iterations_since_restore": 11, "perf": {"cpu_util_percent": 47.05882352941177, "ram_util_percent": 81.95882352941176}}
{"timers": {"training_iteration": 10.4560405606048, "restore_env_runners": 6.138465808157602e-05, "training_step": 10.455706030272749, "env_runner_sampling_timer": 1.7568002406662724, "learner_update_timer": 8.473145455508865, "synch_weights": 0.0017574066145631573, "restore_eval_env_runners": 5.737149941119537e-05, "evaluation_iteration": 0.13250764095322137, "synch_eval_env_connectors": 0.00018712132716301125, "synch_env_connectors": 4.474781835702417e-06}, "env_runners": {"env_to_module_connector": {"timers": {"connectors": {"numpy_to_tensor": 1.3136699847330582e-05, "add_time_dim_to_batch_and_zero_pad": 7.17892368297817e-06, "batch_individual_items": 1.2712713998650632e-05, "add_observations_from_episodes_to_batch": 2.8938853661229435e-06, "add_states_from_episodes_to_batch": 2.830659357254744e-06}}, "connector_pipeline_timer": 6.145478139194713e-05}, "module_to_env_connector": {"timers": {"connectors": {"tensor_to_numpy": 1.5460225081526e-05, "un_batch_to_individual_items": 6.753351909286062e-06, "listify_data_for_vector_env": 1.0623635336054045e-05, "get_actions": 3.971040842575937e-05, "remove_single_ts_time_rank_from_batch": 1.2222389930674278e-05, "normalize_and_clip_actions": 8.21957045865512e-06}}, "connector_pipeline_timer": 0.00012031190107083984}, "module_episode_returns_mean": {"default_policy": 6.419999999999999}, "episode_len_min": 20, "env_reset_timer": 4.4905757121428606e-05, "agent_episode_returns_mean": {"default_agent": 6.419999999999999}, "time_between_sampling": 0.03970806364715093, "env_to_module_sum_episodes_length_out": 10.36823839457432, "num_module_steps_sampled": {"default_policy": 5000.0}, "env_step_timer": 1.4349118729205457e-05, "weights_seq_no": 11.0, "num_env_steps_sampled_lifetime": -6165000.0, "num_agent_steps_sampled": {"default_agent": 5000.0}, "num_episodes_lifetime": -308250.0, "episode_len_mean": 20.0, "episode_duration_sec_mean": 0.005396243331953883, "episode_return_max": 14.5, "episode_len_max": 20, "num_module_steps_sampled_lifetime": {"default_policy": -6165000.0}, "episode_return_min": -5.5, "rlmodule_inference_timer": 3.223175659383173e-05, "episode_return_mean": 6.419999999999999, "env_to_module_sum_episodes_length_in": 10.36823839457432, "num_agent_steps_sampled_lifetime": {"default_agent": -6165000.0}, "num_episodes": 250.0, "sample": 0.005782023762327804, "num_env_steps_sampled": 5000.0, "num_env_steps_sampled_lifetime_throughput": 3167.1172533881227}, "__all_modules__": {"learner_connector_sum_episodes_length_in": 5000.0, "learner_connector": {"connector_pipeline_timer": 0.1839837749500683, "timers": {"connectors": {"add_one_ts_to_episodes_and_truncate": 0.009536796593110223, "add_observations_from_episodes_to_batch": 0.0008538040847584139, "add_columns_from_episodes_to_train_batch": 0.042731771922696296, "add_time_dim_to_batch_and_zero_pad": 0.11017161987025038, "add_states_from_episodes_to_batch": 0.003936774928944455, "batch_individual_items": 0.016478234359087254, "numpy_to_tensor": 8.58950712418831e-05}}}, "learner_connector_sum_episodes_length_out": 5250.0}, "learners": {"default_policy": {"num_module_steps_trained_lifetime": 71928, "policy_loss": -0.00016888183017726988, "diff_num_grad_updates_vs_sampler_policy": 1.0, "num_trainable_parameters": 16595, "mean_kl_loss": 1.678155967965722e-05, "curr_entropy_coeff": 0.0015431216992, "total_loss": 0.20433425903320312, "module_train_batch_size_mean": 999.0, "curr_kl_coeff": 3.944920172216371e-05, "use_intrinsic_rewards": 0.0, "weights_seq_no": 12.0, "vf_loss": 0.2638683021068573, "num_module_steps_trained": 5994, "entropy": 0.6893296241760254, "vf_loss_unclipped": 46.391929626464844, "vf_explained_var": 0.00048106908798217773, "num_module_steps_trained_lifetime_throughput": 678.7332871248211}, "intrinsic_reward_module": {"diff_num_grad_updates_vs_sampler_policy": 1.0, "gradients_default_optimizer_global_norm": 0.0, "num_trainable_parameters": 8266, "curr_entropy_coeff": 0.0015431216992, "total_loss": 0.0, "module_train_batch_size_mean": 999.0, "default_optimizer_learning_rate": 0.0002715581955, "weights_seq_no": 12.0, "num_module_steps_trained": 5994, "num_module_steps_trained_lifetime": 71928, "num_module_steps_trained_lifetime_throughput": 678.740825254552}, "differentiable_learners": {"intrinsic_attention_ppo_learner": {"default_policy": {"policy_loss": -0.00016531709115952253, "diff_num_grad_updates_vs_sampler_policy": 61.0, "mean_kl_loss": 1.600583163963165e-05, "total_loss": 0.20442140102386475, "module_train_batch_size_mean": 999.0, "use_intrinsic_rewards": 1.0, "weights_seq_no": 72.0, "vf_loss": 0.26397231221199036, "num_module_steps_trained": 35964, "entropy": 0.6893414258956909, "vf_loss_unclipped": 46.250030517578125, "vf_explained_var": 0.002024531364440918, "num_module_steps_trained_lifetime": 431568}, "__all_modules__": {"num_env_steps_trained": 189000, "num_module_steps_trained": 71928, "num_module_steps_trained_lifetime": 863136, "num_env_steps_trained_lifetime": 2268000, "num_env_steps_trained_lifetime_throughput": 42499.474161387945}, "intrinsic_reward_module": {"num_module_steps_trained_lifetime": 431568, "diff_num_grad_updates_vs_sampler_policy": 61.0, "total_loss": 0.0, "module_train_batch_size_mean": 999.0, "weights_seq_no": 72.0, "num_module_steps_trained": 35964}}}, "__all_modules__": {"num_trainable_parameters": 24861, "num_env_steps_trained": 31500, "num_module_steps_trained": 11988, "num_non_trainable_parameters": 0, "num_module_steps_trained_lifetime": 143856, "num_env_steps_trained_lifetime": 378000, "num_env_steps_trained_lifetime_throughput": 3567.0136389691493, "num_module_steps_trained_throughput": 20747152.986180246, "num_module_steps_trained_lifetime_throughput": 11122577.071671184}, "IntrinsicAttentionMask": [[[0.3318576514720917, 0.33410122990608215, 0.33404120802879333], [0.3311832547187805, 0.3344521224498749, 0.33436456322669983], [0.3312012553215027, 0.33444279432296753, 0.3343559503555298]], [[0.33356210589408875, 0.33426234126091003, 0.3321755528450012], [0.333650141954422, 0.33462223410606384, 0.33172762393951416], [0.33338630199432373, 0.3335476219654083, 0.33306610584259033]], [[0.3333762288093567, 0.3333333134651184, 0.3332904577255249], [0.3333755135536194, 0.3333333432674408, 0.3332911729812622], [0.3333747684955597, 0.3333333432674408, 0.3332919180393219]], [[0.3334607481956482, 0.33306416869163513, 0.3334750533103943], [0.33273741602897644, 0.33459192514419556, 0.33267074823379517], [0.33348679542541504, 0.33300915360450745, 0.3335040211677551]], [[0.33514684438705444, 0.33248889446258545, 0.3323643207550049], [0.33492112159729004, 0.33259397745132446, 0.3324848711490631], [0.33491051197052, 0.3325989544391632, 0.33249056339263916]], [[0.33949413895606995, 0.3213365972042084, 0.33916932344436646], [0.25254198908805847, 0.4919663071632385, 0.255491703748703], [0.3380948007106781, 0.32405993342399597, 0.3378452658653259]]]}, "num_training_step_calls_per_iteration": 1, "evaluation": {"env_runners": {"env_to_module_connector": {"timers": {"connectors": {"add_observations_from_episodes_to_batch": 3.1746062869298006e-06, "numpy_to_tensor": 1.4162386088566792e-05, "batch_individual_items": 1.4186877660456868e-05, "add_states_from_episodes_to_batch": 3.124095421381901e-06, "add_time_dim_to_batch_and_zero_pad": 8.19230155318091e-06}}, "connector_pipeline_timer": 6.698575978215541e-05}, "num_module_steps_sampled_lifetime": {"default_policy": 4800}, "num_env_steps_sampled_lifetime": 60400, "weights_seq_no": 12.0, "module_to_env_connector": {"timers": {"connectors": {"get_actions": 4.663733871866467e-05, "un_batch_to_individual_items": 7.697120942738813e-06, "listify_data_for_vector_env": 1.2011590446827193e-05, "remove_single_ts_time_rank_from_batch": 1.359421857570929e-05, "normalize_and_clip_actions": 8.987348956841925e-06, "tensor_to_numpy": 1.848357015745622e-05}}, "connector_pipeline_timer": 0.00013788851117187094}, "episode_return_min": -13.5, "rlmodule_inference_timer": 3.80841854677726e-05, "num_episodes": 20, "num_agent_steps_sampled": {"default_agent": 400}, "num_env_steps_sampled": 400, "episode_len_max": 20, "env_to_module_sum_episodes_length_in": 10.368238394574323, "agent_episode_returns_mean": {"default_agent": 1.9}, "env_reset_timer": 0.0005678995931274688, "episode_len_min": 20, "env_to_module_sum_episodes_length_out": 10.368238394574323, "env_step_timer": 1.585534594863605e-05, "episode_len_mean": 20.0, "episode_duration_sec_mean": 0.005569781708763912, "num_module_steps_sampled": {"default_policy": 400}, "module_episode_returns_mean": {"default_policy": 1.9}, "sample": 0.12095820777302538, "num_agent_steps_sampled_lifetime": {"default_agent": 4800}, "num_episodes_lifetime": 240, "episode_return_max": 15.5, "episode_return_mean": 1.9, "time_between_sampling": 11.138768267579039}, "num_healthy_workers": 1, "actor_manager_num_outstanding_async_reqs": 0, "num_remote_worker_restarts": 0}, "num_env_steps_sampled_lifetime": -6165000.0, "fault_tolerance": {"num_healthy_workers": 0, "num_remote_worker_restarts": 0}, "env_runner_group": {"actor_manager_num_outstanding_async_reqs": 0}, "done": false, "training_iteration": 12, "trial_id": "b7d6e_00000", "date": "2025-08-11_18-10-24", "timestamp": 1754928624, "time_this_iter_s": 11.354289054870605, "time_total_s": 135.69089126586914, "pid": 10343, "hostname": "Mac", "node_ip": "127.0.0.1", "config": {"exploration_config": {}, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 2, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "env": "Umbrella", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": false, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 0, "create_local_env_runner": true, "num_envs_per_env_runner": 1, "gym_env_vectorize_mode": "SYNC", "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "episodes_to_numpy": true, "max_requests_in_flight_per_env_runner": 1, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "merge_env_runner_states": "training_only", "broadcast_env_runner_states": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "complete_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "sampler_perf_stats_ema_coef": null, "_is_online": true, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": "auto", "num_aggregator_actors_per_learner": 0, "max_requests_in_flight_per_aggregator_actor": 3, "local_gpu_idx": 0, "max_requests_in_flight_per_learner": 3, "gamma": 1, "lr": 0.0002715581955, "grad_clip": 0.5, "grad_clip_by": "global_norm", "_train_batch_size_per_learner": 5000, "train_batch_size": 4000, "num_epochs": 1, "minibatch_size": 1000, "shuffle_batch_per_epoch": true, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "log_std_clip_param": 20.0, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "_disable_preprocessor_api": false, "_disable_action_flattening": false}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {"intrinsic_reward_coeff": 0.2795015916508}, "optimizer": {}, "_learner_class": "<class 'source.intrinsic_attention_ppo.learners.IntrinsicAttentionMetaLearner.IntrinsicAttentionMetaLearner'>", "callbacks_on_algorithm_init": null, "callbacks_on_env_runners_recreated": null, "callbacks_on_offline_eval_runners_recreated": null, "callbacks_on_checkpoint_loaded": null, "callbacks_on_environment_created": null, "callbacks_on_episode_created": null, "callbacks_on_episode_start": null, "callbacks_on_episode_step": null, "callbacks_on_episode_end": null, "callbacks_on_evaluate_start": null, "callbacks_on_evaluate_end": null, "callbacks_on_evaluate_offline_start": null, "callbacks_on_evaluate_offline_end": null, "callbacks_on_sample_end": null, "callbacks_on_train_result": null, "explore": true, "enable_rl_module_and_learner": true, "enable_env_runner_and_connector_v2": true, "_prior_exploration_config": {"type": "StochasticSampling"}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x1616f98a0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "offline_data_class": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_read_batch_size": null, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "materialize_data": false, "materialize_mapped_data": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "ignore_final_observation": false, "prelearner_class": null, "prelearner_buffer_class": null, "prelearner_buffer_kwargs": {}, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_remaining_data": false, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": 1, "evaluation_duration": 20, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_auto_duration_min_env_steps_per_sample": 100, "evaluation_auto_duration_max_env_steps_per_sample": 2000, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 1, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "offline_evaluation_interval": null, "num_offline_eval_runners": 0, "offline_loss_for_module_fn": null, "offline_evaluation_duration": 1, "offline_evaluation_parallel_to_training": false, "offline_evaluation_timeout_s": 120.0, "num_cpus_per_offline_eval_runner": 1, "num_gpus_per_offline_eval_runner": 0, "custom_resources_per_offline_eval_runner": {}, "restart_failed_offline_eval_runners": true, "ignore_offline_eval_runner_failures": false, "max_num_offline_eval_runner_restarts": 1000, "offline_eval_runner_restore_timeout_s": 1800.0, "max_requests_in_flight_per_offline_eval_runner": 1, "validate_offline_eval_runners_after_construction": true, "offline_eval_runner_health_probe_timeout_s": 30.0, "offline_eval_rl_module_inference_only": false, "broadcast_offline_eval_runner_states": false, "offline_eval_batch_size_per_runner": 256, "dataset_num_iters_per_eval_runner": 1, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "log_gradients": false, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 9, "restart_failed_env_runners": true, "ignore_env_runner_failures": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30.0, "env_runner_restore_timeout_s": 1800.0, "_model_config": {}, "_rl_module_spec": "MultiRLModuleSpec(multi_rl_module_class=<class 'ray.rllib.core.rl_module.multi_rl_module.MultiRLModule'>, observation_space=None, action_space=None, inference_only=False, model_config=None, rl_module_specs={'default_policy': RLModuleSpec(module_class=<class 'source.intrinsic_attention_ppo.rl_modules.DifferentiablePPOModule.DifferentiablePPOModule'>, observation_space=None, action_space=None, inference_only=False, learner_only=False, model_config={'vf_share_layers': True, 'embedding_dim': 62, 'max_seq_len': 3, 'policy_head_hidden_sizes': [32], 'value_head_hidden_sizes': [101], 'embedding_hidden_sizes': [121]}, catalog_class=None, load_state_path=None, model_config_dict=None), 'intrinsic_reward_module': RLModuleSpec(module_class=<class 'source.intrinsic_attention_ppo.rl_modules.IntrinsicAttentionModule.IntrinsicAttentionModule'>, observation_space=None, action_space=None, inference_only=False, learner_only=True, model_config={'intrinsic_reward_network': {'encoder_hidden_sizes': [], 'encoding_dim': 1, 'num_heads': 1, 'head_hidden_sizes': None, 'layers': [{'type': 'attention'}]}, 'extrinsic_value_hidden_layers': [127, 60], 'vf_share_layers': True, 'max_seq_len': 3}, catalog_class=None, load_state_path=None, model_config_dict=None)}, load_state_path=None, modules_to_load=None, module_specs={'default_policy': RLModuleSpec(module_class=<class 'source.intrinsic_attention_ppo.rl_modules.DifferentiablePPOModule.DifferentiablePPOModule'>, observation_space=None, action_space=None, inference_only=False, learner_only=False, model_config={'vf_share_layers': True, 'embedding_dim': 62, 'max_seq_len': 3, 'policy_head_hidden_sizes': [32], 'value_head_hidden_sizes': [101], 'embedding_hidden_sizes': [121]}, catalog_class=None, load_state_path=None, model_config_dict=None), 'intrinsic_reward_module': RLModuleSpec(module_class=<class 'source.intrinsic_attention_ppo.rl_modules.IntrinsicAttentionModule.IntrinsicAttentionModule'>, observation_space=None, action_space=None, inference_only=False, learner_only=True, model_config={'intrinsic_reward_network': {'encoder_hidden_sizes': [], 'encoding_dim': 1, 'num_heads': 1, 'head_hidden_sizes': None, 'layers': [{'type': 'attention'}]}, 'extrinsic_value_hidden_layers': [127, 60], 'vf_share_layers': True, 'max_seq_len': 3}, catalog_class=None, load_state_path=None, model_config_dict=None)})", "algorithm_config_overrides_per_module": {"intrinsic_reward_module": {"lr": 0.0002715581955}}, "_per_module_overrides": {}, "_validate_config": true, "_use_msgpack_checkpoints": false, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "env_task_fn": -1, "enable_connectors": -1, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.161583927863, "kl_target": 0.0201019014258, "vf_loss_coeff": 0.7790510010087, "entropy_coeff": 0.0015431216992, "clip_param": 0.2459212356676, "vf_clip_param": 0.3769744131561, "entropy_coeff_schedule": null, "lr_schedule": null, "sgd_minibatch_size": -1, "vf_share_layers": -1, "differentiable_learner_configs": ["DifferentiableLearnerConfig(learner_class=<class 'source.intrinsic_attention_ppo.learners.IntrinsicAttentionPPOLearner.IntrinsicAttentionPPOLearner'>, learner_connector=None, add_default_connectors_to_learner_pipeline=True, is_multi_agent=False, policies_to_update=['default_policy'], lr=0.0060984166342, num_total_minibatches=0, num_epochs=1, minibatch_size=1000, shuffle_batch_per_epoch=True)"], "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9485408017724, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.callbacks.callbacks.RLlibCallback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 135.69089126586914, "iterations_since_restore": 12, "perf": {"cpu_util_percent": 42.5375, "ram_util_percent": 82.30624999999999}}
{"timers": {"training_iteration": 10.465662095838377, "restore_env_runners": 6.0840391774462996e-05, "training_step": 10.46532834289021, "env_runner_sampling_timer": 1.7579319953403676, "learner_update_timer": 8.481555637613633, "synch_weights": 0.0017562775479093217, "restore_eval_env_runners": 5.692570390101329e-05, "evaluation_iteration": 0.13260403288424807, "synch_eval_env_connectors": 0.00018650261469738494, "synch_env_connectors": 4.479614138758265e-06}, "env_runners": {"env_to_module_connector": {"timers": {"connectors": {"numpy_to_tensor": 1.5773703417643794e-05, "add_time_dim_to_batch_and_zero_pad": 8.374622202717725e-06, "batch_individual_items": 1.4851741802498089e-05, "add_observations_from_episodes_to_batch": 3.375905138236525e-06, "add_states_from_episodes_to_batch": 3.237761185307183e-06}}, "connector_pipeline_timer": 7.106943116704233e-05}, "module_to_env_connector": {"timers": {"connectors": {"tensor_to_numpy": 1.8136788766481235e-05, "un_batch_to_individual_items": 7.739559339689976e-06, "listify_data_for_vector_env": 1.2468201866148532e-05, "get_actions": 4.852042849500206e-05, "remove_single_ts_time_rank_from_batch": 1.3894450007939393e-05, "normalize_and_clip_actions": 9.507562057714385e-06}}, "connector_pipeline_timer": 0.00014159286754346156}, "module_episode_returns_mean": {"default_policy": 5.380000000000001}, "episode_len_min": 20, "env_reset_timer": 5.340735257932012e-05, "agent_episode_returns_mean": {"default_agent": 5.380000000000001}, "time_between_sampling": 0.039797630050104935, "env_to_module_sum_episodes_length_out": 10.36823839457432, "num_module_steps_sampled": {"default_policy": 5000.0}, "env_step_timer": 1.745987478927843e-05, "weights_seq_no": 12.0, "num_env_steps_sampled_lifetime": -6782500.0, "num_agent_steps_sampled": {"default_agent": 5000.0}, "num_episodes_lifetime": -339125.0, "episode_len_mean": 20.0, "episode_duration_sec_mean": 0.006368010024074467, "episode_return_max": 14.5, "episode_len_max": 20, "num_module_steps_sampled_lifetime": {"default_policy": -6782500.0}, "episode_return_min": -5.5, "rlmodule_inference_timer": 3.842116504702275e-05, "episode_return_mean": 5.380000000000001, "env_to_module_sum_episodes_length_in": 10.36823839457432, "num_agent_steps_sampled_lifetime": {"default_agent": -6782500.0}, "num_episodes": 250.0, "sample": 0.006355006656669657, "num_env_steps_sampled": 5000.0, "num_env_steps_sampled_lifetime_throughput": 2781.7151309771625}, "__all_modules__": {"learner_connector_sum_episodes_length_in": 5000.0, "learner_connector": {"connector_pipeline_timer": 0.18393449220017427, "timers": {"connectors": {"add_one_ts_to_episodes_and_truncate": 0.009539946967561845, "add_observations_from_episodes_to_batch": 0.0008539214544036226, "add_columns_from_episodes_to_train_batch": 0.04273942045379209, "add_time_dim_to_batch_and_zero_pad": 0.1101464207522032, "add_states_from_episodes_to_batch": 0.003939380520212898, "batch_individual_items": 0.016441574935201146, "numpy_to_tensor": 8.564487138128914e-05}}}, "learner_connector_sum_episodes_length_out": 5250.0}, "learners": {"default_policy": {"num_module_steps_trained_lifetime": 77922, "policy_loss": -0.0005324980011209846, "diff_num_grad_updates_vs_sampler_policy": 1.0, "num_trainable_parameters": 16595, "mean_kl_loss": 3.0900821002433077e-05, "curr_entropy_coeff": 0.0015431216992, "total_loss": 0.20397217571735382, "module_train_batch_size_mean": 999.0, "curr_kl_coeff": 1.9724600861081854e-05, "use_intrinsic_rewards": 0.0, "weights_seq_no": 13.0, "vf_loss": 0.26386910676956177, "num_module_steps_trained": 5994, "entropy": 0.6887425780296326, "vf_loss_unclipped": 48.55445861816406, "vf_explained_var": 0.0002665519714355469, "num_module_steps_trained_lifetime_throughput": 675.0971759756683}, "intrinsic_reward_module": {"diff_num_grad_updates_vs_sampler_policy": 1.0, "gradients_default_optimizer_global_norm": 0.0, "num_trainable_parameters": 8266, "curr_entropy_coeff": 0.0015431216992, "total_loss": 0.0, "module_train_batch_size_mean": 999.0, "default_optimizer_learning_rate": 0.0002715581955, "weights_seq_no": 13.0, "num_module_steps_trained": 5994, "num_module_steps_trained_lifetime": 77922, "num_module_steps_trained_lifetime_throughput": 675.1042201689912}, "differentiable_learners": {"intrinsic_attention_ppo_learner": {"default_policy": {"policy_loss": -0.0005102107534185052, "diff_num_grad_updates_vs_sampler_policy": 66.0, "mean_kl_loss": 2.827314892783761e-05, "total_loss": 0.20406612753868103, "module_train_batch_size_mean": 999.0, "use_intrinsic_rewards": 1.0, "weights_seq_no": 78.0, "vf_loss": 0.2639552354812622, "num_module_steps_trained": 35964, "entropy": 0.6887744665145874, "vf_loss_unclipped": 48.37982177734375, "vf_explained_var": 0.001972019672393799, "num_module_steps_trained_lifetime": 467532}, "__all_modules__": {"num_env_steps_trained": 189000, "num_module_steps_trained": 71928, "num_module_steps_trained_lifetime": 935064, "num_env_steps_trained_lifetime": 2457000, "num_env_steps_trained_lifetime_throughput": 41758.02916151772}, "intrinsic_reward_module": {"num_module_steps_trained_lifetime": 467532, "diff_num_grad_updates_vs_sampler_policy": 66.0, "total_loss": 0.0, "module_train_batch_size_mean": 999.0, "weights_seq_no": 78.0, "num_module_steps_trained": 35964}}}, "__all_modules__": {"num_trainable_parameters": 24861, "num_env_steps_trained": 31500, "num_module_steps_trained": 11988, "num_non_trainable_parameters": 0, "num_module_steps_trained_lifetime": 155844, "num_env_steps_trained_lifetime": 409500, "num_env_steps_trained_lifetime_throughput": 3547.9002103003413, "num_module_steps_trained_throughput": 20251695.314166944, "num_module_steps_trained_lifetime_throughput": 11127615.090613352}, "IntrinsicAttentionMask": [[[0.33266469836235046, 0.33369767665863037, 0.33363771438598633], [0.332523912191391, 0.3337743282318115, 0.3337017595767975], [0.3325320780277252, 0.33376988768577576, 0.333698034286499]], [[0.33434537053108215, 0.3342941105365753, 0.3313605785369873], [0.3343309164047241, 0.3342803716659546, 0.3313887417316437], [0.33349940180778503, 0.3334910273551941, 0.3330095708370209]], [[0.33346042037010193, 0.333333283662796, 0.3332062065601349], [0.3334597051143646, 0.3333333134651184, 0.3332069516181946], [0.3334589898586273, 0.3333333134651184, 0.3332076966762543]], [[0.3332485258579254, 0.3336729407310486, 0.3330785036087036], [0.33279621601104736, 0.33547624945640564, 0.331727534532547], [0.33342862129211426, 0.33295106887817383, 0.3336203098297119]], [[0.33344343304634094, 0.3333333134651184, 0.3332231938838959], [0.33344271779060364, 0.3333333134651184, 0.33322396874427795], [0.33344197273254395, 0.333333283662796, 0.33322465419769287]], [[0.3399291932582855, 0.3211249113082886, 0.3389458656311035], [0.24480454623699188, 0.5012940764427185, 0.2539013624191284], [0.335375040769577, 0.3295489549636841, 0.3350760042667389]]]}, "num_training_step_calls_per_iteration": 1, "evaluation": {"env_runners": {"env_to_module_connector": {"timers": {"connectors": {"add_observations_from_episodes_to_batch": 2.8007496782246985e-06, "numpy_to_tensor": 1.1945139697036115e-05, "batch_individual_items": 1.2447222513105497e-05, "add_states_from_episodes_to_batch": 2.7739611907874404e-06, "add_time_dim_to_batch_and_zero_pad": 7.037446174734658e-06}}, "connector_pipeline_timer": 5.926676010261643e-05}, "num_module_steps_sampled_lifetime": {"default_policy": 5200}, "num_env_steps_sampled_lifetime": 65400, "weights_seq_no": 13.0, "module_to_env_connector": {"timers": {"connectors": {"get_actions": 3.6166757069820556e-05, "un_batch_to_individual_items": 6.457916311248778e-06, "listify_data_for_vector_env": 1.0283095089604442e-05, "remove_single_ts_time_rank_from_batch": 1.1704051384569563e-05, "normalize_and_clip_actions": 7.842886056784798e-06, "tensor_to_numpy": 1.5140492722646979e-05}}, "connector_pipeline_timer": 0.00011389266953331036}, "episode_return_min": -13.5, "rlmodule_inference_timer": 3.0893371604404736e-05, "num_episodes": 20, "num_agent_steps_sampled": {"default_agent": 400}, "num_env_steps_sampled": 400, "episode_len_max": 20, "env_to_module_sum_episodes_length_in": 10.368238394574323, "agent_episode_returns_mean": {"default_agent": 1.5}, "env_reset_timer": 0.0005657914369588818, "episode_len_min": 20, "env_to_module_sum_episodes_length_out": 10.368238394574323, "env_step_timer": 1.385531861437892e-05, "episode_len_mean": 20.0, "episode_duration_sec_mean": 0.005555783354211598, "num_module_steps_sampled": {"default_policy": 400}, "module_episode_returns_mean": {"default_policy": 1.5}, "sample": 0.12091173153539138, "num_agent_steps_sampled_lifetime": {"default_agent": 5200}, "num_episodes_lifetime": 260, "episode_return_max": 15.5, "episode_return_mean": 1.5, "time_between_sampling": 11.141986738233781}, "num_healthy_workers": 1, "actor_manager_num_outstanding_async_reqs": 0, "num_remote_worker_restarts": 0}, "num_env_steps_sampled_lifetime": -6782500.0, "fault_tolerance": {"num_healthy_workers": 0, "num_remote_worker_restarts": 0}, "env_runner_group": {"actor_manager_num_outstanding_async_reqs": 0}, "done": false, "training_iteration": 13, "trial_id": "b7d6e_00000", "date": "2025-08-11_18-10-36", "timestamp": 1754928636, "time_this_iter_s": 11.550126075744629, "time_total_s": 147.24101734161377, "pid": 10343, "hostname": "Mac", "node_ip": "127.0.0.1", "config": {"exploration_config": {}, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 2, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "env": "Umbrella", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": false, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 0, "create_local_env_runner": true, "num_envs_per_env_runner": 1, "gym_env_vectorize_mode": "SYNC", "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "episodes_to_numpy": true, "max_requests_in_flight_per_env_runner": 1, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "merge_env_runner_states": "training_only", "broadcast_env_runner_states": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "complete_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "sampler_perf_stats_ema_coef": null, "_is_online": true, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": "auto", "num_aggregator_actors_per_learner": 0, "max_requests_in_flight_per_aggregator_actor": 3, "local_gpu_idx": 0, "max_requests_in_flight_per_learner": 3, "gamma": 1, "lr": 0.0002715581955, "grad_clip": 0.5, "grad_clip_by": "global_norm", "_train_batch_size_per_learner": 5000, "train_batch_size": 4000, "num_epochs": 1, "minibatch_size": 1000, "shuffle_batch_per_epoch": true, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "log_std_clip_param": 20.0, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "_disable_preprocessor_api": false, "_disable_action_flattening": false}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {"intrinsic_reward_coeff": 0.2795015916508}, "optimizer": {}, "_learner_class": "<class 'source.intrinsic_attention_ppo.learners.IntrinsicAttentionMetaLearner.IntrinsicAttentionMetaLearner'>", "callbacks_on_algorithm_init": null, "callbacks_on_env_runners_recreated": null, "callbacks_on_offline_eval_runners_recreated": null, "callbacks_on_checkpoint_loaded": null, "callbacks_on_environment_created": null, "callbacks_on_episode_created": null, "callbacks_on_episode_start": null, "callbacks_on_episode_step": null, "callbacks_on_episode_end": null, "callbacks_on_evaluate_start": null, "callbacks_on_evaluate_end": null, "callbacks_on_evaluate_offline_start": null, "callbacks_on_evaluate_offline_end": null, "callbacks_on_sample_end": null, "callbacks_on_train_result": null, "explore": true, "enable_rl_module_and_learner": true, "enable_env_runner_and_connector_v2": true, "_prior_exploration_config": {"type": "StochasticSampling"}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x1616f98a0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "offline_data_class": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_read_batch_size": null, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "materialize_data": false, "materialize_mapped_data": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "ignore_final_observation": false, "prelearner_class": null, "prelearner_buffer_class": null, "prelearner_buffer_kwargs": {}, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_remaining_data": false, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": 1, "evaluation_duration": 20, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_auto_duration_min_env_steps_per_sample": 100, "evaluation_auto_duration_max_env_steps_per_sample": 2000, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 1, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "offline_evaluation_interval": null, "num_offline_eval_runners": 0, "offline_loss_for_module_fn": null, "offline_evaluation_duration": 1, "offline_evaluation_parallel_to_training": false, "offline_evaluation_timeout_s": 120.0, "num_cpus_per_offline_eval_runner": 1, "num_gpus_per_offline_eval_runner": 0, "custom_resources_per_offline_eval_runner": {}, "restart_failed_offline_eval_runners": true, "ignore_offline_eval_runner_failures": false, "max_num_offline_eval_runner_restarts": 1000, "offline_eval_runner_restore_timeout_s": 1800.0, "max_requests_in_flight_per_offline_eval_runner": 1, "validate_offline_eval_runners_after_construction": true, "offline_eval_runner_health_probe_timeout_s": 30.0, "offline_eval_rl_module_inference_only": false, "broadcast_offline_eval_runner_states": false, "offline_eval_batch_size_per_runner": 256, "dataset_num_iters_per_eval_runner": 1, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "log_gradients": false, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 9, "restart_failed_env_runners": true, "ignore_env_runner_failures": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30.0, "env_runner_restore_timeout_s": 1800.0, "_model_config": {}, "_rl_module_spec": "MultiRLModuleSpec(multi_rl_module_class=<class 'ray.rllib.core.rl_module.multi_rl_module.MultiRLModule'>, observation_space=None, action_space=None, inference_only=False, model_config=None, rl_module_specs={'default_policy': RLModuleSpec(module_class=<class 'source.intrinsic_attention_ppo.rl_modules.DifferentiablePPOModule.DifferentiablePPOModule'>, observation_space=None, action_space=None, inference_only=False, learner_only=False, model_config={'vf_share_layers': True, 'embedding_dim': 62, 'max_seq_len': 3, 'policy_head_hidden_sizes': [32], 'value_head_hidden_sizes': [101], 'embedding_hidden_sizes': [121]}, catalog_class=None, load_state_path=None, model_config_dict=None), 'intrinsic_reward_module': RLModuleSpec(module_class=<class 'source.intrinsic_attention_ppo.rl_modules.IntrinsicAttentionModule.IntrinsicAttentionModule'>, observation_space=None, action_space=None, inference_only=False, learner_only=True, model_config={'intrinsic_reward_network': {'encoder_hidden_sizes': [], 'encoding_dim': 1, 'num_heads': 1, 'head_hidden_sizes': None, 'layers': [{'type': 'attention'}]}, 'extrinsic_value_hidden_layers': [127, 60], 'vf_share_layers': True, 'max_seq_len': 3}, catalog_class=None, load_state_path=None, model_config_dict=None)}, load_state_path=None, modules_to_load=None, module_specs={'default_policy': RLModuleSpec(module_class=<class 'source.intrinsic_attention_ppo.rl_modules.DifferentiablePPOModule.DifferentiablePPOModule'>, observation_space=None, action_space=None, inference_only=False, learner_only=False, model_config={'vf_share_layers': True, 'embedding_dim': 62, 'max_seq_len': 3, 'policy_head_hidden_sizes': [32], 'value_head_hidden_sizes': [101], 'embedding_hidden_sizes': [121]}, catalog_class=None, load_state_path=None, model_config_dict=None), 'intrinsic_reward_module': RLModuleSpec(module_class=<class 'source.intrinsic_attention_ppo.rl_modules.IntrinsicAttentionModule.IntrinsicAttentionModule'>, observation_space=None, action_space=None, inference_only=False, learner_only=True, model_config={'intrinsic_reward_network': {'encoder_hidden_sizes': [], 'encoding_dim': 1, 'num_heads': 1, 'head_hidden_sizes': None, 'layers': [{'type': 'attention'}]}, 'extrinsic_value_hidden_layers': [127, 60], 'vf_share_layers': True, 'max_seq_len': 3}, catalog_class=None, load_state_path=None, model_config_dict=None)})", "algorithm_config_overrides_per_module": {"intrinsic_reward_module": {"lr": 0.0002715581955}}, "_per_module_overrides": {}, "_validate_config": true, "_use_msgpack_checkpoints": false, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "env_task_fn": -1, "enable_connectors": -1, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.161583927863, "kl_target": 0.0201019014258, "vf_loss_coeff": 0.7790510010087, "entropy_coeff": 0.0015431216992, "clip_param": 0.2459212356676, "vf_clip_param": 0.3769744131561, "entropy_coeff_schedule": null, "lr_schedule": null, "sgd_minibatch_size": -1, "vf_share_layers": -1, "differentiable_learner_configs": ["DifferentiableLearnerConfig(learner_class=<class 'source.intrinsic_attention_ppo.learners.IntrinsicAttentionPPOLearner.IntrinsicAttentionPPOLearner'>, learner_connector=None, add_default_connectors_to_learner_pipeline=True, is_multi_agent=False, policies_to_update=['default_policy'], lr=0.0060984166342, num_total_minibatches=0, num_epochs=1, minibatch_size=1000, shuffle_batch_per_epoch=True)"], "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9485408017724, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.callbacks.callbacks.RLlibCallback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 147.24101734161377, "iterations_since_restore": 13, "perf": {"cpu_util_percent": 43.35625, "ram_util_percent": 82.80000000000001}}
{"timers": {"training_iteration": 10.469472994880407, "restore_env_runners": 6.034323783071584e-05, "training_step": 10.469140287381403, "env_runner_sampling_timer": 1.757866516217616, "learner_update_timer": 8.484992571237363, "synch_weights": 0.0017566118528274618, "restore_eval_env_runners": 5.687185707294042e-05, "evaluation_iteration": 0.1325641158956565, "synch_eval_env_connectors": 0.0001905867584134265, "synch_env_connectors": 4.47522691973003e-06}, "env_runners": {"env_to_module_connector": {"timers": {"connectors": {"numpy_to_tensor": 1.3215006675885764e-05, "add_time_dim_to_batch_and_zero_pad": 7.319508134481579e-06, "batch_individual_items": 1.2959529163964096e-05, "add_observations_from_episodes_to_batch": 2.933791958578313e-06, "add_states_from_episodes_to_batch": 2.866988583879586e-06}}, "connector_pipeline_timer": 6.225156735295621e-05}, "module_to_env_connector": {"timers": {"connectors": {"tensor_to_numpy": 1.5715945143377463e-05, "un_batch_to_individual_items": 6.839921620243374e-06, "listify_data_for_vector_env": 1.0871097176888892e-05, "get_actions": 4.031680942930666e-05, "remove_single_ts_time_rank_from_batch": 1.2335102546266573e-05, "normalize_and_clip_actions": 8.361038690586118e-06}}, "connector_pipeline_timer": 0.00012188814611597748}, "module_episode_returns_mean": {"default_policy": 5.0600000000000005}, "episode_len_min": 20, "env_reset_timer": 4.941292673404793e-05, "agent_episode_returns_mean": {"default_agent": 5.0600000000000005}, "time_between_sampling": 0.039444056412881436, "env_to_module_sum_episodes_length_out": 10.36823839457432, "num_module_steps_sampled": {"default_policy": 5000.0}, "env_step_timer": 1.458439961235323e-05, "weights_seq_no": 13.0, "num_env_steps_sampled_lifetime": -7400000.0, "num_agent_steps_sampled": {"default_agent": 5000.0}, "num_episodes_lifetime": -370000.0, "episode_len_mean": 20.0, "episode_duration_sec_mean": 0.0060819601383991515, "episode_return_max": 14.5, "episode_len_max": 20, "num_module_steps_sampled_lifetime": {"default_policy": -7400000.0}, "episode_return_min": -5.5, "rlmodule_inference_timer": 6.552498603920914e-05, "episode_return_mean": 5.0600000000000005, "env_to_module_sum_episodes_length_in": 10.36823839457432, "num_agent_steps_sampled_lifetime": {"default_agent": -7400000.0}, "num_episodes": 250.0, "sample": 0.006686152816595198, "num_env_steps_sampled": 5000.0, "num_env_steps_sampled_lifetime_throughput": 3110.66833264703}, "__all_modules__": {"learner_connector_sum_episodes_length_in": 5000.0, "learner_connector": {"connector_pipeline_timer": 0.18417493310874664, "timers": {"connectors": {"add_one_ts_to_episodes_and_truncate": 0.009541418747729615, "add_observations_from_episodes_to_batch": 0.0008563743200656379, "add_columns_from_episodes_to_train_batch": 0.042836719169989275, "add_time_dim_to_batch_and_zero_pad": 0.11028456946442526, "add_states_from_episodes_to_batch": 0.003940290884535231, "batch_individual_items": 0.016441413356225943, "numpy_to_tensor": 8.606092362576991e-05}}}, "learner_connector_sum_episodes_length_out": 5250.0}, "learners": {"default_policy": {"num_module_steps_trained_lifetime": 83916, "policy_loss": -0.00022826954955235124, "diff_num_grad_updates_vs_sampler_policy": 1.0, "num_trainable_parameters": 16595, "mean_kl_loss": 2.6981715564033948e-05, "curr_entropy_coeff": 0.0015431216992, "total_loss": 0.20427647233009338, "module_train_batch_size_mean": 999.0, "curr_kl_coeff": 9.862300430540927e-06, "use_intrinsic_rewards": 0.0, "weights_seq_no": 14.0, "vf_loss": 0.26386722922325134, "num_module_steps_trained": 5994, "entropy": 0.6877639293670654, "vf_loss_unclipped": 44.97800064086914, "vf_explained_var": 7.218122482299805e-05, "num_module_steps_trained_lifetime_throughput": 671.9328198723902}, "intrinsic_reward_module": {"diff_num_grad_updates_vs_sampler_policy": 1.0, "gradients_default_optimizer_global_norm": 0.0, "num_trainable_parameters": 8266, "curr_entropy_coeff": 0.0015431216992, "total_loss": 0.0, "module_train_batch_size_mean": 999.0, "default_optimizer_learning_rate": 0.0002715581955, "weights_seq_no": 14.0, "num_module_steps_trained": 5994, "num_module_steps_trained_lifetime": 83916, "num_module_steps_trained_lifetime_throughput": 671.9394007717208}, "differentiable_learners": {"intrinsic_attention_ppo_learner": {"default_policy": {"policy_loss": -0.00022412680846173316, "diff_num_grad_updates_vs_sampler_policy": 71.0, "mean_kl_loss": 2.5921188353095204e-05, "total_loss": 0.20434148609638214, "module_train_batch_size_mean": 999.0, "use_intrinsic_rewards": 1.0, "weights_seq_no": 84.0, "vf_loss": 0.2639400064945221, "num_module_steps_trained": 35964, "entropy": 0.6877790093421936, "vf_loss_unclipped": 44.851806640625, "vf_explained_var": 0.0018368363380432129, "num_module_steps_trained_lifetime": 503496}, "__all_modules__": {"num_env_steps_trained": 189000, "num_module_steps_trained": 71928, "num_module_steps_trained_lifetime": 1006992, "num_env_steps_trained_lifetime": 2646000, "num_env_steps_trained_lifetime_throughput": 41036.415134753726}, "intrinsic_reward_module": {"num_module_steps_trained_lifetime": 503496, "diff_num_grad_updates_vs_sampler_policy": 71.0, "total_loss": 0.0, "module_train_batch_size_mean": 999.0, "weights_seq_no": 84.0, "num_module_steps_trained": 35964}}}, "__all_modules__": {"num_trainable_parameters": 24861, "num_env_steps_trained": 31500, "num_module_steps_trained": 11988, "num_non_trainable_parameters": 0, "num_module_steps_trained_lifetime": 167832, "num_env_steps_trained_lifetime": 441000, "num_env_steps_trained_lifetime_throughput": 3531.266205202496, "num_module_steps_trained_throughput": 19805078.46207891, "num_module_steps_trained_lifetime_throughput": 11155283.054616624}, "IntrinsicAttentionMask": [[[0.33477312326431274, 0.3321804702281952, 0.33304640650749207], [0.3334316313266754, 0.33325454592704773, 0.33331382274627686], [0.33388057351112366, 0.33289480209350586, 0.3332245945930481]], [[0.336539089679718, 0.33396342396736145, 0.3294975757598877], [0.33612579107284546, 0.3338835835456848, 0.3299906253814697], [0.3354018032550812, 0.33374276757240295, 0.33085542917251587]], [[0.33268678188323975, 0.332574725151062, 0.33473849296569824], [0.3326910138130188, 0.33257967233657837, 0.3347293436527252], [0.3326099216938019, 0.33248457312583923, 0.3349055349826813]], [[0.3332486152648926, 0.3335180878639221, 0.3332333266735077], [0.33296313881874084, 0.33414044976234436, 0.3328964412212372], [0.3332647979259491, 0.3334827423095703, 0.3332524299621582]], [[0.332699179649353, 0.3348213732242584, 0.33247944712638855], [0.33261802792549133, 0.33501169085502625, 0.3323702812194824], [0.33270758390426636, 0.334801584482193, 0.3324907720088959]], [[0.342951238155365, 0.31554827094078064, 0.341500461101532], [0.24812619388103485, 0.49487265944480896, 0.25700122117996216], [0.33842968940734863, 0.32389596104621887, 0.3376743197441101]]]}, "num_training_step_calls_per_iteration": 1, "evaluation": {"env_runners": {"env_to_module_connector": {"timers": {"connectors": {"add_observations_from_episodes_to_batch": 2.7962948919613807e-06, "numpy_to_tensor": 1.202733287981093e-05, "batch_individual_items": 1.2301899681041253e-05, "add_states_from_episodes_to_batch": 2.7790131852938034e-06, "add_time_dim_to_batch_and_zero_pad": 6.816345773812782e-06}}, "connector_pipeline_timer": 5.879063329301672e-05}, "num_module_steps_sampled_lifetime": {"default_policy": 5600}, "num_env_steps_sampled_lifetime": 70400, "weights_seq_no": 14.0, "module_to_env_connector": {"timers": {"connectors": {"get_actions": 3.658679109497429e-05, "un_batch_to_individual_items": 6.430896328316563e-06, "listify_data_for_vector_env": 1.028629224059728e-05, "remove_single_ts_time_rank_from_batch": 1.1817768380340668e-05, "normalize_and_clip_actions": 7.89280106809577e-06, "tensor_to_numpy": 1.4735744449913777e-05}}, "connector_pipeline_timer": 0.00011384627143026107}, "episode_return_min": -13.5, "rlmodule_inference_timer": 3.097730366734903e-05, "num_episodes": 20, "num_agent_steps_sampled": {"default_agent": 400}, "num_env_steps_sampled": 400, "episode_len_max": 20, "env_to_module_sum_episodes_length_in": 10.368238394574323, "agent_episode_returns_mean": {"default_agent": 2.9}, "env_reset_timer": 0.0005633985230033962, "episode_len_min": 20, "env_to_module_sum_episodes_length_out": 10.368238394574323, "env_step_timer": 1.3748291185666871e-05, "episode_len_mean": 20.0, "episode_duration_sec_mean": 0.005475487033836543, "num_module_steps_sampled": {"default_policy": 400}, "module_episode_returns_mean": {"default_policy": 2.9}, "sample": 0.12086860464088746, "num_agent_steps_sampled_lifetime": {"default_agent": 5600}, "num_episodes_lifetime": 280, "episode_return_max": 15.5, "episode_return_mean": 2.9, "time_between_sampling": 11.139461663350929}, "num_healthy_workers": 1, "actor_manager_num_outstanding_async_reqs": 0, "num_remote_worker_restarts": 0}, "num_env_steps_sampled_lifetime": -7400000.0, "fault_tolerance": {"num_healthy_workers": 0, "num_remote_worker_restarts": 0}, "env_runner_group": {"actor_manager_num_outstanding_async_reqs": 0}, "done": false, "training_iteration": 14, "trial_id": "b7d6e_00000", "date": "2025-08-11_18-10-47", "timestamp": 1754928647, "time_this_iter_s": 10.975658893585205, "time_total_s": 158.21667623519897, "pid": 10343, "hostname": "Mac", "node_ip": "127.0.0.1", "config": {"exploration_config": {}, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 2, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "env": "Umbrella", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": false, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 0, "create_local_env_runner": true, "num_envs_per_env_runner": 1, "gym_env_vectorize_mode": "SYNC", "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "episodes_to_numpy": true, "max_requests_in_flight_per_env_runner": 1, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "merge_env_runner_states": "training_only", "broadcast_env_runner_states": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "complete_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "sampler_perf_stats_ema_coef": null, "_is_online": true, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": "auto", "num_aggregator_actors_per_learner": 0, "max_requests_in_flight_per_aggregator_actor": 3, "local_gpu_idx": 0, "max_requests_in_flight_per_learner": 3, "gamma": 1, "lr": 0.0002715581955, "grad_clip": 0.5, "grad_clip_by": "global_norm", "_train_batch_size_per_learner": 5000, "train_batch_size": 4000, "num_epochs": 1, "minibatch_size": 1000, "shuffle_batch_per_epoch": true, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "log_std_clip_param": 20.0, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "_disable_preprocessor_api": false, "_disable_action_flattening": false}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {"intrinsic_reward_coeff": 0.2795015916508}, "optimizer": {}, "_learner_class": "<class 'source.intrinsic_attention_ppo.learners.IntrinsicAttentionMetaLearner.IntrinsicAttentionMetaLearner'>", "callbacks_on_algorithm_init": null, "callbacks_on_env_runners_recreated": null, "callbacks_on_offline_eval_runners_recreated": null, "callbacks_on_checkpoint_loaded": null, "callbacks_on_environment_created": null, "callbacks_on_episode_created": null, "callbacks_on_episode_start": null, "callbacks_on_episode_step": null, "callbacks_on_episode_end": null, "callbacks_on_evaluate_start": null, "callbacks_on_evaluate_end": null, "callbacks_on_evaluate_offline_start": null, "callbacks_on_evaluate_offline_end": null, "callbacks_on_sample_end": null, "callbacks_on_train_result": null, "explore": true, "enable_rl_module_and_learner": true, "enable_env_runner_and_connector_v2": true, "_prior_exploration_config": {"type": "StochasticSampling"}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x1616f98a0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "offline_data_class": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_read_batch_size": null, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "materialize_data": false, "materialize_mapped_data": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "ignore_final_observation": false, "prelearner_class": null, "prelearner_buffer_class": null, "prelearner_buffer_kwargs": {}, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_remaining_data": false, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": 1, "evaluation_duration": 20, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_auto_duration_min_env_steps_per_sample": 100, "evaluation_auto_duration_max_env_steps_per_sample": 2000, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 1, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "offline_evaluation_interval": null, "num_offline_eval_runners": 0, "offline_loss_for_module_fn": null, "offline_evaluation_duration": 1, "offline_evaluation_parallel_to_training": false, "offline_evaluation_timeout_s": 120.0, "num_cpus_per_offline_eval_runner": 1, "num_gpus_per_offline_eval_runner": 0, "custom_resources_per_offline_eval_runner": {}, "restart_failed_offline_eval_runners": true, "ignore_offline_eval_runner_failures": false, "max_num_offline_eval_runner_restarts": 1000, "offline_eval_runner_restore_timeout_s": 1800.0, "max_requests_in_flight_per_offline_eval_runner": 1, "validate_offline_eval_runners_after_construction": true, "offline_eval_runner_health_probe_timeout_s": 30.0, "offline_eval_rl_module_inference_only": false, "broadcast_offline_eval_runner_states": false, "offline_eval_batch_size_per_runner": 256, "dataset_num_iters_per_eval_runner": 1, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "log_gradients": false, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 9, "restart_failed_env_runners": true, "ignore_env_runner_failures": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30.0, "env_runner_restore_timeout_s": 1800.0, "_model_config": {}, "_rl_module_spec": "MultiRLModuleSpec(multi_rl_module_class=<class 'ray.rllib.core.rl_module.multi_rl_module.MultiRLModule'>, observation_space=None, action_space=None, inference_only=False, model_config=None, rl_module_specs={'default_policy': RLModuleSpec(module_class=<class 'source.intrinsic_attention_ppo.rl_modules.DifferentiablePPOModule.DifferentiablePPOModule'>, observation_space=None, action_space=None, inference_only=False, learner_only=False, model_config={'vf_share_layers': True, 'embedding_dim': 62, 'max_seq_len': 3, 'policy_head_hidden_sizes': [32], 'value_head_hidden_sizes': [101], 'embedding_hidden_sizes': [121]}, catalog_class=None, load_state_path=None, model_config_dict=None), 'intrinsic_reward_module': RLModuleSpec(module_class=<class 'source.intrinsic_attention_ppo.rl_modules.IntrinsicAttentionModule.IntrinsicAttentionModule'>, observation_space=None, action_space=None, inference_only=False, learner_only=True, model_config={'intrinsic_reward_network': {'encoder_hidden_sizes': [], 'encoding_dim': 1, 'num_heads': 1, 'head_hidden_sizes': None, 'layers': [{'type': 'attention'}]}, 'extrinsic_value_hidden_layers': [127, 60], 'vf_share_layers': True, 'max_seq_len': 3}, catalog_class=None, load_state_path=None, model_config_dict=None)}, load_state_path=None, modules_to_load=None, module_specs={'default_policy': RLModuleSpec(module_class=<class 'source.intrinsic_attention_ppo.rl_modules.DifferentiablePPOModule.DifferentiablePPOModule'>, observation_space=None, action_space=None, inference_only=False, learner_only=False, model_config={'vf_share_layers': True, 'embedding_dim': 62, 'max_seq_len': 3, 'policy_head_hidden_sizes': [32], 'value_head_hidden_sizes': [101], 'embedding_hidden_sizes': [121]}, catalog_class=None, load_state_path=None, model_config_dict=None), 'intrinsic_reward_module': RLModuleSpec(module_class=<class 'source.intrinsic_attention_ppo.rl_modules.IntrinsicAttentionModule.IntrinsicAttentionModule'>, observation_space=None, action_space=None, inference_only=False, learner_only=True, model_config={'intrinsic_reward_network': {'encoder_hidden_sizes': [], 'encoding_dim': 1, 'num_heads': 1, 'head_hidden_sizes': None, 'layers': [{'type': 'attention'}]}, 'extrinsic_value_hidden_layers': [127, 60], 'vf_share_layers': True, 'max_seq_len': 3}, catalog_class=None, load_state_path=None, model_config_dict=None)})", "algorithm_config_overrides_per_module": {"intrinsic_reward_module": {"lr": 0.0002715581955}}, "_per_module_overrides": {}, "_validate_config": true, "_use_msgpack_checkpoints": false, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "env_task_fn": -1, "enable_connectors": -1, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.161583927863, "kl_target": 0.0201019014258, "vf_loss_coeff": 0.7790510010087, "entropy_coeff": 0.0015431216992, "clip_param": 0.2459212356676, "vf_clip_param": 0.3769744131561, "entropy_coeff_schedule": null, "lr_schedule": null, "sgd_minibatch_size": -1, "vf_share_layers": -1, "differentiable_learner_configs": ["DifferentiableLearnerConfig(learner_class=<class 'source.intrinsic_attention_ppo.learners.IntrinsicAttentionPPOLearner.IntrinsicAttentionPPOLearner'>, learner_connector=None, add_default_connectors_to_learner_pipeline=True, is_multi_agent=False, policies_to_update=['default_policy'], lr=0.0060984166342, num_total_minibatches=0, num_epochs=1, minibatch_size=1000, shuffle_batch_per_epoch=True)"], "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9485408017724, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.callbacks.callbacks.RLlibCallback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 158.21667623519897, "iterations_since_restore": 14, "perf": {"cpu_util_percent": 42.90625, "ram_util_percent": 81.60625}}
{"timers": {"training_iteration": 10.483908084100777, "restore_env_runners": 5.9847715470822946e-05, "training_step": 10.483576047008107, "env_runner_sampling_timer": 1.7616444718859237, "learner_update_timer": 8.493470120114448, "synch_weights": 0.0017671344848497106, "restore_eval_env_runners": 5.6662307709724346e-05, "evaluation_iteration": 0.13249643182755647, "synch_eval_env_connectors": 0.0001904063114179197, "synch_env_connectors": 4.471303832203872e-06}, "env_runners": {"env_to_module_connector": {"timers": {"connectors": {"numpy_to_tensor": 1.6814118227517232e-05, "add_time_dim_to_batch_and_zero_pad": 9.124427489137833e-06, "batch_individual_items": 1.5438752012432533e-05, "add_observations_from_episodes_to_batch": 3.590392890128649e-06, "add_states_from_episodes_to_batch": 3.3819240732431172e-06}}, "connector_pipeline_timer": 7.477828975361392e-05}, "module_to_env_connector": {"timers": {"connectors": {"tensor_to_numpy": 1.910472515860384e-05, "un_batch_to_individual_items": 8.044001082247942e-06, "listify_data_for_vector_env": 1.2848443994741778e-05, "get_actions": 5.315545564365782e-05, "remove_single_ts_time_rank_from_batch": 1.424833449970879e-05, "normalize_and_clip_actions": 9.770087580152497e-06}}, "connector_pipeline_timer": 0.00014945279195826893}, "module_episode_returns_mean": {"default_policy": 6.5}, "episode_len_min": 20, "env_reset_timer": 5.46119997037639e-05, "agent_episode_returns_mean": {"default_agent": 6.5}, "time_between_sampling": 0.037738672863586106, "env_to_module_sum_episodes_length_out": 10.36823839457432, "num_module_steps_sampled": {"default_policy": 5000.0}, "env_step_timer": 1.8479984903586795e-05, "weights_seq_no": 14.0, "num_env_steps_sampled_lifetime": -8017500.0, "num_agent_steps_sampled": {"default_agent": 5000.0}, "num_episodes_lifetime": -400875.0, "episode_len_mean": 20.0, "episode_duration_sec_mean": 0.0074177083135582534, "episode_return_max": 14.5, "episode_len_max": 20, "num_module_steps_sampled_lifetime": {"default_policy": -8017500.0}, "episode_return_min": -5.5, "rlmodule_inference_timer": 7.494106214319037e-05, "episode_return_mean": 6.5, "env_to_module_sum_episodes_length_in": 10.36823839457432, "num_agent_steps_sampled_lifetime": {"default_agent": -8017500.0}, "num_episodes": 250.0, "sample": 0.0071347665564948735, "num_env_steps_sampled": 5000.0, "num_env_steps_sampled_lifetime_throughput": 2744.3262045195693}, "__all_modules__": {"learner_connector_sum_episodes_length_in": 5000.0, "learner_connector": {"connector_pipeline_timer": 0.1858613746067518, "timers": {"connectors": {"add_one_ts_to_episodes_and_truncate": 0.009769928310800011, "add_observations_from_episodes_to_batch": 0.0008690197371966182, "add_columns_from_episodes_to_train_batch": 0.04347477989830305, "add_time_dim_to_batch_and_zero_pad": 0.1110213708498318, "add_states_from_episodes_to_batch": 0.003950513815727939, "batch_individual_items": 0.01649945089322467, "numpy_to_tensor": 8.66565641276243e-05}}}, "learner_connector_sum_episodes_length_out": 5250.0}, "learners": {"default_policy": {"num_module_steps_trained_lifetime": 89910, "policy_loss": -0.0006628866540268064, "diff_num_grad_updates_vs_sampler_policy": 1.0, "num_trainable_parameters": 16595, "mean_kl_loss": 3.893426401191391e-05, "curr_entropy_coeff": 0.0015431216992, "total_loss": 0.20384442806243896, "module_train_batch_size_mean": 999.0, "curr_kl_coeff": 4.931150215270463e-06, "use_intrinsic_rewards": 0.0, "weights_seq_no": 15.0, "vf_loss": 0.2638687193393707, "num_module_steps_trained": 5994, "entropy": 0.686846137046814, "vf_loss_unclipped": 44.99728012084961, "vf_explained_var": -8.153915405273438e-05, "num_module_steps_trained_lifetime_throughput": 668.8245988302972}, "intrinsic_reward_module": {"diff_num_grad_updates_vs_sampler_policy": 1.0, "gradients_default_optimizer_global_norm": 0.0, "num_trainable_parameters": 8266, "curr_entropy_coeff": 0.0015431216992, "total_loss": 0.0, "module_train_batch_size_mean": 999.0, "default_optimizer_learning_rate": 0.0002715581955, "weights_seq_no": 15.0, "num_module_steps_trained": 5994, "num_module_steps_trained_lifetime": 89910, "num_module_steps_trained_lifetime_throughput": 668.8308037514482}, "differentiable_learners": {"intrinsic_attention_ppo_learner": {"default_policy": {"policy_loss": -0.0006348883616738021, "diff_num_grad_updates_vs_sampler_policy": 76.0, "mean_kl_loss": 3.571268462110311e-05, "total_loss": 0.20390957593917847, "module_train_batch_size_mean": 999.0, "use_intrinsic_rewards": 1.0, "weights_seq_no": 90.0, "vf_loss": 0.26390910148620605, "num_module_steps_trained": 35964, "entropy": 0.6868877410888672, "vf_loss_unclipped": 44.877498626708984, "vf_explained_var": 0.0017386078834533691, "num_module_steps_trained_lifetime": 539460}, "__all_modules__": {"num_env_steps_trained": 189000, "num_module_steps_trained": 71928, "num_module_steps_trained_lifetime": 1078920, "num_env_steps_trained_lifetime": 2835000, "num_env_steps_trained_lifetime_throughput": 40324.8073918441}, "intrinsic_reward_module": {"num_module_steps_trained_lifetime": 539460, "diff_num_grad_updates_vs_sampler_policy": 76.0, "total_loss": 0.0, "module_train_batch_size_mean": 999.0, "weights_seq_no": 90.0, "num_module_steps_trained": 35964}}}, "__all_modules__": {"num_trainable_parameters": 24861, "num_env_steps_trained": 31500, "num_module_steps_trained": 11988, "num_non_trainable_parameters": 0, "num_module_steps_trained_lifetime": 179820, "num_env_steps_trained_lifetime": 472500, "num_env_steps_trained_lifetime_throughput": 3514.9274135494106, "num_module_steps_trained_throughput": 19365493.781332295, "num_module_steps_trained_lifetime_throughput": 11174411.733690154}, "IntrinsicAttentionMask": [[[0.3318576514720917, 0.33410122990608215, 0.33404120802879333], [0.3311832845211029, 0.3344521224498749, 0.33436456322669983], [0.3312012851238251, 0.33444279432296753, 0.3343559503555298]], [[0.33652207255363464, 0.33640041947364807, 0.3270775079727173], [0.3365028202533722, 0.3363819122314453, 0.3271152675151825], [0.3350035846233368, 0.3349402844905853, 0.33005619049072266]], [[0.3343171775341034, 0.3341897130012512, 0.3314930498600006], [0.3343115448951721, 0.33418482542037964, 0.33150362968444824], [0.3341914713382721, 0.33408036828041077, 0.33172816038131714]], [[0.3329949676990509, 0.3357183039188385, 0.3312866985797882], [0.33287981152534485, 0.33651670813560486, 0.3306034803390503], [0.3330671787261963, 0.3352145552635193, 0.3317182660102844]], [[0.3337632119655609, 0.33370766043663025, 0.3325291872024536], [0.33375754952430725, 0.3337027132511139, 0.33253976702690125], [0.3336372971534729, 0.3335980176925659, 0.3327646553516388]], [[0.3130215108394623, 0.3772377073764801, 0.30974069237709045], [0.23724116384983063, 0.5361930131912231, 0.22656577825546265], [0.31699585914611816, 0.3687012791633606, 0.31430286169052124]]]}, "num_training_step_calls_per_iteration": 1, "evaluation": {"env_runners": {"env_to_module_connector": {"timers": {"connectors": {"add_observations_from_episodes_to_batch": 3.1143195092919036e-06, "numpy_to_tensor": 1.3860950417908744e-05, "batch_individual_items": 1.385095024292021e-05, "add_states_from_episodes_to_batch": 3.0395122797973113e-06, "add_time_dim_to_batch_and_zero_pad": 7.745454471223173e-06}}, "connector_pipeline_timer": 6.590684657603959e-05}, "num_module_steps_sampled_lifetime": {"default_policy": 6000}, "num_env_steps_sampled_lifetime": 75400, "weights_seq_no": 15.0, "module_to_env_connector": {"timers": {"connectors": {"get_actions": 4.295192710692484e-05, "un_batch_to_individual_items": 7.00380597618257e-06, "listify_data_for_vector_env": 1.16704228621569e-05, "remove_single_ts_time_rank_from_batch": 1.2709764682106416e-05, "normalize_and_clip_actions": 8.72320938004739e-06, "tensor_to_numpy": 1.6970406152308253e-05}}, "connector_pipeline_timer": 0.0001291663874054447}, "episode_return_min": -13.5, "rlmodule_inference_timer": 3.6039040788053834e-05, "num_episodes": 20, "num_agent_steps_sampled": {"default_agent": 400}, "num_env_steps_sampled": 400, "episode_len_max": 20, "env_to_module_sum_episodes_length_in": 10.368238394574323, "agent_episode_returns_mean": {"default_agent": 3.1}, "env_reset_timer": 0.0005619116182451015, "episode_len_min": 20, "env_to_module_sum_episodes_length_out": 10.368238394574323, "env_step_timer": 1.653455403266065e-05, "episode_len_mean": 20.0, "episode_duration_sec_mean": 0.005664549994980917, "num_module_steps_sampled": {"default_policy": 400}, "module_episode_returns_mean": {"default_policy": 3.1}, "sample": 0.12104558859376884, "num_agent_steps_sampled_lifetime": {"default_agent": 6000}, "num_episodes_lifetime": 300, "episode_return_max": 15.5, "episode_return_mean": 3.1, "time_between_sampling": 11.147541207968402}, "num_healthy_workers": 1, "actor_manager_num_outstanding_async_reqs": 0, "num_remote_worker_restarts": 0}, "num_env_steps_sampled_lifetime": -8017500.0, "fault_tolerance": {"num_healthy_workers": 0, "num_remote_worker_restarts": 0}, "env_runner_group": {"actor_manager_num_outstanding_async_reqs": 0}, "done": false, "training_iteration": 15, "trial_id": "b7d6e_00000", "date": "2025-08-11_18-10-59", "timestamp": 1754928659, "time_this_iter_s": 12.068427085876465, "time_total_s": 170.28510332107544, "pid": 10343, "hostname": "Mac", "node_ip": "127.0.0.1", "config": {"exploration_config": {}, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 2, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "env": "Umbrella", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": false, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 0, "create_local_env_runner": true, "num_envs_per_env_runner": 1, "gym_env_vectorize_mode": "SYNC", "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "episodes_to_numpy": true, "max_requests_in_flight_per_env_runner": 1, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "merge_env_runner_states": "training_only", "broadcast_env_runner_states": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "complete_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "sampler_perf_stats_ema_coef": null, "_is_online": true, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": "auto", "num_aggregator_actors_per_learner": 0, "max_requests_in_flight_per_aggregator_actor": 3, "local_gpu_idx": 0, "max_requests_in_flight_per_learner": 3, "gamma": 1, "lr": 0.0002715581955, "grad_clip": 0.5, "grad_clip_by": "global_norm", "_train_batch_size_per_learner": 5000, "train_batch_size": 4000, "num_epochs": 1, "minibatch_size": 1000, "shuffle_batch_per_epoch": true, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "log_std_clip_param": 20.0, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "_disable_preprocessor_api": false, "_disable_action_flattening": false}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {"intrinsic_reward_coeff": 0.2795015916508}, "optimizer": {}, "_learner_class": "<class 'source.intrinsic_attention_ppo.learners.IntrinsicAttentionMetaLearner.IntrinsicAttentionMetaLearner'>", "callbacks_on_algorithm_init": null, "callbacks_on_env_runners_recreated": null, "callbacks_on_offline_eval_runners_recreated": null, "callbacks_on_checkpoint_loaded": null, "callbacks_on_environment_created": null, "callbacks_on_episode_created": null, "callbacks_on_episode_start": null, "callbacks_on_episode_step": null, "callbacks_on_episode_end": null, "callbacks_on_evaluate_start": null, "callbacks_on_evaluate_end": null, "callbacks_on_evaluate_offline_start": null, "callbacks_on_evaluate_offline_end": null, "callbacks_on_sample_end": null, "callbacks_on_train_result": null, "explore": true, "enable_rl_module_and_learner": true, "enable_env_runner_and_connector_v2": true, "_prior_exploration_config": {"type": "StochasticSampling"}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x1616f98a0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "offline_data_class": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_read_batch_size": null, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "materialize_data": false, "materialize_mapped_data": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "ignore_final_observation": false, "prelearner_class": null, "prelearner_buffer_class": null, "prelearner_buffer_kwargs": {}, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_remaining_data": false, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": 1, "evaluation_duration": 20, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_auto_duration_min_env_steps_per_sample": 100, "evaluation_auto_duration_max_env_steps_per_sample": 2000, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 1, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "offline_evaluation_interval": null, "num_offline_eval_runners": 0, "offline_loss_for_module_fn": null, "offline_evaluation_duration": 1, "offline_evaluation_parallel_to_training": false, "offline_evaluation_timeout_s": 120.0, "num_cpus_per_offline_eval_runner": 1, "num_gpus_per_offline_eval_runner": 0, "custom_resources_per_offline_eval_runner": {}, "restart_failed_offline_eval_runners": true, "ignore_offline_eval_runner_failures": false, "max_num_offline_eval_runner_restarts": 1000, "offline_eval_runner_restore_timeout_s": 1800.0, "max_requests_in_flight_per_offline_eval_runner": 1, "validate_offline_eval_runners_after_construction": true, "offline_eval_runner_health_probe_timeout_s": 30.0, "offline_eval_rl_module_inference_only": false, "broadcast_offline_eval_runner_states": false, "offline_eval_batch_size_per_runner": 256, "dataset_num_iters_per_eval_runner": 1, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "log_gradients": false, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 9, "restart_failed_env_runners": true, "ignore_env_runner_failures": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30.0, "env_runner_restore_timeout_s": 1800.0, "_model_config": {}, "_rl_module_spec": "MultiRLModuleSpec(multi_rl_module_class=<class 'ray.rllib.core.rl_module.multi_rl_module.MultiRLModule'>, observation_space=None, action_space=None, inference_only=False, model_config=None, rl_module_specs={'default_policy': RLModuleSpec(module_class=<class 'source.intrinsic_attention_ppo.rl_modules.DifferentiablePPOModule.DifferentiablePPOModule'>, observation_space=None, action_space=None, inference_only=False, learner_only=False, model_config={'vf_share_layers': True, 'embedding_dim': 62, 'max_seq_len': 3, 'policy_head_hidden_sizes': [32], 'value_head_hidden_sizes': [101], 'embedding_hidden_sizes': [121]}, catalog_class=None, load_state_path=None, model_config_dict=None), 'intrinsic_reward_module': RLModuleSpec(module_class=<class 'source.intrinsic_attention_ppo.rl_modules.IntrinsicAttentionModule.IntrinsicAttentionModule'>, observation_space=None, action_space=None, inference_only=False, learner_only=True, model_config={'intrinsic_reward_network': {'encoder_hidden_sizes': [], 'encoding_dim': 1, 'num_heads': 1, 'head_hidden_sizes': None, 'layers': [{'type': 'attention'}]}, 'extrinsic_value_hidden_layers': [127, 60], 'vf_share_layers': True, 'max_seq_len': 3}, catalog_class=None, load_state_path=None, model_config_dict=None)}, load_state_path=None, modules_to_load=None, module_specs={'default_policy': RLModuleSpec(module_class=<class 'source.intrinsic_attention_ppo.rl_modules.DifferentiablePPOModule.DifferentiablePPOModule'>, observation_space=None, action_space=None, inference_only=False, learner_only=False, model_config={'vf_share_layers': True, 'embedding_dim': 62, 'max_seq_len': 3, 'policy_head_hidden_sizes': [32], 'value_head_hidden_sizes': [101], 'embedding_hidden_sizes': [121]}, catalog_class=None, load_state_path=None, model_config_dict=None), 'intrinsic_reward_module': RLModuleSpec(module_class=<class 'source.intrinsic_attention_ppo.rl_modules.IntrinsicAttentionModule.IntrinsicAttentionModule'>, observation_space=None, action_space=None, inference_only=False, learner_only=True, model_config={'intrinsic_reward_network': {'encoder_hidden_sizes': [], 'encoding_dim': 1, 'num_heads': 1, 'head_hidden_sizes': None, 'layers': [{'type': 'attention'}]}, 'extrinsic_value_hidden_layers': [127, 60], 'vf_share_layers': True, 'max_seq_len': 3}, catalog_class=None, load_state_path=None, model_config_dict=None)})", "algorithm_config_overrides_per_module": {"intrinsic_reward_module": {"lr": 0.0002715581955}}, "_per_module_overrides": {}, "_validate_config": true, "_use_msgpack_checkpoints": false, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "env_task_fn": -1, "enable_connectors": -1, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.161583927863, "kl_target": 0.0201019014258, "vf_loss_coeff": 0.7790510010087, "entropy_coeff": 0.0015431216992, "clip_param": 0.2459212356676, "vf_clip_param": 0.3769744131561, "entropy_coeff_schedule": null, "lr_schedule": null, "sgd_minibatch_size": -1, "vf_share_layers": -1, "differentiable_learner_configs": ["DifferentiableLearnerConfig(learner_class=<class 'source.intrinsic_attention_ppo.learners.IntrinsicAttentionPPOLearner.IntrinsicAttentionPPOLearner'>, learner_connector=None, add_default_connectors_to_learner_pipeline=True, is_multi_agent=False, policies_to_update=['default_policy'], lr=0.0060984166342, num_total_minibatches=0, num_epochs=1, minibatch_size=1000, shuffle_batch_per_epoch=True)"], "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9485408017724, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.callbacks.callbacks.RLlibCallback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 170.28510332107544, "iterations_since_restore": 15, "perf": {"cpu_util_percent": 53.59411764705882, "ram_util_percent": 82.56470588235294}}
{"timers": {"training_iteration": 10.488761192420037, "restore_env_runners": 5.935673855259614e-05, "training_step": 10.48842987069825, "env_runner_sampling_timer": 1.759966718417113, "learner_update_timer": 8.50004108307308, "synch_weights": 0.0017653110499639719, "restore_eval_env_runners": 5.6505265166951156e-05, "evaluation_iteration": 0.1326730304294471, "synch_eval_env_connectors": 0.0001947189079800241, "synch_env_connectors": 4.472010231692612e-06}, "env_runners": {"env_to_module_connector": {"timers": {"connectors": {"numpy_to_tensor": 1.3258425966070307e-05, "add_time_dim_to_batch_and_zero_pad": 7.26554644254041e-06, "batch_individual_items": 1.2883446612758567e-05, "add_observations_from_episodes_to_batch": 2.908674109066298e-06, "add_states_from_episodes_to_batch": 2.8738967216340253e-06}}, "connector_pipeline_timer": 6.213117345244404e-05}, "module_to_env_connector": {"timers": {"connectors": {"tensor_to_numpy": 1.5776618296928884e-05, "un_batch_to_individual_items": 6.8277096518924045e-06, "listify_data_for_vector_env": 1.0740507887164529e-05, "get_actions": 4.0122765123469776e-05, "remove_single_ts_time_rank_from_batch": 1.2352115400457105e-05, "normalize_and_clip_actions": 8.381877993144686e-06}}, "connector_pipeline_timer": 0.00012184696397090245}, "module_episode_returns_mean": {"default_policy": 5.7799999999999985}, "episode_len_min": 20, "env_reset_timer": 5.0716049674604986e-05, "agent_episode_returns_mean": {"default_agent": 5.7799999999999985}, "time_between_sampling": 0.04017008524907385, "env_to_module_sum_episodes_length_out": 10.36823839457432, "num_module_steps_sampled": {"default_policy": 5000.0}, "env_step_timer": 1.4654328162294214e-05, "weights_seq_no": 15.0, "num_env_steps_sampled_lifetime": -8635000.0, "num_agent_steps_sampled": {"default_agent": 5000.0}, "num_episodes_lifetime": -431750.0, "episode_len_mean": 20.0, "episode_duration_sec_mean": 0.005453318708576262, "episode_return_max": 14.5, "episode_len_max": 20, "num_module_steps_sampled_lifetime": {"default_policy": -8635000.0}, "episode_return_min": -5.5, "rlmodule_inference_timer": 3.253221488165942e-05, "episode_return_mean": 5.7799999999999985, "env_to_module_sum_episodes_length_in": 10.36823839457432, "num_agent_steps_sampled_lifetime": {"default_agent": -8635000.0}, "num_episodes": 250.0, "sample": 0.0067736709831218685, "num_env_steps_sampled": 5000.0, "num_env_steps_sampled_lifetime_throughput": 3113.2883711931227}, "__all_modules__": {"learner_connector_sum_episodes_length_in": 5000.0, "learner_connector": {"connector_pipeline_timer": 0.18574689711102932, "timers": {"connectors": {"add_one_ts_to_episodes_and_truncate": 0.009760892358226483, "add_observations_from_episodes_to_batch": 0.0008687199599411361, "add_columns_from_episodes_to_train_batch": 0.0434644037695531, "add_time_dim_to_batch_and_zero_pad": 0.11095617422194783, "add_states_from_episodes_to_batch": 0.003955212427428503, "batch_individual_items": 0.01646595847408156, "numpy_to_tensor": 8.655999852874186e-05}}}, "learner_connector_sum_episodes_length_out": 5250.0}, "learners": {"default_policy": {"num_module_steps_trained_lifetime": 95904, "policy_loss": -0.0008954477962106466, "diff_num_grad_updates_vs_sampler_policy": 1.0, "num_trainable_parameters": 16595, "mean_kl_loss": 5.3087074775248766e-05, "curr_entropy_coeff": 0.0015431216992, "total_loss": 0.2036127746105194, "module_train_batch_size_mean": 999.0, "curr_kl_coeff": 2.4655751076352317e-06, "use_intrinsic_rewards": 0.0, "weights_seq_no": 16.0, "vf_loss": 0.26386693120002747, "num_module_steps_trained": 5994, "entropy": 0.6853549480438232, "vf_loss_unclipped": 42.137149810791016, "vf_explained_var": -5.888938903808594e-05, "num_module_steps_trained_lifetime_throughput": 665.8215777779301}, "intrinsic_reward_module": {"diff_num_grad_updates_vs_sampler_policy": 1.0, "gradients_default_optimizer_global_norm": 0.0, "num_trainable_parameters": 8266, "curr_entropy_coeff": 0.0015431216992, "total_loss": 0.0, "module_train_batch_size_mean": 999.0, "default_optimizer_learning_rate": 0.0002715581955, "weights_seq_no": 16.0, "num_module_steps_trained": 5994, "num_module_steps_trained_lifetime": 95904, "num_module_steps_trained_lifetime_throughput": 665.8274073824857}, "differentiable_learners": {"intrinsic_attention_ppo_learner": {"default_policy": {"policy_loss": -0.0008558703120797873, "diff_num_grad_updates_vs_sampler_policy": 81.0, "mean_kl_loss": 4.8393681936431676e-05, "total_loss": 0.20369288325309753, "module_train_batch_size_mean": 999.0, "use_intrinsic_rewards": 1.0, "weights_seq_no": 96.0, "vf_loss": 0.26390907168388367, "num_module_steps_trained": 35964, "entropy": 0.6854128241539001, "vf_loss_unclipped": 42.05150604248047, "vf_explained_var": 0.0015810728073120117, "num_module_steps_trained_lifetime": 575424}, "__all_modules__": {"num_env_steps_trained": 189000, "num_module_steps_trained": 71928, "num_module_steps_trained_lifetime": 1150848, "num_env_steps_trained_lifetime": 3024000, "num_env_steps_trained_lifetime_throughput": 39646.707833408465}, "intrinsic_reward_module": {"num_module_steps_trained_lifetime": 575424, "diff_num_grad_updates_vs_sampler_policy": 81.0, "total_loss": 0.0, "module_train_batch_size_mean": 999.0, "weights_seq_no": 96.0, "num_module_steps_trained": 35964}}}, "__all_modules__": {"num_trainable_parameters": 24861, "num_env_steps_trained": 31500, "num_module_steps_trained": 11988, "num_non_trainable_parameters": 0, "num_module_steps_trained_lifetime": 191808, "num_env_steps_trained_lifetime": 504000, "num_env_steps_trained_lifetime_throughput": 3499.141685842443, "num_module_steps_trained_throughput": 18957864.08089723, "num_module_steps_trained_lifetime_throughput": 11195621.661433734}, "IntrinsicAttentionMask": [[[0.33477309346199036, 0.3330914378166199, 0.33213549852371216], [0.3339039087295532, 0.33323779702186584, 0.33285826444625854], [0.33340832591056824, 0.3333207964897156, 0.3332708775997162]], [[0.3350367248058319, 0.3339468836784363, 0.3310164213180542], [0.33451923727989197, 0.3337612748146057, 0.33171942830085754], [0.3331194221973419, 0.3332557678222656, 0.33362483978271484]], [[0.3333910405635834, 0.3333333432674408, 0.3332756757736206], [0.3333902955055237, 0.3333333134651184, 0.3332763612270355], [0.333389550447464, 0.3333333134651184, 0.3332771062850952]], [[0.3331969678401947, 0.3336213231086731, 0.3331817090511322], [0.33247292041778564, 0.3351503312587738, 0.33237677812576294], [0.33322304487228394, 0.333566278219223, 0.33321067690849304]], [[0.33430054783821106, 0.3316493034362793, 0.33405008912086487], [0.33418041467666626, 0.33185842633247375, 0.33396115899086], [0.3342892527580261, 0.33166900277137756, 0.3340417444705963]], [[0.31568801403045654, 0.37151312828063965, 0.3127988576889038], [0.24019408226013184, 0.5301119685173035, 0.2296939492225647], [0.3196295499801636, 0.3630305826663971, 0.3173398971557617]]]}, "num_training_step_calls_per_iteration": 1, "evaluation": {"env_runners": {"env_to_module_connector": {"timers": {"connectors": {"add_observations_from_episodes_to_batch": 2.8263651015765005e-06, "numpy_to_tensor": 1.1958931567508781e-05, "batch_individual_items": 1.2407782921302357e-05, "add_states_from_episodes_to_batch": 2.741836083217693e-06, "add_time_dim_to_batch_and_zero_pad": 7.055882761742567e-06}}, "connector_pipeline_timer": 5.925945171175461e-05}, "num_module_steps_sampled_lifetime": {"default_policy": 6400}, "num_env_steps_sampled_lifetime": 80400, "weights_seq_no": 16.0, "module_to_env_connector": {"timers": {"connectors": {"get_actions": 3.674654413494442e-05, "un_batch_to_individual_items": 6.405831036527695e-06, "listify_data_for_vector_env": 1.0309745277728185e-05, "remove_single_ts_time_rank_from_batch": 1.1721481768603708e-05, "normalize_and_clip_actions": 7.794420611888377e-06, "tensor_to_numpy": 1.5039508365556083e-05}}, "connector_pipeline_timer": 0.00011418839100427328}, "episode_return_min": -13.5, "rlmodule_inference_timer": 3.135282266397674e-05, "num_episodes": 20, "num_agent_steps_sampled": {"default_agent": 400}, "num_env_steps_sampled": 400, "episode_len_max": 20, "env_to_module_sum_episodes_length_in": 10.368238394574323, "agent_episode_returns_mean": {"default_agent": 2.5}, "env_reset_timer": 0.0005600133418033589, "episode_len_min": 20, "env_to_module_sum_episodes_length_out": 10.368238394574323, "env_step_timer": 1.3914066537893074e-05, "episode_len_mean": 20.0, "episode_duration_sec_mean": 0.005633418703218922, "num_module_steps_sampled": {"default_policy": 400}, "module_episode_returns_mean": {"default_policy": 2.5}, "sample": 0.12099124728863936, "num_agent_steps_sampled_lifetime": {"default_agent": 6400}, "num_episodes_lifetime": 320, "episode_return_max": 15.5, "episode_return_mean": 2.5, "time_between_sampling": 11.146088675888315}, "num_healthy_workers": 1, "actor_manager_num_outstanding_async_reqs": 0, "num_remote_worker_restarts": 0}, "num_env_steps_sampled_lifetime": -8635000.0, "fault_tolerance": {"num_healthy_workers": 0, "num_remote_worker_restarts": 0}, "env_runner_group": {"actor_manager_num_outstanding_async_reqs": 0}, "done": false, "training_iteration": 16, "trial_id": "b7d6e_00000", "date": "2025-08-11_18-11-10", "timestamp": 1754928670, "time_this_iter_s": 11.097423076629639, "time_total_s": 181.38252639770508, "pid": 10343, "hostname": "Mac", "node_ip": "127.0.0.1", "config": {"exploration_config": {}, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 2, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "env": "Umbrella", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": false, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 0, "create_local_env_runner": true, "num_envs_per_env_runner": 1, "gym_env_vectorize_mode": "SYNC", "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "episodes_to_numpy": true, "max_requests_in_flight_per_env_runner": 1, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "merge_env_runner_states": "training_only", "broadcast_env_runner_states": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "complete_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "sampler_perf_stats_ema_coef": null, "_is_online": true, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": "auto", "num_aggregator_actors_per_learner": 0, "max_requests_in_flight_per_aggregator_actor": 3, "local_gpu_idx": 0, "max_requests_in_flight_per_learner": 3, "gamma": 1, "lr": 0.0002715581955, "grad_clip": 0.5, "grad_clip_by": "global_norm", "_train_batch_size_per_learner": 5000, "train_batch_size": 4000, "num_epochs": 1, "minibatch_size": 1000, "shuffle_batch_per_epoch": true, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "log_std_clip_param": 20.0, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "_disable_preprocessor_api": false, "_disable_action_flattening": false}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {"intrinsic_reward_coeff": 0.2795015916508}, "optimizer": {}, "_learner_class": "<class 'source.intrinsic_attention_ppo.learners.IntrinsicAttentionMetaLearner.IntrinsicAttentionMetaLearner'>", "callbacks_on_algorithm_init": null, "callbacks_on_env_runners_recreated": null, "callbacks_on_offline_eval_runners_recreated": null, "callbacks_on_checkpoint_loaded": null, "callbacks_on_environment_created": null, "callbacks_on_episode_created": null, "callbacks_on_episode_start": null, "callbacks_on_episode_step": null, "callbacks_on_episode_end": null, "callbacks_on_evaluate_start": null, "callbacks_on_evaluate_end": null, "callbacks_on_evaluate_offline_start": null, "callbacks_on_evaluate_offline_end": null, "callbacks_on_sample_end": null, "callbacks_on_train_result": null, "explore": true, "enable_rl_module_and_learner": true, "enable_env_runner_and_connector_v2": true, "_prior_exploration_config": {"type": "StochasticSampling"}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x1616f98a0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "offline_data_class": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_read_batch_size": null, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "materialize_data": false, "materialize_mapped_data": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "ignore_final_observation": false, "prelearner_class": null, "prelearner_buffer_class": null, "prelearner_buffer_kwargs": {}, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_remaining_data": false, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": 1, "evaluation_duration": 20, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_auto_duration_min_env_steps_per_sample": 100, "evaluation_auto_duration_max_env_steps_per_sample": 2000, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 1, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "offline_evaluation_interval": null, "num_offline_eval_runners": 0, "offline_loss_for_module_fn": null, "offline_evaluation_duration": 1, "offline_evaluation_parallel_to_training": false, "offline_evaluation_timeout_s": 120.0, "num_cpus_per_offline_eval_runner": 1, "num_gpus_per_offline_eval_runner": 0, "custom_resources_per_offline_eval_runner": {}, "restart_failed_offline_eval_runners": true, "ignore_offline_eval_runner_failures": false, "max_num_offline_eval_runner_restarts": 1000, "offline_eval_runner_restore_timeout_s": 1800.0, "max_requests_in_flight_per_offline_eval_runner": 1, "validate_offline_eval_runners_after_construction": true, "offline_eval_runner_health_probe_timeout_s": 30.0, "offline_eval_rl_module_inference_only": false, "broadcast_offline_eval_runner_states": false, "offline_eval_batch_size_per_runner": 256, "dataset_num_iters_per_eval_runner": 1, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "log_gradients": false, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 9, "restart_failed_env_runners": true, "ignore_env_runner_failures": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30.0, "env_runner_restore_timeout_s": 1800.0, "_model_config": {}, "_rl_module_spec": "MultiRLModuleSpec(multi_rl_module_class=<class 'ray.rllib.core.rl_module.multi_rl_module.MultiRLModule'>, observation_space=None, action_space=None, inference_only=False, model_config=None, rl_module_specs={'default_policy': RLModuleSpec(module_class=<class 'source.intrinsic_attention_ppo.rl_modules.DifferentiablePPOModule.DifferentiablePPOModule'>, observation_space=None, action_space=None, inference_only=False, learner_only=False, model_config={'vf_share_layers': True, 'embedding_dim': 62, 'max_seq_len': 3, 'policy_head_hidden_sizes': [32], 'value_head_hidden_sizes': [101], 'embedding_hidden_sizes': [121]}, catalog_class=None, load_state_path=None, model_config_dict=None), 'intrinsic_reward_module': RLModuleSpec(module_class=<class 'source.intrinsic_attention_ppo.rl_modules.IntrinsicAttentionModule.IntrinsicAttentionModule'>, observation_space=None, action_space=None, inference_only=False, learner_only=True, model_config={'intrinsic_reward_network': {'encoder_hidden_sizes': [], 'encoding_dim': 1, 'num_heads': 1, 'head_hidden_sizes': None, 'layers': [{'type': 'attention'}]}, 'extrinsic_value_hidden_layers': [127, 60], 'vf_share_layers': True, 'max_seq_len': 3}, catalog_class=None, load_state_path=None, model_config_dict=None)}, load_state_path=None, modules_to_load=None, module_specs={'default_policy': RLModuleSpec(module_class=<class 'source.intrinsic_attention_ppo.rl_modules.DifferentiablePPOModule.DifferentiablePPOModule'>, observation_space=None, action_space=None, inference_only=False, learner_only=False, model_config={'vf_share_layers': True, 'embedding_dim': 62, 'max_seq_len': 3, 'policy_head_hidden_sizes': [32], 'value_head_hidden_sizes': [101], 'embedding_hidden_sizes': [121]}, catalog_class=None, load_state_path=None, model_config_dict=None), 'intrinsic_reward_module': RLModuleSpec(module_class=<class 'source.intrinsic_attention_ppo.rl_modules.IntrinsicAttentionModule.IntrinsicAttentionModule'>, observation_space=None, action_space=None, inference_only=False, learner_only=True, model_config={'intrinsic_reward_network': {'encoder_hidden_sizes': [], 'encoding_dim': 1, 'num_heads': 1, 'head_hidden_sizes': None, 'layers': [{'type': 'attention'}]}, 'extrinsic_value_hidden_layers': [127, 60], 'vf_share_layers': True, 'max_seq_len': 3}, catalog_class=None, load_state_path=None, model_config_dict=None)})", "algorithm_config_overrides_per_module": {"intrinsic_reward_module": {"lr": 0.0002715581955}}, "_per_module_overrides": {}, "_validate_config": true, "_use_msgpack_checkpoints": false, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "env_task_fn": -1, "enable_connectors": -1, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.161583927863, "kl_target": 0.0201019014258, "vf_loss_coeff": 0.7790510010087, "entropy_coeff": 0.0015431216992, "clip_param": 0.2459212356676, "vf_clip_param": 0.3769744131561, "entropy_coeff_schedule": null, "lr_schedule": null, "sgd_minibatch_size": -1, "vf_share_layers": -1, "differentiable_learner_configs": ["DifferentiableLearnerConfig(learner_class=<class 'source.intrinsic_attention_ppo.learners.IntrinsicAttentionPPOLearner.IntrinsicAttentionPPOLearner'>, learner_connector=None, add_default_connectors_to_learner_pipeline=True, is_multi_agent=False, policies_to_update=['default_policy'], lr=0.0060984166342, num_total_minibatches=0, num_epochs=1, minibatch_size=1000, shuffle_batch_per_epoch=True)"], "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9485408017724, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.callbacks.callbacks.RLlibCallback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 181.38252639770508, "iterations_since_restore": 16, "perf": {"cpu_util_percent": 41.11875, "ram_util_percent": 82.25625000000001}}
{"timers": {"training_iteration": 10.500782896326399, "restore_env_runners": 5.88602522322481e-05, "training_step": 10.50045232699092, "env_runner_sampling_timer": 1.7586971512328464, "learner_update_timer": 8.5133187922418, "synch_weights": 0.0017678504389696881, "restore_eval_env_runners": 5.642437219722768e-05, "evaluation_iteration": 0.1325945630455695, "synch_eval_env_connectors": 0.0001943646285846286, "synch_env_connectors": 4.467290433955421e-06}, "env_runners": {"env_to_module_connector": {"timers": {"connectors": {"numpy_to_tensor": 1.361890845155967e-05, "add_time_dim_to_batch_and_zero_pad": 7.456650004955416e-06, "batch_individual_items": 1.3162937904132148e-05, "add_observations_from_episodes_to_batch": 2.995915217205513e-06, "add_states_from_episodes_to_batch": 2.909755786264328e-06}}, "connector_pipeline_timer": 6.337137044347018e-05}, "module_to_env_connector": {"timers": {"connectors": {"tensor_to_numpy": 1.599573884998158e-05, "un_batch_to_individual_items": 7.014384396040007e-06, "listify_data_for_vector_env": 1.0984518630195707e-05, "get_actions": 4.124494869344505e-05, "remove_single_ts_time_rank_from_batch": 1.255417249222342e-05, "normalize_and_clip_actions": 8.550274364756211e-06}}, "connector_pipeline_timer": 0.00012447308129630606}, "module_episode_returns_mean": {"default_policy": 5.7799999999999985}, "episode_len_min": 20, "env_reset_timer": 4.5917922491566494e-05, "agent_episode_returns_mean": {"default_agent": 5.7799999999999985}, "time_between_sampling": 0.038754271461100075, "env_to_module_sum_episodes_length_out": 10.36823839457432, "num_module_steps_sampled": {"default_policy": 5000.0}, "env_step_timer": 1.4944077600502343e-05, "weights_seq_no": 16.0, "num_env_steps_sampled_lifetime": -9252500.0, "num_agent_steps_sampled": {"default_agent": 5000.0}, "num_episodes_lifetime": -462625.0, "episode_len_mean": 20.0, "episode_duration_sec_mean": 0.005580398342106488, "episode_return_max": 14.5, "episode_len_max": 20, "num_module_steps_sampled_lifetime": {"default_policy": -9252500.0}, "episode_return_min": -5.5, "rlmodule_inference_timer": 3.3252137060306334e-05, "episode_return_mean": 5.7799999999999985, "env_to_module_sum_episodes_length_in": 10.36823839457432, "num_agent_steps_sampled_lifetime": {"default_agent": -9252500.0}, "num_episodes": 250.0, "sample": 0.005990019997298847, "num_env_steps_sampled": 5000.0, "num_env_steps_sampled_lifetime_throughput": 3077.276436808205}, "__all_modules__": {"learner_connector_sum_episodes_length_in": 5000.0, "learner_connector": {"connector_pipeline_timer": 0.18565527439026494, "timers": {"connectors": {"add_one_ts_to_episodes_and_truncate": 0.00975342968450288, "add_observations_from_episodes_to_batch": 0.0008697510904530794, "add_columns_from_episodes_to_train_batch": 0.0434506080714208, "add_time_dim_to_batch_and_zero_pad": 0.11091749748024594, "add_states_from_episodes_to_batch": 0.003958520713330435, "batch_individual_items": 0.016429903469290498, "numpy_to_tensor": 8.687022821850304e-05}}}, "learner_connector_sum_episodes_length_out": 5250.0}, "learners": {"default_policy": {"num_module_steps_trained_lifetime": 101898, "policy_loss": -0.00026993118808604777, "diff_num_grad_updates_vs_sampler_policy": 1.0, "num_trainable_parameters": 16595, "mean_kl_loss": 2.7672702344716527e-05, "curr_entropy_coeff": 0.0015431216992, "total_loss": 0.20424015820026398, "module_train_batch_size_mean": 999.0, "curr_kl_coeff": 1.2327875538176158e-06, "use_intrinsic_rewards": 0.0, "weights_seq_no": 17.0, "vf_loss": 0.2638680636882782, "num_module_steps_trained": 5994, "entropy": 0.6847257614135742, "vf_loss_unclipped": 44.979461669921875, "vf_explained_var": -2.9802322387695312e-05, "num_module_steps_trained_lifetime_throughput": 662.4367026684686}, "intrinsic_reward_module": {"diff_num_grad_updates_vs_sampler_policy": 1.0, "gradients_default_optimizer_global_norm": 0.0, "num_trainable_parameters": 8266, "curr_entropy_coeff": 0.0015431216992, "total_loss": 0.0, "module_train_batch_size_mean": 999.0, "default_optimizer_learning_rate": 0.0002715581955, "weights_seq_no": 17.0, "num_module_steps_trained": 5994, "num_module_steps_trained_lifetime": 101898, "num_module_steps_trained_lifetime_throughput": 662.4421589665692}, "differentiable_learners": {"intrinsic_attention_ppo_learner": {"default_policy": {"policy_loss": -0.00026342394994571805, "diff_num_grad_updates_vs_sampler_policy": 86.0, "mean_kl_loss": 2.6274217816535383e-05, "total_loss": 0.20427072048187256, "module_train_batch_size_mean": 999.0, "use_intrinsic_rewards": 1.0, "weights_seq_no": 102.0, "vf_loss": 0.2638935446739197, "num_module_steps_trained": 35964, "entropy": 0.6847503185272217, "vf_loss_unclipped": 44.883323669433594, "vf_explained_var": 0.001521289348602295, "num_module_steps_trained_lifetime": 611388}, "__all_modules__": {"num_env_steps_trained": 189000, "num_module_steps_trained": 71928, "num_module_steps_trained_lifetime": 1222776, "num_env_steps_trained_lifetime": 3213000, "num_env_steps_trained_lifetime_throughput": 38994.75790746326}, "intrinsic_reward_module": {"num_module_steps_trained_lifetime": 611388, "diff_num_grad_updates_vs_sampler_policy": 86.0, "total_loss": 0.0, "module_train_batch_size_mean": 999.0, "weights_seq_no": 102.0, "num_module_steps_trained": 35964}}}, "__all_modules__": {"num_trainable_parameters": 24861, "num_env_steps_trained": 31500, "num_module_steps_trained": 11988, "num_non_trainable_parameters": 0, "num_module_steps_trained_lifetime": 203796, "num_env_steps_trained_lifetime": 535500, "num_env_steps_trained_lifetime_throughput": 3481.3494134230823, "num_module_steps_trained_throughput": 18571820.67264973, "num_module_steps_trained_lifetime_throughput": 11224498.983733043}, "IntrinsicAttentionMask": [[[0.33477312326431274, 0.3321804702281952, 0.33304640650749207], [0.3334316313266754, 0.33325454592704773, 0.33331382274627686], [0.33388057351112366, 0.33289480209350586, 0.3332245945930481]], [[0.3350366950035095, 0.3339468538761139, 0.3310163915157318], [0.33451923727989197, 0.3337612748146057, 0.33171945810317993], [0.3331194221973419, 0.3332557678222656, 0.33362483978271484]], [[0.3333910405635834, 0.3333333432674408, 0.3332756757736206], [0.3333902955055237, 0.3333333134651184, 0.3332763612270355], [0.333389550447464, 0.3333333134651184, 0.3332771062850952]], [[0.3331969678401947, 0.3336213231086731, 0.3331816792488098], [0.33247292041778564, 0.3351503312587738, 0.33237677812576294], [0.33322304487228394, 0.333566278219223, 0.33321067690849304]], [[0.3333888053894043, 0.3333333134651184, 0.33327779173851013], [0.333388090133667, 0.3333333134651184, 0.3332785665988922], [0.3333873748779297, 0.3333333432674408, 0.3332792818546295]], [[0.3394940495491028, 0.32133668661117554, 0.3391692638397217], [0.25254300236701965, 0.4919642210006714, 0.2554926574230194], [0.3380947709083557, 0.32405996322631836, 0.33784523606300354]]]}, "num_training_step_calls_per_iteration": 1, "evaluation": {"env_runners": {"env_to_module_connector": {"timers": {"connectors": {"add_observations_from_episodes_to_batch": 2.9064622292686464e-06, "numpy_to_tensor": 1.2377084112042537e-05, "batch_individual_items": 1.2563705701049438e-05, "add_states_from_episodes_to_batch": 2.8299602069103405e-06, "add_time_dim_to_batch_and_zero_pad": 7.306281268864798e-06}}, "connector_pipeline_timer": 6.0537714315806226e-05}, "num_module_steps_sampled_lifetime": {"default_policy": 6800}, "num_env_steps_sampled_lifetime": 85400, "weights_seq_no": 17.0, "module_to_env_connector": {"timers": {"connectors": {"get_actions": 3.8153435547475966e-05, "un_batch_to_individual_items": 6.6362787464622344e-06, "listify_data_for_vector_env": 1.0649823323668725e-05, "remove_single_ts_time_rank_from_batch": 1.2090988700903052e-05, "normalize_and_clip_actions": 8.233717317698154e-06, "tensor_to_numpy": 1.5658932666315552e-05}}, "connector_pipeline_timer": 0.00011854739989326492}, "episode_return_min": -13.5, "rlmodule_inference_timer": 3.318350484125631e-05, "num_episodes": 20, "num_agent_steps_sampled": {"default_agent": 400}, "num_env_steps_sampled": 400, "episode_len_max": 20, "env_to_module_sum_episodes_length_in": 10.368238394574323, "agent_episode_returns_mean": {"default_agent": 1.9}, "env_reset_timer": 0.0005578257081763365, "episode_len_min": 20, "env_to_module_sum_episodes_length_out": 10.368238394574323, "env_step_timer": 1.4898014696684745e-05, "episode_len_mean": 20.0, "episode_duration_sec_mean": 0.005529986178735271, "num_module_steps_sampled": {"default_policy": 400}, "module_episode_returns_mean": {"default_policy": 1.9}, "sample": 0.12100114606551016, "num_agent_steps_sampled_lifetime": {"default_agent": 6800}, "num_episodes_lifetime": 340, "episode_return_max": 15.5, "episode_return_mean": 1.9, "time_between_sampling": 11.151846627470501}, "num_healthy_workers": 1, "actor_manager_num_outstanding_async_reqs": 0, "num_remote_worker_restarts": 0}, "num_env_steps_sampled_lifetime": -9252500.0, "fault_tolerance": {"num_healthy_workers": 0, "num_remote_worker_restarts": 0}, "env_runner_group": {"actor_manager_num_outstanding_async_reqs": 0}, "done": false, "training_iteration": 17, "trial_id": "b7d6e_00000", "date": "2025-08-11_18-11-22", "timestamp": 1754928682, "time_this_iter_s": 11.825411081314087, "time_total_s": 193.20793747901917, "pid": 10343, "hostname": "Mac", "node_ip": "127.0.0.1", "config": {"exploration_config": {}, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 2, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "env": "Umbrella", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": false, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 0, "create_local_env_runner": true, "num_envs_per_env_runner": 1, "gym_env_vectorize_mode": "SYNC", "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "episodes_to_numpy": true, "max_requests_in_flight_per_env_runner": 1, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "merge_env_runner_states": "training_only", "broadcast_env_runner_states": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "complete_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "sampler_perf_stats_ema_coef": null, "_is_online": true, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": "auto", "num_aggregator_actors_per_learner": 0, "max_requests_in_flight_per_aggregator_actor": 3, "local_gpu_idx": 0, "max_requests_in_flight_per_learner": 3, "gamma": 1, "lr": 0.0002715581955, "grad_clip": 0.5, "grad_clip_by": "global_norm", "_train_batch_size_per_learner": 5000, "train_batch_size": 4000, "num_epochs": 1, "minibatch_size": 1000, "shuffle_batch_per_epoch": true, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "log_std_clip_param": 20.0, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "_disable_preprocessor_api": false, "_disable_action_flattening": false}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {"intrinsic_reward_coeff": 0.2795015916508}, "optimizer": {}, "_learner_class": "<class 'source.intrinsic_attention_ppo.learners.IntrinsicAttentionMetaLearner.IntrinsicAttentionMetaLearner'>", "callbacks_on_algorithm_init": null, "callbacks_on_env_runners_recreated": null, "callbacks_on_offline_eval_runners_recreated": null, "callbacks_on_checkpoint_loaded": null, "callbacks_on_environment_created": null, "callbacks_on_episode_created": null, "callbacks_on_episode_start": null, "callbacks_on_episode_step": null, "callbacks_on_episode_end": null, "callbacks_on_evaluate_start": null, "callbacks_on_evaluate_end": null, "callbacks_on_evaluate_offline_start": null, "callbacks_on_evaluate_offline_end": null, "callbacks_on_sample_end": null, "callbacks_on_train_result": null, "explore": true, "enable_rl_module_and_learner": true, "enable_env_runner_and_connector_v2": true, "_prior_exploration_config": {"type": "StochasticSampling"}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x1616f98a0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "offline_data_class": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_read_batch_size": null, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "materialize_data": false, "materialize_mapped_data": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "ignore_final_observation": false, "prelearner_class": null, "prelearner_buffer_class": null, "prelearner_buffer_kwargs": {}, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_remaining_data": false, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": 1, "evaluation_duration": 20, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_auto_duration_min_env_steps_per_sample": 100, "evaluation_auto_duration_max_env_steps_per_sample": 2000, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 1, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "offline_evaluation_interval": null, "num_offline_eval_runners": 0, "offline_loss_for_module_fn": null, "offline_evaluation_duration": 1, "offline_evaluation_parallel_to_training": false, "offline_evaluation_timeout_s": 120.0, "num_cpus_per_offline_eval_runner": 1, "num_gpus_per_offline_eval_runner": 0, "custom_resources_per_offline_eval_runner": {}, "restart_failed_offline_eval_runners": true, "ignore_offline_eval_runner_failures": false, "max_num_offline_eval_runner_restarts": 1000, "offline_eval_runner_restore_timeout_s": 1800.0, "max_requests_in_flight_per_offline_eval_runner": 1, "validate_offline_eval_runners_after_construction": true, "offline_eval_runner_health_probe_timeout_s": 30.0, "offline_eval_rl_module_inference_only": false, "broadcast_offline_eval_runner_states": false, "offline_eval_batch_size_per_runner": 256, "dataset_num_iters_per_eval_runner": 1, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "log_gradients": false, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 9, "restart_failed_env_runners": true, "ignore_env_runner_failures": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30.0, "env_runner_restore_timeout_s": 1800.0, "_model_config": {}, "_rl_module_spec": "MultiRLModuleSpec(multi_rl_module_class=<class 'ray.rllib.core.rl_module.multi_rl_module.MultiRLModule'>, observation_space=None, action_space=None, inference_only=False, model_config=None, rl_module_specs={'default_policy': RLModuleSpec(module_class=<class 'source.intrinsic_attention_ppo.rl_modules.DifferentiablePPOModule.DifferentiablePPOModule'>, observation_space=None, action_space=None, inference_only=False, learner_only=False, model_config={'vf_share_layers': True, 'embedding_dim': 62, 'max_seq_len': 3, 'policy_head_hidden_sizes': [32], 'value_head_hidden_sizes': [101], 'embedding_hidden_sizes': [121]}, catalog_class=None, load_state_path=None, model_config_dict=None), 'intrinsic_reward_module': RLModuleSpec(module_class=<class 'source.intrinsic_attention_ppo.rl_modules.IntrinsicAttentionModule.IntrinsicAttentionModule'>, observation_space=None, action_space=None, inference_only=False, learner_only=True, model_config={'intrinsic_reward_network': {'encoder_hidden_sizes': [], 'encoding_dim': 1, 'num_heads': 1, 'head_hidden_sizes': None, 'layers': [{'type': 'attention'}]}, 'extrinsic_value_hidden_layers': [127, 60], 'vf_share_layers': True, 'max_seq_len': 3}, catalog_class=None, load_state_path=None, model_config_dict=None)}, load_state_path=None, modules_to_load=None, module_specs={'default_policy': RLModuleSpec(module_class=<class 'source.intrinsic_attention_ppo.rl_modules.DifferentiablePPOModule.DifferentiablePPOModule'>, observation_space=None, action_space=None, inference_only=False, learner_only=False, model_config={'vf_share_layers': True, 'embedding_dim': 62, 'max_seq_len': 3, 'policy_head_hidden_sizes': [32], 'value_head_hidden_sizes': [101], 'embedding_hidden_sizes': [121]}, catalog_class=None, load_state_path=None, model_config_dict=None), 'intrinsic_reward_module': RLModuleSpec(module_class=<class 'source.intrinsic_attention_ppo.rl_modules.IntrinsicAttentionModule.IntrinsicAttentionModule'>, observation_space=None, action_space=None, inference_only=False, learner_only=True, model_config={'intrinsic_reward_network': {'encoder_hidden_sizes': [], 'encoding_dim': 1, 'num_heads': 1, 'head_hidden_sizes': None, 'layers': [{'type': 'attention'}]}, 'extrinsic_value_hidden_layers': [127, 60], 'vf_share_layers': True, 'max_seq_len': 3}, catalog_class=None, load_state_path=None, model_config_dict=None)})", "algorithm_config_overrides_per_module": {"intrinsic_reward_module": {"lr": 0.0002715581955}}, "_per_module_overrides": {}, "_validate_config": true, "_use_msgpack_checkpoints": false, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "env_task_fn": -1, "enable_connectors": -1, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.161583927863, "kl_target": 0.0201019014258, "vf_loss_coeff": 0.7790510010087, "entropy_coeff": 0.0015431216992, "clip_param": 0.2459212356676, "vf_clip_param": 0.3769744131561, "entropy_coeff_schedule": null, "lr_schedule": null, "sgd_minibatch_size": -1, "vf_share_layers": -1, "differentiable_learner_configs": ["DifferentiableLearnerConfig(learner_class=<class 'source.intrinsic_attention_ppo.learners.IntrinsicAttentionPPOLearner.IntrinsicAttentionPPOLearner'>, learner_connector=None, add_default_connectors_to_learner_pipeline=True, is_multi_agent=False, policies_to_update=['default_policy'], lr=0.0060984166342, num_total_minibatches=0, num_epochs=1, minibatch_size=1000, shuffle_batch_per_epoch=True)"], "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9485408017724, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.callbacks.callbacks.RLlibCallback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 193.20793747901917, "iterations_since_restore": 17, "perf": {"cpu_util_percent": 42.77058823529411, "ram_util_percent": 81.74117647058823}}
{"timers": {"training_iteration": 10.505368564032684, "restore_env_runners": 5.834456993921157e-05, "training_step": 10.50503810039064, "env_runner_sampling_timer": 1.7579064013814336, "learner_update_timer": 8.51857692806859, "synch_weights": 0.001765954014006563, "restore_eval_env_runners": 5.633470834036831e-05, "evaluation_iteration": 0.1325808715853025, "synch_eval_env_connectors": 0.00019414473232754153, "synch_env_connectors": 4.477616784259784e-06}, "env_runners": {"env_to_module_connector": {"timers": {"connectors": {"numpy_to_tensor": 1.3919220121259543e-05, "add_time_dim_to_batch_and_zero_pad": 7.535068767121346e-06, "batch_individual_items": 1.3445815102206975e-05, "add_observations_from_episodes_to_batch": 3.01423893808161e-06, "add_states_from_episodes_to_batch": 2.9473604502797096e-06}}, "connector_pipeline_timer": 6.423494322999493e-05}, "module_to_env_connector": {"timers": {"connectors": {"tensor_to_numpy": 1.649116067074607e-05, "un_batch_to_individual_items": 7.060463327451751e-06, "listify_data_for_vector_env": 1.1137587017116292e-05, "get_actions": 4.299250633932954e-05, "remove_single_ts_time_rank_from_batch": 1.2744461496253623e-05, "normalize_and_clip_actions": 8.608263507056928e-06}}, "connector_pipeline_timer": 0.00012743810225169952}, "module_episode_returns_mean": {"default_policy": 6.179999999999998}, "episode_len_min": 20, "env_reset_timer": 5.2124543746936736e-05, "agent_episode_returns_mean": {"default_agent": 6.179999999999998}, "time_between_sampling": 0.04122588423402331, "env_to_module_sum_episodes_length_out": 10.36823839457432, "num_module_steps_sampled": {"default_policy": 5000.0}, "env_step_timer": 1.536474671772858e-05, "weights_seq_no": 17.0, "num_env_steps_sampled_lifetime": -9870000.0, "num_agent_steps_sampled": {"default_agent": 5000.0}, "num_episodes_lifetime": -493500.0, "episode_len_mean": 20.0, "episode_duration_sec_mean": 0.005708664163015781, "episode_return_max": 14.5, "episode_len_max": 20, "num_module_steps_sampled_lifetime": {"default_policy": -9870000.0}, "episode_return_min": -5.5, "rlmodule_inference_timer": 3.453515102058484e-05, "episode_return_mean": 6.179999999999998, "env_to_module_sum_episodes_length_in": 10.36823839457432, "num_agent_steps_sampled_lifetime": {"default_agent": -9870000.0}, "num_episodes": 250.0, "sample": 0.006112385411167239, "num_env_steps_sampled": 5000.0, "num_env_steps_sampled_lifetime_throughput": 3008.6676797196965}, "__all_modules__": {"learner_connector_sum_episodes_length_in": 5000.0, "learner_connector": {"connector_pipeline_timer": 0.18569521123607022, "timers": {"connectors": {"add_one_ts_to_episodes_and_truncate": 0.00974776288694416, "add_observations_from_episodes_to_batch": 0.0008698194099740941, "add_columns_from_episodes_to_train_batch": 0.04344317699118641, "add_time_dim_to_batch_and_zero_pad": 0.11099021791468852, "add_states_from_episodes_to_batch": 0.0039616692565032, "batch_individual_items": 0.016407446094385637, "numpy_to_tensor": 8.695944591951128e-05}}}, "learner_connector_sum_episodes_length_out": 5250.0}, "learners": {"default_policy": {"num_module_steps_trained_lifetime": 107892, "policy_loss": -0.0001560694072395563, "diff_num_grad_updates_vs_sampler_policy": 1.0, "num_trainable_parameters": 16595, "mean_kl_loss": 7.545716471213382e-06, "curr_entropy_coeff": 0.0015431216992, "total_loss": 0.20435477793216705, "module_train_batch_size_mean": 999.0, "curr_kl_coeff": 6.163937769088079e-07, "use_intrinsic_rewards": 0.0, "weights_seq_no": 18.0, "vf_loss": 0.26386773586273193, "num_module_steps_trained": 5994, "entropy": 0.6840621829032898, "vf_loss_unclipped": 43.547630310058594, "vf_explained_var": 9.775161743164062e-06, "num_module_steps_trained_lifetime_throughput": 659.3461613299022}, "intrinsic_reward_module": {"diff_num_grad_updates_vs_sampler_policy": 1.0, "gradients_default_optimizer_global_norm": 0.0, "num_trainable_parameters": 8266, "curr_entropy_coeff": 0.0015431216992, "total_loss": 0.0, "module_train_batch_size_mean": 999.0, "default_optimizer_learning_rate": 0.0002715581955, "weights_seq_no": 18.0, "num_module_steps_trained": 5994, "num_module_steps_trained_lifetime": 107892, "num_module_steps_trained_lifetime_throughput": 659.3512804209763}, "differentiable_learners": {"intrinsic_attention_ppo_learner": {"default_policy": {"policy_loss": -0.00014847810962237418, "diff_num_grad_updates_vs_sampler_policy": 91.0, "mean_kl_loss": 6.764933004888007e-06, "total_loss": 0.20437780022621155, "module_train_batch_size_mean": 999.0, "use_intrinsic_rewards": 1.0, "weights_seq_no": 108.0, "vf_loss": 0.2638862133026123, "num_module_steps_trained": 35964, "entropy": 0.6840894818305969, "vf_loss_unclipped": 43.46942901611328, "vf_explained_var": 0.0014382004737854004, "num_module_steps_trained_lifetime": 647352}, "__all_modules__": {"num_env_steps_trained": 189000, "num_module_steps_trained": 71928, "num_module_steps_trained_lifetime": 1294704, "num_env_steps_trained_lifetime": 3402000, "num_env_steps_trained_lifetime_throughput": 38374.152448079476}, "intrinsic_reward_module": {"num_module_steps_trained_lifetime": 647352, "diff_num_grad_updates_vs_sampler_policy": 91.0, "total_loss": 0.0, "module_train_batch_size_mean": 999.0, "weights_seq_no": 108.0, "num_module_steps_trained": 35964}}}, "__all_modules__": {"num_trainable_parameters": 24861, "num_env_steps_trained": 31500, "num_module_steps_trained": 11988, "num_non_trainable_parameters": 0, "num_module_steps_trained_lifetime": 215784, "num_env_steps_trained_lifetime": 567000, "num_env_steps_trained_lifetime_throughput": 3465.1041583862902, "num_module_steps_trained_throughput": 18212899.928357802, "num_module_steps_trained_lifetime_throughput": 11259161.50553563}, "IntrinsicAttentionMask": [[[0.33446839451789856, 0.33278828859329224, 0.33274325728416443], [0.33378320932388306, 0.3331173360347748, 0.33309948444366455], [0.33376479148864746, 0.33312615752220154, 0.3331090211868286]], [[0.33470049500465393, 0.33675017952919006, 0.3285492956638336], [0.3348800539970398, 0.33720460534095764, 0.32791534066200256], [0.33415165543556213, 0.335369348526001, 0.3304790258407593]], [[0.3333762288093567, 0.3333333134651184, 0.3332904577255249], [0.3333755135536194, 0.3333333432674408, 0.3332911729812622], [0.3333747684955597, 0.3333333432674408, 0.3332919180393219]], [[0.3329949975013733, 0.3357183039188385, 0.3312866985797882], [0.33287981152534485, 0.33651670813560486, 0.3306035101413727], [0.3330671787261963, 0.3352145552635193, 0.3317182958126068]], [[0.33344343304634094, 0.3333333134651184, 0.3332231938838959], [0.33344271779060364, 0.3333333134651184, 0.33322396874427795], [0.33344197273254395, 0.333333283662796, 0.33322465419769287]], [[0.33992913365364075, 0.3211250603199005, 0.33894583582878113], [0.24480576813220978, 0.5012917518615723, 0.25390252470970154], [0.33537501096725464, 0.3295489549636841, 0.3350759744644165]]]}, "num_training_step_calls_per_iteration": 1, "evaluation": {"env_runners": {"env_to_module_connector": {"timers": {"connectors": {"add_observations_from_episodes_to_batch": 3.0502342190050193e-06, "numpy_to_tensor": 1.3279754675170855e-05, "batch_individual_items": 1.3181461353315747e-05, "add_states_from_episodes_to_batch": 3.0386037469728138e-06, "add_time_dim_to_batch_and_zero_pad": 7.488386082300921e-06}}, "connector_pipeline_timer": 6.348535990494271e-05}, "num_module_steps_sampled_lifetime": {"default_policy": 7200}, "num_env_steps_sampled_lifetime": 90400, "weights_seq_no": 18.0, "module_to_env_connector": {"timers": {"connectors": {"get_actions": 4.5560375426442325e-05, "un_batch_to_individual_items": 7.006444884375765e-06, "listify_data_for_vector_env": 1.1933207436420176e-05, "remove_single_ts_time_rank_from_batch": 1.3168745534529978e-05, "normalize_and_clip_actions": 8.476442760033105e-06, "tensor_to_numpy": 1.7109394022105215e-05}}, "connector_pipeline_timer": 0.0001322549105537102}, "episode_return_min": -13.5, "rlmodule_inference_timer": 3.54552573276664e-05, "num_episodes": 20, "num_agent_steps_sampled": {"default_agent": 400}, "num_env_steps_sampled": 400, "episode_len_max": 20, "env_to_module_sum_episodes_length_in": 10.368238394574323, "agent_episode_returns_mean": {"default_agent": 1.7}, "env_reset_timer": 0.0005556295408752168, "episode_len_min": 20, "env_to_module_sum_episodes_length_out": 10.368238394574323, "env_step_timer": 1.614788538528883e-05, "episode_len_mean": 20.0, "episode_duration_sec_mean": 0.005623165334109217, "num_module_steps_sampled": {"default_policy": 400}, "module_episode_returns_mean": {"default_policy": 1.7}, "sample": 0.12105863502449038, "num_agent_steps_sampled_lifetime": {"default_agent": 7200}, "num_episodes_lifetime": 360, "episode_return_max": 15.5, "episode_return_mean": 1.7, "time_between_sampling": 11.150303910775987}, "num_healthy_workers": 1, "actor_manager_num_outstanding_async_reqs": 0, "num_remote_worker_restarts": 0}, "num_env_steps_sampled_lifetime": -9870000.0, "fault_tolerance": {"num_healthy_workers": 0, "num_remote_worker_restarts": 0}, "env_runner_group": {"actor_manager_num_outstanding_async_reqs": 0}, "done": false, "training_iteration": 18, "trial_id": "b7d6e_00000", "date": "2025-08-11_18-11-33", "timestamp": 1754928693, "time_this_iter_s": 11.098735094070435, "time_total_s": 204.3066725730896, "pid": 10343, "hostname": "Mac", "node_ip": "127.0.0.1", "config": {"exploration_config": {}, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 2, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "env": "Umbrella", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": false, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 0, "create_local_env_runner": true, "num_envs_per_env_runner": 1, "gym_env_vectorize_mode": "SYNC", "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "episodes_to_numpy": true, "max_requests_in_flight_per_env_runner": 1, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "merge_env_runner_states": "training_only", "broadcast_env_runner_states": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "complete_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "sampler_perf_stats_ema_coef": null, "_is_online": true, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": "auto", "num_aggregator_actors_per_learner": 0, "max_requests_in_flight_per_aggregator_actor": 3, "local_gpu_idx": 0, "max_requests_in_flight_per_learner": 3, "gamma": 1, "lr": 0.0002715581955, "grad_clip": 0.5, "grad_clip_by": "global_norm", "_train_batch_size_per_learner": 5000, "train_batch_size": 4000, "num_epochs": 1, "minibatch_size": 1000, "shuffle_batch_per_epoch": true, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "log_std_clip_param": 20.0, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "_disable_preprocessor_api": false, "_disable_action_flattening": false}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {"intrinsic_reward_coeff": 0.2795015916508}, "optimizer": {}, "_learner_class": "<class 'source.intrinsic_attention_ppo.learners.IntrinsicAttentionMetaLearner.IntrinsicAttentionMetaLearner'>", "callbacks_on_algorithm_init": null, "callbacks_on_env_runners_recreated": null, "callbacks_on_offline_eval_runners_recreated": null, "callbacks_on_checkpoint_loaded": null, "callbacks_on_environment_created": null, "callbacks_on_episode_created": null, "callbacks_on_episode_start": null, "callbacks_on_episode_step": null, "callbacks_on_episode_end": null, "callbacks_on_evaluate_start": null, "callbacks_on_evaluate_end": null, "callbacks_on_evaluate_offline_start": null, "callbacks_on_evaluate_offline_end": null, "callbacks_on_sample_end": null, "callbacks_on_train_result": null, "explore": true, "enable_rl_module_and_learner": true, "enable_env_runner_and_connector_v2": true, "_prior_exploration_config": {"type": "StochasticSampling"}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x1616f98a0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "offline_data_class": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_read_batch_size": null, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "materialize_data": false, "materialize_mapped_data": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "ignore_final_observation": false, "prelearner_class": null, "prelearner_buffer_class": null, "prelearner_buffer_kwargs": {}, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_remaining_data": false, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": 1, "evaluation_duration": 20, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_auto_duration_min_env_steps_per_sample": 100, "evaluation_auto_duration_max_env_steps_per_sample": 2000, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 1, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "offline_evaluation_interval": null, "num_offline_eval_runners": 0, "offline_loss_for_module_fn": null, "offline_evaluation_duration": 1, "offline_evaluation_parallel_to_training": false, "offline_evaluation_timeout_s": 120.0, "num_cpus_per_offline_eval_runner": 1, "num_gpus_per_offline_eval_runner": 0, "custom_resources_per_offline_eval_runner": {}, "restart_failed_offline_eval_runners": true, "ignore_offline_eval_runner_failures": false, "max_num_offline_eval_runner_restarts": 1000, "offline_eval_runner_restore_timeout_s": 1800.0, "max_requests_in_flight_per_offline_eval_runner": 1, "validate_offline_eval_runners_after_construction": true, "offline_eval_runner_health_probe_timeout_s": 30.0, "offline_eval_rl_module_inference_only": false, "broadcast_offline_eval_runner_states": false, "offline_eval_batch_size_per_runner": 256, "dataset_num_iters_per_eval_runner": 1, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "log_gradients": false, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 9, "restart_failed_env_runners": true, "ignore_env_runner_failures": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30.0, "env_runner_restore_timeout_s": 1800.0, "_model_config": {}, "_rl_module_spec": "MultiRLModuleSpec(multi_rl_module_class=<class 'ray.rllib.core.rl_module.multi_rl_module.MultiRLModule'>, observation_space=None, action_space=None, inference_only=False, model_config=None, rl_module_specs={'default_policy': RLModuleSpec(module_class=<class 'source.intrinsic_attention_ppo.rl_modules.DifferentiablePPOModule.DifferentiablePPOModule'>, observation_space=None, action_space=None, inference_only=False, learner_only=False, model_config={'vf_share_layers': True, 'embedding_dim': 62, 'max_seq_len': 3, 'policy_head_hidden_sizes': [32], 'value_head_hidden_sizes': [101], 'embedding_hidden_sizes': [121]}, catalog_class=None, load_state_path=None, model_config_dict=None), 'intrinsic_reward_module': RLModuleSpec(module_class=<class 'source.intrinsic_attention_ppo.rl_modules.IntrinsicAttentionModule.IntrinsicAttentionModule'>, observation_space=None, action_space=None, inference_only=False, learner_only=True, model_config={'intrinsic_reward_network': {'encoder_hidden_sizes': [], 'encoding_dim': 1, 'num_heads': 1, 'head_hidden_sizes': None, 'layers': [{'type': 'attention'}]}, 'extrinsic_value_hidden_layers': [127, 60], 'vf_share_layers': True, 'max_seq_len': 3}, catalog_class=None, load_state_path=None, model_config_dict=None)}, load_state_path=None, modules_to_load=None, module_specs={'default_policy': RLModuleSpec(module_class=<class 'source.intrinsic_attention_ppo.rl_modules.DifferentiablePPOModule.DifferentiablePPOModule'>, observation_space=None, action_space=None, inference_only=False, learner_only=False, model_config={'vf_share_layers': True, 'embedding_dim': 62, 'max_seq_len': 3, 'policy_head_hidden_sizes': [32], 'value_head_hidden_sizes': [101], 'embedding_hidden_sizes': [121]}, catalog_class=None, load_state_path=None, model_config_dict=None), 'intrinsic_reward_module': RLModuleSpec(module_class=<class 'source.intrinsic_attention_ppo.rl_modules.IntrinsicAttentionModule.IntrinsicAttentionModule'>, observation_space=None, action_space=None, inference_only=False, learner_only=True, model_config={'intrinsic_reward_network': {'encoder_hidden_sizes': [], 'encoding_dim': 1, 'num_heads': 1, 'head_hidden_sizes': None, 'layers': [{'type': 'attention'}]}, 'extrinsic_value_hidden_layers': [127, 60], 'vf_share_layers': True, 'max_seq_len': 3}, catalog_class=None, load_state_path=None, model_config_dict=None)})", "algorithm_config_overrides_per_module": {"intrinsic_reward_module": {"lr": 0.0002715581955}}, "_per_module_overrides": {}, "_validate_config": true, "_use_msgpack_checkpoints": false, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "env_task_fn": -1, "enable_connectors": -1, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.161583927863, "kl_target": 0.0201019014258, "vf_loss_coeff": 0.7790510010087, "entropy_coeff": 0.0015431216992, "clip_param": 0.2459212356676, "vf_clip_param": 0.3769744131561, "entropy_coeff_schedule": null, "lr_schedule": null, "sgd_minibatch_size": -1, "vf_share_layers": -1, "differentiable_learner_configs": ["DifferentiableLearnerConfig(learner_class=<class 'source.intrinsic_attention_ppo.learners.IntrinsicAttentionPPOLearner.IntrinsicAttentionPPOLearner'>, learner_connector=None, add_default_connectors_to_learner_pipeline=True, is_multi_agent=False, policies_to_update=['default_policy'], lr=0.0060984166342, num_total_minibatches=0, num_epochs=1, minibatch_size=1000, shuffle_batch_per_epoch=True)"], "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9485408017724, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.callbacks.callbacks.RLlibCallback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 204.3066725730896, "iterations_since_restore": 18, "perf": {"cpu_util_percent": 43.22666666666667, "ram_util_percent": 82.35333333333332}}
{"timers": {"training_iteration": 10.522370279641448, "restore_env_runners": 5.7820703273224045e-05, "training_step": 10.522040325636661, "env_runner_sampling_timer": 1.7614944627866345, "learner_update_timer": 8.531327965877622, "synch_weights": 0.00176923947386307, "restore_eval_env_runners": 5.623427165021759e-05, "evaluation_iteration": 0.13261486869973815, "synch_eval_env_connectors": 0.0001939295356341382, "synch_env_connectors": 4.473261180308717e-06}, "env_runners": {"env_to_module_connector": {"timers": {"connectors": {"numpy_to_tensor": 1.6733280519773203e-05, "add_time_dim_to_batch_and_zero_pad": 8.64897681395273e-06, "batch_individual_items": 1.688588659276389e-05, "add_observations_from_episodes_to_batch": 3.785688002528903e-06, "add_states_from_episodes_to_batch": 3.294219244311588e-06}}, "connector_pipeline_timer": 7.559875418864473e-05}, "module_to_env_connector": {"timers": {"connectors": {"tensor_to_numpy": 1.9249229656311263e-05, "un_batch_to_individual_items": 7.830845459528484e-06, "listify_data_for_vector_env": 1.3921400950672535e-05, "get_actions": 5.3340355563636884e-05, "remove_single_ts_time_rank_from_batch": 1.462607113943228e-05, "normalize_and_clip_actions": 9.997392229863625e-06}}, "connector_pipeline_timer": 0.0001525608098565545}, "module_episode_returns_mean": {"default_policy": 6.019999999999998}, "episode_len_min": 20, "env_reset_timer": 5.270468094693771e-05, "agent_episode_returns_mean": {"default_agent": 6.019999999999998}, "time_between_sampling": 0.03857195315274242, "env_to_module_sum_episodes_length_out": 10.36823839457432, "num_module_steps_sampled": {"default_policy": 5000.0}, "env_step_timer": 1.8717410098622847e-05, "weights_seq_no": 18.0, "num_env_steps_sampled_lifetime": -10487500.0, "num_agent_steps_sampled": {"default_agent": 5000.0}, "num_episodes_lifetime": -524375.0, "episode_len_mean": 20.0, "episode_duration_sec_mean": 0.0073563358457759, "episode_return_max": 14.5, "episode_len_max": 20, "num_module_steps_sampled_lifetime": {"default_policy": -10487500.0}, "episode_return_min": -5.5, "rlmodule_inference_timer": 7.08130547229312e-05, "episode_return_mean": 6.019999999999998, "env_to_module_sum_episodes_length_in": 10.36823839457432, "num_agent_steps_sampled_lifetime": {"default_agent": -10487500.0}, "num_episodes": 250.0, "sample": 0.00686325157382822, "num_env_steps_sampled": 5000.0, "num_env_steps_sampled_lifetime_throughput": 2877.563482492082}, "__all_modules__": {"learner_connector_sum_episodes_length_in": 5000.0, "learner_connector": {"connector_pipeline_timer": 0.18602027787359104, "timers": {"connectors": {"add_one_ts_to_episodes_and_truncate": 0.009754346927046274, "add_observations_from_episodes_to_batch": 0.0008702674659602584, "add_columns_from_episodes_to_train_batch": 0.04350170772112218, "add_time_dim_to_batch_and_zero_pad": 0.11123025365483609, "add_states_from_episodes_to_batch": 0.003968586723857415, "batch_individual_items": 0.016420110384329816, "numpy_to_tensor": 8.68252714955145e-05}}}, "learner_connector_sum_episodes_length_out": 5250.0}, "learners": {"default_policy": {"num_module_steps_trained_lifetime": 113886, "policy_loss": -6.046555790817365e-05, "diff_num_grad_updates_vs_sampler_policy": 1.0, "num_trainable_parameters": 16595, "mean_kl_loss": 1.1102652933914214e-05, "curr_entropy_coeff": 0.0015431216992, "total_loss": 0.2044508308172226, "module_train_batch_size_mean": 999.0, "curr_kl_coeff": 3.0819688845440396e-07, "use_intrinsic_rewards": 0.0, "weights_seq_no": 19.0, "vf_loss": 0.26386746764183044, "num_module_steps_trained": 5994, "entropy": 0.683633029460907, "vf_loss_unclipped": 45.70954132080078, "vf_explained_var": 7.957220077514648e-05, "num_module_steps_trained_lifetime_throughput": 655.9212768649735}, "intrinsic_reward_module": {"diff_num_grad_updates_vs_sampler_policy": 1.0, "gradients_default_optimizer_global_norm": 0.0, "num_trainable_parameters": 8266, "curr_entropy_coeff": 0.0015431216992, "total_loss": 0.0, "module_train_batch_size_mean": 999.0, "default_optimizer_learning_rate": 0.0002715581955, "weights_seq_no": 19.0, "num_module_steps_trained": 5994, "num_module_steps_trained_lifetime": 113886, "num_module_steps_trained_lifetime_throughput": 655.9260380414156}, "differentiable_learners": {"intrinsic_attention_ppo_learner": {"default_policy": {"policy_loss": -5.940207847743295e-05, "diff_num_grad_updates_vs_sampler_policy": 96.0, "mean_kl_loss": 1.0991523595293984e-05, "total_loss": 0.20447814464569092, "module_train_batch_size_mean": 999.0, "use_intrinsic_rewards": 1.0, "weights_seq_no": 114.0, "vf_loss": 0.26389893889427185, "num_module_steps_trained": 35964, "entropy": 0.6836363673210144, "vf_loss_unclipped": 45.63196563720703, "vf_explained_var": 0.0014204978942871094, "num_module_steps_trained_lifetime": 683316}, "__all_modules__": {"num_env_steps_trained": 189000, "num_module_steps_trained": 71928, "num_module_steps_trained_lifetime": 1366632, "num_env_steps_trained_lifetime": 3591000, "num_env_steps_trained_lifetime_throughput": 37782.20357934257}, "intrinsic_reward_module": {"num_module_steps_trained_lifetime": 683316, "diff_num_grad_updates_vs_sampler_policy": 96.0, "total_loss": 0.0, "module_train_batch_size_mean": 999.0, "weights_seq_no": 114.0, "num_module_steps_trained": 35964}}}, "__all_modules__": {"num_trainable_parameters": 24861, "num_env_steps_trained": 31500, "num_module_steps_trained": 11988, "num_non_trainable_parameters": 0, "num_module_steps_trained_lifetime": 227772, "num_env_steps_trained_lifetime": 598500, "num_env_steps_trained_lifetime_throughput": 3447.1020204868064, "num_module_steps_trained_throughput": 17876582.82164483, "num_module_steps_trained_lifetime_throughput": 11289535.447395612}, "IntrinsicAttentionMask": [[[0.3322606086730957, 0.33450692892074585, 0.33323249220848083], [0.3317699134349823, 0.33504459261894226, 0.33318549394607544], [0.33204787969589233, 0.33473995327949524, 0.3332121968269348]], [[0.33470049500465393, 0.33675017952919006, 0.3285492956638336], [0.3348800539970398, 0.33720460534095764, 0.32791534066200256], [0.33415165543556213, 0.335369348526001, 0.3304790258407593]], [[0.3343171775341034, 0.3341897130012512, 0.3314930498600006], [0.3343115448951721, 0.33418482542037964, 0.33150362968444824], [0.3341914713382721, 0.33408036828041077, 0.33172816038131714]], [[0.3332486152648926, 0.3335180878639221, 0.3332333266735077], [0.33296313881874084, 0.334140419960022, 0.3328964412212372], [0.3332647979259491, 0.3334827423095703, 0.3332524299621582]], [[0.3334582448005676, 0.3333333134651184, 0.33320844173431396], [0.3334575295448303, 0.3333333134651184, 0.33320915699005127], [0.33345678448677063, 0.3333333134651184, 0.33320990204811096]], [[0.3145407438278198, 0.3764033615589142, 0.30905595421791077], [0.24569915235042572, 0.5262704491615295, 0.22803044319152832], [0.32067734003067017, 0.36247146129608154, 0.31685125827789307]]]}, "num_training_step_calls_per_iteration": 1, "evaluation": {"env_runners": {"env_to_module_connector": {"timers": {"connectors": {"add_observations_from_episodes_to_batch": 3.271168484575428e-06, "numpy_to_tensor": 1.4019867700018256e-05, "batch_individual_items": 1.4136159692687918e-05, "add_states_from_episodes_to_batch": 3.408044315122914e-06, "add_time_dim_to_batch_and_zero_pad": 8.066045035697731e-06}}, "connector_pipeline_timer": 6.764264822093742e-05}, "num_module_steps_sampled_lifetime": {"default_policy": 7600}, "num_env_steps_sampled_lifetime": 95400, "weights_seq_no": 19.0, "module_to_env_connector": {"timers": {"connectors": {"get_actions": 4.500607018756148e-05, "un_batch_to_individual_items": 7.131577221231673e-06, "listify_data_for_vector_env": 1.2420006298692999e-05, "remove_single_ts_time_rank_from_batch": 1.3907967057882233e-05, "normalize_and_clip_actions": 1.1103604199880749e-05, "tensor_to_numpy": 1.7921361895760463e-05}}, "connector_pipeline_timer": 0.00013891608975252897}, "episode_return_min": -13.5, "rlmodule_inference_timer": 3.8792390684358444e-05, "num_episodes": 20, "num_agent_steps_sampled": {"default_agent": 400}, "num_env_steps_sampled": 400, "episode_len_max": 20, "env_to_module_sum_episodes_length_in": 10.368238394574323, "agent_episode_returns_mean": {"default_agent": 0.5}, "env_reset_timer": 0.000554144905107805, "episode_len_min": 20, "env_to_module_sum_episodes_length_out": 10.368238394574323, "env_step_timer": 1.666779486393769e-05, "episode_len_mean": 20.0, "episode_duration_sec_mean": 0.005838358706096187, "num_module_steps_sampled": {"default_policy": 400}, "module_episode_returns_mean": {"default_policy": 0.5}, "sample": 0.12125404825441084, "num_agent_steps_sampled_lifetime": {"default_agent": 7600}, "num_episodes_lifetime": 380, "episode_return_max": 15.5, "episode_return_mean": 0.5, "time_between_sampling": 11.16122130875856}, "num_healthy_workers": 1, "actor_manager_num_outstanding_async_reqs": 0, "num_remote_worker_restarts": 0}, "num_env_steps_sampled_lifetime": -10487500.0, "fault_tolerance": {"num_healthy_workers": 0, "num_remote_worker_restarts": 0}, "env_runner_group": {"actor_manager_num_outstanding_async_reqs": 0}, "done": false, "training_iteration": 19, "trial_id": "b7d6e_00000", "date": "2025-08-11_18-11-45", "timestamp": 1754928705, "time_this_iter_s": 12.36313009262085, "time_total_s": 216.66980266571045, "pid": 10343, "hostname": "Mac", "node_ip": "127.0.0.1", "config": {"exploration_config": {}, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 2, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "env": "Umbrella", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": false, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 0, "create_local_env_runner": true, "num_envs_per_env_runner": 1, "gym_env_vectorize_mode": "SYNC", "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "episodes_to_numpy": true, "max_requests_in_flight_per_env_runner": 1, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "merge_env_runner_states": "training_only", "broadcast_env_runner_states": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "complete_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "sampler_perf_stats_ema_coef": null, "_is_online": true, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": "auto", "num_aggregator_actors_per_learner": 0, "max_requests_in_flight_per_aggregator_actor": 3, "local_gpu_idx": 0, "max_requests_in_flight_per_learner": 3, "gamma": 1, "lr": 0.0002715581955, "grad_clip": 0.5, "grad_clip_by": "global_norm", "_train_batch_size_per_learner": 5000, "train_batch_size": 4000, "num_epochs": 1, "minibatch_size": 1000, "shuffle_batch_per_epoch": true, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "log_std_clip_param": 20.0, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "_disable_preprocessor_api": false, "_disable_action_flattening": false}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {"intrinsic_reward_coeff": 0.2795015916508}, "optimizer": {}, "_learner_class": "<class 'source.intrinsic_attention_ppo.learners.IntrinsicAttentionMetaLearner.IntrinsicAttentionMetaLearner'>", "callbacks_on_algorithm_init": null, "callbacks_on_env_runners_recreated": null, "callbacks_on_offline_eval_runners_recreated": null, "callbacks_on_checkpoint_loaded": null, "callbacks_on_environment_created": null, "callbacks_on_episode_created": null, "callbacks_on_episode_start": null, "callbacks_on_episode_step": null, "callbacks_on_episode_end": null, "callbacks_on_evaluate_start": null, "callbacks_on_evaluate_end": null, "callbacks_on_evaluate_offline_start": null, "callbacks_on_evaluate_offline_end": null, "callbacks_on_sample_end": null, "callbacks_on_train_result": null, "explore": true, "enable_rl_module_and_learner": true, "enable_env_runner_and_connector_v2": true, "_prior_exploration_config": {"type": "StochasticSampling"}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x1616f98a0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "offline_data_class": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_read_batch_size": null, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "materialize_data": false, "materialize_mapped_data": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "ignore_final_observation": false, "prelearner_class": null, "prelearner_buffer_class": null, "prelearner_buffer_kwargs": {}, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_remaining_data": false, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": 1, "evaluation_duration": 20, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_auto_duration_min_env_steps_per_sample": 100, "evaluation_auto_duration_max_env_steps_per_sample": 2000, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 1, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "offline_evaluation_interval": null, "num_offline_eval_runners": 0, "offline_loss_for_module_fn": null, "offline_evaluation_duration": 1, "offline_evaluation_parallel_to_training": false, "offline_evaluation_timeout_s": 120.0, "num_cpus_per_offline_eval_runner": 1, "num_gpus_per_offline_eval_runner": 0, "custom_resources_per_offline_eval_runner": {}, "restart_failed_offline_eval_runners": true, "ignore_offline_eval_runner_failures": false, "max_num_offline_eval_runner_restarts": 1000, "offline_eval_runner_restore_timeout_s": 1800.0, "max_requests_in_flight_per_offline_eval_runner": 1, "validate_offline_eval_runners_after_construction": true, "offline_eval_runner_health_probe_timeout_s": 30.0, "offline_eval_rl_module_inference_only": false, "broadcast_offline_eval_runner_states": false, "offline_eval_batch_size_per_runner": 256, "dataset_num_iters_per_eval_runner": 1, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "log_gradients": false, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 9, "restart_failed_env_runners": true, "ignore_env_runner_failures": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30.0, "env_runner_restore_timeout_s": 1800.0, "_model_config": {}, "_rl_module_spec": "MultiRLModuleSpec(multi_rl_module_class=<class 'ray.rllib.core.rl_module.multi_rl_module.MultiRLModule'>, observation_space=None, action_space=None, inference_only=False, model_config=None, rl_module_specs={'default_policy': RLModuleSpec(module_class=<class 'source.intrinsic_attention_ppo.rl_modules.DifferentiablePPOModule.DifferentiablePPOModule'>, observation_space=None, action_space=None, inference_only=False, learner_only=False, model_config={'vf_share_layers': True, 'embedding_dim': 62, 'max_seq_len': 3, 'policy_head_hidden_sizes': [32], 'value_head_hidden_sizes': [101], 'embedding_hidden_sizes': [121]}, catalog_class=None, load_state_path=None, model_config_dict=None), 'intrinsic_reward_module': RLModuleSpec(module_class=<class 'source.intrinsic_attention_ppo.rl_modules.IntrinsicAttentionModule.IntrinsicAttentionModule'>, observation_space=None, action_space=None, inference_only=False, learner_only=True, model_config={'intrinsic_reward_network': {'encoder_hidden_sizes': [], 'encoding_dim': 1, 'num_heads': 1, 'head_hidden_sizes': None, 'layers': [{'type': 'attention'}]}, 'extrinsic_value_hidden_layers': [127, 60], 'vf_share_layers': True, 'max_seq_len': 3}, catalog_class=None, load_state_path=None, model_config_dict=None)}, load_state_path=None, modules_to_load=None, module_specs={'default_policy': RLModuleSpec(module_class=<class 'source.intrinsic_attention_ppo.rl_modules.DifferentiablePPOModule.DifferentiablePPOModule'>, observation_space=None, action_space=None, inference_only=False, learner_only=False, model_config={'vf_share_layers': True, 'embedding_dim': 62, 'max_seq_len': 3, 'policy_head_hidden_sizes': [32], 'value_head_hidden_sizes': [101], 'embedding_hidden_sizes': [121]}, catalog_class=None, load_state_path=None, model_config_dict=None), 'intrinsic_reward_module': RLModuleSpec(module_class=<class 'source.intrinsic_attention_ppo.rl_modules.IntrinsicAttentionModule.IntrinsicAttentionModule'>, observation_space=None, action_space=None, inference_only=False, learner_only=True, model_config={'intrinsic_reward_network': {'encoder_hidden_sizes': [], 'encoding_dim': 1, 'num_heads': 1, 'head_hidden_sizes': None, 'layers': [{'type': 'attention'}]}, 'extrinsic_value_hidden_layers': [127, 60], 'vf_share_layers': True, 'max_seq_len': 3}, catalog_class=None, load_state_path=None, model_config_dict=None)})", "algorithm_config_overrides_per_module": {"intrinsic_reward_module": {"lr": 0.0002715581955}}, "_per_module_overrides": {}, "_validate_config": true, "_use_msgpack_checkpoints": false, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "env_task_fn": -1, "enable_connectors": -1, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.161583927863, "kl_target": 0.0201019014258, "vf_loss_coeff": 0.7790510010087, "entropy_coeff": 0.0015431216992, "clip_param": 0.2459212356676, "vf_clip_param": 0.3769744131561, "entropy_coeff_schedule": null, "lr_schedule": null, "sgd_minibatch_size": -1, "vf_share_layers": -1, "differentiable_learner_configs": ["DifferentiableLearnerConfig(learner_class=<class 'source.intrinsic_attention_ppo.learners.IntrinsicAttentionPPOLearner.IntrinsicAttentionPPOLearner'>, learner_connector=None, add_default_connectors_to_learner_pipeline=True, is_multi_agent=False, policies_to_update=['default_policy'], lr=0.0060984166342, num_total_minibatches=0, num_epochs=1, minibatch_size=1000, shuffle_batch_per_epoch=True)"], "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9485408017724, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.callbacks.callbacks.RLlibCallback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 216.66980266571045, "iterations_since_restore": 19, "perf": {"cpu_util_percent": 53.55555555555555, "ram_util_percent": 82.43888888888888}}
{"timers": {"training_iteration": 10.532750113934224, "restore_env_runners": 5.729874695984536e-05, "training_step": 10.532419678210193, "env_runner_sampling_timer": 1.7638234939987647, "learner_update_timer": 8.538561444969533, "synch_weights": 0.0017837949987137202, "restore_eval_env_runners": 5.619400857844014e-05, "evaluation_iteration": 0.13282385918275041, "synch_eval_env_connectors": 0.0001937656600829957, "synch_env_connectors": 4.481439332275971e-06}, "env_runners": {"env_to_module_connector": {"timers": {"connectors": {"numpy_to_tensor": 1.5567286990245898e-05, "add_time_dim_to_batch_and_zero_pad": 8.245233438740977e-06, "batch_individual_items": 1.4441071946584227e-05, "add_observations_from_episodes_to_batch": 3.3360296512553842e-06, "add_states_from_episodes_to_batch": 3.186255916331814e-06}}, "connector_pipeline_timer": 7.010438894531511e-05}, "module_to_env_connector": {"timers": {"connectors": {"tensor_to_numpy": 1.774934572597401e-05, "un_batch_to_individual_items": 7.675940985939222e-06, "listify_data_for_vector_env": 1.23885690033992e-05, "get_actions": 4.793943622711275e-05, "remove_single_ts_time_rank_from_batch": 1.3729949480320195e-05, "normalize_and_clip_actions": 9.492054657688247e-06}}, "connector_pipeline_timer": 0.00013986034551031036}, "module_episode_returns_mean": {"default_policy": 6.019999999999998}, "episode_len_min": 20, "env_reset_timer": 6.421460785768144e-05, "agent_episode_returns_mean": {"default_agent": 6.019999999999998}, "time_between_sampling": 0.04191161605566582, "env_to_module_sum_episodes_length_out": 10.36823839457432, "num_module_steps_sampled": {"default_policy": 5000.0}, "env_step_timer": 1.7148847389180454e-05, "weights_seq_no": 19.0, "num_env_steps_sampled_lifetime": -11105000.0, "num_agent_steps_sampled": {"default_agent": 5000.0}, "num_episodes_lifetime": -555250.0, "episode_len_mean": 20.0, "episode_duration_sec_mean": 0.0062631536819972135, "episode_return_max": 14.5, "episode_len_max": 20, "num_module_steps_sampled_lifetime": {"default_policy": -11105000.0}, "episode_return_min": -5.5, "rlmodule_inference_timer": 3.82086921131292e-05, "episode_return_mean": 6.019999999999998, "env_to_module_sum_episodes_length_in": 10.36823839457432, "num_agent_steps_sampled_lifetime": {"default_agent": -11105000.0}, "num_episodes": 250.0, "sample": 0.0073600408949298715, "num_env_steps_sampled": 5000.0, "num_env_steps_sampled_lifetime_throughput": 2756.8838758508896}, "__all_modules__": {"learner_connector_sum_episodes_length_in": 5000.0, "learner_connector": {"connector_pipeline_timer": 0.1867344421745061, "timers": {"connectors": {"add_one_ts_to_episodes_and_truncate": 0.009747283457556466, "add_observations_from_episodes_to_batch": 0.0008700735406068577, "add_columns_from_episodes_to_train_batch": 0.04374040397409042, "add_time_dim_to_batch_and_zero_pad": 0.11172038319883226, "add_states_from_episodes_to_batch": 0.003974341266649846, "batch_individual_items": 0.01640552385976363, "numpy_to_tensor": 8.842576866135007e-05}}}, "learner_connector_sum_episodes_length_out": 5250.0}, "learners": {"default_policy": {"num_module_steps_trained_lifetime": 119880, "policy_loss": -0.0005162081797607243, "diff_num_grad_updates_vs_sampler_policy": 1.0, "num_trainable_parameters": 16595, "mean_kl_loss": 4.759626608574763e-05, "curr_entropy_coeff": 0.0015431216992, "total_loss": 0.20399752259254456, "module_train_batch_size_mean": 999.0, "curr_kl_coeff": 1.5409844422720198e-07, "use_intrinsic_rewards": 0.0, "weights_seq_no": 20.0, "vf_loss": 0.26386722922325134, "num_module_steps_trained": 5994, "entropy": 0.6819185018539429, "vf_loss_unclipped": 42.83034896850586, "vf_explained_var": 3.886222839355469e-05, "num_module_steps_trained_lifetime_throughput": 652.7540736772978}, "intrinsic_reward_module": {"diff_num_grad_updates_vs_sampler_policy": 1.0, "gradients_default_optimizer_global_norm": 0.0, "num_trainable_parameters": 8266, "curr_entropy_coeff": 0.0015431216992, "total_loss": 0.0, "module_train_batch_size_mean": 999.0, "default_optimizer_learning_rate": 0.0002715581955, "weights_seq_no": 20.0, "num_module_steps_trained": 5994, "num_module_steps_trained_lifetime": 119880, "num_module_steps_trained_lifetime_throughput": 652.7584817424364}, "differentiable_learners": {"intrinsic_attention_ppo_learner": {"default_policy": {"policy_loss": -0.0005016170325689018, "diff_num_grad_updates_vs_sampler_policy": 101.0, "mean_kl_loss": 4.482657095650211e-05, "total_loss": 0.20402877032756805, "module_train_batch_size_mean": 999.0, "use_intrinsic_rewards": 1.0, "weights_seq_no": 120.0, "vf_loss": 0.26387932896614075, "num_module_steps_trained": 35964, "entropy": 0.6819609999656677, "vf_loss_unclipped": 42.77422332763672, "vf_explained_var": 0.0012522339820861816, "num_module_steps_trained_lifetime": 719280}, "__all_modules__": {"num_env_steps_trained": 189000, "num_module_steps_trained": 71928, "num_module_steps_trained_lifetime": 1438560, "num_env_steps_trained_lifetime": 3780000, "num_env_steps_trained_lifetime_throughput": 37219.496692581706}, "intrinsic_reward_module": {"num_module_steps_trained_lifetime": 719280, "diff_num_grad_updates_vs_sampler_policy": 101.0, "total_loss": 0.0, "module_train_batch_size_mean": 999.0, "weights_seq_no": 120.0, "num_module_steps_trained": 35964}}}, "__all_modules__": {"num_trainable_parameters": 24861, "num_env_steps_trained": 31500, "num_module_steps_trained": 11988, "num_non_trainable_parameters": 0, "num_module_steps_trained_lifetime": 239760, "num_env_steps_trained_lifetime": 630000, "num_env_steps_trained_lifetime_throughput": 3430.454257890419, "num_module_steps_trained_throughput": 17561426.346534647, "num_module_steps_trained_lifetime_throughput": 11322268.93729041}, "IntrinsicAttentionMask": [[[0.3318576514720917, 0.33410122990608215, 0.33404120802879333], [0.3311832547187805, 0.33445215225219727, 0.3343645930290222], [0.3312012255191803, 0.33444279432296753, 0.3343559503555298]], [[0.3346891403198242, 0.3346378207206726, 0.3306730091571808], [0.3346697986125946, 0.3346192240715027, 0.3307109773159027], [0.33316272497177124, 0.3331691324710846, 0.33366817235946655]], [[0.33193111419677734, 0.3340907096862793, 0.33397814631462097], [0.33175572752952576, 0.33418548107147217, 0.33405882120132446], [0.3317648470401764, 0.3341805636882782, 0.3340546190738678]], [[0.33350899815559387, 0.33296772837638855, 0.33352330327033997], [0.332146555185318, 0.3358028829097748, 0.33205053210258484], [0.33354488015174866, 0.3328929841518402, 0.33356210589408875]], [[0.33514684438705444, 0.33248889446258545, 0.3323643207550049], [0.33492112159729004, 0.33259397745132446, 0.3324848711490631], [0.33491051197052, 0.3325989544391632, 0.33249056339263916]], [[0.3429511785507202, 0.3155484199523926, 0.3415004014968872], [0.24812735617160797, 0.4948704242706299, 0.2570022940635681], [0.33842968940734863, 0.32389605045318604, 0.3376743197441101]]]}, "num_training_step_calls_per_iteration": 1, "evaluation": {"env_runners": {"env_to_module_connector": {"timers": {"connectors": {"add_observations_from_episodes_to_batch": 4.125505139698242e-06, "numpy_to_tensor": 1.6517925223363267e-05, "batch_individual_items": 1.593865775793287e-05, "add_states_from_episodes_to_batch": 3.4738751220043187e-06, "add_time_dim_to_batch_and_zero_pad": 9.09663325040719e-06}}, "connector_pipeline_timer": 7.602952543017452e-05}, "num_module_steps_sampled_lifetime": {"default_policy": 8000}, "num_env_steps_sampled_lifetime": 100400, "weights_seq_no": 20.0, "module_to_env_connector": {"timers": {"connectors": {"get_actions": 5.759497279022885e-05, "un_batch_to_individual_items": 8.030197960438761e-06, "listify_data_for_vector_env": 1.3552683840055181e-05, "remove_single_ts_time_rank_from_batch": 1.4693297625050066e-05, "normalize_and_clip_actions": 1.013877746023996e-05, "tensor_to_numpy": 1.975099069790485e-05}}, "connector_pipeline_timer": 0.0001567247191672747}, "episode_return_min": -13.5, "rlmodule_inference_timer": 4.436526080621361e-05, "num_episodes": 20, "num_agent_steps_sampled": {"default_agent": 400}, "num_env_steps_sampled": 400, "episode_len_max": 20, "env_to_module_sum_episodes_length_in": 10.368238394574323, "agent_episode_returns_mean": {"default_agent": -0.3}, "env_reset_timer": 0.0005523372050924728, "episode_len_min": 20, "env_to_module_sum_episodes_length_out": 10.368238394574323, "env_step_timer": 2.0535718862899257e-05, "episode_len_mean": 20.0, "episode_duration_sec_mean": 0.005946955336257815, "num_module_steps_sampled": {"default_policy": 400}, "module_episode_returns_mean": {"default_policy": -0.3}, "sample": 0.12153825902093608, "num_agent_steps_sampled_lifetime": {"default_agent": 8000}, "num_episodes_lifetime": 400, "episode_return_max": 15.5, "episode_return_mean": -0.3, "time_between_sampling": 11.165562857751727}, "num_healthy_workers": 1, "actor_manager_num_outstanding_async_reqs": 0, "num_remote_worker_restarts": 0}, "num_env_steps_sampled_lifetime": -11105000.0, "fault_tolerance": {"num_healthy_workers": 0, "num_remote_worker_restarts": 0}, "env_runner_group": {"actor_manager_num_outstanding_async_reqs": 0}, "done": true, "training_iteration": 20, "trial_id": "b7d6e_00000", "date": "2025-08-11_18-11-57", "timestamp": 1754928717, "time_this_iter_s": 11.723840951919556, "time_total_s": 228.39364361763, "pid": 10343, "hostname": "Mac", "node_ip": "127.0.0.1", "config": {"exploration_config": {}, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 2, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "env": "Umbrella", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": false, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 0, "create_local_env_runner": true, "num_envs_per_env_runner": 1, "gym_env_vectorize_mode": "SYNC", "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "episodes_to_numpy": true, "max_requests_in_flight_per_env_runner": 1, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "merge_env_runner_states": "training_only", "broadcast_env_runner_states": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "complete_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "sampler_perf_stats_ema_coef": null, "_is_online": true, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": "auto", "num_aggregator_actors_per_learner": 0, "max_requests_in_flight_per_aggregator_actor": 3, "local_gpu_idx": 0, "max_requests_in_flight_per_learner": 3, "gamma": 1, "lr": 0.0002715581955, "grad_clip": 0.5, "grad_clip_by": "global_norm", "_train_batch_size_per_learner": 5000, "train_batch_size": 4000, "num_epochs": 1, "minibatch_size": 1000, "shuffle_batch_per_epoch": true, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "log_std_clip_param": 20.0, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "_disable_preprocessor_api": false, "_disable_action_flattening": false}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {"intrinsic_reward_coeff": 0.2795015916508}, "optimizer": {}, "_learner_class": "<class 'source.intrinsic_attention_ppo.learners.IntrinsicAttentionMetaLearner.IntrinsicAttentionMetaLearner'>", "callbacks_on_algorithm_init": null, "callbacks_on_env_runners_recreated": null, "callbacks_on_offline_eval_runners_recreated": null, "callbacks_on_checkpoint_loaded": null, "callbacks_on_environment_created": null, "callbacks_on_episode_created": null, "callbacks_on_episode_start": null, "callbacks_on_episode_step": null, "callbacks_on_episode_end": null, "callbacks_on_evaluate_start": null, "callbacks_on_evaluate_end": null, "callbacks_on_evaluate_offline_start": null, "callbacks_on_evaluate_offline_end": null, "callbacks_on_sample_end": null, "callbacks_on_train_result": null, "explore": true, "enable_rl_module_and_learner": true, "enable_env_runner_and_connector_v2": true, "_prior_exploration_config": {"type": "StochasticSampling"}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x1616f98a0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "offline_data_class": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_read_batch_size": null, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "materialize_data": false, "materialize_mapped_data": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "ignore_final_observation": false, "prelearner_class": null, "prelearner_buffer_class": null, "prelearner_buffer_kwargs": {}, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_remaining_data": false, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": 1, "evaluation_duration": 20, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_auto_duration_min_env_steps_per_sample": 100, "evaluation_auto_duration_max_env_steps_per_sample": 2000, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 1, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "offline_evaluation_interval": null, "num_offline_eval_runners": 0, "offline_loss_for_module_fn": null, "offline_evaluation_duration": 1, "offline_evaluation_parallel_to_training": false, "offline_evaluation_timeout_s": 120.0, "num_cpus_per_offline_eval_runner": 1, "num_gpus_per_offline_eval_runner": 0, "custom_resources_per_offline_eval_runner": {}, "restart_failed_offline_eval_runners": true, "ignore_offline_eval_runner_failures": false, "max_num_offline_eval_runner_restarts": 1000, "offline_eval_runner_restore_timeout_s": 1800.0, "max_requests_in_flight_per_offline_eval_runner": 1, "validate_offline_eval_runners_after_construction": true, "offline_eval_runner_health_probe_timeout_s": 30.0, "offline_eval_rl_module_inference_only": false, "broadcast_offline_eval_runner_states": false, "offline_eval_batch_size_per_runner": 256, "dataset_num_iters_per_eval_runner": 1, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "log_gradients": false, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 9, "restart_failed_env_runners": true, "ignore_env_runner_failures": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30.0, "env_runner_restore_timeout_s": 1800.0, "_model_config": {}, "_rl_module_spec": "MultiRLModuleSpec(multi_rl_module_class=<class 'ray.rllib.core.rl_module.multi_rl_module.MultiRLModule'>, observation_space=None, action_space=None, inference_only=False, model_config=None, rl_module_specs={'default_policy': RLModuleSpec(module_class=<class 'source.intrinsic_attention_ppo.rl_modules.DifferentiablePPOModule.DifferentiablePPOModule'>, observation_space=None, action_space=None, inference_only=False, learner_only=False, model_config={'vf_share_layers': True, 'embedding_dim': 62, 'max_seq_len': 3, 'policy_head_hidden_sizes': [32], 'value_head_hidden_sizes': [101], 'embedding_hidden_sizes': [121]}, catalog_class=None, load_state_path=None, model_config_dict=None), 'intrinsic_reward_module': RLModuleSpec(module_class=<class 'source.intrinsic_attention_ppo.rl_modules.IntrinsicAttentionModule.IntrinsicAttentionModule'>, observation_space=None, action_space=None, inference_only=False, learner_only=True, model_config={'intrinsic_reward_network': {'encoder_hidden_sizes': [], 'encoding_dim': 1, 'num_heads': 1, 'head_hidden_sizes': None, 'layers': [{'type': 'attention'}]}, 'extrinsic_value_hidden_layers': [127, 60], 'vf_share_layers': True, 'max_seq_len': 3}, catalog_class=None, load_state_path=None, model_config_dict=None)}, load_state_path=None, modules_to_load=None, module_specs={'default_policy': RLModuleSpec(module_class=<class 'source.intrinsic_attention_ppo.rl_modules.DifferentiablePPOModule.DifferentiablePPOModule'>, observation_space=None, action_space=None, inference_only=False, learner_only=False, model_config={'vf_share_layers': True, 'embedding_dim': 62, 'max_seq_len': 3, 'policy_head_hidden_sizes': [32], 'value_head_hidden_sizes': [101], 'embedding_hidden_sizes': [121]}, catalog_class=None, load_state_path=None, model_config_dict=None), 'intrinsic_reward_module': RLModuleSpec(module_class=<class 'source.intrinsic_attention_ppo.rl_modules.IntrinsicAttentionModule.IntrinsicAttentionModule'>, observation_space=None, action_space=None, inference_only=False, learner_only=True, model_config={'intrinsic_reward_network': {'encoder_hidden_sizes': [], 'encoding_dim': 1, 'num_heads': 1, 'head_hidden_sizes': None, 'layers': [{'type': 'attention'}]}, 'extrinsic_value_hidden_layers': [127, 60], 'vf_share_layers': True, 'max_seq_len': 3}, catalog_class=None, load_state_path=None, model_config_dict=None)})", "algorithm_config_overrides_per_module": {"intrinsic_reward_module": {"lr": 0.0002715581955}}, "_per_module_overrides": {}, "_validate_config": true, "_use_msgpack_checkpoints": false, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "env_task_fn": -1, "enable_connectors": -1, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.161583927863, "kl_target": 0.0201019014258, "vf_loss_coeff": 0.7790510010087, "entropy_coeff": 0.0015431216992, "clip_param": 0.2459212356676, "vf_clip_param": 0.3769744131561, "entropy_coeff_schedule": null, "lr_schedule": null, "sgd_minibatch_size": -1, "vf_share_layers": -1, "differentiable_learner_configs": ["DifferentiableLearnerConfig(learner_class=<class 'source.intrinsic_attention_ppo.learners.IntrinsicAttentionPPOLearner.IntrinsicAttentionPPOLearner'>, learner_connector=None, add_default_connectors_to_learner_pipeline=True, is_multi_agent=False, policies_to_update=['default_policy'], lr=0.0060984166342, num_total_minibatches=0, num_epochs=1, minibatch_size=1000, shuffle_batch_per_epoch=True)"], "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9485408017724, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.callbacks.callbacks.RLlibCallback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 228.39364361763, "iterations_since_restore": 20, "perf": {"cpu_util_percent": 47.47058823529412, "ram_util_percent": 81.7529411764706}}
