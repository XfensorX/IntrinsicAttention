{"timers": {"training_iteration": 10.973543457919732, "restore_env_runners": 2.2999942302703857e-05, "training_step": 10.973256791010499, "env_runner_sampling_timer": 1.7371586250374094, "learner_update_timer": 9.02695633401163, "synch_weights": 0.0016742079751566052}, "env_runners": {"module_to_env_connector": {"timers": {"connectors": {"listify_data_for_vector_env": 1.1310222342351994e-05, "normalize_and_clip_actions": 1.1071369423476835e-05, "get_actions": 5.409824318968667e-05, "tensor_to_numpy": 1.6830953909412025e-05, "un_batch_to_individual_items": 7.096080180521682e-06, "remove_single_ts_time_rank_from_batch": 1.2570094695655627e-05}}, "connector_pipeline_timer": 0.00014164943735478947}, "time_between_sampling": 0.0006937089179692247, "env_to_module_sum_episodes_length_in": 10.191744832559449, "env_to_module_connector": {"timers": {"connectors": {"add_observations_from_episodes_to_batch": 3.110626734663637e-06, "numpy_to_tensor": 1.3930773529317985e-05, "batch_individual_items": 1.351392139065482e-05, "add_states_from_episodes_to_batch": 2.9560043072185343e-06, "add_time_dim_to_batch_and_zero_pad": 7.72690371588054e-06}}, "connector_pipeline_timer": 6.626540545413358e-05}, "num_agent_steps_sampled_lifetime": {"default_agent": 627500.0}, "env_reset_timer": 9.744374067515929e-05, "episode_return_mean": 2.899999999999998, "episode_return_min": -9.5, "env_to_module_sum_episodes_length_out": 10.191744832559449, "module_episode_returns_mean": {"default_policy": 2.899999999999998}, "agent_episode_returns_mean": {"default_agent": 2.899999999999998}, "episode_len_max": 20, "sample": 0.007054639586724027, "rlmodule_inference_timer": 3.952261040247441e-05, "episode_len_mean": 20.0, "num_env_steps_sampled": 5000.0, "weights_seq_no": 0.0, "num_agent_steps_sampled": {"default_agent": 5000.0}, "episode_return_max": 10.5, "num_episodes": 250.0, "num_module_steps_sampled": {"default_policy": 5000.0}, "env_step_timer": 1.5855536540543883e-05, "num_module_steps_sampled_lifetime": {"default_policy": 627500.0}, "episode_duration_sec_mean": 0.005644279669970275, "num_episodes_lifetime": 31375.0, "num_env_steps_sampled_lifetime": 627500.0, "episode_len_min": 20, "num_env_steps_sampled_lifetime_throughput": 2922.7381542627672}, "__all_modules__": {"learner_connector_sum_episodes_length_in": 5000, "learner_connector": {"connector_pipeline_timer": 0.17062320897821337, "timers": {"connectors": {"add_one_ts_to_episodes_and_truncate": 0.009024792001582682, "add_observations_from_episodes_to_batch": 0.0008287499658763409, "add_columns_from_episodes_to_train_batch": 0.04167229193262756, "add_time_dim_to_batch_and_zero_pad": 0.10276079189497977, "add_states_from_episodes_to_batch": 0.003430791082791984, "batch_individual_items": 0.012688165996223688, "numpy_to_tensor": 7.208401802927256e-05}}}, "learner_connector_sum_episodes_length_out": 5250}, "learners": {"intrinsic_reward_module": {"gradients_default_optimizer_global_norm": 0.0, "num_module_steps_trained": 5994, "total_loss": 0.0, "num_trainable_parameters": 8266, "default_optimizer_learning_rate": 0.0002715581955, "curr_entropy_coeff": 0.0015431216992, "weights_seq_no": 1.0, "diff_num_grad_updates_vs_sampler_policy": 1.0, "num_module_steps_trained_lifetime": 5994, "module_train_batch_size_mean": 999.0, "num_module_steps_trained_lifetime_throughput": 661.0663005287678}, "__all_modules__": {"num_module_steps_trained_lifetime": 11988, "num_module_steps_trained": 11988, "num_non_trainable_parameters": 0, "num_env_steps_trained": 31500, "num_env_steps_trained_lifetime": 31500, "num_trainable_parameters": 24861, "num_env_steps_trained_lifetime_throughput": 3474.1305521357453, "num_module_steps_trained_throughput": 27810856.119572822, "num_module_steps_trained_lifetime_throughput": 11450301.219159342}, "differentiable_learners": {"intrinsic_attention_ppo_learner": {"intrinsic_reward_module": {"diff_num_grad_updates_vs_sampler_policy": 6.0, "total_loss": 0.0, "num_module_steps_trained_lifetime": 35964, "num_module_steps_trained": 35964, "module_train_batch_size_mean": 999.0, "weights_seq_no": 6.0}, "default_policy": {"num_module_steps_trained_lifetime": 35964, "num_module_steps_trained": 35964, "module_train_batch_size_mean": 999.0, "vf_loss_unclipped": 38.65363311767578, "mean_kl_loss": 1.2903777133033145e-05, "use_intrinsic_rewards": 1.0, "entropy": 0.6833815574645996, "policy_loss": -2.6566498490865342e-05, "diff_num_grad_updates_vs_sampler_policy": 6.0, "total_loss": 0.20369838178157806, "vf_explained_var": 0.00334322452545166, "weights_seq_no": 6.0, "vf_loss": 0.2628549337387085}, "__all_modules__": {"num_module_steps_trained_lifetime": 71928, "num_env_steps_trained": 189000, "num_env_steps_trained_lifetime": 189000, "num_module_steps_trained": 71928, "num_env_steps_trained_lifetime_throughput": 46785.16245108773}}}, "default_policy": {"vf_loss_unclipped": 38.62153625488281, "mean_kl_loss": 1.2737359611492138e-05, "curr_kl_coeff": 0.08079196512699127, "curr_entropy_coeff": 0.0015431216992, "use_intrinsic_rewards": 0.0, "entropy": 0.6833864450454712, "policy_loss": -2.846281677193474e-05, "diff_num_grad_updates_vs_sampler_policy": 1.0, "total_loss": 0.20348350703716278, "num_trainable_parameters": 16595, "vf_explained_var": 0.0033971071243286133, "weights_seq_no": 1.0, "vf_loss": 0.26258161664009094, "num_module_steps_trained_lifetime": 5994, "module_train_batch_size_mean": 999.0, "num_module_steps_trained": 5994, "num_module_steps_trained_lifetime_throughput": 661.0572703118338}, "IntrinsicAttentionMask": [[[0.3345363140106201, 0.33192166686058044, 0.33354195952415466], [0.3356791138648987, 0.33058398962020874, 0.33373692631721497], [0.33496981859207153, 0.3314139246940613, 0.33361631631851196]], [[0.3326926529407501, 0.33316388726234436, 0.3341434597969055], [0.3327537477016449, 0.33318009972572327, 0.33406615257263184], [0.33288052678108215, 0.3332137167453766, 0.33390581607818604]], [[0.332025408744812, 0.3343804180622101, 0.3335941731929779], [0.3325560390949249, 0.3339553475379944, 0.3334886133670807], [0.3323792815208435, 0.3340969383716583, 0.33352383971214294]], [[0.33337152004241943, 0.3327035903930664, 0.3339248299598694], [0.33337754011154175, 0.33260369300842285, 0.334018737077713], [0.3333665728569031, 0.3327862024307251, 0.33384719491004944]], [[0.3322586119174957, 0.335146427154541, 0.3325949013233185], [0.33261507749557495, 0.334544837474823, 0.33284008502960205], [0.3323003053665161, 0.33507609367370605, 0.33262360095977783]], [[0.33105653524398804, 0.33803102374076843, 0.3309124708175659], [0.3355117738246918, 0.328835666179657, 0.33565258979797363], [0.33096280694007874, 0.33822429180145264, 0.33081287145614624]]]}, "num_training_step_calls_per_iteration": 1, "num_env_steps_sampled_lifetime": 627500.0, "evaluation": {"env_runners": {"episode_len_max": 20, "rlmodule_inference_timer": 3.91671840475813e-05, "weights_seq_no": 1.0, "module_to_env_connector": {"timers": {"connectors": {"remove_single_ts_time_rank_from_batch": 1.2965016654448257e-05, "listify_data_for_vector_env": 1.0880722446415622e-05, "normalize_and_clip_actions": 9.120138759757601e-06, "get_actions": 4.8317775538065284e-05, "tensor_to_numpy": 1.7732472691793096e-05, "un_batch_to_individual_items": 6.818529809113142e-06}}, "connector_pipeline_timer": 0.0001327918193544197}, "episode_return_max": 13.5, "num_episodes": 20, "num_episodes_lifetime": 20, "num_agent_steps_sampled_lifetime": {"default_agent": 400}, "env_reset_timer": 0.0005516250384971499, "env_to_module_sum_episodes_length_out": 10.216013141322508, "num_module_steps_sampled_lifetime": {"default_policy": 400}, "env_to_module_connector": {"timers": {"connectors": {"numpy_to_tensor": 1.3068867464857505e-05, "batch_individual_items": 1.2948440693848484e-05, "add_observations_from_episodes_to_batch": 3.5564176328400004e-06, "add_states_from_episodes_to_batch": 3.0709968513208625e-06, "add_time_dim_to_batch_and_zero_pad": 8.691968764247259e-06}}, "connector_pipeline_timer": 6.64280984209207e-05}, "episode_return_mean": 0.65, "sample": 0.12407474999781698, "episode_len_mean": 20.0, "env_step_timer": 1.5671879215818544e-05, "episode_duration_sec_mean": 0.005631835403619334, "num_env_steps_sampled_lifetime": 5400, "agent_episode_returns_mean": {"default_agent": 0.65}, "num_env_steps_sampled": 400, "num_agent_steps_sampled": {"default_agent": 400}, "num_module_steps_sampled": {"default_policy": 400}, "episode_len_min": 20, "env_to_module_sum_episodes_length_in": 10.216013141322508, "module_episode_returns_mean": {"default_policy": 0.65}, "episode_return_min": -13.5}, "num_healthy_workers": 1, "actor_manager_num_outstanding_async_reqs": 0, "num_remote_worker_restarts": 0}, "fault_tolerance": {"num_healthy_workers": 0, "num_remote_worker_restarts": 0}, "env_runner_group": {"actor_manager_num_outstanding_async_reqs": 0}, "done": false, "training_iteration": 1, "trial_id": "ba99d_00000", "date": "2025-08-11_17-56-40", "timestamp": 1754927800, "time_this_iter_s": 11.112492084503174, "time_total_s": 11.112492084503174, "pid": 9655, "hostname": "Mac", "node_ip": "127.0.0.1", "config": {"exploration_config": {}, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 2, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "env": "Umbrella", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": false, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 0, "create_local_env_runner": true, "num_envs_per_env_runner": 1, "gym_env_vectorize_mode": "SYNC", "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "episodes_to_numpy": true, "max_requests_in_flight_per_env_runner": 1, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "merge_env_runner_states": "training_only", "broadcast_env_runner_states": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "complete_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "sampler_perf_stats_ema_coef": null, "_is_online": true, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": "auto", "num_aggregator_actors_per_learner": 0, "max_requests_in_flight_per_aggregator_actor": 3, "local_gpu_idx": 0, "max_requests_in_flight_per_learner": 3, "gamma": 1, "lr": 0.0002715581955, "grad_clip": 0.5, "grad_clip_by": "global_norm", "_train_batch_size_per_learner": 5000, "train_batch_size": 4000, "num_epochs": 1, "minibatch_size": 1000, "shuffle_batch_per_epoch": true, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "log_std_clip_param": 20.0, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "_disable_preprocessor_api": false, "_disable_action_flattening": false}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {"intrinsic_reward_coeff": 0.2795015916508}, "optimizer": {}, "_learner_class": "<class 'source.intrinsic_attention_ppo.learners.IntrinsicAttentionMetaLearner.IntrinsicAttentionMetaLearner'>", "callbacks_on_algorithm_init": null, "callbacks_on_env_runners_recreated": null, "callbacks_on_offline_eval_runners_recreated": null, "callbacks_on_checkpoint_loaded": null, "callbacks_on_environment_created": null, "callbacks_on_episode_created": null, "callbacks_on_episode_start": null, "callbacks_on_episode_step": null, "callbacks_on_episode_end": null, "callbacks_on_evaluate_start": null, "callbacks_on_evaluate_end": null, "callbacks_on_evaluate_offline_start": null, "callbacks_on_evaluate_offline_end": null, "callbacks_on_sample_end": null, "callbacks_on_train_result": null, "explore": true, "enable_rl_module_and_learner": true, "enable_env_runner_and_connector_v2": true, "_prior_exploration_config": {"type": "StochasticSampling"}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x15d6f98a0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "offline_data_class": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_read_batch_size": null, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "materialize_data": false, "materialize_mapped_data": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "ignore_final_observation": false, "prelearner_class": null, "prelearner_buffer_class": null, "prelearner_buffer_kwargs": {}, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_remaining_data": false, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": 1, "evaluation_duration": 20, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_auto_duration_min_env_steps_per_sample": 100, "evaluation_auto_duration_max_env_steps_per_sample": 2000, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 1, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "offline_evaluation_interval": null, "num_offline_eval_runners": 0, "offline_loss_for_module_fn": null, "offline_evaluation_duration": 1, "offline_evaluation_parallel_to_training": false, "offline_evaluation_timeout_s": 120.0, "num_cpus_per_offline_eval_runner": 1, "num_gpus_per_offline_eval_runner": 0, "custom_resources_per_offline_eval_runner": {}, "restart_failed_offline_eval_runners": true, "ignore_offline_eval_runner_failures": false, "max_num_offline_eval_runner_restarts": 1000, "offline_eval_runner_restore_timeout_s": 1800.0, "max_requests_in_flight_per_offline_eval_runner": 1, "validate_offline_eval_runners_after_construction": true, "offline_eval_runner_health_probe_timeout_s": 30.0, "offline_eval_rl_module_inference_only": false, "broadcast_offline_eval_runner_states": false, "offline_eval_batch_size_per_runner": 256, "dataset_num_iters_per_eval_runner": 1, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "log_gradients": false, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 6, "restart_failed_env_runners": true, "ignore_env_runner_failures": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30.0, "env_runner_restore_timeout_s": 1800.0, "_model_config": {}, "_rl_module_spec": "MultiRLModuleSpec(multi_rl_module_class=<class 'ray.rllib.core.rl_module.multi_rl_module.MultiRLModule'>, observation_space=None, action_space=None, inference_only=False, model_config=None, rl_module_specs={'default_policy': RLModuleSpec(module_class=<class 'source.intrinsic_attention_ppo.rl_modules.DifferentiablePPOModule.DifferentiablePPOModule'>, observation_space=None, action_space=None, inference_only=False, learner_only=False, model_config={'vf_share_layers': True, 'embedding_dim': 62, 'max_seq_len': 3, 'policy_head_hidden_sizes': [32], 'value_head_hidden_sizes': [101], 'embedding_hidden_sizes': [121]}, catalog_class=None, load_state_path=None, model_config_dict=None), 'intrinsic_reward_module': RLModuleSpec(module_class=<class 'source.intrinsic_attention_ppo.rl_modules.IntrinsicAttentionModule.IntrinsicAttentionModule'>, observation_space=None, action_space=None, inference_only=False, learner_only=True, model_config={'intrinsic_reward_network': {'encoder_hidden_sizes': [], 'encoding_dim': 1, 'num_heads': 1, 'head_hidden_sizes': None, 'layers': [{'type': 'attention'}]}, 'extrinsic_value_hidden_layers': [127, 60], 'vf_share_layers': True, 'max_seq_len': 3}, catalog_class=None, load_state_path=None, model_config_dict=None)}, load_state_path=None, modules_to_load=None, module_specs={'default_policy': RLModuleSpec(module_class=<class 'source.intrinsic_attention_ppo.rl_modules.DifferentiablePPOModule.DifferentiablePPOModule'>, observation_space=None, action_space=None, inference_only=False, learner_only=False, model_config={'vf_share_layers': True, 'embedding_dim': 62, 'max_seq_len': 3, 'policy_head_hidden_sizes': [32], 'value_head_hidden_sizes': [101], 'embedding_hidden_sizes': [121]}, catalog_class=None, load_state_path=None, model_config_dict=None), 'intrinsic_reward_module': RLModuleSpec(module_class=<class 'source.intrinsic_attention_ppo.rl_modules.IntrinsicAttentionModule.IntrinsicAttentionModule'>, observation_space=None, action_space=None, inference_only=False, learner_only=True, model_config={'intrinsic_reward_network': {'encoder_hidden_sizes': [], 'encoding_dim': 1, 'num_heads': 1, 'head_hidden_sizes': None, 'layers': [{'type': 'attention'}]}, 'extrinsic_value_hidden_layers': [127, 60], 'vf_share_layers': True, 'max_seq_len': 3}, catalog_class=None, load_state_path=None, model_config_dict=None)})", "algorithm_config_overrides_per_module": {"intrinsic_reward_module": {"lr": 0.0002715581955}}, "_per_module_overrides": {}, "_validate_config": true, "_use_msgpack_checkpoints": false, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "env_task_fn": -1, "enable_connectors": -1, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.161583927863, "kl_target": 0.0201019014258, "vf_loss_coeff": 0.7790510010087, "entropy_coeff": 0.0015431216992, "clip_param": 0.2459212356676, "vf_clip_param": 0.3769744131561, "entropy_coeff_schedule": null, "lr_schedule": null, "sgd_minibatch_size": -1, "vf_share_layers": -1, "differentiable_learner_configs": ["DifferentiableLearnerConfig(learner_class=<class 'source.intrinsic_attention_ppo.learners.IntrinsicAttentionPPOLearner.IntrinsicAttentionPPOLearner'>, learner_connector=None, add_default_connectors_to_learner_pipeline=True, is_multi_agent=False, policies_to_update=['default_policy'], lr=0.0060984166342, num_total_minibatches=0, num_epochs=1, minibatch_size=1000, shuffle_batch_per_epoch=True)"], "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9485408017724, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.callbacks.callbacks.RLlibCallback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 11.112492084503174, "iterations_since_restore": 1, "perf": {"cpu_util_percent": 40.55625, "ram_util_percent": 83.36250000000001}}
{"timers": {"training_iteration": 10.975522322930628, "restore_env_runners": 2.2834523115307092e-05, "training_step": 10.975235965600003, "env_runner_sampling_timer": 1.7386212875368074, "learner_update_timer": 9.025523939841658, "synch_weights": 0.001669691305141896, "restore_eval_env_runners": 8.608296047896147e-05, "evaluation_iteration": 0.13631829107180238, "synch_eval_env_connectors": 0.0001942500239238143, "synch_env_connectors": 4.958012141287327e-06}, "env_runners": {"module_to_env_connector": {"timers": {"connectors": {"listify_data_for_vector_env": 1.208452758541352e-05, "normalize_and_clip_actions": 9.122286589205167e-06, "get_actions": 5.058293014859761e-05, "tensor_to_numpy": 1.8146157498253052e-05, "un_batch_to_individual_items": 7.622180842944645e-06, "remove_single_ts_time_rank_from_batch": 1.3474653769981443e-05}}, "connector_pipeline_timer": 0.00014394618628576822}, "time_between_sampling": 0.035309127479887244, "env_to_module_sum_episodes_length_in": 10.36823839457432, "env_to_module_connector": {"timers": {"connectors": {"add_observations_from_episodes_to_batch": 3.231755648108847e-06, "numpy_to_tensor": 1.523548305549464e-05, "batch_individual_items": 1.4427435148686142e-05, "add_states_from_episodes_to_batch": 3.0897870402104407e-06, "add_time_dim_to_batch_and_zero_pad": 8.020246404610797e-06}}, "connector_pipeline_timer": 6.932379791281046e-05}, "num_agent_steps_sampled_lifetime": {"default_agent": 10000.0}, "env_reset_timer": 4.919848800738409e-05, "episode_return_mean": 2.5, "episode_return_min": -9.5, "env_to_module_sum_episodes_length_out": 10.36823839457432, "module_episode_returns_mean": {"default_policy": 2.5}, "agent_episode_returns_mean": {"default_agent": 2.5}, "episode_len_max": 20, "sample": 0.006291044473073278, "rlmodule_inference_timer": 4.060006398918112e-05, "episode_len_mean": 20.0, "num_env_steps_sampled": 5000.0, "weights_seq_no": 1.0, "num_agent_steps_sampled": {"default_agent": 5000.0}, "episode_return_max": 10.5, "num_episodes": 250.0, "num_module_steps_sampled": {"default_policy": 5000.0}, "env_step_timer": 2.045258054482438e-05, "num_module_steps_sampled_lifetime": {"default_policy": 10000.0}, "episode_duration_sec_mean": 0.006469660521484911, "num_episodes_lifetime": 500.0, "num_env_steps_sampled_lifetime": 10000.0, "episode_len_min": 20, "num_env_steps_sampled_lifetime_throughput": 2982.938704516182}, "__all_modules__": {"learner_connector_sum_episodes_length_in": 5000.0, "learner_connector": {"connector_pipeline_timer": 0.17243777938885615, "timers": {"connectors": {"add_one_ts_to_episodes_and_truncate": 0.00904140408267267, "add_observations_from_episodes_to_batch": 0.0008292795461602509, "add_columns_from_episodes_to_train_batch": 0.041685572353890164, "add_time_dim_to_batch_and_zero_pad": 0.10281935272621921, "add_states_from_episodes_to_batch": 0.003434374841162935, "batch_individual_items": 0.014409853086108343, "numpy_to_tensor": 7.22277583554387e-05}}}, "learner_connector_sum_episodes_length_out": 5250.0}, "learners": {"intrinsic_reward_module": {"gradients_default_optimizer_global_norm": 0.0, "num_module_steps_trained": 5994, "total_loss": 0.0, "num_trainable_parameters": 8266, "default_optimizer_learning_rate": 0.0002715581955, "curr_entropy_coeff": 0.0015431216992, "weights_seq_no": 2.0, "diff_num_grad_updates_vs_sampler_policy": 1.0, "num_module_steps_trained_lifetime": 11988, "module_train_batch_size_mean": 999.0, "num_module_steps_trained_lifetime_throughput": 660.5023543933676}, "__all_modules__": {"num_module_steps_trained_lifetime": 23976, "num_module_steps_trained": 11988, "num_non_trainable_parameters": 0, "num_env_steps_trained": 31500, "num_env_steps_trained_lifetime": 63000, "num_trainable_parameters": 24861, "num_env_steps_trained_lifetime_throughput": 3471.166110363403, "num_module_steps_trained_throughput": 27449008.043475997, "num_module_steps_trained_lifetime_throughput": 11470831.169343011}, "differentiable_learners": {"intrinsic_attention_ppo_learner": {"intrinsic_reward_module": {"diff_num_grad_updates_vs_sampler_policy": 11.0, "total_loss": 0.0, "num_module_steps_trained_lifetime": 71928, "num_module_steps_trained": 35964, "module_train_batch_size_mean": 999.0, "weights_seq_no": 12.0}, "default_policy": {"num_module_steps_trained_lifetime": 71928, "num_module_steps_trained": 35964, "module_train_batch_size_mean": 999.0, "vf_loss_unclipped": 38.51559066772461, "mean_kl_loss": 1.076165062841028e-05, "use_intrinsic_rewards": 1.0, "entropy": 0.6827067136764526, "policy_loss": 7.95380401541479e-06, "diff_num_grad_updates_vs_sampler_policy": 11.0, "total_loss": 0.20365343987941742, "vf_explained_var": 0.00321882963180542, "weights_seq_no": 12.0, "vf_loss": 0.26275205612182617}, "__all_modules__": {"num_module_steps_trained_lifetime": 143856, "num_env_steps_trained": 189000, "num_env_steps_trained_lifetime": 378000, "num_module_steps_trained": 71928, "num_env_steps_trained_lifetime_throughput": 46544.44797860226}}}, "default_policy": {"vf_loss_unclipped": 38.56589126586914, "mean_kl_loss": 1.0559287147771101e-05, "curr_kl_coeff": 0.040395982563495636, "curr_entropy_coeff": 0.0015431216992, "use_intrinsic_rewards": 0.0, "entropy": 0.6827134490013123, "policy_loss": 7.21372907719342e-06, "diff_num_grad_updates_vs_sampler_policy": 1.0, "total_loss": 0.20363448560237885, "num_trainable_parameters": 16595, "vf_explained_var": 0.0016401410102844238, "weights_seq_no": 2.0, "vf_loss": 0.26272985339164734, "num_module_steps_trained_lifetime": 11988, "module_train_batch_size_mean": 999.0, "num_module_steps_trained": 5994, "num_module_steps_trained_lifetime_throughput": 660.493456029534}, "IntrinsicAttentionMask": [[[0.33453699946403503, 0.3328125774860382, 0.33265045285224915], [0.3352906405925751, 0.33248624205589294, 0.3322230875492096], [0.3353617489337921, 0.33245545625686646, 0.33218276500701904]], [[0.3330913484096527, 0.3335631787776947, 0.333345502614975], [0.3331144154071808, 0.33354124426841736, 0.33334434032440186], [0.3331037759780884, 0.3335513472557068, 0.33334484696388245]], [[0.3324567377567291, 0.3335157632827759, 0.3340275287628174], [0.33261674642562866, 0.3334825038909912, 0.33390071988105774], [0.3326939344406128, 0.33346647024154663, 0.3338395953178406]], [[0.33337166905403137, 0.33380746841430664, 0.3328208327293396], [0.3333677351474762, 0.3337584435939789, 0.33287379145622253], [0.3333766758441925, 0.3338695168495178, 0.3327538073062897]], [[0.3322601616382599, 0.33355650305747986, 0.33418333530426025], [0.33242014050483704, 0.33352333307266235, 0.3340565264225006], [0.3324972987174988, 0.33350732922554016, 0.33399537205696106]], [[0.33105650544166565, 0.33803102374076843, 0.3309124708175659], [0.3355117738246918, 0.3288356363773346, 0.33565258979797363], [0.33096280694007874, 0.338224321603775, 0.33081287145614624]]]}, "num_training_step_calls_per_iteration": 1, "evaluation": {"env_runners": {"episode_len_max": 20, "rlmodule_inference_timer": 3.155822125785816e-05, "weights_seq_no": 2.0, "module_to_env_connector": {"timers": {"connectors": {"remove_single_ts_time_rank_from_batch": 1.1792520662608065e-05, "listify_data_for_vector_env": 1.0477879451065926e-05, "normalize_and_clip_actions": 7.842787808498886e-06, "get_actions": 3.750779577303509e-05, "tensor_to_numpy": 1.530827020793661e-05, "un_batch_to_individual_items": 6.449235059663316e-06}}, "connector_pipeline_timer": 0.0001154372040426768}, "episode_return_max": 13.5, "num_episodes": 20, "num_episodes_lifetime": 40, "num_agent_steps_sampled_lifetime": {"default_agent": 800}, "env_reset_timer": 0.000549378377618268, "env_to_module_sum_episodes_length_out": 10.366003441359926, "num_module_steps_sampled_lifetime": {"default_policy": 800}, "env_to_module_connector": {"timers": {"connectors": {"numpy_to_tensor": 1.2006137746449336e-05, "batch_individual_items": 1.2471087450051637e-05, "add_observations_from_episodes_to_batch": 2.868765325691763e-06, "add_states_from_episodes_to_batch": 2.933262376471199e-06, "add_time_dim_to_batch_and_zero_pad": 7.298258943559232e-06}}, "connector_pipeline_timer": 5.994791177270318e-05}, "episode_return_mean": 1.15, "sample": 0.12399951374856755, "episode_len_mean": 20.0, "env_step_timer": 1.3848797685942689e-05, "episode_duration_sec_mean": 0.005472588451812044, "num_env_steps_sampled_lifetime": 10400, "agent_episode_returns_mean": {"default_agent": 1.15}, "num_env_steps_sampled": 400, "num_agent_steps_sampled": {"default_agent": 400}, "num_module_steps_sampled": {"default_policy": 400}, "episode_len_min": 20, "env_to_module_sum_episodes_length_in": 10.366003441359926, "module_episode_returns_mean": {"default_policy": 1.15}, "episode_return_min": -13.5, "time_between_sampling": 11.202556750038639}, "num_healthy_workers": 1, "actor_manager_num_outstanding_async_reqs": 0, "num_remote_worker_restarts": 0}, "num_env_steps_sampled_lifetime": 10000.0, "fault_tolerance": {"num_healthy_workers": 0, "num_remote_worker_restarts": 0}, "env_runner_group": {"actor_manager_num_outstanding_async_reqs": 0}, "done": false, "training_iteration": 2, "trial_id": "ba99d_00000", "date": "2025-08-11_17-56-52", "timestamp": 1754927812, "time_this_iter_s": 11.299048900604248, "time_total_s": 22.411540985107422, "pid": 9655, "hostname": "Mac", "node_ip": "127.0.0.1", "config": {"exploration_config": {}, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 2, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "env": "Umbrella", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": false, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 0, "create_local_env_runner": true, "num_envs_per_env_runner": 1, "gym_env_vectorize_mode": "SYNC", "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "episodes_to_numpy": true, "max_requests_in_flight_per_env_runner": 1, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "merge_env_runner_states": "training_only", "broadcast_env_runner_states": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "complete_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "sampler_perf_stats_ema_coef": null, "_is_online": true, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": "auto", "num_aggregator_actors_per_learner": 0, "max_requests_in_flight_per_aggregator_actor": 3, "local_gpu_idx": 0, "max_requests_in_flight_per_learner": 3, "gamma": 1, "lr": 0.0002715581955, "grad_clip": 0.5, "grad_clip_by": "global_norm", "_train_batch_size_per_learner": 5000, "train_batch_size": 4000, "num_epochs": 1, "minibatch_size": 1000, "shuffle_batch_per_epoch": true, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "log_std_clip_param": 20.0, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "_disable_preprocessor_api": false, "_disable_action_flattening": false}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {"intrinsic_reward_coeff": 0.2795015916508}, "optimizer": {}, "_learner_class": "<class 'source.intrinsic_attention_ppo.learners.IntrinsicAttentionMetaLearner.IntrinsicAttentionMetaLearner'>", "callbacks_on_algorithm_init": null, "callbacks_on_env_runners_recreated": null, "callbacks_on_offline_eval_runners_recreated": null, "callbacks_on_checkpoint_loaded": null, "callbacks_on_environment_created": null, "callbacks_on_episode_created": null, "callbacks_on_episode_start": null, "callbacks_on_episode_step": null, "callbacks_on_episode_end": null, "callbacks_on_evaluate_start": null, "callbacks_on_evaluate_end": null, "callbacks_on_evaluate_offline_start": null, "callbacks_on_evaluate_offline_end": null, "callbacks_on_sample_end": null, "callbacks_on_train_result": null, "explore": true, "enable_rl_module_and_learner": true, "enable_env_runner_and_connector_v2": true, "_prior_exploration_config": {"type": "StochasticSampling"}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x15d6f98a0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "offline_data_class": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_read_batch_size": null, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "materialize_data": false, "materialize_mapped_data": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "ignore_final_observation": false, "prelearner_class": null, "prelearner_buffer_class": null, "prelearner_buffer_kwargs": {}, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_remaining_data": false, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": 1, "evaluation_duration": 20, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_auto_duration_min_env_steps_per_sample": 100, "evaluation_auto_duration_max_env_steps_per_sample": 2000, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 1, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "offline_evaluation_interval": null, "num_offline_eval_runners": 0, "offline_loss_for_module_fn": null, "offline_evaluation_duration": 1, "offline_evaluation_parallel_to_training": false, "offline_evaluation_timeout_s": 120.0, "num_cpus_per_offline_eval_runner": 1, "num_gpus_per_offline_eval_runner": 0, "custom_resources_per_offline_eval_runner": {}, "restart_failed_offline_eval_runners": true, "ignore_offline_eval_runner_failures": false, "max_num_offline_eval_runner_restarts": 1000, "offline_eval_runner_restore_timeout_s": 1800.0, "max_requests_in_flight_per_offline_eval_runner": 1, "validate_offline_eval_runners_after_construction": true, "offline_eval_runner_health_probe_timeout_s": 30.0, "offline_eval_rl_module_inference_only": false, "broadcast_offline_eval_runner_states": false, "offline_eval_batch_size_per_runner": 256, "dataset_num_iters_per_eval_runner": 1, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "log_gradients": false, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 6, "restart_failed_env_runners": true, "ignore_env_runner_failures": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30.0, "env_runner_restore_timeout_s": 1800.0, "_model_config": {}, "_rl_module_spec": "MultiRLModuleSpec(multi_rl_module_class=<class 'ray.rllib.core.rl_module.multi_rl_module.MultiRLModule'>, observation_space=None, action_space=None, inference_only=False, model_config=None, rl_module_specs={'default_policy': RLModuleSpec(module_class=<class 'source.intrinsic_attention_ppo.rl_modules.DifferentiablePPOModule.DifferentiablePPOModule'>, observation_space=None, action_space=None, inference_only=False, learner_only=False, model_config={'vf_share_layers': True, 'embedding_dim': 62, 'max_seq_len': 3, 'policy_head_hidden_sizes': [32], 'value_head_hidden_sizes': [101], 'embedding_hidden_sizes': [121]}, catalog_class=None, load_state_path=None, model_config_dict=None), 'intrinsic_reward_module': RLModuleSpec(module_class=<class 'source.intrinsic_attention_ppo.rl_modules.IntrinsicAttentionModule.IntrinsicAttentionModule'>, observation_space=None, action_space=None, inference_only=False, learner_only=True, model_config={'intrinsic_reward_network': {'encoder_hidden_sizes': [], 'encoding_dim': 1, 'num_heads': 1, 'head_hidden_sizes': None, 'layers': [{'type': 'attention'}]}, 'extrinsic_value_hidden_layers': [127, 60], 'vf_share_layers': True, 'max_seq_len': 3}, catalog_class=None, load_state_path=None, model_config_dict=None)}, load_state_path=None, modules_to_load=None, module_specs={'default_policy': RLModuleSpec(module_class=<class 'source.intrinsic_attention_ppo.rl_modules.DifferentiablePPOModule.DifferentiablePPOModule'>, observation_space=None, action_space=None, inference_only=False, learner_only=False, model_config={'vf_share_layers': True, 'embedding_dim': 62, 'max_seq_len': 3, 'policy_head_hidden_sizes': [32], 'value_head_hidden_sizes': [101], 'embedding_hidden_sizes': [121]}, catalog_class=None, load_state_path=None, model_config_dict=None), 'intrinsic_reward_module': RLModuleSpec(module_class=<class 'source.intrinsic_attention_ppo.rl_modules.IntrinsicAttentionModule.IntrinsicAttentionModule'>, observation_space=None, action_space=None, inference_only=False, learner_only=True, model_config={'intrinsic_reward_network': {'encoder_hidden_sizes': [], 'encoding_dim': 1, 'num_heads': 1, 'head_hidden_sizes': None, 'layers': [{'type': 'attention'}]}, 'extrinsic_value_hidden_layers': [127, 60], 'vf_share_layers': True, 'max_seq_len': 3}, catalog_class=None, load_state_path=None, model_config_dict=None)})", "algorithm_config_overrides_per_module": {"intrinsic_reward_module": {"lr": 0.0002715581955}}, "_per_module_overrides": {}, "_validate_config": true, "_use_msgpack_checkpoints": false, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "env_task_fn": -1, "enable_connectors": -1, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.161583927863, "kl_target": 0.0201019014258, "vf_loss_coeff": 0.7790510010087, "entropy_coeff": 0.0015431216992, "clip_param": 0.2459212356676, "vf_clip_param": 0.3769744131561, "entropy_coeff_schedule": null, "lr_schedule": null, "sgd_minibatch_size": -1, "vf_share_layers": -1, "differentiable_learner_configs": ["DifferentiableLearnerConfig(learner_class=<class 'source.intrinsic_attention_ppo.learners.IntrinsicAttentionPPOLearner.IntrinsicAttentionPPOLearner'>, learner_connector=None, add_default_connectors_to_learner_pipeline=True, is_multi_agent=False, policies_to_update=['default_policy'], lr=0.0060984166342, num_total_minibatches=0, num_epochs=1, minibatch_size=1000, shuffle_batch_per_epoch=True)"], "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9485408017724, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.callbacks.callbacks.RLlibCallback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 22.411540985107422, "iterations_since_restore": 2, "perf": {"cpu_util_percent": 41.98125, "ram_util_percent": 82.6625}}
{"timers": {"training_iteration": 10.987349160541767, "restore_env_runners": 2.267826807219535e-05, "training_step": 10.987063127613776, "env_runner_sampling_timer": 1.7423983267412988, "learner_update_timer": 9.033427986273576, "synch_weights": 0.001669426063192077, "restore_eval_env_runners": 8.543254109099508e-05, "evaluation_iteration": 0.13620398149127141, "synch_eval_env_connectors": 0.0001936021144501865, "synch_env_connectors": 4.958851495757699e-06}, "env_runners": {"module_to_env_connector": {"timers": {"connectors": {"listify_data_for_vector_env": 1.3661305463332112e-05, "normalize_and_clip_actions": 1.0025230999166904e-05, "get_actions": 5.920449458074441e-05, "tensor_to_numpy": 2.040706645838286e-05, "un_batch_to_individual_items": 8.456455710675513e-06, "remove_single_ts_time_rank_from_batch": 1.4293636070805275e-05}}, "connector_pipeline_timer": 0.0001601033583180065}, "time_between_sampling": 0.038208468265772046, "env_to_module_sum_episodes_length_in": 10.36823839457432, "env_to_module_connector": {"timers": {"connectors": {"add_observations_from_episodes_to_batch": 3.783102765810223e-06, "numpy_to_tensor": 1.730704370537285e-05, "batch_individual_items": 1.5769225072598563e-05, "add_states_from_episodes_to_batch": 3.3322348474693743e-06, "add_time_dim_to_batch_and_zero_pad": 9.41080024433537e-06}}, "connector_pipeline_timer": 7.686123948269147e-05}, "num_agent_steps_sampled_lifetime": {"default_agent": -607500.0}, "env_reset_timer": 6.201468677173023e-05, "episode_return_mean": 2.0200000000000005, "episode_return_min": -9.5, "env_to_module_sum_episodes_length_out": 10.36823839457432, "module_episode_returns_mean": {"default_policy": 2.0200000000000005}, "agent_episode_returns_mean": {"default_agent": 2.0200000000000005}, "episode_len_max": 20, "sample": 0.008213168226624898, "rlmodule_inference_timer": 5.4190958174214655e-05, "episode_len_mean": 20.0, "num_env_steps_sampled": 5000.0, "weights_seq_no": 2.0, "num_agent_steps_sampled": {"default_agent": 5000.0}, "episode_return_max": 10.5, "num_episodes": 250.0, "num_module_steps_sampled": {"default_policy": 5000.0}, "env_step_timer": 1.9177556781203824e-05, "num_module_steps_sampled_lifetime": {"default_policy": -607500.0}, "episode_duration_sec_mean": 0.007298524149693549, "num_episodes_lifetime": -30375.0, "num_env_steps_sampled_lifetime": -607500.0, "episode_len_min": 20, "num_env_steps_sampled_lifetime_throughput": 2727.4131205993485}, "__all_modules__": {"learner_connector_sum_episodes_length_in": 5000.0, "learner_connector": {"connector_pipeline_timer": 0.17244512117451524, "timers": {"connectors": {"add_one_ts_to_episodes_and_truncate": 0.009044045041443315, "add_observations_from_episodes_to_batch": 0.0008293971709674223, "add_columns_from_episodes_to_train_batch": 0.04169209955033147, "add_time_dim_to_batch_and_zero_pad": 0.10282910086830378, "add_states_from_episodes_to_batch": 0.0034373219226836223, "batch_individual_items": 0.01439549955482362, "numpy_to_tensor": 7.225381126627325e-05}}}, "learner_connector_sum_episodes_length_out": 5250.0}, "learners": {"intrinsic_reward_module": {"gradients_default_optimizer_global_norm": 0.0, "num_module_steps_trained": 5994, "total_loss": 0.0, "num_trainable_parameters": 8266, "default_optimizer_learning_rate": 0.0002715581955, "curr_entropy_coeff": 0.0015431216992, "weights_seq_no": 3.0, "diff_num_grad_updates_vs_sampler_policy": 1.0, "num_module_steps_trained_lifetime": 17982, "module_train_batch_size_mean": 999.0, "num_module_steps_trained_lifetime_throughput": 658.8513384282297}, "__all_modules__": {"num_module_steps_trained_lifetime": 35964, "num_module_steps_trained": 11988, "num_non_trainable_parameters": 0, "num_env_steps_trained": 31500, "num_env_steps_trained_lifetime": 94500, "num_trainable_parameters": 24861, "num_env_steps_trained_lifetime_throughput": 3462.4884092066054, "num_module_steps_trained_throughput": 26876278.68639452, "num_module_steps_trained_lifetime_throughput": 11465716.745845815}, "differentiable_learners": {"intrinsic_attention_ppo_learner": {"intrinsic_reward_module": {"diff_num_grad_updates_vs_sampler_policy": 16.0, "total_loss": 0.0, "num_module_steps_trained_lifetime": 107892, "num_module_steps_trained": 35964, "module_train_batch_size_mean": 999.0, "weights_seq_no": 18.0}, "default_policy": {"num_module_steps_trained_lifetime": 107892, "num_module_steps_trained": 35964, "module_train_batch_size_mean": 999.0, "vf_loss_unclipped": 39.53850555419922, "mean_kl_loss": 2.788124402286485e-05, "use_intrinsic_rewards": 1.0, "entropy": 0.6818914413452148, "policy_loss": -0.0005316157476045191, "diff_num_grad_updates_vs_sampler_policy": 16.0, "total_loss": 0.2030087113380432, "vf_explained_var": 0.002979755401611328, "weights_seq_no": 18.0, "vf_loss": 0.26261186599731445}, "__all_modules__": {"num_module_steps_trained_lifetime": 215784, "num_env_steps_trained": 189000, "num_env_steps_trained_lifetime": 567000, "num_module_steps_trained": 71928, "num_env_steps_trained_lifetime_throughput": 46105.31676266549}}}, "default_policy": {"vf_loss_unclipped": 39.589576721191406, "mean_kl_loss": 3.0427834644797258e-05, "curr_kl_coeff": 0.020197991281747818, "curr_entropy_coeff": 0.0015431216992, "use_intrinsic_rewards": 0.0, "entropy": 0.6818417906761169, "policy_loss": -0.0005545691237784922, "diff_num_grad_updates_vs_sampler_policy": 1.0, "total_loss": 0.2028658241033554, "num_trainable_parameters": 16595, "vf_explained_var": -0.0014516115188598633, "weights_seq_no": 3.0, "vf_loss": 0.2624620795249939, "num_module_steps_trained_lifetime": 17982, "module_train_batch_size_mean": 999.0, "num_module_steps_trained": 5994, "num_module_steps_trained_lifetime_throughput": 658.842676864977}, "IntrinsicAttentionMask": [[[0.33423879742622375, 0.3325158953666687, 0.33324530720710754], [0.3348053991794586, 0.3320050537586212, 0.3331895172595978], [0.33456510305404663, 0.3322216272354126, 0.3332132399082184]], [[0.3326926529407501, 0.33316388726234436, 0.3341434597969055], [0.3327537477016449, 0.33318009972572327, 0.33406615257263184], [0.33288052678108215, 0.3332136869430542, 0.33390581607818604]], [[0.33298754692077637, 0.3338111340999603, 0.3332012891769409], [0.33306884765625, 0.33369874954223633, 0.3332323729991913], [0.33300867676734924, 0.3337819576263428, 0.33320939540863037]], [[0.33300402760505676, 0.33343929052352905, 0.3335566818714142], [0.3330380320549011, 0.33342835307121277, 0.3335335850715637], [0.33304721117019653, 0.3334254324436188, 0.3335273861885071]], [[0.332118421792984, 0.33430588245391846, 0.33357569575309753], [0.3326491117477417, 0.33388081192970276, 0.33347004652023315], [0.3324722945690155, 0.3340223729610443, 0.3335052728652954]], [[0.33440887928009033, 0.33157140016555786, 0.3340197503566742], [0.3420409560203552, 0.3191414177417755, 0.33881762623786926], [0.3354557454586029, 0.32985877990722656, 0.33468541502952576]]]}, "num_training_step_calls_per_iteration": 1, "evaluation": {"env_runners": {"episode_len_max": 20, "rlmodule_inference_timer": 3.216843718908549e-05, "weights_seq_no": 3.0, "module_to_env_connector": {"timers": {"connectors": {"remove_single_ts_time_rank_from_batch": 1.1787773597634139e-05, "listify_data_for_vector_env": 1.0435067232202914e-05, "normalize_and_clip_actions": 7.833217094206613e-06, "get_actions": 3.723437103318983e-05, "tensor_to_numpy": 1.5449327897524525e-05, "un_batch_to_individual_items": 6.525045911140037e-06}}, "connector_pipeline_timer": 0.00011520148781724798}, "episode_return_max": 14.5, "num_episodes": 20, "num_episodes_lifetime": 60, "num_agent_steps_sampled_lifetime": {"default_agent": 1200}, "env_reset_timer": 0.0005471616746741346, "env_to_module_sum_episodes_length_out": 10.368205581254823, "num_module_steps_sampled_lifetime": {"default_policy": 1200}, "env_to_module_connector": {"timers": {"connectors": {"numpy_to_tensor": 1.1996535638540045e-05, "batch_individual_items": 1.2377604008552064e-05, "add_observations_from_episodes_to_batch": 2.833108070078067e-06, "add_states_from_episodes_to_batch": 2.9625940227584184e-06, "add_time_dim_to_batch_and_zero_pad": 7.177040315994811e-06}}, "connector_pipeline_timer": 5.9441852183233894e-05}, "episode_return_mean": 0.9833333333333333, "sample": 0.12392384986097457, "episode_len_mean": 20.0, "env_step_timer": 1.377142643549045e-05, "episode_duration_sec_mean": 0.005413730506552384, "num_env_steps_sampled_lifetime": 15400, "agent_episode_returns_mean": {"default_agent": 0.9833333333333333}, "num_env_steps_sampled": 400, "num_agent_steps_sampled": {"default_agent": 400}, "num_module_steps_sampled": {"default_policy": 400}, "episode_len_min": 20, "env_to_module_sum_episodes_length_in": 10.368205581254823, "module_episode_returns_mean": {"default_policy": 0.9833333333333333}, "episode_return_min": -13.5, "time_between_sampling": 11.212414008377818}, "num_healthy_workers": 1, "actor_manager_num_outstanding_async_reqs": 0, "num_remote_worker_restarts": 0}, "num_env_steps_sampled_lifetime": -607500.0, "fault_tolerance": {"num_healthy_workers": 0, "num_remote_worker_restarts": 0}, "env_runner_group": {"actor_manager_num_outstanding_async_reqs": 0}, "done": false, "training_iteration": 3, "trial_id": "ba99d_00000", "date": "2025-08-11_17-57-04", "timestamp": 1754927824, "time_this_iter_s": 12.286176919937134, "time_total_s": 34.697717905044556, "pid": 9655, "hostname": "Mac", "node_ip": "127.0.0.1", "config": {"exploration_config": {}, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 2, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "env": "Umbrella", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": false, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 0, "create_local_env_runner": true, "num_envs_per_env_runner": 1, "gym_env_vectorize_mode": "SYNC", "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "episodes_to_numpy": true, "max_requests_in_flight_per_env_runner": 1, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "merge_env_runner_states": "training_only", "broadcast_env_runner_states": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "complete_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "sampler_perf_stats_ema_coef": null, "_is_online": true, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": "auto", "num_aggregator_actors_per_learner": 0, "max_requests_in_flight_per_aggregator_actor": 3, "local_gpu_idx": 0, "max_requests_in_flight_per_learner": 3, "gamma": 1, "lr": 0.0002715581955, "grad_clip": 0.5, "grad_clip_by": "global_norm", "_train_batch_size_per_learner": 5000, "train_batch_size": 4000, "num_epochs": 1, "minibatch_size": 1000, "shuffle_batch_per_epoch": true, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "log_std_clip_param": 20.0, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "_disable_preprocessor_api": false, "_disable_action_flattening": false}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {"intrinsic_reward_coeff": 0.2795015916508}, "optimizer": {}, "_learner_class": "<class 'source.intrinsic_attention_ppo.learners.IntrinsicAttentionMetaLearner.IntrinsicAttentionMetaLearner'>", "callbacks_on_algorithm_init": null, "callbacks_on_env_runners_recreated": null, "callbacks_on_offline_eval_runners_recreated": null, "callbacks_on_checkpoint_loaded": null, "callbacks_on_environment_created": null, "callbacks_on_episode_created": null, "callbacks_on_episode_start": null, "callbacks_on_episode_step": null, "callbacks_on_episode_end": null, "callbacks_on_evaluate_start": null, "callbacks_on_evaluate_end": null, "callbacks_on_evaluate_offline_start": null, "callbacks_on_evaluate_offline_end": null, "callbacks_on_sample_end": null, "callbacks_on_train_result": null, "explore": true, "enable_rl_module_and_learner": true, "enable_env_runner_and_connector_v2": true, "_prior_exploration_config": {"type": "StochasticSampling"}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x15d6f98a0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "offline_data_class": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_read_batch_size": null, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "materialize_data": false, "materialize_mapped_data": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "ignore_final_observation": false, "prelearner_class": null, "prelearner_buffer_class": null, "prelearner_buffer_kwargs": {}, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_remaining_data": false, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": 1, "evaluation_duration": 20, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_auto_duration_min_env_steps_per_sample": 100, "evaluation_auto_duration_max_env_steps_per_sample": 2000, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 1, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "offline_evaluation_interval": null, "num_offline_eval_runners": 0, "offline_loss_for_module_fn": null, "offline_evaluation_duration": 1, "offline_evaluation_parallel_to_training": false, "offline_evaluation_timeout_s": 120.0, "num_cpus_per_offline_eval_runner": 1, "num_gpus_per_offline_eval_runner": 0, "custom_resources_per_offline_eval_runner": {}, "restart_failed_offline_eval_runners": true, "ignore_offline_eval_runner_failures": false, "max_num_offline_eval_runner_restarts": 1000, "offline_eval_runner_restore_timeout_s": 1800.0, "max_requests_in_flight_per_offline_eval_runner": 1, "validate_offline_eval_runners_after_construction": true, "offline_eval_runner_health_probe_timeout_s": 30.0, "offline_eval_rl_module_inference_only": false, "broadcast_offline_eval_runner_states": false, "offline_eval_batch_size_per_runner": 256, "dataset_num_iters_per_eval_runner": 1, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "log_gradients": false, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 6, "restart_failed_env_runners": true, "ignore_env_runner_failures": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30.0, "env_runner_restore_timeout_s": 1800.0, "_model_config": {}, "_rl_module_spec": "MultiRLModuleSpec(multi_rl_module_class=<class 'ray.rllib.core.rl_module.multi_rl_module.MultiRLModule'>, observation_space=None, action_space=None, inference_only=False, model_config=None, rl_module_specs={'default_policy': RLModuleSpec(module_class=<class 'source.intrinsic_attention_ppo.rl_modules.DifferentiablePPOModule.DifferentiablePPOModule'>, observation_space=None, action_space=None, inference_only=False, learner_only=False, model_config={'vf_share_layers': True, 'embedding_dim': 62, 'max_seq_len': 3, 'policy_head_hidden_sizes': [32], 'value_head_hidden_sizes': [101], 'embedding_hidden_sizes': [121]}, catalog_class=None, load_state_path=None, model_config_dict=None), 'intrinsic_reward_module': RLModuleSpec(module_class=<class 'source.intrinsic_attention_ppo.rl_modules.IntrinsicAttentionModule.IntrinsicAttentionModule'>, observation_space=None, action_space=None, inference_only=False, learner_only=True, model_config={'intrinsic_reward_network': {'encoder_hidden_sizes': [], 'encoding_dim': 1, 'num_heads': 1, 'head_hidden_sizes': None, 'layers': [{'type': 'attention'}]}, 'extrinsic_value_hidden_layers': [127, 60], 'vf_share_layers': True, 'max_seq_len': 3}, catalog_class=None, load_state_path=None, model_config_dict=None)}, load_state_path=None, modules_to_load=None, module_specs={'default_policy': RLModuleSpec(module_class=<class 'source.intrinsic_attention_ppo.rl_modules.DifferentiablePPOModule.DifferentiablePPOModule'>, observation_space=None, action_space=None, inference_only=False, learner_only=False, model_config={'vf_share_layers': True, 'embedding_dim': 62, 'max_seq_len': 3, 'policy_head_hidden_sizes': [32], 'value_head_hidden_sizes': [101], 'embedding_hidden_sizes': [121]}, catalog_class=None, load_state_path=None, model_config_dict=None), 'intrinsic_reward_module': RLModuleSpec(module_class=<class 'source.intrinsic_attention_ppo.rl_modules.IntrinsicAttentionModule.IntrinsicAttentionModule'>, observation_space=None, action_space=None, inference_only=False, learner_only=True, model_config={'intrinsic_reward_network': {'encoder_hidden_sizes': [], 'encoding_dim': 1, 'num_heads': 1, 'head_hidden_sizes': None, 'layers': [{'type': 'attention'}]}, 'extrinsic_value_hidden_layers': [127, 60], 'vf_share_layers': True, 'max_seq_len': 3}, catalog_class=None, load_state_path=None, model_config_dict=None)})", "algorithm_config_overrides_per_module": {"intrinsic_reward_module": {"lr": 0.0002715581955}}, "_per_module_overrides": {}, "_validate_config": true, "_use_msgpack_checkpoints": false, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "env_task_fn": -1, "enable_connectors": -1, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.161583927863, "kl_target": 0.0201019014258, "vf_loss_coeff": 0.7790510010087, "entropy_coeff": 0.0015431216992, "clip_param": 0.2459212356676, "vf_clip_param": 0.3769744131561, "entropy_coeff_schedule": null, "lr_schedule": null, "sgd_minibatch_size": -1, "vf_share_layers": -1, "differentiable_learner_configs": ["DifferentiableLearnerConfig(learner_class=<class 'source.intrinsic_attention_ppo.learners.IntrinsicAttentionPPOLearner.IntrinsicAttentionPPOLearner'>, learner_connector=None, add_default_connectors_to_learner_pipeline=True, is_multi_agent=False, policies_to_update=['default_policy'], lr=0.0060984166342, num_total_minibatches=0, num_epochs=1, minibatch_size=1000, shuffle_batch_per_epoch=True)"], "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9485408017724, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.callbacks.callbacks.RLlibCallback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 34.697717905044556, "iterations_since_restore": 3, "perf": {"cpu_util_percent": 48.96111111111111, "ram_util_percent": 82.86666666666666}}
{"timers": {"training_iteration": 10.990901748106662, "restore_env_runners": 2.2522736225044354e-05, "training_step": 10.990615511337937, "env_runner_sampling_timer": 1.7407216326332209, "learner_update_timer": 9.038505270991704, "synch_weights": 0.0016708922225644345, "restore_eval_env_runners": 8.516238543670624e-05, "evaluation_iteration": 0.13609301458557604, "synch_eval_env_connectors": 0.00019350776390638204, "synch_env_connectors": 4.95217366842553e-06}, "env_runners": {"module_to_env_connector": {"timers": {"connectors": {"listify_data_for_vector_env": 1.0677600009491136e-05, "normalize_and_clip_actions": 8.101639020841399e-06, "get_actions": 4.0539933837766934e-05, "tensor_to_numpy": 1.558861262455634e-05, "un_batch_to_individual_items": 6.712433443558567e-06, "remove_single_ts_time_rank_from_batch": 1.1959143850363945e-05}}, "connector_pipeline_timer": 0.00012095451047585322}, "time_between_sampling": 0.0410336798758802, "env_to_module_sum_episodes_length_in": 10.36823839457432, "env_to_module_connector": {"timers": {"connectors": {"add_observations_from_episodes_to_batch": 2.828975434148861e-06, "numpy_to_tensor": 1.2690480665626732e-05, "batch_individual_items": 1.2552268355490657e-05, "add_states_from_episodes_to_batch": 2.7746158974367866e-06, "add_time_dim_to_batch_and_zero_pad": 7.0530499310821665e-06}}, "connector_pipeline_timer": 6.0718747329130956e-05}, "num_agent_steps_sampled_lifetime": {"default_agent": -1225000.0}, "env_reset_timer": 4.606952270978558e-05, "episode_return_mean": 2.8199999999999994, "episode_return_min": -9.5, "env_to_module_sum_episodes_length_out": 10.36823839457432, "module_episode_returns_mean": {"default_policy": 2.8199999999999994}, "agent_episode_returns_mean": {"default_agent": 2.8199999999999994}, "episode_len_max": 20, "sample": 0.006058224891374076, "rlmodule_inference_timer": 3.276631268614682e-05, "episode_len_mean": 20.0, "num_env_steps_sampled": 5000.0, "weights_seq_no": 3.0, "num_agent_steps_sampled": {"default_agent": 5000.0}, "episode_return_max": 10.5, "num_episodes": 250.0, "num_module_steps_sampled": {"default_policy": 5000.0}, "env_step_timer": 1.4099060062131402e-05, "num_module_steps_sampled_lifetime": {"default_policy": -1225000.0}, "episode_duration_sec_mean": 0.005395802324637771, "num_episodes_lifetime": -61250.0, "num_env_steps_sampled_lifetime": -1225000.0, "episode_len_min": 20, "num_env_steps_sampled_lifetime_throughput": 3169.3446279688933}, "__all_modules__": {"learner_connector_sum_episodes_length_in": 5000.0, "learner_connector": {"connector_pipeline_timer": 0.1724576453832693, "timers": {"connectors": {"add_one_ts_to_episodes_and_truncate": 0.009042092920230817, "add_observations_from_episodes_to_batch": 0.0008302031998645979, "add_columns_from_episodes_to_train_batch": 0.04169458021515689, "add_time_dim_to_batch_and_zero_pad": 0.1028351290287416, "add_states_from_episodes_to_batch": 0.003442492862537619, "batch_individual_items": 0.014395734559412699, "numpy_to_tensor": 7.226168383751064e-05}}}, "learner_connector_sum_episodes_length_out": 5250.0}, "learners": {"intrinsic_reward_module": {"gradients_default_optimizer_global_norm": 0.0, "num_module_steps_trained": 5994, "total_loss": 0.0, "num_trainable_parameters": 8266, "default_optimizer_learning_rate": 0.0002715581955, "curr_entropy_coeff": 0.0015431216992, "weights_seq_no": 4.0, "diff_num_grad_updates_vs_sampler_policy": 1.0, "num_module_steps_trained_lifetime": 23976, "module_train_batch_size_mean": 999.0, "num_module_steps_trained_lifetime_throughput": 656.557781198712}, "__all_modules__": {"num_module_steps_trained_lifetime": 47952, "num_module_steps_trained": 11988, "num_non_trainable_parameters": 0, "num_env_steps_trained": 31500, "num_env_steps_trained_lifetime": 126000, "num_trainable_parameters": 24861, "num_env_steps_trained_lifetime_throughput": 3450.4336658497614, "num_module_steps_trained_throughput": 26241828.65252898, "num_module_steps_trained_lifetime_throughput": 11483836.672250096}, "differentiable_learners": {"intrinsic_attention_ppo_learner": {"intrinsic_reward_module": {"diff_num_grad_updates_vs_sampler_policy": 21.0, "total_loss": 0.0, "num_module_steps_trained_lifetime": 143856, "num_module_steps_trained": 35964, "module_train_batch_size_mean": 999.0, "weights_seq_no": 24.0}, "default_policy": {"num_module_steps_trained_lifetime": 143856, "num_module_steps_trained": 35964, "module_train_batch_size_mean": 999.0, "vf_loss_unclipped": 39.27104568481445, "mean_kl_loss": 2.8502458008006215e-05, "use_intrinsic_rewards": 1.0, "entropy": 0.6805822849273682, "policy_loss": -0.00024423489230684936, "diff_num_grad_updates_vs_sampler_policy": 21.0, "total_loss": 0.20330391824245453, "vf_explained_var": 0.0029793977737426758, "weights_seq_no": 24.0, "vf_loss": 0.2626191973686218}, "__all_modules__": {"num_module_steps_trained_lifetime": 287712, "num_env_steps_trained": 189000, "num_env_steps_trained_lifetime": 756000, "num_module_steps_trained": 71928, "num_env_steps_trained_lifetime_throughput": 45534.14656090596}}}, "default_policy": {"vf_loss_unclipped": 39.34904861450195, "mean_kl_loss": 2.9570161132141948e-05, "curr_kl_coeff": 0.010098995640873909, "curr_entropy_coeff": 0.0015431216992, "use_intrinsic_rewards": 0.0, "entropy": 0.6805604696273804, "policy_loss": -0.00024753864272497594, "diff_num_grad_updates_vs_sampler_policy": 1.0, "total_loss": 0.2031889110803604, "num_trainable_parameters": 16595, "vf_explained_var": -0.002236008644104004, "weights_seq_no": 4.0, "vf_loss": 0.2624809145927429, "num_module_steps_trained_lifetime": 23976, "module_train_batch_size_mean": 999.0, "num_module_steps_trained": 5994, "num_module_steps_trained_lifetime_throughput": 656.5494172220518}, "IntrinsicAttentionMask": [[[0.3327001929283142, 0.33316588401794434, 0.33413389325141907], [0.33276131749153137, 0.33318209648132324, 0.3340565860271454], [0.33288806676864624, 0.3332156836986542, 0.3338962495326996]], [[0.3330913484096527, 0.3335631787776947, 0.333345502614975], [0.3331144154071808, 0.33354124426841736, 0.33334434032440186], [0.3331037759780884, 0.3335513472557068, 0.33334484696388245]], [[0.3328559696674347, 0.3339930772781372, 0.3331510126590729], [0.3329372704029083, 0.33388063311576843, 0.33318206667900085], [0.3328770697116852, 0.3339638411998749, 0.33315905928611755]], [[0.3333715498447418, 0.3327035903930664, 0.3339248299598694], [0.33337754011154175, 0.33260369300842285, 0.334018737077713], [0.3333665728569031, 0.3327862024307251, 0.33384719491004944]], [[0.3322601318359375, 0.33355650305747986, 0.33418330550193787], [0.33242014050483704, 0.33352333307266235, 0.3340565264225006], [0.3324972987174988, 0.33350732922554016, 0.33399537205696106]], [[0.33440887928009033, 0.33157140016555786, 0.3340197503566742], [0.3420409560203552, 0.3191413879394531, 0.33881762623786926], [0.3354557752609253, 0.32985877990722656, 0.33468544483184814]]]}, "num_training_step_calls_per_iteration": 1, "evaluation": {"env_runners": {"episode_len_max": 20, "rlmodule_inference_timer": 3.432395971749641e-05, "weights_seq_no": 4.0, "module_to_env_connector": {"timers": {"connectors": {"remove_single_ts_time_rank_from_batch": 1.2511560315189889e-05, "listify_data_for_vector_env": 1.122594222467459e-05, "normalize_and_clip_actions": 8.899988406177872e-06, "get_actions": 4.145134844851126e-05, "tensor_to_numpy": 1.627743933811343e-05, "un_batch_to_individual_items": 6.8968796701926756e-06}}, "connector_pipeline_timer": 0.00012474192983890823}, "episode_return_max": 14.5, "num_episodes": 20, "num_episodes_lifetime": 80, "num_agent_steps_sampled_lifetime": {"default_agent": 1600}, "env_reset_timer": 0.0005454246474817627, "env_to_module_sum_episodes_length_out": 10.368237912813044, "num_module_steps_sampled_lifetime": {"default_policy": 1600}, "env_to_module_connector": {"timers": {"connectors": {"numpy_to_tensor": 1.3286161328435997e-05, "batch_individual_items": 1.317856375058355e-05, "add_observations_from_episodes_to_batch": 2.9988292142180808e-06, "add_states_from_episodes_to_batch": 4.093330004758271e-06, "add_time_dim_to_batch_and_zero_pad": 7.572114552037573e-06}}, "connector_pipeline_timer": 6.409223878328374e-05}, "episode_return_mean": 0.65, "sample": 0.12401485178243066, "episode_len_mean": 20.0, "env_step_timer": 1.5913601438321734e-05, "episode_duration_sec_mean": 0.005572869753814302, "num_env_steps_sampled_lifetime": 20400, "agent_episode_returns_mean": {"default_agent": 0.65}, "num_env_steps_sampled": 400, "num_agent_steps_sampled": {"default_agent": 400}, "num_module_steps_sampled": {"default_policy": 400}, "episode_len_min": 20, "env_to_module_sum_episodes_length_in": 10.368237912813044, "module_episode_returns_mean": {"default_policy": 0.65}, "episode_return_min": -13.5, "time_between_sampling": 11.214038503703906}, "num_healthy_workers": 1, "actor_manager_num_outstanding_async_reqs": 0, "num_remote_worker_restarts": 0}, "num_env_steps_sampled_lifetime": -1225000.0, "fault_tolerance": {"num_healthy_workers": 0, "num_remote_worker_restarts": 0}, "env_runner_group": {"actor_manager_num_outstanding_async_reqs": 0}, "done": false, "training_iteration": 4, "trial_id": "ba99d_00000", "date": "2025-08-11_17-57-16", "timestamp": 1754927836, "time_this_iter_s": 11.48991322517395, "time_total_s": 46.187631130218506, "pid": 9655, "hostname": "Mac", "node_ip": "127.0.0.1", "config": {"exploration_config": {}, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 2, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "env": "Umbrella", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": false, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 0, "create_local_env_runner": true, "num_envs_per_env_runner": 1, "gym_env_vectorize_mode": "SYNC", "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "episodes_to_numpy": true, "max_requests_in_flight_per_env_runner": 1, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "merge_env_runner_states": "training_only", "broadcast_env_runner_states": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "complete_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "sampler_perf_stats_ema_coef": null, "_is_online": true, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": "auto", "num_aggregator_actors_per_learner": 0, "max_requests_in_flight_per_aggregator_actor": 3, "local_gpu_idx": 0, "max_requests_in_flight_per_learner": 3, "gamma": 1, "lr": 0.0002715581955, "grad_clip": 0.5, "grad_clip_by": "global_norm", "_train_batch_size_per_learner": 5000, "train_batch_size": 4000, "num_epochs": 1, "minibatch_size": 1000, "shuffle_batch_per_epoch": true, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "log_std_clip_param": 20.0, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "_disable_preprocessor_api": false, "_disable_action_flattening": false}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {"intrinsic_reward_coeff": 0.2795015916508}, "optimizer": {}, "_learner_class": "<class 'source.intrinsic_attention_ppo.learners.IntrinsicAttentionMetaLearner.IntrinsicAttentionMetaLearner'>", "callbacks_on_algorithm_init": null, "callbacks_on_env_runners_recreated": null, "callbacks_on_offline_eval_runners_recreated": null, "callbacks_on_checkpoint_loaded": null, "callbacks_on_environment_created": null, "callbacks_on_episode_created": null, "callbacks_on_episode_start": null, "callbacks_on_episode_step": null, "callbacks_on_episode_end": null, "callbacks_on_evaluate_start": null, "callbacks_on_evaluate_end": null, "callbacks_on_evaluate_offline_start": null, "callbacks_on_evaluate_offline_end": null, "callbacks_on_sample_end": null, "callbacks_on_train_result": null, "explore": true, "enable_rl_module_and_learner": true, "enable_env_runner_and_connector_v2": true, "_prior_exploration_config": {"type": "StochasticSampling"}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x15d6f98a0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "offline_data_class": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_read_batch_size": null, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "materialize_data": false, "materialize_mapped_data": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "ignore_final_observation": false, "prelearner_class": null, "prelearner_buffer_class": null, "prelearner_buffer_kwargs": {}, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_remaining_data": false, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": 1, "evaluation_duration": 20, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_auto_duration_min_env_steps_per_sample": 100, "evaluation_auto_duration_max_env_steps_per_sample": 2000, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 1, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "offline_evaluation_interval": null, "num_offline_eval_runners": 0, "offline_loss_for_module_fn": null, "offline_evaluation_duration": 1, "offline_evaluation_parallel_to_training": false, "offline_evaluation_timeout_s": 120.0, "num_cpus_per_offline_eval_runner": 1, "num_gpus_per_offline_eval_runner": 0, "custom_resources_per_offline_eval_runner": {}, "restart_failed_offline_eval_runners": true, "ignore_offline_eval_runner_failures": false, "max_num_offline_eval_runner_restarts": 1000, "offline_eval_runner_restore_timeout_s": 1800.0, "max_requests_in_flight_per_offline_eval_runner": 1, "validate_offline_eval_runners_after_construction": true, "offline_eval_runner_health_probe_timeout_s": 30.0, "offline_eval_rl_module_inference_only": false, "broadcast_offline_eval_runner_states": false, "offline_eval_batch_size_per_runner": 256, "dataset_num_iters_per_eval_runner": 1, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "log_gradients": false, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 6, "restart_failed_env_runners": true, "ignore_env_runner_failures": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30.0, "env_runner_restore_timeout_s": 1800.0, "_model_config": {}, "_rl_module_spec": "MultiRLModuleSpec(multi_rl_module_class=<class 'ray.rllib.core.rl_module.multi_rl_module.MultiRLModule'>, observation_space=None, action_space=None, inference_only=False, model_config=None, rl_module_specs={'default_policy': RLModuleSpec(module_class=<class 'source.intrinsic_attention_ppo.rl_modules.DifferentiablePPOModule.DifferentiablePPOModule'>, observation_space=None, action_space=None, inference_only=False, learner_only=False, model_config={'vf_share_layers': True, 'embedding_dim': 62, 'max_seq_len': 3, 'policy_head_hidden_sizes': [32], 'value_head_hidden_sizes': [101], 'embedding_hidden_sizes': [121]}, catalog_class=None, load_state_path=None, model_config_dict=None), 'intrinsic_reward_module': RLModuleSpec(module_class=<class 'source.intrinsic_attention_ppo.rl_modules.IntrinsicAttentionModule.IntrinsicAttentionModule'>, observation_space=None, action_space=None, inference_only=False, learner_only=True, model_config={'intrinsic_reward_network': {'encoder_hidden_sizes': [], 'encoding_dim': 1, 'num_heads': 1, 'head_hidden_sizes': None, 'layers': [{'type': 'attention'}]}, 'extrinsic_value_hidden_layers': [127, 60], 'vf_share_layers': True, 'max_seq_len': 3}, catalog_class=None, load_state_path=None, model_config_dict=None)}, load_state_path=None, modules_to_load=None, module_specs={'default_policy': RLModuleSpec(module_class=<class 'source.intrinsic_attention_ppo.rl_modules.DifferentiablePPOModule.DifferentiablePPOModule'>, observation_space=None, action_space=None, inference_only=False, learner_only=False, model_config={'vf_share_layers': True, 'embedding_dim': 62, 'max_seq_len': 3, 'policy_head_hidden_sizes': [32], 'value_head_hidden_sizes': [101], 'embedding_hidden_sizes': [121]}, catalog_class=None, load_state_path=None, model_config_dict=None), 'intrinsic_reward_module': RLModuleSpec(module_class=<class 'source.intrinsic_attention_ppo.rl_modules.IntrinsicAttentionModule.IntrinsicAttentionModule'>, observation_space=None, action_space=None, inference_only=False, learner_only=True, model_config={'intrinsic_reward_network': {'encoder_hidden_sizes': [], 'encoding_dim': 1, 'num_heads': 1, 'head_hidden_sizes': None, 'layers': [{'type': 'attention'}]}, 'extrinsic_value_hidden_layers': [127, 60], 'vf_share_layers': True, 'max_seq_len': 3}, catalog_class=None, load_state_path=None, model_config_dict=None)})", "algorithm_config_overrides_per_module": {"intrinsic_reward_module": {"lr": 0.0002715581955}}, "_per_module_overrides": {}, "_validate_config": true, "_use_msgpack_checkpoints": false, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "env_task_fn": -1, "enable_connectors": -1, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.161583927863, "kl_target": 0.0201019014258, "vf_loss_coeff": 0.7790510010087, "entropy_coeff": 0.0015431216992, "clip_param": 0.2459212356676, "vf_clip_param": 0.3769744131561, "entropy_coeff_schedule": null, "lr_schedule": null, "sgd_minibatch_size": -1, "vf_share_layers": -1, "differentiable_learner_configs": ["DifferentiableLearnerConfig(learner_class=<class 'source.intrinsic_attention_ppo.learners.IntrinsicAttentionPPOLearner.IntrinsicAttentionPPOLearner'>, learner_connector=None, add_default_connectors_to_learner_pipeline=True, is_multi_agent=False, policies_to_update=['default_policy'], lr=0.0060984166342, num_total_minibatches=0, num_epochs=1, minibatch_size=1000, shuffle_batch_per_epoch=True)"], "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9485408017724, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.callbacks.callbacks.RLlibCallback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 46.187631130218506, "iterations_since_restore": 4, "perf": {"cpu_util_percent": 44.506249999999994, "ram_util_percent": 82.875}}
{"timers": {"training_iteration": 11.00387652604507, "restore_env_runners": 2.2379168390289414e-05, "training_step": 11.003586576634714, "env_runner_sampling_timer": 1.7403450358969663, "learner_update_timer": 9.051557210361738, "synch_weights": 0.0016714703807477955, "restore_eval_env_runners": 8.506451120995917e-05, "evaluation_iteration": 0.13617089985998093, "synch_eval_env_connectors": 0.00019513810573262163, "synch_env_connectors": 4.946401973837055e-06}, "env_runners": {"module_to_env_connector": {"timers": {"connectors": {"listify_data_for_vector_env": 1.1228312881862224e-05, "normalize_and_clip_actions": 8.525064043934734e-06, "get_actions": 4.454233552655973e-05, "tensor_to_numpy": 1.66745816874695e-05, "un_batch_to_individual_items": 7.083088024134728e-06, "remove_single_ts_time_rank_from_batch": 1.2601641486778187e-05}}, "connector_pipeline_timer": 0.0001295852792467561}, "time_between_sampling": 0.040421828229574276, "env_to_module_sum_episodes_length_in": 10.36823839457432, "env_to_module_connector": {"timers": {"connectors": {"add_observations_from_episodes_to_batch": 3.0131833690981016e-06, "numpy_to_tensor": 1.3650500635279648e-05, "batch_individual_items": 1.344030472937617e-05, "add_states_from_episodes_to_batch": 2.901795091711016e-06, "add_time_dim_to_batch_and_zero_pad": 7.496221303866394e-06}}, "connector_pipeline_timer": 6.455086402189716e-05}, "num_agent_steps_sampled_lifetime": {"default_agent": -1842500.0}, "env_reset_timer": 6.185888132130955e-05, "episode_return_mean": 2.740000000000001, "episode_return_min": -9.5, "env_to_module_sum_episodes_length_out": 10.36823839457432, "module_episode_returns_mean": {"default_policy": 2.740000000000001}, "agent_episode_returns_mean": {"default_agent": 2.740000000000001}, "episode_len_max": 20, "sample": 0.006044691853891024, "rlmodule_inference_timer": 3.528072370705337e-05, "episode_len_mean": 20.0, "num_env_steps_sampled": 5000.0, "weights_seq_no": 4.0, "num_agent_steps_sampled": {"default_agent": 5000.0}, "episode_return_max": 10.5, "num_episodes": 250.0, "num_module_steps_sampled": {"default_policy": 5000.0}, "env_step_timer": 1.5089826852875998e-05, "num_module_steps_sampled_lifetime": {"default_policy": -1842500.0}, "episode_duration_sec_mean": 0.005792696719057859, "num_episodes_lifetime": -92125.0, "num_env_steps_sampled_lifetime": -1842500.0, "episode_len_min": 20, "num_env_steps_sampled_lifetime_throughput": 3018.2984962656255}, "__all_modules__": {"learner_connector_sum_episodes_length_in": 5000.0, "learner_connector": {"connector_pipeline_timer": 0.1725325789297102, "timers": {"connectors": {"add_one_ts_to_episodes_and_truncate": 0.009048574071141577, "add_observations_from_episodes_to_batch": 0.000830258247798418, "add_columns_from_episodes_to_train_batch": 0.04170362691280944, "add_time_dim_to_batch_and_zero_pad": 0.10289644940821491, "add_states_from_episodes_to_batch": 0.0034473262642741604, "batch_individual_items": 0.014388792212872944, "numpy_to_tensor": 7.235364712486974e-05}}}, "learner_connector_sum_episodes_length_out": 5250.0}, "learners": {"intrinsic_reward_module": {"gradients_default_optimizer_global_norm": 0.0, "num_module_steps_trained": 5994, "total_loss": 0.0, "num_trainable_parameters": 8266, "default_optimizer_learning_rate": 0.0002715581955, "curr_entropy_coeff": 0.0015431216992, "weights_seq_no": 5.0, "diff_num_grad_updates_vs_sampler_policy": 1.0, "num_module_steps_trained_lifetime": 29970, "module_train_batch_size_mean": 999.0, "num_module_steps_trained_lifetime_throughput": 653.4517990511354}, "__all_modules__": {"num_module_steps_trained_lifetime": 59940, "num_module_steps_trained": 11988, "num_non_trainable_parameters": 0, "num_env_steps_trained": 31500, "num_env_steps_trained_lifetime": 157500, "num_trainable_parameters": 24861, "num_env_steps_trained_lifetime_throughput": 3434.1095910358026, "num_module_steps_trained_throughput": 25569786.3100605, "num_module_steps_trained_lifetime_throughput": 11500281.222210322}, "differentiable_learners": {"intrinsic_attention_ppo_learner": {"intrinsic_reward_module": {"diff_num_grad_updates_vs_sampler_policy": 26.0, "total_loss": 0.0, "num_module_steps_trained_lifetime": 179820, "num_module_steps_trained": 35964, "module_train_batch_size_mean": 999.0, "weights_seq_no": 30.0}, "default_policy": {"num_module_steps_trained_lifetime": 179820, "num_module_steps_trained": 35964, "module_train_batch_size_mean": 999.0, "vf_loss_unclipped": 39.26675796508789, "mean_kl_loss": 1.558278381708078e-05, "use_intrinsic_rewards": 1.0, "entropy": 0.6796707510948181, "policy_loss": -0.00011213494872208685, "diff_num_grad_updates_vs_sampler_policy": 26.0, "total_loss": 0.2034105509519577, "vf_explained_var": 0.002902507781982422, "weights_seq_no": 30.0, "vf_loss": 0.26258739829063416}, "__all_modules__": {"num_module_steps_trained_lifetime": 359640, "num_env_steps_trained": 189000, "num_env_steps_trained_lifetime": 945000, "num_module_steps_trained": 71928, "num_env_steps_trained_lifetime_throughput": 44865.52519095699}}}, "default_policy": {"vf_loss_unclipped": 39.355472564697266, "mean_kl_loss": 1.5996978618204594e-05, "curr_kl_coeff": 0.0050494978204369545, "curr_entropy_coeff": 0.0015431216992, "use_intrinsic_rewards": 0.0, "entropy": 0.6796584129333496, "policy_loss": -0.00011367075785528868, "diff_num_grad_updates_vs_sampler_policy": 1.0, "total_loss": 0.20330075919628143, "num_trainable_parameters": 16595, "vf_explained_var": -0.0009599924087524414, "weights_seq_no": 5.0, "vf_loss": 0.2624514698982239, "num_module_steps_trained_lifetime": 29970, "module_train_batch_size_mean": 999.0, "num_module_steps_trained": 5994, "num_module_steps_trained_lifetime_throughput": 653.4437654128251}, "IntrinsicAttentionMask": [[[0.33309420943260193, 0.3335604667663574, 0.33334535360336304], [0.33311727643013, 0.3335385322570801, 0.3333441913127899], [0.3331066370010376, 0.3335486352443695, 0.3333447277545929]], [[0.333452045917511, 0.33290308713912964, 0.33364489674568176], [0.33347490429878235, 0.33281999826431274, 0.3337050676345825], [0.3334439694881439, 0.3329322338104248, 0.3336237668991089]], [[0.3333190679550171, 0.3330664038658142, 0.3336144983768463], [0.3333185017108917, 0.3330563008785248, 0.3336251378059387], [0.3333197236061096, 0.3330782353878021, 0.33360207080841064]], [[0.33335837721824646, 0.3329220116138458, 0.3337195813655853], [0.3333643972873688, 0.3328220844268799, 0.33381345868110657], [0.3333533704280853, 0.3330046534538269, 0.33364197611808777]], [[0.3329198360443115, 0.3339047431945801, 0.3331754207611084], [0.33300113677978516, 0.3337923288345337, 0.33320650458335876], [0.3329409658908844, 0.33387553691864014, 0.33318349719047546]], [[0.3344842493534088, 0.3304905891418457, 0.3350251317024231], [0.33780816197395325, 0.3222317397594452, 0.33996012806892395], [0.3340316116809845, 0.3316096365451813, 0.33435875177383423]]]}, "num_training_step_calls_per_iteration": 1, "evaluation": {"env_runners": {"episode_len_max": 20, "rlmodule_inference_timer": 3.458816333650989e-05, "weights_seq_no": 5.0, "module_to_env_connector": {"timers": {"connectors": {"remove_single_ts_time_rank_from_batch": 1.2150798780125308e-05, "listify_data_for_vector_env": 1.0896688877316634e-05, "normalize_and_clip_actions": 8.204419155174599e-06, "get_actions": 3.962081694834645e-05, "tensor_to_numpy": 1.6709387543228884e-05, "un_batch_to_individual_items": 6.75214721384838e-06}}, "connector_pipeline_timer": 0.00012123960443798122}, "episode_return_max": 14.5, "num_episodes": 20, "num_episodes_lifetime": 100, "num_agent_steps_sampled_lifetime": {"default_agent": 2000}, "env_reset_timer": 0.0005433633104275993, "env_to_module_sum_episodes_length_out": 10.368238387501162, "num_module_steps_sampled_lifetime": {"default_policy": 2000}, "env_to_module_connector": {"timers": {"connectors": {"numpy_to_tensor": 1.2835295384648458e-05, "batch_individual_items": 1.2938409501902018e-05, "add_observations_from_episodes_to_batch": 2.9238555283712966e-06, "add_states_from_episodes_to_batch": 3.094555994356329e-06, "add_time_dim_to_batch_and_zero_pad": 7.436840132219687e-06}}, "connector_pipeline_timer": 6.21111845470732e-05}, "episode_return_mean": 1.65, "sample": 0.12400885701472608, "episode_len_mean": 20.0, "env_step_timer": 1.4799631772389e-05, "episode_duration_sec_mean": 0.0055754079041071235, "num_env_steps_sampled_lifetime": 25400, "agent_episode_returns_mean": {"default_agent": 1.65}, "num_env_steps_sampled": 400, "num_agent_steps_sampled": {"default_agent": 400}, "num_module_steps_sampled": {"default_policy": 400}, "episode_len_min": 20, "env_to_module_sum_episodes_length_in": 10.368238387501162, "module_episode_returns_mean": {"default_policy": 1.65}, "episode_return_min": -13.5, "time_between_sampling": 11.225365619507647}, "num_healthy_workers": 1, "actor_manager_num_outstanding_async_reqs": 0, "num_remote_worker_restarts": 0}, "num_env_steps_sampled_lifetime": -1842500.0, "fault_tolerance": {"num_healthy_workers": 0, "num_remote_worker_restarts": 0}, "env_runner_group": {"actor_manager_num_outstanding_async_reqs": 0}, "done": false, "training_iteration": 5, "trial_id": "ba99d_00000", "date": "2025-08-11_17-57-28", "timestamp": 1754927848, "time_this_iter_s": 12.429533958435059, "time_total_s": 58.617165088653564, "pid": 9655, "hostname": "Mac", "node_ip": "127.0.0.1", "config": {"exploration_config": {}, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 2, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "env": "Umbrella", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": false, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 0, "create_local_env_runner": true, "num_envs_per_env_runner": 1, "gym_env_vectorize_mode": "SYNC", "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "episodes_to_numpy": true, "max_requests_in_flight_per_env_runner": 1, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "merge_env_runner_states": "training_only", "broadcast_env_runner_states": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "complete_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "sampler_perf_stats_ema_coef": null, "_is_online": true, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": "auto", "num_aggregator_actors_per_learner": 0, "max_requests_in_flight_per_aggregator_actor": 3, "local_gpu_idx": 0, "max_requests_in_flight_per_learner": 3, "gamma": 1, "lr": 0.0002715581955, "grad_clip": 0.5, "grad_clip_by": "global_norm", "_train_batch_size_per_learner": 5000, "train_batch_size": 4000, "num_epochs": 1, "minibatch_size": 1000, "shuffle_batch_per_epoch": true, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "log_std_clip_param": 20.0, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "_disable_preprocessor_api": false, "_disable_action_flattening": false}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {"intrinsic_reward_coeff": 0.2795015916508}, "optimizer": {}, "_learner_class": "<class 'source.intrinsic_attention_ppo.learners.IntrinsicAttentionMetaLearner.IntrinsicAttentionMetaLearner'>", "callbacks_on_algorithm_init": null, "callbacks_on_env_runners_recreated": null, "callbacks_on_offline_eval_runners_recreated": null, "callbacks_on_checkpoint_loaded": null, "callbacks_on_environment_created": null, "callbacks_on_episode_created": null, "callbacks_on_episode_start": null, "callbacks_on_episode_step": null, "callbacks_on_episode_end": null, "callbacks_on_evaluate_start": null, "callbacks_on_evaluate_end": null, "callbacks_on_evaluate_offline_start": null, "callbacks_on_evaluate_offline_end": null, "callbacks_on_sample_end": null, "callbacks_on_train_result": null, "explore": true, "enable_rl_module_and_learner": true, "enable_env_runner_and_connector_v2": true, "_prior_exploration_config": {"type": "StochasticSampling"}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x15d6f98a0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "offline_data_class": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_read_batch_size": null, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "materialize_data": false, "materialize_mapped_data": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "ignore_final_observation": false, "prelearner_class": null, "prelearner_buffer_class": null, "prelearner_buffer_kwargs": {}, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_remaining_data": false, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": 1, "evaluation_duration": 20, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_auto_duration_min_env_steps_per_sample": 100, "evaluation_auto_duration_max_env_steps_per_sample": 2000, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 1, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "offline_evaluation_interval": null, "num_offline_eval_runners": 0, "offline_loss_for_module_fn": null, "offline_evaluation_duration": 1, "offline_evaluation_parallel_to_training": false, "offline_evaluation_timeout_s": 120.0, "num_cpus_per_offline_eval_runner": 1, "num_gpus_per_offline_eval_runner": 0, "custom_resources_per_offline_eval_runner": {}, "restart_failed_offline_eval_runners": true, "ignore_offline_eval_runner_failures": false, "max_num_offline_eval_runner_restarts": 1000, "offline_eval_runner_restore_timeout_s": 1800.0, "max_requests_in_flight_per_offline_eval_runner": 1, "validate_offline_eval_runners_after_construction": true, "offline_eval_runner_health_probe_timeout_s": 30.0, "offline_eval_rl_module_inference_only": false, "broadcast_offline_eval_runner_states": false, "offline_eval_batch_size_per_runner": 256, "dataset_num_iters_per_eval_runner": 1, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "log_gradients": false, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 6, "restart_failed_env_runners": true, "ignore_env_runner_failures": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30.0, "env_runner_restore_timeout_s": 1800.0, "_model_config": {}, "_rl_module_spec": "MultiRLModuleSpec(multi_rl_module_class=<class 'ray.rllib.core.rl_module.multi_rl_module.MultiRLModule'>, observation_space=None, action_space=None, inference_only=False, model_config=None, rl_module_specs={'default_policy': RLModuleSpec(module_class=<class 'source.intrinsic_attention_ppo.rl_modules.DifferentiablePPOModule.DifferentiablePPOModule'>, observation_space=None, action_space=None, inference_only=False, learner_only=False, model_config={'vf_share_layers': True, 'embedding_dim': 62, 'max_seq_len': 3, 'policy_head_hidden_sizes': [32], 'value_head_hidden_sizes': [101], 'embedding_hidden_sizes': [121]}, catalog_class=None, load_state_path=None, model_config_dict=None), 'intrinsic_reward_module': RLModuleSpec(module_class=<class 'source.intrinsic_attention_ppo.rl_modules.IntrinsicAttentionModule.IntrinsicAttentionModule'>, observation_space=None, action_space=None, inference_only=False, learner_only=True, model_config={'intrinsic_reward_network': {'encoder_hidden_sizes': [], 'encoding_dim': 1, 'num_heads': 1, 'head_hidden_sizes': None, 'layers': [{'type': 'attention'}]}, 'extrinsic_value_hidden_layers': [127, 60], 'vf_share_layers': True, 'max_seq_len': 3}, catalog_class=None, load_state_path=None, model_config_dict=None)}, load_state_path=None, modules_to_load=None, module_specs={'default_policy': RLModuleSpec(module_class=<class 'source.intrinsic_attention_ppo.rl_modules.DifferentiablePPOModule.DifferentiablePPOModule'>, observation_space=None, action_space=None, inference_only=False, learner_only=False, model_config={'vf_share_layers': True, 'embedding_dim': 62, 'max_seq_len': 3, 'policy_head_hidden_sizes': [32], 'value_head_hidden_sizes': [101], 'embedding_hidden_sizes': [121]}, catalog_class=None, load_state_path=None, model_config_dict=None), 'intrinsic_reward_module': RLModuleSpec(module_class=<class 'source.intrinsic_attention_ppo.rl_modules.IntrinsicAttentionModule.IntrinsicAttentionModule'>, observation_space=None, action_space=None, inference_only=False, learner_only=True, model_config={'intrinsic_reward_network': {'encoder_hidden_sizes': [], 'encoding_dim': 1, 'num_heads': 1, 'head_hidden_sizes': None, 'layers': [{'type': 'attention'}]}, 'extrinsic_value_hidden_layers': [127, 60], 'vf_share_layers': True, 'max_seq_len': 3}, catalog_class=None, load_state_path=None, model_config_dict=None)})", "algorithm_config_overrides_per_module": {"intrinsic_reward_module": {"lr": 0.0002715581955}}, "_per_module_overrides": {}, "_validate_config": true, "_use_msgpack_checkpoints": false, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "env_task_fn": -1, "enable_connectors": -1, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.161583927863, "kl_target": 0.0201019014258, "vf_loss_coeff": 0.7790510010087, "entropy_coeff": 0.0015431216992, "clip_param": 0.2459212356676, "vf_clip_param": 0.3769744131561, "entropy_coeff_schedule": null, "lr_schedule": null, "sgd_minibatch_size": -1, "vf_share_layers": -1, "differentiable_learner_configs": ["DifferentiableLearnerConfig(learner_class=<class 'source.intrinsic_attention_ppo.learners.IntrinsicAttentionPPOLearner.IntrinsicAttentionPPOLearner'>, learner_connector=None, add_default_connectors_to_learner_pipeline=True, is_multi_agent=False, policies_to_update=['default_policy'], lr=0.0060984166342, num_total_minibatches=0, num_epochs=1, minibatch_size=1000, shuffle_batch_per_epoch=True)"], "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9485408017724, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.callbacks.callbacks.RLlibCallback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 58.617165088653564, "iterations_since_restore": 5, "perf": {"cpu_util_percent": 60.58888888888888, "ram_util_percent": 83.11111111111111}}
{"timers": {"training_iteration": 11.022406596204922, "restore_env_runners": 2.2373706657553627e-05, "training_step": 11.02211503169783, "env_runner_sampling_timer": 1.7413063092876881, "learner_update_timer": 9.068678405337941, "synch_weights": 0.0017400715070145683, "restore_eval_env_runners": 8.442302601412637e-05, "evaluation_iteration": 0.13616143920106208, "synch_eval_env_connectors": 0.00019485922518692678, "synch_env_connectors": 4.9440174743987154e-06}, "env_runners": {"module_to_env_connector": {"timers": {"connectors": {"listify_data_for_vector_env": 1.1968146118438803e-05, "normalize_and_clip_actions": 9.005977851673324e-06, "get_actions": 5.0279459798808536e-05, "tensor_to_numpy": 1.8205217660588012e-05, "un_batch_to_individual_items": 7.470354552276193e-06, "remove_single_ts_time_rank_from_batch": 1.3124394856744218e-05}}, "connector_pipeline_timer": 0.0001406841461966083}, "time_between_sampling": 0.04337262857939251, "env_to_module_sum_episodes_length_in": 10.36823839457432, "env_to_module_connector": {"timers": {"connectors": {"add_observations_from_episodes_to_batch": 3.179321839149405e-06, "numpy_to_tensor": 1.5187914456909669e-05, "batch_individual_items": 1.4464266290800304e-05, "add_states_from_episodes_to_batch": 3.0472121098659137e-06, "add_time_dim_to_batch_and_zero_pad": 8.125026175378909e-06}}, "connector_pipeline_timer": 6.93205866206045e-05}, "num_agent_steps_sampled_lifetime": {"default_agent": -2460000.0}, "env_reset_timer": 6.0283243006652024e-05, "episode_return_mean": 2.259999999999999, "episode_return_min": -9.5, "env_to_module_sum_episodes_length_out": 10.36823839457432, "module_episode_returns_mean": {"default_policy": 2.259999999999999}, "agent_episode_returns_mean": {"default_agent": 2.259999999999999}, "episode_len_max": 20, "sample": 0.006711131031217836, "rlmodule_inference_timer": 3.99752673664503e-05, "episode_len_mean": 20.0, "num_env_steps_sampled": 5000.0, "weights_seq_no": 5.0, "num_agent_steps_sampled": {"default_agent": 5000.0}, "episode_return_max": 10.5, "num_episodes": 250.0, "num_module_steps_sampled": {"default_policy": 5000.0}, "env_step_timer": 1.679398504281364e-05, "num_module_steps_sampled_lifetime": {"default_policy": -2460000.0}, "episode_duration_sec_mean": 0.006284607664681973, "num_episodes_lifetime": -123000.0, "num_env_steps_sampled_lifetime": -2460000.0, "episode_len_min": 20, "num_env_steps_sampled_lifetime_throughput": 2807.221372200569}, "__all_modules__": {"learner_connector_sum_episodes_length_in": 5000.0, "learner_connector": {"connector_pipeline_timer": 0.17269478064092517, "timers": {"connectors": {"add_one_ts_to_episodes_and_truncate": 0.009063387501257654, "add_observations_from_episodes_to_batch": 0.0008304614960945176, "add_columns_from_episodes_to_train_batch": 0.04174405814333608, "add_time_dim_to_batch_and_zero_pad": 0.10300929991457927, "add_states_from_episodes_to_batch": 0.0034512113309610585, "batch_individual_items": 0.014378573040803073, "numpy_to_tensor": 7.247094127027401e-05}}}, "learner_connector_sum_episodes_length_out": 5250.0}, "learners": {"intrinsic_reward_module": {"gradients_default_optimizer_global_norm": 0.0, "num_module_steps_trained": 5994, "total_loss": 0.0, "num_trainable_parameters": 8266, "default_optimizer_learning_rate": 0.0002715581955, "curr_entropy_coeff": 0.0015431216992, "weights_seq_no": 6.0, "diff_num_grad_updates_vs_sampler_policy": 1.0, "num_module_steps_trained_lifetime": 35964, "module_train_batch_size_mean": 999.0, "num_module_steps_trained_lifetime_throughput": 649.5318322169638}, "__all_modules__": {"num_module_steps_trained_lifetime": 71928, "num_module_steps_trained": 11988, "num_non_trainable_parameters": 0, "num_env_steps_trained": 31500, "num_env_steps_trained_lifetime": 189000, "num_trainable_parameters": 24861, "num_env_steps_trained_lifetime_throughput": 3413.507537468292, "num_module_steps_trained_throughput": 24851087.973179247, "num_module_steps_trained_lifetime_throughput": 11475682.198633296}, "differentiable_learners": {"intrinsic_attention_ppo_learner": {"intrinsic_reward_module": {"diff_num_grad_updates_vs_sampler_policy": 31.0, "total_loss": 0.0, "num_module_steps_trained_lifetime": 215784, "num_module_steps_trained": 35964, "module_train_batch_size_mean": 999.0, "weights_seq_no": 36.0}, "default_policy": {"num_module_steps_trained_lifetime": 215784, "num_module_steps_trained": 35964, "module_train_batch_size_mean": 999.0, "vf_loss_unclipped": 38.62038803100586, "mean_kl_loss": 4.986326871403435e-07, "use_intrinsic_rewards": 1.0, "entropy": 0.6792853474617004, "policy_loss": -2.6050051019410603e-05, "diff_num_grad_updates_vs_sampler_policy": 31.0, "total_loss": 0.20346857607364655, "vf_explained_var": 0.0028865933418273926, "weights_seq_no": 36.0, "vf_loss": 0.26255375146865845}, "__all_modules__": {"num_module_steps_trained_lifetime": 431568, "num_env_steps_trained": 189000, "num_env_steps_trained_lifetime": 1134000, "num_module_steps_trained": 71928, "num_env_steps_trained_lifetime_throughput": 44124.31245118114}}}, "default_policy": {"vf_loss_unclipped": 38.704559326171875, "mean_kl_loss": 3.744035836916737e-07, "curr_kl_coeff": 0.0025247489102184772, "curr_entropy_coeff": 0.0015431216992, "use_intrinsic_rewards": 0.0, "entropy": 0.6793137192726135, "policy_loss": -3.359621041454375e-05, "diff_num_grad_updates_vs_sampler_policy": 1.0, "total_loss": 0.2033904492855072, "num_trainable_parameters": 16595, "vf_explained_var": 2.0205974578857422e-05, "weights_seq_no": 6.0, "vf_loss": 0.2624633312225342, "num_module_steps_trained_lifetime": 35964, "module_train_batch_size_mean": 999.0, "num_module_steps_trained": 5994, "num_module_steps_trained_lifetime_throughput": 649.5241373494698}, "IntrinsicAttentionMask": [[[0.33309420943260193, 0.3335604667663574, 0.33334535360336304], [0.33311727643013, 0.3335385322570801, 0.3333441913127899], [0.3331066370010376, 0.3335486352443695, 0.3333447277545929]], [[0.3334019184112549, 0.33308473229408264, 0.3335132896900177], [0.333424836397171, 0.33300164341926575, 0.33357349038124084], [0.3333938717842102, 0.3331139385700226, 0.3334921896457672]], [[0.33378228545188904, 0.3335292935371399, 0.3326883912086487], [0.3337993025779724, 0.33353671431541443, 0.33266398310661316], [0.33385592699050903, 0.33356139063835144, 0.3325827121734619]], [[0.33300402760505676, 0.33343929052352905, 0.3335566818714142], [0.3330380320549011, 0.33342835307121277, 0.3335335850715637], [0.33304721117019653, 0.3334254324436188, 0.3335273861885071]], [[0.33278825879096985, 0.33408668637275696, 0.3331250846385956], [0.33286958932876587, 0.3339742422103882, 0.33315619826316833], [0.3328093886375427, 0.334057480096817, 0.33313316106796265]], [[0.33440887928009033, 0.33157140016555786, 0.3340197503566742], [0.3420409560203552, 0.31914135813713074, 0.33881762623786926], [0.3354557752609253, 0.32985877990722656, 0.33468544483184814]]]}, "num_training_step_calls_per_iteration": 1, "evaluation": {"env_runners": {"episode_len_max": 20, "rlmodule_inference_timer": 7.82538718423787e-05, "weights_seq_no": 6.0, "module_to_env_connector": {"timers": {"connectors": {"remove_single_ts_time_rank_from_batch": 2.2873501040103005e-05, "listify_data_for_vector_env": 2.0550335422747325e-05, "normalize_and_clip_actions": 1.4733193427993025e-05, "get_actions": 0.00010151166983763753, "tensor_to_numpy": 3.2776609703830107e-05, "un_batch_to_individual_items": 1.2416863043983289e-05}}, "connector_pipeline_timer": 0.000255650759955429}, "episode_return_max": 14.5, "num_episodes": 20, "num_episodes_lifetime": 120, "num_agent_steps_sampled_lifetime": {"default_agent": 2400}, "env_reset_timer": 0.0005452134266149965, "env_to_module_sum_episodes_length_out": 10.368238394470474, "num_module_steps_sampled_lifetime": {"default_policy": 2400}, "env_to_module_connector": {"timers": {"connectors": {"numpy_to_tensor": 3.063824632669045e-05, "batch_individual_items": 2.5452072453258833e-05, "add_observations_from_episodes_to_batch": 5.827581979899062e-06, "add_states_from_episodes_to_batch": 6.860294532285e-06, "add_time_dim_to_batch_and_zero_pad": 1.5787180764612127e-05}}, "connector_pipeline_timer": 0.00012384965297164533}, "episode_return_mean": 1.65, "sample": 0.12568336594376314, "episode_len_mean": 20.0, "env_step_timer": 3.3390968104275934e-05, "episode_duration_sec_mean": 0.007126503295730799, "num_env_steps_sampled_lifetime": 30400, "agent_episode_returns_mean": {"default_agent": 1.65}, "num_env_steps_sampled": 400, "num_agent_steps_sampled": {"default_agent": 400}, "num_module_steps_sampled": {"default_policy": 400}, "episode_len_min": 20, "env_to_module_sum_episodes_length_in": 10.368238394470474, "module_episode_returns_mean": {"default_policy": 1.65}, "episode_return_min": -13.5, "time_between_sampling": 11.242481654141761}, "num_healthy_workers": 1, "actor_manager_num_outstanding_async_reqs": 0, "num_remote_worker_restarts": 0}, "num_env_steps_sampled_lifetime": -2460000.0, "fault_tolerance": {"num_healthy_workers": 0, "num_remote_worker_restarts": 0}, "env_runner_group": {"actor_manager_num_outstanding_async_reqs": 0}, "done": false, "training_iteration": 6, "trial_id": "ba99d_00000", "date": "2025-08-11_17-57-41", "timestamp": 1754927861, "time_this_iter_s": 13.200857162475586, "time_total_s": 71.81802225112915, "pid": 9655, "hostname": "Mac", "node_ip": "127.0.0.1", "config": {"exploration_config": {}, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 2, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "env": "Umbrella", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": false, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 0, "create_local_env_runner": true, "num_envs_per_env_runner": 1, "gym_env_vectorize_mode": "SYNC", "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "episodes_to_numpy": true, "max_requests_in_flight_per_env_runner": 1, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "merge_env_runner_states": "training_only", "broadcast_env_runner_states": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "complete_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "sampler_perf_stats_ema_coef": null, "_is_online": true, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": "auto", "num_aggregator_actors_per_learner": 0, "max_requests_in_flight_per_aggregator_actor": 3, "local_gpu_idx": 0, "max_requests_in_flight_per_learner": 3, "gamma": 1, "lr": 0.0002715581955, "grad_clip": 0.5, "grad_clip_by": "global_norm", "_train_batch_size_per_learner": 5000, "train_batch_size": 4000, "num_epochs": 1, "minibatch_size": 1000, "shuffle_batch_per_epoch": true, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "log_std_clip_param": 20.0, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "_disable_preprocessor_api": false, "_disable_action_flattening": false}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {"intrinsic_reward_coeff": 0.2795015916508}, "optimizer": {}, "_learner_class": "<class 'source.intrinsic_attention_ppo.learners.IntrinsicAttentionMetaLearner.IntrinsicAttentionMetaLearner'>", "callbacks_on_algorithm_init": null, "callbacks_on_env_runners_recreated": null, "callbacks_on_offline_eval_runners_recreated": null, "callbacks_on_checkpoint_loaded": null, "callbacks_on_environment_created": null, "callbacks_on_episode_created": null, "callbacks_on_episode_start": null, "callbacks_on_episode_step": null, "callbacks_on_episode_end": null, "callbacks_on_evaluate_start": null, "callbacks_on_evaluate_end": null, "callbacks_on_evaluate_offline_start": null, "callbacks_on_evaluate_offline_end": null, "callbacks_on_sample_end": null, "callbacks_on_train_result": null, "explore": true, "enable_rl_module_and_learner": true, "enable_env_runner_and_connector_v2": true, "_prior_exploration_config": {"type": "StochasticSampling"}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x15d6f98a0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "offline_data_class": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_read_batch_size": null, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "materialize_data": false, "materialize_mapped_data": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "ignore_final_observation": false, "prelearner_class": null, "prelearner_buffer_class": null, "prelearner_buffer_kwargs": {}, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_remaining_data": false, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": 1, "evaluation_duration": 20, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_auto_duration_min_env_steps_per_sample": 100, "evaluation_auto_duration_max_env_steps_per_sample": 2000, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 1, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "offline_evaluation_interval": null, "num_offline_eval_runners": 0, "offline_loss_for_module_fn": null, "offline_evaluation_duration": 1, "offline_evaluation_parallel_to_training": false, "offline_evaluation_timeout_s": 120.0, "num_cpus_per_offline_eval_runner": 1, "num_gpus_per_offline_eval_runner": 0, "custom_resources_per_offline_eval_runner": {}, "restart_failed_offline_eval_runners": true, "ignore_offline_eval_runner_failures": false, "max_num_offline_eval_runner_restarts": 1000, "offline_eval_runner_restore_timeout_s": 1800.0, "max_requests_in_flight_per_offline_eval_runner": 1, "validate_offline_eval_runners_after_construction": true, "offline_eval_runner_health_probe_timeout_s": 30.0, "offline_eval_rl_module_inference_only": false, "broadcast_offline_eval_runner_states": false, "offline_eval_batch_size_per_runner": 256, "dataset_num_iters_per_eval_runner": 1, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "log_gradients": false, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 6, "restart_failed_env_runners": true, "ignore_env_runner_failures": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30.0, "env_runner_restore_timeout_s": 1800.0, "_model_config": {}, "_rl_module_spec": "MultiRLModuleSpec(multi_rl_module_class=<class 'ray.rllib.core.rl_module.multi_rl_module.MultiRLModule'>, observation_space=None, action_space=None, inference_only=False, model_config=None, rl_module_specs={'default_policy': RLModuleSpec(module_class=<class 'source.intrinsic_attention_ppo.rl_modules.DifferentiablePPOModule.DifferentiablePPOModule'>, observation_space=None, action_space=None, inference_only=False, learner_only=False, model_config={'vf_share_layers': True, 'embedding_dim': 62, 'max_seq_len': 3, 'policy_head_hidden_sizes': [32], 'value_head_hidden_sizes': [101], 'embedding_hidden_sizes': [121]}, catalog_class=None, load_state_path=None, model_config_dict=None), 'intrinsic_reward_module': RLModuleSpec(module_class=<class 'source.intrinsic_attention_ppo.rl_modules.IntrinsicAttentionModule.IntrinsicAttentionModule'>, observation_space=None, action_space=None, inference_only=False, learner_only=True, model_config={'intrinsic_reward_network': {'encoder_hidden_sizes': [], 'encoding_dim': 1, 'num_heads': 1, 'head_hidden_sizes': None, 'layers': [{'type': 'attention'}]}, 'extrinsic_value_hidden_layers': [127, 60], 'vf_share_layers': True, 'max_seq_len': 3}, catalog_class=None, load_state_path=None, model_config_dict=None)}, load_state_path=None, modules_to_load=None, module_specs={'default_policy': RLModuleSpec(module_class=<class 'source.intrinsic_attention_ppo.rl_modules.DifferentiablePPOModule.DifferentiablePPOModule'>, observation_space=None, action_space=None, inference_only=False, learner_only=False, model_config={'vf_share_layers': True, 'embedding_dim': 62, 'max_seq_len': 3, 'policy_head_hidden_sizes': [32], 'value_head_hidden_sizes': [101], 'embedding_hidden_sizes': [121]}, catalog_class=None, load_state_path=None, model_config_dict=None), 'intrinsic_reward_module': RLModuleSpec(module_class=<class 'source.intrinsic_attention_ppo.rl_modules.IntrinsicAttentionModule.IntrinsicAttentionModule'>, observation_space=None, action_space=None, inference_only=False, learner_only=True, model_config={'intrinsic_reward_network': {'encoder_hidden_sizes': [], 'encoding_dim': 1, 'num_heads': 1, 'head_hidden_sizes': None, 'layers': [{'type': 'attention'}]}, 'extrinsic_value_hidden_layers': [127, 60], 'vf_share_layers': True, 'max_seq_len': 3}, catalog_class=None, load_state_path=None, model_config_dict=None)})", "algorithm_config_overrides_per_module": {"intrinsic_reward_module": {"lr": 0.0002715581955}}, "_per_module_overrides": {}, "_validate_config": true, "_use_msgpack_checkpoints": false, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "env_task_fn": -1, "enable_connectors": -1, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.161583927863, "kl_target": 0.0201019014258, "vf_loss_coeff": 0.7790510010087, "entropy_coeff": 0.0015431216992, "clip_param": 0.2459212356676, "vf_clip_param": 0.3769744131561, "entropy_coeff_schedule": null, "lr_schedule": null, "sgd_minibatch_size": -1, "vf_share_layers": -1, "differentiable_learner_configs": ["DifferentiableLearnerConfig(learner_class=<class 'source.intrinsic_attention_ppo.learners.IntrinsicAttentionPPOLearner.IntrinsicAttentionPPOLearner'>, learner_connector=None, add_default_connectors_to_learner_pipeline=True, is_multi_agent=False, policies_to_update=['default_policy'], lr=0.0060984166342, num_total_minibatches=0, num_epochs=1, minibatch_size=1000, shuffle_batch_per_epoch=True)"], "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9485408017724, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.callbacks.callbacks.RLlibCallback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 71.81802225112915, "iterations_since_restore": 6, "perf": {"cpu_util_percent": 55.46315789473684, "ram_util_percent": 83.14736842105263}}
{"timers": {"training_iteration": 11.044874929412192, "restore_env_runners": 2.2414129926042024e-05, "training_step": 11.044581034300677, "env_runner_sampling_timer": 1.7579178753651192, "learner_update_timer": 9.074082385034814, "synch_weights": 0.0017510778720434092, "restore_eval_env_runners": 8.454212672133689e-05, "evaluation_iteration": 0.1381523981390999, "synch_eval_env_connectors": 0.00019540147378731808, "synch_env_connectors": 4.992907501235849e-06}, "env_runners": {"module_to_env_connector": {"timers": {"connectors": {"listify_data_for_vector_env": 1.970448660595326e-05, "normalize_and_clip_actions": 1.4352328590362777e-05, "get_actions": 9.579461285739401e-05, "tensor_to_numpy": 3.258313951958527e-05, "un_batch_to_individual_items": 1.1422722161078299e-05, "remove_single_ts_time_rank_from_batch": 1.9721234865652666e-05}}, "connector_pipeline_timer": 0.00024122279593166384}, "time_between_sampling": 0.04713146081255008, "env_to_module_sum_episodes_length_in": 10.36823839457432, "env_to_module_connector": {"timers": {"connectors": {"add_observations_from_episodes_to_batch": 5.112195777963989e-06, "numpy_to_tensor": 2.8290700145607027e-05, "batch_individual_items": 2.3688673042376616e-05, "add_states_from_episodes_to_batch": 4.690882229540544e-06, "add_time_dim_to_batch_and_zero_pad": 1.3809100458160116e-05}}, "connector_pipeline_timer": 0.0001143374174856914}, "num_agent_steps_sampled_lifetime": {"default_agent": -3077500.0}, "env_reset_timer": 8.228125616763513e-05, "episode_return_mean": 3.1399999999999992, "episode_return_min": -9.5, "env_to_module_sum_episodes_length_out": 10.36823839457432, "module_episode_returns_mean": {"default_policy": 3.1399999999999992}, "agent_episode_returns_mean": {"default_agent": 3.1399999999999992}, "episode_len_max": 20, "sample": 0.009999845436165316, "rlmodule_inference_timer": 7.225092687026651e-05, "episode_len_mean": 20.0, "num_env_steps_sampled": 5000.0, "weights_seq_no": 6.0, "num_agent_steps_sampled": {"default_agent": 5000.0}, "episode_return_max": 10.5, "num_episodes": 250.0, "num_module_steps_sampled": {"default_policy": 5000.0}, "env_step_timer": 3.087678014694776e-05, "num_module_steps_sampled_lifetime": {"default_policy": -3077500.0}, "episode_duration_sec_mean": 0.010875539029948412, "num_episodes_lifetime": -153875.0, "num_env_steps_sampled_lifetime": -3077500.0, "episode_len_min": 20, "num_env_steps_sampled_lifetime_throughput": 2027.5636461035497}, "__all_modules__": {"learner_connector_sum_episodes_length_in": 5000.0, "learner_connector": {"connector_pipeline_timer": 0.17282683866499943, "timers": {"connectors": {"add_one_ts_to_episodes_and_truncate": 0.00909583320603427, "add_observations_from_episodes_to_batch": 0.0008321056309272658, "add_columns_from_episodes_to_train_batch": 0.04180288881242076, "add_time_dim_to_batch_and_zero_pad": 0.10306099233538933, "add_states_from_episodes_to_batch": 0.003454284637719801, "batch_individual_items": 0.014363073981055642, "numpy_to_tensor": 7.243207177135672e-05}}}, "learner_connector_sum_episodes_length_out": 5250.0}, "learners": {"intrinsic_reward_module": {"gradients_default_optimizer_global_norm": 0.0, "num_module_steps_trained": 5994, "total_loss": 0.0, "num_trainable_parameters": 8266, "default_optimizer_learning_rate": 0.0002715581955, "curr_entropy_coeff": 0.0015431216992, "weights_seq_no": 7.0, "diff_num_grad_updates_vs_sampler_policy": 1.0, "num_module_steps_trained_lifetime": 41958, "module_train_batch_size_mean": 999.0, "num_module_steps_trained_lifetime_throughput": 645.6872058546129}, "__all_modules__": {"num_module_steps_trained_lifetime": 83916, "num_module_steps_trained": 11988, "num_non_trainable_parameters": 0, "num_env_steps_trained": 31500, "num_env_steps_trained_lifetime": 220500, "num_trainable_parameters": 24861, "num_env_steps_trained_lifetime_throughput": 3393.301488188299, "num_module_steps_trained_throughput": 24154950.283284448, "num_module_steps_trained_lifetime_throughput": 11464517.975938508}, "differentiable_learners": {"intrinsic_attention_ppo_learner": {"intrinsic_reward_module": {"diff_num_grad_updates_vs_sampler_policy": 36.0, "total_loss": 0.0, "num_module_steps_trained_lifetime": 251748, "num_module_steps_trained": 35964, "module_train_batch_size_mean": 999.0, "weights_seq_no": 42.0}, "default_policy": {"num_module_steps_trained_lifetime": 251748, "num_module_steps_trained": 35964, "module_train_batch_size_mean": 999.0, "vf_loss_unclipped": 38.77004623413086, "mean_kl_loss": 4.843124656872533e-07, "use_intrinsic_rewards": 1.0, "entropy": 0.6792131066322327, "policy_loss": -3.573570938897319e-05, "diff_num_grad_updates_vs_sampler_policy": 36.0, "total_loss": 0.2034415751695633, "vf_explained_var": 0.0027536749839782715, "weights_seq_no": 42.0, "vf_loss": 0.2625313997268677}, "__all_modules__": {"num_module_steps_trained_lifetime": 503496, "num_env_steps_trained": 189000, "num_env_steps_trained_lifetime": 1323000, "num_module_steps_trained": 71928, "num_env_steps_trained_lifetime_throughput": 43343.53432435034}}}, "default_policy": {"vf_loss_unclipped": 38.83281326293945, "mean_kl_loss": 5.344131182027922e-07, "curr_kl_coeff": 0.0012623744551092386, "curr_entropy_coeff": 0.0015431216992, "use_intrinsic_rewards": 0.0, "entropy": 0.6792059540748596, "policy_loss": -3.6603141779778525e-05, "diff_num_grad_updates_vs_sampler_policy": 1.0, "total_loss": 0.20336666703224182, "num_trainable_parameters": 16595, "vf_explained_var": 0.0002085566520690918, "weights_seq_no": 7.0, "vf_loss": 0.2624364197254181, "num_module_steps_trained_lifetime": 41958, "module_train_batch_size_mean": 999.0, "num_module_steps_trained": 5994, "num_module_steps_trained_lifetime_throughput": 645.6799106903823}, "IntrinsicAttentionMask": [[[0.33348798751831055, 0.33277255296707153, 0.33373942971229553], [0.3335108757019043, 0.3326895236968994, 0.3337996304035187], [0.33347997069358826, 0.3328017592430115, 0.33371832966804504]], [[0.3330901563167572, 0.33236706256866455, 0.33454272150993347], [0.3330543637275696, 0.33222559094429016, 0.33472001552581787], [0.33316174149513245, 0.33265042304992676, 0.33418789505958557]], [[0.3333224058151245, 0.3341468274593353, 0.33253076672554016], [0.3333250880241394, 0.33395546674728394, 0.3327194154262543], [0.3333197236061096, 0.33433103561401367, 0.33234918117523193]], [[0.33335843682289124, 0.33364295959472656, 0.3329986333847046], [0.33335447311401367, 0.3335939347743988, 0.3330515921115875], [0.33336341381073, 0.33370497822761536, 0.3329315483570099]], [[0.332118421792984, 0.33430588245391846, 0.33357569575309753], [0.3326491117477417, 0.33388081192970276, 0.33347004652023315], [0.3324722945690155, 0.3340223729610443, 0.3335052728652954]], [[0.33105650544166565, 0.33803102374076843, 0.3309124708175659], [0.33551180362701416, 0.3288356065750122, 0.335652619600296], [0.33096277713775635, 0.338224321603775, 0.33081284165382385]]]}, "num_training_step_calls_per_iteration": 1, "evaluation": {"env_runners": {"episode_len_max": 20, "rlmodule_inference_timer": 3.561020856787654e-05, "weights_seq_no": 7.0, "module_to_env_connector": {"timers": {"connectors": {"remove_single_ts_time_rank_from_batch": 1.2630583854486015e-05, "listify_data_for_vector_env": 1.1535659709569749e-05, "normalize_and_clip_actions": 8.656948922139104e-06, "get_actions": 4.300643379178166e-05, "tensor_to_numpy": 1.7361258175153885e-05, "un_batch_to_individual_items": 7.16592355436479e-06}}, "connector_pipeline_timer": 0.00012851749963814206}, "episode_return_max": 14.5, "num_episodes": 20, "num_episodes_lifetime": 140, "num_agent_steps_sampled_lifetime": {"default_agent": 2800}, "env_reset_timer": 0.0005499387924291638, "env_to_module_sum_episodes_length_out": 10.368238394572801, "num_module_steps_sampled_lifetime": {"default_policy": 2800}, "env_to_module_connector": {"timers": {"connectors": {"numpy_to_tensor": 1.3482653371851638e-05, "batch_individual_items": 1.3460929017951284e-05, "add_observations_from_episodes_to_batch": 3.064303244131368e-06, "add_states_from_episodes_to_batch": 3.136580711259513e-06, "add_time_dim_to_batch_and_zero_pad": 7.837275132996348e-06}}, "connector_pipeline_timer": 6.46964415711635e-05}, "episode_return_mean": 1.85, "sample": 0.12595565811401843, "episode_len_mean": 20.0, "env_step_timer": 1.5779386077112994e-05, "episode_duration_sec_mean": 0.0074388533364981415, "num_env_steps_sampled_lifetime": 35400, "agent_episode_returns_mean": {"default_agent": 1.85}, "num_env_steps_sampled": 400, "num_agent_steps_sampled": {"default_agent": 400}, "num_module_steps_sampled": {"default_policy": 400}, "episode_len_min": 20, "env_to_module_sum_episodes_length_in": 10.368238394572801, "module_episode_returns_mean": {"default_policy": 1.85}, "episode_return_min": -13.5, "time_between_sampling": 11.26350489135125}, "num_healthy_workers": 1, "actor_manager_num_outstanding_async_reqs": 0, "num_remote_worker_restarts": 0}, "num_env_steps_sampled_lifetime": -3077500.0, "fault_tolerance": {"num_healthy_workers": 0, "num_remote_worker_restarts": 0}, "env_runner_group": {"actor_manager_num_outstanding_async_reqs": 0}, "done": false, "training_iteration": 7, "trial_id": "ba99d_00000", "date": "2025-08-11_17-57-55", "timestamp": 1754927875, "time_this_iter_s": 13.443135023117065, "time_total_s": 85.26115727424622, "pid": 9655, "hostname": "Mac", "node_ip": "127.0.0.1", "config": {"exploration_config": {}, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 2, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "env": "Umbrella", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": false, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 0, "create_local_env_runner": true, "num_envs_per_env_runner": 1, "gym_env_vectorize_mode": "SYNC", "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "episodes_to_numpy": true, "max_requests_in_flight_per_env_runner": 1, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "merge_env_runner_states": "training_only", "broadcast_env_runner_states": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "complete_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "sampler_perf_stats_ema_coef": null, "_is_online": true, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": "auto", "num_aggregator_actors_per_learner": 0, "max_requests_in_flight_per_aggregator_actor": 3, "local_gpu_idx": 0, "max_requests_in_flight_per_learner": 3, "gamma": 1, "lr": 0.0002715581955, "grad_clip": 0.5, "grad_clip_by": "global_norm", "_train_batch_size_per_learner": 5000, "train_batch_size": 4000, "num_epochs": 1, "minibatch_size": 1000, "shuffle_batch_per_epoch": true, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "log_std_clip_param": 20.0, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "_disable_preprocessor_api": false, "_disable_action_flattening": false}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {"intrinsic_reward_coeff": 0.2795015916508}, "optimizer": {}, "_learner_class": "<class 'source.intrinsic_attention_ppo.learners.IntrinsicAttentionMetaLearner.IntrinsicAttentionMetaLearner'>", "callbacks_on_algorithm_init": null, "callbacks_on_env_runners_recreated": null, "callbacks_on_offline_eval_runners_recreated": null, "callbacks_on_checkpoint_loaded": null, "callbacks_on_environment_created": null, "callbacks_on_episode_created": null, "callbacks_on_episode_start": null, "callbacks_on_episode_step": null, "callbacks_on_episode_end": null, "callbacks_on_evaluate_start": null, "callbacks_on_evaluate_end": null, "callbacks_on_evaluate_offline_start": null, "callbacks_on_evaluate_offline_end": null, "callbacks_on_sample_end": null, "callbacks_on_train_result": null, "explore": true, "enable_rl_module_and_learner": true, "enable_env_runner_and_connector_v2": true, "_prior_exploration_config": {"type": "StochasticSampling"}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x15d6f98a0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "offline_data_class": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_read_batch_size": null, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "materialize_data": false, "materialize_mapped_data": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "ignore_final_observation": false, "prelearner_class": null, "prelearner_buffer_class": null, "prelearner_buffer_kwargs": {}, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_remaining_data": false, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": 1, "evaluation_duration": 20, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_auto_duration_min_env_steps_per_sample": 100, "evaluation_auto_duration_max_env_steps_per_sample": 2000, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 1, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "offline_evaluation_interval": null, "num_offline_eval_runners": 0, "offline_loss_for_module_fn": null, "offline_evaluation_duration": 1, "offline_evaluation_parallel_to_training": false, "offline_evaluation_timeout_s": 120.0, "num_cpus_per_offline_eval_runner": 1, "num_gpus_per_offline_eval_runner": 0, "custom_resources_per_offline_eval_runner": {}, "restart_failed_offline_eval_runners": true, "ignore_offline_eval_runner_failures": false, "max_num_offline_eval_runner_restarts": 1000, "offline_eval_runner_restore_timeout_s": 1800.0, "max_requests_in_flight_per_offline_eval_runner": 1, "validate_offline_eval_runners_after_construction": true, "offline_eval_runner_health_probe_timeout_s": 30.0, "offline_eval_rl_module_inference_only": false, "broadcast_offline_eval_runner_states": false, "offline_eval_batch_size_per_runner": 256, "dataset_num_iters_per_eval_runner": 1, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "log_gradients": false, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 6, "restart_failed_env_runners": true, "ignore_env_runner_failures": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30.0, "env_runner_restore_timeout_s": 1800.0, "_model_config": {}, "_rl_module_spec": "MultiRLModuleSpec(multi_rl_module_class=<class 'ray.rllib.core.rl_module.multi_rl_module.MultiRLModule'>, observation_space=None, action_space=None, inference_only=False, model_config=None, rl_module_specs={'default_policy': RLModuleSpec(module_class=<class 'source.intrinsic_attention_ppo.rl_modules.DifferentiablePPOModule.DifferentiablePPOModule'>, observation_space=None, action_space=None, inference_only=False, learner_only=False, model_config={'vf_share_layers': True, 'embedding_dim': 62, 'max_seq_len': 3, 'policy_head_hidden_sizes': [32], 'value_head_hidden_sizes': [101], 'embedding_hidden_sizes': [121]}, catalog_class=None, load_state_path=None, model_config_dict=None), 'intrinsic_reward_module': RLModuleSpec(module_class=<class 'source.intrinsic_attention_ppo.rl_modules.IntrinsicAttentionModule.IntrinsicAttentionModule'>, observation_space=None, action_space=None, inference_only=False, learner_only=True, model_config={'intrinsic_reward_network': {'encoder_hidden_sizes': [], 'encoding_dim': 1, 'num_heads': 1, 'head_hidden_sizes': None, 'layers': [{'type': 'attention'}]}, 'extrinsic_value_hidden_layers': [127, 60], 'vf_share_layers': True, 'max_seq_len': 3}, catalog_class=None, load_state_path=None, model_config_dict=None)}, load_state_path=None, modules_to_load=None, module_specs={'default_policy': RLModuleSpec(module_class=<class 'source.intrinsic_attention_ppo.rl_modules.DifferentiablePPOModule.DifferentiablePPOModule'>, observation_space=None, action_space=None, inference_only=False, learner_only=False, model_config={'vf_share_layers': True, 'embedding_dim': 62, 'max_seq_len': 3, 'policy_head_hidden_sizes': [32], 'value_head_hidden_sizes': [101], 'embedding_hidden_sizes': [121]}, catalog_class=None, load_state_path=None, model_config_dict=None), 'intrinsic_reward_module': RLModuleSpec(module_class=<class 'source.intrinsic_attention_ppo.rl_modules.IntrinsicAttentionModule.IntrinsicAttentionModule'>, observation_space=None, action_space=None, inference_only=False, learner_only=True, model_config={'intrinsic_reward_network': {'encoder_hidden_sizes': [], 'encoding_dim': 1, 'num_heads': 1, 'head_hidden_sizes': None, 'layers': [{'type': 'attention'}]}, 'extrinsic_value_hidden_layers': [127, 60], 'vf_share_layers': True, 'max_seq_len': 3}, catalog_class=None, load_state_path=None, model_config_dict=None)})", "algorithm_config_overrides_per_module": {"intrinsic_reward_module": {"lr": 0.0002715581955}}, "_per_module_overrides": {}, "_validate_config": true, "_use_msgpack_checkpoints": false, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "env_task_fn": -1, "enable_connectors": -1, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.161583927863, "kl_target": 0.0201019014258, "vf_loss_coeff": 0.7790510010087, "entropy_coeff": 0.0015431216992, "clip_param": 0.2459212356676, "vf_clip_param": 0.3769744131561, "entropy_coeff_schedule": null, "lr_schedule": null, "sgd_minibatch_size": -1, "vf_share_layers": -1, "differentiable_learner_configs": ["DifferentiableLearnerConfig(learner_class=<class 'source.intrinsic_attention_ppo.learners.IntrinsicAttentionPPOLearner.IntrinsicAttentionPPOLearner'>, learner_connector=None, add_default_connectors_to_learner_pipeline=True, is_multi_agent=False, policies_to_update=['default_policy'], lr=0.0060984166342, num_total_minibatches=0, num_epochs=1, minibatch_size=1000, shuffle_batch_per_epoch=True)"], "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9485408017724, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.callbacks.callbacks.RLlibCallback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 85.26115727424622, "iterations_since_restore": 7, "perf": {"cpu_util_percent": 56.96315789473685, "ram_util_percent": 83.34210526315789}}
{"timers": {"training_iteration": 11.060694078037821, "restore_env_runners": 2.2254989121723672e-05, "training_step": 11.060400801037863, "env_runner_sampling_timer": 1.7587546203610303, "learner_update_timer": 9.088898779104897, "synch_weights": 0.0017498437632443285, "restore_eval_env_runners": 8.54308758183395e-05, "evaluation_iteration": 0.13844937248683797, "synch_eval_env_connectors": 0.0001960974594372476, "synch_env_connectors": 4.987148727631065e-06}, "env_runners": {"module_to_env_connector": {"timers": {"connectors": {"listify_data_for_vector_env": 1.1412434082841671e-05, "normalize_and_clip_actions": 8.590614274732528e-06, "get_actions": 4.516997448421116e-05, "tensor_to_numpy": 1.678636418571955e-05, "un_batch_to_individual_items": 7.015398265241213e-06, "remove_single_ts_time_rank_from_batch": 1.254543889526489e-05}}, "connector_pipeline_timer": 0.00013047972434876396}, "time_between_sampling": 0.041509094006932944, "env_to_module_sum_episodes_length_in": 10.36823839457432, "env_to_module_connector": {"timers": {"connectors": {"add_observations_from_episodes_to_batch": 3.0464673059164247e-06, "numpy_to_tensor": 1.4134560976731192e-05, "batch_individual_items": 1.3692554988214131e-05, "add_states_from_episodes_to_batch": 2.936492631752838e-06, "add_time_dim_to_batch_and_zero_pad": 7.753702490178228e-06}}, "connector_pipeline_timer": 6.560393241629416e-05}, "num_agent_steps_sampled_lifetime": {"default_agent": -3695000.0}, "env_reset_timer": 6.200225981395988e-05, "episode_return_mean": 1.3799999999999994, "episode_return_min": -9.5, "env_to_module_sum_episodes_length_out": 10.36823839457432, "module_episode_returns_mean": {"default_policy": 1.3799999999999994}, "agent_episode_returns_mean": {"default_agent": 1.3799999999999994}, "episode_len_max": 20, "sample": 0.008036179233063998, "rlmodule_inference_timer": 6.432864369171955e-05, "episode_len_mean": 20.0, "num_env_steps_sampled": 5000.0, "weights_seq_no": 7.0, "num_agent_steps_sampled": {"default_agent": 5000.0}, "episode_return_max": 10.5, "num_episodes": 250.0, "num_module_steps_sampled": {"default_policy": 5000.0}, "env_step_timer": 1.555748331730341e-05, "num_module_steps_sampled_lifetime": {"default_policy": -3695000.0}, "episode_duration_sec_mean": 0.006381656182929874, "num_episodes_lifetime": -184750.0, "num_env_steps_sampled_lifetime": -3695000.0, "episode_len_min": 20, "num_env_steps_sampled_lifetime_throughput": 2907.192246991256}, "__all_modules__": {"learner_connector_sum_episodes_length_in": 5000.0, "learner_connector": {"connector_pipeline_timer": 0.17285722027832373, "timers": {"connectors": {"add_one_ts_to_episodes_and_truncate": 0.009094683624173082, "add_observations_from_episodes_to_batch": 0.0008324174843573831, "add_columns_from_episodes_to_train_batch": 0.041804539924346545, "add_time_dim_to_batch_and_zero_pad": 0.10309655158153404, "add_states_from_episodes_to_batch": 0.0034585688716221915, "batch_individual_items": 0.014352930740796932, "numpy_to_tensor": 7.25340006512373e-05}}}, "learner_connector_sum_episodes_length_out": 5250.0}, "learners": {"intrinsic_reward_module": {"gradients_default_optimizer_global_norm": 0.0, "num_module_steps_trained": 5994, "total_loss": 0.0, "num_trainable_parameters": 8266, "default_optimizer_learning_rate": 0.0002715581955, "curr_entropy_coeff": 0.0015431216992, "weights_seq_no": 8.0, "diff_num_grad_updates_vs_sampler_policy": 1.0, "num_module_steps_trained_lifetime": 47952, "module_train_batch_size_mean": 999.0, "num_module_steps_trained_lifetime_throughput": 641.515932659825}, "__all_modules__": {"num_module_steps_trained_lifetime": 95904, "num_module_steps_trained": 11988, "num_non_trainable_parameters": 0, "num_env_steps_trained": 31500, "num_env_steps_trained_lifetime": 252000, "num_trainable_parameters": 24861, "num_env_steps_trained_lifetime_throughput": 3371.378859462396, "num_module_steps_trained_throughput": 23496931.079875287, "num_module_steps_trained_lifetime_throughput": 11474752.881830554}, "differentiable_learners": {"intrinsic_attention_ppo_learner": {"intrinsic_reward_module": {"diff_num_grad_updates_vs_sampler_policy": 41.0, "total_loss": 0.0, "num_module_steps_trained_lifetime": 287712, "num_module_steps_trained": 35964, "module_train_batch_size_mean": 999.0, "weights_seq_no": 48.0}, "default_policy": {"num_module_steps_trained_lifetime": 287712, "num_module_steps_trained": 35964, "module_train_batch_size_mean": 999.0, "vf_loss_unclipped": 38.74673843383789, "mean_kl_loss": 3.551927193257143e-06, "use_intrinsic_rewards": 1.0, "entropy": 0.6787276864051819, "policy_loss": -0.00015746656572446227, "diff_num_grad_updates_vs_sampler_policy": 41.0, "total_loss": 0.20332986116409302, "vf_explained_var": 0.0027018189430236816, "weights_seq_no": 48.0, "vf_loss": 0.26254263520240784}, "__all_modules__": {"num_module_steps_trained_lifetime": 575424, "num_env_steps_trained": 189000, "num_env_steps_trained_lifetime": 1512000, "num_module_steps_trained": 71928, "num_env_steps_trained_lifetime_throughput": 42537.1287843692}}}, "default_policy": {"vf_loss_unclipped": 38.810462951660156, "mean_kl_loss": 4.236035238136537e-06, "curr_kl_coeff": 0.0006311872275546193, "curr_entropy_coeff": 0.0015431216992, "use_intrinsic_rewards": 0.0, "entropy": 0.6786866784095764, "policy_loss": -0.00017069868044927716, "diff_num_grad_updates_vs_sampler_policy": 1.0, "total_loss": 0.2032366394996643, "num_trainable_parameters": 16595, "vf_explained_var": 0.00022351741790771484, "weights_seq_no": 8.0, "vf_loss": 0.26244062185287476, "num_module_steps_trained_lifetime": 47952, "module_train_batch_size_mean": 999.0, "num_module_steps_trained": 5994, "num_module_steps_trained_lifetime_throughput": 641.5090502326075}, "IntrinsicAttentionMask": [[[0.3348350524902344, 0.33221808075904846, 0.3329468369483948], [0.336263507604599, 0.3311595022678375, 0.33257701992988586], [0.3358643054962158, 0.3314551115036011, 0.3326805830001831]], [[0.333452045917511, 0.33290308713912964, 0.33364489674568176], [0.33347490429878235, 0.33281999826431274, 0.3337050676345825], [0.3334439694881439, 0.3329322338104248, 0.3336237668991089]], [[0.33163926005363464, 0.33469000458717346, 0.3336707651615143], [0.3321695923805237, 0.334264874458313, 0.33356550335884094], [0.3319929242134094, 0.3344064950942993, 0.33360064029693604]], [[0.33390504121780396, 0.33341121673583984, 0.3326837122440338], [0.3340280055999756, 0.3334278464317322, 0.33254408836364746], [0.33420953154563904, 0.33345237374305725, 0.3323380649089813]], [[0.33362874388694763, 0.33346232771873474, 0.33290889859199524], [0.3336457312107086, 0.3334697186946869, 0.33288446068763733], [0.33370232582092285, 0.3334944248199463, 0.3328031599521637]], [[0.334904283285141, 0.3302820324897766, 0.3348137140274048], [0.34017980098724365, 0.3200441598892212, 0.33977609872817993], [0.3350076973438263, 0.33008119463920593, 0.33491113781929016]]]}, "num_training_step_calls_per_iteration": 1, "evaluation": {"env_runners": {"episode_len_max": 20, "rlmodule_inference_timer": 3.224674175480157e-05, "weights_seq_no": 8.0, "module_to_env_connector": {"timers": {"connectors": {"remove_single_ts_time_rank_from_batch": 1.1864030392881107e-05, "listify_data_for_vector_env": 1.0531466374854591e-05, "normalize_and_clip_actions": 7.909840057719296e-06, "get_actions": 3.7855501762740565e-05, "tensor_to_numpy": 1.552700407224996e-05, "un_batch_to_individual_items": 6.564343502250601e-06}}, "connector_pipeline_timer": 0.00011616583303304203}, "episode_return_max": 14.5, "num_episodes": 20, "num_episodes_lifetime": 160, "num_agent_steps_sampled_lifetime": {"default_agent": 3200}, "env_reset_timer": 0.0005476948146247633, "env_to_module_sum_episodes_length_out": 10.3682383945743, "num_module_steps_sampled_lifetime": {"default_policy": 3200}, "env_to_module_connector": {"timers": {"connectors": {"numpy_to_tensor": 1.2009332880195342e-05, "batch_individual_items": 1.2364519609733611e-05, "add_observations_from_episodes_to_batch": 2.8461185282999094e-06, "add_states_from_episodes_to_batch": 2.9045210485920184e-06, "add_time_dim_to_batch_and_zero_pad": 7.256344379329495e-06}}, "connector_pipeline_timer": 5.93329812582795e-05}, "episode_return_mean": 2.65, "sample": 0.12588399486323062, "episode_len_mean": 20.0, "env_step_timer": 1.4015343573862149e-05, "episode_duration_sec_mean": 0.007462194992695004, "num_env_steps_sampled_lifetime": 40400, "agent_episode_returns_mean": {"default_agent": 2.65}, "num_env_steps_sampled": 400, "num_agent_steps_sampled": {"default_agent": 400}, "num_module_steps_sampled": {"default_policy": 400}, "episode_len_min": 20, "env_to_module_sum_episodes_length_in": 10.3682383945743, "module_episode_returns_mean": {"default_policy": 2.65}, "episode_return_min": -13.5, "time_between_sampling": 11.277451473688185}, "num_healthy_workers": 1, "actor_manager_num_outstanding_async_reqs": 0, "num_remote_worker_restarts": 0}, "num_env_steps_sampled_lifetime": -3695000.0, "fault_tolerance": {"num_healthy_workers": 0, "num_remote_worker_restarts": 0}, "env_runner_group": {"actor_manager_num_outstanding_async_reqs": 0}, "done": false, "training_iteration": 8, "trial_id": "ba99d_00000", "date": "2025-08-11_17-58-08", "timestamp": 1754927888, "time_this_iter_s": 12.757588863372803, "time_total_s": 98.01874613761902, "pid": 9655, "hostname": "Mac", "node_ip": "127.0.0.1", "config": {"exploration_config": {}, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 2, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "env": "Umbrella", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": false, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 0, "create_local_env_runner": true, "num_envs_per_env_runner": 1, "gym_env_vectorize_mode": "SYNC", "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "episodes_to_numpy": true, "max_requests_in_flight_per_env_runner": 1, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "merge_env_runner_states": "training_only", "broadcast_env_runner_states": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "complete_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "sampler_perf_stats_ema_coef": null, "_is_online": true, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": "auto", "num_aggregator_actors_per_learner": 0, "max_requests_in_flight_per_aggregator_actor": 3, "local_gpu_idx": 0, "max_requests_in_flight_per_learner": 3, "gamma": 1, "lr": 0.0002715581955, "grad_clip": 0.5, "grad_clip_by": "global_norm", "_train_batch_size_per_learner": 5000, "train_batch_size": 4000, "num_epochs": 1, "minibatch_size": 1000, "shuffle_batch_per_epoch": true, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "log_std_clip_param": 20.0, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "_disable_preprocessor_api": false, "_disable_action_flattening": false}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {"intrinsic_reward_coeff": 0.2795015916508}, "optimizer": {}, "_learner_class": "<class 'source.intrinsic_attention_ppo.learners.IntrinsicAttentionMetaLearner.IntrinsicAttentionMetaLearner'>", "callbacks_on_algorithm_init": null, "callbacks_on_env_runners_recreated": null, "callbacks_on_offline_eval_runners_recreated": null, "callbacks_on_checkpoint_loaded": null, "callbacks_on_environment_created": null, "callbacks_on_episode_created": null, "callbacks_on_episode_start": null, "callbacks_on_episode_step": null, "callbacks_on_episode_end": null, "callbacks_on_evaluate_start": null, "callbacks_on_evaluate_end": null, "callbacks_on_evaluate_offline_start": null, "callbacks_on_evaluate_offline_end": null, "callbacks_on_sample_end": null, "callbacks_on_train_result": null, "explore": true, "enable_rl_module_and_learner": true, "enable_env_runner_and_connector_v2": true, "_prior_exploration_config": {"type": "StochasticSampling"}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x15d6f98a0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "offline_data_class": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_read_batch_size": null, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "materialize_data": false, "materialize_mapped_data": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "ignore_final_observation": false, "prelearner_class": null, "prelearner_buffer_class": null, "prelearner_buffer_kwargs": {}, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_remaining_data": false, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": 1, "evaluation_duration": 20, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_auto_duration_min_env_steps_per_sample": 100, "evaluation_auto_duration_max_env_steps_per_sample": 2000, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 1, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "offline_evaluation_interval": null, "num_offline_eval_runners": 0, "offline_loss_for_module_fn": null, "offline_evaluation_duration": 1, "offline_evaluation_parallel_to_training": false, "offline_evaluation_timeout_s": 120.0, "num_cpus_per_offline_eval_runner": 1, "num_gpus_per_offline_eval_runner": 0, "custom_resources_per_offline_eval_runner": {}, "restart_failed_offline_eval_runners": true, "ignore_offline_eval_runner_failures": false, "max_num_offline_eval_runner_restarts": 1000, "offline_eval_runner_restore_timeout_s": 1800.0, "max_requests_in_flight_per_offline_eval_runner": 1, "validate_offline_eval_runners_after_construction": true, "offline_eval_runner_health_probe_timeout_s": 30.0, "offline_eval_rl_module_inference_only": false, "broadcast_offline_eval_runner_states": false, "offline_eval_batch_size_per_runner": 256, "dataset_num_iters_per_eval_runner": 1, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "log_gradients": false, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 6, "restart_failed_env_runners": true, "ignore_env_runner_failures": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30.0, "env_runner_restore_timeout_s": 1800.0, "_model_config": {}, "_rl_module_spec": "MultiRLModuleSpec(multi_rl_module_class=<class 'ray.rllib.core.rl_module.multi_rl_module.MultiRLModule'>, observation_space=None, action_space=None, inference_only=False, model_config=None, rl_module_specs={'default_policy': RLModuleSpec(module_class=<class 'source.intrinsic_attention_ppo.rl_modules.DifferentiablePPOModule.DifferentiablePPOModule'>, observation_space=None, action_space=None, inference_only=False, learner_only=False, model_config={'vf_share_layers': True, 'embedding_dim': 62, 'max_seq_len': 3, 'policy_head_hidden_sizes': [32], 'value_head_hidden_sizes': [101], 'embedding_hidden_sizes': [121]}, catalog_class=None, load_state_path=None, model_config_dict=None), 'intrinsic_reward_module': RLModuleSpec(module_class=<class 'source.intrinsic_attention_ppo.rl_modules.IntrinsicAttentionModule.IntrinsicAttentionModule'>, observation_space=None, action_space=None, inference_only=False, learner_only=True, model_config={'intrinsic_reward_network': {'encoder_hidden_sizes': [], 'encoding_dim': 1, 'num_heads': 1, 'head_hidden_sizes': None, 'layers': [{'type': 'attention'}]}, 'extrinsic_value_hidden_layers': [127, 60], 'vf_share_layers': True, 'max_seq_len': 3}, catalog_class=None, load_state_path=None, model_config_dict=None)}, load_state_path=None, modules_to_load=None, module_specs={'default_policy': RLModuleSpec(module_class=<class 'source.intrinsic_attention_ppo.rl_modules.DifferentiablePPOModule.DifferentiablePPOModule'>, observation_space=None, action_space=None, inference_only=False, learner_only=False, model_config={'vf_share_layers': True, 'embedding_dim': 62, 'max_seq_len': 3, 'policy_head_hidden_sizes': [32], 'value_head_hidden_sizes': [101], 'embedding_hidden_sizes': [121]}, catalog_class=None, load_state_path=None, model_config_dict=None), 'intrinsic_reward_module': RLModuleSpec(module_class=<class 'source.intrinsic_attention_ppo.rl_modules.IntrinsicAttentionModule.IntrinsicAttentionModule'>, observation_space=None, action_space=None, inference_only=False, learner_only=True, model_config={'intrinsic_reward_network': {'encoder_hidden_sizes': [], 'encoding_dim': 1, 'num_heads': 1, 'head_hidden_sizes': None, 'layers': [{'type': 'attention'}]}, 'extrinsic_value_hidden_layers': [127, 60], 'vf_share_layers': True, 'max_seq_len': 3}, catalog_class=None, load_state_path=None, model_config_dict=None)})", "algorithm_config_overrides_per_module": {"intrinsic_reward_module": {"lr": 0.0002715581955}}, "_per_module_overrides": {}, "_validate_config": true, "_use_msgpack_checkpoints": false, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "env_task_fn": -1, "enable_connectors": -1, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.161583927863, "kl_target": 0.0201019014258, "vf_loss_coeff": 0.7790510010087, "entropy_coeff": 0.0015431216992, "clip_param": 0.2459212356676, "vf_clip_param": 0.3769744131561, "entropy_coeff_schedule": null, "lr_schedule": null, "sgd_minibatch_size": -1, "vf_share_layers": -1, "differentiable_learner_configs": ["DifferentiableLearnerConfig(learner_class=<class 'source.intrinsic_attention_ppo.learners.IntrinsicAttentionPPOLearner.IntrinsicAttentionPPOLearner'>, learner_connector=None, add_default_connectors_to_learner_pipeline=True, is_multi_agent=False, policies_to_update=['default_policy'], lr=0.0060984166342, num_total_minibatches=0, num_epochs=1, minibatch_size=1000, shuffle_batch_per_epoch=True)"], "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9485408017724, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.callbacks.callbacks.RLlibCallback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 98.01874613761902, "iterations_since_restore": 8, "perf": {"cpu_util_percent": 49.96666666666667, "ram_util_percent": 83.29444444444445}}
{"timers": {"training_iteration": 11.062033015177812, "restore_env_runners": 2.209576916558029e-05, "training_step": 11.061740255946928, "env_runner_sampling_timer": 1.757970825406519, "learner_update_timer": 9.08882386673376, "synch_weights": 0.001748084075255673, "restore_eval_env_runners": 8.510614734406614e-05, "evaluation_iteration": 0.13834258459225865, "synch_eval_env_connectors": 0.00019590064379399372, "synch_env_connectors": 4.993936577487924e-06}, "env_runners": {"module_to_env_connector": {"timers": {"connectors": {"listify_data_for_vector_env": 1.1165160011914418e-05, "normalize_and_clip_actions": 8.668258422101512e-06, "get_actions": 4.420343323187981e-05, "tensor_to_numpy": 1.675834114327865e-05, "un_batch_to_individual_items": 7.125276369388443e-06, "remove_single_ts_time_rank_from_batch": 1.2442904342670586e-05}}, "connector_pipeline_timer": 0.00012924105290070695}, "time_between_sampling": 0.0440782293245871, "env_to_module_sum_episodes_length_in": 10.36823839457432, "env_to_module_connector": {"timers": {"connectors": {"add_observations_from_episodes_to_batch": 3.0729494509922913e-06, "numpy_to_tensor": 1.3915270192671428e-05, "batch_individual_items": 1.3459542660251944e-05, "add_states_from_episodes_to_batch": 2.9068194570728974e-06, "add_time_dim_to_batch_and_zero_pad": 7.540191595896381e-06}}, "connector_pipeline_timer": 6.473722675522128e-05}, "num_agent_steps_sampled_lifetime": {"default_agent": -4312500.0}, "env_reset_timer": 4.81373789773824e-05, "episode_return_mean": 0.8199999999999998, "episode_return_min": -9.5, "env_to_module_sum_episodes_length_out": 10.36823839457432, "module_episode_returns_mean": {"default_policy": 0.8199999999999998}, "agent_episode_returns_mean": {"default_agent": 0.8199999999999998}, "episode_len_max": 20, "sample": 0.0065807443882622925, "rlmodule_inference_timer": 3.516147767453248e-05, "episode_len_mean": 20.0, "num_env_steps_sampled": 5000.0, "weights_seq_no": 8.0, "num_agent_steps_sampled": {"default_agent": 5000.0}, "episode_return_max": 10.5, "num_episodes": 250.0, "num_module_steps_sampled": {"default_policy": 5000.0}, "env_step_timer": 1.5269030817588525e-05, "num_module_steps_sampled_lifetime": {"default_policy": -4312500.0}, "episode_duration_sec_mean": 0.005756656323093923, "num_episodes_lifetime": -215625.0, "num_env_steps_sampled_lifetime": -4312500.0, "episode_len_min": 20, "num_env_steps_sampled_lifetime_throughput": 3020.9157897848677}, "__all_modules__": {"learner_connector_sum_episodes_length_in": 5000.0, "learner_connector": {"connector_pipeline_timer": 0.17491293432496946, "timers": {"connectors": {"add_one_ts_to_episodes_and_truncate": 0.009108599288379132, "add_observations_from_episodes_to_batch": 0.0008334003896951248, "add_columns_from_episodes_to_train_batch": 0.04180458577498812, "add_time_dim_to_batch_and_zero_pad": 0.10321638565611446, "add_states_from_episodes_to_batch": 0.003471006513022614, "batch_individual_items": 0.016260987263438553, "numpy_to_tensor": 7.285658131322261e-05}}}, "learner_connector_sum_episodes_length_out": 5250.0}, "learners": {"intrinsic_reward_module": {"gradients_default_optimizer_global_norm": 0.0, "num_module_steps_trained": 5994, "total_loss": 0.0, "num_trainable_parameters": 8266, "default_optimizer_learning_rate": 0.0002715581955, "curr_entropy_coeff": 0.0015431216992, "weights_seq_no": 9.0, "diff_num_grad_updates_vs_sampler_policy": 1.0, "num_module_steps_trained_lifetime": 53946, "module_train_batch_size_mean": 999.0, "num_module_steps_trained_lifetime_throughput": 638.1605595554031}, "__all_modules__": {"num_module_steps_trained_lifetime": 107892, "num_module_steps_trained": 11988, "num_non_trainable_parameters": 0, "num_env_steps_trained": 31500, "num_env_steps_trained_lifetime": 283500, "num_trainable_parameters": 24861, "num_env_steps_trained_lifetime_throughput": 3353.7438649791807, "num_module_steps_trained_throughput": 22881199.827104516, "num_module_steps_trained_lifetime_throughput": 11484116.614863131}, "differentiable_learners": {"intrinsic_attention_ppo_learner": {"intrinsic_reward_module": {"diff_num_grad_updates_vs_sampler_policy": 46.0, "total_loss": 0.0, "num_module_steps_trained_lifetime": 323676, "num_module_steps_trained": 35964, "module_train_batch_size_mean": 999.0, "weights_seq_no": 54.0}, "default_policy": {"num_module_steps_trained_lifetime": 323676, "num_module_steps_trained": 35964, "module_train_batch_size_mean": 999.0, "vf_loss_unclipped": 39.118160247802734, "mean_kl_loss": 6.644675977440784e-06, "use_intrinsic_rewards": 1.0, "entropy": 0.6782407164573669, "policy_loss": -9.393692016601562e-05, "diff_num_grad_updates_vs_sampler_policy": 46.0, "total_loss": 0.20338042080402374, "vf_explained_var": 0.0025725960731506348, "weights_seq_no": 54.0, "vf_loss": 0.26252439618110657}, "__all_modules__": {"num_module_steps_trained_lifetime": 647352, "num_env_steps_trained": 189000, "num_env_steps_trained_lifetime": 1701000, "num_module_steps_trained": 71928, "num_env_steps_trained_lifetime_throughput": 41743.94206690754}}}, "default_policy": {"vf_loss_unclipped": 39.188926696777344, "mean_kl_loss": 7.063563771225745e-06, "curr_kl_coeff": 0.00031559361377730966, "curr_entropy_coeff": 0.0015431216992, "use_intrinsic_rewards": 0.0, "entropy": 0.6782215237617493, "policy_loss": -9.799680265132338e-05, "diff_num_grad_updates_vs_sampler_policy": 1.0, "total_loss": 0.20331135392189026, "num_trainable_parameters": 16595, "vf_explained_var": 0.00034743547439575195, "weights_seq_no": 9.0, "vf_loss": 0.26244229078292847, "num_module_steps_trained_lifetime": 53946, "module_train_batch_size_mean": 999.0, "num_module_steps_trained": 5994, "num_module_steps_trained_lifetime_throughput": 638.154068998574}, "IntrinsicAttentionMask": [[[0.3327001929283142, 0.33316588401794434, 0.33413389325141907], [0.33276131749153137, 0.33318209648132324, 0.3340565860271454], [0.33288806676864624, 0.3332156836986542, 0.3338962495326996]], [[0.3334019184112549, 0.33308473229408264, 0.3335132896900177], [0.333424836397171, 0.33300164341926575, 0.33357349038124084], [0.3333938717842102, 0.3331139087677002, 0.3334921896457672]], [[0.33245572447776794, 0.33481377363204956, 0.3327305018901825], [0.3328120708465576, 0.3342124819755554, 0.33297547698020935], [0.33249735832214355, 0.3347434401512146, 0.33275914192199707]], [[0.33363625407218933, 0.3333747088909149, 0.3329890966415405], [0.3337591886520386, 0.3333914279937744, 0.332849383354187], [0.33394065499305725, 0.33341604471206665, 0.3326432704925537]], [[0.3322586119174957, 0.335146427154541, 0.3325949013233185], [0.33261507749557495, 0.334544837474823, 0.33284008502960205], [0.3323003053665161, 0.33507609367370605, 0.33262360095977783]], [[0.3341822326183319, 0.33168426156044006, 0.33413344621658325], [0.33946841955184937, 0.32142379879951477, 0.33910778164863586], [0.3342858850955963, 0.33148303627967834, 0.33423110842704773]]]}, "num_training_step_calls_per_iteration": 1, "evaluation": {"env_runners": {"episode_len_max": 20, "rlmodule_inference_timer": 3.1549711776081724e-05, "weights_seq_no": 9.0, "module_to_env_connector": {"timers": {"connectors": {"remove_single_ts_time_rank_from_batch": 1.1817134511252123e-05, "listify_data_for_vector_env": 1.053159008082179e-05, "normalize_and_clip_actions": 7.875612965831882e-06, "get_actions": 3.75559724806844e-05, "tensor_to_numpy": 1.547150488113804e-05, "un_batch_to_individual_items": 6.515593739736073e-06}}, "connector_pipeline_timer": 0.00011571090767486919}, "episode_return_max": 14.5, "num_episodes": 20, "num_episodes_lifetime": 180, "num_agent_steps_sampled_lifetime": {"default_agent": 3600}, "env_reset_timer": 0.000545459117002813, "env_to_module_sum_episodes_length_out": 10.368238394574323, "num_module_steps_sampled_lifetime": {"default_policy": 3600}, "env_to_module_connector": {"timers": {"connectors": {"numpy_to_tensor": 1.199500313664852e-05, "batch_individual_items": 1.2486890032835834e-05, "add_observations_from_episodes_to_batch": 2.8085905080274053e-06, "add_states_from_episodes_to_batch": 2.9304933610854547e-06, "add_time_dim_to_batch_and_zero_pad": 7.173933870968318e-06}}, "connector_pipeline_timer": 5.941851122362342e-05}, "episode_return_mean": 3.05, "sample": 0.1257842136645069, "episode_len_mean": 20.0, "env_step_timer": 1.3825926031338718e-05, "episode_duration_sec_mean": 0.007310205821413547, "num_env_steps_sampled_lifetime": 45400, "agent_episode_returns_mean": {"default_agent": 3.05}, "num_env_steps_sampled": 400, "num_agent_steps_sampled": {"default_agent": 400}, "num_module_steps_sampled": {"default_policy": 400}, "episode_len_min": 20, "env_to_module_sum_episodes_length_in": 10.368238394574323, "module_episode_returns_mean": {"default_policy": 3.05}, "episode_return_min": -13.5, "time_between_sampling": 11.2769628468716}, "num_healthy_workers": 1, "actor_manager_num_outstanding_async_reqs": 0, "num_remote_worker_restarts": 0}, "num_env_steps_sampled_lifetime": -4312500.0, "fault_tolerance": {"num_healthy_workers": 0, "num_remote_worker_restarts": 0}, "env_runner_group": {"actor_manager_num_outstanding_async_reqs": 0}, "done": false, "training_iteration": 9, "trial_id": "ba99d_00000", "date": "2025-08-11_17-58-19", "timestamp": 1754927899, "time_this_iter_s": 11.323678970336914, "time_total_s": 109.34242510795593, "pid": 9655, "hostname": "Mac", "node_ip": "127.0.0.1", "config": {"exploration_config": {}, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 2, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "env": "Umbrella", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": false, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 0, "create_local_env_runner": true, "num_envs_per_env_runner": 1, "gym_env_vectorize_mode": "SYNC", "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "episodes_to_numpy": true, "max_requests_in_flight_per_env_runner": 1, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "merge_env_runner_states": "training_only", "broadcast_env_runner_states": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "complete_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "sampler_perf_stats_ema_coef": null, "_is_online": true, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": "auto", "num_aggregator_actors_per_learner": 0, "max_requests_in_flight_per_aggregator_actor": 3, "local_gpu_idx": 0, "max_requests_in_flight_per_learner": 3, "gamma": 1, "lr": 0.0002715581955, "grad_clip": 0.5, "grad_clip_by": "global_norm", "_train_batch_size_per_learner": 5000, "train_batch_size": 4000, "num_epochs": 1, "minibatch_size": 1000, "shuffle_batch_per_epoch": true, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "log_std_clip_param": 20.0, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "_disable_preprocessor_api": false, "_disable_action_flattening": false}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {"intrinsic_reward_coeff": 0.2795015916508}, "optimizer": {}, "_learner_class": "<class 'source.intrinsic_attention_ppo.learners.IntrinsicAttentionMetaLearner.IntrinsicAttentionMetaLearner'>", "callbacks_on_algorithm_init": null, "callbacks_on_env_runners_recreated": null, "callbacks_on_offline_eval_runners_recreated": null, "callbacks_on_checkpoint_loaded": null, "callbacks_on_environment_created": null, "callbacks_on_episode_created": null, "callbacks_on_episode_start": null, "callbacks_on_episode_step": null, "callbacks_on_episode_end": null, "callbacks_on_evaluate_start": null, "callbacks_on_evaluate_end": null, "callbacks_on_evaluate_offline_start": null, "callbacks_on_evaluate_offline_end": null, "callbacks_on_sample_end": null, "callbacks_on_train_result": null, "explore": true, "enable_rl_module_and_learner": true, "enable_env_runner_and_connector_v2": true, "_prior_exploration_config": {"type": "StochasticSampling"}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x15d6f98a0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "offline_data_class": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_read_batch_size": null, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "materialize_data": false, "materialize_mapped_data": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "ignore_final_observation": false, "prelearner_class": null, "prelearner_buffer_class": null, "prelearner_buffer_kwargs": {}, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_remaining_data": false, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": 1, "evaluation_duration": 20, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_auto_duration_min_env_steps_per_sample": 100, "evaluation_auto_duration_max_env_steps_per_sample": 2000, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 1, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "offline_evaluation_interval": null, "num_offline_eval_runners": 0, "offline_loss_for_module_fn": null, "offline_evaluation_duration": 1, "offline_evaluation_parallel_to_training": false, "offline_evaluation_timeout_s": 120.0, "num_cpus_per_offline_eval_runner": 1, "num_gpus_per_offline_eval_runner": 0, "custom_resources_per_offline_eval_runner": {}, "restart_failed_offline_eval_runners": true, "ignore_offline_eval_runner_failures": false, "max_num_offline_eval_runner_restarts": 1000, "offline_eval_runner_restore_timeout_s": 1800.0, "max_requests_in_flight_per_offline_eval_runner": 1, "validate_offline_eval_runners_after_construction": true, "offline_eval_runner_health_probe_timeout_s": 30.0, "offline_eval_rl_module_inference_only": false, "broadcast_offline_eval_runner_states": false, "offline_eval_batch_size_per_runner": 256, "dataset_num_iters_per_eval_runner": 1, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "log_gradients": false, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 6, "restart_failed_env_runners": true, "ignore_env_runner_failures": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30.0, "env_runner_restore_timeout_s": 1800.0, "_model_config": {}, "_rl_module_spec": "MultiRLModuleSpec(multi_rl_module_class=<class 'ray.rllib.core.rl_module.multi_rl_module.MultiRLModule'>, observation_space=None, action_space=None, inference_only=False, model_config=None, rl_module_specs={'default_policy': RLModuleSpec(module_class=<class 'source.intrinsic_attention_ppo.rl_modules.DifferentiablePPOModule.DifferentiablePPOModule'>, observation_space=None, action_space=None, inference_only=False, learner_only=False, model_config={'vf_share_layers': True, 'embedding_dim': 62, 'max_seq_len': 3, 'policy_head_hidden_sizes': [32], 'value_head_hidden_sizes': [101], 'embedding_hidden_sizes': [121]}, catalog_class=None, load_state_path=None, model_config_dict=None), 'intrinsic_reward_module': RLModuleSpec(module_class=<class 'source.intrinsic_attention_ppo.rl_modules.IntrinsicAttentionModule.IntrinsicAttentionModule'>, observation_space=None, action_space=None, inference_only=False, learner_only=True, model_config={'intrinsic_reward_network': {'encoder_hidden_sizes': [], 'encoding_dim': 1, 'num_heads': 1, 'head_hidden_sizes': None, 'layers': [{'type': 'attention'}]}, 'extrinsic_value_hidden_layers': [127, 60], 'vf_share_layers': True, 'max_seq_len': 3}, catalog_class=None, load_state_path=None, model_config_dict=None)}, load_state_path=None, modules_to_load=None, module_specs={'default_policy': RLModuleSpec(module_class=<class 'source.intrinsic_attention_ppo.rl_modules.DifferentiablePPOModule.DifferentiablePPOModule'>, observation_space=None, action_space=None, inference_only=False, learner_only=False, model_config={'vf_share_layers': True, 'embedding_dim': 62, 'max_seq_len': 3, 'policy_head_hidden_sizes': [32], 'value_head_hidden_sizes': [101], 'embedding_hidden_sizes': [121]}, catalog_class=None, load_state_path=None, model_config_dict=None), 'intrinsic_reward_module': RLModuleSpec(module_class=<class 'source.intrinsic_attention_ppo.rl_modules.IntrinsicAttentionModule.IntrinsicAttentionModule'>, observation_space=None, action_space=None, inference_only=False, learner_only=True, model_config={'intrinsic_reward_network': {'encoder_hidden_sizes': [], 'encoding_dim': 1, 'num_heads': 1, 'head_hidden_sizes': None, 'layers': [{'type': 'attention'}]}, 'extrinsic_value_hidden_layers': [127, 60], 'vf_share_layers': True, 'max_seq_len': 3}, catalog_class=None, load_state_path=None, model_config_dict=None)})", "algorithm_config_overrides_per_module": {"intrinsic_reward_module": {"lr": 0.0002715581955}}, "_per_module_overrides": {}, "_validate_config": true, "_use_msgpack_checkpoints": false, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "env_task_fn": -1, "enable_connectors": -1, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.161583927863, "kl_target": 0.0201019014258, "vf_loss_coeff": 0.7790510010087, "entropy_coeff": 0.0015431216992, "clip_param": 0.2459212356676, "vf_clip_param": 0.3769744131561, "entropy_coeff_schedule": null, "lr_schedule": null, "sgd_minibatch_size": -1, "vf_share_layers": -1, "differentiable_learner_configs": ["DifferentiableLearnerConfig(learner_class=<class 'source.intrinsic_attention_ppo.learners.IntrinsicAttentionPPOLearner.IntrinsicAttentionPPOLearner'>, learner_connector=None, add_default_connectors_to_learner_pipeline=True, is_multi_agent=False, policies_to_update=['default_policy'], lr=0.0060984166342, num_total_minibatches=0, num_epochs=1, minibatch_size=1000, shuffle_batch_per_epoch=True)"], "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9485408017724, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.callbacks.callbacks.RLlibCallback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 109.34242510795593, "iterations_since_restore": 9, "perf": {"cpu_util_percent": 41.65625, "ram_util_percent": 83.09375}}
{"timers": {"training_iteration": 11.071906756275883, "restore_env_runners": 2.1935641972038713e-05, "training_step": 11.071611720057515, "env_runner_sampling_timer": 1.7560871596526573, "learner_update_timer": 9.100420370986336, "synch_weights": 0.0017524824034289232, "restore_eval_env_runners": 8.467425553500842e-05, "evaluation_iteration": 0.13822002166723502, "synch_eval_env_connectors": 0.0001955220568405797, "synch_env_connectors": 4.98816751312062e-06}, "env_runners": {"module_to_env_connector": {"timers": {"connectors": {"listify_data_for_vector_env": 1.0741341568519934e-05, "normalize_and_clip_actions": 8.07603784564235e-06, "get_actions": 4.046286940449226e-05, "tensor_to_numpy": 1.5480332210714488e-05, "un_batch_to_individual_items": 6.767685395033968e-06, "remove_single_ts_time_rank_from_batch": 1.2064925457490925e-05}}, "connector_pipeline_timer": 0.0001208148829129307}, "time_between_sampling": 0.03955873028796418, "env_to_module_sum_episodes_length_in": 10.36823839457432, "env_to_module_connector": {"timers": {"connectors": {"add_observations_from_episodes_to_batch": 2.82960829642305e-06, "numpy_to_tensor": 1.259265832860347e-05, "batch_individual_items": 1.27456939004869e-05, "add_states_from_episodes_to_batch": 2.7808035357561844e-06, "add_time_dim_to_batch_and_zero_pad": 7.033189615579595e-06}}, "connector_pipeline_timer": 6.075078030849832e-05}, "num_agent_steps_sampled_lifetime": {"default_agent": -4930000.0}, "env_reset_timer": 4.2829599462662194e-05, "episode_return_mean": 1.8600000000000003, "episode_return_min": -9.5, "env_to_module_sum_episodes_length_out": 10.36823839457432, "module_episode_returns_mean": {"default_policy": 1.8600000000000003}, "agent_episode_returns_mean": {"default_agent": 1.8600000000000003}, "episode_len_max": 20, "sample": 0.005919839442149425, "rlmodule_inference_timer": 3.280462313146604e-05, "episode_len_mean": 20.0, "num_env_steps_sampled": 5000.0, "weights_seq_no": 9.0, "num_agent_steps_sampled": {"default_agent": 5000.0}, "episode_return_max": 10.5, "num_episodes": 250.0, "num_module_steps_sampled": {"default_policy": 5000.0}, "env_step_timer": 1.409692925412151e-05, "num_module_steps_sampled_lifetime": {"default_policy": -4930000.0}, "episode_duration_sec_mean": 0.005391141348052769, "num_episodes_lifetime": -246500.0, "num_env_steps_sampled_lifetime": -4930000.0, "episode_len_min": 20, "num_env_steps_sampled_lifetime_throughput": 3175.836447909341}, "__all_modules__": {"learner_connector_sum_episodes_length_in": 5000.0, "learner_connector": {"connector_pipeline_timer": 0.1749295212310758, "timers": {"connectors": {"add_one_ts_to_episodes_and_truncate": 0.009106415376392582, "add_observations_from_episodes_to_batch": 0.0008337976362165236, "add_columns_from_episodes_to_train_batch": 0.041799192417910504, "add_time_dim_to_batch_and_zero_pad": 0.10323291720968945, "add_states_from_episodes_to_batch": 0.0034954868578488878, "batch_individual_items": 0.01624366281138959, "numpy_to_tensor": 7.305718555540529e-05}}}, "learner_connector_sum_episodes_length_out": 5250.0}, "learners": {"intrinsic_reward_module": {"gradients_default_optimizer_global_norm": 0.0, "num_module_steps_trained": 5994, "total_loss": 0.0, "num_trainable_parameters": 8266, "default_optimizer_learning_rate": 0.0002715581955, "curr_entropy_coeff": 0.0015431216992, "weights_seq_no": 10.0, "diff_num_grad_updates_vs_sampler_policy": 1.0, "num_module_steps_trained_lifetime": 59940, "module_train_batch_size_mean": 999.0, "num_module_steps_trained_lifetime_throughput": 634.5330340699447}, "__all_modules__": {"num_module_steps_trained_lifetime": 119880, "num_module_steps_trained": 11988, "num_non_trainable_parameters": 0, "num_env_steps_trained": 31500, "num_env_steps_trained_lifetime": 315000, "num_trainable_parameters": 24861, "num_env_steps_trained_lifetime_throughput": 3334.678553745381, "num_module_steps_trained_throughput": 22306988.897179224, "num_module_steps_trained_lifetime_throughput": 11518336.367057884}, "differentiable_learners": {"intrinsic_attention_ppo_learner": {"intrinsic_reward_module": {"diff_num_grad_updates_vs_sampler_policy": 51.0, "total_loss": 0.0, "num_module_steps_trained_lifetime": 359640, "num_module_steps_trained": 35964, "module_train_batch_size_mean": 999.0, "weights_seq_no": 60.0}, "default_policy": {"num_module_steps_trained_lifetime": 359640, "num_module_steps_trained": 35964, "module_train_batch_size_mean": 999.0, "vf_loss_unclipped": 38.118804931640625, "mean_kl_loss": 1.094430081138853e-05, "use_intrinsic_rewards": 1.0, "entropy": 0.6769599914550781, "policy_loss": -0.0003607977705541998, "diff_num_grad_updates_vs_sampler_policy": 51.0, "total_loss": 0.20310547947883606, "vf_explained_var": 0.002665996551513672, "weights_seq_no": 60.0, "vf_loss": 0.2625105679035187}, "__all_modules__": {"num_module_steps_trained_lifetime": 719280, "num_env_steps_trained": 189000, "num_env_steps_trained_lifetime": 1890000, "num_module_steps_trained": 71928, "num_env_steps_trained_lifetime_throughput": 40975.47204258734}}}, "default_policy": {"vf_loss_unclipped": 38.20036697387695, "mean_kl_loss": 1.2648338270082604e-05, "curr_kl_coeff": 0.00015779680688865483, "curr_entropy_coeff": 0.0015431216992, "use_intrinsic_rewards": 0.0, "entropy": 0.6768966913223267, "policy_loss": -0.00038642087019979954, "diff_num_grad_updates_vs_sampler_policy": 1.0, "total_loss": 0.20302051305770874, "num_trainable_parameters": 16595, "vf_explained_var": 1.5437602996826172e-05, "weights_seq_no": 10.0, "vf_loss": 0.26243653893470764, "num_module_steps_trained_lifetime": 59940, "module_train_batch_size_mean": 999.0, "num_module_steps_trained": 5994, "num_module_steps_trained_lifetime_throughput": 634.5269148315728}, "IntrinsicAttentionMask": [[[0.33348798751831055, 0.33277255296707153, 0.33373942971229553], [0.3335108757019043, 0.3326895236968994, 0.3337996304035187], [0.33347997069358826, 0.3328017592430115, 0.33371832966804504]], [[0.33357664942741394, 0.33325931429862976, 0.3331640362739563], [0.33365803956985474, 0.3332345485687256, 0.33310744166374207], [0.33368247747421265, 0.33322709798812866, 0.3330904245376587]], [[0.3321961462497711, 0.3352520167827606, 0.33255189657211304], [0.33255261182785034, 0.33465030789375305, 0.3327971398830414], [0.33223778009414673, 0.3351816236972809, 0.33258056640625]], [[0.3339049816131592, 0.3325972557067871, 0.3334977626800537], [0.3342309594154358, 0.33217793703079224, 0.33359113335609436], [0.3340063691139221, 0.33246684074401855, 0.3335268497467041]], [[0.3330192267894745, 0.3337673544883728, 0.3332134187221527], [0.3331005573272705, 0.3336549699306488, 0.3332445025444031], [0.33304035663604736, 0.33373814821243286, 0.3332214951515198]], [[0.334904283285141, 0.3302820324897766, 0.3348137140274048], [0.34017980098724365, 0.3200441598892212, 0.33977609872817993], [0.3350076973438263, 0.33008119463920593, 0.33491113781929016]]]}, "num_training_step_calls_per_iteration": 1, "evaluation": {"env_runners": {"episode_len_max": 20, "rlmodule_inference_timer": 3.599587398373354e-05, "weights_seq_no": 10.0, "module_to_env_connector": {"timers": {"connectors": {"remove_single_ts_time_rank_from_batch": 1.2353022592288914e-05, "listify_data_for_vector_env": 1.118391940639904e-05, "normalize_and_clip_actions": 8.44551884359037e-06, "get_actions": 4.264796485055585e-05, "tensor_to_numpy": 1.6516497784936534e-05, "un_batch_to_individual_items": 6.865438857757026e-06}}, "connector_pipeline_timer": 0.00012556957818545886}, "episode_return_max": 14.5, "num_episodes": 20, "num_episodes_lifetime": 200, "num_agent_steps_sampled_lifetime": {"default_agent": 4000}, "env_reset_timer": 0.0005432961853555865, "env_to_module_sum_episodes_length_out": 10.368238394574323, "num_module_steps_sampled_lifetime": {"default_policy": 4000}, "env_to_module_connector": {"timers": {"connectors": {"numpy_to_tensor": 1.3029007654371444e-05, "batch_individual_items": 1.3200301851266893e-05, "add_observations_from_episodes_to_batch": 2.9984787952182584e-06, "add_states_from_episodes_to_batch": 3.3665203051132578e-06, "add_time_dim_to_batch_and_zero_pad": 7.5879337687820294e-06}}, "connector_pipeline_timer": 6.396411847735488e-05}, "episode_return_mean": 1.85, "sample": 0.12583879110792467, "episode_len_mean": 20.0, "env_step_timer": 1.5341940790645495e-05, "episode_duration_sec_mean": 0.007390076217707247, "num_env_steps_sampled_lifetime": 50400, "agent_episode_returns_mean": {"default_agent": 1.85}, "num_env_steps_sampled": 400, "num_agent_steps_sampled": {"default_agent": 400}, "num_module_steps_sampled": {"default_policy": 400}, "episode_len_min": 20, "env_to_module_sum_episodes_length_in": 10.368238394574323, "module_episode_returns_mean": {"default_policy": 1.85}, "episode_return_min": -13.5, "time_between_sampling": 11.284992300903046}, "num_healthy_workers": 1, "actor_manager_num_outstanding_async_reqs": 0, "num_remote_worker_restarts": 0}, "num_env_steps_sampled_lifetime": -4930000.0, "fault_tolerance": {"num_healthy_workers": 0, "num_remote_worker_restarts": 0}, "env_runner_group": {"actor_manager_num_outstanding_async_reqs": 0}, "done": false, "training_iteration": 10, "trial_id": "ba99d_00000", "date": "2025-08-11_17-58-31", "timestamp": 1754927911, "time_this_iter_s": 12.195212841033936, "time_total_s": 121.53763794898987, "pid": 9655, "hostname": "Mac", "node_ip": "127.0.0.1", "config": {"exploration_config": {}, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 2, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "env": "Umbrella", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": false, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 0, "create_local_env_runner": true, "num_envs_per_env_runner": 1, "gym_env_vectorize_mode": "SYNC", "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "episodes_to_numpy": true, "max_requests_in_flight_per_env_runner": 1, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "merge_env_runner_states": "training_only", "broadcast_env_runner_states": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "complete_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "sampler_perf_stats_ema_coef": null, "_is_online": true, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": "auto", "num_aggregator_actors_per_learner": 0, "max_requests_in_flight_per_aggregator_actor": 3, "local_gpu_idx": 0, "max_requests_in_flight_per_learner": 3, "gamma": 1, "lr": 0.0002715581955, "grad_clip": 0.5, "grad_clip_by": "global_norm", "_train_batch_size_per_learner": 5000, "train_batch_size": 4000, "num_epochs": 1, "minibatch_size": 1000, "shuffle_batch_per_epoch": true, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "log_std_clip_param": 20.0, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "_disable_preprocessor_api": false, "_disable_action_flattening": false}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {"intrinsic_reward_coeff": 0.2795015916508}, "optimizer": {}, "_learner_class": "<class 'source.intrinsic_attention_ppo.learners.IntrinsicAttentionMetaLearner.IntrinsicAttentionMetaLearner'>", "callbacks_on_algorithm_init": null, "callbacks_on_env_runners_recreated": null, "callbacks_on_offline_eval_runners_recreated": null, "callbacks_on_checkpoint_loaded": null, "callbacks_on_environment_created": null, "callbacks_on_episode_created": null, "callbacks_on_episode_start": null, "callbacks_on_episode_step": null, "callbacks_on_episode_end": null, "callbacks_on_evaluate_start": null, "callbacks_on_evaluate_end": null, "callbacks_on_evaluate_offline_start": null, "callbacks_on_evaluate_offline_end": null, "callbacks_on_sample_end": null, "callbacks_on_train_result": null, "explore": true, "enable_rl_module_and_learner": true, "enable_env_runner_and_connector_v2": true, "_prior_exploration_config": {"type": "StochasticSampling"}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x15d6f98a0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "offline_data_class": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_read_batch_size": null, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "materialize_data": false, "materialize_mapped_data": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "ignore_final_observation": false, "prelearner_class": null, "prelearner_buffer_class": null, "prelearner_buffer_kwargs": {}, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_remaining_data": false, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": 1, "evaluation_duration": 20, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_auto_duration_min_env_steps_per_sample": 100, "evaluation_auto_duration_max_env_steps_per_sample": 2000, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 1, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "offline_evaluation_interval": null, "num_offline_eval_runners": 0, "offline_loss_for_module_fn": null, "offline_evaluation_duration": 1, "offline_evaluation_parallel_to_training": false, "offline_evaluation_timeout_s": 120.0, "num_cpus_per_offline_eval_runner": 1, "num_gpus_per_offline_eval_runner": 0, "custom_resources_per_offline_eval_runner": {}, "restart_failed_offline_eval_runners": true, "ignore_offline_eval_runner_failures": false, "max_num_offline_eval_runner_restarts": 1000, "offline_eval_runner_restore_timeout_s": 1800.0, "max_requests_in_flight_per_offline_eval_runner": 1, "validate_offline_eval_runners_after_construction": true, "offline_eval_runner_health_probe_timeout_s": 30.0, "offline_eval_rl_module_inference_only": false, "broadcast_offline_eval_runner_states": false, "offline_eval_batch_size_per_runner": 256, "dataset_num_iters_per_eval_runner": 1, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "log_gradients": false, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 6, "restart_failed_env_runners": true, "ignore_env_runner_failures": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30.0, "env_runner_restore_timeout_s": 1800.0, "_model_config": {}, "_rl_module_spec": "MultiRLModuleSpec(multi_rl_module_class=<class 'ray.rllib.core.rl_module.multi_rl_module.MultiRLModule'>, observation_space=None, action_space=None, inference_only=False, model_config=None, rl_module_specs={'default_policy': RLModuleSpec(module_class=<class 'source.intrinsic_attention_ppo.rl_modules.DifferentiablePPOModule.DifferentiablePPOModule'>, observation_space=None, action_space=None, inference_only=False, learner_only=False, model_config={'vf_share_layers': True, 'embedding_dim': 62, 'max_seq_len': 3, 'policy_head_hidden_sizes': [32], 'value_head_hidden_sizes': [101], 'embedding_hidden_sizes': [121]}, catalog_class=None, load_state_path=None, model_config_dict=None), 'intrinsic_reward_module': RLModuleSpec(module_class=<class 'source.intrinsic_attention_ppo.rl_modules.IntrinsicAttentionModule.IntrinsicAttentionModule'>, observation_space=None, action_space=None, inference_only=False, learner_only=True, model_config={'intrinsic_reward_network': {'encoder_hidden_sizes': [], 'encoding_dim': 1, 'num_heads': 1, 'head_hidden_sizes': None, 'layers': [{'type': 'attention'}]}, 'extrinsic_value_hidden_layers': [127, 60], 'vf_share_layers': True, 'max_seq_len': 3}, catalog_class=None, load_state_path=None, model_config_dict=None)}, load_state_path=None, modules_to_load=None, module_specs={'default_policy': RLModuleSpec(module_class=<class 'source.intrinsic_attention_ppo.rl_modules.DifferentiablePPOModule.DifferentiablePPOModule'>, observation_space=None, action_space=None, inference_only=False, learner_only=False, model_config={'vf_share_layers': True, 'embedding_dim': 62, 'max_seq_len': 3, 'policy_head_hidden_sizes': [32], 'value_head_hidden_sizes': [101], 'embedding_hidden_sizes': [121]}, catalog_class=None, load_state_path=None, model_config_dict=None), 'intrinsic_reward_module': RLModuleSpec(module_class=<class 'source.intrinsic_attention_ppo.rl_modules.IntrinsicAttentionModule.IntrinsicAttentionModule'>, observation_space=None, action_space=None, inference_only=False, learner_only=True, model_config={'intrinsic_reward_network': {'encoder_hidden_sizes': [], 'encoding_dim': 1, 'num_heads': 1, 'head_hidden_sizes': None, 'layers': [{'type': 'attention'}]}, 'extrinsic_value_hidden_layers': [127, 60], 'vf_share_layers': True, 'max_seq_len': 3}, catalog_class=None, load_state_path=None, model_config_dict=None)})", "algorithm_config_overrides_per_module": {"intrinsic_reward_module": {"lr": 0.0002715581955}}, "_per_module_overrides": {}, "_validate_config": true, "_use_msgpack_checkpoints": false, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "env_task_fn": -1, "enable_connectors": -1, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.161583927863, "kl_target": 0.0201019014258, "vf_loss_coeff": 0.7790510010087, "entropy_coeff": 0.0015431216992, "clip_param": 0.2459212356676, "vf_clip_param": 0.3769744131561, "entropy_coeff_schedule": null, "lr_schedule": null, "sgd_minibatch_size": -1, "vf_share_layers": -1, "differentiable_learner_configs": ["DifferentiableLearnerConfig(learner_class=<class 'source.intrinsic_attention_ppo.learners.IntrinsicAttentionPPOLearner.IntrinsicAttentionPPOLearner'>, learner_connector=None, add_default_connectors_to_learner_pipeline=True, is_multi_agent=False, policies_to_update=['default_policy'], lr=0.0060984166342, num_total_minibatches=0, num_epochs=1, minibatch_size=1000, shuffle_batch_per_epoch=True)"], "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9485408017724, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.callbacks.callbacks.RLlibCallback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 121.53763794898987, "iterations_since_restore": 10, "perf": {"cpu_util_percent": 46.66470588235295, "ram_util_percent": 82.77647058823528}}
{"timers": {"training_iteration": 11.076119677872793, "restore_env_runners": 2.17771253636583e-05, "training_step": 11.075825074106865, "env_runner_sampling_timer": 1.7556380872259283, "learner_update_timer": 9.104955604776302, "synch_weights": 0.0017482625794241382, "restore_eval_env_runners": 8.442584349602649e-05, "evaluation_iteration": 0.13826065436146548, "synch_eval_env_connectors": 0.00019589558625108877, "synch_env_connectors": 4.991615696918333e-06}, "env_runners": {"module_to_env_connector": {"timers": {"connectors": {"listify_data_for_vector_env": 1.1446445110903295e-05, "normalize_and_clip_actions": 8.631816840357128e-06, "get_actions": 4.52658434137396e-05, "tensor_to_numpy": 1.6744172232623665e-05, "un_batch_to_individual_items": 7.1545221500990545e-06, "remove_single_ts_time_rank_from_batch": 1.2723755104097185e-05}}, "connector_pipeline_timer": 0.00013100394333749433}, "time_between_sampling": 0.04288931589323125, "env_to_module_sum_episodes_length_in": 10.36823839457432, "env_to_module_connector": {"timers": {"connectors": {"add_observations_from_episodes_to_batch": 3.009155666211732e-06, "numpy_to_tensor": 1.4109709413153772e-05, "batch_individual_items": 1.3646148943541912e-05, "add_states_from_episodes_to_batch": 2.92948201539514e-06, "add_time_dim_to_batch_and_zero_pad": 7.565746197111143e-06}}, "connector_pipeline_timer": 6.54369047878293e-05}, "num_agent_steps_sampled_lifetime": {"default_agent": -5547500.0}, "env_reset_timer": 5.003701439718469e-05, "episode_return_mean": 1.7800000000000002, "episode_return_min": -9.5, "env_to_module_sum_episodes_length_out": 10.36823839457432, "module_episode_returns_mean": {"default_policy": 1.7800000000000002}, "agent_episode_returns_mean": {"default_agent": 1.7800000000000002}, "episode_len_max": 20, "sample": 0.006166343390356729, "rlmodule_inference_timer": 3.586088440275452e-05, "episode_len_mean": 20.0, "num_env_steps_sampled": 5000.0, "weights_seq_no": 10.0, "num_agent_steps_sampled": {"default_agent": 5000.0}, "episode_return_max": 10.5, "num_episodes": 250.0, "num_module_steps_sampled": {"default_policy": 5000.0}, "env_step_timer": 1.5429269325696386e-05, "num_module_steps_sampled_lifetime": {"default_policy": -5547500.0}, "episode_duration_sec_mean": 0.005841933669056743, "num_episodes_lifetime": -277375.0, "num_env_steps_sampled_lifetime": -5547500.0, "episode_len_min": 20, "num_env_steps_sampled_lifetime_throughput": 2988.345885659321}, "__all_modules__": {"learner_connector_sum_episodes_length_in": 5000.0, "learner_connector": {"connector_pipeline_timer": 0.17491679184941672, "timers": {"connectors": {"add_one_ts_to_episodes_and_truncate": 0.009107805392272699, "add_observations_from_episodes_to_batch": 0.0008350071597941577, "add_columns_from_episodes_to_train_batch": 0.04180755758420457, "add_time_dim_to_batch_and_zero_pad": 0.10323755136770868, "add_states_from_episodes_to_batch": 0.003501050739008511, "batch_individual_items": 0.01620962076395471, "numpy_to_tensor": 7.315661303496142e-05}}}, "learner_connector_sum_episodes_length_out": 5250.0}, "learners": {"intrinsic_reward_module": {"gradients_default_optimizer_global_norm": 0.0, "num_module_steps_trained": 5994, "total_loss": 0.0, "num_trainable_parameters": 8266, "default_optimizer_learning_rate": 0.0002715581955, "curr_entropy_coeff": 0.0015431216992, "weights_seq_no": 11.0, "diff_num_grad_updates_vs_sampler_policy": 1.0, "num_module_steps_trained_lifetime": 65934, "module_train_batch_size_mean": 999.0, "num_module_steps_trained_lifetime_throughput": 631.4178562103281}, "__all_modules__": {"num_module_steps_trained_lifetime": 131868, "num_module_steps_trained": 11988, "num_non_trainable_parameters": 0, "num_env_steps_trained": 31500, "num_env_steps_trained_lifetime": 346500, "num_trainable_parameters": 24861, "num_env_steps_trained_lifetime_throughput": 3318.306672549862, "num_module_steps_trained_throughput": 21739446.573654182, "num_module_steps_trained_lifetime_throughput": 11523951.559028836}, "differentiable_learners": {"intrinsic_attention_ppo_learner": {"intrinsic_reward_module": {"diff_num_grad_updates_vs_sampler_policy": 56.0, "total_loss": 0.0, "num_module_steps_trained_lifetime": 395604, "num_module_steps_trained": 35964, "module_train_batch_size_mean": 999.0, "weights_seq_no": 66.0}, "default_policy": {"num_module_steps_trained_lifetime": 395604, "num_module_steps_trained": 35964, "module_train_batch_size_mean": 999.0, "vf_loss_unclipped": 38.50967025756836, "mean_kl_loss": 3.980520341428928e-05, "use_intrinsic_rewards": 1.0, "entropy": 0.6754410862922668, "policy_loss": -0.0008228223887272179, "diff_num_grad_updates_vs_sampler_policy": 56.0, "total_loss": 0.20266129076480865, "vf_explained_var": 0.0025560855865478516, "weights_seq_no": 66.0, "vf_loss": 0.26252448558807373}, "__all_modules__": {"num_module_steps_trained_lifetime": 791208, "num_env_steps_trained": 189000, "num_env_steps_trained_lifetime": 2079000, "num_module_steps_trained": 71928, "num_env_steps_trained_lifetime_throughput": 40230.959692324795}}}, "default_policy": {"vf_loss_unclipped": 38.60134506225586, "mean_kl_loss": 4.351437382865697e-05, "curr_kl_coeff": 7.889840344432741e-05, "curr_entropy_coeff": 0.0015431216992, "use_intrinsic_rewards": 0.0, "entropy": 0.6753650903701782, "policy_loss": -0.0008582466980442405, "diff_num_grad_updates_vs_sampler_policy": 1.0, "total_loss": 0.2025475800037384, "num_trainable_parameters": 16595, "vf_explained_var": -0.0002689361572265625, "weights_seq_no": 11.0, "vf_loss": 0.2624320983886719, "num_module_steps_trained_lifetime": 65934, "module_train_batch_size_mean": 999.0, "num_module_steps_trained": 5994, "num_module_steps_trained_lifetime_throughput": 631.4122207385096}, "IntrinsicAttentionMask": [[[0.3327001929283142, 0.33316588401794434, 0.33413389325141907], [0.33276131749153137, 0.33318209648132324, 0.3340565860271454], [0.33288806676864624, 0.3332156836986542, 0.3338962495326996]], [[0.3335764408111572, 0.33273571729660034, 0.3336878716945648], [0.3337916433811188, 0.33220627903938293, 0.3340020477771759], [0.3335479199886322, 0.3328058421611786, 0.3336462676525116]], [[0.3321978449821472, 0.3335694372653961, 0.33423274755477905], [0.332357794046402, 0.3335362672805786, 0.3341059386730194], [0.3324349522590637, 0.3335202932357788, 0.33404481410980225]], [[0.3339049816131592, 0.3325972557067871, 0.3334977626800537], [0.3342309594154358, 0.33217793703079224, 0.33359113335609436], [0.3340063691139221, 0.33246684074401855, 0.3335268497467041]], [[0.3330192267894745, 0.3337673544883728, 0.3332134187221527], [0.3331005573272705, 0.3336549699306488, 0.3332445025444031], [0.33304035663604736, 0.33373814821243286, 0.3332214951515198]], [[0.3317092955112457, 0.3366844356060028, 0.3316062390804291], [0.3361547589302063, 0.32750746607780457, 0.336337685585022], [0.3316158056259155, 0.33687737584114075, 0.3315068483352661]]]}, "num_training_step_calls_per_iteration": 1, "evaluation": {"env_runners": {"episode_len_max": 20, "rlmodule_inference_timer": 3.465123113990075e-05, "weights_seq_no": 11.0, "module_to_env_connector": {"timers": {"connectors": {"remove_single_ts_time_rank_from_batch": 1.2292623112656901e-05, "listify_data_for_vector_env": 1.1130250976550257e-05, "normalize_and_clip_actions": 8.394081152392092e-06, "get_actions": 4.0774181396768015e-05, "tensor_to_numpy": 1.608308175622857e-05, "un_batch_to_individual_items": 6.7794319471304115e-06}}, "connector_pipeline_timer": 0.0001235403426976466}, "episode_return_max": 14.5, "num_episodes": 20, "num_episodes_lifetime": 220, "num_agent_steps_sampled_lifetime": {"default_agent": 4400}, "env_reset_timer": 0.000540889893812677, "env_to_module_sum_episodes_length_out": 10.368238394574323, "num_module_steps_sampled_lifetime": {"default_policy": 4400}, "env_to_module_connector": {"timers": {"connectors": {"numpy_to_tensor": 1.3159300654428964e-05, "batch_individual_items": 1.2860595579113273e-05, "add_observations_from_episodes_to_batch": 2.960803931874473e-06, "add_states_from_episodes_to_batch": 3.0754176883418367e-06, "add_time_dim_to_batch_and_zero_pad": 7.395472404159996e-06}}, "connector_pipeline_timer": 6.254940567188862e-05}, "episode_return_mean": 2.05, "sample": 0.12582333069712504, "episode_len_mean": 20.0, "env_step_timer": 1.4980400733601109e-05, "episode_duration_sec_mean": 0.005843888736562803, "num_env_steps_sampled_lifetime": 55400, "agent_episode_returns_mean": {"default_agent": 2.05}, "num_env_steps_sampled": 400, "num_agent_steps_sampled": {"default_agent": 400}, "num_module_steps_sampled": {"default_policy": 400}, "episode_len_min": 20, "env_to_module_sum_episodes_length_in": 10.368238394574323, "module_episode_returns_mean": {"default_policy": 2.05}, "episode_return_min": -13.5, "time_between_sampling": 11.28750931664381}, "num_healthy_workers": 1, "actor_manager_num_outstanding_async_reqs": 0, "num_remote_worker_restarts": 0}, "num_env_steps_sampled_lifetime": -5547500.0, "fault_tolerance": {"num_healthy_workers": 0, "num_remote_worker_restarts": 0}, "env_runner_group": {"actor_manager_num_outstanding_async_reqs": 0}, "done": false, "training_iteration": 11, "trial_id": "ba99d_00000", "date": "2025-08-11_17-58-43", "timestamp": 1754927923, "time_this_iter_s": 11.629701137542725, "time_total_s": 133.1673390865326, "pid": 9655, "hostname": "Mac", "node_ip": "127.0.0.1", "config": {"exploration_config": {}, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 2, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "env": "Umbrella", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": false, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 0, "create_local_env_runner": true, "num_envs_per_env_runner": 1, "gym_env_vectorize_mode": "SYNC", "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "episodes_to_numpy": true, "max_requests_in_flight_per_env_runner": 1, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "merge_env_runner_states": "training_only", "broadcast_env_runner_states": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "complete_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "sampler_perf_stats_ema_coef": null, "_is_online": true, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": "auto", "num_aggregator_actors_per_learner": 0, "max_requests_in_flight_per_aggregator_actor": 3, "local_gpu_idx": 0, "max_requests_in_flight_per_learner": 3, "gamma": 1, "lr": 0.0002715581955, "grad_clip": 0.5, "grad_clip_by": "global_norm", "_train_batch_size_per_learner": 5000, "train_batch_size": 4000, "num_epochs": 1, "minibatch_size": 1000, "shuffle_batch_per_epoch": true, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "log_std_clip_param": 20.0, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "_disable_preprocessor_api": false, "_disable_action_flattening": false}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {"intrinsic_reward_coeff": 0.2795015916508}, "optimizer": {}, "_learner_class": "<class 'source.intrinsic_attention_ppo.learners.IntrinsicAttentionMetaLearner.IntrinsicAttentionMetaLearner'>", "callbacks_on_algorithm_init": null, "callbacks_on_env_runners_recreated": null, "callbacks_on_offline_eval_runners_recreated": null, "callbacks_on_checkpoint_loaded": null, "callbacks_on_environment_created": null, "callbacks_on_episode_created": null, "callbacks_on_episode_start": null, "callbacks_on_episode_step": null, "callbacks_on_episode_end": null, "callbacks_on_evaluate_start": null, "callbacks_on_evaluate_end": null, "callbacks_on_evaluate_offline_start": null, "callbacks_on_evaluate_offline_end": null, "callbacks_on_sample_end": null, "callbacks_on_train_result": null, "explore": true, "enable_rl_module_and_learner": true, "enable_env_runner_and_connector_v2": true, "_prior_exploration_config": {"type": "StochasticSampling"}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x15d6f98a0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "offline_data_class": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_read_batch_size": null, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "materialize_data": false, "materialize_mapped_data": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "ignore_final_observation": false, "prelearner_class": null, "prelearner_buffer_class": null, "prelearner_buffer_kwargs": {}, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_remaining_data": false, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": 1, "evaluation_duration": 20, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_auto_duration_min_env_steps_per_sample": 100, "evaluation_auto_duration_max_env_steps_per_sample": 2000, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 1, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "offline_evaluation_interval": null, "num_offline_eval_runners": 0, "offline_loss_for_module_fn": null, "offline_evaluation_duration": 1, "offline_evaluation_parallel_to_training": false, "offline_evaluation_timeout_s": 120.0, "num_cpus_per_offline_eval_runner": 1, "num_gpus_per_offline_eval_runner": 0, "custom_resources_per_offline_eval_runner": {}, "restart_failed_offline_eval_runners": true, "ignore_offline_eval_runner_failures": false, "max_num_offline_eval_runner_restarts": 1000, "offline_eval_runner_restore_timeout_s": 1800.0, "max_requests_in_flight_per_offline_eval_runner": 1, "validate_offline_eval_runners_after_construction": true, "offline_eval_runner_health_probe_timeout_s": 30.0, "offline_eval_rl_module_inference_only": false, "broadcast_offline_eval_runner_states": false, "offline_eval_batch_size_per_runner": 256, "dataset_num_iters_per_eval_runner": 1, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "log_gradients": false, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 6, "restart_failed_env_runners": true, "ignore_env_runner_failures": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30.0, "env_runner_restore_timeout_s": 1800.0, "_model_config": {}, "_rl_module_spec": "MultiRLModuleSpec(multi_rl_module_class=<class 'ray.rllib.core.rl_module.multi_rl_module.MultiRLModule'>, observation_space=None, action_space=None, inference_only=False, model_config=None, rl_module_specs={'default_policy': RLModuleSpec(module_class=<class 'source.intrinsic_attention_ppo.rl_modules.DifferentiablePPOModule.DifferentiablePPOModule'>, observation_space=None, action_space=None, inference_only=False, learner_only=False, model_config={'vf_share_layers': True, 'embedding_dim': 62, 'max_seq_len': 3, 'policy_head_hidden_sizes': [32], 'value_head_hidden_sizes': [101], 'embedding_hidden_sizes': [121]}, catalog_class=None, load_state_path=None, model_config_dict=None), 'intrinsic_reward_module': RLModuleSpec(module_class=<class 'source.intrinsic_attention_ppo.rl_modules.IntrinsicAttentionModule.IntrinsicAttentionModule'>, observation_space=None, action_space=None, inference_only=False, learner_only=True, model_config={'intrinsic_reward_network': {'encoder_hidden_sizes': [], 'encoding_dim': 1, 'num_heads': 1, 'head_hidden_sizes': None, 'layers': [{'type': 'attention'}]}, 'extrinsic_value_hidden_layers': [127, 60], 'vf_share_layers': True, 'max_seq_len': 3}, catalog_class=None, load_state_path=None, model_config_dict=None)}, load_state_path=None, modules_to_load=None, module_specs={'default_policy': RLModuleSpec(module_class=<class 'source.intrinsic_attention_ppo.rl_modules.DifferentiablePPOModule.DifferentiablePPOModule'>, observation_space=None, action_space=None, inference_only=False, learner_only=False, model_config={'vf_share_layers': True, 'embedding_dim': 62, 'max_seq_len': 3, 'policy_head_hidden_sizes': [32], 'value_head_hidden_sizes': [101], 'embedding_hidden_sizes': [121]}, catalog_class=None, load_state_path=None, model_config_dict=None), 'intrinsic_reward_module': RLModuleSpec(module_class=<class 'source.intrinsic_attention_ppo.rl_modules.IntrinsicAttentionModule.IntrinsicAttentionModule'>, observation_space=None, action_space=None, inference_only=False, learner_only=True, model_config={'intrinsic_reward_network': {'encoder_hidden_sizes': [], 'encoding_dim': 1, 'num_heads': 1, 'head_hidden_sizes': None, 'layers': [{'type': 'attention'}]}, 'extrinsic_value_hidden_layers': [127, 60], 'vf_share_layers': True, 'max_seq_len': 3}, catalog_class=None, load_state_path=None, model_config_dict=None)})", "algorithm_config_overrides_per_module": {"intrinsic_reward_module": {"lr": 0.0002715581955}}, "_per_module_overrides": {}, "_validate_config": true, "_use_msgpack_checkpoints": false, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "env_task_fn": -1, "enable_connectors": -1, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.161583927863, "kl_target": 0.0201019014258, "vf_loss_coeff": 0.7790510010087, "entropy_coeff": 0.0015431216992, "clip_param": 0.2459212356676, "vf_clip_param": 0.3769744131561, "entropy_coeff_schedule": null, "lr_schedule": null, "sgd_minibatch_size": -1, "vf_share_layers": -1, "differentiable_learner_configs": ["DifferentiableLearnerConfig(learner_class=<class 'source.intrinsic_attention_ppo.learners.IntrinsicAttentionPPOLearner.IntrinsicAttentionPPOLearner'>, learner_connector=None, add_default_connectors_to_learner_pipeline=True, is_multi_agent=False, policies_to_update=['default_policy'], lr=0.0060984166342, num_total_minibatches=0, num_epochs=1, minibatch_size=1000, shuffle_batch_per_epoch=True)"], "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9485408017724, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.callbacks.callbacks.RLlibCallback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 133.1673390865326, "iterations_since_restore": 11, "perf": {"cpu_util_percent": 45.464705882352945, "ram_util_percent": 82.41764705882353}}
{"timers": {"training_iteration": 11.082991198183791, "restore_env_runners": 2.1622694522474532e-05, "training_step": 11.082697381286579, "env_runner_sampling_timer": 1.753868293024107, "learner_update_timer": 9.11312057872784, "synch_weights": 0.0017402599536377945, "restore_eval_env_runners": 8.368449504140802e-05, "evaluation_iteration": 0.138214086567283, "synch_eval_env_connectors": 0.00019521121052451938, "synch_env_connectors": 4.987949019004554e-06}, "env_runners": {"module_to_env_connector": {"timers": {"connectors": {"listify_data_for_vector_env": 1.0684966777514282e-05, "normalize_and_clip_actions": 8.135163249824589e-06, "get_actions": 4.085069907655865e-05, "tensor_to_numpy": 1.5621741658836377e-05, "un_batch_to_individual_items": 6.736917230649286e-06, "remove_single_ts_time_rank_from_batch": 1.2035451589926524e-05}}, "connector_pipeline_timer": 0.00012153209621173731}, "time_between_sampling": 0.040502134673176274, "env_to_module_sum_episodes_length_in": 10.36823839457432, "env_to_module_connector": {"timers": {"connectors": {"add_observations_from_episodes_to_batch": 2.840251812732417e-06, "numpy_to_tensor": 1.28596581956884e-05, "batch_individual_items": 1.2601344355526883e-05, "add_states_from_episodes_to_batch": 2.778714772752148e-06, "add_time_dim_to_batch_and_zero_pad": 7.001069058191111e-06}}, "connector_pipeline_timer": 6.087972859865997e-05}, "num_agent_steps_sampled_lifetime": {"default_agent": -6165000.0}, "env_reset_timer": 4.5887377963784446e-05, "episode_return_mean": 2.259999999999999, "episode_return_min": -9.5, "env_to_module_sum_episodes_length_out": 10.36823839457432, "module_episode_returns_mean": {"default_policy": 2.259999999999999}, "agent_episode_returns_mean": {"default_agent": 2.259999999999999}, "episode_len_max": 20, "sample": 0.005897321635752811, "rlmodule_inference_timer": 3.271912295544959e-05, "episode_len_mean": 20.0, "num_env_steps_sampled": 5000.0, "weights_seq_no": 11.0, "num_agent_steps_sampled": {"default_agent": 5000.0}, "episode_return_max": 10.5, "num_episodes": 250.0, "num_module_steps_sampled": {"default_policy": 5000.0}, "env_step_timer": 1.4171578658360163e-05, "num_module_steps_sampled_lifetime": {"default_policy": -6165000.0}, "episode_duration_sec_mean": 0.005410516992677003, "num_episodes_lifetime": -308250.0, "num_env_steps_sampled_lifetime": -6165000.0, "episode_len_min": 20, "num_env_steps_sampled_lifetime_throughput": 3156.039187173376}, "__all_modules__": {"learner_connector_sum_episodes_length_in": 5000.0, "learner_connector": {"connector_pipeline_timer": 0.17524295810012597, "timers": {"connectors": {"add_one_ts_to_episodes_and_truncate": 0.009106278998116557, "add_observations_from_episodes_to_batch": 0.0008349904182388763, "add_columns_from_episodes_to_train_batch": 0.041811208259150724, "add_time_dim_to_batch_and_zero_pad": 0.10335362960351505, "add_states_from_episodes_to_batch": 0.0035293981412941136, "batch_individual_items": 0.016387402476074762, "numpy_to_tensor": 7.489420656733534e-05}}}, "learner_connector_sum_episodes_length_out": 5250.0}, "learners": {"intrinsic_reward_module": {"gradients_default_optimizer_global_norm": 0.0, "num_module_steps_trained": 5994, "total_loss": 0.0, "num_trainable_parameters": 8266, "default_optimizer_learning_rate": 0.0002715581955, "curr_entropy_coeff": 0.0015431216992, "weights_seq_no": 12.0, "diff_num_grad_updates_vs_sampler_policy": 1.0, "num_module_steps_trained_lifetime": 71928, "module_train_batch_size_mean": 999.0, "num_module_steps_trained_lifetime_throughput": 628.5917100490889}, "__all_modules__": {"num_module_steps_trained_lifetime": 143856, "num_module_steps_trained": 11988, "num_non_trainable_parameters": 0, "num_env_steps_trained": 31500, "num_env_steps_trained_lifetime": 378000, "num_trainable_parameters": 24861, "num_env_steps_trained_lifetime_throughput": 3303.4539189996276, "num_module_steps_trained_throughput": 21214903.902892686, "num_module_steps_trained_lifetime_throughput": 11526375.454580825}, "differentiable_learners": {"intrinsic_attention_ppo_learner": {"intrinsic_reward_module": {"diff_num_grad_updates_vs_sampler_policy": 61.0, "total_loss": 0.0, "num_module_steps_trained_lifetime": 431568, "num_module_steps_trained": 35964, "module_train_batch_size_mean": 999.0, "weights_seq_no": 72.0}, "default_policy": {"num_module_steps_trained_lifetime": 431568, "num_module_steps_trained": 35964, "module_train_batch_size_mean": 999.0, "vf_loss_unclipped": 38.507118225097656, "mean_kl_loss": 9.501950444246177e-06, "use_intrinsic_rewards": 1.0, "entropy": 0.674591600894928, "policy_loss": -0.00013072659203317016, "diff_num_grad_updates_vs_sampler_policy": 61.0, "total_loss": 0.2033298760652542, "vf_explained_var": 0.0024941563606262207, "weights_seq_no": 72.0, "vf_loss": 0.2624988853931427}, "__all_modules__": {"num_module_steps_trained_lifetime": 863136, "num_env_steps_trained": 189000, "num_env_steps_trained_lifetime": 2268000, "num_module_steps_trained": 71928, "num_env_steps_trained_lifetime_throughput": 39503.40636833684}}}, "default_policy": {"vf_loss_unclipped": 38.60192108154297, "mean_kl_loss": 9.844976375461556e-06, "curr_kl_coeff": 3.944920172216371e-05, "curr_entropy_coeff": 0.0015431216992, "use_intrinsic_rewards": 0.0, "entropy": 0.6745772957801819, "policy_loss": -0.00013319752179086208, "diff_num_grad_updates_vs_sampler_policy": 1.0, "total_loss": 0.20327620208263397, "num_trainable_parameters": 16595, "vf_explained_var": -0.0002620220184326172, "weights_seq_no": 12.0, "vf_loss": 0.26243510842323303, "num_module_steps_trained_lifetime": 71928, "module_train_batch_size_mean": 999.0, "num_module_steps_trained": 5994, "num_module_steps_trained_lifetime_throughput": 628.5865075361548}, "IntrinsicAttentionMask": [[[0.3330930471420288, 0.33237847685813904, 0.33452844619750977], [0.3330572545528412, 0.33223700523376465, 0.33470574021339417], [0.33316460251808167, 0.33266180753707886, 0.33417361974716187]], [[0.333452045917511, 0.33290308713912964, 0.33364489674568176], [0.33347490429878235, 0.33281999826431274, 0.3337050676345825], [0.3334439694881439, 0.3329322338104248, 0.3336237668991089]], [[0.332987517118454, 0.3338111340999603, 0.3332012891769409], [0.33306884765625, 0.33369874954223633, 0.3332323729991913], [0.33300867676734924, 0.3337819576263428, 0.33320939540863037]], [[0.3336334228515625, 0.33313998579978943, 0.3332265019416809], [0.33369797468185425, 0.3330984115600586, 0.3332035541534424], [0.3336866796016693, 0.33310574293136597, 0.3332076072692871]], [[0.3333234488964081, 0.3340722620487213, 0.3326042592525482], [0.333326131105423, 0.3338809311389923, 0.3327929675579071], [0.33332082629203796, 0.33425647020339966, 0.3324227035045624]], [[0.33105650544166565, 0.33803102374076843, 0.33091244101524353], [0.33551180362701416, 0.32883554697036743, 0.335652619600296], [0.33096277713775635, 0.338224321603775, 0.33081284165382385]]]}, "num_training_step_calls_per_iteration": 1, "evaluation": {"env_runners": {"episode_len_max": 20, "rlmodule_inference_timer": 3.12544042924432e-05, "weights_seq_no": 12.0, "module_to_env_connector": {"timers": {"connectors": {"remove_single_ts_time_rank_from_batch": 1.18015212823862e-05, "listify_data_for_vector_env": 1.0493730056542891e-05, "normalize_and_clip_actions": 7.996569476633638e-06, "get_actions": 3.691012119103118e-05, "tensor_to_numpy": 1.5307457565763925e-05, "un_batch_to_individual_items": 6.466288084553609e-06}}, "connector_pipeline_timer": 0.00011491489543479316}, "episode_return_max": 14.5, "num_episodes": 20, "num_episodes_lifetime": 240, "num_agent_steps_sampled_lifetime": {"default_agent": 4800}, "env_reset_timer": 0.0005390614156182243, "env_to_module_sum_episodes_length_out": 10.368238394574323, "num_module_steps_sampled_lifetime": {"default_policy": 4800}, "env_to_module_connector": {"timers": {"connectors": {"numpy_to_tensor": 1.1988465894271217e-05, "batch_individual_items": 1.2464134821858924e-05, "add_observations_from_episodes_to_batch": 2.810065961945456e-06, "add_states_from_episodes_to_batch": 2.943598630983192e-06, "add_time_dim_to_batch_and_zero_pad": 7.0813622560128876e-06}}, "connector_pipeline_timer": 5.9279418995435765e-05}, "episode_return_mean": 2.05, "sample": 0.12572051696916237, "episode_len_mean": 20.0, "env_step_timer": 1.3767939654708432e-05, "episode_duration_sec_mean": 0.0055210779188200835, "num_env_steps_sampled_lifetime": 60400, "agent_episode_returns_mean": {"default_agent": 2.05}, "num_env_steps_sampled": 400, "num_agent_steps_sampled": {"default_agent": 400}, "num_module_steps_sampled": {"default_policy": 400}, "episode_len_min": 20, "env_to_module_sum_episodes_length_in": 10.368238394574323, "module_episode_returns_mean": {"default_policy": 2.05}, "episode_return_min": -13.5, "time_between_sampling": 11.292619666397261}, "num_healthy_workers": 1, "actor_manager_num_outstanding_async_reqs": 0, "num_remote_worker_restarts": 0}, "num_env_steps_sampled_lifetime": -6165000.0, "fault_tolerance": {"num_healthy_workers": 0, "num_remote_worker_restarts": 0}, "env_runner_group": {"actor_manager_num_outstanding_async_reqs": 0}, "done": false, "training_iteration": 12, "trial_id": "ba99d_00000", "date": "2025-08-11_17-58-55", "timestamp": 1754927935, "time_this_iter_s": 11.89127492904663, "time_total_s": 145.05861401557922, "pid": 9655, "hostname": "Mac", "node_ip": "127.0.0.1", "config": {"exploration_config": {}, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 2, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "env": "Umbrella", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": false, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 0, "create_local_env_runner": true, "num_envs_per_env_runner": 1, "gym_env_vectorize_mode": "SYNC", "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "episodes_to_numpy": true, "max_requests_in_flight_per_env_runner": 1, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "merge_env_runner_states": "training_only", "broadcast_env_runner_states": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "complete_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "sampler_perf_stats_ema_coef": null, "_is_online": true, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": "auto", "num_aggregator_actors_per_learner": 0, "max_requests_in_flight_per_aggregator_actor": 3, "local_gpu_idx": 0, "max_requests_in_flight_per_learner": 3, "gamma": 1, "lr": 0.0002715581955, "grad_clip": 0.5, "grad_clip_by": "global_norm", "_train_batch_size_per_learner": 5000, "train_batch_size": 4000, "num_epochs": 1, "minibatch_size": 1000, "shuffle_batch_per_epoch": true, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "log_std_clip_param": 20.0, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "_disable_preprocessor_api": false, "_disable_action_flattening": false}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {"intrinsic_reward_coeff": 0.2795015916508}, "optimizer": {}, "_learner_class": "<class 'source.intrinsic_attention_ppo.learners.IntrinsicAttentionMetaLearner.IntrinsicAttentionMetaLearner'>", "callbacks_on_algorithm_init": null, "callbacks_on_env_runners_recreated": null, "callbacks_on_offline_eval_runners_recreated": null, "callbacks_on_checkpoint_loaded": null, "callbacks_on_environment_created": null, "callbacks_on_episode_created": null, "callbacks_on_episode_start": null, "callbacks_on_episode_step": null, "callbacks_on_episode_end": null, "callbacks_on_evaluate_start": null, "callbacks_on_evaluate_end": null, "callbacks_on_evaluate_offline_start": null, "callbacks_on_evaluate_offline_end": null, "callbacks_on_sample_end": null, "callbacks_on_train_result": null, "explore": true, "enable_rl_module_and_learner": true, "enable_env_runner_and_connector_v2": true, "_prior_exploration_config": {"type": "StochasticSampling"}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x15d6f98a0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "offline_data_class": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_read_batch_size": null, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "materialize_data": false, "materialize_mapped_data": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "ignore_final_observation": false, "prelearner_class": null, "prelearner_buffer_class": null, "prelearner_buffer_kwargs": {}, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_remaining_data": false, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": 1, "evaluation_duration": 20, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_auto_duration_min_env_steps_per_sample": 100, "evaluation_auto_duration_max_env_steps_per_sample": 2000, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 1, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "offline_evaluation_interval": null, "num_offline_eval_runners": 0, "offline_loss_for_module_fn": null, "offline_evaluation_duration": 1, "offline_evaluation_parallel_to_training": false, "offline_evaluation_timeout_s": 120.0, "num_cpus_per_offline_eval_runner": 1, "num_gpus_per_offline_eval_runner": 0, "custom_resources_per_offline_eval_runner": {}, "restart_failed_offline_eval_runners": true, "ignore_offline_eval_runner_failures": false, "max_num_offline_eval_runner_restarts": 1000, "offline_eval_runner_restore_timeout_s": 1800.0, "max_requests_in_flight_per_offline_eval_runner": 1, "validate_offline_eval_runners_after_construction": true, "offline_eval_runner_health_probe_timeout_s": 30.0, "offline_eval_rl_module_inference_only": false, "broadcast_offline_eval_runner_states": false, "offline_eval_batch_size_per_runner": 256, "dataset_num_iters_per_eval_runner": 1, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "log_gradients": false, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 6, "restart_failed_env_runners": true, "ignore_env_runner_failures": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30.0, "env_runner_restore_timeout_s": 1800.0, "_model_config": {}, "_rl_module_spec": "MultiRLModuleSpec(multi_rl_module_class=<class 'ray.rllib.core.rl_module.multi_rl_module.MultiRLModule'>, observation_space=None, action_space=None, inference_only=False, model_config=None, rl_module_specs={'default_policy': RLModuleSpec(module_class=<class 'source.intrinsic_attention_ppo.rl_modules.DifferentiablePPOModule.DifferentiablePPOModule'>, observation_space=None, action_space=None, inference_only=False, learner_only=False, model_config={'vf_share_layers': True, 'embedding_dim': 62, 'max_seq_len': 3, 'policy_head_hidden_sizes': [32], 'value_head_hidden_sizes': [101], 'embedding_hidden_sizes': [121]}, catalog_class=None, load_state_path=None, model_config_dict=None), 'intrinsic_reward_module': RLModuleSpec(module_class=<class 'source.intrinsic_attention_ppo.rl_modules.IntrinsicAttentionModule.IntrinsicAttentionModule'>, observation_space=None, action_space=None, inference_only=False, learner_only=True, model_config={'intrinsic_reward_network': {'encoder_hidden_sizes': [], 'encoding_dim': 1, 'num_heads': 1, 'head_hidden_sizes': None, 'layers': [{'type': 'attention'}]}, 'extrinsic_value_hidden_layers': [127, 60], 'vf_share_layers': True, 'max_seq_len': 3}, catalog_class=None, load_state_path=None, model_config_dict=None)}, load_state_path=None, modules_to_load=None, module_specs={'default_policy': RLModuleSpec(module_class=<class 'source.intrinsic_attention_ppo.rl_modules.DifferentiablePPOModule.DifferentiablePPOModule'>, observation_space=None, action_space=None, inference_only=False, learner_only=False, model_config={'vf_share_layers': True, 'embedding_dim': 62, 'max_seq_len': 3, 'policy_head_hidden_sizes': [32], 'value_head_hidden_sizes': [101], 'embedding_hidden_sizes': [121]}, catalog_class=None, load_state_path=None, model_config_dict=None), 'intrinsic_reward_module': RLModuleSpec(module_class=<class 'source.intrinsic_attention_ppo.rl_modules.IntrinsicAttentionModule.IntrinsicAttentionModule'>, observation_space=None, action_space=None, inference_only=False, learner_only=True, model_config={'intrinsic_reward_network': {'encoder_hidden_sizes': [], 'encoding_dim': 1, 'num_heads': 1, 'head_hidden_sizes': None, 'layers': [{'type': 'attention'}]}, 'extrinsic_value_hidden_layers': [127, 60], 'vf_share_layers': True, 'max_seq_len': 3}, catalog_class=None, load_state_path=None, model_config_dict=None)})", "algorithm_config_overrides_per_module": {"intrinsic_reward_module": {"lr": 0.0002715581955}}, "_per_module_overrides": {}, "_validate_config": true, "_use_msgpack_checkpoints": false, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "env_task_fn": -1, "enable_connectors": -1, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.161583927863, "kl_target": 0.0201019014258, "vf_loss_coeff": 0.7790510010087, "entropy_coeff": 0.0015431216992, "clip_param": 0.2459212356676, "vf_clip_param": 0.3769744131561, "entropy_coeff_schedule": null, "lr_schedule": null, "sgd_minibatch_size": -1, "vf_share_layers": -1, "differentiable_learner_configs": ["DifferentiableLearnerConfig(learner_class=<class 'source.intrinsic_attention_ppo.learners.IntrinsicAttentionPPOLearner.IntrinsicAttentionPPOLearner'>, learner_connector=None, add_default_connectors_to_learner_pipeline=True, is_multi_agent=False, policies_to_update=['default_policy'], lr=0.0060984166342, num_total_minibatches=0, num_epochs=1, minibatch_size=1000, shuffle_batch_per_epoch=True)"], "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9485408017724, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.callbacks.callbacks.RLlibCallback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 145.05861401557922, "iterations_since_restore": 12, "perf": {"cpu_util_percent": 45.699999999999996, "ram_util_percent": 82.81176470588235}}
{"timers": {"training_iteration": 11.094220524951742, "restore_env_runners": 2.1467298075364016e-05, "training_step": 11.093927139973918, "env_runner_sampling_timer": 1.7522251525927768, "learner_update_timer": 9.12587571585068, "synch_weights": 0.0017449240238728643, "restore_eval_env_runners": 8.293430965656191e-05, "evaluation_iteration": 0.13808333112193819, "synch_eval_env_connectors": 0.0001944665988826258, "synch_env_connectors": 4.982649612154915e-06}, "env_runners": {"module_to_env_connector": {"timers": {"connectors": {"listify_data_for_vector_env": 1.0814816436583755e-05, "normalize_and_clip_actions": 8.176614686482498e-06, "get_actions": 4.103426867008294e-05, "tensor_to_numpy": 1.5766510167238825e-05, "un_batch_to_individual_items": 6.780471056682917e-06, "remove_single_ts_time_rank_from_batch": 1.2095848110952639e-05}}, "connector_pipeline_timer": 0.00012228171978104061}, "time_between_sampling": 0.04173877047671884, "env_to_module_sum_episodes_length_in": 10.36823839457432, "env_to_module_connector": {"timers": {"connectors": {"add_observations_from_episodes_to_batch": 2.83762778198777e-06, "numpy_to_tensor": 1.3022954431482733e-05, "batch_individual_items": 1.2725118018060627e-05, "add_states_from_episodes_to_batch": 2.7845117455517856e-06, "add_time_dim_to_batch_and_zero_pad": 7.03899968284109e-06}}, "connector_pipeline_timer": 6.131352012840764e-05}, "num_agent_steps_sampled_lifetime": {"default_agent": -6782500.0}, "env_reset_timer": 4.352895594106561e-05, "episode_return_mean": 3.1399999999999992, "episode_return_min": -9.5, "env_to_module_sum_episodes_length_out": 10.36823839457432, "module_episode_returns_mean": {"default_policy": 3.1399999999999992}, "agent_episode_returns_mean": {"default_agent": 3.1399999999999992}, "episode_len_max": 20, "sample": 0.005802677091574214, "rlmodule_inference_timer": 3.284019044501615e-05, "episode_len_mean": 20.0, "num_env_steps_sampled": 5000.0, "weights_seq_no": 12.0, "num_agent_steps_sampled": {"default_agent": 5000.0}, "episode_return_max": 10.5, "num_episodes": 250.0, "num_module_steps_sampled": {"default_policy": 5000.0}, "env_step_timer": 1.4302524054951647e-05, "num_module_steps_sampled_lifetime": {"default_policy": -6782500.0}, "episode_duration_sec_mean": 0.005445911020971833, "num_episodes_lifetime": -339125.0, "num_env_steps_sampled_lifetime": -6782500.0, "episode_len_min": 20, "num_env_steps_sampled_lifetime_throughput": 3145.332615339999}, "__all_modules__": {"learner_connector_sum_episodes_length_in": 5000.0, "learner_connector": {"connector_pipeline_timer": 0.17523784809987897, "timers": {"connectors": {"add_one_ts_to_episodes_and_truncate": 0.00910457411788186, "add_observations_from_episodes_to_batch": 0.0008355646832895565, "add_columns_from_episodes_to_train_batch": 0.041812097846647835, "add_time_dim_to_batch_and_zero_pad": 0.1033630362174694, "add_states_from_episodes_to_batch": 0.0035435141600918007, "batch_individual_items": 0.016359314701780495, "numpy_to_tensor": 7.480610422508511e-05}}}, "learner_connector_sum_episodes_length_out": 5250.0}, "learners": {"intrinsic_reward_module": {"gradients_default_optimizer_global_norm": 0.0, "num_module_steps_trained": 5994, "total_loss": 0.0, "num_trainable_parameters": 8266, "default_optimizer_learning_rate": 0.0002715581955, "curr_entropy_coeff": 0.0015431216992, "weights_seq_no": 13.0, "diff_num_grad_updates_vs_sampler_policy": 1.0, "num_module_steps_trained_lifetime": 77922, "module_train_batch_size_mean": 999.0, "num_module_steps_trained_lifetime_throughput": 625.4162446152369}, "__all_modules__": {"num_module_steps_trained_lifetime": 155844, "num_module_steps_trained": 11988, "num_non_trainable_parameters": 0, "num_env_steps_trained": 31500, "num_env_steps_trained_lifetime": 409500, "num_trainable_parameters": 24861, "num_env_steps_trained_lifetime_throughput": 3286.7652448863555, "num_module_steps_trained_throughput": 20710022.656398624, "num_module_steps_trained_lifetime_throughput": 11519617.024869468}, "differentiable_learners": {"intrinsic_attention_ppo_learner": {"intrinsic_reward_module": {"diff_num_grad_updates_vs_sampler_policy": 66.0, "total_loss": 0.0, "num_module_steps_trained_lifetime": 467532, "num_module_steps_trained": 35964, "module_train_batch_size_mean": 999.0, "weights_seq_no": 78.0}, "default_policy": {"num_module_steps_trained_lifetime": 467532, "num_module_steps_trained": 35964, "module_train_batch_size_mean": 999.0, "vf_loss_unclipped": 39.462955474853516, "mean_kl_loss": 1.6268244507955387e-05, "use_intrinsic_rewards": 1.0, "entropy": 0.6741659641265869, "policy_loss": -0.00019193021580576897, "diff_num_grad_updates_vs_sampler_policy": 66.0, "total_loss": 0.20326103270053864, "vf_explained_var": 0.002274632453918457, "weights_seq_no": 78.0, "vf_loss": 0.26248687505722046}, "__all_modules__": {"num_module_steps_trained_lifetime": 935064, "num_env_steps_trained": 189000, "num_env_steps_trained_lifetime": 2457000, "num_module_steps_trained": 71928, "num_env_steps_trained_lifetime_throughput": 38797.61538312908}}}, "default_policy": {"vf_loss_unclipped": 39.59086990356445, "mean_kl_loss": 1.6972106095636263e-05, "curr_kl_coeff": 1.9724600861081854e-05, "curr_entropy_coeff": 0.0015431216992, "use_intrinsic_rewards": 0.0, "entropy": 0.6741419434547424, "policy_loss": -0.00019544707902241498, "diff_num_grad_updates_vs_sampler_policy": 1.0, "total_loss": 0.20321443676948547, "num_trainable_parameters": 16595, "vf_explained_var": 4.172325134277344e-05, "weights_seq_no": 13.0, "vf_loss": 0.26243487000465393, "num_module_steps_trained_lifetime": 77922, "module_train_batch_size_mean": 999.0, "num_module_steps_trained": 5994, "num_module_steps_trained_lifetime_throughput": 625.4114449271892}, "IntrinsicAttentionMask": [[[0.3348350524902344, 0.33221808075904846, 0.3329468369483948], [0.336263507604599, 0.3311595022678375, 0.33257701992988586], [0.3358643054962158, 0.3314551115036011, 0.3326805830001831]], [[0.33375459909439087, 0.33320513367652893, 0.3330402970314026], [0.33383598923683167, 0.33318033814430237, 0.3329836428165436], [0.33386045694351196, 0.33317291736602783, 0.3329666554927826]], [[0.3336585462093353, 0.33347535133361816, 0.3328661024570465], [0.3336755633354187, 0.3334827721118927, 0.332841694355011], [0.33373215794563293, 0.3335074484348297, 0.33276039361953735]], [[0.33363625407218933, 0.3333747088909149, 0.3329890966415405], [0.3337591886520386, 0.3333914279937744, 0.332849383354187], [0.33394065499305725, 0.33341604471206665, 0.3326432704925537]], [[0.3328876197338104, 0.3339492380619049, 0.3331630825996399], [0.33296895027160645, 0.3338368237018585, 0.33319419622421265], [0.3329087793827057, 0.33392006158828735, 0.33317121863365173]], [[0.3317093253135681, 0.3366844654083252, 0.3316062390804291], [0.3361547887325287, 0.3275074362754822, 0.33633771538734436], [0.3316158056259155, 0.33687737584114075, 0.3315068185329437]]]}, "num_training_step_calls_per_iteration": 1, "evaluation": {"env_runners": {"episode_len_max": 20, "rlmodule_inference_timer": 3.388126087935618e-05, "weights_seq_no": 13.0, "module_to_env_connector": {"timers": {"connectors": {"remove_single_ts_time_rank_from_batch": 1.3057817510822328e-05, "listify_data_for_vector_env": 1.1220413381429542e-05, "normalize_and_clip_actions": 8.323288064865415e-06, "get_actions": 4.139159674685581e-05, "tensor_to_numpy": 1.6915101995504395e-05, "un_batch_to_individual_items": 7.183847610064367e-06}}, "connector_pipeline_timer": 0.0001260724426337087}, "episode_return_max": 14.5, "num_episodes": 20, "num_episodes_lifetime": 260, "num_agent_steps_sampled_lifetime": {"default_agent": 5200}, "env_reset_timer": 0.0005370266314385411, "env_to_module_sum_episodes_length_out": 10.368238394574323, "num_module_steps_sampled_lifetime": {"default_policy": 5200}, "env_to_module_connector": {"timers": {"connectors": {"numpy_to_tensor": 1.2836696639400316e-05, "batch_individual_items": 1.2808532572936366e-05, "add_observations_from_episodes_to_batch": 3.0476697612260447e-06, "add_states_from_episodes_to_batch": 3.066048822678283e-06, "add_time_dim_to_batch_and_zero_pad": 7.676949800346634e-06}}, "connector_pipeline_timer": 6.267608534891581e-05}, "episode_return_mean": 1.85, "sample": 0.12571876638000312, "episode_len_mean": 20.0, "env_step_timer": 1.4970762334118074e-05, "episode_duration_sec_mean": 0.005576772913336754, "num_env_steps_sampled_lifetime": 65400, "agent_episode_returns_mean": {"default_agent": 1.85}, "num_env_steps_sampled": 400, "num_agent_steps_sampled": {"default_agent": 400}, "num_module_steps_sampled": {"default_policy": 400}, "episode_len_min": 20, "env_to_module_sum_episodes_length_in": 10.368238394574323, "module_episode_returns_mean": {"default_policy": 1.85}, "episode_return_min": -13.5, "time_between_sampling": 11.302092409733273}, "num_healthy_workers": 1, "actor_manager_num_outstanding_async_reqs": 0, "num_remote_worker_restarts": 0}, "num_env_steps_sampled_lifetime": -6782500.0, "fault_tolerance": {"num_healthy_workers": 0, "num_remote_worker_restarts": 0}, "env_runner_group": {"actor_manager_num_outstanding_async_reqs": 0}, "done": false, "training_iteration": 13, "trial_id": "ba99d_00000", "date": "2025-08-11_17-59-07", "timestamp": 1754927947, "time_this_iter_s": 12.345359086990356, "time_total_s": 157.40397310256958, "pid": 9655, "hostname": "Mac", "node_ip": "127.0.0.1", "config": {"exploration_config": {}, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 2, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "env": "Umbrella", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": false, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 0, "create_local_env_runner": true, "num_envs_per_env_runner": 1, "gym_env_vectorize_mode": "SYNC", "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "episodes_to_numpy": true, "max_requests_in_flight_per_env_runner": 1, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "merge_env_runner_states": "training_only", "broadcast_env_runner_states": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "complete_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "sampler_perf_stats_ema_coef": null, "_is_online": true, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": "auto", "num_aggregator_actors_per_learner": 0, "max_requests_in_flight_per_aggregator_actor": 3, "local_gpu_idx": 0, "max_requests_in_flight_per_learner": 3, "gamma": 1, "lr": 0.0002715581955, "grad_clip": 0.5, "grad_clip_by": "global_norm", "_train_batch_size_per_learner": 5000, "train_batch_size": 4000, "num_epochs": 1, "minibatch_size": 1000, "shuffle_batch_per_epoch": true, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "log_std_clip_param": 20.0, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "_disable_preprocessor_api": false, "_disable_action_flattening": false}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {"intrinsic_reward_coeff": 0.2795015916508}, "optimizer": {}, "_learner_class": "<class 'source.intrinsic_attention_ppo.learners.IntrinsicAttentionMetaLearner.IntrinsicAttentionMetaLearner'>", "callbacks_on_algorithm_init": null, "callbacks_on_env_runners_recreated": null, "callbacks_on_offline_eval_runners_recreated": null, "callbacks_on_checkpoint_loaded": null, "callbacks_on_environment_created": null, "callbacks_on_episode_created": null, "callbacks_on_episode_start": null, "callbacks_on_episode_step": null, "callbacks_on_episode_end": null, "callbacks_on_evaluate_start": null, "callbacks_on_evaluate_end": null, "callbacks_on_evaluate_offline_start": null, "callbacks_on_evaluate_offline_end": null, "callbacks_on_sample_end": null, "callbacks_on_train_result": null, "explore": true, "enable_rl_module_and_learner": true, "enable_env_runner_and_connector_v2": true, "_prior_exploration_config": {"type": "StochasticSampling"}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x15d6f98a0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "offline_data_class": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_read_batch_size": null, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "materialize_data": false, "materialize_mapped_data": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "ignore_final_observation": false, "prelearner_class": null, "prelearner_buffer_class": null, "prelearner_buffer_kwargs": {}, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_remaining_data": false, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": 1, "evaluation_duration": 20, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_auto_duration_min_env_steps_per_sample": 100, "evaluation_auto_duration_max_env_steps_per_sample": 2000, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 1, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "offline_evaluation_interval": null, "num_offline_eval_runners": 0, "offline_loss_for_module_fn": null, "offline_evaluation_duration": 1, "offline_evaluation_parallel_to_training": false, "offline_evaluation_timeout_s": 120.0, "num_cpus_per_offline_eval_runner": 1, "num_gpus_per_offline_eval_runner": 0, "custom_resources_per_offline_eval_runner": {}, "restart_failed_offline_eval_runners": true, "ignore_offline_eval_runner_failures": false, "max_num_offline_eval_runner_restarts": 1000, "offline_eval_runner_restore_timeout_s": 1800.0, "max_requests_in_flight_per_offline_eval_runner": 1, "validate_offline_eval_runners_after_construction": true, "offline_eval_runner_health_probe_timeout_s": 30.0, "offline_eval_rl_module_inference_only": false, "broadcast_offline_eval_runner_states": false, "offline_eval_batch_size_per_runner": 256, "dataset_num_iters_per_eval_runner": 1, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "log_gradients": false, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 6, "restart_failed_env_runners": true, "ignore_env_runner_failures": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30.0, "env_runner_restore_timeout_s": 1800.0, "_model_config": {}, "_rl_module_spec": "MultiRLModuleSpec(multi_rl_module_class=<class 'ray.rllib.core.rl_module.multi_rl_module.MultiRLModule'>, observation_space=None, action_space=None, inference_only=False, model_config=None, rl_module_specs={'default_policy': RLModuleSpec(module_class=<class 'source.intrinsic_attention_ppo.rl_modules.DifferentiablePPOModule.DifferentiablePPOModule'>, observation_space=None, action_space=None, inference_only=False, learner_only=False, model_config={'vf_share_layers': True, 'embedding_dim': 62, 'max_seq_len': 3, 'policy_head_hidden_sizes': [32], 'value_head_hidden_sizes': [101], 'embedding_hidden_sizes': [121]}, catalog_class=None, load_state_path=None, model_config_dict=None), 'intrinsic_reward_module': RLModuleSpec(module_class=<class 'source.intrinsic_attention_ppo.rl_modules.IntrinsicAttentionModule.IntrinsicAttentionModule'>, observation_space=None, action_space=None, inference_only=False, learner_only=True, model_config={'intrinsic_reward_network': {'encoder_hidden_sizes': [], 'encoding_dim': 1, 'num_heads': 1, 'head_hidden_sizes': None, 'layers': [{'type': 'attention'}]}, 'extrinsic_value_hidden_layers': [127, 60], 'vf_share_layers': True, 'max_seq_len': 3}, catalog_class=None, load_state_path=None, model_config_dict=None)}, load_state_path=None, modules_to_load=None, module_specs={'default_policy': RLModuleSpec(module_class=<class 'source.intrinsic_attention_ppo.rl_modules.DifferentiablePPOModule.DifferentiablePPOModule'>, observation_space=None, action_space=None, inference_only=False, learner_only=False, model_config={'vf_share_layers': True, 'embedding_dim': 62, 'max_seq_len': 3, 'policy_head_hidden_sizes': [32], 'value_head_hidden_sizes': [101], 'embedding_hidden_sizes': [121]}, catalog_class=None, load_state_path=None, model_config_dict=None), 'intrinsic_reward_module': RLModuleSpec(module_class=<class 'source.intrinsic_attention_ppo.rl_modules.IntrinsicAttentionModule.IntrinsicAttentionModule'>, observation_space=None, action_space=None, inference_only=False, learner_only=True, model_config={'intrinsic_reward_network': {'encoder_hidden_sizes': [], 'encoding_dim': 1, 'num_heads': 1, 'head_hidden_sizes': None, 'layers': [{'type': 'attention'}]}, 'extrinsic_value_hidden_layers': [127, 60], 'vf_share_layers': True, 'max_seq_len': 3}, catalog_class=None, load_state_path=None, model_config_dict=None)})", "algorithm_config_overrides_per_module": {"intrinsic_reward_module": {"lr": 0.0002715581955}}, "_per_module_overrides": {}, "_validate_config": true, "_use_msgpack_checkpoints": false, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "env_task_fn": -1, "enable_connectors": -1, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.161583927863, "kl_target": 0.0201019014258, "vf_loss_coeff": 0.7790510010087, "entropy_coeff": 0.0015431216992, "clip_param": 0.2459212356676, "vf_clip_param": 0.3769744131561, "entropy_coeff_schedule": null, "lr_schedule": null, "sgd_minibatch_size": -1, "vf_share_layers": -1, "differentiable_learner_configs": ["DifferentiableLearnerConfig(learner_class=<class 'source.intrinsic_attention_ppo.learners.IntrinsicAttentionPPOLearner.IntrinsicAttentionPPOLearner'>, learner_connector=None, add_default_connectors_to_learner_pipeline=True, is_multi_agent=False, policies_to_update=['default_policy'], lr=0.0060984166342, num_total_minibatches=0, num_epochs=1, minibatch_size=1000, shuffle_batch_per_epoch=True)"], "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9485408017724, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.callbacks.callbacks.RLlibCallback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 157.40397310256958, "iterations_since_restore": 13, "perf": {"cpu_util_percent": 51.89411764705883, "ram_util_percent": 82.62941176470588}}
{"timers": {"training_iteration": 11.101854575121981, "restore_env_runners": 2.1360125331091807e-05, "training_step": 11.101561524404874, "env_runner_sampling_timer": 1.7518053664764017, "learner_update_timer": 9.133851379522792, "synch_weights": 0.001744233954319099, "restore_eval_env_runners": 8.255496649405865e-05, "evaluation_iteration": 0.13806105281076134, "synch_eval_env_connectors": 0.00019440943271424054, "synch_env_connectors": 4.971993379368474e-06}, "env_runners": {"module_to_env_connector": {"timers": {"connectors": {"listify_data_for_vector_env": 1.0719091843902704e-05, "normalize_and_clip_actions": 8.068746643861296e-06, "get_actions": 4.049244627517411e-05, "tensor_to_numpy": 1.5539021900040963e-05, "un_batch_to_individual_items": 6.718120289715072e-06, "remove_single_ts_time_rank_from_batch": 1.1964396529336504e-05}}, "connector_pipeline_timer": 0.0001209200230975097}, "time_between_sampling": 0.04345950695197084, "env_to_module_sum_episodes_length_in": 10.36823839457432, "env_to_module_connector": {"timers": {"connectors": {"add_observations_from_episodes_to_batch": 2.8283641610226266e-06, "numpy_to_tensor": 1.2706979103596683e-05, "batch_individual_items": 1.2574313649730991e-05, "add_states_from_episodes_to_batch": 2.7672414535902107e-06, "add_time_dim_to_batch_and_zero_pad": 7.055994809098555e-06}}, "connector_pipeline_timer": 6.0687859658267006e-05}, "num_agent_steps_sampled_lifetime": {"default_agent": -7400000.0}, "env_reset_timer": 4.194121095459458e-05, "episode_return_mean": 4.18, "episode_return_min": -9.5, "env_to_module_sum_episodes_length_out": 10.36823839457432, "module_episode_returns_mean": {"default_policy": 4.18}, "agent_episode_returns_mean": {"default_agent": 4.18}, "episode_len_max": 20, "sample": 0.0062560441839951235, "rlmodule_inference_timer": 6.420747080353664e-05, "episode_len_mean": 20.0, "num_env_steps_sampled": 5000.0, "weights_seq_no": 13.0, "num_agent_steps_sampled": {"default_agent": 5000.0}, "episode_return_max": 10.5, "num_episodes": 250.0, "num_module_steps_sampled": {"default_policy": 5000.0}, "env_step_timer": 1.408882002699202e-05, "num_module_steps_sampled_lifetime": {"default_policy": -7400000.0}, "episode_duration_sec_mean": 0.005961344646755605, "num_episodes_lifetime": -370000.0, "num_env_steps_sampled_lifetime": -7400000.0, "episode_len_min": 20, "num_env_steps_sampled_lifetime_throughput": 3177.1897132940444}, "__all_modules__": {"learner_connector_sum_episodes_length_in": 5000.0, "learner_connector": {"connector_pipeline_timer": 0.17520372211800234, "timers": {"connectors": {"add_one_ts_to_episodes_and_truncate": 0.00910348420601979, "add_observations_from_episodes_to_batch": 0.0008353215371111944, "add_columns_from_episodes_to_train_batch": 0.04181185936793206, "add_time_dim_to_batch_and_zero_pad": 0.10336478085550517, "add_states_from_episodes_to_batch": 0.003545765268197777, "batch_individual_items": 0.016323381973856136, "numpy_to_tensor": 7.468429242168293e-05}}}, "learner_connector_sum_episodes_length_out": 5250.0}, "learners": {"intrinsic_reward_module": {"gradients_default_optimizer_global_norm": 0.0, "num_module_steps_trained": 5994, "total_loss": 0.0, "num_trainable_parameters": 8266, "default_optimizer_learning_rate": 0.0002715581955, "curr_entropy_coeff": 0.0015431216992, "weights_seq_no": 14.0, "diff_num_grad_updates_vs_sampler_policy": 1.0, "num_module_steps_trained_lifetime": 83916, "module_train_batch_size_mean": 999.0, "num_module_steps_trained_lifetime_throughput": 622.2302845633473}, "__all_modules__": {"num_module_steps_trained_lifetime": 167832, "num_module_steps_trained": 11988, "num_non_trainable_parameters": 0, "num_env_steps_trained": 31500, "num_env_steps_trained_lifetime": 441000, "num_trainable_parameters": 24861, "num_env_steps_trained_lifetime_throughput": 3270.021235878151, "num_module_steps_trained_throughput": 20219800.884696595, "num_module_steps_trained_lifetime_throughput": 11505450.391843067}, "differentiable_learners": {"intrinsic_attention_ppo_learner": {"intrinsic_reward_module": {"diff_num_grad_updates_vs_sampler_policy": 71.0, "total_loss": 0.0, "num_module_steps_trained_lifetime": 503496, "num_module_steps_trained": 35964, "module_train_batch_size_mean": 999.0, "weights_seq_no": 84.0}, "default_policy": {"num_module_steps_trained_lifetime": 503496, "num_module_steps_trained": 35964, "module_train_batch_size_mean": 999.0, "vf_loss_unclipped": 39.9380989074707, "mean_kl_loss": 1.9070528651354834e-05, "use_intrinsic_rewards": 1.0, "entropy": 0.673308789730072, "policy_loss": -0.00030806989525444806, "diff_num_grad_updates_vs_sampler_policy": 71.0, "total_loss": 0.20314185321331024, "vf_explained_var": 0.0020902156829833984, "weights_seq_no": 84.0, "vf_loss": 0.2624806761741638}, "__all_modules__": {"num_module_steps_trained_lifetime": 1006992, "num_env_steps_trained": 189000, "num_env_steps_trained_lifetime": 2646000, "num_module_steps_trained": 71928, "num_env_steps_trained_lifetime_throughput": 38123.84329347071}}}, "default_policy": {"vf_loss_unclipped": 40.07834243774414, "mean_kl_loss": 2.034994940913748e-05, "curr_kl_coeff": 9.862300430540927e-06, "curr_entropy_coeff": 0.0015431216992, "use_intrinsic_rewards": 0.0, "entropy": 0.6732689738273621, "policy_loss": -0.0003190517018083483, "diff_num_grad_updates_vs_sampler_policy": 1.0, "total_loss": 0.2030898779630661, "num_trainable_parameters": 16595, "vf_explained_var": 0.00022011995315551758, "weights_seq_no": 14.0, "vf_loss": 0.26243191957473755, "num_module_steps_trained_lifetime": 83916, "module_train_batch_size_mean": 999.0, "num_module_steps_trained": 5994, "num_module_steps_trained_lifetime_throughput": 622.2258674536438}, "IntrinsicAttentionMask": [[[0.3345363140106201, 0.33192166686058044, 0.33354195952415466], [0.3356791138648987, 0.33058398962020874, 0.33373692631721497], [0.33496981859207153, 0.3314139246940613, 0.33361631631851196]], [[0.3334019184112549, 0.33308473229408264, 0.3335132896900177], [0.333424836397171, 0.33300164341926575, 0.33357349038124084], [0.3333938717842102, 0.3331139087677002, 0.3334921896457672]], [[0.33275657892227173, 0.33413049578666687, 0.3331129550933838], [0.33283787965774536, 0.3340180516242981, 0.33314406871795654], [0.3327776789665222, 0.33410125970840454, 0.33312100172042847]], [[0.33359891176223755, 0.33316224813461304, 0.3332388401031494], [0.3336634635925293, 0.3331206738948822, 0.3332158327102661], [0.333652138710022, 0.3331279754638672, 0.33321988582611084]], [[0.3330192267894745, 0.3337673544883728, 0.3332134187221527], [0.3331005573272705, 0.3336549699306488, 0.3332444727420807], [0.33304035663604736, 0.33373814821243286, 0.3332214951515198]], [[0.33105650544166565, 0.33803102374076843, 0.33091244101524353], [0.33551183342933655, 0.3288355767726898, 0.3356526494026184], [0.33096280694007874, 0.3382243514060974, 0.33081287145614624]]]}, "num_training_step_calls_per_iteration": 1, "evaluation": {"env_runners": {"episode_len_max": 20, "rlmodule_inference_timer": 3.247684024467638e-05, "weights_seq_no": 14.0, "module_to_env_connector": {"timers": {"connectors": {"remove_single_ts_time_rank_from_batch": 1.2026246618268368e-05, "listify_data_for_vector_env": 1.1303400588733795e-05, "normalize_and_clip_actions": 8.532995931460034e-06, "get_actions": 3.869027882433302e-05, "tensor_to_numpy": 1.5937598468096203e-05, "un_batch_to_individual_items": 6.70677553598358e-06}}, "connector_pipeline_timer": 0.00011986131058779295}, "episode_return_max": 14.5, "num_episodes": 20, "num_episodes_lifetime": 280, "num_agent_steps_sampled_lifetime": {"default_agent": 5600}, "env_reset_timer": 0.0005346846955172912, "env_to_module_sum_episodes_length_out": 10.368238394574323, "num_module_steps_sampled_lifetime": {"default_policy": 5600}, "env_to_module_connector": {"timers": {"connectors": {"numpy_to_tensor": 1.2495359579016138e-05, "batch_individual_items": 1.3564112279603024e-05, "add_observations_from_episodes_to_batch": 2.9002879694441407e-06, "add_states_from_episodes_to_batch": 3.0388494087707624e-06, "add_time_dim_to_batch_and_zero_pad": 7.317053587019923e-06}}, "connector_pipeline_timer": 6.213378811482595e-05}, "episode_return_mean": 1.05, "sample": 0.12567081663632346, "episode_len_mean": 20.0, "env_step_timer": 1.4449615145693445e-05, "episode_duration_sec_mean": 0.0056162954238243405, "num_env_steps_sampled_lifetime": 70400, "agent_episode_returns_mean": {"default_agent": 1.05}, "num_env_steps_sampled": 400, "num_agent_steps_sampled": {"default_agent": 400}, "num_module_steps_sampled": {"default_policy": 400}, "episode_len_min": 20, "env_to_module_sum_episodes_length_in": 10.368238394574323, "module_episode_returns_mean": {"default_policy": 1.05}, "episode_return_min": -13.5, "time_between_sampling": 11.307962314806064}, "num_healthy_workers": 1, "actor_manager_num_outstanding_async_reqs": 0, "num_remote_worker_restarts": 0}, "num_env_steps_sampled_lifetime": -7400000.0, "fault_tolerance": {"num_healthy_workers": 0, "num_remote_worker_restarts": 0}, "env_runner_group": {"actor_manager_num_outstanding_async_reqs": 0}, "done": false, "training_iteration": 14, "trial_id": "ba99d_00000", "date": "2025-08-11_17-59-19", "timestamp": 1754927959, "time_this_iter_s": 11.992154836654663, "time_total_s": 169.39612793922424, "pid": 9655, "hostname": "Mac", "node_ip": "127.0.0.1", "config": {"exploration_config": {}, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 2, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "env": "Umbrella", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": false, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 0, "create_local_env_runner": true, "num_envs_per_env_runner": 1, "gym_env_vectorize_mode": "SYNC", "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "episodes_to_numpy": true, "max_requests_in_flight_per_env_runner": 1, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "merge_env_runner_states": "training_only", "broadcast_env_runner_states": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "complete_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "sampler_perf_stats_ema_coef": null, "_is_online": true, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": "auto", "num_aggregator_actors_per_learner": 0, "max_requests_in_flight_per_aggregator_actor": 3, "local_gpu_idx": 0, "max_requests_in_flight_per_learner": 3, "gamma": 1, "lr": 0.0002715581955, "grad_clip": 0.5, "grad_clip_by": "global_norm", "_train_batch_size_per_learner": 5000, "train_batch_size": 4000, "num_epochs": 1, "minibatch_size": 1000, "shuffle_batch_per_epoch": true, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "log_std_clip_param": 20.0, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "_disable_preprocessor_api": false, "_disable_action_flattening": false}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {"intrinsic_reward_coeff": 0.2795015916508}, "optimizer": {}, "_learner_class": "<class 'source.intrinsic_attention_ppo.learners.IntrinsicAttentionMetaLearner.IntrinsicAttentionMetaLearner'>", "callbacks_on_algorithm_init": null, "callbacks_on_env_runners_recreated": null, "callbacks_on_offline_eval_runners_recreated": null, "callbacks_on_checkpoint_loaded": null, "callbacks_on_environment_created": null, "callbacks_on_episode_created": null, "callbacks_on_episode_start": null, "callbacks_on_episode_step": null, "callbacks_on_episode_end": null, "callbacks_on_evaluate_start": null, "callbacks_on_evaluate_end": null, "callbacks_on_evaluate_offline_start": null, "callbacks_on_evaluate_offline_end": null, "callbacks_on_sample_end": null, "callbacks_on_train_result": null, "explore": true, "enable_rl_module_and_learner": true, "enable_env_runner_and_connector_v2": true, "_prior_exploration_config": {"type": "StochasticSampling"}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x15d6f98a0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "offline_data_class": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_read_batch_size": null, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "materialize_data": false, "materialize_mapped_data": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "ignore_final_observation": false, "prelearner_class": null, "prelearner_buffer_class": null, "prelearner_buffer_kwargs": {}, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_remaining_data": false, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": 1, "evaluation_duration": 20, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_auto_duration_min_env_steps_per_sample": 100, "evaluation_auto_duration_max_env_steps_per_sample": 2000, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 1, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "offline_evaluation_interval": null, "num_offline_eval_runners": 0, "offline_loss_for_module_fn": null, "offline_evaluation_duration": 1, "offline_evaluation_parallel_to_training": false, "offline_evaluation_timeout_s": 120.0, "num_cpus_per_offline_eval_runner": 1, "num_gpus_per_offline_eval_runner": 0, "custom_resources_per_offline_eval_runner": {}, "restart_failed_offline_eval_runners": true, "ignore_offline_eval_runner_failures": false, "max_num_offline_eval_runner_restarts": 1000, "offline_eval_runner_restore_timeout_s": 1800.0, "max_requests_in_flight_per_offline_eval_runner": 1, "validate_offline_eval_runners_after_construction": true, "offline_eval_runner_health_probe_timeout_s": 30.0, "offline_eval_rl_module_inference_only": false, "broadcast_offline_eval_runner_states": false, "offline_eval_batch_size_per_runner": 256, "dataset_num_iters_per_eval_runner": 1, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "log_gradients": false, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 6, "restart_failed_env_runners": true, "ignore_env_runner_failures": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30.0, "env_runner_restore_timeout_s": 1800.0, "_model_config": {}, "_rl_module_spec": "MultiRLModuleSpec(multi_rl_module_class=<class 'ray.rllib.core.rl_module.multi_rl_module.MultiRLModule'>, observation_space=None, action_space=None, inference_only=False, model_config=None, rl_module_specs={'default_policy': RLModuleSpec(module_class=<class 'source.intrinsic_attention_ppo.rl_modules.DifferentiablePPOModule.DifferentiablePPOModule'>, observation_space=None, action_space=None, inference_only=False, learner_only=False, model_config={'vf_share_layers': True, 'embedding_dim': 62, 'max_seq_len': 3, 'policy_head_hidden_sizes': [32], 'value_head_hidden_sizes': [101], 'embedding_hidden_sizes': [121]}, catalog_class=None, load_state_path=None, model_config_dict=None), 'intrinsic_reward_module': RLModuleSpec(module_class=<class 'source.intrinsic_attention_ppo.rl_modules.IntrinsicAttentionModule.IntrinsicAttentionModule'>, observation_space=None, action_space=None, inference_only=False, learner_only=True, model_config={'intrinsic_reward_network': {'encoder_hidden_sizes': [], 'encoding_dim': 1, 'num_heads': 1, 'head_hidden_sizes': None, 'layers': [{'type': 'attention'}]}, 'extrinsic_value_hidden_layers': [127, 60], 'vf_share_layers': True, 'max_seq_len': 3}, catalog_class=None, load_state_path=None, model_config_dict=None)}, load_state_path=None, modules_to_load=None, module_specs={'default_policy': RLModuleSpec(module_class=<class 'source.intrinsic_attention_ppo.rl_modules.DifferentiablePPOModule.DifferentiablePPOModule'>, observation_space=None, action_space=None, inference_only=False, learner_only=False, model_config={'vf_share_layers': True, 'embedding_dim': 62, 'max_seq_len': 3, 'policy_head_hidden_sizes': [32], 'value_head_hidden_sizes': [101], 'embedding_hidden_sizes': [121]}, catalog_class=None, load_state_path=None, model_config_dict=None), 'intrinsic_reward_module': RLModuleSpec(module_class=<class 'source.intrinsic_attention_ppo.rl_modules.IntrinsicAttentionModule.IntrinsicAttentionModule'>, observation_space=None, action_space=None, inference_only=False, learner_only=True, model_config={'intrinsic_reward_network': {'encoder_hidden_sizes': [], 'encoding_dim': 1, 'num_heads': 1, 'head_hidden_sizes': None, 'layers': [{'type': 'attention'}]}, 'extrinsic_value_hidden_layers': [127, 60], 'vf_share_layers': True, 'max_seq_len': 3}, catalog_class=None, load_state_path=None, model_config_dict=None)})", "algorithm_config_overrides_per_module": {"intrinsic_reward_module": {"lr": 0.0002715581955}}, "_per_module_overrides": {}, "_validate_config": true, "_use_msgpack_checkpoints": false, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "env_task_fn": -1, "enable_connectors": -1, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.161583927863, "kl_target": 0.0201019014258, "vf_loss_coeff": 0.7790510010087, "entropy_coeff": 0.0015431216992, "clip_param": 0.2459212356676, "vf_clip_param": 0.3769744131561, "entropy_coeff_schedule": null, "lr_schedule": null, "sgd_minibatch_size": -1, "vf_share_layers": -1, "differentiable_learner_configs": ["DifferentiableLearnerConfig(learner_class=<class 'source.intrinsic_attention_ppo.learners.IntrinsicAttentionPPOLearner.IntrinsicAttentionPPOLearner'>, learner_connector=None, add_default_connectors_to_learner_pipeline=True, is_multi_agent=False, policies_to_update=['default_policy'], lr=0.0060984166342, num_total_minibatches=0, num_epochs=1, minibatch_size=1000, shuffle_batch_per_epoch=True)"], "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9485408017724, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.callbacks.callbacks.RLlibCallback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 169.39612793922424, "iterations_since_restore": 14, "perf": {"cpu_util_percent": 43.58235294117647, "ram_util_percent": 81.14117647058822}}
{"timers": {"training_iteration": 11.110824794781141, "restore_env_runners": 2.1251113931216644e-05, "training_step": 11.110532107911382, "env_runner_sampling_timer": 1.7522740578112903, "learner_update_timer": 9.142146504067147, "synch_weights": 0.0017488512041674822, "restore_eval_env_runners": 8.224524729936711e-05, "evaluation_iteration": 0.13799024603255403, "synch_eval_env_connectors": 0.00019536866899257522, "synch_env_connectors": 4.964773187114148e-06}, "env_runners": {"module_to_env_connector": {"timers": {"connectors": {"listify_data_for_vector_env": 1.1091708690197183e-05, "normalize_and_clip_actions": 8.396010921657293e-06, "get_actions": 4.2846486843427804e-05, "tensor_to_numpy": 1.6222895002270827e-05, "un_batch_to_individual_items": 6.939274846892624e-06, "remove_single_ts_time_rank_from_batch": 1.2240902344728713e-05}}, "connector_pipeline_timer": 0.0001258599862207302}, "time_between_sampling": 0.041886199387749304, "env_to_module_sum_episodes_length_in": 10.36823839457432, "env_to_module_connector": {"timers": {"connectors": {"add_observations_from_episodes_to_batch": 2.9151454852761213e-06, "numpy_to_tensor": 1.3455262198161617e-05, "batch_individual_items": 1.3073896125871335e-05, "add_states_from_episodes_to_batch": 2.848084613414162e-06, "add_time_dim_to_batch_and_zero_pad": 7.359395424210494e-06}}, "connector_pipeline_timer": 6.313330852822614e-05}, "num_agent_steps_sampled_lifetime": {"default_agent": -8017500.0}, "env_reset_timer": 4.6364373136408475e-05, "episode_return_mean": 2.740000000000001, "episode_return_min": -9.5, "env_to_module_sum_episodes_length_out": 10.36823839457432, "module_episode_returns_mean": {"default_policy": 2.740000000000001}, "agent_episode_returns_mean": {"default_agent": 2.740000000000001}, "episode_len_max": 20, "sample": 0.006243321526124701, "rlmodule_inference_timer": 6.237483049006972e-05, "episode_len_mean": 20.0, "num_env_steps_sampled": 5000.0, "weights_seq_no": 14.0, "num_agent_steps_sampled": {"default_agent": 5000.0}, "episode_return_max": 10.5, "num_episodes": 250.0, "num_module_steps_sampled": {"default_policy": 5000.0}, "env_step_timer": 1.485859758099264e-05, "num_module_steps_sampled_lifetime": {"default_policy": -8017500.0}, "episode_duration_sec_mean": 0.006232438356615602, "num_episodes_lifetime": -400875.0, "num_env_steps_sampled_lifetime": -8017500.0, "episode_len_min": 20, "num_env_steps_sampled_lifetime_throughput": 3038.3586386414954}, "__all_modules__": {"learner_connector_sum_episodes_length_in": 5000.0, "learner_connector": {"connector_pipeline_timer": 0.17523952906670723, "timers": {"connectors": {"add_one_ts_to_episodes_and_truncate": 0.009102879364523676, "add_observations_from_episodes_to_batch": 0.0008352774909468507, "add_columns_from_episodes_to_train_batch": 0.0418250632750609, "add_time_dim_to_batch_and_zero_pad": 0.10341239638609709, "add_states_from_episodes_to_batch": 0.0035499288648227463, "batch_individual_items": 0.01629471523348469, "numpy_to_tensor": 7.473036938842119e-05}}}, "learner_connector_sum_episodes_length_out": 5250.0}, "learners": {"intrinsic_reward_module": {"gradients_default_optimizer_global_norm": 0.0, "num_module_steps_trained": 5994, "total_loss": 0.0, "num_trainable_parameters": 8266, "default_optimizer_learning_rate": 0.0002715581955, "curr_entropy_coeff": 0.0015431216992, "weights_seq_no": 15.0, "diff_num_grad_updates_vs_sampler_policy": 1.0, "num_module_steps_trained_lifetime": 89910, "module_train_batch_size_mean": 999.0, "num_module_steps_trained_lifetime_throughput": 619.0790371279163}, "__all_modules__": {"num_module_steps_trained_lifetime": 179820, "num_module_steps_trained": 11988, "num_non_trainable_parameters": 0, "num_env_steps_trained": 31500, "num_env_steps_trained_lifetime": 472500, "num_trainable_parameters": 24861, "num_env_steps_trained_lifetime_throughput": 3253.4593630290974, "num_module_steps_trained_throughput": 19760058.269266576, "num_module_steps_trained_lifetime_throughput": 11506109.551764674}, "differentiable_learners": {"intrinsic_attention_ppo_learner": {"intrinsic_reward_module": {"diff_num_grad_updates_vs_sampler_policy": 76.0, "total_loss": 0.0, "num_module_steps_trained_lifetime": 539460, "num_module_steps_trained": 35964, "module_train_batch_size_mean": 999.0, "weights_seq_no": 90.0}, "default_policy": {"num_module_steps_trained_lifetime": 539460, "num_module_steps_trained": 35964, "module_train_batch_size_mean": 999.0, "vf_loss_unclipped": 38.98478698730469, "mean_kl_loss": 9.31067370402161e-06, "use_intrinsic_rewards": 1.0, "entropy": 0.6715472340583801, "policy_loss": -0.0001541136734886095, "diff_num_grad_updates_vs_sampler_policy": 76.0, "total_loss": 0.20331840217113495, "vf_explained_var": 0.002312779426574707, "weights_seq_no": 90.0, "vf_loss": 0.26250821352005005}, "__all_modules__": {"num_module_steps_trained_lifetime": 1078920, "num_env_steps_trained": 189000, "num_env_steps_trained_lifetime": 2835000, "num_module_steps_trained": 71928, "num_env_steps_trained_lifetime_throughput": 37479.64513886059}}}, "default_policy": {"vf_loss_unclipped": 39.08370590209961, "mean_kl_loss": 9.93640878732549e-06, "curr_kl_coeff": 4.931150215270463e-06, "curr_entropy_coeff": 0.0015431216992, "use_intrinsic_rewards": 0.0, "entropy": 0.6715179681777954, "policy_loss": -0.0001587095612194389, "diff_num_grad_updates_vs_sampler_policy": 1.0, "total_loss": 0.20325422286987305, "num_trainable_parameters": 16595, "vf_explained_var": 0.000232696533203125, "weights_seq_no": 15.0, "vf_loss": 0.26243361830711365, "num_module_steps_trained_lifetime": 89910, "module_train_batch_size_mean": 999.0, "num_module_steps_trained": 5994, "num_module_steps_trained_lifetime_throughput": 619.0749446850593}, "IntrinsicAttentionMask": [[[0.33453699946403503, 0.3328125774860382, 0.33265045285224915], [0.3352906405925751, 0.33248624205589294, 0.3322230577468872], [0.3353617489337921, 0.33245545625686646, 0.33218276500701904]], [[0.3335764408111572, 0.33273571729660034, 0.3336878716945648], [0.3337916433811188, 0.33220627903938293, 0.3340020477771759], [0.3335479199886322, 0.3328058421611786, 0.3336462676525116]], [[0.332987517118454, 0.3338111340999603, 0.3332012891769409], [0.33306884765625, 0.33369874954223633, 0.3332323729991913], [0.33300867676734924, 0.3337819576263428, 0.33320939540863037]], [[0.33349233865737915, 0.3332309126853943, 0.33327677845954895], [0.3335568904876709, 0.33318933844566345, 0.3332538306713104], [0.3335455656051636, 0.33319664001464844, 0.33325785398483276]], [[0.33251821994781494, 0.3347083032131195, 0.33277347683906555], [0.3328745365142822, 0.33410707116127014, 0.33301836252212524], [0.33255985379219055, 0.33463799953460693, 0.3328021168708801]], [[0.3317093253135681, 0.3366844654083252, 0.3316062390804291], [0.3361548185348511, 0.3275074362754822, 0.33633774518966675], [0.33161577582359314, 0.33687737584114075, 0.3315068185329437]]]}, "num_training_step_calls_per_iteration": 1, "evaluation": {"env_runners": {"episode_len_max": 20, "rlmodule_inference_timer": 3.3962025843075677e-05, "weights_seq_no": 15.0, "module_to_env_connector": {"timers": {"connectors": {"remove_single_ts_time_rank_from_batch": 1.2190114196616336e-05, "listify_data_for_vector_env": 1.0919577227481528e-05, "normalize_and_clip_actions": 8.26528334479959e-06, "get_actions": 4.0819583251648865e-05, "tensor_to_numpy": 1.6371964975809663e-05, "un_batch_to_individual_items": 6.9096427977646455e-06}}, "connector_pipeline_timer": 0.0001228768219703231}, "episode_return_max": 14.5, "num_episodes": 20, "num_episodes_lifetime": 300, "num_agent_steps_sampled_lifetime": {"default_agent": 6000}, "env_reset_timer": 0.0005349274277941554, "env_to_module_sum_episodes_length_out": 10.368238394574323, "num_module_steps_sampled_lifetime": {"default_policy": 6000}, "env_to_module_connector": {"timers": {"connectors": {"numpy_to_tensor": 1.2973609990595259e-05, "batch_individual_items": 1.3027560015463841e-05, "add_observations_from_episodes_to_batch": 2.9353384125936812e-06, "add_states_from_episodes_to_batch": 3.045611213788591e-06, "add_time_dim_to_batch_and_zero_pad": 7.561563399696455e-06}}, "connector_pipeline_timer": 6.241525714850104e-05}, "episode_return_mean": 1.25, "sample": 0.12570890389021386, "episode_len_mean": 20.0, "env_step_timer": 1.4985361702395292e-05, "episode_duration_sec_mean": 0.005589911243878305, "num_env_steps_sampled_lifetime": 75400, "agent_episode_returns_mean": {"default_agent": 1.25}, "num_env_steps_sampled": 400, "num_agent_steps_sampled": {"default_agent": 400}, "num_module_steps_sampled": {"default_policy": 400}, "episode_len_min": 20, "env_to_module_sum_episodes_length_in": 10.368238394574323, "module_episode_returns_mean": {"default_policy": 1.25}, "episode_return_min": -13.5, "time_between_sampling": 11.315237833317969}, "num_healthy_workers": 1, "actor_manager_num_outstanding_async_reqs": 0, "num_remote_worker_restarts": 0}, "num_env_steps_sampled_lifetime": -8017500.0, "fault_tolerance": {"num_healthy_workers": 0, "num_remote_worker_restarts": 0}, "env_runner_group": {"actor_manager_num_outstanding_async_reqs": 0}, "done": false, "training_iteration": 15, "trial_id": "ba99d_00000", "date": "2025-08-11_17-59-31", "timestamp": 1754927971, "time_this_iter_s": 12.145406007766724, "time_total_s": 181.54153394699097, "pid": 9655, "hostname": "Mac", "node_ip": "127.0.0.1", "config": {"exploration_config": {}, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 2, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "env": "Umbrella", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": false, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 0, "create_local_env_runner": true, "num_envs_per_env_runner": 1, "gym_env_vectorize_mode": "SYNC", "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "episodes_to_numpy": true, "max_requests_in_flight_per_env_runner": 1, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "merge_env_runner_states": "training_only", "broadcast_env_runner_states": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "complete_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "sampler_perf_stats_ema_coef": null, "_is_online": true, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": "auto", "num_aggregator_actors_per_learner": 0, "max_requests_in_flight_per_aggregator_actor": 3, "local_gpu_idx": 0, "max_requests_in_flight_per_learner": 3, "gamma": 1, "lr": 0.0002715581955, "grad_clip": 0.5, "grad_clip_by": "global_norm", "_train_batch_size_per_learner": 5000, "train_batch_size": 4000, "num_epochs": 1, "minibatch_size": 1000, "shuffle_batch_per_epoch": true, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "log_std_clip_param": 20.0, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "_disable_preprocessor_api": false, "_disable_action_flattening": false}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {"intrinsic_reward_coeff": 0.2795015916508}, "optimizer": {}, "_learner_class": "<class 'source.intrinsic_attention_ppo.learners.IntrinsicAttentionMetaLearner.IntrinsicAttentionMetaLearner'>", "callbacks_on_algorithm_init": null, "callbacks_on_env_runners_recreated": null, "callbacks_on_offline_eval_runners_recreated": null, "callbacks_on_checkpoint_loaded": null, "callbacks_on_environment_created": null, "callbacks_on_episode_created": null, "callbacks_on_episode_start": null, "callbacks_on_episode_step": null, "callbacks_on_episode_end": null, "callbacks_on_evaluate_start": null, "callbacks_on_evaluate_end": null, "callbacks_on_evaluate_offline_start": null, "callbacks_on_evaluate_offline_end": null, "callbacks_on_sample_end": null, "callbacks_on_train_result": null, "explore": true, "enable_rl_module_and_learner": true, "enable_env_runner_and_connector_v2": true, "_prior_exploration_config": {"type": "StochasticSampling"}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x15d6f98a0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "offline_data_class": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_read_batch_size": null, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "materialize_data": false, "materialize_mapped_data": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "ignore_final_observation": false, "prelearner_class": null, "prelearner_buffer_class": null, "prelearner_buffer_kwargs": {}, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_remaining_data": false, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": 1, "evaluation_duration": 20, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_auto_duration_min_env_steps_per_sample": 100, "evaluation_auto_duration_max_env_steps_per_sample": 2000, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 1, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "offline_evaluation_interval": null, "num_offline_eval_runners": 0, "offline_loss_for_module_fn": null, "offline_evaluation_duration": 1, "offline_evaluation_parallel_to_training": false, "offline_evaluation_timeout_s": 120.0, "num_cpus_per_offline_eval_runner": 1, "num_gpus_per_offline_eval_runner": 0, "custom_resources_per_offline_eval_runner": {}, "restart_failed_offline_eval_runners": true, "ignore_offline_eval_runner_failures": false, "max_num_offline_eval_runner_restarts": 1000, "offline_eval_runner_restore_timeout_s": 1800.0, "max_requests_in_flight_per_offline_eval_runner": 1, "validate_offline_eval_runners_after_construction": true, "offline_eval_runner_health_probe_timeout_s": 30.0, "offline_eval_rl_module_inference_only": false, "broadcast_offline_eval_runner_states": false, "offline_eval_batch_size_per_runner": 256, "dataset_num_iters_per_eval_runner": 1, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "log_gradients": false, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 6, "restart_failed_env_runners": true, "ignore_env_runner_failures": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30.0, "env_runner_restore_timeout_s": 1800.0, "_model_config": {}, "_rl_module_spec": "MultiRLModuleSpec(multi_rl_module_class=<class 'ray.rllib.core.rl_module.multi_rl_module.MultiRLModule'>, observation_space=None, action_space=None, inference_only=False, model_config=None, rl_module_specs={'default_policy': RLModuleSpec(module_class=<class 'source.intrinsic_attention_ppo.rl_modules.DifferentiablePPOModule.DifferentiablePPOModule'>, observation_space=None, action_space=None, inference_only=False, learner_only=False, model_config={'vf_share_layers': True, 'embedding_dim': 62, 'max_seq_len': 3, 'policy_head_hidden_sizes': [32], 'value_head_hidden_sizes': [101], 'embedding_hidden_sizes': [121]}, catalog_class=None, load_state_path=None, model_config_dict=None), 'intrinsic_reward_module': RLModuleSpec(module_class=<class 'source.intrinsic_attention_ppo.rl_modules.IntrinsicAttentionModule.IntrinsicAttentionModule'>, observation_space=None, action_space=None, inference_only=False, learner_only=True, model_config={'intrinsic_reward_network': {'encoder_hidden_sizes': [], 'encoding_dim': 1, 'num_heads': 1, 'head_hidden_sizes': None, 'layers': [{'type': 'attention'}]}, 'extrinsic_value_hidden_layers': [127, 60], 'vf_share_layers': True, 'max_seq_len': 3}, catalog_class=None, load_state_path=None, model_config_dict=None)}, load_state_path=None, modules_to_load=None, module_specs={'default_policy': RLModuleSpec(module_class=<class 'source.intrinsic_attention_ppo.rl_modules.DifferentiablePPOModule.DifferentiablePPOModule'>, observation_space=None, action_space=None, inference_only=False, learner_only=False, model_config={'vf_share_layers': True, 'embedding_dim': 62, 'max_seq_len': 3, 'policy_head_hidden_sizes': [32], 'value_head_hidden_sizes': [101], 'embedding_hidden_sizes': [121]}, catalog_class=None, load_state_path=None, model_config_dict=None), 'intrinsic_reward_module': RLModuleSpec(module_class=<class 'source.intrinsic_attention_ppo.rl_modules.IntrinsicAttentionModule.IntrinsicAttentionModule'>, observation_space=None, action_space=None, inference_only=False, learner_only=True, model_config={'intrinsic_reward_network': {'encoder_hidden_sizes': [], 'encoding_dim': 1, 'num_heads': 1, 'head_hidden_sizes': None, 'layers': [{'type': 'attention'}]}, 'extrinsic_value_hidden_layers': [127, 60], 'vf_share_layers': True, 'max_seq_len': 3}, catalog_class=None, load_state_path=None, model_config_dict=None)})", "algorithm_config_overrides_per_module": {"intrinsic_reward_module": {"lr": 0.0002715581955}}, "_per_module_overrides": {}, "_validate_config": true, "_use_msgpack_checkpoints": false, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "env_task_fn": -1, "enable_connectors": -1, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.161583927863, "kl_target": 0.0201019014258, "vf_loss_coeff": 0.7790510010087, "entropy_coeff": 0.0015431216992, "clip_param": 0.2459212356676, "vf_clip_param": 0.3769744131561, "entropy_coeff_schedule": null, "lr_schedule": null, "sgd_minibatch_size": -1, "vf_share_layers": -1, "differentiable_learner_configs": ["DifferentiableLearnerConfig(learner_class=<class 'source.intrinsic_attention_ppo.learners.IntrinsicAttentionPPOLearner.IntrinsicAttentionPPOLearner'>, learner_connector=None, add_default_connectors_to_learner_pipeline=True, is_multi_agent=False, policies_to_update=['default_policy'], lr=0.0060984166342, num_total_minibatches=0, num_epochs=1, minibatch_size=1000, shuffle_batch_per_epoch=True)"], "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9485408017724, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.callbacks.callbacks.RLlibCallback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 181.54153394699097, "iterations_since_restore": 15, "perf": {"cpu_util_percent": 49.20555555555555, "ram_util_percent": 81.82777777777777}}
{"timers": {"training_iteration": 11.120139833503451, "restore_env_runners": 2.1154432544662622e-05, "training_step": 11.119847337672477, "env_runner_sampling_timer": 1.7515200443226886, "learner_update_timer": 9.152105527366986, "synch_weights": 0.0017462301918293487, "restore_eval_env_runners": 8.187570514348147e-05, "evaluation_iteration": 0.13804340690212444, "synch_eval_env_connectors": 0.0001953574825418876, "synch_env_connectors": 5.004296099302785e-06}, "env_runners": {"module_to_env_connector": {"timers": {"connectors": {"listify_data_for_vector_env": 1.1096503476209024e-05, "normalize_and_clip_actions": 8.586936652918257e-06, "get_actions": 4.390114694781604e-05, "tensor_to_numpy": 1.6361031888679412e-05, "un_batch_to_individual_items": 6.953135911669056e-06, "remove_single_ts_time_rank_from_batch": 1.2445048137716408e-05}}, "connector_pipeline_timer": 0.00012786520205949244}, "time_between_sampling": 0.04203381388868259, "env_to_module_sum_episodes_length_in": 10.36823839457432, "env_to_module_connector": {"timers": {"connectors": {"add_observations_from_episodes_to_batch": 2.9770046485989132e-06, "numpy_to_tensor": 1.3872462995505469e-05, "batch_individual_items": 1.3220920264464681e-05, "add_states_from_episodes_to_batch": 2.8609346815984118e-06, "add_time_dim_to_batch_and_zero_pad": 7.53429750583664e-06}}, "connector_pipeline_timer": 6.41420208659136e-05}, "num_agent_steps_sampled_lifetime": {"default_agent": -8635000.0}, "env_reset_timer": 5.112935640611235e-05, "episode_return_mean": 2.9800000000000004, "episode_return_min": -9.5, "env_to_module_sum_episodes_length_out": 10.36823839457432, "module_episode_returns_mean": {"default_policy": 2.9800000000000004}, "agent_episode_returns_mean": {"default_agent": 2.9800000000000004}, "episode_len_max": 20, "sample": 0.006481520414334739, "rlmodule_inference_timer": 3.4969377274286034e-05, "episode_len_mean": 20.0, "num_env_steps_sampled": 5000.0, "weights_seq_no": 15.0, "num_agent_steps_sampled": {"default_agent": 5000.0}, "episode_return_max": 10.5, "num_episodes": 250.0, "num_module_steps_sampled": {"default_policy": 5000.0}, "env_step_timer": 1.5112157235276632e-05, "num_module_steps_sampled_lifetime": {"default_policy": -8635000.0}, "episode_duration_sec_mean": 0.005704760494641961, "num_episodes_lifetime": -431750.0, "num_env_steps_sampled_lifetime": -8635000.0, "episode_len_min": 20, "num_env_steps_sampled_lifetime_throughput": 2989.881511817385}, "__all_modules__": {"learner_connector_sum_episodes_length_in": 5000.0, "learner_connector": {"connector_pipeline_timer": 0.17524194460591988, "timers": {"connectors": {"add_one_ts_to_episodes_and_truncate": 0.009102043900257402, "add_observations_from_episodes_to_batch": 0.0008352872162672326, "add_columns_from_episodes_to_train_batch": 0.04183218389174948, "add_time_dim_to_batch_and_zero_pad": 0.10343221367208352, "add_states_from_episodes_to_batch": 0.00355286832637263, "batch_individual_items": 0.01626837766151765, "numpy_to_tensor": 7.471931577097993e-05}}}, "learner_connector_sum_episodes_length_out": 5250.0}, "learners": {"intrinsic_reward_module": {"gradients_default_optimizer_global_norm": 0.0, "num_module_steps_trained": 5994, "total_loss": 0.0, "num_trainable_parameters": 8266, "default_optimizer_learning_rate": 0.0002715581955, "curr_entropy_coeff": 0.0015431216992, "weights_seq_no": 16.0, "diff_num_grad_updates_vs_sampler_policy": 1.0, "num_module_steps_trained_lifetime": 95904, "module_train_batch_size_mean": 999.0, "num_module_steps_trained_lifetime_throughput": 615.9118747544321}, "__all_modules__": {"num_module_steps_trained_lifetime": 191808, "num_module_steps_trained": 11988, "num_non_trainable_parameters": 0, "num_env_steps_trained": 31500, "num_env_steps_trained_lifetime": 504000, "num_trainable_parameters": 24861, "num_env_steps_trained_lifetime_throughput": 3236.813666933831, "num_module_steps_trained_throughput": 19341869.387037497, "num_module_steps_trained_lifetime_throughput": 11524046.412525995}, "differentiable_learners": {"intrinsic_attention_ppo_learner": {"intrinsic_reward_module": {"diff_num_grad_updates_vs_sampler_policy": 81.0, "total_loss": 0.0, "num_module_steps_trained_lifetime": 575424, "num_module_steps_trained": 35964, "module_train_batch_size_mean": 999.0, "weights_seq_no": 96.0}, "default_policy": {"num_module_steps_trained_lifetime": 575424, "num_module_steps_trained": 35964, "module_train_batch_size_mean": 999.0, "vf_loss_unclipped": 39.3436279296875, "mean_kl_loss": 2.8703776479233056e-05, "use_intrinsic_rewards": 1.0, "entropy": 0.6702579259872437, "policy_loss": -0.0003929589584004134, "diff_num_grad_updates_vs_sampler_policy": 81.0, "total_loss": 0.2030794471502304, "vf_explained_var": 0.0021952390670776367, "weights_seq_no": 96.0, "vf_loss": 0.26250147819519043}, "__all_modules__": {"num_module_steps_trained_lifetime": 1150848, "num_env_steps_trained": 189000, "num_env_steps_trained_lifetime": 3024000, "num_module_steps_trained": 71928, "num_env_steps_trained_lifetime_throughput": 36853.49172150933}}}, "default_policy": {"vf_loss_unclipped": 39.46493148803711, "mean_kl_loss": 3.033674329344649e-05, "curr_kl_coeff": 2.4655751076352317e-06, "curr_entropy_coeff": 0.0015431216992, "use_intrinsic_rewards": 0.0, "entropy": 0.6702131628990173, "policy_loss": -0.00040427569183520973, "diff_num_grad_updates_vs_sampler_policy": 1.0, "total_loss": 0.20300978422164917, "num_trainable_parameters": 16595, "vf_explained_var": -1.7762184143066406e-05, "weights_seq_no": 16.0, "vf_loss": 0.2624324858188629, "num_module_steps_trained_lifetime": 95904, "module_train_batch_size_mean": 999.0, "num_module_steps_trained": 5994, "num_module_steps_trained_lifetime_throughput": 615.9080686929348}, "IntrinsicAttentionMask": [[[0.33348798751831055, 0.33277255296707153, 0.33373942971229553], [0.3335108757019043, 0.3326895236968994, 0.3337996304035187], [0.33347997069358826, 0.3328017592430115, 0.33371832966804504]], [[0.3337513208389282, 0.3329101800918579, 0.33333849906921387], [0.33412206172943115, 0.33253514766693115, 0.3333427906036377], [0.33393314480781555, 0.33272624015808105, 0.3333406448364258]], [[0.3333190679550171, 0.3330664038658142, 0.3336144983768463], [0.3333185017108917, 0.3330563008785248, 0.3336251378059387], [0.3333197236061096, 0.3330782353878021, 0.33360207080841064]], [[0.33349233865737915, 0.3332309126853943, 0.33327677845954895], [0.3335568904876709, 0.33318933844566345, 0.3332538306713104], [0.3335455656051636, 0.33319664001464844, 0.33325785398483276]], [[0.33173224329948425, 0.33461546897888184, 0.3336523473262787], [0.33226263523101807, 0.33419033885002136, 0.3335469961166382], [0.33208590745925903, 0.3343319296836853, 0.33358216285705566]], [[0.3317093253135681, 0.3366844654083252, 0.3316062390804291], [0.3361548185348511, 0.3275074064731598, 0.33633774518966675], [0.33161577582359314, 0.33687737584114075, 0.3315068185329437]]]}, "num_training_step_calls_per_iteration": 1, "evaluation": {"env_runners": {"episode_len_max": 20, "rlmodule_inference_timer": 4.187939012671007e-05, "weights_seq_no": 16.0, "module_to_env_connector": {"timers": {"connectors": {"remove_single_ts_time_rank_from_batch": 1.451293369393397e-05, "listify_data_for_vector_env": 1.3263683266416422e-05, "normalize_and_clip_actions": 1.0289986530114084e-05, "get_actions": 5.092989418929445e-05, "tensor_to_numpy": 1.9426592991078838e-05, "un_batch_to_individual_items": 8.556019143928087e-06}}, "connector_pipeline_timer": 0.00014989837698030096}, "episode_return_max": 14.5, "num_episodes": 20, "num_episodes_lifetime": 320, "num_agent_steps_sampled_lifetime": {"default_agent": 6400}, "env_reset_timer": 0.0005348852335075395, "env_to_module_sum_episodes_length_out": 10.368238394574323, "num_module_steps_sampled_lifetime": {"default_policy": 6400}, "env_to_module_connector": {"timers": {"connectors": {"numpy_to_tensor": 1.6114655342407133e-05, "batch_individual_items": 1.5975743449638585e-05, "add_observations_from_episodes_to_batch": 3.850876533999538e-06, "add_states_from_episodes_to_batch": 3.44199028087118e-06, "add_time_dim_to_batch_and_zero_pad": 1.080687933875472e-05}}, "connector_pipeline_timer": 7.791275049167322e-05}, "episode_return_mean": -0.15, "sample": 0.12601564401160714, "episode_len_mean": 20.0, "env_step_timer": 1.9193469433524832e-05, "episode_duration_sec_mean": 0.005873337498633191, "num_env_steps_sampled_lifetime": 80400, "agent_episode_returns_mean": {"default_agent": -0.15}, "num_env_steps_sampled": 400, "num_agent_steps_sampled": {"default_agent": 400}, "num_module_steps_sampled": {"default_policy": 400}, "episode_len_min": 20, "env_to_module_sum_episodes_length_in": 10.368238394574323, "module_episode_returns_mean": {"default_policy": -0.15}, "episode_return_min": -13.5, "time_between_sampling": 11.322906874145136}, "num_healthy_workers": 1, "actor_manager_num_outstanding_async_reqs": 0, "num_remote_worker_restarts": 0}, "num_env_steps_sampled_lifetime": -8635000.0, "fault_tolerance": {"num_healthy_workers": 0, "num_remote_worker_restarts": 0}, "env_runner_group": {"actor_manager_num_outstanding_async_reqs": 0}, "done": false, "training_iteration": 16, "trial_id": "ba99d_00000", "date": "2025-08-11_17-59-43", "timestamp": 1754927983, "time_this_iter_s": 12.215502977371216, "time_total_s": 193.75703692436218, "pid": 9655, "hostname": "Mac", "node_ip": "127.0.0.1", "config": {"exploration_config": {}, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 2, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "env": "Umbrella", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": false, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 0, "create_local_env_runner": true, "num_envs_per_env_runner": 1, "gym_env_vectorize_mode": "SYNC", "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "episodes_to_numpy": true, "max_requests_in_flight_per_env_runner": 1, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "merge_env_runner_states": "training_only", "broadcast_env_runner_states": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "complete_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "sampler_perf_stats_ema_coef": null, "_is_online": true, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": "auto", "num_aggregator_actors_per_learner": 0, "max_requests_in_flight_per_aggregator_actor": 3, "local_gpu_idx": 0, "max_requests_in_flight_per_learner": 3, "gamma": 1, "lr": 0.0002715581955, "grad_clip": 0.5, "grad_clip_by": "global_norm", "_train_batch_size_per_learner": 5000, "train_batch_size": 4000, "num_epochs": 1, "minibatch_size": 1000, "shuffle_batch_per_epoch": true, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "log_std_clip_param": 20.0, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "_disable_preprocessor_api": false, "_disable_action_flattening": false}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {"intrinsic_reward_coeff": 0.2795015916508}, "optimizer": {}, "_learner_class": "<class 'source.intrinsic_attention_ppo.learners.IntrinsicAttentionMetaLearner.IntrinsicAttentionMetaLearner'>", "callbacks_on_algorithm_init": null, "callbacks_on_env_runners_recreated": null, "callbacks_on_offline_eval_runners_recreated": null, "callbacks_on_checkpoint_loaded": null, "callbacks_on_environment_created": null, "callbacks_on_episode_created": null, "callbacks_on_episode_start": null, "callbacks_on_episode_step": null, "callbacks_on_episode_end": null, "callbacks_on_evaluate_start": null, "callbacks_on_evaluate_end": null, "callbacks_on_evaluate_offline_start": null, "callbacks_on_evaluate_offline_end": null, "callbacks_on_sample_end": null, "callbacks_on_train_result": null, "explore": true, "enable_rl_module_and_learner": true, "enable_env_runner_and_connector_v2": true, "_prior_exploration_config": {"type": "StochasticSampling"}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x15d6f98a0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "offline_data_class": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_read_batch_size": null, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "materialize_data": false, "materialize_mapped_data": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "ignore_final_observation": false, "prelearner_class": null, "prelearner_buffer_class": null, "prelearner_buffer_kwargs": {}, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_remaining_data": false, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": 1, "evaluation_duration": 20, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_auto_duration_min_env_steps_per_sample": 100, "evaluation_auto_duration_max_env_steps_per_sample": 2000, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 1, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "offline_evaluation_interval": null, "num_offline_eval_runners": 0, "offline_loss_for_module_fn": null, "offline_evaluation_duration": 1, "offline_evaluation_parallel_to_training": false, "offline_evaluation_timeout_s": 120.0, "num_cpus_per_offline_eval_runner": 1, "num_gpus_per_offline_eval_runner": 0, "custom_resources_per_offline_eval_runner": {}, "restart_failed_offline_eval_runners": true, "ignore_offline_eval_runner_failures": false, "max_num_offline_eval_runner_restarts": 1000, "offline_eval_runner_restore_timeout_s": 1800.0, "max_requests_in_flight_per_offline_eval_runner": 1, "validate_offline_eval_runners_after_construction": true, "offline_eval_runner_health_probe_timeout_s": 30.0, "offline_eval_rl_module_inference_only": false, "broadcast_offline_eval_runner_states": false, "offline_eval_batch_size_per_runner": 256, "dataset_num_iters_per_eval_runner": 1, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "log_gradients": false, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 6, "restart_failed_env_runners": true, "ignore_env_runner_failures": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30.0, "env_runner_restore_timeout_s": 1800.0, "_model_config": {}, "_rl_module_spec": "MultiRLModuleSpec(multi_rl_module_class=<class 'ray.rllib.core.rl_module.multi_rl_module.MultiRLModule'>, observation_space=None, action_space=None, inference_only=False, model_config=None, rl_module_specs={'default_policy': RLModuleSpec(module_class=<class 'source.intrinsic_attention_ppo.rl_modules.DifferentiablePPOModule.DifferentiablePPOModule'>, observation_space=None, action_space=None, inference_only=False, learner_only=False, model_config={'vf_share_layers': True, 'embedding_dim': 62, 'max_seq_len': 3, 'policy_head_hidden_sizes': [32], 'value_head_hidden_sizes': [101], 'embedding_hidden_sizes': [121]}, catalog_class=None, load_state_path=None, model_config_dict=None), 'intrinsic_reward_module': RLModuleSpec(module_class=<class 'source.intrinsic_attention_ppo.rl_modules.IntrinsicAttentionModule.IntrinsicAttentionModule'>, observation_space=None, action_space=None, inference_only=False, learner_only=True, model_config={'intrinsic_reward_network': {'encoder_hidden_sizes': [], 'encoding_dim': 1, 'num_heads': 1, 'head_hidden_sizes': None, 'layers': [{'type': 'attention'}]}, 'extrinsic_value_hidden_layers': [127, 60], 'vf_share_layers': True, 'max_seq_len': 3}, catalog_class=None, load_state_path=None, model_config_dict=None)}, load_state_path=None, modules_to_load=None, module_specs={'default_policy': RLModuleSpec(module_class=<class 'source.intrinsic_attention_ppo.rl_modules.DifferentiablePPOModule.DifferentiablePPOModule'>, observation_space=None, action_space=None, inference_only=False, learner_only=False, model_config={'vf_share_layers': True, 'embedding_dim': 62, 'max_seq_len': 3, 'policy_head_hidden_sizes': [32], 'value_head_hidden_sizes': [101], 'embedding_hidden_sizes': [121]}, catalog_class=None, load_state_path=None, model_config_dict=None), 'intrinsic_reward_module': RLModuleSpec(module_class=<class 'source.intrinsic_attention_ppo.rl_modules.IntrinsicAttentionModule.IntrinsicAttentionModule'>, observation_space=None, action_space=None, inference_only=False, learner_only=True, model_config={'intrinsic_reward_network': {'encoder_hidden_sizes': [], 'encoding_dim': 1, 'num_heads': 1, 'head_hidden_sizes': None, 'layers': [{'type': 'attention'}]}, 'extrinsic_value_hidden_layers': [127, 60], 'vf_share_layers': True, 'max_seq_len': 3}, catalog_class=None, load_state_path=None, model_config_dict=None)})", "algorithm_config_overrides_per_module": {"intrinsic_reward_module": {"lr": 0.0002715581955}}, "_per_module_overrides": {}, "_validate_config": true, "_use_msgpack_checkpoints": false, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "env_task_fn": -1, "enable_connectors": -1, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.161583927863, "kl_target": 0.0201019014258, "vf_loss_coeff": 0.7790510010087, "entropy_coeff": 0.0015431216992, "clip_param": 0.2459212356676, "vf_clip_param": 0.3769744131561, "entropy_coeff_schedule": null, "lr_schedule": null, "sgd_minibatch_size": -1, "vf_share_layers": -1, "differentiable_learner_configs": ["DifferentiableLearnerConfig(learner_class=<class 'source.intrinsic_attention_ppo.learners.IntrinsicAttentionPPOLearner.IntrinsicAttentionPPOLearner'>, learner_connector=None, add_default_connectors_to_learner_pipeline=True, is_multi_agent=False, policies_to_update=['default_policy'], lr=0.0060984166342, num_total_minibatches=0, num_epochs=1, minibatch_size=1000, shuffle_batch_per_epoch=True)"], "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9485408017724, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.callbacks.callbacks.RLlibCallback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 193.75703692436218, "iterations_since_restore": 16, "perf": {"cpu_util_percent": 47.247058823529414, "ram_util_percent": 82.72941176470589}}
{"timers": {"training_iteration": 11.130619166838184, "restore_env_runners": 2.1014978407257325e-05, "training_step": 11.130327421795297, "env_runner_sampling_timer": 1.7562690651295414, "learner_update_timer": 9.157176785423937, "synch_weights": 0.0017443149698765275, "restore_eval_env_runners": 8.135111796877115e-05, "evaluation_iteration": 0.138347661163964, "synch_eval_env_connectors": 0.00019536681788992957, "synch_env_connectors": 5.00759347461764e-06}, "env_runners": {"module_to_env_connector": {"timers": {"connectors": {"listify_data_for_vector_env": 1.437635614541701e-05, "normalize_and_clip_actions": 1.0835514008102038e-05, "get_actions": 6.0823993870025867e-05, "tensor_to_numpy": 2.1178116344997665e-05, "un_batch_to_individual_items": 8.511188431986057e-06, "remove_single_ts_time_rank_from_batch": 1.5511843915993413e-05}}, "connector_pipeline_timer": 0.00016760582042754234}, "time_between_sampling": 0.042772820666208286, "env_to_module_sum_episodes_length_in": 10.36823839457432, "env_to_module_connector": {"timers": {"connectors": {"add_observations_from_episodes_to_batch": 3.869916876089371e-06, "numpy_to_tensor": 1.9044184246778498e-05, "batch_individual_items": 1.7103969718075514e-05, "add_states_from_episodes_to_batch": 3.540298539406765e-06, "add_time_dim_to_batch_and_zero_pad": 9.807891970990258e-06}}, "connector_pipeline_timer": 8.254261001642745e-05}, "num_agent_steps_sampled_lifetime": {"default_agent": -9252500.0}, "env_reset_timer": 5.2759099142001514e-05, "episode_return_mean": 3.9399999999999995, "episode_return_min": -9.5, "env_to_module_sum_episodes_length_out": 10.36823839457432, "module_episode_returns_mean": {"default_policy": 3.9399999999999995}, "agent_episode_returns_mean": {"default_agent": 3.9399999999999995}, "episode_len_max": 20, "sample": 0.006747845718481964, "rlmodule_inference_timer": 4.7172366997723e-05, "episode_len_mean": 20.0, "num_env_steps_sampled": 5000.0, "weights_seq_no": 16.0, "num_agent_steps_sampled": {"default_agent": 5000.0}, "episode_return_max": 10.5, "num_episodes": 250.0, "num_module_steps_sampled": {"default_policy": 5000.0}, "env_step_timer": 2.119880277621306e-05, "num_module_steps_sampled_lifetime": {"default_policy": -9252500.0}, "episode_duration_sec_mean": 0.007668338185176253, "num_episodes_lifetime": -462625.0, "num_env_steps_sampled_lifetime": -9252500.0, "episode_len_min": 20, "num_env_steps_sampled_lifetime_throughput": 2659.709288130596}, "__all_modules__": {"learner_connector_sum_episodes_length_in": 5000.0, "learner_connector": {"connector_pipeline_timer": 0.17562069473908534, "timers": {"connectors": {"add_one_ts_to_episodes_and_truncate": 0.009126216800552376, "add_observations_from_episodes_to_batch": 0.0008355389241753837, "add_columns_from_episodes_to_train_batch": 0.04194851413321886, "add_time_dim_to_batch_and_zero_pad": 0.10367591653571882, "add_states_from_episodes_to_batch": 0.0035607554824270897, "batch_individual_items": 0.016254293054818018, "numpy_to_tensor": 7.474254175082252e-05}}}, "learner_connector_sum_episodes_length_out": 5250.0}, "learners": {"intrinsic_reward_module": {"gradients_default_optimizer_global_norm": 0.0, "num_module_steps_trained": 5994, "total_loss": 0.0, "num_trainable_parameters": 8266, "default_optimizer_learning_rate": 0.0002715581955, "curr_entropy_coeff": 0.0015431216992, "weights_seq_no": 17.0, "diff_num_grad_updates_vs_sampler_policy": 1.0, "num_module_steps_trained_lifetime": 101898, "module_train_batch_size_mean": 999.0, "num_module_steps_trained_lifetime_throughput": 613.0141393464062}, "__all_modules__": {"num_module_steps_trained_lifetime": 203796, "num_module_steps_trained": 11988, "num_non_trainable_parameters": 0, "num_env_steps_trained": 31500, "num_env_steps_trained_lifetime": 535500, "num_trainable_parameters": 24861, "num_env_steps_trained_lifetime_throughput": 3221.5839402800852, "num_module_steps_trained_throughput": 18944816.379758254, "num_module_steps_trained_lifetime_throughput": 11541182.321659831}, "differentiable_learners": {"intrinsic_attention_ppo_learner": {"intrinsic_reward_module": {"diff_num_grad_updates_vs_sampler_policy": 86.0, "total_loss": 0.0, "num_module_steps_trained_lifetime": 611388, "num_module_steps_trained": 35964, "module_train_batch_size_mean": 999.0, "weights_seq_no": 102.0}, "default_policy": {"num_module_steps_trained_lifetime": 611388, "num_module_steps_trained": 35964, "module_train_batch_size_mean": 999.0, "vf_loss_unclipped": 40.03852081298828, "mean_kl_loss": 1.2459378012863453e-05, "use_intrinsic_rewards": 1.0, "entropy": 0.6698958277702332, "policy_loss": 2.3318389139603823e-05, "diff_num_grad_updates_vs_sampler_policy": 86.0, "total_loss": 0.20347362756729126, "vf_explained_var": 0.001957535743713379, "weights_seq_no": 102.0, "vf_loss": 0.26247578859329224}, "__all_modules__": {"num_module_steps_trained_lifetime": 1222776, "num_env_steps_trained": 189000, "num_env_steps_trained_lifetime": 3213000, "num_module_steps_trained": 71928, "num_env_steps_trained_lifetime_throughput": 36256.04805597115}}}, "default_policy": {"vf_loss_unclipped": 40.19514465332031, "mean_kl_loss": 1.230484303960111e-05, "curr_kl_coeff": 1.2327875538176158e-06, "curr_entropy_coeff": 0.0015431216992, "use_intrinsic_rewards": 0.0, "entropy": 0.6699026226997375, "policy_loss": 2.2499092665384524e-05, "diff_num_grad_updates_vs_sampler_policy": 1.0, "total_loss": 0.20343737304210663, "num_trainable_parameters": 16595, "vf_explained_var": -0.0001633167266845703, "weights_seq_no": 17.0, "vf_loss": 0.26243290305137634, "num_module_steps_trained_lifetime": 101898, "module_train_batch_size_mean": 999.0, "num_module_steps_trained": 5994, "num_module_steps_trained_lifetime_throughput": 613.010614035215}, "IntrinsicAttentionMask": [[[0.33453699946403503, 0.3328125774860382, 0.33265045285224915], [0.33529067039489746, 0.33248624205589294, 0.3322230875492096], [0.3353617489337921, 0.33245545625686646, 0.33218276500701904]], [[0.3340570032596588, 0.3326008915901184, 0.333342045545578], [0.3344278633594513, 0.3322260081768036, 0.3333461284637451], [0.3342388868331909, 0.33241701126098633, 0.33334407210350037]], [[0.3321961462497711, 0.3352520167827606, 0.33255189657211304], [0.33255261182785034, 0.33465030789375305, 0.3327971398830414], [0.33223778009414673, 0.3351816236972809, 0.33258056640625]], [[0.3331182599067688, 0.333402544260025, 0.3334791958332062], [0.33315229415893555, 0.33339160680770874, 0.3334560990333557], [0.33316144347190857, 0.33338862657546997, 0.3334498703479767]], [[0.3328876197338104, 0.3339492380619049, 0.3331630825996399], [0.33296895027160645, 0.3338368237018585, 0.33319416642189026], [0.3329087793827057, 0.33392006158828735, 0.33317121863365173]], [[0.33440887928009033, 0.33157140016555786, 0.3340197503566742], [0.3420410752296448, 0.3191412687301636, 0.3388177156448364], [0.3354557752609253, 0.32985877990722656, 0.33468544483184814]]]}, "num_training_step_calls_per_iteration": 1, "evaluation": {"env_runners": {"episode_len_max": 20, "rlmodule_inference_timer": 4.401759481694602e-05, "weights_seq_no": 17.0, "module_to_env_connector": {"timers": {"connectors": {"remove_single_ts_time_rank_from_batch": 1.3260458229476851e-05, "listify_data_for_vector_env": 1.2939242807447799e-05, "normalize_and_clip_actions": 8.596105606514334e-06, "get_actions": 4.577134609316326e-05, "tensor_to_numpy": 1.7208579345835806e-05, "un_batch_to_individual_items": 7.5461266713651935e-06}}, "connector_pipeline_timer": 0.00013489096436819427}, "episode_return_max": 14.5, "num_episodes": 20, "num_episodes_lifetime": 340, "num_agent_steps_sampled_lifetime": {"default_agent": 6800}, "env_reset_timer": 0.0005327159618441768, "env_to_module_sum_episodes_length_out": 10.368238394574323, "num_module_steps_sampled_lifetime": {"default_policy": 6800}, "env_to_module_connector": {"timers": {"connectors": {"numpy_to_tensor": 1.563839844863537e-05, "batch_individual_items": 1.3794132803944822e-05, "add_observations_from_episodes_to_batch": 3.1308945152902855e-06, "add_states_from_episodes_to_batch": 3.3157385668587434e-06, "add_time_dim_to_batch_and_zero_pad": 8.167355390584677e-06}}, "connector_pipeline_timer": 6.847912530305109e-05}, "episode_return_mean": 0.05, "sample": 0.12599360298157872, "episode_len_mean": 20.0, "env_step_timer": 1.6339105048623026e-05, "episode_duration_sec_mean": 0.00595005871495232, "num_env_steps_sampled_lifetime": 85400, "agent_episode_returns_mean": {"default_agent": 0.05}, "num_env_steps_sampled": 400, "num_agent_steps_sampled": {"default_agent": 400}, "num_module_steps_sampled": {"default_policy": 400}, "episode_len_min": 20, "env_to_module_sum_episodes_length_in": 10.368238394574323, "module_episode_returns_mean": {"default_policy": 0.05}, "episode_return_min": -13.5, "time_between_sampling": 11.331700685403979}, "num_healthy_workers": 1, "actor_manager_num_outstanding_async_reqs": 0, "num_remote_worker_restarts": 0}, "num_env_steps_sampled_lifetime": -9252500.0, "fault_tolerance": {"num_healthy_workers": 0, "num_remote_worker_restarts": 0}, "env_runner_group": {"actor_manager_num_outstanding_async_reqs": 0}, "done": false, "training_iteration": 17, "trial_id": "ba99d_00000", "date": "2025-08-11_17-59-56", "timestamp": 1754927996, "time_this_iter_s": 12.304564237594604, "time_total_s": 206.0616011619568, "pid": 9655, "hostname": "Mac", "node_ip": "127.0.0.1", "config": {"exploration_config": {}, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 2, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "env": "Umbrella", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": false, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 0, "create_local_env_runner": true, "num_envs_per_env_runner": 1, "gym_env_vectorize_mode": "SYNC", "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "episodes_to_numpy": true, "max_requests_in_flight_per_env_runner": 1, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "merge_env_runner_states": "training_only", "broadcast_env_runner_states": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "complete_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "sampler_perf_stats_ema_coef": null, "_is_online": true, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": "auto", "num_aggregator_actors_per_learner": 0, "max_requests_in_flight_per_aggregator_actor": 3, "local_gpu_idx": 0, "max_requests_in_flight_per_learner": 3, "gamma": 1, "lr": 0.0002715581955, "grad_clip": 0.5, "grad_clip_by": "global_norm", "_train_batch_size_per_learner": 5000, "train_batch_size": 4000, "num_epochs": 1, "minibatch_size": 1000, "shuffle_batch_per_epoch": true, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "log_std_clip_param": 20.0, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "_disable_preprocessor_api": false, "_disable_action_flattening": false}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {"intrinsic_reward_coeff": 0.2795015916508}, "optimizer": {}, "_learner_class": "<class 'source.intrinsic_attention_ppo.learners.IntrinsicAttentionMetaLearner.IntrinsicAttentionMetaLearner'>", "callbacks_on_algorithm_init": null, "callbacks_on_env_runners_recreated": null, "callbacks_on_offline_eval_runners_recreated": null, "callbacks_on_checkpoint_loaded": null, "callbacks_on_environment_created": null, "callbacks_on_episode_created": null, "callbacks_on_episode_start": null, "callbacks_on_episode_step": null, "callbacks_on_episode_end": null, "callbacks_on_evaluate_start": null, "callbacks_on_evaluate_end": null, "callbacks_on_evaluate_offline_start": null, "callbacks_on_evaluate_offline_end": null, "callbacks_on_sample_end": null, "callbacks_on_train_result": null, "explore": true, "enable_rl_module_and_learner": true, "enable_env_runner_and_connector_v2": true, "_prior_exploration_config": {"type": "StochasticSampling"}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x15d6f98a0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "offline_data_class": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_read_batch_size": null, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "materialize_data": false, "materialize_mapped_data": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "ignore_final_observation": false, "prelearner_class": null, "prelearner_buffer_class": null, "prelearner_buffer_kwargs": {}, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_remaining_data": false, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": 1, "evaluation_duration": 20, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_auto_duration_min_env_steps_per_sample": 100, "evaluation_auto_duration_max_env_steps_per_sample": 2000, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 1, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "offline_evaluation_interval": null, "num_offline_eval_runners": 0, "offline_loss_for_module_fn": null, "offline_evaluation_duration": 1, "offline_evaluation_parallel_to_training": false, "offline_evaluation_timeout_s": 120.0, "num_cpus_per_offline_eval_runner": 1, "num_gpus_per_offline_eval_runner": 0, "custom_resources_per_offline_eval_runner": {}, "restart_failed_offline_eval_runners": true, "ignore_offline_eval_runner_failures": false, "max_num_offline_eval_runner_restarts": 1000, "offline_eval_runner_restore_timeout_s": 1800.0, "max_requests_in_flight_per_offline_eval_runner": 1, "validate_offline_eval_runners_after_construction": true, "offline_eval_runner_health_probe_timeout_s": 30.0, "offline_eval_rl_module_inference_only": false, "broadcast_offline_eval_runner_states": false, "offline_eval_batch_size_per_runner": 256, "dataset_num_iters_per_eval_runner": 1, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "log_gradients": false, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 6, "restart_failed_env_runners": true, "ignore_env_runner_failures": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30.0, "env_runner_restore_timeout_s": 1800.0, "_model_config": {}, "_rl_module_spec": "MultiRLModuleSpec(multi_rl_module_class=<class 'ray.rllib.core.rl_module.multi_rl_module.MultiRLModule'>, observation_space=None, action_space=None, inference_only=False, model_config=None, rl_module_specs={'default_policy': RLModuleSpec(module_class=<class 'source.intrinsic_attention_ppo.rl_modules.DifferentiablePPOModule.DifferentiablePPOModule'>, observation_space=None, action_space=None, inference_only=False, learner_only=False, model_config={'vf_share_layers': True, 'embedding_dim': 62, 'max_seq_len': 3, 'policy_head_hidden_sizes': [32], 'value_head_hidden_sizes': [101], 'embedding_hidden_sizes': [121]}, catalog_class=None, load_state_path=None, model_config_dict=None), 'intrinsic_reward_module': RLModuleSpec(module_class=<class 'source.intrinsic_attention_ppo.rl_modules.IntrinsicAttentionModule.IntrinsicAttentionModule'>, observation_space=None, action_space=None, inference_only=False, learner_only=True, model_config={'intrinsic_reward_network': {'encoder_hidden_sizes': [], 'encoding_dim': 1, 'num_heads': 1, 'head_hidden_sizes': None, 'layers': [{'type': 'attention'}]}, 'extrinsic_value_hidden_layers': [127, 60], 'vf_share_layers': True, 'max_seq_len': 3}, catalog_class=None, load_state_path=None, model_config_dict=None)}, load_state_path=None, modules_to_load=None, module_specs={'default_policy': RLModuleSpec(module_class=<class 'source.intrinsic_attention_ppo.rl_modules.DifferentiablePPOModule.DifferentiablePPOModule'>, observation_space=None, action_space=None, inference_only=False, learner_only=False, model_config={'vf_share_layers': True, 'embedding_dim': 62, 'max_seq_len': 3, 'policy_head_hidden_sizes': [32], 'value_head_hidden_sizes': [101], 'embedding_hidden_sizes': [121]}, catalog_class=None, load_state_path=None, model_config_dict=None), 'intrinsic_reward_module': RLModuleSpec(module_class=<class 'source.intrinsic_attention_ppo.rl_modules.IntrinsicAttentionModule.IntrinsicAttentionModule'>, observation_space=None, action_space=None, inference_only=False, learner_only=True, model_config={'intrinsic_reward_network': {'encoder_hidden_sizes': [], 'encoding_dim': 1, 'num_heads': 1, 'head_hidden_sizes': None, 'layers': [{'type': 'attention'}]}, 'extrinsic_value_hidden_layers': [127, 60], 'vf_share_layers': True, 'max_seq_len': 3}, catalog_class=None, load_state_path=None, model_config_dict=None)})", "algorithm_config_overrides_per_module": {"intrinsic_reward_module": {"lr": 0.0002715581955}}, "_per_module_overrides": {}, "_validate_config": true, "_use_msgpack_checkpoints": false, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "env_task_fn": -1, "enable_connectors": -1, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.161583927863, "kl_target": 0.0201019014258, "vf_loss_coeff": 0.7790510010087, "entropy_coeff": 0.0015431216992, "clip_param": 0.2459212356676, "vf_clip_param": 0.3769744131561, "entropy_coeff_schedule": null, "lr_schedule": null, "sgd_minibatch_size": -1, "vf_share_layers": -1, "differentiable_learner_configs": ["DifferentiableLearnerConfig(learner_class=<class 'source.intrinsic_attention_ppo.learners.IntrinsicAttentionPPOLearner.IntrinsicAttentionPPOLearner'>, learner_connector=None, add_default_connectors_to_learner_pipeline=True, is_multi_agent=False, policies_to_update=['default_policy'], lr=0.0060984166342, num_total_minibatches=0, num_epochs=1, minibatch_size=1000, shuffle_batch_per_epoch=True)"], "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9485408017724, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.callbacks.callbacks.RLlibCallback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 206.0616011619568, "iterations_since_restore": 17, "perf": {"cpu_util_percent": 48.70555555555555, "ram_util_percent": 82.37222222222222}}
{"timers": {"training_iteration": 11.140582741839522, "restore_env_runners": 2.0868997912728977e-05, "training_step": 11.140291409237303, "env_runner_sampling_timer": 1.7579818398984606, "learner_update_timer": 9.165270213820124, "synch_weights": 0.0017421668202261165, "restore_eval_env_runners": 8.071885729609545e-05, "evaluation_iteration": 0.13829745747161598, "synch_eval_env_connectors": 0.00019468355985014394, "synch_env_connectors": 5.017097737429271e-06}, "env_runners": {"module_to_env_connector": {"timers": {"connectors": {"listify_data_for_vector_env": 1.2949148154785558e-05, "normalize_and_clip_actions": 9.842701346868602e-06, "get_actions": 5.3284672049017605e-05, "tensor_to_numpy": 1.9489823855170275e-05, "un_batch_to_individual_items": 8.114354148682394e-06, "remove_single_ts_time_rank_from_batch": 1.4349600325057835e-05}}, "connector_pipeline_timer": 0.00015125828242993427}, "time_between_sampling": 0.041252006927285305, "env_to_module_sum_episodes_length_in": 10.36823839457432, "env_to_module_connector": {"timers": {"connectors": {"add_observations_from_episodes_to_batch": 3.472736712994575e-06, "numpy_to_tensor": 1.619294941701429e-05, "batch_individual_items": 1.559637146293456e-05, "add_states_from_episodes_to_batch": 3.36212796156511e-06, "add_time_dim_to_batch_and_zero_pad": 8.789716538401985e-06}}, "connector_pipeline_timer": 7.459251459724846e-05}, "num_agent_steps_sampled_lifetime": {"default_agent": -9870000.0}, "env_reset_timer": 6.517478756389512e-05, "episode_return_mean": 3.7, "episode_return_min": -9.5, "env_to_module_sum_episodes_length_out": 10.36823839457432, "module_episode_returns_mean": {"default_policy": 3.7}, "agent_episode_returns_mean": {"default_agent": 3.7}, "episode_len_max": 20, "sample": 0.008141195249753295, "rlmodule_inference_timer": 4.170974821664846e-05, "episode_len_mean": 20.0, "num_env_steps_sampled": 5000.0, "weights_seq_no": 17.0, "num_agent_steps_sampled": {"default_agent": 5000.0}, "episode_return_max": 10.5, "num_episodes": 250.0, "num_module_steps_sampled": {"default_policy": 5000.0}, "env_step_timer": 1.8150910381405245e-05, "num_module_steps_sampled_lifetime": {"default_policy": -9870000.0}, "episode_duration_sec_mean": 0.006585616850759837, "num_episodes_lifetime": -493500.0, "num_env_steps_sampled_lifetime": -9870000.0, "episode_len_min": 20, "num_env_steps_sampled_lifetime_throughput": 2495.7079844640903}, "__all_modules__": {"learner_connector_sum_episodes_length_in": 5000.0, "learner_connector": {"connector_pipeline_timer": 0.1756444852918198, "timers": {"connectors": {"add_one_ts_to_episodes_and_truncate": 0.009124528382120753, "add_observations_from_episodes_to_batch": 0.0008356885345023157, "add_columns_from_episodes_to_train_batch": 0.041969626911401076, "add_time_dim_to_batch_and_zero_pad": 0.10371072487083743, "add_states_from_episodes_to_batch": 0.003563296677921033, "batch_individual_items": 0.016221324284361415, "numpy_to_tensor": 7.475052604342353e-05}}}, "learner_connector_sum_episodes_length_out": 5250.0}, "learners": {"intrinsic_reward_module": {"gradients_default_optimizer_global_norm": 0.0, "num_module_steps_trained": 5994, "total_loss": 0.0, "num_trainable_parameters": 8266, "default_optimizer_learning_rate": 0.0002715581955, "curr_entropy_coeff": 0.0015431216992, "weights_seq_no": 18.0, "diff_num_grad_updates_vs_sampler_policy": 1.0, "num_module_steps_trained_lifetime": 107892, "module_train_batch_size_mean": 999.0, "num_module_steps_trained_lifetime_throughput": 610.3781275312032}, "__all_modules__": {"num_module_steps_trained_lifetime": 215784, "num_module_steps_trained": 11988, "num_non_trainable_parameters": 0, "num_env_steps_trained": 31500, "num_env_steps_trained_lifetime": 567000, "num_trainable_parameters": 24861, "num_env_steps_trained_lifetime_throughput": 3207.7297078689808, "num_module_steps_trained_throughput": 18573894.316925097, "num_module_steps_trained_lifetime_throughput": 11560167.608514871}, "differentiable_learners": {"intrinsic_attention_ppo_learner": {"intrinsic_reward_module": {"diff_num_grad_updates_vs_sampler_policy": 91.0, "total_loss": 0.0, "num_module_steps_trained_lifetime": 647352, "num_module_steps_trained": 35964, "module_train_batch_size_mean": 999.0, "weights_seq_no": 108.0}, "default_policy": {"num_module_steps_trained_lifetime": 647352, "num_module_steps_trained": 35964, "module_train_batch_size_mean": 999.0, "vf_loss_unclipped": 39.32603454589844, "mean_kl_loss": 1.2876203072664794e-05, "use_intrinsic_rewards": 1.0, "entropy": 0.6680875420570374, "policy_loss": -0.0002578159619588405, "diff_num_grad_updates_vs_sampler_policy": 91.0, "total_loss": 0.20319966971874237, "vf_explained_var": 0.002149343490600586, "weights_seq_no": 108.0, "vf_loss": 0.26248136162757874}, "__all_modules__": {"num_module_steps_trained_lifetime": 1294704, "num_env_steps_trained": 189000, "num_env_steps_trained_lifetime": 3402000, "num_module_steps_trained": 71928, "num_env_steps_trained_lifetime_throughput": 35691.69937420706}}}, "default_policy": {"vf_loss_unclipped": 39.44038391113281, "mean_kl_loss": 1.3825590940541588e-05, "curr_kl_coeff": 6.163937769088079e-07, "curr_entropy_coeff": 0.0015431216992, "use_intrinsic_rewards": 0.0, "entropy": 0.668047308921814, "policy_loss": -0.00026681070448830724, "diff_num_grad_updates_vs_sampler_policy": 1.0, "total_loss": 0.2031497061252594, "num_trainable_parameters": 16595, "vf_explained_var": 0.00015217065811157227, "weights_seq_no": 18.0, "vf_loss": 0.2624313533306122, "num_module_steps_trained_lifetime": 107892, "module_train_batch_size_mean": 999.0, "num_module_steps_trained": 5994, "num_module_steps_trained_lifetime_throughput": 610.3748682519085}, "IntrinsicAttentionMask": [[[0.3345363438129425, 0.33192169666290283, 0.33354198932647705], [0.3356791138648987, 0.33058398962020874, 0.33373692631721497], [0.33496981859207153, 0.3314139246940613, 0.33361631631851196]], [[0.3330913484096527, 0.3335631787776947, 0.333345502614975], [0.3331144452095032, 0.33354124426841736, 0.33334434032440186], [0.3331037759780884, 0.3335513472557068, 0.33334487676620483]], [[0.33332300186157227, 0.33313998579978943, 0.3335369825363159], [0.3333224654197693, 0.3331298828125, 0.3335476517677307], [0.3333236575126648, 0.33315181732177734, 0.33352455496788025]], [[0.33300402760505676, 0.33343929052352905, 0.3335566818714142], [0.3330380320549011, 0.33342835307121277, 0.3335335850715637], [0.33304721117019653, 0.3334254026412964, 0.3335273563861847]], [[0.33332398533821106, 0.3331577181816101, 0.3335183560848236], [0.3333234190940857, 0.3331475853919983, 0.33352896571159363], [0.3333245813846588, 0.33316949009895325, 0.33350586891174316]], [[0.334904283285141, 0.3302820026874542, 0.3348137140274048], [0.3401798605918884, 0.32004401087760925, 0.3397761583328247], [0.3350076973438263, 0.33008119463920593, 0.33491113781929016]]]}, "num_training_step_calls_per_iteration": 1, "evaluation": {"env_runners": {"episode_len_max": 20, "rlmodule_inference_timer": 3.107535467242081e-05, "weights_seq_no": 18.0, "module_to_env_connector": {"timers": {"connectors": {"remove_single_ts_time_rank_from_batch": 1.1773428623498536e-05, "listify_data_for_vector_env": 1.0450570284963626e-05, "normalize_and_clip_actions": 7.852875018510176e-06, "get_actions": 3.665179755184589e-05, "tensor_to_numpy": 1.5321352406220133e-05, "un_batch_to_individual_items": 6.517353733810039e-06}}, "connector_pipeline_timer": 0.00011454419301832724}, "episode_return_max": 14.5, "num_episodes": 20, "num_episodes_lifetime": 360, "num_agent_steps_sampled_lifetime": {"default_agent": 7200}, "env_reset_timer": 0.0005303858820898793, "env_to_module_sum_episodes_length_out": 10.368238394574323, "num_module_steps_sampled_lifetime": {"default_policy": 7200}, "env_to_module_connector": {"timers": {"connectors": {"numpy_to_tensor": 1.1842990026211956e-05, "batch_individual_items": 1.2341691469565182e-05, "add_observations_from_episodes_to_batch": 2.8173226134735756e-06, "add_states_from_episodes_to_batch": 2.9287479639425897e-06, "add_time_dim_to_batch_and_zero_pad": 7.125225668445784e-06}}, "connector_pipeline_timer": 5.8963355722124924e-05}, "episode_return_mean": -0.35, "sample": 0.1258865690424521, "episode_len_mean": 20.0, "env_step_timer": 1.3656506239092088e-05, "episode_duration_sec_mean": 0.00585647375206463, "num_env_steps_sampled_lifetime": 90400, "agent_episode_returns_mean": {"default_agent": -0.35}, "num_env_steps_sampled": 400, "num_agent_steps_sampled": {"default_agent": 400}, "num_module_steps_sampled": {"default_policy": 400}, "episode_len_min": 20, "env_to_module_sum_episodes_length_in": 10.368238394574323, "module_episode_returns_mean": {"default_policy": -0.35}, "episode_return_min": -13.5, "time_between_sampling": 11.339996368139323}, "num_healthy_workers": 1, "actor_manager_num_outstanding_async_reqs": 0, "num_remote_worker_restarts": 0}, "num_env_steps_sampled_lifetime": -9870000.0, "fault_tolerance": {"num_healthy_workers": 0, "num_remote_worker_restarts": 0}, "env_runner_group": {"actor_manager_num_outstanding_async_reqs": 0}, "done": false, "training_iteration": 18, "trial_id": "ba99d_00000", "date": "2025-08-11_18-00-08", "timestamp": 1754928008, "time_this_iter_s": 12.255470752716064, "time_total_s": 218.31707191467285, "pid": 9655, "hostname": "Mac", "node_ip": "127.0.0.1", "config": {"exploration_config": {}, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 2, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "env": "Umbrella", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": false, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 0, "create_local_env_runner": true, "num_envs_per_env_runner": 1, "gym_env_vectorize_mode": "SYNC", "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "episodes_to_numpy": true, "max_requests_in_flight_per_env_runner": 1, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "merge_env_runner_states": "training_only", "broadcast_env_runner_states": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "complete_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "sampler_perf_stats_ema_coef": null, "_is_online": true, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": "auto", "num_aggregator_actors_per_learner": 0, "max_requests_in_flight_per_aggregator_actor": 3, "local_gpu_idx": 0, "max_requests_in_flight_per_learner": 3, "gamma": 1, "lr": 0.0002715581955, "grad_clip": 0.5, "grad_clip_by": "global_norm", "_train_batch_size_per_learner": 5000, "train_batch_size": 4000, "num_epochs": 1, "minibatch_size": 1000, "shuffle_batch_per_epoch": true, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "log_std_clip_param": 20.0, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "_disable_preprocessor_api": false, "_disable_action_flattening": false}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {"intrinsic_reward_coeff": 0.2795015916508}, "optimizer": {}, "_learner_class": "<class 'source.intrinsic_attention_ppo.learners.IntrinsicAttentionMetaLearner.IntrinsicAttentionMetaLearner'>", "callbacks_on_algorithm_init": null, "callbacks_on_env_runners_recreated": null, "callbacks_on_offline_eval_runners_recreated": null, "callbacks_on_checkpoint_loaded": null, "callbacks_on_environment_created": null, "callbacks_on_episode_created": null, "callbacks_on_episode_start": null, "callbacks_on_episode_step": null, "callbacks_on_episode_end": null, "callbacks_on_evaluate_start": null, "callbacks_on_evaluate_end": null, "callbacks_on_evaluate_offline_start": null, "callbacks_on_evaluate_offline_end": null, "callbacks_on_sample_end": null, "callbacks_on_train_result": null, "explore": true, "enable_rl_module_and_learner": true, "enable_env_runner_and_connector_v2": true, "_prior_exploration_config": {"type": "StochasticSampling"}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x15d6f98a0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "offline_data_class": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_read_batch_size": null, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "materialize_data": false, "materialize_mapped_data": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "ignore_final_observation": false, "prelearner_class": null, "prelearner_buffer_class": null, "prelearner_buffer_kwargs": {}, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_remaining_data": false, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": 1, "evaluation_duration": 20, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_auto_duration_min_env_steps_per_sample": 100, "evaluation_auto_duration_max_env_steps_per_sample": 2000, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 1, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "offline_evaluation_interval": null, "num_offline_eval_runners": 0, "offline_loss_for_module_fn": null, "offline_evaluation_duration": 1, "offline_evaluation_parallel_to_training": false, "offline_evaluation_timeout_s": 120.0, "num_cpus_per_offline_eval_runner": 1, "num_gpus_per_offline_eval_runner": 0, "custom_resources_per_offline_eval_runner": {}, "restart_failed_offline_eval_runners": true, "ignore_offline_eval_runner_failures": false, "max_num_offline_eval_runner_restarts": 1000, "offline_eval_runner_restore_timeout_s": 1800.0, "max_requests_in_flight_per_offline_eval_runner": 1, "validate_offline_eval_runners_after_construction": true, "offline_eval_runner_health_probe_timeout_s": 30.0, "offline_eval_rl_module_inference_only": false, "broadcast_offline_eval_runner_states": false, "offline_eval_batch_size_per_runner": 256, "dataset_num_iters_per_eval_runner": 1, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "log_gradients": false, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 6, "restart_failed_env_runners": true, "ignore_env_runner_failures": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30.0, "env_runner_restore_timeout_s": 1800.0, "_model_config": {}, "_rl_module_spec": "MultiRLModuleSpec(multi_rl_module_class=<class 'ray.rllib.core.rl_module.multi_rl_module.MultiRLModule'>, observation_space=None, action_space=None, inference_only=False, model_config=None, rl_module_specs={'default_policy': RLModuleSpec(module_class=<class 'source.intrinsic_attention_ppo.rl_modules.DifferentiablePPOModule.DifferentiablePPOModule'>, observation_space=None, action_space=None, inference_only=False, learner_only=False, model_config={'vf_share_layers': True, 'embedding_dim': 62, 'max_seq_len': 3, 'policy_head_hidden_sizes': [32], 'value_head_hidden_sizes': [101], 'embedding_hidden_sizes': [121]}, catalog_class=None, load_state_path=None, model_config_dict=None), 'intrinsic_reward_module': RLModuleSpec(module_class=<class 'source.intrinsic_attention_ppo.rl_modules.IntrinsicAttentionModule.IntrinsicAttentionModule'>, observation_space=None, action_space=None, inference_only=False, learner_only=True, model_config={'intrinsic_reward_network': {'encoder_hidden_sizes': [], 'encoding_dim': 1, 'num_heads': 1, 'head_hidden_sizes': None, 'layers': [{'type': 'attention'}]}, 'extrinsic_value_hidden_layers': [127, 60], 'vf_share_layers': True, 'max_seq_len': 3}, catalog_class=None, load_state_path=None, model_config_dict=None)}, load_state_path=None, modules_to_load=None, module_specs={'default_policy': RLModuleSpec(module_class=<class 'source.intrinsic_attention_ppo.rl_modules.DifferentiablePPOModule.DifferentiablePPOModule'>, observation_space=None, action_space=None, inference_only=False, learner_only=False, model_config={'vf_share_layers': True, 'embedding_dim': 62, 'max_seq_len': 3, 'policy_head_hidden_sizes': [32], 'value_head_hidden_sizes': [101], 'embedding_hidden_sizes': [121]}, catalog_class=None, load_state_path=None, model_config_dict=None), 'intrinsic_reward_module': RLModuleSpec(module_class=<class 'source.intrinsic_attention_ppo.rl_modules.IntrinsicAttentionModule.IntrinsicAttentionModule'>, observation_space=None, action_space=None, inference_only=False, learner_only=True, model_config={'intrinsic_reward_network': {'encoder_hidden_sizes': [], 'encoding_dim': 1, 'num_heads': 1, 'head_hidden_sizes': None, 'layers': [{'type': 'attention'}]}, 'extrinsic_value_hidden_layers': [127, 60], 'vf_share_layers': True, 'max_seq_len': 3}, catalog_class=None, load_state_path=None, model_config_dict=None)})", "algorithm_config_overrides_per_module": {"intrinsic_reward_module": {"lr": 0.0002715581955}}, "_per_module_overrides": {}, "_validate_config": true, "_use_msgpack_checkpoints": false, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "env_task_fn": -1, "enable_connectors": -1, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.161583927863, "kl_target": 0.0201019014258, "vf_loss_coeff": 0.7790510010087, "entropy_coeff": 0.0015431216992, "clip_param": 0.2459212356676, "vf_clip_param": 0.3769744131561, "entropy_coeff_schedule": null, "lr_schedule": null, "sgd_minibatch_size": -1, "vf_share_layers": -1, "differentiable_learner_configs": ["DifferentiableLearnerConfig(learner_class=<class 'source.intrinsic_attention_ppo.learners.IntrinsicAttentionPPOLearner.IntrinsicAttentionPPOLearner'>, learner_connector=None, add_default_connectors_to_learner_pipeline=True, is_multi_agent=False, policies_to_update=['default_policy'], lr=0.0060984166342, num_total_minibatches=0, num_epochs=1, minibatch_size=1000, shuffle_batch_per_epoch=True)"], "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9485408017724, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.callbacks.callbacks.RLlibCallback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 218.31707191467285, "iterations_since_restore": 18, "perf": {"cpu_util_percent": 43.752941176470586, "ram_util_percent": 81.65294117647058}}
{"timers": {"training_iteration": 11.151224109001209, "restore_env_runners": 2.0716557488802026e-05, "training_step": 11.150933297643933, "env_runner_sampling_timer": 1.7569911119184778, "learner_update_timer": 9.176800203771972, "synch_weights": 0.0017537530609120164, "restore_eval_env_runners": 8.03708282147182e-05, "evaluation_iteration": 0.13816150330727361, "synch_eval_env_connectors": 0.00019430214362195104, "synch_env_connectors": 5.006097023390087e-06}, "env_runners": {"module_to_env_connector": {"timers": {"connectors": {"listify_data_for_vector_env": 1.0584078017373766e-05, "normalize_and_clip_actions": 8.004382980953291e-06, "get_actions": 3.95121500878063e-05, "tensor_to_numpy": 1.5307020690927325e-05, "un_batch_to_individual_items": 6.630027294478802e-06, "remove_single_ts_time_rank_from_batch": 1.1854907056399646e-05}}, "connector_pipeline_timer": 0.00011898509341534718}, "time_between_sampling": 0.041866783301766575, "env_to_module_sum_episodes_length_in": 10.36823839457432, "env_to_module_connector": {"timers": {"connectors": {"add_observations_from_episodes_to_batch": 2.782885348928501e-06, "numpy_to_tensor": 1.2381363338510348e-05, "batch_individual_items": 1.2407056700024792e-05, "add_states_from_episodes_to_batch": 2.745241170003475e-06, "add_time_dim_to_batch_and_zero_pad": 6.9387669935778395e-06}}, "connector_pipeline_timer": 5.9821503302742075e-05}, "num_agent_steps_sampled_lifetime": {"default_agent": -10487500.0}, "env_reset_timer": 4.6014613672803854e-05, "episode_return_mean": 2.899999999999998, "episode_return_min": -9.5, "env_to_module_sum_episodes_length_out": 10.36823839457432, "module_episode_returns_mean": {"default_policy": 2.899999999999998}, "agent_episode_returns_mean": {"default_agent": 2.899999999999998}, "episode_len_max": 20, "sample": 0.006552294696387028, "rlmodule_inference_timer": 5.7719954984368197e-05, "episode_len_mean": 20.0, "num_env_steps_sampled": 5000.0, "weights_seq_no": 18.0, "num_agent_steps_sampled": {"default_agent": 5000.0}, "episode_return_max": 10.5, "num_episodes": 250.0, "num_module_steps_sampled": {"default_policy": 5000.0}, "env_step_timer": 1.3850432827483494e-05, "num_module_steps_sampled_lifetime": {"default_policy": -10487500.0}, "episode_duration_sec_mean": 0.00576804869947955, "num_episodes_lifetime": -524375.0, "num_env_steps_sampled_lifetime": -10487500.0, "episode_len_min": 20, "num_env_steps_sampled_lifetime_throughput": 3205.486179883549}, "__all_modules__": {"learner_connector_sum_episodes_length_in": 5000.0, "learner_connector": {"connector_pipeline_timer": 0.17563457918833192, "timers": {"connectors": {"add_one_ts_to_episodes_and_truncate": 0.00912106184817527, "add_observations_from_episodes_to_batch": 0.0008358433088465401, "add_columns_from_episodes_to_train_batch": 0.04196830731227324, "add_time_dim_to_batch_and_zero_pad": 0.1037328697121827, "add_states_from_episodes_to_batch": 0.0035661203718371968, "batch_individual_items": 0.016191231041716284, "numpy_to_tensor": 7.486177121013108e-05}}}, "learner_connector_sum_episodes_length_out": 5250.0}, "learners": {"intrinsic_reward_module": {"gradients_default_optimizer_global_norm": 0.0, "num_module_steps_trained": 5994, "total_loss": 0.0, "num_trainable_parameters": 8266, "default_optimizer_learning_rate": 0.0002715581955, "curr_entropy_coeff": 0.0015431216992, "weights_seq_no": 19.0, "diff_num_grad_updates_vs_sampler_policy": 1.0, "num_module_steps_trained_lifetime": 113886, "module_train_batch_size_mean": 999.0, "num_module_steps_trained_lifetime_throughput": 607.5474879169138}, "__all_modules__": {"num_module_steps_trained_lifetime": 227772, "num_module_steps_trained": 11988, "num_non_trainable_parameters": 0, "num_env_steps_trained": 31500, "num_env_steps_trained_lifetime": 598500, "num_trainable_parameters": 24861, "num_env_steps_trained_lifetime_throughput": 3192.852705563044, "num_module_steps_trained_throughput": 18203729.609253205, "num_module_steps_trained_lifetime_throughput": 11573314.950208146}, "differentiable_learners": {"intrinsic_attention_ppo_learner": {"intrinsic_reward_module": {"diff_num_grad_updates_vs_sampler_policy": 96.0, "total_loss": 0.0, "num_module_steps_trained_lifetime": 683316, "num_module_steps_trained": 35964, "module_train_batch_size_mean": 999.0, "weights_seq_no": 114.0}, "default_policy": {"num_module_steps_trained_lifetime": 683316, "num_module_steps_trained": 35964, "module_train_batch_size_mean": 999.0, "vf_loss_unclipped": 38.87092208862305, "mean_kl_loss": 1.5622027831341256e-06, "use_intrinsic_rewards": 1.0, "entropy": 0.6671546697616577, "policy_loss": -1.2484509170462843e-05, "diff_num_grad_updates_vs_sampler_policy": 96.0, "total_loss": 0.20344650745391846, "vf_explained_var": 0.002158045768737793, "weights_seq_no": 114.0, "vf_loss": 0.26248377561569214}, "__all_modules__": {"num_module_steps_trained_lifetime": 1366632, "num_env_steps_trained": 189000, "num_env_steps_trained_lifetime": 3591000, "num_module_steps_trained": 71928, "num_env_steps_trained_lifetime_throughput": 35166.73104571686}}}, "default_policy": {"vf_loss_unclipped": 38.95650863647461, "mean_kl_loss": 1.4232629155230825e-06, "curr_kl_coeff": 3.0819688845440396e-07, "curr_entropy_coeff": 0.0015431216992, "use_intrinsic_rewards": 0.0, "entropy": 0.6671745777130127, "policy_loss": -1.5558629456791095e-05, "diff_num_grad_updates_vs_sampler_policy": 1.0, "total_loss": 0.20340155065059662, "num_trainable_parameters": 16595, "vf_explained_var": 0.0003497600555419922, "weights_seq_no": 19.0, "vf_loss": 0.2624303698539734, "num_module_steps_trained_lifetime": 113886, "module_train_batch_size_mean": 999.0, "num_module_steps_trained": 5994, "num_module_steps_trained_lifetime_throughput": 607.5444798485189}, "IntrinsicAttentionMask": [[[0.33309420943260193, 0.3335604667663574, 0.33334535360336304], [0.33311727643013, 0.3335385322570801, 0.3333441913127899], [0.3331066370010376, 0.3335486352443695, 0.3333447277545929]], [[0.33289778232574463, 0.3332182466983795, 0.33388397097587585], [0.3329589068889618, 0.3332344591617584, 0.33380669355392456], [0.33308565616607666, 0.3332679271697998, 0.33364638686180115]], [[0.33378228545188904, 0.3335292935371399, 0.3326883912086487], [0.3337993025779724, 0.33353671431541443, 0.33266398310661316], [0.33385592699050903, 0.33356139063835144, 0.3325827121734619]], [[0.33349233865737915, 0.3332309126853943, 0.33327677845954895], [0.3335568904876709, 0.33318933844566345, 0.3332538306713104], [0.3335455656051636, 0.33319664001464844, 0.33325785398483276]], [[0.3328876197338104, 0.3339492380619049, 0.3331630825996399], [0.33296895027160645, 0.3338368237018585, 0.33319416642189026], [0.3329087793827057, 0.33392006158828735, 0.33317121863365173]], [[0.33105647563934326, 0.33803102374076843, 0.33091241121292114], [0.33551183342933655, 0.32883548736572266, 0.3356526494026184], [0.33096277713775635, 0.3382243514060974, 0.33081284165382385]]]}, "num_training_step_calls_per_iteration": 1, "evaluation": {"env_runners": {"episode_len_max": 20, "rlmodule_inference_timer": 3.245375364376999e-05, "weights_seq_no": 19.0, "module_to_env_connector": {"timers": {"connectors": {"remove_single_ts_time_rank_from_batch": 1.234831927737121e-05, "listify_data_for_vector_env": 1.0972245021127878e-05, "normalize_and_clip_actions": 8.330418181726772e-06, "get_actions": 3.839453676473257e-05, "tensor_to_numpy": 1.5976677066210278e-05, "un_batch_to_individual_items": 6.911295347081224e-06}}, "connector_pipeline_timer": 0.00011998498220444941}, "episode_return_max": 14.5, "num_episodes": 20, "num_episodes_lifetime": 380, "num_agent_steps_sampled_lifetime": {"default_agent": 7600}, "env_reset_timer": 0.000528151603103099, "env_to_module_sum_episodes_length_out": 10.368238394574323, "num_module_steps_sampled_lifetime": {"default_policy": 7600}, "env_to_module_connector": {"timers": {"connectors": {"numpy_to_tensor": 1.2725322755381182e-05, "batch_individual_items": 1.2917782408653523e-05, "add_observations_from_episodes_to_batch": 2.922167370951609e-06, "add_states_from_episodes_to_batch": 3.092880471609096e-06, "add_time_dim_to_batch_and_zero_pad": 7.539928151352534e-06}}, "connector_pipeline_timer": 6.216997425586361e-05}, "episode_return_mean": 1.05, "sample": 0.12589009085147362, "episode_len_mean": 20.0, "env_step_timer": 1.4584332578630371e-05, "episode_duration_sec_mean": 0.005910192892188206, "num_env_steps_sampled_lifetime": 95400, "agent_episode_returns_mean": {"default_agent": 1.05}, "num_env_steps_sampled": 400, "num_agent_steps_sampled": {"default_agent": 400}, "num_module_steps_sampled": {"default_policy": 400}, "episode_len_min": 20, "env_to_module_sum_episodes_length_in": 10.368238394574323, "module_episode_returns_mean": {"default_policy": 1.05}, "episode_return_min": -13.5, "time_between_sampling": 11.348976277787703}, "num_healthy_workers": 1, "actor_manager_num_outstanding_async_reqs": 0, "num_remote_worker_restarts": 0}, "num_env_steps_sampled_lifetime": -10487500.0, "fault_tolerance": {"num_healthy_workers": 0, "num_remote_worker_restarts": 0}, "env_runner_group": {"actor_manager_num_outstanding_async_reqs": 0}, "done": false, "training_iteration": 19, "trial_id": "ba99d_00000", "date": "2025-08-11_18-00-20", "timestamp": 1754928020, "time_this_iter_s": 12.345049142837524, "time_total_s": 230.66212105751038, "pid": 9655, "hostname": "Mac", "node_ip": "127.0.0.1", "config": {"exploration_config": {}, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 2, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "env": "Umbrella", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": false, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 0, "create_local_env_runner": true, "num_envs_per_env_runner": 1, "gym_env_vectorize_mode": "SYNC", "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "episodes_to_numpy": true, "max_requests_in_flight_per_env_runner": 1, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "merge_env_runner_states": "training_only", "broadcast_env_runner_states": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "complete_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "sampler_perf_stats_ema_coef": null, "_is_online": true, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": "auto", "num_aggregator_actors_per_learner": 0, "max_requests_in_flight_per_aggregator_actor": 3, "local_gpu_idx": 0, "max_requests_in_flight_per_learner": 3, "gamma": 1, "lr": 0.0002715581955, "grad_clip": 0.5, "grad_clip_by": "global_norm", "_train_batch_size_per_learner": 5000, "train_batch_size": 4000, "num_epochs": 1, "minibatch_size": 1000, "shuffle_batch_per_epoch": true, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "log_std_clip_param": 20.0, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "_disable_preprocessor_api": false, "_disable_action_flattening": false}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {"intrinsic_reward_coeff": 0.2795015916508}, "optimizer": {}, "_learner_class": "<class 'source.intrinsic_attention_ppo.learners.IntrinsicAttentionMetaLearner.IntrinsicAttentionMetaLearner'>", "callbacks_on_algorithm_init": null, "callbacks_on_env_runners_recreated": null, "callbacks_on_offline_eval_runners_recreated": null, "callbacks_on_checkpoint_loaded": null, "callbacks_on_environment_created": null, "callbacks_on_episode_created": null, "callbacks_on_episode_start": null, "callbacks_on_episode_step": null, "callbacks_on_episode_end": null, "callbacks_on_evaluate_start": null, "callbacks_on_evaluate_end": null, "callbacks_on_evaluate_offline_start": null, "callbacks_on_evaluate_offline_end": null, "callbacks_on_sample_end": null, "callbacks_on_train_result": null, "explore": true, "enable_rl_module_and_learner": true, "enable_env_runner_and_connector_v2": true, "_prior_exploration_config": {"type": "StochasticSampling"}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x15d6f98a0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "offline_data_class": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_read_batch_size": null, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "materialize_data": false, "materialize_mapped_data": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "ignore_final_observation": false, "prelearner_class": null, "prelearner_buffer_class": null, "prelearner_buffer_kwargs": {}, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_remaining_data": false, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": 1, "evaluation_duration": 20, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_auto_duration_min_env_steps_per_sample": 100, "evaluation_auto_duration_max_env_steps_per_sample": 2000, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 1, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "offline_evaluation_interval": null, "num_offline_eval_runners": 0, "offline_loss_for_module_fn": null, "offline_evaluation_duration": 1, "offline_evaluation_parallel_to_training": false, "offline_evaluation_timeout_s": 120.0, "num_cpus_per_offline_eval_runner": 1, "num_gpus_per_offline_eval_runner": 0, "custom_resources_per_offline_eval_runner": {}, "restart_failed_offline_eval_runners": true, "ignore_offline_eval_runner_failures": false, "max_num_offline_eval_runner_restarts": 1000, "offline_eval_runner_restore_timeout_s": 1800.0, "max_requests_in_flight_per_offline_eval_runner": 1, "validate_offline_eval_runners_after_construction": true, "offline_eval_runner_health_probe_timeout_s": 30.0, "offline_eval_rl_module_inference_only": false, "broadcast_offline_eval_runner_states": false, "offline_eval_batch_size_per_runner": 256, "dataset_num_iters_per_eval_runner": 1, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "log_gradients": false, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 6, "restart_failed_env_runners": true, "ignore_env_runner_failures": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30.0, "env_runner_restore_timeout_s": 1800.0, "_model_config": {}, "_rl_module_spec": "MultiRLModuleSpec(multi_rl_module_class=<class 'ray.rllib.core.rl_module.multi_rl_module.MultiRLModule'>, observation_space=None, action_space=None, inference_only=False, model_config=None, rl_module_specs={'default_policy': RLModuleSpec(module_class=<class 'source.intrinsic_attention_ppo.rl_modules.DifferentiablePPOModule.DifferentiablePPOModule'>, observation_space=None, action_space=None, inference_only=False, learner_only=False, model_config={'vf_share_layers': True, 'embedding_dim': 62, 'max_seq_len': 3, 'policy_head_hidden_sizes': [32], 'value_head_hidden_sizes': [101], 'embedding_hidden_sizes': [121]}, catalog_class=None, load_state_path=None, model_config_dict=None), 'intrinsic_reward_module': RLModuleSpec(module_class=<class 'source.intrinsic_attention_ppo.rl_modules.IntrinsicAttentionModule.IntrinsicAttentionModule'>, observation_space=None, action_space=None, inference_only=False, learner_only=True, model_config={'intrinsic_reward_network': {'encoder_hidden_sizes': [], 'encoding_dim': 1, 'num_heads': 1, 'head_hidden_sizes': None, 'layers': [{'type': 'attention'}]}, 'extrinsic_value_hidden_layers': [127, 60], 'vf_share_layers': True, 'max_seq_len': 3}, catalog_class=None, load_state_path=None, model_config_dict=None)}, load_state_path=None, modules_to_load=None, module_specs={'default_policy': RLModuleSpec(module_class=<class 'source.intrinsic_attention_ppo.rl_modules.DifferentiablePPOModule.DifferentiablePPOModule'>, observation_space=None, action_space=None, inference_only=False, learner_only=False, model_config={'vf_share_layers': True, 'embedding_dim': 62, 'max_seq_len': 3, 'policy_head_hidden_sizes': [32], 'value_head_hidden_sizes': [101], 'embedding_hidden_sizes': [121]}, catalog_class=None, load_state_path=None, model_config_dict=None), 'intrinsic_reward_module': RLModuleSpec(module_class=<class 'source.intrinsic_attention_ppo.rl_modules.IntrinsicAttentionModule.IntrinsicAttentionModule'>, observation_space=None, action_space=None, inference_only=False, learner_only=True, model_config={'intrinsic_reward_network': {'encoder_hidden_sizes': [], 'encoding_dim': 1, 'num_heads': 1, 'head_hidden_sizes': None, 'layers': [{'type': 'attention'}]}, 'extrinsic_value_hidden_layers': [127, 60], 'vf_share_layers': True, 'max_seq_len': 3}, catalog_class=None, load_state_path=None, model_config_dict=None)})", "algorithm_config_overrides_per_module": {"intrinsic_reward_module": {"lr": 0.0002715581955}}, "_per_module_overrides": {}, "_validate_config": true, "_use_msgpack_checkpoints": false, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "env_task_fn": -1, "enable_connectors": -1, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.161583927863, "kl_target": 0.0201019014258, "vf_loss_coeff": 0.7790510010087, "entropy_coeff": 0.0015431216992, "clip_param": 0.2459212356676, "vf_clip_param": 0.3769744131561, "entropy_coeff_schedule": null, "lr_schedule": null, "sgd_minibatch_size": -1, "vf_share_layers": -1, "differentiable_learner_configs": ["DifferentiableLearnerConfig(learner_class=<class 'source.intrinsic_attention_ppo.learners.IntrinsicAttentionPPOLearner.IntrinsicAttentionPPOLearner'>, learner_connector=None, add_default_connectors_to_learner_pipeline=True, is_multi_agent=False, policies_to_update=['default_policy'], lr=0.0060984166342, num_total_minibatches=0, num_epochs=1, minibatch_size=1000, shuffle_batch_per_epoch=True)"], "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9485408017724, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.callbacks.callbacks.RLlibCallback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 230.66212105751038, "iterations_since_restore": 19, "perf": {"cpu_util_percent": 48.37777777777777, "ram_util_percent": 80.77777777777777}}
{"timers": {"training_iteration": 11.152625723320913, "restore_env_runners": 2.0572721848987856e-05, "training_step": 11.152334805507106, "env_runner_sampling_timer": 1.756767255799382, "learner_update_timer": 9.178351227564386, "synch_weights": 0.0017542051201356193, "restore_eval_env_runners": 8.021044962743817e-05, "evaluation_iteration": 0.13814853369449887, "synch_eval_env_connectors": 0.00020017287202062667, "synch_env_connectors": 4.996866398980547e-06}, "env_runners": {"module_to_env_connector": {"timers": {"connectors": {"listify_data_for_vector_env": 1.0681305556901899e-05, "normalize_and_clip_actions": 8.092672730052935e-06, "get_actions": 4.106967286650018e-05, "tensor_to_numpy": 1.5505336982279745e-05, "un_batch_to_individual_items": 6.737734534045902e-06, "remove_single_ts_time_rank_from_batch": 1.1998247245192838e-05}}, "connector_pipeline_timer": 0.00012148049963116796}, "time_between_sampling": 0.043677005707152265, "env_to_module_sum_episodes_length_in": 10.36823839457432, "env_to_module_connector": {"timers": {"connectors": {"add_observations_from_episodes_to_batch": 2.8299582807280793e-06, "numpy_to_tensor": 1.2784916179728368e-05, "batch_individual_items": 1.255114307442373e-05, "add_states_from_episodes_to_batch": 2.784063026969278e-06, "add_time_dim_to_batch_and_zero_pad": 6.9917080747830165e-06}}, "connector_pipeline_timer": 6.067070388163238e-05}, "num_agent_steps_sampled_lifetime": {"default_agent": -11105000.0}, "env_reset_timer": 4.601837067635987e-05, "episode_return_mean": 3.62, "episode_return_min": -9.5, "env_to_module_sum_episodes_length_out": 10.36823839457432, "module_episode_returns_mean": {"default_policy": 3.62}, "agent_episode_returns_mean": {"default_agent": 3.62}, "episode_len_max": 20, "sample": 0.005863495562935406, "rlmodule_inference_timer": 3.281014426277394e-05, "episode_len_mean": 20.0, "num_env_steps_sampled": 5000.0, "weights_seq_no": 19.0, "num_agent_steps_sampled": {"default_agent": 5000.0}, "episode_return_max": 10.5, "num_episodes": 250.0, "num_module_steps_sampled": {"default_policy": 5000.0}, "env_step_timer": 1.4166086339569544e-05, "num_module_steps_sampled_lifetime": {"default_policy": -11105000.0}, "episode_duration_sec_mean": 0.005406724480912089, "num_episodes_lifetime": -555250.0, "num_env_steps_sampled_lifetime": -11105000.0, "episode_len_min": 20, "num_env_steps_sampled_lifetime_throughput": 3166.3664660371896}, "__all_modules__": {"learner_connector_sum_episodes_length_in": 5000.0, "learner_connector": {"connector_pipeline_timer": 0.17560704464651683, "timers": {"connectors": {"add_one_ts_to_episodes_and_truncate": 0.009118035400584116, "add_observations_from_episodes_to_batch": 0.000836120715671115, "add_columns_from_episodes_to_train_batch": 0.04197129173924781, "add_time_dim_to_batch_and_zero_pad": 0.10373783851501371, "add_states_from_episodes_to_batch": 0.003568129167410945, "batch_individual_items": 0.016156644561116103, "numpy_to_tensor": 7.489398365781314e-05}}}, "learner_connector_sum_episodes_length_out": 5250.0}, "learners": {"intrinsic_reward_module": {"gradients_default_optimizer_global_norm": 0.0, "num_module_steps_trained": 5994, "total_loss": 0.0, "num_trainable_parameters": 8266, "default_optimizer_learning_rate": 0.0002715581955, "curr_entropy_coeff": 0.0015431216992, "weights_seq_no": 20.0, "diff_num_grad_updates_vs_sampler_policy": 1.0, "num_module_steps_trained_lifetime": 119880, "module_train_batch_size_mean": 999.0, "num_module_steps_trained_lifetime_throughput": 605.2908266489962}, "__all_modules__": {"num_module_steps_trained_lifetime": 239760, "num_module_steps_trained": 11988, "num_non_trainable_parameters": 0, "num_env_steps_trained": 31500, "num_env_steps_trained_lifetime": 630000, "num_trainable_parameters": 24861, "num_env_steps_trained_lifetime_throughput": 3180.9920484763675, "num_module_steps_trained_throughput": 17866583.829115737, "num_module_steps_trained_lifetime_throughput": 11598571.43567401}, "differentiable_learners": {"intrinsic_attention_ppo_learner": {"intrinsic_reward_module": {"diff_num_grad_updates_vs_sampler_policy": 101.0, "total_loss": 0.0, "num_module_steps_trained_lifetime": 719280, "num_module_steps_trained": 35964, "module_train_batch_size_mean": 999.0, "weights_seq_no": 120.0}, "default_policy": {"num_module_steps_trained_lifetime": 719280, "num_module_steps_trained": 35964, "module_train_batch_size_mean": 999.0, "vf_loss_unclipped": 39.807395935058594, "mean_kl_loss": 2.0995426893932745e-05, "use_intrinsic_rewards": 1.0, "entropy": 0.666786789894104, "policy_loss": -0.00040254282066598535, "diff_num_grad_updates_vs_sampler_policy": 101.0, "total_loss": 0.20305292308330536, "vf_explained_var": 0.0019465088844299316, "weights_seq_no": 120.0, "vf_loss": 0.2624744772911072}, "__all_modules__": {"num_module_steps_trained_lifetime": 1438560, "num_env_steps_trained": 189000, "num_env_steps_trained_lifetime": 3780000, "num_module_steps_trained": 71928, "num_env_steps_trained_lifetime_throughput": 34674.77269514391}}}, "default_policy": {"vf_loss_unclipped": 39.936805725097656, "mean_kl_loss": 2.2648595404461958e-05, "curr_kl_coeff": 1.5409844422720198e-07, "curr_entropy_coeff": 0.0015431216992, "use_intrinsic_rewards": 0.0, "entropy": 0.666729748249054, "policy_loss": -0.00041717785643413663, "diff_num_grad_updates_vs_sampler_policy": 1.0, "total_loss": 0.2030002921819687, "num_trainable_parameters": 16595, "vf_explained_var": 0.00017398595809936523, "weights_seq_no": 20.0, "vf_loss": 0.26242995262145996, "num_module_steps_trained_lifetime": 119880, "module_train_batch_size_mean": 999.0, "num_module_steps_trained": 5994, "num_module_steps_trained_lifetime_throughput": 605.2880444732684}, "IntrinsicAttentionMask": [[[0.3330930471420288, 0.33237847685813904, 0.33452844619750977], [0.3330572545528412, 0.33223697543144226, 0.33470574021339417], [0.33316460251808167, 0.33266180753707886, 0.33417361974716187]], [[0.3330901563167572, 0.33236706256866455, 0.33454272150993347], [0.3330543637275696, 0.33222559094429016, 0.33472001552581787], [0.33316174149513245, 0.33265042304992676, 0.33418789505958557]], [[0.33163926005363464, 0.33469000458717346, 0.3336707353591919], [0.3321695923805237, 0.334264874458313, 0.33356550335884094], [0.3319929242134094, 0.3344064950942993, 0.33360064029693604]], [[0.33300402760505676, 0.33343929052352905, 0.3335566818714142], [0.3330380320549011, 0.33342835307121277, 0.3335335850715637], [0.33304721117019653, 0.3334254026412964, 0.3335273563861847]], [[0.3330192267894745, 0.3337673544883728, 0.3332134187221527], [0.3331005573272705, 0.3336549699306488, 0.3332444727420807], [0.33304035663604736, 0.33373814821243286, 0.3332214951515198]], [[0.3341822326183319, 0.33168426156044006, 0.33413344621658325], [0.33946850895881653, 0.32142364978790283, 0.33910784125328064], [0.3342858850955963, 0.33148300647735596, 0.33423110842704773]]]}, "num_training_step_calls_per_iteration": 1, "evaluation": {"env_runners": {"episode_len_max": 20, "rlmodule_inference_timer": 3.115729979910739e-05, "weights_seq_no": 20.0, "module_to_env_connector": {"timers": {"connectors": {"remove_single_ts_time_rank_from_batch": 1.1698662498146303e-05, "listify_data_for_vector_env": 1.0407546918022291e-05, "normalize_and_clip_actions": 7.78636289851726e-06, "get_actions": 3.66726340473866e-05, "tensor_to_numpy": 1.5121664909484654e-05, "un_batch_to_individual_items": 6.47481682593607e-06}}, "connector_pipeline_timer": 0.00011393652605838841}, "episode_return_max": 14.5, "num_episodes": 20, "num_episodes_lifetime": 400, "num_agent_steps_sampled_lifetime": {"default_agent": 8000}, "env_reset_timer": 0.0005262896672429527, "env_to_module_sum_episodes_length_out": 10.368238394574323, "num_module_steps_sampled_lifetime": {"default_policy": 8000}, "env_to_module_connector": {"timers": {"connectors": {"numpy_to_tensor": 1.1822511155550468e-05, "batch_individual_items": 1.2321859268381328e-05, "add_observations_from_episodes_to_batch": 2.81241599493763e-06, "add_states_from_episodes_to_batch": 2.952982442760765e-06, "add_time_dim_to_batch_and_zero_pad": 7.20525618429912e-06}}, "connector_pipeline_timer": 5.90230889109789e-05}, "episode_return_mean": 1.45, "sample": 0.12579641661294097, "episode_len_mean": 20.0, "env_step_timer": 1.3717881806832473e-05, "episode_duration_sec_mean": 0.005801646654726937, "num_env_steps_sampled_lifetime": 100400, "agent_episode_returns_mean": {"default_agent": 1.45}, "num_env_steps_sampled": 400, "num_agent_steps_sampled": {"default_agent": 400}, "num_module_steps_sampled": {"default_policy": 400}, "episode_len_min": 20, "env_to_module_sum_episodes_length_in": 10.368238394574323, "module_episode_returns_mean": {"default_policy": 1.45}, "episode_return_min": -13.5, "time_between_sampling": 11.3487878408507}, "num_healthy_workers": 1, "actor_manager_num_outstanding_async_reqs": 0, "num_remote_worker_restarts": 0}, "num_env_steps_sampled_lifetime": -11105000.0, "fault_tolerance": {"num_healthy_workers": 0, "num_remote_worker_restarts": 0}, "env_runner_group": {"actor_manager_num_outstanding_async_reqs": 0}, "done": true, "training_iteration": 20, "trial_id": "ba99d_00000", "date": "2025-08-11_18-00-32", "timestamp": 1754928032, "time_this_iter_s": 11.420631885528564, "time_total_s": 242.08275294303894, "pid": 9655, "hostname": "Mac", "node_ip": "127.0.0.1", "config": {"exploration_config": {}, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 2, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "env": "Umbrella", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": false, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 0, "create_local_env_runner": true, "num_envs_per_env_runner": 1, "gym_env_vectorize_mode": "SYNC", "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "episodes_to_numpy": true, "max_requests_in_flight_per_env_runner": 1, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "merge_env_runner_states": "training_only", "broadcast_env_runner_states": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "complete_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "sampler_perf_stats_ema_coef": null, "_is_online": true, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": "auto", "num_aggregator_actors_per_learner": 0, "max_requests_in_flight_per_aggregator_actor": 3, "local_gpu_idx": 0, "max_requests_in_flight_per_learner": 3, "gamma": 1, "lr": 0.0002715581955, "grad_clip": 0.5, "grad_clip_by": "global_norm", "_train_batch_size_per_learner": 5000, "train_batch_size": 4000, "num_epochs": 1, "minibatch_size": 1000, "shuffle_batch_per_epoch": true, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "log_std_clip_param": 20.0, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "_disable_preprocessor_api": false, "_disable_action_flattening": false}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {"intrinsic_reward_coeff": 0.2795015916508}, "optimizer": {}, "_learner_class": "<class 'source.intrinsic_attention_ppo.learners.IntrinsicAttentionMetaLearner.IntrinsicAttentionMetaLearner'>", "callbacks_on_algorithm_init": null, "callbacks_on_env_runners_recreated": null, "callbacks_on_offline_eval_runners_recreated": null, "callbacks_on_checkpoint_loaded": null, "callbacks_on_environment_created": null, "callbacks_on_episode_created": null, "callbacks_on_episode_start": null, "callbacks_on_episode_step": null, "callbacks_on_episode_end": null, "callbacks_on_evaluate_start": null, "callbacks_on_evaluate_end": null, "callbacks_on_evaluate_offline_start": null, "callbacks_on_evaluate_offline_end": null, "callbacks_on_sample_end": null, "callbacks_on_train_result": null, "explore": true, "enable_rl_module_and_learner": true, "enable_env_runner_and_connector_v2": true, "_prior_exploration_config": {"type": "StochasticSampling"}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x15d6f98a0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "offline_data_class": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_read_batch_size": null, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "materialize_data": false, "materialize_mapped_data": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "ignore_final_observation": false, "prelearner_class": null, "prelearner_buffer_class": null, "prelearner_buffer_kwargs": {}, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_remaining_data": false, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": 1, "evaluation_duration": 20, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_auto_duration_min_env_steps_per_sample": 100, "evaluation_auto_duration_max_env_steps_per_sample": 2000, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 1, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "offline_evaluation_interval": null, "num_offline_eval_runners": 0, "offline_loss_for_module_fn": null, "offline_evaluation_duration": 1, "offline_evaluation_parallel_to_training": false, "offline_evaluation_timeout_s": 120.0, "num_cpus_per_offline_eval_runner": 1, "num_gpus_per_offline_eval_runner": 0, "custom_resources_per_offline_eval_runner": {}, "restart_failed_offline_eval_runners": true, "ignore_offline_eval_runner_failures": false, "max_num_offline_eval_runner_restarts": 1000, "offline_eval_runner_restore_timeout_s": 1800.0, "max_requests_in_flight_per_offline_eval_runner": 1, "validate_offline_eval_runners_after_construction": true, "offline_eval_runner_health_probe_timeout_s": 30.0, "offline_eval_rl_module_inference_only": false, "broadcast_offline_eval_runner_states": false, "offline_eval_batch_size_per_runner": 256, "dataset_num_iters_per_eval_runner": 1, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "log_gradients": false, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 6, "restart_failed_env_runners": true, "ignore_env_runner_failures": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30.0, "env_runner_restore_timeout_s": 1800.0, "_model_config": {}, "_rl_module_spec": "MultiRLModuleSpec(multi_rl_module_class=<class 'ray.rllib.core.rl_module.multi_rl_module.MultiRLModule'>, observation_space=None, action_space=None, inference_only=False, model_config=None, rl_module_specs={'default_policy': RLModuleSpec(module_class=<class 'source.intrinsic_attention_ppo.rl_modules.DifferentiablePPOModule.DifferentiablePPOModule'>, observation_space=None, action_space=None, inference_only=False, learner_only=False, model_config={'vf_share_layers': True, 'embedding_dim': 62, 'max_seq_len': 3, 'policy_head_hidden_sizes': [32], 'value_head_hidden_sizes': [101], 'embedding_hidden_sizes': [121]}, catalog_class=None, load_state_path=None, model_config_dict=None), 'intrinsic_reward_module': RLModuleSpec(module_class=<class 'source.intrinsic_attention_ppo.rl_modules.IntrinsicAttentionModule.IntrinsicAttentionModule'>, observation_space=None, action_space=None, inference_only=False, learner_only=True, model_config={'intrinsic_reward_network': {'encoder_hidden_sizes': [], 'encoding_dim': 1, 'num_heads': 1, 'head_hidden_sizes': None, 'layers': [{'type': 'attention'}]}, 'extrinsic_value_hidden_layers': [127, 60], 'vf_share_layers': True, 'max_seq_len': 3}, catalog_class=None, load_state_path=None, model_config_dict=None)}, load_state_path=None, modules_to_load=None, module_specs={'default_policy': RLModuleSpec(module_class=<class 'source.intrinsic_attention_ppo.rl_modules.DifferentiablePPOModule.DifferentiablePPOModule'>, observation_space=None, action_space=None, inference_only=False, learner_only=False, model_config={'vf_share_layers': True, 'embedding_dim': 62, 'max_seq_len': 3, 'policy_head_hidden_sizes': [32], 'value_head_hidden_sizes': [101], 'embedding_hidden_sizes': [121]}, catalog_class=None, load_state_path=None, model_config_dict=None), 'intrinsic_reward_module': RLModuleSpec(module_class=<class 'source.intrinsic_attention_ppo.rl_modules.IntrinsicAttentionModule.IntrinsicAttentionModule'>, observation_space=None, action_space=None, inference_only=False, learner_only=True, model_config={'intrinsic_reward_network': {'encoder_hidden_sizes': [], 'encoding_dim': 1, 'num_heads': 1, 'head_hidden_sizes': None, 'layers': [{'type': 'attention'}]}, 'extrinsic_value_hidden_layers': [127, 60], 'vf_share_layers': True, 'max_seq_len': 3}, catalog_class=None, load_state_path=None, model_config_dict=None)})", "algorithm_config_overrides_per_module": {"intrinsic_reward_module": {"lr": 0.0002715581955}}, "_per_module_overrides": {}, "_validate_config": true, "_use_msgpack_checkpoints": false, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "env_task_fn": -1, "enable_connectors": -1, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.161583927863, "kl_target": 0.0201019014258, "vf_loss_coeff": 0.7790510010087, "entropy_coeff": 0.0015431216992, "clip_param": 0.2459212356676, "vf_clip_param": 0.3769744131561, "entropy_coeff_schedule": null, "lr_schedule": null, "sgd_minibatch_size": -1, "vf_share_layers": -1, "differentiable_learner_configs": ["DifferentiableLearnerConfig(learner_class=<class 'source.intrinsic_attention_ppo.learners.IntrinsicAttentionPPOLearner.IntrinsicAttentionPPOLearner'>, learner_connector=None, add_default_connectors_to_learner_pipeline=True, is_multi_agent=False, policies_to_update=['default_policy'], lr=0.0060984166342, num_total_minibatches=0, num_epochs=1, minibatch_size=1000, shuffle_batch_per_epoch=True)"], "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9485408017724, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.callbacks.callbacks.RLlibCallback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 242.08275294303894, "iterations_since_restore": 20, "perf": {"cpu_util_percent": 47.31875, "ram_util_percent": 80.78125}}
