{"timers": {"training_iteration": 10.236460458952934, "restore_env_runners": 1.291697844862938e-05, "training_step": 10.236258332966827, "env_runner_sampling_timer": 2.6096668749814853, "learner_update_timer": 7.377603124943562, "synch_weights": 0.0018009169725701213}, "env_runners": {"env_reset_timer": 0.0002104717784496847, "num_episodes_lifetime": 31375.0, "num_env_steps_sampled_lifetime": 627500.0, "num_env_steps_sampled": 5000.0, "module_to_env_connector": {"timers": {"connectors": {"remove_single_ts_time_rank_from_batch": 1.733764185675052e-05, "get_actions": 8.762249466405406e-05, "listify_data_for_vector_env": 1.8300642023029793e-05, "tensor_to_numpy": 2.4176367113603277e-05, "un_batch_to_individual_items": 9.338326976152674e-06, "normalize_and_clip_actions": 1.5213014015932342e-05}}, "connector_pipeline_timer": 0.00021322735232916405}, "module_episode_returns_mean": {"default_policy": -0.7000000000000002}, "time_between_sampling": 0.0006673174909249766, "rlmodule_inference_timer": 0.00011709824617824208, "env_step_timer": 2.5601681306580255e-05, "env_to_module_connector": {"timers": {"connectors": {"batch_individual_items": 1.8106066317966698e-05, "add_observations_from_episodes_to_batch": 4.24195419678745e-06, "add_states_from_episodes_to_batch": 3.6123918837815567e-06, "numpy_to_tensor": 2.059110480181932e-05, "add_time_dim_to_batch_and_zero_pad": 1.0797857452816413e-05}}, "connector_pipeline_timer": 8.781881510358226e-05}, "weights_seq_no": 0.0, "num_agent_steps_sampled": {"default_agent": 5000.0}, "episode_len_min": 20, "episode_len_mean": 20.0, "num_episodes": 250.0, "sample": 0.010310174585445489, "episode_duration_sec_mean": 0.009212724143639203, "episode_len_max": 20, "num_module_steps_sampled": {"default_policy": 5000.0}, "num_agent_steps_sampled_lifetime": {"default_agent": 627500.0}, "num_module_steps_sampled_lifetime": {"default_policy": 627500.0}, "env_to_module_sum_episodes_length_out": 10.191744832559449, "agent_episode_returns_mean": {"default_agent": -0.7000000000000002}, "episode_return_max": 10.5, "episode_return_min": -9.5, "env_to_module_sum_episodes_length_in": 10.191744832559449, "episode_return_mean": -0.7000000000000002, "num_env_steps_sampled_lifetime_throughput": 2448.893132964845}, "__all_modules__": {"learner_connector_sum_episodes_length_in": 5000, "learner_connector": {"connector_pipeline_timer": 0.207839792012237, "timers": {"connectors": {"add_one_ts_to_episodes_and_truncate": 0.009047292056493461, "add_observations_from_episodes_to_batch": 0.0008797079790383577, "add_columns_from_episodes_to_train_batch": 0.10178191703744233, "add_time_dim_to_batch_and_zero_pad": 0.0878071659244597, "add_states_from_episodes_to_batch": 0.003591874963603914, "batch_individual_items": 0.004443584010004997, "numpy_to_tensor": 8.662499021738768e-05}}}, "learner_connector_sum_episodes_length_out": 5250}, "learners": {"differentiable_learners": {"intrinsic_attention_ppo_learner": {"intrinsic_reward_module": {"num_module_steps_trained_lifetime": 35910, "weights_seq_no": 6.0, "total_loss": 0.0, "num_module_steps_trained": 35910, "diff_num_grad_updates_vs_sampler_policy": 6.0, "module_train_batch_size_mean": 997.8474438281662}, "default_policy": {"module_train_batch_size_mean": 997.8474438281662, "use_intrinsic_rewards": 1.0, "num_module_steps_trained_lifetime": 35910, "policy_loss": -0.00019974099996034056, "mean_kl_loss": 1.2999326827412006e-05, "entropy": 0.6881763339042664, "weights_seq_no": 6.0, "vf_loss_unclipped": 45.8176155090332, "vf_loss": 0.3585103750228882, "total_loss": 0.27803826332092285, "vf_explained_var": -0.00253450870513916, "num_module_steps_trained": 35910, "diff_num_grad_updates_vs_sampler_policy": 6.0}, "__all_modules__": {"num_env_steps_trained_lifetime": 198000, "num_module_steps_trained": 71820, "num_module_steps_trained_lifetime": 71820, "num_env_steps_trained": 198000, "num_env_steps_trained_lifetime_throughput": 57952.58034083048}}}, "intrinsic_reward_module": {"num_module_steps_trained": 5985, "curr_entropy_coeff": 0.0015431216992, "total_loss": 0.0, "num_module_steps_trained_lifetime": 5985, "gradients_default_optimizer_global_norm": 0.0, "diff_num_grad_updates_vs_sampler_policy": 1.0, "module_train_batch_size_mean": 997.9705930399, "default_optimizer_learning_rate": 0.0002715581955, "num_trainable_parameters": 8266, "weights_seq_no": 1.0, "num_module_steps_trained_lifetime_throughput": 833.0378297554176}, "__all_modules__": {"num_trainable_parameters": 24861, "num_non_trainable_parameters": 0, "num_env_steps_trained_lifetime": 33000, "num_module_steps_trained": 11970, "num_module_steps_trained_lifetime": 11970, "num_env_steps_trained": 33000, "num_env_steps_trained_lifetime_throughput": 4595.103010733427, "num_module_steps_trained_throughput": 32916989.65300478, "num_module_steps_trained_lifetime_throughput": 13611338.238647928}, "default_policy": {"vf_loss": 0.3583683371543884, "weights_seq_no": 1.0, "curr_entropy_coeff": 0.0015431216992, "vf_loss_unclipped": 45.65005111694336, "total_loss": 0.27792060375213623, "vf_explained_var": -0.00019979476928710938, "num_module_steps_trained": 5985, "diff_num_grad_updates_vs_sampler_policy": 1.0, "curr_kl_coeff": 0.08079196512699127, "use_intrinsic_rewards": 0.0, "module_train_batch_size_mean": 997.9705930399, "num_module_steps_trained_lifetime": 5985, "policy_loss": -0.00020690060046035796, "num_trainable_parameters": 16595, "mean_kl_loss": 1.3916096577304415e-05, "entropy": 0.6881939172744751, "num_module_steps_trained_lifetime_throughput": 833.0178674950162}, "IntrinsicAttentionMask": [[[0.09226551651954651, 0.08947771787643433, 0.09395239502191544, 0.08911025524139404, 0.09356655925512314, 0.08606135845184326, 0.09036519378423691, 0.090179443359375, 0.08999408781528473, 0.09260889142751694, 0.09241853654384613], [0.09124212712049484, 0.09056385606527328, 0.09164504706859589, 0.09047326445579529, 0.09155337512493134, 0.08971048891544342, 0.09078148752450943, 0.09073607623577118, 0.09069067984819412, 0.09132459759712219, 0.09127891063690186], [0.09286044538021088, 0.08882831037044525, 0.09532694518566132, 0.08830097317695618, 0.09476102888584137, 0.08396319299936295, 0.09010589867830276, 0.08983804285526276, 0.08957098424434662, 0.09336090087890625, 0.09308336675167084], [0.09110336750745773, 0.0907081887125969, 0.09133753925561905, 0.09065530449151993, 0.09128429740667343, 0.0902092233300209, 0.09083512425422668, 0.09080863744020462, 0.09078217297792435, 0.09115132689476013, 0.0911247581243515], [0.09272594004869461, 0.08897630870342255, 0.09501396119594574, 0.08848504722118378, 0.09448936581611633, 0.0844360888004303, 0.0901656523346901, 0.0899164006114006, 0.08966783434152603, 0.0931905210018158, 0.09293290227651596], [0.08991554379463196, 0.09191561490297318, 0.08875495940446854, 0.09218724071979523, 0.08901724964380264, 0.0945175439119339, 0.0912674218416214, 0.09140217304229736, 0.09153712540864944, 0.08967635780572891, 0.08980876952409744], [0.09157350659370422, 0.09021639078855515, 0.09238447993993759, 0.09003590792417526, 0.0921996533870697, 0.08852335065603256, 0.09065075218677521, 0.09056002646684647, 0.09046939015388489, 0.09173920005559921, 0.09164738655090332], [0.09150458872318268, 0.09028898924589157, 0.09223010390996933, 0.09012717008590698, 0.09206481277942657, 0.08876980096101761, 0.09067825227975845, 0.09059696644544601, 0.09051574766635895, 0.09165287762880325, 0.09157071262598038], [0.09143558144569397, 0.09036149829626083, 0.09207583963871002, 0.09021839499473572, 0.09193002432584763, 0.08901678770780563, 0.09070562571287155, 0.09063377231359482, 0.09056197851896286, 0.09156648814678192, 0.09149395674467087], [0.0923880785703659, 0.0893450453877449, 0.09423350542783737, 0.08894458413124084, 0.09381113946437836, 0.08562776446342468, 0.09031283855438232, 0.09011021256446838, 0.08990804105997086, 0.09276347607374191, 0.09255535155534744], [0.09232023358345032, 0.08941856771707535, 0.09407775849103928, 0.08903637528419495, 0.0936756506562233, 0.08586771786212921, 0.09034189581871033, 0.09014861285686493, 0.08995575457811356, 0.09267788380384445, 0.09247960895299911]], [[0.09791731089353561, 0.0982341319322586, 0.0939147025346756, 0.09128351509571075, 0.08726970851421356, 0.09951171278953552, 0.09217245876789093, 0.09544393420219421, 0.060575854033231735, 0.09840566664934158, 0.08527102321386337], [0.09812846779823303, 0.0984562560915947, 0.09399033337831497, 0.09127313643693924, 0.08713303506374359, 0.09977839887142181, 0.09219086915254593, 0.09557068347930908, 0.059771325439214706, 0.09863374382257462, 0.08507373929023743], [0.09510547667741776, 0.09528455138206482, 0.09282185137271881, 0.09129846096038818, 0.08893877267837524, 0.09600424766540527, 0.09181516617536545, 0.09369903802871704, 0.07190413028001785, 0.09538140892982483, 0.08774688094854355], [0.09309800714254379, 0.09318765997886658, 0.09194742888212204, 0.09117218106985092, 0.08995877206325531, 0.09354713559150696, 0.09143583476543427, 0.0923910066485405, 0.08068588376045227, 0.09323611855506897, 0.08933988958597183], [0.08975722640752792, 0.08971315622329712, 0.09032856673002243, 0.09071965515613556, 0.09134197235107422, 0.08953709155321121, 0.0905860885977745, 0.0901070311665535, 0.09655550867319107, 0.08968936651945114, 0.09166427701711655], [0.09896417707204819, 0.09933624416589737, 0.09428060054779053, 0.09121920168399811, 0.0865766778588295, 0.1008385494351387, 0.09225192666053772, 0.09606626629829407, 0.05665094032883644, 0.09953776746988297, 0.08427765220403671], [0.0937914103269577, 0.09391114860773087, 0.09225806593894958, 0.09122844785451889, 0.08962258696556091, 0.09439162909984589, 0.09157828986644745, 0.09284847974777222, 0.07758784294128418, 0.09397587925195694, 0.08880624920129776], [0.09621240943670273, 0.09644391387701035, 0.09327086061239243, 0.09131968766450882, 0.0883152186870575, 0.0973755344748497, 0.09198047965765, 0.09439841657876968, 0.06730826944112778, 0.09656918048858643, 0.08680597692728043], [0.0549146942794323, 0.054243702441453934, 0.06436813622713089, 0.0717197135090828, 0.0851060003042221, 0.051640722900629044, 0.06912272423505783, 0.060530561953783035, 0.3415180444717407, 0.053884733468294144, 0.09295094758272171], [0.0982421264052391, 0.09857586026191711, 0.09403066337108612, 0.09126700460910797, 0.08705880492925644, 0.09992214292287827, 0.09220027178525925, 0.09563865512609482, 0.059340935200452805, 0.0987565666437149, 0.08496688306331635], [0.08795371651649475, 0.08784470707178116, 0.08937425911426544, 0.0903545618057251, 0.09192781895399094, 0.08741004019975662, 0.09001903980970383, 0.08882180601358414, 0.10575904697179794, 0.08778589218854904, 0.09274908900260925]], [[0.09309183806180954, 0.09498906880617142, 0.09009350091218948, 0.09459897875785828, 0.09440453350543976, 0.08683210611343384, 0.08665362745523453, 0.09098708629608154, 0.08629776537418365, 0.0888051763176918, 0.093246228992939], [0.09415359050035477, 0.09704194217920303, 0.08964847773313522, 0.09644570201635361, 0.09614895284175873, 0.08483219146728516, 0.08457118272781372, 0.09098343551158905, 0.08405156433582306, 0.08773539215326309, 0.09438755363225937], [0.09133405983448029, 0.09168936312198639, 0.09076043218374252, 0.09161677956581116, 0.09158051013946533, 0.09011869877576828, 0.09008302539587021, 0.09093298017978668, 0.09001170843839645, 0.09050921350717545, 0.09136319160461426], [0.09393841028213501, 0.09662207216024399, 0.08974132686853409, 0.09606853127479553, 0.09579295665025711, 0.08523847907781601, 0.08499396592378616, 0.0909864604473114, 0.0845070406794548, 0.08795475214719772, 0.09415598958730698], [0.09383054077625275, 0.09641235321760178, 0.08978734910488129, 0.09588003903627396, 0.0956149771809578, 0.0854419395327568, 0.08520574122667313, 0.09098753333091736, 0.08473529666662216, 0.08806420862674713, 0.09403997659683228], [0.08930615335702896, 0.08802346885204315, 0.09142746031284332, 0.08828359097242355, 0.08841393887996674, 0.09387696534395218, 0.09401557594537735, 0.09078270941972733, 0.09429340809583664, 0.09237660467624664, 0.08920010179281235], [0.08919157832860947, 0.08782056719064713, 0.09146200865507126, 0.08809848874807358, 0.08823777735233307, 0.0940883532166481, 0.09423711150884628, 0.09077153354883194, 0.09453534334897995, 0.09247909486293793, 0.08907816559076309], [0.09186837822198868, 0.09267985820770264, 0.09056667983531952, 0.09251375496387482, 0.09243082255125046, 0.0891227126121521, 0.08904282003641129, 0.0909571424126625, 0.08888323605060577, 0.08999986201524734, 0.09193476289510727], [0.08896198123693466, 0.08741529285907745, 0.09153024107217789, 0.0877285748720169, 0.08788563311100006, 0.09451161324977875, 0.09468081593513489, 0.09074828773736954, 0.09502013772726059, 0.09268348664045334, 0.08883392065763474], [0.09054774045944214, 0.09025076776742935, 0.09103173762559891, 0.09031125903129578, 0.09034152328968048, 0.09157992899417877, 0.0916106179356575, 0.09088555723428726, 0.09167202562093735, 0.09124547988176346, 0.09052331000566483], [0.09317968785762787, 0.09515715390443802, 0.09005792438983917, 0.09475043416023254, 0.09454772621393204, 0.08666709810495377, 0.08648168295621872, 0.09098785370588303, 0.08611204475164413, 0.08871786296367645, 0.09334054589271545]], [[0.09030941873788834, 0.08591768890619278, 0.08344019949436188, 0.09088070690631866, 0.08379172533750534, 0.09126356989145279, 0.08682543784379959, 0.08881843090057373, 0.12371638417243958, 0.09060224145650864, 0.08443409949541092], [0.09090486913919449, 0.09171637892723083, 0.09219604730606079, 0.09080272912979126, 0.09212698042392731, 0.09073469787836075, 0.09154469519853592, 0.09117506444454193, 0.08594445139169693, 0.09085242450237274, 0.09200163185596466], [0.09061536192893982, 0.09463117271661758, 0.09707054495811462, 0.09011968225240707, 0.09671622514724731, 0.08979073911905289, 0.09377000480890274, 0.09193708002567291, 0.0689128190279007, 0.09036055952310562, 0.0960758626461029], [0.09012018889188766, 0.08510297536849976, 0.08228933066129684, 0.09077555686235428, 0.08268779516220093, 0.0912151113152504, 0.08613694459199905, 0.08841268718242645, 0.1293867528438568, 0.0904560312628746, 0.08341661840677261], [0.09068191796541214, 0.09423274546861649, 0.09638122469186783, 0.090242400765419, 0.09606954455375671, 0.0899505764245987, 0.09347275644540787, 0.09185254573822021, 0.07115432620048523, 0.090456023812294, 0.09550590813159943], [0.08997838944196701, 0.08454922586679459, 0.0815165564417839, 0.0906895324587822, 0.08194550126791, 0.09116674959659576, 0.08566587418317795, 0.08812768012285233, 0.13328716158866882, 0.09034276008605957, 0.08273053169250488], [0.0909021869301796, 0.09058493375778198, 0.09039923548698425, 0.0909423977136612, 0.09042589366436005, 0.09096921980381012, 0.09065172076225281, 0.09079612046480179, 0.09293107688426971, 0.09092283248901367, 0.09047434478998184], [0.09067927300930023, 0.08797846734523773, 0.08643091470003128, 0.09102676063776016, 0.08665158599615097, 0.09125915169715881, 0.08854108303785324, 0.08976827561855316, 0.10975310206413269, 0.09085749089717865, 0.08705390244722366], [0.04489907994866371, 0.029479729011654854, 0.02302945777773857, 0.04735323786735535, 0.023861179128289223, 0.04906341806054115, 0.03221394494175911, 0.03901414945721626, 0.6394935846328735, 0.046142615377902985, 0.025449713692069054], [0.0902157574892044, 0.08550183475017548, 0.08285064250230789, 0.09083026647567749, 0.08322644978761673, 0.09124226868152618, 0.0864747017621994, 0.08861337602138519, 0.1266005039215088, 0.09053070098161697, 0.08391351997852325], [0.09078220278024673, 0.09349185228347778, 0.09511973708868027, 0.09044509381055832, 0.09488411247730255, 0.09022104740142822, 0.09291394799947739, 0.0916782096028328, 0.07539726048707962, 0.09060898423194885, 0.09445755928754807]], [[0.09073150157928467, 0.09077901393175125, 0.09082655608654022, 0.09087412804365158, 0.0897526741027832, 0.09050391614437103, 0.0917307659983635, 0.09177880734205246, 0.09182687103748322, 0.08998794108629227, 0.09120779484510422], [0.09069555252790451, 0.09075252711772919, 0.09080953150987625, 0.0908665806055069, 0.08952322602272034, 0.09042274951934814, 0.0918949618935585, 0.09195268899202347, 0.09201045334339142, 0.08980477601289749, 0.0912669226527214], [0.09065942466259003, 0.0907258540391922, 0.09079233556985855, 0.09085885435342789, 0.0892941802740097, 0.0903414711356163, 0.09205925464630127, 0.09212671220302582, 0.09219421446323395, 0.08962179720401764, 0.09132588654756546], [0.09062312543392181, 0.09069900214672089, 0.09077493846416473, 0.09085093438625336, 0.08906552940607071, 0.0902600809931755, 0.09222365915775299, 0.09230087697505951, 0.0923781469464302, 0.08943899720907211, 0.09138470888137817], [0.09143645316362381, 0.09128663688898087, 0.09113706648349762, 0.09098773449659348, 0.09459611773490906, 0.09215851873159409, 0.08835286647081375, 0.08820809423923492, 0.0880635678768158, 0.09382366389036179, 0.08994925767183304], [0.09090149402618408, 0.09090355783700943, 0.09090561419725418, 0.09090767800807953, 0.0908588245511055, 0.09089161455631256, 0.09094460308551788, 0.09094666689634323, 0.09094872325658798, 0.09086912125349045, 0.09092209488153458], [0.08994335681200027, 0.09018728137016296, 0.09043186157941818, 0.09067709743976593, 0.08503597974777222, 0.08878249675035477, 0.09518633782863617, 0.09544447809457779, 0.09570331126451492, 0.08619531244039536, 0.09241253137588501], [0.0899038016796112, 0.09015702456235886, 0.09041097015142441, 0.09066562354564667, 0.0848148912191391, 0.08869901299476624, 0.09535256028175354, 0.09562113881111145, 0.09589046239852905, 0.08601610362529755, 0.09246840327978134], [0.08986407518386841, 0.09012660384178162, 0.09038989245891571, 0.09065395593643188, 0.08459420502185822, 0.08861541748046875, 0.09551887959241867, 0.09579791873693466, 0.09607778489589691, 0.08583710342645645, 0.09252411872148514], [0.09127332270145416, 0.09117136150598526, 0.09106951951980591, 0.09096778184175491, 0.0934114158153534, 0.09176398068666458, 0.08916390687227249, 0.08906430006027222, 0.0889648050069809, 0.09289084374904633, 0.09025883674621582], [0.09036418050527573, 0.09050597250461578, 0.09064798057079315, 0.09079021960496902, 0.0874762088060379, 0.08968713879585266, 0.0933772623538971, 0.0935237854719162, 0.09367053210735321, 0.08816465735435486, 0.09179215133190155]], [[0.09908799827098846, 0.09177998453378677, 0.09503752738237381, 0.10005294531583786, 0.08831308037042618, 0.1007014587521553, 0.10102729499340057, 0.08917310833930969, 0.05659586936235428, 0.0919402465224266, 0.08629049360752106], [0.09292980283498764, 0.09128347784280777, 0.09202929586172104, 0.09314015507698059, 0.09046708047389984, 0.09328065067529678, 0.09335098415613174, 0.09067185968160629, 0.08154667913913727, 0.09132063388824463, 0.089979387819767], [0.09582134336233139, 0.09164024889469147, 0.09352052211761475, 0.09636364877223969, 0.08960822969675064, 0.09672688692808151, 0.09690901637077332, 0.09011536091566086, 0.06915402412414551, 0.09173339605331421, 0.08840736001729965], [0.09981822967529297, 0.09177195280790329, 0.0953511893749237, 0.1008850708603859, 0.08797619491815567, 0.10160262137651443, 0.10196331143379211, 0.08891646564006805, 0.053998783230781555, 0.09194774925708771, 0.08576838672161102], [0.08955276012420654, 0.09060195088386536, 0.09012280404567719, 0.08942091464996338, 0.09113389998674393, 0.08933312445878983, 0.08928926289081573, 0.09099972993135452, 0.09751211851835251, 0.09057792276144028, 0.09145547449588776], [0.1002994105219841, 0.09175869077444077, 0.09555263817310333, 0.10143493115901947, 0.08774476498365402, 0.10219907015562057, 0.10258330404758453, 0.08873814344406128, 0.05232944339513779, 0.09194483608007431, 0.08541472256183624], [0.10053834319114685, 0.09174975752830505, 0.09565111249685287, 0.10170841962099075, 0.08762706816196442, 0.10249603539705276, 0.10289212316274643, 0.08864688873291016, 0.05151292681694031, 0.09194106608629227, 0.08523628860712051], [0.0904216393828392, 0.09080380201339722, 0.09062962234020233, 0.09037341177463531, 0.09099648147821426, 0.09034126996994019, 0.09032520651817322, 0.0909479558467865, 0.09325291216373444, 0.09079507738351822, 0.09111262112855911], [0.03810351714491844, 0.05422251299023628, 0.04617752134799957, 0.03644049912691116, 0.0647418349981308, 0.03537234663963318, 0.03485006466507912, 0.06191619485616684, 0.5023559331893921, 0.05378866195678711, 0.07203082740306854], [0.0930781215429306, 0.09130695462226868, 0.09210903942584991, 0.0933045968413353, 0.09042954444885254, 0.09345588833093643, 0.09353162348270416, 0.0906495749950409, 0.08088208734989166, 0.09134691208600998, 0.08990567922592163], [0.08742233365774155, 0.090031698346138, 0.08883430063724518, 0.08709769695997238, 0.09137242287397385, 0.08688194304704666, 0.08677425980567932, 0.09103312343358994, 0.10839206725358963, 0.08997142314910889, 0.09218873828649521]]]}, "num_training_step_calls_per_iteration": 1, "num_env_steps_sampled_lifetime": 627500.0, "evaluation": {"env_runners": {"module_to_env_connector": {"timers": {"connectors": {"remove_single_ts_time_rank_from_batch": 1.290432414403874e-05, "get_actions": 4.8417270068392706e-05, "normalize_and_clip_actions": 9.038844501026742e-06, "listify_data_for_vector_env": 1.0738487020827813e-05, "tensor_to_numpy": 1.7084580254775524e-05, "un_batch_to_individual_items": 6.919544731545301e-06}}, "connector_pipeline_timer": 0.00013227919822893098}, "episode_len_max": 20, "num_agent_steps_sampled_lifetime": {"default_agent": 400}, "num_module_steps_sampled_lifetime": {"default_policy": 400}, "episode_return_max": 14.5, "env_reset_timer": 0.0005789159331470728, "rlmodule_inference_timer": 3.7299738125847936e-05, "env_step_timer": 1.5879091501618292e-05, "env_to_module_connector": {"timers": {"connectors": {"add_states_from_episodes_to_batch": 2.8148400239634574e-06, "numpy_to_tensor": 1.2995674871150807e-05, "add_time_dim_to_batch_and_zero_pad": 8.752501658930891e-06, "add_observations_from_episodes_to_batch": 3.5600869490364563e-06, "batch_individual_items": 1.335976279608495e-05}}, "connector_pipeline_timer": 6.763689011257271e-05}, "episode_len_min": 20, "env_to_module_sum_episodes_length_out": 10.216013141322508, "env_to_module_sum_episodes_length_in": 10.216013141322508, "num_env_steps_sampled_lifetime": 5400, "num_agent_steps_sampled": {"default_agent": 400}, "weights_seq_no": 1.0, "module_episode_returns_mean": {"default_policy": 2.05}, "episode_len_mean": 20.0, "sample": 0.12679516698699445, "agent_episode_returns_mean": {"default_agent": 2.05}, "episode_return_mean": 2.05, "episode_return_min": -11.5, "num_episodes": 20, "episode_duration_sec_mean": 0.005757124931551516, "num_module_steps_sampled": {"default_policy": 400}, "num_episodes_lifetime": 20, "num_env_steps_sampled": 400}, "num_healthy_workers": 1, "actor_manager_num_outstanding_async_reqs": 0, "num_remote_worker_restarts": 0}, "fault_tolerance": {"num_healthy_workers": 0, "num_remote_worker_restarts": 0}, "env_runner_group": {"actor_manager_num_outstanding_async_reqs": 0}, "done": false, "training_iteration": 1, "trial_id": "b9446_00000", "date": "2025-08-11_18-34-23", "timestamp": 1754930063, "time_this_iter_s": 10.377753019332886, "time_total_s": 10.377753019332886, "pid": 11415, "hostname": "Mac", "node_ip": "127.0.0.1", "config": {"exploration_config": {}, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 2, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "env": "Umbrella", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": false, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 0, "create_local_env_runner": true, "num_envs_per_env_runner": 1, "gym_env_vectorize_mode": "SYNC", "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "episodes_to_numpy": true, "max_requests_in_flight_per_env_runner": 1, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "merge_env_runner_states": "training_only", "broadcast_env_runner_states": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "complete_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "sampler_perf_stats_ema_coef": null, "_is_online": true, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": "auto", "num_aggregator_actors_per_learner": 0, "max_requests_in_flight_per_aggregator_actor": 3, "local_gpu_idx": 0, "max_requests_in_flight_per_learner": 3, "gamma": 1, "lr": 0.0002715581955, "grad_clip": 0.5, "grad_clip_by": "global_norm", "_train_batch_size_per_learner": 5000, "train_batch_size": 4000, "num_epochs": 1, "minibatch_size": 1000, "shuffle_batch_per_epoch": true, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "log_std_clip_param": 20.0, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "_disable_preprocessor_api": false, "_disable_action_flattening": false}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {"intrinsic_reward_coeff": 0.2795015916508}, "optimizer": {}, "_learner_class": "<class 'source.intrinsic_attention_ppo.learners.IntrinsicAttentionMetaLearner.IntrinsicAttentionMetaLearner'>", "callbacks_on_algorithm_init": null, "callbacks_on_env_runners_recreated": null, "callbacks_on_offline_eval_runners_recreated": null, "callbacks_on_checkpoint_loaded": null, "callbacks_on_environment_created": null, "callbacks_on_episode_created": null, "callbacks_on_episode_start": null, "callbacks_on_episode_step": null, "callbacks_on_episode_end": null, "callbacks_on_evaluate_start": null, "callbacks_on_evaluate_end": null, "callbacks_on_evaluate_offline_start": null, "callbacks_on_evaluate_offline_end": null, "callbacks_on_sample_end": null, "callbacks_on_train_result": null, "explore": true, "enable_rl_module_and_learner": true, "enable_env_runner_and_connector_v2": true, "_prior_exploration_config": {"type": "StochasticSampling"}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x3884998a0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "offline_data_class": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_read_batch_size": null, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "materialize_data": false, "materialize_mapped_data": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "ignore_final_observation": false, "prelearner_class": null, "prelearner_buffer_class": null, "prelearner_buffer_kwargs": {}, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_remaining_data": false, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": 1, "evaluation_duration": 20, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_auto_duration_min_env_steps_per_sample": 100, "evaluation_auto_duration_max_env_steps_per_sample": 2000, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 1, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "offline_evaluation_interval": null, "num_offline_eval_runners": 0, "offline_loss_for_module_fn": null, "offline_evaluation_duration": 1, "offline_evaluation_parallel_to_training": false, "offline_evaluation_timeout_s": 120.0, "num_cpus_per_offline_eval_runner": 1, "num_gpus_per_offline_eval_runner": 0, "custom_resources_per_offline_eval_runner": {}, "restart_failed_offline_eval_runners": true, "ignore_offline_eval_runner_failures": false, "max_num_offline_eval_runner_restarts": 1000, "offline_eval_runner_restore_timeout_s": 1800.0, "max_requests_in_flight_per_offline_eval_runner": 1, "validate_offline_eval_runners_after_construction": true, "offline_eval_runner_health_probe_timeout_s": 30.0, "offline_eval_rl_module_inference_only": false, "broadcast_offline_eval_runner_states": false, "offline_eval_batch_size_per_runner": 256, "dataset_num_iters_per_eval_runner": 1, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "log_gradients": false, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 7, "restart_failed_env_runners": true, "ignore_env_runner_failures": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30.0, "env_runner_restore_timeout_s": 1800.0, "_model_config": {}, "_rl_module_spec": "MultiRLModuleSpec(multi_rl_module_class=<class 'ray.rllib.core.rl_module.multi_rl_module.MultiRLModule'>, observation_space=None, action_space=None, inference_only=False, model_config=None, rl_module_specs={'default_policy': RLModuleSpec(module_class=<class 'source.intrinsic_attention_ppo.rl_modules.DifferentiablePPOModule.DifferentiablePPOModule'>, observation_space=None, action_space=None, inference_only=False, learner_only=False, model_config={'vf_share_layers': True, 'embedding_dim': 62, 'max_seq_len': 11, 'policy_head_hidden_sizes': [32], 'value_head_hidden_sizes': [101], 'embedding_hidden_sizes': [121]}, catalog_class=None, load_state_path=None, model_config_dict=None), 'intrinsic_reward_module': RLModuleSpec(module_class=<class 'source.intrinsic_attention_ppo.rl_modules.IntrinsicAttentionModule.IntrinsicAttentionModule'>, observation_space=None, action_space=None, inference_only=False, learner_only=True, model_config={'intrinsic_reward_network': {'encoder_hidden_sizes': [], 'encoding_dim': 1, 'num_heads': 1, 'head_hidden_sizes': None, 'layers': [{'type': 'attention'}]}, 'extrinsic_value_hidden_layers': [127, 60], 'vf_share_layers': True, 'max_seq_len': 11}, catalog_class=None, load_state_path=None, model_config_dict=None)}, load_state_path=None, modules_to_load=None, module_specs={'default_policy': RLModuleSpec(module_class=<class 'source.intrinsic_attention_ppo.rl_modules.DifferentiablePPOModule.DifferentiablePPOModule'>, observation_space=None, action_space=None, inference_only=False, learner_only=False, model_config={'vf_share_layers': True, 'embedding_dim': 62, 'max_seq_len': 11, 'policy_head_hidden_sizes': [32], 'value_head_hidden_sizes': [101], 'embedding_hidden_sizes': [121]}, catalog_class=None, load_state_path=None, model_config_dict=None), 'intrinsic_reward_module': RLModuleSpec(module_class=<class 'source.intrinsic_attention_ppo.rl_modules.IntrinsicAttentionModule.IntrinsicAttentionModule'>, observation_space=None, action_space=None, inference_only=False, learner_only=True, model_config={'intrinsic_reward_network': {'encoder_hidden_sizes': [], 'encoding_dim': 1, 'num_heads': 1, 'head_hidden_sizes': None, 'layers': [{'type': 'attention'}]}, 'extrinsic_value_hidden_layers': [127, 60], 'vf_share_layers': True, 'max_seq_len': 11}, catalog_class=None, load_state_path=None, model_config_dict=None)})", "algorithm_config_overrides_per_module": {"intrinsic_reward_module": {"lr": 0.0002715581955}}, "_per_module_overrides": {}, "_validate_config": true, "_use_msgpack_checkpoints": false, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "env_task_fn": -1, "enable_connectors": -1, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.161583927863, "kl_target": 0.0201019014258, "vf_loss_coeff": 0.7790510010087, "entropy_coeff": 0.0015431216992, "clip_param": 0.2459212356676, "vf_clip_param": 0.3769744131561, "entropy_coeff_schedule": null, "lr_schedule": null, "sgd_minibatch_size": -1, "vf_share_layers": -1, "differentiable_learner_configs": ["DifferentiableLearnerConfig(learner_class=<class 'source.intrinsic_attention_ppo.learners.IntrinsicAttentionPPOLearner.IntrinsicAttentionPPOLearner'>, learner_connector=None, add_default_connectors_to_learner_pipeline=True, is_multi_agent=False, policies_to_update=['default_policy'], lr=0.0060984166342, num_total_minibatches=0, num_epochs=1, minibatch_size=1000, shuffle_batch_per_epoch=True)"], "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9485408017724, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.callbacks.callbacks.RLlibCallback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 10.377753019332886, "iterations_since_restore": 1, "perf": {"cpu_util_percent": 46.120000000000005, "ram_util_percent": 80.12666666666668}}
{"timers": {"training_iteration": 10.227834796443348, "restore_env_runners": 1.2859058333560825e-05, "training_step": 10.227631985887419, "env_runner_sampling_timer": 2.6009434124815742, "learner_update_timer": 7.378369635364506, "synch_weights": 0.0017987590527627616, "restore_eval_env_runners": 4.558393266052008e-05, "evaluation_iteration": 0.13860349997412413, "synch_eval_env_connectors": 0.00018466601613909006, "synch_env_connectors": 4.749977961182594e-06}, "env_runners": {"env_reset_timer": 7.024716566307442e-05, "num_episodes_lifetime": 500.0, "num_env_steps_sampled_lifetime": 10000.0, "num_env_steps_sampled": 5000.0, "module_to_env_connector": {"timers": {"connectors": {"remove_single_ts_time_rank_from_batch": 1.234026965175096e-05, "get_actions": 4.182619500563871e-05, "listify_data_for_vector_env": 1.100803591893414e-05, "tensor_to_numpy": 1.6123374085328972e-05, "un_batch_to_individual_items": 6.7779525444799364e-06, "normalize_and_clip_actions": 8.375542233413979e-06}}, "connector_pipeline_timer": 0.00012371788174274687}, "module_episode_returns_mean": {"default_policy": 1.699999999999999}, "time_between_sampling": 0.029293755209435262, "rlmodule_inference_timer": 3.325346003999347e-05, "env_step_timer": 1.4758190283156878e-05, "env_to_module_connector": {"timers": {"connectors": {"batch_individual_items": 1.293485924353084e-05, "add_observations_from_episodes_to_batch": 3.027501912561713e-06, "add_states_from_episodes_to_batch": 2.789190527356952e-06, "numpy_to_tensor": 1.336254541153389e-05, "add_time_dim_to_batch_and_zero_pad": 7.492942068495472e-06}}, "connector_pipeline_timer": 6.219499791813369e-05}, "weights_seq_no": 1.0, "num_agent_steps_sampled": {"default_agent": 5000.0}, "episode_len_min": 20, "episode_len_mean": 20.0, "num_episodes": 250.0, "sample": 0.008151551677860006, "episode_duration_sec_mean": 0.005486191961914303, "episode_len_max": 20, "num_module_steps_sampled": {"default_policy": 5000.0}, "num_agent_steps_sampled_lifetime": {"default_agent": 10000.0}, "num_module_steps_sampled_lifetime": {"default_policy": 10000.0}, "env_to_module_sum_episodes_length_out": 10.36823839457432, "agent_episode_returns_mean": {"default_agent": 1.699999999999999}, "episode_return_max": 10.5, "episode_return_min": -9.5, "env_to_module_sum_episodes_length_in": 10.36823839457432, "episode_return_mean": 1.699999999999999, "num_env_steps_sampled_lifetime_throughput": 3073.6720348021545}, "__all_modules__": {"learner_connector_sum_episodes_length_in": 5000.0, "learner_connector": {"connector_pipeline_timer": 0.2070952153415419, "timers": {"connectors": {"add_one_ts_to_episodes_and_truncate": 0.009042734545655549, "add_observations_from_episodes_to_batch": 0.0008790813200175762, "add_columns_from_episodes_to_train_batch": 0.1011760962079279, "add_time_dim_to_batch_and_zero_pad": 0.08767812759615481, "add_states_from_episodes_to_batch": 0.0035923953843303024, "batch_individual_items": 0.00443981233984232, "numpy_to_tensor": 8.635415113531053e-05}}}, "learner_connector_sum_episodes_length_out": 5250.0}, "learners": {"differentiable_learners": {"intrinsic_attention_ppo_learner": {"intrinsic_reward_module": {"num_module_steps_trained_lifetime": 71820, "weights_seq_no": 12.0, "total_loss": 0.0, "num_module_steps_trained": 35910, "diff_num_grad_updates_vs_sampler_policy": 11.0, "module_train_batch_size_mean": 997.7412016936058}, "default_policy": {"module_train_batch_size_mean": 997.7412016936058, "use_intrinsic_rewards": 1.0, "num_module_steps_trained_lifetime": 71820, "policy_loss": -6.671348819509149e-05, "mean_kl_loss": 1.6856385627761483e-05, "entropy": 0.6886232495307922, "weights_seq_no": 12.0, "vf_loss_unclipped": 44.15892791748047, "vf_loss": 0.3584766387939453, "total_loss": 0.2781449258327484, "vf_explained_var": -0.0022993087768554688, "num_module_steps_trained": 35910, "diff_num_grad_updates_vs_sampler_policy": 11.0}, "__all_modules__": {"num_env_steps_trained_lifetime": 396000, "num_module_steps_trained": 71820, "num_module_steps_trained_lifetime": 143640, "num_env_steps_trained": 198000, "num_env_steps_trained_lifetime_throughput": 57666.5236702264}}}, "intrinsic_reward_module": {"num_module_steps_trained": 5985, "curr_entropy_coeff": 0.0015431216992, "total_loss": 0.0, "num_module_steps_trained_lifetime": 11970, "gradients_default_optimizer_global_norm": 0.0, "diff_num_grad_updates_vs_sampler_policy": 1.0, "module_train_batch_size_mean": 997.9429069707118, "default_optimizer_learning_rate": 0.0002715581955, "num_trainable_parameters": 8266, "weights_seq_no": 2.0, "num_module_steps_trained_lifetime_throughput": 831.694591983791}, "__all_modules__": {"num_trainable_parameters": 24861, "num_non_trainable_parameters": 0, "num_env_steps_trained_lifetime": 66000, "num_module_steps_trained": 11970, "num_module_steps_trained_lifetime": 23940, "num_env_steps_trained": 33000, "num_env_steps_trained_lifetime_throughput": 4587.674109694923, "num_module_steps_trained_throughput": 32432469.41795566, "num_module_steps_trained_lifetime_throughput": 13578278.114913791}, "default_policy": {"vf_loss": 0.3584396243095398, "weights_seq_no": 2.0, "curr_entropy_coeff": 0.0015431216992, "vf_loss_unclipped": 44.059261322021484, "total_loss": 0.2781131863594055, "vf_explained_var": -0.0007137060165405273, "num_module_steps_trained": 5985, "diff_num_grad_updates_vs_sampler_policy": 1.0, "curr_kl_coeff": 0.040395982563495636, "use_intrinsic_rewards": 0.0, "module_train_batch_size_mean": 997.9429069707118, "num_module_steps_trained_lifetime": 11970, "policy_loss": -6.834096711827442e-05, "num_trainable_parameters": 16595, "mean_kl_loss": 1.6942003639996983e-05, "entropy": 0.6886246204376221, "num_module_steps_trained_lifetime_throughput": 831.6749165961535}, "IntrinsicAttentionMask": [[[0.09268765896558762, 0.09457665681838989, 0.08970233798027039, 0.09418825805187225, 0.08933395892381668, 0.09096560627222061, 0.09077863395214081, 0.08610005676746368, 0.09040583670139313, 0.08841961622238159, 0.09284138679504395], [0.09356089681386948, 0.09643106162548065, 0.08908414095640182, 0.09583857655525208, 0.08853679150342941, 0.09096961468458176, 0.09068972617387772, 0.08378022164106369, 0.09013251215219498, 0.08718309551477432, 0.09379338473081589], [0.09125375747680664, 0.09160875529050827, 0.09068063646554947, 0.09153623878955841, 0.09060885012149811, 0.09092501550912857, 0.09088901430368423, 0.08996818959712982, 0.09081706404685974, 0.0904296413064003, 0.09128286689519882], [0.09338343888521194, 0.09605125337839127, 0.08921115845441818, 0.09550098329782486, 0.088700070977211, 0.09097009152173996, 0.0907091423869133, 0.08424946665763855, 0.09018947184085846, 0.08743513375520706, 0.09359974414110184], [0.09107209742069244, 0.09123934060335159, 0.09080136567354202, 0.09120520204305649, 0.09076739847660065, 0.09091691672801971, 0.09089990705251694, 0.0904635637998581, 0.09086589515209198, 0.09068252146244049, 0.09108582139015198], [0.09186875820159912, 0.09287024289369583, 0.09026657789945602, 0.09266508370637894, 0.09006717801094055, 0.09094752371311188, 0.09084701538085938, 0.08830007165670395, 0.09064632654190063, 0.08957059681415558, 0.09195061028003693], [0.09177850186824799, 0.0926840528845787, 0.09032786637544632, 0.09249862283468246, 0.09014715254306793, 0.09094469994306564, 0.09085368365049362, 0.08854402601718903, 0.09067191928625107, 0.08969695121049881, 0.09185254573822021], [0.08943096548318863, 0.08796615153551102, 0.09186001121997833, 0.08826296776533127, 0.09216996282339096, 0.09081444144248962, 0.09096752852201462, 0.09499423950910568, 0.09127447009086609, 0.09294943511486053, 0.08930973708629608], [0.09159775078296661, 0.0923122689127922, 0.09045005589723587, 0.09216608107089996, 0.09030681103467941, 0.09093853831291199, 0.09086649864912033, 0.08903345465660095, 0.09072259813547134, 0.08994969725608826, 0.09165623039007187], [0.09061659127473831, 0.09031938016414642, 0.09110094606876373, 0.09037992358207703, 0.09116201847791672, 0.09089373052120209, 0.09092418849468231, 0.09171099215745926, 0.09098514169454575, 0.09131485968828201, 0.09059213846921921], [0.09275969117879868, 0.0947282463312149, 0.08965199440717697, 0.09432335942983627, 0.08926881104707718, 0.09096654504537582, 0.09077192842960358, 0.08590769022703171, 0.09038395434617996, 0.08831797540187836, 0.09291982650756836]], [[0.09178279340267181, 0.09173882752656937, 0.09235276281833649, 0.09057191014289856, 0.0911780297756195, 0.0915631651878357, 0.091519296169281, 0.09213177114725113, 0.08442232757806778, 0.09063529223203659, 0.09210381656885147], [0.09159603714942932, 0.0915617123246193, 0.09204057604074478, 0.09064961224794388, 0.09112370014190674, 0.09142457693815231, 0.09139031916856766, 0.09186828136444092, 0.08579952269792557, 0.0906992182135582, 0.09184648841619492], [0.09402242302894592, 0.09385066479444504, 0.09626992046833038, 0.08937638252973557, 0.09168030321598053, 0.093166783452034, 0.09299659729003906, 0.0953938364982605, 0.06834439933300018, 0.08961527794599533, 0.09528344124555588], [0.08580249547958374, 0.08600998669862747, 0.08316636085510254, 0.09174302965402603, 0.08870985358953476, 0.08684496581554413, 0.08705498278141022, 0.08417680114507675, 0.13076581060886383, 0.09142009168863297, 0.08430565148591995], [0.08902148902416229, 0.08910713344812393, 0.08792231976985931, 0.0914260745048523, 0.09021042287349701, 0.08945054560899734, 0.08953660726547241, 0.08834607899188995, 0.10528159141540527, 0.09129781275987625, 0.08839990198612213], [0.09082859009504318, 0.09083249419927597, 0.0907781645655632, 0.09093687683343887, 0.09088247269392014, 0.09084811806678772, 0.09085202217102051, 0.09079767018556595, 0.09151230752468109, 0.09093116968870163, 0.09080014377832413], [0.09063154458999634, 0.09064490348100662, 0.09045908600091934, 0.09100261330604553, 0.09081606566905975, 0.09069836884737015, 0.09071174263954163, 0.0905257910490036, 0.0929926186800003, 0.09098303318023682, 0.09053424000740051], [0.09319277852773666, 0.09307112544775009, 0.09477889537811279, 0.0898791253566742, 0.09152831882238388, 0.09258610010147095, 0.09246523678302765, 0.09416189044713974, 0.07420184463262558, 0.09005069732666016, 0.09408403187990189], [0.029982829466462135, 0.030519450083374977, 0.023841671645641327, 0.04902336001396179, 0.03829685226082802, 0.032763704657554626, 0.03335009515285492, 0.026052962988615036, 0.662051796913147, 0.04777003079652786, 0.026347298175096512], [0.08616181463003159, 0.0863570123910904, 0.08367930352687836, 0.0917387381196022, 0.08889415860176086, 0.08714219182729721, 0.0873396024107933, 0.08463143557310104, 0.12786678969860077, 0.09143617004156113, 0.08475280553102493], [0.0930844396352768, 0.09296907484531403, 0.09458785504102707, 0.08993934839963913, 0.09150537848472595, 0.09250905364751816, 0.0923943966627121, 0.09400317072868347, 0.0749756395816803, 0.09010232985019684, 0.09392938017845154]], [[0.09094341099262238, 0.09099104255437851, 0.08986815065145493, 0.0899152159690857, 0.08996230363845825, 0.09189688414335251, 0.09194501489400864, 0.09199316799640656, 0.09204134345054626, 0.09019812941551208, 0.09024535864591599], [0.09094925969839096, 0.09100639075040817, 0.08966096490621567, 0.08971729874610901, 0.08977365493774414, 0.09209416806697845, 0.09215202182531357, 0.09220991283655167, 0.09226784110069275, 0.09005599468946457, 0.09011256694793701], [0.09072089940309525, 0.09055334329605103, 0.0946119949221611, 0.09443724155426025, 0.09426282346248627, 0.08744075149297714, 0.08727925270795822, 0.08711804449558258, 0.08695714175701141, 0.09339550137519836, 0.09322300553321838], [0.09073430299758911, 0.090576171875, 0.0944017544388771, 0.09423723071813583, 0.09407299757003784, 0.08763578534126282, 0.08748305588960648, 0.08733059465885162, 0.08717839419841766, 0.09325611591339111, 0.09309358894824982], [0.09074737131595612, 0.0905986800789833, 0.09419164061546326, 0.09403730183839798, 0.0938832238316536, 0.08783093094825745, 0.08768702298402786, 0.08754333853721619, 0.08739989995956421, 0.09311659634113312, 0.09296402335166931], [0.09099643677473068, 0.09123367816209793, 0.08577010035514832, 0.08599372208118439, 0.08621793240308762, 0.09584077447652817, 0.0960906445980072, 0.09634117782115936, 0.09659235924482346, 0.08734774589538574, 0.08757548034191132], [0.09099557995796204, 0.09124235063791275, 0.08556605875492096, 0.08579810708761215, 0.08603078871965408, 0.09603943675756454, 0.09629989415407181, 0.09656105190515518, 0.09682291746139526, 0.08720368146896362, 0.08744016289710999], [0.09099438041448593, 0.09125068038702011, 0.08536219596862793, 0.08560262620449066, 0.08584374189376831, 0.09623817354440689, 0.09650924056768417, 0.09678107500076294, 0.09705366939306259, 0.08705952763557434, 0.0873047411441803], [0.09099284559488297, 0.09125866740942001, 0.08515848964452744, 0.08540727198123932, 0.0856567770242691, 0.09643695503473282, 0.0967186838388443, 0.09700123220682144, 0.09728460758924484, 0.0869152843952179, 0.08716920018196106], [0.09080775082111359, 0.09070631116628647, 0.09314291924238205, 0.09303887188434601, 0.09293493628501892, 0.08880829811096191, 0.08870909363031387, 0.08861000090837479, 0.08851101249456406, 0.09241701662540436, 0.09231378138065338], [0.09081883728504181, 0.09072685241699219, 0.09293355792760849, 0.09283944219350815, 0.09274541586637497, 0.08900409191846848, 0.08891395479440689, 0.08882390707731247, 0.08873394876718521, 0.09227671474218369, 0.09218326210975647]], [[0.09862760454416275, 0.09135355055332184, 0.09459595382213593, 0.09194567799568176, 0.0879027470946312, 0.10023356974124908, 0.10055789351463318, 0.08875877410173416, 0.061015188694000244, 0.09911949932575226, 0.08588956296443939], [0.09278770536184311, 0.091143898665905, 0.09188857674598694, 0.09128138422966003, 0.09032875299453735, 0.09313802421092987, 0.09320824593305588, 0.09053321927785873, 0.08295294642448425, 0.09289546310901642, 0.0898418053984642], [0.0955081433057785, 0.09134070575237274, 0.09321483969688416, 0.09168501198291779, 0.08931533247232437, 0.09641072154045105, 0.0965922549366951, 0.08982080966234207, 0.07220852375030518, 0.0957852452993393, 0.08811838179826736], [0.09329969435930252, 0.09119396656751633, 0.0921466127038002, 0.09136969596147537, 0.09015364944934845, 0.09374979883432388, 0.09384007751941681, 0.09041435271501541, 0.08086063712835312, 0.09343809634447098, 0.08953342586755753], [0.08965831995010376, 0.09070874005556107, 0.09022903442382812, 0.09061969071626663, 0.09124132245779037, 0.08943843096494675, 0.08939450979232788, 0.09110698848962784, 0.09644914418458939, 0.08959053456783295, 0.09156327694654465], [0.09979677945375443, 0.09129884839057922, 0.09507378190755844, 0.09198663383722305, 0.08730503171682358, 0.10168692469596863, 0.10206922143697739, 0.08829344063997269, 0.057127464562654495, 0.10037519037723541, 0.08498667180538177], [0.1000281423330307, 0.09128414839506149, 0.09516571462154388, 0.09199103713035583, 0.08718238770961761, 0.10197589546442032, 0.10236997902393341, 0.0881970226764679, 0.0563778392970562, 0.10062407702207565, 0.0848037376999855], [0.09045863896608353, 0.09084096550941467, 0.09066671878099442, 0.09080865979194641, 0.09103372693061829, 0.09037823975086212, 0.09036217629909515, 0.09098517149686813, 0.09288192540407181, 0.09043387323617935, 0.09114990383386612], [0.05369865149259567, 0.0718773826956749, 0.06294281035661697, 0.07013159990310669, 0.08322153240442276, 0.05049717798829079, 0.04988016188144684, 0.08020803332328796, 0.3339582681655884, 0.052691515535116196, 0.09089277684688568], [0.09898991882801056, 0.0913400873541832, 0.09474638104438782, 0.09196170419454575, 0.08772146701812744, 0.10068272054195404, 0.10102473944425583, 0.08861847221851349, 0.059792548418045044, 0.09950827062129974, 0.08561361581087112], [0.08770975470542908, 0.09032770246267319, 0.08912636339664459, 0.09010394662618637, 0.09167283773422241, 0.08716758340597153, 0.08705955743789673, 0.09133242070674896, 0.10546573996543884, 0.08754239976406097, 0.09249182790517807]], [[0.09105274081230164, 0.08992908149957657, 0.08997617661952972, 0.09119587391614914, 0.09124363213777542, 0.0920073539018631, 0.0908719152212143, 0.09091950953006744, 0.09096712619066238, 0.09148281067609787, 0.09035384654998779], [0.09034103900194168, 0.09462424367666245, 0.09443961083889008, 0.089813232421875, 0.08963798731565475, 0.08689367771148682, 0.09101343899965286, 0.09083585441112518, 0.09065861254930496, 0.08876686543226242, 0.0929754376411438], [0.09037268906831741, 0.09442324936389923, 0.09424884617328644, 0.08987285941839218, 0.08970686048269272, 0.08710513263940811, 0.0910092443227768, 0.090841144323349, 0.09067335724830627, 0.0888814702630043, 0.09286518394947052], [0.09113692492246628, 0.08934590220451355, 0.08942069858312607, 0.09136602282524109, 0.09144251048564911, 0.09266894310712814, 0.09084781259298325, 0.09092386811971664, 0.09099999815225601, 0.0918259397149086, 0.09002137929201126], [0.09116470068693161, 0.08915205299854279, 0.08923600614070892, 0.09142250567674637, 0.09150859713554382, 0.09289021790027618, 0.09083947539329529, 0.09092502295970917, 0.09101065248250961, 0.09194029867649078, 0.08991052955389023], [0.09158695489168167, 0.08610221743583679, 0.0863267034292221, 0.09230518341064453, 0.09254583716392517, 0.09646272659301758, 0.09068600088357925, 0.09092243760824203, 0.09115949273109436, 0.09375858306884766, 0.08814379572868347], [0.09094429016113281, 0.09067057818174362, 0.09068210422992706, 0.09097897261381149, 0.09099053591489792, 0.09117482602596283, 0.09090042114257812, 0.09091196954250336, 0.09092352539300919, 0.09104837477207184, 0.09077434986829758], [0.09097306430339813, 0.09047489613294601, 0.09049584716558456, 0.09103626757860184, 0.09105735272169113, 0.09139358997344971, 0.09089312702417374, 0.09091417491436005, 0.09093522280454636, 0.09116281569004059, 0.0906636193394661], [0.09100168198347092, 0.0902794823050499, 0.09030982106924057, 0.09109344333410263, 0.0911240503191948, 0.09161271899938583, 0.09088568389415741, 0.0909162163734436, 0.09094677120447159, 0.09127724170684814, 0.09055286645889282], [0.0913013443350792, 0.08818681538105011, 0.08831596374511719, 0.09170306473970413, 0.09183736890554428, 0.0940021201968193, 0.09079545736312866, 0.09092843532562256, 0.09106159955263138, 0.09251183271408081, 0.08935601264238358], [0.09062071144580841, 0.09282483160495758, 0.09273082762956619, 0.09034565836191177, 0.09025415778160095, 0.08880992978811264, 0.0909700095653534, 0.09087787568569183, 0.09078583866357803, 0.08979805558919907, 0.0919821634888649]], [[0.09132689237594604, 0.09138620644807816, 0.09202904254198074, 0.09150494635105133, 0.09068170189857483, 0.09310600161552429, 0.09168334305286407, 0.09085849672555923, 0.0842658132314682, 0.09289708733558655, 0.09026043117046356], [0.09138894081115723, 0.09145784378051758, 0.09220509231090546, 0.09159580618143082, 0.09063988924026489, 0.09345883876085281, 0.09180314093828201, 0.09084506332874298, 0.08323866873979568, 0.0932154431939125, 0.09015126526355743], [0.09197172522544861, 0.09214489907026291, 0.09403553605079651, 0.0924922376871109, 0.0901016891002655, 0.09725955128669739, 0.09301569312810898, 0.09061162173748016, 0.07284426689147949, 0.0966285690665245, 0.08889421075582504], [0.09150883555412292, 0.09159696102142334, 0.09255381673574448, 0.09177345782518387, 0.09055203944444656, 0.09416408091783524, 0.0920388475060463, 0.09081389755010605, 0.08121796697378159, 0.0938510000705719, 0.08992907404899597], [0.09055528789758682, 0.09051082283258438, 0.09003216028213501, 0.09042196720838547, 0.09104224294424057, 0.08924327790737152, 0.09028884023427963, 0.09090819954872131, 0.09623869508504868, 0.08939505368471146, 0.09136349707841873], [0.09261290729045868, 0.09296109527349472, 0.09680476039648056, 0.09366140514612198, 0.0888945683836937, 0.10353829711675644, 0.09472177922725677, 0.08990096300840378, 0.05816756188869476, 0.10220267623662949, 0.08653399348258972], [0.09167835116386414, 0.09179538488388062, 0.09306859225034714, 0.09202992171049118, 0.09040994942188263, 0.0952209010720253, 0.09238283336162567, 0.09075665473937988, 0.07826942950487137, 0.09480149298906326, 0.08958644419908524], [0.09078480303287506, 0.09076866507530212, 0.09059455245733261, 0.09073638170957565, 0.0909612774848938, 0.09030631929636002, 0.09068799018859863, 0.09091275930404663, 0.09280800074338913, 0.09036190062761307, 0.09107736498117447], [0.0701851099729538, 0.06932753324508667, 0.06070990860462189, 0.0676436796784401, 0.0802692398428917, 0.04870579019188881, 0.065194271504879, 0.07736265659332275, 0.3221110999584198, 0.05082228407263756, 0.08766834437847137], [0.09251872450113297, 0.092833012342453, 0.09629498422145844, 0.09346478432416916, 0.08915524184703827, 0.1023283526301384, 0.09442052245140076, 0.09006690979003906, 0.06076984107494354, 0.10113470256328583, 0.08701294660568237], [0.08995044976472855, 0.08983897417783737, 0.0886441320180893, 0.08961643278598785, 0.0911768302321434, 0.08669596165418625, 0.08928365260362625, 0.09083825349807739, 0.10489510744810104, 0.08706874400377274, 0.09199139475822449]]]}, "num_training_step_calls_per_iteration": 1, "evaluation": {"env_runners": {"module_to_env_connector": {"timers": {"connectors": {"remove_single_ts_time_rank_from_batch": 1.1857210768622738e-05, "get_actions": 3.75820014720102e-05, "normalize_and_clip_actions": 7.948041321128618e-06, "listify_data_for_vector_env": 1.0582487911781528e-05, "tensor_to_numpy": 1.542454782633395e-05, "un_batch_to_individual_items": 6.545439144548326e-06}}, "connector_pipeline_timer": 0.00011634423383908282}, "episode_len_max": 20, "num_agent_steps_sampled_lifetime": {"default_agent": 800}, "num_module_steps_sampled_lifetime": {"default_policy": 800}, "episode_return_max": 14.5, "env_reset_timer": 0.0005765167740173638, "rlmodule_inference_timer": 3.2761620317122504e-05, "env_step_timer": 1.4387617244260764e-05, "env_to_module_connector": {"timers": {"connectors": {"add_states_from_episodes_to_batch": 2.761864442454272e-06, "numpy_to_tensor": 1.1958775238012983e-05, "add_time_dim_to_batch_and_zero_pad": 7.321815030244906e-06, "add_observations_from_episodes_to_batch": 2.880689410873583e-06, "batch_individual_items": 1.2596946916234404e-05}}, "connector_pipeline_timer": 6.024695510478306e-05}, "episode_len_min": 20, "env_to_module_sum_episodes_length_out": 10.366003441359926, "env_to_module_sum_episodes_length_in": 10.366003441359926, "num_env_steps_sampled_lifetime": 10400, "num_agent_steps_sampled": {"default_agent": 400}, "weights_seq_no": 2.0, "module_episode_returns_mean": {"default_policy": 1.55}, "episode_len_mean": 20.0, "sample": 0.12671886073658242, "agent_episode_returns_mean": {"default_agent": 1.55}, "episode_return_mean": 1.55, "episode_return_min": -11.5, "num_episodes": 20, "episode_duration_sec_mean": 0.005596146866446361, "num_module_steps_sampled": {"default_policy": 400}, "num_episodes_lifetime": 40, "num_env_steps_sampled": 400, "time_between_sampling": 9.422971124993637}, "num_healthy_workers": 1, "actor_manager_num_outstanding_async_reqs": 0, "num_remote_worker_restarts": 0}, "num_env_steps_sampled_lifetime": 10000.0, "fault_tolerance": {"num_healthy_workers": 0, "num_remote_worker_restarts": 0}, "env_runner_group": {"actor_manager_num_outstanding_async_reqs": 0}, "done": false, "training_iteration": 2, "trial_id": "b9446_00000", "date": "2025-08-11_18-34-33", "timestamp": 1754930073, "time_this_iter_s": 9.506241083145142, "time_total_s": 19.883994102478027, "pid": 11415, "hostname": "Mac", "node_ip": "127.0.0.1", "config": {"exploration_config": {}, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 2, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "env": "Umbrella", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": false, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 0, "create_local_env_runner": true, "num_envs_per_env_runner": 1, "gym_env_vectorize_mode": "SYNC", "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "episodes_to_numpy": true, "max_requests_in_flight_per_env_runner": 1, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "merge_env_runner_states": "training_only", "broadcast_env_runner_states": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "complete_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "sampler_perf_stats_ema_coef": null, "_is_online": true, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": "auto", "num_aggregator_actors_per_learner": 0, "max_requests_in_flight_per_aggregator_actor": 3, "local_gpu_idx": 0, "max_requests_in_flight_per_learner": 3, "gamma": 1, "lr": 0.0002715581955, "grad_clip": 0.5, "grad_clip_by": "global_norm", "_train_batch_size_per_learner": 5000, "train_batch_size": 4000, "num_epochs": 1, "minibatch_size": 1000, "shuffle_batch_per_epoch": true, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "log_std_clip_param": 20.0, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "_disable_preprocessor_api": false, "_disable_action_flattening": false}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {"intrinsic_reward_coeff": 0.2795015916508}, "optimizer": {}, "_learner_class": "<class 'source.intrinsic_attention_ppo.learners.IntrinsicAttentionMetaLearner.IntrinsicAttentionMetaLearner'>", "callbacks_on_algorithm_init": null, "callbacks_on_env_runners_recreated": null, "callbacks_on_offline_eval_runners_recreated": null, "callbacks_on_checkpoint_loaded": null, "callbacks_on_environment_created": null, "callbacks_on_episode_created": null, "callbacks_on_episode_start": null, "callbacks_on_episode_step": null, "callbacks_on_episode_end": null, "callbacks_on_evaluate_start": null, "callbacks_on_evaluate_end": null, "callbacks_on_evaluate_offline_start": null, "callbacks_on_evaluate_offline_end": null, "callbacks_on_sample_end": null, "callbacks_on_train_result": null, "explore": true, "enable_rl_module_and_learner": true, "enable_env_runner_and_connector_v2": true, "_prior_exploration_config": {"type": "StochasticSampling"}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x3884998a0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "offline_data_class": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_read_batch_size": null, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "materialize_data": false, "materialize_mapped_data": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "ignore_final_observation": false, "prelearner_class": null, "prelearner_buffer_class": null, "prelearner_buffer_kwargs": {}, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_remaining_data": false, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": 1, "evaluation_duration": 20, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_auto_duration_min_env_steps_per_sample": 100, "evaluation_auto_duration_max_env_steps_per_sample": 2000, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 1, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "offline_evaluation_interval": null, "num_offline_eval_runners": 0, "offline_loss_for_module_fn": null, "offline_evaluation_duration": 1, "offline_evaluation_parallel_to_training": false, "offline_evaluation_timeout_s": 120.0, "num_cpus_per_offline_eval_runner": 1, "num_gpus_per_offline_eval_runner": 0, "custom_resources_per_offline_eval_runner": {}, "restart_failed_offline_eval_runners": true, "ignore_offline_eval_runner_failures": false, "max_num_offline_eval_runner_restarts": 1000, "offline_eval_runner_restore_timeout_s": 1800.0, "max_requests_in_flight_per_offline_eval_runner": 1, "validate_offline_eval_runners_after_construction": true, "offline_eval_runner_health_probe_timeout_s": 30.0, "offline_eval_rl_module_inference_only": false, "broadcast_offline_eval_runner_states": false, "offline_eval_batch_size_per_runner": 256, "dataset_num_iters_per_eval_runner": 1, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "log_gradients": false, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 7, "restart_failed_env_runners": true, "ignore_env_runner_failures": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30.0, "env_runner_restore_timeout_s": 1800.0, "_model_config": {}, "_rl_module_spec": "MultiRLModuleSpec(multi_rl_module_class=<class 'ray.rllib.core.rl_module.multi_rl_module.MultiRLModule'>, observation_space=None, action_space=None, inference_only=False, model_config=None, rl_module_specs={'default_policy': RLModuleSpec(module_class=<class 'source.intrinsic_attention_ppo.rl_modules.DifferentiablePPOModule.DifferentiablePPOModule'>, observation_space=None, action_space=None, inference_only=False, learner_only=False, model_config={'vf_share_layers': True, 'embedding_dim': 62, 'max_seq_len': 11, 'policy_head_hidden_sizes': [32], 'value_head_hidden_sizes': [101], 'embedding_hidden_sizes': [121]}, catalog_class=None, load_state_path=None, model_config_dict=None), 'intrinsic_reward_module': RLModuleSpec(module_class=<class 'source.intrinsic_attention_ppo.rl_modules.IntrinsicAttentionModule.IntrinsicAttentionModule'>, observation_space=None, action_space=None, inference_only=False, learner_only=True, model_config={'intrinsic_reward_network': {'encoder_hidden_sizes': [], 'encoding_dim': 1, 'num_heads': 1, 'head_hidden_sizes': None, 'layers': [{'type': 'attention'}]}, 'extrinsic_value_hidden_layers': [127, 60], 'vf_share_layers': True, 'max_seq_len': 11}, catalog_class=None, load_state_path=None, model_config_dict=None)}, load_state_path=None, modules_to_load=None, module_specs={'default_policy': RLModuleSpec(module_class=<class 'source.intrinsic_attention_ppo.rl_modules.DifferentiablePPOModule.DifferentiablePPOModule'>, observation_space=None, action_space=None, inference_only=False, learner_only=False, model_config={'vf_share_layers': True, 'embedding_dim': 62, 'max_seq_len': 11, 'policy_head_hidden_sizes': [32], 'value_head_hidden_sizes': [101], 'embedding_hidden_sizes': [121]}, catalog_class=None, load_state_path=None, model_config_dict=None), 'intrinsic_reward_module': RLModuleSpec(module_class=<class 'source.intrinsic_attention_ppo.rl_modules.IntrinsicAttentionModule.IntrinsicAttentionModule'>, observation_space=None, action_space=None, inference_only=False, learner_only=True, model_config={'intrinsic_reward_network': {'encoder_hidden_sizes': [], 'encoding_dim': 1, 'num_heads': 1, 'head_hidden_sizes': None, 'layers': [{'type': 'attention'}]}, 'extrinsic_value_hidden_layers': [127, 60], 'vf_share_layers': True, 'max_seq_len': 11}, catalog_class=None, load_state_path=None, model_config_dict=None)})", "algorithm_config_overrides_per_module": {"intrinsic_reward_module": {"lr": 0.0002715581955}}, "_per_module_overrides": {}, "_validate_config": true, "_use_msgpack_checkpoints": false, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "env_task_fn": -1, "enable_connectors": -1, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.161583927863, "kl_target": 0.0201019014258, "vf_loss_coeff": 0.7790510010087, "entropy_coeff": 0.0015431216992, "clip_param": 0.2459212356676, "vf_clip_param": 0.3769744131561, "entropy_coeff_schedule": null, "lr_schedule": null, "sgd_minibatch_size": -1, "vf_share_layers": -1, "differentiable_learner_configs": ["DifferentiableLearnerConfig(learner_class=<class 'source.intrinsic_attention_ppo.learners.IntrinsicAttentionPPOLearner.IntrinsicAttentionPPOLearner'>, learner_connector=None, add_default_connectors_to_learner_pipeline=True, is_multi_agent=False, policies_to_update=['default_policy'], lr=0.0060984166342, num_total_minibatches=0, num_epochs=1, minibatch_size=1000, shuffle_batch_per_epoch=True)"], "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9485408017724, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.callbacks.callbacks.RLlibCallback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 19.883994102478027, "iterations_since_restore": 2, "perf": {"cpu_util_percent": 42.23571428571429, "ram_util_percent": 79.64285714285714}}
{"timers": {"training_iteration": 10.218814191398874, "restore_env_runners": 1.281337757827714e-05, "training_step": 10.218611229778244, "env_runner_sampling_timer": 2.591287186277669, "learner_update_timer": 7.376883010679879, "synch_weights": 0.0017900131216621957, "restore_eval_env_runners": 4.546350333839655e-05, "evaluation_iteration": 0.13851210497436114, "synch_eval_env_connectors": 0.0001844926958438009, "synch_env_connectors": 4.749977961182594e-06}, "env_runners": {"env_reset_timer": 4.743840028009371e-05, "num_episodes_lifetime": -30375.0, "num_env_steps_sampled_lifetime": -607500.0, "num_env_steps_sampled": 5000.0, "module_to_env_connector": {"timers": {"connectors": {"remove_single_ts_time_rank_from_batch": 1.2347856015497906e-05, "get_actions": 4.228362759086684e-05, "listify_data_for_vector_env": 1.1015418815358117e-05, "tensor_to_numpy": 1.611935106573915e-05, "un_batch_to_individual_items": 6.7900598252198456e-06, "normalize_and_clip_actions": 8.422441332240931e-06}}, "connector_pipeline_timer": 0.00012411235163021744}, "module_episode_returns_mean": {"default_policy": -1.1800000000000002}, "time_between_sampling": 0.03149086639870456, "rlmodule_inference_timer": 3.3423671442847924e-05, "env_step_timer": 1.4792902712322341e-05, "env_to_module_connector": {"timers": {"connectors": {"batch_individual_items": 1.3083760667843085e-05, "add_observations_from_episodes_to_batch": 3.0076692592213174e-06, "add_states_from_episodes_to_batch": 2.786819354300232e-06, "numpy_to_tensor": 1.3271309915196928e-05, "add_time_dim_to_batch_and_zero_pad": 7.881684868831298e-06}}, "connector_pipeline_timer": 6.549765023257602e-05}, "weights_seq_no": 2.0, "num_agent_steps_sampled": {"default_agent": 5000.0}, "episode_len_min": 20, "episode_len_mean": 20.0, "num_episodes": 250.0, "sample": 0.006421604866485123, "episode_duration_sec_mean": 0.005608492636587471, "episode_len_max": 20, "num_module_steps_sampled": {"default_policy": 5000.0}, "num_agent_steps_sampled_lifetime": {"default_agent": -607500.0}, "num_module_steps_sampled_lifetime": {"default_policy": -607500.0}, "env_to_module_sum_episodes_length_out": 10.36823839457432, "agent_episode_returns_mean": {"default_agent": -1.1800000000000002}, "episode_return_max": 10.5, "episode_return_min": -9.5, "env_to_module_sum_episodes_length_in": 10.36823839457432, "episode_return_mean": -1.1800000000000002, "num_env_steps_sampled_lifetime_throughput": 3146.345711294698}, "__all_modules__": {"learner_connector_sum_episodes_length_in": 5000.0, "learner_connector": {"connector_pipeline_timer": 0.2090261061080964, "timers": {"connectors": {"add_one_ts_to_episodes_and_truncate": 0.00905044803014025, "add_observations_from_episodes_to_batch": 0.0009623950870707631, "add_columns_from_episodes_to_train_batch": 0.10086676315555813, "add_time_dim_to_batch_and_zero_pad": 0.0880808271500282, "add_states_from_episodes_to_batch": 0.0035941176798893137, "batch_individual_items": 0.006182259215740487, "numpy_to_tensor": 8.769520033383743e-05}}}, "learner_connector_sum_episodes_length_out": 5250.0}, "learners": {"differentiable_learners": {"intrinsic_attention_ppo_learner": {"intrinsic_reward_module": {"num_module_steps_trained_lifetime": 107730, "weights_seq_no": 18.0, "total_loss": 0.0, "num_module_steps_trained": 35910, "diff_num_grad_updates_vs_sampler_policy": 16.0, "module_train_batch_size_mean": 997.6672132667843}, "default_policy": {"module_train_batch_size_mean": 997.6672132667843, "use_intrinsic_rewards": 1.0, "num_module_steps_trained_lifetime": 107730, "policy_loss": -0.0005016231443732977, "mean_kl_loss": 3.4145872632507235e-05, "entropy": 0.6895043253898621, "weights_seq_no": 18.0, "vf_loss_unclipped": 46.07600784301758, "vf_loss": 0.35847315192222595, "total_loss": 0.2777087390422821, "vf_explained_var": -0.0023789405822753906, "num_module_steps_trained": 35910, "diff_num_grad_updates_vs_sampler_policy": 16.0}, "__all_modules__": {"num_env_steps_trained_lifetime": 594000, "num_module_steps_trained": 71820, "num_module_steps_trained_lifetime": 215460, "num_env_steps_trained": 198000, "num_env_steps_trained_lifetime_throughput": 57158.99805482823}}}, "intrinsic_reward_module": {"num_module_steps_trained": 5985, "curr_entropy_coeff": 0.0015431216992, "total_loss": 0.0, "num_module_steps_trained_lifetime": 17955, "gradients_default_optimizer_global_norm": 0.0, "diff_num_grad_updates_vs_sampler_policy": 1.0, "module_train_batch_size_mean": 997.9168410861561, "default_optimizer_learning_rate": 0.0002715581955, "num_trainable_parameters": 8266, "weights_seq_no": 3.0, "num_module_steps_trained_lifetime_throughput": 829.7693281120811}, "__all_modules__": {"num_trainable_parameters": 24861, "num_non_trainable_parameters": 0, "num_env_steps_trained_lifetime": 99000, "num_module_steps_trained": 11970, "num_module_steps_trained_lifetime": 35910, "num_env_steps_trained": 33000, "num_env_steps_trained_lifetime_throughput": 4577.021728697746, "num_module_steps_trained_throughput": 31719610.713755567, "num_module_steps_trained_lifetime_throughput": 13541871.658406671}, "default_policy": {"vf_loss": 0.3583526909351349, "weights_seq_no": 3.0, "curr_entropy_coeff": 0.0015431216992, "vf_loss_unclipped": 45.706703186035156, "total_loss": 0.2775900959968567, "vf_explained_var": -0.0002777576446533203, "num_module_steps_trained": 5985, "diff_num_grad_updates_vs_sampler_policy": 1.0, "curr_kl_coeff": 0.020197991281747818, "use_intrinsic_rewards": 0.0, "module_train_batch_size_mean": 997.9168410861561, "num_module_steps_trained_lifetime": 17955, "policy_loss": -0.0005223595071583986, "num_trainable_parameters": 16595, "mean_kl_loss": 3.664157702587545e-05, "entropy": 0.6895296573638916, "num_module_steps_trained_lifetime_throughput": 829.7501520405108}, "IntrinsicAttentionMask": [[[0.09183073788881302, 0.0937022715806961, 0.09350966662168503, 0.09331746399402618, 0.09312565624713898, 0.08565580099821091, 0.08993936330080032, 0.08975449204444885, 0.08957000821828842, 0.09217249602079391, 0.08742208778858185], [0.09226573258638382, 0.0950961634516716, 0.0948035717010498, 0.09451187402009964, 0.0942210853099823, 0.08313123136758804, 0.08943430334329605, 0.08915913105010986, 0.08888480067253113, 0.0927804708480835, 0.08571168035268784], [0.09222209453582764, 0.09495390951633453, 0.09467164427042007, 0.09439020603895187, 0.09410961717367172, 0.08338599652051926, 0.08948647975921631, 0.08922046422958374, 0.08895523101091385, 0.09271910786628723, 0.08588533848524094], [0.09217828512191772, 0.09481167048215866, 0.09453970193862915, 0.09426850080490112, 0.09399808943271637, 0.08364136517047882, 0.08953849971294403, 0.08928164839744568, 0.08902553468942642, 0.09265759587287903, 0.08605916798114777], [0.09213431924581528, 0.09466945379972458, 0.09440775215625763, 0.09414675831794739, 0.09388650208711624, 0.08389735221862793, 0.08959037065505981, 0.08934269845485687, 0.08909571170806885, 0.09259594231843948, 0.08623317629098892], [0.09020937234163284, 0.08891370892524719, 0.08904498815536499, 0.0891764685511589, 0.08930813521146774, 0.09482642263174057, 0.09156566858291626, 0.09170086681842804, 0.09183625876903534, 0.08996940404176712, 0.09344865381717682], [0.0913655236363411, 0.0922669917345047, 0.09217464923858643, 0.09208239614963531, 0.09199024736881256, 0.08832229673862457, 0.09044485539197922, 0.09035433828830719, 0.09026391059160233, 0.09153083711862564, 0.08920396864414215], [0.09131862223148346, 0.09212524443864822, 0.09204265475273132, 0.09196014702320099, 0.09187769889831543, 0.0885893926024437, 0.09049396216869354, 0.09041283279657364, 0.0903317853808403, 0.09146660566329956, 0.08938108384609222], [0.0912715494632721, 0.09198351949453354, 0.09191065281629562, 0.09183785319328308, 0.09176509827375412, 0.08885709941387177, 0.09054289758205414, 0.09047117829322815, 0.09039951115846634, 0.09140222519636154, 0.08955837041139603], [0.09191200882196426, 0.09395873546600342, 0.09374792873859406, 0.0935375988483429, 0.09332773834466934, 0.08518651872873306, 0.08984746038913727, 0.0896458774805069, 0.08944474905729294, 0.09228547662496567, 0.0871058851480484], [0.090704046189785, 0.09031403064727783, 0.09035371989011765, 0.09039343893527985, 0.09043317288160324, 0.09206269681453705, 0.09110812842845917, 0.09114817529916763, 0.09118824452161789, 0.0906321108341217, 0.0916622206568718]], [[0.09131141752004623, 0.0868709608912468, 0.08436598628759384, 0.0872369334101677, 0.08923936635255814, 0.08760444074869156, 0.09247033298015594, 0.08980388939380646, 0.11875615268945694, 0.08696963638067245, 0.08537090569734573], [0.09075594693422318, 0.09156612306833267, 0.09204500168561935, 0.0914975255727768, 0.09112808108329773, 0.0914289727807045, 0.09055211395025253, 0.0910256952047348, 0.08660207688808441, 0.09154759347438812, 0.0918508991599083], [0.0899619534611702, 0.09394881129264832, 0.09637059271335602, 0.0936058908700943, 0.09177617728710175, 0.09326421469449997, 0.08898043632507324, 0.09127414226531982, 0.07157863676548004, 0.0938560888171196, 0.09538308531045914], [0.09084408730268478, 0.09120216965675354, 0.0914129912853241, 0.09117191284894943, 0.09100878238677979, 0.09114167839288712, 0.0907537192106247, 0.09096351265907288, 0.088979572057724, 0.09119399636983871, 0.09132761508226395], [0.09119415283203125, 0.08913787454366684, 0.08795265108346939, 0.08930947631597519, 0.09024154394865036, 0.0894813984632492, 0.09172184020280838, 0.09050225466489792, 0.1028442308306694, 0.08918417990207672, 0.08843038976192474], [0.0909252017736435, 0.09083255380392075, 0.09077820926904678, 0.09084036201238632, 0.09088253229856491, 0.0908481702208519, 0.0909486636519432, 0.09089425206184387, 0.09141518920660019, 0.09083466231822968, 0.0908001959323883], [0.09126383811235428, 0.08554496616125107, 0.0823567658662796, 0.0860130786895752, 0.08858466893434525, 0.08648374676704407, 0.09277025610208511, 0.08931277692317963, 0.12836629152297974, 0.08567111939191818, 0.0836324393749237], [0.09125132858753204, 0.08853349089622498, 0.08697617053985596, 0.08875953406095505, 0.08998972922563553, 0.08898613601922989, 0.09195203334093094, 0.09033458679914474, 0.10701946914196014, 0.0885944738984108, 0.08760308474302292], [0.06883908808231354, 0.048051491379737854, 0.03891086205840111, 0.049530528485774994, 0.05833757668733597, 0.05105510726571083, 0.07539345324039459, 0.06105169281363487, 0.4580042362213135, 0.04844645783305168, 0.04237944632768631], [0.09078042954206467, 0.09146840125322342, 0.0918746143579483, 0.09141018241643906, 0.09109655022621155, 0.09135200083255768, 0.09060720354318619, 0.09100959450006485, 0.08723840117454529, 0.09145267307758331, 0.09171000868082047], [0.09031963348388672, 0.09301547706127167, 0.09463506191968918, 0.0927850604057312, 0.0915510430932045, 0.0925552248954773, 0.08965008705854416, 0.09121107310056686, 0.07734791189432144, 0.09295319765806198, 0.09397625923156738]], [[0.09310231357812881, 0.09028922021389008, 0.09480448812246323, 0.09460961818695068, 0.09441515803337097, 0.09137255698442459, 0.0866633728146553, 0.08648524433374405, 0.09081027656793594, 0.08881517499685287, 0.08863261342048645], [0.09144637733697891, 0.09076658636331558, 0.09185019880533218, 0.09180425107479095, 0.09175832569599152, 0.09103025496006012, 0.08986633270978928, 0.08982137590646744, 0.0908937007188797, 0.0904039591550827, 0.09035873413085938], [0.09406812489032745, 0.08998354524374008, 0.09656670689582825, 0.09627964347600937, 0.09599342942237854, 0.09154991060495377, 0.08480231463909149, 0.08455022424459457, 0.09073587507009506, 0.08786573261022568, 0.08760453015565872], [0.09395890682935715, 0.09001913666725159, 0.09636592864990234, 0.09608949720859528, 0.09581385552883148, 0.0915306881070137, 0.0850125104188919, 0.08476864546537399, 0.09074525535106659, 0.0879739448428154, 0.08772158622741699], [0.09384957700967789, 0.09005451202392578, 0.09616532921791077, 0.09589949250221252, 0.09563437849283218, 0.09151124209165573, 0.08522301912307739, 0.08498742431402206, 0.09075441211462021, 0.08808207511901855, 0.08783857524394989], [0.09209305793046951, 0.0905870795249939, 0.09299410134553909, 0.09289132803678513, 0.09278867393732071, 0.091169573366642, 0.0886135920882225, 0.08851566165685654, 0.09086763858795166, 0.08978927880525589, 0.08969005197286606], [0.0891975685954094, 0.09132376313209534, 0.08796532452106476, 0.08810440450906754, 0.08824370056390762, 0.09049125760793686, 0.09424345195293427, 0.09439245611429214, 0.09092115610837936, 0.09248530864715576, 0.09263153374195099], [0.08908366411924362, 0.0913492888212204, 0.08777224272489548, 0.08792020380496979, 0.0880684033036232, 0.09046176075935364, 0.09446609020233154, 0.0946253314614296, 0.09092000871896744, 0.09258846938610077, 0.09274454414844513], [0.09175882488489151, 0.09068094193935394, 0.09240134805440903, 0.09232815355062485, 0.09225501865148544, 0.09109845757484436, 0.08926072716712952, 0.08919002115726471, 0.09088213741779327, 0.09010788053274155, 0.09003649652004242], [0.09054801613092422, 0.09100151807069778, 0.09028127789497375, 0.09031152725219727, 0.09034179896116257, 0.09082495421171188, 0.09161090105772018, 0.09164159744977951, 0.09091629087924957, 0.09124576300382614, 0.09127634018659592], [0.09043526649475098, 0.09102983772754669, 0.09008598327636719, 0.09012558311223984, 0.09016519784927368, 0.09079824388027191, 0.09183023869991302, 0.09187060594558716, 0.09091802686452866, 0.09135045111179352, 0.09139060229063034]], [[0.09074244648218155, 0.08632965385913849, 0.08831126242876053, 0.08669334650039673, 0.08419348299503326, 0.08705857396125793, 0.0872417613863945, 0.0892443135380745, 0.12430965155363083, 0.09103667736053467, 0.08483894914388657], [0.09082864969968796, 0.09163947403430939, 0.09126946330070496, 0.09157082438468933, 0.0920497253537178, 0.09150221943855286, 0.09146793186664581, 0.0910986140370369, 0.08587240427732468, 0.0907762423157692, 0.09192448109388351], [0.09097567945718765, 0.0893658995628357, 0.0900951698422432, 0.0895005464553833, 0.08856761455535889, 0.08963539451360703, 0.08970289677381516, 0.09043490886688232, 0.10183058679103851, 0.09108120203018188, 0.08881018310785294], [0.09087721258401871, 0.09123542159795761, 0.09107217192649841, 0.0912051573395729, 0.09141598641872406, 0.0911749005317688, 0.09115978330373764, 0.09099667519330978, 0.08864784240722656, 0.09085400402545929, 0.0913609117269516], [0.0903586745262146, 0.09389683604240417, 0.09226927161216736, 0.09359319508075714, 0.0957270935177803, 0.0932905301451683, 0.09313955903053284, 0.0915251225233078, 0.07090067863464355, 0.09013358503580093, 0.09516546875238419], [0.09091637283563614, 0.09082372486591339, 0.09086588770151138, 0.09083153307437897, 0.0907772034406662, 0.09083934128284454, 0.09084324538707733, 0.09088542312383652, 0.09150348603725433, 0.09092239290475845, 0.09079137444496155], [0.09093234688043594, 0.09061498194932938, 0.09075932204723358, 0.09064169973134995, 0.09045588970184326, 0.09066843241453171, 0.09068179875612259, 0.09082624316215515, 0.09296193718910217, 0.09095299988985062, 0.09050435572862625], [0.09094187617301941, 0.08823325484991074, 0.08945617079734802, 0.08845852315425873, 0.08690252155065536, 0.08868436515331268, 0.08879750967025757, 0.09002824127674103, 0.11007098108530045, 0.09112061560153961, 0.08730600029230118], [0.045887917280197144, 0.030128974467515945, 0.03648905083537102, 0.031217094510793686, 0.024386676028370857, 0.0323445163667202, 0.03292340412735939, 0.03987337276339531, 0.6535798907279968, 0.04715884104371071, 0.026010198518633842], [0.09068166464567184, 0.08594339340925217, 0.08806893229484558, 0.08633322268724442, 0.08365625888109207, 0.08672481775283813, 0.08692128211259842, 0.08907100558280945, 0.12725436687469482, 0.09099823236465454, 0.08434687554836273], [0.0905330553650856, 0.09323526918888092, 0.09199526160955429, 0.09300431609153748, 0.09462370723485947, 0.0927739292383194, 0.09265895187854767, 0.09142661094665527, 0.07519033551216125, 0.09036032110452652, 0.0941983237862587]], [[0.09441592544317245, 0.0915631502866745, 0.0913749411702156, 0.09594450145959854, 0.09099969267845154, 0.08806715905666351, 0.08788613975048065, 0.08770549297332764, 0.09209154546260834, 0.09006829559803009, 0.08988316357135773], [0.09175612777471542, 0.09107403457164764, 0.09102846682071686, 0.09211520850658417, 0.09093741327524185, 0.09021586179733276, 0.0901707261800766, 0.09012562036514282, 0.09120157361030579, 0.09071017801761627, 0.09066479653120041], [0.09157904237508774, 0.09103991836309433, 0.09100387990474701, 0.0918625220656395, 0.09093183279037476, 0.09036042541265488, 0.09032465517520905, 0.09028889238834381, 0.09114079177379608, 0.09075198322534561, 0.09071605652570724], [0.09582225233316422, 0.09180435538291931, 0.09154099971055984, 0.0979950949549675, 0.09101656824350357, 0.08694785088300705, 0.08669844269752502, 0.08644973486661911, 0.09254486858844757, 0.08971859514713287, 0.08946122974157333], [0.09122536331415176, 0.0909712016582489, 0.09095417708158493, 0.09135869145393372, 0.09092015027999878, 0.09064972400665283, 0.09063276648521423, 0.09061580896377563, 0.09101881831884384, 0.09083513170480728, 0.0908181369304657], [0.08843410760164261, 0.09040123224258423, 0.09053470939397812, 0.08742152899503708, 0.09080225974321365, 0.09296029806137085, 0.09309756010770798, 0.09323501586914062, 0.09002898633480072, 0.09147458523511887, 0.0916096493601799], [0.0882602259516716, 0.09036408364772797, 0.09050695598125458, 0.0871785506606102, 0.09079338610172272, 0.09310588240623474, 0.09325309097766876, 0.09340053051710129, 0.08996570855379105, 0.09151341766119003, 0.0916581079363823], [0.08808652311563492, 0.09032677859067917, 0.0904790461063385, 0.08693607896566391, 0.09078434109687805, 0.09325151145458221, 0.09340870380401611, 0.0935661643743515, 0.08990231156349182, 0.09155210107564926, 0.09170642495155334], [0.09225223958492279, 0.09116856753826141, 0.09109634906053543, 0.09282463043928146, 0.0909520834684372, 0.08981186151504517, 0.08974071592092514, 0.08966962993144989, 0.0913708433508873, 0.09059242159128189, 0.09052065759897232], [0.09034408628940582, 0.0907965674996376, 0.09082698822021484, 0.09010812640190125, 0.0908878743648529, 0.09137395769357681, 0.09140457212924957, 0.09143520146608353, 0.09071152657270432, 0.09104026108980179, 0.09107077121734619], [0.09016833454370499, 0.09076115489006042, 0.09080105274915695, 0.08985956758260727, 0.09088090062141418, 0.09151896834373474, 0.09155919402837753, 0.09159944206476212, 0.09064967185258865, 0.09108081459999084, 0.09112085402011871]], [[0.09144934266805649, 0.09150873869657516, 0.092152439057827, 0.0931098610162735, 0.09080328792333603, 0.09174669533967972, 0.09329139441251755, 0.09098032116889954, 0.08303554356098175, 0.09154082834720612, 0.0903814509510994], [0.09152926504611969, 0.091598279774189, 0.0923466756939888, 0.09346136450767517, 0.09077906608581543, 0.09187483787536621, 0.09367292374372482, 0.09098455309867859, 0.08182786405086517, 0.0916355699300766, 0.09028968960046768], [0.0922752171754837, 0.09244896471500397, 0.09434583783149719, 0.09721405804157257, 0.09039901942014694, 0.09314724057912827, 0.09776423871517181, 0.09091062843799591, 0.06976427137851715, 0.09254293888807297, 0.08918754756450653], [0.093018539249897, 0.09334874898195267, 0.09698948264122009, 0.10261846333742142, 0.08948776870965958, 0.09468137472867966, 0.10371522605419159, 0.09044419974088669, 0.05492653697729111, 0.09352757781744003, 0.08724202960729599], [0.09044886380434036, 0.0904044508934021, 0.0899263545870781, 0.08922600001096725, 0.09093524515628815, 0.09022703021764755, 0.0890946313738823, 0.09080135822296143, 0.09729953110218048, 0.0903804823756218, 0.09125611931085587], [0.09183015674352646, 0.09193779528141022, 0.0931079313158989, 0.09486055374145508, 0.09066299349069595, 0.09236958622932434, 0.0951944962143898, 0.09098215401172638, 0.07715386897325516, 0.091995969414711, 0.08990448713302612], [0.09311562031507492, 0.09347546100616455, 0.09745019674301147, 0.10362144559621811, 0.08927522599697113, 0.09492877125740051, 0.1048274114727974, 0.09031423181295395, 0.052481792867183685, 0.09367036819458008, 0.08683948218822479], [0.09074769914150238, 0.09073156118392944, 0.0905575305223465, 0.0903015211224556, 0.09092409163713455, 0.09066704660654068, 0.09025335311889648, 0.09087559580802917, 0.09317869693040848, 0.09072284400463104, 0.09104012697935104], [0.05329500138759613, 0.05250807851552963, 0.044717468321323395, 0.035288307815790176, 0.06269481778144836, 0.04947493225336075, 0.03374816104769707, 0.05995851755142212, 0.4864733815193176, 0.05208795890212059, 0.06975335627794266], [0.0915716215968132, 0.09164582937955856, 0.09245089441537857, 0.09365089237689972, 0.09076515585184097, 0.09194327145814896, 0.09387876093387604, 0.09098600596189499, 0.08118223398923874, 0.0916859358549118, 0.09023934602737427], [0.08965699374675751, 0.08954587578773499, 0.08835494518280029, 0.08662771433591843, 0.09087937325239182, 0.08910278975963593, 0.08630602061748505, 0.09054189175367355, 0.10780715942382812, 0.08948592096567154, 0.0916912704706192]]]}, "num_training_step_calls_per_iteration": 1, "evaluation": {"env_runners": {"module_to_env_connector": {"timers": {"connectors": {"remove_single_ts_time_rank_from_batch": 1.1709461398664983e-05, "get_actions": 3.46981950328926e-05, "normalize_and_clip_actions": 7.846347188297059e-06, "listify_data_for_vector_env": 1.0347475321307194e-05, "tensor_to_numpy": 1.4610786807096139e-05, "un_batch_to_individual_items": 6.460462141721929e-06}}, "connector_pipeline_timer": 0.00011183662955721692}, "episode_len_max": 20, "num_agent_steps_sampled_lifetime": {"default_agent": 1200}, "num_module_steps_sampled_lifetime": {"default_policy": 1200}, "episode_return_max": 14.5, "env_reset_timer": 0.0005720541051356121, "rlmodule_inference_timer": 3.0282345364491233e-05, "env_step_timer": 1.3743793882499795e-05, "env_to_module_connector": {"timers": {"connectors": {"add_states_from_episodes_to_batch": 2.675503043893172e-06, "numpy_to_tensor": 1.1581050738319902e-05, "add_time_dim_to_batch_and_zero_pad": 6.938479917060972e-06, "add_observations_from_episodes_to_batch": 2.7922120916820555e-06, "batch_individual_items": 1.2171768320408888e-05}}, "connector_pipeline_timer": 5.8371451964499125e-05}, "episode_len_min": 20, "env_to_module_sum_episodes_length_out": 10.368205581254823, "env_to_module_sum_episodes_length_in": 10.368205581254823, "num_env_steps_sampled_lifetime": 15400, "num_agent_steps_sampled": {"default_agent": 400}, "weights_seq_no": 3.0, "module_episode_returns_mean": {"default_policy": 1.05}, "episode_len_mean": 20.0, "sample": 0.1265665996292373, "agent_episode_returns_mean": {"default_agent": 1.05}, "episode_return_mean": 1.05, "episode_return_min": -11.5, "num_episodes": 20, "episode_duration_sec_mean": 0.005437313222015897, "num_module_steps_sampled": {"default_policy": 400}, "num_episodes_lifetime": 60, "num_env_steps_sampled": 400, "time_between_sampling": 9.422292159993669}, "num_healthy_workers": 1, "actor_manager_num_outstanding_async_reqs": 0, "num_remote_worker_restarts": 0}, "num_env_steps_sampled_lifetime": -607500.0, "fault_tolerance": {"num_healthy_workers": 0, "num_remote_worker_restarts": 0}, "env_runner_group": {"actor_manager_num_outstanding_async_reqs": 0}, "done": false, "training_iteration": 3, "trial_id": "b9446_00000", "date": "2025-08-11_18-34-42", "timestamp": 1754930082, "time_this_iter_s": 9.445973873138428, "time_total_s": 29.329967975616455, "pid": 11415, "hostname": "Mac", "node_ip": "127.0.0.1", "config": {"exploration_config": {}, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 2, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "env": "Umbrella", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": false, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 0, "create_local_env_runner": true, "num_envs_per_env_runner": 1, "gym_env_vectorize_mode": "SYNC", "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "episodes_to_numpy": true, "max_requests_in_flight_per_env_runner": 1, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "merge_env_runner_states": "training_only", "broadcast_env_runner_states": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "complete_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "sampler_perf_stats_ema_coef": null, "_is_online": true, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": "auto", "num_aggregator_actors_per_learner": 0, "max_requests_in_flight_per_aggregator_actor": 3, "local_gpu_idx": 0, "max_requests_in_flight_per_learner": 3, "gamma": 1, "lr": 0.0002715581955, "grad_clip": 0.5, "grad_clip_by": "global_norm", "_train_batch_size_per_learner": 5000, "train_batch_size": 4000, "num_epochs": 1, "minibatch_size": 1000, "shuffle_batch_per_epoch": true, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "log_std_clip_param": 20.0, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "_disable_preprocessor_api": false, "_disable_action_flattening": false}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {"intrinsic_reward_coeff": 0.2795015916508}, "optimizer": {}, "_learner_class": "<class 'source.intrinsic_attention_ppo.learners.IntrinsicAttentionMetaLearner.IntrinsicAttentionMetaLearner'>", "callbacks_on_algorithm_init": null, "callbacks_on_env_runners_recreated": null, "callbacks_on_offline_eval_runners_recreated": null, "callbacks_on_checkpoint_loaded": null, "callbacks_on_environment_created": null, "callbacks_on_episode_created": null, "callbacks_on_episode_start": null, "callbacks_on_episode_step": null, "callbacks_on_episode_end": null, "callbacks_on_evaluate_start": null, "callbacks_on_evaluate_end": null, "callbacks_on_evaluate_offline_start": null, "callbacks_on_evaluate_offline_end": null, "callbacks_on_sample_end": null, "callbacks_on_train_result": null, "explore": true, "enable_rl_module_and_learner": true, "enable_env_runner_and_connector_v2": true, "_prior_exploration_config": {"type": "StochasticSampling"}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x3884998a0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "offline_data_class": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_read_batch_size": null, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "materialize_data": false, "materialize_mapped_data": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "ignore_final_observation": false, "prelearner_class": null, "prelearner_buffer_class": null, "prelearner_buffer_kwargs": {}, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_remaining_data": false, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": 1, "evaluation_duration": 20, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_auto_duration_min_env_steps_per_sample": 100, "evaluation_auto_duration_max_env_steps_per_sample": 2000, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 1, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "offline_evaluation_interval": null, "num_offline_eval_runners": 0, "offline_loss_for_module_fn": null, "offline_evaluation_duration": 1, "offline_evaluation_parallel_to_training": false, "offline_evaluation_timeout_s": 120.0, "num_cpus_per_offline_eval_runner": 1, "num_gpus_per_offline_eval_runner": 0, "custom_resources_per_offline_eval_runner": {}, "restart_failed_offline_eval_runners": true, "ignore_offline_eval_runner_failures": false, "max_num_offline_eval_runner_restarts": 1000, "offline_eval_runner_restore_timeout_s": 1800.0, "max_requests_in_flight_per_offline_eval_runner": 1, "validate_offline_eval_runners_after_construction": true, "offline_eval_runner_health_probe_timeout_s": 30.0, "offline_eval_rl_module_inference_only": false, "broadcast_offline_eval_runner_states": false, "offline_eval_batch_size_per_runner": 256, "dataset_num_iters_per_eval_runner": 1, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "log_gradients": false, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 7, "restart_failed_env_runners": true, "ignore_env_runner_failures": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30.0, "env_runner_restore_timeout_s": 1800.0, "_model_config": {}, "_rl_module_spec": "MultiRLModuleSpec(multi_rl_module_class=<class 'ray.rllib.core.rl_module.multi_rl_module.MultiRLModule'>, observation_space=None, action_space=None, inference_only=False, model_config=None, rl_module_specs={'default_policy': RLModuleSpec(module_class=<class 'source.intrinsic_attention_ppo.rl_modules.DifferentiablePPOModule.DifferentiablePPOModule'>, observation_space=None, action_space=None, inference_only=False, learner_only=False, model_config={'vf_share_layers': True, 'embedding_dim': 62, 'max_seq_len': 11, 'policy_head_hidden_sizes': [32], 'value_head_hidden_sizes': [101], 'embedding_hidden_sizes': [121]}, catalog_class=None, load_state_path=None, model_config_dict=None), 'intrinsic_reward_module': RLModuleSpec(module_class=<class 'source.intrinsic_attention_ppo.rl_modules.IntrinsicAttentionModule.IntrinsicAttentionModule'>, observation_space=None, action_space=None, inference_only=False, learner_only=True, model_config={'intrinsic_reward_network': {'encoder_hidden_sizes': [], 'encoding_dim': 1, 'num_heads': 1, 'head_hidden_sizes': None, 'layers': [{'type': 'attention'}]}, 'extrinsic_value_hidden_layers': [127, 60], 'vf_share_layers': True, 'max_seq_len': 11}, catalog_class=None, load_state_path=None, model_config_dict=None)}, load_state_path=None, modules_to_load=None, module_specs={'default_policy': RLModuleSpec(module_class=<class 'source.intrinsic_attention_ppo.rl_modules.DifferentiablePPOModule.DifferentiablePPOModule'>, observation_space=None, action_space=None, inference_only=False, learner_only=False, model_config={'vf_share_layers': True, 'embedding_dim': 62, 'max_seq_len': 11, 'policy_head_hidden_sizes': [32], 'value_head_hidden_sizes': [101], 'embedding_hidden_sizes': [121]}, catalog_class=None, load_state_path=None, model_config_dict=None), 'intrinsic_reward_module': RLModuleSpec(module_class=<class 'source.intrinsic_attention_ppo.rl_modules.IntrinsicAttentionModule.IntrinsicAttentionModule'>, observation_space=None, action_space=None, inference_only=False, learner_only=True, model_config={'intrinsic_reward_network': {'encoder_hidden_sizes': [], 'encoding_dim': 1, 'num_heads': 1, 'head_hidden_sizes': None, 'layers': [{'type': 'attention'}]}, 'extrinsic_value_hidden_layers': [127, 60], 'vf_share_layers': True, 'max_seq_len': 11}, catalog_class=None, load_state_path=None, model_config_dict=None)})", "algorithm_config_overrides_per_module": {"intrinsic_reward_module": {"lr": 0.0002715581955}}, "_per_module_overrides": {}, "_validate_config": true, "_use_msgpack_checkpoints": false, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "env_task_fn": -1, "enable_connectors": -1, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.161583927863, "kl_target": 0.0201019014258, "vf_loss_coeff": 0.7790510010087, "entropy_coeff": 0.0015431216992, "clip_param": 0.2459212356676, "vf_clip_param": 0.3769744131561, "entropy_coeff_schedule": null, "lr_schedule": null, "sgd_minibatch_size": -1, "vf_share_layers": -1, "differentiable_learner_configs": ["DifferentiableLearnerConfig(learner_class=<class 'source.intrinsic_attention_ppo.learners.IntrinsicAttentionPPOLearner.IntrinsicAttentionPPOLearner'>, learner_connector=None, add_default_connectors_to_learner_pipeline=True, is_multi_agent=False, policies_to_update=['default_policy'], lr=0.0060984166342, num_total_minibatches=0, num_epochs=1, minibatch_size=1000, shuffle_batch_per_epoch=True)"], "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9485408017724, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.callbacks.callbacks.RLlibCallback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 29.329967975616455, "iterations_since_restore": 3, "perf": {"cpu_util_percent": 40.853846153846156, "ram_util_percent": 80.33076923076925}}
{"timers": {"training_iteration": 10.22296826115443, "restore_env_runners": 1.276649354805704e-05, "training_step": 10.222764907480808, "env_runner_sampling_timer": 2.582060563995127, "learner_update_timer": 7.388232737652775, "synch_weights": 0.0017877892401955324, "restore_eval_env_runners": 4.51559578999877e-05, "evaluation_iteration": 0.138301931014366, "synch_eval_env_connectors": 0.00018389610900776458, "synch_env_connectors": 4.748727660626173e-06}, "env_runners": {"env_reset_timer": 4.409919817399061e-05, "num_episodes_lifetime": -61250.0, "num_env_steps_sampled_lifetime": -1225000.0, "num_env_steps_sampled": 5000.0, "module_to_env_connector": {"timers": {"connectors": {"remove_single_ts_time_rank_from_batch": 1.2423812356833936e-05, "get_actions": 4.284179482260154e-05, "listify_data_for_vector_env": 1.1451271553545562e-05, "tensor_to_numpy": 1.7413209976432815e-05, "un_batch_to_individual_items": 6.97600821852989e-06, "normalize_and_clip_actions": 8.507504757569731e-06}}, "connector_pipeline_timer": 0.0001272755136054207}, "module_episode_returns_mean": {"default_policy": -0.3}, "time_between_sampling": 0.03180399183802021, "rlmodule_inference_timer": 3.405722870995696e-05, "env_step_timer": 1.517630854976163e-05, "env_to_module_connector": {"timers": {"connectors": {"batch_individual_items": 1.3182693556408214e-05, "add_observations_from_episodes_to_batch": 3.0440240617851554e-06, "add_states_from_episodes_to_batch": 2.9731689268257757e-06, "numpy_to_tensor": 1.327617349096445e-05, "add_time_dim_to_batch_and_zero_pad": 7.793851115063398e-06}}, "connector_pipeline_timer": 6.403566734400531e-05}, "weights_seq_no": 3.0, "num_agent_steps_sampled": {"default_agent": 5000.0}, "episode_len_min": 20, "episode_len_mean": 20.0, "num_episodes": 250.0, "sample": 0.005919094368337822, "episode_duration_sec_mean": 0.005733969707507639, "episode_len_max": 20, "num_module_steps_sampled": {"default_policy": 5000.0}, "num_agent_steps_sampled_lifetime": {"default_agent": -1225000.0}, "num_module_steps_sampled_lifetime": {"default_policy": -1225000.0}, "env_to_module_sum_episodes_length_out": 10.36823839457432, "agent_episode_returns_mean": {"default_agent": -0.3}, "episode_return_max": 10.5, "episode_return_min": -9.5, "env_to_module_sum_episodes_length_in": 10.36823839457432, "episode_return_mean": -0.3, "num_env_steps_sampled_lifetime_throughput": 3162.185313646715}, "__all_modules__": {"learner_connector_sum_episodes_length_in": 5000.0, "learner_connector": {"connector_pipeline_timer": 0.21092757671653642, "timers": {"connectors": {"add_one_ts_to_episodes_and_truncate": 0.009056317299968562, "add_observations_from_episodes_to_batch": 0.0009615052970014513, "add_columns_from_episodes_to_train_batch": 0.10028898010413045, "add_time_dim_to_batch_and_zero_pad": 0.08798350554864388, "add_states_from_episodes_to_batch": 0.0035983231731618287, "batch_individual_items": 0.008749337872846517, "numpy_to_tensor": 8.809241752035451e-05}}}, "learner_connector_sum_episodes_length_out": 5250.0}, "learners": {"differentiable_learners": {"intrinsic_attention_ppo_learner": {"intrinsic_reward_module": {"num_module_steps_trained_lifetime": 143640, "weights_seq_no": 24.0, "total_loss": 0.0, "num_module_steps_trained": 35910, "diff_num_grad_updates_vs_sampler_policy": 21.0, "module_train_batch_size_mean": 997.6156867483631}, "default_policy": {"module_train_batch_size_mean": 997.6156867483631, "use_intrinsic_rewards": 1.0, "num_module_steps_trained_lifetime": 143640, "policy_loss": -0.0002634045376908034, "mean_kl_loss": 1.9057908502873033e-05, "entropy": 0.6898653507232666, "weights_seq_no": 24.0, "vf_loss_unclipped": 43.33094787597656, "vf_loss": 0.3584369122982025, "total_loss": 0.27791574597358704, "vf_explained_var": -0.002066969871520996, "num_module_steps_trained": 35910, "diff_num_grad_updates_vs_sampler_policy": 21.0}, "__all_modules__": {"num_env_steps_trained_lifetime": 792000, "num_module_steps_trained": 71820, "num_module_steps_trained_lifetime": 287280, "num_env_steps_trained": 198000, "num_env_steps_trained_lifetime_throughput": 56457.74595897152}}}, "intrinsic_reward_module": {"num_module_steps_trained": 5985, "curr_entropy_coeff": 0.0015431216992, "total_loss": 0.0, "num_module_steps_trained_lifetime": 23940, "gradients_default_optimizer_global_norm": 0.0, "diff_num_grad_updates_vs_sampler_policy": 1.0, "module_train_batch_size_mean": 997.8923005732703, "default_optimizer_learning_rate": 0.0002715581955, "num_trainable_parameters": 8266, "weights_seq_no": 4.0, "num_module_steps_trained_lifetime_throughput": 826.1573269917409}, "__all_modules__": {"num_trainable_parameters": 24861, "num_non_trainable_parameters": 0, "num_env_steps_trained_lifetime": 132000, "num_module_steps_trained": 11970, "num_module_steps_trained_lifetime": 47880, "num_env_steps_trained": 33000, "num_env_steps_trained_lifetime_throughput": 4557.059820195098, "num_module_steps_trained_throughput": 30882022.283886403, "num_module_steps_trained_lifetime_throughput": 13482586.855885535}, "default_policy": {"vf_loss": 0.35831013321876526, "weights_seq_no": 4.0, "curr_entropy_coeff": 0.0015431216992, "vf_loss_unclipped": 43.27388381958008, "total_loss": 0.2778055667877197, "vf_explained_var": 0.000394284725189209, "num_module_steps_trained": 5985, "diff_num_grad_updates_vs_sampler_policy": 1.0, "curr_kl_coeff": 0.010098995640873909, "use_intrinsic_rewards": 0.0, "module_train_batch_size_mean": 997.8923005732703, "num_module_steps_trained_lifetime": 23940, "policy_loss": -0.0002721426135394722, "num_trainable_parameters": 16595, "mean_kl_loss": 2.0291228793212213e-05, "entropy": 0.6898809671401978, "num_module_steps_trained_lifetime_throughput": 826.1388023146687}, "IntrinsicAttentionMask": [[[0.09309012442827225, 0.09498731791973114, 0.09009183943271637, 0.0945972353219986, 0.09440279752016068, 0.09136059135198593, 0.08665203303098679, 0.08647391945123672, 0.08629617840051651, 0.08880354464054108, 0.0932445079088211], [0.09414970129728317, 0.09703793376684189, 0.08964478224515915, 0.09644171595573425, 0.09614498168230057, 0.09154212474822998, 0.08456768095493317, 0.0843074843287468, 0.08404809236526489, 0.08773177117109299, 0.09438365697860718], [0.09133400022983551, 0.09168930351734161, 0.09076038002967834, 0.09161671996116638, 0.09158045053482056, 0.09100496023893356, 0.09008296579122543, 0.09004730731248856, 0.09001165628433228, 0.09050915390253067, 0.09136313199996948], [0.093935027718544, 0.09661860018968582, 0.08973810076713562, 0.09606508165597916, 0.09578951448202133, 0.0915074273943901, 0.08499091118574142, 0.08474711328744888, 0.08450400084257126, 0.08795159310102463, 0.09415261447429657], [0.09382741153240204, 0.0964091345667839, 0.08978435397148132, 0.09587683528661728, 0.09561179578304291, 0.09148962795734406, 0.0852028951048851, 0.08496735244989395, 0.08473247289657593, 0.08806127309799194, 0.09403683245182037], [0.09208954870700836, 0.09309343993663788, 0.09048353135585785, 0.09288778901100159, 0.09278513491153717, 0.09116610139608383, 0.0886102169752121, 0.08851229399442673, 0.08841448277235031, 0.0897858664393425, 0.09217159450054169], [0.08919055014848709, 0.08781954646110535, 0.09146096557378769, 0.0880974680185318, 0.08823675662279129, 0.0904841423034668, 0.09423604607582092, 0.0943850427865982, 0.09453427046537399, 0.09247803688049316, 0.08907713741064072], [0.08907568454742432, 0.0876166895031929, 0.091495081782341, 0.08791232109069824, 0.08806052058935165, 0.09045366942882538, 0.09445764124393463, 0.09461686760187149, 0.09477636218070984, 0.09258018434047699, 0.08895494043827057], [0.0889606773853302, 0.08741400390863419, 0.09152889996767044, 0.08772727847099304, 0.0878843367099762, 0.09042290598154068, 0.09467944502830505, 0.09484894573688507, 0.09501875936985016, 0.0926821380853653, 0.08883260935544968], [0.09054769575595856, 0.09025071561336517, 0.09103169292211533, 0.0903112068772316, 0.0903414711356163, 0.09082462638616562, 0.09161057323217392, 0.09164126962423325, 0.09167198091745377, 0.09124543517827988, 0.09052326530218124], [0.09317781776189804, 0.09515523910522461, 0.09005611389875412, 0.09474852681159973, 0.09454581886529922, 0.09137658029794693, 0.08647994697093964, 0.08629492670297623, 0.08611030876636505, 0.08871608227491379, 0.09333866834640503]], [[0.09146228432655334, 0.09152168780565262, 0.09069828689098358, 0.09164060652256012, 0.09228523075580597, 0.09175967425107956, 0.09181927144527435, 0.09099319577217102, 0.08439070731401443, 0.09303481131792068, 0.09039423614740372], [0.09154660999774933, 0.09161563962697983, 0.09065950661897659, 0.09175384044647217, 0.09250350296497345, 0.09189224988222122, 0.09196153283119202, 0.09100179374217987, 0.0833822563290596, 0.0933762788772583, 0.09030680358409882], [0.0902550220489502, 0.09019187092781067, 0.09107495844364166, 0.09006568789482117, 0.08938758820295334, 0.08993969112634659, 0.08987675607204437, 0.09075676649808884, 0.09843502193689346, 0.08861135691404343, 0.09140528738498688], [0.09171147644519806, 0.091799795627594, 0.09057802706956863, 0.09197668731212616, 0.09293751418590546, 0.09215392172336578, 0.09224266558885574, 0.09101500362157822, 0.08139778673648834, 0.09405884146690369, 0.09012822061777115], [0.09251724183559418, 0.09271080791950226, 0.09005241841077805, 0.09309915453195572, 0.09522385150194168, 0.0934891328215599, 0.09368473291397095, 0.09099841862916946, 0.07140377908945084, 0.09773622453212738, 0.0890842080116272], [0.09187137335538864, 0.09197905659675598, 0.09049142897129059, 0.09219479560852051, 0.09336820989847183, 0.09241104871034622, 0.0925193578004837, 0.09102299064397812, 0.07945598661899567, 0.09474096447229385, 0.08994483202695847], [0.091949462890625, 0.09206685423851013, 0.09044622629880905, 0.09230207651853561, 0.09358230978250504, 0.09253790229558945, 0.09265603870153427, 0.09102504700422287, 0.07850085943937302, 0.09508185088634491, 0.08985136449337006], [0.09074869751930237, 0.09073255956172943, 0.09095743298530579, 0.09070029854774475, 0.09052632749080658, 0.09066804498434067, 0.09065192192792892, 0.09087659418582916, 0.09277106076478958, 0.09032595902681351, 0.09104113280773163], [0.0689563974738121, 0.06811382621526718, 0.08082714676856995, 0.06645945459604263, 0.05819835141301155, 0.0648452639579773, 0.06405292451381683, 0.07600829005241394, 0.3164721727371216, 0.04993254318833351, 0.08613357692956924], [0.09328127652406693, 0.0935981497168541, 0.08928245306015015, 0.0942351296544075, 0.09774939715862274, 0.09487645328044891, 0.09519875049591064, 0.09080924838781357, 0.061270687729120255, 0.10196826606988907, 0.08773010969161987], [0.08970777690410614, 0.08959659934043884, 0.09115665405988693, 0.08937465399503708, 0.08818599581718445, 0.08915325999259949, 0.0890427753329277, 0.09059318155050278, 0.10461209714412689, 0.08683384209871292, 0.09174320846796036]], [[0.09184615314006805, 0.09371799975633621, 0.08888794481754303, 0.09333312511444092, 0.09314128756523132, 0.09013973921537399, 0.08995446562767029, 0.08976956456899643, 0.08958505094051361, 0.09218797087669373, 0.08743676543235779], [0.09230019897222519, 0.09513168781995773, 0.08788377046585083, 0.09454718232154846, 0.09425628185272217, 0.08974383771419525, 0.08946771174669266, 0.08919243514537811, 0.08891801536083221, 0.09281513094902039, 0.08574370294809341], [0.09109194576740265, 0.09144631028175354, 0.09051984548568726, 0.09137392044067383, 0.09133774787187576, 0.09076378494501114, 0.09072785079479218, 0.0906919315457344, 0.09065602719783783, 0.09115708619356155, 0.09023354947566986], [0.09220826625823975, 0.09484250098466873, 0.0880884900689125, 0.09429915994405746, 0.09402865171432495, 0.08982528746128082, 0.08956761658191681, 0.08931069076061249, 0.08905449509620667, 0.09268772602081299, 0.08608715981245041], [0.09216216206550598, 0.09469806402921677, 0.08819086104631424, 0.09417521208524704, 0.09391487389802933, 0.08986587077379227, 0.08961744606494904, 0.08936969935894012, 0.08912264555692673, 0.09262391924858093, 0.08625924587249756], [0.09141673147678375, 0.0924132838845253, 0.0898224413394928, 0.09220913797616959, 0.09210723638534546, 0.09050002694129944, 0.09040001779794693, 0.09030011296272278, 0.09020031988620758, 0.09159940481185913, 0.08903137594461441], [0.09136917442083359, 0.09227067977190018, 0.08992500603199005, 0.0920860767364502, 0.09199392050504684, 0.09053909033536911, 0.09044847637414932, 0.0903579518198967, 0.09026752412319183, 0.09153449535369873, 0.08920754492282867], [0.09132155776023865, 0.0921282097697258, 0.09002761542797089, 0.09196310490369797, 0.09188065677881241, 0.09057807922363281, 0.09049688279628754, 0.09041575342416763, 0.0903346985578537, 0.09146954864263535, 0.08938396722078323], [0.09127384424209595, 0.09198583662509918, 0.09013021737337112, 0.09184016287326813, 0.09176741540431976, 0.09061696380376816, 0.0905451849102974, 0.09047345817089081, 0.0904017984867096, 0.09140452742576599, 0.08956063538789749], [0.09193036705255508, 0.09397750347852707, 0.08870294690132141, 0.09355628490447998, 0.09334637969732285, 0.09006748348474503, 0.08986540883779526, 0.0896637886762619, 0.08946262300014496, 0.09230390936136246, 0.08712329715490341], [0.09070476144552231, 0.09031473100185394, 0.09134124219417572, 0.09039415419101715, 0.09043388813734055, 0.0910688191652298, 0.09110885113477707, 0.09114889800548553, 0.0911889597773552, 0.09063281863927841, 0.0916629433631897]], [[0.09032315760850906, 0.08593075722455978, 0.08345288038253784, 0.09089452773332596, 0.0882735326886177, 0.08665630221366882, 0.08683864027261734, 0.08883193880319595, 0.12373530119657516, 0.09061602503061295, 0.08444692939519882], [0.0909053385257721, 0.09171684086322784, 0.0921965092420578, 0.09080319851636887, 0.0912780836224556, 0.09157946705818176, 0.09154515713453293, 0.09117552638053894, 0.08594493567943573, 0.09085288643836975, 0.09200208634138107], [0.09062647819519043, 0.094642773270607, 0.09708244353532791, 0.09013073891401291, 0.09245409816503525, 0.09395312517881393, 0.0937815010547638, 0.09194835275411606, 0.06892126798629761, 0.09037164598703384, 0.09608764201402664], [0.09013815969228745, 0.08511994034051895, 0.08230573683977127, 0.0907936543226242, 0.08779186755418777, 0.08594627678394318, 0.08615411818027496, 0.08843030780553818, 0.1294126659631729, 0.09047406166791916, 0.08343324065208435], [0.09077544510364532, 0.08872860670089722, 0.08754882216453552, 0.09103769809007645, 0.08982720971107483, 0.08907055854797363, 0.08915624767541885, 0.09008672833442688, 0.10483439266681671, 0.09090997278690338, 0.08802437037229538], [0.09090758860111237, 0.09081494808197021, 0.09076061844825745, 0.09091931581497192, 0.09086491912603378, 0.09083056449890137, 0.09083446860313416, 0.09087663888931274, 0.09149467200040817, 0.09091360867023468, 0.09078260511159897], [0.09090226143598557, 0.09058500081300735, 0.09039930254220963, 0.09094247221946716, 0.09075605124235153, 0.0906384289264679, 0.09065178781747818, 0.09079618752002716, 0.09293120354413986, 0.09092289954423904, 0.09047440439462662], [0.0906844288110733, 0.08798346668481827, 0.08643582463264465, 0.09103193134069443, 0.08943066745996475, 0.08843330293893814, 0.08854611963033676, 0.08977337181568146, 0.1097593903541565, 0.09086264669895172, 0.08705883473157883], [0.0450921393930912, 0.029606474563479424, 0.023128461092710495, 0.04755684733390808, 0.03715122118592262, 0.03178359195590019, 0.03235244378447533, 0.03918188437819481, 0.6422468423843384, 0.04634101316332817, 0.02555912546813488], [0.09023160487413406, 0.08551684021949768, 0.08286519348621368, 0.0908462181687355, 0.08802931755781174, 0.08629439026117325, 0.08648988604545593, 0.08862893283367157, 0.12662282586097717, 0.09054660052061081, 0.08392824232578278], [0.09078728407621384, 0.09349709004163742, 0.09512505680322647, 0.09045015275478363, 0.09202507138252258, 0.09303444623947144, 0.09291914850473404, 0.09168334305286407, 0.07540148496627808, 0.09061405807733536, 0.09446284174919128]], [[0.09309091418981552, 0.0949881300330162, 0.09479288756847382, 0.08990743011236191, 0.09440360218286514, 0.08683125674724579, 0.08665277808904648, 0.08647466450929642, 0.09079916775226593, 0.09343736618757248, 0.08862177282571793], [0.09415146708488464, 0.09703974425792694, 0.09674116969108582, 0.08937063068151474, 0.09614677727222443, 0.08483027666807175, 0.08456926792860031, 0.08430906385183334, 0.09070143848657608, 0.09467672556638718, 0.08746346831321716], [0.09404411166906357, 0.09682989120483398, 0.09654204547405243, 0.08942651748657227, 0.09596891701221466, 0.08503343909978867, 0.08478066325187683, 0.08452863991260529, 0.09071271121501923, 0.09455093741416931, 0.08758216351270676], [0.09122218191623688, 0.09148332476615906, 0.09145665913820267, 0.09077353775501251, 0.09140335023403168, 0.09032687544822693, 0.0903005450963974, 0.09027422219514847, 0.09090057015419006, 0.09127020835876465, 0.09058848023414612], [0.09382884204387665, 0.0964106023311615, 0.09614408016204834, 0.08953751623630524, 0.09561324864625931, 0.08544038981199265, 0.08520419895648956, 0.08496865630149841, 0.09073436260223389, 0.09429895132780075, 0.0878191739320755], [0.08930572867393494, 0.08802304416894913, 0.08815301209688187, 0.09156202524900436, 0.08841351419687271, 0.09387653321027756, 0.09401514381170273, 0.09415395557880402, 0.09091632068157196, 0.08906816691160202, 0.09251256287097931], [0.08919109404087067, 0.08782008290290833, 0.0879589319229126, 0.09160612523555756, 0.08823729306459427, 0.09408785402774811, 0.09423661231994629, 0.09438560903072357, 0.09091456234455109, 0.08893705904483795, 0.09262481331825256], [0.08907630294561386, 0.08761729300022125, 0.08776498585939407, 0.09164994210004807, 0.08806112408638, 0.0942993238568306, 0.09445828944444656, 0.09461751580238342, 0.09091249853372574, 0.08880585432052612, 0.0927368775010109], [0.0917571410536766, 0.09247290343046188, 0.09239964932203293, 0.09053568542003632, 0.09225332736968994, 0.08932986110448837, 0.08925909548997879, 0.08918838948011398, 0.09088047593832016, 0.09188850969076157, 0.0900348573923111], [0.09328749030828476, 0.09536484628915787, 0.095150887966156, 0.08981048315763474, 0.09472440183162689, 0.08646136522293091, 0.0862673819065094, 0.08607383072376251, 0.09078331291675568, 0.09366654604673386, 0.08840945363044739], [0.09043475985527039, 0.09004589170217514, 0.0900854766368866, 0.09110938012599945, 0.09016469120979309, 0.0917893797159195, 0.09182972460985184, 0.09187009185552597, 0.09091752022504807, 0.0903630331158638, 0.09139008820056915]], [[0.09105818718671799, 0.09111732244491577, 0.09175827354192734, 0.09271159768104553, 0.09041488915681839, 0.09135425835847855, 0.0928923562169075, 0.09205663204193115, 0.08401786535978317, 0.0926237627863884, 0.08999485522508621], [0.09107638895511627, 0.09114505350589752, 0.09188974648714066, 0.0929989293217659, 0.09032990038394928, 0.0914202481508255, 0.09320943802595139, 0.09223667532205582, 0.08295398205518723, 0.09289664775133133, 0.08984293788671494], [0.09117639809846878, 0.0913480818271637, 0.09322236478328705, 0.09605642408132553, 0.089322529733181, 0.09203803539276123, 0.09660005569458008, 0.09410334378480911, 0.07221434265375137, 0.0957929790019989, 0.08812548965215683], [0.09102791547775269, 0.09135106205940247, 0.09491387754678726, 0.10042238980531693, 0.08757270872592926, 0.09265516698360443, 0.10149569064378738, 0.09661059826612473, 0.05867139622569084, 0.09990418702363968, 0.08537502586841583], [0.09075379371643066, 0.09070923179388046, 0.09022952616214752, 0.08952680975198746, 0.09124181419610977, 0.09053120762109756, 0.08939500153064728, 0.09000822901725769, 0.09644962102174759, 0.08959102630615234, 0.09156376123428345], [0.09113374352455139, 0.09124056994915009, 0.09240183234214783, 0.0941411629319191, 0.08997543156147003, 0.09166909009218216, 0.09447257220745087, 0.09294461458921432, 0.07881806790828705, 0.09398029744625092, 0.08922267705202103], [0.09096411615610123, 0.09131564199924469, 0.09519854187965393, 0.10122720152139664, 0.0872124657034874, 0.09273537993431091, 0.10240530222654343, 0.09705226123332977, 0.056397292762994766, 0.10065879672765732, 0.08483299612998962], [0.09116583317518234, 0.09138519316911697, 0.09378748387098312, 0.09744539111852646, 0.08880439400672913, 0.0922679454088211, 0.09815051406621933, 0.0949212908744812, 0.06768104434013367, 0.09710408747196198, 0.08728679269552231], [0.0729413628578186, 0.07205010205507278, 0.06309406459331512, 0.051878590136766434, 0.0834214836359024, 0.06859265267848969, 0.05000004544854164, 0.05933243781328201, 0.3347599506378174, 0.052818141877651215, 0.09111117571592331], [0.09105503559112549, 0.09136435389518738, 0.09477156400680542, 0.10002873837947845, 0.08774477243423462, 0.09261215478181839, 0.10105159133672714, 0.09639222919940948, 0.05980844795703888, 0.09953471273183823, 0.08563636243343353], [0.09044282138347626, 0.09033073484897614, 0.08912935853004456, 0.08738698810338974, 0.09167591482400894, 0.08988376706838608, 0.08706248551607132, 0.08857841789722443, 0.1054692491889, 0.08754535019397736, 0.09249493479728699]]]}, "num_training_step_calls_per_iteration": 1, "evaluation": {"env_runners": {"module_to_env_connector": {"timers": {"connectors": {"remove_single_ts_time_rank_from_batch": 1.222515043664731e-05, "get_actions": 3.679024539273752e-05, "normalize_and_clip_actions": 7.940549032970399e-06, "listify_data_for_vector_env": 1.0555248378019315e-05, "tensor_to_numpy": 1.500256512653716e-05, "un_batch_to_individual_items": 6.581770034696729e-06}}, "connector_pipeline_timer": 0.00011574266434132946}, "episode_len_max": 20, "num_agent_steps_sampled_lifetime": {"default_agent": 1600}, "num_module_steps_sampled_lifetime": {"default_policy": 1600}, "episode_return_max": 14.5, "env_reset_timer": 0.0005694864740057382, "rlmodule_inference_timer": 3.129357506101898e-05, "env_step_timer": 1.428844838531383e-05, "env_to_module_connector": {"timers": {"connectors": {"add_states_from_episodes_to_batch": 2.7350615286192663e-06, "numpy_to_tensor": 1.2106368725442266e-05, "add_time_dim_to_batch_and_zero_pad": 7.1205106615090646e-06, "add_observations_from_episodes_to_batch": 2.882843048124742e-06, "batch_individual_items": 1.2586830402242101e-05}}, "connector_pipeline_timer": 6.018093928089465e-05}, "episode_len_min": 20, "env_to_module_sum_episodes_length_out": 10.368237912813044, "env_to_module_sum_episodes_length_in": 10.368237912813044, "num_env_steps_sampled_lifetime": 20400, "num_agent_steps_sampled": {"default_agent": 400}, "weights_seq_no": 4.0, "module_episode_returns_mean": {"default_policy": 0.55}, "episode_len_mean": 20.0, "sample": 0.12649384197238014, "agent_episode_returns_mean": {"default_agent": 0.55}, "episode_return_mean": 0.55, "episode_return_min": -12.5, "num_episodes": 20, "episode_duration_sec_mean": 0.005433626049489248, "num_module_steps_sampled": {"default_policy": 400}, "num_episodes_lifetime": 80, "num_env_steps_sampled": 400, "time_between_sampling": 9.434698640482898}, "num_healthy_workers": 1, "actor_manager_num_outstanding_async_reqs": 0, "num_remote_worker_restarts": 0}, "num_env_steps_sampled_lifetime": -1225000.0, "fault_tolerance": {"num_healthy_workers": 0, "num_remote_worker_restarts": 0}, "env_runner_group": {"actor_manager_num_outstanding_async_reqs": 0}, "done": false, "training_iteration": 4, "trial_id": "b9446_00000", "date": "2025-08-11_18-34-53", "timestamp": 1754930093, "time_this_iter_s": 10.765636920928955, "time_total_s": 40.09560489654541, "pid": 11415, "hostname": "Mac", "node_ip": "127.0.0.1", "config": {"exploration_config": {}, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 2, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "env": "Umbrella", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": false, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 0, "create_local_env_runner": true, "num_envs_per_env_runner": 1, "gym_env_vectorize_mode": "SYNC", "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "episodes_to_numpy": true, "max_requests_in_flight_per_env_runner": 1, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "merge_env_runner_states": "training_only", "broadcast_env_runner_states": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "complete_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "sampler_perf_stats_ema_coef": null, "_is_online": true, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": "auto", "num_aggregator_actors_per_learner": 0, "max_requests_in_flight_per_aggregator_actor": 3, "local_gpu_idx": 0, "max_requests_in_flight_per_learner": 3, "gamma": 1, "lr": 0.0002715581955, "grad_clip": 0.5, "grad_clip_by": "global_norm", "_train_batch_size_per_learner": 5000, "train_batch_size": 4000, "num_epochs": 1, "minibatch_size": 1000, "shuffle_batch_per_epoch": true, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "log_std_clip_param": 20.0, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "_disable_preprocessor_api": false, "_disable_action_flattening": false}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {"intrinsic_reward_coeff": 0.2795015916508}, "optimizer": {}, "_learner_class": "<class 'source.intrinsic_attention_ppo.learners.IntrinsicAttentionMetaLearner.IntrinsicAttentionMetaLearner'>", "callbacks_on_algorithm_init": null, "callbacks_on_env_runners_recreated": null, "callbacks_on_offline_eval_runners_recreated": null, "callbacks_on_checkpoint_loaded": null, "callbacks_on_environment_created": null, "callbacks_on_episode_created": null, "callbacks_on_episode_start": null, "callbacks_on_episode_step": null, "callbacks_on_episode_end": null, "callbacks_on_evaluate_start": null, "callbacks_on_evaluate_end": null, "callbacks_on_evaluate_offline_start": null, "callbacks_on_evaluate_offline_end": null, "callbacks_on_sample_end": null, "callbacks_on_train_result": null, "explore": true, "enable_rl_module_and_learner": true, "enable_env_runner_and_connector_v2": true, "_prior_exploration_config": {"type": "StochasticSampling"}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x3884998a0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "offline_data_class": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_read_batch_size": null, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "materialize_data": false, "materialize_mapped_data": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "ignore_final_observation": false, "prelearner_class": null, "prelearner_buffer_class": null, "prelearner_buffer_kwargs": {}, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_remaining_data": false, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": 1, "evaluation_duration": 20, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_auto_duration_min_env_steps_per_sample": 100, "evaluation_auto_duration_max_env_steps_per_sample": 2000, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 1, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "offline_evaluation_interval": null, "num_offline_eval_runners": 0, "offline_loss_for_module_fn": null, "offline_evaluation_duration": 1, "offline_evaluation_parallel_to_training": false, "offline_evaluation_timeout_s": 120.0, "num_cpus_per_offline_eval_runner": 1, "num_gpus_per_offline_eval_runner": 0, "custom_resources_per_offline_eval_runner": {}, "restart_failed_offline_eval_runners": true, "ignore_offline_eval_runner_failures": false, "max_num_offline_eval_runner_restarts": 1000, "offline_eval_runner_restore_timeout_s": 1800.0, "max_requests_in_flight_per_offline_eval_runner": 1, "validate_offline_eval_runners_after_construction": true, "offline_eval_runner_health_probe_timeout_s": 30.0, "offline_eval_rl_module_inference_only": false, "broadcast_offline_eval_runner_states": false, "offline_eval_batch_size_per_runner": 256, "dataset_num_iters_per_eval_runner": 1, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "log_gradients": false, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 7, "restart_failed_env_runners": true, "ignore_env_runner_failures": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30.0, "env_runner_restore_timeout_s": 1800.0, "_model_config": {}, "_rl_module_spec": "MultiRLModuleSpec(multi_rl_module_class=<class 'ray.rllib.core.rl_module.multi_rl_module.MultiRLModule'>, observation_space=None, action_space=None, inference_only=False, model_config=None, rl_module_specs={'default_policy': RLModuleSpec(module_class=<class 'source.intrinsic_attention_ppo.rl_modules.DifferentiablePPOModule.DifferentiablePPOModule'>, observation_space=None, action_space=None, inference_only=False, learner_only=False, model_config={'vf_share_layers': True, 'embedding_dim': 62, 'max_seq_len': 11, 'policy_head_hidden_sizes': [32], 'value_head_hidden_sizes': [101], 'embedding_hidden_sizes': [121]}, catalog_class=None, load_state_path=None, model_config_dict=None), 'intrinsic_reward_module': RLModuleSpec(module_class=<class 'source.intrinsic_attention_ppo.rl_modules.IntrinsicAttentionModule.IntrinsicAttentionModule'>, observation_space=None, action_space=None, inference_only=False, learner_only=True, model_config={'intrinsic_reward_network': {'encoder_hidden_sizes': [], 'encoding_dim': 1, 'num_heads': 1, 'head_hidden_sizes': None, 'layers': [{'type': 'attention'}]}, 'extrinsic_value_hidden_layers': [127, 60], 'vf_share_layers': True, 'max_seq_len': 11}, catalog_class=None, load_state_path=None, model_config_dict=None)}, load_state_path=None, modules_to_load=None, module_specs={'default_policy': RLModuleSpec(module_class=<class 'source.intrinsic_attention_ppo.rl_modules.DifferentiablePPOModule.DifferentiablePPOModule'>, observation_space=None, action_space=None, inference_only=False, learner_only=False, model_config={'vf_share_layers': True, 'embedding_dim': 62, 'max_seq_len': 11, 'policy_head_hidden_sizes': [32], 'value_head_hidden_sizes': [101], 'embedding_hidden_sizes': [121]}, catalog_class=None, load_state_path=None, model_config_dict=None), 'intrinsic_reward_module': RLModuleSpec(module_class=<class 'source.intrinsic_attention_ppo.rl_modules.IntrinsicAttentionModule.IntrinsicAttentionModule'>, observation_space=None, action_space=None, inference_only=False, learner_only=True, model_config={'intrinsic_reward_network': {'encoder_hidden_sizes': [], 'encoding_dim': 1, 'num_heads': 1, 'head_hidden_sizes': None, 'layers': [{'type': 'attention'}]}, 'extrinsic_value_hidden_layers': [127, 60], 'vf_share_layers': True, 'max_seq_len': 11}, catalog_class=None, load_state_path=None, model_config_dict=None)})", "algorithm_config_overrides_per_module": {"intrinsic_reward_module": {"lr": 0.0002715581955}}, "_per_module_overrides": {}, "_validate_config": true, "_use_msgpack_checkpoints": false, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "env_task_fn": -1, "enable_connectors": -1, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.161583927863, "kl_target": 0.0201019014258, "vf_loss_coeff": 0.7790510010087, "entropy_coeff": 0.0015431216992, "clip_param": 0.2459212356676, "vf_clip_param": 0.3769744131561, "entropy_coeff_schedule": null, "lr_schedule": null, "sgd_minibatch_size": -1, "vf_share_layers": -1, "differentiable_learner_configs": ["DifferentiableLearnerConfig(learner_class=<class 'source.intrinsic_attention_ppo.learners.IntrinsicAttentionPPOLearner.IntrinsicAttentionPPOLearner'>, learner_connector=None, add_default_connectors_to_learner_pipeline=True, is_multi_agent=False, policies_to_update=['default_policy'], lr=0.0060984166342, num_total_minibatches=0, num_epochs=1, minibatch_size=1000, shuffle_batch_per_epoch=True)"], "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9485408017724, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.callbacks.callbacks.RLlibCallback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 40.09560489654541, "iterations_since_restore": 4, "perf": {"cpu_util_percent": 49.239999999999995, "ram_util_percent": 81.51333333333335}}
{"timers": {"training_iteration": 10.218733788963226, "restore_env_runners": 1.2799248926053987e-05, "training_step": 10.218529985486128, "env_runner_sampling_timer": 2.571815657525761, "learner_update_timer": 7.394857262777086, "synch_weights": 0.0017876925984380522, "restore_eval_env_runners": 4.532564752176404e-05, "evaluation_iteration": 0.13819949253428412, "synch_eval_env_connectors": 0.00018411922764719924, "synch_env_connectors": 4.755400284193456e-06}, "env_runners": {"env_reset_timer": 4.6683442326323654e-05, "num_episodes_lifetime": -92125.0, "num_env_steps_sampled_lifetime": -1842500.0, "num_env_steps_sampled": 5000.0, "module_to_env_connector": {"timers": {"connectors": {"remove_single_ts_time_rank_from_batch": 1.2099741830101578e-05, "get_actions": 4.016696784848627e-05, "listify_data_for_vector_env": 1.0915032559563459e-05, "tensor_to_numpy": 1.5681671356258646e-05, "un_batch_to_individual_items": 6.691277932845086e-06, "normalize_and_clip_actions": 8.186774166789811e-06}}, "connector_pipeline_timer": 0.00012045102167425019}, "module_episode_returns_mean": {"default_policy": -2.2199999999999998}, "time_between_sampling": 0.03660123853747318, "rlmodule_inference_timer": 3.2266086713774886e-05, "env_step_timer": 1.432831776328114e-05, "env_to_module_connector": {"timers": {"connectors": {"batch_individual_items": 1.2684271164607425e-05, "add_observations_from_episodes_to_batch": 2.9279678807915977e-06, "add_states_from_episodes_to_batch": 2.749158450259902e-06, "numpy_to_tensor": 1.2798960963830222e-05, "add_time_dim_to_batch_and_zero_pad": 7.309874096373056e-06}}, "connector_pipeline_timer": 6.0681941431664935e-05}, "weights_seq_no": 4.0, "num_agent_steps_sampled": {"default_agent": 5000.0}, "episode_len_min": 20, "episode_len_mean": 20.0, "num_episodes": 250.0, "sample": 0.006073500293685926, "episode_duration_sec_mean": 0.0053301566448062665, "episode_len_max": 20, "num_module_steps_sampled": {"default_policy": 5000.0}, "num_agent_steps_sampled_lifetime": {"default_agent": -1842500.0}, "num_module_steps_sampled_lifetime": {"default_policy": -1842500.0}, "env_to_module_sum_episodes_length_out": 10.36823839457432, "agent_episode_returns_mean": {"default_agent": -2.2199999999999998}, "episode_return_max": 10.5, "episode_return_min": -9.5, "env_to_module_sum_episodes_length_in": 10.36823839457432, "episode_return_mean": -2.2199999999999998, "num_env_steps_sampled_lifetime_throughput": 3165.155256653441}, "__all_modules__": {"learner_connector_sum_episodes_length_in": 5000.0, "learner_connector": {"connector_pipeline_timer": 0.21023294887012672, "timers": {"connectors": {"add_one_ts_to_episodes_and_truncate": 0.009052963297420263, "add_observations_from_episodes_to_batch": 0.0009608889935762808, "add_columns_from_episodes_to_train_batch": 0.0997448048832525, "add_time_dim_to_batch_and_zero_pad": 0.0878823775727468, "add_states_from_episodes_to_batch": 0.003598895351327329, "batch_individual_items": 0.008703725324076298, "numpy_to_tensor": 8.799566346051754e-05}}}, "learner_connector_sum_episodes_length_out": 5250.0}, "learners": {"differentiable_learners": {"intrinsic_attention_ppo_learner": {"intrinsic_reward_module": {"num_module_steps_trained_lifetime": 179550, "weights_seq_no": 30.0, "total_loss": 0.0, "num_module_steps_trained": 35910, "diff_num_grad_updates_vs_sampler_policy": 26.0, "module_train_batch_size_mean": 997.5798029998547}, "default_policy": {"module_train_batch_size_mean": 997.5798029998547, "use_intrinsic_rewards": 1.0, "num_module_steps_trained_lifetime": 179550, "policy_loss": -0.000623956264462322, "mean_kl_loss": 3.6043074942426756e-05, "entropy": 0.6907203197479248, "weights_seq_no": 30.0, "vf_loss_unclipped": 46.9508171081543, "vf_loss": 0.3584459722042084, "total_loss": 0.2775636911392212, "vf_explained_var": -0.002350330352783203, "num_module_steps_trained": 35910, "diff_num_grad_updates_vs_sampler_policy": 26.0}, "__all_modules__": {"num_env_steps_trained_lifetime": 990000, "num_module_steps_trained": 71820, "num_module_steps_trained_lifetime": 359100, "num_env_steps_trained": 198000, "num_env_steps_trained_lifetime_throughput": 55653.13165547441}}}, "intrinsic_reward_module": {"num_module_steps_trained": 5985, "curr_entropy_coeff": 0.0015431216992, "total_loss": 0.0, "num_module_steps_trained_lifetime": 29925, "gradients_default_optimizer_global_norm": 0.0, "diff_num_grad_updates_vs_sampler_policy": 1.0, "module_train_batch_size_mean": 997.8691961675322, "default_optimizer_learning_rate": 0.0002715581955, "num_trainable_parameters": 8266, "weights_seq_no": 5.0, "num_module_steps_trained_lifetime_throughput": 821.7776897755059}, "__all_modules__": {"num_trainable_parameters": 24861, "num_non_trainable_parameters": 0, "num_env_steps_trained_lifetime": 165000, "num_module_steps_trained": 11970, "num_module_steps_trained_lifetime": 59850, "num_env_steps_trained": 33000, "num_env_steps_trained_lifetime_throughput": 4532.858515473116, "num_module_steps_trained_throughput": 30012223.765071567, "num_module_steps_trained_lifetime_throughput": 13425794.70938558}, "default_policy": {"vf_loss": 0.35832375288009644, "weights_seq_no": 5.0, "curr_entropy_coeff": 0.0015431216992, "vf_loss_unclipped": 46.665897369384766, "total_loss": 0.2774365246295929, "vf_explained_var": 0.0007156133651733398, "num_module_steps_trained": 5985, "diff_num_grad_updates_vs_sampler_policy": 1.0, "curr_kl_coeff": 0.0050494978204369545, "use_intrinsic_rewards": 0.0, "module_train_batch_size_mean": 997.8691961675322, "num_module_steps_trained_lifetime": 29925, "policy_loss": -0.0006504827761091292, "num_trainable_parameters": 16595, "mean_kl_loss": 3.89711931347847e-05, "entropy": 0.6907438039779663, "num_module_steps_trained_lifetime_throughput": 821.7599242367374}, "IntrinsicAttentionMask": [[[0.09115961939096451, 0.09003464132547379, 0.09125512838363647, 0.09012896567583084, 0.09017617255449295, 0.09093096107244492, 0.09097859263420105, 0.09221187233924866, 0.0910739079117775, 0.09159020334482193, 0.090459905564785], [0.08994156122207642, 0.0942058265209198, 0.08959091454744339, 0.09383855015039444, 0.09365544468164444, 0.09078814834356308, 0.09061099588871002, 0.0861721858382225, 0.09025774151086807, 0.08837436139583588, 0.09256431460380554], [0.09125848859548569, 0.08968693017959595, 0.09139227122068405, 0.08981840312480927, 0.0898842141032219, 0.09093843400478363, 0.09100507199764252, 0.09273547679185867, 0.09113847464323044, 0.09186205267906189, 0.09028009325265884], [0.0900474563241005, 0.09385070204734802, 0.08973386883735657, 0.09352386742830276, 0.09336087852716446, 0.09080401808023453, 0.09064577519893646, 0.08666952699422836, 0.0903301015496254, 0.08864488452672958, 0.09238888323307037], [0.09010019153356552, 0.09367337077856064, 0.08980517089366913, 0.09336665272712708, 0.09321366995573044, 0.09081169962882996, 0.09066290408372879, 0.08691901713609695, 0.09036604315042496, 0.08878019452095032, 0.09230102598667145], [0.09092001616954803, 0.09087115526199341, 0.09092413634061813, 0.09087527543306351, 0.09087733179330826, 0.09091012924909592, 0.09091219305992126, 0.09096519649028778, 0.09091631323099136, 0.09093856066465378, 0.09088969230651855], [0.0909702479839325, 0.09069645404815674, 0.09099337458610535, 0.09071950614452362, 0.09073103964328766, 0.09091480821371078, 0.09092636406421661, 0.09122403711080551, 0.09094947576522827, 0.09107436239719391, 0.09080025553703308], [0.09220947325229645, 0.08625911921262741, 0.09272965043783188, 0.0867457166314125, 0.08699005097150803, 0.09097377955913544, 0.09123002737760544, 0.09807343780994415, 0.09174467623233795, 0.09457346796989441, 0.08847056329250336], [0.0910702794790268, 0.0903475433588028, 0.09113149344921112, 0.09040826559066772, 0.09043864160776138, 0.09092363715171814, 0.09095419198274612, 0.09174340963363647, 0.09101533144712448, 0.09134605526924133, 0.09062113612890244], [0.0915997326374054, 0.08847501873970032, 0.09186822921037674, 0.08873435109853745, 0.08886431157588959, 0.09095897525548935, 0.09109219163656235, 0.09458577632904053, 0.0913591980934143, 0.09281417727470398, 0.08964803814888], [0.09041355550289154, 0.092612624168396, 0.09023050963878632, 0.09242513030767441, 0.09233152866363525, 0.09085406363010406, 0.09076204895973206, 0.08842752873897552, 0.09057829529047012, 0.08959277719259262, 0.09177189320325851]], [[0.0913151353597641, 0.09285257011651993, 0.09201719611883163, 0.091493159532547, 0.09067002683877945, 0.09161204844713211, 0.09315447509288788, 0.0923163890838623, 0.08291370421648026, 0.09140648692846298, 0.09024880826473236], [0.09223419427871704, 0.10049332678318024, 0.09593500196933746, 0.09316158294677734, 0.08893582224845886, 0.09378501772880554, 0.1021830216050148, 0.09754805266857147, 0.05618102103471756, 0.09270911663770676, 0.0868339091539383], [0.09187919646501541, 0.09643334150314331, 0.09394094347953796, 0.09239918738603592, 0.09001105278730392, 0.09274748712778091, 0.09734466671943665, 0.09482870995998383, 0.06946488469839096, 0.09214577078819275, 0.08880477398633957], [0.09148340672254562, 0.0937761664390564, 0.0925280973315239, 0.0917479544878006, 0.09052687883377075, 0.091924749314785, 0.09422857314348221, 0.0929744765162468, 0.07928651571273804, 0.09161911904811859, 0.08990409225225449], [0.09054816514253616, 0.08941175043582916, 0.09002508223056793, 0.090414859354496, 0.09103508293628693, 0.09032609313726425, 0.0891924574971199, 0.08980429172515869, 0.0974063128232956, 0.09047970920801163, 0.0913562998175621], [0.09158595651388168, 0.09438689053058624, 0.09286033362150192, 0.09190837293863297, 0.0904218927025795, 0.09212394058704376, 0.09494134038686752, 0.09340580552816391, 0.07694873958826065, 0.09175132215023041, 0.08966540545225143], [0.09228860586881638, 0.10191193222999573, 0.09658469259738922, 0.09336267411708832, 0.0884823277592659, 0.09408565610647202, 0.1038963720202446, 0.09846539795398712, 0.05201574042439461, 0.09283843636512756, 0.08606821298599243], [0.09204304218292236, 0.0979112759232521, 0.09468992799520493, 0.09270907193422318, 0.08965887874364853, 0.09315576404333115, 0.0990949347615242, 0.0958346500992775, 0.06439144164323807, 0.09238435328006744, 0.08812668174505234], [0.05432302877306938, 0.03705520182847977, 0.04558004438877106, 0.051952119916677475, 0.06390412151813507, 0.050429292023181915, 0.03439917787909508, 0.04231298342347145, 0.49585258960723877, 0.05309269577264786, 0.07109881192445755], [0.09140370786190033, 0.0933278352022171, 0.09228137135505676, 0.0916261151432991, 0.09059871733188629, 0.09177467972040176, 0.09370661526918411, 0.09265589714050293, 0.0810333788394928, 0.09151781350374222, 0.09007386863231659], [0.0899033173918724, 0.0870814323425293, 0.08859768509864807, 0.08956947177648544, 0.09112905710935593, 0.08934759348630905, 0.08654314279556274, 0.08805003762245178, 0.10810330510139465, 0.08973178267478943, 0.09194318950176239]], [[0.09227316826581955, 0.08948514610528946, 0.09396018832921982, 0.09376705437898636, 0.08893448114395142, 0.09055883437395096, 0.09037269651889801, 0.0901869386434555, 0.09000156074762344, 0.09261657297611237, 0.08784329146146774], [0.09124258905649185, 0.0905643180012703, 0.0916455090045929, 0.09159966558218002, 0.09042846411466599, 0.09082739800214767, 0.09078195691108704, 0.09073653817176819, 0.09069114178419113, 0.0913250595331192, 0.09015737473964691], [0.09287641942501068, 0.08884359151124954, 0.09534334391355515, 0.09505992382764816, 0.0880536288022995, 0.09039010852575302, 0.09012141078710556, 0.08985351026058197, 0.08958639949560165, 0.09337696433067322, 0.08649472147226334], [0.09280811250209808, 0.0889165997505188, 0.09518565237522125, 0.09491261094808578, 0.08815360069274902, 0.09040965139865875, 0.09015030413866043, 0.0898916944861412, 0.08963383734226227, 0.09329069405794144, 0.08664719760417938], [0.0910339206457138, 0.09078029543161392, 0.09118402749300003, 0.09116696566343307, 0.09072935581207275, 0.09087880700826645, 0.09086181223392487, 0.09084481000900269, 0.0908278152346611, 0.0910646840929985, 0.09062755852937698], [0.09164454787969589, 0.09014590084552765, 0.09254120290279388, 0.09243893623352051, 0.08984736353158951, 0.09072556346654892, 0.09062530100345612, 0.09052515029907227, 0.09042510390281677, 0.09182767570018768, 0.0892532467842102], [0.09157532453536987, 0.090218186378479, 0.09238631278276443, 0.09229385107755661, 0.08994758874177933, 0.09074337035417557, 0.09065255522727966, 0.09056182950735092, 0.09047118574380875, 0.09174101799726486, 0.08940880745649338], [0.09150605648756027, 0.09029043465852737, 0.09223157912492752, 0.09214890003204346, 0.09004782140254974, 0.09076108038425446, 0.09067971259355545, 0.09059841930866241, 0.09051720052957535, 0.09165434539318085, 0.08956454694271088], [0.0914367288351059, 0.09036263823509216, 0.09207699447870255, 0.09200405329465866, 0.09014806151390076, 0.09077867865562439, 0.09070676565170288, 0.09063491970300674, 0.09056311845779419, 0.09156763553619385, 0.08972045034170151], [0.09239719063043594, 0.08935386687517166, 0.09424280375242233, 0.09403136372566223, 0.08875379711389542, 0.09052485972642899, 0.09032175689935684, 0.09011911600828171, 0.08991692215204239, 0.09277263283729553, 0.08756571263074875], [0.09061529487371445, 0.09121105819940567, 0.09026531130075455, 0.09030499309301376, 0.09133139252662659, 0.09097899496555328, 0.09101898223161697, 0.09105899184942245, 0.09109902381896973, 0.09054342657327652, 0.09157253801822662]], [[0.09178926050662994, 0.09066513180732727, 0.0923592671751976, 0.09057828783988953, 0.09227079898118973, 0.09156960994005203, 0.09044817835092545, 0.09105347096920013, 0.08543415367603302, 0.0917215496301651, 0.0921102985739708], [0.08644933253526688, 0.09149643778800964, 0.0840197429060936, 0.09190109372138977, 0.08439133316278458, 0.08740832656621933, 0.09251143038272858, 0.08971330523490906, 0.12029478698968887, 0.08674359321594238, 0.08507057279348373], [0.09410998225212097, 0.08978736400604248, 0.09635956585407257, 0.08945963531732559, 0.09600783884525299, 0.09325355291366577, 0.08897027373313904, 0.09126371145248413, 0.07157055288553238, 0.09384535998106003, 0.09537217766046524], [0.0859910175204277, 0.09150153398513794, 0.08334910124540329, 0.0919446051120758, 0.08375269919633865, 0.08703578263521194, 0.09261324256658554, 0.08955130726099014, 0.12345840036869049, 0.08631148189306259, 0.08449089527130127], [0.09376546740531921, 0.08994045853614807, 0.09574808925390244, 0.08964961022138596, 0.09543845057487488, 0.09300924837589264, 0.08921509981155396, 0.09124916791915894, 0.07357392460107803, 0.09353188425302505, 0.09487853199243546], [0.09082864224910736, 0.09092911332845688, 0.09077821671962738, 0.09093692898750305, 0.09078601747751236, 0.0908481702208519, 0.0909486636519432, 0.09089425206184387, 0.09141518920660019, 0.09083466231822968, 0.0908002033829689], [0.08529142290353775, 0.09149126708507538, 0.08233705163002014, 0.09199190139770508, 0.08278759568929672, 0.08646301925182343, 0.0927480161190033, 0.08929137885570526, 0.1283353865146637, 0.08565059304237366, 0.08361240476369858], [0.08841594308614731, 0.0913628488779068, 0.08697150647640228, 0.0915961042046547, 0.0871935561299324, 0.08898136019706726, 0.09194710850715637, 0.09032974392175674, 0.10701373219490051, 0.08858972042798996, 0.08759838342666626], [0.04711165651679039, 0.06957004964351654, 0.03873253986239433, 0.0717114508152008, 0.0399247407913208, 0.05082106217741966, 0.07504775375127792, 0.06077182665467262, 0.45589932799339294, 0.04822439327836037, 0.04218519851565361], [0.09149719774723053, 0.09075121581554413, 0.09187428653240204, 0.09069345891475677, 0.09181581437587738, 0.09135168045759201, 0.09060689061880112, 0.09100927412509918, 0.0872381329536438, 0.09145235270261765, 0.0917096808552742], [0.09312602877616882, 0.09020297974348068, 0.09463010728359222, 0.08997953683137894, 0.09439568966627121, 0.0925503820180893, 0.0896454006433487, 0.09120630472898483, 0.07734391838312149, 0.09294833987951279, 0.09397133439779282]], [[0.09224821627140045, 0.09412825852632523, 0.09393478184938431, 0.08909355849027634, 0.09354902058839798, 0.08604523539543152, 0.08586838096380234, 0.09016255289316177, 0.08997722715139389, 0.0925915390253067, 0.09240122139453888], [0.09288870543241501, 0.0957382470369339, 0.09544368088245392, 0.08817199617624283, 0.09485726058483124, 0.08369255065917969, 0.0834350436925888, 0.0897611454129219, 0.08948497474193573, 0.09340691566467285, 0.09311952441930771], [0.09282418340444565, 0.09557382762432098, 0.09528972208499908, 0.08826649188995361, 0.09472402185201645, 0.08393041789531708, 0.08368092030286789, 0.08980296552181244, 0.08953601121902466, 0.0933244377374649, 0.09304701536893845], [0.09110302478075027, 0.091363824903965, 0.09133719652891159, 0.09065497666597366, 0.09128395467996597, 0.09020889550447464, 0.0901826024055481, 0.09080830216407776, 0.09078183770179749, 0.09115098416805267, 0.09112441539764404], [0.09269458800554276, 0.09524513781070709, 0.0949818342924118, 0.08845514804124832, 0.09445742517709732, 0.08440756052732468, 0.08417422324419022, 0.08988600969314575, 0.08963752537965775, 0.0931590124964714, 0.09290148317813873], [0.0899067223072052, 0.08861540257930756, 0.08874624222517014, 0.09217819571495056, 0.08900850266218185, 0.09450826793909073, 0.09464780986309052, 0.09139320254325867, 0.09152814745903015, 0.08966755867004395, 0.08979994803667068], [0.08983445912599564, 0.08845356851816177, 0.08859341591596603, 0.09226691722869873, 0.08887378126382828, 0.0947665348649025, 0.09491636604070663, 0.0914258062839508, 0.09157035499811172, 0.08957859873771667, 0.0897202268242836], [0.09150131046772003, 0.09230954945087433, 0.0922267958521843, 0.09012395143508911, 0.09206151217222214, 0.08876662701368332, 0.08868704736232758, 0.09059371799230576, 0.09051250666379929, 0.09164959192276001, 0.09156742691993713], [0.09143302589654922, 0.09214625507593155, 0.09207326173782349, 0.09021586924791336, 0.09192745387554169, 0.08901431411504745, 0.08894380182027817, 0.09063123911619186, 0.0905594527721405, 0.09156393259763718, 0.09149139374494553], [0.09236744791269302, 0.09442431479692459, 0.09421246498823166, 0.08892473578453064, 0.0937901958823204, 0.08560866117477417, 0.08541659265756607, 0.09009010344743729, 0.08988797664642334, 0.09274277091026306, 0.09253469109535217], [0.09230148792266846, 0.0942603126168251, 0.09405865520238876, 0.08901830017566681, 0.09365662932395935, 0.0858502984046936, 0.08566663414239883, 0.09013031423091888, 0.0899374932050705, 0.09265906363725662, 0.09246083348989487]], [[0.09048428386449814, 0.08608405292034149, 0.08806003630161285, 0.09105668216943741, 0.08843100816011429, 0.09144028276205063, 0.08699356019496918, 0.08899041265249252, 0.11768030375242233, 0.08618183434009552, 0.08459758758544922], [0.09090980142354965, 0.09172135591506958, 0.09135100990533829, 0.09080766141414642, 0.09128256887197495, 0.09073962271213531, 0.09154965728521347, 0.09118001163005829, 0.08674891293048859, 0.09170278906822205, 0.092006616294384], [0.09084201604127884, 0.08923459053039551, 0.08996279537677765, 0.09104739129543304, 0.09009834378957748, 0.0911845713853836, 0.08957109600305557, 0.09030204266309738, 0.09980662912130356, 0.08927088230848312, 0.08867969363927841], [0.09035433828830719, 0.08532409369945526, 0.08757836371660233, 0.0910114049911499, 0.08800243586301804, 0.09145211428403854, 0.08636074513196945, 0.08864240348339081, 0.12220534682273865, 0.08543545752763748, 0.08363334089517593], [0.09080716967582703, 0.08875960856676102, 0.08968595415353775, 0.09106951951980591, 0.08985860645771027, 0.09124483168125153, 0.08918740600347519, 0.09011820703744888, 0.10240782797336578, 0.08880572021007538, 0.08805512636899948], [0.09025736153125763, 0.08481135964393616, 0.08724860846996307, 0.0909707099199295, 0.08770771324634552, 0.09144940972328186, 0.08593147248029709, 0.08840091526508331, 0.12530378997325897, 0.0849316418170929, 0.08298702538013458], [0.09090297669172287, 0.09058571606874466, 0.09073001146316528, 0.09094318747520447, 0.09075675904750824, 0.0909700021147728, 0.09065250307321548, 0.09079690277576447, 0.09259390085935593, 0.09059292823076248, 0.09047512710094452], [0.09074115753173828, 0.08803851157426834, 0.08925873041152954, 0.09108888357877731, 0.08948661386966705, 0.0913214460015297, 0.08860151469707489, 0.08982954174280167, 0.10642114281654358, 0.0880991518497467, 0.08711330592632294], [0.0662018284201622, 0.04621066525578499, 0.05442741885781288, 0.06928181648254395, 0.05610270798206329, 0.07141433656215668, 0.04984913766384125, 0.05871283635497093, 0.44045278429985046, 0.046590521931648254, 0.04075595363974571], [0.09091103821992874, 0.09159999340772629, 0.09128571301698685, 0.09082426130771637, 0.09122760593891144, 0.09076645225286484, 0.09145431220531464, 0.09114053100347519, 0.08736395835876465, 0.09158424288034439, 0.09184194356203079], [0.09083383530378342, 0.09354501962661743, 0.0923008918762207, 0.09049652516841888, 0.0920722484588623, 0.09027235954999924, 0.09296678751707077, 0.09173034876585007, 0.0777883231639862, 0.09348239004611969, 0.09451127052307129]]]}, "num_training_step_calls_per_iteration": 1, "evaluation": {"env_runners": {"module_to_env_connector": {"timers": {"connectors": {"remove_single_ts_time_rank_from_batch": 1.2532168952496568e-05, "get_actions": 4.2820353867561874e-05, "normalize_and_clip_actions": 8.354415756042957e-06, "listify_data_for_vector_env": 1.1343026853816327e-05, "tensor_to_numpy": 1.6304438863120688e-05, "un_batch_to_individual_items": 6.905102135885552e-06}}, "connector_pipeline_timer": 0.00012738519343938735}, "episode_len_max": 20, "num_agent_steps_sampled_lifetime": {"default_agent": 2000}, "num_module_steps_sampled_lifetime": {"default_policy": 2000}, "episode_return_max": 14.5, "env_reset_timer": 0.0005669332688104617, "rlmodule_inference_timer": 4.087317513707309e-05, "env_step_timer": 1.54963021162375e-05, "env_to_module_connector": {"timers": {"connectors": {"add_states_from_episodes_to_batch": 2.851419769477795e-06, "numpy_to_tensor": 1.2738256511184239e-05, "add_time_dim_to_batch_and_zero_pad": 7.439652382773095e-06, "add_observations_from_episodes_to_batch": 3.1873133455293274e-06, "batch_individual_items": 1.315611135077993e-05}}, "connector_pipeline_timer": 6.298467671851681e-05}, "episode_len_min": 20, "env_to_module_sum_episodes_length_out": 10.368238387501162, "env_to_module_sum_episodes_length_in": 10.368238387501162, "num_env_steps_sampled_lifetime": 25400, "num_agent_steps_sampled": {"default_agent": 400}, "weights_seq_no": 5.0, "module_episode_returns_mean": {"default_policy": 0.05}, "episode_len_mean": 20.0, "sample": 0.1266383852233638, "agent_episode_returns_mean": {"default_agent": 0.05}, "episode_return_mean": 0.05, "episode_return_min": -12.5, "num_episodes": 20, "episode_duration_sec_mean": 0.005644041660707444, "num_module_steps_sampled": {"default_policy": 400}, "num_episodes_lifetime": 100, "num_env_steps_sampled": 400, "time_between_sampling": 9.438696052408732}, "num_healthy_workers": 1, "actor_manager_num_outstanding_async_reqs": 0, "num_remote_worker_restarts": 0}, "num_env_steps_sampled_lifetime": -1842500.0, "fault_tolerance": {"num_healthy_workers": 0, "num_remote_worker_restarts": 0}, "env_runner_group": {"actor_manager_num_outstanding_async_reqs": 0}, "done": false, "training_iteration": 5, "trial_id": "b9446_00000", "date": "2025-08-11_18-35-03", "timestamp": 1754930103, "time_this_iter_s": 9.954381942749023, "time_total_s": 50.049986839294434, "pid": 11415, "hostname": "Mac", "node_ip": "127.0.0.1", "config": {"exploration_config": {}, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 2, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "env": "Umbrella", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": false, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 0, "create_local_env_runner": true, "num_envs_per_env_runner": 1, "gym_env_vectorize_mode": "SYNC", "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "episodes_to_numpy": true, "max_requests_in_flight_per_env_runner": 1, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "merge_env_runner_states": "training_only", "broadcast_env_runner_states": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "complete_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "sampler_perf_stats_ema_coef": null, "_is_online": true, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": "auto", "num_aggregator_actors_per_learner": 0, "max_requests_in_flight_per_aggregator_actor": 3, "local_gpu_idx": 0, "max_requests_in_flight_per_learner": 3, "gamma": 1, "lr": 0.0002715581955, "grad_clip": 0.5, "grad_clip_by": "global_norm", "_train_batch_size_per_learner": 5000, "train_batch_size": 4000, "num_epochs": 1, "minibatch_size": 1000, "shuffle_batch_per_epoch": true, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "log_std_clip_param": 20.0, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "_disable_preprocessor_api": false, "_disable_action_flattening": false}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {"intrinsic_reward_coeff": 0.2795015916508}, "optimizer": {}, "_learner_class": "<class 'source.intrinsic_attention_ppo.learners.IntrinsicAttentionMetaLearner.IntrinsicAttentionMetaLearner'>", "callbacks_on_algorithm_init": null, "callbacks_on_env_runners_recreated": null, "callbacks_on_offline_eval_runners_recreated": null, "callbacks_on_checkpoint_loaded": null, "callbacks_on_environment_created": null, "callbacks_on_episode_created": null, "callbacks_on_episode_start": null, "callbacks_on_episode_step": null, "callbacks_on_episode_end": null, "callbacks_on_evaluate_start": null, "callbacks_on_evaluate_end": null, "callbacks_on_evaluate_offline_start": null, "callbacks_on_evaluate_offline_end": null, "callbacks_on_sample_end": null, "callbacks_on_train_result": null, "explore": true, "enable_rl_module_and_learner": true, "enable_env_runner_and_connector_v2": true, "_prior_exploration_config": {"type": "StochasticSampling"}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x3884998a0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "offline_data_class": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_read_batch_size": null, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "materialize_data": false, "materialize_mapped_data": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "ignore_final_observation": false, "prelearner_class": null, "prelearner_buffer_class": null, "prelearner_buffer_kwargs": {}, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_remaining_data": false, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": 1, "evaluation_duration": 20, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_auto_duration_min_env_steps_per_sample": 100, "evaluation_auto_duration_max_env_steps_per_sample": 2000, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 1, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "offline_evaluation_interval": null, "num_offline_eval_runners": 0, "offline_loss_for_module_fn": null, "offline_evaluation_duration": 1, "offline_evaluation_parallel_to_training": false, "offline_evaluation_timeout_s": 120.0, "num_cpus_per_offline_eval_runner": 1, "num_gpus_per_offline_eval_runner": 0, "custom_resources_per_offline_eval_runner": {}, "restart_failed_offline_eval_runners": true, "ignore_offline_eval_runner_failures": false, "max_num_offline_eval_runner_restarts": 1000, "offline_eval_runner_restore_timeout_s": 1800.0, "max_requests_in_flight_per_offline_eval_runner": 1, "validate_offline_eval_runners_after_construction": true, "offline_eval_runner_health_probe_timeout_s": 30.0, "offline_eval_rl_module_inference_only": false, "broadcast_offline_eval_runner_states": false, "offline_eval_batch_size_per_runner": 256, "dataset_num_iters_per_eval_runner": 1, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "log_gradients": false, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 7, "restart_failed_env_runners": true, "ignore_env_runner_failures": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30.0, "env_runner_restore_timeout_s": 1800.0, "_model_config": {}, "_rl_module_spec": "MultiRLModuleSpec(multi_rl_module_class=<class 'ray.rllib.core.rl_module.multi_rl_module.MultiRLModule'>, observation_space=None, action_space=None, inference_only=False, model_config=None, rl_module_specs={'default_policy': RLModuleSpec(module_class=<class 'source.intrinsic_attention_ppo.rl_modules.DifferentiablePPOModule.DifferentiablePPOModule'>, observation_space=None, action_space=None, inference_only=False, learner_only=False, model_config={'vf_share_layers': True, 'embedding_dim': 62, 'max_seq_len': 11, 'policy_head_hidden_sizes': [32], 'value_head_hidden_sizes': [101], 'embedding_hidden_sizes': [121]}, catalog_class=None, load_state_path=None, model_config_dict=None), 'intrinsic_reward_module': RLModuleSpec(module_class=<class 'source.intrinsic_attention_ppo.rl_modules.IntrinsicAttentionModule.IntrinsicAttentionModule'>, observation_space=None, action_space=None, inference_only=False, learner_only=True, model_config={'intrinsic_reward_network': {'encoder_hidden_sizes': [], 'encoding_dim': 1, 'num_heads': 1, 'head_hidden_sizes': None, 'layers': [{'type': 'attention'}]}, 'extrinsic_value_hidden_layers': [127, 60], 'vf_share_layers': True, 'max_seq_len': 11}, catalog_class=None, load_state_path=None, model_config_dict=None)}, load_state_path=None, modules_to_load=None, module_specs={'default_policy': RLModuleSpec(module_class=<class 'source.intrinsic_attention_ppo.rl_modules.DifferentiablePPOModule.DifferentiablePPOModule'>, observation_space=None, action_space=None, inference_only=False, learner_only=False, model_config={'vf_share_layers': True, 'embedding_dim': 62, 'max_seq_len': 11, 'policy_head_hidden_sizes': [32], 'value_head_hidden_sizes': [101], 'embedding_hidden_sizes': [121]}, catalog_class=None, load_state_path=None, model_config_dict=None), 'intrinsic_reward_module': RLModuleSpec(module_class=<class 'source.intrinsic_attention_ppo.rl_modules.IntrinsicAttentionModule.IntrinsicAttentionModule'>, observation_space=None, action_space=None, inference_only=False, learner_only=True, model_config={'intrinsic_reward_network': {'encoder_hidden_sizes': [], 'encoding_dim': 1, 'num_heads': 1, 'head_hidden_sizes': None, 'layers': [{'type': 'attention'}]}, 'extrinsic_value_hidden_layers': [127, 60], 'vf_share_layers': True, 'max_seq_len': 11}, catalog_class=None, load_state_path=None, model_config_dict=None)})", "algorithm_config_overrides_per_module": {"intrinsic_reward_module": {"lr": 0.0002715581955}}, "_per_module_overrides": {}, "_validate_config": true, "_use_msgpack_checkpoints": false, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "env_task_fn": -1, "enable_connectors": -1, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.161583927863, "kl_target": 0.0201019014258, "vf_loss_coeff": 0.7790510010087, "entropy_coeff": 0.0015431216992, "clip_param": 0.2459212356676, "vf_clip_param": 0.3769744131561, "entropy_coeff_schedule": null, "lr_schedule": null, "sgd_minibatch_size": -1, "vf_share_layers": -1, "differentiable_learner_configs": ["DifferentiableLearnerConfig(learner_class=<class 'source.intrinsic_attention_ppo.learners.IntrinsicAttentionPPOLearner.IntrinsicAttentionPPOLearner'>, learner_connector=None, add_default_connectors_to_learner_pipeline=True, is_multi_agent=False, policies_to_update=['default_policy'], lr=0.0060984166342, num_total_minibatches=0, num_epochs=1, minibatch_size=1000, shuffle_batch_per_epoch=True)"], "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9485408017724, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.callbacks.callbacks.RLlibCallback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 50.049986839294434, "iterations_since_restore": 5, "perf": {"cpu_util_percent": 42.92857142857143, "ram_util_percent": 80.37142857142858}}
{"timers": {"training_iteration": 10.209666971903284, "restore_env_runners": 1.2829596408469917e-05, "training_step": 10.209462951461248, "env_runner_sampling_timer": 2.561673333031298, "learner_update_timer": 7.396611426398975, "synch_weights": 0.001778654423108503, "restore_eval_env_runners": 4.52519806656614e-05, "evaluation_iteration": 0.13833458760892062, "synch_eval_env_connectors": 0.00018416762484619505, "synch_env_connectors": 4.751596323447302e-06}, "env_runners": {"env_reset_timer": 4.377408728514031e-05, "num_episodes_lifetime": -123000.0, "num_env_steps_sampled_lifetime": -2460000.0, "num_env_steps_sampled": 5000.0, "module_to_env_connector": {"timers": {"connectors": {"remove_single_ts_time_rank_from_batch": 1.2033957233943071e-05, "get_actions": 3.963993755651007e-05, "listify_data_for_vector_env": 1.065995459532938e-05, "tensor_to_numpy": 1.544648941594969e-05, "un_batch_to_individual_items": 6.7909967729153195e-06, "normalize_and_clip_actions": 8.143353527856364e-06}}, "connector_pipeline_timer": 0.00011923508867748698}, "module_episode_returns_mean": {"default_policy": -0.3}, "time_between_sampling": 0.03440522857893252, "rlmodule_inference_timer": 3.1979546187616084e-05, "env_step_timer": 1.4140638734931268e-05, "env_to_module_connector": {"timers": {"connectors": {"batch_individual_items": 1.2692135442168538e-05, "add_observations_from_episodes_to_batch": 2.9238093875937275e-06, "add_states_from_episodes_to_batch": 2.742352204214137e-06, "numpy_to_tensor": 1.275731858635616e-05, "add_time_dim_to_batch_and_zero_pad": 7.274557551296889e-06}}, "connector_pipeline_timer": 6.045640381026856e-05}, "weights_seq_no": 5.0, "num_agent_steps_sampled": {"default_agent": 5000.0}, "episode_len_min": 20, "episode_len_mean": 20.0, "num_episodes": 250.0, "sample": 0.005714759821833481, "episode_duration_sec_mean": 0.00532643667748198, "episode_len_max": 20, "num_module_steps_sampled": {"default_policy": 5000.0}, "num_agent_steps_sampled_lifetime": {"default_agent": -2460000.0}, "num_module_steps_sampled_lifetime": {"default_policy": -2460000.0}, "env_to_module_sum_episodes_length_out": 10.36823839457432, "agent_episode_returns_mean": {"default_agent": -0.3}, "episode_return_max": 10.5, "episode_return_min": -9.5, "env_to_module_sum_episodes_length_in": 10.36823839457432, "episode_return_mean": -0.3, "num_env_steps_sampled_lifetime_throughput": 3211.1517636055814}, "__all_modules__": {"learner_connector_sum_episodes_length_in": 5000.0, "learner_connector": {"connector_pipeline_timer": 0.2094792706308528, "timers": {"connectors": {"add_one_ts_to_episodes_and_truncate": 0.009050672003385905, "add_observations_from_episodes_to_batch": 0.0009598276029507433, "add_columns_from_episodes_to_train_batch": 0.09915772058541791, "add_time_dim_to_batch_and_zero_pad": 0.08776602212665013, "add_states_from_episodes_to_batch": 0.0035988318168838824, "batch_individual_items": 0.008657888070231292, "numpy_to_tensor": 8.785487659862674e-05}}}, "learner_connector_sum_episodes_length_out": 5250.0}, "learners": {"differentiable_learners": {"intrinsic_attention_ppo_learner": {"intrinsic_reward_module": {"num_module_steps_trained_lifetime": 215460, "weights_seq_no": 36.0, "total_loss": 0.0, "num_module_steps_trained": 35910, "diff_num_grad_updates_vs_sampler_policy": 31.0, "module_train_batch_size_mean": 997.5548130830801}, "default_policy": {"module_train_batch_size_mean": 997.5548130830801, "use_intrinsic_rewards": 1.0, "num_module_steps_trained_lifetime": 215460, "policy_loss": -8.297670319734607e-06, "mean_kl_loss": 3.601256366891903e-06, "entropy": 0.6907342076301575, "weights_seq_no": 36.0, "vf_loss_unclipped": 43.05610275268555, "vf_loss": 0.3584098219871521, "total_loss": 0.278145968914032, "vf_explained_var": -0.0019237995147705078, "num_module_steps_trained": 35910, "diff_num_grad_updates_vs_sampler_policy": 31.0}, "__all_modules__": {"num_env_steps_trained_lifetime": 1188000, "num_module_steps_trained": 71820, "num_module_steps_trained_lifetime": 430920, "num_env_steps_trained": 198000, "num_env_steps_trained_lifetime_throughput": 54785.87637866592}}}, "intrinsic_reward_module": {"num_module_steps_trained": 5985, "curr_entropy_coeff": 0.0015431216992, "total_loss": 0.0, "num_module_steps_trained_lifetime": 35910, "gradients_default_optimizer_global_norm": 0.0, "diff_num_grad_updates_vs_sampler_policy": 1.0, "module_train_batch_size_mean": 997.8474438281662, "default_optimizer_learning_rate": 0.0002715581955, "num_trainable_parameters": 8266, "weights_seq_no": 6.0, "num_module_steps_trained_lifetime_throughput": 817.5299508757369}, "__all_modules__": {"num_trainable_parameters": 24861, "num_non_trainable_parameters": 0, "num_env_steps_trained_lifetime": 198000, "num_module_steps_trained": 11970, "num_module_steps_trained_lifetime": 71820, "num_env_steps_trained": 33000, "num_env_steps_trained_lifetime_throughput": 4509.380718687419, "num_module_steps_trained_throughput": 29149213.93811319, "num_module_steps_trained_lifetime_throughput": 13371833.718164805}, "default_policy": {"vf_loss": 0.35830503702163696, "weights_seq_no": 6.0, "curr_entropy_coeff": 0.0015431216992, "vf_loss_unclipped": 43.023677825927734, "total_loss": 0.2780616283416748, "vf_explained_var": 0.00044918060302734375, "num_module_steps_trained": 5985, "diff_num_grad_updates_vs_sampler_policy": 1.0, "curr_kl_coeff": 0.0025247489102184772, "use_intrinsic_rewards": 0.0, "module_train_batch_size_mean": 997.8474438281662, "num_module_steps_trained_lifetime": 35910, "policy_loss": -1.0399597158539109e-05, "num_trainable_parameters": 16595, "mean_kl_loss": 3.458177843640442e-06, "entropy": 0.6907306909561157, "num_module_steps_trained_lifetime_throughput": 817.512973689013}, "IntrinsicAttentionMask": [[[0.0910537987947464, 0.09110148996114731, 0.0899772197008133, 0.0911969393491745, 0.09124469757080078, 0.0908254086971283, 0.09087298065423965, 0.09092056751251221, 0.09096818417310715, 0.09148388355970383, 0.09035489708185196], [0.09108246117830276, 0.09113968908786774, 0.08979227393865585, 0.09125423431396484, 0.09131155908107758, 0.09080850332975388, 0.09086555242538452, 0.09092263132333755, 0.09097974747419357, 0.09159873425960541, 0.09024453908205032], [0.0903857871890068, 0.09021884202957153, 0.09426249563694, 0.0898858830332756, 0.08971986174583435, 0.091190867125988, 0.09102243185043335, 0.09085431694984436, 0.09068651497364044, 0.08889435231685638, 0.09287863969802856], [0.09113964438438416, 0.09121595323085785, 0.08942335844039917, 0.09136874973773956, 0.09144524484872818, 0.0907745212316513, 0.09085051715373993, 0.09092658013105392, 0.09100271016359329, 0.09182868897914886, 0.09002406150102615], [0.09116813540458679, 0.09125398844480515, 0.08923935890197754, 0.09142594784498215, 0.0915120542049408, 0.09075742214918137, 0.09084289520978928, 0.09092844277620316, 0.0910140797495842, 0.09194377064704895, 0.08991391211748123], [0.09091538935899734, 0.0909174457192421, 0.09086859226226807, 0.09092157334089279, 0.09092362970113754, 0.09090550243854523, 0.09090756624937057, 0.09090962260961533, 0.09091168642044067, 0.09093393385410309, 0.09088506549596786], [0.09094436466693878, 0.09095592051744461, 0.09068217128515244, 0.09097904711961746, 0.09099061042070389, 0.09088893979787827, 0.0909004881978035, 0.09091204404830933, 0.09092359989881516, 0.09104844927787781, 0.09077442437410355], [0.09097326546907425, 0.09099432826042175, 0.09049604833126068, 0.09103647619485855, 0.09105755388736725, 0.09087228775024414, 0.09089332818984985, 0.09091437608003616, 0.09093542397022247, 0.0911630243062973, 0.09066382050514221], [0.09100212156772614, 0.09103269129991531, 0.09031025320291519, 0.09109388291835785, 0.09112448990345001, 0.09085558354854584, 0.09088611602783203, 0.09091665595769882, 0.09094720333814621, 0.09127768874168396, 0.09055330604314804], [0.09130967408418655, 0.09144339710474014, 0.08832401037216187, 0.09171143919229507, 0.09184575080871582, 0.09067095071077347, 0.09080373495817184, 0.09093672037124634, 0.09106990694999695, 0.09252028167247772, 0.08936416357755661], [0.09062465280294418, 0.09053286910057068, 0.09273484349250793, 0.09034959226846695, 0.09025809168815613, 0.09106619656085968, 0.09097396582365036, 0.0908818319439888, 0.090789794921875, 0.08980196714401245, 0.09198615700006485]], [[0.09088948369026184, 0.08646955341100693, 0.08397615700960159, 0.09146445244550705, 0.08882701396942139, 0.09184977412223816, 0.08738313615322113, 0.08938892930746078, 0.11820729076862335, 0.08656776696443558, 0.084976427257061], [0.09083258360624313, 0.09164345264434814, 0.09212273359298706, 0.09073053300380707, 0.09120503813028336, 0.09066256135702133, 0.09147190302610397, 0.09110256284475327, 0.0866752341389656, 0.0916249081492424, 0.09192846715450287], [0.09033627063035965, 0.09433970600366592, 0.09677154570817947, 0.08984211832284927, 0.09215802699327469, 0.08951418846845627, 0.09348118305206299, 0.09165391325950623, 0.07187657058238983, 0.09424658864736557, 0.09577993303537369], [0.0908152386546135, 0.08575933426618576, 0.0829240009188652, 0.09147565811872482, 0.0884513333439827, 0.09191861003637314, 0.08680126816034317, 0.08909456431865692, 0.12282870709896088, 0.08587127178907394, 0.08405996859073639], [0.09099887311458588, 0.08894698321819305, 0.08776430040597916, 0.09126176685094833, 0.09004830569028854, 0.0914374589920044, 0.08937568962574005, 0.09030845761299133, 0.10262402147054672, 0.08899319171905518, 0.08824101090431213], [0.09075462818145752, 0.08527862280607224, 0.08221979439258575, 0.09147190302610397, 0.08819093555212021, 0.09195324033498764, 0.08640490472316742, 0.08888795226812363, 0.12599413096904755, 0.0853995680809021, 0.08344423770904541], [0.09093298017978668, 0.09061560779809952, 0.09042985737323761, 0.09097320586442947, 0.09078671783208847, 0.0910000279545784, 0.09068242460489273, 0.09082687646150589, 0.09262446314096451, 0.09062282741069794, 0.09050498157739639], [0.09099310636520386, 0.08828295022249222, 0.08673003315925598, 0.09134180098772049, 0.08973507583141327, 0.0915750041604042, 0.08884751796722412, 0.09007895737886429, 0.10671662539243698, 0.08834375441074371, 0.08735516667366028], [0.06734725087881088, 0.047010209411382675, 0.038067713379859924, 0.07048052549362183, 0.05707339942455292, 0.07264993339776993, 0.05071162432432175, 0.05972868576645851, 0.4480728209018707, 0.047396641224622726, 0.04146111011505127], [0.09084552526473999, 0.09153398126363754, 0.0919404849410057, 0.0907588079571724, 0.09116186946630478, 0.09070104360580444, 0.09138841181993484, 0.0910748541355133, 0.08730100095272064, 0.09151825308799744, 0.09177576005458832], [0.09057361632585526, 0.09327704459428787, 0.0949011743068695, 0.09023728221654892, 0.0918084904551506, 0.09001374989748001, 0.09270046651363373, 0.09146756678819656, 0.07756548374891281, 0.09321458637714386, 0.09424052387475967]], [[0.09486453235149384, 0.09199821203947067, 0.09180910885334015, 0.09162040054798126, 0.09143207967281342, 0.09310205280780792, 0.08830375224351883, 0.08812224864959717, 0.08794111758470535, 0.09049626439809799, 0.09031025320291519], [0.09185997396707535, 0.09117711335420609, 0.09113150089979172, 0.09108591079711914, 0.09104034304618835, 0.09144196659326553, 0.09027279168367386, 0.0902276337146759, 0.09018249809741974, 0.09081284701824188, 0.09076741337776184], [0.09166093915700912, 0.09112133830785751, 0.0910852700471878, 0.0910492092370987, 0.09101316332817078, 0.09133072942495346, 0.09040544927120209, 0.09036965668201447, 0.09033387899398804, 0.0908331498503685, 0.09079719334840775], [0.09146221727132797, 0.09106548130512238, 0.09103894233703613, 0.09101240336894989, 0.09098587185144424, 0.09121950715780258, 0.09053817391395569, 0.09051177650690079, 0.09048540145158768, 0.09085334092378616, 0.0908268615603447], [0.0912638008594513, 0.09100953489542007, 0.0909925103187561, 0.09097548574209213, 0.09095846861600876, 0.0911082923412323, 0.09067096561193466, 0.09065400809049606, 0.09063704311847687, 0.09087341278791428, 0.0908564105629921], [0.09301979839801788, 0.09149866551160812, 0.09139754623174667, 0.09129653871059418, 0.09119565039873123, 0.0920870304107666, 0.08950532227754593, 0.08940640836954117, 0.08930760622024536, 0.09069284051656723, 0.09059261530637741], [0.08795341104269028, 0.09004995971918106, 0.09019233286380768, 0.0903349369764328, 0.09047776460647583, 0.089229054749012, 0.09292890876531601, 0.09307584166526794, 0.09322299808263779, 0.09119529277086258, 0.09133948385715485], [0.08776051551103592, 0.08999248594045639, 0.09014418721199036, 0.09029614180326462, 0.09044834971427917, 0.08911814540624619, 0.09306298941373825, 0.09321986883878708, 0.0933770090341568, 0.09121326357126236, 0.09136702120304108], [0.08756792545318604, 0.08993493020534515, 0.09009594470262527, 0.09025724232196808, 0.09041883051395416, 0.08900725096464157, 0.09319714456796646, 0.09336399286985397, 0.09353114664554596, 0.09123112261295319, 0.09139444679021835], [0.09027637541294098, 0.0907285213470459, 0.09075891971588135, 0.09078933298587799, 0.09081976115703583, 0.09055247902870178, 0.09133607149124146, 0.09136668592691422, 0.09139730036258698, 0.09097202867269516, 0.09100251644849777], [0.09007981419563293, 0.09067205339670181, 0.09071191400289536, 0.0907517820596695, 0.09079167991876602, 0.09044136106967926, 0.09146931022405624, 0.09150952100753784, 0.09154974669218063, 0.09099140018224716, 0.09103140234947205]], [[0.09144821763038635, 0.09298789501190186, 0.09068434685468674, 0.09310871362686157, 0.09080217778682709, 0.09322969615459442, 0.09180515259504318, 0.0909792110323906, 0.08303456753492355, 0.09153971076011658, 0.09038034081459045], [0.0929153561592102, 0.10123548656702042, 0.08899706602096558, 0.1019129529595375, 0.08959262818098068, 0.10259494930505753, 0.09479322284460068, 0.09049345552921295, 0.05659596994519234, 0.09339378774166107, 0.08747518807649612], [0.09023790806531906, 0.08862806856632233, 0.0910576805472374, 0.08850407600402832, 0.09093029797077179, 0.08838026970624924, 0.08985970914363861, 0.09073954820632935, 0.10013376921415329, 0.0901406854391098, 0.09138794243335724], [0.09298314154148102, 0.10185495018959045, 0.08882198482751846, 0.10257940739393234, 0.08945373445749283, 0.10330900549888611, 0.09498132765293121, 0.09040980041027069, 0.05490575358271599, 0.09349198639392853, 0.0872088298201561], [0.09044822305440903, 0.0893130674958229, 0.09102395921945572, 0.0892253890633583, 0.09093459695577621, 0.08913778513669968, 0.0901820957660675, 0.09080071747303009, 0.0972987487912178, 0.09037984907627106, 0.09125546365976334], [0.09304488450288773, 0.10247150808572769, 0.0886414423584938, 0.10324345529079437, 0.0893092155456543, 0.10402122884988785, 0.09516358375549316, 0.09032031148672104, 0.053262535482645035, 0.09358416497707367, 0.08693761378526688], [0.09189635515213013, 0.09496147930622101, 0.09039399772882462, 0.09520409256219864, 0.09062494337558746, 0.09544733166694641, 0.09260252118110657, 0.09097247570753098, 0.07602016627788544, 0.0920770913362503, 0.08979947119951248], [0.09074760973453522, 0.09033356606960297, 0.09095633774995804, 0.09030143916606903, 0.09092399477958679, 0.09026933461427689, 0.09065083414316177, 0.09087549895048141, 0.09317852556705475, 0.09072276204824448, 0.09104003757238388], [0.0531100258231163, 0.03622780367732048, 0.0643637627363205, 0.03516589105129242, 0.06247711554169655, 0.03413509204983711, 0.0485752634704113, 0.059750333428382874, 0.48477640748023987, 0.05190714821219444, 0.06951117515563965], [0.09156986325979233, 0.09349749982357025, 0.09061648696660995, 0.09364909678697586, 0.09076341986656189, 0.09380094707012177, 0.09201601892709732, 0.09098426252603531, 0.08118068426847458, 0.09168417751789093, 0.09023761004209518], [0.08965308964252472, 0.08683905005455017, 0.09110108017921448, 0.08662393689155579, 0.09087540954351425, 0.08640936017036438, 0.08898849040269852, 0.09053795039653778, 0.1078023761510849, 0.08948203176259995, 0.09168728440999985]], [[0.09181805700063705, 0.09368932992219925, 0.09349675476551056, 0.0933045744895935, 0.09311279654502869, 0.09011217951774597, 0.08992696553468704, 0.08529230207204819, 0.08511698991060257, 0.09215977042913437, 0.09197033941745758], [0.09223756194114685, 0.09506712853908539, 0.09477461874485016, 0.09448301792144775, 0.09419231116771698, 0.08968295902013779, 0.08940701931715012, 0.08259526640176773, 0.08234113454818726, 0.09275214374065399, 0.09246676415205002], [0.0921957790851593, 0.09492681175470352, 0.09464462101459503, 0.094363272190094, 0.09408276528120041, 0.08972769975662231, 0.08946096897125244, 0.0828673467040062, 0.0826210081577301, 0.09269265085458755, 0.09241710603237152], [0.09215376526117325, 0.09478644281625748, 0.09451454132795334, 0.09424342215061188, 0.0939730778336525, 0.08977221697568893, 0.08951469510793686, 0.08314009755849838, 0.08290160447359085, 0.09263294190168381, 0.09236721694469452], [0.09211152046918869, 0.09464602917432785, 0.09438438713550568, 0.0941234678030014, 0.09386327117681503, 0.08981651812791824, 0.08956822007894516, 0.08341352641582489, 0.0831829309463501, 0.09257302433252335, 0.0923171117901802], [0.09140857309103012, 0.0924050435423851, 0.09230292588472366, 0.09220091253519058, 0.09209901839494705, 0.09049196541309357, 0.09039195626974106, 0.08785777539014816, 0.08776067942380905, 0.0915912389755249, 0.0914900153875351], [0.09136248379945755, 0.09226392954587936, 0.09217158704996109, 0.09207934141159058, 0.09198719263076782, 0.09053246676921844, 0.09044186025857925, 0.08814267814159393, 0.08805446326732635, 0.0915277972817421, 0.09143619984388351], [0.09009896218776703, 0.08862320333719254, 0.08877259492874146, 0.08892223984003067, 0.08907213062047958, 0.09149276465177536, 0.09164699167013168, 0.09570378065109253, 0.09586510807275772, 0.08982540667057037, 0.08997682482004166], [0.09004676342010498, 0.08848121017217636, 0.08863962441682816, 0.08879830688238144, 0.0889572873711586, 0.09152683615684509, 0.09169069677591324, 0.09600690752267838, 0.09617879241704941, 0.08975644409656525, 0.0899171382188797], [0.09189692884683609, 0.09394332021474838, 0.093732550740242, 0.09352225065231323, 0.09331241995096207, 0.09003473818302155, 0.08983273804187775, 0.08479081839323044, 0.08460058271884918, 0.09227034449577332, 0.09206332266330719], [0.09185332804918289, 0.09380264580249786, 0.09360196441411972, 0.0934017151594162, 0.0932018905878067, 0.0900777131319046, 0.08988501131534576, 0.08506830781698227, 0.08488631248474121, 0.09220917522907257, 0.09201190620660782]], [[0.09131461381912231, 0.09137391299009323, 0.09055185317993164, 0.09149264544248581, 0.09213623404502869, 0.09309348464012146, 0.0931539461016655, 0.09231586754322052, 0.08291324973106384, 0.0914059653878212, 0.09024829417467117], [0.09137246012687683, 0.09144135564565659, 0.0904870480298996, 0.09157929569482803, 0.0923275426030159, 0.09344199299812317, 0.09351244568824768, 0.09253652393817902, 0.08168771862983704, 0.09147858619689941, 0.09013500809669495], [0.09037945419549942, 0.09031621366739273, 0.09120051562786102, 0.0901898592710495, 0.08951082825660706, 0.0885188952088356, 0.08845695853233337, 0.08932305872440338, 0.10029083490371704, 0.09028207510709763, 0.09153129905462265], [0.0914822369813919, 0.09157034009695053, 0.09035162627696991, 0.09174679219722748, 0.09270521253347397, 0.09413672238588333, 0.0942273736000061, 0.09297329932451248, 0.07928551733493805, 0.09161795675754547, 0.08990293741226196], [0.09194423258304596, 0.09213659912347794, 0.08949468284845352, 0.09252254664897919, 0.09463410079479218, 0.09783585369586945, 0.09804054349660873, 0.09522934257984161, 0.06738888472318649, 0.09224066138267517, 0.088532455265522], [0.09226208925247192, 0.09260895848274231, 0.08789569139480591, 0.09330661594867706, 0.0971645787358284, 0.10314609110355377, 0.10353387892246246, 0.09826460480690002, 0.05281442031264305, 0.09279683977365494, 0.08620619773864746], [0.09226901829242706, 0.09262558817863464, 0.08778378367424011, 0.0933428630232811, 0.09731198102235794, 0.1034744530916214, 0.1038743257522583, 0.09844452142715454, 0.052004747092723846, 0.0928187370300293, 0.08604994416236877], [0.09203559160232544, 0.0922570452094078, 0.08922173082828522, 0.09270156174898148, 0.09513846784830093, 0.09884906560182571, 0.09908691793680191, 0.0958268940448761, 0.06438623368740082, 0.09237687289714813, 0.08811953663825989], [0.05423945188522339, 0.05343860387802124, 0.06573252379894257, 0.05187220126390457, 0.044175926595926285, 0.034861009567976, 0.034346286207437515, 0.042247895151376724, 0.4950856864452362, 0.053011007606983185, 0.07098939269781113], [0.09140288829803467, 0.09147696197032928, 0.09045124053955078, 0.09162528812885284, 0.09243017435073853, 0.09362990409135818, 0.09370578080415726, 0.09265507757663727, 0.0810326486825943, 0.09151699393987656, 0.09007306396961212], [0.08990149945020676, 0.08979008346796036, 0.09135350584983826, 0.08956766128540039, 0.08837643265724182, 0.08664879202842712, 0.08654139935970306, 0.08804825693368912, 0.10810107737779617, 0.08972997218370438, 0.09194133430719376]]]}, "num_training_step_calls_per_iteration": 1, "evaluation": {"env_runners": {"module_to_env_connector": {"timers": {"connectors": {"remove_single_ts_time_rank_from_batch": 1.1898692464798052e-05, "get_actions": 3.5019485596258474e-05, "normalize_and_clip_actions": 7.882365274015562e-06, "listify_data_for_vector_env": 1.0373539131871532e-05, "tensor_to_numpy": 1.457994059327725e-05, "un_batch_to_individual_items": 6.420746447041465e-06}}, "connector_pipeline_timer": 0.00011251514316678296}, "episode_len_max": 20, "num_agent_steps_sampled_lifetime": {"default_agent": 2400}, "num_module_steps_sampled_lifetime": {"default_policy": 2400}, "episode_return_max": 14.5, "env_reset_timer": 0.0005620114365755014, "rlmodule_inference_timer": 3.0010558449050067e-05, "env_step_timer": 1.3775873771027504e-05, "env_to_module_connector": {"timers": {"connectors": {"add_states_from_episodes_to_batch": 2.699915404680144e-06, "numpy_to_tensor": 1.168850400929913e-05, "add_time_dim_to_batch_and_zero_pad": 7.117882593340517e-06, "add_observations_from_episodes_to_batch": 2.8277368011768537e-06, "batch_individual_items": 1.2500839518437975e-05}}, "connector_pipeline_timer": 5.920691543612547e-05}, "episode_len_min": 20, "env_to_module_sum_episodes_length_out": 10.368238394470474, "env_to_module_sum_episodes_length_in": 10.368238394470474, "num_env_steps_sampled_lifetime": 30400, "num_agent_steps_sampled": {"default_agent": 400}, "weights_seq_no": 6.0, "module_episode_returns_mean": {"default_policy": 0.25}, "episode_len_mean": 20.0, "sample": 0.1264855272108855, "agent_episode_returns_mean": {"default_agent": 0.25}, "episode_return_mean": 0.25, "episode_return_min": -12.5, "num_episodes": 20, "episode_duration_sec_mean": 0.005516915407497436, "num_module_steps_sampled": {"default_policy": 400}, "num_episodes_lifetime": 120, "num_env_steps_sampled": 400, "time_between_sampling": 9.437800817714308}, "num_healthy_workers": 1, "actor_manager_num_outstanding_async_reqs": 0, "num_remote_worker_restarts": 0}, "num_env_steps_sampled_lifetime": -2460000.0, "fault_tolerance": {"num_healthy_workers": 0, "num_remote_worker_restarts": 0}, "env_runner_group": {"actor_manager_num_outstanding_async_reqs": 0}, "done": false, "training_iteration": 6, "trial_id": "b9446_00000", "date": "2025-08-11_18-35-13", "timestamp": 1754930113, "time_this_iter_s": 9.431490182876587, "time_total_s": 59.48147702217102, "pid": 11415, "hostname": "Mac", "node_ip": "127.0.0.1", "config": {"exploration_config": {}, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 2, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "env": "Umbrella", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": false, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 0, "create_local_env_runner": true, "num_envs_per_env_runner": 1, "gym_env_vectorize_mode": "SYNC", "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "episodes_to_numpy": true, "max_requests_in_flight_per_env_runner": 1, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "merge_env_runner_states": "training_only", "broadcast_env_runner_states": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "complete_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "sampler_perf_stats_ema_coef": null, "_is_online": true, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": "auto", "num_aggregator_actors_per_learner": 0, "max_requests_in_flight_per_aggregator_actor": 3, "local_gpu_idx": 0, "max_requests_in_flight_per_learner": 3, "gamma": 1, "lr": 0.0002715581955, "grad_clip": 0.5, "grad_clip_by": "global_norm", "_train_batch_size_per_learner": 5000, "train_batch_size": 4000, "num_epochs": 1, "minibatch_size": 1000, "shuffle_batch_per_epoch": true, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "log_std_clip_param": 20.0, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "_disable_preprocessor_api": false, "_disable_action_flattening": false}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {"intrinsic_reward_coeff": 0.2795015916508}, "optimizer": {}, "_learner_class": "<class 'source.intrinsic_attention_ppo.learners.IntrinsicAttentionMetaLearner.IntrinsicAttentionMetaLearner'>", "callbacks_on_algorithm_init": null, "callbacks_on_env_runners_recreated": null, "callbacks_on_offline_eval_runners_recreated": null, "callbacks_on_checkpoint_loaded": null, "callbacks_on_environment_created": null, "callbacks_on_episode_created": null, "callbacks_on_episode_start": null, "callbacks_on_episode_step": null, "callbacks_on_episode_end": null, "callbacks_on_evaluate_start": null, "callbacks_on_evaluate_end": null, "callbacks_on_evaluate_offline_start": null, "callbacks_on_evaluate_offline_end": null, "callbacks_on_sample_end": null, "callbacks_on_train_result": null, "explore": true, "enable_rl_module_and_learner": true, "enable_env_runner_and_connector_v2": true, "_prior_exploration_config": {"type": "StochasticSampling"}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x3884998a0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "offline_data_class": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_read_batch_size": null, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "materialize_data": false, "materialize_mapped_data": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "ignore_final_observation": false, "prelearner_class": null, "prelearner_buffer_class": null, "prelearner_buffer_kwargs": {}, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_remaining_data": false, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": 1, "evaluation_duration": 20, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_auto_duration_min_env_steps_per_sample": 100, "evaluation_auto_duration_max_env_steps_per_sample": 2000, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 1, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "offline_evaluation_interval": null, "num_offline_eval_runners": 0, "offline_loss_for_module_fn": null, "offline_evaluation_duration": 1, "offline_evaluation_parallel_to_training": false, "offline_evaluation_timeout_s": 120.0, "num_cpus_per_offline_eval_runner": 1, "num_gpus_per_offline_eval_runner": 0, "custom_resources_per_offline_eval_runner": {}, "restart_failed_offline_eval_runners": true, "ignore_offline_eval_runner_failures": false, "max_num_offline_eval_runner_restarts": 1000, "offline_eval_runner_restore_timeout_s": 1800.0, "max_requests_in_flight_per_offline_eval_runner": 1, "validate_offline_eval_runners_after_construction": true, "offline_eval_runner_health_probe_timeout_s": 30.0, "offline_eval_rl_module_inference_only": false, "broadcast_offline_eval_runner_states": false, "offline_eval_batch_size_per_runner": 256, "dataset_num_iters_per_eval_runner": 1, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "log_gradients": false, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 7, "restart_failed_env_runners": true, "ignore_env_runner_failures": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30.0, "env_runner_restore_timeout_s": 1800.0, "_model_config": {}, "_rl_module_spec": "MultiRLModuleSpec(multi_rl_module_class=<class 'ray.rllib.core.rl_module.multi_rl_module.MultiRLModule'>, observation_space=None, action_space=None, inference_only=False, model_config=None, rl_module_specs={'default_policy': RLModuleSpec(module_class=<class 'source.intrinsic_attention_ppo.rl_modules.DifferentiablePPOModule.DifferentiablePPOModule'>, observation_space=None, action_space=None, inference_only=False, learner_only=False, model_config={'vf_share_layers': True, 'embedding_dim': 62, 'max_seq_len': 11, 'policy_head_hidden_sizes': [32], 'value_head_hidden_sizes': [101], 'embedding_hidden_sizes': [121]}, catalog_class=None, load_state_path=None, model_config_dict=None), 'intrinsic_reward_module': RLModuleSpec(module_class=<class 'source.intrinsic_attention_ppo.rl_modules.IntrinsicAttentionModule.IntrinsicAttentionModule'>, observation_space=None, action_space=None, inference_only=False, learner_only=True, model_config={'intrinsic_reward_network': {'encoder_hidden_sizes': [], 'encoding_dim': 1, 'num_heads': 1, 'head_hidden_sizes': None, 'layers': [{'type': 'attention'}]}, 'extrinsic_value_hidden_layers': [127, 60], 'vf_share_layers': True, 'max_seq_len': 11}, catalog_class=None, load_state_path=None, model_config_dict=None)}, load_state_path=None, modules_to_load=None, module_specs={'default_policy': RLModuleSpec(module_class=<class 'source.intrinsic_attention_ppo.rl_modules.DifferentiablePPOModule.DifferentiablePPOModule'>, observation_space=None, action_space=None, inference_only=False, learner_only=False, model_config={'vf_share_layers': True, 'embedding_dim': 62, 'max_seq_len': 11, 'policy_head_hidden_sizes': [32], 'value_head_hidden_sizes': [101], 'embedding_hidden_sizes': [121]}, catalog_class=None, load_state_path=None, model_config_dict=None), 'intrinsic_reward_module': RLModuleSpec(module_class=<class 'source.intrinsic_attention_ppo.rl_modules.IntrinsicAttentionModule.IntrinsicAttentionModule'>, observation_space=None, action_space=None, inference_only=False, learner_only=True, model_config={'intrinsic_reward_network': {'encoder_hidden_sizes': [], 'encoding_dim': 1, 'num_heads': 1, 'head_hidden_sizes': None, 'layers': [{'type': 'attention'}]}, 'extrinsic_value_hidden_layers': [127, 60], 'vf_share_layers': True, 'max_seq_len': 11}, catalog_class=None, load_state_path=None, model_config_dict=None)})", "algorithm_config_overrides_per_module": {"intrinsic_reward_module": {"lr": 0.0002715581955}}, "_per_module_overrides": {}, "_validate_config": true, "_use_msgpack_checkpoints": false, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "env_task_fn": -1, "enable_connectors": -1, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.161583927863, "kl_target": 0.0201019014258, "vf_loss_coeff": 0.7790510010087, "entropy_coeff": 0.0015431216992, "clip_param": 0.2459212356676, "vf_clip_param": 0.3769744131561, "entropy_coeff_schedule": null, "lr_schedule": null, "sgd_minibatch_size": -1, "vf_share_layers": -1, "differentiable_learner_configs": ["DifferentiableLearnerConfig(learner_class=<class 'source.intrinsic_attention_ppo.learners.IntrinsicAttentionPPOLearner.IntrinsicAttentionPPOLearner'>, learner_connector=None, add_default_connectors_to_learner_pipeline=True, is_multi_agent=False, policies_to_update=['default_policy'], lr=0.0060984166342, num_total_minibatches=0, num_epochs=1, minibatch_size=1000, shuffle_batch_per_epoch=True)"], "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9485408017724, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.callbacks.callbacks.RLlibCallback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 59.48147702217102, "iterations_since_restore": 6, "perf": {"cpu_util_percent": 41.27857142857143, "ram_util_percent": 80.38571428571429}}
{"timers": {"training_iteration": 10.203769264274088, "restore_env_runners": 1.2762130942499445e-05, "training_step": 10.20356527277669, "env_runner_sampling_timer": 2.551617680121142, "learner_update_timer": 7.3990415892255195, "synch_weights": 0.0017691407986812758, "restore_eval_env_runners": 4.486612027228288e-05, "evaluation_iteration": 0.13811676548307325, "synch_eval_env_connectors": 0.00018352219868438335, "synch_env_connectors": 4.749910744109657e-06}, "env_runners": {"env_reset_timer": 4.076633248574227e-05, "num_episodes_lifetime": -153875.0, "num_env_steps_sampled_lifetime": -3077500.0, "num_env_steps_sampled": 5000.0, "module_to_env_connector": {"timers": {"connectors": {"remove_single_ts_time_rank_from_batch": 1.2054849941711064e-05, "get_actions": 3.944103704520926e-05, "listify_data_for_vector_env": 1.0725957710525203e-05, "tensor_to_numpy": 1.547671346387629e-05, "un_batch_to_individual_items": 6.657717296134216e-06, "normalize_and_clip_actions": 8.113137501938306e-06}}, "connector_pipeline_timer": 0.00011897428803931395}, "module_episode_returns_mean": {"default_policy": -1.0999999999999996}, "time_between_sampling": 0.032257815326326864, "rlmodule_inference_timer": 3.179951268774388e-05, "env_step_timer": 1.427139680546446e-05, "env_to_module_connector": {"timers": {"connectors": {"batch_individual_items": 1.2745808412885068e-05, "add_observations_from_episodes_to_batch": 2.9258907965604634e-06, "add_states_from_episodes_to_batch": 2.7171756913995484e-06, "numpy_to_tensor": 1.2793071754970654e-05, "add_time_dim_to_batch_and_zero_pad": 7.303238070730637e-06}}, "connector_pipeline_timer": 6.063077822047115e-05}, "weights_seq_no": 6.0, "num_agent_steps_sampled": {"default_agent": 5000.0}, "episode_len_min": 20, "episode_len_mean": 20.0, "num_episodes": 250.0, "sample": 0.0056632097378844755, "episode_duration_sec_mean": 0.005336886982899157, "episode_len_max": 20, "num_module_steps_sampled": {"default_policy": 5000.0}, "num_agent_steps_sampled_lifetime": {"default_agent": -3077500.0}, "num_module_steps_sampled_lifetime": {"default_policy": -3077500.0}, "env_to_module_sum_episodes_length_out": 10.36823839457432, "agent_episode_returns_mean": {"default_agent": -1.0999999999999996}, "episode_return_max": 10.5, "episode_return_min": -9.5, "env_to_module_sum_episodes_length_in": 10.36823839457432, "episode_return_mean": -1.0999999999999996, "num_env_steps_sampled_lifetime_throughput": 3232.5477033253264}, "__all_modules__": {"learner_connector_sum_episodes_length_in": 5000.0, "learner_connector": {"connector_pipeline_timer": 0.2111084416750706, "timers": {"connectors": {"add_one_ts_to_episodes_and_truncate": 0.009137838203169315, "add_observations_from_episodes_to_batch": 0.0009655422479442322, "add_columns_from_episodes_to_train_batch": 0.09888442712944773, "add_time_dim_to_batch_and_zero_pad": 0.08773347899588638, "add_states_from_episodes_to_batch": 0.003609493078605116, "batch_individual_items": 0.010488090859244398, "numpy_to_tensor": 8.871174733325965e-05}}}, "learner_connector_sum_episodes_length_out": 5250.0}, "learners": {"differentiable_learners": {"intrinsic_attention_ppo_learner": {"intrinsic_reward_module": {"num_module_steps_trained_lifetime": 251370, "weights_seq_no": 42.0, "total_loss": 0.0, "num_module_steps_trained": 35910, "diff_num_grad_updates_vs_sampler_policy": 36.0, "module_train_batch_size_mean": 997.5374097747205}, "default_policy": {"module_train_batch_size_mean": 997.5374097747205, "use_intrinsic_rewards": 1.0, "num_module_steps_trained_lifetime": 251370, "policy_loss": -0.0003007621562574059, "mean_kl_loss": 1.8645774616743438e-05, "entropy": 0.6912356615066528, "weights_seq_no": 42.0, "vf_loss_unclipped": 45.501686096191406, "vf_loss": 0.35841304063796997, "total_loss": 0.27785760164260864, "vf_explained_var": -0.002024054527282715, "num_module_steps_trained": 35910, "diff_num_grad_updates_vs_sampler_policy": 36.0}, "__all_modules__": {"num_env_steps_trained_lifetime": 1386000, "num_module_steps_trained": 71820, "num_module_steps_trained_lifetime": 502740, "num_env_steps_trained": 198000, "num_env_steps_trained_lifetime_throughput": 53885.5308238133}}}, "intrinsic_reward_module": {"num_module_steps_trained": 5985, "curr_entropy_coeff": 0.0015431216992, "total_loss": 0.0, "num_module_steps_trained_lifetime": 41895, "gradients_default_optimizer_global_norm": 0.0, "diff_num_grad_updates_vs_sampler_policy": 1.0, "module_train_batch_size_mean": 997.82696443245, "default_optimizer_learning_rate": 0.0002715581955, "num_trainable_parameters": 8266, "weights_seq_no": 7.0, "num_module_steps_trained_lifetime_throughput": 813.28994543724}, "__all_modules__": {"num_trainable_parameters": 24861, "num_non_trainable_parameters": 0, "num_env_steps_trained_lifetime": 231000, "num_module_steps_trained": 11970, "num_module_steps_trained_lifetime": 83790, "num_env_steps_trained": 33000, "num_env_steps_trained_lifetime_throughput": 4485.943444606386, "num_module_steps_trained_throughput": 28313975.695414443, "num_module_steps_trained_lifetime_throughput": 13323755.789582336}, "default_policy": {"vf_loss": 0.35831186175346375, "weights_seq_no": 7.0, "curr_entropy_coeff": 0.0015431216992, "vf_loss_unclipped": 45.26012420654297, "total_loss": 0.2777644097805023, "vf_explained_var": 4.869699478149414e-05, "num_module_steps_trained": 5985, "diff_num_grad_updates_vs_sampler_policy": 1.0, "curr_kl_coeff": 0.0012623744551092386, "use_intrinsic_rewards": 0.0, "module_train_batch_size_mean": 997.82696443245, "num_module_steps_trained_lifetime": 41895, "policy_loss": -0.00031217181822285056, "num_trainable_parameters": 16595, "mean_kl_loss": 1.998360858124215e-05, "entropy": 0.691248893737793, "num_module_steps_trained_lifetime_throughput": 813.273789273645}, "IntrinsicAttentionMask": [[[0.09227140247821808, 0.09415191411972046, 0.09395838528871536, 0.08911595493555069, 0.08893278241157532, 0.09055710583925247, 0.09037096798419952, 0.09018521755933762, 0.08999984711408615, 0.0926148071885109, 0.08784161508083344], [0.09294065088033676, 0.0957917869091034, 0.09549705684185028, 0.08822130411863327, 0.08794986456632614, 0.09036657959222794, 0.09008853137493134, 0.08981134742498398, 0.08953502029180527, 0.09345915168523788, 0.08633867651224136], [0.09287266433238983, 0.09562374651432037, 0.09533948451280594, 0.08831259608268738, 0.08805007487535477, 0.09038646519184113, 0.09011777490377426, 0.08984988182783127, 0.08958278596401215, 0.09337318688631058, 0.08649122714996338], [0.09110348671674728, 0.091364286839962, 0.0913376584649086, 0.09065543860197067, 0.09062901139259338, 0.0908617302775383, 0.09083524346351624, 0.09080876410007477, 0.0907822921872139, 0.09115145355463028, 0.09047061949968338], [0.09103389829397202, 0.0912010669708252, 0.09118400514125824, 0.09074631333351135, 0.09072933346033096, 0.09087878465652466, 0.09086178988218307, 0.0908447876572609, 0.09082779288291931, 0.09106465429067612, 0.09062754362821579], [0.0916440412402153, 0.09264307469129562, 0.0925406888127327, 0.08994626998901367, 0.08984686434268951, 0.09072506427764893, 0.09062480181455612, 0.09052465111017227, 0.09042460471391678, 0.09182716906070709, 0.08925275504589081], [0.09157490730285645, 0.092478446662426, 0.09238589555025101, 0.0900372862815857, 0.0899471789598465, 0.09074296057224274, 0.09065213799476624, 0.09056141972541809, 0.09047078341245651, 0.09174060821533203, 0.08940840512514114], [0.09150571376085281, 0.0923139899969101, 0.09223122894763947, 0.09012828022241592, 0.09004748612642288, 0.090760737657547, 0.09067936986684799, 0.09059807658195496, 0.09051685780286789, 0.09165400266647339, 0.08956421911716461], [0.091436468064785, 0.09214972704648972, 0.09207673370838165, 0.09021927416324615, 0.09014780819416046, 0.0907784253358841, 0.09070651233196259, 0.09063465893268585, 0.0905628651380539, 0.09156738221645355, 0.08972019702196121], [0.09239506721496582, 0.09445255249738693, 0.09424064308404922, 0.08895132690668106, 0.08875176310539246, 0.09052278846502304, 0.0903196930885315, 0.09011704474687576, 0.08991486579179764, 0.09277050942182541, 0.08756370097398758], [0.09061521291732788, 0.09022556990385056, 0.09026522934436798, 0.09129118919372559, 0.09133131802082062, 0.09097891300916672, 0.09101890027523041, 0.09105891734361649, 0.09109894186258316, 0.09054334461688995, 0.09157246351242065]], [[0.09071735292673111, 0.08630578219890594, 0.08381710946559906, 0.09129121154546738, 0.08417022228240967, 0.09167581796646118, 0.08721762895584106, 0.08470267057418823, 0.12427517026662827, 0.09101149439811707, 0.08481549471616745], [0.0908278226852417, 0.09163863956928253, 0.09211789816617966, 0.09072577208280563, 0.09204888343811035, 0.0906578004360199, 0.09146710485219955, 0.09194546192884445, 0.08587164431810379, 0.09077542275190353, 0.09192364662885666], [0.09023186564445496, 0.09423066675662994, 0.09665969759225845, 0.08973828703165054, 0.09630688279867172, 0.08941073715686798, 0.093373142182827, 0.09578006714582443, 0.06862127780914307, 0.08997814357280731, 0.09566923975944519], [0.09058430045843124, 0.0855412483215332, 0.08271312713623047, 0.09124304354190826, 0.0831136479973793, 0.09168486297130585, 0.0865805447101593, 0.08371805399656296, 0.13005302846431732, 0.09092187881469727, 0.08384620398283005], [0.09034301340579987, 0.0938805490732193, 0.09602098912000656, 0.08990514278411865, 0.09571047872304916, 0.08961440622806549, 0.0931234061717987, 0.09524659067392349, 0.07088850438594818, 0.09011796116828918, 0.0951489508152008], [0.09047915786504745, 0.08501976728439331, 0.0819702222943306, 0.0911942571401596, 0.08240155875682831, 0.09167412668466568, 0.0861426442861557, 0.08305282890796661, 0.13402888178825378, 0.09084554761648178, 0.08319095522165298], [0.09093222767114639, 0.09061485528945923, 0.09042909741401672, 0.09097245335578918, 0.09045577049255371, 0.09099927544593811, 0.09068167209625244, 0.09049578011035919, 0.09296181052923203, 0.09095287322998047, 0.0905042290687561], [0.09049436450004578, 0.09334170073270798, 0.09505441784858704, 0.0901404395699501, 0.09480641037225723, 0.0899052545428276, 0.09273405373096466, 0.09443562477827072, 0.07441770285367966, 0.09031250327825546, 0.09435754269361496], [0.04552992805838585, 0.02989395149052143, 0.023353075608611107, 0.04801855608820915, 0.024196481332182884, 0.04975276440382004, 0.03266657516360283, 0.02551904134452343, 0.6484714150428772, 0.046790946274995804, 0.025807321071624756], [0.0906527042388916, 0.0859159380197525, 0.08325191587209702, 0.09127019345760345, 0.0836295410990715, 0.09168419241905212, 0.08689352124929428, 0.08419919013977051, 0.12721365690231323, 0.09096917510032654, 0.08431992679834366], [0.09052389115095139, 0.09322582930326462, 0.09484907239675522, 0.09018774330615997, 0.09461411833763123, 0.08996433764696121, 0.09264957159757614, 0.09426277875900269, 0.07518278807401657, 0.0903511717915535, 0.09418878704309464]], [[0.09352341294288635, 0.09069760888814926, 0.09523328393697739, 0.0950375348329544, 0.09484218806028366, 0.09178584814071655, 0.08705538511276245, 0.08687644451856613, 0.08669787645339966, 0.08921689540147781, 0.08903351426124573], [0.09154864400625229, 0.09086810052394867, 0.09195291250944138, 0.09190691262483597, 0.09186093509197235, 0.09113205969333649, 0.08996684849262238, 0.08992183953523636, 0.08987685292959213, 0.09050507098436356, 0.09045979380607605], [0.09467755258083344, 0.09056652337312698, 0.09719231724739075, 0.09690339118242264, 0.09661532938480377, 0.09214303642511368, 0.08535173535346985, 0.0850980132818222, 0.08484504371881485, 0.08843498677015305, 0.08817210048437119], [0.09454695880413055, 0.09058254212141037, 0.09696904569864273, 0.09669087827205658, 0.0964135229587555, 0.09210356324911118, 0.08554460853338242, 0.08529921621084213, 0.08505453169345856, 0.08852455019950867, 0.08827061951160431], [0.09441623836755753, 0.09059827029705048, 0.09674597531557083, 0.09647852182388306, 0.09621182084083557, 0.09206381440162659, 0.08573763072490692, 0.08550061285495758, 0.08526425808668137, 0.08861392736434937, 0.0883689597249031], [0.09231921285390854, 0.09080953896045685, 0.0932224690914154, 0.09311944246292114, 0.09301653504371643, 0.09139346331357956, 0.08883120864629745, 0.08873303979635239, 0.08863498270511627, 0.09000978618860245, 0.08991031348705292], [0.08887578547000885, 0.09099432080984116, 0.08764798939228058, 0.08778657019138336, 0.08792536705732346, 0.09016481041908264, 0.09390346705913544, 0.09405194222927094, 0.09420064091682434, 0.09215167164802551, 0.09229736775159836], [0.08874069154262543, 0.0909975916147232, 0.087434321641922, 0.08758170902729034, 0.08772934228181839, 0.09011348336935043, 0.0941023975610733, 0.09426102042198181, 0.0944199189543724, 0.09223200380802155, 0.09238748252391815], [0.08860552310943604, 0.09100057929754257, 0.08722089976072311, 0.08737704902887344, 0.08753348141908646, 0.09006190299987793, 0.09430144727230072, 0.09447026997804642, 0.09463940560817719, 0.09231211990118027, 0.09247738867998123], [0.09047961980104446, 0.09093278646469116, 0.09021307528018951, 0.09024330228567123, 0.09027354419231415, 0.09075634181499481, 0.09154170751571655, 0.09157238900661469, 0.09160307049751282, 0.0911768451333046, 0.09120739996433258], [0.09034555405378342, 0.09093955159187317, 0.08999660611152649, 0.09003616869449615, 0.09007574617862701, 0.0907081738114357, 0.09173916280269623, 0.09177948534488678, 0.09181983023881912, 0.09125983715057373, 0.09129995852708817]], [[0.09863977879285812, 0.09895893931388855, 0.0946076363325119, 0.09195702522993088, 0.08791360259056091, 0.10024594515562057, 0.09285253286361694, 0.08876974135637283, 0.0610228069126606, 0.099131740629673, 0.08590015769004822], [0.09887614101171494, 0.09920642524957657, 0.0947064757347107, 0.09196856617927551, 0.08779691159725189, 0.10053864121437073, 0.09289328753948212, 0.08867969363927841, 0.060226742178201675, 0.09938526153564453, 0.08572191745042801], [0.09551208466291428, 0.09569192677736282, 0.09321868419647217, 0.09168878197669983, 0.08931899815797806, 0.09641470015048981, 0.09220769256353378, 0.08982449769973755, 0.07221149653196335, 0.09578920155763626, 0.08812199532985687], [0.09330068528652191, 0.09339053183794022, 0.092147596180439, 0.09137066453695297, 0.09015460312366486, 0.09375079721212387, 0.09163488447666168, 0.09041531383991241, 0.08086150884628296, 0.09343910217285156, 0.08953436464071274], [0.08965858072042465, 0.08961455523967743, 0.09022928774356842, 0.09061993658542633, 0.09124156087636948, 0.08943868428468704, 0.09048652648925781, 0.09110722690820694, 0.09644928574562073, 0.08959079533815384, 0.09156350791454315], [0.0998135358095169, 0.10018879920244217, 0.09508977085351944, 0.09200208634138107, 0.08731970936059952, 0.10170400142669678, 0.09304367005825043, 0.08830828219652176, 0.05713715776801109, 0.10039205849170685, 0.08500093966722488], [0.09406252205371857, 0.09418260306119919, 0.09252474457025528, 0.09149213880300522, 0.08988163620233536, 0.09466447681188583, 0.09184299409389496, 0.09022631496191025, 0.0778120830655098, 0.09424751996994019, 0.08906292915344238], [0.0904586911201477, 0.09044260531663895, 0.0906667560338974, 0.0908086970448494, 0.09103374183177948, 0.0903782993555069, 0.0907602608203888, 0.09098520129919052, 0.09288185834884644, 0.09043391793966293, 0.09114991873502731], [0.05375935137271881, 0.05310247465968132, 0.06301386654376984, 0.0702107772231102, 0.08331537246704102, 0.050554268062114716, 0.06766841560602188, 0.08029849827289581, 0.334330677986145, 0.05275105684995651, 0.09099528193473816], [0.09900344908237457, 0.09933976829051971, 0.09475934505462646, 0.09197425842285156, 0.0877334475517273, 0.10069648176431656, 0.09291475266218185, 0.08863057941198349, 0.05980078503489494, 0.09952186793088913, 0.0856252983212471], [0.08771122992038727, 0.08760252594947815, 0.08912786096334457, 0.09010545909404755, 0.09167437255382538, 0.08716905862092972, 0.0897708609700203, 0.09133394807577133, 0.10546740889549255, 0.08754387497901917, 0.09249337762594223]], [[0.09225849062204361, 0.0941387340426445, 0.08928700536489487, 0.09375213086605072, 0.09355942904949188, 0.08605482429265976, 0.09035831689834595, 0.09017258882522583, 0.08998724818229675, 0.09260184317827225, 0.08782932162284851], [0.09291169047355652, 0.09576193988323212, 0.08846601843833923, 0.09517356008291245, 0.09488072991371155, 0.08371327072381973, 0.09006046503782272, 0.08978336304426193, 0.08950712531805038, 0.0934300422668457, 0.08631177246570587], [0.09117253869771957, 0.09152720868587494, 0.09059993177652359, 0.09145475178956985, 0.0914185494184494, 0.08995934575796127, 0.09080812335014343, 0.09077217429876328, 0.09073624014854431, 0.09123773872852325, 0.0903133898973465], [0.09277947247028351, 0.09543002396821976, 0.0886341780424118, 0.09488331526517868, 0.09461113810539246, 0.08418689668178558, 0.09012248367071152, 0.08986396342515945, 0.08960617333650589, 0.09326190501451492, 0.08662045747041702], [0.09271316975355148, 0.09526422619819641, 0.08871813118457794, 0.09473825246095657, 0.0944763571023941, 0.08442448079586029, 0.09015325456857681, 0.08990402519702911, 0.08965549618005753, 0.0931776836514473, 0.08677496761083603], [0.08991202712059021, 0.0886206328868866, 0.09204773604869843, 0.08888252824544907, 0.08901375532150269, 0.09451385587453842, 0.09126384556293488, 0.09139860421419144, 0.09153354912996292, 0.08967284858226776, 0.09314063936471939], [0.0915718525648117, 0.09247535467147827, 0.09012448042631149, 0.09229034930467606, 0.09219798445701599, 0.08852176368236542, 0.09064911305904388, 0.09055838733911514, 0.09046775847673416, 0.0917375385761261, 0.08940541744232178], [0.09150326997041702, 0.09231152385473251, 0.09020674973726273, 0.09214609116315842, 0.09206347912549973, 0.08876853436231613, 0.09067694842815399, 0.09059565514326096, 0.09051444381475449, 0.091651551425457, 0.0895618200302124], [0.091434545814991, 0.09214778989553452, 0.09028889983892441, 0.09200186282396317, 0.09192898124456406, 0.08901579678058624, 0.09070460498332977, 0.09063275903463364, 0.09056095778942108, 0.09156545251607895, 0.08971831202507019], [0.09237968921661377, 0.09443683177232742, 0.0891365110874176, 0.09401354938745499, 0.09380262345075607, 0.08562000840902328, 0.0903046503663063, 0.09010204672813416, 0.08989989757537842, 0.09275506436824799, 0.08754912763834], [0.09061462432146072, 0.0902249738574028, 0.0912504717707634, 0.09030431509017944, 0.09034401178359985, 0.09197194874286652, 0.09101830422878265, 0.09105831384658813, 0.0910983458161354, 0.0905427560210228, 0.0915718674659729]], [[0.09092380851507187, 0.09245465695858002, 0.09016431868076324, 0.09110108017921448, 0.09174192696809769, 0.09269507974386215, 0.0927552804350853, 0.09192078560590744, 0.08389389514923096, 0.09248708933591843, 0.08986204862594604], [0.09034586697816849, 0.09843592345714569, 0.08653593063354492, 0.09125427156686783, 0.09459976851940155, 0.09975779801607132, 0.10009102523326874, 0.09555094689130783, 0.05975896120071411, 0.09861337393522263, 0.0850561335682869], [0.09081700444221497, 0.0891968384385109, 0.09164203703403473, 0.09062649309635162, 0.08994416892528534, 0.08894743770360947, 0.08888520300388336, 0.08975549042224884, 0.09904783219099045, 0.08916311711072922, 0.0919744223356247], [0.09090776741504669, 0.09318610280752182, 0.08978424966335297, 0.09117064625024796, 0.09212306141853333, 0.0935455784201622, 0.0936356633901596, 0.09238945692777634, 0.08068449795246124, 0.09323456138372421, 0.08933837711811066], [0.09073317050933838, 0.09574339538812637, 0.08831588178873062, 0.09130387008190155, 0.09338761866092682, 0.0965471863746643, 0.0967491865158081, 0.0939750075340271, 0.07002687454223633, 0.09585153311491013, 0.08736633509397507], [0.0901743620634079, 0.09931017458438873, 0.08590676635503769, 0.0911952555179596, 0.09496591985225677, 0.10081208497285843, 0.10119110345840454, 0.09604105353355408, 0.056636057794094086, 0.09951165318489075, 0.08425550907850266], [0.09012842923402786, 0.09952650964260101, 0.08574723452329636, 0.09117735177278519, 0.09505439549684525, 0.10107390582561493, 0.10146450251340866, 0.0961606577038765, 0.05587924271821976, 0.09973404556512833, 0.08405362069606781], [0.09065398573875427, 0.09643366932868958, 0.08788236975669861, 0.09130996465682983, 0.0937102884054184, 0.09736518561840057, 0.09759946912527084, 0.09438838809728622, 0.06730106472969055, 0.09655892103910446, 0.08679671585559845], [0.07427018880844116, 0.05413868650794029, 0.08705559372901917, 0.07158083468675613, 0.06268312782049179, 0.051540762186050415, 0.05091099068522453, 0.06041334941983223, 0.34085512161254883, 0.053780414164066315, 0.09277094900608063], [0.09032387286424637, 0.09855479747056961, 0.08645184338092804, 0.09124749153852463, 0.09465036541223526, 0.09990080446004868, 0.10024016350507736, 0.09561822563409805, 0.05932823196053505, 0.09873546659946442, 0.08494870364665985], [0.09068888425827026, 0.08784233778715134, 0.09215360134840012, 0.0903521180152893, 0.08915045112371445, 0.087407685816288, 0.08729935437440872, 0.08881940692663193, 0.10575612634420395, 0.08778353035449982, 0.09274657815694809]]]}, "num_training_step_calls_per_iteration": 1, "evaluation": {"env_runners": {"module_to_env_connector": {"timers": {"connectors": {"remove_single_ts_time_rank_from_batch": 1.1692902617972485e-05, "get_actions": 3.51736023779985e-05, "normalize_and_clip_actions": 7.772533010781023e-06, "listify_data_for_vector_env": 1.0422479506494745e-05, "tensor_to_numpy": 1.4716315176634726e-05, "un_batch_to_individual_items": 6.522052674610776e-06}}, "connector_pipeline_timer": 0.00011239506831916823}, "episode_len_max": 20, "num_agent_steps_sampled_lifetime": {"default_agent": 2800}, "num_module_steps_sampled_lifetime": {"default_policy": 2800}, "episode_return_max": 14.5, "env_reset_timer": 0.0005593250721388168, "rlmodule_inference_timer": 3.0465078918445106e-05, "env_step_timer": 1.3905364087620907e-05, "env_to_module_connector": {"timers": {"connectors": {"add_states_from_episodes_to_batch": 2.6599361794544906e-06, "numpy_to_tensor": 1.1590021746806468e-05, "add_time_dim_to_batch_and_zero_pad": 7.042230342417642e-06, "add_observations_from_episodes_to_batch": 2.863899097202876e-06, "batch_individual_items": 1.2360426452602806e-05}}, "connector_pipeline_timer": 5.877303945374552e-05}, "episode_len_min": 20, "env_to_module_sum_episodes_length_out": 10.368238394572801, "env_to_module_sum_episodes_length_in": 10.368238394572801, "num_env_steps_sampled_lifetime": 35400, "num_agent_steps_sampled": {"default_agent": 400}, "weights_seq_no": 7.0, "module_episode_returns_mean": {"default_policy": 0.25}, "episode_len_mean": 20.0, "sample": 0.12636445318935222, "agent_episode_returns_mean": {"default_agent": 0.25}, "episode_return_mean": 0.25, "episode_return_min": -12.5, "num_episodes": 20, "episode_duration_sec_mean": 0.005472942068008706, "num_module_steps_sampled": {"default_policy": 400}, "num_episodes_lifetime": 140, "num_env_steps_sampled": 400, "time_between_sampling": 9.439879602036104}, "num_healthy_workers": 1, "actor_manager_num_outstanding_async_reqs": 0, "num_remote_worker_restarts": 0}, "num_env_steps_sampled_lifetime": -3077500.0, "fault_tolerance": {"num_healthy_workers": 0, "num_remote_worker_restarts": 0}, "env_runner_group": {"actor_manager_num_outstanding_async_reqs": 0}, "done": false, "training_iteration": 7, "trial_id": "b9446_00000", "date": "2025-08-11_18-35-22", "timestamp": 1754930122, "time_this_iter_s": 9.744907855987549, "time_total_s": 69.22638487815857, "pid": 11415, "hostname": "Mac", "node_ip": "127.0.0.1", "config": {"exploration_config": {}, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 2, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "env": "Umbrella", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": false, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 0, "create_local_env_runner": true, "num_envs_per_env_runner": 1, "gym_env_vectorize_mode": "SYNC", "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "episodes_to_numpy": true, "max_requests_in_flight_per_env_runner": 1, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "merge_env_runner_states": "training_only", "broadcast_env_runner_states": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "complete_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "sampler_perf_stats_ema_coef": null, "_is_online": true, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": "auto", "num_aggregator_actors_per_learner": 0, "max_requests_in_flight_per_aggregator_actor": 3, "local_gpu_idx": 0, "max_requests_in_flight_per_learner": 3, "gamma": 1, "lr": 0.0002715581955, "grad_clip": 0.5, "grad_clip_by": "global_norm", "_train_batch_size_per_learner": 5000, "train_batch_size": 4000, "num_epochs": 1, "minibatch_size": 1000, "shuffle_batch_per_epoch": true, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "log_std_clip_param": 20.0, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "_disable_preprocessor_api": false, "_disable_action_flattening": false}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {"intrinsic_reward_coeff": 0.2795015916508}, "optimizer": {}, "_learner_class": "<class 'source.intrinsic_attention_ppo.learners.IntrinsicAttentionMetaLearner.IntrinsicAttentionMetaLearner'>", "callbacks_on_algorithm_init": null, "callbacks_on_env_runners_recreated": null, "callbacks_on_offline_eval_runners_recreated": null, "callbacks_on_checkpoint_loaded": null, "callbacks_on_environment_created": null, "callbacks_on_episode_created": null, "callbacks_on_episode_start": null, "callbacks_on_episode_step": null, "callbacks_on_episode_end": null, "callbacks_on_evaluate_start": null, "callbacks_on_evaluate_end": null, "callbacks_on_evaluate_offline_start": null, "callbacks_on_evaluate_offline_end": null, "callbacks_on_sample_end": null, "callbacks_on_train_result": null, "explore": true, "enable_rl_module_and_learner": true, "enable_env_runner_and_connector_v2": true, "_prior_exploration_config": {"type": "StochasticSampling"}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x3884998a0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "offline_data_class": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_read_batch_size": null, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "materialize_data": false, "materialize_mapped_data": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "ignore_final_observation": false, "prelearner_class": null, "prelearner_buffer_class": null, "prelearner_buffer_kwargs": {}, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_remaining_data": false, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": 1, "evaluation_duration": 20, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_auto_duration_min_env_steps_per_sample": 100, "evaluation_auto_duration_max_env_steps_per_sample": 2000, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 1, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "offline_evaluation_interval": null, "num_offline_eval_runners": 0, "offline_loss_for_module_fn": null, "offline_evaluation_duration": 1, "offline_evaluation_parallel_to_training": false, "offline_evaluation_timeout_s": 120.0, "num_cpus_per_offline_eval_runner": 1, "num_gpus_per_offline_eval_runner": 0, "custom_resources_per_offline_eval_runner": {}, "restart_failed_offline_eval_runners": true, "ignore_offline_eval_runner_failures": false, "max_num_offline_eval_runner_restarts": 1000, "offline_eval_runner_restore_timeout_s": 1800.0, "max_requests_in_flight_per_offline_eval_runner": 1, "validate_offline_eval_runners_after_construction": true, "offline_eval_runner_health_probe_timeout_s": 30.0, "offline_eval_rl_module_inference_only": false, "broadcast_offline_eval_runner_states": false, "offline_eval_batch_size_per_runner": 256, "dataset_num_iters_per_eval_runner": 1, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "log_gradients": false, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 7, "restart_failed_env_runners": true, "ignore_env_runner_failures": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30.0, "env_runner_restore_timeout_s": 1800.0, "_model_config": {}, "_rl_module_spec": "MultiRLModuleSpec(multi_rl_module_class=<class 'ray.rllib.core.rl_module.multi_rl_module.MultiRLModule'>, observation_space=None, action_space=None, inference_only=False, model_config=None, rl_module_specs={'default_policy': RLModuleSpec(module_class=<class 'source.intrinsic_attention_ppo.rl_modules.DifferentiablePPOModule.DifferentiablePPOModule'>, observation_space=None, action_space=None, inference_only=False, learner_only=False, model_config={'vf_share_layers': True, 'embedding_dim': 62, 'max_seq_len': 11, 'policy_head_hidden_sizes': [32], 'value_head_hidden_sizes': [101], 'embedding_hidden_sizes': [121]}, catalog_class=None, load_state_path=None, model_config_dict=None), 'intrinsic_reward_module': RLModuleSpec(module_class=<class 'source.intrinsic_attention_ppo.rl_modules.IntrinsicAttentionModule.IntrinsicAttentionModule'>, observation_space=None, action_space=None, inference_only=False, learner_only=True, model_config={'intrinsic_reward_network': {'encoder_hidden_sizes': [], 'encoding_dim': 1, 'num_heads': 1, 'head_hidden_sizes': None, 'layers': [{'type': 'attention'}]}, 'extrinsic_value_hidden_layers': [127, 60], 'vf_share_layers': True, 'max_seq_len': 11}, catalog_class=None, load_state_path=None, model_config_dict=None)}, load_state_path=None, modules_to_load=None, module_specs={'default_policy': RLModuleSpec(module_class=<class 'source.intrinsic_attention_ppo.rl_modules.DifferentiablePPOModule.DifferentiablePPOModule'>, observation_space=None, action_space=None, inference_only=False, learner_only=False, model_config={'vf_share_layers': True, 'embedding_dim': 62, 'max_seq_len': 11, 'policy_head_hidden_sizes': [32], 'value_head_hidden_sizes': [101], 'embedding_hidden_sizes': [121]}, catalog_class=None, load_state_path=None, model_config_dict=None), 'intrinsic_reward_module': RLModuleSpec(module_class=<class 'source.intrinsic_attention_ppo.rl_modules.IntrinsicAttentionModule.IntrinsicAttentionModule'>, observation_space=None, action_space=None, inference_only=False, learner_only=True, model_config={'intrinsic_reward_network': {'encoder_hidden_sizes': [], 'encoding_dim': 1, 'num_heads': 1, 'head_hidden_sizes': None, 'layers': [{'type': 'attention'}]}, 'extrinsic_value_hidden_layers': [127, 60], 'vf_share_layers': True, 'max_seq_len': 11}, catalog_class=None, load_state_path=None, model_config_dict=None)})", "algorithm_config_overrides_per_module": {"intrinsic_reward_module": {"lr": 0.0002715581955}}, "_per_module_overrides": {}, "_validate_config": true, "_use_msgpack_checkpoints": false, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "env_task_fn": -1, "enable_connectors": -1, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.161583927863, "kl_target": 0.0201019014258, "vf_loss_coeff": 0.7790510010087, "entropy_coeff": 0.0015431216992, "clip_param": 0.2459212356676, "vf_clip_param": 0.3769744131561, "entropy_coeff_schedule": null, "lr_schedule": null, "sgd_minibatch_size": -1, "vf_share_layers": -1, "differentiable_learner_configs": ["DifferentiableLearnerConfig(learner_class=<class 'source.intrinsic_attention_ppo.learners.IntrinsicAttentionPPOLearner.IntrinsicAttentionPPOLearner'>, learner_connector=None, add_default_connectors_to_learner_pipeline=True, is_multi_agent=False, policies_to_update=['default_policy'], lr=0.0060984166342, num_total_minibatches=0, num_epochs=1, minibatch_size=1000, shuffle_batch_per_epoch=True)"], "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9485408017724, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.callbacks.callbacks.RLlibCallback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 69.22638487815857, "iterations_since_restore": 7, "perf": {"cpu_util_percent": 46.17142857142857, "ram_util_percent": 80.45714285714284}}
{"timers": {"training_iteration": 10.200084213710465, "restore_env_runners": 1.2693669571320462e-05, "training_step": 10.199879749209021, "env_runner_sampling_timer": 2.5423277562299127, "learner_update_timer": 7.403567211253755, "synch_weights": 0.0017675781409795968, "restore_eval_env_runners": 4.44732883654486e-05, "evaluation_iteration": 0.13795719490766298, "synch_eval_env_connectors": 0.00018273322680616898, "synch_env_connectors": 4.736991643864033e-06}, "env_runners": {"env_reset_timer": 4.764843770610875e-05, "num_episodes_lifetime": -184750.0, "num_env_steps_sampled_lifetime": -3695000.0, "num_env_steps_sampled": 5000.0, "module_to_env_connector": {"timers": {"connectors": {"remove_single_ts_time_rank_from_batch": 1.2387363823147646e-05, "get_actions": 4.169935087751358e-05, "listify_data_for_vector_env": 1.1093682801100481e-05, "tensor_to_numpy": 1.6048734077742955e-05, "un_batch_to_individual_items": 6.773128821993707e-06, "normalize_and_clip_actions": 8.404853001745025e-06}}, "connector_pipeline_timer": 0.0001238032681388708}, "module_episode_returns_mean": {"default_policy": -0.54}, "time_between_sampling": 0.033293914311160994, "rlmodule_inference_timer": 3.3542476197488687e-05, "env_step_timer": 1.4763071706647867e-05, "env_to_module_connector": {"timers": {"connectors": {"batch_individual_items": 1.2994460497570428e-05, "add_observations_from_episodes_to_batch": 2.9913049707340143e-06, "add_states_from_episodes_to_batch": 2.7900637933147825e-06, "numpy_to_tensor": 1.3386363524779811e-05, "add_time_dim_to_batch_and_zero_pad": 7.559520456909377e-06}}, "connector_pipeline_timer": 6.236209465154482e-05}, "weights_seq_no": 7.0, "num_agent_steps_sampled": {"default_agent": 5000.0}, "episode_len_min": 20, "episode_len_mean": 20.0, "num_episodes": 250.0, "sample": 0.005900715843155519, "episode_duration_sec_mean": 0.0055355561519973, "episode_len_max": 20, "num_module_steps_sampled": {"default_policy": 5000.0}, "num_agent_steps_sampled_lifetime": {"default_agent": -3695000.0}, "num_module_steps_sampled_lifetime": {"default_policy": -3695000.0}, "env_to_module_sum_episodes_length_out": 10.36823839457432, "agent_episode_returns_mean": {"default_agent": -0.54}, "episode_return_max": 10.5, "episode_return_min": -9.5, "env_to_module_sum_episodes_length_in": 10.36823839457432, "episode_return_mean": -0.54, "num_env_steps_sampled_lifetime_throughput": 3102.993298000775}, "__all_modules__": {"learner_connector_sum_episodes_length_in": 5000.0, "learner_connector": {"connector_pipeline_timer": 0.21207236975778643, "timers": {"connectors": {"add_one_ts_to_episodes_and_truncate": 0.009145512321583017, "add_observations_from_episodes_to_batch": 0.0009658984954116243, "add_columns_from_episodes_to_train_batch": 0.09832492452897747, "add_time_dim_to_batch_and_zero_pad": 0.08761445503591525, "add_states_from_episodes_to_batch": 0.003609258988981568, "batch_individual_items": 0.012123333281034585, "numpy_to_tensor": 8.873921074711059e-05}}}, "learner_connector_sum_episodes_length_out": 5250.0}, "learners": {"differentiable_learners": {"intrinsic_attention_ppo_learner": {"intrinsic_reward_module": {"num_module_steps_trained_lifetime": 287280, "weights_seq_no": 48.0, "total_loss": 0.0, "num_module_steps_trained": 35910, "diff_num_grad_updates_vs_sampler_policy": 41.0, "module_train_batch_size_mean": 997.5252898807411}, "default_policy": {"module_train_batch_size_mean": 997.5252898807411, "use_intrinsic_rewards": 1.0, "num_module_steps_trained_lifetime": 287280, "policy_loss": -0.00037465934292413294, "mean_kl_loss": 2.7862122806254774e-05, "entropy": 0.6916364431381226, "weights_seq_no": 48.0, "vf_loss_unclipped": 44.20705032348633, "vf_loss": 0.3583945035934448, "total_loss": 0.27777016162872314, "vf_explained_var": -0.0018640756607055664, "num_module_steps_trained": 35910, "diff_num_grad_updates_vs_sampler_policy": 41.0}, "__all_modules__": {"num_env_steps_trained_lifetime": 1584000, "num_module_steps_trained": 71820, "num_module_steps_trained_lifetime": 574560, "num_env_steps_trained": 198000, "num_env_steps_trained_lifetime_throughput": 52979.79827600189}}}, "intrinsic_reward_module": {"num_module_steps_trained": 5985, "curr_entropy_coeff": 0.0015431216992, "total_loss": 0.0, "num_module_steps_trained_lifetime": 47880, "gradients_default_optimizer_global_norm": 0.0, "diff_num_grad_updates_vs_sampler_policy": 1.0, "module_train_batch_size_mean": 997.8076834879114, "default_optimizer_learning_rate": 0.0002715581955, "num_trainable_parameters": 8266, "weights_seq_no": 8.0, "num_module_steps_trained_lifetime_throughput": 808.7152682005199}, "__all_modules__": {"num_trainable_parameters": 24861, "num_non_trainable_parameters": 0, "num_env_steps_trained_lifetime": 264000, "num_module_steps_trained": 11970, "num_module_steps_trained_lifetime": 95760, "num_env_steps_trained": 33000, "num_env_steps_trained_lifetime_throughput": 4460.661022286829, "num_module_steps_trained_throughput": 27495716.14758794, "num_module_steps_trained_lifetime_throughput": 13270434.707832905}, "default_policy": {"vf_loss": 0.35830625891685486, "weights_seq_no": 8.0, "curr_entropy_coeff": 0.0015431216992, "vf_loss_unclipped": 44.09017562866211, "total_loss": 0.27768516540527344, "vf_explained_var": -8.511543273925781e-05, "num_module_steps_trained": 5985, "diff_num_grad_updates_vs_sampler_policy": 1.0, "curr_kl_coeff": 0.0006311872275546193, "use_intrinsic_rewards": 0.0, "module_train_batch_size_mean": 997.8076834879114, "num_module_steps_trained_lifetime": 47880, "policy_loss": -0.00038641999708488584, "num_trainable_parameters": 16595, "mean_kl_loss": 2.9576198357972316e-05, "entropy": 0.6916488409042358, "num_module_steps_trained_lifetime_throughput": 808.6999198021415}, "IntrinsicAttentionMask": [[[0.09267205744981766, 0.08987198024988174, 0.09436636418104172, 0.0941723957657814, 0.09397882968187332, 0.09095031023025513, 0.09076336771249771, 0.08608559519052505, 0.08590865135192871, 0.08840474486351013, 0.0928257554769516], [0.09134355187416077, 0.09066453576087952, 0.09174691140651703, 0.09170101583003998, 0.09165513515472412, 0.09092789888381958, 0.09088240563869476, 0.08972039073705673, 0.08967550843954086, 0.09030231088399887, 0.09138037264347076], [0.09343945980072021, 0.08938218653202057, 0.0959213376045227, 0.09563619643449783, 0.09535189718008041, 0.09093808382749557, 0.09066775441169739, 0.08398518711328506, 0.08373552560806274, 0.08727852255105972, 0.0936637669801712], [0.09335296601057053, 0.08943860977888107, 0.09574446082115173, 0.09546981751918793, 0.0951959490776062, 0.09094041585922241, 0.09067955613136292, 0.08422200381755829, 0.08398040384054184, 0.08740661293268204, 0.09356919676065445], [0.09326630085706711, 0.08949483186006546, 0.09556765854358673, 0.09530346840620041, 0.09504000842571259, 0.09094251692295074, 0.09069111198186874, 0.08445926010608673, 0.08422578126192093, 0.08753465861082077, 0.09347447007894516], [0.09186425805091858, 0.09036202728748322, 0.09276306629180908, 0.09266055375337601, 0.09255814552307129, 0.09094307571649551, 0.09084257483482361, 0.08829575777053833, 0.08819818496704102, 0.08956621587276459, 0.09194611012935638], [0.09177481383085251, 0.09041472524404526, 0.09258756786584854, 0.0924949049949646, 0.09240233153104782, 0.09094104915857315, 0.09085003286600113, 0.08854047954082489, 0.08845186233520508, 0.0896933525800705, 0.09184885770082474], [0.08942065387964249, 0.09169484674930573, 0.08810427039861679, 0.08825278282165527, 0.08840155601501465, 0.09080396592617035, 0.09095703065395355, 0.0949832871556282, 0.0951434001326561, 0.09293872117996216, 0.08929943293333054], [0.08932707458734512, 0.0917416363954544, 0.08793117851018906, 0.08808859437704086, 0.08824630081653595, 0.09079531580209732, 0.090957872569561, 0.09523959457874298, 0.09541010111570358, 0.09306386113166809, 0.08919848501682281], [0.09061618149280548, 0.0910700261592865, 0.0903492346405983, 0.0903795138001442, 0.0904097929596901, 0.09089332818984985, 0.09092378616333008, 0.09171059727668762, 0.09174133092164993, 0.09131445735692978, 0.09059172868728638], [0.09274278581142426, 0.08982784301042557, 0.0945083498954773, 0.09430615603923798, 0.09410440176725388, 0.09094997495412827, 0.090755395591259, 0.08589205890893936, 0.08570830523967743, 0.0883018970489502, 0.09290289133787155]], [[0.09119182080030441, 0.0927271842956543, 0.09043008089065552, 0.0913696140050888, 0.09201234579086304, 0.09148833900690079, 0.09302868694067001, 0.09072411805391312, 0.08414117991924286, 0.09275969862937927, 0.09012693166732788], [0.09176388382911682, 0.0999809205532074, 0.08789414167404175, 0.09268654137849808, 0.09608455002307892, 0.09330680221319199, 0.10166199505329132, 0.08937199413776398, 0.06069689616560936, 0.10016115009784698, 0.08639112859964371], [0.09053464978933334, 0.0889195129275322, 0.09135711938142776, 0.09034473448991776, 0.0896645337343216, 0.09021834284067154, 0.08860885351896286, 0.09103793650865555, 0.09873989224433899, 0.08888591080904007, 0.09168846905231476], [0.0913068950176239, 0.0935952365398407, 0.09017844498157501, 0.09157093614339828, 0.09252753108739853, 0.09174738824367523, 0.09404677152633667, 0.09061349183320999, 0.08103873580694199, 0.0936439037322998, 0.08973062038421631], [0.09161192178726196, 0.09667067974805832, 0.08917123079299927, 0.09218815714120865, 0.09429207444190979, 0.09257431328296661, 0.09768620878458023, 0.09010796993970871, 0.07070509344339371, 0.09677986800670624, 0.08821248263120651], [0.09137612581253052, 0.09417065232992172, 0.0900036171078682, 0.0916978046298027, 0.09286488592624664, 0.0919128805398941, 0.09472382813692093, 0.0905323177576065, 0.07902771234512329, 0.09423024207353592, 0.08945997059345245], [0.0917743369936943, 0.10134405642747879, 0.08731314539909363, 0.09284242987632751, 0.09679026901721954, 0.09356138110160828, 0.10331743955612183, 0.08901331573724747, 0.056899696588516235, 0.10155538469552994, 0.08558859676122665], [0.09082094579935074, 0.09040656685829163, 0.09102984517812729, 0.09077250957489014, 0.09059840440750122, 0.09074023365974426, 0.090326227247715, 0.09094894677400589, 0.09284485131502151, 0.09039788693189621, 0.0911136046051979], [0.07143054902553558, 0.05206875130534172, 0.08372712135314941, 0.0688440278172493, 0.0602865070104599, 0.06717192381620407, 0.04896445944905281, 0.07873538881540298, 0.32782310247421265, 0.051724180579185486, 0.0892239511013031], [0.09176647663116455, 0.10012885928153992, 0.08783260732889175, 0.09270484745502472, 0.09616206586360931, 0.09333575516939163, 0.10184114426374435, 0.08933460712432861, 0.060275789350271225, 0.10031241923570633, 0.08630545437335968], [0.09019415080547333, 0.08736313134431839, 0.09165088087320328, 0.08985922485589981, 0.08866411447525024, 0.08963662385940552, 0.08682311326265335, 0.09108435362577438, 0.10517919808626175, 0.08730463683605194, 0.09224060922861099]], [[0.09073267132043839, 0.09078019112348557, 0.09082772582769394, 0.0908752977848053, 0.09092289209365845, 0.09168393909931183, 0.091731958091259, 0.0905999019742012, 0.09064735472202301, 0.08998909592628479, 0.09120897948741913], [0.09069722890853882, 0.0907542034983635, 0.09081122279167175, 0.0908682718873024, 0.09092535823583603, 0.09183897823095322, 0.0918966755270958, 0.09053806960582733, 0.09059494733810425, 0.08980643004179001, 0.0912686213850975], [0.09066171199083328, 0.09072814136743546, 0.0907946228981018, 0.09086114913225174, 0.09092772006988525, 0.09199418872594833, 0.0920615941286087, 0.09047618508338928, 0.09054248780012131, 0.08962403982877731, 0.0913282036781311], [0.09062610566616058, 0.09070198237895966, 0.0907779186964035, 0.09085392206907272, 0.09092998504638672, 0.09214954823255539, 0.09222669899463654, 0.09041424095630646, 0.0904899388551712, 0.08944191783666611, 0.09138771146535873], [0.09059042483568192, 0.0906757339835167, 0.09076112508773804, 0.09084659814834595, 0.09093216061592102, 0.09230508655309677, 0.09239201247692108, 0.09035225212574005, 0.09043733775615692, 0.08926007896661758, 0.09144718199968338], [0.09001127630472183, 0.09024595469236374, 0.0904812440276146, 0.09071715176105499, 0.09095367044210434, 0.09480316191911697, 0.09505033493041992, 0.08935818821191788, 0.08959116041660309, 0.08640208095312119, 0.09238579124212265], [0.08997420221567154, 0.0902182087302208, 0.09046287089586258, 0.09070819616317749, 0.09095419198274612, 0.09496144950389862, 0.09521897882223129, 0.08929529786109924, 0.08953745663166046, 0.08622486144304276, 0.09244423359632492], [0.09083133935928345, 0.09085237234830856, 0.09087340533733368, 0.09089445322751999, 0.0909154936671257, 0.09125121682882309, 0.09127234667539597, 0.09077253937721252, 0.09079355746507645, 0.09050142019987106, 0.09104187786579132], [0.09079613536596298, 0.09082664549350739, 0.09085716307163239, 0.09088768810033798, 0.09091822803020477, 0.09140580147504807, 0.09143651276826859, 0.09071086347103119, 0.0907413437962532, 0.0903179869055748, 0.09110168367624283], [0.09127868711948395, 0.09117672592401505, 0.0910748690366745, 0.0909731388092041, 0.09087151288986206, 0.08926888555288315, 0.08916915953159332, 0.09156446158885956, 0.09146218001842499, 0.09289629012346268, 0.09026414901018143], [0.09037457406520844, 0.09051638841629028, 0.09065841883420944, 0.09080067276954651, 0.09094315022230148, 0.09324171394109726, 0.09338802099227905, 0.0899791568517685, 0.0901203528046608, 0.08817479759454727, 0.09180272370576859]], [[0.10064607113599777, 0.09322313964366913, 0.09653191268444061, 0.1016261950135231, 0.08970172703266144, 0.09443555772304535, 0.09474111348390579, 0.09057527035474777, 0.057485807687044144, 0.09338591992855072, 0.08764732629060745], [0.09325100481510162, 0.0915989801287651, 0.09234738349914551, 0.09346208721399307, 0.09077976644039154, 0.09187553822994232, 0.09194481372833252, 0.0909852534532547, 0.08182850480079651, 0.0916362777352333, 0.0902903750538826], [0.09667180478572845, 0.09245357662439346, 0.09435055404901505, 0.09721891582012177, 0.09040351957082748, 0.09315188229084015, 0.09332729130983353, 0.09091515839099884, 0.06976774334907532, 0.09254755079746246, 0.0891919806599617], [0.10155187547206879, 0.09336582571268082, 0.09700724482536316, 0.10263723880052567, 0.08950415253639221, 0.09469868987798691, 0.0950348749756813, 0.09046076238155365, 0.05493665486574173, 0.09354469180107117, 0.0872579887509346], [0.08935786038637161, 0.09040474891662598, 0.08992664515972137, 0.08922629803419113, 0.09093552827835083, 0.09022732079029083, 0.09018301963806152, 0.0908016487956047, 0.09729974716901779, 0.09038077294826508, 0.09125640243291855], [0.09452956914901733, 0.0919395312666893, 0.09310969710350037, 0.09486234933137894, 0.09066470712423325, 0.09237133711576462, 0.09247960150241852, 0.09098388254642487, 0.07715535908937454, 0.09199771285057068, 0.08990618586540222], [0.09484711289405823, 0.092020183801651, 0.09329650551080704, 0.09521083533763885, 0.09063135087490082, 0.09249099344015121, 0.09260907024145126, 0.09097890555858612, 0.07602550834417343, 0.09208361059427261, 0.08980581909418106], [0.09034975618124008, 0.09073159843683243, 0.09055756777524948, 0.09030157327651978, 0.09092412143945694, 0.09066708385944366, 0.09065096825361252, 0.09087563306093216, 0.0931786522269249, 0.09072288870811462, 0.09104015678167343], [0.03695075586438179, 0.05258205160498619, 0.04478045552968979, 0.035338062793016434, 0.06278306245803833, 0.04954463243484497, 0.0488131046295166, 0.060042914003133774, 0.487152099609375, 0.052161313593387604, 0.06985154747962952], [0.09342443197965622, 0.09164666384458542, 0.09245173633098602, 0.09365174919366837, 0.09076598286628723, 0.09194411337375641, 0.09201861917972565, 0.09098683297634125, 0.08118295669555664, 0.09168677031993866, 0.09024015814065933], [0.086952343583107, 0.08954767882823944, 0.08835671842098236, 0.08662945032119751, 0.09088119864463806, 0.08910458534955978, 0.08899415284395218, 0.0905437171459198, 0.10780924558639526, 0.089487724006176, 0.09169311076402664]], [[0.09083903580904007, 0.09088660776615143, 0.09093420952558517, 0.09098183363676071, 0.09102948009967804, 0.09061118215322495, 0.091839499771595, 0.09070611000061035, 0.09193571656942368, 0.09009458869695663, 0.09014177322387695], [0.0908246710896492, 0.09088172763586044, 0.09093882143497467, 0.09099595248699188, 0.09105312079191208, 0.09055148810148239, 0.09202580153942108, 0.0906652957201004, 0.09214146435260773, 0.08993262052536011, 0.08998911827802658], [0.09081017225980759, 0.09087671339511871, 0.09094329923391342, 0.09100992977619171, 0.09107661992311478, 0.09049168974161148, 0.09221234172582626, 0.09062434732913971, 0.09234752506017685, 0.08977080136537552, 0.08983657509088516], [0.09079554677009583, 0.09087155759334564, 0.09094763547182083, 0.09102378785610199, 0.09109999239444733, 0.09043180197477341, 0.09239913523197174, 0.09058328717947006, 0.09255391359329224, 0.08960914611816406, 0.08968416601419449], [0.09078078716993332, 0.09086628258228302, 0.09095185250043869, 0.09103750437498093, 0.09112323820590973, 0.09037181735038757, 0.09258616715669632, 0.09054211527109146, 0.09276062995195389, 0.08944765478372574, 0.08953188359737396], [0.09090612083673477, 0.09090818464756012, 0.09091024100780487, 0.09091230481863022, 0.09091436862945557, 0.09089624136686325, 0.09094923734664917, 0.09090036153793335, 0.09095336496829987, 0.09087374806404114, 0.09087580442428589], [0.09051142632961273, 0.09075688570737839, 0.09100300818681717, 0.09124980121850967, 0.0914972722530365, 0.08934321999549866, 0.09578752517700195, 0.08982846885919571, 0.09630776196718216, 0.08673969656229019, 0.08697492629289627], [0.09087850898504257, 0.09089954942464828, 0.09092060476541519, 0.0909416526556015, 0.090962715446949, 0.09077763557434082, 0.0913197472691536, 0.09081968665122986, 0.09136204421520233, 0.09054841846227646, 0.0905693843960762], [0.0904771238565445, 0.09074144065380096, 0.09100653231143951, 0.09127239882946014, 0.09153903275728226, 0.08921993523836136, 0.09617050737142563, 0.08974198997020721, 0.0967332273721695, 0.08642267435789108, 0.08667514473199844], [0.0910477265715599, 0.0909460186958313, 0.09084442257881165, 0.09074294567108154, 0.0906415805220604, 0.09153716266155243, 0.08894353359937668, 0.09133277088403702, 0.08874493092298508, 0.09266123175621033, 0.09255772083997726], [0.091035395860672, 0.09094319492578506, 0.09085109084844589, 0.09075908362865448, 0.09066716581583023, 0.09147893637418747, 0.08912598341703415, 0.09129373729228973, 0.08894555270671844, 0.09249674528837204, 0.09240306913852692]], [[0.09178926050662994, 0.09066513180732727, 0.092359259724617, 0.09057828783988953, 0.09227079153060913, 0.09156960994005203, 0.09044817835092545, 0.09105347096920013, 0.08543417602777481, 0.0917215421795845, 0.0921102911233902], [0.08644933253526688, 0.09149644523859024, 0.084019735455513, 0.09190110117197037, 0.08439131826162338, 0.08740832656621933, 0.09251143783330917, 0.08971330523490906, 0.12029486894607544, 0.08674357831478119, 0.08507055789232254], [0.09410996735095978, 0.08978735655546188, 0.09635955095291138, 0.089459627866745, 0.0960078313946724, 0.09325354546308517, 0.08897026628255844, 0.09126370400190353, 0.07157054543495178, 0.09384534507989883, 0.09537216275930405], [0.0859910100698471, 0.09150152653455734, 0.0833490714430809, 0.09194459021091461, 0.08375267684459686, 0.08703576773405075, 0.09261323511600494, 0.08955129235982895, 0.12345846742391586, 0.0863114669919014, 0.08449086546897888], [0.09376546740531921, 0.08994046598672867, 0.09574808925390244, 0.08964961022138596, 0.09543845802545547, 0.09300924837589264, 0.08921509981155396, 0.09124917536973953, 0.07357393205165863, 0.09353189170360565, 0.09487853199243546], [0.09082862734794617, 0.09092910587787628, 0.09077819436788559, 0.09093692153692245, 0.09078600257635117, 0.0908481553196907, 0.09094864875078201, 0.09089424461126328, 0.09141521155834198, 0.09083464741706848, 0.09080018103122711], [0.08529141545295715, 0.09149125963449478, 0.08233702927827835, 0.09199190139770508, 0.08278757333755493, 0.08646301180124283, 0.0927480161190033, 0.08929137140512466, 0.12833546102046967, 0.08565057814121246, 0.08361238986253738], [0.08841594308614731, 0.0913628488779068, 0.08697150647640228, 0.0915961042046547, 0.0871935486793518, 0.08898136019706726, 0.09194710850715637, 0.09032974392175674, 0.1070137768983841, 0.08858971297740936, 0.08759836852550507], [0.04711157828569412, 0.06956996768712997, 0.03873246908187866, 0.07171136885881424, 0.03992466256022453, 0.05082098767161369, 0.07504767179489136, 0.06077173352241516, 0.45590007305145264, 0.0482243113219738, 0.04218512028455734], [0.09149719029664993, 0.09075122326612473, 0.09187427908182144, 0.09069345891475677, 0.09181580692529678, 0.09135168045759201, 0.09060689061880112, 0.09100927412509918, 0.08723815530538559, 0.09145234525203705, 0.0917096734046936], [0.09312601387500763, 0.09020297229290009, 0.09463009238243103, 0.08997952193021774, 0.09439568221569061, 0.0925503671169281, 0.0896453857421875, 0.09120629727840424, 0.0773439109325409, 0.09294832497835159, 0.09397132694721222]]]}, "num_training_step_calls_per_iteration": 1, "evaluation": {"env_runners": {"module_to_env_connector": {"timers": {"connectors": {"remove_single_ts_time_rank_from_batch": 1.3510509191336759e-05, "get_actions": 4.649009050730342e-05, "normalize_and_clip_actions": 8.868106037924159e-06, "listify_data_for_vector_env": 1.1617441453310274e-05, "tensor_to_numpy": 1.75079233085756e-05, "un_batch_to_individual_items": 7.416977492218017e-06}}, "connector_pipeline_timer": 0.00013486448123411305}, "episode_len_max": 20, "num_agent_steps_sampled_lifetime": {"default_agent": 3200}, "num_module_steps_sampled_lifetime": {"default_policy": 3200}, "episode_return_max": 14.5, "env_reset_timer": 0.0005571926510292963, "rlmodule_inference_timer": 3.740134889860844e-05, "env_step_timer": 1.7377848883064536e-05, "env_to_module_connector": {"timers": {"connectors": {"add_states_from_episodes_to_batch": 2.9761212588653204e-06, "numpy_to_tensor": 1.4912270265359436e-05, "add_time_dim_to_batch_and_zero_pad": 8.316360725414621e-06, "add_observations_from_episodes_to_batch": 3.6763231482962468e-06, "batch_individual_items": 1.4273748015866057e-05}}, "connector_pipeline_timer": 6.851276780901362e-05}, "episode_len_min": 20, "env_to_module_sum_episodes_length_out": 10.3682383945743, "env_to_module_sum_episodes_length_in": 10.3682383945743, "num_env_steps_sampled_lifetime": 40400, "num_agent_steps_sampled": {"default_agent": 400}, "weights_seq_no": 8.0, "module_episode_returns_mean": {"default_policy": 0.25}, "episode_len_mean": 20.0, "sample": 0.12643274657706235, "agent_episode_returns_mean": {"default_agent": 0.25}, "episode_return_mean": 0.25, "episode_return_min": -12.5, "num_episodes": 20, "episode_duration_sec_mean": 0.005662004550686106, "num_module_steps_sampled": {"default_policy": 400}, "num_episodes_lifetime": 160, "num_env_steps_sampled": 400, "time_between_sampling": 9.444176367685044}, "num_healthy_workers": 1, "actor_manager_num_outstanding_async_reqs": 0, "num_remote_worker_restarts": 0}, "num_env_steps_sampled_lifetime": -3695000.0, "fault_tolerance": {"num_healthy_workers": 0, "num_remote_worker_restarts": 0}, "env_runner_group": {"actor_manager_num_outstanding_async_reqs": 0}, "done": false, "training_iteration": 8, "trial_id": "b9446_00000", "date": "2025-08-11_18-35-32", "timestamp": 1754930132, "time_this_iter_s": 9.98193883895874, "time_total_s": 79.20832371711731, "pid": 11415, "hostname": "Mac", "node_ip": "127.0.0.1", "config": {"exploration_config": {}, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 2, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "env": "Umbrella", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": false, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 0, "create_local_env_runner": true, "num_envs_per_env_runner": 1, "gym_env_vectorize_mode": "SYNC", "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "episodes_to_numpy": true, "max_requests_in_flight_per_env_runner": 1, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "merge_env_runner_states": "training_only", "broadcast_env_runner_states": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "complete_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "sampler_perf_stats_ema_coef": null, "_is_online": true, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": "auto", "num_aggregator_actors_per_learner": 0, "max_requests_in_flight_per_aggregator_actor": 3, "local_gpu_idx": 0, "max_requests_in_flight_per_learner": 3, "gamma": 1, "lr": 0.0002715581955, "grad_clip": 0.5, "grad_clip_by": "global_norm", "_train_batch_size_per_learner": 5000, "train_batch_size": 4000, "num_epochs": 1, "minibatch_size": 1000, "shuffle_batch_per_epoch": true, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "log_std_clip_param": 20.0, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "_disable_preprocessor_api": false, "_disable_action_flattening": false}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {"intrinsic_reward_coeff": 0.2795015916508}, "optimizer": {}, "_learner_class": "<class 'source.intrinsic_attention_ppo.learners.IntrinsicAttentionMetaLearner.IntrinsicAttentionMetaLearner'>", "callbacks_on_algorithm_init": null, "callbacks_on_env_runners_recreated": null, "callbacks_on_offline_eval_runners_recreated": null, "callbacks_on_checkpoint_loaded": null, "callbacks_on_environment_created": null, "callbacks_on_episode_created": null, "callbacks_on_episode_start": null, "callbacks_on_episode_step": null, "callbacks_on_episode_end": null, "callbacks_on_evaluate_start": null, "callbacks_on_evaluate_end": null, "callbacks_on_evaluate_offline_start": null, "callbacks_on_evaluate_offline_end": null, "callbacks_on_sample_end": null, "callbacks_on_train_result": null, "explore": true, "enable_rl_module_and_learner": true, "enable_env_runner_and_connector_v2": true, "_prior_exploration_config": {"type": "StochasticSampling"}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x3884998a0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "offline_data_class": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_read_batch_size": null, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "materialize_data": false, "materialize_mapped_data": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "ignore_final_observation": false, "prelearner_class": null, "prelearner_buffer_class": null, "prelearner_buffer_kwargs": {}, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_remaining_data": false, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": 1, "evaluation_duration": 20, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_auto_duration_min_env_steps_per_sample": 100, "evaluation_auto_duration_max_env_steps_per_sample": 2000, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 1, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "offline_evaluation_interval": null, "num_offline_eval_runners": 0, "offline_loss_for_module_fn": null, "offline_evaluation_duration": 1, "offline_evaluation_parallel_to_training": false, "offline_evaluation_timeout_s": 120.0, "num_cpus_per_offline_eval_runner": 1, "num_gpus_per_offline_eval_runner": 0, "custom_resources_per_offline_eval_runner": {}, "restart_failed_offline_eval_runners": true, "ignore_offline_eval_runner_failures": false, "max_num_offline_eval_runner_restarts": 1000, "offline_eval_runner_restore_timeout_s": 1800.0, "max_requests_in_flight_per_offline_eval_runner": 1, "validate_offline_eval_runners_after_construction": true, "offline_eval_runner_health_probe_timeout_s": 30.0, "offline_eval_rl_module_inference_only": false, "broadcast_offline_eval_runner_states": false, "offline_eval_batch_size_per_runner": 256, "dataset_num_iters_per_eval_runner": 1, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "log_gradients": false, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 7, "restart_failed_env_runners": true, "ignore_env_runner_failures": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30.0, "env_runner_restore_timeout_s": 1800.0, "_model_config": {}, "_rl_module_spec": "MultiRLModuleSpec(multi_rl_module_class=<class 'ray.rllib.core.rl_module.multi_rl_module.MultiRLModule'>, observation_space=None, action_space=None, inference_only=False, model_config=None, rl_module_specs={'default_policy': RLModuleSpec(module_class=<class 'source.intrinsic_attention_ppo.rl_modules.DifferentiablePPOModule.DifferentiablePPOModule'>, observation_space=None, action_space=None, inference_only=False, learner_only=False, model_config={'vf_share_layers': True, 'embedding_dim': 62, 'max_seq_len': 11, 'policy_head_hidden_sizes': [32], 'value_head_hidden_sizes': [101], 'embedding_hidden_sizes': [121]}, catalog_class=None, load_state_path=None, model_config_dict=None), 'intrinsic_reward_module': RLModuleSpec(module_class=<class 'source.intrinsic_attention_ppo.rl_modules.IntrinsicAttentionModule.IntrinsicAttentionModule'>, observation_space=None, action_space=None, inference_only=False, learner_only=True, model_config={'intrinsic_reward_network': {'encoder_hidden_sizes': [], 'encoding_dim': 1, 'num_heads': 1, 'head_hidden_sizes': None, 'layers': [{'type': 'attention'}]}, 'extrinsic_value_hidden_layers': [127, 60], 'vf_share_layers': True, 'max_seq_len': 11}, catalog_class=None, load_state_path=None, model_config_dict=None)}, load_state_path=None, modules_to_load=None, module_specs={'default_policy': RLModuleSpec(module_class=<class 'source.intrinsic_attention_ppo.rl_modules.DifferentiablePPOModule.DifferentiablePPOModule'>, observation_space=None, action_space=None, inference_only=False, learner_only=False, model_config={'vf_share_layers': True, 'embedding_dim': 62, 'max_seq_len': 11, 'policy_head_hidden_sizes': [32], 'value_head_hidden_sizes': [101], 'embedding_hidden_sizes': [121]}, catalog_class=None, load_state_path=None, model_config_dict=None), 'intrinsic_reward_module': RLModuleSpec(module_class=<class 'source.intrinsic_attention_ppo.rl_modules.IntrinsicAttentionModule.IntrinsicAttentionModule'>, observation_space=None, action_space=None, inference_only=False, learner_only=True, model_config={'intrinsic_reward_network': {'encoder_hidden_sizes': [], 'encoding_dim': 1, 'num_heads': 1, 'head_hidden_sizes': None, 'layers': [{'type': 'attention'}]}, 'extrinsic_value_hidden_layers': [127, 60], 'vf_share_layers': True, 'max_seq_len': 11}, catalog_class=None, load_state_path=None, model_config_dict=None)})", "algorithm_config_overrides_per_module": {"intrinsic_reward_module": {"lr": 0.0002715581955}}, "_per_module_overrides": {}, "_validate_config": true, "_use_msgpack_checkpoints": false, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "env_task_fn": -1, "enable_connectors": -1, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.161583927863, "kl_target": 0.0201019014258, "vf_loss_coeff": 0.7790510010087, "entropy_coeff": 0.0015431216992, "clip_param": 0.2459212356676, "vf_clip_param": 0.3769744131561, "entropy_coeff_schedule": null, "lr_schedule": null, "sgd_minibatch_size": -1, "vf_share_layers": -1, "differentiable_learner_configs": ["DifferentiableLearnerConfig(learner_class=<class 'source.intrinsic_attention_ppo.learners.IntrinsicAttentionPPOLearner.IntrinsicAttentionPPOLearner'>, learner_connector=None, add_default_connectors_to_learner_pipeline=True, is_multi_agent=False, policies_to_update=['default_policy'], lr=0.0060984166342, num_total_minibatches=0, num_epochs=1, minibatch_size=1000, shuffle_batch_per_epoch=True)"], "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9485408017724, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.callbacks.callbacks.RLlibCallback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 79.20832371711731, "iterations_since_restore": 8, "perf": {"cpu_util_percent": 57.35714285714287, "ram_util_percent": 80.39285714285715}}
{"timers": {"training_iteration": 10.194200209493049, "restore_env_runners": 1.2708402173198108e-05, "training_step": 10.193995417137764, "env_runner_sampling_timer": 2.5338168711677027, "learner_update_timer": 7.406406186230497, "synch_weights": 0.00176602818899451, "restore_eval_env_runners": 4.4448136092263095e-05, "evaluation_iteration": 0.13801196711895689, "synch_eval_env_connectors": 0.00018303797480063416, "synch_env_connectors": 4.745031928155359e-06}, "env_runners": {"env_reset_timer": 5.087504705095483e-05, "num_episodes_lifetime": -215625.0, "num_env_steps_sampled_lifetime": -4312500.0, "num_env_steps_sampled": 5000.0, "module_to_env_connector": {"timers": {"connectors": {"remove_single_ts_time_rank_from_batch": 1.273267605886835e-05, "get_actions": 4.435236416084489e-05, "listify_data_for_vector_env": 1.143328877692806e-05, "tensor_to_numpy": 1.6621031640100806e-05, "un_batch_to_individual_items": 7.087358485473792e-06, "normalize_and_clip_actions": 8.57064814386526e-06}}, "connector_pipeline_timer": 0.00012896544068533554}, "module_episode_returns_mean": {"default_policy": -0.14000000000000007}, "time_between_sampling": 0.034050179228687236, "rlmodule_inference_timer": 3.5148369056253226e-05, "env_step_timer": 1.5515146782384326e-05, "env_to_module_connector": {"timers": {"connectors": {"batch_individual_items": 1.355064601918694e-05, "add_observations_from_episodes_to_batch": 3.1424165323113405e-06, "add_states_from_episodes_to_batch": 2.9063907946310545e-06, "numpy_to_tensor": 1.3922612278797934e-05, "add_time_dim_to_batch_and_zero_pad": 7.939709786119651e-06}}, "connector_pipeline_timer": 6.480601109048368e-05}, "weights_seq_no": 8.0, "num_agent_steps_sampled": {"default_agent": 5000.0}, "episode_len_min": 20, "episode_len_mean": 20.0, "num_episodes": 250.0, "sample": 0.006087658829391318, "episode_duration_sec_mean": 0.0057543968250975, "episode_len_max": 20, "num_module_steps_sampled": {"default_policy": 5000.0}, "num_agent_steps_sampled_lifetime": {"default_agent": -4312500.0}, "num_module_steps_sampled_lifetime": {"default_policy": -4312500.0}, "env_to_module_sum_episodes_length_out": 10.36823839457432, "agent_episode_returns_mean": {"default_agent": -0.14000000000000007}, "episode_return_max": 10.5, "episode_return_min": -9.5, "env_to_module_sum_episodes_length_in": 10.36823839457432, "episode_return_mean": -0.14000000000000007, "num_env_steps_sampled_lifetime_throughput": 2979.300978624433}, "__all_modules__": {"learner_connector_sum_episodes_length_in": 5000.0, "learner_connector": {"connector_pipeline_timer": 0.21176558772101137, "timers": {"connectors": {"add_one_ts_to_episodes_and_truncate": 0.009155775528191693, "add_observations_from_episodes_to_batch": 0.0009674932608748897, "add_columns_from_episodes_to_train_batch": 0.09785818111414325, "add_time_dim_to_batch_and_zero_pad": 0.08781867756642338, "add_states_from_episodes_to_batch": 0.003620355988914417, "batch_individual_items": 0.012056338278564251, "numpy_to_tensor": 8.873098947838294e-05}}}, "learner_connector_sum_episodes_length_out": 5250.0}, "learners": {"differentiable_learners": {"intrinsic_attention_ppo_learner": {"intrinsic_reward_module": {"num_module_steps_trained_lifetime": 323190, "weights_seq_no": 54.0, "total_loss": 0.0, "num_module_steps_trained": 35910, "diff_num_grad_updates_vs_sampler_policy": 46.0, "module_train_batch_size_mean": 997.5168494263723}, "default_policy": {"module_train_batch_size_mean": 997.5168494263723, "use_intrinsic_rewards": 1.0, "num_module_steps_trained_lifetime": 323190, "policy_loss": -2.5463054043939337e-05, "mean_kl_loss": 1.6859406741787097e-06, "entropy": 0.6917799115180969, "weights_seq_no": 54.0, "vf_loss_unclipped": 45.282562255859375, "vf_loss": 0.3583914637565613, "total_loss": 0.278112530708313, "vf_explained_var": -0.0019032955169677734, "num_module_steps_trained": 35910, "diff_num_grad_updates_vs_sampler_policy": 46.0}, "__all_modules__": {"num_env_steps_trained_lifetime": 1782000, "num_module_steps_trained": 71820, "num_module_steps_trained_lifetime": 646380, "num_env_steps_trained": 198000, "num_env_steps_trained_lifetime_throughput": 52070.87371372054}}}, "intrinsic_reward_module": {"num_module_steps_trained": 5985, "curr_entropy_coeff": 0.0015431216992, "total_loss": 0.0, "num_module_steps_trained_lifetime": 53865, "gradients_default_optimizer_global_norm": 0.0, "diff_num_grad_updates_vs_sampler_policy": 1.0, "module_train_batch_size_mean": 997.7895308613665, "default_optimizer_learning_rate": 0.0002715581955, "num_trainable_parameters": 8266, "weights_seq_no": 9.0, "num_module_steps_trained_lifetime_throughput": 804.5727463287794}, "__all_modules__": {"num_trainable_parameters": 24861, "num_non_trainable_parameters": 0, "num_env_steps_trained_lifetime": 297000, "num_module_steps_trained": 11970, "num_module_steps_trained_lifetime": 107730, "num_env_steps_trained": 33000, "num_env_steps_trained_lifetime_throughput": 4437.76179118661, "num_module_steps_trained_throughput": 26729829.00090236, "num_module_steps_trained_lifetime_throughput": 13232433.563123511}, "default_policy": {"vf_loss": 0.35830509662628174, "weights_seq_no": 9.0, "curr_entropy_coeff": 0.0015431216992, "vf_loss_unclipped": 45.103370666503906, "total_loss": 0.2780440151691437, "vf_explained_var": -0.00018703937530517578, "num_module_steps_trained": 5985, "diff_num_grad_updates_vs_sampler_policy": 1.0, "curr_kl_coeff": 0.00031559361377730966, "use_intrinsic_rewards": 0.0, "module_train_batch_size_mean": 997.7895308613665, "num_module_steps_trained_lifetime": 53865, "policy_loss": -2.640215643623378e-05, "num_trainable_parameters": 16595, "mean_kl_loss": 1.7377003587171203e-06, "entropy": 0.6917814016342163, "num_module_steps_trained_lifetime_throughput": 804.5581979336764}, "IntrinsicAttentionMask": [[[0.09353513270616531, 0.09070897847414017, 0.09052252769470215, 0.09504944831132889, 0.09015078097581863, 0.0917973518371582, 0.08706628531217575, 0.08688732981681824, 0.08670873194932938, 0.09388323128223419, 0.09369026124477386], [0.09154931455850601, 0.09086877107620239, 0.09082330763339996, 0.09190758317708969, 0.09073245525360107, 0.09113272279500961, 0.0899675041437149, 0.08992250263690948, 0.08987751603126526, 0.09163205325603485, 0.09158621728420258], [0.09141579270362854, 0.09087763726711273, 0.09084165841341019, 0.09169875830411911, 0.09076974540948868, 0.09108646214008331, 0.09016365557909012, 0.09012795984745026, 0.09009227901697159, 0.09148115664720535, 0.0914449468255043], [0.09457015246152878, 0.0906047597527504, 0.0903448536992073, 0.09671460092067719, 0.0898272767663002, 0.09212615340948105, 0.08556558191776276, 0.0853201374411583, 0.08507538586854935, 0.09506189823150635, 0.09478920698165894], [0.09114857763051987, 0.09089463949203491, 0.09087763726711273, 0.09128179401159286, 0.09084363281726837, 0.09099327027797699, 0.09055650234222412, 0.09053955972194672, 0.09052261710166931, 0.09117937833070755, 0.0911623165011406], [0.09232252836227417, 0.0908127948641777, 0.09071243554353714, 0.09312278777360916, 0.09051205217838287, 0.0913967415690422, 0.08883439749479294, 0.08873622864484787, 0.08863815665245056, 0.0925070121884346, 0.09240478277206421], [0.0888822078704834, 0.09100089222192764, 0.09114477038383484, 0.08779290318489075, 0.09143321216106415, 0.09017132222652435, 0.09391025453805923, 0.09405873715877533, 0.09420745074748993, 0.08862905949354172, 0.08876918256282806], [0.08874797075986862, 0.09100505709648132, 0.09115845710039139, 0.08758889138698578, 0.09146604686975479, 0.09012087434530258, 0.09411011636257172, 0.09426875412464142, 0.0944276675581932, 0.08847851306200027, 0.08862766623497009], [0.08861370384693146, 0.0910089835524559, 0.09117191284894943, 0.08738511800765991, 0.09149865806102753, 0.0900702252984047, 0.09431016445159912, 0.09447900205850601, 0.09464815258979797, 0.08832800388336182, 0.08848614245653152], [0.09377481043338776, 0.09068611264228821, 0.09048264473676682, 0.09543334692716599, 0.09007709473371506, 0.09187456220388412, 0.08671804517507553, 0.08652348816394806, 0.08632936328649521, 0.09415585547685623, 0.09394460916519165], [0.09364207834005356, 0.09069886803627014, 0.09050482511520386, 0.09522061049938202, 0.09011799097061157, 0.09183187782764435, 0.08691085129976273, 0.0867249146103859, 0.0865393802523613, 0.09400484710931778, 0.09380373358726501]], [[0.09916511178016663, 0.09948597103357315, 0.09511148929595947, 0.09244676679372787, 0.09572798013687134, 0.09304597973823547, 0.09334704279899597, 0.09666021168231964, 0.05663991719484329, 0.09201179444789886, 0.08635763078927994], [0.09941504150629044, 0.09974712878465652, 0.09522264450788498, 0.09246981143951416, 0.09585987031459808, 0.09308861941099167, 0.09339956939220428, 0.09682372212409973, 0.055763836950063705, 0.09202070534229279, 0.08618911355733871], [0.0958462655544281, 0.09602674096822739, 0.0935448482632637, 0.09200958907604218, 0.09389745444059372, 0.09235641360282898, 0.09253031015396118, 0.09442886710166931, 0.0691719576716423, 0.09175723791122437, 0.08843032270669937], [0.09348338842391968, 0.09357341378927231, 0.0923280417919159, 0.0915495827794075, 0.09250594675540924, 0.09172599017620087, 0.091814324259758, 0.09277345985174179, 0.07911506295204163, 0.09142102301120758, 0.08970969170331955], [0.09637140482664108, 0.09657303988933563, 0.09380391240119934, 0.0920950397849083, 0.09419683367013931, 0.09248080849647522, 0.09267430007457733, 0.09478931874036789, 0.06707747280597687, 0.09181445837020874, 0.0881233811378479], [0.09402842819690704, 0.09413863718509674, 0.09261608123779297, 0.09166663140058517, 0.09283331781625748, 0.0918816328048706, 0.09198933094739914, 0.09316013008356094, 0.07674632221460342, 0.09150999039411545, 0.08942955732345581], [0.09429918974637985, 0.09441957622766495, 0.09275754541158676, 0.09172233939170837, 0.09299453347921371, 0.09195668250322342, 0.09207407385110855, 0.09335115551948547, 0.07558631151914597, 0.09155165404081345, 0.08928702026605606], [0.09715110063552856, 0.09738487005233765, 0.09418083727359772, 0.09221062809228897, 0.09463462233543396, 0.09265492111444473, 0.09287787228822708, 0.09531941264867783, 0.06404522061347961, 0.09188765287399292, 0.08765286952257156], [0.03842075169086456, 0.03785346820950508, 0.046561937779188156, 0.053071290254592896, 0.045197103172540665, 0.05151565372943878, 0.05075502395629883, 0.04322449117898941, 0.5065334439277649, 0.05423643812537193, 0.07263045012950897], [0.09308256208896637, 0.09315799176692963, 0.0921134278178215, 0.09145935624837875, 0.09226278215646744, 0.09160765260457993, 0.09168189764022827, 0.09248727560043335, 0.0808858796954155, 0.09135125577449799, 0.08990994095802307], [0.08743175864219666, 0.08732340484857559, 0.08884387463331223, 0.08981835842132568, 0.08862379938364029, 0.08959586173295975, 0.08948482573032379, 0.08829469233751297, 0.10840366780757904, 0.08998112380504608, 0.09219866991043091]], [[0.09308468550443649, 0.09498177468776703, 0.09478653967380524, 0.09459171444177628, 0.09439728409051895, 0.08682546764612198, 0.08664699643850327, 0.09098010510206223, 0.08629116415977478, 0.08879837393760681, 0.08861584961414337], [0.09413731843233109, 0.09702516347169876, 0.09672663360834122, 0.09642902761697769, 0.09613233059644699, 0.0848175436258316, 0.08455657958984375, 0.09096771478652954, 0.08403705060482025, 0.08772023767232895, 0.08745034039020538], [0.09403093159198761, 0.09681632369756699, 0.09652851521968842, 0.09624157100915909, 0.09595547616481781, 0.08502154797315598, 0.08476880192756653, 0.09097044169902802, 0.0842655673623085, 0.08783099055290222, 0.08756989985704422], [0.09392430633306503, 0.09660756587982178, 0.0963304415345192, 0.09605411440134048, 0.09577856957912445, 0.08522570133209229, 0.08498123288154602, 0.09097281843423843, 0.08449437469244003, 0.08794155716896057, 0.08768929541110992], [0.09381747245788574, 0.09639891982078552, 0.09613242745399475, 0.09586668014526367, 0.09560166299343109, 0.08543005585670471, 0.08519389480352402, 0.09097487479448318, 0.08472351729869843, 0.08805195987224579, 0.08780854195356369], [0.0893026813864708, 0.08802004158496857, 0.08815000206232071, 0.08828015625476837, 0.08841050416231155, 0.09387332946062088, 0.09401193261146545, 0.09077918529510498, 0.09428975731134415, 0.09237302839756012, 0.09250941127538681], [0.08918759226799011, 0.08781663328409195, 0.08795548230409622, 0.0880945473909378, 0.0882338285446167, 0.09408415853977203, 0.09423291683197021, 0.09076748043298721, 0.09453113377094269, 0.09247497469186783, 0.09262117743492126], [0.09186702966690063, 0.092678502202034, 0.0925954207777977, 0.09251240640878677, 0.09242947399616241, 0.08912142366170883, 0.08904153108596802, 0.09095581620931625, 0.0888819545507431, 0.08999855816364288, 0.0899178683757782], [0.08895689994096756, 0.08741028606891632, 0.0875667855143547, 0.08772355318069458, 0.08788060396909714, 0.09450622648000717, 0.09467542171478271, 0.09074310958385468, 0.09501472115516663, 0.09267819672822952, 0.09284412115812302], [0.09054756164550781, 0.09025057405233383, 0.09028081595897675, 0.09031107276678085, 0.09034133702516556, 0.09157976508140564, 0.09161045402288437, 0.09088537842035294, 0.09167186170816422, 0.09124531596899033, 0.0912758931517601], [0.0904344767332077, 0.09004560858011246, 0.09008519351482391, 0.09012479335069656, 0.09016440808773041, 0.091789111495018, 0.09182945638895035, 0.09087729454040527, 0.09191020578145981, 0.09134966135025024, 0.09138981997966766]], [[0.09910030663013458, 0.09942096471786499, 0.09504933655261993, 0.10006538033485413, 0.08832404762506485, 0.10071397572755814, 0.09328604489564896, 0.08918417990207672, 0.05660289525985718, 0.09195166826248169, 0.08630120009183884], [0.09934572875499725, 0.09967758506536484, 0.09515625238418579, 0.10034462809562683, 0.08821388334035873, 0.10101612657308578, 0.09333445131778717, 0.08910084515810013, 0.05572494864463806, 0.09195654839277267, 0.08612901717424393], [0.09582531452178955, 0.09600574523210526, 0.09352438896894455, 0.09636763483285904, 0.08961191773414612, 0.09673088788986206, 0.09251008182764053, 0.09011907875537872, 0.06915683299303055, 0.09173718094825745, 0.08841098845005035], [0.09983324259519577, 0.10018765181303024, 0.09536552429199219, 0.10090024769306183, 0.08798941224813461, 0.10161790251731873, 0.09342653304338455, 0.08892982453107834, 0.0540069043636322, 0.091961570084095, 0.0857812687754631], [0.08955302089452744, 0.08950905501842499, 0.09012305736541748, 0.08942117542028427, 0.09113413840532303, 0.08933338522911072, 0.0903799906373024, 0.09099997580051422, 0.09751228243112564, 0.09057816863059998, 0.09145572036504745], [0.1003163605928421, 0.10069351643323898, 0.09556879103183746, 0.10145207494497299, 0.0877595841884613, 0.10221634805202484, 0.09351237863302231, 0.08875313401222229, 0.052338287234306335, 0.0919603705406189, 0.08542913943529129], [0.09428975731134415, 0.09441013634204865, 0.09274826943874359, 0.09465134888887405, 0.0900987759232521, 0.09489317238330841, 0.09206487238407135, 0.09044428914785385, 0.07557874917984009, 0.09154249727725983, 0.08927808701992035], [0.09042168408632278, 0.09040560573339462, 0.09062965959310532, 0.0903734564781189, 0.09099651128053665, 0.09034132212400436, 0.09072313457727432, 0.09094797819852829, 0.09325285255908966, 0.0907951146364212, 0.0911126360297203], [0.03814930096268654, 0.0375860221683979, 0.04623297601938248, 0.036484286189079285, 0.06481955200433731, 0.03541485220193863, 0.050396423786878586, 0.06199052557349205, 0.5029554963111877, 0.05385325476527214, 0.07211732119321823], [0.09307882934808731, 0.09315426647663116, 0.09210973978042603, 0.0933053120970726, 0.09043021500110626, 0.09345660358667374, 0.09167822450399399, 0.09065025299787521, 0.08088264614343643, 0.0913475975394249, 0.08990634232759476], [0.08742380887269974, 0.08731546252965927, 0.08883579075336456, 0.08709916472434998, 0.09137395769357681, 0.08688341081142426, 0.08947668969631195, 0.0910346508026123, 0.10839381814002991, 0.08997293561697006, 0.09219028800725937]], [[0.09355886280536652, 0.09073198586702347, 0.09054549038410187, 0.09035938233137131, 0.09487814456224442, 0.09182063490152359, 0.08708837628364563, 0.09144355356693268, 0.09125559777021408, 0.08925071358680725, 0.08906726539134979], [0.09155070036649704, 0.09087014198303223, 0.0908246785402298, 0.09077924489974976, 0.0918629989027977, 0.09113410860300064, 0.08996886759996414, 0.09104294329881668, 0.09099739789962769, 0.09050709754228592, 0.09046182036399841], [0.09141664952039719, 0.09087849408388138, 0.09084251523017883, 0.09080655127763748, 0.09166332334280014, 0.09108731895685196, 0.09016449749469757, 0.09101521223783493, 0.0909791886806488, 0.09059107303619385, 0.09055520594120026], [0.0912826806306839, 0.09088672697544098, 0.09086024016141891, 0.09083374589681625, 0.09146396815776825, 0.09104044735431671, 0.09036044776439667, 0.09098738431930542, 0.09096086025238037, 0.0906750038266182, 0.09064856916666031], [0.09448100626468658, 0.09066041558980942, 0.0904097929596901, 0.09015986323356628, 0.09627781808376312, 0.09212695807218552, 0.08579643070697784, 0.09161829948425293, 0.0913650318980217, 0.08867470920085907, 0.08842957764863968], [0.09232932329177856, 0.09081947803497314, 0.09071911126375198, 0.09061885625123978, 0.09302671998739243, 0.09140346944332123, 0.08884093910455704, 0.09120155870914459, 0.0911007672548294, 0.09001964330673218, 0.08992015570402145], [0.08889564871788025, 0.09101464599370956, 0.09115855395793915, 0.09130268543958664, 0.08794500678777695, 0.09018495678901672, 0.09392445534467697, 0.09047035872936249, 0.09061340242624283, 0.09217225760221481, 0.09231799840927124], [0.0920603796839714, 0.09083740413188934, 0.09075596183538437, 0.09067460149526596, 0.0926240012049675, 0.09131088852882385, 0.08922892808914185, 0.09114724397659302, 0.09106553345918655, 0.09018796682357788, 0.09010711312294006], [0.09192603826522827, 0.09084618836641312, 0.09077423065900803, 0.09070232510566711, 0.09242312610149384, 0.09126446396112442, 0.08942339569330215, 0.0911199301481247, 0.0910477563738823, 0.09027208387851715, 0.09020057320594788], [0.09048052132129669, 0.09093368798494339, 0.09096415340900421, 0.09099464118480682, 0.09027444571256638, 0.09075725078582764, 0.09154261648654938, 0.09081808477640152, 0.09084852039813995, 0.09117774665355682, 0.09120830148458481], [0.09034710377454758, 0.09094110876321793, 0.09098108857870102, 0.09102107584476471, 0.09007730334997177, 0.09070972353219986, 0.09174073487520218, 0.09078949689865112, 0.09082940220832825, 0.09126140922307968, 0.09130152314901352]], [[0.09169021993875504, 0.09164629876613617, 0.09225960820913315, 0.09048055857419968, 0.09217123687267303, 0.09147081524133682, 0.09035059064626694, 0.0909552350640297, 0.08534199744462967, 0.09162258356809616, 0.09201090782880783], [0.09152273833751678, 0.09148845076560974, 0.09196691960096359, 0.09057708084583282, 0.09189802408218384, 0.09135141968727112, 0.09047531336545944, 0.09094848483800888, 0.08652865886688232, 0.09146993607282639, 0.09177298098802567], [0.09372097998857498, 0.09354978054761887, 0.09596126526594162, 0.08908985555171967, 0.09561099112033844, 0.09286809712648392, 0.08860251307487488, 0.09088647365570068, 0.07127469778060913, 0.09345745295286179, 0.0949779599905014], [0.08644940704107285, 0.08665845543146133, 0.08379339426755905, 0.09243474155664444, 0.08419914543628693, 0.08749974519014359, 0.09310693293809891, 0.09002866595983505, 0.12411662936210632, 0.08677157014608383, 0.08494127541780472], [0.0934223085641861, 0.09327112883329391, 0.09539768099784851, 0.08932152390480042, 0.09508918225765228, 0.09266886860132217, 0.08888860046863556, 0.09091522544622421, 0.07330465316772461, 0.09318958967924118, 0.09453130513429642], [0.09083740413188934, 0.09084130823612213, 0.09078696370124817, 0.09094570577144623, 0.09079477190971375, 0.09085693210363388, 0.09095743298530579, 0.09090302139520645, 0.09142404049634933, 0.09084341675043106, 0.09080895036458969], [0.08580338209867477, 0.08603782206773758, 0.08283126354217529, 0.09254409372806549, 0.08328451961278915, 0.08698201179504395, 0.09330474585294724, 0.08982735127210617, 0.1291058510541916, 0.08616470545530319, 0.08411427587270737], [0.08866723626852036, 0.08878035098314285, 0.08721868693828583, 0.09185643494129181, 0.08744136244058609, 0.08923425525426865, 0.09220843762159348, 0.09058646857738495, 0.10731792449951172, 0.0888414978981018, 0.08784734457731247], [0.04815841466188431, 0.04889397323131561, 0.03959310054779053, 0.07330484688282013, 0.040811795741319656, 0.051950253546237946, 0.07671528309583664, 0.06212210655212402, 0.4660318195819855, 0.049295876175165176, 0.04312249273061752], [0.09143166244029999, 0.0914025604724884, 0.09180847555398941, 0.09062850475311279, 0.09175004065036774, 0.09128624945878983, 0.09054199606180191, 0.0909440815448761, 0.08717565983533859, 0.09138684719800949, 0.09164398908615112], [0.09286528080701828, 0.0927501916885376, 0.09436515718698502, 0.08972760289907455, 0.09413139522075653, 0.09229125082492828, 0.08939441293478012, 0.09095093607902527, 0.0771273598074913, 0.09268809854984283, 0.09370823949575424]]]}, "num_training_step_calls_per_iteration": 1, "evaluation": {"env_runners": {"module_to_env_connector": {"timers": {"connectors": {"remove_single_ts_time_rank_from_batch": 1.1962000188303864e-05, "get_actions": 3.615495390318538e-05, "normalize_and_clip_actions": 7.91160156833046e-06, "listify_data_for_vector_env": 1.0527773857914678e-05, "tensor_to_numpy": 1.4922389029007681e-05, "un_batch_to_individual_items": 6.5450104202041164e-06}}, "connector_pipeline_timer": 0.00011451893820500832}, "episode_len_max": 20, "num_agent_steps_sampled_lifetime": {"default_agent": 3600}, "num_module_steps_sampled_lifetime": {"default_policy": 3600}, "episode_return_max": 14.5, "env_reset_timer": 0.0005550607239373365, "rlmodule_inference_timer": 3.122299655423116e-05, "env_step_timer": 1.417627433031963e-05, "env_to_module_connector": {"timers": {"connectors": {"add_states_from_episodes_to_batch": 2.7339374694593443e-06, "numpy_to_tensor": 1.1849573895970998e-05, "add_time_dim_to_batch_and_zero_pad": 7.1916719750577446e-06, "add_observations_from_episodes_to_batch": 2.891542566074167e-06, "batch_individual_items": 1.2452573966884661e-05}}, "connector_pipeline_timer": 5.960786118338741e-05}, "episode_len_min": 20, "env_to_module_sum_episodes_length_out": 10.368238394574323, "env_to_module_sum_episodes_length_in": 10.368238394574323, "num_env_steps_sampled_lifetime": 45400, "num_agent_steps_sampled": {"default_agent": 400}, "weights_seq_no": 9.0, "module_episode_returns_mean": {"default_policy": 0.65}, "episode_len_mean": 20.0, "sample": 0.12631607453106422, "agent_episode_returns_mean": {"default_agent": 0.65}, "episode_return_mean": 0.65, "episode_return_min": -12.5, "num_episodes": 20, "episode_duration_sec_mean": 0.005623481245711446, "num_module_steps_sampled": {"default_policy": 400}, "num_episodes_lifetime": 180, "num_env_steps_sampled": 400, "time_between_sampling": 9.446283198598469}, "num_healthy_workers": 1, "actor_manager_num_outstanding_async_reqs": 0, "num_remote_worker_restarts": 0}, "num_env_steps_sampled_lifetime": -4312500.0, "fault_tolerance": {"num_healthy_workers": 0, "num_remote_worker_restarts": 0}, "env_runner_group": {"actor_manager_num_outstanding_async_reqs": 0}, "done": false, "training_iteration": 9, "trial_id": "b9446_00000", "date": "2025-08-11_18-35-42", "timestamp": 1754930142, "time_this_iter_s": 9.739388942718506, "time_total_s": 88.94771265983582, "pid": 11415, "hostname": "Mac", "node_ip": "127.0.0.1", "config": {"exploration_config": {}, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 2, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "env": "Umbrella", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": false, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 0, "create_local_env_runner": true, "num_envs_per_env_runner": 1, "gym_env_vectorize_mode": "SYNC", "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "episodes_to_numpy": true, "max_requests_in_flight_per_env_runner": 1, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "merge_env_runner_states": "training_only", "broadcast_env_runner_states": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "complete_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "sampler_perf_stats_ema_coef": null, "_is_online": true, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": "auto", "num_aggregator_actors_per_learner": 0, "max_requests_in_flight_per_aggregator_actor": 3, "local_gpu_idx": 0, "max_requests_in_flight_per_learner": 3, "gamma": 1, "lr": 0.0002715581955, "grad_clip": 0.5, "grad_clip_by": "global_norm", "_train_batch_size_per_learner": 5000, "train_batch_size": 4000, "num_epochs": 1, "minibatch_size": 1000, "shuffle_batch_per_epoch": true, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "log_std_clip_param": 20.0, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "_disable_preprocessor_api": false, "_disable_action_flattening": false}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {"intrinsic_reward_coeff": 0.2795015916508}, "optimizer": {}, "_learner_class": "<class 'source.intrinsic_attention_ppo.learners.IntrinsicAttentionMetaLearner.IntrinsicAttentionMetaLearner'>", "callbacks_on_algorithm_init": null, "callbacks_on_env_runners_recreated": null, "callbacks_on_offline_eval_runners_recreated": null, "callbacks_on_checkpoint_loaded": null, "callbacks_on_environment_created": null, "callbacks_on_episode_created": null, "callbacks_on_episode_start": null, "callbacks_on_episode_step": null, "callbacks_on_episode_end": null, "callbacks_on_evaluate_start": null, "callbacks_on_evaluate_end": null, "callbacks_on_evaluate_offline_start": null, "callbacks_on_evaluate_offline_end": null, "callbacks_on_sample_end": null, "callbacks_on_train_result": null, "explore": true, "enable_rl_module_and_learner": true, "enable_env_runner_and_connector_v2": true, "_prior_exploration_config": {"type": "StochasticSampling"}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x3884998a0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "offline_data_class": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_read_batch_size": null, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "materialize_data": false, "materialize_mapped_data": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "ignore_final_observation": false, "prelearner_class": null, "prelearner_buffer_class": null, "prelearner_buffer_kwargs": {}, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_remaining_data": false, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": 1, "evaluation_duration": 20, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_auto_duration_min_env_steps_per_sample": 100, "evaluation_auto_duration_max_env_steps_per_sample": 2000, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 1, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "offline_evaluation_interval": null, "num_offline_eval_runners": 0, "offline_loss_for_module_fn": null, "offline_evaluation_duration": 1, "offline_evaluation_parallel_to_training": false, "offline_evaluation_timeout_s": 120.0, "num_cpus_per_offline_eval_runner": 1, "num_gpus_per_offline_eval_runner": 0, "custom_resources_per_offline_eval_runner": {}, "restart_failed_offline_eval_runners": true, "ignore_offline_eval_runner_failures": false, "max_num_offline_eval_runner_restarts": 1000, "offline_eval_runner_restore_timeout_s": 1800.0, "max_requests_in_flight_per_offline_eval_runner": 1, "validate_offline_eval_runners_after_construction": true, "offline_eval_runner_health_probe_timeout_s": 30.0, "offline_eval_rl_module_inference_only": false, "broadcast_offline_eval_runner_states": false, "offline_eval_batch_size_per_runner": 256, "dataset_num_iters_per_eval_runner": 1, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "log_gradients": false, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 7, "restart_failed_env_runners": true, "ignore_env_runner_failures": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30.0, "env_runner_restore_timeout_s": 1800.0, "_model_config": {}, "_rl_module_spec": "MultiRLModuleSpec(multi_rl_module_class=<class 'ray.rllib.core.rl_module.multi_rl_module.MultiRLModule'>, observation_space=None, action_space=None, inference_only=False, model_config=None, rl_module_specs={'default_policy': RLModuleSpec(module_class=<class 'source.intrinsic_attention_ppo.rl_modules.DifferentiablePPOModule.DifferentiablePPOModule'>, observation_space=None, action_space=None, inference_only=False, learner_only=False, model_config={'vf_share_layers': True, 'embedding_dim': 62, 'max_seq_len': 11, 'policy_head_hidden_sizes': [32], 'value_head_hidden_sizes': [101], 'embedding_hidden_sizes': [121]}, catalog_class=None, load_state_path=None, model_config_dict=None), 'intrinsic_reward_module': RLModuleSpec(module_class=<class 'source.intrinsic_attention_ppo.rl_modules.IntrinsicAttentionModule.IntrinsicAttentionModule'>, observation_space=None, action_space=None, inference_only=False, learner_only=True, model_config={'intrinsic_reward_network': {'encoder_hidden_sizes': [], 'encoding_dim': 1, 'num_heads': 1, 'head_hidden_sizes': None, 'layers': [{'type': 'attention'}]}, 'extrinsic_value_hidden_layers': [127, 60], 'vf_share_layers': True, 'max_seq_len': 11}, catalog_class=None, load_state_path=None, model_config_dict=None)}, load_state_path=None, modules_to_load=None, module_specs={'default_policy': RLModuleSpec(module_class=<class 'source.intrinsic_attention_ppo.rl_modules.DifferentiablePPOModule.DifferentiablePPOModule'>, observation_space=None, action_space=None, inference_only=False, learner_only=False, model_config={'vf_share_layers': True, 'embedding_dim': 62, 'max_seq_len': 11, 'policy_head_hidden_sizes': [32], 'value_head_hidden_sizes': [101], 'embedding_hidden_sizes': [121]}, catalog_class=None, load_state_path=None, model_config_dict=None), 'intrinsic_reward_module': RLModuleSpec(module_class=<class 'source.intrinsic_attention_ppo.rl_modules.IntrinsicAttentionModule.IntrinsicAttentionModule'>, observation_space=None, action_space=None, inference_only=False, learner_only=True, model_config={'intrinsic_reward_network': {'encoder_hidden_sizes': [], 'encoding_dim': 1, 'num_heads': 1, 'head_hidden_sizes': None, 'layers': [{'type': 'attention'}]}, 'extrinsic_value_hidden_layers': [127, 60], 'vf_share_layers': True, 'max_seq_len': 11}, catalog_class=None, load_state_path=None, model_config_dict=None)})", "algorithm_config_overrides_per_module": {"intrinsic_reward_module": {"lr": 0.0002715581955}}, "_per_module_overrides": {}, "_validate_config": true, "_use_msgpack_checkpoints": false, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "env_task_fn": -1, "enable_connectors": -1, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.161583927863, "kl_target": 0.0201019014258, "vf_loss_coeff": 0.7790510010087, "entropy_coeff": 0.0015431216992, "clip_param": 0.2459212356676, "vf_clip_param": 0.3769744131561, "entropy_coeff_schedule": null, "lr_schedule": null, "sgd_minibatch_size": -1, "vf_share_layers": -1, "differentiable_learner_configs": ["DifferentiableLearnerConfig(learner_class=<class 'source.intrinsic_attention_ppo.learners.IntrinsicAttentionPPOLearner.IntrinsicAttentionPPOLearner'>, learner_connector=None, add_default_connectors_to_learner_pipeline=True, is_multi_agent=False, policies_to_update=['default_policy'], lr=0.0060984166342, num_total_minibatches=0, num_epochs=1, minibatch_size=1000, shuffle_batch_per_epoch=True)"], "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9485408017724, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.callbacks.callbacks.RLlibCallback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 88.94771265983582, "iterations_since_restore": 9, "perf": {"cpu_util_percent": 57.207142857142856, "ram_util_percent": 82.00714285714285}}
{"timers": {"training_iteration": 10.190674163228252, "restore_env_runners": 1.2640067143626089e-05, "training_step": 10.190468940885916, "env_runner_sampling_timer": 2.5238246341250243, "learner_update_timer": 7.412587067288008, "synch_weights": 0.0017623966576974077, "restore_eval_env_runners": 4.451490425867563e-05, "evaluation_iteration": 0.13787603161768563, "synch_eval_env_connectors": 0.00018303551467551102, "synch_env_connectors": 4.742581951526007e-06}, "env_runners": {"env_reset_timer": 4.478755831591644e-05, "num_episodes_lifetime": -246500.0, "num_env_steps_sampled_lifetime": -4930000.0, "num_env_steps_sampled": 5000.0, "module_to_env_connector": {"timers": {"connectors": {"remove_single_ts_time_rank_from_batch": 1.1973810679443423e-05, "get_actions": 3.875064832245618e-05, "listify_data_for_vector_env": 1.0612871764525244e-05, "tensor_to_numpy": 1.5309514989162157e-05, "un_batch_to_individual_items": 6.571888305648435e-06, "normalize_and_clip_actions": 8.026496452360974e-06}}, "connector_pipeline_timer": 0.00011755262788460222}, "module_episode_returns_mean": {"default_policy": -0.6199999999999999}, "time_between_sampling": 0.032907024374411536, "rlmodule_inference_timer": 3.128914984800911e-05, "env_step_timer": 1.4005518421308537e-05, "env_to_module_connector": {"timers": {"connectors": {"batch_individual_items": 1.2513253693074857e-05, "add_observations_from_episodes_to_batch": 2.9003083904108027e-06, "add_states_from_episodes_to_batch": 2.7222126031657386e-06, "numpy_to_tensor": 1.2541257473978308e-05, "add_time_dim_to_batch_and_zero_pad": 7.231354154720562e-06}}, "connector_pipeline_timer": 5.987969703221743e-05}, "weights_seq_no": 9.0, "num_agent_steps_sampled": {"default_agent": 5000.0}, "episode_len_min": 20, "episode_len_mean": 20.0, "num_episodes": 250.0, "sample": 0.005804585870924885, "episode_duration_sec_mean": 0.005256637364625928, "episode_len_max": 20, "num_module_steps_sampled": {"default_policy": 5000.0}, "num_agent_steps_sampled_lifetime": {"default_agent": -4930000.0}, "num_module_steps_sampled_lifetime": {"default_policy": -4930000.0}, "env_to_module_sum_episodes_length_out": 10.36823839457432, "agent_episode_returns_mean": {"default_agent": -0.6199999999999999}, "episode_return_max": 10.5, "episode_return_min": -9.5, "env_to_module_sum_episodes_length_in": 10.36823839457432, "episode_return_mean": -0.6199999999999999, "num_env_steps_sampled_lifetime_throughput": 3236.556109108308}, "__all_modules__": {"learner_connector_sum_episodes_length_in": 5000.0, "learner_connector": {"connector_pipeline_timer": 0.21197971392380152, "timers": {"connectors": {"add_one_ts_to_episodes_and_truncate": 0.009150646522983313, "add_observations_from_episodes_to_batch": 0.0009661104077036648, "add_columns_from_episodes_to_train_batch": 0.09730054722306719, "add_time_dim_to_batch_and_zero_pad": 0.08769525038066779, "add_states_from_episodes_to_batch": 0.003619817429348479, "batch_individual_items": 0.012959610726634724, "numpy_to_tensor": 8.865159027554585e-05}}}, "learner_connector_sum_episodes_length_out": 5250.0}, "learners": {"differentiable_learners": {"intrinsic_attention_ppo_learner": {"intrinsic_reward_module": {"num_module_steps_trained_lifetime": 359100, "weights_seq_no": 60.0, "total_loss": 0.0, "num_module_steps_trained": 35910, "diff_num_grad_updates_vs_sampler_policy": 51.0, "module_train_batch_size_mean": 997.5109713823833}, "default_policy": {"module_train_batch_size_mean": 997.5109713823833, "use_intrinsic_rewards": 1.0, "num_module_steps_trained_lifetime": 359100, "policy_loss": -0.00038411744753830135, "mean_kl_loss": 1.807577609724831e-05, "entropy": 0.692067563533783, "weights_seq_no": 60.0, "vf_loss_unclipped": 45.00875473022461, "vf_loss": 0.35838159918785095, "total_loss": 0.27774837613105774, "vf_explained_var": -0.0017914772033691406, "num_module_steps_trained": 35910, "diff_num_grad_updates_vs_sampler_policy": 51.0}, "__all_modules__": {"num_env_steps_trained_lifetime": 1980000, "num_module_steps_trained": 71820, "num_module_steps_trained_lifetime": 718200, "num_env_steps_trained": 198000, "num_env_steps_trained_lifetime_throughput": 51183.78440831077}}}, "intrinsic_reward_module": {"num_module_steps_trained": 5985, "curr_entropy_coeff": 0.0015431216992, "total_loss": 0.0, "num_module_steps_trained_lifetime": 59850, "gradients_default_optimizer_global_norm": 0.0, "diff_num_grad_updates_vs_sampler_policy": 1.0, "module_train_batch_size_mean": 997.772440523815, "default_optimizer_learning_rate": 0.0002715581955, "num_trainable_parameters": 8266, "weights_seq_no": 10.0, "num_module_steps_trained_lifetime_throughput": 800.6262848994445}, "__all_modules__": {"num_trainable_parameters": 24861, "num_non_trainable_parameters": 0, "num_env_steps_trained_lifetime": 330000, "num_module_steps_trained": 11970, "num_module_steps_trained_lifetime": 119700, "num_env_steps_trained": 33000, "num_env_steps_trained_lifetime_throughput": 4415.945083104687, "num_module_steps_trained_throughput": 25983266.23102246, "num_module_steps_trained_lifetime_throughput": 13185178.075945474}, "default_policy": {"vf_loss": 0.3583047389984131, "weights_seq_no": 10.0, "curr_entropy_coeff": 0.0015431216992, "vf_loss_unclipped": 44.84967041015625, "total_loss": 0.277665913105011, "vf_explained_var": -0.0002579689025878906, "num_module_steps_trained": 5985, "diff_num_grad_updates_vs_sampler_policy": 1.0, "curr_kl_coeff": 0.00015779680688865483, "use_intrinsic_rewards": 0.0, "module_train_batch_size_mean": 997.772440523815, "num_module_steps_trained_lifetime": 59850, "policy_loss": -0.0004038122424390167, "num_trainable_parameters": 16595, "mean_kl_loss": 1.9941688151448034e-05, "entropy": 0.6920814514160156, "num_module_steps_trained_lifetime_throughput": 800.6125266775033}, "IntrinsicAttentionMask": [[[0.09115961939096451, 0.0912073627114296, 0.09008178859949112, 0.09012896567583084, 0.09017616510391235, 0.09093096107244492, 0.09097858518362045, 0.09102623164653778, 0.09226017445325851, 0.09159020334482193, 0.0904598981142044], [0.09120913594961166, 0.09126643091440201, 0.0899171456694603, 0.08997363597154617, 0.09003015607595444, 0.09093478322029114, 0.09099191427230835, 0.09104907512664795, 0.09253149479627609, 0.09172611683607101, 0.0903700441122055], [0.08999461680650711, 0.08982839435338974, 0.09385454654693604, 0.09368119388818741, 0.09350816905498505, 0.09079620242118835, 0.09062850475311279, 0.0904611125588417, 0.08626100420951843, 0.08850963413715363, 0.09247668087482452], [0.09004748612642288, 0.08989055454730988, 0.09368716925382614, 0.09352388978004456, 0.09336090832948685, 0.09080405533313751, 0.09064580500125885, 0.09048783034086227, 0.08651851862668991, 0.08864491432905197, 0.09238891303539276], [0.09010021388530731, 0.08995258063077927, 0.0935199037194252, 0.09336666762828827, 0.09321369230747223, 0.09081172198057175, 0.09066292643547058, 0.09051437675952911, 0.08677662909030914, 0.08878021687269211, 0.09230104833841324], [0.09092000871896744, 0.09092207252979279, 0.09087321162223816, 0.09087526798248291, 0.09087733179330826, 0.09091012924909592, 0.09091218560934067, 0.09091424942016602, 0.09096726030111313, 0.09093856066465378, 0.09088968485593796], [0.09097025543451309, 0.09098181873559952, 0.09070798754692078, 0.09071951359510422, 0.09073104709386826, 0.09091481566429138, 0.09092637151479721, 0.09093792736530304, 0.09123564511537552, 0.0910743772983551, 0.09080026298761368], [0.09102034568786621, 0.09104142338037491, 0.09054288268089294, 0.09056384861469269, 0.09058481454849243, 0.09091932326555252, 0.09094037860631943, 0.09096143394708633, 0.09150464087724686, 0.09121020883321762, 0.09071074426174164], [0.09225546568632126, 0.09252497553825378, 0.08634014427661896, 0.08659237623214722, 0.08684534579515457, 0.09097357094287872, 0.09123934060335159, 0.09150588512420654, 0.09863453358411789, 0.094709612429142, 0.08837875723838806], [0.0915997251868248, 0.09173387289047241, 0.08860457688570023, 0.08873434364795685, 0.0888642966747284, 0.09095896780490875, 0.09109218418598175, 0.09122558683156967, 0.09472429752349854, 0.09281417727470398, 0.08964803069829941], [0.09041357040405273, 0.09032200276851654, 0.09251884371042252, 0.0924251452088356, 0.09233154356479645, 0.09085407853126526, 0.09076206386089325, 0.090670146048069, 0.08833800256252289, 0.08959279954433441, 0.09177190065383911]], [[0.092147596180439, 0.08766647428274155, 0.08513855189085007, 0.08803579211235046, 0.08549723029136658, 0.09312117844820023, 0.08859270811080933, 0.08603807538747787, 0.11984368413686752, 0.08776605129241943, 0.08615268021821976], [0.09060240536928177, 0.09141120314598083, 0.09188926964998245, 0.09134272485971451, 0.09182042628526688, 0.09043280780315399, 0.09124009311199188, 0.09171726554632187, 0.08645560592412949, 0.09139270335435867, 0.09169549494981766], [0.0892077386379242, 0.09316115081310272, 0.09556262195110321, 0.09282110631465912, 0.09521380811929703, 0.08839591592550278, 0.09231335669755936, 0.09469297528266907, 0.07097859680652618, 0.09306921064853668, 0.09458339959383011], [0.0907762348651886, 0.09113404154777527, 0.09134469926357269, 0.09110380709171295, 0.091314397752285, 0.09070097655057907, 0.09105849266052246, 0.09126897901296616, 0.08891315758228302, 0.09112587571144104, 0.09125939011573792], [0.08942662179470062, 0.09292827546596527, 0.0950470119714737, 0.09262776374816895, 0.0947396531701088, 0.0887053981423378, 0.0921788215637207, 0.09428046643733978, 0.07303518801927567, 0.09284703433513641, 0.09418382495641708], [0.09231148660182953, 0.08674153685569763, 0.08363022655248642, 0.08719797432422638, 0.08407028764486313, 0.09353066980838776, 0.08788715302944183, 0.08473474532365799, 0.1281556934118271, 0.08686455339193344, 0.0848756730556488], [0.09102322906255722, 0.09070553630590439, 0.09051959216594696, 0.09073228389024734, 0.09054628759622574, 0.09109035134315491, 0.09077242761850357, 0.0905863419175148, 0.09271643310785294, 0.0907127633690834, 0.09059479832649231], [0.08974383771419525, 0.0925675630569458, 0.09426608681678772, 0.09232605248689651, 0.09402014315128326, 0.08915961533784866, 0.0919649600982666, 0.09365242719650269, 0.07622203975915909, 0.09250228852033615, 0.09357498586177826], [0.07153315842151642, 0.04993203282356262, 0.040433693677186966, 0.05146895721554756, 0.04167826473712921, 0.07716544717550278, 0.053863514214754105, 0.043617311865091324, 0.47592708468437195, 0.05034247040748596, 0.04403800517320633], [0.0906500443816185, 0.09133701771497726, 0.09174264222383499, 0.09127888083457947, 0.0916842520236969, 0.09050587564706802, 0.09119175374507904, 0.09159673750400543, 0.0871131494641304, 0.09132131934165955, 0.09157826751470566], [0.08980905264616013, 0.09248965233564377, 0.09410008043050766, 0.09226054698228836, 0.0938669815659523, 0.08925390988588333, 0.09191793948411942, 0.09351841360330582, 0.07691069692373276, 0.09242773056030273, 0.09344500303268433]], [[0.09225593507289886, 0.09413613379001617, 0.09394264221191406, 0.08910100907087326, 0.09355685114860535, 0.09054191410541534, 0.09035581350326538, 0.09017009288072586, 0.08552289009094238, 0.08800778537988663, 0.09240894764661789], [0.09290599077939987, 0.09575606137514114, 0.09546144306659698, 0.08818840235471725, 0.09487491101026535, 0.09033285826444626, 0.09005492180585861, 0.08977783471345901, 0.0829378217458725, 0.08657284080982208, 0.09313685446977615], [0.09284032136201859, 0.09559044986963272, 0.09530628472566605, 0.08828184008598328, 0.09474050253629684, 0.09035497158765793, 0.09008637815713882, 0.089818574488163, 0.08319859206676483, 0.08671888709068298, 0.09306319802999496], [0.09110318124294281, 0.09136398136615753, 0.09133735299110413, 0.0906551256775856, 0.09128411114215851, 0.09086142480373383, 0.09083493798971176, 0.0908084586262703, 0.09013018757104874, 0.09049669653177261, 0.09112457185983658], [0.09270855784416199, 0.09525949507951736, 0.09499615430831909, 0.08846846967935562, 0.09447166323661804, 0.09039866179227829, 0.09014876186847687, 0.08989954739809036, 0.0837220847606659, 0.0870111882686615, 0.09291548281908035], [0.09163957834243774, 0.09263855963945389, 0.09253618121147156, 0.08994189649820328, 0.09233176708221436, 0.09072064608335495, 0.09062038362026215, 0.0905202329158783, 0.08798246830701828, 0.08934715390205383, 0.09172122180461884], [0.09157124906778336, 0.09247474372386932, 0.09238219261169434, 0.09003368765115738, 0.09219737350940704, 0.09073932468891144, 0.09064850956201553, 0.09055779129266739, 0.08825566619634628, 0.08949439972639084, 0.09164512157440186], [0.09150276333093643, 0.09231101721525192, 0.09222826361656189, 0.09012538939714432, 0.09206297248601913, 0.090757817029953, 0.0906764566898346, 0.09059516340494156, 0.08852952718734741, 0.08964170515537262, 0.09156888723373413], [0.08969523757696152, 0.08813579380512238, 0.08829358220100403, 0.09244989603757858, 0.08861001580953598, 0.09116954356431961, 0.09133276343345642, 0.09149627387523651, 0.09580335021018982, 0.09344743192195892, 0.08956611901521683], [0.09068472683429718, 0.09038729220628738, 0.09041757881641388, 0.09120000898838043, 0.09047819674015045, 0.09096208214759827, 0.09099256247282028, 0.09102305769920349, 0.09181072562932968, 0.09138353168964386, 0.09066025912761688], [0.0923098474740982, 0.09426885098218918, 0.09406717121601105, 0.08902635425329208, 0.09366510808467865, 0.09052539616823196, 0.09033173322677612, 0.09013848006725311, 0.08530818670988083, 0.08788968622684479, 0.09246920794248581]], [[0.09092260897159576, 0.09245344251394272, 0.09016311913728714, 0.09257357567548752, 0.09028027206659317, 0.09269385784864426, 0.0927540585398674, 0.09191957116127014, 0.08389274030923843, 0.09248586744070053, 0.08986085653305054], [0.09031375497579575, 0.09840094298124313, 0.08650515973567963, 0.09905944019556046, 0.08708404749631882, 0.09972234070301056, 0.10005545616149902, 0.09551697224378586, 0.059737615287303925, 0.0985783189535141, 0.08502589166164398], [0.09081561118364334, 0.08919546008110046, 0.0916406437754631, 0.08907068520784378, 0.09151244163513184, 0.08894607424736023, 0.08888383209705353, 0.089754119515419, 0.09904637932777405, 0.08916175365447998, 0.09197301417589188], [0.09022634476423264, 0.09883514046669006, 0.08618853986263275, 0.09953811019659042, 0.08680156618356705, 0.10024608671665192, 0.10060195624828339, 0.09575987607240677, 0.05815471336245537, 0.0990244671702385, 0.08462322503328323], [0.09085234254598618, 0.08971210569143295, 0.0914306491613388, 0.08962403237819672, 0.09134089201688766, 0.08953604102134705, 0.0894920825958252, 0.09010597318410873, 0.09655433148145676, 0.08968831598758698, 0.0916631892323494], [0.09013371914625168, 0.09926541894674301, 0.08586803078651428, 0.10001321882009506, 0.0865149050951004, 0.10076665133237839, 0.10114549845457077, 0.09599775820970535, 0.05661042034626007, 0.09946678578853607, 0.08421751856803894], [0.09008549153804779, 0.09947911649942398, 0.08570637553930283, 0.10024946182966232, 0.0863700732588768, 0.1010257750749588, 0.10141618549823761, 0.09611484408378601, 0.055852510035037994, 0.09968654811382294, 0.08401358127593994], [0.09063732624053955, 0.0964159369468689, 0.08786620944738388, 0.09688049554824829, 0.08828957378864288, 0.09734728932380676, 0.09758152812719345, 0.0943710207939148, 0.06728865206241608, 0.09654116630554199, 0.08678077161312103], [0.07401080429553986, 0.05394954979419708, 0.08675165474414825, 0.052639201283454895, 0.08464460074901581, 0.05136068910360336, 0.050733111798763275, 0.060202356427907944, 0.3396684527397156, 0.05359254032373428, 0.09244704246520996], [0.09029066562652588, 0.09851856529712677, 0.08642005175352097, 0.09918903559446335, 0.08700817823410034, 0.09986407309770584, 0.10020331293344498, 0.09558305144309998, 0.05930633842945099, 0.0986991673707962, 0.08491746336221695], [0.09068457782268524, 0.08783815801143646, 0.09214922785758972, 0.0876205712556839, 0.09192095696926117, 0.08740352839231491, 0.08729519695043564, 0.08881518244743347, 0.1057511568069458, 0.08777935057878494, 0.09274216741323471]], [[0.09268167614936829, 0.08988130837678909, 0.08969656378030777, 0.09418217837810516, 0.09398858994245529, 0.08644954115152359, 0.08627184480428696, 0.09058620035648346, 0.09040000289678574, 0.09302660822868347, 0.09283538907766342], [0.09134411066770554, 0.09066507965326309, 0.09061972051858902, 0.09170157462358475, 0.09165570139884949, 0.08981076627969742, 0.08976583927869797, 0.0908374935388565, 0.09079204499721527, 0.09142666310071945, 0.09138092398643494], [0.09125353395938873, 0.09071633219718933, 0.09068042784929276, 0.0915360078215599, 0.09149976819753647, 0.09003926068544388, 0.0900036171078682, 0.09085281938314438, 0.09081684798002243, 0.09131879359483719, 0.09128264337778091], [0.09337183088064194, 0.08945667743682861, 0.08920006453990936, 0.09548910707235336, 0.09521518647670746, 0.08472438156604767, 0.08448134362697601, 0.09043768793344498, 0.09017826616764069, 0.09385734051465988, 0.09358810633420944], [0.09328380227088928, 0.08951161801815033, 0.0892641693353653, 0.09532134979963303, 0.09505783766508102, 0.08494408428668976, 0.08470925688743591, 0.09045735746622086, 0.0902072936296463, 0.09375117719173431, 0.09349200874567032], [0.08961222320795059, 0.09160555154085159, 0.09174080938100815, 0.08858614414930344, 0.08871694654226303, 0.09419871866703033, 0.09433780610561371, 0.09109384566545486, 0.09122835099697113, 0.08937383443117142, 0.08950579911470413], [0.08951963484287262, 0.09165351837873459, 0.09179843217134476, 0.08842252194881439, 0.08856232464313507, 0.09443444758653641, 0.09458375722169876, 0.09110541641712189, 0.09124945849180222, 0.08926466852426529, 0.08940580487251282], [0.09168702363967896, 0.09046901017427444, 0.09038790315389633, 0.09233113378286362, 0.0922483578324318, 0.08894680440425873, 0.08886706084012985, 0.09077759087085724, 0.09069621562957764, 0.09183560311794281, 0.0917532816529274], [0.09159686416387558, 0.09052088856697083, 0.09044918417930603, 0.09216517955064774, 0.09209217131137848, 0.089173823595047, 0.08910318464040756, 0.09079364687204361, 0.0907217264175415, 0.09172800183296204, 0.09165534377098083], [0.09284194558858871, 0.08978395909070969, 0.08958252519369125, 0.09448397904634476, 0.09427199512720108, 0.0860484167933464, 0.08585535734891891, 0.09055288881063461, 0.0903497263789177, 0.09321919083595276, 0.09301004558801651], [0.09275321662425995, 0.089837945997715, 0.08964574337005615, 0.09431677311658859, 0.0941149964928627, 0.08627044409513474, 0.08608587831258774, 0.09057141840457916, 0.09037764370441437, 0.09311254322528839, 0.09291334450244904]], [[0.0918891653418541, 0.09076382964849472, 0.09137123078107834, 0.09067688137292862, 0.09237122535705566, 0.09166928380727768, 0.0905466377735138, 0.09115258604288101, 0.08552717417478561, 0.09182137995958328, 0.092210553586483], [0.08604411035776138, 0.09106757491827011, 0.08831310272216797, 0.09147033095359802, 0.08399573713541031, 0.08699861168861389, 0.09207780659198761, 0.08929278701543808, 0.11973115801811218, 0.08633698523044586, 0.08467180281877518], [0.08931556344032288, 0.09106142818927765, 0.09011223167181015, 0.09119863063097, 0.08858438581228256, 0.08965236693620682, 0.09140481799840927, 0.09045203775167465, 0.0999724492430687, 0.0894191637635231, 0.08882699906826019], [0.08555234968662262, 0.09103475511074066, 0.08802498877048492, 0.09147557616233826, 0.08332542330026627, 0.08659178018569946, 0.0921408012509346, 0.08909446746110916, 0.12282884865999222, 0.08587116748094559, 0.08405985683202744], [0.09411907196044922, 0.09027964621782303, 0.09233799576759338, 0.08998769521713257, 0.09579838812351227, 0.09336001425981522, 0.08955154567956924, 0.09159329533576965, 0.0738513246178627, 0.09388461709022522, 0.09523634612560272], [0.09081985801458359, 0.09092032164335251, 0.09086593240499496, 0.09092814475297928, 0.09077723324298859, 0.09083938598632812, 0.09093987196683884, 0.0908854678273201, 0.09140641242265701, 0.0908258780837059, 0.09079141169786453], [0.0848042443394661, 0.09096868336200714, 0.08757834136486053, 0.09146647155284882, 0.08231470733880997, 0.08596915006637573, 0.09221826493740082, 0.08878134936094284, 0.12760263681411743, 0.08516135066747665, 0.08313480764627457], [0.08817045390605927, 0.09110916405916214, 0.08950653672218323, 0.0913417786359787, 0.08695144951343536, 0.08873429894447327, 0.09169180691242218, 0.0900789275765419, 0.10671667009592056, 0.08834373950958252, 0.08735515922307968], [0.04629629850387573, 0.06836613267660141, 0.05536111071705818, 0.07047047466039658, 0.039233721792697906, 0.0499415248632431, 0.07374906539916992, 0.05972007289528847, 0.44801679253578186, 0.047389764338731766, 0.04145507141947746], [0.0915631353855133, 0.09081662446260452, 0.0912199392914772, 0.09075882285833359, 0.09188197553157806, 0.09141751378774643, 0.09067218750715256, 0.0910748615860939, 0.08730100840330124, 0.09151826053857803, 0.09177576750516891], [0.09339279681444168, 0.0904613807797432, 0.09203649312257767, 0.09023728966712952, 0.09466610848903656, 0.09281550347805023, 0.08990219980478287, 0.09146758168935776, 0.07756543904542923, 0.09321460127830505, 0.09424053877592087]]]}, "num_training_step_calls_per_iteration": 1, "evaluation": {"env_runners": {"module_to_env_connector": {"timers": {"connectors": {"remove_single_ts_time_rank_from_batch": 1.1593739812871909e-05, "get_actions": 3.4686551973110705e-05, "normalize_and_clip_actions": 7.643782568929801e-06, "listify_data_for_vector_env": 1.0252655435696704e-05, "tensor_to_numpy": 1.4292137747768707e-05, "un_batch_to_individual_items": 6.331795646884871e-06}}, "connector_pipeline_timer": 0.00011076695997122763}, "episode_len_max": 20, "num_agent_steps_sampled_lifetime": {"default_agent": 4000}, "num_module_steps_sampled_lifetime": {"default_policy": 4000}, "episode_return_max": 14.5, "env_reset_timer": 0.0005524297058672866, "rlmodule_inference_timer": 2.9666337808571904e-05, "env_step_timer": 1.3611308097591346e-05, "env_to_module_connector": {"timers": {"connectors": {"add_states_from_episodes_to_batch": 2.6313616575945054e-06, "numpy_to_tensor": 1.1481161537210575e-05, "add_time_dim_to_batch_and_zero_pad": 6.986108558284928e-06, "add_observations_from_episodes_to_batch": 2.7972049250592695e-06, "batch_individual_items": 1.2181732411971653e-05}}, "connector_pipeline_timer": 5.832946939745869e-05}, "episode_len_min": 20, "env_to_module_sum_episodes_length_out": 10.368238394574323, "env_to_module_sum_episodes_length_in": 10.368238394574323, "num_env_steps_sampled_lifetime": 50400, "num_agent_steps_sampled": {"default_agent": 400}, "weights_seq_no": 10.0, "module_episode_returns_mean": {"default_policy": 1.25}, "episode_len_mean": 20.0, "sample": 0.12617466378591938, "agent_episode_returns_mean": {"default_agent": 1.25}, "episode_return_mean": 1.25, "episode_return_min": -11.5, "num_episodes": 20, "episode_duration_sec_mean": 0.005351723341736943, "num_module_steps_sampled": {"default_policy": 400}, "num_episodes_lifetime": 200, "num_env_steps_sampled": 400, "time_between_sampling": 9.450554300363256}, "num_healthy_workers": 1, "actor_manager_num_outstanding_async_reqs": 0, "num_remote_worker_restarts": 0}, "num_env_steps_sampled_lifetime": -4930000.0, "fault_tolerance": {"num_healthy_workers": 0, "num_remote_worker_restarts": 0}, "env_runner_group": {"actor_manager_num_outstanding_async_reqs": 0}, "done": false, "training_iteration": 10, "trial_id": "b9446_00000", "date": "2025-08-11_18-35-52", "timestamp": 1754930152, "time_this_iter_s": 9.96499514579773, "time_total_s": 98.91270780563354, "pid": 11415, "hostname": "Mac", "node_ip": "127.0.0.1", "config": {"exploration_config": {}, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 2, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "env": "Umbrella", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": false, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 0, "create_local_env_runner": true, "num_envs_per_env_runner": 1, "gym_env_vectorize_mode": "SYNC", "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "episodes_to_numpy": true, "max_requests_in_flight_per_env_runner": 1, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "merge_env_runner_states": "training_only", "broadcast_env_runner_states": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "complete_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "sampler_perf_stats_ema_coef": null, "_is_online": true, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": "auto", "num_aggregator_actors_per_learner": 0, "max_requests_in_flight_per_aggregator_actor": 3, "local_gpu_idx": 0, "max_requests_in_flight_per_learner": 3, "gamma": 1, "lr": 0.0002715581955, "grad_clip": 0.5, "grad_clip_by": "global_norm", "_train_batch_size_per_learner": 5000, "train_batch_size": 4000, "num_epochs": 1, "minibatch_size": 1000, "shuffle_batch_per_epoch": true, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "log_std_clip_param": 20.0, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "_disable_preprocessor_api": false, "_disable_action_flattening": false}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {"intrinsic_reward_coeff": 0.2795015916508}, "optimizer": {}, "_learner_class": "<class 'source.intrinsic_attention_ppo.learners.IntrinsicAttentionMetaLearner.IntrinsicAttentionMetaLearner'>", "callbacks_on_algorithm_init": null, "callbacks_on_env_runners_recreated": null, "callbacks_on_offline_eval_runners_recreated": null, "callbacks_on_checkpoint_loaded": null, "callbacks_on_environment_created": null, "callbacks_on_episode_created": null, "callbacks_on_episode_start": null, "callbacks_on_episode_step": null, "callbacks_on_episode_end": null, "callbacks_on_evaluate_start": null, "callbacks_on_evaluate_end": null, "callbacks_on_evaluate_offline_start": null, "callbacks_on_evaluate_offline_end": null, "callbacks_on_sample_end": null, "callbacks_on_train_result": null, "explore": true, "enable_rl_module_and_learner": true, "enable_env_runner_and_connector_v2": true, "_prior_exploration_config": {"type": "StochasticSampling"}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x3884998a0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "offline_data_class": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_read_batch_size": null, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "materialize_data": false, "materialize_mapped_data": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "ignore_final_observation": false, "prelearner_class": null, "prelearner_buffer_class": null, "prelearner_buffer_kwargs": {}, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_remaining_data": false, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": 1, "evaluation_duration": 20, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_auto_duration_min_env_steps_per_sample": 100, "evaluation_auto_duration_max_env_steps_per_sample": 2000, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 1, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "offline_evaluation_interval": null, "num_offline_eval_runners": 0, "offline_loss_for_module_fn": null, "offline_evaluation_duration": 1, "offline_evaluation_parallel_to_training": false, "offline_evaluation_timeout_s": 120.0, "num_cpus_per_offline_eval_runner": 1, "num_gpus_per_offline_eval_runner": 0, "custom_resources_per_offline_eval_runner": {}, "restart_failed_offline_eval_runners": true, "ignore_offline_eval_runner_failures": false, "max_num_offline_eval_runner_restarts": 1000, "offline_eval_runner_restore_timeout_s": 1800.0, "max_requests_in_flight_per_offline_eval_runner": 1, "validate_offline_eval_runners_after_construction": true, "offline_eval_runner_health_probe_timeout_s": 30.0, "offline_eval_rl_module_inference_only": false, "broadcast_offline_eval_runner_states": false, "offline_eval_batch_size_per_runner": 256, "dataset_num_iters_per_eval_runner": 1, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "log_gradients": false, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 7, "restart_failed_env_runners": true, "ignore_env_runner_failures": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30.0, "env_runner_restore_timeout_s": 1800.0, "_model_config": {}, "_rl_module_spec": "MultiRLModuleSpec(multi_rl_module_class=<class 'ray.rllib.core.rl_module.multi_rl_module.MultiRLModule'>, observation_space=None, action_space=None, inference_only=False, model_config=None, rl_module_specs={'default_policy': RLModuleSpec(module_class=<class 'source.intrinsic_attention_ppo.rl_modules.DifferentiablePPOModule.DifferentiablePPOModule'>, observation_space=None, action_space=None, inference_only=False, learner_only=False, model_config={'vf_share_layers': True, 'embedding_dim': 62, 'max_seq_len': 11, 'policy_head_hidden_sizes': [32], 'value_head_hidden_sizes': [101], 'embedding_hidden_sizes': [121]}, catalog_class=None, load_state_path=None, model_config_dict=None), 'intrinsic_reward_module': RLModuleSpec(module_class=<class 'source.intrinsic_attention_ppo.rl_modules.IntrinsicAttentionModule.IntrinsicAttentionModule'>, observation_space=None, action_space=None, inference_only=False, learner_only=True, model_config={'intrinsic_reward_network': {'encoder_hidden_sizes': [], 'encoding_dim': 1, 'num_heads': 1, 'head_hidden_sizes': None, 'layers': [{'type': 'attention'}]}, 'extrinsic_value_hidden_layers': [127, 60], 'vf_share_layers': True, 'max_seq_len': 11}, catalog_class=None, load_state_path=None, model_config_dict=None)}, load_state_path=None, modules_to_load=None, module_specs={'default_policy': RLModuleSpec(module_class=<class 'source.intrinsic_attention_ppo.rl_modules.DifferentiablePPOModule.DifferentiablePPOModule'>, observation_space=None, action_space=None, inference_only=False, learner_only=False, model_config={'vf_share_layers': True, 'embedding_dim': 62, 'max_seq_len': 11, 'policy_head_hidden_sizes': [32], 'value_head_hidden_sizes': [101], 'embedding_hidden_sizes': [121]}, catalog_class=None, load_state_path=None, model_config_dict=None), 'intrinsic_reward_module': RLModuleSpec(module_class=<class 'source.intrinsic_attention_ppo.rl_modules.IntrinsicAttentionModule.IntrinsicAttentionModule'>, observation_space=None, action_space=None, inference_only=False, learner_only=True, model_config={'intrinsic_reward_network': {'encoder_hidden_sizes': [], 'encoding_dim': 1, 'num_heads': 1, 'head_hidden_sizes': None, 'layers': [{'type': 'attention'}]}, 'extrinsic_value_hidden_layers': [127, 60], 'vf_share_layers': True, 'max_seq_len': 11}, catalog_class=None, load_state_path=None, model_config_dict=None)})", "algorithm_config_overrides_per_module": {"intrinsic_reward_module": {"lr": 0.0002715581955}}, "_per_module_overrides": {}, "_validate_config": true, "_use_msgpack_checkpoints": false, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "env_task_fn": -1, "enable_connectors": -1, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.161583927863, "kl_target": 0.0201019014258, "vf_loss_coeff": 0.7790510010087, "entropy_coeff": 0.0015431216992, "clip_param": 0.2459212356676, "vf_clip_param": 0.3769744131561, "entropy_coeff_schedule": null, "lr_schedule": null, "sgd_minibatch_size": -1, "vf_share_layers": -1, "differentiable_learner_configs": ["DifferentiableLearnerConfig(learner_class=<class 'source.intrinsic_attention_ppo.learners.IntrinsicAttentionPPOLearner.IntrinsicAttentionPPOLearner'>, learner_connector=None, add_default_connectors_to_learner_pipeline=True, is_multi_agent=False, policies_to_update=['default_policy'], lr=0.0060984166342, num_total_minibatches=0, num_epochs=1, minibatch_size=1000, shuffle_batch_per_epoch=True)"], "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9485408017724, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.callbacks.callbacks.RLlibCallback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 98.91270780563354, "iterations_since_restore": 10, "perf": {"cpu_util_percent": 52.94285714285714, "ram_util_percent": 80.78571428571429}}
{"timers": {"training_iteration": 10.188143646175725, "restore_env_runners": 1.2619497312956258e-05, "training_step": 10.187938305636326, "env_runner_sampling_timer": 2.5148807773639175, "learner_update_timer": 7.418360522034812, "synch_weights": 0.001764437271588522, "restore_eval_env_runners": 4.449933590270279e-05, "evaluation_iteration": 0.13770110588130063, "synch_eval_env_connectors": 0.0001826655699504701, "synch_env_connectors": 4.730576657829811e-06}, "env_runners": {"env_reset_timer": 4.549445371410906e-05, "num_episodes_lifetime": -277375.0, "num_env_steps_sampled_lifetime": -5547500.0, "num_env_steps_sampled": 5000.0, "module_to_env_connector": {"timers": {"connectors": {"remove_single_ts_time_rank_from_batch": 1.2433058831763098e-05, "get_actions": 4.209740372097168e-05, "listify_data_for_vector_env": 1.1108972413167564e-05, "tensor_to_numpy": 1.6175008748381024e-05, "un_batch_to_individual_items": 6.811235871175976e-06, "normalize_and_clip_actions": 8.455318886109533e-06}}, "connector_pipeline_timer": 0.00012450927871851818}, "module_episode_returns_mean": {"default_policy": -0.4600000000000001}, "time_between_sampling": 0.034212158949860655, "rlmodule_inference_timer": 3.38156739701473e-05, "env_step_timer": 1.4974588448890063e-05, "env_to_module_connector": {"timers": {"connectors": {"batch_individual_items": 1.3050271879868947e-05, "add_observations_from_episodes_to_batch": 3.015371248832666e-06, "add_states_from_episodes_to_batch": 2.8661060918721552e-06, "numpy_to_tensor": 1.3288334280080662e-05, "add_time_dim_to_batch_and_zero_pad": 7.650988668104624e-06}}, "connector_pipeline_timer": 6.260220156755691e-05}, "weights_seq_no": 10.0, "num_agent_steps_sampled": {"default_agent": 5000.0}, "episode_len_min": 20, "episode_len_mean": 20.0, "num_episodes": 250.0, "sample": 0.005789913112031771, "episode_duration_sec_mean": 0.00557435583975166, "episode_len_max": 20, "num_module_steps_sampled": {"default_policy": 5000.0}, "num_agent_steps_sampled_lifetime": {"default_agent": -5547500.0}, "num_module_steps_sampled_lifetime": {"default_policy": -5547500.0}, "env_to_module_sum_episodes_length_out": 10.36823839457432, "agent_episode_returns_mean": {"default_agent": -0.4600000000000001}, "episode_return_max": 10.5, "episode_return_min": -9.5, "env_to_module_sum_episodes_length_in": 10.36823839457432, "episode_return_mean": -0.4600000000000001, "num_env_steps_sampled_lifetime_throughput": 3115.069528030614}, "__all_modules__": {"learner_connector_sum_episodes_length_in": 5000.0, "learner_connector": {"connector_pipeline_timer": 0.21252866969466716, "timers": {"connectors": {"add_one_ts_to_episodes_and_truncate": 0.009146452977539679, "add_observations_from_episodes_to_batch": 0.0009658980542696878, "add_columns_from_episodes_to_train_batch": 0.09674731758165113, "add_time_dim_to_batch_and_zero_pad": 0.0875784470468072, "add_states_from_episodes_to_batch": 0.003619949674880384, "batch_individual_items": 0.014183771288345816, "numpy_to_tensor": 8.857715389741176e-05}}}, "learner_connector_sum_episodes_length_out": 5250.0}, "learners": {"differentiable_learners": {"intrinsic_attention_ppo_learner": {"intrinsic_reward_module": {"num_module_steps_trained_lifetime": 395010, "weights_seq_no": 66.0, "total_loss": 0.0, "num_module_steps_trained": 35910, "diff_num_grad_updates_vs_sampler_policy": 56.0, "module_train_batch_size_mean": 997.5068778348534}, "default_policy": {"module_train_batch_size_mean": 997.5068778348534, "use_intrinsic_rewards": 1.0, "num_module_steps_trained_lifetime": 395010, "policy_loss": -0.0002889067982323468, "mean_kl_loss": 1.553677248011809e-05, "entropy": 0.6923424005508423, "weights_seq_no": 66.0, "vf_loss_unclipped": 46.01445007324219, "vf_loss": 0.3583778738975525, "total_loss": 0.27783986926078796, "vf_explained_var": -0.0017622709274291992, "num_module_steps_trained": 35910, "diff_num_grad_updates_vs_sampler_policy": 56.0}, "__all_modules__": {"num_env_steps_trained_lifetime": 2178000, "num_module_steps_trained": 71820, "num_module_steps_trained_lifetime": 790020, "num_env_steps_trained": 198000, "num_env_steps_trained_lifetime_throughput": 50324.8991879069}}}, "intrinsic_reward_module": {"num_module_steps_trained": 5985, "curr_entropy_coeff": 0.0015431216992, "total_loss": 0.0, "num_module_steps_trained_lifetime": 65835, "gradients_default_optimizer_global_norm": 0.0, "diff_num_grad_updates_vs_sampler_policy": 1.0, "module_train_batch_size_mean": 997.7563503102639, "default_optimizer_learning_rate": 0.0002715581955, "num_trainable_parameters": 8266, "weights_seq_no": 11.0, "num_module_steps_trained_lifetime_throughput": 796.3780805072361}, "__all_modules__": {"num_trainable_parameters": 24861, "num_non_trainable_parameters": 0, "num_env_steps_trained_lifetime": 363000, "num_module_steps_trained": 11970, "num_module_steps_trained_lifetime": 131670, "num_env_steps_trained": 33000, "num_env_steps_trained_lifetime_throughput": 4392.467762160578, "num_module_steps_trained_throughput": 25275195.53690969, "num_module_steps_trained_lifetime_throughput": 13144605.54952939}, "default_policy": {"vf_loss": 0.3583049178123474, "weights_seq_no": 11.0, "curr_entropy_coeff": 0.0015431216992, "vf_loss_unclipped": 45.78043746948242, "total_loss": 0.27776774764060974, "vf_explained_var": -0.0003796815872192383, "num_module_steps_trained": 5985, "diff_num_grad_updates_vs_sampler_policy": 1.0, "curr_kl_coeff": 7.889840344432741e-05, "use_intrinsic_rewards": 0.0, "module_train_batch_size_mean": 997.7563503102639, "num_module_steps_trained_lifetime": 65835, "policy_loss": -0.00030170075478963554, "num_trainable_parameters": 16595, "mean_kl_loss": 1.695685386948753e-05, "entropy": 0.6923521161079407, "num_module_steps_trained_lifetime_throughput": 796.3651005294422}, "IntrinsicAttentionMask": [[[0.090944305062294, 0.08982197940349579, 0.08986902236938477, 0.09108726680278778, 0.09113498032093048, 0.09189780056476593, 0.09194593131542206, 0.09081123769283295, 0.09204225987195969, 0.09019900113344193, 0.09024624526500702], [0.09071947634220123, 0.09502062201499939, 0.09483521431684494, 0.09018947184085846, 0.09001348912715912, 0.08725768327713013, 0.08708743005990982, 0.09121637046337128, 0.0867478996515274, 0.09354744851589203, 0.09336491674184799], [0.09073193371295929, 0.09479858726263046, 0.09462349116802216, 0.09023011475801468, 0.09006346017122269, 0.08745139837265015, 0.08728987723588943, 0.0912022516131401, 0.08696772158145905, 0.09340686351060867, 0.0932343378663063], [0.09096220135688782, 0.08917460590600967, 0.08924926817417145, 0.091190867125988, 0.09126721322536469, 0.09249129891395569, 0.09256874024868011, 0.09074956178665161, 0.0927238017320633, 0.08977363258600235, 0.08984879404306412], [0.09096764773130417, 0.08895933628082275, 0.08904311805963516, 0.09122489392757416, 0.09131080657243729, 0.09268944710493088, 0.09277673810720444, 0.09072849154472351, 0.09295156598091125, 0.08963176608085632, 0.08971618115901947], [0.09101863950490952, 0.08556792140007019, 0.08579102158546448, 0.09173241257667542, 0.09197157621383667, 0.0958641767501831, 0.09611411392688751, 0.09035824984312057, 0.09661594778299332, 0.08736904710531235, 0.0875968411564827], [0.09101961553096771, 0.085357166826725, 0.08558864891529083, 0.09176214039325714, 0.0920109897851944, 0.09606482833623886, 0.0963253453373909, 0.09033282846212387, 0.0968485102057457, 0.08722669631242752, 0.08746325224637985], [0.09092547744512558, 0.09042756259441376, 0.09044850617647171, 0.0909886509180069, 0.091009721159935, 0.09134579449892044, 0.09136694669723511, 0.09086661785840988, 0.09140926599502563, 0.09059521555900574, 0.09061618894338608], [0.09102073311805725, 0.08493645489215851, 0.08518458157777786, 0.09182078391313553, 0.09208902716636658, 0.09646652638912201, 0.09674833714962006, 0.09028119593858719, 0.09731444716453552, 0.0869419202208519, 0.08719591051340103], [0.09081179648637772, 0.09325122833251953, 0.09314706176519394, 0.09050780534744263, 0.09040670841932297, 0.08881226181983948, 0.08871304988861084, 0.09109610319137573, 0.08851496130228043, 0.09242112934589386, 0.09231788665056229], [0.09082216769456863, 0.09303117543458939, 0.09293695539236069, 0.09054650366306305, 0.09045480191707611, 0.08900736272335052, 0.08891722559928894, 0.09107989817857742, 0.08873720467090607, 0.09228009730577469, 0.09218664467334747]], [[0.09862786531448364, 0.09135377407073975, 0.08733686059713364, 0.09958833456039429, 0.09520934522151947, 0.0925418809056282, 0.10055816173553467, 0.08875899016857147, 0.06101527065038681, 0.09911976009607315, 0.08588975667953491], [0.0927877128124237, 0.0911438912153244, 0.09019269049167633, 0.09299775213003159, 0.0920271947979927, 0.09141908586025238, 0.09320826083421707, 0.09053321182727814, 0.08295287191867828, 0.09289547801017761, 0.08984179049730301], [0.08911997079849243, 0.09061180800199509, 0.09149901568889618, 0.08893302083015442, 0.0898037850856781, 0.09035845845937729, 0.08874646574258804, 0.09117933362722397, 0.09889332205057144, 0.08902394771575928, 0.09183087199926376], [0.09933193773031235, 0.0913248360157013, 0.08692926913499832, 0.10039357841014862, 0.09556151926517487, 0.09262856841087341, 0.10146656632423401, 0.08848325163125992, 0.058654479682445526, 0.09987551718950272, 0.08535050600767136], [0.09600063413381577, 0.09135803580284119, 0.08873843401670456, 0.09660445898771286, 0.09383441507816315, 0.09212500602006912, 0.09721208363771439, 0.08967062830924988, 0.07036186754703522, 0.09631013125181198, 0.08778434246778488], [0.09380801022052765, 0.09123774617910385, 0.08976209908723831, 0.0941382572054863, 0.09261570125818253, 0.09166625142097473, 0.09446965903043747, 0.09028938412666321, 0.07881557196378708, 0.09397739917039871, 0.08921990543603897], [0.10002859681844711, 0.09128455072641373, 0.08651281893253326, 0.10119275003671646, 0.09590308368206024, 0.09270380437374115, 0.10237044841051102, 0.08819740265607834, 0.056378018110990524, 0.10062453150749207, 0.08480408787727356], [0.09045865386724472, 0.09084096550941467, 0.09106610715389252, 0.09041041135787964, 0.09063448756933212, 0.09077637642621994, 0.09036219120025635, 0.09098517149686813, 0.09288188070058823, 0.09043388068675995, 0.09114990383386612], [0.053693417459726334, 0.07187038660049438, 0.08528488129377365, 0.05174915865063667, 0.06140805035829544, 0.06842155009508133, 0.04987529665231705, 0.08020024746656418, 0.33392655849456787, 0.05268637835979462, 0.09088397771120071], [0.09899022430181503, 0.09134034812450409, 0.08712875097990036, 0.1000024676322937, 0.09539146721363068, 0.09258782118558884, 0.1010250523686409, 0.08861871808767319, 0.059792663902044296, 0.09950856864452362, 0.08561385422945023], [0.08770973980426788, 0.0903276726603508, 0.09190046042203903, 0.08738403022289276, 0.08890556544065475, 0.08988071978092194, 0.08705954253673553, 0.09133239090442657, 0.10546569526195526, 0.08754238486289978, 0.09249180555343628]], [[0.09227404743432999, 0.08948599547147751, 0.09396108239889145, 0.09376794844865799, 0.08893532305955887, 0.09055968374013901, 0.09037354588508606, 0.09018778800964355, 0.09000241011381149, 0.0880250558257103, 0.0924270823597908], [0.09124263375997543, 0.09056436270475388, 0.09164555370807648, 0.0915997102856636, 0.09042850881814957, 0.09082743525505066, 0.09078200161457062, 0.09073658287525177, 0.09069118648767471, 0.09020254015922546, 0.09127940982580185], [0.09287825971841812, 0.08884534984827042, 0.09534523636102676, 0.09506180882453918, 0.08805537968873978, 0.09039189666509628, 0.09012318402528763, 0.08985527604818344, 0.08958816528320312, 0.08675432205200195, 0.09310122579336166], [0.09280983358621597, 0.08891824632883072, 0.09518741816282272, 0.09491436928510666, 0.08815523982048035, 0.09041130542755127, 0.09015195816755295, 0.08989334851503372, 0.08963548392057419, 0.0868980661034584, 0.09302480518817902], [0.0910339280962944, 0.09078030288219452, 0.09118403494358063, 0.09116697311401367, 0.09072936326265335, 0.09087881445884705, 0.09086181223392487, 0.09084481745958328, 0.0908278226852417, 0.09064451605081558, 0.09104765206575394], [0.091644786298275, 0.09014614671468735, 0.09254144132137299, 0.09243917465209961, 0.08984760195016861, 0.09072580188512802, 0.09062553942203522, 0.09052538126707077, 0.09042533487081528, 0.08935223519802094, 0.09172643721103668], [0.09157553315162659, 0.09021839499473572, 0.09238651394844055, 0.09229405224323273, 0.08994778990745544, 0.09074356406927109, 0.09065274894237518, 0.09056202322244644, 0.09047138690948486, 0.08949858695268631, 0.09164940565824509], [0.09150621294975281, 0.0902905985713005, 0.09223173558712006, 0.09214905649423599, 0.09004798531532288, 0.0907612293958664, 0.09067986905574799, 0.09059857577085495, 0.09051735699176788, 0.08964508026838303, 0.0915723368525505], [0.09143685549497604, 0.09036275744438171, 0.0920771136879921, 0.09200417250394821, 0.0901481881737709, 0.09077879786491394, 0.09070689231157303, 0.0906350389122963, 0.09056324511766434, 0.08979170769453049, 0.09149522334337234], [0.09068521112203598, 0.09113939851522446, 0.09041806310415268, 0.09044836461544037, 0.09123105555772781, 0.09096256643533707, 0.09099304676055908, 0.09102354198694229, 0.0910540446639061, 0.09138401597738266, 0.09066074341535568], [0.0923294723033905, 0.08942751586437225, 0.09408717602491379, 0.0938858836889267, 0.08885478973388672, 0.09054464101791382, 0.0903509333729744, 0.0901576355099678, 0.08996475487947464, 0.08790837228298187, 0.09248887002468109]], [[0.09178212285041809, 0.09065809845924377, 0.09235208481550217, 0.09165028482675552, 0.09226362407207489, 0.09048449993133545, 0.09151864051818848, 0.09213109314441681, 0.0844217836856842, 0.09063463658094406, 0.09210313856601715], [0.08628068119287491, 0.09131795912981033, 0.08385581523180008, 0.08685369044542313, 0.08422667533159256, 0.0921274796128273, 0.08743050694465637, 0.08478605002164841, 0.12678970396518707, 0.09142683446407318, 0.08490459620952606], [0.09401240944862366, 0.08969426900148392, 0.09625966846942902, 0.09349814802408218, 0.09590830653905869, 0.08904067426919937, 0.09298669546842575, 0.0953836739063263, 0.06833716481924057, 0.08960574865341187, 0.09527329355478287], [0.09121633321046829, 0.090828076004982, 0.0914120227098465, 0.09117095917463303, 0.09138169884681702, 0.09076783061027527, 0.09112560003995895, 0.09133624285459518, 0.08861465752124786, 0.09081993997097015, 0.09132664650678635], [0.09368816018104553, 0.08986630290746689, 0.09566915780305862, 0.09323406964540482, 0.09535977989435196, 0.08928602188825607, 0.09278218448162079, 0.09489759057760239, 0.07062863558530807, 0.08978773653507233, 0.09480030834674835], [0.08528409153223038, 0.09123805910348892, 0.08244110643863678, 0.08595814555883408, 0.08287491649389267, 0.09220079332590103, 0.08663751184940338, 0.08352992683649063, 0.13479916751384735, 0.0913674458861351, 0.08366885036230087], [0.09063147008419037, 0.09097571671009064, 0.09045900404453278, 0.09067156165838242, 0.09048568457365036, 0.09102938324213028, 0.09071166813373566, 0.09052570909261703, 0.0929926261305809, 0.09098296612501144, 0.09053416550159454], [0.09318771958351135, 0.09010935574769974, 0.09477374702692032, 0.09282325953245163, 0.09452647715806961, 0.08963976800441742, 0.09246022254228592, 0.09415677934885025, 0.07419785857200623, 0.09004581719636917, 0.094078928232193], [0.0298683512955904, 0.04713394120335579, 0.023750634863972664, 0.03150094673037529, 0.024608401581645012, 0.05059996247291565, 0.03322276845574379, 0.02595348283648491, 0.6595273017883301, 0.04758765920996666, 0.0262466873973608], [0.0861484631896019, 0.09131035953760147, 0.08366633206605911, 0.08673527091741562, 0.08404583483934402, 0.09214058518409729, 0.08732607215642929, 0.08461831510066986, 0.1278471201658249, 0.09142201393842697, 0.08473966270685196], [0.09307988733053207, 0.09015829116106033, 0.09458322823047638, 0.09273423999547958, 0.09434892982244492, 0.08971217274665833, 0.09238988906145096, 0.09399857372045517, 0.074972003698349, 0.09009793400764465, 0.09392478317022324]], [[0.09183341264724731, 0.09370499849319458, 0.0935123935341835, 0.09332018345594406, 0.08851063251495361, 0.09012723714113235, 0.08994198590517044, 0.08975711464881897, 0.0851311907172203, 0.09217517822980881, 0.09198572486639023], [0.09227181226015091, 0.09510243684053421, 0.09480982273817062, 0.09451811015605927, 0.08731694519519806, 0.08971624821424484, 0.08944020420312881, 0.08916501700878143, 0.08237168192863464, 0.09278659522533417, 0.09250110387802124], [0.0922277569770813, 0.09495974332094193, 0.09467745572328568, 0.09439601004123688, 0.08743865042924881, 0.08975880593061447, 0.08949197828769684, 0.08922594785690308, 0.08264964818954468, 0.09272480756044388, 0.09244916588068008], [0.09218356013298035, 0.09481709450483322, 0.09454510360956192, 0.0942738950252533, 0.08756037056446075, 0.08980122208595276, 0.08954361826181412, 0.08928675949573517, 0.08292838931083679, 0.09266290068626404, 0.09239708632230759], [0.09099554270505905, 0.09116263687610626, 0.0911455824971199, 0.09112852811813354, 0.09069109708070755, 0.09084048867225647, 0.09082349389791489, 0.0908065065741539, 0.09037061780691147, 0.09102628380060196, 0.09100925177335739], [0.09141301363706589, 0.09240952879190445, 0.09230740368366241, 0.09220539033412933, 0.08962038159370422, 0.09049635380506516, 0.09039634466171265, 0.0902964398264885, 0.08776494860649109, 0.09159568697214127, 0.09149446338415146], [0.09136613458395004, 0.09226761013269424, 0.09217526763677597, 0.09208301454782486, 0.08974212408065796, 0.09053608030080795, 0.09044546633958817, 0.09035494923591614, 0.0880579873919487, 0.09153145551681519, 0.09143984317779541], [0.09131911396980286, 0.09212573617696762, 0.09204314649105072, 0.09196063131093979, 0.0898638591170311, 0.09057565033435822, 0.09049445390701294, 0.09041332453489304, 0.08835183829069138, 0.09146708995103836, 0.09138509631156921], [0.09005855023860931, 0.08849278837442398, 0.08865121752023697, 0.08880992978811264, 0.09299054741859436, 0.09153882414102554, 0.09170270711183548, 0.0918668881058693, 0.09619140625, 0.089768186211586, 0.08992890268564224], [0.09191521257162094, 0.09396200627088547, 0.09375119209289551, 0.09354085475206375, 0.08829081058502197, 0.09005262702703476, 0.08985058963298798, 0.08964899927377701, 0.08461739122867584, 0.09228868782520294, 0.09208162873983383], [0.09186995774507523, 0.09381962567567825, 0.09361890703439713, 0.09341862052679062, 0.0884125605225563, 0.09009400755167007, 0.08990126103162766, 0.08970893174409866, 0.08490166068077087, 0.09222586452960968, 0.09202855825424194]], [[0.09720747172832489, 0.09003814309835434, 0.0932338684797287, 0.09815412014722824, 0.09383818507194519, 0.09879032522439957, 0.09150425344705582, 0.0947520062327385, 0.06013656035065651, 0.09769228845834732, 0.08465281128883362], [0.092473603785038, 0.09083534777164459, 0.09157751500606537, 0.09268292784690857, 0.09171565622091293, 0.09282273799180984, 0.091178297996521, 0.09192326664924622, 0.08267205208539963, 0.09258099645376205, 0.08953765034675598], [0.0947030782699585, 0.09057075530290604, 0.09242910146713257, 0.0952390506863594, 0.09277750551700592, 0.09559804946184158, 0.09142667800188065, 0.09330257773399353, 0.0715998038649559, 0.09497784078121185, 0.08737558126449585], [0.09776507318019867, 0.08988427370786667, 0.09338989108800888, 0.09880996495485306, 0.09405413269996643, 0.09951276332139969, 0.09149108082056046, 0.0950593650341034, 0.05772926285862923, 0.09830008447170258, 0.08400417864322662], [0.09510207176208496, 0.09050292521715164, 0.09256837517023087, 0.09570024162530899, 0.09295613318681717, 0.09610111266374588, 0.0914536565542221, 0.09354081004858017, 0.06970328092575073, 0.09540867060422897, 0.08696268498897552], [0.09813199937343597, 0.08977581560611725, 0.09348778426647186, 0.09924297779798508, 0.09419205784797668, 0.099990613758564, 0.09147616475820541, 0.0952584370970726, 0.05617440491914749, 0.09870076179504395, 0.08356891572475433], [0.09352221339941025, 0.09073476493358612, 0.09199325740337372, 0.09388085454702377, 0.09222829341888428, 0.09412071108818054, 0.09131542593240738, 0.09258197247982025, 0.07736502587795258, 0.0937061458826065, 0.08855132758617401], [0.09569264203310013, 0.09039081633090973, 0.09276696294546127, 0.09638507664203644, 0.09321393817663193, 0.0968494862318039, 0.09148357063531876, 0.09388843923807144, 0.06694453954696655, 0.09604748338460922, 0.08633700013160706], [0.05614020302891731, 0.07514548301696777, 0.06580467522144318, 0.054107338190078735, 0.06420639157295227, 0.05279315635561943, 0.07066535949707031, 0.06188144534826279, 0.34914320707321167, 0.05508727207779884, 0.09502550959587097], [0.09749479591846466, 0.089960478246212, 0.09331534057855606, 0.09849173575639725, 0.09395039826631546, 0.0991620272397995, 0.09149887412786484, 0.09491109848022461, 0.05888938158750534, 0.09800530970096588, 0.08432049304246902], [0.08819785714149475, 0.09083037078380585, 0.08962234854698181, 0.08787033706903458, 0.08940034359693527, 0.08765267580747604, 0.09026890993118286, 0.08906836807727814, 0.10605262964963913, 0.08802957832813263, 0.09300653636455536]]]}, "num_training_step_calls_per_iteration": 1, "evaluation": {"env_runners": {"module_to_env_connector": {"timers": {"connectors": {"remove_single_ts_time_rank_from_batch": 1.1958931157384154e-05, "get_actions": 3.758886092386328e-05, "normalize_and_clip_actions": 8.001000339312488e-06, "listify_data_for_vector_env": 1.0593002666973862e-05, "tensor_to_numpy": 1.5257695778671255e-05, "un_batch_to_individual_items": 6.6315212702001575e-06}}, "connector_pipeline_timer": 0.00011673323432815608}, "episode_len_max": 20, "num_agent_steps_sampled_lifetime": {"default_agent": 4400}, "num_module_steps_sampled_lifetime": {"default_policy": 4400}, "episode_return_max": 14.5, "env_reset_timer": 0.000550044568916435, "rlmodule_inference_timer": 3.2018086638814264e-05, "env_step_timer": 1.4620504613123787e-05, "env_to_module_connector": {"timers": {"connectors": {"add_states_from_episodes_to_batch": 2.7331368086512093e-06, "numpy_to_tensor": 1.2312074879160403e-05, "add_time_dim_to_batch_and_zero_pad": 7.169347849951538e-06, "add_observations_from_episodes_to_batch": 2.8962830655328693e-06, "batch_individual_items": 1.2550732627489886e-05}}, "connector_pipeline_timer": 6.027683936541592e-05}, "episode_len_min": 20, "env_to_module_sum_episodes_length_out": 10.368238394574323, "env_to_module_sum_episodes_length_in": 10.368238394574323, "num_env_steps_sampled_lifetime": 55400, "num_agent_steps_sampled": {"default_agent": 400}, "weights_seq_no": 11.0, "module_episode_returns_mean": {"default_policy": 1.25}, "episode_len_mean": 20.0, "sample": 0.12610450548792168, "agent_episode_returns_mean": {"default_agent": 1.25}, "episode_return_mean": 1.25, "episode_return_min": -11.5, "num_episodes": 20, "episode_duration_sec_mean": 0.0054133854375686494, "num_module_steps_sampled": {"default_policy": 400}, "num_episodes_lifetime": 220, "num_env_steps_sampled": 400, "time_between_sampling": 9.455749981520004}, "num_healthy_workers": 1, "actor_manager_num_outstanding_async_reqs": 0, "num_remote_worker_restarts": 0}, "num_env_steps_sampled_lifetime": -5547500.0, "fault_tolerance": {"num_healthy_workers": 0, "num_remote_worker_restarts": 0}, "env_runner_group": {"actor_manager_num_outstanding_async_reqs": 0}, "done": false, "training_iteration": 11, "trial_id": "b9446_00000", "date": "2025-08-11_18-36-02", "timestamp": 1754930162, "time_this_iter_s": 10.069087028503418, "time_total_s": 108.98179483413696, "pid": 11415, "hostname": "Mac", "node_ip": "127.0.0.1", "config": {"exploration_config": {}, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 2, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "env": "Umbrella", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": false, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 0, "create_local_env_runner": true, "num_envs_per_env_runner": 1, "gym_env_vectorize_mode": "SYNC", "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "episodes_to_numpy": true, "max_requests_in_flight_per_env_runner": 1, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "merge_env_runner_states": "training_only", "broadcast_env_runner_states": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "complete_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "sampler_perf_stats_ema_coef": null, "_is_online": true, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": "auto", "num_aggregator_actors_per_learner": 0, "max_requests_in_flight_per_aggregator_actor": 3, "local_gpu_idx": 0, "max_requests_in_flight_per_learner": 3, "gamma": 1, "lr": 0.0002715581955, "grad_clip": 0.5, "grad_clip_by": "global_norm", "_train_batch_size_per_learner": 5000, "train_batch_size": 4000, "num_epochs": 1, "minibatch_size": 1000, "shuffle_batch_per_epoch": true, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "log_std_clip_param": 20.0, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "_disable_preprocessor_api": false, "_disable_action_flattening": false}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {"intrinsic_reward_coeff": 0.2795015916508}, "optimizer": {}, "_learner_class": "<class 'source.intrinsic_attention_ppo.learners.IntrinsicAttentionMetaLearner.IntrinsicAttentionMetaLearner'>", "callbacks_on_algorithm_init": null, "callbacks_on_env_runners_recreated": null, "callbacks_on_offline_eval_runners_recreated": null, "callbacks_on_checkpoint_loaded": null, "callbacks_on_environment_created": null, "callbacks_on_episode_created": null, "callbacks_on_episode_start": null, "callbacks_on_episode_step": null, "callbacks_on_episode_end": null, "callbacks_on_evaluate_start": null, "callbacks_on_evaluate_end": null, "callbacks_on_evaluate_offline_start": null, "callbacks_on_evaluate_offline_end": null, "callbacks_on_sample_end": null, "callbacks_on_train_result": null, "explore": true, "enable_rl_module_and_learner": true, "enable_env_runner_and_connector_v2": true, "_prior_exploration_config": {"type": "StochasticSampling"}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x3884998a0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "offline_data_class": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_read_batch_size": null, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "materialize_data": false, "materialize_mapped_data": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "ignore_final_observation": false, "prelearner_class": null, "prelearner_buffer_class": null, "prelearner_buffer_kwargs": {}, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_remaining_data": false, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": 1, "evaluation_duration": 20, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_auto_duration_min_env_steps_per_sample": 100, "evaluation_auto_duration_max_env_steps_per_sample": 2000, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 1, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "offline_evaluation_interval": null, "num_offline_eval_runners": 0, "offline_loss_for_module_fn": null, "offline_evaluation_duration": 1, "offline_evaluation_parallel_to_training": false, "offline_evaluation_timeout_s": 120.0, "num_cpus_per_offline_eval_runner": 1, "num_gpus_per_offline_eval_runner": 0, "custom_resources_per_offline_eval_runner": {}, "restart_failed_offline_eval_runners": true, "ignore_offline_eval_runner_failures": false, "max_num_offline_eval_runner_restarts": 1000, "offline_eval_runner_restore_timeout_s": 1800.0, "max_requests_in_flight_per_offline_eval_runner": 1, "validate_offline_eval_runners_after_construction": true, "offline_eval_runner_health_probe_timeout_s": 30.0, "offline_eval_rl_module_inference_only": false, "broadcast_offline_eval_runner_states": false, "offline_eval_batch_size_per_runner": 256, "dataset_num_iters_per_eval_runner": 1, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "log_gradients": false, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 7, "restart_failed_env_runners": true, "ignore_env_runner_failures": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30.0, "env_runner_restore_timeout_s": 1800.0, "_model_config": {}, "_rl_module_spec": "MultiRLModuleSpec(multi_rl_module_class=<class 'ray.rllib.core.rl_module.multi_rl_module.MultiRLModule'>, observation_space=None, action_space=None, inference_only=False, model_config=None, rl_module_specs={'default_policy': RLModuleSpec(module_class=<class 'source.intrinsic_attention_ppo.rl_modules.DifferentiablePPOModule.DifferentiablePPOModule'>, observation_space=None, action_space=None, inference_only=False, learner_only=False, model_config={'vf_share_layers': True, 'embedding_dim': 62, 'max_seq_len': 11, 'policy_head_hidden_sizes': [32], 'value_head_hidden_sizes': [101], 'embedding_hidden_sizes': [121]}, catalog_class=None, load_state_path=None, model_config_dict=None), 'intrinsic_reward_module': RLModuleSpec(module_class=<class 'source.intrinsic_attention_ppo.rl_modules.IntrinsicAttentionModule.IntrinsicAttentionModule'>, observation_space=None, action_space=None, inference_only=False, learner_only=True, model_config={'intrinsic_reward_network': {'encoder_hidden_sizes': [], 'encoding_dim': 1, 'num_heads': 1, 'head_hidden_sizes': None, 'layers': [{'type': 'attention'}]}, 'extrinsic_value_hidden_layers': [127, 60], 'vf_share_layers': True, 'max_seq_len': 11}, catalog_class=None, load_state_path=None, model_config_dict=None)}, load_state_path=None, modules_to_load=None, module_specs={'default_policy': RLModuleSpec(module_class=<class 'source.intrinsic_attention_ppo.rl_modules.DifferentiablePPOModule.DifferentiablePPOModule'>, observation_space=None, action_space=None, inference_only=False, learner_only=False, model_config={'vf_share_layers': True, 'embedding_dim': 62, 'max_seq_len': 11, 'policy_head_hidden_sizes': [32], 'value_head_hidden_sizes': [101], 'embedding_hidden_sizes': [121]}, catalog_class=None, load_state_path=None, model_config_dict=None), 'intrinsic_reward_module': RLModuleSpec(module_class=<class 'source.intrinsic_attention_ppo.rl_modules.IntrinsicAttentionModule.IntrinsicAttentionModule'>, observation_space=None, action_space=None, inference_only=False, learner_only=True, model_config={'intrinsic_reward_network': {'encoder_hidden_sizes': [], 'encoding_dim': 1, 'num_heads': 1, 'head_hidden_sizes': None, 'layers': [{'type': 'attention'}]}, 'extrinsic_value_hidden_layers': [127, 60], 'vf_share_layers': True, 'max_seq_len': 11}, catalog_class=None, load_state_path=None, model_config_dict=None)})", "algorithm_config_overrides_per_module": {"intrinsic_reward_module": {"lr": 0.0002715581955}}, "_per_module_overrides": {}, "_validate_config": true, "_use_msgpack_checkpoints": false, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "env_task_fn": -1, "enable_connectors": -1, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.161583927863, "kl_target": 0.0201019014258, "vf_loss_coeff": 0.7790510010087, "entropy_coeff": 0.0015431216992, "clip_param": 0.2459212356676, "vf_clip_param": 0.3769744131561, "entropy_coeff_schedule": null, "lr_schedule": null, "sgd_minibatch_size": -1, "vf_share_layers": -1, "differentiable_learner_configs": ["DifferentiableLearnerConfig(learner_class=<class 'source.intrinsic_attention_ppo.learners.IntrinsicAttentionPPOLearner.IntrinsicAttentionPPOLearner'>, learner_connector=None, add_default_connectors_to_learner_pipeline=True, is_multi_agent=False, policies_to_update=['default_policy'], lr=0.0060984166342, num_total_minibatches=0, num_epochs=1, minibatch_size=1000, shuffle_batch_per_epoch=True)"], "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9485408017724, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.callbacks.callbacks.RLlibCallback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 108.98179483413696, "iterations_since_restore": 11, "perf": {"cpu_util_percent": 48.028571428571425, "ram_util_percent": 80.76428571428572}}
{"timers": {"training_iteration": 10.178346220964375, "restore_env_runners": 1.2715802287821643e-05, "training_step": 10.178140553410616, "env_runner_sampling_timer": 2.505779979999855, "learner_update_timer": 7.418366656404975, "synch_weights": 0.0017545541488898477, "restore_eval_env_runners": 4.453684214313255e-05, "evaluation_iteration": 0.13760738273253367, "synch_eval_env_connectors": 0.00018241766433977635, "synch_env_connectors": 4.722441154586621e-06}, "env_runners": {"env_reset_timer": 5.132953441289837e-05, "num_episodes_lifetime": -308250.0, "num_env_steps_sampled_lifetime": -6165000.0, "num_env_steps_sampled": 5000.0, "module_to_env_connector": {"timers": {"connectors": {"remove_single_ts_time_rank_from_batch": 1.2360010336756738e-05, "get_actions": 4.118021658099137e-05, "listify_data_for_vector_env": 1.1066957593318497e-05, "tensor_to_numpy": 1.5978461564878368e-05, "un_batch_to_individual_items": 6.790714842115977e-06, "normalize_and_clip_actions": 8.339560877373213e-06}}, "connector_pipeline_timer": 0.00012283585249225432}, "module_episode_returns_mean": {"default_policy": -0.9399999999999996}, "time_between_sampling": 0.03440183815888459, "rlmodule_inference_timer": 3.313527192029584e-05, "env_step_timer": 1.4727008155318583e-05, "env_to_module_connector": {"timers": {"connectors": {"batch_individual_items": 1.2957399676657131e-05, "add_observations_from_episodes_to_batch": 3.0112858917098526e-06, "add_states_from_episodes_to_batch": 2.7673284544746563e-06, "numpy_to_tensor": 1.3082100886664492e-05, "add_time_dim_to_batch_and_zero_pad": 7.49902781859355e-06}}, "connector_pipeline_timer": 6.186813796022652e-05}, "weights_seq_no": 11.0, "num_agent_steps_sampled": {"default_agent": 5000.0}, "episode_len_min": 20, "episode_len_mean": 20.0, "num_episodes": 250.0, "sample": 0.006000766927033444, "episode_duration_sec_mean": 0.005476089482195677, "episode_len_max": 20, "num_module_steps_sampled": {"default_policy": 5000.0}, "num_agent_steps_sampled_lifetime": {"default_agent": -6165000.0}, "num_module_steps_sampled_lifetime": {"default_policy": -6165000.0}, "env_to_module_sum_episodes_length_out": 10.36823839457432, "agent_episode_returns_mean": {"default_agent": -0.9399999999999996}, "episode_return_max": 10.5, "episode_return_min": -9.5, "env_to_module_sum_episodes_length_in": 10.36823839457432, "episode_return_mean": -0.9399999999999996, "num_env_steps_sampled_lifetime_throughput": 3093.375916995884}, "__all_modules__": {"learner_connector_sum_episodes_length_in": 5000.0, "learner_connector": {"connector_pipeline_timer": 0.2117578404974127, "timers": {"connectors": {"add_one_ts_to_episodes_and_truncate": 0.009154053027463471, "add_observations_from_episodes_to_batch": 0.0009647411535994053, "add_columns_from_episodes_to_train_batch": 0.09618784607598284, "add_time_dim_to_batch_and_zero_pad": 0.08746036507573436, "add_states_from_episodes_to_batch": 0.003620167257522538, "batch_individual_items": 0.014084584825722309, "numpy_to_tensor": 8.846304248332069e-05}}}, "learner_connector_sum_episodes_length_out": 5250.0}, "learners": {"differentiable_learners": {"intrinsic_attention_ppo_learner": {"intrinsic_reward_module": {"num_module_steps_trained_lifetime": 430920, "weights_seq_no": 72.0, "total_loss": 0.0, "num_module_steps_trained": 35910, "diff_num_grad_updates_vs_sampler_policy": 61.0, "module_train_batch_size_mean": 997.504027034245}, "default_policy": {"module_train_batch_size_mean": 997.504027034245, "use_intrinsic_rewards": 1.0, "num_module_steps_trained_lifetime": 430920, "policy_loss": -0.00029288805671967566, "mean_kl_loss": 2.314121593371965e-05, "entropy": 0.6925976872444153, "weights_seq_no": 72.0, "vf_loss_unclipped": 46.013145446777344, "vf_loss": 0.35837045311927795, "total_loss": 0.27783092856407166, "vf_explained_var": -0.001664280891418457, "num_module_steps_trained": 35910, "diff_num_grad_updates_vs_sampler_policy": 61.0}, "__all_modules__": {"num_env_steps_trained_lifetime": 2376000, "num_module_steps_trained": 71820, "num_module_steps_trained_lifetime": 861840, "num_env_steps_trained": 198000, "num_env_steps_trained_lifetime_throughput": 49498.27054700167}}}, "intrinsic_reward_module": {"num_module_steps_trained": 5985, "curr_entropy_coeff": 0.0015431216992, "total_loss": 0.0, "num_module_steps_trained_lifetime": 71820, "gradients_default_optimizer_global_norm": 0.0, "diff_num_grad_updates_vs_sampler_policy": 1.0, "module_train_batch_size_mean": 997.7412016936058, "default_optimizer_learning_rate": 0.0002715581955, "num_trainable_parameters": 8266, "weights_seq_no": 12.0, "num_module_steps_trained_lifetime_throughput": 792.8519252277183}, "__all_modules__": {"num_trainable_parameters": 24861, "num_non_trainable_parameters": 0, "num_env_steps_trained_lifetime": 396000, "num_module_steps_trained": 11970, "num_module_steps_trained_lifetime": 143640, "num_env_steps_trained": 33000, "num_env_steps_trained_lifetime_throughput": 4372.972927428139, "num_module_steps_trained_throughput": 24607726.497778963, "num_module_steps_trained_lifetime_throughput": 13110583.998823533}, "default_policy": {"vf_loss": 0.3583049476146698, "weights_seq_no": 12.0, "curr_entropy_coeff": 0.0015431216992, "vf_loss_unclipped": 45.77704620361328, "total_loss": 0.27776670455932617, "vf_explained_var": -0.0003892183303833008, "num_module_steps_trained": 5985, "diff_num_grad_updates_vs_sampler_policy": 1.0, "curr_kl_coeff": 3.944920172216371e-05, "use_intrinsic_rewards": 0.0, "module_train_batch_size_mean": 997.7412016936058, "num_module_steps_trained_lifetime": 71820, "policy_loss": -0.00030235369922593236, "num_trainable_parameters": 16595, "mean_kl_loss": 2.4506434783688746e-05, "entropy": 0.6926041841506958, "num_module_steps_trained_lifetime_throughput": 792.8396787995684}, "IntrinsicAttentionMask": [[[0.09224482625722885, 0.09412479400634766, 0.09393132477998734, 0.0890902727842331, 0.0935455784201622, 0.09053100645542145, 0.09034492075443268, 0.08568871021270752, 0.08551257848739624, 0.09258811920881271, 0.09239781647920609], [0.09288115054368973, 0.09573046863079071, 0.09543592482805252, 0.08816482871770859, 0.09484954923391342, 0.09030871093273163, 0.09003084152936935, 0.083171546459198, 0.08291564881801605, 0.09339933097362518, 0.09311196208000183], [0.09281713515520096, 0.09556657820940018, 0.09528248757123947, 0.08825979381799698, 0.09471683204174042, 0.09033240377902985, 0.09006386995315552, 0.08342581242322922, 0.08317781239748001, 0.09331735968589783, 0.09303995221853256], [0.0911029577255249, 0.09136375784873962, 0.09133712947368622, 0.09065490961074829, 0.0912838876247406, 0.09086120128631592, 0.09083471447229385, 0.09015624225139618, 0.09012997150421143, 0.0911509171128273, 0.09112434834241867], [0.09268848598003387, 0.09523887187242508, 0.09497559070587158, 0.08844932168722153, 0.09445121139287949, 0.09037908166646957, 0.09012923389673233, 0.08393598347902298, 0.08370395004749298, 0.09315288811922073, 0.09289536625146866], [0.09163634479045868, 0.09263529628515244, 0.0925329253077507, 0.08993872255086899, 0.0923285111784935, 0.09071744978427887, 0.09061718732118607, 0.08807670325040817, 0.08797936886548996, 0.09181946516036987, 0.09171799570322037], [0.09156860411167145, 0.09247207641601562, 0.09237952530384064, 0.09003109484910965, 0.09219471365213394, 0.09073670953512192, 0.09064589440822601, 0.08834153413772583, 0.08825312554836273, 0.09173429012298584, 0.09164247661828995], [0.08975967019796371, 0.08828946948051453, 0.08843829482793808, 0.09235306084156036, 0.08873670548200607, 0.09114823490381241, 0.09130188822746277, 0.09534341096878052, 0.09550413489341736, 0.08948715031147003, 0.08963799476623535], [0.08968676626682281, 0.08812747150659561, 0.08828523755073547, 0.09244115650653839, 0.08860163390636444, 0.09116093069314957, 0.09132413566112518, 0.09562310576438904, 0.09579430520534515, 0.0893976017832756, 0.08955765515565872], [0.09236342459917068, 0.09442020207643509, 0.09420835971832275, 0.08892085403203964, 0.09378610551357269, 0.09049175679683685, 0.09028873592615128, 0.08522121608257294, 0.08503001928329468, 0.09273872524499893, 0.09253066033124924], [0.09229781478643417, 0.09425656497478485, 0.09405491501092911, 0.08901475369930267, 0.09365290403366089, 0.09051359444856644, 0.09031995385885239, 0.08547993749380112, 0.08529706299304962, 0.09265538305044174, 0.09245716035366058]], [[0.09092364460229874, 0.09098269790410995, 0.09016413986682892, 0.09257462620735168, 0.09174174815416336, 0.09269491583108902, 0.09275511652231216, 0.09192062169313431, 0.08389367908239365, 0.0924869254231453, 0.08986188471317291], [0.0909198671579361, 0.09098841995000839, 0.09003883600234985, 0.09283911436796188, 0.09187021851539612, 0.09297916293144226, 0.09304926544427872, 0.09207817167043686, 0.0828113779425621, 0.09273701906204224, 0.08968853950500488], [0.09081679582595825, 0.09075324982404709, 0.09164183586835861, 0.0890718400478363, 0.08994396775960922, 0.08894722908735275, 0.08888499438762665, 0.08975528925657272, 0.0990476906299591, 0.0891629159450531, 0.09197421371936798], [0.09025728702545166, 0.09057769924402237, 0.08621809631586075, 0.09957225620746613, 0.09477972984313965, 0.10028047114610672, 0.10063646733760834, 0.09579271823167801, 0.058174628764390945, 0.09905843436717987, 0.08465225249528885], [0.09073135256767273, 0.09092118591070175, 0.08831410855054855, 0.09614252299070358, 0.0933857262134552, 0.09654524177312851, 0.09674724191427231, 0.09397310763597488, 0.07002541422843933, 0.09584960341453552, 0.08736458420753479], [0.09016840904951096, 0.09050741046667099, 0.08590108156204224, 0.10005171597003937, 0.09495963901281357, 0.10080544650554657, 0.1011844351887703, 0.0960347056388855, 0.056632183492183685, 0.09950508177280426, 0.08424992859363556], [0.09012214094400406, 0.09047041088342667, 0.08574123680591583, 0.10029024630784988, 0.09504775702953339, 0.10106687247753143, 0.10145743936300278, 0.09615392982959747, 0.055875200778245926, 0.0997270941734314, 0.08404774963855743], [0.09065157175064087, 0.09086970239877701, 0.08788001537322998, 0.0968957170844078, 0.09370777755975723, 0.09736258536577225, 0.09759686142206192, 0.09438585489988327, 0.06729920953512192, 0.09655633568763733, 0.0867944061756134], [0.07423517853021622, 0.07332810014486313, 0.08701467514038086, 0.05279875919222832, 0.0626535713672638, 0.05151636153459549, 0.05088689923286438, 0.060384850949048996, 0.3406992256641388, 0.05375499278306961, 0.09272732585668564], [0.09031900763511658, 0.0906258225440979, 0.08644717186689377, 0.09922017902135849, 0.09464525431394577, 0.0998954251408577, 0.10023476928472519, 0.09561306238174438, 0.059324927628040314, 0.09873014688491821, 0.08494412153959274], [0.09068825840950012, 0.09057586640119553, 0.09215297549962997, 0.08762413263320923, 0.0891498476266861, 0.08740708231925964, 0.08729875087738037, 0.08881880342960358, 0.10575547814369202, 0.08778292685747147, 0.09274593740701675]], [[0.0922318547964096, 0.09411156177520752, 0.09391812235116959, 0.09372507035732269, 0.09353242814540863, 0.08602996170520782, 0.08585312962532043, 0.0856766626238823, 0.08996125310659409, 0.09257510304450989, 0.09238483011722565], [0.09285200387239456, 0.09570042788982391, 0.09540598094463348, 0.09511242806911469, 0.09481978416442871, 0.08365947008132935, 0.08340205997228622, 0.08314544707536697, 0.08944960683584213, 0.09337002038955688, 0.0930827409029007], [0.09278994053602219, 0.09553857892751694, 0.0952545702457428, 0.09497141093015671, 0.09468908607959747, 0.08389943838119507, 0.08365003764629364, 0.08340136706829071, 0.0895029753446579, 0.09329002350568771, 0.09301269799470901], [0.09272758662700653, 0.09537666290998459, 0.09510306268930435, 0.09483025968074799, 0.0945582315325737, 0.08413980156183243, 0.08389844000339508, 0.08365777134895325, 0.08955605328083038, 0.09320975095033646, 0.09294237196445465], [0.09266497194766998, 0.09521470963954926, 0.09495149552822113, 0.09468900412321091, 0.09442725032567978, 0.08438057452440262, 0.08414731174707413, 0.08391468971967697, 0.08960887044668198, 0.09312925487756729, 0.09287180006504059], [0.08989830315113068, 0.08860711008310318, 0.08873793482780457, 0.08886895328760147, 0.0890001729130745, 0.09449945390224457, 0.09463898092508316, 0.09477871656417847, 0.09151958674192429, 0.08965916186571121, 0.08979154378175735], [0.08982482552528381, 0.08844407647848129, 0.08858390897512436, 0.08872397243976593, 0.08886425197124481, 0.09475640207529068, 0.09490621089935303, 0.09505627304315567, 0.09156055003404617, 0.08956899493932724, 0.08971061557531357], [0.08975107222795486, 0.08828101307153702, 0.08842982351779938, 0.08857889473438263, 0.08872821182012558, 0.09501368552446365, 0.09517385065555573, 0.09533428400754929, 0.0916011855006218, 0.08947857469320297, 0.0896294116973877], [0.09143058955669403, 0.09214380383491516, 0.0920708104968071, 0.09199788421392441, 0.0919250026345253, 0.08901195228099823, 0.08894144743680954, 0.08887099474668503, 0.0905570462346077, 0.09156149625778198, 0.09148897230625153], [0.09234795719385147, 0.09440439194440842, 0.09419258683919907, 0.09398125857114792, 0.09377039968967438, 0.08559057861566544, 0.08539854735136032, 0.08520694822072983, 0.08986900001764297, 0.09272319823503494, 0.09251516312360764], [0.09228375554084778, 0.09424220770597458, 0.09404058754444122, 0.09383939951658249, 0.09363863617181778, 0.08583378791809082, 0.08565015345811844, 0.08546692132949829, 0.08992020785808563, 0.09264127165079117, 0.0924430713057518]], [[0.0915910080075264, 0.09154713153839111, 0.09215977787971497, 0.0903826579451561, 0.09207150340080261, 0.09029608219861984, 0.09132806211709976, 0.09193924069404602, 0.08524966239929199, 0.09152344614267349, 0.09191135317087173], [0.09144537895917892, 0.09141112118959427, 0.09188918024301529, 0.09050051867961884, 0.09182033687829971, 0.09043271839618683, 0.09124000370502472, 0.0917171761393547, 0.08645553141832352, 0.09139261394739151, 0.0916954055428505], [0.0933295488357544, 0.09315907210111618, 0.09556049108505249, 0.08871776610612869, 0.0952116847038269, 0.088393934071064, 0.09231129288673401, 0.09469085931777954, 0.07097695767879486, 0.09306712448596954, 0.09458128362894058], [0.08690392225980759, 0.08711407333612442, 0.08423393964767456, 0.09292072802782059, 0.08464181423187256, 0.09337066859006882, 0.08817248046398163, 0.08525735139846802, 0.12476932257413864, 0.08722778409719467, 0.08538784831762314], [0.09307724982500076, 0.09292663633823395, 0.09504533559083939, 0.08899161219596863, 0.09473797678947449, 0.08870382606983185, 0.09217718988656998, 0.09427880495786667, 0.07303383946418762, 0.0928453877568245, 0.09418215602636337], [0.08651023358106613, 0.08673755079507828, 0.08362637460231781, 0.09303680062294006, 0.08406642824411392, 0.09352637082338333, 0.0878831073641777, 0.0847308486700058, 0.12814991176128387, 0.08686055988073349, 0.08487176895141602], [0.09069214761257172, 0.0907055139541626, 0.09051956981420517, 0.0910634770989418, 0.09054626524448395, 0.09109032899141312, 0.09077240526676178, 0.09058631956577301, 0.09271643310785294, 0.09071274101734161, 0.09059477597475052], [0.09268749505281448, 0.09256650507450104, 0.09426501393318176, 0.08939182013273239, 0.09401907026767731, 0.08915859460830688, 0.09196390956640244, 0.09365136176347733, 0.07622112333774567, 0.09250123053789139, 0.0935739204287529], [0.04912959039211273, 0.049879975616931915, 0.04039151221513748, 0.07478319853544235, 0.04163478687405586, 0.07708506286144257, 0.053807374089956284, 0.04357180744409561, 0.47543466091156006, 0.050289977341890335, 0.04399208724498749], [0.09136603772640228, 0.09133695811033249, 0.09174258261919022, 0.09056345373392105, 0.09168419241905212, 0.09050581604242325, 0.09119169414043427, 0.09159667789936066, 0.08711308240890503, 0.09132125973701477, 0.09157820791006088], [0.09260345995426178, 0.09248869121074677, 0.09409910440444946, 0.0894746258854866, 0.0938660055398941, 0.08925297856330872, 0.09191698580980301, 0.09351744502782822, 0.0769098773598671, 0.09242677688598633, 0.09344403445720673]], [[0.09226025640964508, 0.08947261422872543, 0.09394703805446625, 0.09375393390655518, 0.09356122463941574, 0.08605644851922989, 0.09036003798246384, 0.09017430245876312, 0.08998895436525345, 0.08801189810037613, 0.0924132689833641], [0.09124182909727097, 0.09056355804204941, 0.09164474159479141, 0.09159889817237854, 0.09155306965112686, 0.08971019834280014, 0.09078119695186615, 0.0907357782125473, 0.09069038927555084, 0.09020174294710159, 0.09127860516309738], [0.09284935891628265, 0.08881770074367523, 0.09531556069850922, 0.0950322225689888, 0.09474971145391464, 0.08395316451787949, 0.09009513258934021, 0.08982730656862259, 0.08956027776002884, 0.0867273211479187, 0.09307225048542023], [0.09278292953968048, 0.08889246731996536, 0.09515982121229172, 0.09488685429096222, 0.0946146622300148, 0.0841900110244751, 0.09012582153081894, 0.08986728638410568, 0.08960949629545212, 0.0868728756904602, 0.09299783408641815], [0.09271635860204697, 0.08896712213754654, 0.09500414878129959, 0.09474151581525803, 0.09447960555553436, 0.0844273641705513, 0.09015633910894394, 0.08990710973739624, 0.08965856581926346, 0.08701849728822708, 0.09292330592870712], [0.08991289138793945, 0.09191291034221649, 0.08875232934951782, 0.08888337761163712, 0.08901461958885193, 0.09451478719711304, 0.0912647396326065, 0.09139949083328247, 0.09153444319963455, 0.09300421923398972, 0.08980611711740494], [0.09157226979732513, 0.09021518379449844, 0.09238322079181671, 0.09229075908660889, 0.09219839423894882, 0.08852216601371765, 0.09064952284097672, 0.09055879712104797, 0.0904681608080864, 0.08949539810419083, 0.09164614230394363], [0.09150359779596329, 0.09028802067041397, 0.09222909808158875, 0.09214641898870468, 0.09206381440162659, 0.0887688547372818, 0.09067727625370026, 0.09059598296880722, 0.09051476418972015, 0.08964251726865768, 0.09156971424818039], [0.09143480658531189, 0.09036073833703995, 0.09207505732774734, 0.09200212359428406, 0.09192924201488495, 0.08901605755090714, 0.09070486575365067, 0.09063301235437393, 0.09056121855974197, 0.08978970348834991, 0.09149318188428879], [0.09068483859300613, 0.09113903343677521, 0.09041769802570343, 0.09044799208641052, 0.09047830104827881, 0.09171859920024872, 0.09099267423152924, 0.09102316945791245, 0.09105367213487625, 0.09138364344835281, 0.09066037833690643], [0.09231451898813248, 0.08941303938627243, 0.09407193958759308, 0.09387068450450897, 0.09366986155509949, 0.0858624055981636, 0.09033630043268204, 0.09014303982257843, 0.08995018899440765, 0.08789413422346115, 0.09247389435768127]], [[0.09131523221731186, 0.09285267442464828, 0.09055245667695999, 0.09297332167625427, 0.09213685989379883, 0.09161214530467987, 0.09167163819074631, 0.09231649339199066, 0.08291371166706085, 0.09140657633543015, 0.09024889022111893], [0.0922369435429573, 0.10049634426832199, 0.08834723383188248, 0.10116886347532272, 0.09657987207174301, 0.09378781914710999, 0.09410110861063004, 0.09755095839500427, 0.056182559579610825, 0.09271188080310822, 0.08683647960424423], [0.09038012474775314, 0.08876774460077286, 0.09120120108127594, 0.08864356577396393, 0.08951149135828018, 0.09006436169147491, 0.09000134468078613, 0.08932372182607651, 0.10029168426990509, 0.09028275310993195, 0.09153198450803757], [0.09226344525814056, 0.10106661170721054, 0.08813446760177612, 0.10178545117378235, 0.09688640385866165, 0.09391278028488159, 0.09424617141485214, 0.09792190790176392, 0.054480597376823425, 0.0927683413028717, 0.0865338146686554], [0.09195087105035782, 0.09702832996845245, 0.08950113505125046, 0.09743476659059525, 0.09464091807603836, 0.0929168090224266, 0.09311121702194214, 0.09523618966341019, 0.06739366054534912, 0.09224730730056763, 0.08853884041309357], [0.09158626943826675, 0.0943872258067131, 0.09021059423685074, 0.0946086198091507, 0.09307845681905746, 0.09212426096200943, 0.09223224222660065, 0.09340613335371017, 0.07694890350103378, 0.09175163507461548, 0.08966569602489471], [0.09163476526737213, 0.09469117224216461, 0.09013666957616806, 0.09493310004472733, 0.09326201677322388, 0.09222118556499481, 0.0923389196395874, 0.09361966699361801, 0.07580365985631943, 0.09181498736143112, 0.08954383432865143], [0.0920444056391716, 0.0979127287864685, 0.08923026919364929, 0.09838449209928513, 0.09514756500720978, 0.09315714240074158, 0.09338130056858063, 0.09583606570959091, 0.06439231336116791, 0.09238571673631668, 0.0881279781460762], [0.054328303784132004, 0.0370587520301342, 0.06584033370018005, 0.035972483456134796, 0.04424828290939331, 0.0504341721534729, 0.049689508974552155, 0.04231707751750946, 0.49590733647346497, 0.053097862750291824, 0.07110580056905746], [0.09140384197235107, 0.09332798421382904, 0.09045218676328659, 0.09347931295633316, 0.09243114292621613, 0.0917748212814331, 0.0918491929769516, 0.09265603870153427, 0.08103344589471817, 0.09151794761419296, 0.09007400274276733], [0.08990360051393509, 0.08708170056343079, 0.09135564416646957, 0.08686599135398865, 0.08837849646806717, 0.08934787660837173, 0.08923714607954025, 0.08805031329393387, 0.1081036925315857, 0.08973206579685211, 0.09194348007440567]]]}, "num_training_step_calls_per_iteration": 1, "evaluation": {"env_runners": {"module_to_env_connector": {"timers": {"connectors": {"remove_single_ts_time_rank_from_batch": 1.1974747362992555e-05, "get_actions": 3.594448402235637e-05, "normalize_and_clip_actions": 7.924559337851723e-06, "listify_data_for_vector_env": 1.0570151444130454e-05, "tensor_to_numpy": 1.4874428372482137e-05, "un_batch_to_individual_items": 6.5963662306983284e-06}}, "connector_pipeline_timer": 0.00011428206975135865}, "episode_len_max": 20, "num_agent_steps_sampled_lifetime": {"default_agent": 4800}, "num_module_steps_sampled_lifetime": {"default_policy": 4800}, "episode_return_max": 14.5, "env_reset_timer": 0.0005453382934187821, "rlmodule_inference_timer": 3.056805385168878e-05, "env_step_timer": 1.4206694203984864e-05, "env_to_module_connector": {"timers": {"connectors": {"add_states_from_episodes_to_batch": 2.7121463210292667e-06, "numpy_to_tensor": 1.1938808658506405e-05, "add_time_dim_to_batch_and_zero_pad": 7.270427870126011e-06, "add_observations_from_episodes_to_batch": 2.862301279127325e-06, "batch_individual_items": 1.256291763710336e-05}}, "connector_pipeline_timer": 5.997732487989533e-05}, "episode_len_min": 20, "env_to_module_sum_episodes_length_out": 10.368238394574323, "env_to_module_sum_episodes_length_in": 10.368238394574323, "num_env_steps_sampled_lifetime": 60400, "num_agent_steps_sampled": {"default_agent": 400}, "weights_seq_no": 12.0, "module_episode_returns_mean": {"default_policy": 0.85}, "episode_len_mean": 20.0, "sample": 0.1259844500220817, "agent_episode_returns_mean": {"default_agent": 0.85}, "episode_return_mean": 0.85, "episode_return_min": -12.5, "num_episodes": 20, "episode_duration_sec_mean": 0.005418221668805927, "num_module_steps_sampled": {"default_policy": 400}, "num_episodes_lifetime": 240, "num_env_steps_sampled": 400, "time_between_sampling": 9.453648029624766}, "num_healthy_workers": 1, "actor_manager_num_outstanding_async_reqs": 0, "num_remote_worker_restarts": 0}, "num_env_steps_sampled_lifetime": -6165000.0, "fault_tolerance": {"num_healthy_workers": 0, "num_remote_worker_restarts": 0}, "env_runner_group": {"actor_manager_num_outstanding_async_reqs": 0}, "done": false, "training_iteration": 12, "trial_id": "b9446_00000", "date": "2025-08-11_18-36-12", "timestamp": 1754930172, "time_this_iter_s": 9.330674171447754, "time_total_s": 118.31246900558472, "pid": 11415, "hostname": "Mac", "node_ip": "127.0.0.1", "config": {"exploration_config": {}, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 2, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "env": "Umbrella", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": false, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 0, "create_local_env_runner": true, "num_envs_per_env_runner": 1, "gym_env_vectorize_mode": "SYNC", "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "episodes_to_numpy": true, "max_requests_in_flight_per_env_runner": 1, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "merge_env_runner_states": "training_only", "broadcast_env_runner_states": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "complete_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "sampler_perf_stats_ema_coef": null, "_is_online": true, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": "auto", "num_aggregator_actors_per_learner": 0, "max_requests_in_flight_per_aggregator_actor": 3, "local_gpu_idx": 0, "max_requests_in_flight_per_learner": 3, "gamma": 1, "lr": 0.0002715581955, "grad_clip": 0.5, "grad_clip_by": "global_norm", "_train_batch_size_per_learner": 5000, "train_batch_size": 4000, "num_epochs": 1, "minibatch_size": 1000, "shuffle_batch_per_epoch": true, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "log_std_clip_param": 20.0, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "_disable_preprocessor_api": false, "_disable_action_flattening": false}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {"intrinsic_reward_coeff": 0.2795015916508}, "optimizer": {}, "_learner_class": "<class 'source.intrinsic_attention_ppo.learners.IntrinsicAttentionMetaLearner.IntrinsicAttentionMetaLearner'>", "callbacks_on_algorithm_init": null, "callbacks_on_env_runners_recreated": null, "callbacks_on_offline_eval_runners_recreated": null, "callbacks_on_checkpoint_loaded": null, "callbacks_on_environment_created": null, "callbacks_on_episode_created": null, "callbacks_on_episode_start": null, "callbacks_on_episode_step": null, "callbacks_on_episode_end": null, "callbacks_on_evaluate_start": null, "callbacks_on_evaluate_end": null, "callbacks_on_evaluate_offline_start": null, "callbacks_on_evaluate_offline_end": null, "callbacks_on_sample_end": null, "callbacks_on_train_result": null, "explore": true, "enable_rl_module_and_learner": true, "enable_env_runner_and_connector_v2": true, "_prior_exploration_config": {"type": "StochasticSampling"}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x3884998a0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "offline_data_class": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_read_batch_size": null, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "materialize_data": false, "materialize_mapped_data": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "ignore_final_observation": false, "prelearner_class": null, "prelearner_buffer_class": null, "prelearner_buffer_kwargs": {}, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_remaining_data": false, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": 1, "evaluation_duration": 20, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_auto_duration_min_env_steps_per_sample": 100, "evaluation_auto_duration_max_env_steps_per_sample": 2000, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 1, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "offline_evaluation_interval": null, "num_offline_eval_runners": 0, "offline_loss_for_module_fn": null, "offline_evaluation_duration": 1, "offline_evaluation_parallel_to_training": false, "offline_evaluation_timeout_s": 120.0, "num_cpus_per_offline_eval_runner": 1, "num_gpus_per_offline_eval_runner": 0, "custom_resources_per_offline_eval_runner": {}, "restart_failed_offline_eval_runners": true, "ignore_offline_eval_runner_failures": false, "max_num_offline_eval_runner_restarts": 1000, "offline_eval_runner_restore_timeout_s": 1800.0, "max_requests_in_flight_per_offline_eval_runner": 1, "validate_offline_eval_runners_after_construction": true, "offline_eval_runner_health_probe_timeout_s": 30.0, "offline_eval_rl_module_inference_only": false, "broadcast_offline_eval_runner_states": false, "offline_eval_batch_size_per_runner": 256, "dataset_num_iters_per_eval_runner": 1, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "log_gradients": false, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 7, "restart_failed_env_runners": true, "ignore_env_runner_failures": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30.0, "env_runner_restore_timeout_s": 1800.0, "_model_config": {}, "_rl_module_spec": "MultiRLModuleSpec(multi_rl_module_class=<class 'ray.rllib.core.rl_module.multi_rl_module.MultiRLModule'>, observation_space=None, action_space=None, inference_only=False, model_config=None, rl_module_specs={'default_policy': RLModuleSpec(module_class=<class 'source.intrinsic_attention_ppo.rl_modules.DifferentiablePPOModule.DifferentiablePPOModule'>, observation_space=None, action_space=None, inference_only=False, learner_only=False, model_config={'vf_share_layers': True, 'embedding_dim': 62, 'max_seq_len': 11, 'policy_head_hidden_sizes': [32], 'value_head_hidden_sizes': [101], 'embedding_hidden_sizes': [121]}, catalog_class=None, load_state_path=None, model_config_dict=None), 'intrinsic_reward_module': RLModuleSpec(module_class=<class 'source.intrinsic_attention_ppo.rl_modules.IntrinsicAttentionModule.IntrinsicAttentionModule'>, observation_space=None, action_space=None, inference_only=False, learner_only=True, model_config={'intrinsic_reward_network': {'encoder_hidden_sizes': [], 'encoding_dim': 1, 'num_heads': 1, 'head_hidden_sizes': None, 'layers': [{'type': 'attention'}]}, 'extrinsic_value_hidden_layers': [127, 60], 'vf_share_layers': True, 'max_seq_len': 11}, catalog_class=None, load_state_path=None, model_config_dict=None)}, load_state_path=None, modules_to_load=None, module_specs={'default_policy': RLModuleSpec(module_class=<class 'source.intrinsic_attention_ppo.rl_modules.DifferentiablePPOModule.DifferentiablePPOModule'>, observation_space=None, action_space=None, inference_only=False, learner_only=False, model_config={'vf_share_layers': True, 'embedding_dim': 62, 'max_seq_len': 11, 'policy_head_hidden_sizes': [32], 'value_head_hidden_sizes': [101], 'embedding_hidden_sizes': [121]}, catalog_class=None, load_state_path=None, model_config_dict=None), 'intrinsic_reward_module': RLModuleSpec(module_class=<class 'source.intrinsic_attention_ppo.rl_modules.IntrinsicAttentionModule.IntrinsicAttentionModule'>, observation_space=None, action_space=None, inference_only=False, learner_only=True, model_config={'intrinsic_reward_network': {'encoder_hidden_sizes': [], 'encoding_dim': 1, 'num_heads': 1, 'head_hidden_sizes': None, 'layers': [{'type': 'attention'}]}, 'extrinsic_value_hidden_layers': [127, 60], 'vf_share_layers': True, 'max_seq_len': 11}, catalog_class=None, load_state_path=None, model_config_dict=None)})", "algorithm_config_overrides_per_module": {"intrinsic_reward_module": {"lr": 0.0002715581955}}, "_per_module_overrides": {}, "_validate_config": true, "_use_msgpack_checkpoints": false, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "env_task_fn": -1, "enable_connectors": -1, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.161583927863, "kl_target": 0.0201019014258, "vf_loss_coeff": 0.7790510010087, "entropy_coeff": 0.0015431216992, "clip_param": 0.2459212356676, "vf_clip_param": 0.3769744131561, "entropy_coeff_schedule": null, "lr_schedule": null, "sgd_minibatch_size": -1, "vf_share_layers": -1, "differentiable_learner_configs": ["DifferentiableLearnerConfig(learner_class=<class 'source.intrinsic_attention_ppo.learners.IntrinsicAttentionPPOLearner.IntrinsicAttentionPPOLearner'>, learner_connector=None, add_default_connectors_to_learner_pipeline=True, is_multi_agent=False, policies_to_update=['default_policy'], lr=0.0060984166342, num_total_minibatches=0, num_epochs=1, minibatch_size=1000, shuffle_batch_per_epoch=True)"], "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9485408017724, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.callbacks.callbacks.RLlibCallback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 118.31246900558472, "iterations_since_restore": 12, "perf": {"cpu_util_percent": 43.91428571428571, "ram_util_percent": 81.62142857142858}}
{"timers": {"training_iteration": 10.17201151625442, "restore_env_runners": 1.2652394459329074e-05, "training_step": 10.171805375376724, "env_runner_sampling_timer": 2.496280195200863, "learner_update_timer": 7.421371598170668, "synch_weights": 0.0017548461076006248, "restore_eval_env_runners": 4.417022286615105e-05, "evaluation_iteration": 0.13742503640571224, "synch_eval_env_connectors": 0.00018178432679887032, "synch_env_connectors": 4.713546487752273e-06}, "env_runners": {"env_reset_timer": 4.5712084220680985e-05, "num_episodes_lifetime": -339125.0, "num_env_steps_sampled_lifetime": -6782500.0, "num_env_steps_sampled": 5000.0, "module_to_env_connector": {"timers": {"connectors": {"remove_single_ts_time_rank_from_batch": 1.2011090702370096e-05, "get_actions": 3.958499105144267e-05, "listify_data_for_vector_env": 1.068806577523096e-05, "tensor_to_numpy": 1.5369862142345255e-05, "un_batch_to_individual_items": 6.658821639870142e-06, "normalize_and_clip_actions": 8.06965808460914e-06}}, "connector_pipeline_timer": 0.00011891062595018751}, "module_episode_returns_mean": {"default_policy": 0.3400000000000001}, "time_between_sampling": 0.031737627216114304, "rlmodule_inference_timer": 3.17869645033135e-05, "env_step_timer": 1.4272351489018367e-05, "env_to_module_connector": {"timers": {"connectors": {"batch_individual_items": 1.2579975105792582e-05, "add_observations_from_episodes_to_batch": 2.9164328176480595e-06, "add_states_from_episodes_to_batch": 2.7124117744355268e-06, "numpy_to_tensor": 1.2652942048253251e-05, "add_time_dim_to_batch_and_zero_pad": 7.328154341597566e-06}}, "connector_pipeline_timer": 6.033758182060525e-05}, "weights_seq_no": 12.0, "num_agent_steps_sampled": {"default_agent": 5000.0}, "episode_len_min": 20, "episode_len_mean": 20.0, "num_episodes": 250.0, "sample": 0.005750813756167126, "episode_duration_sec_mean": 0.005321621330454948, "episode_len_max": 20, "num_module_steps_sampled": {"default_policy": 5000.0}, "num_agent_steps_sampled_lifetime": {"default_agent": -6782500.0}, "num_module_steps_sampled_lifetime": {"default_policy": -6782500.0}, "env_to_module_sum_episodes_length_out": 10.36823839457432, "agent_episode_returns_mean": {"default_agent": 0.3400000000000001}, "episode_return_max": 10.5, "episode_return_min": -9.5, "env_to_module_sum_episodes_length_in": 10.36823839457432, "episode_return_mean": 0.3400000000000001, "num_env_steps_sampled_lifetime_throughput": 3207.662633500142}, "__all_modules__": {"learner_connector_sum_episodes_length_in": 5000.0, "learner_connector": {"connector_pipeline_timer": 0.21184620792206663, "timers": {"connectors": {"add_one_ts_to_episodes_and_truncate": 0.009151244576791616, "add_observations_from_episodes_to_batch": 0.0009635258318801901, "add_columns_from_episodes_to_train_batch": 0.09564394719487473, "add_time_dim_to_batch_and_zero_pad": 0.08734263642563826, "add_states_from_episodes_to_batch": 0.003619708504373724, "batch_individual_items": 0.014840090227586455, "numpy_to_tensor": 8.82579923204183e-05}}}, "learner_connector_sum_episodes_length_out": 5250.0}, "learners": {"differentiable_learners": {"intrinsic_attention_ppo_learner": {"intrinsic_reward_module": {"num_module_steps_trained_lifetime": 466830, "weights_seq_no": 78.0, "total_loss": 0.0, "num_module_steps_trained": 35910, "diff_num_grad_updates_vs_sampler_policy": 66.0, "module_train_batch_size_mean": 997.5020416990191}, "default_policy": {"module_train_batch_size_mean": 997.5020416990191, "use_intrinsic_rewards": 1.0, "num_module_steps_trained_lifetime": 466830, "policy_loss": -0.000391665700590238, "mean_kl_loss": 3.0498138585244305e-05, "entropy": 0.6928083300590515, "weights_seq_no": 78.0, "vf_loss_unclipped": 44.463523864746094, "vf_loss": 0.35835886001586914, "total_loss": 0.2777239978313446, "vf_explained_var": -0.0014744997024536133, "num_module_steps_trained": 35910, "diff_num_grad_updates_vs_sampler_policy": 66.0}, "__all_modules__": {"num_env_steps_trained_lifetime": 2574000, "num_module_steps_trained": 71820, "num_module_steps_trained_lifetime": 933660, "num_env_steps_trained": 198000, "num_env_steps_trained_lifetime_throughput": 48698.688078809435}}}, "intrinsic_reward_module": {"num_module_steps_trained": 5985, "curr_entropy_coeff": 0.0015431216992, "total_loss": 0.0, "num_module_steps_trained_lifetime": 77805, "gradients_default_optimizer_global_norm": 0.0, "diff_num_grad_updates_vs_sampler_policy": 1.0, "module_train_batch_size_mean": 997.7269395717314, "default_optimizer_learning_rate": 0.0002715581955, "num_trainable_parameters": 8266, "weights_seq_no": 13.0, "num_module_steps_trained_lifetime_throughput": 789.3044574202434}, "__all_modules__": {"num_trainable_parameters": 24861, "num_non_trainable_parameters": 0, "num_env_steps_trained_lifetime": 429000, "num_module_steps_trained": 11970, "num_module_steps_trained_lifetime": 155610, "num_env_steps_trained": 33000, "num_env_steps_trained_lifetime_throughput": 4353.360292036167, "num_module_steps_trained_throughput": 23954976.13336574, "num_module_steps_trained_lifetime_throughput": 13057836.325280743}, "default_policy": {"vf_loss": 0.3583044409751892, "weights_seq_no": 13.0, "curr_entropy_coeff": 0.0015431216992, "vf_loss_unclipped": 44.33615493774414, "total_loss": 0.27766358852386475, "vf_explained_var": -0.0002608299255371094, "num_module_steps_trained": 5985, "diff_num_grad_updates_vs_sampler_policy": 1.0, "curr_kl_coeff": 1.9724600861081854e-05, "use_intrinsic_rewards": 0.0, "module_train_batch_size_mean": 997.7269395717314, "num_module_steps_trained_lifetime": 77805, "policy_loss": -0.00040477243601344526, "num_trainable_parameters": 16595, "mean_kl_loss": 3.24434440699406e-05, "entropy": 0.6928145885467529, "num_module_steps_trained_lifetime_throughput": 789.2929026352456}, "IntrinsicAttentionMask": [[[0.09312611073255539, 0.09031230956315994, 0.09012667089700699, 0.08994141966104507, 0.09443929046392441, 0.08686408400535583, 0.09120805561542511, 0.09102057665586472, 0.09083349257707596, 0.0934726893901825, 0.08865527808666229], [0.09144775569438934, 0.09076795727014542, 0.09072254598140717, 0.0906771644949913, 0.09175970405340195, 0.08991266787052155, 0.09098608791828156, 0.09094056487083435, 0.09089507162570953, 0.09153041243553162, 0.09036009758710861], [0.09133530408143997, 0.09079762548208237, 0.09076167643070221, 0.09072574228048325, 0.09158176183700562, 0.09011994302272797, 0.0909702405333519, 0.09093423187732697, 0.09089823067188263, 0.0914006233215332, 0.09047462046146393], [0.09122287482023239, 0.09082717448472977, 0.0908007025718689, 0.09077423810958862, 0.09140404313802719, 0.09032756835222244, 0.09095428138971329, 0.09092776477336884, 0.09090125560760498, 0.09127090126276016, 0.09058917313814163], [0.09389298409223557, 0.09009616822004318, 0.08984710276126862, 0.08959873020648956, 0.09567861258983612, 0.08549879491329193, 0.09130047261714935, 0.09104808419942856, 0.09079638868570328, 0.09436342120170593, 0.08787921071052551], [0.08932316303253174, 0.0913100615143776, 0.09144487977027893, 0.09157989919185638, 0.08843076974153519, 0.09389486908912659, 0.09066613763570786, 0.09080000221729279, 0.09093406796455383, 0.08908554911613464, 0.09253063052892685], [0.09198732674121857, 0.09062409400939941, 0.09053339064121246, 0.09044278413057327, 0.09261629730463028, 0.08892340213060379, 0.09106040000915527, 0.0909692645072937, 0.09087822586297989, 0.09215376526117325, 0.08981107920408249], [0.09187480807304382, 0.09065429121255875, 0.0905730277299881, 0.09049183130264282, 0.09243728965520859, 0.08912897109985352, 0.09104512631893158, 0.09096350520849228, 0.09088196605443954, 0.09202369302511215, 0.08992548286914825], [0.09176230430603027, 0.09068439155817032, 0.09061256051063538, 0.09054078161716461, 0.0922585129737854, 0.0893348976969719, 0.09102974832057953, 0.0909576416015625, 0.09088558703660965, 0.09189368784427643, 0.090039923787117], [0.09332950413227081, 0.09025546908378601, 0.09005296975374222, 0.08985092490911484, 0.09476707130670547, 0.08650030195713043, 0.09123311936855316, 0.09102842956781387, 0.090824194252491, 0.09370873123407364, 0.08844926953315735], [0.09043632447719574, 0.09103091061115265, 0.09107092767953873, 0.091110959649086, 0.09016624838113785, 0.09179097414016724, 0.0908392146229744, 0.09087914973497391, 0.09091909229755402, 0.09036459773778915, 0.0913916751742363]], [[0.09032315760850906, 0.08593074977397919, 0.08345287293195724, 0.09089454263448715, 0.08827352523803711, 0.08665630221366882, 0.08683864772319794, 0.08883193135261536, 0.12373542040586472, 0.09061602503061295, 0.08444692194461823], [0.0909053310751915, 0.09171683341264725, 0.0921964943408966, 0.09080319851636887, 0.091278076171875, 0.09157945960760117, 0.09154514968395233, 0.09117551892995834, 0.08594495058059692, 0.09085288643836975, 0.09200207144021988], [0.09062647074460983, 0.094642773270607, 0.09708244353532791, 0.09013073146343231, 0.09245409816503525, 0.09395312517881393, 0.0937815010547638, 0.09194835275411606, 0.06892125308513641, 0.09037164598703384, 0.09608764201402664], [0.09013814479112625, 0.08511991798877716, 0.08230569958686829, 0.09079364687204361, 0.08779185265302658, 0.08594626188278198, 0.08615409582853317, 0.08843028545379639, 0.12941277027130127, 0.09047405421733856, 0.08343320339918137], [0.09077543765306473, 0.08872859925031662, 0.08754880726337433, 0.09103769063949585, 0.08982720226049423, 0.08907055109739304, 0.08915624767541885, 0.09008671343326569, 0.1048344299197197, 0.09090997278690338, 0.08802435547113419], [0.09090759605169296, 0.09081494808197021, 0.09076061844825745, 0.09091932326555252, 0.09086492657661438, 0.09083056449890137, 0.09083447605371475, 0.09087664633989334, 0.09149471670389175, 0.09091361612081528, 0.09078260511159897], [0.09090226143598557, 0.09058499336242676, 0.09039928764104843, 0.09094247221946716, 0.09075603634119034, 0.0906384214758873, 0.09065178781747818, 0.09079618752002716, 0.09293124079704285, 0.09092289954423904, 0.09047438949346542], [0.09068441390991211, 0.08798345923423767, 0.08643580973148346, 0.09103193134069443, 0.08943065255880356, 0.08843329548835754, 0.08854611217975616, 0.08977336436510086, 0.10975943505764008, 0.09086264669895172, 0.08705882728099823], [0.04509195685386658, 0.02960634045302868, 0.023128336295485497, 0.047556668519973755, 0.03715104982256889, 0.03178344666957855, 0.03235229477286339, 0.03918170556426048, 0.6422483325004578, 0.04634081944823265, 0.025558989495038986], [0.09023159742355347, 0.08551683276891708, 0.0828651636838913, 0.0908462181687355, 0.08802930265665054, 0.08629438281059265, 0.08648987114429474, 0.08862892538309097, 0.12662291526794434, 0.09054658561944962, 0.08392822742462158], [0.09078727662563324, 0.09349707514047623, 0.09512504935264587, 0.09045014530420303, 0.09202507138252258, 0.09303443878889084, 0.09291914105415344, 0.09168333560228348, 0.07540147751569748, 0.09061405807733536, 0.09446283429861069]], [[0.0908394604921341, 0.09088703989982605, 0.0909346416592598, 0.08981242775917053, 0.09102991223335266, 0.09179185330867767, 0.09065906703472137, 0.09070654958486557, 0.09075404703617096, 0.09126853197813034, 0.0913163349032402], [0.09082531183958054, 0.09088236838579178, 0.090939462184906, 0.0895950123667717, 0.09105375409126282, 0.09196867048740387, 0.09060900658369064, 0.09066592901945114, 0.09072288870811462, 0.09134012460708618, 0.09139750152826309], [0.09081104397773743, 0.09087757766246796, 0.09094417095184326, 0.08937801420688629, 0.09107749164104462, 0.09214571118354797, 0.09055886417627335, 0.09062521904706955, 0.09069161862134933, 0.09141165018081665, 0.0914786234498024], [0.09112377464771271, 0.09096496552228928, 0.09080643951892853, 0.09464173763990402, 0.0904901996254921, 0.0880119577050209, 0.09172923117876053, 0.09156937152147293, 0.09140978753566742, 0.08970443159341812, 0.08954810351133347], [0.09078224003314972, 0.09086773544549942, 0.09095331281423569, 0.08894532173871994, 0.09112469851970673, 0.09250053018331528, 0.09045838564634323, 0.09054356813430786, 0.09062884002923965, 0.09155458956956863, 0.09164080768823624], [0.0905396118760109, 0.09077566862106323, 0.09101233631372452, 0.08556199818849564, 0.09148754179477692, 0.09535964578390121, 0.08964896202087402, 0.08988270163536072, 0.09011704474687576, 0.09268641471862793, 0.09292806684970856], [0.09089240431785583, 0.09090396016836166, 0.0909155085682869, 0.09064187854528427, 0.09093862771987915, 0.0911228209733963, 0.09084855765104294, 0.09086010605096817, 0.0908716544508934, 0.09099643677473068, 0.09100800007581711], [0.09087859839200974, 0.09089963883161545, 0.09092067927122116, 0.09042280167341232, 0.09096279740333557, 0.09129869937896729, 0.0907987430691719, 0.09081976860761642, 0.09084079414606094, 0.09106816351413727, 0.09108924865722656], [0.09086470305919647, 0.09089522808790207, 0.09092576801776886, 0.0902041643857956, 0.09098688513040543, 0.09147483110427856, 0.0907488688826561, 0.0907793641090393, 0.09080986678600311, 0.09113985300064087, 0.09117048233747482], [0.09070857614278793, 0.09084141999483109, 0.09097445756196976, 0.08787107467651367, 0.09124112874269485, 0.09339182823896408, 0.09020597487688065, 0.0903380885720253, 0.09047038853168488, 0.0919112116098404, 0.09204581379890442], [0.09069357067346573, 0.09083588421344757, 0.09097841382026672, 0.08765751123428345, 0.09126415103673935, 0.09357082843780518, 0.09015530347824097, 0.09029676765203476, 0.09043845534324646, 0.0919824168086052, 0.0921267494559288]], [[0.09105853736400604, 0.09111767262220383, 0.09175863116979599, 0.09271197021007538, 0.09187785536050797, 0.09283243119716644, 0.0914139449596405, 0.09059150516986847, 0.08401811867952347, 0.09262412786483765, 0.08999519050121307], [0.09107685834169388, 0.09114553034305573, 0.09189022332429886, 0.0929994210600853, 0.09202884137630463, 0.09313970804214478, 0.09148965030908585, 0.09053482860326767, 0.08295433223247528, 0.09289714694023132, 0.08984339237213135], [0.09117934852838516, 0.09135103225708008, 0.0932253748178482, 0.09605953842401505, 0.09357678145170212, 0.09642162919044495, 0.09221433103084564, 0.08983095735311508, 0.07221661508083344, 0.09579607844352722, 0.08812833577394485], [0.09103846549987793, 0.0913616493344307, 0.09492487460374832, 0.10043405741453171, 0.09560003876686096, 0.10114839673042297, 0.09299486875534058, 0.0885189101099968, 0.058678071945905685, 0.09991578012704849, 0.08538490533828735], [0.09117995947599411, 0.09137073159217834, 0.09345598518848419, 0.09661788493394852, 0.09384745359420776, 0.09702260047197342, 0.09233058243989944, 0.08968309313058853, 0.07037162780761719, 0.09632351994514465, 0.08779654651880264], [0.09099840372800827, 0.09134051948785782, 0.09511718153953552, 0.10097268968820572, 0.09583372622728348, 0.10173335671424866, 0.09307050704956055, 0.08833372592926025, 0.05715342238545418, 0.1004210114479065, 0.08502543717622757], [0.09114562720060349, 0.09126199036836624, 0.09252779185771942, 0.09442636370658875, 0.09276419878005981, 0.09466761350631714, 0.0918460264801979, 0.09022928774356842, 0.07781452685594559, 0.0942506417632103, 0.08906585723161697], [0.09085720777511597, 0.09084105491638184, 0.09066681563854218, 0.0904104933142662, 0.09063456952571869, 0.09037834405899048, 0.09076032042503357, 0.0909852609038353, 0.09288198500871658, 0.09043397009372711, 0.09114999324083328], [0.07301495969295502, 0.07212280482053757, 0.06315772235393524, 0.051930878311395645, 0.06162372604012489, 0.050669554620981216, 0.0678228884935379, 0.08048194646835327, 0.33510085940361023, 0.052871398627758026, 0.09120321273803711], [0.0910646989941597, 0.09137403964996338, 0.09478160738945007, 0.10003935545682907, 0.09542664885520935, 0.10072017461061478, 0.09293661266565323, 0.08865140378475189, 0.059814684092998505, 0.09954527765512466, 0.08564542979001999], [0.09044405817985535, 0.09033196419477463, 0.08913057297468185, 0.08738818019628525, 0.08890978991985321, 0.08717171102762222, 0.08977359533309937, 0.09133673459291458, 0.10547072440385818, 0.08754654228687286, 0.09249619394540787]], [[0.09094598144292831, 0.0898236334323883, 0.09104126691818237, 0.09108895063400269, 0.09113665670156479, 0.0907178670167923, 0.09076537936925888, 0.09199577569961548, 0.09086047857999802, 0.09020067006349564, 0.0914234071969986], [0.09074261784553528, 0.09504485875368118, 0.09038884192705154, 0.09021247178316116, 0.09003644436597824, 0.09159673750400543, 0.09141800552606583, 0.08693966269493103, 0.09106159955263138, 0.09357131272554398, 0.08898747712373734], [0.09095978736877441, 0.08939336240291595, 0.09109313040971756, 0.0911598727107048, 0.09122666716575623, 0.09064077585935593, 0.0907071903347969, 0.09243194013834, 0.0908401682972908, 0.08991870284080505, 0.09162846207618713], [0.09096649289131165, 0.08917880803346634, 0.09111887216567993, 0.09119515866041183, 0.09127151221036911, 0.09060207009315491, 0.09067791700363159, 0.09265059977769852, 0.09082981944084167, 0.0897778570652008, 0.09173095971345901], [0.09097305685281754, 0.08896462619304657, 0.09114447981119156, 0.09123031795024872, 0.09131623059511185, 0.09056323021650314, 0.09064851701259613, 0.09286963194608688, 0.0908193364739418, 0.08963710069656372, 0.0918334349989891], [0.09091075509786606, 0.09086188673973083, 0.09091487526893616, 0.0909169390797615, 0.09091900289058685, 0.09090087562799454, 0.09090293198823929, 0.0909559428691864, 0.09090705215930939, 0.09087836742401123, 0.09093137085437775], [0.09091835469007492, 0.0906447023153305, 0.09094147384166718, 0.090953029692173, 0.09096458554267883, 0.090862937271595, 0.09087449312210083, 0.09117200970649719, 0.09089759737253189, 0.09073691815137863, 0.09103398770093918], [0.09106877446174622, 0.085192009806633, 0.0915825143456459, 0.0918404683470726, 0.0920991525053978, 0.08984837681055069, 0.0901014506816864, 0.09686022251844406, 0.09060972929000854, 0.08713068813085556, 0.09366662055253983], [0.09093314409255981, 0.09021148085594177, 0.09099426120519638, 0.09102483838796616, 0.09105542302131653, 0.09078672528266907, 0.09081722795963287, 0.09160526841878891, 0.09087827056646347, 0.09045426547527313, 0.09123915433883667], [0.09081939607858658, 0.09325902909040451, 0.0906166061758995, 0.0905153751373291, 0.09041426330804825, 0.09130760282278061, 0.09120560437440872, 0.0886213555932045, 0.0910019502043724, 0.09242885559797287, 0.08980995416641235], [0.09100977331399918, 0.08768773078918457, 0.09129560738801956, 0.09143885970115662, 0.09158233553171158, 0.09032789617776871, 0.09046962857246399, 0.09419196099042892, 0.09075376391410828, 0.0887945368885994, 0.09244794398546219]], [[0.09198200702667236, 0.09085553139448166, 0.09146354347467422, 0.09184987843036652, 0.0913759395480156, 0.09176189452409744, 0.09063811600208282, 0.09233172982931137, 0.0846056416630745, 0.09083201736211777, 0.09230371564626694], [0.08547449856996536, 0.09046471118927002, 0.08772847056388855, 0.08604215085506439, 0.08811645954847336, 0.08642268180847168, 0.09146825969219208, 0.0839938223361969, 0.12560512125492096, 0.09057255834341049, 0.0841112732887268], [0.08914868533611298, 0.0908912941813469, 0.08994385600090027, 0.08935023844242096, 0.09007937461137772, 0.08948486298322678, 0.09123403578996658, 0.08861877024173737, 0.1016596332192421, 0.09092824906110764, 0.08866102993488312], [0.09128459542989731, 0.09089604020118713, 0.09110615402460098, 0.09123918414115906, 0.09107593446969986, 0.09120891988277435, 0.09082069247961044, 0.09140458703041077, 0.08868099004030228, 0.09088790416717529, 0.09139499068260193], [0.08864348381757736, 0.0908629521727562, 0.08965477347373962, 0.08889957517385483, 0.08982737362384796, 0.08907072246074677, 0.09130087494850159, 0.08797093480825424, 0.10483463853597641, 0.09091014415025711, 0.08802452683448792], [0.09081105142831802, 0.09091150760650635, 0.0908571109175682, 0.09082276374101639, 0.09086492657661438, 0.09083057194948196, 0.09093105047941208, 0.09078013151884079, 0.09149473905563354, 0.09091361612081528, 0.09078260511159897], [0.08406183868646622, 0.09017231315374374, 0.08681164681911469, 0.08475277572870255, 0.08728668093681335, 0.08521653711795807, 0.09141095727682114, 0.0822647288441658, 0.13531023263931274, 0.09030528366565704, 0.08240700513124466], [0.0937511995434761, 0.09065422415733337, 0.09231764078140259, 0.09338453412055969, 0.09207677841186523, 0.09314089268445969, 0.09006407111883163, 0.09472612291574478, 0.0746464729309082, 0.09059029817581177, 0.09464779496192932], [0.02908479981124401, 0.04589748755097389, 0.03585489094257355, 0.030674565583467484, 0.03714980557560921, 0.03178239241242409, 0.050154440104961395, 0.025272613391280174, 0.6422315835952759, 0.04633929207921028, 0.02555813081562519], [0.08532434701919556, 0.09043685346841812, 0.08763263374567032, 0.0859055295586586, 0.0880301296710968, 0.08629519492387772, 0.09146588295698166, 0.08380883187055588, 0.12662416696548462, 0.09054743498563766, 0.08392900973558426], [0.09361346065998077, 0.09067511558532715, 0.09225395321846008, 0.0932658389210701, 0.09202542901039124, 0.09303480386734009, 0.09011462330818176, 0.09453742206096649, 0.07540175318717957, 0.09061441570520401, 0.09446320682764053]]]}, "num_training_step_calls_per_iteration": 1, "evaluation": {"env_runners": {"module_to_env_connector": {"timers": {"connectors": {"remove_single_ts_time_rank_from_batch": 1.2428842136070095e-05, "get_actions": 3.847523043239399e-05, "normalize_and_clip_actions": 8.208379983076012e-06, "listify_data_for_vector_env": 1.125631031168403e-05, "tensor_to_numpy": 1.543312059504002e-05, "un_batch_to_individual_items": 6.886831741540904e-06}}, "connector_pipeline_timer": 0.00012001710068210241}, "episode_len_max": 20, "num_agent_steps_sampled_lifetime": {"default_agent": 5200}, "num_module_steps_sampled_lifetime": {"default_policy": 5200}, "episode_return_max": 14.5, "env_reset_timer": 0.0005434607502853545, "rlmodule_inference_timer": 3.199331831849379e-05, "env_step_timer": 1.4848426701609785e-05, "env_to_module_connector": {"timers": {"connectors": {"add_states_from_episodes_to_batch": 2.853948543051251e-06, "numpy_to_tensor": 1.2561920652560219e-05, "add_time_dim_to_batch_and_zero_pad": 7.349894875958931e-06, "add_observations_from_episodes_to_batch": 2.9988985236516513e-06, "batch_individual_items": 1.2806969856422856e-05}}, "connector_pipeline_timer": 6.157248788634679e-05}, "episode_len_min": 20, "env_to_module_sum_episodes_length_out": 10.368238394574323, "env_to_module_sum_episodes_length_in": 10.368238394574323, "num_env_steps_sampled_lifetime": 65400, "num_agent_steps_sampled": {"default_agent": 400}, "weights_seq_no": 13.0, "module_episode_returns_mean": {"default_policy": 1.45}, "episode_len_mean": 20.0, "sample": 0.12601503886233398, "agent_episode_returns_mean": {"default_agent": 1.45}, "episode_return_mean": 1.45, "episode_return_min": -12.5, "num_episodes": 20, "episode_duration_sec_mean": 0.0053734187409281734, "num_module_steps_sampled": {"default_policy": 400}, "num_episodes_lifetime": 260, "num_env_steps_sampled": 400, "time_between_sampling": 9.454888360577607}, "num_healthy_workers": 1, "actor_manager_num_outstanding_async_reqs": 0, "num_remote_worker_restarts": 0}, "num_env_steps_sampled_lifetime": -6782500.0, "fault_tolerance": {"num_healthy_workers": 0, "num_remote_worker_restarts": 0}, "env_runner_group": {"actor_manager_num_outstanding_async_reqs": 0}, "done": false, "training_iteration": 13, "trial_id": "b9446_00000", "date": "2025-08-11_18-36-21", "timestamp": 1754930181, "time_this_iter_s": 9.687619924545288, "time_total_s": 128.00008893013, "pid": 11415, "hostname": "Mac", "node_ip": "127.0.0.1", "config": {"exploration_config": {}, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 2, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "env": "Umbrella", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": false, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 0, "create_local_env_runner": true, "num_envs_per_env_runner": 1, "gym_env_vectorize_mode": "SYNC", "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "episodes_to_numpy": true, "max_requests_in_flight_per_env_runner": 1, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "merge_env_runner_states": "training_only", "broadcast_env_runner_states": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "complete_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "sampler_perf_stats_ema_coef": null, "_is_online": true, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": "auto", "num_aggregator_actors_per_learner": 0, "max_requests_in_flight_per_aggregator_actor": 3, "local_gpu_idx": 0, "max_requests_in_flight_per_learner": 3, "gamma": 1, "lr": 0.0002715581955, "grad_clip": 0.5, "grad_clip_by": "global_norm", "_train_batch_size_per_learner": 5000, "train_batch_size": 4000, "num_epochs": 1, "minibatch_size": 1000, "shuffle_batch_per_epoch": true, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "log_std_clip_param": 20.0, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "_disable_preprocessor_api": false, "_disable_action_flattening": false}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {"intrinsic_reward_coeff": 0.2795015916508}, "optimizer": {}, "_learner_class": "<class 'source.intrinsic_attention_ppo.learners.IntrinsicAttentionMetaLearner.IntrinsicAttentionMetaLearner'>", "callbacks_on_algorithm_init": null, "callbacks_on_env_runners_recreated": null, "callbacks_on_offline_eval_runners_recreated": null, "callbacks_on_checkpoint_loaded": null, "callbacks_on_environment_created": null, "callbacks_on_episode_created": null, "callbacks_on_episode_start": null, "callbacks_on_episode_step": null, "callbacks_on_episode_end": null, "callbacks_on_evaluate_start": null, "callbacks_on_evaluate_end": null, "callbacks_on_evaluate_offline_start": null, "callbacks_on_evaluate_offline_end": null, "callbacks_on_sample_end": null, "callbacks_on_train_result": null, "explore": true, "enable_rl_module_and_learner": true, "enable_env_runner_and_connector_v2": true, "_prior_exploration_config": {"type": "StochasticSampling"}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x3884998a0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "offline_data_class": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_read_batch_size": null, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "materialize_data": false, "materialize_mapped_data": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "ignore_final_observation": false, "prelearner_class": null, "prelearner_buffer_class": null, "prelearner_buffer_kwargs": {}, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_remaining_data": false, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": 1, "evaluation_duration": 20, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_auto_duration_min_env_steps_per_sample": 100, "evaluation_auto_duration_max_env_steps_per_sample": 2000, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 1, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "offline_evaluation_interval": null, "num_offline_eval_runners": 0, "offline_loss_for_module_fn": null, "offline_evaluation_duration": 1, "offline_evaluation_parallel_to_training": false, "offline_evaluation_timeout_s": 120.0, "num_cpus_per_offline_eval_runner": 1, "num_gpus_per_offline_eval_runner": 0, "custom_resources_per_offline_eval_runner": {}, "restart_failed_offline_eval_runners": true, "ignore_offline_eval_runner_failures": false, "max_num_offline_eval_runner_restarts": 1000, "offline_eval_runner_restore_timeout_s": 1800.0, "max_requests_in_flight_per_offline_eval_runner": 1, "validate_offline_eval_runners_after_construction": true, "offline_eval_runner_health_probe_timeout_s": 30.0, "offline_eval_rl_module_inference_only": false, "broadcast_offline_eval_runner_states": false, "offline_eval_batch_size_per_runner": 256, "dataset_num_iters_per_eval_runner": 1, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "log_gradients": false, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 7, "restart_failed_env_runners": true, "ignore_env_runner_failures": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30.0, "env_runner_restore_timeout_s": 1800.0, "_model_config": {}, "_rl_module_spec": "MultiRLModuleSpec(multi_rl_module_class=<class 'ray.rllib.core.rl_module.multi_rl_module.MultiRLModule'>, observation_space=None, action_space=None, inference_only=False, model_config=None, rl_module_specs={'default_policy': RLModuleSpec(module_class=<class 'source.intrinsic_attention_ppo.rl_modules.DifferentiablePPOModule.DifferentiablePPOModule'>, observation_space=None, action_space=None, inference_only=False, learner_only=False, model_config={'vf_share_layers': True, 'embedding_dim': 62, 'max_seq_len': 11, 'policy_head_hidden_sizes': [32], 'value_head_hidden_sizes': [101], 'embedding_hidden_sizes': [121]}, catalog_class=None, load_state_path=None, model_config_dict=None), 'intrinsic_reward_module': RLModuleSpec(module_class=<class 'source.intrinsic_attention_ppo.rl_modules.IntrinsicAttentionModule.IntrinsicAttentionModule'>, observation_space=None, action_space=None, inference_only=False, learner_only=True, model_config={'intrinsic_reward_network': {'encoder_hidden_sizes': [], 'encoding_dim': 1, 'num_heads': 1, 'head_hidden_sizes': None, 'layers': [{'type': 'attention'}]}, 'extrinsic_value_hidden_layers': [127, 60], 'vf_share_layers': True, 'max_seq_len': 11}, catalog_class=None, load_state_path=None, model_config_dict=None)}, load_state_path=None, modules_to_load=None, module_specs={'default_policy': RLModuleSpec(module_class=<class 'source.intrinsic_attention_ppo.rl_modules.DifferentiablePPOModule.DifferentiablePPOModule'>, observation_space=None, action_space=None, inference_only=False, learner_only=False, model_config={'vf_share_layers': True, 'embedding_dim': 62, 'max_seq_len': 11, 'policy_head_hidden_sizes': [32], 'value_head_hidden_sizes': [101], 'embedding_hidden_sizes': [121]}, catalog_class=None, load_state_path=None, model_config_dict=None), 'intrinsic_reward_module': RLModuleSpec(module_class=<class 'source.intrinsic_attention_ppo.rl_modules.IntrinsicAttentionModule.IntrinsicAttentionModule'>, observation_space=None, action_space=None, inference_only=False, learner_only=True, model_config={'intrinsic_reward_network': {'encoder_hidden_sizes': [], 'encoding_dim': 1, 'num_heads': 1, 'head_hidden_sizes': None, 'layers': [{'type': 'attention'}]}, 'extrinsic_value_hidden_layers': [127, 60], 'vf_share_layers': True, 'max_seq_len': 11}, catalog_class=None, load_state_path=None, model_config_dict=None)})", "algorithm_config_overrides_per_module": {"intrinsic_reward_module": {"lr": 0.0002715581955}}, "_per_module_overrides": {}, "_validate_config": true, "_use_msgpack_checkpoints": false, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "env_task_fn": -1, "enable_connectors": -1, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.161583927863, "kl_target": 0.0201019014258, "vf_loss_coeff": 0.7790510010087, "entropy_coeff": 0.0015431216992, "clip_param": 0.2459212356676, "vf_clip_param": 0.3769744131561, "entropy_coeff_schedule": null, "lr_schedule": null, "sgd_minibatch_size": -1, "vf_share_layers": -1, "differentiable_learner_configs": ["DifferentiableLearnerConfig(learner_class=<class 'source.intrinsic_attention_ppo.learners.IntrinsicAttentionPPOLearner.IntrinsicAttentionPPOLearner'>, learner_connector=None, add_default_connectors_to_learner_pipeline=True, is_multi_agent=False, policies_to_update=['default_policy'], lr=0.0060984166342, num_total_minibatches=0, num_epochs=1, minibatch_size=1000, shuffle_batch_per_epoch=True)"], "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9485408017724, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.callbacks.callbacks.RLlibCallback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 128.00008893013, "iterations_since_restore": 13, "perf": {"cpu_util_percent": 42.81538461538461, "ram_util_percent": 81.12307692307692}}
{"timers": {"training_iteration": 10.165926499011606, "restore_env_runners": 1.2590869845524633e-05, "training_step": 10.165720022033163, "env_runner_sampling_timer": 2.4876439507491424, "learner_update_timer": 7.423293763438754, "synch_weights": 0.0017540009762721613, "restore_eval_env_runners": 4.434060096751867e-05, "evaluation_iteration": 0.13744097437104258, "synch_eval_env_connectors": 0.00018368356305669507, "synch_env_connectors": 4.703910726341643e-06}, "env_runners": {"env_reset_timer": 4.824618155773761e-05, "num_episodes_lifetime": -370000.0, "num_env_steps_sampled_lifetime": -7400000.0, "num_env_steps_sampled": 5000.0, "module_to_env_connector": {"timers": {"connectors": {"remove_single_ts_time_rank_from_batch": 1.239102548362372e-05, "get_actions": 4.217360474953298e-05, "listify_data_for_vector_env": 1.1084555832675668e-05, "tensor_to_numpy": 1.5939533568057305e-05, "un_batch_to_individual_items": 6.877041485042997e-06, "normalize_and_clip_actions": 8.391415267073549e-06}}, "connector_pipeline_timer": 0.00012410592709581562}, "module_episode_returns_mean": {"default_policy": 1.3799999999999994}, "time_between_sampling": 0.03303236822917197, "rlmodule_inference_timer": 3.384120530907879e-05, "env_step_timer": 1.4912635263821772e-05, "env_to_module_connector": {"timers": {"connectors": {"batch_individual_items": 1.3109838620034585e-05, "add_observations_from_episodes_to_batch": 3.0153087141069936e-06, "add_states_from_episodes_to_batch": 2.806761355914719e-06, "numpy_to_tensor": 1.3270771216234691e-05, "add_time_dim_to_batch_and_zero_pad": 7.635920766553413e-06}}, "connector_pipeline_timer": 6.265306663480114e-05}, "weights_seq_no": 13.0, "num_agent_steps_sampled": {"default_agent": 5000.0}, "episode_len_min": 20, "episode_len_mean": 20.0, "num_episodes": 250.0, "sample": 0.005859400421417801, "episode_duration_sec_mean": 0.005561125373933467, "episode_len_max": 20, "num_module_steps_sampled": {"default_policy": 5000.0}, "num_agent_steps_sampled_lifetime": {"default_agent": -7400000.0}, "num_module_steps_sampled_lifetime": {"default_policy": -7400000.0}, "env_to_module_sum_episodes_length_out": 10.36823839457432, "agent_episode_returns_mean": {"default_agent": 1.3799999999999994}, "episode_return_max": 10.5, "episode_return_min": -9.5, "env_to_module_sum_episodes_length_in": 10.36823839457432, "episode_return_mean": 1.3799999999999994, "num_env_steps_sampled_lifetime_throughput": 3092.9010531792796}, "__all_modules__": {"learner_connector_sum_episodes_length_in": 5000.0, "learner_connector": {"connector_pipeline_timer": 0.2123951883425059, "timers": {"connectors": {"add_one_ts_to_episodes_and_truncate": 0.009146598381518194, "add_observations_from_episodes_to_batch": 0.0009634914033601164, "add_columns_from_episodes_to_train_batch": 0.09510461939259306, "add_time_dim_to_batch_and_zero_pad": 0.08722736965156842, "add_states_from_episodes_to_batch": 0.0036198514189722097, "batch_individual_items": 0.016049046415183992, "numpy_to_tensor": 8.817291206692988e-05}}}, "learner_connector_sum_episodes_length_out": 5250.0}, "learners": {"differentiable_learners": {"intrinsic_attention_ppo_learner": {"intrinsic_reward_module": {"num_module_steps_trained_lifetime": 502740, "weights_seq_no": 84.0, "total_loss": 0.0, "num_module_steps_trained": 35910, "diff_num_grad_updates_vs_sampler_policy": 71.0, "module_train_batch_size_mean": 997.5006590853257}, "default_policy": {"module_train_batch_size_mean": 997.5006590853257, "use_intrinsic_rewards": 1.0, "num_module_steps_trained_lifetime": 502740, "policy_loss": 3.014198773598764e-05, "mean_kl_loss": 4.954480118612992e-06, "entropy": 0.6928703188896179, "weights_seq_no": 84.0, "vf_loss_unclipped": 42.84733581542969, "vf_loss": 0.3583492338657379, "total_loss": 0.2781340777873993, "vf_explained_var": -0.0013729333877563477, "num_module_steps_trained": 35910, "diff_num_grad_updates_vs_sampler_policy": 71.0}, "__all_modules__": {"num_env_steps_trained_lifetime": 2772000, "num_module_steps_trained": 71820, "num_module_steps_trained_lifetime": 1005480, "num_env_steps_trained": 198000, "num_env_steps_trained_lifetime_throughput": 47939.54069213435}}}, "intrinsic_reward_module": {"num_module_steps_trained": 5985, "curr_entropy_coeff": 0.0015431216992, "total_loss": 0.0, "num_module_steps_trained_lifetime": 83790, "gradients_default_optimizer_global_norm": 0.0, "diff_num_grad_updates_vs_sampler_policy": 1.0, "module_train_batch_size_mean": 997.7135120670981, "default_optimizer_learning_rate": 0.0002715581955, "num_trainable_parameters": 8266, "weights_seq_no": 14.0, "num_module_steps_trained_lifetime_throughput": 785.879446158195}, "__all_modules__": {"num_trainable_parameters": 24861, "num_non_trainable_parameters": 0, "num_env_steps_trained_lifetime": 462000, "num_module_steps_trained": 11970, "num_module_steps_trained_lifetime": 167580, "num_env_steps_trained": 33000, "num_env_steps_trained_lifetime_throughput": 4334.423389079535, "num_module_steps_trained_throughput": 23347673.09883909, "num_module_steps_trained_lifetime_throughput": 13021025.882309482}, "default_policy": {"vf_loss": 0.3583044409751892, "weights_seq_no": 14.0, "curr_entropy_coeff": 0.0015431216992, "vf_loss_unclipped": 42.83272171020508, "total_loss": 0.278093546628952, "vf_explained_var": -0.0001596212387084961, "num_module_steps_trained": 5985, "diff_num_grad_updates_vs_sampler_policy": 1.0, "curr_kl_coeff": 9.862300430540927e-06, "use_intrinsic_rewards": 0.0, "module_train_batch_size_mean": 997.7135120670981, "num_module_steps_trained_lifetime": 83790, "policy_loss": 2.526659045543056e-05, "num_trainable_parameters": 16595, "mean_kl_loss": 4.618468210537685e-06, "entropy": 0.6928676962852478, "num_module_steps_trained_lifetime_throughput": 785.8685522529656}, "IntrinsicAttentionMask": [[[0.09313569217920303, 0.0903216078877449, 0.09013595432043076, 0.08995068073272705, 0.0944490134716034, 0.09140531718730927, 0.09121743589639664, 0.09102994203567505, 0.0908428356051445, 0.08884702622890472, 0.08866440504789352], [0.09144832193851471, 0.09076852351427078, 0.09072311222553253, 0.09067772328853607, 0.09176027029752731, 0.09103218466043472, 0.09098664671182632, 0.09094113111495972, 0.0908956304192543, 0.09040588140487671, 0.09036065638065338], [0.09133565425872803, 0.09079797565937042, 0.09076202660799026, 0.0907260924577713, 0.09158211201429367, 0.09100661426782608, 0.09097059071063995, 0.09093457460403442, 0.09089857339859009, 0.09051080048084259, 0.09047497063875198], [0.09122306108474731, 0.09082736074924469, 0.09080088138580322, 0.09077441692352295, 0.09140422940254211, 0.09098098427057266, 0.09095446020364761, 0.09092795103788376, 0.0909014418721199, 0.09061577171087265, 0.09058935940265656], [0.09391044825315475, 0.09011292457580566, 0.08986380696296692, 0.08961538970470428, 0.09569640457630157, 0.09157058596611023, 0.09131744503974915, 0.09106500446796417, 0.09081326425075531, 0.08813920617103577, 0.08789554983377457], [0.09210260212421417, 0.09059648215770721, 0.09049636125564575, 0.09039635211229324, 0.09279829263687134, 0.0911790281534195, 0.0910782665014267, 0.09097760915756226, 0.09087707102298737, 0.08979860693216324, 0.08969936519861221], [0.09198956936597824, 0.0906262993812561, 0.09053560346364975, 0.09044499695301056, 0.09261855483055115, 0.09115384519100189, 0.09106262028217316, 0.09097148478031158, 0.09088043868541718, 0.08990324288606644, 0.08981326222419739], [0.09187661111354828, 0.09065607935190201, 0.09057480841875076, 0.09049360454082489, 0.09243910759687424, 0.09112861752510071, 0.09104692190885544, 0.09096530079841614, 0.0908837541937828, 0.09000794589519501, 0.08992725610733032], [0.09176371246576309, 0.09068579226732254, 0.090613953769207, 0.09054217487573624, 0.09225992858409882, 0.09110331535339355, 0.09103114157915115, 0.09095904231071472, 0.09088698774576187, 0.09011269360780716, 0.09004131704568863], [0.09054888039827347, 0.09100238978862762, 0.09103288501501083, 0.09106338769197464, 0.09034265577793121, 0.09082581847906113, 0.09085625410079956, 0.09088669717311859, 0.09091716259717941, 0.09124663472175598, 0.09127721190452576], [0.09043675661087036, 0.09103133529424667, 0.09107135236263275, 0.09111138433218002, 0.09016668051481247, 0.0907997339963913, 0.09083964675664902, 0.09087958186864853, 0.09091952443122864, 0.0913519486784935, 0.09139210730791092]], [[0.10061183571815491, 0.1009373813867569, 0.08909369260072708, 0.10159163177013397, 0.08967117220163345, 0.09440342336893082, 0.0947088822722435, 0.09054442495107651, 0.05746603012084961, 0.09335413575172424, 0.08761747926473618], [0.10091204196214676, 0.10124912112951279, 0.08900899440050125, 0.10192668437957764, 0.08960464596748352, 0.09449034184217453, 0.09480597823858261, 0.09050559252500534, 0.0566033199429512, 0.09340633451938629, 0.08748692274093628], [0.08869058638811111, 0.08862853050231934, 0.09105817973613739, 0.08850453794002533, 0.09093078970909119, 0.08992311358451843, 0.08986019343137741, 0.09074004739522934, 0.10013443976640701, 0.0901411697268486, 0.09138844162225723], [0.10151016712188721, 0.10187052935361862, 0.08883550018072128, 0.10259509086608887, 0.089467354118824, 0.09465979039669037, 0.09499584138393402, 0.09042356163263321, 0.05491387099027634, 0.09350624680519104, 0.08722212165594101], [0.0893571674823761, 0.08931329846382141, 0.09102420508861542, 0.08922560513019562, 0.09093485027551651, 0.09022663533687592, 0.09018232673406601, 0.09080096334218979, 0.09729911386966705, 0.09038008004426956, 0.09125571697950363], [0.09452547132968903, 0.09463626146316528, 0.09044859558343887, 0.09485823661088943, 0.09066075086593628, 0.09236732125282288, 0.09247558563947678, 0.0909799113869667, 0.07715187221765518, 0.09199371188879013, 0.08990226686000824], [0.09484222531318665, 0.09496331214904785, 0.09039570391178131, 0.09520593285560608, 0.09062665700912476, 0.09248622506856918, 0.09260429441928864, 0.09097420424222946, 0.07602144777774811, 0.09207884967327118, 0.08980117738246918], [0.09034964442253113, 0.09033358097076416, 0.09095637500286102, 0.09030146151781082, 0.09092402458190918, 0.09066697955131531, 0.09065086394548416, 0.0908755362033844, 0.0931786298751831, 0.09072278439998627, 0.09104006737470627], [0.0368131659924984, 0.03626961633563042, 0.06443841010332108, 0.03520645946264267, 0.06254956126213074, 0.049360241740942, 0.04863143712282181, 0.059819597750902176, 0.485352486371994, 0.051967233419418335, 0.06959176808595657], [0.09342248737812042, 0.09349820017814636, 0.09061715751886368, 0.09364980459213257, 0.09076409041881561, 0.0919422060251236, 0.09201671183109283, 0.09098493307828903, 0.08118121325969696, 0.09168486297130585, 0.09023828059434891], [0.08694824576377869, 0.08684048801660538, 0.09110260009765625, 0.08662537485361099, 0.09087692201137543, 0.08910039067268372, 0.08898996561765671, 0.09053946286439896, 0.10780429095029831, 0.08948351442813873, 0.09168880432844162]], [[0.09073194116353989, 0.09077946096658707, 0.09082701057195663, 0.0908745750784874, 0.09092216938734055, 0.09168320894241333, 0.0917312279343605, 0.0905991867184639, 0.09182733297348022, 0.08998838812112808, 0.09003551304340363], [0.09069619327783585, 0.09075316786766052, 0.09081017971038818, 0.09086722880601883, 0.09092430770397186, 0.09183792769908905, 0.09189562499523163, 0.09053704142570496, 0.09201111644506454, 0.08980540931224823, 0.08986182510852814], [0.09066030383110046, 0.09072673320770264, 0.09079320728778839, 0.09085973352193832, 0.09092630445957184, 0.09199275076389313, 0.0920601561665535, 0.09047478437423706, 0.09219511598348618, 0.08962265402078629, 0.08968832343816757], [0.09062426537275314, 0.09070014208555222, 0.09077607840299606, 0.09085207432508469, 0.09092813730239868, 0.09214767813682556, 0.09222482889890671, 0.09041241556406021, 0.09237931668758392, 0.08944010734558105, 0.08951498568058014], [0.09058808535337448, 0.09067339450120926, 0.0907587856054306, 0.09084425866603851, 0.09092981368303299, 0.09230270236730576, 0.09238962829113007, 0.09034992754459381, 0.09256372600793839, 0.08925778418779373, 0.08934184163808823], [0.08999353647232056, 0.09022817015647888, 0.09046342223882675, 0.09069927781820297, 0.09093574434518814, 0.09478451311588287, 0.09503163397312164, 0.08934058994054794, 0.09552782028913498, 0.08638505637645721, 0.08661027252674103], [0.08995502442121506, 0.09019897878170013, 0.09044358879327774, 0.09068886190652847, 0.09093480557203293, 0.09494124352931976, 0.09519872069358826, 0.0892762839794159, 0.09571576118469238, 0.08620647341012955, 0.08644025772809982], [0.09083119034767151, 0.09085223078727722, 0.09087326377630234, 0.09089430421590805, 0.09091535210609436, 0.09125108271837234, 0.09127221256494522, 0.09077239781618118, 0.09131448715925217, 0.09050126373767853, 0.09052222967147827], [0.08987759053707123, 0.09014015644788742, 0.0904034972190857, 0.09066759794950485, 0.09093247354030609, 0.09525500982999802, 0.09553328156471252, 0.08914735168218613, 0.09609227627515793, 0.08585000038146973, 0.08610080182552338], [0.09127539396286011, 0.09117342531681061, 0.09107157588005066, 0.09096984565258026, 0.09086821973323822, 0.08926563709974289, 0.08916591852903366, 0.09156113862991333, 0.08896681666374207, 0.09289293736219406, 0.0927891731262207], [0.09124184399843216, 0.09114944189786911, 0.09105712920427322, 0.0909649059176445, 0.09087278693914413, 0.08941864967346191, 0.0893280878663063, 0.09150076657533646, 0.08914724737405777, 0.09270651638507843, 0.09261263161897659]], [[0.09030085057020187, 0.09049086272716522, 0.08343224972486496, 0.09087207913398743, 0.08378373086452484, 0.08663488924503326, 0.09144694358110428, 0.08431374281644821, 0.12370498478412628, 0.09059363603591919, 0.08442606031894684], [0.09024001657962799, 0.0904393419623375, 0.0830489844083786, 0.09083932638168335, 0.08341627568006516, 0.08639844506978989, 0.09144260734319687, 0.08397026360034943, 0.12556995451450348, 0.09054717421531677, 0.08408768475055695], [0.09060844779014587, 0.09044292569160461, 0.09706313908100128, 0.09011280536651611, 0.09670884907245636, 0.09393443167209625, 0.08961986750364304, 0.09617983549833298, 0.0689074918627739, 0.09035366773605347, 0.09606853127479553], [0.0901089683175087, 0.09032686799764633, 0.08227904886007309, 0.09076424688100815, 0.082677461206913, 0.08591842651367188, 0.09142430871725082, 0.08327871561050415, 0.1293710172176361, 0.09044475853443146, 0.08340618759393692], [0.09067650884389877, 0.09052977710962296, 0.0963754802942276, 0.09023701399564743, 0.09606381505727768, 0.09361867606639862, 0.0897996574640274, 0.09559821337461472, 0.07115001231431961, 0.09045062959194183, 0.09550021588802338], [0.09090758860111237, 0.09091150015592575, 0.09076060354709625, 0.09091930836439133, 0.09076840430498123, 0.09083055704832077, 0.09093104302883148, 0.0907801166176796, 0.09149473905563354, 0.09091360867023468, 0.09078259021043777], [0.08988852798938751, 0.0901341363787651, 0.08111565560102463, 0.09062735736370087, 0.08155952394008636, 0.08518045395612717, 0.09137225151062012, 0.08222989737987518, 0.13525301218032837, 0.09026704728603363, 0.08237211406230927], [0.09076317399740219, 0.09064469486474991, 0.09533680230379105, 0.09040819108486176, 0.09508806467056274, 0.09313110262155533, 0.09005460143089294, 0.09471616894006729, 0.07463859766721725, 0.0905807688832283, 0.09463784843683243], [0.044778164476156235, 0.045579589903354645, 0.022967347875237465, 0.047225724905729294, 0.023796822875738144, 0.03156225010752678, 0.04980705678462982, 0.025097548961639404, 0.6377860307693481, 0.0460183210670948, 0.025381091982126236], [0.0902058556675911, 0.09041021019220352, 0.08284153044223785, 0.0908203050494194, 0.08321729302406311, 0.08626976609230042, 0.09143892675638199, 0.08378413319587708, 0.1265868991613388, 0.09052076190710068, 0.08390428125858307], [0.09077902883291245, 0.09066653251647949, 0.09511641412973404, 0.09044193476438522, 0.09488079696893692, 0.09302599728107452, 0.09010608494281769, 0.09452846646308899, 0.07539460062980652, 0.09060582518577576, 0.09445425868034363]], [[0.09226467460393906, 0.08947689831256866, 0.09395153820514679, 0.08910944312810898, 0.09356570988893509, 0.09055047482252121, 0.08588366210460663, 0.09017860889434814, 0.08999325335025787, 0.09260804951190948, 0.09241769462823868], [0.09124208241701126, 0.0905638188123703, 0.0916450023651123, 0.0904732197523117, 0.09155333042144775, 0.09082688391208649, 0.08966556936502457, 0.0907360315322876, 0.09069063514471054, 0.09132455289363861, 0.09127886593341827], [0.09285867214202881, 0.08882661163806915, 0.09532512724399567, 0.08829928189516068, 0.09475922584533691, 0.09037281572818756, 0.08371198177337646, 0.08983631432056427, 0.08956925570964813, 0.09335912019014359, 0.09308159351348877], [0.09110335260629654, 0.0907081738114357, 0.09133752435445786, 0.09065529704093933, 0.09128428250551224, 0.09086158871650696, 0.09018292278051376, 0.09080862253904343, 0.09078215807676315, 0.09115131944417953, 0.09112474322319031], [0.09272440522909164, 0.08897484093904495, 0.09501239657402039, 0.08848359435796738, 0.09448780864477158, 0.09041409939527512, 0.08420126885175705, 0.08991490304470062, 0.08966633677482605, 0.09318898618221283, 0.092931367456913], [0.09164207428693771, 0.09014347940683365, 0.09253869950771332, 0.08994434773921967, 0.09233427792787552, 0.09072311222553253, 0.08817966282367706, 0.09052270650863647, 0.09042266756296158, 0.0918252021074295, 0.0917237251996994], [0.08984404802322388, 0.09198566526174545, 0.08860286325216293, 0.09227677434682846, 0.08888325840234756, 0.09114712476730347, 0.09492653608322144, 0.09143558144569397, 0.09158014506101608, 0.08958815783262253, 0.08972980082035065], [0.09150441735982895, 0.09028883278369904, 0.092229925096035, 0.09012702107429504, 0.09206463396549225, 0.09075945615768433, 0.08869007974863052, 0.09059680253267288, 0.09051558375358582, 0.09165270626544952, 0.09157054126262665], [0.09143545478582382, 0.09036137908697128, 0.09207570552825928, 0.09021828323602676, 0.09192989021539688, 0.09077741205692291, 0.08894617855548859, 0.09063365310430527, 0.09056185930967331, 0.09156636148691177, 0.09149383008480072], [0.09238706529140472, 0.0893440693616867, 0.094232477247715, 0.08894361555576324, 0.09381011128425598, 0.09051492065191269, 0.08543470501899719, 0.0901092141866684, 0.08990704268217087, 0.09276246279478073, 0.09255434572696686], [0.0923193097114563, 0.08941767364740372, 0.09407681971788406, 0.08903548121452332, 0.09367471933364868, 0.09053466469049454, 0.08568314462900162, 0.0901477038860321, 0.08995484560728073, 0.09267695993185043, 0.0924786925315857]], [[0.09131404012441635, 0.08687344193458557, 0.08886753022670746, 0.08723942190408707, 0.08472380042076111, 0.09227881580591202, 0.08779129385948181, 0.0898064523935318, 0.11875981092453003, 0.08697210252285004, 0.08537333458662033], [0.09075602889060974, 0.09156619012355804, 0.09119648486375809, 0.09149759262800217, 0.0919761061668396, 0.09058614075183868, 0.09139478951692581, 0.09102576971054077, 0.08660221844911575, 0.0915476605296135, 0.09185096621513367], [0.09114636480808258, 0.08953356742858887, 0.0902642011642456, 0.08966846764087677, 0.08873378485441208, 0.09149006754159927, 0.08987119048833847, 0.09060457348823547, 0.10014105588197708, 0.08956997096538544, 0.08897680044174194], [0.09084410220384598, 0.09120216220617294, 0.09103898704051971, 0.09117192029953003, 0.09138265997171402, 0.09076879173517227, 0.09112656116485596, 0.09096351265907288, 0.08897966146469116, 0.09119399636983871, 0.09132760018110275], [0.09009592980146408, 0.0936238095164299, 0.09200098365545273, 0.09332104027271271, 0.09544874727725983, 0.08936931192874908, 0.09286873787641525, 0.09125900268554688, 0.07358170300722122, 0.0935419574379921, 0.09488875418901443], [0.09128163009881973, 0.08577381074428558, 0.08823869377374649, 0.08622515946626663, 0.08313234895467758, 0.09248720109462738, 0.08690664172172546, 0.08940408378839493, 0.12672622501850128, 0.08589544147253036, 0.08392874896526337], [0.09096308052539825, 0.09064559638500214, 0.09078998863697052, 0.0906723216176033, 0.09048643708229065, 0.09103015810251236, 0.09071243554353714, 0.09085693210363388, 0.09265521913766861, 0.09065280854701996, 0.09053492546081543], [0.09125229716300964, 0.08853443711996078, 0.08976151794195175, 0.08876046538352966, 0.0871991515159607, 0.0918358564376831, 0.08910060673952103, 0.09033554047346115, 0.10702070593833923, 0.08859540522098541, 0.08760400861501694], [0.06890054792165756, 0.04809431731700897, 0.056645989418029785, 0.04957468807697296, 0.04014424979686737, 0.07432559132575989, 0.051881130784749985, 0.0611061193048954, 0.45842063426971436, 0.04848962649703026, 0.04241717979311943], [0.09078048914670944, 0.0914684534072876, 0.09115462005138397, 0.09141023457050323, 0.09181618690490723, 0.09063611179590225, 0.09132298082113266, 0.09100965410470963, 0.08723849058151245, 0.09145273268222809, 0.09171005338430405], [0.09032058715820312, 0.09301645308732986, 0.09177936613559723, 0.09278604388237, 0.09440163522958755, 0.08976227790117264, 0.09244148433208466, 0.09121204912662506, 0.07734870165586472, 0.09295418113470078, 0.09397725015878677]]]}, "num_training_step_calls_per_iteration": 1, "evaluation": {"env_runners": {"module_to_env_connector": {"timers": {"connectors": {"remove_single_ts_time_rank_from_batch": 1.1842318890328627e-05, "get_actions": 3.534099049219848e-05, "normalize_and_clip_actions": 7.8185573653437e-06, "listify_data_for_vector_env": 1.0468537681833155e-05, "tensor_to_numpy": 1.4873347568770372e-05, "un_batch_to_individual_items": 6.5344860340726015e-06}}, "connector_pipeline_timer": 0.00011304257249319394}, "episode_len_max": 20, "num_agent_steps_sampled_lifetime": {"default_agent": 5600}, "num_module_steps_sampled_lifetime": {"default_policy": 5600}, "episode_return_max": 14.5, "env_reset_timer": 0.0005419786431928789, "rlmodule_inference_timer": 3.033513408542466e-05, "env_step_timer": 1.4065457659513468e-05, "env_to_module_connector": {"timers": {"connectors": {"add_states_from_episodes_to_batch": 2.6847224682244448e-06, "numpy_to_tensor": 1.1846236650555883e-05, "add_time_dim_to_batch_and_zero_pad": 7.196564003652207e-06, "add_observations_from_episodes_to_batch": 2.8630729248912144e-06, "batch_individual_items": 1.253952484615162e-05}}, "connector_pipeline_timer": 5.9619322545167603e-05}, "episode_len_min": 20, "env_to_module_sum_episodes_length_out": 10.368238394574323, "env_to_module_sum_episodes_length_in": 10.368238394574323, "num_env_steps_sampled_lifetime": 70400, "num_agent_steps_sampled": {"default_agent": 400}, "weights_seq_no": 14.0, "module_episode_returns_mean": {"default_policy": 1.65}, "episode_len_mean": 20.0, "sample": 0.1259102755635312, "agent_episode_returns_mean": {"default_agent": 1.65}, "episode_return_mean": 1.65, "episode_return_min": -12.5, "num_episodes": 20, "episode_duration_sec_mean": 0.005379509980557486, "num_module_steps_sampled": {"default_policy": 400}, "num_episodes_lifetime": 280, "num_env_steps_sampled": 400, "time_between_sampling": 9.456308958632116}, "num_healthy_workers": 1, "actor_manager_num_outstanding_async_reqs": 0, "num_remote_worker_restarts": 0}, "num_env_steps_sampled_lifetime": -7400000.0, "fault_tolerance": {"num_healthy_workers": 0, "num_remote_worker_restarts": 0}, "env_runner_group": {"actor_manager_num_outstanding_async_reqs": 0}, "done": false, "training_iteration": 14, "trial_id": "b9446_00000", "date": "2025-08-11_18-36-31", "timestamp": 1754930191, "time_this_iter_s": 9.69202733039856, "time_total_s": 137.69211626052856, "pid": 11415, "hostname": "Mac", "node_ip": "127.0.0.1", "config": {"exploration_config": {}, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 2, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "env": "Umbrella", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": false, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 0, "create_local_env_runner": true, "num_envs_per_env_runner": 1, "gym_env_vectorize_mode": "SYNC", "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "episodes_to_numpy": true, "max_requests_in_flight_per_env_runner": 1, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "merge_env_runner_states": "training_only", "broadcast_env_runner_states": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "complete_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "sampler_perf_stats_ema_coef": null, "_is_online": true, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": "auto", "num_aggregator_actors_per_learner": 0, "max_requests_in_flight_per_aggregator_actor": 3, "local_gpu_idx": 0, "max_requests_in_flight_per_learner": 3, "gamma": 1, "lr": 0.0002715581955, "grad_clip": 0.5, "grad_clip_by": "global_norm", "_train_batch_size_per_learner": 5000, "train_batch_size": 4000, "num_epochs": 1, "minibatch_size": 1000, "shuffle_batch_per_epoch": true, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "log_std_clip_param": 20.0, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "_disable_preprocessor_api": false, "_disable_action_flattening": false}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {"intrinsic_reward_coeff": 0.2795015916508}, "optimizer": {}, "_learner_class": "<class 'source.intrinsic_attention_ppo.learners.IntrinsicAttentionMetaLearner.IntrinsicAttentionMetaLearner'>", "callbacks_on_algorithm_init": null, "callbacks_on_env_runners_recreated": null, "callbacks_on_offline_eval_runners_recreated": null, "callbacks_on_checkpoint_loaded": null, "callbacks_on_environment_created": null, "callbacks_on_episode_created": null, "callbacks_on_episode_start": null, "callbacks_on_episode_step": null, "callbacks_on_episode_end": null, "callbacks_on_evaluate_start": null, "callbacks_on_evaluate_end": null, "callbacks_on_evaluate_offline_start": null, "callbacks_on_evaluate_offline_end": null, "callbacks_on_sample_end": null, "callbacks_on_train_result": null, "explore": true, "enable_rl_module_and_learner": true, "enable_env_runner_and_connector_v2": true, "_prior_exploration_config": {"type": "StochasticSampling"}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x3884998a0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "offline_data_class": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_read_batch_size": null, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "materialize_data": false, "materialize_mapped_data": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "ignore_final_observation": false, "prelearner_class": null, "prelearner_buffer_class": null, "prelearner_buffer_kwargs": {}, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_remaining_data": false, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": 1, "evaluation_duration": 20, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_auto_duration_min_env_steps_per_sample": 100, "evaluation_auto_duration_max_env_steps_per_sample": 2000, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 1, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "offline_evaluation_interval": null, "num_offline_eval_runners": 0, "offline_loss_for_module_fn": null, "offline_evaluation_duration": 1, "offline_evaluation_parallel_to_training": false, "offline_evaluation_timeout_s": 120.0, "num_cpus_per_offline_eval_runner": 1, "num_gpus_per_offline_eval_runner": 0, "custom_resources_per_offline_eval_runner": {}, "restart_failed_offline_eval_runners": true, "ignore_offline_eval_runner_failures": false, "max_num_offline_eval_runner_restarts": 1000, "offline_eval_runner_restore_timeout_s": 1800.0, "max_requests_in_flight_per_offline_eval_runner": 1, "validate_offline_eval_runners_after_construction": true, "offline_eval_runner_health_probe_timeout_s": 30.0, "offline_eval_rl_module_inference_only": false, "broadcast_offline_eval_runner_states": false, "offline_eval_batch_size_per_runner": 256, "dataset_num_iters_per_eval_runner": 1, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "log_gradients": false, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 7, "restart_failed_env_runners": true, "ignore_env_runner_failures": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30.0, "env_runner_restore_timeout_s": 1800.0, "_model_config": {}, "_rl_module_spec": "MultiRLModuleSpec(multi_rl_module_class=<class 'ray.rllib.core.rl_module.multi_rl_module.MultiRLModule'>, observation_space=None, action_space=None, inference_only=False, model_config=None, rl_module_specs={'default_policy': RLModuleSpec(module_class=<class 'source.intrinsic_attention_ppo.rl_modules.DifferentiablePPOModule.DifferentiablePPOModule'>, observation_space=None, action_space=None, inference_only=False, learner_only=False, model_config={'vf_share_layers': True, 'embedding_dim': 62, 'max_seq_len': 11, 'policy_head_hidden_sizes': [32], 'value_head_hidden_sizes': [101], 'embedding_hidden_sizes': [121]}, catalog_class=None, load_state_path=None, model_config_dict=None), 'intrinsic_reward_module': RLModuleSpec(module_class=<class 'source.intrinsic_attention_ppo.rl_modules.IntrinsicAttentionModule.IntrinsicAttentionModule'>, observation_space=None, action_space=None, inference_only=False, learner_only=True, model_config={'intrinsic_reward_network': {'encoder_hidden_sizes': [], 'encoding_dim': 1, 'num_heads': 1, 'head_hidden_sizes': None, 'layers': [{'type': 'attention'}]}, 'extrinsic_value_hidden_layers': [127, 60], 'vf_share_layers': True, 'max_seq_len': 11}, catalog_class=None, load_state_path=None, model_config_dict=None)}, load_state_path=None, modules_to_load=None, module_specs={'default_policy': RLModuleSpec(module_class=<class 'source.intrinsic_attention_ppo.rl_modules.DifferentiablePPOModule.DifferentiablePPOModule'>, observation_space=None, action_space=None, inference_only=False, learner_only=False, model_config={'vf_share_layers': True, 'embedding_dim': 62, 'max_seq_len': 11, 'policy_head_hidden_sizes': [32], 'value_head_hidden_sizes': [101], 'embedding_hidden_sizes': [121]}, catalog_class=None, load_state_path=None, model_config_dict=None), 'intrinsic_reward_module': RLModuleSpec(module_class=<class 'source.intrinsic_attention_ppo.rl_modules.IntrinsicAttentionModule.IntrinsicAttentionModule'>, observation_space=None, action_space=None, inference_only=False, learner_only=True, model_config={'intrinsic_reward_network': {'encoder_hidden_sizes': [], 'encoding_dim': 1, 'num_heads': 1, 'head_hidden_sizes': None, 'layers': [{'type': 'attention'}]}, 'extrinsic_value_hidden_layers': [127, 60], 'vf_share_layers': True, 'max_seq_len': 11}, catalog_class=None, load_state_path=None, model_config_dict=None)})", "algorithm_config_overrides_per_module": {"intrinsic_reward_module": {"lr": 0.0002715581955}}, "_per_module_overrides": {}, "_validate_config": true, "_use_msgpack_checkpoints": false, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "env_task_fn": -1, "enable_connectors": -1, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.161583927863, "kl_target": 0.0201019014258, "vf_loss_coeff": 0.7790510010087, "entropy_coeff": 0.0015431216992, "clip_param": 0.2459212356676, "vf_clip_param": 0.3769744131561, "entropy_coeff_schedule": null, "lr_schedule": null, "sgd_minibatch_size": -1, "vf_share_layers": -1, "differentiable_learner_configs": ["DifferentiableLearnerConfig(learner_class=<class 'source.intrinsic_attention_ppo.learners.IntrinsicAttentionPPOLearner.IntrinsicAttentionPPOLearner'>, learner_connector=None, add_default_connectors_to_learner_pipeline=True, is_multi_agent=False, policies_to_update=['default_policy'], lr=0.0060984166342, num_total_minibatches=0, num_epochs=1, minibatch_size=1000, shuffle_batch_per_epoch=True)"], "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9485408017724, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.callbacks.callbacks.RLlibCallback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 137.69211626052856, "iterations_since_restore": 14, "perf": {"cpu_util_percent": 46.25714285714286, "ram_util_percent": 81.67142857142858}}
{"timers": {"training_iteration": 10.153928626521182, "restore_env_runners": 1.2577460257470062e-05, "training_step": 10.153721805982196, "env_runner_sampling_timer": 2.4783085333216475, "learner_update_timer": 7.421345111223522, "synch_weights": 0.0017449134662604413, "restore_eval_env_runners": 4.437094478171175e-05, "evaluation_iteration": 0.13731867920687935, "synch_eval_env_connectors": 0.0001840342272026107, "synch_env_connectors": 4.697701964902588e-06}, "env_runners": {"env_reset_timer": 4.690773625221686e-05, "num_episodes_lifetime": -400875.0, "num_env_steps_sampled_lifetime": -8017500.0, "num_env_steps_sampled": 5000.0, "module_to_env_connector": {"timers": {"connectors": {"remove_single_ts_time_rank_from_batch": 1.1966364020859836e-05, "get_actions": 3.9453955062149175e-05, "listify_data_for_vector_env": 1.0665820819786838e-05, "tensor_to_numpy": 1.534725263785999e-05, "un_batch_to_individual_items": 6.581053384753057e-06, "normalize_and_clip_actions": 8.092490308291965e-06}}, "connector_pipeline_timer": 0.00011858485951551347}, "module_episode_returns_mean": {"default_policy": 2.0200000000000005}, "time_between_sampling": 0.03287479100419486, "rlmodule_inference_timer": 3.235034364379141e-05, "env_step_timer": 1.4114847793028015e-05, "env_to_module_connector": {"timers": {"connectors": {"batch_individual_items": 1.2603010878740235e-05, "add_observations_from_episodes_to_batch": 2.909715925133366e-06, "add_states_from_episodes_to_batch": 2.697279341946513e-06, "numpy_to_tensor": 1.2632796376327102e-05, "add_time_dim_to_batch_and_zero_pad": 7.28428130741942e-06}}, "connector_pipeline_timer": 6.022722820027322e-05}, "weights_seq_no": 14.0, "num_agent_steps_sampled": {"default_agent": 5000.0}, "episode_len_min": 20, "episode_len_mean": 20.0, "num_episodes": 250.0, "sample": 0.005797597514841578, "episode_duration_sec_mean": 0.005313212323468178, "episode_len_max": 20, "num_module_steps_sampled": {"default_policy": 5000.0}, "num_agent_steps_sampled_lifetime": {"default_agent": -8017500.0}, "num_module_steps_sampled_lifetime": {"default_policy": -8017500.0}, "env_to_module_sum_episodes_length_out": 10.36823839457432, "agent_episode_returns_mean": {"default_agent": 2.0200000000000005}, "episode_return_max": 10.5, "episode_return_min": -9.5, "env_to_module_sum_episodes_length_in": 10.36823839457432, "episode_return_mean": 2.0200000000000005, "num_env_steps_sampled_lifetime_throughput": 3204.68767191033}, "__all_modules__": {"learner_connector_sum_episodes_length_in": 5000.0, "learner_connector": {"connector_pipeline_timer": 0.2116150639593217, "timers": {"connectors": {"add_one_ts_to_episodes_and_truncate": 0.009145529067396303, "add_observations_from_episodes_to_batch": 0.0009620794087496483, "add_columns_from_episodes_to_train_batch": 0.09456338319923203, "add_time_dim_to_batch_and_zero_pad": 0.08711208178542866, "add_states_from_episodes_to_batch": 0.0036197499852292673, "batch_individual_items": 0.015928988450986628, "numpy_to_tensor": 8.808868261597635e-05}}}, "learner_connector_sum_episodes_length_out": 5250.0}, "learners": {"differentiable_learners": {"intrinsic_attention_ppo_learner": {"intrinsic_reward_module": {"num_module_steps_trained_lifetime": 538650, "weights_seq_no": 90.0, "total_loss": 0.0, "num_module_steps_trained": 35910, "diff_num_grad_updates_vs_sampler_policy": 76.0, "module_train_batch_size_mean": 997.4996962148737}, "default_policy": {"module_train_batch_size_mean": 997.4996962148737, "use_intrinsic_rewards": 1.0, "num_module_steps_trained_lifetime": 538650, "policy_loss": -3.0386434445972554e-05, "mean_kl_loss": 9.257227247871924e-06, "entropy": 0.6929641366004944, "weights_seq_no": 90.0, "vf_loss_unclipped": 43.65298843383789, "vf_loss": 0.35834723711013794, "total_loss": 0.2780725359916687, "vf_explained_var": -0.0013585090637207031, "num_module_steps_trained": 35910, "diff_num_grad_updates_vs_sampler_policy": 76.0}, "__all_modules__": {"num_env_steps_trained_lifetime": 2970000, "num_module_steps_trained": 71820, "num_module_steps_trained_lifetime": 1077300, "num_env_steps_trained": 198000, "num_env_steps_trained_lifetime_throughput": 47222.96133028974}}}, "intrinsic_reward_module": {"num_module_steps_trained": 5985, "curr_entropy_coeff": 0.0015431216992, "total_loss": 0.0, "num_module_steps_trained_lifetime": 89775, "gradients_default_optimizer_global_norm": 0.0, "diff_num_grad_updates_vs_sampler_policy": 1.0, "module_train_batch_size_mean": 997.7008703380301, "default_optimizer_learning_rate": 0.0002715581955, "num_trainable_parameters": 8266, "weights_seq_no": 15.0, "num_module_steps_trained_lifetime_throughput": 783.267849395446}, "__all_modules__": {"num_trainable_parameters": 24861, "num_non_trainable_parameters": 0, "num_env_steps_trained_lifetime": 495000, "num_module_steps_trained": 11970, "num_module_steps_trained_lifetime": 179550, "num_env_steps_trained": 33000, "num_env_steps_trained_lifetime_throughput": 4319.974476013698, "num_module_steps_trained_throughput": 22782562.171269227, "num_module_steps_trained_lifetime_throughput": 12993400.781405907}, "default_policy": {"vf_loss": 0.35830456018447876, "weights_seq_no": 15.0, "curr_entropy_coeff": 0.0015431216992, "vf_loss_unclipped": 43.58110046386719, "total_loss": 0.27803707122802734, "vf_explained_var": -0.0002714395523071289, "num_module_steps_trained": 5985, "diff_num_grad_updates_vs_sampler_policy": 1.0, "curr_kl_coeff": 4.931150215270463e-06, "use_intrinsic_rewards": 0.0, "module_train_batch_size_mean": 997.7008703380301, "num_module_steps_trained_lifetime": 89775, "policy_loss": -3.114540595561266e-05, "num_trainable_parameters": 16595, "mean_kl_loss": 9.366351150674745e-06, "entropy": 0.6929646730422974, "num_module_steps_trained_lifetime_throughput": 783.2576026887475}, "IntrinsicAttentionMask": [[[0.09310676902532578, 0.09500430524349213, 0.09010795503854752, 0.08992274105548859, 0.0944196805357933, 0.09137692302465439, 0.08666752278804779, 0.08648937195539474, 0.09081462025642395, 0.09345327317714691, 0.0886368602514267], [0.09418736398220062, 0.09707675129175186, 0.08968063443899155, 0.08940470963716507, 0.09618344157934189, 0.09157872945070267, 0.0846014991402626, 0.08434119075536728, 0.0907360166311264, 0.09471283107995987, 0.08749682456254959], [0.09133461117744446, 0.09168991446495056, 0.0907609835267067, 0.09072504937648773, 0.0915810614824295, 0.09100557118654251, 0.09008356928825378, 0.09004790335893631, 0.09089753031730652, 0.09139992296695709, 0.09047392755746841], [0.09122249484062195, 0.09148364514112473, 0.09080033004283905, 0.09077385812997818, 0.09140367060899734, 0.0909804254770279, 0.09030086547136307, 0.09027454257011414, 0.09090088307857513, 0.09127052873373032, 0.09058880060911179], [0.09385772794485092, 0.09644028544425964, 0.08981335908174515, 0.08956507593393326, 0.09564268589019775, 0.09151918441057205, 0.08523041009902954, 0.08499480038881302, 0.09076227247714996, 0.09432798624038696, 0.08784620463848114], [0.0920943096280098, 0.0930982455611229, 0.09048821032047272, 0.09038820117712021, 0.09278993308544159, 0.09117081761360168, 0.0886148065328598, 0.08851687610149384, 0.09086888283491135, 0.09227833896875381, 0.08969128876924515], [0.08920006453990936, 0.08782890439033508, 0.09147071838378906, 0.09161534905433655, 0.0882461667060852, 0.09049379825592041, 0.09424611926078796, 0.09439513087272644, 0.0909237191081047, 0.08894599974155426, 0.09263414144515991], [0.08908646553754807, 0.08762728422880173, 0.09150616079568863, 0.09166041016578674, 0.08807117491960526, 0.09046462923288345, 0.0944691002368927, 0.09462834894657135, 0.09092288464307785, 0.08881598711013794, 0.09274747967720032], [0.09175947308540344, 0.09247524291276932, 0.09060975909233093, 0.09053798764944077, 0.09225565940141678, 0.0910990983247757, 0.08926137536764145, 0.08919066935777664, 0.09088277816772461, 0.0918908417224884, 0.09003715217113495], [0.09330642223358154, 0.09538419544696808, 0.09003069251775742, 0.08982869982719421, 0.09474363178014755, 0.091415636241436, 0.08628486096858978, 0.08609127998352051, 0.09080171585083008, 0.09368555247783661, 0.08842738717794418], [0.0904354602098465, 0.09004659205675125, 0.09107004851102829, 0.09111008048057556, 0.0901653915643692, 0.09079843759536743, 0.09183043986558914, 0.09187080711126328, 0.09091822803020477, 0.09036373347043991, 0.09139079600572586]], [[0.09934884309768677, 0.09202157706022263, 0.08797527849674225, 0.09261803328990936, 0.08854550868272781, 0.10096655786037445, 0.10129325091838837, 0.08940780162811279, 0.06146116554737091, 0.0998443216085434, 0.08651760220527649], [0.09294535219669342, 0.09129873663187027, 0.09034590423107147, 0.0914364606142044, 0.0904821902513504, 0.09329627454280853, 0.09336661547422409, 0.09068701416254044, 0.08309374004602432, 0.09305329620838165, 0.0899944081902504], [0.08898031711578369, 0.09046982228755951, 0.09135564416646957, 0.09034325182437897, 0.09122783690690994, 0.08866943418979645, 0.08860739320516586, 0.09103646874427795, 0.0987384244799614, 0.08888445049524307, 0.09168698638677597], [0.09350227564573288, 0.09139196574687958, 0.09017560631036758, 0.09156807512044907, 0.09034936875104904, 0.09395336359739304, 0.09404384344816208, 0.09061064571142197, 0.08103606104850769, 0.09364098310470581, 0.08972779661417007], [0.0895596295595169, 0.09060889482498169, 0.09123045206069946, 0.09051993489265442, 0.09114088863134384, 0.089339978992939, 0.0892961174249649, 0.09100670367479324, 0.09634298086166382, 0.08949191868305206, 0.09146248549222946], [0.10064440220594406, 0.09207428246736526, 0.08738818764686584, 0.09276790916919708, 0.08804651349782944, 0.10255060344934464, 0.10293615609407425, 0.08904331177473068, 0.05761246010661125, 0.10122771561145782, 0.08570846170186996], [0.10090131312608719, 0.0920809730887413, 0.08726758509874344, 0.0927940309047699, 0.08794337511062622, 0.10286608338356018, 0.10326360166072845, 0.08896687626838684, 0.056869760155677795, 0.1015024408698082, 0.08554396033287048], [0.09042254090309143, 0.09080470353364944, 0.09102975577116013, 0.09077241271734238, 0.09099739044904709, 0.09034217894077301, 0.09032610803842545, 0.09094885736703873, 0.09284483641386032, 0.09039777517318726, 0.09111351519823074], [0.0525243766605854, 0.07030566781759262, 0.08342821896076202, 0.06859804689884186, 0.08140187710523605, 0.04939288645982742, 0.0487893708050251, 0.07845426350831985, 0.3266606330871582, 0.05153927206993103, 0.08890542387962341], [0.0997498482465744, 0.0920412689447403, 0.08779733628034592, 0.09266766160726547, 0.08839484304189682, 0.10145565122365952, 0.10180029273033142, 0.08929874002933502, 0.0602513886988163, 0.10027216374874115, 0.08627081662416458], [0.08746709674596786, 0.09007780253887177, 0.0916462391614914, 0.0898546651005745, 0.09141921997070312, 0.0869264304637909, 0.08681870251893997, 0.09107974171638489, 0.1051740050315857, 0.08730021119117737, 0.09223594516515732]], [[0.09105167537927628, 0.0899280235171318, 0.09114707261323929, 0.0900222435593605, 0.09006939083337784, 0.09082329273223877, 0.09205447137355804, 0.09091844409704208, 0.09215091913938522, 0.09148174524307251, 0.09035278856754303], [0.09032653272151947, 0.09460905194282532, 0.08997438102960587, 0.094240203499794, 0.09405631572008133, 0.09117672592401505, 0.08671019971370697, 0.09082125872373581, 0.08637214452028275, 0.0887526199221611, 0.09296051412820816], [0.09110692143440247, 0.08953797072172165, 0.09124048054218292, 0.08966922760009766, 0.08973493427038193, 0.09078740328550339, 0.09251367300748825, 0.09092050045728683, 0.09264929592609406, 0.09170948714017868, 0.09013015031814575], [0.09039261192083359, 0.0942104384303093, 0.09007782489061356, 0.09388235211372375, 0.09371873736381531, 0.09115206450223923, 0.0871536061167717, 0.09083463251590729, 0.08685009926557541, 0.0889846608042717, 0.09274301677942276], [0.09042530506849289, 0.09401138126850128, 0.09012921899557114, 0.09370356053113937, 0.09355001896619797, 0.09113936871290207, 0.08737580478191376, 0.09084094315767288, 0.08708970993757248, 0.08910054713487625, 0.09263408184051514], [0.09091538190841675, 0.09086651355028152, 0.09091950953006744, 0.09087063372135162, 0.09087269008159637, 0.09090550243854523, 0.09095851331949234, 0.09090962260961533, 0.09096264094114304, 0.09093394130468369, 0.09088505804538727], [0.09158327430486679, 0.08588576316833496, 0.09208068996667862, 0.08635222911834717, 0.08658640831708908, 0.09040126949548721, 0.0969218909740448, 0.0908922553062439, 0.09744829684495926, 0.0938429906964302, 0.08800489455461502], [0.09097285568714142, 0.0904746726155281, 0.09101498872041702, 0.0905165821313858, 0.09053754061460495, 0.09087187796831131, 0.09141456335783005, 0.09091397374868393, 0.09145690500736237, 0.09116262197494507, 0.09066340327262878], [0.09162870049476624, 0.08550376445055008, 0.09216484427452087, 0.08600407093763351, 0.08625532686710358, 0.0903555303812027, 0.09739458560943604, 0.09088423103094101, 0.09796446561813354, 0.09406618028879166, 0.08777831494808197], [0.09129295498132706, 0.08817870914936066, 0.09156055748462677, 0.08843717724084854, 0.08856669813394547, 0.09065435826778412, 0.09413115680217743, 0.090920090675354, 0.09440707415342331, 0.09250333905220032, 0.08934780210256577], [0.09061677753925323, 0.09282079339027405, 0.09043332189321518, 0.09263288229703903, 0.09253906458616257, 0.09105826914310455, 0.08871612697839737, 0.09087391942739487, 0.08853652328252792, 0.08979415893554688, 0.09197816252708435]], [[0.09178981184959412, 0.09174584597349167, 0.09127244353294373, 0.09165796637535095, 0.0922713503241539, 0.09049208462238312, 0.09044873714447021, 0.0910540372133255, 0.08543471992015839, 0.09172210842370987, 0.09211085736751556], [0.09160032868385315, 0.09156601130962372, 0.09119630604982376, 0.09149741381406784, 0.09197592735290527, 0.09058596938848495, 0.09055202454328537, 0.09102559834718704, 0.08660205453634262, 0.09154748171567917, 0.09185078740119934], [0.08946550637483597, 0.08953288197517395, 0.0902635008096695, 0.08966778218746185, 0.08873310685157776, 0.09148936718702316, 0.09155827015638351, 0.09060388058423996, 0.1001402884721756, 0.08956928551197052, 0.08897611498832703], [0.09121726453304291, 0.09120213240385056, 0.09103895723819733, 0.09117189049720764, 0.09138263016939163, 0.09076876938343048, 0.0907537117600441, 0.09096349030733109, 0.08897963911294937, 0.09119396656751633, 0.09132757037878036], [0.09377221763134003, 0.09362047910690308, 0.09199771285057068, 0.09331772476434708, 0.09544535726308823, 0.0893661305308342, 0.0892215147614479, 0.09125575423240662, 0.07357906550168991, 0.09353863447904587, 0.09488538652658463], [0.08554123342037201, 0.08576600253582001, 0.0882306694984436, 0.08621731400489807, 0.08312477916479111, 0.09247878938913345, 0.09272179007530212, 0.08939594775438309, 0.12671473622322083, 0.08588762581348419, 0.08392111212015152], [0.08530755341053009, 0.08554063737392426, 0.08809809386730194, 0.086008720099926, 0.08280321955680847, 0.0925128161907196, 0.09276558458805084, 0.0893082469701767, 0.12836018204689026, 0.08566677570343018, 0.08362819254398346], [0.08841971307992935, 0.08853251487016678, 0.08975956588983536, 0.08875854313373566, 0.08719725906848907, 0.09183385968208313, 0.09195101261138916, 0.09033358097076416, 0.10701838880777359, 0.088593490421772, 0.08760210871696472], [0.04727381840348244, 0.04799586161971092, 0.05653002858161926, 0.04947321116924286, 0.040062058717012405, 0.0741734579205513, 0.07530634850263596, 0.06098103150725365, 0.4574835002422333, 0.04839036241173744, 0.04233033210039139], [0.09149745106697083, 0.09146833419799805, 0.09115450829267502, 0.09141011536121368, 0.09181606769561768, 0.0906360000371933, 0.09060714393854141, 0.09100953489542007, 0.0872383788228035, 0.09145261347293854, 0.0917099341750145], [0.09312993288040161, 0.09301451593637466, 0.09177745133638382, 0.0927841067314148, 0.09439966827630997, 0.08976040780544281, 0.08964917063713074, 0.09121014922857285, 0.07734707742929459, 0.09295224398374557, 0.09397529065608978]], [[0.09073144942522049, 0.08961175382137299, 0.09082651138305664, 0.0908740758895874, 0.09092167019844055, 0.09168270230293274, 0.09055126458406448, 0.09177876263856888, 0.09182682633399963, 0.09115999937057495, 0.09003502130508423], [0.09153133630752563, 0.0958709791302681, 0.09117449074983597, 0.09099658578634262, 0.09081903100013733, 0.08803854882717133, 0.09221259504556656, 0.08769531548023224, 0.08752420544624329, 0.08993643522262573, 0.09420045465230942], [0.09065931290388107, 0.08909807354211807, 0.090792216360569, 0.09085874259471893, 0.09092531353235245, 0.09199175238609314, 0.09040755778551102, 0.09212660789489746, 0.09219411015510559, 0.09125891327857971, 0.08968734741210938], [0.09062298387289047, 0.08884205669164658, 0.09077479690313339, 0.09085079282522202, 0.09092685580253601, 0.0921463817358017, 0.09033551067113876, 0.09230073541402817, 0.09237801283597946, 0.0913081243634224, 0.08951373398303986], [0.09058647602796555, 0.08858658373355865, 0.09075716882944107, 0.09084264189004898, 0.09092818945646286, 0.09230105578899384, 0.09026331454515457, 0.09247498959302902, 0.09256207942962646, 0.09135715663433075, 0.08934025466442108], [0.08998148888349533, 0.08459287881851196, 0.09045130759477615, 0.09068713337182999, 0.09092357754707336, 0.09477182477712631, 0.08909633755683899, 0.09526665508747101, 0.09551503509283066, 0.09211505949497223, 0.08659867942333221], [0.09086637943983078, 0.0905928835272789, 0.09088948369026184, 0.09090103954076767, 0.0909125879406929, 0.09109673649072647, 0.09082254767417908, 0.09111990034580231, 0.09113147854804993, 0.09097038954496384, 0.09069657325744629], [0.0899023562669754, 0.0841008648276329, 0.0904095247387886, 0.09066417068243027, 0.09091954678297043, 0.09508325904607773, 0.08894743025302887, 0.09561964124441147, 0.09588897228240967, 0.09220721572637558, 0.08625698834657669], [0.08986254036426544, 0.08385566622018814, 0.09038835018873215, 0.09065240621566772, 0.09091723710298538, 0.0952390506863594, 0.08887279033660889, 0.09579632431268692, 0.09607618302106857, 0.09225303679704666, 0.08608637750148773], [0.09040126949548721, 0.08731744438409805, 0.09066624939441681, 0.09079903364181519, 0.09093201160430908, 0.09307543188333511, 0.08990037441253662, 0.09334825724363327, 0.09348496794700623, 0.09159982949495316, 0.08847511559724808], [0.09123992919921875, 0.0934591069817543, 0.09105521440505981, 0.09096299856901169, 0.09087087213993073, 0.08941677212715149, 0.09159160405397415, 0.08923574537038803, 0.08914537727832794, 0.09041165560483932, 0.0926106795668602]], [[0.09088946878910065, 0.08646951615810394, 0.08397608995437622, 0.09146443009376526, 0.0888269767165184, 0.09184975922107697, 0.08738310635089874, 0.0893888920545578, 0.1182076632976532, 0.0865677148103714, 0.08497638255357742], [0.09083259105682373, 0.09164344519376755, 0.09212271869182587, 0.09073054045438766, 0.09120504558086395, 0.09066256880760193, 0.09147189557552338, 0.09110257029533386, 0.08667528629302979, 0.0916249006986618, 0.09192845970392227], [0.09033627063035965, 0.09433971345424652, 0.09677158296108246, 0.08984211832284927, 0.09215804934501648, 0.08951418101787567, 0.09348119795322418, 0.09165392816066742, 0.0718763917684555, 0.09424661099910736, 0.09577996283769608], [0.0908152237534523, 0.08575928956270218, 0.08292393386363983, 0.09147564321756363, 0.08845128864049911, 0.09191859513521194, 0.08680123835802078, 0.08909451961517334, 0.1228291392326355, 0.08587121963500977, 0.08405990898609161], [0.09099885821342468, 0.08894697576761246, 0.08776428550481796, 0.09126175194978714, 0.09004828333854675, 0.0914374440908432, 0.08937567472457886, 0.09030843526124954, 0.1026240661740303, 0.08899318426847458, 0.08824100345373154], [0.09075460582971573, 0.08527857810258865, 0.08221971988677979, 0.09147188812494278, 0.08819087594747543, 0.09195321798324585, 0.08640486747026443, 0.08888789266347885, 0.12599459290504456, 0.08539950847625732, 0.08344417810440063], [0.09093298017978668, 0.09061560034751892, 0.09042982757091522, 0.09097320586442947, 0.09078671038150787, 0.0910000428557396, 0.09068241715431213, 0.09082686901092529, 0.09262456744909286, 0.09062281250953674, 0.0905049592256546], [0.09099309146404266, 0.08828295022249222, 0.08673002570867538, 0.09134179353713989, 0.08973506093025208, 0.09157498925924301, 0.08884751796722412, 0.0900789350271225, 0.10671671479940414, 0.08834375441074371, 0.08735516667366028], [0.06734637916088104, 0.04700944572687149, 0.038066964596509933, 0.0704796239733696, 0.057072483003139496, 0.0726490318775177, 0.05071084201335907, 0.0597277469933033, 0.44808125495910645, 0.04739583656191826, 0.04146035760641098], [0.0908455178141594, 0.09153397381305695, 0.09194047749042511, 0.0907588079571724, 0.09116186201572418, 0.09070104360580444, 0.09138840436935425, 0.09107484668493271, 0.08730097860097885, 0.09151824563741684, 0.09177575260400772], [0.09057363122701645, 0.09327705204486847, 0.0949011966586113, 0.09023728966712952, 0.0918085128068924, 0.09001375734806061, 0.09270047396421432, 0.09146758168935776, 0.07756539434194565, 0.09321460872888565, 0.09424053877592087]]]}, "num_training_step_calls_per_iteration": 1, "evaluation": {"env_runners": {"module_to_env_connector": {"timers": {"connectors": {"remove_single_ts_time_rank_from_batch": 1.186257884615451e-05, "get_actions": 3.490976594594689e-05, "normalize_and_clip_actions": 7.814997443633007e-06, "listify_data_for_vector_env": 1.0414027375557752e-05, "tensor_to_numpy": 1.468734034724756e-05, "un_batch_to_individual_items": 6.4899569236420715e-06}}, "connector_pipeline_timer": 0.00011249436919342969}, "episode_len_max": 20, "num_agent_steps_sampled_lifetime": {"default_agent": 6000}, "num_module_steps_sampled_lifetime": {"default_policy": 6000}, "episode_return_max": 14.5, "env_reset_timer": 0.0005374455177614999, "rlmodule_inference_timer": 3.0556138544549595e-05, "env_step_timer": 1.3842214388045195e-05, "env_to_module_connector": {"timers": {"connectors": {"add_states_from_episodes_to_batch": 2.6774869280683863e-06, "numpy_to_tensor": 1.1787719760841654e-05, "add_time_dim_to_batch_and_zero_pad": 7.106589636511407e-06, "add_observations_from_episodes_to_batch": 2.8189902286499154e-06, "batch_individual_items": 1.2434199566528813e-05}}, "connector_pipeline_timer": 5.930937357058099e-05}, "episode_len_min": 20, "env_to_module_sum_episodes_length_out": 10.368238394574323, "env_to_module_sum_episodes_length_in": 10.368238394574323, "num_env_steps_sampled_lifetime": 75400, "num_agent_steps_sampled": {"default_agent": 400}, "weights_seq_no": 15.0, "module_episode_returns_mean": {"default_policy": 1.45}, "episode_len_mean": 20.0, "sample": 0.12577539322733816, "agent_episode_returns_mean": {"default_agent": 1.45}, "episode_return_mean": 1.45, "episode_return_min": -12.5, "num_episodes": 20, "episode_duration_sec_mean": 0.005386709133163094, "num_module_steps_sampled": {"default_policy": 400}, "num_episodes_lifetime": 300, "num_env_steps_sampled": 400, "time_between_sampling": 9.451733791545216}, "num_healthy_workers": 1, "actor_manager_num_outstanding_async_reqs": 0, "num_remote_worker_restarts": 0}, "num_env_steps_sampled_lifetime": -8017500.0, "fault_tolerance": {"num_healthy_workers": 0, "num_remote_worker_restarts": 0}, "env_runner_group": {"actor_manager_num_outstanding_async_reqs": 0}, "done": false, "training_iteration": 15, "trial_id": "b9446_00000", "date": "2025-08-11_18-36-40", "timestamp": 1754930200, "time_this_iter_s": 9.08725118637085, "time_total_s": 146.7793674468994, "pid": 11415, "hostname": "Mac", "node_ip": "127.0.0.1", "config": {"exploration_config": {}, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 2, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "env": "Umbrella", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": false, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 0, "create_local_env_runner": true, "num_envs_per_env_runner": 1, "gym_env_vectorize_mode": "SYNC", "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "episodes_to_numpy": true, "max_requests_in_flight_per_env_runner": 1, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "merge_env_runner_states": "training_only", "broadcast_env_runner_states": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "complete_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "sampler_perf_stats_ema_coef": null, "_is_online": true, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": "auto", "num_aggregator_actors_per_learner": 0, "max_requests_in_flight_per_aggregator_actor": 3, "local_gpu_idx": 0, "max_requests_in_flight_per_learner": 3, "gamma": 1, "lr": 0.0002715581955, "grad_clip": 0.5, "grad_clip_by": "global_norm", "_train_batch_size_per_learner": 5000, "train_batch_size": 4000, "num_epochs": 1, "minibatch_size": 1000, "shuffle_batch_per_epoch": true, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "log_std_clip_param": 20.0, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "_disable_preprocessor_api": false, "_disable_action_flattening": false}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {"intrinsic_reward_coeff": 0.2795015916508}, "optimizer": {}, "_learner_class": "<class 'source.intrinsic_attention_ppo.learners.IntrinsicAttentionMetaLearner.IntrinsicAttentionMetaLearner'>", "callbacks_on_algorithm_init": null, "callbacks_on_env_runners_recreated": null, "callbacks_on_offline_eval_runners_recreated": null, "callbacks_on_checkpoint_loaded": null, "callbacks_on_environment_created": null, "callbacks_on_episode_created": null, "callbacks_on_episode_start": null, "callbacks_on_episode_step": null, "callbacks_on_episode_end": null, "callbacks_on_evaluate_start": null, "callbacks_on_evaluate_end": null, "callbacks_on_evaluate_offline_start": null, "callbacks_on_evaluate_offline_end": null, "callbacks_on_sample_end": null, "callbacks_on_train_result": null, "explore": true, "enable_rl_module_and_learner": true, "enable_env_runner_and_connector_v2": true, "_prior_exploration_config": {"type": "StochasticSampling"}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x3884998a0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "offline_data_class": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_read_batch_size": null, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "materialize_data": false, "materialize_mapped_data": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "ignore_final_observation": false, "prelearner_class": null, "prelearner_buffer_class": null, "prelearner_buffer_kwargs": {}, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_remaining_data": false, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": 1, "evaluation_duration": 20, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_auto_duration_min_env_steps_per_sample": 100, "evaluation_auto_duration_max_env_steps_per_sample": 2000, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 1, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "offline_evaluation_interval": null, "num_offline_eval_runners": 0, "offline_loss_for_module_fn": null, "offline_evaluation_duration": 1, "offline_evaluation_parallel_to_training": false, "offline_evaluation_timeout_s": 120.0, "num_cpus_per_offline_eval_runner": 1, "num_gpus_per_offline_eval_runner": 0, "custom_resources_per_offline_eval_runner": {}, "restart_failed_offline_eval_runners": true, "ignore_offline_eval_runner_failures": false, "max_num_offline_eval_runner_restarts": 1000, "offline_eval_runner_restore_timeout_s": 1800.0, "max_requests_in_flight_per_offline_eval_runner": 1, "validate_offline_eval_runners_after_construction": true, "offline_eval_runner_health_probe_timeout_s": 30.0, "offline_eval_rl_module_inference_only": false, "broadcast_offline_eval_runner_states": false, "offline_eval_batch_size_per_runner": 256, "dataset_num_iters_per_eval_runner": 1, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "log_gradients": false, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 7, "restart_failed_env_runners": true, "ignore_env_runner_failures": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30.0, "env_runner_restore_timeout_s": 1800.0, "_model_config": {}, "_rl_module_spec": "MultiRLModuleSpec(multi_rl_module_class=<class 'ray.rllib.core.rl_module.multi_rl_module.MultiRLModule'>, observation_space=None, action_space=None, inference_only=False, model_config=None, rl_module_specs={'default_policy': RLModuleSpec(module_class=<class 'source.intrinsic_attention_ppo.rl_modules.DifferentiablePPOModule.DifferentiablePPOModule'>, observation_space=None, action_space=None, inference_only=False, learner_only=False, model_config={'vf_share_layers': True, 'embedding_dim': 62, 'max_seq_len': 11, 'policy_head_hidden_sizes': [32], 'value_head_hidden_sizes': [101], 'embedding_hidden_sizes': [121]}, catalog_class=None, load_state_path=None, model_config_dict=None), 'intrinsic_reward_module': RLModuleSpec(module_class=<class 'source.intrinsic_attention_ppo.rl_modules.IntrinsicAttentionModule.IntrinsicAttentionModule'>, observation_space=None, action_space=None, inference_only=False, learner_only=True, model_config={'intrinsic_reward_network': {'encoder_hidden_sizes': [], 'encoding_dim': 1, 'num_heads': 1, 'head_hidden_sizes': None, 'layers': [{'type': 'attention'}]}, 'extrinsic_value_hidden_layers': [127, 60], 'vf_share_layers': True, 'max_seq_len': 11}, catalog_class=None, load_state_path=None, model_config_dict=None)}, load_state_path=None, modules_to_load=None, module_specs={'default_policy': RLModuleSpec(module_class=<class 'source.intrinsic_attention_ppo.rl_modules.DifferentiablePPOModule.DifferentiablePPOModule'>, observation_space=None, action_space=None, inference_only=False, learner_only=False, model_config={'vf_share_layers': True, 'embedding_dim': 62, 'max_seq_len': 11, 'policy_head_hidden_sizes': [32], 'value_head_hidden_sizes': [101], 'embedding_hidden_sizes': [121]}, catalog_class=None, load_state_path=None, model_config_dict=None), 'intrinsic_reward_module': RLModuleSpec(module_class=<class 'source.intrinsic_attention_ppo.rl_modules.IntrinsicAttentionModule.IntrinsicAttentionModule'>, observation_space=None, action_space=None, inference_only=False, learner_only=True, model_config={'intrinsic_reward_network': {'encoder_hidden_sizes': [], 'encoding_dim': 1, 'num_heads': 1, 'head_hidden_sizes': None, 'layers': [{'type': 'attention'}]}, 'extrinsic_value_hidden_layers': [127, 60], 'vf_share_layers': True, 'max_seq_len': 11}, catalog_class=None, load_state_path=None, model_config_dict=None)})", "algorithm_config_overrides_per_module": {"intrinsic_reward_module": {"lr": 0.0002715581955}}, "_per_module_overrides": {}, "_validate_config": true, "_use_msgpack_checkpoints": false, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "env_task_fn": -1, "enable_connectors": -1, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.161583927863, "kl_target": 0.0201019014258, "vf_loss_coeff": 0.7790510010087, "entropy_coeff": 0.0015431216992, "clip_param": 0.2459212356676, "vf_clip_param": 0.3769744131561, "entropy_coeff_schedule": null, "lr_schedule": null, "sgd_minibatch_size": -1, "vf_share_layers": -1, "differentiable_learner_configs": ["DifferentiableLearnerConfig(learner_class=<class 'source.intrinsic_attention_ppo.learners.IntrinsicAttentionPPOLearner.IntrinsicAttentionPPOLearner'>, learner_connector=None, add_default_connectors_to_learner_pipeline=True, is_multi_agent=False, policies_to_update=['default_policy'], lr=0.0060984166342, num_total_minibatches=0, num_epochs=1, minibatch_size=1000, shuffle_batch_per_epoch=True)"], "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9485408017724, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.callbacks.callbacks.RLlibCallback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 146.7793674468994, "iterations_since_restore": 15, "perf": {"cpu_util_percent": 40.56923076923078, "ram_util_percent": 80.30000000000001}}
{"timers": {"training_iteration": 10.148762350675746, "restore_env_runners": 1.2511265852453168e-05, "training_step": 10.148554761672122, "env_runner_sampling_timer": 2.469211426737965, "learner_update_timer": 7.425101212610994, "synch_weights": 0.0017459651721220483, "restore_eval_env_runners": 4.399057574634745e-05, "evaluation_iteration": 0.13712604283476887, "synch_eval_env_connectors": 0.00018338430493791772, "synch_env_connectors": 4.690314303747248e-06}, "env_runners": {"env_reset_timer": 4.539156458883617e-05, "num_episodes_lifetime": -431750.0, "num_env_steps_sampled_lifetime": -8635000.0, "num_env_steps_sampled": 5000.0, "module_to_env_connector": {"timers": {"connectors": {"remove_single_ts_time_rank_from_batch": 1.2076019365666227e-05, "get_actions": 3.989268760974511e-05, "listify_data_for_vector_env": 1.0708596946213099e-05, "tensor_to_numpy": 1.5489132297892643e-05, "un_batch_to_individual_items": 6.641864233944494e-06, "normalize_and_clip_actions": 8.150330037382084e-06}}, "connector_pipeline_timer": 0.00011949634421890016}, "module_episode_returns_mean": {"default_policy": -0.54}, "time_between_sampling": 0.030901040895018075, "rlmodule_inference_timer": 3.2063969534630864e-05, "env_step_timer": 1.4335456574491031e-05, "env_to_module_connector": {"timers": {"connectors": {"batch_individual_items": 1.2685033533748183e-05, "add_observations_from_episodes_to_batch": 2.9426575408801718e-06, "add_states_from_episodes_to_batch": 2.716332853299606e-06, "numpy_to_tensor": 1.2813716578039977e-05, "add_time_dim_to_batch_and_zero_pad": 7.366400024045266e-06}}, "connector_pipeline_timer": 6.066583153634977e-05}, "weights_seq_no": 15.0, "num_agent_steps_sampled": {"default_agent": 5000.0}, "episode_len_min": 20, "episode_len_mean": 20.0, "num_episodes": 250.0, "sample": 0.005726790747929923, "episode_duration_sec_mean": 0.005350245735608042, "episode_len_max": 20, "num_module_steps_sampled": {"default_policy": 5000.0}, "num_agent_steps_sampled_lifetime": {"default_agent": -8635000.0}, "num_module_steps_sampled_lifetime": {"default_policy": -8635000.0}, "env_to_module_sum_episodes_length_out": 10.36823839457432, "agent_episode_returns_mean": {"default_agent": -0.54}, "episode_return_max": 10.5, "episode_return_min": -9.5, "env_to_module_sum_episodes_length_in": 10.36823839457432, "episode_return_mean": -0.54, "num_env_steps_sampled_lifetime_throughput": 3191.9673943898138}, "__all_modules__": {"learner_connector_sum_episodes_length_in": 5000.0, "learner_connector": {"connector_pipeline_timer": 0.2117075104093581, "timers": {"connectors": {"add_one_ts_to_episodes_and_truncate": 0.009142118776588156, "add_observations_from_episodes_to_batch": 0.0009609011143370084, "add_columns_from_episodes_to_train_batch": 0.09403985603768827, "add_time_dim_to_batch_and_zero_pad": 0.08698559304730605, "add_states_from_episodes_to_batch": 0.0036202012347508277, "batch_individual_items": 0.01667629064661352, "numpy_to_tensor": 8.808196659048755e-05}}}, "learner_connector_sum_episodes_length_out": 5250.0}, "learners": {"differentiable_learners": {"intrinsic_attention_ppo_learner": {"intrinsic_reward_module": {"num_module_steps_trained_lifetime": 574560, "weights_seq_no": 96.0, "total_loss": 0.0, "num_module_steps_trained": 35910, "diff_num_grad_updates_vs_sampler_policy": 81.0, "module_train_batch_size_mean": 997.4990256591639}, "default_policy": {"module_train_batch_size_mean": 997.4990256591639, "use_intrinsic_rewards": 1.0, "num_module_steps_trained_lifetime": 574560, "policy_loss": -4.877255196333863e-05, "mean_kl_loss": 4.271969373803586e-06, "entropy": 0.6930210590362549, "weights_seq_no": 96.0, "vf_loss_unclipped": 44.71976089477539, "vf_loss": 0.35834604501724243, "total_loss": 0.27805235981941223, "vf_explained_var": -0.001362919807434082, "num_module_steps_trained": 35910, "diff_num_grad_updates_vs_sampler_policy": 81.0}, "__all_modules__": {"num_env_steps_trained_lifetime": 3168000, "num_module_steps_trained": 71820, "num_module_steps_trained_lifetime": 1149120, "num_env_steps_trained": 198000, "num_env_steps_trained_lifetime_throughput": 46551.12348227024}}}, "intrinsic_reward_module": {"num_module_steps_trained": 5985, "curr_entropy_coeff": 0.0015431216992, "total_loss": 0.0, "num_module_steps_trained_lifetime": 95760, "gradients_default_optimizer_global_norm": 0.0, "diff_num_grad_updates_vs_sampler_policy": 1.0, "module_train_batch_size_mean": 997.6889684010584, "default_optimizer_learning_rate": 0.0002715581955, "num_trainable_parameters": 8266, "weights_seq_no": 16.0, "num_module_steps_trained_lifetime_throughput": 780.4094752978779}, "__all_modules__": {"num_trainable_parameters": 24861, "num_non_trainable_parameters": 0, "num_env_steps_trained_lifetime": 528000, "num_module_steps_trained": 11970, "num_module_steps_trained_lifetime": 191520, "num_env_steps_trained": 33000, "num_env_steps_trained_lifetime_throughput": 4304.16945149941, "num_module_steps_trained_throughput": 22244016.573816333, "num_module_steps_trained_lifetime_throughput": 12964396.939682094}, "default_policy": {"vf_loss": 0.35830453038215637, "weights_seq_no": 16.0, "curr_entropy_coeff": 0.0015431216992, "vf_loss_unclipped": 44.575653076171875, "total_loss": 0.2780180871486664, "vf_explained_var": -0.0004037618637084961, "num_module_steps_trained": 5985, "diff_num_grad_updates_vs_sampler_policy": 1.0, "curr_kl_coeff": 2.4655751076352317e-06, "use_intrinsic_rewards": 0.0, "module_train_batch_size_mean": 997.6889684010584, "num_module_steps_trained_lifetime": 95760, "policy_loss": -4.9978963943431154e-05, "num_trainable_parameters": 16595, "mean_kl_loss": 4.402800641400972e-06, "entropy": 0.6930216550827026, "num_module_steps_trained_lifetime_throughput": 780.3998602426466}, "IntrinsicAttentionMask": [[[0.09094614535570145, 0.09099376946687698, 0.08987084031105042, 0.09108910709619522, 0.09113681316375732, 0.09071802347898483, 0.0919477790594101, 0.09081307053565979, 0.09086062759160995, 0.09137570858001709, 0.09024806320667267], [0.09095319360494614, 0.09101032465696335, 0.08966483920812607, 0.09112470597028732, 0.09118195623159409, 0.09067962318658829, 0.09215601533651352, 0.09079358726739883, 0.09085062891244888, 0.09146872162818909, 0.0901164561510086], [0.09075476229190826, 0.09058713912963867, 0.09464731067419052, 0.0902528166770935, 0.09008612483739853, 0.09156312048435211, 0.08731182664632797, 0.09122519195079803, 0.0910566970705986, 0.08925724774599075, 0.09325779974460602], [0.09096690267324448, 0.09104306250810623, 0.08925388008356094, 0.09119557589292526, 0.09127192199230194, 0.09060247987508774, 0.09257351607084274, 0.09075425565242767, 0.0908302366733551, 0.09165464341640472, 0.089853435754776], [0.09097360074520111, 0.09105927497148514, 0.08904895186424255, 0.0912308618426323, 0.09131678193807602, 0.09056377410888672, 0.09278281033039093, 0.09073442965745926, 0.09081988036632538, 0.09174758195877075, 0.08972205966711044], [0.09091075509786606, 0.09091281145811081, 0.09086394309997559, 0.09091693162918091, 0.09091899544000626, 0.09090086072683334, 0.09095387905836105, 0.09090498089790344, 0.09090705215930939, 0.0909293070435524, 0.09088042378425598], [0.09106902033090591, 0.09131599217653275, 0.08563510328531265, 0.09181194752454758, 0.09206093847751617, 0.0898936465382576, 0.0963776558637619, 0.09038187563419342, 0.09062698483467102, 0.09331604093313217, 0.08751072734594345], [0.09092584252357483, 0.09094690531492233, 0.09044886380434036, 0.09098902344703674, 0.09101009368896484, 0.0908249244093895, 0.09136732667684555, 0.09086699038743973, 0.09088803082704544, 0.09111551195383072, 0.09061655402183533], [0.09093320369720459, 0.09096376597881317, 0.09024184942245483, 0.09102489799261093, 0.0910554900765419, 0.09078678488731384, 0.09157456457614899, 0.09084780514240265, 0.09087833762168884, 0.0912085697054863, 0.09048472344875336], [0.09100528061389923, 0.091138556599617, 0.08802957832813263, 0.0914057046175003, 0.09153956919908524, 0.09036869555711746, 0.0938345342874527, 0.0906335860490799, 0.09076631814241409, 0.09221184998750687, 0.08906625211238861], [0.090829037129879, 0.09073705226182938, 0.09294399619102478, 0.09055335819721222, 0.09046164900064468, 0.09127157181501389, 0.08892393857240677, 0.09108678251504898, 0.09099454432725906, 0.09000449627637863, 0.09219362586736679]], [[0.09168384969234467, 0.0916399359703064, 0.0922532007098198, 0.09155216068029404, 0.09107975661754608, 0.09146446734666824, 0.09142064303159714, 0.09203244745731354, 0.08433141559362411, 0.09053760766983032, 0.09200452268123627], [0.0915188193321228, 0.09148453176021576, 0.09196297824382782, 0.09141599386930466, 0.09104689210653305, 0.09134750813245773, 0.09131328016519547, 0.0917908325791359, 0.08572730422019958, 0.09062278270721436, 0.09176905453205109], [0.09363553673028946, 0.09346449375152588, 0.09587380290031433, 0.09312333911657333, 0.09130307286977768, 0.09278342872858047, 0.09261394292116165, 0.09500131756067276, 0.06806312501430511, 0.08924654126167297, 0.09489137679338455], [0.0911823958158493, 0.09116727858781815, 0.09137801080942154, 0.09113703668117523, 0.09097398072481155, 0.09110680967569351, 0.09109169989824295, 0.09130226075649261, 0.08858173340559006, 0.0907861590385437, 0.09129267185926437], [0.089213065803051, 0.08929888904094696, 0.0881115198135376, 0.08947080373764038, 0.09040455520153046, 0.08964304625988007, 0.08972928673028946, 0.08853619545698166, 0.10550826042890549, 0.09149428457021713, 0.08859013020992279], [0.09083735197782516, 0.09084126353263855, 0.09078691154718399, 0.09084907174110413, 0.09089125692844391, 0.0908568874001503, 0.09086079150438309, 0.09080643206834793, 0.09152127057313919, 0.090939961373806, 0.09080889821052551], [0.09066154062747955, 0.09067490696907043, 0.09048902243375778, 0.0907016471028328, 0.09084613621234894, 0.09072839468717575, 0.09074176847934723, 0.09055574238300323, 0.09302353858947754, 0.09101315587759018, 0.09056419879198074], [0.09291873872280121, 0.09279745072126389, 0.09450019896030426, 0.09255532920360565, 0.0912591889500618, 0.09231384843587875, 0.09219334274530411, 0.09388501197099686, 0.07398360967636108, 0.08978590369224548, 0.09380737692117691], [0.030513351783156395, 0.031059468165040016, 0.024263478815555573, 0.03218119964003563, 0.03897448629140854, 0.033343441784381866, 0.033940207213163376, 0.026513898745179176, 0.67378169298172, 0.04861535131931305, 0.0268134493380785], [0.08659390360116959, 0.08679007738828659, 0.0840989202260971, 0.08718374371528625, 0.08933994174003601, 0.08757919818162918, 0.08777759969234467, 0.08505582809448242, 0.1285083144903183, 0.0918947085738182, 0.08517780900001526], [0.09282457828521729, 0.09270953387022018, 0.09432379901409149, 0.0924798771739006, 0.09124992787837982, 0.09225079417228699, 0.09213646501302719, 0.09374074637889862, 0.07476632297039032, 0.08985079824924469, 0.0936671644449234]], [[0.09073105454444885, 0.09077857434749603, 0.08965829759836197, 0.08970525115728378, 0.09092127531766891, 0.09050347656011581, 0.09173032641410828, 0.09177836775779724, 0.091826431453228, 0.09115961194038391, 0.091207355260849], [0.09069490432739258, 0.09075187891721725, 0.0894102156162262, 0.0894663855433464, 0.09092302620410919, 0.0904221162199974, 0.09189432114362717, 0.09195204824209213, 0.09200981259346008, 0.09120897203683853, 0.09126627445220947], [0.09149471670389175, 0.09132572263479233, 0.09541899710893631, 0.09524275362491608, 0.09082061797380447, 0.09230966120958328, 0.08802370727062225, 0.08786112815141678, 0.08769884705543518, 0.08998497575521469, 0.08981878310441971], [0.09146345406770706, 0.09130405634641647, 0.09516038000583649, 0.09499453753232956, 0.09082752466201782, 0.09223190695047379, 0.08818608522415161, 0.08803239464759827, 0.08787897229194641, 0.09003882110118866, 0.08988191187381744], [0.09058522433042526, 0.09067053347826004, 0.08866878598928452, 0.08875229209661484, 0.09092693775892258, 0.09017714858055115, 0.09238671511411667, 0.09247371554374695, 0.09256080538034439, 0.09135590493679047, 0.09144193679094315], [0.09090148657560349, 0.09090355038642883, 0.09085468202829361, 0.09085674583911896, 0.09090973436832428, 0.09089160710573196, 0.09094461053609848, 0.09094668179750443, 0.09094873815774918, 0.09092003852128983, 0.09092210233211517], [0.08993183076381683, 0.09017572551965714, 0.08456577360630035, 0.08479510992765427, 0.090911366045475, 0.08877113461494446, 0.09517418593168259, 0.09543228149414062, 0.09569109231233597, 0.09215079247951508, 0.0924006998538971], [0.08989138901233673, 0.09014458954334259, 0.08432745933532715, 0.08456498384475708, 0.09090845286846161, 0.08868678659200668, 0.09533944725990295, 0.09560798108577728, 0.0958772748708725, 0.09219597280025482, 0.09245565533638], [0.0898507609963417, 0.09011324495077133, 0.08408962190151215, 0.08433527499437332, 0.0909053236246109, 0.08860229700803757, 0.0955047681927681, 0.0957837700843811, 0.09606359153985977, 0.09224095195531845, 0.0925104171037674], [0.09039825201034546, 0.0905306413769722, 0.08744239807128906, 0.08757045865058899, 0.09092897921800613, 0.08976591378450394, 0.09320863336324692, 0.09334513545036316, 0.09348184615373611, 0.09159677475690842, 0.09173091500997543], [0.09036023914813995, 0.09050202369689941, 0.08719851821660995, 0.08733534812927246, 0.09092871844768524, 0.08968323469161987, 0.09337320923805237, 0.09351972490549088, 0.09366646409034729, 0.09164435416460037, 0.091788150370121]], [[0.09092304855585098, 0.09245389699935913, 0.09162209928035736, 0.09257402271032333, 0.0902806967496872, 0.09269431233406067, 0.09275451302528381, 0.09045671671628952, 0.0838930681347847, 0.09248631447553635, 0.08986128121614456], [0.09032507240772247, 0.09841328114271164, 0.09394925832748413, 0.09907186031341553, 0.08709493279457092, 0.0997348502278328, 0.10006800293922424, 0.08797065168619156, 0.0597449354827404, 0.0985906720161438, 0.08503653109073639], [0.09077221900224686, 0.09527149796485901, 0.09280911087989807, 0.09563062340021133, 0.08892656862735748, 0.0959910973906517, 0.09617184102535248, 0.08942984789609909, 0.07189412415027618, 0.09536833316087723, 0.08773483335971832], [0.09023908525705338, 0.0988491028547287, 0.09409136325120926, 0.09955217689275742, 0.0868137925863266, 0.10026025027036667, 0.10061617195606232, 0.08774164319038391, 0.05816275253891945, 0.09903845191001892, 0.08463515341281891], [0.09085258096456528, 0.08971233665943146, 0.09032774716615677, 0.08962425589561462, 0.09134113788604736, 0.08953627198934555, 0.0894923061132431, 0.09120665490627289, 0.09655465930700302, 0.08968854695558548, 0.09166344255208969], [0.09014798700809479, 0.09928114712238312, 0.09422826021909714, 0.10002906620502472, 0.08652857691049576, 0.1007826179265976, 0.10116152465343475, 0.0875081941485405, 0.05661921575665474, 0.09948253631591797, 0.08423083275556564], [0.09010056406259537, 0.0994957685470581, 0.09429477900266647, 0.1002662405371666, 0.08638449013233185, 0.10104268789291382, 0.1014331579208374, 0.08738984912633896, 0.05586168169975281, 0.09970321506261826, 0.08402761816978455], [0.09089330583810806, 0.09047858417034149, 0.0907028391957283, 0.09044641256332397, 0.09106998890638351, 0.09041425585746765, 0.09039817750453949, 0.09102141857147217, 0.09291891008615494, 0.09046989679336548, 0.09118621051311493], [0.07411083579063416, 0.054022371768951416, 0.06410565227270126, 0.05271025002002716, 0.08475913107395172, 0.051430001854896545, 0.050801582634449005, 0.08168995380401611, 0.3401331901550293, 0.05366490036249161, 0.09257214516401291], [0.09030236303806305, 0.0985313355922699, 0.09398815035820007, 0.09920188784599304, 0.0870194286108017, 0.0998770147562027, 0.10021629184484482, 0.0879092589020729, 0.059313878417015076, 0.09871194511651993, 0.08492845296859741], [0.09068611264228821, 0.08783964812755585, 0.08936911821365356, 0.08762206137180328, 0.09192252904176712, 0.0874050110578537, 0.08729668706655502, 0.09158118069171906, 0.10575304180383682, 0.08778084814548492, 0.09274374693632126]], [[0.09267731010913849, 0.09456609189510345, 0.08969232439994812, 0.0941777378320694, 0.0893239825963974, 0.08644544333219528, 0.0907684788107872, 0.09058190882205963, 0.08591347932815552, 0.09302221983671188, 0.09283101558685303], [0.09353762865066528, 0.09640708565711975, 0.08906199038028717, 0.09581474214792252, 0.0885147824883461, 0.0842771902680397, 0.09066715836524963, 0.09038819372653961, 0.0835016667842865, 0.09405946731567383, 0.09377007186412811], [0.0912533774971962, 0.09160836786031723, 0.09068026393651962, 0.09153585135936737, 0.09060847759246826, 0.09003909677267075, 0.09088863432407379, 0.09085265547037125, 0.08993220329284668, 0.09131863713264465, 0.09128247946500778], [0.09336324781179428, 0.09603048115968704, 0.08919186145067215, 0.09548033028841019, 0.08868088573217392, 0.0847165659070015, 0.09068950265645981, 0.09042935818433762, 0.08398960530757904, 0.09384871274232864, 0.09357950836420059], [0.09107201546430588, 0.09123925119638443, 0.09080128371715546, 0.09120511263608932, 0.09076730906963348, 0.09049734473228455, 0.09089981764554977, 0.0908828154206276, 0.09044656157493591, 0.09110278636217117, 0.09108573943376541], [0.0896100178360939, 0.0883229523897171, 0.09173855185508728, 0.08858396112918854, 0.09200965613126755, 0.09419642388820648, 0.09095731377601624, 0.09109161049127579, 0.09461428225040436, 0.08937163650989532, 0.08950359374284744], [0.0917760580778122, 0.09268157184123993, 0.09032546728849411, 0.09249614924192429, 0.09014476090669632, 0.08871917426586151, 0.09085125476121902, 0.09076032787561417, 0.08845306932926178, 0.09194210916757584, 0.09185010194778442], [0.0916861966252327, 0.09249605983495712, 0.09038708359003067, 0.09233029186725616, 0.09022510051727295, 0.08894599974155426, 0.09085822105407715, 0.09077677130699158, 0.08870699256658554, 0.09183477610349655, 0.09175244718790054], [0.08933094888925552, 0.08777783811092377, 0.09190987795591354, 0.08809241652488708, 0.09223926812410355, 0.09490364789962769, 0.09096184372901917, 0.09112469106912613, 0.09541428089141846, 0.08904293924570084, 0.08920235186815262], [0.09283670783042908, 0.09490402787923813, 0.08957746624946594, 0.09447865188121796, 0.08917596936225891, 0.08604355156421661, 0.09075137972831726, 0.09054777026176453, 0.08546570688486099, 0.09321393817663193, 0.09300480037927628], [0.09274847060441971, 0.09471678733825684, 0.08964115381240845, 0.09431195259094238, 0.08925800770521164, 0.08626601099967957, 0.09076093882322311, 0.09056676179170609, 0.08571352064609528, 0.09310778230428696, 0.0929085910320282]], [[0.09171789884567261, 0.09191089123487473, 0.0847414955496788, 0.08762525767087936, 0.0850985050201416, 0.08799440413713455, 0.09288196265697479, 0.08563683182001114, 0.11928506940603256, 0.08735675364732742, 0.08575090020895004], [0.09173452109098434, 0.09193715453147888, 0.08442439138889313, 0.08744261413812637, 0.08479776978492737, 0.08782932907342911, 0.0929570347070694, 0.08536092936992645, 0.12087461352348328, 0.08716138452291489, 0.08548030257225037], [0.08957580476999283, 0.08941217511892319, 0.0959569439291954, 0.09320409595966339, 0.09560669213533401, 0.09286388754844666, 0.08859850466251373, 0.09508370608091354, 0.07127133011817932, 0.09345322102308273, 0.09497366845607758], [0.09081008285284042, 0.09079502522945404, 0.09137874841690063, 0.09113777428865433, 0.09134843945503235, 0.09110754728317261, 0.09071975201368332, 0.09130299836397171, 0.08894634991884232, 0.09115985035896301, 0.09129340201616287], [0.08975335955619812, 0.08960811793804169, 0.0953943133354187, 0.09296621382236481, 0.09508582204580307, 0.09266557544469833, 0.08888543397188187, 0.09462495893239975, 0.07330190390348434, 0.09318628162145615, 0.0945279598236084], [0.09093398600816727, 0.09093789011240005, 0.09078695625066757, 0.09084911644458771, 0.09079476445913315, 0.09085693210363388, 0.09095744788646698, 0.09080646932125092, 0.09142410755157471, 0.09084341675043106, 0.09080895036458969], [0.0917809009552002, 0.09203167259693146, 0.08282332867383957, 0.0865003764629364, 0.08327654749155045, 0.08697370439767838, 0.09329584985971451, 0.08396102488040924, 0.12909391522407532, 0.086156465113163, 0.08410623669624329], [0.0900081992149353, 0.08989070355892181, 0.09454379230737686, 0.09259802848100662, 0.09429711848497391, 0.09235642850399017, 0.08930552750825882, 0.09392832219600677, 0.07644645124673843, 0.09277478605508804, 0.09385064989328384], [0.06992001831531525, 0.07098795473575592, 0.0395217128098011, 0.05030820891261101, 0.04073821380734444, 0.051856718957424164, 0.07657735049724579, 0.0426335334777832, 0.4652044177055359, 0.04920707643032074, 0.04304477199912071], [0.0907149612903595, 0.09068609029054642, 0.09180834889411926, 0.09134425967931747, 0.09174991399049759, 0.09128612279891968, 0.09054186940193176, 0.09166233986616135, 0.08717551827430725, 0.09138672053813934, 0.09164386242628098], [0.09006018191576004, 0.08994856476783752, 0.09436322003602982, 0.09251853078603745, 0.09412947297096252, 0.09228935092687607, 0.08939256519079208, 0.09377992898225784, 0.07712569087743759, 0.09268619120121002, 0.09370630979537964]]]}, "num_training_step_calls_per_iteration": 1, "evaluation": {"env_runners": {"module_to_env_connector": {"timers": {"connectors": {"remove_single_ts_time_rank_from_batch": 1.2712512820751443e-05, "get_actions": 4.0505095837630284e-05, "normalize_and_clip_actions": 8.548178765423963e-06, "listify_data_for_vector_env": 1.1329283496759542e-05, "tensor_to_numpy": 1.6220847380109577e-05, "un_batch_to_individual_items": 7.202386739384114e-06}}, "connector_pipeline_timer": 0.00012469191430580778}, "episode_len_max": 20, "num_agent_steps_sampled_lifetime": {"default_agent": 6400}, "num_module_steps_sampled_lifetime": {"default_policy": 6400}, "episode_return_max": 14.5, "env_reset_timer": 0.0005359235622328135, "rlmodule_inference_timer": 3.391297300373979e-05, "env_step_timer": 1.568438307098667e-05, "env_to_module_connector": {"timers": {"connectors": {"add_states_from_episodes_to_batch": 2.857420016465687e-06, "numpy_to_tensor": 1.3249197515189876e-05, "add_time_dim_to_batch_and_zero_pad": 7.389293766277003e-06, "add_observations_from_episodes_to_batch": 3.007393447829546e-06, "batch_individual_items": 1.3483633031427238e-05}}, "connector_pipeline_timer": 6.345089731597623e-05}, "episode_len_min": 20, "env_to_module_sum_episodes_length_out": 10.368238394574323, "env_to_module_sum_episodes_length_in": 10.368238394574323, "num_env_steps_sampled_lifetime": 80400, "num_agent_steps_sampled": {"default_agent": 400}, "weights_seq_no": 16.0, "module_episode_returns_mean": {"default_policy": 2.05}, "episode_len_mean": 20.0, "sample": 0.12588022512440283, "agent_episode_returns_mean": {"default_agent": 2.05}, "episode_return_mean": 2.05, "episode_return_min": -12.5, "num_episodes": 20, "episode_duration_sec_mean": 0.005540514953900129, "num_module_steps_sampled": {"default_policy": 400}, "num_episodes_lifetime": 320, "num_env_steps_sampled": 400, "time_between_sampling": 9.453894430299508}, "num_healthy_workers": 1, "actor_manager_num_outstanding_async_reqs": 0, "num_remote_worker_restarts": 0}, "num_env_steps_sampled_lifetime": -8635000.0, "fault_tolerance": {"num_healthy_workers": 0, "num_remote_worker_restarts": 0}, "env_runner_group": {"actor_manager_num_outstanding_async_reqs": 0}, "done": false, "training_iteration": 16, "trial_id": "b9446_00000", "date": "2025-08-11_18-36-50", "timestamp": 1754930210, "time_this_iter_s": 9.787642240524292, "time_total_s": 156.5670096874237, "pid": 11415, "hostname": "Mac", "node_ip": "127.0.0.1", "config": {"exploration_config": {}, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 2, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "env": "Umbrella", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": false, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 0, "create_local_env_runner": true, "num_envs_per_env_runner": 1, "gym_env_vectorize_mode": "SYNC", "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "episodes_to_numpy": true, "max_requests_in_flight_per_env_runner": 1, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "merge_env_runner_states": "training_only", "broadcast_env_runner_states": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "complete_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "sampler_perf_stats_ema_coef": null, "_is_online": true, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": "auto", "num_aggregator_actors_per_learner": 0, "max_requests_in_flight_per_aggregator_actor": 3, "local_gpu_idx": 0, "max_requests_in_flight_per_learner": 3, "gamma": 1, "lr": 0.0002715581955, "grad_clip": 0.5, "grad_clip_by": "global_norm", "_train_batch_size_per_learner": 5000, "train_batch_size": 4000, "num_epochs": 1, "minibatch_size": 1000, "shuffle_batch_per_epoch": true, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "log_std_clip_param": 20.0, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "_disable_preprocessor_api": false, "_disable_action_flattening": false}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {"intrinsic_reward_coeff": 0.2795015916508}, "optimizer": {}, "_learner_class": "<class 'source.intrinsic_attention_ppo.learners.IntrinsicAttentionMetaLearner.IntrinsicAttentionMetaLearner'>", "callbacks_on_algorithm_init": null, "callbacks_on_env_runners_recreated": null, "callbacks_on_offline_eval_runners_recreated": null, "callbacks_on_checkpoint_loaded": null, "callbacks_on_environment_created": null, "callbacks_on_episode_created": null, "callbacks_on_episode_start": null, "callbacks_on_episode_step": null, "callbacks_on_episode_end": null, "callbacks_on_evaluate_start": null, "callbacks_on_evaluate_end": null, "callbacks_on_evaluate_offline_start": null, "callbacks_on_evaluate_offline_end": null, "callbacks_on_sample_end": null, "callbacks_on_train_result": null, "explore": true, "enable_rl_module_and_learner": true, "enable_env_runner_and_connector_v2": true, "_prior_exploration_config": {"type": "StochasticSampling"}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x3884998a0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "offline_data_class": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_read_batch_size": null, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "materialize_data": false, "materialize_mapped_data": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "ignore_final_observation": false, "prelearner_class": null, "prelearner_buffer_class": null, "prelearner_buffer_kwargs": {}, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_remaining_data": false, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": 1, "evaluation_duration": 20, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_auto_duration_min_env_steps_per_sample": 100, "evaluation_auto_duration_max_env_steps_per_sample": 2000, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 1, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "offline_evaluation_interval": null, "num_offline_eval_runners": 0, "offline_loss_for_module_fn": null, "offline_evaluation_duration": 1, "offline_evaluation_parallel_to_training": false, "offline_evaluation_timeout_s": 120.0, "num_cpus_per_offline_eval_runner": 1, "num_gpus_per_offline_eval_runner": 0, "custom_resources_per_offline_eval_runner": {}, "restart_failed_offline_eval_runners": true, "ignore_offline_eval_runner_failures": false, "max_num_offline_eval_runner_restarts": 1000, "offline_eval_runner_restore_timeout_s": 1800.0, "max_requests_in_flight_per_offline_eval_runner": 1, "validate_offline_eval_runners_after_construction": true, "offline_eval_runner_health_probe_timeout_s": 30.0, "offline_eval_rl_module_inference_only": false, "broadcast_offline_eval_runner_states": false, "offline_eval_batch_size_per_runner": 256, "dataset_num_iters_per_eval_runner": 1, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "log_gradients": false, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 7, "restart_failed_env_runners": true, "ignore_env_runner_failures": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30.0, "env_runner_restore_timeout_s": 1800.0, "_model_config": {}, "_rl_module_spec": "MultiRLModuleSpec(multi_rl_module_class=<class 'ray.rllib.core.rl_module.multi_rl_module.MultiRLModule'>, observation_space=None, action_space=None, inference_only=False, model_config=None, rl_module_specs={'default_policy': RLModuleSpec(module_class=<class 'source.intrinsic_attention_ppo.rl_modules.DifferentiablePPOModule.DifferentiablePPOModule'>, observation_space=None, action_space=None, inference_only=False, learner_only=False, model_config={'vf_share_layers': True, 'embedding_dim': 62, 'max_seq_len': 11, 'policy_head_hidden_sizes': [32], 'value_head_hidden_sizes': [101], 'embedding_hidden_sizes': [121]}, catalog_class=None, load_state_path=None, model_config_dict=None), 'intrinsic_reward_module': RLModuleSpec(module_class=<class 'source.intrinsic_attention_ppo.rl_modules.IntrinsicAttentionModule.IntrinsicAttentionModule'>, observation_space=None, action_space=None, inference_only=False, learner_only=True, model_config={'intrinsic_reward_network': {'encoder_hidden_sizes': [], 'encoding_dim': 1, 'num_heads': 1, 'head_hidden_sizes': None, 'layers': [{'type': 'attention'}]}, 'extrinsic_value_hidden_layers': [127, 60], 'vf_share_layers': True, 'max_seq_len': 11}, catalog_class=None, load_state_path=None, model_config_dict=None)}, load_state_path=None, modules_to_load=None, module_specs={'default_policy': RLModuleSpec(module_class=<class 'source.intrinsic_attention_ppo.rl_modules.DifferentiablePPOModule.DifferentiablePPOModule'>, observation_space=None, action_space=None, inference_only=False, learner_only=False, model_config={'vf_share_layers': True, 'embedding_dim': 62, 'max_seq_len': 11, 'policy_head_hidden_sizes': [32], 'value_head_hidden_sizes': [101], 'embedding_hidden_sizes': [121]}, catalog_class=None, load_state_path=None, model_config_dict=None), 'intrinsic_reward_module': RLModuleSpec(module_class=<class 'source.intrinsic_attention_ppo.rl_modules.IntrinsicAttentionModule.IntrinsicAttentionModule'>, observation_space=None, action_space=None, inference_only=False, learner_only=True, model_config={'intrinsic_reward_network': {'encoder_hidden_sizes': [], 'encoding_dim': 1, 'num_heads': 1, 'head_hidden_sizes': None, 'layers': [{'type': 'attention'}]}, 'extrinsic_value_hidden_layers': [127, 60], 'vf_share_layers': True, 'max_seq_len': 11}, catalog_class=None, load_state_path=None, model_config_dict=None)})", "algorithm_config_overrides_per_module": {"intrinsic_reward_module": {"lr": 0.0002715581955}}, "_per_module_overrides": {}, "_validate_config": true, "_use_msgpack_checkpoints": false, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "env_task_fn": -1, "enable_connectors": -1, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.161583927863, "kl_target": 0.0201019014258, "vf_loss_coeff": 0.7790510010087, "entropy_coeff": 0.0015431216992, "clip_param": 0.2459212356676, "vf_clip_param": 0.3769744131561, "entropy_coeff_schedule": null, "lr_schedule": null, "sgd_minibatch_size": -1, "vf_share_layers": -1, "differentiable_learner_configs": ["DifferentiableLearnerConfig(learner_class=<class 'source.intrinsic_attention_ppo.learners.IntrinsicAttentionPPOLearner.IntrinsicAttentionPPOLearner'>, learner_connector=None, add_default_connectors_to_learner_pipeline=True, is_multi_agent=False, policies_to_update=['default_policy'], lr=0.0060984166342, num_total_minibatches=0, num_epochs=1, minibatch_size=1000, shuffle_batch_per_epoch=True)"], "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9485408017724, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.callbacks.callbacks.RLlibCallback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 156.5670096874237, "iterations_since_restore": 16, "perf": {"cpu_util_percent": 34.43571428571428, "ram_util_percent": 80.27857142857144}}
{"timers": {"training_iteration": 10.141703300918016, "restore_env_runners": 1.2513653582699931e-05, "training_step": 10.141495331555225, "env_runner_sampling_timer": 2.46153583789048, "learner_update_timer": 7.424842468405287, "synch_weights": 0.00173865551968967, "restore_eval_env_runners": 4.4047339661313534e-05, "evaluation_iteration": 0.1372222182471713, "synch_eval_env_connectors": 0.00018397254203096204, "synch_env_connectors": 4.683830560448087e-06}, "env_runners": {"env_reset_timer": 5.089892828813801e-05, "num_episodes_lifetime": -462625.0, "num_env_steps_sampled_lifetime": -9252500.0, "num_env_steps_sampled": 5000.0, "module_to_env_connector": {"timers": {"connectors": {"remove_single_ts_time_rank_from_batch": 1.2794260354627397e-05, "get_actions": 4.355574123738285e-05, "listify_data_for_vector_env": 1.158543056356364e-05, "tensor_to_numpy": 1.6544302622154467e-05, "un_batch_to_individual_items": 7.074602628276739e-06, "normalize_and_clip_actions": 8.649116600803751e-06}}, "connector_pipeline_timer": 0.00012814500627812057}, "module_episode_returns_mean": {"default_policy": 0.7399999999999999}, "time_between_sampling": 0.033334784423451586, "rlmodule_inference_timer": 3.5153597924682463e-05, "env_step_timer": 1.558732196804851e-05, "env_to_module_connector": {"timers": {"connectors": {"batch_individual_items": 1.3522281389536906e-05, "add_observations_from_episodes_to_batch": 3.121412453942419e-06, "add_states_from_episodes_to_batch": 2.857563987010699e-06, "numpy_to_tensor": 1.3826595101841587e-05, "add_time_dim_to_batch_and_zero_pad": 7.944158717947167e-06}}, "connector_pipeline_timer": 6.467860409165687e-05}, "weights_seq_no": 16.0, "num_agent_steps_sampled": {"default_agent": 5000.0}, "episode_len_min": 20, "episode_len_mean": 20.0, "num_episodes": 250.0, "sample": 0.005987165334317247, "episode_duration_sec_mean": 0.005763481016270816, "episode_len_max": 20, "num_module_steps_sampled": {"default_policy": 5000.0}, "num_agent_steps_sampled_lifetime": {"default_agent": -9252500.0}, "num_module_steps_sampled_lifetime": {"default_policy": -9252500.0}, "env_to_module_sum_episodes_length_out": 10.36823839457432, "agent_episode_returns_mean": {"default_agent": 0.7399999999999999}, "episode_return_max": 10.5, "episode_return_min": -9.5, "env_to_module_sum_episodes_length_in": 10.36823839457432, "episode_return_mean": 0.7399999999999999, "num_env_steps_sampled_lifetime_throughput": 3001.2061017439373}, "__all_modules__": {"learner_connector_sum_episodes_length_in": 5000.0, "learner_connector": {"connector_pipeline_timer": 0.2125025948848377, "timers": {"connectors": {"add_one_ts_to_episodes_and_truncate": 0.00913897258927527, "add_observations_from_episodes_to_batch": 0.0009609246026165163, "add_columns_from_episodes_to_train_batch": 0.09354089331822356, "add_time_dim_to_batch_and_zero_pad": 0.08692142253688792, "add_states_from_episodes_to_batch": 0.0036207229723482595, "batch_individual_items": 0.0180377723303013, "numpy_to_tensor": 8.805406610825416e-05}}}, "learner_connector_sum_episodes_length_out": 5250.0}, "learners": {"differentiable_learners": {"intrinsic_attention_ppo_learner": {"intrinsic_reward_module": {"num_module_steps_trained_lifetime": 610470, "weights_seq_no": 102.0, "total_loss": 0.0, "num_module_steps_trained": 35910, "diff_num_grad_updates_vs_sampler_policy": 86.0, "module_train_batch_size_mean": 997.498558675304}, "default_policy": {"module_train_batch_size_mean": 997.498558675304, "use_intrinsic_rewards": 1.0, "num_module_steps_trained_lifetime": 610470, "policy_loss": -0.00015296461060643196, "mean_kl_loss": 1.1637601346592419e-05, "entropy": 0.6930859684944153, "weights_seq_no": 102.0, "vf_loss_unclipped": 45.51228713989258, "vf_loss": 0.35834431648254395, "total_loss": 0.27794790267944336, "vf_explained_var": -0.0013550519943237305, "num_module_steps_trained": 35910, "diff_num_grad_updates_vs_sampler_policy": 86.0}, "__all_modules__": {"num_env_steps_trained_lifetime": 3366000, "num_module_steps_trained": 71820, "num_module_steps_trained_lifetime": 1220940, "num_env_steps_trained": 198000, "num_env_steps_trained_lifetime_throughput": 45911.22727663489}}}, "intrinsic_reward_module": {"num_module_steps_trained": 5985, "curr_entropy_coeff": 0.0015431216992, "total_loss": 0.0, "num_module_steps_trained_lifetime": 101745, "gradients_default_optimizer_global_norm": 0.0, "diff_num_grad_updates_vs_sampler_policy": 1.0, "module_train_batch_size_mean": 997.6777629636601, "default_optimizer_learning_rate": 0.0002715581955, "num_trainable_parameters": 8266, "weights_seq_no": 17.0, "num_module_steps_trained_lifetime_throughput": 777.8719144794261}, "__all_modules__": {"num_trainable_parameters": 24861, "num_non_trainable_parameters": 0, "num_env_steps_trained_lifetime": 561000, "num_module_steps_trained": 11970, "num_module_steps_trained_lifetime": 203490, "num_env_steps_trained": 33000, "num_env_steps_trained_lifetime_throughput": 4290.135489247555, "num_module_steps_trained_throughput": 21735853.763963334, "num_module_steps_trained_lifetime_throughput": 12940900.85353158}, "default_policy": {"vf_loss": 0.3583044707775116, "weights_seq_no": 17.0, "curr_entropy_coeff": 0.0015431216992, "vf_loss_unclipped": 45.325321197509766, "total_loss": 0.2779097855091095, "vf_explained_var": -0.0006000995635986328, "num_module_steps_trained": 5985, "diff_num_grad_updates_vs_sampler_policy": 1.0, "curr_kl_coeff": 1.2327875538176158e-06, "use_intrinsic_rewards": 0.0, "module_train_batch_size_mean": 997.6777629636601, "num_module_steps_trained_lifetime": 101745, "policy_loss": -0.00015812968194950372, "num_trainable_parameters": 16595, "mean_kl_loss": 1.2360662367427722e-05, "entropy": 0.6930874586105347, "num_module_steps_trained_lifetime_throughput": 777.8629114875089}, "IntrinsicAttentionMask": [[[0.09353844076395035, 0.09544477611780167, 0.09052572399377823, 0.0950528159737587, 0.09015396237373352, 0.09180057793855667, 0.08706933259963989, 0.09142357856035233, 0.08671177178621292, 0.0892312228679657, 0.08904781192541122], [0.09484212845563889, 0.09775160253047943, 0.09030406922101974, 0.0971510037779808, 0.08974923193454742, 0.09221535921096802, 0.08518962562084198, 0.09164877235889435, 0.08466620743274689, 0.08837699145078659, 0.08810506761074066], [0.09141591191291809, 0.09177153557538986, 0.09084177762269974, 0.09169888496398926, 0.09076986461877823, 0.09108658134937286, 0.09016375988721848, 0.09101447463035583, 0.09009238332509995, 0.09059032797813416, 0.09055446833372116], [0.09457653015851974, 0.0972784236073494, 0.0903509333729744, 0.09672112762928009, 0.0898333191871643, 0.0921323299407959, 0.08557131141424179, 0.09160451591014862, 0.085081085562706, 0.08855222910642624, 0.08829820156097412], [0.09114862233400345, 0.09131599962711334, 0.09087766706943512, 0.09128183126449585, 0.09084366261959076, 0.09099330753087997, 0.09055651724338531, 0.09095926582813263, 0.0905226469039917, 0.09075871855020523, 0.09074173122644424], [0.09232350438833237, 0.09332993626594543, 0.09071340411901474, 0.09312377125024796, 0.09051301330327988, 0.0913977101445198, 0.08883534371852875, 0.09119580686092377, 0.08863910287618637, 0.09001397341489792, 0.08991450071334839], [0.08888423442840576, 0.08751793205738068, 0.09114685654640198, 0.08779489994049072, 0.09143531322479248, 0.0901733934879303, 0.09391243010759354, 0.09045876562595367, 0.09420963376760483, 0.09216044098138809, 0.09230615943670273], [0.09205655753612518, 0.09286969155073166, 0.09075219929218292, 0.09270325303077698, 0.09058956056833267, 0.09130708873271942, 0.08922523260116577, 0.09114345908164978, 0.089065320789814, 0.09018422663211823, 0.090103380382061], [0.08861629664897919, 0.0870756059885025, 0.09117459505796432, 0.08738767355680466, 0.09150134772062302, 0.0900728777050972, 0.09431295841932297, 0.09039568156003952, 0.09465096145868301, 0.09232336282730103, 0.09248865395784378], [0.09047999233007431, 0.09018323570489883, 0.09096363186836243, 0.09024368971586227, 0.09102459996938705, 0.09075672179460526, 0.0915420800447464, 0.09081755578517914, 0.09160344302654266, 0.09117721766233444, 0.09120776504278183], [0.09034621715545654, 0.08995773643255234, 0.0909801796078682, 0.09003683179616928, 0.09106018394231796, 0.09070883691310883, 0.09173982590436935, 0.09078860282897949, 0.09182049334049225, 0.09126050025224686, 0.0913006141781807]], [[0.09790559113025665, 0.09068476408720016, 0.08669725060462952, 0.0988590270280838, 0.09451208263635635, 0.09186416119337082, 0.09982175379991531, 0.09543247520923615, 0.06056831404566765, 0.09839387238025665, 0.08526074886322021], [0.0926300436258316, 0.09098900854587555, 0.09003940969705582, 0.09283972531557083, 0.09187080711126328, 0.09126373380422592, 0.09304987639188766, 0.09207876771688461, 0.0828118547797203, 0.09273762255907059, 0.08968910574913025], [0.0892595499753952, 0.09075373411178589, 0.0916423350572586, 0.08907230943441391, 0.08994445204734802, 0.09049998968839645, 0.08888546377420425, 0.08975576609373093, 0.09904827922582626, 0.0891633853316307, 0.09197471290826797], [0.09853387624025345, 0.09059110283851624, 0.08623082935810089, 0.09958699345588684, 0.09479373693466187, 0.09188435226678848, 0.10065136104822159, 0.09580687433481216, 0.058183103799819946, 0.09907308965921402, 0.08466475456953049], [0.0955464169383049, 0.09092578291893005, 0.08831857144832611, 0.09614738076925278, 0.09339043498039246, 0.09168912470340729, 0.09675212949514389, 0.09397784620523453, 0.07002890110015869, 0.09585444629192352, 0.08736899495124817], [0.0935598760843277, 0.0909963920712471, 0.08952464908361435, 0.0938892513513565, 0.09237071126699448, 0.09142377227544785, 0.09421977400779724, 0.09269589185714722, 0.07860702276229858, 0.09372881054878235, 0.08898389339447021], [0.09915389120578766, 0.09048629552125931, 0.08575627952814102, 0.10030786693096161, 0.0950644314289093, 0.09189314395189285, 0.10147526860237122, 0.0961708128452301, 0.05588488653302193, 0.09974461048841476, 0.08406250178813934], [0.09620606154203415, 0.09087579697370529, 0.08788590878248215, 0.09690221399068832, 0.09371405094861984, 0.09175362437963486, 0.09760340303182602, 0.09439217299222946, 0.06730365753173828, 0.09656280279159546, 0.0868002250790596], [0.05484578758478165, 0.0734129548072815, 0.08711545914411545, 0.05285978317260742, 0.06272605061531067, 0.0698900818824768, 0.050945695489645004, 0.060454703867435455, 0.3410976231098175, 0.05381713807582855, 0.09283474087715149], [0.09822914004325867, 0.09063807874917984, 0.08645884692668915, 0.09923360496759415, 0.09465803951025009, 0.09187596291303635, 0.10024832934141159, 0.09562597423791885, 0.05933285132050514, 0.0987434983253479, 0.0849556028842926], [0.08795221149921417, 0.0905773863196373, 0.09215453267097473, 0.08762560784816742, 0.08915135264396667, 0.09012920409440994, 0.08730021864175797, 0.08882030099630356, 0.10575731843709946, 0.08778440207242966, 0.09274750202894211]], [[0.09184528887271881, 0.09371711313724518, 0.09352447837591171, 0.08870439976453781, 0.09314040839672089, 0.09013887494802475, 0.08995360136032104, 0.08976870775222778, 0.08958418667316437, 0.09218709915876389, 0.08743593841791153], [0.092298224568367, 0.09512966126203537, 0.09483696520328522, 0.08761149644851685, 0.094254270195961, 0.08974190801382065, 0.08946578949689865, 0.0891905203461647, 0.0889161005616188, 0.0928131565451622, 0.08574187010526657], [0.09225244075059891, 0.09498515725135803, 0.09470279514789581, 0.08772281557321548, 0.09414058923721313, 0.08978281170129776, 0.08951590955257416, 0.08924980461597443, 0.08898449689149857, 0.09274962544441223, 0.08591360598802567], [0.09104382991790771, 0.09130445867776871, 0.0912778452038765, 0.09059606492519379, 0.09122464060783386, 0.09080222249031067, 0.0907757505774498, 0.09074929356575012, 0.09072283655405045, 0.09109175950288773, 0.09041136503219604], [0.09216057509183884, 0.09469643235206604, 0.09443464875221252, 0.08794554322957993, 0.0939132571220398, 0.08986431360244751, 0.08961588889360428, 0.08936814963817596, 0.08912109583616257, 0.09262232482433319, 0.08625775575637817], [0.09141647070646286, 0.09241301566362381, 0.09231089055538177, 0.08972292393445969, 0.09210697561502457, 0.09049977362155914, 0.09039975702762604, 0.09029985219240189, 0.09020005911588669, 0.09159914404153824, 0.08903113752603531], [0.09136897325515747, 0.09227047115564346, 0.09217812120914459, 0.08983481675386429, 0.09199371188879013, 0.090538889169693, 0.0904482752084732, 0.09035775065422058, 0.09026732295751572, 0.09153429418802261, 0.08920735120773315], [0.09132138639688492, 0.09212803095579147, 0.09204544126987457, 0.08994674682617188, 0.09188047796487808, 0.09057790786027908, 0.09049671143293381, 0.0904155820608139, 0.09033452719449997, 0.09146937727928162, 0.0893838107585907], [0.0912737101316452, 0.09198569506406784, 0.09191282838582993, 0.09005869179964066, 0.09176727384328842, 0.09061682969331741, 0.09054505079984665, 0.09047332406044006, 0.09040166437625885, 0.09140438586473465, 0.08956050872802734], [0.09192933142185211, 0.0939764454960823, 0.09376560151576996, 0.08850293606519699, 0.09334532916545868, 0.09006645530462265, 0.08986438065767288, 0.08966276794672012, 0.08946159482002258, 0.09230287373065948, 0.08712230622768402], [0.09070470929145813, 0.09031467884778976, 0.09035438299179077, 0.09138134121894836, 0.09043382853269577, 0.09106876701116562, 0.09110879898071289, 0.09114884585142136, 0.09118891507387161, 0.09063276648521423, 0.09166289120912552]], [[0.09218112379312515, 0.09105221182107925, 0.09166154265403748, 0.09096499532461166, 0.09266471117734909, 0.09087786078453064, 0.09083432704210281, 0.09144220501184464, 0.08478879928588867, 0.09102865308523178, 0.09250353276729584], [0.08465354889631271, 0.08959583193063736, 0.08688587695360184, 0.08999208360910416, 0.08263827115297318, 0.09039008617401123, 0.0905897468328476, 0.08784972131252289, 0.12439879775047302, 0.08970265835523605, 0.08330341428518295], [0.08884994685649872, 0.09058670699596405, 0.08964245766401291, 0.0907231941819191, 0.08812257647514343, 0.09085988253355026, 0.09092830121517181, 0.08998048305511475, 0.10131897032260895, 0.09062354266643524, 0.08836392313241959], [0.08402599394321442, 0.08941059559583664, 0.08645452558994293, 0.08984354883432388, 0.08183879405260086, 0.09027859568595886, 0.09049691259860992, 0.08750491589307785, 0.12805870175361633, 0.08952730149030685, 0.08256012201309204], [0.09509331732988358, 0.0912141427397728, 0.09329380840063095, 0.09091917425394058, 0.09679002314805984, 0.09062515199184418, 0.09047850221395493, 0.0925413966178894, 0.07168786972761154, 0.09113439917564392, 0.0962221622467041], [0.08339214324951172, 0.089214026927948, 0.08601401001214981, 0.08968348056077957, 0.08103640377521515, 0.09015540033578873, 0.09039229899644852, 0.08715002238750458, 0.13180896639823914, 0.08934054523706436, 0.08181272447109222], [0.08307284116744995, 0.08911143243312836, 0.08579029142856598, 0.08959905058145523, 0.08063410967588425, 0.0900893434882164, 0.09033550322055817, 0.08696874231100082, 0.1337183713912964, 0.0892428308725357, 0.08143747597932816], [0.08737662434577942, 0.09028887748718262, 0.08870067447423935, 0.09051939845085144, 0.08616859465837479, 0.09075050055980682, 0.09086627513170242, 0.08926790952682495, 0.10914149135351181, 0.09035106748342514, 0.08656866103410721], [0.028098680078983307, 0.044341348111629486, 0.034639228135347366, 0.0459427684545517, 0.02315034717321396, 0.04760201275348663, 0.04845397174358368, 0.03785198926925659, 0.6204599142074585, 0.04476817324757576, 0.024691572412848473], [0.08448471873998642, 0.08954693377017975, 0.08677029609680176, 0.08995310962200165, 0.08242268860340118, 0.09036112576723099, 0.09056583046913147, 0.08775760233402252, 0.12537819147109985, 0.08965642005205154, 0.08310312777757645], [0.094141885638237, 0.09118695557117462, 0.09277471154928207, 0.09096107631921768, 0.09542541950941086, 0.09073574841022491, 0.09062330424785614, 0.09220124036073685, 0.07582736760377884, 0.09112591296434402, 0.09499642997980118]], [[0.09105245023965836, 0.09110012650489807, 0.08997587859630585, 0.09002301096916199, 0.09007015079259872, 0.09082406014204025, 0.09205525368452072, 0.09091921895742416, 0.0909668356180191, 0.09148252010345459, 0.09153042733669281], [0.09108054637908936, 0.09113775938749313, 0.08979038149118423, 0.08984678983688354, 0.08990323543548584, 0.09080658853054047, 0.09228505194187164, 0.09092071652412415, 0.09097783267498016, 0.09159679710865021, 0.09165433794260025], [0.09036923944950104, 0.09020232409238815, 0.09424524754285812, 0.0940711721777916, 0.09389742463827133, 0.0911741554737091, 0.08694092929363251, 0.09083767235279083, 0.0906698927283287, 0.0888780727982521, 0.08871392160654068], [0.09040111303329468, 0.09024357050657272, 0.09405510127544403, 0.09389118105173111, 0.09372755140066147, 0.09116064757108688, 0.08716180920600891, 0.09084317833185196, 0.09068486094474792, 0.08899303525686264, 0.08883793652057648], [0.09043283760547638, 0.09028466790914536, 0.09386516362428665, 0.09371136128902435, 0.09355781972408295, 0.09114696085453033, 0.08738309144973755, 0.09084852039813995, 0.09069966524839401, 0.08910796791315079, 0.08896196633577347], [0.09091538935899734, 0.09091745316982269, 0.09086858481168747, 0.09087064117193222, 0.09087270498275757, 0.09090550243854523, 0.09095852077007294, 0.09090963006019592, 0.09091168642044067, 0.09093394130468369, 0.09093600511550903], [0.09160463511943817, 0.0918530598282814, 0.0861387625336647, 0.08637236803770065, 0.08660659939050674, 0.09042233973741531, 0.09694448858499527, 0.09091344475746155, 0.09115999937057495, 0.09386486560106277, 0.09411942958831787], [0.09097301214933395, 0.09099407494068146, 0.09049578756093979, 0.09051673859357834, 0.09053770452737808, 0.09087203443050385, 0.09141471982002258, 0.09091413021087646, 0.09093517810106277, 0.0911627784371376, 0.09118388593196869], [0.09100157022476196, 0.09103214740753174, 0.09030970185995102, 0.0903400406241417, 0.09037039428949356, 0.09085503965616226, 0.09164340794086456, 0.09091611206531525, 0.09094665199518204, 0.09127714484930038, 0.09130781143903732], [0.0912991389632225, 0.0914328470826149, 0.08831382542848587, 0.08844316005706787, 0.08857268840074539, 0.09066049754619598, 0.0941375270485878, 0.09092624485492706, 0.09105940163135529, 0.09250960499048233, 0.0926450863480568], [0.09132570773363113, 0.09146900475025177, 0.08813020586967468, 0.08826848864555359, 0.0884069949388504, 0.09064146131277084, 0.09437086433172226, 0.0909261405467987, 0.0910688117146492, 0.09262353181838989, 0.09276887029409409]], [[0.09188168495893478, 0.09183767437934875, 0.0924522653222084, 0.09066951274871826, 0.09236370772123337, 0.09058266133069992, 0.09161791205406189, 0.09114517271518707, 0.08451337367296219, 0.09073296189308167, 0.0922030508518219], [0.09167319536209106, 0.09163885563611984, 0.09211810678243637, 0.09072599560022354, 0.09204909205436707, 0.0906580239534378, 0.09146731346845627, 0.09109800308942795, 0.08587189763784409, 0.09077564626932144, 0.09192385524511337], [0.09440887719392776, 0.09423641860485077, 0.09666562080383301, 0.08974374085664749, 0.09631277620792389, 0.08941617608070374, 0.09337883442640305, 0.09155356884002686, 0.06862527877092361, 0.08998362720012665, 0.09567508846521378], [0.08534335345029831, 0.0855497345328331, 0.0827213004231453, 0.09125211834907532, 0.08312185853719711, 0.09169398248195648, 0.08658913522958755, 0.08887681365013123, 0.130066379904747, 0.09093090146780014, 0.08385449647903442], [0.09403721243143082, 0.09388503432273865, 0.09602560102939606, 0.08990941941738129, 0.09571506828069687, 0.08961866796016693, 0.09312786161899567, 0.09151362627744675, 0.07089171558618546, 0.09012226015329361, 0.09515351802110672], [0.08480682969093323, 0.08502967655658722, 0.08197975158691406, 0.09120489656925201, 0.08241113275289536, 0.09168482571840286, 0.08615268021821976, 0.08862846344709396, 0.13404498994350433, 0.0908561497926712, 0.08320062607526779], [0.09060151875019073, 0.09061487019062042, 0.09042911231517792, 0.09097248315811157, 0.09045577794313431, 0.0909993126988411, 0.09068168699741364, 0.09082614630460739, 0.09296192973852158, 0.09095290303230286, 0.0905042439699173], [0.08811422437429428, 0.08822663128376007, 0.08667470514774323, 0.09128352999687195, 0.08689599484205246, 0.09151658415794373, 0.08879084140062332, 0.09002147614955902, 0.11006281524896622, 0.09111377596855164, 0.08729943633079529], [0.029429983347654343, 0.02995670773088932, 0.02340202033519745, 0.04811950773000717, 0.024247201159596443, 0.04985736683011055, 0.03273516893386841, 0.039645399898290634, 0.6498559713363647, 0.04688926413655281, 0.025861455127596855], [0.08572924137115479, 0.0859234556555748, 0.08325918018817902, 0.09127818048000336, 0.08363683521747589, 0.09169221669435501, 0.08690112084150314, 0.08905033767223358, 0.1272250860929489, 0.09097712486982346, 0.08432728797197342], [0.09334410727024078, 0.09322842210531235, 0.09485171735286713, 0.09019023925065994, 0.09461675584316254, 0.08996682614088058, 0.09265214204788208, 0.09141989797353745, 0.07518479228019714, 0.09035368263721466, 0.09419140219688416]]]}, "num_training_step_calls_per_iteration": 1, "evaluation": {"env_runners": {"module_to_env_connector": {"timers": {"connectors": {"remove_single_ts_time_rank_from_batch": 1.1729785076063684e-05, "get_actions": 3.5328258399037374e-05, "normalize_and_clip_actions": 7.774515066602518e-06, "listify_data_for_vector_env": 1.0322142583227116e-05, "tensor_to_numpy": 1.4678792411418038e-05, "un_batch_to_individual_items": 6.453956982030347e-06}}, "connector_pipeline_timer": 0.00011233954799192415}, "episode_len_max": 20, "num_agent_steps_sampled_lifetime": {"default_agent": 6800}, "num_module_steps_sampled_lifetime": {"default_policy": 6800}, "episode_return_max": 14.5, "env_reset_timer": 0.0005318868267853505, "rlmodule_inference_timer": 3.017545822908152e-05, "env_step_timer": 1.3895684538237536e-05, "env_to_module_connector": {"timers": {"connectors": {"add_states_from_episodes_to_batch": 2.6715800144411827e-06, "numpy_to_tensor": 1.1570208213472262e-05, "add_time_dim_to_batch_and_zero_pad": 7.099045083616102e-06, "add_observations_from_episodes_to_batch": 2.8192054833783316e-06, "batch_individual_items": 1.2299015142830258e-05}}, "connector_pipeline_timer": 5.86116495161748e-05}, "episode_len_min": 20, "env_to_module_sum_episodes_length_out": 10.368238394574323, "env_to_module_sum_episodes_length_in": 10.368238394574323, "num_env_steps_sampled_lifetime": 85400, "num_agent_steps_sampled": {"default_agent": 400}, "weights_seq_no": 17.0, "module_episode_returns_mean": {"default_policy": 1.85}, "episode_len_mean": 20.0, "sample": 0.12574474371299227, "agent_episode_returns_mean": {"default_agent": 1.85}, "episode_return_mean": 1.85, "episode_return_min": -12.5, "num_episodes": 20, "episode_duration_sec_mean": 0.005523390779271722, "num_module_steps_sampled": {"default_policy": 400}, "num_episodes_lifetime": 340, "num_env_steps_sampled": 400, "time_between_sampling": 9.454111187666005}, "num_healthy_workers": 1, "actor_manager_num_outstanding_async_reqs": 0, "num_remote_worker_restarts": 0}, "num_env_steps_sampled_lifetime": -9252500.0, "fault_tolerance": {"num_healthy_workers": 0, "num_remote_worker_restarts": 0}, "env_runner_group": {"actor_manager_num_outstanding_async_reqs": 0}, "done": false, "training_iteration": 17, "trial_id": "b9446_00000", "date": "2025-08-11_18-36-59", "timestamp": 1754930219, "time_this_iter_s": 9.56480097770691, "time_total_s": 166.13181066513062, "pid": 11415, "hostname": "Mac", "node_ip": "127.0.0.1", "config": {"exploration_config": {}, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 2, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "env": "Umbrella", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": false, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 0, "create_local_env_runner": true, "num_envs_per_env_runner": 1, "gym_env_vectorize_mode": "SYNC", "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "episodes_to_numpy": true, "max_requests_in_flight_per_env_runner": 1, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "merge_env_runner_states": "training_only", "broadcast_env_runner_states": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "complete_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "sampler_perf_stats_ema_coef": null, "_is_online": true, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": "auto", "num_aggregator_actors_per_learner": 0, "max_requests_in_flight_per_aggregator_actor": 3, "local_gpu_idx": 0, "max_requests_in_flight_per_learner": 3, "gamma": 1, "lr": 0.0002715581955, "grad_clip": 0.5, "grad_clip_by": "global_norm", "_train_batch_size_per_learner": 5000, "train_batch_size": 4000, "num_epochs": 1, "minibatch_size": 1000, "shuffle_batch_per_epoch": true, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "log_std_clip_param": 20.0, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "_disable_preprocessor_api": false, "_disable_action_flattening": false}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {"intrinsic_reward_coeff": 0.2795015916508}, "optimizer": {}, "_learner_class": "<class 'source.intrinsic_attention_ppo.learners.IntrinsicAttentionMetaLearner.IntrinsicAttentionMetaLearner'>", "callbacks_on_algorithm_init": null, "callbacks_on_env_runners_recreated": null, "callbacks_on_offline_eval_runners_recreated": null, "callbacks_on_checkpoint_loaded": null, "callbacks_on_environment_created": null, "callbacks_on_episode_created": null, "callbacks_on_episode_start": null, "callbacks_on_episode_step": null, "callbacks_on_episode_end": null, "callbacks_on_evaluate_start": null, "callbacks_on_evaluate_end": null, "callbacks_on_evaluate_offline_start": null, "callbacks_on_evaluate_offline_end": null, "callbacks_on_sample_end": null, "callbacks_on_train_result": null, "explore": true, "enable_rl_module_and_learner": true, "enable_env_runner_and_connector_v2": true, "_prior_exploration_config": {"type": "StochasticSampling"}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x3884998a0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "offline_data_class": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_read_batch_size": null, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "materialize_data": false, "materialize_mapped_data": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "ignore_final_observation": false, "prelearner_class": null, "prelearner_buffer_class": null, "prelearner_buffer_kwargs": {}, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_remaining_data": false, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": 1, "evaluation_duration": 20, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_auto_duration_min_env_steps_per_sample": 100, "evaluation_auto_duration_max_env_steps_per_sample": 2000, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 1, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "offline_evaluation_interval": null, "num_offline_eval_runners": 0, "offline_loss_for_module_fn": null, "offline_evaluation_duration": 1, "offline_evaluation_parallel_to_training": false, "offline_evaluation_timeout_s": 120.0, "num_cpus_per_offline_eval_runner": 1, "num_gpus_per_offline_eval_runner": 0, "custom_resources_per_offline_eval_runner": {}, "restart_failed_offline_eval_runners": true, "ignore_offline_eval_runner_failures": false, "max_num_offline_eval_runner_restarts": 1000, "offline_eval_runner_restore_timeout_s": 1800.0, "max_requests_in_flight_per_offline_eval_runner": 1, "validate_offline_eval_runners_after_construction": true, "offline_eval_runner_health_probe_timeout_s": 30.0, "offline_eval_rl_module_inference_only": false, "broadcast_offline_eval_runner_states": false, "offline_eval_batch_size_per_runner": 256, "dataset_num_iters_per_eval_runner": 1, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "log_gradients": false, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 7, "restart_failed_env_runners": true, "ignore_env_runner_failures": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30.0, "env_runner_restore_timeout_s": 1800.0, "_model_config": {}, "_rl_module_spec": "MultiRLModuleSpec(multi_rl_module_class=<class 'ray.rllib.core.rl_module.multi_rl_module.MultiRLModule'>, observation_space=None, action_space=None, inference_only=False, model_config=None, rl_module_specs={'default_policy': RLModuleSpec(module_class=<class 'source.intrinsic_attention_ppo.rl_modules.DifferentiablePPOModule.DifferentiablePPOModule'>, observation_space=None, action_space=None, inference_only=False, learner_only=False, model_config={'vf_share_layers': True, 'embedding_dim': 62, 'max_seq_len': 11, 'policy_head_hidden_sizes': [32], 'value_head_hidden_sizes': [101], 'embedding_hidden_sizes': [121]}, catalog_class=None, load_state_path=None, model_config_dict=None), 'intrinsic_reward_module': RLModuleSpec(module_class=<class 'source.intrinsic_attention_ppo.rl_modules.IntrinsicAttentionModule.IntrinsicAttentionModule'>, observation_space=None, action_space=None, inference_only=False, learner_only=True, model_config={'intrinsic_reward_network': {'encoder_hidden_sizes': [], 'encoding_dim': 1, 'num_heads': 1, 'head_hidden_sizes': None, 'layers': [{'type': 'attention'}]}, 'extrinsic_value_hidden_layers': [127, 60], 'vf_share_layers': True, 'max_seq_len': 11}, catalog_class=None, load_state_path=None, model_config_dict=None)}, load_state_path=None, modules_to_load=None, module_specs={'default_policy': RLModuleSpec(module_class=<class 'source.intrinsic_attention_ppo.rl_modules.DifferentiablePPOModule.DifferentiablePPOModule'>, observation_space=None, action_space=None, inference_only=False, learner_only=False, model_config={'vf_share_layers': True, 'embedding_dim': 62, 'max_seq_len': 11, 'policy_head_hidden_sizes': [32], 'value_head_hidden_sizes': [101], 'embedding_hidden_sizes': [121]}, catalog_class=None, load_state_path=None, model_config_dict=None), 'intrinsic_reward_module': RLModuleSpec(module_class=<class 'source.intrinsic_attention_ppo.rl_modules.IntrinsicAttentionModule.IntrinsicAttentionModule'>, observation_space=None, action_space=None, inference_only=False, learner_only=True, model_config={'intrinsic_reward_network': {'encoder_hidden_sizes': [], 'encoding_dim': 1, 'num_heads': 1, 'head_hidden_sizes': None, 'layers': [{'type': 'attention'}]}, 'extrinsic_value_hidden_layers': [127, 60], 'vf_share_layers': True, 'max_seq_len': 11}, catalog_class=None, load_state_path=None, model_config_dict=None)})", "algorithm_config_overrides_per_module": {"intrinsic_reward_module": {"lr": 0.0002715581955}}, "_per_module_overrides": {}, "_validate_config": true, "_use_msgpack_checkpoints": false, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "env_task_fn": -1, "enable_connectors": -1, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.161583927863, "kl_target": 0.0201019014258, "vf_loss_coeff": 0.7790510010087, "entropy_coeff": 0.0015431216992, "clip_param": 0.2459212356676, "vf_clip_param": 0.3769744131561, "entropy_coeff_schedule": null, "lr_schedule": null, "sgd_minibatch_size": -1, "vf_share_layers": -1, "differentiable_learner_configs": ["DifferentiableLearnerConfig(learner_class=<class 'source.intrinsic_attention_ppo.learners.IntrinsicAttentionPPOLearner.IntrinsicAttentionPPOLearner'>, learner_connector=None, add_default_connectors_to_learner_pipeline=True, is_multi_agent=False, policies_to_update=['default_policy'], lr=0.0060984166342, num_total_minibatches=0, num_epochs=1, minibatch_size=1000, shuffle_batch_per_epoch=True)"], "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9485408017724, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.callbacks.callbacks.RLlibCallback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 166.13181066513062, "iterations_since_restore": 17, "perf": {"cpu_util_percent": 43.00714285714286, "ram_util_percent": 80.91428571428571}}
{"timers": {"training_iteration": 10.13128912082788, "restore_env_runners": 1.2466017054919558e-05, "training_step": 10.131081320740213, "env_runner_sampling_timer": 2.454005953262061, "learner_update_timer": 7.422573642052034, "synch_weights": 0.001729189804782217, "restore_eval_env_runners": 4.3786866471155985e-05, "evaluation_iteration": 0.1370360814744172, "synch_eval_env_connectors": 0.00018333197708034834, "synch_env_connectors": 4.675742258866919e-06}, "env_runners": {"env_reset_timer": 5.193483410535957e-05, "num_episodes_lifetime": -493500.0, "num_env_steps_sampled_lifetime": -9870000.0, "num_env_steps_sampled": 5000.0, "module_to_env_connector": {"timers": {"connectors": {"remove_single_ts_time_rank_from_batch": 1.2542357963451733e-05, "get_actions": 4.7600000680846016e-05, "listify_data_for_vector_env": 1.1260889403043644e-05, "tensor_to_numpy": 1.6962261588247582e-05, "un_batch_to_individual_items": 7.019185355160105e-06, "normalize_and_clip_actions": 8.485489283871886e-06}}, "connector_pipeline_timer": 0.00013185876370381527}, "module_episode_returns_mean": {"default_policy": 0.9800000000000004}, "time_between_sampling": 0.03221364407824914, "rlmodule_inference_timer": 3.556992370811057e-05, "env_step_timer": 1.6052691128784002e-05, "env_to_module_connector": {"timers": {"connectors": {"batch_individual_items": 1.3316040763534793e-05, "add_observations_from_episodes_to_batch": 3.088530951296835e-06, "add_states_from_episodes_to_batch": 2.876873231817583e-06, "numpy_to_tensor": 1.4920764001190364e-05, "add_time_dim_to_batch_and_zero_pad": 7.856382607391132e-06}}, "connector_pipeline_timer": 6.563234330229094e-05}, "weights_seq_no": 17.0, "num_agent_steps_sampled": {"default_agent": 5000.0}, "episode_len_min": 20, "episode_len_mean": 20.0, "num_episodes": 250.0, "sample": 0.00630565976530826, "episode_duration_sec_mean": 0.005837447465397416, "episode_len_max": 20, "num_module_steps_sampled": {"default_policy": 5000.0}, "num_agent_steps_sampled_lifetime": {"default_agent": -9870000.0}, "num_module_steps_sampled_lifetime": {"default_policy": -9870000.0}, "env_to_module_sum_episodes_length_out": 10.36823839457432, "agent_episode_returns_mean": {"default_agent": 0.9800000000000004}, "episode_return_max": 10.5, "episode_return_min": -9.5, "env_to_module_sum_episodes_length_in": 10.36823839457432, "episode_return_mean": 0.9800000000000004, "num_env_steps_sampled_lifetime_throughput": 3025.0503792980344}, "__all_modules__": {"learner_connector_sum_episodes_length_in": 5000.0, "learner_connector": {"connector_pipeline_timer": 0.21180150768651151, "timers": {"connectors": {"add_one_ts_to_episodes_and_truncate": 0.009207830772753327, "add_observations_from_episodes_to_batch": 0.0009600982663077619, "add_columns_from_episodes_to_train_batch": 0.0930209231351016, "add_time_dim_to_batch_and_zero_pad": 0.08681343497162537, "add_states_from_episodes_to_batch": 0.0036204028226366662, "batch_individual_items": 0.017897856277139954, "numpy_to_tensor": 8.788143537766902e-05}}}, "learner_connector_sum_episodes_length_out": 5250.0}, "learners": {"differentiable_learners": {"intrinsic_attention_ppo_learner": {"intrinsic_reward_module": {"num_module_steps_trained_lifetime": 646380, "weights_seq_no": 108.0, "total_loss": 0.0, "num_module_steps_trained": 35910, "diff_num_grad_updates_vs_sampler_policy": 91.0, "module_train_batch_size_mean": 997.4982334615715}, "default_policy": {"module_train_batch_size_mean": 997.4982334615715, "use_intrinsic_rewards": 1.0, "num_module_steps_trained_lifetime": 646380, "policy_loss": -3.9837759686633945e-06, "mean_kl_loss": 3.5713692341232672e-06, "entropy": 0.693103551864624, "weights_seq_no": 108.0, "vf_loss_unclipped": 43.849124908447266, "vf_loss": 0.35833707451820374, "total_loss": 0.2780899107456207, "vf_explained_var": -0.001244187355041504, "num_module_steps_trained": 35910, "diff_num_grad_updates_vs_sampler_policy": 91.0}, "__all_modules__": {"num_env_steps_trained_lifetime": 3564000, "num_module_steps_trained": 71820, "num_module_steps_trained_lifetime": 1292760, "num_env_steps_trained": 198000, "num_env_steps_trained_lifetime_throughput": 45308.35262798333}}}, "intrinsic_reward_module": {"num_module_steps_trained": 5985, "curr_entropy_coeff": 0.0015431216992, "total_loss": 0.0, "num_module_steps_trained_lifetime": 107730, "gradients_default_optimizer_global_norm": 0.0, "diff_num_grad_updates_vs_sampler_policy": 1.0, "module_train_batch_size_mean": 997.6672132667843, "default_optimizer_learning_rate": 0.0002715581955, "num_trainable_parameters": 8266, "weights_seq_no": 18.0, "num_module_steps_trained_lifetime_throughput": 775.9414958737092}, "__all_modules__": {"num_trainable_parameters": 24861, "num_non_trainable_parameters": 0, "num_env_steps_trained_lifetime": 594000, "num_module_steps_trained": 11970, "num_module_steps_trained_lifetime": 215460, "num_env_steps_trained": 33000, "num_env_steps_trained_lifetime_throughput": 4279.450999090127, "num_module_steps_trained_throughput": 21250318.34085674, "num_module_steps_trained_lifetime_throughput": 12911369.260060782}, "default_policy": {"vf_loss": 0.3583044707775116, "weights_seq_no": 18.0, "curr_entropy_coeff": 0.0015431216992, "vf_loss_unclipped": 43.76857376098633, "total_loss": 0.2780630886554718, "vf_explained_var": -0.00041997432708740234, "num_module_steps_trained": 5985, "diff_num_grad_updates_vs_sampler_policy": 1.0, "curr_kl_coeff": 6.163937769088079e-07, "use_intrinsic_rewards": 0.0, "module_train_batch_size_mean": 997.6672132667843, "num_module_steps_trained_lifetime": 107730, "policy_loss": -4.832309969060589e-06, "num_trainable_parameters": 16595, "mean_kl_loss": 3.5095915791316656e-06, "entropy": 0.6931033730506897, "num_module_steps_trained_lifetime_throughput": 775.9330768649538}, "IntrinsicAttentionMask": [[[0.09353234618902206, 0.09070627391338348, 0.09524238854646683, 0.09033376723527908, 0.09485125541687012, 0.087242990732193, 0.08706367015838623, 0.08688471466302872, 0.09122972190380096, 0.0892254114151001, 0.09368747472763062], [0.09154916554689407, 0.09086861461400986, 0.09195344150066376, 0.09077772498130798, 0.09186146408319473, 0.09001237899065018, 0.08996734768152237, 0.08992233872413635, 0.09099586308002472, 0.09050557762384415, 0.09158606827259064], [0.09469649940729141, 0.0905846357345581, 0.09721177071332932, 0.09004687517881393, 0.09663466364145279, 0.08562330901622772, 0.08536878228187561, 0.08511500060558319, 0.09134197980165482, 0.08845267444849014, 0.09492383152246475], [0.09128216654062271, 0.0908862054347992, 0.09151679277420044, 0.09083322435617447, 0.09146344661712646, 0.0903862714767456, 0.09035991877317429, 0.09033358842134476, 0.09096033871173859, 0.09067448228597641, 0.09130359441041946], [0.09443258494138718, 0.0906139463186264, 0.09676272422075272, 0.09011363983154297, 0.0962284728884697, 0.08599014580249786, 0.08575242757797241, 0.08551537245512009, 0.09131818264722824, 0.08862925320863724, 0.09464336186647415], [0.08901514858007431, 0.09099519997835159, 0.08786617964506149, 0.09126411378383636, 0.08812583237886429, 0.09357110410928726, 0.09370926022529602, 0.09384762495756149, 0.09062051773071289, 0.09207561612129211, 0.08890943974256516], [0.088880755007267, 0.09099940955638885, 0.08765287697315216, 0.09128739684820175, 0.08793026953935623, 0.09376050531864166, 0.09390874207019806, 0.09405722469091415, 0.09059824049472809, 0.09215682744979858, 0.08876773715019226], [0.0887463241815567, 0.09100337326526642, 0.08743986487388611, 0.09131044149398804, 0.0877349004149437, 0.09395003318786621, 0.09410840272903442, 0.09426704049110413, 0.09057572484016418, 0.09223787486553192, 0.08862601965665817], [0.09192214906215668, 0.0908423587679863, 0.09256581217050552, 0.0906984955072403, 0.09241922199726105, 0.08949051052331924, 0.08941962569952011, 0.08934879302978516, 0.09104390442371368, 0.09026828408241272, 0.09198083728551865], [0.09047983586788177, 0.09093299508094788, 0.09021329134702682, 0.09099394828081131, 0.09027376770973206, 0.09151125699281693, 0.09154192358255386, 0.0915725976228714, 0.09084783494472504, 0.09117705374956131, 0.09045542031526566], [0.0936390608549118, 0.09069594740867615, 0.0954216942191124, 0.0903082937002182, 0.09501384198665619, 0.08709435164928436, 0.08690802752971649, 0.08672209829092026, 0.091240793466568, 0.08915524184703827, 0.09380071610212326]], [[0.09048162400722504, 0.08608150482177734, 0.08805742114782333, 0.08644414693117142, 0.08842839300632477, 0.09143760055303574, 0.0916300043463707, 0.08898777514696121, 0.11767715960741043, 0.08617927134037018, 0.08459507673978806], [0.09090971946716309, 0.09172126650810242, 0.09135092794895172, 0.09165254980325699, 0.09128248691558838, 0.09073954820632935, 0.09070555120706558, 0.09117992222309113, 0.0867488756775856, 0.09170269966125488, 0.09200651943683624], [0.09084166586399078, 0.08923425525426865, 0.0899624451994896, 0.08936870098114014, 0.09009799361228943, 0.09118422120809555, 0.0912528932094574, 0.09030168503522873, 0.0998062863945961, 0.08927053958177567, 0.08867935091257095], [0.09091198444366455, 0.0912703201174736, 0.09110701829195023, 0.0912400484085083, 0.0910767987370491, 0.09083662182092667, 0.09082155674695969, 0.09103149175643921, 0.08904614299535751, 0.09126214683055878, 0.09139585494995117], [0.09080660343170166, 0.08875905722379684, 0.08968538790941238, 0.0889299288392067, 0.0898580402135849, 0.09124426543712616, 0.09133204817771912, 0.09011764079332352, 0.10240724682807922, 0.08880516141653061, 0.08805457502603531], [0.09025325626134872, 0.08480749279260635, 0.08724461495876312, 0.0852537527680397, 0.08770370483398438, 0.09144525229930878, 0.09168554097414017, 0.08839686959981918, 0.12529848515987396, 0.0849277600646019, 0.08298321813344955], [0.09020130336284637, 0.08454899489879608, 0.0870768204331398, 0.08501166105270386, 0.08755331486463547, 0.0914403423666954, 0.09169019013643265, 0.08827294409275055, 0.12687204778194427, 0.0846736803650856, 0.08265873044729233], [0.09074016660451889, 0.08803755044937134, 0.08925775438547134, 0.08826231956481934, 0.08948563784360886, 0.0913204476237297, 0.0914369523525238, 0.08982855081558228, 0.10642006993293762, 0.0880981832742691, 0.08711234480142593], [0.06613457947969437, 0.046163614839315414, 0.05437199026346207, 0.04758455976843834, 0.056045591831207275, 0.07134182006120682, 0.07243146747350693, 0.058653078973293304, 0.44001588225364685, 0.04654305800795555, 0.04071437940001488], [0.09091097116470337, 0.09159992635250092, 0.09128564596176147, 0.09154162555932999, 0.09122754633426666, 0.09076639264822006, 0.09073749929666519, 0.09114046394824982, 0.08736388385295868, 0.09158417582511902, 0.09184187650680542], [0.09083288908004761, 0.09354405105113983, 0.0922999382019043, 0.0933123305439949, 0.0920713022351265, 0.09027142077684402, 0.09015954285860062, 0.09172940254211426, 0.07778743654489517, 0.09348142892122269, 0.09451029449701309]], [[0.0914299488067627, 0.08866739273071289, 0.09310154616832733, 0.09291017800569534, 0.09271920472383499, 0.08973125368356705, 0.0895468220114708, 0.08936276286840439, 0.08917907625436783, 0.09177020937204361, 0.09158158302307129], [0.09103798866271973, 0.09036123752593994, 0.09144000709056854, 0.09139426052570343, 0.0913485437631607, 0.09062372148036957, 0.09057838469743729, 0.09053307771682739, 0.09048778563737869, 0.09112027287483215, 0.09107469022274017], [0.09165482223033905, 0.08767503499984741, 0.09408929944038391, 0.0938095971941948, 0.09353072941303253, 0.0892011970281601, 0.08893603086471558, 0.08867164701223373, 0.08840805292129517, 0.0921487808227539, 0.0918748527765274], [0.09162953495979309, 0.0877874419093132, 0.09397688508033752, 0.09370730072259903, 0.09343849867582321, 0.0892615094780922, 0.08900545537471771, 0.08875013887882233, 0.08849555253982544, 0.09210599213838577, 0.09184177964925766], [0.09160418063402176, 0.08789990842342377, 0.09386452287435532, 0.09360504150390625, 0.09334627538919449, 0.08932178467512131, 0.08907485753297806, 0.08882861584424973, 0.08858305960893631, 0.09206313639879227, 0.09180863946676254], [0.09119202196598053, 0.08970078080892563, 0.09208424389362335, 0.09198247641324997, 0.09188082069158554, 0.09027757495641708, 0.09017780423164368, 0.09007814526557922, 0.08997859805822372, 0.0913742408156395, 0.09127326309680939], [0.09116560220718384, 0.08981454372406006, 0.0919729545712471, 0.0918809026479721, 0.09178894758224487, 0.0903373658657074, 0.09024695307016373, 0.09015662968158722, 0.09006640315055847, 0.09133055806159973, 0.09123914688825607], [0.09113910794258118, 0.08992836624383926, 0.09186171740293503, 0.09177936613559723, 0.0916970893740654, 0.09039711952209473, 0.09031607955694199, 0.09023511409759521, 0.09015421569347382, 0.091286800801754, 0.09120496362447739], [0.09111256152391434, 0.09004228562116623, 0.09175055474042892, 0.09167787432670593, 0.09160525351762772, 0.09045684337615967, 0.09038519114255905, 0.09031359106302261, 0.09024205058813095, 0.09124301373958588, 0.09117073565721512], [0.0914764553308487, 0.0884634479880333, 0.09330367296934128, 0.0930943414568901, 0.09288547188043594, 0.08962275832891464, 0.08942168205976486, 0.0892210528254509, 0.08902087807655334, 0.09184814989566803, 0.09164208173751831], [0.09145072102546692, 0.08857639133930206, 0.09319169819355011, 0.09299232810735703, 0.09279338270425797, 0.08968287706375122, 0.08949100971221924, 0.08929955214262009, 0.08910850435495377, 0.09180501103401184, 0.09160860627889633]], [[0.09218170493841171, 0.09213754534721375, 0.09166212379932404, 0.09096556901931763, 0.09157431870698929, 0.0908784344792366, 0.09083490073680878, 0.0914427787065506, 0.08478932827711105, 0.09102921932935715, 0.0925041139125824], [0.09190674126148224, 0.09187230467796326, 0.09150135517120361, 0.09095712006092072, 0.09143280982971191, 0.09088897705078125, 0.09085492789745331, 0.09133008122444153, 0.08609065413475037, 0.09100689738988876, 0.09215803444385529], [0.08885125815868378, 0.08891817182302475, 0.08964378386735916, 0.09072454273700714, 0.0897788554430008, 0.0908612385392189, 0.09092965722084045, 0.08998183161020279, 0.10132048279047012, 0.09062489122152328, 0.08836523443460464], [0.08403835445642471, 0.08424157649278641, 0.08646724373102188, 0.08985676616430283, 0.08688593655824661, 0.09029187262058258, 0.09051021933555603, 0.08751779049634933, 0.1280774474143982, 0.08954046666622162, 0.08257226645946503], [0.0882672369480133, 0.08835216611623764, 0.08927424252033234, 0.09065145999193192, 0.08944610506296158, 0.09082597494125366, 0.09091335535049438, 0.08970452100038528, 0.10438968241214752, 0.09052428603172302, 0.08765091001987457], [0.08340653777122498, 0.08362569659948349, 0.08602885901927948, 0.08969895541667938, 0.08648154884576797, 0.0901709645986557, 0.09040790051221848, 0.08716505765914917, 0.13183161616325378, 0.0893559679389, 0.08182685077190399], [0.08308830112218857, 0.08331532776355743, 0.08580625802278519, 0.08961572498083115, 0.08627580106258392, 0.09010611474514008, 0.09035231173038483, 0.08698493242263794, 0.13374316692352295, 0.08925943821668625, 0.0814526379108429], [0.0873803049325943, 0.08749177306890488, 0.088704414665699, 0.09052321314811707, 0.0889308825135231, 0.09075432270765305, 0.09087010473012924, 0.0892716720700264, 0.10914608091115952, 0.09035486727952957, 0.0865723043680191], [0.02818337082862854, 0.02868778631091118, 0.03474363312125206, 0.04608121141791344, 0.035998426377773285, 0.04774545505642891, 0.04859999567270279, 0.03796607628464699, 0.6223250031471252, 0.04490308836102486, 0.02476600743830204], [0.0844956710934639, 0.08468708395957947, 0.08678155392408371, 0.08996476978063583, 0.08717518299818039, 0.09037283807992935, 0.09057756513357162, 0.08776898682117462, 0.12539438903331757, 0.08966804295778275, 0.083113893866539], [0.09414586424827576, 0.09402918070554733, 0.09277862310409546, 0.0909649133682251, 0.09254879504442215, 0.09073957800865173, 0.09062711894512177, 0.09220512956380844, 0.07583058625459671, 0.09112975746393204, 0.09500043839216232]], [[0.09443217515945435, 0.091578908264637, 0.09139067679643631, 0.09120282530784607, 0.09101536124944687, 0.08808232843875885, 0.09248721599578857, 0.0877205953001976, 0.09210740029811859, 0.09008380770683289, 0.08989864587783813], [0.09175705164670944, 0.09107495844364166, 0.09102939069271088, 0.09098386019468307, 0.09093833714723587, 0.09021677821874619, 0.0912938117980957, 0.09012653678655624, 0.0912024974822998, 0.0907110944390297, 0.09066571295261383], [0.0915796160697937, 0.09104049205780029, 0.09100445359945297, 0.09096842259168625, 0.09093240648508072, 0.09036099910736084, 0.09121357649564743, 0.09028947353363037, 0.09114136546850204, 0.09075256437063217, 0.09071663022041321], [0.09140243381261826, 0.09100595861673355, 0.0909794270992279, 0.09095291048288345, 0.0909264013171196, 0.09050536155700684, 0.09113330394029617, 0.09045261144638062, 0.0910801887512207, 0.09079395234584808, 0.09076748788356781], [0.09122548997402191, 0.09097133576869965, 0.09095431119203568, 0.0909372940659523, 0.09092027693986893, 0.09064985811710358, 0.09105301648378372, 0.09061594307422638, 0.09101894497871399, 0.09083526581525803, 0.09081827104091644], [0.08844179660081863, 0.09040909260511398, 0.09054258465766907, 0.09067627787590027, 0.09081015735864639, 0.0929684042930603, 0.08977153152227402, 0.09324314445257187, 0.09003682434558868, 0.09148254990577698, 0.0916176289319992], [0.09261157363653183, 0.0912390872836113, 0.0911477729678154, 0.09105655550956726, 0.09096542745828629, 0.08952686190605164, 0.09167835861444473, 0.08934775739908218, 0.09149494767189026, 0.09051113575696945, 0.09042055159807205], [0.088096484541893, 0.09033700823783875, 0.09048929065465927, 0.09064182639122009, 0.0907946228981018, 0.09326208382844925, 0.08961012959480286, 0.09357677400112152, 0.08991249650716782, 0.09156247228384018, 0.09171681106090546], [0.09225457161664963, 0.09117086976766586, 0.09109865874052048, 0.09102649241685867, 0.09095438569784164, 0.08981414139270782, 0.09151808172464371, 0.08967190235853195, 0.09137315303087234, 0.09059471637010574, 0.09052295237779617], [0.09034449607133865, 0.09079697728157043, 0.09082740545272827, 0.0908578485250473, 0.09088829159736633, 0.09137437492609024, 0.09065117686986923, 0.09143562614917755, 0.09071194380521774, 0.09104067832231522, 0.09107118844985962], [0.0901690348982811, 0.09076187014579773, 0.09080176055431366, 0.09084168076515198, 0.09088160842657089, 0.09151969105005264, 0.09057074040174484, 0.09160016477108002, 0.09065038710832596, 0.09108152985572815, 0.09112156927585602]], [[0.09911933541297913, 0.0918089970946312, 0.09506756067276001, 0.100084587931633, 0.08834097534418106, 0.09300301223993301, 0.10105925053358078, 0.09661556780338287, 0.05661361292004585, 0.09196929633617401, 0.08631774038076401], [0.09293137490749359, 0.09128500521183014, 0.0920308455824852, 0.09314173460006714, 0.09046858549118042, 0.09156062453985214, 0.09335257112979889, 0.09237831085920334, 0.08154793083667755, 0.0913221687078476, 0.08998088538646698], [0.0958314836025238, 0.09164992719888687, 0.09353040903806686, 0.09637384116649628, 0.08961767703294754, 0.09234216064214706, 0.09691926836967468, 0.09441429376602173, 0.06916122138500214, 0.09174308180809021, 0.0884166732430458], [0.09985634684562683, 0.09180697053670883, 0.09538757055997849, 0.10092359781265259, 0.08800973743200302, 0.09311757981777191, 0.10200224816799164, 0.09709276258945465, 0.054019249975681305, 0.09198283404111862, 0.08580109477043152], [0.08955339342355728, 0.0906025841832161, 0.09012343734502792, 0.08942155539989471, 0.09113453328609467, 0.09042476862668991, 0.08928989619016647, 0.08990240097045898, 0.09751274436712265, 0.09057855606079102, 0.0914561077952385], [0.09402287006378174, 0.09144670516252518, 0.09261060506105423, 0.09435386955738068, 0.0901787057518959, 0.09187619388103485, 0.09468603134155273, 0.09315460920333862, 0.07674167305231094, 0.09150458127260208, 0.0894242525100708], [0.10058394819498062, 0.09179134666919708, 0.09569448232650757, 0.1017545610666275, 0.08766677230596542, 0.09321848303079605, 0.10293880105018616, 0.09755785018205643, 0.05153615027666092, 0.09198274463415146, 0.08527490496635437], [0.09712648391723633, 0.09174521267414093, 0.09415696561336517, 0.09782929718494415, 0.08915422856807709, 0.09263144433498383, 0.09853719174861908, 0.09529523551464081, 0.06402891129255295, 0.09186436235904694, 0.08763065189123154], [0.03823064640164375, 0.05440346151590347, 0.04633162543177605, 0.03656207397580147, 0.06495793908834457, 0.0512608140707016, 0.03496633097529411, 0.04301067069172859, 0.5040368437767029, 0.05396817624568939, 0.07227129489183426], [0.09307993948459625, 0.09130872040987015, 0.09211082756519318, 0.09330641478300095, 0.09043128043413162, 0.09160507470369339, 0.09353344887495041, 0.09248466789722443, 0.08088354766368866, 0.09134867787361145, 0.08990740031003952], [0.08742615580558777, 0.09003563970327377, 0.08883818238973618, 0.08710150420665741, 0.0913764163851738, 0.08959012478590012, 0.08677805960178375, 0.0882890447974205, 0.10839679837226868, 0.08997535705566406, 0.09219276160001755]]]}, "num_training_step_calls_per_iteration": 1, "evaluation": {"env_runners": {"module_to_env_connector": {"timers": {"connectors": {"remove_single_ts_time_rank_from_batch": 1.1755347796399358e-05, "get_actions": 3.567444252796185e-05, "normalize_and_clip_actions": 7.841003196103951e-06, "listify_data_for_vector_env": 1.0358091598483105e-05, "tensor_to_numpy": 1.467413007774363e-05, "un_batch_to_individual_items": 6.454562940235345e-06}}, "connector_pipeline_timer": 0.00011293986705340487}, "episode_len_max": 20, "num_agent_steps_sampled_lifetime": {"default_agent": 7200}, "num_module_steps_sampled_lifetime": {"default_policy": 7200}, "episode_return_max": 14.5, "env_reset_timer": 0.0005274350489382945, "rlmodule_inference_timer": 3.034723216798958e-05, "env_step_timer": 1.4211265840778478e-05, "env_to_module_connector": {"timers": {"connectors": {"add_states_from_episodes_to_batch": 2.690693779688697e-06, "numpy_to_tensor": 1.1777061751820147e-05, "add_time_dim_to_batch_and_zero_pad": 7.206136445791007e-06, "add_observations_from_episodes_to_batch": 2.8566518324999733e-06, "batch_individual_items": 1.2438116166506412e-05}}, "connector_pipeline_timer": 5.9510256233449244e-05}, "episode_len_min": 20, "env_to_module_sum_episodes_length_out": 10.368238394574323, "env_to_module_sum_episodes_length_in": 10.368238394574323, "num_env_steps_sampled_lifetime": 90400, "num_agent_steps_sampled": {"default_agent": 400}, "weights_seq_no": 18.0, "module_episode_returns_mean": {"default_policy": 1.05}, "episode_len_mean": 20.0, "sample": 0.1256163983564571, "agent_episode_returns_mean": {"default_agent": 1.05}, "episode_return_mean": 1.05, "episode_return_min": -12.5, "num_episodes": 20, "episode_duration_sec_mean": 0.005394138286355883, "num_module_steps_sampled": {"default_policy": 400}, "num_episodes_lifetime": 360, "num_env_steps_sampled": 400, "time_between_sampling": 9.450842502879787}, "num_healthy_workers": 1, "actor_manager_num_outstanding_async_reqs": 0, "num_remote_worker_restarts": 0}, "num_env_steps_sampled_lifetime": -9870000.0, "fault_tolerance": {"num_healthy_workers": 0, "num_remote_worker_restarts": 0}, "env_runner_group": {"actor_manager_num_outstanding_async_reqs": 0}, "done": false, "training_iteration": 18, "trial_id": "b9446_00000", "date": "2025-08-11_18-37-09", "timestamp": 1754930229, "time_this_iter_s": 9.221399068832397, "time_total_s": 175.353209733963, "pid": 11415, "hostname": "Mac", "node_ip": "127.0.0.1", "config": {"exploration_config": {}, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 2, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "env": "Umbrella", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": false, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 0, "create_local_env_runner": true, "num_envs_per_env_runner": 1, "gym_env_vectorize_mode": "SYNC", "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "episodes_to_numpy": true, "max_requests_in_flight_per_env_runner": 1, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "merge_env_runner_states": "training_only", "broadcast_env_runner_states": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "complete_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "sampler_perf_stats_ema_coef": null, "_is_online": true, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": "auto", "num_aggregator_actors_per_learner": 0, "max_requests_in_flight_per_aggregator_actor": 3, "local_gpu_idx": 0, "max_requests_in_flight_per_learner": 3, "gamma": 1, "lr": 0.0002715581955, "grad_clip": 0.5, "grad_clip_by": "global_norm", "_train_batch_size_per_learner": 5000, "train_batch_size": 4000, "num_epochs": 1, "minibatch_size": 1000, "shuffle_batch_per_epoch": true, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "log_std_clip_param": 20.0, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "_disable_preprocessor_api": false, "_disable_action_flattening": false}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {"intrinsic_reward_coeff": 0.2795015916508}, "optimizer": {}, "_learner_class": "<class 'source.intrinsic_attention_ppo.learners.IntrinsicAttentionMetaLearner.IntrinsicAttentionMetaLearner'>", "callbacks_on_algorithm_init": null, "callbacks_on_env_runners_recreated": null, "callbacks_on_offline_eval_runners_recreated": null, "callbacks_on_checkpoint_loaded": null, "callbacks_on_environment_created": null, "callbacks_on_episode_created": null, "callbacks_on_episode_start": null, "callbacks_on_episode_step": null, "callbacks_on_episode_end": null, "callbacks_on_evaluate_start": null, "callbacks_on_evaluate_end": null, "callbacks_on_evaluate_offline_start": null, "callbacks_on_evaluate_offline_end": null, "callbacks_on_sample_end": null, "callbacks_on_train_result": null, "explore": true, "enable_rl_module_and_learner": true, "enable_env_runner_and_connector_v2": true, "_prior_exploration_config": {"type": "StochasticSampling"}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x3884998a0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "offline_data_class": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_read_batch_size": null, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "materialize_data": false, "materialize_mapped_data": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "ignore_final_observation": false, "prelearner_class": null, "prelearner_buffer_class": null, "prelearner_buffer_kwargs": {}, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_remaining_data": false, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": 1, "evaluation_duration": 20, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_auto_duration_min_env_steps_per_sample": 100, "evaluation_auto_duration_max_env_steps_per_sample": 2000, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 1, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "offline_evaluation_interval": null, "num_offline_eval_runners": 0, "offline_loss_for_module_fn": null, "offline_evaluation_duration": 1, "offline_evaluation_parallel_to_training": false, "offline_evaluation_timeout_s": 120.0, "num_cpus_per_offline_eval_runner": 1, "num_gpus_per_offline_eval_runner": 0, "custom_resources_per_offline_eval_runner": {}, "restart_failed_offline_eval_runners": true, "ignore_offline_eval_runner_failures": false, "max_num_offline_eval_runner_restarts": 1000, "offline_eval_runner_restore_timeout_s": 1800.0, "max_requests_in_flight_per_offline_eval_runner": 1, "validate_offline_eval_runners_after_construction": true, "offline_eval_runner_health_probe_timeout_s": 30.0, "offline_eval_rl_module_inference_only": false, "broadcast_offline_eval_runner_states": false, "offline_eval_batch_size_per_runner": 256, "dataset_num_iters_per_eval_runner": 1, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "log_gradients": false, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 7, "restart_failed_env_runners": true, "ignore_env_runner_failures": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30.0, "env_runner_restore_timeout_s": 1800.0, "_model_config": {}, "_rl_module_spec": "MultiRLModuleSpec(multi_rl_module_class=<class 'ray.rllib.core.rl_module.multi_rl_module.MultiRLModule'>, observation_space=None, action_space=None, inference_only=False, model_config=None, rl_module_specs={'default_policy': RLModuleSpec(module_class=<class 'source.intrinsic_attention_ppo.rl_modules.DifferentiablePPOModule.DifferentiablePPOModule'>, observation_space=None, action_space=None, inference_only=False, learner_only=False, model_config={'vf_share_layers': True, 'embedding_dim': 62, 'max_seq_len': 11, 'policy_head_hidden_sizes': [32], 'value_head_hidden_sizes': [101], 'embedding_hidden_sizes': [121]}, catalog_class=None, load_state_path=None, model_config_dict=None), 'intrinsic_reward_module': RLModuleSpec(module_class=<class 'source.intrinsic_attention_ppo.rl_modules.IntrinsicAttentionModule.IntrinsicAttentionModule'>, observation_space=None, action_space=None, inference_only=False, learner_only=True, model_config={'intrinsic_reward_network': {'encoder_hidden_sizes': [], 'encoding_dim': 1, 'num_heads': 1, 'head_hidden_sizes': None, 'layers': [{'type': 'attention'}]}, 'extrinsic_value_hidden_layers': [127, 60], 'vf_share_layers': True, 'max_seq_len': 11}, catalog_class=None, load_state_path=None, model_config_dict=None)}, load_state_path=None, modules_to_load=None, module_specs={'default_policy': RLModuleSpec(module_class=<class 'source.intrinsic_attention_ppo.rl_modules.DifferentiablePPOModule.DifferentiablePPOModule'>, observation_space=None, action_space=None, inference_only=False, learner_only=False, model_config={'vf_share_layers': True, 'embedding_dim': 62, 'max_seq_len': 11, 'policy_head_hidden_sizes': [32], 'value_head_hidden_sizes': [101], 'embedding_hidden_sizes': [121]}, catalog_class=None, load_state_path=None, model_config_dict=None), 'intrinsic_reward_module': RLModuleSpec(module_class=<class 'source.intrinsic_attention_ppo.rl_modules.IntrinsicAttentionModule.IntrinsicAttentionModule'>, observation_space=None, action_space=None, inference_only=False, learner_only=True, model_config={'intrinsic_reward_network': {'encoder_hidden_sizes': [], 'encoding_dim': 1, 'num_heads': 1, 'head_hidden_sizes': None, 'layers': [{'type': 'attention'}]}, 'extrinsic_value_hidden_layers': [127, 60], 'vf_share_layers': True, 'max_seq_len': 11}, catalog_class=None, load_state_path=None, model_config_dict=None)})", "algorithm_config_overrides_per_module": {"intrinsic_reward_module": {"lr": 0.0002715581955}}, "_per_module_overrides": {}, "_validate_config": true, "_use_msgpack_checkpoints": false, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "env_task_fn": -1, "enable_connectors": -1, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.161583927863, "kl_target": 0.0201019014258, "vf_loss_coeff": 0.7790510010087, "entropy_coeff": 0.0015431216992, "clip_param": 0.2459212356676, "vf_clip_param": 0.3769744131561, "entropy_coeff_schedule": null, "lr_schedule": null, "sgd_minibatch_size": -1, "vf_share_layers": -1, "differentiable_learner_configs": ["DifferentiableLearnerConfig(learner_class=<class 'source.intrinsic_attention_ppo.learners.IntrinsicAttentionPPOLearner.IntrinsicAttentionPPOLearner'>, learner_connector=None, add_default_connectors_to_learner_pipeline=True, is_multi_agent=False, policies_to_update=['default_policy'], lr=0.0060984166342, num_total_minibatches=0, num_epochs=1, minibatch_size=1000, shuffle_batch_per_epoch=True)"], "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9485408017724, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.callbacks.callbacks.RLlibCallback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 175.353209733963, "iterations_since_restore": 18, "perf": {"cpu_util_percent": 38.830769230769235, "ram_util_percent": 79.53076923076924}}
{"timers": {"training_iteration": 10.124030402539898, "restore_env_runners": 1.242177658868841e-05, "training_step": 10.123822161702845, "env_runner_sampling_timer": 2.4446172083088564, "learner_update_timer": 7.424582912291504, "synch_weights": 0.0017271137466922132, "restore_eval_env_runners": 4.341732777959074e-05, "evaluation_iteration": 0.13684661816027183, "synch_eval_env_connectors": 0.00018265990829384107, "synch_env_connectors": 4.671065482659032e-06}, "env_runners": {"env_reset_timer": 4.279637054674833e-05, "num_episodes_lifetime": -524375.0, "num_env_steps_sampled_lifetime": -10487500.0, "num_env_steps_sampled": 5000.0, "module_to_env_connector": {"timers": {"connectors": {"remove_single_ts_time_rank_from_batch": 1.1883006724522336e-05, "get_actions": 3.8283513276047905e-05, "listify_data_for_vector_env": 1.0491055523555116e-05, "tensor_to_numpy": 1.5064492179179118e-05, "un_batch_to_individual_items": 6.554682264951609e-06, "normalize_and_clip_actions": 7.942607420296727e-06}}, "connector_pipeline_timer": 0.00011637102306296526}, "module_episode_returns_mean": {"default_policy": 0.17999999999999997}, "time_between_sampling": 0.030771832729806697, "rlmodule_inference_timer": 3.0969660563650695e-05, "env_step_timer": 1.3876911773510805e-05, "env_to_module_connector": {"timers": {"connectors": {"batch_individual_items": 1.2376443903855875e-05, "add_observations_from_episodes_to_batch": 2.8704587087667694e-06, "add_states_from_episodes_to_batch": 2.680406115654039e-06, "numpy_to_tensor": 1.2396410041772722e-05, "add_time_dim_to_batch_and_zero_pad": 7.155109050974628e-06}}, "connector_pipeline_timer": 5.937931332114757e-05}, "weights_seq_no": 18.0, "num_agent_steps_sampled": {"default_agent": 5000.0}, "episode_len_min": 20, "episode_len_mean": 20.0, "num_episodes": 250.0, "sample": 0.005764388654207756, "episode_duration_sec_mean": 0.005204898998141289, "episode_len_max": 20, "num_module_steps_sampled": {"default_policy": 5000.0}, "num_agent_steps_sampled_lifetime": {"default_agent": -10487500.0}, "num_module_steps_sampled_lifetime": {"default_policy": -10487500.0}, "env_to_module_sum_episodes_length_out": 10.36823839457432, "agent_episode_returns_mean": {"default_agent": 0.17999999999999997}, "episode_return_max": 10.5, "episode_return_min": -9.5, "env_to_module_sum_episodes_length_in": 10.36823839457432, "episode_return_mean": 0.17999999999999997, "num_env_steps_sampled_lifetime_throughput": 3280.554116544683}, "__all_modules__": {"learner_connector_sum_episodes_length_in": 5000.0, "learner_connector": {"connector_pipeline_timer": 0.2118619076103179, "timers": {"connectors": {"add_one_ts_to_episodes_and_truncate": 0.009202010384927775, "add_observations_from_episodes_to_batch": 0.0009587868741226277, "add_columns_from_episodes_to_train_batch": 0.09251299557320336, "add_time_dim_to_batch_and_zero_pad": 0.08669158978294306, "add_states_from_episodes_to_batch": 0.00361998337422378, "batch_individual_items": 0.018596550214578438, "numpy_to_tensor": 8.772553106860714e-05}}}, "learner_connector_sum_episodes_length_out": 5250.0}, "learners": {"differentiable_learners": {"intrinsic_attention_ppo_learner": {"intrinsic_reward_module": {"num_module_steps_trained_lifetime": 682290, "weights_seq_no": 114.0, "total_loss": 0.0, "num_module_steps_trained": 35910, "diff_num_grad_updates_vs_sampler_policy": 96.0, "module_train_batch_size_mean": 997.4980069784294}, "default_policy": {"module_train_batch_size_mean": 997.4980069784294, "use_intrinsic_rewards": 1.0, "num_module_steps_trained_lifetime": 682290, "policy_loss": -6.550983925990295e-06, "mean_kl_loss": 2.234226485597901e-05, "entropy": 0.6931328773498535, "weights_seq_no": 114.0, "vf_loss_unclipped": 44.17490005493164, "vf_loss": 0.35833483934402466, "total_loss": 0.2780885696411133, "vf_explained_var": -0.0012053251266479492, "num_module_steps_trained": 35910, "diff_num_grad_updates_vs_sampler_policy": 96.0}, "__all_modules__": {"num_env_steps_trained_lifetime": 3762000, "num_module_steps_trained": 71820, "num_module_steps_trained_lifetime": 1364580, "num_env_steps_trained": 198000, "num_env_steps_trained_lifetime_throughput": 44741.938402640524}}}, "intrinsic_reward_module": {"num_module_steps_trained": 5985, "curr_entropy_coeff": 0.0015431216992, "total_loss": 0.0, "num_module_steps_trained_lifetime": 113715, "gradients_default_optimizer_global_norm": 0.0, "diff_num_grad_updates_vs_sampler_policy": 1.0, "module_train_batch_size_mean": 997.6572809365935, "default_optimizer_learning_rate": 0.0002715581955, "num_trainable_parameters": 8266, "weights_seq_no": 19.0, "num_module_steps_trained_lifetime_throughput": 773.8583978799946}, "__all_modules__": {"num_trainable_parameters": 24861, "num_non_trainable_parameters": 0, "num_env_steps_trained_lifetime": 627000, "num_module_steps_trained": 11970, "num_module_steps_trained_lifetime": 227430, "num_env_steps_trained": 33000, "num_env_steps_trained_lifetime_throughput": 4267.925451510799, "num_module_steps_trained_throughput": 20777533.365937583, "num_module_steps_trained_lifetime_throughput": 12877494.809695562}, "default_policy": {"vf_loss": 0.358304500579834, "weights_seq_no": 19.0, "curr_entropy_coeff": 0.0015431216992, "vf_loss_unclipped": 44.06956481933594, "total_loss": 0.2780601680278778, "vf_explained_var": -0.0005890130996704102, "num_module_steps_trained": 5985, "diff_num_grad_updates_vs_sampler_policy": 1.0, "curr_kl_coeff": 3.0819688845440396e-07, "use_intrinsic_rewards": 0.0, "module_train_batch_size_mean": 997.6572809365935, "num_module_steps_trained_lifetime": 113715, "policy_loss": -7.729887329332996e-06, "num_trainable_parameters": 16595, "mean_kl_loss": 2.224072886747308e-05, "entropy": 0.6931328773498535, "num_module_steps_trained_lifetime_throughput": 773.8505434416858}, "IntrinsicAttentionMask": [[[0.09126677364110947, 0.0901404619216919, 0.0901876762509346, 0.0902349054813385, 0.09028215706348419, 0.09103784710168839, 0.09227194637060165, 0.0911332294344902, 0.0911809578537941, 0.09169786423444748, 0.0905662328004837], [0.08954552561044693, 0.09379100799560547, 0.09360799938440323, 0.09342534840106964, 0.09324304759502411, 0.09038837254047394, 0.08596047013998032, 0.09003598242998123, 0.08986029773950577, 0.08798521757125854, 0.09215673059225082], [0.08961955457925797, 0.09363634884357452, 0.09346339851617813, 0.093290776014328, 0.09311846643686295, 0.09041780233383179, 0.08621969074010849, 0.09008409827947617, 0.08991771936416626, 0.08814076334238052, 0.09209127724170685], [0.08969347178936005, 0.09348176419734955, 0.09331884235143661, 0.09315621107816696, 0.09299387037754059, 0.09044706076383591, 0.08647952973842621, 0.09013208001852036, 0.08997499942779541, 0.08829641342163086, 0.09202569723129272], [0.08976726979017258, 0.09332724660634995, 0.09317432343959808, 0.09302166104316711, 0.09286924451589584, 0.0904761403799057, 0.08673997223377228, 0.09017989784479141, 0.09003213793039322, 0.08845215290784836, 0.09195997565984726], [0.09092465043067932, 0.0908757746219635, 0.09087783098220825, 0.0908798947930336, 0.09088195860385895, 0.0909147635102272, 0.09096778184175491, 0.0909188836812973, 0.09092094749212265, 0.09094320237636566, 0.09089431911706924], [0.0927211195230484, 0.0869528204202652, 0.08718863129615784, 0.08742507547140121, 0.08766216784715652, 0.0915244072675705, 0.09812604635953903, 0.09202150255441666, 0.09227105230093002, 0.09500890225172043, 0.08909827470779419], [0.09106767922639847, 0.09056898951530457, 0.0905899628996849, 0.09061093628406525, 0.09063191711902618, 0.09096659719944, 0.0915098488330841, 0.0910087376832962, 0.0910298079252243, 0.09125764667987823, 0.09075790643692017], [0.09113898873329163, 0.09041569381952286, 0.09044606983661652, 0.09047646820545197, 0.09050686657428741, 0.09099223464727402, 0.09178179502487183, 0.09105339646339417, 0.09108399599790573, 0.09141498059034348, 0.09068949520587921], [0.09190011024475098, 0.08876514434814453, 0.08889514207839966, 0.0890253335237503, 0.08915571123361588, 0.0912572592496872, 0.09475718438625336, 0.09152474999427795, 0.09165879338979721, 0.09311854839324951, 0.08994201570749283], [0.09020733833312988, 0.09240139275789261, 0.09230781346559525, 0.09221433103084564, 0.0921209380030632, 0.09064684063196182, 0.08831529319286346, 0.09046332538127899, 0.09037170559167862, 0.08938843756914139, 0.09156257659196854]], [[0.09178268909454346, 0.09173872321844101, 0.09235265105962753, 0.09165085107088089, 0.09117794036865234, 0.09048505872488022, 0.09151919931173325, 0.09213165938854218, 0.08442231267690659, 0.09063520282506943, 0.09210370481014252], [0.09159596264362335, 0.09156164526939392, 0.09204049408435822, 0.09149304777383804, 0.09112363308668137, 0.09058164060115814, 0.09139025211334229, 0.09186820685863495, 0.08579953759908676, 0.09069915860891342, 0.09184640645980835], [0.09402099251747131, 0.09384924173355103, 0.09626846015453339, 0.09350668638944626, 0.0916789174079895, 0.08904881030321121, 0.09299518913030624, 0.0953923836350441, 0.0683434009552002, 0.08961392939090729, 0.09528199583292007], [0.09121640026569366, 0.09120127558708191, 0.09141208976507187, 0.0911710262298584, 0.09100790321826935, 0.09076790511608124, 0.09112566709518433, 0.09133630990982056, 0.08861473947763443, 0.09082000702619553, 0.09132671356201172], [0.08902110159397125, 0.08910675346851349, 0.08792193233966827, 0.08927828818559647, 0.09021004289388657, 0.09160169959068298, 0.08953621983528137, 0.08834569156169891, 0.10528124868869781, 0.09129742532968521, 0.0883995071053505], [0.08529914915561676, 0.08552327752113342, 0.08245564997196198, 0.08597330749034882, 0.08844394236803055, 0.09221706539392471, 0.08665280044078827, 0.08354466408491135, 0.1348230093717575, 0.09138357639312744, 0.08368360996246338], [0.09063152223825455, 0.09064488857984543, 0.09045906364917755, 0.0906716138124466, 0.09081605076789856, 0.09102945029735565, 0.09071172773838043, 0.09052576869726181, 0.09299270063638687, 0.09098302572965622, 0.09053421765565872], [0.09319204837083817, 0.09307039529085159, 0.0947781503200531, 0.09282757341861725, 0.09152761101722717, 0.0896439328789711, 0.09246452152729034, 0.09416115283966064, 0.074201300740242, 0.09004999697208405, 0.09408329427242279], [0.029963858425617218, 0.03050014190375805, 0.023826569318771362, 0.031601667404174805, 0.03827263414859772, 0.05076177045702934, 0.03332900255918503, 0.026036465540528297, 0.6616374850273132, 0.04773984104394913, 0.02633061073720455], [0.0861598402261734, 0.08635503053665161, 0.08367738127708435, 0.08674672245979309, 0.0888921320438385, 0.09215276688337326, 0.08733761310577393, 0.08462949097156525, 0.1278640478849411, 0.09143409132957458, 0.08475085347890854], [0.09308379143476486, 0.0929684191942215, 0.09458719193935394, 0.09273812919855118, 0.09150473773479462, 0.08971593528985977, 0.09239375591278076, 0.09400251507759094, 0.0749751478433609, 0.0901017040014267, 0.09392872452735901]], [[0.09094598144292831, 0.0898236334323883, 0.09104126691818237, 0.09108895063400269, 0.09113665670156479, 0.0907178595662117, 0.09076537191867828, 0.09081291407346725, 0.09204395860433578, 0.09137555956840515, 0.09024789929389954], [0.09074263274669647, 0.09504486620426178, 0.09038885682821274, 0.09021248668432236, 0.09003645926713943, 0.09159674495458603, 0.09141802787780762, 0.09123963862657547, 0.08677004277706146, 0.0891614705324173, 0.09338873624801636], [0.09095977246761322, 0.08939334750175476, 0.09109312295913696, 0.0911598652601242, 0.09122666716575623, 0.09064076840877533, 0.09070718288421631, 0.09077364951372147, 0.09249966591596603, 0.09156136959791183, 0.08998458087444305], [0.09096647799015045, 0.08917878568172455, 0.09111885726451874, 0.09119514375925064, 0.09127149730920792, 0.09060204774141312, 0.0906779021024704, 0.09075382351875305, 0.0927281603217125, 0.0916542112827301, 0.08985301107168198], [0.09097306430339813, 0.08896462619304657, 0.09114449471235275, 0.09123032540082932, 0.09131624549627304, 0.09056323021650314, 0.09064851701259613, 0.09073388576507568, 0.09295710176229477, 0.09174703806638718, 0.08972151577472687], [0.09091074764728546, 0.09086188673973083, 0.09091486781835556, 0.09091693162918091, 0.09091899544000626, 0.09090086817741394, 0.09090292453765869, 0.09090498834848404, 0.09095799922943115, 0.0909292995929718, 0.09088042378425598], [0.09091834723949432, 0.09064469486474991, 0.09094145894050598, 0.09095302224159241, 0.09096457809209824, 0.0908629298210144, 0.09087447822093964, 0.09088603407144547, 0.09118358790874481, 0.09102240949869156, 0.09074844419956207], [0.09092580527067184, 0.09042789041996002, 0.09096791595220566, 0.09098897874355316, 0.09101004898548126, 0.09082487970590591, 0.09084591269493103, 0.09086694568395615, 0.0914096012711525, 0.09111547470092773, 0.09061651676893234], [0.09107282012701035, 0.08498504757881165, 0.09160571545362473, 0.09187332540750504, 0.09214172512292862, 0.08980736136436462, 0.0900697261095047, 0.09033285081386566, 0.09737013280391693, 0.09349551796913147, 0.08724579960107803], [0.09100396931171417, 0.08789956569671631, 0.09127072244882584, 0.09140439331531525, 0.09153825789690018, 0.0903673842549324, 0.09049972891807556, 0.09063227474689484, 0.0941082313656807, 0.09221052378416061, 0.08906496316194534], [0.09082841128110886, 0.09303756803274155, 0.09064453095197678, 0.09055272489786148, 0.09046102315187454, 0.09127093851566315, 0.09117850661277771, 0.09108616411685944, 0.08874330669641495, 0.09000387042760849, 0.09219297766685486]], [[0.09030085057020187, 0.09049086272716522, 0.08343225717544556, 0.09087207913398743, 0.08378374576568604, 0.08663488924503326, 0.09144693613052368, 0.08431375026702881, 0.12370482087135315, 0.09059364348649979, 0.08442606031894684], [0.09024002403020859, 0.09043935686349869, 0.08304900676012039, 0.09083933383226395, 0.08341630548238754, 0.08639845997095108, 0.09144262224435806, 0.08397029340267181, 0.12556980550289154, 0.09054718911647797, 0.08408769220113754], [0.09060844779014587, 0.09044293314218521, 0.09706312417984009, 0.09011280536651611, 0.09670883417129517, 0.09393443167209625, 0.08961987495422363, 0.09617982804775238, 0.06890758872032166, 0.09035366773605347, 0.09606852382421494], [0.09010898321866989, 0.09032688289880753, 0.08227907866239548, 0.09076426923274994, 0.08267749100923538, 0.08591844886541367, 0.09142432361841202, 0.08327873796224594, 0.12937085330486298, 0.09044478833675385, 0.08340620994567871], [0.09067650884389877, 0.09052976965904236, 0.09637545794248581, 0.09023701399564743, 0.09606380015611649, 0.09361866861581802, 0.0897996574640274, 0.09559819847345352, 0.07115010172128677, 0.09045062214136124, 0.09550020098686218], [0.09090758860111237, 0.09091149270534515, 0.09076061099767685, 0.09091931581497192, 0.09076841920614243, 0.09083056449890137, 0.09093104302883148, 0.09078012406826019, 0.09149470925331116, 0.09091360867023468, 0.09078259766101837], [0.0898885428905487, 0.0901341512799263, 0.08111568540334702, 0.09062737226486206, 0.08155955374240875, 0.08518047630786896, 0.09137226641178131, 0.08222991973161697, 0.13525281846523285, 0.09026706218719482, 0.08237212896347046], [0.0907631665468216, 0.09064468741416931, 0.09533677995204926, 0.09040818363428116, 0.09508804231882095, 0.09313108772039413, 0.09005460143089294, 0.0947161465883255, 0.07463868707418442, 0.0905807614326477, 0.09463783353567123], [0.04477864131331444, 0.04558006674051285, 0.022967655211687088, 0.04722621291875839, 0.02379714325070381, 0.03156261518597603, 0.04980757087469101, 0.025097882375121117, 0.6377819776535034, 0.04601883143186569, 0.025381410494446754], [0.09020587056875229, 0.09041022509336472, 0.08284154534339905, 0.0908203199505806, 0.0832173079252243, 0.08626977354288101, 0.09143894165754318, 0.08378414809703827, 0.12658679485321045, 0.09052077680826187, 0.08390429615974426], [0.09077902883291245, 0.0906665250658989, 0.09511640667915344, 0.09044193476438522, 0.09488078951835632, 0.09302598983049393, 0.09010608494281769, 0.09452845901250839, 0.0753946527838707, 0.09060582518577576, 0.09445425868034363]], [[0.09353509545326233, 0.09070894122123718, 0.09524518251419067, 0.09033642709255219, 0.09015074372291565, 0.08724558353424072, 0.09160862863063812, 0.08688729256391525, 0.08670869469642639, 0.0938832014799118, 0.09369022399187088], [0.09154932200908661, 0.09086877107620239, 0.0919535905122757, 0.09077788144350052, 0.09073246270418167, 0.09001254290342331, 0.09108714014291763, 0.08992250263690948, 0.08987751603126526, 0.09163206070661545, 0.09158622473478317], [0.09470240771770477, 0.09059029817581177, 0.09721783548593521, 0.09005250036716461, 0.08978480100631714, 0.0856286808848381, 0.09189323335886002, 0.08512034267187119, 0.08486730605363846, 0.09521279484033585, 0.0949297547340393], [0.09128221124410629, 0.09088625758886337, 0.09151683747768402, 0.09083328396081924, 0.09080680459737778, 0.09038633853197098, 0.09101344645023346, 0.09033364802598953, 0.09030731767416, 0.09133026748895645, 0.09130364656448364], [0.09114858508110046, 0.09089463949203491, 0.09129887819290161, 0.09086063504219055, 0.09084364026784897, 0.09057345241308212, 0.09097626060247421, 0.09053955972194672, 0.09052262455224991, 0.09117937833070755, 0.09116232395172119], [0.08901643007993698, 0.09099651128053665, 0.08786743879318237, 0.09126542508602142, 0.09140017628669739, 0.09357243776321411, 0.0903547927737236, 0.09384896606206894, 0.09398753196001053, 0.08877963572740555, 0.08891072124242783], [0.0921892374753952, 0.09082301706075668, 0.09300566464662552, 0.0906413123011589, 0.09055060148239136, 0.0891185998916626, 0.09126028418540955, 0.08894030749797821, 0.08885128796100616, 0.09235605597496033, 0.0922636166214943], [0.08874797075986862, 0.09100506454706192, 0.08744148910045624, 0.09131213277578354, 0.09146605432033539, 0.0939517542719841, 0.09027279913425446, 0.09426876902580261, 0.0944276824593544, 0.08847851306200027, 0.08862766623497009], [0.08861371129751205, 0.0910089910030365, 0.08722895383834839, 0.09133515506982803, 0.09149867296218872, 0.0941416397690773, 0.09023149311542511, 0.0944790244102478, 0.09464817494153976, 0.08832801133394241, 0.08848614245653152], [0.09377477318048477, 0.09068606793880463, 0.0956479012966156, 0.09027960151433945, 0.09007705748081207, 0.08691299706697464, 0.09166838973760605, 0.08652345091104507, 0.08632931858301163, 0.09415581077337265, 0.09394456446170807], [0.09364204108715057, 0.09069883823394775, 0.09542473405599594, 0.09031116962432861, 0.09011796861886978, 0.0870971605181694, 0.09163538366556168, 0.08672488480806351, 0.08653935045003891, 0.09400481730699539, 0.09380370378494263]], [[0.09073115140199661, 0.08631890267133713, 0.08830027282238007, 0.08668255060911179, 0.08418300747871399, 0.09168977290391922, 0.08723089843988419, 0.08471553772687912, 0.1242942214012146, 0.09102534502744675, 0.08482837677001953], [0.09082826972007751, 0.09163908660411835, 0.09126908332109451, 0.09157043695449829, 0.09204933047294617, 0.09065824747085571, 0.09146755188703537, 0.09194590896368027, 0.0858721062541008, 0.09077586978673935, 0.09192409366369247], [0.09097418189048767, 0.0893644243478775, 0.09009367972612381, 0.08949906378984451, 0.08856614679098129, 0.09131724387407303, 0.08970141410827637, 0.08876638114452362, 0.10182899981737137, 0.0910797119140625, 0.08880870789289474], [0.09087713807821274, 0.09123533219099045, 0.09107208997011185, 0.09120506793260574, 0.0914158970117569, 0.09080179780721664, 0.09115970134735107, 0.09137041866779327, 0.08864781260490417, 0.09085392206907272, 0.09136082231998444], [0.09035168588161469, 0.09388956427574158, 0.09226212650537491, 0.09358594566583633, 0.09571966528892517, 0.08962299674749374, 0.09313235431909561, 0.09525573253631592, 0.07089527696371078, 0.09012661129236221, 0.09515809267759323], [0.0905003622174263, 0.08503967523574829, 0.0874834880232811, 0.08548716455698013, 0.08242085576057434, 0.09169561415910721, 0.08616282045841217, 0.08307226747274399, 0.13406045734882355, 0.09086684137582779, 0.08321042358875275], [0.09093229472637177, 0.0906149223446846, 0.0907592624425888, 0.09064164757728577, 0.09045583009719849, 0.09099934995174408, 0.09068173915147781, 0.09049584716558456, 0.09296192973852158, 0.09095294773578644, 0.09050428867340088], [0.09049998968839645, 0.09334749728441238, 0.09204026311635971, 0.09310395270586014, 0.09481231123209, 0.0899108424782753, 0.09273982048034668, 0.0944414958357811, 0.07442230731248856, 0.09031811356544495, 0.09436340630054474], [0.04572141170501709, 0.03001965582370758, 0.036356665194034576, 0.031103821471333504, 0.024298205971717834, 0.04996202513575554, 0.032803937792778015, 0.025626324117183685, 0.6512044668197632, 0.04698772728443146, 0.025915823876857758], [0.09066863358020782, 0.08593102544546127, 0.08805626630783081, 0.08632080256938934, 0.08364421874284744, 0.09170029312372208, 0.08690878748893738, 0.0842139720916748, 0.12723612785339355, 0.09098515659570694, 0.08433473110198975], [0.0905289575457573, 0.09323104470968246, 0.09199108928442001, 0.09300009906291962, 0.09461940824985504, 0.08996935933828354, 0.092654749751091, 0.09426804631948471, 0.07518697530031204, 0.09035622328519821, 0.09419404715299606]]]}, "num_training_step_calls_per_iteration": 1, "evaluation": {"env_runners": {"module_to_env_connector": {"timers": {"connectors": {"remove_single_ts_time_rank_from_batch": 1.1799774390900407e-05, "get_actions": 3.5611263880972664e-05, "normalize_and_clip_actions": 7.811789149182636e-06, "listify_data_for_vector_env": 1.0417887359651789e-05, "tensor_to_numpy": 1.4638996467721377e-05, "un_batch_to_individual_items": 6.481486857678641e-06}}, "connector_pipeline_timer": 0.00011294776147060246}, "episode_len_max": 20, "num_agent_steps_sampled_lifetime": {"default_agent": 7600}, "num_module_steps_sampled_lifetime": {"default_policy": 7600}, "episode_return_max": 14.5, "env_reset_timer": 0.000525834448191941, "rlmodule_inference_timer": 3.060945071857582e-05, "env_step_timer": 1.3932557538759753e-05, "env_to_module_connector": {"timers": {"connectors": {"add_states_from_episodes_to_batch": 2.705379572450133e-06, "numpy_to_tensor": 1.18142924378819e-05, "add_time_dim_to_batch_and_zero_pad": 7.034004597465894e-06, "add_observations_from_episodes_to_batch": 2.8698191230441766e-06, "batch_individual_items": 1.2464581370684426e-05}}, "connector_pipeline_timer": 5.929383437292349e-05}, "episode_len_min": 20, "env_to_module_sum_episodes_length_out": 10.368238394574323, "env_to_module_sum_episodes_length_in": 10.368238394574323, "num_env_steps_sampled_lifetime": 95400, "num_agent_steps_sampled": {"default_agent": 400}, "weights_seq_no": 19.0, "module_episode_returns_mean": {"default_policy": 0.05}, "episode_len_mean": 20.0, "sample": 0.1255070010431736, "agent_episode_returns_mean": {"default_agent": 0.05}, "episode_return_mean": 0.05, "episode_return_min": -12.5, "num_episodes": 20, "episode_duration_sec_mean": 0.0053856257954612375, "num_module_steps_sampled": {"default_policy": 400}, "num_episodes_lifetime": 380, "num_env_steps_sampled": 400, "time_between_sampling": 9.45069967493073}, "num_healthy_workers": 1, "actor_manager_num_outstanding_async_reqs": 0, "num_remote_worker_restarts": 0}, "num_env_steps_sampled_lifetime": -10487500.0, "fault_tolerance": {"num_healthy_workers": 0, "num_remote_worker_restarts": 0}, "env_runner_group": {"actor_manager_num_outstanding_async_reqs": 0}, "done": false, "training_iteration": 19, "trial_id": "b9446_00000", "date": "2025-08-11_18-37-18", "timestamp": 1754930238, "time_this_iter_s": 9.531583070755005, "time_total_s": 184.88479280471802, "pid": 11415, "hostname": "Mac", "node_ip": "127.0.0.1", "config": {"exploration_config": {}, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 2, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "env": "Umbrella", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": false, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 0, "create_local_env_runner": true, "num_envs_per_env_runner": 1, "gym_env_vectorize_mode": "SYNC", "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "episodes_to_numpy": true, "max_requests_in_flight_per_env_runner": 1, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "merge_env_runner_states": "training_only", "broadcast_env_runner_states": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "complete_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "sampler_perf_stats_ema_coef": null, "_is_online": true, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": "auto", "num_aggregator_actors_per_learner": 0, "max_requests_in_flight_per_aggregator_actor": 3, "local_gpu_idx": 0, "max_requests_in_flight_per_learner": 3, "gamma": 1, "lr": 0.0002715581955, "grad_clip": 0.5, "grad_clip_by": "global_norm", "_train_batch_size_per_learner": 5000, "train_batch_size": 4000, "num_epochs": 1, "minibatch_size": 1000, "shuffle_batch_per_epoch": true, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "log_std_clip_param": 20.0, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "_disable_preprocessor_api": false, "_disable_action_flattening": false}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {"intrinsic_reward_coeff": 0.2795015916508}, "optimizer": {}, "_learner_class": "<class 'source.intrinsic_attention_ppo.learners.IntrinsicAttentionMetaLearner.IntrinsicAttentionMetaLearner'>", "callbacks_on_algorithm_init": null, "callbacks_on_env_runners_recreated": null, "callbacks_on_offline_eval_runners_recreated": null, "callbacks_on_checkpoint_loaded": null, "callbacks_on_environment_created": null, "callbacks_on_episode_created": null, "callbacks_on_episode_start": null, "callbacks_on_episode_step": null, "callbacks_on_episode_end": null, "callbacks_on_evaluate_start": null, "callbacks_on_evaluate_end": null, "callbacks_on_evaluate_offline_start": null, "callbacks_on_evaluate_offline_end": null, "callbacks_on_sample_end": null, "callbacks_on_train_result": null, "explore": true, "enable_rl_module_and_learner": true, "enable_env_runner_and_connector_v2": true, "_prior_exploration_config": {"type": "StochasticSampling"}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x3884998a0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "offline_data_class": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_read_batch_size": null, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "materialize_data": false, "materialize_mapped_data": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "ignore_final_observation": false, "prelearner_class": null, "prelearner_buffer_class": null, "prelearner_buffer_kwargs": {}, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_remaining_data": false, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": 1, "evaluation_duration": 20, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_auto_duration_min_env_steps_per_sample": 100, "evaluation_auto_duration_max_env_steps_per_sample": 2000, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 1, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "offline_evaluation_interval": null, "num_offline_eval_runners": 0, "offline_loss_for_module_fn": null, "offline_evaluation_duration": 1, "offline_evaluation_parallel_to_training": false, "offline_evaluation_timeout_s": 120.0, "num_cpus_per_offline_eval_runner": 1, "num_gpus_per_offline_eval_runner": 0, "custom_resources_per_offline_eval_runner": {}, "restart_failed_offline_eval_runners": true, "ignore_offline_eval_runner_failures": false, "max_num_offline_eval_runner_restarts": 1000, "offline_eval_runner_restore_timeout_s": 1800.0, "max_requests_in_flight_per_offline_eval_runner": 1, "validate_offline_eval_runners_after_construction": true, "offline_eval_runner_health_probe_timeout_s": 30.0, "offline_eval_rl_module_inference_only": false, "broadcast_offline_eval_runner_states": false, "offline_eval_batch_size_per_runner": 256, "dataset_num_iters_per_eval_runner": 1, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "log_gradients": false, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 7, "restart_failed_env_runners": true, "ignore_env_runner_failures": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30.0, "env_runner_restore_timeout_s": 1800.0, "_model_config": {}, "_rl_module_spec": "MultiRLModuleSpec(multi_rl_module_class=<class 'ray.rllib.core.rl_module.multi_rl_module.MultiRLModule'>, observation_space=None, action_space=None, inference_only=False, model_config=None, rl_module_specs={'default_policy': RLModuleSpec(module_class=<class 'source.intrinsic_attention_ppo.rl_modules.DifferentiablePPOModule.DifferentiablePPOModule'>, observation_space=None, action_space=None, inference_only=False, learner_only=False, model_config={'vf_share_layers': True, 'embedding_dim': 62, 'max_seq_len': 11, 'policy_head_hidden_sizes': [32], 'value_head_hidden_sizes': [101], 'embedding_hidden_sizes': [121]}, catalog_class=None, load_state_path=None, model_config_dict=None), 'intrinsic_reward_module': RLModuleSpec(module_class=<class 'source.intrinsic_attention_ppo.rl_modules.IntrinsicAttentionModule.IntrinsicAttentionModule'>, observation_space=None, action_space=None, inference_only=False, learner_only=True, model_config={'intrinsic_reward_network': {'encoder_hidden_sizes': [], 'encoding_dim': 1, 'num_heads': 1, 'head_hidden_sizes': None, 'layers': [{'type': 'attention'}]}, 'extrinsic_value_hidden_layers': [127, 60], 'vf_share_layers': True, 'max_seq_len': 11}, catalog_class=None, load_state_path=None, model_config_dict=None)}, load_state_path=None, modules_to_load=None, module_specs={'default_policy': RLModuleSpec(module_class=<class 'source.intrinsic_attention_ppo.rl_modules.DifferentiablePPOModule.DifferentiablePPOModule'>, observation_space=None, action_space=None, inference_only=False, learner_only=False, model_config={'vf_share_layers': True, 'embedding_dim': 62, 'max_seq_len': 11, 'policy_head_hidden_sizes': [32], 'value_head_hidden_sizes': [101], 'embedding_hidden_sizes': [121]}, catalog_class=None, load_state_path=None, model_config_dict=None), 'intrinsic_reward_module': RLModuleSpec(module_class=<class 'source.intrinsic_attention_ppo.rl_modules.IntrinsicAttentionModule.IntrinsicAttentionModule'>, observation_space=None, action_space=None, inference_only=False, learner_only=True, model_config={'intrinsic_reward_network': {'encoder_hidden_sizes': [], 'encoding_dim': 1, 'num_heads': 1, 'head_hidden_sizes': None, 'layers': [{'type': 'attention'}]}, 'extrinsic_value_hidden_layers': [127, 60], 'vf_share_layers': True, 'max_seq_len': 11}, catalog_class=None, load_state_path=None, model_config_dict=None)})", "algorithm_config_overrides_per_module": {"intrinsic_reward_module": {"lr": 0.0002715581955}}, "_per_module_overrides": {}, "_validate_config": true, "_use_msgpack_checkpoints": false, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "env_task_fn": -1, "enable_connectors": -1, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.161583927863, "kl_target": 0.0201019014258, "vf_loss_coeff": 0.7790510010087, "entropy_coeff": 0.0015431216992, "clip_param": 0.2459212356676, "vf_clip_param": 0.3769744131561, "entropy_coeff_schedule": null, "lr_schedule": null, "sgd_minibatch_size": -1, "vf_share_layers": -1, "differentiable_learner_configs": ["DifferentiableLearnerConfig(learner_class=<class 'source.intrinsic_attention_ppo.learners.IntrinsicAttentionPPOLearner.IntrinsicAttentionPPOLearner'>, learner_connector=None, add_default_connectors_to_learner_pipeline=True, is_multi_agent=False, policies_to_update=['default_policy'], lr=0.0060984166342, num_total_minibatches=0, num_epochs=1, minibatch_size=1000, shuffle_batch_per_epoch=True)"], "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9485408017724, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.callbacks.callbacks.RLlibCallback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 184.88479280471802, "iterations_since_restore": 19, "perf": {"cpu_util_percent": 36.10769230769231, "ram_util_percent": 79.69999999999999}}
{"timers": {"training_iteration": 10.11230585143375, "restore_env_runners": 1.2432139591446335e-05, "training_step": 10.112097104246123, "env_runner_sampling_timer": 2.4354455220655318, "learner_update_timer": 7.421361307757935, "synch_weights": 0.0017185488594532788, "restore_eval_env_runners": 4.333606522160675e-05, "evaluation_iteration": 0.136707414058247, "synch_eval_env_connectors": 0.00018232580951607844, "synch_env_connectors": 4.663514613788586e-06}, "env_runners": {"env_reset_timer": 4.019846362566168e-05, "num_episodes_lifetime": -555250.0, "num_env_steps_sampled_lifetime": -11105000.0, "num_env_steps_sampled": 5000.0, "module_to_env_connector": {"timers": {"connectors": {"remove_single_ts_time_rank_from_batch": 1.1909513510367745e-05, "get_actions": 3.8626127395480333e-05, "listify_data_for_vector_env": 1.0551100605289302e-05, "tensor_to_numpy": 1.5123623263967648e-05, "un_batch_to_individual_items": 6.550949532971034e-06, "normalize_and_clip_actions": 8.018373662482658e-06}}, "connector_pipeline_timer": 0.0001170928972980142}, "module_episode_returns_mean": {"default_policy": 1.2200000000000002}, "time_between_sampling": 0.03249744635273699, "rlmodule_inference_timer": 3.134294017760994e-05, "env_step_timer": 1.3986650269387849e-05, "env_to_module_connector": {"timers": {"connectors": {"batch_individual_items": 1.2406273008873029e-05, "add_observations_from_episodes_to_batch": 2.8973295712007294e-06, "add_states_from_episodes_to_batch": 2.668680697460272e-06, "numpy_to_tensor": 1.2380083151878156e-05, "add_time_dim_to_batch_and_zero_pad": 7.177525727090423e-06}}, "connector_pipeline_timer": 5.952327996717781e-05}, "weights_seq_no": 19.0, "num_agent_steps_sampled": {"default_agent": 5000.0}, "episode_len_min": 20, "episode_len_mean": 20.0, "num_episodes": 250.0, "sample": 0.005581303229450649, "episode_duration_sec_mean": 0.005237221311777832, "episode_len_max": 20, "num_module_steps_sampled": {"default_policy": 5000.0}, "num_agent_steps_sampled_lifetime": {"default_agent": -11105000.0}, "num_module_steps_sampled_lifetime": {"default_policy": -11105000.0}, "env_to_module_sum_episodes_length_out": 10.36823839457432, "agent_episode_returns_mean": {"default_agent": 1.2200000000000002}, "episode_return_max": 10.5, "episode_return_min": -9.5, "env_to_module_sum_episodes_length_in": 10.36823839457432, "episode_return_mean": 1.2200000000000002, "num_env_steps_sampled_lifetime_throughput": 3274.1148832396234}, "__all_modules__": {"learner_connector_sum_episodes_length_in": 5000.0, "learner_connector": {"connector_pipeline_timer": 0.21247557436347567, "timers": {"connectors": {"add_one_ts_to_episodes_and_truncate": 0.009203236121477092, "add_observations_from_episodes_to_batch": 0.000958767755774047, "add_columns_from_episodes_to_train_batch": 0.09199939936690084, "add_time_dim_to_batch_and_zero_pad": 0.08657939972505632, "add_states_from_episodes_to_batch": 0.003620555630724718, "batch_individual_items": 0.019835062621891456, "numpy_to_tensor": 8.760952602472636e-05}}}, "learner_connector_sum_episodes_length_out": 5250.0}, "learners": {"differentiable_learners": {"intrinsic_attention_ppo_learner": {"intrinsic_reward_module": {"num_module_steps_trained_lifetime": 718200, "weights_seq_no": 120.0, "total_loss": 0.0, "num_module_steps_trained": 35910, "diff_num_grad_updates_vs_sampler_policy": 101.0, "module_train_batch_size_mean": 997.4978492525759}, "default_policy": {"module_train_batch_size_mean": 997.4978492525759, "use_intrinsic_rewards": 1.0, "num_module_steps_trained_lifetime": 718200, "policy_loss": -0.00012765142309945077, "mean_kl_loss": 1.2915538718516473e-05, "entropy": 0.6931240558624268, "weights_seq_no": 120.0, "vf_loss_unclipped": 44.108978271484375, "vf_loss": 0.3583323359489441, "total_loss": 0.2779640257358551, "vf_explained_var": -0.0011502504348754883, "num_module_steps_trained": 35910, "diff_num_grad_updates_vs_sampler_policy": 101.0}, "__all_modules__": {"num_env_steps_trained_lifetime": 3960000, "num_module_steps_trained": 71820, "num_module_steps_trained_lifetime": 1436400, "num_env_steps_trained": 198000, "num_env_steps_trained_lifetime_throughput": 44211.966855127335}}}, "intrinsic_reward_module": {"num_module_steps_trained": 5985, "curr_entropy_coeff": 0.0015431216992, "total_loss": 0.0, "num_module_steps_trained_lifetime": 119700, "gradients_default_optimizer_global_norm": 0.0, "diff_num_grad_updates_vs_sampler_policy": 1.0, "module_train_batch_size_mean": 997.6479298448816, "default_optimizer_learning_rate": 0.0002715581955, "num_trainable_parameters": 8266, "weights_seq_no": 20.0, "num_module_steps_trained_lifetime_throughput": 772.2885709006357}, "__all_modules__": {"num_trainable_parameters": 24861, "num_non_trainable_parameters": 0, "num_env_steps_trained_lifetime": 660000, "num_module_steps_trained": 11970, "num_module_steps_trained_lifetime": 239400, "num_env_steps_trained": 33000, "num_env_steps_trained_lifetime_throughput": 4259.231646146816, "num_module_steps_trained_throughput": 20338314.041674204, "num_module_steps_trained_lifetime_throughput": 12854171.742422352}, "default_policy": {"vf_loss": 0.358304500579834, "weights_seq_no": 20.0, "curr_entropy_coeff": 0.0015431216992, "vf_loss_unclipped": 44.00824737548828, "total_loss": 0.2779371738433838, "vf_explained_var": -0.00045490264892578125, "num_module_steps_trained": 5985, "diff_num_grad_updates_vs_sampler_policy": 1.0, "curr_kl_coeff": 1.5409844422720198e-07, "use_intrinsic_rewards": 0.0, "module_train_batch_size_mean": 997.6479298448816, "num_module_steps_trained_lifetime": 119700, "policy_loss": -0.0001307254860876128, "num_trainable_parameters": 16595, "mean_kl_loss": 1.3451515769702382e-05, "entropy": 0.6931235790252686, "num_module_steps_trained_lifetime_throughput": 772.2812251857151}, "IntrinsicAttentionMask": [[[0.0907311663031578, 0.09077868610620499, 0.09082622826099396, 0.08970534801483154, 0.08975232392549515, 0.09050358086824417, 0.09173043817281723, 0.09177848696708679, 0.09182655066251755, 0.09115972369909286, 0.09120746701955795], [0.09069507569074631, 0.09075205028057098, 0.09080906212329865, 0.08946653455495834, 0.08952273428440094, 0.09042227268218994, 0.0918944925069809, 0.09195222705602646, 0.09200999140739441, 0.09120915085077286, 0.0912664532661438], [0.0906587690114975, 0.09072519838809967, 0.09079167246818542, 0.08922813087701797, 0.08929351717233658, 0.09034081548452377, 0.09205861389636993, 0.09212606400251389, 0.09219356626272202, 0.09125836938619614, 0.09132524579763412], [0.09146472066640854, 0.09130531549453735, 0.09114619344472885, 0.09499583393335342, 0.09483027458190918, 0.09223319590091705, 0.0881873220205307, 0.08803363889455795, 0.0878802090883255, 0.09004007279872894, 0.08988314867019653], [0.0914330780506134, 0.09128326922655106, 0.09113369882106781, 0.09474785625934601, 0.0945926085114479, 0.09215512126684189, 0.08834962546825409, 0.08820486813783646, 0.08806033432483673, 0.09009356051683426, 0.089945949614048], [0.09090150147676468, 0.09090355783700943, 0.09090562164783478, 0.09085676074028015, 0.0908588171005249, 0.09089161455631256, 0.09094461053609848, 0.09094668179750443, 0.09094873815774918, 0.09092004597187042, 0.09092210233211517], [0.08993469923734665, 0.09017859399318695, 0.09042315185070038, 0.08479782193899155, 0.0850277841091156, 0.0887739434838295, 0.09517718106508255, 0.09543529152870178, 0.09569410979747772, 0.09215372800827026, 0.09240365028381348], [0.08989448845386505, 0.09014768153429031, 0.09040159732103348, 0.08456789702177048, 0.08480609208345413, 0.08868980407714844, 0.09534268826246262, 0.09561123698949814, 0.09588053822517395, 0.09219913929700851, 0.0924588292837143], [0.08985407650470734, 0.09011657536029816, 0.09037984162569046, 0.08433839678764343, 0.0845847800374031, 0.08860555291175842, 0.09550826251506805, 0.09578727930784225, 0.09606710821390152, 0.09224435687065125, 0.09251383692026138], [0.0903991088271141, 0.09053149819374084, 0.0906640812754631, 0.08757127076387405, 0.0876995250582695, 0.08976674824953079, 0.09320951253175735, 0.0933460220694542, 0.09348273277282715, 0.09159764647483826, 0.09173179417848587], [0.09036122262477875, 0.09050300717353821, 0.09064502269029617, 0.08733627945184708, 0.0874733254313469, 0.08968418836593628, 0.09337422251701355, 0.09352073818445206, 0.09366748481988907, 0.09164535254240036, 0.09178915619850159]], [[0.09198181331157684, 0.09193774312734604, 0.0914633497595787, 0.091849684715271, 0.09137573838233948, 0.09068135917186737, 0.0906379222869873, 0.09233153611421585, 0.08460545539855957, 0.09083182364702225, 0.09230352193117142], [0.09175112098455429, 0.09171674400568008, 0.09134642034769058, 0.09164803475141525, 0.09127798676490784, 0.09073507785797119, 0.09070108085870743, 0.0920238271355629, 0.08594486862421036, 0.09085279703140259, 0.09200198948383331], [0.08914822340011597, 0.08921535313129425, 0.08994340896606445, 0.08934977650642395, 0.0900789201259613, 0.09116492420434952, 0.09123357385396957, 0.08861831575632095, 0.1016591489315033, 0.09092778712511063, 0.08866056799888611], [0.09128458052873611, 0.09126943349838257, 0.09110613167285919, 0.09123916178941727, 0.09107591211795807, 0.09083573520183563, 0.09082067012786865, 0.09140457212924957, 0.0886809378862381, 0.0908878743648529, 0.09139497578144073], [0.08864273875951767, 0.08872802555561066, 0.08965403586626053, 0.08889883011579514, 0.08982663601636887, 0.09121237695217133, 0.0913001298904419, 0.08797020465135574, 0.10483378916978836, 0.09090939909219742, 0.08802378922700882], [0.08434339612722397, 0.08456501364707947, 0.0869951844215393, 0.08500999957323074, 0.0874529629945755, 0.09118379652500153, 0.0914233922958374, 0.08260858803987503, 0.13331209123134613, 0.0903596505522728, 0.08274596929550171], [0.08405643701553345, 0.08428610861301422, 0.08680608123540878, 0.0847473219037056, 0.08728109300136566, 0.0911560133099556, 0.09140507876873016, 0.08225946873426437, 0.13530118763446808, 0.09029948711395264, 0.08240172266960144], [0.09374973177909851, 0.09362735599279404, 0.09231619536876678, 0.0933830738067627, 0.09207533299922943, 0.09018038958311081, 0.09006267040967941, 0.0947246253490448, 0.07464544475078583, 0.09058888256549835, 0.09464630484580994], [0.029050547629594803, 0.029570480808615685, 0.035812679678201675, 0.030638432130217552, 0.037106070667505264, 0.0492144338786602, 0.05009525269269943, 0.02524290420114994, 0.6414565443992615, 0.04628464952111244, 0.025528065860271454], [0.08532053977251053, 0.08551382273435593, 0.08762874454259872, 0.08590169996023178, 0.08802622556686401, 0.0912550836801529, 0.09146181493997574, 0.08380509912967682, 0.12661832571029663, 0.09054341167211533, 0.0839252769947052], [0.09361214190721512, 0.09349612891674042, 0.09225264936685562, 0.09326452016830444, 0.09202412515878677, 0.09022517502307892, 0.09011335670948029, 0.09453608095645905, 0.07540077716112137, 0.09061313420534134, 0.09446187317371368]], [[0.09094486385583878, 0.08982251584529877, 0.08986955881118774, 0.09108783304691315, 0.09113553166389465, 0.09071674197912216, 0.09194649755954742, 0.09081178903579712, 0.09204283356666565, 0.0901995450258255, 0.09142228960990906], [0.09072712808847427, 0.09502862393856049, 0.09484320133924484, 0.09019707888364792, 0.09002108126878738, 0.09158111363649368, 0.08709479123353958, 0.0912240743637085, 0.08675523847341537, 0.09355533123016357, 0.0889723002910614], [0.09073879569768906, 0.0948057472705841, 0.0946306437253952, 0.09023694694042206, 0.09007027000188828, 0.09154702723026276, 0.0872964933514595, 0.09120915830135345, 0.08697432279586792, 0.09341391921043396, 0.08907671272754669], [0.09096363931894302, 0.0891759917140007, 0.08925065398216248, 0.09119230508804321, 0.09126865118741989, 0.09059921652078629, 0.09257020056247711, 0.09075098484754562, 0.09272526949644089, 0.08977504074573517, 0.0917280912399292], [0.09096945822238922, 0.08896109461784363, 0.08904487639665604, 0.09122671186923981, 0.09131262451410294, 0.09055963158607483, 0.09277859330177307, 0.09073028713464737, 0.09295342117547989, 0.08963353931903839, 0.0918298065662384], [0.09091075509786606, 0.09086189419031143, 0.09086395055055618, 0.0909169390797615, 0.09091899544000626, 0.09090087562799454, 0.09095387160778046, 0.09090499579906464, 0.09095799922943115, 0.09087837487459183, 0.09093136340379715], [0.09103462100028992, 0.0853712409734726, 0.0856027603149414, 0.0917772650718689, 0.09202615916728973, 0.08985965698957443, 0.09634121507406235, 0.09034770727157593, 0.09686446189880371, 0.08724108338356018, 0.09353375434875488], [0.09092558920383453, 0.09042768180370331, 0.09044861793518066, 0.09098876267671585, 0.09100983291864395, 0.0908246636390686, 0.09136705845594406, 0.09086672961711884, 0.09140937775373459, 0.09059532731771469, 0.09113635122776031], [0.09103817492723465, 0.08495272696018219, 0.08520090579986572, 0.09183838218450546, 0.09210667014122009, 0.08977319300174713, 0.0967668667435646, 0.09029848128557205, 0.09733307361602783, 0.08695857226848602, 0.09373298287391663], [0.09081432223320007, 0.09325380623340607, 0.09314963966608047, 0.09051032364368439, 0.09040921181440353, 0.09130250662565231, 0.08871553093194962, 0.09109864383935928, 0.0885174423456192, 0.0924236848950386, 0.08980494737625122], [0.09099974483251572, 0.08767805993556976, 0.08781563490629196, 0.09142879396677017, 0.09157225489616394, 0.09031793475151062, 0.09403403848409653, 0.0906015932559967, 0.09432937204837799, 0.08878473937511444, 0.09243777394294739]], [[0.09911710023880005, 0.09180693328380585, 0.08777011185884476, 0.10008233785629272, 0.09568164497613907, 0.10073104500770569, 0.09330184012651443, 0.09661342203617096, 0.0566125214099884, 0.09196724742650986, 0.08631581813097], [0.09293124079704285, 0.09128487855195999, 0.09033221006393433, 0.0931416004896164, 0.09216955304145813, 0.09328210353851318, 0.0916295275092125, 0.09237818419933319, 0.08154790103435516, 0.09132204204797745, 0.08998076617717743], [0.0889674574136734, 0.09045673161745071, 0.09134241193532944, 0.08878082782030106, 0.08965009450912476, 0.08865662664175034, 0.09014070779085159, 0.0894620344042778, 0.10044683516025543, 0.09042254090309143, 0.09167370200157166], [0.09985365718603134, 0.09180450439453125, 0.0873858630657196, 0.10092087835073471, 0.09606346487998962, 0.10163868218660355, 0.09344563633203506, 0.09709016978740692, 0.05401798337697983, 0.09198037534952164, 0.08579879999160767], [0.09635208547115326, 0.0916924774646759, 0.08906328678131104, 0.09695812314748764, 0.09417795389890671, 0.09736426919698715, 0.092655710875988, 0.09477031975984573, 0.06706400960683823, 0.09179604053497314, 0.0881057009100914], [0.10033942759037018, 0.09179527312517166, 0.08712342381477356, 0.10147539526224136, 0.09631088376045227, 0.10223984718322754, 0.09353387355804443, 0.09740124642848969, 0.05235036835074425, 0.09198150783777237, 0.08544876426458359], [0.09429220110177994, 0.09148180484771729, 0.08987149596214294, 0.09465380012989044, 0.09298764914274216, 0.0948956310749054, 0.09206725656986237, 0.09334423393011093, 0.07558072358369827, 0.09154486656188965, 0.08928040415048599], [0.09712526202201843, 0.09174405038356781, 0.08872561156749725, 0.09782806783914566, 0.09460946172475815, 0.09829942882061005, 0.09285315871238708, 0.0952940583229065, 0.06402818113565445, 0.09186320751905441, 0.0876295417547226], [0.03821704536676407, 0.054384004324674606, 0.06689541786909103, 0.03654908388853073, 0.04495745152235031, 0.03547775000333786, 0.050485894083976746, 0.042995303869247437, 0.5038438439369202, 0.05394884943962097, 0.07224529981613159], [0.09307979792356491, 0.0913085862994194, 0.09028475731611252, 0.0933062806725502, 0.09226004779338837, 0.09345757216215134, 0.0916791707277298, 0.09248453378677368, 0.08088347315788269, 0.0913485437631607, 0.08990726619958878], [0.08742585778236389, 0.0900353267788887, 0.09160301089286804, 0.08710120618343353, 0.08861780166625977, 0.08688545227050781, 0.08947879076004028, 0.08828873932361603, 0.10839630663394928, 0.08997504413127899, 0.09219244122505188]], [[0.09223956614732742, 0.09411942213773727, 0.09392596036195755, 0.09373290091753006, 0.0935402363538742, 0.09052585810422897, 0.0903397873044014, 0.08568385988473892, 0.08550773561000824, 0.08799217641353607, 0.09239254891872406], [0.09286926686763763, 0.09571821242570877, 0.09542370587587357, 0.09513010084629059, 0.09483740478754044, 0.09029717743396759, 0.0900193452835083, 0.08316093683242798, 0.08290506899356842, 0.08653862774372101, 0.09310004115104675], [0.09280604869127274, 0.09555515646934509, 0.09527110308408737, 0.0949878841638565, 0.09470552206039429, 0.09032163769006729, 0.09005313366651535, 0.08341587334871292, 0.0831679031252861, 0.0866868793964386, 0.09302884340286255], [0.09274259209632874, 0.09539209306240082, 0.0951184555888176, 0.09484560042619705, 0.09457352757453918, 0.0903458297252655, 0.0900866687297821, 0.08367134630680084, 0.08343132585287094, 0.08683512359857559, 0.09295741468667984], [0.09267891198396683, 0.09522902965545654, 0.09496577829122543, 0.09470324963331223, 0.09444145113229752, 0.09036977589130402, 0.09011995047330856, 0.08392734825611115, 0.08369533717632294, 0.08698336780071259, 0.09288577735424042], [0.0916348472237587, 0.09263377636671066, 0.09253140538930893, 0.09242913872003555, 0.09232699871063232, 0.09071595966815948, 0.09061571210622787, 0.08807525783777237, 0.08797792345285416, 0.08934253454208374, 0.09171648323535919], [0.09156735986471176, 0.09247081726789474, 0.09237827360630035, 0.09228581935167313, 0.09219345450401306, 0.09073547273874283, 0.09064466506242752, 0.08834032714366913, 0.08825191855430603, 0.08949059993028641, 0.09164123237133026], [0.08975623548030853, 0.08828608691692352, 0.08843491226434708, 0.08858399093151093, 0.08873330801725388, 0.09114473313093185, 0.09129837900400162, 0.09533974528312683, 0.09550046175718307, 0.09328751266002655, 0.08963456749916077], [0.08968290686607361, 0.08812367171049118, 0.08828143775463104, 0.08843949437141418, 0.08859781920909882, 0.0911569893360138, 0.09132019430398941, 0.09561897069215775, 0.09579016268253326, 0.09343457967042923, 0.08955379575490952], [0.09068428725004196, 0.09038685262203217, 0.09041713923215866, 0.09044744074344635, 0.09047774970531464, 0.09096164256334305, 0.09099213033914566, 0.09177953749895096, 0.09181029349565506, 0.09138309955596924, 0.09065981954336166], [0.09229209274053574, 0.09425072371959686, 0.09404908120632172, 0.09384787827730179, 0.09364710748195648, 0.09050800651311874, 0.09031438082456589, 0.08547466993331909, 0.08529181033372879, 0.08787278831005096, 0.09245143085718155]], [[0.10143224149942398, 0.09395132213830948, 0.08982021361589432, 0.09456029534339905, 0.09791654348373413, 0.09517320990562439, 0.09548114985227585, 0.09128277748823166, 0.057934876531362534, 0.09411538392305374, 0.08833195269107819], [0.093411885201931, 0.09175701439380646, 0.09079940617084503, 0.09189542382955551, 0.09264625608921051, 0.09203404933214188, 0.09210343658924103, 0.09114222228527069, 0.08196968585252762, 0.09179436415433884, 0.09044615179300308], [0.0885549858212471, 0.09003736078739166, 0.09091892838478088, 0.08991140127182007, 0.08923446387052536, 0.0897856131196022, 0.08972278982400894, 0.09060128033161163, 0.09998112916946411, 0.09000332653522491, 0.09124868363142014], [0.09409990161657333, 0.0919761136174202, 0.09075199067592621, 0.09215334057807922, 0.09311601519584656, 0.09233091026544571, 0.0924198254942894, 0.09118980914354324, 0.0796368345618248, 0.09202393889427185, 0.09030131250619888], [0.09777521342039108, 0.09304678440093994, 0.0903787612915039, 0.09343653917312622, 0.09556896984577179, 0.09382793307304382, 0.09402424097061157, 0.0913281962275505, 0.06805455684661865, 0.09315186738967896, 0.08940701931715012], [0.09478558599948883, 0.0921885296702385, 0.0906975194811821, 0.09240476042032242, 0.09358085691928864, 0.09262150526046753, 0.0927300676703453, 0.09123029559850693, 0.07736433297395706, 0.092246875166893, 0.09014967828989029], [0.09512757509946823, 0.09229228645563126, 0.09066770225763321, 0.0925280824303627, 0.09381145983934402, 0.0927644893527031, 0.0928829088807106, 0.09124793112277985, 0.0762503370642662, 0.09235590696334839, 0.09007136523723602], [0.09031382948160172, 0.09069551527500153, 0.09092028439044952, 0.09066326916217804, 0.09048937261104584, 0.09063103049993515, 0.090614914894104, 0.09083949029445648, 0.09314154833555222, 0.09068680554628372, 0.09100394695997238], [0.0363587811589241, 0.05173961818218231, 0.06364265084266663, 0.05022301524877548, 0.04277142137289047, 0.0487508699297905, 0.04803105816245079, 0.05908091738820076, 0.47934359312057495, 0.05132561922073364, 0.06873240321874619], [0.09359791874885559, 0.09181685000658035, 0.09078731387853622, 0.09196572750806808, 0.09277360886335373, 0.09211485087871552, 0.0921894982457161, 0.09115578979253769, 0.0813337042927742, 0.09185702353715897, 0.09040772169828415], [0.08671794086694717, 0.08930628001689911, 0.09086126834154129, 0.08908504992723465, 0.08790024369955063, 0.08886437863111496, 0.08875424414873123, 0.09029962122440338, 0.10751857608556747, 0.0892464816570282, 0.0914459303021431]]]}, "num_training_step_calls_per_iteration": 1, "evaluation": {"env_runners": {"module_to_env_connector": {"timers": {"connectors": {"remove_single_ts_time_rank_from_batch": 1.1755631724501308e-05, "get_actions": 3.535964736466206e-05, "normalize_and_clip_actions": 7.81392191734977e-06, "listify_data_for_vector_env": 1.0425691201675434e-05, "tensor_to_numpy": 1.4838479525517094e-05, "un_batch_to_individual_items": 6.526184009724131e-06}}, "connector_pipeline_timer": 0.00011305679207716877}, "episode_len_max": 20, "num_agent_steps_sampled_lifetime": {"default_agent": 8000}, "num_module_steps_sampled_lifetime": {"default_policy": 8000}, "episode_return_max": 14.5, "env_reset_timer": 0.0005213731935978046, "rlmodule_inference_timer": 3.0171372656451683e-05, "env_step_timer": 1.3887882280799805e-05, "env_to_module_connector": {"timers": {"connectors": {"add_states_from_episodes_to_batch": 2.772334893905015e-06, "numpy_to_tensor": 1.1774407210853758e-05, "add_time_dim_to_batch_and_zero_pad": 7.1643363948508326e-06, "add_observations_from_episodes_to_batch": 2.8545842776064097e-06, "batch_individual_items": 1.2490990236734359e-05}}, "connector_pipeline_timer": 5.972233528334114e-05}, "episode_len_min": 20, "env_to_module_sum_episodes_length_out": 10.368238394574323, "env_to_module_sum_episodes_length_in": 10.368238394574323, "num_env_steps_sampled_lifetime": 100400, "num_agent_steps_sampled": {"default_agent": 400}, "weights_seq_no": 20.0, "module_episode_returns_mean": {"default_policy": 0.45}, "episode_len_mean": 20.0, "sample": 0.12538154020218037, "agent_episode_returns_mean": {"default_agent": 0.45}, "episode_return_mean": 0.45, "episode_return_min": -12.5, "num_episodes": 20, "episode_duration_sec_mean": 0.00539260120363906, "num_module_steps_sampled": {"default_policy": 400}, "num_episodes_lifetime": 400, "num_env_steps_sampled": 400, "time_between_sampling": 9.446014701931006}, "num_healthy_workers": 1, "actor_manager_num_outstanding_async_reqs": 0, "num_remote_worker_restarts": 0}, "num_env_steps_sampled_lifetime": -11105000.0, "fault_tolerance": {"num_healthy_workers": 0, "num_remote_worker_restarts": 0}, "env_runner_group": {"actor_manager_num_outstanding_async_reqs": 0}, "done": true, "training_iteration": 20, "trial_id": "b9446_00000", "date": "2025-08-11_18-37-27", "timestamp": 1754930247, "time_this_iter_s": 9.073596239089966, "time_total_s": 193.95838904380798, "pid": 11415, "hostname": "Mac", "node_ip": "127.0.0.1", "config": {"exploration_config": {}, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 2, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "env": "Umbrella", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": false, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 0, "create_local_env_runner": true, "num_envs_per_env_runner": 1, "gym_env_vectorize_mode": "SYNC", "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "episodes_to_numpy": true, "max_requests_in_flight_per_env_runner": 1, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "merge_env_runner_states": "training_only", "broadcast_env_runner_states": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "complete_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "sampler_perf_stats_ema_coef": null, "_is_online": true, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": "auto", "num_aggregator_actors_per_learner": 0, "max_requests_in_flight_per_aggregator_actor": 3, "local_gpu_idx": 0, "max_requests_in_flight_per_learner": 3, "gamma": 1, "lr": 0.0002715581955, "grad_clip": 0.5, "grad_clip_by": "global_norm", "_train_batch_size_per_learner": 5000, "train_batch_size": 4000, "num_epochs": 1, "minibatch_size": 1000, "shuffle_batch_per_epoch": true, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "log_std_clip_param": 20.0, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "_disable_preprocessor_api": false, "_disable_action_flattening": false}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {"intrinsic_reward_coeff": 0.2795015916508}, "optimizer": {}, "_learner_class": "<class 'source.intrinsic_attention_ppo.learners.IntrinsicAttentionMetaLearner.IntrinsicAttentionMetaLearner'>", "callbacks_on_algorithm_init": null, "callbacks_on_env_runners_recreated": null, "callbacks_on_offline_eval_runners_recreated": null, "callbacks_on_checkpoint_loaded": null, "callbacks_on_environment_created": null, "callbacks_on_episode_created": null, "callbacks_on_episode_start": null, "callbacks_on_episode_step": null, "callbacks_on_episode_end": null, "callbacks_on_evaluate_start": null, "callbacks_on_evaluate_end": null, "callbacks_on_evaluate_offline_start": null, "callbacks_on_evaluate_offline_end": null, "callbacks_on_sample_end": null, "callbacks_on_train_result": null, "explore": true, "enable_rl_module_and_learner": true, "enable_env_runner_and_connector_v2": true, "_prior_exploration_config": {"type": "StochasticSampling"}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x3884998a0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "offline_data_class": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_read_batch_size": null, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "materialize_data": false, "materialize_mapped_data": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "ignore_final_observation": false, "prelearner_class": null, "prelearner_buffer_class": null, "prelearner_buffer_kwargs": {}, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_remaining_data": false, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": 1, "evaluation_duration": 20, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_auto_duration_min_env_steps_per_sample": 100, "evaluation_auto_duration_max_env_steps_per_sample": 2000, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 1, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "offline_evaluation_interval": null, "num_offline_eval_runners": 0, "offline_loss_for_module_fn": null, "offline_evaluation_duration": 1, "offline_evaluation_parallel_to_training": false, "offline_evaluation_timeout_s": 120.0, "num_cpus_per_offline_eval_runner": 1, "num_gpus_per_offline_eval_runner": 0, "custom_resources_per_offline_eval_runner": {}, "restart_failed_offline_eval_runners": true, "ignore_offline_eval_runner_failures": false, "max_num_offline_eval_runner_restarts": 1000, "offline_eval_runner_restore_timeout_s": 1800.0, "max_requests_in_flight_per_offline_eval_runner": 1, "validate_offline_eval_runners_after_construction": true, "offline_eval_runner_health_probe_timeout_s": 30.0, "offline_eval_rl_module_inference_only": false, "broadcast_offline_eval_runner_states": false, "offline_eval_batch_size_per_runner": 256, "dataset_num_iters_per_eval_runner": 1, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "log_gradients": false, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 7, "restart_failed_env_runners": true, "ignore_env_runner_failures": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30.0, "env_runner_restore_timeout_s": 1800.0, "_model_config": {}, "_rl_module_spec": "MultiRLModuleSpec(multi_rl_module_class=<class 'ray.rllib.core.rl_module.multi_rl_module.MultiRLModule'>, observation_space=None, action_space=None, inference_only=False, model_config=None, rl_module_specs={'default_policy': RLModuleSpec(module_class=<class 'source.intrinsic_attention_ppo.rl_modules.DifferentiablePPOModule.DifferentiablePPOModule'>, observation_space=None, action_space=None, inference_only=False, learner_only=False, model_config={'vf_share_layers': True, 'embedding_dim': 62, 'max_seq_len': 11, 'policy_head_hidden_sizes': [32], 'value_head_hidden_sizes': [101], 'embedding_hidden_sizes': [121]}, catalog_class=None, load_state_path=None, model_config_dict=None), 'intrinsic_reward_module': RLModuleSpec(module_class=<class 'source.intrinsic_attention_ppo.rl_modules.IntrinsicAttentionModule.IntrinsicAttentionModule'>, observation_space=None, action_space=None, inference_only=False, learner_only=True, model_config={'intrinsic_reward_network': {'encoder_hidden_sizes': [], 'encoding_dim': 1, 'num_heads': 1, 'head_hidden_sizes': None, 'layers': [{'type': 'attention'}]}, 'extrinsic_value_hidden_layers': [127, 60], 'vf_share_layers': True, 'max_seq_len': 11}, catalog_class=None, load_state_path=None, model_config_dict=None)}, load_state_path=None, modules_to_load=None, module_specs={'default_policy': RLModuleSpec(module_class=<class 'source.intrinsic_attention_ppo.rl_modules.DifferentiablePPOModule.DifferentiablePPOModule'>, observation_space=None, action_space=None, inference_only=False, learner_only=False, model_config={'vf_share_layers': True, 'embedding_dim': 62, 'max_seq_len': 11, 'policy_head_hidden_sizes': [32], 'value_head_hidden_sizes': [101], 'embedding_hidden_sizes': [121]}, catalog_class=None, load_state_path=None, model_config_dict=None), 'intrinsic_reward_module': RLModuleSpec(module_class=<class 'source.intrinsic_attention_ppo.rl_modules.IntrinsicAttentionModule.IntrinsicAttentionModule'>, observation_space=None, action_space=None, inference_only=False, learner_only=True, model_config={'intrinsic_reward_network': {'encoder_hidden_sizes': [], 'encoding_dim': 1, 'num_heads': 1, 'head_hidden_sizes': None, 'layers': [{'type': 'attention'}]}, 'extrinsic_value_hidden_layers': [127, 60], 'vf_share_layers': True, 'max_seq_len': 11}, catalog_class=None, load_state_path=None, model_config_dict=None)})", "algorithm_config_overrides_per_module": {"intrinsic_reward_module": {"lr": 0.0002715581955}}, "_per_module_overrides": {}, "_validate_config": true, "_use_msgpack_checkpoints": false, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "env_task_fn": -1, "enable_connectors": -1, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.161583927863, "kl_target": 0.0201019014258, "vf_loss_coeff": 0.7790510010087, "entropy_coeff": 0.0015431216992, "clip_param": 0.2459212356676, "vf_clip_param": 0.3769744131561, "entropy_coeff_schedule": null, "lr_schedule": null, "sgd_minibatch_size": -1, "vf_share_layers": -1, "differentiable_learner_configs": ["DifferentiableLearnerConfig(learner_class=<class 'source.intrinsic_attention_ppo.learners.IntrinsicAttentionPPOLearner.IntrinsicAttentionPPOLearner'>, learner_connector=None, add_default_connectors_to_learner_pipeline=True, is_multi_agent=False, policies_to_update=['default_policy'], lr=0.0060984166342, num_total_minibatches=0, num_epochs=1, minibatch_size=1000, shuffle_batch_per_epoch=True)"], "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9485408017724, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.callbacks.callbacks.RLlibCallback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 193.95838904380798, "iterations_since_restore": 20, "perf": {"cpu_util_percent": 27.46923076923077, "ram_util_percent": 79.35384615384615}}
