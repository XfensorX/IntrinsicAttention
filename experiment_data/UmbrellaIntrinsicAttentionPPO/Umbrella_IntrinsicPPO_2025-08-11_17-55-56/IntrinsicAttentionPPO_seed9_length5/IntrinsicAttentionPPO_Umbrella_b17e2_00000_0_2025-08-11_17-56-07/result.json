{"timers": {"training_iteration": 9.608524832990952, "restore_env_runners": 2.1332991309463978e-05, "training_step": 9.608358333003707, "env_runner_sampling_timer": 1.7549677919596434, "learner_update_timer": 7.665467041078955, "synch_weights": 0.0007800000021234155}, "env_runners": {"module_to_env_connector": {"timers": {"connectors": {"listify_data_for_vector_env": 1.1537156924664567e-05, "remove_single_ts_time_rank_from_batch": 1.2841273846851738e-05, "tensor_to_numpy": 1.6763771969859105e-05, "un_batch_to_individual_items": 7.1915306264192834e-06, "normalize_and_clip_actions": 1.1425623986669118e-05, "get_actions": 5.154475476673454e-05}}, "connector_pipeline_timer": 0.00013964991452577641}, "env_to_module_sum_episodes_length_out": 10.191744832559449, "rlmodule_inference_timer": 5.900353014113438e-05, "env_to_module_connector": {"timers": {"connectors": {"add_observations_from_episodes_to_batch": 3.1920231093954957e-06, "add_time_dim_to_batch_and_zero_pad": 7.899861623476147e-06, "numpy_to_tensor": 1.4594625687043022e-05, "batch_individual_items": 1.359529512282024e-05, "add_states_from_episodes_to_batch": 2.9436377696449438e-06}}, "connector_pipeline_timer": 6.718733556208824e-05}, "episode_return_max": 14.5, "num_env_steps_sampled": 5000.0, "num_episodes": 250.0, "episode_len_max": 20, "sample": 0.007543037996175166, "weights_seq_no": 0.0, "num_episodes_lifetime": 31375.0, "env_to_module_sum_episodes_length_in": 10.191744832559449, "num_agent_steps_sampled": {"default_agent": 5000.0}, "num_env_steps_sampled_lifetime": 627500.0, "episode_duration_sec_mean": 0.0060596429966390105, "episode_return_mean": 4.019999999999998, "num_module_steps_sampled": {"default_policy": 5000.0}, "env_reset_timer": 9.467745869649325e-05, "num_module_steps_sampled_lifetime": {"default_policy": 627500.0}, "agent_episode_returns_mean": {"default_agent": 4.019999999999998}, "env_step_timer": 1.660754190229858e-05, "episode_return_min": -5.5, "episode_len_min": 20, "episode_len_mean": 20.0, "num_agent_steps_sampled_lifetime": {"default_agent": 627500.0}, "module_episode_returns_mean": {"default_policy": 4.019999999999998}, "time_between_sampling": 0.0006237123271974287, "num_env_steps_sampled_lifetime_throughput": 2854.8584467479777}, "__all_modules__": {"learner_connector_sum_episodes_length_in": 5000, "learner_connector": {"connector_pipeline_timer": 0.15184708393644542, "timers": {"connectors": {"add_one_ts_to_episodes_and_truncate": 0.008922290988266468, "add_observations_from_episodes_to_batch": 0.000853499979712069, "add_columns_from_episodes_to_train_batch": 0.041088709025643766, "add_time_dim_to_batch_and_zero_pad": 0.08975041704252362, "add_states_from_episodes_to_batch": 0.0035754169803112745, "batch_individual_items": 0.0074592920718714595, "numpy_to_tensor": 6.145797669887543e-05}}}, "learner_connector_sum_episodes_length_out": 5250}, "learners": {"intrinsic_reward_module": {"weights_seq_no": 1.0, "num_module_steps_trained_lifetime": 5985, "gradients_default_optimizer_global_norm": 0.0, "module_train_batch_size_mean": 998.9117791197002, "diff_num_grad_updates_vs_sampler_policy": 1.0, "num_trainable_parameters": 8266, "default_optimizer_learning_rate": 0.0002715581955, "total_loss": 0.0, "num_module_steps_trained": 5985, "curr_entropy_coeff": 0.0015431216992, "num_module_steps_trained_lifetime_throughput": 767.802058657618}, "differentiable_learners": {"intrinsic_attention_ppo_learner": {"intrinsic_reward_module": {"total_loss": 0.0, "num_module_steps_trained": 35910, "diff_num_grad_updates_vs_sampler_policy": 6.0, "weights_seq_no": 6.0, "num_module_steps_trained_lifetime": 35910, "module_train_batch_size_mean": 998.5423314844973}, "default_policy": {"vf_explained_var": 0.0018091797828674316, "total_loss": 0.2507988214492798, "vf_loss": 0.3236748278141022, "vf_loss_unclipped": 39.68598175048828, "weights_seq_no": 6.0, "num_module_steps_trained_lifetime": 35910, "module_train_batch_size_mean": 998.5423314844973, "entropy": 0.6930016875267029, "mean_kl_loss": 1.2283657270018011e-05, "use_intrinsic_rewards": 1.0, "policy_loss": -0.0002929721667896956, "num_module_steps_trained": 35910, "diff_num_grad_updates_vs_sampler_policy": 6.0}, "__all_modules__": {"num_env_steps_trained_lifetime": 216000, "num_module_steps_trained_lifetime": 71820, "num_module_steps_trained": 71820, "num_env_steps_trained": 216000, "num_env_steps_trained_lifetime_throughput": 62094.42941081956}}}, "default_policy": {"curr_kl_coeff": 0.08079196512699127, "num_module_steps_trained_lifetime": 5985, "module_train_batch_size_mean": 998.9117791197002, "entropy": 0.6929970383644104, "num_trainable_parameters": 16595, "mean_kl_loss": 1.3831397154717706e-05, "use_intrinsic_rewards": 0.0, "policy_loss": -0.0003110789111815393, "num_module_steps_trained": 5985, "diff_num_grad_updates_vs_sampler_policy": 1.0, "vf_explained_var": 0.006946861743927002, "total_loss": 0.24866224825382233, "vf_loss": 0.32095521688461304, "curr_entropy_coeff": 0.0015431216992, "vf_loss_unclipped": 39.41278839111328, "weights_seq_no": 1.0, "num_module_steps_trained_lifetime_throughput": 767.7891020738973}, "__all_modules__": {"num_module_steps_trained": 11970, "num_non_trainable_parameters": 0, "num_env_steps_trained": 36000, "num_env_steps_trained_lifetime": 36000, "num_module_steps_trained_lifetime": 11970, "num_trainable_parameters": 24861, "num_env_steps_trained_lifetime_throughput": 4624.0429990682305, "num_module_steps_trained_throughput": 31939224.53645752, "num_module_steps_trained_lifetime_throughput": 13201408.798997726}, "IntrinsicAttentionMask": [[[0.1669946014881134, 0.16615577042102814, 0.1656789481639862, 0.16738463938236237, 0.1669042855501175, 0.1668817102909088], [0.16679686307907104, 0.16646412014961243, 0.1662745326757431, 0.1669512391090393, 0.16676108539104462, 0.1667521446943283], [0.16668379306793213, 0.1666400283575058, 0.1666150689125061, 0.16670407354831696, 0.16667909920215607, 0.16667792201042175], [0.16708606481552124, 0.16601288318634033, 0.16540353000164032, 0.1675855666399002, 0.16697043180465698, 0.1669415384531021], [0.16697339713573456, 0.16618892550468445, 0.1657428741455078, 0.1673380732536316, 0.16688893735408783, 0.16686783730983734], [0.16696809232234955, 0.16619719564914703, 0.1657588630914688, 0.167326420545578, 0.16688509285449982, 0.16686435043811798]], [[0.16757279634475708, 0.1685989946126938, 0.1655530035495758, 0.16444100439548492, 0.1684386432170868, 0.16539554297924042], [0.16769254207611084, 0.16885656118392944, 0.16540424525737762, 0.16414600610733032, 0.16867460310459137, 0.165226012468338], [0.1673344075679779, 0.16808775067329407, 0.16584806144237518, 0.1650277078151703, 0.16797010600566864, 0.1657319813966751], [0.16720157861709595, 0.1678038090467453, 0.16601179540157318, 0.16535422205924988, 0.16770979762077332, 0.16591879725456238], [0.16767390072345734, 0.16881641745567322, 0.16542746126651764, 0.16419197618961334, 0.16863782703876495, 0.1652524471282959], [0.16731566190719604, 0.16804765164852142, 0.16587118804454803, 0.16507378220558167, 0.1679333597421646, 0.16575837135314941]], [[0.1669946014881134, 0.16615577042102814, 0.165678933262825, 0.16738463938236237, 0.1669042855501175, 0.1668817102909088], [0.16679686307907104, 0.16646412014961243, 0.1662745326757431, 0.1669512391090393, 0.16676108539104462, 0.1667521446943283], [0.16668379306793213, 0.1666400283575058, 0.1666150689125061, 0.16670407354831696, 0.16667909920215607, 0.16667792201042175], [0.16708606481552124, 0.16601288318634033, 0.16540353000164032, 0.1675855666399002, 0.16697043180465698, 0.1669415384531021], [0.16697339713573456, 0.16618892550468445, 0.1657428741455078, 0.1673380732536316, 0.16688893735408783, 0.16686783730983734], [0.16696809232234955, 0.16619719564914703, 0.1657588630914688, 0.167326420545578, 0.16688509285449982, 0.16686435043811798]], [[0.1671632081270218, 0.1675141155719757, 0.16610154509544373, 0.1660834550857544, 0.16709037125110626, 0.16604726016521454], [0.16735534369945526, 0.16784292459487915, 0.16588261723518372, 0.16585755348205566, 0.16725417971611023, 0.16580741107463837], [0.16657884418964386, 0.16651710867881775, 0.16676652431488037, 0.16676972806453705, 0.16659167408943176, 0.1667761504650116], [0.1665688306093216, 0.16650007665157318, 0.16677787899971008, 0.1667814552783966, 0.1665831208229065, 0.16678860783576965], [0.16712327301502228, 0.1674458384513855, 0.16614705324172974, 0.1661304086446762, 0.16705632209777832, 0.16609711945056915], [0.16654883325099945, 0.16646602749824524, 0.1668006181716919, 0.16680490970611572, 0.16656602919101715, 0.16681353747844696]], [[0.16707055270671844, 0.16577671468257904, 0.1657542884349823, 0.16700278222560883, 0.16698019206523895, 0.16741546988487244], [0.16669431328773499, 0.16660575568675995, 0.16660422086715698, 0.1666896939277649, 0.16668814420700073, 0.16671781241893768], [0.1666877716779709, 0.16662020981311798, 0.16661904752254486, 0.16668424010276794, 0.16668307781219482, 0.16670569777488708], [0.16705095767974854, 0.1658199429512024, 0.1657986044883728, 0.16698648035526276, 0.16696500778198242, 0.16737905144691467], [0.16704443097114563, 0.16583435237407684, 0.1658133715391159, 0.1669810563325882, 0.16695992648601532, 0.1673669070005417], [0.16717013716697693, 0.1655571162700653, 0.16552917659282684, 0.16708555817604065, 0.16705738008022308, 0.16760066151618958]], [[0.16757269203662872, 0.16859889030456543, 0.16555288434028625, 0.16550038754940033, 0.16843853890895844, 0.16433660686016083], [0.1676924079656601, 0.1688564270734787, 0.16540409624576569, 0.16534467041492462, 0.16867446899414062, 0.16402792930603027], [0.16733433306217194, 0.1680876761674881, 0.1658479869365692, 0.1658092737197876, 0.16797003149986267, 0.16495062410831451], [0.1673281043767929, 0.1680743247270584, 0.16585570573806763, 0.16581736505031586, 0.16795779764652252, 0.16496670246124268], [0.1676737666130066, 0.16881628334522247, 0.1654272973537445, 0.1653689444065094, 0.1686376929283142, 0.16407601535320282], [0.16718901693820953, 0.16777704656124115, 0.16602715849876404, 0.16599687933921814, 0.16768527030944824, 0.1653245985507965]]]}, "num_training_step_calls_per_iteration": 1, "num_env_steps_sampled_lifetime": 627500.0, "evaluation": {"env_runners": {"episode_len_min": 20, "env_to_module_connector": {"timers": {"connectors": {"numpy_to_tensor": 1.5964711286901213e-05, "add_states_from_episodes_to_batch": 3.475054493182373e-06, "batch_individual_items": 1.4742009468438444e-05, "add_time_dim_to_batch_and_zero_pad": 8.467742019290522e-06, "add_observations_from_episodes_to_batch": 3.3338733126042383e-06}}, "connector_pipeline_timer": 7.221953900991684e-05}, "module_to_env_connector": {"timers": {"connectors": {"tensor_to_numpy": 1.9823629486266718e-05, "un_batch_to_individual_items": 7.845209105667611e-06, "normalize_and_clip_actions": 1.0455251417622258e-05, "get_actions": 5.375337045022074e-05, "remove_single_ts_time_rank_from_batch": 1.4630392494435533e-05, "listify_data_for_vector_env": 1.2243266586276676e-05}}, "connector_pipeline_timer": 0.0001505078605937252}, "num_env_steps_sampled": 400, "episode_len_max": 20, "num_agent_steps_sampled": {"default_agent": 400}, "weights_seq_no": 1.0, "num_env_steps_sampled_lifetime": 5400, "episode_duration_sec_mean": 0.006235272949561476, "episode_return_mean": 0.7, "env_reset_timer": 0.00015587511006742716, "module_episode_returns_mean": {"default_policy": 0.7}, "rlmodule_inference_timer": 4.2859476186787956e-05, "episode_return_max": 15.5, "env_to_module_sum_episodes_length_in": 10.216013141322508, "num_module_steps_sampled": {"default_policy": 400}, "agent_episode_returns_mean": {"default_agent": 0.7}, "num_agent_steps_sampled_lifetime": {"default_agent": 400}, "num_module_steps_sampled_lifetime": {"default_policy": 400}, "env_to_module_sum_episodes_length_out": 10.216013141322508, "num_episodes": 20, "num_episodes_lifetime": 20, "episode_return_min": -13.5, "sample": 0.13688933302182704, "env_step_timer": 1.887309478916928e-05, "episode_len_mean": 20.0}, "num_healthy_workers": 1, "actor_manager_num_outstanding_async_reqs": 0, "num_remote_worker_restarts": 0}, "fault_tolerance": {"num_healthy_workers": 0, "num_remote_worker_restarts": 0}, "env_runner_group": {"actor_manager_num_outstanding_async_reqs": 0}, "done": false, "training_iteration": 1, "trial_id": "b17e2_00000", "date": "2025-08-11_18-43-19", "timestamp": 1754930599, "time_this_iter_s": 9.754230976104736, "time_total_s": 9.754230976104736, "pid": 11680, "hostname": "Mac", "node_ip": "127.0.0.1", "config": {"exploration_config": {}, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 2, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "env": "Umbrella", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": false, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 0, "create_local_env_runner": true, "num_envs_per_env_runner": 1, "gym_env_vectorize_mode": "SYNC", "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "episodes_to_numpy": true, "max_requests_in_flight_per_env_runner": 1, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "merge_env_runner_states": "training_only", "broadcast_env_runner_states": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "complete_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "sampler_perf_stats_ema_coef": null, "_is_online": true, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": "auto", "num_aggregator_actors_per_learner": 0, "max_requests_in_flight_per_aggregator_actor": 3, "local_gpu_idx": 0, "max_requests_in_flight_per_learner": 3, "gamma": 1, "lr": 0.0002715581955, "grad_clip": 0.5, "grad_clip_by": "global_norm", "_train_batch_size_per_learner": 5000, "train_batch_size": 4000, "num_epochs": 1, "minibatch_size": 1000, "shuffle_batch_per_epoch": true, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "log_std_clip_param": 20.0, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "_disable_preprocessor_api": false, "_disable_action_flattening": false}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {"intrinsic_reward_coeff": 0.2795015916508}, "optimizer": {}, "_learner_class": "<class 'source.intrinsic_attention_ppo.learners.IntrinsicAttentionMetaLearner.IntrinsicAttentionMetaLearner'>", "callbacks_on_algorithm_init": null, "callbacks_on_env_runners_recreated": null, "callbacks_on_offline_eval_runners_recreated": null, "callbacks_on_checkpoint_loaded": null, "callbacks_on_environment_created": null, "callbacks_on_episode_created": null, "callbacks_on_episode_start": null, "callbacks_on_episode_step": null, "callbacks_on_episode_end": null, "callbacks_on_evaluate_start": null, "callbacks_on_evaluate_end": null, "callbacks_on_evaluate_offline_start": null, "callbacks_on_evaluate_offline_end": null, "callbacks_on_sample_end": null, "callbacks_on_train_result": null, "explore": true, "enable_rl_module_and_learner": true, "enable_env_runner_and_connector_v2": true, "_prior_exploration_config": {"type": "StochasticSampling"}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x13c0118a0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "offline_data_class": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_read_batch_size": null, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "materialize_data": false, "materialize_mapped_data": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "ignore_final_observation": false, "prelearner_class": null, "prelearner_buffer_class": null, "prelearner_buffer_kwargs": {}, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_remaining_data": false, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": 1, "evaluation_duration": 20, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_auto_duration_min_env_steps_per_sample": 100, "evaluation_auto_duration_max_env_steps_per_sample": 2000, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 1, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "offline_evaluation_interval": null, "num_offline_eval_runners": 0, "offline_loss_for_module_fn": null, "offline_evaluation_duration": 1, "offline_evaluation_parallel_to_training": false, "offline_evaluation_timeout_s": 120.0, "num_cpus_per_offline_eval_runner": 1, "num_gpus_per_offline_eval_runner": 0, "custom_resources_per_offline_eval_runner": {}, "restart_failed_offline_eval_runners": true, "ignore_offline_eval_runner_failures": false, "max_num_offline_eval_runner_restarts": 1000, "offline_eval_runner_restore_timeout_s": 1800.0, "max_requests_in_flight_per_offline_eval_runner": 1, "validate_offline_eval_runners_after_construction": true, "offline_eval_runner_health_probe_timeout_s": 30.0, "offline_eval_rl_module_inference_only": false, "broadcast_offline_eval_runner_states": false, "offline_eval_batch_size_per_runner": 256, "dataset_num_iters_per_eval_runner": 1, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "log_gradients": false, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 9, "restart_failed_env_runners": true, "ignore_env_runner_failures": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30.0, "env_runner_restore_timeout_s": 1800.0, "_model_config": {}, "_rl_module_spec": "MultiRLModuleSpec(multi_rl_module_class=<class 'ray.rllib.core.rl_module.multi_rl_module.MultiRLModule'>, observation_space=None, action_space=None, inference_only=False, model_config=None, rl_module_specs={'default_policy': RLModuleSpec(module_class=<class 'source.intrinsic_attention_ppo.rl_modules.DifferentiablePPOModule.DifferentiablePPOModule'>, observation_space=None, action_space=None, inference_only=False, learner_only=False, model_config={'vf_share_layers': True, 'embedding_dim': 62, 'max_seq_len': 6, 'policy_head_hidden_sizes': [32], 'value_head_hidden_sizes': [101], 'embedding_hidden_sizes': [121]}, catalog_class=None, load_state_path=None, model_config_dict=None), 'intrinsic_reward_module': RLModuleSpec(module_class=<class 'source.intrinsic_attention_ppo.rl_modules.IntrinsicAttentionModule.IntrinsicAttentionModule'>, observation_space=None, action_space=None, inference_only=False, learner_only=True, model_config={'intrinsic_reward_network': {'encoder_hidden_sizes': [], 'encoding_dim': 1, 'num_heads': 1, 'head_hidden_sizes': None, 'layers': [{'type': 'attention'}]}, 'extrinsic_value_hidden_layers': [127, 60], 'vf_share_layers': True, 'max_seq_len': 6}, catalog_class=None, load_state_path=None, model_config_dict=None)}, load_state_path=None, modules_to_load=None, module_specs={'default_policy': RLModuleSpec(module_class=<class 'source.intrinsic_attention_ppo.rl_modules.DifferentiablePPOModule.DifferentiablePPOModule'>, observation_space=None, action_space=None, inference_only=False, learner_only=False, model_config={'vf_share_layers': True, 'embedding_dim': 62, 'max_seq_len': 6, 'policy_head_hidden_sizes': [32], 'value_head_hidden_sizes': [101], 'embedding_hidden_sizes': [121]}, catalog_class=None, load_state_path=None, model_config_dict=None), 'intrinsic_reward_module': RLModuleSpec(module_class=<class 'source.intrinsic_attention_ppo.rl_modules.IntrinsicAttentionModule.IntrinsicAttentionModule'>, observation_space=None, action_space=None, inference_only=False, learner_only=True, model_config={'intrinsic_reward_network': {'encoder_hidden_sizes': [], 'encoding_dim': 1, 'num_heads': 1, 'head_hidden_sizes': None, 'layers': [{'type': 'attention'}]}, 'extrinsic_value_hidden_layers': [127, 60], 'vf_share_layers': True, 'max_seq_len': 6}, catalog_class=None, load_state_path=None, model_config_dict=None)})", "algorithm_config_overrides_per_module": {"intrinsic_reward_module": {"lr": 0.0002715581955}}, "_per_module_overrides": {}, "_validate_config": true, "_use_msgpack_checkpoints": false, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "env_task_fn": -1, "enable_connectors": -1, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.161583927863, "kl_target": 0.0201019014258, "vf_loss_coeff": 0.7790510010087, "entropy_coeff": 0.0015431216992, "clip_param": 0.2459212356676, "vf_clip_param": 0.3769744131561, "entropy_coeff_schedule": null, "lr_schedule": null, "sgd_minibatch_size": -1, "vf_share_layers": -1, "differentiable_learner_configs": ["DifferentiableLearnerConfig(learner_class=<class 'source.intrinsic_attention_ppo.learners.IntrinsicAttentionPPOLearner.IntrinsicAttentionPPOLearner'>, learner_connector=None, add_default_connectors_to_learner_pipeline=True, is_multi_agent=False, policies_to_update=['default_policy'], lr=0.0060984166342, num_total_minibatches=0, num_epochs=1, minibatch_size=1000, shuffle_batch_per_epoch=True)"], "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9485408017724, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.callbacks.callbacks.RLlibCallback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 9.754230976104736, "iterations_since_restore": 1, "perf": {"cpu_util_percent": 37.24285714285714, "ram_util_percent": 79.21428571428571}}
{"timers": {"training_iteration": 9.608437190491241, "restore_env_runners": 2.1292162127792835e-05, "training_step": 9.608267297593411, "env_runner_sampling_timer": 1.7549708119500427, "learner_update_timer": 7.664863590669119, "synch_weights": 0.000785852501867339, "restore_eval_env_runners": 8.08399636298418e-06, "evaluation_iteration": 0.14346333302091807, "synch_eval_env_connectors": 0.00013700011186301708, "synch_env_connectors": 4.999921657145023e-06}, "env_runners": {"module_to_env_connector": {"timers": {"connectors": {"listify_data_for_vector_env": 1.0937654910997665e-05, "remove_single_ts_time_rank_from_batch": 1.235797527637109e-05, "tensor_to_numpy": 1.6543330956613342e-05, "un_batch_to_individual_items": 6.908594383370265e-06, "normalize_and_clip_actions": 8.328417471655819e-06, "get_actions": 4.35169075114132e-05}}, "connector_pipeline_timer": 0.00012625126537036942}, "env_to_module_sum_episodes_length_out": 10.36823839457432, "rlmodule_inference_timer": 3.50097859025393e-05, "env_to_module_connector": {"timers": {"connectors": {"add_observations_from_episodes_to_batch": 2.9783073167212483e-06, "add_time_dim_to_batch_and_zero_pad": 7.337152857905838e-06, "numpy_to_tensor": 1.3860940656787253e-05, "batch_individual_items": 1.288989264462767e-05, "add_states_from_episodes_to_batch": 2.8212463824705277e-06}}, "connector_pipeline_timer": 6.269721646990725e-05}, "episode_return_max": 14.5, "num_env_steps_sampled": 5000.0, "num_episodes": 250.0, "episode_len_max": 20, "sample": 0.006192055686046535, "weights_seq_no": 1.0, "num_episodes_lifetime": 500.0, "env_to_module_sum_episodes_length_in": 10.36823839457432, "num_agent_steps_sampled": {"default_agent": 5000.0}, "num_env_steps_sampled_lifetime": 10000.0, "episode_duration_sec_mean": 0.005701610510703175, "episode_return_mean": 4.420000000000002, "num_module_steps_sampled": {"default_policy": 5000.0}, "env_reset_timer": 5.097686918286042e-05, "num_module_steps_sampled_lifetime": {"default_policy": 10000.0}, "agent_episode_returns_mean": {"default_agent": 4.420000000000002}, "env_step_timer": 1.5233468389534172e-05, "episode_return_min": -5.5, "episode_len_min": 20, "episode_len_mean": 20.0, "num_agent_steps_sampled_lifetime": {"default_agent": 10000.0}, "module_episode_returns_mean": {"default_policy": 4.420000000000002}, "time_between_sampling": 0.030186836345633423, "num_env_steps_sampled_lifetime_throughput": 3113.0014132912474}, "__all_modules__": {"learner_connector_sum_episodes_length_in": 5000.0, "learner_connector": {"connector_pipeline_timer": 0.15197334976750426, "timers": {"connectors": {"add_one_ts_to_episodes_and_truncate": 0.008951145987957716, "add_observations_from_episodes_to_batch": 0.0008540316391736269, "add_columns_from_episodes_to_train_batch": 0.04113814318552613, "add_time_dim_to_batch_and_zero_pad": 0.0897921487025451, "add_states_from_episodes_to_batch": 0.0035769461398012935, "batch_individual_items": 0.007462560820858925, "numpy_to_tensor": 6.178880692459642e-05}}}, "learner_connector_sum_episodes_length_out": 5250.0}, "learners": {"intrinsic_reward_module": {"weights_seq_no": 2.0, "num_module_steps_trained_lifetime": 11970, "gradients_default_optimizer_global_norm": 0.0, "module_train_batch_size_mean": 998.828720912135, "diff_num_grad_updates_vs_sampler_policy": 1.0, "num_trainable_parameters": 8266, "default_optimizer_learning_rate": 0.0002715581955, "total_loss": 0.0, "num_module_steps_trained": 5985, "curr_entropy_coeff": 0.0015431216992, "num_module_steps_trained_lifetime_throughput": 767.1546342905211}, "differentiable_learners": {"intrinsic_attention_ppo_learner": {"intrinsic_reward_module": {"total_loss": 0.0, "num_module_steps_trained": 35910, "diff_num_grad_updates_vs_sampler_policy": 11.0, "weights_seq_no": 12.0, "num_module_steps_trained_lifetime": 71820, "module_train_batch_size_mean": 998.2236050808158}, "default_policy": {"vf_explained_var": 0.0018353462219238281, "total_loss": 0.25018593668937683, "vf_loss": 0.3231186866760254, "vf_loss_unclipped": 40.86520004272461, "weights_seq_no": 12.0, "num_module_steps_trained_lifetime": 71820, "module_train_batch_size_mean": 998.2236050808158, "entropy": 0.6928303837776184, "mean_kl_loss": 3.9241193007910624e-05, "use_intrinsic_rewards": 1.0, "policy_loss": -0.00047725666081532836, "num_module_steps_trained": 35910, "diff_num_grad_updates_vs_sampler_policy": 11.0}, "__all_modules__": {"num_env_steps_trained_lifetime": 432000, "num_module_steps_trained_lifetime": 143640, "num_module_steps_trained": 71820, "num_env_steps_trained": 216000, "num_env_steps_trained_lifetime_throughput": 61770.14177437617}}}, "default_policy": {"curr_kl_coeff": 0.040395982563495636, "num_module_steps_trained_lifetime": 11970, "module_train_batch_size_mean": 998.828720912135, "entropy": 0.6928238868713379, "num_trainable_parameters": 16595, "mean_kl_loss": 4.1728784708539024e-05, "use_intrinsic_rewards": 0.0, "policy_loss": -0.0004946159315295517, "num_module_steps_trained": 5985, "diff_num_grad_updates_vs_sampler_policy": 1.0, "vf_explained_var": 0.007137596607208252, "total_loss": 0.2483411580324173, "vf_loss": 0.3207768201828003, "curr_entropy_coeff": 0.0015431216992, "vf_loss_unclipped": 40.57966232299805, "weights_seq_no": 2.0, "num_module_steps_trained_lifetime_throughput": 767.1418811211801}, "__all_modules__": {"num_module_steps_trained": 11970, "num_non_trainable_parameters": 0, "num_env_steps_trained": 36000, "num_env_steps_trained_lifetime": 72000, "num_module_steps_trained_lifetime": 23940, "num_trainable_parameters": 24861, "num_env_steps_trained_lifetime_throughput": 4620.084499633409, "num_module_steps_trained_throughput": 31494525.072857387, "num_module_steps_trained_lifetime_throughput": 13193986.524879752}, "IntrinsicAttentionMask": [[[0.16707055270671844, 0.16577669978141785, 0.1657542884349823, 0.16700278222560883, 0.16743811964988708, 0.16695760190486908], [0.16669431328773499, 0.16660577058792114, 0.16660423576831818, 0.1666896939277649, 0.16671936213970184, 0.16668662428855896], [0.1666877567768097, 0.16662020981311798, 0.16661903262138367, 0.16668424010276794, 0.1667068600654602, 0.16668188571929932], [0.16705094277858734, 0.1658199280500412, 0.1657985895872116, 0.16698646545410156, 0.16740058362483978, 0.1669435054063797], [0.16717664897441864, 0.16554269194602966, 0.16551439464092255, 0.16709096729755402, 0.16764143109321594, 0.1670338660478592], [0.16703787446022034, 0.1658487319946289, 0.16582812368869781, 0.16697560250759125, 0.16737554967403412, 0.16693410277366638]], [[0.16775059700012207, 0.16877788305282593, 0.16466768085956573, 0.1646154671907425, 0.1686173528432846, 0.16557101905345917], [0.1678938865661621, 0.16905930638313293, 0.16440214216709137, 0.16434307396411896, 0.16887712478637695, 0.1654243767261505], [0.16731391847133636, 0.16792364418506622, 0.1654750108718872, 0.16544373333454132, 0.16782847046852112, 0.16601526737213135], [0.16730643808841705, 0.16790904104709625, 0.1654888242483139, 0.16545790433883667, 0.1678149700164795, 0.16602283716201782], [0.16787157952785492, 0.16901543736457825, 0.16444352269172668, 0.16438551247119904, 0.16883663833141327, 0.16544725000858307], [0.1674429178237915, 0.16817545890808105, 0.16523680090904236, 0.16519932448863983, 0.16806107759475708, 0.16588442027568817]], [[0.16524164378643036, 0.1663587987422943, 0.1657250076532364, 0.16738498210906982, 0.16796477138996124, 0.16732485592365265], [0.16459156572818756, 0.1662161648273468, 0.1652938723564148, 0.16771288216114044, 0.16856037080287933, 0.1676250696182251], [0.16495966911315918, 0.16629710793495178, 0.16553811728954315, 0.1675271987915039, 0.16822285950183868, 0.16745507717132568], [0.1639995127916336, 0.1660851091146469, 0.16490037739276886, 0.16801169514656067, 0.16910478472709656, 0.1678985208272934], [0.16366711258888245, 0.1660110205411911, 0.16467911005020142, 0.16817951202392578, 0.16941122710704803, 0.16805203258991241], [0.16403406858444214, 0.16609278321266174, 0.16492336988449097, 0.16799424588680267, 0.1690729558467865, 0.16788256168365479]], [[0.16793192923069, 0.1678786724805832, 0.16484567523002625, 0.16585516929626465, 0.16879962384700775, 0.16468888521194458], [0.1679232120513916, 0.16787032783031464, 0.16485823690891266, 0.16586081683635712, 0.16878484189510345, 0.16470253467559814], [0.16742123663425446, 0.1673896163702011, 0.16558115184307098, 0.16618455946445465, 0.16793611645698547, 0.16548728942871094], [0.1675894558429718, 0.1675507128238678, 0.16533899307250977, 0.16607634723186493, 0.1682201325893402, 0.1652243733406067], [0.1680736541748047, 0.16801436245441437, 0.16464148461818695, 0.16576331853866577, 0.16903987526893616, 0.16446730494499207], [0.16739502549171448, 0.16736449301242828, 0.1656189113855362, 0.1662014126777649, 0.16789187490940094, 0.1655282974243164]], [[0.1669187694787979, 0.1660803258419037, 0.16605785489082336, 0.16685105860233307, 0.1672860085964203, 0.1668059378862381], [0.16676673293113708, 0.16643404960632324, 0.16642512381076813, 0.16673989593982697, 0.16691212356090546, 0.16672201454639435], [0.16676265001296997, 0.1664435714483261, 0.16643500328063965, 0.1667369157075882, 0.166902095079422, 0.16671976447105408], [0.16690655052661896, 0.16610881686210632, 0.16608744859695435, 0.16684213280677795, 0.16725587844848633, 0.16679920256137848], [0.16698504984378815, 0.16592606902122498, 0.16589771211147308, 0.16689947247505188, 0.16744931042194366, 0.16684244573116302], [0.16689838469028473, 0.16612781584262848, 0.1661071628332138, 0.16683615744113922, 0.16723577678203583, 0.16679468750953674]], [[0.16762562096118927, 0.16759991645812988, 0.1661292165517807, 0.16610373556613922, 0.16700352728366852, 0.16553805768489838], [0.16761189699172974, 0.1675865650177002, 0.16613692045211792, 0.1661117970943451, 0.1669987291097641, 0.16555416584014893], [0.16682372987270355, 0.1668195277452469, 0.16657871007919312, 0.16657452285289764, 0.16672208905220032, 0.1664814054965973], [0.1668100208044052, 0.1668061912059784, 0.16658636927604675, 0.16658255457878113, 0.1667172610759735, 0.16649755835533142], [0.16729296743869781, 0.16727620363235474, 0.16631574928760529, 0.16629908978939056, 0.1668870747089386, 0.16592887043952942], [0.16650529205799103, 0.16650958359241486, 0.1667570173740387, 0.16676132380962372, 0.16660961508750916, 0.16685718297958374]]]}, "num_training_step_calls_per_iteration": 1, "evaluation": {"env_runners": {"episode_len_min": 20, "env_to_module_connector": {"timers": {"connectors": {"numpy_to_tensor": 1.2254018686835545e-05, "add_states_from_episodes_to_batch": 2.7347265890927065e-06, "batch_individual_items": 1.2493355960971967e-05, "add_time_dim_to_batch_and_zero_pad": 7.331171424120933e-06, "add_observations_from_episodes_to_batch": 2.9068547134845228e-06}}, "connector_pipeline_timer": 5.972611118581224e-05}, "module_to_env_connector": {"timers": {"connectors": {"tensor_to_numpy": 1.528097744579029e-05, "un_batch_to_individual_items": 6.631686345385451e-06, "normalize_and_clip_actions": 7.887989573395114e-06, "get_actions": 3.738931804113322e-05, "remove_single_ts_time_rank_from_batch": 1.1964150087981452e-05, "listify_data_for_vector_env": 1.0546901037022604e-05}}, "connector_pipeline_timer": 0.00011559569481032963}, "num_env_steps_sampled": 400, "episode_len_max": 20, "num_agent_steps_sampled": {"default_agent": 400}, "weights_seq_no": 2.0, "num_env_steps_sampled_lifetime": 10400, "episode_duration_sec_mean": 0.005786888601141982, "episode_return_mean": -1.8, "env_reset_timer": 0.0001581284392159432, "module_episode_returns_mean": {"default_policy": -1.8}, "rlmodule_inference_timer": 3.206864441961185e-05, "episode_return_max": 15.5, "env_to_module_sum_episodes_length_in": 10.366003441359926, "num_module_steps_sampled": {"default_policy": 400}, "agent_episode_returns_mean": {"default_agent": -1.8}, "num_agent_steps_sampled_lifetime": {"default_agent": 800}, "num_module_steps_sampled_lifetime": {"default_policy": 800}, "env_to_module_sum_episodes_length_out": 10.366003441359926, "num_episodes": 20, "num_episodes_lifetime": 40, "episode_return_min": -13.5, "sample": 0.1366948759416118, "env_step_timer": 1.4186484071122477e-05, "episode_len_mean": 20.0, "time_between_sampling": 9.64272591599729}, "num_healthy_workers": 1, "actor_manager_num_outstanding_async_reqs": 0, "num_remote_worker_restarts": 0}, "num_env_steps_sampled_lifetime": 10000.0, "fault_tolerance": {"num_healthy_workers": 0, "num_remote_worker_restarts": 0}, "env_runner_group": {"actor_manager_num_outstanding_async_reqs": 0}, "done": false, "training_iteration": 2, "trial_id": "b17e2_00000", "date": "2025-08-11_18-43-29", "timestamp": 1754930609, "time_this_iter_s": 9.72817611694336, "time_total_s": 19.482407093048096, "pid": 11680, "hostname": "Mac", "node_ip": "127.0.0.1", "config": {"exploration_config": {}, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 2, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "env": "Umbrella", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": false, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 0, "create_local_env_runner": true, "num_envs_per_env_runner": 1, "gym_env_vectorize_mode": "SYNC", "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "episodes_to_numpy": true, "max_requests_in_flight_per_env_runner": 1, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "merge_env_runner_states": "training_only", "broadcast_env_runner_states": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "complete_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "sampler_perf_stats_ema_coef": null, "_is_online": true, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": "auto", "num_aggregator_actors_per_learner": 0, "max_requests_in_flight_per_aggregator_actor": 3, "local_gpu_idx": 0, "max_requests_in_flight_per_learner": 3, "gamma": 1, "lr": 0.0002715581955, "grad_clip": 0.5, "grad_clip_by": "global_norm", "_train_batch_size_per_learner": 5000, "train_batch_size": 4000, "num_epochs": 1, "minibatch_size": 1000, "shuffle_batch_per_epoch": true, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "log_std_clip_param": 20.0, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "_disable_preprocessor_api": false, "_disable_action_flattening": false}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {"intrinsic_reward_coeff": 0.2795015916508}, "optimizer": {}, "_learner_class": "<class 'source.intrinsic_attention_ppo.learners.IntrinsicAttentionMetaLearner.IntrinsicAttentionMetaLearner'>", "callbacks_on_algorithm_init": null, "callbacks_on_env_runners_recreated": null, "callbacks_on_offline_eval_runners_recreated": null, "callbacks_on_checkpoint_loaded": null, "callbacks_on_environment_created": null, "callbacks_on_episode_created": null, "callbacks_on_episode_start": null, "callbacks_on_episode_step": null, "callbacks_on_episode_end": null, "callbacks_on_evaluate_start": null, "callbacks_on_evaluate_end": null, "callbacks_on_evaluate_offline_start": null, "callbacks_on_evaluate_offline_end": null, "callbacks_on_sample_end": null, "callbacks_on_train_result": null, "explore": true, "enable_rl_module_and_learner": true, "enable_env_runner_and_connector_v2": true, "_prior_exploration_config": {"type": "StochasticSampling"}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x13c0118a0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "offline_data_class": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_read_batch_size": null, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "materialize_data": false, "materialize_mapped_data": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "ignore_final_observation": false, "prelearner_class": null, "prelearner_buffer_class": null, "prelearner_buffer_kwargs": {}, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_remaining_data": false, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": 1, "evaluation_duration": 20, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_auto_duration_min_env_steps_per_sample": 100, "evaluation_auto_duration_max_env_steps_per_sample": 2000, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 1, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "offline_evaluation_interval": null, "num_offline_eval_runners": 0, "offline_loss_for_module_fn": null, "offline_evaluation_duration": 1, "offline_evaluation_parallel_to_training": false, "offline_evaluation_timeout_s": 120.0, "num_cpus_per_offline_eval_runner": 1, "num_gpus_per_offline_eval_runner": 0, "custom_resources_per_offline_eval_runner": {}, "restart_failed_offline_eval_runners": true, "ignore_offline_eval_runner_failures": false, "max_num_offline_eval_runner_restarts": 1000, "offline_eval_runner_restore_timeout_s": 1800.0, "max_requests_in_flight_per_offline_eval_runner": 1, "validate_offline_eval_runners_after_construction": true, "offline_eval_runner_health_probe_timeout_s": 30.0, "offline_eval_rl_module_inference_only": false, "broadcast_offline_eval_runner_states": false, "offline_eval_batch_size_per_runner": 256, "dataset_num_iters_per_eval_runner": 1, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "log_gradients": false, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 9, "restart_failed_env_runners": true, "ignore_env_runner_failures": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30.0, "env_runner_restore_timeout_s": 1800.0, "_model_config": {}, "_rl_module_spec": "MultiRLModuleSpec(multi_rl_module_class=<class 'ray.rllib.core.rl_module.multi_rl_module.MultiRLModule'>, observation_space=None, action_space=None, inference_only=False, model_config=None, rl_module_specs={'default_policy': RLModuleSpec(module_class=<class 'source.intrinsic_attention_ppo.rl_modules.DifferentiablePPOModule.DifferentiablePPOModule'>, observation_space=None, action_space=None, inference_only=False, learner_only=False, model_config={'vf_share_layers': True, 'embedding_dim': 62, 'max_seq_len': 6, 'policy_head_hidden_sizes': [32], 'value_head_hidden_sizes': [101], 'embedding_hidden_sizes': [121]}, catalog_class=None, load_state_path=None, model_config_dict=None), 'intrinsic_reward_module': RLModuleSpec(module_class=<class 'source.intrinsic_attention_ppo.rl_modules.IntrinsicAttentionModule.IntrinsicAttentionModule'>, observation_space=None, action_space=None, inference_only=False, learner_only=True, model_config={'intrinsic_reward_network': {'encoder_hidden_sizes': [], 'encoding_dim': 1, 'num_heads': 1, 'head_hidden_sizes': None, 'layers': [{'type': 'attention'}]}, 'extrinsic_value_hidden_layers': [127, 60], 'vf_share_layers': True, 'max_seq_len': 6}, catalog_class=None, load_state_path=None, model_config_dict=None)}, load_state_path=None, modules_to_load=None, module_specs={'default_policy': RLModuleSpec(module_class=<class 'source.intrinsic_attention_ppo.rl_modules.DifferentiablePPOModule.DifferentiablePPOModule'>, observation_space=None, action_space=None, inference_only=False, learner_only=False, model_config={'vf_share_layers': True, 'embedding_dim': 62, 'max_seq_len': 6, 'policy_head_hidden_sizes': [32], 'value_head_hidden_sizes': [101], 'embedding_hidden_sizes': [121]}, catalog_class=None, load_state_path=None, model_config_dict=None), 'intrinsic_reward_module': RLModuleSpec(module_class=<class 'source.intrinsic_attention_ppo.rl_modules.IntrinsicAttentionModule.IntrinsicAttentionModule'>, observation_space=None, action_space=None, inference_only=False, learner_only=True, model_config={'intrinsic_reward_network': {'encoder_hidden_sizes': [], 'encoding_dim': 1, 'num_heads': 1, 'head_hidden_sizes': None, 'layers': [{'type': 'attention'}]}, 'extrinsic_value_hidden_layers': [127, 60], 'vf_share_layers': True, 'max_seq_len': 6}, catalog_class=None, load_state_path=None, model_config_dict=None)})", "algorithm_config_overrides_per_module": {"intrinsic_reward_module": {"lr": 0.0002715581955}}, "_per_module_overrides": {}, "_validate_config": true, "_use_msgpack_checkpoints": false, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "env_task_fn": -1, "enable_connectors": -1, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.161583927863, "kl_target": 0.0201019014258, "vf_loss_coeff": 0.7790510010087, "entropy_coeff": 0.0015431216992, "clip_param": 0.2459212356676, "vf_clip_param": 0.3769744131561, "entropy_coeff_schedule": null, "lr_schedule": null, "sgd_minibatch_size": -1, "vf_share_layers": -1, "differentiable_learner_configs": ["DifferentiableLearnerConfig(learner_class=<class 'source.intrinsic_attention_ppo.learners.IntrinsicAttentionPPOLearner.IntrinsicAttentionPPOLearner'>, learner_connector=None, add_default_connectors_to_learner_pipeline=True, is_multi_agent=False, policies_to_update=['default_policy'], lr=0.0060984166342, num_total_minibatches=0, num_epochs=1, minibatch_size=1000, shuffle_batch_per_epoch=True)"], "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9485408017724, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.callbacks.callbacks.RLlibCallback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 19.482407093048096, "iterations_since_restore": 2, "perf": {"cpu_util_percent": 39.8, "ram_util_percent": 79.95}}
{"timers": {"training_iteration": 9.606801775255404, "restore_env_runners": 2.115423991344869e-05, "training_step": 9.606631354617678, "env_runner_sampling_timer": 1.75281578133055, "learner_update_timer": 7.6638916093431755, "synch_weights": 0.000786425637092907, "restore_eval_env_runners": 8.328997064381837e-06, "evaluation_iteration": 0.14328501844080166, "synch_eval_env_connectors": 0.00013721928116865458, "synch_env_connectors": 4.996173083782196e-06}, "env_runners": {"module_to_env_connector": {"timers": {"connectors": {"listify_data_for_vector_env": 1.0551245833998551e-05, "remove_single_ts_time_rank_from_batch": 1.1997997140756965e-05, "tensor_to_numpy": 1.566935429772379e-05, "un_batch_to_individual_items": 6.729359032524331e-06, "normalize_and_clip_actions": 8.011685448435924e-06, "get_actions": 4.013417190351047e-05}}, "connector_pipeline_timer": 0.00011958556828147479}, "env_to_module_sum_episodes_length_out": 10.36823839457432, "rlmodule_inference_timer": 3.220054533245906e-05, "env_to_module_connector": {"timers": {"connectors": {"add_observations_from_episodes_to_batch": 2.8320459676215567e-06, "add_time_dim_to_batch_and_zero_pad": 6.9364992864120745e-06, "numpy_to_tensor": 1.2977352961415532e-05, "batch_individual_items": 1.2554281451916637e-05, "add_states_from_episodes_to_batch": 2.686139405582131e-06}}, "connector_pipeline_timer": 5.997125287332895e-05}, "episode_return_max": 14.5, "num_env_steps_sampled": 5000.0, "num_episodes": 250.0, "episode_len_max": 20, "sample": 0.005951990231152519, "weights_seq_no": 2.0, "num_episodes_lifetime": -30375.0, "env_to_module_sum_episodes_length_in": 10.36823839457432, "num_agent_steps_sampled": {"default_agent": 5000.0}, "num_env_steps_sampled_lifetime": -607500.0, "episode_duration_sec_mean": 0.005280198261607437, "episode_return_mean": 5.460000000000001, "num_module_steps_sampled": {"default_policy": 5000.0}, "env_reset_timer": 4.6808142285472436e-05, "num_module_steps_sampled_lifetime": {"default_policy": -607500.0}, "agent_episode_returns_mean": {"default_agent": 5.460000000000001}, "env_step_timer": 1.4218512366158217e-05, "episode_return_min": -5.5, "episode_len_min": 20, "episode_len_mean": 20.0, "num_agent_steps_sampled_lifetime": {"default_agent": -607500.0}, "module_episode_returns_mean": {"default_policy": 5.460000000000001}, "time_between_sampling": 0.03249296599040513, "num_env_steps_sampled_lifetime_throughput": 3189.4495494112844}, "__all_modules__": {"learner_connector_sum_episodes_length_in": 5000.0, "learner_connector": {"connector_pipeline_timer": 0.15333710418987323, "timers": {"connectors": {"add_one_ts_to_episodes_and_truncate": 0.008951791197108105, "add_observations_from_episodes_to_batch": 0.0008542525722645222, "add_columns_from_episodes_to_train_batch": 0.04114659884339198, "add_time_dim_to_batch_and_zero_pad": 0.089796346384997, "add_states_from_episodes_to_batch": 0.0035836204288294538, "batch_individual_items": 0.008806024383124895, "numpy_to_tensor": 6.193049856228754e-05}}}, "learner_connector_sum_episodes_length_out": 5250.0}, "learners": {"intrinsic_reward_module": {"weights_seq_no": 3.0, "num_module_steps_trained_lifetime": 17955, "gradients_default_optimizer_global_norm": 0.0, "module_train_batch_size_mean": 998.7505232584676, "diff_num_grad_updates_vs_sampler_policy": 1.0, "num_trainable_parameters": 8266, "default_optimizer_learning_rate": 0.0002715581955, "total_loss": 0.0, "num_module_steps_trained": 5985, "curr_entropy_coeff": 0.0015431216992, "num_module_steps_trained_lifetime_throughput": 766.1463559710426}, "differentiable_learners": {"intrinsic_attention_ppo_learner": {"intrinsic_reward_module": {"total_loss": 0.0, "num_module_steps_trained": 35910, "diff_num_grad_updates_vs_sampler_policy": 16.0, "weights_seq_no": 18.0, "num_module_steps_trained_lifetime": 107730, "module_train_batch_size_mean": 998.0016398003509}, "default_policy": {"vf_explained_var": 0.001972019672393799, "total_loss": 0.25010982155799866, "vf_loss": 0.3227367103099823, "vf_loss_unclipped": 44.7944450378418, "weights_seq_no": 18.0, "num_module_steps_trained_lifetime": 107730, "module_train_batch_size_mean": 998.0016398003509, "entropy": 0.6926817893981934, "mean_kl_loss": 2.3888864234322682e-05, "use_intrinsic_rewards": 1.0, "policy_loss": -0.0002535071107558906, "num_module_steps_trained": 35910, "diff_num_grad_updates_vs_sampler_policy": 16.0}, "__all_modules__": {"num_env_steps_trained_lifetime": 648000, "num_module_steps_trained_lifetime": 215460, "num_module_steps_trained": 71820, "num_env_steps_trained": 216000, "num_env_steps_trained_lifetime_throughput": 61199.53887701533}}}, "default_policy": {"curr_kl_coeff": 0.020197991281747818, "num_module_steps_trained_lifetime": 17955, "module_train_batch_size_mean": 998.7505232584676, "entropy": 0.6926766633987427, "num_trainable_parameters": 16595, "mean_kl_loss": 2.5079714760067873e-05, "use_intrinsic_rewards": 0.0, "policy_loss": -0.00026065637939609587, "num_module_steps_trained": 5985, "diff_num_grad_updates_vs_sampler_policy": 1.0, "vf_explained_var": 0.004670381546020508, "total_loss": 0.24855642020702362, "vf_loss": 0.32075557112693787, "curr_entropy_coeff": 0.0015431216992, "vf_loss_unclipped": 44.9759407043457, "weights_seq_no": 3.0, "num_module_steps_trained_lifetime_throughput": 766.1339316302701}, "__all_modules__": {"num_module_steps_trained": 11970, "num_non_trainable_parameters": 0, "num_env_steps_trained": 36000, "num_env_steps_trained_lifetime": 108000, "num_module_steps_trained_lifetime": 35910, "num_trainable_parameters": 24861, "num_env_steps_trained_lifetime_throughput": 4613.911434962366, "num_module_steps_trained_throughput": 30825098.679037534, "num_module_steps_trained_lifetime_throughput": 13177231.223341381}, "IntrinsicAttentionMask": [[[0.1669946312904358, 0.16570137441158295, 0.1661333292722702, 0.16692689061164856, 0.1673620343208313, 0.1668817400932312], [0.16668912768363953, 0.1666005700826645, 0.16663020849227905, 0.16668449342250824, 0.1667141616344452, 0.1666814237833023], [0.16679155826568604, 0.16629910469055176, 0.16646383702754974, 0.16676580905914307, 0.16693101823329926, 0.16674865782260895], [0.16697871685028076, 0.1657482236623764, 0.1661592572927475, 0.16691426932811737, 0.16732819378376007, 0.1668713092803955], [0.1670808047056198, 0.16544777154922485, 0.1659928262233734, 0.16699516773223877, 0.16754531860351562, 0.16693809628486633], [0.16696810722351074, 0.1657794713973999, 0.16617655754089355, 0.16690586507320404, 0.16730564832687378, 0.16686438024044037]], [[0.16771277785301208, 0.16716724634170532, 0.16621559858322144, 0.16567492485046387, 0.16709035634994507, 0.166139155626297], [0.16739459335803986, 0.16701531410217285, 0.1663527935743332, 0.16597586870193481, 0.16696183383464813, 0.16629952192306519], [0.1668379008769989, 0.16674883663654327, 0.16659286618232727, 0.16650390625, 0.16673624515533447, 0.16658028960227966], [0.1665206402540207, 0.16659654676914215, 0.1667296290397644, 0.16680562496185303, 0.16660726070404053, 0.16674035787582397], [0.167349711060524, 0.1669938713312149, 0.1663721650838852, 0.16601839661598206, 0.16694368422031403, 0.16632217168807983], [0.1667930781841278, 0.16672731935977936, 0.1666121631860733, 0.16654647886753082, 0.1667180359363556, 0.16660289466381073]], [[0.16691823303699493, 0.16562557220458984, 0.16605731844902039, 0.16730809211730957, 0.1672854721546173, 0.16680538654327393], [0.16668391227722168, 0.16659536957740784, 0.1666250079870224, 0.1667104959487915, 0.16670896112918854, 0.16667620837688446], [0.166762575507164, 0.16627022624015808, 0.16643492877483368, 0.16691060364246368, 0.16690202057361603, 0.1667196899652481], [0.16698819398880005, 0.16533523797988892, 0.16588692367076874, 0.16748739778995514, 0.1674584150314331, 0.1668437421321869], [0.16698415577411652, 0.16535207629203796, 0.16589681804180145, 0.16747702658176422, 0.16744840145111084, 0.1668415516614914], [0.16689792275428772, 0.16570977866649628, 0.1661067008972168, 0.16725610196590424, 0.16723531484603882, 0.16679422557353973]], [[0.1677539348602295, 0.16770073771476746, 0.1646709442138672, 0.16567938029766083, 0.16862070560455322, 0.165574312210083], [0.167746439576149, 0.1676936000585556, 0.1646846979856491, 0.1656862199306488, 0.16860716044902802, 0.1655818670988083], [0.16731508076190948, 0.16728347539901733, 0.16547615826129913, 0.16607917845249176, 0.16782963275909424, 0.16601641476154327], [0.167459636926651, 0.16742092370986938, 0.16521093249320984, 0.16594770550727844, 0.1680898219347, 0.16587099432945251], [0.16787570714950562, 0.16781648993492126, 0.1644475758075714, 0.16556811332702637, 0.16884079575538635, 0.165451318025589], [0.1674446165561676, 0.16740664839744568, 0.16523846983909607, 0.1659613698720932, 0.16806277632713318, 0.16588611900806427]], [[0.16524165868759155, 0.16575480997562408, 0.16632893681526184, 0.1673850119113922, 0.16735494136810303, 0.1679346263408661], [0.16494236886501312, 0.1655626744031906, 0.16625717282295227, 0.16753599047660828, 0.16749955713748932, 0.16820219159126282], [0.16460897028446198, 0.16534839570522308, 0.1661769151687622, 0.167704239487648, 0.1676606982946396, 0.16850081086158752], [0.16399964690208435, 0.16495607793331146, 0.16602928936481476, 0.1680118292570114, 0.16795523464679718, 0.16904795169830322], [0.16401691734790802, 0.16496720910072327, 0.16603349149227142, 0.168003112077713, 0.16794687509536743, 0.16903240978717804], [0.16368451714515686, 0.16475284099578857, 0.16595245897769928, 0.16817094385623932, 0.16810756921768188, 0.1693316102027893]], [[0.16793186962604523, 0.16787861287593842, 0.16590772569179535, 0.16479335725307465, 0.16879956424236298, 0.164688840508461], [0.16792315244674683, 0.16787026822566986, 0.16591301560401917, 0.1648062765598297, 0.16878478229045868, 0.16470247507095337], [0.16759814321994781, 0.16755902767181396, 0.16610942780971527, 0.1652877926826477, 0.16823484003543854, 0.16521067917346954], [0.16741248965263367, 0.16738121211528778, 0.16622120141983032, 0.16556279361248016, 0.16792134940624237, 0.1655009537935257], [0.16807357966899872, 0.1680142879486084, 0.16582176089286804, 0.16458334028720856, 0.1690398007631302, 0.1644672453403473], [0.1673949956893921, 0.1673644632101059, 0.16623170673847198, 0.16558867692947388, 0.16789184510707855, 0.16552826762199402]]]}, "num_training_step_calls_per_iteration": 1, "evaluation": {"env_runners": {"episode_len_min": 20, "env_to_module_connector": {"timers": {"connectors": {"numpy_to_tensor": 1.1862088389638371e-05, "add_states_from_episodes_to_batch": 2.7369610222921134e-06, "batch_individual_items": 1.2470510748957788e-05, "add_time_dim_to_batch_and_zero_pad": 7.198553195843663e-06, "add_observations_from_episodes_to_batch": 2.829839947023472e-06}}, "connector_pipeline_timer": 5.9144148869606924e-05}, "module_to_env_connector": {"timers": {"connectors": {"tensor_to_numpy": 1.4845280766954847e-05, "un_batch_to_individual_items": 6.569866925807431e-06, "normalize_and_clip_actions": 7.755889013765142e-06, "get_actions": 3.583828015299647e-05, "remove_single_ts_time_rank_from_batch": 1.1795727833369823e-05, "listify_data_for_vector_env": 1.0417729267195475e-05}}, "connector_pipeline_timer": 0.00011294614833118194}, "num_env_steps_sampled": 400, "episode_len_max": 20, "num_agent_steps_sampled": {"default_agent": 400}, "weights_seq_no": 3.0, "num_env_steps_sampled_lifetime": 15400, "episode_duration_sec_mean": 0.005577556982946892, "episode_return_mean": -1.6333333333333333, "env_reset_timer": 0.00015750215511070562, "module_episode_returns_mean": {"default_policy": -1.6333333333333333}, "rlmodule_inference_timer": 3.118976603895133e-05, "episode_return_max": 15.5, "env_to_module_sum_episodes_length_in": 10.368205581254823, "num_module_steps_sampled": {"default_policy": 400}, "agent_episode_returns_mean": {"default_agent": -1.6333333333333333}, "num_agent_steps_sampled_lifetime": {"default_agent": 1200}, "num_module_steps_sampled_lifetime": {"default_policy": 1200}, "env_to_module_sum_episodes_length_out": 10.368205581254823, "num_episodes": 20, "num_episodes_lifetime": 60, "episode_return_min": -13.5, "sample": 0.13644971009297294, "env_step_timer": 1.3725213516290506e-05, "episode_len_mean": 20.0, "time_between_sampling": 9.6409935526771}, "num_healthy_workers": 1, "actor_manager_num_outstanding_async_reqs": 0, "num_remote_worker_restarts": 0}, "num_env_steps_sampled_lifetime": -607500.0, "fault_tolerance": {"num_healthy_workers": 0, "num_remote_worker_restarts": 0}, "env_runner_group": {"actor_manager_num_outstanding_async_reqs": 0}, "done": false, "training_iteration": 3, "trial_id": "b17e2_00000", "date": "2025-08-11_18-43-39", "timestamp": 1754930619, "time_this_iter_s": 9.565922975540161, "time_total_s": 29.048330068588257, "pid": 11680, "hostname": "Mac", "node_ip": "127.0.0.1", "config": {"exploration_config": {}, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 2, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "env": "Umbrella", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": false, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 0, "create_local_env_runner": true, "num_envs_per_env_runner": 1, "gym_env_vectorize_mode": "SYNC", "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "episodes_to_numpy": true, "max_requests_in_flight_per_env_runner": 1, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "merge_env_runner_states": "training_only", "broadcast_env_runner_states": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "complete_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "sampler_perf_stats_ema_coef": null, "_is_online": true, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": "auto", "num_aggregator_actors_per_learner": 0, "max_requests_in_flight_per_aggregator_actor": 3, "local_gpu_idx": 0, "max_requests_in_flight_per_learner": 3, "gamma": 1, "lr": 0.0002715581955, "grad_clip": 0.5, "grad_clip_by": "global_norm", "_train_batch_size_per_learner": 5000, "train_batch_size": 4000, "num_epochs": 1, "minibatch_size": 1000, "shuffle_batch_per_epoch": true, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "log_std_clip_param": 20.0, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "_disable_preprocessor_api": false, "_disable_action_flattening": false}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {"intrinsic_reward_coeff": 0.2795015916508}, "optimizer": {}, "_learner_class": "<class 'source.intrinsic_attention_ppo.learners.IntrinsicAttentionMetaLearner.IntrinsicAttentionMetaLearner'>", "callbacks_on_algorithm_init": null, "callbacks_on_env_runners_recreated": null, "callbacks_on_offline_eval_runners_recreated": null, "callbacks_on_checkpoint_loaded": null, "callbacks_on_environment_created": null, "callbacks_on_episode_created": null, "callbacks_on_episode_start": null, "callbacks_on_episode_step": null, "callbacks_on_episode_end": null, "callbacks_on_evaluate_start": null, "callbacks_on_evaluate_end": null, "callbacks_on_evaluate_offline_start": null, "callbacks_on_evaluate_offline_end": null, "callbacks_on_sample_end": null, "callbacks_on_train_result": null, "explore": true, "enable_rl_module_and_learner": true, "enable_env_runner_and_connector_v2": true, "_prior_exploration_config": {"type": "StochasticSampling"}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x13c0118a0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "offline_data_class": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_read_batch_size": null, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "materialize_data": false, "materialize_mapped_data": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "ignore_final_observation": false, "prelearner_class": null, "prelearner_buffer_class": null, "prelearner_buffer_kwargs": {}, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_remaining_data": false, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": 1, "evaluation_duration": 20, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_auto_duration_min_env_steps_per_sample": 100, "evaluation_auto_duration_max_env_steps_per_sample": 2000, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 1, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "offline_evaluation_interval": null, "num_offline_eval_runners": 0, "offline_loss_for_module_fn": null, "offline_evaluation_duration": 1, "offline_evaluation_parallel_to_training": false, "offline_evaluation_timeout_s": 120.0, "num_cpus_per_offline_eval_runner": 1, "num_gpus_per_offline_eval_runner": 0, "custom_resources_per_offline_eval_runner": {}, "restart_failed_offline_eval_runners": true, "ignore_offline_eval_runner_failures": false, "max_num_offline_eval_runner_restarts": 1000, "offline_eval_runner_restore_timeout_s": 1800.0, "max_requests_in_flight_per_offline_eval_runner": 1, "validate_offline_eval_runners_after_construction": true, "offline_eval_runner_health_probe_timeout_s": 30.0, "offline_eval_rl_module_inference_only": false, "broadcast_offline_eval_runner_states": false, "offline_eval_batch_size_per_runner": 256, "dataset_num_iters_per_eval_runner": 1, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "log_gradients": false, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 9, "restart_failed_env_runners": true, "ignore_env_runner_failures": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30.0, "env_runner_restore_timeout_s": 1800.0, "_model_config": {}, "_rl_module_spec": "MultiRLModuleSpec(multi_rl_module_class=<class 'ray.rllib.core.rl_module.multi_rl_module.MultiRLModule'>, observation_space=None, action_space=None, inference_only=False, model_config=None, rl_module_specs={'default_policy': RLModuleSpec(module_class=<class 'source.intrinsic_attention_ppo.rl_modules.DifferentiablePPOModule.DifferentiablePPOModule'>, observation_space=None, action_space=None, inference_only=False, learner_only=False, model_config={'vf_share_layers': True, 'embedding_dim': 62, 'max_seq_len': 6, 'policy_head_hidden_sizes': [32], 'value_head_hidden_sizes': [101], 'embedding_hidden_sizes': [121]}, catalog_class=None, load_state_path=None, model_config_dict=None), 'intrinsic_reward_module': RLModuleSpec(module_class=<class 'source.intrinsic_attention_ppo.rl_modules.IntrinsicAttentionModule.IntrinsicAttentionModule'>, observation_space=None, action_space=None, inference_only=False, learner_only=True, model_config={'intrinsic_reward_network': {'encoder_hidden_sizes': [], 'encoding_dim': 1, 'num_heads': 1, 'head_hidden_sizes': None, 'layers': [{'type': 'attention'}]}, 'extrinsic_value_hidden_layers': [127, 60], 'vf_share_layers': True, 'max_seq_len': 6}, catalog_class=None, load_state_path=None, model_config_dict=None)}, load_state_path=None, modules_to_load=None, module_specs={'default_policy': RLModuleSpec(module_class=<class 'source.intrinsic_attention_ppo.rl_modules.DifferentiablePPOModule.DifferentiablePPOModule'>, observation_space=None, action_space=None, inference_only=False, learner_only=False, model_config={'vf_share_layers': True, 'embedding_dim': 62, 'max_seq_len': 6, 'policy_head_hidden_sizes': [32], 'value_head_hidden_sizes': [101], 'embedding_hidden_sizes': [121]}, catalog_class=None, load_state_path=None, model_config_dict=None), 'intrinsic_reward_module': RLModuleSpec(module_class=<class 'source.intrinsic_attention_ppo.rl_modules.IntrinsicAttentionModule.IntrinsicAttentionModule'>, observation_space=None, action_space=None, inference_only=False, learner_only=True, model_config={'intrinsic_reward_network': {'encoder_hidden_sizes': [], 'encoding_dim': 1, 'num_heads': 1, 'head_hidden_sizes': None, 'layers': [{'type': 'attention'}]}, 'extrinsic_value_hidden_layers': [127, 60], 'vf_share_layers': True, 'max_seq_len': 6}, catalog_class=None, load_state_path=None, model_config_dict=None)})", "algorithm_config_overrides_per_module": {"intrinsic_reward_module": {"lr": 0.0002715581955}}, "_per_module_overrides": {}, "_validate_config": true, "_use_msgpack_checkpoints": false, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "env_task_fn": -1, "enable_connectors": -1, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.161583927863, "kl_target": 0.0201019014258, "vf_loss_coeff": 0.7790510010087, "entropy_coeff": 0.0015431216992, "clip_param": 0.2459212356676, "vf_clip_param": 0.3769744131561, "entropy_coeff_schedule": null, "lr_schedule": null, "sgd_minibatch_size": -1, "vf_share_layers": -1, "differentiable_learner_configs": ["DifferentiableLearnerConfig(learner_class=<class 'source.intrinsic_attention_ppo.learners.IntrinsicAttentionPPOLearner.IntrinsicAttentionPPOLearner'>, learner_connector=None, add_default_connectors_to_learner_pipeline=True, is_multi_agent=False, policies_to_update=['default_policy'], lr=0.0060984166342, num_total_minibatches=0, num_epochs=1, minibatch_size=1000, shuffle_batch_per_epoch=True)"], "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9485408017724, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.callbacks.callbacks.RLlibCallback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 29.048330068588257, "iterations_since_restore": 3, "perf": {"cpu_util_percent": 37.028571428571425, "ram_util_percent": 80.39285714285714}}
{"timers": {"training_iteration": 9.606303455832633, "restore_env_runners": 2.1008107791189104e-05, "training_step": 9.606132416910956, "env_runner_sampling_timer": 1.7505414451775434, "learner_update_timer": 7.665563864919955, "synch_weights": 0.0007900693007115042, "restore_eval_env_runners": 8.366547361947594e-06, "evaluation_iteration": 0.14303252200663555, "synch_eval_env_connectors": 0.00013730624847812581, "synch_env_connectors": 4.9932920373976234e-06}, "env_runners": {"module_to_env_connector": {"timers": {"connectors": {"listify_data_for_vector_env": 1.0382079658216641e-05, "remove_single_ts_time_rank_from_batch": 1.184964983665065e-05, "tensor_to_numpy": 1.5280348960590963e-05, "un_batch_to_individual_items": 6.60990369342898e-06, "normalize_and_clip_actions": 7.881988739167019e-06, "get_actions": 3.927165616701566e-05}}, "connector_pipeline_timer": 0.00011731283555417902}, "env_to_module_sum_episodes_length_out": 10.36823839457432, "rlmodule_inference_timer": 3.1740354979494724e-05, "env_to_module_connector": {"timers": {"connectors": {"add_observations_from_episodes_to_batch": 2.7735830414423255e-06, "add_time_dim_to_batch_and_zero_pad": 6.870064535744037e-06, "numpy_to_tensor": 1.2719067446881037e-05, "batch_individual_items": 1.2332327920573111e-05, "add_states_from_episodes_to_batch": 2.6623059919969986e-06}}, "connector_pipeline_timer": 5.905286610787096e-05}, "episode_return_max": 14.5, "num_env_steps_sampled": 5000.0, "num_episodes": 250.0, "episode_len_max": 20, "sample": 0.005640644938845707, "weights_seq_no": 3.0, "num_episodes_lifetime": -61250.0, "env_to_module_sum_episodes_length_in": 10.36823839457432, "num_agent_steps_sampled": {"default_agent": 5000.0}, "num_env_steps_sampled_lifetime": -1225000.0, "episode_duration_sec_mean": 0.0052324018268845975, "episode_return_mean": 5.22, "num_module_steps_sampled": {"default_policy": 5000.0}, "env_reset_timer": 4.1919500961369314e-05, "num_module_steps_sampled_lifetime": {"default_policy": -1225000.0}, "agent_episode_returns_mean": {"default_agent": 5.22}, "env_step_timer": 1.3854416121815226e-05, "episode_return_min": -5.5, "episode_len_min": 20, "episode_len_mean": 20.0, "num_agent_steps_sampled_lifetime": {"default_agent": -1225000.0}, "module_episode_returns_mean": {"default_policy": 5.22}, "time_between_sampling": 0.03264810564590418, "num_env_steps_sampled_lifetime_throughput": 3266.4670321949334}, "__all_modules__": {"learner_connector_sum_episodes_length_in": 5000.0, "learner_connector": {"connector_pipeline_timer": 0.15332581314869728, "timers": {"connectors": {"add_one_ts_to_episodes_and_truncate": 0.008950957034918945, "add_observations_from_episodes_to_batch": 0.0008542775460043921, "add_columns_from_episodes_to_train_batch": 0.04114974410395603, "add_time_dim_to_batch_and_zero_pad": 0.08979296458154253, "add_states_from_episodes_to_batch": 0.0035854908946596547, "batch_individual_items": 0.008793959979891543, "numpy_to_tensor": 6.201119308604393e-05}}}, "learner_connector_sum_episodes_length_out": 5250.0}, "learners": {"intrinsic_reward_module": {"weights_seq_no": 4.0, "num_module_steps_trained_lifetime": 23940, "gradients_default_optimizer_global_norm": 0.0, "module_train_batch_size_mean": 998.6769017198101, "diff_num_grad_updates_vs_sampler_policy": 1.0, "num_trainable_parameters": 8266, "default_optimizer_learning_rate": 0.0002715581955, "total_loss": 0.0, "num_module_steps_trained": 5985, "curr_entropy_coeff": 0.0015431216992, "num_module_steps_trained_lifetime_throughput": 764.6128513741701}, "differentiable_learners": {"intrinsic_attention_ppo_learner": {"intrinsic_reward_module": {"total_loss": 0.0, "num_module_steps_trained": 35910, "diff_num_grad_updates_vs_sampler_policy": 21.0, "weights_seq_no": 24.0, "num_module_steps_trained_lifetime": 143640, "module_train_batch_size_mean": 997.847060245087}, "default_policy": {"vf_explained_var": 0.0019829869270324707, "total_loss": 0.24975824356079102, "vf_loss": 0.3223516345024109, "vf_loss_unclipped": 45.46335983276367, "weights_seq_no": 24.0, "num_module_steps_trained_lifetime": 143640, "module_train_batch_size_mean": 997.847060245087, "entropy": 0.6924188733100891, "mean_kl_loss": 3.204062522854656e-05, "use_intrinsic_rewards": 1.0, "policy_loss": -0.0003068049845751375, "num_module_steps_trained": 35910, "diff_num_grad_updates_vs_sampler_policy": 21.0}, "__all_modules__": {"num_env_steps_trained_lifetime": 864000, "num_module_steps_trained_lifetime": 287280, "num_module_steps_trained": 71820, "num_env_steps_trained": 216000, "num_env_steps_trained_lifetime_throughput": 60459.54827631668}}}, "default_policy": {"curr_kl_coeff": 0.010098995640873909, "num_module_steps_trained_lifetime": 23940, "module_train_batch_size_mean": 998.6769017198101, "entropy": 0.6924118399620056, "num_trainable_parameters": 16595, "mean_kl_loss": 3.355164153617807e-05, "use_intrinsic_rewards": 0.0, "policy_loss": -0.0003160082269459963, "num_module_steps_trained": 5985, "diff_num_grad_updates_vs_sampler_policy": 1.0, "vf_explained_var": 0.0021702051162719727, "total_loss": 0.24833104014396667, "vf_loss": 0.3205372095108032, "curr_entropy_coeff": 0.0015431216992, "vf_loss_unclipped": 45.714134216308594, "weights_seq_no": 4.0, "num_module_steps_trained_lifetime_throughput": 764.6008318104631}, "__all_modules__": {"num_module_steps_trained": 11970, "num_non_trainable_parameters": 0, "num_env_steps_trained": 36000, "num_env_steps_trained_lifetime": 144000, "num_module_steps_trained_lifetime": 47880, "num_trainable_parameters": 24861, "num_env_steps_trained_lifetime_throughput": 4604.550605590514, "num_module_steps_trained_throughput": 30056574.64887344, "num_module_steps_trained_lifetime_throughput": 13156949.26816652}, "IntrinsicAttentionMask": [[[0.16707056760787964, 0.16577671468257904, 0.1657542884349823, 0.16700278222560883, 0.16743811964988708, 0.16695760190486908], [0.16669431328773499, 0.16660577058792114, 0.16660423576831818, 0.1666896939277649, 0.16671936213970184, 0.16668662428855896], [0.1666877567768097, 0.16662020981311798, 0.16661903262138367, 0.16668424010276794, 0.1667068600654602, 0.16668188571929932], [0.16705094277858734, 0.16581991314888, 0.1657985895872116, 0.16698646545410156, 0.1674005687236786, 0.1669434905052185], [0.16717664897441864, 0.16554269194602966, 0.16551440954208374, 0.16709096729755402, 0.16764143109321594, 0.16703388094902039], [0.16703787446022034, 0.1658487319946289, 0.16582812368869781, 0.16697560250759125, 0.16737554967403412, 0.16693410277366638]], [[0.16691794991493225, 0.16726835072040558, 0.1662241369485855, 0.16620603203773499, 0.16721367835998535, 0.16616982221603394], [0.16701501607894897, 0.16750161349773407, 0.1660526990890503, 0.16602760553359985, 0.16742567718029022, 0.16597741842269897], [0.16672474145889282, 0.1668054163455963, 0.16656461358070374, 0.16656042635440826, 0.1667928397655487, 0.16655205190181732], [0.16671967506408691, 0.1667933166027069, 0.16657350957393646, 0.16656969487667084, 0.16678182780742645, 0.1665620505809784], [0.1669999063014984, 0.16746525466442108, 0.16607943177223206, 0.16605541110038757, 0.16739264130592346, 0.1660074144601822], [0.1667095422744751, 0.1667690873146057, 0.16659130156040192, 0.1665882021188736, 0.16675980389118195, 0.16658201813697815]], [[0.16534148156642914, 0.16585494577884674, 0.16582514345645905, 0.16809645295143127, 0.1674560308456421, 0.1674259603023529], [0.16506290435791016, 0.16568365693092346, 0.16564762592315674, 0.16839833557605743, 0.16762195527553558, 0.16758550703525543], [0.1650790423154831, 0.16569358110427856, 0.1656579226255417, 0.16838084161281586, 0.16761234402656555, 0.16757626831531525], [0.16385897994041443, 0.16494092345237732, 0.16487804055213928, 0.16970835626125336, 0.16833893954753876, 0.16827476024627686], [0.16420093178749084, 0.16515231132507324, 0.16509702801704407, 0.16933538019657135, 0.16813531517982483, 0.16807903349399567], [0.1642170250415802, 0.16516223549842834, 0.16510732471942902, 0.169317826628685, 0.1681257039308548, 0.16806980967521667]], [[0.166979119181633, 0.16732963919639587, 0.16628503799438477, 0.16626693308353424, 0.16727495193481445, 0.16586440801620483], [0.16709977388381958, 0.16758660972118378, 0.1661369651556015, 0.16611185669898987, 0.16751062870025635, 0.1655542254447937], [0.1667388677597046, 0.16681954264640808, 0.1665787249803543, 0.16657453775405884, 0.16680696606636047, 0.16648142039775848], [0.1667325645685196, 0.1668062061071396, 0.16658638417720795, 0.16658256947994232, 0.16679471731185913, 0.16649755835533142], [0.16708098351955414, 0.16754655539989471, 0.16616006195545197, 0.16613604128360748, 0.1674738973379135, 0.16560254991054535], [0.16659240424633026, 0.16650958359241486, 0.1667570173740387, 0.16676132380962372, 0.16652250289916992, 0.16685718297958374]], [[0.16699464619159698, 0.16615580022335052, 0.1656789630651474, 0.16692689061164856, 0.1673620343208313, 0.1668817400932312], [0.16679686307907104, 0.16646413505077362, 0.1662745326757431, 0.16677002608776093, 0.1669422835111618, 0.1667521446943283], [0.16668377816677094, 0.1666400283575058, 0.1666150540113449, 0.1666802614927292, 0.16670288145542145, 0.16667790710926056], [0.16697870194911957, 0.16618064045906067, 0.16572688519954681, 0.16691425442695618, 0.16732817888259888, 0.16687129437923431], [0.16708077490329742, 0.1660211682319641, 0.16541948914527893, 0.16699513792991638, 0.16754528880119324, 0.16693808138370514], [0.16696809232234955, 0.16619721055030823, 0.1657588630914688, 0.16690585017204285, 0.16730563342571259, 0.16686436533927917]], [[0.16893094778060913, 0.16763806343078613, 0.16539643704891205, 0.16413061320781708, 0.16868680715560913, 0.16521711647510529], [0.168638676404953, 0.16751375794410706, 0.16556066274642944, 0.16445627808570862, 0.16842631995677948, 0.1654042899608612], [0.16812695562839508, 0.16729533672332764, 0.1658480316400528, 0.1650276780128479, 0.16797009110450745, 0.16573196649551392], [0.16783513128757477, 0.16717033088207245, 0.1660117655992508, 0.1653541922569275, 0.16770976781845093, 0.16591876745224], [0.16887590289115906, 0.16761468350887299, 0.16542735695838928, 0.16419188678264618, 0.16863775253295898, 0.16525235772132874], [0.1680857390165329, 0.16727770864963531, 0.16587115824222565, 0.16507376730442047, 0.16793332993984222, 0.16575834155082703]]]}, "num_training_step_calls_per_iteration": 1, "evaluation": {"env_runners": {"episode_len_min": 20, "env_to_module_connector": {"timers": {"connectors": {"numpy_to_tensor": 1.201334262457814e-05, "add_states_from_episodes_to_batch": 2.707508192847956e-06, "batch_individual_items": 1.2430933232608913e-05, "add_time_dim_to_batch_and_zero_pad": 6.9913406676011026e-06, "add_observations_from_episodes_to_batch": 2.83933114481452e-06}}, "connector_pipeline_timer": 5.8875626400854196e-05}, "module_to_env_connector": {"timers": {"connectors": {"tensor_to_numpy": 1.5036744061716066e-05, "un_batch_to_individual_items": 6.56166466277827e-06, "normalize_and_clip_actions": 7.94120463538851e-06, "get_actions": 3.673352261554039e-05, "remove_single_ts_time_rank_from_batch": 1.1864073428296489e-05, "listify_data_for_vector_env": 1.0366009011611614e-05}}, "connector_pipeline_timer": 0.00011421502856134718}, "num_env_steps_sampled": 400, "episode_len_max": 20, "num_agent_steps_sampled": {"default_agent": 400}, "weights_seq_no": 4.0, "num_env_steps_sampled_lifetime": 20400, "episode_duration_sec_mean": 0.005483619838196318, "episode_return_mean": -1.05, "env_reset_timer": 0.00015743130333663427, "module_episode_returns_mean": {"default_policy": -1.05}, "rlmodule_inference_timer": 3.1491396999691104e-05, "episode_return_max": 15.5, "env_to_module_sum_episodes_length_in": 10.368237912813044, "num_module_steps_sampled": {"default_policy": 400}, "agent_episode_returns_mean": {"default_agent": -1.05}, "num_agent_steps_sampled_lifetime": {"default_agent": 1600}, "num_module_steps_sampled_lifetime": {"default_policy": 1600}, "env_to_module_sum_episodes_length_out": 10.368237912813044, "num_episodes": 20, "num_episodes_lifetime": 80, "episode_return_min": -13.5, "sample": 0.13621713174134956, "env_step_timer": 1.4096767021213456e-05, "episode_len_mean": 20.0, "time_between_sampling": 9.640384655900545}, "num_healthy_workers": 1, "actor_manager_num_outstanding_async_reqs": 0, "num_remote_worker_restarts": 0}, "num_env_steps_sampled_lifetime": -1225000.0, "fault_tolerance": {"num_healthy_workers": 0, "num_remote_worker_restarts": 0}, "env_runner_group": {"actor_manager_num_outstanding_async_reqs": 0}, "done": false, "training_iteration": 4, "trial_id": "b17e2_00000", "date": "2025-08-11_18-43-48", "timestamp": 1754930628, "time_this_iter_s": 9.678884983062744, "time_total_s": 38.727215051651, "pid": 11680, "hostname": "Mac", "node_ip": "127.0.0.1", "config": {"exploration_config": {}, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 2, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "env": "Umbrella", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": false, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 0, "create_local_env_runner": true, "num_envs_per_env_runner": 1, "gym_env_vectorize_mode": "SYNC", "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "episodes_to_numpy": true, "max_requests_in_flight_per_env_runner": 1, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "merge_env_runner_states": "training_only", "broadcast_env_runner_states": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "complete_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "sampler_perf_stats_ema_coef": null, "_is_online": true, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": "auto", "num_aggregator_actors_per_learner": 0, "max_requests_in_flight_per_aggregator_actor": 3, "local_gpu_idx": 0, "max_requests_in_flight_per_learner": 3, "gamma": 1, "lr": 0.0002715581955, "grad_clip": 0.5, "grad_clip_by": "global_norm", "_train_batch_size_per_learner": 5000, "train_batch_size": 4000, "num_epochs": 1, "minibatch_size": 1000, "shuffle_batch_per_epoch": true, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "log_std_clip_param": 20.0, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "_disable_preprocessor_api": false, "_disable_action_flattening": false}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {"intrinsic_reward_coeff": 0.2795015916508}, "optimizer": {}, "_learner_class": "<class 'source.intrinsic_attention_ppo.learners.IntrinsicAttentionMetaLearner.IntrinsicAttentionMetaLearner'>", "callbacks_on_algorithm_init": null, "callbacks_on_env_runners_recreated": null, "callbacks_on_offline_eval_runners_recreated": null, "callbacks_on_checkpoint_loaded": null, "callbacks_on_environment_created": null, "callbacks_on_episode_created": null, "callbacks_on_episode_start": null, "callbacks_on_episode_step": null, "callbacks_on_episode_end": null, "callbacks_on_evaluate_start": null, "callbacks_on_evaluate_end": null, "callbacks_on_evaluate_offline_start": null, "callbacks_on_evaluate_offline_end": null, "callbacks_on_sample_end": null, "callbacks_on_train_result": null, "explore": true, "enable_rl_module_and_learner": true, "enable_env_runner_and_connector_v2": true, "_prior_exploration_config": {"type": "StochasticSampling"}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x13c0118a0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "offline_data_class": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_read_batch_size": null, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "materialize_data": false, "materialize_mapped_data": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "ignore_final_observation": false, "prelearner_class": null, "prelearner_buffer_class": null, "prelearner_buffer_kwargs": {}, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_remaining_data": false, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": 1, "evaluation_duration": 20, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_auto_duration_min_env_steps_per_sample": 100, "evaluation_auto_duration_max_env_steps_per_sample": 2000, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 1, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "offline_evaluation_interval": null, "num_offline_eval_runners": 0, "offline_loss_for_module_fn": null, "offline_evaluation_duration": 1, "offline_evaluation_parallel_to_training": false, "offline_evaluation_timeout_s": 120.0, "num_cpus_per_offline_eval_runner": 1, "num_gpus_per_offline_eval_runner": 0, "custom_resources_per_offline_eval_runner": {}, "restart_failed_offline_eval_runners": true, "ignore_offline_eval_runner_failures": false, "max_num_offline_eval_runner_restarts": 1000, "offline_eval_runner_restore_timeout_s": 1800.0, "max_requests_in_flight_per_offline_eval_runner": 1, "validate_offline_eval_runners_after_construction": true, "offline_eval_runner_health_probe_timeout_s": 30.0, "offline_eval_rl_module_inference_only": false, "broadcast_offline_eval_runner_states": false, "offline_eval_batch_size_per_runner": 256, "dataset_num_iters_per_eval_runner": 1, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "log_gradients": false, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 9, "restart_failed_env_runners": true, "ignore_env_runner_failures": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30.0, "env_runner_restore_timeout_s": 1800.0, "_model_config": {}, "_rl_module_spec": "MultiRLModuleSpec(multi_rl_module_class=<class 'ray.rllib.core.rl_module.multi_rl_module.MultiRLModule'>, observation_space=None, action_space=None, inference_only=False, model_config=None, rl_module_specs={'default_policy': RLModuleSpec(module_class=<class 'source.intrinsic_attention_ppo.rl_modules.DifferentiablePPOModule.DifferentiablePPOModule'>, observation_space=None, action_space=None, inference_only=False, learner_only=False, model_config={'vf_share_layers': True, 'embedding_dim': 62, 'max_seq_len': 6, 'policy_head_hidden_sizes': [32], 'value_head_hidden_sizes': [101], 'embedding_hidden_sizes': [121]}, catalog_class=None, load_state_path=None, model_config_dict=None), 'intrinsic_reward_module': RLModuleSpec(module_class=<class 'source.intrinsic_attention_ppo.rl_modules.IntrinsicAttentionModule.IntrinsicAttentionModule'>, observation_space=None, action_space=None, inference_only=False, learner_only=True, model_config={'intrinsic_reward_network': {'encoder_hidden_sizes': [], 'encoding_dim': 1, 'num_heads': 1, 'head_hidden_sizes': None, 'layers': [{'type': 'attention'}]}, 'extrinsic_value_hidden_layers': [127, 60], 'vf_share_layers': True, 'max_seq_len': 6}, catalog_class=None, load_state_path=None, model_config_dict=None)}, load_state_path=None, modules_to_load=None, module_specs={'default_policy': RLModuleSpec(module_class=<class 'source.intrinsic_attention_ppo.rl_modules.DifferentiablePPOModule.DifferentiablePPOModule'>, observation_space=None, action_space=None, inference_only=False, learner_only=False, model_config={'vf_share_layers': True, 'embedding_dim': 62, 'max_seq_len': 6, 'policy_head_hidden_sizes': [32], 'value_head_hidden_sizes': [101], 'embedding_hidden_sizes': [121]}, catalog_class=None, load_state_path=None, model_config_dict=None), 'intrinsic_reward_module': RLModuleSpec(module_class=<class 'source.intrinsic_attention_ppo.rl_modules.IntrinsicAttentionModule.IntrinsicAttentionModule'>, observation_space=None, action_space=None, inference_only=False, learner_only=True, model_config={'intrinsic_reward_network': {'encoder_hidden_sizes': [], 'encoding_dim': 1, 'num_heads': 1, 'head_hidden_sizes': None, 'layers': [{'type': 'attention'}]}, 'extrinsic_value_hidden_layers': [127, 60], 'vf_share_layers': True, 'max_seq_len': 6}, catalog_class=None, load_state_path=None, model_config_dict=None)})", "algorithm_config_overrides_per_module": {"intrinsic_reward_module": {"lr": 0.0002715581955}}, "_per_module_overrides": {}, "_validate_config": true, "_use_msgpack_checkpoints": false, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "env_task_fn": -1, "enable_connectors": -1, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.161583927863, "kl_target": 0.0201019014258, "vf_loss_coeff": 0.7790510010087, "entropy_coeff": 0.0015431216992, "clip_param": 0.2459212356676, "vf_clip_param": 0.3769744131561, "entropy_coeff_schedule": null, "lr_schedule": null, "sgd_minibatch_size": -1, "vf_share_layers": -1, "differentiable_learner_configs": ["DifferentiableLearnerConfig(learner_class=<class 'source.intrinsic_attention_ppo.learners.IntrinsicAttentionPPOLearner.IntrinsicAttentionPPOLearner'>, learner_connector=None, add_default_connectors_to_learner_pipeline=True, is_multi_agent=False, policies_to_update=['default_policy'], lr=0.0060984166342, num_total_minibatches=0, num_epochs=1, minibatch_size=1000, shuffle_batch_per_epoch=True)"], "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9485408017724, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.callbacks.callbacks.RLlibCallback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 38.727215051651, "iterations_since_restore": 4, "perf": {"cpu_util_percent": 38.785714285714285, "ram_util_percent": 80.25714285714285}}
{"timers": {"training_iteration": 9.604663376273914, "restore_env_runners": 2.0875945816482418e-05, "training_step": 9.60449192649131, "env_runner_sampling_timer": 1.7489292853062097, "learner_update_timer": 7.66543305710034, "synch_weights": 0.0007912952778973163, "restore_eval_env_runners": 8.632051019696515e-06, "evaluation_iteration": 0.14279384011753624, "synch_eval_env_connectors": 0.00013765985571837522, "synch_env_connectors": 4.991269842721523e-06}, "env_runners": {"module_to_env_connector": {"timers": {"connectors": {"listify_data_for_vector_env": 1.0811868629215011e-05, "remove_single_ts_time_rank_from_batch": 1.2233635470342093e-05, "tensor_to_numpy": 1.5777439390068053e-05, "un_batch_to_individual_items": 6.875610883647524e-06, "normalize_and_clip_actions": 8.178759950931706e-06, "get_actions": 4.148935379730138e-05}}, "connector_pipeline_timer": 0.00012217456395298407}, "env_to_module_sum_episodes_length_out": 10.36823839457432, "rlmodule_inference_timer": 3.298168717464693e-05, "env_to_module_connector": {"timers": {"connectors": {"add_observations_from_episodes_to_batch": 2.8550416880863256e-06, "add_time_dim_to_batch_and_zero_pad": 7.155437403107531e-06, "numpy_to_tensor": 1.325883447957146e-05, "batch_individual_items": 1.2868094452302202e-05, "add_states_from_episodes_to_batch": 2.7518682324586398e-06}}, "connector_pipeline_timer": 6.117270538819384e-05}, "episode_return_max": 14.5, "num_env_steps_sampled": 5000.0, "num_episodes": 250.0, "episode_len_max": 20, "sample": 0.005768680128376289, "weights_seq_no": 4.0, "num_episodes_lifetime": -92125.0, "env_to_module_sum_episodes_length_in": 10.36823839457432, "num_agent_steps_sampled": {"default_agent": 5000.0}, "num_env_steps_sampled_lifetime": -1842500.0, "episode_duration_sec_mean": 0.005445962509140375, "episode_return_mean": 5.619999999999999, "num_module_steps_sampled": {"default_policy": 5000.0}, "env_reset_timer": 4.517481442122503e-05, "num_module_steps_sampled_lifetime": {"default_policy": -1842500.0}, "agent_episode_returns_mean": {"default_agent": 5.619999999999999}, "env_step_timer": 1.4430437118314588e-05, "episode_return_min": -5.5, "episode_len_min": 20, "episode_len_mean": 20.0, "num_agent_steps_sampled_lifetime": {"default_agent": -1842500.0}, "module_episode_returns_mean": {"default_policy": 5.619999999999999}, "time_between_sampling": 0.03314127358641797, "num_env_steps_sampled_lifetime_throughput": 3157.3757054541115}, "__all_modules__": {"learner_connector_sum_episodes_length_in": 5000.0, "learner_connector": {"connector_pipeline_timer": 0.15331492168717062, "timers": {"connectors": {"add_one_ts_to_episodes_and_truncate": 0.008951261214806982, "add_observations_from_episodes_to_batch": 0.0008545093612228612, "add_columns_from_episodes_to_train_batch": 0.04115615416285753, "add_time_dim_to_batch_and_zero_pad": 0.08978701535629234, "add_states_from_episodes_to_batch": 0.003586630155644917, "batch_individual_items": 0.008780677049841574, "numpy_to_tensor": 6.233400102415936e-05}}}, "learner_connector_sum_episodes_length_out": 5250.0}, "learners": {"intrinsic_reward_module": {"weights_seq_no": 5.0, "num_module_steps_trained_lifetime": 29925, "gradients_default_optimizer_global_norm": 0.0, "module_train_batch_size_mean": 998.6075885025957, "diff_num_grad_updates_vs_sampler_policy": 1.0, "num_trainable_parameters": 8266, "default_optimizer_learning_rate": 0.0002715581955, "total_loss": 0.0, "num_module_steps_trained": 5985, "curr_entropy_coeff": 0.0015431216992, "num_module_steps_trained_lifetime_throughput": 762.8635853970161}, "differentiable_learners": {"intrinsic_attention_ppo_learner": {"intrinsic_reward_module": {"total_loss": 0.0, "num_module_steps_trained": 35910, "diff_num_grad_updates_vs_sampler_policy": 26.0, "weights_seq_no": 30.0, "num_module_steps_trained_lifetime": 179550, "module_train_batch_size_mean": 997.7394089995611}, "default_policy": {"vf_explained_var": 0.0020047426223754883, "total_loss": 0.24974940717220306, "vf_loss": 0.3220342993736267, "vf_loss_unclipped": 46.13420867919922, "weights_seq_no": 30.0, "num_module_steps_trained_lifetime": 179550, "module_train_batch_size_mean": 997.7394089995611, "entropy": 0.6922725439071655, "mean_kl_loss": 7.3994474405481014e-06, "use_intrinsic_rewards": 1.0, "policy_loss": -6.466601189458743e-05, "num_module_steps_trained": 35910, "diff_num_grad_updates_vs_sampler_policy": 26.0}, "__all_modules__": {"num_env_steps_trained_lifetime": 1080000, "num_module_steps_trained_lifetime": 359100, "num_module_steps_trained": 71820, "num_env_steps_trained": 216000, "num_env_steps_trained_lifetime_throughput": 59608.18854709791}}}, "default_policy": {"curr_kl_coeff": 0.0050494978204369545, "num_module_steps_trained_lifetime": 29925, "module_train_batch_size_mean": 998.6075885025957, "entropy": 0.6922695636749268, "num_trainable_parameters": 16595, "mean_kl_loss": 7.666684723517392e-06, "use_intrinsic_rewards": 0.0, "policy_loss": -6.561440386576578e-05, "num_module_steps_trained": 5985, "diff_num_grad_updates_vs_sampler_policy": 1.0, "vf_explained_var": 0.0003560185432434082, "total_loss": 0.24858729541301727, "vf_loss": 0.3205452561378479, "curr_entropy_coeff": 0.0015431216992, "vf_loss_unclipped": 46.41568374633789, "weights_seq_no": 5.0, "num_module_steps_trained_lifetime_throughput": 762.8520192941209}, "__all_modules__": {"num_module_steps_trained": 11970, "num_non_trainable_parameters": 0, "num_env_steps_trained": 36000, "num_env_steps_trained_lifetime": 180000, "num_module_steps_trained_lifetime": 59850, "num_trainable_parameters": 24861, "num_env_steps_trained_lifetime_throughput": 4593.872477218411, "num_module_steps_trained_throughput": 29252743.580141418, "num_module_steps_trained_lifetime_throughput": 13132936.97934362}, "IntrinsicAttentionMask": [[[0.16494083404541016, 0.16605596244335175, 0.16602613031864166, 0.16768912971019745, 0.1676589995622635, 0.16762888431549072], [0.16415466368198395, 0.16577495634555817, 0.1657315492630005, 0.1681569665670395, 0.16811293363571167, 0.16806891560554504], [0.1641755998134613, 0.16578246653079987, 0.16573941707611084, 0.16814449429512024, 0.16810083389282227, 0.16805718839168549], [0.16301696002483368, 0.16536515951156616, 0.165302112698555, 0.16883628070354462, 0.1687719076871872, 0.16870756447315216], [0.16303779184818268, 0.16537268459796906, 0.16531001031398773, 0.16882380843162537, 0.16875982284545898, 0.1686958521604538], [0.16305863857269287, 0.16538022458553314, 0.16531790792942047, 0.16881133615970612, 0.1687477082014084, 0.16868412494659424]], [[0.166979119181633, 0.16732963919639587, 0.16628503799438477, 0.16590054333209991, 0.16727495193481445, 0.166230708360672], [0.16709980368614197, 0.16758663952350616, 0.1661369949579239, 0.16560429334640503, 0.16751065850257874, 0.16606168448925018], [0.1667388677597046, 0.16681954264640808, 0.1665787249803543, 0.16648977994918823, 0.16680696606636047, 0.1665661633014679], [0.16660501062870026, 0.16653625667095184, 0.16674166917800903, 0.16681768000125885, 0.16654695570468903, 0.1667523980140686], [0.16708099842071533, 0.1675465703010559, 0.16616007685661316, 0.16565045714378357, 0.1674739122390747, 0.1660880297422409], [0.1667199730873108, 0.1667795330286026, 0.1666017323732376, 0.16653604805469513, 0.16677024960517883, 0.16659246385097504]], [[0.16514192521572113, 0.16625840961933136, 0.1662285476922989, 0.16728396713733673, 0.16725392639636993, 0.16783325374126434], [0.1644470989704132, 0.16607028245925903, 0.16602680087089539, 0.16756568849086761, 0.16752180457115173, 0.16836832463741302], [0.16446560621261597, 0.16607530415058136, 0.16603218019008636, 0.16755817830562592, 0.16751466691493988, 0.16835404932498932], [0.16381466388702393, 0.1658979058265686, 0.16584202647209167, 0.16782233119010925, 0.1677657961845398, 0.16885727643966675], [0.1638331115245819, 0.16590295732021332, 0.16584742069244385, 0.16781483590602875, 0.16775867342948914, 0.16884298622608185], [0.16347818076610565, 0.16580574214458466, 0.16574326157569885, 0.16795894503593445, 0.16789564490318298, 0.16911815106868744]], [[0.1671632081270218, 0.1675141155719757, 0.16610154509544373, 0.1660834550857544, 0.16709037125110626, 0.16604726016521454], [0.16735534369945526, 0.16784292459487915, 0.16588261723518372, 0.16585755348205566, 0.16725419461727142, 0.16580742597579956], [0.16657884418964386, 0.16651710867881775, 0.16676652431488037, 0.16676972806453705, 0.16659167408943176, 0.1667761504650116], [0.1665688306093216, 0.16650007665157318, 0.16677787899971008, 0.1667814552783966, 0.1665831208229065, 0.16678860783576965], [0.16712327301502228, 0.1674458384513855, 0.16614705324172974, 0.1661304086446762, 0.16705632209777832, 0.16609711945056915], [0.16654883325099945, 0.16646602749824524, 0.1668006181716919, 0.16680490970611572, 0.16656602919101715, 0.16681353747844696]], [[0.16504032909870148, 0.1661561280488968, 0.16552309691905975, 0.1677902787923813, 0.16776013374328613, 0.16773000359535217], [0.1642986685037613, 0.16592037677764893, 0.16499972343444824, 0.1683044731616974, 0.16826041042804718, 0.16821634769439697], [0.1647185981273651, 0.16605408489704132, 0.16529622673988342, 0.16801320016384125, 0.16797703504562378, 0.1679408699274063], [0.1632244735956192, 0.16557565331459045, 0.16423958539962769, 0.16905120015144348, 0.1689867526292801, 0.1689223200082779], [0.16324415802955627, 0.16558200120925903, 0.16425354778766632, 0.16903749108314514, 0.1689734160900116, 0.16890937089920044], [0.16326382756233215, 0.1655883491039276, 0.16426748037338257, 0.1690237820148468, 0.1689600795507431, 0.1688964068889618]], [[0.16913478076457977, 0.16784034669399261, 0.16559600830078125, 0.1643286645412445, 0.1688903272151947, 0.16420985758304596], [0.1688161939382553, 0.16769008338451385, 0.1657349318265915, 0.16462938487529755, 0.16860361397266388, 0.16452570259571075], [0.168258398771286, 0.16742613911628723, 0.16597768664360046, 0.16515670716762543, 0.16810140013694763, 0.16507963836193085], [0.16794033348560333, 0.16727511584758759, 0.16611582040786743, 0.1654578447341919, 0.16781489551067352, 0.16539603471755981], [0.16907478868961334, 0.16781207919120789, 0.16562218964099884, 0.16438525915145874, 0.16883635520935059, 0.16426929831504822], [0.1679103970527649, 0.16726088523864746, 0.16612881422042847, 0.1654861867427826, 0.16778792440891266, 0.16542582213878632]]]}, "num_training_step_calls_per_iteration": 1, "evaluation": {"env_runners": {"episode_len_min": 20, "env_to_module_connector": {"timers": {"connectors": {"numpy_to_tensor": 1.215949769848398e-05, "add_states_from_episodes_to_batch": 2.752331500221846e-06, "batch_individual_items": 1.2549617890848673e-05, "add_time_dim_to_batch_and_zero_pad": 7.05096411486664e-06, "add_observations_from_episodes_to_batch": 2.8687495501604997e-06}}, "connector_pipeline_timer": 5.937542836320439e-05}, "module_to_env_connector": {"timers": {"connectors": {"tensor_to_numpy": 1.5054701502560192e-05, "un_batch_to_individual_items": 6.598590263352241e-06, "normalize_and_clip_actions": 7.943172993150143e-06, "get_actions": 3.701411715431428e-05, "remove_single_ts_time_rank_from_batch": 1.1954795748786262e-05, "listify_data_for_vector_env": 1.0494952391388713e-05}}, "connector_pipeline_timer": 0.0001148466274095517}, "num_env_steps_sampled": 400, "episode_len_max": 20, "num_agent_steps_sampled": {"default_agent": 400}, "weights_seq_no": 5.0, "num_env_steps_sampled_lifetime": 25400, "episode_duration_sec_mean": 0.0054476442013401535, "episode_return_mean": -1.5, "env_reset_timer": 0.00015675573987083621, "module_episode_returns_mean": {"default_policy": -1.5}, "rlmodule_inference_timer": 3.217959187834529e-05, "episode_return_max": 15.5, "env_to_module_sum_episodes_length_in": 10.368238387501162, "num_module_steps_sampled": {"default_policy": 400}, "agent_episode_returns_mean": {"default_agent": -1.5}, "num_agent_steps_sampled_lifetime": {"default_agent": 2000}, "num_module_steps_sampled_lifetime": {"default_policy": 2000}, "env_to_module_sum_episodes_length_out": 10.368238387501162, "num_episodes": 20, "num_episodes_lifetime": 100, "episode_return_min": -13.5, "sample": 0.13601084833363528, "env_step_timer": 1.414770514677598e-05, "episode_len_mean": 20.0, "time_between_sampling": 9.638625703091623}, "num_healthy_workers": 1, "actor_manager_num_outstanding_async_reqs": 0, "num_remote_worker_restarts": 0}, "num_env_steps_sampled_lifetime": -1842500.0, "fault_tolerance": {"num_healthy_workers": 0, "num_remote_worker_restarts": 0}, "env_runner_group": {"actor_manager_num_outstanding_async_reqs": 0}, "done": false, "training_iteration": 5, "trial_id": "b17e2_00000", "date": "2025-08-11_18-43-58", "timestamp": 1754930638, "time_this_iter_s": 9.56610894203186, "time_total_s": 48.29332399368286, "pid": 11680, "hostname": "Mac", "node_ip": "127.0.0.1", "config": {"exploration_config": {}, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 2, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "env": "Umbrella", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": false, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 0, "create_local_env_runner": true, "num_envs_per_env_runner": 1, "gym_env_vectorize_mode": "SYNC", "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "episodes_to_numpy": true, "max_requests_in_flight_per_env_runner": 1, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "merge_env_runner_states": "training_only", "broadcast_env_runner_states": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "complete_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "sampler_perf_stats_ema_coef": null, "_is_online": true, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": "auto", "num_aggregator_actors_per_learner": 0, "max_requests_in_flight_per_aggregator_actor": 3, "local_gpu_idx": 0, "max_requests_in_flight_per_learner": 3, "gamma": 1, "lr": 0.0002715581955, "grad_clip": 0.5, "grad_clip_by": "global_norm", "_train_batch_size_per_learner": 5000, "train_batch_size": 4000, "num_epochs": 1, "minibatch_size": 1000, "shuffle_batch_per_epoch": true, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "log_std_clip_param": 20.0, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "_disable_preprocessor_api": false, "_disable_action_flattening": false}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {"intrinsic_reward_coeff": 0.2795015916508}, "optimizer": {}, "_learner_class": "<class 'source.intrinsic_attention_ppo.learners.IntrinsicAttentionMetaLearner.IntrinsicAttentionMetaLearner'>", "callbacks_on_algorithm_init": null, "callbacks_on_env_runners_recreated": null, "callbacks_on_offline_eval_runners_recreated": null, "callbacks_on_checkpoint_loaded": null, "callbacks_on_environment_created": null, "callbacks_on_episode_created": null, "callbacks_on_episode_start": null, "callbacks_on_episode_step": null, "callbacks_on_episode_end": null, "callbacks_on_evaluate_start": null, "callbacks_on_evaluate_end": null, "callbacks_on_evaluate_offline_start": null, "callbacks_on_evaluate_offline_end": null, "callbacks_on_sample_end": null, "callbacks_on_train_result": null, "explore": true, "enable_rl_module_and_learner": true, "enable_env_runner_and_connector_v2": true, "_prior_exploration_config": {"type": "StochasticSampling"}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x13c0118a0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "offline_data_class": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_read_batch_size": null, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "materialize_data": false, "materialize_mapped_data": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "ignore_final_observation": false, "prelearner_class": null, "prelearner_buffer_class": null, "prelearner_buffer_kwargs": {}, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_remaining_data": false, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": 1, "evaluation_duration": 20, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_auto_duration_min_env_steps_per_sample": 100, "evaluation_auto_duration_max_env_steps_per_sample": 2000, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 1, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "offline_evaluation_interval": null, "num_offline_eval_runners": 0, "offline_loss_for_module_fn": null, "offline_evaluation_duration": 1, "offline_evaluation_parallel_to_training": false, "offline_evaluation_timeout_s": 120.0, "num_cpus_per_offline_eval_runner": 1, "num_gpus_per_offline_eval_runner": 0, "custom_resources_per_offline_eval_runner": {}, "restart_failed_offline_eval_runners": true, "ignore_offline_eval_runner_failures": false, "max_num_offline_eval_runner_restarts": 1000, "offline_eval_runner_restore_timeout_s": 1800.0, "max_requests_in_flight_per_offline_eval_runner": 1, "validate_offline_eval_runners_after_construction": true, "offline_eval_runner_health_probe_timeout_s": 30.0, "offline_eval_rl_module_inference_only": false, "broadcast_offline_eval_runner_states": false, "offline_eval_batch_size_per_runner": 256, "dataset_num_iters_per_eval_runner": 1, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "log_gradients": false, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 9, "restart_failed_env_runners": true, "ignore_env_runner_failures": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30.0, "env_runner_restore_timeout_s": 1800.0, "_model_config": {}, "_rl_module_spec": "MultiRLModuleSpec(multi_rl_module_class=<class 'ray.rllib.core.rl_module.multi_rl_module.MultiRLModule'>, observation_space=None, action_space=None, inference_only=False, model_config=None, rl_module_specs={'default_policy': RLModuleSpec(module_class=<class 'source.intrinsic_attention_ppo.rl_modules.DifferentiablePPOModule.DifferentiablePPOModule'>, observation_space=None, action_space=None, inference_only=False, learner_only=False, model_config={'vf_share_layers': True, 'embedding_dim': 62, 'max_seq_len': 6, 'policy_head_hidden_sizes': [32], 'value_head_hidden_sizes': [101], 'embedding_hidden_sizes': [121]}, catalog_class=None, load_state_path=None, model_config_dict=None), 'intrinsic_reward_module': RLModuleSpec(module_class=<class 'source.intrinsic_attention_ppo.rl_modules.IntrinsicAttentionModule.IntrinsicAttentionModule'>, observation_space=None, action_space=None, inference_only=False, learner_only=True, model_config={'intrinsic_reward_network': {'encoder_hidden_sizes': [], 'encoding_dim': 1, 'num_heads': 1, 'head_hidden_sizes': None, 'layers': [{'type': 'attention'}]}, 'extrinsic_value_hidden_layers': [127, 60], 'vf_share_layers': True, 'max_seq_len': 6}, catalog_class=None, load_state_path=None, model_config_dict=None)}, load_state_path=None, modules_to_load=None, module_specs={'default_policy': RLModuleSpec(module_class=<class 'source.intrinsic_attention_ppo.rl_modules.DifferentiablePPOModule.DifferentiablePPOModule'>, observation_space=None, action_space=None, inference_only=False, learner_only=False, model_config={'vf_share_layers': True, 'embedding_dim': 62, 'max_seq_len': 6, 'policy_head_hidden_sizes': [32], 'value_head_hidden_sizes': [101], 'embedding_hidden_sizes': [121]}, catalog_class=None, load_state_path=None, model_config_dict=None), 'intrinsic_reward_module': RLModuleSpec(module_class=<class 'source.intrinsic_attention_ppo.rl_modules.IntrinsicAttentionModule.IntrinsicAttentionModule'>, observation_space=None, action_space=None, inference_only=False, learner_only=True, model_config={'intrinsic_reward_network': {'encoder_hidden_sizes': [], 'encoding_dim': 1, 'num_heads': 1, 'head_hidden_sizes': None, 'layers': [{'type': 'attention'}]}, 'extrinsic_value_hidden_layers': [127, 60], 'vf_share_layers': True, 'max_seq_len': 6}, catalog_class=None, load_state_path=None, model_config_dict=None)})", "algorithm_config_overrides_per_module": {"intrinsic_reward_module": {"lr": 0.0002715581955}}, "_per_module_overrides": {}, "_validate_config": true, "_use_msgpack_checkpoints": false, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "env_task_fn": -1, "enable_connectors": -1, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.161583927863, "kl_target": 0.0201019014258, "vf_loss_coeff": 0.7790510010087, "entropy_coeff": 0.0015431216992, "clip_param": 0.2459212356676, "vf_clip_param": 0.3769744131561, "entropy_coeff_schedule": null, "lr_schedule": null, "sgd_minibatch_size": -1, "vf_share_layers": -1, "differentiable_learner_configs": ["DifferentiableLearnerConfig(learner_class=<class 'source.intrinsic_attention_ppo.learners.IntrinsicAttentionPPOLearner.IntrinsicAttentionPPOLearner'>, learner_connector=None, add_default_connectors_to_learner_pipeline=True, is_multi_agent=False, policies_to_update=['default_policy'], lr=0.0060984166342, num_total_minibatches=0, num_epochs=1, minibatch_size=1000, shuffle_batch_per_epoch=True)"], "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9485408017724, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.callbacks.callbacks.RLlibCallback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 48.29332399368286, "iterations_since_restore": 5, "perf": {"cpu_util_percent": 37.684615384615384, "ram_util_percent": 80.53846153846152}}
{"timers": {"training_iteration": 9.602596557511378, "restore_env_runners": 2.0725516255318977e-05, "training_step": 9.602425053055967, "env_runner_sampling_timer": 1.746746082863015, "learner_update_timer": 7.665440826529876, "synch_weights": 0.0007915527354105663, "restore_eval_env_runners": 8.607391048858404e-06, "evaluation_iteration": 0.14257655212569986, "synch_eval_env_connectors": 0.0001375590875976894, "synch_env_connectors": 4.9788568477612e-06}, "env_runners": {"module_to_env_connector": {"timers": {"connectors": {"listify_data_for_vector_env": 1.0401171226237376e-05, "remove_single_ts_time_rank_from_batch": 1.1881533720558406e-05, "tensor_to_numpy": 1.530336381312602e-05, "un_batch_to_individual_items": 6.672852939138602e-06, "normalize_and_clip_actions": 7.894310946908675e-06, "get_actions": 3.9326021321297825e-05}}, "connector_pipeline_timer": 0.00011753173159060317}, "env_to_module_sum_episodes_length_out": 10.36823839457432, "rlmodule_inference_timer": 3.169476723614943e-05, "env_to_module_connector": {"timers": {"connectors": {"add_observations_from_episodes_to_batch": 2.7864866934277794e-06, "add_time_dim_to_batch_and_zero_pad": 6.861028412152654e-06, "numpy_to_tensor": 1.2763332451284305e-05, "batch_individual_items": 1.2373451825625013e-05, "add_states_from_episodes_to_batch": 2.6700971048119198e-06}}, "connector_pipeline_timer": 5.9190770186347384e-05}, "episode_return_max": 14.5, "num_env_steps_sampled": 5000.0, "num_episodes": 250.0, "episode_len_max": 20, "sample": 0.005668021090697568, "weights_seq_no": 5.0, "num_episodes_lifetime": -123000.0, "env_to_module_sum_episodes_length_in": 10.36823839457432, "num_agent_steps_sampled": {"default_agent": 5000.0}, "num_env_steps_sampled_lifetime": -2460000.0, "episode_duration_sec_mean": 0.0052517345086671415, "episode_return_mean": 5.700000000000004, "num_module_steps_sampled": {"default_policy": 5000.0}, "env_reset_timer": 4.20056990350468e-05, "num_module_steps_sampled_lifetime": {"default_policy": -2460000.0}, "agent_episode_returns_mean": {"default_agent": 5.700000000000004}, "env_step_timer": 1.3873378013396839e-05, "episode_return_min": -5.5, "episode_len_min": 20, "episode_len_mean": 20.0, "num_agent_steps_sampled_lifetime": {"default_agent": -2460000.0}, "module_episode_returns_mean": {"default_policy": 5.700000000000004}, "time_between_sampling": 0.03251676043068664, "num_env_steps_sampled_lifetime_throughput": 3260.8886810089853}, "__all_modules__": {"learner_connector_sum_episodes_length_in": 5000.0, "learner_connector": {"connector_pipeline_timer": 0.15331519704983732, "timers": {"connectors": {"add_one_ts_to_episodes_and_truncate": 0.008948759853093355, "add_observations_from_episodes_to_batch": 0.0008552934375992648, "add_columns_from_episodes_to_train_batch": 0.04116043428122562, "add_time_dim_to_batch_and_zero_pad": 0.08979254229229831, "add_states_from_episodes_to_batch": 0.0035882238541098507, "batch_individual_items": 0.008770929869066283, "numpy_to_tensor": 6.26902505451159e-05}}}, "learner_connector_sum_episodes_length_out": 5250.0}, "learners": {"intrinsic_reward_module": {"weights_seq_no": 6.0, "num_module_steps_trained_lifetime": 35910, "gradients_default_optimizer_global_norm": 0.0, "module_train_batch_size_mean": 998.5423314844973, "diff_num_grad_updates_vs_sampler_policy": 1.0, "num_trainable_parameters": 8266, "default_optimizer_learning_rate": 0.0002715581955, "total_loss": 0.0, "num_module_steps_trained": 5985, "curr_entropy_coeff": 0.0015431216992, "num_module_steps_trained_lifetime_throughput": 760.9799256585153}, "differentiable_learners": {"intrinsic_attention_ppo_learner": {"intrinsic_reward_module": {"total_loss": 0.0, "num_module_steps_trained": 35910, "diff_num_grad_updates_vs_sampler_policy": 31.0, "weights_seq_no": 36.0, "num_module_steps_trained_lifetime": 215460, "module_train_batch_size_mean": 997.6644392492373}, "default_policy": {"vf_explained_var": 0.0019699931144714355, "total_loss": 0.24872080981731415, "vf_loss": 0.32178452610969543, "vf_loss_unclipped": 47.38081741333008, "weights_seq_no": 36.0, "num_module_steps_trained_lifetime": 215460, "module_train_batch_size_mean": 997.6644392492373, "entropy": 0.6918460130691528, "mean_kl_loss": 4.805115895578638e-05, "use_intrinsic_rewards": 1.0, "policy_loss": -0.0009059176663868129, "num_module_steps_trained": 35910, "diff_num_grad_updates_vs_sampler_policy": 31.0}, "__all_modules__": {"num_env_steps_trained_lifetime": 1296000, "num_module_steps_trained_lifetime": 430920, "num_module_steps_trained": 71820, "num_env_steps_trained": 216000, "num_env_steps_trained_lifetime_throughput": 58692.132069893734}}}, "default_policy": {"curr_kl_coeff": 0.0025247489102184772, "num_module_steps_trained_lifetime": 35910, "module_train_batch_size_mean": 998.5423314844973, "entropy": 0.6918224096298218, "num_trainable_parameters": 16595, "mean_kl_loss": 5.2721276006195694e-05, "use_intrinsic_rewards": 0.0, "policy_loss": -0.0009464689646847546, "num_module_steps_trained": 5985, "diff_num_grad_updates_vs_sampler_policy": 1.0, "vf_explained_var": -0.0005003213882446289, "total_loss": 0.24771253764629364, "vf_loss": 0.32055193185806274, "curr_entropy_coeff": 0.0015431216992, "vf_loss_unclipped": 47.70289993286133, "weights_seq_no": 6.0, "num_module_steps_trained_lifetime_throughput": 760.9688446556066}, "__all_modules__": {"num_module_steps_trained": 11970, "num_non_trainable_parameters": 0, "num_env_steps_trained": 36000, "num_env_steps_trained_lifetime": 216000, "num_module_steps_trained_lifetime": 71820, "num_trainable_parameters": 24861, "num_env_steps_trained_lifetime_throughput": 4582.374798370296, "num_module_steps_trained_throughput": 28459004.8563818, "num_module_steps_trained_lifetime_throughput": 13114110.0032435}, "IntrinsicAttentionMask": [[[0.16699464619159698, 0.16615580022335052, 0.1656789779663086, 0.16692689061164856, 0.16690431535243988, 0.16733939945697784], [0.16679686307907104, 0.16646412014961243, 0.1662745326757431, 0.16677002608776093, 0.16676108539104462, 0.1669333279132843], [0.16668379306793213, 0.1666400283575058, 0.1666150689125061, 0.1666802614927292, 0.16667909920215607, 0.16670171916484833], [0.16697873175144196, 0.16618065536022186, 0.1657269150018692, 0.16691428422927856, 0.16689281165599823, 0.16730667650699615], [0.16697341203689575, 0.16618892550468445, 0.165742889046669, 0.1669100672006607, 0.16688895225524902, 0.16729575395584106], [0.167075514793396, 0.16602949798107147, 0.16543549299240112, 0.1669909805059433, 0.16696280241012573, 0.16750578582286835]], [[0.166979119181633, 0.16732963919639587, 0.16628503799438477, 0.16626693308353424, 0.16727495193481445, 0.16586440801620483], [0.16709977388381958, 0.16758660972118378, 0.1661369651556015, 0.16611185669898987, 0.16751062870025635, 0.1655542254447937], [0.1667388677597046, 0.16681954264640808, 0.1665787249803543, 0.16657453775405884, 0.16680696606636047, 0.16648142039775848], [0.1667325645685196, 0.1668062061071396, 0.16658638417720795, 0.16658256947994232, 0.16679471731185913, 0.16649755835533142], [0.16708098351955414, 0.16754655539989471, 0.16616006195545197, 0.16613604128360748, 0.1674738973379135, 0.16560254991054535], [0.16659240424633026, 0.16650958359241486, 0.1667570173740387, 0.16676132380962372, 0.16652250289916992, 0.16685718297958374]], [[0.16684190928936005, 0.16554981470108032, 0.16598138213157654, 0.16723157465457916, 0.1672089546918869, 0.16718633472919464], [0.16667871177196503, 0.16659016907215118, 0.16661980748176575, 0.16670529544353485, 0.16670376062393188, 0.16670221090316772], [0.16673360764980316, 0.1662413328886032, 0.16640602052211761, 0.16688160598278046, 0.1668730229139328, 0.16686443984508514], [0.1668904572725296, 0.16523848474025726, 0.16578984260559082, 0.167389377951622, 0.16736041009426117, 0.16733145713806152], [0.16688764095306396, 0.16525651514530182, 0.16580094397068024, 0.167380228638649, 0.1673516184091568, 0.167323037981987], [0.16688483953475952, 0.16527456045150757, 0.16581204533576965, 0.16737107932567596, 0.16734284162521362, 0.16731461882591248]], [[0.16793186962604523, 0.16896025836467743, 0.16484563052654266, 0.16479335725307465, 0.16771894693374634, 0.1657499372959137], [0.16809971630573273, 0.16926655173301697, 0.16460371017456055, 0.16454456746578217, 0.16785824298858643, 0.16562719643115997], [0.16742123663425446, 0.16803133487701416, 0.1655811369419098, 0.1655498445034027, 0.1672947257757187, 0.1661217361688614], [0.16741248965263367, 0.1680154800415039, 0.1655937284231186, 0.16556279361248016, 0.1672874540090561, 0.16612808406352997], [0.16789697110652924, 0.1688966304063797, 0.1648959219455719, 0.1648450493812561, 0.1676899641752243, 0.16577540338039398], [0.16757193207740784, 0.16830503940582275, 0.1653641313314438, 0.16532662510871887, 0.16741998493671417, 0.1660122573375702]], [[0.16707053780555725, 0.16577668488025665, 0.1657542586326599, 0.16746073961257935, 0.16698016226291656, 0.16695758700370789], [0.16669432818889618, 0.16660577058792114, 0.16660423576831818, 0.166720911860466, 0.16668817400932312, 0.16668662428855896], [0.1666877567768097, 0.1666201949119568, 0.16661903262138367, 0.16670803725719452, 0.16668306291103363, 0.16668188571929932], [0.16718314588069916, 0.1655282825231552, 0.16549964249134064, 0.167682945728302, 0.16706745326519012, 0.16703854501247406], [0.16704438626766205, 0.16583432257175446, 0.16581334173679352, 0.16740921139717102, 0.16695989668369293, 0.16693876683712006], [0.16703785955905914, 0.1658487468957901, 0.165828138589859, 0.16739635169506073, 0.16695484519004822, 0.1669340878725052]], [[0.16762489080429077, 0.16759918630123138, 0.16561351716518402, 0.1655881255865097, 0.1675221174955368, 0.16605210304260254], [0.16761119663715363, 0.16758586466312408, 0.1656285673379898, 0.16560354828834534, 0.16750989854335785, 0.1660609096288681], [0.16654635965824127, 0.16654956340789795, 0.16679900884628296, 0.16680222749710083, 0.16655917465686798, 0.16674362123012543], [0.16653266549110413, 0.16653624176979065, 0.16681408882141113, 0.16681766510009766, 0.16654694080352783, 0.1667523831129074], [0.167570099234581, 0.167545884847641, 0.16567373275756836, 0.16564977169036865, 0.1674732267856598, 0.166087344288826], [0.16678261756896973, 0.1667795330286026, 0.16653913259506226, 0.16653603315353394, 0.16677023470401764, 0.16659244894981384]]]}, "num_training_step_calls_per_iteration": 1, "evaluation": {"env_runners": {"episode_len_min": 20, "env_to_module_connector": {"timers": {"connectors": {"numpy_to_tensor": 1.2828260261218235e-05, "add_states_from_episodes_to_batch": 2.7765443175005704e-06, "batch_individual_items": 1.3073469929676901e-05, "add_time_dim_to_batch_and_zero_pad": 7.183898568574841e-06, "add_observations_from_episodes_to_batch": 2.8553704283658836e-06}}, "connector_pipeline_timer": 6.079473466424609e-05}, "module_to_env_connector": {"timers": {"connectors": {"tensor_to_numpy": 1.5318116775307917e-05, "un_batch_to_individual_items": 6.620869544354795e-06, "normalize_and_clip_actions": 8.00222576255793e-06, "get_actions": 3.823237881773895e-05, "remove_single_ts_time_rank_from_batch": 1.1920352890644301e-05, "listify_data_for_vector_env": 1.0601875376035914e-05}}, "connector_pipeline_timer": 0.0001167698013475118}, "num_env_steps_sampled": 400, "episode_len_max": 20, "num_agent_steps_sampled": {"default_agent": 400}, "weights_seq_no": 6.0, "num_env_steps_sampled_lifetime": 30400, "episode_duration_sec_mean": 0.005246854643337429, "episode_return_mean": -1.5, "env_reset_timer": 0.00015590651273808198, "module_episode_returns_mean": {"default_policy": -1.5}, "rlmodule_inference_timer": 3.203890164087347e-05, "episode_return_max": 15.5, "env_to_module_sum_episodes_length_in": 10.368238394470474, "num_module_steps_sampled": {"default_policy": 400}, "agent_episode_returns_mean": {"default_agent": -1.5}, "num_agent_steps_sampled_lifetime": {"default_agent": 2400}, "num_module_steps_sampled_lifetime": {"default_policy": 2400}, "env_to_module_sum_episodes_length_out": 10.368238394470474, "num_episodes": 20, "num_episodes_lifetime": 120, "episode_return_min": -13.5, "sample": 0.1357893731804187, "env_step_timer": 1.4230134361910194e-05, "episode_len_mean": 20.0, "time_between_sampling": 9.636438767309741}, "num_healthy_workers": 1, "actor_manager_num_outstanding_async_reqs": 0, "num_remote_worker_restarts": 0}, "num_env_steps_sampled_lifetime": -2460000.0, "fault_tolerance": {"num_healthy_workers": 0, "num_remote_worker_restarts": 0}, "env_runner_group": {"actor_manager_num_outstanding_async_reqs": 0}, "done": false, "training_iteration": 6, "trial_id": "b17e2_00000", "date": "2025-08-11_18-44-07", "timestamp": 1754930647, "time_this_iter_s": 9.519577026367188, "time_total_s": 57.81290102005005, "pid": 11680, "hostname": "Mac", "node_ip": "127.0.0.1", "config": {"exploration_config": {}, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 2, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "env": "Umbrella", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": false, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 0, "create_local_env_runner": true, "num_envs_per_env_runner": 1, "gym_env_vectorize_mode": "SYNC", "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "episodes_to_numpy": true, "max_requests_in_flight_per_env_runner": 1, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "merge_env_runner_states": "training_only", "broadcast_env_runner_states": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "complete_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "sampler_perf_stats_ema_coef": null, "_is_online": true, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": "auto", "num_aggregator_actors_per_learner": 0, "max_requests_in_flight_per_aggregator_actor": 3, "local_gpu_idx": 0, "max_requests_in_flight_per_learner": 3, "gamma": 1, "lr": 0.0002715581955, "grad_clip": 0.5, "grad_clip_by": "global_norm", "_train_batch_size_per_learner": 5000, "train_batch_size": 4000, "num_epochs": 1, "minibatch_size": 1000, "shuffle_batch_per_epoch": true, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "log_std_clip_param": 20.0, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "_disable_preprocessor_api": false, "_disable_action_flattening": false}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {"intrinsic_reward_coeff": 0.2795015916508}, "optimizer": {}, "_learner_class": "<class 'source.intrinsic_attention_ppo.learners.IntrinsicAttentionMetaLearner.IntrinsicAttentionMetaLearner'>", "callbacks_on_algorithm_init": null, "callbacks_on_env_runners_recreated": null, "callbacks_on_offline_eval_runners_recreated": null, "callbacks_on_checkpoint_loaded": null, "callbacks_on_environment_created": null, "callbacks_on_episode_created": null, "callbacks_on_episode_start": null, "callbacks_on_episode_step": null, "callbacks_on_episode_end": null, "callbacks_on_evaluate_start": null, "callbacks_on_evaluate_end": null, "callbacks_on_evaluate_offline_start": null, "callbacks_on_evaluate_offline_end": null, "callbacks_on_sample_end": null, "callbacks_on_train_result": null, "explore": true, "enable_rl_module_and_learner": true, "enable_env_runner_and_connector_v2": true, "_prior_exploration_config": {"type": "StochasticSampling"}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x13c0118a0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "offline_data_class": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_read_batch_size": null, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "materialize_data": false, "materialize_mapped_data": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "ignore_final_observation": false, "prelearner_class": null, "prelearner_buffer_class": null, "prelearner_buffer_kwargs": {}, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_remaining_data": false, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": 1, "evaluation_duration": 20, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_auto_duration_min_env_steps_per_sample": 100, "evaluation_auto_duration_max_env_steps_per_sample": 2000, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 1, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "offline_evaluation_interval": null, "num_offline_eval_runners": 0, "offline_loss_for_module_fn": null, "offline_evaluation_duration": 1, "offline_evaluation_parallel_to_training": false, "offline_evaluation_timeout_s": 120.0, "num_cpus_per_offline_eval_runner": 1, "num_gpus_per_offline_eval_runner": 0, "custom_resources_per_offline_eval_runner": {}, "restart_failed_offline_eval_runners": true, "ignore_offline_eval_runner_failures": false, "max_num_offline_eval_runner_restarts": 1000, "offline_eval_runner_restore_timeout_s": 1800.0, "max_requests_in_flight_per_offline_eval_runner": 1, "validate_offline_eval_runners_after_construction": true, "offline_eval_runner_health_probe_timeout_s": 30.0, "offline_eval_rl_module_inference_only": false, "broadcast_offline_eval_runner_states": false, "offline_eval_batch_size_per_runner": 256, "dataset_num_iters_per_eval_runner": 1, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "log_gradients": false, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 9, "restart_failed_env_runners": true, "ignore_env_runner_failures": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30.0, "env_runner_restore_timeout_s": 1800.0, "_model_config": {}, "_rl_module_spec": "MultiRLModuleSpec(multi_rl_module_class=<class 'ray.rllib.core.rl_module.multi_rl_module.MultiRLModule'>, observation_space=None, action_space=None, inference_only=False, model_config=None, rl_module_specs={'default_policy': RLModuleSpec(module_class=<class 'source.intrinsic_attention_ppo.rl_modules.DifferentiablePPOModule.DifferentiablePPOModule'>, observation_space=None, action_space=None, inference_only=False, learner_only=False, model_config={'vf_share_layers': True, 'embedding_dim': 62, 'max_seq_len': 6, 'policy_head_hidden_sizes': [32], 'value_head_hidden_sizes': [101], 'embedding_hidden_sizes': [121]}, catalog_class=None, load_state_path=None, model_config_dict=None), 'intrinsic_reward_module': RLModuleSpec(module_class=<class 'source.intrinsic_attention_ppo.rl_modules.IntrinsicAttentionModule.IntrinsicAttentionModule'>, observation_space=None, action_space=None, inference_only=False, learner_only=True, model_config={'intrinsic_reward_network': {'encoder_hidden_sizes': [], 'encoding_dim': 1, 'num_heads': 1, 'head_hidden_sizes': None, 'layers': [{'type': 'attention'}]}, 'extrinsic_value_hidden_layers': [127, 60], 'vf_share_layers': True, 'max_seq_len': 6}, catalog_class=None, load_state_path=None, model_config_dict=None)}, load_state_path=None, modules_to_load=None, module_specs={'default_policy': RLModuleSpec(module_class=<class 'source.intrinsic_attention_ppo.rl_modules.DifferentiablePPOModule.DifferentiablePPOModule'>, observation_space=None, action_space=None, inference_only=False, learner_only=False, model_config={'vf_share_layers': True, 'embedding_dim': 62, 'max_seq_len': 6, 'policy_head_hidden_sizes': [32], 'value_head_hidden_sizes': [101], 'embedding_hidden_sizes': [121]}, catalog_class=None, load_state_path=None, model_config_dict=None), 'intrinsic_reward_module': RLModuleSpec(module_class=<class 'source.intrinsic_attention_ppo.rl_modules.IntrinsicAttentionModule.IntrinsicAttentionModule'>, observation_space=None, action_space=None, inference_only=False, learner_only=True, model_config={'intrinsic_reward_network': {'encoder_hidden_sizes': [], 'encoding_dim': 1, 'num_heads': 1, 'head_hidden_sizes': None, 'layers': [{'type': 'attention'}]}, 'extrinsic_value_hidden_layers': [127, 60], 'vf_share_layers': True, 'max_seq_len': 6}, catalog_class=None, load_state_path=None, model_config_dict=None)})", "algorithm_config_overrides_per_module": {"intrinsic_reward_module": {"lr": 0.0002715581955}}, "_per_module_overrides": {}, "_validate_config": true, "_use_msgpack_checkpoints": false, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "env_task_fn": -1, "enable_connectors": -1, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.161583927863, "kl_target": 0.0201019014258, "vf_loss_coeff": 0.7790510010087, "entropy_coeff": 0.0015431216992, "clip_param": 0.2459212356676, "vf_clip_param": 0.3769744131561, "entropy_coeff_schedule": null, "lr_schedule": null, "sgd_minibatch_size": -1, "vf_share_layers": -1, "differentiable_learner_configs": ["DifferentiableLearnerConfig(learner_class=<class 'source.intrinsic_attention_ppo.learners.IntrinsicAttentionPPOLearner.IntrinsicAttentionPPOLearner'>, learner_connector=None, add_default_connectors_to_learner_pipeline=True, is_multi_agent=False, policies_to_update=['default_policy'], lr=0.0060984166342, num_total_minibatches=0, num_epochs=1, minibatch_size=1000, shuffle_batch_per_epoch=True)"], "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9485408017724, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.callbacks.callbacks.RLlibCallback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 57.81290102005005, "iterations_since_restore": 6, "perf": {"cpu_util_percent": 37.135714285714286, "ram_util_percent": 80.39999999999999}}
{"timers": {"training_iteration": 9.60415440109596, "restore_env_runners": 2.058118124590681e-05, "training_step": 9.60398242544494, "env_runner_sampling_timer": 1.745233854534949, "learner_update_timer": 7.668370014515318, "synch_weights": 0.0007927338780209529, "restore_eval_env_runners": 8.590067370827935e-06, "evaluation_iteration": 0.1423394291046441, "synch_eval_env_connectors": 0.00013713099636944906, "synch_env_connectors": 4.969907938333695e-06}, "env_runners": {"module_to_env_connector": {"timers": {"connectors": {"listify_data_for_vector_env": 1.073966549862287e-05, "remove_single_ts_time_rank_from_batch": 1.2134515014814552e-05, "tensor_to_numpy": 1.5816792407886404e-05, "un_batch_to_individual_items": 6.806061888459022e-06, "normalize_and_clip_actions": 8.139465980563066e-06, "get_actions": 4.1614369978896625e-05}}, "connector_pipeline_timer": 0.0001219436926452275}, "env_to_module_sum_episodes_length_out": 10.36823839457432, "rlmodule_inference_timer": 3.317290063589601e-05, "env_to_module_connector": {"timers": {"connectors": {"add_observations_from_episodes_to_batch": 2.8596768091825923e-06, "add_time_dim_to_batch_and_zero_pad": 7.10654679245986e-06, "numpy_to_tensor": 1.3253139427196392e-05, "batch_individual_items": 1.2824530993567537e-05, "add_states_from_episodes_to_batch": 2.7657005670526652e-06}}, "connector_pipeline_timer": 6.107926980453896e-05}, "episode_return_max": 14.5, "num_env_steps_sampled": 5000.0, "num_episodes": 250.0, "episode_len_max": 20, "sample": 0.005766304940979577, "weights_seq_no": 6.0, "num_episodes_lifetime": -153875.0, "env_to_module_sum_episodes_length_in": 10.36823839457432, "num_agent_steps_sampled": {"default_agent": 5000.0}, "num_env_steps_sampled_lifetime": -3077500.0, "episode_duration_sec_mean": 0.005457541467156261, "episode_return_mean": 4.579999999999998, "num_module_steps_sampled": {"default_policy": 5000.0}, "env_reset_timer": 4.525601438458445e-05, "num_module_steps_sampled_lifetime": {"default_policy": -3077500.0}, "agent_episode_returns_mean": {"default_agent": 4.579999999999998}, "env_step_timer": 1.4605637298773471e-05, "episode_return_min": -5.5, "episode_len_min": 20, "episode_len_mean": 20.0, "num_agent_steps_sampled_lifetime": {"default_agent": -3077500.0}, "module_episode_returns_mean": {"default_policy": 4.579999999999998}, "time_between_sampling": 0.03252870401530456, "num_env_steps_sampled_lifetime_throughput": 3150.1122197217173}, "__all_modules__": {"learner_connector_sum_episodes_length_in": 5000.0, "learner_connector": {"connector_pipeline_timer": 0.1533383763292242, "timers": {"connectors": {"add_one_ts_to_episodes_and_truncate": 0.008948626425048753, "add_observations_from_episodes_to_batch": 0.0008553288433567007, "add_columns_from_episodes_to_train_batch": 0.04116147576732354, "add_time_dim_to_batch_and_zero_pad": 0.08981367894900426, "add_states_from_episodes_to_batch": 0.003597090364919881, "batch_individual_items": 0.008763046400555818, "numpy_to_tensor": 6.297376707909298e-05}}}, "learner_connector_sum_episodes_length_out": 5250.0}, "learners": {"intrinsic_reward_module": {"weights_seq_no": 7.0, "num_module_steps_trained_lifetime": 41895, "gradients_default_optimizer_global_norm": 0.0, "module_train_batch_size_mean": 998.4808932973482, "diff_num_grad_updates_vs_sampler_policy": 1.0, "num_trainable_parameters": 8266, "default_optimizer_learning_rate": 0.0002715581955, "total_loss": 0.0, "num_module_steps_trained": 5985, "curr_entropy_coeff": 0.0015431216992, "num_module_steps_trained_lifetime_throughput": 758.7063458127424}, "differentiable_learners": {"intrinsic_attention_ppo_learner": {"intrinsic_reward_module": {"total_loss": 0.0, "num_module_steps_trained": 35910, "diff_num_grad_updates_vs_sampler_policy": 36.0, "weights_seq_no": 42.0, "num_module_steps_trained_lifetime": 251370, "module_train_batch_size_mean": 997.6122293241576}, "default_policy": {"vf_explained_var": 0.00199204683303833, "total_loss": 0.2493799477815628, "vf_loss": 0.3215721845626831, "vf_loss_unclipped": 48.06778335571289, "weights_seq_no": 42.0, "num_module_steps_trained_lifetime": 251370, "module_train_batch_size_mean": 997.6122293241576, "entropy": 0.6916795969009399, "mean_kl_loss": 4.731604349217378e-06, "use_intrinsic_rewards": 1.0, "policy_loss": -7.461168570443988e-05, "num_module_steps_trained": 35910, "diff_num_grad_updates_vs_sampler_policy": 36.0}, "__all_modules__": {"num_env_steps_trained_lifetime": 1512000, "num_module_steps_trained_lifetime": 502740, "num_module_steps_trained": 71820, "num_env_steps_trained": 216000, "num_env_steps_trained_lifetime_throughput": 57733.27982784188}}}, "default_policy": {"curr_kl_coeff": 0.0012623744551092386, "num_module_steps_trained_lifetime": 41895, "module_train_batch_size_mean": 998.4808932973482, "entropy": 0.6916743516921997, "num_trainable_parameters": 16595, "mean_kl_loss": 5.057504949945724e-06, "use_intrinsic_rewards": 0.0, "policy_loss": -7.67609744798392e-05, "num_module_steps_trained": 5985, "diff_num_grad_updates_vs_sampler_policy": 1.0, "vf_explained_var": -0.0007063150405883789, "total_loss": 0.2485543191432953, "vf_loss": 0.32051610946655273, "curr_entropy_coeff": 0.0015431216992, "vf_loss_unclipped": 48.43284606933594, "weights_seq_no": 7.0, "num_module_steps_trained_lifetime_throughput": 758.6957760584138}, "__all_modules__": {"num_module_steps_trained": 11970, "num_non_trainable_parameters": 0, "num_env_steps_trained": 36000, "num_env_steps_trained_lifetime": 252000, "num_module_steps_trained_lifetime": 83790, "num_trainable_parameters": 24861, "num_env_steps_trained_lifetime_throughput": 4568.524616996242, "num_module_steps_trained_throughput": 27672247.770703796, "num_module_steps_trained_lifetime_throughput": 13090137.02161807}, "IntrinsicAttentionMask": [[[0.16514091193675995, 0.16625739634037018, 0.1656239926815033, 0.16789253056049347, 0.16786237061023712, 0.16722285747528076], [0.1644449532032013, 0.16606812179088593, 0.16514664888381958, 0.1684543341398239, 0.16841022670269012, 0.16747575998306274], [0.1648390144109726, 0.1661754846572876, 0.16541706025600433, 0.16813601553440094, 0.16809982061386108, 0.16733260452747345], [0.16343678534030914, 0.16579104959964752, 0.16445325314998627, 0.1692710965871811, 0.16920655965805054, 0.16784121096134186], [0.1634552925825119, 0.1657961755990982, 0.164465993642807, 0.16925610601902008, 0.16919195652008057, 0.16783452033996582], [0.1638481169939041, 0.16590450704097748, 0.16473641991615295, 0.16893744468688965, 0.16888128221035004, 0.16769222915172577]], [[0.1670406609773636, 0.1673913151025772, 0.16634634137153625, 0.16632822155952454, 0.16696788370609283, 0.1659255474805832], [0.16718533635139465, 0.16767241060733795, 0.16622203588485718, 0.16619691252708435, 0.16708427667617798, 0.1656389832496643], [0.16675300896167755, 0.16683369874954224, 0.16659285128116608, 0.1665886640548706, 0.16673624515533447, 0.16649554669857025], [0.16674546897411346, 0.16681912541389465, 0.16659928858280182, 0.1665954738855362, 0.16673018038272858, 0.1665104627609253], [0.1670105904340744, 0.16733293235301971, 0.1663721650838852, 0.16635549068450928, 0.16694366931915283, 0.1659851372241974], [0.16657789051532745, 0.16649506986141205, 0.1667424738407135, 0.16674678027629852, 0.16659510135650635, 0.16684263944625854]], [[0.16691824793815613, 0.16562558710575104, 0.16605733335018158, 0.16730809211730957, 0.1668279469013214, 0.16726283729076385], [0.16668391227722168, 0.16659535467624664, 0.1666250079870224, 0.1667104959487915, 0.16667775809764862, 0.16670741140842438], [0.166762575507164, 0.16627022624015808, 0.16643492877483368, 0.16691060364246368, 0.16672825813293457, 0.16689343750476837], [0.16698819398880005, 0.1653352677822113, 0.16588695347309113, 0.16748741269111633, 0.16687263548374176, 0.16742944717407227], [0.16690197587013245, 0.16569294035434723, 0.16609682142734528, 0.16726648807525635, 0.1668175607919693, 0.16722416877746582], [0.1669801026582718, 0.1653689295053482, 0.16590671241283417, 0.16746662557125092, 0.1668674796819687, 0.16741013526916504]], [[0.1681104153394699, 0.16805709898471832, 0.1650209128856659, 0.1649685800075531, 0.16897901892662048, 0.1648639589548111], [0.16810044646263123, 0.16804750263690948, 0.1650322824716568, 0.16498030722141266, 0.1689629852771759, 0.16487640142440796], [0.16752757132053375, 0.16749590635299683, 0.16568632423877716, 0.1656550019979477, 0.16804276406764984, 0.16559240221977234], [0.16751758754253387, 0.167486310005188, 0.16569769382476807, 0.16566674411296844, 0.16802677512168884, 0.1656048595905304], [0.16827218234539032, 0.16821283102035522, 0.16483598947525024, 0.16477784514427185, 0.16923953592777252, 0.16466161608695984], [0.1674976497888565, 0.16746710240840912, 0.16572044789791107, 0.16569022834300995, 0.16799479722976685, 0.1656297892332077]], [[0.1669946312904358, 0.16570137441158295, 0.166133314371109, 0.16738465428352356, 0.1669043004512787, 0.16688172519207], [0.16668911278247833, 0.1666005551815033, 0.16663020849227905, 0.16671569645404816, 0.16668295860290527, 0.1666814088821411], [0.16679154336452484, 0.16629910469055176, 0.16646383702754974, 0.1669396013021469, 0.1667572259902954, 0.16674865782260895], [0.16708606481552124, 0.1654321700334549, 0.1659841686487198, 0.1675855666399002, 0.16697043180465698, 0.1669415384531021], [0.16697341203689575, 0.16576385498046875, 0.16616791486740112, 0.1673380732536316, 0.16688895225524902, 0.16686783730983734], [0.16696810722351074, 0.1657794862985611, 0.16617657244205475, 0.1673264354467392, 0.166885107755661, 0.16686438024044037]], [[0.1675386130809784, 0.1675129234790802, 0.1660430133342743, 0.1655029058456421, 0.167435884475708, 0.16596664488315582], [0.16752615571022034, 0.167500838637352, 0.1660519540309906, 0.16551953554153442, 0.16742490231990814, 0.16597667336463928], [0.1668095737695694, 0.16680537164211273, 0.16656458377838135, 0.16647563874721527, 0.16679279506206512, 0.16655202209949493], [0.16654473543167114, 0.16654829680919647, 0.16675373911857605, 0.16682974994182587, 0.16655902564525604, 0.16676446795463562], [0.16748873889446259, 0.16746452450752258, 0.16607873141765594, 0.16556935012340546, 0.16739191114902496, 0.16600671410560608], [0.16677217185497284, 0.1667690873146057, 0.16659128665924072, 0.16652561724185944, 0.16675978899002075, 0.16658201813697815]]]}, "num_training_step_calls_per_iteration": 1, "evaluation": {"env_runners": {"episode_len_min": 20, "env_to_module_connector": {"timers": {"connectors": {"numpy_to_tensor": 1.1839583121153383e-05, "add_states_from_episodes_to_batch": 2.717480936822833e-06, "batch_individual_items": 1.2341930933500291e-05, "add_time_dim_to_batch_and_zero_pad": 7.214380419830142e-06, "add_observations_from_episodes_to_batch": 2.8436490942567054e-06}}, "connector_pipeline_timer": 5.856388448936322e-05}, "module_to_env_connector": {"timers": {"connectors": {"tensor_to_numpy": 1.478223036328667e-05, "un_batch_to_individual_items": 6.467976601253791e-06, "normalize_and_clip_actions": 7.810404027030026e-06, "get_actions": 3.6050877006093895e-05, "remove_single_ts_time_rank_from_batch": 1.166854354008231e-05, "listify_data_for_vector_env": 1.0434429500778047e-05}}, "connector_pipeline_timer": 0.00011265628711557624}, "num_env_steps_sampled": 400, "episode_len_max": 20, "num_agent_steps_sampled": {"default_agent": 400}, "weights_seq_no": 7.0, "num_env_steps_sampled_lifetime": 35400, "episode_duration_sec_mean": 0.005211520068114623, "episode_return_mean": -1.1, "env_reset_timer": 0.00015747702790168923, "module_episode_returns_mean": {"default_policy": -1.1}, "rlmodule_inference_timer": 3.0520275962057235e-05, "episode_return_max": 15.5, "env_to_module_sum_episodes_length_in": 10.368238394572801, "num_module_steps_sampled": {"default_policy": 400}, "agent_episode_returns_mean": {"default_agent": -1.1}, "num_agent_steps_sampled_lifetime": {"default_agent": 2800}, "num_module_steps_sampled_lifetime": {"default_policy": 2800}, "env_to_module_sum_episodes_length_out": 10.368238394572801, "num_episodes": 20, "num_episodes_lifetime": 140, "episode_return_min": -13.5, "sample": 0.13556393194936575, "env_step_timer": 1.3773895978219836e-05, "episode_len_mean": 20.0, "time_between_sampling": 9.637907401716076}, "num_healthy_workers": 1, "actor_manager_num_outstanding_async_reqs": 0, "num_remote_worker_restarts": 0}, "num_env_steps_sampled_lifetime": -3077500.0, "fault_tolerance": {"num_healthy_workers": 0, "num_remote_worker_restarts": 0}, "env_runner_group": {"actor_manager_num_outstanding_async_reqs": 0}, "done": false, "training_iteration": 7, "trial_id": "b17e2_00000", "date": "2025-08-11_18-44-17", "timestamp": 1754930657, "time_this_iter_s": 9.88324499130249, "time_total_s": 67.69614601135254, "pid": 11680, "hostname": "Mac", "node_ip": "127.0.0.1", "config": {"exploration_config": {}, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 2, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "env": "Umbrella", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": false, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 0, "create_local_env_runner": true, "num_envs_per_env_runner": 1, "gym_env_vectorize_mode": "SYNC", "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "episodes_to_numpy": true, "max_requests_in_flight_per_env_runner": 1, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "merge_env_runner_states": "training_only", "broadcast_env_runner_states": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "complete_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "sampler_perf_stats_ema_coef": null, "_is_online": true, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": "auto", "num_aggregator_actors_per_learner": 0, "max_requests_in_flight_per_aggregator_actor": 3, "local_gpu_idx": 0, "max_requests_in_flight_per_learner": 3, "gamma": 1, "lr": 0.0002715581955, "grad_clip": 0.5, "grad_clip_by": "global_norm", "_train_batch_size_per_learner": 5000, "train_batch_size": 4000, "num_epochs": 1, "minibatch_size": 1000, "shuffle_batch_per_epoch": true, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "log_std_clip_param": 20.0, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "_disable_preprocessor_api": false, "_disable_action_flattening": false}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {"intrinsic_reward_coeff": 0.2795015916508}, "optimizer": {}, "_learner_class": "<class 'source.intrinsic_attention_ppo.learners.IntrinsicAttentionMetaLearner.IntrinsicAttentionMetaLearner'>", "callbacks_on_algorithm_init": null, "callbacks_on_env_runners_recreated": null, "callbacks_on_offline_eval_runners_recreated": null, "callbacks_on_checkpoint_loaded": null, "callbacks_on_environment_created": null, "callbacks_on_episode_created": null, "callbacks_on_episode_start": null, "callbacks_on_episode_step": null, "callbacks_on_episode_end": null, "callbacks_on_evaluate_start": null, "callbacks_on_evaluate_end": null, "callbacks_on_evaluate_offline_start": null, "callbacks_on_evaluate_offline_end": null, "callbacks_on_sample_end": null, "callbacks_on_train_result": null, "explore": true, "enable_rl_module_and_learner": true, "enable_env_runner_and_connector_v2": true, "_prior_exploration_config": {"type": "StochasticSampling"}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x13c0118a0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "offline_data_class": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_read_batch_size": null, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "materialize_data": false, "materialize_mapped_data": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "ignore_final_observation": false, "prelearner_class": null, "prelearner_buffer_class": null, "prelearner_buffer_kwargs": {}, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_remaining_data": false, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": 1, "evaluation_duration": 20, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_auto_duration_min_env_steps_per_sample": 100, "evaluation_auto_duration_max_env_steps_per_sample": 2000, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 1, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "offline_evaluation_interval": null, "num_offline_eval_runners": 0, "offline_loss_for_module_fn": null, "offline_evaluation_duration": 1, "offline_evaluation_parallel_to_training": false, "offline_evaluation_timeout_s": 120.0, "num_cpus_per_offline_eval_runner": 1, "num_gpus_per_offline_eval_runner": 0, "custom_resources_per_offline_eval_runner": {}, "restart_failed_offline_eval_runners": true, "ignore_offline_eval_runner_failures": false, "max_num_offline_eval_runner_restarts": 1000, "offline_eval_runner_restore_timeout_s": 1800.0, "max_requests_in_flight_per_offline_eval_runner": 1, "validate_offline_eval_runners_after_construction": true, "offline_eval_runner_health_probe_timeout_s": 30.0, "offline_eval_rl_module_inference_only": false, "broadcast_offline_eval_runner_states": false, "offline_eval_batch_size_per_runner": 256, "dataset_num_iters_per_eval_runner": 1, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "log_gradients": false, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 9, "restart_failed_env_runners": true, "ignore_env_runner_failures": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30.0, "env_runner_restore_timeout_s": 1800.0, "_model_config": {}, "_rl_module_spec": "MultiRLModuleSpec(multi_rl_module_class=<class 'ray.rllib.core.rl_module.multi_rl_module.MultiRLModule'>, observation_space=None, action_space=None, inference_only=False, model_config=None, rl_module_specs={'default_policy': RLModuleSpec(module_class=<class 'source.intrinsic_attention_ppo.rl_modules.DifferentiablePPOModule.DifferentiablePPOModule'>, observation_space=None, action_space=None, inference_only=False, learner_only=False, model_config={'vf_share_layers': True, 'embedding_dim': 62, 'max_seq_len': 6, 'policy_head_hidden_sizes': [32], 'value_head_hidden_sizes': [101], 'embedding_hidden_sizes': [121]}, catalog_class=None, load_state_path=None, model_config_dict=None), 'intrinsic_reward_module': RLModuleSpec(module_class=<class 'source.intrinsic_attention_ppo.rl_modules.IntrinsicAttentionModule.IntrinsicAttentionModule'>, observation_space=None, action_space=None, inference_only=False, learner_only=True, model_config={'intrinsic_reward_network': {'encoder_hidden_sizes': [], 'encoding_dim': 1, 'num_heads': 1, 'head_hidden_sizes': None, 'layers': [{'type': 'attention'}]}, 'extrinsic_value_hidden_layers': [127, 60], 'vf_share_layers': True, 'max_seq_len': 6}, catalog_class=None, load_state_path=None, model_config_dict=None)}, load_state_path=None, modules_to_load=None, module_specs={'default_policy': RLModuleSpec(module_class=<class 'source.intrinsic_attention_ppo.rl_modules.DifferentiablePPOModule.DifferentiablePPOModule'>, observation_space=None, action_space=None, inference_only=False, learner_only=False, model_config={'vf_share_layers': True, 'embedding_dim': 62, 'max_seq_len': 6, 'policy_head_hidden_sizes': [32], 'value_head_hidden_sizes': [101], 'embedding_hidden_sizes': [121]}, catalog_class=None, load_state_path=None, model_config_dict=None), 'intrinsic_reward_module': RLModuleSpec(module_class=<class 'source.intrinsic_attention_ppo.rl_modules.IntrinsicAttentionModule.IntrinsicAttentionModule'>, observation_space=None, action_space=None, inference_only=False, learner_only=True, model_config={'intrinsic_reward_network': {'encoder_hidden_sizes': [], 'encoding_dim': 1, 'num_heads': 1, 'head_hidden_sizes': None, 'layers': [{'type': 'attention'}]}, 'extrinsic_value_hidden_layers': [127, 60], 'vf_share_layers': True, 'max_seq_len': 6}, catalog_class=None, load_state_path=None, model_config_dict=None)})", "algorithm_config_overrides_per_module": {"intrinsic_reward_module": {"lr": 0.0002715581955}}, "_per_module_overrides": {}, "_validate_config": true, "_use_msgpack_checkpoints": false, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "env_task_fn": -1, "enable_connectors": -1, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.161583927863, "kl_target": 0.0201019014258, "vf_loss_coeff": 0.7790510010087, "entropy_coeff": 0.0015431216992, "clip_param": 0.2459212356676, "vf_clip_param": 0.3769744131561, "entropy_coeff_schedule": null, "lr_schedule": null, "sgd_minibatch_size": -1, "vf_share_layers": -1, "differentiable_learner_configs": ["DifferentiableLearnerConfig(learner_class=<class 'source.intrinsic_attention_ppo.learners.IntrinsicAttentionPPOLearner.IntrinsicAttentionPPOLearner'>, learner_connector=None, add_default_connectors_to_learner_pipeline=True, is_multi_agent=False, policies_to_update=['default_policy'], lr=0.0060984166342, num_total_minibatches=0, num_epochs=1, minibatch_size=1000, shuffle_batch_per_epoch=True)"], "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9485408017724, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.callbacks.callbacks.RLlibCallback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 67.69614601135254, "iterations_since_restore": 7, "perf": {"cpu_util_percent": 40.021428571428565, "ram_util_percent": 79.86428571428571}}
{"timers": {"training_iteration": 9.60464209792488, "restore_env_runners": 2.0432869289204503e-05, "training_step": 9.604469495350106, "env_runner_sampling_timer": 1.7431136293286995, "learner_update_timer": 7.6708970402008, "synch_weights": 0.000800366538978632, "restore_eval_env_runners": 8.582076487099113e-06, "evaluation_iteration": 0.14213621773323962, "synch_eval_env_connectors": 0.00013687593588324537, "synch_env_connectors": 4.9577085624172505e-06}, "env_runners": {"module_to_env_connector": {"timers": {"connectors": {"listify_data_for_vector_env": 1.0473776547631428e-05, "remove_single_ts_time_rank_from_batch": 1.1928973389006157e-05, "tensor_to_numpy": 1.5358575300116486e-05, "un_batch_to_individual_items": 6.668844611348095e-06, "normalize_and_clip_actions": 7.980231558465593e-06, "get_actions": 3.937541510372796e-05}}, "connector_pipeline_timer": 0.00011794733533221469}, "env_to_module_sum_episodes_length_out": 10.36823839457432, "rlmodule_inference_timer": 3.1690040081414584e-05, "env_to_module_connector": {"timers": {"connectors": {"add_observations_from_episodes_to_batch": 2.7797708440267478e-06, "add_time_dim_to_batch_and_zero_pad": 6.9010417510644685e-06, "numpy_to_tensor": 1.2812160308197564e-05, "batch_individual_items": 1.2506244521261974e-05, "add_states_from_episodes_to_batch": 2.694270710280837e-06}}, "connector_pipeline_timer": 5.949459856857028e-05}, "episode_return_max": 14.5, "num_env_steps_sampled": 5000.0, "num_episodes": 250.0, "episode_len_max": 20, "sample": 0.005694807183691259, "weights_seq_no": 7.0, "num_episodes_lifetime": -184750.0, "env_to_module_sum_episodes_length_in": 10.36823839457432, "num_agent_steps_sampled": {"default_agent": 5000.0}, "num_env_steps_sampled_lifetime": -3695000.0, "episode_duration_sec_mean": 0.005266877172049133, "episode_return_mean": 5.0600000000000005, "num_module_steps_sampled": {"default_policy": 5000.0}, "env_reset_timer": 4.275633036390429e-05, "num_module_steps_sampled_lifetime": {"default_policy": -3695000.0}, "agent_episode_returns_mean": {"default_agent": 5.0600000000000005}, "env_step_timer": 1.3971007285182014e-05, "episode_return_min": -5.5, "episode_len_min": 20, "episode_len_mean": 20.0, "num_agent_steps_sampled_lifetime": {"default_agent": -3695000.0}, "module_episode_returns_mean": {"default_policy": 5.0600000000000005}, "time_between_sampling": 0.03361750334969587, "num_env_steps_sampled_lifetime_throughput": 3244.0698385249107}, "__all_modules__": {"learner_connector_sum_episodes_length_in": 5000.0, "learner_connector": {"connector_pipeline_timer": 0.15331349506513237, "timers": {"connectors": {"add_one_ts_to_episodes_and_truncate": 0.008945379740630446, "add_observations_from_episodes_to_batch": 0.0008550126351060139, "add_columns_from_episodes_to_train_batch": 0.0411633585097719, "add_time_dim_to_batch_and_zero_pad": 0.08980329173878367, "add_states_from_episodes_to_batch": 0.0035982319615564117, "batch_individual_items": 0.008749506775448232, "numpy_to_tensor": 6.295360913721833e-05}}}, "learner_connector_sum_episodes_length_out": 5250.0}, "learners": {"intrinsic_reward_module": {"weights_seq_no": 8.0, "num_module_steps_trained_lifetime": 47880, "gradients_default_optimizer_global_norm": 0.0, "module_train_batch_size_mean": 998.4230504637324, "diff_num_grad_updates_vs_sampler_policy": 1.0, "num_trainable_parameters": 8266, "default_optimizer_learning_rate": 0.0002715581955, "total_loss": 0.0, "num_module_steps_trained": 5985, "curr_entropy_coeff": 0.0015431216992, "num_module_steps_trained_lifetime_throughput": 756.1333493602996}, "differentiable_learners": {"intrinsic_attention_ppo_learner": {"intrinsic_reward_module": {"total_loss": 0.0, "num_module_steps_trained": 35910, "diff_num_grad_updates_vs_sampler_policy": 41.0, "weights_seq_no": 48.0, "num_module_steps_trained_lifetime": 287280, "module_train_batch_size_mean": 997.5758696422192}, "default_policy": {"vf_explained_var": 0.0020131468772888184, "total_loss": 0.2492530643939972, "vf_loss": 0.32138127088546753, "vf_loss_unclipped": 47.52560806274414, "weights_seq_no": 48.0, "num_module_steps_trained_lifetime": 287280, "module_train_batch_size_mean": 997.5758696422192, "entropy": 0.6915493011474609, "mean_kl_loss": 2.043277163465973e-06, "use_intrinsic_rewards": 1.0, "policy_loss": -5.2508170483633876e-05, "num_module_steps_trained": 35910, "diff_num_grad_updates_vs_sampler_policy": 41.0}, "__all_modules__": {"num_env_steps_trained_lifetime": 1728000, "num_module_steps_trained_lifetime": 574560, "num_module_steps_trained": 71820, "num_env_steps_trained": 216000, "num_env_steps_trained_lifetime_throughput": 56766.675321418305}}}, "default_policy": {"curr_kl_coeff": 0.0006311872275546193, "num_module_steps_trained_lifetime": 47880, "module_train_batch_size_mean": 998.4230504637324, "entropy": 0.6915441155433655, "num_trainable_parameters": 16595, "mean_kl_loss": 2.2496590190712595e-06, "use_intrinsic_rewards": 0.0, "policy_loss": -5.505482477019541e-05, "num_module_steps_trained": 5985, "diff_num_grad_updates_vs_sampler_policy": 1.0, "vf_explained_var": -0.0004239082336425781, "total_loss": 0.24857668578624725, "vf_loss": 0.3205167353153229, "curr_entropy_coeff": 0.0015431216992, "vf_loss_unclipped": 47.86886215209961, "weights_seq_no": 8.0, "num_module_steps_trained_lifetime_throughput": 756.1232850948646}, "__all_modules__": {"num_module_steps_trained": 11970, "num_non_trainable_parameters": 0, "num_env_steps_trained": 36000, "num_env_steps_trained_lifetime": 288000, "num_module_steps_trained_lifetime": 95760, "num_trainable_parameters": 24861, "num_env_steps_trained_lifetime_throughput": 4552.869310280893, "num_module_steps_trained_throughput": 26916731.635565113, "num_module_steps_trained_lifetime_throughput": 13068834.106530614}, "IntrinsicAttentionMask": [[[0.16494084894657135, 0.16605599224567413, 0.16602616012096405, 0.16768912971019745, 0.1676589995622635, 0.16762888431549072], [0.16415464878082275, 0.16577495634555817, 0.1657315492630005, 0.1681569516658783, 0.16811291873455048, 0.16806890070438385], [0.16417557001113892, 0.16578246653079987, 0.16573941707611084, 0.16814447939395905, 0.16810081899166107, 0.1680571734905243], [0.16301697492599487, 0.16536518931388855, 0.16530214250087738, 0.16883628070354462, 0.1687719076871872, 0.16870756447315216], [0.16303779184818268, 0.16537271440029144, 0.16531002521514893, 0.16882379353046417, 0.1687598079442978, 0.1686958372592926], [0.16305863857269287, 0.16538026928901672, 0.16531793773174286, 0.16881133615970612, 0.16874772310256958, 0.16868412494659424]], [[0.16872720420360565, 0.16866621375083923, 0.1651969850063324, 0.16513727605342865, 0.16725437343120575, 0.16501790285110474], [0.168714702129364, 0.16865408420562744, 0.1652059257030487, 0.1651465743780136, 0.1672508716583252, 0.1650279015302658], [0.16799552738666534, 0.16795632243156433, 0.16571840643882751, 0.1656797230243683, 0.16704756021499634, 0.1656024158000946], [0.1679830402135849, 0.16794420778751373, 0.16572733223438263, 0.16568902134895325, 0.1670440286397934, 0.16561242938041687], [0.16842369735240936, 0.1683717519044876, 0.1654132455587387, 0.16536223888397217, 0.16716885566711426, 0.16526027023792267], [0.16795803606510162, 0.16791994869709015, 0.16574515402317047, 0.1657075583934784, 0.16703692078590393, 0.165632426738739]], [[0.16514094173908234, 0.16625744104385376, 0.16562403738498688, 0.16728298366069794, 0.1678624004125595, 0.16783224046230316], [0.16444501280784607, 0.1660681962966919, 0.16514672338962555, 0.1675635576248169, 0.1684102863073349, 0.1683661937713623], [0.16483905911445618, 0.16617554426193237, 0.1654171198606491, 0.16740474104881287, 0.16809988021850586, 0.168063685297966], [0.16381123661994934, 0.16589446365833282, 0.1647111177444458, 0.1678188145160675, 0.16891063749790192, 0.1688537299633026], [0.16345544159412384, 0.16579633951187134, 0.16446615755558014, 0.167961984872818, 0.1691921055316925, 0.16912797093391418], [0.16347390413284302, 0.16580143570899963, 0.16447888314723969, 0.16795454919338226, 0.16917747259140015, 0.16911372542381287]], [[0.1681102216243744, 0.16913969814777374, 0.16502073407173157, 0.16496840119361877, 0.1678970754146576, 0.16486378014087677], [0.1683017909526825, 0.16947002708911896, 0.16480161249637604, 0.1647423952817917, 0.1680600345134735, 0.16462402045726776], [0.16752751171588898, 0.16813799738883972, 0.1656862497329712, 0.16565494239330292, 0.16740091145038605, 0.16559234261512756], [0.1675175428390503, 0.16812090575695038, 0.16569764912128448, 0.16566669940948486, 0.16739241778850555, 0.16560481488704681], [0.16807040572166443, 0.16907109320163727, 0.16506627202033997, 0.16501536965370178, 0.16786319017410278, 0.164913609623909], [0.16749757528305054, 0.1680866777896881, 0.1657203733921051, 0.16569015383720398, 0.16737540066242218, 0.16562971472740173]], [[0.16524165868759155, 0.16575480997562408, 0.16632895171642303, 0.16738499701023102, 0.16796477138996124, 0.16732487082481384], [0.16494235396385193, 0.1655626744031906, 0.16625718772411346, 0.16753597557544708, 0.16823875904083252, 0.16746312379837036], [0.1646089106798172, 0.1653483659029007, 0.16617688536643982, 0.16770417988300323, 0.16854451596736908, 0.16761711239814758], [0.16399957239627838, 0.16495604813098907, 0.16602924466133118, 0.16801175475120544, 0.16910482943058014, 0.16789858043193817], [0.16366717219352722, 0.1647416651248932, 0.16594818234443665, 0.16817957162857056, 0.16941127181053162, 0.1680520921945572], [0.16403412818908691, 0.16497831046581268, 0.1660376489162445, 0.16799430549144745, 0.16907300055027008, 0.16788260638713837]], [[0.168930783867836, 0.1688697189092636, 0.16418986022472382, 0.16533653438091278, 0.16745616495609283, 0.16521701216697693], [0.16891701519489288, 0.16885632276535034, 0.16420482099056244, 0.16534461081027985, 0.1674514263868332, 0.1652258038520813], [0.16784881055355072, 0.1678171008825302, 0.16537003219127655, 0.16597266495227814, 0.16708141565322876, 0.16590993106365204], [0.1681131273508072, 0.16807426512241364, 0.16508112847805023, 0.16581733524799347, 0.1671733856201172, 0.16574068367481232], [0.1685972958803177, 0.16854530572891235, 0.1645529419183731, 0.1655326932668686, 0.16734115779399872, 0.16543062031269073], [0.16808566451072693, 0.16804754734039307, 0.16511113941669464, 0.1658334881067276, 0.16716384887695312, 0.16575828194618225]]]}, "num_training_step_calls_per_iteration": 1, "evaluation": {"env_runners": {"episode_len_min": 20, "env_to_module_connector": {"timers": {"connectors": {"numpy_to_tensor": 1.2659063976284167e-05, "add_states_from_episodes_to_batch": 2.777121629949205e-06, "batch_individual_items": 1.2586855200437011e-05, "add_time_dim_to_batch_and_zero_pad": 7.21885595761285e-06, "add_observations_from_episodes_to_batch": 2.93293265178401e-06}}, "connector_pipeline_timer": 6.05050079504521e-05}, "module_to_env_connector": {"timers": {"connectors": {"tensor_to_numpy": 1.558229526310267e-05, "un_batch_to_individual_items": 6.671662751434639e-06, "normalize_and_clip_actions": 8.09727174823641e-06, "get_actions": 3.870861561316979e-05, "remove_single_ts_time_rank_from_batch": 1.2136303048992426e-05, "listify_data_for_vector_env": 1.1031305352472469e-05}}, "connector_pipeline_timer": 0.00011851585163844848}, "num_env_steps_sampled": 400, "episode_len_max": 20, "num_agent_steps_sampled": {"default_agent": 400}, "weights_seq_no": 8.0, "num_env_steps_sampled_lifetime": 40400, "episode_duration_sec_mean": 0.005264850489329547, "episode_return_mean": -0.9, "env_reset_timer": 0.0001574547572205645, "module_episode_returns_mean": {"default_policy": -0.9}, "rlmodule_inference_timer": 3.276443962905015e-05, "episode_return_max": 15.5, "env_to_module_sum_episodes_length_in": 10.3682383945743, "num_module_steps_sampled": {"default_policy": 400}, "agent_episode_returns_mean": {"default_agent": -0.9}, "num_agent_steps_sampled_lifetime": {"default_agent": 3200}, "num_module_steps_sampled_lifetime": {"default_policy": 3200}, "env_to_module_sum_episodes_length_out": 10.3682383945743, "num_episodes": 20, "num_episodes_lifetime": 160, "episode_return_min": -13.5, "sample": 0.13539127679013147, "env_step_timer": 1.4660101594203597e-05, "episode_len_mean": 20.0, "time_between_sampling": 9.638309569368001}, "num_healthy_workers": 1, "actor_manager_num_outstanding_async_reqs": 0, "num_remote_worker_restarts": 0}, "num_env_steps_sampled_lifetime": -3695000.0, "fault_tolerance": {"num_healthy_workers": 0, "num_remote_worker_restarts": 0}, "env_runner_group": {"actor_manager_num_outstanding_async_reqs": 0}, "done": false, "training_iteration": 8, "trial_id": "b17e2_00000", "date": "2025-08-11_18-44-27", "timestamp": 1754930667, "time_this_iter_s": 9.7815101146698, "time_total_s": 77.47765612602234, "pid": 11680, "hostname": "Mac", "node_ip": "127.0.0.1", "config": {"exploration_config": {}, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 2, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "env": "Umbrella", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": false, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 0, "create_local_env_runner": true, "num_envs_per_env_runner": 1, "gym_env_vectorize_mode": "SYNC", "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "episodes_to_numpy": true, "max_requests_in_flight_per_env_runner": 1, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "merge_env_runner_states": "training_only", "broadcast_env_runner_states": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "complete_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "sampler_perf_stats_ema_coef": null, "_is_online": true, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": "auto", "num_aggregator_actors_per_learner": 0, "max_requests_in_flight_per_aggregator_actor": 3, "local_gpu_idx": 0, "max_requests_in_flight_per_learner": 3, "gamma": 1, "lr": 0.0002715581955, "grad_clip": 0.5, "grad_clip_by": "global_norm", "_train_batch_size_per_learner": 5000, "train_batch_size": 4000, "num_epochs": 1, "minibatch_size": 1000, "shuffle_batch_per_epoch": true, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "log_std_clip_param": 20.0, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "_disable_preprocessor_api": false, "_disable_action_flattening": false}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {"intrinsic_reward_coeff": 0.2795015916508}, "optimizer": {}, "_learner_class": "<class 'source.intrinsic_attention_ppo.learners.IntrinsicAttentionMetaLearner.IntrinsicAttentionMetaLearner'>", "callbacks_on_algorithm_init": null, "callbacks_on_env_runners_recreated": null, "callbacks_on_offline_eval_runners_recreated": null, "callbacks_on_checkpoint_loaded": null, "callbacks_on_environment_created": null, "callbacks_on_episode_created": null, "callbacks_on_episode_start": null, "callbacks_on_episode_step": null, "callbacks_on_episode_end": null, "callbacks_on_evaluate_start": null, "callbacks_on_evaluate_end": null, "callbacks_on_evaluate_offline_start": null, "callbacks_on_evaluate_offline_end": null, "callbacks_on_sample_end": null, "callbacks_on_train_result": null, "explore": true, "enable_rl_module_and_learner": true, "enable_env_runner_and_connector_v2": true, "_prior_exploration_config": {"type": "StochasticSampling"}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x13c0118a0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "offline_data_class": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_read_batch_size": null, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "materialize_data": false, "materialize_mapped_data": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "ignore_final_observation": false, "prelearner_class": null, "prelearner_buffer_class": null, "prelearner_buffer_kwargs": {}, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_remaining_data": false, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": 1, "evaluation_duration": 20, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_auto_duration_min_env_steps_per_sample": 100, "evaluation_auto_duration_max_env_steps_per_sample": 2000, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 1, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "offline_evaluation_interval": null, "num_offline_eval_runners": 0, "offline_loss_for_module_fn": null, "offline_evaluation_duration": 1, "offline_evaluation_parallel_to_training": false, "offline_evaluation_timeout_s": 120.0, "num_cpus_per_offline_eval_runner": 1, "num_gpus_per_offline_eval_runner": 0, "custom_resources_per_offline_eval_runner": {}, "restart_failed_offline_eval_runners": true, "ignore_offline_eval_runner_failures": false, "max_num_offline_eval_runner_restarts": 1000, "offline_eval_runner_restore_timeout_s": 1800.0, "max_requests_in_flight_per_offline_eval_runner": 1, "validate_offline_eval_runners_after_construction": true, "offline_eval_runner_health_probe_timeout_s": 30.0, "offline_eval_rl_module_inference_only": false, "broadcast_offline_eval_runner_states": false, "offline_eval_batch_size_per_runner": 256, "dataset_num_iters_per_eval_runner": 1, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "log_gradients": false, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 9, "restart_failed_env_runners": true, "ignore_env_runner_failures": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30.0, "env_runner_restore_timeout_s": 1800.0, "_model_config": {}, "_rl_module_spec": "MultiRLModuleSpec(multi_rl_module_class=<class 'ray.rllib.core.rl_module.multi_rl_module.MultiRLModule'>, observation_space=None, action_space=None, inference_only=False, model_config=None, rl_module_specs={'default_policy': RLModuleSpec(module_class=<class 'source.intrinsic_attention_ppo.rl_modules.DifferentiablePPOModule.DifferentiablePPOModule'>, observation_space=None, action_space=None, inference_only=False, learner_only=False, model_config={'vf_share_layers': True, 'embedding_dim': 62, 'max_seq_len': 6, 'policy_head_hidden_sizes': [32], 'value_head_hidden_sizes': [101], 'embedding_hidden_sizes': [121]}, catalog_class=None, load_state_path=None, model_config_dict=None), 'intrinsic_reward_module': RLModuleSpec(module_class=<class 'source.intrinsic_attention_ppo.rl_modules.IntrinsicAttentionModule.IntrinsicAttentionModule'>, observation_space=None, action_space=None, inference_only=False, learner_only=True, model_config={'intrinsic_reward_network': {'encoder_hidden_sizes': [], 'encoding_dim': 1, 'num_heads': 1, 'head_hidden_sizes': None, 'layers': [{'type': 'attention'}]}, 'extrinsic_value_hidden_layers': [127, 60], 'vf_share_layers': True, 'max_seq_len': 6}, catalog_class=None, load_state_path=None, model_config_dict=None)}, load_state_path=None, modules_to_load=None, module_specs={'default_policy': RLModuleSpec(module_class=<class 'source.intrinsic_attention_ppo.rl_modules.DifferentiablePPOModule.DifferentiablePPOModule'>, observation_space=None, action_space=None, inference_only=False, learner_only=False, model_config={'vf_share_layers': True, 'embedding_dim': 62, 'max_seq_len': 6, 'policy_head_hidden_sizes': [32], 'value_head_hidden_sizes': [101], 'embedding_hidden_sizes': [121]}, catalog_class=None, load_state_path=None, model_config_dict=None), 'intrinsic_reward_module': RLModuleSpec(module_class=<class 'source.intrinsic_attention_ppo.rl_modules.IntrinsicAttentionModule.IntrinsicAttentionModule'>, observation_space=None, action_space=None, inference_only=False, learner_only=True, model_config={'intrinsic_reward_network': {'encoder_hidden_sizes': [], 'encoding_dim': 1, 'num_heads': 1, 'head_hidden_sizes': None, 'layers': [{'type': 'attention'}]}, 'extrinsic_value_hidden_layers': [127, 60], 'vf_share_layers': True, 'max_seq_len': 6}, catalog_class=None, load_state_path=None, model_config_dict=None)})", "algorithm_config_overrides_per_module": {"intrinsic_reward_module": {"lr": 0.0002715581955}}, "_per_module_overrides": {}, "_validate_config": true, "_use_msgpack_checkpoints": false, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "env_task_fn": -1, "enable_connectors": -1, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.161583927863, "kl_target": 0.0201019014258, "vf_loss_coeff": 0.7790510010087, "entropy_coeff": 0.0015431216992, "clip_param": 0.2459212356676, "vf_clip_param": 0.3769744131561, "entropy_coeff_schedule": null, "lr_schedule": null, "sgd_minibatch_size": -1, "vf_share_layers": -1, "differentiable_learner_configs": ["DifferentiableLearnerConfig(learner_class=<class 'source.intrinsic_attention_ppo.learners.IntrinsicAttentionPPOLearner.IntrinsicAttentionPPOLearner'>, learner_connector=None, add_default_connectors_to_learner_pipeline=True, is_multi_agent=False, policies_to_update=['default_policy'], lr=0.0060984166342, num_total_minibatches=0, num_epochs=1, minibatch_size=1000, shuffle_batch_per_epoch=True)"], "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9485408017724, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.callbacks.callbacks.RLlibCallback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 77.47765612602234, "iterations_since_restore": 8, "perf": {"cpu_util_percent": 41.40714285714286, "ram_util_percent": 79.63571428571427}}
{"timers": {"training_iteration": 9.608561666946269, "restore_env_runners": 2.0353960643282708e-05, "training_step": 9.608388857065872, "env_runner_sampling_timer": 1.7450322909552707, "learner_update_timer": 7.67263611354846, "synch_weights": 0.0008009978741474156, "restore_eval_env_runners": 8.925845722067784e-06, "evaluation_iteration": 0.1419705622268341, "synch_eval_env_connectors": 0.00013710926672109693, "synch_env_connectors": 4.9535509146038565e-06}, "env_runners": {"module_to_env_connector": {"timers": {"connectors": {"listify_data_for_vector_env": 1.2833633293971382e-05, "remove_single_ts_time_rank_from_batch": 1.4055623609899512e-05, "tensor_to_numpy": 1.8945406940211643e-05, "un_batch_to_individual_items": 7.986998868795827e-06, "normalize_and_clip_actions": 9.67891290349809e-06, "get_actions": 5.3836260787768914e-05}}, "connector_pipeline_timer": 0.00014870401135549802}, "env_to_module_sum_episodes_length_out": 10.36823839457432, "rlmodule_inference_timer": 4.1644978191855095e-05, "env_to_module_connector": {"timers": {"connectors": {"add_observations_from_episodes_to_batch": 3.4152909387412535e-06, "add_time_dim_to_batch_and_zero_pad": 8.619477776566724e-06, "numpy_to_tensor": 1.642915574128451e-05, "batch_individual_items": 1.511453889875391e-05, "add_states_from_episodes_to_batch": 3.130397606975312e-06}}, "connector_pipeline_timer": 7.209115267018224e-05}, "episode_return_max": 14.5, "num_env_steps_sampled": 5000.0, "num_episodes": 250.0, "episode_len_max": 20, "sample": 0.006860250744764024, "weights_seq_no": 8.0, "num_episodes_lifetime": -215625.0, "env_to_module_sum_episodes_length_in": 10.36823839457432, "num_agent_steps_sampled": {"default_agent": 5000.0}, "num_env_steps_sampled_lifetime": -4312500.0, "episode_duration_sec_mean": 0.006625411495566369, "episode_return_mean": 6.74, "num_module_steps_sampled": {"default_policy": 5000.0}, "env_reset_timer": 5.7193780401923015e-05, "num_module_steps_sampled_lifetime": {"default_policy": -4312500.0}, "agent_episode_returns_mean": {"default_agent": 6.74}, "env_step_timer": 1.814316094253071e-05, "episode_return_min": -5.5, "episode_len_min": 20, "episode_len_mean": 20.0, "num_agent_steps_sampled_lifetime": {"default_agent": -4312500.0}, "module_episode_returns_mean": {"default_policy": 6.74}, "time_between_sampling": 0.03368437424764072, "num_env_steps_sampled_lifetime_throughput": 2762.309538744715}, "__all_modules__": {"learner_connector_sum_episodes_length_in": 5000.0, "learner_connector": {"connector_pipeline_timer": 0.15342946761446047, "timers": {"connectors": {"add_one_ts_to_episodes_and_truncate": 0.008956749693477909, "add_observations_from_episodes_to_batch": 0.0008558045985160024, "add_columns_from_episodes_to_train_batch": 0.04121684034403033, "add_time_dim_to_batch_and_zero_pad": 0.08986059549155426, "add_states_from_episodes_to_batch": 0.0036017767217298158, "batch_individual_items": 0.008738782956989894, "numpy_to_tensor": 6.311740271873408e-05}}}, "learner_connector_sum_episodes_length_out": 5250.0}, "learners": {"intrinsic_reward_module": {"weights_seq_no": 9.0, "num_module_steps_trained_lifetime": 53865, "gradients_default_optimizer_global_norm": 0.0, "module_train_batch_size_mean": 998.3685925840979, "diff_num_grad_updates_vs_sampler_policy": 1.0, "num_trainable_parameters": 8266, "default_optimizer_learning_rate": 0.0002715581955, "total_loss": 0.0, "num_module_steps_trained": 5985, "curr_entropy_coeff": 0.0015431216992, "num_module_steps_trained_lifetime_throughput": 753.5728597894043}, "differentiable_learners": {"intrinsic_attention_ppo_learner": {"intrinsic_reward_module": {"total_loss": 0.0, "num_module_steps_trained": 35910, "diff_num_grad_updates_vs_sampler_policy": 46.0, "weights_seq_no": 54.0, "num_module_steps_trained_lifetime": 323190, "module_train_batch_size_mean": 997.5505482791133}, "default_policy": {"vf_explained_var": 0.0020359158515930176, "total_loss": 0.2489146590232849, "vf_loss": 0.3212535083293915, "vf_loss_unclipped": 49.543331146240234, "weights_seq_no": 54.0, "num_module_steps_trained_lifetime": 323190, "module_train_batch_size_mean": 997.5505482791133, "entropy": 0.6913349628448486, "mean_kl_loss": 1.1196700143045746e-05, "use_intrinsic_rewards": 1.0, "policy_loss": -0.00029323925264179707, "num_module_steps_trained": 35910, "diff_num_grad_updates_vs_sampler_policy": 46.0}, "__all_modules__": {"num_env_steps_trained_lifetime": 1944000, "num_module_steps_trained_lifetime": 646380, "num_module_steps_trained": 71820, "num_env_steps_trained": 216000, "num_env_steps_trained_lifetime_throughput": 55799.196526356616}}}, "default_policy": {"curr_kl_coeff": 0.00031559361377730966, "num_module_steps_trained_lifetime": 53865, "module_train_batch_size_mean": 998.3685925840979, "entropy": 0.6913163065910339, "num_trainable_parameters": 16595, "mean_kl_loss": 1.2721679922833573e-05, "use_intrinsic_rewards": 0.0, "policy_loss": -0.0003122835769318044, "num_module_steps_trained": 5985, "diff_num_grad_updates_vs_sampler_policy": 1.0, "vf_explained_var": -4.8279762268066406e-05, "total_loss": 0.24831536412239075, "vf_loss": 0.32051098346710205, "curr_entropy_coeff": 0.0015431216992, "vf_loss_unclipped": 49.91435623168945, "weights_seq_no": 9.0, "num_module_steps_trained_lifetime_throughput": 753.563309277935}, "__all_modules__": {"num_module_steps_trained": 11970, "num_non_trainable_parameters": 0, "num_env_steps_trained": 36000, "num_env_steps_trained_lifetime": 324000, "num_module_steps_trained_lifetime": 107730, "num_trainable_parameters": 24861, "num_env_steps_trained_lifetime_throughput": 4537.29298038293, "num_module_steps_trained_throughput": 26193765.525023926, "num_module_steps_trained_lifetime_throughput": 13047160.801849622}, "IntrinsicAttentionMask": [[[0.16514091193675995, 0.16625741124153137, 0.1656240075826645, 0.16789253056049347, 0.16725289821624756, 0.16783221065998077], [0.16444498300552368, 0.1660681664943695, 0.16514669358730316, 0.1684543639421463, 0.16751964390277863, 0.16836616396903992], [0.1648390144109726, 0.16617551445960999, 0.16541709005832672, 0.16813603043556213, 0.16736866533756256, 0.16806364059448242], [0.1634368747472763, 0.16579115390777588, 0.16445335745811462, 0.16927117109298706, 0.1679053008556366, 0.16914212703704834], [0.16382968425750732, 0.16589951515197754, 0.16472379863262177, 0.16895250976085663, 0.1677551567554474, 0.1688394397497177], [0.16347382962703705, 0.16580137610435486, 0.1644788235425949, 0.16924117505550385, 0.16789117455482483, 0.1691136360168457]], [[0.16762566566467285, 0.16708041727542877, 0.1656143069267273, 0.1661038100719452, 0.16752289235591888, 0.1660528928041458], [0.16733413934707642, 0.16695500910282135, 0.16593366861343384, 0.16627497971057892, 0.1672627031803131, 0.16623948514461517], [0.16654637455940247, 0.16661451756954193, 0.16679902374744415, 0.16673721373081207, 0.16655920445919037, 0.16674363613128662], [0.1668100357055664, 0.16672874987125397, 0.1665090173482895, 0.16658256947994232, 0.16679471731185913, 0.16657492518424988], [0.1675707846879959, 0.1670568436384201, 0.16567441821098328, 0.16613607108592987, 0.1674739122390747, 0.1660880297422409], [0.16678261756896973, 0.16671687364578247, 0.16653913259506226, 0.1665986329317093, 0.16677023470401764, 0.16659244894981384]], [[0.16691824793815613, 0.16562560200691223, 0.16605734825134277, 0.16685053706169128, 0.1672854721546173, 0.16726285219192505], [0.16668392717838287, 0.16659536957740784, 0.1666250228881836, 0.1666792929172516, 0.16670896112918854, 0.16670742630958557], [0.1667625606060028, 0.1662702113389969, 0.16643491387367249, 0.16673682630062103, 0.16690200567245483, 0.16689342260360718], [0.16690604388713837, 0.16567611694335938, 0.16608697175979614, 0.16684162616729736, 0.16725537180900574, 0.16723385453224182], [0.1669841706752777, 0.16535213589668274, 0.16589686274528503, 0.16689859330654144, 0.16744841635227203, 0.16741980612277985], [0.16698011755943298, 0.1653689593076706, 0.16590674221515656, 0.16689564287662506, 0.16743838787078857, 0.16741015017032623]], [[0.16691794991493225, 0.16726835072040558, 0.1662241518497467, 0.16620604693889618, 0.16721367835998535, 0.16616983711719513], [0.16701500117778778, 0.16750158369541168, 0.1660526990890503, 0.16602760553359985, 0.16742564737796783, 0.16597741842269897], [0.16672472655773163, 0.1668054163455963, 0.16656461358070374, 0.16656041145324707, 0.1667928397655487, 0.16655205190181732], [0.16671967506408691, 0.1667933166027069, 0.16657350957393646, 0.16656969487667084, 0.16678182780742645, 0.1665620505809784], [0.16699989140033722, 0.1674652248620987, 0.16607943177223206, 0.16605542600154877, 0.16739261150360107, 0.1660074144601822], [0.1667095273733139, 0.1667690873146057, 0.16659130156040192, 0.1665882021188736, 0.16675980389118195, 0.16658201813697815]], [[0.16494083404541016, 0.16605597734451294, 0.16602614521980286, 0.16768911480903625, 0.1676589846611023, 0.16762886941432953], [0.16415464878082275, 0.16577497124671936, 0.16573156416416168, 0.1681569516658783, 0.16811291873455048, 0.16806890070438385], [0.16417557001113892, 0.16578246653079987, 0.16573941707611084, 0.16814447939395905, 0.16810081899166107, 0.1680571734905243], [0.16301696002483368, 0.16536518931388855, 0.16530215740203857, 0.16883626580238342, 0.168771892786026, 0.16870754957199097], [0.16303779184818268, 0.16537272930145264, 0.16531004011631012, 0.16882379353046417, 0.1687598079442978, 0.1686958372592926], [0.16305863857269287, 0.16538026928901672, 0.16531795263290405, 0.16881133615970612, 0.1687477082014084, 0.16868412494659424]], [[0.16757285594940186, 0.16859903931617737, 0.16449324786663055, 0.16550056636333466, 0.16843868792057037, 0.1653956174850464], [0.1676926165819168, 0.16885662078857422, 0.16420511901378632, 0.16534492373466492, 0.16867466270923615, 0.16522611677646637], [0.16720785200595856, 0.16781719028949738, 0.1653701215982437, 0.1659727543592453, 0.16772207617759705, 0.1659100353717804], [0.16732817888259888, 0.16807439923286438, 0.16508126258850098, 0.16581745445728302, 0.1679578721523285, 0.16574081778526306], [0.1676739603281021, 0.1688164621591568, 0.16425001621246338, 0.1653691828250885, 0.16863787174224854, 0.16525253653526306], [0.16731570661067963, 0.1680476814508438, 0.16511127352714539, 0.16583362221717834, 0.167933389544487, 0.165758416056633]]]}, "num_training_step_calls_per_iteration": 1, "evaluation": {"env_runners": {"episode_len_min": 20, "env_to_module_connector": {"timers": {"connectors": {"numpy_to_tensor": 1.1759090604466096e-05, "add_states_from_episodes_to_batch": 2.6939376308257217e-06, "batch_individual_items": 1.2249901447508032e-05, "add_time_dim_to_batch_and_zero_pad": 6.986750954734263e-06, "add_observations_from_episodes_to_batch": 2.80287018021303e-06}}, "connector_pipeline_timer": 5.814172881943921e-05}, "module_to_env_connector": {"timers": {"connectors": {"tensor_to_numpy": 1.480264915019661e-05, "un_batch_to_individual_items": 6.488425712513241e-06, "normalize_and_clip_actions": 7.797189330338616e-06, "get_actions": 3.5774089820645266e-05, "remove_single_ts_time_rank_from_batch": 1.1798931922358352e-05, "listify_data_for_vector_env": 1.0431233531423729e-05}}, "connector_pipeline_timer": 0.00011256602004485039}, "num_env_steps_sampled": 400, "episode_len_max": 20, "num_agent_steps_sampled": {"default_agent": 400}, "weights_seq_no": 9.0, "num_env_steps_sampled_lifetime": 45400, "episode_duration_sec_mean": 0.0052520884200930595, "episode_return_mean": -0.7, "env_reset_timer": 0.0001567468798098445, "module_episode_returns_mean": {"default_policy": -0.7}, "rlmodule_inference_timer": 3.0558807139152025e-05, "episode_return_max": 15.5, "env_to_module_sum_episodes_length_in": 10.368238394574323, "num_module_steps_sampled": {"default_policy": 400}, "agent_episode_returns_mean": {"default_agent": -0.7}, "num_agent_steps_sampled_lifetime": {"default_agent": 3600}, "num_module_steps_sampled_lifetime": {"default_policy": 3600}, "env_to_module_sum_episodes_length_out": 10.368238394574323, "num_episodes": 20, "num_episodes_lifetime": 180, "episode_return_min": -13.5, "sample": 0.135155663601478, "env_step_timer": 1.367097135863401e-05, "episode_len_mean": 20.0, "time_between_sampling": 9.64220755200433}, "num_healthy_workers": 1, "actor_manager_num_outstanding_async_reqs": 0, "num_remote_worker_restarts": 0}, "num_env_steps_sampled_lifetime": -4312500.0, "fault_tolerance": {"num_healthy_workers": 0, "num_remote_worker_restarts": 0}, "env_runner_group": {"actor_manager_num_outstanding_async_reqs": 0}, "done": false, "training_iteration": 9, "trial_id": "b17e2_00000", "date": "2025-08-11_18-44-37", "timestamp": 1754930677, "time_this_iter_s": 10.116941928863525, "time_total_s": 87.59459805488586, "pid": 11680, "hostname": "Mac", "node_ip": "127.0.0.1", "config": {"exploration_config": {}, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 2, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "env": "Umbrella", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": false, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 0, "create_local_env_runner": true, "num_envs_per_env_runner": 1, "gym_env_vectorize_mode": "SYNC", "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "episodes_to_numpy": true, "max_requests_in_flight_per_env_runner": 1, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "merge_env_runner_states": "training_only", "broadcast_env_runner_states": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "complete_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "sampler_perf_stats_ema_coef": null, "_is_online": true, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": "auto", "num_aggregator_actors_per_learner": 0, "max_requests_in_flight_per_aggregator_actor": 3, "local_gpu_idx": 0, "max_requests_in_flight_per_learner": 3, "gamma": 1, "lr": 0.0002715581955, "grad_clip": 0.5, "grad_clip_by": "global_norm", "_train_batch_size_per_learner": 5000, "train_batch_size": 4000, "num_epochs": 1, "minibatch_size": 1000, "shuffle_batch_per_epoch": true, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "log_std_clip_param": 20.0, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "_disable_preprocessor_api": false, "_disable_action_flattening": false}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {"intrinsic_reward_coeff": 0.2795015916508}, "optimizer": {}, "_learner_class": "<class 'source.intrinsic_attention_ppo.learners.IntrinsicAttentionMetaLearner.IntrinsicAttentionMetaLearner'>", "callbacks_on_algorithm_init": null, "callbacks_on_env_runners_recreated": null, "callbacks_on_offline_eval_runners_recreated": null, "callbacks_on_checkpoint_loaded": null, "callbacks_on_environment_created": null, "callbacks_on_episode_created": null, "callbacks_on_episode_start": null, "callbacks_on_episode_step": null, "callbacks_on_episode_end": null, "callbacks_on_evaluate_start": null, "callbacks_on_evaluate_end": null, "callbacks_on_evaluate_offline_start": null, "callbacks_on_evaluate_offline_end": null, "callbacks_on_sample_end": null, "callbacks_on_train_result": null, "explore": true, "enable_rl_module_and_learner": true, "enable_env_runner_and_connector_v2": true, "_prior_exploration_config": {"type": "StochasticSampling"}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x13c0118a0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "offline_data_class": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_read_batch_size": null, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "materialize_data": false, "materialize_mapped_data": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "ignore_final_observation": false, "prelearner_class": null, "prelearner_buffer_class": null, "prelearner_buffer_kwargs": {}, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_remaining_data": false, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": 1, "evaluation_duration": 20, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_auto_duration_min_env_steps_per_sample": 100, "evaluation_auto_duration_max_env_steps_per_sample": 2000, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 1, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "offline_evaluation_interval": null, "num_offline_eval_runners": 0, "offline_loss_for_module_fn": null, "offline_evaluation_duration": 1, "offline_evaluation_parallel_to_training": false, "offline_evaluation_timeout_s": 120.0, "num_cpus_per_offline_eval_runner": 1, "num_gpus_per_offline_eval_runner": 0, "custom_resources_per_offline_eval_runner": {}, "restart_failed_offline_eval_runners": true, "ignore_offline_eval_runner_failures": false, "max_num_offline_eval_runner_restarts": 1000, "offline_eval_runner_restore_timeout_s": 1800.0, "max_requests_in_flight_per_offline_eval_runner": 1, "validate_offline_eval_runners_after_construction": true, "offline_eval_runner_health_probe_timeout_s": 30.0, "offline_eval_rl_module_inference_only": false, "broadcast_offline_eval_runner_states": false, "offline_eval_batch_size_per_runner": 256, "dataset_num_iters_per_eval_runner": 1, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "log_gradients": false, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 9, "restart_failed_env_runners": true, "ignore_env_runner_failures": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30.0, "env_runner_restore_timeout_s": 1800.0, "_model_config": {}, "_rl_module_spec": "MultiRLModuleSpec(multi_rl_module_class=<class 'ray.rllib.core.rl_module.multi_rl_module.MultiRLModule'>, observation_space=None, action_space=None, inference_only=False, model_config=None, rl_module_specs={'default_policy': RLModuleSpec(module_class=<class 'source.intrinsic_attention_ppo.rl_modules.DifferentiablePPOModule.DifferentiablePPOModule'>, observation_space=None, action_space=None, inference_only=False, learner_only=False, model_config={'vf_share_layers': True, 'embedding_dim': 62, 'max_seq_len': 6, 'policy_head_hidden_sizes': [32], 'value_head_hidden_sizes': [101], 'embedding_hidden_sizes': [121]}, catalog_class=None, load_state_path=None, model_config_dict=None), 'intrinsic_reward_module': RLModuleSpec(module_class=<class 'source.intrinsic_attention_ppo.rl_modules.IntrinsicAttentionModule.IntrinsicAttentionModule'>, observation_space=None, action_space=None, inference_only=False, learner_only=True, model_config={'intrinsic_reward_network': {'encoder_hidden_sizes': [], 'encoding_dim': 1, 'num_heads': 1, 'head_hidden_sizes': None, 'layers': [{'type': 'attention'}]}, 'extrinsic_value_hidden_layers': [127, 60], 'vf_share_layers': True, 'max_seq_len': 6}, catalog_class=None, load_state_path=None, model_config_dict=None)}, load_state_path=None, modules_to_load=None, module_specs={'default_policy': RLModuleSpec(module_class=<class 'source.intrinsic_attention_ppo.rl_modules.DifferentiablePPOModule.DifferentiablePPOModule'>, observation_space=None, action_space=None, inference_only=False, learner_only=False, model_config={'vf_share_layers': True, 'embedding_dim': 62, 'max_seq_len': 6, 'policy_head_hidden_sizes': [32], 'value_head_hidden_sizes': [101], 'embedding_hidden_sizes': [121]}, catalog_class=None, load_state_path=None, model_config_dict=None), 'intrinsic_reward_module': RLModuleSpec(module_class=<class 'source.intrinsic_attention_ppo.rl_modules.IntrinsicAttentionModule.IntrinsicAttentionModule'>, observation_space=None, action_space=None, inference_only=False, learner_only=True, model_config={'intrinsic_reward_network': {'encoder_hidden_sizes': [], 'encoding_dim': 1, 'num_heads': 1, 'head_hidden_sizes': None, 'layers': [{'type': 'attention'}]}, 'extrinsic_value_hidden_layers': [127, 60], 'vf_share_layers': True, 'max_seq_len': 6}, catalog_class=None, load_state_path=None, model_config_dict=None)})", "algorithm_config_overrides_per_module": {"intrinsic_reward_module": {"lr": 0.0002715581955}}, "_per_module_overrides": {}, "_validate_config": true, "_use_msgpack_checkpoints": false, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "env_task_fn": -1, "enable_connectors": -1, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.161583927863, "kl_target": 0.0201019014258, "vf_loss_coeff": 0.7790510010087, "entropy_coeff": 0.0015431216992, "clip_param": 0.2459212356676, "vf_clip_param": 0.3769744131561, "entropy_coeff_schedule": null, "lr_schedule": null, "sgd_minibatch_size": -1, "vf_share_layers": -1, "differentiable_learner_configs": ["DifferentiableLearnerConfig(learner_class=<class 'source.intrinsic_attention_ppo.learners.IntrinsicAttentionPPOLearner.IntrinsicAttentionPPOLearner'>, learner_connector=None, add_default_connectors_to_learner_pipeline=True, is_multi_agent=False, policies_to_update=['default_policy'], lr=0.0060984166342, num_total_minibatches=0, num_epochs=1, minibatch_size=1000, shuffle_batch_per_epoch=True)"], "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9485408017724, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.callbacks.callbacks.RLlibCallback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 87.59459805488586, "iterations_since_restore": 9, "perf": {"cpu_util_percent": 40.892857142857146, "ram_util_percent": 80.17142857142856}}
{"timers": {"training_iteration": 9.60927324193696, "restore_env_runners": 2.022292100682404e-05, "training_step": 9.609099565586133, "env_runner_sampling_timer": 1.7449404634664945, "learner_update_timer": 7.67327128324336, "synch_weights": 0.0008083320553163968, "restore_eval_env_runners": 8.931167728912182e-06, "evaluation_iteration": 0.14172432702532867, "synch_eval_env_connectors": 0.00013716234438591543, "synch_env_connectors": 4.943185668792927e-06}, "env_runners": {"module_to_env_connector": {"timers": {"connectors": {"listify_data_for_vector_env": 1.0796808031942675e-05, "remove_single_ts_time_rank_from_batch": 1.2142659962824231e-05, "tensor_to_numpy": 1.576832021174769e-05, "un_batch_to_individual_items": 6.83225722196922e-06, "normalize_and_clip_actions": 8.076346641397146e-06, "get_actions": 4.114153348917397e-05}}, "connector_pipeline_timer": 0.00012141730338100289}, "env_to_module_sum_episodes_length_out": 10.36823839457432, "rlmodule_inference_timer": 3.2703614759112406e-05, "env_to_module_connector": {"timers": {"connectors": {"add_observations_from_episodes_to_batch": 2.832182568642934e-06, "add_time_dim_to_batch_and_zero_pad": 7.043705448407631e-06, "numpy_to_tensor": 1.3085838754613938e-05, "batch_individual_items": 1.2706628599979565e-05, "add_states_from_episodes_to_batch": 2.7651038773248007e-06}}, "connector_pipeline_timer": 6.062204777207004e-05}, "episode_return_max": 14.5, "num_env_steps_sampled": 5000.0, "num_episodes": 250.0, "episode_len_max": 20, "sample": 0.005995235364508151, "weights_seq_no": 9.0, "num_episodes_lifetime": -246500.0, "env_to_module_sum_episodes_length_in": 10.36823839457432, "num_agent_steps_sampled": {"default_agent": 5000.0}, "num_env_steps_sampled_lifetime": -4930000.0, "episode_duration_sec_mean": 0.005404924664646386, "episode_return_mean": 5.380000000000001, "num_module_steps_sampled": {"default_policy": 5000.0}, "env_reset_timer": 4.82955199121999e-05, "num_module_steps_sampled_lifetime": {"default_policy": -4930000.0}, "agent_episode_returns_mean": {"default_agent": 5.380000000000001}, "env_step_timer": 1.4315894334984437e-05, "episode_return_min": -5.5, "episode_len_min": 20, "episode_len_mean": 20.0, "num_agent_steps_sampled_lifetime": {"default_agent": -4930000.0}, "module_episode_returns_mean": {"default_policy": 5.380000000000001}, "time_between_sampling": 0.033919036219782976, "num_env_steps_sampled_lifetime_throughput": 3167.7310059529805}, "__all_modules__": {"learner_connector_sum_episodes_length_in": 5000.0, "learner_connector": {"connector_pipeline_timer": 0.15347195960821836, "timers": {"connectors": {"add_one_ts_to_episodes_and_truncate": 0.008955184696667406, "add_observations_from_episodes_to_batch": 0.0008555890514442497, "add_columns_from_episodes_to_train_batch": 0.04122136694002967, "add_time_dim_to_batch_and_zero_pad": 0.0898779128671059, "add_states_from_episodes_to_batch": 0.0036124643741758575, "batch_individual_items": 0.00875063428819241, "numpy_to_tensor": 6.315747943720084e-05}}}, "learner_connector_sum_episodes_length_out": 5250.0}, "learners": {"intrinsic_reward_module": {"weights_seq_no": 10.0, "num_module_steps_trained_lifetime": 59850, "gradients_default_optimizer_global_norm": 0.0, "module_train_batch_size_mean": 998.3173215714437, "diff_num_grad_updates_vs_sampler_policy": 1.0, "num_trainable_parameters": 8266, "default_optimizer_learning_rate": 0.0002715581955, "total_loss": 0.0, "num_module_steps_trained": 5985, "curr_entropy_coeff": 0.0015431216992, "num_module_steps_trained_lifetime_throughput": 751.1284207255732}, "differentiable_learners": {"intrinsic_attention_ppo_learner": {"intrinsic_reward_module": {"total_loss": 0.0, "num_module_steps_trained": 35910, "diff_num_grad_updates_vs_sampler_policy": 51.0, "weights_seq_no": 60.0, "num_module_steps_trained_lifetime": 359100, "module_train_batch_size_mean": 997.532914147147}, "default_policy": {"vf_explained_var": 0.0019093155860900879, "total_loss": 0.24859032034873962, "vf_loss": 0.3211051821708679, "vf_loss_unclipped": 47.474853515625, "weights_seq_no": 60.0, "num_module_steps_trained_lifetime": 359100, "module_train_batch_size_mean": 997.532914147147, "entropy": 0.6907602548599243, "mean_kl_loss": 2.7232465072302148e-05, "use_intrinsic_rewards": 1.0, "policy_loss": -0.0005054805660620332, "num_module_steps_trained": 35910, "diff_num_grad_updates_vs_sampler_policy": 51.0}, "__all_modules__": {"num_env_steps_trained_lifetime": 2160000, "num_module_steps_trained_lifetime": 718200, "num_module_steps_trained": 71820, "num_env_steps_trained": 216000, "num_env_steps_trained_lifetime_throughput": 54848.21194181079}}}, "default_policy": {"curr_kl_coeff": 0.00015779680688865483, "num_module_steps_trained_lifetime": 59850, "module_train_batch_size_mean": 998.3173215714437, "entropy": 0.690736711025238, "num_trainable_parameters": 16595, "mean_kl_loss": 2.9815286325174384e-05, "use_intrinsic_rewards": 0.0, "policy_loss": -0.0005283511709421873, "num_module_steps_trained": 5985, "diff_num_grad_updates_vs_sampler_policy": 1.0, "vf_explained_var": 0.0003536343574523926, "total_loss": 0.24810074269771576, "vf_loss": 0.32051169872283936, "curr_entropy_coeff": 0.0015431216992, "vf_loss_unclipped": 47.699886322021484, "weights_seq_no": 10.0, "num_module_steps_trained_lifetime_throughput": 751.1193963642405}, "__all_modules__": {"num_module_steps_trained": 11970, "num_non_trainable_parameters": 0, "num_env_steps_trained": 36000, "num_env_steps_trained_lifetime": 360000, "num_module_steps_trained_lifetime": 119700, "num_trainable_parameters": 24861, "num_env_steps_trained_lifetime_throughput": 4522.417687795511, "num_module_steps_trained_throughput": 25492333.32008106, "num_module_steps_trained_lifetime_throughput": 13017700.043437194}, "IntrinsicAttentionMask": [[[0.16514088213443756, 0.16625738143920898, 0.1656239777803421, 0.16789250075817108, 0.16786234080791473, 0.16722282767295837], [0.1644449234008789, 0.16606812179088593, 0.16514664888381958, 0.16845431923866272, 0.16841021180152893, 0.16747574508190155], [0.1648389846086502, 0.1661754846572876, 0.16541706025600433, 0.16813600063323975, 0.1680998057126999, 0.16733258962631226], [0.16343680024147034, 0.1657910943031311, 0.16445329785346985, 0.1692710965871811, 0.16920655965805054, 0.16784121096134186], [0.1634552776813507, 0.1657961905002594, 0.1644660085439682, 0.1692560911178589, 0.16919192671775818, 0.16783452033996582], [0.16384810209274292, 0.16590452194213867, 0.16473644971847534, 0.16893742978572845, 0.16888126730918884, 0.16769221425056458]], [[0.16893506050109863, 0.16764216125011444, 0.16540051996707916, 0.16534072160720825, 0.16746041178703308, 0.1652211993932724], [0.16864179074764252, 0.16751684248447418, 0.16556376218795776, 0.1655116230249405, 0.1673586219549179, 0.16540738940238953], [0.16812863945960999, 0.16729700565338135, 0.1658497154712677, 0.16581101715564728, 0.1671799272298813, 0.16573363542556763], [0.16811488568782806, 0.16729111969470978, 0.16585740447044373, 0.16581906378269196, 0.16717512905597687, 0.1657424122095108], [0.1686004102230072, 0.16749915480613708, 0.16558681428432465, 0.16553574800491333, 0.16734424233436584, 0.16543367505073547], [0.16808733344078064, 0.16727928817272186, 0.1658727526664734, 0.16583514213562012, 0.16716550290584564, 0.16575993597507477]], [[0.16504129767417908, 0.16615712642669678, 0.1661272644996643, 0.1677912473678589, 0.16776110231876373, 0.1671219766139984], [0.16430066525936127, 0.16592244803905487, 0.1658789962530136, 0.16830654442310333, 0.16826248168945312, 0.1673288345336914], [0.16432039439678192, 0.16592872142791748, 0.16588564217090607, 0.1682928055524826, 0.16824911534786224, 0.16732332110404968], [0.16322873532772064, 0.16558001935482025, 0.1655168980360031, 0.16905559599399567, 0.16899114847183228, 0.16762752830982208], [0.16324838995933533, 0.16558635234832764, 0.16552358865737915, 0.16904187202453613, 0.1689777970314026, 0.16762210428714752], [0.16366596519947052, 0.16572009027004242, 0.16566500067710876, 0.1687496304512024, 0.16869352757930756, 0.16750580072402954]], [[0.169139102101326, 0.16784463822841644, 0.16439233720302582, 0.1655404269695282, 0.16766266524791718, 0.1654207557439804], [0.16881948709487915, 0.1676933616399765, 0.16468451917171478, 0.16568602621555328, 0.1675349622964859, 0.16558167338371277], [0.16795645654201508, 0.16728337109088898, 0.16547608375549316, 0.1660791039466858, 0.16718856990337372, 0.1660163402557373], [0.16824519634246826, 0.16742078959941864, 0.16521082818508148, 0.16594760119915009, 0.16730470955371857, 0.16587089002132416], [0.16877438127994537, 0.16767197847366333, 0.16472579538822174, 0.1657065600156784, 0.16751691699028015, 0.1656043827533722], [0.16821518540382385, 0.16740651428699493, 0.1652383804321289, 0.16596126556396484, 0.16729265451431274, 0.1658860146999359]], [[0.16504129767417908, 0.16615712642669678, 0.1661272644996643, 0.1677912473678589, 0.16776110231876373, 0.1671219766139984], [0.16430068016052246, 0.16592246294021606, 0.1658790111541748, 0.16830655932426453, 0.16826249659061432, 0.1673288345336914], [0.16432039439678192, 0.16592872142791748, 0.16588564217090607, 0.1682928055524826, 0.16824911534786224, 0.16732332110404968], [0.16322873532772064, 0.16558001935482025, 0.1655168980360031, 0.16905559599399567, 0.16899114847183228, 0.16762752830982208], [0.16324838995933533, 0.16558635234832764, 0.16552358865737915, 0.16904187202453613, 0.1689777970314026, 0.16762210428714752], [0.16366596519947052, 0.1657201051712036, 0.16566500067710876, 0.1687496304512024, 0.16869352757930756, 0.16750580072402954]], [[0.16771194338798523, 0.16768623888492584, 0.16621479392051697, 0.1656741499900818, 0.1670895367860794, 0.16562333703041077], [0.1676969826221466, 0.16767163574695587, 0.16622129082679749, 0.16568832099437714, 0.1670835018157959, 0.16563823819160461], [0.1668378710746765, 0.16683366894721985, 0.1665928214788437, 0.1665038764476776, 0.16673621535301208, 0.16649550199508667], [0.1665206104516983, 0.16652420163154602, 0.16672959923744202, 0.16680559515953064, 0.16660724580287933, 0.1668127477169037], [0.16734935343265533, 0.16733258962631226, 0.16637183725833893, 0.16601808369159698, 0.16694334149360657, 0.16598482429981232], [0.16649077832698822, 0.16649508476257324, 0.1667424589395523, 0.1668339967727661, 0.16659508645534515, 0.16684262454509735]]]}, "num_training_step_calls_per_iteration": 1, "evaluation": {"env_runners": {"episode_len_min": 20, "env_to_module_connector": {"timers": {"connectors": {"numpy_to_tensor": 1.1836641336947773e-05, "add_states_from_episodes_to_batch": 2.697006679918385e-06, "batch_individual_items": 1.2453856261061554e-05, "add_time_dim_to_batch_and_zero_pad": 7.312861202513947e-06, "add_observations_from_episodes_to_batch": 2.851337428239637e-06}}, "connector_pipeline_timer": 5.9198298386956905e-05}, "module_to_env_connector": {"timers": {"connectors": {"tensor_to_numpy": 1.4895281664740387e-05, "un_batch_to_individual_items": 6.45347817086701e-06, "normalize_and_clip_actions": 7.811546099384741e-06, "get_actions": 3.595683417258724e-05, "remove_single_ts_time_rank_from_batch": 1.1846813147996345e-05, "listify_data_for_vector_env": 1.0390175996767065e-05}}, "connector_pipeline_timer": 0.00011304345207448398}, "num_env_steps_sampled": 400, "episode_len_max": 20, "num_agent_steps_sampled": {"default_agent": 400}, "weights_seq_no": 10.0, "num_env_steps_sampled_lifetime": 50400, "episode_duration_sec_mean": 0.005233545907540247, "episode_return_mean": -0.3, "env_reset_timer": 0.00015892233124654545, "module_episode_returns_mean": {"default_policy": -0.3}, "rlmodule_inference_timer": 3.066967957148117e-05, "episode_return_max": 15.5, "env_to_module_sum_episodes_length_in": 10.368238394574323, "num_module_steps_sampled": {"default_policy": 400}, "agent_episode_returns_mean": {"default_agent": -0.3}, "num_agent_steps_sampled_lifetime": {"default_agent": 4000}, "num_module_steps_sampled_lifetime": {"default_policy": 4000}, "env_to_module_sum_episodes_length_out": 10.368238394574323, "num_episodes": 20, "num_episodes_lifetime": 200, "episode_return_min": -13.5, "sample": 0.13494777446546366, "env_step_timer": 1.3643788786190127e-05, "episode_len_mean": 20.0, "time_between_sampling": 9.6428227981545}, "num_healthy_workers": 1, "actor_manager_num_outstanding_async_reqs": 0, "num_remote_worker_restarts": 0}, "num_env_steps_sampled_lifetime": -4930000.0, "fault_tolerance": {"num_healthy_workers": 0, "num_remote_worker_restarts": 0}, "env_runner_group": {"actor_manager_num_outstanding_async_reqs": 0}, "done": false, "training_iteration": 10, "trial_id": "b17e2_00000", "date": "2025-08-11_18-44-47", "timestamp": 1754930687, "time_this_iter_s": 9.8057119846344, "time_total_s": 97.40031003952026, "pid": 11680, "hostname": "Mac", "node_ip": "127.0.0.1", "config": {"exploration_config": {}, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 2, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "env": "Umbrella", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": false, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 0, "create_local_env_runner": true, "num_envs_per_env_runner": 1, "gym_env_vectorize_mode": "SYNC", "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "episodes_to_numpy": true, "max_requests_in_flight_per_env_runner": 1, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "merge_env_runner_states": "training_only", "broadcast_env_runner_states": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "complete_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "sampler_perf_stats_ema_coef": null, "_is_online": true, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": "auto", "num_aggregator_actors_per_learner": 0, "max_requests_in_flight_per_aggregator_actor": 3, "local_gpu_idx": 0, "max_requests_in_flight_per_learner": 3, "gamma": 1, "lr": 0.0002715581955, "grad_clip": 0.5, "grad_clip_by": "global_norm", "_train_batch_size_per_learner": 5000, "train_batch_size": 4000, "num_epochs": 1, "minibatch_size": 1000, "shuffle_batch_per_epoch": true, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "log_std_clip_param": 20.0, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "_disable_preprocessor_api": false, "_disable_action_flattening": false}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {"intrinsic_reward_coeff": 0.2795015916508}, "optimizer": {}, "_learner_class": "<class 'source.intrinsic_attention_ppo.learners.IntrinsicAttentionMetaLearner.IntrinsicAttentionMetaLearner'>", "callbacks_on_algorithm_init": null, "callbacks_on_env_runners_recreated": null, "callbacks_on_offline_eval_runners_recreated": null, "callbacks_on_checkpoint_loaded": null, "callbacks_on_environment_created": null, "callbacks_on_episode_created": null, "callbacks_on_episode_start": null, "callbacks_on_episode_step": null, "callbacks_on_episode_end": null, "callbacks_on_evaluate_start": null, "callbacks_on_evaluate_end": null, "callbacks_on_evaluate_offline_start": null, "callbacks_on_evaluate_offline_end": null, "callbacks_on_sample_end": null, "callbacks_on_train_result": null, "explore": true, "enable_rl_module_and_learner": true, "enable_env_runner_and_connector_v2": true, "_prior_exploration_config": {"type": "StochasticSampling"}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x13c0118a0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "offline_data_class": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_read_batch_size": null, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "materialize_data": false, "materialize_mapped_data": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "ignore_final_observation": false, "prelearner_class": null, "prelearner_buffer_class": null, "prelearner_buffer_kwargs": {}, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_remaining_data": false, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": 1, "evaluation_duration": 20, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_auto_duration_min_env_steps_per_sample": 100, "evaluation_auto_duration_max_env_steps_per_sample": 2000, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 1, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "offline_evaluation_interval": null, "num_offline_eval_runners": 0, "offline_loss_for_module_fn": null, "offline_evaluation_duration": 1, "offline_evaluation_parallel_to_training": false, "offline_evaluation_timeout_s": 120.0, "num_cpus_per_offline_eval_runner": 1, "num_gpus_per_offline_eval_runner": 0, "custom_resources_per_offline_eval_runner": {}, "restart_failed_offline_eval_runners": true, "ignore_offline_eval_runner_failures": false, "max_num_offline_eval_runner_restarts": 1000, "offline_eval_runner_restore_timeout_s": 1800.0, "max_requests_in_flight_per_offline_eval_runner": 1, "validate_offline_eval_runners_after_construction": true, "offline_eval_runner_health_probe_timeout_s": 30.0, "offline_eval_rl_module_inference_only": false, "broadcast_offline_eval_runner_states": false, "offline_eval_batch_size_per_runner": 256, "dataset_num_iters_per_eval_runner": 1, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "log_gradients": false, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 9, "restart_failed_env_runners": true, "ignore_env_runner_failures": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30.0, "env_runner_restore_timeout_s": 1800.0, "_model_config": {}, "_rl_module_spec": "MultiRLModuleSpec(multi_rl_module_class=<class 'ray.rllib.core.rl_module.multi_rl_module.MultiRLModule'>, observation_space=None, action_space=None, inference_only=False, model_config=None, rl_module_specs={'default_policy': RLModuleSpec(module_class=<class 'source.intrinsic_attention_ppo.rl_modules.DifferentiablePPOModule.DifferentiablePPOModule'>, observation_space=None, action_space=None, inference_only=False, learner_only=False, model_config={'vf_share_layers': True, 'embedding_dim': 62, 'max_seq_len': 6, 'policy_head_hidden_sizes': [32], 'value_head_hidden_sizes': [101], 'embedding_hidden_sizes': [121]}, catalog_class=None, load_state_path=None, model_config_dict=None), 'intrinsic_reward_module': RLModuleSpec(module_class=<class 'source.intrinsic_attention_ppo.rl_modules.IntrinsicAttentionModule.IntrinsicAttentionModule'>, observation_space=None, action_space=None, inference_only=False, learner_only=True, model_config={'intrinsic_reward_network': {'encoder_hidden_sizes': [], 'encoding_dim': 1, 'num_heads': 1, 'head_hidden_sizes': None, 'layers': [{'type': 'attention'}]}, 'extrinsic_value_hidden_layers': [127, 60], 'vf_share_layers': True, 'max_seq_len': 6}, catalog_class=None, load_state_path=None, model_config_dict=None)}, load_state_path=None, modules_to_load=None, module_specs={'default_policy': RLModuleSpec(module_class=<class 'source.intrinsic_attention_ppo.rl_modules.DifferentiablePPOModule.DifferentiablePPOModule'>, observation_space=None, action_space=None, inference_only=False, learner_only=False, model_config={'vf_share_layers': True, 'embedding_dim': 62, 'max_seq_len': 6, 'policy_head_hidden_sizes': [32], 'value_head_hidden_sizes': [101], 'embedding_hidden_sizes': [121]}, catalog_class=None, load_state_path=None, model_config_dict=None), 'intrinsic_reward_module': RLModuleSpec(module_class=<class 'source.intrinsic_attention_ppo.rl_modules.IntrinsicAttentionModule.IntrinsicAttentionModule'>, observation_space=None, action_space=None, inference_only=False, learner_only=True, model_config={'intrinsic_reward_network': {'encoder_hidden_sizes': [], 'encoding_dim': 1, 'num_heads': 1, 'head_hidden_sizes': None, 'layers': [{'type': 'attention'}]}, 'extrinsic_value_hidden_layers': [127, 60], 'vf_share_layers': True, 'max_seq_len': 6}, catalog_class=None, load_state_path=None, model_config_dict=None)})", "algorithm_config_overrides_per_module": {"intrinsic_reward_module": {"lr": 0.0002715581955}}, "_per_module_overrides": {}, "_validate_config": true, "_use_msgpack_checkpoints": false, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "env_task_fn": -1, "enable_connectors": -1, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.161583927863, "kl_target": 0.0201019014258, "vf_loss_coeff": 0.7790510010087, "entropy_coeff": 0.0015431216992, "clip_param": 0.2459212356676, "vf_clip_param": 0.3769744131561, "entropy_coeff_schedule": null, "lr_schedule": null, "sgd_minibatch_size": -1, "vf_share_layers": -1, "differentiable_learner_configs": ["DifferentiableLearnerConfig(learner_class=<class 'source.intrinsic_attention_ppo.learners.IntrinsicAttentionPPOLearner.IntrinsicAttentionPPOLearner'>, learner_connector=None, add_default_connectors_to_learner_pipeline=True, is_multi_agent=False, policies_to_update=['default_policy'], lr=0.0060984166342, num_total_minibatches=0, num_epochs=1, minibatch_size=1000, shuffle_batch_per_epoch=True)"], "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9485408017724, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.callbacks.callbacks.RLlibCallback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 97.40031003952026, "iterations_since_restore": 10, "perf": {"cpu_util_percent": 27.457142857142856, "ram_util_percent": 80.19285714285715}}
{"timers": {"training_iteration": 9.608631200766578, "restore_env_runners": 2.007986104822756e-05, "training_step": 9.608457005350674, "env_runner_sampling_timer": 1.7447177875822224, "learner_update_timer": 7.6727192495804095, "synch_weights": 0.0008108683150432686, "restore_eval_env_runners": 9.288936289414003e-06, "evaluation_iteration": 0.14153744667423462, "synch_eval_env_connectors": 0.00013766197151187667, "synch_env_connectors": 4.9316737748836854e-06}, "env_runners": {"module_to_env_connector": {"timers": {"connectors": {"listify_data_for_vector_env": 1.099891510815245e-05, "remove_single_ts_time_rank_from_batch": 1.2437378683677358e-05, "tensor_to_numpy": 1.6275250164847634e-05, "un_batch_to_individual_items": 6.9911003465571334e-06, "normalize_and_clip_actions": 8.294058681386018e-06, "get_actions": 4.318942952803744e-05}}, "connector_pipeline_timer": 0.00012547840040556997}, "env_to_module_sum_episodes_length_out": 10.36823839457432, "rlmodule_inference_timer": 3.431424669748613e-05, "env_to_module_connector": {"timers": {"connectors": {"add_observations_from_episodes_to_batch": 2.9602759928072758e-06, "add_time_dim_to_batch_and_zero_pad": 7.373383724761822e-06, "numpy_to_tensor": 2.824198541470195e-05, "batch_individual_items": 1.3295532443570988e-05, "add_states_from_episodes_to_batch": 2.8379345846179237e-06}}, "connector_pipeline_timer": 7.757765561099178e-05}, "episode_return_max": 14.5, "num_env_steps_sampled": 5000.0, "num_episodes": 250.0, "episode_len_max": 20, "sample": 0.00625409782004272, "weights_seq_no": 10.0, "num_episodes_lifetime": -277375.0, "env_to_module_sum_episodes_length_in": 10.36823839457432, "num_agent_steps_sampled": {"default_agent": 5000.0}, "num_env_steps_sampled_lifetime": -5547500.0, "episode_duration_sec_mean": 0.005955305169802159, "episode_return_mean": 4.5, "num_module_steps_sampled": {"default_policy": 5000.0}, "env_reset_timer": 4.52562013148467e-05, "num_module_steps_sampled_lifetime": {"default_policy": -5547500.0}, "agent_episode_returns_mean": {"default_agent": 4.5}, "env_step_timer": 1.5027171755600507e-05, "episode_return_min": -5.5, "episode_len_min": 20, "episode_len_mean": 20.0, "num_agent_steps_sampled_lifetime": {"default_agent": -5547500.0}, "module_episode_returns_mean": {"default_policy": 4.5}, "time_between_sampling": 0.03297290759971175, "num_env_steps_sampled_lifetime_throughput": 3065.8056107007033}, "__all_modules__": {"learner_connector_sum_episodes_length_in": 5000.0, "learner_connector": {"connector_pipeline_timer": 0.1534902641821251, "timers": {"connectors": {"add_one_ts_to_episodes_and_truncate": 0.008957827009215933, "add_observations_from_episodes_to_batch": 0.0008563819108114175, "add_columns_from_episodes_to_train_batch": 0.04125189576991941, "add_time_dim_to_batch_and_zero_pad": 0.08987461206922025, "add_states_from_episodes_to_batch": 0.0036142914000898392, "batch_individual_items": 0.008736543784889443, "numpy_to_tensor": 6.315715391974998e-05}}}, "learner_connector_sum_episodes_length_out": 5250.0}, "learners": {"intrinsic_reward_module": {"weights_seq_no": 11.0, "num_module_steps_trained_lifetime": 65835, "gradients_default_optimizer_global_norm": 0.0, "module_train_batch_size_mean": 998.2690509307901, "diff_num_grad_updates_vs_sampler_policy": 1.0, "num_trainable_parameters": 8266, "default_optimizer_learning_rate": 0.0002715581955, "total_loss": 0.0, "num_module_steps_trained": 5985, "curr_entropy_coeff": 0.0015431216992, "num_module_steps_trained_lifetime_throughput": 748.9334931092595}, "differentiable_learners": {"intrinsic_attention_ppo_learner": {"intrinsic_reward_module": {"total_loss": 0.0, "num_module_steps_trained": 35910, "diff_num_grad_updates_vs_sampler_policy": 56.0, "weights_seq_no": 66.0, "num_module_steps_trained_lifetime": 395010, "module_train_batch_size_mean": 997.5206335045569}, "default_policy": {"vf_explained_var": 0.0018584728240966797, "total_loss": 0.24842552840709686, "vf_loss": 0.32100731134414673, "vf_loss_unclipped": 47.49272918701172, "weights_seq_no": 66.0, "num_module_steps_trained_lifetime": 395010, "module_train_batch_size_mean": 997.5206335045569, "entropy": 0.6901904940605164, "mean_kl_loss": 2.818222128553316e-05, "use_intrinsic_rewards": 1.0, "policy_loss": -0.0005950636113993824, "num_module_steps_trained": 35910, "diff_num_grad_updates_vs_sampler_policy": 56.0}, "__all_modules__": {"num_env_steps_trained_lifetime": 2376000, "num_module_steps_trained_lifetime": 790020, "num_module_steps_trained": 71820, "num_env_steps_trained": 216000, "num_env_steps_trained_lifetime_throughput": 53925.193158898706}}}, "default_policy": {"curr_kl_coeff": 7.889840344432741e-05, "num_module_steps_trained_lifetime": 65835, "module_train_batch_size_mean": 998.2690509307901, "entropy": 0.690159022808075, "num_trainable_parameters": 16595, "mean_kl_loss": 3.136597661068663e-05, "use_intrinsic_rewards": 0.0, "policy_loss": -0.0006264221738092601, "num_module_steps_trained": 5985, "diff_num_grad_updates_vs_sampler_policy": 1.0, "vf_explained_var": 0.0005234479904174805, "total_loss": 0.24800460040569305, "vf_loss": 0.3205130994319916, "curr_entropy_coeff": 0.0015431216992, "vf_loss_unclipped": 47.68989562988281, "weights_seq_no": 11.0, "num_module_steps_trained_lifetime_throughput": 748.9249886099747}, "__all_modules__": {"num_module_steps_trained": 11970, "num_non_trainable_parameters": 0, "num_env_steps_trained": 36000, "num_env_steps_trained_lifetime": 396000, "num_module_steps_trained_lifetime": 131670, "num_trainable_parameters": 24861, "num_env_steps_trained_lifetime_throughput": 4509.0485087799325, "num_module_steps_trained_throughput": 24808459.93953074, "num_module_steps_trained_lifetime_throughput": 12972522.562205926}, "IntrinsicAttentionMask": [[[0.16504134237766266, 0.16615715622901917, 0.1661273092031479, 0.1671820729970932, 0.16776114702224731, 0.16773100197315216], [0.16430075466632843, 0.16592252254486084, 0.16587908565998077, 0.16741657257080078, 0.1682625561952591, 0.1682184934616089], [0.1643204540014267, 0.16592878103256226, 0.16588570177555084, 0.16741031408309937, 0.16824917495250702, 0.16820548474788666], [0.1636267453432083, 0.16570764780044556, 0.1656518280506134, 0.16762980818748474, 0.16872040927410126, 0.16866357624530792], [0.16324853897094727, 0.16558650135993958, 0.1655237376689911, 0.16774939000606537, 0.16897794604301453, 0.16891390085220337], [0.16326817870140076, 0.16559280455112457, 0.16553039848804474, 0.16774319112300873, 0.16896456480026245, 0.16890089213848114]], [[0.16913475096225739, 0.16907361149787903, 0.16438810527324677, 0.1643286794424057, 0.16765835881233215, 0.16541649401187897], [0.16911976039409637, 0.16905899345874786, 0.16440191864967346, 0.16434283554553986, 0.1676524132490158, 0.1654241383075714], [0.16795526444911957, 0.16792352497577667, 0.16547490656375885, 0.16544362902641296, 0.1671873778104782, 0.166015163064003], [0.16794031858444214, 0.1679089516401291, 0.16548874974250793, 0.1654578298330307, 0.16718138754367828, 0.16602276265621185], [0.16877120733261108, 0.16871915757656097, 0.16472269594669342, 0.1646718978881836, 0.16751375794410706, 0.16560126841068268], [0.16821347177028656, 0.1681753247976303, 0.165236696600914, 0.16519922018051147, 0.16729095578193665, 0.16588431596755981]], [[0.16514094173908234, 0.16625744104385376, 0.16562403738498688, 0.16728298366069794, 0.1678624004125595, 0.16783224046230316], [0.16444499790668488, 0.1660681962966919, 0.16514672338962555, 0.1675635576248169, 0.1684102863073349, 0.1683661937713623], [0.16483905911445618, 0.16617555916309357, 0.1654171198606491, 0.16740474104881287, 0.16809988021850586, 0.168063685297966], [0.16381123661994934, 0.16589447855949402, 0.1647111177444458, 0.1678188145160675, 0.16891063749790192, 0.1688537299633026], [0.16345544159412384, 0.16579635441303253, 0.16446617245674133, 0.167961984872818, 0.1691921055316925, 0.16912797093391418], [0.16347390413284302, 0.16580145061016083, 0.16447889804840088, 0.16795454919338226, 0.16917747259140015, 0.16911371052265167]], [[0.16753938794136047, 0.16699440777301788, 0.16604378819465637, 0.1660183221101761, 0.1674366593360901, 0.1659674197435379], [0.1672740876674652, 0.1668950915336609, 0.16623306274414062, 0.16621531546115875, 0.1672026664018631, 0.166179820895195], [0.16680960357189178, 0.16672053933143616, 0.16656459867954254, 0.16656041145324707, 0.1667928248643875, 0.16655203700065613], [0.16679713129997253, 0.1667158454656601, 0.16657349467277527, 0.16656967997550964, 0.16678182780742645, 0.1665620356798172], [0.1674894392490387, 0.16697575151920319, 0.16607943177223206, 0.16605542600154877, 0.16739261150360107, 0.1660074144601822], [0.16677218675613403, 0.16670644283294678, 0.16659130156040192, 0.1665882170200348, 0.16675980389118195, 0.16658203303813934]], [[0.16504032909870148, 0.16615615785121918, 0.16552312672138214, 0.1677902787923813, 0.16776013374328613, 0.16773000359535217], [0.1642986387014389, 0.16592039167881012, 0.16499973833560944, 0.1683044731616974, 0.16826041042804718, 0.16821634769439697], [0.1647185981273651, 0.1660541146993637, 0.16529622673988342, 0.16801320016384125, 0.16797703504562378, 0.1679408699274063], [0.1632244735956192, 0.16557568311691284, 0.16423961520195007, 0.1690511852502823, 0.1689867377281189, 0.1689223051071167], [0.16324415802955627, 0.16558203101158142, 0.1642535775899887, 0.16903747618198395, 0.1689734011888504, 0.16890935599803925], [0.16326384246349335, 0.1655883938074112, 0.16426751017570496, 0.1690237671136856, 0.1689600795507431, 0.1688963919878006]], [[0.1677991896867752, 0.16725337505340576, 0.16578572988510132, 0.1662757694721222, 0.16717645525932312, 0.1657094955444336], [0.16745471954345703, 0.16707530617713928, 0.16605323553085327, 0.16639479994773865, 0.16702181100845337, 0.16600006818771362], [0.1665247231721878, 0.16659286618232727, 0.1667773425579071, 0.16671554744243622, 0.1666024923324585, 0.16678696870803833], [0.16683585941791534, 0.1667545586824417, 0.16653479635715485, 0.16660836338996887, 0.16674306988716125, 0.16652333736419678], [0.1674061119556427, 0.16705015301704407, 0.16609102487564087, 0.1664115935564041, 0.1669999659061432, 0.16604110598564148], [0.1664762645959854, 0.16656765341758728, 0.1668151468038559, 0.16673223674297333, 0.16658055782318115, 0.16682808101177216]]]}, "num_training_step_calls_per_iteration": 1, "evaluation": {"env_runners": {"episode_len_min": 20, "env_to_module_connector": {"timers": {"connectors": {"numpy_to_tensor": 1.1642884540706378e-05, "add_states_from_episodes_to_batch": 2.6578794207450492e-06, "batch_individual_items": 1.2453251660737582e-05, "add_time_dim_to_batch_and_zero_pad": 7.234025444471925e-06, "add_observations_from_episodes_to_batch": 2.9051252446779254e-06}}, "connector_pipeline_timer": 5.850424045189048e-05}, "module_to_env_connector": {"timers": {"connectors": {"tensor_to_numpy": 1.4749542569511443e-05, "un_batch_to_individual_items": 6.4537951517173664e-06, "normalize_and_clip_actions": 7.729020287474745e-06, "get_actions": 3.587395215722581e-05, "remove_single_ts_time_rank_from_batch": 1.1789991571827734e-05, "listify_data_for_vector_env": 1.0376060767834146e-05}}, "connector_pipeline_timer": 0.00011233673034798096}, "num_env_steps_sampled": 400, "episode_len_max": 20, "num_agent_steps_sampled": {"default_agent": 400}, "weights_seq_no": 11.0, "num_env_steps_sampled_lifetime": 55400, "episode_duration_sec_mean": 0.005218699217075482, "episode_return_mean": -0.3, "env_reset_timer": 0.00015822977715984726, "module_episode_returns_mean": {"default_policy": -0.3}, "rlmodule_inference_timer": 3.081220376590444e-05, "episode_return_max": 15.5, "env_to_module_sum_episodes_length_in": 10.368238394574323, "num_module_steps_sampled": {"default_policy": 400}, "agent_episode_returns_mean": {"default_agent": -0.3}, "num_agent_steps_sampled_lifetime": {"default_agent": 4400}, "num_module_steps_sampled_lifetime": {"default_policy": 4400}, "env_to_module_sum_episodes_length_out": 10.368238394574323, "num_episodes": 20, "num_episodes_lifetime": 220, "episode_return_min": -13.5, "sample": 0.13472222005067833, "env_step_timer": 1.3670587607736609e-05, "episode_len_mean": 20.0, "time_between_sampling": 9.642136891012736}, "num_healthy_workers": 1, "actor_manager_num_outstanding_async_reqs": 0, "num_remote_worker_restarts": 0}, "num_env_steps_sampled_lifetime": -5547500.0, "fault_tolerance": {"num_healthy_workers": 0, "num_remote_worker_restarts": 0}, "env_runner_group": {"actor_manager_num_outstanding_async_reqs": 0}, "done": false, "training_iteration": 11, "trial_id": "b17e2_00000", "date": "2025-08-11_18-44-57", "timestamp": 1754930697, "time_this_iter_s": 9.665773868560791, "time_total_s": 107.06608390808105, "pid": 11680, "hostname": "Mac", "node_ip": "127.0.0.1", "config": {"exploration_config": {}, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 2, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "env": "Umbrella", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": false, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 0, "create_local_env_runner": true, "num_envs_per_env_runner": 1, "gym_env_vectorize_mode": "SYNC", "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "episodes_to_numpy": true, "max_requests_in_flight_per_env_runner": 1, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "merge_env_runner_states": "training_only", "broadcast_env_runner_states": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "complete_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "sampler_perf_stats_ema_coef": null, "_is_online": true, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": "auto", "num_aggregator_actors_per_learner": 0, "max_requests_in_flight_per_aggregator_actor": 3, "local_gpu_idx": 0, "max_requests_in_flight_per_learner": 3, "gamma": 1, "lr": 0.0002715581955, "grad_clip": 0.5, "grad_clip_by": "global_norm", "_train_batch_size_per_learner": 5000, "train_batch_size": 4000, "num_epochs": 1, "minibatch_size": 1000, "shuffle_batch_per_epoch": true, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "log_std_clip_param": 20.0, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "_disable_preprocessor_api": false, "_disable_action_flattening": false}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {"intrinsic_reward_coeff": 0.2795015916508}, "optimizer": {}, "_learner_class": "<class 'source.intrinsic_attention_ppo.learners.IntrinsicAttentionMetaLearner.IntrinsicAttentionMetaLearner'>", "callbacks_on_algorithm_init": null, "callbacks_on_env_runners_recreated": null, "callbacks_on_offline_eval_runners_recreated": null, "callbacks_on_checkpoint_loaded": null, "callbacks_on_environment_created": null, "callbacks_on_episode_created": null, "callbacks_on_episode_start": null, "callbacks_on_episode_step": null, "callbacks_on_episode_end": null, "callbacks_on_evaluate_start": null, "callbacks_on_evaluate_end": null, "callbacks_on_evaluate_offline_start": null, "callbacks_on_evaluate_offline_end": null, "callbacks_on_sample_end": null, "callbacks_on_train_result": null, "explore": true, "enable_rl_module_and_learner": true, "enable_env_runner_and_connector_v2": true, "_prior_exploration_config": {"type": "StochasticSampling"}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x13c0118a0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "offline_data_class": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_read_batch_size": null, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "materialize_data": false, "materialize_mapped_data": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "ignore_final_observation": false, "prelearner_class": null, "prelearner_buffer_class": null, "prelearner_buffer_kwargs": {}, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_remaining_data": false, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": 1, "evaluation_duration": 20, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_auto_duration_min_env_steps_per_sample": 100, "evaluation_auto_duration_max_env_steps_per_sample": 2000, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 1, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "offline_evaluation_interval": null, "num_offline_eval_runners": 0, "offline_loss_for_module_fn": null, "offline_evaluation_duration": 1, "offline_evaluation_parallel_to_training": false, "offline_evaluation_timeout_s": 120.0, "num_cpus_per_offline_eval_runner": 1, "num_gpus_per_offline_eval_runner": 0, "custom_resources_per_offline_eval_runner": {}, "restart_failed_offline_eval_runners": true, "ignore_offline_eval_runner_failures": false, "max_num_offline_eval_runner_restarts": 1000, "offline_eval_runner_restore_timeout_s": 1800.0, "max_requests_in_flight_per_offline_eval_runner": 1, "validate_offline_eval_runners_after_construction": true, "offline_eval_runner_health_probe_timeout_s": 30.0, "offline_eval_rl_module_inference_only": false, "broadcast_offline_eval_runner_states": false, "offline_eval_batch_size_per_runner": 256, "dataset_num_iters_per_eval_runner": 1, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "log_gradients": false, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 9, "restart_failed_env_runners": true, "ignore_env_runner_failures": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30.0, "env_runner_restore_timeout_s": 1800.0, "_model_config": {}, "_rl_module_spec": "MultiRLModuleSpec(multi_rl_module_class=<class 'ray.rllib.core.rl_module.multi_rl_module.MultiRLModule'>, observation_space=None, action_space=None, inference_only=False, model_config=None, rl_module_specs={'default_policy': RLModuleSpec(module_class=<class 'source.intrinsic_attention_ppo.rl_modules.DifferentiablePPOModule.DifferentiablePPOModule'>, observation_space=None, action_space=None, inference_only=False, learner_only=False, model_config={'vf_share_layers': True, 'embedding_dim': 62, 'max_seq_len': 6, 'policy_head_hidden_sizes': [32], 'value_head_hidden_sizes': [101], 'embedding_hidden_sizes': [121]}, catalog_class=None, load_state_path=None, model_config_dict=None), 'intrinsic_reward_module': RLModuleSpec(module_class=<class 'source.intrinsic_attention_ppo.rl_modules.IntrinsicAttentionModule.IntrinsicAttentionModule'>, observation_space=None, action_space=None, inference_only=False, learner_only=True, model_config={'intrinsic_reward_network': {'encoder_hidden_sizes': [], 'encoding_dim': 1, 'num_heads': 1, 'head_hidden_sizes': None, 'layers': [{'type': 'attention'}]}, 'extrinsic_value_hidden_layers': [127, 60], 'vf_share_layers': True, 'max_seq_len': 6}, catalog_class=None, load_state_path=None, model_config_dict=None)}, load_state_path=None, modules_to_load=None, module_specs={'default_policy': RLModuleSpec(module_class=<class 'source.intrinsic_attention_ppo.rl_modules.DifferentiablePPOModule.DifferentiablePPOModule'>, observation_space=None, action_space=None, inference_only=False, learner_only=False, model_config={'vf_share_layers': True, 'embedding_dim': 62, 'max_seq_len': 6, 'policy_head_hidden_sizes': [32], 'value_head_hidden_sizes': [101], 'embedding_hidden_sizes': [121]}, catalog_class=None, load_state_path=None, model_config_dict=None), 'intrinsic_reward_module': RLModuleSpec(module_class=<class 'source.intrinsic_attention_ppo.rl_modules.IntrinsicAttentionModule.IntrinsicAttentionModule'>, observation_space=None, action_space=None, inference_only=False, learner_only=True, model_config={'intrinsic_reward_network': {'encoder_hidden_sizes': [], 'encoding_dim': 1, 'num_heads': 1, 'head_hidden_sizes': None, 'layers': [{'type': 'attention'}]}, 'extrinsic_value_hidden_layers': [127, 60], 'vf_share_layers': True, 'max_seq_len': 6}, catalog_class=None, load_state_path=None, model_config_dict=None)})", "algorithm_config_overrides_per_module": {"intrinsic_reward_module": {"lr": 0.0002715581955}}, "_per_module_overrides": {}, "_validate_config": true, "_use_msgpack_checkpoints": false, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "env_task_fn": -1, "enable_connectors": -1, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.161583927863, "kl_target": 0.0201019014258, "vf_loss_coeff": 0.7790510010087, "entropy_coeff": 0.0015431216992, "clip_param": 0.2459212356676, "vf_clip_param": 0.3769744131561, "entropy_coeff_schedule": null, "lr_schedule": null, "sgd_minibatch_size": -1, "vf_share_layers": -1, "differentiable_learner_configs": ["DifferentiableLearnerConfig(learner_class=<class 'source.intrinsic_attention_ppo.learners.IntrinsicAttentionPPOLearner.IntrinsicAttentionPPOLearner'>, learner_connector=None, add_default_connectors_to_learner_pipeline=True, is_multi_agent=False, policies_to_update=['default_policy'], lr=0.0060984166342, num_total_minibatches=0, num_epochs=1, minibatch_size=1000, shuffle_batch_per_epoch=True)"], "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9485408017724, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.callbacks.callbacks.RLlibCallback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 107.06608390808105, "iterations_since_restore": 11, "perf": {"cpu_util_percent": 38.464285714285715, "ram_util_percent": 80.69285714285715}}
{"timers": {"training_iteration": 9.609660160428957, "restore_env_runners": 1.994073229032988e-05, "training_step": 9.609485149466948, "env_runner_sampling_timer": 1.7437904105465787, "learner_update_timer": 7.674587523333995, "synch_weights": 0.0008170467115772722, "restore_eval_env_runners": 9.267716855249397e-06, "evaluation_iteration": 0.14130027553740188, "synch_eval_env_connectors": 0.00013746118147180649, "synch_env_connectors": 4.923607642271004e-06}, "env_runners": {"module_to_env_connector": {"timers": {"connectors": {"listify_data_for_vector_env": 1.065918742666688e-05, "remove_single_ts_time_rank_from_batch": 1.2094825353262331e-05, "tensor_to_numpy": 1.5732869798388653e-05, "un_batch_to_individual_items": 6.751321493904942e-06, "normalize_and_clip_actions": 8.025570959859507e-06, "get_actions": 4.0716740287837224e-05}}, "connector_pipeline_timer": 0.00012048513943882051}, "env_to_module_sum_episodes_length_out": 10.36823839457432, "rlmodule_inference_timer": 4.9967139156818783e-05, "env_to_module_connector": {"timers": {"connectors": {"add_observations_from_episodes_to_batch": 2.831568804011234e-06, "add_time_dim_to_batch_and_zero_pad": 7.039367391383266e-06, "numpy_to_tensor": 1.3034053074851484e-05, "batch_individual_items": 1.2678492364836147e-05, "add_states_from_episodes_to_batch": 2.7197442607482804e-06}}, "connector_pipeline_timer": 6.0346198071848346e-05}, "episode_return_max": 14.5, "num_env_steps_sampled": 5000.0, "num_episodes": 250.0, "episode_len_max": 20, "sample": 0.006153973850105794, "weights_seq_no": 11.0, "num_episodes_lifetime": -308250.0, "env_to_module_sum_episodes_length_in": 10.36823839457432, "num_agent_steps_sampled": {"default_agent": 5000.0}, "num_env_steps_sampled_lifetime": -6165000.0, "episode_duration_sec_mean": 0.005729555833153425, "episode_return_mean": 6.419999999999999, "num_module_steps_sampled": {"default_policy": 5000.0}, "env_reset_timer": 4.3212929767113275e-05, "num_module_steps_sampled_lifetime": {"default_policy": -6165000.0}, "agent_episode_returns_mean": {"default_agent": 6.419999999999999}, "env_step_timer": 1.4315532138349743e-05, "episode_return_min": -5.5, "episode_len_min": 20, "episode_len_mean": 20.0, "num_agent_steps_sampled_lifetime": {"default_agent": -6165000.0}, "module_episode_returns_mean": {"default_policy": 6.419999999999999}, "time_between_sampling": 0.03238960274807949, "num_env_steps_sampled_lifetime_throughput": 3182.5361621260945}, "__all_modules__": {"learner_connector_sum_episodes_length_in": 5000.0, "learner_connector": {"connector_pipeline_timer": 0.1534762157004935, "timers": {"connectors": {"add_one_ts_to_episodes_and_truncate": 0.008954153738992719, "add_observations_from_episodes_to_batch": 0.0008566414219846057, "add_columns_from_episodes_to_train_batch": 0.04125218723260485, "add_time_dim_to_batch_and_zero_pad": 0.08987710094829277, "add_states_from_episodes_to_batch": 0.0036149897351823545, "batch_individual_items": 0.008722732098030506, "numpy_to_tensor": 6.324725260208984e-05}}}, "learner_connector_sum_episodes_length_out": 5250.0}, "learners": {"intrinsic_reward_module": {"weights_seq_no": 12.0, "num_module_steps_trained_lifetime": 71820, "gradients_default_optimizer_global_norm": 0.0, "module_train_batch_size_mean": 998.2236050808158, "diff_num_grad_updates_vs_sampler_policy": 1.0, "num_trainable_parameters": 8266, "default_optimizer_learning_rate": 0.0002715581955, "total_loss": 0.0, "num_module_steps_trained": 5985, "curr_entropy_coeff": 0.0015431216992, "num_module_steps_trained_lifetime_throughput": 746.7274337378327}, "differentiable_learners": {"intrinsic_attention_ppo_learner": {"intrinsic_reward_module": {"total_loss": 0.0, "num_module_steps_trained": 35910, "diff_num_grad_updates_vs_sampler_policy": 61.0, "weights_seq_no": 72.0, "num_module_steps_trained_lifetime": 430920, "module_train_batch_size_mean": 997.512081102731}, "default_policy": {"vf_explained_var": 0.001862645149230957, "total_loss": 0.24880865216255188, "vf_loss": 0.32094091176986694, "vf_loss_unclipped": 49.51739501953125, "weights_seq_no": 72.0, "num_module_steps_trained_lifetime": 430920, "module_train_batch_size_mean": 997.512081102731, "entropy": 0.6898854970932007, "mean_kl_loss": 1.1209223885089159e-05, "use_intrinsic_rewards": 1.0, "policy_loss": -0.00015797595551703125, "num_module_steps_trained": 35910, "diff_num_grad_updates_vs_sampler_policy": 61.0}, "__all_modules__": {"num_env_steps_trained_lifetime": 2592000, "num_module_steps_trained_lifetime": 861840, "num_module_steps_trained": 71820, "num_env_steps_trained": 216000, "num_env_steps_trained_lifetime_throughput": 53032.095521863834}}}, "default_policy": {"curr_kl_coeff": 3.944920172216371e-05, "num_module_steps_trained_lifetime": 71820, "module_train_batch_size_mean": 998.2236050808158, "entropy": 0.6898731589317322, "num_trainable_parameters": 16595, "mean_kl_loss": 1.1973582331847865e-05, "use_intrinsic_rewards": 0.0, "policy_loss": -0.0001628190220799297, "num_module_steps_trained": 5985, "diff_num_grad_updates_vs_sampler_policy": 1.0, "vf_explained_var": 0.00037747621536254883, "total_loss": 0.24846573173999786, "vf_loss": 0.32050931453704834, "curr_entropy_coeff": 0.0015431216992, "vf_loss_unclipped": 49.76987075805664, "weights_seq_no": 12.0, "num_module_steps_trained_lifetime_throughput": 746.7194231288614}, "__all_modules__": {"num_module_steps_trained": 11970, "num_non_trainable_parameters": 0, "num_env_steps_trained": 36000, "num_env_steps_trained_lifetime": 432000, "num_module_steps_trained_lifetime": 143640, "num_trainable_parameters": 24861, "num_env_steps_trained_lifetime_throughput": 4495.617161685597, "num_module_steps_trained_throughput": 24162927.458174694, "num_module_steps_trained_lifetime_throughput": 12939517.231579958}, "IntrinsicAttentionMask": [[[0.16524261236190796, 0.1663597971200943, 0.16632990539073944, 0.16738596558570862, 0.16735589504241943, 0.16732583940029144], [0.1645936369895935, 0.16621829569339752, 0.1661747694015503, 0.16771499812602997, 0.1676710844039917, 0.16762717068195343], [0.16461090743541718, 0.16622208058834076, 0.16617891192436218, 0.16770623624324799, 0.16766269505023956, 0.16761915385723114], [0.1640029400587082, 0.16608859598636627, 0.16603264212608337, 0.16801519691944122, 0.167958602309227, 0.16790202260017395], [0.16402018070220947, 0.1660924106836319, 0.16603681445121765, 0.16800643503665924, 0.16795021295547485, 0.16789399087429047], [0.16403742134571075, 0.16609619557857513, 0.16604097187519073, 0.16799767315387726, 0.16794182360172272, 0.16788598895072937]], [[0.1669791042804718, 0.16732962429523468, 0.16628503799438477, 0.16626691818237305, 0.16727493703365326, 0.16586439311504364], [0.1670997589826584, 0.16758659482002258, 0.1661369651556015, 0.16611185669898987, 0.16751061379909515, 0.1655542105436325], [0.1667388528585434, 0.16681954264640808, 0.16657871007919312, 0.16657452285289764, 0.16680696606636047, 0.1664814054965973], [0.1667325645685196, 0.1668062061071396, 0.16658638417720795, 0.16658255457878113, 0.16679471731185913, 0.16649755835533142], [0.16708096861839294, 0.16754654049873352, 0.16616006195545197, 0.16613604128360748, 0.16747388243675232, 0.16560254991054535], [0.16659238934516907, 0.16650958359241486, 0.1667570024728775, 0.16676130890846252, 0.16652248799800873, 0.16685716807842255]], [[0.16707110404968262, 0.1662318855524063, 0.16575485467910767, 0.167003333568573, 0.16698074340820312, 0.16695815324783325], [0.16682709753513336, 0.16649429500102997, 0.16630466282367706, 0.16680026054382324, 0.16679130494594574, 0.16678236424922943], [0.1666877716779709, 0.16664400696754456, 0.16661903262138367, 0.16668424010276794, 0.16668307781219482, 0.16668188571929932], [0.16705143451690674, 0.16625303030014038, 0.165799081325531, 0.16698695719242096, 0.16696546971797943, 0.1669439822435379], [0.16704489290714264, 0.16626007854938507, 0.1658138483762741, 0.1669815182685852, 0.16696040332317352, 0.16693928837776184], [0.16703833639621735, 0.16626712679862976, 0.16582860052585602, 0.16697606444358826, 0.16695530712604523, 0.1669345647096634]], [[0.1671631932258606, 0.16751410067081451, 0.16610153019428253, 0.1660834401845932, 0.16709035634994507, 0.16604726016521454], [0.16735532879829407, 0.16784290969371796, 0.16588261723518372, 0.16585753858089447, 0.16725417971611023, 0.16580742597579956], [0.16657884418964386, 0.16651712357997894, 0.16676652431488037, 0.16676972806453705, 0.16659167408943176, 0.1667761504650116], [0.1665688306093216, 0.16650009155273438, 0.16677787899971008, 0.1667814552783966, 0.1665831357240677, 0.16678860783576965], [0.16712325811386108, 0.1674458235502243, 0.16614703834056854, 0.1661304086446762, 0.16705630719661713, 0.16609711945056915], [0.16654883325099945, 0.16646604239940643, 0.1668006181716919, 0.16680490970611572, 0.16656604409217834, 0.16681353747844696]], [[0.16524069011211395, 0.16575384140014648, 0.16572406888008118, 0.16738402843475342, 0.16796380281448364, 0.1679336279630661], [0.16494092345237732, 0.1655612289905548, 0.16552522778511047, 0.16753453016281128, 0.16823731362819672, 0.16820073127746582], [0.16495829820632935, 0.1655724048614502, 0.1655367612838745, 0.16752582788467407, 0.16822147369384766, 0.1681852638721466], [0.16399620473384857, 0.16495263576507568, 0.16489708423614502, 0.16800831258296967, 0.16910137236118317, 0.1690444052219391], [0.16366292536258698, 0.16473735868930817, 0.16467490792274475, 0.16817519068717957, 0.16940687596797943, 0.16934266686439514], [0.16368022561073303, 0.16474854946136475, 0.16468647122383118, 0.16816653311252594, 0.16939100623130798, 0.16932716965675354]], [[0.16762566566467285, 0.16708041727542877, 0.1656142771244049, 0.1661038100719452, 0.16752289235591888, 0.16605286300182343], [0.16733413934707642, 0.16695500910282135, 0.16593365371227264, 0.16627496480941772, 0.1672627031803131, 0.16623947024345398], [0.16654637455940247, 0.16661451756954193, 0.16679902374744415, 0.16673721373081207, 0.16655920445919037, 0.16674363613128662], [0.1668100357055664, 0.16672874987125397, 0.1665090173482895, 0.16658256947994232, 0.16679471731185913, 0.16657492518424988], [0.1675707995891571, 0.1670568436384201, 0.16567440330982208, 0.16613605618476868, 0.1674739271402359, 0.1660880297422409], [0.16678261756896973, 0.16671687364578247, 0.16653913259506226, 0.1665986329317093, 0.16677023470401764, 0.16659244894981384]]]}, "num_training_step_calls_per_iteration": 1, "evaluation": {"env_runners": {"episode_len_min": 20, "env_to_module_connector": {"timers": {"connectors": {"numpy_to_tensor": 1.1716012607180986e-05, "add_states_from_episodes_to_batch": 2.673647416361474e-06, "batch_individual_items": 1.220488105930544e-05, "add_time_dim_to_batch_and_zero_pad": 6.97570075166664e-06, "add_observations_from_episodes_to_batch": 2.796114327691625e-06}}, "connector_pipeline_timer": 5.803496409725733e-05}, "module_to_env_connector": {"timers": {"connectors": {"tensor_to_numpy": 1.4658276751681912e-05, "un_batch_to_individual_items": 6.507750359346273e-06, "normalize_and_clip_actions": 7.7445773696244e-06, "get_actions": 3.479091473263419e-05, "remove_single_ts_time_rank_from_batch": 1.1842913145330105e-05, "listify_data_for_vector_env": 1.0323063767860308e-05}}, "connector_pipeline_timer": 0.0001113545382609396}, "num_env_steps_sampled": 400, "episode_len_max": 20, "num_agent_steps_sampled": {"default_agent": 400}, "weights_seq_no": 12.0, "num_env_steps_sampled_lifetime": 60400, "episode_duration_sec_mean": 0.005210077131632716, "episode_return_mean": 0.5, "env_reset_timer": 0.00016012706932922886, "module_episode_returns_mean": {"default_policy": 0.5}, "rlmodule_inference_timer": 2.997338569992125e-05, "episode_return_max": 15.5, "env_to_module_sum_episodes_length_in": 10.368238394574323, "num_module_steps_sampled": {"default_policy": 400}, "agent_episode_returns_mean": {"default_agent": 0.5}, "num_agent_steps_sampled_lifetime": {"default_agent": 4800}, "num_module_steps_sampled_lifetime": {"default_policy": 4800}, "env_to_module_sum_episodes_length_out": 10.368238394574323, "num_episodes": 20, "num_episodes_lifetime": 240, "episode_return_min": -13.5, "sample": 0.13449599909958362, "env_step_timer": 1.35101661505617e-05, "episode_len_mean": 20.0, "time_between_sampling": 9.643072202102111}, "num_healthy_workers": 1, "actor_manager_num_outstanding_async_reqs": 0, "num_remote_worker_restarts": 0}, "num_env_steps_sampled_lifetime": -6165000.0, "fault_tolerance": {"num_healthy_workers": 0, "num_remote_worker_restarts": 0}, "env_runner_group": {"actor_manager_num_outstanding_async_reqs": 0}, "done": false, "training_iteration": 12, "trial_id": "b17e2_00000", "date": "2025-08-11_18-45-06", "timestamp": 1754930706, "time_this_iter_s": 9.83502984046936, "time_total_s": 116.90111374855042, "pid": 11680, "hostname": "Mac", "node_ip": "127.0.0.1", "config": {"exploration_config": {}, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 2, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "env": "Umbrella", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": false, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 0, "create_local_env_runner": true, "num_envs_per_env_runner": 1, "gym_env_vectorize_mode": "SYNC", "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "episodes_to_numpy": true, "max_requests_in_flight_per_env_runner": 1, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "merge_env_runner_states": "training_only", "broadcast_env_runner_states": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "complete_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "sampler_perf_stats_ema_coef": null, "_is_online": true, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": "auto", "num_aggregator_actors_per_learner": 0, "max_requests_in_flight_per_aggregator_actor": 3, "local_gpu_idx": 0, "max_requests_in_flight_per_learner": 3, "gamma": 1, "lr": 0.0002715581955, "grad_clip": 0.5, "grad_clip_by": "global_norm", "_train_batch_size_per_learner": 5000, "train_batch_size": 4000, "num_epochs": 1, "minibatch_size": 1000, "shuffle_batch_per_epoch": true, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "log_std_clip_param": 20.0, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "_disable_preprocessor_api": false, "_disable_action_flattening": false}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {"intrinsic_reward_coeff": 0.2795015916508}, "optimizer": {}, "_learner_class": "<class 'source.intrinsic_attention_ppo.learners.IntrinsicAttentionMetaLearner.IntrinsicAttentionMetaLearner'>", "callbacks_on_algorithm_init": null, "callbacks_on_env_runners_recreated": null, "callbacks_on_offline_eval_runners_recreated": null, "callbacks_on_checkpoint_loaded": null, "callbacks_on_environment_created": null, "callbacks_on_episode_created": null, "callbacks_on_episode_start": null, "callbacks_on_episode_step": null, "callbacks_on_episode_end": null, "callbacks_on_evaluate_start": null, "callbacks_on_evaluate_end": null, "callbacks_on_evaluate_offline_start": null, "callbacks_on_evaluate_offline_end": null, "callbacks_on_sample_end": null, "callbacks_on_train_result": null, "explore": true, "enable_rl_module_and_learner": true, "enable_env_runner_and_connector_v2": true, "_prior_exploration_config": {"type": "StochasticSampling"}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x13c0118a0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "offline_data_class": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_read_batch_size": null, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "materialize_data": false, "materialize_mapped_data": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "ignore_final_observation": false, "prelearner_class": null, "prelearner_buffer_class": null, "prelearner_buffer_kwargs": {}, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_remaining_data": false, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": 1, "evaluation_duration": 20, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_auto_duration_min_env_steps_per_sample": 100, "evaluation_auto_duration_max_env_steps_per_sample": 2000, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 1, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "offline_evaluation_interval": null, "num_offline_eval_runners": 0, "offline_loss_for_module_fn": null, "offline_evaluation_duration": 1, "offline_evaluation_parallel_to_training": false, "offline_evaluation_timeout_s": 120.0, "num_cpus_per_offline_eval_runner": 1, "num_gpus_per_offline_eval_runner": 0, "custom_resources_per_offline_eval_runner": {}, "restart_failed_offline_eval_runners": true, "ignore_offline_eval_runner_failures": false, "max_num_offline_eval_runner_restarts": 1000, "offline_eval_runner_restore_timeout_s": 1800.0, "max_requests_in_flight_per_offline_eval_runner": 1, "validate_offline_eval_runners_after_construction": true, "offline_eval_runner_health_probe_timeout_s": 30.0, "offline_eval_rl_module_inference_only": false, "broadcast_offline_eval_runner_states": false, "offline_eval_batch_size_per_runner": 256, "dataset_num_iters_per_eval_runner": 1, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "log_gradients": false, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 9, "restart_failed_env_runners": true, "ignore_env_runner_failures": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30.0, "env_runner_restore_timeout_s": 1800.0, "_model_config": {}, "_rl_module_spec": "MultiRLModuleSpec(multi_rl_module_class=<class 'ray.rllib.core.rl_module.multi_rl_module.MultiRLModule'>, observation_space=None, action_space=None, inference_only=False, model_config=None, rl_module_specs={'default_policy': RLModuleSpec(module_class=<class 'source.intrinsic_attention_ppo.rl_modules.DifferentiablePPOModule.DifferentiablePPOModule'>, observation_space=None, action_space=None, inference_only=False, learner_only=False, model_config={'vf_share_layers': True, 'embedding_dim': 62, 'max_seq_len': 6, 'policy_head_hidden_sizes': [32], 'value_head_hidden_sizes': [101], 'embedding_hidden_sizes': [121]}, catalog_class=None, load_state_path=None, model_config_dict=None), 'intrinsic_reward_module': RLModuleSpec(module_class=<class 'source.intrinsic_attention_ppo.rl_modules.IntrinsicAttentionModule.IntrinsicAttentionModule'>, observation_space=None, action_space=None, inference_only=False, learner_only=True, model_config={'intrinsic_reward_network': {'encoder_hidden_sizes': [], 'encoding_dim': 1, 'num_heads': 1, 'head_hidden_sizes': None, 'layers': [{'type': 'attention'}]}, 'extrinsic_value_hidden_layers': [127, 60], 'vf_share_layers': True, 'max_seq_len': 6}, catalog_class=None, load_state_path=None, model_config_dict=None)}, load_state_path=None, modules_to_load=None, module_specs={'default_policy': RLModuleSpec(module_class=<class 'source.intrinsic_attention_ppo.rl_modules.DifferentiablePPOModule.DifferentiablePPOModule'>, observation_space=None, action_space=None, inference_only=False, learner_only=False, model_config={'vf_share_layers': True, 'embedding_dim': 62, 'max_seq_len': 6, 'policy_head_hidden_sizes': [32], 'value_head_hidden_sizes': [101], 'embedding_hidden_sizes': [121]}, catalog_class=None, load_state_path=None, model_config_dict=None), 'intrinsic_reward_module': RLModuleSpec(module_class=<class 'source.intrinsic_attention_ppo.rl_modules.IntrinsicAttentionModule.IntrinsicAttentionModule'>, observation_space=None, action_space=None, inference_only=False, learner_only=True, model_config={'intrinsic_reward_network': {'encoder_hidden_sizes': [], 'encoding_dim': 1, 'num_heads': 1, 'head_hidden_sizes': None, 'layers': [{'type': 'attention'}]}, 'extrinsic_value_hidden_layers': [127, 60], 'vf_share_layers': True, 'max_seq_len': 6}, catalog_class=None, load_state_path=None, model_config_dict=None)})", "algorithm_config_overrides_per_module": {"intrinsic_reward_module": {"lr": 0.0002715581955}}, "_per_module_overrides": {}, "_validate_config": true, "_use_msgpack_checkpoints": false, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "env_task_fn": -1, "enable_connectors": -1, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.161583927863, "kl_target": 0.0201019014258, "vf_loss_coeff": 0.7790510010087, "entropy_coeff": 0.0015431216992, "clip_param": 0.2459212356676, "vf_clip_param": 0.3769744131561, "entropy_coeff_schedule": null, "lr_schedule": null, "sgd_minibatch_size": -1, "vf_share_layers": -1, "differentiable_learner_configs": ["DifferentiableLearnerConfig(learner_class=<class 'source.intrinsic_attention_ppo.learners.IntrinsicAttentionPPOLearner.IntrinsicAttentionPPOLearner'>, learner_connector=None, add_default_connectors_to_learner_pipeline=True, is_multi_agent=False, policies_to_update=['default_policy'], lr=0.0060984166342, num_total_minibatches=0, num_epochs=1, minibatch_size=1000, shuffle_batch_per_epoch=True)"], "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9485408017724, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.callbacks.callbacks.RLlibCallback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 116.90111374855042, "iterations_since_restore": 12, "perf": {"cpu_util_percent": 36.614285714285714, "ram_util_percent": 81.20714285714287}}
{"timers": {"training_iteration": 9.610711663825047, "restore_env_runners": 1.992424487015359e-05, "training_step": 9.610536092552271, "env_runner_sampling_timer": 1.7436610968602377, "learner_update_timer": 7.675645984350483, "synch_weights": 0.0008182641646064449, "restore_eval_env_runners": 9.595039392324464e-06, "evaluation_iteration": 0.14109188945159332, "synch_eval_env_connectors": 0.00013784864943055917, "synch_env_connectors": 4.9189516491887e-06}, "env_runners": {"module_to_env_connector": {"timers": {"connectors": {"listify_data_for_vector_env": 1.0809513780210378e-05, "remove_single_ts_time_rank_from_batch": 1.212932842078755e-05, "tensor_to_numpy": 1.5989654696332716e-05, "un_batch_to_individual_items": 6.820894993907699e-06, "normalize_and_clip_actions": 8.111079841053027e-06, "get_actions": 4.125157046273426e-05}}, "connector_pipeline_timer": 0.00012185051841031708}, "env_to_module_sum_episodes_length_out": 10.36823839457432, "rlmodule_inference_timer": 3.298247558478091e-05, "env_to_module_connector": {"timers": {"connectors": {"add_observations_from_episodes_to_batch": 2.8421267292972803e-06, "add_time_dim_to_batch_and_zero_pad": 7.066056984906223e-06, "numpy_to_tensor": 1.3238036433828374e-05, "batch_individual_items": 1.2774620265891283e-05, "add_states_from_episodes_to_batch": 2.7281497591425683e-06}}, "connector_pipeline_timer": 6.081139853890689e-05}, "episode_return_max": 14.5, "num_env_steps_sampled": 5000.0, "num_episodes": 250.0, "episode_len_max": 20, "sample": 0.005849589042057228, "weights_seq_no": 12.0, "num_episodes_lifetime": -339125.0, "env_to_module_sum_episodes_length_in": 10.36823839457432, "num_agent_steps_sampled": {"default_agent": 5000.0}, "num_env_steps_sampled_lifetime": -6782500.0, "episode_duration_sec_mean": 0.005426048512570559, "episode_return_mean": 5.380000000000001, "num_module_steps_sampled": {"default_policy": 5000.0}, "env_reset_timer": 4.262917809833844e-05, "num_module_steps_sampled_lifetime": {"default_policy": -6782500.0}, "agent_episode_returns_mean": {"default_agent": 5.380000000000001}, "env_step_timer": 1.4368795281677325e-05, "episode_return_min": -5.5, "episode_len_min": 20, "episode_len_mean": 20.0, "num_agent_steps_sampled_lifetime": {"default_agent": -6782500.0}, "module_episode_returns_mean": {"default_policy": 5.380000000000001}, "time_between_sampling": 0.03374390981096728, "num_env_steps_sampled_lifetime_throughput": 3169.823260131233}, "__all_modules__": {"learner_connector_sum_episodes_length_in": 5000.0, "learner_connector": {"connector_pipeline_timer": 0.15348456604429211, "timers": {"connectors": {"add_one_ts_to_episodes_and_truncate": 0.008963745531534437, "add_observations_from_episodes_to_batch": 0.000857333337865907, "add_columns_from_episodes_to_train_batch": 0.04125922118941822, "add_time_dim_to_batch_and_zero_pad": 0.08987698785841602, "add_states_from_episodes_to_batch": 0.0036172935881428592, "batch_individual_items": 0.008711564777624418, "numpy_to_tensor": 6.336894996300071e-05}}}, "learner_connector_sum_episodes_length_out": 5250.0}, "learners": {"intrinsic_reward_module": {"weights_seq_no": 13.0, "num_module_steps_trained_lifetime": 77805, "gradients_default_optimizer_global_norm": 0.0, "module_train_batch_size_mean": 998.1808187151925, "diff_num_grad_updates_vs_sampler_policy": 1.0, "num_trainable_parameters": 8266, "default_optimizer_learning_rate": 0.0002715581955, "total_loss": 0.0, "num_module_steps_trained": 5985, "curr_entropy_coeff": 0.0015431216992, "num_module_steps_trained_lifetime_throughput": 744.6202243619904}, "differentiable_learners": {"intrinsic_attention_ppo_learner": {"intrinsic_reward_module": {"total_loss": 0.0, "num_module_steps_trained": 35910, "diff_num_grad_updates_vs_sampler_policy": 66.0, "weights_seq_no": 78.0, "num_module_steps_trained_lifetime": 466830, "module_train_batch_size_mean": 997.5061250970534}, "default_policy": {"vf_explained_var": 0.0018636584281921387, "total_loss": 0.24862517416477203, "vf_loss": 0.32088643312454224, "vf_loss_unclipped": 51.554176330566406, "weights_seq_no": 78.0, "num_module_steps_trained_lifetime": 466830, "module_train_batch_size_mean": 997.5061250970534, "entropy": 0.6894892454147339, "mean_kl_loss": 1.7793880033423193e-05, "use_intrinsic_rewards": 1.0, "policy_loss": -0.0003006619226653129, "num_module_steps_trained": 35910, "diff_num_grad_updates_vs_sampler_policy": 66.0}, "__all_modules__": {"num_env_steps_trained_lifetime": 2808000, "num_module_steps_trained_lifetime": 933660, "num_module_steps_trained": 71820, "num_env_steps_trained": 216000, "num_env_steps_trained_lifetime_throughput": 52164.29633423401}}}, "default_policy": {"curr_kl_coeff": 1.9724600861081854e-05, "num_module_steps_trained_lifetime": 77805, "module_train_batch_size_mean": 998.1808187151925, "entropy": 0.6894674897193909, "num_trainable_parameters": 16595, "mean_kl_loss": 1.9358065401320346e-05, "use_intrinsic_rewards": 0.0, "policy_loss": -0.00031229565502144396, "num_module_steps_trained": 5985, "diff_num_grad_updates_vs_sampler_policy": 1.0, "vf_explained_var": 6.592273712158203e-05, "total_loss": 0.24831633269786835, "vf_loss": 0.32050859928131104, "curr_entropy_coeff": 0.0015431216992, "vf_loss_unclipped": 51.85407257080078, "weights_seq_no": 13.0, "num_module_steps_trained_lifetime_throughput": 744.6126978278098}, "__all_modules__": {"num_module_steps_trained": 11970, "num_non_trainable_parameters": 0, "num_env_steps_trained": 36000, "num_env_steps_trained_lifetime": 468000, "num_module_steps_trained_lifetime": 155610, "num_trainable_parameters": 24861, "num_env_steps_trained_lifetime_throughput": 4482.787678844163, "num_module_steps_trained_throughput": 23554485.818083014, "num_module_steps_trained_lifetime_throughput": 12912178.038755935}, "IntrinsicAttentionMask": [[[0.16544243693351746, 0.16595621407032013, 0.16592641174793243, 0.16758839786052704, 0.16755829751491547, 0.1675281971693039], [0.1651851236820221, 0.1658063530921936, 0.1657702922821045, 0.16778255999088287, 0.16774608194828033, 0.1677095890045166], [0.16520002484321594, 0.16581502556800842, 0.16577932238578796, 0.16777130961418152, 0.16773518919944763, 0.16769908368587494], [0.16437408328056335, 0.16533273458480835, 0.16527704894542694, 0.16839544475078583, 0.16833871603012085, 0.16828201711177826], [0.164388969540596, 0.16534143686294556, 0.1652861088514328, 0.16838419437408447, 0.16832783818244934, 0.1682715117931366], [0.16440382599830627, 0.16535013914108276, 0.16529516875743866, 0.16837294399738312, 0.16831696033477783, 0.16826100647449493]], [[0.16745243966579437, 0.16742676496505737, 0.16595759987831116, 0.16593214869499207, 0.16734977066516876, 0.16588127613067627], [0.1674412041902542, 0.16741588711738586, 0.16596773266792297, 0.16594263911247253, 0.1673400104045868, 0.16589249670505524], [0.16679544746875763, 0.16679124534130096, 0.16655045747756958, 0.1665462702512741, 0.16677866876125336, 0.16653791069984436], [0.16678421199321747, 0.16678038239479065, 0.1665605902671814, 0.16655677556991577, 0.1667689085006714, 0.16654913127422333], [0.16740751266479492, 0.1673833131790161, 0.165998175740242, 0.16597416996955872, 0.16731072962284088, 0.16592618823051453], [0.16676174104213715, 0.16675865650177002, 0.16658087074756622, 0.1665777713060379, 0.16674937307834625, 0.16657158732414246]], [[0.16494083404541016, 0.16605596244335175, 0.16602614521980286, 0.16768912971019745, 0.1676589995622635, 0.16762888431549072], [0.16415466368198395, 0.16577497124671936, 0.1657315492630005, 0.1681569665670395, 0.16811293363571167, 0.16806891560554504], [0.1641755849123001, 0.16578246653079987, 0.16573941707611084, 0.16814449429512024, 0.16810083389282227, 0.16805718839168549], [0.16301696002483368, 0.16536515951156616, 0.165302112698555, 0.16883628070354462, 0.1687719076871872, 0.16870756447315216], [0.16303779184818268, 0.16537269949913025, 0.16531001031398773, 0.16882380843162537, 0.16875982284545898, 0.1686958521604538], [0.16305862367153168, 0.16538023948669434, 0.16531790792942047, 0.16881133615970612, 0.1687477082014084, 0.16868412494659424]], [[0.16704069077968597, 0.1670224964618683, 0.16634635627269745, 0.16632825136184692, 0.16733664274215698, 0.16592557728290558], [0.16703316569328308, 0.16701532900333405, 0.16635282337665558, 0.1663350611925125, 0.16732314229011536, 0.16594046354293823], [0.16675300896167755, 0.16674882173538208, 0.16659285128116608, 0.1665886640548706, 0.16682112216949463, 0.16649553179740906], [0.16674546897411346, 0.16674165427684784, 0.16659928858280182, 0.166595458984375, 0.1668076366186142, 0.1665104478597641], [0.16716283559799194, 0.16713866591453552, 0.16624145209789276, 0.16621741652488708, 0.16755594313144684, 0.16568367183208466], [0.16657789051532745, 0.16658219695091248, 0.1667424738407135, 0.16674678027629852, 0.16650798916816711, 0.16684263944625854]], [[0.1650412678718567, 0.1661570966243744, 0.16612723469734192, 0.1677912473678589, 0.16776110231876373, 0.1671219766139984], [0.16430070996284485, 0.16592244803905487, 0.1658790111541748, 0.16830657422542572, 0.1682625114917755, 0.1673288494348526], [0.16432040929794312, 0.1659287065267563, 0.16588562726974487, 0.1682928204536438, 0.16824913024902344, 0.16732333600521088], [0.16322875022888184, 0.16558000445365906, 0.16551686823368073, 0.16905562579631805, 0.16899117827415466, 0.16762754321098328], [0.16324838995933533, 0.16558630764484406, 0.16552352905273438, 0.16904187202453613, 0.1689777970314026, 0.16762208938598633], [0.16366596519947052, 0.16572006046772003, 0.16566497087478638, 0.1687496453523636, 0.16869354248046875, 0.16750581562519073]], [[0.16753865778446198, 0.16751296818256378, 0.1655283123254776, 0.1660175770521164, 0.1674359291791916, 0.1659666746854782], [0.16752617061138153, 0.16750085353851318, 0.1655445396900177, 0.16602684557437897, 0.16742491722106934, 0.1659766584634781], [0.1665571928024292, 0.16656041145324707, 0.16680987179279327, 0.1667480617761612, 0.1665700227022171, 0.16675448417663574], [0.16679711639881134, 0.16679328680038452, 0.1664961278438568, 0.16656966507434845, 0.16678181290626526, 0.166562020778656], [0.16748876869678497, 0.16746455430984497, 0.16559331119060516, 0.16605472564697266, 0.16739194095134735, 0.16600672900676727], [0.16677217185497284, 0.1667690873146057, 0.16652870178222656, 0.1665882021188736, 0.16675978899002075, 0.16658201813697815]]]}, "num_training_step_calls_per_iteration": 1, "evaluation": {"env_runners": {"episode_len_min": 20, "env_to_module_connector": {"timers": {"connectors": {"numpy_to_tensor": 1.1792005743228475e-05, "add_states_from_episodes_to_batch": 2.6707188157383606e-06, "batch_individual_items": 1.2286537326545062e-05, "add_time_dim_to_batch_and_zero_pad": 7.031784787364851e-06, "add_observations_from_episodes_to_batch": 2.7962878649931523e-06}}, "connector_pipeline_timer": 5.822164680950485e-05}, "module_to_env_connector": {"timers": {"connectors": {"tensor_to_numpy": 1.475023866650271e-05, "un_batch_to_individual_items": 6.470081740945859e-06, "normalize_and_clip_actions": 7.727172596708509e-06, "get_actions": 3.515048279940005e-05, "remove_single_ts_time_rank_from_batch": 1.1712614860398277e-05, "listify_data_for_vector_env": 1.0323691597061264e-05}}, "connector_pipeline_timer": 0.00011160999828766127}, "num_env_steps_sampled": 400, "episode_len_max": 20, "num_agent_steps_sampled": {"default_agent": 400}, "weights_seq_no": 13.0, "num_env_steps_sampled_lifetime": 65400, "episode_duration_sec_mean": 0.005148358782753349, "episode_return_mean": 0.3, "env_reset_timer": 0.00015980371872746128, "module_episode_returns_mean": {"default_policy": 0.3}, "rlmodule_inference_timer": 3.0040643827775815e-05, "episode_return_max": 15.5, "env_to_module_sum_episodes_length_in": 10.368238394574323, "num_module_steps_sampled": {"default_policy": 400}, "agent_episode_returns_mean": {"default_agent": 0.3}, "num_agent_steps_sampled_lifetime": {"default_agent": 5200}, "num_module_steps_sampled_lifetime": {"default_policy": 5200}, "env_to_module_sum_episodes_length_out": 10.368238394574323, "num_episodes": 20, "num_episodes_lifetime": 260, "episode_return_min": -13.5, "sample": 0.13426450577792745, "env_step_timer": 1.3475478910092642e-05, "episode_len_mean": 20.0, "time_between_sampling": 9.64407490799211}, "num_healthy_workers": 1, "actor_manager_num_outstanding_async_reqs": 0, "num_remote_worker_restarts": 0}, "num_env_steps_sampled_lifetime": -6782500.0, "fault_tolerance": {"num_healthy_workers": 0, "num_remote_worker_restarts": 0}, "env_runner_group": {"actor_manager_num_outstanding_async_reqs": 0}, "done": false, "training_iteration": 13, "trial_id": "b17e2_00000", "date": "2025-08-11_18-45-16", "timestamp": 1754930716, "time_this_iter_s": 9.835487127304077, "time_total_s": 126.73660087585449, "pid": 11680, "hostname": "Mac", "node_ip": "127.0.0.1", "config": {"exploration_config": {}, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 2, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "env": "Umbrella", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": false, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 0, "create_local_env_runner": true, "num_envs_per_env_runner": 1, "gym_env_vectorize_mode": "SYNC", "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "episodes_to_numpy": true, "max_requests_in_flight_per_env_runner": 1, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "merge_env_runner_states": "training_only", "broadcast_env_runner_states": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "complete_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "sampler_perf_stats_ema_coef": null, "_is_online": true, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": "auto", "num_aggregator_actors_per_learner": 0, "max_requests_in_flight_per_aggregator_actor": 3, "local_gpu_idx": 0, "max_requests_in_flight_per_learner": 3, "gamma": 1, "lr": 0.0002715581955, "grad_clip": 0.5, "grad_clip_by": "global_norm", "_train_batch_size_per_learner": 5000, "train_batch_size": 4000, "num_epochs": 1, "minibatch_size": 1000, "shuffle_batch_per_epoch": true, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "log_std_clip_param": 20.0, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "_disable_preprocessor_api": false, "_disable_action_flattening": false}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {"intrinsic_reward_coeff": 0.2795015916508}, "optimizer": {}, "_learner_class": "<class 'source.intrinsic_attention_ppo.learners.IntrinsicAttentionMetaLearner.IntrinsicAttentionMetaLearner'>", "callbacks_on_algorithm_init": null, "callbacks_on_env_runners_recreated": null, "callbacks_on_offline_eval_runners_recreated": null, "callbacks_on_checkpoint_loaded": null, "callbacks_on_environment_created": null, "callbacks_on_episode_created": null, "callbacks_on_episode_start": null, "callbacks_on_episode_step": null, "callbacks_on_episode_end": null, "callbacks_on_evaluate_start": null, "callbacks_on_evaluate_end": null, "callbacks_on_evaluate_offline_start": null, "callbacks_on_evaluate_offline_end": null, "callbacks_on_sample_end": null, "callbacks_on_train_result": null, "explore": true, "enable_rl_module_and_learner": true, "enable_env_runner_and_connector_v2": true, "_prior_exploration_config": {"type": "StochasticSampling"}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x13c0118a0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "offline_data_class": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_read_batch_size": null, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "materialize_data": false, "materialize_mapped_data": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "ignore_final_observation": false, "prelearner_class": null, "prelearner_buffer_class": null, "prelearner_buffer_kwargs": {}, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_remaining_data": false, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": 1, "evaluation_duration": 20, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_auto_duration_min_env_steps_per_sample": 100, "evaluation_auto_duration_max_env_steps_per_sample": 2000, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 1, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "offline_evaluation_interval": null, "num_offline_eval_runners": 0, "offline_loss_for_module_fn": null, "offline_evaluation_duration": 1, "offline_evaluation_parallel_to_training": false, "offline_evaluation_timeout_s": 120.0, "num_cpus_per_offline_eval_runner": 1, "num_gpus_per_offline_eval_runner": 0, "custom_resources_per_offline_eval_runner": {}, "restart_failed_offline_eval_runners": true, "ignore_offline_eval_runner_failures": false, "max_num_offline_eval_runner_restarts": 1000, "offline_eval_runner_restore_timeout_s": 1800.0, "max_requests_in_flight_per_offline_eval_runner": 1, "validate_offline_eval_runners_after_construction": true, "offline_eval_runner_health_probe_timeout_s": 30.0, "offline_eval_rl_module_inference_only": false, "broadcast_offline_eval_runner_states": false, "offline_eval_batch_size_per_runner": 256, "dataset_num_iters_per_eval_runner": 1, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "log_gradients": false, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 9, "restart_failed_env_runners": true, "ignore_env_runner_failures": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30.0, "env_runner_restore_timeout_s": 1800.0, "_model_config": {}, "_rl_module_spec": "MultiRLModuleSpec(multi_rl_module_class=<class 'ray.rllib.core.rl_module.multi_rl_module.MultiRLModule'>, observation_space=None, action_space=None, inference_only=False, model_config=None, rl_module_specs={'default_policy': RLModuleSpec(module_class=<class 'source.intrinsic_attention_ppo.rl_modules.DifferentiablePPOModule.DifferentiablePPOModule'>, observation_space=None, action_space=None, inference_only=False, learner_only=False, model_config={'vf_share_layers': True, 'embedding_dim': 62, 'max_seq_len': 6, 'policy_head_hidden_sizes': [32], 'value_head_hidden_sizes': [101], 'embedding_hidden_sizes': [121]}, catalog_class=None, load_state_path=None, model_config_dict=None), 'intrinsic_reward_module': RLModuleSpec(module_class=<class 'source.intrinsic_attention_ppo.rl_modules.IntrinsicAttentionModule.IntrinsicAttentionModule'>, observation_space=None, action_space=None, inference_only=False, learner_only=True, model_config={'intrinsic_reward_network': {'encoder_hidden_sizes': [], 'encoding_dim': 1, 'num_heads': 1, 'head_hidden_sizes': None, 'layers': [{'type': 'attention'}]}, 'extrinsic_value_hidden_layers': [127, 60], 'vf_share_layers': True, 'max_seq_len': 6}, catalog_class=None, load_state_path=None, model_config_dict=None)}, load_state_path=None, modules_to_load=None, module_specs={'default_policy': RLModuleSpec(module_class=<class 'source.intrinsic_attention_ppo.rl_modules.DifferentiablePPOModule.DifferentiablePPOModule'>, observation_space=None, action_space=None, inference_only=False, learner_only=False, model_config={'vf_share_layers': True, 'embedding_dim': 62, 'max_seq_len': 6, 'policy_head_hidden_sizes': [32], 'value_head_hidden_sizes': [101], 'embedding_hidden_sizes': [121]}, catalog_class=None, load_state_path=None, model_config_dict=None), 'intrinsic_reward_module': RLModuleSpec(module_class=<class 'source.intrinsic_attention_ppo.rl_modules.IntrinsicAttentionModule.IntrinsicAttentionModule'>, observation_space=None, action_space=None, inference_only=False, learner_only=True, model_config={'intrinsic_reward_network': {'encoder_hidden_sizes': [], 'encoding_dim': 1, 'num_heads': 1, 'head_hidden_sizes': None, 'layers': [{'type': 'attention'}]}, 'extrinsic_value_hidden_layers': [127, 60], 'vf_share_layers': True, 'max_seq_len': 6}, catalog_class=None, load_state_path=None, model_config_dict=None)})", "algorithm_config_overrides_per_module": {"intrinsic_reward_module": {"lr": 0.0002715581955}}, "_per_module_overrides": {}, "_validate_config": true, "_use_msgpack_checkpoints": false, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "env_task_fn": -1, "enable_connectors": -1, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.161583927863, "kl_target": 0.0201019014258, "vf_loss_coeff": 0.7790510010087, "entropy_coeff": 0.0015431216992, "clip_param": 0.2459212356676, "vf_clip_param": 0.3769744131561, "entropy_coeff_schedule": null, "lr_schedule": null, "sgd_minibatch_size": -1, "vf_share_layers": -1, "differentiable_learner_configs": ["DifferentiableLearnerConfig(learner_class=<class 'source.intrinsic_attention_ppo.learners.IntrinsicAttentionPPOLearner.IntrinsicAttentionPPOLearner'>, learner_connector=None, add_default_connectors_to_learner_pipeline=True, is_multi_agent=False, policies_to_update=['default_policy'], lr=0.0060984166342, num_total_minibatches=0, num_epochs=1, minibatch_size=1000, shuffle_batch_per_epoch=True)"], "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9485408017724, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.callbacks.callbacks.RLlibCallback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 126.73660087585449, "iterations_since_restore": 13, "perf": {"cpu_util_percent": 34.48571428571429, "ram_util_percent": 82.45714285714284}}
{"timers": {"training_iteration": 9.609078261347063, "restore_env_runners": 1.98054221257701e-05, "training_step": 9.608902571217445, "env_runner_sampling_timer": 1.7424910571423795, "learner_update_timer": 7.675077426597584, "synch_weights": 0.0008188227734548754, "restore_eval_env_runners": 9.719499291369372e-06, "evaluation_iteration": 0.14085788138704053, "synch_eval_env_connectors": 0.00013814307322981777, "synch_env_connectors": 4.907261836163706e-06}, "env_runners": {"module_to_env_connector": {"timers": {"connectors": {"listify_data_for_vector_env": 1.0514008311030813e-05, "remove_single_ts_time_rank_from_batch": 1.1875648913205314e-05, "tensor_to_numpy": 1.5323453251925523e-05, "un_batch_to_individual_items": 6.666191629433067e-06, "normalize_and_clip_actions": 7.932698462942658e-06, "get_actions": 3.965153917119362e-05}}, "connector_pipeline_timer": 0.00011809850005107294}, "env_to_module_sum_episodes_length_out": 10.36823839457432, "rlmodule_inference_timer": 3.16962054539318e-05, "env_to_module_connector": {"timers": {"connectors": {"add_observations_from_episodes_to_batch": 2.7987881032133874e-06, "add_time_dim_to_batch_and_zero_pad": 6.890359804753837e-06, "numpy_to_tensor": 1.272346897941918e-05, "batch_individual_items": 1.2422582280264772e-05, "add_states_from_episodes_to_batch": 2.678975741599421e-06}}, "connector_pipeline_timer": 5.9336381000771225e-05}, "episode_return_max": 14.5, "num_env_steps_sampled": 5000.0, "num_episodes": 250.0, "episode_len_max": 20, "sample": 0.005653492056216515, "weights_seq_no": 13.0, "num_episodes_lifetime": -370000.0, "env_to_module_sum_episodes_length_in": 10.36823839457432, "num_agent_steps_sampled": {"default_agent": 5000.0}, "num_env_steps_sampled_lifetime": -7400000.0, "episode_duration_sec_mean": 0.005264657681807873, "episode_return_mean": 4.980000000000002, "num_module_steps_sampled": {"default_policy": 5000.0}, "env_reset_timer": 3.951815100244067e-05, "num_module_steps_sampled_lifetime": {"default_policy": -7400000.0}, "agent_episode_returns_mean": {"default_agent": 4.980000000000002}, "env_step_timer": 1.3940286582794364e-05, "episode_return_min": -5.5, "episode_len_min": 20, "episode_len_mean": 20.0, "num_agent_steps_sampled_lifetime": {"default_agent": -7400000.0}, "module_episode_returns_mean": {"default_policy": 4.980000000000002}, "time_between_sampling": 0.033356427889156784, "num_env_steps_sampled_lifetime_throughput": 3248.437288878943}, "__all_modules__": {"learner_connector_sum_episodes_length_in": 5000.0, "learner_connector": {"connector_pipeline_timer": 0.15347787872421947, "timers": {"connectors": {"add_one_ts_to_episodes_and_truncate": 0.008962823075365852, "add_observations_from_episodes_to_batch": 0.0008579141649942712, "add_columns_from_episodes_to_train_batch": 0.04126702605753943, "add_time_dim_to_batch_and_zero_pad": 0.08987430338974507, "add_states_from_episodes_to_batch": 0.00361805232229946, "batch_individual_items": 0.008699636630181586, "numpy_to_tensor": 6.330109015019121e-05}}}, "learner_connector_sum_episodes_length_out": 5250.0}, "learners": {"intrinsic_reward_module": {"weights_seq_no": 14.0, "num_module_steps_trained_lifetime": 83790, "gradients_default_optimizer_global_norm": 0.0, "module_train_batch_size_mean": 998.1405362012929, "diff_num_grad_updates_vs_sampler_policy": 1.0, "num_trainable_parameters": 8266, "default_optimizer_learning_rate": 0.0002715581955, "total_loss": 0.0, "num_module_steps_trained": 5985, "curr_entropy_coeff": 0.0015431216992, "num_module_steps_trained_lifetime_throughput": 742.8072306652148}, "differentiable_learners": {"intrinsic_attention_ppo_learner": {"intrinsic_reward_module": {"total_loss": 0.0, "num_module_steps_trained": 35910, "diff_num_grad_updates_vs_sampler_policy": 71.0, "weights_seq_no": 84.0, "num_module_steps_trained_lifetime": 502740, "module_train_batch_size_mean": 997.501977255973}, "default_policy": {"vf_explained_var": 0.0016959309577941895, "total_loss": 0.2485518753528595, "vf_loss": 0.32079949975013733, "vf_loss_unclipped": 47.54023742675781, "weights_seq_no": 84.0, "num_module_steps_trained_lifetime": 502740, "module_train_batch_size_mean": 997.501977255973, "entropy": 0.6885939836502075, "mean_kl_loss": 2.4027576728258282e-05, "use_intrinsic_rewards": 1.0, "policy_loss": -0.0003086142532993108, "num_module_steps_trained": 35910, "diff_num_grad_updates_vs_sampler_policy": 71.0}, "__all_modules__": {"num_env_steps_trained_lifetime": 3024000, "num_module_steps_trained_lifetime": 1005480, "num_module_steps_trained": 71820, "num_env_steps_trained": 216000, "num_env_steps_trained_lifetime_throughput": 51330.590182937754}}}, "default_policy": {"curr_kl_coeff": 9.862300430540927e-06, "num_module_steps_trained_lifetime": 83790, "module_train_batch_size_mean": 998.1405362012929, "entropy": 0.6885724663734436, "num_trainable_parameters": 16595, "mean_kl_loss": 2.5607288989704102e-05, "use_intrinsic_rewards": 0.0, "policy_loss": -0.00031807401683181524, "num_module_steps_trained": 5985, "diff_num_grad_updates_vs_sampler_policy": 1.0, "vf_explained_var": -0.0001506805419921875, "total_loss": 0.2483125478029251, "vf_loss": 0.3205093741416931, "curr_entropy_coeff": 0.0015431216992, "vf_loss_unclipped": 47.72337341308594, "weights_seq_no": 14.0, "num_module_steps_trained_lifetime_throughput": 742.8002340650324}, "__all_modules__": {"num_module_steps_trained": 11970, "num_non_trainable_parameters": 0, "num_env_steps_trained": 36000, "num_env_steps_trained_lifetime": 504000, "num_module_steps_trained_lifetime": 167580, "num_trainable_parameters": 24861, "num_env_steps_trained_lifetime_throughput": 4471.7357332927, "num_module_steps_trained_throughput": 22983656.949038126, "num_module_steps_trained_lifetime_throughput": 12892671.727008637}, "IntrinsicAttentionMask": [[[0.16691823303699493, 0.16562557220458984, 0.16605731844902039, 0.16730809211730957, 0.1672854721546173, 0.16680538654327393], [0.16668392717838287, 0.16659536957740784, 0.1666250228881836, 0.1667105108499527, 0.16670897603034973, 0.16667622327804565], [0.166762575507164, 0.1662702113389969, 0.16643492877483368, 0.16691060364246368, 0.16690202057361603, 0.1667196899652481], [0.16698819398880005, 0.16533523797988892, 0.16588692367076874, 0.16748739778995514, 0.1674584150314331, 0.1668437421321869], [0.16698414087295532, 0.16535207629203796, 0.16589681804180145, 0.16747701168060303, 0.16744838654994965, 0.1668415367603302], [0.16689792275428772, 0.16570977866649628, 0.1661067008972168, 0.16725610196590424, 0.16723531484603882, 0.16679422557353973]], [[0.16872745752334595, 0.1674361377954483, 0.1651972085237503, 0.16513748466968536, 0.16848360002040863, 0.16501811146736145], [0.16846142709255219, 0.16733768582344055, 0.1653866469860077, 0.1653345674276352, 0.16824929416179657, 0.16523043811321259], [0.1679956316947937, 0.1671646535396576, 0.16571848094463348, 0.16567981243133545, 0.16783888638019562, 0.16560250520706177], [0.16798314452171326, 0.1671600192785263, 0.1657274067401886, 0.16568909585475922, 0.16782787442207336, 0.16561250388622284], [0.16867734491825104, 0.16741760075092316, 0.165232852101326, 0.16517457365989685, 0.16843946278095245, 0.16505806148052216], [0.1679581254720688, 0.16715069115161896, 0.16574522852897644, 0.16570763289928436, 0.16780582070350647, 0.1656324863433838]], [[0.16524165868759155, 0.16575480997562408, 0.16632893681526184, 0.1673850119113922, 0.16735494136810303, 0.1679346263408661], [0.16494236886501312, 0.16556265950202942, 0.16625717282295227, 0.16753599047660828, 0.16749955713748932, 0.16820219159126282], [0.16460895538330078, 0.16534839570522308, 0.1661769151687622, 0.167704239487648, 0.1676606982946396, 0.16850081086158752], [0.16399963200092316, 0.16495607793331146, 0.16602928936481476, 0.1680118292570114, 0.16795523464679718, 0.16904795169830322], [0.16401690244674683, 0.16496722400188446, 0.16603349149227142, 0.168003112077713, 0.16794687509536743, 0.16903240978717804], [0.16368451714515686, 0.16475284099578857, 0.16595245897769928, 0.16817094385623932, 0.16810756921768188, 0.1693316102027893]], [[0.16753937304019928, 0.1675136834383011, 0.1660437434911728, 0.1660182923078537, 0.1669175922870636, 0.16596737504005432], [0.16752687096595764, 0.1675015538930893, 0.16605263948440552, 0.16602754592895508, 0.16691401600837708, 0.1659773588180542], [0.16680960357189178, 0.16680540144443512, 0.16656459867954254, 0.16656041145324707, 0.16670796275138855, 0.16655203700065613], [0.16679713129997253, 0.16679330170154572, 0.16657349467277527, 0.16656967997550964, 0.16670435667037964, 0.1665620356798172], [0.16723662614822388, 0.167219877243042, 0.1662597507238388, 0.16624309122562408, 0.1668308824300766, 0.16620978713035583], [0.16677218675613403, 0.1667691022157669, 0.16659130156040192, 0.1665882170200348, 0.166697159409523, 0.16658203303813934]], [[0.16513994336128235, 0.16565276682376862, 0.1656230241060257, 0.16789156198501587, 0.16786140203475952, 0.16783124208450317], [0.16481907665729523, 0.1654389202594757, 0.16540293395519257, 0.16814959049224854, 0.16811302304267883, 0.16807647049427032], [0.16483765840530396, 0.1654512882232666, 0.1654156744480133, 0.1681346297264099, 0.16809843480587006, 0.1680622547864914], [0.16343258321285248, 0.16451171040534973, 0.16444899141788483, 0.1692667454481125, 0.16920220851898193, 0.16913770139217377], [0.16345110535621643, 0.1645241379737854, 0.16446177661418915, 0.16925179958343506, 0.16918765008449554, 0.16912351548671722], [0.16346964240074158, 0.16453656554222107, 0.16447456181049347, 0.16923685371875763, 0.16917307674884796, 0.1691093146800995]], [[0.16710196435451508, 0.1670837551355362, 0.16604068875312805, 0.16602259874343872, 0.16739802062511444, 0.1663530021905899], [0.1670932173728943, 0.16707538068294525, 0.16605329513549805, 0.16603556275367737, 0.16738329827785492, 0.1663593202829361], [0.1665896773338318, 0.16659288108348846, 0.1667773723602295, 0.16678057610988617, 0.1665375679731369, 0.16672198474407196], [0.1665809005498886, 0.16658447682857513, 0.1667899638414383, 0.16679354012012482, 0.16652287542819977, 0.16672827303409576], [0.16724413633346558, 0.16721995174884796, 0.1658361554145813, 0.1658121794462204, 0.167637437582016, 0.16625018417835236], [0.16674084961414337, 0.16673776507377625, 0.16655999422073364, 0.16655690968036652, 0.1667911410331726, 0.16661332547664642]]]}, "num_training_step_calls_per_iteration": 1, "evaluation": {"env_runners": {"episode_len_min": 20, "env_to_module_connector": {"timers": {"connectors": {"numpy_to_tensor": 1.2636773047118971e-05, "add_states_from_episodes_to_batch": 2.8588925525098134e-06, "batch_individual_items": 1.2706561369772028e-05, "add_time_dim_to_batch_and_zero_pad": 7.371336194231604e-06, "add_observations_from_episodes_to_batch": 2.970939176354887e-06}}, "connector_pipeline_timer": 6.089971514574798e-05}, "module_to_env_connector": {"timers": {"connectors": {"tensor_to_numpy": 1.5442395947662755e-05, "un_batch_to_individual_items": 6.7121498081792854e-06, "normalize_and_clip_actions": 8.250287237117028e-06, "get_actions": 3.920564005811353e-05, "remove_single_ts_time_rank_from_batch": 1.2255753160131252e-05, "listify_data_for_vector_env": 1.0803923356998629e-05}}, "connector_pipeline_timer": 0.00011907651432173697}, "num_env_steps_sampled": 400, "episode_len_max": 20, "num_agent_steps_sampled": {"default_agent": 400}, "weights_seq_no": 14.0, "num_env_steps_sampled_lifetime": 70400, "episode_duration_sec_mean": 0.005169368783244863, "episode_return_mean": 0.3, "env_reset_timer": 0.00015889318153646138, "module_episode_returns_mean": {"default_policy": 0.3}, "rlmodule_inference_timer": 3.3044307679423034e-05, "episode_return_max": 15.5, "env_to_module_sum_episodes_length_in": 10.368238394574323, "num_module_steps_sampled": {"default_policy": 400}, "agent_episode_returns_mean": {"default_agent": 0.3}, "num_agent_steps_sampled_lifetime": {"default_agent": 5600}, "num_module_steps_sampled_lifetime": {"default_policy": 5600}, "env_to_module_sum_episodes_length_out": 10.368238394574323, "num_episodes": 20, "num_episodes_lifetime": 280, "episode_return_min": -13.5, "sample": 0.13406078656006218, "env_step_timer": 1.458081203665008e-05, "episode_len_mean": 20.0, "time_between_sampling": 9.642338798912316}, "num_healthy_workers": 1, "actor_manager_num_outstanding_async_reqs": 0, "num_remote_worker_restarts": 0}, "num_env_steps_sampled_lifetime": -7400000.0, "fault_tolerance": {"num_healthy_workers": 0, "num_remote_worker_restarts": 0}, "env_runner_group": {"actor_manager_num_outstanding_async_reqs": 0}, "done": false, "training_iteration": 14, "trial_id": "b17e2_00000", "date": "2025-08-11_18-45-26", "timestamp": 1754930726, "time_this_iter_s": 9.569722890853882, "time_total_s": 136.30632376670837, "pid": 11680, "hostname": "Mac", "node_ip": "127.0.0.1", "config": {"exploration_config": {}, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 2, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "env": "Umbrella", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": false, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 0, "create_local_env_runner": true, "num_envs_per_env_runner": 1, "gym_env_vectorize_mode": "SYNC", "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "episodes_to_numpy": true, "max_requests_in_flight_per_env_runner": 1, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "merge_env_runner_states": "training_only", "broadcast_env_runner_states": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "complete_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "sampler_perf_stats_ema_coef": null, "_is_online": true, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": "auto", "num_aggregator_actors_per_learner": 0, "max_requests_in_flight_per_aggregator_actor": 3, "local_gpu_idx": 0, "max_requests_in_flight_per_learner": 3, "gamma": 1, "lr": 0.0002715581955, "grad_clip": 0.5, "grad_clip_by": "global_norm", "_train_batch_size_per_learner": 5000, "train_batch_size": 4000, "num_epochs": 1, "minibatch_size": 1000, "shuffle_batch_per_epoch": true, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "log_std_clip_param": 20.0, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "_disable_preprocessor_api": false, "_disable_action_flattening": false}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {"intrinsic_reward_coeff": 0.2795015916508}, "optimizer": {}, "_learner_class": "<class 'source.intrinsic_attention_ppo.learners.IntrinsicAttentionMetaLearner.IntrinsicAttentionMetaLearner'>", "callbacks_on_algorithm_init": null, "callbacks_on_env_runners_recreated": null, "callbacks_on_offline_eval_runners_recreated": null, "callbacks_on_checkpoint_loaded": null, "callbacks_on_environment_created": null, "callbacks_on_episode_created": null, "callbacks_on_episode_start": null, "callbacks_on_episode_step": null, "callbacks_on_episode_end": null, "callbacks_on_evaluate_start": null, "callbacks_on_evaluate_end": null, "callbacks_on_evaluate_offline_start": null, "callbacks_on_evaluate_offline_end": null, "callbacks_on_sample_end": null, "callbacks_on_train_result": null, "explore": true, "enable_rl_module_and_learner": true, "enable_env_runner_and_connector_v2": true, "_prior_exploration_config": {"type": "StochasticSampling"}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x13c0118a0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "offline_data_class": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_read_batch_size": null, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "materialize_data": false, "materialize_mapped_data": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "ignore_final_observation": false, "prelearner_class": null, "prelearner_buffer_class": null, "prelearner_buffer_kwargs": {}, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_remaining_data": false, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": 1, "evaluation_duration": 20, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_auto_duration_min_env_steps_per_sample": 100, "evaluation_auto_duration_max_env_steps_per_sample": 2000, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 1, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "offline_evaluation_interval": null, "num_offline_eval_runners": 0, "offline_loss_for_module_fn": null, "offline_evaluation_duration": 1, "offline_evaluation_parallel_to_training": false, "offline_evaluation_timeout_s": 120.0, "num_cpus_per_offline_eval_runner": 1, "num_gpus_per_offline_eval_runner": 0, "custom_resources_per_offline_eval_runner": {}, "restart_failed_offline_eval_runners": true, "ignore_offline_eval_runner_failures": false, "max_num_offline_eval_runner_restarts": 1000, "offline_eval_runner_restore_timeout_s": 1800.0, "max_requests_in_flight_per_offline_eval_runner": 1, "validate_offline_eval_runners_after_construction": true, "offline_eval_runner_health_probe_timeout_s": 30.0, "offline_eval_rl_module_inference_only": false, "broadcast_offline_eval_runner_states": false, "offline_eval_batch_size_per_runner": 256, "dataset_num_iters_per_eval_runner": 1, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "log_gradients": false, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 9, "restart_failed_env_runners": true, "ignore_env_runner_failures": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30.0, "env_runner_restore_timeout_s": 1800.0, "_model_config": {}, "_rl_module_spec": "MultiRLModuleSpec(multi_rl_module_class=<class 'ray.rllib.core.rl_module.multi_rl_module.MultiRLModule'>, observation_space=None, action_space=None, inference_only=False, model_config=None, rl_module_specs={'default_policy': RLModuleSpec(module_class=<class 'source.intrinsic_attention_ppo.rl_modules.DifferentiablePPOModule.DifferentiablePPOModule'>, observation_space=None, action_space=None, inference_only=False, learner_only=False, model_config={'vf_share_layers': True, 'embedding_dim': 62, 'max_seq_len': 6, 'policy_head_hidden_sizes': [32], 'value_head_hidden_sizes': [101], 'embedding_hidden_sizes': [121]}, catalog_class=None, load_state_path=None, model_config_dict=None), 'intrinsic_reward_module': RLModuleSpec(module_class=<class 'source.intrinsic_attention_ppo.rl_modules.IntrinsicAttentionModule.IntrinsicAttentionModule'>, observation_space=None, action_space=None, inference_only=False, learner_only=True, model_config={'intrinsic_reward_network': {'encoder_hidden_sizes': [], 'encoding_dim': 1, 'num_heads': 1, 'head_hidden_sizes': None, 'layers': [{'type': 'attention'}]}, 'extrinsic_value_hidden_layers': [127, 60], 'vf_share_layers': True, 'max_seq_len': 6}, catalog_class=None, load_state_path=None, model_config_dict=None)}, load_state_path=None, modules_to_load=None, module_specs={'default_policy': RLModuleSpec(module_class=<class 'source.intrinsic_attention_ppo.rl_modules.DifferentiablePPOModule.DifferentiablePPOModule'>, observation_space=None, action_space=None, inference_only=False, learner_only=False, model_config={'vf_share_layers': True, 'embedding_dim': 62, 'max_seq_len': 6, 'policy_head_hidden_sizes': [32], 'value_head_hidden_sizes': [101], 'embedding_hidden_sizes': [121]}, catalog_class=None, load_state_path=None, model_config_dict=None), 'intrinsic_reward_module': RLModuleSpec(module_class=<class 'source.intrinsic_attention_ppo.rl_modules.IntrinsicAttentionModule.IntrinsicAttentionModule'>, observation_space=None, action_space=None, inference_only=False, learner_only=True, model_config={'intrinsic_reward_network': {'encoder_hidden_sizes': [], 'encoding_dim': 1, 'num_heads': 1, 'head_hidden_sizes': None, 'layers': [{'type': 'attention'}]}, 'extrinsic_value_hidden_layers': [127, 60], 'vf_share_layers': True, 'max_seq_len': 6}, catalog_class=None, load_state_path=None, model_config_dict=None)})", "algorithm_config_overrides_per_module": {"intrinsic_reward_module": {"lr": 0.0002715581955}}, "_per_module_overrides": {}, "_validate_config": true, "_use_msgpack_checkpoints": false, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "env_task_fn": -1, "enable_connectors": -1, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.161583927863, "kl_target": 0.0201019014258, "vf_loss_coeff": 0.7790510010087, "entropy_coeff": 0.0015431216992, "clip_param": 0.2459212356676, "vf_clip_param": 0.3769744131561, "entropy_coeff_schedule": null, "lr_schedule": null, "sgd_minibatch_size": -1, "vf_share_layers": -1, "differentiable_learner_configs": ["DifferentiableLearnerConfig(learner_class=<class 'source.intrinsic_attention_ppo.learners.IntrinsicAttentionPPOLearner.IntrinsicAttentionPPOLearner'>, learner_connector=None, add_default_connectors_to_learner_pipeline=True, is_multi_agent=False, policies_to_update=['default_policy'], lr=0.0060984166342, num_total_minibatches=0, num_epochs=1, minibatch_size=1000, shuffle_batch_per_epoch=True)"], "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9485408017724, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.callbacks.callbacks.RLlibCallback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 136.30632376670837, "iterations_since_restore": 14, "perf": {"cpu_util_percent": 31.62307692307693, "ram_util_percent": 82.5153846153846}}
{"timers": {"training_iteration": 9.607288730823964, "restore_env_runners": 1.9667367197228783e-05, "training_step": 9.607112396755475, "env_runner_sampling_timer": 1.7410360432402225, "learner_update_timer": 7.674655060241794, "synch_weights": 0.0008261170454501686, "restore_eval_env_runners": 9.691474790225587e-06, "evaluation_iteration": 0.14064218548284246, "synch_eval_env_connectors": 0.0001378745531835804, "synch_env_connectors": 4.8990288768521754e-06}, "env_runners": {"module_to_env_connector": {"timers": {"connectors": {"listify_data_for_vector_env": 1.0314967139569639e-05, "remove_single_ts_time_rank_from_batch": 1.1834325262340278e-05, "tensor_to_numpy": 1.5113136923392283e-05, "un_batch_to_individual_items": 6.6000919591401914e-06, "normalize_and_clip_actions": 7.85991362516068e-06, "get_actions": 3.83737512337654e-05}}, "connector_pipeline_timer": 0.0001159729901055882}, "env_to_module_sum_episodes_length_out": 10.36823839457432, "rlmodule_inference_timer": 3.119622146034348e-05, "env_to_module_connector": {"timers": {"connectors": {"add_observations_from_episodes_to_batch": 2.7573615643396864e-06, "add_time_dim_to_batch_and_zero_pad": 6.778466960507239e-06, "numpy_to_tensor": 1.2396091289780202e-05, "batch_individual_items": 1.2264081258241377e-05, "add_states_from_episodes_to_batch": 2.6507619220152443e-06}}, "connector_pipeline_timer": 5.842640302736243e-05}, "episode_return_max": 14.5, "num_env_steps_sampled": 5000.0, "num_episodes": 250.0, "episode_len_max": 20, "sample": 0.005572029501096173, "weights_seq_no": 14.0, "num_episodes_lifetime": -400875.0, "env_to_module_sum_episodes_length_in": 10.36823839457432, "num_agent_steps_sampled": {"default_agent": 5000.0}, "num_env_steps_sampled_lifetime": -8017500.0, "episode_duration_sec_mean": 0.005177718002814798, "episode_return_mean": 6.419999999999999, "num_module_steps_sampled": {"default_policy": 5000.0}, "env_reset_timer": 3.789411986619469e-05, "num_module_steps_sampled_lifetime": {"default_policy": -8017500.0}, "agent_episode_returns_mean": {"default_agent": 6.419999999999999}, "env_step_timer": 1.3715152746732141e-05, "episode_return_min": -5.5, "episode_len_min": 20, "episode_len_mean": 20.0, "num_agent_steps_sampled_lifetime": {"default_agent": -8017500.0}, "module_episode_returns_mean": {"default_policy": 6.419999999999999}, "time_between_sampling": 0.0327006359046649, "num_env_steps_sampled_lifetime_throughput": 3295.0005164933723}, "__all_modules__": {"learner_connector_sum_episodes_length_in": 5000.0, "learner_connector": {"connector_pipeline_timer": 0.15345857410742367, "timers": {"connectors": {"add_one_ts_to_episodes_and_truncate": 0.008962145264643518, "add_observations_from_episodes_to_batch": 0.0008578350240390951, "add_columns_from_episodes_to_train_batch": 0.04126771287692444, "add_time_dim_to_batch_and_zero_pad": 0.08986657660609103, "add_states_from_episodes_to_batch": 0.0036191747094267285, "batch_individual_items": 0.00868706693420569, "numpy_to_tensor": 6.335307864385116e-05}}}, "learner_connector_sum_episodes_length_out": 5250.0}, "learners": {"intrinsic_reward_module": {"weights_seq_no": 15.0, "num_module_steps_trained_lifetime": 89775, "gradients_default_optimizer_global_norm": 0.0, "module_train_batch_size_mean": 998.1026110140886, "diff_num_grad_updates_vs_sampler_policy": 1.0, "num_trainable_parameters": 8266, "default_optimizer_learning_rate": 0.0002715581955, "total_loss": 0.0, "num_module_steps_trained": 5985, "curr_entropy_coeff": 0.0015431216992, "num_module_steps_trained_lifetime_throughput": 741.1787715821845}, "differentiable_learners": {"intrinsic_attention_ppo_learner": {"intrinsic_reward_module": {"total_loss": 0.0, "num_module_steps_trained": 35910, "diff_num_grad_updates_vs_sampler_policy": 76.0, "weights_seq_no": 90.0, "num_module_steps_trained_lifetime": 538650, "module_train_batch_size_mean": 997.499088644618}, "default_policy": {"vf_explained_var": 0.0016120672225952148, "total_loss": 0.2477341592311859, "vf_loss": 0.3207540512084961, "vf_loss_unclipped": 47.65636444091797, "weights_seq_no": 90.0, "num_module_steps_trained_lifetime": 538650, "module_train_batch_size_mean": 997.499088644618, "entropy": 0.6874218583106995, "mean_kl_loss": 6.697241769870743e-05, "use_intrinsic_rewards": 1.0, "policy_loss": -0.001099651213735342, "num_module_steps_trained": 35910, "diff_num_grad_updates_vs_sampler_policy": 76.0}, "__all_modules__": {"num_env_steps_trained_lifetime": 3240000, "num_module_steps_trained_lifetime": 1077300, "num_module_steps_trained": 71820, "num_env_steps_trained": 216000, "num_env_steps_trained_lifetime_throughput": 50539.903195498766}}}, "default_policy": {"curr_kl_coeff": 4.931150215270463e-06, "num_module_steps_trained_lifetime": 89775, "module_train_batch_size_mean": 998.1026110140886, "entropy": 0.6873701810836792, "num_trainable_parameters": 16595, "mean_kl_loss": 7.266589091159403e-05, "use_intrinsic_rewards": 0.0, "policy_loss": -0.0011463613482192159, "num_module_steps_trained": 5985, "diff_num_grad_updates_vs_sampler_policy": 1.0, "vf_explained_var": -0.00012350082397460938, "total_loss": 0.24748654663562775, "vf_loss": 0.3205099403858185, "curr_entropy_coeff": 0.0015431216992, "vf_loss_unclipped": 47.8276481628418, "weights_seq_no": 15.0, "num_module_steps_trained_lifetime_throughput": 741.1722602276645}, "__all_modules__": {"num_module_steps_trained": 11970, "num_non_trainable_parameters": 0, "num_env_steps_trained": 36000, "num_env_steps_trained_lifetime": 540000, "num_module_steps_trained_lifetime": 179550, "num_trainable_parameters": 24861, "num_env_steps_trained_lifetime_throughput": 4461.799397611525, "num_module_steps_trained_throughput": 22437383.51581409, "num_module_steps_trained_lifetime_throughput": 12877790.191409105}, "IntrinsicAttentionMask": [[[0.16514188051223755, 0.16625836491584778, 0.1662285029888153, 0.16789352893829346, 0.16725388169288635, 0.16722384095191956], [0.16444702446460724, 0.16607020795345306, 0.16602672636508942, 0.16845646500587463, 0.16752174496650696, 0.16747787594795227], [0.16446553170681, 0.16607524454593658, 0.1660321205854416, 0.16844144463539124, 0.1675146073102951, 0.16747111082077026], [0.16344116628170013, 0.1657954752445221, 0.1657322645187378, 0.16927564144134521, 0.16790972650051117, 0.1678456962108612], [0.16383299231529236, 0.16590283811092377, 0.1658473014831543, 0.1689559370279312, 0.16775855422019958, 0.16770240664482117], [0.16385145485401154, 0.1659078747034073, 0.16585271060466766, 0.16894090175628662, 0.16775143146514893, 0.16769565641880035]], [[0.16913479566574097, 0.1690736562013626, 0.16438809037208557, 0.1643286496400833, 0.16765838861465454, 0.16541647911071777], [0.16911979019641876, 0.16905902326107025, 0.16440187394618988, 0.16434279084205627, 0.167652428150177, 0.16542410850524902], [0.16795529425144196, 0.16792355477809906, 0.16547492146492004, 0.16544365882873535, 0.1671874076128006, 0.16601517796516418], [0.16794033348560333, 0.16790896654129028, 0.16548873484134674, 0.1654578298330307, 0.16718140244483948, 0.16602276265621185], [0.16877123713493347, 0.16871918737888336, 0.16472266614437103, 0.1646718531847, 0.16751378774642944, 0.1656012386083603], [0.16821350157260895, 0.1681753545999527, 0.165236696600914, 0.16519922018051147, 0.16729098558425903, 0.16588431596755981]], [[0.16504129767417908, 0.16615711152553558, 0.1661272644996643, 0.16779127717018127, 0.16776113212108612, 0.1671220064163208], [0.16430070996284485, 0.16592244803905487, 0.1658789962530136, 0.16830657422542572, 0.1682625114917755, 0.1673288494348526], [0.16432040929794312, 0.1659286916255951, 0.16588561236858368, 0.1682928204536438, 0.16824913024902344, 0.16732333600521088], [0.16322873532772064, 0.16557997465133667, 0.16551685333251953, 0.16905562579631805, 0.16899117827415466, 0.16762754321098328], [0.16324838995933533, 0.16558630764484406, 0.16552354395389557, 0.16904188692569733, 0.16897781193256378, 0.16762210428714752], [0.16366596519947052, 0.16572006046772003, 0.16566495597362518, 0.1687496453523636, 0.16869354248046875, 0.16750581562519073]], [[0.16893059015274048, 0.1688695251941681, 0.1653960794210434, 0.16533628106117249, 0.16745597124099731, 0.16401159763336182], [0.16891682147979736, 0.16885612905025482, 0.1654037982225418, 0.16534435749053955, 0.16745121777057648, 0.1640276163816452], [0.16812680661678314, 0.16808757185935974, 0.16584788262844086, 0.16580918431282043, 0.16717809438705444, 0.16495051980018616], [0.16811306774616241, 0.16807420551776886, 0.16585558652877808, 0.1658172458410263, 0.1671733260154724, 0.16496658325195312], [0.16859714686870575, 0.16854515671730042, 0.1655835658311844, 0.16553248465061188, 0.16734099388122559, 0.16440054774284363], [0.16780757904052734, 0.16777697205543518, 0.16602706909179688, 0.16599678993225098, 0.1670670062303543, 0.16532450914382935]], [[0.1667661815881729, 0.16592848300933838, 0.16590604186058044, 0.1671556830406189, 0.16713307797908783, 0.16711047291755676], [0.16670633852481842, 0.16637377440929413, 0.166364848613739, 0.16686062514781952, 0.16685166954994202, 0.1668427288532257], [0.16670474410057068, 0.16638575494289398, 0.16637718677520752, 0.16685271263122559, 0.16684412956237793, 0.16683554649353027], [0.16679370403289795, 0.16572239995002747, 0.1656937152147293, 0.16729234158992767, 0.16726338863372803, 0.16723445057868958], [0.1667921096086502, 0.16573435068130493, 0.16570602357387543, 0.16728441417217255, 0.16725583374500275, 0.16722725331783295], [0.16679051518440247, 0.1657462865114212, 0.16571831703186035, 0.16727648675441742, 0.16724826395511627, 0.1672200709581375]], [[0.16872723400592804, 0.16866624355316162, 0.1651969701051712, 0.16513724625110626, 0.16725438833236694, 0.16501787304878235], [0.1687147170305252, 0.16865409910678864, 0.16520589590072632, 0.16514652967453003, 0.1672508716583252, 0.16502787172794342], [0.16799555718898773, 0.16795635223388672, 0.16571840643882751, 0.1656797230243683, 0.16704759001731873, 0.1656024158000946], [0.1679830402135849, 0.16794420778751373, 0.16572730243206024, 0.16568899154663086, 0.1670440286397934, 0.16561239957809448], [0.16842369735240936, 0.1683717519044876, 0.16541320085525513, 0.1653621941804886, 0.16716882586479187, 0.1652602255344391], [0.16795803606510162, 0.16791994869709015, 0.16574512422084808, 0.165707528591156, 0.16703692078590393, 0.16563239693641663]]]}, "num_training_step_calls_per_iteration": 1, "evaluation": {"env_runners": {"episode_len_min": 20, "env_to_module_connector": {"timers": {"connectors": {"numpy_to_tensor": 1.2188196431401246e-05, "add_states_from_episodes_to_batch": 2.7469717045559488e-06, "batch_individual_items": 1.2479590646396462e-05, "add_time_dim_to_batch_and_zero_pad": 7.325954423736101e-06, "add_observations_from_episodes_to_batch": 2.883674413787072e-06}}, "connector_pipeline_timer": 5.955851049824545e-05}, "module_to_env_connector": {"timers": {"connectors": {"tensor_to_numpy": 1.5105894792763327e-05, "un_batch_to_individual_items": 6.565913851660745e-06, "normalize_and_clip_actions": 7.882178209911898e-06, "get_actions": 3.7357492926544954e-05, "remove_single_ts_time_rank_from_batch": 1.184428998400483e-05, "listify_data_for_vector_env": 1.0432511807192743e-05}}, "connector_pipeline_timer": 0.00011501569061139394}, "num_env_steps_sampled": 400, "episode_len_max": 20, "num_agent_steps_sampled": {"default_agent": 400}, "weights_seq_no": 15.0, "num_env_steps_sampled_lifetime": 75400, "episode_duration_sec_mean": 0.005210735034197569, "episode_return_mean": 0.3, "env_reset_timer": 0.00016049925076633872, "module_episode_returns_mean": {"default_policy": 0.3}, "rlmodule_inference_timer": 3.1837600454341346e-05, "episode_return_max": 15.5, "env_to_module_sum_episodes_length_in": 10.368238394574323, "num_module_steps_sampled": {"default_policy": 400}, "agent_episode_returns_mean": {"default_agent": 0.3}, "num_agent_steps_sampled_lifetime": {"default_agent": 6000}, "num_module_steps_sampled_lifetime": {"default_policy": 6000}, "env_to_module_sum_episodes_length_out": 10.368238394574323, "num_episodes": 20, "num_episodes_lifetime": 300, "episode_return_min": -13.5, "sample": 0.13391256494493886, "env_step_timer": 1.3965873074132543e-05, "episode_len_mean": 20.0, "time_between_sampling": 9.640491652594068}, "num_healthy_workers": 1, "actor_manager_num_outstanding_async_reqs": 0, "num_remote_worker_restarts": 0}, "num_env_steps_sampled_lifetime": -8017500.0, "fault_tolerance": {"num_healthy_workers": 0, "num_remote_worker_restarts": 0}, "env_runner_group": {"actor_manager_num_outstanding_async_reqs": 0}, "done": false, "training_iteration": 15, "trial_id": "b17e2_00000", "date": "2025-08-11_18-45-36", "timestamp": 1754930736, "time_this_iter_s": 9.56233811378479, "time_total_s": 145.86866188049316, "pid": 11680, "hostname": "Mac", "node_ip": "127.0.0.1", "config": {"exploration_config": {}, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 2, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "env": "Umbrella", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": false, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 0, "create_local_env_runner": true, "num_envs_per_env_runner": 1, "gym_env_vectorize_mode": "SYNC", "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "episodes_to_numpy": true, "max_requests_in_flight_per_env_runner": 1, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "merge_env_runner_states": "training_only", "broadcast_env_runner_states": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "complete_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "sampler_perf_stats_ema_coef": null, "_is_online": true, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": "auto", "num_aggregator_actors_per_learner": 0, "max_requests_in_flight_per_aggregator_actor": 3, "local_gpu_idx": 0, "max_requests_in_flight_per_learner": 3, "gamma": 1, "lr": 0.0002715581955, "grad_clip": 0.5, "grad_clip_by": "global_norm", "_train_batch_size_per_learner": 5000, "train_batch_size": 4000, "num_epochs": 1, "minibatch_size": 1000, "shuffle_batch_per_epoch": true, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "log_std_clip_param": 20.0, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "_disable_preprocessor_api": false, "_disable_action_flattening": false}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {"intrinsic_reward_coeff": 0.2795015916508}, "optimizer": {}, "_learner_class": "<class 'source.intrinsic_attention_ppo.learners.IntrinsicAttentionMetaLearner.IntrinsicAttentionMetaLearner'>", "callbacks_on_algorithm_init": null, "callbacks_on_env_runners_recreated": null, "callbacks_on_offline_eval_runners_recreated": null, "callbacks_on_checkpoint_loaded": null, "callbacks_on_environment_created": null, "callbacks_on_episode_created": null, "callbacks_on_episode_start": null, "callbacks_on_episode_step": null, "callbacks_on_episode_end": null, "callbacks_on_evaluate_start": null, "callbacks_on_evaluate_end": null, "callbacks_on_evaluate_offline_start": null, "callbacks_on_evaluate_offline_end": null, "callbacks_on_sample_end": null, "callbacks_on_train_result": null, "explore": true, "enable_rl_module_and_learner": true, "enable_env_runner_and_connector_v2": true, "_prior_exploration_config": {"type": "StochasticSampling"}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x13c0118a0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "offline_data_class": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_read_batch_size": null, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "materialize_data": false, "materialize_mapped_data": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "ignore_final_observation": false, "prelearner_class": null, "prelearner_buffer_class": null, "prelearner_buffer_kwargs": {}, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_remaining_data": false, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": 1, "evaluation_duration": 20, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_auto_duration_min_env_steps_per_sample": 100, "evaluation_auto_duration_max_env_steps_per_sample": 2000, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 1, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "offline_evaluation_interval": null, "num_offline_eval_runners": 0, "offline_loss_for_module_fn": null, "offline_evaluation_duration": 1, "offline_evaluation_parallel_to_training": false, "offline_evaluation_timeout_s": 120.0, "num_cpus_per_offline_eval_runner": 1, "num_gpus_per_offline_eval_runner": 0, "custom_resources_per_offline_eval_runner": {}, "restart_failed_offline_eval_runners": true, "ignore_offline_eval_runner_failures": false, "max_num_offline_eval_runner_restarts": 1000, "offline_eval_runner_restore_timeout_s": 1800.0, "max_requests_in_flight_per_offline_eval_runner": 1, "validate_offline_eval_runners_after_construction": true, "offline_eval_runner_health_probe_timeout_s": 30.0, "offline_eval_rl_module_inference_only": false, "broadcast_offline_eval_runner_states": false, "offline_eval_batch_size_per_runner": 256, "dataset_num_iters_per_eval_runner": 1, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "log_gradients": false, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 9, "restart_failed_env_runners": true, "ignore_env_runner_failures": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30.0, "env_runner_restore_timeout_s": 1800.0, "_model_config": {}, "_rl_module_spec": "MultiRLModuleSpec(multi_rl_module_class=<class 'ray.rllib.core.rl_module.multi_rl_module.MultiRLModule'>, observation_space=None, action_space=None, inference_only=False, model_config=None, rl_module_specs={'default_policy': RLModuleSpec(module_class=<class 'source.intrinsic_attention_ppo.rl_modules.DifferentiablePPOModule.DifferentiablePPOModule'>, observation_space=None, action_space=None, inference_only=False, learner_only=False, model_config={'vf_share_layers': True, 'embedding_dim': 62, 'max_seq_len': 6, 'policy_head_hidden_sizes': [32], 'value_head_hidden_sizes': [101], 'embedding_hidden_sizes': [121]}, catalog_class=None, load_state_path=None, model_config_dict=None), 'intrinsic_reward_module': RLModuleSpec(module_class=<class 'source.intrinsic_attention_ppo.rl_modules.IntrinsicAttentionModule.IntrinsicAttentionModule'>, observation_space=None, action_space=None, inference_only=False, learner_only=True, model_config={'intrinsic_reward_network': {'encoder_hidden_sizes': [], 'encoding_dim': 1, 'num_heads': 1, 'head_hidden_sizes': None, 'layers': [{'type': 'attention'}]}, 'extrinsic_value_hidden_layers': [127, 60], 'vf_share_layers': True, 'max_seq_len': 6}, catalog_class=None, load_state_path=None, model_config_dict=None)}, load_state_path=None, modules_to_load=None, module_specs={'default_policy': RLModuleSpec(module_class=<class 'source.intrinsic_attention_ppo.rl_modules.DifferentiablePPOModule.DifferentiablePPOModule'>, observation_space=None, action_space=None, inference_only=False, learner_only=False, model_config={'vf_share_layers': True, 'embedding_dim': 62, 'max_seq_len': 6, 'policy_head_hidden_sizes': [32], 'value_head_hidden_sizes': [101], 'embedding_hidden_sizes': [121]}, catalog_class=None, load_state_path=None, model_config_dict=None), 'intrinsic_reward_module': RLModuleSpec(module_class=<class 'source.intrinsic_attention_ppo.rl_modules.IntrinsicAttentionModule.IntrinsicAttentionModule'>, observation_space=None, action_space=None, inference_only=False, learner_only=True, model_config={'intrinsic_reward_network': {'encoder_hidden_sizes': [], 'encoding_dim': 1, 'num_heads': 1, 'head_hidden_sizes': None, 'layers': [{'type': 'attention'}]}, 'extrinsic_value_hidden_layers': [127, 60], 'vf_share_layers': True, 'max_seq_len': 6}, catalog_class=None, load_state_path=None, model_config_dict=None)})", "algorithm_config_overrides_per_module": {"intrinsic_reward_module": {"lr": 0.0002715581955}}, "_per_module_overrides": {}, "_validate_config": true, "_use_msgpack_checkpoints": false, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "env_task_fn": -1, "enable_connectors": -1, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.161583927863, "kl_target": 0.0201019014258, "vf_loss_coeff": 0.7790510010087, "entropy_coeff": 0.0015431216992, "clip_param": 0.2459212356676, "vf_clip_param": 0.3769744131561, "entropy_coeff_schedule": null, "lr_schedule": null, "sgd_minibatch_size": -1, "vf_share_layers": -1, "differentiable_learner_configs": ["DifferentiableLearnerConfig(learner_class=<class 'source.intrinsic_attention_ppo.learners.IntrinsicAttentionPPOLearner.IntrinsicAttentionPPOLearner'>, learner_connector=None, add_default_connectors_to_learner_pipeline=True, is_multi_agent=False, policies_to_update=['default_policy'], lr=0.0060984166342, num_total_minibatches=0, num_epochs=1, minibatch_size=1000, shuffle_batch_per_epoch=True)"], "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9485408017724, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.callbacks.callbacks.RLlibCallback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 145.86866188049316, "iterations_since_restore": 15, "perf": {"cpu_util_percent": 36.55714285714286, "ram_util_percent": 82.42142857142856}}
{"timers": {"training_iteration": 9.608643801436314, "restore_env_runners": 1.961944436687408e-05, "training_step": 9.608466409457693, "env_runner_sampling_timer": 1.7391039586370478, "learner_update_timer": 7.67650632921984, "synch_weights": 0.0008357871256181628, "restore_eval_env_runners": 1.0081649897919755e-05, "evaluation_iteration": 0.14052606195814596, "synch_eval_env_connectors": 0.00014539163673886788, "synch_env_connectors": 4.88670825030592e-06}, "env_runners": {"module_to_env_connector": {"timers": {"connectors": {"listify_data_for_vector_env": 1.0518422215171914e-05, "remove_single_ts_time_rank_from_batch": 1.2008719787123684e-05, "tensor_to_numpy": 1.5474276722837917e-05, "un_batch_to_individual_items": 6.705409752641209e-06, "normalize_and_clip_actions": 7.981494952117852e-06, "get_actions": 4.011321978078809e-05}}, "connector_pipeline_timer": 0.00011905759741077923}, "env_to_module_sum_episodes_length_out": 10.36823839457432, "rlmodule_inference_timer": 3.210885434039576e-05, "env_to_module_connector": {"timers": {"connectors": {"add_observations_from_episodes_to_batch": 2.8265950531192694e-06, "add_time_dim_to_batch_and_zero_pad": 6.976592820035514e-06, "numpy_to_tensor": 1.2958567000510659e-05, "batch_individual_items": 1.2563866929160385e-05, "add_states_from_episodes_to_batch": 2.712716494063297e-06}}, "connector_pipeline_timer": 6.001183731576877e-05}, "episode_return_max": 14.5, "num_env_steps_sampled": 5000.0, "num_episodes": 250.0, "episode_len_max": 20, "sample": 0.005661349904100938, "weights_seq_no": 15.0, "num_episodes_lifetime": -431750.0, "env_to_module_sum_episodes_length_in": 10.36823839457432, "num_agent_steps_sampled": {"default_agent": 5000.0}, "num_env_steps_sampled_lifetime": -8635000.0, "episode_duration_sec_mean": 0.0053111198297701775, "episode_return_mean": 5.7799999999999985, "num_module_steps_sampled": {"default_policy": 5000.0}, "env_reset_timer": 4.0610906015347e-05, "num_module_steps_sampled_lifetime": {"default_policy": -8635000.0}, "agent_episode_returns_mean": {"default_agent": 5.7799999999999985}, "env_step_timer": 1.4101113694670292e-05, "episode_return_min": -5.5, "episode_len_min": 20, "episode_len_mean": 20.0, "num_agent_steps_sampled_lifetime": {"default_agent": -8635000.0}, "module_episode_returns_mean": {"default_policy": 5.7799999999999985}, "time_between_sampling": 0.03257176035890679, "num_env_steps_sampled_lifetime_throughput": 3233.0438593044005}, "__all_modules__": {"learner_connector_sum_episodes_length_in": 5000.0, "learner_connector": {"connector_pipeline_timer": 0.1547763946154982, "timers": {"connectors": {"add_one_ts_to_episodes_and_truncate": 0.008961004231942054, "add_observations_from_episodes_to_batch": 0.000857602503354469, "add_columns_from_episodes_to_train_batch": 0.041269006157582035, "add_time_dim_to_batch_and_zero_pad": 0.08987016958915005, "add_states_from_episodes_to_batch": 0.0036207579624241036, "batch_individual_items": 0.009999547094751768, "numpy_to_tensor": 6.356704790785307e-05}}}, "learner_connector_sum_episodes_length_out": 5250.0}, "learners": {"intrinsic_reward_module": {"weights_seq_no": 16.0, "num_module_steps_trained_lifetime": 95760, "gradients_default_optimizer_global_norm": 0.0, "module_train_batch_size_mean": 998.0669052031734, "diff_num_grad_updates_vs_sampler_policy": 1.0, "num_trainable_parameters": 8266, "default_optimizer_learning_rate": 0.0002715581955, "total_loss": 0.0, "num_module_steps_trained": 5985, "curr_entropy_coeff": 0.0015431216992, "num_module_steps_trained_lifetime_throughput": 739.4504329742318}, "differentiable_learners": {"intrinsic_attention_ppo_learner": {"intrinsic_reward_module": {"total_loss": 0.0, "num_module_steps_trained": 35910, "diff_num_grad_updates_vs_sampler_policy": 81.0, "weights_seq_no": 96.0, "num_module_steps_trained_lifetime": 574560, "module_train_batch_size_mean": 997.4970769774884}, "default_policy": {"vf_explained_var": 0.0014740824699401855, "total_loss": 0.24802228808403015, "vf_loss": 0.3207056224346161, "vf_loss_unclipped": 45.64624786376953, "weights_seq_no": 96.0, "num_module_steps_trained_lifetime": 574560, "module_train_batch_size_mean": 997.4970769774884, "entropy": 0.6862529516220093, "mean_kl_loss": 3.567768362700008e-05, "use_intrinsic_rewards": 1.0, "policy_loss": -0.0007705326424911618, "num_module_steps_trained": 35910, "diff_num_grad_updates_vs_sampler_policy": 81.0}, "__all_modules__": {"num_env_steps_trained_lifetime": 3456000, "num_module_steps_trained_lifetime": 1149120, "num_module_steps_trained": 71820, "num_env_steps_trained": 216000, "num_env_steps_trained_lifetime_throughput": 49790.204227226546}}}, "default_policy": {"curr_kl_coeff": 2.4655751076352317e-06, "num_module_steps_trained_lifetime": 95760, "module_train_batch_size_mean": 998.0669052031734, "entropy": 0.686195969581604, "num_trainable_parameters": 16595, "mean_kl_loss": 3.989740434917621e-05, "use_intrinsic_rewards": 0.0, "policy_loss": -0.0008138111443258822, "num_module_steps_trained": 5985, "diff_num_grad_updates_vs_sampler_policy": 1.0, "vf_explained_var": 2.562999725341797e-06, "total_loss": 0.24782054126262665, "vf_loss": 0.3205094337463379, "curr_entropy_coeff": 0.0015431216992, "vf_loss_unclipped": 45.76004409790039, "weights_seq_no": 16.0, "num_module_steps_trained_lifetime_throughput": 739.4443762163536}, "__all_modules__": {"num_module_steps_trained": 11970, "num_non_trainable_parameters": 0, "num_env_steps_trained": 36000, "num_env_steps_trained_lifetime": 576000, "num_module_steps_trained_lifetime": 191520, "num_trainable_parameters": 24861, "num_env_steps_trained_lifetime_throughput": 4451.264903854836, "num_module_steps_trained_throughput": 21932020.91437654, "num_module_steps_trained_lifetime_throughput": 12871273.620529603}, "IntrinsicAttentionMask": [[[0.16691821813583374, 0.16607975959777832, 0.1656031459569931, 0.16730807721614838, 0.16728545725345612, 0.16680537164211273], [0.16676664352416992, 0.16643396019935608, 0.16624440252780914, 0.1669209897518158, 0.1669120341539383, 0.16672194004058838], [0.16667982935905457, 0.16663606464862823, 0.16661110520362854, 0.1667001098394394, 0.16669893264770508, 0.1666739583015442], [0.16698817908763885, 0.1659156233072281, 0.16530661284923553, 0.16748739778995514, 0.1674584150314331, 0.1668437421321869], [0.16698412597179413, 0.16592513024806976, 0.16532379388809204, 0.16747699677944183, 0.16744837164878845, 0.166841521859169], [0.16689790785312653, 0.16612732410430908, 0.165689155459404, 0.16725608706474304, 0.16723529994487762, 0.16679421067237854]], [[0.16771277785301208, 0.16716724634170532, 0.16570033133029938, 0.16619010269641876, 0.16709035634994507, 0.1661391407251358], [0.16739462316036224, 0.16701534390449524, 0.1659936159849167, 0.16633504629135132, 0.16696186363697052, 0.16629953682422638], [0.16653555631637573, 0.1666036993265152, 0.16678819060325623, 0.16672638058662415, 0.16661332547664642, 0.1667328029870987], [0.16682295501232147, 0.16674165427684784, 0.16652192175388336, 0.1665954738855362, 0.16673018038272858, 0.16658782958984375], [0.167349711060524, 0.1669938713312149, 0.1660350263118744, 0.16635549068450928, 0.16694368422031403, 0.16632217168807983], [0.1667930781841278, 0.16672731935977936, 0.16654957830905914, 0.16660907864570618, 0.1667180359363556, 0.16660289466381073]], [[0.16691766679286957, 0.16562499105930328, 0.16560259461402893, 0.1673075258731842, 0.16728490591049194, 0.1672622710466385], [0.16668391227722168, 0.16659535467624664, 0.16659381985664368, 0.1667104959487915, 0.16670896112918854, 0.16670741140842438], [0.16667982935905457, 0.16661226749420166, 0.16661110520362854, 0.1667001098394394, 0.16669893264770508, 0.16669775545597076], [0.16698729991912842, 0.16533435881137848, 0.1653057336807251, 0.1674865186214447, 0.16745753586292267, 0.16742855310440063], [0.16698327660560608, 0.16535119712352753, 0.16532295942306519, 0.16747614741325378, 0.1674475222826004, 0.16741891205310822], [0.16697923839092255, 0.16536803543567657, 0.16534015536308289, 0.16746576130390167, 0.16743750870227814, 0.1674092710018158]], [[0.16753865778446198, 0.16751296818256378, 0.1655282825231552, 0.1660175621509552, 0.1674359291791916, 0.16596665978431702], [0.16752617061138153, 0.16750085353851318, 0.1655445247888565, 0.16602683067321777, 0.16742491722106934, 0.1659766584634781], [0.1665571928024292, 0.16656039655208588, 0.16680987179279327, 0.1667480617761612, 0.1665700227022171, 0.16675448417663574], [0.16679711639881134, 0.16679328680038452, 0.1664961278438568, 0.16656966507434845, 0.16678181290626526, 0.166562020778656], [0.16748876869678497, 0.16746455430984497, 0.16559328138828278, 0.16605471074581146, 0.16739194095134735, 0.16600669920444489], [0.16677217185497284, 0.1667690873146057, 0.16652870178222656, 0.1665882021188736, 0.16675978899002075, 0.16658201813697815]], [[0.16514088213443756, 0.1662573665380478, 0.16562394797801971, 0.16789253056049347, 0.16786237061023712, 0.16722284257411957], [0.1644449532032013, 0.16606810688972473, 0.1651466190814972, 0.1684543341398239, 0.16841022670269012, 0.16747574508190155], [0.1648390293121338, 0.1661754846572876, 0.16541706025600433, 0.16813603043556213, 0.16809983551502228, 0.16733261942863464], [0.16343680024147034, 0.16579101979732513, 0.16445320844650269, 0.16927111148834229, 0.16920657455921173, 0.16784121096134186], [0.1634552776813507, 0.16579614579677582, 0.16446594893932343, 0.16925612092018127, 0.16919197142124176, 0.16783452033996582], [0.16384810209274292, 0.1659044772386551, 0.16473639011383057, 0.16893745958805084, 0.16888129711151123, 0.16769224405288696]], [[0.16872723400592804, 0.16866624355316162, 0.16519695520401, 0.16513724625110626, 0.16725438833236694, 0.16501787304878235], [0.1687147170305252, 0.16865409910678864, 0.16520588099956512, 0.16514652967453003, 0.1672508716583252, 0.16502785682678223], [0.16799555718898773, 0.16795635223388672, 0.16571840643882751, 0.1656797230243683, 0.16704759001731873, 0.1656024158000946], [0.1679830402135849, 0.16794420778751373, 0.16572730243206024, 0.16568899154663086, 0.1670440286397934, 0.16561239957809448], [0.16842371225357056, 0.1683717668056488, 0.16541320085525513, 0.1653621941804886, 0.16716884076595306, 0.16526024043560028], [0.16795803606510162, 0.16791994869709015, 0.16574512422084808, 0.165707528591156, 0.16703692078590393, 0.16563239693641663]]]}, "num_training_step_calls_per_iteration": 1, "evaluation": {"env_runners": {"episode_len_min": 20, "env_to_module_connector": {"timers": {"connectors": {"numpy_to_tensor": 1.3601752888848363e-05, "add_states_from_episodes_to_batch": 2.971843832500963e-06, "batch_individual_items": 1.341679840940942e-05, "add_time_dim_to_batch_and_zero_pad": 7.852098950450329e-06, "add_observations_from_episodes_to_batch": 3.0771159400784483e-06}}, "connector_pipeline_timer": 6.376608862115963e-05}, "module_to_env_connector": {"timers": {"connectors": {"tensor_to_numpy": 1.6413075950706587e-05, "un_batch_to_individual_items": 7.048305749814715e-06, "normalize_and_clip_actions": 8.565863474274475e-06, "get_actions": 4.346076819374485e-05, "remove_single_ts_time_rank_from_batch": 1.2836485907196041e-05, "listify_data_for_vector_env": 1.1508260435756857e-05}}, "connector_pipeline_timer": 0.00012880104883621006}, "num_env_steps_sampled": 400, "episode_len_max": 20, "num_agent_steps_sampled": {"default_agent": 400}, "weights_seq_no": 16.0, "num_env_steps_sampled_lifetime": 80400, "episode_duration_sec_mean": 0.0055110758705995974, "episode_return_mean": 0.3, "env_reset_timer": 0.00016261842864174125, "module_episode_returns_mean": {"default_policy": 0.3}, "rlmodule_inference_timer": 3.500636959347366e-05, "episode_return_max": 15.5, "env_to_module_sum_episodes_length_in": 10.368238394574323, "num_module_steps_sampled": {"default_policy": 400}, "agent_episode_returns_mean": {"default_agent": 0.3}, "num_agent_steps_sampled_lifetime": {"default_agent": 6400}, "num_module_steps_sampled_lifetime": {"default_policy": 6400}, "env_to_module_sum_episodes_length_out": 10.368238394574323, "num_episodes": 20, "num_episodes_lifetime": 320, "episode_return_min": -13.5, "sample": 0.13403713846517928, "env_step_timer": 1.604161815206462e-05, "episode_len_mean": 20.0, "time_between_sampling": 9.641810537318232}, "num_healthy_workers": 1, "actor_manager_num_outstanding_async_reqs": 0, "num_remote_worker_restarts": 0}, "num_env_steps_sampled_lifetime": -8635000.0, "fault_tolerance": {"num_healthy_workers": 0, "num_remote_worker_restarts": 0}, "env_runner_group": {"actor_manager_num_outstanding_async_reqs": 0}, "done": false, "training_iteration": 16, "trial_id": "b17e2_00000", "date": "2025-08-11_18-45-45", "timestamp": 1754930745, "time_this_iter_s": 9.90245795249939, "time_total_s": 155.77111983299255, "pid": 11680, "hostname": "Mac", "node_ip": "127.0.0.1", "config": {"exploration_config": {}, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 2, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "env": "Umbrella", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": false, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 0, "create_local_env_runner": true, "num_envs_per_env_runner": 1, "gym_env_vectorize_mode": "SYNC", "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "episodes_to_numpy": true, "max_requests_in_flight_per_env_runner": 1, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "merge_env_runner_states": "training_only", "broadcast_env_runner_states": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "complete_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "sampler_perf_stats_ema_coef": null, "_is_online": true, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": "auto", "num_aggregator_actors_per_learner": 0, "max_requests_in_flight_per_aggregator_actor": 3, "local_gpu_idx": 0, "max_requests_in_flight_per_learner": 3, "gamma": 1, "lr": 0.0002715581955, "grad_clip": 0.5, "grad_clip_by": "global_norm", "_train_batch_size_per_learner": 5000, "train_batch_size": 4000, "num_epochs": 1, "minibatch_size": 1000, "shuffle_batch_per_epoch": true, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "log_std_clip_param": 20.0, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "_disable_preprocessor_api": false, "_disable_action_flattening": false}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {"intrinsic_reward_coeff": 0.2795015916508}, "optimizer": {}, "_learner_class": "<class 'source.intrinsic_attention_ppo.learners.IntrinsicAttentionMetaLearner.IntrinsicAttentionMetaLearner'>", "callbacks_on_algorithm_init": null, "callbacks_on_env_runners_recreated": null, "callbacks_on_offline_eval_runners_recreated": null, "callbacks_on_checkpoint_loaded": null, "callbacks_on_environment_created": null, "callbacks_on_episode_created": null, "callbacks_on_episode_start": null, "callbacks_on_episode_step": null, "callbacks_on_episode_end": null, "callbacks_on_evaluate_start": null, "callbacks_on_evaluate_end": null, "callbacks_on_evaluate_offline_start": null, "callbacks_on_evaluate_offline_end": null, "callbacks_on_sample_end": null, "callbacks_on_train_result": null, "explore": true, "enable_rl_module_and_learner": true, "enable_env_runner_and_connector_v2": true, "_prior_exploration_config": {"type": "StochasticSampling"}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x13c0118a0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "offline_data_class": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_read_batch_size": null, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "materialize_data": false, "materialize_mapped_data": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "ignore_final_observation": false, "prelearner_class": null, "prelearner_buffer_class": null, "prelearner_buffer_kwargs": {}, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_remaining_data": false, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": 1, "evaluation_duration": 20, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_auto_duration_min_env_steps_per_sample": 100, "evaluation_auto_duration_max_env_steps_per_sample": 2000, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 1, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "offline_evaluation_interval": null, "num_offline_eval_runners": 0, "offline_loss_for_module_fn": null, "offline_evaluation_duration": 1, "offline_evaluation_parallel_to_training": false, "offline_evaluation_timeout_s": 120.0, "num_cpus_per_offline_eval_runner": 1, "num_gpus_per_offline_eval_runner": 0, "custom_resources_per_offline_eval_runner": {}, "restart_failed_offline_eval_runners": true, "ignore_offline_eval_runner_failures": false, "max_num_offline_eval_runner_restarts": 1000, "offline_eval_runner_restore_timeout_s": 1800.0, "max_requests_in_flight_per_offline_eval_runner": 1, "validate_offline_eval_runners_after_construction": true, "offline_eval_runner_health_probe_timeout_s": 30.0, "offline_eval_rl_module_inference_only": false, "broadcast_offline_eval_runner_states": false, "offline_eval_batch_size_per_runner": 256, "dataset_num_iters_per_eval_runner": 1, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "log_gradients": false, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 9, "restart_failed_env_runners": true, "ignore_env_runner_failures": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30.0, "env_runner_restore_timeout_s": 1800.0, "_model_config": {}, "_rl_module_spec": "MultiRLModuleSpec(multi_rl_module_class=<class 'ray.rllib.core.rl_module.multi_rl_module.MultiRLModule'>, observation_space=None, action_space=None, inference_only=False, model_config=None, rl_module_specs={'default_policy': RLModuleSpec(module_class=<class 'source.intrinsic_attention_ppo.rl_modules.DifferentiablePPOModule.DifferentiablePPOModule'>, observation_space=None, action_space=None, inference_only=False, learner_only=False, model_config={'vf_share_layers': True, 'embedding_dim': 62, 'max_seq_len': 6, 'policy_head_hidden_sizes': [32], 'value_head_hidden_sizes': [101], 'embedding_hidden_sizes': [121]}, catalog_class=None, load_state_path=None, model_config_dict=None), 'intrinsic_reward_module': RLModuleSpec(module_class=<class 'source.intrinsic_attention_ppo.rl_modules.IntrinsicAttentionModule.IntrinsicAttentionModule'>, observation_space=None, action_space=None, inference_only=False, learner_only=True, model_config={'intrinsic_reward_network': {'encoder_hidden_sizes': [], 'encoding_dim': 1, 'num_heads': 1, 'head_hidden_sizes': None, 'layers': [{'type': 'attention'}]}, 'extrinsic_value_hidden_layers': [127, 60], 'vf_share_layers': True, 'max_seq_len': 6}, catalog_class=None, load_state_path=None, model_config_dict=None)}, load_state_path=None, modules_to_load=None, module_specs={'default_policy': RLModuleSpec(module_class=<class 'source.intrinsic_attention_ppo.rl_modules.DifferentiablePPOModule.DifferentiablePPOModule'>, observation_space=None, action_space=None, inference_only=False, learner_only=False, model_config={'vf_share_layers': True, 'embedding_dim': 62, 'max_seq_len': 6, 'policy_head_hidden_sizes': [32], 'value_head_hidden_sizes': [101], 'embedding_hidden_sizes': [121]}, catalog_class=None, load_state_path=None, model_config_dict=None), 'intrinsic_reward_module': RLModuleSpec(module_class=<class 'source.intrinsic_attention_ppo.rl_modules.IntrinsicAttentionModule.IntrinsicAttentionModule'>, observation_space=None, action_space=None, inference_only=False, learner_only=True, model_config={'intrinsic_reward_network': {'encoder_hidden_sizes': [], 'encoding_dim': 1, 'num_heads': 1, 'head_hidden_sizes': None, 'layers': [{'type': 'attention'}]}, 'extrinsic_value_hidden_layers': [127, 60], 'vf_share_layers': True, 'max_seq_len': 6}, catalog_class=None, load_state_path=None, model_config_dict=None)})", "algorithm_config_overrides_per_module": {"intrinsic_reward_module": {"lr": 0.0002715581955}}, "_per_module_overrides": {}, "_validate_config": true, "_use_msgpack_checkpoints": false, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "env_task_fn": -1, "enable_connectors": -1, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.161583927863, "kl_target": 0.0201019014258, "vf_loss_coeff": 0.7790510010087, "entropy_coeff": 0.0015431216992, "clip_param": 0.2459212356676, "vf_clip_param": 0.3769744131561, "entropy_coeff_schedule": null, "lr_schedule": null, "sgd_minibatch_size": -1, "vf_share_layers": -1, "differentiable_learner_configs": ["DifferentiableLearnerConfig(learner_class=<class 'source.intrinsic_attention_ppo.learners.IntrinsicAttentionPPOLearner.IntrinsicAttentionPPOLearner'>, learner_connector=None, add_default_connectors_to_learner_pipeline=True, is_multi_agent=False, policies_to_update=['default_policy'], lr=0.0060984166342, num_total_minibatches=0, num_epochs=1, minibatch_size=1000, shuffle_batch_per_epoch=True)"], "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9485408017724, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.callbacks.callbacks.RLlibCallback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 155.77111983299255, "iterations_since_restore": 16, "perf": {"cpu_util_percent": 40.021428571428565, "ram_util_percent": 82.02857142857142}}
{"timers": {"training_iteration": 9.618789875092045, "restore_env_runners": 1.9513669703668322e-05, "training_step": 9.61861200536298, "env_runner_sampling_timer": 1.7379953815516442, "learner_update_timer": 7.6876726071783015, "synch_weights": 0.0008361509144861192, "restore_eval_env_runners": 1.0275833316909665e-05, "evaluation_iteration": 0.14067517091926363, "synch_eval_env_connectors": 0.00014641896976537447, "synch_env_connectors": 4.887840384374311e-06}, "env_runners": {"module_to_env_connector": {"timers": {"connectors": {"listify_data_for_vector_env": 1.0911006832507966e-05, "remove_single_ts_time_rank_from_batch": 1.2375392569622123e-05, "tensor_to_numpy": 1.6310308851609098e-05, "un_batch_to_individual_items": 6.97958668309075e-06, "normalize_and_clip_actions": 8.243168160393302e-06, "get_actions": 4.2581649174617184e-05}}, "connector_pipeline_timer": 0.00012466049436020806}, "env_to_module_sum_episodes_length_out": 10.36823839457432, "rlmodule_inference_timer": 3.371213190020178e-05, "env_to_module_connector": {"timers": {"connectors": {"add_observations_from_episodes_to_batch": 2.9404560785719867e-06, "add_time_dim_to_batch_and_zero_pad": 7.363282683867292e-06, "numpy_to_tensor": 1.360212228435391e-05, "batch_individual_items": 1.3118152328553965e-05, "add_states_from_episodes_to_batch": 2.7934296232390676e-06}}, "connector_pipeline_timer": 6.242388354311348e-05}, "episode_return_max": 14.5, "num_env_steps_sampled": 5000.0, "num_episodes": 250.0, "episode_len_max": 20, "sample": 0.005868847580532833, "weights_seq_no": 16.0, "num_episodes_lifetime": -462625.0, "env_to_module_sum_episodes_length_in": 10.36823839457432, "num_agent_steps_sampled": {"default_agent": 5000.0}, "num_env_steps_sampled_lifetime": -9252500.0, "episode_duration_sec_mean": 0.0055649268059059995, "episode_return_mean": 5.700000000000004, "num_module_steps_sampled": {"default_policy": 5000.0}, "env_reset_timer": 4.635167942441089e-05, "num_module_steps_sampled_lifetime": {"default_policy": -9252500.0}, "agent_episode_returns_mean": {"default_agent": 5.700000000000004}, "env_step_timer": 1.4930262836293546e-05, "episode_return_min": -5.5, "episode_len_min": 20, "episode_len_mean": 20.0, "num_agent_steps_sampled_lifetime": {"default_agent": -9252500.0}, "module_episode_returns_mean": {"default_policy": 5.700000000000004}, "time_between_sampling": 0.03389349968695915, "num_env_steps_sampled_lifetime_throughput": 3088.637265052977}, "__all_modules__": {"learner_connector_sum_episodes_length_in": 5000.0, "learner_connector": {"connector_pipeline_timer": 0.15477012816832672, "timers": {"connectors": {"add_one_ts_to_episodes_and_truncate": 0.008960562109563879, "add_observations_from_episodes_to_batch": 0.0008572377282721974, "add_columns_from_episodes_to_train_batch": 0.041270516926279546, "add_time_dim_to_batch_and_zero_pad": 0.08988057455249585, "add_states_from_episodes_to_batch": 0.0036280245531792035, "batch_individual_items": 0.009975085793832073, "numpy_to_tensor": 6.366470780894608e-05}}}, "learner_connector_sum_episodes_length_out": 5250.0}, "learners": {"intrinsic_reward_module": {"weights_seq_no": 17.0, "num_module_steps_trained_lifetime": 101745, "gradients_default_optimizer_global_norm": 0.0, "module_train_batch_size_mean": 998.0332888909784, "diff_num_grad_updates_vs_sampler_policy": 1.0, "num_trainable_parameters": 8266, "default_optimizer_learning_rate": 0.0002715581955, "total_loss": 0.0, "num_module_steps_trained": 5985, "curr_entropy_coeff": 0.0015431216992, "num_module_steps_trained_lifetime_throughput": 736.8299943000412}, "differentiable_learners": {"intrinsic_attention_ppo_learner": {"intrinsic_reward_module": {"total_loss": 0.0, "num_module_steps_trained": 35910, "diff_num_grad_updates_vs_sampler_policy": 86.0, "weights_seq_no": 102.0, "num_module_steps_trained_lifetime": 610470, "module_train_batch_size_mean": 997.4956760259092}, "default_policy": {"vf_explained_var": 0.0014495253562927246, "total_loss": 0.2486627846956253, "vf_loss": 0.3206847012042999, "vf_loss_unclipped": 48.2784423828125, "weights_seq_no": 102.0, "num_module_steps_trained_lifetime": 610470, "module_train_batch_size_mean": 997.4956760259092, "entropy": 0.685761034488678, "mean_kl_loss": 1.5967698345775716e-05, "use_intrinsic_rewards": 1.0, "policy_loss": -0.00011133016232633963, "num_module_steps_trained": 35910, "diff_num_grad_updates_vs_sampler_policy": 86.0}, "__all_modules__": {"num_env_steps_trained_lifetime": 3672000, "num_module_steps_trained_lifetime": 1220940, "num_module_steps_trained": 71820, "num_env_steps_trained": 216000, "num_env_steps_trained_lifetime_throughput": 49044.264279331124}}}, "default_policy": {"curr_kl_coeff": 1.2327875538176158e-06, "num_module_steps_trained_lifetime": 101745, "module_train_batch_size_mean": 998.0332888909784, "entropy": 0.6857495307922363, "num_trainable_parameters": 16595, "mean_kl_loss": 1.6518259144504555e-05, "use_intrinsic_rewards": 0.0, "policy_loss": -0.00011272697156528011, "num_module_steps_trained": 5985, "diff_num_grad_updates_vs_sampler_policy": 1.0, "vf_explained_var": 2.2172927856445312e-05, "total_loss": 0.2485218346118927, "vf_loss": 0.32050883769989014, "curr_entropy_coeff": 0.0015431216992, "vf_loss_unclipped": 48.405120849609375, "weights_seq_no": 17.0, "num_module_steps_trained_lifetime_throughput": 736.8243534410151}, "__all_modules__": {"num_module_steps_trained": 11970, "num_non_trainable_parameters": 0, "num_env_steps_trained": 36000, "num_env_steps_trained_lifetime": 612000, "num_module_steps_trained_lifetime": 203490, "num_trainable_parameters": 24861, "num_env_steps_trained_lifetime_throughput": 4435.371404652738, "num_module_steps_trained_throughput": 21442856.499734562, "num_module_steps_trained_lifetime_throughput": 12856390.280025247}, "IntrinsicAttentionMask": [[[0.16684190928936005, 0.16554981470108032, 0.16598136723041534, 0.16723158955574036, 0.1672089695930481, 0.16718634963035583], [0.16667871177196503, 0.16659016907215118, 0.16661980748176575, 0.16670529544353485, 0.16670376062393188, 0.16670221090316772], [0.16673360764980316, 0.16624131798744202, 0.16640600562095642, 0.16688160598278046, 0.1668730229139328, 0.16686443984508514], [0.1668904572725296, 0.16523846983909607, 0.16578984260559082, 0.1673893928527832, 0.16736042499542236, 0.16733147203922272], [0.16688764095306396, 0.16525650024414062, 0.16580092906951904, 0.167380228638649, 0.1673516184091568, 0.167323037981987], [0.16688482463359833, 0.16527454555034637, 0.16581203043460846, 0.16737107932567596, 0.16734284162521362, 0.16731461882591248]], [[0.16762569546699524, 0.16708044707775116, 0.1656142771244049, 0.1661038100719452, 0.16752292215824127, 0.16605286300182343], [0.1673341542482376, 0.16695500910282135, 0.16593365371227264, 0.16627496480941772, 0.1672627180814743, 0.16623947024345398], [0.16654637455940247, 0.16661451756954193, 0.16679902374744415, 0.16673721373081207, 0.16655918955802917, 0.16674363613128662], [0.1668100357055664, 0.16672874987125397, 0.1665090173482895, 0.16658256947994232, 0.16679471731185913, 0.16657492518424988], [0.1675707995891571, 0.1670568436384201, 0.1656743884086609, 0.16613604128360748, 0.1674739271402359, 0.1660880148410797], [0.16678261756896973, 0.16671687364578247, 0.16653913259506226, 0.1665986329317093, 0.16677023470401764, 0.16659244894981384]], [[0.1667661964893341, 0.16592849791049957, 0.16590604186058044, 0.1671556979417801, 0.16713309288024902, 0.16711048781871796], [0.16670633852481842, 0.16637377440929413, 0.166364848613739, 0.16686062514781952, 0.16685166954994202, 0.1668427288532257], [0.16670474410057068, 0.16638575494289398, 0.16637718677520752, 0.16685271263122559, 0.16684412956237793, 0.16683554649353027], [0.16679370403289795, 0.16572239995002747, 0.1656937152147293, 0.16729234158992767, 0.16726338863372803, 0.16723445057868958], [0.1667921096086502, 0.16573433578014374, 0.16570602357387543, 0.16728441417217255, 0.16725583374500275, 0.16722725331783295], [0.16679053008556366, 0.1657463014125824, 0.16571834683418274, 0.1672765165567398, 0.16724829375743866, 0.1672201007604599]], [[0.166979119181633, 0.16732965409755707, 0.16591861844062805, 0.16626691818237305, 0.16727496683597565, 0.1662306934595108], [0.16709981858730316, 0.16758665442466736, 0.1656293272972107, 0.16611188650131226, 0.16751067340373993, 0.166061669588089], [0.16661132872104645, 0.16654957830905914, 0.16679903864860535, 0.16673722863197327, 0.16655920445919037, 0.16674365103244781], [0.1667325645685196, 0.1668062061071396, 0.1665090173482895, 0.16658255457878113, 0.16679471731185913, 0.16657491028308868], [0.16708101332187653, 0.1675465852022171, 0.1656743884086609, 0.16613605618476868, 0.1674739271402359, 0.1660880148410797], [0.16671998798847198, 0.1667795479297638, 0.16653916239738464, 0.16659864783287048, 0.16677026450634003, 0.16659247875213623]], [[0.16691823303699493, 0.16607977449893951, 0.1656031459569931, 0.16730809211730957, 0.1672854721546173, 0.16680538654327393], [0.16676664352416992, 0.16643396019935608, 0.16624440252780914, 0.1669209897518158, 0.1669120341539383, 0.16672194004058838], [0.16667982935905457, 0.16663606464862823, 0.16661110520362854, 0.1667001098394394, 0.16669893264770508, 0.1666739583015442], [0.16698817908763885, 0.1659156233072281, 0.16530661284923553, 0.16748739778995514, 0.1674584150314331, 0.1668437421321869], [0.16698412597179413, 0.16592513024806976, 0.16532379388809204, 0.16747699677944183, 0.16744837164878845, 0.166841521859169], [0.16689792275428772, 0.16612733900547028, 0.16568917036056519, 0.16725610196590424, 0.16723531484603882, 0.16679422557353973]], [[0.16771197319030762, 0.16768626868724823, 0.16621479392051697, 0.1656741201877594, 0.1670895516872406, 0.16562332212924957], [0.1676969975233078, 0.16767165064811707, 0.1662212610244751, 0.16568829119205475, 0.1670835167169571, 0.16563820838928223], [0.1668378710746765, 0.16683366894721985, 0.1665928214788437, 0.1665038764476776, 0.16673621535301208, 0.16649550199508667], [0.1665206253528595, 0.16652418673038483, 0.1667296141386032, 0.16680561006069183, 0.16660724580287933, 0.16681276261806488], [0.16734936833381653, 0.16733260452747345, 0.16637182235717773, 0.1660180538892746, 0.16694334149360657, 0.16598477959632874], [0.16649076342582703, 0.16649505496025085, 0.1667424589395523, 0.1668339967727661, 0.16659507155418396, 0.16684262454509735]]]}, "num_training_step_calls_per_iteration": 1, "evaluation": {"env_runners": {"episode_len_min": 20, "env_to_module_connector": {"timers": {"connectors": {"numpy_to_tensor": 1.2654326489532537e-05, "add_states_from_episodes_to_batch": 2.80919402137501e-06, "batch_individual_items": 1.280325155905699e-05, "add_time_dim_to_batch_and_zero_pad": 7.271063964662453e-06, "add_observations_from_episodes_to_batch": 2.9228642878490164e-06}}, "connector_pipeline_timer": 6.098748182220847e-05}, "module_to_env_connector": {"timers": {"connectors": {"tensor_to_numpy": 1.5546393028674174e-05, "un_batch_to_individual_items": 6.74284810600039e-06, "normalize_and_clip_actions": 8.182883574400292e-06, "get_actions": 3.890442980630619e-05, "remove_single_ts_time_rank_from_batch": 1.253607403146792e-05, "listify_data_for_vector_env": 1.0721491816197181e-05}}, "connector_pipeline_timer": 0.00011950573481083352}, "num_env_steps_sampled": 400, "episode_len_max": 20, "num_agent_steps_sampled": {"default_agent": 400}, "weights_seq_no": 17.0, "num_env_steps_sampled_lifetime": 85400, "episode_duration_sec_mean": 0.0056289587623905395, "episode_return_mean": -0.1, "env_reset_timer": 0.0001618255754969447, "module_episode_returns_mean": {"default_policy": -0.1}, "rlmodule_inference_timer": 3.2250013671076625e-05, "episode_return_max": 15.5, "env_to_module_sum_episodes_length_in": 10.368238394574323, "num_module_steps_sampled": {"default_policy": 400}, "agent_episode_returns_mean": {"default_agent": -0.1}, "num_agent_steps_sampled_lifetime": {"default_agent": 6800}, "num_module_steps_sampled_lifetime": {"default_policy": 6800}, "env_to_module_sum_episodes_length_out": 10.368238394574323, "num_episodes": 20, "num_episodes_lifetime": 340, "episode_return_min": -13.5, "sample": 0.13394296208065817, "env_step_timer": 1.4480720967402932e-05, "episode_len_mean": 20.0, "time_between_sampling": 9.65187200777463}, "num_healthy_workers": 1, "actor_manager_num_outstanding_async_reqs": 0, "num_remote_worker_restarts": 0}, "num_env_steps_sampled_lifetime": -9252500.0, "fault_tolerance": {"num_healthy_workers": 0, "num_remote_worker_restarts": 0}, "env_runner_group": {"actor_manager_num_outstanding_async_reqs": 0}, "done": false, "training_iteration": 17, "trial_id": "b17e2_00000", "date": "2025-08-11_18-45-56", "timestamp": 1754930756, "time_this_iter_s": 10.756741762161255, "time_total_s": 166.5278615951538, "pid": 11680, "hostname": "Mac", "node_ip": "127.0.0.1", "config": {"exploration_config": {}, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 2, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "env": "Umbrella", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": false, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 0, "create_local_env_runner": true, "num_envs_per_env_runner": 1, "gym_env_vectorize_mode": "SYNC", "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "episodes_to_numpy": true, "max_requests_in_flight_per_env_runner": 1, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "merge_env_runner_states": "training_only", "broadcast_env_runner_states": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "complete_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "sampler_perf_stats_ema_coef": null, "_is_online": true, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": "auto", "num_aggregator_actors_per_learner": 0, "max_requests_in_flight_per_aggregator_actor": 3, "local_gpu_idx": 0, "max_requests_in_flight_per_learner": 3, "gamma": 1, "lr": 0.0002715581955, "grad_clip": 0.5, "grad_clip_by": "global_norm", "_train_batch_size_per_learner": 5000, "train_batch_size": 4000, "num_epochs": 1, "minibatch_size": 1000, "shuffle_batch_per_epoch": true, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "log_std_clip_param": 20.0, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "_disable_preprocessor_api": false, "_disable_action_flattening": false}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {"intrinsic_reward_coeff": 0.2795015916508}, "optimizer": {}, "_learner_class": "<class 'source.intrinsic_attention_ppo.learners.IntrinsicAttentionMetaLearner.IntrinsicAttentionMetaLearner'>", "callbacks_on_algorithm_init": null, "callbacks_on_env_runners_recreated": null, "callbacks_on_offline_eval_runners_recreated": null, "callbacks_on_checkpoint_loaded": null, "callbacks_on_environment_created": null, "callbacks_on_episode_created": null, "callbacks_on_episode_start": null, "callbacks_on_episode_step": null, "callbacks_on_episode_end": null, "callbacks_on_evaluate_start": null, "callbacks_on_evaluate_end": null, "callbacks_on_evaluate_offline_start": null, "callbacks_on_evaluate_offline_end": null, "callbacks_on_sample_end": null, "callbacks_on_train_result": null, "explore": true, "enable_rl_module_and_learner": true, "enable_env_runner_and_connector_v2": true, "_prior_exploration_config": {"type": "StochasticSampling"}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x13c0118a0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "offline_data_class": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_read_batch_size": null, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "materialize_data": false, "materialize_mapped_data": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "ignore_final_observation": false, "prelearner_class": null, "prelearner_buffer_class": null, "prelearner_buffer_kwargs": {}, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_remaining_data": false, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": 1, "evaluation_duration": 20, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_auto_duration_min_env_steps_per_sample": 100, "evaluation_auto_duration_max_env_steps_per_sample": 2000, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 1, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "offline_evaluation_interval": null, "num_offline_eval_runners": 0, "offline_loss_for_module_fn": null, "offline_evaluation_duration": 1, "offline_evaluation_parallel_to_training": false, "offline_evaluation_timeout_s": 120.0, "num_cpus_per_offline_eval_runner": 1, "num_gpus_per_offline_eval_runner": 0, "custom_resources_per_offline_eval_runner": {}, "restart_failed_offline_eval_runners": true, "ignore_offline_eval_runner_failures": false, "max_num_offline_eval_runner_restarts": 1000, "offline_eval_runner_restore_timeout_s": 1800.0, "max_requests_in_flight_per_offline_eval_runner": 1, "validate_offline_eval_runners_after_construction": true, "offline_eval_runner_health_probe_timeout_s": 30.0, "offline_eval_rl_module_inference_only": false, "broadcast_offline_eval_runner_states": false, "offline_eval_batch_size_per_runner": 256, "dataset_num_iters_per_eval_runner": 1, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "log_gradients": false, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 9, "restart_failed_env_runners": true, "ignore_env_runner_failures": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30.0, "env_runner_restore_timeout_s": 1800.0, "_model_config": {}, "_rl_module_spec": "MultiRLModuleSpec(multi_rl_module_class=<class 'ray.rllib.core.rl_module.multi_rl_module.MultiRLModule'>, observation_space=None, action_space=None, inference_only=False, model_config=None, rl_module_specs={'default_policy': RLModuleSpec(module_class=<class 'source.intrinsic_attention_ppo.rl_modules.DifferentiablePPOModule.DifferentiablePPOModule'>, observation_space=None, action_space=None, inference_only=False, learner_only=False, model_config={'vf_share_layers': True, 'embedding_dim': 62, 'max_seq_len': 6, 'policy_head_hidden_sizes': [32], 'value_head_hidden_sizes': [101], 'embedding_hidden_sizes': [121]}, catalog_class=None, load_state_path=None, model_config_dict=None), 'intrinsic_reward_module': RLModuleSpec(module_class=<class 'source.intrinsic_attention_ppo.rl_modules.IntrinsicAttentionModule.IntrinsicAttentionModule'>, observation_space=None, action_space=None, inference_only=False, learner_only=True, model_config={'intrinsic_reward_network': {'encoder_hidden_sizes': [], 'encoding_dim': 1, 'num_heads': 1, 'head_hidden_sizes': None, 'layers': [{'type': 'attention'}]}, 'extrinsic_value_hidden_layers': [127, 60], 'vf_share_layers': True, 'max_seq_len': 6}, catalog_class=None, load_state_path=None, model_config_dict=None)}, load_state_path=None, modules_to_load=None, module_specs={'default_policy': RLModuleSpec(module_class=<class 'source.intrinsic_attention_ppo.rl_modules.DifferentiablePPOModule.DifferentiablePPOModule'>, observation_space=None, action_space=None, inference_only=False, learner_only=False, model_config={'vf_share_layers': True, 'embedding_dim': 62, 'max_seq_len': 6, 'policy_head_hidden_sizes': [32], 'value_head_hidden_sizes': [101], 'embedding_hidden_sizes': [121]}, catalog_class=None, load_state_path=None, model_config_dict=None), 'intrinsic_reward_module': RLModuleSpec(module_class=<class 'source.intrinsic_attention_ppo.rl_modules.IntrinsicAttentionModule.IntrinsicAttentionModule'>, observation_space=None, action_space=None, inference_only=False, learner_only=True, model_config={'intrinsic_reward_network': {'encoder_hidden_sizes': [], 'encoding_dim': 1, 'num_heads': 1, 'head_hidden_sizes': None, 'layers': [{'type': 'attention'}]}, 'extrinsic_value_hidden_layers': [127, 60], 'vf_share_layers': True, 'max_seq_len': 6}, catalog_class=None, load_state_path=None, model_config_dict=None)})", "algorithm_config_overrides_per_module": {"intrinsic_reward_module": {"lr": 0.0002715581955}}, "_per_module_overrides": {}, "_validate_config": true, "_use_msgpack_checkpoints": false, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "env_task_fn": -1, "enable_connectors": -1, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.161583927863, "kl_target": 0.0201019014258, "vf_loss_coeff": 0.7790510010087, "entropy_coeff": 0.0015431216992, "clip_param": 0.2459212356676, "vf_clip_param": 0.3769744131561, "entropy_coeff_schedule": null, "lr_schedule": null, "sgd_minibatch_size": -1, "vf_share_layers": -1, "differentiable_learner_configs": ["DifferentiableLearnerConfig(learner_class=<class 'source.intrinsic_attention_ppo.learners.IntrinsicAttentionPPOLearner.IntrinsicAttentionPPOLearner'>, learner_connector=None, add_default_connectors_to_learner_pipeline=True, is_multi_agent=False, policies_to_update=['default_policy'], lr=0.0060984166342, num_total_minibatches=0, num_epochs=1, minibatch_size=1000, shuffle_batch_per_epoch=True)"], "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9485408017724, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.callbacks.callbacks.RLlibCallback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 166.5278615951538, "iterations_since_restore": 17, "perf": {"cpu_util_percent": 36.440000000000005, "ram_util_percent": 79.51999999999998}}
{"timers": {"training_iteration": 9.618973739251981, "restore_env_runners": 1.9378532299348025e-05, "training_step": 9.618795587808709, "env_runner_sampling_timer": 1.7383717244059593, "learner_update_timer": 7.687419654016616, "synch_weights": 0.0008386473250379766, "restore_eval_env_runners": 1.0247244349429727e-05, "evaluation_iteration": 0.14057065962065782, "synch_eval_env_connectors": 0.00014615852962940304, "synch_env_connectors": 4.8739622470378355e-06}, "env_runners": {"module_to_env_connector": {"timers": {"connectors": {"listify_data_for_vector_env": 1.186021823695528e-05, "remove_single_ts_time_rank_from_batch": 1.3281176833221482e-05, "tensor_to_numpy": 1.7559079282613097e-05, "un_batch_to_individual_items": 7.429134233703036e-06, "normalize_and_clip_actions": 8.950464702791314e-06, "get_actions": 4.8346860300942234e-05}}, "connector_pipeline_timer": 0.00013647569147405116}, "env_to_module_sum_episodes_length_out": 10.36823839457432, "rlmodule_inference_timer": 3.742458705403429e-05, "env_to_module_connector": {"timers": {"connectors": {"add_observations_from_episodes_to_batch": 3.1866128685191865e-06, "add_time_dim_to_batch_and_zero_pad": 7.990867857290814e-06, "numpy_to_tensor": 1.4826745675400919e-05, "batch_individual_items": 1.4106812082088161e-05, "add_states_from_episodes_to_batch": 3.0037736291401e-06}}, "connector_pipeline_timer": 6.725638913199492e-05}, "episode_return_max": 14.5, "num_env_steps_sampled": 5000.0, "num_episodes": 250.0, "episode_len_max": 20, "sample": 0.006425821800445485, "weights_seq_no": 17.0, "num_episodes_lifetime": -493500.0, "env_to_module_sum_episodes_length_in": 10.36823839457432, "num_agent_steps_sampled": {"default_agent": 5000.0}, "num_env_steps_sampled_lifetime": -9870000.0, "episode_duration_sec_mean": 0.006084540136624125, "episode_return_mean": 6.019999999999998, "num_module_steps_sampled": {"default_policy": 5000.0}, "env_reset_timer": 5.456305708847902e-05, "num_module_steps_sampled_lifetime": {"default_policy": -9870000.0}, "agent_episode_returns_mean": {"default_agent": 6.019999999999998}, "env_step_timer": 1.6446026119478157e-05, "episode_return_min": -5.5, "episode_len_min": 20, "episode_len_mean": 20.0, "num_agent_steps_sampled_lifetime": {"default_agent": -9870000.0}, "module_episode_returns_mean": {"default_policy": 6.019999999999998}, "time_between_sampling": 0.0368762936192416, "num_env_steps_sampled_lifetime_throughput": 2883.422672897854}, "__all_modules__": {"learner_connector_sum_episodes_length_in": 5000.0, "learner_connector": {"connector_pipeline_timer": 0.15473261188643161, "timers": {"connectors": {"add_one_ts_to_episodes_and_truncate": 0.008960740238477033, "add_observations_from_episodes_to_batch": 0.0008573549410207565, "add_columns_from_episodes_to_train_batch": 0.04126494550670293, "add_time_dim_to_batch_and_zero_pad": 0.08987213796614038, "add_states_from_episodes_to_batch": 0.003628980557420243, "batch_individual_items": 0.009950619105182105, "numpy_to_tensor": 6.367973041937944e-05}}}, "learner_connector_sum_episodes_length_out": 5250.0}, "learners": {"intrinsic_reward_module": {"weights_seq_no": 18.0, "num_module_steps_trained_lifetime": 107730, "gradients_default_optimizer_global_norm": 0.0, "module_train_batch_size_mean": 998.0016398003509, "diff_num_grad_updates_vs_sampler_policy": 1.0, "num_trainable_parameters": 8266, "default_optimizer_learning_rate": 0.0002715581955, "total_loss": 0.0, "num_module_steps_trained": 5985, "curr_entropy_coeff": 0.0015431216992, "num_module_steps_trained_lifetime_throughput": 734.6851438708871}, "differentiable_learners": {"intrinsic_attention_ppo_learner": {"intrinsic_reward_module": {"total_loss": 0.0, "num_module_steps_trained": 35910, "diff_num_grad_updates_vs_sampler_policy": 91.0, "weights_seq_no": 108.0, "num_module_steps_trained_lifetime": 646380, "module_train_batch_size_mean": 997.4947003847115}, "default_policy": {"vf_explained_var": 0.0013712644577026367, "total_loss": 0.24870091676712036, "vf_loss": 0.3206491470336914, "vf_loss_unclipped": 46.252967834472656, "weights_seq_no": 108.0, "num_module_steps_trained_lifetime": 646380, "module_train_batch_size_mean": 997.4947003847115, "entropy": 0.6853308081626892, "mean_kl_loss": 1.496171876169683e-06, "use_intrinsic_rewards": 1.0, "policy_loss": -4.3822743464261293e-05, "num_module_steps_trained": 35910, "diff_num_grad_updates_vs_sampler_policy": 91.0}, "__all_modules__": {"num_env_steps_trained_lifetime": 3888000, "num_module_steps_trained_lifetime": 1292760, "num_module_steps_trained": 71820, "num_env_steps_trained": 216000, "num_env_steps_trained_lifetime_throughput": 48333.52376278751}}}, "default_policy": {"curr_kl_coeff": 6.163937769088079e-07, "num_module_steps_trained_lifetime": 107730, "module_train_batch_size_mean": 998.0016398003509, "entropy": 0.6853178143501282, "num_trainable_parameters": 16595, "mean_kl_loss": 1.689170858298894e-06, "use_intrinsic_rewards": 0.0, "policy_loss": -4.6023840695852414e-05, "num_module_steps_trained": 5985, "diff_num_grad_updates_vs_sampler_policy": 1.0, "vf_explained_var": 4.0411949157714844e-05, "total_loss": 0.2485893964767456, "vf_loss": 0.3205091059207916, "curr_entropy_coeff": 0.0015431216992, "vf_loss_unclipped": 46.337791442871094, "weights_seq_no": 18.0, "num_module_steps_trained_lifetime_throughput": 734.6798898600775}, "__all_modules__": {"num_module_steps_trained": 11970, "num_non_trainable_parameters": 0, "num_env_steps_trained": 36000, "num_env_steps_trained_lifetime": 648000, "num_module_steps_trained_lifetime": 215460, "num_trainable_parameters": 24861, "num_env_steps_trained_lifetime_throughput": 4422.343499400098, "num_module_steps_trained_throughput": 20987921.083917607, "num_module_steps_trained_lifetime_throughput": 12849804.010147586}, "IntrinsicAttentionMask": [[[0.16684246063232422, 0.16600437462329865, 0.1659819334745407, 0.16723214089870453, 0.16675221920013428, 0.16718690097332], [0.16673654317855835, 0.16640391945838928, 0.16639499366283417, 0.16689085960388184, 0.16670078039169312, 0.16687294840812683], [0.16673369705677032, 0.16641466319561005, 0.16640609502792358, 0.16688169538974762, 0.1666993945837021, 0.1668645292520523], [0.16689136624336243, 0.1658194363117218, 0.16579073667526245, 0.16739030182361603, 0.1667758673429489, 0.16733238101005554], [0.1668310910463333, 0.16604726016521454, 0.1660262644290924, 0.16719545423984528, 0.16674670577049255, 0.16715316474437714], [0.16688570380210876, 0.16584086418151855, 0.1658128947019577, 0.1673719584941864, 0.16677314043045044, 0.1673154979944229]], [[0.1677504926919937, 0.16877777874469757, 0.16466756165027618, 0.16567596793174744, 0.16861724853515625, 0.16451095044612885], [0.16789376735687256, 0.1690591722726822, 0.16440199315547943, 0.16554316878318787, 0.1688769906759262, 0.16422484815120697], [0.1673138588666916, 0.16792358458042145, 0.16547495126724243, 0.16607795655727386, 0.16782841086387634, 0.16538114845752716], [0.16745781898498535, 0.16820462048053741, 0.16520912945270538, 0.165945902466774, 0.16808800399303436, 0.16509458422660828], [0.16787144541740417, 0.1690153032541275, 0.16444338858127594, 0.16556388139724731, 0.16883650422096252, 0.16426943242549896], [0.16729144752025604, 0.16787981986999512, 0.16551640629768372, 0.16609854996204376, 0.16778798401355743, 0.1654258519411087]], [[0.1670711189508438, 0.16577725112438202, 0.1662093997001648, 0.1670033484697342, 0.16698074340820312, 0.16695816814899445], [0.16669432818889618, 0.16660577058792114, 0.1666354238986969, 0.1666897088289261, 0.16668817400932312, 0.16668662428855896], [0.16682055592536926, 0.16632801294326782, 0.1664927899837494, 0.1667948067188263, 0.16678623855113983, 0.16677765548229218], [0.16705146431922913, 0.1658204197883606, 0.1662316471338272, 0.16698698699474335, 0.16696549952030182, 0.1669440120458603], [0.16704490780830383, 0.16583481431007385, 0.16623905301094055, 0.1669815331697464, 0.16696041822433472, 0.16693930327892303], [0.16703835129737854, 0.1658492088317871, 0.1662464588880539, 0.16697607934474945, 0.16695532202720642, 0.1669345647096634]], [[0.16913466155529022, 0.16907352209091187, 0.16438792645931244, 0.16553600132465363, 0.1676582545042038, 0.16420970857143402], [0.16911965608596802, 0.1690588891506195, 0.16440172493457794, 0.16554290056228638, 0.16765229403972626, 0.1642245650291443], [0.16795526444911957, 0.16792352497577667, 0.16547489166259766, 0.1660778969526291, 0.1671873778104782, 0.16538110375404358], [0.1682433784008026, 0.16820448637008667, 0.16520899534225464, 0.16594576835632324, 0.1673029065132141, 0.16509446501731873], [0.1687711477279663, 0.1687190979719162, 0.16472254693508148, 0.16570331156253815, 0.16751369833946228, 0.16457021236419678], [0.1679103523492813, 0.16787973046302795, 0.16551631689071655, 0.1660984456539154, 0.16716933250427246, 0.16542576253414154]], [[0.16504129767417908, 0.1661570966243744, 0.1661272644996643, 0.16779127717018127, 0.1671520173549652, 0.16773100197315216], [0.16430072486400604, 0.16592244803905487, 0.1658789962530136, 0.16830658912658691, 0.1673726886510849, 0.1682184636592865], [0.1643204540014267, 0.16592873632907867, 0.16588565707206726, 0.16829286515712738, 0.1673668473958969, 0.16820548474788666], [0.163228839635849, 0.16558006405830383, 0.1655169427394867, 0.1690557301044464, 0.16769157350063324, 0.16892684996128082], [0.16364634037017822, 0.1657138168811798, 0.1656583547592163, 0.16876345872879028, 0.1675674319267273, 0.16865050792694092], [0.1632681041955948, 0.16559267044067383, 0.165530264377594, 0.16902822256088257, 0.16767990589141846, 0.16890084743499756]], [[0.16771277785301208, 0.16716724634170532, 0.16570031642913818, 0.16619010269641876, 0.16709035634994507, 0.1661391407251358], [0.16739462316036224, 0.16701534390449524, 0.1659936159849167, 0.16633504629135132, 0.16696186363697052, 0.16629953682422638], [0.16653555631637573, 0.1666036993265152, 0.16678819060325623, 0.16672638058662415, 0.16661332547664642, 0.1667328029870987], [0.16682295501232147, 0.16674165427684784, 0.16652192175388336, 0.1665954738855362, 0.16673018038272858, 0.16658782958984375], [0.167349711060524, 0.1669938713312149, 0.1660350263118744, 0.16635549068450928, 0.16694368422031403, 0.16632217168807983], [0.1667930781841278, 0.16672731935977936, 0.16654957830905914, 0.16660907864570618, 0.1667180359363556, 0.16660289466381073]]]}, "num_training_step_calls_per_iteration": 1, "evaluation": {"env_runners": {"episode_len_min": 20, "env_to_module_connector": {"timers": {"connectors": {"numpy_to_tensor": 1.1983303077497063e-05, "add_states_from_episodes_to_batch": 2.7069235472925193e-06, "batch_individual_items": 1.231324490884142e-05, "add_time_dim_to_batch_and_zero_pad": 6.806110112523944e-06, "add_observations_from_episodes_to_batch": 2.855587856225536e-06}}, "connector_pipeline_timer": 5.849916785956303e-05}, "module_to_env_connector": {"timers": {"connectors": {"tensor_to_numpy": 1.483625173692679e-05, "un_batch_to_individual_items": 6.561319777716442e-06, "normalize_and_clip_actions": 7.847614352382283e-06, "get_actions": 3.5508395423447925e-05, "remove_single_ts_time_rank_from_batch": 1.1960009862738202e-05, "listify_data_for_vector_env": 1.0449488515111155e-05}}, "connector_pipeline_timer": 0.00011296317256487033}, "num_env_steps_sampled": 400, "episode_len_max": 20, "num_agent_steps_sampled": {"default_agent": 400}, "weights_seq_no": 18.0, "num_env_steps_sampled_lifetime": 90400, "episode_duration_sec_mean": 0.005644389181397856, "episode_return_mean": 0.5, "env_reset_timer": 0.00016374565052604278, "module_episode_returns_mean": {"default_policy": 0.5}, "rlmodule_inference_timer": 3.031044685242118e-05, "episode_return_max": 15.5, "env_to_module_sum_episodes_length_in": 10.368238394574323, "num_module_steps_sampled": {"default_policy": 400}, "agent_episode_returns_mean": {"default_agent": 0.5}, "num_agent_steps_sampled_lifetime": {"default_agent": 7200}, "num_module_steps_sampled_lifetime": {"default_policy": 7200}, "env_to_module_sum_episodes_length_out": 10.368238394574323, "num_episodes": 20, "num_episodes_lifetime": 360, "episode_return_min": -13.5, "sample": 0.1337434237099106, "env_step_timer": 1.3744403922870914e-05, "episode_len_mean": 20.0, "time_between_sampling": 9.651987742697631}, "num_healthy_workers": 1, "actor_manager_num_outstanding_async_reqs": 0, "num_remote_worker_restarts": 0}, "num_env_steps_sampled_lifetime": -9870000.0, "fault_tolerance": {"num_healthy_workers": 0, "num_remote_worker_restarts": 0}, "env_runner_group": {"actor_manager_num_outstanding_async_reqs": 0}, "done": false, "training_iteration": 18, "trial_id": "b17e2_00000", "date": "2025-08-11_18-46-06", "timestamp": 1754930766, "time_this_iter_s": 9.762612104415894, "time_total_s": 176.2904736995697, "pid": 11680, "hostname": "Mac", "node_ip": "127.0.0.1", "config": {"exploration_config": {}, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 2, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "env": "Umbrella", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": false, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 0, "create_local_env_runner": true, "num_envs_per_env_runner": 1, "gym_env_vectorize_mode": "SYNC", "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "episodes_to_numpy": true, "max_requests_in_flight_per_env_runner": 1, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "merge_env_runner_states": "training_only", "broadcast_env_runner_states": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "complete_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "sampler_perf_stats_ema_coef": null, "_is_online": true, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": "auto", "num_aggregator_actors_per_learner": 0, "max_requests_in_flight_per_aggregator_actor": 3, "local_gpu_idx": 0, "max_requests_in_flight_per_learner": 3, "gamma": 1, "lr": 0.0002715581955, "grad_clip": 0.5, "grad_clip_by": "global_norm", "_train_batch_size_per_learner": 5000, "train_batch_size": 4000, "num_epochs": 1, "minibatch_size": 1000, "shuffle_batch_per_epoch": true, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "log_std_clip_param": 20.0, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "_disable_preprocessor_api": false, "_disable_action_flattening": false}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {"intrinsic_reward_coeff": 0.2795015916508}, "optimizer": {}, "_learner_class": "<class 'source.intrinsic_attention_ppo.learners.IntrinsicAttentionMetaLearner.IntrinsicAttentionMetaLearner'>", "callbacks_on_algorithm_init": null, "callbacks_on_env_runners_recreated": null, "callbacks_on_offline_eval_runners_recreated": null, "callbacks_on_checkpoint_loaded": null, "callbacks_on_environment_created": null, "callbacks_on_episode_created": null, "callbacks_on_episode_start": null, "callbacks_on_episode_step": null, "callbacks_on_episode_end": null, "callbacks_on_evaluate_start": null, "callbacks_on_evaluate_end": null, "callbacks_on_evaluate_offline_start": null, "callbacks_on_evaluate_offline_end": null, "callbacks_on_sample_end": null, "callbacks_on_train_result": null, "explore": true, "enable_rl_module_and_learner": true, "enable_env_runner_and_connector_v2": true, "_prior_exploration_config": {"type": "StochasticSampling"}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x13c0118a0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "offline_data_class": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_read_batch_size": null, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "materialize_data": false, "materialize_mapped_data": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "ignore_final_observation": false, "prelearner_class": null, "prelearner_buffer_class": null, "prelearner_buffer_kwargs": {}, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_remaining_data": false, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": 1, "evaluation_duration": 20, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_auto_duration_min_env_steps_per_sample": 100, "evaluation_auto_duration_max_env_steps_per_sample": 2000, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 1, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "offline_evaluation_interval": null, "num_offline_eval_runners": 0, "offline_loss_for_module_fn": null, "offline_evaluation_duration": 1, "offline_evaluation_parallel_to_training": false, "offline_evaluation_timeout_s": 120.0, "num_cpus_per_offline_eval_runner": 1, "num_gpus_per_offline_eval_runner": 0, "custom_resources_per_offline_eval_runner": {}, "restart_failed_offline_eval_runners": true, "ignore_offline_eval_runner_failures": false, "max_num_offline_eval_runner_restarts": 1000, "offline_eval_runner_restore_timeout_s": 1800.0, "max_requests_in_flight_per_offline_eval_runner": 1, "validate_offline_eval_runners_after_construction": true, "offline_eval_runner_health_probe_timeout_s": 30.0, "offline_eval_rl_module_inference_only": false, "broadcast_offline_eval_runner_states": false, "offline_eval_batch_size_per_runner": 256, "dataset_num_iters_per_eval_runner": 1, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "log_gradients": false, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 9, "restart_failed_env_runners": true, "ignore_env_runner_failures": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30.0, "env_runner_restore_timeout_s": 1800.0, "_model_config": {}, "_rl_module_spec": "MultiRLModuleSpec(multi_rl_module_class=<class 'ray.rllib.core.rl_module.multi_rl_module.MultiRLModule'>, observation_space=None, action_space=None, inference_only=False, model_config=None, rl_module_specs={'default_policy': RLModuleSpec(module_class=<class 'source.intrinsic_attention_ppo.rl_modules.DifferentiablePPOModule.DifferentiablePPOModule'>, observation_space=None, action_space=None, inference_only=False, learner_only=False, model_config={'vf_share_layers': True, 'embedding_dim': 62, 'max_seq_len': 6, 'policy_head_hidden_sizes': [32], 'value_head_hidden_sizes': [101], 'embedding_hidden_sizes': [121]}, catalog_class=None, load_state_path=None, model_config_dict=None), 'intrinsic_reward_module': RLModuleSpec(module_class=<class 'source.intrinsic_attention_ppo.rl_modules.IntrinsicAttentionModule.IntrinsicAttentionModule'>, observation_space=None, action_space=None, inference_only=False, learner_only=True, model_config={'intrinsic_reward_network': {'encoder_hidden_sizes': [], 'encoding_dim': 1, 'num_heads': 1, 'head_hidden_sizes': None, 'layers': [{'type': 'attention'}]}, 'extrinsic_value_hidden_layers': [127, 60], 'vf_share_layers': True, 'max_seq_len': 6}, catalog_class=None, load_state_path=None, model_config_dict=None)}, load_state_path=None, modules_to_load=None, module_specs={'default_policy': RLModuleSpec(module_class=<class 'source.intrinsic_attention_ppo.rl_modules.DifferentiablePPOModule.DifferentiablePPOModule'>, observation_space=None, action_space=None, inference_only=False, learner_only=False, model_config={'vf_share_layers': True, 'embedding_dim': 62, 'max_seq_len': 6, 'policy_head_hidden_sizes': [32], 'value_head_hidden_sizes': [101], 'embedding_hidden_sizes': [121]}, catalog_class=None, load_state_path=None, model_config_dict=None), 'intrinsic_reward_module': RLModuleSpec(module_class=<class 'source.intrinsic_attention_ppo.rl_modules.IntrinsicAttentionModule.IntrinsicAttentionModule'>, observation_space=None, action_space=None, inference_only=False, learner_only=True, model_config={'intrinsic_reward_network': {'encoder_hidden_sizes': [], 'encoding_dim': 1, 'num_heads': 1, 'head_hidden_sizes': None, 'layers': [{'type': 'attention'}]}, 'extrinsic_value_hidden_layers': [127, 60], 'vf_share_layers': True, 'max_seq_len': 6}, catalog_class=None, load_state_path=None, model_config_dict=None)})", "algorithm_config_overrides_per_module": {"intrinsic_reward_module": {"lr": 0.0002715581955}}, "_per_module_overrides": {}, "_validate_config": true, "_use_msgpack_checkpoints": false, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "env_task_fn": -1, "enable_connectors": -1, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.161583927863, "kl_target": 0.0201019014258, "vf_loss_coeff": 0.7790510010087, "entropy_coeff": 0.0015431216992, "clip_param": 0.2459212356676, "vf_clip_param": 0.3769744131561, "entropy_coeff_schedule": null, "lr_schedule": null, "sgd_minibatch_size": -1, "vf_share_layers": -1, "differentiable_learner_configs": ["DifferentiableLearnerConfig(learner_class=<class 'source.intrinsic_attention_ppo.learners.IntrinsicAttentionPPOLearner.IntrinsicAttentionPPOLearner'>, learner_connector=None, add_default_connectors_to_learner_pipeline=True, is_multi_agent=False, policies_to_update=['default_policy'], lr=0.0060984166342, num_total_minibatches=0, num_epochs=1, minibatch_size=1000, shuffle_batch_per_epoch=True)"], "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9485408017724, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.callbacks.callbacks.RLlibCallback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 176.2904736995697, "iterations_since_restore": 18, "perf": {"cpu_util_percent": 42.66428571428571, "ram_util_percent": 79.32142857142857}}
{"timers": {"training_iteration": 9.616749785609635, "restore_env_runners": 1.924683708825094e-05, "training_step": 9.61657109901007, "env_runner_sampling_timer": 1.7360955592520937, "learner_update_timer": 7.687363094556543, "synch_weights": 0.0008414037620129137, "restore_eval_env_runners": 1.0216441834664963e-05, "evaluation_iteration": 0.14038905844427513, "synch_eval_env_connectors": 0.000145675274250525, "synch_env_connectors": 4.864382410523601e-06}, "env_runners": {"module_to_env_connector": {"timers": {"connectors": {"listify_data_for_vector_env": 1.0353798128241278e-05, "remove_single_ts_time_rank_from_batch": 1.185260241130484e-05, "tensor_to_numpy": 1.5083203557167596e-05, "un_batch_to_individual_items": 6.602538566288001e-06, "normalize_and_clip_actions": 7.848283918354008e-06, "get_actions": 3.828580638248435e-05}}, "connector_pipeline_timer": 0.00011608037192620102}, "env_to_module_sum_episodes_length_out": 10.36823839457432, "rlmodule_inference_timer": 3.1311824068545084e-05, "env_to_module_connector": {"timers": {"connectors": {"add_observations_from_episodes_to_batch": 2.7470294965629736e-06, "add_time_dim_to_batch_and_zero_pad": 6.821825873616781e-06, "numpy_to_tensor": 1.2457616813761959e-05, "batch_individual_items": 1.229554094697298e-05, "add_states_from_episodes_to_batch": 2.6715141558852155e-06}}, "connector_pipeline_timer": 5.862224172613008e-05}, "episode_return_max": 14.5, "num_env_steps_sampled": 5000.0, "num_episodes": 250.0, "episode_len_max": 20, "sample": 0.005738934638960525, "weights_seq_no": 18.0, "num_episodes_lifetime": -524375.0, "env_to_module_sum_episodes_length_in": 10.36823839457432, "num_agent_steps_sampled": {"default_agent": 5000.0}, "num_env_steps_sampled_lifetime": -10487500.0, "episode_duration_sec_mean": 0.005196896291803567, "episode_return_mean": 5.940000000000001, "num_module_steps_sampled": {"default_policy": 5000.0}, "env_reset_timer": 4.191870651036364e-05, "num_module_steps_sampled_lifetime": {"default_policy": -10487500.0}, "agent_episode_returns_mean": {"default_agent": 5.940000000000001}, "env_step_timer": 1.3732665550279326e-05, "episode_return_min": -5.5, "episode_len_min": 20, "episode_len_mean": 20.0, "num_agent_steps_sampled_lifetime": {"default_agent": -10487500.0}, "module_episode_returns_mean": {"default_policy": 5.940000000000001}, "time_between_sampling": 0.03286636656431003, "num_env_steps_sampled_lifetime_throughput": 3303.6207780841282}, "__all_modules__": {"learner_connector_sum_episodes_length_in": 5000.0, "learner_connector": {"connector_pipeline_timer": 0.15472401451787812, "timers": {"connectors": {"add_one_ts_to_episodes_and_truncate": 0.008959872836593538, "add_observations_from_episodes_to_batch": 0.0008574301408186268, "add_columns_from_episodes_to_train_batch": 0.041273516472029995, "add_time_dim_to_batch_and_zero_pad": 0.0898747090872636, "add_states_from_episodes_to_batch": 0.0036298303419771594, "batch_individual_items": 0.009930746664850233, "numpy_to_tensor": 6.382710323055222e-05}}}, "learner_connector_sum_episodes_length_out": 5250.0}, "learners": {"intrinsic_reward_module": {"weights_seq_no": 19.0, "num_module_steps_trained_lifetime": 113715, "gradients_default_optimizer_global_norm": 0.0, "module_train_batch_size_mean": 997.9718428097785, "diff_num_grad_updates_vs_sampler_policy": 1.0, "num_trainable_parameters": 8266, "default_optimizer_learning_rate": 0.0002715581955, "total_loss": 0.0, "num_module_steps_trained": 5985, "curr_entropy_coeff": 0.0015431216992, "num_module_steps_trained_lifetime_throughput": 732.8772478842579}, "differentiable_learners": {"intrinsic_attention_ppo_learner": {"intrinsic_reward_module": {"total_loss": 0.0, "num_module_steps_trained": 35910, "diff_num_grad_updates_vs_sampler_policy": 96.0, "weights_seq_no": 114.0, "num_module_steps_trained_lifetime": 682290, "module_train_batch_size_mean": 997.4940209352853}, "default_policy": {"vf_explained_var": 0.0014050006866455078, "total_loss": 0.24876266717910767, "vf_loss": 0.32063519954681396, "vf_loss_unclipped": 48.41705322265625, "weights_seq_no": 114.0, "num_module_steps_trained_lifetime": 682290, "module_train_batch_size_mean": 997.4940209352853, "entropy": 0.6852022409439087, "mean_kl_loss": 4.0731142689764965e-06, "use_intrinsic_rewards": 1.0, "policy_loss": 2.818821849359665e-05, "num_module_steps_trained": 35910, "diff_num_grad_updates_vs_sampler_policy": 96.0}, "__all_modules__": {"num_env_steps_trained_lifetime": 4104000, "num_module_steps_trained_lifetime": 1364580, "num_module_steps_trained": 71820, "num_env_steps_trained": 216000, "num_env_steps_trained_lifetime_throughput": 47668.329160397894}}}, "default_policy": {"curr_kl_coeff": 3.0819688845440396e-07, "num_module_steps_trained_lifetime": 113715, "module_train_batch_size_mean": 997.9718428097785, "entropy": 0.6852163076400757, "num_trainable_parameters": 16595, "mean_kl_loss": 3.7679440083593363e-06, "use_intrinsic_rewards": 0.0, "policy_loss": 2.543408118071966e-05, "num_module_steps_trained": 5985, "diff_num_grad_updates_vs_sampler_policy": 1.0, "vf_explained_var": 8.547306060791016e-05, "total_loss": 0.2486610859632492, "vf_loss": 0.3205091953277588, "curr_entropy_coeff": 0.0015431216992, "vf_loss_unclipped": 48.50887680053711, "weights_seq_no": 19.0, "num_module_steps_trained_lifetime_throughput": 732.8723608227681}, "__all_modules__": {"num_module_steps_trained": 11970, "num_non_trainable_parameters": 0, "num_env_steps_trained": 36000, "num_env_steps_trained_lifetime": 684000, "num_module_steps_trained_lifetime": 227430, "num_trainable_parameters": 24861, "num_env_steps_trained_lifetime_throughput": 4411.349129584776, "num_module_steps_trained_throughput": 20561104.668900173, "num_module_steps_trained_lifetime_throughput": 12847693.118832905}, "IntrinsicAttentionMask": [[[0.16534246504306793, 0.1664603054523468, 0.16582612693309784, 0.16748712956905365, 0.16745704412460327, 0.1674269586801529], [0.16473841667175293, 0.16636447608470917, 0.1654413491487503, 0.16786253452301025, 0.1678185760974884, 0.16777463257312775], [0.16508044302463531, 0.1664188653230667, 0.1656593233346939, 0.16764986515045166, 0.16761377453804016, 0.16757769882678986], [0.16418828070163727, 0.1662762612104416, 0.1650901734828949, 0.16820508241653442, 0.16814841330051422, 0.1680917739868164], [0.16420432925224304, 0.16627885401248932, 0.16510042548179626, 0.16819508373737335, 0.168138787150383, 0.16808252036571503], [0.16422037780284882, 0.16628141701221466, 0.16511067748069763, 0.1681850552558899, 0.16812913119792938, 0.16807323694229126]], [[0.16757287085056305, 0.16859906911849976, 0.16449321806430817, 0.16550053656101227, 0.16843871772289276, 0.165395587682724], [0.167692631483078, 0.1688566505908966, 0.16420505940914154, 0.16534486413002014, 0.16867469251155853, 0.1652260571718216], [0.16720785200595856, 0.16781719028949738, 0.16537010669708252, 0.1659727394580841, 0.16772207617759705, 0.1659100204706192], [0.16732820868492126, 0.16807442903518677, 0.16508126258850098, 0.16581745445728302, 0.16795790195465088, 0.16574081778526306], [0.1676739752292633, 0.1688164919614792, 0.1642499566078186, 0.16536913812160492, 0.16863790154457092, 0.16525249183177948], [0.16731570661067963, 0.1680476814508438, 0.165111243724823, 0.16583359241485596, 0.167933389544487, 0.1657583862543106]], [[0.16504129767417908, 0.1661570966243744, 0.1661272644996643, 0.16779127717018127, 0.16776113212108612, 0.1671220064163208], [0.16430070996284485, 0.16592243313789368, 0.16587898135185242, 0.16830657422542572, 0.1682625114917755, 0.1673288494348526], [0.16432040929794312, 0.1659286916255951, 0.16588561236858368, 0.1682928204536438, 0.16824913024902344, 0.16732333600521088], [0.16322875022888184, 0.16557998955249786, 0.16551685333251953, 0.16905564069747925, 0.16899119317531586, 0.16762755811214447], [0.16324840486049652, 0.16558630764484406, 0.16552352905273438, 0.16904190182685852, 0.16897782683372498, 0.16762210428714752], [0.16366596519947052, 0.16572006046772003, 0.16566495597362518, 0.16874966025352478, 0.16869355738162994, 0.16750583052635193]], [[0.16697949171066284, 0.16733002662658691, 0.1662854105234146, 0.1662673056125641, 0.16690674424171448, 0.16623106598854065], [0.16710050404071808, 0.16758733987808228, 0.1661376804113388, 0.16611257195472717, 0.16699950397014618, 0.1660623550415039], [0.16673889756202698, 0.16681957244873047, 0.1665787398815155, 0.16657455265522003, 0.1667221337556839, 0.1665661782026291], [0.16673259437084198, 0.16680623590946198, 0.16658641397953033, 0.16658258438110352, 0.1667172908782959, 0.16657494008541107], [0.16695430874824524, 0.1672765612602234, 0.16631609201431274, 0.16629943251609802, 0.16688743233680725, 0.16626611351966858], [0.16671998798847198, 0.1667795479297638, 0.1666017472743988, 0.16659864783287048, 0.1667076200246811, 0.16659247875213623]], [[0.16534247994422913, 0.16585592925548553, 0.16643042862415314, 0.16748714447021484, 0.16745705902576447, 0.1674269735813141], [0.16506437957286835, 0.16568513214588165, 0.1663801670074463, 0.1676599234342575, 0.16762347519397736, 0.167587012052536], [0.16475455462932587, 0.1654946208000183, 0.16632388532161713, 0.16785256564617157, 0.16780897974967957, 0.16776540875434875], [0.16418832540512085, 0.1651458740234375, 0.1662203073501587, 0.1682051420211792, 0.168148472905159, 0.16809183359146118], [0.16420438885688782, 0.16515576839447021, 0.16622325778007507, 0.16819514334201813, 0.16813884675502777, 0.1680825799703598], [0.16422045230865479, 0.16516567766666412, 0.16622622311115265, 0.16818514466285706, 0.16812922060489655, 0.16807332634925842]], [[0.16913466155529022, 0.16907352209091187, 0.16438794136047363, 0.16553600132465363, 0.1676582545042038, 0.16420972347259521], [0.16911965608596802, 0.1690588891506195, 0.16440172493457794, 0.16554290056228638, 0.16765229403972626, 0.16422457993030548], [0.16795526444911957, 0.16792352497577667, 0.16547489166259766, 0.1660778969526291, 0.1671873778104782, 0.16538110375404358], [0.1682433784008026, 0.16820448637008667, 0.16520899534225464, 0.16594576835632324, 0.1673029065132141, 0.16509446501731873], [0.16877113282680511, 0.168719083070755, 0.1647225320339203, 0.16570331156253815, 0.1675136834383011, 0.16457019746303558], [0.1679103523492813, 0.16787973046302795, 0.16551631689071655, 0.1660984605550766, 0.16716933250427246, 0.16542576253414154]]]}, "num_training_step_calls_per_iteration": 1, "evaluation": {"env_runners": {"episode_len_min": 20, "env_to_module_connector": {"timers": {"connectors": {"numpy_to_tensor": 1.2014643612383282e-05, "add_states_from_episodes_to_batch": 2.731215494107712e-06, "batch_individual_items": 1.2453195783653798e-05, "add_time_dim_to_batch_and_zero_pad": 7.047729653615589e-06, "add_observations_from_episodes_to_batch": 2.872652570459781e-06}}, "connector_pipeline_timer": 5.9130336126249086e-05}, "module_to_env_connector": {"timers": {"connectors": {"tensor_to_numpy": 1.4947817006319897e-05, "un_batch_to_individual_items": 6.5841652876198455e-06, "normalize_and_clip_actions": 7.933035594000896e-06, "get_actions": 3.6172717430532874e-05, "remove_single_ts_time_rank_from_batch": 1.1963731591184918e-05, "listify_data_for_vector_env": 1.0501641464420364e-05}}, "connector_pipeline_timer": 0.0001140806581237303}, "num_env_steps_sampled": 400, "episode_len_max": 20, "num_agent_steps_sampled": {"default_agent": 400}, "weights_seq_no": 19.0, "num_env_steps_sampled_lifetime": 95400, "episode_duration_sec_mean": 0.005636903721606359, "episode_return_mean": 0.3, "env_reset_timer": 0.00016291694406719948, "module_episode_returns_mean": {"default_policy": 0.3}, "rlmodule_inference_timer": 3.075960552281609e-05, "episode_return_max": 15.5, "env_to_module_sum_episodes_length_in": 10.368238394574323, "num_module_steps_sampled": {"default_policy": 400}, "agent_episode_returns_mean": {"default_agent": 0.3}, "num_agent_steps_sampled_lifetime": {"default_agent": 7600}, "num_module_steps_sampled_lifetime": {"default_policy": 7600}, "env_to_module_sum_episodes_length_out": 10.368238394574323, "num_episodes": 20, "num_episodes_lifetime": 380, "episode_return_min": -13.5, "sample": 0.13354125947231557, "env_step_timer": 1.3972625858990636e-05, "episode_len_mean": 20.0, "time_between_sampling": 9.649698376930644}, "num_healthy_workers": 1, "actor_manager_num_outstanding_async_reqs": 0, "num_remote_worker_restarts": 0}, "num_env_steps_sampled_lifetime": -10487500.0, "fault_tolerance": {"num_healthy_workers": 0, "num_remote_worker_restarts": 0}, "env_runner_group": {"actor_manager_num_outstanding_async_reqs": 0}, "done": false, "training_iteration": 19, "trial_id": "b17e2_00000", "date": "2025-08-11_18-46-16", "timestamp": 1754930776, "time_this_iter_s": 9.519216775894165, "time_total_s": 185.80969047546387, "pid": 11680, "hostname": "Mac", "node_ip": "127.0.0.1", "config": {"exploration_config": {}, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 2, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "env": "Umbrella", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": false, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 0, "create_local_env_runner": true, "num_envs_per_env_runner": 1, "gym_env_vectorize_mode": "SYNC", "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "episodes_to_numpy": true, "max_requests_in_flight_per_env_runner": 1, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "merge_env_runner_states": "training_only", "broadcast_env_runner_states": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "complete_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "sampler_perf_stats_ema_coef": null, "_is_online": true, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": "auto", "num_aggregator_actors_per_learner": 0, "max_requests_in_flight_per_aggregator_actor": 3, "local_gpu_idx": 0, "max_requests_in_flight_per_learner": 3, "gamma": 1, "lr": 0.0002715581955, "grad_clip": 0.5, "grad_clip_by": "global_norm", "_train_batch_size_per_learner": 5000, "train_batch_size": 4000, "num_epochs": 1, "minibatch_size": 1000, "shuffle_batch_per_epoch": true, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "log_std_clip_param": 20.0, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "_disable_preprocessor_api": false, "_disable_action_flattening": false}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {"intrinsic_reward_coeff": 0.2795015916508}, "optimizer": {}, "_learner_class": "<class 'source.intrinsic_attention_ppo.learners.IntrinsicAttentionMetaLearner.IntrinsicAttentionMetaLearner'>", "callbacks_on_algorithm_init": null, "callbacks_on_env_runners_recreated": null, "callbacks_on_offline_eval_runners_recreated": null, "callbacks_on_checkpoint_loaded": null, "callbacks_on_environment_created": null, "callbacks_on_episode_created": null, "callbacks_on_episode_start": null, "callbacks_on_episode_step": null, "callbacks_on_episode_end": null, "callbacks_on_evaluate_start": null, "callbacks_on_evaluate_end": null, "callbacks_on_evaluate_offline_start": null, "callbacks_on_evaluate_offline_end": null, "callbacks_on_sample_end": null, "callbacks_on_train_result": null, "explore": true, "enable_rl_module_and_learner": true, "enable_env_runner_and_connector_v2": true, "_prior_exploration_config": {"type": "StochasticSampling"}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x13c0118a0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "offline_data_class": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_read_batch_size": null, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "materialize_data": false, "materialize_mapped_data": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "ignore_final_observation": false, "prelearner_class": null, "prelearner_buffer_class": null, "prelearner_buffer_kwargs": {}, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_remaining_data": false, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": 1, "evaluation_duration": 20, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_auto_duration_min_env_steps_per_sample": 100, "evaluation_auto_duration_max_env_steps_per_sample": 2000, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 1, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "offline_evaluation_interval": null, "num_offline_eval_runners": 0, "offline_loss_for_module_fn": null, "offline_evaluation_duration": 1, "offline_evaluation_parallel_to_training": false, "offline_evaluation_timeout_s": 120.0, "num_cpus_per_offline_eval_runner": 1, "num_gpus_per_offline_eval_runner": 0, "custom_resources_per_offline_eval_runner": {}, "restart_failed_offline_eval_runners": true, "ignore_offline_eval_runner_failures": false, "max_num_offline_eval_runner_restarts": 1000, "offline_eval_runner_restore_timeout_s": 1800.0, "max_requests_in_flight_per_offline_eval_runner": 1, "validate_offline_eval_runners_after_construction": true, "offline_eval_runner_health_probe_timeout_s": 30.0, "offline_eval_rl_module_inference_only": false, "broadcast_offline_eval_runner_states": false, "offline_eval_batch_size_per_runner": 256, "dataset_num_iters_per_eval_runner": 1, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "log_gradients": false, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 9, "restart_failed_env_runners": true, "ignore_env_runner_failures": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30.0, "env_runner_restore_timeout_s": 1800.0, "_model_config": {}, "_rl_module_spec": "MultiRLModuleSpec(multi_rl_module_class=<class 'ray.rllib.core.rl_module.multi_rl_module.MultiRLModule'>, observation_space=None, action_space=None, inference_only=False, model_config=None, rl_module_specs={'default_policy': RLModuleSpec(module_class=<class 'source.intrinsic_attention_ppo.rl_modules.DifferentiablePPOModule.DifferentiablePPOModule'>, observation_space=None, action_space=None, inference_only=False, learner_only=False, model_config={'vf_share_layers': True, 'embedding_dim': 62, 'max_seq_len': 6, 'policy_head_hidden_sizes': [32], 'value_head_hidden_sizes': [101], 'embedding_hidden_sizes': [121]}, catalog_class=None, load_state_path=None, model_config_dict=None), 'intrinsic_reward_module': RLModuleSpec(module_class=<class 'source.intrinsic_attention_ppo.rl_modules.IntrinsicAttentionModule.IntrinsicAttentionModule'>, observation_space=None, action_space=None, inference_only=False, learner_only=True, model_config={'intrinsic_reward_network': {'encoder_hidden_sizes': [], 'encoding_dim': 1, 'num_heads': 1, 'head_hidden_sizes': None, 'layers': [{'type': 'attention'}]}, 'extrinsic_value_hidden_layers': [127, 60], 'vf_share_layers': True, 'max_seq_len': 6}, catalog_class=None, load_state_path=None, model_config_dict=None)}, load_state_path=None, modules_to_load=None, module_specs={'default_policy': RLModuleSpec(module_class=<class 'source.intrinsic_attention_ppo.rl_modules.DifferentiablePPOModule.DifferentiablePPOModule'>, observation_space=None, action_space=None, inference_only=False, learner_only=False, model_config={'vf_share_layers': True, 'embedding_dim': 62, 'max_seq_len': 6, 'policy_head_hidden_sizes': [32], 'value_head_hidden_sizes': [101], 'embedding_hidden_sizes': [121]}, catalog_class=None, load_state_path=None, model_config_dict=None), 'intrinsic_reward_module': RLModuleSpec(module_class=<class 'source.intrinsic_attention_ppo.rl_modules.IntrinsicAttentionModule.IntrinsicAttentionModule'>, observation_space=None, action_space=None, inference_only=False, learner_only=True, model_config={'intrinsic_reward_network': {'encoder_hidden_sizes': [], 'encoding_dim': 1, 'num_heads': 1, 'head_hidden_sizes': None, 'layers': [{'type': 'attention'}]}, 'extrinsic_value_hidden_layers': [127, 60], 'vf_share_layers': True, 'max_seq_len': 6}, catalog_class=None, load_state_path=None, model_config_dict=None)})", "algorithm_config_overrides_per_module": {"intrinsic_reward_module": {"lr": 0.0002715581955}}, "_per_module_overrides": {}, "_validate_config": true, "_use_msgpack_checkpoints": false, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "env_task_fn": -1, "enable_connectors": -1, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.161583927863, "kl_target": 0.0201019014258, "vf_loss_coeff": 0.7790510010087, "entropy_coeff": 0.0015431216992, "clip_param": 0.2459212356676, "vf_clip_param": 0.3769744131561, "entropy_coeff_schedule": null, "lr_schedule": null, "sgd_minibatch_size": -1, "vf_share_layers": -1, "differentiable_learner_configs": ["DifferentiableLearnerConfig(learner_class=<class 'source.intrinsic_attention_ppo.learners.IntrinsicAttentionPPOLearner.IntrinsicAttentionPPOLearner'>, learner_connector=None, add_default_connectors_to_learner_pipeline=True, is_multi_agent=False, policies_to_update=['default_policy'], lr=0.0060984166342, num_total_minibatches=0, num_epochs=1, minibatch_size=1000, shuffle_batch_per_epoch=True)"], "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9485408017724, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.callbacks.callbacks.RLlibCallback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 185.80969047546387, "iterations_since_restore": 19, "perf": {"cpu_util_percent": 37.25714285714286, "ram_util_percent": 79.14285714285714}}
{"timers": {"training_iteration": 9.6173149810937, "restore_env_runners": 1.9110199177410193e-05, "training_step": 9.61713613885058, "env_runner_sampling_timer": 1.7360933944888848, "learner_update_timer": 7.687863267361357, "synch_weights": 0.0008419605540509949, "restore_eval_env_runners": 1.0325528151765126e-05, "evaluation_iteration": 0.14017824285944233, "synch_eval_env_connectors": 0.00014567602154668825, "synch_env_connectors": 4.8586585872695195e-06}, "env_runners": {"module_to_env_connector": {"timers": {"connectors": {"listify_data_for_vector_env": 1.1452352961979214e-05, "remove_single_ts_time_rank_from_batch": 1.2852400344209518e-05, "tensor_to_numpy": 1.7317575921074906e-05, "un_batch_to_individual_items": 7.1749786027630064e-06, "normalize_and_clip_actions": 8.762124332523396e-06, "get_actions": 4.681636650622876e-05}}, "connector_pipeline_timer": 0.00013303634811975072}, "env_to_module_sum_episodes_length_out": 10.36823839457432, "rlmodule_inference_timer": 3.645524819657275e-05, "env_to_module_connector": {"timers": {"connectors": {"add_observations_from_episodes_to_batch": 3.0636267282846367e-06, "add_time_dim_to_batch_and_zero_pad": 7.789562575074017e-06, "numpy_to_tensor": 1.4781899639491326e-05, "batch_individual_items": 1.373099380041137e-05, "add_states_from_episodes_to_batch": 2.930107914524939e-06}}, "connector_pipeline_timer": 6.585692632459844e-05}, "episode_return_max": 14.5, "num_env_steps_sampled": 5000.0, "num_episodes": 250.0, "episode_len_max": 20, "sample": 0.0062198183346395715, "weights_seq_no": 19.0, "num_episodes_lifetime": -555250.0, "env_to_module_sum_episodes_length_in": 10.36823839457432, "num_agent_steps_sampled": {"default_agent": 5000.0}, "num_env_steps_sampled_lifetime": -11105000.0, "episode_duration_sec_mean": 0.005925029988866301, "episode_return_mean": 5.7799999999999985, "num_module_steps_sampled": {"default_policy": 5000.0}, "env_reset_timer": 5.121507032922316e-05, "num_module_steps_sampled_lifetime": {"default_policy": -11105000.0}, "agent_episode_returns_mean": {"default_agent": 5.7799999999999985}, "env_step_timer": 1.592006788574104e-05, "episode_return_min": -5.5, "episode_len_min": 20, "episode_len_mean": 20.0, "num_agent_steps_sampled_lifetime": {"default_agent": -11105000.0}, "module_episode_returns_mean": {"default_policy": 5.7799999999999985}, "time_between_sampling": 0.03267053001890155, "num_env_steps_sampled_lifetime_throughput": 2937.056695363824}, "__all_modules__": {"learner_connector_sum_episodes_length_in": 5000.0, "learner_connector": {"connector_pipeline_timer": 0.15469281145313626, "timers": {"connectors": {"add_one_ts_to_episodes_and_truncate": 0.008958045357464143, "add_observations_from_episodes_to_batch": 0.0008572695891574187, "add_columns_from_episodes_to_train_batch": 0.041275145057333464, "add_time_dim_to_batch_and_zero_pad": 0.08986591657615221, "add_states_from_episodes_to_batch": 0.003633025368380405, "batch_individual_items": 0.009905390857925847, "numpy_to_tensor": 6.397842261099754e-05}}}, "learner_connector_sum_episodes_length_out": 5250.0}, "learners": {"intrinsic_reward_module": {"weights_seq_no": 20.0, "num_module_steps_trained_lifetime": 119700, "gradients_default_optimizer_global_norm": 0.0, "module_train_batch_size_mean": 997.9437895346426, "diff_num_grad_updates_vs_sampler_policy": 1.0, "num_trainable_parameters": 8266, "default_optimizer_learning_rate": 0.0002715581955, "total_loss": 0.0, "num_module_steps_trained": 5985, "curr_entropy_coeff": 0.0015431216992, "num_module_steps_trained_lifetime_throughput": 731.2343801021017}, "differentiable_learners": {"intrinsic_attention_ppo_learner": {"intrinsic_reward_module": {"total_loss": 0.0, "num_module_steps_trained": 35910, "diff_num_grad_updates_vs_sampler_policy": 101.0, "weights_seq_no": 120.0, "num_module_steps_trained_lifetime": 718200, "module_train_batch_size_mean": 997.4935477577241}, "default_policy": {"vf_explained_var": 0.0012233257293701172, "total_loss": 0.24808423221111298, "vf_loss": 0.3206096291542053, "vf_loss_unclipped": 46.27695083618164, "weights_seq_no": 120.0, "num_module_steps_trained_lifetime": 718200, "module_train_batch_size_mean": 997.4935477577241, "entropy": 0.6835766434669495, "mean_kl_loss": 5.502683052327484e-05, "use_intrinsic_rewards": 1.0, "policy_loss": -0.0006411080830730498, "num_module_steps_trained": 35910, "diff_num_grad_updates_vs_sampler_policy": 101.0}, "__all_modules__": {"num_env_steps_trained_lifetime": 4320000, "num_module_steps_trained_lifetime": 1436400, "num_module_steps_trained": 71820, "num_env_steps_trained": 216000, "num_env_steps_trained_lifetime_throughput": 47041.891517283024}}}, "default_policy": {"curr_kl_coeff": 1.5409844422720198e-07, "num_module_steps_trained_lifetime": 119700, "module_train_batch_size_mean": 997.9437895346426, "entropy": 0.6835309863090515, "num_trainable_parameters": 16595, "mean_kl_loss": 5.856723873876035e-05, "use_intrinsic_rewards": 0.0, "policy_loss": -0.0006607997347600758, "num_module_steps_trained": 5985, "diff_num_grad_updates_vs_sampler_policy": 1.0, "vf_explained_var": 6.139278411865234e-06, "total_loss": 0.24797740578651428, "vf_loss": 0.3205091655254364, "curr_entropy_coeff": 0.0015431216992, "vf_loss_unclipped": 46.338436126708984, "weights_seq_no": 20.0, "num_module_steps_trained_lifetime_throughput": 731.2298458405372}, "__all_modules__": {"num_module_steps_trained": 11970, "num_non_trainable_parameters": 0, "num_env_steps_trained": 36000, "num_env_steps_trained_lifetime": 720000, "num_module_steps_trained_lifetime": 239400, "num_trainable_parameters": 24861, "num_env_steps_trained_lifetime_throughput": 4401.355019049366, "num_module_steps_trained_throughput": 20154287.165795345, "num_module_steps_trained_lifetime_throughput": 12843636.017609779}, "IntrinsicAttentionMask": [[[0.16494083404541016, 0.16605596244335175, 0.16602614521980286, 0.16768914461135864, 0.16765901446342468, 0.16762889921665192], [0.16415466368198395, 0.16577494144439697, 0.1657315343618393, 0.1681569665670395, 0.16811293363571167, 0.16806891560554504], [0.1641755849123001, 0.16578245162963867, 0.16573940217494965, 0.16814449429512024, 0.16810083389282227, 0.16805718839168549], [0.16301696002483368, 0.16536512970924377, 0.1653020828962326, 0.16883628070354462, 0.1687719076871872, 0.16870756447315216], [0.16303780674934387, 0.16537268459796906, 0.16530999541282654, 0.16882382333278656, 0.16875983774662018, 0.168695867061615], [0.16305863857269287, 0.16538023948669434, 0.16531790792942047, 0.1688113659620285, 0.16874773800373077, 0.16868415474891663]], [[0.16762489080429077, 0.16759918630123138, 0.16561350226402283, 0.16610302031040192, 0.1675221174955368, 0.16553732752799988], [0.16761118173599243, 0.1675858497619629, 0.16562853753566742, 0.16611109673976898, 0.16750988364219666, 0.16555345058441162], [0.16654635965824127, 0.16654956340789795, 0.16679900884628296, 0.16673719882965088, 0.16655917465686798, 0.16680864989757538], [0.16681000590324402, 0.1668061763048172, 0.1665089875459671, 0.16658253967761993, 0.16679468750953674, 0.16649754345417023], [0.1675700843334198, 0.1675458699464798, 0.16567368805408478, 0.16613534092903137, 0.1674732118844986, 0.16560184955596924], [0.16650527715682983, 0.16650956869125366, 0.1668442338705063, 0.16676130890846252, 0.16652248799800873, 0.16685716807842255]], [[0.16514092683792114, 0.16625741124153137, 0.1656240075826645, 0.16728298366069794, 0.1678624153137207, 0.16783225536346436], [0.16444504261016846, 0.1660681962966919, 0.16514672338962555, 0.16756358742713928, 0.1684103161096573, 0.1683662235736847], [0.16483905911445618, 0.16617552936077118, 0.16541710495948792, 0.16740474104881287, 0.16809988021850586, 0.168063685297966], [0.16381123661994934, 0.16589441895484924, 0.16471107304096222, 0.1678188145160675, 0.1689106523990631, 0.1688537448644638], [0.16345545649528503, 0.16579630970954895, 0.16446612775325775, 0.16796201467514038, 0.1691921353340149, 0.16912800073623657], [0.1634739339351654, 0.16580142080783844, 0.1644788533449173, 0.16795457899570465, 0.16917751729488373, 0.16911375522613525]], [[0.1677984744310379, 0.16725265979766846, 0.16578499972820282, 0.16575957834720612, 0.16769558191299438, 0.1657087504863739], [0.16745439171791077, 0.16707497835159302, 0.16605287790298462, 0.16603516042232513, 0.16738289594650269, 0.16599971055984497], [0.1665247082710266, 0.16659285128116608, 0.1667773425579071, 0.16678054630756378, 0.16653753817081451, 0.16678696870803833], [0.16650857031345367, 0.16658447682857513, 0.1667899638414383, 0.16679354012012482, 0.16652286052703857, 0.16680069267749786], [0.16773366928100586, 0.16721922159194946, 0.1658354103565216, 0.1658114343881607, 0.1676367074251175, 0.1657635122537613], [0.16647623479366302, 0.1665676236152649, 0.1668151319026947, 0.16681943833827972, 0.16649344563484192, 0.16682806611061096]], [[0.16524164378643036, 0.1657547801733017, 0.16632892191410065, 0.16738499701023102, 0.16796478629112244, 0.16732487082481384], [0.16494235396385193, 0.16556264460086823, 0.16625715792179108, 0.16753597557544708, 0.16823875904083252, 0.16746310889720917], [0.1646089255809784, 0.1653483510017395, 0.16617687046527863, 0.16770419478416443, 0.16854453086853027, 0.16761712729930878], [0.16399957239627838, 0.1649560034275055, 0.1660292148590088, 0.16801176965236664, 0.16910485923290253, 0.16789859533309937], [0.16366718709468842, 0.1647416055202484, 0.16594815254211426, 0.16817958652973175, 0.169411301612854, 0.16805210709571838], [0.16403411328792572, 0.1649782657623291, 0.16603760421276093, 0.16799430549144745, 0.16907301545143127, 0.16788262128829956]], [[0.16704031825065613, 0.16739097237586975, 0.16597943007946014, 0.165961354970932, 0.16733627021312714, 0.16629160940647125], [0.16718465089797974, 0.16767174005508423, 0.16571342945098877, 0.1656883805990219, 0.1675957292318344, 0.16614599525928497], [0.16660048067569733, 0.16653874516487122, 0.16678819060325623, 0.1667913943529129, 0.16654835641384125, 0.1667328029870987], [0.16659294068813324, 0.16652418673038483, 0.16680201888084412, 0.16680559515953064, 0.1665349006652832, 0.1667403280735016], [0.1671621948480606, 0.1676279902458191, 0.16575488448143005, 0.16573093831539154, 0.1675553023815155, 0.1661687195301056], [0.16673040390014648, 0.1667899638414383, 0.16654956340789795, 0.16654646396636963, 0.16678068041801453, 0.16660287976264954]]]}, "num_training_step_calls_per_iteration": 1, "evaluation": {"env_runners": {"episode_len_min": 20, "env_to_module_connector": {"timers": {"connectors": {"numpy_to_tensor": 1.217712448809298e-05, "add_states_from_episodes_to_batch": 2.7370664801370037e-06, "batch_individual_items": 1.244061586101721e-05, "add_time_dim_to_batch_and_zero_pad": 7.174734880799614e-06, "add_observations_from_episodes_to_batch": 2.861824297252393e-06}}, "connector_pipeline_timer": 5.927488644144267e-05}, "module_to_env_connector": {"timers": {"connectors": {"tensor_to_numpy": 1.5320006958076353e-05, "un_batch_to_individual_items": 6.622701190398089e-06, "normalize_and_clip_actions": 7.955928182792688e-06, "get_actions": 3.854201061098551e-05, "remove_single_ts_time_rank_from_batch": 1.2072183404552918e-05, "listify_data_for_vector_env": 1.0548097011538927e-05}}, "connector_pipeline_timer": 0.00011696243250564196}, "num_env_steps_sampled": 400, "episode_len_max": 20, "num_agent_steps_sampled": {"default_agent": 400}, "weights_seq_no": 20.0, "num_env_steps_sampled_lifetime": 100400, "episode_duration_sec_mean": 0.0055938979238271715, "episode_return_mean": 0.5, "env_reset_timer": 0.00016219402483328107, "module_episode_returns_mean": {"default_policy": 0.5}, "rlmodule_inference_timer": 3.22047258934799e-05, "episode_return_max": 15.5, "env_to_module_sum_episodes_length_in": 10.368238394574323, "num_module_steps_sampled": {"default_policy": 400}, "agent_episode_returns_mean": {"default_agent": 0.5}, "num_agent_steps_sampled_lifetime": {"default_agent": 8000}, "num_module_steps_sampled_lifetime": {"default_policy": 8000}, "env_to_module_sum_episodes_length_out": 10.368238394574323, "num_episodes": 20, "num_episodes_lifetime": 400, "episode_return_min": -13.5, "sample": 0.13334028312802387, "env_step_timer": 1.4201949906896792e-05, "episode_len_mean": 20.0, "time_between_sampling": 9.650169480241505}, "num_healthy_workers": 1, "actor_manager_num_outstanding_async_reqs": 0, "num_remote_worker_restarts": 0}, "num_env_steps_sampled_lifetime": -11105000.0, "fault_tolerance": {"num_healthy_workers": 0, "num_remote_worker_restarts": 0}, "env_runner_group": {"actor_manager_num_outstanding_async_reqs": 0}, "done": true, "training_iteration": 20, "trial_id": "b17e2_00000", "date": "2025-08-11_18-46-25", "timestamp": 1754930785, "time_this_iter_s": 9.795291900634766, "time_total_s": 195.60498237609863, "pid": 11680, "hostname": "Mac", "node_ip": "127.0.0.1", "config": {"exploration_config": {}, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 2, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "env": "Umbrella", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": false, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 0, "create_local_env_runner": true, "num_envs_per_env_runner": 1, "gym_env_vectorize_mode": "SYNC", "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "episodes_to_numpy": true, "max_requests_in_flight_per_env_runner": 1, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "merge_env_runner_states": "training_only", "broadcast_env_runner_states": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "complete_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "sampler_perf_stats_ema_coef": null, "_is_online": true, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": "auto", "num_aggregator_actors_per_learner": 0, "max_requests_in_flight_per_aggregator_actor": 3, "local_gpu_idx": 0, "max_requests_in_flight_per_learner": 3, "gamma": 1, "lr": 0.0002715581955, "grad_clip": 0.5, "grad_clip_by": "global_norm", "_train_batch_size_per_learner": 5000, "train_batch_size": 4000, "num_epochs": 1, "minibatch_size": 1000, "shuffle_batch_per_epoch": true, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "log_std_clip_param": 20.0, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "_disable_preprocessor_api": false, "_disable_action_flattening": false}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {"intrinsic_reward_coeff": 0.2795015916508}, "optimizer": {}, "_learner_class": "<class 'source.intrinsic_attention_ppo.learners.IntrinsicAttentionMetaLearner.IntrinsicAttentionMetaLearner'>", "callbacks_on_algorithm_init": null, "callbacks_on_env_runners_recreated": null, "callbacks_on_offline_eval_runners_recreated": null, "callbacks_on_checkpoint_loaded": null, "callbacks_on_environment_created": null, "callbacks_on_episode_created": null, "callbacks_on_episode_start": null, "callbacks_on_episode_step": null, "callbacks_on_episode_end": null, "callbacks_on_evaluate_start": null, "callbacks_on_evaluate_end": null, "callbacks_on_evaluate_offline_start": null, "callbacks_on_evaluate_offline_end": null, "callbacks_on_sample_end": null, "callbacks_on_train_result": null, "explore": true, "enable_rl_module_and_learner": true, "enable_env_runner_and_connector_v2": true, "_prior_exploration_config": {"type": "StochasticSampling"}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x13c0118a0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "offline_data_class": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_read_batch_size": null, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "materialize_data": false, "materialize_mapped_data": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "ignore_final_observation": false, "prelearner_class": null, "prelearner_buffer_class": null, "prelearner_buffer_kwargs": {}, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_remaining_data": false, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": 1, "evaluation_duration": 20, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_auto_duration_min_env_steps_per_sample": 100, "evaluation_auto_duration_max_env_steps_per_sample": 2000, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 1, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "offline_evaluation_interval": null, "num_offline_eval_runners": 0, "offline_loss_for_module_fn": null, "offline_evaluation_duration": 1, "offline_evaluation_parallel_to_training": false, "offline_evaluation_timeout_s": 120.0, "num_cpus_per_offline_eval_runner": 1, "num_gpus_per_offline_eval_runner": 0, "custom_resources_per_offline_eval_runner": {}, "restart_failed_offline_eval_runners": true, "ignore_offline_eval_runner_failures": false, "max_num_offline_eval_runner_restarts": 1000, "offline_eval_runner_restore_timeout_s": 1800.0, "max_requests_in_flight_per_offline_eval_runner": 1, "validate_offline_eval_runners_after_construction": true, "offline_eval_runner_health_probe_timeout_s": 30.0, "offline_eval_rl_module_inference_only": false, "broadcast_offline_eval_runner_states": false, "offline_eval_batch_size_per_runner": 256, "dataset_num_iters_per_eval_runner": 1, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "log_gradients": false, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 9, "restart_failed_env_runners": true, "ignore_env_runner_failures": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30.0, "env_runner_restore_timeout_s": 1800.0, "_model_config": {}, "_rl_module_spec": "MultiRLModuleSpec(multi_rl_module_class=<class 'ray.rllib.core.rl_module.multi_rl_module.MultiRLModule'>, observation_space=None, action_space=None, inference_only=False, model_config=None, rl_module_specs={'default_policy': RLModuleSpec(module_class=<class 'source.intrinsic_attention_ppo.rl_modules.DifferentiablePPOModule.DifferentiablePPOModule'>, observation_space=None, action_space=None, inference_only=False, learner_only=False, model_config={'vf_share_layers': True, 'embedding_dim': 62, 'max_seq_len': 6, 'policy_head_hidden_sizes': [32], 'value_head_hidden_sizes': [101], 'embedding_hidden_sizes': [121]}, catalog_class=None, load_state_path=None, model_config_dict=None), 'intrinsic_reward_module': RLModuleSpec(module_class=<class 'source.intrinsic_attention_ppo.rl_modules.IntrinsicAttentionModule.IntrinsicAttentionModule'>, observation_space=None, action_space=None, inference_only=False, learner_only=True, model_config={'intrinsic_reward_network': {'encoder_hidden_sizes': [], 'encoding_dim': 1, 'num_heads': 1, 'head_hidden_sizes': None, 'layers': [{'type': 'attention'}]}, 'extrinsic_value_hidden_layers': [127, 60], 'vf_share_layers': True, 'max_seq_len': 6}, catalog_class=None, load_state_path=None, model_config_dict=None)}, load_state_path=None, modules_to_load=None, module_specs={'default_policy': RLModuleSpec(module_class=<class 'source.intrinsic_attention_ppo.rl_modules.DifferentiablePPOModule.DifferentiablePPOModule'>, observation_space=None, action_space=None, inference_only=False, learner_only=False, model_config={'vf_share_layers': True, 'embedding_dim': 62, 'max_seq_len': 6, 'policy_head_hidden_sizes': [32], 'value_head_hidden_sizes': [101], 'embedding_hidden_sizes': [121]}, catalog_class=None, load_state_path=None, model_config_dict=None), 'intrinsic_reward_module': RLModuleSpec(module_class=<class 'source.intrinsic_attention_ppo.rl_modules.IntrinsicAttentionModule.IntrinsicAttentionModule'>, observation_space=None, action_space=None, inference_only=False, learner_only=True, model_config={'intrinsic_reward_network': {'encoder_hidden_sizes': [], 'encoding_dim': 1, 'num_heads': 1, 'head_hidden_sizes': None, 'layers': [{'type': 'attention'}]}, 'extrinsic_value_hidden_layers': [127, 60], 'vf_share_layers': True, 'max_seq_len': 6}, catalog_class=None, load_state_path=None, model_config_dict=None)})", "algorithm_config_overrides_per_module": {"intrinsic_reward_module": {"lr": 0.0002715581955}}, "_per_module_overrides": {}, "_validate_config": true, "_use_msgpack_checkpoints": false, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "env_task_fn": -1, "enable_connectors": -1, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.161583927863, "kl_target": 0.0201019014258, "vf_loss_coeff": 0.7790510010087, "entropy_coeff": 0.0015431216992, "clip_param": 0.2459212356676, "vf_clip_param": 0.3769744131561, "entropy_coeff_schedule": null, "lr_schedule": null, "sgd_minibatch_size": -1, "vf_share_layers": -1, "differentiable_learner_configs": ["DifferentiableLearnerConfig(learner_class=<class 'source.intrinsic_attention_ppo.learners.IntrinsicAttentionPPOLearner.IntrinsicAttentionPPOLearner'>, learner_connector=None, add_default_connectors_to_learner_pipeline=True, is_multi_agent=False, policies_to_update=['default_policy'], lr=0.0060984166342, num_total_minibatches=0, num_epochs=1, minibatch_size=1000, shuffle_batch_per_epoch=True)"], "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9485408017724, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.callbacks.callbacks.RLlibCallback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 195.60498237609863, "iterations_since_restore": 20, "perf": {"cpu_util_percent": 40.30769230769231, "ram_util_percent": 79.94615384615385}}
