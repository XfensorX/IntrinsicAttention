{"timers": {"training_iteration": 10.194088208023459, "restore_env_runners": 1.1083087883889675e-05, "training_step": 10.193897542078048, "env_runner_sampling_timer": 1.8202352090738714, "learner_update_timer": 8.194740499951877, "synch_weights": 0.0015370839973911643}, "env_runners": {"num_env_steps_sampled": 5000.0, "episode_return_max": 12.5, "env_to_module_connector": {"timers": {"connectors": {"add_time_dim_to_batch_and_zero_pad": 7.8935199969029e-06, "add_observations_from_episodes_to_batch": 3.2169161565900133e-06, "batch_individual_items": 1.4046054274237642e-05, "numpy_to_tensor": 1.4968037400053718e-05, "add_states_from_episodes_to_batch": 3.002066127591294e-06}}, "connector_pipeline_timer": 6.914502723948645e-05}, "episode_len_min": 20, "module_to_env_connector": {"timers": {"connectors": {"un_batch_to_individual_items": 7.435176780190402e-06, "normalize_and_clip_actions": 1.1143684554058313e-05, "remove_single_ts_time_rank_from_batch": 1.3031365412643833e-05, "get_actions": 5.654810927846752e-05, "tensor_to_numpy": 1.706319882532337e-05, "listify_data_for_vector_env": 1.1784518720460114e-05}}, "connector_pipeline_timer": 0.0001465135568631945}, "env_step_timer": 1.65401829371835e-05, "num_agent_steps_sampled_lifetime": {"default_agent": 627500.0}, "num_episodes": 250.0, "episode_duration_sec_mean": 0.0058691607024520635, "episode_len_mean": 20.0, "module_episode_returns_mean": {"default_policy": 3.38}, "weights_seq_no": 0.0, "env_to_module_sum_episodes_length_out": 10.191744832559449, "num_env_steps_sampled_lifetime": 627500.0, "episode_len_max": 20, "rlmodule_inference_timer": 4.1354827830697036e-05, "num_agent_steps_sampled": {"default_agent": 5000.0}, "env_reset_timer": 0.00011155991958168171, "agent_episode_returns_mean": {"default_agent": 3.38}, "env_to_module_sum_episodes_length_in": 10.191744832559449, "episode_return_mean": 3.38, "time_between_sampling": 0.00072573570454308, "num_module_steps_sampled_lifetime": {"default_policy": 627500.0}, "num_module_steps_sampled": {"default_policy": 5000.0}, "num_episodes_lifetime": 31375.0, "episode_return_min": -7.5, "sample": 0.0073531000053371045, "num_env_steps_sampled_lifetime_throughput": 2764.4597663180407}, "__all_modules__": {"learner_connector_sum_episodes_length_in": 5000, "learner_connector": {"connector_pipeline_timer": 0.13896325009409338, "timers": {"connectors": {"add_one_ts_to_episodes_and_truncate": 0.00947441696189344, "add_observations_from_episodes_to_batch": 0.0010490840068086982, "add_columns_from_episodes_to_train_batch": 0.04411300003994256, "add_time_dim_to_batch_and_zero_pad": 0.0761525840498507, "add_states_from_episodes_to_batch": 0.0035613341024145484, "batch_individual_items": 0.004348041024059057, "numpy_to_tensor": 7.199996616691351e-05}}}, "learner_connector_sum_episodes_length_out": 5250}, "learners": {"__all_modules__": {"num_module_steps_trained_lifetime": 11970, "num_env_steps_trained": 33000, "num_env_steps_trained_lifetime": 33000, "num_non_trainable_parameters": 0, "num_trainable_parameters": 24861, "num_module_steps_trained": 11970, "num_env_steps_trained_lifetime_throughput": 3994.4478115512607, "num_module_steps_trained_throughput": 31818518.223125808, "num_module_steps_trained_lifetime_throughput": 13072174.18474886}, "default_policy": {"curr_entropy_coeff": 0.0015431216992, "weights_seq_no": 1.0, "curr_kl_coeff": 0.08079196512699127, "policy_loss": -2.770604805846233e-05, "module_train_batch_size_mean": 997.9705930399, "num_trainable_parameters": 16595, "vf_loss": 0.3583114743232727, "mean_kl_loss": 6.707143143103167e-07, "diff_num_grad_updates_vs_sampler_policy": 1.0, "vf_explained_var": -0.0026421546936035156, "use_intrinsic_rewards": 0.0, "entropy": 0.6883481740951538, "num_module_steps_trained": 5985, "vf_loss_unclipped": 44.308990478515625, "total_loss": 0.2780531346797943, "num_module_steps_trained_lifetime": 5985, "num_module_steps_trained_lifetime_throughput": 724.1369045221387}, "differentiable_learners": {"intrinsic_attention_ppo_learner": {"__all_modules__": {"num_module_steps_trained_lifetime": 71820, "num_env_steps_trained_lifetime": 198000, "num_module_steps_trained": 71820, "num_env_steps_trained": 198000, "num_env_steps_trained_lifetime_throughput": 53670.70280659493}, "default_policy": {"weights_seq_no": 6.0, "policy_loss": -2.633633448567707e-05, "module_train_batch_size_mean": 997.8474438281662, "vf_loss": 0.35831817984580994, "mean_kl_loss": 5.737780952586036e-07, "diff_num_grad_updates_vs_sampler_policy": 6.0, "vf_explained_var": 0.002763092517852783, "use_intrinsic_rewards": 1.0, "entropy": 0.6883554458618164, "num_module_steps_trained": 35910, "vf_loss_unclipped": 44.128440856933594, "total_loss": 0.2780596613883972, "num_module_steps_trained_lifetime": 35910}, "intrinsic_reward_module": {"total_loss": 0.0, "num_module_steps_trained_lifetime": 35910, "module_train_batch_size_mean": 997.8474438281662, "weights_seq_no": 6.0, "num_module_steps_trained": 35910, "diff_num_grad_updates_vs_sampler_policy": 6.0}}}, "intrinsic_reward_module": {"diff_num_grad_updates_vs_sampler_policy": 1.0, "gradients_default_optimizer_global_norm": 0.0, "curr_entropy_coeff": 0.0015431216992, "weights_seq_no": 1.0, "default_optimizer_learning_rate": 0.0002715581955, "total_loss": 0.0, "num_module_steps_trained_lifetime": 5985, "module_train_batch_size_mean": 997.9705930399, "num_trainable_parameters": 8266, "num_module_steps_trained": 5985, "num_module_steps_trained_lifetime_throughput": 724.1500302780754}, "IntrinsicAttentionMask": [[[0.0918099507689476, 0.09022977203130722, 0.09013213217258453, 0.09151223301887512, 0.091413214802742, 0.09093364328145981, 0.09083525091409683, 0.08964554220438004, 0.09212631732225418, 0.09054069966077805, 0.09082131832838058], [0.09157963842153549, 0.09040326625108719, 0.09033041447401047, 0.09135840833187103, 0.09128478169441223, 0.09092791378498077, 0.09085463732481003, 0.08996701240539551, 0.0918145403265953, 0.09063515067100525, 0.09084426611661911], [0.09156528115272522, 0.09041408449411392, 0.09034277498722076, 0.0913488045334816, 0.09127675741910934, 0.09092754125595093, 0.09085582941770554, 0.08998707681894302, 0.09179511666297913, 0.09064102917909622, 0.09084568172693253], [0.0917668417096138, 0.09026222676038742, 0.09016922116279602, 0.0914834663271904, 0.09138919413089752, 0.09093259274959564, 0.09083890169858932, 0.08970562368631363, 0.09206793457269669, 0.09055838733911514, 0.0908256396651268], [0.09175246953964233, 0.09027304500341415, 0.09018157422542572, 0.09147386252880096, 0.09138118475675583, 0.09093223512172699, 0.09084010869264603, 0.08972565084695816, 0.09204847365617752, 0.09056427329778671, 0.09082707017660141], [0.09168269485235214, 0.09032561630010605, 0.09024165570735931, 0.0914272740483284, 0.09134228527545929, 0.0909305214881897, 0.0908460021018982, 0.08982302993535995, 0.09195400029420853, 0.09059290587902069, 0.09083404392004013], [0.09166833758354187, 0.09033643454313278, 0.09025402367115021, 0.09141767770051956, 0.0913342759013176, 0.09093016386032104, 0.0908472090959549, 0.08984307944774628, 0.09193456172943115, 0.09059879928827286, 0.09083546698093414], [0.09149352461099625, 0.09046817570924759, 0.09040462225675583, 0.09130082279443741, 0.09123668074607849, 0.0909256786108017, 0.09086180478334427, 0.09008749574422836, 0.0916980654001236, 0.09067042917013168, 0.0908527597784996], [0.09185559302568436, 0.09019538015127182, 0.09009285271167755, 0.09154269099235535, 0.09143862873315811, 0.09093472361564636, 0.09083134680986404, 0.0895819365978241, 0.09218816459178925, 0.09052193909883499, 0.09081672132015228], [0.09162525087594986, 0.09036888182163239, 0.0902911052107811, 0.09138888120651245, 0.09131023287773132, 0.0909290686249733, 0.0908508151769638, 0.08990324288606644, 0.09187625348567963, 0.09061644971370697, 0.09083974361419678], [0.09166629612445831, 0.09033796191215515, 0.09025576710700989, 0.09141631424427032, 0.09133313596248627, 0.09093011170625687, 0.09084737300872803, 0.08984591066837311, 0.09193180501461029, 0.09059962630271912, 0.09083566814661026]], [[0.08973551541566849, 0.08963494747877121, 0.09066373109817505, 0.09095478802919388, 0.09085285663604736, 0.09035924822092056, 0.09064933657646179, 0.09015683084726334, 0.10144293308258057, 0.08939291536808014, 0.08615699410438538], [0.08975444734096527, 0.08965540677309036, 0.09066850692033768, 0.09095510095357895, 0.09085474163293839, 0.09036869555711746, 0.09065434336662292, 0.09016936272382736, 0.10127323865890503, 0.08941704034805298, 0.086229108273983], [0.08956030756235123, 0.08944579213857651, 0.09061817824840546, 0.09095021337270737, 0.09083390980958939, 0.0902710035443306, 0.09060176461935043, 0.09004029631614685, 0.10301174968481064, 0.08917024731636047, 0.08549649268388748], [0.08950525522232056, 0.08938640356063843, 0.09060344099998474, 0.09094822406768799, 0.09082745015621185, 0.09024297446012497, 0.09058639407157898, 0.09000346809625626, 0.10350467264652252, 0.08910045027732849, 0.08529128134250641], [0.08952454477548599, 0.08940721303224564, 0.0906086266040802, 0.09094895422458649, 0.0908297449350357, 0.09025280922651291, 0.09059180319309235, 0.09001638740301132, 0.10333199799060822, 0.089124895632267, 0.08536305278539658], [0.08961784094572067, 0.08950788527727127, 0.09063336998224258, 0.09095200896263123, 0.0908404067158699, 0.09030014276504517, 0.09061761200428009, 0.0900786817073822, 0.10249660909175873, 0.08924327045679092, 0.08571213483810425], [0.0895630419254303, 0.08944873511791229, 0.09061891585588455, 0.09095031023025513, 0.09083423018455505, 0.09027238935232162, 0.09060253202915192, 0.0900421217083931, 0.1029873937368393, 0.08917370438575745, 0.08550667017698288], [0.08965606987476349, 0.08954913914203644, 0.09064333885908127, 0.0909530520439148, 0.09084457904100418, 0.09031941741704941, 0.09062802046537399, 0.0901041105389595, 0.1021544337272644, 0.08929183334112167, 0.08585604280233383], [0.08748751133680344, 0.08722488582134247, 0.0899350568652153, 0.09071128070354462, 0.09043895453214645, 0.0891275405883789, 0.0898967832326889, 0.08859321475028992, 0.12154612690210342, 0.08659482002258301, 0.07844381034374237], [0.08980001509189606, 0.08970464766025543, 0.09067994356155396, 0.09095576405525208, 0.09085917472839355, 0.09039135277271271, 0.09066630154848099, 0.09019947797060013, 0.10086509585380554, 0.089475117623806, 0.08640312403440475], [0.09040486812591553, 0.09036006778478622, 0.09081707894802094, 0.09094585478305817, 0.09090078622102737, 0.09068212658166885, 0.09081070870161057, 0.09059226512908936, 0.09544114768505096, 0.09025212377309799, 0.08879298716783524]], [[0.09167342633008957, 0.09157422930002213, 0.08999811112880707, 0.08990071713924408, 0.09127727895975113, 0.09079842269420624, 0.0907001718878746, 0.08951223641633987, 0.09198932349681854, 0.09188978374004364, 0.09068626910448074], [0.09166127443313599, 0.09156366437673569, 0.09001260250806808, 0.08991675078868866, 0.09127147495746613, 0.09080024808645248, 0.0907035619020462, 0.08953437954187393, 0.09197209030389786, 0.0918741524219513, 0.09068988263607025], [0.09146618843078613, 0.09139404445886612, 0.09024500101804733, 0.09017382562160492, 0.09117797762155533, 0.09082913398742676, 0.09075749665498734, 0.08988969027996063, 0.09169577062129974, 0.0916234478354454, 0.09074735641479492], [0.09145402163267136, 0.09138347208499908, 0.09025950729846954, 0.0901898741722107, 0.09117214381694794, 0.09083092957735062, 0.09076085686683655, 0.08991188555955887, 0.09167855978012085, 0.09160783141851425, 0.09075094014406204], [0.09162476658821106, 0.09153193235397339, 0.09005606174468994, 0.08996482193470001, 0.09125400334596634, 0.09080567955970764, 0.09071367233991623, 0.08960076421499252, 0.09192036092281342, 0.09182722866535187, 0.0907006561756134], [0.09156567603349686, 0.0914805606007576, 0.09012646973133087, 0.09004269540309906, 0.09122569859027863, 0.09081445634365082, 0.09073004871606827, 0.08970838040113449, 0.09183663129806519, 0.09175126254558563, 0.0907181054353714], [0.09155350923538208, 0.09146998822689056, 0.09014096856117249, 0.09005873650312424, 0.09121987223625183, 0.09081626683473587, 0.09073341637849808, 0.08973053842782974, 0.0918194055557251, 0.09173563867807388, 0.09072168916463852], [0.09140536189079285, 0.09134114533662796, 0.0903175100684166, 0.0902540534734726, 0.0911487564444542, 0.09083805978298187, 0.09077424556016922, 0.090000681579113, 0.09160970151424408, 0.09154534339904785, 0.09076521545648575], [0.09171207249164581, 0.09160781651735306, 0.08995208144187927, 0.08984982222318649, 0.0912957563996315, 0.09079264104366302, 0.09068942815065384, 0.08944196254014969, 0.09204412251710892, 0.09193948656320572, 0.09067482501268387], [0.09169991314411163, 0.09159724414348602, 0.08996656537055969, 0.08986584097146988, 0.0912899449467659, 0.09079446643590927, 0.09069281071424484, 0.08946407586336136, 0.09202687442302704, 0.09192384779453278, 0.09067843109369278], [0.0915517807006836, 0.09146847575902939, 0.09014301002025604, 0.0900609940290451, 0.09121903032064438, 0.09081650525331497, 0.09073387831449509, 0.08973366767168045, 0.09181695431470871, 0.0917334109544754, 0.09072218835353851]], [[0.09120133519172668, 0.09114354848861694, 0.0917334035038948, 0.09189976006746292, 0.09184153378009796, 0.09155913442373276, 0.0917251706123352, 0.09231880307197571, 0.08483371883630753, 0.09100434929132462, 0.09073923528194427], [0.09119395911693573, 0.09113774448633194, 0.09171148389577866, 0.09187326580286026, 0.09181663393974304, 0.09154198318719864, 0.09170347452163696, 0.09228076785802841, 0.08499398827552795, 0.09100233763456345, 0.09074442833662033], [0.0912676453590393, 0.09119538217782974, 0.091933473944664, 0.09214185178279877, 0.09206890314817429, 0.09171528369188309, 0.09192316979169846, 0.09266715496778488, 0.08337561786174774, 0.09102137386798859, 0.09069015085697174], [0.0912877544760704, 0.0912109836935997, 0.09199533611536026, 0.09221683442592621, 0.09213928133249283, 0.09176342934370041, 0.09198437631130219, 0.0927753672003746, 0.08292611688375473, 0.09102613478899002, 0.09067432582378387], [0.0912807434797287, 0.09120555222034454, 0.09197371453046799, 0.09219062328338623, 0.09211467951536179, 0.09174662083387375, 0.09196298569440842, 0.09273752570152283, 0.08308311551809311, 0.0910244956612587, 0.09067989140748978], [0.09124625474214554, 0.09117873013019562, 0.0918683260679245, 0.09206294268369675, 0.09199480712413788, 0.09166450798511505, 0.09185869991779327, 0.09255343675613403, 0.08384975045919418, 0.09101609885692596, 0.0907064825296402], [0.09126663208007812, 0.09119459986686707, 0.09193041175603867, 0.0921381339430809, 0.09206540882587433, 0.09171289950609207, 0.09192012995481491, 0.0926617905497551, 0.08339793980121613, 0.09102112799882889, 0.09069092571735382], [0.091337189078331, 0.09124908596277237, 0.09214971959590912, 0.09240426123142242, 0.09231512993574142, 0.09188331663608551, 0.09213712811470032, 0.09304652363061905, 0.08180709928274155, 0.09103699773550034, 0.09063351899385452], [0.09014681726694107, 0.09026719629764557, 0.08904953300952911, 0.08871050924062729, 0.08882896602153778, 0.08940675109624863, 0.08906636387109756, 0.08786489814519882, 0.10498476028442383, 0.09055812656879425, 0.09111606329679489], [0.09117601811885834, 0.09112360328435898, 0.09165846556425095, 0.09180925041437149, 0.09175647050142288, 0.09150047600269318, 0.09165100753307343, 0.09218896180391312, 0.08538154512643814, 0.09099733084440231, 0.09075680375099182], [0.09114129841327667, 0.09109612554311752, 0.09155686944723129, 0.0916866883635521, 0.09164124727249146, 0.09142080694437027, 0.09155043959617615, 0.09201347827911377, 0.08612576872110367, 0.09098730236291885, 0.09077994525432587]], [[0.08876828104257584, 0.09078485518693924, 0.0907101258635521, 0.09063545614480972, 0.09056085348129272, 0.0924607589840889, 0.09238465130329132, 0.09033741056919098, 0.09109768271446228, 0.09102270007133484, 0.09123720228672028], [0.08756422996520996, 0.09070955961942673, 0.09059228748083115, 0.0904751569032669, 0.0903581902384758, 0.09335409849882126, 0.09323340654373169, 0.09000817686319351, 0.09120109677314758, 0.09108319133520126, 0.09142062813043594], [0.08760812878608704, 0.09071236848831177, 0.09059665352106094, 0.09048108011484146, 0.09036565572023392, 0.09332124888896942, 0.09320220351219177, 0.09002027660608292, 0.09119735658168793, 0.09108102321624756, 0.0914139449596405], [0.0876520574092865, 0.0907151848077774, 0.09060102701187134, 0.09048701077699661, 0.09037314355373383, 0.09328842163085938, 0.09317102283239365, 0.09003239125013351, 0.09119362384080887, 0.09107886254787445, 0.09140727669000626], [0.08769600093364716, 0.09071799367666245, 0.09060539305210114, 0.09049293398857117, 0.09038060903549194, 0.09325559437274933, 0.09313984215259552, 0.09004448354244232, 0.09118987619876862, 0.09107669442892075, 0.09140060096979141], [0.08659356087446213, 0.09064590930938721, 0.0904940590262413, 0.0903424620628357, 0.09019112586975098, 0.0940854549407959, 0.09392784535884857, 0.08973861485719681, 0.09128300100564957, 0.0911300778388977, 0.09156786650419235], [0.08663707226514816, 0.09064881503582001, 0.09049852192401886, 0.09034848213195801, 0.09019868075847626, 0.09405245631933212, 0.0938965231180191, 0.08975078165531158, 0.09127935767173767, 0.09112802147865295, 0.09156128019094467], [0.08782792836427689, 0.09072639048099518, 0.09061846137046814, 0.09051067382097244, 0.0904029980301857, 0.09315714985132217, 0.09304633736610413, 0.09008076786994934, 0.09117861837148666, 0.09107015281915665, 0.0913805291056633], [0.0873810201883316, 0.0906977504491806, 0.09057396650314331, 0.09045035392045975, 0.09032690525054932, 0.09349136799573898, 0.09336377680301666, 0.0899575874209404, 0.09121666103601456, 0.09109216928482056, 0.09144846349954605], [0.0874248519539833, 0.09070058166980743, 0.0905783548951149, 0.09045629948377609, 0.09033440053462982, 0.09345849603414536, 0.09333255887031555, 0.089969702064991, 0.09121294319629669, 0.09109003096818924, 0.091441810131073], [0.08729961514472961, 0.09069246798753738, 0.09056579321622849, 0.09043929725885391, 0.09031297266483307, 0.09355247765779495, 0.0934218093752861, 0.0899350643157959, 0.09122356027364731, 0.09109614789485931, 0.09146082401275635]], [[0.09149036556482315, 0.08948726207017899, 0.09075341373682022, 0.08924052864313126, 0.08911740779876709, 0.09227392077445984, 0.08887170255184174, 0.09012915194034576, 0.10421454161405563, 0.08918986469507217, 0.08523181080818176], [0.09139127284288406, 0.08978745341300964, 0.09080205112695694, 0.08958940207958221, 0.08949054777622223, 0.09201671183109283, 0.08929315954446793, 0.09030216187238693, 0.10142239183187485, 0.08954872936010361, 0.08635610342025757], [0.09145519882440567, 0.08959785103797913, 0.09077221900224686, 0.08936885744333267, 0.08925457298755646, 0.09218093007802963, 0.08902646601200104, 0.09019335359334946, 0.10318686068058014, 0.08932182937860489, 0.08564183115959167], [0.09137828648090363, 0.08982434123754501, 0.0908074900507927, 0.08963239938020706, 0.08953657001256943, 0.09198405593633652, 0.08934524655342102, 0.09032314270734787, 0.10107874125242233, 0.08959297090768814, 0.08649677038192749], [0.09137174487113953, 0.08984273672103882, 0.0908101499080658, 0.08965383470058441, 0.08955954015254974, 0.09196767210960388, 0.08937124162912369, 0.09033358097076416, 0.10090728849172592, 0.08961504697799683, 0.08656712621450424], [0.09152613580226898, 0.0893695130944252, 0.09073228389024734, 0.08910413086414337, 0.08897173404693604, 0.09237074106931686, 0.08870752155780792, 0.09006019681692123, 0.10530775040388107, 0.08904964476823807, 0.08480037748813629], [0.09135855734348297, 0.08987944573163986, 0.09081538766622543, 0.08969666063785553, 0.0896054059267044, 0.09193481504917145, 0.08942317217588425, 0.09035436064004898, 0.10056515783071518, 0.08965910971164703, 0.0867079347372055], [0.09142424166202545, 0.0896913930773735, 0.09078732877969742, 0.08947758376598358, 0.08937087655067444, 0.09210067987442017, 0.0891578271985054, 0.0902472510933876, 0.1023167073726654, 0.08943367749452591, 0.08599243313074112], [0.09188348054885864, 0.08755872398614883, 0.09027927368879318, 0.08703381568193436, 0.08677253872156143, 0.0936059057712555, 0.08625233918428421, 0.08893229812383652, 0.12201131880283356, 0.08692625164985657, 0.07874404639005661], [0.09137560427188873, 0.08983191847801208, 0.09080859273672104, 0.08964122086763382, 0.08954602479934692, 0.0919773206114769, 0.0893559455871582, 0.09032744914293289, 0.10100819170475006, 0.08960205316543579, 0.08652570843696594], [0.09114225953817368, 0.09042064100503922, 0.0908779576420784, 0.09033104032278061, 0.0902862697839737, 0.09142178297042847, 0.09019680321216583, 0.09065299481153488, 0.09550512582063675, 0.09031262248754501, 0.08885250240564346]]]}, "num_training_step_calls_per_iteration": 1, "num_env_steps_sampled_lifetime": 627500.0, "evaluation": {"env_runners": {"episode_len_max": 20, "rlmodule_inference_timer": 7.192640330205403e-05, "num_module_steps_sampled": {"default_policy": 400}, "sample": 0.17465554201044142, "env_to_module_connector": {"timers": {"connectors": {"add_states_from_episodes_to_batch": 3.358602574518851e-06, "add_time_dim_to_batch_and_zero_pad": 9.701411144126896e-06, "add_observations_from_episodes_to_batch": 3.8161091923777e-06, "numpy_to_tensor": 1.5601137793156607e-05, "batch_individual_items": 1.4496090290701075e-05}}, "connector_pipeline_timer": 7.484517256701018e-05}, "module_episode_returns_mean": {"default_policy": 2.15}, "module_to_env_connector": {"timers": {"connectors": {"normalize_and_clip_actions": 1.4634994288200243e-05, "remove_single_ts_time_rank_from_batch": 1.5512007489905763e-05, "tensor_to_numpy": 2.414884404313827e-05, "listify_data_for_vector_env": 1.305288387268784e-05, "un_batch_to_individual_items": 7.404568485899302e-06, "get_actions": 8.989795756783515e-05}}, "connector_pipeline_timer": 0.00019700984375797527}, "episode_duration_sec_mean": 0.00779705616296269, "weights_seq_no": 1.0, "env_to_module_sum_episodes_length_out": 10.216013141322508, "agent_episode_returns_mean": {"default_agent": 2.15}, "episode_return_mean": 2.15, "env_to_module_sum_episodes_length_in": 10.216013141322508, "num_episodes_lifetime": 20, "num_agent_steps_sampled_lifetime": {"default_agent": 400}, "num_episodes": 20, "episode_len_mean": 20.0, "num_agent_steps_sampled": {"default_agent": 400}, "num_module_steps_sampled_lifetime": {"default_policy": 400}, "env_reset_timer": 0.002463208045810461, "episode_return_min": -16.5, "num_env_steps_sampled": 400, "episode_len_min": 20, "episode_return_max": 12.5, "env_step_timer": 2.098455988268954e-05, "num_env_steps_sampled_lifetime": 5400}, "num_healthy_workers": 1, "actor_manager_num_outstanding_async_reqs": 0, "num_remote_worker_restarts": 0}, "fault_tolerance": {"num_healthy_workers": 0, "num_remote_worker_restarts": 0}, "env_runner_group": {"actor_manager_num_outstanding_async_reqs": 0}, "done": false, "training_iteration": 1, "trial_id": "b154b_00000", "date": "2025-08-11_18-11-35", "timestamp": 1754928695, "time_this_iter_s": 10.415034294128418, "time_total_s": 10.415034294128418, "pid": 10455, "hostname": "Mac", "node_ip": "127.0.0.1", "config": {"exploration_config": {}, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 2, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "env": "Umbrella", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": false, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 0, "create_local_env_runner": true, "num_envs_per_env_runner": 1, "gym_env_vectorize_mode": "SYNC", "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "episodes_to_numpy": true, "max_requests_in_flight_per_env_runner": 1, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "merge_env_runner_states": "training_only", "broadcast_env_runner_states": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "complete_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "sampler_perf_stats_ema_coef": null, "_is_online": true, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": "auto", "num_aggregator_actors_per_learner": 0, "max_requests_in_flight_per_aggregator_actor": 3, "local_gpu_idx": 0, "max_requests_in_flight_per_learner": 3, "gamma": 1, "lr": 0.0002715581955, "grad_clip": 0.5, "grad_clip_by": "global_norm", "_train_batch_size_per_learner": 5000, "train_batch_size": 4000, "num_epochs": 1, "minibatch_size": 1000, "shuffle_batch_per_epoch": true, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "log_std_clip_param": 20.0, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "_disable_preprocessor_api": false, "_disable_action_flattening": false}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {"intrinsic_reward_coeff": 0.2795015916508}, "optimizer": {}, "_learner_class": "<class 'source.intrinsic_attention_ppo.learners.IntrinsicAttentionMetaLearner.IntrinsicAttentionMetaLearner'>", "callbacks_on_algorithm_init": null, "callbacks_on_env_runners_recreated": null, "callbacks_on_offline_eval_runners_recreated": null, "callbacks_on_checkpoint_loaded": null, "callbacks_on_environment_created": null, "callbacks_on_episode_created": null, "callbacks_on_episode_start": null, "callbacks_on_episode_step": null, "callbacks_on_episode_end": null, "callbacks_on_evaluate_start": null, "callbacks_on_evaluate_end": null, "callbacks_on_evaluate_offline_start": null, "callbacks_on_evaluate_offline_end": null, "callbacks_on_sample_end": null, "callbacks_on_train_result": null, "explore": true, "enable_rl_module_and_learner": true, "enable_env_runner_and_connector_v2": true, "_prior_exploration_config": {"type": "StochasticSampling"}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x1514e58a0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "offline_data_class": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_read_batch_size": null, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "materialize_data": false, "materialize_mapped_data": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "ignore_final_observation": false, "prelearner_class": null, "prelearner_buffer_class": null, "prelearner_buffer_kwargs": {}, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_remaining_data": false, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": 1, "evaluation_duration": 20, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_auto_duration_min_env_steps_per_sample": 100, "evaluation_auto_duration_max_env_steps_per_sample": 2000, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 1, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "offline_evaluation_interval": null, "num_offline_eval_runners": 0, "offline_loss_for_module_fn": null, "offline_evaluation_duration": 1, "offline_evaluation_parallel_to_training": false, "offline_evaluation_timeout_s": 120.0, "num_cpus_per_offline_eval_runner": 1, "num_gpus_per_offline_eval_runner": 0, "custom_resources_per_offline_eval_runner": {}, "restart_failed_offline_eval_runners": true, "ignore_offline_eval_runner_failures": false, "max_num_offline_eval_runner_restarts": 1000, "offline_eval_runner_restore_timeout_s": 1800.0, "max_requests_in_flight_per_offline_eval_runner": 1, "validate_offline_eval_runners_after_construction": true, "offline_eval_runner_health_probe_timeout_s": 30.0, "offline_eval_rl_module_inference_only": false, "broadcast_offline_eval_runner_states": false, "offline_eval_batch_size_per_runner": 256, "dataset_num_iters_per_eval_runner": 1, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "log_gradients": false, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 4, "restart_failed_env_runners": true, "ignore_env_runner_failures": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30.0, "env_runner_restore_timeout_s": 1800.0, "_model_config": {}, "_rl_module_spec": "MultiRLModuleSpec(multi_rl_module_class=<class 'ray.rllib.core.rl_module.multi_rl_module.MultiRLModule'>, observation_space=None, action_space=None, inference_only=False, model_config=None, rl_module_specs={'default_policy': RLModuleSpec(module_class=<class 'source.intrinsic_attention_ppo.rl_modules.DifferentiablePPOModule.DifferentiablePPOModule'>, observation_space=None, action_space=None, inference_only=False, learner_only=False, model_config={'vf_share_layers': True, 'embedding_dim': 62, 'max_seq_len': 11, 'policy_head_hidden_sizes': [32], 'value_head_hidden_sizes': [101], 'embedding_hidden_sizes': [121]}, catalog_class=None, load_state_path=None, model_config_dict=None), 'intrinsic_reward_module': RLModuleSpec(module_class=<class 'source.intrinsic_attention_ppo.rl_modules.IntrinsicAttentionModule.IntrinsicAttentionModule'>, observation_space=None, action_space=None, inference_only=False, learner_only=True, model_config={'intrinsic_reward_network': {'encoder_hidden_sizes': [], 'encoding_dim': 1, 'num_heads': 1, 'head_hidden_sizes': None, 'layers': [{'type': 'attention'}]}, 'extrinsic_value_hidden_layers': [127, 60], 'vf_share_layers': True, 'max_seq_len': 11}, catalog_class=None, load_state_path=None, model_config_dict=None)}, load_state_path=None, modules_to_load=None, module_specs={'default_policy': RLModuleSpec(module_class=<class 'source.intrinsic_attention_ppo.rl_modules.DifferentiablePPOModule.DifferentiablePPOModule'>, observation_space=None, action_space=None, inference_only=False, learner_only=False, model_config={'vf_share_layers': True, 'embedding_dim': 62, 'max_seq_len': 11, 'policy_head_hidden_sizes': [32], 'value_head_hidden_sizes': [101], 'embedding_hidden_sizes': [121]}, catalog_class=None, load_state_path=None, model_config_dict=None), 'intrinsic_reward_module': RLModuleSpec(module_class=<class 'source.intrinsic_attention_ppo.rl_modules.IntrinsicAttentionModule.IntrinsicAttentionModule'>, observation_space=None, action_space=None, inference_only=False, learner_only=True, model_config={'intrinsic_reward_network': {'encoder_hidden_sizes': [], 'encoding_dim': 1, 'num_heads': 1, 'head_hidden_sizes': None, 'layers': [{'type': 'attention'}]}, 'extrinsic_value_hidden_layers': [127, 60], 'vf_share_layers': True, 'max_seq_len': 11}, catalog_class=None, load_state_path=None, model_config_dict=None)})", "algorithm_config_overrides_per_module": {"intrinsic_reward_module": {"lr": 0.0002715581955}}, "_per_module_overrides": {}, "_validate_config": true, "_use_msgpack_checkpoints": false, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "env_task_fn": -1, "enable_connectors": -1, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.161583927863, "kl_target": 0.0201019014258, "vf_loss_coeff": 0.7790510010087, "entropy_coeff": 0.0015431216992, "clip_param": 0.2459212356676, "vf_clip_param": 0.3769744131561, "entropy_coeff_schedule": null, "lr_schedule": null, "sgd_minibatch_size": -1, "vf_share_layers": -1, "differentiable_learner_configs": ["DifferentiableLearnerConfig(learner_class=<class 'source.intrinsic_attention_ppo.learners.IntrinsicAttentionPPOLearner.IntrinsicAttentionPPOLearner'>, learner_connector=None, add_default_connectors_to_learner_pipeline=True, is_multi_agent=False, policies_to_update=['default_policy'], lr=0.0060984166342, num_total_minibatches=0, num_epochs=1, minibatch_size=1000, shuffle_batch_per_epoch=True)"], "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9485408017724, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.callbacks.callbacks.RLlibCallback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 10.415034294128418, "iterations_since_restore": 1, "perf": {"cpu_util_percent": 41.080000000000005, "ram_util_percent": 82.49333333333331}}
{"timers": {"training_iteration": 10.200921748862601, "restore_env_runners": 1.1046846630051732e-05, "training_step": 10.200728004577103, "env_runner_sampling_timer": 1.8210065823933108, "learner_update_timer": 8.200691661621676, "synch_weights": 0.001540497747482732, "restore_eval_env_runners": 8.066697046160698e-05, "evaluation_iteration": 0.21800316695589572, "synch_eval_env_connectors": 0.0002313329605385661, "synch_env_connectors": 4.999921657145023e-06}, "env_runners": {"num_env_steps_sampled": 5000.0, "episode_return_max": 12.5, "env_to_module_connector": {"timers": {"connectors": {"add_time_dim_to_batch_and_zero_pad": 7.63012836163839e-06, "add_observations_from_episodes_to_batch": 3.11895340884794e-06, "batch_individual_items": 1.3773051209013541e-05, "numpy_to_tensor": 1.4420617138785083e-05, "add_states_from_episodes_to_batch": 2.9175039200507905e-06}}, "connector_pipeline_timer": 6.599505995829538e-05}, "episode_len_min": 20, "module_to_env_connector": {"timers": {"connectors": {"un_batch_to_individual_items": 7.138576081195371e-06, "normalize_and_clip_actions": 8.719576611964975e-06, "remove_single_ts_time_rank_from_batch": 1.2745009646222027e-05, "get_actions": 4.547506862934644e-05, "tensor_to_numpy": 1.6595159646887567e-05, "listify_data_for_vector_env": 1.1516940140509296e-05}}, "connector_pipeline_timer": 0.00013122247777019858}, "env_step_timer": 1.5961149359490896e-05, "num_agent_steps_sampled_lifetime": {"default_agent": 10000.0}, "num_episodes": 250.0, "episode_duration_sec_mean": 0.005888973874971267, "episode_len_mean": 20.0, "module_episode_returns_mean": {"default_policy": 3.7}, "weights_seq_no": 1.0, "env_to_module_sum_episodes_length_out": 10.36823839457432, "num_env_steps_sampled_lifetime": 10000.0, "episode_len_max": 20, "rlmodule_inference_timer": 3.592971498906433e-05, "num_agent_steps_sampled": {"default_agent": 5000.0}, "env_reset_timer": 6.463553724275481e-05, "agent_episode_returns_mean": {"default_agent": 3.7}, "env_to_module_sum_episodes_length_in": 10.36823839457432, "episode_return_mean": 3.7, "time_between_sampling": 0.0326842992350975, "num_module_steps_sampled_lifetime": {"default_policy": 10000.0}, "num_module_steps_sampled": {"default_policy": 5000.0}, "num_episodes_lifetime": 500.0, "episode_return_min": -7.5, "sample": 0.006622306275250385, "num_env_steps_sampled_lifetime_throughput": 2906.4142500065172}, "__all_modules__": {"learner_connector_sum_episodes_length_in": 5000.0, "learner_connector": {"connector_pipeline_timer": 0.1389557280135341, "timers": {"connectors": {"add_one_ts_to_episodes_and_truncate": 0.00948121196241118, "add_observations_from_episodes_to_batch": 0.0010471244156360624, "add_columns_from_episodes_to_train_batch": 0.04409552754019387, "add_time_dim_to_batch_and_zero_pad": 0.07615687653888017, "add_states_from_episodes_to_batch": 0.0035619657614734024, "batch_individual_items": 0.004348897694144397, "numpy_to_tensor": 7.194996695034206e-05}}}, "learner_connector_sum_episodes_length_out": 5250.0}, "learners": {"__all_modules__": {"num_module_steps_trained_lifetime": 23940, "num_env_steps_trained": 33000, "num_env_steps_trained_lifetime": 66000, "num_non_trainable_parameters": 0, "num_trainable_parameters": 24861, "num_module_steps_trained": 11970, "num_env_steps_trained_lifetime_throughput": 3986.9425702924163, "num_module_steps_trained_throughput": 31335467.00639402, "num_module_steps_trained_lifetime_throughput": 13040256.4514931}, "default_policy": {"curr_entropy_coeff": 0.0015431216992, "weights_seq_no": 2.0, "curr_kl_coeff": 0.040395982563495636, "policy_loss": -0.00018722163804341108, "module_train_batch_size_mean": 997.9429069707118, "num_trainable_parameters": 16595, "vf_loss": 0.35835039615631104, "mean_kl_loss": 9.814555596676655e-06, "diff_num_grad_updates_vs_sampler_policy": 1.0, "vf_explained_var": -0.0022144317626953125, "use_intrinsic_rewards": 0.0, "entropy": 0.6879688501358032, "num_module_steps_trained": 5985, "vf_loss_unclipped": 43.98406219482422, "total_loss": 0.27792519330978394, "num_module_steps_trained_lifetime": 11970, "num_module_steps_trained_lifetime_throughput": 722.7791817134755}, "differentiable_learners": {"intrinsic_attention_ppo_learner": {"__all_modules__": {"num_module_steps_trained_lifetime": 143640, "num_env_steps_trained_lifetime": 396000, "num_module_steps_trained": 71820, "num_env_steps_trained": 198000, "num_env_steps_trained_lifetime_throughput": 53388.27612509848}, "default_policy": {"weights_seq_no": 12.0, "policy_loss": -0.00017970932822208852, "module_train_batch_size_mean": 997.7412016936058, "vf_loss": 0.35831978917121887, "mean_kl_loss": 8.915151738619898e-06, "diff_num_grad_updates_vs_sampler_policy": 11.0, "vf_explained_var": 0.002715587615966797, "use_intrinsic_rewards": 1.0, "entropy": 0.6879898309707642, "num_module_steps_trained": 35910, "vf_loss_unclipped": 43.792999267578125, "total_loss": 0.27790945768356323, "num_module_steps_trained_lifetime": 71820}, "intrinsic_reward_module": {"total_loss": 0.0, "num_module_steps_trained_lifetime": 71820, "module_train_batch_size_mean": 997.7412016936058, "weights_seq_no": 12.0, "num_module_steps_trained": 35910, "diff_num_grad_updates_vs_sampler_policy": 11.0}}}, "intrinsic_reward_module": {"diff_num_grad_updates_vs_sampler_policy": 1.0, "gradients_default_optimizer_global_norm": 0.0, "curr_entropy_coeff": 0.0015431216992, "weights_seq_no": 2.0, "default_optimizer_learning_rate": 0.0002715581955, "total_loss": 0.0, "num_module_steps_trained_lifetime": 11970, "module_train_batch_size_mean": 997.9429069707118, "num_trainable_parameters": 8266, "num_module_steps_trained": 5985, "num_module_steps_trained_lifetime_throughput": 722.7921164250287}, "IntrinsicAttentionMask": [[[0.09180770814418793, 0.09022756665945053, 0.09012993425130844, 0.09151000529527664, 0.09141098707914352, 0.09093142300844193, 0.09232376515865326, 0.08964335918426514, 0.09212406724691391, 0.09053848683834076, 0.08935266733169556], [0.091578409075737, 0.09040205925703049, 0.09032920002937317, 0.09135717898607254, 0.09128355234861374, 0.09092669188976288, 0.09196147322654724, 0.0899658054113388, 0.09181331098079681, 0.09063393622636795, 0.08974846452474594], [0.09156409651041031, 0.0904129222035408, 0.09034160524606705, 0.09134762734174728, 0.09127558767795563, 0.09092637151479721, 0.09193889796733856, 0.0899859219789505, 0.09179393947124481, 0.0906398594379425, 0.08977317810058594], [0.09176481515169144, 0.09026023745536804, 0.09016723185777664, 0.09148143976926804, 0.09138718247413635, 0.09093058854341507, 0.09225592762231827, 0.08970364183187485, 0.09206590056419373, 0.09055638313293457, 0.08942662924528122], [0.09175051748752594, 0.09027112275362015, 0.09017966687679291, 0.09147191792726517, 0.09137924015522003, 0.09093030542135239, 0.0922333225607872, 0.08972374349832535, 0.09204651415348053, 0.09056234359741211, 0.08945129811763763], [0.09168104827404022, 0.09032399207353592, 0.09024003148078918, 0.09142562747001648, 0.09134063869714737, 0.09092888981103897, 0.09212353080511093, 0.08982141315937042, 0.09195234626531601, 0.09059127420186996, 0.08957117050886154], [0.09188172966241837, 0.09017117321491241, 0.09006556868553162, 0.0915592610836029, 0.09145203232765198, 0.09093281626701355, 0.0924409031867981, 0.08953936398029327, 0.09222449362277985, 0.09050755947828293, 0.08922512084245682], [0.09149257838726044, 0.09046724438667297, 0.09040368348360062, 0.0912998765707016, 0.09123573452234268, 0.09092473983764648, 0.09182609617710114, 0.09008656442165375, 0.09169711172580719, 0.09066948294639587, 0.08989682048559189], [0.09185314178466797, 0.09019296616315842, 0.09009043872356415, 0.09154024720191956, 0.09143618494272232, 0.09093229472637177, 0.09239564836025238, 0.08957953751087189, 0.09218570590019226, 0.09051951766014099, 0.08927438408136368], [0.09162385016679764, 0.09036750346422195, 0.09028973430395126, 0.09138749539852142, 0.0913088396191597, 0.09092768281698227, 0.09203319996595383, 0.0899018719792366, 0.0918748527765274, 0.09061506390571594, 0.08966995775699615], [0.09144967049360275, 0.09049983322620392, 0.09044092893600464, 0.09127121418714523, 0.09121181070804596, 0.0909237414598465, 0.09175845980644226, 0.0901469811797142, 0.09163904935121536, 0.09068725258111954, 0.08997107297182083]], [[0.0920972153544426, 0.09201500564813614, 0.09285512566566467, 0.09062572568655014, 0.09176882356405258, 0.09260668605566025, 0.09038325399160385, 0.09244143962860107, 0.0831688717007637, 0.09181708097457886, 0.09022083133459091], [0.09207485616207123, 0.09199424833059311, 0.09281789511442184, 0.0906318947672844, 0.09175286442041397, 0.092574343085289, 0.09039407968521118, 0.09241233021020889, 0.0833125039935112, 0.09180018305778503, 0.09023477137088776], [0.09230132400989532, 0.09220433980226517, 0.09319611638784409, 0.09056778252124786, 0.09191401302814484, 0.09290266782045364, 0.0902826115489006, 0.0927075445652008, 0.08186101913452148, 0.09197091311216354, 0.09009166061878204], [0.0916905626654625, 0.09163720160722733, 0.0921817272901535, 0.09073290228843689, 0.09147729724645615, 0.09202088415622711, 0.09057458490133286, 0.09191380441188812, 0.08579390496015549, 0.0915086567401886, 0.09046845883131027], [0.09200765937566757, 0.09193187206983566, 0.09270615130662918, 0.09065026044845581, 0.09170487523078918, 0.0924772396683693, 0.09042643010616302, 0.09232494980096817, 0.08374475687742233, 0.09174937009811401, 0.09027646481990814], [0.09223479777574539, 0.09214265644550323, 0.09308476001024246, 0.09058696031570435, 0.09186677634716034, 0.09280605614185333, 0.09031573683023453, 0.09262071549892426, 0.08228649199008942, 0.09192083775997162, 0.09013410657644272], [0.09162221103906631, 0.09157362580299377, 0.09206930547952652, 0.09074987471103668, 0.09142801910638809, 0.09192291647195816, 0.09060558676719666, 0.0918254479765892, 0.08623767644166946, 0.0914565771818161, 0.0905088409781456], [0.09219034016132355, 0.09210141748189926, 0.09301046282052994, 0.09059961885213852, 0.09183516353368759, 0.09274157136678696, 0.09033770114183426, 0.09256274998188019, 0.08257124572992325, 0.09188734740018845, 0.09016228467226028], [0.08939483016729355, 0.08949100226163864, 0.08851700276136398, 0.09114541858434677, 0.08978015184402466, 0.0888030007481575, 0.09143991023302078, 0.08899418264627457, 0.1010730043053627, 0.08972334116697311, 0.09163815528154373], [0.09202086180448532, 0.0919441282749176, 0.09272808581590652, 0.09064667671918869, 0.09171430766582489, 0.09249630570411682, 0.09042009711265564, 0.09234210848808289, 0.08365977555513382, 0.09175936132669449, 0.09026829898357391], [0.09157620370388031, 0.09153081476688385, 0.09199375659227371, 0.09076111763715744, 0.09139479696750641, 0.09185705333948135, 0.09062624722719193, 0.09176602959632874, 0.08653675019741058, 0.09142147749662399, 0.09053581207990646]], [[0.08866900205612183, 0.0918130874633789, 0.09060867130756378, 0.09053408354520798, 0.09045956283807755, 0.0923573449254036, 0.09114578366279602, 0.09136057645082474, 0.09099579602479935, 0.09092089533805847, 0.09113515913486481], [0.08672400563955307, 0.09261395037174225, 0.09033618867397308, 0.09019602090120316, 0.09005606174468994, 0.09365196526050568, 0.09134867042303085, 0.09175504744052887, 0.09106539934873581, 0.09092409908771515, 0.09132858365774155], [0.08745679259300232, 0.09231044352054596, 0.09044014662504196, 0.0903247818350792, 0.09020955115556717, 0.09316004067659378, 0.09127253293991089, 0.09160616248846054, 0.09103982150554657, 0.09092368185520172, 0.0912560373544693], [0.08750266581773758, 0.09229151904582977, 0.0904465988278389, 0.09033278375864029, 0.09021911025047302, 0.09312941879034042, 0.09126775711774826, 0.09159684926271439, 0.09103819727897644, 0.09092362970113754, 0.09125148504972458], [0.08754855394363403, 0.09227259457111359, 0.09045305848121643, 0.09034078568220139, 0.09022865444421768, 0.09309880435466766, 0.09126297384500504, 0.09158754348754883, 0.09103656560182571, 0.09092356264591217, 0.09124693274497986], [0.08639771491289139, 0.09274979680776596, 0.09028938412666321, 0.09013813734054565, 0.0899871364235878, 0.09387265890836716, 0.0913824588060379, 0.09182145446538925, 0.09107654541730881, 0.090923972427845, 0.09136076271533966], [0.0871281549334526, 0.09244628995656967, 0.09039371460676193, 0.09026724100112915, 0.0901409387588501, 0.09338001906871796, 0.09130672365427017, 0.09167288988828659, 0.091051384806633, 0.0909239873290062, 0.09128861874341965], [0.08699756860733032, 0.09250038862228394, 0.09037518501281738, 0.09024428576231003, 0.0901135802268982, 0.09346771985292435, 0.09132029116153717, 0.09169942885637283, 0.09105594456195831, 0.09092405438423157, 0.09130155295133591], [0.08721962571144104, 0.0924084261059761, 0.09040667116641998, 0.09028328955173492, 0.090160071849823, 0.09331868588924408, 0.0912972092628479, 0.09165430814027786, 0.09104818105697632, 0.09092392027378082, 0.09127955883741379], [0.08726539462804794, 0.09238950908184052, 0.09041314572095871, 0.09029131382703781, 0.09016963839530945, 0.09328803420066833, 0.09129245579242706, 0.0916450172662735, 0.09104657918214798, 0.09092388302087784, 0.09127502143383026], [0.08713462948799133, 0.09244360774755478, 0.09039463847875595, 0.09026837348937988, 0.09014229476451874, 0.09337567538022995, 0.09130604565143585, 0.09167157858610153, 0.09105116128921509, 0.0909239873290062, 0.09128798544406891]], [[0.09097664058208466, 0.09085112810134888, 0.09213658422231674, 0.0906006321310997, 0.0886170044541359, 0.08987085521221161, 0.08837267756462097, 0.09150280803442001, 0.10362936556339264, 0.08868905156850815, 0.08475323021411896], [0.09097710996866226, 0.09085316956043243, 0.09212249517440796, 0.09060578793287277, 0.0886465534567833, 0.08988504856824875, 0.08840518444776535, 0.09149669110774994, 0.10346154123544693, 0.08871772140264511, 0.0848286971449852], [0.09097070246934891, 0.09083083271980286, 0.09226443618535995, 0.09055174142122269, 0.08834478259086609, 0.08973914384841919, 0.08807333558797836, 0.0915573313832283, 0.10518050193786621, 0.08842484652996063, 0.08406233042478561], [0.09097794443368912, 0.0908571407198906, 0.09209419041872025, 0.09061599522829056, 0.08870556205511093, 0.08991333097219467, 0.08847013860940933, 0.09148435294628143, 0.10312657803297043, 0.08877497911453247, 0.08497972041368484], [0.09097979962825775, 0.09088410437107086, 0.09186273068189621, 0.09069301187992096, 0.08917537331581116, 0.0901355966925621, 0.08898787200450897, 0.09138063341379166, 0.10047443956136703, 0.08923063427209854, 0.08619578927755356], [0.09097964316606522, 0.09086800366640091, 0.09201060235500336, 0.09064514189958572, 0.08887790888547897, 0.08999548107385635, 0.08865992724895477, 0.09144748002290726, 0.10215079039335251, 0.08894217014312744, 0.08542294800281525], [0.09097941219806671, 0.09088685363531113, 0.09183327853679657, 0.09070201218128204, 0.08923353999853134, 0.0901627466082573, 0.08905205875635147, 0.09136708825826645, 0.1001478061079979, 0.08928702026605606, 0.08634809404611588], [0.09097430109977722, 0.09084224700927734, 0.09219512343406677, 0.09057873487472534, 0.08849333971738815, 0.08981123566627502, 0.08823664486408234, 0.09152797609567642, 0.10433296859264374, 0.0885690450668335, 0.08443837612867355], [0.09077390283346176, 0.09050139784812927, 0.09331338852643967, 0.08995884656906128, 0.08572468161582947, 0.08838824927806854, 0.08521076291799545, 0.09192114323377609, 0.12053792178630829, 0.08587653934955597, 0.07779314368963242], [0.09097988158464432, 0.09088326245546341, 0.09187137335538864, 0.09069033712148666, 0.08915822952985764, 0.09012757986783981, 0.08896896988153458, 0.09138458967208862, 0.10057075321674347, 0.0892140120267868, 0.08615098893642426], [0.09095748513936996, 0.09091240912675858, 0.09137222170829773, 0.09082232415676117, 0.09010323137044907, 0.09055895358324051, 0.09001395106315613, 0.09114602953195572, 0.09531150758266449, 0.09012953191995621, 0.08867237716913223]], [[0.09153775125741959, 0.08996225893497467, 0.08986491709947586, 0.09124092012643814, 0.08967053890228271, 0.09215200692415237, 0.09056594222784042, 0.09084665030241013, 0.09185317903757095, 0.09175379574298859, 0.09055206179618835], [0.09137754142284393, 0.09020376205444336, 0.09013106673955917, 0.09115678817033768, 0.08998584747314453, 0.09183377027511597, 0.09065413475036621, 0.09086328744888306, 0.09161192178726196, 0.09153809398412704, 0.09064378589391708], [0.09136753529310226, 0.09021882712841034, 0.09014767408370972, 0.09115153551101685, 0.0900055319070816, 0.09181394428014755, 0.09065961837768555, 0.09086430817842484, 0.09159687906503677, 0.091524638235569, 0.09064949303865433], [0.09150779247283936, 0.09000742435455322, 0.08991467952728271, 0.09122520685195923, 0.08972947299480438, 0.09209241718053818, 0.0905824676156044, 0.09084979444742203, 0.0918080285191536, 0.09171342849731445, 0.09056924283504486], [0.09134753793478012, 0.0902489572763443, 0.0901808962225914, 0.09114100784063339, 0.09004490822553635, 0.09177429974079132, 0.09067058563232422, 0.09086634963750839, 0.09156680107116699, 0.09149773418903351, 0.09066089987754822], [0.09159941971302032, 0.08986927568912506, 0.08976247161626816, 0.0912732258439064, 0.0895492434501648, 0.09227476269006729, 0.0905318632721901, 0.09084010869264603, 0.09194616228342056, 0.09183689206838608, 0.09051661938428879], [0.09143927693367004, 0.09011070430278778, 0.09002850204706192, 0.09118924289941788, 0.08986430615186691, 0.09195628762245178, 0.09062020480632782, 0.09085693210363388, 0.0917048379778862, 0.09162117540836334, 0.09060849249362946], [0.09146783500909805, 0.09006765484809875, 0.08998105674982071, 0.09120424091815948, 0.08980809897184372, 0.09201300889253616, 0.09060448408126831, 0.0908539667725563, 0.09174784272909164, 0.09165962785482407, 0.0905921459197998], [0.09156946837902069, 0.08991442620754242, 0.08981221169233322, 0.09125753492116928, 0.08960813283920288, 0.09221512824296951, 0.09054841101169586, 0.09084328263998032, 0.09190100431442261, 0.09179653227329254, 0.09053383022546768], [0.09155949205160141, 0.0899294838309288, 0.08982879668474197, 0.09125231951475143, 0.08962778002023697, 0.09219526499509811, 0.09055393934249878, 0.09084435552358627, 0.09188596159219742, 0.0917830839753151, 0.09053957462310791], [0.09143785387277603, 0.0901128351688385, 0.09003084152936935, 0.09118849784135818, 0.08986708521842957, 0.09195347130298615, 0.0906209796667099, 0.09085707366466522, 0.09170270711183548, 0.09161926805973053, 0.09060929715633392]], [[0.08959628641605377, 0.08949587494134903, 0.09052305668592453, 0.09081366658210754, 0.09071189165115356, 0.0917530283331871, 0.08899551630020142, 0.09154748916625977, 0.10128553956747055, 0.0892542228102684, 0.08602332323789597], [0.08961737155914307, 0.0895184874534607, 0.09053004533052444, 0.0908161997795105, 0.09071598947048187, 0.09174107015132904, 0.08902566879987717, 0.09153871238231659, 0.10111857205629349, 0.08928047865629196, 0.08609741926193237], [0.08940152823925018, 0.08928721398115158, 0.09045751392841339, 0.09078896790742874, 0.09067286550998688, 0.09186133742332458, 0.08871781080961227, 0.09162656962871552, 0.10282911360263824, 0.08901215344667435, 0.08534491062164307], [0.08934038132429123, 0.08922174572944641, 0.09043653309345245, 0.09078069031238556, 0.09066013991832733, 0.09189451485872269, 0.08863092213869095, 0.09165062010288239, 0.10331400483846664, 0.08893632143735886, 0.08513416349887848], [0.08936180174350739, 0.08924467116594315, 0.09044390916824341, 0.09078361093997955, 0.09066462516784668, 0.09188293665647507, 0.08866134285926819, 0.09164223819971085, 0.10314414650201797, 0.08896287530660629, 0.08520786464214325], [0.08914247155189514, 0.08901000767946243, 0.09036729484796524, 0.09075221419334412, 0.09061736613512039, 0.09199916571378708, 0.08835068345069885, 0.09172596782445908, 0.10488413274288177, 0.08869142830371857, 0.08445926010608673], [0.08972235023975372, 0.08963106572628021, 0.09056442230939865, 0.0908283069729805, 0.09073589742183685, 0.09168075770139694, 0.08917605131864548, 0.09149430692195892, 0.10028725117444992, 0.08941134065389633, 0.08646832406520844], [0.08918579667806625, 0.0890563502907753, 0.09038262069225311, 0.09075865894556046, 0.09062693268060684, 0.091976597905159, 0.08841191977262497, 0.09170978516340256, 0.10454021394252777, 0.08874497562646866, 0.0846061035990715], [0.08711770176887512, 0.0868561789393425, 0.08955489844083786, 0.09032783657312393, 0.09005666524171829, 0.09285483509302139, 0.08556027710437775, 0.09229817986488342, 0.12103233486413956, 0.08622878044843674, 0.07811222225427628], [0.08966808021068573, 0.08957286179065704, 0.09054671972990036, 0.09082213044166565, 0.09072568267583847, 0.09171207249164581, 0.089098259806633, 0.0915173888206482, 0.10071690380573273, 0.08934365957975388, 0.08627618104219437], [0.09034327417612076, 0.09029849618673325, 0.09075520187616348, 0.09088388830423355, 0.09083884954452515, 0.09129828959703445, 0.09007497131824493, 0.09120781719684601, 0.09537611901760101, 0.09019062668085098, 0.08873248845338821]]]}, "num_training_step_calls_per_iteration": 1, "evaluation": {"env_runners": {"episode_len_max": 20, "rlmodule_inference_timer": 4.190964205962583e-05, "num_module_steps_sampled": {"default_policy": 400}, "sample": 0.17454649909050204, "env_to_module_connector": {"timers": {"connectors": {"add_states_from_episodes_to_batch": 3.289210918513619e-06, "add_time_dim_to_batch_and_zero_pad": 9.663954975697101e-06, "add_observations_from_episodes_to_batch": 3.8150904246232436e-06, "numpy_to_tensor": 1.6083837211826272e-05, "batch_individual_items": 1.5789069074555643e-05}}, "connector_pipeline_timer": 7.643924322292111e-05}, "module_episode_returns_mean": {"default_policy": 2.65}, "module_to_env_connector": {"timers": {"connectors": {"normalize_and_clip_actions": 9.742255437472578e-06, "remove_single_ts_time_rank_from_batch": 1.3960096574121645e-05, "tensor_to_numpy": 2.0284858879055588e-05, "listify_data_for_vector_env": 1.284065854526238e-05, "un_batch_to_individual_items": 7.975609002889871e-06, "get_actions": 5.246139196728133e-05}}, "connector_pipeline_timer": 0.00014913396360051218}, "episode_duration_sec_mean": 0.007614064528024755, "weights_seq_no": 2.0, "env_to_module_sum_episodes_length_out": 10.366003441359926, "agent_episode_returns_mean": {"default_agent": 2.65}, "episode_return_mean": 2.65, "env_to_module_sum_episodes_length_in": 10.366003441359926, "num_episodes_lifetime": 40, "num_agent_steps_sampled_lifetime": {"default_agent": 800}, "num_episodes": 20, "episode_len_mean": 20.0, "num_agent_steps_sampled": {"default_agent": 400}, "num_module_steps_sampled_lifetime": {"default_policy": 800}, "env_reset_timer": 0.0024424213753081857, "episode_return_min": -16.5, "num_env_steps_sampled": 400, "episode_len_min": 20, "episode_return_max": 12.5, "env_step_timer": 1.847346799197239e-05, "num_env_steps_sampled_lifetime": 10400, "time_between_sampling": 10.9683383340016}, "num_healthy_workers": 1, "actor_manager_num_outstanding_async_reqs": 0, "num_remote_worker_restarts": 0}, "num_env_steps_sampled_lifetime": 10000.0, "fault_tolerance": {"num_healthy_workers": 0, "num_remote_worker_restarts": 0}, "env_runner_group": {"actor_manager_num_outstanding_async_reqs": 0}, "done": false, "training_iteration": 2, "trial_id": "b154b_00000", "date": "2025-08-11_18-11-46", "timestamp": 1754928706, "time_this_iter_s": 11.056770086288452, "time_total_s": 21.47180438041687, "pid": 10455, "hostname": "Mac", "node_ip": "127.0.0.1", "config": {"exploration_config": {}, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 2, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "env": "Umbrella", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": false, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 0, "create_local_env_runner": true, "num_envs_per_env_runner": 1, "gym_env_vectorize_mode": "SYNC", "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "episodes_to_numpy": true, "max_requests_in_flight_per_env_runner": 1, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "merge_env_runner_states": "training_only", "broadcast_env_runner_states": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "complete_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "sampler_perf_stats_ema_coef": null, "_is_online": true, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": "auto", "num_aggregator_actors_per_learner": 0, "max_requests_in_flight_per_aggregator_actor": 3, "local_gpu_idx": 0, "max_requests_in_flight_per_learner": 3, "gamma": 1, "lr": 0.0002715581955, "grad_clip": 0.5, "grad_clip_by": "global_norm", "_train_batch_size_per_learner": 5000, "train_batch_size": 4000, "num_epochs": 1, "minibatch_size": 1000, "shuffle_batch_per_epoch": true, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "log_std_clip_param": 20.0, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "_disable_preprocessor_api": false, "_disable_action_flattening": false}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {"intrinsic_reward_coeff": 0.2795015916508}, "optimizer": {}, "_learner_class": "<class 'source.intrinsic_attention_ppo.learners.IntrinsicAttentionMetaLearner.IntrinsicAttentionMetaLearner'>", "callbacks_on_algorithm_init": null, "callbacks_on_env_runners_recreated": null, "callbacks_on_offline_eval_runners_recreated": null, "callbacks_on_checkpoint_loaded": null, "callbacks_on_environment_created": null, "callbacks_on_episode_created": null, "callbacks_on_episode_start": null, "callbacks_on_episode_step": null, "callbacks_on_episode_end": null, "callbacks_on_evaluate_start": null, "callbacks_on_evaluate_end": null, "callbacks_on_evaluate_offline_start": null, "callbacks_on_evaluate_offline_end": null, "callbacks_on_sample_end": null, "callbacks_on_train_result": null, "explore": true, "enable_rl_module_and_learner": true, "enable_env_runner_and_connector_v2": true, "_prior_exploration_config": {"type": "StochasticSampling"}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x1514e58a0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "offline_data_class": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_read_batch_size": null, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "materialize_data": false, "materialize_mapped_data": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "ignore_final_observation": false, "prelearner_class": null, "prelearner_buffer_class": null, "prelearner_buffer_kwargs": {}, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_remaining_data": false, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": 1, "evaluation_duration": 20, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_auto_duration_min_env_steps_per_sample": 100, "evaluation_auto_duration_max_env_steps_per_sample": 2000, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 1, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "offline_evaluation_interval": null, "num_offline_eval_runners": 0, "offline_loss_for_module_fn": null, "offline_evaluation_duration": 1, "offline_evaluation_parallel_to_training": false, "offline_evaluation_timeout_s": 120.0, "num_cpus_per_offline_eval_runner": 1, "num_gpus_per_offline_eval_runner": 0, "custom_resources_per_offline_eval_runner": {}, "restart_failed_offline_eval_runners": true, "ignore_offline_eval_runner_failures": false, "max_num_offline_eval_runner_restarts": 1000, "offline_eval_runner_restore_timeout_s": 1800.0, "max_requests_in_flight_per_offline_eval_runner": 1, "validate_offline_eval_runners_after_construction": true, "offline_eval_runner_health_probe_timeout_s": 30.0, "offline_eval_rl_module_inference_only": false, "broadcast_offline_eval_runner_states": false, "offline_eval_batch_size_per_runner": 256, "dataset_num_iters_per_eval_runner": 1, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "log_gradients": false, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 4, "restart_failed_env_runners": true, "ignore_env_runner_failures": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30.0, "env_runner_restore_timeout_s": 1800.0, "_model_config": {}, "_rl_module_spec": "MultiRLModuleSpec(multi_rl_module_class=<class 'ray.rllib.core.rl_module.multi_rl_module.MultiRLModule'>, observation_space=None, action_space=None, inference_only=False, model_config=None, rl_module_specs={'default_policy': RLModuleSpec(module_class=<class 'source.intrinsic_attention_ppo.rl_modules.DifferentiablePPOModule.DifferentiablePPOModule'>, observation_space=None, action_space=None, inference_only=False, learner_only=False, model_config={'vf_share_layers': True, 'embedding_dim': 62, 'max_seq_len': 11, 'policy_head_hidden_sizes': [32], 'value_head_hidden_sizes': [101], 'embedding_hidden_sizes': [121]}, catalog_class=None, load_state_path=None, model_config_dict=None), 'intrinsic_reward_module': RLModuleSpec(module_class=<class 'source.intrinsic_attention_ppo.rl_modules.IntrinsicAttentionModule.IntrinsicAttentionModule'>, observation_space=None, action_space=None, inference_only=False, learner_only=True, model_config={'intrinsic_reward_network': {'encoder_hidden_sizes': [], 'encoding_dim': 1, 'num_heads': 1, 'head_hidden_sizes': None, 'layers': [{'type': 'attention'}]}, 'extrinsic_value_hidden_layers': [127, 60], 'vf_share_layers': True, 'max_seq_len': 11}, catalog_class=None, load_state_path=None, model_config_dict=None)}, load_state_path=None, modules_to_load=None, module_specs={'default_policy': RLModuleSpec(module_class=<class 'source.intrinsic_attention_ppo.rl_modules.DifferentiablePPOModule.DifferentiablePPOModule'>, observation_space=None, action_space=None, inference_only=False, learner_only=False, model_config={'vf_share_layers': True, 'embedding_dim': 62, 'max_seq_len': 11, 'policy_head_hidden_sizes': [32], 'value_head_hidden_sizes': [101], 'embedding_hidden_sizes': [121]}, catalog_class=None, load_state_path=None, model_config_dict=None), 'intrinsic_reward_module': RLModuleSpec(module_class=<class 'source.intrinsic_attention_ppo.rl_modules.IntrinsicAttentionModule.IntrinsicAttentionModule'>, observation_space=None, action_space=None, inference_only=False, learner_only=True, model_config={'intrinsic_reward_network': {'encoder_hidden_sizes': [], 'encoding_dim': 1, 'num_heads': 1, 'head_hidden_sizes': None, 'layers': [{'type': 'attention'}]}, 'extrinsic_value_hidden_layers': [127, 60], 'vf_share_layers': True, 'max_seq_len': 11}, catalog_class=None, load_state_path=None, model_config_dict=None)})", "algorithm_config_overrides_per_module": {"intrinsic_reward_module": {"lr": 0.0002715581955}}, "_per_module_overrides": {}, "_validate_config": true, "_use_msgpack_checkpoints": false, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "env_task_fn": -1, "enable_connectors": -1, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.161583927863, "kl_target": 0.0201019014258, "vf_loss_coeff": 0.7790510010087, "entropy_coeff": 0.0015431216992, "clip_param": 0.2459212356676, "vf_clip_param": 0.3769744131561, "entropy_coeff_schedule": null, "lr_schedule": null, "sgd_minibatch_size": -1, "vf_share_layers": -1, "differentiable_learner_configs": ["DifferentiableLearnerConfig(learner_class=<class 'source.intrinsic_attention_ppo.learners.IntrinsicAttentionPPOLearner.IntrinsicAttentionPPOLearner'>, learner_connector=None, add_default_connectors_to_learner_pipeline=True, is_multi_agent=False, policies_to_update=['default_policy'], lr=0.0060984166342, num_total_minibatches=0, num_epochs=1, minibatch_size=1000, shuffle_batch_per_epoch=True)"], "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9485408017724, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.callbacks.callbacks.RLlibCallback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 21.47180438041687, "iterations_since_restore": 2, "perf": {"cpu_util_percent": 50.431250000000006, "ram_util_percent": 82.5625}}
{"timers": {"training_iteration": 10.202771115123944, "restore_env_runners": 1.1011797829996796e-05, "training_step": 10.202576419530551, "env_runner_sampling_timer": 1.8211425953191238, "learner_update_timer": 8.20224860667543, "synch_weights": 0.0015416765202651732, "restore_eval_env_runners": 8.040030137635767e-05, "evaluation_iteration": 0.21757989778649062, "synch_eval_env_connectors": 0.0002319388010073453, "synch_env_connectors": 5.052422638982535e-06}, "env_runners": {"num_env_steps_sampled": 5000.0, "episode_return_max": 12.5, "env_to_module_connector": {"timers": {"connectors": {"add_time_dim_to_batch_and_zero_pad": 8.118012363568925e-06, "add_observations_from_episodes_to_batch": 3.4838277034311247e-06, "batch_individual_items": 1.434656258358233e-05, "numpy_to_tensor": 1.5343078689945356e-05, "add_states_from_episodes_to_batch": 3.0445774849685382e-06}}, "connector_pipeline_timer": 6.958118780112506e-05}, "episode_len_min": 20, "module_to_env_connector": {"timers": {"connectors": {"un_batch_to_individual_items": 7.428529361520839e-06, "normalize_and_clip_actions": 9.479820199945553e-06, "remove_single_ts_time_rank_from_batch": 1.3326794290872682e-05, "get_actions": 4.953893614891697e-05, "tensor_to_numpy": 1.763400518951276e-05, "listify_data_for_vector_env": 1.2204417472530055e-05}}, "connector_pipeline_timer": 0.00014265677480956792}, "env_step_timer": 1.667145479000966e-05, "num_agent_steps_sampled_lifetime": {"default_agent": -607500.0}, "num_episodes": 250.0, "episode_duration_sec_mean": 0.006263364886865023, "episode_len_mean": 20.0, "module_episode_returns_mean": {"default_policy": 3.5400000000000005}, "weights_seq_no": 2.0, "env_to_module_sum_episodes_length_out": 10.36823839457432, "num_env_steps_sampled_lifetime": -607500.0, "episode_len_max": 20, "rlmodule_inference_timer": 3.716331008059706e-05, "num_agent_steps_sampled": {"default_agent": 5000.0}, "env_reset_timer": 5.446151266503639e-05, "agent_episode_returns_mean": {"default_agent": 3.5400000000000005}, "env_to_module_sum_episodes_length_in": 10.36823839457432, "episode_return_mean": 3.5400000000000005, "time_between_sampling": 0.0369374142085338, "num_module_steps_sampled_lifetime": {"default_policy": -607500.0}, "num_module_steps_sampled": {"default_policy": 5000.0}, "num_episodes_lifetime": -30375.0, "episode_return_min": -7.5, "sample": 0.006930522169019143, "num_env_steps_sampled_lifetime_throughput": 2867.5780876583226}, "__all_modules__": {"learner_connector_sum_episodes_length_in": 5000.0, "learner_connector": {"connector_pipeline_timer": 0.13899053407388273, "timers": {"connectors": {"add_one_ts_to_episodes_and_truncate": 0.009489889002160634, "add_observations_from_episodes_to_batch": 0.0010449535920750348, "add_columns_from_episodes_to_train_batch": 0.04407606642417377, "add_time_dim_to_batch_and_zero_pad": 0.07617446736409329, "add_states_from_episodes_to_batch": 0.003574682354333345, "batch_individual_items": 0.004365995796700007, "numpy_to_tensor": 7.22842168645002e-05}}}, "learner_connector_sum_episodes_length_out": 5250.0}, "learners": {"__all_modules__": {"num_module_steps_trained_lifetime": 35910, "num_env_steps_trained": 33000, "num_env_steps_trained_lifetime": 99000, "num_non_trainable_parameters": 0, "num_trainable_parameters": 24861, "num_module_steps_trained": 11970, "num_env_steps_trained_lifetime_throughput": 3977.8120627730573, "num_module_steps_trained_throughput": 30638529.15436117, "num_module_steps_trained_lifetime_throughput": 13002562.091649791}, "default_policy": {"curr_entropy_coeff": 0.0015431216992, "weights_seq_no": 3.0, "curr_kl_coeff": 0.020197991281747818, "policy_loss": -1.7980630218517035e-05, "module_train_batch_size_mean": 997.9168410861561, "num_trainable_parameters": 16595, "vf_loss": 0.3583121597766876, "mean_kl_loss": 8.231501851696521e-06, "diff_num_grad_updates_vs_sampler_policy": 1.0, "vf_explained_var": 0.0008582472801208496, "use_intrinsic_rewards": 0.0, "entropy": 0.687347948551178, "num_module_steps_trained": 5985, "vf_loss_unclipped": 44.87291717529297, "total_loss": 0.27806514501571655, "num_module_steps_trained_lifetime": 17955, "num_module_steps_trained_lifetime_throughput": 721.129386987484}, "differentiable_learners": {"intrinsic_attention_ppo_learner": {"__all_modules__": {"num_module_steps_trained_lifetime": 215460, "num_env_steps_trained_lifetime": 594000, "num_module_steps_trained": 71820, "num_env_steps_trained": 198000, "num_env_steps_trained_lifetime_throughput": 52889.384427489946}, "default_policy": {"weights_seq_no": 18.0, "policy_loss": -1.747238820826169e-05, "module_train_batch_size_mean": 997.6672132667843, "vf_loss": 0.35831350088119507, "mean_kl_loss": 8.242264811997302e-06, "diff_num_grad_updates_vs_sampler_policy": 16.0, "vf_explained_var": 0.0028873682022094727, "use_intrinsic_rewards": 1.0, "entropy": 0.6873472929000854, "num_module_steps_trained": 35910, "vf_loss_unclipped": 44.81333923339844, "total_loss": 0.2780677080154419, "num_module_steps_trained_lifetime": 107730}, "intrinsic_reward_module": {"total_loss": 0.0, "num_module_steps_trained_lifetime": 107730, "module_train_batch_size_mean": 997.6672132667843, "weights_seq_no": 18.0, "num_module_steps_trained": 35910, "diff_num_grad_updates_vs_sampler_policy": 16.0}}}, "intrinsic_reward_module": {"diff_num_grad_updates_vs_sampler_policy": 1.0, "gradients_default_optimizer_global_norm": 0.0, "curr_entropy_coeff": 0.0015431216992, "weights_seq_no": 3.0, "default_optimizer_learning_rate": 0.0002715581955, "total_loss": 0.0, "num_module_steps_trained_lifetime": 17955, "module_train_batch_size_mean": 997.9168410861561, "num_trainable_parameters": 8266, "num_module_steps_trained": 5985, "num_module_steps_trained_lifetime_throughput": 721.1419604410038}, "IntrinsicAttentionMask": [[[0.08846751600503922, 0.09160445630550385, 0.09152905642986298, 0.09145371615886688, 0.09025400876998901, 0.09214747697114944, 0.09093867242336273, 0.09003131836652756, 0.09192011505365372, 0.09184445440769196, 0.08980917930603027], [0.08634935319423676, 0.09221385419368744, 0.09207077324390411, 0.0919279009103775, 0.08966701477766037, 0.09324738383293152, 0.09095404297113419, 0.08925025910139084, 0.09281399101018906, 0.09266996383666992, 0.08883544057607651], [0.08639892935752869, 0.09219952672719955, 0.09205804765224457, 0.09191678464412689, 0.08968096226453781, 0.09322135895490646, 0.09095378965139389, 0.0892687514424324, 0.09279288351535797, 0.09265049546957016, 0.08885844051837921], [0.0864485427737236, 0.09218519926071167, 0.09204532951116562, 0.09190566837787628, 0.08969490230083466, 0.093195341527462, 0.09095355123281479, 0.08928725123405457, 0.09277178347110748, 0.0926310196518898, 0.08888145536184311], [0.0872470960021019, 0.09195487201213837, 0.0918407291173935, 0.09172674268484116, 0.08991796523332596, 0.09277823567390442, 0.09094873070716858, 0.08958356082439423, 0.09243319183588028, 0.09231846034526825, 0.08925040066242218], [0.0859941840171814, 0.09231660515069962, 0.09216196089982986, 0.09200756996870041, 0.08956684917211533, 0.09343422204256058, 0.09095565229654312, 0.08911746740341187, 0.09296543896198273, 0.09280970692634583, 0.08867035061120987], [0.08678934723138809, 0.0920867994427681, 0.0919579491019249, 0.09182927757501602, 0.08979041129350662, 0.09301690012216568, 0.09095166623592377, 0.08941403776407242, 0.09262699633836746, 0.09249739348888397, 0.08903923630714417], [0.08739716559648514, 0.0919116884469986, 0.09180235117673874, 0.09169314801692963, 0.08995960652828217, 0.09270025044679642, 0.09094767272472382, 0.08963895589113235, 0.09236982464790344, 0.09225994348526001, 0.08931943774223328], [0.08614249527454376, 0.09227368235588074, 0.09212386608123779, 0.09197430312633514, 0.08960873633623123, 0.09335611760616302, 0.09095501154661179, 0.08917298913002014, 0.09290213882923126, 0.09275130927562714, 0.08873935043811798], [0.08619197458028793, 0.09225936233997345, 0.09211116284132004, 0.09196320176124573, 0.08962269127368927, 0.09333008527755737, 0.09095478802919388, 0.0891914814710617, 0.09288103878498077, 0.09273184090852737, 0.08876235783100128], [0.0875474289059639, 0.09186846017837524, 0.0917639285326004, 0.09165950864553452, 0.09000121057033539, 0.09262227267026901, 0.09094655513763428, 0.0896943211555481, 0.09230644255876541, 0.09220140427350998, 0.08938848227262497]], [[0.0924285352230072, 0.09234602749347687, 0.09194623678922653, 0.0921812430024147, 0.09087055921554565, 0.0917002260684967, 0.09193460643291473, 0.09277398884296417, 0.08235479146242142, 0.09091834723949432, 0.0905454009771347], [0.09239981323480606, 0.09231892228126526, 0.0919269472360611, 0.09215735644102097, 0.0908721387386322, 0.09168572723865509, 0.0919155403971672, 0.09273847937583923, 0.08251278847455978, 0.09091899544000626, 0.09055323898792267], [0.09225994348526001, 0.09218689799308777, 0.09183283150196075, 0.09204097837209702, 0.09087934345006943, 0.09161487966775894, 0.0918225347995758, 0.09256570786237717, 0.08328434079885483, 0.09092172980308533, 0.09059086441993713], [0.092342309653759, 0.09226465225219727, 0.09188828617334366, 0.09210953116416931, 0.09087519347667694, 0.0916566550731659, 0.09187734127044678, 0.09266741573810577, 0.08282962441444397, 0.09092021733522415, 0.09056881815195084], [0.09187774360179901, 0.09182585030794144, 0.09157417714595795, 0.09172216057777405, 0.09089504182338715, 0.09141912311315536, 0.09156685322523117, 0.09209480881690979, 0.08540988713502884, 0.09092527627944946, 0.09068916738033295], [0.09217328578233719, 0.09210506826639175, 0.09177437424659729, 0.09196878969669342, 0.09088340401649475, 0.09157076478004456, 0.09176475554704666, 0.09245878458023071, 0.08376400172710419, 0.0909230187535286, 0.0906137228012085], [0.0922558531165123, 0.09218303114175797, 0.09183007478713989, 0.09203756600618362, 0.09087953716516495, 0.0916128009557724, 0.09181980788707733, 0.09256065636873245, 0.08330691605806351, 0.0909217819571495, 0.09059194475412369], [0.09254827350378036, 0.09245900064706802, 0.09202651679515839, 0.09228071570396423, 0.09086364507675171, 0.09176047146320343, 0.09201394021511078, 0.09292212128639221, 0.0816977322101593, 0.09091527760028839, 0.09051234275102615], [0.08851394802331924, 0.08863214403390884, 0.08920864760875702, 0.08886901289224625, 0.09079122543334961, 0.08956649899482727, 0.08922550082206726, 0.0880218967795372, 0.10517232865095139, 0.09071993082761765, 0.09127886593341827], [0.09189489483833313, 0.09184207022190094, 0.09158583730459213, 0.09173650294542313, 0.09089445322751999, 0.09142797440290451, 0.09157837182283401, 0.09211590886116028, 0.08531389385461807, 0.09092522412538528, 0.09068489074707031], [0.09176048636436462, 0.091715008020401, 0.09149438887834549, 0.09162412583827972, 0.09089868515729904, 0.09135843068361282, 0.09148796647787094, 0.09195069223642349, 0.08606700599193573, 0.09092521667480469, 0.09071800112724304]], [[0.08817014843225479, 0.09129654616117477, 0.0912213996052742, 0.09002473950386047, 0.09107129275798798, 0.09183774143457413, 0.09176214784383774, 0.09084658324718475, 0.09161113947629929, 0.09153573960065842, 0.0906224325299263], [0.0858042910695076, 0.09163177758455276, 0.09148959815502167, 0.08923948556184769, 0.0912058874964714, 0.09265878051519394, 0.0925150066614151, 0.09078197926282883, 0.09222812205553055, 0.09208500385284424, 0.09036003798246384], [0.08585955202579498, 0.0916239395737648, 0.09148334711790085, 0.08925805985927582, 0.09120280295610428, 0.09263939410448074, 0.09249724447727203, 0.09078361093997955, 0.09221359342336655, 0.09207209199666977, 0.09036633372306824], [0.08675005286931992, 0.09149771928787231, 0.09138257801532745, 0.08955583721399307, 0.09115272760391235, 0.09232841432094574, 0.09221222251653671, 0.09080903232097626, 0.09198028594255447, 0.09186453372240067, 0.09046663343906403], [0.0859701931476593, 0.09160826355218887, 0.09147084504365921, 0.08929522335529327, 0.09119663387537003, 0.09260062873363495, 0.0924617275595665, 0.09078685939311981, 0.09218453615903854, 0.09204626083374023, 0.09037891030311584], [0.0854085311293602, 0.0916878953576088, 0.09153430163860321, 0.08910612761974335, 0.09122788161039352, 0.0927978977560997, 0.09264244139194489, 0.0907701775431633, 0.09233231097459793, 0.09217763692140579, 0.09031476080417633], [0.08546358346939087, 0.09168009459972382, 0.09152809530496597, 0.08912471681833267, 0.09122484177350998, 0.0927785262465477, 0.09262470155954361, 0.09077184647321701, 0.09231781214475632, 0.09216474741697311, 0.09032109379768372], [0.0861363634467125, 0.0915847048163414, 0.09145204722881317, 0.08935093134641647, 0.09118732064962387, 0.09254245460033417, 0.09240841865539551, 0.09079166501760483, 0.09214092046022415, 0.09200745820999146, 0.09039773046970367], [0.08557377010583878, 0.09166447073221207, 0.09151564538478851, 0.08916188031435013, 0.0912187248468399, 0.0927397608757019, 0.09258919209241867, 0.09077514708042145, 0.0922887846827507, 0.09213894605636597, 0.0903337225317955], [0.08562889695167542, 0.0916566476225853, 0.09150941669940948, 0.08918045461177826, 0.09121565520763397, 0.09272037446498871, 0.0925714299082756, 0.09077679365873337, 0.0922742635011673, 0.0921260342001915, 0.0903400257229805], [0.08630280941724777, 0.09156110137701035, 0.09143321216106415, 0.08940663933753967, 0.09117797017097473, 0.09248427301645279, 0.09235509485006332, 0.09079644083976746, 0.09209728240966797, 0.09196864068508148, 0.09041650593280792]], [[0.09096748381853104, 0.0917803943157196, 0.09237438440322876, 0.09166412055492401, 0.09073713421821594, 0.09219890087842941, 0.0906221866607666, 0.09208209067583084, 0.08542648702859879, 0.09164022654294968, 0.09050656855106354], [0.09097982943058014, 0.09210509806871414, 0.09292973577976227, 0.09194391220808029, 0.0906616598367691, 0.09268589317798615, 0.09050299972295761, 0.09252368658781052, 0.08341289311647415, 0.09191079437732697, 0.09034349769353867], [0.09098541736602783, 0.09233784675598145, 0.09333106130361557, 0.09214391559362411, 0.09060362726449966, 0.0930371880531311, 0.09041333943605423, 0.09284178167581558, 0.08197955042123795, 0.09210408478975296, 0.09022211283445358], [0.09097839891910553, 0.09205909818410873, 0.09285073727369308, 0.09190432727336884, 0.09067274630069733, 0.09261667728424072, 0.09052029997110367, 0.09246096760034561, 0.08369719237089157, 0.09187252819538116, 0.09036704897880554], [0.0909629836678505, 0.09168707579374313, 0.09221572428941727, 0.09158354252576828, 0.09075766801834106, 0.09205958247184753, 0.09065519273281097, 0.09195563197135925, 0.08600824326276779, 0.09156227111816406, 0.09055210649967194], [0.09098406136035919, 0.09226948767900467, 0.09321288764476776, 0.09208521991968155, 0.09062103182077408, 0.09293380379676819, 0.0904400572180748, 0.09274820983409882, 0.08239975571632385, 0.09204736351966858, 0.0902581736445427], [0.0909605622291565, 0.09164027869701385, 0.09213632345199585, 0.09154311567544937, 0.0907677710056305, 0.09198982268571854, 0.09067153930664062, 0.0918922945857048, 0.08630044758319855, 0.09152314811944962, 0.0905747190117836], [0.09098301827907562, 0.09222378581762314, 0.09313403815031052, 0.09204596281051636, 0.09063248336315155, 0.09286479651927948, 0.0904577225446701, 0.09268572926521301, 0.08268094807863235, 0.09200942516326904, 0.09028207510709763], [0.0907195508480072, 0.08936065435409546, 0.08838807791471481, 0.08955304324626923, 0.09111057966947556, 0.0886736586689949, 0.09130673110485077, 0.08886456489562988, 0.10092579573392868, 0.08959265798330307, 0.09150468558073044], [0.09097809344530106, 0.09204962104558945, 0.0928344801068306, 0.0918961688876152, 0.0906750038266182, 0.0926024317741394, 0.0905238464474678, 0.09244805574417114, 0.08375576138496399, 0.09186463803052902, 0.09037186950445175], [0.09095800668001175, 0.09159306436777115, 0.09205631911754608, 0.09150230139493942, 0.09077782928943634, 0.09191952645778656, 0.09068787842988968, 0.09182843565940857, 0.08659559488296509, 0.09148364514112473, 0.09059737622737885]], [[0.08876846730709076, 0.09078504145145416, 0.09071031957864761, 0.09176483750343323, 0.09168929606676102, 0.09246095269918442, 0.0912480279803276, 0.0903375968337059, 0.0910978764295578, 0.09102289378643036, 0.09011469781398773], [0.08756468445062637, 0.09071002900600433, 0.09059275686740875, 0.09225276857614517, 0.09213349223136902, 0.09335458278656006, 0.09143785387277603, 0.09000864624977112, 0.09120157361030579, 0.09108366817235947, 0.08965999633073807], [0.08760857582092285, 0.09071283042430878, 0.09059711545705795, 0.09223488718271255, 0.09211722761392593, 0.09332172572612762, 0.09143093973398209, 0.09002073854207993, 0.09119782596826553, 0.09108148515224457, 0.08967667073011398], [0.08699415624141693, 0.09067310392856598, 0.09053553640842438, 0.09248573333024979, 0.09234540909528732, 0.09378354251384735, 0.09152760356664658, 0.08985079079866409, 0.09125006943941116, 0.09111162275075912, 0.0894424244761467], [0.0870378166437149, 0.0906759649515152, 0.09053994715213776, 0.09246787428855896, 0.09232916682958603, 0.09375059604644775, 0.09152074158191681, 0.08986291289329529, 0.09124637395143509, 0.091109499335289, 0.089459128677845], [0.08659432083368301, 0.09064670652151108, 0.09049485623836517, 0.0926496759057045, 0.09249446541070938, 0.09408628195524216, 0.09159041196107864, 0.08973940461874008, 0.09128380566835403, 0.09113088995218277, 0.08928916603326797], [0.08729394525289536, 0.09069261699914932, 0.09056571871042252, 0.09236317873001099, 0.09223394095897675, 0.0935577005147934, 0.09148045629262924, 0.08993388712406158, 0.09122464060783386, 0.09109699726104736, 0.08955691009759903], [0.08782830834388733, 0.09072677791118622, 0.09061885625123978, 0.09214548021554947, 0.09203586727380753, 0.09315755218267441, 0.09139632433652878, 0.09008115530014038, 0.0911790132522583, 0.09107054769992828, 0.08976006507873535], [0.0873815268278122, 0.09069826453924179, 0.0905744805932045, 0.09232743084430695, 0.09220142662525177, 0.09349190443754196, 0.09146668016910553, 0.08995810151100159, 0.09121718257665634, 0.09109269082546234, 0.08959028869867325], [0.0874253362417221, 0.09070108085870743, 0.09057886153459549, 0.09230955690145493, 0.09218516200780869, 0.09345901757478714, 0.09145978093147278, 0.08997020125389099, 0.09121344983577728, 0.09109053760766983, 0.08960697054862976], [0.08796036243438721, 0.09073510766029358, 0.090631864964962, 0.09209184348583221, 0.09198704361915588, 0.09305914491415024, 0.09137552976608276, 0.09011738002300262, 0.09116768836975098, 0.09106394648551941, 0.0898100957274437]], [[0.08957872539758682, 0.08947833627462387, 0.0920441597700119, 0.08927789330482483, 0.0906941145658493, 0.09020137786865234, 0.08897807449102402, 0.08999931067228317, 0.10298749804496765, 0.09075400233268738, 0.08600646257400513], [0.08960035443305969, 0.08950148522853851, 0.09202796220779419, 0.08930406719446182, 0.09069875627756119, 0.09021354466676712, 0.08900876343250275, 0.09001456201076508, 0.10279170423746109, 0.09075772762298584, 0.08608106523752213], [0.08904366940259933, 0.08890676498413086, 0.09242372214794159, 0.08863358199596405, 0.09056860953569412, 0.08989407867193222, 0.08822537958621979, 0.08961786329746246, 0.10782813280820847, 0.09065068513154984, 0.0842074602842331], [0.08964349329471588, 0.08954765647649765, 0.09199544787406921, 0.08935630321502686, 0.09070790559053421, 0.09023775905370712, 0.08907003700733185, 0.09004493057727814, 0.10240107774734497, 0.09076503664255142, 0.0862303301692009], [0.08933759480714798, 0.08922050148248672, 0.09222019463777542, 0.08898677676916122, 0.09064007550477982, 0.09006434679031372, 0.0886373221874237, 0.08982840925455093, 0.105169877409935, 0.09071008116006851, 0.08518478274345398], [0.08944430947303772, 0.08933456242084503, 0.09214331954717636, 0.08911546319723129, 0.09066451340913773, 0.09012529253959656, 0.08878781646490097, 0.08990425616502762, 0.1042042151093483, 0.09073006361722946, 0.08554616570472717], [0.08970792591571808, 0.08961666375398636, 0.09194637089967728, 0.08943440765142441, 0.09072131663560867, 0.09027377516031265, 0.08916172385215759, 0.09009019285440445, 0.10181757062673569, 0.09077569097280502, 0.08645442873239517], [0.08948798477649689, 0.08938127011060715, 0.09211138635873795, 0.08916819840669632, 0.09067428112030029, 0.09015010297298431, 0.08884955197572708, 0.08993519842624664, 0.1038089320063591, 0.09073799848556519, 0.08569508790969849], [0.0865892618894577, 0.08630695194005966, 0.09371407330036163, 0.08574508130550385, 0.08976680040359497, 0.08835379779338837, 0.08490913361310959, 0.08777859807014465, 0.1299852877855301, 0.08993953466415405, 0.07691152393817902], [0.08932460844516754, 0.08920662850141525, 0.0922294482588768, 0.08897113800048828, 0.09063705056905746, 0.0900568962097168, 0.08861904591321945, 0.08981915563344955, 0.10528741776943207, 0.09070759266614914, 0.08514104783535004], [0.09033991396427155, 0.09029515087604523, 0.09143076837062836, 0.09020566940307617, 0.09083547443151474, 0.09061697870492935, 0.09007162600755692, 0.09052718430757523, 0.09608608484268188, 0.09086199104785919, 0.08872919529676437]]]}, "num_training_step_calls_per_iteration": 1, "evaluation": {"env_runners": {"episode_len_max": 20, "rlmodule_inference_timer": 3.738043690630274e-05, "num_module_steps_sampled": {"default_policy": 400}, "sample": 0.17401263367914363, "env_to_module_connector": {"timers": {"connectors": {"add_states_from_episodes_to_batch": 3.00924328108117e-06, "add_time_dim_to_batch_and_zero_pad": 7.434064124427985e-06, "add_observations_from_episodes_to_batch": 3.146423653876878e-06, "numpy_to_tensor": 1.4964415343757855e-05, "batch_individual_items": 1.3254448989980844e-05}}, "connector_pipeline_timer": 6.62337449499725e-05}, "module_episode_returns_mean": {"default_policy": 1.15}, "module_to_env_connector": {"timers": {"connectors": {"normalize_and_clip_actions": 8.81240422930374e-06, "remove_single_ts_time_rank_from_batch": 1.3305285707155424e-05, "tensor_to_numpy": 1.6812196912525027e-05, "listify_data_for_vector_env": 1.1752984236824209e-05, "un_batch_to_individual_items": 7.3202651015417855e-06, "get_actions": 4.474197440568955e-05}}, "connector_pipeline_timer": 0.00013180376253388662}, "episode_duration_sec_mean": 0.00691547635748672, "weights_seq_no": 3.0, "env_to_module_sum_episodes_length_out": 10.368205581254823, "agent_episode_returns_mean": {"default_agent": 1.15}, "episode_return_mean": 1.15, "env_to_module_sum_episodes_length_in": 10.368205581254823, "num_episodes_lifetime": 60, "num_agent_steps_sampled_lifetime": {"default_agent": 1200}, "num_episodes": 20, "episode_len_mean": 20.0, "num_agent_steps_sampled": {"default_agent": 400}, "num_module_steps_sampled_lifetime": {"default_policy": 1200}, "env_reset_timer": 0.0024214730017585676, "episode_return_min": -16.5, "num_env_steps_sampled": 400, "episode_len_min": 20, "episode_return_max": 12.5, "env_step_timer": 1.659685848070069e-05, "num_env_steps_sampled_lifetime": 15400, "time_between_sampling": 10.962866624832387}, "num_healthy_workers": 1, "actor_manager_num_outstanding_async_reqs": 0, "num_remote_worker_restarts": 0}, "num_env_steps_sampled_lifetime": -607500.0, "fault_tolerance": {"num_healthy_workers": 0, "num_remote_worker_restarts": 0}, "env_runner_group": {"actor_manager_num_outstanding_async_reqs": 0}, "done": false, "training_iteration": 3, "trial_id": "b154b_00000", "date": "2025-08-11_18-11-57", "timestamp": 1754928717, "time_this_iter_s": 10.519577264785767, "time_total_s": 31.991381645202637, "pid": 10455, "hostname": "Mac", "node_ip": "127.0.0.1", "config": {"exploration_config": {}, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 2, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "env": "Umbrella", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": false, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 0, "create_local_env_runner": true, "num_envs_per_env_runner": 1, "gym_env_vectorize_mode": "SYNC", "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "episodes_to_numpy": true, "max_requests_in_flight_per_env_runner": 1, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "merge_env_runner_states": "training_only", "broadcast_env_runner_states": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "complete_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "sampler_perf_stats_ema_coef": null, "_is_online": true, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": "auto", "num_aggregator_actors_per_learner": 0, "max_requests_in_flight_per_aggregator_actor": 3, "local_gpu_idx": 0, "max_requests_in_flight_per_learner": 3, "gamma": 1, "lr": 0.0002715581955, "grad_clip": 0.5, "grad_clip_by": "global_norm", "_train_batch_size_per_learner": 5000, "train_batch_size": 4000, "num_epochs": 1, "minibatch_size": 1000, "shuffle_batch_per_epoch": true, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "log_std_clip_param": 20.0, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "_disable_preprocessor_api": false, "_disable_action_flattening": false}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {"intrinsic_reward_coeff": 0.2795015916508}, "optimizer": {}, "_learner_class": "<class 'source.intrinsic_attention_ppo.learners.IntrinsicAttentionMetaLearner.IntrinsicAttentionMetaLearner'>", "callbacks_on_algorithm_init": null, "callbacks_on_env_runners_recreated": null, "callbacks_on_offline_eval_runners_recreated": null, "callbacks_on_checkpoint_loaded": null, "callbacks_on_environment_created": null, "callbacks_on_episode_created": null, "callbacks_on_episode_start": null, "callbacks_on_episode_step": null, "callbacks_on_episode_end": null, "callbacks_on_evaluate_start": null, "callbacks_on_evaluate_end": null, "callbacks_on_evaluate_offline_start": null, "callbacks_on_evaluate_offline_end": null, "callbacks_on_sample_end": null, "callbacks_on_train_result": null, "explore": true, "enable_rl_module_and_learner": true, "enable_env_runner_and_connector_v2": true, "_prior_exploration_config": {"type": "StochasticSampling"}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x1514e58a0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "offline_data_class": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_read_batch_size": null, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "materialize_data": false, "materialize_mapped_data": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "ignore_final_observation": false, "prelearner_class": null, "prelearner_buffer_class": null, "prelearner_buffer_kwargs": {}, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_remaining_data": false, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": 1, "evaluation_duration": 20, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_auto_duration_min_env_steps_per_sample": 100, "evaluation_auto_duration_max_env_steps_per_sample": 2000, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 1, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "offline_evaluation_interval": null, "num_offline_eval_runners": 0, "offline_loss_for_module_fn": null, "offline_evaluation_duration": 1, "offline_evaluation_parallel_to_training": false, "offline_evaluation_timeout_s": 120.0, "num_cpus_per_offline_eval_runner": 1, "num_gpus_per_offline_eval_runner": 0, "custom_resources_per_offline_eval_runner": {}, "restart_failed_offline_eval_runners": true, "ignore_offline_eval_runner_failures": false, "max_num_offline_eval_runner_restarts": 1000, "offline_eval_runner_restore_timeout_s": 1800.0, "max_requests_in_flight_per_offline_eval_runner": 1, "validate_offline_eval_runners_after_construction": true, "offline_eval_runner_health_probe_timeout_s": 30.0, "offline_eval_rl_module_inference_only": false, "broadcast_offline_eval_runner_states": false, "offline_eval_batch_size_per_runner": 256, "dataset_num_iters_per_eval_runner": 1, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "log_gradients": false, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 4, "restart_failed_env_runners": true, "ignore_env_runner_failures": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30.0, "env_runner_restore_timeout_s": 1800.0, "_model_config": {}, "_rl_module_spec": "MultiRLModuleSpec(multi_rl_module_class=<class 'ray.rllib.core.rl_module.multi_rl_module.MultiRLModule'>, observation_space=None, action_space=None, inference_only=False, model_config=None, rl_module_specs={'default_policy': RLModuleSpec(module_class=<class 'source.intrinsic_attention_ppo.rl_modules.DifferentiablePPOModule.DifferentiablePPOModule'>, observation_space=None, action_space=None, inference_only=False, learner_only=False, model_config={'vf_share_layers': True, 'embedding_dim': 62, 'max_seq_len': 11, 'policy_head_hidden_sizes': [32], 'value_head_hidden_sizes': [101], 'embedding_hidden_sizes': [121]}, catalog_class=None, load_state_path=None, model_config_dict=None), 'intrinsic_reward_module': RLModuleSpec(module_class=<class 'source.intrinsic_attention_ppo.rl_modules.IntrinsicAttentionModule.IntrinsicAttentionModule'>, observation_space=None, action_space=None, inference_only=False, learner_only=True, model_config={'intrinsic_reward_network': {'encoder_hidden_sizes': [], 'encoding_dim': 1, 'num_heads': 1, 'head_hidden_sizes': None, 'layers': [{'type': 'attention'}]}, 'extrinsic_value_hidden_layers': [127, 60], 'vf_share_layers': True, 'max_seq_len': 11}, catalog_class=None, load_state_path=None, model_config_dict=None)}, load_state_path=None, modules_to_load=None, module_specs={'default_policy': RLModuleSpec(module_class=<class 'source.intrinsic_attention_ppo.rl_modules.DifferentiablePPOModule.DifferentiablePPOModule'>, observation_space=None, action_space=None, inference_only=False, learner_only=False, model_config={'vf_share_layers': True, 'embedding_dim': 62, 'max_seq_len': 11, 'policy_head_hidden_sizes': [32], 'value_head_hidden_sizes': [101], 'embedding_hidden_sizes': [121]}, catalog_class=None, load_state_path=None, model_config_dict=None), 'intrinsic_reward_module': RLModuleSpec(module_class=<class 'source.intrinsic_attention_ppo.rl_modules.IntrinsicAttentionModule.IntrinsicAttentionModule'>, observation_space=None, action_space=None, inference_only=False, learner_only=True, model_config={'intrinsic_reward_network': {'encoder_hidden_sizes': [], 'encoding_dim': 1, 'num_heads': 1, 'head_hidden_sizes': None, 'layers': [{'type': 'attention'}]}, 'extrinsic_value_hidden_layers': [127, 60], 'vf_share_layers': True, 'max_seq_len': 11}, catalog_class=None, load_state_path=None, model_config_dict=None)})", "algorithm_config_overrides_per_module": {"intrinsic_reward_module": {"lr": 0.0002715581955}}, "_per_module_overrides": {}, "_validate_config": true, "_use_msgpack_checkpoints": false, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "env_task_fn": -1, "enable_connectors": -1, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.161583927863, "kl_target": 0.0201019014258, "vf_loss_coeff": 0.7790510010087, "entropy_coeff": 0.0015431216992, "clip_param": 0.2459212356676, "vf_clip_param": 0.3769744131561, "entropy_coeff_schedule": null, "lr_schedule": null, "sgd_minibatch_size": -1, "vf_share_layers": -1, "differentiable_learner_configs": ["DifferentiableLearnerConfig(learner_class=<class 'source.intrinsic_attention_ppo.learners.IntrinsicAttentionPPOLearner.IntrinsicAttentionPPOLearner'>, learner_connector=None, add_default_connectors_to_learner_pipeline=True, is_multi_agent=False, policies_to_update=['default_policy'], lr=0.0060984166342, num_total_minibatches=0, num_epochs=1, minibatch_size=1000, shuffle_batch_per_epoch=True)"], "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9485408017724, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.callbacks.callbacks.RLlibCallback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 31.991381645202637, "iterations_since_restore": 3, "perf": {"cpu_util_percent": 43.29999999999999, "ram_util_percent": 81.83333333333334}}
{"timers": {"training_iteration": 10.207227988552882, "restore_env_runners": 1.0971679220558145e-05, "training_step": 10.207032236166123, "env_runner_sampling_timer": 1.8229072877056238, "learner_update_timer": 8.204832685189139, "synch_weights": 0.001541729335019947, "restore_eval_env_runners": 8.017879872350021e-05, "evaluation_iteration": 0.21671209089863114, "synch_eval_env_connectors": 0.00023120857294416054, "synch_env_connectors": 5.0977280130609874e-06}, "env_runners": {"num_env_steps_sampled": 5000.0, "episode_return_max": 12.5, "env_to_module_connector": {"timers": {"connectors": {"add_time_dim_to_batch_and_zero_pad": 8.841155961127216e-06, "add_observations_from_episodes_to_batch": 3.531701148676009e-06, "batch_individual_items": 1.5451256076687658e-05, "numpy_to_tensor": 1.670152231419972e-05, "add_states_from_episodes_to_batch": 3.2508937084231973e-06}}, "connector_pipeline_timer": 7.450300639983284e-05}, "episode_len_min": 20, "module_to_env_connector": {"timers": {"connectors": {"un_batch_to_individual_items": 8.000157485091828e-06, "normalize_and_clip_actions": 1.0067514891877633e-05, "remove_single_ts_time_rank_from_batch": 1.4372086789237476e-05, "get_actions": 5.4251245034990616e-05, "tensor_to_numpy": 1.9286865847181735e-05, "listify_data_for_vector_env": 1.3090849462489111e-05}}, "connector_pipeline_timer": 0.000151705336761703}, "env_step_timer": 1.8660567559397257e-05, "num_agent_steps_sampled_lifetime": {"default_agent": -1225000.0}, "num_episodes": 250.0, "episode_duration_sec_mean": 0.006797820500098167, "episode_len_mean": 20.0, "module_episode_returns_mean": {"default_policy": 3.8600000000000008}, "weights_seq_no": 3.0, "env_to_module_sum_episodes_length_out": 10.36823839457432, "num_env_steps_sampled_lifetime": -1225000.0, "episode_len_max": 20, "rlmodule_inference_timer": 4.2216567180714006e-05, "num_agent_steps_sampled": {"default_agent": 5000.0}, "env_reset_timer": 6.656010794997886e-05, "agent_episode_returns_mean": {"default_agent": 3.8600000000000008}, "env_to_module_sum_episodes_length_in": 10.36823839457432, "episode_return_mean": 3.8600000000000008, "time_between_sampling": 0.035625459649251894, "num_module_steps_sampled_lifetime": {"default_policy": -1225000.0}, "num_module_steps_sampled": {"default_policy": 5000.0}, "num_episodes_lifetime": -61250.0, "episode_return_min": -7.5, "sample": 0.007210019918768863, "num_env_steps_sampled_lifetime_throughput": 2615.8448211125037}, "__all_modules__": {"learner_connector_sum_episodes_length_in": 5000.0, "learner_connector": {"connector_pipeline_timer": 0.13895786873365076, "timers": {"connectors": {"add_one_ts_to_episodes_and_truncate": 0.009491282611359026, "add_observations_from_episodes_to_batch": 0.0010431132253170942, "add_columns_from_episodes_to_train_batch": 0.04406050076006644, "add_time_dim_to_batch_and_zero_pad": 0.07616033311067383, "add_states_from_episodes_to_batch": 0.0035759172000446125, "batch_individual_items": 0.004362839998138835, "numpy_to_tensor": 7.238096417288762e-05}}}, "learner_connector_sum_episodes_length_out": 5250.0}, "learners": {"__all_modules__": {"num_module_steps_trained_lifetime": 47880, "num_env_steps_trained": 33000, "num_env_steps_trained_lifetime": 132000, "num_non_trainable_parameters": 0, "num_trainable_parameters": 24861, "num_module_steps_trained": 11970, "num_env_steps_trained_lifetime_throughput": 3967.334948089077, "num_module_steps_trained_throughput": 29840861.64752439, "num_module_steps_trained_lifetime_throughput": 12958481.43007378}, "default_policy": {"curr_entropy_coeff": 0.0015431216992, "weights_seq_no": 4.0, "curr_kl_coeff": 0.010098995640873909, "policy_loss": -0.000448434439022094, "module_train_batch_size_mean": 997.8923005732703, "num_trainable_parameters": 16595, "vf_loss": 0.3583116829395294, "mean_kl_loss": 2.1990470486343838e-05, "diff_num_grad_updates_vs_sampler_policy": 1.0, "vf_explained_var": 0.002807438373565674, "use_intrinsic_rewards": 0.0, "entropy": 0.686603307723999, "num_module_steps_trained": 5985, "vf_loss_unclipped": 44.77106475830078, "total_loss": 0.2776356041431427, "num_module_steps_trained_lifetime": 23940, "num_module_steps_trained_lifetime_throughput": 719.2363560824855}, "differentiable_learners": {"intrinsic_attention_ppo_learner": {"__all_modules__": {"num_module_steps_trained_lifetime": 287280, "num_env_steps_trained_lifetime": 792000, "num_module_steps_trained": 71820, "num_env_steps_trained": 198000, "num_env_steps_trained_lifetime_throughput": 52257.12720410895}, "default_policy": {"weights_seq_no": 24.0, "policy_loss": -0.0004224440490361303, "module_train_batch_size_mean": 997.6156867483631, "vf_loss": 0.3583132326602936, "mean_kl_loss": 1.9566308765206486e-05, "diff_num_grad_updates_vs_sampler_policy": 21.0, "vf_explained_var": 0.002926349639892578, "use_intrinsic_rewards": 1.0, "entropy": 0.686646044254303, "num_module_steps_trained": 35910, "vf_loss_unclipped": 44.85197448730469, "total_loss": 0.2776654064655304, "num_module_steps_trained_lifetime": 143640}, "intrinsic_reward_module": {"total_loss": 0.0, "num_module_steps_trained_lifetime": 143640, "module_train_batch_size_mean": 997.6156867483631, "weights_seq_no": 24.0, "num_module_steps_trained": 35910, "diff_num_grad_updates_vs_sampler_policy": 21.0}}}, "intrinsic_reward_module": {"diff_num_grad_updates_vs_sampler_policy": 1.0, "gradients_default_optimizer_global_norm": 0.0, "curr_entropy_coeff": 0.0015431216992, "weights_seq_no": 4.0, "default_optimizer_learning_rate": 0.0002715581955, "total_loss": 0.0, "num_module_steps_trained_lifetime": 23940, "module_train_batch_size_mean": 997.8923005732703, "num_trainable_parameters": 8266, "num_module_steps_trained": 5985, "num_module_steps_trained_lifetime_throughput": 719.2484562541305}, "IntrinsicAttentionMask": [[[0.09167538583278656, 0.09157618880271912, 0.09147709608078003, 0.0913781151175499, 0.08980536460876465, 0.09080036729574203, 0.0907021164894104, 0.09098324179649353, 0.0905059278011322, 0.09040799736976624, 0.09068820625543594], [0.0916631668806076, 0.0915655642747879, 0.09146805852651596, 0.09137065708637238, 0.08982286602258682, 0.09080212563276291, 0.09070543944835663, 0.0909820944070816, 0.09051236510276794, 0.09041598439216614, 0.09069175273180008], [0.09165094047784805, 0.0915549248456955, 0.0914590060710907, 0.09136319160461426, 0.0898403599858284, 0.09080388396978378, 0.09070874750614166, 0.09098093956708908, 0.09051879495382309, 0.09042396396398544, 0.09069529175758362], [0.0916387140750885, 0.09154429286718369, 0.09144996106624603, 0.09135572612285614, 0.08985786139965057, 0.09080563485622406, 0.0907120630145073, 0.09097977727651596, 0.09052522480487823, 0.09043194353580475, 0.09069882333278656], [0.09144280850887299, 0.09137383848428726, 0.09130492061376572, 0.09123605489730835, 0.09013881534337997, 0.09083365648984909, 0.09076514840126038, 0.09096111357212067, 0.09062828868627548, 0.0905599296092987, 0.09075544774532318], [0.09156712144613266, 0.0914820060133934, 0.09139697253704071, 0.09131201356649399, 0.08996042609214783, 0.09081590175628662, 0.09073148667812347, 0.09097298234701157, 0.09056288748979568, 0.09047870337963104, 0.09071953594684601], [0.0915549024939537, 0.09147137403488159, 0.09138792753219604, 0.09130455553531647, 0.0899779424071312, 0.0908176451921463, 0.09073479473590851, 0.09097182005643845, 0.09056930989027023, 0.09048668295145035, 0.09072306752204895], [0.09158982336521149, 0.09150175750255585, 0.09141377359628677, 0.09132587909698486, 0.08992787450551987, 0.09081263840198517, 0.09072531759738922, 0.09097513556480408, 0.09055093675851822, 0.09046386927366257, 0.09071296453475952], [0.0915304645895958, 0.09145011752843857, 0.09136983752250671, 0.09128962457180023, 0.09001297503709793, 0.09082113951444626, 0.09074141085147858, 0.09096948802471161, 0.09058216214179993, 0.09050264209508896, 0.09073013067245483], [0.09151824563741684, 0.09143948554992676, 0.09136078506708145, 0.09128215909004211, 0.0900304988026619, 0.09082288295030594, 0.09074471890926361, 0.09096831828355789, 0.09058858454227448, 0.09051062166690826, 0.09073365479707718], [0.09155316650867462, 0.09146986901760101, 0.09138663858175278, 0.09130349010229111, 0.08998041599988937, 0.0908178836107254, 0.09073525667190552, 0.09097165614366531, 0.09057021886110306, 0.09048781543970108, 0.09072355926036835]], [[0.08971662819385529, 0.0896160900592804, 0.09064465016126633, 0.09093564748764038, 0.08931513130664825, 0.09034024178981781, 0.08911506086587906, 0.09013786911964417, 0.10314605385065079, 0.0908937156200409, 0.08613886684179306], [0.08973615616559982, 0.0896371379494667, 0.0906500443816185, 0.0909365713596344, 0.08934073150157928, 0.09035028517246246, 0.08914367109537125, 0.09015099704265594, 0.10294751077890396, 0.09089528769254684, 0.08621153980493546], [0.08953561633825302, 0.08942113071680069, 0.09059319645166397, 0.09092512726783752, 0.08907853811979294, 0.09024611115455627, 0.08885087817907333, 0.0900154709815979, 0.10498379170894623, 0.09087729454040527, 0.08547291904687881], [0.08947855979204178, 0.08935974538326263, 0.0905764102935791, 0.09092108905315399, 0.08900423347949982, 0.09021606296300888, 0.08876800537109375, 0.08997662365436554, 0.10556194931268692, 0.0908714160323143, 0.08526583760976791], [0.08979453891515732, 0.08970008790493011, 0.09066596627235413, 0.09093910455703735, 0.08941734582185745, 0.09038017690181732, 0.08922934532165527, 0.09019014984369278, 0.10235390067100525, 0.0908997505903244, 0.08642967790365219], [0.08959514647722244, 0.08948520570993423, 0.09061041474342346, 0.09092896431684494, 0.08915620297193527, 0.09027726948261261, 0.08893753588199615, 0.09005585312843323, 0.10437993705272675, 0.09088306128978729, 0.08569042384624481], [0.08983324468135834, 0.08974185585975647, 0.09067635983228683, 0.09094056487083435, 0.08946823328733444, 0.09039988368749619, 0.08928627520799637, 0.09021604061126709, 0.10195980966091156, 0.09090249985456467, 0.08657519519329071], [0.08963464200496674, 0.08952774107456207, 0.09062168002128601, 0.09093131124973297, 0.08920780569314957, 0.09029783308506012, 0.08899515122175217, 0.09008258581161499, 0.10397905856370926, 0.09088669717311859, 0.0858355313539505], [0.08697859197854996, 0.08669500797986984, 0.08962483704090118, 0.09046536684036255, 0.08584979921579361, 0.08875106275081635, 0.08529090881347656, 0.0881732925772667, 0.13056978583335876, 0.09034393727779388, 0.07725734263658524], [0.08948679268360138, 0.08936859667301178, 0.09057885408401489, 0.09092170000076294, 0.0890149474143982, 0.09022041410207748, 0.08877995610237122, 0.08998224139213562, 0.10547859221696854, 0.09087228775024414, 0.08529563993215561], [0.09040126949548721, 0.09035646170377731, 0.09081346541643143, 0.09094223380088806, 0.09022219479084015, 0.09067851305007935, 0.09013278782367706, 0.09058865904808044, 0.09615133702754974, 0.09092369675636292, 0.0887894406914711]], [[0.08836814761161804, 0.09150157123804092, 0.09142625331878662, 0.09135100245475769, 0.09127580374479294, 0.09204398095607758, 0.0908365324139595, 0.08993019908666611, 0.09181687980890274, 0.09174130111932755, 0.08970830589532852], [0.08616682887077332, 0.09201893210411072, 0.09187614917755127, 0.09173358976840973, 0.0915912464261055, 0.0930502787232399, 0.09076178818941116, 0.08906160295009613, 0.09261780232191086, 0.0924740880727768, 0.08864766359329224], [0.08621831983327866, 0.09200679510831833, 0.09186561405658722, 0.09172464162111282, 0.09158389270305634, 0.09302648901939392, 0.09076366573572159, 0.08908215165138245, 0.09259891510009766, 0.09245681762695312, 0.0886726975440979], [0.08626984804868698, 0.09199465066194534, 0.09185507148504257, 0.09171570092439651, 0.09157654643058777, 0.09300270676612854, 0.09076555073261261, 0.08910270035266876, 0.09258002042770386, 0.09243956208229065, 0.08869773894548416], [0.0863213837146759, 0.09198249131441116, 0.09184451401233673, 0.09170674532651901, 0.09156917780637741, 0.09297890961170197, 0.09076741337776184, 0.08912322670221329, 0.09256112575531006, 0.09242227673530579, 0.08872276544570923], [0.0857980027794838, 0.09210599213838577, 0.09195169806480408, 0.09179766476154327, 0.09164388477802277, 0.09322106093168259, 0.0907481461763382, 0.08891415596008301, 0.09275335818529129, 0.09259796887636185, 0.08846805989742279], [0.08662386238574982, 0.0919112041592598, 0.09178260713815689, 0.09165418148040771, 0.09152594208717346, 0.09283953905105591, 0.09077823907136917, 0.08924354612827301, 0.09245038032531738, 0.09232102334499359, 0.08886945992708206], [0.08725541830062866, 0.09176261723041534, 0.09165345877408981, 0.09154443442821503, 0.09143553674221039, 0.09254990518093109, 0.09080016613006592, 0.08949357271194458, 0.0922200158238411, 0.09211031347513199, 0.08917457610368729], [0.08595200628042221, 0.09206963330507278, 0.0919201523065567, 0.09177090972661972, 0.09162191301584244, 0.09314967691898346, 0.09075388312339783, 0.08897578716278076, 0.09269671142101288, 0.09254620969295502, 0.0885431244969368], [0.0860033854842186, 0.09205750375986099, 0.09190962463617325, 0.0917619839310646, 0.09161458164453506, 0.09312587976455688, 0.09075578302145004, 0.08899633586406708, 0.09267781674861908, 0.09252894669771194, 0.08856814354658127], [0.08741158992052078, 0.0917259156703949, 0.09162154048681259, 0.09151728451251984, 0.09141314774751663, 0.09247855842113495, 0.09080544114112854, 0.08955515176057816, 0.09216322749853134, 0.09205835312604904, 0.08924977481365204]], [[0.08971664309501648, 0.08961609750986099, 0.09064465761184692, 0.09093565493822098, 0.08931514620780945, 0.09034024924039841, 0.08911506086587906, 0.09013787657022476, 0.10314606875181198, 0.09089372307062149, 0.08613887429237366], [0.08973617106676102, 0.0896371454000473, 0.0906500443816185, 0.090936578810215, 0.08934073895215988, 0.09035029262304306, 0.08914367854595184, 0.09015099704265594, 0.10294752568006516, 0.09089528769254684, 0.08621153980493546], [0.08953560888767242, 0.08942112326622009, 0.09059318900108337, 0.09092512726783752, 0.08907853066921234, 0.09024611115455627, 0.08885087072849274, 0.0900154635310173, 0.10498379170894623, 0.09087728708982468, 0.08547291159629822], [0.08947857469320297, 0.08935975283384323, 0.0905764251947403, 0.09092110395431519, 0.08900424093008041, 0.09021607786417007, 0.08876802027225494, 0.08997663110494614, 0.10556197166442871, 0.0908714309334755, 0.0852658599615097], [0.08979453146457672, 0.08970008790493011, 0.09066596627235413, 0.09093910455703735, 0.08941733837127686, 0.09038017690181732, 0.08922933787107468, 0.09019014984369278, 0.10235390067100525, 0.0908997431397438, 0.08642967790365219], [0.08959513902664185, 0.08948519825935364, 0.09061040729284286, 0.09092896431684494, 0.08915618807077408, 0.09027726203203201, 0.08893752843141556, 0.09005584567785263, 0.10437993705272675, 0.0908830538392067, 0.08569041639566422], [0.08983325213193893, 0.08974185585975647, 0.09067636728286743, 0.09094056487083435, 0.08946823328733444, 0.09039989113807678, 0.08928627520799637, 0.09021604061126709, 0.10195981711149216, 0.09090250730514526, 0.08657519519329071], [0.08963463455438614, 0.08952773362398148, 0.09062167257070541, 0.09093131124973297, 0.08920779824256897, 0.09029782563447952, 0.08899515122175217, 0.0900825783610344, 0.10397905856370926, 0.090886689722538, 0.0858355239033699], [0.08697859942913055, 0.08669501543045044, 0.08962484449148178, 0.09046536684036255, 0.0858498066663742, 0.08875106275081635, 0.08529091626405716, 0.0881732925772667, 0.13056981563568115, 0.09034393727779388, 0.07725733518600464], [0.08948679268360138, 0.08936859667301178, 0.0905788466334343, 0.09092170000076294, 0.0890149399638176, 0.09022040665149689, 0.08877994865179062, 0.08998223394155502, 0.10547859221696854, 0.09087228775024414, 0.08529563248157501], [0.09040126204490662, 0.09035646170377731, 0.09081346541643143, 0.09094222635030746, 0.09022219479084015, 0.09067851305007935, 0.09013278782367706, 0.09058865159749985, 0.09615133702754974, 0.09092368930578232, 0.0887894406914711]], [[0.09167568385601044, 0.091576486825943, 0.09000032395124435, 0.09137841314077377, 0.0912795290350914, 0.09080066531896591, 0.09070240706205368, 0.09098353981971741, 0.09050622582435608, 0.09040828794240952, 0.09068850427865982], [0.0916634351015091, 0.0915658250451088, 0.0900147333741188, 0.09137091785669327, 0.09127362817525864, 0.090802401304245, 0.09070570766925812, 0.0909823551774025, 0.09051263332366943, 0.09041625261306763, 0.09069202095270157], [0.09146738797426224, 0.09139525145292282, 0.09024618566036224, 0.09125114232301712, 0.09117917716503143, 0.09083033353090286, 0.09075869619846344, 0.09096360951662064, 0.09061559289693832, 0.09054411947727203, 0.09074855595827103], [0.09163898229598999, 0.09154455363750458, 0.09004358947277069, 0.09135599434375763, 0.0912618637084961, 0.09080590307712555, 0.09071233868598938, 0.09098003804683685, 0.09052548557519913, 0.09043221175670624, 0.09069909155368805], [0.09162674099206924, 0.09153389930725098, 0.09005800634622574, 0.09134851396083832, 0.09125596284866333, 0.09080763906240463, 0.09071563184261322, 0.09097886085510254, 0.09053190052509308, 0.09044017642736435, 0.0907026082277298], [0.09156733751296997, 0.09148222208023071, 0.0901281088590622, 0.0913122296333313, 0.09122736006975174, 0.09081611782312393, 0.09073169529438019, 0.09097319841384888, 0.090563103556633, 0.09047891944646835, 0.09071975201368332], [0.09155511111021042, 0.0914715826511383, 0.09014254063367844, 0.09130476415157318, 0.09122146666049957, 0.09081785380840302, 0.09073500335216522, 0.09097202867269516, 0.09056951850652695, 0.09048689156770706, 0.09072327613830566], [0.0915900468826294, 0.09150198101997375, 0.09010127931833267, 0.09132610261440277, 0.09123829007148743, 0.09081286191940308, 0.09072554856538773, 0.09097535908222198, 0.09055116027593613, 0.09046408534049988, 0.09071318805217743], [0.09153066575527191, 0.09145031124353409, 0.09017141908407211, 0.09128982573747635, 0.09120968729257584, 0.09082134068012238, 0.0907416120171547, 0.09096968919038773, 0.09058236330747604, 0.09050285071134567, 0.09073032438755035], [0.09151843190193176, 0.09143967181444168, 0.09018585085868835, 0.09128234535455704, 0.09120377898216248, 0.09082306921482086, 0.09074490517377853, 0.09096850454807281, 0.0905887708067894, 0.09051080793142319, 0.0907338410615921], [0.09155337512493134, 0.09147007763385773, 0.090144582092762, 0.09130369871854782, 0.09122062474489212, 0.09081809967756271, 0.09073546528816223, 0.09097185730934143, 0.09057042747735977, 0.0904880166053772, 0.09072376787662506]], [[0.09136092662811279, 0.0913030356168747, 0.09189393371343613, 0.09206057339906693, 0.09112957864999771, 0.09171935170888901, 0.09188568592071533, 0.09160315990447998, 0.08498214930295944, 0.09116359055042267, 0.09089801460504532], [0.09134914726018906, 0.0912928357720375, 0.09186755120754242, 0.09202960878610611, 0.09112410992383957, 0.09169776737689972, 0.09185952693223953, 0.09158474951982498, 0.08513861149549484, 0.09115719795227051, 0.09089884907007217], [0.09146769344806671, 0.09139526635408401, 0.092134989798069, 0.09234381467103958, 0.09117835760116577, 0.09191632270812988, 0.09212464839220047, 0.09177082777023315, 0.0835583433508873, 0.09122087806463242, 0.09088893234729767], [0.09150045365095139, 0.09142350405454636, 0.09220968186855316, 0.0924316942691803, 0.0911930501461029, 0.09197723865509033, 0.0921986922621727, 0.09182260185480118, 0.08311931043863297, 0.09123822301626205, 0.09088559448719025], [0.09131365269422531, 0.091262087225914, 0.09178828448057175, 0.0919366106390953, 0.0911075547337532, 0.09163285791873932, 0.09178093820810318, 0.09152939170598984, 0.0856095626950264, 0.0911378562450409, 0.0909011960029602], [0.09143304079771042, 0.09136537462472916, 0.09205638617277145, 0.09225139766931534, 0.09116267412900925, 0.09185215085744858, 0.09204673022031784, 0.09171625226736069, 0.08402137458324432, 0.09120241552591324, 0.09089216589927673], [0.09146605432033539, 0.0913938581943512, 0.09213127940893173, 0.09233944863080978, 0.09117761999368668, 0.09191329032182693, 0.09212097525596619, 0.09176824986934662, 0.0835801512002945, 0.09122000634670258, 0.0908890813589096], [0.09140980988740921, 0.09134531021118164, 0.09200388193130493, 0.09218969941139221, 0.09115208685398102, 0.09180926531553268, 0.09199468791484833, 0.09167974442243576, 0.08433135598897934, 0.09118996560573578, 0.0908941850066185], [0.08982514590024948, 0.08994509279727936, 0.08873176574707031, 0.08839395642280579, 0.09030589461326599, 0.08908771723508835, 0.08874854445457458, 0.08932580053806305, 0.10461021959781647, 0.09023497998714447, 0.09079092741012573], [0.09132063388824463, 0.0912681370973587, 0.09180384874343872, 0.09195487201213837, 0.09111082553863525, 0.09164561331272125, 0.0917963758111, 0.09154026955366135, 0.08551695942878723, 0.09114167094230652, 0.09090075641870499], [0.09126576781272888, 0.09122053533792496, 0.09168190509080887, 0.091811902821064, 0.09108497947454453, 0.09154566377401352, 0.09167546778917313, 0.09145494550466537, 0.08624338358640671, 0.09111156314611435, 0.09090392291545868]]]}, "num_training_step_calls_per_iteration": 1, "evaluation": {"env_runners": {"episode_len_max": 20, "rlmodule_inference_timer": 3.160171202745345e-05, "num_module_steps_sampled": {"default_policy": 400}, "sample": 0.1734327656729898, "env_to_module_connector": {"timers": {"connectors": {"add_states_from_episodes_to_batch": 2.829539801987235e-06, "add_time_dim_to_batch_and_zero_pad": 6.778880724925172e-06, "add_observations_from_episodes_to_batch": 2.809308262882723e-06, "numpy_to_tensor": 1.2040395682628604e-05, "batch_individual_items": 1.2399649091208692e-05}}, "connector_pipeline_timer": 5.933544196967564e-05}, "module_episode_returns_mean": {"default_policy": 1.15}, "module_to_env_connector": {"timers": {"connectors": {"normalize_and_clip_actions": 7.749277085613184e-06, "remove_single_ts_time_rank_from_batch": 1.179256926092052e-05, "tensor_to_numpy": 1.5064103412660354e-05, "listify_data_for_vector_env": 1.0191330258073848e-05, "un_batch_to_individual_items": 6.4938781656845975e-06, "get_actions": 3.718795217105188e-05}}, "connector_pipeline_timer": 0.00011514821261546128}, "episode_duration_sec_mean": 0.006507467156916391, "weights_seq_no": 4.0, "env_to_module_sum_episodes_length_out": 10.368237912813044, "agent_episode_returns_mean": {"default_agent": 1.15}, "episode_return_mean": 1.15, "env_to_module_sum_episodes_length_in": 10.368237912813044, "num_episodes_lifetime": 80, "num_agent_steps_sampled_lifetime": {"default_agent": 1600}, "num_episodes": 20, "episode_len_mean": 20.0, "num_agent_steps_sampled": {"default_agent": 400}, "num_module_steps_sampled_lifetime": {"default_policy": 1600}, "env_reset_timer": 0.002400807021696353, "episode_return_min": -16.5, "num_env_steps_sampled": 400, "episode_len_min": 20, "episode_return_max": 12.5, "env_step_timer": 1.3913192114213581e-05, "num_env_steps_sampled_lifetime": 20400, "time_between_sampling": 10.960101384004659}, "num_healthy_workers": 1, "actor_manager_num_outstanding_async_reqs": 0, "num_remote_worker_restarts": 0}, "num_env_steps_sampled_lifetime": -1225000.0, "fault_tolerance": {"num_healthy_workers": 0, "num_remote_worker_restarts": 0}, "env_runner_group": {"actor_manager_num_outstanding_async_reqs": 0}, "done": false, "training_iteration": 4, "trial_id": "b154b_00000", "date": "2025-08-11_18-12-07", "timestamp": 1754928727, "time_this_iter_s": 10.77631425857544, "time_total_s": 42.767695903778076, "pid": 10455, "hostname": "Mac", "node_ip": "127.0.0.1", "config": {"exploration_config": {}, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 2, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "env": "Umbrella", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": false, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 0, "create_local_env_runner": true, "num_envs_per_env_runner": 1, "gym_env_vectorize_mode": "SYNC", "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "episodes_to_numpy": true, "max_requests_in_flight_per_env_runner": 1, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "merge_env_runner_states": "training_only", "broadcast_env_runner_states": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "complete_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "sampler_perf_stats_ema_coef": null, "_is_online": true, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": "auto", "num_aggregator_actors_per_learner": 0, "max_requests_in_flight_per_aggregator_actor": 3, "local_gpu_idx": 0, "max_requests_in_flight_per_learner": 3, "gamma": 1, "lr": 0.0002715581955, "grad_clip": 0.5, "grad_clip_by": "global_norm", "_train_batch_size_per_learner": 5000, "train_batch_size": 4000, "num_epochs": 1, "minibatch_size": 1000, "shuffle_batch_per_epoch": true, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "log_std_clip_param": 20.0, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "_disable_preprocessor_api": false, "_disable_action_flattening": false}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {"intrinsic_reward_coeff": 0.2795015916508}, "optimizer": {}, "_learner_class": "<class 'source.intrinsic_attention_ppo.learners.IntrinsicAttentionMetaLearner.IntrinsicAttentionMetaLearner'>", "callbacks_on_algorithm_init": null, "callbacks_on_env_runners_recreated": null, "callbacks_on_offline_eval_runners_recreated": null, "callbacks_on_checkpoint_loaded": null, "callbacks_on_environment_created": null, "callbacks_on_episode_created": null, "callbacks_on_episode_start": null, "callbacks_on_episode_step": null, "callbacks_on_episode_end": null, "callbacks_on_evaluate_start": null, "callbacks_on_evaluate_end": null, "callbacks_on_evaluate_offline_start": null, "callbacks_on_evaluate_offline_end": null, "callbacks_on_sample_end": null, "callbacks_on_train_result": null, "explore": true, "enable_rl_module_and_learner": true, "enable_env_runner_and_connector_v2": true, "_prior_exploration_config": {"type": "StochasticSampling"}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x1514e58a0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "offline_data_class": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_read_batch_size": null, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "materialize_data": false, "materialize_mapped_data": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "ignore_final_observation": false, "prelearner_class": null, "prelearner_buffer_class": null, "prelearner_buffer_kwargs": {}, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_remaining_data": false, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": 1, "evaluation_duration": 20, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_auto_duration_min_env_steps_per_sample": 100, "evaluation_auto_duration_max_env_steps_per_sample": 2000, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 1, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "offline_evaluation_interval": null, "num_offline_eval_runners": 0, "offline_loss_for_module_fn": null, "offline_evaluation_duration": 1, "offline_evaluation_parallel_to_training": false, "offline_evaluation_timeout_s": 120.0, "num_cpus_per_offline_eval_runner": 1, "num_gpus_per_offline_eval_runner": 0, "custom_resources_per_offline_eval_runner": {}, "restart_failed_offline_eval_runners": true, "ignore_offline_eval_runner_failures": false, "max_num_offline_eval_runner_restarts": 1000, "offline_eval_runner_restore_timeout_s": 1800.0, "max_requests_in_flight_per_offline_eval_runner": 1, "validate_offline_eval_runners_after_construction": true, "offline_eval_runner_health_probe_timeout_s": 30.0, "offline_eval_rl_module_inference_only": false, "broadcast_offline_eval_runner_states": false, "offline_eval_batch_size_per_runner": 256, "dataset_num_iters_per_eval_runner": 1, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "log_gradients": false, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 4, "restart_failed_env_runners": true, "ignore_env_runner_failures": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30.0, "env_runner_restore_timeout_s": 1800.0, "_model_config": {}, "_rl_module_spec": "MultiRLModuleSpec(multi_rl_module_class=<class 'ray.rllib.core.rl_module.multi_rl_module.MultiRLModule'>, observation_space=None, action_space=None, inference_only=False, model_config=None, rl_module_specs={'default_policy': RLModuleSpec(module_class=<class 'source.intrinsic_attention_ppo.rl_modules.DifferentiablePPOModule.DifferentiablePPOModule'>, observation_space=None, action_space=None, inference_only=False, learner_only=False, model_config={'vf_share_layers': True, 'embedding_dim': 62, 'max_seq_len': 11, 'policy_head_hidden_sizes': [32], 'value_head_hidden_sizes': [101], 'embedding_hidden_sizes': [121]}, catalog_class=None, load_state_path=None, model_config_dict=None), 'intrinsic_reward_module': RLModuleSpec(module_class=<class 'source.intrinsic_attention_ppo.rl_modules.IntrinsicAttentionModule.IntrinsicAttentionModule'>, observation_space=None, action_space=None, inference_only=False, learner_only=True, model_config={'intrinsic_reward_network': {'encoder_hidden_sizes': [], 'encoding_dim': 1, 'num_heads': 1, 'head_hidden_sizes': None, 'layers': [{'type': 'attention'}]}, 'extrinsic_value_hidden_layers': [127, 60], 'vf_share_layers': True, 'max_seq_len': 11}, catalog_class=None, load_state_path=None, model_config_dict=None)}, load_state_path=None, modules_to_load=None, module_specs={'default_policy': RLModuleSpec(module_class=<class 'source.intrinsic_attention_ppo.rl_modules.DifferentiablePPOModule.DifferentiablePPOModule'>, observation_space=None, action_space=None, inference_only=False, learner_only=False, model_config={'vf_share_layers': True, 'embedding_dim': 62, 'max_seq_len': 11, 'policy_head_hidden_sizes': [32], 'value_head_hidden_sizes': [101], 'embedding_hidden_sizes': [121]}, catalog_class=None, load_state_path=None, model_config_dict=None), 'intrinsic_reward_module': RLModuleSpec(module_class=<class 'source.intrinsic_attention_ppo.rl_modules.IntrinsicAttentionModule.IntrinsicAttentionModule'>, observation_space=None, action_space=None, inference_only=False, learner_only=True, model_config={'intrinsic_reward_network': {'encoder_hidden_sizes': [], 'encoding_dim': 1, 'num_heads': 1, 'head_hidden_sizes': None, 'layers': [{'type': 'attention'}]}, 'extrinsic_value_hidden_layers': [127, 60], 'vf_share_layers': True, 'max_seq_len': 11}, catalog_class=None, load_state_path=None, model_config_dict=None)})", "algorithm_config_overrides_per_module": {"intrinsic_reward_module": {"lr": 0.0002715581955}}, "_per_module_overrides": {}, "_validate_config": true, "_use_msgpack_checkpoints": false, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "env_task_fn": -1, "enable_connectors": -1, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.161583927863, "kl_target": 0.0201019014258, "vf_loss_coeff": 0.7790510010087, "entropy_coeff": 0.0015431216992, "clip_param": 0.2459212356676, "vf_clip_param": 0.3769744131561, "entropy_coeff_schedule": null, "lr_schedule": null, "sgd_minibatch_size": -1, "vf_share_layers": -1, "differentiable_learner_configs": ["DifferentiableLearnerConfig(learner_class=<class 'source.intrinsic_attention_ppo.learners.IntrinsicAttentionPPOLearner.IntrinsicAttentionPPOLearner'>, learner_connector=None, add_default_connectors_to_learner_pipeline=True, is_multi_agent=False, policies_to_update=['default_policy'], lr=0.0060984166342, num_total_minibatches=0, num_epochs=1, minibatch_size=1000, shuffle_batch_per_epoch=True)"], "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9485408017724, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.callbacks.callbacks.RLlibCallback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 42.767695903778076, "iterations_since_restore": 4, "perf": {"cpu_util_percent": 47.12, "ram_util_percent": 80.45333333333333}}
{"timers": {"training_iteration": 10.202156737417445, "restore_env_runners": 1.092321202162537e-05, "training_step": 10.201960542554904, "env_runner_sampling_timer": 1.8220343256584275, "learner_update_timer": 8.200390036677435, "synch_weights": 0.0015373320417624327, "restore_eval_env_runners": 7.985034030082169e-05, "evaluation_iteration": 0.21579413124053412, "synch_eval_env_connectors": 0.0002307985773674445, "synch_env_connectors": 5.140921415062622e-06}, "env_runners": {"num_env_steps_sampled": 5000.0, "episode_return_max": 12.5, "env_to_module_connector": {"timers": {"connectors": {"add_time_dim_to_batch_and_zero_pad": 7.688853143186962e-06, "add_observations_from_episodes_to_batch": 3.102714271208789e-06, "batch_individual_items": 1.3757316958919003e-05, "numpy_to_tensor": 1.4430963685549714e-05, "add_states_from_episodes_to_batch": 2.958131262911999e-06}}, "connector_pipeline_timer": 6.605927081094032e-05}, "episode_len_min": 20, "module_to_env_connector": {"timers": {"connectors": {"un_batch_to_individual_items": 7.325965635774851e-06, "normalize_and_clip_actions": 8.785698867943857e-06, "remove_single_ts_time_rank_from_batch": 1.2883960401522594e-05, "get_actions": 4.6596573405921844e-05, "tensor_to_numpy": 1.6849987352128592e-05, "listify_data_for_vector_env": 1.1778234645807521e-05}}, "connector_pipeline_timer": 0.00013344133777354558}, "env_step_timer": 1.5626547574400637e-05, "num_agent_steps_sampled_lifetime": {"default_agent": -1842500.0}, "num_episodes": 250.0, "episode_duration_sec_mean": 0.005931477378588168, "episode_len_mean": 20.0, "module_episode_returns_mean": {"default_policy": 3.9399999999999995}, "weights_seq_no": 4.0, "env_to_module_sum_episodes_length_out": 10.36823839457432, "num_env_steps_sampled_lifetime": -1842500.0, "episode_len_max": 20, "rlmodule_inference_timer": 3.6265731067441175e-05, "num_agent_steps_sampled": {"default_agent": 5000.0}, "env_reset_timer": 5.986119702749262e-05, "agent_episode_returns_mean": {"default_agent": 3.9399999999999995}, "env_to_module_sum_episodes_length_in": 10.36823839457432, "episode_return_mean": 3.9399999999999995, "time_between_sampling": 0.03578331638657241, "num_module_steps_sampled_lifetime": {"default_policy": -1842500.0}, "num_module_steps_sampled": {"default_policy": 5000.0}, "num_episodes_lifetime": -92125.0, "episode_return_min": -7.5, "sample": 0.006741840662697891, "num_env_steps_sampled_lifetime_throughput": 2927.6648018802034}, "__all_modules__": {"learner_connector_sum_episodes_length_in": 5000.0, "learner_connector": {"connector_pipeline_timer": 0.13905008129555782, "timers": {"connectors": {"add_one_ts_to_episodes_and_truncate": 0.009505900625081661, "add_observations_from_episodes_to_batch": 0.0010439962630333331, "add_columns_from_episodes_to_train_batch": 0.04408858825261002, "add_time_dim_to_batch_and_zero_pad": 0.07620606811907653, "add_states_from_episodes_to_batch": 0.0035765251186959317, "batch_individual_items": 0.004364682018894265, "numpy_to_tensor": 7.263215497037046e-05}}}, "learner_connector_sum_episodes_length_out": 5250.0}, "learners": {"__all_modules__": {"num_module_steps_trained_lifetime": 59850, "num_env_steps_trained": 33000, "num_env_steps_trained_lifetime": 165000, "num_non_trainable_parameters": 0, "num_trainable_parameters": 24861, "num_module_steps_trained": 11970, "num_env_steps_trained_lifetime_throughput": 3958.6035572659935, "num_module_steps_trained_throughput": 29006357.58902019, "num_module_steps_trained_lifetime_throughput": 12907387.363864597}, "default_policy": {"curr_entropy_coeff": 0.0015431216992, "weights_seq_no": 5.0, "curr_kl_coeff": 0.0050494978204369545, "policy_loss": -4.155794158577919e-05, "module_train_batch_size_mean": 997.8691961675322, "num_trainable_parameters": 16595, "vf_loss": 0.3583100140094757, "mean_kl_loss": 6.432065674744081e-06, "diff_num_grad_updates_vs_sampler_policy": 1.0, "vf_explained_var": 0.0018701553344726562, "use_intrinsic_rewards": 0.0, "entropy": 0.6863771677017212, "num_module_steps_trained": 5985, "vf_loss_unclipped": 44.062408447265625, "total_loss": 0.2780410945415497, "num_module_steps_trained_lifetime": 29925, "num_module_steps_trained_lifetime_throughput": 717.6610306089234}, "differentiable_learners": {"intrinsic_attention_ppo_learner": {"__all_modules__": {"num_module_steps_trained_lifetime": 359100, "num_env_steps_trained_lifetime": 990000, "num_module_steps_trained": 71820, "num_env_steps_trained": 198000, "num_env_steps_trained_lifetime_throughput": 51553.87377655182}, "default_policy": {"weights_seq_no": 30.0, "policy_loss": -3.9652601117268205e-05, "module_train_batch_size_mean": 997.5798029998547, "vf_loss": 0.3583173453807831, "mean_kl_loss": 6.391886472556507e-06, "diff_num_grad_updates_vs_sampler_policy": 26.0, "vf_explained_var": 0.002774655818939209, "use_intrinsic_rewards": 1.0, "entropy": 0.6863783597946167, "num_module_steps_trained": 35910, "vf_loss_unclipped": 44.056949615478516, "total_loss": 0.27804967761039734, "num_module_steps_trained_lifetime": 179550}, "intrinsic_reward_module": {"total_loss": 0.0, "num_module_steps_trained_lifetime": 179550, "module_train_batch_size_mean": 997.5798029998547, "weights_seq_no": 30.0, "num_module_steps_trained": 35910, "diff_num_grad_updates_vs_sampler_policy": 26.0}}}, "intrinsic_reward_module": {"diff_num_grad_updates_vs_sampler_policy": 1.0, "gradients_default_optimizer_global_norm": 0.0, "curr_entropy_coeff": 0.0015431216992, "weights_seq_no": 5.0, "default_optimizer_learning_rate": 0.0002715581955, "total_loss": 0.0, "num_module_steps_trained_lifetime": 29925, "module_train_batch_size_mean": 997.8691961675322, "num_trainable_parameters": 8266, "num_module_steps_trained": 5985, "num_module_steps_trained_lifetime_throughput": 717.672599788915}, "IntrinsicAttentionMask": [[[0.08836971968412399, 0.09150320291519165, 0.09030284732580185, 0.09135262668132782, 0.09127742797136307, 0.09091298282146454, 0.09196985512971878, 0.09105221927165985, 0.09068866819143295, 0.09174293279647827, 0.09082755446434021], [0.08617226034402847, 0.09202473610639572, 0.08976146578788757, 0.09173936396837234, 0.09159702062606812, 0.09090856462717056, 0.0929117500782013, 0.09117129445075989, 0.09048604220151901, 0.09247991442680359, 0.09074754267930984], [0.08699934184551239, 0.09182760864496231, 0.08996709436178207, 0.09159348160028458, 0.09147663414478302, 0.09091109782457352, 0.09255454689264297, 0.09112701565027237, 0.09056363254785538, 0.09220080077648163, 0.09077871590852737], [0.08627503365278244, 0.09200017899274826, 0.08978714048862457, 0.09172121435403824, 0.0915820524096489, 0.09090893715620041, 0.0928671807050705, 0.09116582572460175, 0.090495765209198, 0.09244511276483536, 0.09075149148702621], [0.0863264799118042, 0.09198791533708572, 0.08979998528957367, 0.09171214699745178, 0.09157457947731018, 0.09090913087129593, 0.09284491091966629, 0.09116309881210327, 0.09050064533948898, 0.09242772310972214, 0.0907534658908844], [0.08657671511173248, 0.09192821383476257, 0.08986230939626694, 0.09166797995567322, 0.09153814613819122, 0.090909942984581, 0.09273666888475418, 0.0911497250199318, 0.09052419662475586, 0.09234316647052765, 0.09076295793056488], [0.08585548400878906, 0.09210049360990524, 0.08968209475278854, 0.09179534763097763, 0.09164315462112427, 0.09090731292963028, 0.09304943680763245, 0.09118808060884476, 0.09045588970184326, 0.09258738160133362, 0.09073526412248611], [0.08648091554641724, 0.09195104986429214, 0.08983846753835678, 0.09168488532304764, 0.09155208617448807, 0.09090964496135712, 0.09277806431055069, 0.09115485101938248, 0.09051518887281418, 0.0923755094408989, 0.09075932949781418], [0.08673155307769775, 0.0918913185596466, 0.08990076929330826, 0.09164067357778549, 0.09151560068130493, 0.0909103974699974, 0.09266984462738037, 0.09114142507314682, 0.09053869545459747, 0.09229094535112381, 0.09076876938343048], [0.0860092043876648, 0.09206372499465942, 0.08972065895795822, 0.09176818281412125, 0.09162077307701111, 0.09090794622898102, 0.09298257529735565, 0.09117995202541351, 0.0904705598950386, 0.09253520518541336, 0.09074125438928604], [0.08663561195135117, 0.09191418439149857, 0.08987694978713989, 0.0916575938463211, 0.09152957051992416, 0.09091012179851532, 0.09271124005317688, 0.0911465734243393, 0.09052971750497818, 0.09232329577207565, 0.09076517820358276]], [[0.08959551155567169, 0.09101676940917969, 0.09206141531467438, 0.08929462730884552, 0.09071110934019089, 0.09021828323602676, 0.08899474889039993, 0.09154670685529709, 0.1012846976518631, 0.08925345540046692, 0.08602257817983627], [0.08929631859064102, 0.09102141112089157, 0.09229308366775513, 0.0889318585395813, 0.09064991027116776, 0.09005149453878403, 0.08856889605522156, 0.09166612476110458, 0.10365317016839981, 0.08888200670480728, 0.08498578518629074], [0.08907580375671387, 0.09102047979831696, 0.09245707839727402, 0.08866556733846664, 0.09060129523277283, 0.08992651849985123, 0.08825722336769104, 0.09174849092960358, 0.10540015995502472, 0.0886094719171524, 0.08423785120248795], [0.08965874463319778, 0.09101492166519165, 0.09201109409332275, 0.08937150985002518, 0.09072333574295044, 0.09025311470031738, 0.08908519148826599, 0.09152033925056458, 0.10078456997871399, 0.0893322005867958, 0.08624500781297684], [0.08936074376106262, 0.09102098643779755, 0.09224409610033035, 0.0890098363161087, 0.09066355973482132, 0.09008768200874329, 0.08866029977798462, 0.09164115786552429, 0.10314296931028366, 0.08896182477474213, 0.08520685881376266], [0.08946452289819717, 0.0910196378827095, 0.09216414391994476, 0.08913560211658478, 0.09068499505519867, 0.09014565497636795, 0.08880788087844849, 0.09160008281469345, 0.10232129693031311, 0.08909059315919876, 0.0855654925107956], [0.08972170203924179, 0.09101274609565735, 0.09196048974990845, 0.08944813907146454, 0.09073524177074432, 0.09028764069080353, 0.08917541801929474, 0.0914936512708664, 0.1002865582704544, 0.089410699903965, 0.0864676982164383], [0.08918450772762299, 0.09102138131856918, 0.09237692505121231, 0.08879672735929489, 0.09062561392784119, 0.0899883359670639, 0.0884106308221817, 0.0917084589600563, 0.10453875362873077, 0.08874369412660599, 0.08460488170385361], [0.08711235225200653, 0.09086703509092331, 0.09369038790464401, 0.08633017539978027, 0.09005114436149597, 0.0887453556060791, 0.08555501699447632, 0.09229252487421036, 0.12102508544921875, 0.08622349053621292, 0.07810741662979126], [0.08966738730669022, 0.09101463109254837, 0.09200417250394821, 0.08938201516866684, 0.09072498232126236, 0.09025786072015762, 0.08909756690263748, 0.09151668101549149, 0.10071615874767303, 0.08934296667575836, 0.08627551048994064], [0.09034311771392822, 0.0909738838672638, 0.09143400192260742, 0.09020885825157166, 0.09083869308233261, 0.09062018245458603, 0.0900748148560524, 0.09120766073465347, 0.09537597000598907, 0.09019047021865845, 0.08873233199119568]], [[0.08837022632360458, 0.09150372445583344, 0.09142840653657913, 0.09135314077138901, 0.09127794951200485, 0.09091350436210632, 0.09083866328001022, 0.09105273336172104, 0.09181903302669525, 0.09061453491449356, 0.0908280685544014], [0.08617402613162994, 0.09202661365270615, 0.0918838232755661, 0.09174124896526337, 0.09159889817237854, 0.09091043472290039, 0.09076936542987823, 0.09117315709590912, 0.09262553602457047, 0.09034749120473862, 0.09074940532445908], [0.08622536063194275, 0.09201430529356003, 0.09187310934066772, 0.09173212945461273, 0.09159137308597565, 0.09091057628393173, 0.09077107906341553, 0.09117039293050766, 0.09260646998882294, 0.09035386890172958, 0.09075134247541428], [0.08627672493457794, 0.09200197458267212, 0.09186238795518875, 0.0917230099439621, 0.09158384054899216, 0.09091071039438248, 0.09077277779579163, 0.09116759896278381, 0.09258739650249481, 0.09036023169755936, 0.09075325727462769], [0.08632812649011612, 0.091989666223526, 0.09185167402029037, 0.09171389788389206, 0.09157632291316986, 0.09091086685657501, 0.09077449142932892, 0.09116483479738235, 0.09256834536790848, 0.09036661684513092, 0.09075520187616348], [0.08657819777727127, 0.09192978590726852, 0.09179957211017609, 0.09166954457759857, 0.09153970330953598, 0.09091150015592575, 0.09078272432088852, 0.09115128219127655, 0.09247572720050812, 0.09039751440286636, 0.09076450765132904], [0.08662975579500198, 0.09191745519638062, 0.09178885072469711, 0.09166041761636734, 0.0915321633219719, 0.0909116193652153, 0.09078441560268402, 0.0911484882235527, 0.09245666861534119, 0.09040386974811554, 0.09076641499996185], [0.0864824652671814, 0.09195269644260406, 0.09181950986385345, 0.09168652445077896, 0.0915537178516388, 0.09091126918792725, 0.09077958762645721, 0.0911564826965332, 0.09251115471124649, 0.09038570523262024, 0.0907609611749649], [0.08595985919237137, 0.09207804501056671, 0.09192854911088943, 0.09177929908037186, 0.09163029491901398, 0.09090977907180786, 0.0907621756196022, 0.09118470549583435, 0.09270518273115158, 0.09032082557678223, 0.09074129909276962], [0.08678456395864487, 0.0918804407119751, 0.09175662696361542, 0.09163297712802887, 0.09150949865579605, 0.09091194719076157, 0.09078943729400635, 0.09114005416631699, 0.0923994705080986, 0.09042289853096008, 0.0907720997929573], [0.08663704246282578, 0.09191569685935974, 0.09178731590509415, 0.09165910631418228, 0.09153108298778534, 0.0909116268157959, 0.09078464657068253, 0.09114807844161987, 0.0924539566040039, 0.09040475636720657, 0.09076667577028275]], [[0.09114743024110794, 0.08915183693170547, 0.09230957180261612, 0.08890602737665176, 0.0887833833694458, 0.09003958106040955, 0.09039557725191116, 0.09167459607124329, 0.10382396727800369, 0.0888555645942688, 0.08491235226392746], [0.09111689776182175, 0.08951789140701294, 0.09204483777284622, 0.08932044357061386, 0.08922187983989716, 0.09023008495569229, 0.09051529318094254, 0.09153810888528824, 0.10111793875694275, 0.0892798900604248, 0.08609684556722641], [0.09116094559431076, 0.0889391377568245, 0.09245738387107849, 0.08866585791110992, 0.08852953463792801, 0.0899268090724945, 0.09032319486141205, 0.09174878895282745, 0.10540051013231277, 0.08860976248979568, 0.08423811942338943], [0.09111245721578598, 0.0895630344748497, 0.09201124310493469, 0.08937164396047592, 0.08927610516548157, 0.09025324881076813, 0.09052960574626923, 0.09152047336101532, 0.10078472644090652, 0.08933233469724655, 0.08624513447284698], [0.09111019223928452, 0.0895855650305748, 0.09199439734220505, 0.08939720690250397, 0.08930318057537079, 0.09026478976011276, 0.09053672105073929, 0.09151160717010498, 0.10061848163604736, 0.08935852348804474, 0.08631933480501175], [0.09113165736198425, 0.08935493975877762, 0.09216433763504028, 0.0891357883810997, 0.08902641385793686, 0.09014584869146347, 0.09046277403831482, 0.09160027652978897, 0.10232152044773102, 0.08909078687429428, 0.08556568622589111], [0.09113705158233643, 0.08928965032100677, 0.09221148490905762, 0.08906187862157822, 0.08894822001457214, 0.09011185169219971, 0.09044138342142105, 0.09162455797195435, 0.1028042733669281, 0.08901511132717133, 0.08535459637641907], [0.09115394204854965, 0.08905530720949173, 0.0923771858215332, 0.08879697322845459, 0.088668093085289, 0.0899885892868042, 0.09036298841238022, 0.0917087197303772, 0.10453905165195465, 0.08874394744634628, 0.08460512012243271], [0.0911417081952095, 0.08685186505317688, 0.09369149804115295, 0.08633118867874146, 0.08607202023267746, 0.08874639123678207, 0.08951233327388763, 0.09229360520839691, 0.12102652341127396, 0.0862244963645935, 0.07810833305120468], [0.09111153334379196, 0.08957231044769287, 0.09200431406497955, 0.08938216418027878, 0.08928724378347397, 0.09025800228118896, 0.09053253382444382, 0.09151683002710342, 0.10071632266044617, 0.0893431156873703, 0.08627564460039139], [0.09101901948451996, 0.0902983769774437, 0.0914340391755104, 0.09020889550447464, 0.0901641920208931, 0.09062021970748901, 0.09074871242046356, 0.09120769798755646, 0.09537600725889206, 0.09019050747156143, 0.08873236179351807]], [[0.08866859972476959, 0.09181267768144608, 0.09173710644245148, 0.09053368121385574, 0.09045916050672531, 0.09122046083211899, 0.09114537388086319, 0.09136015921831131, 0.09212905168533325, 0.09092048555612564, 0.09001331776380539], [0.08672259747982025, 0.09261244535446167, 0.0924687385559082, 0.09019455313682556, 0.09005459398031235, 0.09148915112018585, 0.09134718775749207, 0.09175355732440948, 0.09321517497301102, 0.09092263132333755, 0.08921942859888077], [0.08676816523075104, 0.09259354323148727, 0.09245146065950394, 0.09020262956619263, 0.09006421267986298, 0.09148287773132324, 0.091342493891716, 0.0917443186044693, 0.09318944066762924, 0.09092265367507935, 0.08923818916082382], [0.08750172704458237, 0.09229052066802979, 0.09217438101768494, 0.09033181518316269, 0.09021813422441483, 0.09138177335262299, 0.09126678109169006, 0.09159586578607559, 0.09277727454900742, 0.09092265367507935, 0.08953907340765], [0.08754764497280121, 0.09227162599563599, 0.09215710312128067, 0.09033983945846558, 0.09022771567106247, 0.0913754403591156, 0.09126202762126923, 0.09158658236265182, 0.09275159984827042, 0.09092261642217636, 0.08955784142017365], [0.08708127588033676, 0.09246395528316498, 0.09233298897743225, 0.09025798738002777, 0.09013014286756516, 0.09143975377082825, 0.09131023287773132, 0.09168092906475067, 0.09301307052373886, 0.09092278778553009, 0.08936688303947449], [0.08712700754404068, 0.09244506061077118, 0.09231571853160858, 0.09026604890823364, 0.09013975411653519, 0.09143345803022385, 0.09130552411079407, 0.09167168289422989, 0.09298737347126007, 0.09092279523611069, 0.08938565105199814], [0.08699633181095123, 0.09249906986951828, 0.0923650935292244, 0.09024299681186676, 0.09011229127645493, 0.09145145118236542, 0.0913189947605133, 0.09169811755418777, 0.09306084364652634, 0.0909227654337883, 0.08933200687170029], [0.08653242141008377, 0.09269136190414429, 0.09254086762666702, 0.09016073495149612, 0.09001435339450836, 0.09151531010866165, 0.0913667231798172, 0.09179206937551498, 0.09332267194986343, 0.09092243015766144, 0.08914103358983994], [0.08726431429386139, 0.09238836914300919, 0.09226386994123459, 0.09029019623994827, 0.0901685282588005, 0.09141451865434647, 0.09129133075475693, 0.09164388477802277, 0.0929102674126625, 0.0909227728843689, 0.0894419327378273], [0.08782356232404709, 0.09215822070837021, 0.0920533537864685, 0.09038793295621872, 0.09028507769107819, 0.09133734554052353, 0.09123340994119644, 0.09153080731630325, 0.0925975888967514, 0.09092231839895248, 0.08967041224241257]], [[0.09209814667701721, 0.09201593697071075, 0.09285606443881989, 0.09185173362493515, 0.09054573625326157, 0.09260762482881546, 0.09160598367452621, 0.09120939671993256, 0.08316969126462936, 0.09181800484657288, 0.09022174775600433], [0.09207575023174286, 0.09199514240026474, 0.09281879663467407, 0.09183414280414581, 0.09055343270301819, 0.09257524460554123, 0.0915931835770607, 0.09120427817106247, 0.08331328630447388, 0.09180106967687607, 0.0902356505393982], [0.09230262041091919, 0.09220563620328903, 0.09319742769002914, 0.09201198071241379, 0.09047389775514603, 0.0929039716720581, 0.09172225743532181, 0.09125500172376633, 0.08186213672161102, 0.09197220951318741, 0.09009292721748352], [0.09203090518712997, 0.09195350855588913, 0.09274423867464066, 0.09179890900850296, 0.09056874364614487, 0.09251044690608978, 0.0915675088763237, 0.09119398891925812, 0.08360116928815842, 0.09176714718341827, 0.09026339650154114], [0.09166817367076874, 0.09161640703678131, 0.09214464575052261, 0.09151295572519302, 0.09068771451711655, 0.09198862314224243, 0.0913579985499382, 0.09110760688781738, 0.08594193309545517, 0.0914916917681694, 0.09048230946063995], [0.0922359749674797, 0.09214383363723755, 0.09308595210313797, 0.09195981174707413, 0.09049762040376663, 0.09280724823474884, 0.09168447554111481, 0.09124033898115158, 0.0822875052690506, 0.09192201495170593, 0.09013526141643524], [0.09196346998214722, 0.09189088642597198, 0.09263230860233307, 0.09174587577581406, 0.09059151262044907, 0.09241314232349396, 0.09152881056070328, 0.09117835015058517, 0.08403467386960983, 0.09171608835458755, 0.09030484408140182], [0.09185385704040527, 0.09178903698921204, 0.092450812458992, 0.0916595458984375, 0.09062790125608444, 0.09225524216890335, 0.09146565943956375, 0.09115252643823624, 0.08474101126194, 0.09163294732570648, 0.09037148952484131], [0.08939609676599503, 0.08949227631092072, 0.08851824700832367, 0.08968494087457657, 0.09124478697776794, 0.08880425244569778, 0.08997472375631332, 0.09044598788022995, 0.10107456147670746, 0.08972461521625519, 0.09163946658372879], [0.09202166646718979, 0.09194493293762207, 0.09272889792919159, 0.09179165214300156, 0.09057188034057617, 0.09249711781740189, 0.09156221151351929, 0.0911918580532074, 0.08366048336029053, 0.09176016598939896, 0.09026908874511719], [0.0915764793753624, 0.09153109788894653, 0.0919940397143364, 0.09144040197134018, 0.0907164141535759, 0.09185733646154404, 0.09130451083183289, 0.09108489006757736, 0.08653699606657028, 0.09142175316810608, 0.09053608775138855]]]}, "num_training_step_calls_per_iteration": 1, "evaluation": {"env_runners": {"episode_len_max": 20, "rlmodule_inference_timer": 3.8564689861872155e-05, "num_module_steps_sampled": {"default_policy": 400}, "sample": 0.17303380634615181, "env_to_module_connector": {"timers": {"connectors": {"add_states_from_episodes_to_batch": 3.252494901824629e-06, "add_time_dim_to_batch_and_zero_pad": 7.876519748369137e-06, "add_observations_from_episodes_to_batch": 3.2859661951949114e-06, "numpy_to_tensor": 1.4584323114354957e-05, "batch_individual_items": 1.3872633327845763e-05}}, "connector_pipeline_timer": 6.809848420071908e-05}, "module_episode_returns_mean": {"default_policy": 0.75}, "module_to_env_connector": {"timers": {"connectors": {"normalize_and_clip_actions": 9.7325178432328e-06, "remove_single_ts_time_rank_from_batch": 1.3020049864195271e-05, "tensor_to_numpy": 1.8175021048043433e-05, "listify_data_for_vector_env": 1.2098474721495737e-05, "un_batch_to_individual_items": 7.12684338821996e-06, "get_actions": 4.605879454739205e-05}}, "connector_pipeline_timer": 0.0001361777652692245}, "episode_duration_sec_mean": 0.00642130748834461, "weights_seq_no": 5.0, "env_to_module_sum_episodes_length_out": 10.368238387501162, "agent_episode_returns_mean": {"default_agent": 0.75}, "episode_return_mean": 0.75, "env_to_module_sum_episodes_length_in": 10.368238387501162, "num_episodes_lifetime": 100, "num_agent_steps_sampled_lifetime": {"default_agent": 2000}, "num_episodes": 20, "episode_len_mean": 20.0, "num_agent_steps_sampled": {"default_agent": 400}, "num_module_steps_sampled_lifetime": {"default_policy": 2000}, "env_reset_timer": 0.0023784918607610904, "episode_return_min": -16.5, "num_env_steps_sampled": 400, "episode_len_min": 20, "episode_return_max": 12.5, "env_step_timer": 1.6667183018760918e-05, "num_env_steps_sampled_lifetime": 25400, "time_between_sampling": 10.947803764334624}, "num_healthy_workers": 1, "actor_manager_num_outstanding_async_reqs": 0, "num_remote_worker_restarts": 0}, "num_env_steps_sampled_lifetime": -1842500.0, "fault_tolerance": {"num_healthy_workers": 0, "num_remote_worker_restarts": 0}, "env_runner_group": {"actor_manager_num_outstanding_async_reqs": 0}, "done": false, "training_iteration": 5, "trial_id": "b154b_00000", "date": "2025-08-11_18-12-17", "timestamp": 1754928737, "time_this_iter_s": 9.843886137008667, "time_total_s": 52.61158204078674, "pid": 10455, "hostname": "Mac", "node_ip": "127.0.0.1", "config": {"exploration_config": {}, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 2, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "env": "Umbrella", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": false, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 0, "create_local_env_runner": true, "num_envs_per_env_runner": 1, "gym_env_vectorize_mode": "SYNC", "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "episodes_to_numpy": true, "max_requests_in_flight_per_env_runner": 1, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "merge_env_runner_states": "training_only", "broadcast_env_runner_states": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "complete_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "sampler_perf_stats_ema_coef": null, "_is_online": true, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": "auto", "num_aggregator_actors_per_learner": 0, "max_requests_in_flight_per_aggregator_actor": 3, "local_gpu_idx": 0, "max_requests_in_flight_per_learner": 3, "gamma": 1, "lr": 0.0002715581955, "grad_clip": 0.5, "grad_clip_by": "global_norm", "_train_batch_size_per_learner": 5000, "train_batch_size": 4000, "num_epochs": 1, "minibatch_size": 1000, "shuffle_batch_per_epoch": true, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "log_std_clip_param": 20.0, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "_disable_preprocessor_api": false, "_disable_action_flattening": false}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {"intrinsic_reward_coeff": 0.2795015916508}, "optimizer": {}, "_learner_class": "<class 'source.intrinsic_attention_ppo.learners.IntrinsicAttentionMetaLearner.IntrinsicAttentionMetaLearner'>", "callbacks_on_algorithm_init": null, "callbacks_on_env_runners_recreated": null, "callbacks_on_offline_eval_runners_recreated": null, "callbacks_on_checkpoint_loaded": null, "callbacks_on_environment_created": null, "callbacks_on_episode_created": null, "callbacks_on_episode_start": null, "callbacks_on_episode_step": null, "callbacks_on_episode_end": null, "callbacks_on_evaluate_start": null, "callbacks_on_evaluate_end": null, "callbacks_on_evaluate_offline_start": null, "callbacks_on_evaluate_offline_end": null, "callbacks_on_sample_end": null, "callbacks_on_train_result": null, "explore": true, "enable_rl_module_and_learner": true, "enable_env_runner_and_connector_v2": true, "_prior_exploration_config": {"type": "StochasticSampling"}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x1514e58a0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "offline_data_class": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_read_batch_size": null, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "materialize_data": false, "materialize_mapped_data": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "ignore_final_observation": false, "prelearner_class": null, "prelearner_buffer_class": null, "prelearner_buffer_kwargs": {}, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_remaining_data": false, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": 1, "evaluation_duration": 20, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_auto_duration_min_env_steps_per_sample": 100, "evaluation_auto_duration_max_env_steps_per_sample": 2000, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 1, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "offline_evaluation_interval": null, "num_offline_eval_runners": 0, "offline_loss_for_module_fn": null, "offline_evaluation_duration": 1, "offline_evaluation_parallel_to_training": false, "offline_evaluation_timeout_s": 120.0, "num_cpus_per_offline_eval_runner": 1, "num_gpus_per_offline_eval_runner": 0, "custom_resources_per_offline_eval_runner": {}, "restart_failed_offline_eval_runners": true, "ignore_offline_eval_runner_failures": false, "max_num_offline_eval_runner_restarts": 1000, "offline_eval_runner_restore_timeout_s": 1800.0, "max_requests_in_flight_per_offline_eval_runner": 1, "validate_offline_eval_runners_after_construction": true, "offline_eval_runner_health_probe_timeout_s": 30.0, "offline_eval_rl_module_inference_only": false, "broadcast_offline_eval_runner_states": false, "offline_eval_batch_size_per_runner": 256, "dataset_num_iters_per_eval_runner": 1, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "log_gradients": false, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 4, "restart_failed_env_runners": true, "ignore_env_runner_failures": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30.0, "env_runner_restore_timeout_s": 1800.0, "_model_config": {}, "_rl_module_spec": "MultiRLModuleSpec(multi_rl_module_class=<class 'ray.rllib.core.rl_module.multi_rl_module.MultiRLModule'>, observation_space=None, action_space=None, inference_only=False, model_config=None, rl_module_specs={'default_policy': RLModuleSpec(module_class=<class 'source.intrinsic_attention_ppo.rl_modules.DifferentiablePPOModule.DifferentiablePPOModule'>, observation_space=None, action_space=None, inference_only=False, learner_only=False, model_config={'vf_share_layers': True, 'embedding_dim': 62, 'max_seq_len': 11, 'policy_head_hidden_sizes': [32], 'value_head_hidden_sizes': [101], 'embedding_hidden_sizes': [121]}, catalog_class=None, load_state_path=None, model_config_dict=None), 'intrinsic_reward_module': RLModuleSpec(module_class=<class 'source.intrinsic_attention_ppo.rl_modules.IntrinsicAttentionModule.IntrinsicAttentionModule'>, observation_space=None, action_space=None, inference_only=False, learner_only=True, model_config={'intrinsic_reward_network': {'encoder_hidden_sizes': [], 'encoding_dim': 1, 'num_heads': 1, 'head_hidden_sizes': None, 'layers': [{'type': 'attention'}]}, 'extrinsic_value_hidden_layers': [127, 60], 'vf_share_layers': True, 'max_seq_len': 11}, catalog_class=None, load_state_path=None, model_config_dict=None)}, load_state_path=None, modules_to_load=None, module_specs={'default_policy': RLModuleSpec(module_class=<class 'source.intrinsic_attention_ppo.rl_modules.DifferentiablePPOModule.DifferentiablePPOModule'>, observation_space=None, action_space=None, inference_only=False, learner_only=False, model_config={'vf_share_layers': True, 'embedding_dim': 62, 'max_seq_len': 11, 'policy_head_hidden_sizes': [32], 'value_head_hidden_sizes': [101], 'embedding_hidden_sizes': [121]}, catalog_class=None, load_state_path=None, model_config_dict=None), 'intrinsic_reward_module': RLModuleSpec(module_class=<class 'source.intrinsic_attention_ppo.rl_modules.IntrinsicAttentionModule.IntrinsicAttentionModule'>, observation_space=None, action_space=None, inference_only=False, learner_only=True, model_config={'intrinsic_reward_network': {'encoder_hidden_sizes': [], 'encoding_dim': 1, 'num_heads': 1, 'head_hidden_sizes': None, 'layers': [{'type': 'attention'}]}, 'extrinsic_value_hidden_layers': [127, 60], 'vf_share_layers': True, 'max_seq_len': 11}, catalog_class=None, load_state_path=None, model_config_dict=None)})", "algorithm_config_overrides_per_module": {"intrinsic_reward_module": {"lr": 0.0002715581955}}, "_per_module_overrides": {}, "_validate_config": true, "_use_msgpack_checkpoints": false, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "env_task_fn": -1, "enable_connectors": -1, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.161583927863, "kl_target": 0.0201019014258, "vf_loss_coeff": 0.7790510010087, "entropy_coeff": 0.0015431216992, "clip_param": 0.2459212356676, "vf_clip_param": 0.3769744131561, "entropy_coeff_schedule": null, "lr_schedule": null, "sgd_minibatch_size": -1, "vf_share_layers": -1, "differentiable_learner_configs": ["DifferentiableLearnerConfig(learner_class=<class 'source.intrinsic_attention_ppo.learners.IntrinsicAttentionPPOLearner.IntrinsicAttentionPPOLearner'>, learner_connector=None, add_default_connectors_to_learner_pipeline=True, is_multi_agent=False, policies_to_update=['default_policy'], lr=0.0060984166342, num_total_minibatches=0, num_epochs=1, minibatch_size=1000, shuffle_batch_per_epoch=True)"], "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9485408017724, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.callbacks.callbacks.RLlibCallback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 52.61158204078674, "iterations_since_restore": 5, "perf": {"cpu_util_percent": 43.74285714285714, "ram_util_percent": 81.34285714285714}}
{"timers": {"training_iteration": 10.202120661293213, "restore_env_runners": 1.088273013386723e-05, "training_step": 10.201923864629856, "env_runner_sampling_timer": 1.8250040269918824, "learner_update_timer": 8.197195322561097, "synch_weights": 0.0015320670509333559, "restore_eval_env_runners": 7.922600702495197e-05, "evaluation_iteration": 0.2150458349283686, "synch_eval_env_connectors": 0.00022991975148649302, "synch_env_connectors": 5.143261154999491e-06}, "env_runners": {"num_env_steps_sampled": 5000.0, "episode_return_max": 12.5, "env_to_module_connector": {"timers": {"connectors": {"add_time_dim_to_batch_and_zero_pad": 9.867906824272991e-06, "add_observations_from_episodes_to_batch": 3.5755592417790954e-06, "batch_individual_items": 1.587749055620521e-05, "numpy_to_tensor": 1.784404888915978e-05, "add_states_from_episodes_to_batch": 3.2212372072273938e-06}}, "connector_pipeline_timer": 7.734761032836885e-05}, "episode_len_min": 20, "module_to_env_connector": {"timers": {"connectors": {"un_batch_to_individual_items": 8.258437503362622e-06, "normalize_and_clip_actions": 1.1522746529900681e-05, "remove_single_ts_time_rank_from_batch": 1.55211231702713e-05, "get_actions": 6.130819695614804e-05, "tensor_to_numpy": 2.1589010293112082e-05, "listify_data_for_vector_env": 1.3918655008786537e-05}}, "connector_pipeline_timer": 0.00016815220311015313}, "env_step_timer": 1.9512066839510803e-05, "num_agent_steps_sampled_lifetime": {"default_agent": -2460000.0}, "num_episodes": 250.0, "episode_duration_sec_mean": 0.007271548822056499, "episode_len_mean": 20.0, "module_episode_returns_mean": {"default_policy": 4.34}, "weights_seq_no": 5.0, "env_to_module_sum_episodes_length_out": 10.36823839457432, "num_env_steps_sampled_lifetime": -2460000.0, "episode_len_max": 20, "rlmodule_inference_timer": 4.480220519686376e-05, "num_agent_steps_sampled": {"default_agent": 5000.0}, "env_reset_timer": 5.9412928626194075e-05, "agent_episode_returns_mean": {"default_agent": 4.34}, "env_to_module_sum_episodes_length_in": 10.36823839457432, "episode_return_mean": 4.34, "time_between_sampling": 0.03341496736277621, "num_module_steps_sampled_lifetime": {"default_policy": -2460000.0}, "num_module_steps_sampled": {"default_policy": 5000.0}, "num_episodes_lifetime": -123000.0, "episode_return_min": -7.5, "sample": 0.00757693704738223, "num_env_steps_sampled_lifetime_throughput": 2752.6579144405055}, "__all_modules__": {"learner_connector_sum_episodes_length_in": 5000.0, "learner_connector": {"connector_pipeline_timer": 0.1391082500628793, "timers": {"connectors": {"add_one_ts_to_episodes_and_truncate": 0.009536803709509357, "add_observations_from_episodes_to_batch": 0.0010422250509275206, "add_columns_from_episodes_to_train_batch": 0.044084011949610924, "add_time_dim_to_batch_and_zero_pad": 0.07623426243776923, "add_states_from_episodes_to_batch": 0.0035808531984082258, "batch_individual_items": 0.004365589788254402, "numpy_to_tensor": 7.296958308047325e-05}}}, "learner_connector_sum_episodes_length_out": 5250.0}, "learners": {"__all_modules__": {"num_module_steps_trained_lifetime": 71820, "num_env_steps_trained": 33000, "num_env_steps_trained_lifetime": 198000, "num_non_trainable_parameters": 0, "num_trainable_parameters": 24861, "num_module_steps_trained": 11970, "num_env_steps_trained_lifetime_throughput": 3950.302829804453, "num_module_steps_trained_throughput": 28189286.340114646, "num_module_steps_trained_lifetime_throughput": 12857397.877950175}, "default_policy": {"curr_entropy_coeff": 0.0015431216992, "weights_seq_no": 6.0, "curr_kl_coeff": 0.0025247489102184772, "policy_loss": -0.00032377117895521224, "module_train_batch_size_mean": 997.8474438281662, "num_trainable_parameters": 16595, "vf_loss": 0.3583185076713562, "mean_kl_loss": 1.8645730960997753e-05, "diff_num_grad_updates_vs_sampler_policy": 1.0, "vf_explained_var": 0.0004401206970214844, "use_intrinsic_rewards": 0.0, "entropy": 0.6856217384338379, "num_module_steps_trained": 5985, "vf_loss_unclipped": 44.236934661865234, "total_loss": 0.27776670455932617, "num_module_steps_trained_lifetime": 35910, "num_module_steps_trained_lifetime_throughput": 716.1646033034352}, "differentiable_learners": {"intrinsic_attention_ppo_learner": {"__all_modules__": {"num_module_steps_trained_lifetime": 430920, "num_env_steps_trained_lifetime": 1188000, "num_module_steps_trained": 71820, "num_env_steps_trained": 198000, "num_env_steps_trained_lifetime_throughput": 50807.656937864405}, "default_policy": {"weights_seq_no": 36.0, "policy_loss": -0.0003093261329922825, "module_train_batch_size_mean": 997.5548130830801, "vf_loss": 0.3583163321018219, "mean_kl_loss": 1.6949172277236357e-05, "diff_num_grad_updates_vs_sampler_policy": 31.0, "vf_explained_var": 0.0027711987495422363, "use_intrinsic_rewards": 1.0, "entropy": 0.6856562495231628, "num_module_steps_trained": 35910, "vf_loss_unclipped": 44.174903869628906, "total_loss": 0.27778205275535583, "num_module_steps_trained_lifetime": 215460}, "intrinsic_reward_module": {"total_loss": 0.0, "num_module_steps_trained_lifetime": 215460, "module_train_batch_size_mean": 997.5548130830801, "weights_seq_no": 36.0, "num_module_steps_trained": 35910, "diff_num_grad_updates_vs_sampler_policy": 31.0}}}, "intrinsic_reward_module": {"diff_num_grad_updates_vs_sampler_policy": 1.0, "gradients_default_optimizer_global_norm": 0.0, "curr_entropy_coeff": 0.0015431216992, "weights_seq_no": 6.0, "default_optimizer_learning_rate": 0.0002715581955, "total_loss": 0.0, "num_module_steps_trained_lifetime": 35910, "module_train_batch_size_mean": 997.8474438281662, "num_trainable_parameters": 8266, "num_module_steps_trained": 5985, "num_module_steps_trained_lifetime_throughput": 716.1756061187139}, "IntrinsicAttentionMask": [[[0.08856792747974396, 0.09057994186878204, 0.09050538390874863, 0.09043088555335999, 0.09148215502500534, 0.09225206822156906, 0.09217613190412521, 0.09013351052999496, 0.09089207649230957, 0.09194870293140411, 0.0910312756896019], [0.08725327253341675, 0.09038742631673813, 0.09027056396007538, 0.09015386551618576, 0.0918058231472969, 0.09302257746458054, 0.09290231764316559, 0.08968853950500488, 0.0908772274851799, 0.09254244714975357, 0.09109597653150558], [0.08730117976665497, 0.0903945341706276, 0.0902792289853096, 0.09016406536102295, 0.09179400652647018, 0.09299428015947342, 0.0928756520152092, 0.08970487117767334, 0.09087783098220825, 0.09252067655324936, 0.09109365940093994], [0.08734910190105438, 0.09040164202451706, 0.09028787165880203, 0.09017425030469894, 0.09178216755390167, 0.0929659828543663, 0.0928489938378334, 0.0897211953997612, 0.090878427028656, 0.09249890595674515, 0.0910913422703743], [0.08667831867933273, 0.09030144661664963, 0.09016598761081696, 0.090030737221241, 0.09194780886173248, 0.09336337447166443, 0.09322332590818405, 0.08949175477027893, 0.09086950123310089, 0.0928044393658638, 0.09112335741519928], [0.08619456738233566, 0.09022823721170425, 0.09007708728313446, 0.08992619067430496, 0.09206747263669968, 0.09365194290876389, 0.09349505603313446, 0.08932512998580933, 0.09086240828037262, 0.09302597492933273, 0.09114595502614975], [0.08624200522899628, 0.09023545682430267, 0.09008584171533585, 0.08993648737668991, 0.09205573052167892, 0.0936235710978508, 0.09346834570169449, 0.08934150636196136, 0.09086312353610992, 0.09300421178340912, 0.09114374965429306], [0.08754105865955353, 0.09043005108833313, 0.09032247960567474, 0.0902150347828865, 0.0917348563671112, 0.0928528755903244, 0.092742420732975, 0.08978653699159622, 0.09088081121444702, 0.09241184592247009, 0.09108205884695053], [0.08705336600542068, 0.09035765379667282, 0.09023433178663254, 0.09011118859052658, 0.09185516089200974, 0.09314080327749252, 0.0930136889219284, 0.08962026983499527, 0.09087462723255157, 0.09263338148593903, 0.09110555797815323], [0.08638443052768707, 0.09025706350803375, 0.09011207520961761, 0.08996732532978058, 0.09202047437429428, 0.09353847801685333, 0.09338822215795517, 0.08939063549041748, 0.09086525440216064, 0.09293889999389648, 0.0911371260881424], [0.08696455508470535, 0.0903443917632103, 0.0902181938290596, 0.09009218215942383, 0.09187709540128708, 0.093193419277668, 0.09306325018405914, 0.08958989381790161, 0.09087344259023666, 0.09267383068799973, 0.09110979735851288]], [[0.08987059444189072, 0.0897698774933815, 0.0908002033829689, 0.08956877887248993, 0.08946840465068817, 0.09203394502401352, 0.09078578650951385, 0.0902925580739975, 0.1015956774353981, 0.08952748030424118, 0.08628668636083603], [0.08988752216100693, 0.08978834003210068, 0.09080294519662857, 0.08959028869867325, 0.08949142694473267, 0.09201762825250626, 0.09078874439001083, 0.09030306339263916, 0.10142343491315842, 0.08954961597919464, 0.08635695278644562], [0.08971375226974487, 0.08959903568029404, 0.09077343344688416, 0.08937004208564758, 0.08925576508045197, 0.09218216687440872, 0.09075698256492615, 0.09019456058740616, 0.10318829119205475, 0.0893230214715004, 0.0856429785490036], [0.08992131054401398, 0.08982517570257187, 0.09080833941698074, 0.08963322639465332, 0.08953741192817688, 0.09198491275310516, 0.09079458564519882, 0.09032399207353592, 0.10107972472906113, 0.089593805372715, 0.08649757504463196], [0.08993814140558243, 0.08984354138374329, 0.09081096947193146, 0.08965463936328888, 0.08956034481525421, 0.09196849167346954, 0.09079743176698685, 0.09033439308404922, 0.10090823471546173, 0.0896158516407013, 0.08656790107488632], [0.08950410038232803, 0.08937110751867294, 0.09073390811681747, 0.08910571783781052, 0.08897331357002258, 0.09237239509820938, 0.09071480482816696, 0.09006181359291077, 0.10530969500541687, 0.08905123174190521, 0.08480188995599747], [0.08971618860960007, 0.08960168808698654, 0.09077387303113937, 0.08937312662601471, 0.0892590582370758, 0.09217989444732666, 0.09075745195150375, 0.09019609540700912, 0.10316354781389236, 0.08932619541883469, 0.08565288782119751], [0.08979952335357666, 0.08969242870807648, 0.09078837931156158, 0.08947861939668655, 0.08937190473079681, 0.09210174530744553, 0.09077303111553192, 0.09024828672409058, 0.1023179441690445, 0.08943470567464828, 0.08599342405796051], [0.08782871067523956, 0.08756504952907562, 0.09028581529855728, 0.08704010397195816, 0.08677881211042404, 0.09361269325017929, 0.09024737775325775, 0.08893874287605286, 0.12202037870883942, 0.08693253248929977, 0.07874971628189087], [0.08992823958396912, 0.08983273804187775, 0.0908094272017479, 0.08964204043149948, 0.08954685181379318, 0.09197816252708435, 0.09079575538635254, 0.09032826870679855, 0.10100916028022766, 0.08960287272930145, 0.08652649819850922], [0.09046564996242523, 0.09042081981897354, 0.09087814390659332, 0.09033121913671494, 0.09028644859790802, 0.09142196178436279, 0.09087175875902176, 0.09065317362546921, 0.09550533443689346, 0.09031280130147934, 0.08885268121957779]], [[0.08856894820928574, 0.09058099240064621, 0.09163400530815125, 0.09155857563018799, 0.0914832130074501, 0.09111794084310532, 0.09104294329881668, 0.0912574827671051, 0.0920255109667778, 0.09081830829381943, 0.08991215378046036], [0.08725576102733612, 0.09039000421762466, 0.09204629808664322, 0.09192728996276855, 0.09180844575166702, 0.09123321622610092, 0.09111526608467102, 0.09145281463861465, 0.09266488999128342, 0.09076232463121414, 0.08934367448091507], [0.08658656477928162, 0.09029072523117065, 0.09225796908140182, 0.09211640805006027, 0.09197505563497543, 0.0912914127111435, 0.09115132689476013, 0.09155230969190598, 0.09299440681934357, 0.09073236584663391, 0.08905141800642014], [0.08663410693407059, 0.09029782563447952, 0.09224291145801544, 0.09210295230150223, 0.09196320921182632, 0.0912872925400734, 0.09114878624677658, 0.09154524654150009, 0.09297092258930206, 0.09073452651500702, 0.08907224237918854], [0.08668166399002075, 0.0903049185872078, 0.09222783148288727, 0.09208949655294418, 0.09195134788751602, 0.0912831723690033, 0.09114623814821243, 0.09153818339109421, 0.09294743835926056, 0.09073668718338013, 0.08909306675195694], [0.08691300451755524, 0.09033931791782379, 0.09215457737445831, 0.0920240506529808, 0.09189370274543762, 0.0912630707025528, 0.09113380312919617, 0.09150377660989761, 0.09283334761857986, 0.09074710309505463, 0.08919420093297958], [0.08696070313453674, 0.09034640341997147, 0.09213950484991074, 0.09201058000326157, 0.09188184142112732, 0.0912589281797409, 0.09113124012947083, 0.09149669855833054, 0.09280987828969955, 0.09074924141168594, 0.08921502530574799], [0.0868244469165802, 0.09032616764307022, 0.09218259900808334, 0.09204908460378647, 0.09191575646400452, 0.09127076715230942, 0.0911385640501976, 0.09151694923639297, 0.09287697821855545, 0.09074312448501587, 0.08915551006793976], [0.08634084463119507, 0.09025394916534424, 0.09233598411083221, 0.09218607097864151, 0.0920364037156105, 0.0913126990199089, 0.09116444736719131, 0.09158884733915329, 0.09311605989933014, 0.09072113037109375, 0.08894368261098862], [0.08710388839244843, 0.09036759287118912, 0.09209424257278442, 0.09197014570236206, 0.09184620529413223, 0.09124645590782166, 0.09112349897623062, 0.09147540479898453, 0.09273945540189743, 0.09075561165809631, 0.08927749842405319], [0.0876871719956398, 0.09045329689979553, 0.09191039204597473, 0.09180581569671631, 0.09170134365558624, 0.0911955013871193, 0.09109172970056534, 0.09138865768909454, 0.09245378524065018, 0.09078112244606018, 0.08953115344047546]], [[0.09232652932405472, 0.09224411845207214, 0.09184475988149643, 0.09207950532436371, 0.09077027440071106, 0.09159902483224869, 0.09183314442634583, 0.09143557399511337, 0.08337593078613281, 0.09204568713903427, 0.09044547379016876], [0.09229961037635803, 0.0922188088297844, 0.09182725846767426, 0.09205742180347443, 0.09077358990907669, 0.09158630669116974, 0.09181586652994156, 0.09142602235078812, 0.08351584523916245, 0.09202426671981812, 0.09045504033565521], [0.09216857701539993, 0.09209560602903366, 0.0917418971657753, 0.09194982796907425, 0.09078934788703918, 0.0915241613984108, 0.09173160791397095, 0.09137929230928421, 0.08419861644506454, 0.09191987663507462, 0.09050115942955017], [0.09224571287631989, 0.09216813743114471, 0.09179217368364334, 0.09201318025588989, 0.09078014642000198, 0.09156078100204468, 0.09178123623132706, 0.09140684455633163, 0.08379629999399185, 0.09198134392499924, 0.09047408401966095], [0.0918111503124237, 0.09175930172204971, 0.09150781482458115, 0.09165569394826889, 0.09082916378974915, 0.09135286509990692, 0.09150049090385437, 0.09124971181154251, 0.08607597649097443, 0.09163440018892288, 0.09062344580888748], [0.09208746999502182, 0.09201931953430176, 0.09168893843889236, 0.09188316762447357, 0.09079879522323608, 0.09148552268743515, 0.09167931973934174, 0.09135016053915024, 0.08462274819612503, 0.09185519069433212, 0.09052936732769012], [0.09216475486755371, 0.09209200739860535, 0.09173940122127533, 0.09194669127464294, 0.0907898023724556, 0.09152234345674515, 0.09172914177179337, 0.09137792140245438, 0.08421860635280609, 0.09191683679819107, 0.09050250053405762], [0.09203331172466278, 0.09196837246417999, 0.09165351837873459, 0.09183862805366516, 0.09080496430397034, 0.09145963937044144, 0.09164436161518097, 0.0913306176662445, 0.08490657061338425, 0.09181196987628937, 0.09054804593324661], [0.08913847804069519, 0.0892343744635582, 0.08970177173614502, 0.08942649513483047, 0.09098184108734131, 0.08999159932136536, 0.08971542865037918, 0.09018533676862717, 0.10078329592943192, 0.08946605026721954, 0.09137538820505142], [0.09223462641239166, 0.09215771406888962, 0.09178495407104492, 0.09200407564640045, 0.09078148007392883, 0.09155552834272385, 0.0917741060256958, 0.09140289574861526, 0.08385408669710159, 0.09197251498699188, 0.09047799557447433], [0.09170167148113251, 0.09165622293949127, 0.0914357528090477, 0.09156540036201477, 0.0908404290676117, 0.0912998765707016, 0.09142933785915375, 0.09120940417051315, 0.08665529638528824, 0.09154673665761948, 0.09065985679626465]], [[0.0889693945646286, 0.09099052846431732, 0.09091563522815704, 0.09084079414606094, 0.09076602011919022, 0.09152991324663162, 0.0925939530134201, 0.09054207056760788, 0.09130407124757767, 0.0912289172410965, 0.09031867235898972], [0.08787702023983002, 0.09103358536958694, 0.09091588854789734, 0.09079834818840027, 0.09068095684051514, 0.09188279509544373, 0.09356644749641418, 0.09032969921827316, 0.09152688831090927, 0.09140855073928833, 0.08997979760169983], [0.08791688084602356, 0.09103205054998398, 0.09091592580080032, 0.09079995006322861, 0.09068412333726883, 0.09186989068984985, 0.09353066980838776, 0.09033752232789993, 0.09151875972747803, 0.09140201658010483, 0.08999224752187729], [0.0879567340016365, 0.09103050827980042, 0.09091594815254211, 0.09080153703689575, 0.09068726748228073, 0.09185696393251419, 0.09349488466978073, 0.09034533053636551, 0.09151061624288559, 0.09139545261859894, 0.09000468254089355], [0.08799662441015244, 0.09102897346019745, 0.0909159854054451, 0.09080313891172409, 0.09069043397903442, 0.09184405207633972, 0.0934591293334961, 0.09035315364599228, 0.09150248765945435, 0.09138890355825424, 0.09001713246107101], [0.08759143203496933, 0.09104449301958084, 0.09091553837060928, 0.09078676253557205, 0.09065817296504974, 0.09197545796632767, 0.09382358938455582, 0.09027349203824997, 0.0915851816534996, 0.09145545959472656, 0.08989043533802032], [0.0870351493358612, 0.09106532484292984, 0.09091434627771378, 0.09076360613107681, 0.09061312675476074, 0.09215640276670456, 0.09432795643806458, 0.09016316384077072, 0.0916987732052803, 0.09154673665761948, 0.08971543610095978], [0.0881163477897644, 0.09102433174848557, 0.09091605246067047, 0.09080789983272552, 0.09069988131523132, 0.09180528670549393, 0.09335190057754517, 0.0903765857219696, 0.09147805720567703, 0.09136923402547836, 0.09005444496870041], [0.08771071583032608, 0.09103995561599731, 0.09091570973396301, 0.09079162776470184, 0.0906677171587944, 0.09193673729896545, 0.09371604770421982, 0.09029699862003326, 0.09156083315610886, 0.09143587201833725, 0.0899277999997139], [0.08775050193071365, 0.09103843569755554, 0.0909157544374466, 0.09079323709011078, 0.09067089110612869, 0.09192383289337158, 0.09368021786212921, 0.09030482918024063, 0.09155271202325821, 0.09142933785915375, 0.08994024991989136], [0.08823622018098831, 0.09101966768503189, 0.09091608971357346, 0.09081263840198517, 0.09070929884910583, 0.09176651388406754, 0.093244768679142, 0.09039999544620514, 0.09145360440015793, 0.0913495421409607, 0.0900917500257492]], [[0.09209761768579483, 0.09078812599182129, 0.0928555279970169, 0.09185120463371277, 0.09054521471261978, 0.09260708838701248, 0.09160545468330383, 0.09244183450937271, 0.08316920697689056, 0.0918174758553505, 0.09022122621536255], [0.09173621237277985, 0.09083360433578491, 0.0922568142414093, 0.09156667441129684, 0.09066573530435562, 0.0920863151550293, 0.09139744937419891, 0.09197281301021576, 0.0854993611574173, 0.09154345095157623, 0.09044160693883896], [0.09230189025402069, 0.09075895696878433, 0.09319669008255005, 0.09201125055551529, 0.09047317504882812, 0.0929032415151596, 0.09172152727842331, 0.09270811825990677, 0.0818614810705185, 0.09197147935628891, 0.09009221196174622], [0.09203044325113297, 0.09079717099666595, 0.09274377673864365, 0.09179845452308655, 0.09056828916072845, 0.09250998497009277, 0.09156705439090729, 0.09235446155071259, 0.08360075205564499, 0.09176669269800186, 0.09026294946670532], [0.09166796505451202, 0.09084132313728333, 0.0921444296836853, 0.09151273965835571, 0.09068750590085983, 0.09198840707540512, 0.09135778993368149, 0.0918845385313034, 0.08594173192977905, 0.09149148315191269, 0.09048210829496384], [0.09223531931638718, 0.09076874703168869, 0.09308528900146484, 0.0919591560959816, 0.0904969722032547, 0.09280658513307571, 0.09168381989002228, 0.09262124449014664, 0.08228691667318344, 0.091921366751194, 0.0901346206665039], [0.09196306765079498, 0.09080597013235092, 0.09263190627098083, 0.09174548089504242, 0.09059111773967743, 0.09241273999214172, 0.09152840822935104, 0.09226690977811813, 0.08403430879116058, 0.09171569347381592, 0.09030444920063019], [0.09219082444906235, 0.09077512472867966, 0.09301095455884933, 0.09192430973052979, 0.0905127003788948, 0.09274206310510635, 0.09165855497121811, 0.09256323426961899, 0.08257163316011429, 0.09188783168792725, 0.09016276150941849], [0.08939537405967712, 0.09095018357038498, 0.08851753920316696, 0.08968421816825867, 0.09124404937028885, 0.08880353718996048, 0.08997399359941483, 0.08899471908807755, 0.10107376426458359, 0.08972388505935669, 0.0916387289762497], [0.09202121198177338, 0.09079839289188385, 0.09272844344377518, 0.09179119765758514, 0.09057143330574036, 0.09249666333198547, 0.09156176447868347, 0.09234245866537094, 0.0836600661277771, 0.09175971150398254, 0.09026864916086197], [0.09157632291316986, 0.09085125476121902, 0.09199387580156326, 0.09144023805856705, 0.09071625024080276, 0.0918571725487709, 0.09130434691905975, 0.09176614880561829, 0.08653683960437775, 0.09142159670591354, 0.09053592383861542]]]}, "num_training_step_calls_per_iteration": 1, "evaluation": {"env_runners": {"episode_len_max": 20, "rlmodule_inference_timer": 3.320543644365794e-05, "num_module_steps_sampled": {"default_policy": 400}, "sample": 0.17255410328286888, "env_to_module_connector": {"timers": {"connectors": {"add_states_from_episodes_to_batch": 2.9763945605098983e-06, "add_time_dim_to_batch_and_zero_pad": 7.169958059159567e-06, "add_observations_from_episodes_to_batch": 2.9524213497733184e-06, "numpy_to_tensor": 1.2948836860274753e-05, "batch_individual_items": 1.2936575213483013e-05}}, "connector_pipeline_timer": 6.220927897591969e-05}, "module_episode_returns_mean": {"default_policy": -0.05}, "module_to_env_connector": {"timers": {"connectors": {"normalize_and_clip_actions": 8.097238135288082e-06, "remove_single_ts_time_rank_from_batch": 1.2074620531001718e-05, "tensor_to_numpy": 1.5656544186024226e-05, "listify_data_for_vector_env": 1.0632498919109386e-05, "un_batch_to_individual_items": 6.690871173964144e-06, "get_actions": 3.9674112337673086e-05}}, "connector_pipeline_timer": 0.00012011551204387697}, "episode_duration_sec_mean": 0.005997621238930151, "weights_seq_no": 6.0, "env_to_module_sum_episodes_length_out": 10.368238394470474, "agent_episode_returns_mean": {"default_agent": -0.05}, "episode_return_mean": -0.05, "env_to_module_sum_episodes_length_in": 10.368238394470474, "num_episodes_lifetime": 120, "num_agent_steps_sampled_lifetime": {"default_agent": 2400}, "num_episodes": 20, "episode_len_mean": 20.0, "num_agent_steps_sampled": {"default_agent": 400}, "num_module_steps_sampled_lifetime": {"default_policy": 2400}, "env_reset_timer": 0.002358006111628692, "episode_return_min": -16.5, "num_env_steps_sampled": 400, "episode_len_min": 20, "episode_return_max": 12.5, "env_step_timer": 1.4786821870155013e-05, "num_env_steps_sampled_lifetime": 30400, "time_between_sampling": 10.940608871690808}, "num_healthy_workers": 1, "actor_manager_num_outstanding_async_reqs": 0, "num_remote_worker_restarts": 0}, "num_env_steps_sampled_lifetime": -2460000.0, "fault_tolerance": {"num_healthy_workers": 0, "num_remote_worker_restarts": 0}, "env_runner_group": {"actor_manager_num_outstanding_async_reqs": 0}, "done": false, "training_iteration": 6, "trial_id": "b154b_00000", "date": "2025-08-11_18-12-28", "timestamp": 1754928748, "time_this_iter_s": 10.335032939910889, "time_total_s": 62.94661498069763, "pid": 10455, "hostname": "Mac", "node_ip": "127.0.0.1", "config": {"exploration_config": {}, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 2, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "env": "Umbrella", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": false, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 0, "create_local_env_runner": true, "num_envs_per_env_runner": 1, "gym_env_vectorize_mode": "SYNC", "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "episodes_to_numpy": true, "max_requests_in_flight_per_env_runner": 1, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "merge_env_runner_states": "training_only", "broadcast_env_runner_states": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "complete_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "sampler_perf_stats_ema_coef": null, "_is_online": true, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": "auto", "num_aggregator_actors_per_learner": 0, "max_requests_in_flight_per_aggregator_actor": 3, "local_gpu_idx": 0, "max_requests_in_flight_per_learner": 3, "gamma": 1, "lr": 0.0002715581955, "grad_clip": 0.5, "grad_clip_by": "global_norm", "_train_batch_size_per_learner": 5000, "train_batch_size": 4000, "num_epochs": 1, "minibatch_size": 1000, "shuffle_batch_per_epoch": true, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "log_std_clip_param": 20.0, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "_disable_preprocessor_api": false, "_disable_action_flattening": false}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {"intrinsic_reward_coeff": 0.2795015916508}, "optimizer": {}, "_learner_class": "<class 'source.intrinsic_attention_ppo.learners.IntrinsicAttentionMetaLearner.IntrinsicAttentionMetaLearner'>", "callbacks_on_algorithm_init": null, "callbacks_on_env_runners_recreated": null, "callbacks_on_offline_eval_runners_recreated": null, "callbacks_on_checkpoint_loaded": null, "callbacks_on_environment_created": null, "callbacks_on_episode_created": null, "callbacks_on_episode_start": null, "callbacks_on_episode_step": null, "callbacks_on_episode_end": null, "callbacks_on_evaluate_start": null, "callbacks_on_evaluate_end": null, "callbacks_on_evaluate_offline_start": null, "callbacks_on_evaluate_offline_end": null, "callbacks_on_sample_end": null, "callbacks_on_train_result": null, "explore": true, "enable_rl_module_and_learner": true, "enable_env_runner_and_connector_v2": true, "_prior_exploration_config": {"type": "StochasticSampling"}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x1514e58a0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "offline_data_class": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_read_batch_size": null, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "materialize_data": false, "materialize_mapped_data": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "ignore_final_observation": false, "prelearner_class": null, "prelearner_buffer_class": null, "prelearner_buffer_kwargs": {}, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_remaining_data": false, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": 1, "evaluation_duration": 20, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_auto_duration_min_env_steps_per_sample": 100, "evaluation_auto_duration_max_env_steps_per_sample": 2000, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 1, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "offline_evaluation_interval": null, "num_offline_eval_runners": 0, "offline_loss_for_module_fn": null, "offline_evaluation_duration": 1, "offline_evaluation_parallel_to_training": false, "offline_evaluation_timeout_s": 120.0, "num_cpus_per_offline_eval_runner": 1, "num_gpus_per_offline_eval_runner": 0, "custom_resources_per_offline_eval_runner": {}, "restart_failed_offline_eval_runners": true, "ignore_offline_eval_runner_failures": false, "max_num_offline_eval_runner_restarts": 1000, "offline_eval_runner_restore_timeout_s": 1800.0, "max_requests_in_flight_per_offline_eval_runner": 1, "validate_offline_eval_runners_after_construction": true, "offline_eval_runner_health_probe_timeout_s": 30.0, "offline_eval_rl_module_inference_only": false, "broadcast_offline_eval_runner_states": false, "offline_eval_batch_size_per_runner": 256, "dataset_num_iters_per_eval_runner": 1, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "log_gradients": false, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 4, "restart_failed_env_runners": true, "ignore_env_runner_failures": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30.0, "env_runner_restore_timeout_s": 1800.0, "_model_config": {}, "_rl_module_spec": "MultiRLModuleSpec(multi_rl_module_class=<class 'ray.rllib.core.rl_module.multi_rl_module.MultiRLModule'>, observation_space=None, action_space=None, inference_only=False, model_config=None, rl_module_specs={'default_policy': RLModuleSpec(module_class=<class 'source.intrinsic_attention_ppo.rl_modules.DifferentiablePPOModule.DifferentiablePPOModule'>, observation_space=None, action_space=None, inference_only=False, learner_only=False, model_config={'vf_share_layers': True, 'embedding_dim': 62, 'max_seq_len': 11, 'policy_head_hidden_sizes': [32], 'value_head_hidden_sizes': [101], 'embedding_hidden_sizes': [121]}, catalog_class=None, load_state_path=None, model_config_dict=None), 'intrinsic_reward_module': RLModuleSpec(module_class=<class 'source.intrinsic_attention_ppo.rl_modules.IntrinsicAttentionModule.IntrinsicAttentionModule'>, observation_space=None, action_space=None, inference_only=False, learner_only=True, model_config={'intrinsic_reward_network': {'encoder_hidden_sizes': [], 'encoding_dim': 1, 'num_heads': 1, 'head_hidden_sizes': None, 'layers': [{'type': 'attention'}]}, 'extrinsic_value_hidden_layers': [127, 60], 'vf_share_layers': True, 'max_seq_len': 11}, catalog_class=None, load_state_path=None, model_config_dict=None)}, load_state_path=None, modules_to_load=None, module_specs={'default_policy': RLModuleSpec(module_class=<class 'source.intrinsic_attention_ppo.rl_modules.DifferentiablePPOModule.DifferentiablePPOModule'>, observation_space=None, action_space=None, inference_only=False, learner_only=False, model_config={'vf_share_layers': True, 'embedding_dim': 62, 'max_seq_len': 11, 'policy_head_hidden_sizes': [32], 'value_head_hidden_sizes': [101], 'embedding_hidden_sizes': [121]}, catalog_class=None, load_state_path=None, model_config_dict=None), 'intrinsic_reward_module': RLModuleSpec(module_class=<class 'source.intrinsic_attention_ppo.rl_modules.IntrinsicAttentionModule.IntrinsicAttentionModule'>, observation_space=None, action_space=None, inference_only=False, learner_only=True, model_config={'intrinsic_reward_network': {'encoder_hidden_sizes': [], 'encoding_dim': 1, 'num_heads': 1, 'head_hidden_sizes': None, 'layers': [{'type': 'attention'}]}, 'extrinsic_value_hidden_layers': [127, 60], 'vf_share_layers': True, 'max_seq_len': 11}, catalog_class=None, load_state_path=None, model_config_dict=None)})", "algorithm_config_overrides_per_module": {"intrinsic_reward_module": {"lr": 0.0002715581955}}, "_per_module_overrides": {}, "_validate_config": true, "_use_msgpack_checkpoints": false, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "env_task_fn": -1, "enable_connectors": -1, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.161583927863, "kl_target": 0.0201019014258, "vf_loss_coeff": 0.7790510010087, "entropy_coeff": 0.0015431216992, "clip_param": 0.2459212356676, "vf_clip_param": 0.3769744131561, "entropy_coeff_schedule": null, "lr_schedule": null, "sgd_minibatch_size": -1, "vf_share_layers": -1, "differentiable_learner_configs": ["DifferentiableLearnerConfig(learner_class=<class 'source.intrinsic_attention_ppo.learners.IntrinsicAttentionPPOLearner.IntrinsicAttentionPPOLearner'>, learner_connector=None, add_default_connectors_to_learner_pipeline=True, is_multi_agent=False, policies_to_update=['default_policy'], lr=0.0060984166342, num_total_minibatches=0, num_epochs=1, minibatch_size=1000, shuffle_batch_per_epoch=True)"], "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9485408017724, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.callbacks.callbacks.RLlibCallback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 62.94661498069763, "iterations_since_restore": 6, "perf": {"cpu_util_percent": 47.66666666666666, "ram_util_percent": 81.28}}
{"timers": {"training_iteration": 10.200065239260262, "restore_env_runners": 1.0835152425801363e-05, "training_step": 10.199866769323938, "env_runner_sampling_timer": 1.823279230051779, "learner_update_timer": 8.196826785175558, "synch_weights": 0.0015271197108662573, "restore_eval_env_runners": 7.851083601666302e-05, "evaluation_iteration": 0.21423029616865658, "synch_eval_env_connectors": 0.0002291138843180485, "synch_env_connectors": 5.1376589273463235e-06}, "env_runners": {"num_env_steps_sampled": 5000.0, "episode_return_max": 12.5, "env_to_module_connector": {"timers": {"connectors": {"add_time_dim_to_batch_and_zero_pad": 7.275502267228667e-06, "add_observations_from_episodes_to_batch": 2.9462074823118522e-06, "batch_individual_items": 1.311317059201445e-05, "numpy_to_tensor": 1.356703336402657e-05, "add_states_from_episodes_to_batch": 2.84787569089822e-06}}, "connector_pipeline_timer": 6.301345366767977e-05}, "episode_len_min": 20, "module_to_env_connector": {"timers": {"connectors": {"un_batch_to_individual_items": 6.959239269019027e-06, "normalize_and_clip_actions": 8.423645263767071e-06, "remove_single_ts_time_rank_from_batch": 1.2442604906985202e-05, "get_actions": 4.3211536564047374e-05, "tensor_to_numpy": 1.589843318265222e-05, "listify_data_for_vector_env": 1.1243531037240843e-05}}, "connector_pipeline_timer": 0.00012605400888729778}, "env_step_timer": 1.487368608017604e-05, "num_agent_steps_sampled_lifetime": {"default_agent": -3077500.0}, "num_episodes": 250.0, "episode_duration_sec_mean": 0.005637751530390235, "episode_len_mean": 20.0, "module_episode_returns_mean": {"default_policy": 3.5400000000000005}, "weights_seq_no": 6.0, "env_to_module_sum_episodes_length_out": 10.36823839457432, "num_env_steps_sampled_lifetime": -3077500.0, "episode_len_max": 20, "rlmodule_inference_timer": 3.430041302994718e-05, "num_agent_steps_sampled": {"default_agent": 5000.0}, "env_reset_timer": 5.060354922396085e-05, "agent_episode_returns_mean": {"default_agent": 3.5400000000000005}, "env_to_module_sum_episodes_length_in": 10.36823839457432, "episode_return_mean": 3.5400000000000005, "time_between_sampling": 0.033507060617433776, "num_module_steps_sampled_lifetime": {"default_policy": -3077500.0}, "num_module_steps_sampled": {"default_policy": 5000.0}, "num_episodes_lifetime": -153875.0, "episode_return_min": -7.5, "sample": 0.006253048098728291, "num_env_steps_sampled_lifetime_throughput": 3053.6535898903053}, "__all_modules__": {"learner_connector_sum_episodes_length_in": 5000.0, "learner_connector": {"connector_pipeline_timer": 0.1390514100628481, "timers": {"connectors": {"add_one_ts_to_episodes_and_truncate": 0.009532385672281271, "add_observations_from_episodes_to_batch": 0.0010403552997665432, "add_columns_from_episodes_to_train_batch": 0.04405858515972541, "add_time_dim_to_batch_and_zero_pad": 0.07621230897373779, "add_states_from_episodes_to_batch": 0.0035831105069143057, "batch_individual_items": 0.00436106389030376, "numpy_to_tensor": 7.279113708158342e-05}}}, "learner_connector_sum_episodes_length_out": 5250.0}, "learners": {"__all_modules__": {"num_module_steps_trained_lifetime": 83790, "num_env_steps_trained": 33000, "num_env_steps_trained_lifetime": 231000, "num_non_trainable_parameters": 0, "num_trainable_parameters": 24861, "num_module_steps_trained": 11970, "num_env_steps_trained_lifetime_throughput": 3941.5671980721863, "num_module_steps_trained_throughput": 27389599.879644398, "num_module_steps_trained_lifetime_throughput": 12800542.669148192}, "default_policy": {"curr_entropy_coeff": 0.0015431216992, "weights_seq_no": 7.0, "curr_kl_coeff": 0.0012623744551092386, "policy_loss": -0.00014559261035174131, "module_train_batch_size_mean": 997.82696443245, "num_trainable_parameters": 16595, "vf_loss": 0.35831353068351746, "mean_kl_loss": 4.52847689302871e-06, "diff_num_grad_updates_vs_sampler_policy": 1.0, "vf_explained_var": -0.0005350112915039062, "use_intrinsic_rewards": 0.0, "entropy": 0.6853422522544861, "num_module_steps_trained": 5985, "vf_loss_unclipped": 43.9207649230957, "total_loss": 0.27794137597084045, "num_module_steps_trained_lifetime": 41895, "num_module_steps_trained_lifetime_throughput": 714.5892887924625}, "differentiable_learners": {"intrinsic_attention_ppo_learner": {"__all_modules__": {"num_module_steps_trained_lifetime": 502740, "num_env_steps_trained_lifetime": 1386000, "num_module_steps_trained": 71820, "num_env_steps_trained": 198000, "num_env_steps_trained_lifetime_throughput": 50038.165527946294}, "default_policy": {"weights_seq_no": 42.0, "policy_loss": -0.00013392241089604795, "module_train_batch_size_mean": 997.5374097747205, "vf_loss": 0.35831785202026367, "mean_kl_loss": 3.7918889574939385e-06, "diff_num_grad_updates_vs_sampler_policy": 36.0, "vf_explained_var": 0.0027273893356323242, "use_intrinsic_rewards": 1.0, "entropy": 0.6853737235069275, "num_module_steps_trained": 35910, "vf_loss_unclipped": 43.827457427978516, "total_loss": 0.27795693278312683, "num_module_steps_trained_lifetime": 251370}, "intrinsic_reward_module": {"total_loss": 0.0, "num_module_steps_trained_lifetime": 251370, "module_train_batch_size_mean": 997.5374097747205, "weights_seq_no": 42.0, "num_module_steps_trained": 35910, "diff_num_grad_updates_vs_sampler_policy": 36.0}}}, "intrinsic_reward_module": {"diff_num_grad_updates_vs_sampler_policy": 1.0, "gradients_default_optimizer_global_norm": 0.0, "curr_entropy_coeff": 0.0015431216992, "weights_seq_no": 7.0, "default_optimizer_learning_rate": 0.0002715581955, "total_loss": 0.0, "num_module_steps_trained_lifetime": 41895, "module_train_batch_size_mean": 997.82696443245, "num_trainable_parameters": 8266, "num_module_steps_trained": 5985, "num_module_steps_trained_lifetime_throughput": 714.5997152430004}, "IntrinsicAttentionMask": [[[0.08856769651174545, 0.09170819073915482, 0.09163270890712738, 0.09155727922916412, 0.09035621583461761, 0.09111665934324265, 0.09217589348554611, 0.09013327956199646, 0.09202420711517334, 0.09081701934337616, 0.08991088718175888], [0.08653470873832703, 0.09241180121898651, 0.09226840734481812, 0.09212523698806763, 0.0898595005273819, 0.09129094332456589, 0.09330255538225174, 0.08944184333086014, 0.0930132269859314, 0.09072564542293549, 0.08902613818645477], [0.08658232539892197, 0.09239523112773895, 0.09225345402956009, 0.09211189299821854, 0.08987131714820862, 0.09128693491220474, 0.09327588975429535, 0.08945823460817337, 0.09298984706401825, 0.09072791785001755, 0.08904705941677094], [0.0866299420595169, 0.0923786386847496, 0.09223847836256027, 0.09209852665662766, 0.08988311886787415, 0.0912829115986824, 0.09324920922517776, 0.08947461098432541, 0.0929664596915245, 0.09073017537593842, 0.0890679657459259], [0.08739656209945679, 0.09211239963769913, 0.09199806302785873, 0.09188387542963028, 0.09007200598716736, 0.0912177562713623, 0.09282182157039642, 0.08973702788352966, 0.0925915464758873, 0.09076571464538574, 0.08940329402685165], [0.08690936863422394, 0.09228143095970154, 0.0921507254242897, 0.0920201987028122, 0.08995222300291061, 0.09125924855470657, 0.09309299290180206, 0.0895705372095108, 0.09282945841550827, 0.0907433032989502, 0.08919046819210052], [0.08624111115932465, 0.09251417964696884, 0.09236079454421997, 0.0922076627612114, 0.08978644013404846, 0.09131564199924469, 0.09346738457679749, 0.08934058994054794, 0.09315770119428635, 0.09071154147386551, 0.08889694511890411], [0.08754058182239532, 0.09206251055002213, 0.09195299446582794, 0.0918436124920845, 0.09010723233222961, 0.0912054181098938, 0.09274192154407501, 0.08978604525327682, 0.09252140671014786, 0.09077221155166626, 0.08946601301431656], [0.08633607625961304, 0.09248104691505432, 0.09233089536428452, 0.09218098968267441, 0.08981011062860489, 0.09130766242742538, 0.09341400861740112, 0.089373379945755, 0.09311092644929886, 0.09071613103151321, 0.08893877267837524], [0.08710058778524399, 0.09221502393484116, 0.09209076315164566, 0.0919666588306427, 0.08999935537576675, 0.09124301373958588, 0.09298638999462128, 0.08963600546121597, 0.09273595362901688, 0.09075217694044113, 0.08927412331104279], [0.08768481016159058, 0.09201262146234512, 0.09190791845321655, 0.09180334210395813, 0.09014243632555008, 0.09119304269552231, 0.09266205877065659, 0.08983506262302399, 0.0924512967467308, 0.09077867120504379, 0.08952874690294266]], [[0.0893252044916153, 0.09074217081069946, 0.09024917334318161, 0.090538889169693, 0.09043742716312408, 0.09147541970014572, 0.09023483842611313, 0.09127050638198853, 0.10097913444042206, 0.0889841690659523, 0.08576305210590363], [0.08896995335817337, 0.09068873524665833, 0.0900900661945343, 0.09044180810451508, 0.09031859785318375, 0.09158045053482056, 0.09007266908884048, 0.0913311019539833, 0.10327435284852982, 0.0885571613907814, 0.08467517048120499], [0.08909346908330917, 0.09070795029401779, 0.09014582633972168, 0.0904761254787445, 0.09036043286323547, 0.09154481440782547, 0.09012948721647263, 0.09131084382534027, 0.10247485339641571, 0.08870543539524078, 0.08505083620548248], [0.08902087062597275, 0.09069673717021942, 0.09011311084032059, 0.090456023812294, 0.0903359055519104, 0.09156587719917297, 0.09009615331888199, 0.09132285416126251, 0.10294458270072937, 0.08861826360225677, 0.08482970297336578], [0.08904628455638885, 0.0907006785273552, 0.09012457728385925, 0.0904630720615387, 0.09034450352191925, 0.09155852347612381, 0.09010782837867737, 0.09131866693496704, 0.10278002172708511, 0.08864876627922058, 0.08490701764822006], [0.08878641575574875, 0.09065894782543182, 0.09000635892152786, 0.09038972854614258, 0.09025542438030243, 0.09163171052932739, 0.08998740464448929, 0.09135960787534714, 0.10446528345346451, 0.08833718299865723, 0.08412191271781921], [0.08909706026315689, 0.09070850163698196, 0.09014743566513062, 0.0904771089553833, 0.09036163985729218, 0.0915437564253807, 0.09013113379478455, 0.09131024032831192, 0.1024516224861145, 0.088709756731987, 0.08506179600954056], [0.08883768320083618, 0.09066741913557053, 0.09002984315156937, 0.09040440618991852, 0.0902731865644455, 0.09161759167909622, 0.09001132100820541, 0.09135182201862335, 0.10413224250078201, 0.08839858323335648, 0.08427587151527405], [0.08642859756946564, 0.09015380591154099, 0.08884652704000473, 0.08961333334445953, 0.0893443152308464, 0.09212036430835724, 0.08880869299173355, 0.09156810492277145, 0.12007522583007812, 0.08554670214653015, 0.07749433070421219], [0.08941081911325455, 0.09075421094894409, 0.09028694033622742, 0.09056155383586884, 0.09046538174152374, 0.09144895523786545, 0.09027335047721863, 0.0912548303604126, 0.10042799264192581, 0.08908732980489731, 0.08602865040302277], [0.09022152423858643, 0.09085144102573395, 0.09063290804624557, 0.09076141566038132, 0.09071643650531769, 0.09117525070905685, 0.0906265377998352, 0.09108490496873856, 0.09524761140346527, 0.09006908535957336, 0.08861290663480759]], [[0.09167491644620895, 0.09009706974029541, 0.09147662669420242, 0.09137764573097229, 0.08980491012334824, 0.09079991281032562, 0.09070165455341339, 0.09098277986049652, 0.09050547331571579, 0.09189128875732422, 0.09068775177001953], [0.09147918224334717, 0.09030409902334213, 0.09133179485797882, 0.09125819057226181, 0.0900859460234642, 0.09082817286252975, 0.09075497835874557, 0.09096436202526093, 0.09060875326395035, 0.0916399136185646, 0.09074460715055466], [0.09165049344301224, 0.09012287110090256, 0.09145856648683548, 0.09136274456977844, 0.08983992040157318, 0.09080344438552856, 0.09070831537246704, 0.09098049253225327, 0.09051835536956787, 0.09185990691184998, 0.0906948521733284], [0.09163828939199448, 0.09013579040765762, 0.09144953638315201, 0.09135530889034271, 0.08985744416713715, 0.09080521762371063, 0.09071165323257446, 0.09097935259342194, 0.09052480757236481, 0.09184423089027405, 0.09069840610027313], [0.09144257754087448, 0.09034285694360733, 0.09130468964576721, 0.09123582392930984, 0.09013859182596207, 0.09083342552185059, 0.09076491743326187, 0.09096088260412216, 0.09062805771827698, 0.0915929302573204, 0.09075522422790527], [0.0915667712688446, 0.0902114063501358, 0.09139662235975266, 0.09131167083978653, 0.08996008336544037, 0.09081555902957916, 0.09073113650083542, 0.09097263962030411, 0.09056254476308823, 0.09175237268209457, 0.09071918576955795], [0.09155457466840744, 0.09022432565689087, 0.09138759970664978, 0.0913042202591896, 0.08997761458158493, 0.09081731736660004, 0.09073446691036224, 0.09097149223089218, 0.09056898951530457, 0.09173670411109924, 0.09072273224592209], [0.09158945828676224, 0.09018741548061371, 0.09141340851783752, 0.09132551401853561, 0.08992750942707062, 0.09081228077411652, 0.09072495996952057, 0.09097477048635483, 0.09055057168006897, 0.09178150445222855, 0.09071259945631027], [0.09153016656637192, 0.0902501568198204, 0.09136953949928284, 0.09128932654857635, 0.09001268446445465, 0.09082084149122238, 0.0907411128282547, 0.09096919000148773, 0.09058187156915665, 0.09170536696910858, 0.09072983264923096], [0.09170151501893997, 0.09006898105144501, 0.0914963036775589, 0.0913938581943512, 0.08976680040359497, 0.09079605340957642, 0.09069440513849258, 0.0909852609038353, 0.09049143642187119, 0.09192545711994171, 0.09068001806735992], [0.09155284613370895, 0.09022615104913712, 0.09138631820678711, 0.09130316972732544, 0.0899800956249237, 0.09081756323575974, 0.09073493629693985, 0.09097132831811905, 0.09056990593671799, 0.09173448383808136, 0.09072323888540268]], [[0.09254252165555954, 0.09122669696807861, 0.09205962717533112, 0.09229491651058197, 0.09098262339830399, 0.09181331843137741, 0.09204798191785812, 0.09288839995861053, 0.0824563279747963, 0.09103047102689743, 0.0906570628285408], [0.09204316884279251, 0.09113754332065582, 0.09171128273010254, 0.09187306463718414, 0.09096910804510117, 0.09154178947210312, 0.09170327335596085, 0.0922805666923523, 0.08499377965927124, 0.09100213646888733, 0.09074422717094421], [0.0923607349395752, 0.09119506180286407, 0.09193316102027893, 0.0921415314078331, 0.09097862988710403, 0.09171497076749802, 0.09192284941673279, 0.09266683459281921, 0.08337529003620148, 0.09102105349302292, 0.09068983793258667], [0.09244951605796814, 0.09121063351631165, 0.09199497848749161, 0.09221647679805756, 0.09098070859909058, 0.09176307171583176, 0.09198401123285294, 0.09277500957250595, 0.08292576670646667, 0.09102578461170197, 0.09067397564649582], [0.09194913506507874, 0.09111996740102768, 0.09164535254240036, 0.09179344773292542, 0.09096568077802658, 0.09149016439914703, 0.09163801372051239, 0.09216637909412384, 0.08547624200582504, 0.09099593758583069, 0.09075964987277985], [0.09226736426353455, 0.09117845445871353, 0.09186805039644241, 0.09206266701221466, 0.09097617119550705, 0.09166423976421356, 0.09185841679573059, 0.09255316108465195, 0.0838494673371315, 0.09101583063602448, 0.09070621430873871], [0.09235633164644241, 0.091194286942482, 0.0919300988316536, 0.09213781356811523, 0.09097851812839508, 0.091712586581707, 0.09191981703042984, 0.09266147762537003, 0.08339763432741165, 0.09102082252502441, 0.09069062024354935], [0.0926717072725296, 0.09124861657619476, 0.09214925020933151, 0.09240379184484482, 0.09098482877016068, 0.0918828547000885, 0.09213665872812271, 0.09304605424404144, 0.08180665224790573, 0.09103652834892273, 0.09063305705785751], [0.08835522085428238, 0.09026632457971573, 0.08904866874217987, 0.08870965242385864, 0.09062842279672623, 0.08940587937831879, 0.08906550705432892, 0.08786404132843018, 0.10498389601707458, 0.09055726230144501, 0.09111518412828445], [0.0919676125049591, 0.09112344682216644, 0.09165831655263901, 0.09180909395217896, 0.09096638113260269, 0.09150032699108124, 0.09165084362030029, 0.09218880534172058, 0.08538138121366501, 0.09099718183279037, 0.09075664728879929], [0.0918230190873146, 0.09109600633382797, 0.09155675023794174, 0.09168656170368195, 0.09096063673496246, 0.09142068773508072, 0.0915503203868866, 0.09201335906982422, 0.08612564206123352, 0.0909871831536293, 0.09077982604503632]], [[0.09140249341726303, 0.09130359441041946, 0.08973213285207748, 0.0911061018705368, 0.08953804522752762, 0.09201584756374359, 0.0919162780046463, 0.09071241319179535, 0.09023652970790863, 0.09161822497844696, 0.0904182642698288], [0.09139468520879745, 0.09129735827445984, 0.08975081145763397, 0.09110303223133087, 0.08955977112054825, 0.09199818223714828, 0.09190022200345993, 0.09071560204029083, 0.0902472585439682, 0.09160695225000381, 0.09042611718177795], [0.0912691205739975, 0.09119713306427002, 0.09005057066679001, 0.09105334430932999, 0.08990858495235443, 0.09171504527330399, 0.09164270758628845, 0.09076643735170364, 0.09041917324066162, 0.0914260521531105, 0.09055184572935104], [0.09137903898954391, 0.09128487855195999, 0.08978816121816635, 0.09109685570001602, 0.08960322290658951, 0.09196284413337708, 0.0918680876493454, 0.0907219648361206, 0.09026870131492615, 0.09158439189195633, 0.09044181555509567], [0.09125343710184097, 0.09118460863828659, 0.09008798748254776, 0.09104711562395096, 0.08995214849710464, 0.09167975932359695, 0.0916106104850769, 0.09077274054288864, 0.09044060111045837, 0.09140348434448242, 0.09056750684976578], [0.09145078808069229, 0.09134210646152496, 0.0896168202161789, 0.09112513065338135, 0.08940394222736359, 0.0921250432729721, 0.09201555699110031, 0.09069271385669708, 0.09017027169466019, 0.0916878879070282, 0.09036974608898163], [0.09144297987222672, 0.09133587777614594, 0.08963548392057419, 0.09112205356359482, 0.08942564576864243, 0.0921073630452156, 0.09199948608875275, 0.09069590270519257, 0.09018099308013916, 0.09167660772800446, 0.09037760645151138], [0.09134773910045624, 0.0912599042057991, 0.08986291289329529, 0.09108448773622513, 0.0896901786327362, 0.09189219772815704, 0.09180384129285812, 0.09073467552661896, 0.09031159430742264, 0.09153927862644196, 0.09047319740056992], [0.09130969643592834, 0.09122953563928604, 0.08995372802019119, 0.09106943011283875, 0.08979586511850357, 0.09180641919374466, 0.09172582626342773, 0.0907500684261322, 0.09036368131637573, 0.09148447215557098, 0.09051128476858139], [0.0914195254445076, 0.09131717681884766, 0.08969147503376007, 0.09111281484365463, 0.08949076384305954, 0.0920543298125267, 0.09195127338171005, 0.09070547670125961, 0.09021317213773727, 0.09164278209209442, 0.09040117263793945], [0.09132424741983414, 0.09124115854501724, 0.08991898596286774, 0.09107519686222076, 0.08975543081760406, 0.09183922410011292, 0.09175566583871841, 0.09074418246746063, 0.09034375846385956, 0.09150543808937073, 0.09049671143293381]], [[0.092326320707798, 0.09224390983581543, 0.09184455126523972, 0.092079296708107, 0.09199710190296173, 0.09159881621599197, 0.09060809016227722, 0.09143536537885666, 0.08337573707103729, 0.09204547852277756, 0.09044527262449265], [0.09229941666126251, 0.09221861511468887, 0.09182706475257874, 0.0920572280883789, 0.09197664260864258, 0.09158611297607422, 0.09061454236507416, 0.0914258286356926, 0.08351566642522812, 0.0920240730047226, 0.09045484662055969], [0.0921684205532074, 0.09209544956684113, 0.09174174070358276, 0.09194967150688171, 0.09187687188386917, 0.09152400493621826, 0.09064549207687378, 0.09137913584709167, 0.0841984748840332, 0.09191972017288208, 0.09050100296735764], [0.09224553406238556, 0.09216795861721039, 0.09179199486970901, 0.09201300144195557, 0.09193562716245651, 0.09156060218811035, 0.09062734246253967, 0.0914066731929779, 0.08379614353179932, 0.09198116511106491, 0.09047391265630722], [0.09221857041120529, 0.09214260429143906, 0.09177442640066147, 0.0919908657670021, 0.0919150859117508, 0.09154781699180603, 0.09063370525836945, 0.09139705449342728, 0.08393669128417969, 0.09195969253778458, 0.0904834046959877], [0.09208733588457108, 0.09201918542385101, 0.09168880432844162, 0.09188303351402283, 0.0918150320649147, 0.0914853885769844, 0.0906643196940422, 0.0913500264286995, 0.08462262153625488, 0.09185505658388138, 0.09052923321723938], [0.09175656735897064, 0.09170790761709213, 0.09147188067436218, 0.09161067008972168, 0.09156209230422974, 0.09132644534111023, 0.090738445520401, 0.09122961014509201, 0.08636411279439926, 0.09159068763256073, 0.0906415656208992], [0.09203317761421204, 0.09196823835372925, 0.09165338426828384, 0.09183849394321442, 0.09177368879318237, 0.09145951271057129, 0.09067673236131668, 0.09133048355579376, 0.0849064439535141, 0.09181183576583862, 0.09054791927337646], [0.08913818746805191, 0.08923409134149551, 0.08970148116350174, 0.0894262045621872, 0.08952241390943527, 0.08999130874872208, 0.09117741882801056, 0.09018505364656448, 0.10078298300504684, 0.08946575969457626, 0.09137509018182755], [0.09223444759845734, 0.09215753525495529, 0.0917847752571106, 0.09200389683246613, 0.0919271782040596, 0.09155534952878952, 0.09062996506690979, 0.09140272438526154, 0.08385392278432846, 0.09197233617305756, 0.0904778242111206], [0.09170161187648773, 0.0916561633348465, 0.09143569320440292, 0.09156534075737, 0.09151996672153473, 0.09129981696605682, 0.09075035154819489, 0.09120934456586838, 0.08665523678064346, 0.0915466770529747, 0.09065979719161987]]]}, "num_training_step_calls_per_iteration": 1, "evaluation": {"env_runners": {"episode_len_max": 20, "rlmodule_inference_timer": 3.434833527551728e-05, "num_module_steps_sampled": {"default_policy": 400}, "sample": 0.17208486808036055, "env_to_module_connector": {"timers": {"connectors": {"add_states_from_episodes_to_batch": 2.9145054650099476e-06, "add_time_dim_to_batch_and_zero_pad": 7.226999230011367e-06, "add_observations_from_episodes_to_batch": 3.0865946472183176e-06, "numpy_to_tensor": 1.3589653285191282e-05, "batch_individual_items": 1.3099373457978856e-05}}, "connector_pipeline_timer": 6.361634986920797e-05}, "module_episode_returns_mean": {"default_policy": -1.45}, "module_to_env_connector": {"timers": {"connectors": {"normalize_and_clip_actions": 8.505645755818219e-06, "remove_single_ts_time_rank_from_batch": 1.303512145302765e-05, "tensor_to_numpy": 1.7100708377837663e-05, "listify_data_for_vector_env": 1.1106394990610864e-05, "un_batch_to_individual_items": 7.677919962524912e-06, "get_actions": 4.278644514725987e-05}}, "connector_pipeline_timer": 0.00012891449944565843}, "episode_duration_sec_mean": 0.005642968355678022, "weights_seq_no": 7.0, "env_to_module_sum_episodes_length_out": 10.368238394572801, "agent_episode_returns_mean": {"default_agent": -1.45}, "episode_return_mean": -1.45, "env_to_module_sum_episodes_length_in": 10.368238394572801, "num_episodes_lifetime": 140, "num_agent_steps_sampled_lifetime": {"default_agent": 2800}, "num_episodes": 20, "episode_len_mean": 20.0, "num_agent_steps_sampled": {"default_agent": 400}, "num_module_steps_sampled_lifetime": {"default_policy": 2800}, "env_reset_timer": 0.00233902188061765, "episode_return_min": -16.5, "num_env_steps_sampled": 400, "episode_len_min": 20, "episode_return_max": 12.5, "env_step_timer": 1.5523609697281208e-05, "num_env_steps_sampled_lifetime": 35400, "time_between_sampling": 10.931501165053827}, "num_healthy_workers": 1, "actor_manager_num_outstanding_async_reqs": 0, "num_remote_worker_restarts": 0}, "num_env_steps_sampled_lifetime": -3077500.0, "fault_tolerance": {"num_healthy_workers": 0, "num_remote_worker_restarts": 0}, "env_runner_group": {"actor_manager_num_outstanding_async_reqs": 0}, "done": false, "training_iteration": 7, "trial_id": "b154b_00000", "date": "2025-08-11_18-12-38", "timestamp": 1754928758, "time_this_iter_s": 10.134984016418457, "time_total_s": 73.08159899711609, "pid": 10455, "hostname": "Mac", "node_ip": "127.0.0.1", "config": {"exploration_config": {}, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 2, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "env": "Umbrella", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": false, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 0, "create_local_env_runner": true, "num_envs_per_env_runner": 1, "gym_env_vectorize_mode": "SYNC", "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "episodes_to_numpy": true, "max_requests_in_flight_per_env_runner": 1, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "merge_env_runner_states": "training_only", "broadcast_env_runner_states": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "complete_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "sampler_perf_stats_ema_coef": null, "_is_online": true, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": "auto", "num_aggregator_actors_per_learner": 0, "max_requests_in_flight_per_aggregator_actor": 3, "local_gpu_idx": 0, "max_requests_in_flight_per_learner": 3, "gamma": 1, "lr": 0.0002715581955, "grad_clip": 0.5, "grad_clip_by": "global_norm", "_train_batch_size_per_learner": 5000, "train_batch_size": 4000, "num_epochs": 1, "minibatch_size": 1000, "shuffle_batch_per_epoch": true, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "log_std_clip_param": 20.0, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "_disable_preprocessor_api": false, "_disable_action_flattening": false}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {"intrinsic_reward_coeff": 0.2795015916508}, "optimizer": {}, "_learner_class": "<class 'source.intrinsic_attention_ppo.learners.IntrinsicAttentionMetaLearner.IntrinsicAttentionMetaLearner'>", "callbacks_on_algorithm_init": null, "callbacks_on_env_runners_recreated": null, "callbacks_on_offline_eval_runners_recreated": null, "callbacks_on_checkpoint_loaded": null, "callbacks_on_environment_created": null, "callbacks_on_episode_created": null, "callbacks_on_episode_start": null, "callbacks_on_episode_step": null, "callbacks_on_episode_end": null, "callbacks_on_evaluate_start": null, "callbacks_on_evaluate_end": null, "callbacks_on_evaluate_offline_start": null, "callbacks_on_evaluate_offline_end": null, "callbacks_on_sample_end": null, "callbacks_on_train_result": null, "explore": true, "enable_rl_module_and_learner": true, "enable_env_runner_and_connector_v2": true, "_prior_exploration_config": {"type": "StochasticSampling"}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x1514e58a0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "offline_data_class": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_read_batch_size": null, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "materialize_data": false, "materialize_mapped_data": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "ignore_final_observation": false, "prelearner_class": null, "prelearner_buffer_class": null, "prelearner_buffer_kwargs": {}, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_remaining_data": false, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": 1, "evaluation_duration": 20, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_auto_duration_min_env_steps_per_sample": 100, "evaluation_auto_duration_max_env_steps_per_sample": 2000, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 1, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "offline_evaluation_interval": null, "num_offline_eval_runners": 0, "offline_loss_for_module_fn": null, "offline_evaluation_duration": 1, "offline_evaluation_parallel_to_training": false, "offline_evaluation_timeout_s": 120.0, "num_cpus_per_offline_eval_runner": 1, "num_gpus_per_offline_eval_runner": 0, "custom_resources_per_offline_eval_runner": {}, "restart_failed_offline_eval_runners": true, "ignore_offline_eval_runner_failures": false, "max_num_offline_eval_runner_restarts": 1000, "offline_eval_runner_restore_timeout_s": 1800.0, "max_requests_in_flight_per_offline_eval_runner": 1, "validate_offline_eval_runners_after_construction": true, "offline_eval_runner_health_probe_timeout_s": 30.0, "offline_eval_rl_module_inference_only": false, "broadcast_offline_eval_runner_states": false, "offline_eval_batch_size_per_runner": 256, "dataset_num_iters_per_eval_runner": 1, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "log_gradients": false, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 4, "restart_failed_env_runners": true, "ignore_env_runner_failures": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30.0, "env_runner_restore_timeout_s": 1800.0, "_model_config": {}, "_rl_module_spec": "MultiRLModuleSpec(multi_rl_module_class=<class 'ray.rllib.core.rl_module.multi_rl_module.MultiRLModule'>, observation_space=None, action_space=None, inference_only=False, model_config=None, rl_module_specs={'default_policy': RLModuleSpec(module_class=<class 'source.intrinsic_attention_ppo.rl_modules.DifferentiablePPOModule.DifferentiablePPOModule'>, observation_space=None, action_space=None, inference_only=False, learner_only=False, model_config={'vf_share_layers': True, 'embedding_dim': 62, 'max_seq_len': 11, 'policy_head_hidden_sizes': [32], 'value_head_hidden_sizes': [101], 'embedding_hidden_sizes': [121]}, catalog_class=None, load_state_path=None, model_config_dict=None), 'intrinsic_reward_module': RLModuleSpec(module_class=<class 'source.intrinsic_attention_ppo.rl_modules.IntrinsicAttentionModule.IntrinsicAttentionModule'>, observation_space=None, action_space=None, inference_only=False, learner_only=True, model_config={'intrinsic_reward_network': {'encoder_hidden_sizes': [], 'encoding_dim': 1, 'num_heads': 1, 'head_hidden_sizes': None, 'layers': [{'type': 'attention'}]}, 'extrinsic_value_hidden_layers': [127, 60], 'vf_share_layers': True, 'max_seq_len': 11}, catalog_class=None, load_state_path=None, model_config_dict=None)}, load_state_path=None, modules_to_load=None, module_specs={'default_policy': RLModuleSpec(module_class=<class 'source.intrinsic_attention_ppo.rl_modules.DifferentiablePPOModule.DifferentiablePPOModule'>, observation_space=None, action_space=None, inference_only=False, learner_only=False, model_config={'vf_share_layers': True, 'embedding_dim': 62, 'max_seq_len': 11, 'policy_head_hidden_sizes': [32], 'value_head_hidden_sizes': [101], 'embedding_hidden_sizes': [121]}, catalog_class=None, load_state_path=None, model_config_dict=None), 'intrinsic_reward_module': RLModuleSpec(module_class=<class 'source.intrinsic_attention_ppo.rl_modules.IntrinsicAttentionModule.IntrinsicAttentionModule'>, observation_space=None, action_space=None, inference_only=False, learner_only=True, model_config={'intrinsic_reward_network': {'encoder_hidden_sizes': [], 'encoding_dim': 1, 'num_heads': 1, 'head_hidden_sizes': None, 'layers': [{'type': 'attention'}]}, 'extrinsic_value_hidden_layers': [127, 60], 'vf_share_layers': True, 'max_seq_len': 11}, catalog_class=None, load_state_path=None, model_config_dict=None)})", "algorithm_config_overrides_per_module": {"intrinsic_reward_module": {"lr": 0.0002715581955}}, "_per_module_overrides": {}, "_validate_config": true, "_use_msgpack_checkpoints": false, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "env_task_fn": -1, "enable_connectors": -1, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.161583927863, "kl_target": 0.0201019014258, "vf_loss_coeff": 0.7790510010087, "entropy_coeff": 0.0015431216992, "clip_param": 0.2459212356676, "vf_clip_param": 0.3769744131561, "entropy_coeff_schedule": null, "lr_schedule": null, "sgd_minibatch_size": -1, "vf_share_layers": -1, "differentiable_learner_configs": ["DifferentiableLearnerConfig(learner_class=<class 'source.intrinsic_attention_ppo.learners.IntrinsicAttentionPPOLearner.IntrinsicAttentionPPOLearner'>, learner_connector=None, add_default_connectors_to_learner_pipeline=True, is_multi_agent=False, policies_to_update=['default_policy'], lr=0.0060984166342, num_total_minibatches=0, num_epochs=1, minibatch_size=1000, shuffle_batch_per_epoch=True)"], "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9485408017724, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.callbacks.callbacks.RLlibCallback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 73.08159899711609, "iterations_since_restore": 7, "perf": {"cpu_util_percent": 45.221428571428575, "ram_util_percent": 81.11428571428571}}
{"timers": {"training_iteration": 10.189336397707777, "restore_env_runners": 1.0793460314821453e-05, "training_step": 10.189137424550823, "env_runner_sampling_timer": 1.821013674002133, "learner_update_timer": 8.188313987743525, "synch_weights": 0.0015207864339684778, "restore_eval_env_runners": 7.785989747905516e-05, "evaluation_iteration": 0.2134407948779888, "synch_eval_env_connectors": 0.0002279748252601107, "synch_env_connectors": 5.1412815927167774e-06}, "env_runners": {"num_env_steps_sampled": 5000.0, "episode_return_max": 12.5, "env_to_module_connector": {"timers": {"connectors": {"add_time_dim_to_batch_and_zero_pad": 7.165640463344684e-06, "add_observations_from_episodes_to_batch": 2.8688774691367794e-06, "batch_individual_items": 1.2740358600051903e-05, "numpy_to_tensor": 1.2984644037351503e-05, "add_states_from_episodes_to_batch": 2.7683120393834293e-06}}, "connector_pipeline_timer": 6.13031928904227e-05}, "episode_len_min": 20, "module_to_env_connector": {"timers": {"connectors": {"un_batch_to_individual_items": 6.802441147285726e-06, "normalize_and_clip_actions": 8.285044420079004e-06, "remove_single_ts_time_rank_from_batch": 1.2243866697109764e-05, "get_actions": 4.126056833033839e-05, "tensor_to_numpy": 1.5575949789017047e-05, "listify_data_for_vector_env": 1.1003249427038036e-05}}, "connector_pipeline_timer": 0.00012264190905724183}, "env_step_timer": 1.4431083330503816e-05, "num_agent_steps_sampled_lifetime": {"default_agent": -3695000.0}, "num_episodes": 250.0, "episode_duration_sec_mean": 0.005465773994568733, "episode_len_mean": 20.0, "module_episode_returns_mean": {"default_policy": 3.5400000000000005}, "weights_seq_no": 7.0, "env_to_module_sum_episodes_length_out": 10.36823839457432, "num_env_steps_sampled_lifetime": -3695000.0, "episode_len_max": 20, "rlmodule_inference_timer": 3.29374884586066e-05, "num_agent_steps_sampled": {"default_agent": 5000.0}, "env_reset_timer": 4.844437051101498e-05, "agent_episode_returns_mean": {"default_agent": 3.5400000000000005}, "env_to_module_sum_episodes_length_in": 10.36823839457432, "episode_return_mean": 3.5400000000000005, "time_between_sampling": 0.03446300208786075, "num_module_steps_sampled_lifetime": {"default_policy": -3695000.0}, "num_module_steps_sampled": {"default_policy": 5000.0}, "num_episodes_lifetime": -184750.0, "episode_return_min": -7.5, "sample": 0.005970777349861527, "num_env_steps_sampled_lifetime_throughput": 3124.921732825234}, "__all_modules__": {"learner_connector_sum_episodes_length_in": 5000.0, "learner_connector": {"connector_pipeline_timer": 0.13900810680137754, "timers": {"connectors": {"add_one_ts_to_episodes_and_truncate": 0.00952685848650382, "add_observations_from_episodes_to_batch": 0.0010381950877677657, "add_columns_from_episodes_to_train_batch": 0.04403908222805734, "add_time_dim_to_batch_and_zero_pad": 0.07619892713355428, "add_states_from_episodes_to_batch": 0.003583583152084475, "batch_individual_items": 0.004358789502124993, "numpy_to_tensor": 7.275656626373835e-05}}}, "learner_connector_sum_episodes_length_out": 5250.0}, "learners": {"__all_modules__": {"num_module_steps_trained_lifetime": 95760, "num_env_steps_trained": 33000, "num_env_steps_trained_lifetime": 264000, "num_non_trainable_parameters": 0, "num_trainable_parameters": 24861, "num_module_steps_trained": 11970, "num_env_steps_trained_lifetime_throughput": 3937.4608343285604, "num_module_steps_trained_throughput": 26622493.523909844, "num_module_steps_trained_lifetime_throughput": 12758120.63676988}, "default_policy": {"curr_entropy_coeff": 0.0015431216992, "weights_seq_no": 8.0, "curr_kl_coeff": 0.0006311872275546193, "policy_loss": -0.00011564481974346563, "module_train_batch_size_mean": 997.8076834879114, "num_trainable_parameters": 16595, "vf_loss": 0.3583059012889862, "mean_kl_loss": 4.2846991163969506e-06, "diff_num_grad_updates_vs_sampler_policy": 1.0, "vf_explained_var": -0.0007423162460327148, "use_intrinsic_rewards": 0.0, "entropy": 0.6849223971366882, "num_module_steps_trained": 5985, "vf_loss_unclipped": 44.11168670654297, "total_loss": 0.2779660224914551, "num_module_steps_trained_lifetime": 47880, "num_module_steps_trained_lifetime_throughput": 713.8538637531306}, "differentiable_learners": {"intrinsic_attention_ppo_learner": {"__all_modules__": {"num_module_steps_trained_lifetime": 574560, "num_env_steps_trained_lifetime": 1584000, "num_module_steps_trained": 71820, "num_env_steps_trained": 198000, "num_env_steps_trained_lifetime_throughput": 49279.09681421689}, "default_policy": {"weights_seq_no": 48.0, "policy_loss": -0.00010846990335267037, "module_train_batch_size_mean": 997.5252898807411, "vf_loss": 0.3583163619041443, "mean_kl_loss": 3.7380348203441827e-06, "diff_num_grad_updates_vs_sampler_policy": 41.0, "vf_explained_var": 0.0027142763137817383, "use_intrinsic_rewards": 1.0, "entropy": 0.6849472522735596, "num_module_steps_trained": 35910, "vf_loss_unclipped": 44.0274658203125, "total_loss": 0.27798187732696533, "num_module_steps_trained_lifetime": 287280}, "intrinsic_reward_module": {"total_loss": 0.0, "num_module_steps_trained_lifetime": 287280, "module_train_batch_size_mean": 997.5252898807411, "weights_seq_no": 48.0, "num_module_steps_trained": 35910, "diff_num_grad_updates_vs_sampler_policy": 41.0}}}, "intrinsic_reward_module": {"diff_num_grad_updates_vs_sampler_policy": 1.0, "gradients_default_optimizer_global_norm": 0.0, "curr_entropy_coeff": 0.0015431216992, "weights_seq_no": 8.0, "default_optimizer_learning_rate": 0.0002715581955, "total_loss": 0.0, "num_module_steps_trained_lifetime": 47880, "module_train_batch_size_mean": 997.8076834879114, "num_trainable_parameters": 8266, "num_module_steps_trained": 5985, "num_module_steps_trained_lifetime_throughput": 713.8637291059825}, "IntrinsicAttentionMask": [[[0.09180860966444016, 0.09170927107334137, 0.09161002933979034, 0.09003330022096634, 0.09141188114881516, 0.09093232452869415, 0.09083393216133118, 0.08964423835277557, 0.0906374603509903, 0.09202529489994049, 0.08935355395078659], [0.09179429709911346, 0.09169655293226242, 0.09159891307353973, 0.09004725515842438, 0.09140393137931824, 0.09093203395605087, 0.09083520621061325, 0.08966431766748428, 0.09064185619354248, 0.09200749546289444, 0.08937818557024002], [0.09177996963262558, 0.09168381989002228, 0.09158776700496674, 0.09006118774414062, 0.09139596670866013, 0.0909317210316658, 0.09083645790815353, 0.0896843820810318, 0.09064623713493347, 0.0919896811246872, 0.08940280973911285], [0.09155026078224182, 0.09147962927818298, 0.09140905737876892, 0.09028477966785431, 0.09126807749271393, 0.09092651307582855, 0.09085636585950851, 0.0900065004825592, 0.09071623533964157, 0.09170423448085785, 0.08979835361242294], [0.09175131469964981, 0.09165835380554199, 0.09156548976898193, 0.09008907526731491, 0.0913800373673439, 0.09093110263347626, 0.0908389762043953, 0.08972451835870743, 0.09065499156713486, 0.0919540598988533, 0.08945207297801971], [0.09168172627687454, 0.09159650653600693, 0.09151136130094528, 0.09015681594610214, 0.09134131669998169, 0.09092956781387329, 0.09084504097700119, 0.08982207626104355, 0.09067623317241669, 0.09186755865812302, 0.08957183361053467], [0.09166739881038666, 0.09158376604318619, 0.09150021523237228, 0.09017075598239899, 0.09133333712816238, 0.09092923253774643, 0.09084628522396088, 0.08984215557575226, 0.09068059921264648, 0.09184975177049637, 0.08959649503231049], [0.09149297326803207, 0.09142869710922241, 0.09136445820331573, 0.09034056216478348, 0.09123612195253372, 0.09092513471841812, 0.0908612534403801, 0.09008695185184479, 0.09073362499475479, 0.09163308888673782, 0.08989720791578293], [0.09163874387741089, 0.0915582999587059, 0.09147792309522629, 0.09019864350557327, 0.09131738543510437, 0.0909285768866539, 0.09084875881671906, 0.08988233655691147, 0.09068932384252548, 0.09181415289640427, 0.08964583277702332], [0.09183981269598007, 0.09173699468374252, 0.09163428843021393, 0.09000295400619507, 0.0914292261004448, 0.09093299508094788, 0.09083119034767151, 0.089600570499897, 0.09062791615724564, 0.09206409752368927, 0.08929996937513351], [0.09144999086856842, 0.091390460729599, 0.09133098274469376, 0.09038237482309341, 0.09121213108301163, 0.09092406183481216, 0.0908648744225502, 0.09014730155467987, 0.09074663370847702, 0.09157972782850266, 0.0899713858962059]], [[0.09135979413986206, 0.09130190312862396, 0.09277275949716568, 0.09118623286485672, 0.09112845361232758, 0.09171821922063828, 0.09101299941539764, 0.09247920662164688, 0.08498108386993408, 0.09116246551275253, 0.09089688956737518], [0.0913480892777443, 0.09129177778959274, 0.09272216260433197, 0.091179259121418, 0.0911230593919754, 0.09169670194387436, 0.09101074934005737, 0.09243673086166382, 0.08513761311769485, 0.09115613996982574, 0.09089779853820801], [0.09163437783718109, 0.09153810143470764, 0.09399676322937012, 0.09134584665298462, 0.09124986827373505, 0.0922313779592514, 0.09105822443962097, 0.09350399672985077, 0.08126947283744812, 0.09130636602640152, 0.09086563438177109], [0.09132456034421921, 0.09127141535282135, 0.09262093156576157, 0.0911652073264122, 0.0911121517419815, 0.09165356308221817, 0.09100613743066788, 0.09235173463821411, 0.08545141667127609, 0.09114338457584381, 0.0908994972705841], [0.09131275862455368, 0.09126119315624237, 0.09257031977176666, 0.09115813672542572, 0.09110666066408157, 0.09163196384906769, 0.09100379049777985, 0.09230922907590866, 0.08560871332883835, 0.09113696217536926, 0.09090030938386917], [0.09143149107694626, 0.0913638323545456, 0.09308526664972305, 0.09122864902019501, 0.09116113185882568, 0.09185060113668442, 0.09102625399827957, 0.09274133294820786, 0.08401993662118912, 0.09120087325572968, 0.09089062362909317], [0.09128905832767487, 0.09124064445495605, 0.09246906638145447, 0.0911439061164856, 0.09109557420015335, 0.09158866852521896, 0.09099898487329483, 0.09222415089607239, 0.08592408150434494, 0.091124027967453, 0.09090182185173035], [0.09157908707857132, 0.09149075299501419, 0.0937442034482956, 0.09131433069705963, 0.0912262573838234, 0.09212666749954224, 0.09105034917593002, 0.0932929515838623, 0.08202371746301651, 0.09127809852361679, 0.09087355434894562], [0.08982035517692566, 0.08994030207395554, 0.08696448802947998, 0.0901806652545929, 0.09030109643936157, 0.08908296376466751, 0.09054242074489594, 0.0875466912984848, 0.10460472851991653, 0.09023017436265945, 0.09078609943389893], [0.09131971746683121, 0.09126721322536469, 0.09260012209415436, 0.09116230905056, 0.09110990166664124, 0.09164468944072723, 0.09100517630577087, 0.09233425557613373, 0.08551608771085739, 0.0911407545208931, 0.09089983999729156], [0.09126506745815277, 0.09121983498334885, 0.09236709028482437, 0.09112944453954697, 0.09108428657054901, 0.09154496341943741, 0.09099403023719788, 0.09213843941688538, 0.08624271303415298, 0.09111087024211884, 0.09090322256088257]], [[0.09140177816152573, 0.09130287915468216, 0.09120407700538635, 0.08963433653116226, 0.0910068079829216, 0.09201512485742569, 0.0919155552983284, 0.08924700319766998, 0.09171675145626068, 0.09013817459344864, 0.09041755646467209], [0.09139397740364075, 0.09129665791988373, 0.09119944274425507, 0.08965454995632172, 0.09100531786680222, 0.09199747443199158, 0.09189951419830322, 0.08927328884601593, 0.09170389175415039, 0.09015046060085297, 0.09042542427778244], [0.09138618409633636, 0.0912904441356659, 0.09119480103254318, 0.08967477828264236, 0.09100382775068283, 0.09197983145713806, 0.09188347309827805, 0.08929958194494247, 0.0916910469532013, 0.09016275405883789, 0.09043329209089279], [0.09126090258359909, 0.09119049459695816, 0.091120146214962, 0.08999942243099213, 0.09097961336374283, 0.09169702231884003, 0.09162627905607224, 0.08972201496362686, 0.09148496389389038, 0.09035974740982056, 0.09055929630994797], [0.09137057512998581, 0.09127800166606903, 0.09118551015853882, 0.08971522748470306, 0.09100083261728287, 0.09194453805685043, 0.0918513759970665, 0.08935219049453735, 0.0916653499007225, 0.09018732607364655, 0.0904490277171135], [0.09144991636276245, 0.09134123474359512, 0.09123267978429794, 0.08950946480035782, 0.09101595729589462, 0.09212416410446167, 0.09201467782258987, 0.08908472210168839, 0.09179610013961792, 0.09006224572658539, 0.09036888927221298], [0.09144212305545807, 0.09133502095937729, 0.09122805297374725, 0.08952966332435608, 0.09101448208093643, 0.09210650622844696, 0.0919986292719841, 0.08911097049713135, 0.09178325533866882, 0.09007453173398972, 0.09037676453590393], [0.09122959524393082, 0.09116549789905548, 0.09110145270824432, 0.09008049964904785, 0.09097348898649216, 0.09162653237581253, 0.09156215935945511, 0.08982762694358826, 0.09143354743719101, 0.09040887653827667, 0.09059067815542221], [0.0914265364408493, 0.09132260829210281, 0.09121879190206528, 0.08957009017467499, 0.09101151674985886, 0.09207119792699814, 0.09196653217077255, 0.08916348963975906, 0.09175755828619003, 0.09009911864995956, 0.09039251506328583], [0.09130140393972397, 0.09122282266616821, 0.09114431589841843, 0.08989454060792923, 0.09098749607801437, 0.09178830683231354, 0.09170930832624435, 0.08958548307418823, 0.0915515199303627, 0.090296171605587, 0.09051866829395294], [0.09132373332977295, 0.09124064445495605, 0.09115763008594513, 0.08983666449785233, 0.09099181741476059, 0.09183871001005173, 0.09175515174865723, 0.08951015770435333, 0.09158825874328613, 0.0902610570192337, 0.09049620479345322]], [[0.09112243354320526, 0.09099672734737396, 0.09038844704627991, 0.08888163417577744, 0.08875901997089386, 0.09001488238573074, 0.0885142982006073, 0.08976669609546661, 0.10597250610589981, 0.09069431573152542, 0.08488905429840088], [0.09112142771482468, 0.09099728614091873, 0.09039658308029175, 0.08890829980373383, 0.08878716826438904, 0.09002763777971268, 0.08854541927576065, 0.08978251367807388, 0.1057717502117157, 0.09069865196943283, 0.08496326208114624], [0.09111593663692474, 0.09099943190813065, 0.09043549746274948, 0.08903732895851135, 0.08892347663640976, 0.09008902311325073, 0.08869621157646179, 0.089858777821064, 0.10480110347270966, 0.09071910381317139, 0.08532413095235825], [0.09109769761562347, 0.09100031852722168, 0.09052865952253342, 0.0893571674823761, 0.08926164358854294, 0.09023863822221756, 0.08907090127468109, 0.09004580229520798, 0.10240211337804794, 0.09076591581106186, 0.08623116463422775], [0.0910959243774414, 0.09100010246038437, 0.09053602814674377, 0.08938320726156235, 0.08928919583559036, 0.0902506485581398, 0.08910146355628967, 0.09006089717149734, 0.102207250893116, 0.09076948463916779, 0.08630581200122833], [0.09111203998327255, 0.09100024402141571, 0.09045903384685516, 0.08911659568548203, 0.08900725096464157, 0.09012644737958908, 0.0887889489531517, 0.08990540355443954, 0.10420560836791992, 0.09073122590780258, 0.08554725348949432], [0.09109222888946533, 0.0909995585680008, 0.09055065363645554, 0.08943518251180649, 0.08934419602155685, 0.09027455747127533, 0.08916249126195908, 0.09009097516536713, 0.1018184944987297, 0.0907764807343483, 0.08645517379045486], [0.09110921621322632, 0.09100056439638138, 0.09047450125217438, 0.08916926383972168, 0.08906292170286179, 0.09015118330717087, 0.08885061740875244, 0.0899362787604332, 0.10381023585796356, 0.09073908627033234, 0.08569612354040146], [0.09095526486635208, 0.09065871685743332, 0.0892316922545433, 0.08575277775526047, 0.0854731947183609, 0.08836174011230469, 0.08491675555706024, 0.08778649568557739, 0.12999728322029114, 0.08994762599468231, 0.07691840827465057], [0.09111884236335754, 0.09099848568439484, 0.09041602909564972, 0.08897244185209274, 0.08885493129491806, 0.09005822986364365, 0.08862035721540451, 0.0898204892873764, 0.1052890345454216, 0.09070893377065659, 0.08514230698347092], [0.09101594984531403, 0.09097084403038025, 0.0907520279288292, 0.0902058482170105, 0.09016115218400955, 0.09061715751886368, 0.09007180482149124, 0.09052737057209015, 0.0960863009095192, 0.09086217731237411, 0.0887293741106987]], [[0.08856935054063797, 0.09170990437269211, 0.09050683677196503, 0.09155898541212082, 0.09035790711641312, 0.09111835807561874, 0.09104335308074951, 0.09125789999961853, 0.09202592819929123, 0.09081871807575226, 0.0910327360033989], [0.08654048293828964, 0.09241796284914017, 0.09014501422643661, 0.09213137626647949, 0.08986548334360123, 0.09129703044891357, 0.09115536510944366, 0.09156087785959244, 0.09301942586898804, 0.09073169529438019, 0.09113531559705734], [0.08730457723140717, 0.0921497792005539, 0.09028274565935135, 0.0919148325920105, 0.09005255252122879, 0.09123006463050842, 0.09111368656158447, 0.09144672751426697, 0.09264246374368668, 0.09076543897390366, 0.09109720587730408], [0.08663545548915863, 0.09238451719284058, 0.0901622325181961, 0.09210438281297684, 0.08988884091377258, 0.091288723051548, 0.09115021675825119, 0.0915466770529747, 0.09297237545251846, 0.09073594957590103, 0.09113060683012009], [0.08740027993917465, 0.09211631119251251, 0.09029985964298248, 0.09188778698444366, 0.09007583558559418, 0.0912216380238533, 0.09110841155052185, 0.09143242239952087, 0.09259548038244247, 0.09076958149671555, 0.09109238535165787], [0.08691419661045074, 0.09228655695915222, 0.09021259844303131, 0.09202530980110168, 0.08995722234249115, 0.09126432240009308, 0.09113505482673645, 0.0915050357580185, 0.09283462166786194, 0.09074834734201431, 0.0911167562007904], [0.08696185052394867, 0.09226982295513153, 0.09022117406129837, 0.09201180189847946, 0.08996888250112534, 0.09126013517379761, 0.09113244712352753, 0.09149790555238724, 0.09281110763549805, 0.09075044095516205, 0.09111437201499939], [0.08682568371295929, 0.0923176258802414, 0.0901966243982315, 0.09205039590597153, 0.0899355337023735, 0.09127207100391388, 0.09113986790180206, 0.09151824563741684, 0.0928783044219017, 0.09074442088603973, 0.09112115949392319], [0.08634238690137863, 0.09248779714107513, 0.09010902792215347, 0.09218772500753403, 0.08981666713953018, 0.09131433814764023, 0.09116607904434204, 0.09159048646688461, 0.09311772882938385, 0.09072275459766388, 0.0911450982093811], [0.08710496127605438, 0.09221966564655304, 0.09024693071842194, 0.09197128564119339, 0.09000387042760849, 0.09124759584665298, 0.09112463146448135, 0.09147654473781586, 0.09274061024188995, 0.09075674414634705, 0.09110722690820694], [0.08696860820055008, 0.0922674611210823, 0.09022239595651627, 0.09200989454984665, 0.08997053653001785, 0.09125955402851105, 0.09113208204507828, 0.09149689972400665, 0.09280778467655182, 0.09075074642896652, 0.09111404418945312]], [[0.09095119684934616, 0.09082572907209396, 0.09021859616041183, 0.0887146145105362, 0.08859223127365112, 0.08984573185443878, 0.08834796398878098, 0.09147721529006958, 0.10577336698770523, 0.09052389115095139, 0.08472953736782074], [0.0909523144364357, 0.09082840383052826, 0.09022881090641022, 0.08874329179525375, 0.08862239122390747, 0.08986055105924606, 0.0883810892701149, 0.09147176146507263, 0.10557544976472855, 0.09053032100200653, 0.08480557799339294], [0.0909571722149849, 0.09084086865186691, 0.09027792513370514, 0.08888218551874161, 0.08876852691173553, 0.08993204683065414, 0.0885416567325592, 0.09144464880228043, 0.10461849719285965, 0.09056102484464645, 0.08517546206712723], [0.0909649059176445, 0.09086766093969345, 0.0903966948390007, 0.08922690898180008, 0.08913151919841766, 0.09010709077119827, 0.0889410525560379, 0.09137225896120071, 0.10225284099578857, 0.09063360095024109, 0.08610546588897705], [0.09096524864435196, 0.09086957573890686, 0.09040616452693939, 0.08925499767065048, 0.08916112035512924, 0.09012119472026825, 0.08897365629673004, 0.09136603027582169, 0.10206064581871033, 0.09063927829265594, 0.08618201315402985], [0.09095966815948486, 0.09084805101156235, 0.09030774980783463, 0.08896755427122116, 0.08885839581489563, 0.08997572213411331, 0.08864045888185501, 0.09142740070819855, 0.10403133928775787, 0.09057948738336563, 0.08540418744087219], [0.09096583724021912, 0.09087329357862473, 0.09042500704526901, 0.08931108564138412, 0.08922021836042404, 0.09014929831027985, 0.08903877437114716, 0.09135346114635468, 0.10167721658945084, 0.0906505212187767, 0.0863352119922638], [0.0909460186958313, 0.0908140167593956, 0.09017542004585266, 0.08859442919492722, 0.08846583962440491, 0.08978332579135895, 0.08820921927690506, 0.09149953722953796, 0.10660358518362045, 0.0904965028166771, 0.08441214263439178], [0.09055519104003906, 0.09025994688272476, 0.08883919566869736, 0.0853755846619606, 0.08509723097085953, 0.08797307312488556, 0.08454323559999466, 0.09179902821779251, 0.12942549586296082, 0.08955197781324387, 0.07658006995916367], [0.09095484763383865, 0.09083471447229385, 0.0902533084154129, 0.08881232142448425, 0.08869501203298569, 0.08989614993333817, 0.08846086263656616, 0.09145842492580414, 0.10509955137968063, 0.09054568409919739, 0.08498907089233398], [0.09095435589551926, 0.09090927988290787, 0.09069059789180756, 0.0901448056101799, 0.09010013192892075, 0.0905558317899704, 0.09001085162162781, 0.09114290028810501, 0.09602127224206924, 0.0908006802201271, 0.0886693224310875]]]}, "num_training_step_calls_per_iteration": 1, "evaluation": {"env_runners": {"episode_len_max": 20, "rlmodule_inference_timer": 3.2467509715556065e-05, "num_module_steps_sampled": {"default_policy": 400}, "sample": 0.17151434814934774, "env_to_module_connector": {"timers": {"connectors": {"add_states_from_episodes_to_batch": 2.8032159102837366e-06, "add_time_dim_to_batch_and_zero_pad": 7.040073480312832e-06, "add_observations_from_episodes_to_batch": 2.8573827674610043e-06, "numpy_to_tensor": 1.2538234998393059e-05, "batch_individual_items": 1.2759188281063745e-05}}, "connector_pipeline_timer": 6.117336190074976e-05}, "module_episode_returns_mean": {"default_policy": -0.65}, "module_to_env_connector": {"timers": {"connectors": {"normalize_and_clip_actions": 8.0543502109227e-06, "remove_single_ts_time_rank_from_batch": 1.2117278209465137e-05, "tensor_to_numpy": 1.5458391841095805e-05, "listify_data_for_vector_env": 1.0545849698773346e-05, "un_batch_to_individual_items": 6.595563497215192e-06, "get_actions": 3.881360751081081e-05}}, "connector_pipeline_timer": 0.00011878309546167617}, "episode_duration_sec_mean": 0.005596110024489462, "weights_seq_no": 8.0, "env_to_module_sum_episodes_length_out": 10.3682383945743, "agent_episode_returns_mean": {"default_agent": -0.65}, "episode_return_mean": -0.65, "env_to_module_sum_episodes_length_in": 10.3682383945743, "num_episodes_lifetime": 160, "num_agent_steps_sampled_lifetime": {"default_agent": 3200}, "num_episodes": 20, "episode_len_mean": 20.0, "num_agent_steps_sampled": {"default_agent": 400}, "num_module_steps_sampled_lifetime": {"default_policy": 3200}, "env_reset_timer": 0.002316514992169666, "episode_return_min": -16.5, "num_env_steps_sampled": 400, "episode_len_min": 20, "episode_return_max": 12.5, "env_step_timer": 1.444800331004886e-05, "num_env_steps_sampled_lifetime": 40400, "time_between_sampling": 10.913763321322893}, "num_healthy_workers": 1, "actor_manager_num_outstanding_async_reqs": 0, "num_remote_worker_restarts": 0}, "num_env_steps_sampled_lifetime": -3695000.0, "fault_tolerance": {"num_healthy_workers": 0, "num_remote_worker_restarts": 0}, "env_runner_group": {"actor_manager_num_outstanding_async_reqs": 0}, "done": false, "training_iteration": 8, "trial_id": "b154b_00000", "date": "2025-08-11_18-12-47", "timestamp": 1754928767, "time_this_iter_s": 9.251288175582886, "time_total_s": 82.33288717269897, "pid": 10455, "hostname": "Mac", "node_ip": "127.0.0.1", "config": {"exploration_config": {}, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 2, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "env": "Umbrella", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": false, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 0, "create_local_env_runner": true, "num_envs_per_env_runner": 1, "gym_env_vectorize_mode": "SYNC", "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "episodes_to_numpy": true, "max_requests_in_flight_per_env_runner": 1, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "merge_env_runner_states": "training_only", "broadcast_env_runner_states": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "complete_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "sampler_perf_stats_ema_coef": null, "_is_online": true, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": "auto", "num_aggregator_actors_per_learner": 0, "max_requests_in_flight_per_aggregator_actor": 3, "local_gpu_idx": 0, "max_requests_in_flight_per_learner": 3, "gamma": 1, "lr": 0.0002715581955, "grad_clip": 0.5, "grad_clip_by": "global_norm", "_train_batch_size_per_learner": 5000, "train_batch_size": 4000, "num_epochs": 1, "minibatch_size": 1000, "shuffle_batch_per_epoch": true, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "log_std_clip_param": 20.0, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "_disable_preprocessor_api": false, "_disable_action_flattening": false}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {"intrinsic_reward_coeff": 0.2795015916508}, "optimizer": {}, "_learner_class": "<class 'source.intrinsic_attention_ppo.learners.IntrinsicAttentionMetaLearner.IntrinsicAttentionMetaLearner'>", "callbacks_on_algorithm_init": null, "callbacks_on_env_runners_recreated": null, "callbacks_on_offline_eval_runners_recreated": null, "callbacks_on_checkpoint_loaded": null, "callbacks_on_environment_created": null, "callbacks_on_episode_created": null, "callbacks_on_episode_start": null, "callbacks_on_episode_step": null, "callbacks_on_episode_end": null, "callbacks_on_evaluate_start": null, "callbacks_on_evaluate_end": null, "callbacks_on_evaluate_offline_start": null, "callbacks_on_evaluate_offline_end": null, "callbacks_on_sample_end": null, "callbacks_on_train_result": null, "explore": true, "enable_rl_module_and_learner": true, "enable_env_runner_and_connector_v2": true, "_prior_exploration_config": {"type": "StochasticSampling"}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x1514e58a0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "offline_data_class": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_read_batch_size": null, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "materialize_data": false, "materialize_mapped_data": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "ignore_final_observation": false, "prelearner_class": null, "prelearner_buffer_class": null, "prelearner_buffer_kwargs": {}, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_remaining_data": false, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": 1, "evaluation_duration": 20, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_auto_duration_min_env_steps_per_sample": 100, "evaluation_auto_duration_max_env_steps_per_sample": 2000, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 1, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "offline_evaluation_interval": null, "num_offline_eval_runners": 0, "offline_loss_for_module_fn": null, "offline_evaluation_duration": 1, "offline_evaluation_parallel_to_training": false, "offline_evaluation_timeout_s": 120.0, "num_cpus_per_offline_eval_runner": 1, "num_gpus_per_offline_eval_runner": 0, "custom_resources_per_offline_eval_runner": {}, "restart_failed_offline_eval_runners": true, "ignore_offline_eval_runner_failures": false, "max_num_offline_eval_runner_restarts": 1000, "offline_eval_runner_restore_timeout_s": 1800.0, "max_requests_in_flight_per_offline_eval_runner": 1, "validate_offline_eval_runners_after_construction": true, "offline_eval_runner_health_probe_timeout_s": 30.0, "offline_eval_rl_module_inference_only": false, "broadcast_offline_eval_runner_states": false, "offline_eval_batch_size_per_runner": 256, "dataset_num_iters_per_eval_runner": 1, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "log_gradients": false, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 4, "restart_failed_env_runners": true, "ignore_env_runner_failures": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30.0, "env_runner_restore_timeout_s": 1800.0, "_model_config": {}, "_rl_module_spec": "MultiRLModuleSpec(multi_rl_module_class=<class 'ray.rllib.core.rl_module.multi_rl_module.MultiRLModule'>, observation_space=None, action_space=None, inference_only=False, model_config=None, rl_module_specs={'default_policy': RLModuleSpec(module_class=<class 'source.intrinsic_attention_ppo.rl_modules.DifferentiablePPOModule.DifferentiablePPOModule'>, observation_space=None, action_space=None, inference_only=False, learner_only=False, model_config={'vf_share_layers': True, 'embedding_dim': 62, 'max_seq_len': 11, 'policy_head_hidden_sizes': [32], 'value_head_hidden_sizes': [101], 'embedding_hidden_sizes': [121]}, catalog_class=None, load_state_path=None, model_config_dict=None), 'intrinsic_reward_module': RLModuleSpec(module_class=<class 'source.intrinsic_attention_ppo.rl_modules.IntrinsicAttentionModule.IntrinsicAttentionModule'>, observation_space=None, action_space=None, inference_only=False, learner_only=True, model_config={'intrinsic_reward_network': {'encoder_hidden_sizes': [], 'encoding_dim': 1, 'num_heads': 1, 'head_hidden_sizes': None, 'layers': [{'type': 'attention'}]}, 'extrinsic_value_hidden_layers': [127, 60], 'vf_share_layers': True, 'max_seq_len': 11}, catalog_class=None, load_state_path=None, model_config_dict=None)}, load_state_path=None, modules_to_load=None, module_specs={'default_policy': RLModuleSpec(module_class=<class 'source.intrinsic_attention_ppo.rl_modules.DifferentiablePPOModule.DifferentiablePPOModule'>, observation_space=None, action_space=None, inference_only=False, learner_only=False, model_config={'vf_share_layers': True, 'embedding_dim': 62, 'max_seq_len': 11, 'policy_head_hidden_sizes': [32], 'value_head_hidden_sizes': [101], 'embedding_hidden_sizes': [121]}, catalog_class=None, load_state_path=None, model_config_dict=None), 'intrinsic_reward_module': RLModuleSpec(module_class=<class 'source.intrinsic_attention_ppo.rl_modules.IntrinsicAttentionModule.IntrinsicAttentionModule'>, observation_space=None, action_space=None, inference_only=False, learner_only=True, model_config={'intrinsic_reward_network': {'encoder_hidden_sizes': [], 'encoding_dim': 1, 'num_heads': 1, 'head_hidden_sizes': None, 'layers': [{'type': 'attention'}]}, 'extrinsic_value_hidden_layers': [127, 60], 'vf_share_layers': True, 'max_seq_len': 11}, catalog_class=None, load_state_path=None, model_config_dict=None)})", "algorithm_config_overrides_per_module": {"intrinsic_reward_module": {"lr": 0.0002715581955}}, "_per_module_overrides": {}, "_validate_config": true, "_use_msgpack_checkpoints": false, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "env_task_fn": -1, "enable_connectors": -1, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.161583927863, "kl_target": 0.0201019014258, "vf_loss_coeff": 0.7790510010087, "entropy_coeff": 0.0015431216992, "clip_param": 0.2459212356676, "vf_clip_param": 0.3769744131561, "entropy_coeff_schedule": null, "lr_schedule": null, "sgd_minibatch_size": -1, "vf_share_layers": -1, "differentiable_learner_configs": ["DifferentiableLearnerConfig(learner_class=<class 'source.intrinsic_attention_ppo.learners.IntrinsicAttentionPPOLearner.IntrinsicAttentionPPOLearner'>, learner_connector=None, add_default_connectors_to_learner_pipeline=True, is_multi_agent=False, policies_to_update=['default_policy'], lr=0.0060984166342, num_total_minibatches=0, num_epochs=1, minibatch_size=1000, shuffle_batch_per_epoch=True)"], "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9485408017724, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.callbacks.callbacks.RLlibCallback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 82.33288717269897, "iterations_since_restore": 8, "perf": {"cpu_util_percent": 34.12142857142857, "ram_util_percent": 80.92142857142858}}
{"timers": {"training_iteration": 10.18270744332028, "restore_env_runners": 1.0753025643574932e-05, "training_step": 10.182508132384742, "env_runner_sampling_timer": 1.8225516893421037, "learner_update_timer": 8.180041683286058, "synch_weights": 0.0015144348198348014, "restore_eval_env_runners": 7.726712762588407e-05, "evaluation_iteration": 0.21251911359999193, "synch_eval_env_connectors": 0.00022706007692391408, "synch_env_connectors": 5.138198597646062e-06}, "env_runners": {"num_env_steps_sampled": 5000.0, "episode_return_max": 12.5, "env_to_module_connector": {"timers": {"connectors": {"add_time_dim_to_batch_and_zero_pad": 8.491969325851918e-06, "add_observations_from_episodes_to_batch": 3.322050289272128e-06, "batch_individual_items": 1.4350972318620647e-05, "numpy_to_tensor": 1.6723203034618742e-05, "add_states_from_episodes_to_batch": 3.0989528916118235e-06}}, "connector_pipeline_timer": 7.267639806223406e-05}, "episode_len_min": 20, "module_to_env_connector": {"timers": {"connectors": {"un_batch_to_individual_items": 7.798640443013696e-06, "normalize_and_clip_actions": 9.548621139846798e-06, "remove_single_ts_time_rank_from_batch": 1.4808878832095626e-05, "get_actions": 5.7730437780410865e-05, "tensor_to_numpy": 2.032720911883213e-05, "listify_data_for_vector_env": 1.2425505443752518e-05}}, "connector_pipeline_timer": 0.00015344861305033618}, "env_step_timer": 1.9931531107573017e-05, "num_agent_steps_sampled_lifetime": {"default_agent": -4312500.0}, "num_episodes": 250.0, "episode_duration_sec_mean": 0.006752031024545433, "episode_len_mean": 20.0, "module_episode_returns_mean": {"default_policy": 3.62}, "weights_seq_no": 8.0, "env_to_module_sum_episodes_length_out": 10.36823839457432, "num_env_steps_sampled_lifetime": -4312500.0, "episode_len_max": 20, "rlmodule_inference_timer": 4.160705052258279e-05, "num_agent_steps_sampled": {"default_agent": 5000.0}, "env_reset_timer": 5.6307676377464184e-05, "agent_episode_returns_mean": {"default_agent": 3.62}, "env_to_module_sum_episodes_length_in": 10.36823839457432, "episode_return_mean": 3.62, "time_between_sampling": 0.031560071924751, "num_module_steps_sampled_lifetime": {"default_policy": -4312500.0}, "num_module_steps_sampled": {"default_policy": 5000.0}, "num_episodes_lifetime": -215625.0, "episode_return_min": -7.5, "sample": 0.006811524163997216, "num_env_steps_sampled_lifetime_throughput": 2900.256877962348}, "__all_modules__": {"learner_connector_sum_episodes_length_in": 5000.0, "learner_connector": {"connector_pipeline_timer": 0.13900814740333794, "timers": {"connectors": {"add_one_ts_to_episodes_and_truncate": 0.009524088652530318, "add_observations_from_episodes_to_batch": 0.0010364627173035637, "add_columns_from_episodes_to_train_batch": 0.04403298724587249, "add_time_dim_to_batch_and_zero_pad": 0.07620742911207808, "add_states_from_episodes_to_batch": 0.003586406070108623, "batch_individual_items": 0.0043584249373891425, "numpy_to_tensor": 7.29119106999815e-05}}}, "learner_connector_sum_episodes_length_out": 5250.0}, "learners": {"__all_modules__": {"num_module_steps_trained_lifetime": 107730, "num_env_steps_trained": 33000, "num_env_steps_trained_lifetime": 297000, "num_non_trainable_parameters": 0, "num_trainable_parameters": 24861, "num_module_steps_trained": 11970, "num_env_steps_trained_lifetime_throughput": 3936.1719863337753, "num_module_steps_trained_throughput": 25897077.665373556, "num_module_steps_trained_lifetime_throughput": 12732542.367871864}, "default_policy": {"curr_entropy_coeff": 0.0015431216992, "weights_seq_no": 9.0, "curr_kl_coeff": 0.00031559361377730966, "policy_loss": -5.031209730077535e-05, "module_train_batch_size_mean": 997.7895308613665, "num_trainable_parameters": 16595, "vf_loss": 0.3583056628704071, "mean_kl_loss": 5.950989361735992e-06, "diff_num_grad_updates_vs_sampler_policy": 1.0, "vf_explained_var": -0.0009214878082275391, "use_intrinsic_rewards": 0.0, "entropy": 0.6845101714134216, "num_module_steps_trained": 5985, "vf_loss_unclipped": 44.008209228515625, "total_loss": 0.2780317962169647, "num_module_steps_trained_lifetime": 53865, "num_module_steps_trained_lifetime_throughput": 713.6295247074844}, "differentiable_learners": {"intrinsic_attention_ppo_learner": {"__all_modules__": {"num_module_steps_trained_lifetime": 646380, "num_env_steps_trained_lifetime": 1782000, "num_module_steps_trained": 71820, "num_env_steps_trained": 198000, "num_env_steps_trained_lifetime_throughput": 48541.76371531231}, "default_policy": {"weights_seq_no": 54.0, "policy_loss": -4.95885506097693e-05, "module_train_batch_size_mean": 997.5168494263723, "vf_loss": 0.3583166003227234, "mean_kl_loss": 5.7376323638891336e-06, "diff_num_grad_updates_vs_sampler_policy": 46.0, "vf_explained_var": 0.0027307868003845215, "use_intrinsic_rewards": 1.0, "entropy": 0.6845183968544006, "num_module_steps_trained": 35910, "vf_loss_unclipped": 43.91192626953125, "total_loss": 0.2780419588088989, "num_module_steps_trained_lifetime": 323190}, "intrinsic_reward_module": {"total_loss": 0.0, "num_module_steps_trained_lifetime": 323190, "module_train_batch_size_mean": 997.5168494263723, "weights_seq_no": 54.0, "num_module_steps_trained": 35910, "diff_num_grad_updates_vs_sampler_policy": 46.0}}}, "intrinsic_reward_module": {"diff_num_grad_updates_vs_sampler_policy": 1.0, "gradients_default_optimizer_global_norm": 0.0, "curr_entropy_coeff": 0.0015431216992, "weights_seq_no": 9.0, "default_optimizer_learning_rate": 0.0002715581955, "total_loss": 0.0, "num_module_steps_trained_lifetime": 53865, "module_train_batch_size_mean": 997.7895308613665, "num_trainable_parameters": 8266, "num_module_steps_trained": 5985, "num_module_steps_trained_lifetime_throughput": 713.6388238557234}, "IntrinsicAttentionMask": [[[0.08866933733224869, 0.09068365395069122, 0.09060901403427124, 0.09053443372249603, 0.09158690273761749, 0.09122122079133987, 0.09228167682886124, 0.09136092662811279, 0.0909961462020874, 0.09092124551534653, 0.09113550186157227], [0.08741173893213272, 0.09055158495903015, 0.09043451398611069, 0.09031759947538376, 0.09197255969047546, 0.09139630943536758, 0.09307104349136353, 0.09161630272865295, 0.09104228019714355, 0.09092457592487335, 0.09126142412424088], [0.0874575823545456, 0.09055647999048233, 0.09044095873832703, 0.09032559394836426, 0.09195845574140549, 0.09138993918895721, 0.0930420458316803, 0.0916069895029068, 0.09104064106941223, 0.09092450886964798, 0.09125686436891556], [0.08750343322753906, 0.09056136012077332, 0.09044739603996277, 0.09033357352018356, 0.09194432944059372, 0.09138356149196625, 0.09301304072141647, 0.09159765392541885, 0.09103899449110031, 0.09092442691326141, 0.09125228226184845], [0.08686177432537079, 0.09049256145954132, 0.09035681933164597, 0.09022127836942673, 0.09214241802692413, 0.09147284924983978, 0.09342063218355179, 0.09172838926315308, 0.09106182307004929, 0.09092523157596588, 0.09131621569395065], [0.08708342164754868, 0.09051644802093506, 0.09038824588060379, 0.09026021510362625, 0.09207388758659363, 0.09144201129674911, 0.09327942878007889, 0.09168319404125214, 0.09105399996042252, 0.09092503041028976, 0.09129416197538376], [0.0864444226026535, 0.09044723957777023, 0.09029728174209595, 0.09014756977558136, 0.09227178990840912, 0.09153091162443161, 0.09368772804737091, 0.0918135941028595, 0.09107638895511627, 0.09092538803815842, 0.09135767817497253], [0.0869985818862915, 0.09050732105970383, 0.09037622809410095, 0.0902453288435936, 0.0921000987291336, 0.09145381301641464, 0.0933334231376648, 0.0917004868388176, 0.09105700254440308, 0.09092511236667633, 0.09130260348320007], [0.08722051978111267, 0.09053115546703339, 0.0904076024889946, 0.09028421342372894, 0.09203153848648071, 0.0914229303598404, 0.09319229423999786, 0.09165524691343307, 0.09104912728071213, 0.09092485904693604, 0.091280497610569], [0.08726625889539719, 0.09053605049848557, 0.09041404724121094, 0.09029220789670944, 0.09201741963624954, 0.09141656011343002, 0.09316325932741165, 0.09164592623710632, 0.0910474881529808, 0.09092479944229126, 0.09127593785524368], [0.08713556826114655, 0.09052204340696335, 0.09039560705423355, 0.09026934951543808, 0.09205776453018188, 0.09143474698066711, 0.09324625879526138, 0.09167256206274033, 0.09105214476585388, 0.09092496335506439, 0.09128895401954651]], [[0.09112118929624557, 0.09193547815084457, 0.09253046661615372, 0.09094808250665665, 0.09176082164049149, 0.09147868305444717, 0.09164457023143768, 0.0922376811504364, 0.08475914597511292, 0.09092437475919724, 0.090659499168396], [0.09119024872779846, 0.09231812506914139, 0.09314467012882233, 0.09095097333192825, 0.0920758917927742, 0.09168494492769241, 0.09191474318504333, 0.09273768216371536, 0.08251204341650009, 0.09091821312904358, 0.09055245667695999], [0.09123633056879044, 0.09259249269962311, 0.0935884490609169, 0.09094904363155365, 0.09230094403028488, 0.09183073788881302, 0.09210708737373352, 0.09309782087802887, 0.08091643452644348, 0.09090973436832428, 0.09047092497348785], [0.09110558778047562, 0.09185303747653961, 0.09239885210990906, 0.09094661474227905, 0.09169276803731918, 0.0914338007569313, 0.09158606827259064, 0.09213030338287354, 0.08524652570486069, 0.09092484414577484, 0.0906815454363823], [0.09117602556943893, 0.09223675727844238, 0.09301360696554184, 0.09095089882612228, 0.09200900048017502, 0.091641366481781, 0.09185748547315598, 0.09263113886117935, 0.08298777043819427, 0.09092007577419281, 0.09057586640119553], [0.0911523848772049, 0.09210450202226639, 0.09280110895633698, 0.09095015376806259, 0.09190016239881516, 0.09157021343708038, 0.0917641893029213, 0.09245822578668594, 0.08376345038414001, 0.09092246741056442, 0.09061316400766373], [0.09116638451814651, 0.09218237549066544, 0.09292615950107574, 0.09095068275928497, 0.09196427464485168, 0.09161215275526047, 0.0918191596865654, 0.09256000071763992, 0.08330629765987396, 0.09092114865779877, 0.09059131145477295], [0.09121409803628922, 0.09245801717042923, 0.09337058663368225, 0.09095039963722229, 0.09219072759151459, 0.09175949543714523, 0.09201295673847198, 0.09292113780975342, 0.08169680088758469, 0.09091430902481079, 0.09051138162612915], [0.0903061181306839, 0.08863039314746857, 0.0874347984790802, 0.09066837280988693, 0.08898593485355377, 0.0895647257566452, 0.08922374248504639, 0.08802014589309692, 0.10517048090696335, 0.09071815013885498, 0.09127707034349442], [0.0911034420132637, 0.09184173494577408, 0.0923808142542839, 0.09094640612602234, 0.09168342500925064, 0.09142763912677765, 0.09157804399728775, 0.09211558103561401, 0.08531355112791061, 0.09092490375041962, 0.09068455547094345], [0.09107886254787445, 0.0917147621512413, 0.09217863529920578, 0.09094351530075073, 0.09157847613096237, 0.09135819226503372, 0.09148772805929184, 0.09195045381784439, 0.08606675267219543, 0.09092497825622559, 0.09071775525808334]], [[0.0883692130446434, 0.09037671983242035, 0.09142735600471497, 0.09022799879312515, 0.09127690643072128, 0.09204509109258652, 0.09083762764930725, 0.09105169028043747, 0.09181798249483109, 0.09174240380525589, 0.09082703292369843], [0.08694633841514587, 0.09006946533918381, 0.09171988815069199, 0.0898367166519165, 0.09148287773132324, 0.09269534796476364, 0.09079215675592422, 0.09112850576639175, 0.09233628213405609, 0.09221690893173218, 0.0907755196094513], [0.08622191846370697, 0.08991047739982605, 0.09186943620443344, 0.08963476121425629, 0.09158771485090256, 0.09303037077188492, 0.09076745808124542, 0.09116674214601517, 0.09260276705026627, 0.09246067702770233, 0.09074770659208298], [0.08704999089241028, 0.09009207040071487, 0.09169851988554001, 0.08986546099185944, 0.09146787971258163, 0.09264763444662094, 0.0907956063747406, 0.09112299233675003, 0.09229830652475357, 0.09218215197324753, 0.09077940881252289], [0.08632481843233109, 0.08993315696716309, 0.09184815734624863, 0.0896635577082634, 0.09157281368970871, 0.09298260509967804, 0.09077101945877075, 0.0911613404750824, 0.09256479889154434, 0.09242594987154007, 0.09075172245502472], [0.08580224961042404, 0.08981756120920181, 0.0919562578201294, 0.08951689302921295, 0.09164842218160629, 0.09322568774223328, 0.09075264632701874, 0.09118860960006714, 0.09275796264410019, 0.09260257333517075, 0.09073109924793243], [0.08662686496973038, 0.08999956399202347, 0.09178578853607178, 0.08974789083003998, 0.09152911603450775, 0.09284276515245438, 0.09078139811754227, 0.09114544838666916, 0.09245359152555466, 0.09232423454523087, 0.0907633975148201], [0.08647937327623367, 0.08996717631816864, 0.09181623160839081, 0.08970674127340317, 0.09155044704675674, 0.09291098266839981, 0.09077634662389755, 0.09115321934223175, 0.09250784665346146, 0.09237386286258698, 0.09075771272182465], [0.08595601469278336, 0.08985167741775513, 0.09192444384098053, 0.08956015855073929, 0.09162618964910507, 0.09315402805805206, 0.09075812250375748, 0.09118063002824783, 0.09270104020833969, 0.09255053102970123, 0.0907372385263443], [0.08600731939077377, 0.08986303955316544, 0.09191381931304932, 0.08957456797361374, 0.09161876142024994, 0.09313014149665833, 0.09075993299484253, 0.09117795526981354, 0.09268206357955933, 0.092533178627491, 0.09073927253484726], [0.08663417398929596, 0.09000115841627121, 0.0917842760682106, 0.08974991738796234, 0.09152805060148239, 0.09283937513828278, 0.09078163653612137, 0.09114506095647812, 0.09245089441537857, 0.09232176095247269, 0.09076366573572159]], [[0.09198503196239471, 0.09067714214324951, 0.09274201840162277, 0.09173892438411713, 0.09165703505277634, 0.09249388426542282, 0.09149347245693207, 0.09232883155345917, 0.08306752890348434, 0.09170523285865784, 0.09011093527078629], [0.0916588082909584, 0.09075696766376495, 0.09217897057533264, 0.09148941189050674, 0.09143301844596863, 0.09200860559940338, 0.09132032841444016, 0.0918952152132988, 0.08542720973491669, 0.09146621078252792, 0.09036529064178467], [0.09216903895139694, 0.09062832593917847, 0.09306255728006363, 0.09187882393598557, 0.09178228676319122, 0.09276952594518661, 0.09158951789140701, 0.09257468581199646, 0.08174365013837814, 0.09183910489082336, 0.08996254950761795], [0.09192445129156113, 0.09069260209798813, 0.09263696521520615, 0.0916927307844162, 0.09161561727523804, 0.09240344911813736, 0.09146159142255783, 0.0922480970621109, 0.08350446075201035, 0.0916610062122345, 0.09015899896621704], [0.09190421551465988, 0.09069769829511642, 0.09260191768407822, 0.09167728573083878, 0.09160175919532776, 0.09237326681613922, 0.09145091474056244, 0.09222114086151123, 0.08365055918693542, 0.0916462168097496, 0.09017497301101685], [0.09210909903049469, 0.09064452350139618, 0.09295790642499924, 0.09183331578969955, 0.09174157679080963, 0.09267958253622055, 0.09155835956335068, 0.09249449521303177, 0.08217429369688034, 0.09179557114839554, 0.09001126885414124], [0.09186367690563202, 0.09070783108472824, 0.09253179281949997, 0.09164632111787796, 0.09157399088144302, 0.09231286495923996, 0.09142948687076569, 0.0921671912074089, 0.08394347131252289, 0.09161657094955444, 0.09020685404539108], [0.09206902980804443, 0.09065520018339157, 0.09288807213306427, 0.09180286526679993, 0.09171430766582489, 0.09261953830718994, 0.0915374606847763, 0.09244094789028168, 0.08246253430843353, 0.09176643192768097, 0.09004364162683487], [0.08952638506889343, 0.09108348190784454, 0.0886472538113594, 0.089815653860569, 0.0899122804403305, 0.08893368393182755, 0.09010585397481918, 0.0891251415014267, 0.10122193396091461, 0.0898553803563118, 0.09177303314208984], [0.09191612899303436, 0.09069469571113586, 0.0926225483417511, 0.09168637543916702, 0.09160991758108139, 0.09239102900028229, 0.09145719558000565, 0.09223701059818268, 0.08356451243162155, 0.09165492653846741, 0.09016556292772293], [0.0915142148733139, 0.09078963845968246, 0.09193148463964462, 0.09137821942567825, 0.09133293479681015, 0.09179487079381943, 0.09124242514371872, 0.09170391410589218, 0.08647814393043518, 0.09135959297418594, 0.09047452360391617]], [[0.08826826512813568, 0.09139814227819443, 0.09132290631532669, 0.09124773740768433, 0.09117262810468674, 0.09193994104862213, 0.09186425805091858, 0.08982855081558228, 0.09171309322118759, 0.09163760393857956, 0.08960691094398499], [0.08598247170448303, 0.0918220579624176, 0.09167957305908203, 0.09153731912374496, 0.0913952887058258, 0.0928511992096901, 0.09270711988210678, 0.0888710543513298, 0.09241964668035507, 0.09227623790502548, 0.08845800161361694], [0.08603591471910477, 0.0918121337890625, 0.09167125076055527, 0.09153058379888535, 0.09139013290405273, 0.09282968193292618, 0.09268724173307419, 0.08889368176460266, 0.09240300208330154, 0.09226121753454208, 0.08848509937524796], [0.08608938753604889, 0.0918022096157074, 0.0916629210114479, 0.09152384847402573, 0.09138498455286026, 0.09280816465616226, 0.092667356133461, 0.08891630917787552, 0.09238636493682861, 0.09224619716405869, 0.08851219713687897], [0.0861428901553154, 0.0917922854423523, 0.09165459126234055, 0.09151710569858551, 0.09137982875108719, 0.09278664737939835, 0.09264746308326721, 0.08893893659114838, 0.09236972033977509, 0.09223116189241409, 0.08853930234909058], [0.08559969067573547, 0.09189310669898987, 0.09173916280269623, 0.09158548712730408, 0.09143206477165222, 0.09300559759140015, 0.09284979850053787, 0.08870863914489746, 0.0925389751791954, 0.09238395094871521, 0.08826357871294022], [0.08565293252468109, 0.09188321977853775, 0.09173087030649185, 0.09157878905534744, 0.09142695367336273, 0.09298408776521683, 0.09282992035150528, 0.08873126655817032, 0.09252235293388367, 0.0923689529299736, 0.08829064667224884], [0.08711258322000504, 0.09161240607500076, 0.09150342643260956, 0.0913945734500885, 0.09128585457801819, 0.09239840507507324, 0.09228849411010742, 0.08934707194566727, 0.09206905961036682, 0.09195953607559204, 0.08902859687805176], [0.08575950562953949, 0.09186343848705292, 0.0917142927646637, 0.09156538546085358, 0.09141672402620316, 0.09294106811285019, 0.09279017150402069, 0.08877652138471603, 0.09248911589384079, 0.09233894944190979, 0.08834482729434967], [0.08581283688545227, 0.0918535366654396, 0.09170598536729813, 0.09155867248773575, 0.09141159802675247, 0.09291955828666687, 0.0927703008055687, 0.08879915624856949, 0.09247249364852905, 0.09232394397258759, 0.08837191015481949], [0.08727475255727768, 0.09158232808113098, 0.09147811681032181, 0.09137402474880219, 0.09127004444599152, 0.09233379364013672, 0.0922287255525589, 0.08941495418548584, 0.09201894700527191, 0.09191424399614334, 0.08911006897687912]], [[0.09061349928379059, 0.090488500893116, 0.09176883101463318, 0.09023899585008621, 0.08826329559087753, 0.08951213955879211, 0.08986604958772659, 0.08926533162593842, 0.10538063943386078, 0.09018778055906296, 0.08441494405269623], [0.09061876684427261, 0.09049531072378159, 0.09175963699817657, 0.09024891257286072, 0.08829738944768906, 0.08953101187944412, 0.0898805633187294, 0.08928723633289337, 0.1051882728934288, 0.0901983231306076, 0.08449456840753555], [0.09056326001882553, 0.09042402356863022, 0.09185120463371277, 0.09014617651700974, 0.08794910460710526, 0.08933722972869873, 0.08973100781440735, 0.08906272798776627, 0.10716027021408081, 0.09008914232254028, 0.08368583768606186], [0.09062917530536652, 0.090508833527565, 0.0917411521077156, 0.09026861190795898, 0.08836550265550613, 0.08956864476203918, 0.08990948647260666, 0.08933091908693314, 0.10480445623397827, 0.09021928906440735, 0.08465395122766495], [0.0907067358493805, 0.09061132371425629, 0.09158702194690704, 0.09042081981897354, 0.08890772610902786, 0.0898650735616684, 0.09013579785823822, 0.089676134288311, 0.10177059471607208, 0.0903816893696785, 0.08593709021806717], [0.09065871685743332, 0.09054747223854065, 0.09168603271245956, 0.09032539278268814, 0.08856439590454102, 0.08967802673578262, 0.08999329805374146, 0.08945807814598083, 0.10368713736534119, 0.09027978777885437, 0.08512161672115326], [0.090644471347332, 0.09052879363298416, 0.09171309322118759, 0.09029786288738251, 0.08846746385097504, 0.0896248146891594, 0.08995256572961807, 0.08939618617296219, 0.10423099249601364, 0.09025043994188309, 0.08489327877759933], [0.09066847711801529, 0.09056034684181213, 0.09166690707206726, 0.09034446626901627, 0.08863208442926407, 0.08971507847309113, 0.09002161771059036, 0.08950121700763702, 0.1033080592751503, 0.09030013531446457, 0.08528156578540802], [0.08978091925382614, 0.0894882008433342, 0.09251243621110916, 0.08890562504529953, 0.08436962217092514, 0.08722088485956192, 0.0880388617515564, 0.08665306866168976, 0.12831886112689972, 0.088786281645298, 0.07592529058456421], [0.09063128381967545, 0.09051158279180527, 0.09173731505870819, 0.09027263522148132, 0.08837948739528656, 0.089576356112957, 0.08991540223360062, 0.08933988958597183, 0.1047256663441658, 0.09022357314825058, 0.08468673378229141], [0.09083177149295807, 0.09078675508499146, 0.09124593436717987, 0.0906967967748642, 0.08997870236635208, 0.09043379127979279, 0.09056202322244644, 0.09034418314695358, 0.09589186310768127, 0.09067831188440323, 0.08854982256889343]]]}, "num_training_step_calls_per_iteration": 1, "evaluation": {"env_runners": {"episode_len_max": 20, "rlmodule_inference_timer": 3.1856761481211394e-05, "num_module_steps_sampled": {"default_policy": 400}, "sample": 0.17096554508787687, "env_to_module_connector": {"timers": {"connectors": {"add_states_from_episodes_to_batch": 2.79874667853846e-06, "add_time_dim_to_batch_and_zero_pad": 6.805073594326097e-06, "add_observations_from_episodes_to_batch": 2.81017912625605e-06, "numpy_to_tensor": 1.217179791100899e-05, "batch_individual_items": 1.2342437735932154e-05}}, "connector_pipeline_timer": 5.923620913536201e-05}, "module_episode_returns_mean": {"default_policy": -0.45}, "module_to_env_connector": {"timers": {"connectors": {"normalize_and_clip_actions": 7.821307334651144e-06, "remove_single_ts_time_rank_from_batch": 1.1789117668641329e-05, "tensor_to_numpy": 1.5106007979522473e-05, "listify_data_for_vector_env": 1.0178599159045545e-05, "un_batch_to_individual_items": 6.5120456681643775e-06, "get_actions": 3.781445144542275e-05}}, "connector_pipeline_timer": 0.00011585992871939836}, "episode_duration_sec_mean": 0.0056022433622274544, "weights_seq_no": 9.0, "env_to_module_sum_episodes_length_out": 10.368238394574323, "agent_episode_returns_mean": {"default_agent": -0.45}, "episode_return_mean": -0.45, "env_to_module_sum_episodes_length_in": 10.368238394574323, "num_episodes_lifetime": 180, "num_agent_steps_sampled_lifetime": {"default_agent": 3600}, "num_episodes": 20, "episode_len_mean": 20.0, "num_agent_steps_sampled": {"default_agent": 400}, "num_module_steps_sampled_lifetime": {"default_policy": 3600}, "env_reset_timer": 0.0022968102620779043, "episode_return_min": -16.5, "num_env_steps_sampled": 400, "episode_len_min": 20, "episode_return_max": 12.5, "env_step_timer": 1.4006222326176132e-05, "num_env_steps_sampled_lifetime": 45400, "time_between_sampling": 10.900163311019423}, "num_healthy_workers": 1, "actor_manager_num_outstanding_async_reqs": 0, "num_remote_worker_restarts": 0}, "num_env_steps_sampled_lifetime": -4312500.0, "fault_tolerance": {"num_healthy_workers": 0, "num_remote_worker_restarts": 0}, "env_runner_group": {"actor_manager_num_outstanding_async_reqs": 0}, "done": false, "training_iteration": 9, "trial_id": "b154b_00000", "date": "2025-08-11_18-12-57", "timestamp": 1754928777, "time_this_iter_s": 9.654157876968384, "time_total_s": 91.98704504966736, "pid": 10455, "hostname": "Mac", "node_ip": "127.0.0.1", "config": {"exploration_config": {}, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 2, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "env": "Umbrella", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": false, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 0, "create_local_env_runner": true, "num_envs_per_env_runner": 1, "gym_env_vectorize_mode": "SYNC", "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "episodes_to_numpy": true, "max_requests_in_flight_per_env_runner": 1, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "merge_env_runner_states": "training_only", "broadcast_env_runner_states": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "complete_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "sampler_perf_stats_ema_coef": null, "_is_online": true, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": "auto", "num_aggregator_actors_per_learner": 0, "max_requests_in_flight_per_aggregator_actor": 3, "local_gpu_idx": 0, "max_requests_in_flight_per_learner": 3, "gamma": 1, "lr": 0.0002715581955, "grad_clip": 0.5, "grad_clip_by": "global_norm", "_train_batch_size_per_learner": 5000, "train_batch_size": 4000, "num_epochs": 1, "minibatch_size": 1000, "shuffle_batch_per_epoch": true, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "log_std_clip_param": 20.0, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "_disable_preprocessor_api": false, "_disable_action_flattening": false}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {"intrinsic_reward_coeff": 0.2795015916508}, "optimizer": {}, "_learner_class": "<class 'source.intrinsic_attention_ppo.learners.IntrinsicAttentionMetaLearner.IntrinsicAttentionMetaLearner'>", "callbacks_on_algorithm_init": null, "callbacks_on_env_runners_recreated": null, "callbacks_on_offline_eval_runners_recreated": null, "callbacks_on_checkpoint_loaded": null, "callbacks_on_environment_created": null, "callbacks_on_episode_created": null, "callbacks_on_episode_start": null, "callbacks_on_episode_step": null, "callbacks_on_episode_end": null, "callbacks_on_evaluate_start": null, "callbacks_on_evaluate_end": null, "callbacks_on_evaluate_offline_start": null, "callbacks_on_evaluate_offline_end": null, "callbacks_on_sample_end": null, "callbacks_on_train_result": null, "explore": true, "enable_rl_module_and_learner": true, "enable_env_runner_and_connector_v2": true, "_prior_exploration_config": {"type": "StochasticSampling"}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x1514e58a0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "offline_data_class": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_read_batch_size": null, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "materialize_data": false, "materialize_mapped_data": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "ignore_final_observation": false, "prelearner_class": null, "prelearner_buffer_class": null, "prelearner_buffer_kwargs": {}, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_remaining_data": false, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": 1, "evaluation_duration": 20, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_auto_duration_min_env_steps_per_sample": 100, "evaluation_auto_duration_max_env_steps_per_sample": 2000, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 1, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "offline_evaluation_interval": null, "num_offline_eval_runners": 0, "offline_loss_for_module_fn": null, "offline_evaluation_duration": 1, "offline_evaluation_parallel_to_training": false, "offline_evaluation_timeout_s": 120.0, "num_cpus_per_offline_eval_runner": 1, "num_gpus_per_offline_eval_runner": 0, "custom_resources_per_offline_eval_runner": {}, "restart_failed_offline_eval_runners": true, "ignore_offline_eval_runner_failures": false, "max_num_offline_eval_runner_restarts": 1000, "offline_eval_runner_restore_timeout_s": 1800.0, "max_requests_in_flight_per_offline_eval_runner": 1, "validate_offline_eval_runners_after_construction": true, "offline_eval_runner_health_probe_timeout_s": 30.0, "offline_eval_rl_module_inference_only": false, "broadcast_offline_eval_runner_states": false, "offline_eval_batch_size_per_runner": 256, "dataset_num_iters_per_eval_runner": 1, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "log_gradients": false, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 4, "restart_failed_env_runners": true, "ignore_env_runner_failures": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30.0, "env_runner_restore_timeout_s": 1800.0, "_model_config": {}, "_rl_module_spec": "MultiRLModuleSpec(multi_rl_module_class=<class 'ray.rllib.core.rl_module.multi_rl_module.MultiRLModule'>, observation_space=None, action_space=None, inference_only=False, model_config=None, rl_module_specs={'default_policy': RLModuleSpec(module_class=<class 'source.intrinsic_attention_ppo.rl_modules.DifferentiablePPOModule.DifferentiablePPOModule'>, observation_space=None, action_space=None, inference_only=False, learner_only=False, model_config={'vf_share_layers': True, 'embedding_dim': 62, 'max_seq_len': 11, 'policy_head_hidden_sizes': [32], 'value_head_hidden_sizes': [101], 'embedding_hidden_sizes': [121]}, catalog_class=None, load_state_path=None, model_config_dict=None), 'intrinsic_reward_module': RLModuleSpec(module_class=<class 'source.intrinsic_attention_ppo.rl_modules.IntrinsicAttentionModule.IntrinsicAttentionModule'>, observation_space=None, action_space=None, inference_only=False, learner_only=True, model_config={'intrinsic_reward_network': {'encoder_hidden_sizes': [], 'encoding_dim': 1, 'num_heads': 1, 'head_hidden_sizes': None, 'layers': [{'type': 'attention'}]}, 'extrinsic_value_hidden_layers': [127, 60], 'vf_share_layers': True, 'max_seq_len': 11}, catalog_class=None, load_state_path=None, model_config_dict=None)}, load_state_path=None, modules_to_load=None, module_specs={'default_policy': RLModuleSpec(module_class=<class 'source.intrinsic_attention_ppo.rl_modules.DifferentiablePPOModule.DifferentiablePPOModule'>, observation_space=None, action_space=None, inference_only=False, learner_only=False, model_config={'vf_share_layers': True, 'embedding_dim': 62, 'max_seq_len': 11, 'policy_head_hidden_sizes': [32], 'value_head_hidden_sizes': [101], 'embedding_hidden_sizes': [121]}, catalog_class=None, load_state_path=None, model_config_dict=None), 'intrinsic_reward_module': RLModuleSpec(module_class=<class 'source.intrinsic_attention_ppo.rl_modules.IntrinsicAttentionModule.IntrinsicAttentionModule'>, observation_space=None, action_space=None, inference_only=False, learner_only=True, model_config={'intrinsic_reward_network': {'encoder_hidden_sizes': [], 'encoding_dim': 1, 'num_heads': 1, 'head_hidden_sizes': None, 'layers': [{'type': 'attention'}]}, 'extrinsic_value_hidden_layers': [127, 60], 'vf_share_layers': True, 'max_seq_len': 11}, catalog_class=None, load_state_path=None, model_config_dict=None)})", "algorithm_config_overrides_per_module": {"intrinsic_reward_module": {"lr": 0.0002715581955}}, "_per_module_overrides": {}, "_validate_config": true, "_use_msgpack_checkpoints": false, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "env_task_fn": -1, "enable_connectors": -1, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.161583927863, "kl_target": 0.0201019014258, "vf_loss_coeff": 0.7790510010087, "entropy_coeff": 0.0015431216992, "clip_param": 0.2459212356676, "vf_clip_param": 0.3769744131561, "entropy_coeff_schedule": null, "lr_schedule": null, "sgd_minibatch_size": -1, "vf_share_layers": -1, "differentiable_learner_configs": ["DifferentiableLearnerConfig(learner_class=<class 'source.intrinsic_attention_ppo.learners.IntrinsicAttentionPPOLearner.IntrinsicAttentionPPOLearner'>, learner_connector=None, add_default_connectors_to_learner_pipeline=True, is_multi_agent=False, policies_to_update=['default_policy'], lr=0.0060984166342, num_total_minibatches=0, num_epochs=1, minibatch_size=1000, shuffle_batch_per_epoch=True)"], "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9485408017724, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.callbacks.callbacks.RLlibCallback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 91.98704504966736, "iterations_since_restore": 9, "perf": {"cpu_util_percent": 41.06923076923078, "ram_util_percent": 81.1846153846154}}
{"timers": {"training_iteration": 10.177005137226875, "restore_env_runners": 1.0709245581524831e-05, "training_step": 10.176805831481014, "env_runner_sampling_timer": 1.819896270368236, "learner_update_timer": 8.176974251873117, "synch_weights": 0.0015085079713917763, "restore_eval_env_runners": 7.656612627835476e-05, "evaluation_iteration": 0.21164233829476994, "synch_eval_env_connectors": 0.00022578947562009577, "synch_env_connectors": 5.128476998738588e-06}, "env_runners": {"num_env_steps_sampled": 5000.0, "episode_return_max": 12.5, "env_to_module_connector": {"timers": {"connectors": {"add_time_dim_to_batch_and_zero_pad": 6.9828252438118816e-06, "add_observations_from_episodes_to_batch": 2.8350891168847014e-06, "batch_individual_items": 1.259381129926294e-05, "numpy_to_tensor": 1.2693853611766988e-05, "add_states_from_episodes_to_batch": 2.734848653869024e-06}}, "connector_pipeline_timer": 6.020278421856674e-05}, "episode_len_min": 20, "module_to_env_connector": {"timers": {"connectors": {"un_batch_to_individual_items": 6.71517648432262e-06, "normalize_and_clip_actions": 8.140674082388291e-06, "remove_single_ts_time_rank_from_batch": 1.206619425773428e-05, "get_actions": 3.9519626175093526e-05, "tensor_to_numpy": 1.518296179488454e-05, "listify_data_for_vector_env": 1.090649522753433e-05}}, "connector_pipeline_timer": 0.00011944907296518176}, "env_step_timer": 1.4041309312208623e-05, "num_agent_steps_sampled_lifetime": {"default_agent": -4930000.0}, "num_episodes": 250.0, "episode_duration_sec_mean": 0.005345227210782467, "episode_len_mean": 20.0, "module_episode_returns_mean": {"default_policy": 3.2200000000000006}, "weights_seq_no": 9.0, "env_to_module_sum_episodes_length_out": 10.36823839457432, "num_env_steps_sampled_lifetime": -4930000.0, "episode_len_max": 20, "rlmodule_inference_timer": 3.246150316931083e-05, "num_agent_steps_sampled": {"default_agent": 5000.0}, "env_reset_timer": 4.853350315635147e-05, "agent_episode_returns_mean": {"default_agent": 3.2200000000000006}, "env_to_module_sum_episodes_length_in": 10.36823839457432, "episode_return_mean": 3.2200000000000006, "time_between_sampling": 0.03136537280747849, "num_module_steps_sampled_lifetime": {"default_policy": -4930000.0}, "num_module_steps_sampled": {"default_policy": 5000.0}, "num_episodes_lifetime": -246500.0, "episode_return_min": -7.5, "sample": 0.00615711103943321, "num_env_steps_sampled_lifetime_throughput": 3193.2136572069444}, "__all_modules__": {"learner_connector_sum_episodes_length_in": 5000.0, "learner_connector": {"connector_pipeline_timer": 0.13895555425904108, "timers": {"connectors": {"add_one_ts_to_episodes_and_truncate": 0.009515289426537742, "add_observations_from_episodes_to_batch": 0.0010343339304902308, "add_columns_from_episodes_to_train_batch": 0.044003763623662616, "add_time_dim_to_batch_and_zero_pad": 0.07618746232034813, "add_states_from_episodes_to_batch": 0.003594884089771541, "batch_individual_items": 0.004357890278910204, "numpy_to_tensor": 7.314612139618025e-05}}}, "learner_connector_sum_episodes_length_out": 5250.0}, "learners": {"__all_modules__": {"num_module_steps_trained_lifetime": 119700, "num_env_steps_trained": 33000, "num_env_steps_trained_lifetime": 330000, "num_non_trainable_parameters": 0, "num_trainable_parameters": 24861, "num_module_steps_trained": 11970, "num_env_steps_trained_lifetime_throughput": 3934.0980978613447, "num_module_steps_trained_throughput": 25188645.316766776, "num_module_steps_trained_lifetime_throughput": 12698829.077256309}, "default_policy": {"curr_entropy_coeff": 0.0015431216992, "weights_seq_no": 10.0, "curr_kl_coeff": 0.00015779680688865483, "policy_loss": -0.0003468407376203686, "module_train_batch_size_mean": 997.772440523815, "num_trainable_parameters": 16595, "vf_loss": 0.35830995440483093, "mean_kl_loss": 1.629436701477971e-05, "diff_num_grad_updates_vs_sampler_policy": 1.0, "vf_explained_var": -0.001277923583984375, "use_intrinsic_rewards": 0.0, "entropy": 0.6837851405143738, "num_module_steps_trained": 5985, "vf_loss_unclipped": 43.91480255126953, "total_loss": 0.2777397036552429, "num_module_steps_trained_lifetime": 59850, "num_module_steps_trained_lifetime_throughput": 713.2630348737147}, "differentiable_learners": {"intrinsic_attention_ppo_learner": {"__all_modules__": {"num_module_steps_trained_lifetime": 718200, "num_env_steps_trained_lifetime": 1980000, "num_module_steps_trained": 71820, "num_env_steps_trained": 198000, "num_env_steps_trained_lifetime_throughput": 47827.70633015364}, "default_policy": {"weights_seq_no": 60.0, "policy_loss": -0.00032790921977721155, "module_train_batch_size_mean": 997.5109713823833, "vf_loss": 0.35831689834594727, "mean_kl_loss": 1.4529817235597875e-05, "diff_num_grad_updates_vs_sampler_policy": 51.0, "vf_explained_var": 0.0027657151222229004, "use_intrinsic_rewards": 1.0, "entropy": 0.6838284730911255, "num_module_steps_trained": 35910, "vf_loss_unclipped": 43.79717254638672, "total_loss": 0.2777663469314575, "num_module_steps_trained_lifetime": 359100}, "intrinsic_reward_module": {"total_loss": 0.0, "num_module_steps_trained_lifetime": 359100, "module_train_batch_size_mean": 997.5109713823833, "weights_seq_no": 60.0, "num_module_steps_trained": 35910, "diff_num_grad_updates_vs_sampler_policy": 51.0}}}, "intrinsic_reward_module": {"diff_num_grad_updates_vs_sampler_policy": 1.0, "gradients_default_optimizer_global_norm": 0.0, "curr_entropy_coeff": 0.0015431216992, "weights_seq_no": 10.0, "default_optimizer_learning_rate": 0.0002715581955, "total_loss": 0.0, "num_module_steps_trained_lifetime": 59850, "module_train_batch_size_mean": 997.772440523815, "num_trainable_parameters": 8266, "num_module_steps_trained": 5985, "num_module_steps_trained_lifetime_throughput": 713.2717733358919}, "IntrinsicAttentionMask": [[[0.08826883137226105, 0.09139873087406158, 0.09132349491119385, 0.09012550115585327, 0.0911732167005539, 0.09194052964448929, 0.09186484664678574, 0.08982912451028824, 0.09171368181705475, 0.09163818508386612, 0.09072384983301163], [0.08598443120718002, 0.09182415157556534, 0.09168166667222977, 0.08942683786153793, 0.09139736741781235, 0.09285331517457962, 0.09270923584699631, 0.08887308090925217, 0.092421755194664, 0.09227833896875381, 0.09054974466562271], [0.08603785187005997, 0.09181419759988785, 0.09167330712080002, 0.08944340795278549, 0.09139218926429749, 0.09283176809549332, 0.09268932044506073, 0.08889567852020264, 0.09240508079528809, 0.09226328879594803, 0.09055397659540176], [0.08689805120229721, 0.09165381640195847, 0.09153847396373749, 0.08970861881971359, 0.09130823612213135, 0.0924859344959259, 0.09236954897642136, 0.08925790339708328, 0.09213721007108688, 0.09202126413583755, 0.0906209722161293], [0.08614473789930344, 0.09179425239562988, 0.09165655821561813, 0.08947651088237762, 0.09138178825378418, 0.09278863668441772, 0.09264945238828659, 0.08894084393978119, 0.09237170219421387, 0.09223313629627228, 0.09056240320205688], [0.08560195565223694, 0.09189554303884506, 0.09174159914255142, 0.08930792659521103, 0.09143448621034622, 0.09300806373357773, 0.09285225719213486, 0.08871099352836609, 0.09254142642021179, 0.0923864021897316, 0.09051929414272308], [0.08565516769886017, 0.09188561886548996, 0.09173326939344406, 0.08932451158761978, 0.09142933785915375, 0.09298651665449142, 0.09283234924077988, 0.08873358368873596, 0.09252477437257767, 0.09237135946750641, 0.09052356332540512], [0.08711375296115875, 0.09161363542079926, 0.09150465577840805, 0.08977468311786652, 0.09128708392381668, 0.09239964932203293, 0.09228973835706711, 0.08934827148914337, 0.09207029640674591, 0.09196077287197113, 0.09063746780157089], [0.0857616513967514, 0.09186573326587677, 0.09171658754348755, 0.0893576443195343, 0.09141901135444641, 0.09294339269399643, 0.09279249608516693, 0.08877874910831451, 0.09249142557382584, 0.09234125912189484, 0.09053206443786621], [0.0858149379491806, 0.09185577929019928, 0.0917082279920578, 0.08937421441078186, 0.09141383320093155, 0.09292183071374893, 0.09277256578207016, 0.0888013243675232, 0.09247475117444992, 0.09232620149850845, 0.09053630381822586], [0.08646608144044876, 0.09173431992530823, 0.09160619229078293, 0.08957578986883163, 0.09135046601295471, 0.09265924990177155, 0.09252982586622238, 0.08907637000083923, 0.09227152168750763, 0.09214264154434204, 0.0905875638127327]], [[0.09112676978111267, 0.09194111078977585, 0.09253613650798798, 0.09182462841272354, 0.09089602530002594, 0.09148428589105606, 0.09078086912631989, 0.09136838465929031, 0.08557604253292084, 0.09180069714784622, 0.0906650498509407], [0.0912008062005043, 0.09232880920171738, 0.09315545111894608, 0.09216722846031189, 0.09088186919689178, 0.09169555455446243, 0.09072282165288925, 0.09153508394956589, 0.08361545205116272, 0.0921340361237526, 0.09056293219327927], [0.09125141054391861, 0.09260779619216919, 0.09360391646623611, 0.09241329878568649, 0.0908685028553009, 0.09184591472148895, 0.0906776562333107, 0.0916530191898346, 0.08221916854381561, 0.09237334877252579, 0.09048587828874588], [0.09119054675102234, 0.0922737643122673, 0.09306725114583969, 0.09211862832307816, 0.09088417887687683, 0.09166571497917175, 0.09073138236999512, 0.09151160717010498, 0.083892323076725, 0.09208676218986511, 0.09057777374982834], [0.09110476821660995, 0.09182999283075333, 0.09235946089029312, 0.09172629565000534, 0.09089913219213486, 0.09142324328422546, 0.09079650044441223, 0.09132000803947449, 0.08614228665828705, 0.09170498698949814, 0.09069325029850006], [0.09115996211767197, 0.09211216121912003, 0.09280882775783539, 0.0919758751988411, 0.09089040756225586, 0.09157782793045044, 0.09075593203306198, 0.09144233167171478, 0.08470812439918518, 0.09194787591695786, 0.09062070399522781], [0.09109362214803696, 0.0917743369936943, 0.0922711044549942, 0.09167702496051788, 0.09090055525302887, 0.09139259159564972, 0.09080416709184647, 0.09129568934440613, 0.08642666786909103, 0.09165702760219574, 0.0907072201371193], [0.09114931523799896, 0.09205684810876846, 0.09272055327892303, 0.09192698448896408, 0.09089232236146927, 0.09154763072729111, 0.09076409786939621, 0.09141848236322403, 0.08498824387788773, 0.0919002965092659, 0.09063515812158585], [0.09045778214931488, 0.08910279721021652, 0.08813300728797913, 0.08929463475942612, 0.0908476933836937, 0.08985891193151474, 0.09104327112436295, 0.09005236625671387, 0.10063473135232925, 0.08933413028717041, 0.09124065190553665], [0.09118843823671341, 0.09226245433092117, 0.09304912388324738, 0.09210863709449768, 0.09088464826345444, 0.09165958315134048, 0.09073314070701599, 0.09150677919387817, 0.08394937962293625, 0.09207703918218613, 0.09058082103729248], [0.09108228236436844, 0.09171821177005768, 0.09218209981918335, 0.0916273221373558, 0.09090186655521393, 0.0913616269826889, 0.09081178903579712, 0.09127109497785568, 0.08671389520168304, 0.09160864353179932, 0.09072116762399673]], [[0.09140296280384064, 0.09130405634641647, 0.09120526164770126, 0.09110657125711441, 0.09100799262523651, 0.0920163169503212, 0.09043259173631668, 0.0892481580376625, 0.09171793609857559, 0.09013934433460236, 0.0904187262058258], [0.09139513224363327, 0.09129781275987625, 0.09120059758424759, 0.09110347181558609, 0.09100646525621414, 0.0919986367225647, 0.09044021368026733, 0.08927441388368607, 0.09170505404472351, 0.0901516005396843, 0.09042656421661377], [0.0913873016834259, 0.09129156172275543, 0.09119591861963272, 0.09110037982463837, 0.09100493788719177, 0.0919809564948082, 0.09044782817363739, 0.08930067718029022, 0.09169217199087143, 0.09016385674476624, 0.09043440222740173], [0.09137947112321854, 0.09128531068563461, 0.09119124710559845, 0.09109728783369064, 0.09100341796875, 0.0919632837176323, 0.09045545011758804, 0.08932695537805557, 0.09167929738759995, 0.09017612040042877, 0.0904422402381897], [0.09137162566184998, 0.0912790521979332, 0.09118656069040298, 0.09109417349100113, 0.09100187569856644, 0.0919455960392952, 0.0904630497097969, 0.08935321867465973, 0.09166640043258667, 0.09018836915493011, 0.09045006334781647], [0.09145135432481766, 0.09134267270565033, 0.09123411774635315, 0.09112569689750671, 0.09101739525794983, 0.09212561696767807, 0.0903855413198471, 0.0890861228108406, 0.09179755300283432, 0.0900636613368988, 0.090370312333107], [0.09132568538188934, 0.09124236553907394, 0.09115912765264511, 0.09107596427202225, 0.09099287539720535, 0.09184205532073975, 0.0905076339840889, 0.08950725197792053, 0.09159091860055923, 0.09026014804840088, 0.09049592912197113], [0.09123010188341141, 0.09116600453853607, 0.09110195934772491, 0.09103795140981674, 0.09097399562597275, 0.09162703901529312, 0.09060019999742508, 0.08982811868190765, 0.0914340540766716, 0.09040937572717667, 0.0905911847949028], [0.09142786264419556, 0.09132393449544907, 0.09122011810541153, 0.09111641347408295, 0.09101283550262451, 0.09207253158092499, 0.09040839225053787, 0.08916478604078293, 0.09175889194011688, 0.09010042250156403, 0.09039382636547089], [0.09130215644836426, 0.0912235751748085, 0.09114506840705872, 0.0910666212439537, 0.09098824858665466, 0.09178906679153442, 0.09053045511245728, 0.08958622068166733, 0.09155227988958359, 0.0902969166636467, 0.09051941335201263], [0.0913245752453804, 0.09124147891998291, 0.09115846455097198, 0.09107551723718643, 0.09099265187978745, 0.09183955192565918, 0.09050870686769485, 0.089510977268219, 0.09158910065889359, 0.09026188403367996, 0.09049703925848007]], [[0.0924263671040535, 0.09111219644546509, 0.09318698197603226, 0.09094960987567902, 0.09209679067134857, 0.0929376557469368, 0.09070627391338348, 0.09277181327342987, 0.08235282450914383, 0.090916208922863, 0.09054327756166458], [0.09196408092975616, 0.09105923026800156, 0.09248597174882889, 0.09094700217247009, 0.0917375311255455, 0.09231504797935486, 0.09077891707420349, 0.09220127016305923, 0.0849207416176796, 0.09092394262552261, 0.0906662568449974], [0.09268800914287567, 0.09113863110542297, 0.09358655661344528, 0.09094720333814621, 0.09229907393455505, 0.09329187870025635, 0.09066084027290344, 0.09309593588113785, 0.08091481029987335, 0.09090789407491684, 0.09046909213066101], [0.09190595895051956, 0.09105201065540314, 0.09239828586578369, 0.09094605594873428, 0.09169220179319382, 0.09223706275224686, 0.090787373483181, 0.09212973713874817, 0.0852460041642189, 0.09092428535223007, 0.09068098664283752], [0.09231166541576385, 0.0910997986793518, 0.09301245957612991, 0.09094977378845215, 0.09200786799192429, 0.09278279542922974, 0.09072520583868027, 0.09262999892234802, 0.0829867571592331, 0.09091895818710327, 0.09057474881410599], [0.09260272234678268, 0.09113030135631561, 0.09345607459545135, 0.09094830602407455, 0.09223322570323944, 0.09317626059055328, 0.09067600220441818, 0.09299018234014511, 0.0813823789358139, 0.09091092646121979, 0.09049364924430847], [0.09181859344244003, 0.09104091674089432, 0.09226664900779724, 0.09094438701868057, 0.09162398427724838, 0.09211994707584381, 0.09079978615045547, 0.09202226996421814, 0.0857359915971756, 0.09092455357313156, 0.0907028391957283], [0.09254571795463562, 0.09112457185983658, 0.0933690071105957, 0.09094886481761932, 0.09218917042016983, 0.09309908002614975, 0.09068593382835388, 0.09291956573724747, 0.08169542998075485, 0.09091277420520782, 0.09050984680652618], [0.08850941061973572, 0.09042385965585709, 0.08743204921483994, 0.09066551923751831, 0.08898313343524933, 0.08778277784585953, 0.09102921932935715, 0.08801737427711487, 0.10516713559627533, 0.09071529656648636, 0.0912742018699646], [0.0918940082192421, 0.09105051308870316, 0.09238025546073914, 0.09094585478305817, 0.09168287366628647, 0.09222102165222168, 0.09078909456729889, 0.09211502224206924, 0.08531303703784943, 0.09092435240745544, 0.09068401157855988], [0.0917598158121109, 0.09103330224752426, 0.09217821061611176, 0.0909430980682373, 0.09157805144786835, 0.09204123169183731, 0.0908079594373703, 0.09195002913475037, 0.0860663577914238, 0.09092455357313156, 0.09071733802556992]], [[0.08856743574142456, 0.09057944267988205, 0.0916324332356453, 0.09043038636445999, 0.09148164093494415, 0.09225155413150787, 0.09104138612747192, 0.09013300389051437, 0.09202393889427185, 0.09194818884134293, 0.0899106115102768], [0.08725208789110184, 0.09038618952035904, 0.09204241633415222, 0.09015262871980667, 0.09180457890033722, 0.09302131086587906, 0.0911114290356636, 0.08968731760978699, 0.09266099333763123, 0.09254118800163269, 0.08933990448713303], [0.08658141642808914, 0.09028535336256027, 0.09225248545408249, 0.09000848978757858, 0.09196958690881729, 0.09341825544834137, 0.09114590287208557, 0.08945729583501816, 0.09298887848854065, 0.09284618496894836, 0.08904612064361572], [0.08734799176454544, 0.09040047973394394, 0.0920124351978302, 0.09017310291528702, 0.09178099781274796, 0.09296479821205139, 0.09110642969608307, 0.08972005546092987, 0.09261427074670792, 0.09249772131443024, 0.08938176184892654], [0.08667673170566559, 0.09029978513717651, 0.09222258627414703, 0.09002908319234848, 0.09194612503051758, 0.09336166083812714, 0.09114105999469757, 0.08949010074138641, 0.09294215589761734, 0.0928027331829071, 0.08908799290657043], [0.08619259297847748, 0.0902261734008789, 0.09237459301948547, 0.08992413431406021, 0.09206536412239075, 0.09364979714155197, 0.09116550534963608, 0.08932308107614517, 0.09317994117736816, 0.09302384406328201, 0.0888749286532402], [0.08695639669895172, 0.09034192562103271, 0.09213494509458542, 0.09008929133415222, 0.0918772965669632, 0.09319593757390976, 0.09112672507762909, 0.08958613127470016, 0.09280528873205185, 0.09267543256282806, 0.0892106145620346], [0.08754004538059235, 0.09042900055646896, 0.09195242822170258, 0.09021399170160294, 0.09173379093408585, 0.09285180270671844, 0.09109635651111603, 0.08978549391031265, 0.09252084046602249, 0.09241078048944473, 0.08946546167135239], [0.08633507788181305, 0.09024792909622192, 0.09232982993125916, 0.08995512127876282, 0.09203026443719864, 0.09356483817100525, 0.09115836769342422, 0.08937235176563263, 0.0931098535656929, 0.09295868128538132, 0.08893774449825287], [0.08638261258602142, 0.09025516360998154, 0.09231489151716232, 0.08996543288230896, 0.09201855212450027, 0.09353651851415634, 0.09115596860647202, 0.08938875794410706, 0.09308648109436035, 0.09293694794178009, 0.08895868062973022], [0.08768431097269058, 0.09045034646987915, 0.09190739691257477, 0.09024461358785629, 0.09169835597276688, 0.09276708960533142, 0.09108875691890717, 0.0898345559835434, 0.09245077520608902, 0.09234557300806046, 0.08952823281288147]], [[0.08973393589258194, 0.09115739166736603, 0.09066213667392731, 0.08943258970975876, 0.08933235704898834, 0.09035766869783401, 0.09064773470163345, 0.0916881412267685, 0.10144120454788208, 0.08939135074615479, 0.0861554890871048], [0.08946429193019867, 0.09119261801242828, 0.09059062600135803, 0.08909915387630463, 0.08897776156663895, 0.09022089093923569, 0.09057313203811646, 0.09183855354785919, 0.1038481742143631, 0.08904920518398285, 0.08514564484357834], [0.08955828100442886, 0.0911811888217926, 0.0906161293387413, 0.08921516686677933, 0.08910108357667923, 0.09026896208524704, 0.09059970825910568, 0.09178722649812698, 0.10300948470830917, 0.08916822820901871, 0.08549455553293228], [0.08979082107543945, 0.0911489948630333, 0.09067656844854355, 0.08950316905975342, 0.08940748125314713, 0.09038607031106949, 0.09066282957792282, 0.09165515750646591, 0.10093306005001068, 0.08946380019187927, 0.08637205511331558], [0.08980973064899445, 0.09114613384008408, 0.09068132191896439, 0.08952664583921432, 0.0894324779510498, 0.0903954803943634, 0.09066779911518097, 0.09164410084486008, 0.10076417773962021, 0.08948790282011032, 0.08644431084394455], [0.08961596339941025, 0.09117371588945389, 0.09063147753477097, 0.08928648382425308, 0.08917692303657532, 0.09029825776815414, 0.09061571210622787, 0.09175513684749603, 0.10249453037977219, 0.0892414078116417, 0.08571033924818039], [0.08956100791692734, 0.09118083864450455, 0.0906168669462204, 0.08921853452920914, 0.08910467475652695, 0.09027035534381866, 0.09060046821832657, 0.0917857214808464, 0.10298512130975723, 0.08917169272899628, 0.08550474047660828], [0.08936335146427155, 0.09120391309261322, 0.09056256711483002, 0.08897479623556137, 0.08884565532207489, 0.0901687890291214, 0.09054393321275711, 0.09189236909151077, 0.10474842041730881, 0.08892165124416351, 0.08477454632520676], [0.08747667074203491, 0.0912470668554306, 0.0899239256978035, 0.08669121563434601, 0.08643097430467606, 0.08911650627851486, 0.0898856446146965, 0.09267851710319519, 0.12153135985136032, 0.08658408373594284, 0.07843407243490219], [0.08979859948158264, 0.09114781767129898, 0.09067851305007935, 0.08951281756162643, 0.08941776305437088, 0.09038993716239929, 0.09066487103700638, 0.09165060520172119, 0.10086356103420258, 0.08947370946407318, 0.08640176057815552], [0.09040455520153046, 0.09103574603796005, 0.09081676602363586, 0.09027021378278732, 0.09022548049688339, 0.09068181365728378, 0.0908103883266449, 0.09126969426870346, 0.09544084221124649, 0.09025181084871292, 0.08879267424345016]]]}, "num_training_step_calls_per_iteration": 1, "evaluation": {"env_runners": {"episode_len_max": 20, "rlmodule_inference_timer": 3.2447207204677186e-05, "num_module_steps_sampled": {"default_policy": 400}, "sample": 0.17043131546729526, "env_to_module_connector": {"timers": {"connectors": {"add_states_from_episodes_to_batch": 2.7984759571956416e-06, "add_time_dim_to_batch_and_zero_pad": 6.898933065242236e-06, "add_observations_from_episodes_to_batch": 2.8365061804459216e-06, "numpy_to_tensor": 1.219359780424116e-05, "batch_individual_items": 1.23917196943356e-05}}, "connector_pipeline_timer": 5.946511709418575e-05}, "module_episode_returns_mean": {"default_policy": -0.25}, "module_to_env_connector": {"timers": {"connectors": {"normalize_and_clip_actions": 7.889950775222123e-06, "remove_single_ts_time_rank_from_batch": 1.1895698561668757e-05, "tensor_to_numpy": 1.53419884378126e-05, "listify_data_for_vector_env": 1.04901759760233e-05, "un_batch_to_individual_items": 6.4858381890897806e-06, "get_actions": 3.8007063867732856e-05}}, "connector_pipeline_timer": 0.0001167866326641542}, "episode_duration_sec_mean": 0.005459766291314736, "weights_seq_no": 10.0, "env_to_module_sum_episodes_length_out": 10.368238394574323, "agent_episode_returns_mean": {"default_agent": -0.25}, "episode_return_mean": -0.25, "env_to_module_sum_episodes_length_in": 10.368238394574323, "num_episodes_lifetime": 200, "num_agent_steps_sampled_lifetime": {"default_agent": 4000}, "num_episodes": 20, "episode_len_mean": 20.0, "num_agent_steps_sampled": {"default_agent": 400}, "num_module_steps_sampled_lifetime": {"default_policy": 4000}, "env_reset_timer": 0.0022771500787079264, "episode_return_min": -16.5, "num_env_steps_sampled": 400, "episode_len_min": 20, "episode_return_max": 12.5, "env_step_timer": 1.4280153336272796e-05, "num_env_steps_sampled_lifetime": 50400, "time_between_sampling": 10.887605014579282}, "num_healthy_workers": 1, "actor_manager_num_outstanding_async_reqs": 0, "num_remote_worker_restarts": 0}, "num_env_steps_sampled_lifetime": -4930000.0, "fault_tolerance": {"num_healthy_workers": 0, "num_remote_worker_restarts": 0}, "env_runner_group": {"actor_manager_num_outstanding_async_reqs": 0}, "done": false, "training_iteration": 10, "trial_id": "b154b_00000", "date": "2025-08-11_18-13-06", "timestamp": 1754928786, "time_this_iter_s": 9.741291999816895, "time_total_s": 101.72833704948425, "pid": 10455, "hostname": "Mac", "node_ip": "127.0.0.1", "config": {"exploration_config": {}, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 2, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "env": "Umbrella", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": false, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 0, "create_local_env_runner": true, "num_envs_per_env_runner": 1, "gym_env_vectorize_mode": "SYNC", "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "episodes_to_numpy": true, "max_requests_in_flight_per_env_runner": 1, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "merge_env_runner_states": "training_only", "broadcast_env_runner_states": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "complete_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "sampler_perf_stats_ema_coef": null, "_is_online": true, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": "auto", "num_aggregator_actors_per_learner": 0, "max_requests_in_flight_per_aggregator_actor": 3, "local_gpu_idx": 0, "max_requests_in_flight_per_learner": 3, "gamma": 1, "lr": 0.0002715581955, "grad_clip": 0.5, "grad_clip_by": "global_norm", "_train_batch_size_per_learner": 5000, "train_batch_size": 4000, "num_epochs": 1, "minibatch_size": 1000, "shuffle_batch_per_epoch": true, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "log_std_clip_param": 20.0, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "_disable_preprocessor_api": false, "_disable_action_flattening": false}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {"intrinsic_reward_coeff": 0.2795015916508}, "optimizer": {}, "_learner_class": "<class 'source.intrinsic_attention_ppo.learners.IntrinsicAttentionMetaLearner.IntrinsicAttentionMetaLearner'>", "callbacks_on_algorithm_init": null, "callbacks_on_env_runners_recreated": null, "callbacks_on_offline_eval_runners_recreated": null, "callbacks_on_checkpoint_loaded": null, "callbacks_on_environment_created": null, "callbacks_on_episode_created": null, "callbacks_on_episode_start": null, "callbacks_on_episode_step": null, "callbacks_on_episode_end": null, "callbacks_on_evaluate_start": null, "callbacks_on_evaluate_end": null, "callbacks_on_evaluate_offline_start": null, "callbacks_on_evaluate_offline_end": null, "callbacks_on_sample_end": null, "callbacks_on_train_result": null, "explore": true, "enable_rl_module_and_learner": true, "enable_env_runner_and_connector_v2": true, "_prior_exploration_config": {"type": "StochasticSampling"}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x1514e58a0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "offline_data_class": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_read_batch_size": null, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "materialize_data": false, "materialize_mapped_data": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "ignore_final_observation": false, "prelearner_class": null, "prelearner_buffer_class": null, "prelearner_buffer_kwargs": {}, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_remaining_data": false, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": 1, "evaluation_duration": 20, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_auto_duration_min_env_steps_per_sample": 100, "evaluation_auto_duration_max_env_steps_per_sample": 2000, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 1, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "offline_evaluation_interval": null, "num_offline_eval_runners": 0, "offline_loss_for_module_fn": null, "offline_evaluation_duration": 1, "offline_evaluation_parallel_to_training": false, "offline_evaluation_timeout_s": 120.0, "num_cpus_per_offline_eval_runner": 1, "num_gpus_per_offline_eval_runner": 0, "custom_resources_per_offline_eval_runner": {}, "restart_failed_offline_eval_runners": true, "ignore_offline_eval_runner_failures": false, "max_num_offline_eval_runner_restarts": 1000, "offline_eval_runner_restore_timeout_s": 1800.0, "max_requests_in_flight_per_offline_eval_runner": 1, "validate_offline_eval_runners_after_construction": true, "offline_eval_runner_health_probe_timeout_s": 30.0, "offline_eval_rl_module_inference_only": false, "broadcast_offline_eval_runner_states": false, "offline_eval_batch_size_per_runner": 256, "dataset_num_iters_per_eval_runner": 1, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "log_gradients": false, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 4, "restart_failed_env_runners": true, "ignore_env_runner_failures": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30.0, "env_runner_restore_timeout_s": 1800.0, "_model_config": {}, "_rl_module_spec": "MultiRLModuleSpec(multi_rl_module_class=<class 'ray.rllib.core.rl_module.multi_rl_module.MultiRLModule'>, observation_space=None, action_space=None, inference_only=False, model_config=None, rl_module_specs={'default_policy': RLModuleSpec(module_class=<class 'source.intrinsic_attention_ppo.rl_modules.DifferentiablePPOModule.DifferentiablePPOModule'>, observation_space=None, action_space=None, inference_only=False, learner_only=False, model_config={'vf_share_layers': True, 'embedding_dim': 62, 'max_seq_len': 11, 'policy_head_hidden_sizes': [32], 'value_head_hidden_sizes': [101], 'embedding_hidden_sizes': [121]}, catalog_class=None, load_state_path=None, model_config_dict=None), 'intrinsic_reward_module': RLModuleSpec(module_class=<class 'source.intrinsic_attention_ppo.rl_modules.IntrinsicAttentionModule.IntrinsicAttentionModule'>, observation_space=None, action_space=None, inference_only=False, learner_only=True, model_config={'intrinsic_reward_network': {'encoder_hidden_sizes': [], 'encoding_dim': 1, 'num_heads': 1, 'head_hidden_sizes': None, 'layers': [{'type': 'attention'}]}, 'extrinsic_value_hidden_layers': [127, 60], 'vf_share_layers': True, 'max_seq_len': 11}, catalog_class=None, load_state_path=None, model_config_dict=None)}, load_state_path=None, modules_to_load=None, module_specs={'default_policy': RLModuleSpec(module_class=<class 'source.intrinsic_attention_ppo.rl_modules.DifferentiablePPOModule.DifferentiablePPOModule'>, observation_space=None, action_space=None, inference_only=False, learner_only=False, model_config={'vf_share_layers': True, 'embedding_dim': 62, 'max_seq_len': 11, 'policy_head_hidden_sizes': [32], 'value_head_hidden_sizes': [101], 'embedding_hidden_sizes': [121]}, catalog_class=None, load_state_path=None, model_config_dict=None), 'intrinsic_reward_module': RLModuleSpec(module_class=<class 'source.intrinsic_attention_ppo.rl_modules.IntrinsicAttentionModule.IntrinsicAttentionModule'>, observation_space=None, action_space=None, inference_only=False, learner_only=True, model_config={'intrinsic_reward_network': {'encoder_hidden_sizes': [], 'encoding_dim': 1, 'num_heads': 1, 'head_hidden_sizes': None, 'layers': [{'type': 'attention'}]}, 'extrinsic_value_hidden_layers': [127, 60], 'vf_share_layers': True, 'max_seq_len': 11}, catalog_class=None, load_state_path=None, model_config_dict=None)})", "algorithm_config_overrides_per_module": {"intrinsic_reward_module": {"lr": 0.0002715581955}}, "_per_module_overrides": {}, "_validate_config": true, "_use_msgpack_checkpoints": false, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "env_task_fn": -1, "enable_connectors": -1, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.161583927863, "kl_target": 0.0201019014258, "vf_loss_coeff": 0.7790510010087, "entropy_coeff": 0.0015431216992, "clip_param": 0.2459212356676, "vf_clip_param": 0.3769744131561, "entropy_coeff_schedule": null, "lr_schedule": null, "sgd_minibatch_size": -1, "vf_share_layers": -1, "differentiable_learner_configs": ["DifferentiableLearnerConfig(learner_class=<class 'source.intrinsic_attention_ppo.learners.IntrinsicAttentionPPOLearner.IntrinsicAttentionPPOLearner'>, learner_connector=None, add_default_connectors_to_learner_pipeline=True, is_multi_agent=False, policies_to_update=['default_policy'], lr=0.0060984166342, num_total_minibatches=0, num_epochs=1, minibatch_size=1000, shuffle_batch_per_epoch=True)"], "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9485408017724, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.callbacks.callbacks.RLlibCallback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 101.72833704948425, "iterations_since_restore": 10, "perf": {"cpu_util_percent": 40.50714285714286, "ram_util_percent": 80.48571428571428}}
{"timers": {"training_iteration": 10.16869715251431, "restore_env_runners": 1.068382313058405e-05, "training_step": 10.168497016075651, "env_runner_sampling_timer": 1.8174677664135832, "learner_update_timer": 8.170988392694579, "synch_weights": 0.0015077878916296534, "restore_eval_env_runners": 7.590546465093978e-05, "evaluation_iteration": 0.21078477325168327, "synch_eval_env_connectors": 0.00022465950097739874, "synch_env_connectors": 5.116353178860564e-06}, "env_runners": {"num_env_steps_sampled": 5000.0, "episode_return_max": 12.5, "env_to_module_connector": {"timers": {"connectors": {"add_time_dim_to_batch_and_zero_pad": 7.03128516275533e-06, "add_observations_from_episodes_to_batch": 2.834623590739863e-06, "batch_individual_items": 1.255903229086269e-05, "numpy_to_tensor": 1.2706969190621376e-05, "add_states_from_episodes_to_batch": 2.7438166608624195e-06}}, "connector_pipeline_timer": 6.033462135513724e-05}, "episode_len_min": 20, "module_to_env_connector": {"timers": {"connectors": {"un_batch_to_individual_items": 6.673324064131883e-06, "normalize_and_clip_actions": 8.17234103497625e-06, "remove_single_ts_time_rank_from_batch": 1.1994990790380047e-05, "get_actions": 4.010420061033835e-05, "tensor_to_numpy": 1.5235983093228423e-05, "listify_data_for_vector_env": 1.0870071613746328e-05}}, "connector_pipeline_timer": 0.00012004296565666042}, "env_step_timer": 1.4079757277553714e-05, "num_agent_steps_sampled_lifetime": {"default_agent": -5547500.0}, "num_episodes": 250.0, "episode_duration_sec_mean": 0.0053720703474245965, "episode_len_mean": 20.0, "module_episode_returns_mean": {"default_policy": 4.259999999999998}, "weights_seq_no": 10.0, "env_to_module_sum_episodes_length_out": 10.36823839457432, "num_env_steps_sampled_lifetime": -5547500.0, "episode_len_max": 20, "rlmodule_inference_timer": 3.257732892543895e-05, "num_agent_steps_sampled": {"default_agent": 5000.0}, "env_reset_timer": 4.2235222953450804e-05, "agent_episode_returns_mean": {"default_agent": 4.259999999999998}, "env_to_module_sum_episodes_length_in": 10.36823839457432, "episode_return_mean": 4.259999999999998, "time_between_sampling": 0.0331656469221391, "num_module_steps_sampled_lifetime": {"default_policy": -5547500.0}, "num_module_steps_sampled": {"default_policy": 5000.0}, "num_episodes_lifetime": -277375.0, "episode_return_min": -7.5, "sample": 0.005717801774046888, "num_env_steps_sampled_lifetime_throughput": 3207.172524915564}, "__all_modules__": {"learner_connector_sum_episodes_length_in": 5000.0, "learner_connector": {"connector_pipeline_timer": 0.1389510770558225, "timers": {"connectors": {"add_one_ts_to_episodes_and_truncate": 0.009515799862557243, "add_observations_from_episodes_to_batch": 0.0010327060102840635, "add_columns_from_episodes_to_train_batch": 0.043997207236918606, "add_time_dim_to_batch_and_zero_pad": 0.07619305102639277, "add_states_from_episodes_to_batch": 0.0035952923394494463, "batch_individual_items": 0.004355742206145284, "numpy_to_tensor": 7.310090987793674e-05}}}, "learner_connector_sum_episodes_length_out": 5250.0}, "learners": {"__all_modules__": {"num_module_steps_trained_lifetime": 131670, "num_env_steps_trained": 33000, "num_env_steps_trained_lifetime": 363000, "num_non_trainable_parameters": 0, "num_trainable_parameters": 24861, "num_module_steps_trained": 11970, "num_env_steps_trained_lifetime_throughput": 3933.019025700227, "num_module_steps_trained_throughput": 24526034.142295618, "num_module_steps_trained_lifetime_throughput": 12677243.173264537}, "default_policy": {"curr_entropy_coeff": 0.0015431216992, "weights_seq_no": 11.0, "curr_kl_coeff": 7.889840344432741e-05, "policy_loss": -0.0006929775699973106, "module_train_batch_size_mean": 997.7563503102639, "num_trainable_parameters": 16595, "vf_loss": 0.35830897092819214, "mean_kl_loss": 6.47556153126061e-05, "diff_num_grad_updates_vs_sampler_policy": 1.0, "vf_explained_var": -0.00026810169219970703, "use_intrinsic_rewards": 0.0, "entropy": 0.6819401979446411, "num_module_steps_trained": 5985, "vf_loss_unclipped": 44.46055221557617, "total_loss": 0.27739566564559937, "num_module_steps_trained_lifetime": 65835, "num_module_steps_trained_lifetime_throughput": 713.0767236643434}, "differentiable_learners": {"intrinsic_attention_ppo_learner": {"__all_modules__": {"num_module_steps_trained_lifetime": 790020, "num_env_steps_trained_lifetime": 2178000, "num_module_steps_trained": 71820, "num_env_steps_trained": 198000, "num_env_steps_trained_lifetime_throughput": 47130.13239218438}, "default_policy": {"weights_seq_no": 66.0, "policy_loss": -0.0006726810825057328, "module_train_batch_size_mean": 997.5068778348534, "vf_loss": 0.3583140969276428, "mean_kl_loss": 6.108514935476705e-05, "diff_num_grad_updates_vs_sampler_policy": 56.0, "vf_explained_var": 0.002901613712310791, "use_intrinsic_rewards": 1.0, "entropy": 0.6819890141487122, "num_module_steps_trained": 35910, "vf_loss_unclipped": 44.41423797607422, "total_loss": 0.2774296998977661, "num_module_steps_trained_lifetime": 395010}, "intrinsic_reward_module": {"total_loss": 0.0, "num_module_steps_trained_lifetime": 395010, "module_train_batch_size_mean": 997.5068778348534, "weights_seq_no": 66.0, "num_module_steps_trained": 35910, "diff_num_grad_updates_vs_sampler_policy": 56.0}}}, "intrinsic_reward_module": {"diff_num_grad_updates_vs_sampler_policy": 1.0, "gradients_default_optimizer_global_norm": 0.0, "curr_entropy_coeff": 0.0015431216992, "weights_seq_no": 11.0, "default_optimizer_learning_rate": 0.0002715581955, "total_loss": 0.0, "num_module_steps_trained_lifetime": 65835, "module_train_batch_size_mean": 997.7563503102639, "num_trainable_parameters": 8266, "num_module_steps_trained": 5985, "num_module_steps_trained_lifetime_throughput": 713.0849251094814}, "IntrinsicAttentionMask": [[[0.09153851121664047, 0.09143945574760437, 0.08986566215753555, 0.09124167263507843, 0.08967128396034241, 0.09066479653120041, 0.09205305576324463, 0.09084740281105042, 0.09037080407142639, 0.09175455570220947, 0.09055280685424805], [0.0915285050868988, 0.09143103659152985, 0.08988223224878311, 0.0912364199757576, 0.08969090133905411, 0.09066873788833618, 0.09203477948904037, 0.09084843099117279, 0.09037939459085464, 0.09174107760190964, 0.09055851399898529], [0.0913679376244545, 0.09129587560892105, 0.09014806896448135, 0.09115193039178848, 0.09000592678785324, 0.09073157608509064, 0.09174193441867828, 0.09086471050977707, 0.0905170664191246, 0.09152504056692123, 0.09064988791942596], [0.09150848537683487, 0.0914141908288002, 0.08991535753011703, 0.09122589975595474, 0.0897301584482193, 0.09067659080028534, 0.09199822694063187, 0.09085047990083694, 0.09039657562971115, 0.09171412885189056, 0.09056992828845978], [0.09134791046380997, 0.09127901494503021, 0.09018126130104065, 0.09114137291908264, 0.0900452733039856, 0.09073939919471741, 0.09170545637607574, 0.09086672216653824, 0.09053423255681992, 0.09149811416864395, 0.09066126495599747], [0.09144982695579529, 0.09136482328176498, 0.09001244604587555, 0.09119504690170288, 0.0898451879620552, 0.09069956839084625, 0.09189119935035706, 0.09085645526647568, 0.09044688194990158, 0.09163518995046616, 0.09060332924127579], [0.09159032255411148, 0.09148304909467697, 0.08977992087602615, 0.0912688821554184, 0.08956973254680634, 0.09064442664384842, 0.09214773029088974, 0.09084205329418182, 0.09032630920410156, 0.09182433784008026, 0.09052323549985886], [0.0914684385061264, 0.09138048440217972, 0.08998164534568787, 0.09120484441518784, 0.08980868756771088, 0.09069228917360306, 0.09192514419555664, 0.09085456281900406, 0.09043093025684357, 0.09166023135185242, 0.09059273451566696], [0.09141978621482849, 0.09133952856063843, 0.09006219357252121, 0.09117923676967621, 0.08990412950515747, 0.0907113254070282, 0.09183642268180847, 0.09085948765277863, 0.09047263860702515, 0.09159477800130844, 0.09062042087316513], [0.09156029671430588, 0.0914577916264534, 0.08982959389686584, 0.0912531241774559, 0.08962856233119965, 0.09065623581409454, 0.09209286421537399, 0.09084515273571014, 0.09035208821296692, 0.09178390353918076, 0.09054037183523178], [0.0914383977651596, 0.09135520458221436, 0.09003137797117233, 0.09118903428316116, 0.08986762166023254, 0.090704046189785, 0.09187035262584686, 0.0908576101064682, 0.09045668691396713, 0.0916198119521141, 0.0906098335981369]], [[0.09242760390043259, 0.09111342579126358, 0.09318823367357254, 0.09095083177089691, 0.09209802746772766, 0.09169930964708328, 0.09193368256092072, 0.09277305752038956, 0.08235393464565277, 0.0909174382686615, 0.09054449200630188], [0.09196466952562332, 0.09105981886386871, 0.09248656779527664, 0.09094758331775665, 0.09173812717199326, 0.09146370738744736, 0.09162505716085434, 0.09220186620950699, 0.08492129296064377, 0.09092452377080917, 0.09066683799028397], [0.09268974512815475, 0.09114032983779907, 0.09358830749988556, 0.0909489169716835, 0.09230080246925354, 0.09183060377836227, 0.09210695326328278, 0.09309767931699753, 0.08091633021831512, 0.09090960025787354, 0.09047078341245651], [0.09190649539232254, 0.09105253964662552, 0.09239882230758667, 0.09094658493995667, 0.0916927382349968, 0.09143377095460892, 0.09158603847026825, 0.09213027358055115, 0.0852465033531189, 0.09092481434345245, 0.0906815156340599], [0.09231271594762802, 0.09110083431005478, 0.09301351755857468, 0.09095081686973572, 0.09200891852378845, 0.09164127707481384, 0.09185739606618881, 0.09263104945421219, 0.0829877033829689, 0.09091998636722565, 0.09057578444480896], [0.09217264503240585, 0.09108485281467438, 0.092801034450531, 0.09095007926225662, 0.09190009534358978, 0.09157013893127441, 0.09176411479711533, 0.09245815128087997, 0.08376338332891464, 0.09092239290475845, 0.09061309695243835], [0.0922551229596138, 0.09109435230493546, 0.09292608499526978, 0.090950608253479, 0.09196420013904572, 0.0916120782494545, 0.09181908518075943, 0.09255992621183395, 0.08330623805522919, 0.0909210741519928, 0.09059123694896698], [0.09254717826843262, 0.09112600237131119, 0.0933704748749733, 0.09095029532909393, 0.09219061583280563, 0.09175939112901688, 0.09201285243034363, 0.09292102605104446, 0.08169671893119812, 0.09091420471668243, 0.0905112698674202], [0.08851199597120285, 0.0904264971613884, 0.08743459731340408, 0.09066816419363022, 0.08898572623729706, 0.08956452459096909, 0.08922354131937027, 0.0880199447274208, 0.10517019033432007, 0.09071794152259827, 0.0912768617272377], [0.09189450740814209, 0.09105101227760315, 0.09238076210021973, 0.09094636142253876, 0.09168338030576706, 0.09142758697271347, 0.09157799184322357, 0.09211552888154984, 0.08531350642442703, 0.09092485159635544, 0.09068450331687927], [0.09176020324230194, 0.0910336822271347, 0.0921785980463028, 0.09094347804784775, 0.09157843887805939, 0.09135815501213074, 0.09148769080638885, 0.0919504165649414, 0.08606672286987305, 0.0909249410033226, 0.09071771800518036]], [[0.09140355885028839, 0.09130465239286423, 0.09120585769414902, 0.09110715985298157, 0.09100858122110367, 0.09053114056587219, 0.09043318033218384, 0.08924873173236847, 0.09171853214502335, 0.09161929041147232, 0.09041930735111237], [0.09139570593833923, 0.09129838645458221, 0.09120116382837296, 0.09110404551029205, 0.09100703150033951, 0.0905371829867363, 0.0904407799243927, 0.08927497267723083, 0.09170562773942947, 0.0916079729795456, 0.09042713046073914], [0.09138784557580948, 0.09129210561513901, 0.0911964699625969, 0.09110093116760254, 0.09100548923015594, 0.0905432254076004, 0.09044837206602097, 0.0893012136220932, 0.0916927233338356, 0.09159666299819946, 0.09043493866920471], [0.09138000011444092, 0.091285839676857, 0.09119177609682083, 0.09109781682491302, 0.09100394695997238, 0.0905492752790451, 0.09045597165822983, 0.08932746946811676, 0.09167982637882233, 0.09158536046743393, 0.09044276177883148], [0.09137213230133057, 0.09127955138683319, 0.09118707478046417, 0.09109468013048172, 0.09100238978862762, 0.09055531024932861, 0.0904635563492775, 0.08935371786355972, 0.09166691452264786, 0.0915740355849266, 0.09045056998729706], [0.09133396297693253, 0.09124906361103058, 0.0911642462015152, 0.09107951074838638, 0.09099484235048294, 0.0905846580862999, 0.09050045162439346, 0.08948136866092682, 0.09160424023866653, 0.09151908755302429, 0.09048853814601898], [0.09132610261440277, 0.09124279022216797, 0.09115954488515854, 0.09107638150453568, 0.09099329262971878, 0.090590700507164, 0.09050805121660233, 0.08950766921043396, 0.09159134328365326, 0.09150778502225876, 0.09049635380506516], [0.0912303477525711, 0.09116625040769577, 0.09110219776630402, 0.09103819727897644, 0.09097424149513245, 0.09066414088010788, 0.09060043841600418, 0.08982835710048676, 0.0914342999458313, 0.09137006103992462, 0.0905914232134819], [0.09142850339412689, 0.0913245677947998, 0.09122075140476227, 0.09111705422401428, 0.09101347625255585, 0.09051191806793213, 0.09040902554988861, 0.08916541188955307, 0.09175953269004822, 0.09165522456169128, 0.09039445966482162], [0.09142066538333893, 0.09131830930709839, 0.0912160724401474, 0.09111395478248596, 0.09101194143295288, 0.09051797538995743, 0.09041663259267807, 0.08919163793325424, 0.09174663573503494, 0.09164392203092575, 0.09040229022502899], [0.09132499247789383, 0.09124190360307693, 0.09115888178348541, 0.09107594192028046, 0.09099307656288147, 0.09059154987335205, 0.09050913155078888, 0.08951138705015182, 0.09158951789140701, 0.09150618314743042, 0.0904974564909935]], [[0.09061183035373688, 0.08862796425819397, 0.09176713228225708, 0.0902373343706131, 0.0882616639137268, 0.09138786047697067, 0.08986438810825348, 0.0892636850476265, 0.10537867993116379, 0.09018611907958984, 0.08441338688135147], [0.0906919315457344, 0.08910038322210312, 0.09161555022001266, 0.09039203822612762, 0.08880575001239777, 0.09131259471178055, 0.09009312838315964, 0.08961116522550583, 0.10233108699321747, 0.09035100042819977, 0.0856952965259552], [0.09056118875741959, 0.08835399895906448, 0.09184910356998444, 0.09014411270618439, 0.08794709295034409, 0.09142609685659409, 0.0897289514541626, 0.08906068652868271, 0.10715779662132263, 0.09008708596229553, 0.08368391543626785], [0.09062761813402176, 0.08871693909168243, 0.09173957258462906, 0.09026706218719482, 0.08836398273706436, 0.09137459099292755, 0.0899079367518425, 0.08932939171791077, 0.10480263829231262, 0.09021773934364319, 0.08465249091386795], [0.0907057523727417, 0.08918789774179459, 0.09158603101968765, 0.09041983634233475, 0.08890676498413086, 0.09129734337329865, 0.09013482183218002, 0.0896751657128334, 0.10176948457956314, 0.0903807133436203, 0.08593615889549255], [0.09057813137769699, 0.08844384551048279, 0.09182269871234894, 0.09017496556043625, 0.08805017918348312, 0.09141398966312408, 0.08977359533309937, 0.08912737667560577, 0.10657340288162231, 0.09011983871459961, 0.08392203599214554], [0.0906430333852768, 0.08880564570426941, 0.09171164035797119, 0.0902964249253273, 0.08846606314182281, 0.09136094897985458, 0.08995114266872406, 0.08939477056264877, 0.10422932356595993, 0.09024900943040848, 0.08489193022251129], [0.0906672403216362, 0.08894873410463333, 0.09166564792394638, 0.09034322947263718, 0.08863086998462677, 0.09133807569742203, 0.09002038091421127, 0.08949998766183853, 0.10330662876367569, 0.09029889851808548, 0.0852803960442543], [0.08977179229259491, 0.08519160747528076, 0.09250302612781525, 0.08889658004045486, 0.08436104655265808, 0.09160119295120239, 0.0880299061536789, 0.0866442620754242, 0.12830574810504913, 0.08877725899219513, 0.07591757923364639], [0.09062975645065308, 0.0887291207909584, 0.09173577278852463, 0.09027111530303955, 0.08837799727916718, 0.09137274324893951, 0.08991388976573944, 0.08933837711811066, 0.10472388565540314, 0.09022205322980881, 0.0846853032708168], [0.09083157032728195, 0.09011240303516388, 0.09124573320150375, 0.09069658815860748, 0.08997849375009537, 0.09111013263463974, 0.09056180715560913, 0.09034396708011627, 0.09589163959026337, 0.09067809581756592, 0.08854962140321732]], [[0.09153897315263748, 0.09143992513418198, 0.09134098142385483, 0.09124214202165604, 0.0911434143781662, 0.09066526591777802, 0.09056715667247772, 0.08938095718622208, 0.09185441583395004, 0.09027347713708878, 0.09055326879024506], [0.09152895212173462, 0.09143149107694626, 0.09133412688970566, 0.09123687446117401, 0.09113971889019012, 0.0906691774725914, 0.09057263284921646, 0.0894051268696785, 0.09183932840824127, 0.0902835950255394, 0.0905589610338211], [0.09151893109083176, 0.09142305701971054, 0.09132727235555649, 0.09123159945011139, 0.09113601595163345, 0.09067309647798538, 0.0905781015753746, 0.08942929655313492, 0.0918242409825325, 0.09029372036457062, 0.09056465327739716], [0.09150891751050949, 0.09141461551189423, 0.09132042527198792, 0.09122632443904877, 0.09113232791423798, 0.09067701548337936, 0.09058357775211334, 0.08945348858833313, 0.09180916100740433, 0.09030385315418243, 0.0905703529715538], [0.09149888902902603, 0.09140618145465851, 0.09131357073783875, 0.09122104942798615, 0.0911286249756813, 0.09068092703819275, 0.09058904647827148, 0.08947766572237015, 0.09179407358169556, 0.09031397104263306, 0.09057603776454926], [0.09145017713308334, 0.09136516600847244, 0.0912802442908287, 0.09119539707899094, 0.09111062437295914, 0.09069991111755371, 0.09061560779809952, 0.08959522098302841, 0.09172079712152481, 0.09036315232515335, 0.09060367196798325], [0.09144014865159988, 0.09135673195123672, 0.09127338230609894, 0.09119011461734772, 0.09110692143440247, 0.0907038226723671, 0.09062106907367706, 0.08961943536996841, 0.09170571714639664, 0.09037327766418457, 0.0906093567609787], [0.09131806343793869, 0.09125390648841858, 0.09118979424238205, 0.0911257266998291, 0.09106170386075974, 0.09075131267309189, 0.09068755060434341, 0.0899147242307663, 0.0915222093462944, 0.09049654006958008, 0.09067852050065994], [0.09157083183526993, 0.09146673232316971, 0.09136275202035904, 0.09125889837741852, 0.09115514904260635, 0.09065281599760056, 0.0905497595667839, 0.08930420875549316, 0.09190236777067184, 0.09024130553007126, 0.09053517132997513], [0.0914100632071495, 0.09133139997720718, 0.09125279635190964, 0.09117425978183746, 0.09109579026699066, 0.09071552753448486, 0.0906374529004097, 0.08969210088253021, 0.09166048467159271, 0.09040363878011703, 0.09062640368938446], [0.09143873304128647, 0.09135553240776062, 0.09127241373062134, 0.09118936955928802, 0.09110639989376068, 0.09070437401533127, 0.09062185138463974, 0.0896228700876236, 0.09170358628034592, 0.09037471562623978, 0.09061016142368317]], [[0.09112706780433655, 0.09194140881299973, 0.09165870398283005, 0.09095394611358643, 0.09089631587266922, 0.09236063808202744, 0.09165048599243164, 0.0913686752319336, 0.08557632565498352, 0.0918009877204895, 0.09066534042358398], [0.09120137989521027, 0.09232939779758453, 0.09193737059831619, 0.09096207469701767, 0.09088244289159775, 0.09291160106658936, 0.0919259637594223, 0.09153565764427185, 0.0836159884929657, 0.09213461726903915, 0.09056350588798523], [0.09117621183395386, 0.09219547361135483, 0.09184137731790543, 0.0909598171710968, 0.09088779985904694, 0.09272108972072601, 0.09183108061552048, 0.0914783850312233, 0.08428992331027985, 0.09201956540346146, 0.09059929847717285], [0.09111056476831436, 0.09185805916786194, 0.09159862995147705, 0.0909515842795372, 0.09089865535497665, 0.09224266558885574, 0.09159107506275177, 0.09133239835500717, 0.08600065857172012, 0.09172920137643814, 0.09068650007247925], [0.09110501408576965, 0.09183023124933243, 0.09157855063676834, 0.09095074236392975, 0.09089938551187515, 0.09220331907272339, 0.09157122671604156, 0.09132025390863419, 0.08614251762628555, 0.09170523285865784, 0.09069350361824036], [0.09123751521110535, 0.09252651780843735, 0.092078298330307, 0.09096434712409973, 0.09087347239255905, 0.0931926891207695, 0.09206525981426239, 0.09161926805973053, 0.0826292484998703, 0.09230378270149231, 0.09050960838794708], [0.09117546677589417, 0.09219156950712204, 0.09183857589960098, 0.09095974266529083, 0.09088794887065887, 0.09271553158760071, 0.09182830154895782, 0.09147670865058899, 0.0843096449971199, 0.09201620519161224, 0.09060033410787582], [0.0911496952176094, 0.0920572355389595, 0.09174207597970963, 0.09095688164234161, 0.09089270234107971, 0.09252480417490005, 0.09173290431499481, 0.09141886979341507, 0.08498860150575638, 0.09190068393945694, 0.09063553810119629], [0.09045863151550293, 0.08910363912582397, 0.08957035094499588, 0.09075091034173965, 0.09084854274988174, 0.08841861039400101, 0.08958399295806885, 0.09005321562290192, 0.10063565522432327, 0.08933497220277786, 0.0912415161728859], [0.0911889597773552, 0.09226298332214355, 0.09188979864120483, 0.0909610316157341, 0.09088517725467682, 0.09281707555055618, 0.09187893569469452, 0.09150730073451996, 0.08394987136125565, 0.0920775756239891, 0.09058134257793427], [0.09108246862888336, 0.0917183980345726, 0.09149777144193649, 0.09094712138175964, 0.09090204536914825, 0.09204529970884323, 0.09149134904146194, 0.09127127379179001, 0.08671407401561737, 0.09160882979631424, 0.09072134643793106]]]}, "num_training_step_calls_per_iteration": 1, "evaluation": {"env_runners": {"episode_len_max": 20, "rlmodule_inference_timer": 3.2376936825625616e-05, "num_module_steps_sampled": {"default_policy": 400}, "sample": 0.16992545565237038, "env_to_module_connector": {"timers": {"connectors": {"add_states_from_episodes_to_batch": 2.8536609408222823e-06, "add_time_dim_to_batch_and_zero_pad": 6.810782912478594e-06, "add_observations_from_episodes_to_batch": 2.8100106161136106e-06, "numpy_to_tensor": 1.23421862707273e-05, "batch_individual_items": 1.2493438679383865e-05}}, "connector_pipeline_timer": 5.9678471531298016e-05}, "module_episode_returns_mean": {"default_policy": -0.45}, "module_to_env_connector": {"timers": {"connectors": {"normalize_and_clip_actions": 7.940592615696533e-06, "remove_single_ts_time_rank_from_batch": 1.1928068674890585e-05, "tensor_to_numpy": 1.5222759969489118e-05, "listify_data_for_vector_env": 1.0302072734382533e-05, "un_batch_to_individual_items": 6.606429139644465e-06, "get_actions": 3.818260638828981e-05}}, "connector_pipeline_timer": 0.00011703627431477582}, "episode_duration_sec_mean": 0.005418143782299012, "weights_seq_no": 11.0, "env_to_module_sum_episodes_length_out": 10.368238394574323, "agent_episode_returns_mean": {"default_agent": -0.45}, "episode_return_mean": -0.45, "env_to_module_sum_episodes_length_in": 10.368238394574323, "num_episodes_lifetime": 220, "num_agent_steps_sampled_lifetime": {"default_agent": 4400}, "num_episodes": 20, "episode_len_mean": 20.0, "num_agent_steps_sampled": {"default_agent": 400}, "num_module_steps_sampled_lifetime": {"default_policy": 4400}, "env_reset_timer": 0.0022557139978681287, "episode_return_min": -16.5, "num_env_steps_sampled": 400, "episode_len_min": 20, "episode_return_max": 12.5, "env_step_timer": 1.4135459159223885e-05, "num_env_steps_sampled_lifetime": 55400, "time_between_sampling": 10.872475807343093}, "num_healthy_workers": 1, "actor_manager_num_outstanding_async_reqs": 0, "num_remote_worker_restarts": 0}, "num_env_steps_sampled_lifetime": -5547500.0, "fault_tolerance": {"num_healthy_workers": 0, "num_remote_worker_restarts": 0}, "env_runner_group": {"actor_manager_num_outstanding_async_reqs": 0}, "done": false, "training_iteration": 11, "trial_id": "b154b_00000", "date": "2025-08-11_18-13-16", "timestamp": 1754928796, "time_this_iter_s": 9.475759983062744, "time_total_s": 111.204097032547, "pid": 10455, "hostname": "Mac", "node_ip": "127.0.0.1", "config": {"exploration_config": {}, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 2, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "env": "Umbrella", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": false, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 0, "create_local_env_runner": true, "num_envs_per_env_runner": 1, "gym_env_vectorize_mode": "SYNC", "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "episodes_to_numpy": true, "max_requests_in_flight_per_env_runner": 1, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "merge_env_runner_states": "training_only", "broadcast_env_runner_states": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "complete_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "sampler_perf_stats_ema_coef": null, "_is_online": true, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": "auto", "num_aggregator_actors_per_learner": 0, "max_requests_in_flight_per_aggregator_actor": 3, "local_gpu_idx": 0, "max_requests_in_flight_per_learner": 3, "gamma": 1, "lr": 0.0002715581955, "grad_clip": 0.5, "grad_clip_by": "global_norm", "_train_batch_size_per_learner": 5000, "train_batch_size": 4000, "num_epochs": 1, "minibatch_size": 1000, "shuffle_batch_per_epoch": true, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "log_std_clip_param": 20.0, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "_disable_preprocessor_api": false, "_disable_action_flattening": false}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {"intrinsic_reward_coeff": 0.2795015916508}, "optimizer": {}, "_learner_class": "<class 'source.intrinsic_attention_ppo.learners.IntrinsicAttentionMetaLearner.IntrinsicAttentionMetaLearner'>", "callbacks_on_algorithm_init": null, "callbacks_on_env_runners_recreated": null, "callbacks_on_offline_eval_runners_recreated": null, "callbacks_on_checkpoint_loaded": null, "callbacks_on_environment_created": null, "callbacks_on_episode_created": null, "callbacks_on_episode_start": null, "callbacks_on_episode_step": null, "callbacks_on_episode_end": null, "callbacks_on_evaluate_start": null, "callbacks_on_evaluate_end": null, "callbacks_on_evaluate_offline_start": null, "callbacks_on_evaluate_offline_end": null, "callbacks_on_sample_end": null, "callbacks_on_train_result": null, "explore": true, "enable_rl_module_and_learner": true, "enable_env_runner_and_connector_v2": true, "_prior_exploration_config": {"type": "StochasticSampling"}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x1514e58a0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "offline_data_class": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_read_batch_size": null, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "materialize_data": false, "materialize_mapped_data": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "ignore_final_observation": false, "prelearner_class": null, "prelearner_buffer_class": null, "prelearner_buffer_kwargs": {}, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_remaining_data": false, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": 1, "evaluation_duration": 20, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_auto_duration_min_env_steps_per_sample": 100, "evaluation_auto_duration_max_env_steps_per_sample": 2000, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 1, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "offline_evaluation_interval": null, "num_offline_eval_runners": 0, "offline_loss_for_module_fn": null, "offline_evaluation_duration": 1, "offline_evaluation_parallel_to_training": false, "offline_evaluation_timeout_s": 120.0, "num_cpus_per_offline_eval_runner": 1, "num_gpus_per_offline_eval_runner": 0, "custom_resources_per_offline_eval_runner": {}, "restart_failed_offline_eval_runners": true, "ignore_offline_eval_runner_failures": false, "max_num_offline_eval_runner_restarts": 1000, "offline_eval_runner_restore_timeout_s": 1800.0, "max_requests_in_flight_per_offline_eval_runner": 1, "validate_offline_eval_runners_after_construction": true, "offline_eval_runner_health_probe_timeout_s": 30.0, "offline_eval_rl_module_inference_only": false, "broadcast_offline_eval_runner_states": false, "offline_eval_batch_size_per_runner": 256, "dataset_num_iters_per_eval_runner": 1, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "log_gradients": false, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 4, "restart_failed_env_runners": true, "ignore_env_runner_failures": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30.0, "env_runner_restore_timeout_s": 1800.0, "_model_config": {}, "_rl_module_spec": "MultiRLModuleSpec(multi_rl_module_class=<class 'ray.rllib.core.rl_module.multi_rl_module.MultiRLModule'>, observation_space=None, action_space=None, inference_only=False, model_config=None, rl_module_specs={'default_policy': RLModuleSpec(module_class=<class 'source.intrinsic_attention_ppo.rl_modules.DifferentiablePPOModule.DifferentiablePPOModule'>, observation_space=None, action_space=None, inference_only=False, learner_only=False, model_config={'vf_share_layers': True, 'embedding_dim': 62, 'max_seq_len': 11, 'policy_head_hidden_sizes': [32], 'value_head_hidden_sizes': [101], 'embedding_hidden_sizes': [121]}, catalog_class=None, load_state_path=None, model_config_dict=None), 'intrinsic_reward_module': RLModuleSpec(module_class=<class 'source.intrinsic_attention_ppo.rl_modules.IntrinsicAttentionModule.IntrinsicAttentionModule'>, observation_space=None, action_space=None, inference_only=False, learner_only=True, model_config={'intrinsic_reward_network': {'encoder_hidden_sizes': [], 'encoding_dim': 1, 'num_heads': 1, 'head_hidden_sizes': None, 'layers': [{'type': 'attention'}]}, 'extrinsic_value_hidden_layers': [127, 60], 'vf_share_layers': True, 'max_seq_len': 11}, catalog_class=None, load_state_path=None, model_config_dict=None)}, load_state_path=None, modules_to_load=None, module_specs={'default_policy': RLModuleSpec(module_class=<class 'source.intrinsic_attention_ppo.rl_modules.DifferentiablePPOModule.DifferentiablePPOModule'>, observation_space=None, action_space=None, inference_only=False, learner_only=False, model_config={'vf_share_layers': True, 'embedding_dim': 62, 'max_seq_len': 11, 'policy_head_hidden_sizes': [32], 'value_head_hidden_sizes': [101], 'embedding_hidden_sizes': [121]}, catalog_class=None, load_state_path=None, model_config_dict=None), 'intrinsic_reward_module': RLModuleSpec(module_class=<class 'source.intrinsic_attention_ppo.rl_modules.IntrinsicAttentionModule.IntrinsicAttentionModule'>, observation_space=None, action_space=None, inference_only=False, learner_only=True, model_config={'intrinsic_reward_network': {'encoder_hidden_sizes': [], 'encoding_dim': 1, 'num_heads': 1, 'head_hidden_sizes': None, 'layers': [{'type': 'attention'}]}, 'extrinsic_value_hidden_layers': [127, 60], 'vf_share_layers': True, 'max_seq_len': 11}, catalog_class=None, load_state_path=None, model_config_dict=None)})", "algorithm_config_overrides_per_module": {"intrinsic_reward_module": {"lr": 0.0002715581955}}, "_per_module_overrides": {}, "_validate_config": true, "_use_msgpack_checkpoints": false, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "env_task_fn": -1, "enable_connectors": -1, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.161583927863, "kl_target": 0.0201019014258, "vf_loss_coeff": 0.7790510010087, "entropy_coeff": 0.0015431216992, "clip_param": 0.2459212356676, "vf_clip_param": 0.3769744131561, "entropy_coeff_schedule": null, "lr_schedule": null, "sgd_minibatch_size": -1, "vf_share_layers": -1, "differentiable_learner_configs": ["DifferentiableLearnerConfig(learner_class=<class 'source.intrinsic_attention_ppo.learners.IntrinsicAttentionPPOLearner.IntrinsicAttentionPPOLearner'>, learner_connector=None, add_default_connectors_to_learner_pipeline=True, is_multi_agent=False, policies_to_update=['default_policy'], lr=0.0060984166342, num_total_minibatches=0, num_epochs=1, minibatch_size=1000, shuffle_batch_per_epoch=True)"], "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9485408017724, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.callbacks.callbacks.RLlibCallback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 111.204097032547, "iterations_since_restore": 11, "perf": {"cpu_util_percent": 33.02142857142857, "ram_util_percent": 80.8142857142857}}
{"timers": {"training_iteration": 10.165286417239697, "restore_env_runners": 1.0642395176153108e-05, "training_step": 10.165085606744588, "env_runner_sampling_timer": 1.8158879508293937, "learner_update_timer": 8.168932293767023, "synch_weights": 0.0015085912628601333, "restore_eval_env_runners": 7.55014103792691e-05, "evaluation_iteration": 0.20994135551844903, "synch_eval_env_connectors": 0.00022405082530790743, "synch_env_connectors": 5.113939727240206e-06}, "env_runners": {"num_env_steps_sampled": 5000.0, "episode_return_max": 12.5, "env_to_module_connector": {"timers": {"connectors": {"add_time_dim_to_batch_and_zero_pad": 6.933584405212315e-06, "add_observations_from_episodes_to_batch": 2.8253369954843893e-06, "batch_individual_items": 1.238886503715176e-05, "numpy_to_tensor": 1.2506158885219877e-05, "add_states_from_episodes_to_batch": 2.711901675083928e-06}}, "connector_pipeline_timer": 5.974709182892199e-05}, "episode_len_min": 20, "module_to_env_connector": {"timers": {"connectors": {"un_batch_to_individual_items": 6.6519246121037545e-06, "normalize_and_clip_actions": 8.029775515439305e-06, "remove_single_ts_time_rank_from_batch": 1.2001428528347528e-05, "get_actions": 3.9270785783171e-05, "tensor_to_numpy": 1.5109077238567859e-05, "listify_data_for_vector_env": 1.0821908870553474e-05}}, "connector_pipeline_timer": 0.00011865932310199681}, "env_step_timer": 1.3918433217616953e-05, "num_agent_steps_sampled_lifetime": {"default_agent": -6165000.0}, "num_episodes": 250.0, "episode_duration_sec_mean": 0.005756125011015681, "episode_len_mean": 20.0, "module_episode_returns_mean": {"default_policy": 3.8600000000000008}, "weights_seq_no": 11.0, "env_to_module_sum_episodes_length_out": 10.36823839457432, "num_env_steps_sampled_lifetime": -6165000.0, "episode_len_max": 20, "rlmodule_inference_timer": 5.7393535846567466e-05, "num_agent_steps_sampled": {"default_agent": 5000.0}, "env_reset_timer": 4.319867098826639e-05, "agent_episode_returns_mean": {"default_agent": 3.8600000000000008}, "env_to_module_sum_episodes_length_in": 10.36823839457432, "episode_return_mean": 3.8600000000000008, "time_between_sampling": 0.03230146115165081, "num_module_steps_sampled_lifetime": {"default_policy": -6165000.0}, "num_module_steps_sampled": {"default_policy": 5000.0}, "num_episodes_lifetime": -308250.0, "episode_return_min": -7.5, "sample": 0.006133867548436051, "num_env_steps_sampled_lifetime_throughput": 3201.1890086736075}, "__all_modules__": {"learner_connector_sum_episodes_length_in": 5000.0, "learner_connector": {"connector_pipeline_timer": 0.1390854958658447, "timers": {"connectors": {"add_one_ts_to_episodes_and_truncate": 0.009512786444489612, "add_observations_from_episodes_to_batch": 0.0010321226995780983, "add_columns_from_episodes_to_train_batch": 0.04397137016545072, "add_time_dim_to_batch_and_zero_pad": 0.07633602426559852, "add_states_from_episodes_to_batch": 0.0036093377560190284, "batch_individual_items": 0.004362395623919758, "numpy_to_tensor": 7.312740130844662e-05}}}, "learner_connector_sum_episodes_length_out": 5250.0}, "learners": {"__all_modules__": {"num_module_steps_trained_lifetime": 143640, "num_env_steps_trained": 33000, "num_env_steps_trained_lifetime": 396000, "num_non_trainable_parameters": 0, "num_trainable_parameters": 24861, "num_module_steps_trained": 11970, "num_env_steps_trained_lifetime_throughput": 3933.100361791349, "num_module_steps_trained_throughput": 23881011.702396795, "num_module_steps_trained_lifetime_throughput": 12640601.235586716}, "default_policy": {"curr_entropy_coeff": 0.0015431216992, "weights_seq_no": 12.0, "curr_kl_coeff": 3.944920172216371e-05, "policy_loss": -0.00011846564302686602, "module_train_batch_size_mean": 997.7412016936058, "num_trainable_parameters": 16595, "vf_loss": 0.3583071231842041, "mean_kl_loss": 6.6212060119141825e-06, "diff_num_grad_updates_vs_sampler_policy": 1.0, "vf_explained_var": 0.00043582916259765625, "use_intrinsic_rewards": 0.0, "entropy": 0.6816680431365967, "num_module_steps_trained": 5985, "vf_loss_unclipped": 43.77027893066406, "total_loss": 0.2779691517353058, "num_module_steps_trained_lifetime": 71820, "num_module_steps_trained_lifetime_throughput": 713.1005049530452}, "differentiable_learners": {"intrinsic_attention_ppo_learner": {"__all_modules__": {"num_module_steps_trained_lifetime": 861840, "num_env_steps_trained_lifetime": 2376000, "num_module_steps_trained": 71820, "num_env_steps_trained": 198000, "num_env_steps_trained_lifetime_throughput": 46435.27958311423}, "default_policy": {"weights_seq_no": 72.0, "policy_loss": -0.00011281394108664244, "module_train_batch_size_mean": 997.504027034245, "vf_loss": 0.35831719636917114, "mean_kl_loss": 5.982011316518765e-06, "diff_num_grad_updates_vs_sampler_policy": 61.0, "vf_explained_var": 0.00285416841506958, "use_intrinsic_rewards": 1.0, "entropy": 0.6816946864128113, "num_module_steps_trained": 35910, "vf_loss_unclipped": 43.71428680419922, "total_loss": 0.27798357605934143, "num_module_steps_trained_lifetime": 430920}, "intrinsic_reward_module": {"total_loss": 0.0, "num_module_steps_trained_lifetime": 430920, "module_train_batch_size_mean": 997.504027034245, "weights_seq_no": 72.0, "num_module_steps_trained": 35910, "diff_num_grad_updates_vs_sampler_policy": 61.0}}}, "intrinsic_reward_module": {"diff_num_grad_updates_vs_sampler_policy": 1.0, "gradients_default_optimizer_global_norm": 0.0, "curr_entropy_coeff": 0.0015431216992, "weights_seq_no": 12.0, "default_optimizer_learning_rate": 0.0002715581955, "total_loss": 0.0, "num_module_steps_trained_lifetime": 71820, "module_train_batch_size_mean": 997.7412016936058, "num_trainable_parameters": 8266, "num_module_steps_trained": 5985, "num_module_steps_trained_lifetime_throughput": 713.1081791663851}, "IntrinsicAttentionMask": [[[0.09167192876338959, 0.09009412676095963, 0.08999663591384888, 0.08989925682544708, 0.09127578884363174, 0.0922870859503746, 0.09218722581863403, 0.08951078355312347, 0.09198782593011856, 0.09040459245443344, 0.09068479388952255], [0.09147752821445465, 0.090302474796772, 0.09022969752550125, 0.09015697985887527, 0.09118299186229706, 0.09193426370620728, 0.09186017513275146, 0.08986669778823853, 0.09171216934919357, 0.09053409844636917, 0.09074297547340393], [0.09146538376808167, 0.09031543880701065, 0.09024421125650406, 0.09017303586006165, 0.09117718040943146, 0.09191226959228516, 0.09183978289365768, 0.08988890796899796, 0.09169497340917587, 0.09054214507341385, 0.09074657410383224], [0.09145326167345047, 0.09032843261957169, 0.09025874733924866, 0.0901891216635704, 0.09117137640714645, 0.09189029783010483, 0.0918194055557251, 0.08991113305091858, 0.09167779237031937, 0.09055020660161972, 0.09075018018484116], [0.091623455286026, 0.09014610201120377, 0.09005477279424667, 0.08996352553367615, 0.09125268459320068, 0.09219900518655777, 0.09210558980703354, 0.08959948271512985, 0.09191904217004776, 0.09043692797422409, 0.09069935977458954], [0.0917467400431633, 0.09001381695270538, 0.08990684151649475, 0.08979999274015427, 0.09131138026714325, 0.09242317825555801, 0.09231333434581757, 0.0893738716840744, 0.0920940488576889, 0.0903545692563057, 0.09066221117973328], [0.0917346328496933, 0.09002681821584702, 0.08992137759923935, 0.08981606364250183, 0.09130562096834183, 0.09240113943815231, 0.092292919754982, 0.08939602226018906, 0.0920768529176712, 0.09036266803741455, 0.09066586941480637], [0.09140472114086151, 0.09038037061691284, 0.09031687676906586, 0.09025342762470245, 0.09114812314510345, 0.09180241823196411, 0.09173791855573654, 0.09000005573034286, 0.09160906821489334, 0.09058242291212082, 0.09076457470655441], [0.0917104110121727, 0.09005282074213028, 0.08995044976472855, 0.08984819799661636, 0.09129410237073898, 0.09235706925392151, 0.09225208312273026, 0.08944034576416016, 0.0920424610376358, 0.09037886559963226, 0.09067318588495255], [0.09151606261730194, 0.09026119858026505, 0.09018351882696152, 0.09010589867830276, 0.09120142459869385, 0.09200411289930344, 0.09192492812871933, 0.08979611098766327, 0.09176676720380783, 0.09050846844911575, 0.09073148667812347], [0.09155072271823883, 0.09022405743598938, 0.09014197438955307, 0.09005995094776154, 0.09121798723936081, 0.09206697344779968, 0.09198320657014847, 0.08973263204097748, 0.09181589633226395, 0.09048539400100708, 0.09072113782167435]], [[0.08917124569416046, 0.09058576822280884, 0.09162546694278717, 0.09038285166025162, 0.08877218514680862, 0.09131776541471481, 0.09007931500673294, 0.0895899161696434, 0.10251905769109726, 0.09034117311239243, 0.08561523258686066], [0.08877882361412048, 0.09049391001462936, 0.09175822138786316, 0.0902475118637085, 0.08829601854085922, 0.09138371050357819, 0.08987917006015778, 0.08928585052490234, 0.10518662631511688, 0.09019692242145538, 0.0844932571053505], [0.08849034458398819, 0.09042223542928696, 0.09184939414262772, 0.09014440327882767, 0.08794737607240677, 0.09142638742923737, 0.08972924947738647, 0.08906096965074539, 0.1071581318974495, 0.09008736908435822, 0.08368418365716934], [0.08883512020111084, 0.09050749242305756, 0.09173979610204697, 0.09026727825403214, 0.08836419880390167, 0.09137481451034546, 0.0899081602692604, 0.08932960778474808, 0.10480289161205292, 0.0902179628610611, 0.08465269953012466], [0.08928193897008896, 0.09061048179864883, 0.091586172580719, 0.09041997790336609, 0.0889068990945816, 0.09129747748374939, 0.09013496339321136, 0.08967529237270355, 0.10176963359117508, 0.09038084745407104, 0.0859362930059433], [0.08857571333646774, 0.09044380486011505, 0.09182295948266983, 0.09017522633075714, 0.08805043250322342, 0.09141425043344498, 0.08977384865283966, 0.08912762999534607, 0.10657370090484619, 0.0901200920343399, 0.08392228186130524], [0.08891933411359787, 0.09052755683660507, 0.0917118489742279, 0.09029662609100342, 0.08846626430749893, 0.0913611501455307, 0.08995134383440018, 0.0893949642777443, 0.10422955453395844, 0.0902492105960846, 0.08489212393760681], [0.08905511349439621, 0.09055928140878677, 0.0916658267378807, 0.0903434008359909, 0.0886310413479805, 0.09133824706077576, 0.090020552277565, 0.08950015902519226, 0.10330682247877121, 0.0902990773320198, 0.08528056740760803], [0.08547146618366241, 0.08948035538196564, 0.09250431507825851, 0.08889782428741455, 0.08436223119497299, 0.09160246700048447, 0.08803114295005798, 0.0866454616189003, 0.1283075213432312, 0.08877850323915482, 0.07591864466667175], [0.08884668350219727, 0.09051027148962021, 0.09173598140478134, 0.09027132391929626, 0.08837821334600449, 0.09137296676635742, 0.08991410583257675, 0.08933859318494797, 0.10472413152456284, 0.09022226929664612, 0.08468550443649292], [0.09015710651874542, 0.09078657627105713, 0.09124574810266495, 0.09069661051034927, 0.08997852355241776, 0.09111016243696213, 0.09056183695793152, 0.09034399688243866, 0.09589166194200516, 0.09067811816930771, 0.08854963630437851]], [[0.09167297929525375, 0.0900951623916626, 0.09147469699382782, 0.09137571603059769, 0.08980301022529602, 0.09079799056053162, 0.0921882838010788, 0.08951181173324585, 0.09198888391256332, 0.09040562808513641, 0.09068582952022552], [0.09147810935974121, 0.09030304104089737, 0.09133072197437286, 0.09125712513923645, 0.09008489549160004, 0.09082711488008499, 0.09186075627803802, 0.08986726403236389, 0.09171275049448013, 0.09053467214107513, 0.0907435491681099], [0.09164867550134659, 0.09012109041213989, 0.09145674854516983, 0.09136093407869339, 0.08983813971281052, 0.09080164134502411, 0.09214739501476288, 0.08955609053373337, 0.09195442497730255, 0.09042173624038696, 0.09069305658340454], [0.0916365385055542, 0.09013406187295914, 0.09144778549671173, 0.09135355800390244, 0.08985572308301926, 0.09080348163843155, 0.09212696552276611, 0.08957824110984802, 0.09193720668554306, 0.09042980521917343, 0.09069667756557465], [0.09144164621829987, 0.09034193307161331, 0.0913037657737732, 0.09123489260673523, 0.09013766795396805, 0.09083250910043716, 0.09179955720901489, 0.08993387222290039, 0.09166113287210464, 0.09055878221988678, 0.09075430035591125], [0.09156534075737, 0.09021000564098358, 0.09139519929885864, 0.09131024032831192, 0.08995868265628815, 0.09081413596868515, 0.09200727194547653, 0.08970806002616882, 0.09183630347251892, 0.09047695249319077, 0.09071777015924454], [0.09173586964607239, 0.09002804011106491, 0.09152111411094666, 0.09141392260789871, 0.08971207588911057, 0.09078847616910934, 0.09229416400194168, 0.08939722925424576, 0.09207809716463089, 0.09036388993263245, 0.09066709131002426], [0.09140517562627792, 0.09038081765174866, 0.09127678722143173, 0.09121265262365341, 0.09019046276807785, 0.09083788096904755, 0.09173837304115295, 0.09000050276517868, 0.09160951524972916, 0.09058287739753723, 0.09076502174139023], [0.09171158820390701, 0.0900539681315422, 0.09150318801403046, 0.0913991704583168, 0.08974720537662506, 0.09079216420650482, 0.09225326031446457, 0.08944148570299149, 0.09204363822937012, 0.09038002043962479, 0.09067434072494507], [0.09151673316955566, 0.09026185423135757, 0.09135927259922028, 0.09128064662218094, 0.09002900123596191, 0.09082137793302536, 0.09192559868097305, 0.0897967591881752, 0.09176743775606155, 0.09050912410020828, 0.0907321497797966], [0.09155147522687912, 0.09022480994462967, 0.09138495475053787, 0.0913018062710762, 0.08997875452041626, 0.09081621468067169, 0.09198396652936935, 0.08973337709903717, 0.09181665629148483, 0.09048614650964737, 0.09072189033031464]], [[0.09097733348608017, 0.08898545801639557, 0.09213729202747345, 0.09060132503509521, 0.09047634154558182, 0.08987154811620712, 0.08837335556745529, 0.09150350838899612, 0.10363022238016129, 0.08868973702192307, 0.08475387841463089], [0.09098055958747864, 0.08938394486904144, 0.09190711379051208, 0.09067970514297485, 0.09057964384555817, 0.09009508043527603, 0.08889187127351761, 0.09140114486217499, 0.10096664726734161, 0.08914630115032196, 0.085968017578125], [0.09097155928611755, 0.08875437080860138, 0.0922653079032898, 0.09055259823799133, 0.09041336923837662, 0.08974000066518784, 0.08807416260242462, 0.09155819565057755, 0.10518156737089157, 0.08842568099498749, 0.08406312763690948], [0.09097859263420105, 0.08906051516532898, 0.09209484606981277, 0.0906166359782219, 0.09049630910158157, 0.08991397172212601, 0.08847075700759888, 0.09148500859737396, 0.1031273677945137, 0.08877561241388321, 0.0849803239107132], [0.0909789502620697, 0.08908548951148987, 0.09208065271377563, 0.09062168747186661, 0.09050291031599045, 0.08992806077003479, 0.08850320428609848, 0.09147878736257553, 0.10296022891998291, 0.0888042002916336, 0.0850558876991272], [0.09098019450902939, 0.08920642733573914, 0.09201115369796753, 0.0906456932425499, 0.09053446352481842, 0.08999602496623993, 0.08866046369075775, 0.09144803136587143, 0.10215146839618683, 0.08894271403551102, 0.08542346954345703], [0.09097979217767715, 0.08950681984424591, 0.09183366596698761, 0.09070239216089249, 0.09061010926961899, 0.09016312658786774, 0.08905243128538132, 0.09136747568845749, 0.1001482680439949, 0.0892874002456665, 0.08634845167398453], [0.0909750759601593, 0.08888055384159088, 0.09219591319561005, 0.09057950228452682, 0.0904480367898941, 0.08981200307607651, 0.08823739737272263, 0.0915287658572197, 0.10433392971754074, 0.08856980502605438, 0.08443909883499146], [0.09077714383602142, 0.08650445193052292, 0.09331672638654709, 0.08996205776929855, 0.08969199657440186, 0.08839141577482224, 0.0852137953042984, 0.09192443639039993, 0.1205424815416336, 0.08587959408760071, 0.07779589295387268], [0.09098029136657715, 0.08944327384233475, 0.09187178313732147, 0.0906907469034195, 0.09059443324804306, 0.09012798964977264, 0.08896936476230621, 0.09138499945402145, 0.10057125240564346, 0.08921441435813904, 0.0861513689160347], [0.09095756709575653, 0.09023740887641907, 0.0913723036646843, 0.09082240611314774, 0.09077739715576172, 0.09055904299020767, 0.0900140330195427, 0.09114611893892288, 0.09531161934137344, 0.09012962132692337, 0.0886724591255188]], [[0.09153672307729721, 0.08996125310659409, 0.09133873134851456, 0.09123989939689636, 0.08966953307390213, 0.09066303074359894, 0.09205126017332077, 0.09084562957286835, 0.09185215830802917, 0.09175276756286621, 0.08908893167972565], [0.09137697517871857, 0.09020320326089859, 0.09122975170612335, 0.09115622937679291, 0.08998529613018036, 0.09072669595479965, 0.09175919741392136, 0.09086272865533829, 0.0916113555431366, 0.09153752774000168, 0.08955105394124985], [0.09151683002710342, 0.08999143540859222, 0.09132517874240875, 0.09122949838638306, 0.08970889449119568, 0.09067101031541824, 0.09201482683420181, 0.09084780514240265, 0.09182213246822357, 0.09172593802213669, 0.08914647996425629], [0.09150687605142593, 0.090006522834301, 0.09131838381290436, 0.0912242904305458, 0.08972857892513275, 0.0906749963760376, 0.09199660271406174, 0.0908488780260086, 0.09180711209774017, 0.09171251207590103, 0.0891752615571022], [0.09134704619646072, 0.0902484729886055, 0.0912092998623848, 0.0911405086517334, 0.09004441648721695, 0.09073853492736816, 0.0917045846581459, 0.090865857899189, 0.091566301882267, 0.09149724245071411, 0.08963769674301147], [0.09144851565361023, 0.0900949016213417, 0.09127859026193619, 0.09119374305009842, 0.08984389901161194, 0.09069827198982239, 0.0918898805975914, 0.09085515141487122, 0.0917191356420517, 0.0916338786482811, 0.08934399485588074], [0.09158823639154434, 0.08988314867019653, 0.09137382358312607, 0.09126680344343185, 0.08956769853830338, 0.09064236283302307, 0.09214562922716141, 0.09083998203277588, 0.09192991256713867, 0.09182224422693253, 0.08894012123346329], [0.09146703034639359, 0.09006686508655548, 0.09129121899604797, 0.09120343625545502, 0.08980730921030045, 0.09069088846445084, 0.09192372858524323, 0.09085316210985184, 0.09174703806638718, 0.0916588231921196, 0.08929044008255005], [0.09156834334135056, 0.08991331607103348, 0.09136027842760086, 0.09125641733407974, 0.08960703015327454, 0.09065035730600357, 0.09210917353630066, 0.09084217250347137, 0.09189987927675247, 0.0917954072356224, 0.08899758756160736], [0.09155840426683426, 0.08992841094732285, 0.09135350584983826, 0.09125123172998428, 0.08962671458721161, 0.09065435826778412, 0.09209095686674118, 0.09084327518939972, 0.09188487380743027, 0.09178200364112854, 0.08902633935213089], [0.09128716588020325, 0.09033901989459991, 0.0911683738231659, 0.09110903739929199, 0.0901627391576767, 0.0907621756196022, 0.09159541130065918, 0.09087205678224564, 0.09147621691226959, 0.09141667932271957, 0.08981119841337204]], [[0.09104731678962708, 0.09186094254255295, 0.09157849103212357, 0.09087434411048889, 0.0916864275932312, 0.09227980673313141, 0.09070170670747757, 0.09216289967298508, 0.08550143241882324, 0.09172064810991287, 0.09058599174022675], [0.09109066426753998, 0.09221731126308441, 0.09182576090097427, 0.09085164964199066, 0.09197533875703812, 0.09279881417751312, 0.09061326086521149, 0.09263641387224197, 0.08351448178291321, 0.09202276915311813, 0.09045356512069702], [0.09107623249292374, 0.09209438413381577, 0.091740682721138, 0.09086008369922638, 0.09187581390142441, 0.09261941909790039, 0.09064443409442902, 0.09247281402349472, 0.084197498857975, 0.09191866219043732, 0.09049995243549347], [0.09103737771511078, 0.09178426861763, 0.09152504801750183, 0.09087853133678436, 0.09162411093711853, 0.09216856956481934, 0.09071995317935944, 0.09206131845712662, 0.08593156933784485, 0.09165552258491516, 0.09061364829540253], [0.09108182042837143, 0.09214144945144653, 0.09177327901124954, 0.09085691720247269, 0.09191393107175827, 0.09268806129693985, 0.09063257277011871, 0.09253542125225067, 0.08393564075231552, 0.09195853024721146, 0.09048227220773697], [0.09111087769269943, 0.09239808470010757, 0.09195048362016678, 0.09083808213472366, 0.0921214371919632, 0.09306333214044571, 0.09056610614061356, 0.09287747740745544, 0.08251455426216125, 0.09217566251754761, 0.09038396924734116], [0.09102722257375717, 0.09170743823051453, 0.09147141128778458, 0.09088248759508133, 0.09156162291765213, 0.0920572429895401, 0.09073798358440399, 0.0919596329331398, 0.08636368066072464, 0.09159021824598312, 0.0906410962343216], [0.0911053791642189, 0.09234780818223953, 0.09191584587097168, 0.09084199368953705, 0.09208083897829056, 0.09298968315124512, 0.09057937562465668, 0.09281037747859955, 0.08279209583997726, 0.09213316440582275, 0.0904034897685051], [0.09058917313814163, 0.08923222869634628, 0.08969960361719131, 0.09088187664747238, 0.08952054381370544, 0.08854620158672333, 0.09117551892995834, 0.08873683959245682, 0.10078088939189911, 0.08946388959884644, 0.09137318283319473], [0.0910835787653923, 0.09215635061264038, 0.09178360551595688, 0.0908559113740921, 0.09192600846290588, 0.09270980954170227, 0.09062881022691727, 0.09255525469779968, 0.0838528499007225, 0.09197116643190384, 0.09047666192054749], [0.09102025628089905, 0.09165574610233307, 0.09143528342247009, 0.09088499844074249, 0.0915195494890213, 0.09198243170976639, 0.09074994176626205, 0.09189128130674362, 0.08665484189987183, 0.09154625982046127, 0.09065938740968704]]]}, "num_training_step_calls_per_iteration": 1, "evaluation": {"env_runners": {"episode_len_max": 20, "rlmodule_inference_timer": 3.4618747471961645e-05, "num_module_steps_sampled": {"default_policy": 400}, "sample": 0.1694662798456803, "env_to_module_connector": {"timers": {"connectors": {"add_states_from_episodes_to_batch": 3.1397424452019728e-06, "add_time_dim_to_batch_and_zero_pad": 7.199869297051502e-06, "add_observations_from_episodes_to_batch": 2.941662615655577e-06, "numpy_to_tensor": 1.345012284362926e-05, "batch_individual_items": 1.3038923787645122e-05}}, "connector_pipeline_timer": 6.297481579710956e-05}, "module_episode_returns_mean": {"default_policy": -0.05}, "module_to_env_connector": {"timers": {"connectors": {"normalize_and_clip_actions": 8.266442927820914e-06, "remove_single_ts_time_rank_from_batch": 1.2244648686519446e-05, "tensor_to_numpy": 1.6123939867899207e-05, "listify_data_for_vector_env": 1.1470291586451756e-05, "un_batch_to_individual_items": 6.91847255419858e-06, "get_actions": 4.234772715972711e-05}}, "connector_pipeline_timer": 0.0001259211992300972}, "episode_duration_sec_mean": 0.005412014588946476, "weights_seq_no": 12.0, "env_to_module_sum_episodes_length_out": 10.368238394574323, "agent_episode_returns_mean": {"default_agent": -0.05}, "episode_return_mean": -0.05, "env_to_module_sum_episodes_length_in": 10.368238394574323, "num_episodes_lifetime": 240, "num_agent_steps_sampled_lifetime": {"default_agent": 4800}, "num_episodes": 20, "episode_len_mean": 20.0, "num_agent_steps_sampled": {"default_agent": 400}, "num_module_steps_sampled_lifetime": {"default_policy": 4800}, "env_reset_timer": 0.002236609777080197, "episode_return_min": -16.5, "num_env_steps_sampled": 400, "episode_len_min": 20, "episode_return_max": 12.5, "env_step_timer": 1.5387368295894243e-05, "num_env_steps_sampled_lifetime": 60400, "time_between_sampling": 10.862358495519471}, "num_healthy_workers": 1, "actor_manager_num_outstanding_async_reqs": 0, "num_remote_worker_restarts": 0}, "num_env_steps_sampled_lifetime": -6165000.0, "fault_tolerance": {"num_healthy_workers": 0, "num_remote_worker_restarts": 0}, "env_runner_group": {"actor_manager_num_outstanding_async_reqs": 0}, "done": false, "training_iteration": 12, "trial_id": "b154b_00000", "date": "2025-08-11_18-13-26", "timestamp": 1754928806, "time_this_iter_s": 9.964319944381714, "time_total_s": 121.16841697692871, "pid": 10455, "hostname": "Mac", "node_ip": "127.0.0.1", "config": {"exploration_config": {}, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 2, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "env": "Umbrella", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": false, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 0, "create_local_env_runner": true, "num_envs_per_env_runner": 1, "gym_env_vectorize_mode": "SYNC", "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "episodes_to_numpy": true, "max_requests_in_flight_per_env_runner": 1, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "merge_env_runner_states": "training_only", "broadcast_env_runner_states": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "complete_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "sampler_perf_stats_ema_coef": null, "_is_online": true, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": "auto", "num_aggregator_actors_per_learner": 0, "max_requests_in_flight_per_aggregator_actor": 3, "local_gpu_idx": 0, "max_requests_in_flight_per_learner": 3, "gamma": 1, "lr": 0.0002715581955, "grad_clip": 0.5, "grad_clip_by": "global_norm", "_train_batch_size_per_learner": 5000, "train_batch_size": 4000, "num_epochs": 1, "minibatch_size": 1000, "shuffle_batch_per_epoch": true, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "log_std_clip_param": 20.0, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "_disable_preprocessor_api": false, "_disable_action_flattening": false}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {"intrinsic_reward_coeff": 0.2795015916508}, "optimizer": {}, "_learner_class": "<class 'source.intrinsic_attention_ppo.learners.IntrinsicAttentionMetaLearner.IntrinsicAttentionMetaLearner'>", "callbacks_on_algorithm_init": null, "callbacks_on_env_runners_recreated": null, "callbacks_on_offline_eval_runners_recreated": null, "callbacks_on_checkpoint_loaded": null, "callbacks_on_environment_created": null, "callbacks_on_episode_created": null, "callbacks_on_episode_start": null, "callbacks_on_episode_step": null, "callbacks_on_episode_end": null, "callbacks_on_evaluate_start": null, "callbacks_on_evaluate_end": null, "callbacks_on_evaluate_offline_start": null, "callbacks_on_evaluate_offline_end": null, "callbacks_on_sample_end": null, "callbacks_on_train_result": null, "explore": true, "enable_rl_module_and_learner": true, "enable_env_runner_and_connector_v2": true, "_prior_exploration_config": {"type": "StochasticSampling"}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x1514e58a0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "offline_data_class": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_read_batch_size": null, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "materialize_data": false, "materialize_mapped_data": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "ignore_final_observation": false, "prelearner_class": null, "prelearner_buffer_class": null, "prelearner_buffer_kwargs": {}, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_remaining_data": false, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": 1, "evaluation_duration": 20, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_auto_duration_min_env_steps_per_sample": 100, "evaluation_auto_duration_max_env_steps_per_sample": 2000, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 1, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "offline_evaluation_interval": null, "num_offline_eval_runners": 0, "offline_loss_for_module_fn": null, "offline_evaluation_duration": 1, "offline_evaluation_parallel_to_training": false, "offline_evaluation_timeout_s": 120.0, "num_cpus_per_offline_eval_runner": 1, "num_gpus_per_offline_eval_runner": 0, "custom_resources_per_offline_eval_runner": {}, "restart_failed_offline_eval_runners": true, "ignore_offline_eval_runner_failures": false, "max_num_offline_eval_runner_restarts": 1000, "offline_eval_runner_restore_timeout_s": 1800.0, "max_requests_in_flight_per_offline_eval_runner": 1, "validate_offline_eval_runners_after_construction": true, "offline_eval_runner_health_probe_timeout_s": 30.0, "offline_eval_rl_module_inference_only": false, "broadcast_offline_eval_runner_states": false, "offline_eval_batch_size_per_runner": 256, "dataset_num_iters_per_eval_runner": 1, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "log_gradients": false, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 4, "restart_failed_env_runners": true, "ignore_env_runner_failures": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30.0, "env_runner_restore_timeout_s": 1800.0, "_model_config": {}, "_rl_module_spec": "MultiRLModuleSpec(multi_rl_module_class=<class 'ray.rllib.core.rl_module.multi_rl_module.MultiRLModule'>, observation_space=None, action_space=None, inference_only=False, model_config=None, rl_module_specs={'default_policy': RLModuleSpec(module_class=<class 'source.intrinsic_attention_ppo.rl_modules.DifferentiablePPOModule.DifferentiablePPOModule'>, observation_space=None, action_space=None, inference_only=False, learner_only=False, model_config={'vf_share_layers': True, 'embedding_dim': 62, 'max_seq_len': 11, 'policy_head_hidden_sizes': [32], 'value_head_hidden_sizes': [101], 'embedding_hidden_sizes': [121]}, catalog_class=None, load_state_path=None, model_config_dict=None), 'intrinsic_reward_module': RLModuleSpec(module_class=<class 'source.intrinsic_attention_ppo.rl_modules.IntrinsicAttentionModule.IntrinsicAttentionModule'>, observation_space=None, action_space=None, inference_only=False, learner_only=True, model_config={'intrinsic_reward_network': {'encoder_hidden_sizes': [], 'encoding_dim': 1, 'num_heads': 1, 'head_hidden_sizes': None, 'layers': [{'type': 'attention'}]}, 'extrinsic_value_hidden_layers': [127, 60], 'vf_share_layers': True, 'max_seq_len': 11}, catalog_class=None, load_state_path=None, model_config_dict=None)}, load_state_path=None, modules_to_load=None, module_specs={'default_policy': RLModuleSpec(module_class=<class 'source.intrinsic_attention_ppo.rl_modules.DifferentiablePPOModule.DifferentiablePPOModule'>, observation_space=None, action_space=None, inference_only=False, learner_only=False, model_config={'vf_share_layers': True, 'embedding_dim': 62, 'max_seq_len': 11, 'policy_head_hidden_sizes': [32], 'value_head_hidden_sizes': [101], 'embedding_hidden_sizes': [121]}, catalog_class=None, load_state_path=None, model_config_dict=None), 'intrinsic_reward_module': RLModuleSpec(module_class=<class 'source.intrinsic_attention_ppo.rl_modules.IntrinsicAttentionModule.IntrinsicAttentionModule'>, observation_space=None, action_space=None, inference_only=False, learner_only=True, model_config={'intrinsic_reward_network': {'encoder_hidden_sizes': [], 'encoding_dim': 1, 'num_heads': 1, 'head_hidden_sizes': None, 'layers': [{'type': 'attention'}]}, 'extrinsic_value_hidden_layers': [127, 60], 'vf_share_layers': True, 'max_seq_len': 11}, catalog_class=None, load_state_path=None, model_config_dict=None)})", "algorithm_config_overrides_per_module": {"intrinsic_reward_module": {"lr": 0.0002715581955}}, "_per_module_overrides": {}, "_validate_config": true, "_use_msgpack_checkpoints": false, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "env_task_fn": -1, "enable_connectors": -1, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.161583927863, "kl_target": 0.0201019014258, "vf_loss_coeff": 0.7790510010087, "entropy_coeff": 0.0015431216992, "clip_param": 0.2459212356676, "vf_clip_param": 0.3769744131561, "entropy_coeff_schedule": null, "lr_schedule": null, "sgd_minibatch_size": -1, "vf_share_layers": -1, "differentiable_learner_configs": ["DifferentiableLearnerConfig(learner_class=<class 'source.intrinsic_attention_ppo.learners.IntrinsicAttentionPPOLearner.IntrinsicAttentionPPOLearner'>, learner_connector=None, add_default_connectors_to_learner_pipeline=True, is_multi_agent=False, policies_to_update=['default_policy'], lr=0.0060984166342, num_total_minibatches=0, num_epochs=1, minibatch_size=1000, shuffle_batch_per_epoch=True)"], "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9485408017724, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.callbacks.callbacks.RLlibCallback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 121.16841697692871, "iterations_since_restore": 12, "perf": {"cpu_util_percent": 47.34285714285714, "ram_util_percent": 82.0357142857143}}
{"timers": {"training_iteration": 10.168304297647516, "restore_env_runners": 1.059638146319401e-05, "training_step": 10.168102971097278, "env_runner_sampling_timer": 1.8171549104916807, "learner_update_timer": 8.170541473329754, "synch_weights": 0.0015110903502547777, "restore_eval_env_runners": 7.513056683750529e-05, "evaluation_iteration": 0.2091751702931596, "synch_eval_env_connectors": 0.00022336823695010477, "synch_env_connectors": 5.104049770950742e-06}, "env_runners": {"num_env_steps_sampled": 5000.0, "episode_return_max": 12.5, "env_to_module_connector": {"timers": {"connectors": {"add_time_dim_to_batch_and_zero_pad": 7.657678628530034e-06, "add_observations_from_episodes_to_batch": 3.288425067355027e-06, "batch_individual_items": 1.3558464303334734e-05, "numpy_to_tensor": 1.4200773884573133e-05, "add_states_from_episodes_to_batch": 2.9056388405343288e-06}}, "connector_pipeline_timer": 6.606074542234554e-05}, "episode_len_min": 20, "module_to_env_connector": {"timers": {"connectors": {"un_batch_to_individual_items": 7.178178651763251e-06, "normalize_and_clip_actions": 8.649264516007684e-06, "remove_single_ts_time_rank_from_batch": 1.2737208927636964e-05, "get_actions": 5.058497512498455e-05, "tensor_to_numpy": 1.6486637165257683e-05, "listify_data_for_vector_env": 1.2114153108315913e-05}}, "connector_pipeline_timer": 0.0001368007621676537}, "env_step_timer": 1.562136991074648e-05, "num_agent_steps_sampled_lifetime": {"default_agent": -6782500.0}, "num_episodes": 250.0, "episode_duration_sec_mean": 0.006070920021273196, "episode_len_mean": 20.0, "module_episode_returns_mean": {"default_policy": 4.34}, "weights_seq_no": 12.0, "env_to_module_sum_episodes_length_out": 10.36823839457432, "num_env_steps_sampled_lifetime": -6782500.0, "episode_len_max": 20, "rlmodule_inference_timer": 3.8765194297298125e-05, "num_agent_steps_sampled": {"default_agent": 5000.0}, "env_reset_timer": 4.977144520006955e-05, "agent_episode_returns_mean": {"default_agent": 4.34}, "env_to_module_sum_episodes_length_in": 10.36823839457432, "episode_return_mean": 4.34, "time_between_sampling": 0.03372635126441458, "num_module_steps_sampled_lifetime": {"default_policy": -6782500.0}, "num_module_steps_sampled": {"default_policy": 5000.0}, "num_episodes_lifetime": -339125.0, "episode_return_min": -7.5, "sample": 0.006670169805460926, "num_env_steps_sampled_lifetime_throughput": 2951.9030981182564}, "__all_modules__": {"learner_connector_sum_episodes_length_in": 5000.0, "learner_connector": {"connector_pipeline_timer": 0.1391184263270881, "timers": {"connectors": {"add_one_ts_to_episodes_and_truncate": 0.009514371080134495, "add_observations_from_episodes_to_batch": 0.0010312173021365173, "add_columns_from_episodes_to_train_batch": 0.04396518104423577, "add_time_dim_to_batch_and_zero_pad": 0.07637534444339898, "add_states_from_episodes_to_batch": 0.0036104297978097008, "batch_individual_items": 0.004360862088291763, "numpy_to_tensor": 7.313904680559257e-05}}}, "learner_connector_sum_episodes_length_out": 5250.0}, "learners": {"__all_modules__": {"num_module_steps_trained_lifetime": 155610, "num_env_steps_trained": 33000, "num_env_steps_trained_lifetime": 429000, "num_non_trainable_parameters": 0, "num_trainable_parameters": 24861, "num_module_steps_trained": 11970, "num_env_steps_trained_lifetime_throughput": 3928.3430709455765, "num_module_steps_trained_throughput": 23273546.19568935, "num_module_steps_trained_lifetime_throughput": 12611819.294081548}, "default_policy": {"curr_entropy_coeff": 0.0015431216992, "weights_seq_no": 13.0, "curr_kl_coeff": 1.9724600861081854e-05, "policy_loss": -8.837365021463484e-05, "module_train_batch_size_mean": 997.7269395717314, "num_trainable_parameters": 16595, "vf_loss": 0.3583095669746399, "mean_kl_loss": 2.550087810959667e-05, "diff_num_grad_updates_vs_sampler_policy": 1.0, "vf_explained_var": 0.001083970069885254, "use_intrinsic_rewards": 0.0, "entropy": 0.6804700493812561, "num_module_steps_trained": 5985, "vf_loss_unclipped": 43.96892547607422, "total_loss": 0.2780030071735382, "num_module_steps_trained_lifetime": 77805, "num_module_steps_trained_lifetime_throughput": 712.2466638464039}, "differentiable_learners": {"intrinsic_attention_ppo_learner": {"__all_modules__": {"num_module_steps_trained_lifetime": 933660, "num_env_steps_trained_lifetime": 2574000, "num_module_steps_trained": 71820, "num_env_steps_trained": 198000, "num_env_steps_trained_lifetime_throughput": 45760.0179749057}, "default_policy": {"weights_seq_no": 78.0, "policy_loss": -8.704752690391615e-05, "module_train_batch_size_mean": 997.5020416990191, "vf_loss": 0.35831621289253235, "mean_kl_loss": 2.510093509044964e-05, "diff_num_grad_updates_vs_sampler_policy": 66.0, "vf_explained_var": 0.002898097038269043, "use_intrinsic_rewards": 1.0, "entropy": 0.6804790496826172, "num_module_steps_trained": 35910, "vf_loss_unclipped": 43.95389938354492, "total_loss": 0.27801352739334106, "num_module_steps_trained_lifetime": 466830}, "intrinsic_reward_module": {"total_loss": 0.0, "num_module_steps_trained_lifetime": 466830, "module_train_batch_size_mean": 997.5020416990191, "weights_seq_no": 78.0, "num_module_steps_trained": 35910, "diff_num_grad_updates_vs_sampler_policy": 66.0}}}, "intrinsic_reward_module": {"diff_num_grad_updates_vs_sampler_policy": 1.0, "gradients_default_optimizer_global_norm": 0.0, "curr_entropy_coeff": 0.0015431216992, "weights_seq_no": 13.0, "default_optimizer_learning_rate": 0.0002715581955, "total_loss": 0.0, "num_module_steps_trained_lifetime": 77805, "module_train_batch_size_mean": 997.7269395717314, "num_trainable_parameters": 8266, "num_module_steps_trained": 5985, "num_module_steps_trained_lifetime_throughput": 712.2538426651729}, "IntrinsicAttentionMask": [[[0.09181023389101028, 0.0902300551533699, 0.09013241529464722, 0.09003488719463348, 0.09141349047422409, 0.09093392640352249, 0.09232630580663681, 0.09111706912517548, 0.09063905477523804, 0.09054098278284073, 0.09082160145044327], [0.09157979488372803, 0.09040342271327972, 0.0903305634856224, 0.09025777131319046, 0.09128493070602417, 0.0909280776977539, 0.09196286648511887, 0.09106440842151642, 0.0907084122300148, 0.09063530713319778, 0.09084441512823105], [0.09156543761491776, 0.09041423350572586, 0.0903429239988327, 0.09027167409658432, 0.09127690643072128, 0.09092769771814346, 0.09194023907184601, 0.09106111526489258, 0.09071272611618042, 0.09064118564128876, 0.09084583073854446], [0.09155107289552689, 0.0904250517487526, 0.0903552919626236, 0.09028558433055878, 0.09126888960599899, 0.09092732518911362, 0.09191761910915375, 0.09105782210826874, 0.09071704745292664, 0.09064706414937973, 0.09084723889827728], [0.09175273030996323, 0.09027329087257385, 0.09018182754516602, 0.09009046107530594, 0.09138143807649612, 0.09093249589204788, 0.09223554283380508, 0.09110395610332489, 0.09065638482570648, 0.09056452661752701, 0.0908273234963417], [0.09168290346860886, 0.09032582491636276, 0.09024185687303543, 0.09015797823667526, 0.091342493891716, 0.09093073755502701, 0.09212540090084076, 0.09108801931142807, 0.0906774029135704, 0.0905931144952774, 0.09083424508571625], [0.09188468009233475, 0.09017407149076462, 0.09006845951080322, 0.08996296674013138, 0.09145496785640717, 0.09093574434518814, 0.09244387596845627, 0.09113400429487228, 0.09061659872531891, 0.09051047265529633, 0.09081416577100754], [0.09170960634946823, 0.09030573070049286, 0.09021889418363571, 0.09013215452432632, 0.09135739505290985, 0.09093141555786133, 0.09216751903295517, 0.09109411388635635, 0.09066936373710632, 0.09058218449354172, 0.09083160012960434], [0.09163980185985565, 0.09035825729370117, 0.09027893841266632, 0.09019967913627625, 0.09131843596696854, 0.09092962741851807, 0.09205743670463562, 0.09107815474271774, 0.09069037437438965, 0.09061075747013092, 0.09083850681781769], [0.09162543714046478, 0.0903690755367279, 0.09029129892587662, 0.0902135819196701, 0.09131041914224625, 0.09092926234006882, 0.09203479439020157, 0.0910748690366745, 0.09069469571113586, 0.0906166359782219, 0.0908399298787117], [0.09166649729013443, 0.09033816307783127, 0.090255968272686, 0.09017384797334671, 0.09133333712816238, 0.09093032032251358, 0.09209953248500824, 0.09108426421880722, 0.09068233519792557, 0.09059982746839523, 0.09083586931228638]], [[0.08903531730175018, 0.09044768661260605, 0.09148579835891724, 0.0902450755238533, 0.09014393389225006, 0.09117855876684189, 0.08843830227851868, 0.09097430855035782, 0.10236279666423798, 0.09020346403121948, 0.08548472821712494], [0.08861452341079712, 0.09032644331455231, 0.09158841520547867, 0.09008049964904785, 0.08995778113603592, 0.0912146046757698, 0.08789265155792236, 0.09096623957157135, 0.10499198734760284, 0.0900300145149231, 0.08433689922094345], [0.08830570429563522, 0.09023357927799225, 0.09165775775909424, 0.08995631337165833, 0.08981800824403763, 0.09123563021421432, 0.08749420195817947, 0.09095529466867447, 0.1069345697760582, 0.08989940583705902, 0.08350957930088043], [0.08867485076189041, 0.09034420549869537, 0.0915742814540863, 0.09010442346334457, 0.08998477458953857, 0.09120996296405792, 0.08797067403793335, 0.09096788614988327, 0.10461382567882538, 0.0900551974773407, 0.08449997007846832], [0.08870495855808258, 0.09035301953554153, 0.09156715124845505, 0.09011632204055786, 0.08999821543693542, 0.0912075787782669, 0.08800965547561646, 0.09096864610910416, 0.10442518442869186, 0.09006772190332413, 0.08458156883716583], [0.0883970558643341, 0.09026137739419937, 0.0916377529501915, 0.08999334275722504, 0.08985962718725204, 0.0912298709154129, 0.08761189132928848, 0.09095896035432816, 0.10635876655578613, 0.08993832021951675, 0.08375301212072372], [0.08921341598033905, 0.09049713611602783, 0.09143950790166855, 0.09031309187412262, 0.09022120386362076, 0.09116071462631226, 0.08867021650075912, 0.090975321829319, 0.1012563407421112, 0.09027528762817383, 0.08597784489393234], [0.08845780789852142, 0.0902797132730484, 0.09162421524524689, 0.09001783281564713, 0.08988717943429947, 0.09122583270072937, 0.08769024163484573, 0.09096120297908783, 0.10597638040781021, 0.08996406942605972, 0.08391550183296204], [0.0850980207324028, 0.08908939361572266, 0.09210015833377838, 0.08850941807031631, 0.08822084218263626, 0.0912022516131401, 0.08344682306051254, 0.09060851484537125, 0.12774699926376343, 0.08839061111211777, 0.07558693736791611], [0.0886872261762619, 0.09034781903028488, 0.09157134592533112, 0.09010931104421616, 0.0899902954697609, 0.09120897203683853, 0.08798670023679733, 0.09096819162368774, 0.10453619062900543, 0.09006034582853317, 0.08453351259231567], [0.09009616076946259, 0.09072519838809967, 0.09118406474590302, 0.09063529223203659, 0.09059038013219833, 0.09104856848716736, 0.08982858806848526, 0.09095834195613861, 0.09582684189081192, 0.09061681479215622, 0.08848977833986282]], [[0.09153658151626587, 0.09143752604722977, 0.08986376225948334, 0.08976652473211288, 0.09114102274179459, 0.09215082973241806, 0.09205111861228943, 0.08937861770391464, 0.09185201674699783, 0.09027111530303955, 0.09055089950561523], [0.09152663499116898, 0.09142917394638062, 0.08988039195537567, 0.08978468179702759, 0.09113740921020508, 0.09213101118803024, 0.09203290939331055, 0.08940286934375763, 0.09183700382709503, 0.09028132259845734, 0.09055667370557785], [0.09136692434549332, 0.09129486978054047, 0.09014707058668137, 0.09007596969604492, 0.09107902646064758, 0.0918133333325386, 0.0917409211397171, 0.08979213982820511, 0.09159627556800842, 0.09044468402862549, 0.09064888209104538], [0.09135694801807404, 0.09128647297620773, 0.0901637002825737, 0.09009413421154022, 0.0910753607749939, 0.09179352968931198, 0.09172271192073822, 0.08981644362211227, 0.09158124774694443, 0.09045485407114029, 0.09065461158752441], [0.0914967730641365, 0.09140406548976898, 0.08993025869131088, 0.0898391455411911, 0.09112652391195297, 0.092071533203125, 0.09197824448347092, 0.0894756019115448, 0.09179195761680603, 0.09031189233064651, 0.09057395160198212], [0.09159799665212631, 0.09148913621902466, 0.08976107835769653, 0.08965440094470978, 0.09116333723068237, 0.09227333962917328, 0.09216367453336716, 0.08922897279262543, 0.09194474667310715, 0.09020808339118958, 0.09051521867513657], [0.09158805012702942, 0.0914807841181755, 0.08977769315242767, 0.08967254310846329, 0.09115973114967346, 0.09225349873304367, 0.09214545041322708, 0.08925317972898483, 0.09192973375320435, 0.09021828323602676, 0.09052099287509918], [0.09131704270839691, 0.0912528857588768, 0.09023023396730423, 0.0901668444275856, 0.09106069058179855, 0.09171435981988907, 0.09164992719888687, 0.08991372585296631, 0.09152118861675262, 0.0904955342411995, 0.09067751467227936], [0.09156817942857742, 0.0914640873670578, 0.08981094509363174, 0.0897088497877121, 0.09115251898765564, 0.09221383929252625, 0.09210900962352753, 0.08930163085460663, 0.09189971536397934, 0.09023869782686234, 0.09053255617618561], [0.09140855818986893, 0.0913298949599266, 0.09007757902145386, 0.09000005573034286, 0.09109429270029068, 0.09189604222774506, 0.09181695431470871, 0.08969062566757202, 0.09165897965431213, 0.09040215611457825, 0.09062491357326508], [0.09143704175949097, 0.09135384112596512, 0.09003003686666489, 0.0899481251835823, 0.09110470861196518, 0.09195265173912048, 0.09186898916959763, 0.08962120860815048, 0.09170188754796982, 0.09037303924560547, 0.09060848504304886]], [[0.08959753811359406, 0.09101883322000504, 0.0905243381857872, 0.08929664641618729, 0.09071316570043564, 0.09175432473421097, 0.09050995856523514, 0.09001822024583817, 0.10128705203533173, 0.08925547450780869, 0.08602453023195267], [0.089299276471138, 0.09102441370487213, 0.09042353928089142, 0.08893479406833649, 0.09065290540456772, 0.0919194370508194, 0.09040607511997223, 0.08980927616357803, 0.10365667194128036, 0.08888494968414307, 0.08498859405517578], [0.08940313756465912, 0.09102322161197662, 0.09045915305614471, 0.08906061202287674, 0.0906744971871376, 0.0918629989027977, 0.09044276177883148, 0.08988228440284729, 0.10283108800649643, 0.08901375532150269, 0.08534644544124603], [0.08966057747602463, 0.09101677685976028, 0.09054503589868546, 0.08937333524227142, 0.09072519093751907, 0.09171820431947708, 0.09053131937980652, 0.09006208926439285, 0.10078668594360352, 0.08933402597904205, 0.08624677360057831], [0.08936349302530289, 0.09102378040552139, 0.0904456302523613, 0.08901257067918777, 0.09066633880138397, 0.09188469499349594, 0.09042882919311523, 0.08985444903373718, 0.10314621031284332, 0.0889645665884018, 0.08520948886871338], [0.08914463967084885, 0.0910247266292572, 0.09036950767040253, 0.08874785155057907, 0.09061957150697708, 0.09200141578912735, 0.09035047143697739, 0.0897001102566719, 0.10488682985305786, 0.08869358897209167, 0.08446131646633148], [0.08940616250038147, 0.09102318435907364, 0.09046018868684769, 0.08906427770853043, 0.09067513048648834, 0.09186135232448578, 0.09044381976127625, 0.08988440781831741, 0.10280710458755493, 0.08901751041412354, 0.08535690605640411], [0.08950933814048767, 0.09102118015289307, 0.09049500524997711, 0.08918946981430054, 0.09069591015577316, 0.0918041318655014, 0.09047970920801163, 0.08995666354894638, 0.10198736935853958, 0.0891457125544548, 0.08571554720401764], [0.08712626248598099, 0.09088154882192612, 0.08956373482942581, 0.08634395897388458, 0.09006553143262863, 0.0928640142083168, 0.08952559530735016, 0.08822743594646454, 0.12104474753141403, 0.08623726665973663, 0.07811986654996872], [0.08966919779777527, 0.09101647138595581, 0.09054785966873169, 0.08938383311033249, 0.0907268151640892, 0.09171323478221893, 0.09053422510623932, 0.09006808698177338, 0.10071825981140137, 0.08934478461742401, 0.08627726137638092], [0.09034350514411926, 0.09097427129745483, 0.09075544774532318, 0.09020925313234329, 0.09083908796310425, 0.09129852801561356, 0.09074907004833221, 0.09053078293800354, 0.0953764095902443, 0.09019086509943008, 0.08873271197080612]], [[0.09140091389417648, 0.09130200743675232, 0.09120321273803711, 0.09110452979803085, 0.09100594371557236, 0.09201425313949585, 0.09191469103097916, 0.08924614638090134, 0.09023496508598328, 0.09161663055419922, 0.08895675092935562], [0.0913931354880333, 0.09129581600427628, 0.09119860082864761, 0.09110148996114731, 0.09100447595119476, 0.09199663251638412, 0.09189867228269577, 0.08927246928215027, 0.09024573862552643, 0.09160540997982025, 0.08898758888244629], [0.0913853645324707, 0.09128962457180023, 0.09119398891925812, 0.09109845012426376, 0.09100300818681717, 0.0919790118932724, 0.09188265353441238, 0.0892987847328186, 0.09025651216506958, 0.09159417450428009, 0.08901842683553696], [0.09137758612632751, 0.09128342568874359, 0.09118937700986862, 0.09109541028738022, 0.09100154787302017, 0.09196139127016068, 0.091866634786129, 0.08932510763406754, 0.09026727825403214, 0.09158294647932053, 0.08904927223920822], [0.09136981517076492, 0.09127724170684814, 0.09118475764989853, 0.09109237045049667, 0.09100008010864258, 0.09194377809762955, 0.09185061603784561, 0.08935144543647766, 0.09027805179357529, 0.09157171845436096, 0.08908013254404068], [0.09144885838031769, 0.09134017676115036, 0.09123162925243378, 0.09112320840358734, 0.09101490676403046, 0.0921231061220169, 0.09201361984014511, 0.08908369392156601, 0.09016837179660797, 0.0916859582066536, 0.08876645565032959], [0.09144110977649689, 0.09133400768041611, 0.09122703969478607, 0.09112019091844559, 0.09101346880197525, 0.09210548549890518, 0.09199760854244232, 0.08910997956991196, 0.09017916023731232, 0.09167473763227463, 0.08879724144935608], [0.09122923016548157, 0.09116514027118683, 0.09110108762979507, 0.0910370871424675, 0.09097312390804291, 0.09162616729736328, 0.09156179428100586, 0.0898272693157196, 0.09047207981348038, 0.09136895090341568, 0.08963806927204132], [0.09130864590406418, 0.09122849255800247, 0.09114840626716614, 0.09106838703155518, 0.09098844230175018, 0.0918053686618805, 0.09172477573156357, 0.08955855667591095, 0.09036264568567276, 0.09148342907428741, 0.08932290971279144], [0.0914178267121315, 0.09131547808647156, 0.09121324121952057, 0.09111112356185913, 0.09100911766290665, 0.09205262362957001, 0.09194956719875336, 0.08918886631727219, 0.09021150320768356, 0.09164108335971832, 0.08888964354991913], [0.09120579063892365, 0.09114642441272736, 0.09108710289001465, 0.09102781116962433, 0.09096856415271759, 0.09157336503267288, 0.09151376038789749, 0.08990658074617386, 0.09050431847572327, 0.09133518487215042, 0.0897311344742775]], [[0.09232549369335175, 0.09101276844739914, 0.09308528900146484, 0.09207847714424133, 0.09076926112174988, 0.09159800410270691, 0.09183211624622345, 0.0914345532655716, 0.08337495476007462, 0.09204466640949249, 0.09044446796178818], [0.0918923020362854, 0.0909881591796875, 0.09241379052400589, 0.09172247350215912, 0.09081999957561493, 0.09139173477888107, 0.09155295789241791, 0.09127910435199738, 0.08564480394124985, 0.09169921278953552, 0.09059549123048782], [0.09257134795188904, 0.09102391451597214, 0.09346877038478851, 0.09227986633777618, 0.09073730558156967, 0.0917133018374443, 0.09198929369449615, 0.09152068942785263, 0.08210040628910065, 0.09223997592926025, 0.09035522490739822], [0.09224480390548706, 0.09100867062807083, 0.09295980632305145, 0.09201227873563766, 0.09077925235033035, 0.09155989438295364, 0.09178033471107483, 0.0914059579372406, 0.0837954431772232, 0.0919804498553276, 0.09047319740056992], [0.09181073307991028, 0.0909828171133995, 0.09228795021772385, 0.09165527671575546, 0.09082875400781631, 0.09135245531797409, 0.09150008112192154, 0.09124930948019028, 0.0860755667090416, 0.09163398295640945, 0.09062302857637405], [0.09208676218986511, 0.09099998325109482, 0.0927145704627037, 0.09188246726989746, 0.09079809486865997, 0.09148482233285904, 0.09167861193418503, 0.09134946018457413, 0.08462205529212952, 0.09185449033975601, 0.09052866697311401], [0.09216394275426865, 0.09100432693958282, 0.09283424913883209, 0.09194588661193848, 0.09078900516033173, 0.09152154624462128, 0.0917283371090889, 0.0913771316409111, 0.08421783149242401, 0.091916024684906, 0.09050170332193375], [0.09203267097473145, 0.09099682420492172, 0.0926307961344719, 0.09183798730373383, 0.0908043310046196, 0.0914590135216713, 0.09164371341466904, 0.09132998436689377, 0.08490592986345291, 0.09181132912635803, 0.09054742008447647], [0.08913703262805939, 0.09068736433982849, 0.08826171606779099, 0.08942504227161407, 0.09098038822412491, 0.08999014645814896, 0.08971398323774338, 0.09018388390541077, 0.10078185796737671, 0.08946459740400314, 0.09137392789125443], [0.09223373234272003, 0.09100808948278427, 0.09294260293245316, 0.09200318902730942, 0.09078060835599899, 0.091554656624794, 0.09177321940660477, 0.09140202403068542, 0.08385323733091354, 0.09197162836790085, 0.0904771238565445], [0.09170135855674744, 0.0909753143787384, 0.0921194925904274, 0.0915650948882103, 0.09084012359380722, 0.09129957109689713, 0.09142902493476868, 0.09120910614728928, 0.08665496855974197, 0.091546431183815, 0.09065955132246017]]]}, "num_training_step_calls_per_iteration": 1, "evaluation": {"env_runners": {"episode_len_max": 20, "rlmodule_inference_timer": 3.553735684909124e-05, "num_module_steps_sampled": {"default_policy": 400}, "sample": 0.16907262037737783, "env_to_module_connector": {"timers": {"connectors": {"add_states_from_episodes_to_batch": 2.9763399617549357e-06, "add_time_dim_to_batch_and_zero_pad": 7.377163418646217e-06, "add_observations_from_episodes_to_batch": 3.120927769242885e-06, "numpy_to_tensor": 1.4340426170860845e-05, "batch_individual_items": 1.3121450799919658e-05}}, "connector_pipeline_timer": 6.423738064210067e-05}, "module_episode_returns_mean": {"default_policy": -0.25}, "module_to_env_connector": {"timers": {"connectors": {"normalize_and_clip_actions": 8.439322404464374e-06, "remove_single_ts_time_rank_from_batch": 1.3037368606076574e-05, "tensor_to_numpy": 1.6810500161554754e-05, "listify_data_for_vector_env": 1.1195765271005584e-05, "un_batch_to_individual_items": 7.340053299053146e-06, "get_actions": 4.441808901033321e-05}}, "connector_pipeline_timer": 0.0001302671294820994}, "episode_duration_sec_mean": 0.005533235437469557, "weights_seq_no": 13.0, "env_to_module_sum_episodes_length_out": 10.368238394574323, "agent_episode_returns_mean": {"default_agent": -0.25}, "episode_return_mean": -0.25, "env_to_module_sum_episodes_length_in": 10.368238394574323, "num_episodes_lifetime": 260, "num_agent_steps_sampled_lifetime": {"default_agent": 5200}, "num_episodes": 20, "episode_len_mean": 20.0, "num_agent_steps_sampled": {"default_agent": 400}, "num_module_steps_sampled_lifetime": {"default_policy": 5200}, "env_reset_timer": 0.002218989509392661, "episode_return_min": -16.5, "num_env_steps_sampled": 400, "episode_len_min": 20, "episode_return_max": 12.5, "env_step_timer": 1.5648127347524768e-05, "num_env_steps_sampled_lifetime": 65400, "time_between_sampling": 10.85875247306471}, "num_healthy_workers": 1, "actor_manager_num_outstanding_async_reqs": 0, "num_remote_worker_restarts": 0}, "num_env_steps_sampled_lifetime": -6782500.0, "fault_tolerance": {"num_healthy_workers": 0, "num_remote_worker_restarts": 0}, "env_runner_group": {"actor_manager_num_outstanding_async_reqs": 0}, "done": false, "training_iteration": 13, "trial_id": "b154b_00000", "date": "2025-08-11_18-13-37", "timestamp": 1754928817, "time_this_iter_s": 10.610637187957764, "time_total_s": 131.77905416488647, "pid": 10455, "hostname": "Mac", "node_ip": "127.0.0.1", "config": {"exploration_config": {}, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 2, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "env": "Umbrella", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": false, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 0, "create_local_env_runner": true, "num_envs_per_env_runner": 1, "gym_env_vectorize_mode": "SYNC", "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "episodes_to_numpy": true, "max_requests_in_flight_per_env_runner": 1, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "merge_env_runner_states": "training_only", "broadcast_env_runner_states": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "complete_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "sampler_perf_stats_ema_coef": null, "_is_online": true, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": "auto", "num_aggregator_actors_per_learner": 0, "max_requests_in_flight_per_aggregator_actor": 3, "local_gpu_idx": 0, "max_requests_in_flight_per_learner": 3, "gamma": 1, "lr": 0.0002715581955, "grad_clip": 0.5, "grad_clip_by": "global_norm", "_train_batch_size_per_learner": 5000, "train_batch_size": 4000, "num_epochs": 1, "minibatch_size": 1000, "shuffle_batch_per_epoch": true, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "log_std_clip_param": 20.0, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "_disable_preprocessor_api": false, "_disable_action_flattening": false}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {"intrinsic_reward_coeff": 0.2795015916508}, "optimizer": {}, "_learner_class": "<class 'source.intrinsic_attention_ppo.learners.IntrinsicAttentionMetaLearner.IntrinsicAttentionMetaLearner'>", "callbacks_on_algorithm_init": null, "callbacks_on_env_runners_recreated": null, "callbacks_on_offline_eval_runners_recreated": null, "callbacks_on_checkpoint_loaded": null, "callbacks_on_environment_created": null, "callbacks_on_episode_created": null, "callbacks_on_episode_start": null, "callbacks_on_episode_step": null, "callbacks_on_episode_end": null, "callbacks_on_evaluate_start": null, "callbacks_on_evaluate_end": null, "callbacks_on_evaluate_offline_start": null, "callbacks_on_evaluate_offline_end": null, "callbacks_on_sample_end": null, "callbacks_on_train_result": null, "explore": true, "enable_rl_module_and_learner": true, "enable_env_runner_and_connector_v2": true, "_prior_exploration_config": {"type": "StochasticSampling"}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x1514e58a0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "offline_data_class": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_read_batch_size": null, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "materialize_data": false, "materialize_mapped_data": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "ignore_final_observation": false, "prelearner_class": null, "prelearner_buffer_class": null, "prelearner_buffer_kwargs": {}, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_remaining_data": false, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": 1, "evaluation_duration": 20, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_auto_duration_min_env_steps_per_sample": 100, "evaluation_auto_duration_max_env_steps_per_sample": 2000, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 1, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "offline_evaluation_interval": null, "num_offline_eval_runners": 0, "offline_loss_for_module_fn": null, "offline_evaluation_duration": 1, "offline_evaluation_parallel_to_training": false, "offline_evaluation_timeout_s": 120.0, "num_cpus_per_offline_eval_runner": 1, "num_gpus_per_offline_eval_runner": 0, "custom_resources_per_offline_eval_runner": {}, "restart_failed_offline_eval_runners": true, "ignore_offline_eval_runner_failures": false, "max_num_offline_eval_runner_restarts": 1000, "offline_eval_runner_restore_timeout_s": 1800.0, "max_requests_in_flight_per_offline_eval_runner": 1, "validate_offline_eval_runners_after_construction": true, "offline_eval_runner_health_probe_timeout_s": 30.0, "offline_eval_rl_module_inference_only": false, "broadcast_offline_eval_runner_states": false, "offline_eval_batch_size_per_runner": 256, "dataset_num_iters_per_eval_runner": 1, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "log_gradients": false, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 4, "restart_failed_env_runners": true, "ignore_env_runner_failures": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30.0, "env_runner_restore_timeout_s": 1800.0, "_model_config": {}, "_rl_module_spec": "MultiRLModuleSpec(multi_rl_module_class=<class 'ray.rllib.core.rl_module.multi_rl_module.MultiRLModule'>, observation_space=None, action_space=None, inference_only=False, model_config=None, rl_module_specs={'default_policy': RLModuleSpec(module_class=<class 'source.intrinsic_attention_ppo.rl_modules.DifferentiablePPOModule.DifferentiablePPOModule'>, observation_space=None, action_space=None, inference_only=False, learner_only=False, model_config={'vf_share_layers': True, 'embedding_dim': 62, 'max_seq_len': 11, 'policy_head_hidden_sizes': [32], 'value_head_hidden_sizes': [101], 'embedding_hidden_sizes': [121]}, catalog_class=None, load_state_path=None, model_config_dict=None), 'intrinsic_reward_module': RLModuleSpec(module_class=<class 'source.intrinsic_attention_ppo.rl_modules.IntrinsicAttentionModule.IntrinsicAttentionModule'>, observation_space=None, action_space=None, inference_only=False, learner_only=True, model_config={'intrinsic_reward_network': {'encoder_hidden_sizes': [], 'encoding_dim': 1, 'num_heads': 1, 'head_hidden_sizes': None, 'layers': [{'type': 'attention'}]}, 'extrinsic_value_hidden_layers': [127, 60], 'vf_share_layers': True, 'max_seq_len': 11}, catalog_class=None, load_state_path=None, model_config_dict=None)}, load_state_path=None, modules_to_load=None, module_specs={'default_policy': RLModuleSpec(module_class=<class 'source.intrinsic_attention_ppo.rl_modules.DifferentiablePPOModule.DifferentiablePPOModule'>, observation_space=None, action_space=None, inference_only=False, learner_only=False, model_config={'vf_share_layers': True, 'embedding_dim': 62, 'max_seq_len': 11, 'policy_head_hidden_sizes': [32], 'value_head_hidden_sizes': [101], 'embedding_hidden_sizes': [121]}, catalog_class=None, load_state_path=None, model_config_dict=None), 'intrinsic_reward_module': RLModuleSpec(module_class=<class 'source.intrinsic_attention_ppo.rl_modules.IntrinsicAttentionModule.IntrinsicAttentionModule'>, observation_space=None, action_space=None, inference_only=False, learner_only=True, model_config={'intrinsic_reward_network': {'encoder_hidden_sizes': [], 'encoding_dim': 1, 'num_heads': 1, 'head_hidden_sizes': None, 'layers': [{'type': 'attention'}]}, 'extrinsic_value_hidden_layers': [127, 60], 'vf_share_layers': True, 'max_seq_len': 11}, catalog_class=None, load_state_path=None, model_config_dict=None)})", "algorithm_config_overrides_per_module": {"intrinsic_reward_module": {"lr": 0.0002715581955}}, "_per_module_overrides": {}, "_validate_config": true, "_use_msgpack_checkpoints": false, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "env_task_fn": -1, "enable_connectors": -1, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.161583927863, "kl_target": 0.0201019014258, "vf_loss_coeff": 0.7790510010087, "entropy_coeff": 0.0015431216992, "clip_param": 0.2459212356676, "vf_clip_param": 0.3769744131561, "entropy_coeff_schedule": null, "lr_schedule": null, "sgd_minibatch_size": -1, "vf_share_layers": -1, "differentiable_learner_configs": ["DifferentiableLearnerConfig(learner_class=<class 'source.intrinsic_attention_ppo.learners.IntrinsicAttentionPPOLearner.IntrinsicAttentionPPOLearner'>, learner_connector=None, add_default_connectors_to_learner_pipeline=True, is_multi_agent=False, policies_to_update=['default_policy'], lr=0.0060984166342, num_total_minibatches=0, num_epochs=1, minibatch_size=1000, shuffle_batch_per_epoch=True)"], "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9485408017724, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.callbacks.callbacks.RLlibCallback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 131.77905416488647, "iterations_since_restore": 13, "perf": {"cpu_util_percent": 43.54666666666666, "ram_util_percent": 82.44}}
{"timers": {"training_iteration": 10.163270358840379, "restore_env_runners": 1.0561667317979808e-05, "training_step": 10.163068046806384, "env_runner_sampling_timer": 1.8179839743066812, "learner_update_timer": 8.164322044846443, "synch_weights": 0.0015111402769780254, "restore_eval_env_runners": 7.479759031488958e-05, "evaluation_iteration": 0.20848721192076516, "synch_eval_env_connectors": 0.00022277580456324386, "synch_env_connectors": 5.108008527885151e-06}, "env_runners": {"num_env_steps_sampled": 5000.0, "episode_return_max": 12.5, "env_to_module_connector": {"timers": {"connectors": {"add_time_dim_to_batch_and_zero_pad": 7.638255177222321e-06, "add_observations_from_episodes_to_batch": 3.069554431994712e-06, "batch_individual_items": 1.3481190449938979e-05, "numpy_to_tensor": 1.4168931348631213e-05, "add_states_from_episodes_to_batch": 2.8974247817490164e-06}}, "connector_pipeline_timer": 6.511590727176081e-05}, "episode_len_min": 20, "module_to_env_connector": {"timers": {"connectors": {"un_batch_to_individual_items": 7.0939205150013976e-06, "normalize_and_clip_actions": 8.850929997680963e-06, "remove_single_ts_time_rank_from_batch": 1.274601500915494e-05, "get_actions": 4.519259735659946e-05, "tensor_to_numpy": 1.6573289915473517e-05, "listify_data_for_vector_env": 1.162238535291894e-05}}, "connector_pipeline_timer": 0.00013090135488728915}, "env_step_timer": 1.550098518044436e-05, "num_agent_steps_sampled_lifetime": {"default_agent": -7400000.0}, "num_episodes": 250.0, "episode_duration_sec_mean": 0.006593142867553978, "episode_len_mean": 20.0, "module_episode_returns_mean": {"default_policy": 5.0600000000000005}, "weights_seq_no": 13.0, "env_to_module_sum_episodes_length_out": 10.36823839457432, "num_env_steps_sampled_lifetime": -7400000.0, "episode_len_max": 20, "rlmodule_inference_timer": 7.706883374773329e-05, "num_agent_steps_sampled": {"default_agent": 5000.0}, "env_reset_timer": 5.465026193993675e-05, "agent_episode_returns_mean": {"default_agent": 5.0600000000000005}, "env_to_module_sum_episodes_length_in": 10.36823839457432, "episode_return_mean": 5.0600000000000005, "time_between_sampling": 0.03521023123477654, "num_module_steps_sampled_lifetime": {"default_policy": -7400000.0}, "num_module_steps_sampled": {"default_policy": 5000.0}, "num_episodes_lifetime": -370000.0, "episode_return_min": -7.5, "sample": 0.006836771867218973, "num_env_steps_sampled_lifetime_throughput": 2942.056357608046}, "__all_modules__": {"learner_connector_sum_episodes_length_in": 5000.0, "learner_connector": {"connector_pipeline_timer": 0.13937418040408994, "timers": {"connectors": {"add_one_ts_to_episodes_and_truncate": 0.009508910699485333, "add_observations_from_episodes_to_batch": 0.0010292326290784952, "add_columns_from_episodes_to_train_batch": 0.04394741381291175, "add_time_dim_to_batch_and_zero_pad": 0.07660605265970402, "add_states_from_episodes_to_batch": 0.003627475909198539, "batch_individual_items": 0.00439387971676504, "numpy_to_tensor": 7.356598646140821e-05}}}, "learner_connector_sum_episodes_length_out": 5250.0}, "learners": {"__all_modules__": {"num_module_steps_trained_lifetime": 167580, "num_env_steps_trained": 33000, "num_env_steps_trained_lifetime": 462000, "num_non_trainable_parameters": 0, "num_trainable_parameters": 24861, "num_module_steps_trained": 11970, "num_env_steps_trained_lifetime_throughput": 3926.738374923747, "num_module_steps_trained_throughput": 22686425.44587868, "num_module_steps_trained_lifetime_throughput": 12586763.36516355}, "default_policy": {"curr_entropy_coeff": 0.0015431216992, "weights_seq_no": 14.0, "curr_kl_coeff": 9.862300430540927e-06, "policy_loss": -0.00015162743511609733, "module_train_batch_size_mean": 997.7135120670981, "num_trainable_parameters": 16595, "vf_loss": 0.3583122491836548, "mean_kl_loss": 5.505260560312308e-06, "diff_num_grad_updates_vs_sampler_policy": 1.0, "vf_explained_var": 0.0006690621376037598, "use_intrinsic_rewards": 0.0, "entropy": 0.6794955134391785, "num_module_steps_trained": 5985, "vf_loss_unclipped": 44.96921157836914, "total_loss": 0.27794337272644043, "num_module_steps_trained_lifetime": 83790, "num_module_steps_trained_lifetime_throughput": 711.9641021570857}, "differentiable_learners": {"intrinsic_attention_ppo_learner": {"__all_modules__": {"num_module_steps_trained_lifetime": 1005480, "num_env_steps_trained_lifetime": 2772000, "num_module_steps_trained": 71820, "num_env_steps_trained": 198000, "num_env_steps_trained_lifetime_throughput": 45105.17793843064}, "default_policy": {"weights_seq_no": 84.0, "policy_loss": -0.00014089306932874024, "module_train_batch_size_mean": 997.5006590853257, "vf_loss": 0.35831159353256226, "mean_kl_loss": 4.725492999568814e-06, "diff_num_grad_updates_vs_sampler_policy": 71.0, "vf_explained_var": 0.0030399560928344727, "use_intrinsic_rewards": 1.0, "entropy": 0.6795358061790466, "num_module_steps_trained": 35910, "vf_loss_unclipped": 45.002750396728516, "total_loss": 0.27795425057411194, "num_module_steps_trained_lifetime": 502740}, "intrinsic_reward_module": {"total_loss": 0.0, "num_module_steps_trained_lifetime": 502740, "module_train_batch_size_mean": 997.5006590853257, "weights_seq_no": 84.0, "num_module_steps_trained": 35910, "diff_num_grad_updates_vs_sampler_policy": 71.0}}}, "intrinsic_reward_module": {"diff_num_grad_updates_vs_sampler_policy": 1.0, "gradients_default_optimizer_global_norm": 0.0, "curr_entropy_coeff": 0.0015431216992, "weights_seq_no": 14.0, "default_optimizer_learning_rate": 0.0002715581955, "total_loss": 0.0, "num_module_steps_trained_lifetime": 83790, "module_train_batch_size_mean": 997.7135120670981, "num_trainable_parameters": 8266, "num_module_steps_trained": 5985, "num_module_steps_trained_lifetime_throughput": 711.9708156220449}, "IntrinsicAttentionMask": [[[0.09140268713235855, 0.09130378067493439, 0.09120497852563858, 0.09110628813505173, 0.09100770950317383, 0.09201604127883911, 0.0904323160648346, 0.09071259945631027, 0.09023671597242355, 0.09161841124296188, 0.08895847946405411], [0.09139485657215118, 0.09129752963781357, 0.0912003144621849, 0.091103196144104, 0.09100618958473206, 0.09199836105108261, 0.09043994545936584, 0.09071577340364456, 0.09024742990732193, 0.09160713106393814, 0.0889892578125], [0.09138702601194382, 0.09129128605127335, 0.09119565039873123, 0.09110011160373688, 0.09100466966629028, 0.09198068827390671, 0.0904475599527359, 0.09071895480155945, 0.0902581512928009, 0.0915958434343338, 0.08902004361152649], [0.09137920290231705, 0.09128504246473312, 0.09119097888469696, 0.09109701961278915, 0.09100314974784851, 0.0919630154967308, 0.09045518934726715, 0.09072212874889374, 0.09026887267827988, 0.09158456325531006, 0.08905084431171417], [0.09137137234210968, 0.0912787988781929, 0.09118631482124329, 0.09109392762184143, 0.09100162982940674, 0.0919453501701355, 0.0904628112912178, 0.09072530269622803, 0.09027959406375885, 0.09157328307628632, 0.08908165246248245], [0.091450996696949, 0.09134231507778168, 0.0912337601184845, 0.09112533181905746, 0.09101703763008118, 0.09212525933980942, 0.09038518369197845, 0.0906929150223732, 0.0901704803109169, 0.09168810397386551, 0.08876852691173553], [0.09132548421621323, 0.09124217182397842, 0.091158926486969, 0.09107576310634613, 0.09099267423152924, 0.09184186160564423, 0.09050744026899338, 0.09074386954307556, 0.09034237265586853, 0.09150716662406921, 0.08926230669021606], [0.09134788066148758, 0.09126004576683044, 0.09117229282855988, 0.09108463674783707, 0.09099705517292023, 0.09189234673976898, 0.09048566967248917, 0.0907348170876503, 0.09031174331903458, 0.0915394276380539, 0.08917412906885147], [0.0913098081946373, 0.091229647397995, 0.09114956110715866, 0.0910695418715477, 0.0909895971417427, 0.09180653840303421, 0.0905226618051529, 0.09075018018484116, 0.09036380052566528, 0.09148459136486053, 0.08932404220104218], [0.09141972661018372, 0.09131737798452377, 0.09121514111757278, 0.09111301600933075, 0.09101101011037827, 0.09205453842878342, 0.09041571617126465, 0.09070567786693573, 0.09021338075399399, 0.09164299070835114, 0.08889149129390717], [0.09120642393827438, 0.09114706516265869, 0.09108773618936539, 0.09102845191955566, 0.09096919745206833, 0.09157400578260422, 0.09062287956476212, 0.09079168736934662, 0.090504951775074, 0.09133582562208176, 0.08973176032304764]], [[0.09220048785209656, 0.09211818128824234, 0.09295924752950668, 0.09195379912853241, 0.0918717160820961, 0.09271053224802017, 0.09170777350664139, 0.09131074696779251, 0.08215151727199554, 0.09069402515888214, 0.09032200276851654], [0.09217626601457596, 0.09209557622671127, 0.09292013198137283, 0.09193439781665802, 0.09185392409563065, 0.0926763117313385, 0.09169317036867142, 0.09130385518074036, 0.08231309801340103, 0.09069904685020447, 0.09033416211605072], [0.09242133796215057, 0.09232423454523087, 0.09331730753183365, 0.09213032573461533, 0.09203352779150009, 0.09302347898483276, 0.0918402299284935, 0.09137237817049026, 0.0806819498538971, 0.09064634889364243, 0.09020880609750748], [0.09212777763605118, 0.09205029904842377, 0.09284187108278275, 0.09189554303884506, 0.09181825816631317, 0.09260783344507217, 0.0916638970375061, 0.09128998965024948, 0.08263712376356125, 0.09070900082588196, 0.0903584212064743], [0.09210348129272461, 0.09202761203050613, 0.09280270338058472, 0.0918760597705841, 0.09180037677288055, 0.09257355332374573, 0.09164919704198837, 0.09128300100564957, 0.08279956877231598, 0.09071391820907593, 0.09037048369646072], [0.09234939515590668, 0.09225713461637497, 0.09320042282342911, 0.09207289665937424, 0.09198090434074402, 0.09292137622833252, 0.09179721772670746, 0.09135252982378006, 0.08115968853235245, 0.09066223353147507, 0.09024609625339508], [0.0920548215508461, 0.0919821634888649, 0.09272433072328568, 0.09183701127767563, 0.09176453202962875, 0.09250494092702866, 0.09161972999572754, 0.09126893430948257, 0.08312532305717468, 0.0907236710190773, 0.09039454907178879], [0.0919361412525177, 0.09187126904726028, 0.092533640563488, 0.0917416661977768, 0.09167692810297012, 0.09233789891004562, 0.09154759347438812, 0.09123419225215912, 0.08392144739627838, 0.09074679762125015, 0.09045244753360748], [0.0888311043381691, 0.08894972503185272, 0.08774980902671814, 0.08918745070695877, 0.0893065482378006, 0.0881018191576004, 0.08954522013664246, 0.09012765437364578, 0.10554962605237961, 0.09104502201080322, 0.09160596132278442], [0.09174942970275879, 0.09169667959213257, 0.09223491698503494, 0.09159128367900848, 0.09153863042593002, 0.09207593649625778, 0.09143341332674026, 0.09117832779884338, 0.08517877757549286, 0.0907813012599945, 0.09054134041070938], [0.09163539111614227, 0.09158997237682343, 0.09205321967601776, 0.0914992168545723, 0.09145387262105942, 0.09191642701625824, 0.09136325120925903, 0.09114348888397217, 0.0859496220946312, 0.09080126136541367, 0.0905943289399147]], [[0.09180949628353119, 0.090229332447052, 0.09161091595888138, 0.09003416448831558, 0.09141276031732559, 0.09093321114778519, 0.09083481132984161, 0.09111633896827698, 0.09063833951950073, 0.09202618896961212, 0.08935441076755524], [0.0915793925523758, 0.09040302783250809, 0.09143184870481491, 0.09025737643241882, 0.09128453582525253, 0.09092768281698227, 0.09085440635681152, 0.09106400609016418, 0.09070802479982376, 0.09174031019210815, 0.08974943310022354], [0.09178078919649124, 0.09025099873542786, 0.0915885865688324, 0.09006199240684509, 0.09139678627252579, 0.09093254059553146, 0.0908372774720192, 0.09110983461141586, 0.09064705669879913, 0.09199050813913345, 0.08940360695123672], [0.09155069291591644, 0.09042467176914215, 0.09140948951244354, 0.09028520435094833, 0.09126850962638855, 0.09092695266008377, 0.09085680544376373, 0.09105744957923889, 0.09071667492389679, 0.09170467406511307, 0.08979877829551697], [0.0917520821094513, 0.09027266502380371, 0.09156624972820282, 0.0900898277759552, 0.09138079732656479, 0.09093187004327774, 0.09083973616361618, 0.09110332280397415, 0.09065575152635574, 0.09195483475923538, 0.0894528180360794], [0.09168236702680588, 0.09032528847455978, 0.09151200205087662, 0.09015744924545288, 0.09134195744991302, 0.09093020856380463, 0.09084568172693253, 0.0910874754190445, 0.09067687392234802, 0.09186820685863495, 0.08957245945930481], [0.0916680246591568, 0.09033612161874771, 0.09150083363056183, 0.09017137438058853, 0.09133396297693253, 0.09092985838651657, 0.09084690362215042, 0.09108421951532364, 0.09068122506141663, 0.0918503850698471, 0.08959709852933884], [0.09170903265476227, 0.09030516445636749, 0.09153275936841965, 0.09013158082962036, 0.09135682135820389, 0.09093084931373596, 0.09084341675043106, 0.09109354764223099, 0.09066880494356155, 0.09190133959054947, 0.0895266905426979], [0.09163932502269745, 0.09035778790712357, 0.09147850424051285, 0.09019920974969864, 0.09131796658039093, 0.09092916548252106, 0.09084933996200562, 0.09107768535614014, 0.09068990498781204, 0.09181474149227142, 0.08964639902114868], [0.09184075891971588, 0.09020574390888214, 0.09163523465394974, 0.09000387042760849, 0.0914301648736, 0.09093393385410309, 0.09083212912082672, 0.09112342447042465, 0.09062885493040085, 0.09206505119800568, 0.08930088579654694], [0.09145031124353409, 0.09050047397613525, 0.09133130311965942, 0.09038270264863968, 0.0912124514579773, 0.09092438220977783, 0.09086520224809647, 0.09103446453809738, 0.09074696153402328, 0.09158005565404892, 0.08997170627117157]], [[0.0924263596534729, 0.09111220389604568, 0.09318698942661285, 0.09094961732625961, 0.09209679067134857, 0.0929376631975174, 0.09070627391338348, 0.09277182072401047, 0.08235277980566025, 0.0909162163734436, 0.09054328501224518], [0.09196408092975616, 0.09105923026800156, 0.09248597919940948, 0.09094700962305069, 0.0917375311255455, 0.09231505542993546, 0.09077892452478409, 0.09220127761363983, 0.08492071181535721, 0.09092395007610321, 0.090666264295578], [0.09268802404403687, 0.09113863855600357, 0.09358657896518707, 0.090947225689888, 0.09229908883571625, 0.09329190105199814, 0.09066084772348404, 0.09309595823287964, 0.08091474324464798, 0.09090791642665863, 0.0904691070318222], [0.09190597385168076, 0.09105201810598373, 0.09239830076694489, 0.09094607084989548, 0.09169220924377441, 0.09223707765340805, 0.0907873809337616, 0.09212975203990936, 0.08524598181247711, 0.09092430025339127, 0.09068100154399872], [0.09231165796518326, 0.0910997986793518, 0.09301245957612991, 0.09094977378845215, 0.09200786054134369, 0.09278279542922974, 0.09072519838809967, 0.09262999892234802, 0.08298670500516891, 0.09091895818710327, 0.09057474881410599], [0.09260272234678268, 0.09113030880689621, 0.09345608949661255, 0.09094831347465515, 0.09223322570323944, 0.09317627549171448, 0.09067600220441818, 0.0929901972413063, 0.08138231188058853, 0.09091094136238098, 0.09049365669488907], [0.09181860834360123, 0.09104093164205551, 0.09226666390895844, 0.09094440191984177, 0.09162399917840958, 0.092119961977005, 0.09079980105161667, 0.09202228486537933, 0.08573596924543381, 0.09092456847429276, 0.0907028540968895], [0.09254574030637741, 0.09112458676099777, 0.0933690294623375, 0.09094887971878052, 0.09218917787075043, 0.09309910237789154, 0.09068594872951508, 0.09291958808898926, 0.08169537782669067, 0.09091278910636902, 0.09050986915826797], [0.08850938826799393, 0.09042385965585709, 0.08743201196193695, 0.09066551178693771, 0.08898311853408813, 0.08778273314237595, 0.09102921932935715, 0.08801733702421188, 0.10516740381717682, 0.09071528911590576, 0.0912742018699646], [0.0918940007686615, 0.09105051308870316, 0.09238025546073914, 0.09094585478305817, 0.09168287366628647, 0.09222102165222168, 0.09078909456729889, 0.09211502224206924, 0.08531299233436584, 0.09092434495687485, 0.09068401157855988], [0.0917598307132721, 0.09103331714868546, 0.09217822551727295, 0.0909431055188179, 0.09157805889844894, 0.0920412465929985, 0.0908079668879509, 0.09195004403591156, 0.086066335439682, 0.09092456847429276, 0.09071735292673111]], [[0.08856935054063797, 0.09058140218257904, 0.09163441509008408, 0.09043233841657639, 0.09148362278938293, 0.09111836552619934, 0.0921776220202446, 0.09125789999961853, 0.09089354425668716, 0.09081872552633286, 0.0910327360033989], [0.08725674450397491, 0.09039102494716644, 0.09204733371734619, 0.09015744924545288, 0.09180948138237, 0.09123425930738449, 0.09290602058172226, 0.09145385026931763, 0.0908808559179306, 0.09076335281133652, 0.09109959751367569], [0.08658795058727264, 0.09029217064380646, 0.09225945174694061, 0.09001528471708298, 0.09197652339935303, 0.09129288792610168, 0.09328196197748184, 0.09155377745628357, 0.09087327122688293, 0.09073382616043091, 0.09113295376300812], [0.08735240995883942, 0.09040506184101105, 0.09201709181070328, 0.09017767012119293, 0.09178564697504044, 0.09122585505247116, 0.09285251796245575, 0.09143956750631332, 0.09088188409805298, 0.0907675102353096, 0.09109479188919067], [0.08668297529220581, 0.09030628949403763, 0.09222923219203949, 0.0900355651974678, 0.09195274114608765, 0.09128456562757492, 0.09322834014892578, 0.09153956919908524, 0.09087438881397247, 0.09073807299137115, 0.09112824499607086], [0.08691418170928955, 0.09034053981304169, 0.0921558290719986, 0.09008480608463287, 0.09189494699239731, 0.09126432240009308, 0.09309816360473633, 0.0915050208568573, 0.09087706357240677, 0.09074833989143372, 0.09111674129962921], [0.08624766021966934, 0.09024138003587723, 0.09236781299114227, 0.08994238823652267, 0.09206177294254303, 0.09132259339094162, 0.09347449988126755, 0.09160462021827698, 0.09086910635232925, 0.09071844816207886, 0.09114973247051239], [0.08682569116353989, 0.09032745659351349, 0.092183917760849, 0.09006599336862564, 0.09191707521677017, 0.09127208590507507, 0.09314795583486557, 0.09151825308799744, 0.09087606519460678, 0.09074443578720093, 0.09112115949392319], [0.0870572179555893, 0.09036165475845337, 0.09211048483848572, 0.09011518210172653, 0.09185923635959625, 0.09125177562236786, 0.0930178239941597, 0.09148364514112473, 0.09087866544723511, 0.09075463563203812, 0.09110959619283676], [0.08710496127605438, 0.09036871045827866, 0.09209538251161575, 0.09012531489133835, 0.09184734523296356, 0.09124759584665298, 0.09299106895923615, 0.09147652983665466, 0.09087920933961868, 0.09075674414634705, 0.09110721945762634], [0.08696860074996948, 0.09034859389066696, 0.09213858097791672, 0.0900963768362999, 0.09188137203454971, 0.09125956147909164, 0.09306759387254715, 0.09149689972400665, 0.09087768197059631, 0.09075075387954712, 0.09111403673887253]], [[0.09112241119146347, 0.09099670499563217, 0.0903884544968605, 0.08888161927461624, 0.08875900506973267, 0.09001487493515015, 0.0885142832994461, 0.08976668864488602, 0.10597261041402817, 0.09069430828094482, 0.08488905429840088], [0.09112140536308289, 0.09099726378917694, 0.09039657562971115, 0.08890827000141144, 0.08878715336322784, 0.09002762287855148, 0.08854539692401886, 0.08978249877691269, 0.10577184706926346, 0.09069863706827164, 0.08496324717998505], [0.09111591428518295, 0.09099940955638885, 0.09043549001216888, 0.08903730660676956, 0.08892345428466797, 0.09008900821208954, 0.08869618922472, 0.0898587703704834, 0.10480121523141861, 0.09071908891201019, 0.08532411605119705], [0.09109768271446228, 0.09100029617547989, 0.09052865207195282, 0.0893571525812149, 0.08926162123680115, 0.09023862332105637, 0.0890708789229393, 0.09004578739404678, 0.10240218788385391, 0.09076590090990067, 0.08623115718364716], [0.09109590202569962, 0.09100008755922318, 0.09053602069616318, 0.08938319236040115, 0.08928918093442917, 0.0902506411075592, 0.08910144865512848, 0.09006088972091675, 0.10220732539892197, 0.09076946973800659, 0.08630580455064774], [0.09111201763153076, 0.09100022166967392, 0.09045901894569397, 0.08911657333374023, 0.08900722861289978, 0.09012643992900848, 0.08878893405199051, 0.08990538865327835, 0.10420571267604828, 0.09073120355606079, 0.08554723858833313], [0.09109222143888474, 0.0909995511174202, 0.09055066108703613, 0.08943517506122589, 0.08934418857097626, 0.09027456492185593, 0.08916249126195908, 0.09009097516536713, 0.10181857645511627, 0.0907764807343483, 0.08645517379045486], [0.09110919386148453, 0.09100054204463959, 0.09047449380159378, 0.08916924148797989, 0.08906289935112, 0.09015117585659027, 0.08885059505701065, 0.089936263859272, 0.10381034016609192, 0.09073907136917114, 0.08569610863924026], [0.0909552201628685, 0.09065867215394974, 0.08923166990280151, 0.08575271815061569, 0.08547312766313553, 0.0883617177605629, 0.08491668850183487, 0.087786465883255, 0.1299978345632553, 0.08994759619235992, 0.07691832631826401], [0.09111882001161575, 0.09099846333265305, 0.09041601419448853, 0.08897242695093155, 0.08885490894317627, 0.09005822241306305, 0.08862034231424332, 0.08982047438621521, 0.10528913885354996, 0.09070891886949539, 0.08514229208230972], [0.09101594984531403, 0.09097083657979965, 0.0907520204782486, 0.0902058482170105, 0.09016113728284836, 0.09061716496944427, 0.09007180482149124, 0.09052736312150955, 0.09608633816242218, 0.09086216241121292, 0.0887293666601181]]]}, "num_training_step_calls_per_iteration": 1, "evaluation": {"env_runners": {"episode_len_max": 20, "rlmodule_inference_timer": 3.138616803859971e-05, "num_module_steps_sampled": {"default_policy": 400}, "sample": 0.16854082751394303, "env_to_module_connector": {"timers": {"connectors": {"add_states_from_episodes_to_batch": 2.7883547897874836e-06, "add_time_dim_to_batch_and_zero_pad": 6.787596386347772e-06, "add_observations_from_episodes_to_batch": 2.832782437167117e-06, "numpy_to_tensor": 1.2156618678690398e-05, "batch_individual_items": 1.2081627588102948e-05}}, "connector_pipeline_timer": 5.866122948444036e-05}, "module_episode_returns_mean": {"default_policy": -1.65}, "module_to_env_connector": {"timers": {"connectors": {"normalize_and_clip_actions": 7.857634762764942e-06, "remove_single_ts_time_rank_from_batch": 1.1784506870860936e-05, "tensor_to_numpy": 1.513941651678023e-05, "listify_data_for_vector_env": 1.0224570450478622e-05, "un_batch_to_individual_items": 6.443133538047462e-06, "get_actions": 3.778551611727551e-05}}, "connector_pipeline_timer": 0.00011582504654061209}, "episode_duration_sec_mean": 0.005525918746134267, "weights_seq_no": 14.0, "env_to_module_sum_episodes_length_out": 10.368238394574323, "agent_episode_returns_mean": {"default_agent": -1.65}, "episode_return_mean": -1.65, "env_to_module_sum_episodes_length_in": 10.368238394574323, "num_episodes_lifetime": 280, "num_agent_steps_sampled_lifetime": {"default_agent": 5600}, "num_episodes": 20, "episode_len_mean": 20.0, "num_agent_steps_sampled": {"default_agent": 400}, "num_module_steps_sampled_lifetime": {"default_policy": 5600}, "env_reset_timer": 0.002200124614005554, "episode_return_min": -16.5, "num_env_steps_sampled": 400, "episode_len_min": 20, "episode_return_max": 12.5, "env_step_timer": 1.4003704200391631e-05, "num_env_steps_sampled_lifetime": 70400, "time_between_sampling": 10.847177110423877}, "num_healthy_workers": 1, "actor_manager_num_outstanding_async_reqs": 0, "num_remote_worker_restarts": 0}, "num_env_steps_sampled_lifetime": -7400000.0, "fault_tolerance": {"num_healthy_workers": 0, "num_remote_worker_restarts": 0}, "env_runner_group": {"actor_manager_num_outstanding_async_reqs": 0}, "done": false, "training_iteration": 14, "trial_id": "b154b_00000", "date": "2025-08-11_18-13-46", "timestamp": 1754928826, "time_this_iter_s": 9.792924880981445, "time_total_s": 141.57197904586792, "pid": 10455, "hostname": "Mac", "node_ip": "127.0.0.1", "config": {"exploration_config": {}, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 2, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "env": "Umbrella", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": false, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 0, "create_local_env_runner": true, "num_envs_per_env_runner": 1, "gym_env_vectorize_mode": "SYNC", "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "episodes_to_numpy": true, "max_requests_in_flight_per_env_runner": 1, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "merge_env_runner_states": "training_only", "broadcast_env_runner_states": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "complete_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "sampler_perf_stats_ema_coef": null, "_is_online": true, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": "auto", "num_aggregator_actors_per_learner": 0, "max_requests_in_flight_per_aggregator_actor": 3, "local_gpu_idx": 0, "max_requests_in_flight_per_learner": 3, "gamma": 1, "lr": 0.0002715581955, "grad_clip": 0.5, "grad_clip_by": "global_norm", "_train_batch_size_per_learner": 5000, "train_batch_size": 4000, "num_epochs": 1, "minibatch_size": 1000, "shuffle_batch_per_epoch": true, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "log_std_clip_param": 20.0, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "_disable_preprocessor_api": false, "_disable_action_flattening": false}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {"intrinsic_reward_coeff": 0.2795015916508}, "optimizer": {}, "_learner_class": "<class 'source.intrinsic_attention_ppo.learners.IntrinsicAttentionMetaLearner.IntrinsicAttentionMetaLearner'>", "callbacks_on_algorithm_init": null, "callbacks_on_env_runners_recreated": null, "callbacks_on_offline_eval_runners_recreated": null, "callbacks_on_checkpoint_loaded": null, "callbacks_on_environment_created": null, "callbacks_on_episode_created": null, "callbacks_on_episode_start": null, "callbacks_on_episode_step": null, "callbacks_on_episode_end": null, "callbacks_on_evaluate_start": null, "callbacks_on_evaluate_end": null, "callbacks_on_evaluate_offline_start": null, "callbacks_on_evaluate_offline_end": null, "callbacks_on_sample_end": null, "callbacks_on_train_result": null, "explore": true, "enable_rl_module_and_learner": true, "enable_env_runner_and_connector_v2": true, "_prior_exploration_config": {"type": "StochasticSampling"}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x1514e58a0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "offline_data_class": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_read_batch_size": null, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "materialize_data": false, "materialize_mapped_data": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "ignore_final_observation": false, "prelearner_class": null, "prelearner_buffer_class": null, "prelearner_buffer_kwargs": {}, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_remaining_data": false, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": 1, "evaluation_duration": 20, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_auto_duration_min_env_steps_per_sample": 100, "evaluation_auto_duration_max_env_steps_per_sample": 2000, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 1, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "offline_evaluation_interval": null, "num_offline_eval_runners": 0, "offline_loss_for_module_fn": null, "offline_evaluation_duration": 1, "offline_evaluation_parallel_to_training": false, "offline_evaluation_timeout_s": 120.0, "num_cpus_per_offline_eval_runner": 1, "num_gpus_per_offline_eval_runner": 0, "custom_resources_per_offline_eval_runner": {}, "restart_failed_offline_eval_runners": true, "ignore_offline_eval_runner_failures": false, "max_num_offline_eval_runner_restarts": 1000, "offline_eval_runner_restore_timeout_s": 1800.0, "max_requests_in_flight_per_offline_eval_runner": 1, "validate_offline_eval_runners_after_construction": true, "offline_eval_runner_health_probe_timeout_s": 30.0, "offline_eval_rl_module_inference_only": false, "broadcast_offline_eval_runner_states": false, "offline_eval_batch_size_per_runner": 256, "dataset_num_iters_per_eval_runner": 1, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "log_gradients": false, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 4, "restart_failed_env_runners": true, "ignore_env_runner_failures": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30.0, "env_runner_restore_timeout_s": 1800.0, "_model_config": {}, "_rl_module_spec": "MultiRLModuleSpec(multi_rl_module_class=<class 'ray.rllib.core.rl_module.multi_rl_module.MultiRLModule'>, observation_space=None, action_space=None, inference_only=False, model_config=None, rl_module_specs={'default_policy': RLModuleSpec(module_class=<class 'source.intrinsic_attention_ppo.rl_modules.DifferentiablePPOModule.DifferentiablePPOModule'>, observation_space=None, action_space=None, inference_only=False, learner_only=False, model_config={'vf_share_layers': True, 'embedding_dim': 62, 'max_seq_len': 11, 'policy_head_hidden_sizes': [32], 'value_head_hidden_sizes': [101], 'embedding_hidden_sizes': [121]}, catalog_class=None, load_state_path=None, model_config_dict=None), 'intrinsic_reward_module': RLModuleSpec(module_class=<class 'source.intrinsic_attention_ppo.rl_modules.IntrinsicAttentionModule.IntrinsicAttentionModule'>, observation_space=None, action_space=None, inference_only=False, learner_only=True, model_config={'intrinsic_reward_network': {'encoder_hidden_sizes': [], 'encoding_dim': 1, 'num_heads': 1, 'head_hidden_sizes': None, 'layers': [{'type': 'attention'}]}, 'extrinsic_value_hidden_layers': [127, 60], 'vf_share_layers': True, 'max_seq_len': 11}, catalog_class=None, load_state_path=None, model_config_dict=None)}, load_state_path=None, modules_to_load=None, module_specs={'default_policy': RLModuleSpec(module_class=<class 'source.intrinsic_attention_ppo.rl_modules.DifferentiablePPOModule.DifferentiablePPOModule'>, observation_space=None, action_space=None, inference_only=False, learner_only=False, model_config={'vf_share_layers': True, 'embedding_dim': 62, 'max_seq_len': 11, 'policy_head_hidden_sizes': [32], 'value_head_hidden_sizes': [101], 'embedding_hidden_sizes': [121]}, catalog_class=None, load_state_path=None, model_config_dict=None), 'intrinsic_reward_module': RLModuleSpec(module_class=<class 'source.intrinsic_attention_ppo.rl_modules.IntrinsicAttentionModule.IntrinsicAttentionModule'>, observation_space=None, action_space=None, inference_only=False, learner_only=True, model_config={'intrinsic_reward_network': {'encoder_hidden_sizes': [], 'encoding_dim': 1, 'num_heads': 1, 'head_hidden_sizes': None, 'layers': [{'type': 'attention'}]}, 'extrinsic_value_hidden_layers': [127, 60], 'vf_share_layers': True, 'max_seq_len': 11}, catalog_class=None, load_state_path=None, model_config_dict=None)})", "algorithm_config_overrides_per_module": {"intrinsic_reward_module": {"lr": 0.0002715581955}}, "_per_module_overrides": {}, "_validate_config": true, "_use_msgpack_checkpoints": false, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "env_task_fn": -1, "enable_connectors": -1, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.161583927863, "kl_target": 0.0201019014258, "vf_loss_coeff": 0.7790510010087, "entropy_coeff": 0.0015431216992, "clip_param": 0.2459212356676, "vf_clip_param": 0.3769744131561, "entropy_coeff_schedule": null, "lr_schedule": null, "sgd_minibatch_size": -1, "vf_share_layers": -1, "differentiable_learner_configs": ["DifferentiableLearnerConfig(learner_class=<class 'source.intrinsic_attention_ppo.learners.IntrinsicAttentionPPOLearner.IntrinsicAttentionPPOLearner'>, learner_connector=None, add_default_connectors_to_learner_pipeline=True, is_multi_agent=False, policies_to_update=['default_policy'], lr=0.0060984166342, num_total_minibatches=0, num_epochs=1, minibatch_size=1000, shuffle_batch_per_epoch=True)"], "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9485408017724, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.callbacks.callbacks.RLlibCallback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 141.57197904586792, "iterations_since_restore": 14, "perf": {"cpu_util_percent": 43.614285714285714, "ram_util_percent": 82.99285714285715}}
{"timers": {"training_iteration": 10.161262495671249, "restore_env_runners": 1.0515630842357815e-05, "training_step": 10.161059983427508, "env_runner_sampling_timer": 1.817346819143581, "learner_update_timer": 8.160467621898523, "synch_weights": 0.0015086547142351304, "restore_eval_env_runners": 7.444628448687412e-05, "evaluation_iteration": 0.20765119355185158, "synch_eval_env_connectors": 0.00022218096581982162, "synch_env_connectors": 5.098177883589238e-06}, "env_runners": {"num_env_steps_sampled": 5000.0, "episode_return_max": 12.5, "env_to_module_connector": {"timers": {"connectors": {"add_time_dim_to_batch_and_zero_pad": 7.603275528720837e-06, "add_observations_from_episodes_to_batch": 3.027309323897044e-06, "batch_individual_items": 1.339026262788588e-05, "numpy_to_tensor": 1.3777343677878964e-05, "add_states_from_episodes_to_batch": 2.940885635502007e-06}}, "connector_pipeline_timer": 6.48751036133953e-05}, "episode_len_min": 20, "module_to_env_connector": {"timers": {"connectors": {"un_batch_to_individual_items": 7.340573219823215e-06, "normalize_and_clip_actions": 8.608409840232523e-06, "remove_single_ts_time_rank_from_batch": 1.2729005392144913e-05, "get_actions": 4.4012709943147766e-05, "tensor_to_numpy": 1.6358724712287148e-05, "listify_data_for_vector_env": 1.1405643038017753e-05}}, "connector_pipeline_timer": 0.00012943677627849363}, "env_step_timer": 1.5533849353291097e-05, "num_agent_steps_sampled_lifetime": {"default_agent": -8017500.0}, "num_episodes": 250.0, "episode_duration_sec_mean": 0.0060308785648085185, "episode_len_mean": 20.0, "module_episode_returns_mean": {"default_policy": 4.579999999999998}, "weights_seq_no": 14.0, "env_to_module_sum_episodes_length_out": 10.36823839457432, "num_env_steps_sampled_lifetime": -8017500.0, "episode_len_max": 20, "rlmodule_inference_timer": 3.463007722302656e-05, "num_agent_steps_sampled": {"default_agent": 5000.0}, "env_reset_timer": 4.6268613492948735e-05, "agent_episode_returns_mean": {"default_agent": 4.579999999999998}, "env_to_module_sum_episodes_length_in": 10.36823839457432, "episode_return_mean": 4.579999999999998, "time_between_sampling": 0.03243455024781159, "num_module_steps_sampled_lifetime": {"default_policy": -8017500.0}, "num_module_steps_sampled": {"default_policy": 5000.0}, "num_episodes_lifetime": -400875.0, "episode_return_min": -7.5, "sample": 0.006421317231759113, "num_env_steps_sampled_lifetime_throughput": 3125.1299820453946}, "__all_modules__": {"learner_connector_sum_episodes_length_in": 5000.0, "learner_connector": {"connector_pipeline_timer": 0.14084583527058053, "timers": {"connectors": {"add_one_ts_to_episodes_and_truncate": 0.00990682076316449, "add_observations_from_episodes_to_batch": 0.0010310753032214829, "add_columns_from_episodes_to_train_batch": 0.044495048425051455, "add_time_dim_to_batch_and_zero_pad": 0.07710027797277824, "add_states_from_episodes_to_batch": 0.0036578773993684996, "batch_individual_items": 0.004392655510269793, "numpy_to_tensor": 7.37786562857753e-05}}}, "learner_connector_sum_episodes_length_out": 5250.0}, "learners": {"__all_modules__": {"num_module_steps_trained_lifetime": 179550, "num_env_steps_trained": 33000, "num_env_steps_trained_lifetime": 495000, "num_non_trainable_parameters": 0, "num_trainable_parameters": 24861, "num_module_steps_trained": 11970, "num_env_steps_trained_lifetime_throughput": 3926.7306833671596, "num_module_steps_trained_throughput": 22126996.652171046, "num_module_steps_trained_lifetime_throughput": 12553335.696400521}, "default_policy": {"curr_entropy_coeff": 0.0015431216992, "weights_seq_no": 15.0, "curr_kl_coeff": 4.931150215270463e-06, "policy_loss": -0.0004527272249106318, "module_train_batch_size_mean": 997.7008703380301, "num_trainable_parameters": 16595, "vf_loss": 0.35830897092819214, "mean_kl_loss": 2.0954013962182216e-05, "diff_num_grad_updates_vs_sampler_policy": 1.0, "vf_explained_var": 0.00029206275939941406, "use_intrinsic_rewards": 0.0, "entropy": 0.6784131526947021, "num_module_steps_trained": 5985, "vf_loss_unclipped": 44.967185974121094, "total_loss": 0.2776414155960083, "num_module_steps_trained_lifetime": 89775, "num_module_steps_trained_lifetime_throughput": 711.9707158293231}, "differentiable_learners": {"intrinsic_attention_ppo_learner": {"__all_modules__": {"num_module_steps_trained_lifetime": 1077300, "num_env_steps_trained_lifetime": 2970000, "num_module_steps_trained": 71820, "num_env_steps_trained": 198000, "num_env_steps_trained_lifetime_throughput": 44474.70855070255}, "default_policy": {"weights_seq_no": 90.0, "policy_loss": -0.0004243722651153803, "module_train_batch_size_mean": 997.4996962148737, "vf_loss": 0.35831162333488464, "mean_kl_loss": 1.8387872842140496e-05, "diff_num_grad_updates_vs_sampler_policy": 76.0, "vf_explained_var": 0.003063678741455078, "use_intrinsic_rewards": 1.0, "entropy": 0.6784830093383789, "num_module_steps_trained": 35910, "vf_loss_unclipped": 45.008888244628906, "total_loss": 0.27767467498779297, "num_module_steps_trained_lifetime": 538650}, "intrinsic_reward_module": {"total_loss": 0.0, "num_module_steps_trained_lifetime": 538650, "module_train_batch_size_mean": 997.4996962148737, "weights_seq_no": 90.0, "num_module_steps_trained": 35910, "diff_num_grad_updates_vs_sampler_policy": 76.0}}}, "intrinsic_reward_module": {"diff_num_grad_updates_vs_sampler_policy": 1.0, "gradients_default_optimizer_global_norm": 0.0, "curr_entropy_coeff": 0.0015431216992, "weights_seq_no": 15.0, "default_optimizer_learning_rate": 0.0002715581955, "total_loss": 0.0, "num_module_steps_trained_lifetime": 89775, "module_train_batch_size_mean": 997.7008703380301, "num_trainable_parameters": 8266, "num_module_steps_trained": 5985, "num_module_steps_trained_lifetime_throughput": 711.9769895458272}, "IntrinsicAttentionMask": [[[0.09194505959749222, 0.0903625637292862, 0.09026478230953217, 0.0901671051979065, 0.09154774248600006, 0.09106748551130295, 0.09246189892292023, 0.09125087410211563, 0.09077217429876328, 0.09067395329475403, 0.08948635309934616], [0.091680146753788, 0.09050248563289642, 0.09042955189943314, 0.09035667032003403, 0.09138496220111847, 0.09102771431207657, 0.09206364303827286, 0.09116419404745102, 0.09080781042575836, 0.09073463082313538, 0.08984816819429398], [0.09166364371776581, 0.09051120281219482, 0.0904398262500763, 0.09036849439144135, 0.09137480705976486, 0.0910252258181572, 0.09203885495662689, 0.09115878492593765, 0.09081003069877625, 0.09073840826749802, 0.08987077325582504], [0.09164712578058243, 0.09051991999149323, 0.09045008569955826, 0.09038031101226807, 0.09136464446783066, 0.09102272242307663, 0.09201405942440033, 0.0911533534526825, 0.09081222862005234, 0.09074217081069946, 0.08989336341619492], [0.09187895059585571, 0.09039748460054398, 0.09030589461326599, 0.09021440148353577, 0.09150715172290802, 0.09105760604143143, 0.09236244112253189, 0.09122929722070694, 0.09078110754489899, 0.09068913012742996, 0.08957650512456894], [0.09179868549108505, 0.09043988585472107, 0.09035582095384598, 0.09027183800935745, 0.09145784378051758, 0.0910455733537674, 0.09224174916744232, 0.09120304137468338, 0.09079192578792572, 0.09070752561092377, 0.08968610316514969], [0.09203065186738968, 0.09031732380390167, 0.09021154791116714, 0.09010588377714157, 0.09160025417804718, 0.09108021855354309, 0.09259074926376343, 0.09127878397703171, 0.09076056629419327, 0.09065426886081696, 0.08936973661184311], [0.09182938188314438, 0.09042367339134216, 0.09033672511577606, 0.09024986624717712, 0.09147670120000839, 0.0910501778125763, 0.09228789806365967, 0.09121308475732803, 0.09078779071569443, 0.09070049226284027, 0.0896441712975502], [0.09174913167953491, 0.09046605229377747, 0.09038663655519485, 0.09030729532241821, 0.09142738580703735, 0.09103812277317047, 0.09216727316379547, 0.09118681401014328, 0.09079857915639877, 0.09071886539459229, 0.08975381404161453], [0.09173261374235153, 0.09047477692365646, 0.09039690345525742, 0.09031911194324493, 0.09141722321510315, 0.0910356268286705, 0.09214245527982712, 0.09118139743804932, 0.09080078452825546, 0.09072263538837433, 0.08977638930082321], [0.09153158962726593, 0.09058090299367905, 0.09052194654941559, 0.09046302735805511, 0.09129351377487183, 0.09100519120693207, 0.09184066206216812, 0.09111537039279938, 0.09082761406898499, 0.0907684937119484, 0.09005166590213776]], [[0.09232456237077713, 0.09224215149879456, 0.09184281527996063, 0.09084943681955338, 0.09076834470033646, 0.09283529967069626, 0.09060636907815933, 0.09266963601112366, 0.08337407559156418, 0.09204373508691788, 0.09044355154037476], [0.09229771792888641, 0.09221691638231277, 0.09182538837194443, 0.09085126966238022, 0.09077173471450806, 0.09279842674732208, 0.09061287343502045, 0.09263602644205093, 0.08351406455039978, 0.09202238917350769, 0.09045319259166718], [0.09216704219579697, 0.0920940712094307, 0.09174036979675293, 0.09085977077484131, 0.09078783541917801, 0.09261911362409592, 0.09064412862062454, 0.09247250854969025, 0.08419714123010635, 0.09191835671663284, 0.090499646961689], [0.09183754771947861, 0.09178410470485687, 0.0915248915553093, 0.09087835997343063, 0.09082547575235367, 0.0921684056520462, 0.0907197892665863, 0.09206116199493408, 0.08593137562274933, 0.09165535867214203, 0.09061349183320999], [0.09181036800146103, 0.09175851941108704, 0.09150703996419907, 0.09087971597909927, 0.09082838892936707, 0.09213131666183472, 0.09072583168745041, 0.09202728420495987, 0.08607520163059235, 0.0916336178779602, 0.0906226709485054], [0.09248997271060944, 0.09239757061004639, 0.09194998443126678, 0.09083757549524307, 0.09074682742357254, 0.09306282550096512, 0.09056559950113297, 0.09287697076797485, 0.08251401036977768, 0.09217515587806702, 0.09038347750902176], [0.0917559564113617, 0.09170729666948318, 0.09147127717733383, 0.09088235348463058, 0.09083415567874908, 0.09205710887908936, 0.09073784202337265, 0.09195949882268906, 0.08636350929737091, 0.09159008413553238, 0.09064096957445145], [0.09243649989366531, 0.09234734624624252, 0.09191539138555527, 0.09084153175354004, 0.09075390547513962, 0.09298922121524811, 0.09057891368865967, 0.09280991554260254, 0.08279158920049667, 0.09213270246982574, 0.09040303528308868], [0.08913573622703552, 0.08923163264989853, 0.08969900757074356, 0.09088129550218582, 0.09097907692193985, 0.08854559808969498, 0.09117494523525238, 0.08873623609542847, 0.10078053176403046, 0.08946330100297928, 0.09137260913848877], [0.09223291277885437, 0.09215600043535233, 0.09178325533866882, 0.09085556119680405, 0.09077979624271393, 0.09270945936441422, 0.09062845259904861, 0.09255490452051163, 0.08385245501995087, 0.09197080880403519, 0.09047631919384003], [0.09170108288526535, 0.09165563434362411, 0.09143517166376114, 0.09088488668203354, 0.09083984047174454, 0.09198231995105743, 0.0907498300075531, 0.09189116954803467, 0.08665469288825989, 0.09154614806175232, 0.09065926820039749]], [[0.09153734147548676, 0.09143829345703125, 0.0913393497467041, 0.08976727724075317, 0.09114179015159607, 0.09066365659236908, 0.09205189347267151, 0.0908462405204773, 0.09185279160737991, 0.09027187526226044, 0.0890895426273346], [0.09152736514806747, 0.09142990410327911, 0.09133254736661911, 0.08978540450334549, 0.09113813936710358, 0.09066762030124664, 0.09203364700078964, 0.09084729850292206, 0.09183774888515472, 0.09028204530477524, 0.08911828696727753], [0.09151739627122879, 0.09142152220010757, 0.09132574498653412, 0.0898035392165184, 0.09113448858261108, 0.0906715914607048, 0.09201540797948837, 0.09084837138652802, 0.09182271361351013, 0.09029222279787064, 0.08914703875780106], [0.09135733544826508, 0.09128685295581818, 0.09121643006801605, 0.09009452164173126, 0.09107574820518494, 0.09073490649461746, 0.09172310680150986, 0.0908651202917099, 0.09158164262771606, 0.09045523405075073, 0.08960911631584167], [0.09149744361639023, 0.0914047434926033, 0.09131213277578354, 0.08983980864286423, 0.0911271944642067, 0.09067951142787933, 0.09197892993688583, 0.09085048735141754, 0.09179263561964035, 0.09031257033348083, 0.0892045646905899], [0.09144897013902664, 0.09136396646499634, 0.0912790447473526, 0.08992794156074524, 0.09110943228006363, 0.0906987339258194, 0.091890349984169, 0.09085559844970703, 0.0917196050286293, 0.09036197513341904, 0.08934443444013596], [0.09158895164728165, 0.09148167818784714, 0.09137453883886337, 0.08967342227697372, 0.0911606177687645, 0.09064307808876038, 0.0921463593840599, 0.09084068983793259, 0.09193064272403717, 0.0902191773056984, 0.0889408066868782], [0.09146750718355179, 0.0913795605301857, 0.09129169583320618, 0.08989422023296356, 0.09111621975898743, 0.09069138020277023, 0.09192422032356262, 0.09085364639759064, 0.09174752980470657, 0.09034307301044464, 0.08929090946912766], [0.09156902879476547, 0.09146492928266525, 0.09136095643043518, 0.08970968425273895, 0.09115336090326309, 0.09065104275941849, 0.09210987389087677, 0.0908428505063057, 0.09190057963132858, 0.09023954719305038, 0.08899825066328049], [0.09140904247760773, 0.09133037179708481, 0.09125176817178726, 0.09000052511692047, 0.09109476953744888, 0.09071451425552368, 0.09181743860244751, 0.09085977077484131, 0.09165946394205093, 0.09040263295173645, 0.08945971727371216], [0.09128738194704056, 0.09122797101736069, 0.09116858243942261, 0.09022167325019836, 0.09104994684457779, 0.09076239913702011, 0.09159563481807709, 0.09087227284908295, 0.0914764404296875, 0.09052632749080658, 0.08981141448020935]], [[0.09104732424020767, 0.0909896269440651, 0.09245546162128448, 0.09087435156106949, 0.0916864350438118, 0.0922798216342926, 0.09157028049230576, 0.0912887305021286, 0.08550138771533966, 0.09172066301107407, 0.09058600664138794], [0.09104403853416443, 0.0909879133105278, 0.09241354465484619, 0.0908757746219635, 0.09166568517684937, 0.0922427549958229, 0.09155271202325821, 0.09127885848283768, 0.08564455807209015, 0.09169897437095642, 0.09059525281190872], [0.09111891686916351, 0.09102317690849304, 0.09346802532672882, 0.09083200991153717, 0.09218216687440872, 0.09317371994256973, 0.09198856353759766, 0.09151995927095413, 0.08209970593452454, 0.09223923832178116, 0.09035450220108032], [0.09103737771511078, 0.09098439663648605, 0.09232968091964722, 0.09087853133678436, 0.09162411838769913, 0.09216857701539993, 0.09151750057935715, 0.09125903993844986, 0.08593153208494186, 0.09165552258491516, 0.09061366319656372], [0.09108181297779083, 0.09100678563117981, 0.09291750192642212, 0.09085692465305328, 0.09191393107175827, 0.09268806874752045, 0.09176257252693176, 0.09139592200517654, 0.08393558114767075, 0.09195853769779205, 0.09048227965831757], [0.09111087024211884, 0.09101984649896622, 0.09334281086921692, 0.09083807468414307, 0.0921214297413826, 0.0930633395910263, 0.09193746000528336, 0.09149209409952164, 0.0825144574046135, 0.09217566251754761, 0.09038396924734116], [0.09107580780982971, 0.09100391715765, 0.09283383935689926, 0.09086031466722488, 0.09187290817499161, 0.09261419624090195, 0.09172793477773666, 0.09137672930955887, 0.08421742916107178, 0.09191562235355377, 0.09050130099058151], [0.09106075018644333, 0.09099649637937546, 0.09263046830892563, 0.09086812287569046, 0.09177286177873611, 0.09243451803922653, 0.09164339303970337, 0.0913296639919281, 0.08490559458732605, 0.09181100875139236, 0.0905470922589302], [0.09058917313814163, 0.09068663418292999, 0.08826097846031189, 0.09088187664747238, 0.08952052146196365, 0.08854615688323975, 0.08971325308084488, 0.09018315374851227, 0.10078117996454239, 0.08946386724710464, 0.09137319028377533], [0.0910835862159729, 0.09100763499736786, 0.09294214099645615, 0.0908559113740921, 0.09192600846290588, 0.09270982444286346, 0.09177276492118835, 0.09140156954526901, 0.08385278284549713, 0.09197117388248444, 0.09047667682170868], [0.09102025628089905, 0.09097514301538467, 0.09211932867765427, 0.09088499844074249, 0.0915195494890213, 0.09198243916034698, 0.09142885357141495, 0.09120894223451614, 0.08665479719638824, 0.09154626727104187, 0.09065938740968704]], [[0.08846759796142578, 0.09160454571247101, 0.09152914583683014, 0.09032844752073288, 0.09137852489948273, 0.0921475738286972, 0.09093876928091049, 0.09003140777349472, 0.09192021191120148, 0.09184455126523972, 0.08980926871299744], [0.08634963631629944, 0.09221415221691132, 0.0920710638165474, 0.08980666100978851, 0.09178555756807327, 0.09324770420789719, 0.09095435589551926, 0.08925054967403412, 0.09281431138515472, 0.09267029166221619, 0.08883573114871979], [0.08639920502901077, 0.09219981729984283, 0.09205833822488785, 0.08981906622648239, 0.0917760357260704, 0.09322167187929153, 0.09095410257577896, 0.08926904201507568, 0.09279319643974304, 0.09265080839395523, 0.08885873109102249], [0.08719731122255325, 0.09196944534778595, 0.09185370802879333, 0.09001754969358444, 0.09162267297506332, 0.0928044393658638, 0.09094927459955215, 0.08956528455018997, 0.09245451539754868, 0.09233817458152771, 0.0892275720834732], [0.08649842441082001, 0.09217113256454468, 0.09203287214040756, 0.08984387665987015, 0.09175696969032288, 0.09316961467266083, 0.09095358103513718, 0.08930601179599762, 0.09275097399950027, 0.09261183440685272, 0.0889047235250473], [0.08599450439214706, 0.09231694787740707, 0.09216229617595673, 0.08971747010946274, 0.09185376763343811, 0.09343458712100983, 0.09095600247383118, 0.08911779522895813, 0.09296581149101257, 0.09281007200479507, 0.08867067843675613], [0.086789570748806, 0.0920870378613472, 0.091958187520504, 0.08991646021604538, 0.09170103073120117, 0.09301716089248657, 0.09095191955566406, 0.08941426873207092, 0.09262725710868835, 0.09249765425920486, 0.08903946727514267], [0.08739732205867767, 0.09191184490919113, 0.09180251508951187, 0.09006690979003906, 0.0915842279791832, 0.09270042926073074, 0.09094785153865814, 0.08963911980390549, 0.09237000346183777, 0.09226012229919434, 0.08931960165500641], [0.08614280074834824, 0.092274010181427, 0.09212420135736465, 0.08975477516651154, 0.09182530641555786, 0.09335647523403168, 0.09095536172389984, 0.08917330205440521, 0.09290250390768051, 0.09275166690349579, 0.08873967081308365], [0.08619227260351181, 0.09225969016551971, 0.0921114832162857, 0.0897672027349472, 0.09181579202413559, 0.09333043545484543, 0.09095513075590134, 0.08919179439544678, 0.09288138896226883, 0.09273218363523483, 0.08876266330480576], [0.08754757046699524, 0.09186861664056778, 0.09176407754421234, 0.0901038870215416, 0.09155535697937012, 0.09262243658304214, 0.09094671905040741, 0.08969447016716003, 0.09230661392211914, 0.09220157563686371, 0.08938862383365631]], [[0.08973392099142075, 0.09115736931562424, 0.09066212922334671, 0.08943256735801697, 0.08933234214782715, 0.09035766869783401, 0.09064771980047226, 0.0916881412267685, 0.10144130885601044, 0.08939134329557419, 0.0861554816365242], [0.08946426957845688, 0.09119260311126709, 0.09059061855077744, 0.08909912407398224, 0.08897773921489716, 0.09022088348865509, 0.09057311713695526, 0.091838538646698, 0.10384830087423325, 0.08904919028282166, 0.08514563739299774], [0.08955825865268707, 0.09118116647005081, 0.0906161293387413, 0.08921514451503754, 0.08910106122493744, 0.09026895463466644, 0.09059968590736389, 0.09178721904754639, 0.10300962626934052, 0.08916821330785751, 0.08549454063177109], [0.08979080617427826, 0.0911489725112915, 0.09067656099796295, 0.08950314670801163, 0.08940746635198593, 0.09038606286048889, 0.09066280722618103, 0.09165515005588531, 0.10093315690755844, 0.08946378529071808, 0.08637204766273499], [0.08980971574783325, 0.09114611893892288, 0.09068130701780319, 0.08952663093805313, 0.08943246304988861, 0.0903954729437828, 0.09066778421401978, 0.09164410084486008, 0.10076427459716797, 0.08948788791894913, 0.08644430339336395], [0.08961594849824905, 0.0911737009882927, 0.09063147008419037, 0.0892864540219307, 0.08917690068483353, 0.09029825031757355, 0.09061569720506668, 0.09175512939691544, 0.10249466449022293, 0.0892413929104805, 0.0857103243470192], [0.08956100046634674, 0.09118082374334335, 0.0906168594956398, 0.08921852707862854, 0.08910465985536575, 0.09027035534381866, 0.09060045331716537, 0.09178571403026581, 0.10298524796962738, 0.08917168527841568, 0.08550474047660828], [0.08936332911252975, 0.09120388329029083, 0.09056255221366882, 0.08897476643323898, 0.0888456255197525, 0.0901687890291214, 0.09054391086101532, 0.09189236164093018, 0.10474857687950134, 0.08892163634300232, 0.08477452397346497], [0.08747659623622894, 0.09124700725078583, 0.08992389589548111, 0.08669114112854004, 0.08643089234828949, 0.08911647647619247, 0.08988557755947113, 0.092678502202034, 0.12153192609548569, 0.08658401668071747, 0.07843396067619324], [0.08979859203100204, 0.09114781022071838, 0.09067852050065994, 0.08951281011104584, 0.08941774815320969, 0.09038994461297989, 0.09066486358642578, 0.09165061265230179, 0.10086368024349213, 0.08947370946407318, 0.08640176057815552], [0.09040454030036926, 0.09103573858737946, 0.09081676602363586, 0.09027019888162613, 0.0902254655957222, 0.09068181365728378, 0.0908103808760643, 0.09126968681812286, 0.09544088691473007, 0.09025180339813232, 0.08879266679286957]]]}, "num_training_step_calls_per_iteration": 1, "evaluation": {"env_runners": {"episode_len_max": 20, "rlmodule_inference_timer": 3.147572833872042e-05, "num_module_steps_sampled": {"default_policy": 400}, "sample": 0.16801166381827337, "env_to_module_connector": {"timers": {"connectors": {"add_states_from_episodes_to_batch": 2.7992501217962587e-06, "add_time_dim_to_batch_and_zero_pad": 6.699565616899616e-06, "add_observations_from_episodes_to_batch": 2.8031073214642673e-06, "numpy_to_tensor": 1.2148352984529587e-05, "batch_individual_items": 1.2186050174419791e-05}}, "connector_pipeline_timer": 5.863140369976771e-05}, "module_episode_returns_mean": {"default_policy": -1.45}, "module_to_env_connector": {"timers": {"connectors": {"normalize_and_clip_actions": 7.820404112258945e-06, "remove_single_ts_time_rank_from_batch": 1.1811710202648357e-05, "tensor_to_numpy": 1.5047844973424317e-05, "listify_data_for_vector_env": 1.0133094665725546e-05, "un_batch_to_individual_items": 6.478960059426442e-06, "get_actions": 3.720632300500977e-05}}, "connector_pipeline_timer": 0.00011503342285345523}, "episode_duration_sec_mean": 0.005507563733262941, "weights_seq_no": 15.0, "env_to_module_sum_episodes_length_out": 10.368238394574323, "agent_episode_returns_mean": {"default_agent": -1.45}, "episode_return_mean": -1.45, "env_to_module_sum_episodes_length_in": 10.368238394574323, "num_episodes_lifetime": 300, "num_agent_steps_sampled_lifetime": {"default_agent": 6000}, "num_episodes": 20, "episode_len_mean": 20.0, "num_agent_steps_sampled": {"default_agent": 400}, "num_module_steps_sampled_lifetime": {"default_policy": 6000}, "env_reset_timer": 0.002181485867275785, "episode_return_min": -16.5, "num_env_steps_sampled": 400, "episode_len_min": 20, "episode_return_max": 12.5, "env_step_timer": 1.3735089772025888e-05, "num_env_steps_sampled_lifetime": 75400, "time_between_sampling": 10.838654271819031}, "num_healthy_workers": 1, "actor_manager_num_outstanding_async_reqs": 0, "num_remote_worker_restarts": 0}, "num_env_steps_sampled_lifetime": -8017500.0, "fault_tolerance": {"num_healthy_workers": 0, "num_remote_worker_restarts": 0}, "env_runner_group": {"actor_manager_num_outstanding_async_reqs": 0}, "done": false, "training_iteration": 15, "trial_id": "b154b_00000", "date": "2025-08-11_18-13-56", "timestamp": 1754928836, "time_this_iter_s": 10.089603900909424, "time_total_s": 151.66158294677734, "pid": 10455, "hostname": "Mac", "node_ip": "127.0.0.1", "config": {"exploration_config": {}, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 2, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "env": "Umbrella", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": false, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 0, "create_local_env_runner": true, "num_envs_per_env_runner": 1, "gym_env_vectorize_mode": "SYNC", "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "episodes_to_numpy": true, "max_requests_in_flight_per_env_runner": 1, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "merge_env_runner_states": "training_only", "broadcast_env_runner_states": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "complete_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "sampler_perf_stats_ema_coef": null, "_is_online": true, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": "auto", "num_aggregator_actors_per_learner": 0, "max_requests_in_flight_per_aggregator_actor": 3, "local_gpu_idx": 0, "max_requests_in_flight_per_learner": 3, "gamma": 1, "lr": 0.0002715581955, "grad_clip": 0.5, "grad_clip_by": "global_norm", "_train_batch_size_per_learner": 5000, "train_batch_size": 4000, "num_epochs": 1, "minibatch_size": 1000, "shuffle_batch_per_epoch": true, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "log_std_clip_param": 20.0, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "_disable_preprocessor_api": false, "_disable_action_flattening": false}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {"intrinsic_reward_coeff": 0.2795015916508}, "optimizer": {}, "_learner_class": "<class 'source.intrinsic_attention_ppo.learners.IntrinsicAttentionMetaLearner.IntrinsicAttentionMetaLearner'>", "callbacks_on_algorithm_init": null, "callbacks_on_env_runners_recreated": null, "callbacks_on_offline_eval_runners_recreated": null, "callbacks_on_checkpoint_loaded": null, "callbacks_on_environment_created": null, "callbacks_on_episode_created": null, "callbacks_on_episode_start": null, "callbacks_on_episode_step": null, "callbacks_on_episode_end": null, "callbacks_on_evaluate_start": null, "callbacks_on_evaluate_end": null, "callbacks_on_evaluate_offline_start": null, "callbacks_on_evaluate_offline_end": null, "callbacks_on_sample_end": null, "callbacks_on_train_result": null, "explore": true, "enable_rl_module_and_learner": true, "enable_env_runner_and_connector_v2": true, "_prior_exploration_config": {"type": "StochasticSampling"}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x1514e58a0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "offline_data_class": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_read_batch_size": null, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "materialize_data": false, "materialize_mapped_data": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "ignore_final_observation": false, "prelearner_class": null, "prelearner_buffer_class": null, "prelearner_buffer_kwargs": {}, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_remaining_data": false, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": 1, "evaluation_duration": 20, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_auto_duration_min_env_steps_per_sample": 100, "evaluation_auto_duration_max_env_steps_per_sample": 2000, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 1, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "offline_evaluation_interval": null, "num_offline_eval_runners": 0, "offline_loss_for_module_fn": null, "offline_evaluation_duration": 1, "offline_evaluation_parallel_to_training": false, "offline_evaluation_timeout_s": 120.0, "num_cpus_per_offline_eval_runner": 1, "num_gpus_per_offline_eval_runner": 0, "custom_resources_per_offline_eval_runner": {}, "restart_failed_offline_eval_runners": true, "ignore_offline_eval_runner_failures": false, "max_num_offline_eval_runner_restarts": 1000, "offline_eval_runner_restore_timeout_s": 1800.0, "max_requests_in_flight_per_offline_eval_runner": 1, "validate_offline_eval_runners_after_construction": true, "offline_eval_runner_health_probe_timeout_s": 30.0, "offline_eval_rl_module_inference_only": false, "broadcast_offline_eval_runner_states": false, "offline_eval_batch_size_per_runner": 256, "dataset_num_iters_per_eval_runner": 1, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "log_gradients": false, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 4, "restart_failed_env_runners": true, "ignore_env_runner_failures": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30.0, "env_runner_restore_timeout_s": 1800.0, "_model_config": {}, "_rl_module_spec": "MultiRLModuleSpec(multi_rl_module_class=<class 'ray.rllib.core.rl_module.multi_rl_module.MultiRLModule'>, observation_space=None, action_space=None, inference_only=False, model_config=None, rl_module_specs={'default_policy': RLModuleSpec(module_class=<class 'source.intrinsic_attention_ppo.rl_modules.DifferentiablePPOModule.DifferentiablePPOModule'>, observation_space=None, action_space=None, inference_only=False, learner_only=False, model_config={'vf_share_layers': True, 'embedding_dim': 62, 'max_seq_len': 11, 'policy_head_hidden_sizes': [32], 'value_head_hidden_sizes': [101], 'embedding_hidden_sizes': [121]}, catalog_class=None, load_state_path=None, model_config_dict=None), 'intrinsic_reward_module': RLModuleSpec(module_class=<class 'source.intrinsic_attention_ppo.rl_modules.IntrinsicAttentionModule.IntrinsicAttentionModule'>, observation_space=None, action_space=None, inference_only=False, learner_only=True, model_config={'intrinsic_reward_network': {'encoder_hidden_sizes': [], 'encoding_dim': 1, 'num_heads': 1, 'head_hidden_sizes': None, 'layers': [{'type': 'attention'}]}, 'extrinsic_value_hidden_layers': [127, 60], 'vf_share_layers': True, 'max_seq_len': 11}, catalog_class=None, load_state_path=None, model_config_dict=None)}, load_state_path=None, modules_to_load=None, module_specs={'default_policy': RLModuleSpec(module_class=<class 'source.intrinsic_attention_ppo.rl_modules.DifferentiablePPOModule.DifferentiablePPOModule'>, observation_space=None, action_space=None, inference_only=False, learner_only=False, model_config={'vf_share_layers': True, 'embedding_dim': 62, 'max_seq_len': 11, 'policy_head_hidden_sizes': [32], 'value_head_hidden_sizes': [101], 'embedding_hidden_sizes': [121]}, catalog_class=None, load_state_path=None, model_config_dict=None), 'intrinsic_reward_module': RLModuleSpec(module_class=<class 'source.intrinsic_attention_ppo.rl_modules.IntrinsicAttentionModule.IntrinsicAttentionModule'>, observation_space=None, action_space=None, inference_only=False, learner_only=True, model_config={'intrinsic_reward_network': {'encoder_hidden_sizes': [], 'encoding_dim': 1, 'num_heads': 1, 'head_hidden_sizes': None, 'layers': [{'type': 'attention'}]}, 'extrinsic_value_hidden_layers': [127, 60], 'vf_share_layers': True, 'max_seq_len': 11}, catalog_class=None, load_state_path=None, model_config_dict=None)})", "algorithm_config_overrides_per_module": {"intrinsic_reward_module": {"lr": 0.0002715581955}}, "_per_module_overrides": {}, "_validate_config": true, "_use_msgpack_checkpoints": false, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "env_task_fn": -1, "enable_connectors": -1, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.161583927863, "kl_target": 0.0201019014258, "vf_loss_coeff": 0.7790510010087, "entropy_coeff": 0.0015431216992, "clip_param": 0.2459212356676, "vf_clip_param": 0.3769744131561, "entropy_coeff_schedule": null, "lr_schedule": null, "sgd_minibatch_size": -1, "vf_share_layers": -1, "differentiable_learner_configs": ["DifferentiableLearnerConfig(learner_class=<class 'source.intrinsic_attention_ppo.learners.IntrinsicAttentionPPOLearner.IntrinsicAttentionPPOLearner'>, learner_connector=None, add_default_connectors_to_learner_pipeline=True, is_multi_agent=False, policies_to_update=['default_policy'], lr=0.0060984166342, num_total_minibatches=0, num_epochs=1, minibatch_size=1000, shuffle_batch_per_epoch=True)"], "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9485408017724, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.callbacks.callbacks.RLlibCallback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 151.66158294677734, "iterations_since_restore": 15, "perf": {"cpu_util_percent": 43.70714285714286, "ram_util_percent": 82.77857142857144}}
{"timers": {"training_iteration": 10.168808277384276, "restore_env_runners": 1.0477554206524136e-05, "training_step": 10.168605216093196, "env_runner_sampling_timer": 1.817868538042343, "learner_update_timer": 8.165416703179906, "synch_weights": 0.0015085231668805121, "restore_eval_env_runners": 7.386099165492647e-05, "evaluation_iteration": 0.2068150799460157, "synch_eval_env_connectors": 0.00022107499585718136, "synch_env_connectors": 5.090536364916295e-06}, "env_runners": {"num_env_steps_sampled": 5000.0, "episode_return_max": 12.5, "env_to_module_connector": {"timers": {"connectors": {"add_time_dim_to_batch_and_zero_pad": 8.902445653306498e-06, "add_observations_from_episodes_to_batch": 3.346428868494852e-06, "batch_individual_items": 1.506163812337394e-05, "numpy_to_tensor": 1.627476447810241e-05, "add_states_from_episodes_to_batch": 3.18515890998719e-06}}, "connector_pipeline_timer": 7.317330357103994e-05}, "episode_len_min": 20, "module_to_env_connector": {"timers": {"connectors": {"un_batch_to_individual_items": 8.13549688223089e-06, "normalize_and_clip_actions": 9.688736866965773e-06, "remove_single_ts_time_rank_from_batch": 1.391592110493307e-05, "get_actions": 5.3960146341284283e-05, "tensor_to_numpy": 1.8666780861303807e-05, "listify_data_for_vector_env": 1.2763544419741664e-05}}, "connector_pipeline_timer": 0.0001491376260897399}, "env_step_timer": 1.8171156831965193e-05, "num_agent_steps_sampled_lifetime": {"default_agent": -8635000.0}, "num_episodes": 250.0, "episode_duration_sec_mean": 0.006389563665725291, "episode_len_mean": 20.0, "module_episode_returns_mean": {"default_policy": 4.82}, "weights_seq_no": 15.0, "env_to_module_sum_episodes_length_out": 10.36823839457432, "num_env_steps_sampled_lifetime": -8635000.0, "episode_len_max": 20, "rlmodule_inference_timer": 4.085353595885462e-05, "num_agent_steps_sampled": {"default_agent": 5000.0}, "env_reset_timer": 5.6929335429360106e-05, "agent_episode_returns_mean": {"default_agent": 4.82}, "env_to_module_sum_episodes_length_in": 10.36823839457432, "episode_return_mean": 4.82, "time_between_sampling": 0.03392673118929192, "num_module_steps_sampled_lifetime": {"default_policy": -8635000.0}, "num_module_steps_sampled": {"default_policy": 5000.0}, "num_episodes_lifetime": -431750.0, "episode_return_min": -7.5, "sample": 0.0070523049733135345, "num_env_steps_sampled_lifetime_throughput": 2748.5592802467327}, "__all_modules__": {"learner_connector_sum_episodes_length_in": 5000.0, "learner_connector": {"connector_pipeline_timer": 0.14092261691747635, "timers": {"connectors": {"add_one_ts_to_episodes_and_truncate": 0.009902676305098923, "add_observations_from_episodes_to_batch": 0.0010292645497198814, "add_columns_from_episodes_to_train_batch": 0.044496431281170104, "add_time_dim_to_batch_and_zero_pad": 0.07715771894355672, "add_states_from_episodes_to_batch": 0.0036780894652555197, "batch_individual_items": 0.004396425625684421, "numpy_to_tensor": 7.39421198915987e-05}}}, "learner_connector_sum_episodes_length_out": 5250.0}, "learners": {"__all_modules__": {"num_module_steps_trained_lifetime": 191520, "num_env_steps_trained": 33000, "num_env_steps_trained_lifetime": 528000, "num_non_trainable_parameters": 0, "num_trainable_parameters": 24861, "num_module_steps_trained": 11970, "num_env_steps_trained_lifetime_throughput": 3921.9874482350438, "num_module_steps_trained_throughput": 21592123.65293607, "num_module_steps_trained_lifetime_throughput": 12528130.202869749}, "default_policy": {"curr_entropy_coeff": 0.0015431216992, "weights_seq_no": 16.0, "curr_kl_coeff": 2.4655751076352317e-06, "policy_loss": -0.0008702926570549607, "module_train_batch_size_mean": 997.6889684010584, "num_trainable_parameters": 16595, "vf_loss": 0.3583069145679474, "mean_kl_loss": 4.2802970710908994e-05, "diff_num_grad_updates_vs_sampler_policy": 1.0, "vf_explained_var": -0.0006258487701416016, "use_intrinsic_rewards": 0.0, "entropy": 0.6773175597190857, "num_module_steps_trained": 5985, "vf_loss_unclipped": 44.01985168457031, "total_loss": 0.2772238850593567, "num_module_steps_trained_lifetime": 95760, "num_module_steps_trained_lifetime_throughput": 711.1183726855477}, "differentiable_learners": {"intrinsic_attention_ppo_learner": {"__all_modules__": {"num_module_steps_trained_lifetime": 1149120, "num_env_steps_trained_lifetime": 3168000, "num_module_steps_trained": 71820, "num_env_steps_trained": 198000, "num_env_steps_trained_lifetime_throughput": 43857.42103482119}, "default_policy": {"weights_seq_no": 96.0, "policy_loss": -0.0008198724826797843, "module_train_batch_size_mean": 997.4990256591639, "vf_loss": 0.3583161532878876, "mean_kl_loss": 3.792034476646222e-05, "diff_num_grad_updates_vs_sampler_policy": 81.0, "vf_explained_var": 0.0029715299606323242, "use_intrinsic_rewards": 1.0, "entropy": 0.6774131059646606, "num_module_steps_trained": 35910, "vf_loss_unclipped": 43.95738220214844, "total_loss": 0.2772875130176544, "num_module_steps_trained_lifetime": 574560}, "intrinsic_reward_module": {"total_loss": 0.0, "num_module_steps_trained_lifetime": 574560, "module_train_batch_size_mean": 997.4990256591639, "weights_seq_no": 96.0, "num_module_steps_trained": 35910, "diff_num_grad_updates_vs_sampler_policy": 81.0}}}, "intrinsic_reward_module": {"diff_num_grad_updates_vs_sampler_policy": 1.0, "gradients_default_optimizer_global_norm": 0.0, "curr_entropy_coeff": 0.0015431216992, "weights_seq_no": 16.0, "default_optimizer_learning_rate": 0.0002715581955, "total_loss": 0.0, "num_module_steps_trained_lifetime": 95760, "module_train_batch_size_mean": 997.6889684010584, "num_trainable_parameters": 8266, "num_module_steps_trained": 5985, "num_module_steps_trained_lifetime_throughput": 711.124203038023}, "IntrinsicAttentionMask": [[[0.09100000560283661, 0.09090153127908707, 0.09080316871404648, 0.09070491790771484, 0.09060677140951157, 0.09161066263914108, 0.09151153266429901, 0.09031295776367188, 0.09131360054016113, 0.09121479094028473, 0.09002010524272919], [0.0909985676407814, 0.09090167284011841, 0.09080487489700317, 0.0907081812620163, 0.09061158448457718, 0.0915994644165039, 0.09150192886590958, 0.09032243490219116, 0.09130716323852539, 0.09120992571115494, 0.09003420174121857], [0.09099714457988739, 0.09090180695056915, 0.09080657362937927, 0.09071144461631775, 0.09061641246080399, 0.09158827364444733, 0.09149232506752014, 0.09033191204071045, 0.09130071848630905, 0.09120507538318634, 0.09004830569028854], [0.09099571406841278, 0.0909019485116005, 0.09080827981233597, 0.0907147154211998, 0.09062124043703079, 0.09157708287239075, 0.0914827212691307, 0.09034140408039093, 0.0912942886352539, 0.09120021760463715, 0.09006241708993912], [0.09099428355693817, 0.09090209007263184, 0.09080998599529266, 0.09071797877550125, 0.090626060962677, 0.09156589210033417, 0.09147311747074127, 0.09035087376832962, 0.09128785133361816, 0.09119535982608795, 0.09007652848958969], [0.09100881963968277, 0.09090065956115723, 0.09079263359308243, 0.09068472683429718, 0.09057695418596268, 0.09167982637882233, 0.09157086908817291, 0.09025440365076065, 0.09135334938764572, 0.09124477952718735, 0.08993300050497055], [0.09100738912820816, 0.09090080112218857, 0.09079433977603912, 0.09068799763917923, 0.09058178216218948, 0.09166862815618515, 0.09156126528978348, 0.09026388078927994, 0.09134691208600998, 0.09123992919921875, 0.08994709700345993], [0.09098998457193375, 0.09090249985456467, 0.09081509709358215, 0.0907277762889862, 0.09064053744077682, 0.09153232723474503, 0.09144431352615356, 0.09037932753562927, 0.09126854687929153, 0.09118079394102097, 0.09011887013912201], [0.09100454300642014, 0.09090109169483185, 0.09079775214195251, 0.09069453924894333, 0.0905914381146431, 0.0916462391614914, 0.09154205769300461, 0.09028284251689911, 0.09133405238389969, 0.09123022109270096, 0.08997529745101929], [0.09100310504436493, 0.09090122580528259, 0.09079945087432861, 0.09069779515266418, 0.0905962586402893, 0.09163503348827362, 0.09153244644403458, 0.0902923122048378, 0.09132760763168335, 0.09122535586357117, 0.08998938649892807], [0.09098568558692932, 0.0909029021859169, 0.09082019329071045, 0.09073755890130997, 0.09065499901771545, 0.09149876236915588, 0.09141550958156586, 0.09040777385234833, 0.09124923497438431, 0.09116621315479279, 0.09016122668981552]], [[0.09242688864469528, 0.09234438091516495, 0.09318751841783524, 0.0909501239657402, 0.09209731221199036, 0.09293819218873978, 0.09070678800344467, 0.09153497219085693, 0.08235321938991547, 0.09091673046350479, 0.09054379910230637], [0.09239823371171951, 0.09231735020875931, 0.09314389526844025, 0.09095020592212677, 0.09207510948181152, 0.09289948642253876, 0.0907115563750267, 0.09152372926473618, 0.0825112834572792, 0.09091746062040329, 0.0905516967177391], [0.09268875420093536, 0.09259136021137238, 0.09358731657266617, 0.09094793349504471, 0.09229981154203415, 0.09329263865947723, 0.09066156297922134, 0.0916367620229721, 0.08091535419225693, 0.09090862423181534, 0.09046982228755951], [0.09190618246793747, 0.09185270220041275, 0.0923985168337822, 0.09094628691673279, 0.09169242531061172, 0.09223729372024536, 0.09078758955001831, 0.09132707864046097, 0.08524616807699203, 0.09092451632022858, 0.09068121761083603], [0.09231211245059967, 0.09223607182502747, 0.09301292151212692, 0.09095022082328796, 0.0920083224773407, 0.09278325736522675, 0.09072565287351608, 0.091489776968956, 0.08298709988594055, 0.09091940522193909, 0.0905751958489418], [0.09260337799787521, 0.09251086413860321, 0.09345675259828568, 0.09094895422458649, 0.09223388135433197, 0.0931769385933876, 0.09067665040493011, 0.09160377830266953, 0.0813828632235527, 0.09091157466173172, 0.0904942974448204], [0.09181878715753555, 0.09177009761333466, 0.09226685017347336, 0.09094458073377609, 0.0916241854429245, 0.09212014824151993, 0.090799979865551, 0.09129147976636887, 0.08573613315820694, 0.09092474728822708, 0.09070303291082382], [0.09211438149213791, 0.09204938262701035, 0.09271304309368134, 0.09094912558794022, 0.09185466915369034, 0.09251692146062851, 0.09075673669576645, 0.09141107648611069, 0.08408412337303162, 0.09092273563146591, 0.09062781184911728], [0.08851046115159988, 0.08862865716218948, 0.08743305504322052, 0.09066662192344666, 0.0889841839671135, 0.08778379112482071, 0.09103033691644669, 0.0898023322224617, 0.10516879707574844, 0.0907163918018341, 0.09127531945705414], [0.09189421683549881, 0.09184138476848602, 0.09238047152757645, 0.09094606339931488, 0.09168308228254318, 0.09222123771905899, 0.0907893031835556, 0.09132221341133118, 0.08531317859888077, 0.09092456102371216, 0.09068422019481659], [0.09175998717546463, 0.0917145162820816, 0.09217838943004608, 0.09094326943159103, 0.09157822281122208, 0.09204141050577164, 0.09080812335014343, 0.0912674218416214, 0.08606646955013275, 0.09092473238706589, 0.09071751683950424]], [[0.09153654426336288, 0.08996107429265976, 0.08986373990774155, 0.0897664949297905, 0.0896693617105484, 0.09215080738067627, 0.09205109626054764, 0.09084545075893402, 0.09185199439525604, 0.09175259619951248, 0.09055086970329285], [0.0913768783211708, 0.09020311385393143, 0.09013041853904724, 0.09005778282880783, 0.0899851992726326, 0.09183311462402344, 0.0917591080069542, 0.09086263179779053, 0.09161126613616943, 0.09153743833303452, 0.09064313024282455], [0.09136690199375153, 0.0902182087302208, 0.09014704823493958, 0.09007595479488373, 0.09000491350889206, 0.09181331843137741, 0.09174090623855591, 0.0908636823296547, 0.09159626066684723, 0.09152401238679886, 0.09064885973930359], [0.09135693311691284, 0.09023329615592957, 0.0901636853814125, 0.09009412676095963, 0.09002462029457092, 0.09179352223873138, 0.09172270447015762, 0.09086472541093826, 0.09158124029636383, 0.0915105864405632, 0.09065459668636322], [0.09134696424007416, 0.09024839103221893, 0.09018031507730484, 0.09011229872703552, 0.09004433453083038, 0.09177372604608536, 0.09170451015233994, 0.09086576849222183, 0.09156622737646103, 0.09149716794490814, 0.09066032618284225], [0.09159795939922333, 0.08986784517765045, 0.08976104110479355, 0.0896543636918068, 0.08954781293869019, 0.09227330982685089, 0.09216364473104477, 0.09083866328001022, 0.09194471687078476, 0.09183544665575027, 0.09051518142223358], [0.09158802032470703, 0.08988293260335922, 0.08977766335010529, 0.0896725133061409, 0.08956748992204666, 0.09225347638130188, 0.09214542806148529, 0.09083976596593857, 0.09192971140146255, 0.09182204306125641, 0.0905209630727768], [0.09146688878536224, 0.09006673097610474, 0.0899801254272461, 0.08989360928535461, 0.0898071750998497, 0.09201207011938095, 0.09192359447479248, 0.09085302799940109, 0.09174690395593643, 0.09165868908166885, 0.09059120714664459], [0.09156814962625504, 0.08991312235593796, 0.08981091529130936, 0.08970881998538971, 0.08960683643817902, 0.09221381694078445, 0.09210898727178574, 0.09084197878837585, 0.09189969301223755, 0.09179522097110748, 0.09053252637386322], [0.09155820310115814, 0.08992821723222733, 0.0898275375366211, 0.08972696959972382, 0.08962651342153549, 0.09219398349523544, 0.09209077060222626, 0.0908430740237236, 0.09188468009233475, 0.09178180247545242, 0.09053830057382584], [0.09143701195716858, 0.09011200815439224, 0.09003002196550369, 0.08994810283184052, 0.0898662656545639, 0.09195263683795929, 0.09186897426843643, 0.09085623174905777, 0.09170187264680862, 0.09161844104528427, 0.09060846269130707]], [[0.09265587478876114, 0.09133844822645187, 0.09341838955879211, 0.09117545187473297, 0.09232547879219055, 0.09192579239606857, 0.09093151241540909, 0.0917617455124855, 0.08255725353956223, 0.09114197641611099, 0.09076812118291855], [0.0921209380030632, 0.09121455252170563, 0.09264373034238815, 0.09110213071107864, 0.0918940082192421, 0.09161914139986038, 0.09093376249074936, 0.0915062204003334, 0.08506554365158081, 0.09107903391122818, 0.09082090854644775], [0.09295973926782608, 0.09140580892562866, 0.0938609316945076, 0.09121382981538773, 0.09256966412067413, 0.09209810197353363, 0.0909266248345375, 0.09190467745065689, 0.08115191757678986, 0.0911744087934494, 0.0907343253493309], [0.0920538678765297, 0.09119854122400284, 0.0925469920039177, 0.09109243005514145, 0.09183976799249649, 0.09158039838075638, 0.09093347936868668, 0.09147383272647858, 0.08538315445184708, 0.09107062220573425, 0.09082692861557007], [0.09252290427684784, 0.09130827337503433, 0.09322531521320343, 0.09115790575742722, 0.09221842139959335, 0.09184995293617249, 0.09093281626701355, 0.09169869124889374, 0.08317659050226212, 0.09112702310085297, 0.09078202396631241], [0.09236101061105728, 0.09127099066972733, 0.0929906889796257, 0.09113594144582748, 0.09208789467811584, 0.09175727516412735, 0.09093375504016876, 0.0916215181350708, 0.0839344784617424, 0.09110820293426514, 0.0907982736825943], [0.0919531062245369, 0.09117429703474045, 0.09240182489156723, 0.09107761830091476, 0.09175822138786316, 0.09152206778526306, 0.09093280881643295, 0.09142503142356873, 0.08586155623197556, 0.09105776250362396, 0.09083572030067444], [0.09229422360658646, 0.09125543385744095, 0.0928940549492836, 0.0911266952753067, 0.0920340046286583, 0.09171894192695618, 0.09093393385410309, 0.0915895476937294, 0.08424828946590424, 0.09110024571418762, 0.09080474823713303], [0.08819512277841568, 0.09010279923677444, 0.08712155371904373, 0.09034360200166702, 0.08866716176271439, 0.08924388140439987, 0.09070601314306259, 0.0894823893904686, 0.10479411482810974, 0.09039318561553955, 0.0909501239657402], [0.0920400619506836, 0.0911952331662178, 0.09252709150314331, 0.09109040349721909, 0.0918285921216011, 0.09157241135835648, 0.09093339741230011, 0.09146715700626373, 0.08544857800006866, 0.09106887131929398, 0.09082815051078796], [0.09188537299633026, 0.09115786105394363, 0.09230434149503708, 0.09106753021478653, 0.09170335531234741, 0.09148278087377548, 0.0909322053194046, 0.09139212965965271, 0.0861840695142746, 0.09104897081851959, 0.09084147214889526]], [[0.09100000560283661, 0.09090153127908707, 0.09080316871404648, 0.09070491790771484, 0.09060677140951157, 0.09161066263914108, 0.09151153266429901, 0.09031295776367188, 0.09131360054016113, 0.09121479094028473, 0.09002010524272919], [0.0909985676407814, 0.09090167284011841, 0.09080487489700317, 0.0907081812620163, 0.09061158448457718, 0.0915994644165039, 0.09150192886590958, 0.09032243490219116, 0.09130716323852539, 0.09120992571115494, 0.09003420174121857], [0.09099714457988739, 0.09090180695056915, 0.09080657362937927, 0.09071144461631775, 0.09061641246080399, 0.09158827364444733, 0.09149232506752014, 0.09033191204071045, 0.09130071848630905, 0.09120507538318634, 0.09004830569028854], [0.09099571406841278, 0.0909019485116005, 0.09080827981233597, 0.0907147154211998, 0.09062124043703079, 0.09157708287239075, 0.0914827212691307, 0.09034140408039093, 0.0912942886352539, 0.09120021760463715, 0.09006241708993912], [0.09099428355693817, 0.09090209007263184, 0.09080998599529266, 0.09071797877550125, 0.090626060962677, 0.09156589210033417, 0.09147311747074127, 0.09035087376832962, 0.09128785133361816, 0.09119535982608795, 0.09007652848958969], [0.09100881963968277, 0.09090065956115723, 0.09079263359308243, 0.09068472683429718, 0.09057695418596268, 0.09167982637882233, 0.09157086908817291, 0.09025440365076065, 0.09135334938764572, 0.09124477952718735, 0.08993300050497055], [0.09100738912820816, 0.09090080112218857, 0.09079433977603912, 0.09068799763917923, 0.09058178216218948, 0.09166862815618515, 0.09156126528978348, 0.09026388078927994, 0.09134691208600998, 0.09123992919921875, 0.08994709700345993], [0.09098998457193375, 0.09090249985456467, 0.09081509709358215, 0.0907277762889862, 0.09064053744077682, 0.09153232723474503, 0.09144431352615356, 0.09037932753562927, 0.09126854687929153, 0.09118079394102097, 0.09011887013912201], [0.09100454300642014, 0.09090109169483185, 0.09079775214195251, 0.09069453924894333, 0.0905914381146431, 0.0916462391614914, 0.09154205769300461, 0.09028284251689911, 0.09133405238389969, 0.09123022109270096, 0.08997529745101929], [0.09100310504436493, 0.09090122580528259, 0.09079945087432861, 0.09069779515266418, 0.0905962586402893, 0.09163503348827362, 0.09153244644403458, 0.0902923122048378, 0.09132760763168335, 0.09122535586357117, 0.08998938649892807], [0.09098568558692932, 0.0909029021859169, 0.09082019329071045, 0.09073755890130997, 0.09065499901771545, 0.09149876236915588, 0.09141550958156586, 0.09040777385234833, 0.09124923497438431, 0.09116621315479279, 0.09016122668981552]], [[0.09231317043304443, 0.09100062400102615, 0.09307286888360977, 0.0908382311463356, 0.09198400378227234, 0.09282384812831879, 0.09181986004114151, 0.09265820682048798, 0.0822518989443779, 0.09080487489700317, 0.09043239802122116], [0.09188638627529144, 0.09098230302333832, 0.09240784496068954, 0.09087017178535461, 0.0916600301861763, 0.09223706275224686, 0.09154706448316574, 0.09212338179349899, 0.08484894782304764, 0.09084713459014893, 0.09058966487646103], [0.09255433827638626, 0.09100718796253204, 0.0934516042470932, 0.09081605076789856, 0.09216596931219101, 0.09315735101699829, 0.09197239577770233, 0.09296169131994247, 0.08079800754785538, 0.09077679365873337, 0.09033863246440887], [0.09183266758918762, 0.09097939729690552, 0.09232460707426071, 0.09087353199720383, 0.0916190817952156, 0.09216351062059402, 0.09151247143745422, 0.0920562744140625, 0.08517797291278839, 0.0908517837524414, 0.09060867875814438], [0.09220734983682632, 0.09099686145782471, 0.0929073691368103, 0.09084700793027878, 0.09190391004085541, 0.09267796576023102, 0.0917525589466095, 0.09252534061670303, 0.08289291709661484, 0.09081622958183289, 0.09047240763902664], [0.09247574955224991, 0.0910053476691246, 0.09332794696092606, 0.09082360565662384, 0.09210675209760666, 0.09304852038621902, 0.0919228196144104, 0.09286269545555115, 0.08127068728208542, 0.09078627824783325, 0.0903695747256279], [0.09215429425239563, 0.09099479764699936, 0.0928245335817337, 0.09085121005773544, 0.09186369180679321, 0.09260491281747818, 0.09171873331069946, 0.09245877712965012, 0.0832151249051094, 0.09082171320915222, 0.09049223363399506], [0.0924232229590416, 0.09100395441055298, 0.09324543178081512, 0.09082847833633423, 0.09206713736057281, 0.09297586232423782, 0.09188961237668991, 0.09279658645391464, 0.08158718794584274, 0.09079243987798691, 0.09039004892110825], [0.08866970241069794, 0.09058765321969986, 0.08759035915136337, 0.0908297449350357, 0.08914428949356079, 0.0879417285323143, 0.08938252925872803, 0.08817675709724426, 0.1053580492734909, 0.09087961167097092, 0.09143953770399094], [0.09182161837816238, 0.09097879379987717, 0.09230749309062958, 0.09087421745061874, 0.09161065518856049, 0.09214838594198227, 0.09150534868240356, 0.0920424684882164, 0.085245780646801, 0.09085272997617722, 0.09061258286237717], [0.09169753640890121, 0.09097151458263397, 0.09211564809083939, 0.09088137000799179, 0.09151589125394821, 0.0919787660241127, 0.09142520278692245, 0.09188762307167053, 0.08600788563489914, 0.09086284041404724, 0.09065576642751694]]]}, "num_training_step_calls_per_iteration": 1, "evaluation": {"env_runners": {"episode_len_max": 20, "rlmodule_inference_timer": 3.3335013837261224e-05, "num_module_steps_sampled": {"default_policy": 400}, "sample": 0.16753297384981305, "env_to_module_connector": {"timers": {"connectors": {"add_states_from_episodes_to_batch": 2.8553102144770545e-06, "add_time_dim_to_batch_and_zero_pad": 7.216669480374364e-06, "add_observations_from_episodes_to_batch": 3.0855122117000345e-06, "numpy_to_tensor": 1.276967340170006e-05, "batch_individual_items": 1.2600155191812592e-05}}, "connector_pipeline_timer": 6.09401772255639e-05}, "module_episode_returns_mean": {"default_policy": -0.05}, "module_to_env_connector": {"timers": {"connectors": {"normalize_and_clip_actions": 8.021222993218774e-06, "remove_single_ts_time_rank_from_batch": 1.193528244470168e-05, "tensor_to_numpy": 1.5610181563165444e-05, "listify_data_for_vector_env": 1.0460829431939302e-05, "un_batch_to_individual_items": 6.643518527892976e-06, "get_actions": 3.999289443194561e-05}}, "connector_pipeline_timer": 0.00012002248337477025}, "episode_duration_sec_mean": 0.005508617092855275, "weights_seq_no": 16.0, "env_to_module_sum_episodes_length_out": 10.368238394574323, "agent_episode_returns_mean": {"default_agent": -0.05}, "episode_return_mean": -0.05, "env_to_module_sum_episodes_length_in": 10.368238394574323, "num_episodes_lifetime": 320, "num_agent_steps_sampled_lifetime": {"default_agent": 6400}, "num_episodes": 20, "episode_len_mean": 20.0, "num_agent_steps_sampled": {"default_agent": 400}, "num_module_steps_sampled_lifetime": {"default_policy": 6400}, "env_reset_timer": 0.002163057259067273, "episode_return_min": -16.5, "num_env_steps_sampled": 400, "episode_len_min": 20, "episode_return_max": 12.5, "env_step_timer": 1.4461678404114432e-05, "num_env_steps_sampled_lifetime": 80400, "time_between_sampling": 10.83975552952087}, "num_healthy_workers": 1, "actor_manager_num_outstanding_async_reqs": 0, "num_remote_worker_restarts": 0}, "num_env_steps_sampled_lifetime": -8635000.0, "fault_tolerance": {"num_healthy_workers": 0, "num_remote_worker_restarts": 0}, "env_runner_group": {"actor_manager_num_outstanding_async_reqs": 0}, "done": false, "training_iteration": 16, "trial_id": "b154b_00000", "date": "2025-08-11_18-14-08", "timestamp": 1754928848, "time_this_iter_s": 11.048588991165161, "time_total_s": 162.7101719379425, "pid": 10455, "hostname": "Mac", "node_ip": "127.0.0.1", "config": {"exploration_config": {}, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 2, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "env": "Umbrella", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": false, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 0, "create_local_env_runner": true, "num_envs_per_env_runner": 1, "gym_env_vectorize_mode": "SYNC", "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "episodes_to_numpy": true, "max_requests_in_flight_per_env_runner": 1, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "merge_env_runner_states": "training_only", "broadcast_env_runner_states": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "complete_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "sampler_perf_stats_ema_coef": null, "_is_online": true, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": "auto", "num_aggregator_actors_per_learner": 0, "max_requests_in_flight_per_aggregator_actor": 3, "local_gpu_idx": 0, "max_requests_in_flight_per_learner": 3, "gamma": 1, "lr": 0.0002715581955, "grad_clip": 0.5, "grad_clip_by": "global_norm", "_train_batch_size_per_learner": 5000, "train_batch_size": 4000, "num_epochs": 1, "minibatch_size": 1000, "shuffle_batch_per_epoch": true, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "log_std_clip_param": 20.0, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "_disable_preprocessor_api": false, "_disable_action_flattening": false}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {"intrinsic_reward_coeff": 0.2795015916508}, "optimizer": {}, "_learner_class": "<class 'source.intrinsic_attention_ppo.learners.IntrinsicAttentionMetaLearner.IntrinsicAttentionMetaLearner'>", "callbacks_on_algorithm_init": null, "callbacks_on_env_runners_recreated": null, "callbacks_on_offline_eval_runners_recreated": null, "callbacks_on_checkpoint_loaded": null, "callbacks_on_environment_created": null, "callbacks_on_episode_created": null, "callbacks_on_episode_start": null, "callbacks_on_episode_step": null, "callbacks_on_episode_end": null, "callbacks_on_evaluate_start": null, "callbacks_on_evaluate_end": null, "callbacks_on_evaluate_offline_start": null, "callbacks_on_evaluate_offline_end": null, "callbacks_on_sample_end": null, "callbacks_on_train_result": null, "explore": true, "enable_rl_module_and_learner": true, "enable_env_runner_and_connector_v2": true, "_prior_exploration_config": {"type": "StochasticSampling"}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x1514e58a0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "offline_data_class": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_read_batch_size": null, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "materialize_data": false, "materialize_mapped_data": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "ignore_final_observation": false, "prelearner_class": null, "prelearner_buffer_class": null, "prelearner_buffer_kwargs": {}, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_remaining_data": false, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": 1, "evaluation_duration": 20, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_auto_duration_min_env_steps_per_sample": 100, "evaluation_auto_duration_max_env_steps_per_sample": 2000, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 1, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "offline_evaluation_interval": null, "num_offline_eval_runners": 0, "offline_loss_for_module_fn": null, "offline_evaluation_duration": 1, "offline_evaluation_parallel_to_training": false, "offline_evaluation_timeout_s": 120.0, "num_cpus_per_offline_eval_runner": 1, "num_gpus_per_offline_eval_runner": 0, "custom_resources_per_offline_eval_runner": {}, "restart_failed_offline_eval_runners": true, "ignore_offline_eval_runner_failures": false, "max_num_offline_eval_runner_restarts": 1000, "offline_eval_runner_restore_timeout_s": 1800.0, "max_requests_in_flight_per_offline_eval_runner": 1, "validate_offline_eval_runners_after_construction": true, "offline_eval_runner_health_probe_timeout_s": 30.0, "offline_eval_rl_module_inference_only": false, "broadcast_offline_eval_runner_states": false, "offline_eval_batch_size_per_runner": 256, "dataset_num_iters_per_eval_runner": 1, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "log_gradients": false, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 4, "restart_failed_env_runners": true, "ignore_env_runner_failures": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30.0, "env_runner_restore_timeout_s": 1800.0, "_model_config": {}, "_rl_module_spec": "MultiRLModuleSpec(multi_rl_module_class=<class 'ray.rllib.core.rl_module.multi_rl_module.MultiRLModule'>, observation_space=None, action_space=None, inference_only=False, model_config=None, rl_module_specs={'default_policy': RLModuleSpec(module_class=<class 'source.intrinsic_attention_ppo.rl_modules.DifferentiablePPOModule.DifferentiablePPOModule'>, observation_space=None, action_space=None, inference_only=False, learner_only=False, model_config={'vf_share_layers': True, 'embedding_dim': 62, 'max_seq_len': 11, 'policy_head_hidden_sizes': [32], 'value_head_hidden_sizes': [101], 'embedding_hidden_sizes': [121]}, catalog_class=None, load_state_path=None, model_config_dict=None), 'intrinsic_reward_module': RLModuleSpec(module_class=<class 'source.intrinsic_attention_ppo.rl_modules.IntrinsicAttentionModule.IntrinsicAttentionModule'>, observation_space=None, action_space=None, inference_only=False, learner_only=True, model_config={'intrinsic_reward_network': {'encoder_hidden_sizes': [], 'encoding_dim': 1, 'num_heads': 1, 'head_hidden_sizes': None, 'layers': [{'type': 'attention'}]}, 'extrinsic_value_hidden_layers': [127, 60], 'vf_share_layers': True, 'max_seq_len': 11}, catalog_class=None, load_state_path=None, model_config_dict=None)}, load_state_path=None, modules_to_load=None, module_specs={'default_policy': RLModuleSpec(module_class=<class 'source.intrinsic_attention_ppo.rl_modules.DifferentiablePPOModule.DifferentiablePPOModule'>, observation_space=None, action_space=None, inference_only=False, learner_only=False, model_config={'vf_share_layers': True, 'embedding_dim': 62, 'max_seq_len': 11, 'policy_head_hidden_sizes': [32], 'value_head_hidden_sizes': [101], 'embedding_hidden_sizes': [121]}, catalog_class=None, load_state_path=None, model_config_dict=None), 'intrinsic_reward_module': RLModuleSpec(module_class=<class 'source.intrinsic_attention_ppo.rl_modules.IntrinsicAttentionModule.IntrinsicAttentionModule'>, observation_space=None, action_space=None, inference_only=False, learner_only=True, model_config={'intrinsic_reward_network': {'encoder_hidden_sizes': [], 'encoding_dim': 1, 'num_heads': 1, 'head_hidden_sizes': None, 'layers': [{'type': 'attention'}]}, 'extrinsic_value_hidden_layers': [127, 60], 'vf_share_layers': True, 'max_seq_len': 11}, catalog_class=None, load_state_path=None, model_config_dict=None)})", "algorithm_config_overrides_per_module": {"intrinsic_reward_module": {"lr": 0.0002715581955}}, "_per_module_overrides": {}, "_validate_config": true, "_use_msgpack_checkpoints": false, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "env_task_fn": -1, "enable_connectors": -1, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.161583927863, "kl_target": 0.0201019014258, "vf_loss_coeff": 0.7790510010087, "entropy_coeff": 0.0015431216992, "clip_param": 0.2459212356676, "vf_clip_param": 0.3769744131561, "entropy_coeff_schedule": null, "lr_schedule": null, "sgd_minibatch_size": -1, "vf_share_layers": -1, "differentiable_learner_configs": ["DifferentiableLearnerConfig(learner_class=<class 'source.intrinsic_attention_ppo.learners.IntrinsicAttentionPPOLearner.IntrinsicAttentionPPOLearner'>, learner_connector=None, add_default_connectors_to_learner_pipeline=True, is_multi_agent=False, policies_to_update=['default_policy'], lr=0.0060984166342, num_total_minibatches=0, num_epochs=1, minibatch_size=1000, shuffle_batch_per_epoch=True)"], "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9485408017724, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.callbacks.callbacks.RLlibCallback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 162.7101719379425, "iterations_since_restore": 16, "perf": {"cpu_util_percent": 43.44375, "ram_util_percent": 82.83125}}
{"timers": {"training_iteration": 10.161387152520001, "restore_env_runners": 1.0496529315714144e-05, "training_step": 10.161183470602785, "env_runner_sampling_timer": 1.815221376831411, "learner_update_timer": 8.16065165489822, "synch_weights": 0.0015085250151669718, "restore_eval_env_runners": 7.352363159227132e-05, "evaluation_iteration": 0.2060421112263308, "synch_eval_env_connectors": 0.00022078049564692892, "synch_env_connectors": 5.082540524739321e-06}, "env_runners": {"num_env_steps_sampled": 5000.0, "episode_return_max": 12.5, "env_to_module_connector": {"timers": {"connectors": {"add_time_dim_to_batch_and_zero_pad": 7.020936475288425e-06, "add_observations_from_episodes_to_batch": 2.8216661777074276e-06, "batch_individual_items": 1.238260471654865e-05, "numpy_to_tensor": 1.282128093722972e-05, "add_states_from_episodes_to_batch": 2.7272812839275757e-06}}, "connector_pipeline_timer": 6.0242036678766514e-05}, "episode_len_min": 20, "module_to_env_connector": {"timers": {"connectors": {"un_batch_to_individual_items": 6.634496136278382e-06, "normalize_and_clip_actions": 8.168953549853176e-06, "remove_single_ts_time_rank_from_batch": 1.201751625492034e-05, "get_actions": 4.001021144307127e-05, "tensor_to_numpy": 1.530188062310993e-05, "listify_data_for_vector_env": 1.0701095807507496e-05}}, "connector_pipeline_timer": 0.00011984556321039678}, "env_step_timer": 1.3977368918132852e-05, "num_agent_steps_sampled_lifetime": {"default_agent": -9252500.0}, "num_episodes": 250.0, "episode_duration_sec_mean": 0.005330562679562715, "episode_len_mean": 20.0, "module_episode_returns_mean": {"default_policy": 4.579999999999998}, "weights_seq_no": 16.0, "env_to_module_sum_episodes_length_out": 10.36823839457432, "num_env_steps_sampled_lifetime": -9252500.0, "episode_len_max": 20, "rlmodule_inference_timer": 3.2221645577376254e-05, "num_agent_steps_sampled": {"default_agent": 5000.0}, "env_reset_timer": 4.85063354313472e-05, "agent_episode_returns_mean": {"default_agent": 4.579999999999998}, "env_to_module_sum_episodes_length_in": 10.36823839457432, "episode_return_mean": 4.579999999999998, "time_between_sampling": 0.037078235598803605, "num_module_steps_sampled_lifetime": {"default_policy": -9252500.0}, "num_module_steps_sampled": {"default_policy": 5000.0}, "num_episodes_lifetime": -462625.0, "episode_return_min": -7.5, "sample": 0.006219098760704734, "num_env_steps_sampled_lifetime_throughput": 3173.006989673718}, "__all_modules__": {"learner_connector_sum_episodes_length_in": 5000.0, "learner_connector": {"connector_pipeline_timer": 0.140857654917758, "timers": {"connectors": {"add_one_ts_to_episodes_and_truncate": 0.009893786621871696, "add_observations_from_episodes_to_batch": 0.0010283144037656641, "add_columns_from_episodes_to_train_batch": 0.044465547797718, "add_time_dim_to_batch_and_zero_pad": 0.07713190217422564, "add_states_from_episodes_to_batch": 0.0036786739901602827, "batch_individual_items": 0.004398166369366184, "numpy_to_tensor": 7.396561835520301e-05}}}, "learner_connector_sum_episodes_length_out": 5250.0}, "learners": {"__all_modules__": {"num_module_steps_trained_lifetime": 203490, "num_env_steps_trained": 33000, "num_env_steps_trained_lifetime": 561000, "num_non_trainable_parameters": 0, "num_trainable_parameters": 24861, "num_module_steps_trained": 11970, "num_env_steps_trained_lifetime_throughput": 3919.375057231942, "num_module_steps_trained_throughput": 21095284.19738475, "num_module_steps_trained_lifetime_throughput": 12480320.369435675}, "default_policy": {"curr_entropy_coeff": 0.0015431216992, "weights_seq_no": 17.0, "curr_kl_coeff": 1.2327875538176158e-06, "policy_loss": -0.00023140470148064196, "module_train_batch_size_mean": 997.6777629636601, "num_trainable_parameters": 16595, "vf_loss": 0.3583082854747772, "mean_kl_loss": 2.9423817977658473e-05, "diff_num_grad_updates_vs_sampler_policy": 1.0, "vf_explained_var": -0.0008516311645507812, "use_intrinsic_rewards": 0.0, "entropy": 0.6758696436882019, "num_module_steps_trained": 5985, "vf_loss_unclipped": 44.13572692871094, "total_loss": 0.2778661251068115, "num_module_steps_trained_lifetime": 101745, "num_module_steps_trained_lifetime_throughput": 710.6519613165046}, "differentiable_learners": {"intrinsic_attention_ppo_learner": {"__all_modules__": {"num_module_steps_trained_lifetime": 1220940, "num_env_steps_trained_lifetime": 3366000, "num_module_steps_trained": 71820, "num_env_steps_trained": 198000, "num_env_steps_trained_lifetime_throughput": 43267.855616418616}, "default_policy": {"weights_seq_no": 102.0, "policy_loss": -0.0002267252712044865, "module_train_batch_size_mean": 997.498558675304, "vf_loss": 0.35831567645072937, "mean_kl_loss": 2.8288854082347825e-05, "diff_num_grad_updates_vs_sampler_policy": 86.0, "vf_explained_var": 0.0030219554901123047, "use_intrinsic_rewards": 1.0, "entropy": 0.6758975386619568, "num_module_steps_trained": 35910, "vf_loss_unclipped": 44.0786018371582, "total_loss": 0.27788102626800537, "num_module_steps_trained_lifetime": 610470}, "intrinsic_reward_module": {"total_loss": 0.0, "num_module_steps_trained_lifetime": 610470, "module_train_batch_size_mean": 997.498558675304, "weights_seq_no": 102.0, "num_module_steps_trained": 35910, "diff_num_grad_updates_vs_sampler_policy": 86.0}}}, "intrinsic_reward_module": {"diff_num_grad_updates_vs_sampler_policy": 1.0, "gradients_default_optimizer_global_norm": 0.0, "curr_entropy_coeff": 0.0015431216992, "weights_seq_no": 17.0, "default_optimizer_learning_rate": 0.0002715581955, "total_loss": 0.0, "num_module_steps_trained_lifetime": 101745, "module_train_batch_size_mean": 997.6777629636601, "num_trainable_parameters": 8266, "num_module_steps_trained": 5985, "num_module_steps_trained_lifetime_throughput": 710.6573733455781}, "IntrinsicAttentionMask": [[[0.0915374830365181, 0.08996199816465378, 0.09133949130773544, 0.09124065935611725, 0.09114193171262741, 0.09215175360441208, 0.09056569635868073, 0.09084638208150864, 0.09185293316841125, 0.09027202427387238, 0.08908967673778534], [0.0913773849606514, 0.09020361304283142, 0.09123016148805618, 0.09115663915872574, 0.09108317643404007, 0.09183362871408463, 0.09065399318933487, 0.09086313843727112, 0.09161178022623062, 0.09043499827384949, 0.08955145627260208], [0.09151753783226013, 0.08999213576316833, 0.09132587909698486, 0.09123020619153976, 0.09113463014364243, 0.09211204946041107, 0.09057673811912537, 0.09084850549697876, 0.09182285517454147, 0.09029236435890198, 0.0891471728682518], [0.09150755405426025, 0.09000719338655472, 0.09131906926631927, 0.09122497588396072, 0.09113097190856934, 0.09209219366312027, 0.09058225154876709, 0.09084955602884293, 0.09180780500173569, 0.09030252695083618, 0.08917592465877533], [0.09149757027626038, 0.0900222584605217, 0.09131225198507309, 0.09121973812580109, 0.09112731367349625, 0.09207234531641006, 0.09058776497840881, 0.09085060656070709, 0.0917927697300911, 0.09031268954277039, 0.08920469135046005], [0.09159909188747406, 0.0898689553141594, 0.0913815051317215, 0.09127290546894073, 0.09116443246603012, 0.09227445721626282, 0.09053155779838562, 0.09083978831768036, 0.09194586426019669, 0.09020917117595673, 0.08891228586435318], [0.09143908321857452, 0.09011051803827286, 0.09127231687307358, 0.09118904918432236, 0.0911058634519577, 0.09195610880851746, 0.0906200259923935, 0.09085673838853836, 0.09170465916395187, 0.090372234582901, 0.08937333524227142], [0.09146762639284134, 0.09006746113300323, 0.09129181504249573, 0.09120403975248337, 0.09111633896827698, 0.09201281517744064, 0.09060429781675339, 0.09085375815629959, 0.09174764901399612, 0.09034319221973419, 0.0892910286784172], [0.09156917780637741, 0.08991413563489914, 0.09136110544204712, 0.091257244348526, 0.09115350991487503, 0.09221485257148743, 0.09054814279079437, 0.09084299951791763, 0.09190072864294052, 0.09023969620466232, 0.08899839222431183], [0.09140913188457489, 0.09015572816133499, 0.09125185757875443, 0.09117332100868225, 0.09109485894441605, 0.09189662337303162, 0.09063653647899628, 0.09085986763238907, 0.0916595607995987, 0.09040272235870361, 0.08945980668067932], [0.09128742665052414, 0.0903392806649208, 0.09116862714290619, 0.09110929071903229, 0.09104999154806137, 0.09165533632040024, 0.09070336818695068, 0.09087231755256653, 0.09147648513317108, 0.09052637219429016, 0.08981145918369293]], [[0.09078126400709152, 0.08879368752241135, 0.09005004912614822, 0.08854886144399643, 0.08842670917510986, 0.09155876934528351, 0.0900324285030365, 0.09130632877349854, 0.10557592660188675, 0.09035476297140121, 0.0845712348818779], [0.09082784503698349, 0.08923391252756119, 0.09024227410554886, 0.08903709053993225, 0.08893883973360062, 0.09144945442676544, 0.09022814780473709, 0.09124773740768433, 0.10248459130525589, 0.09048640727996826, 0.08582372963428497], [0.09079953283071518, 0.08895548433065414, 0.09012147039175034, 0.08872812986373901, 0.08861467987298965, 0.09152007848024368, 0.09010511636734009, 0.09128617495298386, 0.10443736612796783, 0.09040407836437225, 0.08502784371376038], [0.0908329039812088, 0.08928823471069336, 0.09026552736759186, 0.08909743279218674, 0.08900218456983566, 0.09143506735563278, 0.09025184065103531, 0.09123968333005905, 0.10210459679365158, 0.09050209075212479, 0.08598052710294724], [0.09083536267280579, 0.08931533992290497, 0.09027709066867828, 0.0891275480389595, 0.08903380483388901, 0.09142781049013138, 0.09026361256837845, 0.09123557806015015, 0.10191504657268524, 0.09050986170768738, 0.08605896681547165], [0.09076041728258133, 0.0886218324303627, 0.08997321873903275, 0.08835865557193756, 0.08822737634181976, 0.09159797430038452, 0.08995425701141357, 0.09132596850395203, 0.10678811371326447, 0.09030120074748993, 0.0840909332036972], [0.0907999649643898, 0.08895939588546753, 0.09012319147586823, 0.08873247355222702, 0.08861922472715378, 0.09151913225650787, 0.09010687470436096, 0.09128568321466446, 0.10440995544195175, 0.09040526300668716, 0.0850389152765274], [0.09076733887195587, 0.08867760747671127, 0.0899982675909996, 0.08842036873102188, 0.08829202502965927, 0.09158545732498169, 0.08997973054647446, 0.09131978452205658, 0.10639435797929764, 0.0903187096118927, 0.08424629271030426], [0.0901622399687767, 0.08556210249662399, 0.08845371752977371, 0.08500508219003677, 0.0847279280424118, 0.09199965000152588, 0.08841276168823242, 0.09140072017908096, 0.12886473536491394, 0.0891633927822113, 0.0762476995587349], [0.09079208225011826, 0.08888804167509079, 0.09009180963039398, 0.08865338563919067, 0.08853628486394882, 0.09153641015291214, 0.09007492661476135, 0.0912947729229927, 0.10491164773702621, 0.09038364887237549, 0.08483698964118958], [0.09089291840791702, 0.09017326682806015, 0.09062935411930084, 0.09008391201496124, 0.09003927558660507, 0.09117168933153152, 0.09062298387289047, 0.09108134359121323, 0.0959564819931984, 0.09073935449123383, 0.08860943466424942]], [[0.08836888521909714, 0.09037637710571289, 0.09142700582742691, 0.09135174751281738, 0.09015338122844696, 0.09204474836587906, 0.09196898341178894, 0.09105134755373001, 0.09181763976812363, 0.09061316400766373, 0.09082669019699097], [0.0869455337524414, 0.09006863087415695, 0.09171903878450394, 0.0916004553437233, 0.0897197425365448, 0.09269450604915619, 0.09257466346025467, 0.0911276713013649, 0.09233544766902924, 0.09043964743614197, 0.09077468514442444], [0.08622079342603683, 0.08990930765867233, 0.09186823666095734, 0.09172726422548294, 0.08949604630470276, 0.09302917122840881, 0.09288641810417175, 0.09116555005311966, 0.09260157495737076, 0.09034910053014755, 0.09074652940034866], [0.08627226203680038, 0.08992067724466324, 0.09185762703418732, 0.09171825647354126, 0.08951200544834137, 0.09300532191991806, 0.09286420792341232, 0.09116288274526596, 0.09258262813091278, 0.09035557508468628, 0.09074856340885162], [0.08710111677646637, 0.09010260552167892, 0.09168706089258194, 0.09157325327396393, 0.08976751565933228, 0.09262301027774811, 0.09250804781913757, 0.09111945331096649, 0.09227854013442993, 0.09045889228582382, 0.0907805860042572], [0.08580092340707779, 0.08981617540121078, 0.09195483475923538, 0.09180078655481339, 0.08936554938554764, 0.09322426468133926, 0.09306809306144714, 0.09118719398975372, 0.09275653958320618, 0.0902959480881691, 0.09072969108819962], [0.08585217595100403, 0.08982757478952408, 0.09194426238536835, 0.09179181605577469, 0.08938151597976685, 0.09320040792226791, 0.09304588288068771, 0.09118456393480301, 0.0927376002073288, 0.0903024673461914, 0.09073176980018616], [0.08647837489843369, 0.08996613323688507, 0.09181516617536545, 0.09168218076229095, 0.08957578241825104, 0.09290992468595505, 0.09277535229921341, 0.09115216135978699, 0.09250679612159729, 0.0903814509510994, 0.09075666218996048], [0.08595475554466248, 0.08985037356615067, 0.09192309528589249, 0.0917738527059555, 0.08941344171762466, 0.09315268695354462, 0.09300144761800766, 0.09117929637432098, 0.09269970655441284, 0.09031548351049423, 0.09073590487241745], [0.08678101003170013, 0.09003262221813202, 0.09175287187099457, 0.09162923693656921, 0.0896691381931305, 0.09277024865150452, 0.09264523535966873, 0.09113632887601852, 0.09239570796489716, 0.0904192253947258, 0.09076838940382004], [0.08663324266672134, 0.0900001972913742, 0.09178328514099121, 0.09165508300065994, 0.0896236002445221, 0.09283839166164398, 0.09270871430635452, 0.09114407747983932, 0.09244991838932037, 0.0904008150100708, 0.09076268970966339]], [[0.09265691041946411, 0.09257420152425766, 0.09217343479394913, 0.09117648005485535, 0.09232651442289352, 0.09192682057619095, 0.09093253314495087, 0.09176278114318848, 0.08255816251039505, 0.09114299714565277, 0.09076913446187973], [0.09262366592884064, 0.09254258126020432, 0.09214966744184494, 0.09117210656404495, 0.09229975193738937, 0.09190787374973297, 0.09093286842107773, 0.09174702316522598, 0.0827125832438469, 0.09113927185535431, 0.09077262133359909], [0.09246186167001724, 0.09238865971565247, 0.09203383326530457, 0.09115040302276611, 0.0921693816781044, 0.09181540459394455, 0.09093407541513443, 0.09167007356882095, 0.08346647769212723, 0.09112071990966797, 0.09078913927078247], [0.09205430001020432, 0.09200072288513184, 0.09174089878797531, 0.09109285473823547, 0.09184020012617111, 0.091580830514431, 0.0909339040517807, 0.0914742648601532, 0.08538354188203812, 0.09107104688882828, 0.09082735329866409], [0.09252380579710007, 0.09244759380817413, 0.09207820892333984, 0.09115879237651825, 0.09221932291984558, 0.09185085445642471, 0.09093370288610458, 0.09169959276914597, 0.08317739516496658, 0.0911279022693634, 0.09078291058540344], [0.09236172586679459, 0.09229337424039841, 0.09196201711893082, 0.09113665670156479, 0.09208860993385315, 0.09175799041986465, 0.09093446284532547, 0.09162222594022751, 0.08393511921167374, 0.09110891073942184, 0.09079898148775101], [0.09195347130298615, 0.09190470725297928, 0.09166818112134933, 0.09107798337936401, 0.09175858646631241, 0.09152243286371231, 0.0909331738948822, 0.09142538905143738, 0.08586188405752182, 0.09105812013149261, 0.09083608537912369], [0.09229486435651779, 0.09222973883152008, 0.09191400557756424, 0.09112732857465744, 0.09203463792800903, 0.09171957522630692, 0.09093455970287323, 0.09159018099308014, 0.0842488631606102, 0.09110087901353836, 0.09080538153648376], [0.0881972461938858, 0.08831502497196198, 0.0888894572854042, 0.09034578502178192, 0.0886693000793457, 0.08924603462219238, 0.09070820361375809, 0.0894845500588417, 0.10479670017957687, 0.09039538353681564, 0.0909523218870163], [0.09204050153493881, 0.09198758751153946, 0.09173095971345901, 0.0910908430814743, 0.09182903170585632, 0.0915728509426117, 0.09093382954597473, 0.09146758913993835, 0.0854489803314209, 0.0910693034529686, 0.09082858264446259], [0.09188567847013474, 0.09184014052152634, 0.09161923080682755, 0.091067835688591, 0.09170366823673248, 0.09148308634757996, 0.09093251079320908, 0.09139242768287659, 0.08618435263633728, 0.09104927629232407, 0.09084177762269974]], [[0.08886881172657013, 0.09088766574859619, 0.09081285446882248, 0.09073810279369354, 0.09179294109344482, 0.09256547689437866, 0.09135118871927261, 0.09043971449136734, 0.09120086580514908, 0.09112579375505447, 0.09021656960248947], [0.08772056549787521, 0.09087150543928146, 0.09075401723384857, 0.09063668549060822, 0.0922974944114685, 0.09352078288793564, 0.09160064905881882, 0.09016887098550797, 0.09136394411325455, 0.09124582260847092, 0.08981960266828537], [0.08776246011257172, 0.0908721536397934, 0.09075623750686646, 0.09064046293497086, 0.09227901697158813, 0.09348565340042114, 0.09159155189990997, 0.09017884731292725, 0.09135802090167999, 0.09124148637056351, 0.08983418345451355], [0.08780433982610703, 0.09087278693914413, 0.09075842797756195, 0.0906442180275917, 0.09226050972938538, 0.09345050901174545, 0.09158243238925934, 0.09018880128860474, 0.09135208278894424, 0.09123712033033371, 0.08984874188899994], [0.08721780776977539, 0.09086347371339798, 0.09072718024253845, 0.09059108048677444, 0.0925200879573822, 0.0939444825053215, 0.09171001613140106, 0.09004874527454376, 0.09143509715795517, 0.0912979319691658, 0.08964412659406662], [0.08679448813199997, 0.09085623919963837, 0.09070403128862381, 0.09055209159851074, 0.0927082747220993, 0.09430379420518875, 0.09180215001106262, 0.08994683623313904, 0.0914948433637619, 0.09134157001972198, 0.08949556201696396], [0.08746222406625748, 0.09086745232343674, 0.09074030816555023, 0.09061335027217865, 0.09241174906492233, 0.09373808652162552, 0.09165684133768082, 0.0901072695851326, 0.09140052646398544, 0.09127263724803925, 0.08972956240177155], [0.08797209709882736, 0.09087531268596649, 0.09076721221208572, 0.0906592383980751, 0.09218654036521912, 0.09331008046865463, 0.09154597669839859, 0.09022863209247589, 0.09132830798625946, 0.09121966361999512, 0.08990702033042908], [0.08754580467939377, 0.09086878597736359, 0.09074477106332779, 0.09062092751264572, 0.0923747718334198, 0.09366770088672638, 0.09163866937160492, 0.09012722969055176, 0.09138870239257812, 0.09126397967338562, 0.08975871652364731], [0.08758760243654251, 0.09086943417787552, 0.09074698388576508, 0.09062469750642776, 0.09235627204179764, 0.09363251179456711, 0.09162956476211548, 0.09013719856739044, 0.09138277918100357, 0.09125963598489761, 0.08977328985929489], [0.08809807151556015, 0.09087715297937393, 0.09077373892068863, 0.09067045152187347, 0.09213104844093323, 0.09320484101772308, 0.0915185883641243, 0.09025845676660538, 0.09131042659282684, 0.09120652824640274, 0.08995068818330765]], [[0.0922100767493248, 0.09212777018547058, 0.09296892583370209, 0.09073678404092789, 0.09065578877925873, 0.09272018074989319, 0.09049401432275772, 0.0925547331571579, 0.08327067643404007, 0.0919295996427536, 0.09033140540122986], [0.09218551218509674, 0.09210480749607086, 0.09292945265769958, 0.09074081480503082, 0.09066137671470642, 0.09268561005592346, 0.09050271660089493, 0.09252340346574783, 0.0834125205874443, 0.09191051125526428, 0.09034322202205658], [0.09243456274271011, 0.09233744442462921, 0.09333066642284393, 0.09069852530956268, 0.09060323238372803, 0.09303679317235947, 0.090412937104702, 0.09284138679504395, 0.08197902888059616, 0.09210368245840073, 0.09022172540426254], [0.09176371991634369, 0.09171031415462494, 0.09225528687238693, 0.0908052995800972, 0.09075246006250381, 0.0920943170785904, 0.09064685553312302, 0.09198715537786484, 0.08586227893829346, 0.09158167243003845, 0.09054064750671387], [0.09173876792192459, 0.09168696403503418, 0.09221561253070831, 0.09080884605646133, 0.09075756371021271, 0.09205947071313858, 0.09065508097410202, 0.0919555202126503, 0.08600806444883347, 0.09156215935945511, 0.09055200219154358], [0.09236137568950653, 0.09226910024881363, 0.09321252256631851, 0.09071128070354462, 0.09062065929174423, 0.09293343871831894, 0.09043967723846436, 0.09274784475564957, 0.08239925652742386, 0.09204699844121933, 0.09025780856609344], [0.09168878942728043, 0.0916401743888855, 0.09213621914386749, 0.09081581979990005, 0.09076766669750214, 0.09198971837759018, 0.09067142754793167, 0.09189219027757645, 0.08630027621984482, 0.09152303636074066, 0.09057462215423584], [0.09231247752904892, 0.09222343564033508, 0.09313370287418365, 0.09071964770555496, 0.09063214063644409, 0.09286446124315262, 0.09045737981796265, 0.09268539398908615, 0.08268048614263535, 0.09200908243656158, 0.09028173983097076], [0.0892641469836235, 0.08936018496751785, 0.08838755637407303, 0.09101222455501556, 0.09111014753580093, 0.08867315202951431, 0.09130629897117615, 0.08886405825614929, 0.10092579573392868, 0.08959218114614487, 0.09150424599647522], [0.09212617576122284, 0.09204936027526855, 0.0928342267870903, 0.09075041860342026, 0.0906747505068779, 0.09260217845439911, 0.09052358567714691, 0.09244780242443085, 0.08375540375709534, 0.09186438471078873, 0.09037162363529205], [0.09163838624954224, 0.09159297496080399, 0.09205623716115952, 0.09082275629043579, 0.09077773988246918, 0.0919194445014, 0.09068778902292252, 0.091828353703022, 0.08659543842077255, 0.09148356318473816, 0.09059730172157288]]]}, "num_training_step_calls_per_iteration": 1, "evaluation": {"env_runners": {"episode_len_max": 20, "rlmodule_inference_timer": 3.332269253142289e-05, "num_module_steps_sampled": {"default_policy": 400}, "sample": 0.16706427786143138, "env_to_module_connector": {"timers": {"connectors": {"add_states_from_episodes_to_batch": 2.8887854104013975e-06, "add_time_dim_to_batch_and_zero_pad": 6.982966283410579e-06, "add_observations_from_episodes_to_batch": 2.8987229260446495e-06, "numpy_to_tensor": 1.25978278655376e-05, "batch_individual_items": 1.2500292898687818e-05}}, "connector_pipeline_timer": 6.0256892452736305e-05}, "module_episode_returns_mean": {"default_policy": 0.35}, "module_to_env_connector": {"timers": {"connectors": {"normalize_and_clip_actions": 8.06466065615917e-06, "remove_single_ts_time_rank_from_batch": 1.1950762980509375e-05, "tensor_to_numpy": 1.574471958220755e-05, "listify_data_for_vector_env": 1.04807138648076e-05, "un_batch_to_individual_items": 6.680188764682265e-06, "get_actions": 3.992713507320987e-05}}, "connector_pipeline_timer": 0.00012004409136563934}, "episode_duration_sec_mean": 0.005481823750305921, "weights_seq_no": 17.0, "env_to_module_sum_episodes_length_out": 10.368238394574323, "agent_episode_returns_mean": {"default_agent": 0.35}, "episode_return_mean": 0.35, "env_to_module_sum_episodes_length_in": 10.368238394574323, "num_episodes_lifetime": 340, "num_agent_steps_sampled_lifetime": {"default_agent": 6800}, "num_episodes": 20, "episode_len_mean": 20.0, "num_agent_steps_sampled": {"default_agent": 400}, "num_module_steps_sampled_lifetime": {"default_policy": 6800}, "env_reset_timer": 0.002144768356857506, "episode_return_min": -16.5, "num_env_steps_sampled": 400, "episode_len_min": 20, "episode_return_max": 12.5, "env_step_timer": 1.4566648873586044e-05, "num_env_steps_sampled_lifetime": 85400, "time_between_sampling": 10.825958215475088}, "num_healthy_workers": 1, "actor_manager_num_outstanding_async_reqs": 0, "num_remote_worker_restarts": 0}, "num_env_steps_sampled_lifetime": -9252500.0, "fault_tolerance": {"num_healthy_workers": 0, "num_remote_worker_restarts": 0}, "env_runner_group": {"actor_manager_num_outstanding_async_reqs": 0}, "done": false, "training_iteration": 17, "trial_id": "b154b_00000", "date": "2025-08-11_18-14-17", "timestamp": 1754928857, "time_this_iter_s": 9.558701992034912, "time_total_s": 172.26887392997742, "pid": 10455, "hostname": "Mac", "node_ip": "127.0.0.1", "config": {"exploration_config": {}, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 2, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "env": "Umbrella", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": false, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 0, "create_local_env_runner": true, "num_envs_per_env_runner": 1, "gym_env_vectorize_mode": "SYNC", "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "episodes_to_numpy": true, "max_requests_in_flight_per_env_runner": 1, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "merge_env_runner_states": "training_only", "broadcast_env_runner_states": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "complete_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "sampler_perf_stats_ema_coef": null, "_is_online": true, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": "auto", "num_aggregator_actors_per_learner": 0, "max_requests_in_flight_per_aggregator_actor": 3, "local_gpu_idx": 0, "max_requests_in_flight_per_learner": 3, "gamma": 1, "lr": 0.0002715581955, "grad_clip": 0.5, "grad_clip_by": "global_norm", "_train_batch_size_per_learner": 5000, "train_batch_size": 4000, "num_epochs": 1, "minibatch_size": 1000, "shuffle_batch_per_epoch": true, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "log_std_clip_param": 20.0, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "_disable_preprocessor_api": false, "_disable_action_flattening": false}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {"intrinsic_reward_coeff": 0.2795015916508}, "optimizer": {}, "_learner_class": "<class 'source.intrinsic_attention_ppo.learners.IntrinsicAttentionMetaLearner.IntrinsicAttentionMetaLearner'>", "callbacks_on_algorithm_init": null, "callbacks_on_env_runners_recreated": null, "callbacks_on_offline_eval_runners_recreated": null, "callbacks_on_checkpoint_loaded": null, "callbacks_on_environment_created": null, "callbacks_on_episode_created": null, "callbacks_on_episode_start": null, "callbacks_on_episode_step": null, "callbacks_on_episode_end": null, "callbacks_on_evaluate_start": null, "callbacks_on_evaluate_end": null, "callbacks_on_evaluate_offline_start": null, "callbacks_on_evaluate_offline_end": null, "callbacks_on_sample_end": null, "callbacks_on_train_result": null, "explore": true, "enable_rl_module_and_learner": true, "enable_env_runner_and_connector_v2": true, "_prior_exploration_config": {"type": "StochasticSampling"}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x1514e58a0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "offline_data_class": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_read_batch_size": null, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "materialize_data": false, "materialize_mapped_data": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "ignore_final_observation": false, "prelearner_class": null, "prelearner_buffer_class": null, "prelearner_buffer_kwargs": {}, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_remaining_data": false, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": 1, "evaluation_duration": 20, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_auto_duration_min_env_steps_per_sample": 100, "evaluation_auto_duration_max_env_steps_per_sample": 2000, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 1, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "offline_evaluation_interval": null, "num_offline_eval_runners": 0, "offline_loss_for_module_fn": null, "offline_evaluation_duration": 1, "offline_evaluation_parallel_to_training": false, "offline_evaluation_timeout_s": 120.0, "num_cpus_per_offline_eval_runner": 1, "num_gpus_per_offline_eval_runner": 0, "custom_resources_per_offline_eval_runner": {}, "restart_failed_offline_eval_runners": true, "ignore_offline_eval_runner_failures": false, "max_num_offline_eval_runner_restarts": 1000, "offline_eval_runner_restore_timeout_s": 1800.0, "max_requests_in_flight_per_offline_eval_runner": 1, "validate_offline_eval_runners_after_construction": true, "offline_eval_runner_health_probe_timeout_s": 30.0, "offline_eval_rl_module_inference_only": false, "broadcast_offline_eval_runner_states": false, "offline_eval_batch_size_per_runner": 256, "dataset_num_iters_per_eval_runner": 1, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "log_gradients": false, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 4, "restart_failed_env_runners": true, "ignore_env_runner_failures": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30.0, "env_runner_restore_timeout_s": 1800.0, "_model_config": {}, "_rl_module_spec": "MultiRLModuleSpec(multi_rl_module_class=<class 'ray.rllib.core.rl_module.multi_rl_module.MultiRLModule'>, observation_space=None, action_space=None, inference_only=False, model_config=None, rl_module_specs={'default_policy': RLModuleSpec(module_class=<class 'source.intrinsic_attention_ppo.rl_modules.DifferentiablePPOModule.DifferentiablePPOModule'>, observation_space=None, action_space=None, inference_only=False, learner_only=False, model_config={'vf_share_layers': True, 'embedding_dim': 62, 'max_seq_len': 11, 'policy_head_hidden_sizes': [32], 'value_head_hidden_sizes': [101], 'embedding_hidden_sizes': [121]}, catalog_class=None, load_state_path=None, model_config_dict=None), 'intrinsic_reward_module': RLModuleSpec(module_class=<class 'source.intrinsic_attention_ppo.rl_modules.IntrinsicAttentionModule.IntrinsicAttentionModule'>, observation_space=None, action_space=None, inference_only=False, learner_only=True, model_config={'intrinsic_reward_network': {'encoder_hidden_sizes': [], 'encoding_dim': 1, 'num_heads': 1, 'head_hidden_sizes': None, 'layers': [{'type': 'attention'}]}, 'extrinsic_value_hidden_layers': [127, 60], 'vf_share_layers': True, 'max_seq_len': 11}, catalog_class=None, load_state_path=None, model_config_dict=None)}, load_state_path=None, modules_to_load=None, module_specs={'default_policy': RLModuleSpec(module_class=<class 'source.intrinsic_attention_ppo.rl_modules.DifferentiablePPOModule.DifferentiablePPOModule'>, observation_space=None, action_space=None, inference_only=False, learner_only=False, model_config={'vf_share_layers': True, 'embedding_dim': 62, 'max_seq_len': 11, 'policy_head_hidden_sizes': [32], 'value_head_hidden_sizes': [101], 'embedding_hidden_sizes': [121]}, catalog_class=None, load_state_path=None, model_config_dict=None), 'intrinsic_reward_module': RLModuleSpec(module_class=<class 'source.intrinsic_attention_ppo.rl_modules.IntrinsicAttentionModule.IntrinsicAttentionModule'>, observation_space=None, action_space=None, inference_only=False, learner_only=True, model_config={'intrinsic_reward_network': {'encoder_hidden_sizes': [], 'encoding_dim': 1, 'num_heads': 1, 'head_hidden_sizes': None, 'layers': [{'type': 'attention'}]}, 'extrinsic_value_hidden_layers': [127, 60], 'vf_share_layers': True, 'max_seq_len': 11}, catalog_class=None, load_state_path=None, model_config_dict=None)})", "algorithm_config_overrides_per_module": {"intrinsic_reward_module": {"lr": 0.0002715581955}}, "_per_module_overrides": {}, "_validate_config": true, "_use_msgpack_checkpoints": false, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "env_task_fn": -1, "enable_connectors": -1, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.161583927863, "kl_target": 0.0201019014258, "vf_loss_coeff": 0.7790510010087, "entropy_coeff": 0.0015431216992, "clip_param": 0.2459212356676, "vf_clip_param": 0.3769744131561, "entropy_coeff_schedule": null, "lr_schedule": null, "sgd_minibatch_size": -1, "vf_share_layers": -1, "differentiable_learner_configs": ["DifferentiableLearnerConfig(learner_class=<class 'source.intrinsic_attention_ppo.learners.IntrinsicAttentionPPOLearner.IntrinsicAttentionPPOLearner'>, learner_connector=None, add_default_connectors_to_learner_pipeline=True, is_multi_agent=False, policies_to_update=['default_policy'], lr=0.0060984166342, num_total_minibatches=0, num_epochs=1, minibatch_size=1000, shuffle_batch_per_epoch=True)"], "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9485408017724, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.callbacks.callbacks.RLlibCallback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 172.26887392997742, "iterations_since_restore": 17, "perf": {"cpu_util_percent": 42.785714285714285, "ram_util_percent": 81.99285714285715}}
{"timers": {"training_iteration": 10.161533329745822, "restore_env_runners": 1.0451564479426604e-05, "training_step": 10.161329055066638, "env_runner_sampling_timer": 1.81825408889239, "learner_update_timer": 8.15776530334907, "synch_weights": 0.0015078818447158315, "restore_eval_env_runners": 7.317631557589353e-05, "evaluation_iteration": 0.20526992511416933, "synch_eval_env_connectors": 0.00021999186098441663, "synch_env_connectors": 5.072964560474866e-06}, "env_runners": {"num_env_steps_sampled": 5000.0, "episode_return_max": 12.5, "env_to_module_connector": {"timers": {"connectors": {"add_time_dim_to_batch_and_zero_pad": 9.222974334156416e-06, "add_observations_from_episodes_to_batch": 3.456794020672981e-06, "batch_individual_items": 1.707424513884588e-05, "numpy_to_tensor": 1.7328859266069793e-05, "add_states_from_episodes_to_batch": 3.51996974630726e-06}}, "connector_pipeline_timer": 7.780564634331339e-05}, "episode_len_min": 20, "module_to_env_connector": {"timers": {"connectors": {"un_batch_to_individual_items": 8.937145679263194e-06, "normalize_and_clip_actions": 1.0624212008769392e-05, "remove_single_ts_time_rank_from_batch": 1.4030552043230103e-05, "get_actions": 6.04475874467394e-05, "tensor_to_numpy": 2.0984834367947367e-05, "listify_data_for_vector_env": 1.4347185273088512e-05}}, "connector_pipeline_timer": 0.00016311520697455634}, "env_step_timer": 2.0289946748325778e-05, "num_agent_steps_sampled_lifetime": {"default_agent": -9870000.0}, "num_episodes": 250.0, "episode_duration_sec_mean": 0.00730525414459407, "episode_len_mean": 20.0, "module_episode_returns_mean": {"default_policy": 3.9399999999999995}, "weights_seq_no": 17.0, "env_to_module_sum_episodes_length_out": 10.36823839457432, "num_env_steps_sampled_lifetime": -9870000.0, "episode_len_max": 20, "rlmodule_inference_timer": 4.79451457046312e-05, "num_agent_steps_sampled": {"default_agent": 5000.0}, "env_reset_timer": 5.4254467018743996e-05, "agent_episode_returns_mean": {"default_agent": 3.9399999999999995}, "env_to_module_sum_episodes_length_in": 10.36823839457432, "episode_return_mean": 3.9399999999999995, "time_between_sampling": 0.033064569059446866, "num_module_steps_sampled_lifetime": {"default_policy": -9870000.0}, "num_module_steps_sampled": {"default_policy": 5000.0}, "num_episodes_lifetime": -493500.0, "episode_return_min": -7.5, "sample": 0.006853039257062581, "num_env_steps_sampled_lifetime_throughput": 2860.9467400062804}, "__all_modules__": {"learner_connector_sum_episodes_length_in": 5000.0, "learner_connector": {"connector_pipeline_timer": 0.14079245211798558, "timers": {"connectors": {"add_one_ts_to_episodes_and_truncate": 0.009889117506052331, "add_observations_from_episodes_to_batch": 0.0010263808390212883, "add_columns_from_episodes_to_train_batch": 0.04443623398990006, "add_time_dim_to_batch_and_zero_pad": 0.07710241940301021, "add_states_from_episodes_to_batch": 0.0036790551700583655, "batch_individual_items": 0.004398595125322898, "numpy_to_tensor": 7.403054222124026e-05}}}, "learner_connector_sum_episodes_length_out": 5250.0}, "learners": {"__all_modules__": {"num_module_steps_trained_lifetime": 215460, "num_env_steps_trained": 33000, "num_env_steps_trained_lifetime": 594000, "num_non_trainable_parameters": 0, "num_trainable_parameters": 24861, "num_module_steps_trained": 11970, "num_env_steps_trained_lifetime_throughput": 3915.679771647429, "num_module_steps_trained_throughput": 20593594.127367932, "num_module_steps_trained_lifetime_throughput": 12431005.211973285}, "default_policy": {"curr_entropy_coeff": 0.0015431216992, "weights_seq_no": 18.0, "curr_kl_coeff": 6.163937769088079e-07, "policy_loss": 3.6699880183732603e-06, "module_train_batch_size_mean": 997.6672132667843, "num_trainable_parameters": 16595, "vf_loss": 0.3583085238933563, "mean_kl_loss": 1.015934867609758e-05, "diff_num_grad_updates_vs_sampler_policy": 1.0, "vf_explained_var": -0.001123189926147461, "use_intrinsic_rewards": 0.0, "entropy": 0.6751720309257507, "num_module_steps_trained": 5985, "vf_loss_unclipped": 43.922149658203125, "total_loss": 0.27810245752334595, "num_module_steps_trained_lifetime": 107730, "num_module_steps_trained_lifetime_throughput": 709.9888453081509}, "differentiable_learners": {"intrinsic_attention_ppo_learner": {"__all_modules__": {"num_module_steps_trained_lifetime": 1292760, "num_env_steps_trained_lifetime": 3564000, "num_module_steps_trained": 71820, "num_env_steps_trained": 198000, "num_env_steps_trained_lifetime_throughput": 42711.352996124166}, "default_policy": {"weights_seq_no": 108.0, "policy_loss": 4.559598437481327e-06, "module_train_batch_size_mean": 997.4982334615715, "vf_loss": 0.35831668972969055, "mean_kl_loss": 1.0367088179918937e-05, "diff_num_grad_updates_vs_sampler_policy": 91.0, "vf_explained_var": 0.003038346767425537, "use_intrinsic_rewards": 1.0, "entropy": 0.6751633882522583, "num_module_steps_trained": 35910, "vf_loss_unclipped": 43.837493896484375, "total_loss": 0.2781113386154175, "num_module_steps_trained_lifetime": 646380}, "intrinsic_reward_module": {"total_loss": 0.0, "num_module_steps_trained_lifetime": 646380, "module_train_batch_size_mean": 997.4982334615715, "weights_seq_no": 108.0, "num_module_steps_trained": 35910, "diff_num_grad_updates_vs_sampler_policy": 91.0}}}, "intrinsic_reward_module": {"diff_num_grad_updates_vs_sampler_policy": 1.0, "gradients_default_optimizer_global_norm": 0.0, "curr_entropy_coeff": 0.0015431216992, "weights_seq_no": 18.0, "default_optimizer_learning_rate": 0.0002715581955, "total_loss": 0.0, "num_module_steps_trained_lifetime": 107730, "module_train_batch_size_mean": 997.6672132667843, "num_trainable_parameters": 8266, "num_module_steps_trained": 5985, "num_module_steps_trained_lifetime_throughput": 709.993899264456}, "IntrinsicAttentionMask": [[[0.09153509140014648, 0.08995964378118515, 0.08986230194568634, 0.09123826771974564, 0.0911395400762558, 0.09214933961629868, 0.09204962849617004, 0.08937716484069824, 0.09185052663087845, 0.09175113588571548, 0.0890873447060585], [0.09137606620788574, 0.09020231664180756, 0.09012962132692337, 0.09115532040596008, 0.09108186513185501, 0.09183230251073837, 0.09175829589366913, 0.08976702392101288, 0.09161045402288437, 0.09153662621974945, 0.08955016732215881], [0.09136612713336945, 0.09021743386983871, 0.09014628082513809, 0.09115011990070343, 0.09107822924852371, 0.09181253612041473, 0.09174012392759323, 0.08979136496782303, 0.09159547835588455, 0.09152323752641678, 0.08957907557487488], [0.09150537848472595, 0.0900050550699234, 0.0899123102426529, 0.09122280031442642, 0.09112880378961563, 0.09209000319242477, 0.09199511259794235, 0.08945003151893616, 0.09180562198162079, 0.09171102941036224, 0.0891738086938858], [0.09149546921253204, 0.09002018719911575, 0.08992898464202881, 0.09121764451265335, 0.09112522006034851, 0.09207022935152054, 0.09197694063186646, 0.08947432786226273, 0.09179066121578217, 0.09169765561819077, 0.0892026349902153], [0.09159620106220245, 0.08986611664295197, 0.08975932002067566, 0.09127002209424973, 0.09116155654191971, 0.09227154403924942, 0.0921618863940239, 0.08922722190618515, 0.09194295853376389, 0.0918336883187294, 0.08890947699546814], [0.09158632159233093, 0.08988126367330551, 0.08977599442005157, 0.09126488864421844, 0.09115800261497498, 0.09225176274776459, 0.092143714427948, 0.08925148844718933, 0.09192800521850586, 0.09182033687829971, 0.08893825858831406], [0.09131640940904617, 0.09029305726289749, 0.09022962301969528, 0.09112408012151718, 0.09106006473302841, 0.09171373397111893, 0.09164930135011673, 0.08991310745477676, 0.09152057021856308, 0.09145627170801163, 0.08972373604774475], [0.0915665328502655, 0.08991154283285141, 0.08980932831764221, 0.09125461429357529, 0.09115087985992432, 0.09221219271421432, 0.0921073704957962, 0.08930002152919769, 0.09189807623624802, 0.09179360419511795, 0.08899582922458649], [0.09155663847923279, 0.08992668241262436, 0.08982600271701813, 0.09124947339296341, 0.09114731848239899, 0.09219241142272949, 0.0920891985297203, 0.08932429552078247, 0.0918831154704094, 0.09178024530410767, 0.089024618268013], [0.0912865698337555, 0.09033843129873276, 0.09027963876724243, 0.09110844135284424, 0.09104913473129272, 0.09165447950363159, 0.09159482270479202, 0.08998621255159378, 0.09147562831640244, 0.09141609072685242, 0.08981061726808548]], [[0.09242740273475647, 0.09234489500522614, 0.09194512665271759, 0.09095063805580139, 0.09209782630205154, 0.09293871372938156, 0.09070729464292526, 0.09277286380529404, 0.08235368132591248, 0.09091724455356598, 0.09054430574178696], [0.09239872545003891, 0.09231783449649811, 0.09192587435245514, 0.09095068275928497, 0.09207559376955032, 0.09289997816085815, 0.0907120332121849, 0.09273739904165268, 0.08251171559095383, 0.09091793745756149, 0.09055217355489731], [0.09225905686616898, 0.09218601137399673, 0.09183196723461151, 0.09095047414302826, 0.09196722507476807, 0.09271158277988434, 0.09073462337255478, 0.09256483614444733, 0.08328341692686081, 0.09092086553573608, 0.09059000015258789], [0.09190639853477478, 0.09185291826725006, 0.09159351140260696, 0.0909464955329895, 0.09169264137744904, 0.09223750978708267, 0.09078780561685562, 0.09213018417358398, 0.08524636179208755, 0.09092472493648529, 0.09068142622709274], [0.09231255203485489, 0.09223651140928268, 0.09186797589063644, 0.09095065295696259, 0.09200875461101532, 0.09278369694948196, 0.09072607755661011, 0.09263090044260025, 0.08298749476671219, 0.09091983735561371, 0.09057562798261642], [0.09260402619838715, 0.09251151978969574, 0.09206337481737137, 0.09094959497451782, 0.0922345295548439, 0.09317759424448013, 0.09067729115486145, 0.09299151599407196, 0.08138342946767807, 0.09091222286224365, 0.09049493819475174], [0.09181897342205048, 0.09177027642726898, 0.0915341004729271, 0.09094476699829102, 0.09162436425685883, 0.09212032705545425, 0.09080015867948532, 0.09202264994382858, 0.08573629707098007, 0.09092492610216141, 0.09070321172475815], [0.09254695475101471, 0.09245768189430237, 0.09202521294355392, 0.09095007181167603, 0.09219039231538773, 0.09310033172369003, 0.09068714082241058, 0.09292081743478775, 0.08169642090797424, 0.09091398864984512, 0.09051106125116348], [0.08851151168346405, 0.08862970769405365, 0.08920618891716003, 0.09066770225763321, 0.08898525685071945, 0.08778483420610428, 0.09103141725063324, 0.08801944553852081, 0.10517007857561111, 0.09071747213602066, 0.09127640724182129], [0.09189443290233612, 0.09184160083532333, 0.09158537536859512, 0.09094627946615219, 0.0916832983493805, 0.0922214537858963, 0.09078951179981232, 0.09211545437574387, 0.08531337231397629, 0.09092477709054947, 0.0906844288110733], [0.09176014363765717, 0.09171466529369354, 0.09149406105279922, 0.09094342589378357, 0.09157837927341461, 0.09204156696796417, 0.09080827981233597, 0.09195035696029663, 0.08606661111116409, 0.09092488884925842, 0.09071766585111618]], [[0.09153895080089569, 0.09143989533185959, 0.08986609429121017, 0.08976884931325912, 0.09114338457584381, 0.09066525101661682, 0.09056714177131653, 0.09084783494472504, 0.09185440093278885, 0.09175501018762589, 0.09055323898792267], [0.09152892231941223, 0.09143145382404327, 0.08988264203071594, 0.08978692442178726, 0.09113968163728714, 0.0906691625714302, 0.09057261049747467, 0.09084884077310562, 0.09183930605649948, 0.09174150973558426, 0.09055893123149872], [0.091368168592453, 0.09129610657691956, 0.09014829993247986, 0.09007719904184341, 0.09108027070760727, 0.09073181450366974, 0.09066025912761688, 0.09086493402719498, 0.09159751981496811, 0.09152527898550034, 0.09065011143684387], [0.09135814756155014, 0.09128766506910324, 0.09016487747430801, 0.09009531885385513, 0.0910765528678894, 0.09073571860790253, 0.09066571295261383, 0.09086593240499496, 0.09158245474100113, 0.0915118008852005, 0.09065579622983932], [0.09149885922670364, 0.09140615165233612, 0.08993230760097504, 0.08984119445085526, 0.09112860262393951, 0.09068091213703156, 0.09058903902769089, 0.09085188806056976, 0.09179405868053436, 0.09170105308294296, 0.09057601541280746], [0.09145014733076096, 0.09136514365673065, 0.09001276642084122, 0.08992909640073776, 0.09111060202121735, 0.09069989621639252, 0.09061559289693832, 0.09085676819086075, 0.09172078222036362, 0.09163552522659302, 0.09060364961624146], [0.0914401262998581, 0.09135670959949493, 0.09002933651208878, 0.08994720131158829, 0.09110689908266068, 0.0907038077712059, 0.09062106162309647, 0.09085777401924133, 0.09170570969581604, 0.09162204712629318, 0.09060933440923691], [0.09146877378225327, 0.09138082712888718, 0.08998198807239532, 0.08989546447992325, 0.0911174863576889, 0.09069263935089111, 0.09060543030500412, 0.09085490554571152, 0.09174880385398865, 0.09166058152914047, 0.09059307724237442], [0.09157078713178635, 0.09146668761968613, 0.08981350064277649, 0.08971140533685684, 0.09115511178970337, 0.09065279364585876, 0.09054973721504211, 0.09084459394216537, 0.09190234541893005, 0.09179787337779999, 0.09053514152765274], [0.09156077355146408, 0.091458261013031, 0.08983005583286285, 0.08972948789596558, 0.09115142375230789, 0.09065672010183334, 0.09055522084236145, 0.09084562212228775, 0.09188725799322128, 0.09178438782691956, 0.09054083377122879], [0.09143870323896408, 0.09135550260543823, 0.09003167599439621, 0.08994976431131363, 0.0911063700914383, 0.09070435166358948, 0.09062182903289795, 0.09085791558027267, 0.09170356392860413, 0.09162012487649918, 0.09061013162136078]], [[0.09080854058265686, 0.09068326652050018, 0.09007710963487625, 0.09043323248624802, 0.09030847996473312, 0.09158627688884735, 0.08820939809083939, 0.09133375436067581, 0.10343813896179199, 0.0885251984000206, 0.084596648812294], [0.09081106632947922, 0.0906873494386673, 0.09008871018886566, 0.09044042229652405, 0.09031721949577332, 0.09157906472682953, 0.08824383467435837, 0.09132971614599228, 0.1032729521393776, 0.08855581283569336, 0.08467388898134232], [0.09082285314798355, 0.0907067209482193, 0.09014461934566498, 0.09047489613294601, 0.09035920351743698, 0.09154358506202698, 0.08841090649366379, 0.09130962193012238, 0.1024736538529396, 0.08870424330234528, 0.08504968136548996], [0.09081600606441498, 0.09069541096687317, 0.09011180698871613, 0.09045469760894775, 0.09033458679914474, 0.09156455099582672, 0.08831266313791275, 0.09132152795791626, 0.10294324904680252, 0.08861697465181351, 0.08482847362756729], [0.09081843495368958, 0.09069940447807312, 0.09012332558631897, 0.09046179801225662, 0.09034322947263718, 0.09155724942684174, 0.08834705501794815, 0.09131740033626556, 0.10277874767780304, 0.08864752948284149, 0.08490583300590515], [0.090792216360569, 0.0906573012471199, 0.09000474959611893, 0.09038809686899185, 0.0902537852525711, 0.09163006395101547, 0.08799619972705841, 0.09135796129703522, 0.1044636070728302, 0.08833558857440948, 0.08412039279937744], [0.09085474908351898, 0.09076231718063354, 0.0903145968914032, 0.09057773649692535, 0.090485580265522, 0.09142785519361496, 0.08893004804849625, 0.09124191105365753, 0.10001076012849808, 0.08916469663381577, 0.08622979372739792], [0.09079764038324356, 0.09066584706306458, 0.0900283083319664, 0.09040284901857376, 0.09027162939310074, 0.09161602705717087, 0.08806530386209488, 0.09135027229785919, 0.10413066297769547, 0.0883970707654953, 0.08427441865205765], [0.0904187336564064, 0.09014728665351868, 0.08884013444185257, 0.08960685133934021, 0.08933785557746887, 0.09211376309394836, 0.08487731218338013, 0.09156154096126556, 0.1200672909617424, 0.08554050326347351, 0.07748866081237793], [0.09084983170032501, 0.09075335413217545, 0.09028609842061996, 0.09056070446968079, 0.0904645323753357, 0.0914481058716774, 0.08884179592132568, 0.09125398099422455, 0.10042719542980194, 0.08908649533987045, 0.0860278531908989], [0.09089628607034683, 0.09085123986005783, 0.09063271433115005, 0.0907612144947052, 0.09071623533964157, 0.09117506444454193, 0.08995338529348373, 0.09108471125364304, 0.09524746984243393, 0.09006889164447784, 0.08861272037029266]], [[0.08816983550786972, 0.09129621833562851, 0.09122107177972794, 0.09114597737789154, 0.09107095748186111, 0.09183742105960846, 0.09176182746887207, 0.08972837775945663, 0.09161082655191422, 0.09153541922569275, 0.09062210470438004], [0.08580317348241806, 0.09163057804107666, 0.09148839861154556, 0.09134643524885178, 0.0912046954035759, 0.09265758842229843, 0.09251381456851959, 0.08868572860956192, 0.09222693741321564, 0.09208382666110992, 0.09035886079072952], [0.08585846424102783, 0.09162276983261108, 0.09148217737674713, 0.09134180098772049, 0.09120164066553116, 0.09263823181390762, 0.09249608218669891, 0.08871033787727356, 0.09221243113279343, 0.09207094460725784, 0.09036517888307571], [0.08591378480195999, 0.09161495417356491, 0.0914759486913681, 0.09133715182542801, 0.09119857102632523, 0.09261886775493622, 0.09247834235429764, 0.0887349396944046, 0.09219792485237122, 0.09205804765224457, 0.09037148952484131], [0.08596913516521454, 0.09160713106393814, 0.09146972000598907, 0.09133251011371613, 0.09119550883769989, 0.09259950369596481, 0.09246060252189636, 0.08875954151153564, 0.092183418571949, 0.0920451357960701, 0.0903777927160263], [0.08540722727775574, 0.09168649464845657, 0.09153290092945099, 0.0913795605301857, 0.0912264809012413, 0.09279650449752808, 0.09264105558395386, 0.08850919455289841, 0.0923309251666069, 0.09217625111341476, 0.0903133749961853], [0.0854623019695282, 0.09167871624231339, 0.09152671694755554, 0.0913749635219574, 0.09122346341609955, 0.09277715533971786, 0.09262333065271378, 0.08853378146886826, 0.09231644868850708, 0.09216338396072388, 0.09031973779201508], [0.08697276562452316, 0.09146536141633987, 0.0913565531373024, 0.09124787896871567, 0.09113933145999908, 0.09225010871887207, 0.09214037656784058, 0.08920367062091827, 0.09192129224538803, 0.09181194007396698, 0.09049077332019806], [0.08557253330945969, 0.09166315197944641, 0.09151432663202286, 0.091365747153759, 0.09121740609407425, 0.09273844957351685, 0.09258788079023361, 0.08858297020196915, 0.09228748083114624, 0.0921376422047615, 0.09033241868019104], [0.08562768995761871, 0.09165535867214203, 0.09150812029838562, 0.09136112779378891, 0.0912143662571907, 0.09271909296512604, 0.09257015585899353, 0.08860756456851959, 0.09227298945188522, 0.09212476015090942, 0.09033875167369843], [0.08630190044641495, 0.09156012535095215, 0.09143223613500595, 0.09130453318357468, 0.09117700159549713, 0.09248331189155579, 0.09235413372516632, 0.08890722692012787, 0.09209632128477097, 0.09196768701076508, 0.09041554480791092]], [[0.09104155004024506, 0.09098386019468307, 0.0924495980143547, 0.0917387455701828, 0.0916806161403656, 0.09227397292852402, 0.09156446903944016, 0.09215706586837769, 0.08468501269817352, 0.09084490686655045, 0.09058025479316711], [0.09103856235742569, 0.09098244458436966, 0.09240798652172089, 0.0917167067527771, 0.09166017174720764, 0.0922372043132782, 0.09154720604419708, 0.09212352335453033, 0.08484908193349838, 0.09084726870059967, 0.09058980643749237], [0.09110332280397415, 0.09100760519504547, 0.09345202893018723, 0.09226332604885101, 0.09216638654470444, 0.09315777570009232, 0.09197281301021576, 0.0929621160030365, 0.08079837262630463, 0.0907772108912468, 0.0903390422463417], [0.09107471257448196, 0.09099812060594559, 0.0929490402340889, 0.09200161695480347, 0.09192425012588501, 0.09271473437547684, 0.09176970273256302, 0.0925588607788086, 0.08273248374462128, 0.09081370383501053, 0.09046272188425064], [0.09107214957475662, 0.0909971296787262, 0.09290763735771179, 0.09197994321584702, 0.0919041708111763, 0.09267823398113251, 0.09175281971693039, 0.09252560883760452, 0.08289315551519394, 0.09081649035215378, 0.09047266840934753], [0.09109673649072647, 0.09100573509931564, 0.09332834184169769, 0.09219925850629807, 0.0921071469783783, 0.09304890781641006, 0.09192320704460144, 0.09286308288574219, 0.08127103745937347, 0.09078666567802429, 0.09036995470523834], [0.09106691181659698, 0.09099502861499786, 0.0928247720003128, 0.09193649142980576, 0.09186392277479172, 0.09260515123605728, 0.09171896427869797, 0.09245901554822922, 0.08321534097194672, 0.09082194417715073, 0.09049246460199356], [0.09109217673540115, 0.09100431203842163, 0.09324579685926437, 0.09215638786554337, 0.09206749498844147, 0.09297622740268707, 0.09188997000455856, 0.09279695153236389, 0.08158751577138901, 0.09079279750585556, 0.0903903990983963], [0.09046749770641327, 0.09058830887079239, 0.08759099990129471, 0.0890260562300682, 0.08914493024349213, 0.08794236928224564, 0.08938317745923996, 0.0881773978471756, 0.1053588017821312, 0.09088026732206345, 0.09144020080566406], [0.09103123843669891, 0.09097890555858612, 0.09230760484933853, 0.09166346490383148, 0.09161076694726944, 0.09214849770069122, 0.09150546044111252, 0.09204258024692535, 0.08524587750434875, 0.09085284173488617, 0.09061269462108612], [0.09101671725511551, 0.09097160398960114, 0.09211574494838715, 0.09156136214733124, 0.09151598811149597, 0.09197886288166046, 0.09142529964447021, 0.09188771992921829, 0.0860079750418663, 0.090862937271595, 0.0906558632850647]]]}, "num_training_step_calls_per_iteration": 1, "evaluation": {"env_runners": {"episode_len_max": 20, "rlmodule_inference_timer": 3.447362407792602e-05, "num_module_steps_sampled": {"default_policy": 400}, "sample": 0.16665084424248375, "env_to_module_connector": {"timers": {"connectors": {"add_states_from_episodes_to_batch": 3.056633820582577e-06, "add_time_dim_to_batch_and_zero_pad": 7.227278158992414e-06, "add_observations_from_episodes_to_batch": 2.956528254637018e-06, "numpy_to_tensor": 1.3656586725211897e-05, "batch_individual_items": 1.34964791114344e-05}}, "connector_pipeline_timer": 6.344509545180503e-05}, "module_episode_returns_mean": {"default_policy": -0.45}, "module_to_env_connector": {"timers": {"connectors": {"normalize_and_clip_actions": 8.71163319822874e-06, "remove_single_ts_time_rank_from_batch": 1.2153040173797162e-05, "tensor_to_numpy": 1.6726069212516342e-05, "listify_data_for_vector_env": 1.1021913859960882e-05, "un_batch_to_individual_items": 6.657234924419909e-06, "get_actions": 4.2182416908183395e-05}}, "connector_pipeline_timer": 0.00012571629470457482}, "episode_duration_sec_mean": 0.0054461945604998615, "weights_seq_no": 18.0, "env_to_module_sum_episodes_length_out": 10.368238394574323, "agent_episode_returns_mean": {"default_agent": -0.45}, "episode_return_mean": -0.45, "env_to_module_sum_episodes_length_in": 10.368238394574323, "num_episodes_lifetime": 360, "num_agent_steps_sampled_lifetime": {"default_agent": 7200}, "num_episodes": 20, "episode_len_mean": 20.0, "num_agent_steps_sampled": {"default_agent": 400}, "num_module_steps_sampled_lifetime": {"default_policy": 7200}, "env_reset_timer": 0.002127672333898176, "episode_return_min": -16.5, "num_env_steps_sampled": 400, "episode_len_min": 20, "episode_return_max": 12.5, "env_step_timer": 1.5071875401991346e-05, "num_env_steps_sampled_lifetime": 90400, "time_between_sampling": 10.819818186240676}, "num_healthy_workers": 1, "actor_manager_num_outstanding_async_reqs": 0, "num_remote_worker_restarts": 0}, "num_env_steps_sampled_lifetime": -9870000.0, "fault_tolerance": {"num_healthy_workers": 0, "num_remote_worker_restarts": 0}, "env_runner_group": {"actor_manager_num_outstanding_async_reqs": 0}, "done": false, "training_iteration": 18, "trial_id": "b154b_00000", "date": "2025-08-11_18-14-27", "timestamp": 1754928867, "time_this_iter_s": 10.31663203239441, "time_total_s": 182.58550596237183, "pid": 10455, "hostname": "Mac", "node_ip": "127.0.0.1", "config": {"exploration_config": {}, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 2, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "env": "Umbrella", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": false, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 0, "create_local_env_runner": true, "num_envs_per_env_runner": 1, "gym_env_vectorize_mode": "SYNC", "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "episodes_to_numpy": true, "max_requests_in_flight_per_env_runner": 1, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "merge_env_runner_states": "training_only", "broadcast_env_runner_states": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "complete_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "sampler_perf_stats_ema_coef": null, "_is_online": true, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": "auto", "num_aggregator_actors_per_learner": 0, "max_requests_in_flight_per_aggregator_actor": 3, "local_gpu_idx": 0, "max_requests_in_flight_per_learner": 3, "gamma": 1, "lr": 0.0002715581955, "grad_clip": 0.5, "grad_clip_by": "global_norm", "_train_batch_size_per_learner": 5000, "train_batch_size": 4000, "num_epochs": 1, "minibatch_size": 1000, "shuffle_batch_per_epoch": true, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "log_std_clip_param": 20.0, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "_disable_preprocessor_api": false, "_disable_action_flattening": false}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {"intrinsic_reward_coeff": 0.2795015916508}, "optimizer": {}, "_learner_class": "<class 'source.intrinsic_attention_ppo.learners.IntrinsicAttentionMetaLearner.IntrinsicAttentionMetaLearner'>", "callbacks_on_algorithm_init": null, "callbacks_on_env_runners_recreated": null, "callbacks_on_offline_eval_runners_recreated": null, "callbacks_on_checkpoint_loaded": null, "callbacks_on_environment_created": null, "callbacks_on_episode_created": null, "callbacks_on_episode_start": null, "callbacks_on_episode_step": null, "callbacks_on_episode_end": null, "callbacks_on_evaluate_start": null, "callbacks_on_evaluate_end": null, "callbacks_on_evaluate_offline_start": null, "callbacks_on_evaluate_offline_end": null, "callbacks_on_sample_end": null, "callbacks_on_train_result": null, "explore": true, "enable_rl_module_and_learner": true, "enable_env_runner_and_connector_v2": true, "_prior_exploration_config": {"type": "StochasticSampling"}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x1514e58a0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "offline_data_class": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_read_batch_size": null, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "materialize_data": false, "materialize_mapped_data": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "ignore_final_observation": false, "prelearner_class": null, "prelearner_buffer_class": null, "prelearner_buffer_kwargs": {}, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_remaining_data": false, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": 1, "evaluation_duration": 20, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_auto_duration_min_env_steps_per_sample": 100, "evaluation_auto_duration_max_env_steps_per_sample": 2000, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 1, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "offline_evaluation_interval": null, "num_offline_eval_runners": 0, "offline_loss_for_module_fn": null, "offline_evaluation_duration": 1, "offline_evaluation_parallel_to_training": false, "offline_evaluation_timeout_s": 120.0, "num_cpus_per_offline_eval_runner": 1, "num_gpus_per_offline_eval_runner": 0, "custom_resources_per_offline_eval_runner": {}, "restart_failed_offline_eval_runners": true, "ignore_offline_eval_runner_failures": false, "max_num_offline_eval_runner_restarts": 1000, "offline_eval_runner_restore_timeout_s": 1800.0, "max_requests_in_flight_per_offline_eval_runner": 1, "validate_offline_eval_runners_after_construction": true, "offline_eval_runner_health_probe_timeout_s": 30.0, "offline_eval_rl_module_inference_only": false, "broadcast_offline_eval_runner_states": false, "offline_eval_batch_size_per_runner": 256, "dataset_num_iters_per_eval_runner": 1, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "log_gradients": false, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 4, "restart_failed_env_runners": true, "ignore_env_runner_failures": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30.0, "env_runner_restore_timeout_s": 1800.0, "_model_config": {}, "_rl_module_spec": "MultiRLModuleSpec(multi_rl_module_class=<class 'ray.rllib.core.rl_module.multi_rl_module.MultiRLModule'>, observation_space=None, action_space=None, inference_only=False, model_config=None, rl_module_specs={'default_policy': RLModuleSpec(module_class=<class 'source.intrinsic_attention_ppo.rl_modules.DifferentiablePPOModule.DifferentiablePPOModule'>, observation_space=None, action_space=None, inference_only=False, learner_only=False, model_config={'vf_share_layers': True, 'embedding_dim': 62, 'max_seq_len': 11, 'policy_head_hidden_sizes': [32], 'value_head_hidden_sizes': [101], 'embedding_hidden_sizes': [121]}, catalog_class=None, load_state_path=None, model_config_dict=None), 'intrinsic_reward_module': RLModuleSpec(module_class=<class 'source.intrinsic_attention_ppo.rl_modules.IntrinsicAttentionModule.IntrinsicAttentionModule'>, observation_space=None, action_space=None, inference_only=False, learner_only=True, model_config={'intrinsic_reward_network': {'encoder_hidden_sizes': [], 'encoding_dim': 1, 'num_heads': 1, 'head_hidden_sizes': None, 'layers': [{'type': 'attention'}]}, 'extrinsic_value_hidden_layers': [127, 60], 'vf_share_layers': True, 'max_seq_len': 11}, catalog_class=None, load_state_path=None, model_config_dict=None)}, load_state_path=None, modules_to_load=None, module_specs={'default_policy': RLModuleSpec(module_class=<class 'source.intrinsic_attention_ppo.rl_modules.DifferentiablePPOModule.DifferentiablePPOModule'>, observation_space=None, action_space=None, inference_only=False, learner_only=False, model_config={'vf_share_layers': True, 'embedding_dim': 62, 'max_seq_len': 11, 'policy_head_hidden_sizes': [32], 'value_head_hidden_sizes': [101], 'embedding_hidden_sizes': [121]}, catalog_class=None, load_state_path=None, model_config_dict=None), 'intrinsic_reward_module': RLModuleSpec(module_class=<class 'source.intrinsic_attention_ppo.rl_modules.IntrinsicAttentionModule.IntrinsicAttentionModule'>, observation_space=None, action_space=None, inference_only=False, learner_only=True, model_config={'intrinsic_reward_network': {'encoder_hidden_sizes': [], 'encoding_dim': 1, 'num_heads': 1, 'head_hidden_sizes': None, 'layers': [{'type': 'attention'}]}, 'extrinsic_value_hidden_layers': [127, 60], 'vf_share_layers': True, 'max_seq_len': 11}, catalog_class=None, load_state_path=None, model_config_dict=None)})", "algorithm_config_overrides_per_module": {"intrinsic_reward_module": {"lr": 0.0002715581955}}, "_per_module_overrides": {}, "_validate_config": true, "_use_msgpack_checkpoints": false, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "env_task_fn": -1, "enable_connectors": -1, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.161583927863, "kl_target": 0.0201019014258, "vf_loss_coeff": 0.7790510010087, "entropy_coeff": 0.0015431216992, "clip_param": 0.2459212356676, "vf_clip_param": 0.3769744131561, "entropy_coeff_schedule": null, "lr_schedule": null, "sgd_minibatch_size": -1, "vf_share_layers": -1, "differentiable_learner_configs": ["DifferentiableLearnerConfig(learner_class=<class 'source.intrinsic_attention_ppo.learners.IntrinsicAttentionPPOLearner.IntrinsicAttentionPPOLearner'>, learner_connector=None, add_default_connectors_to_learner_pipeline=True, is_multi_agent=False, policies_to_update=['default_policy'], lr=0.0060984166342, num_total_minibatches=0, num_epochs=1, minibatch_size=1000, shuffle_batch_per_epoch=True)"], "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9485408017724, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.callbacks.callbacks.RLlibCallback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 182.58550596237183, "iterations_since_restore": 18, "perf": {"cpu_util_percent": 44.91428571428572, "ram_util_percent": 82.6214285714286}}
{"timers": {"training_iteration": 10.158880560197302, "restore_env_runners": 1.0408298427905144e-05, "training_step": 10.158675843265776, "env_runner_sampling_timer": 1.8167677955038333, "learner_update_timer": 8.156565944065687, "synch_weights": 0.0015056155266225757, "restore_eval_env_runners": 7.269747169172292e-05, "evaluation_iteration": 0.20458805961314336, "synch_eval_env_connectors": 0.00021934069223494856, "synch_env_connectors": 5.061814960138057e-06}, "env_runners": {"num_env_steps_sampled": 5000.0, "episode_return_max": 12.5, "env_to_module_connector": {"timers": {"connectors": {"add_time_dim_to_batch_and_zero_pad": 7.441253888319572e-06, "add_observations_from_episodes_to_batch": 2.9734198055443723e-06, "batch_individual_items": 1.3144850462658833e-05, "numpy_to_tensor": 1.3850504477982608e-05, "add_states_from_episodes_to_batch": 2.8628309432507913e-06}}, "connector_pipeline_timer": 6.374868448855754e-05}, "episode_len_min": 20, "module_to_env_connector": {"timers": {"connectors": {"un_batch_to_individual_items": 7.045864607518716e-06, "normalize_and_clip_actions": 8.51267229840597e-06, "remove_single_ts_time_rank_from_batch": 1.2493246119497513e-05, "get_actions": 4.349243541491948e-05, "tensor_to_numpy": 1.632127924007567e-05, "listify_data_for_vector_env": 1.1401430948962989e-05}}, "connector_pipeline_timer": 0.00012756285925545383}, "env_step_timer": 1.5150925126478032e-05, "num_agent_steps_sampled_lifetime": {"default_agent": -10487500.0}, "num_episodes": 250.0, "episode_duration_sec_mean": 0.005703297330997881, "episode_len_mean": 20.0, "module_episode_returns_mean": {"default_policy": 4.34}, "weights_seq_no": 18.0, "env_to_module_sum_episodes_length_out": 10.36823839457432, "num_env_steps_sampled_lifetime": -10487500.0, "episode_len_max": 20, "rlmodule_inference_timer": 3.4316278100607194e-05, "num_agent_steps_sampled": {"default_agent": 5000.0}, "env_reset_timer": 5.575720222666357e-05, "agent_episode_returns_mean": {"default_agent": 4.34}, "env_to_module_sum_episodes_length_in": 10.36823839457432, "episode_return_mean": 4.34, "time_between_sampling": 0.033441913754348636, "num_module_steps_sampled_lifetime": {"default_policy": -10487500.0}, "num_module_steps_sampled": {"default_policy": 5000.0}, "num_episodes_lifetime": -524375.0, "episode_return_min": -7.5, "sample": 0.0068801471544851335, "num_env_steps_sampled_lifetime_throughput": 3024.902521953617}, "__all_modules__": {"learner_connector_sum_episodes_length_in": 5000.0, "learner_connector": {"connector_pipeline_timer": 0.14072726134715835, "timers": {"connectors": {"add_one_ts_to_episodes_and_truncate": 0.009887807581584874, "add_observations_from_episodes_to_batch": 0.0010248749506355029, "add_columns_from_episodes_to_train_batch": 0.04440742498067769, "add_time_dim_to_batch_and_zero_pad": 0.07707346520866748, "add_states_from_episodes_to_batch": 0.003678155458584566, "batch_individual_items": 0.004395324594688322, "numpy_to_tensor": 7.40998168866896e-05}}}, "learner_connector_sum_episodes_length_out": 5250.0}, "learners": {"__all_modules__": {"num_module_steps_trained_lifetime": 227430, "num_env_steps_trained": 33000, "num_env_steps_trained_lifetime": 627000, "num_non_trainable_parameters": 0, "num_trainable_parameters": 24861, "num_module_steps_trained": 11970, "num_env_steps_trained_lifetime_throughput": 3911.483976077544, "num_module_steps_trained_throughput": 20124582.680023495, "num_module_steps_trained_lifetime_throughput": 12391985.417845534}, "default_policy": {"curr_entropy_coeff": 0.0015431216992, "weights_seq_no": 19.0, "curr_kl_coeff": 3.0819688845440396e-07, "policy_loss": -0.0002580670116003603, "module_train_batch_size_mean": 997.6572809365935, "num_trainable_parameters": 16595, "vf_loss": 0.35830721259117126, "mean_kl_loss": 2.769239836197812e-05, "diff_num_grad_updates_vs_sampler_policy": 1.0, "vf_explained_var": -0.0005419254302978516, "use_intrinsic_rewards": 0.0, "entropy": 0.6735947728157043, "num_module_steps_trained": 5985, "vf_loss_unclipped": 44.1192512512207, "total_loss": 0.27784207463264465, "num_module_steps_trained_lifetime": 113715, "num_module_steps_trained_lifetime_throughput": 709.2348227616058}, "differentiable_learners": {"intrinsic_attention_ppo_learner": {"__all_modules__": {"num_module_steps_trained_lifetime": 1364580, "num_env_steps_trained_lifetime": 3762000, "num_module_steps_trained": 71820, "num_env_steps_trained": 198000, "num_env_steps_trained_lifetime_throughput": 42171.76903108772}, "default_policy": {"weights_seq_no": 114.0, "policy_loss": -0.00025204310077242553, "module_train_batch_size_mean": 997.4980069784294, "vf_loss": 0.3583158254623413, "mean_kl_loss": 2.63609726971481e-05, "diff_num_grad_updates_vs_sampler_policy": 96.0, "vf_explained_var": 0.0030657052993774414, "use_intrinsic_rewards": 1.0, "entropy": 0.6736305356025696, "num_module_steps_trained": 35910, "vf_loss_unclipped": 44.0794677734375, "total_loss": 0.27785903215408325, "num_module_steps_trained_lifetime": 682290}, "intrinsic_reward_module": {"total_loss": 0.0, "num_module_steps_trained_lifetime": 682290, "module_train_batch_size_mean": 997.4980069784294, "weights_seq_no": 114.0, "num_module_steps_trained": 35910, "diff_num_grad_updates_vs_sampler_policy": 96.0}}}, "intrinsic_reward_module": {"diff_num_grad_updates_vs_sampler_policy": 1.0, "gradients_default_optimizer_global_norm": 0.0, "curr_entropy_coeff": 0.0015431216992, "weights_seq_no": 19.0, "default_optimizer_learning_rate": 0.0002715581955, "total_loss": 0.0, "num_module_steps_trained_lifetime": 113715, "module_train_batch_size_mean": 997.6572809365935, "num_trainable_parameters": 8266, "num_module_steps_trained": 5985, "num_module_steps_trained_lifetime_throughput": 709.2395437373451}, "IntrinsicAttentionMask": [[[0.09113436937332153, 0.09103576093912125, 0.09093724936246872, 0.09083884954452515, 0.09074056148529053, 0.09174593538045883, 0.09164666384458542, 0.09044630825519562, 0.08997184038162231, 0.09134947508573532, 0.09015302360057831], [0.0911308079957962, 0.09103376418352127, 0.09093683212995529, 0.09083998948335648, 0.09074326604604721, 0.09173257648944855, 0.09163489937782288, 0.09045369178056717, 0.08998670428991318, 0.09134247153997421, 0.09016504138708115], [0.09112723916769028, 0.09103177487850189, 0.09093639999628067, 0.0908411368727684, 0.0907459706068039, 0.09171921759843826, 0.09162313491106033, 0.09046106040477753, 0.09000158309936523, 0.0913354679942131, 0.09017705172300339], [0.09112367033958435, 0.09102977067232132, 0.09093597531318665, 0.09084227681159973, 0.09074866771697998, 0.09170585870742798, 0.0916113629937172, 0.09046843647956848, 0.0900164544582367, 0.091328464448452, 0.09018906950950623], [0.09112009406089783, 0.09102777391672134, 0.09093554317951202, 0.09084340929985046, 0.09075137227773666, 0.0916924998164177, 0.09159959852695465, 0.09047580510377884, 0.09003132581710815, 0.09132145345211029, 0.09020107239484787], [0.09115638583898544, 0.09104804694652557, 0.09093984216451645, 0.09083177149295807, 0.09072382003068924, 0.09182848036289215, 0.09171934425830841, 0.09040074795484543, 0.08987999707460403, 0.09139272570610046, 0.09007882326841354], [0.09115281701087952, 0.0910460576415062, 0.09093942493200302, 0.0908329114317894, 0.09072653204202652, 0.09181511402130127, 0.09170757979154587, 0.09040812402963638, 0.0898948609828949, 0.09138572961091995, 0.09009083360433578], [0.09110939502716064, 0.09102179110050201, 0.09093426913022995, 0.09084683656692505, 0.09075948596000671, 0.09165244549512863, 0.09156432002782822, 0.0904979333281517, 0.09007597714662552, 0.09130045026540756, 0.09023713320493698], [0.09109203517436981, 0.09101206809282303, 0.09093217551708221, 0.09085234999656677, 0.0907725915312767, 0.09158758819103241, 0.091507188975811, 0.09053374826908112, 0.09014829248189926, 0.09126640856266022, 0.09029553085565567], [0.09114213287830353, 0.09104008972644806, 0.09093816578388214, 0.09083635360002518, 0.09073466062545776, 0.09177502244710922, 0.09167227894067764, 0.09043024480342865, 0.08993945270776749, 0.09136472642421722, 0.09012686461210251], [0.09109867364168167, 0.09101579338312149, 0.09093297272920609, 0.09085024148225784, 0.09076758474111557, 0.09161239117383957, 0.09152903407812119, 0.09052004665136337, 0.09012062847614288, 0.09127943217754364, 0.09027319401502609]], [[0.09209761023521423, 0.09078811854124069, 0.0928555354475975, 0.09185120463371277, 0.09054522216320038, 0.09260709583759308, 0.09160545468330383, 0.09244184195995331, 0.0831691175699234, 0.0918174758553505, 0.09022122621536255], [0.09173621237277985, 0.09083361178636551, 0.0922568216919899, 0.09156667441129684, 0.09066573530435562, 0.0920863226056099, 0.09139744937419891, 0.09197282046079636, 0.08549930155277252, 0.09154345840215683, 0.09044161438941956], [0.09230189025402069, 0.09075896441936493, 0.09319671243429184, 0.09201125800609589, 0.09047318994998932, 0.0929032638669014, 0.0917215347290039, 0.09270814061164856, 0.08186136931180954, 0.0919714868068695, 0.09009222686290741], [0.09203044325113297, 0.09079717099666595, 0.09274378418922424, 0.09179845452308655, 0.09056829661130905, 0.09250999242067337, 0.09156704694032669, 0.09235446900129318, 0.08360067009925842, 0.09176669269800186, 0.09026295691728592], [0.09166795015335083, 0.09084132313728333, 0.0921444296836853, 0.09151273220777512, 0.09068750590085983, 0.09198840707540512, 0.09135778248310089, 0.0918845385313034, 0.08594167232513428, 0.09149148315191269, 0.09048210084438324], [0.09223531931638718, 0.0907687395811081, 0.09308530390262604, 0.0919591635465622, 0.0904969722032547, 0.09280660003423691, 0.09168382734060287, 0.09262125939130783, 0.08228680491447449, 0.091921366751194, 0.0901346206665039], [0.09196307510137558, 0.09080597758293152, 0.09263192117214203, 0.09174548834562302, 0.09059113264083862, 0.09241275489330292, 0.09152841567993164, 0.09226692467927933, 0.08403423428535461, 0.09171570092439651, 0.09030445665121078], [0.09219083935022354, 0.09077513962984085, 0.09301097691059113, 0.09192431718111038, 0.090512715280056, 0.09274208545684814, 0.0916585698723793, 0.09256325662136078, 0.08257153630256653, 0.09188783913850784, 0.09016276895999908], [0.08939533680677414, 0.09095018357038498, 0.08851747214794159, 0.08968418836593628, 0.09124405682086945, 0.0888034850358963, 0.08997397124767303, 0.08899466693401337, 0.10107411444187164, 0.0897238552570343, 0.09163873642683029], [0.09202121943235397, 0.09079840034246445, 0.09272845834493637, 0.09179120510816574, 0.09057144075632095, 0.09249667823314667, 0.09156176447868347, 0.09234247356653214, 0.08365998417139053, 0.09175971895456314, 0.09026866406202316], [0.09157633036375046, 0.09085126966238022, 0.09199389070272446, 0.09144023805856705, 0.09071626514196396, 0.0918571874499321, 0.09130436182022095, 0.09176616370677948, 0.08653678745031357, 0.09142160415649414, 0.09053593873977661]], [[0.08866839855909348, 0.09068270027637482, 0.09060805290937424, 0.09053347259759903, 0.09158593416213989, 0.09235672652721405, 0.09114518016576767, 0.09023575484752655, 0.09212885051965714, 0.09092029184103012, 0.09113453328609467], [0.08740949630737305, 0.09054926037788391, 0.09043218940496445, 0.09031527489423752, 0.09197019785642624, 0.09318914264440536, 0.09127581864595413, 0.08984912186861038, 0.092828169465065, 0.09092225134372711, 0.09125907719135284], [0.0874553769826889, 0.09055420011281967, 0.09043868631124496, 0.0903233140707016, 0.09195613861083984, 0.0931585505604744, 0.09127108007669449, 0.08986332267522812, 0.092802494764328, 0.09092223644256592, 0.09125455468893051], [0.08750129491090775, 0.09055914729833603, 0.09044519066810608, 0.09033136814832687, 0.09194207936525345, 0.09312797337770462, 0.09126634150743484, 0.08987752348184586, 0.0927768349647522, 0.09092222154140472, 0.09125005453824997], [0.08685876429080963, 0.09048942476511002, 0.09035368263721466, 0.09021815657615662, 0.09213921427726746, 0.09355774521827698, 0.09133248776197433, 0.08967804908752441, 0.09313735365867615, 0.09092208743095398, 0.09131304919719696], [0.08639530837535858, 0.0904383733868599, 0.09028687328100204, 0.09013562649488449, 0.09228189289569855, 0.09387007355690002, 0.09137994050979614, 0.08953315764665604, 0.09339910745620728, 0.09092146903276443, 0.09135822206735611], [0.0871264636516571, 0.09051861613988876, 0.09039197117090225, 0.09026549011468887, 0.0920569896697998, 0.0933782309293747, 0.0913049727678299, 0.08976134657859802, 0.0929868146777153, 0.09092225134372711, 0.09128685295581818], [0.08768512308597565, 0.09057887643575668, 0.09047112613916397, 0.0903635025024414, 0.09188582003116608, 0.0930056944489479, 0.09124734252691269, 0.08993430435657501, 0.09267418086528778, 0.09092210233211517, 0.09123194217681885], [0.08653169870376587, 0.09045346081256866, 0.0903065949678421, 0.09015998244285583, 0.0922398492693901, 0.09377793967723846, 0.0913659855723381, 0.0895758792757988, 0.09332191944122314, 0.09092169255018234, 0.0913449376821518], [0.08726382255554199, 0.09053351730108261, 0.09041152149438858, 0.09028968960046768, 0.0920148566365242, 0.09328638017177582, 0.09129083901643753, 0.08980398625135422, 0.09290976077318192, 0.0909222736954689, 0.09127338230609894], [0.08713295310735703, 0.09051932394504547, 0.09039288759231567, 0.0902666375041008, 0.09205500036478043, 0.09337388724088669, 0.09130430221557617, 0.08976336568593979, 0.0929831713438034, 0.09092225134372711, 0.09128621220588684]], [[0.08987058699131012, 0.0897698700428009, 0.0908002108335495, 0.08956877142190933, 0.0909896045923233, 0.0904952734708786, 0.08926796913146973, 0.09182778000831604, 0.10159581899642944, 0.08952748030424118, 0.08628669381141663], [0.08988750725984573, 0.08978831768035889, 0.09080293774604797, 0.08959026634693146, 0.09098942577838898, 0.09050267934799194, 0.08929401636123657, 0.09181465208530426, 0.10142356157302856, 0.08954960107803345, 0.08635694533586502], [0.08971372246742249, 0.08959900587797165, 0.09077342599630356, 0.0893700122833252, 0.09098950773477554, 0.09042565524578094, 0.08902762085199356, 0.0919465571641922, 0.10318846255540848, 0.0893229991197586, 0.08564295619726181], [0.08992128819227219, 0.08982516080141068, 0.09080833196640015, 0.08963321149349213, 0.09098900109529495, 0.09051740914583206, 0.08934605866670609, 0.09178834408521652, 0.10107984393835068, 0.0895937904715538, 0.08649756014347076], [0.08968166261911392, 0.08956411480903625, 0.09076765924692154, 0.08932948857545853, 0.0909891426563263, 0.0904112309217453, 0.08897870033979416, 0.0919702798128128, 0.10351356863975525, 0.08928132057189941, 0.08551287651062012], [0.0897652879357338, 0.08965514600276947, 0.09078250080347061, 0.08943524956703186, 0.0909898579120636, 0.09044872224330902, 0.08910643309354782, 0.0919080376625061, 0.1026654839515686, 0.0893900990486145, 0.08585315197706223], [0.08997172862291336, 0.08988019078969955, 0.09081615507602692, 0.08969739824533463, 0.09098808467388153, 0.09053925424814224, 0.08942391723394394, 0.09174861758947372, 0.10056616365909576, 0.08965986222028732, 0.086708664894104], [0.08953922986984253, 0.08940926939249039, 0.09074082225561142, 0.08914990723133087, 0.09098607301712036, 0.09034626930952072, 0.08876228332519531, 0.09207324683666229, 0.1049547865986824, 0.08909667283296585, 0.08494139462709427], [0.08782869577407837, 0.08756503462791443, 0.09028586000204086, 0.08704008162021637, 0.09079167246818542, 0.08947517722845078, 0.08625854551792145, 0.09305155277252197, 0.12202118337154388, 0.08693253248929977, 0.0787496566772461], [0.08992821723222733, 0.08983271569013596, 0.0908094197511673, 0.08964201807975769, 0.090988889336586, 0.09052042663097382, 0.08935674279928207, 0.09178291261196136, 0.1010092943906784, 0.08960286527872086, 0.08652648329734802], [0.09046563506126404, 0.09042079746723175, 0.09087813645601273, 0.09033119678497314, 0.09096188098192215, 0.09074308723211288, 0.09019696712493896, 0.0913313627243042, 0.09550538659095764, 0.09031278640031815, 0.0888526663184166]], [[0.09126867353916168, 0.09116990864276886, 0.09107126295566559, 0.08950380235910416, 0.09087427705526352, 0.09039755165576935, 0.09178171306848526, 0.09057959914207458, 0.09158319234848022, 0.09148409217596054, 0.09028587490320206], [0.09126298129558563, 0.09116579592227936, 0.09106871485710144, 0.08952604979276657, 0.09087486565113068, 0.09040571749210358, 0.0917677953839302, 0.09058487415313721, 0.09157246351242065, 0.09147495031356812, 0.09029580652713776], [0.09125726670026779, 0.09116166085004807, 0.0910661593079567, 0.0895482748746872, 0.09087544679641724, 0.09041386097669601, 0.09175386279821396, 0.09059014171361923, 0.09156171977519989, 0.0914657935500145, 0.09030572324991226], [0.09116573631763458, 0.09109540283679962, 0.09102512896060944, 0.08990556746721268, 0.0908847376704216, 0.09054461121559143, 0.09153074026107788, 0.09067455679178238, 0.09138956665992737, 0.09131906926631927, 0.09046486020088196], [0.0912458673119545, 0.09115341305732727, 0.0910610631108284, 0.08959278464317322, 0.09087663143873215, 0.09043017774820328, 0.09172602742910385, 0.09060068428516388, 0.09154024720191956, 0.09144750237464905, 0.09032557904720306], [0.09121815115213394, 0.09113336354494095, 0.09104865044355392, 0.08970095217227936, 0.09087946265935898, 0.09046979993581772, 0.09165841341018677, 0.09062627702951431, 0.09148809313774109, 0.0914030522108078, 0.09037379175424576], [0.0912981852889061, 0.09119125455617905, 0.09108445048332214, 0.08938874304294586, 0.09087121486663818, 0.09035532176494598, 0.09185382723808289, 0.09055230021476746, 0.09163878858089447, 0.09153146296739578, 0.09023450314998627], [0.09122875332832336, 0.09114103764295578, 0.09105340391397476, 0.08965957164764404, 0.09087838232517242, 0.09045464545488358, 0.09168427437543869, 0.09061648696660995, 0.09150804579257965, 0.09142005443572998, 0.09035535156726837], [0.0912867859005928, 0.09118301421403885, 0.09107935428619385, 0.08943317085504532, 0.0908723995089531, 0.09037163853645325, 0.09182596951723099, 0.0905628427863121, 0.09161731600761414, 0.09151316434144974, 0.09025434404611588], [0.09128108620643616, 0.09117888659238815, 0.0910768061876297, 0.08945539593696594, 0.09087298810482025, 0.09037978947162628, 0.09181203693151474, 0.09056811779737473, 0.09160657227039337, 0.09150401502847672, 0.09026426821947098], [0.09121163189411163, 0.0911286473274231, 0.09104572981595993, 0.08972639590501785, 0.0908801332116127, 0.09047911316156387, 0.09164252877235413, 0.09063228964805603, 0.09147583693265915, 0.09139261394739151, 0.09038512408733368]], [[0.09088877588510513, 0.09083118289709091, 0.09229446202516556, 0.09158480167388916, 0.09152676910161972, 0.09211912751197815, 0.0914108157157898, 0.09200242161750793, 0.08535248786211014, 0.09156093746423721, 0.09042825549840927], [0.0908898189663887, 0.09083379060029984, 0.09225700795650482, 0.09156686067581177, 0.09151041507720947, 0.09208650887012482, 0.09139763563871384, 0.09197300672531128, 0.08549947291612625, 0.09154364466667175, 0.09044179320335388], [0.09085498005151749, 0.0907595157623291, 0.0931972786784172, 0.09201181679964066, 0.09191514551639557, 0.09290382266044617, 0.09172209352254868, 0.09270869940519333, 0.08186186850070953, 0.09197204560041428, 0.09009277820587158], [0.09087395668029785, 0.0907975286245346, 0.09274414926767349, 0.0917988121509552, 0.09172161668539047, 0.09251035749912262, 0.09156740456819534, 0.09235482662916183, 0.08360099792480469, 0.09176705777645111, 0.09026331454515457], [0.09087533503770828, 0.09080047905445099, 0.09270685911178589, 0.09178116917610168, 0.0917055606842041, 0.092477947473526, 0.09155453741550446, 0.09232565015554428, 0.08374527841806412, 0.09175007045269012, 0.09027715772390366], [0.09086001664400101, 0.09076924622058868, 0.09308581799268723, 0.09195967018604279, 0.09186779707670212, 0.0928071141242981, 0.09168433398008347, 0.09262177348136902, 0.0822872593998909, 0.09192187339067459, 0.0901351198554039], [0.09087802469730377, 0.09080629050731659, 0.0926322415471077, 0.09174580872058868, 0.09167338907718658, 0.09241307526826859, 0.09152872860431671, 0.092267245054245, 0.0840345248579979, 0.09171602129936218, 0.09030476957559586], [0.09086325019598007, 0.09077560156583786, 0.09301145374774933, 0.09192478656768799, 0.091836117208004, 0.09274256229400635, 0.09165903925895691, 0.09256373345851898, 0.08257196098566055, 0.09188830852508545, 0.0901632308959961], [0.0908530056476593, 0.09095074981451035, 0.08851801604032516, 0.08968474715948105, 0.08978123962879181, 0.08880402892827988, 0.0899745300412178, 0.08899521827697754, 0.10107474774122238, 0.08972441405057907, 0.09163930267095566], [0.09087451547384262, 0.0907987430691719, 0.09272880852222443, 0.0917915478348732, 0.091715008020401, 0.09249702841043472, 0.09156210720539093, 0.09234282374382019, 0.0836602970957756, 0.0917600691318512, 0.09026900678873062], [0.09089643508195877, 0.09085138142108917, 0.09199400991201401, 0.0914403572678566, 0.09139504283666611, 0.09185730665922165, 0.0913044810295105, 0.09176628291606903, 0.08653689920902252, 0.09142172336578369, 0.09053605794906616]]]}, "num_training_step_calls_per_iteration": 1, "evaluation": {"env_runners": {"episode_len_max": 20, "rlmodule_inference_timer": 3.284347711318711e-05, "num_module_steps_sampled": {"default_policy": 400}, "sample": 0.1661654382998904, "env_to_module_connector": {"timers": {"connectors": {"add_states_from_episodes_to_batch": 2.837462787106331e-06, "add_time_dim_to_batch_and_zero_pad": 7.020892410624424e-06, "add_observations_from_episodes_to_batch": 2.878054613136903e-06, "numpy_to_tensor": 1.2668175281331648e-05, "batch_individual_items": 1.2357059610991579e-05}}, "connector_pipeline_timer": 6.014211786193102e-05}, "module_episode_returns_mean": {"default_policy": 0.55}, "module_to_env_connector": {"timers": {"connectors": {"normalize_and_clip_actions": 8.000214910757243e-06, "remove_single_ts_time_rank_from_batch": 1.2049524007092169e-05, "tensor_to_numpy": 1.5428977519908628e-05, "listify_data_for_vector_env": 1.0535521429536728e-05, "un_batch_to_individual_items": 6.615791473560534e-06, "get_actions": 3.848679088816742e-05}}, "connector_pipeline_timer": 0.00011806292341668683}, "episode_duration_sec_mean": 0.0054604787938296795, "weights_seq_no": 19.0, "env_to_module_sum_episodes_length_out": 10.368238394574323, "agent_episode_returns_mean": {"default_agent": 0.55}, "episode_return_mean": 0.55, "env_to_module_sum_episodes_length_in": 10.368238394574323, "num_episodes_lifetime": 380, "num_agent_steps_sampled_lifetime": {"default_agent": 7600}, "num_episodes": 20, "episode_len_mean": 20.0, "num_agent_steps_sampled": {"default_agent": 400}, "num_module_steps_sampled_lifetime": {"default_policy": 7600}, "env_reset_timer": 0.0021103664498752198, "episode_return_min": -16.5, "num_env_steps_sampled": 400, "episode_len_min": 20, "episode_return_max": 12.5, "env_step_timer": 1.4242666906855156e-05, "num_env_steps_sampled_lifetime": 95400, "time_between_sampling": 10.810944421879025}, "num_healthy_workers": 1, "actor_manager_num_outstanding_async_reqs": 0, "num_remote_worker_restarts": 0}, "num_env_steps_sampled_lifetime": -10487500.0, "fault_tolerance": {"num_healthy_workers": 0, "num_remote_worker_restarts": 0}, "env_runner_group": {"actor_manager_num_outstanding_async_reqs": 0}, "done": false, "training_iteration": 19, "trial_id": "b154b_00000", "date": "2025-08-11_18-14-37", "timestamp": 1754928877, "time_this_iter_s": 10.026968955993652, "time_total_s": 192.61247491836548, "pid": 10455, "hostname": "Mac", "node_ip": "127.0.0.1", "config": {"exploration_config": {}, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 2, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "env": "Umbrella", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": false, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 0, "create_local_env_runner": true, "num_envs_per_env_runner": 1, "gym_env_vectorize_mode": "SYNC", "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "episodes_to_numpy": true, "max_requests_in_flight_per_env_runner": 1, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "merge_env_runner_states": "training_only", "broadcast_env_runner_states": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "complete_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "sampler_perf_stats_ema_coef": null, "_is_online": true, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": "auto", "num_aggregator_actors_per_learner": 0, "max_requests_in_flight_per_aggregator_actor": 3, "local_gpu_idx": 0, "max_requests_in_flight_per_learner": 3, "gamma": 1, "lr": 0.0002715581955, "grad_clip": 0.5, "grad_clip_by": "global_norm", "_train_batch_size_per_learner": 5000, "train_batch_size": 4000, "num_epochs": 1, "minibatch_size": 1000, "shuffle_batch_per_epoch": true, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "log_std_clip_param": 20.0, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "_disable_preprocessor_api": false, "_disable_action_flattening": false}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {"intrinsic_reward_coeff": 0.2795015916508}, "optimizer": {}, "_learner_class": "<class 'source.intrinsic_attention_ppo.learners.IntrinsicAttentionMetaLearner.IntrinsicAttentionMetaLearner'>", "callbacks_on_algorithm_init": null, "callbacks_on_env_runners_recreated": null, "callbacks_on_offline_eval_runners_recreated": null, "callbacks_on_checkpoint_loaded": null, "callbacks_on_environment_created": null, "callbacks_on_episode_created": null, "callbacks_on_episode_start": null, "callbacks_on_episode_step": null, "callbacks_on_episode_end": null, "callbacks_on_evaluate_start": null, "callbacks_on_evaluate_end": null, "callbacks_on_evaluate_offline_start": null, "callbacks_on_evaluate_offline_end": null, "callbacks_on_sample_end": null, "callbacks_on_train_result": null, "explore": true, "enable_rl_module_and_learner": true, "enable_env_runner_and_connector_v2": true, "_prior_exploration_config": {"type": "StochasticSampling"}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x1514e58a0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "offline_data_class": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_read_batch_size": null, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "materialize_data": false, "materialize_mapped_data": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "ignore_final_observation": false, "prelearner_class": null, "prelearner_buffer_class": null, "prelearner_buffer_kwargs": {}, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_remaining_data": false, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": 1, "evaluation_duration": 20, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_auto_duration_min_env_steps_per_sample": 100, "evaluation_auto_duration_max_env_steps_per_sample": 2000, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 1, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "offline_evaluation_interval": null, "num_offline_eval_runners": 0, "offline_loss_for_module_fn": null, "offline_evaluation_duration": 1, "offline_evaluation_parallel_to_training": false, "offline_evaluation_timeout_s": 120.0, "num_cpus_per_offline_eval_runner": 1, "num_gpus_per_offline_eval_runner": 0, "custom_resources_per_offline_eval_runner": {}, "restart_failed_offline_eval_runners": true, "ignore_offline_eval_runner_failures": false, "max_num_offline_eval_runner_restarts": 1000, "offline_eval_runner_restore_timeout_s": 1800.0, "max_requests_in_flight_per_offline_eval_runner": 1, "validate_offline_eval_runners_after_construction": true, "offline_eval_runner_health_probe_timeout_s": 30.0, "offline_eval_rl_module_inference_only": false, "broadcast_offline_eval_runner_states": false, "offline_eval_batch_size_per_runner": 256, "dataset_num_iters_per_eval_runner": 1, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "log_gradients": false, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 4, "restart_failed_env_runners": true, "ignore_env_runner_failures": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30.0, "env_runner_restore_timeout_s": 1800.0, "_model_config": {}, "_rl_module_spec": "MultiRLModuleSpec(multi_rl_module_class=<class 'ray.rllib.core.rl_module.multi_rl_module.MultiRLModule'>, observation_space=None, action_space=None, inference_only=False, model_config=None, rl_module_specs={'default_policy': RLModuleSpec(module_class=<class 'source.intrinsic_attention_ppo.rl_modules.DifferentiablePPOModule.DifferentiablePPOModule'>, observation_space=None, action_space=None, inference_only=False, learner_only=False, model_config={'vf_share_layers': True, 'embedding_dim': 62, 'max_seq_len': 11, 'policy_head_hidden_sizes': [32], 'value_head_hidden_sizes': [101], 'embedding_hidden_sizes': [121]}, catalog_class=None, load_state_path=None, model_config_dict=None), 'intrinsic_reward_module': RLModuleSpec(module_class=<class 'source.intrinsic_attention_ppo.rl_modules.IntrinsicAttentionModule.IntrinsicAttentionModule'>, observation_space=None, action_space=None, inference_only=False, learner_only=True, model_config={'intrinsic_reward_network': {'encoder_hidden_sizes': [], 'encoding_dim': 1, 'num_heads': 1, 'head_hidden_sizes': None, 'layers': [{'type': 'attention'}]}, 'extrinsic_value_hidden_layers': [127, 60], 'vf_share_layers': True, 'max_seq_len': 11}, catalog_class=None, load_state_path=None, model_config_dict=None)}, load_state_path=None, modules_to_load=None, module_specs={'default_policy': RLModuleSpec(module_class=<class 'source.intrinsic_attention_ppo.rl_modules.DifferentiablePPOModule.DifferentiablePPOModule'>, observation_space=None, action_space=None, inference_only=False, learner_only=False, model_config={'vf_share_layers': True, 'embedding_dim': 62, 'max_seq_len': 11, 'policy_head_hidden_sizes': [32], 'value_head_hidden_sizes': [101], 'embedding_hidden_sizes': [121]}, catalog_class=None, load_state_path=None, model_config_dict=None), 'intrinsic_reward_module': RLModuleSpec(module_class=<class 'source.intrinsic_attention_ppo.rl_modules.IntrinsicAttentionModule.IntrinsicAttentionModule'>, observation_space=None, action_space=None, inference_only=False, learner_only=True, model_config={'intrinsic_reward_network': {'encoder_hidden_sizes': [], 'encoding_dim': 1, 'num_heads': 1, 'head_hidden_sizes': None, 'layers': [{'type': 'attention'}]}, 'extrinsic_value_hidden_layers': [127, 60], 'vf_share_layers': True, 'max_seq_len': 11}, catalog_class=None, load_state_path=None, model_config_dict=None)})", "algorithm_config_overrides_per_module": {"intrinsic_reward_module": {"lr": 0.0002715581955}}, "_per_module_overrides": {}, "_validate_config": true, "_use_msgpack_checkpoints": false, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "env_task_fn": -1, "enable_connectors": -1, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.161583927863, "kl_target": 0.0201019014258, "vf_loss_coeff": 0.7790510010087, "entropy_coeff": 0.0015431216992, "clip_param": 0.2459212356676, "vf_clip_param": 0.3769744131561, "entropy_coeff_schedule": null, "lr_schedule": null, "sgd_minibatch_size": -1, "vf_share_layers": -1, "differentiable_learner_configs": ["DifferentiableLearnerConfig(learner_class=<class 'source.intrinsic_attention_ppo.learners.IntrinsicAttentionPPOLearner.IntrinsicAttentionPPOLearner'>, learner_connector=None, add_default_connectors_to_learner_pipeline=True, is_multi_agent=False, policies_to_update=['default_policy'], lr=0.0060984166342, num_total_minibatches=0, num_epochs=1, minibatch_size=1000, shuffle_batch_per_epoch=True)"], "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9485408017724, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.callbacks.callbacks.RLlibCallback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 192.61247491836548, "iterations_since_restore": 19, "perf": {"cpu_util_percent": 46.033333333333324, "ram_util_percent": 79.22666666666667}}
{"timers": {"training_iteration": 10.14926390125472, "restore_env_runners": 1.0436715870469855e-05, "training_step": 10.149059004002906, "env_runner_sampling_timer": 1.8141042171381017, "learner_update_timer": 8.149625651704891, "synch_weights": 0.001498373541450557, "restore_eval_env_runners": 7.243341668128441e-05, "evaluation_iteration": 0.20381589651658286, "synch_eval_env_connectors": 0.00021879562498833846, "synch_env_connectors": 5.051197115116411e-06}, "env_runners": {"num_env_steps_sampled": 5000.0, "episode_return_max": 12.5, "env_to_module_connector": {"timers": {"connectors": {"add_time_dim_to_batch_and_zero_pad": 6.959853007173431e-06, "add_observations_from_episodes_to_batch": 2.8238454415834833e-06, "batch_individual_items": 1.2408727697935349e-05, "numpy_to_tensor": 1.2542493973164522e-05, "add_states_from_episodes_to_batch": 2.7298216105792735e-06}}, "connector_pipeline_timer": 5.9921194664490315e-05}, "episode_len_min": 20, "module_to_env_connector": {"timers": {"connectors": {"un_batch_to_individual_items": 6.6759268135868605e-06, "normalize_and_clip_actions": 8.095145070851809e-06, "remove_single_ts_time_rank_from_batch": 1.197036770103595e-05, "get_actions": 3.9344064994892675e-05, "tensor_to_numpy": 1.5213408112688122e-05, "listify_data_for_vector_env": 1.0701306629878792e-05}}, "connector_pipeline_timer": 0.00011904220209349727}, "env_step_timer": 1.3943048855532333e-05, "num_agent_steps_sampled_lifetime": {"default_agent": -11105000.0}, "num_episodes": 250.0, "episode_duration_sec_mean": 0.005312210646457967, "episode_len_mean": 20.0, "module_episode_returns_mean": {"default_policy": 4.5}, "weights_seq_no": 19.0, "env_to_module_sum_episodes_length_out": 10.36823839457432, "num_env_steps_sampled_lifetime": -11105000.0, "episode_len_max": 20, "rlmodule_inference_timer": 3.1919347809327526e-05, "num_agent_steps_sampled": {"default_agent": 5000.0}, "env_reset_timer": 4.577586823920203e-05, "agent_episode_returns_mean": {"default_agent": 4.5}, "env_to_module_sum_episodes_length_in": 10.36823839457432, "episode_return_mean": 4.5, "time_between_sampling": 0.03399350747225871, "num_module_steps_sampled_lifetime": {"default_policy": -11105000.0}, "num_module_steps_sampled": {"default_policy": 5000.0}, "num_episodes_lifetime": -555250.0, "episode_return_min": -7.5, "sample": 0.005914072450091311, "num_env_steps_sampled_lifetime_throughput": 3202.503312075194}, "__all_modules__": {"learner_connector_sum_episodes_length_in": 5000.0, "learner_connector": {"connector_pipeline_timer": 0.14066538331338044, "timers": {"connectors": {"add_one_ts_to_episodes_and_truncate": 0.009878041176155072, "add_observations_from_episodes_to_batch": 0.0010230949512949233, "add_columns_from_episodes_to_train_batch": 0.044379507821674526, "add_time_dim_to_batch_and_zero_pad": 0.07705602055671962, "add_states_from_episodes_to_batch": 0.0036774793232750027, "batch_individual_items": 0.004391961348148969, "numpy_to_tensor": 7.400631840951767e-05}}}, "learner_connector_sum_episodes_length_out": 5250.0}, "learners": {"__all_modules__": {"num_module_steps_trained_lifetime": 239400, "num_env_steps_trained": 33000, "num_env_steps_trained_lifetime": 660000, "num_non_trainable_parameters": 0, "num_trainable_parameters": 24861, "num_module_steps_trained": 11970, "num_env_steps_trained_lifetime_throughput": 3910.047639072482, "num_module_steps_trained_throughput": 19704723.500231788, "num_module_steps_trained_lifetime_throughput": 12379152.991977975}, "default_policy": {"curr_entropy_coeff": 0.0015431216992, "weights_seq_no": 20.0, "curr_kl_coeff": 1.5409844422720198e-07, "policy_loss": -0.0005687619559466839, "module_train_batch_size_mean": 997.6479298448816, "num_trainable_parameters": 16595, "vf_loss": 0.35830792784690857, "mean_kl_loss": 2.9686281777685508e-05, "diff_num_grad_updates_vs_sampler_policy": 1.0, "vf_explained_var": -0.0011241436004638672, "use_intrinsic_rewards": 0.0, "entropy": 0.672502338886261, "num_module_steps_trained": 5985, "vf_loss_unclipped": 43.561309814453125, "total_loss": 0.277533620595932, "num_module_steps_trained_lifetime": 119700, "num_module_steps_trained_lifetime_throughput": 708.9808222016884}, "differentiable_learners": {"intrinsic_attention_ppo_learner": {"__all_modules__": {"num_module_steps_trained_lifetime": 1436400, "num_env_steps_trained_lifetime": 3960000, "num_module_steps_trained": 71820, "num_env_steps_trained": 198000, "num_env_steps_trained_lifetime_throughput": 41668.87610816555}, "default_policy": {"weights_seq_no": 120.0, "policy_loss": -0.0005393058527261019, "module_train_batch_size_mean": 997.4978492525759, "vf_loss": 0.3583182096481323, "mean_kl_loss": 2.6604651793604717e-05, "diff_num_grad_updates_vs_sampler_policy": 101.0, "vf_explained_var": 0.003040611743927002, "use_intrinsic_rewards": 1.0, "entropy": 0.6725848317146301, "num_module_steps_trained": 35910, "vf_loss_unclipped": 43.44142532348633, "total_loss": 0.2775752544403076, "num_module_steps_trained_lifetime": 718200}, "intrinsic_reward_module": {"total_loss": 0.0, "num_module_steps_trained_lifetime": 718200, "module_train_batch_size_mean": 997.4978492525759, "weights_seq_no": 120.0, "num_module_steps_trained": 35910, "diff_num_grad_updates_vs_sampler_policy": 101.0}}}, "intrinsic_reward_module": {"diff_num_grad_updates_vs_sampler_policy": 1.0, "gradients_default_optimizer_global_norm": 0.0, "curr_entropy_coeff": 0.0015431216992, "weights_seq_no": 20.0, "default_optimizer_learning_rate": 0.0002715581955, "total_loss": 0.0, "num_module_steps_trained_lifetime": 119700, "module_train_batch_size_mean": 997.6479298448816, "num_trainable_parameters": 8266, "num_module_steps_trained": 5985, "num_module_steps_trained_lifetime_throughput": 708.9852262877391}, "IntrinsicAttentionMask": [[[0.08856727182865143, 0.09057927131652832, 0.09163225442171097, 0.09043021500110626, 0.09148146957159042, 0.09225139021873474, 0.0921754539012909, 0.09013283997774124, 0.09089140594005585, 0.0919480249285698, 0.08991044759750366], [0.087251678109169, 0.09038576483726501, 0.0920419842004776, 0.09015220403671265, 0.091804139316082, 0.09302088618278503, 0.09290062636137009, 0.08968690037727356, 0.09087558090686798, 0.09254077076911926, 0.0893394872546196], [0.08658084273338318, 0.09028475731611252, 0.09225186705589294, 0.09000789374113083, 0.09196896851062775, 0.09341765195131302, 0.0932743027806282, 0.089456707239151, 0.09086581319570541, 0.09284558892250061, 0.08904553949832916], [0.0873475968837738, 0.0904000774025917, 0.09201202541589737, 0.09017270058393478, 0.09178058803081512, 0.09296439588069916, 0.09284740686416626, 0.08971965312957764, 0.09087687730789185, 0.0924973264336586, 0.08938136696815491], [0.08667618781328201, 0.09029921144247055, 0.09222200512886047, 0.09002850949764252, 0.09194554388523102, 0.09336108714342117, 0.09322104603052139, 0.08948954194784164, 0.09086728096008301, 0.09280215948820114, 0.08908743411302567], [0.08619192242622375, 0.0902254730463028, 0.09237387776374817, 0.0899234414100647, 0.09206464886665344, 0.09364909678697586, 0.09349221736192703, 0.08932239562273026, 0.09085964411497116, 0.0930231437087059, 0.08887424319982529], [0.08623939752578735, 0.0902327373623848, 0.09235896170139313, 0.08993377536535263, 0.09205295145511627, 0.09362077713012695, 0.09346555918455124, 0.08933881670236588, 0.09086041152477264, 0.09300142526626587, 0.08889518678188324], [0.08753970265388489, 0.09042864292860031, 0.09195206314325333, 0.09021363407373428, 0.0917334258556366, 0.09285144507884979, 0.092740997672081, 0.089785136282444, 0.0908794105052948, 0.09241043031215668, 0.08946511149406433], [0.08705157786607742, 0.09035580605268478, 0.09210451692342758, 0.09010934084653854, 0.09185329079627991, 0.0931389182806015, 0.09301180392503738, 0.08961842954158783, 0.09087278693914413, 0.0926315039396286, 0.08925200253725052], [0.08638198673725128, 0.0902545154094696, 0.0923142284154892, 0.08996478468179703, 0.09201788157224655, 0.09353586286306381, 0.09338561445474625, 0.08938810974359512, 0.0908627063035965, 0.09293629974126816, 0.08895803242921829], [0.08768399804830551, 0.09045002609491348, 0.0919070616364479, 0.09024429321289062, 0.09169802069664001, 0.09276676923036575, 0.09266120940446854, 0.08983423560857773, 0.09088126569986343, 0.09234525263309479, 0.0895279124379158]], [[0.09221182763576508, 0.090900719165802, 0.09173067659139633, 0.09196511656045914, 0.09065750986337662, 0.09272194653749466, 0.09171905368566513, 0.09255648404359818, 0.08327226340770721, 0.09193135052919388, 0.09033311903476715], [0.09181437641382217, 0.09091100841760635, 0.09148332476615906, 0.09164469689130783, 0.09074299037456512, 0.0921647846698761, 0.09147532284259796, 0.0920511931180954, 0.08557215332984924, 0.09162145853042603, 0.09051867574453354], [0.09206722676753998, 0.09090526401996613, 0.09164102375507355, 0.09184872359037399, 0.090689517557621, 0.09251881390810013, 0.0916307345032692, 0.09237237274646759, 0.08410593867301941, 0.09181881695985794, 0.09040164202451706], [0.09213785082101822, 0.0909031480550766, 0.09168485552072525, 0.09190558642148972, 0.09067399799823761, 0.09261796623468399, 0.09167391806840897, 0.09246225655078888, 0.08369824290275574, 0.09187379479408264, 0.09036830067634583], [0.09173945337533951, 0.09091217815876007, 0.09143636375665665, 0.09158411622047424, 0.09075824171304703, 0.0920601561665535, 0.09142903983592987, 0.09195620566606522, 0.0860087126493454, 0.09156284481287003, 0.0905526727437973], [0.09236356616020203, 0.09089495986700058, 0.09182432293891907, 0.092087022960186, 0.09062280505895615, 0.09293564409017563, 0.09181130677461624, 0.09275005012750626, 0.08240121603012085, 0.09204918891191483, 0.09025995433330536], [0.09206371754407883, 0.09090535342693329, 0.09163883328437805, 0.09184588491916656, 0.09069027006626129, 0.09251388162374496, 0.09162858128547668, 0.09236789494752884, 0.08412619680166245, 0.09181606769561768, 0.09040328115224838], [0.09231451898813248, 0.09089692682027817, 0.09179409593343735, 0.09204764664173126, 0.09063414484262466, 0.09286651015281677, 0.09178153425455093, 0.0926874428987503, 0.08268231898546219, 0.09201112389564514, 0.09028373658657074], [0.08926654607057571, 0.09081914275884628, 0.08983063697814941, 0.08955498039722443, 0.09111259132623672, 0.08867553621530533, 0.08984433859586716, 0.08886644244194031, 0.10092849284410477, 0.08959458768367767, 0.0915067046880722], [0.0921277105808258, 0.09090346843004227, 0.09167856723070145, 0.09189742058515549, 0.09067624807357788, 0.09260371327400208, 0.09166771918535233, 0.09244933724403381, 0.08375679701566696, 0.0918659046292305, 0.09037311375141144], [0.09163892269134521, 0.09091337025165558, 0.09137319773435593, 0.09150274097919464, 0.09077826887369156, 0.09191997349262238, 0.09136676788330078, 0.09182889014482498, 0.08659594506025314, 0.09148409217596054, 0.09059782326221466]], [[0.08836856484413147, 0.09150199592113495, 0.09142667800188065, 0.09022732824087143, 0.09127622842788696, 0.09091179817914963, 0.09196865558624268, 0.09105101972818375, 0.09181731194257736, 0.09174174070358276, 0.08970873057842255], [0.08616825193166733, 0.0920204445719719, 0.09187765419483185, 0.0896180048584938, 0.09159275144338608, 0.0909043550491333, 0.09290744364261627, 0.09116704761981964, 0.09261934459209442, 0.09247563034296036, 0.08864911645650864], [0.08621970564126968, 0.09200826287269592, 0.09186707437038422, 0.08963245898485184, 0.09158536046743393, 0.09090463072061539, 0.09288524836301804, 0.09116440266370773, 0.09260040521621704, 0.0924583226442337, 0.08867411315441132], [0.0870484784245491, 0.09181246906518936, 0.09169693291187286, 0.08986391127109528, 0.09146628528833389, 0.09090844541788101, 0.09252945333719254, 0.09112141281366348, 0.09229671955108643, 0.09218056499958038, 0.08907528221607208], [0.08632270246744156, 0.09198389202356339, 0.09184590727090836, 0.0896613672375679, 0.09157057106494904, 0.09090518206357956, 0.09284087270498276, 0.09115911275148392, 0.09256255626678467, 0.0924237072467804, 0.08872412145137787], [0.08657333999872208, 0.09192463755607605, 0.09179443120956421, 0.08973152935504913, 0.0915345773100853, 0.09090641885995865, 0.09273307770490646, 0.09114617109298706, 0.09247057139873505, 0.09233959019184113, 0.0888456255197525], [0.08585090935230255, 0.09209559857845306, 0.09194290637969971, 0.0895286425948143, 0.09163827449083328, 0.09090249985456467, 0.09304451197385788, 0.09118322283029556, 0.09273622930049896, 0.09258247911930084, 0.08849472552537918], [0.08647739887237549, 0.09194730222225189, 0.09181413054466248, 0.08970469236373901, 0.09154834598302841, 0.09090595692396164, 0.09277430176734924, 0.09115112572908401, 0.09250574558973312, 0.09237176179885864, 0.0887991338968277], [0.08595354855060577, 0.0920712798833847, 0.09192179888486862, 0.08955758810043335, 0.09162355959415436, 0.09090312570333481, 0.0930001363158226, 0.09117801487445831, 0.09269839525222778, 0.09254789352416992, 0.08854470402002335], [0.08600489050149918, 0.09205911308526993, 0.09191123396158218, 0.08957204222679138, 0.0916161835193634, 0.09090341627597809, 0.09297794103622437, 0.0911753848195076, 0.0926794707775116, 0.09253059327602386, 0.08856969326734543], [0.08741235733032227, 0.09172672033309937, 0.09162234514951706, 0.08996472507715225, 0.0914139449596405, 0.09090970456600189, 0.09237415343523026, 0.0911022424697876, 0.092164047062397, 0.0920591726899147, 0.08925057202577591]], [[0.0921996608376503, 0.09211735427379608, 0.09295842051506042, 0.09195297211408615, 0.09064554423093796, 0.09270970523357391, 0.09170695394277573, 0.09254427254199982, 0.08215075731277466, 0.09069321304559708, 0.09032119810581207], [0.09217548370361328, 0.092094786465168, 0.09291934221982956, 0.09193361550569534, 0.0906515121459961, 0.09267552196979523, 0.09169238805770874, 0.09251333773136139, 0.08231236040592194, 0.09069826453924179, 0.09033339470624924], [0.09242019057273865, 0.09232308715581894, 0.09331616014242172, 0.092129185795784, 0.09058914333581924, 0.09302233159542084, 0.09183909744024277, 0.0928269624710083, 0.08068089932203293, 0.09064523130655289, 0.09020769596099854], [0.09212704002857208, 0.09204956889152527, 0.09284113347530365, 0.09189481288194656, 0.0906633585691452, 0.09260710328817368, 0.09166315943002701, 0.09245140850543976, 0.08263643831014633, 0.09070827811956406, 0.090357705950737], [0.09173454344272614, 0.09168273955583572, 0.09221136569976807, 0.09157921373844147, 0.09075338393449783, 0.09205523133277893, 0.09142414480447769, 0.09195128083229065, 0.08527670055627823, 0.09078356623649597, 0.0905478298664093], [0.0923483595252037, 0.092256098985672, 0.09319938719272614, 0.09207186102867126, 0.0906078889966011, 0.09292034059762955, 0.09179618954658508, 0.09273477643728256, 0.08115873485803604, 0.09066122025251389, 0.0902450904250145], [0.09205417335033417, 0.09198151528835297, 0.09272368252277374, 0.0918363705277443, 0.09068086743354797, 0.09250430017709732, 0.0916190817952156, 0.09235832840204239, 0.08312471210956573, 0.09072303771972656, 0.09039391577243805], [0.09230033308267593, 0.09221130609512329, 0.09312144666910172, 0.0920334905385971, 0.09062021225690842, 0.09285223484039307, 0.09176743030548096, 0.09267319738864899, 0.08147870749235153, 0.09067171812057495, 0.09026985615491867], [0.08882935345172882, 0.08894796669483185, 0.08774805814027786, 0.0891856849193573, 0.09111478924751282, 0.08810006082057953, 0.08954345434904099, 0.08833551406860352, 0.10554773360490799, 0.09104323387145996, 0.09160416573286057], [0.09174909442663193, 0.0916963517665863, 0.09223458170890808, 0.09159094840288162, 0.09075023978948593, 0.09207560122013092, 0.0914330706000328, 0.09196976572275162, 0.085178442299366, 0.09078097343444824, 0.09054101258516312], [0.09163512289524078, 0.09158971160650253, 0.09205295890569687, 0.0914989560842514, 0.09077451378107071, 0.09191616624593735, 0.09136298298835754, 0.09182509034872055, 0.0859493538737297, 0.09080100804567337, 0.09059407562017441]], [[0.08876922726631165, 0.09191686660051346, 0.0918412059545517, 0.09063641726970673, 0.09056181460618973, 0.09132399410009384, 0.09124882519245148, 0.0914638414978981, 0.09109866619110107, 0.09102367609739304, 0.09011546522378922], [0.08690954744815826, 0.09281208366155624, 0.0926680713891983, 0.09038898348808289, 0.0902487263083458, 0.09168639034032822, 0.09154412895441055, 0.09195134043693542, 0.09126025438308716, 0.09111864864826202, 0.08941175788640976], [0.08695311099290848, 0.09279090166091919, 0.09264852106571198, 0.09039489179849625, 0.09025618433952332, 0.09167788177728653, 0.09153720736503601, 0.09193986654281616, 0.0912565067410469, 0.09111647307872772, 0.08942840248346329], [0.087654247879982, 0.09245139360427856, 0.0923350527882576, 0.09048926830291748, 0.0903754010796547, 0.09154108166694641, 0.09142588078975677, 0.09175553172826767, 0.09119592607021332, 0.0910811573266983, 0.08969515562057495], [0.08769812434911728, 0.0924302265048027, 0.09231550246477127, 0.09049512445926666, 0.09038279950618744, 0.09153252094984055, 0.09141890704631805, 0.09174400568008423, 0.0911921039223671, 0.09107891470193863, 0.08971177786588669], [0.08725238591432571, 0.09264565259218216, 0.09251443296670914, 0.09043534845113754, 0.09030725061893463, 0.09161945432424545, 0.09148968011140823, 0.09186108410358429, 0.09123069792985916, 0.09110147505998611, 0.08954249322414398], [0.08729609847068787, 0.0926244780421257, 0.09249487519264221, 0.09044122695922852, 0.09031468629837036, 0.09161092340946198, 0.0914827361702919, 0.09184958785772324, 0.09122691303491592, 0.09109926968812943, 0.08955912292003632], [0.08717121928930283, 0.09268500655889511, 0.09255076199769974, 0.09042440354824066, 0.09029343724250793, 0.09163530170917511, 0.09150257706642151, 0.09188244491815567, 0.09123770147562027, 0.09110555797815323, 0.08951158076524734], [0.08738357573747635, 0.09258213639259338, 0.09245578199625015, 0.09045299887657166, 0.09032955020666122, 0.09159385412931442, 0.09146885573863983, 0.09182659536600113, 0.09121935069561005, 0.09109485894441605, 0.08959238976240158], [0.08742734044790268, 0.09256096929311752, 0.09243623912334442, 0.09045887738466263, 0.09033697843551636, 0.09158532321453094, 0.0914619043469429, 0.09181509166955948, 0.09121556580066681, 0.09109265357255936, 0.08960903435945511], [0.08796180784702301, 0.09230328351259232, 0.09219825267791748, 0.09053020924329758, 0.09042719751596451, 0.09148113429546356, 0.09137703478336334, 0.09167487919330597, 0.09116919338703156, 0.09106545150279999, 0.08981156349182129]], [[0.08946014940738678, 0.09087926149368286, 0.09038552641868591, 0.09067567437887192, 0.09057405591011047, 0.09161362797021866, 0.08886028826236725, 0.09140840172767639, 0.10113183408975601, 0.0891186073422432, 0.08589261770248413], [0.08913281559944153, 0.09085474163293839, 0.0902549996972084, 0.09060736000537872, 0.09048392623662949, 0.09174810349941254, 0.08840671926736832, 0.09149829298257828, 0.10346357524394989, 0.08871927112340927, 0.08483018726110458], [0.0892467051744461, 0.09086396545171738, 0.09030088782310486, 0.09063173830509186, 0.09051584452390671, 0.09170228242874146, 0.08856417238712311, 0.09146791696548462, 0.10265129804611206, 0.08885801583528519, 0.08519712090492249], [0.08917977660894394, 0.09085863828659058, 0.09027398377656937, 0.09061749279499054, 0.09049715846776962, 0.09172933548688889, 0.08847159892320633, 0.0914858803153038, 0.10312851518392563, 0.08877646178007126, 0.08498114347457886], [0.08920322358608246, 0.0908605307340622, 0.09028343111276627, 0.09062251448631287, 0.09050372987985611, 0.09171990305185318, 0.08850400894880295, 0.09147962927818298, 0.10296133905649185, 0.08880501240491867, 0.08505667746067047], [0.08896338939666748, 0.09083965420722961, 0.09018578380346298, 0.09056990593671799, 0.09043532609939575, 0.09181437641382217, 0.08817319571971893, 0.09154172241687775, 0.10467372834682465, 0.08851326256990433, 0.08428958803415298], [0.08959846943616867, 0.09088773280382156, 0.09043939411640167, 0.09070289134979248, 0.09061061590909958, 0.0915541872382164, 0.08905293047428131, 0.09136798977851868, 0.10014895349740982, 0.0892878994345665, 0.08634894341230392], [0.08901073783636093, 0.0908440351486206, 0.09020524471998215, 0.090580515563488, 0.09044904261827469, 0.09179607778787613, 0.08823837339878082, 0.09152980148792267, 0.10433530807495117, 0.08857079595327377, 0.08444003760814667], [0.08676908910274506, 0.09050900489091873, 0.08919660747051239, 0.08996640145778656, 0.08969631791114807, 0.09248337149620056, 0.08521788567304611, 0.09192892909049988, 0.12054906040430069, 0.0858837366104126, 0.07779958099126816], [0.08953890204429626, 0.09088421612977982, 0.09041628986597061, 0.09069129079580307, 0.09059497714042664, 0.09157996624708176, 0.0889698937535286, 0.09138556569814682, 0.10057200491428375, 0.08921495079994202, 0.08615189790725708], [0.09028226882219315, 0.0909126028418541, 0.09069393575191498, 0.09082252532243729, 0.09077750891447067, 0.0912366434931755, 0.09001414477825165, 0.09114623814821243, 0.09531180560588837, 0.09012973308563232, 0.08867257088422775]]]}, "num_training_step_calls_per_iteration": 1, "evaluation": {"env_runners": {"episode_len_max": 20, "rlmodule_inference_timer": 3.248557205705767e-05, "num_module_steps_sampled": {"default_policy": 400}, "sample": 0.16568828975695646, "env_to_module_connector": {"timers": {"connectors": {"add_states_from_episodes_to_batch": 2.8364434270162894e-06, "add_time_dim_to_batch_and_zero_pad": 6.95643086088131e-06, "add_observations_from_episodes_to_batch": 2.8793611021372656e-06, "numpy_to_tensor": 1.3399258730324361e-05, "batch_individual_items": 1.2427561620425407e-05}}, "connector_pipeline_timer": 6.123499442971879e-05}, "module_episode_returns_mean": {"default_policy": -0.05}, "module_to_env_connector": {"timers": {"connectors": {"normalize_and_clip_actions": 8.081318744917302e-06, "remove_single_ts_time_rank_from_batch": 1.1852671365231865e-05, "tensor_to_numpy": 1.5749202204303138e-05, "listify_data_for_vector_env": 1.0499745661675093e-05, "un_batch_to_individual_items": 6.559025586594449e-06, "get_actions": 3.895948666199209e-05}}, "connector_pipeline_timer": 0.00011884004212623561}, "episode_duration_sec_mean": 0.005492799625499174, "weights_seq_no": 20.0, "env_to_module_sum_episodes_length_out": 10.368238394574323, "agent_episode_returns_mean": {"default_agent": -0.05}, "episode_return_mean": -0.05, "env_to_module_sum_episodes_length_in": 10.368238394574323, "num_episodes_lifetime": 400, "num_agent_steps_sampled_lifetime": {"default_agent": 8000}, "num_episodes": 20, "episode_len_mean": 20.0, "num_agent_steps_sampled": {"default_agent": 400}, "num_module_steps_sampled_lifetime": {"default_policy": 8000}, "env_reset_timer": 0.0020900727857234413, "episode_return_min": -16.5, "num_env_steps_sampled": 400, "episode_len_min": 20, "episode_return_max": 12.5, "env_step_timer": 1.4573234720217173e-05, "num_env_steps_sampled_lifetime": 100400, "time_between_sampling": 10.795101466409536}, "num_healthy_workers": 1, "actor_manager_num_outstanding_async_reqs": 0, "num_remote_worker_restarts": 0}, "num_env_steps_sampled_lifetime": -11105000.0, "fault_tolerance": {"num_healthy_workers": 0, "num_remote_worker_restarts": 0}, "env_runner_group": {"actor_manager_num_outstanding_async_reqs": 0}, "done": true, "training_iteration": 20, "trial_id": "b154b_00000", "date": "2025-08-11_18-14-47", "timestamp": 1754928887, "time_this_iter_s": 9.324649333953857, "time_total_s": 201.93712425231934, "pid": 10455, "hostname": "Mac", "node_ip": "127.0.0.1", "config": {"exploration_config": {}, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 2, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "env": "Umbrella", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": false, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 0, "create_local_env_runner": true, "num_envs_per_env_runner": 1, "gym_env_vectorize_mode": "SYNC", "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "episodes_to_numpy": true, "max_requests_in_flight_per_env_runner": 1, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "merge_env_runner_states": "training_only", "broadcast_env_runner_states": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "complete_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "sampler_perf_stats_ema_coef": null, "_is_online": true, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": "auto", "num_aggregator_actors_per_learner": 0, "max_requests_in_flight_per_aggregator_actor": 3, "local_gpu_idx": 0, "max_requests_in_flight_per_learner": 3, "gamma": 1, "lr": 0.0002715581955, "grad_clip": 0.5, "grad_clip_by": "global_norm", "_train_batch_size_per_learner": 5000, "train_batch_size": 4000, "num_epochs": 1, "minibatch_size": 1000, "shuffle_batch_per_epoch": true, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "log_std_clip_param": 20.0, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "_disable_preprocessor_api": false, "_disable_action_flattening": false}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {"intrinsic_reward_coeff": 0.2795015916508}, "optimizer": {}, "_learner_class": "<class 'source.intrinsic_attention_ppo.learners.IntrinsicAttentionMetaLearner.IntrinsicAttentionMetaLearner'>", "callbacks_on_algorithm_init": null, "callbacks_on_env_runners_recreated": null, "callbacks_on_offline_eval_runners_recreated": null, "callbacks_on_checkpoint_loaded": null, "callbacks_on_environment_created": null, "callbacks_on_episode_created": null, "callbacks_on_episode_start": null, "callbacks_on_episode_step": null, "callbacks_on_episode_end": null, "callbacks_on_evaluate_start": null, "callbacks_on_evaluate_end": null, "callbacks_on_evaluate_offline_start": null, "callbacks_on_evaluate_offline_end": null, "callbacks_on_sample_end": null, "callbacks_on_train_result": null, "explore": true, "enable_rl_module_and_learner": true, "enable_env_runner_and_connector_v2": true, "_prior_exploration_config": {"type": "StochasticSampling"}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x1514e58a0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "offline_data_class": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_read_batch_size": null, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "materialize_data": false, "materialize_mapped_data": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "ignore_final_observation": false, "prelearner_class": null, "prelearner_buffer_class": null, "prelearner_buffer_kwargs": {}, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_remaining_data": false, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": 1, "evaluation_duration": 20, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_auto_duration_min_env_steps_per_sample": 100, "evaluation_auto_duration_max_env_steps_per_sample": 2000, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 1, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "offline_evaluation_interval": null, "num_offline_eval_runners": 0, "offline_loss_for_module_fn": null, "offline_evaluation_duration": 1, "offline_evaluation_parallel_to_training": false, "offline_evaluation_timeout_s": 120.0, "num_cpus_per_offline_eval_runner": 1, "num_gpus_per_offline_eval_runner": 0, "custom_resources_per_offline_eval_runner": {}, "restart_failed_offline_eval_runners": true, "ignore_offline_eval_runner_failures": false, "max_num_offline_eval_runner_restarts": 1000, "offline_eval_runner_restore_timeout_s": 1800.0, "max_requests_in_flight_per_offline_eval_runner": 1, "validate_offline_eval_runners_after_construction": true, "offline_eval_runner_health_probe_timeout_s": 30.0, "offline_eval_rl_module_inference_only": false, "broadcast_offline_eval_runner_states": false, "offline_eval_batch_size_per_runner": 256, "dataset_num_iters_per_eval_runner": 1, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "log_gradients": false, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 4, "restart_failed_env_runners": true, "ignore_env_runner_failures": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30.0, "env_runner_restore_timeout_s": 1800.0, "_model_config": {}, "_rl_module_spec": "MultiRLModuleSpec(multi_rl_module_class=<class 'ray.rllib.core.rl_module.multi_rl_module.MultiRLModule'>, observation_space=None, action_space=None, inference_only=False, model_config=None, rl_module_specs={'default_policy': RLModuleSpec(module_class=<class 'source.intrinsic_attention_ppo.rl_modules.DifferentiablePPOModule.DifferentiablePPOModule'>, observation_space=None, action_space=None, inference_only=False, learner_only=False, model_config={'vf_share_layers': True, 'embedding_dim': 62, 'max_seq_len': 11, 'policy_head_hidden_sizes': [32], 'value_head_hidden_sizes': [101], 'embedding_hidden_sizes': [121]}, catalog_class=None, load_state_path=None, model_config_dict=None), 'intrinsic_reward_module': RLModuleSpec(module_class=<class 'source.intrinsic_attention_ppo.rl_modules.IntrinsicAttentionModule.IntrinsicAttentionModule'>, observation_space=None, action_space=None, inference_only=False, learner_only=True, model_config={'intrinsic_reward_network': {'encoder_hidden_sizes': [], 'encoding_dim': 1, 'num_heads': 1, 'head_hidden_sizes': None, 'layers': [{'type': 'attention'}]}, 'extrinsic_value_hidden_layers': [127, 60], 'vf_share_layers': True, 'max_seq_len': 11}, catalog_class=None, load_state_path=None, model_config_dict=None)}, load_state_path=None, modules_to_load=None, module_specs={'default_policy': RLModuleSpec(module_class=<class 'source.intrinsic_attention_ppo.rl_modules.DifferentiablePPOModule.DifferentiablePPOModule'>, observation_space=None, action_space=None, inference_only=False, learner_only=False, model_config={'vf_share_layers': True, 'embedding_dim': 62, 'max_seq_len': 11, 'policy_head_hidden_sizes': [32], 'value_head_hidden_sizes': [101], 'embedding_hidden_sizes': [121]}, catalog_class=None, load_state_path=None, model_config_dict=None), 'intrinsic_reward_module': RLModuleSpec(module_class=<class 'source.intrinsic_attention_ppo.rl_modules.IntrinsicAttentionModule.IntrinsicAttentionModule'>, observation_space=None, action_space=None, inference_only=False, learner_only=True, model_config={'intrinsic_reward_network': {'encoder_hidden_sizes': [], 'encoding_dim': 1, 'num_heads': 1, 'head_hidden_sizes': None, 'layers': [{'type': 'attention'}]}, 'extrinsic_value_hidden_layers': [127, 60], 'vf_share_layers': True, 'max_seq_len': 11}, catalog_class=None, load_state_path=None, model_config_dict=None)})", "algorithm_config_overrides_per_module": {"intrinsic_reward_module": {"lr": 0.0002715581955}}, "_per_module_overrides": {}, "_validate_config": true, "_use_msgpack_checkpoints": false, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "env_task_fn": -1, "enable_connectors": -1, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.161583927863, "kl_target": 0.0201019014258, "vf_loss_coeff": 0.7790510010087, "entropy_coeff": 0.0015431216992, "clip_param": 0.2459212356676, "vf_clip_param": 0.3769744131561, "entropy_coeff_schedule": null, "lr_schedule": null, "sgd_minibatch_size": -1, "vf_share_layers": -1, "differentiable_learner_configs": ["DifferentiableLearnerConfig(learner_class=<class 'source.intrinsic_attention_ppo.learners.IntrinsicAttentionPPOLearner.IntrinsicAttentionPPOLearner'>, learner_connector=None, add_default_connectors_to_learner_pipeline=True, is_multi_agent=False, policies_to_update=['default_policy'], lr=0.0060984166342, num_total_minibatches=0, num_epochs=1, minibatch_size=1000, shuffle_batch_per_epoch=True)"], "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9485408017724, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.callbacks.callbacks.RLlibCallback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 201.93712425231934, "iterations_since_restore": 20, "perf": {"cpu_util_percent": 39.63846153846154, "ram_util_percent": 78.38461538461539}}
