{"timers": {"training_iteration": 11.650673374999315, "restore_env_runners": 9.08400397747755e-06, "training_step": 11.650479500065558, "env_runner_sampling_timer": 1.6742567499168217, "learner_update_timer": 9.767989707994275, "synch_weights": 0.0015982919139787555}, "env_runners": {"module_to_env_connector": {"connector_pipeline_timer": 0.00012917038445800144, "timers": {"connectors": {"remove_single_ts_time_rank_from_batch": 1.2405531519582544e-05, "normalize_and_clip_actions": 1.0372571938598834e-05, "get_actions": 4.4940358413205656e-05, "tensor_to_numpy": 1.6017061628446245e-05, "un_batch_to_individual_items": 6.904581349255665e-06, "listify_data_for_vector_env": 1.1069798415504318e-05}}}, "num_agent_steps_sampled_lifetime": {"default_agent": 627500.0}, "sample": 0.006569339851663534, "episode_len_mean": 20.0, "num_module_steps_sampled": {"default_policy": 5000.0}, "env_to_module_connector": {"connector_pipeline_timer": 6.436874177714233e-05, "timers": {"connectors": {"add_observations_from_episodes_to_batch": 3.015425688150733e-06, "batch_individual_items": 1.3128407681578644e-05, "numpy_to_tensor": 1.3767425501592277e-05, "add_time_dim_to_batch_and_zero_pad": 7.328446113858151e-06, "add_states_from_episodes_to_batch": 2.8500996400272783e-06}}}, "num_env_steps_sampled_lifetime": 627500.0, "episode_return_mean": -1.9, "episode_len_min": 20, "env_step_timer": 1.5087566574311838e-05, "num_module_steps_sampled_lifetime": {"default_policy": 627500.0}, "env_to_module_sum_episodes_length_in": 10.191744832559449, "episode_len_max": 20, "module_episode_returns_mean": {"default_policy": -1.9}, "time_between_sampling": 0.0005307977198966151, "num_agent_steps_sampled": {"default_agent": 5000.0}, "episode_duration_sec_mean": 0.005794382850639521, "num_env_steps_sampled": 5000.0, "weights_seq_no": 0.0, "num_episodes": 250.0, "episode_return_max": 8.5, "agent_episode_returns_mean": {"default_agent": -1.9}, "num_episodes_lifetime": 31375.0, "env_reset_timer": 8.91129661355258e-05, "env_to_module_sum_episodes_length_out": 10.191744832559449, "rlmodule_inference_timer": 5.530432548001708e-05, "episode_return_min": -11.5, "num_env_steps_sampled_lifetime_throughput": 2946.0225841983547}, "__all_modules__": {"learner_connector_sum_episodes_length_in": 5000, "learner_connector": {"connector_pipeline_timer": 0.170024250051938, "timers": {"connectors": {"add_one_ts_to_episodes_and_truncate": 0.008913707919418812, "add_observations_from_episodes_to_batch": 0.0008492079796269536, "add_columns_from_episodes_to_train_batch": 0.04085558303631842, "add_time_dim_to_batch_and_zero_pad": 0.1029449999332428, "add_states_from_episodes_to_batch": 0.003506625071167946, "batch_individual_items": 0.01270116597879678, "numpy_to_tensor": 8.191599044948816e-05}}}, "learner_connector_sum_episodes_length_out": 5250}, "learners": {"differentiable_learners": {"intrinsic_attention_ppo_learner": {"intrinsic_reward_module": {"module_train_batch_size_mean": 999.0, "num_module_steps_trained_lifetime": 35964, "diff_num_grad_updates_vs_sampler_policy": 6.0, "num_module_steps_trained": 35964, "weights_seq_no": 6.0, "total_loss": 0.0}, "default_policy": {"num_module_steps_trained": 35964, "use_intrinsic_rewards": 1.0, "weights_seq_no": 6.0, "module_train_batch_size_mean": 999.0, "vf_loss": 0.2630898952484131, "entropy": 0.692986011505127, "diff_num_grad_updates_vs_sampler_policy": 6.0, "policy_loss": -4.739691212307662e-05, "num_module_steps_trained_lifetime": 35964, "vf_loss_unclipped": 40.80678939819336, "vf_explained_var": -0.002830028533935547, "mean_kl_loss": 8.984894520835951e-06, "total_loss": 0.20384512841701508}, "__all_modules__": {"num_env_steps_trained": 189000, "num_module_steps_trained_lifetime": 71928, "num_env_steps_trained_lifetime": 189000, "num_module_steps_trained": 71928, "num_env_steps_trained_lifetime_throughput": 46732.02087474282}}}, "IntrinsicAttentionMask": [[[0.3283258080482483, 0.3333081305027008, 0.3383660614490509], [0.32843253016471863, 0.33330920338630676, 0.338258296251297], [0.3285391926765442, 0.33331021666526794, 0.3381505012512207]], [[0.3407737612724304, 0.3153233528137207, 0.3439028859138489], [0.34921345114707947, 0.2944938838481903, 0.3562926948070526], [0.3397468030452728, 0.31782761216163635, 0.34242552518844604]], [[0.35863012075424194, 0.31703293323516846, 0.3243369460105896], [0.38479143381118774, 0.30058807134628296, 0.3146204948425293], [0.3799048066139221, 0.3036297857761383, 0.31646543741226196]], [[0.3133503198623657, 0.30861276388168335, 0.37803688645362854], [0.31219446659088135, 0.3072141408920288, 0.38059142231941223], [0.32720619440078735, 0.32563793659210205, 0.3471558094024658]], [[0.2889806032180786, 0.35332563519477844, 0.3576936721801758], [0.30755695700645447, 0.3450058400630951, 0.3474372327327728], [0.3087136447429657, 0.34448516368865967, 0.3468012809753418]], [[0.14572180807590485, 0.6915856599807739, 0.1626925766468048], [0.6754077672958374, 2.1410591216408648e-05, 0.32457077503204346], [0.24422352015972137, 0.49889498949050903, 0.256881445646286]]], "default_policy": {"entropy": 0.6929866075515747, "diff_num_grad_updates_vs_sampler_policy": 1.0, "policy_loss": -4.823450944968499e-05, "num_module_steps_trained_lifetime": 5994, "vf_loss_unclipped": 40.56212615966797, "vf_explained_var": 0.0021167397499084473, "module_train_batch_size_mean": 999.0, "num_trainable_parameters": 16595, "total_loss": 0.20370948314666748, "num_module_steps_trained": 5994, "use_intrinsic_rewards": 0.0, "weights_seq_no": 1.0, "curr_entropy_coeff": 0.0015431216992, "mean_kl_loss": 9.149351171799935e-06, "curr_kl_coeff": 0.08079196512699127, "vf_loss": 0.26291683316230774, "num_module_steps_trained_lifetime_throughput": 560.2628759528619}, "intrinsic_reward_module": {"diff_num_grad_updates_vs_sampler_policy": 1.0, "gradients_default_optimizer_global_norm": 0.0, "num_trainable_parameters": 8266, "weights_seq_no": 1.0, "default_optimizer_learning_rate": 0.0002715581955, "total_loss": 0.0, "num_module_steps_trained": 5994, "module_train_batch_size_mean": 999.0, "curr_entropy_coeff": 0.0015431216992, "num_module_steps_trained_lifetime": 5994, "num_module_steps_trained_lifetime_throughput": 560.2674610364572}, "__all_modules__": {"num_non_trainable_parameters": 0, "num_module_steps_trained_lifetime": 11988, "num_env_steps_trained_lifetime": 31500, "num_trainable_parameters": 24861, "num_env_steps_trained": 31500, "num_module_steps_trained": 11988, "num_env_steps_trained_lifetime_throughput": 2944.4651589428204, "num_module_steps_trained_throughput": 17199932.975906428, "num_module_steps_trained_lifetime_throughput": 8625882.59700102}}, "num_training_step_calls_per_iteration": 1, "num_env_steps_sampled_lifetime": 627500.0, "evaluation": {"env_runners": {"env_to_module_connector": {"timers": {"connectors": {"numpy_to_tensor": 1.379730468330117e-05, "add_states_from_episodes_to_batch": 2.8260910766410944e-06, "batch_individual_items": 1.3935740743619527e-05, "add_time_dim_to_batch_and_zero_pad": 9.203808332218885e-06, "add_observations_from_episodes_to_batch": 3.80666103926372e-06}}, "connector_pipeline_timer": 7.04454732310564e-05}, "module_to_env_connector": {"timers": {"connectors": {"tensor_to_numpy": 1.833465518862937e-05, "un_batch_to_individual_items": 7.062622349048779e-06, "listify_data_for_vector_env": 1.0678745853437644e-05, "remove_single_ts_time_rank_from_batch": 1.2987132458274773e-05, "normalize_and_clip_actions": 9.676211530472571e-06, "get_actions": 5.1079628381818507e-05}}, "connector_pipeline_timer": 0.0001364714553562273}, "module_episode_returns_mean": {"default_policy": -2.2}, "env_reset_timer": 0.0005916249938309193, "episode_len_mean": 20.0, "num_env_steps_sampled_lifetime": 5400, "num_module_steps_sampled": {"default_policy": 400}, "episode_len_max": 20, "episode_return_max": 12.5, "num_env_steps_sampled": 400, "num_module_steps_sampled_lifetime": {"default_policy": 400}, "agent_episode_returns_mean": {"default_agent": -2.2}, "episode_return_min": -14.5, "sample": 0.12116745789535344, "num_agent_steps_sampled_lifetime": {"default_agent": 400}, "env_step_timer": 1.6577112943433578e-05, "weights_seq_no": 1.0, "rlmodule_inference_timer": 4.245763875262688e-05, "num_agent_steps_sampled": {"default_agent": 400}, "episode_duration_sec_mean": 0.005506506259553135, "num_episodes": 20, "num_episodes_lifetime": 20, "env_to_module_sum_episodes_length_out": 10.216013141322508, "episode_return_mean": -2.2, "episode_len_min": 20, "env_to_module_sum_episodes_length_in": 10.216013141322508}, "num_healthy_workers": 1, "actor_manager_num_outstanding_async_reqs": 0, "num_remote_worker_restarts": 0}, "fault_tolerance": {"num_healthy_workers": 0, "num_remote_worker_restarts": 0}, "env_runner_group": {"actor_manager_num_outstanding_async_reqs": 0}, "done": false, "training_iteration": 1, "trial_id": "aea65_00000", "date": "2025-08-11_18-18-25", "timestamp": 1754929105, "time_this_iter_s": 11.78651475906372, "time_total_s": 11.78651475906372, "pid": 10689, "hostname": "Mac", "node_ip": "127.0.0.1", "config": {"exploration_config": {}, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 2, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "env": "Umbrella", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": false, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 0, "create_local_env_runner": true, "num_envs_per_env_runner": 1, "gym_env_vectorize_mode": "SYNC", "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "episodes_to_numpy": true, "max_requests_in_flight_per_env_runner": 1, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "merge_env_runner_states": "training_only", "broadcast_env_runner_states": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "complete_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "sampler_perf_stats_ema_coef": null, "_is_online": true, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": "auto", "num_aggregator_actors_per_learner": 0, "max_requests_in_flight_per_aggregator_actor": 3, "local_gpu_idx": 0, "max_requests_in_flight_per_learner": 3, "gamma": 1, "lr": 0.0002715581955, "grad_clip": 0.5, "grad_clip_by": "global_norm", "_train_batch_size_per_learner": 5000, "train_batch_size": 4000, "num_epochs": 1, "minibatch_size": 1000, "shuffle_batch_per_epoch": true, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "log_std_clip_param": 20.0, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "_disable_preprocessor_api": false, "_disable_action_flattening": false}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {"intrinsic_reward_coeff": 0.2795015916508}, "optimizer": {}, "_learner_class": "<class 'source.intrinsic_attention_ppo.learners.IntrinsicAttentionMetaLearner.IntrinsicAttentionMetaLearner'>", "callbacks_on_algorithm_init": null, "callbacks_on_env_runners_recreated": null, "callbacks_on_offline_eval_runners_recreated": null, "callbacks_on_checkpoint_loaded": null, "callbacks_on_environment_created": null, "callbacks_on_episode_created": null, "callbacks_on_episode_start": null, "callbacks_on_episode_step": null, "callbacks_on_episode_end": null, "callbacks_on_evaluate_start": null, "callbacks_on_evaluate_end": null, "callbacks_on_evaluate_offline_start": null, "callbacks_on_evaluate_offline_end": null, "callbacks_on_sample_end": null, "callbacks_on_train_result": null, "explore": true, "enable_rl_module_and_learner": true, "enable_env_runner_and_connector_v2": true, "_prior_exploration_config": {"type": "StochasticSampling"}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x388285760>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "offline_data_class": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_read_batch_size": null, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "materialize_data": false, "materialize_mapped_data": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "ignore_final_observation": false, "prelearner_class": null, "prelearner_buffer_class": null, "prelearner_buffer_kwargs": {}, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_remaining_data": false, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": 1, "evaluation_duration": 20, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_auto_duration_min_env_steps_per_sample": 100, "evaluation_auto_duration_max_env_steps_per_sample": 2000, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 1, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "offline_evaluation_interval": null, "num_offline_eval_runners": 0, "offline_loss_for_module_fn": null, "offline_evaluation_duration": 1, "offline_evaluation_parallel_to_training": false, "offline_evaluation_timeout_s": 120.0, "num_cpus_per_offline_eval_runner": 1, "num_gpus_per_offline_eval_runner": 0, "custom_resources_per_offline_eval_runner": {}, "restart_failed_offline_eval_runners": true, "ignore_offline_eval_runner_failures": false, "max_num_offline_eval_runner_restarts": 1000, "offline_eval_runner_restore_timeout_s": 1800.0, "max_requests_in_flight_per_offline_eval_runner": 1, "validate_offline_eval_runners_after_construction": true, "offline_eval_runner_health_probe_timeout_s": 30.0, "offline_eval_rl_module_inference_only": false, "broadcast_offline_eval_runner_states": false, "offline_eval_batch_size_per_runner": 256, "dataset_num_iters_per_eval_runner": 1, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "log_gradients": false, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 2, "restart_failed_env_runners": true, "ignore_env_runner_failures": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30.0, "env_runner_restore_timeout_s": 1800.0, "_model_config": {}, "_rl_module_spec": "MultiRLModuleSpec(multi_rl_module_class=<class 'ray.rllib.core.rl_module.multi_rl_module.MultiRLModule'>, observation_space=None, action_space=None, inference_only=False, model_config=None, rl_module_specs={'default_policy': RLModuleSpec(module_class=<class 'source.intrinsic_attention_ppo.rl_modules.DifferentiablePPOModule.DifferentiablePPOModule'>, observation_space=None, action_space=None, inference_only=False, learner_only=False, model_config={'vf_share_layers': True, 'embedding_dim': 62, 'max_seq_len': 3, 'policy_head_hidden_sizes': [32], 'value_head_hidden_sizes': [101], 'embedding_hidden_sizes': [121]}, catalog_class=None, load_state_path=None, model_config_dict=None), 'intrinsic_reward_module': RLModuleSpec(module_class=<class 'source.intrinsic_attention_ppo.rl_modules.IntrinsicAttentionModule.IntrinsicAttentionModule'>, observation_space=None, action_space=None, inference_only=False, learner_only=True, model_config={'intrinsic_reward_network': {'encoder_hidden_sizes': [], 'encoding_dim': 1, 'num_heads': 1, 'head_hidden_sizes': None, 'layers': [{'type': 'attention'}]}, 'extrinsic_value_hidden_layers': [127, 60], 'vf_share_layers': True, 'max_seq_len': 3}, catalog_class=None, load_state_path=None, model_config_dict=None)}, load_state_path=None, modules_to_load=None, module_specs={'default_policy': RLModuleSpec(module_class=<class 'source.intrinsic_attention_ppo.rl_modules.DifferentiablePPOModule.DifferentiablePPOModule'>, observation_space=None, action_space=None, inference_only=False, learner_only=False, model_config={'vf_share_layers': True, 'embedding_dim': 62, 'max_seq_len': 3, 'policy_head_hidden_sizes': [32], 'value_head_hidden_sizes': [101], 'embedding_hidden_sizes': [121]}, catalog_class=None, load_state_path=None, model_config_dict=None), 'intrinsic_reward_module': RLModuleSpec(module_class=<class 'source.intrinsic_attention_ppo.rl_modules.IntrinsicAttentionModule.IntrinsicAttentionModule'>, observation_space=None, action_space=None, inference_only=False, learner_only=True, model_config={'intrinsic_reward_network': {'encoder_hidden_sizes': [], 'encoding_dim': 1, 'num_heads': 1, 'head_hidden_sizes': None, 'layers': [{'type': 'attention'}]}, 'extrinsic_value_hidden_layers': [127, 60], 'vf_share_layers': True, 'max_seq_len': 3}, catalog_class=None, load_state_path=None, model_config_dict=None)})", "algorithm_config_overrides_per_module": {"intrinsic_reward_module": {"lr": 0.0002715581955}}, "_per_module_overrides": {}, "_validate_config": true, "_use_msgpack_checkpoints": false, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "env_task_fn": -1, "enable_connectors": -1, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.161583927863, "kl_target": 0.0201019014258, "vf_loss_coeff": 0.7790510010087, "entropy_coeff": 0.0015431216992, "clip_param": 0.2459212356676, "vf_clip_param": 0.3769744131561, "entropy_coeff_schedule": null, "lr_schedule": null, "sgd_minibatch_size": -1, "vf_share_layers": -1, "differentiable_learner_configs": ["DifferentiableLearnerConfig(learner_class=<class 'source.intrinsic_attention_ppo.learners.IntrinsicAttentionPPOLearner.IntrinsicAttentionPPOLearner'>, learner_connector=None, add_default_connectors_to_learner_pipeline=True, is_multi_agent=False, policies_to_update=['default_policy'], lr=0.0060984166342, num_total_minibatches=0, num_epochs=1, minibatch_size=1000, shuffle_batch_per_epoch=True)"], "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9485408017724, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.callbacks.callbacks.RLlibCallback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 11.78651475906372, "iterations_since_restore": 1, "perf": {"cpu_util_percent": 47.352941176470594, "ram_util_percent": 82.02941176470588}}
{"timers": {"training_iteration": 11.648827581659425, "restore_env_runners": 9.121494367718698e-06, "training_step": 11.648632896734634, "env_runner_sampling_timer": 1.6731396786682309, "learner_update_timer": 9.76518511550501, "synch_weights": 0.001598139834823087, "restore_eval_env_runners": 5.6415912695229053e-05, "evaluation_iteration": 0.13332812499720603, "synch_eval_env_connectors": 0.00018495903350412846, "synch_env_connectors": 6.958027370274067e-06}, "env_runners": {"module_to_env_connector": {"connector_pipeline_timer": 0.00011971550718295376, "timers": {"connectors": {"remove_single_ts_time_rank_from_batch": 1.2124410256605141e-05, "normalize_and_clip_actions": 8.144532982697893e-06, "get_actions": 4.0158376759832145e-05, "tensor_to_numpy": 1.544792840049548e-05, "un_batch_to_individual_items": 6.691081023979967e-06, "listify_data_for_vector_env": 1.057586625064336e-05}}}, "num_agent_steps_sampled_lifetime": {"default_agent": 10000.0}, "sample": 0.005981216773067174, "episode_len_mean": 20.0, "num_module_steps_sampled": {"default_policy": 5000.0}, "env_to_module_connector": {"connector_pipeline_timer": 6.00872535540533e-05, "timers": {"connectors": {"add_observations_from_episodes_to_batch": 2.832851131122995e-06, "batch_individual_items": 1.257711750571824e-05, "numpy_to_tensor": 1.2795045911299634e-05, "add_time_dim_to_batch_and_zero_pad": 6.9731451362087644e-06, "add_states_from_episodes_to_batch": 2.7714860724396503e-06}}}, "num_env_steps_sampled_lifetime": 10000.0, "episode_return_mean": -1.2600000000000002, "episode_len_min": 20, "env_step_timer": 1.4104458246227337e-05, "num_module_steps_sampled_lifetime": {"default_policy": 10000.0}, "env_to_module_sum_episodes_length_in": 10.36823839457432, "episode_len_max": 20, "module_episode_returns_mean": {"default_policy": -1.2600000000000002}, "time_between_sampling": 0.037865742292923374, "num_agent_steps_sampled": {"default_agent": 5000.0}, "episode_duration_sec_mean": 0.0053463548067957155, "num_env_steps_sampled": 5000.0, "weights_seq_no": 1.0, "num_episodes": 250.0, "episode_return_max": 8.5, "agent_episode_returns_mean": {"default_agent": -1.2600000000000002}, "num_episodes_lifetime": 500.0, "env_reset_timer": 4.8021057173731705e-05, "env_to_module_sum_episodes_length_out": 10.36823839457432, "rlmodule_inference_timer": 3.220697126533112e-05, "episode_return_min": -11.5, "num_env_steps_sampled_lifetime_throughput": 3209.3013335151777}, "__all_modules__": {"learner_connector_sum_episodes_length_in": 5000.0, "learner_connector": {"connector_pipeline_timer": 0.17198104130220598, "timers": {"connectors": {"add_one_ts_to_episodes_and_truncate": 0.008913716259412466, "add_observations_from_episodes_to_batch": 0.0008491371502168477, "add_columns_from_episodes_to_train_batch": 0.04086078261607327, "add_time_dim_to_batch_and_zero_pad": 0.10294388743350283, "add_states_from_episodes_to_batch": 0.003509815480792895, "batch_individual_items": 0.014650948898633942, "numpy_to_tensor": 8.204433019272982e-05}}}, "learner_connector_sum_episodes_length_out": 5250.0}, "learners": {"differentiable_learners": {"intrinsic_attention_ppo_learner": {"intrinsic_reward_module": {"module_train_batch_size_mean": 999.0, "num_module_steps_trained_lifetime": 71928, "diff_num_grad_updates_vs_sampler_policy": 11.0, "num_module_steps_trained": 35964, "weights_seq_no": 12.0, "total_loss": 0.0}, "default_policy": {"num_module_steps_trained": 35964, "use_intrinsic_rewards": 1.0, "weights_seq_no": 12.0, "module_train_batch_size_mean": 999.0, "vf_loss": 0.26295924186706543, "entropy": 0.6930487155914307, "diff_num_grad_updates_vs_sampler_policy": 11.0, "policy_loss": -0.0002867782022804022, "num_module_steps_trained_lifetime": 71928, "vf_loss_unclipped": 37.58880615234375, "vf_explained_var": -0.002733588218688965, "mean_kl_loss": 3.3309181162621826e-05, "total_loss": 0.20350779592990875}, "__all_modules__": {"num_env_steps_trained": 189000, "num_module_steps_trained_lifetime": 143856, "num_env_steps_trained_lifetime": 378000, "num_module_steps_trained": 71928, "num_env_steps_trained_lifetime_throughput": 46489.764064769945}}}, "IntrinsicAttentionMask": [[[0.3172277510166168, 0.33895939588546753, 0.34381288290023804], [0.3189072608947754, 0.3383809030056, 0.34271183609962463], [0.31926822662353516, 0.3382563292980194, 0.34247544407844543]], [[0.3420586884021759, 0.3127417266368866, 0.3451996147632599], [0.3533662259578705, 0.28549519181251526, 0.3611385226249695], [0.3408566117286682, 0.3155992925167084, 0.3435440957546234]], [[0.35777801275253296, 0.3169635832309723, 0.32525843381881714], [0.3770028054714203, 0.3043935298919678, 0.31860360503196716], [0.3728695809841156, 0.30707454681396484, 0.32005584239959717]], [[0.3138214647769928, 0.31678247451782227, 0.36939600110054016], [0.314500629901886, 0.31736597418785095, 0.3681333661079407], [0.32550930976867676, 0.3267503082752228, 0.3477403223514557]], [[0.29006484150886536, 0.35816600918769836, 0.35176917910575867], [0.3134496510028839, 0.3446677029132843, 0.34188270568847656], [0.31141170859336853, 0.3458365201950073, 0.34275174140930176]], [[0.4320787191390991, 0.08949679881334305, 0.47842442989349365], [0.331243634223938, 6.390162525349297e-06, 0.668749988079071], [0.40938079357147217, 0.15461011230945587, 0.43600907921791077]]], "default_policy": {"entropy": 0.6930484771728516, "diff_num_grad_updates_vs_sampler_policy": 1.0, "policy_loss": -0.0002922981802839786, "num_module_steps_trained_lifetime": 11988, "vf_loss_unclipped": 37.59238815307617, "vf_explained_var": -0.0027472972869873047, "module_train_batch_size_mean": 999.0, "num_trainable_parameters": 16595, "total_loss": 0.2034526765346527, "num_module_steps_trained": 5994, "use_intrinsic_rewards": 0.0, "weights_seq_no": 2.0, "curr_entropy_coeff": 0.0015431216992, "mean_kl_loss": 3.4653836337383837e-05, "curr_kl_coeff": 0.040395982563495636, "vf_loss": 0.26289886236190796, "num_module_steps_trained_lifetime_throughput": 560.6478920484549}, "intrinsic_reward_module": {"diff_num_grad_updates_vs_sampler_policy": 1.0, "gradients_default_optimizer_global_norm": 0.0, "num_trainable_parameters": 8266, "weights_seq_no": 2.0, "default_optimizer_learning_rate": 0.0002715581955, "total_loss": 0.0, "num_module_steps_trained": 5994, "module_train_batch_size_mean": 999.0, "curr_entropy_coeff": 0.0015431216992, "num_module_steps_trained_lifetime": 11988, "num_module_steps_trained_lifetime_throughput": 560.652399564876}, "__all_modules__": {"num_non_trainable_parameters": 0, "num_module_steps_trained_lifetime": 23976, "num_env_steps_trained_lifetime": 63000, "num_trainable_parameters": 24861, "num_env_steps_trained": 31500, "num_module_steps_trained": 11988, "num_env_steps_trained_lifetime_throughput": 2946.486641669409, "num_module_steps_trained_throughput": 17085012.057420824, "num_module_steps_trained_lifetime_throughput": 8717947.61297557}}, "num_training_step_calls_per_iteration": 1, "evaluation": {"env_runners": {"env_to_module_connector": {"timers": {"connectors": {"numpy_to_tensor": 1.3536131006450397e-05, "add_states_from_episodes_to_batch": 2.902614062254966e-06, "batch_individual_items": 1.3555285856464208e-05, "add_time_dim_to_batch_and_zero_pad": 7.43240430936093e-06, "add_observations_from_episodes_to_batch": 2.8836524098203405e-06}}, "connector_pipeline_timer": 6.361135578382648e-05}, "module_to_env_connector": {"timers": {"connectors": {"tensor_to_numpy": 1.6945943382883647e-05, "un_batch_to_individual_items": 6.6927806486145146e-06, "listify_data_for_vector_env": 1.1293447851641785e-05, "remove_single_ts_time_rank_from_batch": 1.3828674966501509e-05, "normalize_and_clip_actions": 8.616737537319424e-06, "get_actions": 4.094232614586208e-05}}, "connector_pipeline_timer": 0.00012663557411178233}, "module_episode_returns_mean": {"default_policy": -3.2}, "env_reset_timer": 0.0005890695739071816, "episode_len_mean": 20.0, "num_env_steps_sampled_lifetime": 10400, "num_module_steps_sampled": {"default_policy": 400}, "episode_len_max": 20, "episode_return_max": 14.5, "num_env_steps_sampled": 400, "num_module_steps_sampled_lifetime": {"default_policy": 800}, "agent_episode_returns_mean": {"default_agent": -3.2}, "episode_return_min": -14.5, "sample": 0.12117205748567357, "num_agent_steps_sampled_lifetime": {"default_agent": 800}, "env_step_timer": 1.6931661725295708e-05, "weights_seq_no": 2.0, "rlmodule_inference_timer": 3.595363653838706e-05, "num_agent_steps_sampled": {"default_agent": 400}, "episode_duration_sec_mean": 0.005512810283107683, "num_episodes": 20, "num_episodes_lifetime": 40, "env_to_module_sum_episodes_length_out": 10.366003441359926, "episode_return_mean": -3.2, "episode_len_min": 20, "env_to_module_sum_episodes_length_in": 10.366003441359926, "time_between_sampling": 11.527502292068675}, "num_healthy_workers": 1, "actor_manager_num_outstanding_async_reqs": 0, "num_remote_worker_restarts": 0}, "num_env_steps_sampled_lifetime": 10000.0, "fault_tolerance": {"num_healthy_workers": 0, "num_remote_worker_restarts": 0}, "env_runner_group": {"actor_manager_num_outstanding_async_reqs": 0}, "done": false, "training_iteration": 2, "trial_id": "aea65_00000", "date": "2025-08-11_18-18-37", "timestamp": 1754929117, "time_this_iter_s": 11.600314855575562, "time_total_s": 23.386829614639282, "pid": 10689, "hostname": "Mac", "node_ip": "127.0.0.1", "config": {"exploration_config": {}, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 2, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "env": "Umbrella", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": false, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 0, "create_local_env_runner": true, "num_envs_per_env_runner": 1, "gym_env_vectorize_mode": "SYNC", "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "episodes_to_numpy": true, "max_requests_in_flight_per_env_runner": 1, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "merge_env_runner_states": "training_only", "broadcast_env_runner_states": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "complete_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "sampler_perf_stats_ema_coef": null, "_is_online": true, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": "auto", "num_aggregator_actors_per_learner": 0, "max_requests_in_flight_per_aggregator_actor": 3, "local_gpu_idx": 0, "max_requests_in_flight_per_learner": 3, "gamma": 1, "lr": 0.0002715581955, "grad_clip": 0.5, "grad_clip_by": "global_norm", "_train_batch_size_per_learner": 5000, "train_batch_size": 4000, "num_epochs": 1, "minibatch_size": 1000, "shuffle_batch_per_epoch": true, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "log_std_clip_param": 20.0, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "_disable_preprocessor_api": false, "_disable_action_flattening": false}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {"intrinsic_reward_coeff": 0.2795015916508}, "optimizer": {}, "_learner_class": "<class 'source.intrinsic_attention_ppo.learners.IntrinsicAttentionMetaLearner.IntrinsicAttentionMetaLearner'>", "callbacks_on_algorithm_init": null, "callbacks_on_env_runners_recreated": null, "callbacks_on_offline_eval_runners_recreated": null, "callbacks_on_checkpoint_loaded": null, "callbacks_on_environment_created": null, "callbacks_on_episode_created": null, "callbacks_on_episode_start": null, "callbacks_on_episode_step": null, "callbacks_on_episode_end": null, "callbacks_on_evaluate_start": null, "callbacks_on_evaluate_end": null, "callbacks_on_evaluate_offline_start": null, "callbacks_on_evaluate_offline_end": null, "callbacks_on_sample_end": null, "callbacks_on_train_result": null, "explore": true, "enable_rl_module_and_learner": true, "enable_env_runner_and_connector_v2": true, "_prior_exploration_config": {"type": "StochasticSampling"}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x388285760>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "offline_data_class": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_read_batch_size": null, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "materialize_data": false, "materialize_mapped_data": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "ignore_final_observation": false, "prelearner_class": null, "prelearner_buffer_class": null, "prelearner_buffer_kwargs": {}, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_remaining_data": false, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": 1, "evaluation_duration": 20, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_auto_duration_min_env_steps_per_sample": 100, "evaluation_auto_duration_max_env_steps_per_sample": 2000, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 1, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "offline_evaluation_interval": null, "num_offline_eval_runners": 0, "offline_loss_for_module_fn": null, "offline_evaluation_duration": 1, "offline_evaluation_parallel_to_training": false, "offline_evaluation_timeout_s": 120.0, "num_cpus_per_offline_eval_runner": 1, "num_gpus_per_offline_eval_runner": 0, "custom_resources_per_offline_eval_runner": {}, "restart_failed_offline_eval_runners": true, "ignore_offline_eval_runner_failures": false, "max_num_offline_eval_runner_restarts": 1000, "offline_eval_runner_restore_timeout_s": 1800.0, "max_requests_in_flight_per_offline_eval_runner": 1, "validate_offline_eval_runners_after_construction": true, "offline_eval_runner_health_probe_timeout_s": 30.0, "offline_eval_rl_module_inference_only": false, "broadcast_offline_eval_runner_states": false, "offline_eval_batch_size_per_runner": 256, "dataset_num_iters_per_eval_runner": 1, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "log_gradients": false, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 2, "restart_failed_env_runners": true, "ignore_env_runner_failures": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30.0, "env_runner_restore_timeout_s": 1800.0, "_model_config": {}, "_rl_module_spec": "MultiRLModuleSpec(multi_rl_module_class=<class 'ray.rllib.core.rl_module.multi_rl_module.MultiRLModule'>, observation_space=None, action_space=None, inference_only=False, model_config=None, rl_module_specs={'default_policy': RLModuleSpec(module_class=<class 'source.intrinsic_attention_ppo.rl_modules.DifferentiablePPOModule.DifferentiablePPOModule'>, observation_space=None, action_space=None, inference_only=False, learner_only=False, model_config={'vf_share_layers': True, 'embedding_dim': 62, 'max_seq_len': 3, 'policy_head_hidden_sizes': [32], 'value_head_hidden_sizes': [101], 'embedding_hidden_sizes': [121]}, catalog_class=None, load_state_path=None, model_config_dict=None), 'intrinsic_reward_module': RLModuleSpec(module_class=<class 'source.intrinsic_attention_ppo.rl_modules.IntrinsicAttentionModule.IntrinsicAttentionModule'>, observation_space=None, action_space=None, inference_only=False, learner_only=True, model_config={'intrinsic_reward_network': {'encoder_hidden_sizes': [], 'encoding_dim': 1, 'num_heads': 1, 'head_hidden_sizes': None, 'layers': [{'type': 'attention'}]}, 'extrinsic_value_hidden_layers': [127, 60], 'vf_share_layers': True, 'max_seq_len': 3}, catalog_class=None, load_state_path=None, model_config_dict=None)}, load_state_path=None, modules_to_load=None, module_specs={'default_policy': RLModuleSpec(module_class=<class 'source.intrinsic_attention_ppo.rl_modules.DifferentiablePPOModule.DifferentiablePPOModule'>, observation_space=None, action_space=None, inference_only=False, learner_only=False, model_config={'vf_share_layers': True, 'embedding_dim': 62, 'max_seq_len': 3, 'policy_head_hidden_sizes': [32], 'value_head_hidden_sizes': [101], 'embedding_hidden_sizes': [121]}, catalog_class=None, load_state_path=None, model_config_dict=None), 'intrinsic_reward_module': RLModuleSpec(module_class=<class 'source.intrinsic_attention_ppo.rl_modules.IntrinsicAttentionModule.IntrinsicAttentionModule'>, observation_space=None, action_space=None, inference_only=False, learner_only=True, model_config={'intrinsic_reward_network': {'encoder_hidden_sizes': [], 'encoding_dim': 1, 'num_heads': 1, 'head_hidden_sizes': None, 'layers': [{'type': 'attention'}]}, 'extrinsic_value_hidden_layers': [127, 60], 'vf_share_layers': True, 'max_seq_len': 3}, catalog_class=None, load_state_path=None, model_config_dict=None)})", "algorithm_config_overrides_per_module": {"intrinsic_reward_module": {"lr": 0.0002715581955}}, "_per_module_overrides": {}, "_validate_config": true, "_use_msgpack_checkpoints": false, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "env_task_fn": -1, "enable_connectors": -1, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.161583927863, "kl_target": 0.0201019014258, "vf_loss_coeff": 0.7790510010087, "entropy_coeff": 0.0015431216992, "clip_param": 0.2459212356676, "vf_clip_param": 0.3769744131561, "entropy_coeff_schedule": null, "lr_schedule": null, "sgd_minibatch_size": -1, "vf_share_layers": -1, "differentiable_learner_configs": ["DifferentiableLearnerConfig(learner_class=<class 'source.intrinsic_attention_ppo.learners.IntrinsicAttentionPPOLearner.IntrinsicAttentionPPOLearner'>, learner_connector=None, add_default_connectors_to_learner_pipeline=True, is_multi_agent=False, policies_to_update=['default_policy'], lr=0.0060984166342, num_total_minibatches=0, num_epochs=1, minibatch_size=1000, shuffle_batch_per_epoch=True)"], "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9485408017724, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.callbacks.callbacks.RLlibCallback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 23.386829614639282, "iterations_since_restore": 2, "perf": {"cpu_util_percent": 48.52941176470588, "ram_util_percent": 81.88235294117646}}
{"timers": {"training_iteration": 11.636718560842635, "restore_env_runners": 9.156948607414962e-06, "training_step": 11.636519900687073, "env_runner_sampling_timer": 1.6724487993819175, "learner_update_timer": 9.75359211892942, "synch_weights": 0.0016142209355602972, "restore_eval_env_runners": 5.636466317810118e-05, "evaluation_iteration": 0.13330794832785614, "synch_eval_env_connectors": 0.00018480986356735228, "synch_env_connectors": 7.0126180071383715e-06}, "env_runners": {"module_to_env_connector": {"connector_pipeline_timer": 0.00012107194941774838, "timers": {"connectors": {"remove_single_ts_time_rank_from_batch": 1.2161067611578231e-05, "normalize_and_clip_actions": 8.260679473035112e-06, "get_actions": 4.023628846938728e-05, "tensor_to_numpy": 1.568996665622974e-05, "un_batch_to_individual_items": 6.760459970805529e-06, "listify_data_for_vector_env": 1.1155962340281401e-05}}}, "num_agent_steps_sampled_lifetime": {"default_agent": -607500.0}, "sample": 0.005764552137933229, "episode_len_mean": 20.0, "num_module_steps_sampled": {"default_policy": 5000.0}, "env_to_module_connector": {"connector_pipeline_timer": 6.05174311040427e-05, "timers": {"connectors": {"add_observations_from_episodes_to_batch": 2.826285183484995e-06, "batch_individual_items": 1.264379665640498e-05, "numpy_to_tensor": 1.3145000569078207e-05, "add_time_dim_to_batch_and_zero_pad": 7.023629094801594e-06, "add_states_from_episodes_to_batch": 2.7941057209629745e-06}}}, "num_env_steps_sampled_lifetime": -607500.0, "episode_return_mean": -1.9, "episode_len_min": 20, "env_step_timer": 1.4159856093744815e-05, "num_module_steps_sampled_lifetime": {"default_policy": -607500.0}, "env_to_module_sum_episodes_length_in": 10.36823839457432, "episode_len_max": 20, "module_episode_returns_mean": {"default_policy": -1.9}, "time_between_sampling": 0.04056798802415078, "num_agent_steps_sampled": {"default_agent": 5000.0}, "episode_duration_sec_mean": 0.005416679997928438, "num_env_steps_sampled": 5000.0, "weights_seq_no": 2.0, "num_episodes": 250.0, "episode_return_max": 8.5, "agent_episode_returns_mean": {"default_agent": -1.9}, "num_episodes_lifetime": -30375.0, "env_reset_timer": 4.332121925807853e-05, "env_to_module_sum_episodes_length_out": 10.36823839457432, "rlmodule_inference_timer": 3.4436127557160635e-05, "episode_return_min": -11.5, "num_env_steps_sampled_lifetime_throughput": 3188.596631425527}, "__all_modules__": {"learner_connector_sum_episodes_length_in": 5000.0, "learner_connector": {"connector_pipeline_timer": 0.17201169129944174, "timers": {"connectors": {"add_one_ts_to_episodes_and_truncate": 0.008914022436784578, "add_observations_from_episodes_to_batch": 0.0008491536991437898, "add_columns_from_episodes_to_train_batch": 0.04086364854004933, "add_time_dim_to_batch_and_zero_pad": 0.10296099605888595, "add_states_from_episodes_to_batch": 0.0035134994163992816, "batch_individual_items": 0.014657494408602362, "numpy_to_tensor": 8.232721776003018e-05}}}, "learner_connector_sum_episodes_length_out": 5250.0}, "learners": {"differentiable_learners": {"intrinsic_attention_ppo_learner": {"intrinsic_reward_module": {"module_train_batch_size_mean": 999.0, "num_module_steps_trained_lifetime": 107892, "diff_num_grad_updates_vs_sampler_policy": 16.0, "num_module_steps_trained": 35964, "weights_seq_no": 18.0, "total_loss": 0.0}, "default_policy": {"num_module_steps_trained": 35964, "use_intrinsic_rewards": 1.0, "weights_seq_no": 18.0, "module_train_batch_size_mean": 999.0, "vf_loss": 0.26292333006858826, "entropy": 0.6930455565452576, "diff_num_grad_updates_vs_sampler_policy": 16.0, "policy_loss": -0.00017362262587994337, "num_module_steps_trained_lifetime": 107892, "vf_loss_unclipped": 39.6265983581543, "vf_explained_var": -0.0027724504470825195, "mean_kl_loss": 1.838213393057231e-05, "total_loss": 0.20359058678150177}, "__all_modules__": {"num_env_steps_trained": 189000, "num_module_steps_trained_lifetime": 215784, "num_env_steps_trained_lifetime": 567000, "num_module_steps_trained": 71928, "num_env_steps_trained_lifetime_throughput": 46078.22450403723}}}, "IntrinsicAttentionMask": [[[0.32391077280044556, 0.32882609963417053, 0.3472632169723511], [0.32411229610443115, 0.32892483472824097, 0.34696289896965027], [0.324842244386673, 0.32928162813186646, 0.34587612748146057]], [[0.33775240182876587, 0.31781667470932007, 0.34443098306655884], [0.3421907126903534, 0.30131906270980835, 0.35649019479751587], [0.3362388610839844, 0.3232226073741913, 0.3405385911464691]], [[0.36121666431427, 0.31819939613342285, 0.32058393955230713], [0.3822455108165741, 0.3068803548812866, 0.3108741343021393], [0.3809942305088043, 0.3075517416000366, 0.31145405769348145]], [[0.3063051998615265, 0.31787389516830444, 0.3758208155632019], [0.30939626693725586, 0.31972917914390564, 0.3708745837211609], [0.3233224153518677, 0.32780978083610535, 0.34886783361434937]], [[0.2900315523147583, 0.3478429913520813, 0.3621254563331604], [0.31014949083328247, 0.34127411246299744, 0.3485764265060425], [0.3147032558917999, 0.3397444784641266, 0.3455522656440735]], [[0.4261242747306824, 0.09043528139591217, 0.4834405481815338], [0.29761484265327454, 7.817823643563315e-06, 0.7023773789405823], [0.3983571529388428, 0.17586663365364075, 0.4257761538028717]]], "default_policy": {"entropy": 0.6930451393127441, "diff_num_grad_updates_vs_sampler_policy": 1.0, "policy_loss": -0.0001777587312972173, "num_module_steps_trained_lifetime": 17982, "vf_loss_unclipped": 39.58118438720703, "vf_explained_var": -0.0019844770431518555, "module_train_batch_size_mean": 999.0, "num_trainable_parameters": 16595, "total_loss": 0.2035309374332428, "num_module_steps_trained": 5994, "use_intrinsic_rewards": 0.0, "weights_seq_no": 3.0, "curr_entropy_coeff": 0.0015431216992, "mean_kl_loss": 1.9116165276500396e-05, "curr_kl_coeff": 0.020197991281747818, "vf_loss": 0.2628548741340637, "num_module_steps_trained_lifetime_throughput": 562.0538408449187}, "intrinsic_reward_module": {"diff_num_grad_updates_vs_sampler_policy": 1.0, "gradients_default_optimizer_global_norm": 0.0, "num_trainable_parameters": 8266, "weights_seq_no": 3.0, "default_optimizer_learning_rate": 0.0002715581955, "total_loss": 0.0, "num_module_steps_trained": 5994, "module_train_batch_size_mean": 999.0, "curr_entropy_coeff": 0.0015431216992, "num_module_steps_trained_lifetime": 17982, "num_module_steps_trained_lifetime_throughput": 562.0582417778066}, "__all_modules__": {"num_non_trainable_parameters": 0, "num_module_steps_trained_lifetime": 35964, "num_env_steps_trained_lifetime": 94500, "num_trainable_parameters": 24861, "num_env_steps_trained": 31500, "num_module_steps_trained": 11988, "num_env_steps_trained_lifetime_throughput": 2953.8720731609887, "num_module_steps_trained_throughput": 16905990.93576666, "num_module_steps_trained_lifetime_throughput": 8849036.771071391}}, "num_training_step_calls_per_iteration": 1, "evaluation": {"env_runners": {"env_to_module_connector": {"timers": {"connectors": {"numpy_to_tensor": 1.7128003475676025e-05, "add_states_from_episodes_to_batch": 3.447026782100574e-06, "batch_individual_items": 1.567201419423483e-05, "add_time_dim_to_batch_and_zero_pad": 9.218933189619924e-06, "add_observations_from_episodes_to_batch": 3.9557811881473704e-06}}, "connector_pipeline_timer": 7.58702750761279e-05}, "module_to_env_connector": {"timers": {"connectors": {"tensor_to_numpy": 2.052195835091988e-05, "un_batch_to_individual_items": 8.14359206726931e-06, "listify_data_for_vector_env": 1.3870166042158122e-05, "remove_single_ts_time_rank_from_batch": 1.3850197489029766e-05, "normalize_and_clip_actions": 1.0426052384210142e-05, "get_actions": 5.4307441041675884e-05}}, "connector_pipeline_timer": 0.0001542406710810548}, "module_episode_returns_mean": {"default_policy": -2.2}, "env_reset_timer": 0.0005867872083210386, "episode_len_mean": 20.0, "num_env_steps_sampled_lifetime": 15400, "num_module_steps_sampled": {"default_policy": 400}, "episode_len_max": 20, "episode_return_max": 14.5, "num_env_steps_sampled": 400, "num_module_steps_sampled_lifetime": {"default_policy": 1200}, "agent_episode_returns_mean": {"default_agent": -2.2}, "episode_return_min": -14.5, "sample": 0.12194473816177342, "num_agent_steps_sampled_lifetime": {"default_agent": 1200}, "env_step_timer": 1.9881228884240203e-05, "weights_seq_no": 3.0, "rlmodule_inference_timer": 4.693362846932061e-05, "num_agent_steps_sampled": {"default_agent": 400}, "episode_duration_sec_mean": 0.006712800623305763, "num_episodes": 20, "num_episodes_lifetime": 60, "env_to_module_sum_episodes_length_out": 10.368205581254823, "episode_return_mean": -2.2, "episode_len_min": 20, "env_to_module_sum_episodes_length_in": 10.368205581254823, "time_between_sampling": 11.516970184987876}, "num_healthy_workers": 1, "actor_manager_num_outstanding_async_reqs": 0, "num_remote_worker_restarts": 0}, "num_env_steps_sampled_lifetime": -607500.0, "fault_tolerance": {"num_healthy_workers": 0, "num_remote_worker_restarts": 0}, "env_runner_group": {"actor_manager_num_outstanding_async_reqs": 0}, "done": false, "training_iteration": 3, "trial_id": "aea65_00000", "date": "2025-08-11_18-18-47", "timestamp": 1754929127, "time_this_iter_s": 10.651832818984985, "time_total_s": 34.03866243362427, "pid": 10689, "hostname": "Mac", "node_ip": "127.0.0.1", "config": {"exploration_config": {}, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 2, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "env": "Umbrella", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": false, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 0, "create_local_env_runner": true, "num_envs_per_env_runner": 1, "gym_env_vectorize_mode": "SYNC", "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "episodes_to_numpy": true, "max_requests_in_flight_per_env_runner": 1, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "merge_env_runner_states": "training_only", "broadcast_env_runner_states": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "complete_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "sampler_perf_stats_ema_coef": null, "_is_online": true, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": "auto", "num_aggregator_actors_per_learner": 0, "max_requests_in_flight_per_aggregator_actor": 3, "local_gpu_idx": 0, "max_requests_in_flight_per_learner": 3, "gamma": 1, "lr": 0.0002715581955, "grad_clip": 0.5, "grad_clip_by": "global_norm", "_train_batch_size_per_learner": 5000, "train_batch_size": 4000, "num_epochs": 1, "minibatch_size": 1000, "shuffle_batch_per_epoch": true, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "log_std_clip_param": 20.0, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "_disable_preprocessor_api": false, "_disable_action_flattening": false}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {"intrinsic_reward_coeff": 0.2795015916508}, "optimizer": {}, "_learner_class": "<class 'source.intrinsic_attention_ppo.learners.IntrinsicAttentionMetaLearner.IntrinsicAttentionMetaLearner'>", "callbacks_on_algorithm_init": null, "callbacks_on_env_runners_recreated": null, "callbacks_on_offline_eval_runners_recreated": null, "callbacks_on_checkpoint_loaded": null, "callbacks_on_environment_created": null, "callbacks_on_episode_created": null, "callbacks_on_episode_start": null, "callbacks_on_episode_step": null, "callbacks_on_episode_end": null, "callbacks_on_evaluate_start": null, "callbacks_on_evaluate_end": null, "callbacks_on_evaluate_offline_start": null, "callbacks_on_evaluate_offline_end": null, "callbacks_on_sample_end": null, "callbacks_on_train_result": null, "explore": true, "enable_rl_module_and_learner": true, "enable_env_runner_and_connector_v2": true, "_prior_exploration_config": {"type": "StochasticSampling"}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x388285760>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "offline_data_class": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_read_batch_size": null, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "materialize_data": false, "materialize_mapped_data": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "ignore_final_observation": false, "prelearner_class": null, "prelearner_buffer_class": null, "prelearner_buffer_kwargs": {}, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_remaining_data": false, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": 1, "evaluation_duration": 20, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_auto_duration_min_env_steps_per_sample": 100, "evaluation_auto_duration_max_env_steps_per_sample": 2000, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 1, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "offline_evaluation_interval": null, "num_offline_eval_runners": 0, "offline_loss_for_module_fn": null, "offline_evaluation_duration": 1, "offline_evaluation_parallel_to_training": false, "offline_evaluation_timeout_s": 120.0, "num_cpus_per_offline_eval_runner": 1, "num_gpus_per_offline_eval_runner": 0, "custom_resources_per_offline_eval_runner": {}, "restart_failed_offline_eval_runners": true, "ignore_offline_eval_runner_failures": false, "max_num_offline_eval_runner_restarts": 1000, "offline_eval_runner_restore_timeout_s": 1800.0, "max_requests_in_flight_per_offline_eval_runner": 1, "validate_offline_eval_runners_after_construction": true, "offline_eval_runner_health_probe_timeout_s": 30.0, "offline_eval_rl_module_inference_only": false, "broadcast_offline_eval_runner_states": false, "offline_eval_batch_size_per_runner": 256, "dataset_num_iters_per_eval_runner": 1, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "log_gradients": false, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 2, "restart_failed_env_runners": true, "ignore_env_runner_failures": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30.0, "env_runner_restore_timeout_s": 1800.0, "_model_config": {}, "_rl_module_spec": "MultiRLModuleSpec(multi_rl_module_class=<class 'ray.rllib.core.rl_module.multi_rl_module.MultiRLModule'>, observation_space=None, action_space=None, inference_only=False, model_config=None, rl_module_specs={'default_policy': RLModuleSpec(module_class=<class 'source.intrinsic_attention_ppo.rl_modules.DifferentiablePPOModule.DifferentiablePPOModule'>, observation_space=None, action_space=None, inference_only=False, learner_only=False, model_config={'vf_share_layers': True, 'embedding_dim': 62, 'max_seq_len': 3, 'policy_head_hidden_sizes': [32], 'value_head_hidden_sizes': [101], 'embedding_hidden_sizes': [121]}, catalog_class=None, load_state_path=None, model_config_dict=None), 'intrinsic_reward_module': RLModuleSpec(module_class=<class 'source.intrinsic_attention_ppo.rl_modules.IntrinsicAttentionModule.IntrinsicAttentionModule'>, observation_space=None, action_space=None, inference_only=False, learner_only=True, model_config={'intrinsic_reward_network': {'encoder_hidden_sizes': [], 'encoding_dim': 1, 'num_heads': 1, 'head_hidden_sizes': None, 'layers': [{'type': 'attention'}]}, 'extrinsic_value_hidden_layers': [127, 60], 'vf_share_layers': True, 'max_seq_len': 3}, catalog_class=None, load_state_path=None, model_config_dict=None)}, load_state_path=None, modules_to_load=None, module_specs={'default_policy': RLModuleSpec(module_class=<class 'source.intrinsic_attention_ppo.rl_modules.DifferentiablePPOModule.DifferentiablePPOModule'>, observation_space=None, action_space=None, inference_only=False, learner_only=False, model_config={'vf_share_layers': True, 'embedding_dim': 62, 'max_seq_len': 3, 'policy_head_hidden_sizes': [32], 'value_head_hidden_sizes': [101], 'embedding_hidden_sizes': [121]}, catalog_class=None, load_state_path=None, model_config_dict=None), 'intrinsic_reward_module': RLModuleSpec(module_class=<class 'source.intrinsic_attention_ppo.rl_modules.IntrinsicAttentionModule.IntrinsicAttentionModule'>, observation_space=None, action_space=None, inference_only=False, learner_only=True, model_config={'intrinsic_reward_network': {'encoder_hidden_sizes': [], 'encoding_dim': 1, 'num_heads': 1, 'head_hidden_sizes': None, 'layers': [{'type': 'attention'}]}, 'extrinsic_value_hidden_layers': [127, 60], 'vf_share_layers': True, 'max_seq_len': 3}, catalog_class=None, load_state_path=None, model_config_dict=None)})", "algorithm_config_overrides_per_module": {"intrinsic_reward_module": {"lr": 0.0002715581955}}, "_per_module_overrides": {}, "_validate_config": true, "_use_msgpack_checkpoints": false, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "env_task_fn": -1, "enable_connectors": -1, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.161583927863, "kl_target": 0.0201019014258, "vf_loss_coeff": 0.7790510010087, "entropy_coeff": 0.0015431216992, "clip_param": 0.2459212356676, "vf_clip_param": 0.3769744131561, "entropy_coeff_schedule": null, "lr_schedule": null, "sgd_minibatch_size": -1, "vf_share_layers": -1, "differentiable_learner_configs": ["DifferentiableLearnerConfig(learner_class=<class 'source.intrinsic_attention_ppo.learners.IntrinsicAttentionPPOLearner.IntrinsicAttentionPPOLearner'>, learner_connector=None, add_default_connectors_to_learner_pipeline=True, is_multi_agent=False, policies_to_update=['default_policy'], lr=0.0060984166342, num_total_minibatches=0, num_epochs=1, minibatch_size=1000, shuffle_batch_per_epoch=True)"], "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9485408017724, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.callbacks.callbacks.RLlibCallback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 34.03866243362427, "iterations_since_restore": 3, "perf": {"cpu_util_percent": 39.88666666666666, "ram_util_percent": 82.18666666666667}}
{"timers": {"training_iteration": 11.628798107734077, "restore_env_runners": 9.184548829682173e-06, "training_step": 11.62859863168027, "env_runner_sampling_timer": 1.6772858405483428, "learner_update_timer": 9.74070130731956, "synch_weights": 0.0016069828964496264, "restore_eval_env_runners": 5.647726733004674e-05, "evaluation_iteration": 0.1340701071746531, "synch_eval_env_connectors": 0.00018563426490873097, "synch_env_connectors": 7.074991089757532e-06}, "env_runners": {"module_to_env_connector": {"connector_pipeline_timer": 0.00016674716416531895, "timers": {"connectors": {"remove_single_ts_time_rank_from_batch": 1.4463526629216249e-05, "normalize_and_clip_actions": 1.0163397029694454e-05, "get_actions": 6.565887445464568e-05, "tensor_to_numpy": 2.0500631891208812e-05, "un_batch_to_individual_items": 8.228132789888797e-06, "listify_data_for_vector_env": 1.4017384644496868e-05}}}, "num_agent_steps_sampled_lifetime": {"default_agent": -1225000.0}, "sample": 0.007697118124973794, "episode_len_mean": 20.0, "num_module_steps_sampled": {"default_policy": 5000.0}, "env_to_module_connector": {"connector_pipeline_timer": 7.727157393329241e-05, "timers": {"connectors": {"add_observations_from_episodes_to_batch": 3.540513639404404e-06, "batch_individual_items": 1.6908797734987783e-05, "numpy_to_tensor": 1.7929893897211714e-05, "add_time_dim_to_batch_and_zero_pad": 9.20784340548796e-06, "add_states_from_episodes_to_batch": 3.3914880275558378e-06}}}, "num_env_steps_sampled_lifetime": -1225000.0, "episode_return_mean": -1.9, "episode_len_min": 20, "env_step_timer": 2.4772922268258202e-05, "num_module_steps_sampled_lifetime": {"default_policy": -1225000.0}, "env_to_module_sum_episodes_length_in": 10.36823839457432, "episode_len_max": 20, "module_episode_returns_mean": {"default_policy": -1.9}, "time_between_sampling": 0.037349887564683985, "num_agent_steps_sampled": {"default_agent": 5000.0}, "episode_duration_sec_mean": 0.007435558123514056, "num_env_steps_sampled": 5000.0, "weights_seq_no": 3.0, "num_episodes": 250.0, "episode_return_max": 8.5, "agent_episode_returns_mean": {"default_agent": -1.9}, "num_episodes_lifetime": -61250.0, "env_reset_timer": 6.07703269466077e-05, "env_to_module_sum_episodes_length_out": 10.36823839457432, "rlmodule_inference_timer": 4.819040855344421e-05, "episode_return_min": -11.5, "num_env_steps_sampled_lifetime_throughput": 2758.264820235779}, "__all_modules__": {"learner_connector_sum_episodes_length_in": 5000.0, "learner_connector": {"connector_pipeline_timer": 0.1720239502271038, "timers": {"connectors": {"add_one_ts_to_episodes_and_truncate": 0.008927014302085617, "add_observations_from_episodes_to_batch": 0.0008499075817943086, "add_columns_from_episodes_to_train_batch": 0.040880797884660425, "add_time_dim_to_batch_and_zero_pad": 0.10294982359817602, "add_states_from_episodes_to_batch": 0.0035192444226868685, "batch_individual_items": 0.014642567794068603, "numpy_to_tensor": 8.412602491944563e-05}}}, "learner_connector_sum_episodes_length_out": 5250.0}, "learners": {"differentiable_learners": {"intrinsic_attention_ppo_learner": {"intrinsic_reward_module": {"module_train_batch_size_mean": 999.0, "num_module_steps_trained_lifetime": 143856, "diff_num_grad_updates_vs_sampler_policy": 21.0, "num_module_steps_trained": 35964, "weights_seq_no": 24.0, "total_loss": 0.0}, "default_policy": {"num_module_steps_trained": 35964, "use_intrinsic_rewards": 1.0, "weights_seq_no": 24.0, "module_train_batch_size_mean": 999.0, "vf_loss": 0.26289600133895874, "entropy": 0.6930047273635864, "diff_num_grad_updates_vs_sampler_policy": 21.0, "policy_loss": -0.00013702800788450986, "num_module_steps_trained_lifetime": 143856, "vf_loss_unclipped": 39.88587188720703, "vf_explained_var": -0.0027321577072143555, "mean_kl_loss": 1.687424082774669e-05, "total_loss": 0.20360568165779114}, "__all_modules__": {"num_env_steps_trained": 189000, "num_module_steps_trained_lifetime": 287712, "num_env_steps_trained_lifetime": 756000, "num_module_steps_trained": 71928, "num_env_steps_trained_lifetime_throughput": 45557.56338002102}}}, "IntrinsicAttentionMask": [[[0.32535699009895325, 0.334923654794693, 0.33971932530403137], [0.3257230222225189, 0.33485254645347595, 0.3394245207309723], [0.32590264081954956, 0.3348175287246704, 0.3392798602581024]], [[0.33775240182876587, 0.31781667470932007, 0.34443098306655884], [0.3421907424926758, 0.30131909251213074, 0.35649019479751587], [0.3362388610839844, 0.3232226073741913, 0.3405385911464691]], [[0.36190828680992126, 0.32119616866111755, 0.3168954849243164], [0.3782423138618469, 0.31413915753364563, 0.30761849880218506], [0.3801054060459137, 0.3133290708065033, 0.306565523147583]], [[0.3089054822921753, 0.31208333373069763, 0.3790111243724823], [0.30968886613845825, 0.31277409195899963, 0.3775370419025421], [0.3243781626224518, 0.3256148397922516, 0.35000696778297424]], [[0.2856755256652832, 0.3607215881347656, 0.35360291600227356], [0.30886131525039673, 0.3473012447357178, 0.3438374102115631], [0.30683985352516174, 0.3484638035297394, 0.34469640254974365]], [[0.14838288724422455, 0.6894316077232361, 0.16218549013137817], [0.6416000723838806, 2.7489963031257503e-05, 0.3583724796772003], [0.22595186531543732, 0.5364945530891418, 0.2375536412000656]]], "default_policy": {"entropy": 0.6930034756660461, "diff_num_grad_updates_vs_sampler_policy": 1.0, "policy_loss": -0.00014063561684451997, "num_module_steps_trained_lifetime": 23976, "vf_loss_unclipped": 39.784690856933594, "vf_explained_var": 0.0004557967185974121, "module_train_batch_size_mean": 999.0, "num_trainable_parameters": 16595, "total_loss": 0.20355010032653809, "num_module_steps_trained": 5994, "use_intrinsic_rewards": 0.0, "weights_seq_no": 4.0, "curr_entropy_coeff": 0.0015431216992, "mean_kl_loss": 1.7544094589538872e-05, "curr_kl_coeff": 0.010098995640873909, "vf_loss": 0.26283231377601624, "num_module_steps_trained_lifetime_throughput": 564.099208881266}, "intrinsic_reward_module": {"diff_num_grad_updates_vs_sampler_policy": 1.0, "gradients_default_optimizer_global_norm": 0.0, "num_trainable_parameters": 8266, "weights_seq_no": 4.0, "default_optimizer_learning_rate": 0.0002715581955, "total_loss": 0.0, "num_module_steps_trained": 5994, "module_train_batch_size_mean": 999.0, "curr_entropy_coeff": 0.0015431216992, "num_module_steps_trained_lifetime": 23976, "num_module_steps_trained_lifetime_throughput": 564.1034679908812}, "__all_modules__": {"num_non_trainable_parameters": 0, "num_module_steps_trained_lifetime": 47952, "num_env_steps_trained_lifetime": 126000, "num_trainable_parameters": 24861, "num_env_steps_trained": 31500, "num_module_steps_trained": 11988, "num_env_steps_trained_lifetime_throughput": 2964.6169822224824, "num_module_steps_trained_throughput": 16712193.802135814, "num_module_steps_trained_lifetime_throughput": 9005357.943847861}}, "num_training_step_calls_per_iteration": 1, "evaluation": {"env_runners": {"env_to_module_connector": {"timers": {"connectors": {"numpy_to_tensor": 1.2184764344344042e-05, "add_states_from_episodes_to_batch": 2.6803333602457813e-06, "batch_individual_items": 1.2425367936056797e-05, "add_time_dim_to_batch_and_zero_pad": 6.834284105742117e-06, "add_observations_from_episodes_to_batch": 2.7545407294918715e-06}}, "connector_pipeline_timer": 5.8665173695981983e-05}, "module_to_env_connector": {"timers": {"connectors": {"tensor_to_numpy": 1.5114498958221385e-05, "un_batch_to_individual_items": 6.4555415376091485e-06, "listify_data_for_vector_env": 1.0262695417204878e-05, "remove_single_ts_time_rank_from_batch": 1.1760470086875236e-05, "normalize_and_clip_actions": 7.898874604628742e-06, "get_actions": 3.707501577297472e-05}}, "connector_pipeline_timer": 0.00011450741655712341}, "module_episode_returns_mean": {"default_policy": -1.95}, "env_reset_timer": 0.0005841526670277816, "episode_len_mean": 20.0, "num_env_steps_sampled_lifetime": 20400, "num_module_steps_sampled": {"default_policy": 400}, "episode_len_max": 20, "episode_return_max": 14.5, "num_env_steps_sampled": 400, "num_module_steps_sampled_lifetime": {"default_policy": 1600}, "agent_episode_returns_mean": {"default_agent": -1.95}, "episode_return_min": -14.5, "sample": 0.12188184703021752, "num_agent_steps_sampled_lifetime": {"default_agent": 1600}, "env_step_timer": 1.4055536931788144e-05, "weights_seq_no": 4.0, "rlmodule_inference_timer": 3.172384076853807e-05, "num_agent_steps_sampled": {"default_agent": 400}, "episode_duration_sec_mean": 0.006352242642606143, "num_episodes": 20, "num_episodes_lifetime": 80, "env_to_module_sum_episodes_length_out": 10.368237912813044, "episode_return_mean": -1.95, "episode_len_min": 20, "env_to_module_sum_episodes_length_in": 10.368237912813044, "time_between_sampling": 11.510808778557623}, "num_healthy_workers": 1, "actor_manager_num_outstanding_async_reqs": 0, "num_remote_worker_restarts": 0}, "num_env_steps_sampled_lifetime": -1225000.0, "fault_tolerance": {"num_healthy_workers": 0, "num_remote_worker_restarts": 0}, "env_runner_group": {"actor_manager_num_outstanding_async_reqs": 0}, "done": false, "training_iteration": 4, "trial_id": "aea65_00000", "date": "2025-08-11_18-18-58", "timestamp": 1754929138, "time_this_iter_s": 10.97138786315918, "time_total_s": 45.01005029678345, "pid": 10689, "hostname": "Mac", "node_ip": "127.0.0.1", "config": {"exploration_config": {}, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 2, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "env": "Umbrella", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": false, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 0, "create_local_env_runner": true, "num_envs_per_env_runner": 1, "gym_env_vectorize_mode": "SYNC", "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "episodes_to_numpy": true, "max_requests_in_flight_per_env_runner": 1, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "merge_env_runner_states": "training_only", "broadcast_env_runner_states": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "complete_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "sampler_perf_stats_ema_coef": null, "_is_online": true, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": "auto", "num_aggregator_actors_per_learner": 0, "max_requests_in_flight_per_aggregator_actor": 3, "local_gpu_idx": 0, "max_requests_in_flight_per_learner": 3, "gamma": 1, "lr": 0.0002715581955, "grad_clip": 0.5, "grad_clip_by": "global_norm", "_train_batch_size_per_learner": 5000, "train_batch_size": 4000, "num_epochs": 1, "minibatch_size": 1000, "shuffle_batch_per_epoch": true, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "log_std_clip_param": 20.0, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "_disable_preprocessor_api": false, "_disable_action_flattening": false}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {"intrinsic_reward_coeff": 0.2795015916508}, "optimizer": {}, "_learner_class": "<class 'source.intrinsic_attention_ppo.learners.IntrinsicAttentionMetaLearner.IntrinsicAttentionMetaLearner'>", "callbacks_on_algorithm_init": null, "callbacks_on_env_runners_recreated": null, "callbacks_on_offline_eval_runners_recreated": null, "callbacks_on_checkpoint_loaded": null, "callbacks_on_environment_created": null, "callbacks_on_episode_created": null, "callbacks_on_episode_start": null, "callbacks_on_episode_step": null, "callbacks_on_episode_end": null, "callbacks_on_evaluate_start": null, "callbacks_on_evaluate_end": null, "callbacks_on_evaluate_offline_start": null, "callbacks_on_evaluate_offline_end": null, "callbacks_on_sample_end": null, "callbacks_on_train_result": null, "explore": true, "enable_rl_module_and_learner": true, "enable_env_runner_and_connector_v2": true, "_prior_exploration_config": {"type": "StochasticSampling"}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x388285760>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "offline_data_class": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_read_batch_size": null, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "materialize_data": false, "materialize_mapped_data": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "ignore_final_observation": false, "prelearner_class": null, "prelearner_buffer_class": null, "prelearner_buffer_kwargs": {}, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_remaining_data": false, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": 1, "evaluation_duration": 20, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_auto_duration_min_env_steps_per_sample": 100, "evaluation_auto_duration_max_env_steps_per_sample": 2000, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 1, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "offline_evaluation_interval": null, "num_offline_eval_runners": 0, "offline_loss_for_module_fn": null, "offline_evaluation_duration": 1, "offline_evaluation_parallel_to_training": false, "offline_evaluation_timeout_s": 120.0, "num_cpus_per_offline_eval_runner": 1, "num_gpus_per_offline_eval_runner": 0, "custom_resources_per_offline_eval_runner": {}, "restart_failed_offline_eval_runners": true, "ignore_offline_eval_runner_failures": false, "max_num_offline_eval_runner_restarts": 1000, "offline_eval_runner_restore_timeout_s": 1800.0, "max_requests_in_flight_per_offline_eval_runner": 1, "validate_offline_eval_runners_after_construction": true, "offline_eval_runner_health_probe_timeout_s": 30.0, "offline_eval_rl_module_inference_only": false, "broadcast_offline_eval_runner_states": false, "offline_eval_batch_size_per_runner": 256, "dataset_num_iters_per_eval_runner": 1, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "log_gradients": false, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 2, "restart_failed_env_runners": true, "ignore_env_runner_failures": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30.0, "env_runner_restore_timeout_s": 1800.0, "_model_config": {}, "_rl_module_spec": "MultiRLModuleSpec(multi_rl_module_class=<class 'ray.rllib.core.rl_module.multi_rl_module.MultiRLModule'>, observation_space=None, action_space=None, inference_only=False, model_config=None, rl_module_specs={'default_policy': RLModuleSpec(module_class=<class 'source.intrinsic_attention_ppo.rl_modules.DifferentiablePPOModule.DifferentiablePPOModule'>, observation_space=None, action_space=None, inference_only=False, learner_only=False, model_config={'vf_share_layers': True, 'embedding_dim': 62, 'max_seq_len': 3, 'policy_head_hidden_sizes': [32], 'value_head_hidden_sizes': [101], 'embedding_hidden_sizes': [121]}, catalog_class=None, load_state_path=None, model_config_dict=None), 'intrinsic_reward_module': RLModuleSpec(module_class=<class 'source.intrinsic_attention_ppo.rl_modules.IntrinsicAttentionModule.IntrinsicAttentionModule'>, observation_space=None, action_space=None, inference_only=False, learner_only=True, model_config={'intrinsic_reward_network': {'encoder_hidden_sizes': [], 'encoding_dim': 1, 'num_heads': 1, 'head_hidden_sizes': None, 'layers': [{'type': 'attention'}]}, 'extrinsic_value_hidden_layers': [127, 60], 'vf_share_layers': True, 'max_seq_len': 3}, catalog_class=None, load_state_path=None, model_config_dict=None)}, load_state_path=None, modules_to_load=None, module_specs={'default_policy': RLModuleSpec(module_class=<class 'source.intrinsic_attention_ppo.rl_modules.DifferentiablePPOModule.DifferentiablePPOModule'>, observation_space=None, action_space=None, inference_only=False, learner_only=False, model_config={'vf_share_layers': True, 'embedding_dim': 62, 'max_seq_len': 3, 'policy_head_hidden_sizes': [32], 'value_head_hidden_sizes': [101], 'embedding_hidden_sizes': [121]}, catalog_class=None, load_state_path=None, model_config_dict=None), 'intrinsic_reward_module': RLModuleSpec(module_class=<class 'source.intrinsic_attention_ppo.rl_modules.IntrinsicAttentionModule.IntrinsicAttentionModule'>, observation_space=None, action_space=None, inference_only=False, learner_only=True, model_config={'intrinsic_reward_network': {'encoder_hidden_sizes': [], 'encoding_dim': 1, 'num_heads': 1, 'head_hidden_sizes': None, 'layers': [{'type': 'attention'}]}, 'extrinsic_value_hidden_layers': [127, 60], 'vf_share_layers': True, 'max_seq_len': 3}, catalog_class=None, load_state_path=None, model_config_dict=None)})", "algorithm_config_overrides_per_module": {"intrinsic_reward_module": {"lr": 0.0002715581955}}, "_per_module_overrides": {}, "_validate_config": true, "_use_msgpack_checkpoints": false, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "env_task_fn": -1, "enable_connectors": -1, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.161583927863, "kl_target": 0.0201019014258, "vf_loss_coeff": 0.7790510010087, "entropy_coeff": 0.0015431216992, "clip_param": 0.2459212356676, "vf_clip_param": 0.3769744131561, "entropy_coeff_schedule": null, "lr_schedule": null, "sgd_minibatch_size": -1, "vf_share_layers": -1, "differentiable_learner_configs": ["DifferentiableLearnerConfig(learner_class=<class 'source.intrinsic_attention_ppo.learners.IntrinsicAttentionPPOLearner.IntrinsicAttentionPPOLearner'>, learner_connector=None, add_default_connectors_to_learner_pipeline=True, is_multi_agent=False, policies_to_update=['default_policy'], lr=0.0060984166342, num_total_minibatches=0, num_epochs=1, minibatch_size=1000, shuffle_batch_per_epoch=True)"], "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9485408017724, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.callbacks.callbacks.RLlibCallback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 45.01005029678345, "iterations_since_restore": 4, "perf": {"cpu_util_percent": 45.212500000000006, "ram_util_percent": 82.43125}}
{"timers": {"training_iteration": 11.625089361657041, "restore_env_runners": 9.150203197142112e-06, "training_step": 11.624889690363393, "env_runner_sampling_timer": 1.6757390404718493, "learner_update_timer": 9.738467375496759, "synch_weights": 0.00160065056770753, "restore_eval_env_runners": 5.604374478303361e-05, "evaluation_iteration": 0.13396899777336196, "synch_eval_env_connectors": 0.00018477833267115055, "synch_env_connectors": 7.072150892694481e-06}, "env_runners": {"module_to_env_connector": {"connector_pipeline_timer": 0.00011718419177527823, "timers": {"connectors": {"remove_single_ts_time_rank_from_batch": 1.1935481135529714e-05, "normalize_and_clip_actions": 7.975550123679672e-06, "get_actions": 3.8752133422831944e-05, "tensor_to_numpy": 1.5081074962649019e-05, "un_batch_to_individual_items": 6.562973356831904e-06, "listify_data_for_vector_env": 1.0592602992890657e-05}}}, "num_agent_steps_sampled_lifetime": {"default_agent": -1842500.0}, "sample": 0.005923298325671524, "episode_len_mean": 20.0, "num_module_steps_sampled": {"default_policy": 5000.0}, "env_to_module_connector": {"connector_pipeline_timer": 5.904456716417667e-05, "timers": {"connectors": {"add_observations_from_episodes_to_batch": 2.784245947183135e-06, "batch_individual_items": 1.2358393681886674e-05, "numpy_to_tensor": 1.2503688022525502e-05, "add_time_dim_to_batch_and_zero_pad": 6.806199445382821e-06, "add_states_from_episodes_to_batch": 2.7385191194062236e-06}}}, "num_env_steps_sampled_lifetime": -1842500.0, "episode_return_mean": -2.0599999999999996, "episode_len_min": 20, "env_step_timer": 1.3738467570886031e-05, "num_module_steps_sampled_lifetime": {"default_policy": -1842500.0}, "env_to_module_sum_episodes_length_in": 10.36823839457432, "episode_len_max": 20, "module_episode_returns_mean": {"default_policy": -2.0599999999999996}, "time_between_sampling": 0.03598061047592221, "num_agent_steps_sampled": {"default_agent": 5000.0}, "episode_duration_sec_mean": 0.005227985328063369, "num_env_steps_sampled": 5000.0, "weights_seq_no": 4.0, "num_episodes": 250.0, "episode_return_max": 8.5, "agent_episode_returns_mean": {"default_agent": -2.0599999999999996}, "num_episodes_lifetime": -92125.0, "env_reset_timer": 4.397372426793991e-05, "env_to_module_sum_episodes_length_out": 10.36823839457432, "rlmodule_inference_timer": 3.1425840981429316e-05, "episode_return_min": -11.5, "num_env_steps_sampled_lifetime_throughput": 3264.04251167217}, "__all_modules__": {"learner_connector_sum_episodes_length_in": 5000.0, "learner_connector": {"connector_pipeline_timer": 0.17200266822488072, "timers": {"connectors": {"add_one_ts_to_episodes_and_truncate": 0.008923188328882253, "add_observations_from_episodes_to_batch": 0.000849764755867587, "add_columns_from_episodes_to_train_batch": 0.04087803740625095, "add_time_dim_to_batch_and_zero_pad": 0.10294840786217331, "add_states_from_episodes_to_batch": 0.0035228690574992906, "batch_individual_items": 0.014626604615928986, "numpy_to_tensor": 8.401309384819703e-05}}}, "learner_connector_sum_episodes_length_out": 5250.0}, "learners": {"differentiable_learners": {"intrinsic_attention_ppo_learner": {"intrinsic_reward_module": {"module_train_batch_size_mean": 999.0, "num_module_steps_trained_lifetime": 179820, "diff_num_grad_updates_vs_sampler_policy": 26.0, "num_module_steps_trained": 35964, "weights_seq_no": 30.0, "total_loss": 0.0}, "default_policy": {"num_module_steps_trained": 35964, "use_intrinsic_rewards": 1.0, "weights_seq_no": 30.0, "module_train_batch_size_mean": 999.0, "vf_loss": 0.2628720700740814, "entropy": 0.6928560733795166, "diff_num_grad_updates_vs_sampler_policy": 26.0, "policy_loss": -0.00041456628241576254, "num_module_steps_trained_lifetime": 179820, "vf_loss_unclipped": 39.324214935302734, "vf_explained_var": -0.002707242965698242, "mean_kl_loss": 3.858008494717069e-05, "total_loss": 0.20331323146820068}, "__all_modules__": {"num_env_steps_trained": 189000, "num_module_steps_trained_lifetime": 359640, "num_env_steps_trained_lifetime": 945000, "num_module_steps_trained": 71928, "num_env_steps_trained_lifetime_throughput": 44959.59478761048}}}, "IntrinsicAttentionMask": [[[0.32391077280044556, 0.32882606983184814, 0.3472631573677063], [0.32411229610443115, 0.3289248049259186, 0.3469628691673279], [0.3248422145843506, 0.32928162813186646, 0.3458760976791382]], [[0.3421097993850708, 0.3120559751987457, 0.34583425521850586], [0.35047096014022827, 0.29134947061538696, 0.35817956924438477], [0.3410918712615967, 0.3145463466644287, 0.3443617820739746]], [[0.36121666431427, 0.3181994557380676, 0.3205839693546295], [0.38224542140960693, 0.3068804144859314, 0.31087422370910645], [0.38099411129951477, 0.307551771402359, 0.3114541172981262]], [[0.30942901968955994, 0.31974872946739197, 0.3708222806453705], [0.31251776218414307, 0.32158008217811584, 0.36590221524238586], [0.3264268934726715, 0.3295484483242035, 0.3440246284008026]], [[0.28898054361343384, 0.3533256947994232, 0.35769370198249817], [0.3075569272041321, 0.3450058400630951, 0.3474372327327728], [0.3087135851383209, 0.34448516368865967, 0.3468012809753418]], [[0.42806652188301086, 0.10232696682214737, 0.46960654854774475], [0.33330145478248596, 7.420914698741399e-06, 0.6666911244392395], [0.4014338552951813, 0.17496752738952637, 0.42359861731529236]]], "default_policy": {"entropy": 0.6928512454032898, "diff_num_grad_updates_vs_sampler_policy": 1.0, "policy_loss": -0.00042691416456364095, "num_module_steps_trained_lifetime": 29970, "vf_loss_unclipped": 39.19056701660156, "vf_explained_var": 0.0015208125114440918, "module_train_batch_size_mean": 999.0, "num_trainable_parameters": 16595, "total_loss": 0.20327258110046387, "num_module_steps_trained": 5994, "use_intrinsic_rewards": 0.0, "weights_seq_no": 5.0, "curr_entropy_coeff": 0.0015431216992, "mean_kl_loss": 4.071129660587758e-05, "curr_kl_coeff": 0.0050494978204369545, "vf_loss": 0.26284319162368774, "num_module_steps_trained_lifetime_throughput": 565.9411663597504}, "intrinsic_reward_module": {"diff_num_grad_updates_vs_sampler_policy": 1.0, "gradients_default_optimizer_global_norm": 0.0, "num_trainable_parameters": 8266, "weights_seq_no": 5.0, "default_optimizer_learning_rate": 0.0002715581955, "total_loss": 0.0, "num_module_steps_trained": 5994, "module_train_batch_size_mean": 999.0, "curr_entropy_coeff": 0.0015431216992, "num_module_steps_trained_lifetime": 29970, "num_module_steps_trained_lifetime_throughput": 565.9452591507774}, "__all_modules__": {"num_non_trainable_parameters": 0, "num_module_steps_trained_lifetime": 59940, "num_env_steps_trained_lifetime": 157500, "num_trainable_parameters": 24861, "num_env_steps_trained": 31500, "num_module_steps_trained": 11988, "num_env_steps_trained_lifetime_throughput": 2974.292413441439, "num_module_steps_trained_throughput": 16499531.890548255, "num_module_steps_trained_lifetime_throughput": 9159554.16445646}}, "num_training_step_calls_per_iteration": 1, "evaluation": {"env_runners": {"env_to_module_connector": {"timers": {"connectors": {"numpy_to_tensor": 1.2054279320673516e-05, "add_states_from_episodes_to_batch": 2.6086647627478526e-06, "batch_individual_items": 1.2471087876403684e-05, "add_time_dim_to_batch_and_zero_pad": 6.712666863129849e-06, "add_observations_from_episodes_to_batch": 2.7011653128142752e-06}}, "connector_pipeline_timer": 5.820760244021394e-05}, "module_to_env_connector": {"timers": {"connectors": {"tensor_to_numpy": 1.5240482930090362e-05, "un_batch_to_individual_items": 6.463792436085804e-06, "listify_data_for_vector_env": 1.0225289483780884e-05, "remove_single_ts_time_rank_from_batch": 1.176543398306701e-05, "normalize_and_clip_actions": 7.922724363887435e-06, "get_actions": 3.705781732817516e-05}}, "connector_pipeline_timer": 0.00011440174950253526}, "module_episode_returns_mean": {"default_policy": -1.8}, "env_reset_timer": 0.0005813948902645951, "episode_len_mean": 20.0, "num_env_steps_sampled_lifetime": 25400, "num_module_steps_sampled": {"default_policy": 400}, "episode_len_max": 20, "episode_return_max": 14.5, "num_env_steps_sampled": 400, "num_module_steps_sampled_lifetime": {"default_policy": 2000}, "agent_episode_returns_mean": {"default_agent": -1.8}, "episode_return_min": -14.5, "sample": 0.12183155940057486, "num_agent_steps_sampled_lifetime": {"default_agent": 2000}, "env_step_timer": 1.3957337667763471e-05, "weights_seq_no": 5.0, "rlmodule_inference_timer": 3.242986608608149e-05, "num_agent_steps_sampled": {"default_agent": 400}, "episode_duration_sec_mean": 0.006146070762770251, "num_episodes": 20, "num_episodes_lifetime": 100, "env_to_module_sum_episodes_length_out": 10.368238387501162, "episode_return_mean": -1.8, "episode_len_min": 20, "env_to_module_sum_episodes_length_in": 10.368238387501162, "time_between_sampling": 11.508594539101598}, "num_healthy_workers": 1, "actor_manager_num_outstanding_async_reqs": 0, "num_remote_worker_restarts": 0}, "num_env_steps_sampled_lifetime": -1842500.0, "fault_tolerance": {"num_healthy_workers": 0, "num_remote_worker_restarts": 0}, "env_runner_group": {"actor_manager_num_outstanding_async_reqs": 0}, "done": false, "training_iteration": 5, "trial_id": "aea65_00000", "date": "2025-08-11_18-19-10", "timestamp": 1754929150, "time_this_iter_s": 11.386190176010132, "time_total_s": 56.39624047279358, "pid": 10689, "hostname": "Mac", "node_ip": "127.0.0.1", "config": {"exploration_config": {}, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 2, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "env": "Umbrella", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": false, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 0, "create_local_env_runner": true, "num_envs_per_env_runner": 1, "gym_env_vectorize_mode": "SYNC", "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "episodes_to_numpy": true, "max_requests_in_flight_per_env_runner": 1, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "merge_env_runner_states": "training_only", "broadcast_env_runner_states": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "complete_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "sampler_perf_stats_ema_coef": null, "_is_online": true, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": "auto", "num_aggregator_actors_per_learner": 0, "max_requests_in_flight_per_aggregator_actor": 3, "local_gpu_idx": 0, "max_requests_in_flight_per_learner": 3, "gamma": 1, "lr": 0.0002715581955, "grad_clip": 0.5, "grad_clip_by": "global_norm", "_train_batch_size_per_learner": 5000, "train_batch_size": 4000, "num_epochs": 1, "minibatch_size": 1000, "shuffle_batch_per_epoch": true, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "log_std_clip_param": 20.0, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "_disable_preprocessor_api": false, "_disable_action_flattening": false}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {"intrinsic_reward_coeff": 0.2795015916508}, "optimizer": {}, "_learner_class": "<class 'source.intrinsic_attention_ppo.learners.IntrinsicAttentionMetaLearner.IntrinsicAttentionMetaLearner'>", "callbacks_on_algorithm_init": null, "callbacks_on_env_runners_recreated": null, "callbacks_on_offline_eval_runners_recreated": null, "callbacks_on_checkpoint_loaded": null, "callbacks_on_environment_created": null, "callbacks_on_episode_created": null, "callbacks_on_episode_start": null, "callbacks_on_episode_step": null, "callbacks_on_episode_end": null, "callbacks_on_evaluate_start": null, "callbacks_on_evaluate_end": null, "callbacks_on_evaluate_offline_start": null, "callbacks_on_evaluate_offline_end": null, "callbacks_on_sample_end": null, "callbacks_on_train_result": null, "explore": true, "enable_rl_module_and_learner": true, "enable_env_runner_and_connector_v2": true, "_prior_exploration_config": {"type": "StochasticSampling"}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x388285760>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "offline_data_class": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_read_batch_size": null, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "materialize_data": false, "materialize_mapped_data": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "ignore_final_observation": false, "prelearner_class": null, "prelearner_buffer_class": null, "prelearner_buffer_kwargs": {}, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_remaining_data": false, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": 1, "evaluation_duration": 20, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_auto_duration_min_env_steps_per_sample": 100, "evaluation_auto_duration_max_env_steps_per_sample": 2000, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 1, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "offline_evaluation_interval": null, "num_offline_eval_runners": 0, "offline_loss_for_module_fn": null, "offline_evaluation_duration": 1, "offline_evaluation_parallel_to_training": false, "offline_evaluation_timeout_s": 120.0, "num_cpus_per_offline_eval_runner": 1, "num_gpus_per_offline_eval_runner": 0, "custom_resources_per_offline_eval_runner": {}, "restart_failed_offline_eval_runners": true, "ignore_offline_eval_runner_failures": false, "max_num_offline_eval_runner_restarts": 1000, "offline_eval_runner_restore_timeout_s": 1800.0, "max_requests_in_flight_per_offline_eval_runner": 1, "validate_offline_eval_runners_after_construction": true, "offline_eval_runner_health_probe_timeout_s": 30.0, "offline_eval_rl_module_inference_only": false, "broadcast_offline_eval_runner_states": false, "offline_eval_batch_size_per_runner": 256, "dataset_num_iters_per_eval_runner": 1, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "log_gradients": false, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 2, "restart_failed_env_runners": true, "ignore_env_runner_failures": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30.0, "env_runner_restore_timeout_s": 1800.0, "_model_config": {}, "_rl_module_spec": "MultiRLModuleSpec(multi_rl_module_class=<class 'ray.rllib.core.rl_module.multi_rl_module.MultiRLModule'>, observation_space=None, action_space=None, inference_only=False, model_config=None, rl_module_specs={'default_policy': RLModuleSpec(module_class=<class 'source.intrinsic_attention_ppo.rl_modules.DifferentiablePPOModule.DifferentiablePPOModule'>, observation_space=None, action_space=None, inference_only=False, learner_only=False, model_config={'vf_share_layers': True, 'embedding_dim': 62, 'max_seq_len': 3, 'policy_head_hidden_sizes': [32], 'value_head_hidden_sizes': [101], 'embedding_hidden_sizes': [121]}, catalog_class=None, load_state_path=None, model_config_dict=None), 'intrinsic_reward_module': RLModuleSpec(module_class=<class 'source.intrinsic_attention_ppo.rl_modules.IntrinsicAttentionModule.IntrinsicAttentionModule'>, observation_space=None, action_space=None, inference_only=False, learner_only=True, model_config={'intrinsic_reward_network': {'encoder_hidden_sizes': [], 'encoding_dim': 1, 'num_heads': 1, 'head_hidden_sizes': None, 'layers': [{'type': 'attention'}]}, 'extrinsic_value_hidden_layers': [127, 60], 'vf_share_layers': True, 'max_seq_len': 3}, catalog_class=None, load_state_path=None, model_config_dict=None)}, load_state_path=None, modules_to_load=None, module_specs={'default_policy': RLModuleSpec(module_class=<class 'source.intrinsic_attention_ppo.rl_modules.DifferentiablePPOModule.DifferentiablePPOModule'>, observation_space=None, action_space=None, inference_only=False, learner_only=False, model_config={'vf_share_layers': True, 'embedding_dim': 62, 'max_seq_len': 3, 'policy_head_hidden_sizes': [32], 'value_head_hidden_sizes': [101], 'embedding_hidden_sizes': [121]}, catalog_class=None, load_state_path=None, model_config_dict=None), 'intrinsic_reward_module': RLModuleSpec(module_class=<class 'source.intrinsic_attention_ppo.rl_modules.IntrinsicAttentionModule.IntrinsicAttentionModule'>, observation_space=None, action_space=None, inference_only=False, learner_only=True, model_config={'intrinsic_reward_network': {'encoder_hidden_sizes': [], 'encoding_dim': 1, 'num_heads': 1, 'head_hidden_sizes': None, 'layers': [{'type': 'attention'}]}, 'extrinsic_value_hidden_layers': [127, 60], 'vf_share_layers': True, 'max_seq_len': 3}, catalog_class=None, load_state_path=None, model_config_dict=None)})", "algorithm_config_overrides_per_module": {"intrinsic_reward_module": {"lr": 0.0002715581955}}, "_per_module_overrides": {}, "_validate_config": true, "_use_msgpack_checkpoints": false, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "env_task_fn": -1, "enable_connectors": -1, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.161583927863, "kl_target": 0.0201019014258, "vf_loss_coeff": 0.7790510010087, "entropy_coeff": 0.0015431216992, "clip_param": 0.2459212356676, "vf_clip_param": 0.3769744131561, "entropy_coeff_schedule": null, "lr_schedule": null, "sgd_minibatch_size": -1, "vf_share_layers": -1, "differentiable_learner_configs": ["DifferentiableLearnerConfig(learner_class=<class 'source.intrinsic_attention_ppo.learners.IntrinsicAttentionPPOLearner.IntrinsicAttentionPPOLearner'>, learner_connector=None, add_default_connectors_to_learner_pipeline=True, is_multi_agent=False, policies_to_update=['default_policy'], lr=0.0060984166342, num_total_minibatches=0, num_epochs=1, minibatch_size=1000, shuffle_batch_per_epoch=True)"], "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9485408017724, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.callbacks.callbacks.RLlibCallback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 56.39624047279358, "iterations_since_restore": 5, "perf": {"cpu_util_percent": 47.01875, "ram_util_percent": 82.30625}}
{"timers": {"training_iteration": 11.616276474291357, "restore_env_runners": 9.118291840107463e-06, "training_step": 11.616076320959523, "env_runner_sampling_timer": 1.6742478975670978, "learner_update_timer": 9.731074905491507, "synch_weights": 0.0016004103124657176, "restore_eval_env_runners": 5.557913693567155e-05, "evaluation_iteration": 0.1338844040463077, "synch_eval_env_connectors": 0.00018407388983147216, "synch_env_connectors": 7.04475916655152e-06}, "env_runners": {"module_to_env_connector": {"connector_pipeline_timer": 0.00011737552906454455, "timers": {"connectors": {"remove_single_ts_time_rank_from_batch": 1.1926591172742767e-05, "normalize_and_clip_actions": 7.992419320927314e-06, "get_actions": 3.885151616627892e-05, "tensor_to_numpy": 1.5105498717091026e-05, "un_batch_to_individual_items": 6.600836623673992e-06, "listify_data_for_vector_env": 1.057186696491138e-05}}}, "num_agent_steps_sampled_lifetime": {"default_agent": -2460000.0}, "sample": 0.005630688724057565, "episode_len_mean": 20.0, "num_module_steps_sampled": {"default_policy": 5000.0}, "env_to_module_connector": {"connector_pipeline_timer": 5.9260239945508055e-05, "timers": {"connectors": {"add_observations_from_episodes_to_batch": 2.7762813270926795e-06, "batch_individual_items": 1.2465492851147421e-05, "numpy_to_tensor": 1.2546521678400963e-05, "add_time_dim_to_batch_and_zero_pad": 6.833682979205306e-06, "add_states_from_episodes_to_batch": 2.742231796425424e-06}}}, "num_env_steps_sampled_lifetime": -2460000.0, "episode_return_mean": -0.54, "episode_len_min": 20, "env_step_timer": 1.3843650682782306e-05, "num_module_steps_sampled_lifetime": {"default_policy": -2460000.0}, "env_to_module_sum_episodes_length_in": 10.36823839457432, "episode_len_max": 20, "module_episode_returns_mean": {"default_policy": -0.54}, "time_between_sampling": 0.03969136262031321, "num_agent_steps_sampled": {"default_agent": 5000.0}, "episode_duration_sec_mean": 0.005244796308223158, "num_env_steps_sampled": 5000.0, "weights_seq_no": 5.0, "num_episodes": 250.0, "episode_return_max": 8.5, "agent_episode_returns_mean": {"default_agent": -0.54}, "num_episodes_lifetime": -123000.0, "env_reset_timer": 3.991335507253419e-05, "env_to_module_sum_episodes_length_out": 10.36823839457432, "rlmodule_inference_timer": 3.170182088329164e-05, "episode_return_min": -11.5, "num_env_steps_sampled_lifetime_throughput": 3263.6129491778206}, "__all_modules__": {"learner_connector_sum_episodes_length_in": 5000.0, "learner_connector": {"connector_pipeline_timer": 0.17197880279321576, "timers": {"connectors": {"add_one_ts_to_episodes_and_truncate": 0.00892341269601886, "add_observations_from_episodes_to_batch": 0.0008493808580998479, "add_columns_from_episodes_to_train_batch": 0.04087794578207363, "add_time_dim_to_batch_and_zero_pad": 0.1029407883735538, "add_states_from_episodes_to_batch": 0.0035245811965198483, "batch_individual_items": 0.014609783570554168, "numpy_to_tensor": 8.390171234697272e-05}}}, "learner_connector_sum_episodes_length_out": 5250.0}, "learners": {"differentiable_learners": {"intrinsic_attention_ppo_learner": {"intrinsic_reward_module": {"module_train_batch_size_mean": 999.0, "num_module_steps_trained_lifetime": 215784, "diff_num_grad_updates_vs_sampler_policy": 31.0, "num_module_steps_trained": 35964, "weights_seq_no": 36.0, "total_loss": 0.0}, "default_policy": {"num_module_steps_trained": 35964, "use_intrinsic_rewards": 1.0, "weights_seq_no": 36.0, "module_train_batch_size_mean": 999.0, "vf_loss": 0.26287704706192017, "entropy": 0.6926493048667908, "diff_num_grad_updates_vs_sampler_policy": 31.0, "policy_loss": -0.0004446649400051683, "num_module_steps_trained_lifetime": 215784, "vf_loss_unclipped": 38.43851089477539, "vf_explained_var": -0.002649545669555664, "mean_kl_loss": 2.471252082614228e-05, "total_loss": 0.2032851129770279}, "__all_modules__": {"num_env_steps_trained": 189000, "num_module_steps_trained_lifetime": 431568, "num_env_steps_trained_lifetime": 1134000, "num_module_steps_trained": 71928, "num_env_steps_trained_lifetime_throughput": 44309.946682137444}}}, "IntrinsicAttentionMask": [[[0.3172277510166168, 0.33895939588546753, 0.34381288290023804], [0.3189072608947754, 0.33838093280792236, 0.34271183609962463], [0.31926819682121277, 0.3382563292980194, 0.34247544407844543]], [[0.34347113966941833, 0.3140331208705902, 0.34249579906463623], [0.35699182748794556, 0.2884245216846466, 0.35458362102508545], [0.3439088463783264, 0.31320157647132874, 0.34288954734802246]], [[0.364431232213974, 0.31646406650543213, 0.31910470128059387], [0.38553386926651, 0.3051171898841858, 0.3093489408493042], [0.3842785358428955, 0.3057900667190552, 0.3099313974380493]], [[0.3066956698894501, 0.31692421436309814, 0.3763801157474518], [0.31014493107795715, 0.31913843750953674, 0.3707166314125061], [0.32812365889549255, 0.33025065064430237, 0.3416256904602051]], [[0.28567564487457275, 0.36072152853012085, 0.3536028265953064], [0.3088613748550415, 0.3473012447357178, 0.3438374102115631], [0.30683985352516174, 0.348463773727417, 0.3446963429450989]], [[0.14838328957557678, 0.689430832862854, 0.1621858924627304], [0.6415995955467224, 2.7491070795804262e-05, 0.3583729863166809], [0.22595201432704926, 0.5364941954612732, 0.23755382001399994]]], "default_policy": {"entropy": 0.6926400065422058, "diff_num_grad_updates_vs_sampler_policy": 1.0, "policy_loss": -0.00046611158177256584, "num_module_steps_trained_lifetime": 35964, "vf_loss_unclipped": 38.32768249511719, "vf_explained_var": 0.0009474754333496094, "module_train_batch_size_mean": 999.0, "num_trainable_parameters": 16595, "total_loss": 0.20321732759475708, "num_module_steps_trained": 5994, "use_intrinsic_rewards": 0.0, "weights_seq_no": 6.0, "curr_entropy_coeff": 0.0015431216992, "mean_kl_loss": 2.7073501769336872e-05, "curr_kl_coeff": 0.0025247489102184772, "vf_loss": 0.2628225088119507, "num_module_steps_trained_lifetime_throughput": 567.8880933478612}, "intrinsic_reward_module": {"diff_num_grad_updates_vs_sampler_policy": 1.0, "gradients_default_optimizer_global_norm": 0.0, "num_trainable_parameters": 8266, "weights_seq_no": 6.0, "default_optimizer_learning_rate": 0.0002715581955, "total_loss": 0.0, "num_module_steps_trained": 5994, "module_train_batch_size_mean": 999.0, "curr_entropy_coeff": 0.0015431216992, "num_module_steps_trained_lifetime": 35964, "num_module_steps_trained_lifetime_throughput": 567.8919970984381}, "__all_modules__": {"num_non_trainable_parameters": 0, "num_module_steps_trained_lifetime": 71928, "num_env_steps_trained_lifetime": 189000, "num_trainable_parameters": 24861, "num_env_steps_trained": 31500, "num_module_steps_trained": 11988, "num_env_steps_trained_lifetime_throughput": 2984.519192711139, "num_module_steps_trained_throughput": 16284445.377081584, "num_module_steps_trained_lifetime_throughput": 9304436.8460207}}, "num_training_step_calls_per_iteration": 1, "evaluation": {"env_runners": {"env_to_module_connector": {"timers": {"connectors": {"numpy_to_tensor": 1.2042270626949818e-05, "add_states_from_episodes_to_batch": 2.6406693830546383e-06, "batch_individual_items": 1.2340316034442174e-05, "add_time_dim_to_batch_and_zero_pad": 6.775444559425088e-06, "add_observations_from_episodes_to_batch": 2.6997857346974436e-06}}, "connector_pipeline_timer": 5.833025535254967e-05}, "module_to_env_connector": {"timers": {"connectors": {"tensor_to_numpy": 1.5058396322621426e-05, "un_batch_to_individual_items": 6.467084901713399e-06, "listify_data_for_vector_env": 1.0255954091234158e-05, "remove_single_ts_time_rank_from_batch": 1.1712851323765732e-05, "normalize_and_clip_actions": 7.827076257909507e-06, "get_actions": 3.654870596473925e-05}}, "connector_pipeline_timer": 0.00011370153100293661}, "module_episode_returns_mean": {"default_policy": -1.8}, "env_reset_timer": 0.0005792384406902047, "episode_len_mean": 20.0, "num_env_steps_sampled_lifetime": 30400, "num_module_steps_sampled": {"default_policy": 400}, "episode_len_max": 20, "episode_return_max": 14.5, "num_env_steps_sampled": 400, "num_module_steps_sampled_lifetime": {"default_policy": 2400}, "agent_episode_returns_mean": {"default_agent": -1.8}, "episode_return_min": -14.5, "sample": 0.1217578258862926, "num_agent_steps_sampled_lifetime": {"default_agent": 2400}, "env_step_timer": 1.3879880768277082e-05, "weights_seq_no": 6.0, "rlmodule_inference_timer": 3.1270337853279726e-05, "num_agent_steps_sampled": {"default_agent": 400}, "episode_duration_sec_mean": 0.006088366588810459, "num_episodes": 20, "num_episodes_lifetime": 120, "env_to_module_sum_episodes_length_out": 10.368238394470474, "episode_return_mean": -1.8, "episode_len_min": 20, "env_to_module_sum_episodes_length_in": 10.368238394470474, "time_between_sampling": 11.501225099120498}, "num_healthy_workers": 1, "actor_manager_num_outstanding_async_reqs": 0, "num_remote_worker_restarts": 0}, "num_env_steps_sampled_lifetime": -2460000.0, "fault_tolerance": {"num_healthy_workers": 0, "num_remote_worker_restarts": 0}, "env_runner_group": {"actor_manager_num_outstanding_async_reqs": 0}, "done": false, "training_iteration": 6, "trial_id": "aea65_00000", "date": "2025-08-11_18-19-21", "timestamp": 1754929161, "time_this_iter_s": 10.870162010192871, "time_total_s": 67.26640248298645, "pid": 10689, "hostname": "Mac", "node_ip": "127.0.0.1", "config": {"exploration_config": {}, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 2, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "env": "Umbrella", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": false, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 0, "create_local_env_runner": true, "num_envs_per_env_runner": 1, "gym_env_vectorize_mode": "SYNC", "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "episodes_to_numpy": true, "max_requests_in_flight_per_env_runner": 1, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "merge_env_runner_states": "training_only", "broadcast_env_runner_states": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "complete_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "sampler_perf_stats_ema_coef": null, "_is_online": true, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": "auto", "num_aggregator_actors_per_learner": 0, "max_requests_in_flight_per_aggregator_actor": 3, "local_gpu_idx": 0, "max_requests_in_flight_per_learner": 3, "gamma": 1, "lr": 0.0002715581955, "grad_clip": 0.5, "grad_clip_by": "global_norm", "_train_batch_size_per_learner": 5000, "train_batch_size": 4000, "num_epochs": 1, "minibatch_size": 1000, "shuffle_batch_per_epoch": true, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "log_std_clip_param": 20.0, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "_disable_preprocessor_api": false, "_disable_action_flattening": false}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {"intrinsic_reward_coeff": 0.2795015916508}, "optimizer": {}, "_learner_class": "<class 'source.intrinsic_attention_ppo.learners.IntrinsicAttentionMetaLearner.IntrinsicAttentionMetaLearner'>", "callbacks_on_algorithm_init": null, "callbacks_on_env_runners_recreated": null, "callbacks_on_offline_eval_runners_recreated": null, "callbacks_on_checkpoint_loaded": null, "callbacks_on_environment_created": null, "callbacks_on_episode_created": null, "callbacks_on_episode_start": null, "callbacks_on_episode_step": null, "callbacks_on_episode_end": null, "callbacks_on_evaluate_start": null, "callbacks_on_evaluate_end": null, "callbacks_on_evaluate_offline_start": null, "callbacks_on_evaluate_offline_end": null, "callbacks_on_sample_end": null, "callbacks_on_train_result": null, "explore": true, "enable_rl_module_and_learner": true, "enable_env_runner_and_connector_v2": true, "_prior_exploration_config": {"type": "StochasticSampling"}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x388285760>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "offline_data_class": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_read_batch_size": null, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "materialize_data": false, "materialize_mapped_data": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "ignore_final_observation": false, "prelearner_class": null, "prelearner_buffer_class": null, "prelearner_buffer_kwargs": {}, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_remaining_data": false, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": 1, "evaluation_duration": 20, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_auto_duration_min_env_steps_per_sample": 100, "evaluation_auto_duration_max_env_steps_per_sample": 2000, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 1, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "offline_evaluation_interval": null, "num_offline_eval_runners": 0, "offline_loss_for_module_fn": null, "offline_evaluation_duration": 1, "offline_evaluation_parallel_to_training": false, "offline_evaluation_timeout_s": 120.0, "num_cpus_per_offline_eval_runner": 1, "num_gpus_per_offline_eval_runner": 0, "custom_resources_per_offline_eval_runner": {}, "restart_failed_offline_eval_runners": true, "ignore_offline_eval_runner_failures": false, "max_num_offline_eval_runner_restarts": 1000, "offline_eval_runner_restore_timeout_s": 1800.0, "max_requests_in_flight_per_offline_eval_runner": 1, "validate_offline_eval_runners_after_construction": true, "offline_eval_runner_health_probe_timeout_s": 30.0, "offline_eval_rl_module_inference_only": false, "broadcast_offline_eval_runner_states": false, "offline_eval_batch_size_per_runner": 256, "dataset_num_iters_per_eval_runner": 1, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "log_gradients": false, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 2, "restart_failed_env_runners": true, "ignore_env_runner_failures": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30.0, "env_runner_restore_timeout_s": 1800.0, "_model_config": {}, "_rl_module_spec": "MultiRLModuleSpec(multi_rl_module_class=<class 'ray.rllib.core.rl_module.multi_rl_module.MultiRLModule'>, observation_space=None, action_space=None, inference_only=False, model_config=None, rl_module_specs={'default_policy': RLModuleSpec(module_class=<class 'source.intrinsic_attention_ppo.rl_modules.DifferentiablePPOModule.DifferentiablePPOModule'>, observation_space=None, action_space=None, inference_only=False, learner_only=False, model_config={'vf_share_layers': True, 'embedding_dim': 62, 'max_seq_len': 3, 'policy_head_hidden_sizes': [32], 'value_head_hidden_sizes': [101], 'embedding_hidden_sizes': [121]}, catalog_class=None, load_state_path=None, model_config_dict=None), 'intrinsic_reward_module': RLModuleSpec(module_class=<class 'source.intrinsic_attention_ppo.rl_modules.IntrinsicAttentionModule.IntrinsicAttentionModule'>, observation_space=None, action_space=None, inference_only=False, learner_only=True, model_config={'intrinsic_reward_network': {'encoder_hidden_sizes': [], 'encoding_dim': 1, 'num_heads': 1, 'head_hidden_sizes': None, 'layers': [{'type': 'attention'}]}, 'extrinsic_value_hidden_layers': [127, 60], 'vf_share_layers': True, 'max_seq_len': 3}, catalog_class=None, load_state_path=None, model_config_dict=None)}, load_state_path=None, modules_to_load=None, module_specs={'default_policy': RLModuleSpec(module_class=<class 'source.intrinsic_attention_ppo.rl_modules.DifferentiablePPOModule.DifferentiablePPOModule'>, observation_space=None, action_space=None, inference_only=False, learner_only=False, model_config={'vf_share_layers': True, 'embedding_dim': 62, 'max_seq_len': 3, 'policy_head_hidden_sizes': [32], 'value_head_hidden_sizes': [101], 'embedding_hidden_sizes': [121]}, catalog_class=None, load_state_path=None, model_config_dict=None), 'intrinsic_reward_module': RLModuleSpec(module_class=<class 'source.intrinsic_attention_ppo.rl_modules.IntrinsicAttentionModule.IntrinsicAttentionModule'>, observation_space=None, action_space=None, inference_only=False, learner_only=True, model_config={'intrinsic_reward_network': {'encoder_hidden_sizes': [], 'encoding_dim': 1, 'num_heads': 1, 'head_hidden_sizes': None, 'layers': [{'type': 'attention'}]}, 'extrinsic_value_hidden_layers': [127, 60], 'vf_share_layers': True, 'max_seq_len': 3}, catalog_class=None, load_state_path=None, model_config_dict=None)})", "algorithm_config_overrides_per_module": {"intrinsic_reward_module": {"lr": 0.0002715581955}}, "_per_module_overrides": {}, "_validate_config": true, "_use_msgpack_checkpoints": false, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "env_task_fn": -1, "enable_connectors": -1, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.161583927863, "kl_target": 0.0201019014258, "vf_loss_coeff": 0.7790510010087, "entropy_coeff": 0.0015431216992, "clip_param": 0.2459212356676, "vf_clip_param": 0.3769744131561, "entropy_coeff_schedule": null, "lr_schedule": null, "sgd_minibatch_size": -1, "vf_share_layers": -1, "differentiable_learner_configs": ["DifferentiableLearnerConfig(learner_class=<class 'source.intrinsic_attention_ppo.learners.IntrinsicAttentionPPOLearner.IntrinsicAttentionPPOLearner'>, learner_connector=None, add_default_connectors_to_learner_pipeline=True, is_multi_agent=False, policies_to_update=['default_policy'], lr=0.0060984166342, num_total_minibatches=0, num_epochs=1, minibatch_size=1000, shuffle_batch_per_epoch=True)"], "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9485408017724, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.callbacks.callbacks.RLlibCallback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 67.26640248298645, "iterations_since_restore": 6, "perf": {"cpu_util_percent": 38.95333333333333, "ram_util_percent": 81.79333333333334}}
{"timers": {"training_iteration": 11.60202387704789, "restore_env_runners": 9.187108975872109e-06, "training_step": 11.601823346919273, "env_runner_sampling_timer": 1.6741876606813093, "learner_update_timer": 9.716819431856786, "synch_weights": 0.0015957278787855022, "restore_eval_env_runners": 5.548168549403288e-05, "evaluation_iteration": 0.13377918666580416, "synch_eval_env_connectors": 0.00018402315175741516, "synch_env_connectors": 7.073062035778921e-06}, "env_runners": {"module_to_env_connector": {"connector_pipeline_timer": 0.00011749586428413968, "timers": {"connectors": {"remove_single_ts_time_rank_from_batch": 1.1947220751782369e-05, "normalize_and_clip_actions": 8.031498214095343e-06, "get_actions": 3.883444657335409e-05, "tensor_to_numpy": 1.520537522619507e-05, "un_batch_to_individual_items": 6.608936279349839e-06, "listify_data_for_vector_env": 1.0542609619151534e-05}}}, "num_agent_steps_sampled_lifetime": {"default_agent": -3077500.0}, "sample": 0.005604184369692233, "episode_len_mean": 20.0, "num_module_steps_sampled": {"default_policy": 5000.0}, "env_to_module_connector": {"connector_pipeline_timer": 5.9417775979631256e-05, "timers": {"connectors": {"add_observations_from_episodes_to_batch": 2.794418143112684e-06, "batch_individual_items": 1.2462355403592415e-05, "numpy_to_tensor": 1.2595105688519846e-05, "add_time_dim_to_batch_and_zero_pad": 6.8887894232528904e-06, "add_states_from_episodes_to_batch": 2.74116864998102e-06}}}, "num_env_steps_sampled_lifetime": -3077500.0, "episode_return_mean": -0.38000000000000006, "episode_len_min": 20, "env_step_timer": 1.3859717939637865e-05, "num_module_steps_sampled_lifetime": {"default_policy": -3077500.0}, "env_to_module_sum_episodes_length_in": 10.36823839457432, "episode_len_max": 20, "module_episode_returns_mean": {"default_policy": -0.38000000000000006}, "time_between_sampling": 0.03854015198352241, "num_agent_steps_sampled": {"default_agent": 5000.0}, "episode_duration_sec_mean": 0.0052558544971980144, "num_env_steps_sampled": 5000.0, "weights_seq_no": 6.0, "num_episodes": 250.0, "episode_return_max": 8.5, "agent_episode_returns_mean": {"default_agent": -0.38000000000000006}, "num_episodes_lifetime": -153875.0, "env_reset_timer": 3.847671822304716e-05, "env_to_module_sum_episodes_length_out": 10.36823839457432, "rlmodule_inference_timer": 3.1747553168958345e-05, "episode_return_min": -11.5, "num_env_steps_sampled_lifetime_throughput": 3254.902553694279}, "__all_modules__": {"learner_connector_sum_episodes_length_in": 5000.0, "learner_connector": {"connector_pipeline_timer": 0.17195052310500158, "timers": {"connectors": {"add_one_ts_to_episodes_and_truncate": 0.008922618148180439, "add_observations_from_episodes_to_batch": 0.0008512403798087943, "add_columns_from_episodes_to_train_batch": 0.04087545715366739, "add_time_dim_to_batch_and_zero_pad": 0.10293396215047267, "add_states_from_episodes_to_batch": 0.003526063304496418, "batch_individual_items": 0.014589346985052473, "numpy_to_tensor": 8.358560490947235e-05}}}, "learner_connector_sum_episodes_length_out": 5250.0}, "learners": {"differentiable_learners": {"intrinsic_attention_ppo_learner": {"intrinsic_reward_module": {"module_train_batch_size_mean": 999.0, "num_module_steps_trained_lifetime": 251748, "diff_num_grad_updates_vs_sampler_policy": 36.0, "num_module_steps_trained": 35964, "weights_seq_no": 42.0, "total_loss": 0.0}, "default_policy": {"num_module_steps_trained": 35964, "use_intrinsic_rewards": 1.0, "weights_seq_no": 42.0, "module_train_batch_size_mean": 999.0, "vf_loss": 0.2628819942474365, "entropy": 0.6924881935119629, "diff_num_grad_updates_vs_sampler_policy": 36.0, "policy_loss": -0.0006530472892336547, "num_module_steps_trained_lifetime": 251748, "vf_loss_unclipped": 40.46469497680664, "vf_explained_var": -0.0027015209197998047, "mean_kl_loss": 3.428589116083458e-05, "total_loss": 0.2030823528766632}, "__all_modules__": {"num_env_steps_trained": 189000, "num_module_steps_trained_lifetime": 503496, "num_env_steps_trained_lifetime": 1323000, "num_module_steps_trained": 71928, "num_env_steps_trained_lifetime_throughput": 43637.52995059121}}}, "IntrinsicAttentionMask": [[[0.32126984000205994, 0.3432783782482147, 0.33545175194740295], [0.3225327134132385, 0.3422277271747589, 0.33523955941200256], [0.3220928907394409, 0.34259340167045593, 0.33531370759010315]], [[0.3405901789665222, 0.31511178612709045, 0.3442980945110321], [0.34649279713630676, 0.29999029636383057, 0.35351690649986267], [0.3397466540336609, 0.3172496557235718, 0.34300366044044495]], [[0.358642041683197, 0.3223145604133606, 0.31904336810112], [0.38129425048828125, 0.31230172514915466, 0.3064040243625641], [0.38348671793937683, 0.3113255202770233, 0.30518773198127747]], [[0.31630435585975647, 0.31891298294067383, 0.3647826015949249], [0.3169809579849243, 0.319492369890213, 0.3635266125202179], [0.3279435932636261, 0.32880640029907227, 0.34324997663497925]], [[0.28372707962989807, 0.35599610209465027, 0.3602767586708069], [0.30852335691452026, 0.34472793340682983, 0.3467487394809723], [0.3098623752593994, 0.34411588311195374, 0.34602174162864685]], [[0.42806634306907654, 0.1023273691534996, 0.46960628032684326], [0.3333020508289337, 7.421233931381721e-06, 0.6666905879974365], [0.4014337360858917, 0.17496779561042786, 0.4235984683036804]]], "default_policy": {"entropy": 0.6924732327461243, "diff_num_grad_updates_vs_sampler_policy": 1.0, "policy_loss": -0.0006876829429529607, "num_module_steps_trained_lifetime": 41958, "vf_loss_unclipped": 40.39973831176758, "vf_explained_var": -0.0003936290740966797, "module_train_batch_size_mean": 999.0, "num_trainable_parameters": 16595, "total_loss": 0.20299668610095978, "num_module_steps_trained": 5994, "use_intrinsic_rewards": 0.0, "weights_seq_no": 7.0, "curr_entropy_coeff": 0.0015431216992, "mean_kl_loss": 3.7968573451507837e-05, "curr_kl_coeff": 0.0012623744551092386, "vf_loss": 0.2628234028816223, "num_module_steps_trained_lifetime_throughput": 570.4698422716385}, "intrinsic_reward_module": {"diff_num_grad_updates_vs_sampler_policy": 1.0, "gradients_default_optimizer_global_norm": 0.0, "num_trainable_parameters": 8266, "weights_seq_no": 7.0, "default_optimizer_learning_rate": 0.0002715581955, "total_loss": 0.0, "num_module_steps_trained": 5994, "module_train_batch_size_mean": 999.0, "curr_entropy_coeff": 0.0015431216992, "num_module_steps_trained_lifetime": 41958, "num_module_steps_trained_lifetime_throughput": 570.4735345240534}, "__all_modules__": {"num_non_trainable_parameters": 0, "num_module_steps_trained_lifetime": 83916, "num_env_steps_trained_lifetime": 220500, "num_trainable_parameters": 24861, "num_env_steps_trained": 31500, "num_module_steps_trained": 11988, "num_env_steps_trained_lifetime_throughput": 2998.081958474061, "num_module_steps_trained_throughput": 16070860.921969889, "num_module_steps_trained_lifetime_throughput": 9443069.398341373}}, "num_training_step_calls_per_iteration": 1, "evaluation": {"env_runners": {"env_to_module_connector": {"timers": {"connectors": {"numpy_to_tensor": 1.2797089263682135e-05, "add_states_from_episodes_to_batch": 2.6333207095232964e-06, "batch_individual_items": 1.2347502316005726e-05, "add_time_dim_to_batch_and_zero_pad": 6.726671538872958e-06, "add_observations_from_episodes_to_batch": 2.7374127664147677e-06}}, "connector_pipeline_timer": 5.8841592135073234e-05}, "module_to_env_connector": {"timers": {"connectors": {"tensor_to_numpy": 1.5957287427991113e-05, "un_batch_to_individual_items": 6.59050830142391e-06, "listify_data_for_vector_env": 1.0576993768288665e-05, "remove_single_ts_time_rank_from_batch": 1.172516188664666e-05, "normalize_and_clip_actions": 7.969463445233188e-06, "get_actions": 3.9433875634760094e-05}}, "connector_pipeline_timer": 0.0001190069274162385}, "module_episode_returns_mean": {"default_policy": -0.6}, "env_reset_timer": 0.0005747335573558138, "episode_len_mean": 20.0, "num_env_steps_sampled_lifetime": 35400, "num_module_steps_sampled": {"default_policy": 400}, "episode_len_max": 20, "episode_return_max": 14.5, "num_env_steps_sampled": 400, "num_module_steps_sampled_lifetime": {"default_policy": 2800}, "agent_episode_returns_mean": {"default_agent": -0.6}, "episode_return_min": -14.5, "sample": 0.12169341262698918, "num_agent_steps_sampled_lifetime": {"default_agent": 2800}, "env_step_timer": 1.4406313408766122e-05, "weights_seq_no": 7.0, "rlmodule_inference_timer": 3.4117573170224965e-05, "num_agent_steps_sampled": {"default_agent": 400}, "episode_duration_sec_mean": 0.006041812888579443, "num_episodes": 20, "num_episodes_lifetime": 140, "env_to_module_sum_episodes_length_out": 10.368238394572801, "episode_return_mean": -0.6, "episode_len_min": 20, "env_to_module_sum_episodes_length_in": 10.368238394572801, "time_between_sampling": 11.488396241049127}, "num_healthy_workers": 1, "actor_manager_num_outstanding_async_reqs": 0, "num_remote_worker_restarts": 0}, "num_env_steps_sampled_lifetime": -3077500.0, "fault_tolerance": {"num_healthy_workers": 0, "num_remote_worker_restarts": 0}, "env_runner_group": {"actor_manager_num_outstanding_async_reqs": 0}, "done": false, "training_iteration": 7, "trial_id": "aea65_00000", "date": "2025-08-11_18-19-31", "timestamp": 1754929171, "time_this_iter_s": 10.315331220626831, "time_total_s": 77.58173370361328, "pid": 10689, "hostname": "Mac", "node_ip": "127.0.0.1", "config": {"exploration_config": {}, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 2, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "env": "Umbrella", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": false, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 0, "create_local_env_runner": true, "num_envs_per_env_runner": 1, "gym_env_vectorize_mode": "SYNC", "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "episodes_to_numpy": true, "max_requests_in_flight_per_env_runner": 1, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "merge_env_runner_states": "training_only", "broadcast_env_runner_states": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "complete_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "sampler_perf_stats_ema_coef": null, "_is_online": true, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": "auto", "num_aggregator_actors_per_learner": 0, "max_requests_in_flight_per_aggregator_actor": 3, "local_gpu_idx": 0, "max_requests_in_flight_per_learner": 3, "gamma": 1, "lr": 0.0002715581955, "grad_clip": 0.5, "grad_clip_by": "global_norm", "_train_batch_size_per_learner": 5000, "train_batch_size": 4000, "num_epochs": 1, "minibatch_size": 1000, "shuffle_batch_per_epoch": true, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "log_std_clip_param": 20.0, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "_disable_preprocessor_api": false, "_disable_action_flattening": false}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {"intrinsic_reward_coeff": 0.2795015916508}, "optimizer": {}, "_learner_class": "<class 'source.intrinsic_attention_ppo.learners.IntrinsicAttentionMetaLearner.IntrinsicAttentionMetaLearner'>", "callbacks_on_algorithm_init": null, "callbacks_on_env_runners_recreated": null, "callbacks_on_offline_eval_runners_recreated": null, "callbacks_on_checkpoint_loaded": null, "callbacks_on_environment_created": null, "callbacks_on_episode_created": null, "callbacks_on_episode_start": null, "callbacks_on_episode_step": null, "callbacks_on_episode_end": null, "callbacks_on_evaluate_start": null, "callbacks_on_evaluate_end": null, "callbacks_on_evaluate_offline_start": null, "callbacks_on_evaluate_offline_end": null, "callbacks_on_sample_end": null, "callbacks_on_train_result": null, "explore": true, "enable_rl_module_and_learner": true, "enable_env_runner_and_connector_v2": true, "_prior_exploration_config": {"type": "StochasticSampling"}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x388285760>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "offline_data_class": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_read_batch_size": null, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "materialize_data": false, "materialize_mapped_data": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "ignore_final_observation": false, "prelearner_class": null, "prelearner_buffer_class": null, "prelearner_buffer_kwargs": {}, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_remaining_data": false, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": 1, "evaluation_duration": 20, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_auto_duration_min_env_steps_per_sample": 100, "evaluation_auto_duration_max_env_steps_per_sample": 2000, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 1, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "offline_evaluation_interval": null, "num_offline_eval_runners": 0, "offline_loss_for_module_fn": null, "offline_evaluation_duration": 1, "offline_evaluation_parallel_to_training": false, "offline_evaluation_timeout_s": 120.0, "num_cpus_per_offline_eval_runner": 1, "num_gpus_per_offline_eval_runner": 0, "custom_resources_per_offline_eval_runner": {}, "restart_failed_offline_eval_runners": true, "ignore_offline_eval_runner_failures": false, "max_num_offline_eval_runner_restarts": 1000, "offline_eval_runner_restore_timeout_s": 1800.0, "max_requests_in_flight_per_offline_eval_runner": 1, "validate_offline_eval_runners_after_construction": true, "offline_eval_runner_health_probe_timeout_s": 30.0, "offline_eval_rl_module_inference_only": false, "broadcast_offline_eval_runner_states": false, "offline_eval_batch_size_per_runner": 256, "dataset_num_iters_per_eval_runner": 1, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "log_gradients": false, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 2, "restart_failed_env_runners": true, "ignore_env_runner_failures": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30.0, "env_runner_restore_timeout_s": 1800.0, "_model_config": {}, "_rl_module_spec": "MultiRLModuleSpec(multi_rl_module_class=<class 'ray.rllib.core.rl_module.multi_rl_module.MultiRLModule'>, observation_space=None, action_space=None, inference_only=False, model_config=None, rl_module_specs={'default_policy': RLModuleSpec(module_class=<class 'source.intrinsic_attention_ppo.rl_modules.DifferentiablePPOModule.DifferentiablePPOModule'>, observation_space=None, action_space=None, inference_only=False, learner_only=False, model_config={'vf_share_layers': True, 'embedding_dim': 62, 'max_seq_len': 3, 'policy_head_hidden_sizes': [32], 'value_head_hidden_sizes': [101], 'embedding_hidden_sizes': [121]}, catalog_class=None, load_state_path=None, model_config_dict=None), 'intrinsic_reward_module': RLModuleSpec(module_class=<class 'source.intrinsic_attention_ppo.rl_modules.IntrinsicAttentionModule.IntrinsicAttentionModule'>, observation_space=None, action_space=None, inference_only=False, learner_only=True, model_config={'intrinsic_reward_network': {'encoder_hidden_sizes': [], 'encoding_dim': 1, 'num_heads': 1, 'head_hidden_sizes': None, 'layers': [{'type': 'attention'}]}, 'extrinsic_value_hidden_layers': [127, 60], 'vf_share_layers': True, 'max_seq_len': 3}, catalog_class=None, load_state_path=None, model_config_dict=None)}, load_state_path=None, modules_to_load=None, module_specs={'default_policy': RLModuleSpec(module_class=<class 'source.intrinsic_attention_ppo.rl_modules.DifferentiablePPOModule.DifferentiablePPOModule'>, observation_space=None, action_space=None, inference_only=False, learner_only=False, model_config={'vf_share_layers': True, 'embedding_dim': 62, 'max_seq_len': 3, 'policy_head_hidden_sizes': [32], 'value_head_hidden_sizes': [101], 'embedding_hidden_sizes': [121]}, catalog_class=None, load_state_path=None, model_config_dict=None), 'intrinsic_reward_module': RLModuleSpec(module_class=<class 'source.intrinsic_attention_ppo.rl_modules.IntrinsicAttentionModule.IntrinsicAttentionModule'>, observation_space=None, action_space=None, inference_only=False, learner_only=True, model_config={'intrinsic_reward_network': {'encoder_hidden_sizes': [], 'encoding_dim': 1, 'num_heads': 1, 'head_hidden_sizes': None, 'layers': [{'type': 'attention'}]}, 'extrinsic_value_hidden_layers': [127, 60], 'vf_share_layers': True, 'max_seq_len': 3}, catalog_class=None, load_state_path=None, model_config_dict=None)})", "algorithm_config_overrides_per_module": {"intrinsic_reward_module": {"lr": 0.0002715581955}}, "_per_module_overrides": {}, "_validate_config": true, "_use_msgpack_checkpoints": false, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "env_task_fn": -1, "enable_connectors": -1, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.161583927863, "kl_target": 0.0201019014258, "vf_loss_coeff": 0.7790510010087, "entropy_coeff": 0.0015431216992, "clip_param": 0.2459212356676, "vf_clip_param": 0.3769744131561, "entropy_coeff_schedule": null, "lr_schedule": null, "sgd_minibatch_size": -1, "vf_share_layers": -1, "differentiable_learner_configs": ["DifferentiableLearnerConfig(learner_class=<class 'source.intrinsic_attention_ppo.learners.IntrinsicAttentionPPOLearner.IntrinsicAttentionPPOLearner'>, learner_connector=None, add_default_connectors_to_learner_pipeline=True, is_multi_agent=False, policies_to_update=['default_policy'], lr=0.0060984166342, num_total_minibatches=0, num_epochs=1, minibatch_size=1000, shuffle_batch_per_epoch=True)"], "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9485408017724, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.callbacks.callbacks.RLlibCallback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 77.58173370361328, "iterations_since_restore": 7, "perf": {"cpu_util_percent": 35.78, "ram_util_percent": 81.38000000000001}}
{"timers": {"training_iteration": 11.601937821607219, "restore_env_runners": 9.171907852915388e-06, "training_step": 11.601736690119763, "env_runner_sampling_timer": 1.681683274074001, "learner_update_timer": 9.70807317795874, "synch_weights": 0.0015967006008541658, "restore_eval_env_runners": 5.509811790580641e-05, "evaluation_iteration": 0.13365668062911298, "synch_eval_env_connectors": 0.00018330750971098746, "synch_env_connectors": 7.0523317961458006e-06}, "env_runners": {"module_to_env_connector": {"connector_pipeline_timer": 0.00017415937754986627, "timers": {"connectors": {"remove_single_ts_time_rank_from_batch": 1.5967235246571333e-05, "normalize_and_clip_actions": 1.057372429203995e-05, "get_actions": 6.776796376518745e-05, "tensor_to_numpy": 2.2092378509423807e-05, "un_batch_to_individual_items": 9.564114438109295e-06, "listify_data_for_vector_env": 1.3856551463421673e-05}}}, "num_agent_steps_sampled_lifetime": {"default_agent": -3695000.0}, "sample": 0.006591723482176849, "episode_len_mean": 20.0, "num_module_steps_sampled": {"default_policy": 5000.0}, "env_to_module_connector": {"connector_pipeline_timer": 8.35924242397976e-05, "timers": {"connectors": {"add_observations_from_episodes_to_batch": 3.6747003299974423e-06, "batch_individual_items": 1.837611206177181e-05, "numpy_to_tensor": 2.008672749088592e-05, "add_time_dim_to_batch_and_zero_pad": 9.37174575053977e-06, "add_states_from_episodes_to_batch": 3.2995840192920805e-06}}}, "num_env_steps_sampled_lifetime": -3695000.0, "episode_return_mean": -0.06, "episode_len_min": 20, "env_step_timer": 2.2005290977548202e-05, "num_module_steps_sampled_lifetime": {"default_policy": -3695000.0}, "env_to_module_sum_episodes_length_in": 10.36823839457432, "episode_len_max": 20, "module_episode_returns_mean": {"default_policy": -0.06}, "time_between_sampling": 0.035529012206948596, "num_agent_steps_sampled": {"default_agent": 5000.0}, "episode_duration_sec_mean": 0.008458428860642016, "num_env_steps_sampled": 5000.0, "weights_seq_no": 7.0, "num_episodes": 250.0, "episode_return_max": 8.5, "agent_episode_returns_mean": {"default_agent": -0.06}, "num_episodes_lifetime": -184750.0, "env_reset_timer": 4.021023384987128e-05, "env_to_module_sum_episodes_length_out": 10.36823839457432, "rlmodule_inference_timer": 8.142001154096517e-05, "episode_return_min": -11.5, "num_env_steps_sampled_lifetime_throughput": 2976.354256058246}, "__all_modules__": {"learner_connector_sum_episodes_length_in": 5000.0, "learner_connector": {"connector_pipeline_timer": 0.172772248703617, "timers": {"connectors": {"add_one_ts_to_episodes_and_truncate": 0.008983592806551548, "add_observations_from_episodes_to_batch": 0.0008629504757444971, "add_columns_from_episodes_to_train_batch": 0.04123329966264082, "add_time_dim_to_batch_and_zero_pad": 0.1031999508589837, "add_states_from_episodes_to_batch": 0.0035297930917407914, "batch_individual_items": 0.014709042265100546, "numpy_to_tensor": 8.44368292269146e-05}}}, "learner_connector_sum_episodes_length_out": 5250.0}, "learners": {"differentiable_learners": {"intrinsic_attention_ppo_learner": {"intrinsic_reward_module": {"module_train_batch_size_mean": 999.0, "num_module_steps_trained_lifetime": 287712, "diff_num_grad_updates_vs_sampler_policy": 41.0, "num_module_steps_trained": 35964, "weights_seq_no": 48.0, "total_loss": 0.0}, "default_policy": {"num_module_steps_trained": 35964, "use_intrinsic_rewards": 1.0, "weights_seq_no": 48.0, "module_train_batch_size_mean": 999.0, "vf_loss": 0.2628401815891266, "entropy": 0.6922107338905334, "diff_num_grad_updates_vs_sampler_policy": 41.0, "policy_loss": -1.2604345101863146e-05, "num_module_steps_trained_lifetime": 287712, "vf_loss_unclipped": 37.31297302246094, "vf_explained_var": -0.002590656280517578, "mean_kl_loss": 1.5272156588252983e-06, "total_loss": 0.20368541777133942}, "__all_modules__": {"num_env_steps_trained": 189000, "num_module_steps_trained_lifetime": 575424, "num_env_steps_trained_lifetime": 1512000, "num_module_steps_trained": 71928, "num_env_steps_trained_lifetime_throughput": 42954.10481664118}}}, "IntrinsicAttentionMask": [[[0.3196762800216675, 0.33760035037994385, 0.34272339940071106], [0.32072290778160095, 0.33727890253067017, 0.34199824929237366], [0.3210121691226959, 0.3371898829936981, 0.34179800748825073]], [[0.34059014916419983, 0.31511178612709045, 0.3442980647087097], [0.34649279713630676, 0.29999029636383057, 0.35351690649986267], [0.3397466540336609, 0.31724968552589417, 0.34300366044044495]], [[0.36121654510498047, 0.31819942593574524, 0.3205839991569519], [0.3822452127933502, 0.30688047409057617, 0.3108742833137512], [0.38099390268325806, 0.3075518310070038, 0.3114542067050934]], [[0.30630531907081604, 0.3178740441799164, 0.3758205771446228], [0.309396356344223, 0.3197292685508728, 0.3708743453025818], [0.3233224153518677, 0.32780978083610535, 0.348867803812027]], [[0.2870800495147705, 0.3544800281524658, 0.35843992233276367], [0.31204140186309814, 0.34311914443969727, 0.344839483499527], [0.31338876485824585, 0.3425023555755615, 0.34410884976387024]], [[0.4334840476512909, 0.1013580858707428, 0.4651578366756439], [0.3693609833717346, 6.026566097716568e-06, 0.6306329965591431], [0.4130203127861023, 0.15365798771381378, 0.4333217442035675]]], "default_policy": {"entropy": 0.6922101974487305, "diff_num_grad_updates_vs_sampler_policy": 1.0, "policy_loss": -1.3369491171033587e-05, "num_module_steps_trained_lifetime": 47952, "vf_loss_unclipped": 37.24683380126953, "vf_explained_var": -0.0006902217864990234, "module_train_batch_size_mean": 999.0, "num_trainable_parameters": 16595, "total_loss": 0.20367774367332458, "num_module_steps_trained": 5994, "use_intrinsic_rewards": 0.0, "weights_seq_no": 8.0, "curr_entropy_coeff": 0.0015431216992, "mean_kl_loss": 1.5499330174861825e-06, "curr_kl_coeff": 0.0006311872275546193, "vf_loss": 0.2628317177295685, "num_module_steps_trained_lifetime_throughput": 572.9004808108091}, "intrinsic_reward_module": {"diff_num_grad_updates_vs_sampler_policy": 1.0, "gradients_default_optimizer_global_norm": 0.0, "num_trainable_parameters": 8266, "weights_seq_no": 8.0, "default_optimizer_learning_rate": 0.0002715581955, "total_loss": 0.0, "num_module_steps_trained": 5994, "module_train_batch_size_mean": 999.0, "curr_entropy_coeff": 0.0015431216992, "num_module_steps_trained_lifetime": 47952, "num_module_steps_trained_lifetime_throughput": 572.9039595591853}, "__all_modules__": {"num_non_trainable_parameters": 0, "num_module_steps_trained_lifetime": 95904, "num_env_steps_trained_lifetime": 252000, "num_trainable_parameters": 24861, "num_env_steps_trained": 31500, "num_module_steps_trained": 11988, "num_env_steps_trained_lifetime_throughput": 3010.850553390075, "num_module_steps_trained_throughput": 15870099.722470382, "num_module_steps_trained_lifetime_throughput": 9584034.7248799}}, "num_training_step_calls_per_iteration": 1, "evaluation": {"env_runners": {"env_to_module_connector": {"timers": {"connectors": {"numpy_to_tensor": 1.241803879226607e-05, "add_states_from_episodes_to_batch": 2.647302600046649e-06, "batch_individual_items": 1.2477759122110639e-05, "add_time_dim_to_batch_and_zero_pad": 6.917085565935556e-06, "add_observations_from_episodes_to_batch": 2.785480058044113e-06}}, "connector_pipeline_timer": 5.9138072133109126e-05}, "module_to_env_connector": {"timers": {"connectors": {"tensor_to_numpy": 1.582424331909048e-05, "un_batch_to_individual_items": 6.60247179883594e-06, "listify_data_for_vector_env": 1.0513139773548746e-05, "remove_single_ts_time_rank_from_batch": 1.1815545578083605e-05, "normalize_and_clip_actions": 7.957747504101476e-06, "get_actions": 3.8283416561650096e-05}}, "connector_pipeline_timer": 0.00011695535342773816}, "module_episode_returns_mean": {"default_policy": -0.6}, "env_reset_timer": 0.0005725624713649486, "episode_len_mean": 20.0, "num_env_steps_sampled_lifetime": 40400, "num_module_steps_sampled": {"default_policy": 400}, "episode_len_max": 20, "episode_return_max": 14.5, "num_env_steps_sampled": 400, "num_module_steps_sampled_lifetime": {"default_policy": 3200}, "agent_episode_returns_mean": {"default_agent": -0.6}, "episode_return_min": -14.5, "sample": 0.12164262767015875, "num_agent_steps_sampled_lifetime": {"default_agent": 3200}, "env_step_timer": 1.4507820878544413e-05, "weights_seq_no": 8.0, "rlmodule_inference_timer": 3.260725856863016e-05, "num_agent_steps_sampled": {"default_agent": 400}, "episode_duration_sec_mean": 0.005277139983372763, "num_episodes": 20, "num_episodes_lifetime": 160, "env_to_module_sum_episodes_length_out": 10.3682383945743, "episode_return_mean": -0.6, "episode_len_min": 20, "env_to_module_sum_episodes_length_in": 10.3682383945743, "time_between_sampling": 11.489718086969196}, "num_healthy_workers": 1, "actor_manager_num_outstanding_async_reqs": 0, "num_remote_worker_restarts": 0}, "num_env_steps_sampled_lifetime": -3695000.0, "fault_tolerance": {"num_healthy_workers": 0, "num_remote_worker_restarts": 0}, "env_runner_group": {"actor_manager_num_outstanding_async_reqs": 0}, "done": false, "training_iteration": 8, "trial_id": "aea65_00000", "date": "2025-08-11_18-19-43", "timestamp": 1754929183, "time_this_iter_s": 11.722136974334717, "time_total_s": 89.303870677948, "pid": 10689, "hostname": "Mac", "node_ip": "127.0.0.1", "config": {"exploration_config": {}, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 2, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "env": "Umbrella", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": false, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 0, "create_local_env_runner": true, "num_envs_per_env_runner": 1, "gym_env_vectorize_mode": "SYNC", "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "episodes_to_numpy": true, "max_requests_in_flight_per_env_runner": 1, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "merge_env_runner_states": "training_only", "broadcast_env_runner_states": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "complete_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "sampler_perf_stats_ema_coef": null, "_is_online": true, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": "auto", "num_aggregator_actors_per_learner": 0, "max_requests_in_flight_per_aggregator_actor": 3, "local_gpu_idx": 0, "max_requests_in_flight_per_learner": 3, "gamma": 1, "lr": 0.0002715581955, "grad_clip": 0.5, "grad_clip_by": "global_norm", "_train_batch_size_per_learner": 5000, "train_batch_size": 4000, "num_epochs": 1, "minibatch_size": 1000, "shuffle_batch_per_epoch": true, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "log_std_clip_param": 20.0, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "_disable_preprocessor_api": false, "_disable_action_flattening": false}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {"intrinsic_reward_coeff": 0.2795015916508}, "optimizer": {}, "_learner_class": "<class 'source.intrinsic_attention_ppo.learners.IntrinsicAttentionMetaLearner.IntrinsicAttentionMetaLearner'>", "callbacks_on_algorithm_init": null, "callbacks_on_env_runners_recreated": null, "callbacks_on_offline_eval_runners_recreated": null, "callbacks_on_checkpoint_loaded": null, "callbacks_on_environment_created": null, "callbacks_on_episode_created": null, "callbacks_on_episode_start": null, "callbacks_on_episode_step": null, "callbacks_on_episode_end": null, "callbacks_on_evaluate_start": null, "callbacks_on_evaluate_end": null, "callbacks_on_evaluate_offline_start": null, "callbacks_on_evaluate_offline_end": null, "callbacks_on_sample_end": null, "callbacks_on_train_result": null, "explore": true, "enable_rl_module_and_learner": true, "enable_env_runner_and_connector_v2": true, "_prior_exploration_config": {"type": "StochasticSampling"}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x388285760>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "offline_data_class": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_read_batch_size": null, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "materialize_data": false, "materialize_mapped_data": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "ignore_final_observation": false, "prelearner_class": null, "prelearner_buffer_class": null, "prelearner_buffer_kwargs": {}, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_remaining_data": false, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": 1, "evaluation_duration": 20, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_auto_duration_min_env_steps_per_sample": 100, "evaluation_auto_duration_max_env_steps_per_sample": 2000, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 1, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "offline_evaluation_interval": null, "num_offline_eval_runners": 0, "offline_loss_for_module_fn": null, "offline_evaluation_duration": 1, "offline_evaluation_parallel_to_training": false, "offline_evaluation_timeout_s": 120.0, "num_cpus_per_offline_eval_runner": 1, "num_gpus_per_offline_eval_runner": 0, "custom_resources_per_offline_eval_runner": {}, "restart_failed_offline_eval_runners": true, "ignore_offline_eval_runner_failures": false, "max_num_offline_eval_runner_restarts": 1000, "offline_eval_runner_restore_timeout_s": 1800.0, "max_requests_in_flight_per_offline_eval_runner": 1, "validate_offline_eval_runners_after_construction": true, "offline_eval_runner_health_probe_timeout_s": 30.0, "offline_eval_rl_module_inference_only": false, "broadcast_offline_eval_runner_states": false, "offline_eval_batch_size_per_runner": 256, "dataset_num_iters_per_eval_runner": 1, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "log_gradients": false, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 2, "restart_failed_env_runners": true, "ignore_env_runner_failures": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30.0, "env_runner_restore_timeout_s": 1800.0, "_model_config": {}, "_rl_module_spec": "MultiRLModuleSpec(multi_rl_module_class=<class 'ray.rllib.core.rl_module.multi_rl_module.MultiRLModule'>, observation_space=None, action_space=None, inference_only=False, model_config=None, rl_module_specs={'default_policy': RLModuleSpec(module_class=<class 'source.intrinsic_attention_ppo.rl_modules.DifferentiablePPOModule.DifferentiablePPOModule'>, observation_space=None, action_space=None, inference_only=False, learner_only=False, model_config={'vf_share_layers': True, 'embedding_dim': 62, 'max_seq_len': 3, 'policy_head_hidden_sizes': [32], 'value_head_hidden_sizes': [101], 'embedding_hidden_sizes': [121]}, catalog_class=None, load_state_path=None, model_config_dict=None), 'intrinsic_reward_module': RLModuleSpec(module_class=<class 'source.intrinsic_attention_ppo.rl_modules.IntrinsicAttentionModule.IntrinsicAttentionModule'>, observation_space=None, action_space=None, inference_only=False, learner_only=True, model_config={'intrinsic_reward_network': {'encoder_hidden_sizes': [], 'encoding_dim': 1, 'num_heads': 1, 'head_hidden_sizes': None, 'layers': [{'type': 'attention'}]}, 'extrinsic_value_hidden_layers': [127, 60], 'vf_share_layers': True, 'max_seq_len': 3}, catalog_class=None, load_state_path=None, model_config_dict=None)}, load_state_path=None, modules_to_load=None, module_specs={'default_policy': RLModuleSpec(module_class=<class 'source.intrinsic_attention_ppo.rl_modules.DifferentiablePPOModule.DifferentiablePPOModule'>, observation_space=None, action_space=None, inference_only=False, learner_only=False, model_config={'vf_share_layers': True, 'embedding_dim': 62, 'max_seq_len': 3, 'policy_head_hidden_sizes': [32], 'value_head_hidden_sizes': [101], 'embedding_hidden_sizes': [121]}, catalog_class=None, load_state_path=None, model_config_dict=None), 'intrinsic_reward_module': RLModuleSpec(module_class=<class 'source.intrinsic_attention_ppo.rl_modules.IntrinsicAttentionModule.IntrinsicAttentionModule'>, observation_space=None, action_space=None, inference_only=False, learner_only=True, model_config={'intrinsic_reward_network': {'encoder_hidden_sizes': [], 'encoding_dim': 1, 'num_heads': 1, 'head_hidden_sizes': None, 'layers': [{'type': 'attention'}]}, 'extrinsic_value_hidden_layers': [127, 60], 'vf_share_layers': True, 'max_seq_len': 3}, catalog_class=None, load_state_path=None, model_config_dict=None)})", "algorithm_config_overrides_per_module": {"intrinsic_reward_module": {"lr": 0.0002715581955}}, "_per_module_overrides": {}, "_validate_config": true, "_use_msgpack_checkpoints": false, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "env_task_fn": -1, "enable_connectors": -1, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.161583927863, "kl_target": 0.0201019014258, "vf_loss_coeff": 0.7790510010087, "entropy_coeff": 0.0015431216992, "clip_param": 0.2459212356676, "vf_clip_param": 0.3769744131561, "entropy_coeff_schedule": null, "lr_schedule": null, "sgd_minibatch_size": -1, "vf_share_layers": -1, "differentiable_learner_configs": ["DifferentiableLearnerConfig(learner_class=<class 'source.intrinsic_attention_ppo.learners.IntrinsicAttentionPPOLearner.IntrinsicAttentionPPOLearner'>, learner_connector=None, add_default_connectors_to_learner_pipeline=True, is_multi_agent=False, policies_to_update=['default_policy'], lr=0.0060984166342, num_total_minibatches=0, num_epochs=1, minibatch_size=1000, shuffle_batch_per_epoch=True)"], "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9485408017724, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.callbacks.callbacks.RLlibCallback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 89.303870677948, "iterations_since_restore": 8, "perf": {"cpu_util_percent": 43.54705882352941, "ram_util_percent": 82.49411764705881}}
{"timers": {"training_iteration": 11.603352013390559, "restore_env_runners": 9.21101864136178e-06, "training_step": 11.603149786558697, "env_runner_sampling_timer": 1.6885996505034293, "learner_update_timer": 9.700505218678735, "synch_weights": 0.001600377345120178, "restore_eval_env_runners": 5.497422612547516e-05, "evaluation_iteration": 0.13357643090235474, "synch_eval_env_connectors": 0.00018311277537762528, "synch_env_connectors": 7.078888379209042e-06}, "env_runners": {"module_to_env_connector": {"connector_pipeline_timer": 0.00018735129399794913, "timers": {"connectors": {"remove_single_ts_time_rank_from_batch": 1.642655285196687e-05, "normalize_and_clip_actions": 1.1529491402186958e-05, "get_actions": 7.283930741713352e-05, "tensor_to_numpy": 2.381718155131768e-05, "un_batch_to_individual_items": 9.84069504494059e-06, "listify_data_for_vector_env": 1.5154937781164703e-05}}}, "num_agent_steps_sampled_lifetime": {"default_agent": -4312500.0}, "sample": 0.010067175761611005, "episode_len_mean": 20.0, "num_module_steps_sampled": {"default_policy": 5000.0}, "env_to_module_connector": {"connector_pipeline_timer": 9.21357482217951e-05, "timers": {"connectors": {"add_observations_from_episodes_to_batch": 4.141020659413522e-06, "batch_individual_items": 1.7864130891467553e-05, "numpy_to_tensor": 2.215159905390565e-05, "add_time_dim_to_batch_and_zero_pad": 1.2105268115761941e-05, "add_states_from_episodes_to_batch": 3.7628326517314144e-06}}}, "num_env_steps_sampled_lifetime": -4312500.0, "episode_return_mean": -1.9799999999999998, "episode_len_min": 20, "env_step_timer": 2.272722424030256e-05, "num_module_steps_sampled_lifetime": {"default_policy": -4312500.0}, "env_to_module_sum_episodes_length_in": 10.36823839457432, "episode_len_max": 20, "module_episode_returns_mean": {"default_policy": -1.9799999999999998}, "time_between_sampling": 0.03792131000278194, "num_agent_steps_sampled": {"default_agent": 5000.0}, "episode_duration_sec_mean": 0.008192562710959462, "num_env_steps_sampled": 5000.0, "weights_seq_no": 8.0, "num_episodes": 250.0, "episode_return_max": 8.5, "agent_episode_returns_mean": {"default_agent": -1.9799999999999998}, "num_episodes_lifetime": -215625.0, "env_reset_timer": 7.50098673570385e-05, "env_to_module_sum_episodes_length_out": 10.36823839457432, "rlmodule_inference_timer": 5.1919812276675726e-05, "episode_return_min": -11.5, "num_env_steps_sampled_lifetime_throughput": 2409.330218600194}, "__all_modules__": {"learner_connector_sum_episodes_length_in": 5000.0, "learner_connector": {"connector_pipeline_timer": 0.17470116204582833, "timers": {"connectors": {"add_one_ts_to_episodes_and_truncate": 0.008986697298631201, "add_observations_from_episodes_to_batch": 0.0008654051310560558, "add_columns_from_episodes_to_train_batch": 0.04123431041525631, "add_time_dim_to_batch_and_zero_pad": 0.10331287760037479, "add_states_from_episodes_to_batch": 0.003535320160856166, "batch_individual_items": 0.016512023513030195, "numpy_to_tensor": 8.549038109054318e-05}}}, "learner_connector_sum_episodes_length_out": 5250.0}, "learners": {"differentiable_learners": {"intrinsic_attention_ppo_learner": {"intrinsic_reward_module": {"module_train_batch_size_mean": 999.0, "num_module_steps_trained_lifetime": 323676, "diff_num_grad_updates_vs_sampler_policy": 46.0, "num_module_steps_trained": 35964, "weights_seq_no": 54.0, "total_loss": 0.0}, "default_policy": {"num_module_steps_trained": 35964, "use_intrinsic_rewards": 1.0, "weights_seq_no": 54.0, "module_train_batch_size_mean": 999.0, "vf_loss": 0.2628630995750427, "entropy": 0.6922436356544495, "diff_num_grad_updates_vs_sampler_policy": 46.0, "policy_loss": -0.00010144121188204736, "num_module_steps_trained_lifetime": 323676, "vf_loss_unclipped": 39.312255859375, "vf_explained_var": -0.0026023387908935547, "mean_kl_loss": 3.5519326502253534e-06, "total_loss": 0.2036147117614746}, "__all_modules__": {"num_env_steps_trained": 189000, "num_module_steps_trained_lifetime": 647352, "num_env_steps_trained_lifetime": 1701000, "num_module_steps_trained": 71928, "num_env_steps_trained_lifetime_throughput": 42275.31214142753}}}, "IntrinsicAttentionMask": [[[0.32126984000205994, 0.34327834844589233, 0.33545172214508057], [0.3225327134132385, 0.3422277271747589, 0.33523955941200256], [0.3220928907394409, 0.34259337186813354, 0.33531367778778076]], [[0.33985188603401184, 0.31798243522644043, 0.34216564893722534], [0.3513216972351074, 0.2904740273952484, 0.35820427536964417], [0.33863383531570435, 0.3208653926849365, 0.3405008018016815]], [[0.3618873059749603, 0.314255028963089, 0.3238576650619507], [0.3811967074871063, 0.3016848564147949, 0.31711840629577637], [0.3770463764667511, 0.3043653070926666, 0.3185882568359375]], [[0.3117687404155731, 0.3146052658557892, 0.3736260235309601], [0.31254875659942627, 0.3152909576892853, 0.37216028571128845], [0.32716718316078186, 0.32802796363830566, 0.3448048532009125]], [[0.2722117602825165, 0.3615051209926605, 0.3662831485271454], [0.30369919538497925, 0.34707480669021606, 0.3492259979248047], [0.30520543456077576, 0.3463799059391022, 0.34841468930244446]], [[0.4261239767074585, 0.09043599665164948, 0.48343998193740845], [0.2976159155368805, 7.81846756581217e-06, 0.7023763060569763], [0.39835691452026367, 0.1758672147989273, 0.42577582597732544]]], "default_policy": {"entropy": 0.6922382116317749, "diff_num_grad_updates_vs_sampler_policy": 1.0, "policy_loss": -0.00010602030670270324, "num_module_steps_trained_lifetime": 53946, "vf_loss_unclipped": 39.229042053222656, "vf_explained_var": 0.0002415776252746582, "module_train_batch_size_mean": 999.0, "num_trainable_parameters": 16595, "total_loss": 0.2035747617483139, "num_module_steps_trained": 5994, "use_intrinsic_rewards": 0.0, "weights_seq_no": 9.0, "curr_entropy_coeff": 0.0015431216992, "mean_kl_loss": 3.926859335479094e-06, "curr_kl_coeff": 0.00031559361377730966, "vf_loss": 0.26281845569610596, "num_module_steps_trained_lifetime_throughput": 575.0055703897959}, "intrinsic_reward_module": {"diff_num_grad_updates_vs_sampler_policy": 1.0, "gradients_default_optimizer_global_norm": 0.0, "num_trainable_parameters": 8266, "weights_seq_no": 9.0, "default_optimizer_learning_rate": 0.0002715581955, "total_loss": 0.0, "num_module_steps_trained": 5994, "module_train_batch_size_mean": 999.0, "curr_entropy_coeff": 0.0015431216992, "num_module_steps_trained_lifetime": 53946, "num_module_steps_trained_lifetime_throughput": 575.008838720346}, "__all_modules__": {"num_non_trainable_parameters": 0, "num_module_steps_trained_lifetime": 107892, "num_env_steps_trained_lifetime": 283500, "num_trainable_parameters": 24861, "num_env_steps_trained": 31500, "num_module_steps_trained": 11988, "num_env_steps_trained_lifetime_throughput": 3021.9083004217755, "num_module_steps_trained_throughput": 15666797.960880091, "num_module_steps_trained_lifetime_throughput": 9712124.738548744}}, "num_training_step_calls_per_iteration": 1, "evaluation": {"env_runners": {"env_to_module_connector": {"timers": {"connectors": {"numpy_to_tensor": 1.3099361403094194e-05, "add_states_from_episodes_to_batch": 2.7869876517991057e-06, "batch_individual_items": 1.2988963160228292e-05, "add_time_dim_to_batch_and_zero_pad": 7.088172560696816e-06, "add_observations_from_episodes_to_batch": 2.8796275628483087e-06}}, "connector_pipeline_timer": 6.157984147359152e-05}, "module_to_env_connector": {"timers": {"connectors": {"tensor_to_numpy": 1.6005397987979487e-05, "un_batch_to_individual_items": 6.860113191973852e-06, "listify_data_for_vector_env": 1.0732141839778433e-05, "remove_single_ts_time_rank_from_batch": 1.2250712073596218e-05, "normalize_and_clip_actions": 8.28696019446804e-06, "get_actions": 3.989414600650109e-05}}, "connector_pipeline_timer": 0.00012084846723811715}, "module_episode_returns_mean": {"default_policy": -0.4}, "env_reset_timer": 0.0005709222665836795, "episode_len_mean": 20.0, "num_env_steps_sampled_lifetime": 45400, "num_module_steps_sampled": {"default_policy": 400}, "episode_len_max": 20, "episode_return_max": 14.5, "num_env_steps_sampled": 400, "num_module_steps_sampled_lifetime": {"default_policy": 3600}, "agent_episode_returns_mean": {"default_agent": -0.4}, "episode_return_min": -14.5, "sample": 0.1217100868028142, "num_agent_steps_sampled_lifetime": {"default_agent": 3600}, "env_step_timer": 1.5028555696079983e-05, "weights_seq_no": 9.0, "rlmodule_inference_timer": 3.3769352054287444e-05, "num_agent_steps_sampled": {"default_agent": 400}, "episode_duration_sec_mean": 0.005384462084621191, "num_episodes": 20, "num_episodes_lifetime": 180, "env_to_module_sum_episodes_length_out": 10.368238394574323, "episode_return_mean": -0.4, "episode_len_min": 20, "env_to_module_sum_episodes_length_in": 10.368238394574323, "time_between_sampling": 11.492574785678753}, "num_healthy_workers": 1, "actor_manager_num_outstanding_async_reqs": 0, "num_remote_worker_restarts": 0}, "num_env_steps_sampled_lifetime": -4312500.0, "fault_tolerance": {"num_healthy_workers": 0, "num_remote_worker_restarts": 0}, "env_runner_group": {"actor_manager_num_outstanding_async_reqs": 0}, "done": false, "training_iteration": 9, "trial_id": "aea65_00000", "date": "2025-08-11_18-19-55", "timestamp": 1754929195, "time_this_iter_s": 11.886479139328003, "time_total_s": 101.190349817276, "pid": 10689, "hostname": "Mac", "node_ip": "127.0.0.1", "config": {"exploration_config": {}, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 2, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "env": "Umbrella", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": false, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 0, "create_local_env_runner": true, "num_envs_per_env_runner": 1, "gym_env_vectorize_mode": "SYNC", "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "episodes_to_numpy": true, "max_requests_in_flight_per_env_runner": 1, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "merge_env_runner_states": "training_only", "broadcast_env_runner_states": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "complete_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "sampler_perf_stats_ema_coef": null, "_is_online": true, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": "auto", "num_aggregator_actors_per_learner": 0, "max_requests_in_flight_per_aggregator_actor": 3, "local_gpu_idx": 0, "max_requests_in_flight_per_learner": 3, "gamma": 1, "lr": 0.0002715581955, "grad_clip": 0.5, "grad_clip_by": "global_norm", "_train_batch_size_per_learner": 5000, "train_batch_size": 4000, "num_epochs": 1, "minibatch_size": 1000, "shuffle_batch_per_epoch": true, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "log_std_clip_param": 20.0, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "_disable_preprocessor_api": false, "_disable_action_flattening": false}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {"intrinsic_reward_coeff": 0.2795015916508}, "optimizer": {}, "_learner_class": "<class 'source.intrinsic_attention_ppo.learners.IntrinsicAttentionMetaLearner.IntrinsicAttentionMetaLearner'>", "callbacks_on_algorithm_init": null, "callbacks_on_env_runners_recreated": null, "callbacks_on_offline_eval_runners_recreated": null, "callbacks_on_checkpoint_loaded": null, "callbacks_on_environment_created": null, "callbacks_on_episode_created": null, "callbacks_on_episode_start": null, "callbacks_on_episode_step": null, "callbacks_on_episode_end": null, "callbacks_on_evaluate_start": null, "callbacks_on_evaluate_end": null, "callbacks_on_evaluate_offline_start": null, "callbacks_on_evaluate_offline_end": null, "callbacks_on_sample_end": null, "callbacks_on_train_result": null, "explore": true, "enable_rl_module_and_learner": true, "enable_env_runner_and_connector_v2": true, "_prior_exploration_config": {"type": "StochasticSampling"}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x388285760>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "offline_data_class": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_read_batch_size": null, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "materialize_data": false, "materialize_mapped_data": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "ignore_final_observation": false, "prelearner_class": null, "prelearner_buffer_class": null, "prelearner_buffer_kwargs": {}, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_remaining_data": false, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": 1, "evaluation_duration": 20, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_auto_duration_min_env_steps_per_sample": 100, "evaluation_auto_duration_max_env_steps_per_sample": 2000, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 1, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "offline_evaluation_interval": null, "num_offline_eval_runners": 0, "offline_loss_for_module_fn": null, "offline_evaluation_duration": 1, "offline_evaluation_parallel_to_training": false, "offline_evaluation_timeout_s": 120.0, "num_cpus_per_offline_eval_runner": 1, "num_gpus_per_offline_eval_runner": 0, "custom_resources_per_offline_eval_runner": {}, "restart_failed_offline_eval_runners": true, "ignore_offline_eval_runner_failures": false, "max_num_offline_eval_runner_restarts": 1000, "offline_eval_runner_restore_timeout_s": 1800.0, "max_requests_in_flight_per_offline_eval_runner": 1, "validate_offline_eval_runners_after_construction": true, "offline_eval_runner_health_probe_timeout_s": 30.0, "offline_eval_rl_module_inference_only": false, "broadcast_offline_eval_runner_states": false, "offline_eval_batch_size_per_runner": 256, "dataset_num_iters_per_eval_runner": 1, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "log_gradients": false, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 2, "restart_failed_env_runners": true, "ignore_env_runner_failures": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30.0, "env_runner_restore_timeout_s": 1800.0, "_model_config": {}, "_rl_module_spec": "MultiRLModuleSpec(multi_rl_module_class=<class 'ray.rllib.core.rl_module.multi_rl_module.MultiRLModule'>, observation_space=None, action_space=None, inference_only=False, model_config=None, rl_module_specs={'default_policy': RLModuleSpec(module_class=<class 'source.intrinsic_attention_ppo.rl_modules.DifferentiablePPOModule.DifferentiablePPOModule'>, observation_space=None, action_space=None, inference_only=False, learner_only=False, model_config={'vf_share_layers': True, 'embedding_dim': 62, 'max_seq_len': 3, 'policy_head_hidden_sizes': [32], 'value_head_hidden_sizes': [101], 'embedding_hidden_sizes': [121]}, catalog_class=None, load_state_path=None, model_config_dict=None), 'intrinsic_reward_module': RLModuleSpec(module_class=<class 'source.intrinsic_attention_ppo.rl_modules.IntrinsicAttentionModule.IntrinsicAttentionModule'>, observation_space=None, action_space=None, inference_only=False, learner_only=True, model_config={'intrinsic_reward_network': {'encoder_hidden_sizes': [], 'encoding_dim': 1, 'num_heads': 1, 'head_hidden_sizes': None, 'layers': [{'type': 'attention'}]}, 'extrinsic_value_hidden_layers': [127, 60], 'vf_share_layers': True, 'max_seq_len': 3}, catalog_class=None, load_state_path=None, model_config_dict=None)}, load_state_path=None, modules_to_load=None, module_specs={'default_policy': RLModuleSpec(module_class=<class 'source.intrinsic_attention_ppo.rl_modules.DifferentiablePPOModule.DifferentiablePPOModule'>, observation_space=None, action_space=None, inference_only=False, learner_only=False, model_config={'vf_share_layers': True, 'embedding_dim': 62, 'max_seq_len': 3, 'policy_head_hidden_sizes': [32], 'value_head_hidden_sizes': [101], 'embedding_hidden_sizes': [121]}, catalog_class=None, load_state_path=None, model_config_dict=None), 'intrinsic_reward_module': RLModuleSpec(module_class=<class 'source.intrinsic_attention_ppo.rl_modules.IntrinsicAttentionModule.IntrinsicAttentionModule'>, observation_space=None, action_space=None, inference_only=False, learner_only=True, model_config={'intrinsic_reward_network': {'encoder_hidden_sizes': [], 'encoding_dim': 1, 'num_heads': 1, 'head_hidden_sizes': None, 'layers': [{'type': 'attention'}]}, 'extrinsic_value_hidden_layers': [127, 60], 'vf_share_layers': True, 'max_seq_len': 3}, catalog_class=None, load_state_path=None, model_config_dict=None)})", "algorithm_config_overrides_per_module": {"intrinsic_reward_module": {"lr": 0.0002715581955}}, "_per_module_overrides": {}, "_validate_config": true, "_use_msgpack_checkpoints": false, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "env_task_fn": -1, "enable_connectors": -1, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.161583927863, "kl_target": 0.0201019014258, "vf_loss_coeff": 0.7790510010087, "entropy_coeff": 0.0015431216992, "clip_param": 0.2459212356676, "vf_clip_param": 0.3769744131561, "entropy_coeff_schedule": null, "lr_schedule": null, "sgd_minibatch_size": -1, "vf_share_layers": -1, "differentiable_learner_configs": ["DifferentiableLearnerConfig(learner_class=<class 'source.intrinsic_attention_ppo.learners.IntrinsicAttentionPPOLearner.IntrinsicAttentionPPOLearner'>, learner_connector=None, add_default_connectors_to_learner_pipeline=True, is_multi_agent=False, policies_to_update=['default_policy'], lr=0.0060984166342, num_total_minibatches=0, num_epochs=1, minibatch_size=1000, shuffle_batch_per_epoch=True)"], "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9485408017724, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.callbacks.callbacks.RLlibCallback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 101.190349817276, "iterations_since_restore": 9, "perf": {"cpu_util_percent": 49.125, "ram_util_percent": 80.6875}}
{"timers": {"training_iteration": 11.59146346700688, "restore_env_runners": 9.18473782698164e-06, "training_step": 11.591260590772237, "env_runner_sampling_timer": 1.6879171998274434, "learner_update_timer": 9.689172381491742, "synch_weights": 0.0015988431509968276, "restore_eval_env_runners": 5.49674041798586e-05, "evaluation_iteration": 0.13363815992362732, "synch_eval_env_connectors": 0.0001833170670805098, "synch_env_connectors": 7.099759099057388e-06}, "env_runners": {"module_to_env_connector": {"connector_pipeline_timer": 0.00012399593654631205, "timers": {"connectors": {"remove_single_ts_time_rank_from_batch": 1.248049030173131e-05, "normalize_and_clip_actions": 8.35798127686841e-06, "get_actions": 4.205790433122229e-05, "tensor_to_numpy": 1.595703410702646e-05, "un_batch_to_individual_items": 6.888705637159065e-06, "listify_data_for_vector_env": 1.0958865287008393e-05}}}, "num_agent_steps_sampled_lifetime": {"default_agent": -4930000.0}, "sample": 0.006794798485075523, "episode_len_mean": 20.0, "num_module_steps_sampled": {"default_policy": 5000.0}, "env_to_module_connector": {"connector_pipeline_timer": 6.22612375045476e-05, "timers": {"connectors": {"add_observations_from_episodes_to_batch": 2.9246443126469406e-06, "batch_individual_items": 1.3071699926481352e-05, "numpy_to_tensor": 1.3464291992183757e-05, "add_time_dim_to_batch_and_zero_pad": 7.26048853455187e-06, "add_states_from_episodes_to_batch": 2.838289077396368e-06}}}, "num_env_steps_sampled_lifetime": -4930000.0, "episode_return_mean": -1.6599999999999997, "episode_len_min": 20, "env_step_timer": 1.4658925341555253e-05, "num_module_steps_sampled_lifetime": {"default_policy": -4930000.0}, "env_to_module_sum_episodes_length_in": 10.36823839457432, "episode_len_max": 20, "module_episode_returns_mean": {"default_policy": -1.6599999999999997}, "time_between_sampling": 0.0386626894628394, "num_agent_steps_sampled": {"default_agent": 5000.0}, "episode_duration_sec_mean": 0.00553504745801911, "num_env_steps_sampled": 5000.0, "weights_seq_no": 9.0, "num_episodes": 250.0, "episode_return_max": 8.5, "agent_episode_returns_mean": {"default_agent": -1.6599999999999997}, "num_episodes_lifetime": -246500.0, "env_reset_timer": 5.610868389764273e-05, "env_to_module_sum_episodes_length_out": 10.36823839457432, "rlmodule_inference_timer": 3.388334762011172e-05, "episode_return_min": -11.5, "num_env_steps_sampled_lifetime_throughput": 3095.1662851032816}, "__all_modules__": {"learner_connector_sum_episodes_length_in": 5000.0, "learner_connector": {"connector_pipeline_timer": 0.1747037704252705, "timers": {"connectors": {"add_one_ts_to_episodes_and_truncate": 0.008987782404689544, "add_observations_from_episodes_to_batch": 0.0008665081598608731, "add_columns_from_episodes_to_train_batch": 0.04123269939086671, "add_time_dim_to_batch_and_zero_pad": 0.10332425132365153, "add_states_from_episodes_to_batch": 0.0035405777888486687, "batch_individual_items": 0.016496977857187213, "numpy_to_tensor": 8.580838725841491e-05}}}, "learner_connector_sum_episodes_length_out": 5250.0}, "learners": {"differentiable_learners": {"intrinsic_attention_ppo_learner": {"intrinsic_reward_module": {"module_train_batch_size_mean": 999.0, "num_module_steps_trained_lifetime": 359640, "diff_num_grad_updates_vs_sampler_policy": 51.0, "num_module_steps_trained": 35964, "weights_seq_no": 60.0, "total_loss": 0.0}, "default_policy": {"num_module_steps_trained": 35964, "use_intrinsic_rewards": 1.0, "weights_seq_no": 60.0, "module_train_batch_size_mean": 999.0, "vf_loss": 0.2628357708454132, "entropy": 0.6916955709457397, "diff_num_grad_updates_vs_sampler_policy": 51.0, "policy_loss": -0.00012043672904837877, "num_module_steps_trained_lifetime": 359640, "vf_loss_unclipped": 37.29368591308594, "vf_explained_var": -0.0025197267532348633, "mean_kl_loss": 3.59449622919783e-05, "total_loss": 0.20358046889305115}, "__all_modules__": {"num_env_steps_trained": 189000, "num_module_steps_trained_lifetime": 719280, "num_env_steps_trained_lifetime": 1890000, "num_module_steps_trained": 71928, "num_env_steps_trained_lifetime_throughput": 41611.4295413884}}}, "IntrinsicAttentionMask": [[[0.3212120532989502, 0.33065682649612427, 0.34813109040260315], [0.32176926732063293, 0.33078792691230774, 0.34744277596473694], [0.3227599263191223, 0.3310191035270691, 0.3462209403514862]], [[0.3377523720264435, 0.31781670451164246, 0.34443095326423645], [0.34219062328338623, 0.3013192415237427, 0.3564900755882263], [0.336238831281662, 0.3232226073741913, 0.3405385911464691]], [[0.3577932119369507, 0.32296085357666016, 0.3192458748817444], [0.37405112385749817, 0.31595784425735474, 0.30999109148979187], [0.3759061098098755, 0.315153568983078, 0.3089402914047241]], [[0.31382161378860474, 0.3167826533317566, 0.36939582228660583], [0.3145007789134979, 0.3173660933971405, 0.36813315749168396], [0.32550933957099915, 0.32675036787986755, 0.3477403223514557]], [[0.29307883977890015, 0.3514973223209381, 0.3554238975048065], [0.3118026554584503, 0.34309306740760803, 0.34510427713394165], [0.31296804547309875, 0.3425673246383667, 0.34446462988853455]], [[0.14572232961654663, 0.6915845274925232, 0.16269312798976898], [0.6754071116447449, 2.1411673515103757e-05, 0.32457152009010315], [0.24422375857830048, 0.4988945722579956, 0.25688162446022034]]], "default_policy": {"entropy": 0.6916915774345398, "diff_num_grad_updates_vs_sampler_policy": 1.0, "policy_loss": -0.00012219716154504567, "num_module_steps_trained_lifetime": 59940, "vf_loss_unclipped": 37.18106460571289, "vf_explained_var": 0.0008524656295776367, "module_train_batch_size_mean": 999.0, "num_trainable_parameters": 16595, "total_loss": 0.20357148349285126, "num_module_steps_trained": 5994, "use_intrinsic_rewards": 0.0, "weights_seq_no": 10.0, "curr_entropy_coeff": 0.0015431216992, "mean_kl_loss": 3.65800442523323e-05, "curr_kl_coeff": 0.00015779680688865483, "vf_loss": 0.26283395290374756, "num_module_steps_trained_lifetime_throughput": 577.541955725672}, "intrinsic_reward_module": {"diff_num_grad_updates_vs_sampler_policy": 1.0, "gradients_default_optimizer_global_norm": 0.0, "num_trainable_parameters": 8266, "weights_seq_no": 10.0, "default_optimizer_learning_rate": 0.0002715581955, "total_loss": 0.0, "num_module_steps_trained": 5994, "module_train_batch_size_mean": 999.0, "curr_entropy_coeff": 0.0015431216992, "num_module_steps_trained_lifetime": 59940, "num_module_steps_trained_lifetime_throughput": 577.5450236548834}, "__all_modules__": {"num_non_trainable_parameters": 0, "num_module_steps_trained_lifetime": 119880, "num_env_steps_trained_lifetime": 315000, "num_trainable_parameters": 24861, "num_env_steps_trained": 31500, "num_module_steps_trained": 11988, "num_env_steps_trained_lifetime_throughput": 3035.232654801915, "num_module_steps_trained_throughput": 15474740.564782003, "num_module_steps_trained_lifetime_throughput": 9833438.909801159}}, "num_training_step_calls_per_iteration": 1, "evaluation": {"env_runners": {"env_to_module_connector": {"timers": {"connectors": {"numpy_to_tensor": 1.2024767653532513e-05, "add_states_from_episodes_to_batch": 2.6192588233531936e-06, "batch_individual_items": 1.2235319628419002e-05, "add_time_dim_to_batch_and_zero_pad": 6.700603632212654e-06, "add_observations_from_episodes_to_batch": 2.7261895029371565e-06}}, "connector_pipeline_timer": 5.789254456524328e-05}, "module_to_env_connector": {"timers": {"connectors": {"tensor_to_numpy": 1.5111243581493422e-05, "un_batch_to_individual_items": 6.485006920961255e-06, "listify_data_for_vector_env": 1.0260467498372144e-05, "remove_single_ts_time_rank_from_batch": 1.1659891734933506e-05, "normalize_and_clip_actions": 7.868118840006143e-06, "get_actions": 3.604553402087039e-05}}, "connector_pipeline_timer": 0.0001131992477220659}, "module_episode_returns_mean": {"default_policy": 0.2}, "env_reset_timer": 0.0005685697039355864, "episode_len_mean": 20.0, "num_env_steps_sampled_lifetime": 50400, "num_module_steps_sampled": {"default_policy": 400}, "episode_len_max": 20, "episode_return_max": 14.5, "num_env_steps_sampled": 400, "num_module_steps_sampled_lifetime": {"default_policy": 4000}, "agent_episode_returns_mean": {"default_agent": 0.2}, "episode_return_min": -14.5, "sample": 0.12163670343516722, "num_agent_steps_sampled_lifetime": {"default_agent": 4000}, "env_step_timer": 1.3901111206331325e-05, "weights_seq_no": 10.0, "rlmodule_inference_timer": 3.071593096196604e-05, "num_agent_steps_sampled": {"default_agent": 400}, "episode_duration_sec_mean": 0.00536299126688391, "num_episodes": 20, "num_episodes_lifetime": 200, "env_to_module_sum_episodes_length_out": 10.368238394574323, "episode_return_mean": 0.2, "episode_len_min": 20, "env_to_module_sum_episodes_length_in": 10.368238394574323, "time_between_sampling": 11.48216426115162}, "num_healthy_workers": 1, "actor_manager_num_outstanding_async_reqs": 0, "num_remote_worker_restarts": 0}, "num_env_steps_sampled_lifetime": -4930000.0, "fault_tolerance": {"num_healthy_workers": 0, "num_remote_worker_restarts": 0}, "env_runner_group": {"actor_manager_num_outstanding_async_reqs": 0}, "done": false, "training_iteration": 10, "trial_id": "aea65_00000", "date": "2025-08-11_18-20-05", "timestamp": 1754929205, "time_this_iter_s": 10.540741920471191, "time_total_s": 111.73109173774719, "pid": 10689, "hostname": "Mac", "node_ip": "127.0.0.1", "config": {"exploration_config": {}, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 2, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "env": "Umbrella", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": false, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 0, "create_local_env_runner": true, "num_envs_per_env_runner": 1, "gym_env_vectorize_mode": "SYNC", "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "episodes_to_numpy": true, "max_requests_in_flight_per_env_runner": 1, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "merge_env_runner_states": "training_only", "broadcast_env_runner_states": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "complete_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "sampler_perf_stats_ema_coef": null, "_is_online": true, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": "auto", "num_aggregator_actors_per_learner": 0, "max_requests_in_flight_per_aggregator_actor": 3, "local_gpu_idx": 0, "max_requests_in_flight_per_learner": 3, "gamma": 1, "lr": 0.0002715581955, "grad_clip": 0.5, "grad_clip_by": "global_norm", "_train_batch_size_per_learner": 5000, "train_batch_size": 4000, "num_epochs": 1, "minibatch_size": 1000, "shuffle_batch_per_epoch": true, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "log_std_clip_param": 20.0, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "_disable_preprocessor_api": false, "_disable_action_flattening": false}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {"intrinsic_reward_coeff": 0.2795015916508}, "optimizer": {}, "_learner_class": "<class 'source.intrinsic_attention_ppo.learners.IntrinsicAttentionMetaLearner.IntrinsicAttentionMetaLearner'>", "callbacks_on_algorithm_init": null, "callbacks_on_env_runners_recreated": null, "callbacks_on_offline_eval_runners_recreated": null, "callbacks_on_checkpoint_loaded": null, "callbacks_on_environment_created": null, "callbacks_on_episode_created": null, "callbacks_on_episode_start": null, "callbacks_on_episode_step": null, "callbacks_on_episode_end": null, "callbacks_on_evaluate_start": null, "callbacks_on_evaluate_end": null, "callbacks_on_evaluate_offline_start": null, "callbacks_on_evaluate_offline_end": null, "callbacks_on_sample_end": null, "callbacks_on_train_result": null, "explore": true, "enable_rl_module_and_learner": true, "enable_env_runner_and_connector_v2": true, "_prior_exploration_config": {"type": "StochasticSampling"}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x388285760>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "offline_data_class": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_read_batch_size": null, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "materialize_data": false, "materialize_mapped_data": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "ignore_final_observation": false, "prelearner_class": null, "prelearner_buffer_class": null, "prelearner_buffer_kwargs": {}, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_remaining_data": false, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": 1, "evaluation_duration": 20, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_auto_duration_min_env_steps_per_sample": 100, "evaluation_auto_duration_max_env_steps_per_sample": 2000, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 1, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "offline_evaluation_interval": null, "num_offline_eval_runners": 0, "offline_loss_for_module_fn": null, "offline_evaluation_duration": 1, "offline_evaluation_parallel_to_training": false, "offline_evaluation_timeout_s": 120.0, "num_cpus_per_offline_eval_runner": 1, "num_gpus_per_offline_eval_runner": 0, "custom_resources_per_offline_eval_runner": {}, "restart_failed_offline_eval_runners": true, "ignore_offline_eval_runner_failures": false, "max_num_offline_eval_runner_restarts": 1000, "offline_eval_runner_restore_timeout_s": 1800.0, "max_requests_in_flight_per_offline_eval_runner": 1, "validate_offline_eval_runners_after_construction": true, "offline_eval_runner_health_probe_timeout_s": 30.0, "offline_eval_rl_module_inference_only": false, "broadcast_offline_eval_runner_states": false, "offline_eval_batch_size_per_runner": 256, "dataset_num_iters_per_eval_runner": 1, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "log_gradients": false, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 2, "restart_failed_env_runners": true, "ignore_env_runner_failures": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30.0, "env_runner_restore_timeout_s": 1800.0, "_model_config": {}, "_rl_module_spec": "MultiRLModuleSpec(multi_rl_module_class=<class 'ray.rllib.core.rl_module.multi_rl_module.MultiRLModule'>, observation_space=None, action_space=None, inference_only=False, model_config=None, rl_module_specs={'default_policy': RLModuleSpec(module_class=<class 'source.intrinsic_attention_ppo.rl_modules.DifferentiablePPOModule.DifferentiablePPOModule'>, observation_space=None, action_space=None, inference_only=False, learner_only=False, model_config={'vf_share_layers': True, 'embedding_dim': 62, 'max_seq_len': 3, 'policy_head_hidden_sizes': [32], 'value_head_hidden_sizes': [101], 'embedding_hidden_sizes': [121]}, catalog_class=None, load_state_path=None, model_config_dict=None), 'intrinsic_reward_module': RLModuleSpec(module_class=<class 'source.intrinsic_attention_ppo.rl_modules.IntrinsicAttentionModule.IntrinsicAttentionModule'>, observation_space=None, action_space=None, inference_only=False, learner_only=True, model_config={'intrinsic_reward_network': {'encoder_hidden_sizes': [], 'encoding_dim': 1, 'num_heads': 1, 'head_hidden_sizes': None, 'layers': [{'type': 'attention'}]}, 'extrinsic_value_hidden_layers': [127, 60], 'vf_share_layers': True, 'max_seq_len': 3}, catalog_class=None, load_state_path=None, model_config_dict=None)}, load_state_path=None, modules_to_load=None, module_specs={'default_policy': RLModuleSpec(module_class=<class 'source.intrinsic_attention_ppo.rl_modules.DifferentiablePPOModule.DifferentiablePPOModule'>, observation_space=None, action_space=None, inference_only=False, learner_only=False, model_config={'vf_share_layers': True, 'embedding_dim': 62, 'max_seq_len': 3, 'policy_head_hidden_sizes': [32], 'value_head_hidden_sizes': [101], 'embedding_hidden_sizes': [121]}, catalog_class=None, load_state_path=None, model_config_dict=None), 'intrinsic_reward_module': RLModuleSpec(module_class=<class 'source.intrinsic_attention_ppo.rl_modules.IntrinsicAttentionModule.IntrinsicAttentionModule'>, observation_space=None, action_space=None, inference_only=False, learner_only=True, model_config={'intrinsic_reward_network': {'encoder_hidden_sizes': [], 'encoding_dim': 1, 'num_heads': 1, 'head_hidden_sizes': None, 'layers': [{'type': 'attention'}]}, 'extrinsic_value_hidden_layers': [127, 60], 'vf_share_layers': True, 'max_seq_len': 3}, catalog_class=None, load_state_path=None, model_config_dict=None)})", "algorithm_config_overrides_per_module": {"intrinsic_reward_module": {"lr": 0.0002715581955}}, "_per_module_overrides": {}, "_validate_config": true, "_use_msgpack_checkpoints": false, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "env_task_fn": -1, "enable_connectors": -1, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.161583927863, "kl_target": 0.0201019014258, "vf_loss_coeff": 0.7790510010087, "entropy_coeff": 0.0015431216992, "clip_param": 0.2459212356676, "vf_clip_param": 0.3769744131561, "entropy_coeff_schedule": null, "lr_schedule": null, "sgd_minibatch_size": -1, "vf_share_layers": -1, "differentiable_learner_configs": ["DifferentiableLearnerConfig(learner_class=<class 'source.intrinsic_attention_ppo.learners.IntrinsicAttentionPPOLearner.IntrinsicAttentionPPOLearner'>, learner_connector=None, add_default_connectors_to_learner_pipeline=True, is_multi_agent=False, policies_to_update=['default_policy'], lr=0.0060984166342, num_total_minibatches=0, num_epochs=1, minibatch_size=1000, shuffle_batch_per_epoch=True)"], "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9485408017724, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.callbacks.callbacks.RLlibCallback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 111.73109173774719, "iterations_since_restore": 10, "perf": {"cpu_util_percent": 41.95333333333334, "ram_util_percent": 81.08666666666667}}
{"timers": {"training_iteration": 11.59171225358676, "restore_env_runners": 9.15664064309747e-06, "training_step": 11.591509141954033, "env_runner_sampling_timer": 1.6863161765792452, "learner_update_timer": 9.690983840175983, "synch_weights": 0.0015965667994495747, "restore_eval_env_runners": 5.496355967259066e-05, "evaluation_iteration": 0.13353424207444797, "synch_eval_env_connectors": 0.0001831055560219878, "synch_env_connectors": 7.110431512941282e-06}, "env_runners": {"module_to_env_connector": {"connector_pipeline_timer": 0.00011729688103843508, "timers": {"connectors": {"remove_single_ts_time_rank_from_batch": 1.1978025282791656e-05, "normalize_and_clip_actions": 8.014548206244046e-06, "get_actions": 3.877153226094777e-05, "tensor_to_numpy": 1.5115277441103176e-05, "un_batch_to_individual_items": 6.5918964721787615e-06, "listify_data_for_vector_env": 1.049627484808609e-05}}}, "num_agent_steps_sampled_lifetime": {"default_agent": -5547500.0}, "sample": 0.005761919873670843, "episode_len_mean": 20.0, "num_module_steps_sampled": {"default_policy": 5000.0}, "env_to_module_connector": {"connector_pipeline_timer": 5.9356967284636644e-05, "timers": {"connectors": {"add_observations_from_episodes_to_batch": 2.7843102841218506e-06, "batch_individual_items": 1.2393773926595363e-05, "numpy_to_tensor": 1.2595624309976517e-05, "add_time_dim_to_batch_and_zero_pad": 6.8740179189116325e-06, "add_states_from_episodes_to_batch": 2.7447778021338165e-06}}}, "num_env_steps_sampled_lifetime": -5547500.0, "episode_return_mean": -0.86, "episode_len_min": 20, "env_step_timer": 1.3793141488251535e-05, "num_module_steps_sampled_lifetime": {"default_policy": -5547500.0}, "env_to_module_sum_episodes_length_in": 10.36823839457432, "episode_len_max": 20, "module_episode_returns_mean": {"default_policy": -0.86}, "time_between_sampling": 0.03646135831210231, "num_agent_steps_sampled": {"default_agent": 5000.0}, "episode_duration_sec_mean": 0.005244499837514012, "num_env_steps_sampled": 5000.0, "weights_seq_no": 10.0, "num_episodes": 250.0, "episode_return_max": 8.5, "agent_episode_returns_mean": {"default_agent": -0.86}, "num_episodes_lifetime": -277375.0, "env_reset_timer": 4.3128409207930674e-05, "env_to_module_sum_episodes_length_out": 10.36823839457432, "rlmodule_inference_timer": 3.170199119623869e-05, "episode_return_min": -11.5, "num_env_steps_sampled_lifetime_throughput": 3258.575263672101}, "__all_modules__": {"learner_connector_sum_episodes_length_in": 5000.0, "learner_connector": {"connector_pipeline_timer": 0.17465513481171438, "timers": {"connectors": {"add_one_ts_to_episodes_and_truncate": 0.008986152080304169, "add_observations_from_episodes_to_batch": 0.000866532238721008, "add_columns_from_episodes_to_train_batch": 0.041230676147499104, "add_time_dim_to_batch_and_zero_pad": 0.10331562256104787, "add_states_from_episodes_to_batch": 0.0035445103512444847, "batch_individual_items": 0.016456914328891015, "numpy_to_tensor": 8.603530349848353e-05}}}, "learner_connector_sum_episodes_length_out": 5250.0}, "learners": {"differentiable_learners": {"intrinsic_attention_ppo_learner": {"intrinsic_reward_module": {"module_train_batch_size_mean": 999.0, "num_module_steps_trained_lifetime": 395604, "diff_num_grad_updates_vs_sampler_policy": 56.0, "num_module_steps_trained": 35964, "weights_seq_no": 66.0, "total_loss": 0.0}, "default_policy": {"num_module_steps_trained": 35964, "use_intrinsic_rewards": 1.0, "weights_seq_no": 66.0, "module_train_batch_size_mean": 999.0, "vf_loss": 0.26285409927368164, "entropy": 0.6915316581726074, "diff_num_grad_updates_vs_sampler_policy": 56.0, "policy_loss": -2.706589839363005e-06, "num_module_steps_trained_lifetime": 395604, "vf_loss_unclipped": 38.453460693359375, "vf_explained_var": -0.0025311708450317383, "mean_kl_loss": 1.1966414604103193e-05, "total_loss": 0.20370885729789734}, "__all_modules__": {"num_env_steps_trained": 189000, "num_module_steps_trained_lifetime": 791208, "num_env_steps_trained_lifetime": 2079000, "num_module_steps_trained": 71928, "num_env_steps_trained_lifetime_throughput": 40958.9700110735}}}, "IntrinsicAttentionMask": [[[0.32397589087486267, 0.3421410322189331, 0.3338831067085266], [0.32469624280929565, 0.341457337141037, 0.33384647965431213], [0.3243735730648041, 0.3417634665966034, 0.3338629901409149]], [[0.34217557311058044, 0.31662046909332275, 0.341203898191452], [0.35247477889060974, 0.29724428057670593, 0.35028088092803955], [0.3425582945346832, 0.31589871644973755, 0.3415429890155792]], [[0.3619081676006317, 0.32119622826576233, 0.31689557433128357], [0.37824204564094543, 0.31413933634757996, 0.3076186776161194], [0.3801051080226898, 0.31332919001579285, 0.30656567215919495]], [[0.3159421682357788, 0.3117605149745941, 0.3722972869873047], [0.31479641795158386, 0.31036704778671265, 0.3748364746570587], [0.3296630084514618, 0.3287104070186615, 0.3416266143321991]], [[0.27562883496284485, 0.3660427927970886, 0.35832837224006653], [0.30541345477104187, 0.34903380274772644, 0.3455526828765869], [0.30311545729637146, 0.35033607482910156, 0.3465484380722046]], [[0.42612388730049133, 0.09043654054403305, 0.4834396541118622], [0.2976166605949402, 7.818868652975652e-06, 0.7023754715919495], [0.39835673570632935, 0.17586766183376312, 0.42577555775642395]]], "default_policy": {"entropy": 0.6915342211723328, "diff_num_grad_updates_vs_sampler_policy": 1.0, "policy_loss": -4.417387117428007e-06, "num_module_steps_trained_lifetime": 65934, "vf_loss_unclipped": 38.37425231933594, "vf_explained_var": 4.780292510986328e-05, "module_train_batch_size_mean": 999.0, "num_trainable_parameters": 16595, "total_loss": 0.20367684960365295, "num_module_steps_trained": 5994, "use_intrinsic_rewards": 0.0, "weights_seq_no": 11.0, "curr_entropy_coeff": 0.0015431216992, "mean_kl_loss": 1.1748552424251102e-05, "curr_kl_coeff": 7.889840344432741e-05, "vf_loss": 0.26281771063804626, "num_module_steps_trained_lifetime_throughput": 579.1572258847282}, "intrinsic_reward_module": {"diff_num_grad_updates_vs_sampler_policy": 1.0, "gradients_default_optimizer_global_norm": 0.0, "num_trainable_parameters": 8266, "weights_seq_no": 11.0, "default_optimizer_learning_rate": 0.0002715581955, "total_loss": 0.0, "num_module_steps_trained": 5994, "module_train_batch_size_mean": 999.0, "curr_entropy_coeff": 0.0015431216992, "num_module_steps_trained_lifetime": 65934, "num_module_steps_trained_lifetime_throughput": 579.1600999961652}, "__all_modules__": {"num_non_trainable_parameters": 0, "num_module_steps_trained_lifetime": 131868, "num_env_steps_trained_lifetime": 346500, "num_trainable_parameters": 24861, "num_env_steps_trained": 31500, "num_module_steps_trained": 11988, "num_env_steps_trained_lifetime_throughput": 3043.71650893182, "num_module_steps_trained_throughput": 15296096.265486902, "num_module_steps_trained_lifetime_throughput": 9955014.080130795}}, "num_training_step_calls_per_iteration": 1, "evaluation": {"env_runners": {"env_to_module_connector": {"timers": {"connectors": {"numpy_to_tensor": 1.221114753393209e-05, "add_states_from_episodes_to_batch": 2.646193877813251e-06, "batch_individual_items": 1.2380399089643873e-05, "add_time_dim_to_batch_and_zero_pad": 6.664788304835379e-06, "add_observations_from_episodes_to_batch": 2.752204019063563e-06}}, "connector_pipeline_timer": 5.858282175667061e-05}, "module_to_env_connector": {"timers": {"connectors": {"tensor_to_numpy": 1.5317411763748362e-05, "un_batch_to_individual_items": 6.471564448576093e-06, "listify_data_for_vector_env": 1.0231984602302102e-05, "remove_single_ts_time_rank_from_batch": 1.1690511004181008e-05, "normalize_and_clip_actions": 7.905976537049449e-06, "get_actions": 3.672124839753923e-05}}, "connector_pipeline_timer": 0.00011435292656269466}, "module_episode_returns_mean": {"default_policy": 0.2}, "env_reset_timer": 0.0005657860872011511, "episode_len_mean": 20.0, "num_env_steps_sampled_lifetime": 55400, "num_module_steps_sampled": {"default_policy": 400}, "episode_len_max": 20, "episode_return_max": 14.5, "num_env_steps_sampled": 400, "num_module_steps_sampled_lifetime": {"default_policy": 4400}, "agent_episode_returns_mean": {"default_agent": 0.2}, "episode_return_min": -14.5, "sample": 0.12157464432060279, "num_agent_steps_sampled_lifetime": {"default_agent": 4400}, "env_step_timer": 1.4031608869723464e-05, "weights_seq_no": 11.0, "rlmodule_inference_timer": 3.169934362346051e-05, "num_agent_steps_sampled": {"default_agent": 400}, "episode_duration_sec_mean": 0.005372437535552308, "num_episodes": 20, "num_episodes_lifetime": 220, "env_to_module_sum_episodes_length_out": 10.368238394574323, "episode_return_mean": 0.2, "episode_len_min": 20, "env_to_module_sum_episodes_length_in": 10.368238394574323, "time_between_sampling": 11.483814116460678}, "num_healthy_workers": 1, "actor_manager_num_outstanding_async_reqs": 0, "num_remote_worker_restarts": 0}, "num_env_steps_sampled_lifetime": -5547500.0, "fault_tolerance": {"num_healthy_workers": 0, "num_remote_worker_restarts": 0}, "env_runner_group": {"actor_manager_num_outstanding_async_reqs": 0}, "done": false, "training_iteration": 11, "trial_id": "aea65_00000", "date": "2025-08-11_18-20-17", "timestamp": 1754929217, "time_this_iter_s": 11.743622779846191, "time_total_s": 123.47471451759338, "pid": 10689, "hostname": "Mac", "node_ip": "127.0.0.1", "config": {"exploration_config": {}, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 2, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "env": "Umbrella", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": false, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 0, "create_local_env_runner": true, "num_envs_per_env_runner": 1, "gym_env_vectorize_mode": "SYNC", "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "episodes_to_numpy": true, "max_requests_in_flight_per_env_runner": 1, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "merge_env_runner_states": "training_only", "broadcast_env_runner_states": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "complete_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "sampler_perf_stats_ema_coef": null, "_is_online": true, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": "auto", "num_aggregator_actors_per_learner": 0, "max_requests_in_flight_per_aggregator_actor": 3, "local_gpu_idx": 0, "max_requests_in_flight_per_learner": 3, "gamma": 1, "lr": 0.0002715581955, "grad_clip": 0.5, "grad_clip_by": "global_norm", "_train_batch_size_per_learner": 5000, "train_batch_size": 4000, "num_epochs": 1, "minibatch_size": 1000, "shuffle_batch_per_epoch": true, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "log_std_clip_param": 20.0, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "_disable_preprocessor_api": false, "_disable_action_flattening": false}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {"intrinsic_reward_coeff": 0.2795015916508}, "optimizer": {}, "_learner_class": "<class 'source.intrinsic_attention_ppo.learners.IntrinsicAttentionMetaLearner.IntrinsicAttentionMetaLearner'>", "callbacks_on_algorithm_init": null, "callbacks_on_env_runners_recreated": null, "callbacks_on_offline_eval_runners_recreated": null, "callbacks_on_checkpoint_loaded": null, "callbacks_on_environment_created": null, "callbacks_on_episode_created": null, "callbacks_on_episode_start": null, "callbacks_on_episode_step": null, "callbacks_on_episode_end": null, "callbacks_on_evaluate_start": null, "callbacks_on_evaluate_end": null, "callbacks_on_evaluate_offline_start": null, "callbacks_on_evaluate_offline_end": null, "callbacks_on_sample_end": null, "callbacks_on_train_result": null, "explore": true, "enable_rl_module_and_learner": true, "enable_env_runner_and_connector_v2": true, "_prior_exploration_config": {"type": "StochasticSampling"}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x388285760>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "offline_data_class": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_read_batch_size": null, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "materialize_data": false, "materialize_mapped_data": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "ignore_final_observation": false, "prelearner_class": null, "prelearner_buffer_class": null, "prelearner_buffer_kwargs": {}, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_remaining_data": false, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": 1, "evaluation_duration": 20, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_auto_duration_min_env_steps_per_sample": 100, "evaluation_auto_duration_max_env_steps_per_sample": 2000, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 1, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "offline_evaluation_interval": null, "num_offline_eval_runners": 0, "offline_loss_for_module_fn": null, "offline_evaluation_duration": 1, "offline_evaluation_parallel_to_training": false, "offline_evaluation_timeout_s": 120.0, "num_cpus_per_offline_eval_runner": 1, "num_gpus_per_offline_eval_runner": 0, "custom_resources_per_offline_eval_runner": {}, "restart_failed_offline_eval_runners": true, "ignore_offline_eval_runner_failures": false, "max_num_offline_eval_runner_restarts": 1000, "offline_eval_runner_restore_timeout_s": 1800.0, "max_requests_in_flight_per_offline_eval_runner": 1, "validate_offline_eval_runners_after_construction": true, "offline_eval_runner_health_probe_timeout_s": 30.0, "offline_eval_rl_module_inference_only": false, "broadcast_offline_eval_runner_states": false, "offline_eval_batch_size_per_runner": 256, "dataset_num_iters_per_eval_runner": 1, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "log_gradients": false, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 2, "restart_failed_env_runners": true, "ignore_env_runner_failures": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30.0, "env_runner_restore_timeout_s": 1800.0, "_model_config": {}, "_rl_module_spec": "MultiRLModuleSpec(multi_rl_module_class=<class 'ray.rllib.core.rl_module.multi_rl_module.MultiRLModule'>, observation_space=None, action_space=None, inference_only=False, model_config=None, rl_module_specs={'default_policy': RLModuleSpec(module_class=<class 'source.intrinsic_attention_ppo.rl_modules.DifferentiablePPOModule.DifferentiablePPOModule'>, observation_space=None, action_space=None, inference_only=False, learner_only=False, model_config={'vf_share_layers': True, 'embedding_dim': 62, 'max_seq_len': 3, 'policy_head_hidden_sizes': [32], 'value_head_hidden_sizes': [101], 'embedding_hidden_sizes': [121]}, catalog_class=None, load_state_path=None, model_config_dict=None), 'intrinsic_reward_module': RLModuleSpec(module_class=<class 'source.intrinsic_attention_ppo.rl_modules.IntrinsicAttentionModule.IntrinsicAttentionModule'>, observation_space=None, action_space=None, inference_only=False, learner_only=True, model_config={'intrinsic_reward_network': {'encoder_hidden_sizes': [], 'encoding_dim': 1, 'num_heads': 1, 'head_hidden_sizes': None, 'layers': [{'type': 'attention'}]}, 'extrinsic_value_hidden_layers': [127, 60], 'vf_share_layers': True, 'max_seq_len': 3}, catalog_class=None, load_state_path=None, model_config_dict=None)}, load_state_path=None, modules_to_load=None, module_specs={'default_policy': RLModuleSpec(module_class=<class 'source.intrinsic_attention_ppo.rl_modules.DifferentiablePPOModule.DifferentiablePPOModule'>, observation_space=None, action_space=None, inference_only=False, learner_only=False, model_config={'vf_share_layers': True, 'embedding_dim': 62, 'max_seq_len': 3, 'policy_head_hidden_sizes': [32], 'value_head_hidden_sizes': [101], 'embedding_hidden_sizes': [121]}, catalog_class=None, load_state_path=None, model_config_dict=None), 'intrinsic_reward_module': RLModuleSpec(module_class=<class 'source.intrinsic_attention_ppo.rl_modules.IntrinsicAttentionModule.IntrinsicAttentionModule'>, observation_space=None, action_space=None, inference_only=False, learner_only=True, model_config={'intrinsic_reward_network': {'encoder_hidden_sizes': [], 'encoding_dim': 1, 'num_heads': 1, 'head_hidden_sizes': None, 'layers': [{'type': 'attention'}]}, 'extrinsic_value_hidden_layers': [127, 60], 'vf_share_layers': True, 'max_seq_len': 3}, catalog_class=None, load_state_path=None, model_config_dict=None)})", "algorithm_config_overrides_per_module": {"intrinsic_reward_module": {"lr": 0.0002715581955}}, "_per_module_overrides": {}, "_validate_config": true, "_use_msgpack_checkpoints": false, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "env_task_fn": -1, "enable_connectors": -1, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.161583927863, "kl_target": 0.0201019014258, "vf_loss_coeff": 0.7790510010087, "entropy_coeff": 0.0015431216992, "clip_param": 0.2459212356676, "vf_clip_param": 0.3769744131561, "entropy_coeff_schedule": null, "lr_schedule": null, "sgd_minibatch_size": -1, "vf_share_layers": -1, "differentiable_learner_configs": ["DifferentiableLearnerConfig(learner_class=<class 'source.intrinsic_attention_ppo.learners.IntrinsicAttentionPPOLearner.IntrinsicAttentionPPOLearner'>, learner_connector=None, add_default_connectors_to_learner_pipeline=True, is_multi_agent=False, policies_to_update=['default_policy'], lr=0.0060984166342, num_total_minibatches=0, num_epochs=1, minibatch_size=1000, shuffle_batch_per_epoch=True)"], "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9485408017724, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.callbacks.callbacks.RLlibCallback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 123.47471451759338, "iterations_since_restore": 11, "perf": {"cpu_util_percent": 51.49411764705882, "ram_util_percent": 81.1470588235294}}
{"timers": {"training_iteration": 11.590899208551184, "restore_env_runners": 9.142984026645954e-06, "training_step": 11.590695897193584, "env_runner_sampling_timer": 1.686889638143448, "learner_update_timer": 9.68943382886451, "synch_weights": 0.0015909244615165891, "restore_eval_env_runners": 5.469642331657608e-05, "evaluation_iteration": 0.1334416263142699, "synch_eval_env_connectors": 0.0001827974200905371, "synch_env_connectors": 7.0901576197811634e-06}, "env_runners": {"module_to_env_connector": {"connector_pipeline_timer": 0.00013456460380534252, "timers": {"connectors": {"remove_single_ts_time_rank_from_batch": 1.361638038821197e-05, "normalize_and_clip_actions": 8.886266673674062e-06, "get_actions": 4.560806976991781e-05, "tensor_to_numpy": 1.816219125459777e-05, "un_batch_to_individual_items": 7.614889229685984e-06, "listify_data_for_vector_env": 1.1617485091930365e-05}}}, "num_agent_steps_sampled_lifetime": {"default_agent": -6165000.0}, "sample": 0.006136208931107492, "episode_len_mean": 20.0, "num_module_steps_sampled": {"default_policy": 5000.0}, "env_to_module_connector": {"connector_pipeline_timer": 6.618244165948262e-05, "timers": {"connectors": {"add_observations_from_episodes_to_batch": 3.0620297056360105e-06, "batch_individual_items": 1.3754785711318079e-05, "numpy_to_tensor": 1.505952330117506e-05, "add_time_dim_to_batch_and_zero_pad": 7.611084707839059e-06, "add_states_from_episodes_to_batch": 2.972490286892212e-06}}}, "num_env_steps_sampled_lifetime": -6165000.0, "episode_return_mean": -1.5, "episode_len_min": 20, "env_step_timer": 1.605743833788121e-05, "num_module_steps_sampled_lifetime": {"default_policy": -6165000.0}, "env_to_module_sum_episodes_length_in": 10.36823839457432, "episode_len_max": 20, "module_episode_returns_mean": {"default_policy": -1.5}, "time_between_sampling": 0.04107686497301119, "num_agent_steps_sampled": {"default_agent": 5000.0}, "episode_duration_sec_mean": 0.005972748295869678, "num_env_steps_sampled": 5000.0, "weights_seq_no": 11.0, "num_episodes": 250.0, "episode_return_max": 8.5, "agent_episode_returns_mean": {"default_agent": -1.5}, "num_episodes_lifetime": -308250.0, "env_reset_timer": 4.8076164330522116e-05, "env_to_module_sum_episodes_length_out": 10.36823839457432, "rlmodule_inference_timer": 3.659007738770785e-05, "episode_return_min": -11.5, "num_env_steps_sampled_lifetime_throughput": 2986.318961157692}, "__all_modules__": {"learner_connector_sum_episodes_length_in": 5000.0, "learner_connector": {"connector_pipeline_timer": 0.17462958221413113, "timers": {"connectors": {"add_one_ts_to_episodes_and_truncate": 0.008986320979607032, "add_observations_from_episodes_to_batch": 0.0008665069157662872, "add_columns_from_episodes_to_train_batch": 0.04123086147686028, "add_time_dim_to_batch_and_zero_pad": 0.10331633508436487, "add_states_from_episodes_to_batch": 0.003549093168354418, "batch_individual_items": 0.016425896846294422, "numpy_to_tensor": 8.608119950609909e-05}}}, "learner_connector_sum_episodes_length_out": 5250.0}, "learners": {"differentiable_learners": {"intrinsic_attention_ppo_learner": {"intrinsic_reward_module": {"module_train_batch_size_mean": 999.0, "num_module_steps_trained_lifetime": 431568, "diff_num_grad_updates_vs_sampler_policy": 61.0, "num_module_steps_trained": 35964, "weights_seq_no": 72.0, "total_loss": 0.0}, "default_policy": {"num_module_steps_trained": 35964, "use_intrinsic_rewards": 1.0, "weights_seq_no": 72.0, "module_train_batch_size_mean": 999.0, "vf_loss": 0.262836217880249, "entropy": 0.6912777423858643, "diff_num_grad_updates_vs_sampler_policy": 61.0, "policy_loss": -8.412039460381493e-05, "num_module_steps_trained_lifetime": 431568, "vf_loss_unclipped": 38.167972564697266, "vf_explained_var": -0.0024999380111694336, "mean_kl_loss": 7.955499313538894e-06, "total_loss": 0.2036132514476776}, "__all_modules__": {"num_env_steps_trained": 189000, "num_module_steps_trained_lifetime": 863136, "num_env_steps_trained_lifetime": 2268000, "num_module_steps_trained": 71928, "num_env_steps_trained_lifetime_throughput": 40315.8747336755}}}, "IntrinsicAttentionMask": [[[0.32535696029663086, 0.334923654794693, 0.33971935510635376], [0.3257230222225189, 0.33485254645347595, 0.3394245207309723], [0.3259025812149048, 0.334817498922348, 0.3392798602581024]], [[0.34059011936187744, 0.3151118755340576, 0.34429803490638733], [0.3464927673339844, 0.2999904751777649, 0.3535168468952179], [0.3397466242313385, 0.31724974513053894, 0.34300363063812256]], [[0.3657458424568176, 0.31594324111938477, 0.3183108866214752], [0.3941243588924408, 0.3008515536785126, 0.305024117231369], [0.39265769720077515, 0.3016286790370941, 0.30571362376213074]], [[0.3089057505130768, 0.31208357214927673, 0.3790106773376465], [0.30968907475471497, 0.31277433037757874, 0.3775365948677063], [0.32437819242477417, 0.325614869594574, 0.3500068783760071]], [[0.2774011790752411, 0.35914015769958496, 0.36345863342285156], [0.3092331886291504, 0.3445197641849518, 0.3462471067905426], [0.31075456738471985, 0.3438163995742798, 0.34542906284332275]], [[0.4280660152435303, 0.10232837498188019, 0.46960559487342834], [0.3333032727241516, 7.421977898047771e-06, 0.6666893362998962], [0.40143337845802307, 0.1749686449766159, 0.42359793186187744]]], "default_policy": {"entropy": 0.6912765502929688, "diff_num_grad_updates_vs_sampler_policy": 1.0, "policy_loss": -8.686859655426815e-05, "num_module_steps_trained_lifetime": 71928, "vf_loss_unclipped": 38.094974517822266, "vf_explained_var": -0.00020360946655273438, "module_train_batch_size_mean": 999.0, "num_trainable_parameters": 16595, "total_loss": 0.20360171794891357, "num_module_steps_trained": 5994, "use_intrinsic_rewards": 0.0, "weights_seq_no": 12.0, "curr_entropy_coeff": 0.0015431216992, "mean_kl_loss": 8.062930646701716e-06, "curr_kl_coeff": 3.944920172216371e-05, "vf_loss": 0.2628265619277954, "num_module_steps_trained_lifetime_throughput": 580.228955090272}, "intrinsic_reward_module": {"diff_num_grad_updates_vs_sampler_policy": 1.0, "gradients_default_optimizer_global_norm": 0.0, "num_trainable_parameters": 8266, "weights_seq_no": 12.0, "default_optimizer_learning_rate": 0.0002715581955, "total_loss": 0.0, "num_module_steps_trained": 5994, "module_train_batch_size_mean": 999.0, "curr_entropy_coeff": 0.0015431216992, "num_module_steps_trained_lifetime": 71928, "num_module_steps_trained_lifetime_throughput": 580.231628420776}, "__all_modules__": {"num_non_trainable_parameters": 0, "num_module_steps_trained_lifetime": 143856, "num_env_steps_trained_lifetime": 378000, "num_trainable_parameters": 24861, "num_env_steps_trained": 31500, "num_module_steps_trained": 11988, "num_env_steps_trained_lifetime_throughput": 3049.344063360155, "num_module_steps_trained_throughput": 15114807.105141746, "num_module_steps_trained_lifetime_throughput": 10073606.252087185}}, "num_training_step_calls_per_iteration": 1, "evaluation": {"env_runners": {"env_to_module_connector": {"timers": {"connectors": {"numpy_to_tensor": 1.1937679002435747e-05, "add_states_from_episodes_to_batch": 2.7097678510396753e-06, "batch_individual_items": 1.228420878665912e-05, "add_time_dim_to_batch_and_zero_pad": 6.768009430629289e-06, "add_observations_from_episodes_to_batch": 2.7037667640566584e-06}}, "connector_pipeline_timer": 5.8057807276877294e-05}, "module_to_env_connector": {"timers": {"connectors": {"tensor_to_numpy": 1.5126773701759489e-05, "un_batch_to_individual_items": 6.460206835300074e-06, "listify_data_for_vector_env": 1.0209381261670303e-05, "remove_single_ts_time_rank_from_batch": 1.1677163106662618e-05, "normalize_and_clip_actions": 7.830799049065027e-06, "get_actions": 3.620578716475174e-05}}, "connector_pipeline_timer": 0.00011319886905932726}, "module_episode_returns_mean": {"default_policy": 0.0}, "env_reset_timer": 0.0005630965562654055, "episode_len_mean": 20.0, "num_env_steps_sampled_lifetime": 60400, "num_module_steps_sampled": {"default_policy": 400}, "episode_len_max": 20, "episode_return_max": 14.5, "num_env_steps_sampled": 400, "num_module_steps_sampled_lifetime": {"default_policy": 4800}, "agent_episode_returns_mean": {"default_agent": 0.0}, "episode_return_min": -14.5, "sample": 0.1214994024569222, "num_agent_steps_sampled_lifetime": {"default_agent": 4800}, "env_step_timer": 1.3702539739868976e-05, "weights_seq_no": 12.0, "rlmodule_inference_timer": 3.108210447036661e-05, "num_agent_steps_sampled": {"default_agent": 400}, "episode_duration_sec_mean": 0.005356253403006122, "num_episodes": 20, "num_episodes_lifetime": 240, "env_to_module_sum_episodes_length_out": 10.368238394574323, "episode_return_mean": 0.0, "episode_len_min": 20, "env_to_module_sum_episodes_length_in": 10.368238394574323, "time_between_sampling": 11.484374345715933}, "num_healthy_workers": 1, "actor_manager_num_outstanding_async_reqs": 0, "num_remote_worker_restarts": 0}, "num_env_steps_sampled_lifetime": -6165000.0, "fault_tolerance": {"num_healthy_workers": 0, "num_remote_worker_restarts": 0}, "env_runner_group": {"actor_manager_num_outstanding_async_reqs": 0}, "done": false, "training_iteration": 12, "trial_id": "aea65_00000", "date": "2025-08-11_18-20-29", "timestamp": 1754929229, "time_this_iter_s": 11.635637998580933, "time_total_s": 135.11035251617432, "pid": 10689, "hostname": "Mac", "node_ip": "127.0.0.1", "config": {"exploration_config": {}, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 2, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "env": "Umbrella", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": false, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 0, "create_local_env_runner": true, "num_envs_per_env_runner": 1, "gym_env_vectorize_mode": "SYNC", "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "episodes_to_numpy": true, "max_requests_in_flight_per_env_runner": 1, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "merge_env_runner_states": "training_only", "broadcast_env_runner_states": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "complete_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "sampler_perf_stats_ema_coef": null, "_is_online": true, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": "auto", "num_aggregator_actors_per_learner": 0, "max_requests_in_flight_per_aggregator_actor": 3, "local_gpu_idx": 0, "max_requests_in_flight_per_learner": 3, "gamma": 1, "lr": 0.0002715581955, "grad_clip": 0.5, "grad_clip_by": "global_norm", "_train_batch_size_per_learner": 5000, "train_batch_size": 4000, "num_epochs": 1, "minibatch_size": 1000, "shuffle_batch_per_epoch": true, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "log_std_clip_param": 20.0, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "_disable_preprocessor_api": false, "_disable_action_flattening": false}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {"intrinsic_reward_coeff": 0.2795015916508}, "optimizer": {}, "_learner_class": "<class 'source.intrinsic_attention_ppo.learners.IntrinsicAttentionMetaLearner.IntrinsicAttentionMetaLearner'>", "callbacks_on_algorithm_init": null, "callbacks_on_env_runners_recreated": null, "callbacks_on_offline_eval_runners_recreated": null, "callbacks_on_checkpoint_loaded": null, "callbacks_on_environment_created": null, "callbacks_on_episode_created": null, "callbacks_on_episode_start": null, "callbacks_on_episode_step": null, "callbacks_on_episode_end": null, "callbacks_on_evaluate_start": null, "callbacks_on_evaluate_end": null, "callbacks_on_evaluate_offline_start": null, "callbacks_on_evaluate_offline_end": null, "callbacks_on_sample_end": null, "callbacks_on_train_result": null, "explore": true, "enable_rl_module_and_learner": true, "enable_env_runner_and_connector_v2": true, "_prior_exploration_config": {"type": "StochasticSampling"}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x388285760>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "offline_data_class": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_read_batch_size": null, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "materialize_data": false, "materialize_mapped_data": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "ignore_final_observation": false, "prelearner_class": null, "prelearner_buffer_class": null, "prelearner_buffer_kwargs": {}, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_remaining_data": false, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": 1, "evaluation_duration": 20, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_auto_duration_min_env_steps_per_sample": 100, "evaluation_auto_duration_max_env_steps_per_sample": 2000, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 1, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "offline_evaluation_interval": null, "num_offline_eval_runners": 0, "offline_loss_for_module_fn": null, "offline_evaluation_duration": 1, "offline_evaluation_parallel_to_training": false, "offline_evaluation_timeout_s": 120.0, "num_cpus_per_offline_eval_runner": 1, "num_gpus_per_offline_eval_runner": 0, "custom_resources_per_offline_eval_runner": {}, "restart_failed_offline_eval_runners": true, "ignore_offline_eval_runner_failures": false, "max_num_offline_eval_runner_restarts": 1000, "offline_eval_runner_restore_timeout_s": 1800.0, "max_requests_in_flight_per_offline_eval_runner": 1, "validate_offline_eval_runners_after_construction": true, "offline_eval_runner_health_probe_timeout_s": 30.0, "offline_eval_rl_module_inference_only": false, "broadcast_offline_eval_runner_states": false, "offline_eval_batch_size_per_runner": 256, "dataset_num_iters_per_eval_runner": 1, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "log_gradients": false, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 2, "restart_failed_env_runners": true, "ignore_env_runner_failures": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30.0, "env_runner_restore_timeout_s": 1800.0, "_model_config": {}, "_rl_module_spec": "MultiRLModuleSpec(multi_rl_module_class=<class 'ray.rllib.core.rl_module.multi_rl_module.MultiRLModule'>, observation_space=None, action_space=None, inference_only=False, model_config=None, rl_module_specs={'default_policy': RLModuleSpec(module_class=<class 'source.intrinsic_attention_ppo.rl_modules.DifferentiablePPOModule.DifferentiablePPOModule'>, observation_space=None, action_space=None, inference_only=False, learner_only=False, model_config={'vf_share_layers': True, 'embedding_dim': 62, 'max_seq_len': 3, 'policy_head_hidden_sizes': [32], 'value_head_hidden_sizes': [101], 'embedding_hidden_sizes': [121]}, catalog_class=None, load_state_path=None, model_config_dict=None), 'intrinsic_reward_module': RLModuleSpec(module_class=<class 'source.intrinsic_attention_ppo.rl_modules.IntrinsicAttentionModule.IntrinsicAttentionModule'>, observation_space=None, action_space=None, inference_only=False, learner_only=True, model_config={'intrinsic_reward_network': {'encoder_hidden_sizes': [], 'encoding_dim': 1, 'num_heads': 1, 'head_hidden_sizes': None, 'layers': [{'type': 'attention'}]}, 'extrinsic_value_hidden_layers': [127, 60], 'vf_share_layers': True, 'max_seq_len': 3}, catalog_class=None, load_state_path=None, model_config_dict=None)}, load_state_path=None, modules_to_load=None, module_specs={'default_policy': RLModuleSpec(module_class=<class 'source.intrinsic_attention_ppo.rl_modules.DifferentiablePPOModule.DifferentiablePPOModule'>, observation_space=None, action_space=None, inference_only=False, learner_only=False, model_config={'vf_share_layers': True, 'embedding_dim': 62, 'max_seq_len': 3, 'policy_head_hidden_sizes': [32], 'value_head_hidden_sizes': [101], 'embedding_hidden_sizes': [121]}, catalog_class=None, load_state_path=None, model_config_dict=None), 'intrinsic_reward_module': RLModuleSpec(module_class=<class 'source.intrinsic_attention_ppo.rl_modules.IntrinsicAttentionModule.IntrinsicAttentionModule'>, observation_space=None, action_space=None, inference_only=False, learner_only=True, model_config={'intrinsic_reward_network': {'encoder_hidden_sizes': [], 'encoding_dim': 1, 'num_heads': 1, 'head_hidden_sizes': None, 'layers': [{'type': 'attention'}]}, 'extrinsic_value_hidden_layers': [127, 60], 'vf_share_layers': True, 'max_seq_len': 3}, catalog_class=None, load_state_path=None, model_config_dict=None)})", "algorithm_config_overrides_per_module": {"intrinsic_reward_module": {"lr": 0.0002715581955}}, "_per_module_overrides": {}, "_validate_config": true, "_use_msgpack_checkpoints": false, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "env_task_fn": -1, "enable_connectors": -1, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.161583927863, "kl_target": 0.0201019014258, "vf_loss_coeff": 0.7790510010087, "entropy_coeff": 0.0015431216992, "clip_param": 0.2459212356676, "vf_clip_param": 0.3769744131561, "entropy_coeff_schedule": null, "lr_schedule": null, "sgd_minibatch_size": -1, "vf_share_layers": -1, "differentiable_learner_configs": ["DifferentiableLearnerConfig(learner_class=<class 'source.intrinsic_attention_ppo.learners.IntrinsicAttentionPPOLearner.IntrinsicAttentionPPOLearner'>, learner_connector=None, add_default_connectors_to_learner_pipeline=True, is_multi_agent=False, policies_to_update=['default_policy'], lr=0.0060984166342, num_total_minibatches=0, num_epochs=1, minibatch_size=1000, shuffle_batch_per_epoch=True)"], "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9485408017724, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.callbacks.callbacks.RLlibCallback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 135.11035251617432, "iterations_since_restore": 12, "perf": {"cpu_util_percent": 45.023529411764706, "ram_util_percent": 81.72941176470587}}
{"timers": {"training_iteration": 11.577404278136097, "restore_env_runners": 9.110723437851251e-06, "training_step": 11.577200696562544, "env_runner_sampling_timer": 1.6859451651024886, "learner_update_timer": 9.676804868915779, "synch_weights": 0.0015891231275848017, "restore_eval_env_runners": 5.4248209544303234e-05, "evaluation_iteration": 0.1333301675506853, "synch_eval_env_connectors": 0.00018214777616579317, "synch_env_connectors": 7.068006123751599e-06}, "env_runners": {"module_to_env_connector": {"connector_pipeline_timer": 0.00012193082714327746, "timers": {"connectors": {"remove_single_ts_time_rank_from_batch": 1.2235065107146056e-05, "normalize_and_clip_actions": 8.195777954899494e-06, "get_actions": 4.127385208913078e-05, "tensor_to_numpy": 1.571968252048863e-05, "un_batch_to_individual_items": 6.7882730745105375e-06, "listify_data_for_vector_env": 1.084877002043835e-05}}}, "num_agent_steps_sampled_lifetime": {"default_agent": -6782500.0}, "sample": 0.005990316315110713, "episode_len_mean": 20.0, "num_module_steps_sampled": {"default_policy": 5000.0}, "env_to_module_connector": {"connector_pipeline_timer": 6.149013410129383e-05, "timers": {"connectors": {"add_observations_from_episodes_to_batch": 2.8650754450769585e-06, "batch_individual_items": 1.2968255527214939e-05, "numpy_to_tensor": 1.3346041399736189e-05, "add_time_dim_to_batch_and_zero_pad": 7.109335408803732e-06, "add_states_from_episodes_to_batch": 2.8061911899187386e-06}}}, "num_env_steps_sampled_lifetime": -6782500.0, "episode_return_mean": -0.9399999999999996, "episode_len_min": 20, "env_step_timer": 1.4454874167220626e-05, "num_module_steps_sampled_lifetime": {"default_policy": -6782500.0}, "env_to_module_sum_episodes_length_in": 10.36823839457432, "episode_len_max": 20, "module_episode_returns_mean": {"default_policy": -0.9399999999999996}, "time_between_sampling": 0.040246024554073764, "num_agent_steps_sampled": {"default_agent": 5000.0}, "episode_duration_sec_mean": 0.005450804901309311, "num_env_steps_sampled": 5000.0, "weights_seq_no": 12.0, "num_episodes": 250.0, "episode_return_max": 8.5, "agent_episode_returns_mean": {"default_agent": -0.9399999999999996}, "num_episodes_lifetime": -339125.0, "env_reset_timer": 4.694624672264525e-05, "env_to_module_sum_episodes_length_out": 10.36823839457432, "rlmodule_inference_timer": 3.297765282645215e-05, "episode_return_min": -11.5, "num_env_steps_sampled_lifetime_throughput": 3138.44926386541}, "__all_modules__": {"learner_connector_sum_episodes_length_in": 5000.0, "learner_connector": {"connector_pipeline_timer": 0.17459272056203293, "timers": {"connectors": {"add_one_ts_to_episodes_and_truncate": 0.00898544276984948, "add_observations_from_episodes_to_batch": 0.000866258937475339, "add_columns_from_episodes_to_train_batch": 0.041232904522384276, "add_time_dim_to_batch_and_zero_pad": 0.10331184548363678, "add_states_from_episodes_to_batch": 0.0035543543269517495, "batch_individual_items": 0.01638794412829006, "numpy_to_tensor": 8.59891384170287e-05}}}, "learner_connector_sum_episodes_length_out": 5250.0}, "learners": {"differentiable_learners": {"intrinsic_attention_ppo_learner": {"intrinsic_reward_module": {"module_train_batch_size_mean": 999.0, "num_module_steps_trained_lifetime": 467532, "diff_num_grad_updates_vs_sampler_policy": 66.0, "num_module_steps_trained": 35964, "weights_seq_no": 78.0, "total_loss": 0.0}, "default_policy": {"num_module_steps_trained": 35964, "use_intrinsic_rewards": 1.0, "weights_seq_no": 78.0, "module_train_batch_size_mean": 999.0, "vf_loss": 0.26283788681030273, "entropy": 0.6909804940223694, "diff_num_grad_updates_vs_sampler_policy": 66.0, "policy_loss": -0.0001548617728985846, "num_module_steps_trained_lifetime": 467532, "vf_loss_unclipped": 39.0013542175293, "vf_explained_var": -0.0024837255477905273, "mean_kl_loss": 1.7304733773926273e-05, "total_loss": 0.20354580879211426}, "__all_modules__": {"num_env_steps_trained": 189000, "num_module_steps_trained_lifetime": 935064, "num_env_steps_trained_lifetime": 2457000, "num_module_steps_trained": 71928, "num_env_steps_trained_lifetime_throughput": 39697.235555932384}}}, "IntrinsicAttentionMask": [[[0.32397592067718506, 0.34214097261428833, 0.333883136510849], [0.32469630241394043, 0.3414572775363922, 0.33384647965431213], [0.32437360286712646, 0.3417634069919586, 0.3338629901409149]], [[0.34205862879753113, 0.31274184584617615, 0.3451995849609375], [0.3533659875392914, 0.285495787858963, 0.361138254404068], [0.34085655212402344, 0.31559938192367554, 0.343544065952301]], [[0.3634754717350006, 0.32018953561782837, 0.3163350224494934], [0.38624781370162964, 0.31009441614151, 0.30365777015686035], [0.3884507417678833, 0.3091107904911041, 0.3024383783340454]], [[0.30669593811035156, 0.31692439317703247, 0.3763796389102936], [0.31014516949653625, 0.31913861632347107, 0.37071624398231506], [0.32812365889549255, 0.33025068044662476, 0.3416256606578827]], [[0.2900320887565613, 0.347842812538147, 0.3621251583099365], [0.3101496696472168, 0.34127405285835266, 0.3485763370990753], [0.3147033751010895, 0.3397444188594818, 0.3455522060394287]], [[0.14572367072105408, 0.6915817856788635, 0.16269449889659882], [0.6754055023193359, 2.1413889044197276e-05, 0.3245730996131897], [0.244224414229393, 0.4988933205604553, 0.2568822503089905]]], "default_policy": {"entropy": 0.690973162651062, "diff_num_grad_updates_vs_sampler_policy": 1.0, "policy_loss": -0.00015880331920925528, "num_module_steps_trained_lifetime": 77922, "vf_loss_unclipped": 38.9370002746582, "vf_explained_var": -0.00021541118621826172, "module_train_batch_size_mean": 999.0, "num_trainable_parameters": 16595, "total_loss": 0.20352940261363983, "num_module_steps_trained": 5994, "use_intrinsic_rewards": 0.0, "weights_seq_no": 13.0, "curr_entropy_coeff": 0.0015431216992, "mean_kl_loss": 1.7988986655836925e-05, "curr_kl_coeff": 1.9724600861081854e-05, "vf_loss": 0.26282545924186707, "num_module_steps_trained_lifetime_throughput": 581.974787227322}, "intrinsic_reward_module": {"diff_num_grad_updates_vs_sampler_policy": 1.0, "gradients_default_optimizer_global_norm": 0.0, "num_trainable_parameters": 8266, "weights_seq_no": 13.0, "default_optimizer_learning_rate": 0.0002715581955, "total_loss": 0.0, "num_module_steps_trained": 5994, "module_train_batch_size_mean": 999.0, "curr_entropy_coeff": 0.0015431216992, "num_module_steps_trained_lifetime": 77922, "num_module_steps_trained_lifetime_throughput": 581.9772567462957}, "__all_modules__": {"num_non_trainable_parameters": 0, "num_module_steps_trained_lifetime": 155844, "num_env_steps_trained_lifetime": 409500, "num_trainable_parameters": 24861, "num_env_steps_trained": 31500, "num_module_steps_trained": 11988, "num_env_steps_trained_lifetime_throughput": 3058.514359930297, "num_module_steps_trained_throughput": 14958127.254594995, "num_module_steps_trained_lifetime_throughput": 10197008.15068243}}, "num_training_step_calls_per_iteration": 1, "evaluation": {"env_runners": {"env_to_module_connector": {"timers": {"connectors": {"numpy_to_tensor": 1.2083334717369594e-05, "add_states_from_episodes_to_batch": 2.643497813361407e-06, "batch_individual_items": 1.231144197249721e-05, "add_time_dim_to_batch_and_zero_pad": 6.5909782958380474e-06, "add_observations_from_episodes_to_batch": 2.705342866662193e-06}}, "connector_pipeline_timer": 5.7981123971998275e-05}, "module_to_env_connector": {"timers": {"connectors": {"tensor_to_numpy": 1.5059935478234526e-05, "un_batch_to_individual_items": 6.553605599997242e-06, "listify_data_for_vector_env": 1.0222110407627419e-05, "remove_single_ts_time_rank_from_batch": 1.1754650709709051e-05, "normalize_and_clip_actions": 7.937461677887313e-06, "get_actions": 3.674250543469999e-05}}, "connector_pipeline_timer": 0.00011398760887530547}, "module_episode_returns_mean": {"default_policy": 1.2}, "env_reset_timer": 0.0005588426710371019, "episode_len_mean": 20.0, "num_env_steps_sampled_lifetime": 65400, "num_module_steps_sampled": {"default_policy": 400}, "episode_len_max": 20, "episode_return_max": 14.5, "num_env_steps_sampled": 400, "num_module_steps_sampled_lifetime": {"default_policy": 5200}, "agent_episode_returns_mean": {"default_agent": 1.2}, "episode_return_min": -14.5, "sample": 0.12141154218247689, "num_agent_steps_sampled_lifetime": {"default_agent": 5200}, "env_step_timer": 1.3763355802100183e-05, "weights_seq_no": 13.0, "rlmodule_inference_timer": 3.088609443408935e-05, "num_agent_steps_sampled": {"default_agent": 400}, "episode_duration_sec_mean": 0.005332974208286032, "num_episodes": 20, "num_episodes_lifetime": 260, "env_to_module_sum_episodes_length_out": 10.368238394574323, "episode_return_mean": 1.2, "episode_len_min": 20, "env_to_module_sum_episodes_length_in": 10.368238394574323, "time_between_sampling": 11.472219133509233}, "num_healthy_workers": 1, "actor_manager_num_outstanding_async_reqs": 0, "num_remote_worker_restarts": 0}, "num_env_steps_sampled_lifetime": -6782500.0, "fault_tolerance": {"num_healthy_workers": 0, "num_remote_worker_restarts": 0}, "env_runner_group": {"actor_manager_num_outstanding_async_reqs": 0}, "done": false, "training_iteration": 13, "trial_id": "aea65_00000", "date": "2025-08-11_18-20-39", "timestamp": 1754929239, "time_this_iter_s": 10.363770008087158, "time_total_s": 145.47412252426147, "pid": 10689, "hostname": "Mac", "node_ip": "127.0.0.1", "config": {"exploration_config": {}, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 2, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "env": "Umbrella", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": false, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 0, "create_local_env_runner": true, "num_envs_per_env_runner": 1, "gym_env_vectorize_mode": "SYNC", "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "episodes_to_numpy": true, "max_requests_in_flight_per_env_runner": 1, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "merge_env_runner_states": "training_only", "broadcast_env_runner_states": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "complete_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "sampler_perf_stats_ema_coef": null, "_is_online": true, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": "auto", "num_aggregator_actors_per_learner": 0, "max_requests_in_flight_per_aggregator_actor": 3, "local_gpu_idx": 0, "max_requests_in_flight_per_learner": 3, "gamma": 1, "lr": 0.0002715581955, "grad_clip": 0.5, "grad_clip_by": "global_norm", "_train_batch_size_per_learner": 5000, "train_batch_size": 4000, "num_epochs": 1, "minibatch_size": 1000, "shuffle_batch_per_epoch": true, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "log_std_clip_param": 20.0, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "_disable_preprocessor_api": false, "_disable_action_flattening": false}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {"intrinsic_reward_coeff": 0.2795015916508}, "optimizer": {}, "_learner_class": "<class 'source.intrinsic_attention_ppo.learners.IntrinsicAttentionMetaLearner.IntrinsicAttentionMetaLearner'>", "callbacks_on_algorithm_init": null, "callbacks_on_env_runners_recreated": null, "callbacks_on_offline_eval_runners_recreated": null, "callbacks_on_checkpoint_loaded": null, "callbacks_on_environment_created": null, "callbacks_on_episode_created": null, "callbacks_on_episode_start": null, "callbacks_on_episode_step": null, "callbacks_on_episode_end": null, "callbacks_on_evaluate_start": null, "callbacks_on_evaluate_end": null, "callbacks_on_evaluate_offline_start": null, "callbacks_on_evaluate_offline_end": null, "callbacks_on_sample_end": null, "callbacks_on_train_result": null, "explore": true, "enable_rl_module_and_learner": true, "enable_env_runner_and_connector_v2": true, "_prior_exploration_config": {"type": "StochasticSampling"}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x388285760>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "offline_data_class": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_read_batch_size": null, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "materialize_data": false, "materialize_mapped_data": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "ignore_final_observation": false, "prelearner_class": null, "prelearner_buffer_class": null, "prelearner_buffer_kwargs": {}, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_remaining_data": false, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": 1, "evaluation_duration": 20, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_auto_duration_min_env_steps_per_sample": 100, "evaluation_auto_duration_max_env_steps_per_sample": 2000, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 1, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "offline_evaluation_interval": null, "num_offline_eval_runners": 0, "offline_loss_for_module_fn": null, "offline_evaluation_duration": 1, "offline_evaluation_parallel_to_training": false, "offline_evaluation_timeout_s": 120.0, "num_cpus_per_offline_eval_runner": 1, "num_gpus_per_offline_eval_runner": 0, "custom_resources_per_offline_eval_runner": {}, "restart_failed_offline_eval_runners": true, "ignore_offline_eval_runner_failures": false, "max_num_offline_eval_runner_restarts": 1000, "offline_eval_runner_restore_timeout_s": 1800.0, "max_requests_in_flight_per_offline_eval_runner": 1, "validate_offline_eval_runners_after_construction": true, "offline_eval_runner_health_probe_timeout_s": 30.0, "offline_eval_rl_module_inference_only": false, "broadcast_offline_eval_runner_states": false, "offline_eval_batch_size_per_runner": 256, "dataset_num_iters_per_eval_runner": 1, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "log_gradients": false, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 2, "restart_failed_env_runners": true, "ignore_env_runner_failures": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30.0, "env_runner_restore_timeout_s": 1800.0, "_model_config": {}, "_rl_module_spec": "MultiRLModuleSpec(multi_rl_module_class=<class 'ray.rllib.core.rl_module.multi_rl_module.MultiRLModule'>, observation_space=None, action_space=None, inference_only=False, model_config=None, rl_module_specs={'default_policy': RLModuleSpec(module_class=<class 'source.intrinsic_attention_ppo.rl_modules.DifferentiablePPOModule.DifferentiablePPOModule'>, observation_space=None, action_space=None, inference_only=False, learner_only=False, model_config={'vf_share_layers': True, 'embedding_dim': 62, 'max_seq_len': 3, 'policy_head_hidden_sizes': [32], 'value_head_hidden_sizes': [101], 'embedding_hidden_sizes': [121]}, catalog_class=None, load_state_path=None, model_config_dict=None), 'intrinsic_reward_module': RLModuleSpec(module_class=<class 'source.intrinsic_attention_ppo.rl_modules.IntrinsicAttentionModule.IntrinsicAttentionModule'>, observation_space=None, action_space=None, inference_only=False, learner_only=True, model_config={'intrinsic_reward_network': {'encoder_hidden_sizes': [], 'encoding_dim': 1, 'num_heads': 1, 'head_hidden_sizes': None, 'layers': [{'type': 'attention'}]}, 'extrinsic_value_hidden_layers': [127, 60], 'vf_share_layers': True, 'max_seq_len': 3}, catalog_class=None, load_state_path=None, model_config_dict=None)}, load_state_path=None, modules_to_load=None, module_specs={'default_policy': RLModuleSpec(module_class=<class 'source.intrinsic_attention_ppo.rl_modules.DifferentiablePPOModule.DifferentiablePPOModule'>, observation_space=None, action_space=None, inference_only=False, learner_only=False, model_config={'vf_share_layers': True, 'embedding_dim': 62, 'max_seq_len': 3, 'policy_head_hidden_sizes': [32], 'value_head_hidden_sizes': [101], 'embedding_hidden_sizes': [121]}, catalog_class=None, load_state_path=None, model_config_dict=None), 'intrinsic_reward_module': RLModuleSpec(module_class=<class 'source.intrinsic_attention_ppo.rl_modules.IntrinsicAttentionModule.IntrinsicAttentionModule'>, observation_space=None, action_space=None, inference_only=False, learner_only=True, model_config={'intrinsic_reward_network': {'encoder_hidden_sizes': [], 'encoding_dim': 1, 'num_heads': 1, 'head_hidden_sizes': None, 'layers': [{'type': 'attention'}]}, 'extrinsic_value_hidden_layers': [127, 60], 'vf_share_layers': True, 'max_seq_len': 3}, catalog_class=None, load_state_path=None, model_config_dict=None)})", "algorithm_config_overrides_per_module": {"intrinsic_reward_module": {"lr": 0.0002715581955}}, "_per_module_overrides": {}, "_validate_config": true, "_use_msgpack_checkpoints": false, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "env_task_fn": -1, "enable_connectors": -1, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.161583927863, "kl_target": 0.0201019014258, "vf_loss_coeff": 0.7790510010087, "entropy_coeff": 0.0015431216992, "clip_param": 0.2459212356676, "vf_clip_param": 0.3769744131561, "entropy_coeff_schedule": null, "lr_schedule": null, "sgd_minibatch_size": -1, "vf_share_layers": -1, "differentiable_learner_configs": ["DifferentiableLearnerConfig(learner_class=<class 'source.intrinsic_attention_ppo.learners.IntrinsicAttentionPPOLearner.IntrinsicAttentionPPOLearner'>, learner_connector=None, add_default_connectors_to_learner_pipeline=True, is_multi_agent=False, policies_to_update=['default_policy'], lr=0.0060984166342, num_total_minibatches=0, num_epochs=1, minibatch_size=1000, shuffle_batch_per_epoch=True)"], "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9485408017724, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.callbacks.callbacks.RLlibCallback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 145.47412252426147, "iterations_since_restore": 13, "perf": {"cpu_util_percent": 37.693333333333335, "ram_util_percent": 81.54666666666665}}
{"timers": {"training_iteration": 11.580654202014761, "restore_env_runners": 9.085456052885179e-06, "training_step": 11.5804501825175, "env_runner_sampling_timer": 1.6964186184515393, "learner_update_timer": 9.669053322305942, "synch_weights": 0.001588293985387082, "restore_eval_env_runners": 5.41790581775699e-05, "evaluation_iteration": 0.13319019920504416, "synch_eval_env_connectors": 0.00018186545797029926, "synch_env_connectors": 7.088155624909894e-06}, "env_runners": {"module_to_env_connector": {"connector_pipeline_timer": 0.000191588552466055, "timers": {"connectors": {"remove_single_ts_time_rank_from_batch": 1.7557470951713823e-05, "normalize_and_clip_actions": 1.2132273042794346e-05, "get_actions": 7.425332026924894e-05, "tensor_to_numpy": 2.467696666314198e-05, "un_batch_to_individual_items": 9.154450423026994e-06, "listify_data_for_vector_env": 1.5869814651194725e-05}}}, "num_agent_steps_sampled_lifetime": {"default_agent": -7400000.0}, "sample": 0.008892806759397392, "episode_len_mean": 20.0, "num_module_steps_sampled": {"default_policy": 5000.0}, "env_to_module_connector": {"connector_pipeline_timer": 9.631023371913514e-05, "timers": {"connectors": {"add_observations_from_episodes_to_batch": 4.219537261750062e-06, "batch_individual_items": 2.011520667069862e-05, "numpy_to_tensor": 2.415103166143215e-05, "add_time_dim_to_batch_and_zero_pad": 1.1305373201647026e-05, "add_states_from_episodes_to_batch": 4.042657471974961e-06}}}, "num_env_steps_sampled_lifetime": -7400000.0, "episode_return_mean": -0.3, "episode_len_min": 20, "env_step_timer": 2.5530986176879468e-05, "num_module_steps_sampled_lifetime": {"default_policy": -7400000.0}, "env_to_module_sum_episodes_length_in": 10.36823839457432, "episode_len_max": 20, "module_episode_returns_mean": {"default_policy": -0.3}, "time_between_sampling": 0.03622146362265555, "num_agent_steps_sampled": {"default_agent": 5000.0}, "episode_duration_sec_mean": 0.009562905332073574, "num_env_steps_sampled": 5000.0, "weights_seq_no": 13.0, "num_episodes": 250.0, "episode_return_max": 8.5, "agent_episode_returns_mean": {"default_agent": -0.3}, "num_episodes_lifetime": -370000.0, "env_reset_timer": 6.569920331221725e-05, "env_to_module_sum_episodes_length_out": 10.36823839457432, "rlmodule_inference_timer": 0.00010001936673404907, "episode_return_min": -11.5, "num_env_steps_sampled_lifetime_throughput": 2457.0529754142335}, "__all_modules__": {"learner_connector_sum_episodes_length_in": 5000.0, "learner_connector": {"connector_pipeline_timer": 0.17482164794678384, "timers": {"connectors": {"add_one_ts_to_episodes_and_truncate": 0.009022724171685367, "add_observations_from_episodes_to_batch": 0.0008671721881863304, "add_columns_from_episodes_to_train_batch": 0.04128448755673684, "add_time_dim_to_batch_and_zero_pad": 0.103465312857928, "add_states_from_episodes_to_batch": 0.0035641495340334524, "batch_individual_items": 0.016363690937609466, "numpy_to_tensor": 8.61404968749806e-05}}}, "learner_connector_sum_episodes_length_out": 5250.0}, "learners": {"differentiable_learners": {"intrinsic_attention_ppo_learner": {"intrinsic_reward_module": {"module_train_batch_size_mean": 999.0, "num_module_steps_trained_lifetime": 503496, "diff_num_grad_updates_vs_sampler_policy": 71.0, "num_module_steps_trained": 35964, "weights_seq_no": 84.0, "total_loss": 0.0}, "default_policy": {"num_module_steps_trained": 35964, "use_intrinsic_rewards": 1.0, "weights_seq_no": 84.0, "module_train_batch_size_mean": 999.0, "vf_loss": 0.262831449508667, "entropy": 0.6901451349258423, "diff_num_grad_updates_vs_sampler_policy": 71.0, "policy_loss": -0.00013867588131688535, "num_module_steps_trained_lifetime": 503496, "vf_loss_unclipped": 37.29423904418945, "vf_explained_var": -0.0024052858352661133, "mean_kl_loss": 4.549261575448327e-05, "total_loss": 0.20356278121471405}, "__all_modules__": {"num_env_steps_trained": 189000, "num_module_steps_trained_lifetime": 1006992, "num_env_steps_trained_lifetime": 2646000, "num_module_steps_trained": 71928, "num_env_steps_trained_lifetime_throughput": 39104.060881811005}}}, "IntrinsicAttentionMask": [[[0.3172277808189392, 0.33895936608314514, 0.34381285309791565], [0.31890732049942017, 0.33838093280792236, 0.34271183609962463], [0.31926825642585754, 0.338256299495697, 0.34247541427612305]], [[0.3377523422241211, 0.3178167939186096, 0.3444308936595917], [0.34219059348106384, 0.30131950974464417, 0.356489896774292], [0.336238831281662, 0.32322263717651367, 0.34053856134414673]], [[0.3586418926715851, 0.32231462001800537, 0.31904348731040955], [0.38129380345344543, 0.312301903963089, 0.3064042925834656], [0.38348624110221863, 0.31132572889328003, 0.30518803000450134]], [[0.31846851110458374, 0.31425347924232483, 0.36727800965309143], [0.3174915015697479, 0.31302425265312195, 0.36948418617248535], [0.3286857008934021, 0.3272877037525177, 0.3440266251564026]], [[0.2856760025024414, 0.36072129011154175, 0.35360270738601685], [0.30886149406433105, 0.3473011553287506, 0.34383735060691833], [0.30684003233909607, 0.34846368432044983, 0.3446963429450989]], [[0.14838512241840363, 0.6894271969795227, 0.16218774020671844], [0.6415980458259583, 2.749446503003128e-05, 0.3583745062351227], [0.22595323622226715, 0.5364917516708374, 0.23755496740341187]]], "default_policy": {"entropy": 0.6901412606239319, "diff_num_grad_updates_vs_sampler_policy": 1.0, "policy_loss": -0.00014064740389585495, "num_module_steps_trained_lifetime": 83916, "vf_loss_unclipped": 37.20138931274414, "vf_explained_var": 0.00021028518676757812, "module_train_batch_size_mean": 999.0, "num_trainable_parameters": 16595, "total_loss": 0.2035488784313202, "num_module_steps_trained": 5994, "use_intrinsic_rewards": 0.0, "weights_seq_no": 14.0, "curr_entropy_coeff": 0.0015431216992, "mean_kl_loss": 4.59786897408776e-05, "curr_kl_coeff": 9.862300430540927e-06, "vf_loss": 0.26282551884651184, "num_module_steps_trained_lifetime_throughput": 583.5245959656197}, "intrinsic_reward_module": {"diff_num_grad_updates_vs_sampler_policy": 1.0, "gradients_default_optimizer_global_norm": 0.0, "num_trainable_parameters": 8266, "weights_seq_no": 14.0, "default_optimizer_learning_rate": 0.0002715581955, "total_loss": 0.0, "num_module_steps_trained": 5994, "module_train_batch_size_mean": 999.0, "curr_entropy_coeff": 0.0015431216992, "num_module_steps_trained_lifetime": 83916, "num_module_steps_trained_lifetime_throughput": 583.5268766719299}, "__all_modules__": {"num_non_trainable_parameters": 0, "num_module_steps_trained_lifetime": 167832, "num_env_steps_trained_lifetime": 441000, "num_trainable_parameters": 24861, "num_env_steps_trained": 31500, "num_module_steps_trained": 11988, "num_env_steps_trained_lifetime_throughput": 3066.6546789001754, "num_module_steps_trained_throughput": 14805399.092802286, "num_module_steps_trained_lifetime_throughput": 10308064.839312166}}, "num_training_step_calls_per_iteration": 1, "evaluation": {"env_runners": {"env_to_module_connector": {"timers": {"connectors": {"numpy_to_tensor": 1.3708200116271947e-05, "add_states_from_episodes_to_batch": 3.075036822407269e-06, "batch_individual_items": 1.327552718002771e-05, "add_time_dim_to_batch_and_zero_pad": 7.39429222159402e-06, "add_observations_from_episodes_to_batch": 3.1756646067409235e-06}}, "connector_pipeline_timer": 6.410941831463776e-05}, "module_to_env_connector": {"timers": {"connectors": {"tensor_to_numpy": 1.7069947549246513e-05, "un_batch_to_individual_items": 7.073184371410739e-06, "listify_data_for_vector_env": 1.1163115509478896e-05, "remove_single_ts_time_rank_from_batch": 1.2844795518486979e-05, "normalize_and_clip_actions": 8.448137097233893e-06, "get_actions": 4.4332652299725026e-05}}, "connector_pipeline_timer": 0.00012918084112406702}, "module_episode_returns_mean": {"default_policy": 0.6}, "env_reset_timer": 0.0005564242440174573, "episode_len_mean": 20.0, "num_env_steps_sampled_lifetime": 70400, "num_module_steps_sampled": {"default_policy": 400}, "episode_len_max": 20, "episode_return_max": 14.5, "num_env_steps_sampled": 400, "num_module_steps_sampled_lifetime": {"default_policy": 5600}, "agent_episode_returns_mean": {"default_agent": 0.6}, "episode_return_min": -14.5, "sample": 0.12146934301018623, "num_agent_steps_sampled_lifetime": {"default_agent": 5600}, "env_step_timer": 1.5858826245369272e-05, "weights_seq_no": 14.0, "rlmodule_inference_timer": 3.778746970824397e-05, "num_agent_steps_sampled": {"default_agent": 400}, "episode_duration_sec_mean": 0.005330247564706951, "num_episodes": 20, "num_episodes_lifetime": 280, "env_to_module_sum_episodes_length_out": 10.368238394574323, "episode_return_mean": 0.6, "episode_len_min": 20, "env_to_module_sum_episodes_length_in": 10.368238394574323, "time_between_sampling": 11.47678702425513}, "num_healthy_workers": 1, "actor_manager_num_outstanding_async_reqs": 0, "num_remote_worker_restarts": 0}, "num_env_steps_sampled_lifetime": -7400000.0, "fault_tolerance": {"num_healthy_workers": 0, "num_remote_worker_restarts": 0}, "env_runner_group": {"actor_manager_num_outstanding_async_reqs": 0}, "done": false, "training_iteration": 14, "trial_id": "aea65_00000", "date": "2025-08-11_18-20-51", "timestamp": 1754929251, "time_this_iter_s": 12.046626091003418, "time_total_s": 157.5207486152649, "pid": 10689, "hostname": "Mac", "node_ip": "127.0.0.1", "config": {"exploration_config": {}, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 2, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "env": "Umbrella", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": false, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 0, "create_local_env_runner": true, "num_envs_per_env_runner": 1, "gym_env_vectorize_mode": "SYNC", "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "episodes_to_numpy": true, "max_requests_in_flight_per_env_runner": 1, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "merge_env_runner_states": "training_only", "broadcast_env_runner_states": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "complete_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "sampler_perf_stats_ema_coef": null, "_is_online": true, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": "auto", "num_aggregator_actors_per_learner": 0, "max_requests_in_flight_per_aggregator_actor": 3, "local_gpu_idx": 0, "max_requests_in_flight_per_learner": 3, "gamma": 1, "lr": 0.0002715581955, "grad_clip": 0.5, "grad_clip_by": "global_norm", "_train_batch_size_per_learner": 5000, "train_batch_size": 4000, "num_epochs": 1, "minibatch_size": 1000, "shuffle_batch_per_epoch": true, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "log_std_clip_param": 20.0, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "_disable_preprocessor_api": false, "_disable_action_flattening": false}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {"intrinsic_reward_coeff": 0.2795015916508}, "optimizer": {}, "_learner_class": "<class 'source.intrinsic_attention_ppo.learners.IntrinsicAttentionMetaLearner.IntrinsicAttentionMetaLearner'>", "callbacks_on_algorithm_init": null, "callbacks_on_env_runners_recreated": null, "callbacks_on_offline_eval_runners_recreated": null, "callbacks_on_checkpoint_loaded": null, "callbacks_on_environment_created": null, "callbacks_on_episode_created": null, "callbacks_on_episode_start": null, "callbacks_on_episode_step": null, "callbacks_on_episode_end": null, "callbacks_on_evaluate_start": null, "callbacks_on_evaluate_end": null, "callbacks_on_evaluate_offline_start": null, "callbacks_on_evaluate_offline_end": null, "callbacks_on_sample_end": null, "callbacks_on_train_result": null, "explore": true, "enable_rl_module_and_learner": true, "enable_env_runner_and_connector_v2": true, "_prior_exploration_config": {"type": "StochasticSampling"}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x388285760>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "offline_data_class": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_read_batch_size": null, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "materialize_data": false, "materialize_mapped_data": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "ignore_final_observation": false, "prelearner_class": null, "prelearner_buffer_class": null, "prelearner_buffer_kwargs": {}, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_remaining_data": false, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": 1, "evaluation_duration": 20, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_auto_duration_min_env_steps_per_sample": 100, "evaluation_auto_duration_max_env_steps_per_sample": 2000, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 1, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "offline_evaluation_interval": null, "num_offline_eval_runners": 0, "offline_loss_for_module_fn": null, "offline_evaluation_duration": 1, "offline_evaluation_parallel_to_training": false, "offline_evaluation_timeout_s": 120.0, "num_cpus_per_offline_eval_runner": 1, "num_gpus_per_offline_eval_runner": 0, "custom_resources_per_offline_eval_runner": {}, "restart_failed_offline_eval_runners": true, "ignore_offline_eval_runner_failures": false, "max_num_offline_eval_runner_restarts": 1000, "offline_eval_runner_restore_timeout_s": 1800.0, "max_requests_in_flight_per_offline_eval_runner": 1, "validate_offline_eval_runners_after_construction": true, "offline_eval_runner_health_probe_timeout_s": 30.0, "offline_eval_rl_module_inference_only": false, "broadcast_offline_eval_runner_states": false, "offline_eval_batch_size_per_runner": 256, "dataset_num_iters_per_eval_runner": 1, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "log_gradients": false, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 2, "restart_failed_env_runners": true, "ignore_env_runner_failures": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30.0, "env_runner_restore_timeout_s": 1800.0, "_model_config": {}, "_rl_module_spec": "MultiRLModuleSpec(multi_rl_module_class=<class 'ray.rllib.core.rl_module.multi_rl_module.MultiRLModule'>, observation_space=None, action_space=None, inference_only=False, model_config=None, rl_module_specs={'default_policy': RLModuleSpec(module_class=<class 'source.intrinsic_attention_ppo.rl_modules.DifferentiablePPOModule.DifferentiablePPOModule'>, observation_space=None, action_space=None, inference_only=False, learner_only=False, model_config={'vf_share_layers': True, 'embedding_dim': 62, 'max_seq_len': 3, 'policy_head_hidden_sizes': [32], 'value_head_hidden_sizes': [101], 'embedding_hidden_sizes': [121]}, catalog_class=None, load_state_path=None, model_config_dict=None), 'intrinsic_reward_module': RLModuleSpec(module_class=<class 'source.intrinsic_attention_ppo.rl_modules.IntrinsicAttentionModule.IntrinsicAttentionModule'>, observation_space=None, action_space=None, inference_only=False, learner_only=True, model_config={'intrinsic_reward_network': {'encoder_hidden_sizes': [], 'encoding_dim': 1, 'num_heads': 1, 'head_hidden_sizes': None, 'layers': [{'type': 'attention'}]}, 'extrinsic_value_hidden_layers': [127, 60], 'vf_share_layers': True, 'max_seq_len': 3}, catalog_class=None, load_state_path=None, model_config_dict=None)}, load_state_path=None, modules_to_load=None, module_specs={'default_policy': RLModuleSpec(module_class=<class 'source.intrinsic_attention_ppo.rl_modules.DifferentiablePPOModule.DifferentiablePPOModule'>, observation_space=None, action_space=None, inference_only=False, learner_only=False, model_config={'vf_share_layers': True, 'embedding_dim': 62, 'max_seq_len': 3, 'policy_head_hidden_sizes': [32], 'value_head_hidden_sizes': [101], 'embedding_hidden_sizes': [121]}, catalog_class=None, load_state_path=None, model_config_dict=None), 'intrinsic_reward_module': RLModuleSpec(module_class=<class 'source.intrinsic_attention_ppo.rl_modules.IntrinsicAttentionModule.IntrinsicAttentionModule'>, observation_space=None, action_space=None, inference_only=False, learner_only=True, model_config={'intrinsic_reward_network': {'encoder_hidden_sizes': [], 'encoding_dim': 1, 'num_heads': 1, 'head_hidden_sizes': None, 'layers': [{'type': 'attention'}]}, 'extrinsic_value_hidden_layers': [127, 60], 'vf_share_layers': True, 'max_seq_len': 3}, catalog_class=None, load_state_path=None, model_config_dict=None)})", "algorithm_config_overrides_per_module": {"intrinsic_reward_module": {"lr": 0.0002715581955}}, "_per_module_overrides": {}, "_validate_config": true, "_use_msgpack_checkpoints": false, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "env_task_fn": -1, "enable_connectors": -1, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.161583927863, "kl_target": 0.0201019014258, "vf_loss_coeff": 0.7790510010087, "entropy_coeff": 0.0015431216992, "clip_param": 0.2459212356676, "vf_clip_param": 0.3769744131561, "entropy_coeff_schedule": null, "lr_schedule": null, "sgd_minibatch_size": -1, "vf_share_layers": -1, "differentiable_learner_configs": ["DifferentiableLearnerConfig(learner_class=<class 'source.intrinsic_attention_ppo.learners.IntrinsicAttentionPPOLearner.IntrinsicAttentionPPOLearner'>, learner_connector=None, add_default_connectors_to_learner_pipeline=True, is_multi_agent=False, policies_to_update=['default_policy'], lr=0.0060984166342, num_total_minibatches=0, num_epochs=1, minibatch_size=1000, shuffle_batch_per_epoch=True)"], "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9485408017724, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.callbacks.callbacks.RLlibCallback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 157.5207486152649, "iterations_since_restore": 14, "perf": {"cpu_util_percent": 51.39411764705883, "ram_util_percent": 81.88823529411764}}
{"timers": {"training_iteration": 11.579131148744839, "restore_env_runners": 9.102941083308127e-06, "training_step": 11.578926370692484, "env_runner_sampling_timer": 1.6973035189274501, "learner_update_timer": 9.666575961162645, "synch_weights": 0.0015888672954017084, "restore_eval_env_runners": 5.415517724369109e-05, "evaluation_iteration": 0.13322554179375432, "synch_eval_env_connectors": 0.00018200347370280718, "synch_env_connectors": 7.106443548567354e-06}, "env_runners": {"module_to_env_connector": {"connector_pipeline_timer": 0.00012694865605684935, "timers": {"connectors": {"remove_single_ts_time_rank_from_batch": 1.2643265004618241e-05, "normalize_and_clip_actions": 8.518404761005356e-06, "get_actions": 4.3729185625335884e-05, "tensor_to_numpy": 1.6158287569529075e-05, "un_batch_to_individual_items": 6.980677634420264e-06, "listify_data_for_vector_env": 1.1215567455035286e-05}}}, "num_agent_steps_sampled_lifetime": {"default_agent": -8017500.0}, "sample": 0.007326636886143694, "episode_len_mean": 20.0, "num_module_steps_sampled": {"default_policy": 5000.0}, "env_to_module_connector": {"connector_pipeline_timer": 6.31896167235293e-05, "timers": {"connectors": {"add_observations_from_episodes_to_batch": 2.9496668480296194e-06, "batch_individual_items": 1.3224099196085291e-05, "numpy_to_tensor": 1.3814996676257491e-05, "add_time_dim_to_batch_and_zero_pad": 7.379594635608533e-06, "add_states_from_episodes_to_batch": 2.9043100829804942e-06}}}, "num_env_steps_sampled_lifetime": -8017500.0, "episode_return_mean": -1.5, "episode_len_min": 20, "env_step_timer": 1.5120294589373977e-05, "num_module_steps_sampled_lifetime": {"default_policy": -8017500.0}, "env_to_module_sum_episodes_length_in": 10.36823839457432, "episode_len_max": 20, "module_episode_returns_mean": {"default_policy": -1.5}, "time_between_sampling": 0.037790427160445686, "num_agent_steps_sampled": {"default_agent": 5000.0}, "episode_duration_sec_mean": 0.006186477183364331, "num_env_steps_sampled": 5000.0, "weights_seq_no": 14.0, "num_episodes": 250.0, "episode_return_max": 8.5, "agent_episode_returns_mean": {"default_agent": -1.5}, "num_episodes_lifetime": -400875.0, "env_reset_timer": 5.8762184887214145e-05, "env_to_module_sum_episodes_length_out": 10.36823839457432, "rlmodule_inference_timer": 6.196404335379166e-05, "episode_return_min": -11.5, "num_env_steps_sampled_lifetime_throughput": 2979.5927836715837}, "__all_modules__": {"learner_connector_sum_episodes_length_in": 5000.0, "learner_connector": {"connector_pipeline_timer": 0.17479278979674434, "timers": {"connectors": {"add_one_ts_to_episodes_and_truncate": 0.009022957339378811, "add_observations_from_episodes_to_batch": 0.0008670846259636888, "add_columns_from_episodes_to_train_batch": 0.04129125852124314, "add_time_dim_to_batch_and_zero_pad": 0.10346131972974561, "add_states_from_episodes_to_batch": 0.0035665101185115154, "batch_individual_items": 0.01633013818755173, "numpy_to_tensor": 8.608992229444895e-05}}}, "learner_connector_sum_episodes_length_out": 5250.0}, "learners": {"differentiable_learners": {"intrinsic_attention_ppo_learner": {"intrinsic_reward_module": {"module_train_batch_size_mean": 999.0, "num_module_steps_trained_lifetime": 539460, "diff_num_grad_updates_vs_sampler_policy": 76.0, "num_module_steps_trained": 35964, "weights_seq_no": 90.0, "total_loss": 0.0}, "default_policy": {"num_module_steps_trained": 35964, "use_intrinsic_rewards": 1.0, "weights_seq_no": 90.0, "module_train_batch_size_mean": 999.0, "vf_loss": 0.2628454566001892, "entropy": 0.6900515556335449, "diff_num_grad_updates_vs_sampler_policy": 76.0, "policy_loss": -1.4737577657797374e-05, "num_module_steps_trained_lifetime": 539460, "vf_loss_unclipped": 39.55903244018555, "vf_explained_var": -0.002418041229248047, "mean_kl_loss": 8.757011528359726e-06, "total_loss": 0.20369184017181396}, "__all_modules__": {"num_env_steps_trained": 189000, "num_module_steps_trained_lifetime": 1078920, "num_env_steps_trained_lifetime": 2835000, "num_module_steps_trained": 71928, "num_env_steps_trained_lifetime_throughput": 38520.360898600455}}}, "IntrinsicAttentionMask": [[[0.32126981019973755, 0.34327831864356995, 0.33545181155204773], [0.3225327134132385, 0.3422276973724365, 0.33523961901664734], [0.3220928907394409, 0.34259334206581116, 0.3353137671947479]], [[0.338888943195343, 0.31991490721702576, 0.3411961495876312], [0.3474372923374176, 0.29891616106033325, 0.35364651679992676], [0.33784952759742737, 0.3224382996559143, 0.3397121727466583]], [[0.361887127161026, 0.31425514817237854, 0.32385772466659546], [0.3811963200569153, 0.3016851246356964, 0.3171185255050659], [0.37704604864120483, 0.3043655455112457, 0.31858840584754944]], [[0.30942925810813904, 0.3197488784790039, 0.3708218038082123], [0.31251800060272217, 0.32158026099205017, 0.36590179800987244], [0.3264269232749939, 0.3295484483242035, 0.34402453899383545]], [[0.2900654077529907, 0.3581656515598297, 0.3517689108848572], [0.31344977021217346, 0.34466761350631714, 0.3418826460838318], [0.31141188740730286, 0.34583643078804016, 0.342751681804657]], [[0.16816209256649017, 0.6531587243080139, 0.17867924273014069], [0.6090625524520874, 2.9990414986968972e-05, 0.39090749621391296], [0.22804926335811615, 0.535038948059082, 0.23691174387931824]]], "default_policy": {"entropy": 0.6900541186332703, "diff_num_grad_updates_vs_sampler_policy": 1.0, "policy_loss": -1.664367300691083e-05, "num_module_steps_trained_lifetime": 89910, "vf_loss_unclipped": 39.49235916137695, "vf_explained_var": 0.0003840327262878418, "module_train_batch_size_mean": 999.0, "num_trainable_parameters": 16595, "total_loss": 0.20366665720939636, "num_module_steps_trained": 5994, "use_intrinsic_rewards": 0.0, "weights_seq_no": 15.0, "curr_entropy_coeff": 0.0015431216992, "mean_kl_loss": 8.638427061669063e-06, "curr_kl_coeff": 4.931150215270463e-06, "vf_loss": 0.2628173828125, "num_module_steps_trained_lifetime_throughput": 584.7984823202089}, "intrinsic_reward_module": {"diff_num_grad_updates_vs_sampler_policy": 1.0, "gradients_default_optimizer_global_norm": 0.0, "num_trainable_parameters": 8266, "weights_seq_no": 15.0, "default_optimizer_learning_rate": 0.0002715581955, "total_loss": 0.0, "num_module_steps_trained": 5994, "module_train_batch_size_mean": 999.0, "curr_entropy_coeff": 0.0015431216992, "num_module_steps_trained_lifetime": 89910, "num_module_steps_trained_lifetime_throughput": 584.8002976604264}, "__all_modules__": {"num_non_trainable_parameters": 0, "num_module_steps_trained_lifetime": 179820, "num_env_steps_trained_lifetime": 472500, "num_trainable_parameters": 24861, "num_env_steps_trained": 31500, "num_module_steps_trained": 11988, "num_env_steps_trained_lifetime_throughput": 3073.3452254395897, "num_module_steps_trained_throughput": 14622687.919355977, "num_module_steps_trained_lifetime_throughput": 10382174.329760231}}, "num_training_step_calls_per_iteration": 1, "evaluation": {"env_runners": {"env_to_module_connector": {"timers": {"connectors": {"numpy_to_tensor": 1.2133085369628005e-05, "add_states_from_episodes_to_batch": 2.713809429811492e-06, "batch_individual_items": 1.2213112703123804e-05, "add_time_dim_to_batch_and_zero_pad": 6.715899005739961e-06, "add_observations_from_episodes_to_batch": 2.7135567605740054e-06}}, "connector_pipeline_timer": 5.815098590263805e-05}, "module_to_env_connector": {"timers": {"connectors": {"tensor_to_numpy": 1.5548105666081134e-05, "un_batch_to_individual_items": 6.50288750523184e-06, "listify_data_for_vector_env": 1.0212777285486445e-05, "remove_single_ts_time_rank_from_batch": 1.1696082791081482e-05, "normalize_and_clip_actions": 7.923999489879296e-06, "get_actions": 3.7113950741920015e-05}}, "connector_pipeline_timer": 0.00011482714137896784}, "module_episode_returns_mean": {"default_policy": 0.2}, "env_reset_timer": 0.0005539908321688272, "episode_len_mean": 20.0, "num_env_steps_sampled_lifetime": 75400, "num_module_steps_sampled": {"default_policy": 400}, "episode_len_max": 20, "episode_return_max": 14.5, "num_env_steps_sampled": 400, "num_module_steps_sampled_lifetime": {"default_policy": 6000}, "agent_episode_returns_mean": {"default_agent": 0.2}, "episode_return_min": -14.5, "sample": 0.1214592916596221, "num_agent_steps_sampled_lifetime": {"default_agent": 6000}, "env_step_timer": 1.3988691993295092e-05, "weights_seq_no": 15.0, "rlmodule_inference_timer": 3.1612282293715986e-05, "num_agent_steps_sampled": {"default_agent": 400}, "episode_duration_sec_mean": 0.005388767573749647, "num_episodes": 20, "num_episodes_lifetime": 300, "env_to_module_sum_episodes_length_out": 10.368238394574323, "episode_return_mean": 0.2, "episode_len_min": 20, "env_to_module_sum_episodes_length_in": 10.368238394574323, "time_between_sampling": 11.476619777762009}, "num_healthy_workers": 1, "actor_manager_num_outstanding_async_reqs": 0, "num_remote_worker_restarts": 0}, "num_env_steps_sampled_lifetime": -8017500.0, "fault_tolerance": {"num_healthy_workers": 0, "num_remote_worker_restarts": 0}, "env_runner_group": {"actor_manager_num_outstanding_async_reqs": 0}, "done": false, "training_iteration": 15, "trial_id": "aea65_00000", "date": "2025-08-11_18-21-03", "timestamp": 1754929263, "time_this_iter_s": 11.569092750549316, "time_total_s": 169.0898413658142, "pid": 10689, "hostname": "Mac", "node_ip": "127.0.0.1", "config": {"exploration_config": {}, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 2, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "env": "Umbrella", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": false, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 0, "create_local_env_runner": true, "num_envs_per_env_runner": 1, "gym_env_vectorize_mode": "SYNC", "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "episodes_to_numpy": true, "max_requests_in_flight_per_env_runner": 1, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "merge_env_runner_states": "training_only", "broadcast_env_runner_states": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "complete_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "sampler_perf_stats_ema_coef": null, "_is_online": true, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": "auto", "num_aggregator_actors_per_learner": 0, "max_requests_in_flight_per_aggregator_actor": 3, "local_gpu_idx": 0, "max_requests_in_flight_per_learner": 3, "gamma": 1, "lr": 0.0002715581955, "grad_clip": 0.5, "grad_clip_by": "global_norm", "_train_batch_size_per_learner": 5000, "train_batch_size": 4000, "num_epochs": 1, "minibatch_size": 1000, "shuffle_batch_per_epoch": true, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "log_std_clip_param": 20.0, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "_disable_preprocessor_api": false, "_disable_action_flattening": false}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {"intrinsic_reward_coeff": 0.2795015916508}, "optimizer": {}, "_learner_class": "<class 'source.intrinsic_attention_ppo.learners.IntrinsicAttentionMetaLearner.IntrinsicAttentionMetaLearner'>", "callbacks_on_algorithm_init": null, "callbacks_on_env_runners_recreated": null, "callbacks_on_offline_eval_runners_recreated": null, "callbacks_on_checkpoint_loaded": null, "callbacks_on_environment_created": null, "callbacks_on_episode_created": null, "callbacks_on_episode_start": null, "callbacks_on_episode_step": null, "callbacks_on_episode_end": null, "callbacks_on_evaluate_start": null, "callbacks_on_evaluate_end": null, "callbacks_on_evaluate_offline_start": null, "callbacks_on_evaluate_offline_end": null, "callbacks_on_sample_end": null, "callbacks_on_train_result": null, "explore": true, "enable_rl_module_and_learner": true, "enable_env_runner_and_connector_v2": true, "_prior_exploration_config": {"type": "StochasticSampling"}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x388285760>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "offline_data_class": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_read_batch_size": null, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "materialize_data": false, "materialize_mapped_data": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "ignore_final_observation": false, "prelearner_class": null, "prelearner_buffer_class": null, "prelearner_buffer_kwargs": {}, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_remaining_data": false, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": 1, "evaluation_duration": 20, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_auto_duration_min_env_steps_per_sample": 100, "evaluation_auto_duration_max_env_steps_per_sample": 2000, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 1, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "offline_evaluation_interval": null, "num_offline_eval_runners": 0, "offline_loss_for_module_fn": null, "offline_evaluation_duration": 1, "offline_evaluation_parallel_to_training": false, "offline_evaluation_timeout_s": 120.0, "num_cpus_per_offline_eval_runner": 1, "num_gpus_per_offline_eval_runner": 0, "custom_resources_per_offline_eval_runner": {}, "restart_failed_offline_eval_runners": true, "ignore_offline_eval_runner_failures": false, "max_num_offline_eval_runner_restarts": 1000, "offline_eval_runner_restore_timeout_s": 1800.0, "max_requests_in_flight_per_offline_eval_runner": 1, "validate_offline_eval_runners_after_construction": true, "offline_eval_runner_health_probe_timeout_s": 30.0, "offline_eval_rl_module_inference_only": false, "broadcast_offline_eval_runner_states": false, "offline_eval_batch_size_per_runner": 256, "dataset_num_iters_per_eval_runner": 1, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "log_gradients": false, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 2, "restart_failed_env_runners": true, "ignore_env_runner_failures": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30.0, "env_runner_restore_timeout_s": 1800.0, "_model_config": {}, "_rl_module_spec": "MultiRLModuleSpec(multi_rl_module_class=<class 'ray.rllib.core.rl_module.multi_rl_module.MultiRLModule'>, observation_space=None, action_space=None, inference_only=False, model_config=None, rl_module_specs={'default_policy': RLModuleSpec(module_class=<class 'source.intrinsic_attention_ppo.rl_modules.DifferentiablePPOModule.DifferentiablePPOModule'>, observation_space=None, action_space=None, inference_only=False, learner_only=False, model_config={'vf_share_layers': True, 'embedding_dim': 62, 'max_seq_len': 3, 'policy_head_hidden_sizes': [32], 'value_head_hidden_sizes': [101], 'embedding_hidden_sizes': [121]}, catalog_class=None, load_state_path=None, model_config_dict=None), 'intrinsic_reward_module': RLModuleSpec(module_class=<class 'source.intrinsic_attention_ppo.rl_modules.IntrinsicAttentionModule.IntrinsicAttentionModule'>, observation_space=None, action_space=None, inference_only=False, learner_only=True, model_config={'intrinsic_reward_network': {'encoder_hidden_sizes': [], 'encoding_dim': 1, 'num_heads': 1, 'head_hidden_sizes': None, 'layers': [{'type': 'attention'}]}, 'extrinsic_value_hidden_layers': [127, 60], 'vf_share_layers': True, 'max_seq_len': 3}, catalog_class=None, load_state_path=None, model_config_dict=None)}, load_state_path=None, modules_to_load=None, module_specs={'default_policy': RLModuleSpec(module_class=<class 'source.intrinsic_attention_ppo.rl_modules.DifferentiablePPOModule.DifferentiablePPOModule'>, observation_space=None, action_space=None, inference_only=False, learner_only=False, model_config={'vf_share_layers': True, 'embedding_dim': 62, 'max_seq_len': 3, 'policy_head_hidden_sizes': [32], 'value_head_hidden_sizes': [101], 'embedding_hidden_sizes': [121]}, catalog_class=None, load_state_path=None, model_config_dict=None), 'intrinsic_reward_module': RLModuleSpec(module_class=<class 'source.intrinsic_attention_ppo.rl_modules.IntrinsicAttentionModule.IntrinsicAttentionModule'>, observation_space=None, action_space=None, inference_only=False, learner_only=True, model_config={'intrinsic_reward_network': {'encoder_hidden_sizes': [], 'encoding_dim': 1, 'num_heads': 1, 'head_hidden_sizes': None, 'layers': [{'type': 'attention'}]}, 'extrinsic_value_hidden_layers': [127, 60], 'vf_share_layers': True, 'max_seq_len': 3}, catalog_class=None, load_state_path=None, model_config_dict=None)})", "algorithm_config_overrides_per_module": {"intrinsic_reward_module": {"lr": 0.0002715581955}}, "_per_module_overrides": {}, "_validate_config": true, "_use_msgpack_checkpoints": false, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "env_task_fn": -1, "enable_connectors": -1, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.161583927863, "kl_target": 0.0201019014258, "vf_loss_coeff": 0.7790510010087, "entropy_coeff": 0.0015431216992, "clip_param": 0.2459212356676, "vf_clip_param": 0.3769744131561, "entropy_coeff_schedule": null, "lr_schedule": null, "sgd_minibatch_size": -1, "vf_share_layers": -1, "differentiable_learner_configs": ["DifferentiableLearnerConfig(learner_class=<class 'source.intrinsic_attention_ppo.learners.IntrinsicAttentionPPOLearner.IntrinsicAttentionPPOLearner'>, learner_connector=None, add_default_connectors_to_learner_pipeline=True, is_multi_agent=False, policies_to_update=['default_policy'], lr=0.0060984166342, num_total_minibatches=0, num_epochs=1, minibatch_size=1000, shuffle_batch_per_epoch=True)"], "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9485408017724, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.callbacks.callbacks.RLlibCallback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 169.0898413658142, "iterations_since_restore": 15, "perf": {"cpu_util_percent": 51.449999999999996, "ram_util_percent": 82.825}}
{"timers": {"training_iteration": 11.576716938087356, "restore_env_runners": 9.178582324581451e-06, "training_step": 11.576511542825502, "env_runner_sampling_timer": 1.6971189912379077, "learner_update_timer": 9.664229818631055, "synch_weights": 0.0015873523721750746, "restore_eval_env_runners": 5.419904552843172e-05, "evaluation_iteration": 0.1331895651263407, "synch_eval_env_connectors": 0.0001827930187896903, "synch_env_connectors": 7.119539241690027e-06}, "env_runners": {"module_to_env_connector": {"connector_pipeline_timer": 0.00012884463294717067, "timers": {"connectors": {"remove_single_ts_time_rank_from_batch": 1.266691137617237e-05, "normalize_and_clip_actions": 8.542096110047977e-06, "get_actions": 4.4396081404371484e-05, "tensor_to_numpy": 1.6617514826655265e-05, "un_batch_to_individual_items": 7.066124226741238e-06, "listify_data_for_vector_env": 1.1273383166916492e-05}}}, "num_agent_steps_sampled_lifetime": {"default_agent": -8635000.0}, "sample": 0.006482573098283452, "episode_len_mean": 20.0, "num_module_steps_sampled": {"default_policy": 5000.0}, "env_to_module_connector": {"connector_pipeline_timer": 6.398219924916578e-05, "timers": {"connectors": {"add_observations_from_episodes_to_batch": 2.9649695209660986e-06, "batch_individual_items": 1.3406577284175824e-05, "numpy_to_tensor": 1.4053953962268257e-05, "add_time_dim_to_batch_and_zero_pad": 7.433445763430476e-06, "add_states_from_episodes_to_batch": 2.938754286684105e-06}}}, "num_env_steps_sampled_lifetime": -8635000.0, "episode_return_mean": -1.1800000000000002, "episode_len_min": 20, "env_step_timer": 1.5557079699473086e-05, "num_module_steps_sampled_lifetime": {"default_policy": -8635000.0}, "env_to_module_sum_episodes_length_in": 10.36823839457432, "episode_len_max": 20, "module_episode_returns_mean": {"default_policy": -1.1800000000000002}, "time_between_sampling": 0.0395593099174586, "num_agent_steps_sampled": {"default_agent": 5000.0}, "episode_duration_sec_mean": 0.005743658677674829, "num_env_steps_sampled": 5000.0, "weights_seq_no": 15.0, "num_episodes": 250.0, "episode_return_max": 8.5, "agent_episode_returns_mean": {"default_agent": -1.1800000000000002}, "num_episodes_lifetime": -431750.0, "env_reset_timer": 4.8759459662541623e-05, "env_to_module_sum_episodes_length_out": 10.36823839457432, "rlmodule_inference_timer": 3.517969452468604e-05, "episode_return_min": -11.5, "num_env_steps_sampled_lifetime_throughput": 3023.025677401037}, "__all_modules__": {"learner_connector_sum_episodes_length_in": 5000.0, "learner_connector": {"connector_pipeline_timer": 0.17481323023933995, "timers": {"connectors": {"add_one_ts_to_episodes_and_truncate": 0.009021838175593135, "add_observations_from_episodes_to_batch": 0.0008676296088995066, "add_columns_from_episodes_to_train_batch": 0.0413069796852829, "add_time_dim_to_batch_and_zero_pad": 0.10346459362279958, "add_states_from_episodes_to_batch": 0.003576171268164516, "batch_individual_items": 0.016321048055577193, "numpy_to_tensor": 8.764694253032588e-05}}}, "learner_connector_sum_episodes_length_out": 5250.0}, "learners": {"differentiable_learners": {"intrinsic_attention_ppo_learner": {"intrinsic_reward_module": {"module_train_batch_size_mean": 999.0, "num_module_steps_trained_lifetime": 575424, "diff_num_grad_updates_vs_sampler_policy": 81.0, "num_module_steps_trained": 35964, "weights_seq_no": 96.0, "total_loss": 0.0}, "default_policy": {"num_module_steps_trained": 35964, "use_intrinsic_rewards": 1.0, "weights_seq_no": 96.0, "module_train_batch_size_mean": 999.0, "vf_loss": 0.26284149289131165, "entropy": 0.6893248558044434, "diff_num_grad_updates_vs_sampler_policy": 81.0, "policy_loss": -0.00029123920830897987, "num_module_steps_trained_lifetime": 575424, "vf_loss_unclipped": 39.272186279296875, "vf_explained_var": -0.0023790597915649414, "mean_kl_loss": 3.623227166826837e-05, "total_loss": 0.2034178078174591}, "__all_modules__": {"num_env_steps_trained": 189000, "num_module_steps_trained_lifetime": 1150848, "num_env_steps_trained_lifetime": 3024000, "num_module_steps_trained": 71928, "num_env_steps_trained_lifetime_throughput": 37955.8707698506}}}, "IntrinsicAttentionMask": [[[0.3283258378505707, 0.3333081305027008, 0.3383660316467285], [0.32843253016471863, 0.33330920338630676, 0.3382582664489746], [0.3285392224788666, 0.33331024646759033, 0.3381505012512207]], [[0.3389216959476471, 0.3135682940483093, 0.3475100100040436], [0.343257337808609, 0.2971894145011902, 0.3595532774925232], [0.3374408483505249, 0.3189377188682556, 0.34362146258354187]], [[0.36121639609336853, 0.3181995451450348, 0.3205840587615967], [0.3822447955608368, 0.3068806827068329, 0.31087449193000793], [0.38099348545074463, 0.3075520694255829, 0.3114543855190277]], [[0.3162587285041809, 0.3114772439002991, 0.37226402759552], [0.3152734935283661, 0.3102441430091858, 0.3744823634624481], [0.3265688121318817, 0.32455915212631226, 0.34887200593948364]], [[0.29307910799980164, 0.35149720311164856, 0.3554237484931946], [0.3118027448654175, 0.34309300780296326, 0.3451042175292969], [0.3129681646823883, 0.3425672650337219, 0.34446457028388977]], [[0.14572365581989288, 0.6915818452835083, 0.16269445419311523], [0.675405740737915, 2.1413568902062252e-05, 0.3245728313922882], [0.24422453343868256, 0.498893141746521, 0.25688233971595764]]], "default_policy": {"entropy": 0.6893087029457092, "diff_num_grad_updates_vs_sampler_policy": 1.0, "policy_loss": -0.00029751480906270444, "num_module_steps_trained_lifetime": 95904, "vf_loss_unclipped": 39.22507095336914, "vf_explained_var": -0.00024771690368652344, "module_train_batch_size_mean": 999.0, "num_trainable_parameters": 16595, "total_loss": 0.20338809490203857, "num_module_steps_trained": 5994, "use_intrinsic_rewards": 0.0, "weights_seq_no": 16.0, "curr_entropy_coeff": 0.0015431216992, "mean_kl_loss": 3.7842361052753404e-05, "curr_kl_coeff": 2.4655751076352317e-06, "vf_loss": 0.2628188729286194, "num_module_steps_trained_lifetime_throughput": 585.7242786452406}, "intrinsic_reward_module": {"diff_num_grad_updates_vs_sampler_policy": 1.0, "gradients_default_optimizer_global_norm": 0.0, "num_trainable_parameters": 8266, "weights_seq_no": 16.0, "default_optimizer_learning_rate": 0.0002715581955, "total_loss": 0.0, "num_module_steps_trained": 5994, "module_train_batch_size_mean": 999.0, "curr_entropy_coeff": 0.0015431216992, "num_module_steps_trained_lifetime": 95904, "num_module_steps_trained_lifetime_throughput": 585.7257292612834}, "__all_modules__": {"num_non_trainable_parameters": 0, "num_module_steps_trained_lifetime": 191808, "num_env_steps_trained_lifetime": 504000, "num_trainable_parameters": 24861, "num_env_steps_trained": 31500, "num_module_steps_trained": 11988, "num_env_steps_trained_lifetime_throughput": 3078.206640872587, "num_module_steps_trained_throughput": 14459899.473222561, "num_module_steps_trained_lifetime_throughput": 10458481.313670391}}, "num_training_step_calls_per_iteration": 1, "evaluation": {"env_runners": {"env_to_module_connector": {"timers": {"connectors": {"numpy_to_tensor": 1.2587377900663292e-05, "add_states_from_episodes_to_batch": 2.6525921576510935e-06, "batch_individual_items": 1.2596371527687522e-05, "add_time_dim_to_batch_and_zero_pad": 6.855736631813499e-06, "add_observations_from_episodes_to_batch": 2.7621988877885003e-06}}, "connector_pipeline_timer": 5.9311183400692496e-05}, "module_to_env_connector": {"timers": {"connectors": {"tensor_to_numpy": 1.562513333869887e-05, "un_batch_to_individual_items": 6.59677377065901e-06, "listify_data_for_vector_env": 1.0467016754327079e-05, "remove_single_ts_time_rank_from_batch": 1.1910412847704266e-05, "normalize_and_clip_actions": 8.035754591773671e-06, "get_actions": 3.8147079502785986e-05}}, "connector_pipeline_timer": 0.00011676905229848947}, "module_episode_returns_mean": {"default_policy": 1.0}, "env_reset_timer": 0.0005515550941658318, "episode_len_mean": 20.0, "num_env_steps_sampled_lifetime": 80400, "num_module_steps_sampled": {"default_policy": 400}, "episode_len_max": 20, "episode_return_max": 14.5, "num_env_steps_sampled": 400, "num_module_steps_sampled_lifetime": {"default_policy": 6400}, "agent_episode_returns_mean": {"default_agent": 1.0}, "episode_return_min": -14.5, "sample": 0.12139406833301031, "num_agent_steps_sampled_lifetime": {"default_agent": 6400}, "env_step_timer": 1.4303744978863948e-05, "weights_seq_no": 16.0, "rlmodule_inference_timer": 3.224993576697787e-05, "num_agent_steps_sampled": {"default_agent": 400}, "episode_duration_sec_mean": 0.005383939667372033, "num_episodes": 20, "num_episodes_lifetime": 320, "env_to_module_sum_episodes_length_out": 10.368238394574323, "episode_return_mean": 1.0, "episode_len_min": 20, "env_to_module_sum_episodes_length_in": 10.368238394574323, "time_between_sampling": 11.47551432748406}, "num_healthy_workers": 1, "actor_manager_num_outstanding_async_reqs": 0, "num_remote_worker_restarts": 0}, "num_env_steps_sampled_lifetime": -8635000.0, "fault_tolerance": {"num_healthy_workers": 0, "num_remote_worker_restarts": 0}, "env_runner_group": {"actor_manager_num_outstanding_async_reqs": 0}, "done": false, "training_iteration": 16, "trial_id": "aea65_00000", "date": "2025-08-11_18-21-14", "timestamp": 1754929274, "time_this_iter_s": 11.468231916427612, "time_total_s": 180.55807328224182, "pid": 10689, "hostname": "Mac", "node_ip": "127.0.0.1", "config": {"exploration_config": {}, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 2, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "env": "Umbrella", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": false, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 0, "create_local_env_runner": true, "num_envs_per_env_runner": 1, "gym_env_vectorize_mode": "SYNC", "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "episodes_to_numpy": true, "max_requests_in_flight_per_env_runner": 1, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "merge_env_runner_states": "training_only", "broadcast_env_runner_states": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "complete_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "sampler_perf_stats_ema_coef": null, "_is_online": true, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": "auto", "num_aggregator_actors_per_learner": 0, "max_requests_in_flight_per_aggregator_actor": 3, "local_gpu_idx": 0, "max_requests_in_flight_per_learner": 3, "gamma": 1, "lr": 0.0002715581955, "grad_clip": 0.5, "grad_clip_by": "global_norm", "_train_batch_size_per_learner": 5000, "train_batch_size": 4000, "num_epochs": 1, "minibatch_size": 1000, "shuffle_batch_per_epoch": true, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "log_std_clip_param": 20.0, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "_disable_preprocessor_api": false, "_disable_action_flattening": false}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {"intrinsic_reward_coeff": 0.2795015916508}, "optimizer": {}, "_learner_class": "<class 'source.intrinsic_attention_ppo.learners.IntrinsicAttentionMetaLearner.IntrinsicAttentionMetaLearner'>", "callbacks_on_algorithm_init": null, "callbacks_on_env_runners_recreated": null, "callbacks_on_offline_eval_runners_recreated": null, "callbacks_on_checkpoint_loaded": null, "callbacks_on_environment_created": null, "callbacks_on_episode_created": null, "callbacks_on_episode_start": null, "callbacks_on_episode_step": null, "callbacks_on_episode_end": null, "callbacks_on_evaluate_start": null, "callbacks_on_evaluate_end": null, "callbacks_on_evaluate_offline_start": null, "callbacks_on_evaluate_offline_end": null, "callbacks_on_sample_end": null, "callbacks_on_train_result": null, "explore": true, "enable_rl_module_and_learner": true, "enable_env_runner_and_connector_v2": true, "_prior_exploration_config": {"type": "StochasticSampling"}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x388285760>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "offline_data_class": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_read_batch_size": null, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "materialize_data": false, "materialize_mapped_data": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "ignore_final_observation": false, "prelearner_class": null, "prelearner_buffer_class": null, "prelearner_buffer_kwargs": {}, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_remaining_data": false, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": 1, "evaluation_duration": 20, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_auto_duration_min_env_steps_per_sample": 100, "evaluation_auto_duration_max_env_steps_per_sample": 2000, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 1, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "offline_evaluation_interval": null, "num_offline_eval_runners": 0, "offline_loss_for_module_fn": null, "offline_evaluation_duration": 1, "offline_evaluation_parallel_to_training": false, "offline_evaluation_timeout_s": 120.0, "num_cpus_per_offline_eval_runner": 1, "num_gpus_per_offline_eval_runner": 0, "custom_resources_per_offline_eval_runner": {}, "restart_failed_offline_eval_runners": true, "ignore_offline_eval_runner_failures": false, "max_num_offline_eval_runner_restarts": 1000, "offline_eval_runner_restore_timeout_s": 1800.0, "max_requests_in_flight_per_offline_eval_runner": 1, "validate_offline_eval_runners_after_construction": true, "offline_eval_runner_health_probe_timeout_s": 30.0, "offline_eval_rl_module_inference_only": false, "broadcast_offline_eval_runner_states": false, "offline_eval_batch_size_per_runner": 256, "dataset_num_iters_per_eval_runner": 1, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "log_gradients": false, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 2, "restart_failed_env_runners": true, "ignore_env_runner_failures": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30.0, "env_runner_restore_timeout_s": 1800.0, "_model_config": {}, "_rl_module_spec": "MultiRLModuleSpec(multi_rl_module_class=<class 'ray.rllib.core.rl_module.multi_rl_module.MultiRLModule'>, observation_space=None, action_space=None, inference_only=False, model_config=None, rl_module_specs={'default_policy': RLModuleSpec(module_class=<class 'source.intrinsic_attention_ppo.rl_modules.DifferentiablePPOModule.DifferentiablePPOModule'>, observation_space=None, action_space=None, inference_only=False, learner_only=False, model_config={'vf_share_layers': True, 'embedding_dim': 62, 'max_seq_len': 3, 'policy_head_hidden_sizes': [32], 'value_head_hidden_sizes': [101], 'embedding_hidden_sizes': [121]}, catalog_class=None, load_state_path=None, model_config_dict=None), 'intrinsic_reward_module': RLModuleSpec(module_class=<class 'source.intrinsic_attention_ppo.rl_modules.IntrinsicAttentionModule.IntrinsicAttentionModule'>, observation_space=None, action_space=None, inference_only=False, learner_only=True, model_config={'intrinsic_reward_network': {'encoder_hidden_sizes': [], 'encoding_dim': 1, 'num_heads': 1, 'head_hidden_sizes': None, 'layers': [{'type': 'attention'}]}, 'extrinsic_value_hidden_layers': [127, 60], 'vf_share_layers': True, 'max_seq_len': 3}, catalog_class=None, load_state_path=None, model_config_dict=None)}, load_state_path=None, modules_to_load=None, module_specs={'default_policy': RLModuleSpec(module_class=<class 'source.intrinsic_attention_ppo.rl_modules.DifferentiablePPOModule.DifferentiablePPOModule'>, observation_space=None, action_space=None, inference_only=False, learner_only=False, model_config={'vf_share_layers': True, 'embedding_dim': 62, 'max_seq_len': 3, 'policy_head_hidden_sizes': [32], 'value_head_hidden_sizes': [101], 'embedding_hidden_sizes': [121]}, catalog_class=None, load_state_path=None, model_config_dict=None), 'intrinsic_reward_module': RLModuleSpec(module_class=<class 'source.intrinsic_attention_ppo.rl_modules.IntrinsicAttentionModule.IntrinsicAttentionModule'>, observation_space=None, action_space=None, inference_only=False, learner_only=True, model_config={'intrinsic_reward_network': {'encoder_hidden_sizes': [], 'encoding_dim': 1, 'num_heads': 1, 'head_hidden_sizes': None, 'layers': [{'type': 'attention'}]}, 'extrinsic_value_hidden_layers': [127, 60], 'vf_share_layers': True, 'max_seq_len': 3}, catalog_class=None, load_state_path=None, model_config_dict=None)})", "algorithm_config_overrides_per_module": {"intrinsic_reward_module": {"lr": 0.0002715581955}}, "_per_module_overrides": {}, "_validate_config": true, "_use_msgpack_checkpoints": false, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "env_task_fn": -1, "enable_connectors": -1, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.161583927863, "kl_target": 0.0201019014258, "vf_loss_coeff": 0.7790510010087, "entropy_coeff": 0.0015431216992, "clip_param": 0.2459212356676, "vf_clip_param": 0.3769744131561, "entropy_coeff_schedule": null, "lr_schedule": null, "sgd_minibatch_size": -1, "vf_share_layers": -1, "differentiable_learner_configs": ["DifferentiableLearnerConfig(learner_class=<class 'source.intrinsic_attention_ppo.learners.IntrinsicAttentionPPOLearner.IntrinsicAttentionPPOLearner'>, learner_connector=None, add_default_connectors_to_learner_pipeline=True, is_multi_agent=False, policies_to_update=['default_policy'], lr=0.0060984166342, num_total_minibatches=0, num_epochs=1, minibatch_size=1000, shuffle_batch_per_epoch=True)"], "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9485408017724, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.callbacks.callbacks.RLlibCallback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 180.55807328224182, "iterations_since_restore": 16, "perf": {"cpu_util_percent": 47.4375, "ram_util_percent": 82.8}}
{"timers": {"training_iteration": 11.569076235375393, "restore_env_runners": 9.295965730828182e-06, "training_step": 11.56886811864679, "env_runner_sampling_timer": 1.6975380550754375, "learner_update_timer": 9.655992570854236, "synch_weights": 0.001611755507873084, "restore_eval_env_runners": 5.4114555646395076e-05, "evaluation_iteration": 0.13309511447493788, "synch_eval_env_connectors": 0.00018364467827194488, "synch_env_connectors": 7.142093107940358e-06}, "env_runners": {"module_to_env_connector": {"connector_pipeline_timer": 0.00013218337302147603, "timers": {"connectors": {"remove_single_ts_time_rank_from_batch": 1.2977193876323954e-05, "normalize_and_clip_actions": 8.787442097131177e-06, "get_actions": 4.621518857705838e-05, "tensor_to_numpy": 1.6945118548253257e-05, "un_batch_to_individual_items": 7.119359217013765e-06, "listify_data_for_vector_env": 1.1546902894737792e-05}}}, "num_agent_steps_sampled_lifetime": {"default_agent": -9252500.0}, "sample": 0.00639493099228859, "episode_len_mean": 20.0, "num_module_steps_sampled": {"default_policy": 5000.0}, "env_to_module_connector": {"connector_pipeline_timer": 6.66463131323962e-05, "timers": {"connectors": {"add_observations_from_episodes_to_batch": 3.0879759116844385e-06, "batch_individual_items": 1.371302961857448e-05, "numpy_to_tensor": 1.528175397558087e-05, "add_time_dim_to_batch_and_zero_pad": 7.819501798773738e-06, "add_states_from_episodes_to_batch": 3.012092996069973e-06}}}, "num_env_steps_sampled_lifetime": -9252500.0, "episode_return_mean": -0.9399999999999996, "episode_len_min": 20, "env_step_timer": 1.572112710986886e-05, "num_module_steps_sampled_lifetime": {"default_policy": -9252500.0}, "env_to_module_sum_episodes_length_in": 10.36823839457432, "episode_len_max": 20, "module_episode_returns_mean": {"default_policy": -0.9399999999999996}, "time_between_sampling": 0.03978936766818263, "num_agent_steps_sampled": {"default_agent": 5000.0}, "episode_duration_sec_mean": 0.005918789190240207, "num_env_steps_sampled": 5000.0, "weights_seq_no": 16.0, "num_episodes": 250.0, "episode_return_max": 8.5, "agent_episode_returns_mean": {"default_agent": -0.9399999999999996}, "num_episodes_lifetime": -462625.0, "env_reset_timer": 5.555359976610435e-05, "env_to_module_sum_episodes_length_out": 10.36823839457432, "rlmodule_inference_timer": 3.6455733947352325e-05, "episode_return_min": -11.5, "num_env_steps_sampled_lifetime_throughput": 2942.317616103068}, "__all_modules__": {"learner_connector_sum_episodes_length_in": 5000.0, "learner_connector": {"connector_pipeline_timer": 0.17484742001705394, "timers": {"connectors": {"add_one_ts_to_episodes_and_truncate": 0.00902496604477918, "add_observations_from_episodes_to_batch": 0.0008674683124553423, "add_columns_from_episodes_to_train_batch": 0.04133797154793939, "add_time_dim_to_batch_and_zero_pad": 0.1034904314367603, "add_states_from_episodes_to_batch": 0.0035790012160420485, "batch_individual_items": 0.016292100074653735, "numpy_to_tensor": 8.838922233426005e-05}}}, "learner_connector_sum_episodes_length_out": 5250.0}, "learners": {"differentiable_learners": {"intrinsic_attention_ppo_learner": {"intrinsic_reward_module": {"module_train_batch_size_mean": 999.0, "num_module_steps_trained_lifetime": 611388, "diff_num_grad_updates_vs_sampler_policy": 86.0, "num_module_steps_trained": 35964, "weights_seq_no": 102.0, "total_loss": 0.0}, "default_policy": {"num_module_steps_trained": 35964, "use_intrinsic_rewards": 1.0, "weights_seq_no": 102.0, "module_train_batch_size_mean": 999.0, "vf_loss": 0.26283642649650574, "entropy": 0.6887383460998535, "diff_num_grad_updates_vs_sampler_policy": 86.0, "policy_loss": -0.0001749054790707305, "num_module_steps_trained_lifetime": 611388, "vf_loss_unclipped": 37.88269805908203, "vf_explained_var": -0.0023277997970581055, "mean_kl_loss": 1.1137594810861629e-05, "total_loss": 0.2035270482301712}, "__all_modules__": {"num_env_steps_trained": 189000, "num_module_steps_trained_lifetime": 1222776, "num_env_steps_trained_lifetime": 3213000, "num_module_steps_trained": 71928, "num_env_steps_trained_lifetime_throughput": 37427.02528140992}}}, "IntrinsicAttentionMask": [[[0.3172277808189392, 0.33895939588546753, 0.34381285309791565], [0.3189072906970978, 0.3383809030056, 0.34271180629730225], [0.31926825642585754, 0.338256299495697, 0.34247541427612305]], [[0.338888943195343, 0.31991493701934814, 0.3411961495876312], [0.34743732213974, 0.29891613125801086, 0.35364654660224915], [0.33784952759742737, 0.3224383294582367, 0.3397121727466583]], [[0.36054232716560364, 0.3187235891819, 0.32073408365249634], [0.3887649476528168, 0.3036927580833435, 0.3075423240661621], [0.38730546832084656, 0.30446720123291016, 0.30822739005088806]], [[0.31335049867630005, 0.30861300230026245, 0.3780365288257599], [0.3121946156024933, 0.3072143793106079, 0.3805909752845764], [0.32720622420310974, 0.32563796639442444, 0.34715574979782104]], [[0.2824062407016754, 0.35659265518188477, 0.36100107431411743], [0.3071364760398865, 0.34536147117614746, 0.34750205278396606], [0.3084721863269806, 0.3447512984275818, 0.3467765152454376]], [[0.42806604504585266, 0.1023283377289772, 0.4696056544780731], [0.3333030641078949, 7.421845566568663e-06, 0.6666895747184753], [0.40143337845802307, 0.17496873438358307, 0.42359793186187744]]], "default_policy": {"entropy": 0.6887230277061462, "diff_num_grad_updates_vs_sampler_policy": 1.0, "policy_loss": -0.0001818354066926986, "num_module_steps_trained_lifetime": 101898, "vf_loss_unclipped": 37.80691909790039, "vf_explained_var": -0.00017213821411132812, "module_train_batch_size_mean": 999.0, "num_trainable_parameters": 16595, "total_loss": 0.20350442826747894, "num_module_steps_trained": 5994, "use_intrinsic_rewards": 0.0, "weights_seq_no": 17.0, "curr_entropy_coeff": 0.0015431216992, "mean_kl_loss": 1.1926197657885496e-05, "curr_kl_coeff": 1.2327875538176158e-06, "vf_loss": 0.2628185451030731, "num_module_steps_trained_lifetime_throughput": 586.8100011094824}, "intrinsic_reward_module": {"diff_num_grad_updates_vs_sampler_policy": 1.0, "gradients_default_optimizer_global_norm": 0.0, "num_trainable_parameters": 8266, "weights_seq_no": 17.0, "default_optimizer_learning_rate": 0.0002715581955, "total_loss": 0.0, "num_module_steps_trained": 5994, "module_train_batch_size_mean": 999.0, "curr_entropy_coeff": 0.0015431216992, "num_module_steps_trained_lifetime": 101898, "num_module_steps_trained_lifetime_throughput": 586.8111886841652}, "__all_modules__": {"num_non_trainable_parameters": 0, "num_module_steps_trained_lifetime": 203796, "num_env_steps_trained_lifetime": 535500, "num_trainable_parameters": 24861, "num_env_steps_trained": 31500, "num_module_steps_trained": 11988, "num_env_steps_trained_lifetime_throughput": 3083.908621729233, "num_module_steps_trained_throughput": 14315430.195606925, "num_module_steps_trained_lifetime_throughput": 10537039.560888086}}, "num_training_step_calls_per_iteration": 1, "evaluation": {"env_runners": {"env_to_module_connector": {"timers": {"connectors": {"numpy_to_tensor": 4.196033532280475e-05, "add_states_from_episodes_to_batch": 7.0994774891050765e-06, "batch_individual_items": 3.081765388181259e-05, "add_time_dim_to_batch_and_zero_pad": 1.9007044438619023e-05, "add_observations_from_episodes_to_batch": 7.66054263159504e-06}}, "connector_pipeline_timer": 0.0001544085196290509}, "module_to_env_connector": {"timers": {"connectors": {"tensor_to_numpy": 4.8880829784086447e-05, "un_batch_to_individual_items": 1.5834771960026008e-05, "listify_data_for_vector_env": 3.350896469187449e-05, "remove_single_ts_time_rank_from_batch": 3.033388580067777e-05, "normalize_and_clip_actions": 2.610366165214384e-05, "get_actions": 0.00014256055176150217}}, "connector_pipeline_timer": 0.0003595805170279045}, "module_episode_returns_mean": {"default_policy": 0.8}, "env_reset_timer": 0.0005501453835681556, "episode_len_mean": 20.0, "num_env_steps_sampled_lifetime": 85400, "num_module_steps_sampled": {"default_policy": 400}, "episode_len_max": 20, "episode_return_max": 14.5, "num_env_steps_sampled": 400, "num_module_steps_sampled_lifetime": {"default_policy": 6800}, "agent_episode_returns_mean": {"default_agent": 0.8}, "episode_return_min": -14.5, "sample": 0.123055748479553, "num_agent_steps_sampled_lifetime": {"default_agent": 6800}, "env_step_timer": 5.4060376389155955e-05, "weights_seq_no": 17.0, "rlmodule_inference_timer": 0.00010641760984401541, "num_agent_steps_sampled": {"default_agent": 400}, "episode_duration_sec_mean": 0.0069523121288511906, "num_episodes": 20, "num_episodes_lifetime": 340, "env_to_module_sum_episodes_length_out": 10.368238394574323, "episode_return_mean": 0.8, "episode_len_min": 20, "env_to_module_sum_episodes_length_in": 10.368238394574323, "time_between_sampling": 11.469241630458328}, "num_healthy_workers": 1, "actor_manager_num_outstanding_async_reqs": 0, "num_remote_worker_restarts": 0}, "num_env_steps_sampled_lifetime": -9252500.0, "fault_tolerance": {"num_healthy_workers": 0, "num_remote_worker_restarts": 0}, "env_runner_group": {"actor_manager_num_outstanding_async_reqs": 0}, "done": false, "training_iteration": 17, "trial_id": "aea65_00000", "date": "2025-08-11_18-21-25", "timestamp": 1754929285, "time_this_iter_s": 11.128246784210205, "time_total_s": 191.68632006645203, "pid": 10689, "hostname": "Mac", "node_ip": "127.0.0.1", "config": {"exploration_config": {}, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 2, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "env": "Umbrella", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": false, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 0, "create_local_env_runner": true, "num_envs_per_env_runner": 1, "gym_env_vectorize_mode": "SYNC", "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "episodes_to_numpy": true, "max_requests_in_flight_per_env_runner": 1, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "merge_env_runner_states": "training_only", "broadcast_env_runner_states": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "complete_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "sampler_perf_stats_ema_coef": null, "_is_online": true, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": "auto", "num_aggregator_actors_per_learner": 0, "max_requests_in_flight_per_aggregator_actor": 3, "local_gpu_idx": 0, "max_requests_in_flight_per_learner": 3, "gamma": 1, "lr": 0.0002715581955, "grad_clip": 0.5, "grad_clip_by": "global_norm", "_train_batch_size_per_learner": 5000, "train_batch_size": 4000, "num_epochs": 1, "minibatch_size": 1000, "shuffle_batch_per_epoch": true, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "log_std_clip_param": 20.0, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "_disable_preprocessor_api": false, "_disable_action_flattening": false}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {"intrinsic_reward_coeff": 0.2795015916508}, "optimizer": {}, "_learner_class": "<class 'source.intrinsic_attention_ppo.learners.IntrinsicAttentionMetaLearner.IntrinsicAttentionMetaLearner'>", "callbacks_on_algorithm_init": null, "callbacks_on_env_runners_recreated": null, "callbacks_on_offline_eval_runners_recreated": null, "callbacks_on_checkpoint_loaded": null, "callbacks_on_environment_created": null, "callbacks_on_episode_created": null, "callbacks_on_episode_start": null, "callbacks_on_episode_step": null, "callbacks_on_episode_end": null, "callbacks_on_evaluate_start": null, "callbacks_on_evaluate_end": null, "callbacks_on_evaluate_offline_start": null, "callbacks_on_evaluate_offline_end": null, "callbacks_on_sample_end": null, "callbacks_on_train_result": null, "explore": true, "enable_rl_module_and_learner": true, "enable_env_runner_and_connector_v2": true, "_prior_exploration_config": {"type": "StochasticSampling"}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x388285760>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "offline_data_class": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_read_batch_size": null, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "materialize_data": false, "materialize_mapped_data": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "ignore_final_observation": false, "prelearner_class": null, "prelearner_buffer_class": null, "prelearner_buffer_kwargs": {}, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_remaining_data": false, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": 1, "evaluation_duration": 20, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_auto_duration_min_env_steps_per_sample": 100, "evaluation_auto_duration_max_env_steps_per_sample": 2000, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 1, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "offline_evaluation_interval": null, "num_offline_eval_runners": 0, "offline_loss_for_module_fn": null, "offline_evaluation_duration": 1, "offline_evaluation_parallel_to_training": false, "offline_evaluation_timeout_s": 120.0, "num_cpus_per_offline_eval_runner": 1, "num_gpus_per_offline_eval_runner": 0, "custom_resources_per_offline_eval_runner": {}, "restart_failed_offline_eval_runners": true, "ignore_offline_eval_runner_failures": false, "max_num_offline_eval_runner_restarts": 1000, "offline_eval_runner_restore_timeout_s": 1800.0, "max_requests_in_flight_per_offline_eval_runner": 1, "validate_offline_eval_runners_after_construction": true, "offline_eval_runner_health_probe_timeout_s": 30.0, "offline_eval_rl_module_inference_only": false, "broadcast_offline_eval_runner_states": false, "offline_eval_batch_size_per_runner": 256, "dataset_num_iters_per_eval_runner": 1, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "log_gradients": false, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 2, "restart_failed_env_runners": true, "ignore_env_runner_failures": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30.0, "env_runner_restore_timeout_s": 1800.0, "_model_config": {}, "_rl_module_spec": "MultiRLModuleSpec(multi_rl_module_class=<class 'ray.rllib.core.rl_module.multi_rl_module.MultiRLModule'>, observation_space=None, action_space=None, inference_only=False, model_config=None, rl_module_specs={'default_policy': RLModuleSpec(module_class=<class 'source.intrinsic_attention_ppo.rl_modules.DifferentiablePPOModule.DifferentiablePPOModule'>, observation_space=None, action_space=None, inference_only=False, learner_only=False, model_config={'vf_share_layers': True, 'embedding_dim': 62, 'max_seq_len': 3, 'policy_head_hidden_sizes': [32], 'value_head_hidden_sizes': [101], 'embedding_hidden_sizes': [121]}, catalog_class=None, load_state_path=None, model_config_dict=None), 'intrinsic_reward_module': RLModuleSpec(module_class=<class 'source.intrinsic_attention_ppo.rl_modules.IntrinsicAttentionModule.IntrinsicAttentionModule'>, observation_space=None, action_space=None, inference_only=False, learner_only=True, model_config={'intrinsic_reward_network': {'encoder_hidden_sizes': [], 'encoding_dim': 1, 'num_heads': 1, 'head_hidden_sizes': None, 'layers': [{'type': 'attention'}]}, 'extrinsic_value_hidden_layers': [127, 60], 'vf_share_layers': True, 'max_seq_len': 3}, catalog_class=None, load_state_path=None, model_config_dict=None)}, load_state_path=None, modules_to_load=None, module_specs={'default_policy': RLModuleSpec(module_class=<class 'source.intrinsic_attention_ppo.rl_modules.DifferentiablePPOModule.DifferentiablePPOModule'>, observation_space=None, action_space=None, inference_only=False, learner_only=False, model_config={'vf_share_layers': True, 'embedding_dim': 62, 'max_seq_len': 3, 'policy_head_hidden_sizes': [32], 'value_head_hidden_sizes': [101], 'embedding_hidden_sizes': [121]}, catalog_class=None, load_state_path=None, model_config_dict=None), 'intrinsic_reward_module': RLModuleSpec(module_class=<class 'source.intrinsic_attention_ppo.rl_modules.IntrinsicAttentionModule.IntrinsicAttentionModule'>, observation_space=None, action_space=None, inference_only=False, learner_only=True, model_config={'intrinsic_reward_network': {'encoder_hidden_sizes': [], 'encoding_dim': 1, 'num_heads': 1, 'head_hidden_sizes': None, 'layers': [{'type': 'attention'}]}, 'extrinsic_value_hidden_layers': [127, 60], 'vf_share_layers': True, 'max_seq_len': 3}, catalog_class=None, load_state_path=None, model_config_dict=None)})", "algorithm_config_overrides_per_module": {"intrinsic_reward_module": {"lr": 0.0002715581955}}, "_per_module_overrides": {}, "_validate_config": true, "_use_msgpack_checkpoints": false, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "env_task_fn": -1, "enable_connectors": -1, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.161583927863, "kl_target": 0.0201019014258, "vf_loss_coeff": 0.7790510010087, "entropy_coeff": 0.0015431216992, "clip_param": 0.2459212356676, "vf_clip_param": 0.3769744131561, "entropy_coeff_schedule": null, "lr_schedule": null, "sgd_minibatch_size": -1, "vf_share_layers": -1, "differentiable_learner_configs": ["DifferentiableLearnerConfig(learner_class=<class 'source.intrinsic_attention_ppo.learners.IntrinsicAttentionPPOLearner.IntrinsicAttentionPPOLearner'>, learner_connector=None, add_default_connectors_to_learner_pipeline=True, is_multi_agent=False, policies_to_update=['default_policy'], lr=0.0060984166342, num_total_minibatches=0, num_epochs=1, minibatch_size=1000, shuffle_batch_per_epoch=True)"], "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9485408017724, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.callbacks.callbacks.RLlibCallback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 191.68632006645203, "iterations_since_restore": 17, "perf": {"cpu_util_percent": 41.412499999999994, "ram_util_percent": 82.28750000000001}}
{"timers": {"training_iteration": 11.562431465930871, "restore_env_runners": 9.32258556379409e-06, "training_step": 11.562221635380238, "env_runner_sampling_timer": 1.7005033411951285, "learner_update_timer": 9.646068877235644, "synch_weights": 0.001610758782715569, "restore_eval_env_runners": 5.3730909542984e-05, "evaluation_iteration": 0.1348513820809224, "synch_eval_env_connectors": 0.00018370031225258034, "synch_env_connectors": 7.139002150007273e-06}, "env_runners": {"module_to_env_connector": {"connector_pipeline_timer": 0.00015313272125089394, "timers": {"connectors": {"remove_single_ts_time_rank_from_batch": 1.4324416194818555e-05, "normalize_and_clip_actions": 9.928369323959638e-06, "get_actions": 5.593233104537897e-05, "tensor_to_numpy": 1.9761279238989793e-05, "un_batch_to_individual_items": 8.056319491767547e-06, "listify_data_for_vector_env": 1.3021263857082958e-05}}}, "num_agent_steps_sampled_lifetime": {"default_agent": -9870000.0}, "sample": 0.007177295975646609, "episode_len_mean": 20.0, "num_module_steps_sampled": {"default_policy": 5000.0}, "env_to_module_connector": {"connector_pipeline_timer": 7.382369167665957e-05, "timers": {"connectors": {"add_observations_from_episodes_to_batch": 3.4637936506268457e-06, "batch_individual_items": 1.5372647157517165e-05, "numpy_to_tensor": 1.735474269327525e-05, "add_time_dim_to_batch_and_zero_pad": 8.645172456504222e-06, "add_states_from_episodes_to_batch": 3.26289294025538e-06}}}, "num_env_steps_sampled_lifetime": -9870000.0, "episode_return_mean": -2.379999999999999, "episode_len_min": 20, "env_step_timer": 1.8989788482964573e-05, "num_module_steps_sampled_lifetime": {"default_policy": -9870000.0}, "env_to_module_sum_episodes_length_in": 10.36823839457432, "episode_len_max": 20, "module_episode_returns_mean": {"default_policy": -2.379999999999999}, "time_between_sampling": 0.03867939586175055, "num_agent_steps_sampled": {"default_agent": 5000.0}, "episode_duration_sec_mean": 0.0068168131429702065, "num_env_steps_sampled": 5000.0, "weights_seq_no": 17.0, "num_episodes": 250.0, "episode_return_max": 8.5, "agent_episode_returns_mean": {"default_agent": -2.379999999999999}, "num_episodes_lifetime": -493500.0, "env_reset_timer": 6.07462472127786e-05, "env_to_module_sum_episodes_length_out": 10.36823839457432, "rlmodule_inference_timer": 4.3223087233004426e-05, "episode_return_min": -11.5, "num_env_steps_sampled_lifetime_throughput": 2786.4656412122918}, "__all_modules__": {"learner_connector_sum_episodes_length_in": 5000.0, "learner_connector": {"connector_pipeline_timer": 0.17495234414716024, "timers": {"connectors": {"add_one_ts_to_episodes_and_truncate": 0.009039695974145707, "add_observations_from_episodes_to_batch": 0.0008683636288598377, "add_columns_from_episodes_to_train_batch": 0.04138266974188489, "add_time_dim_to_batch_and_zero_pad": 0.1035422479524551, "add_states_from_episodes_to_batch": 0.0035923149537975853, "batch_individual_items": 0.016271031573125854, "numpy_to_tensor": 8.836700023433065e-05}}}, "learner_connector_sum_episodes_length_out": 5250.0}, "learners": {"differentiable_learners": {"intrinsic_attention_ppo_learner": {"intrinsic_reward_module": {"module_train_batch_size_mean": 999.0, "num_module_steps_trained_lifetime": 647352, "diff_num_grad_updates_vs_sampler_policy": 91.0, "num_module_steps_trained": 35964, "weights_seq_no": 108.0, "total_loss": 0.0}, "default_policy": {"num_module_steps_trained": 35964, "use_intrinsic_rewards": 1.0, "weights_seq_no": 108.0, "module_train_batch_size_mean": 999.0, "vf_loss": 0.26282334327697754, "entropy": 0.6877639889717102, "diff_num_grad_updates_vs_sampler_policy": 91.0, "policy_loss": -0.00026476496714167297, "num_module_steps_trained_lifetime": 647352, "vf_loss_unclipped": 38.142608642578125, "vf_explained_var": -0.0022852420806884766, "mean_kl_loss": 4.924099630443379e-05, "total_loss": 0.20343470573425293}, "__all_modules__": {"num_env_steps_trained": 189000, "num_module_steps_trained_lifetime": 1294704, "num_env_steps_trained_lifetime": 3402000, "num_module_steps_trained": 71928, "num_env_steps_trained_lifetime_throughput": 36927.147238533515}}}, "IntrinsicAttentionMask": [[[0.3172277510166168, 0.33895939588546753, 0.34381285309791565], [0.3189072906970978, 0.33838093280792236, 0.34271183609962463], [0.31926822662353516, 0.338256299495697, 0.34247541427612305]], [[0.338888943195343, 0.31991493701934814, 0.3411961495876312], [0.34743732213974, 0.2989161014556885, 0.35364654660224915], [0.337849497795105, 0.3224382996559143, 0.33971214294433594]], [[0.36190807819366455, 0.3211962878704071, 0.31689566373825073], [0.3782418370246887, 0.31413939595222473, 0.30761879682540894], [0.3801048994064331, 0.3133293092250824, 0.3065658509731293]], [[0.31335046887397766, 0.30861297249794006, 0.3780365288257599], [0.3121945858001709, 0.3072143495082855, 0.3805910050868988], [0.32720619440078735, 0.32563796639442444, 0.34715574979782104]], [[0.2755838632583618, 0.35359621047973633, 0.37081998586654663], [0.3016902208328247, 0.34471434354782104, 0.35359546542167664], [0.3068253695964813, 0.3429108262062073, 0.350263774394989]], [[0.148384690284729, 0.6894280314445496, 0.16218730807304382], [0.6415985822677612, 2.7493359084473923e-05, 0.3583739995956421], [0.22595307230949402, 0.536492109298706, 0.23755480349063873]]], "default_policy": {"entropy": 0.6877498030662537, "diff_num_grad_updates_vs_sampler_policy": 1.0, "policy_loss": -0.0002694185241125524, "num_module_steps_trained_lifetime": 107892, "vf_loss_unclipped": 38.04947280883789, "vf_explained_var": 0.0006440877914428711, "module_train_batch_size_mean": 999.0, "num_trainable_parameters": 16595, "total_loss": 0.20342767238616943, "num_module_steps_trained": 5994, "use_intrinsic_rewards": 0.0, "weights_seq_no": 18.0, "curr_entropy_coeff": 0.0015431216992, "mean_kl_loss": 5.0622376875253394e-05, "curr_kl_coeff": 6.163937769088079e-07, "vf_loss": 0.2628304958343506, "num_module_steps_trained_lifetime_throughput": 588.083554243012}, "intrinsic_reward_module": {"diff_num_grad_updates_vs_sampler_policy": 1.0, "gradients_default_optimizer_global_norm": 0.0, "num_trainable_parameters": 8266, "weights_seq_no": 18.0, "default_optimizer_learning_rate": 0.0002715581955, "total_loss": 0.0, "num_module_steps_trained": 5994, "module_train_batch_size_mean": 999.0, "curr_entropy_coeff": 0.0015431216992, "num_module_steps_trained_lifetime": 107892, "num_module_steps_trained_lifetime_throughput": 588.0845168663332}, "__all_modules__": {"num_non_trainable_parameters": 0, "num_module_steps_trained_lifetime": 215784, "num_env_steps_trained_lifetime": 567000, "num_trainable_parameters": 24861, "num_env_steps_trained": 31500, "num_module_steps_trained": 11988, "num_env_steps_trained_lifetime_throughput": 3090.5978663695396, "num_module_steps_trained_throughput": 14192817.15247228, "num_module_steps_trained_lifetime_throughput": 10622547.578370282}}, "num_training_step_calls_per_iteration": 1, "evaluation": {"env_runners": {"env_to_module_connector": {"timers": {"connectors": {"numpy_to_tensor": 1.235788474282402e-05, "add_states_from_episodes_to_batch": 2.6957185835334898e-06, "batch_individual_items": 1.2504165172112284e-05, "add_time_dim_to_batch_and_zero_pad": 6.924328280584674e-06, "add_observations_from_episodes_to_batch": 2.7884860557165268e-06}}, "connector_pipeline_timer": 5.923179354975749e-05}, "module_to_env_connector": {"timers": {"connectors": {"tensor_to_numpy": 1.5383180359595387e-05, "un_batch_to_individual_items": 6.556559940363473e-06, "listify_data_for_vector_env": 1.0541605471910998e-05, "remove_single_ts_time_rank_from_batch": 1.1843900110882801e-05, "normalize_and_clip_actions": 8.045365062878229e-06, "get_actions": 3.759931089387371e-05}}, "connector_pipeline_timer": 0.0001157863413455665}, "module_episode_returns_mean": {"default_policy": -0.4}, "env_reset_timer": 0.000547708520005899, "episode_len_mean": 20.0, "num_env_steps_sampled_lifetime": 90400, "num_module_steps_sampled": {"default_policy": 400}, "episode_len_max": 20, "episode_return_max": 14.5, "num_env_steps_sampled": 400, "num_module_steps_sampled_lifetime": {"default_policy": 7200}, "agent_episode_returns_mean": {"default_agent": -0.4}, "episode_return_min": -14.5, "sample": 0.12295549933482824, "num_agent_steps_sampled_lifetime": {"default_agent": 7200}, "env_step_timer": 1.4317652407502359e-05, "weights_seq_no": 18.0, "rlmodule_inference_timer": 3.187181811647414e-05, "num_agent_steps_sampled": {"default_agent": 400}, "episode_duration_sec_mean": 0.006949102139333263, "num_episodes": 20, "num_episodes_lifetime": 360, "env_to_module_sum_episodes_length_out": 10.368238394574323, "episode_return_mean": -0.4, "episode_len_min": 20, "env_to_module_sum_episodes_length_in": 10.368238394574323, "time_between_sampling": 11.464765547904612}, "num_healthy_workers": 1, "actor_manager_num_outstanding_async_reqs": 0, "num_remote_worker_restarts": 0}, "num_env_steps_sampled_lifetime": -9870000.0, "fault_tolerance": {"num_healthy_workers": 0, "num_remote_worker_restarts": 0}, "env_runner_group": {"actor_manager_num_outstanding_async_reqs": 0}, "done": false, "training_iteration": 18, "trial_id": "aea65_00000", "date": "2025-08-11_18-21-36", "timestamp": 1754929296, "time_this_iter_s": 11.030533790588379, "time_total_s": 202.7168538570404, "pid": 10689, "hostname": "Mac", "node_ip": "127.0.0.1", "config": {"exploration_config": {}, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 2, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "env": "Umbrella", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": false, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 0, "create_local_env_runner": true, "num_envs_per_env_runner": 1, "gym_env_vectorize_mode": "SYNC", "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "episodes_to_numpy": true, "max_requests_in_flight_per_env_runner": 1, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "merge_env_runner_states": "training_only", "broadcast_env_runner_states": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "complete_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "sampler_perf_stats_ema_coef": null, "_is_online": true, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": "auto", "num_aggregator_actors_per_learner": 0, "max_requests_in_flight_per_aggregator_actor": 3, "local_gpu_idx": 0, "max_requests_in_flight_per_learner": 3, "gamma": 1, "lr": 0.0002715581955, "grad_clip": 0.5, "grad_clip_by": "global_norm", "_train_batch_size_per_learner": 5000, "train_batch_size": 4000, "num_epochs": 1, "minibatch_size": 1000, "shuffle_batch_per_epoch": true, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "log_std_clip_param": 20.0, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "_disable_preprocessor_api": false, "_disable_action_flattening": false}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {"intrinsic_reward_coeff": 0.2795015916508}, "optimizer": {}, "_learner_class": "<class 'source.intrinsic_attention_ppo.learners.IntrinsicAttentionMetaLearner.IntrinsicAttentionMetaLearner'>", "callbacks_on_algorithm_init": null, "callbacks_on_env_runners_recreated": null, "callbacks_on_offline_eval_runners_recreated": null, "callbacks_on_checkpoint_loaded": null, "callbacks_on_environment_created": null, "callbacks_on_episode_created": null, "callbacks_on_episode_start": null, "callbacks_on_episode_step": null, "callbacks_on_episode_end": null, "callbacks_on_evaluate_start": null, "callbacks_on_evaluate_end": null, "callbacks_on_evaluate_offline_start": null, "callbacks_on_evaluate_offline_end": null, "callbacks_on_sample_end": null, "callbacks_on_train_result": null, "explore": true, "enable_rl_module_and_learner": true, "enable_env_runner_and_connector_v2": true, "_prior_exploration_config": {"type": "StochasticSampling"}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x388285760>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "offline_data_class": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_read_batch_size": null, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "materialize_data": false, "materialize_mapped_data": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "ignore_final_observation": false, "prelearner_class": null, "prelearner_buffer_class": null, "prelearner_buffer_kwargs": {}, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_remaining_data": false, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": 1, "evaluation_duration": 20, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_auto_duration_min_env_steps_per_sample": 100, "evaluation_auto_duration_max_env_steps_per_sample": 2000, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 1, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "offline_evaluation_interval": null, "num_offline_eval_runners": 0, "offline_loss_for_module_fn": null, "offline_evaluation_duration": 1, "offline_evaluation_parallel_to_training": false, "offline_evaluation_timeout_s": 120.0, "num_cpus_per_offline_eval_runner": 1, "num_gpus_per_offline_eval_runner": 0, "custom_resources_per_offline_eval_runner": {}, "restart_failed_offline_eval_runners": true, "ignore_offline_eval_runner_failures": false, "max_num_offline_eval_runner_restarts": 1000, "offline_eval_runner_restore_timeout_s": 1800.0, "max_requests_in_flight_per_offline_eval_runner": 1, "validate_offline_eval_runners_after_construction": true, "offline_eval_runner_health_probe_timeout_s": 30.0, "offline_eval_rl_module_inference_only": false, "broadcast_offline_eval_runner_states": false, "offline_eval_batch_size_per_runner": 256, "dataset_num_iters_per_eval_runner": 1, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "log_gradients": false, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 2, "restart_failed_env_runners": true, "ignore_env_runner_failures": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30.0, "env_runner_restore_timeout_s": 1800.0, "_model_config": {}, "_rl_module_spec": "MultiRLModuleSpec(multi_rl_module_class=<class 'ray.rllib.core.rl_module.multi_rl_module.MultiRLModule'>, observation_space=None, action_space=None, inference_only=False, model_config=None, rl_module_specs={'default_policy': RLModuleSpec(module_class=<class 'source.intrinsic_attention_ppo.rl_modules.DifferentiablePPOModule.DifferentiablePPOModule'>, observation_space=None, action_space=None, inference_only=False, learner_only=False, model_config={'vf_share_layers': True, 'embedding_dim': 62, 'max_seq_len': 3, 'policy_head_hidden_sizes': [32], 'value_head_hidden_sizes': [101], 'embedding_hidden_sizes': [121]}, catalog_class=None, load_state_path=None, model_config_dict=None), 'intrinsic_reward_module': RLModuleSpec(module_class=<class 'source.intrinsic_attention_ppo.rl_modules.IntrinsicAttentionModule.IntrinsicAttentionModule'>, observation_space=None, action_space=None, inference_only=False, learner_only=True, model_config={'intrinsic_reward_network': {'encoder_hidden_sizes': [], 'encoding_dim': 1, 'num_heads': 1, 'head_hidden_sizes': None, 'layers': [{'type': 'attention'}]}, 'extrinsic_value_hidden_layers': [127, 60], 'vf_share_layers': True, 'max_seq_len': 3}, catalog_class=None, load_state_path=None, model_config_dict=None)}, load_state_path=None, modules_to_load=None, module_specs={'default_policy': RLModuleSpec(module_class=<class 'source.intrinsic_attention_ppo.rl_modules.DifferentiablePPOModule.DifferentiablePPOModule'>, observation_space=None, action_space=None, inference_only=False, learner_only=False, model_config={'vf_share_layers': True, 'embedding_dim': 62, 'max_seq_len': 3, 'policy_head_hidden_sizes': [32], 'value_head_hidden_sizes': [101], 'embedding_hidden_sizes': [121]}, catalog_class=None, load_state_path=None, model_config_dict=None), 'intrinsic_reward_module': RLModuleSpec(module_class=<class 'source.intrinsic_attention_ppo.rl_modules.IntrinsicAttentionModule.IntrinsicAttentionModule'>, observation_space=None, action_space=None, inference_only=False, learner_only=True, model_config={'intrinsic_reward_network': {'encoder_hidden_sizes': [], 'encoding_dim': 1, 'num_heads': 1, 'head_hidden_sizes': None, 'layers': [{'type': 'attention'}]}, 'extrinsic_value_hidden_layers': [127, 60], 'vf_share_layers': True, 'max_seq_len': 3}, catalog_class=None, load_state_path=None, model_config_dict=None)})", "algorithm_config_overrides_per_module": {"intrinsic_reward_module": {"lr": 0.0002715581955}}, "_per_module_overrides": {}, "_validate_config": true, "_use_msgpack_checkpoints": false, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "env_task_fn": -1, "enable_connectors": -1, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.161583927863, "kl_target": 0.0201019014258, "vf_loss_coeff": 0.7790510010087, "entropy_coeff": 0.0015431216992, "clip_param": 0.2459212356676, "vf_clip_param": 0.3769744131561, "entropy_coeff_schedule": null, "lr_schedule": null, "sgd_minibatch_size": -1, "vf_share_layers": -1, "differentiable_learner_configs": ["DifferentiableLearnerConfig(learner_class=<class 'source.intrinsic_attention_ppo.learners.IntrinsicAttentionPPOLearner.IntrinsicAttentionPPOLearner'>, learner_connector=None, add_default_connectors_to_learner_pipeline=True, is_multi_agent=False, policies_to_update=['default_policy'], lr=0.0060984166342, num_total_minibatches=0, num_epochs=1, minibatch_size=1000, shuffle_batch_per_epoch=True)"], "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9485408017724, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.callbacks.callbacks.RLlibCallback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 202.7168538570404, "iterations_since_restore": 18, "perf": {"cpu_util_percent": 47.7875, "ram_util_percent": 82.18125}}
{"timers": {"training_iteration": 11.557412877111995, "restore_env_runners": 9.321859830420177e-06, "training_step": 11.55720298319616, "env_runner_sampling_timer": 1.7010559036128894, "learner_update_timer": 9.640435639713802, "synch_weights": 0.0016085699446436617, "restore_eval_env_runners": 5.3761519789401465e-05, "evaluation_iteration": 0.13472118076039072, "synch_eval_env_connectors": 0.00018350788975505215, "synch_env_connectors": 7.167191466491523e-06}, "env_runners": {"module_to_env_connector": {"connector_pipeline_timer": 0.0001246633228263354, "timers": {"connectors": {"remove_single_ts_time_rank_from_batch": 1.2334383635476982e-05, "normalize_and_clip_actions": 8.336654622094048e-06, "get_actions": 4.2692180981158544e-05, "tensor_to_numpy": 1.598911429113213e-05, "un_batch_to_individual_items": 6.871032734655428e-06, "listify_data_for_vector_env": 1.113796229020809e-05}}}, "num_agent_steps_sampled_lifetime": {"default_agent": -10487500.0}, "sample": 0.006646411513476785, "episode_len_mean": 20.0, "num_module_steps_sampled": {"default_policy": 5000.0}, "env_to_module_connector": {"connector_pipeline_timer": 6.237813644919e-05, "timers": {"connectors": {"add_observations_from_episodes_to_batch": 2.9318507480283704e-06, "batch_individual_items": 1.307896145731221e-05, "numpy_to_tensor": 1.3464715501702058e-05, "add_time_dim_to_batch_and_zero_pad": 7.296433035976995e-06, "add_states_from_episodes_to_batch": 2.8737412204574784e-06}}}, "num_env_steps_sampled_lifetime": -10487500.0, "episode_return_mean": -0.6199999999999999, "episode_len_min": 20, "env_step_timer": 1.4767740462439171e-05, "num_module_steps_sampled_lifetime": {"default_policy": -10487500.0}, "env_to_module_sum_episodes_length_in": 10.36823839457432, "episode_len_max": 20, "module_episode_returns_mean": {"default_policy": -0.6199999999999999}, "time_between_sampling": 0.03691572249664165, "num_agent_steps_sampled": {"default_agent": 5000.0}, "episode_duration_sec_mean": 0.006089281348511578, "num_env_steps_sampled": 5000.0, "weights_seq_no": 18.0, "num_episodes": 250.0, "episode_return_max": 8.5, "agent_episode_returns_mean": {"default_agent": -0.6199999999999999}, "num_episodes_lifetime": -524375.0, "env_reset_timer": 5.012770218572563e-05, "env_to_module_sum_episodes_length_out": 10.36823839457432, "rlmodule_inference_timer": 6.358990613884991e-05, "episode_return_min": -11.5, "num_env_steps_sampled_lifetime_throughput": 3060.737981558311}, "__all_modules__": {"learner_connector_sum_episodes_length_in": 5000.0, "learner_connector": {"connector_pipeline_timer": 0.17494291403584283, "timers": {"connectors": {"add_one_ts_to_episodes_and_truncate": 0.009034732765050438, "add_observations_from_episodes_to_batch": 0.0008679566621126131, "add_columns_from_episodes_to_train_batch": 0.04140688721461657, "add_time_dim_to_batch_and_zero_pad": 0.10354966214346151, "add_states_from_episodes_to_batch": 0.0035934838841337373, "batch_individual_items": 0.016234960006310462, "numpy_to_tensor": 8.816333075322997e-05}}}, "learner_connector_sum_episodes_length_out": 5250.0}, "learners": {"differentiable_learners": {"intrinsic_attention_ppo_learner": {"intrinsic_reward_module": {"module_train_batch_size_mean": 999.0, "num_module_steps_trained_lifetime": 683316, "diff_num_grad_updates_vs_sampler_policy": 96.0, "num_module_steps_trained": 35964, "weights_seq_no": 114.0, "total_loss": 0.0}, "default_policy": {"num_module_steps_trained": 35964, "use_intrinsic_rewards": 1.0, "weights_seq_no": 114.0, "module_train_batch_size_mean": 999.0, "vf_loss": 0.2628352642059326, "entropy": 0.6871817708015442, "diff_num_grad_updates_vs_sampler_policy": 96.0, "policy_loss": -7.324339094338939e-05, "num_module_steps_trained_lifetime": 683316, "vf_loss_unclipped": 38.14149856567383, "vf_explained_var": -0.0022499561309814453, "mean_kl_loss": 1.5195904779830016e-05, "total_loss": 0.20363087952136993}, "__all_modules__": {"num_env_steps_trained": 189000, "num_module_steps_trained_lifetime": 1366632, "num_env_steps_trained_lifetime": 3591000, "num_module_steps_trained": 71928, "num_env_steps_trained_lifetime_throughput": 36441.11350849167}}}, "IntrinsicAttentionMask": [[[0.32535696029663086, 0.3349236845970154, 0.33971935510635376], [0.32572296261787415, 0.33485254645347595, 0.3394245207309723], [0.3259025812149048, 0.3348175287246704, 0.3392798602581024]], [[0.34205862879753113, 0.31274181604385376, 0.3451995551586151], [0.35336604714393616, 0.2854956388473511, 0.36113831400871277], [0.3408565819263458, 0.31559938192367554, 0.343544065952301]], [[0.35564982891082764, 0.3210262358188629, 0.32332393527030945], [0.3704567849636078, 0.312921941280365, 0.31662124395370483], [0.3694175183773041, 0.31348925828933716, 0.31709325313568115]], [[0.3066958785057068, 0.3169243335723877, 0.3763797879219055], [0.3101450502872467, 0.3191385269165039, 0.3707163333892822], [0.32812368869781494, 0.33025065064430237, 0.3416256308555603]], [[0.2790864109992981, 0.358090341091156, 0.3628232181072235], [0.30364930629730225, 0.3469528257846832, 0.3493979275226593], [0.30497652292251587, 0.346347451210022, 0.34867608547210693]], [[0.1457231640815735, 0.691582977771759, 0.16269394755363464], [0.675406277179718, 2.1412708520074375e-05, 0.3245723247528076], [0.24422422051429749, 0.49889373779296875, 0.25688207149505615]]], "default_policy": {"entropy": 0.6871747970581055, "diff_num_grad_updates_vs_sampler_policy": 1.0, "policy_loss": -7.46352961868979e-05, "num_module_steps_trained_lifetime": 113886, "vf_loss_unclipped": 38.065086364746094, "vf_explained_var": 0.00013381242752075195, "module_train_batch_size_mean": 999.0, "num_trainable_parameters": 16595, "total_loss": 0.20361186563968658, "num_module_steps_trained": 5994, "use_intrinsic_rewards": 0.0, "weights_seq_no": 19.0, "curr_entropy_coeff": 0.0015431216992, "mean_kl_loss": 1.5543804693152197e-05, "curr_kl_coeff": 3.0819688845440396e-07, "vf_loss": 0.26281577348709106, "num_module_steps_trained_lifetime_throughput": 589.4611929263542}, "intrinsic_reward_module": {"diff_num_grad_updates_vs_sampler_policy": 1.0, "gradients_default_optimizer_global_norm": 0.0, "num_trainable_parameters": 8266, "weights_seq_no": 19.0, "default_optimizer_learning_rate": 0.0002715581955, "total_loss": 0.0, "num_module_steps_trained": 5994, "module_train_batch_size_mean": 999.0, "curr_entropy_coeff": 0.0015431216992, "num_module_steps_trained_lifetime": 113886, "num_module_steps_trained_lifetime_throughput": 589.4619099658324}, "__all_modules__": {"num_non_trainable_parameters": 0, "num_module_steps_trained_lifetime": 227772, "num_env_steps_trained_lifetime": 598500, "num_trainable_parameters": 24861, "num_env_steps_trained": 31500, "num_module_steps_trained": 11988, "num_env_steps_trained_lifetime_throughput": 3097.834975931052, "num_module_steps_trained_throughput": 14045377.583598701, "num_module_steps_trained_lifetime_throughput": 10671764.111186652}}, "num_training_step_calls_per_iteration": 1, "evaluation": {"env_runners": {"env_to_module_connector": {"timers": {"connectors": {"numpy_to_tensor": 1.205102488358717e-05, "add_states_from_episodes_to_batch": 2.6618079342289753e-06, "batch_individual_items": 1.2193756681613245e-05, "add_time_dim_to_batch_and_zero_pad": 6.632509029754567e-06, "add_observations_from_episodes_to_batch": 2.7123130532802642e-06}}, "connector_pipeline_timer": 5.7737748282757385e-05}, "module_to_env_connector": {"timers": {"connectors": {"tensor_to_numpy": 1.5182610204503965e-05, "un_batch_to_individual_items": 6.508587832741071e-06, "listify_data_for_vector_env": 1.0068057968369268e-05, "remove_single_ts_time_rank_from_batch": 1.1571844428077064e-05, "normalize_and_clip_actions": 7.860900334419705e-06, "get_actions": 3.602289433717407e-05}}, "connector_pipeline_timer": 0.00011281690855772727}, "module_episode_returns_mean": {"default_policy": 0.0}, "env_reset_timer": 0.0005451364348070321, "episode_len_mean": 20.0, "num_env_steps_sampled_lifetime": 95400, "num_module_steps_sampled": {"default_policy": 400}, "episode_len_max": 20, "episode_return_max": 14.5, "num_env_steps_sampled": 400, "num_module_steps_sampled_lifetime": {"default_policy": 7600}, "agent_episode_returns_mean": {"default_agent": 0.0}, "episode_return_min": -14.5, "sample": 0.1228540930911835, "num_agent_steps_sampled_lifetime": {"default_agent": 7600}, "env_step_timer": 1.3644568072886733e-05, "weights_seq_no": 19.0, "rlmodule_inference_timer": 3.081651771784095e-05, "num_agent_steps_sampled": {"default_agent": 400}, "episode_duration_sec_mean": 0.006822072496870533, "num_episodes": 20, "num_episodes_lifetime": 380, "env_to_module_sum_episodes_length_out": 10.368238394574323, "episode_return_mean": 0.0, "episode_len_min": 20, "env_to_module_sum_episodes_length_in": 10.368238394574323, "time_between_sampling": 11.460999970335338}, "num_healthy_workers": 1, "actor_manager_num_outstanding_async_reqs": 0, "num_remote_worker_restarts": 0}, "num_env_steps_sampled_lifetime": -10487500.0, "fault_tolerance": {"num_healthy_workers": 0, "num_remote_worker_restarts": 0}, "env_runner_group": {"actor_manager_num_outstanding_async_reqs": 0}, "done": false, "training_iteration": 19, "trial_id": "aea65_00000", "date": "2025-08-11_18-21-48", "timestamp": 1754929308, "time_this_iter_s": 11.185288906097412, "time_total_s": 213.90214276313782, "pid": 10689, "hostname": "Mac", "node_ip": "127.0.0.1", "config": {"exploration_config": {}, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 2, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "env": "Umbrella", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": false, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 0, "create_local_env_runner": true, "num_envs_per_env_runner": 1, "gym_env_vectorize_mode": "SYNC", "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "episodes_to_numpy": true, "max_requests_in_flight_per_env_runner": 1, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "merge_env_runner_states": "training_only", "broadcast_env_runner_states": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "complete_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "sampler_perf_stats_ema_coef": null, "_is_online": true, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": "auto", "num_aggregator_actors_per_learner": 0, "max_requests_in_flight_per_aggregator_actor": 3, "local_gpu_idx": 0, "max_requests_in_flight_per_learner": 3, "gamma": 1, "lr": 0.0002715581955, "grad_clip": 0.5, "grad_clip_by": "global_norm", "_train_batch_size_per_learner": 5000, "train_batch_size": 4000, "num_epochs": 1, "minibatch_size": 1000, "shuffle_batch_per_epoch": true, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "log_std_clip_param": 20.0, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "_disable_preprocessor_api": false, "_disable_action_flattening": false}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {"intrinsic_reward_coeff": 0.2795015916508}, "optimizer": {}, "_learner_class": "<class 'source.intrinsic_attention_ppo.learners.IntrinsicAttentionMetaLearner.IntrinsicAttentionMetaLearner'>", "callbacks_on_algorithm_init": null, "callbacks_on_env_runners_recreated": null, "callbacks_on_offline_eval_runners_recreated": null, "callbacks_on_checkpoint_loaded": null, "callbacks_on_environment_created": null, "callbacks_on_episode_created": null, "callbacks_on_episode_start": null, "callbacks_on_episode_step": null, "callbacks_on_episode_end": null, "callbacks_on_evaluate_start": null, "callbacks_on_evaluate_end": null, "callbacks_on_evaluate_offline_start": null, "callbacks_on_evaluate_offline_end": null, "callbacks_on_sample_end": null, "callbacks_on_train_result": null, "explore": true, "enable_rl_module_and_learner": true, "enable_env_runner_and_connector_v2": true, "_prior_exploration_config": {"type": "StochasticSampling"}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x388285760>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "offline_data_class": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_read_batch_size": null, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "materialize_data": false, "materialize_mapped_data": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "ignore_final_observation": false, "prelearner_class": null, "prelearner_buffer_class": null, "prelearner_buffer_kwargs": {}, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_remaining_data": false, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": 1, "evaluation_duration": 20, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_auto_duration_min_env_steps_per_sample": 100, "evaluation_auto_duration_max_env_steps_per_sample": 2000, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 1, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "offline_evaluation_interval": null, "num_offline_eval_runners": 0, "offline_loss_for_module_fn": null, "offline_evaluation_duration": 1, "offline_evaluation_parallel_to_training": false, "offline_evaluation_timeout_s": 120.0, "num_cpus_per_offline_eval_runner": 1, "num_gpus_per_offline_eval_runner": 0, "custom_resources_per_offline_eval_runner": {}, "restart_failed_offline_eval_runners": true, "ignore_offline_eval_runner_failures": false, "max_num_offline_eval_runner_restarts": 1000, "offline_eval_runner_restore_timeout_s": 1800.0, "max_requests_in_flight_per_offline_eval_runner": 1, "validate_offline_eval_runners_after_construction": true, "offline_eval_runner_health_probe_timeout_s": 30.0, "offline_eval_rl_module_inference_only": false, "broadcast_offline_eval_runner_states": false, "offline_eval_batch_size_per_runner": 256, "dataset_num_iters_per_eval_runner": 1, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "log_gradients": false, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 2, "restart_failed_env_runners": true, "ignore_env_runner_failures": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30.0, "env_runner_restore_timeout_s": 1800.0, "_model_config": {}, "_rl_module_spec": "MultiRLModuleSpec(multi_rl_module_class=<class 'ray.rllib.core.rl_module.multi_rl_module.MultiRLModule'>, observation_space=None, action_space=None, inference_only=False, model_config=None, rl_module_specs={'default_policy': RLModuleSpec(module_class=<class 'source.intrinsic_attention_ppo.rl_modules.DifferentiablePPOModule.DifferentiablePPOModule'>, observation_space=None, action_space=None, inference_only=False, learner_only=False, model_config={'vf_share_layers': True, 'embedding_dim': 62, 'max_seq_len': 3, 'policy_head_hidden_sizes': [32], 'value_head_hidden_sizes': [101], 'embedding_hidden_sizes': [121]}, catalog_class=None, load_state_path=None, model_config_dict=None), 'intrinsic_reward_module': RLModuleSpec(module_class=<class 'source.intrinsic_attention_ppo.rl_modules.IntrinsicAttentionModule.IntrinsicAttentionModule'>, observation_space=None, action_space=None, inference_only=False, learner_only=True, model_config={'intrinsic_reward_network': {'encoder_hidden_sizes': [], 'encoding_dim': 1, 'num_heads': 1, 'head_hidden_sizes': None, 'layers': [{'type': 'attention'}]}, 'extrinsic_value_hidden_layers': [127, 60], 'vf_share_layers': True, 'max_seq_len': 3}, catalog_class=None, load_state_path=None, model_config_dict=None)}, load_state_path=None, modules_to_load=None, module_specs={'default_policy': RLModuleSpec(module_class=<class 'source.intrinsic_attention_ppo.rl_modules.DifferentiablePPOModule.DifferentiablePPOModule'>, observation_space=None, action_space=None, inference_only=False, learner_only=False, model_config={'vf_share_layers': True, 'embedding_dim': 62, 'max_seq_len': 3, 'policy_head_hidden_sizes': [32], 'value_head_hidden_sizes': [101], 'embedding_hidden_sizes': [121]}, catalog_class=None, load_state_path=None, model_config_dict=None), 'intrinsic_reward_module': RLModuleSpec(module_class=<class 'source.intrinsic_attention_ppo.rl_modules.IntrinsicAttentionModule.IntrinsicAttentionModule'>, observation_space=None, action_space=None, inference_only=False, learner_only=True, model_config={'intrinsic_reward_network': {'encoder_hidden_sizes': [], 'encoding_dim': 1, 'num_heads': 1, 'head_hidden_sizes': None, 'layers': [{'type': 'attention'}]}, 'extrinsic_value_hidden_layers': [127, 60], 'vf_share_layers': True, 'max_seq_len': 3}, catalog_class=None, load_state_path=None, model_config_dict=None)})", "algorithm_config_overrides_per_module": {"intrinsic_reward_module": {"lr": 0.0002715581955}}, "_per_module_overrides": {}, "_validate_config": true, "_use_msgpack_checkpoints": false, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "env_task_fn": -1, "enable_connectors": -1, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.161583927863, "kl_target": 0.0201019014258, "vf_loss_coeff": 0.7790510010087, "entropy_coeff": 0.0015431216992, "clip_param": 0.2459212356676, "vf_clip_param": 0.3769744131561, "entropy_coeff_schedule": null, "lr_schedule": null, "sgd_minibatch_size": -1, "vf_share_layers": -1, "differentiable_learner_configs": ["DifferentiableLearnerConfig(learner_class=<class 'source.intrinsic_attention_ppo.learners.IntrinsicAttentionPPOLearner.IntrinsicAttentionPPOLearner'>, learner_connector=None, add_default_connectors_to_learner_pipeline=True, is_multi_agent=False, policies_to_update=['default_policy'], lr=0.0060984166342, num_total_minibatches=0, num_epochs=1, minibatch_size=1000, shuffle_batch_per_epoch=True)"], "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9485408017724, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.callbacks.callbacks.RLlibCallback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 213.90214276313782, "iterations_since_restore": 19, "perf": {"cpu_util_percent": 44.89375, "ram_util_percent": 79.9625}}
{"timers": {"training_iteration": 11.551250768341038, "restore_env_runners": 9.344050725562326e-06, "training_step": 11.551040727534689, "env_runner_sampling_timer": 1.7006768554060807, "learner_update_timer": 9.634555182896085, "synch_weights": 0.001608403835566092, "restore_eval_env_runners": 5.370431453593744e-05, "evaluation_iteration": 0.13458544937310243, "synch_eval_env_connectors": 0.0001831057309651196, "synch_env_connectors": 7.188438769249212e-06}, "env_runners": {"module_to_env_connector": {"connector_pipeline_timer": 0.00011850810967044789, "timers": {"connectors": {"remove_single_ts_time_rank_from_batch": 1.2041056774879508e-05, "normalize_and_clip_actions": 8.06093086480419e-06, "get_actions": 3.939987140164193e-05, "tensor_to_numpy": 1.5228609645019843e-05, "un_batch_to_individual_items": 6.662939923803539e-06, "listify_data_for_vector_env": 1.0615910466395123e-05}}}, "num_agent_steps_sampled_lifetime": {"default_agent": -11105000.0}, "sample": 0.005850308872108463, "episode_len_mean": 20.0, "num_module_steps_sampled": {"default_policy": 5000.0}, "env_to_module_connector": {"connector_pipeline_timer": 5.9579234676375155e-05, "timers": {"connectors": {"add_observations_from_episodes_to_batch": 2.818295389307018e-06, "batch_individual_items": 1.241026442647257e-05, "numpy_to_tensor": 1.2676756689537301e-05, "add_time_dim_to_batch_and_zero_pad": 6.903931619298682e-06, "add_states_from_episodes_to_batch": 2.743807902036219e-06}}}, "num_env_steps_sampled_lifetime": -11105000.0, "episode_return_mean": -0.4600000000000001, "episode_len_min": 20, "env_step_timer": 1.3906041011283042e-05, "num_module_steps_sampled_lifetime": {"default_policy": -11105000.0}, "env_to_module_sum_episodes_length_in": 10.36823839457432, "episode_len_max": 20, "module_episode_returns_mean": {"default_policy": -0.4600000000000001}, "time_between_sampling": 0.03853857443088314, "num_agent_steps_sampled": {"default_agent": 5000.0}, "episode_duration_sec_mean": 0.005289265023078771, "num_env_steps_sampled": 5000.0, "weights_seq_no": 19.0, "num_episodes": 250.0, "episode_return_max": 8.5, "agent_episode_returns_mean": {"default_agent": -0.4600000000000001}, "num_episodes_lifetime": -555250.0, "env_reset_timer": 4.088867698787609e-05, "env_to_module_sum_episodes_length_out": 10.36823839457432, "rlmodule_inference_timer": 3.204328404986436e-05, "episode_return_min": -11.5, "num_env_steps_sampled_lifetime_throughput": 3234.679838104471}, "__all_modules__": {"learner_connector_sum_episodes_length_in": 5000.0, "learner_connector": {"connector_pipeline_timer": 0.17496399030587068, "timers": {"connectors": {"add_one_ts_to_episodes_and_truncate": 0.009030080016574675, "add_observations_from_episodes_to_batch": 0.0008676170961320879, "add_columns_from_episodes_to_train_batch": 0.04140485584311637, "add_time_dim_to_batch_and_zero_pad": 0.103615006771599, "add_states_from_episodes_to_batch": 0.003594762795475982, "batch_individual_items": 0.01619729540687559, "numpy_to_tensor": 8.792335658069659e-05}}}, "learner_connector_sum_episodes_length_out": 5250.0}, "learners": {"differentiable_learners": {"intrinsic_attention_ppo_learner": {"intrinsic_reward_module": {"module_train_batch_size_mean": 999.0, "num_module_steps_trained_lifetime": 719280, "diff_num_grad_updates_vs_sampler_policy": 101.0, "num_module_steps_trained": 35964, "weights_seq_no": 120.0, "total_loss": 0.0}, "default_policy": {"num_module_steps_trained": 35964, "use_intrinsic_rewards": 1.0, "weights_seq_no": 120.0, "module_train_batch_size_mean": 999.0, "vf_loss": 0.2628348767757416, "entropy": 0.6862901449203491, "diff_num_grad_updates_vs_sampler_policy": 101.0, "policy_loss": -0.00047891098074615, "num_module_steps_trained_lifetime": 719280, "vf_loss_unclipped": 38.160133361816406, "vf_explained_var": -0.0022126436233520508, "mean_kl_loss": 3.134092185064219e-05, "total_loss": 0.2032288908958435}, "__all_modules__": {"num_env_steps_trained": 189000, "num_module_steps_trained_lifetime": 1438560, "num_env_steps_trained_lifetime": 3780000, "num_module_steps_trained": 71928, "num_env_steps_trained_lifetime_throughput": 35982.53361513715}}}, "IntrinsicAttentionMask": [[[0.3212120234966278, 0.33065691590309143, 0.3481310307979584], [0.32176926732063293, 0.3307880461215973, 0.34744274616241455], [0.3227599263191223, 0.33101916313171387, 0.3462209105491638]], [[0.33985185623168945, 0.3179825246334076, 0.34216561913490295], [0.35132160782814026, 0.2904742956161499, 0.3582041561603546], [0.33863380551338196, 0.3208654522895813, 0.34050077199935913]], [[0.3586300015449524, 0.31703299283981323, 0.324336975812912], [0.3847910761833191, 0.30058833956718445, 0.31462061405181885], [0.37990444898605347, 0.30362996459007263, 0.31646549701690674]], [[0.3089941740036011, 0.31180548667907715, 0.3792003095149994], [0.30987679958343506, 0.31259554624557495, 0.3775276243686676], [0.32863011956214905, 0.3292168974876404, 0.3421529233455658]], [[0.2790864109992981, 0.3580903112888336, 0.3628232181072235], [0.30364930629730225, 0.3469528257846832, 0.3493979275226593], [0.30497655272483826, 0.346347451210022, 0.34867608547210693]], [[0.4334838092327118, 0.10135873407125473, 0.46515747904777527], [0.36936134099960327, 6.0268966990406625e-06, 0.6306326985359192], [0.41301998496055603, 0.15365876257419586, 0.4333212971687317]]], "default_policy": {"entropy": 0.6862506866455078, "diff_num_grad_updates_vs_sampler_policy": 1.0, "policy_loss": -0.0004997423966415226, "num_module_steps_trained_lifetime": 119880, "vf_loss_unclipped": 38.085784912109375, "vf_explained_var": 0.00010371208190917969, "module_train_batch_size_mean": 999.0, "num_trainable_parameters": 16595, "total_loss": 0.20318731665611267, "num_module_steps_trained": 5994, "use_intrinsic_rewards": 0.0, "weights_seq_no": 20.0, "curr_entropy_coeff": 0.0015431216992, "mean_kl_loss": 3.408439442864619e-05, "curr_kl_coeff": 1.5409844422720198e-07, "vf_loss": 0.2628147006034851, "num_module_steps_trained_lifetime_throughput": 590.699174813512}, "intrinsic_reward_module": {"diff_num_grad_updates_vs_sampler_policy": 1.0, "gradients_default_optimizer_global_norm": 0.0, "num_trainable_parameters": 8266, "weights_seq_no": 20.0, "default_optimizer_learning_rate": 0.0002715581955, "total_loss": 0.0, "num_module_steps_trained": 5994, "module_train_batch_size_mean": 999.0, "curr_entropy_coeff": 0.0015431216992, "num_module_steps_trained_lifetime": 119880, "num_module_steps_trained_lifetime_throughput": 590.6996533810637}, "__all_modules__": {"num_non_trainable_parameters": 0, "num_module_steps_trained_lifetime": 239760, "num_env_steps_trained_lifetime": 630000, "num_trainable_parameters": 24861, "num_env_steps_trained": 31500, "num_module_steps_trained": 11988, "num_env_steps_trained_lifetime_throughput": 3104.3381677238303, "num_module_steps_trained_throughput": 13889646.938002897, "num_module_steps_trained_lifetime_throughput": 10701961.28367219}}, "num_training_step_calls_per_iteration": 1, "evaluation": {"env_runners": {"env_to_module_connector": {"timers": {"connectors": {"numpy_to_tensor": 1.4660283675695496e-05, "add_states_from_episodes_to_batch": 2.8194988778286696e-06, "batch_individual_items": 1.4331678628357196e-05, "add_time_dim_to_batch_and_zero_pad": 7.79594696179939e-06, "add_observations_from_episodes_to_batch": 3.155953251809701e-06}}, "connector_pipeline_timer": 6.612344629824722e-05}, "module_to_env_connector": {"timers": {"connectors": {"tensor_to_numpy": 1.6379772754072744e-05, "un_batch_to_individual_items": 6.743264171271088e-06, "listify_data_for_vector_env": 1.0616393242740237e-05, "remove_single_ts_time_rank_from_batch": 1.2065276443269035e-05, "normalize_and_clip_actions": 8.48238046428158e-06, "get_actions": 4.269573901722167e-05}}, "connector_pipeline_timer": 0.00012485632422933754}, "module_episode_returns_mean": {"default_policy": -0.2}, "env_reset_timer": 0.0005430454906916004, "episode_len_mean": 20.0, "num_env_steps_sampled_lifetime": 100400, "num_module_steps_sampled": {"default_policy": 400}, "episode_len_max": 20, "episode_return_max": 14.5, "num_env_steps_sampled": 400, "num_module_steps_sampled_lifetime": {"default_policy": 8000}, "agent_episode_returns_mean": {"default_agent": -0.2}, "episode_return_min": -14.5, "sample": 0.12285287800042634, "num_agent_steps_sampled_lifetime": {"default_agent": 8000}, "env_step_timer": 1.5146435559980876e-05, "weights_seq_no": 20.0, "rlmodule_inference_timer": 3.415754614368802e-05, "num_agent_steps_sampled": {"default_agent": 400}, "episode_duration_sec_mean": 0.006835462466115132, "num_episodes": 20, "num_episodes_lifetime": 400, "env_to_module_sum_episodes_length_out": 10.368238394574323, "episode_return_mean": -0.2, "episode_len_min": 20, "env_to_module_sum_episodes_length_in": 10.368238394574323, "time_between_sampling": 11.456121273971345}, "num_healthy_workers": 1, "actor_manager_num_outstanding_async_reqs": 0, "num_remote_worker_restarts": 0}, "num_env_steps_sampled_lifetime": -11105000.0, "fault_tolerance": {"num_healthy_workers": 0, "num_remote_worker_restarts": 0}, "env_runner_group": {"actor_manager_num_outstanding_async_reqs": 0}, "done": true, "training_iteration": 20, "trial_id": "aea65_00000", "date": "2025-08-11_18-21-59", "timestamp": 1754929319, "time_this_iter_s": 11.078108072280884, "time_total_s": 224.9802508354187, "pid": 10689, "hostname": "Mac", "node_ip": "127.0.0.1", "config": {"exploration_config": {}, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 2, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "env": "Umbrella", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": false, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 0, "create_local_env_runner": true, "num_envs_per_env_runner": 1, "gym_env_vectorize_mode": "SYNC", "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "episodes_to_numpy": true, "max_requests_in_flight_per_env_runner": 1, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "merge_env_runner_states": "training_only", "broadcast_env_runner_states": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "complete_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "sampler_perf_stats_ema_coef": null, "_is_online": true, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": "auto", "num_aggregator_actors_per_learner": 0, "max_requests_in_flight_per_aggregator_actor": 3, "local_gpu_idx": 0, "max_requests_in_flight_per_learner": 3, "gamma": 1, "lr": 0.0002715581955, "grad_clip": 0.5, "grad_clip_by": "global_norm", "_train_batch_size_per_learner": 5000, "train_batch_size": 4000, "num_epochs": 1, "minibatch_size": 1000, "shuffle_batch_per_epoch": true, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "log_std_clip_param": 20.0, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "_disable_preprocessor_api": false, "_disable_action_flattening": false}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {"intrinsic_reward_coeff": 0.2795015916508}, "optimizer": {}, "_learner_class": "<class 'source.intrinsic_attention_ppo.learners.IntrinsicAttentionMetaLearner.IntrinsicAttentionMetaLearner'>", "callbacks_on_algorithm_init": null, "callbacks_on_env_runners_recreated": null, "callbacks_on_offline_eval_runners_recreated": null, "callbacks_on_checkpoint_loaded": null, "callbacks_on_environment_created": null, "callbacks_on_episode_created": null, "callbacks_on_episode_start": null, "callbacks_on_episode_step": null, "callbacks_on_episode_end": null, "callbacks_on_evaluate_start": null, "callbacks_on_evaluate_end": null, "callbacks_on_evaluate_offline_start": null, "callbacks_on_evaluate_offline_end": null, "callbacks_on_sample_end": null, "callbacks_on_train_result": null, "explore": true, "enable_rl_module_and_learner": true, "enable_env_runner_and_connector_v2": true, "_prior_exploration_config": {"type": "StochasticSampling"}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x388285760>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "offline_data_class": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_read_batch_size": null, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "materialize_data": false, "materialize_mapped_data": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "ignore_final_observation": false, "prelearner_class": null, "prelearner_buffer_class": null, "prelearner_buffer_kwargs": {}, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_remaining_data": false, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": 1, "evaluation_duration": 20, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_auto_duration_min_env_steps_per_sample": 100, "evaluation_auto_duration_max_env_steps_per_sample": 2000, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 1, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "offline_evaluation_interval": null, "num_offline_eval_runners": 0, "offline_loss_for_module_fn": null, "offline_evaluation_duration": 1, "offline_evaluation_parallel_to_training": false, "offline_evaluation_timeout_s": 120.0, "num_cpus_per_offline_eval_runner": 1, "num_gpus_per_offline_eval_runner": 0, "custom_resources_per_offline_eval_runner": {}, "restart_failed_offline_eval_runners": true, "ignore_offline_eval_runner_failures": false, "max_num_offline_eval_runner_restarts": 1000, "offline_eval_runner_restore_timeout_s": 1800.0, "max_requests_in_flight_per_offline_eval_runner": 1, "validate_offline_eval_runners_after_construction": true, "offline_eval_runner_health_probe_timeout_s": 30.0, "offline_eval_rl_module_inference_only": false, "broadcast_offline_eval_runner_states": false, "offline_eval_batch_size_per_runner": 256, "dataset_num_iters_per_eval_runner": 1, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "log_gradients": false, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 2, "restart_failed_env_runners": true, "ignore_env_runner_failures": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30.0, "env_runner_restore_timeout_s": 1800.0, "_model_config": {}, "_rl_module_spec": "MultiRLModuleSpec(multi_rl_module_class=<class 'ray.rllib.core.rl_module.multi_rl_module.MultiRLModule'>, observation_space=None, action_space=None, inference_only=False, model_config=None, rl_module_specs={'default_policy': RLModuleSpec(module_class=<class 'source.intrinsic_attention_ppo.rl_modules.DifferentiablePPOModule.DifferentiablePPOModule'>, observation_space=None, action_space=None, inference_only=False, learner_only=False, model_config={'vf_share_layers': True, 'embedding_dim': 62, 'max_seq_len': 3, 'policy_head_hidden_sizes': [32], 'value_head_hidden_sizes': [101], 'embedding_hidden_sizes': [121]}, catalog_class=None, load_state_path=None, model_config_dict=None), 'intrinsic_reward_module': RLModuleSpec(module_class=<class 'source.intrinsic_attention_ppo.rl_modules.IntrinsicAttentionModule.IntrinsicAttentionModule'>, observation_space=None, action_space=None, inference_only=False, learner_only=True, model_config={'intrinsic_reward_network': {'encoder_hidden_sizes': [], 'encoding_dim': 1, 'num_heads': 1, 'head_hidden_sizes': None, 'layers': [{'type': 'attention'}]}, 'extrinsic_value_hidden_layers': [127, 60], 'vf_share_layers': True, 'max_seq_len': 3}, catalog_class=None, load_state_path=None, model_config_dict=None)}, load_state_path=None, modules_to_load=None, module_specs={'default_policy': RLModuleSpec(module_class=<class 'source.intrinsic_attention_ppo.rl_modules.DifferentiablePPOModule.DifferentiablePPOModule'>, observation_space=None, action_space=None, inference_only=False, learner_only=False, model_config={'vf_share_layers': True, 'embedding_dim': 62, 'max_seq_len': 3, 'policy_head_hidden_sizes': [32], 'value_head_hidden_sizes': [101], 'embedding_hidden_sizes': [121]}, catalog_class=None, load_state_path=None, model_config_dict=None), 'intrinsic_reward_module': RLModuleSpec(module_class=<class 'source.intrinsic_attention_ppo.rl_modules.IntrinsicAttentionModule.IntrinsicAttentionModule'>, observation_space=None, action_space=None, inference_only=False, learner_only=True, model_config={'intrinsic_reward_network': {'encoder_hidden_sizes': [], 'encoding_dim': 1, 'num_heads': 1, 'head_hidden_sizes': None, 'layers': [{'type': 'attention'}]}, 'extrinsic_value_hidden_layers': [127, 60], 'vf_share_layers': True, 'max_seq_len': 3}, catalog_class=None, load_state_path=None, model_config_dict=None)})", "algorithm_config_overrides_per_module": {"intrinsic_reward_module": {"lr": 0.0002715581955}}, "_per_module_overrides": {}, "_validate_config": true, "_use_msgpack_checkpoints": false, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "env_task_fn": -1, "enable_connectors": -1, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.161583927863, "kl_target": 0.0201019014258, "vf_loss_coeff": 0.7790510010087, "entropy_coeff": 0.0015431216992, "clip_param": 0.2459212356676, "vf_clip_param": 0.3769744131561, "entropy_coeff_schedule": null, "lr_schedule": null, "sgd_minibatch_size": -1, "vf_share_layers": -1, "differentiable_learner_configs": ["DifferentiableLearnerConfig(learner_class=<class 'source.intrinsic_attention_ppo.learners.IntrinsicAttentionPPOLearner.IntrinsicAttentionPPOLearner'>, learner_connector=None, add_default_connectors_to_learner_pipeline=True, is_multi_agent=False, policies_to_update=['default_policy'], lr=0.0060984166342, num_total_minibatches=0, num_epochs=1, minibatch_size=1000, shuffle_batch_per_epoch=True)"], "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9485408017724, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.callbacks.callbacks.RLlibCallback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 224.9802508354187, "iterations_since_restore": 20, "perf": {"cpu_util_percent": 45.4, "ram_util_percent": 79.7125}}
