{"timers": {"training_iteration": 12.647735583013855, "restore_env_runners": 1.2792064808309078e-05, "training_step": 12.647547166910954, "env_runner_sampling_timer": 2.959007458994165, "learner_update_timer": 9.468983624945395, "synch_weights": 0.0016484580701217055}, "env_runners": {"module_to_env_connector": {"connector_pipeline_timer": 0.00022667849186075155, "timers": {"connectors": {"remove_single_ts_time_rank_from_batch": 1.9338411107671587e-05, "un_batch_to_individual_items": 9.88628268672829e-06, "get_actions": 9.37364176245596e-05, "tensor_to_numpy": 2.747398029826741e-05, "listify_data_for_vector_env": 1.757109065444916e-05, "normalize_and_clip_actions": 1.6388136708061595e-05}}}, "rlmodule_inference_timer": 6.644067491442645e-05, "sample": 0.009607470022412861, "weights_seq_no": 0.0, "num_agent_steps_sampled": {"default_agent": 5000.0}, "episode_len_mean": 20.0, "episode_len_max": 20, "env_to_module_connector": {"timers": {"connectors": {"batch_individual_items": 2.0755134574449122e-05, "add_states_from_episodes_to_batch": 4.195221695172113e-06, "numpy_to_tensor": 2.530690210984088e-05, "add_observations_from_episodes_to_batch": 5.072865298420556e-06, "add_time_dim_to_batch_and_zero_pad": 1.2379094655606125e-05}}, "connector_pipeline_timer": 0.00010269120270387868}, "env_to_module_sum_episodes_length_out": 10.191744832559449, "num_agent_steps_sampled_lifetime": {"default_agent": 627500.0}, "episode_return_mean": 1.0999999999999996, "num_module_steps_sampled_lifetime": {"default_policy": 627500.0}, "num_episodes": 250.0, "time_between_sampling": 0.001039662310458649, "num_env_steps_sampled_lifetime": 627500.0, "episode_return_min": -10.5, "env_reset_timer": 0.00011371329088161986, "env_to_module_sum_episodes_length_in": 10.191744832559449, "num_episodes_lifetime": 31375.0, "agent_episode_returns_mean": {"default_agent": 1.0999999999999996}, "episode_len_min": 20, "episode_duration_sec_mean": 0.009428203989751636, "env_step_timer": 2.7646020051968562e-05, "episode_return_max": 9.5, "num_module_steps_sampled": {"default_policy": 5000.0}, "module_episode_returns_mean": {"default_policy": 1.0999999999999996}, "num_env_steps_sampled": 5000.0, "num_env_steps_sampled_lifetime_throughput": 2129.118864000744}, "__all_modules__": {"learner_connector_sum_episodes_length_in": 5000, "learner_connector": {"connector_pipeline_timer": 0.16315362497698516, "timers": {"connectors": {"add_one_ts_to_episodes_and_truncate": 0.009354667039588094, "add_observations_from_episodes_to_batch": 0.0016835419228300452, "add_columns_from_episodes_to_train_batch": 0.05017870804294944, "add_time_dim_to_batch_and_zero_pad": 0.08576391695532948, "add_states_from_episodes_to_batch": 0.009269375004805624, "batch_individual_items": 0.006545207928866148, "numpy_to_tensor": 9.862496517598629e-05}}}, "learner_connector_sum_episodes_length_out": 5250}, "learners": {"default_policy": {"curr_entropy_coeff": 0.0015431216992, "curr_kl_coeff": 0.08079196512699127, "num_module_steps_trained_lifetime": 5985, "entropy": 0.6905841827392578, "num_module_steps_trained": 5985, "diff_num_grad_updates_vs_sampler_policy": 1.0, "vf_loss": 0.358345091342926, "vf_loss_unclipped": 43.64649963378906, "policy_loss": -0.0001021227944875136, "use_intrinsic_rewards": 0.0, "total_loss": 0.2780018448829651, "vf_explained_var": -0.006254673004150391, "mean_kl_loss": 3.1091560686036246e-06, "weights_seq_no": 1.0, "num_trainable_parameters": 16595, "module_train_batch_size_mean": 997.9705930399, "num_module_steps_trained_lifetime_throughput": 778.0893579942281}, "intrinsic_reward_module": {"num_module_steps_trained_lifetime": 5985, "num_module_steps_trained": 5985, "diff_num_grad_updates_vs_sampler_policy": 1.0, "total_loss": 0.0, "gradients_default_optimizer_global_norm": 0.0, "module_train_batch_size_mean": 997.9705930399, "default_optimizer_learning_rate": 0.0002715581955, "weights_seq_no": 1.0, "num_trainable_parameters": 8266, "curr_entropy_coeff": 0.0015431216992, "num_module_steps_trained_lifetime_throughput": 778.1052678697739}, "differentiable_learners": {"intrinsic_attention_ppo_learner": {"default_policy": {"weights_seq_no": 6.0, "num_module_steps_trained": 35910, "num_module_steps_trained_lifetime": 35910, "entropy": 0.6905931830406189, "diff_num_grad_updates_vs_sampler_policy": 6.0, "vf_loss": 0.35858023166656494, "vf_loss_unclipped": 43.4964599609375, "total_loss": 0.2781897485256195, "mean_kl_loss": 2.7906851300940616e-06, "policy_loss": -9.729236626299098e-05, "use_intrinsic_rewards": 1.0, "module_train_batch_size_mean": 997.8474438281662, "vf_explained_var": -0.0016481876373291016}, "__all_modules__": {"num_env_steps_trained": 198000, "num_module_steps_trained": 71820, "num_module_steps_trained_lifetime": 71820, "num_env_steps_trained_lifetime": 198000, "num_env_steps_trained_lifetime_throughput": 38037.4167298862}, "intrinsic_reward_module": {"weights_seq_no": 6.0, "num_module_steps_trained_lifetime": 35910, "num_module_steps_trained": 35910, "diff_num_grad_updates_vs_sampler_policy": 6.0, "total_loss": 0.0, "module_train_batch_size_mean": 997.8474438281662}}}, "__all_modules__": {"num_env_steps_trained_lifetime": 33000, "num_non_trainable_parameters": 0, "num_trainable_parameters": 24861, "num_env_steps_trained": 33000, "num_module_steps_trained": 11970, "num_module_steps_trained_lifetime": 11970, "num_env_steps_trained_lifetime_throughput": 4292.163073713589, "num_module_steps_trained_throughput": 29834791.536859177, "num_module_steps_trained_lifetime_throughput": 13517149.41062492}, "IntrinsicAttentionMask": [[[0.09220398962497711, 0.09221363067626953, 0.0894317775964737, 0.09044167399406433, 0.09224256873130798, 0.092252217233181, 0.09047006070613861, 0.08947855979204178, 0.09126027673482895, 0.08949727565050125, 0.09050790965557098], [0.09220970422029495, 0.09221938997507095, 0.08942530304193497, 0.09043959528207779, 0.09224846214056015, 0.09225814789533615, 0.09046810120344162, 0.08947228640317917, 0.09126179665327072, 0.08949108421802521, 0.09050612151622772], [0.09054064005613327, 0.09053794294595718, 0.09133224934339523, 0.09104026108980179, 0.09052983671426773, 0.09052713960409164, 0.09103211760520935, 0.09131862968206406, 0.09080664813518524, 0.0913131833076477, 0.09102126210927963], [0.0911516398191452, 0.09115342795848846, 0.09063119441270828, 0.09082228690385818, 0.09115879237651825, 0.09116058051586151, 0.09082762897014618, 0.09064008295536041, 0.09097591787576675, 0.09064364433288574, 0.09083475917577744], [0.09222683310508728, 0.09223664551973343, 0.089405857026577, 0.09043334424495697, 0.09226610511541367, 0.09227592498064041, 0.09046222269535065, 0.08945344388484955, 0.09126634895801544, 0.08947248756885529, 0.09050074219703674], [0.09223254770040512, 0.09224240481853485, 0.08939938247203827, 0.09043126553297043, 0.09227199107408524, 0.09228185564279556, 0.09046027064323425, 0.08944717049598694, 0.09126787632703781, 0.08946629613637924, 0.09049895405769348], [0.09116873145103455, 0.09117064625024796, 0.09061164408922195, 0.09081616997718811, 0.09117639064788818, 0.09117830544710159, 0.09082189202308655, 0.09062115848064423, 0.09098061174154282, 0.09062496572732925, 0.0908295139670372], [0.09056908637285233, 0.09056659042835236, 0.09129956364631653, 0.09103018790483475, 0.09055911749601364, 0.09055662155151367, 0.09102267026901245, 0.09128700196743011, 0.09081460535526276, 0.09128197282552719, 0.09101264923810959], [0.09164262562990189, 0.09164806455373764, 0.09007032215595245, 0.09064550697803497, 0.09166435897350311, 0.09166979789733887, 0.09066163748502731, 0.09009702503681183, 0.09110970795154572, 0.09010770916938782, 0.09068313986063004], [0.09058045595884323, 0.09057804197072983, 0.09128648042678833, 0.09102614223957062, 0.09057081490755081, 0.090568408370018, 0.09101887792348862, 0.09127434343099594, 0.09081777185201645, 0.09126948565244675, 0.09100919216871262], [0.09119150787591934, 0.09119358658790588, 0.09058556705713272, 0.09080798923969269, 0.0911998450756073, 0.09120192378759384, 0.09081421047449112, 0.09059590846300125, 0.09098684787750244, 0.09060005098581314, 0.09082251042127609]], [[0.09206783026456833, 0.09103183448314667, 0.09162675589323044, 0.09268076717853546, 0.09268639236688614, 0.09164343029260635, 0.09105945378541946, 0.09210693836212158, 0.08174072206020355, 0.0915955901145935, 0.09176024049520493], [0.09040167927742004, 0.09082791209220886, 0.09058231115341187, 0.09015268832445145, 0.09015041589736938, 0.09057546406984329, 0.09081646054983139, 0.09038572013378143, 0.09498470276594162, 0.09059512615203857, 0.09052751958370209], [0.09138201922178268, 0.09097009152173996, 0.09120698273181915, 0.091624416410923, 0.09162663668394089, 0.09121360629796982, 0.09098111093044281, 0.09139750897884369, 0.08714298158884048, 0.09119459986686707, 0.09126000851392746], [0.09296640008687973, 0.09106087684631348, 0.09215293824672699, 0.09410219639539719, 0.09411264955997467, 0.09218363463878632, 0.0911114513874054, 0.09303868561983109, 0.0747767761349678, 0.09209558367729187, 0.09239877760410309], [0.09297436475753784, 0.09106086194515228, 0.09215746819972992, 0.0941150039434433, 0.09412549436092377, 0.09218829870223999, 0.09111163765192032, 0.09304694831371307, 0.07471568137407303, 0.0920998752117157, 0.09240434318780899], [0.09140857309103012, 0.09097308665513992, 0.09122351557016373, 0.09166489541530609, 0.09166724234819412, 0.09123051911592484, 0.09098473936319351, 0.09142496436834335, 0.08693249523639679, 0.09121041744947433, 0.09127957373857498], [0.09044864773750305, 0.09083608537912369, 0.09061285853385925, 0.09022223949432373, 0.09022016823291779, 0.09060662984848022, 0.09082567691802979, 0.09043414145708084, 0.0946059450507164, 0.09062450379133224, 0.09056304395198822], [0.09212701767683029, 0.09103560447692871, 0.09166227281093597, 0.09277305006980896, 0.09277898073196411, 0.09167984127998352, 0.0910646989941597, 0.09216823428869247, 0.08127789944410324, 0.09162944555282593, 0.09180290997028351], [0.06399761140346527, 0.07488515973091125, 0.06840994954109192, 0.05836542323231697, 0.05831627920269966, 0.0682372972369194, 0.074570432305336, 0.06362137198448181, 0.3338214159011841, 0.06873379647731781, 0.06704117357730865], [0.09133227169513702, 0.09096436202526093, 0.09117595851421356, 0.09154868125915527, 0.09155066311359406, 0.09118188172578812, 0.09097420424222946, 0.09134609997272491, 0.08753761649131775, 0.09116489440202713, 0.09122331440448761], [0.09159316122531891, 0.09099256247282028, 0.09133780747652054, 0.09194716811180115, 0.09195040911436081, 0.09134747087955475, 0.09100861847400665, 0.09161578118801117, 0.08547218143939972, 0.091319739818573, 0.09141513705253601]], [[0.09248346090316772, 0.0914698988199234, 0.08970285207033157, 0.0897122398018837, 0.09252215921878815, 0.09253183752298355, 0.08974038809537888, 0.09075377136468887, 0.09153688699007034, 0.08976855129003525, 0.08977793902158737], [0.09175163507461548, 0.09121120721101761, 0.09026233851909637, 0.09026739746332169, 0.09177220612764359, 0.09177735447883606, 0.09028258174657822, 0.09082768857479095, 0.09124700725078583, 0.09029777348041534, 0.09030283242464066], [0.09046228975057602, 0.09074701368808746, 0.09125321358442307, 0.09125049412250519, 0.09045150130987167, 0.09044880419969559, 0.09124232828617096, 0.0909506306052208, 0.09072806686162949, 0.09123416244983673, 0.09123144298791885], [0.09046918153762817, 0.09074952453374863, 0.09124790132045746, 0.09124521911144257, 0.09045855700969696, 0.09045590460300446, 0.09123718738555908, 0.09095000475645065, 0.09073086827993393, 0.091229148209095, 0.09122646600008011], [0.09251130372285843, 0.09147968143224716, 0.08968162536621094, 0.0896911695599556, 0.09255069494247437, 0.0925605446100235, 0.08971981704235077, 0.09075090289115906, 0.09154785424470901, 0.08974846452474594, 0.0897580161690712], [0.09251826256513596, 0.09148211777210236, 0.08967632055282593, 0.08968590199947357, 0.09255782514810562, 0.09256771951913834, 0.0897146686911583, 0.09075018763542175, 0.09155059605836868, 0.08974343538284302, 0.08975303173065186], [0.09048985689878464, 0.09075704216957092, 0.09123195707798004, 0.0912294089794159, 0.09047973155975342, 0.09047719091176987, 0.09122174233198166, 0.09094810485839844, 0.09073927253484726, 0.09121409058570862, 0.09121153503656387], [0.09123117476701736, 0.09102512896060944, 0.09066151827573776, 0.09066347032785416, 0.09123900532722473, 0.09124096482992172, 0.09066930413246155, 0.0908784493803978, 0.09103880077600479, 0.09067513793706894, 0.09067708253860474], [0.09180016815662384, 0.09122846275568008, 0.09022516012191772, 0.09023050218820572, 0.09182193875312805, 0.0918273851275444, 0.09024655818939209, 0.09082287549972534, 0.09126633405685425, 0.09026261419057846, 0.09026796370744705], [0.0905105471611023, 0.09076458215713501, 0.09121602773666382, 0.09121360629796982, 0.09050092101097107, 0.09049850702285767, 0.09120631963014603, 0.09094621241092682, 0.09074768424034119, 0.09119904041290283, 0.09119661897420883], [0.09051743149757385, 0.09076708555221558, 0.09121070802211761, 0.0912083238363266, 0.09050796926021576, 0.09050560742616653, 0.09120117127895355, 0.09094557166099548, 0.09075047820806503, 0.0911940187215805, 0.09119163453578949]], [[0.09064999222755432, 0.08858931064605713, 0.08744598925113678, 0.08950214087963104, 0.08951317518949509, 0.08863300830125809, 0.08748912066221237, 0.08954628556966782, 0.11155293881893158, 0.0885390117764473, 0.0885390117764473], [0.09087592363357544, 0.09024431556463242, 0.08988945931196213, 0.09052535146474838, 0.09052873402833939, 0.09025781601667404, 0.08990290760993958, 0.090538889169693, 0.0967789739370346, 0.09022877365350723, 0.09022877365350723], [0.09091178327798843, 0.09110066294670105, 0.09120753407478333, 0.09101640433073044, 0.09101539850234985, 0.09109660983085632, 0.091203473508358, 0.09101235866546631, 0.08922505378723145, 0.09110532701015472, 0.09110532701015472], [0.09080188721418381, 0.08952908962965012, 0.08881796896457672, 0.09009430557489395, 0.09010112285614014, 0.08955619484186172, 0.08884486556053162, 0.09012158215045929, 0.1031372919678688, 0.0894978791475296, 0.0894978791475296], [0.09080073982477188, 0.08952026814222336, 0.08880491554737091, 0.0900888741016388, 0.09009572863578796, 0.0895475298166275, 0.08883196115493774, 0.09011631458997726, 0.10321594774723053, 0.08948887139558792, 0.08948887139558792], [0.09087332338094711, 0.09021072834730148, 0.08983856439590454, 0.09050551801919937, 0.0905090719461441, 0.09022489190101624, 0.08985266834497452, 0.0905197262763977, 0.09707668423652649, 0.09019442647695541, 0.09019442647695541], [0.09091156721115112, 0.09106915444135666, 0.09115829318761826, 0.09099886566400528, 0.09099802374839783, 0.09106576442718506, 0.09115491062402725, 0.09099548310041428, 0.08950187265872955, 0.09107305109500885, 0.09107305109500885], [0.09079726040363312, 0.0894937738776207, 0.0887657105922699, 0.09007255733013153, 0.09007954597473145, 0.08952152729034424, 0.08879324048757553, 0.09010049700737, 0.10345225036144257, 0.08946181833744049, 0.08946181833744049], [0.07579205930233002, 0.0640997439622879, 0.05831083282828331, 0.06907118856906891, 0.06913327425718307, 0.06433047354221344, 0.05852073058485985, 0.06931983679533005, 0.3437518775463104, 0.063835009932518, 0.063835009932518], [0.09087882936000824, 0.09028291702270508, 0.08994801342487335, 0.09054809808731079, 0.09055129438638687, 0.09029565751552582, 0.08996070176362991, 0.09056087583303452, 0.09643713384866714, 0.09026824682950974, 0.09026824682950974], [0.09087882936000824, 0.09028291702270508, 0.08994801342487335, 0.09054809808731079, 0.09055129438638687, 0.09029565751552582, 0.08996070176362991, 0.09056087583303452, 0.09643713384866714, 0.09026824682950974, 0.09026824682950974]], [[0.09258002042770386, 0.09156540036201477, 0.0897965058684349, 0.08980590105056763, 0.09159412980079651, 0.09160371124744415, 0.08983407914638519, 0.09084852039813995, 0.09163245558738708, 0.08986227214336395, 0.09087702631950378], [0.09180223941802979, 0.09126152098178864, 0.09031212329864502, 0.09031718969345093, 0.0912768691778183, 0.09128198027610779, 0.09033238142728806, 0.09087778627872467, 0.09129734337329865, 0.09034758061170578, 0.09089307487010956], [0.09043644368648529, 0.09072108566761017, 0.09122714400291443, 0.09122442454099655, 0.09071296453475952, 0.09071025997400284, 0.09121626615524292, 0.09092465043067932, 0.09070214629173279, 0.09120810031890869, 0.09091651439666748], [0.09044373035430908, 0.09072399139404297, 0.09122222661972046, 0.09121954441070557, 0.09071599692106247, 0.09071332961320877, 0.09121151268482208, 0.09092441201210022, 0.09070533514022827, 0.0912034809589386, 0.09091640263795853], [0.09182431548833847, 0.09127017855644226, 0.09029742330312729, 0.09030261635780334, 0.09128590673208237, 0.0912911519408226, 0.09031818062067032, 0.0908769816160202, 0.09130688011646271, 0.09033374488353729, 0.09089264273643494], [0.09183167666196823, 0.09127306193113327, 0.09029252827167511, 0.09029775857925415, 0.09128892421722412, 0.09129420667886734, 0.09031344205141068, 0.09087670594453812, 0.09131006896495819, 0.0903291329741478, 0.090892493724823], [0.09046558290719986, 0.09073270112276077, 0.09120748937129974, 0.0912049412727356, 0.09072508662939072, 0.09072255343198776, 0.09119728207588196, 0.09092371165752411, 0.0907149389386177, 0.09118962287902832, 0.09091607481241226], [0.0912502184510231, 0.09104412794113159, 0.09068044275045395, 0.09068239480257034, 0.09104999154806137, 0.09105194360017776, 0.09068822860717773, 0.09089741855859756, 0.09105780720710754, 0.09069406241178513, 0.09090326726436615], [0.09185376018285751, 0.09128172695636749, 0.09027782827615738, 0.09028318524360657, 0.09129796177148819, 0.09130337834358215, 0.09029924124479294, 0.09087589383125305, 0.09131962060928345, 0.0903153046965599, 0.09089206159114838], [0.09048745036125183, 0.09074141830205917, 0.09119275212287903, 0.09119033068418503, 0.09073417633771896, 0.09073176980018616, 0.09118305146694183, 0.0909230038523674, 0.09072452783584595, 0.09117577224969864, 0.090915746986866], [0.09127222001552582, 0.0910528227686882, 0.09066574275493622, 0.09066781401634216, 0.09105906635522842, 0.09106114506721497, 0.09067402780056, 0.09089666604995728, 0.09106738120317459, 0.09068024158477783, 0.0909028947353363]], [[0.09201943874359131, 0.09157303720712662, 0.09157858788967133, 0.0920361876487732, 0.09263767302036285, 0.0910060703754425, 0.09101159125566483, 0.09205852448940277, 0.08222668617963791, 0.09214014559984207, 0.09171201288700104], [0.09135304391384125, 0.09117922186851501, 0.09118138998746872, 0.09135955572128296, 0.0915929302573204, 0.09095770865678787, 0.09095986932516098, 0.09136823564767838, 0.0874147117137909, 0.09139996021986008, 0.09123338758945465], [0.09136153012514114, 0.09118432551622391, 0.0911865383386612, 0.091368168592453, 0.09160609543323517, 0.09095851331949234, 0.09096071869134903, 0.09137701988220215, 0.08734820038080215, 0.0914093628525734, 0.0912395492196083], [0.09204383939504623, 0.09158718585968018, 0.09159286320209503, 0.09206098318099976, 0.09267637133598328, 0.09100725501775742, 0.09101290255784988, 0.09208383411169052, 0.0820380449295044, 0.09216733276844025, 0.09172934293746948], [0.0928926169872284, 0.09206617623567581, 0.09207643568515778, 0.09292369335889816, 0.09404273331165314, 0.09102137386798859, 0.0910315290093422, 0.09296514093875885, 0.07554055005311966, 0.09311666339635849, 0.09232309460639954], [0.09046058356761932, 0.09063023328781128, 0.09062811732292175, 0.09045423567295074, 0.09022749215364456, 0.09084737300872803, 0.0908452570438385, 0.09044577926397324, 0.09446871280670166, 0.09041489660739899, 0.09057729691267014], [0.09046952426433563, 0.09063585102558136, 0.09063377976417542, 0.0904633030295372, 0.09024099260568619, 0.09084872156381607, 0.09084664285182953, 0.09045501053333282, 0.0943974032998085, 0.09042473882436752, 0.09058395028114319], [0.09207633137702942, 0.09160599112510681, 0.091611847281456, 0.09209398925304413, 0.09272793680429459, 0.09100878238677979, 0.09101459383964539, 0.09211752563714981, 0.08178713917732239, 0.0922035425901413, 0.09175240248441696], [0.06787871569395065, 0.07233525067567825, 0.07227788120508194, 0.06771735846996307, 0.06218811124563217, 0.07845485210418701, 0.0783926323056221, 0.06750280410051346, 0.2956123948097229, 0.06672508269548416, 0.07091499865055084], [0.09219436347484589, 0.09167397767305374, 0.09168045222759247, 0.09221389889717102, 0.09291575103998184, 0.09101363271474838, 0.09102006256580353, 0.09223995357751846, 0.08087677508592606, 0.09233514964580536, 0.09183593839406967], [0.09156384319067001, 0.09130534529685974, 0.09130856394767761, 0.09157352894544601, 0.09192097187042236, 0.09097626805305481, 0.09097947925329208, 0.09158644825220108, 0.08576598763465881, 0.09163364768028259, 0.0913858711719513]]]}, "num_training_step_calls_per_iteration": 1, "num_env_steps_sampled_lifetime": 627500.0, "evaluation": {"env_runners": {"module_to_env_connector": {"timers": {"connectors": {"tensor_to_numpy": 1.8369919695982074e-05, "un_batch_to_individual_items": 7.141928577331165e-06, "get_actions": 5.090270438303726e-05, "listify_data_for_vector_env": 1.1302852977026028e-05, "normalize_and_clip_actions": 9.573064127080109e-06, "remove_single_ts_time_rank_from_batch": 1.3610869607218352e-05}}, "connector_pipeline_timer": 0.00013944157554615094}, "episode_len_min": 20, "num_env_steps_sampled": 400, "weights_seq_no": 1.0, "episode_len_mean": 20.0, "env_to_module_sum_episodes_length_out": 10.216013141322508, "episode_len_max": 20, "env_to_module_connector": {"timers": {"connectors": {"batch_individual_items": 1.3404829278172667e-05, "add_observations_from_episodes_to_batch": 3.684747031717829e-06, "add_states_from_episodes_to_batch": 2.9208001176862394e-06, "add_time_dim_to_batch_and_zero_pad": 8.736137946875128e-06, "numpy_to_tensor": 1.4342238390882639e-05}}, "connector_pipeline_timer": 6.913958179020499e-05}, "env_to_module_sum_episodes_length_in": 10.216013141322508, "num_episodes_lifetime": 20, "episode_duration_sec_mean": 0.005957760487217456, "episode_return_max": 12.5, "rlmodule_inference_timer": 4.077065515177351e-05, "num_agent_steps_sampled": {"default_agent": 400}, "num_module_steps_sampled_lifetime": {"default_policy": 400}, "num_agent_steps_sampled_lifetime": {"default_agent": 400}, "num_module_steps_sampled": {"default_policy": 400}, "sample": 0.13197208405472338, "episode_return_mean": -2.8, "env_step_timer": 1.660396848372677e-05, "agent_episode_returns_mean": {"default_agent": -2.8}, "num_episodes": 20, "module_episode_returns_mean": {"default_policy": -2.8}, "episode_return_min": -12.5, "num_env_steps_sampled_lifetime": 5400, "env_reset_timer": 0.0005787920672446489}, "num_healthy_workers": 1, "actor_manager_num_outstanding_async_reqs": 0, "num_remote_worker_restarts": 0}, "fault_tolerance": {"num_healthy_workers": 0, "num_remote_worker_restarts": 0}, "env_runner_group": {"actor_manager_num_outstanding_async_reqs": 0}, "done": false, "training_iteration": 1, "trial_id": "ae8a2_00000", "date": "2025-08-11_18-22-39", "timestamp": 1754929359, "time_this_iter_s": 12.794284105300903, "time_total_s": 12.794284105300903, "pid": 10870, "hostname": "Mac", "node_ip": "127.0.0.1", "config": {"exploration_config": {}, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 2, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "env": "Umbrella", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": false, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 0, "create_local_env_runner": true, "num_envs_per_env_runner": 1, "gym_env_vectorize_mode": "SYNC", "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "episodes_to_numpy": true, "max_requests_in_flight_per_env_runner": 1, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "merge_env_runner_states": "training_only", "broadcast_env_runner_states": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "complete_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "sampler_perf_stats_ema_coef": null, "_is_online": true, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": "auto", "num_aggregator_actors_per_learner": 0, "max_requests_in_flight_per_aggregator_actor": 3, "local_gpu_idx": 0, "max_requests_in_flight_per_learner": 3, "gamma": 1, "lr": 0.0002715581955, "grad_clip": 0.5, "grad_clip_by": "global_norm", "_train_batch_size_per_learner": 5000, "train_batch_size": 4000, "num_epochs": 1, "minibatch_size": 1000, "shuffle_batch_per_epoch": true, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "log_std_clip_param": 20.0, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "_disable_preprocessor_api": false, "_disable_action_flattening": false}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {"intrinsic_reward_coeff": 0.2795015916508}, "optimizer": {}, "_learner_class": "<class 'source.intrinsic_attention_ppo.learners.IntrinsicAttentionMetaLearner.IntrinsicAttentionMetaLearner'>", "callbacks_on_algorithm_init": null, "callbacks_on_env_runners_recreated": null, "callbacks_on_offline_eval_runners_recreated": null, "callbacks_on_checkpoint_loaded": null, "callbacks_on_environment_created": null, "callbacks_on_episode_created": null, "callbacks_on_episode_start": null, "callbacks_on_episode_step": null, "callbacks_on_episode_end": null, "callbacks_on_evaluate_start": null, "callbacks_on_evaluate_end": null, "callbacks_on_evaluate_offline_start": null, "callbacks_on_evaluate_offline_end": null, "callbacks_on_sample_end": null, "callbacks_on_train_result": null, "explore": true, "enable_rl_module_and_learner": true, "enable_env_runner_and_connector_v2": true, "_prior_exploration_config": {"type": "StochasticSampling"}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x38844d8a0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "offline_data_class": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_read_batch_size": null, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "materialize_data": false, "materialize_mapped_data": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "ignore_final_observation": false, "prelearner_class": null, "prelearner_buffer_class": null, "prelearner_buffer_kwargs": {}, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_remaining_data": false, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": 1, "evaluation_duration": 20, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_auto_duration_min_env_steps_per_sample": 100, "evaluation_auto_duration_max_env_steps_per_sample": 2000, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 1, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "offline_evaluation_interval": null, "num_offline_eval_runners": 0, "offline_loss_for_module_fn": null, "offline_evaluation_duration": 1, "offline_evaluation_parallel_to_training": false, "offline_evaluation_timeout_s": 120.0, "num_cpus_per_offline_eval_runner": 1, "num_gpus_per_offline_eval_runner": 0, "custom_resources_per_offline_eval_runner": {}, "restart_failed_offline_eval_runners": true, "ignore_offline_eval_runner_failures": false, "max_num_offline_eval_runner_restarts": 1000, "offline_eval_runner_restore_timeout_s": 1800.0, "max_requests_in_flight_per_offline_eval_runner": 1, "validate_offline_eval_runners_after_construction": true, "offline_eval_runner_health_probe_timeout_s": 30.0, "offline_eval_rl_module_inference_only": false, "broadcast_offline_eval_runner_states": false, "offline_eval_batch_size_per_runner": 256, "dataset_num_iters_per_eval_runner": 1, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "log_gradients": false, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 1, "restart_failed_env_runners": true, "ignore_env_runner_failures": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30.0, "env_runner_restore_timeout_s": 1800.0, "_model_config": {}, "_rl_module_spec": "MultiRLModuleSpec(multi_rl_module_class=<class 'ray.rllib.core.rl_module.multi_rl_module.MultiRLModule'>, observation_space=None, action_space=None, inference_only=False, model_config=None, rl_module_specs={'default_policy': RLModuleSpec(module_class=<class 'source.intrinsic_attention_ppo.rl_modules.DifferentiablePPOModule.DifferentiablePPOModule'>, observation_space=None, action_space=None, inference_only=False, learner_only=False, model_config={'vf_share_layers': True, 'embedding_dim': 62, 'max_seq_len': 11, 'policy_head_hidden_sizes': [32], 'value_head_hidden_sizes': [101], 'embedding_hidden_sizes': [121]}, catalog_class=None, load_state_path=None, model_config_dict=None), 'intrinsic_reward_module': RLModuleSpec(module_class=<class 'source.intrinsic_attention_ppo.rl_modules.IntrinsicAttentionModule.IntrinsicAttentionModule'>, observation_space=None, action_space=None, inference_only=False, learner_only=True, model_config={'intrinsic_reward_network': {'encoder_hidden_sizes': [], 'encoding_dim': 1, 'num_heads': 1, 'head_hidden_sizes': None, 'layers': [{'type': 'attention'}]}, 'extrinsic_value_hidden_layers': [127, 60], 'vf_share_layers': True, 'max_seq_len': 11}, catalog_class=None, load_state_path=None, model_config_dict=None)}, load_state_path=None, modules_to_load=None, module_specs={'default_policy': RLModuleSpec(module_class=<class 'source.intrinsic_attention_ppo.rl_modules.DifferentiablePPOModule.DifferentiablePPOModule'>, observation_space=None, action_space=None, inference_only=False, learner_only=False, model_config={'vf_share_layers': True, 'embedding_dim': 62, 'max_seq_len': 11, 'policy_head_hidden_sizes': [32], 'value_head_hidden_sizes': [101], 'embedding_hidden_sizes': [121]}, catalog_class=None, load_state_path=None, model_config_dict=None), 'intrinsic_reward_module': RLModuleSpec(module_class=<class 'source.intrinsic_attention_ppo.rl_modules.IntrinsicAttentionModule.IntrinsicAttentionModule'>, observation_space=None, action_space=None, inference_only=False, learner_only=True, model_config={'intrinsic_reward_network': {'encoder_hidden_sizes': [], 'encoding_dim': 1, 'num_heads': 1, 'head_hidden_sizes': None, 'layers': [{'type': 'attention'}]}, 'extrinsic_value_hidden_layers': [127, 60], 'vf_share_layers': True, 'max_seq_len': 11}, catalog_class=None, load_state_path=None, model_config_dict=None)})", "algorithm_config_overrides_per_module": {"intrinsic_reward_module": {"lr": 0.0002715581955}}, "_per_module_overrides": {}, "_validate_config": true, "_use_msgpack_checkpoints": false, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "env_task_fn": -1, "enable_connectors": -1, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.161583927863, "kl_target": 0.0201019014258, "vf_loss_coeff": 0.7790510010087, "entropy_coeff": 0.0015431216992, "clip_param": 0.2459212356676, "vf_clip_param": 0.3769744131561, "entropy_coeff_schedule": null, "lr_schedule": null, "sgd_minibatch_size": -1, "vf_share_layers": -1, "differentiable_learner_configs": ["DifferentiableLearnerConfig(learner_class=<class 'source.intrinsic_attention_ppo.learners.IntrinsicAttentionPPOLearner.IntrinsicAttentionPPOLearner'>, learner_connector=None, add_default_connectors_to_learner_pipeline=True, is_multi_agent=False, policies_to_update=['default_policy'], lr=0.0060984166342, num_total_minibatches=0, num_epochs=1, minibatch_size=1000, shuffle_batch_per_epoch=True)"], "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9485408017724, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.callbacks.callbacks.RLlibCallback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 12.794284105300903, "iterations_since_restore": 1, "perf": {"cpu_util_percent": 62.9421052631579, "ram_util_percent": 82.1263157894737}}
{"timers": {"training_iteration": 12.646109274263727, "restore_env_runners": 1.2782893609255552e-05, "training_step": 12.645919232742163, "env_runner_sampling_timer": 2.952017156074289, "learner_update_timer": 9.474381033695535, "synch_weights": 0.0016484164097346364, "restore_eval_env_runners": 5.40000619366765e-05, "evaluation_iteration": 0.1439098750706762, "synch_eval_env_connectors": 0.00021983403712511063, "synch_env_connectors": 6.124959327280521e-06}, "env_runners": {"module_to_env_connector": {"connector_pipeline_timer": 0.00016198563153480388, "timers": {"connectors": {"remove_single_ts_time_rank_from_batch": 1.4919482580638343e-05, "un_batch_to_individual_items": 8.069183565612579e-06, "get_actions": 5.999361146311398e-05, "tensor_to_numpy": 2.064260088300932e-05, "listify_data_for_vector_env": 1.371876270906794e-05, "normalize_and_clip_actions": 1.051904101539748e-05}}}, "rlmodule_inference_timer": 4.537869391345688e-05, "sample": 0.009714681765949675, "weights_seq_no": 1.0, "num_agent_steps_sampled": {"default_agent": 5000.0}, "episode_len_mean": 20.0, "episode_len_max": 20, "env_to_module_connector": {"timers": {"connectors": {"batch_individual_items": 1.705007612718894e-05, "add_states_from_episodes_to_batch": 3.311452124573968e-06, "numpy_to_tensor": 1.8443514109505906e-05, "add_observations_from_episodes_to_batch": 3.6906834849564902e-06, "add_time_dim_to_batch_and_zero_pad": 9.18548563183301e-06}}, "connector_pipeline_timer": 7.916683640715042e-05}, "env_to_module_sum_episodes_length_out": 10.36823839457432, "num_agent_steps_sampled_lifetime": {"default_agent": 10000.0}, "episode_return_mean": 0.4600000000000001, "num_module_steps_sampled_lifetime": {"default_policy": 10000.0}, "num_episodes": 250.0, "time_between_sampling": 0.037620457199809734, "num_env_steps_sampled_lifetime": 10000.0, "episode_return_min": -10.5, "env_reset_timer": 7.956588324981967e-05, "env_to_module_sum_episodes_length_in": 10.36823839457432, "num_episodes_lifetime": 500.0, "agent_episode_returns_mean": {"default_agent": 0.4600000000000001}, "episode_len_min": 20, "episode_duration_sec_mean": 0.007124573846813294, "env_step_timer": 2.008130880183919e-05, "episode_return_max": 9.5, "num_module_steps_sampled": {"default_policy": 5000.0}, "module_episode_returns_mean": {"default_policy": 0.4600000000000001}, "num_env_steps_sampled": 5000.0, "num_env_steps_sampled_lifetime_throughput": 2536.1887696571976}, "__all_modules__": {"learner_connector_sum_episodes_length_in": 5000.0, "learner_connector": {"connector_pipeline_timer": 0.16317638830747455, "timers": {"connectors": {"add_one_ts_to_episodes_and_truncate": 0.009350457038963214, "add_observations_from_episodes_to_batch": 0.0016748402535449714, "add_columns_from_episodes_to_train_batch": 0.05012584512238391, "add_time_dim_to_batch_and_zero_pad": 0.08586905278614722, "add_states_from_episodes_to_batch": 0.009246013754745945, "batch_individual_items": 0.006552282938500867, "numpy_to_tensor": 9.863246581517159e-05}}}, "learner_connector_sum_episodes_length_out": 5250.0}, "learners": {"default_policy": {"curr_entropy_coeff": 0.0015431216992, "curr_kl_coeff": 0.040395982563495636, "num_module_steps_trained_lifetime": 11970, "entropy": 0.6903855800628662, "num_module_steps_trained": 5985, "diff_num_grad_updates_vs_sampler_policy": 1.0, "vf_loss": 0.3583933711051941, "vf_loss_unclipped": 42.97648239135742, "policy_loss": -0.0003048717917408794, "use_intrinsic_rewards": 0.0, "total_loss": 0.2778373956680298, "vf_explained_var": -0.0028808116912841797, "mean_kl_loss": 1.1085957339673769e-05, "weights_seq_no": 2.0, "num_trainable_parameters": 16595, "module_train_batch_size_mean": 997.9429069707118, "num_module_steps_trained_lifetime_throughput": 775.2042993745322}, "intrinsic_reward_module": {"num_module_steps_trained_lifetime": 11970, "num_module_steps_trained": 5985, "diff_num_grad_updates_vs_sampler_policy": 1.0, "total_loss": 0.0, "gradients_default_optimizer_global_norm": 0.0, "module_train_batch_size_mean": 997.9429069707118, "default_optimizer_learning_rate": 0.0002715581955, "weights_seq_no": 2.0, "num_trainable_parameters": 8266, "curr_entropy_coeff": 0.0015431216992, "num_module_steps_trained_lifetime_throughput": 775.2199820067478}, "differentiable_learners": {"intrinsic_attention_ppo_learner": {"default_policy": {"weights_seq_no": 12.0, "num_module_steps_trained": 35910, "num_module_steps_trained_lifetime": 71820, "entropy": 0.6904065608978271, "diff_num_grad_updates_vs_sampler_policy": 11.0, "vf_loss": 0.3585817217826843, "vf_loss_unclipped": 43.07175064086914, "total_loss": 0.2780013382434845, "mean_kl_loss": 9.785255315364338e-06, "policy_loss": -0.0002883467823266983, "use_intrinsic_rewards": 1.0, "module_train_batch_size_mean": 997.7412016936058, "vf_explained_var": -0.0017294883728027344}, "__all_modules__": {"num_env_steps_trained": 198000, "num_module_steps_trained": 71820, "num_module_steps_trained_lifetime": 143640, "num_env_steps_trained_lifetime": 396000, "num_env_steps_trained_lifetime_throughput": 37914.0295969062}, "intrinsic_reward_module": {"weights_seq_no": 12.0, "num_module_steps_trained_lifetime": 71820, "num_module_steps_trained": 35910, "diff_num_grad_updates_vs_sampler_policy": 11.0, "total_loss": 0.0, "module_train_batch_size_mean": 997.7412016936058}}}, "__all_modules__": {"num_env_steps_trained_lifetime": 66000, "num_non_trainable_parameters": 0, "num_trainable_parameters": 24861, "num_env_steps_trained": 33000, "num_module_steps_trained": 11970, "num_module_steps_trained_lifetime": 23940, "num_env_steps_trained_lifetime_throughput": 4276.230109115267, "num_module_steps_trained_throughput": 29407519.21018807, "num_module_steps_trained_lifetime_throughput": 13477897.015191253}, "IntrinsicAttentionMask": [[[0.09239070117473602, 0.09240035712718964, 0.08961287140846252, 0.08962225168943405, 0.09140682220458984, 0.0914163887500763, 0.09065325558185577, 0.08965975046157837, 0.0924680307507515, 0.09068170189857483, 0.08968788385391235], [0.09239724278450012, 0.09240695089101791, 0.08960717916488647, 0.08961658924818039, 0.09140899032354355, 0.09141859412193298, 0.09065210074186325, 0.08965425938367844, 0.09247492253780365, 0.09068067371845245, 0.08968251198530197], [0.09048844128847122, 0.09048574417829514, 0.09127959609031677, 0.0912768766283989, 0.09076512604951859, 0.0907624140381813, 0.09097964316606522, 0.09126598387956619, 0.09046686440706253, 0.09097149968147278, 0.09125782549381256], [0.09049493819475174, 0.09049227833747864, 0.09127387404441833, 0.09127119183540344, 0.09076735377311707, 0.09076469391584396, 0.09097856283187866, 0.09126047790050507, 0.09047368168830872, 0.09097054600715637, 0.09125243127346039], [0.09172167629003525, 0.09172694385051727, 0.09019649028778076, 0.09020167589187622, 0.0911838710308075, 0.09118910878896713, 0.0907701775431633, 0.09022240340709686, 0.09176383912563324, 0.09078583121299744, 0.09023795276880264], [0.09172821044921875, 0.09173351526260376, 0.09019079059362411, 0.09019601345062256, 0.09118606150150299, 0.09119134396314621, 0.09076905250549316, 0.09021690487861633, 0.0917707085609436, 0.09078482538461685, 0.09023258090019226], [0.09120576828718185, 0.09120767563581467, 0.09064844995737076, 0.09065035730600357, 0.09100992232561111, 0.09101182967424393, 0.09085877984762192, 0.09065797179937363, 0.09122108668088913, 0.09086450189352036, 0.09066367894411087], [0.09052089601755142, 0.09051840752363205, 0.09125098586082458, 0.09124847501516342, 0.09077627956867218, 0.09077378362417221, 0.09097424149513245, 0.09123843163251877, 0.09050096571445465, 0.09096673130989075, 0.09123089909553528], [0.0924430713057518, 0.09245307743549347, 0.08956731110811234, 0.08957701176404953, 0.09142415225505829, 0.0914340540766716, 0.09064400941133499, 0.08961581438779831, 0.09252317249774933, 0.09067345410585403, 0.08964492380619049], [0.0912252888083458, 0.09122733771800995, 0.09063131362199783, 0.0906333401799202, 0.09101653844118118, 0.09101857990026474, 0.0908554419875145, 0.09064145386219025, 0.09124162793159485, 0.09086154401302338, 0.09064754098653793], [0.09054035693407059, 0.09053799510002136, 0.09123381227254868, 0.09123142808675766, 0.09078295528888702, 0.0907805860042572, 0.09097098559141159, 0.091221883893013, 0.0905214324593544, 0.09096384793519974, 0.09121473878622055]], [[0.0942363515496254, 0.09125799685716629, 0.09126799553632736, 0.0931742787361145, 0.09318449348211288, 0.09129802882671356, 0.09237921983003616, 0.09321515262126923, 0.07512255012989044, 0.09228195995092392, 0.09258197993040085], [0.0901157557964325, 0.09078384190797806, 0.0907815545797348, 0.09035097807645798, 0.09034870564937592, 0.09077468514442444, 0.09052922576665878, 0.09034186601638794, 0.09493862092494965, 0.09055116772651672, 0.09048359096050262], [0.09013034403324127, 0.09078628569841385, 0.09078403562307358, 0.09036129713058472, 0.09035906195640564, 0.09077730029821396, 0.09053631126880646, 0.09035234898328781, 0.09486363083124161, 0.09055785089731216, 0.09049150347709656], [0.09281566739082336, 0.09114404022693634, 0.0911496952176094, 0.09222224354743958, 0.09222795814275742, 0.0911666676402092, 0.09177608042955399, 0.09224513173103333, 0.08164110034704208, 0.09172138571739197, 0.09189001470804214], [0.09282957762479782, 0.09114541113376617, 0.09115110337734222, 0.09223166853189468, 0.0922374352812767, 0.09116820245981216, 0.09178216010332108, 0.09225473552942276, 0.08157563954591751, 0.09172705560922623, 0.09189695864915848], [0.09017407149076462, 0.09079359471797943, 0.09079147130250931, 0.09039223194122314, 0.09039012342691422, 0.09078510850667953, 0.0905575305223465, 0.09038378298282623, 0.09463899582624435, 0.0905778706073761, 0.09051521122455597], [0.09171765297651291, 0.09102016687393188, 0.0910225361585617, 0.09147088974714279, 0.09147327393293381, 0.09102965891361237, 0.09128474444150925, 0.09148041903972626, 0.08690644055604935, 0.09126189351081848, 0.0913323387503624], [0.0928713008761406, 0.09114948660135269, 0.09115531295537949, 0.0922599509358406, 0.09226584434509277, 0.09117278456687927, 0.09180039167404175, 0.09228353202342987, 0.08137956261634827, 0.09174405783414841, 0.0919177457690239], [0.0578266903758049, 0.07400670647621155, 0.07394439727067947, 0.06308724731206894, 0.06303413212299347, 0.07375777512788773, 0.06738004833459854, 0.06287504732608795, 0.3299057185649872, 0.06792749464511871, 0.06625472009181976], [0.09158121794462204, 0.09100259840488434, 0.09100457280874252, 0.09137658774852753, 0.09137856960296631, 0.09101047366857529, 0.09122218191623688, 0.09138450026512146, 0.08757441490888596, 0.09120321273803711, 0.09126166254281998], [0.0920005813241005, 0.09105505794286728, 0.09105827659368515, 0.09166577458381653, 0.091669000685215, 0.09106791019439697, 0.09141343832015991, 0.09167870134115219, 0.08553088456392288, 0.0913824662566185, 0.09147792309522629]], [[0.09229815751314163, 0.09128662943840027, 0.08952312171459198, 0.09053404629230499, 0.09233677387237549, 0.0923464372754097, 0.09056245535612106, 0.08956994861364365, 0.09135348349809647, 0.09059087932109833, 0.08959805220365524], [0.09165264666080475, 0.09111280739307404, 0.09016495943069458, 0.09070935845375061, 0.09167320281267166, 0.09167834371328354, 0.09072461724281311, 0.09019023925065994, 0.09114857017993927, 0.09073987603187561, 0.09020540863275528], [0.09051461517810822, 0.0907994955778122, 0.09130599349737167, 0.09101409465074539, 0.09050381183624268, 0.09050111472606659, 0.09100595116615295, 0.0912923738360405, 0.09078054130077362, 0.09099780768156052, 0.09128421545028687], [0.09116895496845245, 0.09098070859909058, 0.09064842015504837, 0.09083954989910126, 0.0911761149764061, 0.09117790311574936, 0.09084489196538925, 0.0906573086977005, 0.09099320322275162, 0.09085024148225784, 0.0906626433134079], [0.0923227071762085, 0.09129318594932556, 0.08949879556894302, 0.09052734822034836, 0.09236201643943787, 0.09237184375524521, 0.09055625647306442, 0.08954643458127975, 0.09136121720075607, 0.09058517962694168, 0.08957502990961075], [0.09232883155345917, 0.09129481762647629, 0.08949270844459534, 0.09052567183971405, 0.09236831963062286, 0.09237819164991379, 0.09055469930171967, 0.08954054862260818, 0.09136315435171127, 0.09058374166488647, 0.08956927061080933], [0.09118727594614029, 0.0909857451915741, 0.09063007682561874, 0.09083463996648788, 0.09119493514299393, 0.09119684994220734, 0.09084036201238632, 0.09063959121704102, 0.09099911153316498, 0.09084608405828476, 0.09064530581235886], [0.09054503589868546, 0.09080798178911209, 0.09127531945705414, 0.09100601077079773, 0.09053506702184677, 0.0905325785279274, 0.09099850058555603, 0.09126276522874832, 0.09079048782587051, 0.09099098294973373, 0.09125522524118423], [0.09169546514749527, 0.09112441539764404, 0.09012225270271301, 0.0906977728009224, 0.09171721339225769, 0.09172265231609344, 0.09071391075849533, 0.09014897048473358, 0.09116224199533463, 0.09073004871606827, 0.09016501158475876], [0.09120558947324753, 0.09099076688289642, 0.09061173349618912, 0.09082973003387451, 0.09121375530958176, 0.09121579676866531, 0.0908358246088028, 0.09062187373638153, 0.09100502729415894, 0.09084192663431168, 0.09062796086072922], [0.09056329727172852, 0.09081307053565979, 0.09125692397356033, 0.09100116789340973, 0.09055382758378983, 0.09055145829916, 0.09099403023719788, 0.09124499559402466, 0.09079646319150925, 0.09098689258098602, 0.09123784303665161]], [[0.09207367151975632, 0.09103760868310928, 0.0910431295633316, 0.0920904353260994, 0.09269227087497711, 0.09105970710515976, 0.09165480732917786, 0.09211277961730957, 0.0822751447558403, 0.09219445288181305, 0.09176605939865112], [0.09040273725986481, 0.09082897752523422, 0.09082668274641037, 0.09039589762687683, 0.09015146642923355, 0.0908198133111, 0.0905742347240448, 0.0903867781162262, 0.09473136812448502, 0.09035348892211914, 0.09052857011556625], [0.09041209518909454, 0.09083057194948196, 0.0908283218741417, 0.09040537476539612, 0.09016537666320801, 0.09082157909870148, 0.09058047086000443, 0.09039642661809921, 0.09466029703617096, 0.09036374092102051, 0.09053564816713333], [0.09209932386875153, 0.0910395160317421, 0.09104516357183456, 0.09211647510528564, 0.09273223578929901, 0.09106210619211197, 0.09167082607746124, 0.0921393409371376, 0.08208748698234558, 0.09222289174795151, 0.09178463369607925], [0.09299350529909134, 0.09107960760593414, 0.09108976274728775, 0.09302461892366409, 0.09414487332105637, 0.09112023562192917, 0.09221756458282471, 0.09306611120700836, 0.07562258839607239, 0.09321779757738113, 0.09242337197065353], [0.09044017642736435, 0.09083537757396698, 0.09083325415849686, 0.09043383598327637, 0.09020713716745377, 0.09082688391208649, 0.09059920161962509, 0.09042537212371826, 0.09444741159677505, 0.0903945043683052, 0.09055686742067337], [0.09141850471496582, 0.09097515791654587, 0.09097752720117569, 0.09142565727233887, 0.09168186038732529, 0.09098464250564575, 0.09123961627483368, 0.09143519401550293, 0.08710461854934692, 0.09147000312805176, 0.09128717333078384], [0.09213347733020782, 0.09104198962450027, 0.09104780852794647, 0.09215114265680313, 0.09278548508882523, 0.09106526523828506, 0.09169212728738785, 0.09217469394207001, 0.08183789253234863, 0.09226076304912567, 0.09180934727191925], [0.06744775176048279, 0.07820452004671097, 0.07814250141382217, 0.06728741526603699, 0.06179327890276909, 0.07795675098896027, 0.07159143686294556, 0.06707422435283661, 0.29373592138290405, 0.06630144268274307, 0.07046476006507874], [0.09225764125585556, 0.09105037897825241, 0.09105680882930756, 0.09227718412876129, 0.09297952055931091, 0.09107609838247299, 0.09176929295063019, 0.09230325371026993, 0.08093227446079254, 0.09239852428436279, 0.09189897030591965], [0.09159515798091888, 0.09099455177783966, 0.09099775552749634, 0.09160485118627548, 0.09195241332054138, 0.09100738912820816, 0.0913526862859726, 0.09161777794361115, 0.0857953205704689, 0.09166499227285385, 0.09141713380813599]], [[0.09101956337690353, 0.09117457270622253, 0.09076911956071854, 0.09023886173963547, 0.09173073619604111, 0.09119486063718796, 0.09025391191244125, 0.09079436212778091, 0.09121006727218628, 0.09080445766448975, 0.09080950170755386], [0.09104727953672409, 0.09124168008565903, 0.09073337912559509, 0.0900694876909256, 0.09193982928991318, 0.09126711636781693, 0.09008832275867462, 0.09076499938964844, 0.09128620475530624, 0.09077765792608261, 0.0907839834690094], [0.09097443521022797, 0.09106576442718506, 0.09082674980163574, 0.09051351249217987, 0.09139290452003479, 0.09107770770788193, 0.0905224159359932, 0.09084164351224899, 0.09108667075634003, 0.09084760397672653, 0.0908505767583847], [0.09087752550840378, 0.09083378314971924, 0.09094839543104172, 0.09109927713871002, 0.09067763388156891, 0.0908280685544014, 0.0910949781537056, 0.09094123542308807, 0.09082377701997757, 0.09093837440013885, 0.09093695133924484], [0.09114543348550797, 0.09148091822862625, 0.09060481190681458, 0.08946585655212402, 0.09269002825021744, 0.09152486175298691, 0.08949808031320572, 0.09065921604633331, 0.09155783802270889, 0.09068098664283752, 0.09069187194108963], [0.0910509005188942, 0.0912504494190216, 0.09072870761156082, 0.09004737436771393, 0.09196719527244568, 0.09127656370401382, 0.09006670862436295, 0.09076116979122162, 0.09129615873098373, 0.09077415615320206, 0.09078064560890198], [0.09088029712438583, 0.0908403992652893, 0.09094494581222534, 0.09108256548643112, 0.09069793671369553, 0.09083518385887146, 0.09107864648103714, 0.09093841910362244, 0.09083127230405807, 0.09093581140041351, 0.09093450754880905], [0.09097900241613388, 0.09107674658298492, 0.09082094579935074, 0.09048576653003693, 0.09142694622278214, 0.09108953177928925, 0.09049529582262039, 0.09083688259124756, 0.09109912067651749, 0.09084326028823853, 0.09084644913673401], [0.09105360507965088, 0.0912570133805275, 0.09072519093751907, 0.09003078192472458, 0.09198770672082901, 0.0912836343050003, 0.09005047380924225, 0.09075827151536942, 0.09130360931158066, 0.09077151119709015, 0.09077812731266022], [0.09098082780838013, 0.0910811498761177, 0.0908186286687851, 0.0904746800661087, 0.09144057333469391, 0.09109427034854889, 0.09048445522785187, 0.09083498269319534, 0.09110411256551743, 0.09084152430295944, 0.09084479510784149], [0.09098174422979355, 0.0910833403468132, 0.09081746637821198, 0.090469129383564, 0.0914473831653595, 0.09109663218259811, 0.09047903120517731, 0.09083402901887894, 0.0911066010594368, 0.0908406525850296, 0.09084396809339523]], [[0.09364710003137589, 0.09068736433982849, 0.09176132827997208, 0.09367790818214417, 0.09260182082653046, 0.09179151803255081, 0.09180158376693726, 0.0937190055847168, 0.07552861422300339, 0.09278076887130737, 0.09200307726860046], [0.09024818241596222, 0.09091724455356598, 0.09067140519618988, 0.09024135768413544, 0.0904814675450325, 0.09066455066204071, 0.09066226333379745, 0.090232253074646, 0.0948234349489212, 0.09044130146503448, 0.09061655402183533], [0.09153258800506592, 0.09088551998138428, 0.09112218767404556, 0.09153924137353897, 0.09130591154098511, 0.09112881869077682, 0.09113101661205292, 0.09154810756444931, 0.0872865691781044, 0.09134485572576523, 0.09117516875267029], [0.093680240213871, 0.09068276733160019, 0.09177028387784958, 0.09371145069599152, 0.09262149780988693, 0.09180086106061935, 0.09181105345487595, 0.09375308454036713, 0.07535094767808914, 0.0928027406334877, 0.0920151099562645], [0.09249628335237503, 0.09081815928220749, 0.09142976999282837, 0.09251362830400467, 0.09190626442432404, 0.09144691377878189, 0.09145262837409973, 0.09253676980733871, 0.08182503283023834, 0.09200748056173325, 0.0915670096874237], [0.09156782180070877, 0.09088373184204102, 0.09113391488790512, 0.09157485514879227, 0.09132814407348633, 0.09114091098308563, 0.09114324301481247, 0.0915842354297638, 0.08708394318819046, 0.09136932343244553, 0.0911899134516716], [0.09157955646514893, 0.09088312089443207, 0.09113780409097672, 0.09158671647310257, 0.09133554250001907, 0.09114493429660797, 0.09114730358123779, 0.09159626811742783, 0.0870165005326271, 0.09137746691703796, 0.09119482338428497], [0.09372439980506897, 0.09067657589912415, 0.09178216755390167, 0.09375613927841187, 0.09264767915010452, 0.09181325137615204, 0.09182361513376236, 0.09379848092794418, 0.0751146674156189, 0.09283199161291122, 0.0920310840010643], [0.06348294764757156, 0.08008837699890137, 0.07354902476072311, 0.06333202868700027, 0.06885364651679993, 0.0733741819858551, 0.07331599295139313, 0.06313137710094452, 0.30081167817115784, 0.06789856404066086, 0.07216217368841171], [0.09269697219133377, 0.09079933911561966, 0.09149042516946793, 0.09271661192178726, 0.09202926605939865, 0.09150981158018112, 0.09151627123355865, 0.09274280816316605, 0.08070913702249527, 0.09214376658201218, 0.09164558351039886], [0.09181340783834457, 0.09086981415748596, 0.09121458232402802, 0.09182312339544296, 0.0914825052022934, 0.09122423827648163, 0.0912274494767189, 0.09183607995510101, 0.08567771315574646, 0.09153933078050613, 0.09129181504249573]]]}, "num_training_step_calls_per_iteration": 1, "evaluation": {"env_runners": {"module_to_env_connector": {"timers": {"connectors": {"tensor_to_numpy": 1.5850352151214184e-05, "un_batch_to_individual_items": 6.614960331018209e-06, "get_actions": 3.8104276809457754e-05, "listify_data_for_vector_env": 1.044380277311601e-05, "normalize_and_clip_actions": 8.122685509503221e-06, "remove_single_ts_time_rank_from_batch": 1.2036946224782677e-05}}, "connector_pipeline_timer": 0.0001176966431955207}, "episode_len_min": 20, "num_env_steps_sampled": 400, "weights_seq_no": 2.0, "episode_len_mean": 20.0, "env_to_module_sum_episodes_length_out": 10.366003441359926, "episode_len_max": 20, "env_to_module_connector": {"timers": {"connectors": {"batch_individual_items": 1.2428984355092241e-05, "add_observations_from_episodes_to_batch": 2.863879410287575e-06, "add_states_from_episodes_to_batch": 2.7877011993265556e-06, "add_time_dim_to_batch_and_zero_pad": 7.096401204878231e-06, "numpy_to_tensor": 1.2310125313661792e-05}}, "connector_pipeline_timer": 5.9843123166917416e-05}, "env_to_module_sum_episodes_length_in": 10.366003441359926, "num_episodes_lifetime": 40, "episode_duration_sec_mean": 0.005750137593713589, "episode_return_max": 12.5, "rlmodule_inference_timer": 3.170576241611486e-05, "num_agent_steps_sampled": {"default_agent": 400}, "num_module_steps_sampled_lifetime": {"default_policy": 800}, "num_agent_steps_sampled_lifetime": {"default_agent": 800}, "num_module_steps_sampled": {"default_policy": 400}, "sample": 0.13187670780462213, "episode_return_mean": -2.3, "env_step_timer": 1.424600708217394e-05, "agent_episode_returns_mean": {"default_agent": -2.3}, "num_episodes": 20, "module_episode_returns_mean": {"default_policy": -2.3}, "episode_return_min": -12.5, "num_env_steps_sampled_lifetime": 10400, "env_reset_timer": 0.0005771608056966215, "time_between_sampling": 12.540602749912068}, "num_healthy_workers": 1, "actor_manager_num_outstanding_async_reqs": 0, "num_remote_worker_restarts": 0}, "num_env_steps_sampled_lifetime": 10000.0, "fault_tolerance": {"num_healthy_workers": 0, "num_remote_worker_restarts": 0}, "env_runner_group": {"actor_manager_num_outstanding_async_reqs": 0}, "done": false, "training_iteration": 2, "trial_id": "ae8a2_00000", "date": "2025-08-11_18-22-52", "timestamp": 1754929372, "time_this_iter_s": 12.62079381942749, "time_total_s": 25.415077924728394, "pid": 10870, "hostname": "Mac", "node_ip": "127.0.0.1", "config": {"exploration_config": {}, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 2, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "env": "Umbrella", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": false, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 0, "create_local_env_runner": true, "num_envs_per_env_runner": 1, "gym_env_vectorize_mode": "SYNC", "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "episodes_to_numpy": true, "max_requests_in_flight_per_env_runner": 1, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "merge_env_runner_states": "training_only", "broadcast_env_runner_states": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "complete_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "sampler_perf_stats_ema_coef": null, "_is_online": true, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": "auto", "num_aggregator_actors_per_learner": 0, "max_requests_in_flight_per_aggregator_actor": 3, "local_gpu_idx": 0, "max_requests_in_flight_per_learner": 3, "gamma": 1, "lr": 0.0002715581955, "grad_clip": 0.5, "grad_clip_by": "global_norm", "_train_batch_size_per_learner": 5000, "train_batch_size": 4000, "num_epochs": 1, "minibatch_size": 1000, "shuffle_batch_per_epoch": true, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "log_std_clip_param": 20.0, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "_disable_preprocessor_api": false, "_disable_action_flattening": false}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {"intrinsic_reward_coeff": 0.2795015916508}, "optimizer": {}, "_learner_class": "<class 'source.intrinsic_attention_ppo.learners.IntrinsicAttentionMetaLearner.IntrinsicAttentionMetaLearner'>", "callbacks_on_algorithm_init": null, "callbacks_on_env_runners_recreated": null, "callbacks_on_offline_eval_runners_recreated": null, "callbacks_on_checkpoint_loaded": null, "callbacks_on_environment_created": null, "callbacks_on_episode_created": null, "callbacks_on_episode_start": null, "callbacks_on_episode_step": null, "callbacks_on_episode_end": null, "callbacks_on_evaluate_start": null, "callbacks_on_evaluate_end": null, "callbacks_on_evaluate_offline_start": null, "callbacks_on_evaluate_offline_end": null, "callbacks_on_sample_end": null, "callbacks_on_train_result": null, "explore": true, "enable_rl_module_and_learner": true, "enable_env_runner_and_connector_v2": true, "_prior_exploration_config": {"type": "StochasticSampling"}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x38844d8a0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "offline_data_class": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_read_batch_size": null, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "materialize_data": false, "materialize_mapped_data": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "ignore_final_observation": false, "prelearner_class": null, "prelearner_buffer_class": null, "prelearner_buffer_kwargs": {}, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_remaining_data": false, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": 1, "evaluation_duration": 20, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_auto_duration_min_env_steps_per_sample": 100, "evaluation_auto_duration_max_env_steps_per_sample": 2000, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 1, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "offline_evaluation_interval": null, "num_offline_eval_runners": 0, "offline_loss_for_module_fn": null, "offline_evaluation_duration": 1, "offline_evaluation_parallel_to_training": false, "offline_evaluation_timeout_s": 120.0, "num_cpus_per_offline_eval_runner": 1, "num_gpus_per_offline_eval_runner": 0, "custom_resources_per_offline_eval_runner": {}, "restart_failed_offline_eval_runners": true, "ignore_offline_eval_runner_failures": false, "max_num_offline_eval_runner_restarts": 1000, "offline_eval_runner_restore_timeout_s": 1800.0, "max_requests_in_flight_per_offline_eval_runner": 1, "validate_offline_eval_runners_after_construction": true, "offline_eval_runner_health_probe_timeout_s": 30.0, "offline_eval_rl_module_inference_only": false, "broadcast_offline_eval_runner_states": false, "offline_eval_batch_size_per_runner": 256, "dataset_num_iters_per_eval_runner": 1, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "log_gradients": false, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 1, "restart_failed_env_runners": true, "ignore_env_runner_failures": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30.0, "env_runner_restore_timeout_s": 1800.0, "_model_config": {}, "_rl_module_spec": "MultiRLModuleSpec(multi_rl_module_class=<class 'ray.rllib.core.rl_module.multi_rl_module.MultiRLModule'>, observation_space=None, action_space=None, inference_only=False, model_config=None, rl_module_specs={'default_policy': RLModuleSpec(module_class=<class 'source.intrinsic_attention_ppo.rl_modules.DifferentiablePPOModule.DifferentiablePPOModule'>, observation_space=None, action_space=None, inference_only=False, learner_only=False, model_config={'vf_share_layers': True, 'embedding_dim': 62, 'max_seq_len': 11, 'policy_head_hidden_sizes': [32], 'value_head_hidden_sizes': [101], 'embedding_hidden_sizes': [121]}, catalog_class=None, load_state_path=None, model_config_dict=None), 'intrinsic_reward_module': RLModuleSpec(module_class=<class 'source.intrinsic_attention_ppo.rl_modules.IntrinsicAttentionModule.IntrinsicAttentionModule'>, observation_space=None, action_space=None, inference_only=False, learner_only=True, model_config={'intrinsic_reward_network': {'encoder_hidden_sizes': [], 'encoding_dim': 1, 'num_heads': 1, 'head_hidden_sizes': None, 'layers': [{'type': 'attention'}]}, 'extrinsic_value_hidden_layers': [127, 60], 'vf_share_layers': True, 'max_seq_len': 11}, catalog_class=None, load_state_path=None, model_config_dict=None)}, load_state_path=None, modules_to_load=None, module_specs={'default_policy': RLModuleSpec(module_class=<class 'source.intrinsic_attention_ppo.rl_modules.DifferentiablePPOModule.DifferentiablePPOModule'>, observation_space=None, action_space=None, inference_only=False, learner_only=False, model_config={'vf_share_layers': True, 'embedding_dim': 62, 'max_seq_len': 11, 'policy_head_hidden_sizes': [32], 'value_head_hidden_sizes': [101], 'embedding_hidden_sizes': [121]}, catalog_class=None, load_state_path=None, model_config_dict=None), 'intrinsic_reward_module': RLModuleSpec(module_class=<class 'source.intrinsic_attention_ppo.rl_modules.IntrinsicAttentionModule.IntrinsicAttentionModule'>, observation_space=None, action_space=None, inference_only=False, learner_only=True, model_config={'intrinsic_reward_network': {'encoder_hidden_sizes': [], 'encoding_dim': 1, 'num_heads': 1, 'head_hidden_sizes': None, 'layers': [{'type': 'attention'}]}, 'extrinsic_value_hidden_layers': [127, 60], 'vf_share_layers': True, 'max_seq_len': 11}, catalog_class=None, load_state_path=None, model_config_dict=None)})", "algorithm_config_overrides_per_module": {"intrinsic_reward_module": {"lr": 0.0002715581955}}, "_per_module_overrides": {}, "_validate_config": true, "_use_msgpack_checkpoints": false, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "env_task_fn": -1, "enable_connectors": -1, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.161583927863, "kl_target": 0.0201019014258, "vf_loss_coeff": 0.7790510010087, "entropy_coeff": 0.0015431216992, "clip_param": 0.2459212356676, "vf_clip_param": 0.3769744131561, "entropy_coeff_schedule": null, "lr_schedule": null, "sgd_minibatch_size": -1, "vf_share_layers": -1, "differentiable_learner_configs": ["DifferentiableLearnerConfig(learner_class=<class 'source.intrinsic_attention_ppo.learners.IntrinsicAttentionPPOLearner.IntrinsicAttentionPPOLearner'>, learner_connector=None, add_default_connectors_to_learner_pipeline=True, is_multi_agent=False, policies_to_update=['default_policy'], lr=0.0060984166342, num_total_minibatches=0, num_epochs=1, minibatch_size=1000, shuffle_batch_per_epoch=True)"], "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9485408017724, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.callbacks.callbacks.RLlibCallback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 25.415077924728394, "iterations_since_restore": 2, "perf": {"cpu_util_percent": 66.03333333333335, "ram_util_percent": 81.96666666666667}}
{"timers": {"training_iteration": 12.656519201931998, "restore_env_runners": 1.2725895247422158e-05, "training_step": 12.656328285414528, "env_runner_sampling_timer": 2.9418747253434967, "learner_update_timer": 9.495031662528483, "synch_weights": 0.0016484118263004346, "restore_eval_env_runners": 5.397922126576304e-05, "evaluation_iteration": 0.14379134339978916, "synch_eval_env_connectors": 0.00021977444645017384, "synch_env_connectors": 6.114540155977011e-06}, "env_runners": {"module_to_env_connector": {"connector_pipeline_timer": 0.00014815412446901632, "timers": {"connectors": {"remove_single_ts_time_rank_from_batch": 1.3820829942548486e-05, "un_batch_to_individual_items": 7.441290392947865e-06, "get_actions": 5.372324809353962e-05, "tensor_to_numpy": 1.881824693622265e-05, "listify_data_for_vector_env": 1.2575458715393e-05, "normalize_and_clip_actions": 9.7552616014436e-06}}}, "rlmodule_inference_timer": 4.1135016037357e-05, "sample": 0.007629324762310138, "weights_seq_no": 2.0, "num_agent_steps_sampled": {"default_agent": 5000.0}, "episode_len_mean": 20.0, "episode_len_max": 20, "env_to_module_connector": {"timers": {"connectors": {"batch_individual_items": 1.4762649887830876e-05, "add_states_from_episodes_to_batch": 3.1216431960773094e-06, "numpy_to_tensor": 1.616839579848177e-05, "add_observations_from_episodes_to_batch": 3.714462739916404e-06, "add_time_dim_to_batch_and_zero_pad": 9.065189726302752e-06}}, "connector_pipeline_timer": 7.323186463768902e-05}, "env_to_module_sum_episodes_length_out": 10.36823839457432, "num_agent_steps_sampled_lifetime": {"default_agent": -607500.0}, "episode_return_mean": 0.7000000000000002, "num_module_steps_sampled_lifetime": {"default_policy": -607500.0}, "num_episodes": 250.0, "time_between_sampling": 0.04174747763117648, "num_env_steps_sampled_lifetime": -607500.0, "episode_return_min": -10.5, "env_reset_timer": 0.00010778010846646057, "env_to_module_sum_episodes_length_in": 10.36823839457432, "num_episodes_lifetime": -30375.0, "agent_episode_returns_mean": {"default_agent": 0.7000000000000002}, "episode_len_min": 20, "episode_duration_sec_mean": 0.006607928496785462, "env_step_timer": 1.8593870472112847e-05, "episode_return_max": 9.5, "num_module_steps_sampled": {"default_policy": 5000.0}, "module_episode_returns_mean": {"default_policy": 0.7000000000000002}, "num_env_steps_sampled": 5000.0, "num_env_steps_sampled_lifetime_throughput": 2932.5507735396413}, "__all_modules__": {"learner_connector_sum_episodes_length_in": 5000.0, "learner_connector": {"connector_pipeline_timer": 0.16299522442449813, "timers": {"connectors": {"add_one_ts_to_episodes_and_truncate": 0.00936823955810396, "add_observations_from_episodes_to_batch": 0.00167821519166464, "add_columns_from_episodes_to_train_batch": 0.05004884292142233, "add_time_dim_to_batch_and_zero_pad": 0.08580674308828311, "add_states_from_episodes_to_batch": 0.009193460697552653, "batch_individual_items": 0.006542980108794291, "numpy_to_tensor": 9.835448182420804e-05}}}, "learner_connector_sum_episodes_length_out": 5250.0}, "learners": {"default_policy": {"curr_entropy_coeff": 0.0015431216992, "curr_kl_coeff": 0.020197991281747818, "num_module_steps_trained_lifetime": 17955, "entropy": 0.6898934245109558, "num_module_steps_trained": 5985, "diff_num_grad_updates_vs_sampler_policy": 1.0, "vf_loss": 0.3583534061908722, "vf_loss_unclipped": 43.16629409790039, "policy_loss": -7.051725697237998e-05, "use_intrinsic_rewards": 0.0, "total_loss": 0.2780410051345825, "vf_explained_var": 0.0005209445953369141, "mean_kl_loss": 1.3203609341871925e-05, "weights_seq_no": 3.0, "num_trainable_parameters": 16595, "module_train_batch_size_mean": 997.9168410861561, "num_module_steps_trained_lifetime_throughput": 770.1337900771769}, "intrinsic_reward_module": {"num_module_steps_trained_lifetime": 17955, "num_module_steps_trained": 5985, "diff_num_grad_updates_vs_sampler_policy": 1.0, "total_loss": 0.0, "gradients_default_optimizer_global_norm": 0.0, "module_train_batch_size_mean": 997.9168410861561, "default_optimizer_learning_rate": 0.0002715581955, "weights_seq_no": 3.0, "num_trainable_parameters": 8266, "curr_entropy_coeff": 0.0015431216992, "num_module_steps_trained_lifetime_throughput": 770.1490518769241}, "differentiable_learners": {"intrinsic_attention_ppo_learner": {"default_policy": {"weights_seq_no": 18.0, "num_module_steps_trained": 35910, "num_module_steps_trained_lifetime": 107730, "entropy": 0.6898980736732483, "diff_num_grad_updates_vs_sampler_policy": 16.0, "vf_loss": 0.35855627059936523, "vf_loss_unclipped": 43.307491302490234, "total_loss": 0.27820149064064026, "mean_kl_loss": 1.2912599231640343e-05, "policy_loss": -6.965163629502058e-05, "use_intrinsic_rewards": 1.0, "module_train_batch_size_mean": 997.6672132667843, "vf_explained_var": -0.0016595125198364258}, "__all_modules__": {"num_env_steps_trained": 198000, "num_module_steps_trained": 71820, "num_module_steps_trained_lifetime": 215460, "num_env_steps_trained_lifetime": 594000, "num_env_steps_trained_lifetime_throughput": 37649.86849113209}, "intrinsic_reward_module": {"weights_seq_no": 18.0, "num_module_steps_trained_lifetime": 107730, "num_module_steps_trained": 35910, "diff_num_grad_updates_vs_sampler_policy": 16.0, "total_loss": 0.0, "module_train_batch_size_mean": 997.6672132667843}}}, "__all_modules__": {"num_env_steps_trained_lifetime": 99000, "num_non_trainable_parameters": 0, "num_trainable_parameters": 24861, "num_env_steps_trained": 33000, "num_module_steps_trained": 11970, "num_module_steps_trained_lifetime": 35910, "num_env_steps_trained_lifetime_throughput": 4248.232471600667, "num_module_steps_trained_throughput": 28712931.98205427, "num_module_steps_trained_lifetime_throughput": 13367168.917515442}, "IntrinsicAttentionMask": [[[0.09101957082748413, 0.09117458760738373, 0.09076912701129913, 0.09077417850494385, 0.09118979424238205, 0.0917358472943306, 0.0907893180847168, 0.09025894105434418, 0.09121008217334747, 0.09026897698640823, 0.09080951660871506], [0.09104730933904648, 0.09124170243740082, 0.09073340147733688, 0.09073972702026367, 0.09126078337430954, 0.09194626659154892, 0.09075871109962463, 0.09009463340044022, 0.09128623455762863, 0.09010719507932663, 0.09078401327133179], [0.09097445011138916, 0.09106577187776566, 0.09082676470279694, 0.09082973748445511, 0.09107473492622375, 0.09139590710401535, 0.09083867073059082, 0.09052538871765137, 0.09108667075634003, 0.09053132683038712, 0.0908505916595459], [0.09097535908222198, 0.09106796979904175, 0.09082559496164322, 0.09082861244678497, 0.0910770520567894, 0.09140275418758392, 0.09083767235279083, 0.09052000194787979, 0.09108916670084, 0.0905260220170021, 0.09084975719451904], [0.09105001389980316, 0.0912482813000679, 0.09072989970445633, 0.09073634445667267, 0.09126773476600647, 0.091966912150383, 0.09075569361448288, 0.09007854014635086, 0.09129368513822556, 0.09009134024381638, 0.09078150242567062], [0.09114641696214676, 0.09148319065570831, 0.09060371667146683, 0.09061463177204132, 0.09151627123355865, 0.09270817041397095, 0.09064740687608719, 0.08950357139110565, 0.09156040102243423, 0.08952514082193375, 0.09069111198186874], [0.09097810089588165, 0.09107456356287003, 0.09082212299108505, 0.09082526713609695, 0.09108403325080872, 0.09142331779003143, 0.09083470702171326, 0.09050386399030685, 0.09109664708375931, 0.09051013737916946, 0.09084729105234146], [0.09088122844696045, 0.090842604637146, 0.09094379842281342, 0.09094253927469254, 0.09083881974220276, 0.09070345014333725, 0.0909387543797493, 0.09107194095849991, 0.09083377569913864, 0.09106940776109695, 0.09093369543552399], [0.09105363488197327, 0.09125705063343048, 0.09072522073984146, 0.09073183685541153, 0.09127701818943024, 0.09199444949626923, 0.09075168520212173, 0.09005707502365112, 0.09130363911390305, 0.0900702103972435, 0.0907781645655632], [0.09088307619094849, 0.09084701538085938, 0.09094150364398956, 0.09094032645225525, 0.09084348380565643, 0.09071707725524902, 0.09093678742647171, 0.09106113761663437, 0.09083877503871918, 0.09105877578258514, 0.09093207120895386], [0.09098175168037415, 0.0910833477973938, 0.09081746637821198, 0.0908207818865776, 0.09109330922365189, 0.09145072102546692, 0.0908307209610939, 0.09048233926296234, 0.0911066085100174, 0.09048893302679062, 0.09084396809339523]], [[0.09008951485157013, 0.08884958922863007, 0.08885619044303894, 0.09010959416627884, 0.09083132445812225, 0.08887600153684616, 0.08958785235881805, 0.09085157513618469, 0.10290055721998215, 0.08952392637729645, 0.08952392637729645], [0.09102392941713333, 0.09122087806463242, 0.09121982008218765, 0.09102077037096024, 0.09090759605169296, 0.09121664613485336, 0.09110323339700699, 0.09090443700551987, 0.08915593475103378, 0.09111338108778, 0.09111338108778], [0.09101942926645279, 0.09120853245258331, 0.09120751917362213, 0.09101638942956924, 0.09090771526098251, 0.09120447188615799, 0.09109558165073395, 0.09090468287467957, 0.08922502398490906, 0.09110531955957413, 0.09110531955957413], [0.090072862803936, 0.0888102799654007, 0.08881700038909912, 0.09009331464767456, 0.09082838147878647, 0.088837169110775, 0.08956199139356613, 0.09084900468587875, 0.10313617438077927, 0.08949689567089081, 0.08949689567089081], [0.0894417092204094, 0.08737847208976746, 0.08738940954208374, 0.08947529643774033, 0.09068543463945389, 0.087422214448452, 0.08860458433628082, 0.09071947634220123, 0.11188706010580063, 0.08849814534187317, 0.08849814534187317], [0.09100589901208878, 0.09117148071527481, 0.09117058664560318, 0.09100323915481567, 0.09090806543827057, 0.09116792678833008, 0.09107258170843124, 0.09090540558099747, 0.08943255990743637, 0.09108111262321472, 0.09108111262321472], [0.09048950672149658, 0.08982200175523758, 0.08982556313276291, 0.09050027281045914, 0.09088680893182755, 0.08983626216650009, 0.09021995216608047, 0.09089762717485428, 0.09715093672275543, 0.09018555283546448, 0.09018555283546448], [0.08942307531833649, 0.08733775466680527, 0.0873488038778305, 0.08945701271295547, 0.09068036079406738, 0.08738196641206741, 0.08857692778110504, 0.09071478247642517, 0.11214061826467514, 0.08846934884786606, 0.08846934884786606], [0.06880685687065125, 0.05819210782647133, 0.058244407176971436, 0.06899253278970718, 0.07597826421260834, 0.058401577174663544, 0.06431493908166885, 0.07618330419063568, 0.34336143732070923, 0.06376230716705322, 0.06376230716705322], [0.09053830057382584, 0.08994462341070175, 0.08994779735803604, 0.09054788202047348, 0.09089143574237823, 0.08995731174945831, 0.0902986228466034, 0.09090105444192886, 0.09643690288066864, 0.09026803076267242, 0.09026803076267242], [0.09053830057382584, 0.08994462341070175, 0.08994779735803604, 0.09054788202047348, 0.09089143574237823, 0.08995731174945831, 0.0902986228466034, 0.09090105444192886, 0.09643690288066864, 0.09026803076267242, 0.09026803076267242]], [[0.09096986800432205, 0.0916653573513031, 0.0907195582985878, 0.09018958359956741, 0.09168065339326859, 0.09168574959039688, 0.09073973447084427, 0.09020964801311493, 0.09116027504205704, 0.09021968394517899, 0.09075992554426193], [0.09103471785783768, 0.09252659231424332, 0.09050093591213226, 0.089376300573349, 0.09255953878164291, 0.09257052093744278, 0.09054391831159592, 0.08941873908042908, 0.09144186973571777, 0.08943996578454971, 0.09058690071105957], [0.09094533324241638, 0.09135467559099197, 0.09079769253730774, 0.09048455208539963, 0.09136366099119186, 0.09136665612459183, 0.09080960601568222, 0.09049641340970993, 0.09105752408504486, 0.09050235152244568, 0.0908215120434761], [0.0908912941813469, 0.09069564938545227, 0.09096217155456543, 0.09111308306455612, 0.09069137275218964, 0.09068994224071503, 0.09095645695924759, 0.09110734611749649, 0.09083754569292068, 0.09110447764396667, 0.09095072746276855], [0.09103608876466751, 0.09254549443721771, 0.09049610793590546, 0.08935852348804474, 0.09257882833480835, 0.09258994460105896, 0.09053958207368851, 0.08940144628286362, 0.09144799411296844, 0.08942291140556335, 0.09058307111263275], [0.09103654325008392, 0.09255179017782211, 0.09049449861049652, 0.08935259282588959, 0.0925852581858635, 0.09259641915559769, 0.0905381366610527, 0.0893956795334816, 0.091450035572052, 0.0894172266125679, 0.09058178961277008], [0.09094732999801636, 0.09137973934412003, 0.09079140424728394, 0.09046072512865067, 0.0913892313838005, 0.0913923978805542, 0.09080398827791214, 0.09047326445579529, 0.09106583893299103, 0.0904795229434967, 0.09081656485795975], [0.09089338034391403, 0.09072062373161316, 0.09095596522092819, 0.09108918160200119, 0.09071684628725052, 0.09071557968854904, 0.09095091372728348, 0.09108412265777588, 0.09084592014551163, 0.09108158946037292, 0.09094585478305817], [0.09098810702562332, 0.09190143644809723, 0.09065992385149002, 0.08996601402759552, 0.09192154556512833, 0.09192824363708496, 0.0906863734126091, 0.08999226242303848, 0.09123793244361877, 0.09000539034605026, 0.09071283042430878], [0.0908944383263588, 0.0907331109046936, 0.09095286577939987, 0.09107723832130432, 0.09072958678007126, 0.09072840213775635, 0.09094814211130142, 0.09107251465320587, 0.0908501148223877, 0.09107015281915665, 0.09094342589378357], [0.09094933420419693, 0.09140480309724808, 0.09078511595726013, 0.0904369056224823, 0.09141480177640915, 0.09141813963651657, 0.09079836308956146, 0.09045010060071945, 0.0910741463303566, 0.09045670181512833, 0.09081161022186279]], [[0.09196460992097855, 0.09092977643013, 0.09093528985977173, 0.09198135137557983, 0.09258247911930084, 0.09154068678617477, 0.09154623746871948, 0.09259933233261108, 0.08217768371105194, 0.09208524972200394, 0.0916573703289032], [0.09044663608074188, 0.09087308496236801, 0.09087079763412476, 0.09043978899717331, 0.09019524604082108, 0.0906205102801323, 0.09061822295188904, 0.0901884213089943, 0.09477739036083221, 0.09039736539125443, 0.0905725359916687], [0.09045521169900894, 0.09087389707565308, 0.09087163954973221, 0.09044849872589111, 0.09020838141441345, 0.09062591940164566, 0.09062367677688599, 0.09020167589187622, 0.09470546245574951, 0.09040683507919312, 0.0905788242816925], [0.0919877290725708, 0.09092920273542404, 0.09093484282493591, 0.09200485050678253, 0.0926198735833168, 0.09155406057834625, 0.0915597453713417, 0.09263711422681808, 0.08198801428079605, 0.09211114048957825, 0.09167341887950897], [0.09278962016105652, 0.09087991714477539, 0.09089004993438721, 0.0928206592798233, 0.09393846243619919, 0.09200511872768402, 0.09201537072658539, 0.09396988898515701, 0.07545676827430725, 0.09301341325044632, 0.0922207310795784], [0.09136418998241425, 0.09092891961336136, 0.0909312441945076, 0.09137120842933655, 0.0916227251291275, 0.09118622541427612, 0.09118855744600296, 0.0916297659277916, 0.08712724596261978, 0.09141474217176437, 0.09123525023460388], [0.09137224406003952, 0.09092912077903748, 0.0909314900636673, 0.09137938171625137, 0.09163545817136765, 0.09119106084108353, 0.09119343757629395, 0.09164262562990189, 0.08706054091453552, 0.09142371267080307, 0.09124097228050232], [0.09281132370233536, 0.09087775647640228, 0.09088801592588425, 0.09284275770187378, 0.0939747616648674, 0.09201695770025253, 0.09202734380960464, 0.09400659054517746, 0.0752812996506691, 0.09303795546293259, 0.0922352746129036], [0.0682486742734909, 0.07913320511579514, 0.07907045632600784, 0.06808643043041229, 0.06252705305814743, 0.07249908149242401, 0.07244158536195755, 0.0623784102499485, 0.29722490906715393, 0.06708876043558121, 0.07130151987075806], [0.09213025867938995, 0.09092466533184052, 0.09093108028173447, 0.0921497792005539, 0.09285113960504532, 0.09163611382246017, 0.0916425883769989, 0.0928708165884018, 0.08082053065299988, 0.09227094799280167, 0.09177207946777344], [0.09153232723474503, 0.09093213081359863, 0.09093533456325531, 0.09154201298952103, 0.09188933670520782, 0.091286800801754, 0.09129001200199127, 0.09189905971288681, 0.0857364609837532, 0.09160210937261581, 0.09135442227125168]], [[0.0923907533288002, 0.09240041673183441, 0.0896129235625267, 0.0906248688697815, 0.09140687435865402, 0.09243907779455185, 0.08965042233467102, 0.08965979516506195, 0.09144512563943863, 0.09068175405263901, 0.08968793600797653], [0.0923973023891449, 0.09240701794624329, 0.08960723876953125, 0.09062360227108002, 0.09140905737876892, 0.09244585037231445, 0.0896449014544487, 0.08965431898832321, 0.09144747257232666, 0.09068073332309723, 0.08968257904052734], [0.09048844128847122, 0.09048573672771454, 0.09127959609031677, 0.09098777920007706, 0.09076511859893799, 0.09047494828701019, 0.09126871079206467, 0.09126598387956619, 0.09075429290533066, 0.09097149968147278, 0.09125782549381256], [0.09118622541427612, 0.09118802100419998, 0.09066558629274368, 0.09085675328969955, 0.09100329875946045, 0.09119517356157303, 0.09067270159721375, 0.090674489736557, 0.0910104364156723, 0.09086744487285614, 0.09067981690168381], [0.09172170609235764, 0.09172696620225906, 0.09019652009010315, 0.09075456112623215, 0.09118389338254929, 0.09174805134534836, 0.09021724760532379, 0.09022242575883865, 0.09120485186576843, 0.09078584611415863, 0.09023797512054443], [0.09242349117994308, 0.09243336319923401, 0.08958445489406586, 0.09061846882104874, 0.09141772240400314, 0.09247289597988129, 0.08962276577949524, 0.08963234722614288, 0.0914568156003952, 0.09067660570144653, 0.08966109156608582], [0.0905144065618515, 0.09051186591386795, 0.09125670790672302, 0.09098295867443085, 0.0907740443944931, 0.09050174057483673, 0.09124649316072464, 0.09124394506216049, 0.0907638818025589, 0.09096768498420715, 0.09123628586530685], [0.09052088856697083, 0.09051840007305145, 0.09125098586082458, 0.09098175168037415, 0.09077627211809158, 0.09050843119621277, 0.09124094247817993, 0.09123843163251877, 0.09076628088951111, 0.09096673130989075, 0.09123089909553528], [0.09174779802560806, 0.09175323694944382, 0.09017368406057358, 0.09074953943490982, 0.09119264036417007, 0.09177500009536743, 0.09019507467746735, 0.09020041674375534, 0.09121426939964294, 0.09078183025121689, 0.09021646529436111], [0.09122529625892639, 0.09122733771800995, 0.09063131362199783, 0.09084935486316681, 0.09101653844118118, 0.09123550355434418, 0.09063942730426788, 0.09064145386219025, 0.09102468937635422, 0.09086155146360397, 0.09064754098653793], [0.09054036438465118, 0.09053800255060196, 0.09123381972312927, 0.09097812324762344, 0.09078296273946762, 0.09052853286266327, 0.09122428297996521, 0.0912218913435936, 0.09077347069978714, 0.09096385538578033, 0.09121474623680115]], [[0.09202004969120026, 0.09098459035158157, 0.09157919883728027, 0.09203679859638214, 0.09204238653182983, 0.09159586578607559, 0.0916014239192009, 0.09205914288759232, 0.08222721517086029, 0.09214075654745102, 0.09171261638402939], [0.09042483568191528, 0.09085117280483246, 0.09060551971197128, 0.09041799604892731, 0.09041570872068405, 0.09059866517782211, 0.09059637784957886, 0.09040886908769608, 0.09475454688072205, 0.09037557244300842, 0.09055070579051971], [0.0913616269826889, 0.09094979614019394, 0.09118662774562836, 0.09136826545000076, 0.09137047827243805, 0.09119325876235962, 0.09119546413421631, 0.09137711673974991, 0.08734831213951111, 0.09140945225954056, 0.09123963862657547], [0.09204447269439697, 0.09098529070615768, 0.09159348905086517, 0.0920616090297699, 0.09206732362508774, 0.09161054342985153, 0.09161622822284698, 0.09208445996046066, 0.08203858882188797, 0.09216796606779099, 0.09172997623682022], [0.09205260872840881, 0.09098552167415619, 0.0915982574224472, 0.09206987917423248, 0.09207563102245331, 0.09161543846130371, 0.09162116050720215, 0.09209290891885757, 0.08197581022977829, 0.09217703342437744, 0.09173575043678284], [0.0913870632648468, 0.09095168113708496, 0.09120205044746399, 0.0913940891623497, 0.09139642864465714, 0.0912090539932251, 0.09121139347553253, 0.09140344709157944, 0.08714906871318817, 0.09143763780593872, 0.09125810116529465], [0.0913955420255661, 0.0909523069858551, 0.09120718389749527, 0.09140268713235855, 0.09140507131814957, 0.09121431410312653, 0.09121669083833694, 0.09141221642494202, 0.08708274364471436, 0.09144702553749084, 0.09126424044370651], [0.09207699447870255, 0.09098616987466812, 0.09161249548196793, 0.09209464490413666, 0.09210053086280823, 0.09163005650043488, 0.09163591265678406, 0.09211818128824234, 0.08178770542144775, 0.09220419824123383, 0.09175305813550949], [0.06793621182441711, 0.07877091318368912, 0.07233912497758865, 0.0677747130393982, 0.06772097200155258, 0.07216715812683105, 0.07210993021726608, 0.06755998730659485, 0.2958643138408661, 0.06678161025047302, 0.07097508013248444], [0.09219519048929214, 0.09098874032497406, 0.09168127179145813, 0.09221472591161728, 0.09222123771905899, 0.09170069545507431, 0.09170717000961304, 0.09224078059196472, 0.08087748289108276, 0.09233597666025162, 0.09183676540851593], [0.09156405180692673, 0.09096364676952362, 0.09130877256393433, 0.09157373756170273, 0.0915769636631012, 0.09131843596696854, 0.09132165461778641, 0.09158666431903839, 0.08576617389917374, 0.0916338562965393, 0.09138607978820801]]]}, "num_training_step_calls_per_iteration": 1, "evaluation": {"env_runners": {"module_to_env_connector": {"timers": {"connectors": {"tensor_to_numpy": 1.5032547729054569e-05, "un_batch_to_individual_items": 6.584506004098823e-06, "get_actions": 3.5709582939474307e-05, "listify_data_for_vector_env": 1.0285487841145248e-05, "normalize_and_clip_actions": 7.975897222233411e-06, "remove_single_ts_time_rank_from_batch": 1.1834984761136324e-05}}, "connector_pipeline_timer": 0.00011360304899097594}, "episode_len_min": 20, "num_env_steps_sampled": 400, "weights_seq_no": 3.0, "episode_len_mean": 20.0, "env_to_module_sum_episodes_length_out": 10.368205581254823, "episode_len_max": 20, "env_to_module_connector": {"timers": {"connectors": {"batch_individual_items": 1.2265257764243576e-05, "add_observations_from_episodes_to_batch": 2.8338777881165555e-06, "add_states_from_episodes_to_batch": 2.7801497099090477e-06, "add_time_dim_to_batch_and_zero_pad": 6.791667630477996e-06, "numpy_to_tensor": 1.175655946561861e-05}}, "connector_pipeline_timer": 5.83832260023286e-05}, "env_to_module_sum_episodes_length_in": 10.368205581254823, "num_episodes_lifetime": 60, "episode_duration_sec_mean": 0.005572292377473786, "episode_return_max": 12.5, "rlmodule_inference_timer": 3.133262868924232e-05, "num_agent_steps_sampled": {"default_agent": 400}, "num_module_steps_sampled_lifetime": {"default_policy": 1200}, "num_agent_steps_sampled_lifetime": {"default_agent": 1200}, "num_module_steps_sampled": {"default_policy": 400}, "sample": 0.13170511572709073, "episode_return_mean": -1.1333333333333333, "env_step_timer": 1.3898658620622077e-05, "agent_episode_returns_mean": {"default_agent": -1.1333333333333333}, "num_episodes": 20, "module_episode_returns_mean": {"default_policy": -1.1333333333333333}, "episode_return_min": -12.5, "num_env_steps_sampled_lifetime": 15400, "env_reset_timer": 0.000574796697392594, "time_between_sampling": 12.5523978649138}, "num_healthy_workers": 1, "actor_manager_num_outstanding_async_reqs": 0, "num_remote_worker_restarts": 0}, "num_env_steps_sampled_lifetime": -607500.0, "fault_tolerance": {"num_healthy_workers": 0, "num_remote_worker_restarts": 0}, "env_runner_group": {"actor_manager_num_outstanding_async_reqs": 0}, "done": false, "training_iteration": 3, "trial_id": "ae8a2_00000", "date": "2025-08-11_18-23-05", "timestamp": 1754929385, "time_this_iter_s": 13.813910722732544, "time_total_s": 39.22898864746094, "pid": 10870, "hostname": "Mac", "node_ip": "127.0.0.1", "config": {"exploration_config": {}, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 2, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "env": "Umbrella", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": false, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 0, "create_local_env_runner": true, "num_envs_per_env_runner": 1, "gym_env_vectorize_mode": "SYNC", "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "episodes_to_numpy": true, "max_requests_in_flight_per_env_runner": 1, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "merge_env_runner_states": "training_only", "broadcast_env_runner_states": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "complete_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "sampler_perf_stats_ema_coef": null, "_is_online": true, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": "auto", "num_aggregator_actors_per_learner": 0, "max_requests_in_flight_per_aggregator_actor": 3, "local_gpu_idx": 0, "max_requests_in_flight_per_learner": 3, "gamma": 1, "lr": 0.0002715581955, "grad_clip": 0.5, "grad_clip_by": "global_norm", "_train_batch_size_per_learner": 5000, "train_batch_size": 4000, "num_epochs": 1, "minibatch_size": 1000, "shuffle_batch_per_epoch": true, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "log_std_clip_param": 20.0, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "_disable_preprocessor_api": false, "_disable_action_flattening": false}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {"intrinsic_reward_coeff": 0.2795015916508}, "optimizer": {}, "_learner_class": "<class 'source.intrinsic_attention_ppo.learners.IntrinsicAttentionMetaLearner.IntrinsicAttentionMetaLearner'>", "callbacks_on_algorithm_init": null, "callbacks_on_env_runners_recreated": null, "callbacks_on_offline_eval_runners_recreated": null, "callbacks_on_checkpoint_loaded": null, "callbacks_on_environment_created": null, "callbacks_on_episode_created": null, "callbacks_on_episode_start": null, "callbacks_on_episode_step": null, "callbacks_on_episode_end": null, "callbacks_on_evaluate_start": null, "callbacks_on_evaluate_end": null, "callbacks_on_evaluate_offline_start": null, "callbacks_on_evaluate_offline_end": null, "callbacks_on_sample_end": null, "callbacks_on_train_result": null, "explore": true, "enable_rl_module_and_learner": true, "enable_env_runner_and_connector_v2": true, "_prior_exploration_config": {"type": "StochasticSampling"}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x38844d8a0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "offline_data_class": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_read_batch_size": null, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "materialize_data": false, "materialize_mapped_data": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "ignore_final_observation": false, "prelearner_class": null, "prelearner_buffer_class": null, "prelearner_buffer_kwargs": {}, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_remaining_data": false, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": 1, "evaluation_duration": 20, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_auto_duration_min_env_steps_per_sample": 100, "evaluation_auto_duration_max_env_steps_per_sample": 2000, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 1, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "offline_evaluation_interval": null, "num_offline_eval_runners": 0, "offline_loss_for_module_fn": null, "offline_evaluation_duration": 1, "offline_evaluation_parallel_to_training": false, "offline_evaluation_timeout_s": 120.0, "num_cpus_per_offline_eval_runner": 1, "num_gpus_per_offline_eval_runner": 0, "custom_resources_per_offline_eval_runner": {}, "restart_failed_offline_eval_runners": true, "ignore_offline_eval_runner_failures": false, "max_num_offline_eval_runner_restarts": 1000, "offline_eval_runner_restore_timeout_s": 1800.0, "max_requests_in_flight_per_offline_eval_runner": 1, "validate_offline_eval_runners_after_construction": true, "offline_eval_runner_health_probe_timeout_s": 30.0, "offline_eval_rl_module_inference_only": false, "broadcast_offline_eval_runner_states": false, "offline_eval_batch_size_per_runner": 256, "dataset_num_iters_per_eval_runner": 1, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "log_gradients": false, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 1, "restart_failed_env_runners": true, "ignore_env_runner_failures": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30.0, "env_runner_restore_timeout_s": 1800.0, "_model_config": {}, "_rl_module_spec": "MultiRLModuleSpec(multi_rl_module_class=<class 'ray.rllib.core.rl_module.multi_rl_module.MultiRLModule'>, observation_space=None, action_space=None, inference_only=False, model_config=None, rl_module_specs={'default_policy': RLModuleSpec(module_class=<class 'source.intrinsic_attention_ppo.rl_modules.DifferentiablePPOModule.DifferentiablePPOModule'>, observation_space=None, action_space=None, inference_only=False, learner_only=False, model_config={'vf_share_layers': True, 'embedding_dim': 62, 'max_seq_len': 11, 'policy_head_hidden_sizes': [32], 'value_head_hidden_sizes': [101], 'embedding_hidden_sizes': [121]}, catalog_class=None, load_state_path=None, model_config_dict=None), 'intrinsic_reward_module': RLModuleSpec(module_class=<class 'source.intrinsic_attention_ppo.rl_modules.IntrinsicAttentionModule.IntrinsicAttentionModule'>, observation_space=None, action_space=None, inference_only=False, learner_only=True, model_config={'intrinsic_reward_network': {'encoder_hidden_sizes': [], 'encoding_dim': 1, 'num_heads': 1, 'head_hidden_sizes': None, 'layers': [{'type': 'attention'}]}, 'extrinsic_value_hidden_layers': [127, 60], 'vf_share_layers': True, 'max_seq_len': 11}, catalog_class=None, load_state_path=None, model_config_dict=None)}, load_state_path=None, modules_to_load=None, module_specs={'default_policy': RLModuleSpec(module_class=<class 'source.intrinsic_attention_ppo.rl_modules.DifferentiablePPOModule.DifferentiablePPOModule'>, observation_space=None, action_space=None, inference_only=False, learner_only=False, model_config={'vf_share_layers': True, 'embedding_dim': 62, 'max_seq_len': 11, 'policy_head_hidden_sizes': [32], 'value_head_hidden_sizes': [101], 'embedding_hidden_sizes': [121]}, catalog_class=None, load_state_path=None, model_config_dict=None), 'intrinsic_reward_module': RLModuleSpec(module_class=<class 'source.intrinsic_attention_ppo.rl_modules.IntrinsicAttentionModule.IntrinsicAttentionModule'>, observation_space=None, action_space=None, inference_only=False, learner_only=True, model_config={'intrinsic_reward_network': {'encoder_hidden_sizes': [], 'encoding_dim': 1, 'num_heads': 1, 'head_hidden_sizes': None, 'layers': [{'type': 'attention'}]}, 'extrinsic_value_hidden_layers': [127, 60], 'vf_share_layers': True, 'max_seq_len': 11}, catalog_class=None, load_state_path=None, model_config_dict=None)})", "algorithm_config_overrides_per_module": {"intrinsic_reward_module": {"lr": 0.0002715581955}}, "_per_module_overrides": {}, "_validate_config": true, "_use_msgpack_checkpoints": false, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "env_task_fn": -1, "enable_connectors": -1, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.161583927863, "kl_target": 0.0201019014258, "vf_loss_coeff": 0.7790510010087, "entropy_coeff": 0.0015431216992, "clip_param": 0.2459212356676, "vf_clip_param": 0.3769744131561, "entropy_coeff_schedule": null, "lr_schedule": null, "sgd_minibatch_size": -1, "vf_share_layers": -1, "differentiable_learner_configs": ["DifferentiableLearnerConfig(learner_class=<class 'source.intrinsic_attention_ppo.learners.IntrinsicAttentionPPOLearner.IntrinsicAttentionPPOLearner'>, learner_connector=None, add_default_connectors_to_learner_pipeline=True, is_multi_agent=False, policies_to_update=['default_policy'], lr=0.0060984166342, num_total_minibatches=0, num_epochs=1, minibatch_size=1000, shuffle_batch_per_epoch=True)"], "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9485408017724, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.callbacks.callbacks.RLlibCallback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 39.22898864746094, "iterations_since_restore": 3, "perf": {"cpu_util_percent": 76.48947368421052, "ram_util_percent": 82.58421052631577}}
{"timers": {"training_iteration": 12.63019392408291, "restore_env_runners": 1.2665306185605004e-05, "training_step": 12.630000492150943, "env_runner_sampling_timer": 2.9276798285000276, "learner_update_timer": 9.48325359381244, "synch_weights": 0.001649828119077021, "restore_eval_env_runners": 5.3946098801679906e-05, "evaluation_iteration": 0.14358889246627218, "synch_eval_env_connectors": 0.00021924795219674704, "synch_env_connectors": 6.102974875830114e-06}, "env_runners": {"module_to_env_connector": {"connector_pipeline_timer": 0.00011699343025952105, "timers": {"connectors": {"remove_single_ts_time_rank_from_batch": 1.190244193981867e-05, "un_batch_to_individual_items": 6.503064388275189e-06, "get_actions": 3.8621712699112856e-05, "tensor_to_numpy": 1.4907329570813655e-05, "listify_data_for_vector_env": 1.0365292963812492e-05, "normalize_and_clip_actions": 7.966249770799342e-06}}}, "rlmodule_inference_timer": 3.120018074637027e-05, "sample": 0.006353341498322654, "weights_seq_no": 3.0, "num_agent_steps_sampled": {"default_agent": 5000.0}, "episode_len_mean": 20.0, "episode_len_max": 20, "env_to_module_connector": {"timers": {"connectors": {"batch_individual_items": 1.2439621330285115e-05, "add_states_from_episodes_to_batch": 2.694964494200467e-06, "numpy_to_tensor": 1.2401226335462776e-05, "add_observations_from_episodes_to_batch": 2.795166932371973e-06, "add_time_dim_to_batch_and_zero_pad": 6.9124971503609245e-06}}, "connector_pipeline_timer": 5.9550787666730285e-05}, "env_to_module_sum_episodes_length_out": 10.36823839457432, "num_agent_steps_sampled_lifetime": {"default_agent": -1225000.0}, "episode_return_mean": 0.86, "num_module_steps_sampled_lifetime": {"default_policy": -1225000.0}, "num_episodes": 250.0, "time_between_sampling": 0.04761239621972025, "num_env_steps_sampled_lifetime": -1225000.0, "episode_return_min": -10.5, "env_reset_timer": 5.601848444841328e-05, "env_to_module_sum_episodes_length_in": 10.36823839457432, "num_episodes_lifetime": -61250.0, "agent_episode_returns_mean": {"default_agent": 0.86}, "episode_len_min": 20, "episode_duration_sec_mean": 0.0052386986608616995, "env_step_timer": 1.3920316136699896e-05, "episode_return_max": 9.5, "num_module_steps_sampled": {"default_policy": 5000.0}, "module_episode_returns_mean": {"default_policy": 0.86}, "num_env_steps_sampled": 5000.0, "num_env_steps_sampled_lifetime_throughput": 3252.947870481041}, "__all_modules__": {"learner_connector_sum_episodes_length_in": 5000.0, "learner_connector": {"connector_pipeline_timer": 0.16269956883958678, "timers": {"connectors": {"add_one_ts_to_episodes_and_truncate": 0.009361836332343169, "add_observations_from_episodes_to_batch": 0.001669663870756398, "add_columns_from_episodes_to_train_batch": 0.049963496992049855, "add_time_dim_to_batch_and_zero_pad": 0.08569492773782589, "add_states_from_episodes_to_batch": 0.009137716091405481, "batch_individual_items": 0.006517380308311782, "numpy_to_tensor": 9.784468682983424e-05}}}, "learner_connector_sum_episodes_length_out": 5250.0}, "learners": {"default_policy": {"curr_entropy_coeff": 0.0015431216992, "curr_kl_coeff": 0.010098995640873909, "num_module_steps_trained_lifetime": 23940, "entropy": 0.6893688440322876, "num_module_steps_trained": 5985, "diff_num_grad_updates_vs_sampler_policy": 1.0, "vf_loss": 0.3583146333694458, "vf_loss_unclipped": 43.01207733154297, "policy_loss": -0.00014329057012218982, "use_intrinsic_rewards": 0.0, "total_loss": 0.27793872356414795, "vf_explained_var": 0.0018725395202636719, "mean_kl_loss": 2.1348543668864295e-05, "weights_seq_no": 4.0, "num_trainable_parameters": 16595, "module_train_batch_size_mean": 997.8923005732703, "num_module_steps_trained_lifetime_throughput": 765.5180006105805}, "intrinsic_reward_module": {"num_module_steps_trained_lifetime": 23940, "num_module_steps_trained": 5985, "diff_num_grad_updates_vs_sampler_policy": 1.0, "total_loss": 0.0, "gradients_default_optimizer_global_norm": 0.0, "module_train_batch_size_mean": 997.8923005732703, "default_optimizer_learning_rate": 0.0002715581955, "weights_seq_no": 4.0, "num_trainable_parameters": 8266, "curr_entropy_coeff": 0.0015431216992, "num_module_steps_trained_lifetime_throughput": 765.5325762698387}, "differentiable_learners": {"intrinsic_attention_ppo_learner": {"default_policy": {"weights_seq_no": 24.0, "num_module_steps_trained": 35910, "num_module_steps_trained_lifetime": 143640, "entropy": 0.6893772482872009, "diff_num_grad_updates_vs_sampler_policy": 21.0, "vf_loss": 0.3585442304611206, "vf_loss_unclipped": 43.261131286621094, "total_loss": 0.27812305092811584, "mean_kl_loss": 2.072017377940938e-05, "policy_loss": -0.00014073931379243731, "use_intrinsic_rewards": 1.0, "module_train_batch_size_mean": 997.6156867483631, "vf_explained_var": -0.0016716718673706055}, "__all_modules__": {"num_env_steps_trained": 198000, "num_module_steps_trained": 71820, "num_module_steps_trained_lifetime": 287280, "num_env_steps_trained_lifetime": 792000, "num_env_steps_trained_lifetime_throughput": 37346.92697974561}, "intrinsic_reward_module": {"weights_seq_no": 24.0, "num_module_steps_trained_lifetime": 143640, "num_module_steps_trained": 35910, "diff_num_grad_updates_vs_sampler_policy": 21.0, "total_loss": 0.0, "module_train_batch_size_mean": 997.6156867483631}}}, "__all_modules__": {"num_env_steps_trained_lifetime": 132000, "num_non_trainable_parameters": 0, "num_trainable_parameters": 24861, "num_env_steps_trained": 33000, "num_module_steps_trained": 11970, "num_module_steps_trained_lifetime": 47880, "num_env_steps_trained_lifetime_throughput": 4222.731804435953, "num_module_steps_trained_throughput": 27935252.682862654, "num_module_steps_trained_lifetime_throughput": 13262919.504906725}, "IntrinsicAttentionMask": [[[0.09101855009794235, 0.09171441942453384, 0.09076810628175735, 0.09023785591125488, 0.09172971546649933, 0.09119383990764618, 0.09025290608406067, 0.090257927775383, 0.0917501226067543, 0.09026796370744705, 0.09080849587917328], [0.09113819897174835, 0.0926317647099495, 0.09060382097959518, 0.08947790414094925, 0.09266475588083267, 0.09151322394609451, 0.0895097628235817, 0.08952038735151291, 0.09270875155925751, 0.08954163640737534, 0.09068988263607025], [0.09097409248352051, 0.09138356894254684, 0.09082640707492828, 0.09051316976547241, 0.09139255434274673, 0.09107735753059387, 0.09052207320928574, 0.09052503854036331, 0.09140454232692719, 0.09053097665309906, 0.09085023403167725], [0.09087743610143661, 0.09068182855844498, 0.09094830602407455, 0.09109919518232346, 0.09067755192518234, 0.09082797914743423, 0.09109489619731903, 0.09109345823526382, 0.0906718447804451, 0.0910905972123146, 0.09093686938285828], [0.0911407619714737, 0.09265190362930298, 0.0906001627445221, 0.08946126699447632, 0.0926852747797966, 0.09152016788721085, 0.08949349820613861, 0.08950424194335938, 0.09272979944944382, 0.0895257368683815, 0.09068722277879715], [0.09104923903942108, 0.09194578230381012, 0.09072704613208771, 0.09004572778940201, 0.09196551889181137, 0.09127489477396011, 0.09006506204605103, 0.09007149934768677, 0.0919918343424797, 0.09008438885211945, 0.09077898412942886], [0.09088023006916046, 0.09070177376270294, 0.09094487875699997, 0.09108249843120575, 0.09069786965847015, 0.09083510935306549, 0.09107857942581177, 0.09107726812362671, 0.0906926617026329, 0.09107465296983719, 0.09093444049358368], [0.09088116139173508, 0.0907084196805954, 0.09094373136758804, 0.09107693284749985, 0.09070464223623276, 0.0908374935388565, 0.09107314050197601, 0.09107187390327454, 0.09069959819316864, 0.09106934070587158, 0.09093362838029861], [0.09114417433738708, 0.0926787480711937, 0.0905952900648117, 0.08943909406661987, 0.0927126482129097, 0.09152943640947342, 0.08947180956602097, 0.08948271721601486, 0.09275786578655243, 0.08950453251600266, 0.09068367630243301], [0.09088302403688431, 0.09072171896696091, 0.09094144403934479, 0.09106580168008804, 0.09071818739175797, 0.09084223955869675, 0.09106225520372391, 0.0910610780119896, 0.0907134860754013, 0.09105871617794037, 0.09093201160430908], [0.09098131954669952, 0.0914369449019432, 0.09081704169511795, 0.09046870470046997, 0.09144695848226547, 0.09109620749950409, 0.09047860652208328, 0.09048191457986832, 0.09146029502153397, 0.0904885083436966, 0.09084354341030121]], [[0.09413348883390427, 0.09115838259458542, 0.0922379195690155, 0.0930725708603859, 0.09417478740215302, 0.09119836986064911, 0.09120837599039078, 0.09311340749263763, 0.07504052668809891, 0.0921812355518341, 0.09248092770576477], [0.09013757109642029, 0.09080582112073898, 0.09056027233600616, 0.09037284553050995, 0.09012847393751144, 0.09079665690660477, 0.09079436957836151, 0.09036372601985931, 0.09496162831783295, 0.09057308733463287, 0.09050548821687698], [0.09163928031921387, 0.09099145978689194, 0.09122840315103531, 0.09141011536121368, 0.0916481539607048, 0.0910002738237381, 0.09100247919559479, 0.09141898155212402, 0.08716346323490143, 0.09121601283550262, 0.09128144383430481], [0.09275902807712555, 0.0910884216427803, 0.0916973128914833, 0.09216596931219101, 0.09278205782175064, 0.09111103415489197, 0.09111668914556503, 0.09218884259462357, 0.08159127086400986, 0.09166541695594788, 0.09183394908905029], [0.09418592602014542, 0.09115996956825256, 0.0922577753663063, 0.0931066945195198, 0.09422793984413147, 0.09120063483715057, 0.09121079742908478, 0.09314822405576706, 0.07479696720838547, 0.09220012277364731, 0.09250491857528687], [0.09019431471824646, 0.09081397205591202, 0.09058632701635361, 0.09041251987218857, 0.09018588066101074, 0.09080548584461212, 0.090803362429142, 0.09040407091379166, 0.09466026723384857, 0.0905982032418251, 0.09053552895784378], [0.090208500623703, 0.09081600606441498, 0.09059283137321472, 0.09042243659496307, 0.09020023047924042, 0.09080768376588821, 0.09080560505390167, 0.0904141515493393, 0.09458506852388382, 0.09060447663068771, 0.09054303169250488], [0.0928129255771637, 0.09109219163656235, 0.09171923995018005, 0.09220195561647415, 0.0928366482257843, 0.09111547470092773, 0.09112130105495453, 0.09222552180290222, 0.0813283920288086, 0.09168639034032822, 0.09185996651649475], [0.058141887187957764, 0.07441013306379318, 0.06797599792480469, 0.06343112885951996, 0.05794632434844971, 0.07415986061096191, 0.0740974172949791, 0.06321776658296585, 0.33170586824417114, 0.06829778105020523, 0.06661587953567505], [0.0915619358420372, 0.09098344296216965, 0.09119507670402527, 0.09135735780000687, 0.09156986325979233, 0.0909913182258606, 0.09099328517913818, 0.0913652628660202, 0.08755598217248917, 0.09118401259183884, 0.09124244749546051], [0.09196889400482178, 0.09102369844913483, 0.09136906266212463, 0.09163419902324677, 0.09198187291622162, 0.09103654325008392, 0.0910397544503212, 0.09164713323116302, 0.08550142496824265, 0.0913509875535965, 0.0914464220404625]], [[0.09097038209438324, 0.09166587889194489, 0.09072007238864899, 0.0907251164317131, 0.091140516102314, 0.09168627113103867, 0.09074025601148605, 0.09074530005455017, 0.09116078913211823, 0.09022019803524017, 0.0902252122759819], [0.0910370945930481, 0.09252900630235672, 0.09050330519676208, 0.09051404893398285, 0.09140085428953171, 0.09257294237613678, 0.09054628014564514, 0.0905570313334465, 0.09144425392150879, 0.08944230526685715, 0.08945292234420776], [0.09094551205635071, 0.0913548544049263, 0.09079787135124207, 0.09080084413290024, 0.09104575961828232, 0.09136683493852615, 0.09080977737903595, 0.09081275761127472, 0.09105769544839859, 0.09050253033638, 0.09050549566745758], [0.0909460186958313, 0.09136112779378891, 0.09079630672931671, 0.09079932421445847, 0.09104768186807632, 0.09137327969074249, 0.09080838412046432, 0.09081140160560608, 0.09105978906154633, 0.09049683064222336, 0.09049984067678452], [0.09098702669143677, 0.09187716245651245, 0.09066712111234665, 0.09067357331514359, 0.09120459109544754, 0.09190328419208527, 0.0906929075717926, 0.09069934487342834, 0.09123052656650543, 0.09002900868654251, 0.09003540873527527], [0.09103900194168091, 0.09255428612232208, 0.09049693495035172, 0.09050784260034561, 0.09140842407941818, 0.09259891510009766, 0.0905405730009079, 0.0905514806509018, 0.09145250171422958, 0.0894196406006813, 0.08943041414022446], [0.09094753116369247, 0.09137994050979614, 0.09079160541296005, 0.09079474955797195, 0.09105342626571655, 0.09139259904623032, 0.09080418199300766, 0.09080732613801956, 0.09106604009866714, 0.09047972410917282, 0.09048286080360413], [0.09094804525375366, 0.09138621389865875, 0.0907900407910347, 0.09079322963953018, 0.09105534106492996, 0.09139904379844666, 0.09080278873443604, 0.09080597013235092, 0.09106812626123428, 0.09047402441501617, 0.09047720581293106], [0.09098900109529495, 0.09190233796834946, 0.09066081792116165, 0.09066742658615112, 0.09121222048997879, 0.09192914515733719, 0.09068726748228073, 0.0906938761472702, 0.0912388265132904, 0.0900062695145607, 0.09001283347606659], [0.09089446067810059, 0.09073314815759659, 0.09095289558172226, 0.09095171838998795, 0.09085486084222794, 0.09072843939065933, 0.0909481793642044, 0.0909469947218895, 0.09085015207529068, 0.09107018262147903, 0.09106899797916412], [0.09089498966932297, 0.09073938429355621, 0.0909513458609581, 0.09095020592212677, 0.09085679054260254, 0.09073484688997269, 0.09094679355621338, 0.09094565361738205, 0.09085223823785782, 0.0910644605755806, 0.09106332063674927]], [[0.0896986871957779, 0.0891660675406456, 0.08917269855737686, 0.09043056517839432, 0.09043728560209274, 0.08919256925582886, 0.08919920027256012, 0.09045744687318802, 0.1032671108841896, 0.08984280377626419, 0.0891355574131012], [0.09031800180673599, 0.09004771709442139, 0.0900510773062706, 0.09068811684846878, 0.09069150686264038, 0.09006118774414062, 0.09006455540657043, 0.09070168435573578, 0.09695297479629517, 0.09039101004600525, 0.09003220498561859], [0.0903104916214943, 0.09003689885139465, 0.09004031121730804, 0.09068514406681061, 0.09068857878446579, 0.09005054086446762, 0.09005394577980042, 0.09069887548685074, 0.09702958166599274, 0.09038438647985458, 0.09002120792865753], [0.08879362791776657, 0.08791079372167587, 0.08792175352573395, 0.09001252800226212, 0.09002375602722168, 0.08795464038848877, 0.08796560764312744, 0.09005743265151978, 0.11246635019779205, 0.0890331119298935, 0.08786032348871231], [0.08878502994775772, 0.08789904415607452, 0.08791004121303558, 0.09000836312770844, 0.09001962095499039, 0.08794304728507996, 0.08795405179262161, 0.09005342423915863, 0.1125536859035492, 0.08902539312839508, 0.08784839510917664], [0.0902879536151886, 0.09000445902347565, 0.09000799059867859, 0.0906762033700943, 0.09067976474761963, 0.09001857787370682, 0.09002211689949036, 0.09069043397903442, 0.09725974500179291, 0.09036452323198318, 0.08998819440603256], [0.09028042107820511, 0.08999363332986832, 0.08999720960855484, 0.09067320823669434, 0.09067681431770325, 0.09000792354345322, 0.09001149982213974, 0.09068761020898819, 0.09733657538890839, 0.09035788476467133, 0.08997718244791031], [0.0887591764330864, 0.08786372095346451, 0.08787483721971512, 0.08999574929475784, 0.09000713378190994, 0.08790819346904755, 0.08791931718587875, 0.09004130214452744, 0.1128159910440445, 0.08900212496519089, 0.08781252801418304], [0.06243195757269859, 0.05786704644560814, 0.0579218864440918, 0.06924700736999512, 0.06931262463331223, 0.058086734265089035, 0.05814177915453911, 0.06950989365577698, 0.37614303827285767, 0.06372296810150146, 0.057615067809820175], [0.08952546119689941, 0.08892292529344559, 0.08893042057752609, 0.09035418927669525, 0.09036180377006531, 0.08895289897918701, 0.08896039426326752, 0.09038464725017548, 0.10503023117780685, 0.08968858420848846, 0.08888842165470123], [0.09035250544548035, 0.09009742736816406, 0.09010060131549835, 0.09070171415805817, 0.09070491045713425, 0.09011013805866241, 0.0901133194565773, 0.09071451425552368, 0.096600741147995, 0.0904213935136795, 0.09008278697729111]], [[0.09220756590366364, 0.09119702130556107, 0.09043572098016739, 0.09044518321752548, 0.09122564643621445, 0.0912351906299591, 0.09047356247901917, 0.08948202431201935, 0.09228474646806717, 0.09050194919109344, 0.09051141887903214], [0.09160373359918594, 0.09106418490409851, 0.0906558632850647, 0.0906609520316124, 0.09107949584722519, 0.09108460694551468, 0.0906761959195137, 0.09014210104942322, 0.09164483100175858, 0.0906914547085762, 0.0906965360045433], [0.0911460593342781, 0.09096226841211319, 0.09082271158695221, 0.09082444757223129, 0.09096749871969223, 0.09096924215555191, 0.09082967042922974, 0.09064651280641556, 0.09116002917289734, 0.09083488583564758, 0.09083662927150726], [0.09115176647901535, 0.09096354991197586, 0.09082063287496567, 0.09082241356372833, 0.09096889942884445, 0.09097068756818771, 0.09082776308059692, 0.09064021706581116, 0.09116607159376144, 0.09083310514688492, 0.09083489328622818], [0.09162089228630066, 0.09106798470020294, 0.09064961224794388, 0.09065482020378113, 0.09108367562294006, 0.0910889133810997, 0.09067044407129288, 0.0901232659816742, 0.09166301041841507, 0.09068606793880463, 0.09069128334522247], [0.0916266217827797, 0.09106925129890442, 0.09064752608537674, 0.09065277874469757, 0.09108507633209229, 0.09109035134315491, 0.09066852927207947, 0.09011698514223099, 0.09166907519102097, 0.09068427979946136, 0.0906895324587822], [0.09116886556148529, 0.09096737951040268, 0.09081439673900604, 0.09081630408763885, 0.09097310155630112, 0.09097501635551453, 0.09082202613353729, 0.09062130004167557, 0.09118418395519257, 0.09082774817943573, 0.09082965552806854], [0.09056931734085083, 0.09083233028650284, 0.09103292971849442, 0.09103041887283325, 0.09082483500242233, 0.09082233905792236, 0.09102290123701096, 0.09128724038600922, 0.09054937958717346, 0.09101539105176926, 0.09101288765668869], [0.09225351363420486, 0.09120705723762512, 0.09041896462440491, 0.09042875468730927, 0.09123668819665909, 0.09124656766653061, 0.09045813232660294, 0.08943204581737518, 0.09233345091342926, 0.0904875174164772, 0.09049731492996216], [0.09118597209453583, 0.0909712016582489, 0.09080816060304642, 0.09081019461154938, 0.09097731113433838, 0.09097934514284134, 0.09081629663705826, 0.09060239046812057, 0.09120230376720428, 0.09082239121198654, 0.0908244177699089], [0.09119168668985367, 0.09097248315811157, 0.09080608934164047, 0.09080816060304642, 0.0909787192940712, 0.09098079055547714, 0.09081438183784485, 0.09059608727693558, 0.09120834618806839, 0.09082061052322388, 0.09082268178462982]], [[0.09433741122484207, 0.09135585278272629, 0.09136586636304855, 0.09327419847249985, 0.09328442066907883, 0.09139592945575714, 0.0914059579372406, 0.09331511706113815, 0.0752030685544014, 0.09238092601299286, 0.09268126636743546], [0.09009384363889694, 0.09076177328824997, 0.09075948596000671, 0.09032901376485825, 0.09032673388719559, 0.09075261652469635, 0.0907503291964531, 0.09031990170478821, 0.09491557627916336, 0.09052915126085281, 0.0904615968465805], [0.09010882675647736, 0.090764619410038, 0.09076236933469772, 0.09033972769975662, 0.09033749252557755, 0.09075562655925751, 0.09075338393449783, 0.09033077955245972, 0.09484102576971054, 0.09053622931241989, 0.09046990424394608], [0.09287174791097641, 0.0911991074681282, 0.09120476990938187, 0.09227795898914337, 0.0922836884856224, 0.09122174978256226, 0.09122740477323532, 0.09230086952447891, 0.08169040083885193, 0.09177680313587189, 0.09194553643465042], [0.09288609027862549, 0.09120088815689087, 0.09120659530162811, 0.0922878161072731, 0.09229358285665512, 0.09122370183467865, 0.0912294015288353, 0.09231089800596237, 0.08162527531385422, 0.09178289771080017, 0.09195289760828018], [0.09015373885631561, 0.09077312797307968, 0.09077100455760956, 0.09037185460329056, 0.09036973863840103, 0.09076463431119919, 0.09076251834630966, 0.09036339819431305, 0.09461769461631775, 0.09055744856595993, 0.090494804084301], [0.09016869962215424, 0.09077594429254532, 0.09077386558055878, 0.09038254618644714, 0.0903804749250412, 0.09076762199401855, 0.09076554328203201, 0.09037426114082336, 0.09454335272312164, 0.09056450426578522, 0.09050308912992477], [0.09292909502983093, 0.09120620042085648, 0.09121203422546387, 0.0923173651099205, 0.09232325851917267, 0.09122952073812485, 0.09123534709215164, 0.09234096109867096, 0.08143017441034317, 0.09180115163326263, 0.09197494387626648], [0.05746358633041382, 0.07354208081960678, 0.07348015159368515, 0.06269112974405289, 0.06263834983110428, 0.07329471409320831, 0.07323300838470459, 0.06248026341199875, 0.32783693075180054, 0.0675010159611702, 0.06583873927593231], [0.0916004329919815, 0.09102169424295425, 0.09102366119623184, 0.09139575809240341, 0.0913977399468422, 0.0910295695066452, 0.09103154391050339, 0.09140367805957794, 0.08759278804063797, 0.0912223607301712, 0.09128081053495407], [0.09203208237886429, 0.0910862386226654, 0.09108944982290268, 0.09169715642929077, 0.09170038998126984, 0.0910990908741951, 0.09110230207443237, 0.09171009063720703, 0.0855601578950882, 0.09141375124454498, 0.09150924533605576]]]}, "num_training_step_calls_per_iteration": 1, "evaluation": {"env_runners": {"module_to_env_connector": {"timers": {"connectors": {"tensor_to_numpy": 1.909535851919513e-05, "un_batch_to_individual_items": 7.992829194055543e-06, "get_actions": 5.543665537971932e-05, "listify_data_for_vector_env": 1.2645697133984478e-05, "normalize_and_clip_actions": 9.57279267156028e-06, "remove_single_ts_time_rank_from_batch": 1.3183297230023689e-05}}, "connector_pipeline_timer": 0.00014879006110227582}, "episode_len_min": 20, "num_env_steps_sampled": 400, "weights_seq_no": 4.0, "episode_len_mean": 20.0, "env_to_module_sum_episodes_length_out": 10.368237912813044, "episode_len_max": 20, "env_to_module_connector": {"timers": {"connectors": {"batch_individual_items": 1.4294675299497652e-05, "add_observations_from_episodes_to_batch": 3.6217148503037696e-06, "add_states_from_episodes_to_batch": 3.369540786144971e-06, "add_time_dim_to_batch_and_zero_pad": 8.170965309765274e-06, "numpy_to_tensor": 1.4539492151314076e-05}}, "connector_pipeline_timer": 6.929247555687696e-05}, "env_to_module_sum_episodes_length_in": 10.368237912813044, "num_episodes_lifetime": 80, "episode_duration_sec_mean": 0.0059013031292124655, "episode_return_max": 12.5, "rlmodule_inference_timer": 4.6185005216902586e-05, "num_agent_steps_sampled": {"default_agent": 400}, "num_module_steps_sampled_lifetime": {"default_policy": 1600}, "num_agent_steps_sampled_lifetime": {"default_agent": 1600}, "num_module_steps_sampled": {"default_policy": 400}, "sample": 0.13189651164950628, "episode_return_mean": -0.05, "env_step_timer": 1.779196944647503e-05, "agent_episode_returns_mean": {"default_agent": -0.05}, "num_episodes": 20, "module_episode_returns_mean": {"default_policy": -0.05}, "episode_return_min": -12.5, "num_env_steps_sampled_lifetime": 20400, "env_reset_timer": 0.0005738129005717346, "time_between_sampling": 12.527475561673787}, "num_healthy_workers": 1, "actor_manager_num_outstanding_async_reqs": 0, "num_remote_worker_restarts": 0}, "num_env_steps_sampled_lifetime": -1225000.0, "fault_tolerance": {"num_healthy_workers": 0, "num_remote_worker_restarts": 0}, "env_runner_group": {"actor_manager_num_outstanding_async_reqs": 0}, "done": false, "training_iteration": 4, "trial_id": "ae8a2_00000", "date": "2025-08-11_18-23-16", "timestamp": 1754929396, "time_this_iter_s": 10.191107034683228, "time_total_s": 49.420095682144165, "pid": 10870, "hostname": "Mac", "node_ip": "127.0.0.1", "config": {"exploration_config": {}, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 2, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "env": "Umbrella", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": false, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 0, "create_local_env_runner": true, "num_envs_per_env_runner": 1, "gym_env_vectorize_mode": "SYNC", "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "episodes_to_numpy": true, "max_requests_in_flight_per_env_runner": 1, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "merge_env_runner_states": "training_only", "broadcast_env_runner_states": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "complete_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "sampler_perf_stats_ema_coef": null, "_is_online": true, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": "auto", "num_aggregator_actors_per_learner": 0, "max_requests_in_flight_per_aggregator_actor": 3, "local_gpu_idx": 0, "max_requests_in_flight_per_learner": 3, "gamma": 1, "lr": 0.0002715581955, "grad_clip": 0.5, "grad_clip_by": "global_norm", "_train_batch_size_per_learner": 5000, "train_batch_size": 4000, "num_epochs": 1, "minibatch_size": 1000, "shuffle_batch_per_epoch": true, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "log_std_clip_param": 20.0, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "_disable_preprocessor_api": false, "_disable_action_flattening": false}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {"intrinsic_reward_coeff": 0.2795015916508}, "optimizer": {}, "_learner_class": "<class 'source.intrinsic_attention_ppo.learners.IntrinsicAttentionMetaLearner.IntrinsicAttentionMetaLearner'>", "callbacks_on_algorithm_init": null, "callbacks_on_env_runners_recreated": null, "callbacks_on_offline_eval_runners_recreated": null, "callbacks_on_checkpoint_loaded": null, "callbacks_on_environment_created": null, "callbacks_on_episode_created": null, "callbacks_on_episode_start": null, "callbacks_on_episode_step": null, "callbacks_on_episode_end": null, "callbacks_on_evaluate_start": null, "callbacks_on_evaluate_end": null, "callbacks_on_evaluate_offline_start": null, "callbacks_on_evaluate_offline_end": null, "callbacks_on_sample_end": null, "callbacks_on_train_result": null, "explore": true, "enable_rl_module_and_learner": true, "enable_env_runner_and_connector_v2": true, "_prior_exploration_config": {"type": "StochasticSampling"}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x38844d8a0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "offline_data_class": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_read_batch_size": null, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "materialize_data": false, "materialize_mapped_data": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "ignore_final_observation": false, "prelearner_class": null, "prelearner_buffer_class": null, "prelearner_buffer_kwargs": {}, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_remaining_data": false, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": 1, "evaluation_duration": 20, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_auto_duration_min_env_steps_per_sample": 100, "evaluation_auto_duration_max_env_steps_per_sample": 2000, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 1, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "offline_evaluation_interval": null, "num_offline_eval_runners": 0, "offline_loss_for_module_fn": null, "offline_evaluation_duration": 1, "offline_evaluation_parallel_to_training": false, "offline_evaluation_timeout_s": 120.0, "num_cpus_per_offline_eval_runner": 1, "num_gpus_per_offline_eval_runner": 0, "custom_resources_per_offline_eval_runner": {}, "restart_failed_offline_eval_runners": true, "ignore_offline_eval_runner_failures": false, "max_num_offline_eval_runner_restarts": 1000, "offline_eval_runner_restore_timeout_s": 1800.0, "max_requests_in_flight_per_offline_eval_runner": 1, "validate_offline_eval_runners_after_construction": true, "offline_eval_runner_health_probe_timeout_s": 30.0, "offline_eval_rl_module_inference_only": false, "broadcast_offline_eval_runner_states": false, "offline_eval_batch_size_per_runner": 256, "dataset_num_iters_per_eval_runner": 1, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "log_gradients": false, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 1, "restart_failed_env_runners": true, "ignore_env_runner_failures": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30.0, "env_runner_restore_timeout_s": 1800.0, "_model_config": {}, "_rl_module_spec": "MultiRLModuleSpec(multi_rl_module_class=<class 'ray.rllib.core.rl_module.multi_rl_module.MultiRLModule'>, observation_space=None, action_space=None, inference_only=False, model_config=None, rl_module_specs={'default_policy': RLModuleSpec(module_class=<class 'source.intrinsic_attention_ppo.rl_modules.DifferentiablePPOModule.DifferentiablePPOModule'>, observation_space=None, action_space=None, inference_only=False, learner_only=False, model_config={'vf_share_layers': True, 'embedding_dim': 62, 'max_seq_len': 11, 'policy_head_hidden_sizes': [32], 'value_head_hidden_sizes': [101], 'embedding_hidden_sizes': [121]}, catalog_class=None, load_state_path=None, model_config_dict=None), 'intrinsic_reward_module': RLModuleSpec(module_class=<class 'source.intrinsic_attention_ppo.rl_modules.IntrinsicAttentionModule.IntrinsicAttentionModule'>, observation_space=None, action_space=None, inference_only=False, learner_only=True, model_config={'intrinsic_reward_network': {'encoder_hidden_sizes': [], 'encoding_dim': 1, 'num_heads': 1, 'head_hidden_sizes': None, 'layers': [{'type': 'attention'}]}, 'extrinsic_value_hidden_layers': [127, 60], 'vf_share_layers': True, 'max_seq_len': 11}, catalog_class=None, load_state_path=None, model_config_dict=None)}, load_state_path=None, modules_to_load=None, module_specs={'default_policy': RLModuleSpec(module_class=<class 'source.intrinsic_attention_ppo.rl_modules.DifferentiablePPOModule.DifferentiablePPOModule'>, observation_space=None, action_space=None, inference_only=False, learner_only=False, model_config={'vf_share_layers': True, 'embedding_dim': 62, 'max_seq_len': 11, 'policy_head_hidden_sizes': [32], 'value_head_hidden_sizes': [101], 'embedding_hidden_sizes': [121]}, catalog_class=None, load_state_path=None, model_config_dict=None), 'intrinsic_reward_module': RLModuleSpec(module_class=<class 'source.intrinsic_attention_ppo.rl_modules.IntrinsicAttentionModule.IntrinsicAttentionModule'>, observation_space=None, action_space=None, inference_only=False, learner_only=True, model_config={'intrinsic_reward_network': {'encoder_hidden_sizes': [], 'encoding_dim': 1, 'num_heads': 1, 'head_hidden_sizes': None, 'layers': [{'type': 'attention'}]}, 'extrinsic_value_hidden_layers': [127, 60], 'vf_share_layers': True, 'max_seq_len': 11}, catalog_class=None, load_state_path=None, model_config_dict=None)})", "algorithm_config_overrides_per_module": {"intrinsic_reward_module": {"lr": 0.0002715581955}}, "_per_module_overrides": {}, "_validate_config": true, "_use_msgpack_checkpoints": false, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "env_task_fn": -1, "enable_connectors": -1, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.161583927863, "kl_target": 0.0201019014258, "vf_loss_coeff": 0.7790510010087, "entropy_coeff": 0.0015431216992, "clip_param": 0.2459212356676, "vf_clip_param": 0.3769744131561, "entropy_coeff_schedule": null, "lr_schedule": null, "sgd_minibatch_size": -1, "vf_share_layers": -1, "differentiable_learner_configs": ["DifferentiableLearnerConfig(learner_class=<class 'source.intrinsic_attention_ppo.learners.IntrinsicAttentionPPOLearner.IntrinsicAttentionPPOLearner'>, learner_connector=None, add_default_connectors_to_learner_pipeline=True, is_multi_agent=False, policies_to_update=['default_policy'], lr=0.0060984166342, num_total_minibatches=0, num_epochs=1, minibatch_size=1000, shuffle_batch_per_epoch=True)"], "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9485408017724, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.callbacks.callbacks.RLlibCallback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 49.420095682144165, "iterations_since_restore": 4, "perf": {"cpu_util_percent": 45.228571428571435, "ram_util_percent": 83.14285714285714}}
{"timers": {"training_iteration": 12.63665669776226, "restore_env_runners": 1.2604482495782431e-05, "training_step": 12.63646128222921, "env_runner_sampling_timer": 2.9158761702153932, "learner_update_timer": 9.501547543705188, "synch_weights": 0.001668700677645958, "restore_eval_env_runners": 5.369413825660012e-05, "evaluation_iteration": 0.14378480104133132, "synch_eval_env_connectors": 0.00021901547246519474, "synch_env_connectors": 6.125275214435533e-06}, "env_runners": {"module_to_env_connector": {"connector_pipeline_timer": 0.0001317323830311679, "timers": {"connectors": {"remove_single_ts_time_rank_from_batch": 1.2740783610765531e-05, "un_batch_to_individual_items": 7.043173622024312e-06, "get_actions": 4.5430805342339607e-05, "tensor_to_numpy": 1.6665473898210266e-05, "listify_data_for_vector_env": 1.1466135185015854e-05, "normalize_and_clip_actions": 8.642793085435552e-06}}}, "rlmodule_inference_timer": 3.568539528518586e-05, "sample": 0.006018836414729247, "weights_seq_no": 4.0, "num_agent_steps_sampled": {"default_agent": 5000.0}, "episode_len_mean": 20.0, "episode_len_max": 20, "env_to_module_connector": {"timers": {"connectors": {"batch_individual_items": 1.3798304459078597e-05, "add_states_from_episodes_to_batch": 2.9301812218324664e-06, "numpy_to_tensor": 1.4254523441927462e-05, "add_observations_from_episodes_to_batch": 3.0640587657996883e-06, "add_time_dim_to_batch_and_zero_pad": 7.631613365527425e-06}}, "connector_pipeline_timer": 6.569679308422946e-05}, "env_to_module_sum_episodes_length_out": 10.36823839457432, "num_agent_steps_sampled_lifetime": {"default_agent": -1842500.0}, "episode_return_mean": 0.06, "num_module_steps_sampled_lifetime": {"default_policy": -1842500.0}, "num_episodes": 250.0, "time_between_sampling": 0.03630422670055189, "num_env_steps_sampled_lifetime": -1842500.0, "episode_return_min": -10.5, "env_reset_timer": 4.4223754702033466e-05, "env_to_module_sum_episodes_length_in": 10.36823839457432, "num_episodes_lifetime": -92125.0, "agent_episode_returns_mean": {"default_agent": 0.06}, "episode_len_min": 20, "episode_duration_sec_mean": 0.006003541164100171, "env_step_timer": 1.558847151682663e-05, "episode_return_max": 9.5, "num_module_steps_sampled": {"default_policy": 5000.0}, "module_episode_returns_mean": {"default_policy": 0.06}, "num_env_steps_sampled": 5000.0, "num_env_steps_sampled_lifetime_throughput": 3041.45449742579}, "__all_modules__": {"learner_connector_sum_episodes_length_in": 5000.0, "learner_connector": {"connector_pipeline_timer": 0.16256644732130987, "timers": {"connectors": {"add_one_ts_to_episodes_and_truncate": 0.009371570469611163, "add_observations_from_episodes_to_batch": 0.0016648743227146068, "add_columns_from_episodes_to_train_batch": 0.0499412336826562, "add_time_dim_to_batch_and_zero_pad": 0.08565273930001423, "add_states_from_episodes_to_batch": 0.009087522269690477, "batch_individual_items": 0.006495546926044758, "numpy_to_tensor": 9.753665018856641e-05}}}, "learner_connector_sum_episodes_length_out": 5250.0}, "learners": {"default_policy": {"curr_entropy_coeff": 0.0015431216992, "curr_kl_coeff": 0.0050494978204369545, "num_module_steps_trained_lifetime": 29925, "entropy": 0.6887156963348389, "num_module_steps_trained": 5985, "diff_num_grad_updates_vs_sampler_policy": 1.0, "vf_loss": 0.3583106994628906, "vf_loss_unclipped": 43.333248138427734, "policy_loss": -0.0002168377977795899, "use_intrinsic_rewards": 0.0, "total_loss": 0.2778628468513489, "vf_explained_var": 0.0023612380027770996, "mean_kl_loss": 1.757661266310606e-05, "weights_seq_no": 5.0, "num_trainable_parameters": 16595, "module_train_batch_size_mean": 997.8691961675322, "num_module_steps_trained_lifetime_throughput": 758.7253305760488}, "intrinsic_reward_module": {"num_module_steps_trained_lifetime": 29925, "num_module_steps_trained": 5985, "diff_num_grad_updates_vs_sampler_policy": 1.0, "total_loss": 0.0, "gradients_default_optimizer_global_norm": 0.0, "module_train_batch_size_mean": 997.8691961675322, "default_optimizer_learning_rate": 0.0002715581955, "weights_seq_no": 5.0, "num_trainable_parameters": 8266, "curr_entropy_coeff": 0.0015431216992, "num_module_steps_trained_lifetime_throughput": 758.7388753127154}, "differentiable_learners": {"intrinsic_attention_ppo_learner": {"default_policy": {"weights_seq_no": 30.0, "num_module_steps_trained": 35910, "num_module_steps_trained_lifetime": 179550, "entropy": 0.6887288093566895, "diff_num_grad_updates_vs_sampler_policy": 26.0, "vf_loss": 0.35852155089378357, "vf_loss_unclipped": 43.49679946899414, "total_loss": 0.2780359089374542, "mean_kl_loss": 1.6756830518716015e-05, "policy_loss": -0.00021057987760286778, "use_intrinsic_rewards": 1.0, "module_train_batch_size_mean": 997.5798029998547, "vf_explained_var": -0.001624464988708496}, "__all_modules__": {"num_env_steps_trained": 198000, "num_module_steps_trained": 71820, "num_module_steps_trained_lifetime": 359100, "num_env_steps_trained_lifetime": 990000, "num_env_steps_trained_lifetime_throughput": 37011.928706864324}, "intrinsic_reward_module": {"weights_seq_no": 30.0, "num_module_steps_trained_lifetime": 179550, "num_module_steps_trained": 35910, "diff_num_grad_updates_vs_sampler_policy": 26.0, "total_loss": 0.0, "module_train_batch_size_mean": 997.5798029998547}}}, "__all_modules__": {"num_env_steps_trained_lifetime": 165000, "num_non_trainable_parameters": 0, "num_trainable_parameters": 24861, "num_env_steps_trained": 33000, "num_module_steps_trained": 11970, "num_module_steps_trained_lifetime": 59850, "num_env_steps_trained_lifetime_throughput": 4185.22165461607, "num_module_steps_trained_throughput": 27047237.214620717, "num_module_steps_trained_lifetime_throughput": 13071964.060810363}, "IntrinsicAttentionMask": [[[0.0908726155757904, 0.09156735986471176, 0.09062257409095764, 0.09062761068344116, 0.09158264100551605, 0.09104762226343155, 0.09064272791147232, 0.09064776450395584, 0.09160301089286804, 0.09065785259008408, 0.09012824296951294], [0.09082839637994766, 0.0923168808221817, 0.09029582142829895, 0.09030654281377792, 0.09234976023435593, 0.09120213985443115, 0.09033869951963425, 0.09034942090511322, 0.09239360690116882, 0.09037087112665176, 0.08924784511327744], [0.0908878743648529, 0.0912969559431076, 0.09074033051729202, 0.0907433032989502, 0.0913059413433075, 0.09099104255437851, 0.09075222909450531, 0.09075520187616348, 0.09131791442632675, 0.09076115489006042, 0.09044814109802246], [0.09088755398988724, 0.09130240231752396, 0.09073793888092041, 0.09074096381664276, 0.0913115069270134, 0.09099218249320984, 0.09075000882148743, 0.09075302630662918, 0.09132365137338638, 0.09075906127691269, 0.09044166654348373], [0.09082739055156708, 0.09233333170413971, 0.09028864651918411, 0.09029948711395264, 0.09236659854650497, 0.09120550006628036, 0.0903320163488388, 0.09034286439418793, 0.09241096675395966, 0.09036456048488617, 0.08922863006591797], [0.0908617228269577, 0.0917564257979393, 0.09054019302129745, 0.09054667502641678, 0.09177611768245697, 0.09108692407608032, 0.09056611359119415, 0.09057258814573288, 0.09180238097906113, 0.09058555215597153, 0.08990529924631119], [0.09088664501905441, 0.0913187637925148, 0.09073082357645035, 0.09073396772146225, 0.09132824838161469, 0.09099561721086502, 0.09074338525533676, 0.09074652940034866, 0.09134089946746826, 0.09075281769037247, 0.09042228013277054], [0.09088633209466934, 0.09132421016693115, 0.09072844684123993, 0.09073162078857422, 0.09133382141590118, 0.09099675714969635, 0.09074117988348007, 0.09074436128139496, 0.09134664386510849, 0.09075073152780533, 0.09041581302881241], [0.09082605689764023, 0.09235527366399765, 0.09027907997369766, 0.09029008448123932, 0.0923890545964241, 0.09120997041463852, 0.09032311290502548, 0.09033412486314774, 0.0924341157078743, 0.09035614877939224, 0.08920300751924515], [0.09088573604822159, 0.09133512526750565, 0.09072370082139969, 0.09072697162628174, 0.09134499728679657, 0.0909990519285202, 0.09073677659034729, 0.09074003994464874, 0.09135815501213074, 0.09074657410383224, 0.09040290117263794], [0.09091697633266449, 0.09076133370399475, 0.09097334742546082, 0.09097220748662949, 0.09075793623924255, 0.09087763726711273, 0.0909687951207161, 0.09096765518188477, 0.09075339138507843, 0.0909653827548027, 0.09108535200357437]], [[0.09075230360031128, 0.08753388375043869, 0.08754467964172363, 0.09078587591648102, 0.08961420506238937, 0.08757705986499786, 0.0875878557562828, 0.08964735269546509, 0.11167890578508377, 0.08863893151283264, 0.08863893151283264], [0.09090159088373184, 0.09121062606573105, 0.09120956808328629, 0.09089843183755875, 0.0910094827413559, 0.091206394135952, 0.09120534360408783, 0.0910063162446022, 0.08914589881896973, 0.09110313653945923, 0.09110313653945923], [0.09090195596218109, 0.09119869768619537, 0.09119768440723419, 0.09089892357587814, 0.09100556373596191, 0.09119463711977005, 0.09119362384080887, 0.09100252389907837, 0.08921537548303604, 0.09109549224376678, 0.09109549224376678], [0.09074793756008148, 0.08749426156282425, 0.08750516921281815, 0.09078188240528107, 0.08959721773862839, 0.08753790706396103, 0.08754882216453552, 0.08963073045015335, 0.11193348467350006, 0.08861126750707626, 0.08861126750707626], [0.09086542576551437, 0.08886141330003738, 0.0888681709766388, 0.0908861830830574, 0.09015991538763046, 0.08888847380876541, 0.08889524638652802, 0.09018050879240036, 0.10328952223062515, 0.0895526185631752, 0.0895526185631752], [0.09090302884578705, 0.09116287529468536, 0.09116198122501373, 0.09090036898851395, 0.09099376201629639, 0.09115932136774063, 0.091158427298069, 0.09099110215902328, 0.08942410349845886, 0.09107251465320587, 0.09107251465320587], [0.0909033715724945, 0.0911509245634079, 0.09115007519721985, 0.09090083837509155, 0.09098981320858002, 0.0911475419998169, 0.09114669263362885, 0.09098728001117706, 0.0894937738776207, 0.09106484055519104, 0.09106484055519104], [0.09086307138204575, 0.08882316201925278, 0.08883004635572433, 0.09088420867919922, 0.09014482796192169, 0.0888507068157196, 0.08885759860277176, 0.09016579389572144, 0.10352727770805359, 0.08952666074037552, 0.08952666074037552], [0.07615578919649124, 0.05853799730539322, 0.0585906058549881, 0.0763612911105156, 0.0694650262594223, 0.05874871462583542, 0.05880150943994522, 0.0696524828672409, 0.3454039692878723, 0.06414131820201874, 0.06414131820201874], [0.09090936183929443, 0.08997505903244019, 0.08997822552919388, 0.09091898053884506, 0.09058171510696411, 0.08998774737119675, 0.08999092131853104, 0.09059130400419235, 0.09646953642368317, 0.09029857814311981, 0.09029857814311981], [0.09090936183929443, 0.08997505903244019, 0.08997822552919388, 0.09091898053884506, 0.09058171510696411, 0.08998774737119675, 0.08999092131853104, 0.09059130400419235, 0.09646953642368317, 0.09029857814311981, 0.09029857814311981]], [[0.09101957082748413, 0.09117458760738373, 0.09076912701129913, 0.09077417105436325, 0.09118979424238205, 0.09119486808776855, 0.09025391936302185, 0.09079436212778091, 0.09175115078687668, 0.09080446511507034, 0.09027399867773056], [0.09104730188846588, 0.09124170243740082, 0.09073340147733688, 0.09073971956968307, 0.09126077592372894, 0.09126714617013931, 0.09008834511041641, 0.09076502174139023, 0.09196548908948898, 0.0907776802778244, 0.09011346846818924], [0.09097444266080856, 0.09106576442718506, 0.09082675725221634, 0.09082973748445511, 0.09107472002506256, 0.09107770770788193, 0.0905224159359932, 0.09084164351224899, 0.09140489250421524, 0.09084760397672653, 0.0905342847108841], [0.09097535908222198, 0.09106796979904175, 0.09082559496164322, 0.09082861989736557, 0.0910770520567894, 0.09108008444309235, 0.09051699936389923, 0.09084069728851318, 0.09141187369823456, 0.09084673970937729, 0.09052903950214386], [0.09105000644922256, 0.09124826639890671, 0.09072988480329514, 0.09073632955551147, 0.09126772731542587, 0.0912742167711258, 0.09007211774587631, 0.09076213091611862, 0.0919865146279335, 0.09077504277229309, 0.09009773284196854], [0.09105091542005539, 0.0912504568696022, 0.09072871506214142, 0.09073520451784134, 0.09127004444599152, 0.09127657860517502, 0.09006671607494354, 0.09076116979122162, 0.09199352562427521, 0.09077416360378265, 0.0900924876332283], [0.09088029712438583, 0.0908403992652893, 0.09094494581222534, 0.09094364196062088, 0.09083648771047592, 0.09083518385887146, 0.09107864648103714, 0.09093842655420303, 0.09069272875785828, 0.09093581140041351, 0.0910734161734581], [0.09097900241613388, 0.09107675403356552, 0.09082095324993134, 0.09082413464784622, 0.09108634293079376, 0.09108953922986984, 0.09049530327320099, 0.09083688259124756, 0.09143978357315063, 0.09084326028823853, 0.09050800651311874], [0.09114905446767807, 0.09148970246315002, 0.09060013294219971, 0.09061117470264435, 0.0915231704711914, 0.0915343314409256, 0.0894765853881836, 0.0906553715467453, 0.09276282787322998, 0.09067747741937637, 0.08952023088932037], [0.09098083525896072, 0.0910811498761177, 0.0908186286687851, 0.09082189947366714, 0.09109098464250565, 0.09109427034854889, 0.09048445522785187, 0.09083498269319534, 0.09145374596118927, 0.09084152430295944, 0.09049749374389648], [0.0908840000629425, 0.09084922075271606, 0.09094035625457764, 0.09093921631574631, 0.09084580838680267, 0.09084467589855194, 0.09105687588453293, 0.09093466401100159, 0.09072048217058182, 0.09093239158391953, 0.09105232357978821]], [[0.09201359748840332, 0.09156722575426102, 0.09098372608423233, 0.0926261767745018, 0.09263179451227188, 0.09158945083618164, 0.09159500151872635, 0.09205268323421478, 0.08169254660606384, 0.09154163300991058, 0.09170618653297424], [0.09135212749242783, 0.09117830544710159, 0.09095031023025513, 0.09158983081579208, 0.09159200638532639, 0.09118697047233582, 0.09118913859128952, 0.09136731922626495, 0.08719319850206375, 0.09116832911968231, 0.09123247116804123], [0.09043268114328384, 0.09061232209205627, 0.09084901213645935, 0.09018813818693161, 0.09018590301275253, 0.09060334414243698, 0.09060110151767731, 0.09041700512170792, 0.09493155777454376, 0.09062265604734421, 0.09055626392364502], [0.09286589920520782, 0.09204308688640594, 0.09097253531217575, 0.09400047361850739, 0.09401091188192368, 0.09208397567272186, 0.09209420531988144, 0.09293811023235321, 0.0746959000825882, 0.09199602156877518, 0.09229888767004013], [0.09287343174219131, 0.09204715490341187, 0.09097214043140411, 0.09401282668113708, 0.09402330964803696, 0.09208821505308151, 0.09209848195314407, 0.09294593334197998, 0.07463452965021133, 0.09199988842010498, 0.09230402857065201], [0.09138590097427368, 0.09119854867458344, 0.09095285087823868, 0.09164214879274368, 0.09164449572563171, 0.09120789170265198, 0.09121022373437881, 0.09140227735042572, 0.08691094070672989, 0.09118779003620148, 0.09125693142414093], [0.0913943275809288, 0.09120359271764755, 0.09095346927642822, 0.09165522456169128, 0.0916576087474823, 0.09121310710906982, 0.09121548384428024, 0.09141100198030472, 0.08684051036834717, 0.09119264781475067, 0.09126302599906921], [0.09206986427307129, 0.09159954637289047, 0.09098493307828903, 0.09271549433469772, 0.09272141754627228, 0.0916229635477066, 0.09162881225347519, 0.09211105108261108, 0.08122744411230087, 0.0915725901722908, 0.09174595028162003], [0.06440939754247665, 0.06890817731618881, 0.07530359923839569, 0.05874095857143402, 0.05869149789214134, 0.06867639720439911, 0.06861857324838638, 0.06403074413537979, 0.33597201108932495, 0.0691760778427124, 0.06747255474328995], [0.09131313115358353, 0.09115488082170486, 0.09094727039337158, 0.0915294960141182, 0.09153147786855698, 0.091162770986557, 0.09116474539041519, 0.09132695943117142, 0.08751928061246872, 0.09114579111337662, 0.0912042036652565], [0.09156184643507004, 0.09130335599184036, 0.0909646600484848, 0.09191572666168213, 0.09191896766424179, 0.09131623059511185, 0.09131945669651031, 0.0915844514966011, 0.08544295281171799, 0.09128851443529129, 0.09138388186693192]], [[0.09101906418800354, 0.09171493351459503, 0.09023334085941315, 0.09023836255073547, 0.09118928760290146, 0.09119435399770737, 0.09078880399465561, 0.09079385548830032, 0.09175063669681549, 0.09080395847558975, 0.09027349203824997], [0.09114045649766922, 0.09263405948877335, 0.08946949243545532, 0.08948010951280594, 0.09150463342666626, 0.09151548892259598, 0.0906490832567215, 0.09065983444452286, 0.09271104633808136, 0.09068135917186737, 0.08955448120832443], [0.09087654203176498, 0.0906752198934555, 0.09110627323389053, 0.09110479801893234, 0.09082711488008499, 0.0908256396651268, 0.0909436047077179, 0.0909421294927597, 0.09066493809223175, 0.09093917906284332, 0.091094471514225], [0.0908774808049202, 0.09068186581134796, 0.09110067039728165, 0.09109923988580704, 0.09082945436239243, 0.09082802385091782, 0.0909426286816597, 0.09094119817018509, 0.09067188203334808, 0.09093833714723587, 0.09108920395374298], [0.09104915708303452, 0.09193990379571915, 0.09004567563533783, 0.09005207568407059, 0.09126687794923782, 0.09127335995435715, 0.09075484424829483, 0.09076128900051117, 0.09198565781116486, 0.09077419340610504, 0.09009689092636108], [0.09105005860328674, 0.09194660931825638, 0.09004009515047073, 0.09004653990268707, 0.09126918762922287, 0.09127571433782578, 0.09075383096933365, 0.09076032042503357, 0.09199266135692596, 0.09077330678701401, 0.09009164571762085], [0.09097789973020554, 0.09141045063734055, 0.0904879942536354, 0.09049112349748611, 0.091083824634552, 0.0910869762301445, 0.09083449840545654, 0.09083764255046844, 0.0914326086640358, 0.09084393829107285, 0.09051306545734406], [0.09097880125045776, 0.09141712635755539, 0.09048239886760712, 0.0904855728149414, 0.09108614176511765, 0.09108933806419373, 0.09083350002765656, 0.09083668142557144, 0.09143958240747452, 0.09084305912256241, 0.09050779789686203], [0.0911465585231781, 0.09268117696046829, 0.08943053334951401, 0.08944143354892731, 0.09152067452669144, 0.09153182804584503, 0.09064184129238129, 0.09065289050340652, 0.09276029467582703, 0.0906749963760376, 0.08951778709888458], [0.09098061919212341, 0.09143047779798508, 0.09047120809555054, 0.09047447144985199, 0.09109077602624893, 0.09109405428171158, 0.09083149582147598, 0.09083476662635803, 0.09145352989435196, 0.09084130823612213, 0.09049727767705917], [0.09088397026062012, 0.09072839468717575, 0.09106139838695526, 0.09106025844812393, 0.09084577858448029, 0.09084464609622955, 0.09093576669692993, 0.0909346342086792, 0.09072044491767883, 0.09093235433101654, 0.09105228632688522]], [[0.09201942384243011, 0.09157302230596542, 0.09098948538303375, 0.092036172747612, 0.0920417532324791, 0.09159523993730545, 0.09101156890392303, 0.0926545187830925, 0.08222665637731552, 0.09214013069868088, 0.09171199053525925], [0.09135303646326065, 0.09117921441793442, 0.09095121920108795, 0.09135954827070236, 0.09136171638965607, 0.09118787944316864, 0.09095986187458038, 0.09159944951534271, 0.08741471916437149, 0.09139995276927948, 0.09123338758945465], [0.09043370187282562, 0.09061335027217865, 0.09085004031658173, 0.0904269888997078, 0.09042474627494812, 0.09060437977313995, 0.09084104746580124, 0.09018023312091827, 0.0946829542517662, 0.09038534015417099, 0.0905572921037674], [0.09204383194446564, 0.09158716350793839, 0.09099029749631882, 0.09206096082925797, 0.0920666754245758, 0.0916099026799202, 0.09101288765668869, 0.09269361197948456, 0.082038015127182, 0.09216731786727905, 0.09172932803630829], [0.09205195307731628, 0.09159187227487564, 0.09099055826663971, 0.09206922352313995, 0.09207497537136078, 0.09161477535963058, 0.09101331233978271, 0.09270663559436798, 0.08197522163391113, 0.09217637032270432, 0.0917351022362709], [0.09138695895671844, 0.0911996066570282, 0.09095390886068344, 0.09139398485422134, 0.09139631688594818, 0.09120894968509674, 0.0909632220864296, 0.09165260195732117, 0.08714896440505981, 0.09143752604722977, 0.0912579894065857], [0.09046952426433563, 0.09063585847616196, 0.09085497260093689, 0.0904633030295372, 0.09046123921871185, 0.09062755107879639, 0.09084665030241013, 0.09023479372262955, 0.09439744055271149, 0.09042473882436752, 0.09058395773172379], [0.09291557967662811, 0.09207874536514282, 0.0909901112318039, 0.09294705092906952, 0.09295754879713058, 0.09212032705545425, 0.09103120118379593, 0.09411219507455826, 0.07536586374044418, 0.09314246475696564, 0.09233888983726501], [0.06787668168544769, 0.07233309745788574, 0.07863947004079819, 0.06771532446146011, 0.06766162812709808, 0.07210391759872437, 0.07839032262563705, 0.06203841045498848, 0.2956051528453827, 0.06672308593988419, 0.07091288268566132], [0.09219434857368469, 0.09167396277189255, 0.09099433571100235, 0.09221388399600983, 0.09222039580345154, 0.09169985353946686, 0.09102004766464233, 0.09293542057275772, 0.08087675273418427, 0.09233513474464417, 0.09183591604232788], [0.09156384319067001, 0.09130535274744034, 0.09096664190292358, 0.09157352894544601, 0.09157676249742508, 0.09131823480129242, 0.09097948670387268, 0.09193070232868195, 0.08576598018407822, 0.09163364768028259, 0.09138587862253189]]]}, "num_training_step_calls_per_iteration": 1, "evaluation": {"env_runners": {"module_to_env_connector": {"timers": {"connectors": {"tensor_to_numpy": 1.65641301292631e-05, "un_batch_to_individual_items": 7.219301885103502e-06, "get_actions": 4.139014744796701e-05, "listify_data_for_vector_env": 1.153547429910426e-05, "normalize_and_clip_actions": 8.685609886747822e-06, "remove_single_ts_time_rank_from_batch": 1.2562936611600414e-05}}, "connector_pipeline_timer": 0.000126240828883034}, "episode_len_min": 20, "num_env_steps_sampled": 400, "weights_seq_no": 5.0, "episode_len_mean": 20.0, "env_to_module_sum_episodes_length_out": 10.368238387501162, "episode_len_max": 20, "env_to_module_connector": {"timers": {"connectors": {"batch_individual_items": 1.3161522834664085e-05, "add_observations_from_episodes_to_batch": 3.1016002079153306e-06, "add_states_from_episodes_to_batch": 2.9225030068848357e-06, "add_time_dim_to_batch_and_zero_pad": 7.586564070904116e-06, "numpy_to_tensor": 1.3005717763263252e-05}}, "connector_pipeline_timer": 6.271769092520601e-05}, "env_to_module_sum_episodes_length_in": 10.368238387501162, "num_episodes_lifetime": 100, "episode_duration_sec_mean": 0.0063320612418465315, "episode_return_max": 12.5, "rlmodule_inference_timer": 3.511257175191195e-05, "num_agent_steps_sampled": {"default_agent": 400}, "num_module_steps_sampled_lifetime": {"default_policy": 2000}, "num_agent_steps_sampled_lifetime": {"default_agent": 2000}, "num_module_steps_sampled": {"default_policy": 400}, "sample": 0.13237141570337146, "episode_return_mean": -0.6, "env_step_timer": 1.5685011073143423e-05, "agent_episode_returns_mean": {"default_agent": -0.6}, "num_episodes": 20, "module_episode_returns_mean": {"default_policy": -0.6}, "episode_return_min": -12.5, "num_env_steps_sampled_lifetime": 25400, "env_reset_timer": 0.0005819718610864865, "time_between_sampling": 12.535561071886882}, "num_healthy_workers": 1, "actor_manager_num_outstanding_async_reqs": 0, "num_remote_worker_restarts": 0}, "num_env_steps_sampled_lifetime": -1842500.0, "fault_tolerance": {"num_healthy_workers": 0, "num_remote_worker_restarts": 0}, "env_runner_group": {"actor_manager_num_outstanding_async_reqs": 0}, "done": false, "training_iteration": 5, "trial_id": "ae8a2_00000", "date": "2025-08-11_18-23-29", "timestamp": 1754929409, "time_this_iter_s": 13.490297794342041, "time_total_s": 62.910393476486206, "pid": 10870, "hostname": "Mac", "node_ip": "127.0.0.1", "config": {"exploration_config": {}, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 2, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "env": "Umbrella", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": false, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 0, "create_local_env_runner": true, "num_envs_per_env_runner": 1, "gym_env_vectorize_mode": "SYNC", "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "episodes_to_numpy": true, "max_requests_in_flight_per_env_runner": 1, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "merge_env_runner_states": "training_only", "broadcast_env_runner_states": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "complete_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "sampler_perf_stats_ema_coef": null, "_is_online": true, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": "auto", "num_aggregator_actors_per_learner": 0, "max_requests_in_flight_per_aggregator_actor": 3, "local_gpu_idx": 0, "max_requests_in_flight_per_learner": 3, "gamma": 1, "lr": 0.0002715581955, "grad_clip": 0.5, "grad_clip_by": "global_norm", "_train_batch_size_per_learner": 5000, "train_batch_size": 4000, "num_epochs": 1, "minibatch_size": 1000, "shuffle_batch_per_epoch": true, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "log_std_clip_param": 20.0, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "_disable_preprocessor_api": false, "_disable_action_flattening": false}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {"intrinsic_reward_coeff": 0.2795015916508}, "optimizer": {}, "_learner_class": "<class 'source.intrinsic_attention_ppo.learners.IntrinsicAttentionMetaLearner.IntrinsicAttentionMetaLearner'>", "callbacks_on_algorithm_init": null, "callbacks_on_env_runners_recreated": null, "callbacks_on_offline_eval_runners_recreated": null, "callbacks_on_checkpoint_loaded": null, "callbacks_on_environment_created": null, "callbacks_on_episode_created": null, "callbacks_on_episode_start": null, "callbacks_on_episode_step": null, "callbacks_on_episode_end": null, "callbacks_on_evaluate_start": null, "callbacks_on_evaluate_end": null, "callbacks_on_evaluate_offline_start": null, "callbacks_on_evaluate_offline_end": null, "callbacks_on_sample_end": null, "callbacks_on_train_result": null, "explore": true, "enable_rl_module_and_learner": true, "enable_env_runner_and_connector_v2": true, "_prior_exploration_config": {"type": "StochasticSampling"}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x38844d8a0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "offline_data_class": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_read_batch_size": null, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "materialize_data": false, "materialize_mapped_data": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "ignore_final_observation": false, "prelearner_class": null, "prelearner_buffer_class": null, "prelearner_buffer_kwargs": {}, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_remaining_data": false, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": 1, "evaluation_duration": 20, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_auto_duration_min_env_steps_per_sample": 100, "evaluation_auto_duration_max_env_steps_per_sample": 2000, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 1, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "offline_evaluation_interval": null, "num_offline_eval_runners": 0, "offline_loss_for_module_fn": null, "offline_evaluation_duration": 1, "offline_evaluation_parallel_to_training": false, "offline_evaluation_timeout_s": 120.0, "num_cpus_per_offline_eval_runner": 1, "num_gpus_per_offline_eval_runner": 0, "custom_resources_per_offline_eval_runner": {}, "restart_failed_offline_eval_runners": true, "ignore_offline_eval_runner_failures": false, "max_num_offline_eval_runner_restarts": 1000, "offline_eval_runner_restore_timeout_s": 1800.0, "max_requests_in_flight_per_offline_eval_runner": 1, "validate_offline_eval_runners_after_construction": true, "offline_eval_runner_health_probe_timeout_s": 30.0, "offline_eval_rl_module_inference_only": false, "broadcast_offline_eval_runner_states": false, "offline_eval_batch_size_per_runner": 256, "dataset_num_iters_per_eval_runner": 1, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "log_gradients": false, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 1, "restart_failed_env_runners": true, "ignore_env_runner_failures": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30.0, "env_runner_restore_timeout_s": 1800.0, "_model_config": {}, "_rl_module_spec": "MultiRLModuleSpec(multi_rl_module_class=<class 'ray.rllib.core.rl_module.multi_rl_module.MultiRLModule'>, observation_space=None, action_space=None, inference_only=False, model_config=None, rl_module_specs={'default_policy': RLModuleSpec(module_class=<class 'source.intrinsic_attention_ppo.rl_modules.DifferentiablePPOModule.DifferentiablePPOModule'>, observation_space=None, action_space=None, inference_only=False, learner_only=False, model_config={'vf_share_layers': True, 'embedding_dim': 62, 'max_seq_len': 11, 'policy_head_hidden_sizes': [32], 'value_head_hidden_sizes': [101], 'embedding_hidden_sizes': [121]}, catalog_class=None, load_state_path=None, model_config_dict=None), 'intrinsic_reward_module': RLModuleSpec(module_class=<class 'source.intrinsic_attention_ppo.rl_modules.IntrinsicAttentionModule.IntrinsicAttentionModule'>, observation_space=None, action_space=None, inference_only=False, learner_only=True, model_config={'intrinsic_reward_network': {'encoder_hidden_sizes': [], 'encoding_dim': 1, 'num_heads': 1, 'head_hidden_sizes': None, 'layers': [{'type': 'attention'}]}, 'extrinsic_value_hidden_layers': [127, 60], 'vf_share_layers': True, 'max_seq_len': 11}, catalog_class=None, load_state_path=None, model_config_dict=None)}, load_state_path=None, modules_to_load=None, module_specs={'default_policy': RLModuleSpec(module_class=<class 'source.intrinsic_attention_ppo.rl_modules.DifferentiablePPOModule.DifferentiablePPOModule'>, observation_space=None, action_space=None, inference_only=False, learner_only=False, model_config={'vf_share_layers': True, 'embedding_dim': 62, 'max_seq_len': 11, 'policy_head_hidden_sizes': [32], 'value_head_hidden_sizes': [101], 'embedding_hidden_sizes': [121]}, catalog_class=None, load_state_path=None, model_config_dict=None), 'intrinsic_reward_module': RLModuleSpec(module_class=<class 'source.intrinsic_attention_ppo.rl_modules.IntrinsicAttentionModule.IntrinsicAttentionModule'>, observation_space=None, action_space=None, inference_only=False, learner_only=True, model_config={'intrinsic_reward_network': {'encoder_hidden_sizes': [], 'encoding_dim': 1, 'num_heads': 1, 'head_hidden_sizes': None, 'layers': [{'type': 'attention'}]}, 'extrinsic_value_hidden_layers': [127, 60], 'vf_share_layers': True, 'max_seq_len': 11}, catalog_class=None, load_state_path=None, model_config_dict=None)})", "algorithm_config_overrides_per_module": {"intrinsic_reward_module": {"lr": 0.0002715581955}}, "_per_module_overrides": {}, "_validate_config": true, "_use_msgpack_checkpoints": false, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "env_task_fn": -1, "enable_connectors": -1, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.161583927863, "kl_target": 0.0201019014258, "vf_loss_coeff": 0.7790510010087, "entropy_coeff": 0.0015431216992, "clip_param": 0.2459212356676, "vf_clip_param": 0.3769744131561, "entropy_coeff_schedule": null, "lr_schedule": null, "sgd_minibatch_size": -1, "vf_share_layers": -1, "differentiable_learner_configs": ["DifferentiableLearnerConfig(learner_class=<class 'source.intrinsic_attention_ppo.learners.IntrinsicAttentionPPOLearner.IntrinsicAttentionPPOLearner'>, learner_connector=None, add_default_connectors_to_learner_pipeline=True, is_multi_agent=False, policies_to_update=['default_policy'], lr=0.0060984166342, num_total_minibatches=0, num_epochs=1, minibatch_size=1000, shuffle_batch_per_epoch=True)"], "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9485408017724, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.callbacks.callbacks.RLlibCallback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 62.910393476486206, "iterations_since_restore": 5, "perf": {"cpu_util_percent": 66.35499999999999, "ram_util_percent": 82.90500000000002}}
{"timers": {"training_iteration": 12.62861903162477, "restore_env_runners": 1.2568857451287587e-05, "training_step": 12.628421822745873, "env_runner_sampling_timer": 2.9027087764333084, "learner_update_timer": 9.50702381451891, "synch_weights": 0.001671657840239211, "restore_eval_env_runners": 5.4138026228409726e-05, "evaluation_iteration": 0.14441611928004794, "synch_eval_env_connectors": 0.00023002989674928594, "synch_env_connectors": 6.113613061083016e-06}, "env_runners": {"module_to_env_connector": {"connector_pipeline_timer": 0.00012477505868609796, "timers": {"connectors": {"remove_single_ts_time_rank_from_batch": 1.2324861837400537e-05, "un_batch_to_individual_items": 6.794288482741328e-06, "get_actions": 4.202647812317109e-05, "tensor_to_numpy": 1.5873628073053464e-05, "listify_data_for_vector_env": 1.0953032075324388e-05, "normalize_and_clip_actions": 8.273158440345579e-06}}}, "rlmodule_inference_timer": 3.402478215888741e-05, "sample": 0.006230105281754371, "weights_seq_no": 5.0, "num_agent_steps_sampled": {"default_agent": 5000.0}, "episode_len_mean": 20.0, "episode_len_max": 20, "env_to_module_connector": {"timers": {"connectors": {"batch_individual_items": 1.3134121711066662e-05, "add_states_from_episodes_to_batch": 2.798513755447553e-06, "numpy_to_tensor": 1.3519432973399278e-05, "add_observations_from_episodes_to_batch": 2.9679940877411475e-06, "add_time_dim_to_batch_and_zero_pad": 7.241820453438857e-06}}, "connector_pipeline_timer": 6.297057027737166e-05}, "env_to_module_sum_episodes_length_out": 10.36823839457432, "num_agent_steps_sampled_lifetime": {"default_agent": -2460000.0}, "episode_return_mean": 0.06, "num_module_steps_sampled_lifetime": {"default_policy": -2460000.0}, "num_episodes": 250.0, "time_between_sampling": 0.04672048585740801, "num_env_steps_sampled_lifetime": -2460000.0, "episode_return_min": -10.5, "env_reset_timer": 5.344652326306632e-05, "env_to_module_sum_episodes_length_in": 10.36823839457432, "num_episodes_lifetime": -123000.0, "agent_episode_returns_mean": {"default_agent": 0.06}, "episode_len_min": 20, "episode_duration_sec_mean": 0.005459934163838624, "env_step_timer": 1.4907291668298274e-05, "episode_return_max": 9.5, "num_module_steps_sampled": {"default_policy": 5000.0}, "module_episode_returns_mean": {"default_policy": 0.06}, "num_env_steps_sampled": 5000.0, "num_env_steps_sampled_lifetime_throughput": 3083.0432487191574}, "__all_modules__": {"learner_connector_sum_episodes_length_in": 5000.0, "learner_connector": {"connector_pipeline_timer": 0.16227353242696574, "timers": {"connectors": {"add_one_ts_to_episodes_and_truncate": 0.009370031015097143, "add_observations_from_episodes_to_batch": 0.0016565259896054148, "add_columns_from_episodes_to_train_batch": 0.0498512246750791, "add_time_dim_to_batch_and_zero_pad": 0.0855397352367433, "add_states_from_episodes_to_batch": 0.009032262467195365, "batch_individual_items": 0.006472721036017316, "numpy_to_tensor": 9.714420314274544e-05}}}, "learner_connector_sum_episodes_length_out": 5250.0}, "learners": {"default_policy": {"curr_entropy_coeff": 0.0015431216992, "curr_kl_coeff": 0.0025247489102184772, "num_module_steps_trained_lifetime": 35910, "entropy": 0.6875797510147095, "num_module_steps_trained": 5985, "diff_num_grad_updates_vs_sampler_policy": 1.0, "vf_loss": 0.35831740498542786, "vf_loss_unclipped": 43.530540466308594, "policy_loss": -0.0009926864877343178, "use_intrinsic_rewards": 0.0, "total_loss": 0.2770940959453583, "vf_explained_var": 0.0026931166648864746, "mean_kl_loss": 5.575475006480701e-05, "weights_seq_no": 6.0, "num_trainable_parameters": 16595, "module_train_batch_size_mean": 997.8474438281662, "num_module_steps_trained_lifetime_throughput": 751.4053417195037}, "intrinsic_reward_module": {"num_module_steps_trained_lifetime": 35910, "num_module_steps_trained": 5985, "diff_num_grad_updates_vs_sampler_policy": 1.0, "total_loss": 0.0, "gradients_default_optimizer_global_norm": 0.0, "module_train_batch_size_mean": 997.8474438281662, "default_optimizer_learning_rate": 0.0002715581955, "weights_seq_no": 6.0, "num_trainable_parameters": 8266, "curr_entropy_coeff": 0.0015431216992, "num_module_steps_trained_lifetime_throughput": 751.4179601257871}, "differentiable_learners": {"intrinsic_attention_ppo_learner": {"default_policy": {"weights_seq_no": 36.0, "num_module_steps_trained": 35910, "num_module_steps_trained_lifetime": 215460, "entropy": 0.6876282095909119, "diff_num_grad_updates_vs_sampler_policy": 31.0, "vf_loss": 0.3585047125816345, "vf_loss_unclipped": 43.63846969604492, "total_loss": 0.2772923409938812, "mean_kl_loss": 5.099642294226214e-05, "policy_loss": -0.0009482897003181279, "use_intrinsic_rewards": 1.0, "module_train_batch_size_mean": 997.5548130830801, "vf_explained_var": -0.001599431037902832}, "__all_modules__": {"num_env_steps_trained": 198000, "num_module_steps_trained": 71820, "num_module_steps_trained_lifetime": 430920, "num_env_steps_trained_lifetime": 1188000, "num_env_steps_trained_lifetime_throughput": 36647.52953015529}, "intrinsic_reward_module": {"weights_seq_no": 36.0, "num_module_steps_trained_lifetime": 215460, "num_module_steps_trained": 35910, "diff_num_grad_updates_vs_sampler_policy": 31.0, "total_loss": 0.0, "module_train_batch_size_mean": 997.5548130830801}}}, "__all_modules__": {"num_env_steps_trained_lifetime": 198000, "num_non_trainable_parameters": 0, "num_trainable_parameters": 24861, "num_env_steps_trained": 33000, "num_module_steps_trained": 11970, "num_module_steps_trained_lifetime": 71820, "num_env_steps_trained_lifetime_throughput": 4144.80084569935, "num_module_steps_trained_throughput": 26200619.9318901, "num_module_steps_trained_lifetime_throughput": 12914138.721437445}, "IntrinsicAttentionMask": [[[0.09220390021800995, 0.09119339287281036, 0.08943168818950653, 0.09044158458709717, 0.09224247932434082, 0.09225212782621384, 0.08946910500526428, 0.08947847038507462, 0.09228107333183289, 0.09049835801124573, 0.09050782024860382], [0.09160269796848297, 0.09106314927339554, 0.09011581540107727, 0.09065991640090942, 0.09162323921918869, 0.09162837266921997, 0.09013602882623672, 0.09014108031988144, 0.091643787920475, 0.09069041907787323, 0.09069550782442093], [0.09054063260555267, 0.09082560241222382, 0.09133224934339523, 0.09104026108980179, 0.09052983671426773, 0.09052713215351105, 0.09132135659456253, 0.09131862968206406, 0.09051904082298279, 0.09102397412061691, 0.09102126210927963], [0.0911516398191452, 0.09096342325210571, 0.09063120186328888, 0.09082228690385818, 0.09115879237651825, 0.09116058051586151, 0.09063830971717834, 0.09064009040594101, 0.0911659449338913, 0.09083297848701477, 0.09083475917577744], [0.09222674369812012, 0.09119828045368195, 0.08940576016902924, 0.09043324738740921, 0.0922660082578659, 0.09227582812309265, 0.08944383263587952, 0.08945335447788239, 0.09230529516935349, 0.09049101173877716, 0.09050064533948898], [0.09223245084285736, 0.09119950979948044, 0.08939928561449051, 0.09043116122484207, 0.09227189421653748, 0.0922817587852478, 0.08943751454353333, 0.08944707363843918, 0.09231135249137878, 0.09048917889595032, 0.09049884974956512], [0.09056339412927628, 0.09083079546689987, 0.09130609780550003, 0.09103219956159592, 0.09055325388908386, 0.09055072069168091, 0.09129587560892105, 0.0912933275103569, 0.09054312109947205, 0.09101691097021103, 0.09101437032222748], [0.09056907147169113, 0.09083208441734314, 0.09129955619573593, 0.09103018045425415, 0.09055910259485245, 0.09055660665035248, 0.09128950536251068, 0.09128699451684952, 0.09054914116859436, 0.09101514518260956, 0.09101264178752899], [0.09224957972764969, 0.09120317548513412, 0.08937983959913254, 0.09042491018772125, 0.09228954464197159, 0.09229952841997147, 0.08941856026649475, 0.08942823857069016, 0.09232951700687408, 0.0904836654663086, 0.09049346297979355], [0.0911858081817627, 0.09097104519605637, 0.09059208631515503, 0.09081003069877625, 0.09119397401809692, 0.09119601547718048, 0.09060019999742508, 0.09060222655534744, 0.09120213985443115, 0.09082222729921341, 0.09082425385713577], [0.09119150787591934, 0.09097230434417725, 0.09058556705713272, 0.09080798178911209, 0.0911998301744461, 0.09120191633701324, 0.0905938372015953, 0.09059590846300125, 0.09120816737413406, 0.09082043170928955, 0.0908225029706955]], [[0.09393038600683212, 0.09096169471740723, 0.09203890711069107, 0.092871755361557, 0.09397158771753311, 0.09206918627023697, 0.09101157635450363, 0.09400250762701035, 0.07487864047288895, 0.09198234230279922, 0.09228138625621796], [0.09018134325742722, 0.09084991365671158, 0.0906042531132698, 0.09041672945022583, 0.09017224609851837, 0.09059739857912064, 0.09083845466375351, 0.09016542136669159, 0.09500773251056671, 0.09061706066131592, 0.09054943919181824], [0.09159616380929947, 0.09094864875078201, 0.09118548035621643, 0.09136711061000824, 0.0916050374507904, 0.0911921039223671, 0.09095966815948486, 0.09161169081926346, 0.08712245523929596, 0.09117309749126434, 0.09123849123716354], [0.09264656901359558, 0.0909779965877533, 0.0915861427783966, 0.09205422550439835, 0.09266956895589828, 0.09160319715738297, 0.09100622683763504, 0.09268682450056076, 0.08149237185716629, 0.09155429154634476, 0.09172260761260986], [0.09397924691438675, 0.09095992892980576, 0.0920553207397461, 0.09290238469839096, 0.09402116388082504, 0.09208612143993378, 0.09101065248250961, 0.09405262023210526, 0.07463286072015762, 0.09199779480695724, 0.09230192750692368], [0.09163500368595123, 0.09095041453838348, 0.09120077639818192, 0.09139280766248703, 0.09164439141750336, 0.09120777994394302, 0.09096205979585648, 0.09165143221616745, 0.08691084384918213, 0.09118768572807312, 0.09125681966543198], [0.09024831652641296, 0.09085609763860703, 0.09063282608985901, 0.0904623493552208, 0.09024004638195038, 0.09062659740447998, 0.09084568917751312, 0.09023384749889374, 0.09462681412696838, 0.090644471347332, 0.09058300405740738], [0.09401584416627884, 0.09095854312181473, 0.09206756949424744, 0.0929252877831459, 0.09405830502510071, 0.09209875017404556, 0.09100989252328873, 0.09409015625715256, 0.07444900274276733, 0.09200932830572128, 0.09231726825237274], [0.058834630995988846, 0.07529667764902115, 0.06878587603569031, 0.06418687850236893, 0.058636728674173355, 0.06861228495836258, 0.0749802216887474, 0.058488745242357254, 0.33565688133239746, 0.06911150366067886, 0.06740956753492355], [0.09152347594499588, 0.09094522148370743, 0.09115677326917648, 0.09131897985935211, 0.09153140336275101, 0.09116269648075104, 0.09095506370067596, 0.09153734147548676, 0.08751921355724335, 0.09114571660757065, 0.09120412170886993], [0.09190578758716583, 0.09096124023199081, 0.09130635857582092, 0.09157132357358932, 0.09191875904798508, 0.09131602942943573, 0.09097728878259659, 0.09192848205566406, 0.08544275909662247, 0.09128830581903458, 0.0913836658000946]], [[0.09111613035202026, 0.09181273728609085, 0.09032957255840302, 0.09033459424972534, 0.09182805567979813, 0.09183315932750702, 0.09034966677427292, 0.09035468846559525, 0.09130683541297913, 0.0903647318482399, 0.09036976844072342], [0.09134595841169357, 0.09284292906522751, 0.08967123180627823, 0.08968187123537064, 0.09287598729133606, 0.0928870141506195, 0.08971381187438965, 0.08972445875406265, 0.0917545035481453, 0.08974575996398926, 0.08975641429424286], [0.09084802865982056, 0.09064676612615585, 0.09107768535614014, 0.09107621014118195, 0.09064236283302307, 0.09064089506864548, 0.09107178449630737, 0.09107031673192978, 0.09079273045063019, 0.0910673588514328, 0.0910658910870552], [0.09084976464509964, 0.09065421670675278, 0.09107288718223572, 0.09107145667076111, 0.09064993262290955, 0.09064850956201553, 0.09106715768575668, 0.09106571972370148, 0.09079603850841522, 0.09106285870075226, 0.09106142818927765], [0.09135094285011292, 0.09286556392908096, 0.08965681493282318, 0.08966757357120514, 0.09289901703596115, 0.09291017055511475, 0.0896998792886734, 0.08971064537763596, 0.09176426380872726, 0.08973219245672226, 0.08974296599626541], [0.09135258942842484, 0.09287309646606445, 0.08965199440717697, 0.08966280519962311, 0.09290668368339539, 0.09291788190603256, 0.08969522267580032, 0.08970603346824646, 0.09176751971244812, 0.08972766250371933, 0.08973848074674606], [0.09085498750209808, 0.09067657589912415, 0.09105850011110306, 0.091057188808918, 0.09067267179489136, 0.09067137539386749, 0.09105326980352402, 0.09105196595191956, 0.09080597013235092, 0.09104935824871063, 0.09104804694652557], [0.09085672348737717, 0.09068403393030167, 0.09105370938777924, 0.09105244278907776, 0.09068025648593903, 0.09067899733781815, 0.09104865044355392, 0.09104738384485245, 0.09080928564071655, 0.09104485809803009, 0.09104359149932861], [0.091179758310318, 0.09209500998258591, 0.09014894813299179, 0.09015551954507828, 0.09211516380310059, 0.09212187677621841, 0.09017524868249893, 0.09018182754516602, 0.09143011271953583, 0.09019497781991959, 0.09020154923200607], [0.09086021035909653, 0.0906989574432373, 0.09104412794113159, 0.09104294329881668, 0.09069541841745377, 0.09069424867630005, 0.09103940427303314, 0.09103822708129883, 0.09081590920686722, 0.0910358652472496, 0.09103468060493469], [0.09086195379495621, 0.09070641547441483, 0.09103933721780777, 0.09103819727897644, 0.09070301055908203, 0.0907018780708313, 0.09103478491306305, 0.09103364497423172, 0.09081922471523285, 0.09103136509656906, 0.09103022515773773]], [[0.09002696722745895, 0.08949239552021027, 0.08949904888868332, 0.09076151996850967, 0.09005372226238251, 0.08881429582834244, 0.08952565491199493, 0.09007380157709122, 0.10282909125089645, 0.08946177363395691, 0.08946177363395691], [0.09048278629779816, 0.09021200239658356, 0.09021537750959396, 0.09085357189178467, 0.09049632400274277, 0.08986735343933105, 0.09022887051105499, 0.09050647914409637, 0.09674431383609772, 0.09019646048545837, 0.09019646048545837], [0.09047731012105942, 0.09020321816205978, 0.09020662307739258, 0.09085264801979065, 0.09049101173877716, 0.08985435962677002, 0.09022028744220734, 0.09050128608942032, 0.09681820124387741, 0.09018748253583908, 0.09018748253583908], [0.08934624493122101, 0.08845791965723038, 0.08846895396709442, 0.09057274460792542, 0.08939080685377121, 0.08733624219894409, 0.0885130763053894, 0.0894242450594902, 0.11167553812265396, 0.08840713649988174, 0.08840713649988174], [0.09000327438116074, 0.08945564180612564, 0.08946245908737183, 0.09075591713190079, 0.09003069251775742, 0.08876108378171921, 0.08948970586061478, 0.09005125612020493, 0.1031414270401001, 0.089424267411232, 0.089424267411232], [0.09101451188325882, 0.09108564257621765, 0.09108474850654602, 0.09091755747795105, 0.09101096540689468, 0.09117655456066132, 0.09108120203018188, 0.09100830554962158, 0.08944102376699448, 0.09108972549438477, 0.09108972549438477], [0.09045539051294327, 0.0901680514216423, 0.09017162770032883, 0.09084893763065338, 0.09046975523233414, 0.08980239927768707, 0.09018594771623611, 0.09048052877187729, 0.09711430966854095, 0.09015155583620071, 0.09015155583620071], [0.08998546004295349, 0.08942802995443344, 0.08943495899438858, 0.09075166285037994, 0.09001336246728897, 0.0887211337685585, 0.08946269750595093, 0.09003429859876633, 0.10337623953819275, 0.08939609676599503, 0.08939609676599503], [0.06848327815532684, 0.06372563540935516, 0.06378290802240372, 0.0755530595779419, 0.06872979551553726, 0.05812695249915123, 0.06401250511407852, 0.06891527026891708, 0.3417457044124603, 0.06346245110034943, 0.06346245110034943], [0.09050791710615158, 0.09025239944458008, 0.09025558084249496, 0.09085772186517715, 0.09052067995071411, 0.08992712199687958, 0.09026831388473511, 0.09053026884794235, 0.09640452265739441, 0.09023773670196533, 0.09023773670196533], [0.09050791710615158, 0.09025239944458008, 0.09025558084249496, 0.09085772186517715, 0.09052067995071411, 0.08992712199687958, 0.09026831388473511, 0.09053026884794235, 0.09640452265739441, 0.09023773670196533, 0.09023773670196533]], [[0.09211365133523941, 0.09212328493595123, 0.09034361690282822, 0.09035306423902512, 0.0921521931886673, 0.09114225953817368, 0.09038142114877701, 0.09039086848497391, 0.09117086231708527, 0.08940959721803665, 0.0904192328453064], [0.09211897104978561, 0.09212864935398102, 0.09034112095832825, 0.09035060554742813, 0.09215768426656723, 0.09114327281713486, 0.09037908911705017, 0.09038858115673065, 0.0911720022559166, 0.08940303325653076, 0.09041706472635269], [0.09112915396690369, 0.09113090485334396, 0.09080586582422256, 0.09080760926008224, 0.0911361426115036, 0.09095237404108047, 0.09081282466650009, 0.09081456810235977, 0.09095759689807892, 0.09063317626714706, 0.09081978350877762], [0.0911344587802887, 0.09113624691963196, 0.09080339223146439, 0.09080517292022705, 0.09114161133766174, 0.09095341712236404, 0.09081051498651505, 0.09081229567527771, 0.09095877408981323, 0.090626560151577, 0.0908176377415657], [0.09213492274284363, 0.09214473515748978, 0.09033361077308655, 0.09034322202205658, 0.09217415750026703, 0.09114629775285721, 0.09037207067012787, 0.0903816968202591, 0.09117539972066879, 0.0893833339214325, 0.09041055291891098], [0.09157510101795197, 0.09158041328191757, 0.09059657901525497, 0.09060181677341461, 0.091596320271492, 0.09103913605213165, 0.09061755985021591, 0.09062280505895615, 0.09105495363473892, 0.09007676690816879, 0.09063855558633804], [0.09115032851696014, 0.09115224331617355, 0.09079592674970627, 0.09079783409833908, 0.09115798771381378, 0.09095652401447296, 0.09080355614423752, 0.09080546349287033, 0.0909622460603714, 0.0906066820025444, 0.09081118553876877], [0.09115562587976456, 0.09115757793188095, 0.09079344570636749, 0.09079539030790329, 0.09116344898939133, 0.09095755219459534, 0.09080123901367188, 0.09080319106578827, 0.09096340835094452, 0.09060005098581314, 0.09080903977155685], [0.09159103035926819, 0.09159645438194275, 0.09058910608291626, 0.09059447050094604, 0.09161274880170822, 0.09104221314191818, 0.09061058610677719, 0.09061595797538757, 0.0910584107041359, 0.09005697071552277, 0.09063208103179932], [0.09060394018888474, 0.09060152620077133, 0.09105215966701508, 0.09104973822832108, 0.09059429913759232, 0.09084856510162354, 0.09104247391223907, 0.09104005247354507, 0.09084132313728333, 0.09129314869642258, 0.09103278815746307], [0.0911715105175972, 0.09117358922958374, 0.09078600257635117, 0.09078807383775711, 0.09117984026670456, 0.09096066653728485, 0.09079429507255554, 0.09079637378454208, 0.09096690267324448, 0.09058018773794174, 0.09080258756875992]], [[0.09207364916801453, 0.09103759378194809, 0.09104311466217041, 0.0920904129743576, 0.0920960009098053, 0.09164922684431076, 0.09106521308422089, 0.09270912408828735, 0.0822751522064209, 0.09219443053007126, 0.09176604449748993], [0.09040272980928421, 0.09082897752523422, 0.09082668274641037, 0.09039589017629623, 0.09039361029863358, 0.09057651460170746, 0.09081751853227615, 0.09014464169740677, 0.09473136812448502, 0.09035348892211914, 0.09052857011556625], [0.09041210263967514, 0.09083057940006256, 0.09082833677530289, 0.09040538966655731, 0.09040314704179764, 0.09058272838592529, 0.0908193439245224, 0.09015869349241257, 0.09466031193733215, 0.0903637483716011, 0.09053565561771393], [0.09209931641817093, 0.0910395085811615, 0.09104515612125397, 0.09211646765470505, 0.09212218225002289, 0.09166513383388519, 0.09106776118278503, 0.09274949133396149, 0.08208750933408737, 0.09222288429737091, 0.09178463369607925], [0.0921078622341156, 0.09104013442993164, 0.09104582667350769, 0.09212514013051987, 0.09213089942932129, 0.09167042374610901, 0.09106859564781189, 0.09276293963193893, 0.08202504366636276, 0.0922323614358902, 0.0917908102273941], [0.09140963852405548, 0.09097415208816528, 0.09097647666931152, 0.09141665697097778, 0.09141900390386581, 0.0912315845489502, 0.09098579734563828, 0.09167534857988358, 0.08717058598995209, 0.091460220515728, 0.09128063917160034], [0.09044951945543289, 0.09083696454763412, 0.09083487838506699, 0.09044329822063446, 0.09044122695922852, 0.09060750156641006, 0.09082654863595963, 0.09021484106779099, 0.09437654167413712, 0.09040474146604538, 0.09056392312049866], [0.09301780164241791, 0.09107993543148041, 0.09109021723270416, 0.0930493101477623, 0.09305980801582336, 0.09222167730331421, 0.09113135188817978, 0.09421572834253311, 0.07544882595539093, 0.09324494004249573, 0.09244047850370407], [0.06744726747274399, 0.078203946352005, 0.07814192771911621, 0.06728693097829819, 0.06723356992006302, 0.07164773344993591, 0.07789435237646103, 0.06164594739675522, 0.293733149766922, 0.06630096584558487, 0.07046424597501755], [0.09225763380527496, 0.09105037152767181, 0.09105680137872696, 0.0922771766781807, 0.092283695936203, 0.09176280349493027, 0.09108252823352814, 0.09299921244382858, 0.08093228936195374, 0.0923985168337822, 0.09189896285533905], [0.09159515053033829, 0.09099454432725906, 0.09099775552749634, 0.09160484373569489, 0.09160806983709335, 0.09134945273399353, 0.09101059287786484, 0.09196213632822037, 0.0857953280210495, 0.09166497737169266, 0.09141712635755539]]]}, "num_training_step_calls_per_iteration": 1, "evaluation": {"env_runners": {"module_to_env_connector": {"timers": {"connectors": {"tensor_to_numpy": 1.616100337800058e-05, "un_batch_to_individual_items": 6.959727764838691e-06, "get_actions": 3.933452591236584e-05, "listify_data_for_vector_env": 1.0889132412526954e-05, "normalize_and_clip_actions": 8.586909256258297e-06, "remove_single_ts_time_rank_from_batch": 1.2445763356804556e-05}}, "connector_pipeline_timer": 0.00012252315755770262}, "episode_len_min": 20, "num_env_steps_sampled": 400, "weights_seq_no": 6.0, "episode_len_mean": 20.0, "env_to_module_sum_episodes_length_out": 10.368238394470474, "episode_len_max": 20, "env_to_module_connector": {"timers": {"connectors": {"batch_individual_items": 1.3556277546390906e-05, "add_observations_from_episodes_to_batch": 3.1009023525660665e-06, "add_states_from_episodes_to_batch": 2.8651527013374486e-06, "add_time_dim_to_batch_and_zero_pad": 7.348772931453084e-06, "numpy_to_tensor": 1.283776531185185e-05}}, "connector_pipeline_timer": 6.298464693939243e-05}, "env_to_module_sum_episodes_length_in": 10.368238394470474, "num_episodes_lifetime": 120, "episode_duration_sec_mean": 0.006395570425083861, "episode_return_max": 12.5, "rlmodule_inference_timer": 3.3250506374158216e-05, "num_agent_steps_sampled": {"default_agent": 400}, "num_module_steps_sampled_lifetime": {"default_policy": 2400}, "num_agent_steps_sampled_lifetime": {"default_agent": 2400}, "num_module_steps_sampled": {"default_policy": 400}, "sample": 0.13243650029587775, "episode_return_mean": 0.0, "env_step_timer": 1.5897525637385835e-05, "agent_episode_returns_mean": {"default_agent": 0.0}, "num_episodes": 20, "module_episode_returns_mean": {"default_policy": 0.0}, "episode_return_min": -12.5, "num_env_steps_sampled_lifetime": 30400, "env_reset_timer": 0.0005800696426194925, "time_between_sampling": 12.528962140748561}, "num_healthy_workers": 1, "actor_manager_num_outstanding_async_reqs": 0, "num_remote_worker_restarts": 0}, "num_env_steps_sampled_lifetime": -2460000.0, "fault_tolerance": {"num_healthy_workers": 0, "num_remote_worker_restarts": 0}, "env_runner_group": {"actor_manager_num_outstanding_async_reqs": 0}, "done": false, "training_iteration": 6, "trial_id": "ae8a2_00000", "date": "2025-08-11_18-23-41", "timestamp": 1754929421, "time_this_iter_s": 11.98733901977539, "time_total_s": 74.8977324962616, "pid": 10870, "hostname": "Mac", "node_ip": "127.0.0.1", "config": {"exploration_config": {}, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 2, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "env": "Umbrella", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": false, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 0, "create_local_env_runner": true, "num_envs_per_env_runner": 1, "gym_env_vectorize_mode": "SYNC", "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "episodes_to_numpy": true, "max_requests_in_flight_per_env_runner": 1, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "merge_env_runner_states": "training_only", "broadcast_env_runner_states": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "complete_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "sampler_perf_stats_ema_coef": null, "_is_online": true, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": "auto", "num_aggregator_actors_per_learner": 0, "max_requests_in_flight_per_aggregator_actor": 3, "local_gpu_idx": 0, "max_requests_in_flight_per_learner": 3, "gamma": 1, "lr": 0.0002715581955, "grad_clip": 0.5, "grad_clip_by": "global_norm", "_train_batch_size_per_learner": 5000, "train_batch_size": 4000, "num_epochs": 1, "minibatch_size": 1000, "shuffle_batch_per_epoch": true, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "log_std_clip_param": 20.0, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "_disable_preprocessor_api": false, "_disable_action_flattening": false}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {"intrinsic_reward_coeff": 0.2795015916508}, "optimizer": {}, "_learner_class": "<class 'source.intrinsic_attention_ppo.learners.IntrinsicAttentionMetaLearner.IntrinsicAttentionMetaLearner'>", "callbacks_on_algorithm_init": null, "callbacks_on_env_runners_recreated": null, "callbacks_on_offline_eval_runners_recreated": null, "callbacks_on_checkpoint_loaded": null, "callbacks_on_environment_created": null, "callbacks_on_episode_created": null, "callbacks_on_episode_start": null, "callbacks_on_episode_step": null, "callbacks_on_episode_end": null, "callbacks_on_evaluate_start": null, "callbacks_on_evaluate_end": null, "callbacks_on_evaluate_offline_start": null, "callbacks_on_evaluate_offline_end": null, "callbacks_on_sample_end": null, "callbacks_on_train_result": null, "explore": true, "enable_rl_module_and_learner": true, "enable_env_runner_and_connector_v2": true, "_prior_exploration_config": {"type": "StochasticSampling"}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x38844d8a0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "offline_data_class": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_read_batch_size": null, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "materialize_data": false, "materialize_mapped_data": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "ignore_final_observation": false, "prelearner_class": null, "prelearner_buffer_class": null, "prelearner_buffer_kwargs": {}, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_remaining_data": false, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": 1, "evaluation_duration": 20, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_auto_duration_min_env_steps_per_sample": 100, "evaluation_auto_duration_max_env_steps_per_sample": 2000, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 1, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "offline_evaluation_interval": null, "num_offline_eval_runners": 0, "offline_loss_for_module_fn": null, "offline_evaluation_duration": 1, "offline_evaluation_parallel_to_training": false, "offline_evaluation_timeout_s": 120.0, "num_cpus_per_offline_eval_runner": 1, "num_gpus_per_offline_eval_runner": 0, "custom_resources_per_offline_eval_runner": {}, "restart_failed_offline_eval_runners": true, "ignore_offline_eval_runner_failures": false, "max_num_offline_eval_runner_restarts": 1000, "offline_eval_runner_restore_timeout_s": 1800.0, "max_requests_in_flight_per_offline_eval_runner": 1, "validate_offline_eval_runners_after_construction": true, "offline_eval_runner_health_probe_timeout_s": 30.0, "offline_eval_rl_module_inference_only": false, "broadcast_offline_eval_runner_states": false, "offline_eval_batch_size_per_runner": 256, "dataset_num_iters_per_eval_runner": 1, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "log_gradients": false, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 1, "restart_failed_env_runners": true, "ignore_env_runner_failures": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30.0, "env_runner_restore_timeout_s": 1800.0, "_model_config": {}, "_rl_module_spec": "MultiRLModuleSpec(multi_rl_module_class=<class 'ray.rllib.core.rl_module.multi_rl_module.MultiRLModule'>, observation_space=None, action_space=None, inference_only=False, model_config=None, rl_module_specs={'default_policy': RLModuleSpec(module_class=<class 'source.intrinsic_attention_ppo.rl_modules.DifferentiablePPOModule.DifferentiablePPOModule'>, observation_space=None, action_space=None, inference_only=False, learner_only=False, model_config={'vf_share_layers': True, 'embedding_dim': 62, 'max_seq_len': 11, 'policy_head_hidden_sizes': [32], 'value_head_hidden_sizes': [101], 'embedding_hidden_sizes': [121]}, catalog_class=None, load_state_path=None, model_config_dict=None), 'intrinsic_reward_module': RLModuleSpec(module_class=<class 'source.intrinsic_attention_ppo.rl_modules.IntrinsicAttentionModule.IntrinsicAttentionModule'>, observation_space=None, action_space=None, inference_only=False, learner_only=True, model_config={'intrinsic_reward_network': {'encoder_hidden_sizes': [], 'encoding_dim': 1, 'num_heads': 1, 'head_hidden_sizes': None, 'layers': [{'type': 'attention'}]}, 'extrinsic_value_hidden_layers': [127, 60], 'vf_share_layers': True, 'max_seq_len': 11}, catalog_class=None, load_state_path=None, model_config_dict=None)}, load_state_path=None, modules_to_load=None, module_specs={'default_policy': RLModuleSpec(module_class=<class 'source.intrinsic_attention_ppo.rl_modules.DifferentiablePPOModule.DifferentiablePPOModule'>, observation_space=None, action_space=None, inference_only=False, learner_only=False, model_config={'vf_share_layers': True, 'embedding_dim': 62, 'max_seq_len': 11, 'policy_head_hidden_sizes': [32], 'value_head_hidden_sizes': [101], 'embedding_hidden_sizes': [121]}, catalog_class=None, load_state_path=None, model_config_dict=None), 'intrinsic_reward_module': RLModuleSpec(module_class=<class 'source.intrinsic_attention_ppo.rl_modules.IntrinsicAttentionModule.IntrinsicAttentionModule'>, observation_space=None, action_space=None, inference_only=False, learner_only=True, model_config={'intrinsic_reward_network': {'encoder_hidden_sizes': [], 'encoding_dim': 1, 'num_heads': 1, 'head_hidden_sizes': None, 'layers': [{'type': 'attention'}]}, 'extrinsic_value_hidden_layers': [127, 60], 'vf_share_layers': True, 'max_seq_len': 11}, catalog_class=None, load_state_path=None, model_config_dict=None)})", "algorithm_config_overrides_per_module": {"intrinsic_reward_module": {"lr": 0.0002715581955}}, "_per_module_overrides": {}, "_validate_config": true, "_use_msgpack_checkpoints": false, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "env_task_fn": -1, "enable_connectors": -1, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.161583927863, "kl_target": 0.0201019014258, "vf_loss_coeff": 0.7790510010087, "entropy_coeff": 0.0015431216992, "clip_param": 0.2459212356676, "vf_clip_param": 0.3769744131561, "entropy_coeff_schedule": null, "lr_schedule": null, "sgd_minibatch_size": -1, "vf_share_layers": -1, "differentiable_learner_configs": ["DifferentiableLearnerConfig(learner_class=<class 'source.intrinsic_attention_ppo.learners.IntrinsicAttentionPPOLearner.IntrinsicAttentionPPOLearner'>, learner_connector=None, add_default_connectors_to_learner_pipeline=True, is_multi_agent=False, policies_to_update=['default_policy'], lr=0.0060984166342, num_total_minibatches=0, num_epochs=1, minibatch_size=1000, shuffle_batch_per_epoch=True)"], "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9485408017724, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.callbacks.callbacks.RLlibCallback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 74.8977324962616, "iterations_since_restore": 6, "perf": {"cpu_util_percent": 59.588235294117645, "ram_util_percent": 81.56470588235294}}
{"timers": {"training_iteration": 12.604028128808565, "restore_env_runners": 1.2506498811848563e-05, "training_step": 12.603830384098313, "env_runner_sampling_timer": 2.890438081578422, "learner_update_timer": 9.495037443873093, "synch_weights": 0.0016648454315471718, "restore_eval_env_runners": 5.4142065718723436e-05, "evaluation_iteration": 0.14447575599765652, "synch_eval_env_connectors": 0.00023025292782206914, "synch_env_connectors": 6.106646143871477e-06}, "env_runners": {"module_to_env_connector": {"connector_pipeline_timer": 0.00012770585076030873, "timers": {"connectors": {"remove_single_ts_time_rank_from_batch": 1.2540165801322338e-05, "un_batch_to_individual_items": 6.963985496222613e-06, "get_actions": 4.340650445481152e-05, "tensor_to_numpy": 1.632416625807791e-05, "listify_data_for_vector_env": 1.1304598872028035e-05, "normalize_and_clip_actions": 8.672816263306454e-06}}}, "rlmodule_inference_timer": 3.476243722952869e-05, "sample": 0.006089231311232995, "weights_seq_no": 6.0, "num_agent_steps_sampled": {"default_agent": 5000.0}, "episode_len_mean": 20.0, "episode_len_max": 20, "env_to_module_connector": {"timers": {"connectors": {"batch_individual_items": 1.3473181209608511e-05, "add_states_from_episodes_to_batch": 2.8839583789077888e-06, "numpy_to_tensor": 1.3802352397663892e-05, "add_observations_from_episodes_to_batch": 3.027193955405334e-06, "add_time_dim_to_batch_and_zero_pad": 7.461951910154948e-06}}, "connector_pipeline_timer": 6.410689741295089e-05}, "env_to_module_sum_episodes_length_out": 10.36823839457432, "num_agent_steps_sampled_lifetime": {"default_agent": -3077500.0}, "episode_return_mean": 0.9399999999999996, "num_module_steps_sampled_lifetime": {"default_policy": -3077500.0}, "num_episodes": 250.0, "time_between_sampling": 0.042554217480831054, "num_env_steps_sampled_lifetime": -3077500.0, "episode_return_min": -10.5, "env_reset_timer": 4.9643689645707876e-05, "env_to_module_sum_episodes_length_in": 10.36823839457432, "num_episodes_lifetime": -153875.0, "agent_episode_returns_mean": {"default_agent": 0.9399999999999996}, "episode_len_min": 20, "episode_duration_sec_mean": 0.005734168169554323, "env_step_timer": 1.558260240263462e-05, "episode_return_max": 9.5, "num_module_steps_sampled": {"default_policy": 5000.0}, "module_episode_returns_mean": {"default_policy": 0.9399999999999996}, "num_env_steps_sampled": 5000.0, "num_env_steps_sampled_lifetime_throughput": 3014.5353021101596}, "__all_modules__": {"learner_connector_sum_episodes_length_in": 5000.0, "learner_connector": {"connector_pipeline_timer": 0.16199029251290747, "timers": {"connectors": {"add_one_ts_to_episodes_and_truncate": 0.009368272795021636, "add_observations_from_episodes_to_batch": 0.0016486503092632628, "add_columns_from_episodes_to_train_batch": 0.0497703370076052, "add_time_dim_to_batch_and_zero_pad": 0.08542508829427142, "add_states_from_episodes_to_batch": 0.008980267752529457, "batch_individual_items": 0.006448363405458478, "numpy_to_tensor": 9.67760916657586e-05}}}, "learner_connector_sum_episodes_length_out": 5250.0}, "learners": {"default_policy": {"curr_entropy_coeff": 0.0015431216992, "curr_kl_coeff": 0.0012623744551092386, "num_module_steps_trained_lifetime": 41895, "entropy": 0.6865170001983643, "num_module_steps_trained": 5985, "diff_num_grad_updates_vs_sampler_policy": 1.0, "vf_loss": 0.35832148790359497, "vf_loss_unclipped": 43.3602409362793, "policy_loss": -0.0010190921602770686, "use_intrinsic_rewards": 0.0, "total_loss": 0.27707239985466003, "vf_explained_var": 0.001739501953125, "mean_kl_loss": 5.7730245316633955e-05, "weights_seq_no": 7.0, "num_trainable_parameters": 16595, "module_train_batch_size_mean": 997.82696443245, "num_module_steps_trained_lifetime_throughput": 745.4225390306558}, "intrinsic_reward_module": {"num_module_steps_trained_lifetime": 41895, "num_module_steps_trained": 5985, "diff_num_grad_updates_vs_sampler_policy": 1.0, "total_loss": 0.0, "gradients_default_optimizer_global_norm": 0.0, "module_train_batch_size_mean": 997.82696443245, "default_optimizer_learning_rate": 0.0002715581955, "weights_seq_no": 7.0, "num_trainable_parameters": 8266, "curr_entropy_coeff": 0.0015431216992, "num_module_steps_trained_lifetime_throughput": 745.4343197476715}, "differentiable_learners": {"intrinsic_attention_ppo_learner": {"default_policy": {"weights_seq_no": 42.0, "num_module_steps_trained": 35910, "num_module_steps_trained_lifetime": 251370, "entropy": 0.6865707635879517, "diff_num_grad_updates_vs_sampler_policy": 36.0, "vf_loss": 0.35849931836128235, "vf_loss_unclipped": 43.5123405456543, "total_loss": 0.2772641181945801, "mean_kl_loss": 5.2776915254071355e-05, "policy_loss": -0.0009741868707351387, "use_intrinsic_rewards": 1.0, "module_train_batch_size_mean": 997.5374097747205, "vf_explained_var": -0.0015999078750610352}, "__all_modules__": {"num_env_steps_trained": 198000, "num_module_steps_trained": 71820, "num_module_steps_trained_lifetime": 502740, "num_env_steps_trained_lifetime": 1386000, "num_env_steps_trained_lifetime_throughput": 36305.48742497499}, "intrinsic_reward_module": {"weights_seq_no": 42.0, "num_module_steps_trained_lifetime": 251370, "num_module_steps_trained": 35910, "diff_num_grad_updates_vs_sampler_policy": 36.0, "total_loss": 0.0, "module_train_batch_size_mean": 997.5374097747205}}}, "__all_modules__": {"num_env_steps_trained_lifetime": 231000, "num_non_trainable_parameters": 0, "num_trainable_parameters": 24861, "num_env_steps_trained": 33000, "num_module_steps_trained": 11970, "num_module_steps_trained_lifetime": 83790, "num_env_steps_trained_lifetime_throughput": 4111.751761692984, "num_module_steps_trained_throughput": 25438554.601684865, "num_module_steps_trained_lifetime_throughput": 12823422.910123335}, "IntrinsicAttentionMask": [[[0.09239068627357483, 0.09137813746929169, 0.09061532467603683, 0.08962223678827286, 0.09140680730342865, 0.09243901073932648, 0.08965036273002625, 0.08965974301099777, 0.0924680158495903, 0.08967849612236023, 0.09069117158651352], [0.09170210361480713, 0.09116196632385254, 0.0907532125711441, 0.0902186706662178, 0.09117729961872101, 0.09172780811786652, 0.09023384749889374, 0.09023890644311905, 0.09174323827028275, 0.09024902433156967, 0.09079392999410629], [0.09117971360683441, 0.09099585562944412, 0.09085624665021896, 0.0906730368733406, 0.09100108593702316, 0.0911884531378746, 0.09067824482917786, 0.09067998826503754, 0.09119369089603424, 0.0906834602355957, 0.09087016433477402], [0.09049493074417114, 0.09077534824609756, 0.09098924696445465, 0.09127119183540344, 0.09076735377311707, 0.09048164635896683, 0.09126315265893936, 0.09126047790050507, 0.09047367423772812, 0.09125511348247528, 0.09096787124872208], [0.09172167629003525, 0.09116815775632858, 0.0907493308186531, 0.09020168334245682, 0.0911838710308075, 0.09174802899360657, 0.090217225253582, 0.09022241085767746, 0.09176383912563324, 0.09023277461528778, 0.09079104661941528], [0.09242340177297592, 0.09138832986354828, 0.09060870856046677, 0.08959395438432693, 0.09141763299703598, 0.09247280657291412, 0.08962269127368927, 0.08963227272033691, 0.09250246733427048, 0.0896514281630516, 0.09068621695041656], [0.0905143991112709, 0.09078165143728256, 0.0909854918718338, 0.09125414490699768, 0.0907740369439125, 0.09050173312425613, 0.09124648571014404, 0.0912439301609993, 0.09049413353204727, 0.0912388265132904, 0.09096512943506241], [0.09052089601755142, 0.09078376740217209, 0.09098424762487411, 0.09124847501516342, 0.09077627211809158, 0.09050843864679337, 0.09124094247817993, 0.09123843163251877, 0.09050096571445465, 0.09123340994119644, 0.09096422791481018], [0.09244304895401001, 0.09139444679021835, 0.0906047374010086, 0.08957698941230774, 0.0914241373538971, 0.09249310195446014, 0.08960609138011932, 0.08961579203605652, 0.09252315014600754, 0.0896352007985115, 0.09068325161933899], [0.09053386747837067, 0.09078796952962875, 0.09098174422979355, 0.09123710542917252, 0.09078072756528854, 0.09052182734012604, 0.09122982621192932, 0.09122739732265472, 0.09051460027694702, 0.09122254699468613, 0.09096238762140274], [0.0912318080663681, 0.09101250767707825, 0.09084603935480118, 0.09062766283750534, 0.09101874381303787, 0.0912422239780426, 0.09063387662172318, 0.09063594788312912, 0.09124847501516342, 0.09064009040594101, 0.09086263924837112]], [[0.08988890051841736, 0.08865173906087875, 0.08936179429292679, 0.09062232822179794, 0.08991561830043793, 0.08938171714544296, 0.08868468552827835, 0.09064926207065582, 0.10348602384328842, 0.09003333002328873, 0.08932457119226456], [0.09105438739061356, 0.09125139564275742, 0.09113793820142746, 0.09093906730413437, 0.0910501629114151, 0.09113476425409317, 0.0912461057305336, 0.09093485027551651, 0.08907591551542282, 0.09103158861398697, 0.09114386141300201], [0.09040886908769608, 0.0897727981209755, 0.09013839066028595, 0.09078392386436462, 0.09042255580425262, 0.09014862775802612, 0.08978978544473648, 0.09079767018556595, 0.0971352756023407, 0.09048284590244293, 0.09011925756931305], [0.08910572528839111, 0.08705771714448929, 0.08823079615831375, 0.09032892435789108, 0.08915017545223236, 0.08826380223035812, 0.08711200207471848, 0.09037397801876068, 0.11286155879497528, 0.08934606611728668, 0.0881691500544548], [0.08986160904169083, 0.08859437704086304, 0.08932163566350937, 0.09061305969953537, 0.08988897502422333, 0.08934204280376434, 0.08862811326980591, 0.09064066410064697, 0.10381648689508438, 0.09000957012176514, 0.08928351104259491], [0.09038985520601273, 0.08973079174757004, 0.09010957926511765, 0.09077855199575424, 0.09040404111146927, 0.09012018889188766, 0.08974839746952057, 0.09079279750585556, 0.09736952185630798, 0.09046651422977448, 0.09008976072072983], [0.09102579951286316, 0.09118358045816422, 0.09109272062778473, 0.0909334123134613, 0.09102241694927216, 0.09109018743038177, 0.09117934852838516, 0.0909300297498703, 0.08943749219179153, 0.0910075381398201, 0.09109746664762497], [0.08907563239336014, 0.08699842542409897, 0.08818814158439636, 0.09031660854816437, 0.08912071585655212, 0.08822161704301834, 0.08705347031354904, 0.0903623178601265, 0.11321809887886047, 0.08931943774223328, 0.08812560886144638], [0.06356123089790344, 0.05326688662171364, 0.0589696429669857, 0.07049953192472458, 0.06380253285169601, 0.059137459844350815, 0.053519781678915024, 0.07076717913150787, 0.38294291496276855, 0.06487561017274857, 0.05865725502371788], [0.08974022418260574, 0.08834102004766464, 0.08914376050233841, 0.09057094901800156, 0.08977047353982925, 0.08916629105806351, 0.08837824314832687, 0.09060146659612656, 0.10528214275836945, 0.08990374207496643, 0.08910165727138519], [0.09044425189495087, 0.08985119313001633, 0.09019210189580917, 0.09079381823539734, 0.0904570147395134, 0.09020164608955383, 0.08986704051494598, 0.09080663323402405, 0.0966988131403923, 0.0905132070183754, 0.09017426520586014]], [[0.09097035229206085, 0.09112527221441269, 0.0907200425863266, 0.09019006788730621, 0.09168113768100739, 0.09168623387813568, 0.09074022620916367, 0.09021013230085373, 0.09116075187921524, 0.09075535833835602, 0.09076040238142014], [0.0909854993224144, 0.091179758310318, 0.09067181497812271, 0.09000837802886963, 0.09187744557857513, 0.09188384562730789, 0.09069709479808807, 0.09003347903490067, 0.09122426062822342, 0.09071605652570724, 0.09072238206863403], [0.09094550460577011, 0.09103679656982422, 0.09079786390066147, 0.09048471599817276, 0.0913638323545456, 0.09136682748794556, 0.09080976992845535, 0.09049658477306366, 0.091057687997818, 0.09081870317459106, 0.09082168340682983], [0.09089132398366928, 0.09084757417440414, 0.09096220880746841, 0.09111311286687851, 0.09069140255451202, 0.09068997204303741, 0.09095648676156998, 0.09110737591981888, 0.09083757549524307, 0.09095218777656555, 0.09095075726509094], [0.09103836119174957, 0.09137345105409622, 0.09049837291240692, 0.08936075866222382, 0.0925811380147934, 0.092592254281044, 0.09054184705018997, 0.0894036814570427, 0.0914502739906311, 0.0905744656920433, 0.09058533608913422], [0.09103883802890778, 0.09137521684169769, 0.09049678593873978, 0.08935485035181046, 0.09258759021759033, 0.09259875118732452, 0.09054042398929596, 0.08939793705940247, 0.09145233780145645, 0.09057316184043884, 0.09058407694101334], [0.09094752371311188, 0.09104395657777786, 0.09079159796237946, 0.09046091884374619, 0.09138942509889603, 0.09139259159564972, 0.09080417454242706, 0.09047345072031021, 0.09106603264808655, 0.09081361442804337, 0.09081675857305527], [0.09089341014623642, 0.09085478633642197, 0.09095599502325058, 0.09108921140432358, 0.0907168760895729, 0.09071560949087143, 0.09095094352960587, 0.09108415246009827, 0.09084595739841461, 0.09094715118408203, 0.09094588458538055], [0.09098893404006958, 0.09119220077991486, 0.09066075831651688, 0.08996684104204178, 0.09192238003015518, 0.09192907810211182, 0.09068720787763596, 0.08999308198690414, 0.09123875945806503, 0.09070704877376556, 0.09071365743875504], [0.09094903618097305, 0.09104932099580765, 0.0907868966460228, 0.09044306725263596, 0.0914086177945137, 0.09141191095113754, 0.0907999724149704, 0.09045609831809998, 0.09107227623462677, 0.09080978482961655, 0.0908130556344986], [0.09094955027103424, 0.09105110913515091, 0.09078533202409744, 0.09043712168931961, 0.09141501784324646, 0.09141835570335388, 0.09079857170581818, 0.09045031666755676, 0.09107435494661331, 0.09080851078033447, 0.0908118188381195]], [[0.0901540145277977, 0.0889132097363472, 0.08962535858154297, 0.0901741087436676, 0.0908963680267334, 0.08893963694572449, 0.08894624561071396, 0.09020092338323593, 0.10297418385744095, 0.08958802372217178, 0.08958802372217178], [0.09101372212171555, 0.09121064841747284, 0.09109724313020706, 0.09101056307554245, 0.09089740365743637, 0.09120641648769379, 0.09120536595582962, 0.091006338596344, 0.0891459509730339, 0.09110315889120102, 0.09110315889120102], [0.09054294973611832, 0.08990593999624252, 0.09027206897735596, 0.09055323153734207, 0.09092200547456741, 0.0899195522069931, 0.0899229496717453, 0.09056694060564041, 0.09688844531774521, 0.09025291353464127, 0.09025291353464127], [0.09013854712247849, 0.08887504041194916, 0.08960017561912537, 0.09015901386737823, 0.09089461714029312, 0.08890195935964584, 0.08890867978334427, 0.09018631279468536, 0.10321133583784103, 0.08956216275691986, 0.08956216275691986], [0.08954918384552002, 0.0874834656715393, 0.08866666257381439, 0.08958280086517334, 0.0907943919301033, 0.08752726018428802, 0.0875382199883461, 0.08962764590978622, 0.11202142387628555, 0.08860448002815247, 0.08860448002815247], [0.09099732339382172, 0.09116288274526596, 0.09106754511594772, 0.09099466353654861, 0.09089948982000351, 0.09115932881832123, 0.0911584347486496, 0.09099110960960388, 0.08942414075136185, 0.09107252210378647, 0.09107252210378647], [0.09099321067333221, 0.09115093946456909, 0.09106011688709259, 0.09099067747592926, 0.09090001881122589, 0.09114755690097809, 0.09114670753479004, 0.09098729491233826, 0.08949381858110428, 0.09106485545635223, 0.09106485545635223], [0.09011784195899963, 0.08882411569356918, 0.08956653624773026, 0.09013880044221878, 0.09089221805334091, 0.08885166049003601, 0.08885855227708817, 0.09016676247119904, 0.10352829843759537, 0.08952761441469193, 0.08952761441469193], [0.06928948312997818, 0.05860031768679619, 0.0645337924361229, 0.06947646290063858, 0.07651118189096451, 0.05881126597523689, 0.05886411666870117, 0.06972655653953552, 0.34576764702796936, 0.06420957297086716, 0.06420957297086716], [0.0905691385269165, 0.0899752601981163, 0.09031663835048676, 0.09057872742414474, 0.09092239290475845, 0.08998795598745346, 0.08999112993478775, 0.09059150516986847, 0.09646973013877869, 0.09029877930879593, 0.09029877930879593], [0.0905691385269165, 0.0899752601981163, 0.09031663835048676, 0.09057872742414474, 0.09092239290475845, 0.08998795598745346, 0.08999112993478775, 0.09059150516986847, 0.09646973013877869, 0.09029877930879593, 0.09029877930879593]], [[0.0921117290854454, 0.09212136268615723, 0.0903417319059372, 0.08935164660215378, 0.0911308228969574, 0.09215990453958511, 0.08937968313694, 0.09038899093866348, 0.09218882769346237, 0.09040790051221848, 0.09041735529899597], [0.09211703389883041, 0.09212670475244522, 0.09033922106027603, 0.089344821870327, 0.0911317765712738, 0.09216542541980743, 0.08937298506498337, 0.09038668125867844, 0.09219447523355484, 0.09040567278862, 0.09041516482830048], [0.09112909436225891, 0.09113083779811859, 0.09080580621957779, 0.09062269330024719, 0.09095056354999542, 0.0911378264427185, 0.09062790870666504, 0.0908145010471344, 0.09114306420087814, 0.09081798046827316, 0.09081971645355225], [0.09057211875915527, 0.09056946635246277, 0.09106685221195221, 0.0913490429520607, 0.0908447727560997, 0.09055882692337036, 0.09134099632501602, 0.09105348587036133, 0.09055084735155106, 0.09104813635349274, 0.09104546904563904], [0.09156922250986099, 0.09157449007034302, 0.09059849381446838, 0.09005175530910492, 0.09103231132030487, 0.09159553050994873, 0.09006727486848831, 0.09062452614307404, 0.09161131829023361, 0.09063494205474854, 0.09064014256000519], [0.09213825315237045, 0.09214810281991959, 0.09032915532588959, 0.08931753784418106, 0.09113558381795883, 0.09218750894069672, 0.08934617787599564, 0.09037744253873825, 0.09221707284450531, 0.09039676934480667, 0.09040643274784088], [0.09058796614408493, 0.09058542549610138, 0.09105944633483887, 0.09132831543684006, 0.09084781259298325, 0.09057529270648956, 0.09132064878940582, 0.09104670584201813, 0.0905676856637001, 0.09104160964488983, 0.09103906154632568], [0.09115554392337799, 0.09115750342607498, 0.09079337120056152, 0.09058830887079239, 0.09095552563667297, 0.09116532653570175, 0.09059414267539978, 0.0908031091094017, 0.09117119759321213, 0.09080701321363449, 0.09080895781517029], [0.09215415269136429, 0.09216413646936417, 0.09032159298658371, 0.08929706364870071, 0.09113842993974686, 0.09220404922962189, 0.08932606875896454, 0.09037050604820251, 0.09223400801420212, 0.09039007872343063, 0.0903998613357544], [0.09116613119840622, 0.09116817265748978, 0.09078840166330338, 0.09057456254959106, 0.09095750749111176, 0.091176338493824, 0.09058064222335815, 0.09079855680465698, 0.09118245542049408, 0.0908026248216629, 0.09080465137958527], [0.09117142111063004, 0.09117349982261658, 0.090785913169384, 0.0905676782131195, 0.09095849841833115, 0.09118182957172394, 0.09057389199733734, 0.09079627692699432, 0.09118808060884476, 0.09080042690038681, 0.09080249816179276]], [[0.09021765738725662, 0.08897598087787628, 0.08898258954286575, 0.09023777395486832, 0.0909605324268341, 0.08900243043899536, 0.08900903910398483, 0.09026459604501724, 0.10304686427116394, 0.08965127915143967, 0.08965127915143967], [0.09100349247455597, 0.09120039641857147, 0.09119933843612671, 0.09100033342838287, 0.09088718891143799, 0.09119616448879242, 0.09119511395692825, 0.09099611639976501, 0.08913593739271164, 0.09109292179346085, 0.09109292179346085], [0.09099981933832169, 0.09118887782096863, 0.09118786454200745, 0.09099677950143814, 0.0908881351351738, 0.0911848172545433, 0.09118380397558212, 0.09099272638559341, 0.08920580893754959, 0.09108568727970123, 0.09108568727970123], [0.09020334482192993, 0.08893894404172897, 0.08894567936658859, 0.09022382646799088, 0.09095996618270874, 0.08896587789058685, 0.08897260576486588, 0.0902511477470398, 0.1032855212688446, 0.08962655067443848, 0.08962655067443848], [0.08965428173542023, 0.08758614212274551, 0.08759710937738419, 0.08968794345855713, 0.0909009575843811, 0.08762999624013901, 0.08764095604419708, 0.08973284065723419, 0.11215287446975708, 0.08870847523212433, 0.08870847523212433], [0.09098873287439346, 0.09115427732467651, 0.09115338325500488, 0.09098607301712036, 0.09089092165231705, 0.09115072339773178, 0.09114982932806015, 0.09098251909017563, 0.08941570669412613, 0.09106392413377762, 0.09106392413377762], [0.0909850224852562, 0.09114273637533188, 0.09114188700914383, 0.09098249673843384, 0.09089183807373047, 0.09113935381174088, 0.09113850444555283, 0.09097911417484283, 0.0894857719540596, 0.09105665981769562, 0.09105665981769562], [0.09018417447805405, 0.08888950198888779, 0.08889639377593994, 0.09020516276359558, 0.09095913171768188, 0.0889170691370964, 0.08892396092414856, 0.09023313224315643, 0.10360449552536011, 0.08959352225065231, 0.08959352225065231], [0.06969942152500153, 0.05894703418016434, 0.059000007808208466, 0.06988751143217087, 0.07696384191513062, 0.05915922299027443, 0.059212394058704376, 0.070139080286026, 0.3478124737739563, 0.06458946317434311, 0.06458946317434311], [0.09059977531433105, 0.09000569581985474, 0.09000886976718903, 0.0906093642115593, 0.09095314890146255, 0.0900183916091919, 0.09002156555652618, 0.09062214940786362, 0.09650235623121262, 0.09032931923866272, 0.09032931923866272], [0.09059977531433105, 0.09000569581985474, 0.09000886976718903, 0.0906093642115593, 0.09095314890146255, 0.0900183916091919, 0.09002156555652618, 0.09062214940786362, 0.09650235623121262, 0.09032931923866272, 0.09032931923866272]]]}, "num_training_step_calls_per_iteration": 1, "evaluation": {"env_runners": {"module_to_env_connector": {"timers": {"connectors": {"tensor_to_numpy": 1.4821903479864152e-05, "un_batch_to_individual_items": 6.492259993051303e-06, "get_actions": 3.5044313427855296e-05, "listify_data_for_vector_env": 1.0233746107735946e-05, "normalize_and_clip_actions": 7.918605557326779e-06, "remove_single_ts_time_rank_from_batch": 1.1790659887828434e-05}}, "connector_pipeline_timer": 0.00011239555697266754}, "episode_len_min": 20, "num_env_steps_sampled": 400, "weights_seq_no": 7.0, "episode_len_mean": 20.0, "env_to_module_sum_episodes_length_out": 10.368238394572801, "episode_len_max": 20, "env_to_module_connector": {"timers": {"connectors": {"batch_individual_items": 1.2109831312419497e-05, "add_observations_from_episodes_to_batch": 2.8035445575464884e-06, "add_states_from_episodes_to_batch": 2.734413893590346e-06, "add_time_dim_to_batch_and_zero_pad": 6.799719407294334e-06, "numpy_to_tensor": 1.171463291089086e-05}}, "connector_pipeline_timer": 5.779664918266472e-05}, "env_to_module_sum_episodes_length_in": 10.368238394572801, "num_episodes_lifetime": 140, "episode_duration_sec_mean": 0.006326246655080467, "episode_return_max": 12.5, "rlmodule_inference_timer": 3.026766633225358e-05, "num_agent_steps_sampled": {"default_agent": 400}, "num_module_steps_sampled_lifetime": {"default_policy": 2800}, "num_agent_steps_sampled_lifetime": {"default_agent": 2800}, "num_module_steps_sampled": {"default_policy": 400}, "sample": 0.1322534394536201, "episode_return_mean": 0.2, "env_step_timer": 1.379088945533711e-05, "agent_episode_returns_mean": {"default_agent": 0.2}, "num_episodes": 20, "module_episode_returns_mean": {"default_policy": 0.2}, "episode_return_min": -12.5, "num_env_steps_sampled_lifetime": 35400, "env_reset_timer": 0.0005774181168546426, "time_between_sampling": 12.505707792251801}, "num_healthy_workers": 1, "actor_manager_num_outstanding_async_reqs": 0, "num_remote_worker_restarts": 0}, "num_env_steps_sampled_lifetime": -3077500.0, "fault_tolerance": {"num_healthy_workers": 0, "num_remote_worker_restarts": 0}, "env_runner_group": {"actor_manager_num_outstanding_async_reqs": 0}, "done": false, "training_iteration": 7, "trial_id": "ae8a2_00000", "date": "2025-08-11_18-23-51", "timestamp": 1754929431, "time_this_iter_s": 10.294950008392334, "time_total_s": 85.19268250465393, "pid": 10870, "hostname": "Mac", "node_ip": "127.0.0.1", "config": {"exploration_config": {}, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 2, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "env": "Umbrella", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": false, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 0, "create_local_env_runner": true, "num_envs_per_env_runner": 1, "gym_env_vectorize_mode": "SYNC", "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "episodes_to_numpy": true, "max_requests_in_flight_per_env_runner": 1, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "merge_env_runner_states": "training_only", "broadcast_env_runner_states": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "complete_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "sampler_perf_stats_ema_coef": null, "_is_online": true, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": "auto", "num_aggregator_actors_per_learner": 0, "max_requests_in_flight_per_aggregator_actor": 3, "local_gpu_idx": 0, "max_requests_in_flight_per_learner": 3, "gamma": 1, "lr": 0.0002715581955, "grad_clip": 0.5, "grad_clip_by": "global_norm", "_train_batch_size_per_learner": 5000, "train_batch_size": 4000, "num_epochs": 1, "minibatch_size": 1000, "shuffle_batch_per_epoch": true, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "log_std_clip_param": 20.0, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "_disable_preprocessor_api": false, "_disable_action_flattening": false}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {"intrinsic_reward_coeff": 0.2795015916508}, "optimizer": {}, "_learner_class": "<class 'source.intrinsic_attention_ppo.learners.IntrinsicAttentionMetaLearner.IntrinsicAttentionMetaLearner'>", "callbacks_on_algorithm_init": null, "callbacks_on_env_runners_recreated": null, "callbacks_on_offline_eval_runners_recreated": null, "callbacks_on_checkpoint_loaded": null, "callbacks_on_environment_created": null, "callbacks_on_episode_created": null, "callbacks_on_episode_start": null, "callbacks_on_episode_step": null, "callbacks_on_episode_end": null, "callbacks_on_evaluate_start": null, "callbacks_on_evaluate_end": null, "callbacks_on_evaluate_offline_start": null, "callbacks_on_evaluate_offline_end": null, "callbacks_on_sample_end": null, "callbacks_on_train_result": null, "explore": true, "enable_rl_module_and_learner": true, "enable_env_runner_and_connector_v2": true, "_prior_exploration_config": {"type": "StochasticSampling"}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x38844d8a0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "offline_data_class": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_read_batch_size": null, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "materialize_data": false, "materialize_mapped_data": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "ignore_final_observation": false, "prelearner_class": null, "prelearner_buffer_class": null, "prelearner_buffer_kwargs": {}, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_remaining_data": false, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": 1, "evaluation_duration": 20, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_auto_duration_min_env_steps_per_sample": 100, "evaluation_auto_duration_max_env_steps_per_sample": 2000, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 1, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "offline_evaluation_interval": null, "num_offline_eval_runners": 0, "offline_loss_for_module_fn": null, "offline_evaluation_duration": 1, "offline_evaluation_parallel_to_training": false, "offline_evaluation_timeout_s": 120.0, "num_cpus_per_offline_eval_runner": 1, "num_gpus_per_offline_eval_runner": 0, "custom_resources_per_offline_eval_runner": {}, "restart_failed_offline_eval_runners": true, "ignore_offline_eval_runner_failures": false, "max_num_offline_eval_runner_restarts": 1000, "offline_eval_runner_restore_timeout_s": 1800.0, "max_requests_in_flight_per_offline_eval_runner": 1, "validate_offline_eval_runners_after_construction": true, "offline_eval_runner_health_probe_timeout_s": 30.0, "offline_eval_rl_module_inference_only": false, "broadcast_offline_eval_runner_states": false, "offline_eval_batch_size_per_runner": 256, "dataset_num_iters_per_eval_runner": 1, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "log_gradients": false, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 1, "restart_failed_env_runners": true, "ignore_env_runner_failures": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30.0, "env_runner_restore_timeout_s": 1800.0, "_model_config": {}, "_rl_module_spec": "MultiRLModuleSpec(multi_rl_module_class=<class 'ray.rllib.core.rl_module.multi_rl_module.MultiRLModule'>, observation_space=None, action_space=None, inference_only=False, model_config=None, rl_module_specs={'default_policy': RLModuleSpec(module_class=<class 'source.intrinsic_attention_ppo.rl_modules.DifferentiablePPOModule.DifferentiablePPOModule'>, observation_space=None, action_space=None, inference_only=False, learner_only=False, model_config={'vf_share_layers': True, 'embedding_dim': 62, 'max_seq_len': 11, 'policy_head_hidden_sizes': [32], 'value_head_hidden_sizes': [101], 'embedding_hidden_sizes': [121]}, catalog_class=None, load_state_path=None, model_config_dict=None), 'intrinsic_reward_module': RLModuleSpec(module_class=<class 'source.intrinsic_attention_ppo.rl_modules.IntrinsicAttentionModule.IntrinsicAttentionModule'>, observation_space=None, action_space=None, inference_only=False, learner_only=True, model_config={'intrinsic_reward_network': {'encoder_hidden_sizes': [], 'encoding_dim': 1, 'num_heads': 1, 'head_hidden_sizes': None, 'layers': [{'type': 'attention'}]}, 'extrinsic_value_hidden_layers': [127, 60], 'vf_share_layers': True, 'max_seq_len': 11}, catalog_class=None, load_state_path=None, model_config_dict=None)}, load_state_path=None, modules_to_load=None, module_specs={'default_policy': RLModuleSpec(module_class=<class 'source.intrinsic_attention_ppo.rl_modules.DifferentiablePPOModule.DifferentiablePPOModule'>, observation_space=None, action_space=None, inference_only=False, learner_only=False, model_config={'vf_share_layers': True, 'embedding_dim': 62, 'max_seq_len': 11, 'policy_head_hidden_sizes': [32], 'value_head_hidden_sizes': [101], 'embedding_hidden_sizes': [121]}, catalog_class=None, load_state_path=None, model_config_dict=None), 'intrinsic_reward_module': RLModuleSpec(module_class=<class 'source.intrinsic_attention_ppo.rl_modules.IntrinsicAttentionModule.IntrinsicAttentionModule'>, observation_space=None, action_space=None, inference_only=False, learner_only=True, model_config={'intrinsic_reward_network': {'encoder_hidden_sizes': [], 'encoding_dim': 1, 'num_heads': 1, 'head_hidden_sizes': None, 'layers': [{'type': 'attention'}]}, 'extrinsic_value_hidden_layers': [127, 60], 'vf_share_layers': True, 'max_seq_len': 11}, catalog_class=None, load_state_path=None, model_config_dict=None)})", "algorithm_config_overrides_per_module": {"intrinsic_reward_module": {"lr": 0.0002715581955}}, "_per_module_overrides": {}, "_validate_config": true, "_use_msgpack_checkpoints": false, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "env_task_fn": -1, "enable_connectors": -1, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.161583927863, "kl_target": 0.0201019014258, "vf_loss_coeff": 0.7790510010087, "entropy_coeff": 0.0015431216992, "clip_param": 0.2459212356676, "vf_clip_param": 0.3769744131561, "entropy_coeff_schedule": null, "lr_schedule": null, "sgd_minibatch_size": -1, "vf_share_layers": -1, "differentiable_learner_configs": ["DifferentiableLearnerConfig(learner_class=<class 'source.intrinsic_attention_ppo.learners.IntrinsicAttentionPPOLearner.IntrinsicAttentionPPOLearner'>, learner_connector=None, add_default_connectors_to_learner_pipeline=True, is_multi_agent=False, policies_to_update=['default_policy'], lr=0.0060984166342, num_total_minibatches=0, num_epochs=1, minibatch_size=1000, shuffle_batch_per_epoch=True)"], "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9485408017724, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.callbacks.callbacks.RLlibCallback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 85.19268250465393, "iterations_since_restore": 7, "perf": {"cpu_util_percent": 46.73571428571428, "ram_util_percent": 80.94285714285715}}
{"timers": {"training_iteration": 12.580670509600521, "restore_env_runners": 1.2441853375758257e-05, "training_step": 12.580472333177001, "env_runner_sampling_timer": 2.8777329199324315, "learner_update_timer": 9.484680712344838, "synch_weights": 0.0016583394782096633, "restore_eval_env_runners": 5.3718975415407194e-05, "evaluation_iteration": 0.1442566976077069, "synch_eval_env_connectors": 0.0002290287385359395, "synch_env_connectors": 6.0901597657731685e-06}, "env_runners": {"module_to_env_connector": {"connector_pipeline_timer": 0.00012344464506317814, "timers": {"connectors": {"remove_single_ts_time_rank_from_batch": 1.233856093234118e-05, "un_batch_to_individual_items": 6.8019501034147745e-06, "get_actions": 4.159671838986113e-05, "tensor_to_numpy": 1.573746863950731e-05, "listify_data_for_vector_env": 1.0874309518155073e-05, "normalize_and_clip_actions": 8.206259921108036e-06}}}, "rlmodule_inference_timer": 3.348754493831992e-05, "sample": 0.0059618272656920355, "weights_seq_no": 7.0, "num_agent_steps_sampled": {"default_agent": 5000.0}, "episode_len_mean": 20.0, "episode_len_max": 20, "env_to_module_connector": {"timers": {"connectors": {"batch_individual_items": 1.308124868232203e-05, "add_states_from_episodes_to_batch": 2.810697243657424e-06, "numpy_to_tensor": 1.3359685986688606e-05, "add_observations_from_episodes_to_batch": 2.9265096050519285e-06, "add_time_dim_to_batch_and_zero_pad": 7.2779047502774845e-06}}, "connector_pipeline_timer": 6.262626354591577e-05}, "env_to_module_sum_episodes_length_out": 10.36823839457432, "num_agent_steps_sampled_lifetime": {"default_agent": -3695000.0}, "episode_return_mean": 0.6199999999999999, "num_module_steps_sampled_lifetime": {"default_policy": -3695000.0}, "num_episodes": 250.0, "time_between_sampling": 0.035687353818293036, "num_env_steps_sampled_lifetime": -3695000.0, "episode_return_min": -10.5, "env_reset_timer": 4.688220877217254e-05, "env_to_module_sum_episodes_length_in": 10.36823839457432, "num_episodes_lifetime": -184750.0, "agent_episode_returns_mean": {"default_agent": 0.6199999999999999}, "episode_len_min": 20, "episode_duration_sec_mean": 0.005551024647895248, "env_step_timer": 1.4913326077651328e-05, "episode_return_max": 9.5, "num_module_steps_sampled": {"default_policy": 5000.0}, "module_episode_returns_mean": {"default_policy": 0.6199999999999999}, "num_env_steps_sampled": 5000.0, "num_env_steps_sampled_lifetime_throughput": 3121.322980743547}, "__all_modules__": {"learner_connector_sum_episodes_length_in": 5000.0, "learner_connector": {"connector_pipeline_timer": 0.16173363625800405, "timers": {"connectors": {"add_one_ts_to_episodes_and_truncate": 0.009362594647537496, "add_observations_from_episodes_to_batch": 0.0016406921365339634, "add_columns_from_episodes_to_train_batch": 0.049712216557463905, "add_time_dim_to_batch_and_zero_pad": 0.08531614782102175, "add_states_from_episodes_to_batch": 0.00892618632488257, "batch_individual_items": 0.006428127271303832, "numpy_to_tensor": 9.646000043762384e-05}}}, "learner_connector_sum_episodes_length_out": 5250.0}, "learners": {"default_policy": {"curr_entropy_coeff": 0.0015431216992, "curr_kl_coeff": 0.0006311872275546193, "num_module_steps_trained_lifetime": 47880, "entropy": 0.6854025721549988, "num_module_steps_trained": 5985, "diff_num_grad_updates_vs_sampler_policy": 1.0, "vf_loss": 0.35831865668296814, "vf_loss_unclipped": 43.56161117553711, "policy_loss": -0.00027273051091469824, "use_intrinsic_rewards": 0.0, "total_loss": 0.2778181731700897, "vf_explained_var": -0.00016379356384277344, "mean_kl_loss": 3.755880970857106e-05, "weights_seq_no": 8.0, "num_trainable_parameters": 16595, "module_train_batch_size_mean": 997.8076834879114, "num_module_steps_trained_lifetime_throughput": 740.8328374553994}, "intrinsic_reward_module": {"num_module_steps_trained_lifetime": 47880, "num_module_steps_trained": 5985, "diff_num_grad_updates_vs_sampler_policy": 1.0, "total_loss": 0.0, "gradients_default_optimizer_global_norm": 0.0, "module_train_batch_size_mean": 997.8076834879114, "default_optimizer_learning_rate": 0.0002715581955, "weights_seq_no": 8.0, "num_trainable_parameters": 8266, "curr_entropy_coeff": 0.0015431216992, "num_module_steps_trained_lifetime_throughput": 740.8438461215258}, "differentiable_learners": {"intrinsic_attention_ppo_learner": {"default_policy": {"weights_seq_no": 48.0, "num_module_steps_trained": 35910, "num_module_steps_trained_lifetime": 287280, "entropy": 0.6854200959205627, "diff_num_grad_updates_vs_sampler_policy": 41.0, "vf_loss": 0.3584858179092407, "vf_loss_unclipped": 43.608070373535156, "total_loss": 0.27795952558517456, "mean_kl_loss": 3.634411405073479e-05, "policy_loss": -0.00026739310123957694, "use_intrinsic_rewards": 1.0, "module_train_batch_size_mean": 997.5252898807411, "vf_explained_var": -0.0015821456909179688}, "__all_modules__": {"num_env_steps_trained": 198000, "num_module_steps_trained": 71820, "num_module_steps_trained_lifetime": 574560, "num_env_steps_trained_lifetime": 1584000, "num_env_steps_trained_lifetime_throughput": 36003.24836713102}, "intrinsic_reward_module": {"weights_seq_no": 48.0, "num_module_steps_trained_lifetime": 287280, "num_module_steps_trained": 35910, "diff_num_grad_updates_vs_sampler_policy": 41.0, "total_loss": 0.0, "module_train_batch_size_mean": 997.5252898807411}}}, "__all_modules__": {"num_env_steps_trained_lifetime": 264000, "num_non_trainable_parameters": 0, "num_trainable_parameters": 24861, "num_env_steps_trained": 33000, "num_module_steps_trained": 11970, "num_module_steps_trained_lifetime": 95760, "num_env_steps_trained_lifetime_throughput": 4086.383606146378, "num_module_steps_trained_throughput": 24732849.96959356, "num_module_steps_trained_lifetime_throughput": 12761097.66630238}, "IntrinsicAttentionMask": [[[0.0923907533288002, 0.09240041673183441, 0.0906154066324234, 0.08962231129407883, 0.09242941439151764, 0.09141644835472107, 0.08965043723583221, 0.08965981006622314, 0.09144513309001923, 0.0896785706281662, 0.09069124609231949], [0.0923973098397255, 0.09240701794624329, 0.09061408787965775, 0.08961667120456696, 0.09243614226579666, 0.09141866117715836, 0.0896449089050293, 0.08965432643890381, 0.09144748002290726, 0.08967316895723343, 0.09069027006626129], [0.09117972105741501, 0.09118147194385529, 0.09085624665021896, 0.0906730443239212, 0.09118670970201492, 0.09100283682346344, 0.09067825227975845, 0.09067998826503754, 0.09100806713104248, 0.0906834602355957, 0.09087017178535461], [0.09049493074417114, 0.09049227833747864, 0.09098924696445465, 0.09127119183540344, 0.09048430621623993, 0.09076468646526337, 0.09126315265893936, 0.09126047790050507, 0.09075669199228287, 0.09125511348247528, 0.09096787124872208], [0.09241694211959839, 0.09242677688598633, 0.09061011672019958, 0.08959969878196716, 0.09245629608631134, 0.09142528474330902, 0.08962830901145935, 0.08963785320520401, 0.09145448356866837, 0.08965692669153214, 0.09068729728460312], [0.09172822535037994, 0.09173353761434555, 0.09074805676937103, 0.09019603580236435, 0.09174947440624237, 0.0911913588643074, 0.09021171182394028, 0.09021693468093872, 0.09120720624923706, 0.09022738039493561, 0.09079010784626007], [0.0905144065618515, 0.09051187336444855, 0.0909854993224144, 0.09125415235757828, 0.09050427377223969, 0.09077151119709015, 0.09124649316072464, 0.0912439376115799, 0.0907638892531395, 0.091238833963871, 0.090965136885643], [0.09052089601755142, 0.09051840752363205, 0.09098425507545471, 0.09124847501516342, 0.09051093459129333, 0.09077377617359161, 0.09124094247817993, 0.09123843163251877, 0.09076628088951111, 0.09123340994119644, 0.09096422791481018], [0.09174780547618866, 0.09175323694944382, 0.09074416756629944, 0.09017904102802277, 0.09176956117153168, 0.09119804948568344, 0.09019508212804794, 0.09020043164491653, 0.09121427685022354, 0.09021113067865372, 0.09078721702098846], [0.09053386747837067, 0.09053146094083786, 0.09098174422979355, 0.09123710542917252, 0.09052423387765884, 0.09077831357717514, 0.09122982621192932, 0.09122739732265472, 0.09077106416225433, 0.09122254699468613, 0.09096238762140274], [0.0912318006157875, 0.09123388677835464, 0.09084603935480118, 0.09062767028808594, 0.09124013781547546, 0.09102082252502441, 0.09063387662172318, 0.09063594043254852, 0.09102705866098404, 0.09064009040594101, 0.09086263924837112]], [[0.09001647680997849, 0.0887775644659996, 0.08948862552642822, 0.090036541223526, 0.09075769037008286, 0.08880395442247391, 0.08881054818630219, 0.09006330370903015, 0.1036328673362732, 0.09016110748052597, 0.08945135027170181], [0.0910339429974556, 0.09123091399669647, 0.0911174789071083, 0.0910307839512825, 0.09091760218143463, 0.09122668206691742, 0.09122563153505325, 0.09102655947208405, 0.08905593305826187, 0.0910111591219902, 0.09112340211868286], [0.09047465026378632, 0.08983811736106873, 0.09020397812128067, 0.09048492461442947, 0.09085342288017273, 0.08985172212123871, 0.0898551195859909, 0.09049862623214722, 0.09720595180988312, 0.09054867923259735, 0.09018483012914658], [0.08999831229448318, 0.08873677998781204, 0.08946078270673752, 0.09001874178647995, 0.09075320512056351, 0.08876364678144455, 0.08877036720514297, 0.0900460034608841, 0.10388366878032684, 0.09014560282230377, 0.08942282944917679], [0.08930911868810654, 0.08724894374608994, 0.08842897415161133, 0.0893426463007927, 0.090550996363163, 0.0872926265001297, 0.08730354905128479, 0.08938737213611603, 0.11321792751550674, 0.08955089747905731, 0.08836695551872253], [0.09101434797048569, 0.09117993712425232, 0.09108457714319229, 0.09101168066263199, 0.09091649949550629, 0.09117638319730759, 0.09117548912763596, 0.09100813418626785, 0.0893482118844986, 0.0909951850771904, 0.09108955413103104], [0.09100943803787231, 0.09116718918085098, 0.09107635170221329, 0.09100690484046936, 0.0909162238240242, 0.09116380661725998, 0.09116295725107193, 0.09100352227687836, 0.08942141383886337, 0.09099117666482925, 0.09108109027147293], [0.08997400850057602, 0.08868235349655151, 0.08942358940839767, 0.08999493718147278, 0.0907471552491188, 0.08870986104011536, 0.08871673792600632, 0.09002285450696945, 0.10421891510486603, 0.09012485295534134, 0.08938472718000412], [0.0643622949719429, 0.053938236087560654, 0.05971284583210945, 0.06454546004533768, 0.0714556947350502, 0.05414299666881561, 0.054194312542676926, 0.0647905021905899, 0.38776788115501404, 0.06569325178861618, 0.05939652398228645], [0.08988438546657562, 0.08848292380571365, 0.08928695321083069, 0.08990710228681564, 0.09072408080101013, 0.08851274847984314, 0.08852020651102066, 0.08993740379810333, 0.10545124113559723, 0.0900481566786766, 0.0892447903752327], [0.09050559997558594, 0.08991213887929916, 0.09025327861309052, 0.09051518142223358, 0.09085860848426819, 0.08992482721805573, 0.08992799371480942, 0.09052795171737671, 0.09676439315080643, 0.09057459980249405, 0.09023542702198029]], [[0.09101855754852295, 0.09171442687511444, 0.09023284912109375, 0.09077317267656326, 0.09118878841400146, 0.09173482656478882, 0.09025292843580246, 0.09079336374998093, 0.0917501300573349, 0.09026798605918884, 0.09027300029993057], [0.09113819897174835, 0.0926317647099495, 0.08946729451417923, 0.09061457961797714, 0.0915023684501648, 0.09267575293779373, 0.08950977772474289, 0.09065760672092438, 0.09270875155925751, 0.08954165130853653, 0.08955227583646774], [0.0908765122294426, 0.09067518264055252, 0.09110623598098755, 0.09094798564910889, 0.090827077627182, 0.09066931158304214, 0.09110033512115479, 0.09094209223985672, 0.09066490828990936, 0.09109590947628021, 0.09109443426132202], [0.09097499400377274, 0.09139023721218109, 0.09050459414720535, 0.09082825481891632, 0.09107668697834015, 0.09140239655971527, 0.09051663428544998, 0.09084033966064453, 0.09141150861978531, 0.09052566438913345, 0.09052867442369461], [0.09104835987091064, 0.09193909168243408, 0.09004489332437515, 0.09073469787836075, 0.09126607328653336, 0.09196523576974869, 0.09007050096988678, 0.0907604992389679, 0.09198484569787979, 0.09008970111608505, 0.09009610861539841], [0.09114162623882294, 0.0926586240530014, 0.08944496512413025, 0.09060987830162048, 0.09151146560907364, 0.09270329773426056, 0.08948809653520584, 0.09065357595682144, 0.09273682534694672, 0.08952045440673828, 0.08953125029802322], [0.09088023751974106, 0.09070178121328354, 0.09108380973339081, 0.09094357490539551, 0.09083642810583115, 0.09069657325744629, 0.09107857942581177, 0.09093835949897766, 0.0906926691532135, 0.09107466042041779, 0.09107335656881332], [0.09097860753536224, 0.09141692519187927, 0.090482197701931, 0.09082373976707458, 0.09108594059944153, 0.09142975509166718, 0.09049490094184875, 0.09083648771047592, 0.0914393812417984, 0.09050443023443222, 0.09050760418176651], [0.09114418178796768, 0.09267875552177429, 0.08942820876836777, 0.09060634672641754, 0.09151828289031982, 0.09272395819425583, 0.08947182446718216, 0.0906505361199379, 0.09275787323713303, 0.08950454741716385, 0.08951546251773834], [0.09088302403688431, 0.0907217264175415, 0.09106698632240295, 0.09094026684761047, 0.09084343165159225, 0.09071701765060425, 0.0910622626543045, 0.09093555063009262, 0.0907134935259819, 0.09105871617794037, 0.09105753898620605], [0.09088395535945892, 0.09072837978601456, 0.09106138348579407, 0.09093917161226273, 0.09084577113389969, 0.09072384238243103, 0.09105683118104935, 0.090934619307518, 0.09072043746709824, 0.09105341136455536, 0.09105227142572403]], [[0.09009042382240295, 0.0888504907488823, 0.08885709941387177, 0.09082549810409546, 0.0901172086596489, 0.08958210796117783, 0.08958876878023148, 0.0901372954249382, 0.10290152579545975, 0.08952483534812927, 0.08952483534812927], [0.09102395921945572, 0.0912209078669548, 0.09121984988451004, 0.09090868383646011, 0.09101974219083786, 0.09110432118177414, 0.09110326319932938, 0.09101657569408417, 0.08915597945451736, 0.09111341089010239, 0.09111341089010239], [0.09101944416761398, 0.0912085473537445, 0.09120753407478333, 0.09090875089168549, 0.09101539850234985, 0.09109660238027573, 0.09109559655189514, 0.09101235866546631, 0.08922504633665085, 0.09110533446073532, 0.09110533446073532], [0.08945044130086899, 0.08739450573921204, 0.08740540593862534, 0.09067835658788681, 0.08949505537748337, 0.08860526233911514, 0.08861630409955978, 0.08952853083610535, 0.11180569976568222, 0.08851023763418198, 0.08851023763418198], [0.0900682657957077, 0.08879812061786652, 0.08880488574504852, 0.09082144498825073, 0.09009569883346558, 0.08954750001430511, 0.0895543247461319, 0.09011628478765488, 0.10321585088968277, 0.08948883414268494, 0.08948883414268494], [0.09049485623836517, 0.089835025370121, 0.08983854949474335, 0.0908840000629425, 0.09050905704498291, 0.09022487699985504, 0.09022841602563858, 0.09051971137523651, 0.0970766544342041, 0.09019441157579422, 0.09019441157579422], [0.09048976004123688, 0.08982226252555847, 0.0898258239030838, 0.09088346362113953, 0.09050413221120834, 0.09021662920713425, 0.09022022038698196, 0.0905149057507515, 0.09715121239423752, 0.09018581360578537, 0.09018581360578537], [0.09005156904459, 0.08875879645347595, 0.08876567333936691, 0.09081833064556122, 0.09007949382066727, 0.08952149003744125, 0.08952842652797699, 0.09010044485330582, 0.10345213860273361, 0.08946177363395691, 0.08946177363395691], [0.06888234615325928, 0.058256007730960846, 0.05830835551023483, 0.07599330693483353, 0.0691302940249443, 0.06432773917913437, 0.0643855482339859, 0.06931684166193008, 0.3437350392341614, 0.06383229047060013, 0.06383229047060013], [0.09053850919008255, 0.08994483202695847, 0.08994800597429276, 0.09088844060897827, 0.09055128693580627, 0.09029565006494522, 0.09029883146286011, 0.09056086838245392, 0.09643709659576416, 0.09026823937892914, 0.09026823937892914], [0.09053850919008255, 0.08994483202695847, 0.08994800597429276, 0.09088844060897827, 0.09055128693580627, 0.09029565006494522, 0.09029883146286011, 0.09056086838245392, 0.09643709659576416, 0.09026823937892914, 0.09026823937892914]], [[0.0910683199763298, 0.09122341126203537, 0.09028217941522598, 0.09082279354333878, 0.09123864024877548, 0.09124370664358139, 0.09030225872993469, 0.09084299951791763, 0.09180028736591339, 0.09085310250520706, 0.0903223529458046], [0.09110835194587708, 0.09130287915468216, 0.09012363106012344, 0.09080057591199875, 0.09132197499275208, 0.09132833778858185, 0.09014876186847687, 0.0908258855342865, 0.09202715009450912, 0.09083855152130127, 0.09017390012741089], [0.09086235612630844, 0.09081733971834183, 0.09109204262495041, 0.09093381464481354, 0.09081292897462845, 0.09081145375967026, 0.09108614176511765, 0.09092792123556137, 0.0906507819890976, 0.09092497825622559, 0.09108024090528488], [0.09100453555583954, 0.09109717607498169, 0.09053398668766022, 0.09085775166749954, 0.09110626578330994, 0.09110929071903229, 0.09054602682590485, 0.09086983650922775, 0.09144119173288345, 0.09087587147951126, 0.09055807441473007], [0.09111227095127106, 0.09131066501140594, 0.09010809659957886, 0.09079838544130325, 0.0913301333785057, 0.09133663028478622, 0.09013371914625168, 0.09082420915365219, 0.09204941242933273, 0.09083711355924606, 0.0901593491435051], [0.09111358225345612, 0.09131326526403427, 0.09010292589664459, 0.09079766273498535, 0.09133286029100418, 0.09133939445018768, 0.09012871235609055, 0.09082365036010742, 0.09205684065818787, 0.09083664417266846, 0.0901545062661171], [0.09086767584085464, 0.09082777798175812, 0.091071218252182, 0.0909310057759285, 0.09082386642694473, 0.09082256257534027, 0.09106598794460297, 0.09092578291893005, 0.09068012982606888, 0.09092317521572113, 0.09106076508760452], [0.09100980311632156, 0.09110759198665619, 0.09051322937011719, 0.09085488319396973, 0.09111718088388443, 0.09112037718296051, 0.09052594006061554, 0.09086763858795166, 0.09147074073553085, 0.09087401628494263, 0.0905386433005333], [0.0912555381655693, 0.09159659594297409, 0.08953747153282166, 0.09071704745292664, 0.09163010120391846, 0.09164126962423325, 0.08958113938570023, 0.09076129645109177, 0.09287120401859283, 0.09078342467546463, 0.08962483704090118], [0.09101243317127228, 0.09111278504133224, 0.09050284326076508, 0.09085344523191452, 0.09112262725830078, 0.09112590551376343, 0.09051588177680969, 0.09086652845144272, 0.09148550778627396, 0.09087307751178741, 0.09052892029285431], [0.09087300300598145, 0.0908382311463356, 0.0910504087805748, 0.09092821180820465, 0.09083481878042221, 0.09083367884159088, 0.09104585647583008, 0.09092365950345993, 0.09070950746536255, 0.09092138707637787, 0.09104129672050476]], [[0.0898897722363472, 0.0886526107788086, 0.08936266601085663, 0.08990981429815292, 0.08991649001836777, 0.0893825888633728, 0.08938922733068466, 0.09065014868974686, 0.10348701477050781, 0.09003420174121857, 0.0893254429101944], [0.09105440229177475, 0.09125141054391861, 0.09113795310258865, 0.09105123579502106, 0.0910501778125763, 0.09113477915525436, 0.0911337286233902, 0.0909348651766777, 0.08907593041658401, 0.09103160351514816, 0.09114387631416321], [0.09040909260511398, 0.0897730216383934, 0.09013862162828445, 0.09041936695575714, 0.09042278677225113, 0.09014885872602463, 0.09015227109193802, 0.09079790860414505, 0.0971355214715004, 0.09048306941986084, 0.09011949598789215], [0.08986934274435043, 0.08860962092876434, 0.08933258801698685, 0.08988974988460541, 0.089896559715271, 0.08935286849737167, 0.08935963362455368, 0.0906437411904335, 0.1037348136305809, 0.0900164246559143, 0.0892946794629097], [0.08986251801252365, 0.08859527111053467, 0.0893225371837616, 0.08988304436206818, 0.08988988399505615, 0.08934294432401657, 0.08934975415468216, 0.0906415805220604, 0.10381752252578735, 0.09001048654317856, 0.08928441256284714], [0.09039010107517242, 0.08973103016614914, 0.09010982513427734, 0.09040074050426483, 0.09040428698062897, 0.09012043476104736, 0.0901239663362503, 0.09079303592443466, 0.09736978262662888, 0.09046675264835358, 0.09009000658988953], [0.09038375318050385, 0.08971703052520752, 0.09010022133588791, 0.0903945192694664, 0.09039811044931412, 0.09011095017194748, 0.090114526450634, 0.09079141169786453, 0.09744798392057419, 0.09046130627393723, 0.09008016437292099], [0.08907810598611832, 0.08700083941221237, 0.08819059282541275, 0.08911192417144775, 0.0891231968998909, 0.08822406828403473, 0.08823522925376892, 0.09036482125520706, 0.11322122067213058, 0.08932192623615265, 0.08812806010246277], [0.06363022327423096, 0.05332471430301666, 0.059033650904893875, 0.06381130963563919, 0.06387178599834442, 0.05920165777206421, 0.059257760643959045, 0.07084398716688156, 0.3833579421043396, 0.06494602560997009, 0.05872093141078949], [0.08974135667085648, 0.08834213018417358, 0.08914488554000854, 0.08976404368877411, 0.08977160602807999, 0.08916741609573364, 0.08917492628097534, 0.09060260653495789, 0.1052834540605545, 0.08990487456321716, 0.08910278230905533], [0.09044446051120758, 0.08985140174627304, 0.09019230306148529, 0.09045402705669403, 0.09045722335577011, 0.09020185470581055, 0.09020503610372543, 0.09080683439970016, 0.09669902920722961, 0.09051341563463211, 0.09017447382211685]]]}, "num_training_step_calls_per_iteration": 1, "evaluation": {"env_runners": {"module_to_env_connector": {"timers": {"connectors": {"tensor_to_numpy": 1.5169292499408236e-05, "un_batch_to_individual_items": 6.648419683120035e-06, "get_actions": 3.690561957178955e-05, "listify_data_for_vector_env": 1.0365433237576446e-05, "normalize_and_clip_actions": 8.008752204656717e-06, "remove_single_ts_time_rank_from_batch": 1.1946226380262035e-05}}, "connector_pipeline_timer": 0.00011531850229891971}, "episode_len_min": 20, "num_env_steps_sampled": 400, "weights_seq_no": 8.0, "episode_len_mean": 20.0, "env_to_module_sum_episodes_length_out": 10.3682383945743, "episode_len_max": 20, "env_to_module_connector": {"timers": {"connectors": {"batch_individual_items": 1.2430807409100105e-05, "add_observations_from_episodes_to_batch": 2.803845775429839e-06, "add_states_from_episodes_to_batch": 2.780721075352072e-06, "add_time_dim_to_batch_and_zero_pad": 7.525240305401938e-06, "numpy_to_tensor": 1.241454781322623e-05}}, "connector_pipeline_timer": 6.053099683760986e-05}, "env_to_module_sum_episodes_length_in": 10.3682383945743, "num_episodes_lifetime": 160, "episode_duration_sec_mean": 0.006327529606642202, "episode_return_max": 12.5, "rlmodule_inference_timer": 3.15365120887902e-05, "num_agent_steps_sampled": {"default_agent": 400}, "num_module_steps_sampled_lifetime": {"default_policy": 3200}, "num_agent_steps_sampled_lifetime": {"default_agent": 3200}, "num_module_steps_sampled": {"default_policy": 400}, "sample": 0.13207726380891313, "episode_return_mean": 0.0, "env_step_timer": 1.4044338690079042e-05, "agent_episode_returns_mean": {"default_agent": 0.0}, "num_episodes": 20, "module_episode_returns_mean": {"default_policy": 0.0}, "episode_return_min": -12.5, "num_env_steps_sampled_lifetime": 40400, "env_reset_timer": 0.0005746072655842896, "time_between_sampling": 12.483637333499107}, "num_healthy_workers": 1, "actor_manager_num_outstanding_async_reqs": 0, "num_remote_worker_restarts": 0}, "num_env_steps_sampled_lifetime": -3695000.0, "fault_tolerance": {"num_healthy_workers": 0, "num_remote_worker_restarts": 0}, "env_runner_group": {"actor_manager_num_outstanding_async_reqs": 0}, "done": false, "training_iteration": 8, "trial_id": "ae8a2_00000", "date": "2025-08-11_18-24-02", "timestamp": 1754929442, "time_this_iter_s": 10.394572019577026, "time_total_s": 95.58725452423096, "pid": 10870, "hostname": "Mac", "node_ip": "127.0.0.1", "config": {"exploration_config": {}, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 2, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "env": "Umbrella", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": false, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 0, "create_local_env_runner": true, "num_envs_per_env_runner": 1, "gym_env_vectorize_mode": "SYNC", "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "episodes_to_numpy": true, "max_requests_in_flight_per_env_runner": 1, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "merge_env_runner_states": "training_only", "broadcast_env_runner_states": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "complete_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "sampler_perf_stats_ema_coef": null, "_is_online": true, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": "auto", "num_aggregator_actors_per_learner": 0, "max_requests_in_flight_per_aggregator_actor": 3, "local_gpu_idx": 0, "max_requests_in_flight_per_learner": 3, "gamma": 1, "lr": 0.0002715581955, "grad_clip": 0.5, "grad_clip_by": "global_norm", "_train_batch_size_per_learner": 5000, "train_batch_size": 4000, "num_epochs": 1, "minibatch_size": 1000, "shuffle_batch_per_epoch": true, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "log_std_clip_param": 20.0, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "_disable_preprocessor_api": false, "_disable_action_flattening": false}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {"intrinsic_reward_coeff": 0.2795015916508}, "optimizer": {}, "_learner_class": "<class 'source.intrinsic_attention_ppo.learners.IntrinsicAttentionMetaLearner.IntrinsicAttentionMetaLearner'>", "callbacks_on_algorithm_init": null, "callbacks_on_env_runners_recreated": null, "callbacks_on_offline_eval_runners_recreated": null, "callbacks_on_checkpoint_loaded": null, "callbacks_on_environment_created": null, "callbacks_on_episode_created": null, "callbacks_on_episode_start": null, "callbacks_on_episode_step": null, "callbacks_on_episode_end": null, "callbacks_on_evaluate_start": null, "callbacks_on_evaluate_end": null, "callbacks_on_evaluate_offline_start": null, "callbacks_on_evaluate_offline_end": null, "callbacks_on_sample_end": null, "callbacks_on_train_result": null, "explore": true, "enable_rl_module_and_learner": true, "enable_env_runner_and_connector_v2": true, "_prior_exploration_config": {"type": "StochasticSampling"}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x38844d8a0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "offline_data_class": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_read_batch_size": null, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "materialize_data": false, "materialize_mapped_data": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "ignore_final_observation": false, "prelearner_class": null, "prelearner_buffer_class": null, "prelearner_buffer_kwargs": {}, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_remaining_data": false, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": 1, "evaluation_duration": 20, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_auto_duration_min_env_steps_per_sample": 100, "evaluation_auto_duration_max_env_steps_per_sample": 2000, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 1, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "offline_evaluation_interval": null, "num_offline_eval_runners": 0, "offline_loss_for_module_fn": null, "offline_evaluation_duration": 1, "offline_evaluation_parallel_to_training": false, "offline_evaluation_timeout_s": 120.0, "num_cpus_per_offline_eval_runner": 1, "num_gpus_per_offline_eval_runner": 0, "custom_resources_per_offline_eval_runner": {}, "restart_failed_offline_eval_runners": true, "ignore_offline_eval_runner_failures": false, "max_num_offline_eval_runner_restarts": 1000, "offline_eval_runner_restore_timeout_s": 1800.0, "max_requests_in_flight_per_offline_eval_runner": 1, "validate_offline_eval_runners_after_construction": true, "offline_eval_runner_health_probe_timeout_s": 30.0, "offline_eval_rl_module_inference_only": false, "broadcast_offline_eval_runner_states": false, "offline_eval_batch_size_per_runner": 256, "dataset_num_iters_per_eval_runner": 1, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "log_gradients": false, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 1, "restart_failed_env_runners": true, "ignore_env_runner_failures": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30.0, "env_runner_restore_timeout_s": 1800.0, "_model_config": {}, "_rl_module_spec": "MultiRLModuleSpec(multi_rl_module_class=<class 'ray.rllib.core.rl_module.multi_rl_module.MultiRLModule'>, observation_space=None, action_space=None, inference_only=False, model_config=None, rl_module_specs={'default_policy': RLModuleSpec(module_class=<class 'source.intrinsic_attention_ppo.rl_modules.DifferentiablePPOModule.DifferentiablePPOModule'>, observation_space=None, action_space=None, inference_only=False, learner_only=False, model_config={'vf_share_layers': True, 'embedding_dim': 62, 'max_seq_len': 11, 'policy_head_hidden_sizes': [32], 'value_head_hidden_sizes': [101], 'embedding_hidden_sizes': [121]}, catalog_class=None, load_state_path=None, model_config_dict=None), 'intrinsic_reward_module': RLModuleSpec(module_class=<class 'source.intrinsic_attention_ppo.rl_modules.IntrinsicAttentionModule.IntrinsicAttentionModule'>, observation_space=None, action_space=None, inference_only=False, learner_only=True, model_config={'intrinsic_reward_network': {'encoder_hidden_sizes': [], 'encoding_dim': 1, 'num_heads': 1, 'head_hidden_sizes': None, 'layers': [{'type': 'attention'}]}, 'extrinsic_value_hidden_layers': [127, 60], 'vf_share_layers': True, 'max_seq_len': 11}, catalog_class=None, load_state_path=None, model_config_dict=None)}, load_state_path=None, modules_to_load=None, module_specs={'default_policy': RLModuleSpec(module_class=<class 'source.intrinsic_attention_ppo.rl_modules.DifferentiablePPOModule.DifferentiablePPOModule'>, observation_space=None, action_space=None, inference_only=False, learner_only=False, model_config={'vf_share_layers': True, 'embedding_dim': 62, 'max_seq_len': 11, 'policy_head_hidden_sizes': [32], 'value_head_hidden_sizes': [101], 'embedding_hidden_sizes': [121]}, catalog_class=None, load_state_path=None, model_config_dict=None), 'intrinsic_reward_module': RLModuleSpec(module_class=<class 'source.intrinsic_attention_ppo.rl_modules.IntrinsicAttentionModule.IntrinsicAttentionModule'>, observation_space=None, action_space=None, inference_only=False, learner_only=True, model_config={'intrinsic_reward_network': {'encoder_hidden_sizes': [], 'encoding_dim': 1, 'num_heads': 1, 'head_hidden_sizes': None, 'layers': [{'type': 'attention'}]}, 'extrinsic_value_hidden_layers': [127, 60], 'vf_share_layers': True, 'max_seq_len': 11}, catalog_class=None, load_state_path=None, model_config_dict=None)})", "algorithm_config_overrides_per_module": {"intrinsic_reward_module": {"lr": 0.0002715581955}}, "_per_module_overrides": {}, "_validate_config": true, "_use_msgpack_checkpoints": false, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "env_task_fn": -1, "enable_connectors": -1, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.161583927863, "kl_target": 0.0201019014258, "vf_loss_coeff": 0.7790510010087, "entropy_coeff": 0.0015431216992, "clip_param": 0.2459212356676, "vf_clip_param": 0.3769744131561, "entropy_coeff_schedule": null, "lr_schedule": null, "sgd_minibatch_size": -1, "vf_share_layers": -1, "differentiable_learner_configs": ["DifferentiableLearnerConfig(learner_class=<class 'source.intrinsic_attention_ppo.learners.IntrinsicAttentionPPOLearner.IntrinsicAttentionPPOLearner'>, learner_connector=None, add_default_connectors_to_learner_pipeline=True, is_multi_agent=False, policies_to_update=['default_policy'], lr=0.0060984166342, num_total_minibatches=0, num_epochs=1, minibatch_size=1000, shuffle_batch_per_epoch=True)"], "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9485408017724, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.callbacks.callbacks.RLlibCallback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 95.58725452423096, "iterations_since_restore": 8, "perf": {"cpu_util_percent": 49.58666666666668, "ram_util_percent": 81.46000000000001}}
{"timers": {"training_iteration": 12.556151918674827, "restore_env_runners": 1.2377854394028854e-05, "training_step": 12.555953680265405, "env_runner_sampling_timer": 2.8644857190630995, "learner_update_timer": 9.473718132310974, "synch_weights": 0.0016514677429409804, "restore_eval_env_runners": 5.3282615299793866e-05, "evaluation_iteration": 0.14404704813135835, "synch_eval_env_connectors": 0.00022795137191131598, "synch_env_connectors": 6.071757909654796e-06}, "env_runners": {"module_to_env_connector": {"connector_pipeline_timer": 0.00011914981239125151, "timers": {"connectors": {"remove_single_ts_time_rank_from_batch": 1.2051401190814272e-05, "un_batch_to_individual_items": 6.605590117742492e-06, "get_actions": 3.954416650453098e-05, "tensor_to_numpy": 1.5219314275497973e-05, "listify_data_for_vector_env": 1.055227619107302e-05, "normalize_and_clip_actions": 8.070963507416468e-06}}}, "rlmodule_inference_timer": 3.1711220769145425e-05, "sample": 0.005788950501526975, "weights_seq_no": 8.0, "num_agent_steps_sampled": {"default_agent": 5000.0}, "episode_len_mean": 20.0, "episode_len_max": 20, "env_to_module_connector": {"timers": {"connectors": {"batch_individual_items": 1.2629621379388215e-05, "add_states_from_episodes_to_batch": 2.730772818953297e-06, "numpy_to_tensor": 1.2853950576519276e-05, "add_observations_from_episodes_to_batch": 2.8224129061145446e-06, "add_time_dim_to_batch_and_zero_pad": 6.952830755417287e-06}}, "connector_pipeline_timer": 6.055027702056286e-05}, "env_to_module_sum_episodes_length_out": 10.36823839457432, "num_agent_steps_sampled_lifetime": {"default_agent": -4312500.0}, "episode_return_mean": 0.3, "num_module_steps_sampled_lifetime": {"default_policy": -4312500.0}, "num_episodes": 250.0, "time_between_sampling": 0.035699236157803044, "num_env_steps_sampled_lifetime": -4312500.0, "episode_return_min": -10.5, "env_reset_timer": 4.4813359266325713e-05, "env_to_module_sum_episodes_length_in": 10.36823839457432, "num_episodes_lifetime": -215625.0, "agent_episode_returns_mean": {"default_agent": 0.3}, "episode_len_min": 20, "episode_duration_sec_mean": 0.005321732863318175, "env_step_timer": 1.420184463473698e-05, "episode_return_max": 9.5, "num_module_steps_sampled": {"default_policy": 5000.0}, "module_episode_returns_mean": {"default_policy": 0.3}, "num_env_steps_sampled": 5000.0, "num_env_steps_sampled_lifetime_throughput": 3197.1307779167823}, "__all_modules__": {"learner_connector_sum_episodes_length_in": 5000.0, "learner_connector": {"connector_pipeline_timer": 0.1614911203150112, "timers": {"connectors": {"add_one_ts_to_episodes_and_truncate": 0.009356381201350458, "add_observations_from_episodes_to_batch": 0.001632598965318306, "add_columns_from_episodes_to_train_batch": 0.04963127772154226, "add_time_dim_to_batch_and_zero_pad": 0.08524665467321645, "add_states_from_episodes_to_batch": 0.008874665711759436, "batch_individual_items": 0.00640350974763928, "numpy_to_tensor": 9.641915019117823e-05}}}, "learner_connector_sum_episodes_length_out": 5250.0}, "learners": {"default_policy": {"curr_entropy_coeff": 0.0015431216992, "curr_kl_coeff": 0.00031559361377730966, "num_module_steps_trained_lifetime": 53865, "entropy": 0.6851275563240051, "num_module_steps_trained": 5985, "diff_num_grad_updates_vs_sampler_policy": 1.0, "vf_loss": 0.3583202660083771, "vf_loss_unclipped": 43.35628890991211, "policy_loss": -0.00013821644824929535, "use_intrinsic_rewards": 0.0, "total_loss": 0.2779542803764343, "vf_explained_var": -0.0024205446243286133, "mean_kl_loss": 6.586828931176569e-06, "weights_seq_no": 9.0, "num_trainable_parameters": 16595, "module_train_batch_size_mean": 997.7895308613665, "num_module_steps_trained_lifetime_throughput": 736.6700174179774}, "intrinsic_reward_module": {"num_module_steps_trained_lifetime": 53865, "num_module_steps_trained": 5985, "diff_num_grad_updates_vs_sampler_policy": 1.0, "total_loss": 0.0, "gradients_default_optimizer_global_norm": 0.0, "module_train_batch_size_mean": 997.7895308613665, "default_optimizer_learning_rate": 0.0002715581955, "weights_seq_no": 9.0, "num_trainable_parameters": 8266, "curr_entropy_coeff": 0.0015431216992, "num_module_steps_trained_lifetime_throughput": 736.6802893659609}, "differentiable_learners": {"intrinsic_attention_ppo_learner": {"default_policy": {"weights_seq_no": 54.0, "num_module_steps_trained": 35910, "num_module_steps_trained_lifetime": 323190, "entropy": 0.6851486563682556, "diff_num_grad_updates_vs_sampler_policy": 46.0, "vf_loss": 0.3584820330142975, "vf_loss_unclipped": 43.40502166748047, "total_loss": 0.27808821201324463, "mean_kl_loss": 5.987601525703212e-06, "policy_loss": -0.00013128372665960342, "use_intrinsic_rewards": 1.0, "module_train_batch_size_mean": 997.5168494263723, "vf_explained_var": -0.0016158819198608398}, "__all_modules__": {"num_env_steps_trained": 198000, "num_module_steps_trained": 71820, "num_module_steps_trained_lifetime": 646380, "num_env_steps_trained_lifetime": 1782000, "num_env_steps_trained_lifetime_throughput": 35747.44927132765}, "intrinsic_reward_module": {"weights_seq_no": 54.0, "num_module_steps_trained_lifetime": 323190, "num_module_steps_trained": 35910, "diff_num_grad_updates_vs_sampler_policy": 46.0, "total_loss": 0.0, "module_train_batch_size_mean": 997.5168494263723}}}, "__all_modules__": {"num_env_steps_trained_lifetime": 297000, "num_non_trainable_parameters": 0, "num_trainable_parameters": 24861, "num_env_steps_trained": 33000, "num_module_steps_trained": 11970, "num_module_steps_trained_lifetime": 107730, "num_env_steps_trained_lifetime_throughput": 4063.3720434009088, "num_module_steps_trained_throughput": 24078236.859225973, "num_module_steps_trained_lifetime_throughput": 12723785.248280695}, "IntrinsicAttentionMask": [[[0.09106781333684921, 0.09122291207313538, 0.09081724286079407, 0.09028670191764832, 0.09177936613559723, 0.0912432074546814, 0.0903017595410347, 0.09084250032901764, 0.0917997807264328, 0.09031683206558228, 0.090321846306324], [0.091107577085495, 0.09130210429430008, 0.09079346805810928, 0.09012914448976517, 0.09200071543455124, 0.09132755547761917, 0.09014799445867538, 0.09082511812448502, 0.09202636778354645, 0.0901668444275856, 0.09017312526702881], [0.09100304543972015, 0.09109440445899963, 0.09085531532764435, 0.09054198116064072, 0.09142164885997772, 0.0911063477396965, 0.09055088460445404, 0.0908702164888382, 0.09143363684415817, 0.09055978804826736, 0.09056276082992554], [0.09086364507675171, 0.09081991016864777, 0.09093450754880905, 0.09108536690473557, 0.09066378325223923, 0.09081419557332993, 0.09108106791973114, 0.090927354991436, 0.09065807610750198, 0.09107676893472672, 0.0910753384232521], [0.09124807268381119, 0.09158393740653992, 0.09070684015750885, 0.08956661075353622, 0.09279440343379974, 0.09162792563438416, 0.0895988792181015, 0.09076131135225296, 0.09283898025751114, 0.08963115513324738, 0.08964191377162933], [0.09111275523900986, 0.09131243824958801, 0.09079034626483917, 0.09010855108499527, 0.09202966839075089, 0.09133856743574142, 0.09012789279222488, 0.09082283079624176, 0.09205600619316101, 0.0901472419500351, 0.09015368670225143], [0.09086764603853226, 0.09082774817943573, 0.09093228727579117, 0.09106988459825516, 0.09068530797958374, 0.09082254022359848, 0.09106596559286118, 0.09092576056718826, 0.09068010002374649, 0.0910620391368866, 0.09106073528528214], [0.09100960195064545, 0.09110739082098007, 0.09085150063037872, 0.09051620960235596, 0.09145770221948624, 0.0911201760172844, 0.09052573889493942, 0.09086743742227554, 0.09147053956985474, 0.09053526818752289, 0.09053844213485718], [0.09125316143035889, 0.09159421175718307, 0.09070362150669098, 0.08954605460166931, 0.09282350540161133, 0.09163887798786163, 0.08957880735397339, 0.09075892716646194, 0.09286878257989883, 0.08961156755685806, 0.08962249010801315], [0.0908716470003128, 0.0908355861902237, 0.09093005955219269, 0.09105440229177475, 0.09070683270692825, 0.09083087742328644, 0.09105085581541061, 0.09092416614294052, 0.0907021313905716, 0.09104731678962708, 0.09104613959789276], [0.09087297320365906, 0.09083819389343262, 0.090929314494133, 0.09104923903942108, 0.09071400761604309, 0.0908336490392685, 0.0910458192229271, 0.09092362970113754, 0.09070947021245956, 0.0910424068570137, 0.09104126691818237]], [[0.0901540070772171, 0.088913194835186, 0.08891980350017548, 0.0908895954489708, 0.09018079936504364, 0.08964532613754272, 0.08894623070955276, 0.09020090103149414, 0.10297416150569916, 0.08958800882101059, 0.08958800882101059], [0.09101372957229614, 0.09121065586805344, 0.09120959788560867, 0.09089846163988113, 0.09100951254367828, 0.09109407663345337, 0.09120537340641022, 0.09100634604692459, 0.0891459509730339, 0.09110316634178162, 0.09110316634178162], [0.09100963175296783, 0.09119871258735657, 0.09119769930839539, 0.09089894592761993, 0.09100557863712311, 0.09108678251504898, 0.09119363874197006, 0.09100254625082016, 0.08921542018651962, 0.09109550714492798, 0.09109550714492798], [0.08955497294664383, 0.08749663829803467, 0.08750755339860916, 0.09078433364629745, 0.08959963917732239, 0.0887088030576706, 0.08755119889974594, 0.08963315188884735, 0.11193639039993286, 0.08861367404460907, 0.08861367404460907], [0.09013336151838303, 0.08886230736970901, 0.08886907249689102, 0.09088709205389023, 0.09016081690788269, 0.08961223065853119, 0.08889614045619965, 0.09018141776323318, 0.10329047590494156, 0.08955352008342743, 0.08955352008342743], [0.09052886813879013, 0.08986879885196686, 0.0898723229765892, 0.0909181609749794, 0.09054308384656906, 0.09025879204273224, 0.08988642692565918, 0.09055373817682266, 0.09711314737796783, 0.09022831171751022, 0.09022831171751022], [0.09099321067333221, 0.09115093946456909, 0.09115009009838104, 0.09090086072683334, 0.09098983556032181, 0.09105757623910904, 0.09114670753479004, 0.09098729491233826, 0.08949381113052368, 0.09106485545635223, 0.09106485545635223], [0.09011782705783844, 0.08882409334182739, 0.08883097767829895, 0.09088515490293503, 0.0901457741856575, 0.08958735316991806, 0.08885852992534637, 0.09016674011945724, 0.10352827608585358, 0.08952759951353073, 0.08952759951353073], [0.06928881257772446, 0.05859975889325142, 0.058652423322200775, 0.07644174993038177, 0.06953822821378708, 0.06470732390880585, 0.058863554149866104, 0.0697258859872818, 0.3457643389701843, 0.06420895457267761, 0.06420895457267761], [0.0905691385269165, 0.0899752527475357, 0.08997842669487, 0.09091918170452118, 0.09058191627264023, 0.09032618999481201, 0.08999112248420715, 0.09059149771928787, 0.09646972268819809, 0.09029877930879593, 0.09029877930879593], [0.0905691385269165, 0.0899752527475357, 0.08997842669487, 0.09091918170452118, 0.09058191627264023, 0.09032618999481201, 0.08999112248420715, 0.09059149771928787, 0.09646972268819809, 0.09029877930879593, 0.09029877930879593]], [[0.09248709678649902, 0.09147349745035172, 0.08970638364553452, 0.09071937948465347, 0.09150219708681107, 0.09151177108287811, 0.08974391967058182, 0.0907573401927948, 0.09154049307107925, 0.08977208286523819, 0.09078581631183624], [0.09175265580415726, 0.09121222794055939, 0.09026335179805756, 0.09080834686756134, 0.09122756868600845, 0.09123268723487854, 0.0902835950255394, 0.09082870930433273, 0.0912480279803276, 0.09029878675937653, 0.09084399044513702], [0.0904625877737999, 0.09074730426073074, 0.09125351160764694, 0.09096177667379379, 0.0907391905784607, 0.09073647856712341, 0.09124262630939484, 0.09095092862844467, 0.09072836488485336, 0.09123446047306061, 0.09094279259443283], [0.09120362997055054, 0.0910153016448021, 0.09068288654088974, 0.0908740907907486, 0.09102066606283188, 0.09102244675159454, 0.0906900018453598, 0.09088122099637985, 0.09102781116962433, 0.0906953439116478, 0.09088657051324844], [0.09177352488040924, 0.0912196934223175, 0.09024748206138611, 0.09080585092306137, 0.09123541414737701, 0.09124065935611725, 0.09026822447776794, 0.09082671999931335, 0.09125638753175735, 0.09028378129005432, 0.0908423662185669], [0.09178046882152557, 0.09122216701507568, 0.0902421846985817, 0.09080500155687332, 0.09123801440000534, 0.09124329686164856, 0.09026309102773666, 0.09082603454589844, 0.09125915169715881, 0.09027877449989319, 0.09084181487560272], [0.09049011021852493, 0.09075730293989182, 0.09123221784830093, 0.09095854312181473, 0.09074968099594116, 0.09074714034795761, 0.09122200310230255, 0.09094835817813873, 0.09073952585458755, 0.09121435135602951, 0.09094072878360748], [0.0912313237786293, 0.09102527797222137, 0.0906616672873497, 0.09087079763412476, 0.09103113412857056, 0.09103308618068695, 0.09066945314407349, 0.09087859839200974, 0.09103894978761673, 0.09067529439926147, 0.09088444709777832], [0.09180132299661636, 0.09122961759567261, 0.09022630006074905, 0.09080248326063156, 0.09124584496021271, 0.09125125408172607, 0.09024769812822342, 0.09082402288913727, 0.09126748144626617, 0.09026375412940979, 0.0908401757478714], [0.09051075577735901, 0.09076479822397232, 0.09121624380350113, 0.09095610678195953, 0.09075755625963211, 0.09075514227151871, 0.09120653569698334, 0.09094642847776413, 0.0907479003071785, 0.09119925647974014, 0.09093917161226273], [0.09125209599733353, 0.09103275090456009, 0.09064575284719467, 0.09086832404136658, 0.09103898704051971, 0.09104106575250626, 0.09065403789281845, 0.09087662398815155, 0.09104730188846588, 0.09066025167703629, 0.09088285267353058]], [[0.08995398879051208, 0.08941985666751862, 0.08942650258541107, 0.089974045753479, 0.08998072892427444, 0.08874230831861496, 0.0894530788064003, 0.09000078588724136, 0.10356095433235168, 0.09009851515293121, 0.08938925713300705], [0.09044802188873291, 0.09017734229564667, 0.09018071740865707, 0.09045816957950592, 0.09046155214309692, 0.08983282744884491, 0.0901942104101181, 0.09047170728445053, 0.09709254652261734, 0.09052113443613052, 0.09016181528568268], [0.09044209867715836, 0.09016811102628708, 0.09017152339220047, 0.09045237302780151, 0.0904557928442955, 0.08981939405202866, 0.09018518030643463, 0.09046606719493866, 0.09717097878456116, 0.090516097843647, 0.09015239030122757], [0.08993472903966904, 0.0893908217549324, 0.08939757943153381, 0.0899551585316658, 0.0899619609117508, 0.08870094269514084, 0.08942465484142303, 0.08998239040374756, 0.10381030291318893, 0.09008192270994186, 0.08935964852571487], [0.08992829918861389, 0.08938112109899521, 0.0893879234790802, 0.08994884043931961, 0.08995569497346878, 0.08868713676929474, 0.08941515535116196, 0.0899762362241745, 0.10389353334903717, 0.09007637202739716, 0.08934976905584335], [0.09102295339107513, 0.09109409153461456, 0.09109319746494293, 0.09102029353380203, 0.091019406914711, 0.09118501096963882, 0.0910896509885788, 0.0910167470574379, 0.08935664594173431, 0.09100379049777985, 0.09109817445278168], [0.09041833877563477, 0.09013111889362335, 0.09013470262289047, 0.09042911231517792, 0.09043270349502563, 0.08976561576128006, 0.09014900773763657, 0.09044346958398819, 0.09748527407646179, 0.09049592912197113, 0.09011463820934296], [0.08990894258022308, 0.08935199677944183, 0.08935891836881638, 0.08992985635995865, 0.08993683010339737, 0.08864569664001465, 0.08938663452863693, 0.08995775133371353, 0.10414356738328934, 0.09005968272686005, 0.08932008594274521], [0.06406660377979279, 0.05938221886754036, 0.059438493102788925, 0.06424892693758011, 0.06430982053279877, 0.05389423668384552, 0.05966414883732796, 0.0644928365945816, 0.38598766922950745, 0.0653914362192154, 0.05912363529205322], [0.0898139700293541, 0.08920949697494507, 0.08921701461076736, 0.08983667194843292, 0.0898442417383194, 0.08844341337680817, 0.08924708515405655, 0.08986695110797882, 0.10536865144968033, 0.08997761458158493, 0.08917488157749176], [0.09047522395849228, 0.09021980315446854, 0.09022298455238342, 0.09048479795455933, 0.09048798680305481, 0.08989464491605759, 0.09023571759462357, 0.09049756824970245, 0.09673192352056503, 0.0905442014336586, 0.09020514786243439]], [[0.09230182319879532, 0.09129025042057037, 0.09052817523479462, 0.0905376449227333, 0.09131889790296555, 0.0913284495472908, 0.09056605398654938, 0.09057553112506866, 0.09135711193084717, 0.09059447795152664, 0.08960162103176117], [0.09165368229150772, 0.09111383557319641, 0.09070530533790588, 0.09071038663387299, 0.09112916141748428, 0.09113427251577377, 0.09072564542293549, 0.09073073416948318, 0.09114959836006165, 0.09074090421199799, 0.09020643681287766], [0.09116297960281372, 0.09097915887832642, 0.09083957225084305, 0.09084130823612213, 0.09098438173532486, 0.09098612517118454, 0.09084653109312057, 0.09084826707839966, 0.09099135547876358, 0.09085174649953842, 0.09066855162382126], [0.0911690890789032, 0.09098083525896072, 0.09083788841962814, 0.0908396765589714, 0.09098619222640991, 0.09098797291517258, 0.0908450186252594, 0.09084680676460266, 0.09099333733320236, 0.09085036814212799, 0.09066277742385864], [0.09167209267616272, 0.09111887216567993, 0.09070027619600296, 0.09070548415184021, 0.09113457798957825, 0.09113981574773788, 0.09072111546993256, 0.0907263308763504, 0.0911555215716362, 0.0907367542386055, 0.09018918126821518], [0.09167823195457458, 0.09112054854631424, 0.09069859981536865, 0.09070385247468948, 0.0911363810300827, 0.09114166349172592, 0.09071961045265198, 0.09072486311197281, 0.09115749597549438, 0.09073536843061447, 0.09018342941999435], [0.09118741750717163, 0.09098587930202484, 0.09083287417888641, 0.09083478152751923, 0.09099161624908447, 0.09099353104829788, 0.09084050357341766, 0.09084241092205048, 0.09099925309419632, 0.0908462256193161, 0.0906454473733902], [0.0911935344338417, 0.09098757058382034, 0.0908312052488327, 0.0908331573009491, 0.09099342674016953, 0.09099537879228592, 0.09083900600671768, 0.09084095060825348, 0.0910012423992157, 0.09084485471248627, 0.09063968062400818], [0.09169663488864899, 0.09112557768821716, 0.09069356322288513, 0.09069893509149551, 0.09114179015159607, 0.09114719182252884, 0.09071507304906845, 0.09072045236825943, 0.09116340428590775, 0.09073120355606079, 0.09016615897417068], [0.09120576083660126, 0.09099093824625015, 0.09082785993814468, 0.09082989394664764, 0.09099704772233963, 0.09099908173084259, 0.09083599597215652, 0.09083802998065948, 0.09100519120693207, 0.0908420979976654, 0.09062813222408295], [0.09056352078914642, 0.09081330895423889, 0.09100377559661865, 0.09100139886140823, 0.09080617874860764, 0.09080380946397781, 0.09099426120519638, 0.09099187701940536, 0.09079669415950775, 0.09098713099956512, 0.09123807400465012]], [[0.09064751118421555, 0.08743281662464142, 0.08744359761476517, 0.08949968218803406, 0.09069222211837769, 0.08863057941198349, 0.08748673647642136, 0.08954383432865143, 0.11154983192682266, 0.0885365903377533, 0.0885365903377533], [0.09091181308031082, 0.09122087806463242, 0.09121982008218765, 0.09102077037096024, 0.09090759605169296, 0.09110429137945175, 0.0912155956029892, 0.09101654589176178, 0.08915594220161438, 0.09111338108778, 0.09111338108778], [0.09091176837682724, 0.09120853245258331, 0.09120751917362213, 0.09101638942956924, 0.09090772271156311, 0.09109658747911453, 0.09120345860719681, 0.09101234376430511, 0.08922502398490906, 0.09110531955957413, 0.09110531955957413], [0.090800940990448, 0.08881033211946487, 0.0888170525431633, 0.09009336680173874, 0.09082843363285065, 0.08955526351928711, 0.0888439416885376, 0.09012063592672348, 0.10313617438077927, 0.08949694782495499, 0.08949694782495499], [0.09064017981290817, 0.0873785987496376, 0.08738952875137329, 0.08947540819644928, 0.09068555384874344, 0.08859362453222275, 0.08743327856063843, 0.08952020853757858, 0.1118871346116066, 0.08849827200174332, 0.08849827200174332], [0.09087306261062622, 0.0898347944021225, 0.08983831852674484, 0.09050527215003967, 0.09088732302188873, 0.09022463858127594, 0.08985241502523422, 0.09051947295665741, 0.0970764011144638, 0.09019417315721512, 0.09019417315721512], [0.09091154485940933, 0.09115912020206451, 0.09115827083587646, 0.09099884331226349, 0.09090816974639893, 0.09106574952602386, 0.09115488827228546, 0.09099546074867249, 0.08950184285640717, 0.09107302874326706, 0.09107302874326706], [0.09079626947641373, 0.08875786513090134, 0.0887647420167923, 0.09007157385349274, 0.0908244252204895, 0.08952055126428604, 0.08879227191209793, 0.0900995060801506, 0.10345108062028885, 0.0894608423113823, 0.0894608423113823], [0.07570958137512207, 0.058195099234580994, 0.0582473985850811, 0.06899603456258774, 0.07598210871219635, 0.06426049023866653, 0.05845707282423973, 0.0692443922162056, 0.34337666630744934, 0.06376555562019348, 0.06376555562019348], [0.09087862819433212, 0.08994463831186295, 0.08994781225919724, 0.09054789692163467, 0.09089144319295883, 0.0902954563498497, 0.0899605005979538, 0.0905606746673584, 0.09643689543008804, 0.09026804566383362, 0.09026804566383362], [0.09087862819433212, 0.08994463831186295, 0.08994781225919724, 0.09054789692163467, 0.09089144319295883, 0.0902954563498497, 0.0899605005979538, 0.0905606746673584, 0.09643689543008804, 0.09026804566383362, 0.09026804566383362]]]}, "num_training_step_calls_per_iteration": 1, "evaluation": {"env_runners": {"module_to_env_connector": {"timers": {"connectors": {"tensor_to_numpy": 1.5716065707965477e-05, "un_batch_to_individual_items": 6.644718767824898e-06, "get_actions": 3.8477409812055626e-05, "listify_data_for_vector_env": 1.0552845551596564e-05, "normalize_and_clip_actions": 8.190018725829782e-06, "remove_single_ts_time_rank_from_batch": 1.2014573877988452e-05}}, "connector_pipeline_timer": 0.00011830640338183862}, "episode_len_min": 20, "num_env_steps_sampled": 400, "weights_seq_no": 9.0, "episode_len_mean": 20.0, "env_to_module_sum_episodes_length_out": 10.368238394574323, "episode_len_max": 20, "env_to_module_connector": {"timers": {"connectors": {"batch_individual_items": 1.2716756515026728e-05, "add_observations_from_episodes_to_batch": 2.9107940299878958e-06, "add_states_from_episodes_to_batch": 2.845741307663048e-06, "add_time_dim_to_batch_and_zero_pad": 7.43281492805578e-06, "numpy_to_tensor": 1.226251124009662e-05}}, "connector_pipeline_timer": 6.08494605967894e-05}, "env_to_module_sum_episodes_length_in": 10.368238394574323, "num_episodes_lifetime": 180, "episode_duration_sec_mean": 0.006050462949788198, "episode_return_max": 12.5, "rlmodule_inference_timer": 3.2513083144125135e-05, "num_agent_steps_sampled": {"default_agent": 400}, "num_module_steps_sampled_lifetime": {"default_policy": 3600}, "num_agent_steps_sampled_lifetime": {"default_agent": 3600}, "num_module_steps_sampled": {"default_policy": 400}, "sample": 0.1319717153414157, "episode_return_mean": -0.6, "env_step_timer": 1.479181542342309e-05, "agent_episode_returns_mean": {"default_agent": -0.6}, "num_episodes": 20, "module_episode_returns_mean": {"default_policy": -0.6}, "episode_return_min": -12.5, "num_env_steps_sampled_lifetime": 45400, "env_reset_timer": 0.0005722036933505966, "time_between_sampling": 12.460417590164178}, "num_healthy_workers": 1, "actor_manager_num_outstanding_async_reqs": 0, "num_remote_worker_restarts": 0}, "num_env_steps_sampled_lifetime": -4312500.0, "fault_tolerance": {"num_healthy_workers": 0, "num_remote_worker_restarts": 0}, "env_runner_group": {"actor_manager_num_outstanding_async_reqs": 0}, "done": false, "training_iteration": 9, "trial_id": "ae8a2_00000", "date": "2025-08-11_18-24-12", "timestamp": 1754929452, "time_this_iter_s": 10.262205123901367, "time_total_s": 105.84945964813232, "pid": 10870, "hostname": "Mac", "node_ip": "127.0.0.1", "config": {"exploration_config": {}, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 2, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "env": "Umbrella", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": false, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 0, "create_local_env_runner": true, "num_envs_per_env_runner": 1, "gym_env_vectorize_mode": "SYNC", "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "episodes_to_numpy": true, "max_requests_in_flight_per_env_runner": 1, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "merge_env_runner_states": "training_only", "broadcast_env_runner_states": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "complete_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "sampler_perf_stats_ema_coef": null, "_is_online": true, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": "auto", "num_aggregator_actors_per_learner": 0, "max_requests_in_flight_per_aggregator_actor": 3, "local_gpu_idx": 0, "max_requests_in_flight_per_learner": 3, "gamma": 1, "lr": 0.0002715581955, "grad_clip": 0.5, "grad_clip_by": "global_norm", "_train_batch_size_per_learner": 5000, "train_batch_size": 4000, "num_epochs": 1, "minibatch_size": 1000, "shuffle_batch_per_epoch": true, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "log_std_clip_param": 20.0, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "_disable_preprocessor_api": false, "_disable_action_flattening": false}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {"intrinsic_reward_coeff": 0.2795015916508}, "optimizer": {}, "_learner_class": "<class 'source.intrinsic_attention_ppo.learners.IntrinsicAttentionMetaLearner.IntrinsicAttentionMetaLearner'>", "callbacks_on_algorithm_init": null, "callbacks_on_env_runners_recreated": null, "callbacks_on_offline_eval_runners_recreated": null, "callbacks_on_checkpoint_loaded": null, "callbacks_on_environment_created": null, "callbacks_on_episode_created": null, "callbacks_on_episode_start": null, "callbacks_on_episode_step": null, "callbacks_on_episode_end": null, "callbacks_on_evaluate_start": null, "callbacks_on_evaluate_end": null, "callbacks_on_evaluate_offline_start": null, "callbacks_on_evaluate_offline_end": null, "callbacks_on_sample_end": null, "callbacks_on_train_result": null, "explore": true, "enable_rl_module_and_learner": true, "enable_env_runner_and_connector_v2": true, "_prior_exploration_config": {"type": "StochasticSampling"}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x38844d8a0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "offline_data_class": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_read_batch_size": null, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "materialize_data": false, "materialize_mapped_data": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "ignore_final_observation": false, "prelearner_class": null, "prelearner_buffer_class": null, "prelearner_buffer_kwargs": {}, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_remaining_data": false, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": 1, "evaluation_duration": 20, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_auto_duration_min_env_steps_per_sample": 100, "evaluation_auto_duration_max_env_steps_per_sample": 2000, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 1, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "offline_evaluation_interval": null, "num_offline_eval_runners": 0, "offline_loss_for_module_fn": null, "offline_evaluation_duration": 1, "offline_evaluation_parallel_to_training": false, "offline_evaluation_timeout_s": 120.0, "num_cpus_per_offline_eval_runner": 1, "num_gpus_per_offline_eval_runner": 0, "custom_resources_per_offline_eval_runner": {}, "restart_failed_offline_eval_runners": true, "ignore_offline_eval_runner_failures": false, "max_num_offline_eval_runner_restarts": 1000, "offline_eval_runner_restore_timeout_s": 1800.0, "max_requests_in_flight_per_offline_eval_runner": 1, "validate_offline_eval_runners_after_construction": true, "offline_eval_runner_health_probe_timeout_s": 30.0, "offline_eval_rl_module_inference_only": false, "broadcast_offline_eval_runner_states": false, "offline_eval_batch_size_per_runner": 256, "dataset_num_iters_per_eval_runner": 1, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "log_gradients": false, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 1, "restart_failed_env_runners": true, "ignore_env_runner_failures": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30.0, "env_runner_restore_timeout_s": 1800.0, "_model_config": {}, "_rl_module_spec": "MultiRLModuleSpec(multi_rl_module_class=<class 'ray.rllib.core.rl_module.multi_rl_module.MultiRLModule'>, observation_space=None, action_space=None, inference_only=False, model_config=None, rl_module_specs={'default_policy': RLModuleSpec(module_class=<class 'source.intrinsic_attention_ppo.rl_modules.DifferentiablePPOModule.DifferentiablePPOModule'>, observation_space=None, action_space=None, inference_only=False, learner_only=False, model_config={'vf_share_layers': True, 'embedding_dim': 62, 'max_seq_len': 11, 'policy_head_hidden_sizes': [32], 'value_head_hidden_sizes': [101], 'embedding_hidden_sizes': [121]}, catalog_class=None, load_state_path=None, model_config_dict=None), 'intrinsic_reward_module': RLModuleSpec(module_class=<class 'source.intrinsic_attention_ppo.rl_modules.IntrinsicAttentionModule.IntrinsicAttentionModule'>, observation_space=None, action_space=None, inference_only=False, learner_only=True, model_config={'intrinsic_reward_network': {'encoder_hidden_sizes': [], 'encoding_dim': 1, 'num_heads': 1, 'head_hidden_sizes': None, 'layers': [{'type': 'attention'}]}, 'extrinsic_value_hidden_layers': [127, 60], 'vf_share_layers': True, 'max_seq_len': 11}, catalog_class=None, load_state_path=None, model_config_dict=None)}, load_state_path=None, modules_to_load=None, module_specs={'default_policy': RLModuleSpec(module_class=<class 'source.intrinsic_attention_ppo.rl_modules.DifferentiablePPOModule.DifferentiablePPOModule'>, observation_space=None, action_space=None, inference_only=False, learner_only=False, model_config={'vf_share_layers': True, 'embedding_dim': 62, 'max_seq_len': 11, 'policy_head_hidden_sizes': [32], 'value_head_hidden_sizes': [101], 'embedding_hidden_sizes': [121]}, catalog_class=None, load_state_path=None, model_config_dict=None), 'intrinsic_reward_module': RLModuleSpec(module_class=<class 'source.intrinsic_attention_ppo.rl_modules.IntrinsicAttentionModule.IntrinsicAttentionModule'>, observation_space=None, action_space=None, inference_only=False, learner_only=True, model_config={'intrinsic_reward_network': {'encoder_hidden_sizes': [], 'encoding_dim': 1, 'num_heads': 1, 'head_hidden_sizes': None, 'layers': [{'type': 'attention'}]}, 'extrinsic_value_hidden_layers': [127, 60], 'vf_share_layers': True, 'max_seq_len': 11}, catalog_class=None, load_state_path=None, model_config_dict=None)})", "algorithm_config_overrides_per_module": {"intrinsic_reward_module": {"lr": 0.0002715581955}}, "_per_module_overrides": {}, "_validate_config": true, "_use_msgpack_checkpoints": false, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "env_task_fn": -1, "enable_connectors": -1, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.161583927863, "kl_target": 0.0201019014258, "vf_loss_coeff": 0.7790510010087, "entropy_coeff": 0.0015431216992, "clip_param": 0.2459212356676, "vf_clip_param": 0.3769744131561, "entropy_coeff_schedule": null, "lr_schedule": null, "sgd_minibatch_size": -1, "vf_share_layers": -1, "differentiable_learner_configs": ["DifferentiableLearnerConfig(learner_class=<class 'source.intrinsic_attention_ppo.learners.IntrinsicAttentionPPOLearner.IntrinsicAttentionPPOLearner'>, learner_connector=None, add_default_connectors_to_learner_pipeline=True, is_multi_agent=False, policies_to_update=['default_policy'], lr=0.0060984166342, num_total_minibatches=0, num_epochs=1, minibatch_size=1000, shuffle_batch_per_epoch=True)"], "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9485408017724, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.callbacks.callbacks.RLlibCallback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 105.84945964813232, "iterations_since_restore": 9, "perf": {"cpu_util_percent": 46.86666666666667, "ram_util_percent": 79.37333333333335}}
{"timers": {"training_iteration": 12.522185945327596, "restore_env_runners": 1.2315325443361372e-05, "training_step": 12.521987497632496, "env_runner_sampling_timer": 2.8517764072929754, "learner_update_timer": 9.452804648898276, "synch_weights": 0.0016445626450858873, "restore_eval_env_runners": 5.2876039235010795e-05, "evaluation_iteration": 0.1439112084804631, "synch_eval_env_connectors": 0.00022683602887277042, "synch_env_connectors": 6.071881306051441e-06}, "env_runners": {"module_to_env_connector": {"connector_pipeline_timer": 0.00012120181705599051, "timers": {"connectors": {"remove_single_ts_time_rank_from_batch": 1.2131326836124247e-05, "un_batch_to_individual_items": 6.683030815138008e-06, "get_actions": 4.067141714333708e-05, "tensor_to_numpy": 1.54996654822693e-05, "listify_data_for_vector_env": 1.0801486834631209e-05, "normalize_and_clip_actions": 8.130516446637603e-06}}}, "rlmodule_inference_timer": 3.283507218107638e-05, "sample": 0.005778188883439684, "weights_seq_no": 9.0, "num_agent_steps_sampled": {"default_agent": 5000.0}, "episode_len_mean": 20.0, "episode_len_max": 20, "env_to_module_connector": {"timers": {"connectors": {"batch_individual_items": 1.2888065884275164e-05, "add_states_from_episodes_to_batch": 2.780204381221341e-06, "numpy_to_tensor": 1.3083599934632851e-05, "add_observations_from_episodes_to_batch": 2.893929995836965e-06, "add_time_dim_to_batch_and_zero_pad": 7.096343791044747e-06}}, "connector_pipeline_timer": 6.15306034837104e-05}, "env_to_module_sum_episodes_length_out": 10.36823839457432, "num_agent_steps_sampled_lifetime": {"default_agent": -4930000.0}, "episode_return_mean": 2.2199999999999998, "num_module_steps_sampled_lifetime": {"default_policy": -4930000.0}, "num_episodes": 250.0, "time_between_sampling": 0.03545842229661301, "num_env_steps_sampled_lifetime": -4930000.0, "episode_return_min": -10.5, "env_reset_timer": 4.4852232063236456e-05, "env_to_module_sum_episodes_length_in": 10.36823839457432, "num_episodes_lifetime": -246500.0, "agent_episode_returns_mean": {"default_agent": 2.2199999999999998}, "episode_len_min": 20, "episode_duration_sec_mean": 0.005449043164029718, "env_step_timer": 1.4538079758101059e-05, "episode_return_max": 9.5, "num_module_steps_sampled": {"default_policy": 5000.0}, "module_episode_returns_mean": {"default_policy": 2.2199999999999998}, "num_env_steps_sampled": 5000.0, "num_env_steps_sampled_lifetime_throughput": 3151.937910017879}, "__all_modules__": {"learner_connector_sum_episodes_length_in": 5000.0, "learner_connector": {"connector_pipeline_timer": 0.1612087345225505, "timers": {"connectors": {"add_one_ts_to_episodes_and_truncate": 0.009351936979457343, "add_observations_from_episodes_to_batch": 0.0016246308961162127, "add_columns_from_episodes_to_train_batch": 0.049548683275000706, "add_time_dim_to_batch_and_zero_pad": 0.08513646312656847, "add_states_from_episodes_to_batch": 0.00882194655481492, "batch_individual_items": 0.00638100632030299, "numpy_to_tensor": 9.595995787797274e-05}}}, "learner_connector_sum_episodes_length_out": 5250.0}, "learners": {"default_policy": {"curr_entropy_coeff": 0.0015431216992, "curr_kl_coeff": 0.00015779680688865483, "num_module_steps_trained_lifetime": 59850, "entropy": 0.6854598522186279, "num_module_steps_trained": 5985, "diff_num_grad_updates_vs_sampler_policy": 1.0, "vf_loss": 0.358325719833374, "vf_loss_unclipped": 43.239166259765625, "policy_loss": -2.127100742654875e-05, "use_intrinsic_rewards": 0.0, "total_loss": 0.2780749797821045, "vf_explained_var": -0.0032273530960083008, "mean_kl_loss": 1.950688101715059e-06, "weights_seq_no": 10.0, "num_trainable_parameters": 16595, "module_train_batch_size_mean": 997.772440523815, "num_module_steps_trained_lifetime_throughput": 733.7559748182359}, "intrinsic_reward_module": {"num_module_steps_trained_lifetime": 59850, "num_module_steps_trained": 5985, "diff_num_grad_updates_vs_sampler_policy": 1.0, "total_loss": 0.0, "gradients_default_optimizer_global_norm": 0.0, "module_train_batch_size_mean": 997.772440523815, "default_optimizer_learning_rate": 0.0002715581955, "weights_seq_no": 10.0, "num_trainable_parameters": 8266, "curr_entropy_coeff": 0.0015431216992, "num_module_steps_trained_lifetime_throughput": 733.7655822007216}, "differentiable_learners": {"intrinsic_attention_ppo_learner": {"default_policy": {"weights_seq_no": 60.0, "num_module_steps_trained": 35910, "num_module_steps_trained_lifetime": 359100, "entropy": 0.6854645609855652, "diff_num_grad_updates_vs_sampler_policy": 51.0, "vf_loss": 0.3584745228290558, "vf_loss_unclipped": 43.2969970703125, "total_loss": 0.2781929075717926, "mean_kl_loss": 2.007687953664572e-06, "policy_loss": -1.9619161321315914e-05, "use_intrinsic_rewards": 1.0, "module_train_batch_size_mean": 997.5109713823833, "vf_explained_var": -0.00165557861328125}, "__all_modules__": {"num_env_steps_trained": 198000, "num_module_steps_trained": 71820, "num_module_steps_trained_lifetime": 718200, "num_env_steps_trained_lifetime": 1980000, "num_env_steps_trained_lifetime_throughput": 35526.010141609055}, "intrinsic_reward_module": {"weights_seq_no": 60.0, "num_module_steps_trained_lifetime": 359100, "num_module_steps_trained": 35910, "diff_num_grad_updates_vs_sampler_policy": 51.0, "total_loss": 0.0, "module_train_batch_size_mean": 997.5109713823833}}}, "__all_modules__": {"num_env_steps_trained_lifetime": 330000, "num_non_trainable_parameters": 0, "num_trainable_parameters": 24861, "num_env_steps_trained": 33000, "num_module_steps_trained": 11970, "num_module_steps_trained_lifetime": 119700, "num_env_steps_trained_lifetime_throughput": 4047.2463010896045, "num_module_steps_trained_throughput": 23468154.114453465, "num_module_steps_trained_lifetime_throughput": 12704121.000568792}, "IntrinsicAttentionMask": [[[0.09229633212089539, 0.09128482639789581, 0.08952135592699051, 0.09053225815296173, 0.09233495593070984, 0.09234461188316345, 0.0905606672167778, 0.08956818282604218, 0.09237358719110489, 0.08958691358566284, 0.08959628641605377], [0.09165212512016296, 0.09111228585243225, 0.09016445279121399, 0.09070884436368942, 0.09167267382144928, 0.09167781472206116, 0.09072410315275192, 0.09018972516059875, 0.09169323742389679, 0.09019984304904938, 0.09020490199327469], [0.09051446616649628, 0.09079934656620026, 0.09130584448575974, 0.09101394563913345, 0.09050367027521133, 0.09050096571445465, 0.09100580215454102, 0.09129222482442856, 0.0904928669333458, 0.0912867859005928, 0.09128406643867493], [0.09116889536380768, 0.0909806489944458, 0.0906483605504036, 0.09083948284387589, 0.09117605537176132, 0.09117784351110458, 0.09084483236074448, 0.09065724909305573, 0.09118320792913437, 0.09066080302000046, 0.09066258370876312], [0.09232081472873688, 0.09129131585359573, 0.08949697017669678, 0.09052550047636032, 0.09236011654138565, 0.09236995130777359, 0.09055440872907639, 0.08954460918903351, 0.09239944815635681, 0.08956366777420044, 0.0895731970667839], [0.09232693910598755, 0.09129294753074646, 0.08949088305234909, 0.09052381664514542, 0.09236641973257065, 0.09237629920244217, 0.09055285155773163, 0.08953872323036194, 0.09240592271089554, 0.08955786377191544, 0.08956743776798248], [0.09118720144033432, 0.09098567068576813, 0.09063000231981277, 0.09083456546068192, 0.09119486063718796, 0.09119677543640137, 0.09084028750658035, 0.09063951671123505, 0.0912025198340416, 0.09064332395792007, 0.09064523130655289], [0.09054490923881531, 0.09080785512924194, 0.09127519279718399, 0.09100588411092758, 0.09053494036197662, 0.09053245186805725, 0.09099837392568588, 0.09126263856887817, 0.09052497148513794, 0.09125760942697525, 0.09125509858131409], [0.09234528988599777, 0.09129779785871506, 0.08947257697582245, 0.09051872789859772, 0.09238529205322266, 0.09239529818296432, 0.09054813534021378, 0.08952102810144424, 0.09242530912160873, 0.08954041451215744, 0.08955011516809464], [0.09055709838867188, 0.09081126749515533, 0.09126294404268265, 0.09100267291069031, 0.09054745733737946, 0.09054505825042725, 0.0909954085946083, 0.09125080704689026, 0.09053782373666763, 0.09124594926834106, 0.09124352782964706], [0.09056318551301956, 0.09081296622753143, 0.09125681221485138, 0.09100105613470078, 0.09055371582508087, 0.09055134654045105, 0.09099391847848892, 0.0912448838353157, 0.09054424613714218, 0.09124011546373367, 0.09123773127794266]], [[0.09212277084589005, 0.09167587012052536, 0.09168142825365067, 0.09213954210281372, 0.0927416980266571, 0.09110826998949051, 0.09111379086971283, 0.09216190874576569, 0.0817895382642746, 0.09165024757385254, 0.09181500226259232], [0.09139430522918701, 0.09122040122747421, 0.09122256934642792, 0.09140081703662872, 0.09163429588079453, 0.09099879115819931, 0.09100094437599182, 0.09140950441360474, 0.08723344653844833, 0.09121041744947433, 0.09127459675073624], [0.09140356630086899, 0.09122627973556519, 0.09122849255800247, 0.09141020476818085, 0.09164824336767197, 0.09100036323070526, 0.09100256860256195, 0.09141907095909119, 0.087163545191288, 0.09121610224246979, 0.09128152579069138], [0.09214945137500763, 0.09169226884841919, 0.09169795364141464, 0.09216660261154175, 0.09278269857168198, 0.0911116749048233, 0.09111732989549637, 0.0921894833445549, 0.0815919041633606, 0.09166605770587921, 0.09183458983898163], [0.09307767450809479, 0.09224959462881088, 0.09225987643003464, 0.09310881793498993, 0.09423008561134338, 0.09120272099971771, 0.09121288359165192, 0.09315034747123718, 0.07479875534772873, 0.09220222383737564, 0.0925070270895958], [0.09041896462440491, 0.09058854728937149, 0.09058642387390137, 0.09041261672973633, 0.0901859775185585, 0.09080558270215988, 0.09080345928668976, 0.09040416777133942, 0.09466034173965454, 0.09059830009937286, 0.09053562581539154], [0.09042873233556747, 0.09059499204158783, 0.09059291332960129, 0.09042252600193024, 0.09020031243562698, 0.09080776572227478, 0.09080568701028824, 0.09041423350572586, 0.0945851281285286, 0.09060455858707428, 0.09054311364889145], [0.09218496084213257, 0.0917140543460846, 0.09171991795301437, 0.09220262616872787, 0.09283732622861862, 0.09111614525318146, 0.09112197160720825, 0.09222619980573654, 0.08132905513048172, 0.09168706089258194, 0.09186064451932907], [0.06365087628364563, 0.06809661537408829, 0.06803928315639496, 0.06349023431539536, 0.05800032988190651, 0.07422887533903122, 0.07416638731956482, 0.06327667087316513, 0.332011342048645, 0.06836138665676117, 0.06667792797088623], [0.09135150164365768, 0.09119318425655365, 0.09119515866041183, 0.09135743230581284, 0.0915699377655983, 0.09099139273166656, 0.09099336713552475, 0.09136533737182617, 0.08755607157945633, 0.0911840945482254, 0.09124252200126648], [0.09162470698356628, 0.09136603772640228, 0.09136926382780075, 0.09163440018892288, 0.09198207408189774, 0.09103675186634064, 0.09103995561599731, 0.09164733439683914, 0.08550164103507996, 0.09135119616985321, 0.09144662320613861]], [[0.09220396727323532, 0.09119346737861633, 0.09043219685554504, 0.09044165909290314, 0.09224254637956619, 0.09225219488143921, 0.08946918696165085, 0.08947853744029999, 0.09228114038705826, 0.08949726074934006, 0.09050789475440979], [0.09160271286964417, 0.09106316417455673, 0.09065485745668411, 0.09065993875265121, 0.09162325412034988, 0.09162838757038116, 0.09013605117797852, 0.09014110267162323, 0.0916438028216362, 0.09015121310949326, 0.09069552272558212], [0.09114594012498856, 0.09096214920282364, 0.09082259237766266, 0.09082432836294174, 0.09115292131900787, 0.09115467220544815, 0.09064465761184692, 0.09064639359712601, 0.09115990996360779, 0.09064986556768417, 0.09083651006221771], [0.0911516472697258, 0.09096343070268631, 0.09082051366567612, 0.09082229435443878, 0.09115879982709885, 0.09116058796644211, 0.09063831716775894, 0.0906400978565216, 0.0911659523844719, 0.09064365178346634, 0.09083476662635803], [0.09222680330276489, 0.09119834750890732, 0.09042368829250336, 0.09043331444263458, 0.09226606786251068, 0.09227588772773743, 0.08944390714168549, 0.08945342153310776, 0.09230535477399826, 0.0894724652171135, 0.09050071239471436], [0.09223251789808273, 0.09119958430528641, 0.09042157232761383, 0.09043123573064804, 0.09227196127176285, 0.09228182584047318, 0.08943759649991989, 0.08944714814424515, 0.09231141954660416, 0.08946627378463745, 0.0904989242553711], [0.09056338667869568, 0.09083079546689987, 0.09103474020957947, 0.09103219211101532, 0.09055325388908386, 0.09055072069168091, 0.09129587560892105, 0.0912933200597763, 0.09054312109947205, 0.09128821641206741, 0.09101437032222748], [0.09056907892227173, 0.09083209931850433, 0.09103269129991531, 0.09103018045425415, 0.09055911004543304, 0.09055662155151367, 0.09128951281309128, 0.09128700196743011, 0.09054914861917496, 0.09128198027610779, 0.09101264923810959], [0.09224964678287506, 0.0912032425403595, 0.09041519463062286, 0.09042497724294662, 0.09228961169719696, 0.09229960292577744, 0.08941863477230072, 0.08942831307649612, 0.09232958406209946, 0.08944767713546753, 0.09049353748559952], [0.09058044850826263, 0.09083468466997147, 0.09102855622768402, 0.09102613478899002, 0.09057081490755081, 0.09056840091943741, 0.09127676486968994, 0.09127433598041534, 0.09056117385625839, 0.09126947820186615, 0.09100919216871262], [0.09119150787591934, 0.09097230434417725, 0.09080591052770615, 0.09080798178911209, 0.0911998301744461, 0.09120191633701324, 0.0905938372015953, 0.09059590846300125, 0.09120816737413406, 0.09060005098581314, 0.0908225029706955]], [[0.08988891541957855, 0.08935517072677612, 0.08865834772586823, 0.09062234312295914, 0.09062908589839935, 0.08867811411619186, 0.08938837796449661, 0.08993568271398544, 0.10348601639270782, 0.09003333747386932, 0.08932459354400635], [0.09041519463062286, 0.09014461189508438, 0.08979014307260513, 0.09078571200370789, 0.09078910201787949, 0.08980022370815277, 0.09016147255897522, 0.09043886512517929, 0.09705730527639389, 0.09048827737569809, 0.09012908488512039], [0.09104867279529572, 0.09112991392612457, 0.09123682230710983, 0.09093794226646423, 0.09093692898750305, 0.09123377501964569, 0.09112484753131866, 0.09104157984256744, 0.0891481339931488, 0.09102679044008255, 0.09113458544015884], [0.08910578489303589, 0.08821985870599747, 0.08706863224506378, 0.09032898396253586, 0.09034024178981781, 0.08710120618343353, 0.08827486634254456, 0.08918357640504837, 0.11286158859729767, 0.08934612572193146, 0.08816920965909958], [0.08909826725721359, 0.08820915967226028, 0.08705384284257889, 0.09032589942216873, 0.09033720940351486, 0.08708653599023819, 0.08826436847448349, 0.08917633444070816, 0.11295062303543091, 0.0893394723534584, 0.08815832436084747], [0.0910315290093422, 0.09110266715288162, 0.09119626134634018, 0.09093455225229263, 0.0909336656332016, 0.09119359403848648, 0.09109821915626526, 0.09102531522512436, 0.08936507254838943, 0.09101235866546631, 0.09110675007104874], [0.09038350731134415, 0.09009639173746109, 0.08972034603357315, 0.09077674895524979, 0.0907803475856781, 0.08973103016614914, 0.0901142805814743, 0.09040863066911697, 0.0974477156996727, 0.09046106785535812, 0.09007991850376129], [0.0898410752415657, 0.08928454667329788, 0.08855818957090378, 0.09060604870319366, 0.09061308205127716, 0.08857878297567368, 0.08931916207075119, 0.08988984674215317, 0.1040649339556694, 0.08999169617891312, 0.08925266563892365], [0.06356251984834671, 0.05891501531004906, 0.05331847071647644, 0.07050096243619919, 0.0705677792429924, 0.05347020924091339, 0.05919472500681877, 0.0639854148030281, 0.38294944167137146, 0.06487693637609482, 0.05865846201777458], [0.08974024653434753, 0.0891362726688385, 0.08834848552942276, 0.09057096391916275, 0.090578593313694, 0.08837081491947174, 0.089173823595047, 0.08979318290948868, 0.10528214275836945, 0.08990376442670822, 0.08910168707370758], [0.09044425934553146, 0.09018892794847488, 0.08985436707735062, 0.09079382568597794, 0.09079702943563461, 0.08986388146877289, 0.09020483493804932, 0.09046659618616104, 0.0966988131403923, 0.090513214468956, 0.09017427265644073]], [[0.09096983820199966, 0.09166532754898071, 0.09018454700708389, 0.09018956869840622, 0.0916806235909462, 0.09114503860473633, 0.09073971956968307, 0.09074476361274719, 0.09170101583003998, 0.0902196615934372, 0.09075990319252014], [0.09103461354970932, 0.09252648055553436, 0.08936560153961182, 0.08937621116638184, 0.09255943447351456, 0.09140920639038086, 0.09054382145404816, 0.09055456519126892, 0.09260337799787521, 0.08943987637758255, 0.09058681130409241], [0.09089076519012451, 0.09068940579891205, 0.09112052619457245, 0.09111905097961426, 0.09068500250577927, 0.09083985537290573, 0.09095782786607742, 0.09095636010169983, 0.0906791239976883, 0.09111019968986511, 0.09095193445682526], [0.0908912867307663, 0.09069564938545227, 0.09111450612545013, 0.09111307561397552, 0.09069136530160904, 0.09084182232618332, 0.0909564420580864, 0.09095501154661179, 0.0906856581568718, 0.09110447764396667, 0.09095072001218796], [0.09103598445653915, 0.09254538267850876, 0.089347705245018, 0.08935843408107758, 0.0925787165760994, 0.09141495823860168, 0.09053948521614075, 0.09055035561323166, 0.09262318909168243, 0.08942282199859619, 0.09058297425508499], [0.09098661690950394, 0.09188254177570343, 0.08997736871242523, 0.08998381346464157, 0.09190226346254349, 0.09121212363243103, 0.09069060534238815, 0.09069709479808807, 0.09192856401205063, 0.09002243727445602, 0.09071656316518784], [0.09094732999801636, 0.09137973934412003, 0.09045758843421936, 0.09046072512865067, 0.0913892313838005, 0.09105637669563293, 0.09080398082733154, 0.09080712497234344, 0.09140188992023468, 0.0904795229434967, 0.09081655740737915], [0.09094781428575516, 0.09138599038124084, 0.09045158326625824, 0.09045475721359253, 0.09139560908079147, 0.09105831384658813, 0.09080256521701813, 0.09080574661493301, 0.09140843898057938, 0.09047380089759827, 0.09081530570983887], [0.0910378098487854, 0.09257058054208755, 0.08932383358478546, 0.08933471888303757, 0.09260444343090057, 0.09142260998487473, 0.09053369611501694, 0.09054473042488098, 0.09264960885047913, 0.08940008282661438, 0.09057784825563431], [0.0908944308757782, 0.0907331109046936, 0.09107841551303864, 0.09107723087072372, 0.09072958678007126, 0.09085365384817123, 0.09094814211130142, 0.09094696491956711, 0.090724878013134, 0.09107014536857605, 0.09094342589378357], [0.09094932675361633, 0.09140479564666748, 0.09043360501527786, 0.0904368981719017, 0.09141480177640915, 0.09106417745351791, 0.09079835563898087, 0.0908016711473465, 0.09142813831567764, 0.09045669436454773, 0.0908116027712822]], [[0.09040872752666473, 0.08720250427722931, 0.08721326291561127, 0.0892639309167862, 0.09045331925153732, 0.08724551647901535, 0.08840801566839218, 0.08930795639753342, 0.11272446811199188, 0.08946893364191055, 0.08830337226390839], [0.09093200415372849, 0.09124113619327545, 0.09124007821083069, 0.09104098379611969, 0.09092778712511063, 0.0912369042634964, 0.09112346917390823, 0.09103675931692123, 0.08906591683626175, 0.0910213515162468, 0.09113361686468124], [0.09093116223812103, 0.09122799336910248, 0.0912269800901413, 0.09103581309318542, 0.0909271165728569, 0.09122393280267715, 0.09111501276493073, 0.0910317599773407, 0.08913851529359818, 0.09101696312427521, 0.0911247581243515], [0.09065978229045868, 0.08867227286100388, 0.08867897838354111, 0.08995331078767776, 0.09068723022937775, 0.08869911730289459, 0.089422807097435, 0.08998054265975952, 0.10380814224481583, 0.09008006751537323, 0.08935781568288803], [0.09039746969938278, 0.08714462071657181, 0.0871555283665657, 0.089235819876194, 0.0904427245259285, 0.0871882513165474, 0.08836745470762253, 0.08928049355745316, 0.11308253556489944, 0.08944382518529892, 0.08826129883527756], [0.09092861413955688, 0.09118852764368057, 0.09118763357400894, 0.09102025628089905, 0.09092506766319275, 0.09118497371673584, 0.09108961373567581, 0.09101670980453491, 0.08935663104057312, 0.09100375324487686, 0.09109813719987869], [0.09080041199922562, 0.08975086361169815, 0.08975443243980408, 0.09042861312627792, 0.09081482887268066, 0.08976511657238007, 0.09014850854873657, 0.0904429703950882, 0.09748473018407822, 0.09049542248249054, 0.09011413902044296], [0.09065145254135132, 0.08861631155014038, 0.08862318098545074, 0.08992791920900345, 0.0906795784831047, 0.08864378929138184, 0.08938471227884293, 0.08995581418275833, 0.10414129495620728, 0.09005773812532425, 0.0893181636929512], [0.07070153951644897, 0.05357158184051514, 0.053622353821992874, 0.06410670280456543, 0.07096994668245316, 0.05377495661377907, 0.05953208729624748, 0.06435007601976395, 0.385131299495697, 0.06524667143821716, 0.05899276211857796], [0.09062015265226364, 0.0884113684296608, 0.08841881155967712, 0.08983439207077026, 0.09065070003271103, 0.0884411633014679, 0.08924482017755508, 0.08986467123031616, 0.10536594688892365, 0.08997533470392227, 0.0891726091504097], [0.09081488102674484, 0.0898815467953682, 0.08988472074270248, 0.0904843881726265, 0.09082769602537155, 0.08989423513412476, 0.09023530781269073, 0.09049715101718903, 0.09673147648572922, 0.09054379165172577, 0.09020473062992096]]]}, "num_training_step_calls_per_iteration": 1, "evaluation": {"env_runners": {"module_to_env_connector": {"timers": {"connectors": {"tensor_to_numpy": 1.8087428350135972e-05, "un_batch_to_individual_items": 7.337271370835151e-06, "get_actions": 4.7598820614292075e-05, "listify_data_for_vector_env": 1.1872695479408373e-05, "normalize_and_clip_actions": 1.0066020079659098e-05, "remove_single_ts_time_rank_from_batch": 1.3686181219446114e-05}}, "connector_pipeline_timer": 0.0001392706967309526}, "episode_len_min": 20, "num_env_steps_sampled": 400, "weights_seq_no": 10.0, "episode_len_mean": 20.0, "env_to_module_sum_episodes_length_out": 10.368238394574323, "episode_len_max": 20, "env_to_module_connector": {"timers": {"connectors": {"batch_individual_items": 1.4083243639359522e-05, "add_observations_from_episodes_to_batch": 3.0619715980776625e-06, "add_states_from_episodes_to_batch": 3.6705065292609625e-06, "add_time_dim_to_batch_and_zero_pad": 7.570937711529188e-06, "numpy_to_tensor": 1.4860598505817438e-05}}, "connector_pipeline_timer": 6.788337042561528e-05}, "env_to_module_sum_episodes_length_in": 10.368238394574323, "num_episodes_lifetime": 200, "episode_duration_sec_mean": 0.005581762134097517, "episode_return_max": 12.5, "rlmodule_inference_timer": 3.8429321308815974e-05, "num_agent_steps_sampled": {"default_agent": 400}, "num_module_steps_sampled_lifetime": {"default_policy": 4000}, "num_agent_steps_sampled_lifetime": {"default_agent": 4000}, "num_module_steps_sampled": {"default_policy": 400}, "sample": 0.13190857443830878, "episode_return_mean": 0.2, "env_step_timer": 1.619780266373261e-05, "agent_episode_returns_mean": {"default_agent": 0.2}, "num_episodes": 20, "module_episode_returns_mean": {"default_policy": 0.2}, "episode_return_min": -12.5, "num_env_steps_sampled_lifetime": 50400, "env_reset_timer": 0.000567337076201875, "time_between_sampling": 12.427702111762645}, "num_healthy_workers": 1, "actor_manager_num_outstanding_async_reqs": 0, "num_remote_worker_restarts": 0}, "num_env_steps_sampled_lifetime": -4930000.0, "fault_tolerance": {"num_healthy_workers": 0, "num_remote_worker_restarts": 0}, "env_runner_group": {"actor_manager_num_outstanding_async_reqs": 0}, "done": false, "training_iteration": 10, "trial_id": "ae8a2_00000", "date": "2025-08-11_18-24-21", "timestamp": 1754929461, "time_this_iter_s": 9.294244050979614, "time_total_s": 115.14370369911194, "pid": 10870, "hostname": "Mac", "node_ip": "127.0.0.1", "config": {"exploration_config": {}, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 2, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "env": "Umbrella", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": false, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 0, "create_local_env_runner": true, "num_envs_per_env_runner": 1, "gym_env_vectorize_mode": "SYNC", "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "episodes_to_numpy": true, "max_requests_in_flight_per_env_runner": 1, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "merge_env_runner_states": "training_only", "broadcast_env_runner_states": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "complete_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "sampler_perf_stats_ema_coef": null, "_is_online": true, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": "auto", "num_aggregator_actors_per_learner": 0, "max_requests_in_flight_per_aggregator_actor": 3, "local_gpu_idx": 0, "max_requests_in_flight_per_learner": 3, "gamma": 1, "lr": 0.0002715581955, "grad_clip": 0.5, "grad_clip_by": "global_norm", "_train_batch_size_per_learner": 5000, "train_batch_size": 4000, "num_epochs": 1, "minibatch_size": 1000, "shuffle_batch_per_epoch": true, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "log_std_clip_param": 20.0, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "_disable_preprocessor_api": false, "_disable_action_flattening": false}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {"intrinsic_reward_coeff": 0.2795015916508}, "optimizer": {}, "_learner_class": "<class 'source.intrinsic_attention_ppo.learners.IntrinsicAttentionMetaLearner.IntrinsicAttentionMetaLearner'>", "callbacks_on_algorithm_init": null, "callbacks_on_env_runners_recreated": null, "callbacks_on_offline_eval_runners_recreated": null, "callbacks_on_checkpoint_loaded": null, "callbacks_on_environment_created": null, "callbacks_on_episode_created": null, "callbacks_on_episode_start": null, "callbacks_on_episode_step": null, "callbacks_on_episode_end": null, "callbacks_on_evaluate_start": null, "callbacks_on_evaluate_end": null, "callbacks_on_evaluate_offline_start": null, "callbacks_on_evaluate_offline_end": null, "callbacks_on_sample_end": null, "callbacks_on_train_result": null, "explore": true, "enable_rl_module_and_learner": true, "enable_env_runner_and_connector_v2": true, "_prior_exploration_config": {"type": "StochasticSampling"}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x38844d8a0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "offline_data_class": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_read_batch_size": null, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "materialize_data": false, "materialize_mapped_data": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "ignore_final_observation": false, "prelearner_class": null, "prelearner_buffer_class": null, "prelearner_buffer_kwargs": {}, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_remaining_data": false, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": 1, "evaluation_duration": 20, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_auto_duration_min_env_steps_per_sample": 100, "evaluation_auto_duration_max_env_steps_per_sample": 2000, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 1, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "offline_evaluation_interval": null, "num_offline_eval_runners": 0, "offline_loss_for_module_fn": null, "offline_evaluation_duration": 1, "offline_evaluation_parallel_to_training": false, "offline_evaluation_timeout_s": 120.0, "num_cpus_per_offline_eval_runner": 1, "num_gpus_per_offline_eval_runner": 0, "custom_resources_per_offline_eval_runner": {}, "restart_failed_offline_eval_runners": true, "ignore_offline_eval_runner_failures": false, "max_num_offline_eval_runner_restarts": 1000, "offline_eval_runner_restore_timeout_s": 1800.0, "max_requests_in_flight_per_offline_eval_runner": 1, "validate_offline_eval_runners_after_construction": true, "offline_eval_runner_health_probe_timeout_s": 30.0, "offline_eval_rl_module_inference_only": false, "broadcast_offline_eval_runner_states": false, "offline_eval_batch_size_per_runner": 256, "dataset_num_iters_per_eval_runner": 1, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "log_gradients": false, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 1, "restart_failed_env_runners": true, "ignore_env_runner_failures": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30.0, "env_runner_restore_timeout_s": 1800.0, "_model_config": {}, "_rl_module_spec": "MultiRLModuleSpec(multi_rl_module_class=<class 'ray.rllib.core.rl_module.multi_rl_module.MultiRLModule'>, observation_space=None, action_space=None, inference_only=False, model_config=None, rl_module_specs={'default_policy': RLModuleSpec(module_class=<class 'source.intrinsic_attention_ppo.rl_modules.DifferentiablePPOModule.DifferentiablePPOModule'>, observation_space=None, action_space=None, inference_only=False, learner_only=False, model_config={'vf_share_layers': True, 'embedding_dim': 62, 'max_seq_len': 11, 'policy_head_hidden_sizes': [32], 'value_head_hidden_sizes': [101], 'embedding_hidden_sizes': [121]}, catalog_class=None, load_state_path=None, model_config_dict=None), 'intrinsic_reward_module': RLModuleSpec(module_class=<class 'source.intrinsic_attention_ppo.rl_modules.IntrinsicAttentionModule.IntrinsicAttentionModule'>, observation_space=None, action_space=None, inference_only=False, learner_only=True, model_config={'intrinsic_reward_network': {'encoder_hidden_sizes': [], 'encoding_dim': 1, 'num_heads': 1, 'head_hidden_sizes': None, 'layers': [{'type': 'attention'}]}, 'extrinsic_value_hidden_layers': [127, 60], 'vf_share_layers': True, 'max_seq_len': 11}, catalog_class=None, load_state_path=None, model_config_dict=None)}, load_state_path=None, modules_to_load=None, module_specs={'default_policy': RLModuleSpec(module_class=<class 'source.intrinsic_attention_ppo.rl_modules.DifferentiablePPOModule.DifferentiablePPOModule'>, observation_space=None, action_space=None, inference_only=False, learner_only=False, model_config={'vf_share_layers': True, 'embedding_dim': 62, 'max_seq_len': 11, 'policy_head_hidden_sizes': [32], 'value_head_hidden_sizes': [101], 'embedding_hidden_sizes': [121]}, catalog_class=None, load_state_path=None, model_config_dict=None), 'intrinsic_reward_module': RLModuleSpec(module_class=<class 'source.intrinsic_attention_ppo.rl_modules.IntrinsicAttentionModule.IntrinsicAttentionModule'>, observation_space=None, action_space=None, inference_only=False, learner_only=True, model_config={'intrinsic_reward_network': {'encoder_hidden_sizes': [], 'encoding_dim': 1, 'num_heads': 1, 'head_hidden_sizes': None, 'layers': [{'type': 'attention'}]}, 'extrinsic_value_hidden_layers': [127, 60], 'vf_share_layers': True, 'max_seq_len': 11}, catalog_class=None, load_state_path=None, model_config_dict=None)})", "algorithm_config_overrides_per_module": {"intrinsic_reward_module": {"lr": 0.0002715581955}}, "_per_module_overrides": {}, "_validate_config": true, "_use_msgpack_checkpoints": false, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "env_task_fn": -1, "enable_connectors": -1, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.161583927863, "kl_target": 0.0201019014258, "vf_loss_coeff": 0.7790510010087, "entropy_coeff": 0.0015431216992, "clip_param": 0.2459212356676, "vf_clip_param": 0.3769744131561, "entropy_coeff_schedule": null, "lr_schedule": null, "sgd_minibatch_size": -1, "vf_share_layers": -1, "differentiable_learner_configs": ["DifferentiableLearnerConfig(learner_class=<class 'source.intrinsic_attention_ppo.learners.IntrinsicAttentionPPOLearner.IntrinsicAttentionPPOLearner'>, learner_connector=None, add_default_connectors_to_learner_pipeline=True, is_multi_agent=False, policies_to_update=['default_policy'], lr=0.0060984166342, num_total_minibatches=0, num_epochs=1, minibatch_size=1000, shuffle_batch_per_epoch=True)"], "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9485408017724, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.callbacks.callbacks.RLlibCallback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 115.14370369911194, "iterations_since_restore": 10, "perf": {"cpu_util_percent": 39.315384615384616, "ram_util_percent": 78.12307692307692}}
{"timers": {"training_iteration": 12.493073030043565, "restore_env_runners": 1.2256342642625201e-05, "training_step": 12.492873704325156, "env_runner_sampling_timer": 2.8388509265599837, "learner_update_timer": 9.436946268249281, "synch_weights": 0.001644527017860317, "restore_eval_env_runners": 5.242019907194664e-05, "evaluation_iteration": 0.14379052223565816, "synch_eval_env_connectors": 0.00022569891933990412, "synch_env_connectors": 6.050742538258866e-06}, "env_runners": {"module_to_env_connector": {"connector_pipeline_timer": 0.0001193157890889948, "timers": {"connectors": {"remove_single_ts_time_rank_from_batch": 1.206941636461044e-05, "un_batch_to_individual_items": 6.62853164533981e-06, "get_actions": 3.968974332966321e-05, "tensor_to_numpy": 1.515930553297331e-05, "listify_data_for_vector_env": 1.0565177008694907e-05, "normalize_and_clip_actions": 8.034725538095301e-06}}}, "rlmodule_inference_timer": 3.2228704831466985e-05, "sample": 0.005744050580280725, "weights_seq_no": 10.0, "num_agent_steps_sampled": {"default_agent": 5000.0}, "episode_len_mean": 20.0, "episode_len_max": 20, "env_to_module_connector": {"timers": {"connectors": {"batch_individual_items": 1.2689621843292101e-05, "add_states_from_episodes_to_batch": 2.7320317899279867e-06, "numpy_to_tensor": 1.2732752863061374e-05, "add_observations_from_episodes_to_batch": 2.8260126531682235e-06, "add_time_dim_to_batch_and_zero_pad": 7.000636032775004e-06}}, "connector_pipeline_timer": 6.058129025388821e-05}, "env_to_module_sum_episodes_length_out": 10.36823839457432, "num_agent_steps_sampled_lifetime": {"default_agent": -5547500.0}, "episode_return_mean": 0.7800000000000001, "num_module_steps_sampled_lifetime": {"default_policy": -5547500.0}, "num_episodes": 250.0, "time_between_sampling": 0.031719736270130854, "num_env_steps_sampled_lifetime": -5547500.0, "episode_return_min": -10.5, "env_reset_timer": 4.3467092364799744e-05, "env_to_module_sum_episodes_length_in": 10.36823839457432, "num_episodes_lifetime": -277375.0, "agent_episode_returns_mean": {"default_agent": 0.7800000000000001}, "episode_len_min": 20, "episode_duration_sec_mean": 0.005344537001568822, "env_step_timer": 1.4204128090077688e-05, "episode_return_max": 9.5, "num_module_steps_sampled": {"default_policy": 5000.0}, "module_episode_returns_mean": {"default_policy": 0.7800000000000001}, "num_env_steps_sampled": 5000.0, "num_env_steps_sampled_lifetime_throughput": 3198.363618837616}, "__all_modules__": {"learner_connector_sum_episodes_length_in": 5000.0, "learner_connector": {"connector_pipeline_timer": 0.16093633508725594, "timers": {"connectors": {"add_one_ts_to_episodes_and_truncate": 0.009347093029928415, "add_observations_from_episodes_to_batch": 0.0016165983377074366, "add_columns_from_episodes_to_train_batch": 0.049472259782191906, "add_time_dim_to_batch_and_zero_pad": 0.08503125682530559, "add_states_from_episodes_to_batch": 0.008769273338976794, "batch_individual_items": 0.0063574900074531175, "numpy_to_tensor": 9.572660829949102e-05}}}, "learner_connector_sum_episodes_length_out": 5250.0}, "learners": {"default_policy": {"curr_entropy_coeff": 0.0015431216992, "curr_kl_coeff": 7.889840344432741e-05, "num_module_steps_trained_lifetime": 65835, "entropy": 0.6844244599342346, "num_module_steps_trained": 5985, "diff_num_grad_updates_vs_sampler_policy": 1.0, "vf_loss": 0.3583259582519531, "vf_loss_unclipped": 43.34327697753906, "policy_loss": -0.00016374608094338328, "use_intrinsic_rewards": 0.0, "total_loss": 0.2779342830181122, "vf_explained_var": -0.0019468069076538086, "mean_kl_loss": 2.609304829093162e-05, "weights_seq_no": 11.0, "num_trainable_parameters": 16595, "module_train_batch_size_mean": 997.7563503102639, "num_module_steps_trained_lifetime_throughput": 731.8125664896145}, "intrinsic_reward_module": {"num_module_steps_trained_lifetime": 65835, "num_module_steps_trained": 5985, "diff_num_grad_updates_vs_sampler_policy": 1.0, "total_loss": 0.0, "gradients_default_optimizer_global_norm": 0.0, "module_train_batch_size_mean": 997.7563503102639, "default_optimizer_learning_rate": 0.0002715581955, "weights_seq_no": 11.0, "num_trainable_parameters": 8266, "curr_entropy_coeff": 0.0015431216992, "num_module_steps_trained_lifetime_throughput": 731.8215573325045}, "differentiable_learners": {"intrinsic_attention_ppo_learner": {"default_policy": {"weights_seq_no": 66.0, "num_module_steps_trained": 35910, "num_module_steps_trained_lifetime": 395010, "entropy": 0.6844359040260315, "diff_num_grad_updates_vs_sampler_policy": 56.0, "vf_loss": 0.3584628403186798, "vf_loss_unclipped": 43.38056564331055, "total_loss": 0.2780482769012451, "mean_kl_loss": 2.5483541321591474e-05, "policy_loss": -0.00016049740952439606, "use_intrinsic_rewards": 1.0, "module_train_batch_size_mean": 997.5068778348534, "vf_explained_var": -0.0016118288040161133}, "__all_modules__": {"num_env_steps_trained": 198000, "num_module_steps_trained": 71820, "num_module_steps_trained_lifetime": 790020, "num_env_steps_trained_lifetime": 2178000, "num_env_steps_trained_lifetime_throughput": 35342.32280858751}, "intrinsic_reward_module": {"weights_seq_no": 66.0, "num_module_steps_trained_lifetime": 395010, "num_module_steps_trained": 35910, "diff_num_grad_updates_vs_sampler_policy": 56.0, "total_loss": 0.0, "module_train_batch_size_mean": 997.5068778348534}}}, "__all_modules__": {"num_env_steps_trained_lifetime": 363000, "num_non_trainable_parameters": 0, "num_trainable_parameters": 24861, "num_env_steps_trained": 33000, "num_module_steps_trained": 11970, "num_module_steps_trained_lifetime": 131670, "num_env_steps_trained_lifetime_throughput": 4036.4738499927857, "num_module_steps_trained_throughput": 22889687.635169644, "num_module_steps_trained_lifetime_throughput": 12683149.122718496}, "IntrinsicAttentionMask": [[[0.09257820248603821, 0.09156360477209091, 0.08979475498199463, 0.08980414271354675, 0.09261693805456161, 0.0916019156575203, 0.08983232825994492, 0.08984172344207764, 0.09163065999746323, 0.08986051380634308, 0.09087524563074112], [0.091801717877388, 0.09126099199056625, 0.09031161665916443, 0.09031667560338974, 0.0918223038315773, 0.0912814661860466, 0.09033186733722687, 0.09033694118261337, 0.09129682183265686, 0.09034706652164459, 0.09089256078004837], [0.09043630212545395, 0.09072093665599823, 0.09122699499130249, 0.09122427552938461, 0.0904255136847496, 0.0907101184129715, 0.09121611714363098, 0.09121339023113251, 0.09070199728012085, 0.09120795130729675, 0.09091636538505554], [0.09044358879327774, 0.09072384983301163, 0.09122208505868912, 0.09121940284967422, 0.09043297171592712, 0.09071318805217743, 0.09121137112379074, 0.09120869636535645, 0.09070520102977753, 0.09120333939790726, 0.09091626107692719], [0.09260774403810501, 0.09157504886388779, 0.08977513015270233, 0.08978468924760818, 0.09264717996120453, 0.09161404520273209, 0.08981335908174515, 0.089822918176651, 0.09164329618215561, 0.08984203636646271, 0.09087453037500381], [0.09183111786842346, 0.0912725105881691, 0.09029199182987213, 0.09029722213745117, 0.09185239672660828, 0.09129365533590317, 0.0903129056096077, 0.09031813591718674, 0.09130952507257462, 0.09032859653234482, 0.09089194983243942], [0.09046546369791031, 0.09073258191347122, 0.0912073627114296, 0.09120481461286545, 0.09045533835887909, 0.09072242677211761, 0.09119715541601181, 0.09119459986686707, 0.09071481227874756, 0.09118949621915817, 0.09091594815254211], [0.0904727652668953, 0.09073549509048462, 0.09120246022939682, 0.09119994938373566, 0.09046280384063721, 0.09072551131248474, 0.09119241684675217, 0.0911899134516716, 0.09071801602840424, 0.09118489176034927, 0.09091585129499435], [0.09185318648815155, 0.09128116071224213, 0.0902772769331932, 0.0902826264500618, 0.09187497198581696, 0.09130280464887619, 0.09029868990182877, 0.09030403941869736, 0.09131904691457748, 0.09031474590301514, 0.09089150279760361], [0.09048733860254288, 0.09074131399393082, 0.09119264036417007, 0.09119021892547607, 0.09047771245241165, 0.0907316580414772, 0.09118293970823288, 0.09118051081895828, 0.090724416077137, 0.09117566049098969, 0.09091563522815704], [0.09127213060855865, 0.09105273336172104, 0.09066565334796906, 0.090667724609375, 0.09128046780824661, 0.0910610556602478, 0.09067393839359283, 0.09067600965499878, 0.09106729179620743, 0.09068015217781067, 0.09090279787778854]], [[0.09201358258724213, 0.09156721830368042, 0.09098372608423233, 0.0926261618733406, 0.09263177961111069, 0.09158944338560104, 0.09159500151872635, 0.09205267578363419, 0.08169262111186981, 0.09154162555932999, 0.09170617908239365], [0.09135212749242783, 0.091178297996521, 0.09095031023025513, 0.09158983081579208, 0.09159200638532639, 0.09118697047233582, 0.09118913859128952, 0.09136731922626495, 0.08719318360090256, 0.09116832166910172, 0.09123247116804123], [0.09043268859386444, 0.09061232209205627, 0.09084901213645935, 0.09018814563751221, 0.09018591791391373, 0.09060334414243698, 0.0906011089682579, 0.09041702002286911, 0.09493150562047958, 0.0906226634979248, 0.09055627137422562], [0.09286589175462723, 0.09204309433698654, 0.09097254276275635, 0.09400045871734619, 0.09401089698076248, 0.09208397567272186, 0.09209420531988144, 0.09293809533119202, 0.07469600439071655, 0.09199602156877518, 0.09229888767004013], [0.09287341684103012, 0.09204715490341187, 0.09097214043140411, 0.09401281177997589, 0.09402329474687576, 0.09208821505308151, 0.09209848195314407, 0.09294592589139938, 0.07463463395833969, 0.09199988096952438, 0.09230402112007141], [0.09138589352369308, 0.09119854867458344, 0.09095285087823868, 0.09164214879274368, 0.09164449572563171, 0.09120789170265198, 0.09121022373437881, 0.09140227735042572, 0.08691093325614929, 0.09118779003620148, 0.09125692397356033], [0.0913943275809288, 0.09120359271764755, 0.09095346182584763, 0.09165522456169128, 0.0916576087474823, 0.09121309965848923, 0.09121548384428024, 0.09141100198030472, 0.08684049546718597, 0.09119264036417007, 0.09126302599906921], [0.0920698344707489, 0.09159952402114868, 0.09098492562770844, 0.09271546453237534, 0.09272138774394989, 0.09162294119596481, 0.091628797352314, 0.0921110212802887, 0.08122750371694565, 0.09157256782054901, 0.09174592792987823], [0.0644097700715065, 0.06890850514173508, 0.07530391961336136, 0.05874132737517357, 0.05869186669588089, 0.06867672502994537, 0.06861889362335205, 0.06403111666440964, 0.3359684348106384, 0.06917643547058105, 0.067472904920578], [0.09131313115358353, 0.09115488082170486, 0.09094727784395218, 0.0915294960141182, 0.09153147786855698, 0.0911627784371376, 0.09116474539041519, 0.09132696688175201, 0.08751930296421051, 0.09114579856395721, 0.0912042036652565], [0.09156183898448944, 0.09130334854125977, 0.0909646600484848, 0.09191571921110153, 0.0919189602136612, 0.09131623059511185, 0.09131945669651031, 0.09158444404602051, 0.08544297516345978, 0.09128851443529129, 0.09138387441635132]], [[0.09238889068365097, 0.09239855408668518, 0.08961113542318344, 0.08962050825357437, 0.09242754429578781, 0.09243721514940262, 0.08964862674474716, 0.08965800702571869, 0.09144329279661179, 0.08967676013708115, 0.09068942070007324], [0.09239542484283447, 0.09240513294935226, 0.0896054282784462, 0.08961484581232071, 0.09243425726890564, 0.09244396537542343, 0.08964309096336365, 0.08965250104665756, 0.09144561737775803, 0.08967134356498718, 0.09068842232227325], [0.09048830717802048, 0.09048561006784439, 0.09127945452928543, 0.09127673506736755, 0.09047751128673553, 0.09047481417655945, 0.09126856923103333, 0.09126584231853485, 0.09075415879487991, 0.0912604033946991, 0.09096864610910416], [0.0904947966337204, 0.0904921442270279, 0.091273732483387, 0.0912710502743721, 0.09048417210578918, 0.09048151224851608, 0.09126301854848862, 0.09126033633947372, 0.09075655788183212, 0.09125497192144394, 0.09096773713827133], [0.09241501986980438, 0.09242485463619232, 0.08958829939365387, 0.08959783613681793, 0.09245437383651733, 0.09246420860290527, 0.08962644636631012, 0.08963599056005478, 0.09145257622003555, 0.0896550714969635, 0.0906854122877121], [0.09242154657840729, 0.09243141859769821, 0.08958258479833603, 0.08959215879440308, 0.09246107190847397, 0.09247095137834549, 0.08962089568376541, 0.08963047713041306, 0.0914548933506012, 0.08964963257312775, 0.09068439900875092], [0.09051427245140076, 0.0905117392539978, 0.09125657379627228, 0.09125402569770813, 0.09050413966178894, 0.09050161391496658, 0.0912463590502739, 0.09124381095170975, 0.09076375514268875, 0.09123869985342026, 0.09096500277519226], [0.09052077680826187, 0.0905182808637619, 0.09125085920095444, 0.09124834835529327, 0.09051080793142319, 0.09050831943750381, 0.09124081581830978, 0.09123830497264862, 0.09076616168022156, 0.0912332832813263, 0.09096410125494003], [0.09174720197916031, 0.09175264090299606, 0.09017311036586761, 0.0901784598827362, 0.09176895767450333, 0.09177440404891968, 0.09019449353218079, 0.09019984304904938, 0.09121368080377579, 0.09021054208278656, 0.09078662842512131], [0.09053375571966171, 0.09053134173154831, 0.09123941510915756, 0.09123698621988297, 0.09052412211894989, 0.09052171558141708, 0.09122970700263977, 0.09122728556394577, 0.09077095240354538, 0.09122242778539658, 0.09096226841211319], [0.09123171120882034, 0.09123379737138748, 0.09062550961971283, 0.09062758088111877, 0.0912400484085083, 0.09124213457107544, 0.09063378721475601, 0.09063585847616196, 0.09102696925401688, 0.09064000099897385, 0.09086254984140396]], [[0.09207367897033691, 0.09162702411413193, 0.0910431444644928, 0.09268665313720703, 0.09209603071212769, 0.09105971455574036, 0.09106524288654327, 0.09211278706789017, 0.08227521926164627, 0.09219446033239365, 0.09176607429981232], [0.09137407690286636, 0.09120021015405655, 0.0909721627831459, 0.0916118398308754, 0.09138276427984238, 0.09097864478826523, 0.09098080545663834, 0.09138927608728409, 0.08743484318256378, 0.09142100065946579, 0.09125439822673798], [0.09041210263967514, 0.09059169888496399, 0.09082833677530289, 0.09016762673854828, 0.09040315449237823, 0.09082158654928207, 0.0908193364739418, 0.09039643406867981, 0.09466028213500977, 0.0903637558221817, 0.09053565561771393], [0.09298543632030487, 0.09216158092021942, 0.0910896509885788, 0.09412146359682083, 0.09302674233913422, 0.09111999720335007, 0.09113010764122009, 0.09305772930383682, 0.07568071037530899, 0.09320878237485886, 0.09241770207881927], [0.09210788458585739, 0.09164752066135406, 0.09104584902524948, 0.0927397608757019, 0.09213091433048248, 0.09106291830539703, 0.09106861799955368, 0.09214819222688675, 0.08202509582042694, 0.09223237633705139, 0.0917908325791359], [0.09044017642736435, 0.09060979634523392, 0.09083325415849686, 0.09020925313234329, 0.09043172001838684, 0.09082688391208649, 0.09082476049661636, 0.09042537957429886, 0.09444738924503326, 0.0903945043683052, 0.09055686742067337], [0.09044952690601349, 0.09061581641435623, 0.09083488583564758, 0.09022311866283417, 0.09044123440980911, 0.09082864224910736, 0.09082655608654022, 0.09043501317501068, 0.09437651932239532, 0.09040474891662598, 0.09056393057107925], [0.09213349968194962, 0.09166286885738373, 0.09104783833026886, 0.09277957677841187, 0.09215705096721649, 0.09106529504060745, 0.09107110649347305, 0.0921747162938118, 0.0818379744887352, 0.09226078540086746, 0.09180936962366104], [0.06744994968175888, 0.07187828421592712, 0.07814498245716095, 0.0618443563580513, 0.06723625212907791, 0.07795921713113785, 0.07789739221334457, 0.0670764222741127, 0.2937425374984741, 0.06630360335111618, 0.0704670250415802], [0.09225766360759735, 0.09173692762851715, 0.09105683863162994, 0.09297297894954681, 0.09228372573852539, 0.09107612818479538, 0.09108256548643112, 0.09230328351259232, 0.08093234896659851, 0.09239854663610458, 0.09189899265766144], [0.09159515798091888, 0.09133657813072205, 0.09099776297807693, 0.09194917231798172, 0.09160808473825455, 0.09100738912820816, 0.09101060032844543, 0.09161777794361115, 0.08579535037279129, 0.09166499227285385, 0.09141714125871658]], [[0.09092119336128235, 0.09107603877782822, 0.09067102521657944, 0.09067606180906296, 0.09163159132003784, 0.09163668751716614, 0.09015637636184692, 0.09069623053073883, 0.09165197610855103, 0.09070632606744766, 0.09017642587423325], [0.09092379361391068, 0.09111793339252472, 0.0906103327870369, 0.09061664342880249, 0.09181513637304306, 0.09182153642177582, 0.08996615558862686, 0.09064190834760666, 0.09184073656797409, 0.09065454453229904, 0.0899912416934967], [0.09091657400131226, 0.09100784361362457, 0.09076898545026779, 0.09077195823192596, 0.09133477509021759, 0.09133777022361755, 0.09046483784914017, 0.09078386425971985, 0.09134675562381744, 0.09078982472419739, 0.09047670662403107], [0.09091667830944061, 0.0910092294216156, 0.0907670184969902, 0.09077004343271255, 0.09134077280759811, 0.09134380519390106, 0.09045861661434174, 0.09078211337327957, 0.0913529172539711, 0.09078814834356308, 0.09047064930200577], [0.09093156456947327, 0.09126626700162888, 0.09039221704006195, 0.09040306508541107, 0.09247253090143204, 0.09248363226652145, 0.08928809314966202, 0.09044649451971054, 0.0925169512629509, 0.09046821296215057, 0.08933098614215851], [0.09093162417411804, 0.09126760810613632, 0.09039021283388138, 0.09040110558271408, 0.09247855097055435, 0.09248969703912735, 0.08928190171718597, 0.09044469147920609, 0.09252314269542694, 0.09046649932861328, 0.089324951171875], [0.09090548753738403, 0.09086558222770691, 0.09097015112638474, 0.09096884727478027, 0.09072308242321014, 0.09072177857160568, 0.09110388904809952, 0.09096362441778183, 0.0907178744673729, 0.0909610167145729, 0.09109865874052048], [0.09091707319021225, 0.09101475030183792, 0.09075912833213806, 0.09076230973005295, 0.09136471152305603, 0.0913679227232933, 0.09043370187282562, 0.09077505022287369, 0.09137754142284393, 0.09078142791986465, 0.09044639021158218], [0.09093180298805237, 0.09127164632081985, 0.09038420021533966, 0.09039522707462311, 0.09249661862850189, 0.09250789880752563, 0.08926334977149963, 0.0904393121600151, 0.09254173189401627, 0.090461365878582, 0.08930688351392746], [0.09091726690530777, 0.09101751446723938, 0.09075517952442169, 0.09075845032930374, 0.09137669205665588, 0.09137997776269913, 0.09042123705148697, 0.09077151864767075, 0.09138984978199005, 0.09077806025743484, 0.09043426066637039], [0.09090596437454224, 0.0908711776137352, 0.09096232801675797, 0.09096119552850723, 0.09074694663286209, 0.09074581414461136, 0.09107887744903564, 0.09095663577318192, 0.09074240922927856, 0.09095436334609985, 0.09107432514429092]], [[0.09201296418905258, 0.09156659990549088, 0.09098310768604279, 0.09262553602457047, 0.09263115376234055, 0.0915888249874115, 0.09100519120693207, 0.09264801442623138, 0.08169207721948624, 0.09154100716114044, 0.0917055606842041], [0.09135203808546066, 0.09117821604013443, 0.09095022082328796, 0.09158974140882492, 0.09159192442893982, 0.09118688106536865, 0.0909588634967804, 0.09159845113754272, 0.0871930941939354, 0.09116823971271515, 0.09123238176107407], [0.09043258428573608, 0.09061222523450851, 0.090848907828331, 0.09018805623054504, 0.09018582105636597, 0.09060325473546982, 0.0908399224281311, 0.09017912298440933, 0.09493139386177063, 0.09062255918979645, 0.09055616706609726], [0.09286376088857651, 0.09204097837209702, 0.09097044914960861, 0.09399829804897308, 0.09400873631238937, 0.09208186715841293, 0.09101086854934692, 0.09404005855321884, 0.07469431310892105, 0.09199391305446625, 0.09229676425457001], [0.0928712710738182, 0.09204502403736115, 0.09097003936767578, 0.09401064366102219, 0.09402111917734146, 0.09208608418703079, 0.09101062268018723, 0.09405257552862167, 0.074632927775383, 0.09199775755405426, 0.09230189025402069], [0.09138578921556473, 0.09119844436645508, 0.09095274657011032, 0.09164204448461533, 0.09164439141750336, 0.09120777994394302, 0.09096205979585648, 0.09165143221616745, 0.08691082894802094, 0.09118768572807312, 0.09125681966543198], [0.09046857059001923, 0.09063489735126495, 0.09085400402545929, 0.09024211764335632, 0.09024004638195038, 0.09062658995389938, 0.09084568172693253, 0.09023384004831314, 0.0946267619729042, 0.0906444638967514, 0.09058299660682678], [0.0928938016295433, 0.09205716103315353, 0.0909687951207161, 0.0940476581454277, 0.09405827522277832, 0.09209873527288437, 0.09100987762212753, 0.09409012645483017, 0.0744490772485733, 0.0920092985033989, 0.09231724590063095], [0.06434906274080276, 0.0688435509800911, 0.07523292303085327, 0.05868596211075783, 0.05863655358552933, 0.0686119869351387, 0.07497987151145935, 0.05848856642842293, 0.3356510102748871, 0.06911122053861618, 0.06740929931402206], [0.09131304919719696, 0.0911548063158989, 0.09094719588756561, 0.09152942150831223, 0.09153140336275101, 0.09116269648075104, 0.09095506370067596, 0.09153734147548676, 0.08751922845840454, 0.09114571660757065, 0.09120412170886993], [0.09156162291765213, 0.09130313992500305, 0.09096444398164749, 0.09191550314426422, 0.09191875159740448, 0.09131602197885513, 0.09097728133201599, 0.09192847460508347, 0.08544278144836426, 0.09128830581903458, 0.0913836658000946]]]}, "num_training_step_calls_per_iteration": 1, "evaluation": {"env_runners": {"module_to_env_connector": {"timers": {"connectors": {"tensor_to_numpy": 1.7076385975135883e-05, "un_batch_to_individual_items": 8.4711085680174e-06, "get_actions": 4.27554337146769e-05, "listify_data_for_vector_env": 1.1510067689903294e-05, "normalize_and_clip_actions": 9.373985188052171e-06, "remove_single_ts_time_rank_from_batch": 1.3660947192657637e-05}}, "connector_pipeline_timer": 0.00013213658823015833}, "episode_len_min": 20, "num_env_steps_sampled": 400, "weights_seq_no": 11.0, "episode_len_mean": 20.0, "env_to_module_sum_episodes_length_out": 10.368238394574323, "episode_len_max": 20, "env_to_module_connector": {"timers": {"connectors": {"batch_individual_items": 1.4475982033200299e-05, "add_observations_from_episodes_to_batch": 3.058921810099661e-06, "add_states_from_episodes_to_batch": 3.172168586486686e-06, "add_time_dim_to_batch_and_zero_pad": 7.627987791594657e-06, "numpy_to_tensor": 1.4907353470056997e-05}}, "connector_pipeline_timer": 6.749020874388523e-05}, "env_to_module_sum_episodes_length_in": 10.368238394574323, "num_episodes_lifetime": 220, "episode_duration_sec_mean": 0.005541597922565415, "episode_return_max": 12.5, "rlmodule_inference_timer": 3.465944526049714e-05, "num_agent_steps_sampled": {"default_agent": 400}, "num_module_steps_sampled_lifetime": {"default_policy": 4400}, "num_agent_steps_sampled_lifetime": {"default_agent": 4400}, "num_module_steps_sampled": {"default_policy": 400}, "sample": 0.13192847952404355, "episode_return_mean": 0.6, "env_step_timer": 1.5965841386148142e-05, "agent_episode_returns_mean": {"default_agent": 0.6}, "num_episodes": 20, "module_episode_returns_mean": {"default_policy": 0.6}, "episode_return_min": -12.5, "num_env_steps_sampled_lifetime": 55400, "env_reset_timer": 0.0005658878656603303, "time_between_sampling": 12.399847394394733}, "num_healthy_workers": 1, "actor_manager_num_outstanding_async_reqs": 0, "num_remote_worker_restarts": 0}, "num_env_steps_sampled_lifetime": -5547500.0, "fault_tolerance": {"num_healthy_workers": 0, "num_remote_worker_restarts": 0}, "env_runner_group": {"actor_manager_num_outstanding_async_reqs": 0}, "done": false, "training_iteration": 11, "trial_id": "ae8a2_00000", "date": "2025-08-11_18-24-31", "timestamp": 1754929471, "time_this_iter_s": 9.759567737579346, "time_total_s": 124.90327143669128, "pid": 10870, "hostname": "Mac", "node_ip": "127.0.0.1", "config": {"exploration_config": {}, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 2, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "env": "Umbrella", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": false, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 0, "create_local_env_runner": true, "num_envs_per_env_runner": 1, "gym_env_vectorize_mode": "SYNC", "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "episodes_to_numpy": true, "max_requests_in_flight_per_env_runner": 1, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "merge_env_runner_states": "training_only", "broadcast_env_runner_states": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "complete_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "sampler_perf_stats_ema_coef": null, "_is_online": true, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": "auto", "num_aggregator_actors_per_learner": 0, "max_requests_in_flight_per_aggregator_actor": 3, "local_gpu_idx": 0, "max_requests_in_flight_per_learner": 3, "gamma": 1, "lr": 0.0002715581955, "grad_clip": 0.5, "grad_clip_by": "global_norm", "_train_batch_size_per_learner": 5000, "train_batch_size": 4000, "num_epochs": 1, "minibatch_size": 1000, "shuffle_batch_per_epoch": true, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "log_std_clip_param": 20.0, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "_disable_preprocessor_api": false, "_disable_action_flattening": false}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {"intrinsic_reward_coeff": 0.2795015916508}, "optimizer": {}, "_learner_class": "<class 'source.intrinsic_attention_ppo.learners.IntrinsicAttentionMetaLearner.IntrinsicAttentionMetaLearner'>", "callbacks_on_algorithm_init": null, "callbacks_on_env_runners_recreated": null, "callbacks_on_offline_eval_runners_recreated": null, "callbacks_on_checkpoint_loaded": null, "callbacks_on_environment_created": null, "callbacks_on_episode_created": null, "callbacks_on_episode_start": null, "callbacks_on_episode_step": null, "callbacks_on_episode_end": null, "callbacks_on_evaluate_start": null, "callbacks_on_evaluate_end": null, "callbacks_on_evaluate_offline_start": null, "callbacks_on_evaluate_offline_end": null, "callbacks_on_sample_end": null, "callbacks_on_train_result": null, "explore": true, "enable_rl_module_and_learner": true, "enable_env_runner_and_connector_v2": true, "_prior_exploration_config": {"type": "StochasticSampling"}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x38844d8a0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "offline_data_class": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_read_batch_size": null, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "materialize_data": false, "materialize_mapped_data": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "ignore_final_observation": false, "prelearner_class": null, "prelearner_buffer_class": null, "prelearner_buffer_kwargs": {}, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_remaining_data": false, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": 1, "evaluation_duration": 20, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_auto_duration_min_env_steps_per_sample": 100, "evaluation_auto_duration_max_env_steps_per_sample": 2000, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 1, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "offline_evaluation_interval": null, "num_offline_eval_runners": 0, "offline_loss_for_module_fn": null, "offline_evaluation_duration": 1, "offline_evaluation_parallel_to_training": false, "offline_evaluation_timeout_s": 120.0, "num_cpus_per_offline_eval_runner": 1, "num_gpus_per_offline_eval_runner": 0, "custom_resources_per_offline_eval_runner": {}, "restart_failed_offline_eval_runners": true, "ignore_offline_eval_runner_failures": false, "max_num_offline_eval_runner_restarts": 1000, "offline_eval_runner_restore_timeout_s": 1800.0, "max_requests_in_flight_per_offline_eval_runner": 1, "validate_offline_eval_runners_after_construction": true, "offline_eval_runner_health_probe_timeout_s": 30.0, "offline_eval_rl_module_inference_only": false, "broadcast_offline_eval_runner_states": false, "offline_eval_batch_size_per_runner": 256, "dataset_num_iters_per_eval_runner": 1, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "log_gradients": false, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 1, "restart_failed_env_runners": true, "ignore_env_runner_failures": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30.0, "env_runner_restore_timeout_s": 1800.0, "_model_config": {}, "_rl_module_spec": "MultiRLModuleSpec(multi_rl_module_class=<class 'ray.rllib.core.rl_module.multi_rl_module.MultiRLModule'>, observation_space=None, action_space=None, inference_only=False, model_config=None, rl_module_specs={'default_policy': RLModuleSpec(module_class=<class 'source.intrinsic_attention_ppo.rl_modules.DifferentiablePPOModule.DifferentiablePPOModule'>, observation_space=None, action_space=None, inference_only=False, learner_only=False, model_config={'vf_share_layers': True, 'embedding_dim': 62, 'max_seq_len': 11, 'policy_head_hidden_sizes': [32], 'value_head_hidden_sizes': [101], 'embedding_hidden_sizes': [121]}, catalog_class=None, load_state_path=None, model_config_dict=None), 'intrinsic_reward_module': RLModuleSpec(module_class=<class 'source.intrinsic_attention_ppo.rl_modules.IntrinsicAttentionModule.IntrinsicAttentionModule'>, observation_space=None, action_space=None, inference_only=False, learner_only=True, model_config={'intrinsic_reward_network': {'encoder_hidden_sizes': [], 'encoding_dim': 1, 'num_heads': 1, 'head_hidden_sizes': None, 'layers': [{'type': 'attention'}]}, 'extrinsic_value_hidden_layers': [127, 60], 'vf_share_layers': True, 'max_seq_len': 11}, catalog_class=None, load_state_path=None, model_config_dict=None)}, load_state_path=None, modules_to_load=None, module_specs={'default_policy': RLModuleSpec(module_class=<class 'source.intrinsic_attention_ppo.rl_modules.DifferentiablePPOModule.DifferentiablePPOModule'>, observation_space=None, action_space=None, inference_only=False, learner_only=False, model_config={'vf_share_layers': True, 'embedding_dim': 62, 'max_seq_len': 11, 'policy_head_hidden_sizes': [32], 'value_head_hidden_sizes': [101], 'embedding_hidden_sizes': [121]}, catalog_class=None, load_state_path=None, model_config_dict=None), 'intrinsic_reward_module': RLModuleSpec(module_class=<class 'source.intrinsic_attention_ppo.rl_modules.IntrinsicAttentionModule.IntrinsicAttentionModule'>, observation_space=None, action_space=None, inference_only=False, learner_only=True, model_config={'intrinsic_reward_network': {'encoder_hidden_sizes': [], 'encoding_dim': 1, 'num_heads': 1, 'head_hidden_sizes': None, 'layers': [{'type': 'attention'}]}, 'extrinsic_value_hidden_layers': [127, 60], 'vf_share_layers': True, 'max_seq_len': 11}, catalog_class=None, load_state_path=None, model_config_dict=None)})", "algorithm_config_overrides_per_module": {"intrinsic_reward_module": {"lr": 0.0002715581955}}, "_per_module_overrides": {}, "_validate_config": true, "_use_msgpack_checkpoints": false, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "env_task_fn": -1, "enable_connectors": -1, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.161583927863, "kl_target": 0.0201019014258, "vf_loss_coeff": 0.7790510010087, "entropy_coeff": 0.0015431216992, "clip_param": 0.2459212356676, "vf_clip_param": 0.3769744131561, "entropy_coeff_schedule": null, "lr_schedule": null, "sgd_minibatch_size": -1, "vf_share_layers": -1, "differentiable_learner_configs": ["DifferentiableLearnerConfig(learner_class=<class 'source.intrinsic_attention_ppo.learners.IntrinsicAttentionPPOLearner.IntrinsicAttentionPPOLearner'>, learner_connector=None, add_default_connectors_to_learner_pipeline=True, is_multi_agent=False, policies_to_update=['default_policy'], lr=0.0060984166342, num_total_minibatches=0, num_epochs=1, minibatch_size=1000, shuffle_batch_per_epoch=True)"], "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9485408017724, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.callbacks.callbacks.RLlibCallback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 124.90327143669128, "iterations_since_restore": 11, "perf": {"cpu_util_percent": 44.607142857142854, "ram_util_percent": 78.44285714285715}}
{"timers": {"training_iteration": 12.471046622243236, "restore_env_runners": 1.2197119628651766e-05, "training_step": 12.470846518531573, "env_runner_sampling_timer": 2.8273177552145166, "learner_update_timer": 9.42677811806614, "synch_weights": 0.0016442288368724949, "restore_eval_env_runners": 5.24289161565672e-05, "evaluation_iteration": 0.14380368826378684, "synch_eval_env_connectors": 0.00022541942948809727, "synch_env_connectors": 6.03856493373273e-06}, "env_runners": {"module_to_env_connector": {"connector_pipeline_timer": 0.00011764351460037819, "timers": {"connectors": {"remove_single_ts_time_rank_from_batch": 1.1939963442707736e-05, "un_batch_to_individual_items": 6.579316932297983e-06, "get_actions": 3.8755514039402804e-05, "tensor_to_numpy": 1.4942072150505633e-05, "listify_data_for_vector_env": 1.0531062735123108e-05, "normalize_and_clip_actions": 7.960186682718026e-06}}}, "rlmodule_inference_timer": 6.43747973567529e-05, "sample": 0.0061904608067234685, "weights_seq_no": 11.0, "num_agent_steps_sampled": {"default_agent": 5000.0}, "episode_len_mean": 20.0, "episode_len_max": 20, "env_to_module_connector": {"timers": {"connectors": {"batch_individual_items": 1.2442354182909752e-05, "add_states_from_episodes_to_batch": 2.7487581390964658e-06, "numpy_to_tensor": 1.2449574428777267e-05, "add_observations_from_episodes_to_batch": 2.806859907552951e-06, "add_time_dim_to_batch_and_zero_pad": 6.897771542505436e-06}}, "connector_pipeline_timer": 5.979814675351945e-05}, "env_to_module_sum_episodes_length_out": 10.36823839457432, "num_agent_steps_sampled_lifetime": {"default_agent": -6165000.0}, "episode_return_mean": 0.86, "num_module_steps_sampled_lifetime": {"default_policy": -6165000.0}, "num_episodes": 250.0, "time_between_sampling": 0.03325904068948155, "num_env_steps_sampled_lifetime": -6165000.0, "episode_return_min": -10.5, "env_reset_timer": 4.2765413709191086e-05, "env_to_module_sum_episodes_length_in": 10.36823839457432, "num_episodes_lifetime": -308250.0, "agent_episode_returns_mean": {"default_agent": 0.86}, "episode_len_min": 20, "episode_duration_sec_mean": 0.005865618998184802, "env_step_timer": 1.4001965449519142e-05, "episode_return_max": 9.5, "num_module_steps_sampled": {"default_policy": 5000.0}, "module_episode_returns_mean": {"default_policy": 0.86}, "num_env_steps_sampled": 5000.0, "num_env_steps_sampled_lifetime_throughput": 3240.4238851182254}, "__all_modules__": {"learner_connector_sum_episodes_length_in": 5000.0, "learner_connector": {"connector_pipeline_timer": 0.1606650629868924, "timers": {"connectors": {"add_one_ts_to_episodes_and_truncate": 0.009342856270365876, "add_observations_from_episodes_to_batch": 0.001608764434072466, "add_columns_from_episodes_to_train_batch": 0.04938649634376471, "add_time_dim_to_batch_and_zero_pad": 0.08493318508738643, "add_states_from_episodes_to_batch": 0.008717418105477503, "batch_individual_items": 0.0063357284374049305, "numpy_to_tensor": 9.53885122396245e-05}}}, "learner_connector_sum_episodes_length_out": 5250.0}, "learners": {"default_policy": {"curr_entropy_coeff": 0.0015431216992, "curr_kl_coeff": 3.944920172216371e-05, "num_module_steps_trained_lifetime": 71820, "entropy": 0.6836075782775879, "num_module_steps_trained": 5985, "diff_num_grad_updates_vs_sampler_policy": 1.0, "vf_loss": 0.35832303762435913, "vf_loss_unclipped": 43.30691909790039, "policy_loss": 4.720386186818359e-06, "use_intrinsic_rewards": 0.0, "total_loss": 0.27810177206993103, "vf_explained_var": -0.0007829666137695312, "mean_kl_loss": 1.947965211002156e-05, "weights_seq_no": 12.0, "num_trainable_parameters": 16595, "module_train_batch_size_mean": 997.7412016936058, "num_module_steps_trained_lifetime_throughput": 729.3818030423423}, "intrinsic_reward_module": {"num_module_steps_trained_lifetime": 71820, "num_module_steps_trained": 5985, "diff_num_grad_updates_vs_sampler_policy": 1.0, "total_loss": 0.0, "gradients_default_optimizer_global_norm": 0.0, "module_train_batch_size_mean": 997.7412016936058, "default_optimizer_learning_rate": 0.0002715581955, "weights_seq_no": 12.0, "num_trainable_parameters": 8266, "curr_entropy_coeff": 0.0015431216992, "num_module_steps_trained_lifetime_throughput": 729.3902388177623}, "differentiable_learners": {"intrinsic_attention_ppo_learner": {"default_policy": {"weights_seq_no": 72.0, "num_module_steps_trained": 35910, "num_module_steps_trained_lifetime": 430920, "entropy": 0.6836057305335999, "diff_num_grad_updates_vs_sampler_policy": 61.0, "vf_loss": 0.3584548532962799, "vf_loss_unclipped": 43.39591979980469, "total_loss": 0.2782071828842163, "mean_kl_loss": 1.9559976863092743e-05, "policy_loss": 4.32545084549929e-06, "use_intrinsic_rewards": 1.0, "module_train_batch_size_mean": 997.504027034245, "vf_explained_var": -0.0016192197799682617}, "__all_modules__": {"num_env_steps_trained": 198000, "num_module_steps_trained": 71820, "num_module_steps_trained_lifetime": 861840, "num_env_steps_trained_lifetime": 2376000, "num_env_steps_trained_lifetime_throughput": 35186.28789227917}, "intrinsic_reward_module": {"weights_seq_no": 72.0, "num_module_steps_trained_lifetime": 430920, "num_module_steps_trained": 35910, "diff_num_grad_updates_vs_sampler_policy": 61.0, "total_loss": 0.0, "module_train_batch_size_mean": 997.504027034245}}}, "__all_modules__": {"num_env_steps_trained_lifetime": 396000, "num_non_trainable_parameters": 0, "num_trainable_parameters": 24861, "num_env_steps_trained": 33000, "num_module_steps_trained": 11970, "num_module_steps_trained_lifetime": 143640, "num_env_steps_trained_lifetime_throughput": 4023.017352379095, "num_module_steps_trained_throughput": 22323081.440110765, "num_module_steps_trained_lifetime_throughput": 12649080.370904945}, "IntrinsicAttentionMask": [[[0.09097137302160263, 0.09112630039453506, 0.09072106331586838, 0.0907261073589325, 0.09114150702953339, 0.0911465734243393, 0.09074124693870544, 0.09074629098176956, 0.09116178005933762, 0.0907563865184784, 0.09076143056154251], [0.09098709374666214, 0.09118136763572693, 0.09067340940237045, 0.09067973494529724, 0.09120043367147446, 0.09120678901672363, 0.09069868922233582, 0.0907050147652626, 0.09122586250305176, 0.09071765840053558, 0.09072398394346237], [0.09094584733247757, 0.09103714674711227, 0.09079821407794952, 0.0908011868596077, 0.09104610234498978, 0.09104909002780914, 0.09081012010574341, 0.09081310033798218, 0.09105804562568665, 0.09081906080245972, 0.09082203358411789], [0.09094637632369995, 0.09103895723819733, 0.09079666435718536, 0.09079968184232712, 0.09104803949594498, 0.09105106443166733, 0.09080874174833298, 0.09081175923347473, 0.09106014668941498, 0.09081780165433884, 0.09082081913948059], [0.0909886285662651, 0.0911867544054985, 0.09066873043775558, 0.09067517518997192, 0.09120620042085648, 0.0912126824259758, 0.09069450944662094, 0.09070096164941788, 0.09123213589191437, 0.09071385115385056, 0.09072030335664749], [0.09098915010690689, 0.09118856489658356, 0.09066718071699142, 0.09067366272211075, 0.09120813757181168, 0.09121465682983398, 0.09069312363862991, 0.09069962054491043, 0.0912342369556427, 0.09071259200572968, 0.0907190814614296], [0.09094791859388351, 0.0910443514585495, 0.0907919853925705, 0.090795136988163, 0.091053806245327, 0.0910569578409195, 0.0908045619726181, 0.0908077135682106, 0.09106642007827759, 0.09081399440765381, 0.09081714600324631], [0.0909484326839447, 0.09104614704847336, 0.09079042822122574, 0.09079361706972122, 0.091055728495121, 0.09105892479419708, 0.09080317616462708, 0.09080636501312256, 0.09106851369142532, 0.09081273525953293, 0.09081592410802841], [0.09099068492650986, 0.09119395166635513, 0.09066250175237656, 0.09066911786794662, 0.0912139043211937, 0.09122055768966675, 0.09068895131349564, 0.0906955674290657, 0.09124051779508591, 0.09070879220962524, 0.09071540832519531], [0.09094946831464767, 0.09104974567890167, 0.09078732132911682, 0.09079059213399887, 0.09105958789587021, 0.09106286615133286, 0.09080039709806442, 0.09080366790294647, 0.0910727009177208, 0.09081020951271057, 0.09081347286701202], [0.09094997495412827, 0.09105154126882553, 0.09078576415777206, 0.0907890722155571, 0.09106151014566422, 0.09106482565402985, 0.0907990038394928, 0.09080231934785843, 0.09107479453086853, 0.0908089429140091, 0.09081225842237473]], [[0.0901540145277977, 0.0889132097363472, 0.08962535113096237, 0.0901741087436676, 0.0908963531255722, 0.08893963694572449, 0.08894624561071396, 0.09020091593265533, 0.10297412425279617, 0.08958802372217178, 0.08958802372217178], [0.09101372957229614, 0.09121064841747284, 0.09109724313020706, 0.09101056307554245, 0.09089740365743637, 0.09120641648769379, 0.09120536595582962, 0.09100634604692459, 0.08914598077535629, 0.09110315889120102, 0.09110315889120102], [0.09054295718669891, 0.08990593999624252, 0.09027206897735596, 0.09055323153734207, 0.09092200547456741, 0.0899195522069931, 0.0899229571223259, 0.09056694060564041, 0.09688844531774521, 0.09025291353464127, 0.09025291353464127], [0.09013854712247849, 0.08887505531311035, 0.08960018306970596, 0.09015901386737823, 0.09089462459087372, 0.08890195935964584, 0.08890869468450546, 0.09018631279468536, 0.10321128368377686, 0.08956216275691986, 0.08956216275691986], [0.08954919129610062, 0.0874834731221199, 0.08866667747497559, 0.08958280086517334, 0.0907943919301033, 0.08752727508544922, 0.0875382274389267, 0.08962765336036682, 0.11202134191989899, 0.08860448747873306, 0.08860448747873306], [0.09099732339382172, 0.09116288274526596, 0.09106754511594772, 0.09099466353654861, 0.0908994972705841, 0.09115932881832123, 0.0911584421992302, 0.09099111706018448, 0.08942416310310364, 0.09107252210378647, 0.09107252210378647], [0.09099319577217102, 0.0911509245634079, 0.0910601019859314, 0.09099067002534866, 0.0909000039100647, 0.0911475419998169, 0.09114669263362885, 0.09098728746175766, 0.08949382603168488, 0.09106484055519104, 0.09106484055519104], [0.09011784195899963, 0.08882411569356918, 0.08956654369831085, 0.09013880789279938, 0.09089221805334091, 0.08885166049003601, 0.08885855227708817, 0.09016675502061844, 0.10352824628353119, 0.08952761441469193, 0.08952761441469193], [0.06928965449333191, 0.05860051512718201, 0.06453399360179901, 0.0694766417145729, 0.07651135325431824, 0.058811455965042114, 0.05886430665850639, 0.06972673535346985, 0.3457658588886261, 0.06420975178480148, 0.06420975178480148], [0.0905691385269165, 0.0899752601981163, 0.09031663835048676, 0.09057871997356415, 0.09092239290475845, 0.08998795598745346, 0.08999112993478775, 0.09059150516986847, 0.09646971523761749, 0.09029877930879593, 0.09029877930879593], [0.0905691385269165, 0.0899752601981163, 0.09031663835048676, 0.09057871997356415, 0.09092239290475845, 0.08998795598745346, 0.08999112993478775, 0.09059150516986847, 0.09646971523761749, 0.09029877930879593, 0.09029877930879593]], [[0.09248346835374832, 0.091469906270504, 0.09070634096860886, 0.08971225470304489, 0.09149861335754395, 0.09253184497356415, 0.08974040299654007, 0.0897497907280922, 0.09256087988615036, 0.08976856619119644, 0.08977795392274857], [0.09175162762403488, 0.09121119976043701, 0.09080222994089127, 0.09026739746332169, 0.09122654050588608, 0.09177734702825546, 0.09028258919715881, 0.09028764814138412, 0.09179278463125229, 0.09029776602983475, 0.09030283242464066], [0.09119658917188644, 0.09101269394159317, 0.09087305516004562, 0.09068981558084488, 0.09101792424917221, 0.09120532870292664, 0.09069502353668213, 0.09069675952196121, 0.09121056646108627, 0.09070023894309998, 0.09070197492837906], [0.09046918898820877, 0.09074952453374863, 0.09096335619688034, 0.09124522656202316, 0.09074153006076813, 0.09045591205358505, 0.09123718738555908, 0.09123451262712479, 0.09044794738292694, 0.091229148209095, 0.0912264734506607], [0.09177242964506149, 0.09121859818696976, 0.09079954773187637, 0.09025159478187561, 0.09123432636260986, 0.091798797249794, 0.09026715159416199, 0.09027233719825745, 0.09181461483240128, 0.09028270840644836, 0.09028789401054382], [0.09251824766397476, 0.09148211032152176, 0.09070169925689697, 0.08968590199947357, 0.09151145070791245, 0.09256770461797714, 0.0897146686911583, 0.08972425758838654, 0.09259739518165588, 0.08974344283342361, 0.08975303173065186], [0.09048987179994583, 0.09075705707073212, 0.09096083790063858, 0.09122941642999649, 0.09074944257736206, 0.09047721326351166, 0.09122175723314285, 0.09121920168399811, 0.09046962112188339, 0.09121410548686981, 0.09121154993772507], [0.09049675613641739, 0.09075956046581268, 0.09095998853445053, 0.09122413396835327, 0.09075206518173218, 0.09048429876565933, 0.09121660143136978, 0.09121409058570862, 0.09047683328390121, 0.09120906889438629, 0.09120655804872513], [0.09253913909196854, 0.09148944169282913, 0.09069892764091492, 0.08967011421918869, 0.09151916950941086, 0.09258924424648285, 0.08969924598932266, 0.08970895409584045, 0.09261932224035263, 0.08972837775945663, 0.08973809331655502], [0.0905105471611023, 0.09076458215713501, 0.09095830470323563, 0.09121359884738922, 0.0907573401927948, 0.09049850702285767, 0.09120631963014603, 0.09120389074087143, 0.09049128741025925, 0.09119904786348343, 0.09119661152362823], [0.09051743149757385, 0.09076708555221558, 0.09095746278762817, 0.0912083238363266, 0.09075997024774551, 0.09050560742616653, 0.09120117127895355, 0.09119878709316254, 0.09049850702285767, 0.0911940187215805, 0.09119163453578949]], [[0.08995310962200165, 0.08941898494958878, 0.08942563086748123, 0.08997316658496857, 0.09069379419088364, 0.08874144405126572, 0.0887480303645134, 0.08999989926815033, 0.10355988144874573, 0.09009764343500137, 0.08938837796449661], [0.09044778347015381, 0.09017711132764816, 0.09018047899007797, 0.09045793861150742, 0.09082182496786118, 0.08983258903026581, 0.08983594924211502, 0.09047146886587143, 0.09709229320287704, 0.09052089601755142, 0.09016157686710358], [0.09044186770915985, 0.09016788005828857, 0.09017129987478256, 0.09045214205980301, 0.09082050621509552, 0.08981917053461075, 0.08982256799936295, 0.09046583622694016, 0.09717073291540146, 0.0905158743262291, 0.09015215933322906], [0.08993382006883621, 0.08938991278409958, 0.08939667791128159, 0.08995424211025238, 0.09068817645311356, 0.08870004862546921, 0.08870675414800644, 0.08998148143291473, 0.10380919277667999, 0.09008100628852844, 0.08935875445604324], [0.08920484781265259, 0.08831468224525452, 0.08832573145627975, 0.08923833817243576, 0.09044527262449265, 0.08719071000814438, 0.08720161765813828, 0.08928301185369492, 0.11308567970991135, 0.08944634348154068, 0.08826377987861633], [0.09102294594049454, 0.09109407663345337, 0.09109319001436234, 0.09102027863264084, 0.09092509001493454, 0.09118499606847763, 0.091184101998806, 0.0910167321562767, 0.0893566682934761, 0.09100378304719925, 0.09109815955162048], [0.09101761877536774, 0.09108538180589676, 0.0910845398902893, 0.09101508557796478, 0.09092439711093903, 0.0911720022559166, 0.09117115288972855, 0.09101171046495438, 0.08942948281764984, 0.09099936485290527, 0.09108927845954895], [0.08990799635648727, 0.08935105055570602, 0.08935797959566116, 0.08992891013622284, 0.0906805694103241, 0.08864477276802063, 0.088651642203331, 0.08995680510997772, 0.10414241254329681, 0.09005872905254364, 0.08931914716959], [0.06399650126695633, 0.05931727588176727, 0.05937350168824196, 0.06417862325906754, 0.07104955613613129, 0.05383531376719475, 0.05388633534312248, 0.06442226469516754, 0.3855617642402649, 0.06531988829374313, 0.05905896797776222], [0.08981285244226456, 0.08920839428901672, 0.08921590447425842, 0.08983555436134338, 0.09065187722444534, 0.08844231069087982, 0.08844976872205734, 0.08986583352088928, 0.10536729544401169, 0.08997649699449539, 0.08917377144098282], [0.09047502279281616, 0.09021960943937302, 0.0902227908372879, 0.0904846042394638, 0.09082791209220886, 0.08989445120096207, 0.08989761769771576, 0.09049736708402634, 0.09673170000314713, 0.09054400771856308, 0.09020495414733887]], [[0.09101855009794235, 0.09171441942453384, 0.09023284912109375, 0.09023786336183548, 0.09172971546649933, 0.09119384735822678, 0.09078831225633621, 0.09079335629940033, 0.0917501226067543, 0.09026797860860825, 0.09027299284934998], [0.09113817662000656, 0.0926317349076271, 0.08946726471185684, 0.08947788923978806, 0.09266472607851028, 0.09151320159435272, 0.09064682573080063, 0.09065758436918259, 0.09270872175693512, 0.08954162150621414, 0.08955225348472595], [0.0908765122294426, 0.09067518264055252, 0.09110623598098755, 0.09110476076602936, 0.09067077934741974, 0.09082560986280441, 0.09094356745481491, 0.09094209223985672, 0.09066490828990936, 0.09109590947628021, 0.09109443426132202], [0.09087745100259781, 0.09068183600902557, 0.09110063314437866, 0.09109920263290405, 0.09067755937576294, 0.09082799404859543, 0.09094259142875671, 0.0909411609172821, 0.0906718522310257, 0.0910906046628952, 0.09108916670084], [0.0911407396197319, 0.09265187382698059, 0.08945051580667496, 0.08946125954389572, 0.09268524497747421, 0.09152014553546906, 0.09064366668462753, 0.09065455198287964, 0.09272976964712143, 0.0895257219672203, 0.08953647315502167], [0.09104923158884048, 0.09194577485322952, 0.09003929793834686, 0.0900457426905632, 0.09196551144123077, 0.09127489477396011, 0.09075301885604858, 0.0907595083117485, 0.09199182689189911, 0.09008439630270004, 0.09009084105491638], [0.09097769856452942, 0.09141025692224503, 0.09048780053853989, 0.09049093723297119, 0.0914197489619255, 0.09108678251504898, 0.09083430469036102, 0.09083744883537292, 0.09143241494894028, 0.09050973504781723, 0.09051287174224854], [0.09097860753536224, 0.09141691774129868, 0.090482197701931, 0.09048537909984589, 0.0914265438914299, 0.09108913689851761, 0.09083329886198044, 0.09083648771047592, 0.0914393812417984, 0.09050442278385162, 0.09050760418176651], [0.09114415943622589, 0.0926787257194519, 0.08942818641662598, 0.08943908661603928, 0.09271262586116791, 0.09152941405773163, 0.09063946455717087, 0.0906505137681961, 0.09275784343481064, 0.08950452506542206, 0.08951544016599655], [0.09088301658630371, 0.0907217264175415, 0.09106697887182236, 0.09106579422950745, 0.09071818739175797, 0.09084223955869675, 0.09093672037124634, 0.09093554317951202, 0.0907134860754013, 0.09105870872735977, 0.09105753153562546], [0.09088394790887833, 0.09072837978601456, 0.09106137603521347, 0.09106023609638214, 0.09072497487068176, 0.09084462374448776, 0.09093575179576874, 0.09093461185693741, 0.09072043001651764, 0.09105340391397476, 0.09105226397514343]], [[0.09030231833457947, 0.08709987998008728, 0.08711062371730804, 0.09033572673797607, 0.09034686535596848, 0.08714284747838974, 0.08830397576093674, 0.08920285105705261, 0.11259175091981888, 0.08936363458633423, 0.0881994441151619], [0.09094220399856567, 0.09125136584043503, 0.09125030785799026, 0.09093903750181198, 0.09093798696994781, 0.09124713391065598, 0.09113368391990662, 0.09104697406291962, 0.08907591551542282, 0.09103156626224518, 0.09114383161067963], [0.09094095975160599, 0.09123781323432922, 0.09123679995536804, 0.09093792736530304, 0.09093690663576126, 0.0912337526679039, 0.09112482517957687, 0.09104155749082565, 0.0891481265425682, 0.09102676808834076, 0.09113456308841705], [0.09029272943735123, 0.08705540001392365, 0.08706625550985336, 0.09032650291919708, 0.09033776819705963, 0.08709882199764252, 0.08827245235443115, 0.08918113261461258, 0.11285843700170517, 0.08934367448091507, 0.08816679567098618], [0.09028951078653336, 0.08704055845737457, 0.08705145120620728, 0.09032341837882996, 0.09033471345901489, 0.08708413690328598, 0.0882619321346283, 0.08917388319969177, 0.11294744908809662, 0.08933701366186142, 0.08815590292215347], [0.09093718975782394, 0.09119712561368942, 0.09119623154401779, 0.09093452990055084, 0.09093364328145981, 0.09119357168674469, 0.09109819680452347, 0.09102529287338257, 0.08936507254838943, 0.09101233631372452, 0.09110672771930695], [0.09076567739248276, 0.08971653133630753, 0.08972009271383286, 0.0907764881849289, 0.0907800942659378, 0.08973077684640884, 0.09011401981115341, 0.09040836244821548, 0.09744744002819061, 0.09046080708503723, 0.090079665184021], [0.09058400988578796, 0.0885503813624382, 0.08855724334716797, 0.09060508012771606, 0.09061210602521896, 0.08857783675193787, 0.08931820839643478, 0.08988888561725616, 0.10406377911567688, 0.08999073505401611, 0.08925170451402664], [0.07022439688444138, 0.053210072219371796, 0.053260501474142075, 0.07042425125837326, 0.0704909935593605, 0.05341207608580589, 0.05913034453988075, 0.06391580402851105, 0.3825305104255676, 0.06480635702610016, 0.05859466269612312], [0.09054692834615707, 0.08833993226289749, 0.08834736794233322, 0.09056982398033142, 0.09057745337486267, 0.0883697047829628, 0.08917270600795746, 0.08979205042123795, 0.1052807867527008, 0.08990263193845749, 0.08910056203603745], [0.09078402072191238, 0.0898510068655014, 0.0898541659116745, 0.09079361706972122, 0.0907968208193779, 0.08986368030309677, 0.0902046337723732, 0.09046639502048492, 0.0966985896229744, 0.09051301330327988, 0.09017407149076462]]]}, "num_training_step_calls_per_iteration": 1, "evaluation": {"env_runners": {"module_to_env_connector": {"timers": {"connectors": {"tensor_to_numpy": 1.4868777755501789e-05, "un_batch_to_individual_items": 6.508341903729416e-06, "get_actions": 3.548913166266222e-05, "listify_data_for_vector_env": 1.028022163932802e-05, "normalize_and_clip_actions": 7.943254366482032e-06, "remove_single_ts_time_rank_from_batch": 1.18068825294539e-05}}, "connector_pipeline_timer": 0.00011300007426778064}, "episode_len_min": 20, "num_env_steps_sampled": 400, "weights_seq_no": 12.0, "episode_len_mean": 20.0, "env_to_module_sum_episodes_length_out": 10.368238394574323, "episode_len_max": 20, "env_to_module_connector": {"timers": {"connectors": {"batch_individual_items": 1.2245137506458253e-05, "add_observations_from_episodes_to_batch": 2.8126412833784695e-06, "add_states_from_episodes_to_batch": 2.7604491365758924e-06, "add_time_dim_to_batch_and_zero_pad": 6.792816569202012e-06, "numpy_to_tensor": 1.1856105189476681e-05}}, "connector_pipeline_timer": 5.830012866847783e-05}, "env_to_module_sum_episodes_length_in": 10.368238394574323, "num_episodes_lifetime": 240, "episode_duration_sec_mean": 0.005546313736122101, "episode_return_max": 12.5, "rlmodule_inference_timer": 3.0444997800057336e-05, "num_agent_steps_sampled": {"default_agent": 400}, "num_module_steps_sampled_lifetime": {"default_policy": 4800}, "num_agent_steps_sampled_lifetime": {"default_agent": 4800}, "num_module_steps_sampled": {"default_policy": 400}, "sample": 0.13175820847905823, "episode_return_mean": 1.4, "env_step_timer": 1.3738551218464863e-05, "agent_episode_returns_mean": {"default_agent": 1.4}, "num_episodes": 20, "module_episode_returns_mean": {"default_policy": 1.4}, "episode_return_min": -12.5, "num_env_steps_sampled_lifetime": 60400, "env_reset_timer": 0.0005643389868671578, "time_between_sampling": 12.379100895870485}, "num_healthy_workers": 1, "actor_manager_num_outstanding_async_reqs": 0, "num_remote_worker_restarts": 0}, "num_env_steps_sampled_lifetime": -6165000.0, "fault_tolerance": {"num_healthy_workers": 0, "num_remote_worker_restarts": 0}, "env_runner_group": {"actor_manager_num_outstanding_async_reqs": 0}, "done": false, "training_iteration": 12, "trial_id": "ae8a2_00000", "date": "2025-08-11_18-24-42", "timestamp": 1754929482, "time_this_iter_s": 10.417648792266846, "time_total_s": 135.32092022895813, "pid": 10870, "hostname": "Mac", "node_ip": "127.0.0.1", "config": {"exploration_config": {}, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 2, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "env": "Umbrella", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": false, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 0, "create_local_env_runner": true, "num_envs_per_env_runner": 1, "gym_env_vectorize_mode": "SYNC", "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "episodes_to_numpy": true, "max_requests_in_flight_per_env_runner": 1, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "merge_env_runner_states": "training_only", "broadcast_env_runner_states": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "complete_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "sampler_perf_stats_ema_coef": null, "_is_online": true, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": "auto", "num_aggregator_actors_per_learner": 0, "max_requests_in_flight_per_aggregator_actor": 3, "local_gpu_idx": 0, "max_requests_in_flight_per_learner": 3, "gamma": 1, "lr": 0.0002715581955, "grad_clip": 0.5, "grad_clip_by": "global_norm", "_train_batch_size_per_learner": 5000, "train_batch_size": 4000, "num_epochs": 1, "minibatch_size": 1000, "shuffle_batch_per_epoch": true, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "log_std_clip_param": 20.0, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "_disable_preprocessor_api": false, "_disable_action_flattening": false}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {"intrinsic_reward_coeff": 0.2795015916508}, "optimizer": {}, "_learner_class": "<class 'source.intrinsic_attention_ppo.learners.IntrinsicAttentionMetaLearner.IntrinsicAttentionMetaLearner'>", "callbacks_on_algorithm_init": null, "callbacks_on_env_runners_recreated": null, "callbacks_on_offline_eval_runners_recreated": null, "callbacks_on_checkpoint_loaded": null, "callbacks_on_environment_created": null, "callbacks_on_episode_created": null, "callbacks_on_episode_start": null, "callbacks_on_episode_step": null, "callbacks_on_episode_end": null, "callbacks_on_evaluate_start": null, "callbacks_on_evaluate_end": null, "callbacks_on_evaluate_offline_start": null, "callbacks_on_evaluate_offline_end": null, "callbacks_on_sample_end": null, "callbacks_on_train_result": null, "explore": true, "enable_rl_module_and_learner": true, "enable_env_runner_and_connector_v2": true, "_prior_exploration_config": {"type": "StochasticSampling"}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x38844d8a0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "offline_data_class": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_read_batch_size": null, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "materialize_data": false, "materialize_mapped_data": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "ignore_final_observation": false, "prelearner_class": null, "prelearner_buffer_class": null, "prelearner_buffer_kwargs": {}, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_remaining_data": false, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": 1, "evaluation_duration": 20, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_auto_duration_min_env_steps_per_sample": 100, "evaluation_auto_duration_max_env_steps_per_sample": 2000, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 1, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "offline_evaluation_interval": null, "num_offline_eval_runners": 0, "offline_loss_for_module_fn": null, "offline_evaluation_duration": 1, "offline_evaluation_parallel_to_training": false, "offline_evaluation_timeout_s": 120.0, "num_cpus_per_offline_eval_runner": 1, "num_gpus_per_offline_eval_runner": 0, "custom_resources_per_offline_eval_runner": {}, "restart_failed_offline_eval_runners": true, "ignore_offline_eval_runner_failures": false, "max_num_offline_eval_runner_restarts": 1000, "offline_eval_runner_restore_timeout_s": 1800.0, "max_requests_in_flight_per_offline_eval_runner": 1, "validate_offline_eval_runners_after_construction": true, "offline_eval_runner_health_probe_timeout_s": 30.0, "offline_eval_rl_module_inference_only": false, "broadcast_offline_eval_runner_states": false, "offline_eval_batch_size_per_runner": 256, "dataset_num_iters_per_eval_runner": 1, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "log_gradients": false, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 1, "restart_failed_env_runners": true, "ignore_env_runner_failures": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30.0, "env_runner_restore_timeout_s": 1800.0, "_model_config": {}, "_rl_module_spec": "MultiRLModuleSpec(multi_rl_module_class=<class 'ray.rllib.core.rl_module.multi_rl_module.MultiRLModule'>, observation_space=None, action_space=None, inference_only=False, model_config=None, rl_module_specs={'default_policy': RLModuleSpec(module_class=<class 'source.intrinsic_attention_ppo.rl_modules.DifferentiablePPOModule.DifferentiablePPOModule'>, observation_space=None, action_space=None, inference_only=False, learner_only=False, model_config={'vf_share_layers': True, 'embedding_dim': 62, 'max_seq_len': 11, 'policy_head_hidden_sizes': [32], 'value_head_hidden_sizes': [101], 'embedding_hidden_sizes': [121]}, catalog_class=None, load_state_path=None, model_config_dict=None), 'intrinsic_reward_module': RLModuleSpec(module_class=<class 'source.intrinsic_attention_ppo.rl_modules.IntrinsicAttentionModule.IntrinsicAttentionModule'>, observation_space=None, action_space=None, inference_only=False, learner_only=True, model_config={'intrinsic_reward_network': {'encoder_hidden_sizes': [], 'encoding_dim': 1, 'num_heads': 1, 'head_hidden_sizes': None, 'layers': [{'type': 'attention'}]}, 'extrinsic_value_hidden_layers': [127, 60], 'vf_share_layers': True, 'max_seq_len': 11}, catalog_class=None, load_state_path=None, model_config_dict=None)}, load_state_path=None, modules_to_load=None, module_specs={'default_policy': RLModuleSpec(module_class=<class 'source.intrinsic_attention_ppo.rl_modules.DifferentiablePPOModule.DifferentiablePPOModule'>, observation_space=None, action_space=None, inference_only=False, learner_only=False, model_config={'vf_share_layers': True, 'embedding_dim': 62, 'max_seq_len': 11, 'policy_head_hidden_sizes': [32], 'value_head_hidden_sizes': [101], 'embedding_hidden_sizes': [121]}, catalog_class=None, load_state_path=None, model_config_dict=None), 'intrinsic_reward_module': RLModuleSpec(module_class=<class 'source.intrinsic_attention_ppo.rl_modules.IntrinsicAttentionModule.IntrinsicAttentionModule'>, observation_space=None, action_space=None, inference_only=False, learner_only=True, model_config={'intrinsic_reward_network': {'encoder_hidden_sizes': [], 'encoding_dim': 1, 'num_heads': 1, 'head_hidden_sizes': None, 'layers': [{'type': 'attention'}]}, 'extrinsic_value_hidden_layers': [127, 60], 'vf_share_layers': True, 'max_seq_len': 11}, catalog_class=None, load_state_path=None, model_config_dict=None)})", "algorithm_config_overrides_per_module": {"intrinsic_reward_module": {"lr": 0.0002715581955}}, "_per_module_overrides": {}, "_validate_config": true, "_use_msgpack_checkpoints": false, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "env_task_fn": -1, "enable_connectors": -1, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.161583927863, "kl_target": 0.0201019014258, "vf_loss_coeff": 0.7790510010087, "entropy_coeff": 0.0015431216992, "clip_param": 0.2459212356676, "vf_clip_param": 0.3769744131561, "entropy_coeff_schedule": null, "lr_schedule": null, "sgd_minibatch_size": -1, "vf_share_layers": -1, "differentiable_learner_configs": ["DifferentiableLearnerConfig(learner_class=<class 'source.intrinsic_attention_ppo.learners.IntrinsicAttentionPPOLearner.IntrinsicAttentionPPOLearner'>, learner_connector=None, add_default_connectors_to_learner_pipeline=True, is_multi_agent=False, policies_to_update=['default_policy'], lr=0.0060984166342, num_total_minibatches=0, num_epochs=1, minibatch_size=1000, shuffle_batch_per_epoch=True)"], "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9485408017724, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.callbacks.callbacks.RLlibCallback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 135.32092022895813, "iterations_since_restore": 12, "perf": {"cpu_util_percent": 49.446666666666665, "ram_util_percent": 78.86}}
{"timers": {"training_iteration": 12.4370078331108, "restore_env_runners": 1.2138898626750895e-05, "training_step": 12.436807382927109, "env_runner_sampling_timer": 2.8160311047525655, "learner_update_timer": 9.404357967715494, "synch_weights": 0.0016364944681274728, "restore_eval_env_runners": 5.230795719069669e-05, "evaluation_iteration": 0.14360647429148016, "synch_eval_env_connectors": 0.00022482731536939093, "synch_env_connectors": 6.021088807867592e-06}, "env_runners": {"module_to_env_connector": {"connector_pipeline_timer": 0.00011863124595312517, "timers": {"connectors": {"remove_single_ts_time_rank_from_batch": 1.1980105923594966e-05, "un_batch_to_individual_items": 6.565671058189618e-06, "get_actions": 3.9349374454215796e-05, "tensor_to_numpy": 1.51566884064127e-05, "listify_data_for_vector_env": 1.0602081235248347e-05, "normalize_and_clip_actions": 8.01129614176324e-06}}}, "rlmodule_inference_timer": 3.174444728565697e-05, "sample": 0.006159010453656104, "weights_seq_no": 12.0, "num_agent_steps_sampled": {"default_agent": 5000.0}, "episode_len_mean": 20.0, "episode_len_max": 20, "env_to_module_connector": {"timers": {"connectors": {"batch_individual_items": 1.255931901025685e-05, "add_states_from_episodes_to_batch": 2.7834576281803233e-06, "numpy_to_tensor": 1.2628506704921536e-05, "add_observations_from_episodes_to_batch": 2.8107853241907615e-06, "add_time_dim_to_batch_and_zero_pad": 6.934046107396569e-06}}, "connector_pipeline_timer": 6.0206829963531684e-05}, "env_to_module_sum_episodes_length_out": 10.36823839457432, "num_agent_steps_sampled_lifetime": {"default_agent": -6782500.0}, "episode_return_mean": 1.8199999999999996, "num_module_steps_sampled_lifetime": {"default_policy": -6782500.0}, "num_episodes": 250.0, "time_between_sampling": 0.035350857046572835, "num_env_steps_sampled_lifetime": -6782500.0, "episode_return_min": -10.5, "env_reset_timer": 4.237057435794343e-05, "env_to_module_sum_episodes_length_in": 10.36823839457432, "num_episodes_lifetime": -339125.0, "agent_episode_returns_mean": {"default_agent": 1.8199999999999996}, "episode_len_min": 20, "episode_duration_sec_mean": 0.005312630857806652, "env_step_timer": 1.4119280421237702e-05, "episode_return_max": 9.5, "num_module_steps_sampled": {"default_policy": 5000.0}, "module_episode_returns_mean": {"default_policy": 1.8199999999999996}, "num_env_steps_sampled": 5000.0, "num_env_steps_sampled_lifetime_throughput": 3209.861527720362}, "__all_modules__": {"learner_connector_sum_episodes_length_in": 5000.0, "learner_connector": {"connector_pipeline_timer": 0.16040334526731123, "timers": {"connectors": {"add_one_ts_to_episodes_and_truncate": 0.009339731458138085, "add_observations_from_episodes_to_batch": 0.0016020222101351476, "add_columns_from_episodes_to_train_batch": 0.04930758638048733, "add_time_dim_to_batch_and_zero_pad": 0.08483497573586302, "add_states_from_episodes_to_batch": 0.008666365594113783, "batch_individual_items": 0.0063136532438549785, "numpy_to_tensor": 9.51654673736659e-05}}}, "learner_connector_sum_episodes_length_out": 5250.0}, "learners": {"default_policy": {"curr_entropy_coeff": 0.0015431216992, "curr_kl_coeff": 1.9724600861081854e-05, "num_module_steps_trained_lifetime": 77805, "entropy": 0.6829573512077332, "num_module_steps_trained": 5985, "diff_num_grad_updates_vs_sampler_policy": 1.0, "vf_loss": 0.358316570520401, "vf_loss_unclipped": 42.734893798828125, "policy_loss": 7.957401976455003e-05, "use_intrinsic_rewards": 0.0, "total_loss": 0.2781725823879242, "vf_explained_var": -0.0008312463760375977, "mean_kl_loss": 2.956272874143906e-05, "weights_seq_no": 13.0, "num_trainable_parameters": 16595, "module_train_batch_size_mean": 997.7269395717314, "num_module_steps_trained_lifetime_throughput": 728.0280382893936}, "intrinsic_reward_module": {"num_module_steps_trained_lifetime": 77805, "num_module_steps_trained": 5985, "diff_num_grad_updates_vs_sampler_policy": 1.0, "total_loss": 0.0, "gradients_default_optimizer_global_norm": 0.0, "module_train_batch_size_mean": 997.7269395717314, "default_optimizer_learning_rate": 0.0002715581955, "weights_seq_no": 13.0, "num_trainable_parameters": 8266, "curr_entropy_coeff": 0.0015431216992, "num_module_steps_trained_lifetime_throughput": 728.0359575601307}, "differentiable_learners": {"intrinsic_attention_ppo_learner": {"default_policy": {"weights_seq_no": 78.0, "num_module_steps_trained": 35910, "num_module_steps_trained_lifetime": 466830, "entropy": 0.6829493045806885, "diff_num_grad_updates_vs_sampler_policy": 66.0, "vf_loss": 0.3584583103656769, "vf_loss_unclipped": 42.95648956298828, "total_loss": 0.2782894968986511, "mean_kl_loss": 3.0003580832271837e-05, "policy_loss": 8.12449652585201e-05, "use_intrinsic_rewards": 1.0, "module_train_batch_size_mean": 997.5020416990191, "vf_explained_var": -0.0016993284225463867}, "__all_modules__": {"num_env_steps_trained": 198000, "num_module_steps_trained": 71820, "num_module_steps_trained_lifetime": 933660, "num_env_steps_trained_lifetime": 2574000, "num_env_steps_trained_lifetime_throughput": 35059.56179177834}, "intrinsic_reward_module": {"weights_seq_no": 78.0, "num_module_steps_trained_lifetime": 466830, "num_module_steps_trained": 35910, "diff_num_grad_updates_vs_sampler_policy": 66.0, "total_loss": 0.0, "module_train_batch_size_mean": 997.5020416990191}}}, "__all_modules__": {"num_env_steps_trained_lifetime": 429000, "num_non_trainable_parameters": 0, "num_trainable_parameters": 24861, "num_env_steps_trained": 33000, "num_module_steps_trained": 11970, "num_module_steps_trained_lifetime": 155610, "num_env_steps_trained_lifetime_throughput": 4015.500756450098, "num_module_steps_trained_throughput": 21798887.767317805, "num_module_steps_trained_lifetime_throughput": 12629998.001983583}, "IntrinsicAttentionMask": [[[0.09096983820199966, 0.0911247655749321, 0.09071953594684601, 0.09018956869840622, 0.0916806235909462, 0.0916857197880745, 0.09020461142063141, 0.09074476361274719, 0.09170101583003998, 0.0902196615934372, 0.09075990319252014], [0.09098468720912933, 0.09117895364761353, 0.09067101031541824, 0.09000758826732635, 0.09187661856412888, 0.09188302606344223, 0.09002640843391418, 0.0907026156783104, 0.0919022411108017, 0.09004523605108261, 0.09072158485651016], [0.09094531834125519, 0.09103661775588989, 0.09079768508672714, 0.09048453718423843, 0.09136365354061127, 0.09136664867401123, 0.09049344062805176, 0.0908125713467598, 0.09137563407421112, 0.09050233662128448, 0.09082149714231491], [0.0908912792801857, 0.09084753692150116, 0.09096216410398483, 0.09111306816339493, 0.09069136530160904, 0.09068993479013443, 0.0911087691783905, 0.09095500409603119, 0.0906856581568718, 0.09110446274280548, 0.09095071256160736], [0.09103598445653915, 0.0913710668683052, 0.0904960185289383, 0.08935843408107758, 0.0925787165760994, 0.09258983284235, 0.08939062058925629, 0.09055036306381226, 0.09262318909168243, 0.08942282199859619, 0.09058297425508499], [0.09103643894195557, 0.09137281030416489, 0.09049440175294876, 0.08935250341892242, 0.09258514642715454, 0.09259630739688873, 0.08938481658697128, 0.09054895490407944, 0.09262979030609131, 0.08941713720560074, 0.09058169275522232], [0.09089286625385284, 0.09085296094417572, 0.09095752239227295, 0.09109515696763992, 0.09071047604084015, 0.09070917963981628, 0.09109123796224594, 0.09095099568367004, 0.0907052755355835, 0.09108731895685196, 0.09094707667827606], [0.09094782173633575, 0.09104553610086441, 0.09078982472419739, 0.09045476466417313, 0.09139561653137207, 0.09139882773160934, 0.0904642790555954, 0.09080575406551361, 0.09140844643115997, 0.09047380834817886, 0.09081531316041946], [0.0910378098487854, 0.09137804061174393, 0.09048957377672195, 0.08933472633361816, 0.09260444343090057, 0.09261573106050491, 0.08936740458011627, 0.09054473787546158, 0.09264960885047913, 0.08940009027719498, 0.0905778557062149], [0.0908944308757782, 0.09085836261510849, 0.09095285832881927, 0.09107723087072372, 0.09072957932949066, 0.09072840213775635, 0.09107368439435959, 0.09094695746898651, 0.090724878013134, 0.09107014536857605, 0.09094341844320297], [0.09094931930303574, 0.091050885617733, 0.09078510105609894, 0.0904368907213211, 0.09141479432582855, 0.09141812473535538, 0.09044678509235382, 0.0908016636967659, 0.09142813086509705, 0.09045668691396713, 0.0908115953207016]], [[0.08982481807470322, 0.08929146081209183, 0.08859512954950333, 0.09055772423744202, 0.09056445211172104, 0.08861488103866577, 0.08932464569807053, 0.0905846431851387, 0.1034121885895729, 0.08996914327144623, 0.08926089853048325], [0.09038262814283371, 0.09011214226484299, 0.08975780755281448, 0.09075300395488739, 0.09075640141963959, 0.08976787328720093, 0.09012898802757263, 0.09076658636331558, 0.09702234715223312, 0.09045568108558655, 0.0900966227054596], [0.09105848520994186, 0.09113973379135132, 0.09124664962291718, 0.09094773977994919, 0.090946726500988, 0.09124360233545303, 0.09113465994596481, 0.09094369411468506, 0.08915775269269943, 0.0910365954041481, 0.09114440530538559], [0.08899982273578644, 0.08811495453119278, 0.08696510642766953, 0.09022156149148941, 0.09023281931877136, 0.0869976282119751, 0.08816990256309509, 0.09026656299829483, 0.1127273216843605, 0.08923988044261932, 0.08806436508893967], [0.0889919325709343, 0.08810389786958694, 0.08694995939731598, 0.09021811187267303, 0.09022939950227737, 0.0869826078414917, 0.08815903216600418, 0.09026326984167099, 0.11281576752662659, 0.08923285454511642, 0.08805312216281891], [0.09104011952877045, 0.09111125767230988, 0.09120486676692963, 0.09094313532114029, 0.09094224870204926, 0.09120219945907593, 0.09110681712627411, 0.09093958884477615, 0.08937352895736694, 0.09102094918489456, 0.09111534804105759], [0.09034894406795502, 0.09006194770336151, 0.08968603610992432, 0.09074202924966812, 0.09074563533067703, 0.0896967202425003, 0.09007982164621353, 0.09075644612312317, 0.09741045534610748, 0.09042646735906601, 0.09004547446966171], [0.08896821737289429, 0.08807066082954407, 0.08690451830625534, 0.09020769596099854, 0.09021911025047302, 0.08693750947713852, 0.08812639117240906, 0.09025335311889648, 0.11308147013187408, 0.08921173959970474, 0.08801934868097305], [0.06313441693782806, 0.05851823464035988, 0.052959393709897995, 0.07002610713243484, 0.07009246945381165, 0.05311011150479317, 0.058796051889657974, 0.07029195129871368, 0.38036787509918213, 0.06443997472524643, 0.058263398706912994], [0.08966777473688126, 0.08906429260969162, 0.08827713876962662, 0.09049782902002335, 0.090505450963974, 0.0882994532585144, 0.08910182118415833, 0.09052833169698715, 0.10519709438085556, 0.0898311585187912, 0.08902972936630249], [0.09041351079940796, 0.09015826880931854, 0.08982381969690323, 0.09076295793056488, 0.09076616168022156, 0.0898333266377449, 0.09017416834831238, 0.09077576547861099, 0.09666593372821808, 0.0904824510216713, 0.09014362096786499]], [[0.09210992604494095, 0.09211955964565277, 0.09033997356891632, 0.0893499031662941, 0.09214846789836884, 0.09215810894966125, 0.08937793970108032, 0.08938729017972946, 0.09218702465295792, 0.090406134724617, 0.0904155895113945], [0.09211521595716476, 0.09212489426136017, 0.09033744037151337, 0.08934306353330612, 0.09215392917394638, 0.09216360747814178, 0.0893712267279625, 0.08938061445951462, 0.09219265729188919, 0.09040389209985733, 0.09041339159011841], [0.09112903475761414, 0.09113077819347382, 0.09080574661493301, 0.09062263369560242, 0.09113601595163345, 0.09113776683807373, 0.09062784910202026, 0.09062958508729935, 0.09114300459623337, 0.09081792086362839, 0.09081965684890747], [0.09057199209928513, 0.09056933224201202, 0.09106671810150146, 0.09134890884160995, 0.09056135267019272, 0.09055870026350021, 0.09134086221456528, 0.09133818000555038, 0.09055072069168091, 0.09104800969362259, 0.0910453349351883], [0.09213107824325562, 0.09214088320732117, 0.0903298482298851, 0.08932255208492279, 0.09217030555009842, 0.09218011796474457, 0.08935107290744781, 0.08936058729887009, 0.09220955520868301, 0.09039716422557831, 0.09040679037570953], [0.09213637560606003, 0.09214622527360916, 0.09032732248306274, 0.08931571990251541, 0.09217577427625656, 0.09218563139438629, 0.08934436738491058, 0.08935391902923584, 0.09221519529819489, 0.09039493650197983, 0.09040459990501404], [0.09058784693479538, 0.09058530628681183, 0.09105931967496872, 0.09132818877696991, 0.09057770669460297, 0.09057517349720001, 0.09132052212953568, 0.09131796658039093, 0.09056756645441055, 0.09104148298501968, 0.09103893488645554], [0.0905931293964386, 0.09059063345193863, 0.09105685353279114, 0.09132128208875656, 0.09058315306901932, 0.09058066457509995, 0.09131374210119247, 0.09131123125553131, 0.09057318419218063, 0.09103930741548538, 0.09103680402040482], [0.09215223044157028, 0.09216220676898956, 0.09031970798969269, 0.08929520100355148, 0.092192143201828, 0.09220212697982788, 0.08932420611381531, 0.08933387696743011, 0.09223207831382751, 0.09038818627595901, 0.09039797633886337], [0.09116604179143906, 0.09116808325052261, 0.09078831225633621, 0.0905744731426239, 0.09117420017719269, 0.09117624908685684, 0.09058055281639099, 0.09058257937431335, 0.09118236601352692, 0.09080253541469574, 0.0908045619726181], [0.09117133170366287, 0.09117341041564941, 0.09078582376241684, 0.09056759625673294, 0.09117966145277023, 0.09118174016475677, 0.09057380259037018, 0.09057587385177612, 0.0911879912018776, 0.09080033749341965, 0.09080240875482559]], [[0.09002607315778732, 0.08949151635169983, 0.08949816972017288, 0.09004613757133484, 0.09076736867427826, 0.088813416659832, 0.08882001787424088, 0.09078759700059891, 0.1028280034661293, 0.08946088701486588, 0.08946088701486588], [0.09048255532979965, 0.09021177142858505, 0.09021514654159546, 0.09049270302057266, 0.09085673838853836, 0.08986712247133255, 0.08987048268318176, 0.09086693078279495, 0.09674406051635742, 0.09019622951745987, 0.09019622951745987], [0.09047707915306091, 0.09020298719406128, 0.09020639955997467, 0.09048736095428467, 0.09085586667060852, 0.08985413610935211, 0.0898575410246849, 0.09086618572473526, 0.09681795537471771, 0.09018725901842117, 0.09018725901842117], [0.09000827372074127, 0.08946391940116882, 0.08947068452835083, 0.09002871066331863, 0.09076325595378876, 0.08877347409725189, 0.08878019452095032, 0.09078386425971985, 0.10306213051080704, 0.0894327312707901, 0.0894327312707901], [0.08933718502521515, 0.08844570070505142, 0.08845677226781845, 0.0893707275390625, 0.09057945013046265, 0.08732005953788757, 0.08733098953962326, 0.090613454580307, 0.11175616085529327, 0.08839473128318787, 0.08839473128318787], [0.09101450443267822, 0.09108562767505646, 0.09108474105596542, 0.09101183712482452, 0.09091666340827942, 0.09117653965950012, 0.09117564558982849, 0.09091400355100632, 0.08944103866815567, 0.09108971059322357, 0.09108971059322357], [0.09100957214832306, 0.09107733517885208, 0.09107648581266403, 0.0910070389509201, 0.09091635793447495, 0.09116394072771072, 0.09116309136152267, 0.09091382473707199, 0.08950991928577423, 0.09108122438192368, 0.09108122438192368], [0.0893174558877945, 0.08841637521982193, 0.08842755854129791, 0.0893513634800911, 0.0905732586979866, 0.08727877587080002, 0.08728981763124466, 0.0906076431274414, 0.11200802773237228, 0.0883648619055748, 0.0883648619055748], [0.06840941309928894, 0.06365694105625153, 0.0637141615152359, 0.06859402358531952, 0.07553938031196594, 0.05806431546807289, 0.058116503059864044, 0.07574322819709778, 0.3413739800453186, 0.06339403986930847, 0.06339403986930847], [0.09050770848989487, 0.09025219827890396, 0.09025537967681885, 0.09051728248596191, 0.09086072444915771, 0.08992692083120346, 0.08993009477853775, 0.09087033569812775, 0.09640428423881531, 0.09023752808570862, 0.09023752808570862], [0.09050770848989487, 0.09025219827890396, 0.09025537967681885, 0.09051728248596191, 0.09086072444915771, 0.08992692083120346, 0.08993009477853775, 0.09087033569812775, 0.09640428423881531, 0.09023752808570862, 0.09023752808570862]], [[0.09116651117801666, 0.09132177382707596, 0.09037952870130539, 0.09092072397470474, 0.09133701026439667, 0.09134209156036377, 0.09039963036775589, 0.09040465950965881, 0.09135732799768448, 0.09095106273889542, 0.09041973948478699], [0.0912315621972084, 0.09142635762691498, 0.09024551510810852, 0.09092336893081665, 0.09144547581672668, 0.09145184606313705, 0.09027068316936493, 0.09027697145938873, 0.09147097170352936, 0.09096140414476395, 0.09029585123062134], [0.09083390980958939, 0.09078891575336456, 0.09106352925300598, 0.09090535342693329, 0.09078450500965118, 0.090783029794693, 0.09105762839317322, 0.09105616062879562, 0.09077862650156021, 0.09089652448892593, 0.09105173498392105], [0.09106314927339554, 0.09115584939718246, 0.09059229493141174, 0.09091626852750778, 0.09116494655609131, 0.09116797894239426, 0.09060434252023697, 0.09060736000537872, 0.0911770686507225, 0.09093441069126129, 0.09061639755964279], [0.09123793244361877, 0.09143660962581635, 0.09023237973451614, 0.09092362225055695, 0.0914561077952385, 0.09146260470151901, 0.09025803953409195, 0.0902644544839859, 0.09148211032152176, 0.09096240997314453, 0.09028369933366776], [0.0912400633096695, 0.09144002944231033, 0.09022800624370575, 0.09092370420694351, 0.09145965427160263, 0.09146619588136673, 0.09025382995605469, 0.09026028960943222, 0.09148582816123962, 0.09096274524927139, 0.09027966111898422], [0.09084247052669525, 0.09080258756875992, 0.09104596078395844, 0.09090578556060791, 0.09079867601394653, 0.09079737961292267, 0.09104073792695999, 0.09103942662477493, 0.09079346805810928, 0.09089796245098114, 0.09103550761938095], [0.09084460884332657, 0.09080599993467331, 0.09104156494140625, 0.09090588986873627, 0.09080221503973007, 0.09080095589160919, 0.09103650599718094, 0.09103523939847946, 0.09079717844724655, 0.0908983126282692, 0.09103144705295563], [0.09124644100666046, 0.0914502814412117, 0.09021487832069397, 0.0909239649772644, 0.09147028625011444, 0.09147696197032928, 0.0902411937713623, 0.09024778008460999, 0.09149697422981262, 0.09096375852823257, 0.09026752412319183], [0.09107592701911926, 0.0911763459444046, 0.09056597948074341, 0.09091682732105255, 0.09118619561195374, 0.09118948131799698, 0.09057902544736862, 0.09058228880167007, 0.09119933098554611, 0.09093647450208664, 0.09059207886457443], [0.09085103124380112, 0.09081626683473587, 0.09102839231491089, 0.09090622514486313, 0.09081285446882248, 0.09081171452999115, 0.09102384001016617, 0.09102270007133484, 0.09080830961465836, 0.09089940041303635, 0.09101928025484085]], [[0.09413344413042068, 0.09115834534168243, 0.09223788231611252, 0.09307253360748291, 0.0930827334523201, 0.09119834005832672, 0.09120833873748779, 0.09420572221279144, 0.07504059374332428, 0.09218119084835052, 0.09248089045286179], [0.09013757854700089, 0.09080582112073898, 0.09056027978658676, 0.09037285298109055, 0.09037057310342789, 0.09079665690660477, 0.09079437702894211, 0.09012167155742645, 0.09496159851551056, 0.09057308733463287, 0.09050550311803818], [0.09163927286863327, 0.09099145233631134, 0.09122839570045471, 0.09141011536121368, 0.09141232818365097, 0.0910002663731575, 0.09100247174501419, 0.09165480732917786, 0.08716345578432083, 0.09121601283550262, 0.09128143638372421], [0.09275901317596436, 0.09108841419219971, 0.09169730544090271, 0.09216594696044922, 0.09217166900634766, 0.09111102670431137, 0.09111668169498444, 0.09279931336641312, 0.08159133046865463, 0.09166540950536728, 0.0918339341878891], [0.09277249127626419, 0.09108936041593552, 0.09170279651880264, 0.0921749547123909, 0.09218072146177292, 0.09111214429140091, 0.09111784398555756, 0.09281309694051743, 0.0815255418419838, 0.09167066216468811, 0.09184045344591141], [0.09019432216882706, 0.09081397950649261, 0.0905863344669342, 0.09041253477334976, 0.09041041880846024, 0.09080548584461212, 0.0908033698797226, 0.09017956256866455, 0.09466023743152618, 0.0905982032418251, 0.09053553640842438], [0.0902084931731224, 0.09081600606441498, 0.09059283137321472, 0.09042243659496307, 0.09042036533355713, 0.09080768376588821, 0.09080560505390167, 0.09019403159618378, 0.09458503127098083, 0.09060446918010712, 0.09054303169250488], [0.09422516822814941, 0.0911610797047615, 0.0922725722193718, 0.09313219040632248, 0.09314270317554474, 0.09120224416255951, 0.09121254086494446, 0.09429965168237686, 0.07461484521627426, 0.0922141894698143, 0.09252282232046127], [0.05814138054847717, 0.0744093731045723, 0.06797531247138977, 0.063430555164814, 0.06337714195251465, 0.07415909320116043, 0.07409664988517761, 0.057799577713012695, 0.33169853687286377, 0.0682971179485321, 0.06661523878574371], [0.0915619283914566, 0.09098344296216965, 0.09119507670402527, 0.09135735034942627, 0.09135932475328445, 0.0909913182258606, 0.09099328517913818, 0.09157580137252808, 0.08755599707365036, 0.09118401259183884, 0.09124244749546051], [0.09196889400482178, 0.09102369844913483, 0.09136906266212463, 0.09163419902324677, 0.09163743257522583, 0.09103654325008392, 0.0910397544503212, 0.0919916033744812, 0.08550144731998444, 0.0913509950041771, 0.0914464220404625]]]}, "num_training_step_calls_per_iteration": 1, "evaluation": {"env_runners": {"module_to_env_connector": {"timers": {"connectors": {"tensor_to_numpy": 1.5418794238486798e-05, "un_batch_to_individual_items": 6.763364396547268e-06, "get_actions": 3.671905910068923e-05, "listify_data_for_vector_env": 1.0291578352201691e-05, "normalize_and_clip_actions": 8.006301433399084e-06, "remove_single_ts_time_rank_from_batch": 1.1971847758479696e-05}}, "connector_pipeline_timer": 0.00011563562773441741}, "episode_len_min": 20, "num_env_steps_sampled": 400, "weights_seq_no": 13.0, "episode_len_mean": 20.0, "env_to_module_sum_episodes_length_out": 10.368238394574323, "episode_len_max": 20, "env_to_module_connector": {"timers": {"connectors": {"batch_individual_items": 1.265738779685452e-05, "add_observations_from_episodes_to_batch": 2.7879223734910785e-06, "add_states_from_episodes_to_batch": 2.7373157001281e-06, "add_time_dim_to_batch_and_zero_pad": 6.804799913440999e-06, "numpy_to_tensor": 1.18757873675454e-05}}, "connector_pipeline_timer": 5.869209100414286e-05}, "env_to_module_sum_episodes_length_in": 10.368238394574323, "num_episodes_lifetime": 260, "episode_duration_sec_mean": 0.005531417079037055, "episode_return_max": 12.5, "rlmodule_inference_timer": 3.173261244546647e-05, "num_agent_steps_sampled": {"default_agent": 400}, "num_module_steps_sampled_lifetime": {"default_policy": 5200}, "num_agent_steps_sampled_lifetime": {"default_agent": 5200}, "num_module_steps_sampled": {"default_policy": 400}, "sample": 0.13155915472496627, "episode_return_mean": 1.4, "env_step_timer": 1.3887258685859718e-05, "agent_episode_returns_mean": {"default_agent": 1.4}, "num_episodes": 20, "module_episode_returns_mean": {"default_policy": 1.4}, "episode_return_min": -12.5, "num_env_steps_sampled_lifetime": 65400, "env_reset_timer": 0.0005594693467783961, "time_between_sampling": 12.346318283582002}, "num_healthy_workers": 1, "actor_manager_num_outstanding_async_reqs": 0, "num_remote_worker_restarts": 0}, "num_env_steps_sampled_lifetime": -6782500.0, "fault_tolerance": {"num_healthy_workers": 0, "num_remote_worker_restarts": 0}, "env_runner_group": {"actor_manager_num_outstanding_async_reqs": 0}, "done": false, "training_iteration": 13, "trial_id": "ae8a2_00000", "date": "2025-08-11_18-24-51", "timestamp": 1754929491, "time_this_iter_s": 9.187901020050049, "time_total_s": 144.50882124900818, "pid": 10870, "hostname": "Mac", "node_ip": "127.0.0.1", "config": {"exploration_config": {}, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 2, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "env": "Umbrella", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": false, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 0, "create_local_env_runner": true, "num_envs_per_env_runner": 1, "gym_env_vectorize_mode": "SYNC", "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "episodes_to_numpy": true, "max_requests_in_flight_per_env_runner": 1, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "merge_env_runner_states": "training_only", "broadcast_env_runner_states": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "complete_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "sampler_perf_stats_ema_coef": null, "_is_online": true, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": "auto", "num_aggregator_actors_per_learner": 0, "max_requests_in_flight_per_aggregator_actor": 3, "local_gpu_idx": 0, "max_requests_in_flight_per_learner": 3, "gamma": 1, "lr": 0.0002715581955, "grad_clip": 0.5, "grad_clip_by": "global_norm", "_train_batch_size_per_learner": 5000, "train_batch_size": 4000, "num_epochs": 1, "minibatch_size": 1000, "shuffle_batch_per_epoch": true, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "log_std_clip_param": 20.0, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "_disable_preprocessor_api": false, "_disable_action_flattening": false}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {"intrinsic_reward_coeff": 0.2795015916508}, "optimizer": {}, "_learner_class": "<class 'source.intrinsic_attention_ppo.learners.IntrinsicAttentionMetaLearner.IntrinsicAttentionMetaLearner'>", "callbacks_on_algorithm_init": null, "callbacks_on_env_runners_recreated": null, "callbacks_on_offline_eval_runners_recreated": null, "callbacks_on_checkpoint_loaded": null, "callbacks_on_environment_created": null, "callbacks_on_episode_created": null, "callbacks_on_episode_start": null, "callbacks_on_episode_step": null, "callbacks_on_episode_end": null, "callbacks_on_evaluate_start": null, "callbacks_on_evaluate_end": null, "callbacks_on_evaluate_offline_start": null, "callbacks_on_evaluate_offline_end": null, "callbacks_on_sample_end": null, "callbacks_on_train_result": null, "explore": true, "enable_rl_module_and_learner": true, "enable_env_runner_and_connector_v2": true, "_prior_exploration_config": {"type": "StochasticSampling"}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x38844d8a0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "offline_data_class": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_read_batch_size": null, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "materialize_data": false, "materialize_mapped_data": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "ignore_final_observation": false, "prelearner_class": null, "prelearner_buffer_class": null, "prelearner_buffer_kwargs": {}, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_remaining_data": false, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": 1, "evaluation_duration": 20, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_auto_duration_min_env_steps_per_sample": 100, "evaluation_auto_duration_max_env_steps_per_sample": 2000, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 1, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "offline_evaluation_interval": null, "num_offline_eval_runners": 0, "offline_loss_for_module_fn": null, "offline_evaluation_duration": 1, "offline_evaluation_parallel_to_training": false, "offline_evaluation_timeout_s": 120.0, "num_cpus_per_offline_eval_runner": 1, "num_gpus_per_offline_eval_runner": 0, "custom_resources_per_offline_eval_runner": {}, "restart_failed_offline_eval_runners": true, "ignore_offline_eval_runner_failures": false, "max_num_offline_eval_runner_restarts": 1000, "offline_eval_runner_restore_timeout_s": 1800.0, "max_requests_in_flight_per_offline_eval_runner": 1, "validate_offline_eval_runners_after_construction": true, "offline_eval_runner_health_probe_timeout_s": 30.0, "offline_eval_rl_module_inference_only": false, "broadcast_offline_eval_runner_states": false, "offline_eval_batch_size_per_runner": 256, "dataset_num_iters_per_eval_runner": 1, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "log_gradients": false, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 1, "restart_failed_env_runners": true, "ignore_env_runner_failures": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30.0, "env_runner_restore_timeout_s": 1800.0, "_model_config": {}, "_rl_module_spec": "MultiRLModuleSpec(multi_rl_module_class=<class 'ray.rllib.core.rl_module.multi_rl_module.MultiRLModule'>, observation_space=None, action_space=None, inference_only=False, model_config=None, rl_module_specs={'default_policy': RLModuleSpec(module_class=<class 'source.intrinsic_attention_ppo.rl_modules.DifferentiablePPOModule.DifferentiablePPOModule'>, observation_space=None, action_space=None, inference_only=False, learner_only=False, model_config={'vf_share_layers': True, 'embedding_dim': 62, 'max_seq_len': 11, 'policy_head_hidden_sizes': [32], 'value_head_hidden_sizes': [101], 'embedding_hidden_sizes': [121]}, catalog_class=None, load_state_path=None, model_config_dict=None), 'intrinsic_reward_module': RLModuleSpec(module_class=<class 'source.intrinsic_attention_ppo.rl_modules.IntrinsicAttentionModule.IntrinsicAttentionModule'>, observation_space=None, action_space=None, inference_only=False, learner_only=True, model_config={'intrinsic_reward_network': {'encoder_hidden_sizes': [], 'encoding_dim': 1, 'num_heads': 1, 'head_hidden_sizes': None, 'layers': [{'type': 'attention'}]}, 'extrinsic_value_hidden_layers': [127, 60], 'vf_share_layers': True, 'max_seq_len': 11}, catalog_class=None, load_state_path=None, model_config_dict=None)}, load_state_path=None, modules_to_load=None, module_specs={'default_policy': RLModuleSpec(module_class=<class 'source.intrinsic_attention_ppo.rl_modules.DifferentiablePPOModule.DifferentiablePPOModule'>, observation_space=None, action_space=None, inference_only=False, learner_only=False, model_config={'vf_share_layers': True, 'embedding_dim': 62, 'max_seq_len': 11, 'policy_head_hidden_sizes': [32], 'value_head_hidden_sizes': [101], 'embedding_hidden_sizes': [121]}, catalog_class=None, load_state_path=None, model_config_dict=None), 'intrinsic_reward_module': RLModuleSpec(module_class=<class 'source.intrinsic_attention_ppo.rl_modules.IntrinsicAttentionModule.IntrinsicAttentionModule'>, observation_space=None, action_space=None, inference_only=False, learner_only=True, model_config={'intrinsic_reward_network': {'encoder_hidden_sizes': [], 'encoding_dim': 1, 'num_heads': 1, 'head_hidden_sizes': None, 'layers': [{'type': 'attention'}]}, 'extrinsic_value_hidden_layers': [127, 60], 'vf_share_layers': True, 'max_seq_len': 11}, catalog_class=None, load_state_path=None, model_config_dict=None)})", "algorithm_config_overrides_per_module": {"intrinsic_reward_module": {"lr": 0.0002715581955}}, "_per_module_overrides": {}, "_validate_config": true, "_use_msgpack_checkpoints": false, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "env_task_fn": -1, "enable_connectors": -1, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.161583927863, "kl_target": 0.0201019014258, "vf_loss_coeff": 0.7790510010087, "entropy_coeff": 0.0015431216992, "clip_param": 0.2459212356676, "vf_clip_param": 0.3769744131561, "entropy_coeff_schedule": null, "lr_schedule": null, "sgd_minibatch_size": -1, "vf_share_layers": -1, "differentiable_learner_configs": ["DifferentiableLearnerConfig(learner_class=<class 'source.intrinsic_attention_ppo.learners.IntrinsicAttentionPPOLearner.IntrinsicAttentionPPOLearner'>, learner_connector=None, add_default_connectors_to_learner_pipeline=True, is_multi_agent=False, policies_to_update=['default_policy'], lr=0.0060984166342, num_total_minibatches=0, num_epochs=1, minibatch_size=1000, shuffle_batch_per_epoch=True)"], "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9485408017724, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.callbacks.callbacks.RLlibCallback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 144.50882124900818, "iterations_since_restore": 13, "perf": {"cpu_util_percent": 38.23076923076923, "ram_util_percent": 78.66923076923078}}
{"timers": {"training_iteration": 12.410347887689397, "restore_env_runners": 1.2077089838041193e-05, "training_step": 12.410147180347714, "env_runner_sampling_timer": 2.803889932454729, "learner_update_timer": 9.390160288458672, "synch_weights": 0.0016307586928562927, "restore_eval_env_runners": 5.196695700289314e-05, "evaluation_iteration": 0.143347853298768, "synch_eval_env_connectors": 0.0002239902916111569, "synch_env_connectors": 6.00087822436865e-06}, "env_runners": {"module_to_env_connector": {"connector_pipeline_timer": 0.00011641596306152545, "timers": {"connectors": {"remove_single_ts_time_rank_from_batch": 1.185938590096711e-05, "un_batch_to_individual_items": 6.4824577224511415e-06, "get_actions": 3.824897561530087e-05, "tensor_to_numpy": 1.4876642434726383e-05, "listify_data_for_vector_env": 1.0340786674782104e-05, "normalize_and_clip_actions": 7.905222556402164e-06}}}, "rlmodule_inference_timer": 5.018231029839003e-05, "sample": 0.00586769293323072, "weights_seq_no": 13.0, "num_agent_steps_sampled": {"default_agent": 5000.0}, "episode_len_mean": 20.0, "episode_len_max": 20, "env_to_module_connector": {"timers": {"connectors": {"batch_individual_items": 1.2337300255646427e-05, "add_states_from_episodes_to_batch": 2.6963971503460407e-06, "numpy_to_tensor": 1.2470183521298194e-05, "add_observations_from_episodes_to_batch": 2.8017162223611913e-06, "add_time_dim_to_batch_and_zero_pad": 6.806747075223877e-06}}, "connector_pipeline_timer": 5.938374236909631e-05}, "env_to_module_sum_episodes_length_out": 10.36823839457432, "num_agent_steps_sampled_lifetime": {"default_agent": -7400000.0}, "episode_return_mean": 1.0999999999999996, "num_module_steps_sampled_lifetime": {"default_policy": -7400000.0}, "num_episodes": 250.0, "time_between_sampling": 0.030909416343987316, "num_env_steps_sampled_lifetime": -7400000.0, "episode_return_min": -10.5, "env_reset_timer": 3.860780163092272e-05, "env_to_module_sum_episodes_length_in": 10.36823839457432, "num_episodes_lifetime": -370000.0, "agent_episode_returns_mean": {"default_agent": 1.0999999999999996}, "episode_len_min": 20, "episode_duration_sec_mean": 0.005560956841334702, "env_step_timer": 1.383587711384706e-05, "episode_return_max": 9.5, "num_module_steps_sampled": {"default_policy": 5000.0}, "module_episode_returns_mean": {"default_policy": 1.0999999999999996}, "num_env_steps_sampled": 5000.0, "num_env_steps_sampled_lifetime_throughput": 3281.914065271554}, "__all_modules__": {"learner_connector_sum_episodes_length_in": 5000.0, "learner_connector": {"connector_pipeline_timer": 0.1601452230641565, "timers": {"connectors": {"add_one_ts_to_episodes_and_truncate": 0.009335544983498803, "add_observations_from_episodes_to_batch": 0.0015947165782554396, "add_columns_from_episodes_to_train_batch": 0.04923422718755883, "add_time_dim_to_batch_and_zero_pad": 0.08473511430878665, "add_states_from_episodes_to_batch": 0.008615315687814571, "batch_individual_items": 0.006293022541477119, "numpy_to_tensor": 9.481381261201239e-05}}}, "learner_connector_sum_episodes_length_out": 5250.0}, "learners": {"default_policy": {"curr_entropy_coeff": 0.0015431216992, "curr_kl_coeff": 9.862300430540927e-06, "num_module_steps_trained_lifetime": 83790, "entropy": 0.6823163628578186, "num_module_steps_trained": 5985, "diff_num_grad_updates_vs_sampler_policy": 1.0, "vf_loss": 0.3583144545555115, "vf_loss_unclipped": 42.793331146240234, "policy_loss": -4.32349115726538e-05, "use_intrinsic_rewards": 0.0, "total_loss": 0.2780490815639496, "vf_explained_var": -0.0005280971527099609, "mean_kl_loss": 8.07630112831248e-06, "weights_seq_no": 14.0, "num_trainable_parameters": 16595, "module_train_batch_size_mean": 997.7135120670981, "num_module_steps_trained_lifetime_throughput": 726.7330885554956}, "intrinsic_reward_module": {"num_module_steps_trained_lifetime": 83790, "num_module_steps_trained": 5985, "diff_num_grad_updates_vs_sampler_policy": 1.0, "total_loss": 0.0, "gradients_default_optimizer_global_norm": 0.0, "module_train_batch_size_mean": 997.7135120670981, "default_optimizer_learning_rate": 0.0002715581955, "weights_seq_no": 14.0, "num_trainable_parameters": 8266, "curr_entropy_coeff": 0.0015431216992, "num_module_steps_trained_lifetime_throughput": 726.7405105827711}, "differentiable_learners": {"intrinsic_attention_ppo_learner": {"default_policy": {"weights_seq_no": 84.0, "num_module_steps_trained": 35910, "num_module_steps_trained_lifetime": 502740, "entropy": 0.6823167204856873, "diff_num_grad_updates_vs_sampler_policy": 71.0, "vf_loss": 0.3584490716457367, "vf_loss_unclipped": 43.01439666748047, "total_loss": 0.27815788984298706, "mean_kl_loss": 8.06462048785761e-06, "policy_loss": -4.0692950278753415e-05, "use_intrinsic_rewards": 1.0, "module_train_batch_size_mean": 997.5006590853257, "vf_explained_var": -0.0016765594482421875}, "__all_modules__": {"num_env_steps_trained": 198000, "num_module_steps_trained": 71820, "num_module_steps_trained_lifetime": 1005480, "num_env_steps_trained_lifetime": 2772000, "num_env_steps_trained_lifetime_throughput": 34941.27023439379}, "intrinsic_reward_module": {"weights_seq_no": 84.0, "num_module_steps_trained_lifetime": 502740, "num_module_steps_trained": 35910, "diff_num_grad_updates_vs_sampler_policy": 71.0, "total_loss": 0.0, "module_train_batch_size_mean": 997.5006590853257}}}, "__all_modules__": {"num_env_steps_trained_lifetime": 462000, "num_non_trainable_parameters": 0, "num_trainable_parameters": 24861, "num_env_steps_trained": 33000, "num_module_steps_trained": 11970, "num_module_steps_trained_lifetime": 167580, "num_env_steps_trained_lifetime_throughput": 4008.3083867033215, "num_module_steps_trained_throughput": 21294308.615155514, "num_module_steps_trained_lifetime_throughput": 12607914.624819027}, "IntrinsicAttentionMask": [[[0.09111712872982025, 0.09127230942249298, 0.09086642414331436, 0.09033559262752533, 0.0912875384092331, 0.0912926122546196, 0.0903506651520729, 0.09035568684339523, 0.09184949100017548, 0.09090179204940796, 0.09037076681852341], [0.09116952121257782, 0.09136418253183365, 0.0908552035689354, 0.09019042551517487, 0.09138328582048416, 0.09138965606689453, 0.09020929038524628, 0.09021557867527008, 0.09208893775939941, 0.09089954197406769, 0.09023444354534149], [0.09103202074766159, 0.09112340211868286, 0.0908842459321022, 0.09057080745697021, 0.09113236516714096, 0.09113535284996033, 0.09057971090078354, 0.09058268368244171, 0.09146274626255035, 0.09090510755777359, 0.09059158712625504], [0.0908498540520668, 0.09080612659454346, 0.09092070162296295, 0.09107153862714767, 0.09080184251070023, 0.09080041199922562, 0.09106723964214325, 0.09106580913066864, 0.09064431488513947, 0.09091068804264069, 0.09106151014566422], [0.0911746397614479, 0.09137317538261414, 0.09085409343242645, 0.09017619490623474, 0.09139266610145569, 0.09139915555715561, 0.0901954248547554, 0.09020183980464935, 0.09211242944002151, 0.09089930355548859, 0.09022106975317001], [0.0911763459444046, 0.0913761779665947, 0.09085371345281601, 0.0901714488863945, 0.0913957878947258, 0.0914023220539093, 0.09019080549478531, 0.09019725769758224, 0.09212026000022888, 0.09089922159910202, 0.09021661430597305], [0.09085506200790405, 0.09081517159938812, 0.09091968834400177, 0.09105727076530457, 0.09081126004457474, 0.09080995619297028, 0.09105335175991058, 0.09105204045772552, 0.09066754579544067, 0.09091055393218994, 0.09104812890291214], [0.09085679054260254, 0.09081818163394928, 0.09091934561729431, 0.09105250984430313, 0.09081439673900604, 0.09081313759088516, 0.0910487174987793, 0.09104745090007782, 0.09067528694868088, 0.09091050922870636, 0.09104365855455399], [0.09136238694190979, 0.09170383960008621, 0.09081219136714935, 0.08965323120355606, 0.09173738211393356, 0.09174856543540955, 0.08968602120876312, 0.0896969586610794, 0.09297993779182434, 0.09088971465826035, 0.08972976356744766], [0.09104406833648682, 0.09114445000886917, 0.09088174998760223, 0.09053756296634674, 0.0911542996764183, 0.09115757793188095, 0.0905473455786705, 0.09055060893297195, 0.09151730686426163, 0.09090466052293777, 0.09056039154529572], [0.09086200594902039, 0.09082723408937454, 0.09091833978891373, 0.09103824943304062, 0.09082382172346115, 0.09082268923521042, 0.09103482961654663, 0.0910336971282959, 0.09069852530956268, 0.09091037511825562, 0.09103027731180191]], [[0.09009511023759842, 0.08804705739021301, 0.08691073209047318, 0.09012844413518906, 0.09013955295085907, 0.08809047937393188, 0.0881013423204422, 0.08899816870689392, 0.11233346164226532, 0.08915857970714569, 0.08799705654382706], [0.09071037918329239, 0.09007992595434189, 0.08972571790218353, 0.09072056412696838, 0.09072394669055939, 0.09009340405464172, 0.09009677171707153, 0.09037396311759949, 0.09698764979839325, 0.0904233381152153, 0.0900644063949585], [0.09096059203147888, 0.09114956855773926, 0.09125649929046631, 0.09095755219459534, 0.09095654636621475, 0.09114550799131393, 0.09114449471235275, 0.09106121957302094, 0.08916734904050827, 0.09104641526937485, 0.09115424007177353], [0.09008330851793289, 0.08801283687353134, 0.08686430752277374, 0.09011700749397278, 0.09012824296951294, 0.08805673569440842, 0.08806771785020828, 0.08897428959608078, 0.11259673535823822, 0.08913645893335342, 0.08796229958534241], [0.09007937461137772, 0.08800142258405685, 0.08684883266687393, 0.09011318534612656, 0.0901244655251503, 0.08804547786712646, 0.08805650472640991, 0.08896632492542267, 0.11268462985754013, 0.08912908285856247, 0.08795071393251419], [0.09069953858852386, 0.0900382250547409, 0.08966676890850067, 0.09071021527051926, 0.09071377664804459, 0.09005235880613327, 0.09005589038133621, 0.09034662693738937, 0.09729622304439545, 0.09039842337369919, 0.09002195298671722], [0.09069681912660599, 0.09002779424190521, 0.08965203166007996, 0.09070762246847153, 0.09071122109889984, 0.09004208445549011, 0.09004566073417664, 0.0903397873044014, 0.09737350791692734, 0.09039217978715897, 0.09001132845878601], [0.09045135229825974, 0.08915283530950546, 0.08842755109071732, 0.09047239273786545, 0.09047940373420715, 0.08918048441410065, 0.08918739855289459, 0.08975724130868912, 0.10391142219305038, 0.08985894173383713, 0.08912099897861481], [0.0694393590092659, 0.05819301679730415, 0.052665065973997116, 0.0696369856595993, 0.06970298290252686, 0.05841393768787384, 0.058469291776418686, 0.06320127844810486, 0.3782566785812378, 0.06408187001943588, 0.05793960765004158], [0.09040313959121704, 0.08899359405040741, 0.08820706605911255, 0.0904259905219078, 0.09043360501527786, 0.08902359008789062, 0.08903109282255173, 0.08964945375919342, 0.10511361807584763, 0.08975985646247864, 0.08895906060934067], [0.09072273224592209, 0.0901278406381607, 0.08979351073503494, 0.09073232859373093, 0.090735524892807, 0.09014055877923965, 0.09014374017715454, 0.09040531516075134, 0.09663331508636475, 0.0904519110918045, 0.09011320024728775]], [[0.09106731414794922, 0.09122240543365479, 0.090281181037426, 0.09082178771495819, 0.09177885949611664, 0.09178396314382553, 0.0903012678027153, 0.09030628949403763, 0.09179927408695221, 0.09031633287668228, 0.09032135456800461], [0.09110677242279053, 0.09130129963159561, 0.09012207388877869, 0.0907989963889122, 0.09199990332126617, 0.09200631082057953, 0.09014719724655151, 0.09015348553657532, 0.09202555567026138, 0.09016605466604233, 0.09017233550548553], [0.09086226671934128, 0.09081725031137466, 0.09109195321798325, 0.09093372523784637, 0.09065656363964081, 0.09065509587526321, 0.09108605235815048, 0.09108457714319229, 0.09065069258213043, 0.09108162671327591, 0.09108015149831772], [0.09100417792797089, 0.09109681844711304, 0.09053362905979156, 0.09085739403963089, 0.09142867475748062, 0.09143171459436417, 0.09054567664861679, 0.09054868668317795, 0.0914408341050148, 0.09055470675230026, 0.09055771678686142], [0.09124568849802017, 0.0915815457701683, 0.08955351263284683, 0.09071536362171173, 0.09279198199510574, 0.09280312061309814, 0.08959653228521347, 0.08960729092359543, 0.09283655136823654, 0.08962880820035934, 0.0896395742893219], [0.09124694019556046, 0.09158409386873245, 0.08954831212759018, 0.09071458131074905, 0.09279923141002655, 0.09281041473150253, 0.08959149569272995, 0.08960229158401489, 0.09284397959709167, 0.08962389826774597, 0.08963469415903091], [0.09086761623620987, 0.09082771837711334, 0.09107115864753723, 0.09093094617128372, 0.09068527817726135, 0.09068397432565689, 0.09106592833995819, 0.09106462448835373, 0.0906800702214241, 0.09106200933456421, 0.09106070548295975], [0.09086894243955612, 0.09083032608032227, 0.09106595069169998, 0.09093023836612701, 0.0906924456357956, 0.09069118648767471, 0.09106089174747467, 0.0910596251487732, 0.09068740904331207, 0.09105709940195084, 0.09105583280324936], [0.0912507101893425, 0.0915917381644249, 0.08953272551298141, 0.09071223437786102, 0.09282100945711136, 0.09283232688903809, 0.08957639336585999, 0.08958730846643448, 0.09286627918481827, 0.08960915356874466, 0.08962008357048035], [0.09087161719799042, 0.0908355638384819, 0.09105555713176727, 0.09092885255813599, 0.09070681035518646, 0.09070563316345215, 0.09105083346366882, 0.09104964882135391, 0.0907021090388298, 0.09104729443788528, 0.09104610979557037], [0.09087294340133667, 0.09083817154169083, 0.09105034917593002, 0.09092815220355988, 0.0907139852643013, 0.09071284532546997, 0.0910457968711853, 0.09104465693235397, 0.09070944786071777, 0.09104237705469131, 0.09104123711585999]], [[0.08995310962200165, 0.08941899240016937, 0.08942563086748123, 0.09068706631660461, 0.08997984975576401, 0.08874144405126572, 0.088748037815094, 0.08999991416931152, 0.1035599336028099, 0.09009764343500137, 0.08938838541507721], [0.090447798371315, 0.09017711877822876, 0.09018048644065857, 0.09081844240427017, 0.09046132862567902, 0.089832603931427, 0.08983595669269562, 0.09047147631645203, 0.09709229320287704, 0.09052090346813202, 0.09016158431768417], [0.09044187515974045, 0.09016788750886917, 0.09017129987478256, 0.09081707149744034, 0.0904555693268776, 0.08981916308403015, 0.08982256799936295, 0.09046584367752075, 0.09717072546482086, 0.0905158668756485, 0.09015215933322906], [0.08921198546886444, 0.08832500874996185, 0.0883360207080841, 0.09043664485216141, 0.08925648778676987, 0.08720501512289047, 0.08721588551998138, 0.08928987383842468, 0.11299612373113632, 0.08945261687040329, 0.08827429264783859], [0.08992737531661987, 0.08938020467758179, 0.08938700705766678, 0.09067937731742859, 0.08995477110147476, 0.08868622779846191, 0.08869297802448273, 0.08997531980276108, 0.10389245301485062, 0.09007544815540314, 0.08934885263442993], [0.09102293848991394, 0.09109407663345337, 0.09109318256378174, 0.09092596918344498, 0.0910193920135498, 0.09118499606847763, 0.091184101998806, 0.0910167321562767, 0.08935663849115372, 0.09100377559661865, 0.09109815955162048], [0.09101762622594833, 0.09108538925647736, 0.0910845473408699, 0.09092524647712708, 0.09101424366235733, 0.09117200970649719, 0.09117116034030914, 0.09101171046495438, 0.08942946046590805, 0.09099936485290527, 0.09108928591012955], [0.08990799635648727, 0.08935105800628662, 0.08935797959566116, 0.0906735435128212, 0.08993588387966156, 0.08864476531744003, 0.0886516347527504, 0.08995679765939713, 0.1041424572467804, 0.09005872905254364, 0.08931914716959], [0.06399673223495483, 0.059317462146282196, 0.059373680502176285, 0.07098256796598434, 0.06423968821763992, 0.053835462778806686, 0.05388648808002472, 0.06442250311374664, 0.38556620478630066, 0.06532011181116104, 0.059059154242277145], [0.08981285244226456, 0.08920838683843613, 0.08921590447425842, 0.0906442403793335, 0.08984312415122986, 0.08844231069087982, 0.08844976872205734, 0.08986583352088928, 0.10536732524633408, 0.08997649699449539, 0.08917377144098282], [0.09047502279281616, 0.09021960198879242, 0.0902227833867073, 0.09082470089197159, 0.09048778563737869, 0.08989444375038147, 0.08989761024713516, 0.09049735963344574, 0.09673170000314713, 0.09054400026798248, 0.09020493924617767]], [[0.09248535335063934, 0.09249503165483475, 0.08970469981431961, 0.09071767330169678, 0.09150047600269318, 0.09151004999876022, 0.09074614197015762, 0.08975161612033844, 0.09153876453638077, 0.08977039903402328, 0.08977978676557541], [0.09249232709407806, 0.09250204265117645, 0.0896994024515152, 0.09071680158376694, 0.09150306135416031, 0.09151267260313034, 0.09074538946151733, 0.08974652737379074, 0.09154151380062103, 0.08976537734270096, 0.08977481722831726], [0.09046244621276855, 0.09045974910259247, 0.0912533700466156, 0.09096163511276245, 0.09073904901742935, 0.09073633700609207, 0.09095349907875061, 0.09123975783586502, 0.09072822332382202, 0.09123431891202927, 0.09123159945011139], [0.09120357036590576, 0.09120535850524902, 0.09068282693624496, 0.09087403118610382, 0.0910205990076065, 0.09102238714694977, 0.09087938070297241, 0.09069173038005829, 0.09102774411439896, 0.09069528430700302, 0.09069706499576569], [0.09177299588918686, 0.09177827090024948, 0.09024696797132492, 0.09080532193183899, 0.09123489260673523, 0.09124013781547546, 0.09082097560167313, 0.09027289599180222, 0.09125585854053497, 0.09028326719999313, 0.09028845280408859], [0.0917799323797226, 0.0917852520942688, 0.09024166315793991, 0.09080447256565094, 0.09123749285936356, 0.09124277532100677, 0.09082025289535522, 0.09026779234409332, 0.09125862270593643, 0.0902782455086708, 0.09028347581624985], [0.0912243202328682, 0.0912262350320816, 0.09066689759492874, 0.09087154269218445, 0.09102843701839447, 0.09103035181760788, 0.09087726473808289, 0.09067641943693161, 0.09103608876466751, 0.09068022668361664, 0.09068213403224945], [0.09049688279628754, 0.09049439430236816, 0.09122677892446518, 0.09095761179924011, 0.09075219929218292, 0.09074969589710236, 0.09095010906457901, 0.09121423214673996, 0.09074220061302185, 0.09120920300483704, 0.09120669960975647], [0.09180077165365219, 0.09180621802806854, 0.09022576361894608, 0.09080194681882858, 0.09124529361724854, 0.0912507101893425, 0.09081809967756271, 0.09025251120328903, 0.0912669375538826, 0.09026321023702621, 0.0902685672044754], [0.09051065891981125, 0.09050825983285904, 0.09121614694595337, 0.09095600992441177, 0.09075745940208435, 0.09075504541397095, 0.09094874560832977, 0.09120401740074158, 0.09074780344963074, 0.09119915962219238, 0.09119673818349838], [0.0905175507068634, 0.09051518142223358, 0.09121082723140717, 0.09095519781112671, 0.09076008200645447, 0.09075771272182465, 0.09094806760549545, 0.09119890630245209, 0.09075058996677399, 0.09119413793087006, 0.09119175374507904]], [[0.09207428991794586, 0.09162762761116028, 0.09104374796152115, 0.09209105372428894, 0.09209664165973663, 0.0910603255033493, 0.0916554257273674, 0.09211340546607971, 0.08227574080228806, 0.0921950712800026, 0.09176668524742126], [0.09137417376041412, 0.09120030701160431, 0.09097226709127426, 0.09138068556785583, 0.09138286113739014, 0.09097874909639359, 0.09121114760637283, 0.09138937294483185, 0.08743495494127274, 0.09142109751701355, 0.09125449508428574], [0.0904121920466423, 0.09059178829193115, 0.09082843363285065, 0.09040547907352448, 0.0904032438993454, 0.09082168340682983, 0.09058058261871338, 0.09039652347564697, 0.09466041624546051, 0.09036383777856827, 0.09053574502468109], [0.09209997951984406, 0.09164304286241531, 0.0910458117723465, 0.09211712330579758, 0.09212284535169601, 0.0910627618432045, 0.09167148172855377, 0.09213999658823013, 0.08208811283111572, 0.09222354739904404, 0.09178528934717178], [0.09210854023694992, 0.09164818376302719, 0.09104649722576141, 0.09212581813335419, 0.09213157743215561, 0.09106357395648956, 0.09167683124542236, 0.09214886277914047, 0.0820256695151329, 0.09223303943872452, 0.09179149568080902], [0.09044025093317032, 0.09060987830162048, 0.09083333611488342, 0.09043391793966293, 0.09043180197477341, 0.09082696586847305, 0.09059929102659225, 0.09042546153068542, 0.09444750845432281, 0.09039458632469177, 0.09055694937705994], [0.09141862392425537, 0.09122784435749054, 0.09097764641046524, 0.09142577648162842, 0.09142816066741943, 0.0909847617149353, 0.09123972803354263, 0.09143530577421188, 0.08710475265979767, 0.09147012233734131, 0.0912872925400734], [0.09213417023420334, 0.09166353195905685, 0.09104849398136139, 0.09215183556079865, 0.09215772151947021, 0.09106595069169998, 0.09169282019138336, 0.09217538684606552, 0.08183854818344116, 0.09226145595312119, 0.09181004017591476], [0.06750775128602982, 0.07193991541862488, 0.07821200042963028, 0.06734726577997208, 0.06729386001825333, 0.07802607119083405, 0.07165511697530746, 0.06713388860225677, 0.29399633407592773, 0.06636042147874832, 0.07052743434906006], [0.0922584980726242, 0.09173775464296341, 0.0910576581954956, 0.09227804839611053, 0.09228456020355225, 0.09107695519924164, 0.09177014231681824, 0.09230411797761917, 0.08093306422233582, 0.09239938110113144, 0.0918998271226883], [0.091595359146595, 0.09133677929639816, 0.09099796414375305, 0.0916050523519516, 0.09160828590393066, 0.09100759029388428, 0.09135288745164871, 0.09161797910928726, 0.08579552918672562, 0.09166519343852997, 0.0914173424243927]]]}, "num_training_step_calls_per_iteration": 1, "evaluation": {"env_runners": {"module_to_env_connector": {"timers": {"connectors": {"tensor_to_numpy": 1.4762636197543337e-05, "un_batch_to_individual_items": 6.592535681052832e-06, "get_actions": 3.4785935392787776e-05, "listify_data_for_vector_env": 1.0141519999974837e-05, "normalize_and_clip_actions": 7.815151557356375e-06, "remove_single_ts_time_rank_from_batch": 1.1763750501443648e-05}}, "connector_pipeline_timer": 0.0001117295578620836}, "episode_len_min": 20, "num_env_steps_sampled": 400, "weights_seq_no": 14.0, "episode_len_mean": 20.0, "env_to_module_sum_episodes_length_out": 10.368238394574323, "episode_len_max": 20, "env_to_module_connector": {"timers": {"connectors": {"batch_individual_items": 1.2133349647387167e-05, "add_observations_from_episodes_to_batch": 2.7738741244053633e-06, "add_states_from_episodes_to_batch": 2.7200073408000096e-06, "add_time_dim_to_batch_and_zero_pad": 6.655198221145442e-06, "numpy_to_tensor": 1.1658068466442816e-05}}, "connector_pipeline_timer": 5.7675746483169426e-05}, "env_to_module_sum_episodes_length_in": 10.368238394574323, "num_episodes_lifetime": 280, "episode_duration_sec_mean": 0.005464681229786947, "episode_return_max": 12.5, "rlmodule_inference_timer": 2.991334612963858e-05, "num_agent_steps_sampled": {"default_agent": 400}, "num_module_steps_sampled_lifetime": {"default_policy": 5600}, "num_agent_steps_sampled_lifetime": {"default_agent": 5600}, "num_module_steps_sampled": {"default_policy": 400}, "sample": 0.13137695650751763, "episode_return_mean": 0.8, "env_step_timer": 1.3630187907336751e-05, "agent_episode_returns_mean": {"default_agent": 0.8}, "num_episodes": 20, "module_episode_returns_mean": {"default_policy": 0.8}, "episode_return_min": -12.5, "num_env_steps_sampled_lifetime": 70400, "env_reset_timer": 0.0005571234033099415, "time_between_sampling": 12.320824361576614}, "num_healthy_workers": 1, "actor_manager_num_outstanding_async_reqs": 0, "num_remote_worker_restarts": 0}, "num_env_steps_sampled_lifetime": -7400000.0, "fault_tolerance": {"num_healthy_workers": 0, "num_remote_worker_restarts": 0}, "env_runner_group": {"actor_manager_num_outstanding_async_reqs": 0}, "done": false, "training_iteration": 14, "trial_id": "ae8a2_00000", "date": "2025-08-11_18-25-01", "timestamp": 1754929501, "time_this_iter_s": 9.89475703239441, "time_total_s": 154.4035782814026, "pid": 10870, "hostname": "Mac", "node_ip": "127.0.0.1", "config": {"exploration_config": {}, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 2, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "env": "Umbrella", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": false, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 0, "create_local_env_runner": true, "num_envs_per_env_runner": 1, "gym_env_vectorize_mode": "SYNC", "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "episodes_to_numpy": true, "max_requests_in_flight_per_env_runner": 1, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "merge_env_runner_states": "training_only", "broadcast_env_runner_states": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "complete_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "sampler_perf_stats_ema_coef": null, "_is_online": true, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": "auto", "num_aggregator_actors_per_learner": 0, "max_requests_in_flight_per_aggregator_actor": 3, "local_gpu_idx": 0, "max_requests_in_flight_per_learner": 3, "gamma": 1, "lr": 0.0002715581955, "grad_clip": 0.5, "grad_clip_by": "global_norm", "_train_batch_size_per_learner": 5000, "train_batch_size": 4000, "num_epochs": 1, "minibatch_size": 1000, "shuffle_batch_per_epoch": true, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "log_std_clip_param": 20.0, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "_disable_preprocessor_api": false, "_disable_action_flattening": false}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {"intrinsic_reward_coeff": 0.2795015916508}, "optimizer": {}, "_learner_class": "<class 'source.intrinsic_attention_ppo.learners.IntrinsicAttentionMetaLearner.IntrinsicAttentionMetaLearner'>", "callbacks_on_algorithm_init": null, "callbacks_on_env_runners_recreated": null, "callbacks_on_offline_eval_runners_recreated": null, "callbacks_on_checkpoint_loaded": null, "callbacks_on_environment_created": null, "callbacks_on_episode_created": null, "callbacks_on_episode_start": null, "callbacks_on_episode_step": null, "callbacks_on_episode_end": null, "callbacks_on_evaluate_start": null, "callbacks_on_evaluate_end": null, "callbacks_on_evaluate_offline_start": null, "callbacks_on_evaluate_offline_end": null, "callbacks_on_sample_end": null, "callbacks_on_train_result": null, "explore": true, "enable_rl_module_and_learner": true, "enable_env_runner_and_connector_v2": true, "_prior_exploration_config": {"type": "StochasticSampling"}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x38844d8a0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "offline_data_class": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_read_batch_size": null, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "materialize_data": false, "materialize_mapped_data": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "ignore_final_observation": false, "prelearner_class": null, "prelearner_buffer_class": null, "prelearner_buffer_kwargs": {}, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_remaining_data": false, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": 1, "evaluation_duration": 20, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_auto_duration_min_env_steps_per_sample": 100, "evaluation_auto_duration_max_env_steps_per_sample": 2000, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 1, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "offline_evaluation_interval": null, "num_offline_eval_runners": 0, "offline_loss_for_module_fn": null, "offline_evaluation_duration": 1, "offline_evaluation_parallel_to_training": false, "offline_evaluation_timeout_s": 120.0, "num_cpus_per_offline_eval_runner": 1, "num_gpus_per_offline_eval_runner": 0, "custom_resources_per_offline_eval_runner": {}, "restart_failed_offline_eval_runners": true, "ignore_offline_eval_runner_failures": false, "max_num_offline_eval_runner_restarts": 1000, "offline_eval_runner_restore_timeout_s": 1800.0, "max_requests_in_flight_per_offline_eval_runner": 1, "validate_offline_eval_runners_after_construction": true, "offline_eval_runner_health_probe_timeout_s": 30.0, "offline_eval_rl_module_inference_only": false, "broadcast_offline_eval_runner_states": false, "offline_eval_batch_size_per_runner": 256, "dataset_num_iters_per_eval_runner": 1, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "log_gradients": false, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 1, "restart_failed_env_runners": true, "ignore_env_runner_failures": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30.0, "env_runner_restore_timeout_s": 1800.0, "_model_config": {}, "_rl_module_spec": "MultiRLModuleSpec(multi_rl_module_class=<class 'ray.rllib.core.rl_module.multi_rl_module.MultiRLModule'>, observation_space=None, action_space=None, inference_only=False, model_config=None, rl_module_specs={'default_policy': RLModuleSpec(module_class=<class 'source.intrinsic_attention_ppo.rl_modules.DifferentiablePPOModule.DifferentiablePPOModule'>, observation_space=None, action_space=None, inference_only=False, learner_only=False, model_config={'vf_share_layers': True, 'embedding_dim': 62, 'max_seq_len': 11, 'policy_head_hidden_sizes': [32], 'value_head_hidden_sizes': [101], 'embedding_hidden_sizes': [121]}, catalog_class=None, load_state_path=None, model_config_dict=None), 'intrinsic_reward_module': RLModuleSpec(module_class=<class 'source.intrinsic_attention_ppo.rl_modules.IntrinsicAttentionModule.IntrinsicAttentionModule'>, observation_space=None, action_space=None, inference_only=False, learner_only=True, model_config={'intrinsic_reward_network': {'encoder_hidden_sizes': [], 'encoding_dim': 1, 'num_heads': 1, 'head_hidden_sizes': None, 'layers': [{'type': 'attention'}]}, 'extrinsic_value_hidden_layers': [127, 60], 'vf_share_layers': True, 'max_seq_len': 11}, catalog_class=None, load_state_path=None, model_config_dict=None)}, load_state_path=None, modules_to_load=None, module_specs={'default_policy': RLModuleSpec(module_class=<class 'source.intrinsic_attention_ppo.rl_modules.DifferentiablePPOModule.DifferentiablePPOModule'>, observation_space=None, action_space=None, inference_only=False, learner_only=False, model_config={'vf_share_layers': True, 'embedding_dim': 62, 'max_seq_len': 11, 'policy_head_hidden_sizes': [32], 'value_head_hidden_sizes': [101], 'embedding_hidden_sizes': [121]}, catalog_class=None, load_state_path=None, model_config_dict=None), 'intrinsic_reward_module': RLModuleSpec(module_class=<class 'source.intrinsic_attention_ppo.rl_modules.IntrinsicAttentionModule.IntrinsicAttentionModule'>, observation_space=None, action_space=None, inference_only=False, learner_only=True, model_config={'intrinsic_reward_network': {'encoder_hidden_sizes': [], 'encoding_dim': 1, 'num_heads': 1, 'head_hidden_sizes': None, 'layers': [{'type': 'attention'}]}, 'extrinsic_value_hidden_layers': [127, 60], 'vf_share_layers': True, 'max_seq_len': 11}, catalog_class=None, load_state_path=None, model_config_dict=None)})", "algorithm_config_overrides_per_module": {"intrinsic_reward_module": {"lr": 0.0002715581955}}, "_per_module_overrides": {}, "_validate_config": true, "_use_msgpack_checkpoints": false, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "env_task_fn": -1, "enable_connectors": -1, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.161583927863, "kl_target": 0.0201019014258, "vf_loss_coeff": 0.7790510010087, "entropy_coeff": 0.0015431216992, "clip_param": 0.2459212356676, "vf_clip_param": 0.3769744131561, "entropy_coeff_schedule": null, "lr_schedule": null, "sgd_minibatch_size": -1, "vf_share_layers": -1, "differentiable_learner_configs": ["DifferentiableLearnerConfig(learner_class=<class 'source.intrinsic_attention_ppo.learners.IntrinsicAttentionPPOLearner.IntrinsicAttentionPPOLearner'>, learner_connector=None, add_default_connectors_to_learner_pipeline=True, is_multi_agent=False, policies_to_update=['default_policy'], lr=0.0060984166342, num_total_minibatches=0, num_epochs=1, minibatch_size=1000, shuffle_batch_per_epoch=True)"], "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9485408017724, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.callbacks.callbacks.RLlibCallback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 154.4035782814026, "iterations_since_restore": 14, "perf": {"cpu_util_percent": 44.92142857142857, "ram_util_percent": 78.50714285714285}}
{"timers": {"training_iteration": 12.383415036722448, "restore_env_runners": 1.2011319358457916e-05, "training_step": 12.38321428520457, "env_runner_sampling_timer": 2.7909199789706483, "learner_update_timer": 9.3765051405741, "synch_weights": 0.0016256590259612145, "restore_eval_env_runners": 5.162395699696233e-05, "evaluation_iteration": 0.14312102976518548, "synch_eval_env_connectors": 0.00022297663901013037, "synch_env_connectors": 5.98086858255148e-06}, "env_runners": {"module_to_env_connector": {"connector_pipeline_timer": 0.00011603649876570591, "timers": {"connectors": {"remove_single_ts_time_rank_from_batch": 1.1843707703919562e-05, "un_batch_to_individual_items": 6.47444922112419e-06, "get_actions": 3.8125037100896647e-05, "tensor_to_numpy": 1.4818623040906106e-05, "listify_data_for_vector_env": 1.0271549295306164e-05, "normalize_and_clip_actions": 7.886885598714456e-06}}}, "rlmodule_inference_timer": 3.083581990914111e-05, "sample": 0.005783022915093883, "weights_seq_no": 14.0, "num_agent_steps_sampled": {"default_agent": 5000.0}, "episode_len_mean": 20.0, "episode_len_max": 20, "env_to_module_connector": {"timers": {"connectors": {"batch_individual_items": 1.2275134510155388e-05, "add_states_from_episodes_to_batch": 2.6657815377959003e-06, "numpy_to_tensor": 1.2232900008315717e-05, "add_observations_from_episodes_to_batch": 2.7679773437120393e-06, "add_time_dim_to_batch_and_zero_pad": 6.799492933608508e-06}}, "connector_pipeline_timer": 5.8920982078288055e-05}, "env_to_module_sum_episodes_length_out": 10.36823839457432, "num_agent_steps_sampled_lifetime": {"default_agent": -8017500.0}, "episode_return_mean": 0.9399999999999996, "num_module_steps_sampled_lifetime": {"default_policy": -8017500.0}, "num_episodes": 250.0, "time_between_sampling": 0.033510442524145936, "num_env_steps_sampled_lifetime": -8017500.0, "episode_return_min": -10.5, "env_reset_timer": 3.6532561469313997e-05, "env_to_module_sum_episodes_length_in": 10.36823839457432, "num_episodes_lifetime": -400875.0, "agent_episode_returns_mean": {"default_agent": 0.9399999999999996}, "episode_len_min": 20, "episode_duration_sec_mean": 0.005186876520514488, "env_step_timer": 1.379022153407248e-05, "episode_return_max": 9.5, "num_module_steps_sampled": {"default_policy": 5000.0}, "module_episode_returns_mean": {"default_policy": 0.9399999999999996}, "num_env_steps_sampled": 5000.0, "num_env_steps_sampled_lifetime_throughput": 3304.542274719636}, "__all_modules__": {"learner_connector_sum_episodes_length_in": 5000.0, "learner_connector": {"connector_pipeline_timer": 0.15989914083375253, "timers": {"connectors": {"add_one_ts_to_episodes_and_truncate": 0.009328246623165806, "add_observations_from_episodes_to_batch": 0.0015870039920546524, "add_columns_from_episodes_to_train_batch": 0.04915590616600942, "add_time_dim_to_batch_and_zero_pad": 0.08465332566557211, "add_states_from_episodes_to_batch": 0.008567113361237695, "batch_individual_items": 0.006271696065913113, "numpy_to_tensor": 9.463859422455748e-05}}}, "learner_connector_sum_episodes_length_out": 5250.0}, "learners": {"default_policy": {"curr_entropy_coeff": 0.0015431216992, "curr_kl_coeff": 4.931150215270463e-06, "num_module_steps_trained_lifetime": 89775, "entropy": 0.6806020736694336, "num_module_steps_trained": 5985, "diff_num_grad_updates_vs_sampler_policy": 1.0, "vf_loss": 0.35831785202026367, "vf_loss_unclipped": 43.256553649902344, "policy_loss": -0.00027886181487701833, "use_intrinsic_rewards": 0.0, "total_loss": 0.2778187394142151, "vf_explained_var": 0.0004659891128540039, "mean_kl_loss": 3.3637981687206775e-05, "weights_seq_no": 15.0, "num_trainable_parameters": 16595, "module_train_batch_size_mean": 997.7008703380301, "num_module_steps_trained_lifetime_throughput": 725.5304839564357}, "intrinsic_reward_module": {"num_module_steps_trained_lifetime": 89775, "num_module_steps_trained": 5985, "diff_num_grad_updates_vs_sampler_policy": 1.0, "total_loss": 0.0, "gradients_default_optimizer_global_norm": 0.0, "module_train_batch_size_mean": 997.7008703380301, "default_optimizer_learning_rate": 0.0002715581955, "weights_seq_no": 15.0, "num_trainable_parameters": 8266, "curr_entropy_coeff": 0.0015431216992, "num_module_steps_trained_lifetime_throughput": 725.5374456448895}, "differentiable_learners": {"intrinsic_attention_ppo_learner": {"default_policy": {"weights_seq_no": 90.0, "num_module_steps_trained": 35910, "num_module_steps_trained_lifetime": 538650, "entropy": 0.680626392364502, "diff_num_grad_updates_vs_sampler_policy": 76.0, "vf_loss": 0.3584331274032593, "vf_loss_unclipped": 43.380104064941406, "total_loss": 0.2779190242290497, "mean_kl_loss": 3.237181226722896e-05, "policy_loss": -0.00027361081447452307, "use_intrinsic_rewards": 1.0, "module_train_batch_size_mean": 997.4996962148737, "vf_explained_var": -0.0015598535537719727}, "__all_modules__": {"num_env_steps_trained": 198000, "num_module_steps_trained": 71820, "num_module_steps_trained_lifetime": 1077300, "num_env_steps_trained_lifetime": 2970000, "num_env_steps_trained_lifetime_throughput": 34840.51467234141}, "intrinsic_reward_module": {"weights_seq_no": 90.0, "num_module_steps_trained_lifetime": 538650, "num_module_steps_trained": 35910, "diff_num_grad_updates_vs_sampler_policy": 76.0, "total_loss": 0.0, "module_train_batch_size_mean": 997.4996962148737}}}, "__all_modules__": {"num_env_steps_trained_lifetime": 495000, "num_non_trainable_parameters": 0, "num_trainable_parameters": 24861, "num_env_steps_trained": 33000, "num_module_steps_trained": 11970, "num_module_steps_trained_lifetime": 179550, "num_env_steps_trained_lifetime_throughput": 4001.6256575614048, "num_module_steps_trained_throughput": 20811530.024321534, "num_module_steps_trained_lifetime_throughput": 12579954.851760069}, "IntrinsicAttentionMask": [[[0.092296302318573, 0.09230595827102661, 0.08952132612466812, 0.08953069150447845, 0.09233492612838745, 0.09132298827171326, 0.08955878764390945, 0.0905701145529747, 0.0923735573887825, 0.08958688378334045, 0.09059853106737137], [0.09230241924524307, 0.09231211245059967, 0.08951522409915924, 0.08952462673187256, 0.09234120696783066, 0.09132477641105652, 0.0895528495311737, 0.09056858718395233, 0.09238001704216003, 0.08958107233047485, 0.09059713035821915], [0.09051446616649628, 0.09051176905632019, 0.09130584448575974, 0.09130312502384186, 0.09050367027521133, 0.09078851342201233, 0.09129495173692703, 0.09100309014320374, 0.0904928669333458, 0.0912867859005928, 0.0909949466586113], [0.09052055329084396, 0.09051790088415146, 0.09129972010850906, 0.09129703789949417, 0.09050992876291275, 0.09079038351774216, 0.09128899872303009, 0.09100165218114853, 0.09049929678440094, 0.09128095954656601, 0.09099363535642624], [0.0923207700252533, 0.09233058989048004, 0.0894969254732132, 0.08950644731521606, 0.09236007183790207, 0.0913301408290863, 0.08953502774238586, 0.09056400507688522, 0.09239940345287323, 0.08956362307071686, 0.09059292078018188], [0.09167654812335968, 0.09168185293674469, 0.09013999998569489, 0.09014521539211273, 0.09169778227806091, 0.09113997966051102, 0.09016088396310806, 0.0907231941819191, 0.09171902388334274, 0.0901765450835228, 0.09073895215988159], [0.09053882211446762, 0.09053628146648407, 0.09128132462501526, 0.09127877652645111, 0.09052868187427521, 0.09079598635435104, 0.09127110987901688, 0.09099731594324112, 0.09051855653524399, 0.09126344323158264, 0.09098967909812927], [0.0911933109164238, 0.09119526296854019, 0.0906238928437233, 0.0906258374452591, 0.09120113402605057, 0.09099515527486801, 0.09063167870044708, 0.09084072709083557, 0.09120896458625793, 0.09063751250505447, 0.09084657579660416], [0.09234525263309479, 0.09235525131225586, 0.08947254717350006, 0.08948223292827606, 0.09238525480031967, 0.09133730828762054, 0.08951129764318466, 0.09055790305137634, 0.09242527186870575, 0.08954038470983505, 0.0905873253941536], [0.09055709093809128, 0.09055467694997787, 0.09126293659210205, 0.09126050770282745, 0.09054744988679886, 0.09080159664154053, 0.09125322848558426, 0.09099297970533371, 0.09053781628608704, 0.09124594181776047, 0.09098571538925171], [0.09121160954236984, 0.09121369570493698, 0.09060553461313248, 0.09060760587453842, 0.0912199392914772, 0.09100067615509033, 0.09061381965875626, 0.090836301445961, 0.09122827649116516, 0.0906200259923935, 0.09084252268075943]], [[0.09217773377895355, 0.09173057228326797, 0.09114603698253632, 0.09219451993703842, 0.09220011532306671, 0.09116262942552567, 0.09175840020179749, 0.09221689403057098, 0.08183833211660385, 0.09170493483543396, 0.0918697789311409], [0.09141543507575989, 0.0912414938211441, 0.0910133421421051, 0.0914219468832016, 0.0914241224527359, 0.09101983159780502, 0.09125234186649323, 0.09143064171075821, 0.0872536301612854, 0.09123151004314423, 0.09129570424556732], [0.0903681069612503, 0.09054761379957199, 0.09078413993120193, 0.09036139398813248, 0.0903591588139534, 0.09077739715576172, 0.09053640812635422, 0.09035244584083557, 0.09486375749111176, 0.09055794775485992, 0.09049160033464432], [0.092205710709095, 0.09174825251102448, 0.09115033596754074, 0.09222287684679031, 0.09222859889268875, 0.09116730093955994, 0.09177672117948532, 0.09224577248096466, 0.08164169639348984, 0.0917220264673233, 0.09189066290855408], [0.09221503138542175, 0.09175413101911545, 0.09115175902843475, 0.09223232418298721, 0.09223809093236923, 0.0911688506603241, 0.0917828157544136, 0.09225539118051529, 0.08157625794410706, 0.09172771871089935, 0.09189761430025101], [0.09039866179227829, 0.09056820720434189, 0.09079156816005707, 0.0903923287987709, 0.09039021283388138, 0.0907852053642273, 0.09055762737989426, 0.0903838723897934, 0.0946391150355339, 0.09057796001434326, 0.09051530808210373], [0.0914638414978981, 0.09127296507358551, 0.09102264791727066, 0.09147099405527115, 0.09147337824106216, 0.09102976322174072, 0.0912848636507988, 0.09148053079843521, 0.0869065672159195, 0.09126200526952744, 0.09133245050907135], [0.09224295616149902, 0.09177175909280777, 0.0911559984087944, 0.09226064383983612, 0.09226653724908829, 0.09117347002029419, 0.09180108457803726, 0.09228422492742538, 0.0813802033662796, 0.09174475073814392, 0.0919184461236], [0.06330526620149612, 0.06772689521312714, 0.07401265949010849, 0.06314549595117569, 0.06309232860803604, 0.07382586598396301, 0.06744225323200226, 0.06293310225009918, 0.33020997047424316, 0.06799021363258362, 0.06631588190793991], [0.09137073159217834, 0.09121238440275192, 0.09100464731454849, 0.0913766622543335, 0.09137864410877228, 0.09101055562496185, 0.09122225642204285, 0.09138457477092743, 0.08757451176643372, 0.09120329469442368, 0.09126173704862595], [0.09165626764297485, 0.09139751642942429, 0.09105847775936127, 0.09166596829891205, 0.09166920185089111, 0.09106811136007309, 0.09141363203525543, 0.09167890250682831, 0.0855310931801796, 0.09138266742229462, 0.0914781242609024]], [[0.09101905673742294, 0.09117406606674194, 0.09076861292123795, 0.09023835510015488, 0.09118928015232086, 0.09173532575368881, 0.09078880399465561, 0.09025843441486359, 0.0917506292462349, 0.09080395102500916, 0.09027349203824997], [0.09104648977518082, 0.09124089032411575, 0.09073259681463242, 0.09006872028112411, 0.09125997126102448, 0.09194543957710266, 0.09075789898633957, 0.09009382873773575, 0.09196466952562332, 0.09077687561511993, 0.09011267125606537], [0.09097427129745483, 0.09106559306383133, 0.09082658588886261, 0.09051334112882614, 0.09107455611228943, 0.09139572829008102, 0.09083849936723709, 0.09052521735429764, 0.09140472114086151, 0.0908474326133728, 0.09053412079811096], [0.0908774882555008, 0.09083374589681625, 0.09094835072755814, 0.09109923988580704, 0.09082946181297302, 0.09067616611719131, 0.0909426286816597, 0.0910935029387474, 0.09067188948392868, 0.09093833714723587, 0.09108921140432358], [0.09104916453361511, 0.09124741703271866, 0.09072904288768768, 0.09005208313465118, 0.09126687794923782, 0.09196604788303375, 0.09075484424829483, 0.09007769078016281, 0.09198565781116486, 0.09077420085668564, 0.09009689837694168], [0.09114394336938858, 0.09148071706295013, 0.09060126543045044, 0.08945801854133606, 0.09151379764080048, 0.09270565956830978, 0.0906449481844902, 0.08950115740299225, 0.09273918718099594, 0.09067773073911667, 0.08953352272510529], [0.09097789973020554, 0.09107436239719391, 0.09082192182540894, 0.09049112349748611, 0.091083824634552, 0.09142310917377472, 0.09083449840545654, 0.09050367027521133, 0.0914326086640358, 0.09084393829107285, 0.09051306545734406], [0.09088119864463806, 0.09084257483482361, 0.09094376862049103, 0.09107697010040283, 0.09083878993988037, 0.09070342034101486, 0.09093871712684631, 0.09107191115617752, 0.09069963544607162, 0.09093493223190308, 0.09106811881065369], [0.0911465659737587, 0.09148722141981125, 0.09059767425060272, 0.0894414484500885, 0.09152068197727203, 0.09272638708353043, 0.09064185619354248, 0.08948507159948349, 0.09276030212640762, 0.09067501127719879, 0.08951780200004578], [0.09098061919212341, 0.0910809338092804, 0.09081842005252838, 0.09047447144985199, 0.09109077602624893, 0.09144365042448044, 0.09083149582147598, 0.09048750251531601, 0.09145352989435196, 0.09084130823612213, 0.09049727767705917], [0.09088397026062012, 0.09084919095039368, 0.09094031900167465, 0.09106025844812393, 0.09084577858448029, 0.09072385728359222, 0.09093577414751053, 0.09105570614337921, 0.09072044491767883, 0.09093235433101654, 0.09105228632688522]], [[0.09040874987840652, 0.08835355192422867, 0.08721327781677246, 0.08926395326852798, 0.08927495777606964, 0.08724553883075714, 0.0872562900185585, 0.0904868021607399, 0.11272457242012024, 0.08946894854307175, 0.08830338716506958], [0.09080801904201508, 0.09017688781023026, 0.08982229232788086, 0.09045770764350891, 0.09046109020709991, 0.0898323655128479, 0.08983572572469711, 0.09083178639411926, 0.09709203988313675, 0.09052066504955292, 0.09016135334968567], [0.09093116223812103, 0.09112007915973663, 0.0912269726395607, 0.09103580564260483, 0.09103479236364365, 0.09122392535209656, 0.09122291207313538, 0.09092407673597336, 0.08913847804069519, 0.09101695567369461, 0.09112474322319031], [0.09065978974103928, 0.08938898146152496, 0.08867897838354111, 0.08995330333709717, 0.08996012061834335, 0.08869911730289459, 0.08870583027601242, 0.09070782363414764, 0.10380819439888, 0.09008007496595383, 0.08935781568288803], [0.09065771102905273, 0.08937925100326538, 0.08866503089666367, 0.08994696289300919, 0.08995380997657776, 0.0886852815747261, 0.08869203925132751, 0.09070603549480438, 0.10389138758182526, 0.09007448703050613, 0.08934790641069412], [0.09092861413955688, 0.09109406173229218, 0.09118764847517014, 0.09102026373147964, 0.09101937711238861, 0.09118498116731644, 0.0911840945482254, 0.09092241525650024, 0.08935660868883133, 0.09100376069545746, 0.09109814465045929], [0.09092775732278824, 0.09108537435531616, 0.09117452800273895, 0.09101507067680359, 0.09101422131061554, 0.0911719873547554, 0.09117114543914795, 0.09092184156179428, 0.08942942321300507, 0.09099934250116348, 0.09108927100896835], [0.0903889611363411, 0.08828112483024597, 0.087112195789814, 0.08921469002962112, 0.08922597765922546, 0.08714526146650314, 0.087156280875206, 0.09046904742717743, 0.11335184425115585, 0.08942493051290512, 0.0882296934723854], [0.07070188224315643, 0.05925101041793823, 0.053622547537088394, 0.06410699337720871, 0.06416774541139603, 0.05377515032887459, 0.053826116025447845, 0.07117225229740143, 0.38513636589050293, 0.06524695456027985, 0.05899300426244736], [0.09062017500400543, 0.0892072468996048, 0.08841882646083832, 0.08983440697193146, 0.08984196931123734, 0.08844117820262909, 0.08844862878322601, 0.09067363291978836, 0.10536599904298782, 0.08997534215450287, 0.08917262405157089], [0.09081489592790604, 0.0902194008231163, 0.08988473564386368, 0.09048439562320709, 0.09048759192228317, 0.08989424258470535, 0.08989741653203964, 0.09083732217550278, 0.09673149883747101, 0.09054379910230637, 0.09020474553108215]], [[0.09220580011606216, 0.09119527786970139, 0.0904339924454689, 0.090443454682827, 0.09224437922239304, 0.09225402772426605, 0.08947096019983292, 0.09048129618167877, 0.09126206487417221, 0.08949904143810272, 0.09050969034433365], [0.09160323441028595, 0.09106368571519852, 0.0906553715467453, 0.0906604528427124, 0.09162377566099167, 0.09162891656160355, 0.0901365652680397, 0.09068078547716141, 0.09109942615032196, 0.09015172719955444, 0.09069604426622391], [0.09114599972963333, 0.09096220880746841, 0.09082265198230743, 0.09082438796758652, 0.09115298837423325, 0.09115473181009293, 0.0906447246670723, 0.09083134680986404, 0.09097440540790558, 0.09064993262290955, 0.09083656966686249], [0.09115169942378998, 0.09096348285675049, 0.0908205658197403, 0.09082234650850296, 0.09115885198116302, 0.09116064012050629, 0.09063837677240372, 0.09082947671413422, 0.09097597748041153, 0.09064370393753052, 0.09083482623100281], [0.09222870320081711, 0.09120023250579834, 0.09042555093765259, 0.09043517708778381, 0.0922679752111435, 0.09227779507637024, 0.08944574743509293, 0.09047368168830872, 0.09126820415258408, 0.08947430551052094, 0.09050257503986359], [0.09223444014787674, 0.09120148420333862, 0.09042345732450485, 0.09043312072753906, 0.09227388352155685, 0.09228374809026718, 0.08943945169448853, 0.0904717966914177, 0.09126974642276764, 0.08946813642978668, 0.09050080925226212], [0.09056352078914642, 0.09083092957735062, 0.09103487432003021, 0.09103232622146606, 0.0905533879995346, 0.09055084735155106, 0.0912960097193718, 0.09102213382720947, 0.09081313759088516, 0.09128835052251816, 0.09101449698209763], [0.09117449820041656, 0.09096857905387878, 0.09081225097179413, 0.09081419557332993, 0.09118232131004333, 0.09118428081274033, 0.0906129777431488, 0.0908219963312149, 0.09098224341869354, 0.0906188115477562, 0.0908278375864029], [0.09164321422576904, 0.09107249230146408, 0.09064072370529175, 0.09064609557390213, 0.09166494756937027, 0.09167038649320602, 0.0900922641158104, 0.09066759049892426, 0.09111029654741287, 0.09010829031467438, 0.0906837210059166], [0.09058055281639099, 0.09083478897809982, 0.09102866798639297, 0.09102624654769897, 0.09057091921567917, 0.09056851267814636, 0.0912768766283989, 0.09101656079292297, 0.0908178836107254, 0.0912695899605751, 0.09100930392742157], [0.0911915972828865, 0.090972401201725, 0.0908060073852539, 0.09080807864665985, 0.09119993448257446, 0.091202013194561, 0.09059394150972366, 0.09081637114286423, 0.0909869447350502, 0.0906001478433609, 0.09082259982824326]], [[0.09206845611333847, 0.09162181615829468, 0.09162737429141998, 0.09208521246910095, 0.09268701821565628, 0.0916440561413765, 0.09106007218360901, 0.09210756421089172, 0.08174128830432892, 0.09159621596336365, 0.09176085889339447], [0.0913732498884201, 0.09119939059019089, 0.09120155870914459, 0.09137976169586182, 0.09161318838596344, 0.09120805561542511, 0.09097999334335327, 0.09138844907283783, 0.08721337467432022, 0.09118940681219101, 0.09125357121229172], [0.09138211607933044, 0.09120487421751022, 0.09120707958936691, 0.0913887619972229, 0.09162673354148865, 0.09121371060609818, 0.09098121523857117, 0.09139761328697205, 0.08714310824871063, 0.09119469672441483, 0.09126010537147522], [0.09209388494491577, 0.09163697063922882, 0.09164265543222427, 0.0921110287308693, 0.09272675216197968, 0.09165971726179123, 0.09106238186359406, 0.09213389456272125, 0.08154267072677612, 0.09161078184843063, 0.0917792096734047], [0.09297651797533035, 0.09214933216571808, 0.09215961396694183, 0.09300762414932251, 0.09412767738103867, 0.09219043701887131, 0.09111375361680984, 0.09304911643266678, 0.07471742480993271, 0.09210201352834702, 0.0924064964056015], [0.09140868484973907, 0.09122128784656525, 0.09122361987829208, 0.09141570329666138, 0.09166734665632248, 0.09123063087463379, 0.09098484367132187, 0.09142506867647171, 0.08693262189626694, 0.09121052920818329, 0.09127968549728394], [0.09044873714447021, 0.09061503410339355, 0.09061295539140701, 0.09044251590967178, 0.09022026509046555, 0.09060672670602798, 0.09082576632499695, 0.090434230864048, 0.09460607916116714, 0.09062460064888, 0.09056314080953598], [0.092127725481987, 0.0916571170091629, 0.09166297316551208, 0.09214538335800171, 0.09277968853712082, 0.09168054163455963, 0.09106539934873581, 0.09216894209384918, 0.08127852529287338, 0.09163013845682144, 0.09180361777544022], [0.06405822187662125, 0.06853245198726654, 0.06847474724054337, 0.063896544277668, 0.05837150290608406, 0.06830193102359772, 0.07464107125997543, 0.06368161737918854, 0.33413833379745483, 0.06879889965057373, 0.06710465997457504], [0.091332346200943, 0.09117405861616135, 0.09117604047060013, 0.09133827686309814, 0.09155073761940002, 0.09118195623159409, 0.09097428619861603, 0.09134618192911148, 0.08753771334886551, 0.0911649763584137, 0.09122338891029358], [0.09159336984157562, 0.09133478999137878, 0.09133801609277725, 0.09160306304693222, 0.09195061773061752, 0.09134767949581146, 0.09100881963968277, 0.09161598980426788, 0.08547239005565643, 0.09131995588541031, 0.09141534566879272]]]}, "num_training_step_calls_per_iteration": 1, "evaluation": {"env_runners": {"module_to_env_connector": {"timers": {"connectors": {"tensor_to_numpy": 1.5200799480902523e-05, "un_batch_to_individual_items": 6.761665275429949e-06, "get_actions": 3.673862252014307e-05, "listify_data_for_vector_env": 1.040569707505092e-05, "normalize_and_clip_actions": 8.050230690884065e-06, "remove_single_ts_time_rank_from_batch": 1.1970490004380701e-05}}, "connector_pipeline_timer": 0.00011560033919416937}, "episode_len_min": 20, "num_env_steps_sampled": 400, "weights_seq_no": 15.0, "episode_len_mean": 20.0, "env_to_module_sum_episodes_length_out": 10.368238394574323, "episode_len_max": 20, "env_to_module_connector": {"timers": {"connectors": {"batch_individual_items": 1.2349985115725901e-05, "add_observations_from_episodes_to_batch": 2.8364423425471157e-06, "add_states_from_episodes_to_batch": 2.7759197711108794e-06, "add_time_dim_to_batch_and_zero_pad": 6.913936965903886e-06, "numpy_to_tensor": 1.1921295007050675e-05}}, "connector_pipeline_timer": 5.873811275975142e-05}, "env_to_module_sum_episodes_length_in": 10.368238394574323, "num_episodes_lifetime": 300, "episode_duration_sec_mean": 0.005384808314265683, "episode_return_max": 12.5, "rlmodule_inference_timer": 3.130599084279527e-05, "num_agent_steps_sampled": {"default_agent": 400}, "num_module_steps_sampled_lifetime": {"default_policy": 6000}, "num_agent_steps_sampled_lifetime": {"default_agent": 6000}, "num_module_steps_sampled": {"default_policy": 400}, "sample": 0.13122639277165862, "episode_return_mean": 0.8, "env_step_timer": 1.4096925087694972e-05, "agent_episode_returns_mean": {"default_agent": 0.8}, "num_episodes": 20, "module_episode_returns_mean": {"default_policy": 0.8}, "episode_return_min": -12.5, "num_env_steps_sampled_lifetime": 75400, "env_reset_timer": 0.0005534179995492783, "time_between_sampling": 12.295075933800387}, "num_healthy_workers": 1, "actor_manager_num_outstanding_async_reqs": 0, "num_remote_worker_restarts": 0}, "num_env_steps_sampled_lifetime": -8017500.0, "fault_tolerance": {"num_healthy_workers": 0, "num_remote_worker_restarts": 0}, "env_runner_group": {"actor_manager_num_outstanding_async_reqs": 0}, "done": false, "training_iteration": 15, "trial_id": "ae8a2_00000", "date": "2025-08-11_18-25-11", "timestamp": 1754929511, "time_this_iter_s": 9.843019008636475, "time_total_s": 164.24659729003906, "pid": 10870, "hostname": "Mac", "node_ip": "127.0.0.1", "config": {"exploration_config": {}, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 2, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "env": "Umbrella", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": false, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 0, "create_local_env_runner": true, "num_envs_per_env_runner": 1, "gym_env_vectorize_mode": "SYNC", "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "episodes_to_numpy": true, "max_requests_in_flight_per_env_runner": 1, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "merge_env_runner_states": "training_only", "broadcast_env_runner_states": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "complete_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "sampler_perf_stats_ema_coef": null, "_is_online": true, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": "auto", "num_aggregator_actors_per_learner": 0, "max_requests_in_flight_per_aggregator_actor": 3, "local_gpu_idx": 0, "max_requests_in_flight_per_learner": 3, "gamma": 1, "lr": 0.0002715581955, "grad_clip": 0.5, "grad_clip_by": "global_norm", "_train_batch_size_per_learner": 5000, "train_batch_size": 4000, "num_epochs": 1, "minibatch_size": 1000, "shuffle_batch_per_epoch": true, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "log_std_clip_param": 20.0, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "_disable_preprocessor_api": false, "_disable_action_flattening": false}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {"intrinsic_reward_coeff": 0.2795015916508}, "optimizer": {}, "_learner_class": "<class 'source.intrinsic_attention_ppo.learners.IntrinsicAttentionMetaLearner.IntrinsicAttentionMetaLearner'>", "callbacks_on_algorithm_init": null, "callbacks_on_env_runners_recreated": null, "callbacks_on_offline_eval_runners_recreated": null, "callbacks_on_checkpoint_loaded": null, "callbacks_on_environment_created": null, "callbacks_on_episode_created": null, "callbacks_on_episode_start": null, "callbacks_on_episode_step": null, "callbacks_on_episode_end": null, "callbacks_on_evaluate_start": null, "callbacks_on_evaluate_end": null, "callbacks_on_evaluate_offline_start": null, "callbacks_on_evaluate_offline_end": null, "callbacks_on_sample_end": null, "callbacks_on_train_result": null, "explore": true, "enable_rl_module_and_learner": true, "enable_env_runner_and_connector_v2": true, "_prior_exploration_config": {"type": "StochasticSampling"}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x38844d8a0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "offline_data_class": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_read_batch_size": null, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "materialize_data": false, "materialize_mapped_data": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "ignore_final_observation": false, "prelearner_class": null, "prelearner_buffer_class": null, "prelearner_buffer_kwargs": {}, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_remaining_data": false, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": 1, "evaluation_duration": 20, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_auto_duration_min_env_steps_per_sample": 100, "evaluation_auto_duration_max_env_steps_per_sample": 2000, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 1, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "offline_evaluation_interval": null, "num_offline_eval_runners": 0, "offline_loss_for_module_fn": null, "offline_evaluation_duration": 1, "offline_evaluation_parallel_to_training": false, "offline_evaluation_timeout_s": 120.0, "num_cpus_per_offline_eval_runner": 1, "num_gpus_per_offline_eval_runner": 0, "custom_resources_per_offline_eval_runner": {}, "restart_failed_offline_eval_runners": true, "ignore_offline_eval_runner_failures": false, "max_num_offline_eval_runner_restarts": 1000, "offline_eval_runner_restore_timeout_s": 1800.0, "max_requests_in_flight_per_offline_eval_runner": 1, "validate_offline_eval_runners_after_construction": true, "offline_eval_runner_health_probe_timeout_s": 30.0, "offline_eval_rl_module_inference_only": false, "broadcast_offline_eval_runner_states": false, "offline_eval_batch_size_per_runner": 256, "dataset_num_iters_per_eval_runner": 1, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "log_gradients": false, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 1, "restart_failed_env_runners": true, "ignore_env_runner_failures": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30.0, "env_runner_restore_timeout_s": 1800.0, "_model_config": {}, "_rl_module_spec": "MultiRLModuleSpec(multi_rl_module_class=<class 'ray.rllib.core.rl_module.multi_rl_module.MultiRLModule'>, observation_space=None, action_space=None, inference_only=False, model_config=None, rl_module_specs={'default_policy': RLModuleSpec(module_class=<class 'source.intrinsic_attention_ppo.rl_modules.DifferentiablePPOModule.DifferentiablePPOModule'>, observation_space=None, action_space=None, inference_only=False, learner_only=False, model_config={'vf_share_layers': True, 'embedding_dim': 62, 'max_seq_len': 11, 'policy_head_hidden_sizes': [32], 'value_head_hidden_sizes': [101], 'embedding_hidden_sizes': [121]}, catalog_class=None, load_state_path=None, model_config_dict=None), 'intrinsic_reward_module': RLModuleSpec(module_class=<class 'source.intrinsic_attention_ppo.rl_modules.IntrinsicAttentionModule.IntrinsicAttentionModule'>, observation_space=None, action_space=None, inference_only=False, learner_only=True, model_config={'intrinsic_reward_network': {'encoder_hidden_sizes': [], 'encoding_dim': 1, 'num_heads': 1, 'head_hidden_sizes': None, 'layers': [{'type': 'attention'}]}, 'extrinsic_value_hidden_layers': [127, 60], 'vf_share_layers': True, 'max_seq_len': 11}, catalog_class=None, load_state_path=None, model_config_dict=None)}, load_state_path=None, modules_to_load=None, module_specs={'default_policy': RLModuleSpec(module_class=<class 'source.intrinsic_attention_ppo.rl_modules.DifferentiablePPOModule.DifferentiablePPOModule'>, observation_space=None, action_space=None, inference_only=False, learner_only=False, model_config={'vf_share_layers': True, 'embedding_dim': 62, 'max_seq_len': 11, 'policy_head_hidden_sizes': [32], 'value_head_hidden_sizes': [101], 'embedding_hidden_sizes': [121]}, catalog_class=None, load_state_path=None, model_config_dict=None), 'intrinsic_reward_module': RLModuleSpec(module_class=<class 'source.intrinsic_attention_ppo.rl_modules.IntrinsicAttentionModule.IntrinsicAttentionModule'>, observation_space=None, action_space=None, inference_only=False, learner_only=True, model_config={'intrinsic_reward_network': {'encoder_hidden_sizes': [], 'encoding_dim': 1, 'num_heads': 1, 'head_hidden_sizes': None, 'layers': [{'type': 'attention'}]}, 'extrinsic_value_hidden_layers': [127, 60], 'vf_share_layers': True, 'max_seq_len': 11}, catalog_class=None, load_state_path=None, model_config_dict=None)})", "algorithm_config_overrides_per_module": {"intrinsic_reward_module": {"lr": 0.0002715581955}}, "_per_module_overrides": {}, "_validate_config": true, "_use_msgpack_checkpoints": false, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "env_task_fn": -1, "enable_connectors": -1, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.161583927863, "kl_target": 0.0201019014258, "vf_loss_coeff": 0.7790510010087, "entropy_coeff": 0.0015431216992, "clip_param": 0.2459212356676, "vf_clip_param": 0.3769744131561, "entropy_coeff_schedule": null, "lr_schedule": null, "sgd_minibatch_size": -1, "vf_share_layers": -1, "differentiable_learner_configs": ["DifferentiableLearnerConfig(learner_class=<class 'source.intrinsic_attention_ppo.learners.IntrinsicAttentionPPOLearner.IntrinsicAttentionPPOLearner'>, learner_connector=None, add_default_connectors_to_learner_pipeline=True, is_multi_agent=False, policies_to_update=['default_policy'], lr=0.0060984166342, num_total_minibatches=0, num_epochs=1, minibatch_size=1000, shuffle_batch_per_epoch=True)"], "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9485408017724, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.callbacks.callbacks.RLlibCallback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 164.24659729003906, "iterations_since_restore": 15, "perf": {"cpu_util_percent": 44.885714285714286, "ram_util_percent": 78.31428571428572}}
{"timers": {"training_iteration": 12.350187870944472, "restore_env_runners": 1.1951206621742939e-05, "training_step": 12.349987103602736, "env_runner_sampling_timer": 2.7783790179313215, "learner_update_timer": 9.35518448124901, "synch_weights": 0.0016171516053008672, "restore_eval_env_runners": 5.13339671125037e-05, "evaluation_iteration": 0.14291733029745543, "synch_eval_env_connectors": 0.00022194729270350716, "synch_env_connectors": 5.961479296464276e-06}, "env_runners": {"module_to_env_connector": {"connector_pipeline_timer": 0.00011748355817330143, "timers": {"connectors": {"remove_single_ts_time_rank_from_batch": 1.1972114577579312e-05, "un_batch_to_individual_items": 6.561726487117832e-06, "get_actions": 3.8680012040839634e-05, "tensor_to_numpy": 1.4991626585973825e-05, "listify_data_for_vector_env": 1.0490901486147036e-05, "normalize_and_clip_actions": 7.951706514235295e-06}}}, "rlmodule_inference_timer": 3.143741536027555e-05, "sample": 0.0056229376373814165, "weights_seq_no": 15.0, "num_agent_steps_sampled": {"default_agent": 5000.0}, "episode_len_mean": 20.0, "episode_len_max": 20, "env_to_module_connector": {"timers": {"connectors": {"batch_individual_items": 1.2509188005139145e-05, "add_states_from_episodes_to_batch": 2.7320051198714566e-06, "numpy_to_tensor": 1.2603170634372174e-05, "add_observations_from_episodes_to_batch": 2.810834586363207e-06, "add_time_dim_to_batch_and_zero_pad": 6.888996927471008e-06}}, "connector_pipeline_timer": 5.997745588157835e-05}, "env_to_module_sum_episodes_length_out": 10.36823839457432, "num_agent_steps_sampled_lifetime": {"default_agent": -8635000.0}, "episode_return_mean": 1.1800000000000002, "num_module_steps_sampled_lifetime": {"default_policy": -8635000.0}, "num_episodes": 250.0, "time_between_sampling": 0.033883654986241234, "num_env_steps_sampled_lifetime": -8635000.0, "episode_return_min": -10.5, "env_reset_timer": 3.87766285992238e-05, "env_to_module_sum_episodes_length_in": 10.36823839457432, "num_episodes_lifetime": -431750.0, "agent_episode_returns_mean": {"default_agent": 1.1800000000000002}, "episode_len_min": 20, "episode_duration_sec_mean": 0.005276619793381544, "env_step_timer": 1.4088963229242073e-05, "episode_return_max": 9.5, "num_module_steps_sampled": {"default_policy": 5000.0}, "module_episode_returns_mean": {"default_policy": 1.1800000000000002}, "num_env_steps_sampled": 5000.0, "num_env_steps_sampled_lifetime_throughput": 3251.2253991437956}, "__all_modules__": {"learner_connector_sum_episodes_length_in": 5000.0, "learner_connector": {"connector_pipeline_timer": 0.15962648942462881, "timers": {"connectors": {"add_one_ts_to_episodes_and_truncate": 0.009321659156997775, "add_observations_from_episodes_to_batch": 0.0015789822819761966, "add_columns_from_episodes_to_train_batch": 0.04907161127412055, "add_time_dim_to_batch_and_zero_pad": 0.08455279990889993, "add_states_from_episodes_to_batch": 0.008516720137690224, "batch_individual_items": 0.006250667025710734, "numpy_to_tensor": 9.436928910728311e-05}}}, "learner_connector_sum_episodes_length_out": 5250.0}, "learners": {"default_policy": {"curr_entropy_coeff": 0.0015431216992, "curr_kl_coeff": 2.4655751076352317e-06, "num_module_steps_trained_lifetime": 95760, "entropy": 0.6793391108512878, "num_module_steps_trained": 5985, "diff_num_grad_updates_vs_sampler_policy": 1.0, "vf_loss": 0.35831961035728455, "vf_loss_unclipped": 43.298851013183594, "policy_loss": -0.00032190000638365746, "use_intrinsic_rewards": 0.0, "total_loss": 0.27777907252311707, "vf_explained_var": 0.0012854337692260742, "mean_kl_loss": 2.8671827749349177e-05, "weights_seq_no": 16.0, "num_trainable_parameters": 16595, "module_train_batch_size_mean": 997.6889684010584, "num_module_steps_trained_lifetime_throughput": 724.9827519114303}, "intrinsic_reward_module": {"num_module_steps_trained_lifetime": 95760, "num_module_steps_trained": 5985, "diff_num_grad_updates_vs_sampler_policy": 1.0, "total_loss": 0.0, "gradients_default_optimizer_global_norm": 0.0, "module_train_batch_size_mean": 997.6889684010584, "default_optimizer_learning_rate": 0.0002715581955, "weights_seq_no": 16.0, "num_trainable_parameters": 8266, "curr_entropy_coeff": 0.0015431216992, "num_module_steps_trained_lifetime_throughput": 724.989278793451}, "differentiable_learners": {"intrinsic_attention_ppo_learner": {"default_policy": {"weights_seq_no": 96.0, "num_module_steps_trained": 35910, "num_module_steps_trained_lifetime": 574560, "entropy": 0.6793712973594666, "diff_num_grad_updates_vs_sampler_policy": 81.0, "vf_loss": 0.3584258258342743, "vf_loss_unclipped": 43.445255279541016, "total_loss": 0.27787476778030396, "mean_kl_loss": 2.7197271265322343e-05, "policy_loss": -0.00031328227487392724, "use_intrinsic_rewards": 1.0, "module_train_batch_size_mean": 997.4990256591639, "vf_explained_var": -0.0015492439270019531}, "__all_modules__": {"num_env_steps_trained": 198000, "num_module_steps_trained": 71820, "num_module_steps_trained_lifetime": 1149120, "num_env_steps_trained_lifetime": 3168000, "num_env_steps_trained_lifetime_throughput": 34758.03655179856}, "intrinsic_reward_module": {"weights_seq_no": 96.0, "num_module_steps_trained_lifetime": 574560, "num_module_steps_trained": 35910, "diff_num_grad_updates_vs_sampler_policy": 81.0, "total_loss": 0.0, "module_train_batch_size_mean": 997.4990256591639}}}, "__all_modules__": {"num_env_steps_trained_lifetime": 528000, "num_non_trainable_parameters": 0, "num_trainable_parameters": 24861, "num_env_steps_trained": 33000, "num_module_steps_trained": 11970, "num_module_steps_trained_lifetime": 191520, "num_env_steps_trained_lifetime_throughput": 3998.556747444328, "num_module_steps_trained_throughput": 20350994.429143004, "num_module_steps_trained_lifetime_throughput": 12557608.067342702}, "IntrinsicAttentionMask": [[[0.09101906418800354, 0.09171493351459503, 0.09023334830999374, 0.09077367186546326, 0.09118928760290146, 0.09119436144828796, 0.0907888114452362, 0.09025844186544418, 0.09175063669681549, 0.09026847779750824, 0.09080900996923447], [0.09114048629999161, 0.09263408929109573, 0.0894695296883583, 0.09061684459447861, 0.09150466322898865, 0.09151551872491837, 0.09064912050962448, 0.08952263742685318, 0.09271107614040375, 0.0895438864827156, 0.09069216251373291], [0.09087655693292618, 0.0906752273440361, 0.09110628068447113, 0.09094802290201187, 0.09082712233066559, 0.0908256471157074, 0.09094361215829849, 0.09109890460968018, 0.09066494554281235, 0.0910959541797638, 0.09093771874904633], [0.09097517281770706, 0.09139041602611542, 0.09050477296113968, 0.09082843363285065, 0.09107686579227448, 0.09107989817857742, 0.0908374935388565, 0.09051982313394547, 0.09141168743371964, 0.09052584320306778, 0.09084957838058472], [0.0910491794347763, 0.09193991869688034, 0.09004569798707962, 0.09073550999164581, 0.09126689285039902, 0.09127338230609894, 0.09075485914945602, 0.090077705681324, 0.09198567271232605, 0.09009050577878952, 0.09078066051006317], [0.09105008095502853, 0.09194663166999817, 0.09004012495279312, 0.09073437750339508, 0.09126920998096466, 0.09127573668956757, 0.09075385332107544, 0.09007234126329422, 0.09199268370866776, 0.0900852233171463, 0.09077982604503632], [0.09097789973020554, 0.09141045063734055, 0.0904879942536354, 0.09082506597042084, 0.091083824634552, 0.0910869762301445, 0.09083449840545654, 0.09050367027521133, 0.0914326086640358, 0.09050993621349335, 0.09084708243608475], [0.09088119864463806, 0.09070846438407898, 0.09107823669910431, 0.09094250947237015, 0.09083878993988037, 0.09083753079175949, 0.09093871712684631, 0.09107191115617752, 0.09069964289665222, 0.09106938540935516, 0.0909336656332016], [0.09114659577608109, 0.09268121421337128, 0.08943057060241699, 0.09060874581336975, 0.09152071177959442, 0.09153186529874802, 0.09064188599586487, 0.08948510140180588, 0.09276033192873001, 0.08950691670179367, 0.09068609029054642], [0.0908830463886261, 0.0907217487692833, 0.09106701612472534, 0.09094029664993286, 0.09084345400333405, 0.09084227681159973, 0.09093675762414932, 0.09106110781431198, 0.0907135158777237, 0.09105874598026276, 0.09093204140663147], [0.09098153561353683, 0.09143716096878052, 0.09046562761068344, 0.0908205658197403, 0.09109310060739517, 0.0910964235663414, 0.09083050489425659, 0.09048212319612503, 0.09146051108837128, 0.0904887244105339, 0.09084375947713852]], [[0.09218297898769379, 0.09114568680524826, 0.09115121513605118, 0.09219975769519806, 0.09220535308122635, 0.09116780757904053, 0.09117334336042404, 0.09222213923931122, 0.08237284421920776, 0.09230390191078186, 0.09187500923871994], [0.09035886079072952, 0.09078489989042282, 0.09078260511159897, 0.09035202860832214, 0.09034974873065948, 0.0907757356762886, 0.09077344834804535, 0.09034290909767151, 0.09468542039394379, 0.09030963480472565, 0.09048464149236679], [0.09036902338266373, 0.09078731387853622, 0.09078506380319595, 0.0903623104095459, 0.09036007523536682, 0.09077832102775574, 0.09077607095241547, 0.09035336226224899, 0.09461523592472076, 0.09032069146633148, 0.09049251675605774], [0.09221118688583374, 0.09115009009838104, 0.09115574508905411, 0.09222835302352905, 0.09223407506942749, 0.0911727175116539, 0.09117837250232697, 0.0922512486577034, 0.0821872130036354, 0.09233490377664566, 0.09189611673355103], [0.09222058206796646, 0.09115155041217804, 0.09115725010633469, 0.09223788231611252, 0.09224364161491394, 0.09117434173822403, 0.09118004888296127, 0.0922609493136406, 0.08212541788816452, 0.092345230281353, 0.09190315008163452], [0.09039947390556335, 0.09079450368881226, 0.09079238027334213, 0.09039313346147537, 0.09039101749658585, 0.09078601002693176, 0.09078388661146164, 0.09038468450307846, 0.09440493583679199, 0.090353824198246, 0.0905161127448082], [0.09040962159633636, 0.09079689532518387, 0.09079481661319733, 0.09040340781211853, 0.09040133655071259, 0.0907885730266571, 0.09078649431467056, 0.09039512276649475, 0.09433493763208389, 0.09036486595869064, 0.09052398055791855], [0.09224873781204224, 0.09115588665008545, 0.09116171300411224, 0.09226642549037933, 0.0922723188996315, 0.09117918461561203, 0.09118501096963882, 0.0922900065779686, 0.08194028586149216, 0.09237617999315262, 0.09192419797182083], [0.06666480004787445, 0.07729671150445938, 0.07723541557788849, 0.06650632619857788, 0.06645358353853226, 0.0770518109202385, 0.07699070870876312, 0.06629560887813568, 0.2903265058994293, 0.06553180515766144, 0.06964679062366486], [0.09238536655902863, 0.09117643535137177, 0.0911828801035881, 0.09240493923425674, 0.09241146594285965, 0.09120219945907593, 0.09120863676071167, 0.09243105351924896, 0.08104434609413147, 0.09252644330263138, 0.09202619642019272], [0.0916580781340599, 0.09105705469846725, 0.09106027334928513, 0.0916677787899971, 0.09167100489139557, 0.09106990694999695, 0.09107311815023422, 0.09168071299791336, 0.08585426956415176, 0.09172795712947845, 0.09147993475198746]], [[0.09101957082748413, 0.09117458760738373, 0.09076912701129913, 0.09077417850494385, 0.09118980169296265, 0.09119486808776855, 0.09025392681360245, 0.09079436957836151, 0.09175115078687668, 0.09026898443698883, 0.09080951660871506], [0.09104728698730469, 0.09124168753623962, 0.09073338657617569, 0.09073971211910248, 0.09126076847314835, 0.09126713126897812, 0.09008833765983582, 0.09076501429080963, 0.09196547418832779, 0.09010718017816544, 0.09078399091959], [0.09097443521022797, 0.09106575697660446, 0.09082674980163574, 0.09082973003387451, 0.09107471257448196, 0.09107770770788193, 0.0905224084854126, 0.0908416360616684, 0.09140488505363464, 0.09053131937980652, 0.0908505767583847], [0.09097535163164139, 0.09106796234846115, 0.09082559496164322, 0.09082861244678497, 0.0910770446062088, 0.09108007699251175, 0.09051699191331863, 0.09084068983793259, 0.09141186624765396, 0.0905260220170021, 0.09084974974393845], [0.09104999899864197, 0.09124825894832611, 0.09072988480329514, 0.09073632955551147, 0.09126771986484528, 0.0912742093205452, 0.09007211774587631, 0.09076213091611862, 0.0919865071773529, 0.09009132534265518, 0.09078148752450943], [0.09105090796947479, 0.0912504494190216, 0.09072870761156082, 0.09073520451784134, 0.09127003699541092, 0.09127657115459442, 0.09006671607494354, 0.09076116979122162, 0.09199351817369461, 0.09008604288101196, 0.09078065305948257], [0.09088029712438583, 0.0908403992652893, 0.09094494581222534, 0.09094364196062088, 0.09083648771047592, 0.09083518385887146, 0.09107864648103714, 0.09093842655420303, 0.09069272875785828, 0.09107472747564316, 0.09093450754880905], [0.09097900241613388, 0.09107675403356552, 0.09082095324993134, 0.09082413464784622, 0.09108634293079376, 0.09108953922986984, 0.09049530327320099, 0.09083689004182816, 0.09143978357315063, 0.09050482511520386, 0.09084644913673401], [0.09114903211593628, 0.09148968756198883, 0.09060011804103851, 0.09061115980148315, 0.09152314811944962, 0.09153430908918381, 0.089476577937603, 0.09065534919500351, 0.09276280552148819, 0.08950930088758469, 0.09068851172924042], [0.09088307619094849, 0.09084701538085938, 0.09094149619340897, 0.09094031900167465, 0.09084347635507584, 0.09084229916334152, 0.09106231480836868, 0.0909356027841568, 0.09071353822946548, 0.09105876833200455, 0.09093206375837326], [0.09098175168037415, 0.0910833477973938, 0.09081747382879257, 0.0908207818865776, 0.09109331667423248, 0.09109663963317871, 0.0904790386557579, 0.09083403646945953, 0.09146072715520859, 0.09048894047737122, 0.09084397554397583]], [[0.08995217084884644, 0.08871414512395859, 0.08872073143720627, 0.08997222781181335, 0.09069285541772842, 0.0887405127286911, 0.08945127576589584, 0.09071307629346848, 0.10355889052152634, 0.09009669721126556, 0.089387446641922], [0.09104415029287338, 0.09124113619327545, 0.09124007821083069, 0.09104098379611969, 0.09092777967453003, 0.0912369042634964, 0.09112346917390823, 0.09092462062835693, 0.08906587958335876, 0.0910213515162468, 0.09113360941410065], [0.09103885293006897, 0.09122799336910248, 0.0912269800901413, 0.09103581309318542, 0.0909271165728569, 0.09122393280267715, 0.09111501276493073, 0.09092407673597336, 0.08913848549127579, 0.09101696312427521, 0.0911247581243515], [0.08993284404277802, 0.0886722207069397, 0.08867893368005753, 0.08995326608419418, 0.09068719297647476, 0.08869907259941101, 0.08942276984453201, 0.09070777893066406, 0.10380814969539642, 0.09008002281188965, 0.08935777097940445], [0.08920223265886307, 0.08714452385902405, 0.08715542405843735, 0.08923572301864624, 0.09044262766838074, 0.08718814700841904, 0.08836735039949417, 0.09047657996416092, 0.11308250576257706, 0.08944372087717056, 0.0882612019777298], [0.09102291613817215, 0.09118852764368057, 0.09118763357400894, 0.09102025628089905, 0.09092506766319275, 0.09118497371673584, 0.09108961373567581, 0.09092240780591965, 0.08935660123825073, 0.09100375324487686, 0.09109813719987869], [0.09041783213615417, 0.08975085616111755, 0.08975441753864288, 0.09042859822511673, 0.09081481397151947, 0.08976510912179947, 0.09014849364757538, 0.0908256322145462, 0.09748470783233643, 0.09049540758132935, 0.09011412411928177], [0.08918071538209915, 0.0871010571718216, 0.08711207658052444, 0.08921457082033157, 0.09043459594249725, 0.08714514225721359, 0.08833687007427216, 0.09046892821788788, 0.11335170269012451, 0.08942481875419617, 0.08822957426309586], [0.06392167508602142, 0.05356892570853233, 0.053619690239429474, 0.06410358846187592, 0.07096651941537857, 0.05377229303121567, 0.05952915549278259, 0.07116847485303879, 0.385116308927536, 0.06524349004030228, 0.05898986756801605], [0.08981164544820786, 0.08841132372617722, 0.08841877430677414, 0.08983434736728668, 0.09065065532922745, 0.08844112604856491, 0.0892447754740715, 0.09067357331514359, 0.10536593943834305, 0.08997529000043869, 0.08917257189750671], [0.09047479927539825, 0.0898815467953682, 0.08988470584154129, 0.0904843732714653, 0.09082768857479095, 0.08989422023296356, 0.09023529291152954, 0.09083729982376099, 0.09673147648572922, 0.09054377675056458, 0.09020472317934036]], [[0.09116598218679428, 0.09132124483585358, 0.09037899971008301, 0.09038402885198593, 0.09133648872375488, 0.09134156256914139, 0.0903991088271141, 0.09040413796901703, 0.09189873933792114, 0.09041418880224228, 0.09095559269189835], [0.09123073518276215, 0.09142552316188812, 0.09024468809366226, 0.09025097638368607, 0.09144464880228043, 0.0914510190486908, 0.09026984870433807, 0.09027614444494247, 0.09215077012777328, 0.09028872847557068, 0.09096691012382507], [0.090833880007267, 0.09078887850046158, 0.0910634994506836, 0.0910620242357254, 0.0907844752073288, 0.0907829999923706, 0.09105759859085083, 0.09105613082647324, 0.09062237292528152, 0.09105317294597626, 0.09089501202106476], [0.09083601832389832, 0.09079229831695557, 0.09105910360813141, 0.0910576730966568, 0.09078800678253174, 0.09078658372163773, 0.09105337411165237, 0.09105193614959717, 0.09063050895929337, 0.09104908257722855, 0.09089541435241699], [0.09123707562685013, 0.0914357453584671, 0.0902315303683281, 0.09023793786764145, 0.09145524352788925, 0.09146174788475037, 0.0902571827173233, 0.09026360511779785, 0.09217550605535507, 0.09027642756700516, 0.09096801280975342], [0.09123919159173965, 0.0914391502737999, 0.0902271419763565, 0.09023359417915344, 0.0914587751030922, 0.09146532416343689, 0.09025296568870544, 0.09025941789150238, 0.09218375384807587, 0.09027232974767685, 0.09096837788820267], [0.09084244072437286, 0.09080255776643753, 0.09104593098163605, 0.09104461967945099, 0.09079864621162415, 0.09079734236001968, 0.0910407081246376, 0.09103939682245255, 0.09065494686365128, 0.09103678911924362, 0.0908966213464737], [0.09084457159042358, 0.09080597013235092, 0.09104153513908386, 0.09104026854038239, 0.09080218523740768, 0.0908009260892868, 0.09103647619485855, 0.09103520959615707, 0.09066309034824371, 0.09103268384933472, 0.09089702367782593], [0.09146937727928162, 0.09181123226881027, 0.08974727988243103, 0.08975821733474731, 0.09184481203556061, 0.09185601025819778, 0.08979105204343796, 0.08980199694633484, 0.09308882802724838, 0.0898238942027092, 0.09100724011659622], [0.09084886312484741, 0.0908128172159195, 0.09103275835514069, 0.09103157371282578, 0.09080928564071655, 0.09080810099840164, 0.09102803468704224, 0.09102685749530792, 0.09067939221858978, 0.0910244956612587, 0.09089783579111099], [0.09107783436775208, 0.09117954224348068, 0.09056137502193451, 0.09056468307971954, 0.09118951112031937, 0.09119284152984619, 0.09057459235191345, 0.09057789295911789, 0.09155731648206711, 0.09058450162410736, 0.09093990921974182]], [[0.09075478464365005, 0.08869172632694244, 0.08754708617925644, 0.08960560709238052, 0.08961665630340576, 0.08757945895195007, 0.08759026229381561, 0.08964980393648148, 0.11168186366558075, 0.08864136785268784, 0.08864136785268784], [0.09090849757194519, 0.09027665853500366, 0.08992167562246323, 0.09055779874324799, 0.09056118130683899, 0.08993176370859146, 0.08993512392044067, 0.0905713438987732, 0.0968136414885521, 0.09026110917329788, 0.09026110917329788], [0.09090198576450348, 0.0910908430814743, 0.09119770675897598, 0.09100659936666489, 0.0910055860877037, 0.09119465947151184, 0.09119364619255066, 0.09100255370140076, 0.08921542018651962, 0.09109551459550858, 0.09109551459550858], [0.09086713194847107, 0.08959342539310455, 0.08888179808855057, 0.09015904366970062, 0.0901658684015274, 0.08890198171138763, 0.08890870958566666, 0.09018634259700775, 0.10321138054132462, 0.08956219255924225, 0.08956219255924225], [0.09086637198925018, 0.08958498388528824, 0.088869109749794, 0.09015399217605591, 0.09016085416078568, 0.08888940513134003, 0.08889617770910263, 0.09018145501613617, 0.10329053550958633, 0.08955355733633041, 0.08955355733633041], [0.09090303629636765, 0.09106843173503876, 0.09116199612617493, 0.09099466353654861, 0.09099377691745758, 0.09115932881832123, 0.0911584421992302, 0.09099110960960388, 0.08942412585020065, 0.09107252210378647, 0.09107252210378647], [0.0909033790230751, 0.09106095135211945, 0.09115008264780045, 0.09099067002534866, 0.09098982065916061, 0.0911475419998169, 0.09114670008420944, 0.09098728746175766, 0.08949379622936249, 0.09106484800577164, 0.09106484800577164], [0.09086406230926514, 0.08955961465835571, 0.08883101493120193, 0.09013883024454117, 0.09014581143856049, 0.0888516753911972, 0.08885856717824936, 0.09016677737236023, 0.10352833569049835, 0.08952763676643372, 0.08952763676643372], [0.07623899728059769, 0.06447772681713104, 0.05865469574928284, 0.06947850435972214, 0.06954094767570496, 0.05881297215819359, 0.05886583402752876, 0.06972861289978027, 0.34577876329421997, 0.06421145051717758, 0.06421145051717758], [0.09090956300497055, 0.09031344950199127, 0.08997843414545059, 0.09057872742414474, 0.09058192372322083, 0.08998795598745346, 0.08999112993478775, 0.09059150516986847, 0.09646973013877869, 0.09029877930879593, 0.09029877930879593], [0.09090956300497055, 0.09031344950199127, 0.08997843414545059, 0.09057872742414474, 0.09058192372322083, 0.08998795598745346, 0.08999112993478775, 0.09059150516986847, 0.09646973013877869, 0.09029877930879593, 0.09029877930879593]]]}, "num_training_step_calls_per_iteration": 1, "evaluation": {"env_runners": {"module_to_env_connector": {"timers": {"connectors": {"tensor_to_numpy": 1.5521817815254403e-05, "un_batch_to_individual_items": 6.615788483095929e-06, "get_actions": 3.7691961801536576e-05, "listify_data_for_vector_env": 1.0576169509593604e-05, "normalize_and_clip_actions": 8.077452708012883e-06, "remove_single_ts_time_rank_from_batch": 1.2024781048591089e-05}}, "connector_pipeline_timer": 0.00011689698771732704}, "episode_len_min": 20, "num_env_steps_sampled": 400, "weights_seq_no": 16.0, "episode_len_mean": 20.0, "env_to_module_sum_episodes_length_out": 10.368238394574323, "episode_len_max": 20, "env_to_module_connector": {"timers": {"connectors": {"batch_individual_items": 1.2940547933877027e-05, "add_observations_from_episodes_to_batch": 2.8262669908180016e-06, "add_states_from_episodes_to_batch": 2.8838317225767404e-06, "add_time_dim_to_batch_and_zero_pad": 6.923526658568755e-06, "numpy_to_tensor": 1.2329688067137727e-05}}, "connector_pipeline_timer": 6.015615396323762e-05}, "env_to_module_sum_episodes_length_in": 10.368238394574323, "num_episodes_lifetime": 320, "episode_duration_sec_mean": 0.005252252501668409, "episode_return_max": 12.5, "rlmodule_inference_timer": 3.2055798746495165e-05, "num_agent_steps_sampled": {"default_agent": 400}, "num_module_steps_sampled_lifetime": {"default_policy": 6400}, "num_agent_steps_sampled_lifetime": {"default_agent": 6400}, "num_module_steps_sampled": {"default_policy": 400}, "sample": 0.13109436176439312, "episode_return_mean": 0.4, "env_step_timer": 1.4540602103852665e-05, "agent_episode_returns_mean": {"default_agent": 0.4}, "num_episodes": 20, "module_episode_returns_mean": {"default_policy": 0.4}, "episode_return_min": -12.5, "num_env_steps_sampled_lifetime": 80400, "env_reset_timer": 0.00054870756971442, "time_between_sampling": 12.263005581132424}, "num_healthy_workers": 1, "actor_manager_num_outstanding_async_reqs": 0, "num_remote_worker_restarts": 0}, "num_env_steps_sampled_lifetime": -8635000.0, "fault_tolerance": {"num_healthy_workers": 0, "num_remote_worker_restarts": 0}, "env_runner_group": {"actor_manager_num_outstanding_async_reqs": 0}, "done": false, "training_iteration": 16, "trial_id": "ae8a2_00000", "date": "2025-08-11_18-25-20", "timestamp": 1754929520, "time_this_iter_s": 9.187092304229736, "time_total_s": 173.4336895942688, "pid": 10870, "hostname": "Mac", "node_ip": "127.0.0.1", "config": {"exploration_config": {}, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 2, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "env": "Umbrella", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": false, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 0, "create_local_env_runner": true, "num_envs_per_env_runner": 1, "gym_env_vectorize_mode": "SYNC", "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "episodes_to_numpy": true, "max_requests_in_flight_per_env_runner": 1, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "merge_env_runner_states": "training_only", "broadcast_env_runner_states": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "complete_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "sampler_perf_stats_ema_coef": null, "_is_online": true, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": "auto", "num_aggregator_actors_per_learner": 0, "max_requests_in_flight_per_aggregator_actor": 3, "local_gpu_idx": 0, "max_requests_in_flight_per_learner": 3, "gamma": 1, "lr": 0.0002715581955, "grad_clip": 0.5, "grad_clip_by": "global_norm", "_train_batch_size_per_learner": 5000, "train_batch_size": 4000, "num_epochs": 1, "minibatch_size": 1000, "shuffle_batch_per_epoch": true, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "log_std_clip_param": 20.0, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "_disable_preprocessor_api": false, "_disable_action_flattening": false}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {"intrinsic_reward_coeff": 0.2795015916508}, "optimizer": {}, "_learner_class": "<class 'source.intrinsic_attention_ppo.learners.IntrinsicAttentionMetaLearner.IntrinsicAttentionMetaLearner'>", "callbacks_on_algorithm_init": null, "callbacks_on_env_runners_recreated": null, "callbacks_on_offline_eval_runners_recreated": null, "callbacks_on_checkpoint_loaded": null, "callbacks_on_environment_created": null, "callbacks_on_episode_created": null, "callbacks_on_episode_start": null, "callbacks_on_episode_step": null, "callbacks_on_episode_end": null, "callbacks_on_evaluate_start": null, "callbacks_on_evaluate_end": null, "callbacks_on_evaluate_offline_start": null, "callbacks_on_evaluate_offline_end": null, "callbacks_on_sample_end": null, "callbacks_on_train_result": null, "explore": true, "enable_rl_module_and_learner": true, "enable_env_runner_and_connector_v2": true, "_prior_exploration_config": {"type": "StochasticSampling"}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x38844d8a0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "offline_data_class": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_read_batch_size": null, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "materialize_data": false, "materialize_mapped_data": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "ignore_final_observation": false, "prelearner_class": null, "prelearner_buffer_class": null, "prelearner_buffer_kwargs": {}, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_remaining_data": false, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": 1, "evaluation_duration": 20, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_auto_duration_min_env_steps_per_sample": 100, "evaluation_auto_duration_max_env_steps_per_sample": 2000, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 1, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "offline_evaluation_interval": null, "num_offline_eval_runners": 0, "offline_loss_for_module_fn": null, "offline_evaluation_duration": 1, "offline_evaluation_parallel_to_training": false, "offline_evaluation_timeout_s": 120.0, "num_cpus_per_offline_eval_runner": 1, "num_gpus_per_offline_eval_runner": 0, "custom_resources_per_offline_eval_runner": {}, "restart_failed_offline_eval_runners": true, "ignore_offline_eval_runner_failures": false, "max_num_offline_eval_runner_restarts": 1000, "offline_eval_runner_restore_timeout_s": 1800.0, "max_requests_in_flight_per_offline_eval_runner": 1, "validate_offline_eval_runners_after_construction": true, "offline_eval_runner_health_probe_timeout_s": 30.0, "offline_eval_rl_module_inference_only": false, "broadcast_offline_eval_runner_states": false, "offline_eval_batch_size_per_runner": 256, "dataset_num_iters_per_eval_runner": 1, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "log_gradients": false, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 1, "restart_failed_env_runners": true, "ignore_env_runner_failures": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30.0, "env_runner_restore_timeout_s": 1800.0, "_model_config": {}, "_rl_module_spec": "MultiRLModuleSpec(multi_rl_module_class=<class 'ray.rllib.core.rl_module.multi_rl_module.MultiRLModule'>, observation_space=None, action_space=None, inference_only=False, model_config=None, rl_module_specs={'default_policy': RLModuleSpec(module_class=<class 'source.intrinsic_attention_ppo.rl_modules.DifferentiablePPOModule.DifferentiablePPOModule'>, observation_space=None, action_space=None, inference_only=False, learner_only=False, model_config={'vf_share_layers': True, 'embedding_dim': 62, 'max_seq_len': 11, 'policy_head_hidden_sizes': [32], 'value_head_hidden_sizes': [101], 'embedding_hidden_sizes': [121]}, catalog_class=None, load_state_path=None, model_config_dict=None), 'intrinsic_reward_module': RLModuleSpec(module_class=<class 'source.intrinsic_attention_ppo.rl_modules.IntrinsicAttentionModule.IntrinsicAttentionModule'>, observation_space=None, action_space=None, inference_only=False, learner_only=True, model_config={'intrinsic_reward_network': {'encoder_hidden_sizes': [], 'encoding_dim': 1, 'num_heads': 1, 'head_hidden_sizes': None, 'layers': [{'type': 'attention'}]}, 'extrinsic_value_hidden_layers': [127, 60], 'vf_share_layers': True, 'max_seq_len': 11}, catalog_class=None, load_state_path=None, model_config_dict=None)}, load_state_path=None, modules_to_load=None, module_specs={'default_policy': RLModuleSpec(module_class=<class 'source.intrinsic_attention_ppo.rl_modules.DifferentiablePPOModule.DifferentiablePPOModule'>, observation_space=None, action_space=None, inference_only=False, learner_only=False, model_config={'vf_share_layers': True, 'embedding_dim': 62, 'max_seq_len': 11, 'policy_head_hidden_sizes': [32], 'value_head_hidden_sizes': [101], 'embedding_hidden_sizes': [121]}, catalog_class=None, load_state_path=None, model_config_dict=None), 'intrinsic_reward_module': RLModuleSpec(module_class=<class 'source.intrinsic_attention_ppo.rl_modules.IntrinsicAttentionModule.IntrinsicAttentionModule'>, observation_space=None, action_space=None, inference_only=False, learner_only=True, model_config={'intrinsic_reward_network': {'encoder_hidden_sizes': [], 'encoding_dim': 1, 'num_heads': 1, 'head_hidden_sizes': None, 'layers': [{'type': 'attention'}]}, 'extrinsic_value_hidden_layers': [127, 60], 'vf_share_layers': True, 'max_seq_len': 11}, catalog_class=None, load_state_path=None, model_config_dict=None)})", "algorithm_config_overrides_per_module": {"intrinsic_reward_module": {"lr": 0.0002715581955}}, "_per_module_overrides": {}, "_validate_config": true, "_use_msgpack_checkpoints": false, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "env_task_fn": -1, "enable_connectors": -1, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.161583927863, "kl_target": 0.0201019014258, "vf_loss_coeff": 0.7790510010087, "entropy_coeff": 0.0015431216992, "clip_param": 0.2459212356676, "vf_clip_param": 0.3769744131561, "entropy_coeff_schedule": null, "lr_schedule": null, "sgd_minibatch_size": -1, "vf_share_layers": -1, "differentiable_learner_configs": ["DifferentiableLearnerConfig(learner_class=<class 'source.intrinsic_attention_ppo.learners.IntrinsicAttentionPPOLearner.IntrinsicAttentionPPOLearner'>, learner_connector=None, add_default_connectors_to_learner_pipeline=True, is_multi_agent=False, policies_to_update=['default_policy'], lr=0.0060984166342, num_total_minibatches=0, num_epochs=1, minibatch_size=1000, shuffle_batch_per_epoch=True)"], "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9485408017724, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.callbacks.callbacks.RLlibCallback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 173.4336895942688, "iterations_since_restore": 16, "perf": {"cpu_util_percent": 38.5, "ram_util_percent": 78.0923076923077}}
{"timers": {"training_iteration": 12.325173402644172, "restore_env_runners": 1.1888364370037642e-05, "training_step": 12.324972161316675, "env_runner_sampling_timer": 2.766038654412503, "learner_update_timer": 9.342810400186831, "synch_weights": 0.0016167925891621769, "restore_eval_env_runners": 5.097312802051229e-05, "evaluation_iteration": 0.142720151994752, "synch_eval_env_connectors": 0.00022088574011841082, "synch_env_connectors": 5.9510336788264575e-06}, "env_runners": {"module_to_env_connector": {"connector_pipeline_timer": 0.00011811122111256219, "timers": {"connectors": {"remove_single_ts_time_rank_from_batch": 1.194542548694158e-05, "un_batch_to_individual_items": 6.528634946346479e-06, "get_actions": 3.9207576107966426e-05, "tensor_to_numpy": 1.5060145370302003e-05, "listify_data_for_vector_env": 1.0509986050556374e-05, "normalize_and_clip_actions": 7.982178271488262e-06}}}, "rlmodule_inference_timer": 3.1578253968193286e-05, "sample": 0.005628830173435797, "weights_seq_no": 16.0, "num_agent_steps_sampled": {"default_agent": 5000.0}, "episode_len_mean": 20.0, "episode_len_max": 20, "env_to_module_connector": {"timers": {"connectors": {"batch_individual_items": 1.2395461600878946e-05, "add_states_from_episodes_to_batch": 2.715648367105284e-06, "numpy_to_tensor": 1.2644484019724982e-05, "add_observations_from_episodes_to_batch": 2.8037511057748744e-06, "add_time_dim_to_batch_and_zero_pad": 6.875466945437646e-06}}, "connector_pipeline_timer": 5.983720134358745e-05}, "env_to_module_sum_episodes_length_out": 10.36823839457432, "num_agent_steps_sampled_lifetime": {"default_agent": -9252500.0}, "episode_return_mean": 1.5, "num_module_steps_sampled_lifetime": {"default_policy": -9252500.0}, "num_episodes": 250.0, "time_between_sampling": 0.031390276601528565, "num_env_steps_sampled_lifetime": -9252500.0, "episode_return_min": -10.5, "env_reset_timer": 4.088362996831861e-05, "env_to_module_sum_episodes_length_in": 10.36823839457432, "num_episodes_lifetime": -462625.0, "agent_episode_returns_mean": {"default_agent": 1.5}, "episode_len_min": 20, "episode_duration_sec_mean": 0.005288056110497562, "env_step_timer": 1.4136264686854623e-05, "episode_return_max": 9.5, "num_module_steps_sampled": {"default_policy": 5000.0}, "module_episode_returns_mean": {"default_policy": 1.5}, "num_env_steps_sampled": 5000.0, "num_env_steps_sampled_lifetime_throughput": 3241.4688306047933}, "__all_modules__": {"learner_connector_sum_episodes_length_in": 5000.0, "learner_connector": {"connector_pipeline_timer": 0.1593833603599411, "timers": {"connectors": {"add_one_ts_to_episodes_and_truncate": 0.009319315895328003, "add_observations_from_episodes_to_batch": 0.001571383299173485, "add_columns_from_episodes_to_train_batch": 0.049003071410937446, "add_time_dim_to_batch_and_zero_pad": 0.08445843190886484, "add_states_from_episodes_to_batch": 0.008468776266313737, "batch_individual_items": 0.006229963695881204, "numpy_to_tensor": 9.405392579686002e-05}}}, "learner_connector_sum_episodes_length_out": 5250.0}, "learners": {"default_policy": {"curr_entropy_coeff": 0.0015431216992, "curr_kl_coeff": 1.2327875538176158e-06, "num_module_steps_trained_lifetime": 101745, "entropy": 0.6775363087654114, "num_module_steps_trained": 5985, "diff_num_grad_updates_vs_sampler_policy": 1.0, "vf_loss": 0.35831186175346375, "vf_loss_unclipped": 43.60216522216797, "policy_loss": -0.0001908348494907841, "use_intrinsic_rewards": 0.0, "total_loss": 0.2779068648815155, "vf_explained_var": 0.00034052133560180664, "mean_kl_loss": 3.796216697082855e-05, "weights_seq_no": 17.0, "num_trainable_parameters": 16595, "module_train_batch_size_mean": 997.6777629636601, "num_module_steps_trained_lifetime_throughput": 724.0484439131283}, "intrinsic_reward_module": {"num_module_steps_trained_lifetime": 101745, "num_module_steps_trained": 5985, "diff_num_grad_updates_vs_sampler_policy": 1.0, "total_loss": 0.0, "gradients_default_optimizer_global_norm": 0.0, "module_train_batch_size_mean": 997.6777629636601, "default_optimizer_learning_rate": 0.0002715581955, "weights_seq_no": 17.0, "num_trainable_parameters": 8266, "curr_entropy_coeff": 0.0015431216992, "num_module_steps_trained_lifetime_throughput": 724.054550649702}, "differentiable_learners": {"intrinsic_attention_ppo_learner": {"default_policy": {"weights_seq_no": 102.0, "num_module_steps_trained": 35910, "num_module_steps_trained_lifetime": 610470, "entropy": 0.6775534749031067, "diff_num_grad_updates_vs_sampler_policy": 86.0, "vf_loss": 0.3584156036376953, "vf_loss_unclipped": 43.65528869628906, "total_loss": 0.2779969871044159, "mean_kl_loss": 3.711589670274407e-05, "policy_loss": -0.00018752161122392863, "use_intrinsic_rewards": 1.0, "module_train_batch_size_mean": 997.498558675304, "vf_explained_var": -0.0014966726303100586}, "__all_modules__": {"num_env_steps_trained": 198000, "num_module_steps_trained": 71820, "num_module_steps_trained_lifetime": 1220940, "num_env_steps_trained_lifetime": 3366000, "num_env_steps_trained_lifetime_throughput": 34671.64197590437}, "intrinsic_reward_module": {"weights_seq_no": 102.0, "num_module_steps_trained_lifetime": 610470, "num_module_steps_trained": 35910, "diff_num_grad_updates_vs_sampler_policy": 86.0, "total_loss": 0.0, "module_train_batch_size_mean": 997.498558675304}}}, "__all_modules__": {"num_env_steps_trained_lifetime": 561000, "num_non_trainable_parameters": 0, "num_trainable_parameters": 24861, "num_env_steps_trained": 33000, "num_module_steps_trained": 11970, "num_module_steps_trained_lifetime": 203490, "num_env_steps_trained_lifetime_throughput": 3993.359937565052, "num_module_steps_trained_throughput": 19904311.575213164, "num_module_steps_trained_lifetime_throughput": 12529847.05787739}, "IntrinsicAttentionMask": [[[0.09239257872104645, 0.09240224212408066, 0.09061718732118607, 0.0896240770816803, 0.09140868484973907, 0.09141825139522552, 0.09065510332584381, 0.08966158330440521, 0.09144693613052368, 0.08968034386634827, 0.09069303423166275], [0.09239913523197174, 0.09240884333848953, 0.0906158834695816, 0.08961843699216843, 0.09141086786985397, 0.09142047166824341, 0.09065396338701248, 0.08965609967708588, 0.09144928306341171, 0.0896749347448349, 0.09069205820560455], [0.09117978811264038, 0.09118153154850006, 0.09085631370544434, 0.09067310392856598, 0.09100115299224854, 0.09100289642810822, 0.09086327999830246, 0.09068005532026291, 0.09100812673568726, 0.09068353474140167, 0.09087023884057999], [0.09049507230520248, 0.09049241244792938, 0.0909893810749054, 0.09127133339643478, 0.09076748788356781, 0.09076482057571411, 0.0909786969423294, 0.09126061946153641, 0.09075683355331421, 0.09125525504350662, 0.09096801280975342], [0.09172223508358002, 0.09172750264406204, 0.09074988216161728, 0.0902022272348404, 0.09118442982435226, 0.0911896675825119, 0.09077073633670807, 0.09022295475006104, 0.09120538085699081, 0.09023331850767136, 0.09079159796237946], [0.09172876924276352, 0.09173408150672913, 0.09074859321117401, 0.09019657224416733, 0.09118662774562836, 0.09119190275669098, 0.09076961874961853, 0.0902174711227417, 0.09120775014162064, 0.09022791683673859, 0.09079064428806305], [0.09120583534240723, 0.09120775014162064, 0.09085121750831604, 0.09065043181180954, 0.09100999683141708, 0.0910119041800499, 0.09085885435342789, 0.090658038854599, 0.09101764112710953, 0.09066185355186462, 0.09086648374795914], [0.09052102267742157, 0.0905185267329216, 0.09098437428474426, 0.09124860167503357, 0.09077639877796173, 0.09077390283346176, 0.0909743681550026, 0.09123855829238892, 0.09076640754938126, 0.09123353660106659, 0.09096435457468033], [0.09174838662147522, 0.09175382554531097, 0.0907447412610054, 0.09017961472272873, 0.09119322150945663, 0.09119863063097, 0.09076626598834991, 0.0902010053396225, 0.0912148579955101, 0.09021170437335968, 0.09078779816627502], [0.09053399413824081, 0.09053158015012741, 0.0909818708896637, 0.09123723208904266, 0.09078085422515869, 0.09077843278646469, 0.09097219258546829, 0.09122752398252487, 0.09077119082212448, 0.09122267365455627, 0.09096251428127289], [0.09123189002275467, 0.09123397618532181, 0.09084612876176834, 0.0906277596950531, 0.09101883322000504, 0.09102091193199158, 0.09085442870855331, 0.09063603729009628, 0.0910271480679512, 0.09064017981290817, 0.09086272865533829]], [[0.08988891541957855, 0.08935517072677612, 0.08865834772586823, 0.09062235057353973, 0.09062907844781876, 0.08867810666561127, 0.08938837051391602, 0.08993568271398544, 0.10348603874444962, 0.09003334492444992, 0.08932459354400635], [0.09041519463062286, 0.09014461934566498, 0.08979015052318573, 0.09078570455312729, 0.09078910201787949, 0.08980022370815277, 0.09016147255897522, 0.09043886512517929, 0.0970572978258133, 0.09048827737569809, 0.09012908488512039], [0.09104867279529572, 0.09112991392612457, 0.09123682230710983, 0.09093794226646423, 0.09093692898750305, 0.09123377501964569, 0.09112484753131866, 0.09104157984256744, 0.08914811164140701, 0.09102678298950195, 0.09113458544015884], [0.08910577744245529, 0.08821984380483627, 0.08706862479448318, 0.09032897651195526, 0.09034023433923721, 0.08710118383169174, 0.08827485144138336, 0.08918356895446777, 0.11286161094903946, 0.08934611082077026, 0.08816919475793839], [0.089098259806633, 0.08820915967226028, 0.08705384284257889, 0.09032589942216873, 0.09033720195293427, 0.08708652853965759, 0.0882643535733223, 0.08917633444070816, 0.1129506528377533, 0.0893394723534584, 0.08815831691026688], [0.0910315290093422, 0.09110266715288162, 0.09119626134634018, 0.09093454480171204, 0.090933658182621, 0.09119359403848648, 0.09109821915626526, 0.09102531522512436, 0.08936505764722824, 0.09101235866546631, 0.09110675007104874], [0.09038351476192474, 0.09009639173746109, 0.08972035348415375, 0.09077674895524979, 0.0907803475856781, 0.08973103016614914, 0.0901142805814743, 0.09040862321853638, 0.0974477082490921, 0.09046106040477753, 0.09007991850376129], [0.0898410752415657, 0.08928454667329788, 0.08855818957090378, 0.09060604870319366, 0.09061307460069656, 0.08857878297567368, 0.08931916207075119, 0.08988984674215317, 0.1040649563074112, 0.08999169617891312, 0.08925266563892365], [0.06356244534254074, 0.058914922177791595, 0.053318385034799576, 0.07050088047981262, 0.07056769728660583, 0.053470127284526825, 0.05919462814927101, 0.06398533284664154, 0.38295042514801025, 0.06487684696912766, 0.058658380061388016], [0.08974024653434753, 0.0891362726688385, 0.08834848552942276, 0.09057096391916275, 0.090578593313694, 0.08837081491947174, 0.0891738310456276, 0.08979319036006927, 0.10528215765953064, 0.08990376442670822, 0.08910168707370758], [0.09044425934553146, 0.09018892049789429, 0.08985436707735062, 0.09079382568597794, 0.09079702198505402, 0.08986387401819229, 0.09020482748746872, 0.09046658873558044, 0.0966988131403923, 0.090513214468956, 0.09017427265644073]], [[0.0910678282380104, 0.09176407009363174, 0.09028168767690659, 0.09028670936822891, 0.09177937358617783, 0.091243214905262, 0.09083744883537292, 0.09030679613351822, 0.09125843644142151, 0.09031683951616287, 0.09085765480995178], [0.09124425798654556, 0.09273955971002579, 0.08957140147686005, 0.08958202600479126, 0.09277258068323135, 0.09161971509456635, 0.09075232595205307, 0.0896245613694191, 0.09165234118700027, 0.08964584022760391, 0.09079542011022568], [0.09086231887340546, 0.09066101908683777, 0.09109200537204742, 0.09109053015708923, 0.09065661579370499, 0.09081141650676727, 0.09092935919761658, 0.09108462929725647, 0.09080701321363449, 0.09108167886734009, 0.09092346578836441], [0.09086363762617111, 0.09066805988550186, 0.09108679741621017, 0.09108536690473557, 0.09066378325223923, 0.09081419557332993, 0.09092877805233002, 0.09107962995767593, 0.0908099114894867, 0.09107676893472672, 0.09092305600643158], [0.09124807268381119, 0.09276098757982254, 0.08955585211515427, 0.08956661075353622, 0.09279440343379974, 0.09162792563438416, 0.09075041115283966, 0.08960963040590286, 0.09166093170642853, 0.08963114768266678, 0.09079400449991226], [0.09111275523900986, 0.09200992435216904, 0.09010211378335953, 0.09010855853557587, 0.09202966839075089, 0.09133857488632202, 0.09081632643938065, 0.09013434499502182, 0.09135817736387253, 0.0901472419500351, 0.09084232151508331], [0.09100829064846039, 0.09144099056720734, 0.09051822870969772, 0.09052135795354843, 0.09145049005746841, 0.09111741185188293, 0.09086484462022781, 0.09053390473127365, 0.09112687408924103, 0.09054017066955566, 0.09087743610143661], [0.0908689796924591, 0.09069626033306122, 0.09106598794460297, 0.09106472134590149, 0.09069248288869858, 0.09082531929016113, 0.09092649072408676, 0.09105966240167618, 0.0908215269446373, 0.09105713665485382, 0.09092143923044205], [0.09111664444208145, 0.09203125536441803, 0.09008654952049255, 0.09009312093257904, 0.09205139428377151, 0.09134683758020401, 0.0908144935965538, 0.09011939913034439, 0.09136682003736496, 0.09013254195451736, 0.09084098041057587], [0.09087163954973221, 0.0907103642821312, 0.09105557948350906, 0.09105439484119415, 0.09070683270692825, 0.09083086997270584, 0.09092534333467484, 0.0910496711730957, 0.0908273383975029, 0.09104731678962708, 0.09092061966657639], [0.09101352840662003, 0.09146931767463684, 0.0904974415898323, 0.09050074219703674, 0.0914793312549591, 0.09112846106290817, 0.0908624529838562, 0.09051394462585449, 0.09113842993974686, 0.09052054584026337, 0.09087570756673813]], [[0.09075479209423065, 0.08869172632694244, 0.08754708617925644, 0.08960561454296112, 0.08961665630340576, 0.08757948130369186, 0.0875902771949768, 0.08964981138706207, 0.11168181896209717, 0.08864137530326843, 0.08864137530326843], [0.09090849757194519, 0.09027665853500366, 0.08992167562246323, 0.09055779874324799, 0.09056118130683899, 0.08993176370859146, 0.08993512392044067, 0.0905713364481926, 0.0968136414885521, 0.09026110917329788, 0.09026110917329788], [0.09090197831392288, 0.09109083563089371, 0.09119769930839539, 0.09100659191608429, 0.09100557863712311, 0.09119465202093124, 0.09119363874197006, 0.09100254625082016, 0.08921542763710022, 0.09109550714492798, 0.09109550714492798], [0.09086713194847107, 0.08959342539310455, 0.08888179808855057, 0.09015902876853943, 0.09016585350036621, 0.08890197426080704, 0.08890870958566666, 0.09018633514642715, 0.10321133583784103, 0.08956218510866165, 0.08956218510866165], [0.09086637198925018, 0.08958497643470764, 0.088869109749794, 0.09015399217605591, 0.09016085416078568, 0.08888941258192062, 0.08889617770910263, 0.09018145501613617, 0.10329049825668335, 0.08955355733633041, 0.08955355733633041], [0.09090304374694824, 0.09106843173503876, 0.09116199612617493, 0.09099466353654861, 0.09099377691745758, 0.09115932881832123, 0.0911584421992302, 0.09099110960960388, 0.08942414075136185, 0.09107252210378647, 0.09107252210378647], [0.0909033790230751, 0.09106095135211945, 0.09115008264780045, 0.09099067002534866, 0.09098982065916061, 0.0911475419998169, 0.09114670008420944, 0.09098728746175766, 0.08949381113052368, 0.09106484800577164, 0.09106484800577164], [0.09086406230926514, 0.08955962210893631, 0.08883102238178253, 0.09013882279396057, 0.09014581888914108, 0.0888516902923584, 0.08885857462882996, 0.09016678482294083, 0.10352830588817596, 0.08952764421701431, 0.08952764421701431], [0.07623911648988724, 0.06447786837816238, 0.058654822409152985, 0.06947862356901169, 0.0695410668849945, 0.05881310626864433, 0.05886596068739891, 0.06972872465848923, 0.34577757120132446, 0.06421157717704773, 0.06421157717704773], [0.09090957045555115, 0.09031345695257187, 0.08997843414545059, 0.09057872742414474, 0.09058191627264023, 0.08998795598745346, 0.08999112993478775, 0.09059150516986847, 0.09646972268819809, 0.09029877930879593, 0.09029877930879593], [0.09090957045555115, 0.09031345695257187, 0.08997843414545059, 0.09057872742414474, 0.09058191627264023, 0.08998795598745346, 0.08999112993478775, 0.09059150516986847, 0.09646972268819809, 0.09029877930879593, 0.09029877930879593]], [[0.0908726155757904, 0.09156735986471176, 0.09062258154153824, 0.09062761813402176, 0.09158263355493546, 0.09158772975206375, 0.09064273536205292, 0.09064777940511703, 0.09106281399726868, 0.0901232436299324, 0.09066290408372879], [0.09082841873168945, 0.09231690317392349, 0.09029585123062134, 0.09030657261610031, 0.09234977513551712, 0.0923607349395752, 0.09033872932195663, 0.09034945070743561, 0.09123463928699493, 0.0892372876405716, 0.09038162231445312], [0.09088786691427231, 0.0912969559431076, 0.09074032306671143, 0.0907433032989502, 0.0913059338927269, 0.09130892902612686, 0.09075222909450531, 0.09075520187616348, 0.09099999070167542, 0.09044516831636429, 0.0907641276717186], [0.09088756144046783, 0.09130240231752396, 0.09073794633150101, 0.09074096381664276, 0.0913115069270134, 0.09131454676389694, 0.09075001627206802, 0.09075303375720978, 0.09100125730037689, 0.09043866395950317, 0.09076208621263504], [0.09082741290330887, 0.0923333540558815, 0.0902886837720871, 0.09029952436685562, 0.09236662089824677, 0.09237770736217499, 0.09033205360174179, 0.09034289419651031, 0.09123837947845459, 0.08921795338392258, 0.09037544578313828], [0.090827077627182, 0.09233883768320084, 0.09028628468513489, 0.090297169983387, 0.09237223118543625, 0.09238336235284805, 0.09032982587814331, 0.09034071117639542, 0.09123961627483368, 0.08921150118112564, 0.09037338197231293], [0.09088664501905441, 0.0913187637925148, 0.09073082357645035, 0.09073396772146225, 0.09132824838161469, 0.09133141487836838, 0.09074339270591736, 0.09074653685092926, 0.09100507199764252, 0.09041915088891983, 0.09075596183538437], [0.09088634699583054, 0.09132421761751175, 0.09072845429182053, 0.09073163568973541, 0.09133383631706238, 0.09133704006671906, 0.09074118733406067, 0.09074436873197556, 0.09100634604692459, 0.09041265398263931, 0.09075392782688141], [0.09086078405380249, 0.09177283197641373, 0.0905330702662468, 0.09053967148065567, 0.09179291129112244, 0.09179960191249847, 0.0905594751238823, 0.09056608378887177, 0.09111025929450989, 0.08987944573163986, 0.09058589488267899], [0.09091726690530777, 0.09075590968132019, 0.09097570925951004, 0.09097453206777573, 0.09075237810611725, 0.09075119346380234, 0.09097099304199219, 0.09096981585025787, 0.09087293595075607, 0.0910930261015892, 0.09096626937389374], [0.09088542312383652, 0.0913405790925026, 0.09072131663560867, 0.0907246321439743, 0.09135057032108307, 0.0913539007306099, 0.0907345563173294, 0.09073786437511444, 0.09101015329360962, 0.09039313346147537, 0.09074779599905014]], [[0.09015399217605591, 0.08891318738460541, 0.08891979604959488, 0.09017408639192581, 0.09089633822441101, 0.0889396145939827, 0.08965197205543518, 0.09020089358091354, 0.10297410935163498, 0.08958800137042999, 0.08958800137042999], [0.09101372212171555, 0.09121064841747284, 0.09120959043502808, 0.09101056307554245, 0.09089740365743637, 0.09120641648769379, 0.0910930186510086, 0.091006338596344, 0.0891459584236145, 0.09110315889120102, 0.09110315889120102], [0.09100963175296783, 0.09119871258735657, 0.09119769930839539, 0.09100659191608429, 0.09089793264865875, 0.09119465202093124, 0.0910857692360878, 0.09100254625082016, 0.08921543508768082, 0.09109550714492798, 0.09109550714492798], [0.09013853222131729, 0.08887504041194916, 0.08888176828622818, 0.09015899896621704, 0.09089460223913193, 0.08890195190906525, 0.08962728828191757, 0.09018629789352417, 0.10321127623319626, 0.08956215530633926, 0.08956215530633926], [0.08954913914203644, 0.08748343586921692, 0.0874943807721138, 0.08958275616168976, 0.09079435467720032, 0.08752723038196564, 0.08871101588010788, 0.08962760865688324, 0.1120212972164154, 0.08860445022583008, 0.08860445022583008], [0.09099732339382172, 0.09116288274526596, 0.09116198867559433, 0.09099466353654861, 0.0908994972705841, 0.09115932881832123, 0.09106399118900299, 0.09099110960960388, 0.08942415565252304, 0.09107252210378647, 0.09107252210378647], [0.09052417427301407, 0.08985640853643417, 0.0898599773645401, 0.09053494781255722, 0.09092162549495697, 0.08987067639827728, 0.0902545228600502, 0.09054932743310928, 0.09718814492225647, 0.09022010117769241, 0.09022010117769241], [0.09011782705783844, 0.08882410079240799, 0.08883099257946014, 0.09013879299163818, 0.09089220315217972, 0.08885165303945541, 0.08959431201219559, 0.09016674757003784, 0.10352823883295059, 0.08952759951353073, 0.08952759951353073], [0.06928814202547073, 0.05859922617673874, 0.0586518868803978, 0.06947511434555054, 0.07650968432426453, 0.05881015956401825, 0.06476487219333649, 0.06972520798444748, 0.34575897455215454, 0.06420834362506866, 0.06420834362506866], [0.0905691385269165, 0.0899752601981163, 0.08997843414545059, 0.09057871997356415, 0.09092239290475845, 0.08998795598745346, 0.0903293788433075, 0.09059150516986847, 0.09646971523761749, 0.09029877930879593, 0.09029877930879593], [0.0905691385269165, 0.0899752601981163, 0.08997843414545059, 0.09057871997356415, 0.09092239290475845, 0.08998795598745346, 0.0903293788433075, 0.09059150516986847, 0.09646971523761749, 0.09029877930879593, 0.09029877930879593]]]}, "num_training_step_calls_per_iteration": 1, "evaluation": {"env_runners": {"module_to_env_connector": {"timers": {"connectors": {"tensor_to_numpy": 1.7999723427267592e-05, "un_batch_to_individual_items": 7.861517602972442e-06, "get_actions": 4.895468281234431e-05, "listify_data_for_vector_env": 1.4437088547559529e-05, "normalize_and_clip_actions": 1.1071474997545963e-05, "remove_single_ts_time_rank_from_batch": 1.6031710230326542e-05}}, "connector_pipeline_timer": 0.0001490398912221104}, "episode_len_min": 20, "num_env_steps_sampled": 400, "weights_seq_no": 17.0, "episode_len_mean": 20.0, "env_to_module_sum_episodes_length_out": 10.368238394574323, "episode_len_max": 20, "env_to_module_connector": {"timers": {"connectors": {"batch_individual_items": 1.5183796785324765e-05, "add_observations_from_episodes_to_batch": 3.8596802227499775e-06, "add_states_from_episodes_to_batch": 3.358480582887941e-06, "add_time_dim_to_batch_and_zero_pad": 1.0224978792430674e-05, "numpy_to_tensor": 1.5424817461800325e-05}}, "connector_pipeline_timer": 7.527010942560103e-05}, "env_to_module_sum_episodes_length_in": 10.368238394574323, "num_episodes_lifetime": 340, "episode_duration_sec_mean": 0.005519818777684122, "episode_return_max": 12.5, "rlmodule_inference_timer": 4.1306360916394035e-05, "num_agent_steps_sampled": {"default_agent": 400}, "num_module_steps_sampled_lifetime": {"default_policy": 6800}, "num_agent_steps_sampled_lifetime": {"default_agent": 6800}, "num_module_steps_sampled": {"default_policy": 400}, "sample": 0.13123229689625573, "episode_return_mean": 0.2, "env_step_timer": 2.1864684682735207e-05, "agent_episode_returns_mean": {"default_agent": 0.2}, "num_episodes": 20, "module_episode_returns_mean": {"default_policy": 0.2}, "episode_return_min": -12.5, "num_env_steps_sampled_lifetime": 85400, "env_reset_timer": 0.0005464954933433709, "time_between_sampling": 12.239155189491097}, "num_healthy_workers": 1, "actor_manager_num_outstanding_async_reqs": 0, "num_remote_worker_restarts": 0}, "num_env_steps_sampled_lifetime": -9252500.0, "fault_tolerance": {"num_healthy_workers": 0, "num_remote_worker_restarts": 0}, "env_runner_group": {"actor_manager_num_outstanding_async_reqs": 0}, "done": false, "training_iteration": 17, "trial_id": "ae8a2_00000", "date": "2025-08-11_18-25-30", "timestamp": 1754929530, "time_this_iter_s": 10.008352994918823, "time_total_s": 183.44204258918762, "pid": 10870, "hostname": "Mac", "node_ip": "127.0.0.1", "config": {"exploration_config": {}, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 2, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "env": "Umbrella", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": false, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 0, "create_local_env_runner": true, "num_envs_per_env_runner": 1, "gym_env_vectorize_mode": "SYNC", "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "episodes_to_numpy": true, "max_requests_in_flight_per_env_runner": 1, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "merge_env_runner_states": "training_only", "broadcast_env_runner_states": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "complete_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "sampler_perf_stats_ema_coef": null, "_is_online": true, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": "auto", "num_aggregator_actors_per_learner": 0, "max_requests_in_flight_per_aggregator_actor": 3, "local_gpu_idx": 0, "max_requests_in_flight_per_learner": 3, "gamma": 1, "lr": 0.0002715581955, "grad_clip": 0.5, "grad_clip_by": "global_norm", "_train_batch_size_per_learner": 5000, "train_batch_size": 4000, "num_epochs": 1, "minibatch_size": 1000, "shuffle_batch_per_epoch": true, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "log_std_clip_param": 20.0, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "_disable_preprocessor_api": false, "_disable_action_flattening": false}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {"intrinsic_reward_coeff": 0.2795015916508}, "optimizer": {}, "_learner_class": "<class 'source.intrinsic_attention_ppo.learners.IntrinsicAttentionMetaLearner.IntrinsicAttentionMetaLearner'>", "callbacks_on_algorithm_init": null, "callbacks_on_env_runners_recreated": null, "callbacks_on_offline_eval_runners_recreated": null, "callbacks_on_checkpoint_loaded": null, "callbacks_on_environment_created": null, "callbacks_on_episode_created": null, "callbacks_on_episode_start": null, "callbacks_on_episode_step": null, "callbacks_on_episode_end": null, "callbacks_on_evaluate_start": null, "callbacks_on_evaluate_end": null, "callbacks_on_evaluate_offline_start": null, "callbacks_on_evaluate_offline_end": null, "callbacks_on_sample_end": null, "callbacks_on_train_result": null, "explore": true, "enable_rl_module_and_learner": true, "enable_env_runner_and_connector_v2": true, "_prior_exploration_config": {"type": "StochasticSampling"}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x38844d8a0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "offline_data_class": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_read_batch_size": null, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "materialize_data": false, "materialize_mapped_data": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "ignore_final_observation": false, "prelearner_class": null, "prelearner_buffer_class": null, "prelearner_buffer_kwargs": {}, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_remaining_data": false, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": 1, "evaluation_duration": 20, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_auto_duration_min_env_steps_per_sample": 100, "evaluation_auto_duration_max_env_steps_per_sample": 2000, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 1, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "offline_evaluation_interval": null, "num_offline_eval_runners": 0, "offline_loss_for_module_fn": null, "offline_evaluation_duration": 1, "offline_evaluation_parallel_to_training": false, "offline_evaluation_timeout_s": 120.0, "num_cpus_per_offline_eval_runner": 1, "num_gpus_per_offline_eval_runner": 0, "custom_resources_per_offline_eval_runner": {}, "restart_failed_offline_eval_runners": true, "ignore_offline_eval_runner_failures": false, "max_num_offline_eval_runner_restarts": 1000, "offline_eval_runner_restore_timeout_s": 1800.0, "max_requests_in_flight_per_offline_eval_runner": 1, "validate_offline_eval_runners_after_construction": true, "offline_eval_runner_health_probe_timeout_s": 30.0, "offline_eval_rl_module_inference_only": false, "broadcast_offline_eval_runner_states": false, "offline_eval_batch_size_per_runner": 256, "dataset_num_iters_per_eval_runner": 1, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "log_gradients": false, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 1, "restart_failed_env_runners": true, "ignore_env_runner_failures": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30.0, "env_runner_restore_timeout_s": 1800.0, "_model_config": {}, "_rl_module_spec": "MultiRLModuleSpec(multi_rl_module_class=<class 'ray.rllib.core.rl_module.multi_rl_module.MultiRLModule'>, observation_space=None, action_space=None, inference_only=False, model_config=None, rl_module_specs={'default_policy': RLModuleSpec(module_class=<class 'source.intrinsic_attention_ppo.rl_modules.DifferentiablePPOModule.DifferentiablePPOModule'>, observation_space=None, action_space=None, inference_only=False, learner_only=False, model_config={'vf_share_layers': True, 'embedding_dim': 62, 'max_seq_len': 11, 'policy_head_hidden_sizes': [32], 'value_head_hidden_sizes': [101], 'embedding_hidden_sizes': [121]}, catalog_class=None, load_state_path=None, model_config_dict=None), 'intrinsic_reward_module': RLModuleSpec(module_class=<class 'source.intrinsic_attention_ppo.rl_modules.IntrinsicAttentionModule.IntrinsicAttentionModule'>, observation_space=None, action_space=None, inference_only=False, learner_only=True, model_config={'intrinsic_reward_network': {'encoder_hidden_sizes': [], 'encoding_dim': 1, 'num_heads': 1, 'head_hidden_sizes': None, 'layers': [{'type': 'attention'}]}, 'extrinsic_value_hidden_layers': [127, 60], 'vf_share_layers': True, 'max_seq_len': 11}, catalog_class=None, load_state_path=None, model_config_dict=None)}, load_state_path=None, modules_to_load=None, module_specs={'default_policy': RLModuleSpec(module_class=<class 'source.intrinsic_attention_ppo.rl_modules.DifferentiablePPOModule.DifferentiablePPOModule'>, observation_space=None, action_space=None, inference_only=False, learner_only=False, model_config={'vf_share_layers': True, 'embedding_dim': 62, 'max_seq_len': 11, 'policy_head_hidden_sizes': [32], 'value_head_hidden_sizes': [101], 'embedding_hidden_sizes': [121]}, catalog_class=None, load_state_path=None, model_config_dict=None), 'intrinsic_reward_module': RLModuleSpec(module_class=<class 'source.intrinsic_attention_ppo.rl_modules.IntrinsicAttentionModule.IntrinsicAttentionModule'>, observation_space=None, action_space=None, inference_only=False, learner_only=True, model_config={'intrinsic_reward_network': {'encoder_hidden_sizes': [], 'encoding_dim': 1, 'num_heads': 1, 'head_hidden_sizes': None, 'layers': [{'type': 'attention'}]}, 'extrinsic_value_hidden_layers': [127, 60], 'vf_share_layers': True, 'max_seq_len': 11}, catalog_class=None, load_state_path=None, model_config_dict=None)})", "algorithm_config_overrides_per_module": {"intrinsic_reward_module": {"lr": 0.0002715581955}}, "_per_module_overrides": {}, "_validate_config": true, "_use_msgpack_checkpoints": false, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "env_task_fn": -1, "enable_connectors": -1, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.161583927863, "kl_target": 0.0201019014258, "vf_loss_coeff": 0.7790510010087, "entropy_coeff": 0.0015431216992, "clip_param": 0.2459212356676, "vf_clip_param": 0.3769744131561, "entropy_coeff_schedule": null, "lr_schedule": null, "sgd_minibatch_size": -1, "vf_share_layers": -1, "differentiable_learner_configs": ["DifferentiableLearnerConfig(learner_class=<class 'source.intrinsic_attention_ppo.learners.IntrinsicAttentionPPOLearner.IntrinsicAttentionPPOLearner'>, learner_connector=None, add_default_connectors_to_learner_pipeline=True, is_multi_agent=False, policies_to_update=['default_policy'], lr=0.0060984166342, num_total_minibatches=0, num_epochs=1, minibatch_size=1000, shuffle_batch_per_epoch=True)"], "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9485408017724, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.callbacks.callbacks.RLlibCallback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 183.44204258918762, "iterations_since_restore": 17, "perf": {"cpu_util_percent": 46.15, "ram_util_percent": 78.6}}
{"timers": {"training_iteration": 12.293648395707574, "restore_env_runners": 1.1840320613822173e-05, "training_step": 12.293446710542984, "env_runner_sampling_timer": 2.75414228203865, "learner_update_timer": 9.323468345764747, "synch_weights": 0.0016156975836302263, "restore_eval_env_runners": 5.0912146373813105e-05, "evaluation_iteration": 0.14285340130553414, "synch_eval_env_connectors": 0.00022135771337470885, "synch_env_connectors": 5.9481838433245805e-06}, "env_runners": {"module_to_env_connector": {"connector_pipeline_timer": 0.00012029937727927807, "timers": {"connectors": {"remove_single_ts_time_rank_from_batch": 1.2073623948313876e-05, "un_batch_to_individual_items": 6.651699701208207e-06, "get_actions": 4.036409393050659e-05, "tensor_to_numpy": 1.537343622163057e-05, "listify_data_for_vector_env": 1.06689507095586e-05, "normalize_and_clip_actions": 8.062579050146824e-06}}}, "rlmodule_inference_timer": 3.2260220250917655e-05, "sample": 0.00577224427345334, "weights_seq_no": 17.0, "num_agent_steps_sampled": {"default_agent": 5000.0}, "episode_len_mean": 20.0, "episode_len_max": 20, "env_to_module_connector": {"timers": {"connectors": {"batch_individual_items": 1.2754700697621241e-05, "add_states_from_episodes_to_batch": 2.790546182395419e-06, "numpy_to_tensor": 1.2945191367233192e-05, "add_observations_from_episodes_to_batch": 2.841452624828204e-06, "add_time_dim_to_batch_and_zero_pad": 7.065604292634342e-06}}, "connector_pipeline_timer": 6.105635949014771e-05}, "env_to_module_sum_episodes_length_out": 10.36823839457432, "num_agent_steps_sampled_lifetime": {"default_agent": -9870000.0}, "episode_return_mean": 2.379999999999999, "num_module_steps_sampled_lifetime": {"default_policy": -9870000.0}, "num_episodes": 250.0, "time_between_sampling": 0.03423796728602603, "num_env_steps_sampled_lifetime": -9870000.0, "episode_return_min": -10.5, "env_reset_timer": 4.657694445537106e-05, "env_to_module_sum_episodes_length_in": 10.36823839457432, "num_episodes_lifetime": -493500.0, "agent_episode_returns_mean": {"default_agent": 2.379999999999999}, "episode_len_min": 20, "episode_duration_sec_mean": 0.005384730468504132, "env_step_timer": 1.4347629480808726e-05, "episode_return_max": 9.5, "num_module_steps_sampled": {"default_policy": 5000.0}, "module_episode_returns_mean": {"default_policy": 2.379999999999999}, "num_env_steps_sampled": 5000.0, "num_env_steps_sampled_lifetime_throughput": 3162.190102844062}, "__all_modules__": {"learner_connector_sum_episodes_length_in": 5000.0, "learner_connector": {"connector_pipeline_timer": 0.15914040842671054, "timers": {"connectors": {"add_one_ts_to_episodes_and_truncate": 0.009316947317358912, "add_observations_from_episodes_to_batch": 0.0015641377960882137, "add_columns_from_episodes_to_train_batch": 0.04893076153760627, "add_time_dim_to_batch_and_zero_pad": 0.08436786134047833, "add_states_from_episodes_to_batch": 0.008420992253801995, "batch_individual_items": 0.00620877697849327, "numpy_to_tensor": 9.380421717752359e-05}}}, "learner_connector_sum_episodes_length_out": 5250.0}, "learners": {"default_policy": {"curr_entropy_coeff": 0.0015431216992, "curr_kl_coeff": 6.163937769088079e-07, "num_module_steps_trained_lifetime": 107730, "entropy": 0.67713862657547, "num_module_steps_trained": 5985, "diff_num_grad_updates_vs_sampler_policy": 1.0, "vf_loss": 0.35831308364868164, "vf_loss_unclipped": 43.079383850097656, "policy_loss": -0.0003077220171689987, "use_intrinsic_rewards": 0.0, "total_loss": 0.2777915596961975, "vf_explained_var": -0.0009944438934326172, "mean_kl_loss": 1.9213841369492002e-05, "weights_seq_no": 18.0, "num_trainable_parameters": 16595, "module_train_batch_size_mean": 997.6672132667843, "num_module_steps_trained_lifetime_throughput": 723.5798402821118}, "intrinsic_reward_module": {"num_module_steps_trained_lifetime": 107730, "num_module_steps_trained": 5985, "diff_num_grad_updates_vs_sampler_policy": 1.0, "total_loss": 0.0, "gradients_default_optimizer_global_norm": 0.0, "module_train_batch_size_mean": 997.6672132667843, "default_optimizer_learning_rate": 0.0002715581955, "weights_seq_no": 18.0, "num_trainable_parameters": 8266, "curr_entropy_coeff": 0.0015431216992, "num_module_steps_trained_lifetime_throughput": 723.5855511299914}, "differentiable_learners": {"intrinsic_attention_ppo_learner": {"default_policy": {"weights_seq_no": 108.0, "num_module_steps_trained": 35910, "num_module_steps_trained_lifetime": 646380, "entropy": 0.6771816611289978, "diff_num_grad_updates_vs_sampler_policy": 91.0, "vf_loss": 0.35841935873031616, "vf_loss_unclipped": 43.236087799072266, "total_loss": 0.2778875231742859, "mean_kl_loss": 1.771917231963016e-05, "policy_loss": -0.00029734038980677724, "use_intrinsic_rewards": 1.0, "module_train_batch_size_mean": 997.4982334615715, "vf_explained_var": -0.001538395881652832}, "__all_modules__": {"num_env_steps_trained": 198000, "num_module_steps_trained": 71820, "num_module_steps_trained_lifetime": 1292760, "num_env_steps_trained_lifetime": 3564000, "num_env_steps_trained_lifetime_throughput": 34597.7533882}, "intrinsic_reward_module": {"weights_seq_no": 108.0, "num_module_steps_trained_lifetime": 646380, "num_module_steps_trained": 35910, "diff_num_grad_updates_vs_sampler_policy": 91.0, "total_loss": 0.0, "module_train_batch_size_mean": 997.4982334615715}}}, "__all_modules__": {"num_env_steps_trained_lifetime": 594000, "num_non_trainable_parameters": 0, "num_trainable_parameters": 24861, "num_env_steps_trained": 33000, "num_module_steps_trained": 11970, "num_module_steps_trained_lifetime": 215460, "num_env_steps_trained_lifetime_throughput": 3990.732883608631, "num_module_steps_trained_throughput": 19499185.57206967, "num_module_steps_trained_lifetime_throughput": 12518085.76321902}, "IntrinsicAttentionMask": [[[0.09097086638212204, 0.09112578630447388, 0.09072055667638779, 0.0907256007194519, 0.0911409929394722, 0.0911460593342781, 0.09074073284864426, 0.09074577689170837, 0.09170204401016235, 0.0907558724284172, 0.0902256891131401], [0.09098630398511887, 0.09118057042360306, 0.09067261964082718, 0.09067893773317337, 0.09119963645935059, 0.09120599180459976, 0.09069789946079254, 0.09070422500371933, 0.09190387278795242, 0.09071686863899231, 0.09005310386419296], [0.09094567596912384, 0.09103697538375854, 0.0907980352640152, 0.09080101549625397, 0.09104592353105545, 0.09104891121387482, 0.09080994874238968, 0.09081292152404785, 0.09137599170207977, 0.09081888198852539, 0.09050565958023071], [0.09094618260860443, 0.0910387635231018, 0.09079647064208984, 0.0907994955778122, 0.09104785323143005, 0.09105087071657181, 0.09080855548381805, 0.09081157296895981, 0.09138256311416626, 0.09081761538982391, 0.09050001204013824], [0.09098780155181885, 0.09118593484163284, 0.09066791087388992, 0.09067435562610626, 0.09120538085699081, 0.09121186286211014, 0.09069368988275528, 0.09070013463497162, 0.09192366898059845, 0.0907130315899849, 0.09003619104623795], [0.09098830819129944, 0.0911877229809761, 0.09066633880138397, 0.09067282825708389, 0.09120729565620422, 0.09121381491422653, 0.09069228917360306, 0.09069877862930298, 0.09193027019500732, 0.09071175754070282, 0.09003055095672607], [0.0909477174282074, 0.09104415029287338, 0.09079179167747498, 0.09079493582248688, 0.09105360507965088, 0.09105675667524338, 0.09080436825752258, 0.09080750495195389, 0.09140227735042572, 0.09081380069255829, 0.09048303961753845], [0.09094823151826859, 0.09104595333337784, 0.09079023450613022, 0.0907934159040451, 0.09105553478002548, 0.09105872362852097, 0.09080297499895096, 0.09080616384744644, 0.0914088562130928, 0.09081253409385681, 0.09047738462686539], [0.09104272723197937, 0.09138298034667969, 0.09049446135759354, 0.09050548821687698, 0.09141641110181808, 0.09142754971981049, 0.09053859114646912, 0.09054963290691376, 0.09265461564064026, 0.09057170897722244, 0.08941581845283508], [0.09094925969839096, 0.09104953706264496, 0.09078711271286011, 0.09079038351774216, 0.0910593718290329, 0.09106265753507614, 0.09080018848180771, 0.09080345928668976, 0.09142200648784637, 0.09081000089645386, 0.09046608209609985], [0.09089501202106476, 0.09086022526025772, 0.09095136821269989, 0.09095022827386856, 0.09085681289434433, 0.090855672955513, 0.09094681590795517, 0.09094567596912384, 0.09073147177696228, 0.09094339609146118, 0.09106334298849106]], [[0.08982482552528381, 0.08858855813741684, 0.08929809927940369, 0.09055773168802261, 0.09056446701288223, 0.08931800723075867, 0.08862147480249405, 0.0905846506357193, 0.1034121885895729, 0.08996915072202682, 0.08926090598106384], [0.09106459468603134, 0.09126162528991699, 0.09114815294742584, 0.09094925969839096, 0.0909482091665268, 0.09114498645067215, 0.09125633537769318, 0.0909450426697731, 0.08908592909574509, 0.09104179590940475, 0.0911540761590004], [0.09037590026855469, 0.08974006026983261, 0.09010552614927292, 0.09075082093477249, 0.09075425565242767, 0.0901157557964325, 0.0897570475935936, 0.09076456725597382, 0.09709984809160233, 0.09044984728097916, 0.09008640050888062], [0.08899983763694763, 0.0869542732834816, 0.08812595903873444, 0.0902215763926506, 0.09023281931877136, 0.08815892040729523, 0.08700849115848541, 0.09026657789945602, 0.1127273216843605, 0.08923989534378052, 0.08806437999010086], [0.0889919325709343, 0.08693908900022507, 0.0881149172782898, 0.09021811187267303, 0.09022940695285797, 0.08814800530672073, 0.0869934931397438, 0.09026327729225159, 0.11281576007604599, 0.08923286199569702, 0.08805312216281891], [0.09035570174455643, 0.08969688415527344, 0.0900755301117897, 0.090744249522686, 0.09074781090021133, 0.09008613973855972, 0.08971448987722397, 0.09075848758220673, 0.09733272343873978, 0.09043233841657639, 0.09005571901798248], [0.09103398025035858, 0.09119177609682083, 0.09110090881586075, 0.09094158560037613, 0.09094073623418808, 0.0910983756184578, 0.09118754416704178, 0.09093820303678513, 0.08944554626941681, 0.09101571887731552, 0.09110565483570099], [0.08896822482347488, 0.08689352869987488, 0.08808180689811707, 0.09020770341157913, 0.09021911025047302, 0.08811523765325546, 0.08694850653409958, 0.09025336056947708, 0.11308146268129349, 0.08921174705028534, 0.08801935613155365], [0.06313443183898926, 0.05290926620364189, 0.058573704212903976, 0.07002612203359604, 0.07009248435497284, 0.05874039977788925, 0.05316046252846718, 0.07029195874929428, 0.3803676962852478, 0.06443998962640762, 0.05826340988278389], [0.08966776728630066, 0.08826969563961029, 0.08907178789377213, 0.09049781411886215, 0.0905054360628128, 0.08909430354833603, 0.08830688893795013, 0.09052831679582596, 0.10519707202911377, 0.0898311510682106, 0.0890297219157219], [0.09041351079940796, 0.08982065320014954, 0.09016145020723343, 0.09076295793056488, 0.09076615422964096, 0.0901709794998169, 0.0898364931344986, 0.0907757580280304, 0.09666591882705688, 0.0904824361205101, 0.0901436135172844]], [[0.09111713618040085, 0.09181375056505203, 0.0903305783867836, 0.09033560752868652, 0.0912875384092331, 0.0912926197052002, 0.09088664501905441, 0.09035570174455643, 0.09130784869194031, 0.09090180695056915, 0.090370774269104], [0.09135057032108307, 0.09284761548042297, 0.08967577666044235, 0.08968642354011536, 0.09171558171510696, 0.09172646701335907, 0.0908580794930458, 0.08972900360822678, 0.09175913035869598, 0.09089042991399765, 0.08976095169782639], [0.09084811061620712, 0.09064684808254242, 0.0910777673125267, 0.09107629209756851, 0.09079869836568832, 0.09079723060131073, 0.09091514348983765, 0.09107039868831635, 0.09079281985759735, 0.09091073274612427, 0.09106597304344177], [0.0908498540520668, 0.09065429866313934, 0.09107296913862228, 0.09107153862714767, 0.09080183506011963, 0.09080041199922562, 0.09091497957706451, 0.09106580168008804, 0.09079612791538239, 0.09091068804264069, 0.09106151014566422], [0.0911746472120285, 0.09206661581993103, 0.09016979485750198, 0.09017620235681534, 0.09139266610145569, 0.0913991630077362, 0.09087993204593658, 0.09020184725522995, 0.09141865372657776, 0.09089931845664978, 0.09022108465433121], [0.09117636829614639, 0.09207415580749512, 0.09016501903533936, 0.09017147123813629, 0.091395802795887, 0.09140234440565109, 0.09087973833084106, 0.09019728004932404, 0.09142196178436279, 0.09089924395084381, 0.09021663665771484], [0.09103891253471375, 0.09147175401449203, 0.09054867923259735, 0.09055181592702866, 0.09114491194486618, 0.09114806354045868, 0.09089542180299759, 0.09056436270475388, 0.09115753322839737, 0.09090486168861389, 0.09057377278804779], [0.09085679799318314, 0.09068410843610764, 0.09105377644300461, 0.09105250984430313, 0.09081440418958664, 0.09081313759088516, 0.0909142941236496, 0.09104745090007782, 0.09080935269594193, 0.09091050922870636, 0.09104365855455399], [0.09118147939443588, 0.09209674596786499, 0.09015065431594849, 0.09015723317861557, 0.09140516817569733, 0.09141183644533157, 0.09087911248207092, 0.09018353372812271, 0.09143184125423431, 0.09089899808168411, 0.09020327031612396], [0.09104406088590622, 0.09149423986673355, 0.09053429961204529, 0.09053756296634674, 0.0911542996764183, 0.09115757793188095, 0.09089484065771103, 0.09055060148239136, 0.09116742759943008, 0.09090466052293777, 0.09056038409471512], [0.09086200594902039, 0.090706467628479, 0.09103938937187195, 0.09103824943304062, 0.09082382917404175, 0.09082268923521042, 0.0909137949347496, 0.0910336971282959, 0.09081928431987762, 0.09091038256883621, 0.09103027731180191]], [[0.08982573449611664, 0.08929237723350525, 0.08929900825023651, 0.09055864810943604, 0.09056537598371506, 0.0886157900094986, 0.08932554721832275, 0.08987247198820114, 0.10341320931911469, 0.08997006714344025, 0.08926181495189667], [0.09038285166025162, 0.0901123657822609, 0.0901157408952713, 0.0907532274723053, 0.0907566174864769, 0.08976808935403824, 0.09012921154499054, 0.09040650725364685, 0.09702257812023163, 0.09045590460300446, 0.0900968462228775], [0.09037613123655319, 0.09010234475135803, 0.09010575711727142, 0.09075105935335159, 0.09075449407100677, 0.0897538885474205, 0.09011939913034439, 0.0904000848531723, 0.09710010141134262, 0.09045008569955826, 0.09008663147687912], [0.0890023484826088, 0.08811745792627335, 0.08812844008207321, 0.09022411704063416, 0.09023536741733551, 0.08700009435415268, 0.08817239850759506, 0.08908005058765411, 0.11273045837879181, 0.08924240618944168, 0.08806686103343964], [0.08899448066949844, 0.0881064161658287, 0.08811743557453156, 0.09022068232297897, 0.09023197740316391, 0.08698509633541107, 0.08816155046224594, 0.08907245844602585, 0.11281894147396088, 0.08923540264368057, 0.08805564045906067], [0.09104013442993164, 0.09111127257347107, 0.09111038595438004, 0.09094315022230148, 0.09094226360321045, 0.09120221436023712, 0.0911068320274353, 0.0910339206457138, 0.08937354385852814, 0.09102096408605576, 0.09111537039279938], [0.09034920483827591, 0.0900622010231018, 0.09006576985120773, 0.09074229001998901, 0.09074589610099792, 0.0896969735622406, 0.09008007496595383, 0.09037430584430695, 0.09741072356700897, 0.0904267281293869, 0.09004572778940201], [0.08977524936199188, 0.08921913057565689, 0.08922605216503143, 0.09053965657949448, 0.09054667502641678, 0.08851388841867447, 0.08925371617078781, 0.08982398360967636, 0.10398861020803452, 0.08992575854063034, 0.08918727189302444], [0.06320550292730331, 0.05858413875102997, 0.058639660477638245, 0.0701049417257309, 0.07017138600349426, 0.05316993221640587, 0.05886228010058403, 0.0636260136961937, 0.38079455494880676, 0.06451254338026047, 0.058329008519649506], [0.08966894447803497, 0.08906545490026474, 0.08907295763492584, 0.09049899876117706, 0.09050662070512772, 0.08830060809850693, 0.08910298347473145, 0.08972184360027313, 0.105198435485363, 0.08983232825994492, 0.08903089165687561], [0.09041371941566467, 0.09015847742557526, 0.09016165882349014, 0.09076317399740219, 0.09076637029647827, 0.08983354270458221, 0.09017437696456909, 0.09043604880571365, 0.09666614234447479, 0.09048265218734741, 0.0901438295841217]], [[0.09238889068365097, 0.09137636423110962, 0.08961114287376404, 0.09062305837869644, 0.09242754429578781, 0.09243721514940262, 0.08964863419532776, 0.08965801447629929, 0.09246622025966644, 0.08967676758766174, 0.08968614786863327], [0.09170158952474594, 0.09116145223379135, 0.0902131199836731, 0.09075780212879181, 0.09172215312719345, 0.09172729402780533, 0.09023335576057434, 0.09023841470479965, 0.09174272418022156, 0.09024853259325027, 0.09025359153747559], [0.09048830717802048, 0.09077310562133789, 0.09127945452928543, 0.09098763763904572, 0.09047751128673553, 0.09047481417655945, 0.09126856923103333, 0.09126584231853485, 0.09046672284603119, 0.0912604033946991, 0.09125768393278122], [0.09118616580963135, 0.09099788218736649, 0.09066552668809891, 0.09085669368505478, 0.09119332581758499, 0.09119511395692825, 0.09067264199256897, 0.09067441523075104, 0.09120047837495804, 0.09067797660827637, 0.09067975729703903], [0.09241500496864319, 0.09138445556163788, 0.08958829194307327, 0.09061787277460098, 0.09245435148477554, 0.09246419370174408, 0.08962643891572952, 0.08963597565889359, 0.09249372035264969, 0.08965505659580231, 0.08966460078954697], [0.0924215316772461, 0.09138648211956024, 0.08958258479833603, 0.09061657637357712, 0.09246105700731277, 0.09247094392776489, 0.08962089568376541, 0.08963046967983246, 0.09250059723854065, 0.08964963257312775, 0.08965921401977539], [0.09051427245140076, 0.09078153967857361, 0.09125657379627228, 0.0909828245639801, 0.09050414711236954, 0.09050161391496658, 0.0912463590502739, 0.09124381095170975, 0.09049402177333832, 0.09123869985342026, 0.09123615175485611], [0.09052077680826187, 0.09078364819288254, 0.09125085920095444, 0.090981625020504, 0.09051080793142319, 0.09050831943750381, 0.09124081581830978, 0.09123830497264862, 0.0905008465051651, 0.0912332832813263, 0.09123077243566513], [0.092441126704216, 0.09139254689216614, 0.0895654484629631, 0.09061267971992493, 0.09248116612434387, 0.09249118715524673, 0.08960424363613129, 0.08961394429206848, 0.09252122789621353, 0.08963335305452347, 0.08964306116104126], [0.09053375571966171, 0.0907878577709198, 0.09123941510915756, 0.0909792110323906, 0.09052412956953049, 0.09052171558141708, 0.09122970700263977, 0.09122728556394577, 0.09051449596881866, 0.09122242778539658, 0.09121999889612198], [0.09054024517536163, 0.09078995883464813, 0.09123369306325912, 0.09097800403833389, 0.09053078293800354, 0.09052842110395432, 0.09122415632009506, 0.09122176468372345, 0.09052131325006485, 0.09121699631214142, 0.091214619576931]], [[0.08996356278657913, 0.08942937850952148, 0.08943602442741394, 0.08998361974954605, 0.09070433676242828, 0.08945596218109131, 0.08946261554956436, 0.09001036733388901, 0.1027565449476242, 0.08939877152442932, 0.08939877152442932], [0.09045039862394333, 0.09017971158027649, 0.0901830792427063, 0.09046054631471634, 0.09082445502281189, 0.09019319713115692, 0.09019657969474792, 0.09047406911849976, 0.09670967608690262, 0.0901641771197319, 0.0901641771197319], [0.09044452756643295, 0.09017053246498108, 0.09017394483089447, 0.09045479446649551, 0.09082317352294922, 0.09018418937921524, 0.09018759429454803, 0.09046849608421326, 0.0967831164598465, 0.09015480428934097, 0.09015480428934097], [0.08994467556476593, 0.08940070867538452, 0.08940746635198593, 0.0899650976061821, 0.09069912135601044, 0.08942776918411255, 0.08943454176187515, 0.08999233692884445, 0.10298924148082733, 0.08936953544616699, 0.08936953544616699], [0.08923528343439102, 0.08834482729434967, 0.0883558839559555, 0.08926879614591599, 0.0904761329293251, 0.08838905394077301, 0.08840011805295944, 0.08931347727775574, 0.11162859946489334, 0.08829391002655029, 0.08829391002655029], [0.09042691439390182, 0.09014298766851425, 0.09014652669429779, 0.09043755382299423, 0.0908193290233612, 0.09015713632106781, 0.09016067534685135, 0.09045174717903137, 0.0970037654042244, 0.09012669324874878, 0.09012669324874878], [0.09042102098464966, 0.09013379365205765, 0.09013736993074417, 0.09043178707361221, 0.09081802517175674, 0.09014809876680374, 0.09015168249607086, 0.09044615179300308, 0.09707740694284439, 0.09011730551719666, 0.09011730551719666], [0.08991940319538116, 0.08936239778995514, 0.08936931937932968, 0.08994031697511673, 0.09069207310676575, 0.0893901139497757, 0.08939704298973083, 0.08996821194887161, 0.10330022871494293, 0.08933047950267792, 0.08933047950267792], [0.06808643043041229, 0.0633564367890358, 0.06341337412595749, 0.06827016174793243, 0.07518270611763, 0.06358449906110764, 0.06364164501428604, 0.06851591169834137, 0.33975932002067566, 0.06309476494789124, 0.06309476494789124], [0.09047733247280121, 0.09022191166877747, 0.09022509306669235, 0.09048690646886826, 0.0908302292227745, 0.09023463726043701, 0.0902378186583519, 0.09049967676401138, 0.09637191146612167, 0.09020724892616272, 0.09020724892616272], [0.09047733247280121, 0.09022191166877747, 0.09022509306669235, 0.09048690646886826, 0.0908302292227745, 0.09023463726043701, 0.0902378186583519, 0.09049967676401138, 0.09637191146612167, 0.09020724892616272, 0.09020724892616272]]]}, "num_training_step_calls_per_iteration": 1, "evaluation": {"env_runners": {"module_to_env_connector": {"timers": {"connectors": {"tensor_to_numpy": 2.9870940150969286e-05, "un_batch_to_individual_items": 1.1398259249106405e-05, "get_actions": 9.975780510251363e-05, "listify_data_for_vector_env": 2.1152263677008315e-05, "normalize_and_clip_actions": 1.4489956414180578e-05, "remove_single_ts_time_rank_from_batch": 2.0696753107920135e-05}}, "connector_pipeline_timer": 0.0002605483881311042}, "episode_len_min": 20, "num_env_steps_sampled": 400, "weights_seq_no": 18.0, "episode_len_mean": 20.0, "env_to_module_sum_episodes_length_out": 10.368238394574323, "episode_len_max": 20, "env_to_module_connector": {"timers": {"connectors": {"batch_individual_items": 2.2119389094284894e-05, "add_observations_from_episodes_to_batch": 5.313744861030169e-06, "add_states_from_episodes_to_batch": 4.631267799363914e-06, "add_time_dim_to_batch_and_zero_pad": 1.2857722954061751e-05, "numpy_to_tensor": 2.7953936265950258e-05}}, "connector_pipeline_timer": 0.000108800928270898}, "env_to_module_sum_episodes_length_in": 10.368238394574323, "num_episodes_lifetime": 360, "episode_duration_sec_mean": 0.00705576334730722, "episode_return_max": 12.5, "rlmodule_inference_timer": 8.063214300174088e-05, "num_agent_steps_sampled": {"default_agent": 400}, "num_module_steps_sampled_lifetime": {"default_policy": 7200}, "num_agent_steps_sampled_lifetime": {"default_agent": 7200}, "num_module_steps_sampled": {"default_policy": 400}, "sample": 0.1326824518374393, "episode_return_mean": -0.2, "env_step_timer": 3.016566255099946e-05, "agent_episode_returns_mean": {"default_agent": -0.2}, "num_episodes": 20, "module_episode_returns_mean": {"default_policy": -0.2}, "episode_return_min": -12.5, "num_env_steps_sampled_lifetime": 90400, "env_reset_timer": 0.0005426751295123137, "time_between_sampling": 12.208908244686345}, "num_healthy_workers": 1, "actor_manager_num_outstanding_async_reqs": 0, "num_remote_worker_restarts": 0}, "num_env_steps_sampled_lifetime": -9870000.0, "fault_tolerance": {"num_healthy_workers": 0, "num_remote_worker_restarts": 0}, "env_runner_group": {"actor_manager_num_outstanding_async_reqs": 0}, "done": false, "training_iteration": 18, "trial_id": "ae8a2_00000", "date": "2025-08-11_18-25-39", "timestamp": 1754929539, "time_this_iter_s": 9.465227127075195, "time_total_s": 192.90726971626282, "pid": 10870, "hostname": "Mac", "node_ip": "127.0.0.1", "config": {"exploration_config": {}, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 2, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "env": "Umbrella", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": false, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 0, "create_local_env_runner": true, "num_envs_per_env_runner": 1, "gym_env_vectorize_mode": "SYNC", "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "episodes_to_numpy": true, "max_requests_in_flight_per_env_runner": 1, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "merge_env_runner_states": "training_only", "broadcast_env_runner_states": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "complete_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "sampler_perf_stats_ema_coef": null, "_is_online": true, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": "auto", "num_aggregator_actors_per_learner": 0, "max_requests_in_flight_per_aggregator_actor": 3, "local_gpu_idx": 0, "max_requests_in_flight_per_learner": 3, "gamma": 1, "lr": 0.0002715581955, "grad_clip": 0.5, "grad_clip_by": "global_norm", "_train_batch_size_per_learner": 5000, "train_batch_size": 4000, "num_epochs": 1, "minibatch_size": 1000, "shuffle_batch_per_epoch": true, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "log_std_clip_param": 20.0, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "_disable_preprocessor_api": false, "_disable_action_flattening": false}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {"intrinsic_reward_coeff": 0.2795015916508}, "optimizer": {}, "_learner_class": "<class 'source.intrinsic_attention_ppo.learners.IntrinsicAttentionMetaLearner.IntrinsicAttentionMetaLearner'>", "callbacks_on_algorithm_init": null, "callbacks_on_env_runners_recreated": null, "callbacks_on_offline_eval_runners_recreated": null, "callbacks_on_checkpoint_loaded": null, "callbacks_on_environment_created": null, "callbacks_on_episode_created": null, "callbacks_on_episode_start": null, "callbacks_on_episode_step": null, "callbacks_on_episode_end": null, "callbacks_on_evaluate_start": null, "callbacks_on_evaluate_end": null, "callbacks_on_evaluate_offline_start": null, "callbacks_on_evaluate_offline_end": null, "callbacks_on_sample_end": null, "callbacks_on_train_result": null, "explore": true, "enable_rl_module_and_learner": true, "enable_env_runner_and_connector_v2": true, "_prior_exploration_config": {"type": "StochasticSampling"}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x38844d8a0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "offline_data_class": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_read_batch_size": null, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "materialize_data": false, "materialize_mapped_data": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "ignore_final_observation": false, "prelearner_class": null, "prelearner_buffer_class": null, "prelearner_buffer_kwargs": {}, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_remaining_data": false, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": 1, "evaluation_duration": 20, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_auto_duration_min_env_steps_per_sample": 100, "evaluation_auto_duration_max_env_steps_per_sample": 2000, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 1, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "offline_evaluation_interval": null, "num_offline_eval_runners": 0, "offline_loss_for_module_fn": null, "offline_evaluation_duration": 1, "offline_evaluation_parallel_to_training": false, "offline_evaluation_timeout_s": 120.0, "num_cpus_per_offline_eval_runner": 1, "num_gpus_per_offline_eval_runner": 0, "custom_resources_per_offline_eval_runner": {}, "restart_failed_offline_eval_runners": true, "ignore_offline_eval_runner_failures": false, "max_num_offline_eval_runner_restarts": 1000, "offline_eval_runner_restore_timeout_s": 1800.0, "max_requests_in_flight_per_offline_eval_runner": 1, "validate_offline_eval_runners_after_construction": true, "offline_eval_runner_health_probe_timeout_s": 30.0, "offline_eval_rl_module_inference_only": false, "broadcast_offline_eval_runner_states": false, "offline_eval_batch_size_per_runner": 256, "dataset_num_iters_per_eval_runner": 1, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "log_gradients": false, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 1, "restart_failed_env_runners": true, "ignore_env_runner_failures": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30.0, "env_runner_restore_timeout_s": 1800.0, "_model_config": {}, "_rl_module_spec": "MultiRLModuleSpec(multi_rl_module_class=<class 'ray.rllib.core.rl_module.multi_rl_module.MultiRLModule'>, observation_space=None, action_space=None, inference_only=False, model_config=None, rl_module_specs={'default_policy': RLModuleSpec(module_class=<class 'source.intrinsic_attention_ppo.rl_modules.DifferentiablePPOModule.DifferentiablePPOModule'>, observation_space=None, action_space=None, inference_only=False, learner_only=False, model_config={'vf_share_layers': True, 'embedding_dim': 62, 'max_seq_len': 11, 'policy_head_hidden_sizes': [32], 'value_head_hidden_sizes': [101], 'embedding_hidden_sizes': [121]}, catalog_class=None, load_state_path=None, model_config_dict=None), 'intrinsic_reward_module': RLModuleSpec(module_class=<class 'source.intrinsic_attention_ppo.rl_modules.IntrinsicAttentionModule.IntrinsicAttentionModule'>, observation_space=None, action_space=None, inference_only=False, learner_only=True, model_config={'intrinsic_reward_network': {'encoder_hidden_sizes': [], 'encoding_dim': 1, 'num_heads': 1, 'head_hidden_sizes': None, 'layers': [{'type': 'attention'}]}, 'extrinsic_value_hidden_layers': [127, 60], 'vf_share_layers': True, 'max_seq_len': 11}, catalog_class=None, load_state_path=None, model_config_dict=None)}, load_state_path=None, modules_to_load=None, module_specs={'default_policy': RLModuleSpec(module_class=<class 'source.intrinsic_attention_ppo.rl_modules.DifferentiablePPOModule.DifferentiablePPOModule'>, observation_space=None, action_space=None, inference_only=False, learner_only=False, model_config={'vf_share_layers': True, 'embedding_dim': 62, 'max_seq_len': 11, 'policy_head_hidden_sizes': [32], 'value_head_hidden_sizes': [101], 'embedding_hidden_sizes': [121]}, catalog_class=None, load_state_path=None, model_config_dict=None), 'intrinsic_reward_module': RLModuleSpec(module_class=<class 'source.intrinsic_attention_ppo.rl_modules.IntrinsicAttentionModule.IntrinsicAttentionModule'>, observation_space=None, action_space=None, inference_only=False, learner_only=True, model_config={'intrinsic_reward_network': {'encoder_hidden_sizes': [], 'encoding_dim': 1, 'num_heads': 1, 'head_hidden_sizes': None, 'layers': [{'type': 'attention'}]}, 'extrinsic_value_hidden_layers': [127, 60], 'vf_share_layers': True, 'max_seq_len': 11}, catalog_class=None, load_state_path=None, model_config_dict=None)})", "algorithm_config_overrides_per_module": {"intrinsic_reward_module": {"lr": 0.0002715581955}}, "_per_module_overrides": {}, "_validate_config": true, "_use_msgpack_checkpoints": false, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "env_task_fn": -1, "enable_connectors": -1, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.161583927863, "kl_target": 0.0201019014258, "vf_loss_coeff": 0.7790510010087, "entropy_coeff": 0.0015431216992, "clip_param": 0.2459212356676, "vf_clip_param": 0.3769744131561, "entropy_coeff_schedule": null, "lr_schedule": null, "sgd_minibatch_size": -1, "vf_share_layers": -1, "differentiable_learner_configs": ["DifferentiableLearnerConfig(learner_class=<class 'source.intrinsic_attention_ppo.learners.IntrinsicAttentionPPOLearner.IntrinsicAttentionPPOLearner'>, learner_connector=None, add_default_connectors_to_learner_pipeline=True, is_multi_agent=False, policies_to_update=['default_policy'], lr=0.0060984166342, num_total_minibatches=0, num_epochs=1, minibatch_size=1000, shuffle_batch_per_epoch=True)"], "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9485408017724, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.callbacks.callbacks.RLlibCallback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 192.90726971626282, "iterations_since_restore": 18, "perf": {"cpu_util_percent": 36.84285714285715, "ram_util_percent": 78.5642857142857}}
{"timers": {"training_iteration": 12.279064773830125, "restore_env_runners": 1.1795667678214532e-05, "training_step": 12.278860342607805, "env_runner_sampling_timer": 2.758566189629012, "learner_update_timer": 9.304748138557724, "synch_weights": 0.0016100664481285183, "restore_eval_env_runners": 5.0488444652465484e-05, "evaluation_iteration": 0.1443195881315825, "synch_eval_env_connectors": 0.00022363871644835433, "synch_env_connectors": 5.947871256363093e-06}, "env_runners": {"module_to_env_connector": {"connector_pipeline_timer": 0.0002483823739760042, "timers": {"connectors": {"remove_single_ts_time_rank_from_batch": 2.1075704602380328e-05, "un_batch_to_individual_items": 1.1302621661045881e-05, "get_actions": 9.940599058454611e-05, "tensor_to_numpy": 3.378511667723119e-05, "listify_data_for_vector_env": 2.1675187439056062e-05, "normalize_and_clip_actions": 1.4096874561824807e-05}}}, "rlmodule_inference_timer": 7.081256375188774e-05, "sample": 0.010352312081950426, "weights_seq_no": 18.0, "num_agent_steps_sampled": {"default_agent": 5000.0}, "episode_len_mean": 20.0, "episode_len_max": 20, "env_to_module_connector": {"timers": {"connectors": {"batch_individual_items": 2.4719397801253318e-05, "add_states_from_episodes_to_batch": 4.801796342382359e-06, "numpy_to_tensor": 2.787562433915281e-05, "add_observations_from_episodes_to_batch": 5.1561739397304985e-06, "add_time_dim_to_batch_and_zero_pad": 1.537983012250895e-05}}, "connector_pipeline_timer": 0.00011474663304764271}, "env_to_module_sum_episodes_length_out": 10.36823839457432, "num_agent_steps_sampled_lifetime": {"default_agent": -10487500.0}, "episode_return_mean": 1.5800000000000005, "num_module_steps_sampled_lifetime": {"default_policy": -10487500.0}, "num_episodes": 250.0, "time_between_sampling": 0.03269068132768098, "num_env_steps_sampled_lifetime": -10487500.0, "episode_return_min": -10.5, "env_reset_timer": 9.006193082773872e-05, "env_to_module_sum_episodes_length_in": 10.36823839457432, "num_episodes_lifetime": -524375.0, "agent_episode_returns_mean": {"default_agent": 1.5800000000000005}, "episode_len_min": 20, "episode_duration_sec_mean": 0.010904330205637964, "env_step_timer": 3.1012680218827886e-05, "episode_return_max": 9.5, "num_module_steps_sampled": {"default_policy": 5000.0}, "module_episode_returns_mean": {"default_policy": 1.5800000000000005}, "num_env_steps_sampled": 5000.0, "num_env_steps_sampled_lifetime_throughput": 2131.902433337028}, "__all_modules__": {"learner_connector_sum_episodes_length_in": 5000.0, "learner_connector": {"connector_pipeline_timer": 0.15891020725321875, "timers": {"connectors": {"add_one_ts_to_episodes_and_truncate": 0.00932200950485313, "add_observations_from_episodes_to_batch": 0.0015569764175056551, "add_columns_from_episodes_to_train_batch": 0.04886162100165842, "add_time_dim_to_batch_and_zero_pad": 0.08427488647701893, "add_states_from_episodes_to_batch": 0.00837568691155161, "batch_individual_items": 0.006189443798521168, "numpy_to_tensor": 9.358492553101429e-05}}}, "learner_connector_sum_episodes_length_out": 5250.0}, "learners": {"default_policy": {"curr_entropy_coeff": 0.0015431216992, "curr_kl_coeff": 3.0819688845440396e-07, "num_module_steps_trained_lifetime": 113715, "entropy": 0.6747373938560486, "num_module_steps_trained": 5985, "diff_num_grad_updates_vs_sampler_policy": 1.0, "vf_loss": 0.35831642150878906, "vf_loss_unclipped": 43.76533126831055, "policy_loss": -0.00047835722216404974, "use_intrinsic_rewards": 0.0, "total_loss": 0.27762722969055176, "vf_explained_var": -0.0022472143173217773, "mean_kl_loss": 3.6111388908466324e-05, "weights_seq_no": 19.0, "num_trainable_parameters": 16595, "module_train_batch_size_mean": 997.6572809365935, "num_module_steps_trained_lifetime_throughput": 723.1229618135703}, "intrinsic_reward_module": {"num_module_steps_trained_lifetime": 113715, "num_module_steps_trained": 5985, "diff_num_grad_updates_vs_sampler_policy": 1.0, "total_loss": 0.0, "gradients_default_optimizer_global_norm": 0.0, "module_train_batch_size_mean": 997.6572809365935, "default_optimizer_learning_rate": 0.0002715581955, "weights_seq_no": 19.0, "num_trainable_parameters": 8266, "curr_entropy_coeff": 0.0015431216992, "num_module_steps_trained_lifetime_throughput": 723.1282982625072}, "differentiable_learners": {"intrinsic_attention_ppo_learner": {"default_policy": {"weights_seq_no": 114.0, "num_module_steps_trained": 35910, "num_module_steps_trained_lifetime": 682290, "entropy": 0.6747910380363464, "diff_num_grad_updates_vs_sampler_policy": 96.0, "vf_loss": 0.3584043085575104, "vf_loss_unclipped": 43.704620361328125, "total_loss": 0.2777167558670044, "mean_kl_loss": 3.3754527976270765e-05, "policy_loss": -0.00046265553100965917, "use_intrinsic_rewards": 1.0, "module_train_batch_size_mean": 997.4980069784294, "vf_explained_var": -0.0014415979385375977}, "__all_modules__": {"num_env_steps_trained": 198000, "num_module_steps_trained": 71820, "num_module_steps_trained_lifetime": 1364580, "num_env_steps_trained_lifetime": 3762000, "num_env_steps_trained_lifetime_throughput": 34537.16942148266}, "intrinsic_reward_module": {"weights_seq_no": 114.0, "num_module_steps_trained_lifetime": 682290, "num_module_steps_trained": 35910, "diff_num_grad_updates_vs_sampler_policy": 96.0, "total_loss": 0.0, "module_train_batch_size_mean": 997.4980069784294}}}, "__all_modules__": {"num_env_steps_trained_lifetime": 627000, "num_non_trainable_parameters": 0, "num_trainable_parameters": 24861, "num_env_steps_trained": 33000, "num_module_steps_trained": 11970, "num_module_steps_trained_lifetime": 227430, "num_env_steps_trained_lifetime_throughput": 3988.1728262738015, "num_module_steps_trained_throughput": 19115207.42893689, "num_module_steps_trained_lifetime_throughput": 12505333.122825563}, "IntrinsicAttentionMask": [[[0.09248538315296173, 0.09249506145715714, 0.09070822596549988, 0.09071771800518036, 0.09150051325559616, 0.09151008725166321, 0.0897422730922699, 0.08975166827440262, 0.09153879433870316, 0.08977043628692627, 0.0897798240184784], [0.09249236434698105, 0.09250207990407944, 0.09070731699466705, 0.09071684628725052, 0.0915030986070633, 0.09151270985603333, 0.08973714709281921, 0.08974657952785492, 0.09154155850410461, 0.08976542949676514, 0.08977486193180084], [0.09119665622711182, 0.0911983996629715, 0.090873122215271, 0.09087485820055008, 0.09101799130439758, 0.09101973474025726, 0.0906950905919075, 0.09069682657718658, 0.0910249650478363, 0.09070029854774475, 0.09070204198360443], [0.09120357036590576, 0.09120535850524902, 0.09087224304676056, 0.09087403118610382, 0.0910205990076065, 0.09102238714694977, 0.09068994969129562, 0.09069172292947769, 0.09102774411439896, 0.09069527685642242, 0.09069706499576569], [0.09177300333976746, 0.09177827835083008, 0.09080012142658234, 0.09080534428358078, 0.09123490005731583, 0.09124014526605606, 0.09026772528886795, 0.09027291089296341, 0.09125587344169617, 0.09028328955173492, 0.09028847515583038], [0.09177994728088379, 0.0917852595448494, 0.0907992273569107, 0.09080449491739273, 0.09123750030994415, 0.09124278277158737, 0.09026258438825607, 0.09026780724525452, 0.09125863015651703, 0.0902782678604126, 0.09028349816799164], [0.09048999845981598, 0.09048747271299362, 0.09096096456050873, 0.09095841646194458, 0.09074956923723221, 0.09074702858924866, 0.091221883893013, 0.09121933579444885, 0.090739406645298, 0.09121422469615936, 0.09121166914701462], [0.09049689024686813, 0.09049440175294876, 0.09096011519432068, 0.09095761924982071, 0.09075219929218292, 0.09074970334768295, 0.09121673554182053, 0.09121422469615936, 0.09074220806360245, 0.09120920300483704, 0.09120669215917587], [0.09180077910423279, 0.09180622547864914, 0.0907965749502182, 0.09080195426940918, 0.09124530851840973, 0.09125072509050369, 0.09024717658758163, 0.09025252610445023, 0.09126695245504379, 0.090263232588768, 0.0902685821056366], [0.09051066637039185, 0.09050825983285904, 0.09095842391252518, 0.09095600247383118, 0.09075745940208435, 0.09075504541397095, 0.09120643883943558, 0.09120401740074158, 0.09074780344963074, 0.09119915962219238, 0.09119673818349838], [0.0905175507068634, 0.09051518142223358, 0.09095756709575653, 0.09095519781112671, 0.09076008200645447, 0.09075771272182465, 0.0912012830376625, 0.09119889885187149, 0.09075058996677399, 0.09119413048028946, 0.09119174629449844]], [[0.09015399217605591, 0.0889132022857666, 0.08962534368038177, 0.09017409384250641, 0.09018079191446304, 0.08893962949514389, 0.08894623070955276, 0.09091659635305405, 0.1029740422964096, 0.08958800882101059, 0.08958800882101059], [0.09101372957229614, 0.09121064841747284, 0.09109724313020706, 0.09101056307554245, 0.09100951254367828, 0.09120641648769379, 0.09120536595582962, 0.09089425206184387, 0.08914599567651749, 0.09110315889120102, 0.09110315889120102], [0.09054295718669891, 0.08990593999624252, 0.09027207642793655, 0.09055323898792267, 0.09055666625499725, 0.0899195522069931, 0.0899229645729065, 0.09093233942985535, 0.09688844531774521, 0.09025292098522186, 0.09025292098522186], [0.09013853967189789, 0.08887504786252975, 0.08960018306970596, 0.09015900641679764, 0.09016583859920502, 0.08890196681022644, 0.08890868723392487, 0.0909152552485466, 0.10321121662855148, 0.08956216275691986, 0.08956216275691986], [0.09013336896896362, 0.08886231482028961, 0.08959177136421204, 0.09015395492315292, 0.09016081690788269, 0.08888938277959824, 0.08889615535736084, 0.0909147784113884, 0.1032903641462326, 0.08955352753400803, 0.08955352753400803], [0.09099731594324112, 0.09116287529468536, 0.09106753766536713, 0.09099465608596802, 0.09099376946687698, 0.09115932136774063, 0.0911584347486496, 0.090896837413311, 0.08942417800426483, 0.09107251465320587, 0.09107251465320587], [0.09099320322275162, 0.0911509245634079, 0.0910601019859314, 0.09099067002534866, 0.09098982810974121, 0.0911475419998169, 0.09114669263362885, 0.09089747071266174, 0.08949384838342667, 0.09106484055519104, 0.09106484055519104], [0.08953166007995605, 0.08744383603334427, 0.08863964676856995, 0.08956564962863922, 0.08957698196172714, 0.0874880999326706, 0.08749915659427643, 0.09082493185997009, 0.11227653175592422, 0.0885767862200737, 0.0885767862200737], [0.06928854435682297, 0.058599621057510376, 0.06453299522399902, 0.06947551667690277, 0.06953795999288559, 0.05881056189537048, 0.05886341258883476, 0.07671656459569931, 0.3457573354244232, 0.0642087459564209, 0.0642087459564209], [0.0905691385269165, 0.0899752601981163, 0.09031664580106735, 0.09057871997356415, 0.09058191627264023, 0.08998795598745346, 0.08999112993478775, 0.09093201160430908, 0.0964696928858757, 0.09029877930879593, 0.09029877930879593], [0.0905691385269165, 0.0899752601981163, 0.09031664580106735, 0.09057871997356415, 0.09058191627264023, 0.08998795598745346, 0.08999112993478775, 0.09093201160430908, 0.0964696928858757, 0.09029877930879593, 0.09029877930879593]], [[0.09096986055374146, 0.0916653424501419, 0.0907195582985878, 0.09072460234165192, 0.09113998711109161, 0.09168573468923569, 0.0902046337723732, 0.09074478596448898, 0.09170103073120117, 0.09021968394517899, 0.09022470563650131], [0.09103472530841827, 0.09252659231424332, 0.09050097316503525, 0.09051170945167542, 0.09139847755432129, 0.09257052838802338, 0.08940815925598145, 0.09055468440055847, 0.09260348975658417, 0.0894399955868721, 0.08945061266422272], [0.09094533324241638, 0.09135468304157257, 0.09079769998788834, 0.09080067276954651, 0.09104558825492859, 0.09136666357517242, 0.09049345552921295, 0.0908125787973404, 0.09137564897537231, 0.09050235152244568, 0.09050532430410385], [0.09094583243131638, 0.09136094152927399, 0.09079612046480179, 0.09079913794994354, 0.0910474881529808, 0.09137309342622757, 0.09048761427402496, 0.09081121534109116, 0.09138220548629761, 0.09049664437770844, 0.09049965441226959], [0.09098617732524872, 0.09187629818916321, 0.0906662866473198, 0.09067273885011673, 0.09120374172925949, 0.09190242737531662, 0.09000899642705917, 0.09069851785898209, 0.09192202240228653, 0.09002818912267685, 0.09003458172082901], [0.09103655815124512, 0.0925518050789833, 0.0904945358633995, 0.0905054435133934, 0.09140598028898239, 0.09259643405675888, 0.08938494324684143, 0.09054908156394958, 0.09262991696596146, 0.08941727131605148, 0.08942805230617523], [0.09089286625385284, 0.09071438759565353, 0.09095752239227295, 0.09095621854066849, 0.09084904938936234, 0.09070917963981628, 0.09109123796224594, 0.09095099568367004, 0.09070528298616409, 0.09108731895685196, 0.0910860076546669], [0.09094782918691635, 0.09138599783182144, 0.09078983217477798, 0.09079301357269287, 0.09105513244867325, 0.09139883518218994, 0.090464286506176, 0.09080576151609421, 0.09140845388174057, 0.09047381579875946, 0.09047698974609375], [0.09103792160749435, 0.0925706997513771, 0.0904896929860115, 0.09050072729587555, 0.09141159057617188, 0.09261585026979446, 0.08936753123998642, 0.09054486453533173, 0.09264972805976868, 0.08940021693706512, 0.08941111713647842], [0.0908944383263588, 0.0907331183552742, 0.09095286577939987, 0.09095168113708496, 0.09085483103990555, 0.09072840958833694, 0.09107369184494019, 0.09094696491956711, 0.0907248854637146, 0.09107014536857605, 0.09106896817684174], [0.09089495986700058, 0.09073936194181442, 0.09095130860805511, 0.09095017611980438, 0.09085676074028015, 0.0907348245382309, 0.0910678431391716, 0.09094562381505966, 0.0907314196228981, 0.09106442332267761, 0.09106329083442688]], [[0.09043385833501816, 0.08837810158729553, 0.08723751455545425, 0.09046730399131775, 0.09047845751047134, 0.08726978302001953, 0.08728054165840149, 0.09051192551851273, 0.1112867146730423, 0.08832792192697525, 0.08832792192697525], [0.09081017971038818, 0.09017902612686157, 0.08982442319393158, 0.09082036465406418, 0.09082376956939697, 0.08983450382947922, 0.08983786404132843, 0.09083395451307297, 0.09670894593000412, 0.09016349166631699, 0.09016349166631699], [0.09093134850263596, 0.09112026542425156, 0.09122715890407562, 0.09092831611633301, 0.09092730283737183, 0.09122411161661148, 0.0912230983376503, 0.09092427045106888, 0.0892442986369133, 0.09112493693828583, 0.09112493693828583], [0.090426005423069, 0.0883476734161377, 0.0871947780251503, 0.09045983105897903, 0.09047111123800278, 0.08722739666700363, 0.08723827451467514, 0.090504951775074, 0.11153609305620193, 0.08829694241285324, 0.08829694241285324], [0.09042339026927948, 0.08833752572536469, 0.08718053251504898, 0.09045732766389847, 0.09046865254640579, 0.08721326291561127, 0.08722417801618576, 0.09050261974334717, 0.11161933094263077, 0.08828660845756531, 0.08828660845756531], [0.09092876315116882, 0.09109419584274292, 0.09118778258562088, 0.09092610329389572, 0.09092521667480469, 0.09118512272834778, 0.09118422865867615, 0.09092255681753159, 0.08944948762655258, 0.09109828621149063, 0.09109828621149063], [0.09092788398265839, 0.09108549356460571, 0.0911746472120285, 0.09092535078525543, 0.09092450886964798, 0.09117210656404495, 0.0911712646484375, 0.09092197567224503, 0.0895179733633995, 0.09108938276767731, 0.09108938276767731], [0.09041546285152435, 0.08830702304840088, 0.08713774383068085, 0.09044978022575378, 0.09046122431755066, 0.08717082440853119, 0.08718185871839523, 0.09049556404352188, 0.11186935007572174, 0.08825556933879852, 0.08825556933879852], [0.07467647641897202, 0.06315638870000839, 0.057452715933322906, 0.07487799227237701, 0.07494528591632843, 0.05760775879025459, 0.05765953287482262, 0.07514753192663193, 0.3386852741241455, 0.0628955289721489, 0.0628955289721489], [0.09081680327653885, 0.09022130817174911, 0.0898866280913353, 0.09082641452550888, 0.09082962572574615, 0.08989614248275757, 0.08989931643009186, 0.09083922952413559, 0.09637126326560974, 0.09020665287971497, 0.09020665287971497], [0.09081680327653885, 0.09022130817174911, 0.0898866280913353, 0.09082641452550888, 0.09082962572574615, 0.08989614248275757, 0.08989931643009186, 0.09083922952413559, 0.09637126326560974, 0.09020665287971497, 0.09020665287971497]], [[0.09101907163858414, 0.09171494096517563, 0.09023337066173553, 0.09077368676662445, 0.09118930250406265, 0.09173534065485, 0.090788833796978, 0.09079387784004211, 0.09120958298444748, 0.09026849269866943, 0.09027351438999176], [0.09114055335521698, 0.0926341563463211, 0.08946961909532547, 0.09061692655086517, 0.09150472283363342, 0.09267813712358475, 0.09064919501543045, 0.09065995365381241, 0.09154817461967468, 0.08954396843910217, 0.08955460041761398], [0.09087654948234558, 0.0906752273440361, 0.09110627323389053, 0.09094802290201187, 0.09082712233066559, 0.09066934883594513, 0.0909436047077179, 0.0909421294927597, 0.09082123637199402, 0.0910959467291832, 0.091094471514225], [0.09097518026828766, 0.09139043092727661, 0.09050478786230087, 0.09082844108343124, 0.09107688069343567, 0.0914025828242302, 0.0908375009894371, 0.09084052592515945, 0.09108898788690567, 0.09052585065364838, 0.09052886068820953], [0.0910491943359375, 0.09193993359804153, 0.09004572778940201, 0.0907355397939682, 0.09126691520214081, 0.09196607768535614, 0.09075488895177841, 0.09076134115457535, 0.0912928655743599, 0.0900905430316925, 0.09009695053100586], [0.09114404767751694, 0.09266107529401779, 0.08944734930992126, 0.09061229974031448, 0.09151389449834824, 0.09270575642585754, 0.09064506739377975, 0.09065598994493484, 0.09155801683664322, 0.0895228385925293, 0.08953363448381424], [0.09097789973020554, 0.09141045063734055, 0.090488001704216, 0.09082506597042084, 0.091083824634552, 0.09142311662435532, 0.09083450585603714, 0.09083765000104904, 0.09109644591808319, 0.09050993621349335, 0.09051307290792465], [0.09097880870103836, 0.09141712635755539, 0.09048240631818771, 0.0908239483833313, 0.09108614176511765, 0.09142996370792389, 0.09083350747823715, 0.09083669632673264, 0.09109892696142197, 0.09050463140010834, 0.09050780534744263], [0.09105277061462402, 0.09196674078702927, 0.09002340584993362, 0.09073098748922348, 0.0912761390209198, 0.09199357032775879, 0.09075083583593369, 0.09075745195150375, 0.0913027748465538, 0.09006936848163605, 0.09007593989372253], [0.09088306128978729, 0.09072176367044449, 0.09106701612472534, 0.09094029664993286, 0.09084346145391464, 0.09071705490350723, 0.09093675762414932, 0.09093558043241501, 0.09083875268697739, 0.09105874598026276, 0.09105756878852844], [0.09088397771120071, 0.09072840213775635, 0.09106139838695526, 0.09093918651342392, 0.09084578603506088, 0.09072386473417282, 0.09093577414751053, 0.0909346342086792, 0.09084124118089676, 0.09105342626571655, 0.09105228632688522]], [[0.08989937603473663, 0.08936557918787003, 0.08937222510576248, 0.09063288569450378, 0.0906396210193634, 0.08939214050769806, 0.08939878642559052, 0.08994615077972412, 0.10268320143222809, 0.08933499455451965, 0.08933499455451965], [0.09041780233383179, 0.09014721214771271, 0.09015057981014252, 0.09078831970691681, 0.090791717171669, 0.09016069024801254, 0.09016407281160355, 0.09044146537780762, 0.09667482227087021, 0.09013167768716812, 0.09013167768716812], [0.09041152894496918, 0.09013763815164566, 0.09014104306697845, 0.09078659862279892, 0.0907900407910347, 0.09015128016471863, 0.09015469253063202, 0.09043549001216888, 0.09674780815839767, 0.09012191742658615, 0.09012191742658615], [0.08913597464561462, 0.08824975788593292, 0.08826076239347458, 0.09035958349704742, 0.09037084877490997, 0.08829378336668015, 0.0883047878742218, 0.0892137885093689, 0.11141247302293777, 0.08819909393787384, 0.08819909393787384], [0.08912868797779083, 0.08823928982019424, 0.08825033158063889, 0.09035674482584, 0.09036805480718613, 0.0882834643125534, 0.08829451352357864, 0.08920678496360779, 0.11149519681930542, 0.08818843215703964, 0.08818843215703964], [0.09039272367954254, 0.09010890871286392, 0.09011244773864746, 0.09078143537044525, 0.09078499674797058, 0.09012304991483688, 0.09012658894062042, 0.09041755646467209, 0.09696709364652634, 0.09009262174367905, 0.09009262174367905], [0.09038645029067993, 0.09009932726621628, 0.0901029035449028, 0.09077969938516617, 0.09078330546617508, 0.09011363238096237, 0.0901172086596489, 0.09041156619787216, 0.09704028815031052, 0.09008284658193588, 0.09008284658193588], [0.08985248953104019, 0.089295893907547, 0.08930282294750214, 0.09061755985021591, 0.09062457829713821, 0.08932358771562576, 0.0893305167555809, 0.08990126103162766, 0.10322332382202148, 0.08926400542259216, 0.08926400542259216], [0.06762363016605377, 0.06292581558227539, 0.06298236548900604, 0.07460461556911469, 0.074671670794487, 0.06315232813358307, 0.06320907920598984, 0.06805019825696945, 0.33744844794273376, 0.0626659095287323, 0.0626659095287323], [0.09044656902551651, 0.09019123017787933, 0.09019441157579422, 0.09079614281654358, 0.09079933911561966, 0.09020396322011948, 0.09020714461803436, 0.09046890586614609, 0.0963391363620758, 0.09017657488584518, 0.09017657488584518], [0.09044656902551651, 0.09019123017787933, 0.09019441157579422, 0.09079614281654358, 0.09079933911561966, 0.09020396322011948, 0.09020714461803436, 0.09046890586614609, 0.0963391363620758, 0.09017657488584518, 0.09017657488584518]]]}, "num_training_step_calls_per_iteration": 1, "evaluation": {"env_runners": {"module_to_env_connector": {"timers": {"connectors": {"tensor_to_numpy": 1.5165296169831704e-05, "un_batch_to_individual_items": 6.600125477257069e-06, "get_actions": 3.630432771121482e-05, "listify_data_for_vector_env": 1.0347367916458925e-05, "normalize_and_clip_actions": 8.030700576204597e-06, "remove_single_ts_time_rank_from_batch": 1.187475096981144e-05}}, "connector_pipeline_timer": 0.00011476113594478452}, "episode_len_min": 20, "num_env_steps_sampled": 400, "weights_seq_no": 19.0, "episode_len_mean": 20.0, "env_to_module_sum_episodes_length_out": 10.368238394574323, "episode_len_max": 20, "env_to_module_connector": {"timers": {"connectors": {"batch_individual_items": 1.2318833721941268e-05, "add_observations_from_episodes_to_batch": 2.8073632167292555e-06, "add_states_from_episodes_to_batch": 2.770102654566448e-06, "add_time_dim_to_batch_and_zero_pad": 6.812957962274788e-06, "numpy_to_tensor": 1.1998485158891356e-05}}, "connector_pipeline_timer": 5.856433715647303e-05}, "env_to_module_sum_episodes_length_in": 10.368238394574323, "num_episodes_lifetime": 380, "episode_duration_sec_mean": 0.007060705436160788, "episode_return_max": 12.5, "rlmodule_inference_timer": 3.099194064286167e-05, "num_agent_steps_sampled": {"default_agent": 400}, "num_module_steps_sampled_lifetime": {"default_policy": 7600}, "num_agent_steps_sampled_lifetime": {"default_agent": 7600}, "num_module_steps_sampled": {"default_policy": 400}, "sample": 0.1324964044000832, "episode_return_mean": 0.0, "env_step_timer": 1.386592108918369e-05, "agent_episode_returns_mean": {"default_agent": 0.0}, "num_episodes": 20, "module_episode_returns_mean": {"default_policy": 0.0}, "episode_return_min": -12.5, "num_env_steps_sampled_lifetime": 95400, "env_reset_timer": 0.0005406217182222456, "time_between_sampling": 12.195624433068952}, "num_healthy_workers": 1, "actor_manager_num_outstanding_async_reqs": 0, "num_remote_worker_restarts": 0}, "num_env_steps_sampled_lifetime": -10487500.0, "fault_tolerance": {"num_healthy_workers": 0, "num_remote_worker_restarts": 0}, "env_runner_group": {"actor_manager_num_outstanding_async_reqs": 0}, "done": false, "training_iteration": 19, "trial_id": "ae8a2_00000", "date": "2025-08-11_18-25-50", "timestamp": 1754929550, "time_this_iter_s": 10.961185932159424, "time_total_s": 203.86845564842224, "pid": 10870, "hostname": "Mac", "node_ip": "127.0.0.1", "config": {"exploration_config": {}, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 2, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "env": "Umbrella", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": false, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 0, "create_local_env_runner": true, "num_envs_per_env_runner": 1, "gym_env_vectorize_mode": "SYNC", "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "episodes_to_numpy": true, "max_requests_in_flight_per_env_runner": 1, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "merge_env_runner_states": "training_only", "broadcast_env_runner_states": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "complete_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "sampler_perf_stats_ema_coef": null, "_is_online": true, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": "auto", "num_aggregator_actors_per_learner": 0, "max_requests_in_flight_per_aggregator_actor": 3, "local_gpu_idx": 0, "max_requests_in_flight_per_learner": 3, "gamma": 1, "lr": 0.0002715581955, "grad_clip": 0.5, "grad_clip_by": "global_norm", "_train_batch_size_per_learner": 5000, "train_batch_size": 4000, "num_epochs": 1, "minibatch_size": 1000, "shuffle_batch_per_epoch": true, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "log_std_clip_param": 20.0, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "_disable_preprocessor_api": false, "_disable_action_flattening": false}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {"intrinsic_reward_coeff": 0.2795015916508}, "optimizer": {}, "_learner_class": "<class 'source.intrinsic_attention_ppo.learners.IntrinsicAttentionMetaLearner.IntrinsicAttentionMetaLearner'>", "callbacks_on_algorithm_init": null, "callbacks_on_env_runners_recreated": null, "callbacks_on_offline_eval_runners_recreated": null, "callbacks_on_checkpoint_loaded": null, "callbacks_on_environment_created": null, "callbacks_on_episode_created": null, "callbacks_on_episode_start": null, "callbacks_on_episode_step": null, "callbacks_on_episode_end": null, "callbacks_on_evaluate_start": null, "callbacks_on_evaluate_end": null, "callbacks_on_evaluate_offline_start": null, "callbacks_on_evaluate_offline_end": null, "callbacks_on_sample_end": null, "callbacks_on_train_result": null, "explore": true, "enable_rl_module_and_learner": true, "enable_env_runner_and_connector_v2": true, "_prior_exploration_config": {"type": "StochasticSampling"}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x38844d8a0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "offline_data_class": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_read_batch_size": null, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "materialize_data": false, "materialize_mapped_data": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "ignore_final_observation": false, "prelearner_class": null, "prelearner_buffer_class": null, "prelearner_buffer_kwargs": {}, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_remaining_data": false, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": 1, "evaluation_duration": 20, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_auto_duration_min_env_steps_per_sample": 100, "evaluation_auto_duration_max_env_steps_per_sample": 2000, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 1, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "offline_evaluation_interval": null, "num_offline_eval_runners": 0, "offline_loss_for_module_fn": null, "offline_evaluation_duration": 1, "offline_evaluation_parallel_to_training": false, "offline_evaluation_timeout_s": 120.0, "num_cpus_per_offline_eval_runner": 1, "num_gpus_per_offline_eval_runner": 0, "custom_resources_per_offline_eval_runner": {}, "restart_failed_offline_eval_runners": true, "ignore_offline_eval_runner_failures": false, "max_num_offline_eval_runner_restarts": 1000, "offline_eval_runner_restore_timeout_s": 1800.0, "max_requests_in_flight_per_offline_eval_runner": 1, "validate_offline_eval_runners_after_construction": true, "offline_eval_runner_health_probe_timeout_s": 30.0, "offline_eval_rl_module_inference_only": false, "broadcast_offline_eval_runner_states": false, "offline_eval_batch_size_per_runner": 256, "dataset_num_iters_per_eval_runner": 1, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "log_gradients": false, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 1, "restart_failed_env_runners": true, "ignore_env_runner_failures": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30.0, "env_runner_restore_timeout_s": 1800.0, "_model_config": {}, "_rl_module_spec": "MultiRLModuleSpec(multi_rl_module_class=<class 'ray.rllib.core.rl_module.multi_rl_module.MultiRLModule'>, observation_space=None, action_space=None, inference_only=False, model_config=None, rl_module_specs={'default_policy': RLModuleSpec(module_class=<class 'source.intrinsic_attention_ppo.rl_modules.DifferentiablePPOModule.DifferentiablePPOModule'>, observation_space=None, action_space=None, inference_only=False, learner_only=False, model_config={'vf_share_layers': True, 'embedding_dim': 62, 'max_seq_len': 11, 'policy_head_hidden_sizes': [32], 'value_head_hidden_sizes': [101], 'embedding_hidden_sizes': [121]}, catalog_class=None, load_state_path=None, model_config_dict=None), 'intrinsic_reward_module': RLModuleSpec(module_class=<class 'source.intrinsic_attention_ppo.rl_modules.IntrinsicAttentionModule.IntrinsicAttentionModule'>, observation_space=None, action_space=None, inference_only=False, learner_only=True, model_config={'intrinsic_reward_network': {'encoder_hidden_sizes': [], 'encoding_dim': 1, 'num_heads': 1, 'head_hidden_sizes': None, 'layers': [{'type': 'attention'}]}, 'extrinsic_value_hidden_layers': [127, 60], 'vf_share_layers': True, 'max_seq_len': 11}, catalog_class=None, load_state_path=None, model_config_dict=None)}, load_state_path=None, modules_to_load=None, module_specs={'default_policy': RLModuleSpec(module_class=<class 'source.intrinsic_attention_ppo.rl_modules.DifferentiablePPOModule.DifferentiablePPOModule'>, observation_space=None, action_space=None, inference_only=False, learner_only=False, model_config={'vf_share_layers': True, 'embedding_dim': 62, 'max_seq_len': 11, 'policy_head_hidden_sizes': [32], 'value_head_hidden_sizes': [101], 'embedding_hidden_sizes': [121]}, catalog_class=None, load_state_path=None, model_config_dict=None), 'intrinsic_reward_module': RLModuleSpec(module_class=<class 'source.intrinsic_attention_ppo.rl_modules.IntrinsicAttentionModule.IntrinsicAttentionModule'>, observation_space=None, action_space=None, inference_only=False, learner_only=True, model_config={'intrinsic_reward_network': {'encoder_hidden_sizes': [], 'encoding_dim': 1, 'num_heads': 1, 'head_hidden_sizes': None, 'layers': [{'type': 'attention'}]}, 'extrinsic_value_hidden_layers': [127, 60], 'vf_share_layers': True, 'max_seq_len': 11}, catalog_class=None, load_state_path=None, model_config_dict=None)})", "algorithm_config_overrides_per_module": {"intrinsic_reward_module": {"lr": 0.0002715581955}}, "_per_module_overrides": {}, "_validate_config": true, "_use_msgpack_checkpoints": false, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "env_task_fn": -1, "enable_connectors": -1, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.161583927863, "kl_target": 0.0201019014258, "vf_loss_coeff": 0.7790510010087, "entropy_coeff": 0.0015431216992, "clip_param": 0.2459212356676, "vf_clip_param": 0.3769744131561, "entropy_coeff_schedule": null, "lr_schedule": null, "sgd_minibatch_size": -1, "vf_share_layers": -1, "differentiable_learner_configs": ["DifferentiableLearnerConfig(learner_class=<class 'source.intrinsic_attention_ppo.learners.IntrinsicAttentionPPOLearner.IntrinsicAttentionPPOLearner'>, learner_connector=None, add_default_connectors_to_learner_pipeline=True, is_multi_agent=False, policies_to_update=['default_policy'], lr=0.0060984166342, num_total_minibatches=0, num_epochs=1, minibatch_size=1000, shuffle_batch_per_epoch=True)"], "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9485408017724, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.callbacks.callbacks.RLlibCallback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 203.86845564842224, "iterations_since_restore": 19, "perf": {"cpu_util_percent": 52.35999999999999, "ram_util_percent": 78.30000000000001}}
{"timers": {"training_iteration": 12.263266035681676, "restore_env_runners": 1.1739380854016988e-05, "training_step": 12.26306135126165, "env_runner_sampling_timer": 2.74773881106285, "learner_update_timer": 9.300010861341393, "synch_weights": 0.0016111737039657026, "restore_eval_env_runners": 5.011439007291638e-05, "evaluation_iteration": 0.14410335350091644, "synch_eval_env_connectors": 0.00022273607867128405, "synch_env_connectors": 5.9283928483791965e-06}, "env_runners": {"module_to_env_connector": {"connector_pipeline_timer": 0.00012763344787357947, "timers": {"connectors": {"remove_single_ts_time_rank_from_batch": 1.264020855566035e-05, "un_batch_to_individual_items": 6.9553106923750556e-06, "get_actions": 4.365956686725728e-05, "tensor_to_numpy": 1.6214526154111952e-05, "listify_data_for_vector_env": 1.1153191626458353e-05, "normalize_and_clip_actions": 8.449315872497663e-06}}}, "rlmodule_inference_timer": 3.4817354053755154e-05, "sample": 0.007233851088881842, "weights_seq_no": 19.0, "num_agent_steps_sampled": {"default_agent": 5000.0}, "episode_len_mean": 20.0, "episode_len_max": 20, "env_to_module_connector": {"timers": {"connectors": {"batch_individual_items": 1.3393798358623436e-05, "add_states_from_episodes_to_batch": 2.9390790293845064e-06, "numpy_to_tensor": 1.3833541318681655e-05, "add_observations_from_episodes_to_batch": 2.9967247061654942e-06, "add_time_dim_to_batch_and_zero_pad": 7.509908564842315e-06}}, "connector_pipeline_timer": 6.44239902734424e-05}, "env_to_module_sum_episodes_length_out": 10.36823839457432, "num_agent_steps_sampled_lifetime": {"default_agent": -11105000.0}, "episode_return_mean": 1.74, "num_module_steps_sampled_lifetime": {"default_policy": -11105000.0}, "num_episodes": 250.0, "time_between_sampling": 0.03185869861006788, "num_env_steps_sampled_lifetime": -11105000.0, "episode_return_min": -10.5, "env_reset_timer": 6.013442680629924e-05, "env_to_module_sum_episodes_length_in": 10.36823839457432, "num_episodes_lifetime": -555250.0, "agent_episode_returns_mean": {"default_agent": 1.74}, "episode_len_min": 20, "episode_duration_sec_mean": 0.005734292309265585, "env_step_timer": 1.526881869765326e-05, "episode_return_max": 9.5, "num_module_steps_sampled": {"default_policy": 5000.0}, "module_episode_returns_mean": {"default_policy": 1.74}, "num_env_steps_sampled": 5000.0, "num_env_steps_sampled_lifetime_throughput": 3034.316526492018}, "__all_modules__": {"learner_connector_sum_episodes_length_in": 5000.0, "learner_connector": {"connector_pipeline_timer": 0.15868117476036422, "timers": {"connectors": {"add_one_ts_to_episodes_and_truncate": 0.009328562330170976, "add_observations_from_episodes_to_batch": 0.0015502158228521538, "add_columns_from_episodes_to_train_batch": 0.04879725146208726, "add_time_dim_to_batch_and_zero_pad": 0.08417922428226561, "add_states_from_episodes_to_batch": 0.008328503372143702, "batch_individual_items": 0.006169278521120466, "numpy_to_tensor": 9.334240635129594e-05}}}, "learner_connector_sum_episodes_length_out": 5250.0}, "learners": {"default_policy": {"curr_entropy_coeff": 0.0015431216992, "curr_kl_coeff": 1.5409844422720198e-07, "num_module_steps_trained_lifetime": 119700, "entropy": 0.6749762296676636, "num_module_steps_trained": 5985, "diff_num_grad_updates_vs_sampler_policy": 1.0, "vf_loss": 0.3583221137523651, "vf_loss_unclipped": 43.61614990234375, "policy_loss": -5.0079961511073634e-05, "use_intrinsic_rewards": 0.0, "total_loss": 0.27805957198143005, "vf_explained_var": -0.002087712287902832, "mean_kl_loss": 6.701405652620451e-08, "weights_seq_no": 20.0, "num_trainable_parameters": 16595, "module_train_batch_size_mean": 997.6479298448816, "num_module_steps_trained_lifetime_throughput": 721.5083917589745}, "intrinsic_reward_module": {"num_module_steps_trained_lifetime": 119700, "num_module_steps_trained": 5985, "diff_num_grad_updates_vs_sampler_policy": 1.0, "total_loss": 0.0, "gradients_default_optimizer_global_norm": 0.0, "module_train_batch_size_mean": 997.6479298448816, "default_optimizer_learning_rate": 0.0002715581955, "weights_seq_no": 20.0, "num_trainable_parameters": 8266, "curr_entropy_coeff": 0.0015431216992, "num_module_steps_trained_lifetime_throughput": 721.5133611924258}, "differentiable_learners": {"intrinsic_attention_ppo_learner": {"default_policy": {"weights_seq_no": 120.0, "num_module_steps_trained": 35910, "num_module_steps_trained_lifetime": 718200, "entropy": 0.6749448180198669, "diff_num_grad_updates_vs_sampler_policy": 101.0, "vf_loss": 0.35840076208114624, "vf_loss_unclipped": 43.60060119628906, "total_loss": 0.27812790870666504, "mean_kl_loss": 5.602744934662951e-08, "policy_loss": -4.3009305954910815e-05, "use_intrinsic_rewards": 1.0, "module_train_batch_size_mean": 997.4978492525759, "vf_explained_var": -0.0014603137969970703}, "__all_modules__": {"num_env_steps_trained": 198000, "num_module_steps_trained": 71820, "num_module_steps_trained_lifetime": 1436400, "num_env_steps_trained_lifetime": 3960000, "num_env_steps_trained_lifetime_throughput": 34461.94130190688}, "intrinsic_reward_module": {"weights_seq_no": 120.0, "num_module_steps_trained_lifetime": 718200, "num_module_steps_trained": 35910, "diff_num_grad_updates_vs_sampler_policy": 101.0, "total_loss": 0.0, "module_train_batch_size_mean": 997.4978492525759}}}, "__all_modules__": {"num_env_steps_trained_lifetime": 660000, "num_non_trainable_parameters": 0, "num_trainable_parameters": 24861, "num_env_steps_trained": 33000, "num_module_steps_trained": 11970, "num_module_steps_trained_lifetime": 239400, "num_env_steps_trained_lifetime_throughput": 3979.230449376266, "num_module_steps_trained_throughput": 18719873.105087228, "num_module_steps_trained_lifetime_throughput": 12464788.110738093}, "IntrinsicAttentionMask": [[[0.0910683199763298, 0.09122341126203537, 0.09028218686580658, 0.09082279354333878, 0.09123863279819489, 0.0912436991930008, 0.09030226618051529, 0.09084299951791763, 0.0918002799153328, 0.09085310250520706, 0.0903223529458046], [0.09110835194587708, 0.09130287915468216, 0.09012364596128464, 0.09080058336257935, 0.09132197499275208, 0.09132833778858185, 0.09014877676963806, 0.09082590043544769, 0.09202715009450912, 0.09083856642246246, 0.09017390757799149], [0.09086235612630844, 0.09081734716892242, 0.09109204262495041, 0.09093381464481354, 0.09081293642520905, 0.09081146121025085, 0.09108614176511765, 0.09092792123556137, 0.09065078943967819, 0.09092498570680618, 0.09108024090528488], [0.09100453555583954, 0.09109717607498169, 0.09053398668766022, 0.09085775166749954, 0.09110625833272934, 0.09110929071903229, 0.09054602682590485, 0.09086983650922775, 0.09144119173288345, 0.09087587147951126, 0.09055806696414948], [0.09111226350069046, 0.09131065756082535, 0.09010810405015945, 0.09079839289188385, 0.0913301333785057, 0.09133662283420563, 0.09013372659683228, 0.09082420915365219, 0.09204940497875214, 0.09083712100982666, 0.0901593565940857], [0.09111356735229492, 0.09131325036287308, 0.090102918446064, 0.09079766273498535, 0.09133285284042358, 0.09133938699960709, 0.09012871235609055, 0.09082365036010742, 0.09205682575702667, 0.09083663672208786, 0.0901545062661171], [0.09086768329143524, 0.09082778543233871, 0.091071218252182, 0.0909310057759285, 0.09082387387752533, 0.09082257002592087, 0.09106598794460297, 0.09092579036951065, 0.09068013727664948, 0.09092317521572113, 0.09106076508760452], [0.09100980311632156, 0.09110758453607559, 0.09051322937011719, 0.09085488319396973, 0.09111717343330383, 0.09112037718296051, 0.09052593261003494, 0.09086763858795166, 0.09147074073553085, 0.09087401628494263, 0.0905386433005333], [0.0912555381655693, 0.09159659594297409, 0.08953748643398285, 0.09071705490350723, 0.09163010120391846, 0.09164126962423325, 0.08958115428686142, 0.09076130390167236, 0.09287119656801224, 0.09078343212604523, 0.08962484449148178], [0.09101242572069168, 0.09111278504133224, 0.09050284326076508, 0.09085344523191452, 0.09112262725830078, 0.09112590551376343, 0.09051588177680969, 0.09086652845144272, 0.09148550778627396, 0.09087307751178741, 0.09052892029285431], [0.09087300300598145, 0.090838223695755, 0.0910504013299942, 0.09092820435762405, 0.09083481878042221, 0.09083367884159088, 0.09104584902524948, 0.09092365205287933, 0.09070950001478195, 0.09092137962579727, 0.09104128926992416]], [[0.09217771887779236, 0.0911405086517334, 0.09173613041639328, 0.09219450503587723, 0.09220010042190552, 0.09116262197494507, 0.09175839275121689, 0.09221687912940979, 0.08183842897415161, 0.09170492738485336, 0.0918697714805603], [0.09035792201757431, 0.09078394621610641, 0.09053846448659897, 0.09035108983516693, 0.09034880995750427, 0.0907747894525528, 0.09052933007478714, 0.0903419777750969, 0.09493865817785263, 0.09055127203464508, 0.09048370271921158], [0.09142512828111649, 0.09101300686597824, 0.09125000983476639, 0.09143176674842834, 0.09143397957086563, 0.091021828353405, 0.09125884622335434, 0.09144062548875809, 0.08718408644199371, 0.0912376120686531, 0.09130305796861649], [0.09220569580793381, 0.09114467352628708, 0.09175393730401993, 0.09222286194562912, 0.09222858399152756, 0.09116730093955994, 0.09177671372890472, 0.09224575757980347, 0.0816418007016182, 0.0917220190167427, 0.09189064800739288], [0.09221501648426056, 0.09114605188369751, 0.09175986051559448, 0.09223230928182602, 0.09223807603120804, 0.0911688506603241, 0.09178280830383301, 0.0922553762793541, 0.08157636225223541, 0.09172770380973816, 0.09189760684967041], [0.09039867669343948, 0.0907936841249466, 0.09056609123945236, 0.0903923362493515, 0.09039022028446198, 0.0907852053642273, 0.09055762737989426, 0.09038388729095459, 0.09463902562856674, 0.09057796746492386, 0.09051530808210373], [0.0914638414978981, 0.09102027118206024, 0.09127534180879593, 0.09147099405527115, 0.09147337824106216, 0.09102976322174072, 0.0912848636507988, 0.09148053079843521, 0.0869065448641777, 0.09126200526952744, 0.09133244305849075], [0.09224293380975723, 0.09115016460418701, 0.09177760779857635, 0.09226062148809433, 0.0922665148973465, 0.09117346256971359, 0.09180106967687607, 0.0922842025756836, 0.08138030022382736, 0.09174473583698273, 0.09191842377185822], [0.06330547481775284, 0.07407509535551071, 0.06766998022794724, 0.0631457045674324, 0.06309254467487335, 0.07382594048976898, 0.06744237244129181, 0.0629333108663559, 0.330203115940094, 0.06799036264419556, 0.06631605327129364], [0.09137073159217834, 0.0910026803612709, 0.0912143662571907, 0.0913766622543335, 0.09137864410877228, 0.09101055562496185, 0.09122225642204285, 0.09138457477092743, 0.08757452666759491, 0.09120329469442368, 0.09126173704862595], [0.09165626764297485, 0.09105526655912399, 0.09140074253082275, 0.09166596829891205, 0.09166920185089111, 0.09106811136007309, 0.09141363948583603, 0.09167890250682831, 0.08553113043308258, 0.09138266742229462, 0.0914781242609024]], [[0.09239252656698227, 0.09137997031211853, 0.08961467444896698, 0.09062663465738297, 0.09243118762969971, 0.09141820669174194, 0.09065507352352142, 0.08966155350208282, 0.0914468914270401, 0.08968030661344528, 0.09069300442934036], [0.09170261770486832, 0.09116248786449432, 0.09021414071321487, 0.09075883030891418, 0.09172318875789642, 0.09118293225765228, 0.09077410399913788, 0.09023943543434143, 0.09119827300310135, 0.09024956077337265, 0.09079445898532867], [0.09048859775066376, 0.09077339619398117, 0.09127973765134811, 0.090987928211689, 0.09047780185937881, 0.09076257050037384, 0.09097978472709656, 0.09126612544059753, 0.0907544419169426, 0.09126068651676178, 0.09096892923116684], [0.0911862924695015, 0.09099800139665604, 0.09066564589738846, 0.09085681289434433, 0.09119344502687454, 0.09100513905286789, 0.09086216241121292, 0.09067454189062119, 0.09101049602031708, 0.09067809581756592, 0.09086929261684418], [0.09241876751184464, 0.09138818830251694, 0.08959195017814636, 0.09062156826257706, 0.09245812147855759, 0.09142709523439407, 0.09065050631761551, 0.08963963389396667, 0.09145628660917282, 0.089658722281456, 0.09068910777568817], [0.09172875434160233, 0.0911707729101181, 0.09019134938716888, 0.09075384587049484, 0.09175000339746475, 0.09119189530611038, 0.09076961129903793, 0.0902174636721611, 0.09120773524045944, 0.09022791683673859, 0.09079064428806305], [0.09120584279298782, 0.09100425988435745, 0.09064852446317673, 0.09085313230752945, 0.09121350198984146, 0.0910119041800499, 0.09085885435342789, 0.0906580463051796, 0.09101764112710953, 0.09066185355186462, 0.09086648374795914], [0.09052101522684097, 0.09078388661146164, 0.09125109761953354, 0.0909818634390831, 0.09051105380058289, 0.09077389538288116, 0.0909743532538414, 0.09123854339122772, 0.09076640009880066, 0.0912335216999054, 0.09096433967351913], [0.09174836426973343, 0.09117698669433594, 0.09017425775527954, 0.09075011312961578, 0.09177011996507645, 0.09119860827922821, 0.09076625108718872, 0.0902009978890419, 0.09121483564376831, 0.09021168947219849, 0.09078778326511383], [0.09053398668766022, 0.0907880961894989, 0.09123964607715607, 0.0909794420003891, 0.0905243530869484, 0.09077843278646469, 0.0909721776843071, 0.09122751653194427, 0.09077119082212448, 0.09122265875339508, 0.09096250683069229], [0.09123189747333527, 0.09101259708404541, 0.09062568843364716, 0.09084820747375488, 0.09124023467302322, 0.09102091938257217, 0.09085443615913391, 0.09063603729009628, 0.0910271480679512, 0.09064017981290817, 0.09086272865533829]], [[0.08988890796899796, 0.08935517072677612, 0.08865834772586823, 0.08990894258022308, 0.09062906354665756, 0.08938172459602356, 0.08868470788002014, 0.09064926952123642, 0.10348587483167648, 0.09003333747386932, 0.08932458609342575], [0.09041518718004227, 0.09014460444450378, 0.08979013562202454, 0.09042533487081528, 0.09078909456729889, 0.09015808999538422, 0.08980356901884079, 0.09079927951097488, 0.0970572978258133, 0.09048826992511749, 0.0901290774345398], [0.09104868024587631, 0.09112992137670517, 0.09123682230710983, 0.09104564040899277, 0.09093693643808365, 0.09112586081027985, 0.09123276174068451, 0.0909339040517807, 0.08914818614721298, 0.09102679789066315, 0.09113459289073944], [0.0898684412240982, 0.0893249437212944, 0.08861545473337173, 0.08988885581493378, 0.09062224626541138, 0.08935198932886124, 0.08864228427410126, 0.09064282476902008, 0.10373363643884659, 0.09001553058624268, 0.08929380029439926], [0.08909823000431061, 0.08820914477109909, 0.08705383539199829, 0.0891316831111908, 0.09033717215061188, 0.08825329691171646, 0.0870974138379097, 0.09037108719348907, 0.1129503846168518, 0.08933945000171661, 0.08815830945968628], [0.09038985520601273, 0.0901060476899147, 0.08973430842161179, 0.09040048718452454, 0.09078211337327957, 0.09012018144130707, 0.08974839746952057, 0.09079279750585556, 0.09736951440572739, 0.09046651422977448, 0.09008975327014923], [0.09102579206228256, 0.09109355509281158, 0.09118272364139557, 0.09102325886487961, 0.09093256294727325, 0.09109017997980118, 0.09117934107780457, 0.0909300297498703, 0.08943753689527512, 0.0910075381398201, 0.09109745174646378], [0.08907563239336014, 0.08817700296640396, 0.08700944483280182, 0.08910944312810898, 0.09032802283763885, 0.08822162449359894, 0.08705348521471024, 0.0903623104095459, 0.11321785300970078, 0.08931945264339447, 0.08812561631202698], [0.06356168538331985, 0.058914318680763245, 0.053317874670028687, 0.06374257802963257, 0.0705668106675148, 0.0591379776597023, 0.053520288318395615, 0.07076763361692429, 0.3829370439052582, 0.06487610191106796, 0.05865773931145668], [0.08974023163318634, 0.0891362652182579, 0.08834847807884216, 0.08976291865110397, 0.0905785784125328, 0.0891663134098053, 0.08837825804948807, 0.09060148149728775, 0.10528203099966049, 0.08990374952554703, 0.08910167217254639], [0.09044425934553146, 0.09018892794847488, 0.08985437452793121, 0.09045383334159851, 0.09079702943563461, 0.09020165354013443, 0.08986704796552658, 0.09080663323402405, 0.09669877588748932, 0.090513214468956, 0.09017428010702133]], [[0.09106780588626862, 0.09176404029130936, 0.09028168022632599, 0.09028670191764832, 0.0912381187081337, 0.0912431925535202, 0.09083743393421173, 0.09030678868293762, 0.0917997658252716, 0.09031682461500168, 0.09085764735937119], [0.09124419093132019, 0.09273948520421982, 0.08957135677337646, 0.08958198130130768, 0.09160877764225006, 0.09161964803934097, 0.09075228124856949, 0.08962451666593552, 0.092816561460495, 0.08964578807353973, 0.0907953679561615], [0.09086231142282486, 0.09066101908683777, 0.09109199792146683, 0.09109052270650864, 0.09081289172172546, 0.09081141650676727, 0.09092935919761658, 0.09108462184667587, 0.09065074473619461, 0.09108167141675949, 0.09092346578836441], [0.0908636525273323, 0.09066806733608246, 0.09108679741621017, 0.09108536690473557, 0.09081563353538513, 0.09081420302391052, 0.09092878550291061, 0.09107962995767593, 0.09065808355808258, 0.09107676893472672, 0.09092306345701218], [0.0911114290356636, 0.09200277924537659, 0.0901072770357132, 0.09011368453502655, 0.09132929891347885, 0.09133578836917877, 0.0908169224858284, 0.09013930708169937, 0.09204856306314468, 0.09015212208032608, 0.09084274619817734], [0.09111273288726807, 0.09200990200042725, 0.09010210633277893, 0.09010854363441467, 0.09133201837539673, 0.09133855253458023, 0.09081631898880005, 0.09013433009386063, 0.09205598384141922, 0.0901472344994545, 0.09084231406450272], [0.09100828319787979, 0.09144098311662674, 0.09051822125911713, 0.09052135050296783, 0.09111424535512924, 0.09111740440130234, 0.09086483716964722, 0.09053388983011246, 0.09146314859390259, 0.09054016321897507, 0.09087742865085602], [0.0908689871430397, 0.09069627523422241, 0.09106598794460297, 0.09106472134590149, 0.09082658588886261, 0.09082532674074173, 0.09092649817466736, 0.09105966240167618, 0.09068745374679565, 0.09105713665485382, 0.09092143923044205], [0.09125310182571411, 0.09278950095176697, 0.08953509479761124, 0.08954600989818573, 0.09162764996290207, 0.09163881838321686, 0.09074781835079193, 0.0895896852016449, 0.09286871552467346, 0.08961153030395508, 0.09079207479953766], [0.0908716470003128, 0.09071037173271179, 0.09105557948350906, 0.09105439484119415, 0.09083205461502075, 0.09083087742328644, 0.09092534333467484, 0.0910496711730957, 0.0907021313905716, 0.09104731678962708, 0.09092061966657639], [0.09101353585720062, 0.09146933257579803, 0.0904974490404129, 0.09050074964761734, 0.09112514555454254, 0.09112846851348877, 0.0908624604344368, 0.09051395207643509, 0.09149269014596939, 0.09052056074142456, 0.09087572246789932]], [[0.08995308727025986, 0.08941897004842758, 0.08872164785861969, 0.08997313678264618, 0.08997982740402222, 0.0894455537199974, 0.0887480154633522, 0.0907139852643013, 0.10355975478887558, 0.09009761363267899, 0.08938836306333542], [0.09044778347015381, 0.09017711132764816, 0.08982251584529877, 0.09045793861150742, 0.09046131372451782, 0.0901905968785286, 0.08983594924211502, 0.09083201736211777, 0.09709229320287704, 0.09052089601755142, 0.09016157686710358], [0.09103887528181076, 0.09112010151147842, 0.09122699499130249, 0.09103583544492722, 0.09103482216596603, 0.0911160483956337, 0.09122293442487717, 0.09092410653829575, 0.08913858234882355, 0.0910169929265976, 0.0911247730255127], [0.08993379771709442, 0.08938989788293839, 0.08867989480495453, 0.08995421975851059, 0.08996102958917618, 0.08941695839166641, 0.08870674669742584, 0.09070874005556107, 0.10380906611680984, 0.09008099138736725, 0.08935873210430145], [0.08992734551429749, 0.08938018232584, 0.08866595476865768, 0.0899478867650032, 0.08995474129915237, 0.08940741419792175, 0.08869296312332153, 0.0907069742679596, 0.10389227420091629, 0.09007541835308075, 0.08934883028268814], [0.09042403846979141, 0.09014012664556503, 0.08976825326681137, 0.09043468534946442, 0.09043823182582855, 0.09015427529811859, 0.08978234231472015, 0.09082713723182678, 0.09740634262561798, 0.09050072729587555, 0.09012383222579956], [0.09101761877536774, 0.09108538180589676, 0.09117453545331955, 0.09101508557796478, 0.09101424366235733, 0.09108199924230576, 0.09117115288972855, 0.09092186391353607, 0.08942950516939163, 0.09099936485290527, 0.09108927845954895], [0.08918331563472748, 0.08828359842300415, 0.08711463212966919, 0.0892171636223793, 0.08922845870256424, 0.0883282870054245, 0.08715872466564178, 0.09047155827283859, 0.11335471272468567, 0.08942742645740509, 0.08823215216398239], [0.06399454921483994, 0.05931553244590759, 0.05368097499012947, 0.06417667865753174, 0.06423749029636383, 0.05954071506857872, 0.05388477072119713, 0.0712495669722557, 0.38554462790489197, 0.06531791388988495, 0.05905720964074135], [0.08981281518936157, 0.08920835703611374, 0.08841993659734726, 0.0898355171084404, 0.08984308689832687, 0.08923842757940292, 0.08844973146915436, 0.0906747579574585, 0.10536717623472214, 0.08997645974159241, 0.08917373418807983], [0.09047501534223557, 0.09021960198879242, 0.0898849293589592, 0.09048458933830261, 0.0904877781867981, 0.09023232758045197, 0.08989761024713516, 0.0908375084400177, 0.09673165529966354, 0.09054399281740189, 0.09020493924617767]]]}, "num_training_step_calls_per_iteration": 1, "evaluation": {"env_runners": {"module_to_env_connector": {"timers": {"connectors": {"tensor_to_numpy": 1.508117065539142e-05, "un_batch_to_individual_items": 6.5514590882738675e-06, "get_actions": 3.584840754210722e-05, "listify_data_for_vector_env": 1.0281277982775372e-05, "normalize_and_clip_actions": 7.969866633070943e-06, "remove_single_ts_time_rank_from_batch": 1.1885962179892168e-05}}, "connector_pipeline_timer": 0.00011371370574388561}, "episode_len_min": 20, "num_env_steps_sampled": 400, "weights_seq_no": 20.0, "episode_len_mean": 20.0, "env_to_module_sum_episodes_length_out": 10.368238394574323, "episode_len_max": 20, "env_to_module_connector": {"timers": {"connectors": {"batch_individual_items": 1.2423173085962891e-05, "add_observations_from_episodes_to_batch": 2.8021643492485396e-06, "add_states_from_episodes_to_batch": 2.7854986477628867e-06, "add_time_dim_to_batch_and_zero_pad": 6.879021895235159e-06, "numpy_to_tensor": 1.216377599739554e-05}}, "connector_pipeline_timer": 5.9617119536814964e-05}, "env_to_module_sum_episodes_length_in": 10.368238394574323, "num_episodes_lifetime": 400, "episode_duration_sec_mean": 0.007146927927387878, "episode_return_max": 12.5, "rlmodule_inference_timer": 3.1127871751945325e-05, "num_agent_steps_sampled": {"default_agent": 400}, "num_module_steps_sampled_lifetime": {"default_policy": 8000}, "num_agent_steps_sampled_lifetime": {"default_agent": 8000}, "num_module_steps_sampled": {"default_policy": 400}, "sample": 0.13243290577633035, "episode_return_mean": -0.4, "env_step_timer": 1.3818500898123008e-05, "agent_episode_returns_mean": {"default_agent": -0.4}, "num_episodes": 20, "module_episode_returns_mean": {"default_policy": -0.4}, "episode_return_min": -12.5, "num_env_steps_sampled_lifetime": 100400, "env_reset_timer": 0.0005384113414397355, "time_between_sampling": 12.181044110409308}, "num_healthy_workers": 1, "actor_manager_num_outstanding_async_reqs": 0, "num_remote_worker_restarts": 0}, "num_env_steps_sampled_lifetime": -11105000.0, "fault_tolerance": {"num_healthy_workers": 0, "num_remote_worker_restarts": 0}, "env_runner_group": {"actor_manager_num_outstanding_async_reqs": 0}, "done": true, "training_iteration": 20, "trial_id": "ae8a2_00000", "date": "2025-08-11_18-26-01", "timestamp": 1754929561, "time_this_iter_s": 10.838054895401001, "time_total_s": 214.70651054382324, "pid": 10870, "hostname": "Mac", "node_ip": "127.0.0.1", "config": {"exploration_config": {}, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 2, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "env": "Umbrella", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": false, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 0, "create_local_env_runner": true, "num_envs_per_env_runner": 1, "gym_env_vectorize_mode": "SYNC", "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "episodes_to_numpy": true, "max_requests_in_flight_per_env_runner": 1, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "merge_env_runner_states": "training_only", "broadcast_env_runner_states": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "complete_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "sampler_perf_stats_ema_coef": null, "_is_online": true, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": "auto", "num_aggregator_actors_per_learner": 0, "max_requests_in_flight_per_aggregator_actor": 3, "local_gpu_idx": 0, "max_requests_in_flight_per_learner": 3, "gamma": 1, "lr": 0.0002715581955, "grad_clip": 0.5, "grad_clip_by": "global_norm", "_train_batch_size_per_learner": 5000, "train_batch_size": 4000, "num_epochs": 1, "minibatch_size": 1000, "shuffle_batch_per_epoch": true, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "log_std_clip_param": 20.0, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "_disable_preprocessor_api": false, "_disable_action_flattening": false}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {"intrinsic_reward_coeff": 0.2795015916508}, "optimizer": {}, "_learner_class": "<class 'source.intrinsic_attention_ppo.learners.IntrinsicAttentionMetaLearner.IntrinsicAttentionMetaLearner'>", "callbacks_on_algorithm_init": null, "callbacks_on_env_runners_recreated": null, "callbacks_on_offline_eval_runners_recreated": null, "callbacks_on_checkpoint_loaded": null, "callbacks_on_environment_created": null, "callbacks_on_episode_created": null, "callbacks_on_episode_start": null, "callbacks_on_episode_step": null, "callbacks_on_episode_end": null, "callbacks_on_evaluate_start": null, "callbacks_on_evaluate_end": null, "callbacks_on_evaluate_offline_start": null, "callbacks_on_evaluate_offline_end": null, "callbacks_on_sample_end": null, "callbacks_on_train_result": null, "explore": true, "enable_rl_module_and_learner": true, "enable_env_runner_and_connector_v2": true, "_prior_exploration_config": {"type": "StochasticSampling"}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x38844d8a0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "offline_data_class": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_read_batch_size": null, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "materialize_data": false, "materialize_mapped_data": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "ignore_final_observation": false, "prelearner_class": null, "prelearner_buffer_class": null, "prelearner_buffer_kwargs": {}, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_remaining_data": false, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": 1, "evaluation_duration": 20, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_auto_duration_min_env_steps_per_sample": 100, "evaluation_auto_duration_max_env_steps_per_sample": 2000, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 1, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "offline_evaluation_interval": null, "num_offline_eval_runners": 0, "offline_loss_for_module_fn": null, "offline_evaluation_duration": 1, "offline_evaluation_parallel_to_training": false, "offline_evaluation_timeout_s": 120.0, "num_cpus_per_offline_eval_runner": 1, "num_gpus_per_offline_eval_runner": 0, "custom_resources_per_offline_eval_runner": {}, "restart_failed_offline_eval_runners": true, "ignore_offline_eval_runner_failures": false, "max_num_offline_eval_runner_restarts": 1000, "offline_eval_runner_restore_timeout_s": 1800.0, "max_requests_in_flight_per_offline_eval_runner": 1, "validate_offline_eval_runners_after_construction": true, "offline_eval_runner_health_probe_timeout_s": 30.0, "offline_eval_rl_module_inference_only": false, "broadcast_offline_eval_runner_states": false, "offline_eval_batch_size_per_runner": 256, "dataset_num_iters_per_eval_runner": 1, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "log_gradients": false, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 1, "restart_failed_env_runners": true, "ignore_env_runner_failures": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30.0, "env_runner_restore_timeout_s": 1800.0, "_model_config": {}, "_rl_module_spec": "MultiRLModuleSpec(multi_rl_module_class=<class 'ray.rllib.core.rl_module.multi_rl_module.MultiRLModule'>, observation_space=None, action_space=None, inference_only=False, model_config=None, rl_module_specs={'default_policy': RLModuleSpec(module_class=<class 'source.intrinsic_attention_ppo.rl_modules.DifferentiablePPOModule.DifferentiablePPOModule'>, observation_space=None, action_space=None, inference_only=False, learner_only=False, model_config={'vf_share_layers': True, 'embedding_dim': 62, 'max_seq_len': 11, 'policy_head_hidden_sizes': [32], 'value_head_hidden_sizes': [101], 'embedding_hidden_sizes': [121]}, catalog_class=None, load_state_path=None, model_config_dict=None), 'intrinsic_reward_module': RLModuleSpec(module_class=<class 'source.intrinsic_attention_ppo.rl_modules.IntrinsicAttentionModule.IntrinsicAttentionModule'>, observation_space=None, action_space=None, inference_only=False, learner_only=True, model_config={'intrinsic_reward_network': {'encoder_hidden_sizes': [], 'encoding_dim': 1, 'num_heads': 1, 'head_hidden_sizes': None, 'layers': [{'type': 'attention'}]}, 'extrinsic_value_hidden_layers': [127, 60], 'vf_share_layers': True, 'max_seq_len': 11}, catalog_class=None, load_state_path=None, model_config_dict=None)}, load_state_path=None, modules_to_load=None, module_specs={'default_policy': RLModuleSpec(module_class=<class 'source.intrinsic_attention_ppo.rl_modules.DifferentiablePPOModule.DifferentiablePPOModule'>, observation_space=None, action_space=None, inference_only=False, learner_only=False, model_config={'vf_share_layers': True, 'embedding_dim': 62, 'max_seq_len': 11, 'policy_head_hidden_sizes': [32], 'value_head_hidden_sizes': [101], 'embedding_hidden_sizes': [121]}, catalog_class=None, load_state_path=None, model_config_dict=None), 'intrinsic_reward_module': RLModuleSpec(module_class=<class 'source.intrinsic_attention_ppo.rl_modules.IntrinsicAttentionModule.IntrinsicAttentionModule'>, observation_space=None, action_space=None, inference_only=False, learner_only=True, model_config={'intrinsic_reward_network': {'encoder_hidden_sizes': [], 'encoding_dim': 1, 'num_heads': 1, 'head_hidden_sizes': None, 'layers': [{'type': 'attention'}]}, 'extrinsic_value_hidden_layers': [127, 60], 'vf_share_layers': True, 'max_seq_len': 11}, catalog_class=None, load_state_path=None, model_config_dict=None)})", "algorithm_config_overrides_per_module": {"intrinsic_reward_module": {"lr": 0.0002715581955}}, "_per_module_overrides": {}, "_validate_config": true, "_use_msgpack_checkpoints": false, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "env_task_fn": -1, "enable_connectors": -1, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.161583927863, "kl_target": 0.0201019014258, "vf_loss_coeff": 0.7790510010087, "entropy_coeff": 0.0015431216992, "clip_param": 0.2459212356676, "vf_clip_param": 0.3769744131561, "entropy_coeff_schedule": null, "lr_schedule": null, "sgd_minibatch_size": -1, "vf_share_layers": -1, "differentiable_learner_configs": ["DifferentiableLearnerConfig(learner_class=<class 'source.intrinsic_attention_ppo.learners.IntrinsicAttentionPPOLearner.IntrinsicAttentionPPOLearner'>, learner_connector=None, add_default_connectors_to_learner_pipeline=True, is_multi_agent=False, policies_to_update=['default_policy'], lr=0.0060984166342, num_total_minibatches=0, num_epochs=1, minibatch_size=1000, shuffle_batch_per_epoch=True)"], "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9485408017724, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.callbacks.callbacks.RLlibCallback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 214.70651054382324, "iterations_since_restore": 20, "perf": {"cpu_util_percent": 51.36875, "ram_util_percent": 78.76875}}
